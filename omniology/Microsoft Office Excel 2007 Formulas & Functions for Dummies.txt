by Ken Bluttman and Peter Aitken
Microsoft
® Office
Excel
®2007
Formulas & Functions
FOR
DUMmIES
‰


by Ken Bluttman and Peter Aitken
Microsoft
® Office
Excel
®2007
Formulas & Functions
FOR
DUMmIES
‰

Microsoft Office® Excel® 2007 Formulas and Functions For Dummies®
Published by
Wiley Publishing, Inc.
111 River Street
Hoboken, NJ 07030-5774
www.wiley.com
Copyright © 2007 by Wiley Publishing, Inc., Indianapolis, Indiana
Published by Wiley Publishing, Inc., Indianapolis, Indiana
Published simultaneously in Canada
No part of this publication may be reproduced, stored in a retrieval system or transmitted in any form 
or by any means, electronic, mechanical, photocopying, recording, scanning or otherwise, except as per-
mitted under Sections 107 or 108 of the 1976 United States Copyright Act, without either the prior written
permission of the Publisher, or authorization through payment of the appropriate per-copy fee to the
Copyright Clearance Center, 222 Rosewood Drive, Danvers, MA 01923, (978) 750-8400, fax (978) 646-8600.
Requests to the Publisher for permission should be addressed to the Legal Department, Wiley Publishing,
Inc., 10475 Crosspoint Blvd., Indianapolis, IN 46256, (317) 572-3447, fax (317) 572-4355, or online at
http://www.wiley.com/go/permissions.
Trademarks: Wiley, the Wiley Publishing logo, For Dummies, the Dummies Man logo, A Reference for the
Rest of Us!, The Dummies Way, Dummies Daily, The Fun and Easy Way, Dummies.com, and related trade
dress are trademarks or registered trademarks of John Wiley & Sons, Inc. and/or its affiliates in the United
States and other countries, and may not be used without written permission. Microsoft and Excel are reg-
istered trademarks of Microsoft Corporation in the United States and/or other countries. All other trade-
marks are the property of their respective owners. Wiley Publishing, Inc., is not associated with any
product or vendor mentioned in this book.
LIMIT OF LIABILITY/DISCLAIMER OF WARRANTY: THE PUBLISHER AND THE AUTHOR MAKE NO REP-
RESENTATIONS OR WARRANTIES WITH RESPECT TO THE ACCURACY OR COMPLETENESS OF THE
CONTENTS OF THIS WORK AND SPECIFICALLY DISCLAIM ALL WARRANTIES, INCLUDING WITHOUT
LIMITATION WARRANTIES OF FITNESS FOR A PARTICULAR PURPOSE. NO WARRANTY MAY BE CRE-
ATED OR EXTENDED BY SALES OR PROMOTIONAL MATERIALS. THE ADVICE AND STRATEGIES CON-
TAINED HEREIN MAY NOT BE SUITABLE FOR EVERY SITUATION. THIS WORK IS SOLD WITH THE
UNDERSTANDING THAT THE PUBLISHER IS NOT ENGAGED IN RENDERING LEGAL, ACCOUNTING, OR
OTHER PROFESSIONAL SERVICES. IF PROFESSIONAL ASSISTANCE IS REQUIRED, THE SERVICES OF A
COMPETENT PROFESSIONAL PERSON SHOULD BE SOUGHT. NEITHER THE PUBLISHER NOR THE
AUTHOR SHALL BE LIABLE FOR DAMAGES ARISING HEREFROM. THE FACT THAT AN ORGANIZATION
OR WEBSITE IS REFERRED TO IN THIS WORK AS A CITATION AND/OR A POTENTIAL SOURCE OF FUR-
THER INFORMATION DOES NOT MEAN THAT THE AUTHOR OR THE PUBLISHER ENDORSES THE INFOR-
MATION THE ORGANIZATION OR WEBSITE MAY PROVIDE OR RECOMMENDATIONS IT MAY MAKE.
FURTHER, READERS SHOULD BE AWARE THAT INTERNET WEBSITES LISTED IN THIS WORK MAY HAVE
CHANGED OR DISAPPEARED BETWEEN WHEN THIS WORK WAS WRITTEN AND WHEN IT IS READ. 
For general information on our other products and services, please contact our Customer Care
Department within the U.S. at 800-762-2974, outside the U.S. at 317-572-3993, or fax 317-572-4002.
For technical support, please visit www.wiley.com/techsupport.
Wiley also publishes its books in a variety of electronic formats. Some content that appears in print may
not be available in electronic books.
Library of Congress Control Number: 2006939512
ISBN: 978-0-470-04655-5
Manufactured in the United States of America
10   9   8   7   6   5   4   3   2   1

About the Authors
Ken Bluttman has been working as a software developer for nearly two
decades. Ken specializes in VB.Net/VBA/database/web applications. He has
written several articles on various computer topics including Office/VBA
development, XML, SQL Server, and InfoPath. He has a number of books out
on Excel and Access. Ken lives in New York with his wife, son, dog, hamster,
some frogs, and a couple of geckos.
Peter Aitken has been writing about computers and programming for over 
15 years. He has more than 45 books to his credit with over 1.5 million copies
in print, and also has extensive experience writing software documentation,
online help, and magazine and trade-publication articles. Some recent book
titles are Managing Your Money and Investment with Excel, Powering Office XP
with XML, Excel PivotTables and Charts, and Visual Basic.NET Programming
with Peter Aitken. He is the proprietor of PGA Consulting, providing custom
application development and technical writing services since 1994. 


Dedications
Dedicated to all the Excel users in the world! Keep up the good work. Also, I
wish to put a special note here for my dog, Chestnut, who kept me company
when writing in the wee hours of the morning.
–– Ken Bluttman
To my wife Maxine, for her unflagging support and devotion.
–– Peter Aitken
Authors’ Acknowledgments
Much activity goes on behind the scenes in bringing a book from idea to 
reality. Many people are involved. We wish to thank the great Wiley staff —
Tom Heine, Courtney Allen, Tonya Cupp, and everyone else on the Wiley
team — for all their hard work! A special thanks to Doug Klippert for 
handling the technical review of the book. He is one sharp Excel guy!
–– Peter G. Aitken and Ken Bluttman
Thanks to co-author Peter Aitken for his contributions, insights, and sugges-
tions. Special thanks to my family for understanding that, at times, sitting in
front of a computer is a priority, even when it means I have to miss some-
thing special. But darn I did miss watching some fun movies (sigh).
–– Ken Bluttman

Publisher’s Acknowledgments
We’re proud of this book; please send us your comments through our online registration form
located at www.dummies.com/register/.
Some of the people who helped bring this book to market include the following:
Acquisitions, Editorial, and 
Media Development
Project Editor: Tonya Maddox Cupp
(Previous Edition: Jade L. Williams)
Acquisitions Editors: Tom Heine, 
Courtney Allen
Technical Editor: Doug Klippert
Editorial Manager: Robyn Siesky
Business Manager: Amy Knies
Media Development Specialists: Angela Denny,
Kate Jenkins, Steven Kudirka, Kit Malone
Media Project Supervisor: Laura Moss
Media Development Manager:
Laura VanWinkle
Editorial Assistant: Laura Sinise
Sr. Editorial Assistant: Cherie Case
Cartoons: Rich Tennant
(www.the5thwave.com)
Composition Services
Project Coordinator: Erin Smith
Layout and Graphics: Karl Brandt, 
Barbara Moore, Laura Pence, 
Alicia B. South, Julie Trippetti
Proofreaders: John Greenough, Techbooks
Indexer: Techbooks
Anniversary Logo Design: Richard Pacifico
Publishing and Editorial for Technology Dummies
Richard Swadley, Vice President and Executive Group Publisher
Andy Cummings, Vice President and Publisher
Mary Bednarek, Executive Acquisitions Director
Mary C. Corder, Editorial Director
Publishing for Consumer Dummies
Diane Graves Steele, Vice President and Publisher
Joyce Pepple, Acquisitions Director
Composition Services
Gerry Fahey, Vice President of Production Services
Debbie Stailey, Director of Composition Services

Contents at a Glance
Introduction .................................................................1
Part I: Putting the Fun in Functions...............................5
Chapter 1: Tapping into Formula and Function Fundamentals....................................7
Chapter 2: Saving Time with Function Tools ................................................................37
Chapter 3: Saying “Array!” for Formulas and Functions..............................................53
Chapter 4: Fixing Formula Boo-Boos..............................................................................63
Part II: Counting on Your Money..................................79
Chapter 5: Calculating Loan Payments and Interest Rates.........................................81
Chapter 6: Appreciating What You’ll Get, Depreciating What You Got .....................97
Chapter 7: Using Basic Math Functions.......................................................................113
Chapter 8: Advancing Your Math .................................................................................131
Chapter 9: Throwing Statistics a Curve.......................................................................149
Chapter 10: Using Significance Tests ...........................................................................185
Part III: Doing the Math............................................195
Chapter 11: Rolling the Dice on Predictions and Probability ..................................197
Chapter 12: Dressing Up for Date Functions...............................................................215
Chapter 13: Keeping Well-Timed Functions ................................................................233
Chapter 14: Using Lookup, Logical, and Reference Functions .................................241
Chapter 15: Digging Up the Facts .................................................................................269
Part IV: Working with Data.......................................283
Chapter 16: Writing Home about Text Functions .......................................................285
Chapter 17: Playing Records with Database Functions.............................................311
Part V: The Part of Tens ............................................323
Chapter 18: Ten-Plus Tips for Working with Formulas ..............................................325
Chapter 19: Ten-Plus Functions You Really Should Know.........................................339
Index .......................................................................347


Table of Contents
Introduction..................................................................1
About This Book...............................................................................................1
How to Use This Book .....................................................................................1
What You Can Safely Ignore............................................................................2
Foolish Assumptions .......................................................................................2
How This Book Is Organized...........................................................................2
Part I: Putting the Fun in Functions .....................................................3
Part II: Counting On Your Money..........................................................3
Part III: Doing the Math..........................................................................3
Part IV: Working with Data ....................................................................3
Part V: The Part of Tens.........................................................................4
Icons Used In This Book..................................................................................4
Where to Go from Here....................................................................................4
Part I: Putting the Fun in Functions................................5
Chapter 1: Tapping into Formula and Function Fundamentals  . . . . . . .7
Working with Excel Fundamentals.................................................................8
Understanding workbooks and worksheets .......................................8
Introducing the Formulas Ribbon ......................................................11
Working with rows, column, cells, ranges, and tables.....................13
Formatting your data ...........................................................................18
Getting help...........................................................................................19
Gaining the Upper Hand on Formulas .........................................................19
Entering your first formula..................................................................20
Understanding references...................................................................23
Copying formulas with the fill handle................................................25
Assembling formulas the right way ...................................................25
Using Functions in Formulas ........................................................................28
Looking at what goes into a function.................................................30
Arguing with a function .......................................................................30
Nesting functions..................................................................................33
Chapter 2: Saving Time with Function Tools  . . . . . . . . . . . . . . . . . . . . .37
Getting Familiar with the Insert Function Dialog Box ...............................37
Finding the Correct Function........................................................................39
Entering Functions Using the Insert Function Dialog Box ........................40
Selecting a function that takes no arguments...................................40
Selecting a function that uses arguments .........................................42
Entering cells, ranges, named areas, 
and tables as function arguments ..................................................45

Excel 2007 Formulas & Functions For Dummies 
x
Getting help in the Insert Function dialog box.................................48
Using the Function Arguments dialog box to edit functions ..........48
Directly Entering Formulas and Functions .................................................49
Entering formulas and functions in the Formula Bar ......................49
Entering formulas and functions directly in worksheet cells.........50
Chapter 3: Saying “Array!” for Formulas and Functions  . . . . . . . . . . .53
Discovering Arrays ........................................................................................53
Using Arrays in Formulas..............................................................................55
Working with Functions That Return Arrays..............................................58
Chapter 4: Fixing Formula Boo-Boos  . . . . . . . . . . . . . . . . . . . . . . . . . . . .63
Catching Errors as You Enter Them ............................................................63
Getting parentheses to match ............................................................64
Avoiding circular references...............................................................66
Mending broken links...........................................................................68
Using the Formula Error Checker.......................................................70
Auditing Formulas..........................................................................................72
Watching the Watch Window........................................................................75
Evaluating and Checking Errors...................................................................76
Making an Error Behave the Way You Want................................................78
Part II: Counting on Your Money ..................................79
Chapter 5: Calculating Loan Payments and Interest Rates  . . . . . . . . .81
Understanding How Excel Handles Money.................................................82
Going with the cash flow .....................................................................82
Formatting for currency ......................................................................82
Choosing separators............................................................................84
Figuring Loan Calculations ...........................................................................86
Calculating the payment amount .......................................................87
Calculating interest payments............................................................88
Calculating payments toward principal ............................................90
Calculating the number of payments ................................................91
Calculating the interest rate................................................................93
Calculating the principal .....................................................................95
Chapter 6: Appreciating What You’ll Get, 
Depreciating What You Got . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .97
Looking into the Future.................................................................................97
Depreciating the Finer Things in Life ........................................................100
Calculating straight line depreciation .............................................102
Creating an accelerated depreciation schedule.............................103
Creating an even faster accelerated deprecation schedule..........104
Calculating a mid-year depreciation schedule ...............................106
Measuring Your Internals............................................................................108

Chapter 7: Using Basic Math Functions  . . . . . . . . . . . . . . . . . . . . . . . .113
Adding It All Together with the SUM Function.........................................113
Rounding Out Your Knowledge .................................................................118
Just plain old rounding......................................................................118
Rounding in one direction.................................................................120
Leaving All Decimals Behind with INT .....................................................125
Leaving Some Decimals Behind with TRUNC ..........................................127
Looking for a Sign.........................................................................................128
Ignoring Signs ...............................................................................................129
Chapter 8: Advancing Your Math  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .131
Using PI to Calculate Circumference and Diameter.................................131
Generating and Using Random Numbers..................................................132
Ordering Items..............................................................................................136
Combining ....................................................................................................137
Raising Numbers to New Heights ..............................................................138
Multiplying Multiple Numbers ...................................................................139
Using What Remains with the MOD Function ..........................................141
Summing Things Up.....................................................................................142
Using SUBTOTAL ................................................................................142
Using SUMPRODUCT..........................................................................144
Using SUMIF ........................................................................................146
Chapter 9: Throwing Statistics a Curve . . . . . . . . . . . . . . . . . . . . . . . . .149
Stuck in the Middle with AVERAGE, MEDIAN, and MODE.......................150
Deviating from the Middle ..........................................................................154
Measuring variance ...........................................................................155
Analyzing deviations..........................................................................157
Looking for normal distribution ......................................................159
Skewed from the norm.......................................................................164
Comparing data sets ..........................................................................166
Analyzing Data with Percentiles and Bins.................................................170
QUARTILE ...........................................................................................170
PERCENTILE .......................................................................................171
RANK ...................................................................................................173
PERCENTRANK ..................................................................................174
FREQUENCY .......................................................................................175
MIN and MAX .....................................................................................178
LARGE and SMALL ............................................................................179
Going for the Count......................................................................................181
COUNT ................................................................................................181
COUNTIF .............................................................................................182
Chapter 10: Using Significance Tests  . . . . . . . . . . . . . . . . . . . . . . . . . .185
Testing to the T ............................................................................................186
Comparing Results to an Estimate.............................................................190
xi
Table of Contents

Excel 2007 Formulas & Functions For Dummies 
xii
Part III: Doing the Math ............................................195
Chapter 11: Rolling the Dice on Predictions and Probability  . . . . . .197
Modeling........................................................................................................197
Linear model ......................................................................................198
Exponential model ............................................................................198
Getting It Straight: Using SLOPE and INTERCEPT 
to Describe Linear Data ...........................................................................199
What’s in the Future: Using FORECAST, TREND, 
and GROWTH to Make Predictions ........................................................202
FORECAST ...........................................................................................203
TREND .................................................................................................204
GROWTH .............................................................................................206
Using NORMDIST and POISSON to Determine Probabilities ..................208
NORMDIST ..........................................................................................208
POISSON .............................................................................................210
Chapter 12: Dressing Up for Date Functions . . . . . . . . . . . . . . . . . . . . .215
Understanding How Excel Handles Dates.................................................215
Formatting Dates..........................................................................................217
Making a Date with DATE ...........................................................................218
Breaking a Date with DAY, MONTH, and YEAR ........................................219
Isolating the day ................................................................................219
Isolating the month ...........................................................................221
Isolating the year ...............................................................................222
Converting a Date from Text ......................................................................223
Finding Out What TODAY Is........................................................................224
Counting the days until your birthday ............................................225
Counting your age, in days................................................................225
Determining the Day of the Week...............................................................226
Working with Workdays...............................................................................227
Determining workdays in a range of dates .....................................228
Workdays in the future ......................................................................229
Calculating Time between Two Dates with the DATEDIF Function .......230
Chapter 13: Keeping Well-Timed Functions  . . . . . . . . . . . . . . . . . . . . .233
Understanding How Excel Handles Time..................................................233
Formatting Time...........................................................................................234
Keeping TIME ...............................................................................................235
Text to Time with TIMEVALUE ...................................................................236
Deconstructing Time with HOUR, MINUTE, and SECOND .....................236
Isolating the hour ..............................................................................237
Isolating the minute ..........................................................................238
Isolating the second ..........................................................................239

Finding the Time NOW ................................................................................239
Calculating Elapsed Time over Days .........................................................240
Chapter 14: Using Lookup, Logical, and Reference Functions  . . . . .241
Testing on One Condition ...........................................................................242
Choosing the Right Value ............................................................................247
Let’s Be Logical.............................................................................................248
NOT ......................................................................................................249
AND and OR .......................................................................................250
Finding Where It Is .......................................................................................252
ADDRESS .............................................................................................252
ROW, ROWS, COLUMN, and COLUMNS ..........................................256
OFFSET ................................................................................................258
Looking It Up.................................................................................................259
HLOOKUP and VLOOKUP .................................................................260
MATCH ................................................................................................263
Chapter 15: Digging Up the Facts  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .269
Getting Informed with the CELL Function.................................................269
Getting Information about Excel and Your Computer System ...............274
Finding What IS and What IS Not................................................................276
ISERR, ISERROR, and ISNA ................................................................277
ISBLANK, ISNONTEXT, ISTEXT, and ISNUMBER .............................278
Getting to Know Your Type.........................................................................280
Part IV: Working with Data........................................283
Chapter 16: Writing Home about Text Functions  . . . . . . . . . . . . . . . . .285
Breaking Apart Text .....................................................................................285
Bearing to the LEFT............................................................................286
Swinging to the RIGHT.......................................................................287
Staying in the MIDdle.........................................................................288
Finding the long of it with LEN ........................................................289
Putting Text Together with CONCATENATE .............................................290
Changing Text...............................................................................................292
Making money.....................................................................................292
Turning numbers into text ................................................................294
Repeating text.....................................................................................296
Swapping text .....................................................................................297
Giving text a trim................................................................................301
Making a case .....................................................................................302
Comparing, Finding, and Measuring Text .................................................304
Going for perfection with EXACT ....................................................304
Finding and searching........................................................................305
xiii
Table of Contents

Excel 2007 Formulas & Functions For Dummies 
xiv
Chapter 17: Playing Records with Database Functions  . . . . . . . . . . .311
Putting Your Data into a Database Structure............................................311
Working with Database Functions ............................................................312
Establishing your database...............................................................313
Establishing the criteria area............................................................314
Fine-tuning Criteria with AND and OR ......................................................316
Adding Only What Matters with DSUM .....................................................318
Going for the Middle with DAVERAGE.......................................................319
Counting Only What Matters with DCOUNT.............................................320
Finding Highest and Lowest with DMIN and DMAX.................................321
Finding Duplicate Values with DGET ........................................................322
Part V: The Part of Tens .............................................323
Chapter 18: Ten-Plus Tips for Working with Formulas  . . . . . . . . . . . .325
Operator Precedence...................................................................................325
Display Formulas..........................................................................................326
Fixing Formulas ............................................................................................327
Use Absolute References.............................................................................328
Turn Calc On/Turn Calc Off ........................................................................329
Use Named Areas .........................................................................................330
Use Formula Auditing ..................................................................................331
Use Conditional Formatting........................................................................332
Use the Conditional Sum Wizard................................................................333
Use the Lookup Wizard ...............................................................................334
Create Your Own Functions ........................................................................335
Chapter 19: Ten-Plus Functions You Really Should Know  . . . . . . . . .339
SUM................................................................................................................339
AVERAGE .......................................................................................................340
COUNT...........................................................................................................340
INT and ROUND............................................................................................341
INT........................................................................................................341
ROUND.................................................................................................341
IF ....................................................................................................................342
NOW and TODAY..........................................................................................342
HLOOKUP and VLOOKUP............................................................................343
ISNUMBER.....................................................................................................343
MIN and MAX................................................................................................344
SUMIF and COUNTIF ....................................................................................344
Index........................................................................347

Introduction
S
preadsheets are such a mainstay in today’s world; the term is almost a
household word. Certainly in our homes it is. And we don’t just mean
because we write books on Excel. Spouses use Excel to track household
expenditures and insurance claims. A neighbor analyzes his eBay transac-
tions in Excel. Our local merchant keeps tabs on his store’s inventory on a
worksheet.
In the workplace, Excel is one of the most commonly used analysis and report-
ing tools. Financial statements, sales reports, inventory, project scheduling,
customer activity — so much of this stuff is kept in Excel. The program’s 
ability to manipulate and give feedback about the data makes it attractive.
About This Book
This book is about the number-crunching side of Excel. Formulas are the key-
stone to analyzing data — that is, digging out nuggets of important information.
What is the average sale? How many times did we do better than average? How
many days are left on the project? How much progress have we made? That
sort of thing.
Formulas calculate answers, straight and to the point. But that’s not all. Excel
has dozens of built-in functions that calculate everything from a simple aver-
age to a useful analysis of your investments to complex inferential statistics.
But you don’t have to know it all or use it all; just use the parts that are rele-
vant to your work.
This book discusses over 150 of these functions. But rather than just show
their syntax and list them alphabetically, we have assembled them by cate-
gory and provided real examples of how to use them alone, and in formulas,
along with step-by-step instructions and illustrations of the results.
How to Use This Book
You do not have to read the book sequentially from start to finish, although
you certainly can. Each chapter deals with a specific category of functions —
financial in one chapter, statistical in another, and so on. Some categories are

split over two or more chapters. We suggest two ways for you to use 
this book:
 Use the Table of Contents to find the chapters that are of interest to you.
 Use the Index to look up specific functions you are interested in.
What You Can Safely Ignore
If you already know what function you want to use and need a bit of guidance
on it, you can find it in the index and ignore any other discussion that is in
the same chapter (although it makes us sad to think of that). Just kidding!
You can ignore any info in the Technical Stuff icons. You can also ignore
Chapter 1 if you are already a fairly competent Excel user — especially if you
have used formulas and functions.
Foolish Assumptions
We assume you have a PC with Excel 2007 loaded on it. That’s a no brainer! We
also assume you know how to navigate with a keyboard and mouse. Lastly, we
assume you have used Excel before, even just once. We do discuss basics in
Chapter 1, but not all of them. If you really need to start from scratch, we sug-
gest you read the excellent Excel 2007 For Dummies by Greg Harvey (Wiley).
Other than that, this book is written for Excel 2007 but just between you and
us — it works just fine with older versions of Excel. There could be a function
or two that isn’t in an older version or work slightly differently. But Microsoft
has done an excellent job of maintaining compatibility between versions of
Excel, so when it comes to formulas and functions, you can be confident that
what works in one version works in another.
If you have used a previous version of Excel, you will notice quite a few
changes to the user interface. These don’t directly affect the use of formulas
and functions, although you must carry out some new steps to perform some
related tasks.
How This Book Is Organized
This book is organized into five parts. Each part’s subject matter indicates
what type of functions it covers. Use the index to find the page numbers for
particular functions. Do read chapters that pertain to your interest. For all
2
Excel Formulas & Functions For Dummies 

you know, other functions are even better suited to your needs. With that
said, dig into what is inside each part of the book.
Part I: Putting the Fun in Functions
Part I is introductory, of course, but not all of it is so basic. Chapter 1 is the
de facto intro chapter. That’s where you can brush up on how Excel works, 
or read about it for the first time. We discuss the new Ribbon interface in
Chapter 1. Chapters 2, 3, and 4 cover what is likely to be new ground to many
readers — specifically, using the Insert Function dialog box, using array for-
mulas and functions, and correcting formulas. Looking through these chap-
ters can help you down the road.
Part II: Counting On Your Money
As the name implies, Part II is all about money. Several functions in Excel
work with loan factors, interest rates, and returns on investments. This is the
place to go when creating worksheets that track costs, revenue, and the like.
Part of the discussion in Part II is about currency formatting.
Part III: Doing the Math
Part III is rather large because it covers a rather sizeable topic. Chapters 7
shows you how to use basic math functions. This is where you read about the
SUM, ROUND, and INT functions that are so often used in Excel. Chapter 8
takes this up a notch to cover advanced math functions. This is where you
find some real gems, such as SUMPRODUCT and MOD.
Chapters 9, 10, and 11 show you how to work with statistical functions. Each of
these chapters focuses on a specific discipline. Chapter 9 covers the functions
used in descriptive statistics, such as the ever-popular AVERAGE function,
along with many related functions that give details about your data. Chapter 10
focuses on significance tests. Chapter 11 rounds out the statistical functions
with those used in predicting factors. This is where you read about forecasting
and looking for trends.
Part IV: Working with Data
Part IV is a biggie. Here is where you read about working with dates and times;
how to work with strings of text; and how to pluck out pieces of data from a
database (an area of rows and columns, that is). Chapter 12 and 13 are the date
and time chapters. Chapter 14 covers a number of cool functions, such as the
3
Introduction

amazing IF and the workhorses HLOOKUP and VLOOKUP. Chapter 15 explains
functions that provide information about your data and computer; it also
explains working with errors. Chapter 16 is all about strings. No, I don’t mean
the kind to fly kites. A string is a text value, and there is so much you can do 
to manipulate them. Lastly, Chapter 17 explains all the database functions.
Part V: The Part of Tens
And then there’s the Part of Tens — a For Dummies tradition if ever there was
one. In Part V, we have included three chapters: tips for working with formu-
las; the most popular functions; and finally, really cool functions to go to
town with.
Icons Used In This Book
A Tip gives you a little extra piece of info on the subject at hand. It might
offer an alternate method. It might lead you to a conclusion. It might, well,
give you a tip (just no stock tips — sorry).
The Remember icon holds some basic concept that is good to keep tucked
somewhere in your brain.
As it implies, a Warning is serious stuff. These icons tell you to be careful —
usually because you can accidentally erase your data or some such horrible
event.
Once in a while, some tidbit is interesting to the tech-head types, but not to
anyone else. You can read these or ignore them as you see fit.
Where to Go from Here
Roll up your sleeves, take a deep breath, and then forget all that preparing-for-
a-hard-task stuff. Using Excel is easy. You can hardly make a mistake without
Excel catching it. If you need to brush up on the basics, go to Chapter 1. This
chapter is also the best place to get your first taste of formulas and functions.
After that, it’s up to you. The book is organized more by area of focus than
anything else. If finance is what you do, go to Part II. If math is what you do, 
go to Part III. Seek and you will find.
4
Excel Formulas & Functions For Dummies 

Part I
Putting the Fun 
in Functions

In this part . . .
W
e cover the basics, as any good Part I of a book
should. Here is the place to get familiar with the
fundamentals of Excel and the new Excel 2007 features.
Chapter 1 is a quick study in workbooks, worksheets, 
formulas, and functions –– everything you need to get
going! If you a beginner or need to brush up on Excel, 
then Chapter 1 is the place to start. But that’s not all,
folks. Chapter 2 tells you about a key dialog box that
makes working with functions much easier. That enables
you to concentrate on more important details, such as
where you are going on your lunch break. Part I finishes
with a one-two punch of using arrays and correcting 
formulas.

Chapter 1
Tapping into Formula and 
Function Fundamentals
In This Chapter
 Getting the skinny on workbooks and worksheets
 Understanding the parts of a worksheet
 Working with cells, ranges, named areas, and tables
 Applying formatting
 Figuring out how to use the Help system
 Writing formulas
 Using functions in formulas
 Using nested functions
E
xcel is to computer programs what a Ferrari is to cars: sleek on the out-
side and a lot of power under the hood. Excel is also like a truck — it can
handle all your data, lots of it. In fact, in Excel 2007, a single worksheet has
17,179,869,184 places to hold data. Yes, that’s what we said — over 17 billion
data placeholders. And that’s on just one worksheet!
Opening files created in earlier versions of Excel may show just the number
of worksheet rows and columns available in the version the workbook was
created with.
Excel is used in all types of businesses. And you know how that’s possible?
By being able to store and work with any kind of data. It doesn’t matter
whether you’re in finance or sales, whether you run a video store or organize
wilderness trips, or whether you’re charting party RSVPs or tracking the
scores of your favorite sports teams — Excel can handle all of it. Its number-
crunching ability is just awesome! And so easy to use!
Just putting a bunch of information on worksheets doesn’t crunch the data or
give you sums, results, or analyses. If you want to just store your data some-
where, you can use Excel or get a database program instead. In this book, we

show you how to build formulas and how to use the dozens of built-in func-
tions that Excel provides. That’s where the real power of Excel is — making
sense of your data.
Don’t fret that this is a challenge and that you may make mistakes. We did
when we were ramping up. Besides, Excel is very forgiving. It won’t crash on
you. Excel usually tells you when you made a mistake, and sometimes it even
helps you to correct it. How many programs do that!? But first the basics.
This first chapter gives you the springboard you need to use the rest of the
book. We wish books like this were around when we were introduced to com-
puters. We had to stumble through a lot of this.
Working with Excel Fundamentals
Before you can write any formulas or crunch any numbers, you have to know
where the data goes. And how to find it again. We wouldn’t want your data to
get lost! Knowing how worksheets store your data and present it is critical to
your analysis efforts.
Understanding workbooks and worksheets
A workbook is the same as a file. Excel opens and closes workbooks, just as a
word processor program opens and closes documents. Click the Microsoft
Office button, found at the upper left of your Excel screen, to view the selec-
tions found under the File menu in earlier versions of Excel. Figure 1-1 shows
the new look for accessing basic functions such as opening, saving, printing,
and closing your Excel files (not to mention a number of other nifty functions
to boot!).
Figure 1-1:
Seeing how
to use basic
Excel
program
functions.
8
Part I: Putting the Fun in Functions 

Excel 2007 files have the .xlsx extension. Older version Excel files have the
.xls extension.
When Excel starts up, it displays a blank workbook ready for use. If at any
time you need another new workbook, click the Microsoft Office button and
click on New. You will be presented with a plateful of templates, including a
blank workbook. That’s the baby you want, so give it a click to select it and
then click the Create button. A new workbook will open. When you have
more than one workbook open, you pick the one you want to work on by
selecting it in the Windows Taskbar.
A worksheet is where your data actually goes. A workbook contains at least
one worksheet. If you didn’t have at least one, where would you put the data?
Figure 1-2 shows an open workbook that has three sheets — Sheet1, Sheet2,
and Sheet3. You can see these on the worksheet tabs near the bottom left of
the screen.
At any given moment, one worksheet is always on top. In Figure 1-2, Sheet1 
is on top. Another way of saying this is that Sheet1 is the active worksheet.
There is always one and only one active worksheet. To make another work-
sheet active, just click its tab.
Figure 1-2:
Looking at a
workbook
and
worksheets.
9
Chapter 1: Tapping into Formula and Function Fundamentals

Worksheet, spreadsheet, and just plain old sheet are used interchangeably to
mean the worksheet.
Guess what’s really cool? You can change the name of the worksheets. 
Names like Sheet1 and Sheet2 are just not exciting. How about Baseball 
Card Collection or Last Year’s Taxes? Well, actually Last Year’s Taxes isn’t 
too exciting either. 
The point is you can give your worksheets meaningful names. You have two
ways to do this:
 Double-click the worksheet tab and then type in a new name.
 Right-click the worksheet tab, select Rename from the list, and then type
in a new name.
Figure 1-3 shows one worksheet name already changed and another about to
be changed by right-clicking its tab.
You can try changing a worksheet name on your own. Do it the easy way:
1. Double-click a worksheet’s tab.
2. Type in a new name and press Enter.
You can change the color of worksheet tabs. Right-click the tab and select
Tab Color from the list.
To insert a new worksheet into a workbook, click the Insert sheet tab, which
is located after the last worksheet tab. Figure 1-4 shows how. To delete a
worksheet, just right-click the worksheet’s tab and select Delete from the list.
Don’t delete a worksheet unless you really mean to. You cannot get it back
after it is gone. It does not go into the Windows Recycle Bin.
Figure 1-3:
Changing
the name 
of a
worksheet.
10
Part I: Putting the Fun in Functions 

You can insert many new worksheets. The limit of how many is based on
your computer’s memory, but you should have no problem inserting 200 or
more. Of course we hope you have a good reason for having so many. Which
brings us to the next point.
Worksheets organize your data. Use them wisely and you will find it easy to
manage your data. For example, let’s say you are the boss (we thought you’d
like that!), and you have 30 employees that you are tracking information on
over the course of a year. You might have 30 worksheets — one for each
employee. Or you might have 12 worksheets — one for each month. Or you
may just keep it all on one worksheet. How you use Excel is up to you, but
Excel is ready to handle whatever you throw at it.
New Excel files default to having three worksheets. You can change this
default number on the Personalize tab in the Excel Options dialog box. To dis-
play the dialog box, click the Microsoft Office button and then click the Excel
Options button.
Introducing the Formulas Ribbon
It’s a fact of life — or rather, a fact of Microsoft marketing — that each new
release of Office has a slightly different look. The folks at Microsoft went
whole hog with Office 2007. Imagine this — no menus or toolbars. These have
been such staples of Windows applications that only something amazing
could upstage them.
Without further ado, we present the Ribbon. The Ribbon sits at the top of the
application where menus used to unfold and toolbars made their home. A few
items do appear as menu headers along the top of the Excel screen, but they
actually work more like tabs. Click them and no menus appear. Instead, the
Ribbon presents the items that are related to the clicked header.
Figure 1-5 shows the top part of the screen, in which the Ribbon displays 
the items that appear when you click the Formulas header. In the figure, the
Ribbon is set to show formula-based methods. Along the left, functions are
categorized. One of the categories is opened to show how you can access a
particular function.
Figure 1-4:
Inserting 
a new
worksheet.
11
Chapter 1: Tapping into Formula and Function Fundamentals

These categories are along the bottom of the Formulas Ribbon:
 Function Library: This includes the Function Wizard, the AutoSum fea-
ture, and the categorized functions.
 Named Cells: These features manage named areas. In fact, the new
Name Manager is here, a brand-new Excel 2007 feature.
 Formula Auditing: These features have been through many Excel incar-
nations, but never before have the features been so prominent. Also
here is the Watch Window, which lets you keep an eye on the values in
designated cells, but within one window. In Figure 1-6 you can see that a
few cells have been assigned to the Watch Window. If any values change,
you can see in the Watch Window. Note how the watched cells are on
sheets that are not the current active sheet. Neat!
 Calculation: This is where you manage calculation settings, such as
whether calculation is automatic or manual. 
 Solutions: Any loaded add-ins that provide further functions appear
here. In Figure 1-5, the Data Analysis Add-in is just another name for the
ever-popular Analysis ToolPak.
Another new feature that goes hand in hand with the Ribbon is the Quick
Access Toolbar. (So there is a toolbar after all!) In Figure 1-5 the Quick Access
Toolbar sits just under the left side of the Ribbon. On it are icons that per-
form actions with a single click. The icons are ones you select by using the
Customization tab in the Excel Options dialog box. You can put the toolbar
above or below the Ribbon by right-clicking the Quick Access Toolbar and
choosing the option.
Formula Ribbon
Clicking a category to access
particular function
Also known as
Analysis ToolPak
Figure 1-5:
Getting to
know the
Ribbon.
12
Part I: Putting the Fun in Functions 

Working with rows, column, 
cells, ranges, and tables
A worksheet contains cells. Lots of them. Billions of them. This might seem
unmanageable, but actually it’s pretty straightforward. Figure 1-7 shows a
worksheet filled with data. Use this to look at a worksheet’s components.
Each cell can contain data or a formula. In Figure 1-7, the cells contain data.
Some, or even all, cells could contain formulas, but that’s not the case here.
Columns have letter headers — A, B, C, and so on. You can see these listed hor-
izontally just above the area where the cells are. After you get past the 26th
column, a double lettering system is used — AA, AB, and so on. After all the
two-letter combinations are used up, a triple-letter scheme is used. Rows are
listed vertically down the left side of the screen and use a numbering system.
Name Box
Formula Box
Rows
Active Cell
Columns
Figure 1-7:
Looking at
what goes
into a
worksheet.
Figure 1-6:
Eyeing the
Watch
Window.
13
Chapter 1: Tapping into Formula and Function Fundamentals

You find cells at the intersection of rows and columns. Cell A1 is the cell at
the intersection of column A and row 1. A1 is the cell’s address. There is
always an active cell — that is, a cell in which any entry would go into should
you start typing. The active cell has a border around it. Also, the contents of
the active cell are seen in the Formula Box.
When we speak of, or reference, cell, we are referring to its address. The
address is the intersection of a column and row. To talk about cell D20 means
to talk about the cell that you find at the intersection of column D and row 20.
In Figure 1-7, the active cell is C7. You have a couple of ways to see this. For
starters, cell C7 has a border around it. Also notice that the column head C 
is shaded, as well as row number 7. Just above the column headers are the
Name Box and the Formula Box. The Name Box is all the way to the left and
shows the active cell’s address of C7. To the right of the Name Box, the
Formula Box shows the contents of cell C7.
If the Formula Bar is not visible, choose the Advanced tab; in the Display sec-
tion in the Excel Options dialog box, choose to make it visible.
A range is usually a group of adjacent cells, although noncontiguous cells can
be included in the same range (but that’s mostly for rocket scientists and
those obsessed with calculus). For your purposes, assume a range is a group
of continuous cells. Make a range right now! Here’s how:
14
Part I: Putting the Fun in Functions 
Getting to know the Formula Bar
Taken together, the Formula Box and the Name
Box make up the Formula Bar. You use the
Formula Bar quite a bit as you work with formu-
las and functions. The Formula Box is used to
enter and edits formulas. The Formula Box is the
long entry box that starts in the middle of the
bar. When you enter a formula into this box, you
then can click the little check-mark button to
finish the entry. The check-mark button is only
visible when you are entering a formula.
Pressing the Enter key also completes your
entry; clicking the X cancels the entry. 
An alternative is to enter a formula directly into
a cell. The Formula Box displays the formula as
it is being entered into the cell. When you want
to see just the contents of a cell that has a for-
mula, make that cell active and look at its con-
tents in the Formula Box. Cells that have
formulas do not normally display the formula,
but instead display the result of the formula.
When you want to see the actual formula, the
Formula Box is the place to do it. The Name Box,
on the left side of the Formula Bar, is used to
select named areas in the workbook. This is
addressed further in the material.

1. Position the mouse pointer over the first cell where you wish to define
a range.
2. Press and hold the left mouse button down.
3. Move the pointer to the last cell of your desired area.
4. Release the mouse button.
Figure 1-8 shows what happened when we did this. We selected a range of
cells. The address of this range is A3:D21. 
A range address looks like two cell addresses put together, with a colon (:) in
the middle. And that’s what it is! A range address starts with the address of
the cell in the upper left of the range, then has a colon, and then ends with the
address of the cell in the lower right. 
One more detail about ranges — you can give them a name. This is a great
feature because you can think about a range in terms of what it is used for,
instead of what its address is. Also, if we did not take the extra step to assign
a name, the range would be gone as soon as we clicked anywhere on the
worksheet. When a range is given a name, you can repeatedly use the range
by using its name.
Say you have a list of clients on a worksheet. What’s easier — thinking of
exactly which cells are occupied, or thinking that there is your list of clients?
Figure 1-8:
Selecting 
a range 
of cells.
15
Chapter 1: Tapping into Formula and Function Fundamentals

Throughout this book, we use areas made of cell addresses and ranges, which
have been given names. It’s time to get your feet wet creating a named area.
Here’s what you do:
1. Position the mouse pointer over a cell, click and hold the left mouse
button down, and drag the pointer around. 
2. Release the mouse button when done.
You’ve select an area of the worksheet.
3. Click Name a Range in the Named Cells category on the Formulas
Ribbon. 
The New Name dialog box appears. Figure 1-9 shows you how it looks 
so far. 
4. Name the area if need be.
Excel guesses that you want to name the area with the value it finds in
the top cell of the range. That may or may not be what you want. Change
the name if you need to. In this example, we changed the name to Clients.
An alternative method to naming an area is to select it, type the name in
the Name Box (left of the Formula Bar), and press the Enter key.
5. Click the OK button.
That’s it. Hey, you’re already on your way to being an Excel pro! Now that you
have a named area, you can easily select your data at any time. Just go to the
Name Box and select it from the list. Figure 1-10 shows how we select the
Clients area we set up.
Tables work in much the same manner as named areas. Tables have a few fea-
tures that are unavailable to simple named areas. With tables you can indi-
cate that the top row contains header labels. Further, tables default to have
filtering ability. Figure 1-11 shows a table on a worksheet, with headings and
filtering ability.
Figure 1-9:
Adding a
name to the
workbook.
16
Part I: Putting the Fun in Functions 

With filtering, you can limit which rows show, based on which values you
select to display.
The Insert Ribbon contains the button to use for inserting a table. The Insert
Ribbon is shown in Figure 1-11.
Figure 1-11:
Trying out 
a table.
Figure 1-10:
Using the
Name Box
to find the
named area.
17
Chapter 1: Tapping into Formula and Function Fundamentals

Formatting your data
Of course you want to make your data look all spiffy and shiny. Bosses like
that. Is the number 98.6 someone’s temperature? Is it a score on a test? Is it
ninety-eight dollars and sixty cents? Is it a percentage? Any of these formats
is correct:
 98.6
 $98.60
 98.6%
Excel lets you format your data in just the way you need. Formatting options
are on the Home Ribbon, in the Number category.
Figure 1-12 shows how formatting helps in the readability and understanding
of a worksheet. Cell B1 has a monetary amount and is formatted with the
Accounting style. Cell B2 is formatted as a percent. The actual value in cell B2
is .05. Cell B7 is formatted as currency. The currency format displays a nega-
tive value in parentheses. This is just one of the formatting options for cur-
rency. Chapter 5 explains further about formatting currency.
Besides selecting formatting on the Home Ribbon, you can use the familiar (in
previous versions) Format Cells dialog box. This is the place to go for all your
formatting needs beyond what’s available on the toolbar. You can even create
custom formats. You can display the Format Cells dialog box two ways:
Figure 1-12:
Formatting
data.
18
Part I: Putting the Fun in Functions 

 On the Home Ribbon, click the drop-down list from the Number cate-
gory, and then click More.
 Right-click any cell and select Format Cells from the pop-up menu.
Figure 1-13 shows the Format Cells dialog box. So many settings are there it
can make your head spin! We discuss this dialog box and formatting more
extensively in Chapter 5.
Getting help
Excel is complex; you can’t deny that. And lucky for all of us, help is just a key
press away. Yes, literally one key press — just press the F1 key. Try it now.
This starts up the Help system. From there you can search on a keyword or
browse through the Help Table of Contents. Later on, when you are working
with Excel functions, you can get help on specific functions directly by click-
ing the Help with This Function link in the Insert Function dialog box.
Chapter 2 covers the Insert Function dialog box in detail.
Gaining the Upper Hand on Formulas
Okay, time to get to the nitty-gritty of what Excel is all about. Sure, you can
just enter data and leave it as is, and even generate some pretty charts from
it. But getting answers from your data, or creating a summary of your data, or
applying what-if tests — all of this takes formulas.
Figure 1-13:
Using the
Format Cells
dialog box
for
advanced
formatting
options.
19
Chapter 1: Tapping into Formula and Function Fundamentals

To be specific, a formula in Excel calculates something, or returns some
result based on data in the worksheet. A formula is placed in cells and must
start with an equal sign (=) to tell Excel that it is a formula and not data.
Sounds simple, and it is.
All formulas should start with an equal (=) sign. An alternative is to start a
formula with a plus sign (+). This keeps Excel compatible with Lotus 1-2-3.
Look at some very basic formulas. Table 1-1 shows a few formulas and tells
you what they do.
We use the word return to refer to what displays after a formula or function
does its thing. So to say the formula returns a 7 is the same as saying the for-
mula calculated the answer to be 7.
Table 1-1
Basic Formulas
Formula 
What It Does
=2 + 2
Returns the number 4.
=A1 + A2
Returns the sum of the values in cells A1 and A2, what-
ever those values may be. If either A1 or A2 has text in it,
then an error is returned.
=D5
The cell that contains this formula ends up displaying the
value that is in cell D5. If you try to enter this formula into
cell D5 itself, you create a circular reference. That is a no-
no. See Chapter 4.
=SUM(A2:A5)
Returns the sum of the values in cells A2, A3, A4, and A5.
Recall from above the syntax for a range. This formula
uses the SUM function to sum up all the values in the
range.
Entering your first formula
Ready to enter your first formula? Make sure Excel is running and a work-
sheet is in front of you, and then:
1. Click an empty cell.
2. Type this in: = 10 + 10.
3. Press Enter.
20
Part I: Putting the Fun in Functions 

That was easy, wasn’t it? You should see the result of the formula — the
number 20.
Try another. This time you create a formula that adds together the value of
two cells:
1. Click any cell.
2. Type in any number.
3. Click another cell.
4. Type in another number.
5. Click a third cell. 
This cell will contain the formula.
6. Type a =.
7. Click the first cell.
This is an important point in the creation of the formula. The formula 
is being written by both your keyboard entry and clicking around with
the mouse. The formula should look about half complete, with an equal
sign immediately followed by the address of the cell you just clicked.
Figure 1-14 shows what this looks like. In the example, the value 15 has
been entered into cell B3 and the value 35 into cell B6. The formula was
started in cell E3. Cell E3 so far has =B3 in it.
8. Enter a +.
Figure 1-14:
Entering a
formula that
references
cells.
21
Chapter 1: Tapping into Formula and Function Fundamentals

9. Click the cell that has the second entered value. 
In this example, this is cell B6. The formula in cell E3 now looks like this:
=B3 + B6. You can see this is Figure 1-15.
10. Press Enter. 
This ends the entry of the function. All done! Congratulations!
Figure 1-16 shows how the example ended up. Cell E3 displays the result of
the calculation. Also notice that the Formula Bar displays the contents of cell
E3, which really is the formula.
Figure 1-16:
A finished
formula.
Figure 1-15:
Completing
the formula.
22
Part I: Putting the Fun in Functions 

Understanding references
References abound in Excel formulas. You can reference cells. You can refer-
ence ranges. You can reference cells and ranges on other worksheets. You can
reference cells and ranges in other workbooks. Formulas and functions are at
their most useful when using references, so you need to understand them.
And if that isn’t enough to stir the pot, you can use three types of cell refer-
ences: relative, absolute, and mixed. Okay, one step at a time here. Try out a
formula that uses a range. 
Formulas that use ranges often have a function in the formula, so use the
SUM function here:
1. Enter some numbers in many cells going down one column.
2. Click in another cell where you want the result to appear.
3. Enter =SUM( to start the function.
4. Click the first cell that has an entered value, hold the left mouse button
down, and drag the mouse pointer over all the cells that have values. 
5. Release the mouse button.
The range address appears where the formula and function are being
entered.
6. Enter a ).
7. Press Enter.
8. Give yourself a pat on the back.
Wherever you drag the mouse to enter the range address into a function, you
can also just type in the address of the range, if you know what it is.
Excel is dynamic when it comes to cell addresses. If you have a cell with a for-
mula that references a different cell’s address and you copy the formula from
the first cell to another cell, the address of the reference inside the formula
changes. Excel updates the reference inside the formula to match the number
of rows and/or columns that separate the original cell (where the formula is
being copied from) from the new cell (where the formula is being copied to).
This may be confusing, so try an example so you can see this for yourself:
1. In cell B2, enter 100.
2. In cell C2, enter =B2 * 2.
3. Press Enter. 
Cell C2 now returns the value 200.
23
Chapter 1: Tapping into Formula and Function Fundamentals

4. If C2 is not the active cell, click it once.
5. Press Ctrl + C, or click the Copy button in the Clipboard category on
the Home Ribbon.
6. Click cell C3.
7. Press Ctrl + V, or click the Paste button in the Clipboard category on
the Home Ribbon.
8. If you see a strange moving line around cell C2, press the ESC key.
Cell C3 should be the active cell, but if it is not, just click it once. Look 
at the Formula Bar. The contents of cell C3 are =B3 * 2, and not the
=B2 * 2 that you copied.
Did you see a moving line around a cell? That line’s called a marquee. It’s a
reminder that you are in the middle of a cut or copy operation, and the mar-
quee goes around the cut or copied data.
What happened? Excel, in its wisdom, assumed that if a formula in cell C2 ref-
erences the cell B2 — one cell to the left, then the same formula put into cell
C3 is supposed to reference cell B3 — also one cell to the left.
When copying formulas in Excel, relative addressing is usually what you
want. That’s why it is the default behavior. Sometimes you do not want rela-
tive addressing but rather absolute addressing. This is making a cell reference
fixed to an absolute cell address so that it does not change when the formula
is copied.
In an absolute cell reference, a dollar sign ($) precedes both the column
letter and the row number. You can also have a mixed reference in which the
column is absolute and the row is relative or vice versa. To create a mixed
reference, you use the dollar sign in front of just the column letter or row
number. Here are some examples:
Reference Type
Formula
What Happens After Copying 
the Formula
Relative
=A1
Either, or both, the column letter A
and the row number 1 can change.
Absolute
=$A$1
The column letter A and the row
number 1 do not change.
Mixed
=$A1
The column letter A does not change.
The row number 1 can change.
Mixed
=A$1
The column letter A can change. The
row number 1 does not change.
24
Part I: Putting the Fun in Functions 

Copying formulas with the fill handle
As long as we’re on the subject of copying formulas around, take a look at the
fill handle. You’re gonna love this one! The fill handle is a quick way to copy
the contents of a cell to other cells with just a single click and drag.
The active cell always has a little square box in the lower-right side of its
border. That is the fill handle. When you move the mouse pointer over the 
fill handle, the mouse pointer changes shape. If you click and hold down the
mouse button, you can now drag up, down, or across over other cells. When
you let go of the mouse button, the contents of the active cell automatically
copy to the cells you dragged over.
A picture is worth a thousand words, so take a look. Figure 1-17 shows a
worksheet that adds some numbers. Cell E4 has this formula: =B4 + C4 +
D4. This formula needs to be placed in cells E5 through E15. Look closely at
cell E4. The mouse pointer is over the fill handle and it has changed to what
looks like a small black plus sign. We are about to use the fill handle to drag
that formula to the other cells. Clicking and holding the left mouse button
down and then dragging down to E15 does the trick.
Figure 1-18 shows what the worksheet looks like after the fill handle is used
to get the formula into all the cells. This is a real timesaver. Also, you can see
that the formula in each cell of column E correctly references the cells to its
left. This is the intention of using relative referencing. For example, the for-
mula in cell E15 ended up with this formula: =B15 + C15 + D15.
Assembling formulas the right way
There’s a saying in the computer business: garbage in, garbage out. And that
applies to how formulas are put together. If a formula is constructed the
wrong way, it either returns an incorrect result or an error.
Figure 1-17:
Getting
ready to
drag the
formula
down.
25
Chapter 1: Tapping into Formula and Function Fundamentals

Two types of errors can occur in formulas. In one type, Excel can calculate
the formula, but the result is wrong. In the other type, Excel is not able to 
calculate the formula. Check out both of these.
A formula can work and still produce an incorrect result. Excel does not report
an error because there is no error for it to find. Often this is the result of not
using parentheses properly in the formula. Take a look at some examples:
Formula
Result
=7 + 5 * 20 + 25 / 5
112
=(7 + 5) * 20 + 25 / 5
245
=7 + 5 *( 20 + 25) / 5
52
=(7 + 5 * 20 + 25) / 5
26.4
All of these are valid formulas, but the placement of parentheses makes a dif-
ference in the outcome. You must take into account the order of mathemati-
cal operators when writing formulas. The order is:
1. Parentheses
2. Exponents
3. Multiplication and division
4. Addition and subtraction
This is a key point of formulas. It is easy to just accept a returned answer.
After all, Excel is so smart. Right? Wrong! Like all computer programs, Excel
can only do what it is told. If you tell it to calculate an incorrect but struc-
turally valid formula, it will do so. So watch your p’s and q’s! Er, rather your
parentheses and mathematical operators when building formulas.
Figure 1-18:
Populating
cells with a
formula by
using the fill
handle.
26
Part I: Putting the Fun in Functions 

The second type of error is when there is a mistake in the formula or in the
data the formula uses that prevents Excel from calculating the result. Excel
makes your life easier by telling you when such an error occurs. To be pre-
cise, it does one of the following:
 Excel displays a message when you attempt to enter a formula that is
not constructed correctly.
 Excel returns an error message in the cell when there is something
wrong with the result of the calculation.
First, let’s see what happened when we tried to finish entering a formula that
had the wrong number of parentheses. Figure 1-19 shows this.
Excel finds an uneven number of open and closed parentheses. Therefore the
formula cannot work (it does not make sense mathematically) and Excel tells
you so. Watch for these messages; they often offer a solution.
On the other side of the fence are errors in returned values. If you got this far,
then the formula’s syntax passed muster, but something went awry nonethe-
less. Possible errors are:
 Attempting to perform a mathematical operation on text
 Attempting to divide a number by 0 (a mathematical no-no)
 Trying to reference a nonexistent cell, range, worksheet, or workbook
 Entering the wrong type of information into an argument function
This is by no means an exhaustive list of possible error conditions, but you
get the idea. So what does Excel do about it? There are a handful of errors
that Excel places into the cell with the problem formula. 
Figure 1-19:
Getting a
message
from Excel.
27
Chapter 1: Tapping into Formula and Function Fundamentals

Error Type
When It Happens
#DIV/0!
When you’re trying to divide by 0
#N/A!
When a formula or a function inside a formula
cannot find the referenced data
#NAME?
When text in a formula is not recognized
#NULL!
When a space was used instead of a comma in for-
mulas that reference multiple ranges; a comma is
necessary to separate range references
#NUM!
When a formula has numeric data that is invalid for
the operation type 
#REF!
When a reference is invalid
#VALUE!
When the wrong type of operand or function argu-
ment is used
Chapter 4 discusses catching and handling formula errors in detail.
Using Functions in Formulas
Functions are like little utility programs that do a single thing. For example,
the SUM function sums up numbers, the COUNT function counts, and the
AVERAGE function calculates an average.
There are functions to handle many different needs: working with numbers,
working with text, working with dates and times, working with finance, and 
so on. Functions can be combined and nested (one goes inside another).
Functions return a value, and this value can be combined with the results 
of another function or formula. The possibilities are nearly endless.
But functions do not exist on their own. They are always a part of a formula.
Now that can mean that the formula is made up completely of the function or
that the formula combines the function with other functions, data, operators,
or references. But functions must follow the formula golden rule: Start with
the equal sign. Look at some examples:
Function/Formula
Result
=SUM(A1:A5)
Returns the sum of the values in the range
A1:A5. This is an example of a function serv-
ing as the whole formula.
=SUM(A1:A5) /B5
Returns the sum of the values in the range
A1:A5 divided by the value in cell B5. This is
an example of mixing a function’s result with
other data.
28
Part I: Putting the Fun in Functions 

=SUM(A1:A5) + 
Returns the sum of the range A1:A5 added 
AVERAGE(B1:B5)
with the average of the range B1:B5. This is
an example of a formula that combines the
result of two functions.
Ready to write your first formula with a function in it? This function creates
an average:
1. Enter some numbers in a column’s cells.
2. Click an empty cell where you want to see the result.
3. Enter =AVERAGE( to start the function. 
Note: New in Excel 2007, Excel presents a list of functions that have the
same spelling as the function name you type. The more letters you type,
the shorter the list becomes. The advantage is, for example, typing the
letter A, using the ↓to select the AVERAGE function, and then pressing
the Tab key. 
4. Click the first cell with an entered value and, while holding the mouse
button, drag the mouse pointer over the other cells that have values. 
An alternative is to enter the range of those cells.
5. Enter a ).
6. Press Enter.
If all went well, your worksheet should look a little bit like ours, in Figure 1-20.
Cell B10 has the calculated result, but look up at the Formula Bar and you can
see the actual function as it was entered.
Formulas and functions are dependent on the cells and ranges to which they
refer. If you change the data in one of the cells, the result returned by the func-
tion updates. You can try this now. In the example you just did with making 
an average, click into one of the cells with the values and enter a different
number. The returned average changes.
Figure 1-20:
Entering the
AVERAGE
function.
29
Chapter 1: Tapping into Formula and Function Fundamentals

A formula can consist of nothing but a single function — preceded by an
equal sign, of course!
Looking at what goes into a function
Most functions take inputs — called arguments or parameters — that specify
the data the function is to use. Some functions take no arguments, some take
one, and others take many — it all depends on the function. The argument list
is always enclosed in parentheses following the function name. If there’s more
than one argument, they are separated by commas. Look at a few examples:
Function
Comment
=NOW()
Takes no arguments.
=AVERAGE(A6,A11,B7)
Can take up to 255 arguments.
Here, three cell references are
included as arguments. The
arguments are separated by
commas.
=AVERAGE(A6:A10,A13:A19,A23:A29)
In this example, the argu-
ments are range references
instead of cell references.
The arguments are separated
by commas.
=IPMT(B5, B6, B7, B8)
Requires four arguments.
Commas separate the 
arguments.
Some functions have required arguments and optional arguments. You must
provide the required ones. The optional ones are well, optional. But you may
want to include them if their presence helps the function return the value you
need.
The IPMT function is a good example. Four arguments are required and two
more are optional. You can read more about the IPMT function in Chapter 5.
You can read more about function arguments in Chapter 2.
Arguing with a function
Memorizing the arguments that every function takes would be a daunting
task. We can only think that if you could pull that off you could be on televi-
sion. But back to reality, you don’t have to memorize them because Excel
helps you select what function to use, and then tells you which arguments
are needed.
30
Part I: Putting the Fun in Functions 

Figure 1-21 shows the Insert Function dialog box. This great helper is accessed
by clicking the Function Wizard button on the Formulas Ribbon. The dialog
box is where you select a function to use.
The dialog box contains a listing of all available functions — and there are 
a lot of them! So to make matters easier, the dialog box gives you a way to
search for a function by a keyword, or you can filter the list of functions by
category.
If you know which category a function belongs in, you can click the function
category button in the Formulas Ribbon and select the function from the list.
Try it out! Here’s an example of how to use the Insert Function dialog box to
multiply together a few numbers:
1. Enter three numbers in three different cells.
2. Click an empty cell where you want the result to appear.
3. Click the Function Wizard button on the Formulas Ribbon. 
As an alternative, you can just click the little fx button on the Formula
Bar. The Insert Function dialog box appears.
4. Select either All or Math & Trig.
5. In the list of functions, find and select the PRODUCT function.
6. Click the OK button.
This closes the Insert Function dialog box and displays the Function
Arguments dialog box (see Figure 1-22), where you can enter as many
arguments as needed. Initially it might not look like it can accommodate
enough arguments. You need to enter three in this example, but it looks
like there is only room for two. This is like musical chairs!
Figure 1-21:
Using the
Insert
Function
dialog box.
31
Chapter 1: Tapping into Formula and Function Fundamentals

More argument entry boxes appear as you need them. First, though, how
do you enter the argument? There are two ways. 
7. Enter the argument one of two ways:
• Type the numbers or cell references into the boxes. 
• Use those funny-looking squares to the right of the entry boxes. 
In Figure 1-22 two entry boxes are ready to go. To the left of them are the
names Number1 and Number2. To the right of the boxes are the little
squares. These squares are actually called RefEdit controls. They make
argument entry a snap. All you do is click one, click the cell with the
value, and then press Enter. 
8. Click the RefEdit control to the right of the Number1 entry box.
The Function Arguments dialog box shrinks to just the size of the entry
box.
9. Click the cell with the first number. 
Figure 1-23 shows what the screen looks like at this point.
10. Press Enter.
The Function Arguments dialog box reappears with the argument entered
into the box. The argument is not the value in the cell, but instead is the
address of the cell that contains the value — exactly what you want.
11. Repeat Steps 7–9 to enter the other two cell references.
Figure 1-24 shows what the screen should now look like.
RefEdit controls
Figure 1-22:
Getting
ready to
enter some
arguments
to the
function.
32
Part I: Putting the Fun in Functions 

12. Click OK or press Enter to complete the function.
Figure 1-25 shows the result of all this hoopla. The PRODUCT function returns
the result of the individual numbers being multiplied together.
You do not have to use the Insert Function dialog box to enter functions into
cells. It is there for convenience. As you become familiar with certain func-
tions that you use repeatedly, you may find it faster to just type the function
directly into the cell.
Nesting functions
Nesting is something a bird does, isn’t it? Well, a bird expert would know the
answer to that one, but we do know how to nest Excel functions. A nested
function is tucked inside another function, as one of its arguments. Nesting
functions let you return results you would have a hard time getting to other-
wise. (Nested functions are used in examples in various places in the book.
The COUNTIF, AVERAGE, and MAX functions are discussed in Chapter 9.)
Figure 1-24:
Completing
the function
entry.
Figure 1-23:
Using
RefEdit 
to enter
arguments.
33
Chapter 1: Tapping into Formula and Function Fundamentals

Figure 1-26 shows the daily closing price for the S&P 500, for the month of
September 2004. A possible analysis is to see how many times the closing
price was higher than the average for the month. Therefore, the average
needs to be calculated first, before you can compare any single price. By
embedding the AVERAGE function inside another function, the average is first
calculated.
When a function is nested inside another, the inner function is calculated
first. Then that result is used as an argument for the outer function.
Figure 1-26:
Nesting
functions.
Figure 1-25:
Math was
never this
easy!
34
Part I: Putting the Fun in Functions 

The COUNTIF function counts the number of cells in a range that meet a 
condition. The condition in this case is that any single value in the range 
is greater than (>) the average of the range. The formula in cell D7 is 
=COUNTIF(B5:B25, “>” & AVERAGE(B5:B25)). The AVERAGE function 
is evaluated first, and then the COUNTIF function is evaluated using the
returned value from the nested function used as an argument.
Nested functions are best entered directly. The Insert Function dialog box
does not make it easy to enter a nested function. Try one out. In this exam-
ple, you use the AVERAGE function to find the average of the largest values
from two sets of numbers. The nested function in this example is MAX. You
enter the MAX function twice within the AVERAGE function:
1. Enter a few different numbers in one column.
2. Enter a few different numbers in a different column.
3. Click an empty cell where you want the result to appear.
4. Enter =AVERAGE( to start the function entry.
5. Enter MAX(.
6. Click the first cell in the second set of numbers, press the mouse
button, and drag over all the cells of the first set.
The address of this range enters into the MAX function.
7. Enter a closing parenthesis to end the first MAX function.
8. Enter a comma (,).
9. Once again, enter MAX(.
10. Click the first cell in the second set of numbers, press the mouse
button, and drag over all the cells of the second set. 
The address of this range enters into the MAX function.
11. Enter a closing parenthesis to end the second MAX function.
12. Enter a ).
This ends the AVERAGE function.
13. Press Enter.
Figure 1-27 shows the result of your nested function. Cell C14 has this for-
mula: =AVERAGE(MAX(B4:B10),MAX(D4:D10)).
When using nested functions, the outer function is preceded with an equal
sign (=) if it is the beginning of the formula. Any nested functions are not pre-
ceded with an equal sign.
35
Chapter 1: Tapping into Formula and Function Fundamentals

You can nest functions up to 64 levels.
Figure 1-27:
Getting a
result from
nested
functions.
36
Part I: Putting the Fun in Functions 

Chapter 2
Saving Time with Function Tools
In This Chapter
 Displaying the Insert Function dialog box
 Finding the function you need
 Using functions that don’t take arguments
 Getting help with functions
 Using the Function Arguments dialog box
E
xcel has so many functions that it’s both a blessing and a curse. You can
do many things with Excel functions — if you can remember them all!
Even if you remember many function names, memorizing all the arguments
the functions can use is a challenge.
Arguments are pieces of information that functions use to calculate and
return a value.
Never fear: Microsoft hasn’t left you in the dark with figuring out which 
arguments to use. Excel has a great utility to help insert functions, and their
arguments, into your worksheet. This makes it a snap to find and use the
functions you need. You’ll save both time and headaches, and make fewer
errors to boot — so read on!
Getting Familiar with the Insert 
Function Dialog Box
The Insert Function dialog box (shown in Figure 2-1) is designed to simplify
the task of using functions in your worksheet. The dialog box not only helps
you locate the proper function for the task at hand but also provides informa-
tion about the arguments that the function takes. If you use the Insert
Function dialog box, you don’t have to type functions directly into worksheet
cells. Instead, the dialog box guides you through a (mostly) point-and-click
procedure — a good thing, because if you’re anything like us, you need all the
help you can get.

In the Insert Function dialog box, you can browse functions by category or
scroll the complete alphabetical list. A search feature — where you type a
phrase in the Search for a Function box, click the Go button, and see what
comes up — is helpful. When you highlight a function in the Select a Function
box, a brief description of what the function does appears under the list. You
can also click the Help On This Function link at the bottom of the dialog box
to view more detailed information about the function.
You can display the Insert Function dialog box in three ways:
 Click the Function Wizard button on the Formulas Ribbon.
 On the Formula Bar, click the Insert Function button (which looks 
like fx).
 Click the small arrow at the bottom of the AutoSum feature on the
Formulas Ribbon and select More Functions. AutoSum has a list of
commonly used functions that you can insert with a click. If you select
More Functions, the Insert Function dialog box opens. See Figure 2-2.
Function Wizard button
AutoSum feature arrow
Insert Feature button
Figure 2-2:
The
AutoSum
button
offers quick
access to
basic
functions
and the
Insert
Function
dialog box.
Figure 2-1:
Use the
Insert
Function
dialog box
to easily
enter
functions 
in a
worksheet.
38
Part I: Putting the Fun in Functions 

Finding the Correct Function
The first step to using a function is finding the one you need! Even when you
do know the one you need, you may not remember all the arguments it takes.
You can find a function in the Insert Function dialog box in two ways:
 Search: Type one or more keywords or a phrase into the Search for a
Function box. Then click the Go button. 
• If a match is made, the Or Select a Category drop-down list dis-
plays Recommended, and the Select a Function box displays a list
of the functions that match your search. 
• If no match is made, the Or Select a Category drop-down list dis-
plays Most Recently Used functions, and the most recently used
functions appears in the Select a Function dialog box.
 Browse: Click the Or Select a Category down arrow and from the drop-
down list, select All, or select an actual function category. When an
actual category is selected, the Select a Function box updates to just the
relevant functions. You can look through the list to find the function you
want. Alternatively, if you know the category, you can select it on the
Formulas Ribbon.
Table 2-1 lists the categories in the Or Select a Category drop-down list.
Finding the function you need is different from knowing which function you
need. Excel is great at giving you the functions, but you do need to know
what to ask for.
Table 2-1
Function Categories in the Insert Function Dialog Box
Category
Type of Functions
Most Recently Used
The last several functions you used
All
The entire function list, sorted alphabetically
Financial
Functions for managing loans, analyzing investments, and
so forth
Date & Time
Functions for calculating days of the week, elapsed time,
and so forth
Math & Trig
A considerable number of mathematical functions
Statistical
Functions for using descriptive and inferential statistics
Lookup & Reference
Functions for obtaining facts about and data on worksheets
(continued)
39
Chapter 2: Saving Time with Function Tools

Table 2-1 (continued)
Category
Type of Functions
Database
Functions for selecting data in structured rows and
columns
Text
Functions for manipulating and searching text values
Logical
Boolean functions (AND, OR, and so forth)
Information
Functions for getting facts about worksheet cells and the
data therein
Engineering
Engineering and some conversion functions. These func-
tions are also provided in the Analysis ToolPak
Cube
Functions used with online analytical processing (OLAP)
cubes
User Defined
Any available custom functions created in VBA code or
from add-ins; this category may not be listed
Entering Functions Using the 
Insert Function Dialog Box
Now that you’ve seen how to search for or select a function, it’s time to use
the Insert Function dialog box to actually insert a function. The dialog box
makes it easy to enter functions that take no arguments and functions that do
take arguments. Either way, the dialog box guides you through the process of
entering the function.
Sometimes function arguments are not values but instead are references to
cells, ranges, named areas, or tables. That this is also handled in the Insert
Function dialog box makes its use so beneficial.
Selecting a function that 
takes no arguments
Some functions return a value, period. No arguments are needed for these
ones. This means you don’t have to have some arguments ready to go. What
could be easier? Here’s how to enter a function that does not take any argu-
ments. The TODAY function is used in this example:
40
Part I: Putting the Fun in Functions 

1. Position the cursor in the cell where you want the results to appear.
2. Click the Function Wizard button on the Ribbon to open the Insert
Function dialog box.
3. Select All in the Or Select a Category drop-down list.
4. Scroll through the Select a Function list until you see the TODAY func-
tion and click it once. 
Figure 2-3 shows what our screen looks like.
5. Click the OK button. 
The Insert Function dialog box closes and the Function Arguments
dialog box opens. The dialog box tells you that function does not take
any arguments. Figure 2-4 shows how the screen now looks.
6. Click the OK button. 
This closes the Function Arguments dialog box and the function entry is
complete.
Figure 2-4:
Confirming
no
arguments
exist with
the Function
Arguments
dialog box.
Figure 2-3:
Selecting a
function.
41
Chapter 2: Saving Time with Function Tools

You may have noticed that the Function Arguments dialog box says the
Formula result will equal Volatile. This is nothing to be alarmed about! This
just means the answer can be different each time you use the function. The
nitty-gritty is that the answer will change each time the worksheet recalculates.
Figure 2-5 shows how the function’s result has been returned to the work-
sheet. Cell B2 displays the date we wrote this example. The date you see on
your screen is the current date.
Most functions do take arguments. The few that do not take arguments can
return a result without needing any information. For example, the TODAY
function just returns the current date. It doesn’t need any information to
figure this out.
Selecting a function that uses arguments
Most functions take arguments to provide the information the function needs
to perform its calculation. Some functions use a single argument; others use
many. Taking arguments and using arguments are interchangeable terms.
Most functions take arguments, but the number of arguments depends on the
actual function. Some take a single argument, and some can take up to 255.
The following example shows how to use the Insert Function dialog box to
enter a function that does use arguments. The example uses the PRODUCT
function. Here’s how to enter the function and its arguments:
1. Position the cursor in the cell where you want the results to appear.
2. Click the Function Wizard button on the Ribbon. 
This opens the Insert Function dialog box.
Figure 2-5:
Populating a
worksheet
cell with
today’s date.
42
Part I: Putting the Fun in Functions 

3. Select Math & Trig in the Or Select a Category drop-down list.
4. Scroll through the Select a Function list until you see the PRODUCT
function and then click on it once. 
Figure 2-6 shows what the screen now looks like.
5. Click the OK button. 
The Insert Function dialog box closes and the Function Arguments dialog
box opens. Figure 2-7 shows what the screen looks like. The dialog box
tells you that this function can take up to 255 arguments, yet there
appears to be room for only 2. As you enter arguments, the dialog box
provides a scroll bar to manage multiple arguments.
Figure 2-7:
Ready to
input
function
arguments.
Figure 2-6:
Preparing to
multiply
some
numbers
with the
PRODUCT
function.
43
Chapter 2: Saving Time with Function Tools

6. In the Function Arguments dialog box, enter a number in the Number
1 box. 
7. Enter another number in the Number 2 box. 
You are entering actual arguments. As you enter numbers in the dialog
box, a scroll bar appears, letting you add arguments. Enter as many as
you like, up to 255. Figure 2-8 shows how we entered eight arguments.
Also look at the bottom left of the dialog box. As you enter functions, 
the Formula result is instantly calculated. Wouldn’t it be nice to be that
smart?
8. Click OK to complete the function entry. 
Figure 2-9 shows the worksheet’s result.
Figure 2-9:
Getting the
final answer
from the
function.
Figure 2-8:
Getting
instant
results in
the Function
Arguments
dialog box.
44
Part I: Putting the Fun in Functions 

Entering cells, ranges, named areas, 
and tables as function arguments
Excel is so cool. Not only can you provide single cell references as arguments,
but in many cases you can enter an entire range reference, or the name of an
area or table as a single argument! And what’s more, you can enter these
arguments using either the keyboard or the mouse.
This example demonstrates using both single cell and range references as
well as a named area and table as arguments. For this example we use the
SUM function. Here is how to use the Insert Function dialog box to enter the
function and its arguments:
1. Enter some numbers in a worksheet in contiguous cells. 
2. Select the cells, and then click the Table button on the Insert Ribbon. 
The Create Table dialog box opens. 
3. Click the OK button to complete making the table. 
The Ribbon should display table options. (If not, look along the Excel
title bar for Table Tools, and click it). On the left of the Ribbon is the
name that Excel gave the table. You can change the name of the table, as
well as the appearance.
4. Somewhere else on the worksheet, enter numbers in contiguous cells. 
5. Select the cells, and then click the Name a Range button on the
Formulas Ribbon. 
The New Name dialog box opens. 
6. Enter a name for the area. 
We used the name MyArea. See Figure 2-10 to see how the worksheet is
shaping up.
Figure 2-10:
Adding a
table and 
a named
area to a
worksheet.
45
Chapter 2: Saving Time with Function Tools

7. Enter some more numbers in contiguous cells either across a row or
down a column.
8. Enter a single number into cell A1.
9. Click an empty cell where you want the result.
10. Click the Function Wizard button on the Formulas Ribbon. 
The Insert Function dialog box opens.
11. Select the SUM function. 
SUM is in the All or Math & Trig categories, and possibly in the Recently
Used category.
12. Click OK.
The Function Arguments dialog box opens. To the right of each Number
box is a small fancy button — a special Excel control sometimes called
the RefEdit. It allows you to leave the dialog box, select a cell or range on
the worksheet, and then go back into the dialog box. Whatever cell or
range you click or drag over on the worksheet is brought into the entry
box as a reference.
You can type cell and range references, named areas, and table names
directly into the Number boxes as well. The RefEdit controls are there to
use if you want to work with the mouse instead.
13. Click directly on the first RefEdit.
The dialog box shrinks so that the only thing visible is the field where
you enter data. Click on cell A1, where you had entered a number.
14. Press the Enter key. 
The Function Arguments dialog box reappears.
15. In the second entry box, type the name of your named area. 
If you don’t remember the name you used, use the RefEdit control to
select the area on the worksheet. 
16. Press the Enter key.
17. In the third entry box, enter your table name and press the Enter key.
18. In the fourth entry box, enter a range from the worksheet where some
values are to be found. 
It does not matter that this range will likely be part of the named area or
table. Use the RefEdit if you wish to just drag the mouse over a range of
numbers. Your screen should look similar to that in Figure 2-11.
46
Part I: Putting the Fun in Functions 

19. Click the OK button. 
The final sum from the various parts of the worksheet displays in the
cell where the function was entered. Figure 2-12 shows how the example
worksheet turned out.
Congratulations! You did it. You successfully inserted a function that took a
cell reference, a range reference, a named area, and a table name. You’re har-
nessing the power of Excel. Look at the result — the sum of many numbers
found in various parts of the worksheet. Just imagine how much summing
you can do. You can have up to 255 inputs and, if needed, each one can be a
range of cells.
You can use the Insert Function dialog box at any time while entering a formula.
This is helpful when the formula uses some values and references in addition to
a function. Just open the Insert Function dialog box when the formula entry is at
the point where the function goes.
Figure 2-12:
Calculating
a sum
based on
cell and
range
references.
Figure 2-11:
Entering
arguments.
47
Chapter 2: Saving Time with Function Tools

Getting help in the Insert 
Function dialog box
The number of functions and their exhaustive capabilities gives you the power
to do great things in Excel. However, from time to time, you may need guidance
on how to get functions to work. Lucky for you, help is just a click away.
Both the Insert Function and Function Arguments dialog boxes have a link to
the Help system. At any time, you can click the Help On This Function link in
the lower-left corner of the dialog box and get help on the function you’re
using. The Help system has many examples; often reviewing how a function
works leads you to other, similar functions that may be better suited to your
situation.
Using the Function Arguments 
dialog box to edit functions
Excel makes entering functions with the Insert Function dialog box easy. But
what about when you need to change a function that has already been entered
into a cell? What about adding arguments or taking some away? There is an
easy way to do this!
1. Click in the cell with the existing function. 
2. Click the Function Wizard button. 
The Function Argument dialog box appears. This dialog box is already
set to work with your function. In fact, the arguments that have already
been entered into the function are displayed in the dialog box as well! 
3. Add, edit, or delete arguments. 
• To add an argument (if the function allows), use the RefEdit control
to pick up the extra values from the worksheet. Alternatively, if you
click in the bottom argument reference, a new box opens below it
into which you can enter a value or range. 
• To edit an argument, simply click into it and change it. 
• To delete an argument, click into it and backspace it out. 
4. Click OK when you’re finished. 
The function is updated with your changes.
48
Part I: Putting the Fun in Functions 

Directly Entering Formulas and Functions
As you get sharp with functions, you will likely bypass the Insert Function
dialog box altogether and enter functions directly. One place you can do this
is in the Formula Bar. Another way is to just type into a cell.
Entering formulas and functions 
in the Formula Bar
When you place your entry in the Formula Bar, the entry is really going into
the active cell. However, since the active cell can be anywhere, you may
prefer entering formulas and functions directly in the Formula Bar. That way
you know that the entry will land where you need it. Prior to entering a for-
mula in the Formula Box (on the right side of the Formula Bar), the Name Box
on the left lets you know where the entry will end up. The cell receiving the
entry may be not be in the visible area of the worksheet. Gosh, it could be a
million rows down and thousands of columns to the right! Once you start
entering the formula, the Name Box will present the function name currently
being assembled. The entry is completed when you press the Enter key, or
click the little check-mark button to the left of the Formula Box.
Figure 2-13 makes this clear. A formula is being entered into the Formula Box,
and the Name Box follows along with the function(s) being entered. Note,
though, that the active cell is not in the viewable area of the worksheet. It
must be below and/or to the right of the viewable area because the top-left
portion of the worksheet is shown in Figure 2-13.
Name Box
Complete
Function
button
Cancel
Function
button
Display the Insert
Function dialog box
Formula Bar
Formula Box
Figure 2-13:
Entering a
formula in
the Formula
Box has 
its con-
veniences.
49
Chapter 2: Saving Time with Function Tools

In between the Name Box and the Formula Box are three small buttons. From
left to right they do the following:
 Cancel the entry.
 Complete the entry.
 Display the Insert Function dialog box.
The Cancel and Complete Function buttons appear only when you enter a for-
mula, a function, or just plain old values in the Formula Bar. If you type the
entry into a cell, the Cancel and Complete Function buttons do not appear. 
Entering formulas and functions 
directly in worksheet cells
Perhaps the easiest entry method is typing the formula directly in a cell. Just
type formulas that contain no functions and pressing the Enter key completes
the entry. Try out this simple example:
1. Click a cell where the formula is to be entered.
2. Enter this simple math-based formula: =6 + (9/5) *100.
3. Press the Enter key.
The answer is 186. (Don’t forget the order of operators; see Chapter 4 for
more information about the order of mathematical operators.)
Excel 2007 has made entering functions into your formulas as easy as a click.
As you type the first letter of a function into a cell, immediately a list of func-
tions starting with that letter is listed. See Figure 2-14.
Figure 2-14:
Entering
functions
has never
been this
easy.
50
Part I: Putting the Fun in Functions 

The desired function in this example is MIN, which returns the minimum
value from a group of values. As soon as we type M, the list in Figure 2-14
appears, showing all the M functions. Now that an option exists, either keep
typing in the full function name, or scroll to MIN and press the Tab button.
Figure 2-15 shows just what happens when we do the latter: MIN is completed
and provides the required syntax structure — not much thinking involved!
Now your brain can concentrate on more interesting things, such as poker
odds. (Will Microsoft ever create a function category for calculating poker
odds? Please?) In Figure 2-15 the MIN function is used to find the minimum
value in the range A7:A15. Entering the closing parenthesis and then pressing
the Enter key completes the function. In this example the answer is 21.
Excel’s ability to show a list of functions based on spelling is called Formula
AutoComplete.
You can turn Formula AutoComplete on or off in the Excel Options dialog
box:
1. Click the Microsoft Office button at the top left of the screen.
2. In the File box, click Excel Options (at the bottom of the dialog box).
3. In the Excel Options dialog box, select the Formulas tab.
4. In the Working with Formulas section, check or uncheck the Formula
AutoComplete check box. 
See Figure 2-16 for the check box’s placement.
Figure 2-15:
Completing
the direct-
in-the-cell
formula
entry.
51
Chapter 2: Saving Time with Function Tools

5. Click the OK button. 
Figure 2-16:
Setting
Formula
Auto-
Complete.
52
Part I: Putting the Fun in Functions 

Chapter 3
Saying “Array!” for Formulas 
and Functions
In This Chapter
 Understanding arrays
 Creating formulas that use arrays
 Using functions that return arrays of data
E
xcel is really quite sophisticated — its many built-in functions make your
work easier. On top of that, Excel allows you to tell functions to work on
entire sets of values, called arrays, which makes for even more clever analysis.
An array is a set of two or more values (for example, the contents of two 
or more worksheet cells, or even the contents of two or more worksheet
ranges). Certain functions use arrays for arguments.
You may be thinking “Hey, how is this different from just entering a bunch of
arguments?” You’re right in the comparison. For example, the SUM function
can take up to 255 arguments. Isn’t this the same as giving the function an
array with 255 values? Well, yes and no. It’s the same idea, but using the array
approach can streamline your work, as you soon see.
There is even another side to array functions. Some of the functions return an
array. Yes, that’s right. Most of the time a function returns a single value into
a single cell. In this chapter, we show you how a function returns a group of
values into multiple cells.
Discovering Arrays
An array is like a box. It can hold a number of items. In Excel, an array holds a
collection of values or cell references. These arrays are used exclusively in
formulas and functions. That is, the association of some values as one cohe-
sive group exists just for the purpose of calculating results. An array differs

from the named areas (a range of cells) that you can create in Excel. Named
areas become part of the worksheet and can be referenced at any time.
Named areas are set using the New Name dialog box, shown in Figure 3-1. In
contrast, there is no such dialog box or method to create arrays that can be ref-
erenced from functions or formulas. Arrays, instead, are embedded in formulas.
Named areas are easily referenced in formulas. For example, if a workbook
contains a named area Sales, then the values of all the cells in Sales can be
summed up like this:
=SUM(Sales)
Assume that Sales contains three cells with these values — 10, 15, and 20.
These values of course can be directly entered in the SUM function like this:
=SUM(10,15,20)
This is almost an array, but not quite. Excel recognizes a group of values to
be an array when they are enclosed with braces ({ and }). Therefore, to enter
the array of values into the function, the entry looks like this:
=SUM({10,15,20})
Essentially the braces tell Excel to treat the group of values as an array. So
far, you may be wondering about the usefulness of an array, but in the next
section, we show you how using arrays with standard functions such as SUM
can provide sophisticated results.
To enter values as an array within a function, enclose them with braces.
Braces have a curly look to them, not to be confused with brackets. On a typi-
cal keyboard braces and brackets are on the same key. Holding the Shift key
while pressing the brace/bracket key provides the brace. 
However, getting the braces into the formula takes a particular keystroke.
You don’t type braces in directly. 
Figure 3-1:
Creating a
named area
with the
New Name
dialog box.
54
Part I: Putting the Fun in Functions 

Using Arrays in Formulas
You can use arrays when entering formulas and functions. Typically the argu-
ments to a function are entered in a different manner, which we demonstrate
in this section. Using arrays can save entry steps and deliver an answer in a
single formula. This is useful in situations that normally require a set of inter-
mediate calculations from which the final result is calculated. We don’t know
about you, but we like shortcuts, especially when we have too much to do!
Here’s an example: The SUM function is normally used to add a few numbers
together. Summing up a few numbers doesn’t require an array formula per se,
but what about summing up the results of other calculations? This next
example shows how using an array simplifies getting to the final result.
Figure 3-2 shows a small portfolio of stocks. Column A has the stock symbols,
Column B has the number of shares per stock, and Column C has a recent
price for each stock.
The task is to find out the total value of the portfolio. The typical way to do
this is to
1. Multiply the number of shares for each stock by its price.
2. Sum up the results from Step 1.
Figure 3-3 shows a very common way to do this. Column D contains formulas
to calculate the value of each stock in the portfolio. This is done by multiply-
ing the number of shares for each stock by its price. For example, cell D4 con-
tains the formula =B4*C4. Cell D10 sums up the interim results with the
formula =SUM(D4:D8).
Figure 3-2:
A stock
portfolio.
55
Chapter 3: Saying “Array!” for Formulas and Functions

The method shown in Figure 3-3 requires creating additional calculations —
those in Column D. These are necessary if you need to know the value of each
stock, but not if all you need to know is the value of the portfolio as a whole.
Fortunately, alternatives to this standard approach exist. One is to embed the
separate multiplicative steps directly inside the SUM function, like this:
=SUM(B4*C4,B5*C5,B6*C6,B7*C7,B8*C8)
That works, but it’s bloated to say the least. What if you had 20 stocks in the
portfolio? Forget it!
Another alternative is the SUMPRODUCT function. This function sums the
products, just as the other methods shown here also do. The limitation, 
however, is that SUMPRODUCT can only be used for summing. It cannot, for
example, give you an average.
In many situations such as this one, your best bet is to use an array function.
Figure 3-4 shows the correct result from using the SUM function entered as an
array function. Notice that the formula in the Formula Bar begins and ends
with a brace.
Figure 3-4:
Calculating
the value 
of a stock
portfolio
using an
array
function.
Figure 3-3:
Calculating
the value 
of a stock
portfolio, 
the old-
fashioned
way.
56
Part I: Putting the Fun in Functions 

The syntax is important. Two ranges are entered into the function: One con-
tains the cells that hold the number of shares, and the other contains the cells
that have the stock prices. These are multiplied in the function by entering the
multiplication operator (*):
{=SUM(B4:B8*C4:C8)}
Ctrl + Shift + Enter had been pressed to turn the whole thing into an array
function. That special keystroke combination is done when finishing the for-
mula, and not before. Note the lack of subtotals (per stock) in cells D4:D8.
Compare Figure 3-4 with Figure 3-3 and you can see the difference.
Use Ctrl + Shift + Enter to turn a formula into an array formula. You must use
the key combination after entering the formula instead of pressing the Enter
key. The key combination takes the place of the press of the Enter key.
Try this out. Here’s how you use an array with the SUM function:
1. Enter two columns of values.
The two lists must be the same size.
2. Position the cursor in the cell where you want the result to appear.
3. Enter =SUM( to start the function. 
Note how a brace has not been entered in this step.
4. Click the first cell in the first list and while holding the left mouse
button down; drag the pointer over the first list. Then release the
mouse button.
5. Enter the multiplication sign (*).
6. Click the first cell of the second list, hold down the left mouse button,
and drag the pointer over the second list. 
7. Release the mouse button.
8. Enter a ).
9. Press Ctrl + Shift + Enter to end the function. 
Do not just press the Enter key by itself when using an array with the
SUM function.
Array functions are useful for saving steps in mathematical operations.
Therefore you can apply these examples to a number of functions, such as
AVERAGE, MAX, MIN, and so on.
57
Chapter 3: Saying “Array!” for Formulas and Functions

As another example, suppose you run a fleet of taxis and you need to calcu-
late the average cost of gasoline per mile driven. This is easy to calculate for
a single vehicle. You just divide the total miles driven by the total spent on
gasoline, for a given period of time. The calculation looks like this:
cost of gasoline per mile = total miles driven ÷ total amount spent 
on gasoline
How can you easily calculate this for a fleet of vehicles? Figure 3-5 shows how
this is done. The vehicles are listed in Column A, the total miles driven for
the month appear in Column B, and the total amounts spent on gasoline
appear in Column C.
One single formula in cell C21 answers the question. By using the AVERAGE
function in an array formula, the result is returned without the need for any
intermediate calculations. The formula looks like this:
{=AVERAGE(C6:C17/B6:B17)}.
Working with Functions 
That Return Arrays
A few functions actually return arrays of data. Instead of providing a single
result, as most functions do, these functions return several values. The
number of actual returned values is directly related to the function’s 
arguments. The returned values go into a range of cells.
Figure 3-5:
Making an
easy
calculation
using an
array
formula.
58
Part I: Putting the Fun in Functions 

Excel array functions accept arrays as arguments and possibly return arrays
of data.
A good example of this is the TRANSPOSE function. This interesting function
is used to reorient data. Data situated a given way in columns and rows is
transposed (changed to be presented instead in rows and columns). Figure
3-6 shows how this works.
Cells B3 through D10 contain information about departments in a company.
Departments are listed going down Column B. Note that the area of B3
through D10 specifically occupies three columns and eight rows. The header
row is included in the area.
Cells B16 through I18 contain the transposed data. It is the same data, but
now it occupies eight columns and three rows. In total number of cells, this is
the same size as the original area. Just as important is that the area is made
up of the same dimensions, just reversed. That is, a 3-by-8 area became an 8-
by-3 area. The number of cells remains at 24. However the transposed area
has not been altered to be 6 by 3 or 2 by 12, or any other two dimensions that
cover 24 cells.
Every single cell in the B16:I18 range contains the same formula: {=TRANSPOSE
(B3:D10)}. However, the function was entered only once.
In detail, here is how you can use the TRANSPOSE function:
1. Enter some data that occupies at least two adjacent cells.
Creating an area of data that spans multiple rows and columns is best
for seeing how useful the function is.
Figure 3-6:
Transposing
data.
59
Chapter 3: Saying “Array!” for Formulas and Functions

2. Elsewhere on the worksheet, select an area that covers the same
number of cells but has the length of the sides of the original area
reversed.
For example:
• If the original area is two columns and six rows, then select an area
that is six columns and two rows.
• If the original area is one column and two rows, then select an area
that is two columns and one row.
• If the original area is 200 columns and 201 rows, then select an area
that is 201 columns and 200 rows.
• If the original area is five columns and five rows, then select an
area that is five columns and five rows. (A square area is trans-
posed into a square area.)
Figure 3-7 shows an area of data and a selected area ready to receive the
transposed data. The original data area occupies 11 columns and 3 rows.
The selected area is 3 columns by 11 rows.
3. Enter =TRANSPOSE( to start the function.
4. Click the first cell in the original data and drag the pointer over the
entire original data area while keeping the mouse button down.
The function now shows the range of the original area. Figure 3-8 shows
how the entry should appear at this step.
5. Enter a ).
Figure 3-7:
Preparing
an area to
receive
transposed
data.
60
Part I: Putting the Fun in Functions 

6. Press Ctrl + Shift + Enter to end the function.
Note: The transposed data does not take on the formatting of the original
area. You need to format the area as needed. Figure 3-9 shows the result of
using TRANSPOSE and then formatting the transposed data.
Wait! Isn’t this a waste of time? Excel can easily transpose data using the
Paste Special dialog box. Simply copying a range of data and using this dialog
box to paste the data gives the same result as the TRANSPOSE function. Or
does it?
Figure 3-10 shows the Paste Special dialog box with the Transpose check box
checked. This will transpose the data. You don’t even have to select the cor-
rect number of rows and columns where the transposed data will land. It just
appears transposed, with the active cell as the corner of the area.
Figure 3-9:
Transposed
data after
formatting.
Figure 3-8:
Completing
the function.
61
Chapter 3: Saying “Array!” for Formulas and Functions

However, when data is transposed with the Paste Special dialog box, the
actual data is copied to the new area. By contrast the TRANSPOSE function
pastes a formula that references the original data — and that is the key point.
When data is changed in the original area, the change is reflected in the new,
transposed area, if the TRANSPOSE function was used.
You can transpose data in two ways. The area filled with the TRANSPOSE
function references the original data and will update as original data is
changed. Using the Paste Special dialog box to transpose data creates values
that do not update when the original data changes.
Figure 3-10:
Using the
Paste
Special
dialog box
to transpose
data.
62
Part I: Putting the Fun in Functions 

Chapter 4
Fixing Formula Boo-Boos
In This Chapter
 Preventing errors with Excel
 Following the flow of cell and range references to and from formulas
 Using Excel’s array of tools to uncover and correct formulas
E
xcel would be nothing if it didn’t allow you to create formulas. Creating
formulas is, after all, the real purpose of a worksheet — to allow you to
build a solution that pertains to your specific needs. Without formulas, Excel
would be no more than a place to store information. Boring!
Excel allows formulas to have up to 8,192 characters in length. This means
you can create some monster formulas! Formulas can reference cells that
have formulas that reference other cells that have formulas that reference . . .
well, you get the idea!
Ah, but this comes with a price — how can you track down errors in long for-
mulas? How can you avoid them in the first place? In this chapter, we explain
how Excel steers you away from entering problematic formulas, and how to
correct completed formulas that are not working in the way you intended.
Catching Errors as You Enter Them
Excel is keeping an eye on you when you enter formulas. Don’t be worried!
This is a good thing. You aren’t being graded. Excel is helping you, not 
testing you.
All formulas start with an equal sign. When you complete an entry by press-
ing Enter or Tab (or clicking into another cell), Excel scans the entry. If the
entry did indeed start with an equal sign, then Excel immediately looks for
three major problems:

 Do the number of open and closed parentheses match?
 Does the formula reference the same cell it is entered in? For example
what if cell A1 has this formula: =A1*5. This is called a circular reference.
This is a bit like a dog chasing its tail.
 Does the formula refer to a nonexistent reference?
Each of the problems is handled differently. Excel will offer a fix for mis-
matched parentheses but will only warn you about formulas that reference
the cell they are entered in. For nonexistent references, Excel will ask you
where to find them. Excel will display an Open File type of dialog box that you
use to browse to the reference, assuming the reference is meant to come
from an external workbook. If a reference to an external workbook was not
the intention, then the dialog box won’t make sense. In this case, dismiss the
dialog box and edit the formula.
Getting parentheses to match
In a mathematical formula, each open parenthesis must have a matching 
closing parenthesis. Excel checks your formulas to make sure they comply.
Figure 4-1 shows a simple business calculation that requires parentheses to
make sense. The result is based on multiplying units by price per unit, adding
an additional purchase amount to that, then applying a discount, and finally
applying tax.
In math terms here is how the formula works:
(units sold × price per unit + additional cost) × discount × (1 + tax rate)
Figure 4-1:
Using
parentheses
in a formula.
64
Part I: Putting the Fun in Functions 

The placement of the parentheses is critical to making the formula work.
Excel won’t sense a problem if any particular parenthesis is in the wrong
place as long as there is a matching number of open and closed parentheses.
For example, using the cells and values from Figure 4-1, here are some possi-
bilities of valid formulas that return incorrect answers:
Formula
Result
=B3*(B4+B6) * B8 * (1 + B9)
5626.84
=B3*B4+(B6 * B8) * (1 + B9)
549.13
=(B3*B4+B6 * B8) * (1 + B9)
589.96
=(B3*B4+B6) * (B8 * 1 + B9)
299.15
Correct parentheses placement and a firm understanding of mathematical-
operator precedence are critical to calculating correct answers. We suggest a
brush up on these basic math concepts if you aren’t sure how to construct
your formulas. See Chapter 18 for more. 
There is a great mnemonic for orders of operation: Please excuse my dear
Aunt Sally. By the way, I had to excuse my dear Aunt Honey for undercooking
the stuffing one year at Thanksgiving. Great meal, and then we all got sick!
What if, during entry, a parenthesis is left out? When you try to complete the
entry, Excel will pop up a warning and a suggestion. In this example, the first
closed parenthesis is purposely left out. Here is the incorrect formula: =(B3*
B4+B6*B8*(1+B9).
Figure 4-2 shows how Excel catches the error and offers a solution.
Figure 4-2:
Fixing
mismatched
parentheses.
65
Chapter 4: Fixing Formula Boo-Boos

Don’t be hasty! The correction proposed by Excel will correct the mismatched
parentheses but will not create the correct formula. Look closely at the follow-
ing example of a proposed correction by Excel: =(B3*B4+B6*B8*(1+B9)).
But what you really need is this: =(B3*B4+B6)*B8*(1+B9).
Excel simply added the missing parenthesis to the end of the formula. A good
idea, but not good enough. If the proposed correction were accepted, a result
of $549.13 would be returned in this example. The correct answer is $268.46.
In this case, you should reject the proposal and fix the formula yourself.
Do not assume Excel’s proposed formula corrections are right for you.
Carefully review the proposed correction and accept or reject accordingly.
Avoiding circular references
A circular reference occurs when a cell refers to itself, whether directly or
indirectly. For example, if =100 + A2 is entered into cell A2, then a direct 
circular reference has been created. An indirect circular reference is when
the formula in a given cell refers to one or more other cells that in return
refer back to the original cell. For example a formula in A1 refers to cell A2,
A2 refers to A3, and A3 refers back to A1.
Figure 4-3 shows a worksheet that has a direct circular reference. Cell D10 is
meant to sum the values above it but mistakenly includes itself in the sum:
=SUM(D4:D10). Excel reports the problem in the message box shown in
Figure 4-3.
Figure 4-3:
Correcting a
circular
reference.
66
Part I: Putting the Fun in Functions 

If Automatic Calculation is turned off, then the circular reference is unnoticed
until a manual calc is done (by pressing F9) or the setting is changed to
Automatic Calculation.
When the dialog box in Figure 4-3 appears, you have a few choices:
 Clicking OK takes you to the Help system Circular Reference topic.
 Clicking Cancel accepts the formula as is.
 Clicking Help takes you to the Help system Circular Reference topic.
The dialog box in Figure 4-3 may be different from what you see. The dialog
box has the option of clicking the OK button to display the Circular Reference
toolbar, which no longer exists. 
Figure 4-4 shows the Formulas tab in the Excel Options dialog box. Here is
where the calculation setting — automatic or manual — is set. Note that the
Iteration check box is here as well. When this is set, circular references are
allowed. How they calculate values in this case is dependent on the Maximum
Iterations and Maximum Change settings.
Checking and applying iterations on the Calculation tab of the Options dialog
box allows you to use circular references in your formulas, useful for certain
advanced calculations that are beyond the scope of this book. (See Excel
Help for more information.)
Figure 4-4:
Setting
calculation
and iteration
settings.
67
Chapter 4: Fixing Formula Boo-Boos

Excel 2007 has a new approach to hunting down circular references. The
Formulas tab on the Ribbon has a section named Formula Auditing. In this
section is an Error Checking drop-down list that shows any circular refer-
ences. See Figure 4-5.
The drop-down will list circular references, and clicking on one will take you to
the listed cell with the circular reference. This allows you to get to them easily
instead of having to review all your formulas. Hey, now that’s a timesaver! 
Mending broken links
Formulas can reference external workbooks. As an example, a formula 
could be written like this: =’C:\Inventory\[Inventory.xls]Engine
Parts’!$D$8. The formula uses the value found in the external workbook
Inventory.xls. What if the workbook is not found?
Links become broken when external workbooks have been moved, deleted,
or renamed. When a workbook that contains an external reference is opened
but cannot find the other workbook(s) referenced in one or more formulas,
then a warning message appears. Figure 4-6 shows the message that pops up
when a link is broken.
Figure 4-6:
Deciding
what to do
when
formulas
reference
unfound
external
workbooks.
Figure 4-5:
Hunting
down
circular
references.
68
Part I: Putting the Fun in Functions 

You have two choices when the error message appears:
 Click the Continue button. The cells that contain formulas that refer-
ence external workbooks just present results calculated with the last
known values found in the external workbooks from previous sessions.
 Click the Edit Links button. This action displays the Edit Links dialog
box shown in Figure 4-7. This dialog box offers a number of choices for
handling the broken links.
The Edit Links dialog box gives you options on how to handle broken links.
The buttons along the right side of the dialog box work like this:
 Update Values: When external workbooks are where they should be, this
action gets the values from the external workbooks, and the cells with
those formulas are recalculated. When there are broken links, an Open
File type of dialog box appears from which you browse to a file from
which to get the values. This does not necessarily have to be the miss-
ing workbook — it could be another workbook. A point to be aware of is
that using Update Values in this manner does not fix the link. It helps
you get values but does not change the way formulas are written.
Instead, use the Change Source option, listed next.
 Change Source: This option displays an Open File type of dialog box that
lets you select an external workbook to use. Selecting a workbook in this
dialog box actually alters the formula that references the external work-
book. So, this is the best course to take to permanently fix a broken link.
 Open Source: In the case of broken links, this action does nothing
because the source (the external workbook) cannot be found. An error
message will confirm this. In the case of working links, this action opens
the workbook referenced in the link.
Figure 4-7:
Using the
Edit Links
dialog box
to correct
external
reference
problems.
69
Chapter 4: Fixing Formula Boo-Boos

 Break Link: This action converts formulas that contain external links 
to the calculated values. In other words, the cells that contain formulas
with external links are replaced with a value; the formulas are removed.
Make sure this is what you want to do. You cannot undo this action, and
it can be a serious mistake if you did this unintentionally. Excel displays
a confirmation of this, shown in Figure 4-8.
 Check Status: Provides status about links. A number of values are possi-
ble (such as OK, Unknown, Error: Source not found, Error: Worksheet
not found, and so on). In the Edit Links dialog box (refer to Figure 4-7),
Status is a column in the middle of the dialog box. Each link receives its
own status.
The Edit Links dialog box shown in Figure 4-7 also has the StartUp Prompt
button in the lower left. Clicking this button leads to a choice of what the
workbook should do when opened and there are no external links. The
choices are:
 Let users choose whether to display the alert.
 Don’t display the alert and don’t update automatic links.
 Don’t display the alert but do update automatic links.
Using the Formula Error Checker
Some errors are immediately apparent, such as mismatched parentheses
explained earlier. Other types of entries are not blatant errors but instead
resemble errors. In this case, Excel alerts you to the possible problem and
lets you choose how to handle it.
Figure 4-9 shows a few numbers and a sum at the bottom. The formula in cell
B10 is =SUM(B4:B9). There is nothing wrong here, no possible error yet.
Note that in Figure 4-9 the headings row is not adjacent to the rows of infor-
mation. Rows 2 and 3 are in between the headings and the data. This is not
unusual, because this leads to a clean-looking report.
Figure 4-8:
Confirming
that you
mean to
break links.
70
Part I: Putting the Fun in Functions 

However, watch what happens if a value is accidentally entered into the area
between the headings and the data. The formula in cell B10 calculates values
starting in Row 4. When a value is entered in cell B3, Excel alerts you that
there may be an error. You can see this in Figure 4-10. A small triangle is now
visible in the upper-left corner of cell B10 — the cell with the formula.
Clicking back into cell B10, and moving the pointer over the triangle, causes 
a small symbol with an exclamation point to appear. Clicking the symbol 
displays a list of choices, shown in Figure 4-11.
An error is represented by a triangle in the upper-left corner of a cell. This 
is different from a smart tag, which is seen as a triangle in the lower-right
corner of a cell. Smart tags lead to helpful options based on the contents 
of the cell. See the Excel Help system for more information on Smart Tags.
Figure 4-11:
Deciding
what to do
with the
possible
error.
Figure 4-10:
Excel
senses a
possible
error.
Figure 4-9:
Calculating
a sum, no
possible
error.
71
Chapter 4: Fixing Formula Boo-Boos

The first item in the list is just a statement of the problem. In this example,
the statement is “Formula Omits Adjacent Cells.” Sure enough, it does just
that! But is it an error? Did you mean to enter the extra value in cell B3?
Perhaps it has some other meaning or use.
The other items in the list give you options for what to do:
 Update Formula to Include Cells: Automatically changes the formula to
include the extra cell in this example. So the formula in cell B10 changes
from =SUM(B4:B9) to =SUM(B3:B9). And, of course, the calculated
sum will change as well.
 Help on This Error: Steers you to Excel’s Help system.
 Ignore Error: Removes the list and returns you to the worksheet. The
triangle is removed from the cell in question. You’ve told Excel that you
know what you’re doing and you want Excel to butt out. Good job!
 Edit in Formula Bar: The cursor is placed in the Formula Bar so you 
can easily edit the formula.
 Error Checking Options: Displays the Error Checking tab from the
Formulas tab in Excel’s Options dialog box (shown in Figure 4-12). In 
this tab, you set options on how Excel handles errors.
Auditing Formulas
With Excel, you can create some fairly complex solutions. A cell can contain a
formula that uses values from multitudes of other cells and ranges. Working
Figure 4-12:
Setting
error-
handling
options.
72
Part I: Putting the Fun in Functions 

through long, complex formulas to track down problems can be quite
tedious. The good news is that Excel has a way to help!
Formulas may contain precedents and may serve as dependents to 
other formulas:
 Precedents are cells or ranges that affect the active cell’s value.
 Dependents are cells or ranges affected by the active cell.
It’s all relative! A cell often serves as both a precedent and a dependent. Figure
4-13 shows a simple worksheet with some values and some calculations. Cell
B9 contains the formula =SUM(B3:B8). Cell B21 contains the formula =SUM
(B15:B20). Cell E25 contains the formula =B9-B21.
 Cells B3:B8 are precedents of B9, but at the same time cell B9 is 
dependent on all the cells in B3:B8.
 Cells B15:B20 are precedents of B21, but at the same time cell B21 is
dependent on all the cells in B15:B20.
 Cells B9 and B21 are precedents of E25, but at the same time cell E25 
is dependent on cells B9 and B21.
 Cell E25 is not dependent on any other cell.
To help follow and fix formulas, Excel provides formula auditing tools. The
Ribbon’s Formula Auditing section of the Formulas tab has three buttons that
let you use formula auditing. Figure 4-14 shows the worksheet from Figure
4-13 with visible precedent and dependent lines. The methods for displaying
these lines are shown in the Ribbon. 
Figure 4-13:
Under-
standing
precedents
and
dependents.
73
Chapter 4: Fixing Formula Boo-Boos

Precedent and Dependent lines are always inserted from or to the active cell.
From the active cell:
 To see what other cells are referenced in the active cell’s formula, click
the Trace Precedents button.
 To see which other cells contain a reference to the active cell, click the
Trace Dependents button.
The Remove Arrows drop-down menu has three choices:
 Remove Arrows
 Remove Precedent Arrows
 Remove Dependent Arrows
In Figure 4-14, cells B9 and B21 have arrows that originate in the cells above.
This shows the flow of precedents into the given cells. The arrow head rests in
the cell that has the formula that contains the references of the precedents.
On the other hand, cells B9 and B21 themselves then have lines coming from
them and ending as arrow heads in cell E25. Therefore, B9 and B21 serve as
precedents to cell E25. Or, said another way, cell E25 is dependent on cells B9
and B21.
Double-clicking a tracer arrow activates the cell on one end of the line.
Double-clicking again activates the cell on the other end.
Tracing precedents and dependents can lead to some interesting conclusions
about a worksheet. Complex formulas can be difficult to follow, but by dis-
playing tracer arrows, you can better see what is going on. Figure 4-15 shows
Figure 4-14:
Tracing
formulas.
74
Part I: Putting the Fun in Functions 

a piece of a worksheet used in a comprehensive financial solution. The active
cell, X22, has a complex formula in it, as you can see by looking at the
Formula Bar. The tracer arrows show that numerous precedents are feeding
the formula in the active cell.
The tracer arrows make it easy to see the values that are feeding the formula
and, therefore, make it easier to look for the source of a problem. For exam-
ple, cell X22 may be returning a negative number as an answer. The formula
multiples certain values together. A positive number multiplied by a negative
number returns a negative number as the answer. Therefore, just looking for
a negative number among the values at the end of the tracer arrows may help
identify the problem, perhaps within just a few seconds!
Watching the Watch Window
The Watch Window lets you watch the calculated results of a formula but
without the limitation of having the cell be in the viewing area of Excel. This
is helpful when you’re working on correcting formulas that use precedents
that are scattered about the worksheet or workbook.
First, to set up a watch, follow these steps:
1. Click the Watch Window button on the Formulas tab on the Ribbon.
2. In the Watch Window, click the Add Watch button. 
The Add Watch dialog box opens.
3. Use the RefEdit control (the square button to the right of the entry
box) to specify the cell(s), or type in the cell address or range.
4. Click the Add button in the Add Watch dialog box to complete setting
up the watch.
Figure 4-15:
Examining
the compo-
nents of a
complex
formula.
75
Chapter 4: Fixing Formula Boo-Boos

Figure 4-16 shows the Watch Window with a watch already in place. Cell C6
on the Costs worksheet is being watched. The formula uses precedents from
both the Orders and Shipping worksheets. The Watch Window sits on top of
the workbook and stays visible regardless of which worksheet is active. This
means, for example, that you could try out different values on the Orders
worksheet and see the result in the calculation in Costs!C6, but without
having to bounce around the worksheets to see how new values alter the 
calculated result.
The Watch Window also lets you delete a watch. That’s a good thing; other-
wise you would end up with a bunch of watches you no longer need! To
delete a watch, perform these steps:
1. Select a watch from the list of watches in the Watch Window.
2. Click the Delete Watch window.
Evaluating and Checking Errors
The Evaluate Formula dialog box walks you through the sequential steps
used in calculating a result from a formula. This is useful to track down errors
in formulas that are long, or have precedents. For example, the formula
=IF(MAX(Orders!B2:B29)>200,MAX(Orders!B2:B29)*Shipping!C22
,Shipping!C24) refers to different worksheets. Using the Evaluate Formula
dialog box makes it easy to see how this formula is worked out by Excel. The
step-by-step approach lets you see what is done at each step.
Figure 4-17 shows the Evaluate Formula dialog box at the start of evaluating the
formula. To display the Evaluate Formula dialog box, simply click the Evaluate
Formula button on the Ribbon. With each successive click on the Evaluate
button, the Evaluation box displays the interim results. The Step In and Step
Out buttons are enabled during the steps that work on the precedents.
Figure 4-16:
Using the
Watch
Window to
keep an 
eye on a
formula’s
result.
76
Part I: Putting the Fun in Functions 

The Evaluate Formula dialog box is great for really seeing how each little step
feeds into the final calculated result. Using this dialog box lets you pinpoint
exactly where a complex formula has gone sour.
A similar error-hunting tool is the Error Checking dialog box. (Excel really
wants to help you out!) Figure 4-18 shows the dialog box. 
Display the Check Error dialog box by clicking the Error Checking selection 
in the Error Checking drop-down menu on the Ribbon (on the Formulas tab,
of course).
The dialog box has a handful of buttons that let you analyze the error and
make decisions about it: 
 Help On This Error starts the Excel Help system.
 Show Calculation Steps opens the Evaluate Formula dialog box.
 Ignore Error ensures that Excel no longer cares about the error. The 
cell may still display an error symbol, but Excel does not give a hoot,
and probably you won’t either, since you clicked the button.
 Edit in the Formula Bar places the cursor in the Formula Bar, making it
easy for you to edit the formula.
 Options opens the Excel Options dialog box.
 Previous and Next cycle through the multiple errors on the worksheet,
assuming there is more than one error.
Figure 4-18:
Checking
the cause of
an error.
Figure 4-17:
Evaluating a
formula.
77
Chapter 4: Fixing Formula Boo-Boos

The Error Checking drop-down hosts the Trace Error command. Only prece-
dents are pointed out by the tracer lines. This makes it easy to see the cells
that feed into a cell that has an error.
Making an Error Behave 
the Way You Want
Excel 2007 has a new function: IfError. Don’t confuse it with IsError, which is
similar but not as slick. Figure 4-19 shows how IfError one-ups IsError. In the
figure, F7 has the dreaded Divide by Zero error. It’s not a pretty thing to see,
and I am sure the boss would appreciate a cleaner visual to work with.
Cell H7 has the tried-and-true way to make the error not look like an error.
Using the IsError function nested inside an If function takes care of the error’s
appearance, as seen in cell H7 (which refers to cell F7). Cell H8 achieves the
same result with the new IfError function. Cells J7 and J8, respectively, show
the formulas that are in cells H7 and H8.
 In cell H7 is =IF(ISERROR(F7),0,F7+3)
 In cell H8 is =IFERROR(F7+3,0)
The main distinction is that IfError, as a single function, does what used to
take two functions. I don’t know how many times the “keep it simple”
approach has been bantered around, but what the heck — we’re all for
making our work easier. With IfError, the first argument is being tested. If the
test makes sense, Excel goes with it. Otherwise, the second argument is used.
IfError can return a message. For example, consider this: =IFERROR(F7+3,
”Somebody Goofed!”).
Figure 4-19:
Two ways to
prevent an
error from
being seen.
78
Part I: Putting the Fun in Functions 

Part II
Counting on 
Your Money

In this part . . .
A
re you a money-minded person? We have just the
thing for you. Part II is all about loans, investments,
depreciation, and internal rates of return. Chapter 5
explains how Excel works with and formats monetary
values. Did you know that Excel is so smart it can work
with your local currency? 
Keeping tabs on loans has never been easier. Heck, you
can even figure whether a loan is worth it in the first
place! Chapter 6 takes this up a notch to demonstrate
advanced financial functions that calculate depreciation
and internal rates of returns –– the kind of stuff you would
think to ask an accountant about. Only now you can figure
it out yourself.

Chapter 5
Calculating Loan Payments 
and Interest Rates
In This Chapter
 Formatting monetary values 
 Estimating loan payments
 Determining the number of payments
 Calculating interest
 Calculating the principal loan amount
A
penny saved is a penny earned. A penny by itself is not much. But add a
little savings here and there over the life of a loan, and the sum could be
significant! Just think of what you can do with the extra money — extend a
vacation, give it to charity, or save it for a rainy day.
Taking out a car loan, a mortgage, or another type of loan involves planning
how you want to manage the loan payments. In the simplest terms, all you
may need to know is the amount of your monthly payment. But knowing the
components of a loan and being able to compare one loan with another can
help you to manage your financial resources in your own best interest.
Consider an auto loan, one of the most common loan types. The factors
involved include the cost of the vehicle, the down payment, the length of the
loan, and the interest rate. Excel can help you see how all these factors affect
your bottom line, letting you make the best decision (we would love to get
the Ferraris, but the Hyundais will have to do).
You can use the financial functions in Excel to crunch the numbers for your
loans. You supply these functions with the relevant numbers: the principal
amount, the interest rate, the period (how often you make a payment), and
the length of the loan. Then, the functions return an answer such as your 
payment amount. In this chapter, we show you how to use these functions 
to turn your finance figures into meaningful results.

The principal is the amount being borrowed. The interest rate is the annual
percentage that the lender charges for lending the money. Your total pay-
ments will equal the principal plus the sum of all interest charges.
Understanding How Excel 
Handles Money
Excel is a lot more than a simple adding machine. It has great tools for work-
ing with money values and a number of ways of presenting the amounts. For
example, Excel makes it easy for you to make sure your financial amounts are
displayed with two decimal points. You can even work with different curren-
cies from around the world.
Going with the cash flow
Excel works with money on a cash flow basis. In other words, money
amounts are treated either as a cash flow in (money you receive) or a cash
flow out (money you pay out). Yes, we know, there always seems to be too
many of the latter and not enough of the former — but hey, you can’t blame
Excel for that!
Excel represents cash flows in as positive numbers and cash flows out as 
negative numbers. For example, when you calculate the payments on a loan,
the situation is as follows:
 The amount of the loan is entered as a positive value because this is the
money you’ll receive from the bank or whoever is giving you the loan.
 The monthly payment that Excel calculates is a negative value because
this is money that you’ll be paying out.
Formatting for currency
One of Excel’s shining strengths is accepting, manipulating, and reporting on
monetary data. As such, Excel provides robust formatting for numeric data,
including the ability to control the placement of commas and decimals, and
even how to format negative values.
82
Part II: Counting on Your Money 

People are used to seeing money amounts formatted with a currency symbol
and a certain number of decimal places. In the U.S. and Canada, that is the
dollar sign and two decimal places. Let’s face it — $199.95 looks like money
but 199.950 does not. Excel makes formatting cells to display money amounts
as easy as clicking a button. To format amounts as dollars, follow these steps:
1, Select the cell or cells you want to format.
2. Click the Dollar ($) button on the Ribbon’s Home tab, in the 
Number group.
This technique assigns Excel’s default Accounting format to the selected
cells. In the U.S., the default currency format follows:
 A dollar sign, aligned to the left of the cell
 Two decimal places
 Negative numbers enclosed in parentheses
The default format depends on your locale, which is a setting of the operating
system. If you’re in Italy, for example, the locale should be set so that the
default currency format is the euro (€).
But suppose you don’t want the default currency formatting. Perhaps you’re
in the U.S. and working on a spreadsheet for the London office. You can spec-
ify the currency symbol, the number of decimal places, and how negative
values are shown by following these steps:
1. Select the cell or cells you want to format.
2. Right-click the cell(s) and choose Format Cells from the 
drop-down menu.
3. In the Format Cells dialog box, select the Number tab, as shown 
in Figure 5-1.
4. Click Currency in the Category list.
5. Select the desired number of decimal places from the Decimal 
Places drop-down list.
6. Select the desired currency symbol from the Symbol drop-down list.
7. Select the desired format for negative numbers from the Negative
Numbers list.
8. Click OK to apply the formatting.
83
Chapter 5: Calculating Loan Payments and Interest Rates

The Currency and Accounting formats are similar to each other, except for 
a couple of key points. Currency provides choices for displaying negative
values; Accounting uses one fixed display with parentheses. Currency places
the currency symbol next to the number; Accounting places the currency
symbol at the left of the cell.
Choosing separators
When numbers are formatted as currency, two separator symbols are typically
used — one to separate thousands and the other to separate the decimal part
of the value. In the U.S., commas are used for thousands and the period for the
decimal:
$12,345.67
Other countries have different ways of doing this. In many European countries,
for example, the period is used to separate thousands and the comma is used
for the decimal. In addition, the currency symbol is often at the end of the
number. An amount in euros, for example, may be formatted as follows:
12.345,67€
In almost all situations, the operating system’s locale settings result in the
proper separators being used automatically. If you need to change the sepa-
rators from the defaults, do so in the Regional and Language Options in the
Windows Control Panel:
1. Click Start➪Control Panel.
Figure 5-1:
Using the
Format Cells
dialog box
to control
numeric
display.
84
Part II: Counting on Your Money 

2. Open the Regional and Language Options dialog box one of two ways:
• In Classic View, double-click the Regional and Language Options
globe icon. 
• In Category View, click the Date, Time, Language, and Regional
Options hyperlink. Then click the Regional and Language
Options hyperlink.
Depending on how your Windows operating system is configured, you
could see a link to the dialog box named Date, Time, Language, and
Regional Options. Figure 5-2 shows the dialog box.
3. Click the Customize button. 
Figure 5-3 shows the Customize Regional Options dialog box, which opens.
Figure 5-3:
Customizing
how
numeric
values are
handled.
Figure 5-2:
Viewing
regional
settings.
85
Chapter 5: Calculating Loan Payments and Interest Rates

4. Click OK once to save any changes you made in the Customize
Regional Options dialog box. 
5. Click OK to close the Regional and Language Options dialog box.
You can make settings for numbers, currency, dates, and time in the
Customize Regional Options dialog box.
Figuring Loan Calculations
Loans are part of almost everyone’s life. At the personal level, you may need
to deal with car loans, education loans, and a home mortgage. From a busi-
ness perspective, companies from the smallest to the largest often use loans
to fund new equipment, expansion, and so on. No matter what kind of loan
you need, Excel has the tools that permit you to evaluate loans and calculate
specific details.
Most loans have the following five factors:
 Loan principal: The amount you’re borrowing. For example if you are
interested in a loan for $5,000. then the loan principal is $5,000.
 Interest rate: The cost to borrow the principal. This is how lenders
make money. The interest rate is a fee, so to speak, that a borrower pays
to a lender. Usually, but not always, the interest rate is expressed as a
percent per year.
 Payment period: Loans are usually paid back by paying a periodic
amount. Most often the period is monthly.
 Duration of the loan: This is the count of payment periods. For example
a loan may have 36 monthly payments.
 Payment: The amount you pay each payment period.
Each of these factors is related to all the others. If you borrow more, your
monthly payments will be higher —that’s no surprise. If you get a low interest
rate, you may be able to pay off your loan in less time — that may be some-
thing to consider!
The functions used to calculate loan factors work with the same group of
inputs, namely the five factors just listed. The functions typically accept
three or four inputs as data and then calculate the desired value, kind of like
the way algebra works.
86
Part II: Counting on Your Money 

Calculating the payment amount
The PMT function tells you the periodic payment amount for your loan. If you
know the principal, interest rate, and number of payments for a loan, you can
use the PMT function to calculate the payment amount. But first a word
about interest rates.
Most loan interest rates are expressed as an annual rate. However, Excel
needs the interest rate per payment period in order to calculate properly. For
example, if you’re calculating for a loan with monthly payments, you need the
monthly interest rate. You can easily get this number by dividing the annual
interest rate by 12, the number of months in a year. To calculate a loan pay-
ment, follow these steps:
1. Enter the loan principal, annual interest rate, and number of payment
periods in separate cells within the worksheet.
You can add labels to adjacent cells to identify the values, if desired.
2. Position the cursor in the cell where you want the results to display.
3. Enter =PMT( to begin the function entry. 
A small pop-up menu shows the arguments used in the function.
4. Click the cell where you entered the interest rate, or just enter the 
cell address.
5. Enter /12 to divide the annual interest rate to get the monthly 
interest rate.
6. Enter a comma (,).
7. Click the cell where you entered the number of payments, or enter
the cell address.
8. Enter a comma (,).
9. Click the cell where you entered the principal amount, or just enter
the cell address.
10. Type a ), and press Enter.
Watch those percents! Remember that a percent is really one one-hundredth,
so 5 percent is the numerical value 0.05. You can format values to display as
percents in Excel, but you must enter the proper value.
Figure 5-4 shows how we set up a worksheet with values and returned the peri-
odic payment amount for a loan. The amount is expressed as a negative number
because payments are a cash flow out. For example, you may be considering
87
Chapter 5: Calculating Loan Payments and Interest Rates

taking a loan out from the bank for some house additions. Using real numbers,
the loan may be structured like this:
 A loan amount of $15,000 (the principal)
 An annual interest rate of 5 percent
 A monthly payment period
 A payment period of 24 payments
This summarizes four of the key parameters. The PMT function figures out
the fifth — the periodic payment, which is the amount you have to shell out
each month.
Although the PMT function returns the constant periodic payback amount for
a loan, note that each payment actually consists of two portions. One portion
goes toward reducing the principal, and the other portion is the interest pay-
ment. As if this weren’t already confusing enough!
You may notice some new terms when using this function: PV, FV, and NPER. In
financial terminology, present value (PV) refers to the value of a transaction at
the present moment. When dealing with a loan, for example, the present value
is the amount you receive from the loan — in other words, the principal. The
term future value (FV) refers to the value of a transaction at some point in the
future, such as the amount you’ll accumulate by saving $50 a month for five
years. NPER stands for the number of payment periods in the loan.
Calculating interest payments
The IPMT function tells you the interest payment for a given period. In each
payment period during a typical loan, the payment consists of a portion set
to reduce the principal of the loan, with the other portion of the payment
being the interest on the principal. The amount of interest varies payment by
payment. In a typical loan, the portion of the payment that is interest is high-
est in the first period and is reduced in each successive period.
Figure 5-4:
The PMT
function
calculates
the loan
payment
amount.
88
Part II: Counting on Your Money 

The IPMT function takes four inputs: the principal, the interest rate, the
number of payments for the loan, and the number of the payment you’re
interested in. For example, a loan may have 24 payments and you’re inter-
ested in how much interest is included in the 12th payment. For some types
of loans, the interest is tax deductible, so this information may literally be
worth something! Here are the steps to use the IMPT function:
1. Enter the following information in separate cells within a column on
the worksheet: 
• Loan principal
• Annual interest rate
• Number of payment periods
• Number of the actual period for which you want to calculate 
the interest
You can add labels to adjacent cells to identify the values, if desired.
2. Position the cursor in the cell where you want the results to appear.
3. Enter =IPMT( to begin the function entry.
4. Click the cell where you entered the interest rate, or just enter the 
cell address.
5. Enter /12. 
This divides the annual interest rate to get the monthly interest rate.
6. Enter a comma (,).
7. Click the cell where you entered the number of the payment to ana-
lyze, or just enter the cell address.
8. Enter a comma (,).
9. Click the cell where you entered the number of payments, or just
enter the cell address.
10. Enter a comma (,).
11. Click the cell where you entered the principal amount, or just enter
the cell address.
12. Type a ), and press Enter.
The IPMT function returns the interest portion of the amount of the specified
payment. This amount will be smaller than the full periodic payment amount.
How much smaller depends on which sequential payment is being examined.
The remainder of the payment — the part that is not interest — goes to
reduce the principal.
89
Chapter 5: Calculating Loan Payments and Interest Rates

You can use two optional arguments with IPMT:
 Future Value: The amount you wish the loan to be worth at the end of
its life. The default is 0.
 Type: This tells the function whether payments are applied at the end of
the period or the beginning of the period. A value of 0 indicates the end
of the period. A value of 1 indicates the beginning of the period. The
default is 0.
These optional arguments when used become the respective fifth and sixth
arguments.
Calculating payments toward principal
The PPMT function tells you the payment on principal for a given period. In
each payment period during a typical loan, the payment consists of a portion
that goes toward reducing the principal of the loan and another portion that
is interest. With the PPMT function, you can find out the amount that reduces
the principal.
The ratio of the interest portion to the payment on principal portion varies
payment by payment. In a typical loan, the portion of the payment that is
interest is highest in the first period and is reduced in each successive
period. Turning that around, the last payment is almost all toward paying
down the principal.
The PPMT function takes four inputs: the principal, the interest rate, the
number of payments for the loan, and the number of the payment in ques-
tion. For example, a loan may have 36 payments and you’re interested in how
much principal is included in just the last payment. Here are the steps to use
this function:
1. Enter the loan principal, the annual interest rate, the number of 
payment periods, and the number of the actual period for which the
interest is to be calculated in separate cells within the worksheet.
You can add labels to adjacent cells to identify the values, if you want.
2. Position the cursor in the cell where you want the results to appear.
3. Enter =PPMT( to begin the function entry.
4. Click the cell where you entered the interest rate, or just enter the 
cell address.
5. Enter /12 to divide the annual interest rate to get the monthly 
interest rate.
90
Part II: Counting on Your Money 

6. Enter a comma (,).
7. Click the cell where you entered the number of the payment to 
analyze, or just enter the cell address.
8. Enter a comma (,).
9. Click the cell where you entered the number of payments, or just
enter the cell address.
10. Enter a comma (,).
11. Click the cell where you entered the principal amount, or just enter
the cell address.
12. Type a ), and press Enter.
The PPMT function returns the amount of the payment that reduces the 
principal. This amount will be smaller than the full periodic payment amount.
How much smaller depends on which sequential payment is being examined.
The remainder of the payment, of course, is the interest charge.
The PMT function tells how much each payment is. The IPMT function tells
you the interest portion. The PPMT tells you the principal function. For any
given payment period, the amounts returned by IPMT and PPMT should
equal the amount returned by PMT.
You can use two optional arguments with PPMT:
 Future Value: The amount you want the loan to be worth at the end of
its life. The default is 0.
 Type: This tells the function whether payments are applied at the end of
the period or the beginning of the period. A value of 0 indicates the end
of the period. A value of 1 indicates the beginning of the period. The
default is 0.
These optional arguments, when used, become the respective fifth and sixth
arguments.
Calculating the number of payments 
The NPER function tells you how many payments are necessary to pay off 
a loan. This is useful when you know how much you can afford to pay per
month, and need to know how long it will take to pay off the loan. The inputs
for this function are the principal, the interest rate, and the periodic payment
amount.
91
Chapter 5: Calculating Loan Payments and Interest Rates

Here’s how to use the NPER function:
1. Enter the following into separate cells on your worksheet:
• Loan principal
• Annual interest rate
• Periodic payment amount (the amount you can afford to pay)
Enter the periodic payment amount as a negative number because 
payments are a cash flow out. You can add labels to adjacent cells to
identify the values, if you want.
2. Position the cursor in the cell where you want the results to display.
3. Enter =NPER( to begin the function entry.
4. Click the cell where you entered the interest rate, or just enter the 
cell address.
5. Enter /12 to divide the annual interest rate to get the monthly 
interest rate.
6. Enter a comma (,).
7. Click the cell where you entered the periodic payment amount, or just
enter the cell address.
8. Enter a comma (,).
9. Click the cell where you entered the principal amount, or just enter
the cell address.
10. Type a ), and press Enter.
Figure 5-5 shows how we set up a worksheet with values and used the NPER
function to find out how many payments are necessary to pay off a loan. In
our example, we assume you can afford to pay $200 per month for a loan. The
amount you need is $4,000, and you’re able to get a 6 percent interest rate.
With this set of assumptions, the NPER function tells returns a value of 21.12
months to pay off the loan. We don’t think anyone will mind if you round that
Figure 5-5:
The NPER
function
calculates
the number
of payments
for a loan.
92
Part II: Counting on Your Money 

off to 21 months. Knowing you’ll pay off the loan in less than two years may
very well allow you to plan ahead for some other activity at that time. Did
someone say “Las Vegas”!?
You can use two optional arguments with NPER:
 Future Value: The amount you want the loan to be worth at the end of
its life. The default is 0.
 Type: This tells the function whether payments are applied at the end of
the period or the beginning of the period. A value of 0 indicates the end
of the period. A value of 1 indicates the beginning of the period. The
default is 0.
These optional arguments, when used, become the respective fifth and 
sixth arguments.
Calculating the interest rate
The RATE function tells you what the interest rate is on a loan. This function
is great for comparing loan offers. Although a loan offer will always include
an interest rate, you may want to use Excel to double-check and ensure that
some other fees are not included in the payments. Then you can compare dif-
ferent loan scenarios to see which one offers the true lowest interest rate. We
don’t think anyone wants to pay more than they have to!
Some lenders charge fees as well as an annual interest rate. When these fees
are figured in, the effective interest rate will be higher than the stated interest
rate. You can use the RATE function to determine the effective interest rate
for a loan. If it’s the same as the stated interest rate, then you know no fees
are being added.
The inputs for this function are the principal, the number of payments, and the
fixed amount of the periodic payment. Here’s how to use the RATE function:
1. Enter the following in separate cells within the worksheet: 
• Loan principal
• Number of payment periods 
• Amount you will pay each month
Enter the monthly payment amount as a negative number because it is a
cash flow out. You can add labels to adjacent cells to identify the values,
if you want.
2. Position the cursor in the cell where you want the results to appear.
3. Enter =RATE( to begin the function entry.
93
Chapter 5: Calculating Loan Payments and Interest Rates

4. Click the cell where you entered the number of periods, or just enter
the cell address.
5. Enter a comma (,).
6. Click the cell where you entered the monthly payment amount, or just
enter the cell address.
7. Enter a comma (,).
8. Click the cell where you entered the principal amount, or just enter
the cell address.
9. Type a ), and press Enter.
The RATE function returns the interest rate per period. This number can be
misleading. The periodic interest amount may be small enough that it is dis-
played as 0 percent if the formatting in the cell isn’t set to display enough
decimal points.
To find out the annual rate, you simply need to take the number returned by
RATE and multiply it by 12. To do this:
1. Position the cursor in the cell where you want the annual interest rate
to appear.
2. Enter a =.
3. Click the cell where the RATE function returned the periodic 
interest rate.
4. Enter a ×.
5. Enter 12.
6. Press Enter.
As an example, assume a loan principal of $15,000 with a monthly payment of
$650. The loan is to be paid off in 24 months. Figure 5-6 shows a worksheet
with these figures. The periodic interest rate is calculated with the RATE
function, and then the annual rate is calculated by multiplying the periodic
interest rate by 12.
Figure 5-6:
The RATE
function
calculates
the periodic
interest
rate.
94
Part II: Counting on Your Money 

You can use three optional arguments with RATE:
 Future Value: The amount you want the loan to be worth at the end of
its life. The default is 0.
 Type: This tells the function whether payments are applied at the end of
the period or the beginning of the period. A value of 0 indicates the end
of the period. A value of 1 indicates the beginning of the period. The
default is 0.
 Guess: An estimate of what the interest rate should be. It is possible the
function will need this value to determine a result. (See Excel’s Help
system for further information.) The default value is .1 (for 10 percent).
These optional arguments, when used, become the respective fourth, fifth,
and sixth arguments.
Calculating the principal
The PV function tells you what the principal amount of a loan is when you
know the other loan factors, such as the interest rate and the number of pay-
ment periods. You can use PV to determine how much you can borrow when
you already know how much you can pay each month and how long you can
make payments.
The inputs for this function are the interest rate, the number of payment peri-
ods, and the monthly payment amount. The interest rate used in the function
is the periodic rate, not the annual rate. Here’s how to use the PV function:
1. Enter the following into separate cells on your worksheet:
• Annual interest rate
• Number of payment periods
• Periodic payment amount
Enter the periodic payment amount as a negative number because pay-
ments are a cash flow out. You can add labels to adjacent cells to iden-
tify the values, if desired.
2. Position the cursor in the cell where you want the results to appear.
3. Enter =PV( to begin the function entry.
4. Click the cell where you entered the interest rate, or just enter the 
cell address.
95
Chapter 5: Calculating Loan Payments and Interest Rates

5. Enter /12 to divide the annual interest rate to get the monthly 
interest rate.
6. Enter a comma (,).
7. Click the cell where you entered the number of payments, or just
enter the cell address.
8. Enter a comma (,).
9. Click the cell where you entered the periodic payment amount, or just
enter the cell address.
10. Type a ), and press Enter.
As an example, assume a monthly payment amount of $600. The annual 
interest rate is 5 percent. There are 24 monthly payments. Figure 5-7 shows 
a worksheet with these figures.
With these assumptions, the loan principal is $13,676. Altering any of the
parameters will cause PV to return a different amount of principal. For exam-
ple, raising the interest rate to 7.5 percent tells you that you can only borrow
$13,333. Although you may often think of how much you’re borrowing, having
interest in the interest is just as important!
You can use two optional arguments with PV:
 Future Value: The amount you want the loan to be worth at the end of
its life. The default is 0.
 Type: This tells the function whether payments are applied at the end of
the period or the beginning of the period. A value of 0 indicates the end
of the period. A value of 1 indicates the beginning of the period. The
default is 0.
These optional arguments, when used, become the respective fifth and sixth
arguments.
Figure 5-7:
The PV
function
calculates
the principal
amount of a
loan.
96
Part II: Counting on Your Money 

Chapter 6
Appreciating What You’ll Get,
Depreciating What You Got
In This Chapter
 Determining what an investment is worth
 Using different depreciation methods
 Evaluating business opportunities
M
oney makes the world go ’round, so the saying goes. We have a new
one: Excel functions make the money go ’round. Excel has functions
that let you figure out what an investment will be worth at a future date. We
all know it’s a good thing to look for a good interest rate on an investment.
With the FV function, you can take this a step further and know how much
the investment will be worth down the road.
Have you ever wondered what to do with some extra money? You can put it
in the bank, you can pay off a debt, or you can purchase something. Excel
helps you figure out the best course of action by using the IRR function. The
IRR function lets you boil down each option to a single value that you can
then use to compare opportunities and select the best one.
For the business set, Excel has a number of functions to help create 
depreciation schedules. Look no further than the SLN, SYD, DB, and DDB
functions for help in this area. Brush up on these and you can talk shop with
your accountant!
Looking into the Future
The FV function tells you what an investment will be worth in the future. 
The function takes an initial amount of money and also takes into account
additional periodic fixed payments. You also specify a rate of return — the
interest rate — and the returned value tells you what the investment will be
worth after a specified period of time.

For example, you start a savings account with a certain amount, say $1,000.
Every month you add an additional $50 to the account. The bank pays an
annual interest rate of 5 percent. At the end of two years, what is value of 
the account?
This is the type of question the FV function answers. The function takes 
five arguments:
 Interest rate: This is the annual interest rate. When entered in the function,
it needs to be divided by the number of payments per year — presumably
12, if the payments are monthly.
 Number of payments: This is the total number of payments in the invest-
ment. These payments are the ones beyond the initial investment; don’t
include the initial investment in this figure. If payments occur monthly
and the investment is for three years, then there are 36 payments.
 Payment amount: This is the fixed amount contributed to the invest-
ment each payment period.
 Initial investment (also called PV or present value): This is the amount
the investment starts with. A possible value is 0, which means no initial
amount is used to start the investment. This is an optional argument. If
left out, 0 is assumed.
 How payments are applied: The periodic payments may be applied at
either the beginning of each period or the end of each period. This
affects the result to a small but noticeable degree. Either a 0 or a 1 can
be entered. A 0 tells the function that payments occur at the end of the
period. A 1 tells the function that payments occur at the start of the
period. This is an optional argument. If left out, 0 is assumed.
When using the FV function, be sure to enter the initial investment amount
and the periodic payment amount as negative numbers. Although you’re
investing these monies, you’re essentially paying out (even if it’s into your
own account). Therefore, these are cash flows out.
Here’s how to use the FV function:
1. Enter the following data in separate cells within the worksheet:
• Annual interest rate
• Number of payment periods
• Periodic payment amount
• Initial investment amount
98
Part II: Counting on Your Money 

You can add labels to adjacent cells to identify the values, if desired.
2. Position the cursor in the cell where you want the results to appear.
3. Enter =FV( to begin the function entry.
4. Click the cell where you entered the annual interest rate, or enter 
the cell address.
5. Enter /12 to divide the annual interest rate to get the monthly 
interest rate.
6. Enter a comma (,).
7. Click the cell where you entered the total number of payments, or
enter the cell address.
8. Enter a comma (,).
9. Click the cell where you entered the periodic payment amount, or
enter the cell address.
10. Enter a comma (,).
11. Click the cell where you entered the initial investment amount, or
enter the cell address.
12. Optionally, enter a comma (,), and then enter either 0 or 1 to identify
whether payments are made at the beginning of the period (0) or at
the end of the period (1).
13. Type a ), and press Enter.
Figure 6-1 shows how much an investment is worth after two years. The
investment is begun with $1,000 and an additional $50 is added each month.
The interest rate is 5 percent. The value of the investment at the end is
$2,364.24. The actual layout was $2,200 ($1,000 + [$50 × 24]). The account 
has earned $164.24.
Figure 6-1:
Earning
extra money
in an
investment.
99
Chapter 6: Appreciating What You’ll Get, Depreciating What You Got

Depreciating the Finer Things in Life
Depreciation is the technique of allocating the cost of an asset over the useful
period that the asset is used. Depreciation is applied to capital assets, tangible
goods that provide usefulness for a year or more.
Vehicles, buildings, and equipment are the type of assets that depreciation
can be applied to. A tuna sandwich is not a capital asset because its useful-
ness is going to last for just the few minutes it takes someone to eat it —
although the person eating it may expect to capitalize on it!
Take the example of a business purchasing a delivery truck. The truck costs
$35,000. It’s expected to be used for 12 years; this is known as the life of the
asset. At the end of 12 years, the vehicle’s estimated worth will be $8,000.
These figures follow certain terminology used in the depreciation formulas:
 Cost: This is the initial cost of the item ($35,000). This could include not
just the price of the item but costs associated with getting and installing
the item, such as delivery costs.
 Salvage: This is the value of the item at the end of the useful life of the
item ($8,000).
 Life: This is the number of periods that the depreciation is applied to.
This is usually expressed in years (in this case, 12 years).
Depreciation is calculated in different ways. Some techniques assume that 
an asset provides the majority of its usefulness during the earlier periods of
its life. Depreciation in this case is applied on a sliding scale from the first
period to the last. The bulk of the depreciation gets applied in the first few
periods. This is known as an accelerated depreciation schedule. Sometimes
the depreciation amount runs out sooner than the asset’s life. Alternatively,
depreciation can be applied evenly over all the periods. In this case, each
period of the asset’s life has an equal amount of depreciation to apply. The
different depreciation methods are summarized in Table 6-1.
The depreciable cost is the original cost minus the salvage value.
Table 6-1
Depreciation Methods
Method
Comments
Excel Function That 
Uses the Method
Straight Line
Evenly applies the depreciable cost 
SLN
(Cost – Salvage) among the periods. Uses 
the formula (Cost – Salvage) ÷ Number 
of Periods.
100
Part II: Counting on Your Money 

Method
Comments
Excel Function That 
Uses the Method
Sum of Years’ 
First sums up the periods, literally. For
SYD
Digits
example, if there are five periods, then the 
method first calculates the sum of the 
years’ digits as 1 + 2 + 3 + 4 + 5 = 15. 
Creates an accelerated depreciation 
schedule. See Excel Help for more 
information.
Double 
Creates an accelerated depreciation 
DDB, DB
Declining 
schedule by doubling the Straight Line 
Balance
depreciation rate but then applies it to 
he running declining balance of the 
asset cost, instead of to the fixed 
depreciable cost.
Figure 6-2 shows a worksheet with a few different depreciation methods. 
The methods use the example of a delivery truck that costs $35,000, is used
for 12 years, and has an ending value of $8,000. An important calculation in
all these methods is the depreciable cost, which is the original cost minus
the salvage value. In this example, the depreciable cost is $27,000, calculated
as $35,000 – $8,000.
In the three depreciation methods shown in Figure 6-2 — straight line, sum of
the years’ digits, and double declining balance — all end having the accumu-
lated depreciation at the end of life equal to the depreciable cost, or the cost
minus the salvage.
Figure 6-2:
Depreciating
an asset.
101
Chapter 6: Appreciating What You’ll Get, Depreciating What You Got

However each method arrives at the total in a different way. The Straight Line
method simply applies an even amount among the periods. The Sum of Years’
Digits and Double Declining Balance methods accelerate the depreciation. In
fact the Double Declining Balance method does it to such a degree that all the
depreciation is accounted for before the asset’s life is over.
Calculating straight line depreciation
The SLN function calculates the depreciation amount for each period of the
life of the asset. The arguments are simple: just the cost, salvage, and the
number of periods. In Figure 6-2, each cell in the range D9:D20 has the same
formula: =SLN($B$2,$B$3,$B$4). Because straight line depreciation pro-
vides an equal amount of depreciation to each period, it makes sense that
each cell uses the formula verbatim. The answer is the same regardless of 
the period (this approach differs from the accelerated depreciation methods
that follow).
Using dollar signs ($) in front of column and row indicators fixes the cell
address so it won’t change.
Here’s how to use the SLN function:
1. Enter three values in a worksheet:
• Cost of an asset
• Salvage value (always less than the original cost) 
• Number of periods in the life of the asset (usually a number of
years)
2. Enter =SLN( to begin the function entry.
3. Click the cell that has the original cost, or enter its address.
4. Enter a comma (,).
5. Click the cell that has the salvage amount, or enter its address.
6. Enter a comma (,).
7. Click the cell that has the number of periods, or enter its address.
8. Enter a ), and press Enter.
The returned value is the amount of depreciation per period. Each period has
the same depreciation amount.
102
Part II: Counting on Your Money 

Creating an accelerated 
depreciation schedule
The SYD function creates an accelerated depreciation schedule (that is, more
depreciation is applied in the earlier periods of the asset’s life). The method
uses an interesting technique of first summing up the years’ digits. So for a
depreciation schedule that covers five years, a value of 15 is first calculated
as 1 + 2+ 3 + 4 + 5 = 15. If the schedule is for ten years, then the first step of
the method is to calculate the sum of the digits 1 through 10, like this: 1 + 2 +
3 + 4 + 5 + 6 + 7 + 8 + 9 + 10 = 55.
The years’ digit sum is then used as the denominator in calculations with 
the actual digits themselves to determine a percentage per period. The digits
in the calculations are the reverse of the actual periods. In other words, in a
five-year depreciation schedule, the depreciation for the first period is calcu-
lated as (5 ÷ 15) × Depreciable Cost. The second period depreciation is calcu-
lated as (4 ÷ 15) × Depreciable Cost. The following table makes it clear, with
an assumed five-year depreciation on a depreciable cost of $6,000:
Period
Calculation
Result
1
(5⁄15) × 6,000
$2,000
2
(4⁄15) × 6,000
$1,600
3
(3⁄15) × 6,000
$1,200
4
(2⁄15) × 6,000
$800
5
(1⁄15) × 6,000
$400
Guess what? You don’t even need to know how this works! Excel does all the
figuring out for you. The SYD function takes four arguments: the cost, the 
salvage, the life (the number of periods), and the period to be calculated.
SYD returns the depreciation for a single period. Earlier, we showed you that
the SLN function also returns the depreciation per period, but because all
periods are the same, the SLN function didn’t need to have an actual period
entered as an argument.
The SYD function returns a different depreciation amount for each period, so
the period must be entered as an argument. In Figure 6-2, each formula in the
range F9:F20 uses the SYD function but has a different period as the fourth
argument. For example, cell F9 has the formula =SYD($B$2,$B$3,$B$4,B9)
and cell F10 has the formula =SYD($B$2,$B$3,$B$4,B10). The last argu-
ment provides a different value.
103
Chapter 6: Appreciating What You’ll Get, Depreciating What You Got

Here’s how to use the SYD function to calculate the depreciation for one period:
1. Enter three values in a worksheet: 
• Cost of an asset
• Salvage value (always less than the original cost)
• Number of periods in the life of the asset (usually a number 
of years)
2. Enter =SYD( to begin the function entry.
3. Click the cell that has the original cost, or enter its address.
4. Enter a comma (,).
5. Click the cell that has the salvage amount, or enter its address.
6. Enter a comma (,).
7. Click the cell that has the number of periods, or enter its address.
8. Enter a comma (,).
9. Enter a number for the period for which to calculate the depreciation.
10. Enter a ), and press Enter.
The returned value is the amount of depreciation for the entered period. 
To calculate the depreciation for the entire set of periods, enter a formula
with the SYD function into the same number of cells as there are periods. In
this case, each cell has a different period entered for the fourth argument. 
To make this type of entry easy to do, enter the first three arguments as
absolute cell addresses (in other words, use the dollar sign ($) in front of 
the row and column indicators). Leave the fourth argument in the relative
address format.
In cell F9 in Figure 6-2, the formula is =SYD($B$2,$B$3,$B$4,B9). Note
how the first three arguments are fixed to the cells B2, B3, and B4. With this
formula entered in cell F9, simply dragging the formula (using the fill handle
in the lower right corner of the cell) down to F20 fills the range of cells that
need the calculation. The fourth argument changes in each row. For example,
cell F20 has this formula: =SYD($B$2,$B$3,$B$4,B20).
Creating an even faster accelerated 
deprecation schedule
The Double Declining Balance method provides an accelerated depreciation
schedule but calculates the amounts differently than the Sum of Years’ 
Digits method.
104
Part II: Counting on Your Money 

Although rooted in the doubling of the Straight Line method (which is not an
accelerated method), the calculation for each successive period is based on
the remaining value of the asset after each period instead of to the deprecia-
ble cost. Because the remaining value is reduced each period, the schedule
for each period is different.
The DDB function takes five arguments. The first four are required:
 Cost
 Salvage
 Life (the number of periods)
 Period for which the depreciation is to be calculated
The fifth argument is the factor. A factor of 2 tells the function to use the
Double Declining Balance method. Other values can be used, such 1.5. The
factor is the rate at which the balance declines. A smaller value (than the
default of 2) results in a longer time for the balance to decline. When the fifth
argument is omitted, the value of 2 is the default.
The DDB function returns a different depreciation amount for each period, so
the period must be entered as an argument. In Figure 6-2, each formula in the
range H9:H20 uses the DDB function but has a different period as the fourth
argument. For example, cell H9 has the formula =DDB($B$2,$B$3,$B$4,B9),
and cell H10 has the formula =DDB($B$2,$B$3,$B$4,B10). The last argu-
ment provides a different value.
As shown in Figure 6-2 earlier, the Double Declining Balance method provides
an even more accelerated depreciation schedule than the Sum of Years’ Digits
method. In fact, the depreciation is fully accounted for before the asset has
reached the end of its life.
Here’s how to use the DDB function to calculate the depreciation for 
one period:
1. Enter three values in a worksheet: 
• Cost of an asset
• Salvage value (always less than the original cost) 
• Number of periods in the life of the asset (usually a number 
of years)
2. Enter =DDB( to begin the function entry.
3. Click the cell that has the original cost, or enter its address.
4. Enter a comma (,).
105
Chapter 6: Appreciating What You’ll Get, Depreciating What You Got

5. Click the cell that has the salvage amount, or enter its address.
6. Enter a comma (,).
7. Click the cell that has the number of periods.
8. Enter a comma (,).
9. Enter a number for the period for which to calculate the depreciation.
10. If a variation on the Double Declining Balance method is desired, then
enter a comma (,) and a numeric value other than 2.
11. Type a ), and press Enter.
The returned value is the amount of depreciation for the entered period. To
calculate the depreciation for the entire set of periods, you need to enter a
formula with the DDB function into the same number of cells as there are
periods. In this case, each cell would have a different period entered for the
fourth argument. One of the best approaches is to use absolute addressing
for the first three function arguments. Then, when filling the rest of the cells
by dragging or copying, the reference to original cost, salvage amount, and
number of periods will stay constant. You can see an example of absolute
addressing in the Formula Bar shown in Figure 6-2.
There is no hard-and-fast rule for selecting the best depreciation method.
However, it makes sense to use one that matches the depreciating value of
the asset. For example, cars lose a good deal of their value in the first few
years, so applying an accelerated depreciation schedule makes sense.
Calculating a mid-year 
depreciation schedule
Most assets are not purchased, delivered, and put into service on January 1.
So Excel provides a depreciation formula, DB, that accounts for the periods
being offset from the calendar year. The DB function takes five arguments.
The first four are the typical ones: the cost, the salvage, the life (the number
of periods), and the period for which the depreciation is to be calculated.
The fifth argument is the number of months in the first year. The fifth argu-
ment is optional, but when left out, the function will use 12 as a default.
For the fifth argument, a value of 3 means the depreciation starts in October
(October through December is 3 months), so the amount of depreciation
charged in the first calendar year is small. A value of 11 means the deprecia-
tion starts in February (February through December is 11 months).
106
Part II: Counting on Your Money 

Figure 6-3 shows a depreciation schedule created with the DB function. Note
that the life of the asset is 12 years (in cell B4) but that the formula is applied
to 13 different periods. Including an extra year is necessary because the first
year is partial. The remaining handful of months must spill into an extra cal-
endar year. The depreciation periods and the calendar years are offset from
each other.
The example in Figure 6-3 is for an asset put into service in August. Cell D9
has the formula =DB($B$2,$B$3,$B$4,B9,5). The fifth argument is 5,
which indicates the first year depreciation covers 5 months — August,
September, October, November, and December.
Here’s how to use the DB function to calculate the depreciation for 
one period:
1. Enter three values in a worksheet: 
• Cost of an asset 
• Salvage value (always less than the original cost) 
• Number of periods in the life of the asset (usually a number 
of years)
2. Enter =DB( to begin the function entry.
3. Click the cell that has the original cost, or enter its address.
4. Enter a comma (,).
5. Click the cell that has the salvage amount, or enter its address.
Figure 6-3:
Offsetting
depreciation
periods from
the
calendar.
107
Chapter 6: Appreciating What You’ll Get, Depreciating What You Got

6. Enter a comma (,).
7. Click the cell that has the number of periods.
8. Enter a comma (,).
9. Enter a number for the period for which to calculate the depreciation.
10. Enter a comma (,).
11. Enter the number of months within the first year that the depreciation
is applied to.
12. Type a ), and press Enter.
The returned value is the amount of depreciation for the entered period. To
calculate the depreciation for the entire set of periods, you need to enter a
formula with the DB function in the same number of cells as there are peri-
ods. However, you should make space for an additional period (refer to
Figure 6-3).
Enter the constant arguments of the function with absolute addressing (the
dollar signs used in front of row numbers or column letters). This makes the
function easy to apply across multiple cells by copying the formula. The ref-
erences to the pertinent function arguments stay constant.
Measuring Your Internals
Which is better to do — pay off your credit card or invest in Uncle Ralph’s
new business venture? You’re about to finance a car. Should you put down a
large down payment? Or should you put down a small amount and invest the
rest? How can you make decisions about alternative financial opportunities
like these?
The Internal Rate of Return (IRR) method helps answer these types of ques-
tions. The IRR function analyzes the cash flows in and out of an investment
and calculates an interest rate that is the effective result of the cash flows. In
other words, all the various cash flows are accounted for and one interest rate
is returned. Then you can compare this figure to other financial opportunities.
Perhaps Uncle Ralph’s business venture will provide a 10 percent return on
your investment. On the other hand, the credit-card company charges you 
12 percent on your balance. In this case, paying off the credit card is wiser.
Why? Because earning 10 percent is pointless when you’re just losing 12 
percent elsewhere. Uncle Ralph will understand, won’t he?
108
Part II: Counting on Your Money 

The IRR function takes two arguments. The first is required; the second is
optional in some situations and required in others.
The first argument is an array of cash flows. Following the cash-flows standard,
money coming in is entered as a positive value, and money going out is entered
as a negative value. Assuming the particular cash flows in and out are entered
on a worksheet, the first argument to the function is the range of cells.
The second argument is a guess at what the result should be. We know this
sounds crazy, but Excel may need your help here (though most times it
won’t). The IRR function works by starting with a guess at the result and cal-
culating how closely the guess matches the data. Then it adjusts the guess up
or down and repeats the process (a technique called iteration) over and over
until it arrives at the correct answer. If it doesn’t figure it out in 20 tries, then
the #NUM! error is returned. In this case, you could enter a guess into the
function to help it along. For example, 0.05 indicates a guess of 5 percent, 0.15
indicates a guess of 15 percent, and so on. You can enter a negative number,
too. For example, entering –0.05 tells the function you expect a 5 percent
loss. If you don’t enter a guess, Excel assumes 0.1 (10 percent).
Figure 6-4 shows a business venture that has been evaluated using IRR. The
project is to create a music CD and market it. Assorted costs such as studio
time are cash flows out, entered as negative numbers. The one positive value
in cell B7 is the expected revenue.
The IRR function has been used to calculate an expected rate of return. The
formula in cell B10 is =IRR(B3:B7). The entered range includes all the cash
flows, in and out.
This project has an internal rate of return of 11 percent. By the way, the
investment amount in this case is the sum of all the cash flows out — $8,400.
Earning back $11,960 makes this a good investment. The revenue is signifi-
cantly higher than the outlay.
Figure 6-4:
Calculating
the return
on a
business
venture.
109
Chapter 6: Appreciating What You’ll Get, Depreciating What You Got

Even though a business opportunity seems worthy after IRR has been
applied, you must consider other factors. For example, you may have to
borrow the money to invest in the business venture. The real number to 
look at is the IRR of the business venture less the cost of borrowing the
money to invest.
However, the project can now be compared to other investments. Another
project might calculate to a higher internal rate of return. Then the second
project would make sense to pursue. Of course, don’t forget the fun factor.
Making a CD may be worth giving up a few extra points!
When comparing opportunities using the IRR function, a higher returned
value is a better result than a lower IRR. 
Figure 6-5 compares the business venture in Figure 6-4 with another invest-
ment opportunity. The second business venture is to start up a video-taping
business for weddings and other affairs. There is a significant outlay for
equipment and marketing. An internal rate of return is calculated for the first
year, and then for the first and second year together. Cell H10 has the formula
=IRR(H3:H5), and cell H11 has the formula =IRR(H3:H6). It’s clear that
even within the first year the second business venture surpasses the first.
This is how to use the IRR function:
1. Enter a series of cash flow values: 
• Money paid out, such as the initial investment, as a 
negative value 
• Money coming in, such as revenue, as a positive value
2. Enter =IRR( to begin the function entry.
3. Drag the cursor over the range of cells containing the cash flows, 
or enter the range address.
Figure 6-5:
Comparing
business
oppor-
tunities.
110
Part II: Counting on Your Money 

4. Optionally, enter a guess to help the function.
To do this, enter a comma (,) and then enter a decimal value to be used
as a percentage (such as .2 for 20 percent). You can enter a positive or
negative value.
5. Enter a ), and press Enter.
Considering that IRR is based on cash flows, in and out, it’s prudent to
include paying yourself, as well as accounting for investments back in the
business. Salary is a cash flow out; investment is a cash flow in.
Figure 6-6 expands on the video-taping business with a detailed example. As a
business, there are various cash flows in and out — investment, utility pay-
ments, fees to the accountant and lawyer, advertising, salary, and so on.
The Internal Rate of Return for the first four months of the business is dis-
played in cell E2. The formula is =IRR(B6:B32,-0.2). By the way, this one
needed a guess to return the answer. The guess is –0.2. The internal rate or
return is –17 percent. The video-taping business is not a moneymaker after a
few months, but this is true of many startups.
Note that this example includes dates. The IRR function works with an
assumption that cash flows are periodic, which they aren’t in this example.
There is a function, XIRR, that handles dates in its calculation of the internal
rate of return. This function is available in the Analysis ToolPak add-in. 
Figure 6-6:
Calculating
IRR with
several
cash flows.
111
Chapter 6: Appreciating What You’ll Get, Depreciating What You Got

112
Part II: Counting on Your Money 

Chapter 7
Using Basic Math Functions
In This Chapter
 Summing, rounding, and truncating values
 Using a value’s sign in a calculation
 Removing the sign from a number
E
xcel is excellent for working with advanced math and complex calcula-
tions. You can do so many complex things with Excel that it’s easy to
forget that Excel is great at basic math, too.
Need the sum of a batch of numbers? No problem. Need to round a number?
Read on! In this chapter, we show you not just how to sum and round num-
bers but how to use these methods in ways that give you just the answers
you need.
Adding It All Together with 
the SUM Function
Just adding numbers together is something Excel is great at. Oh, you can use
your calculator to add numbers as well, but think about it: On a calculator
you enter a number, then press the + button, then enter another number,
then press the + button, and so on. Eventually you press the = button and you
get your answer. But if you made an entry mistake in the middle, you have to
start all over!
The SUM function in Excel adds numbers together in a more efficient way.
First, you list all your numbers on the worksheet. You can see them all and
verify that they’re correct. Then you use the SUM function to add them all
together. Here’s how:

1. Enter some numbers in a worksheet.
These numbers can be both integer and real (decimal) values. You can
add labels to adjacent cells to identify the values, if you want.
2. Position the cursor in the cell where you want the results to appear.
3. Enter =SUM ( to begin the function entry.
4. Click a cell where you entered a number.
5. Enter a comma (,).
6. Click a cell where you entered another number.
7. Repeat Steps 5 and 6 until all the numbers have been entered into the
function.
8. Type a ), and press Enter.
Figure 7-1 shows an example of how these steps help sum up amounts that
are not situated next to each other on a worksheet. Cell F6 contains the sum
of values found in cells C2, E2, G2, and I2.
Using SUM is even easier when the numbers you’re adding are next to each in
a column or row. The SUM function lets you enter a range of cells in place of
single cells in the arguments of the function. So adding a list of contiguous
numbers is as easy as giving SUM a single argument. Here’s how you enter a
range as a single argument:
1. Enter some numbers in a worksheet.
Be sure the numbers are continuous in a row or column. You can add
labels to adjacent cells to identify the values, if desired, but this doesn’t
affect the SUM function.
2. Position the cursor in the cell where you want the results to appear.
3. Enter =SUM( to begin the function entry.
Figure 7-1:
Using the
SUM
function to
add non-
contiguous
numbers.
114
Part II: Counting on Your Money 

4. Enter the range address that contains the numbers. 
Alternatively, you can click in the first cell with a number, hold down the
left mouse button, and drag the mouse over the range of cells.
5. Type a ), and press Enter.
Using a range address in the function is a real timesaver — and is easier on
the fingers, too. Figure 7-2 shows how a single range is used with the SUM
function. Look at the Formula Bar and you’ll see the entire function’s syntax
is =SUM(B6:B12). A single range takes the place of multiple individual cell
addresses.
You can sum multiple ranges in a single formula, which is great when multiple
distinct contiguous cell ranges all must feed a grand total. Figure 7-3 shows
just such a situation.
Figure 7-3:
Calculating
a sum of
multiple
ranges.
Figure 7-2:
Calculating
a sum from
a range of
cells.
115
Chapter 7: Using Basic Math Functions

Here’s how you use SUM to add the values in multiple ranges:
1. Enter some lists of numbers in a worksheet.
You can add labels to adjacent cells to identify the values, if desired.
2. Position the cursor in the cell where you want the results to appear.
3. Enter =SUM( to begin the function entry.
4. Click the first cell in a range and, while holding down the left mouse
button drag the mouse over all the cells in the range, and then release
the mouse button.
5. Enter a comma (,).
6. Click the first cell in another range and, while holding down the left
mouse button, drag the mouse over all the cells in this range, and
then release the mouse button.
7. Repeat Steps 5 and 6 until all the ranges have been entered into the
function.
8. Type a ), and press Enter.
The completed function entry should look similar to the entry shown in the
Formula Bar in Figure 7-3. Each range is separated by a comma, and a grand
sum is in the cell where the function was entered.
When entering ranges into a formula, you can either type them in or use the
mouse to drag over the range.
Excel has a special button, the AutoSum button, that makes it easier to use
the SUM function. The AutoSum button is on both the Home tab and the
Formulas tab on the Ribbon. The AutoSum feature works best with numbers
that are in a vertical or horizontal list. In a nutshell, AutoSum creates a range
reference for the SUM function to use. AutoSum makes its best guess of what
the range should be. Often, it gets it right — but sometimes you have to help
it along.
Using AutoSum is as easy as a click and pressing the Enter key. Figure 7-4
shows that the AutoSum button on the Ribbon has been clicked, and Excel, in
its infinite wisdom, guessed correctly that the operation is to sum cells
B6:B12. At this point the operation is incomplete. Pressing the Enter key fin-
ishes the formula.
You can click the check mark to the left of the formula to complete the 
operation.
116
Part II: Counting on Your Money 

Follow these steps to use AutoSum:
1. Enter some lists of numbers in a worksheet.
You can add labels to adjacent cells to identify the values, if desired.
2. Position the cursor in the cell where you want the results to appear.
3. Click the AutoSum button.
AutoSum has entered a suggested range into the SUM function.
4. Change the suggested range, if necessary, either by entering it with
the keyboard or using the mouse to drag over a range of cells.
5. Press the Enter key or click the check mark on the Formula Bar to
complete the function.
It’s easy to use AutoSum to tally up multiple ranges, such as seen in Figure
7-3. Before ending the function with the Enter key or the check mark, instead
enter a comma and then drag the mouse over another range. Do this for as
many ranges as you need to sum. Finally, finish the function by pressing Enter
or clicking the check mark.
By the way, the AutoSum button can do more than addition. If you click the
down arrow on the button, you have a choice of a few other key functions,
such as Average. See Figure 7-5.
Figure 7-4:
Using
AutoSum to
guess a
range for
the SUM
function.
117
Chapter 7: Using Basic Math Functions

Rounding Out Your Knowledge 
Excel calculates answers to many decimal places. Unless you’re doing rocket
science, you probably don’t need such precise answers. Excel has a great set
of functions for rounding numbers so they’re usable for the rest of us.
Excel’s rounding functions are really helpful. The other day, Ken’s son had a
couple of his friends over. We ordered a large pizza for their lunch. That’s
eight slices for three hungry boys. How many slices does each boy get?
Presto magic, we went over to the computer where Excel was already running
(okay, we are Excel nuts after all), and we entered this simple formula =8/3.
Of course, Excel gave us the perfect answer. Each boy gets 2.66667 slices.
Have you ever tried to cut 66,667/100,000ths of a slice of pizza? Not easy! This
is the type of answer that rounding is used for. Although, to tell you the truth,
we did solve the pizza problem a different way. We gave them each two slices,
and we ate the last two (pretty good with mushrooms!).
Just plain old rounding
Easy to use, the ROUND function is the old tried-and-true method for round-
ing off a number. It takes two arguments — one argument is the number to
round (typically this is a cell reference), and the other argument indicates
how many decimal places to round to.
The ROUND function rounds up or down depending on the number being
rounded. When the value is less than the halfway point of the next significant
digit, then the number is rounded down. When the value is at or greater than
the halfway point, then the number is rounded up:
 10.4 rounds down to 10.
 10.6 rounds up to 11.
 10.5 also rounds up to 11.
Figure 7-5:
Using
AutoSum to
work with
other
popular
functions.
118
Part II: Counting on Your Money 

Table 7-1 shows some examples of the ROUND function.
Table 7-1
Using the ROUND Function
Example of Function
Result
Comment
=ROUND(12.3456,1)
12.3
The second argument is 1. The result is
rounded to a single decimal place.
=ROUND(12.3456,2)
12.35
The second argument is 2. The result is
rounded to two decimal places. Note that
the full decimal of .3456 becomes .35. This
is because the .0456 portion of the deci-
mal value rounds to the closest second
place decimal, which is .05.
=ROUND(12.3456,3)
12.346
The second argument is 3. The result is
rounded to three decimal places. Note
that the full decimal or .3456 becomes
.346. This is because the .0056 portion of
the decimal value rounds to the closest
third place decimal, which is .006.
=ROUND(12.3456,4)
12.3456
The second argument is 4. There are four
decimal places. No rounding takes place.
=ROUND(12.3456,0)
12
When the second argument is 0, the
number is rounded to the nearest integer.
Because 12.3456 is closer to 12 than to 13,
the number rounds to 12.
=ROUND(12.3456,-1)
10
When negative values are used in the
second argument, the rounding occurs
on the left side of the decimal (the integer
portion). A second argument value of –1
tells the function to round to the closest
value of 10. In this example, that value is
10 because 12 is closer to 10 than 20.
Here’s how to use the ROUND function:
1. In a cell of your choice, enter a number that has a decimal portion.
2. Position the cursor in the cell where you want the results to appear.
3. Enter =ROUND( to begin the function entry.
4. Click the cell where you entered the number.
119
Chapter 7: Using Basic Math Functions

5. Enter a comma (,).
6. Enter a number to indicate how many decimal places to round to.
7. Type a ), and press Enter.
Rounding functions make the most sense when the first argument is a cell ref-
erence, not an actual number. Think about it: If you know what a number
should appear as, you would just enter the number — you would not need a
function to round it.
Rounding in one direction
Excel has a handful of functions that round numbers either always up or
always down. That is, when rounding a number, the functions that round
down will always give a result that is lower than the number itself. Functions
that round up, of course, always give a higher number. These functions are
useful when letting the good ol’ ROUND function determine which way to
round just isn’t going to do.
A few of these rounding functions not only round in the desired direction but
even allow you to specify some additional ways of rounding. The EVEN and
ODD functions, for example, round respectively to the closest even or odd
number. The CEILING and FLOOR functions let you round to a multiple. EVEN,
ODD, CEILING, and FLOOR are discussed later in this section.
Directional rounding, pure and simple
ROUNDUP and ROUNDDOWN are similar to the ROUND function. The first argu-
ment to the function is the cell reference of the number to be rounded. The
second argument indicates the number of decimal places to round to. But
unlike the plain old ROUND, the rounding direction is not based on the halfway
point of the next significant digit but rather on which function you use.
For example, =ROUND(4.22,1) returns 4.2, but =ROUNDUP(4.22,1) returns
4.3. ROUNDDOWN, however, returns 4.2 because 4.2 is less than 4.22. Table
7-2 shows some examples of ROUNDUP and ROUNDDOWN.
Table 7-2
Using the ROUNDUP and ROUNDDOWN Functions
Example of Function
Result
Comment
=ROUNDUP(150.255,0)
151
The second argument is 0. The
result is rounded up to the next
higher integer, regardless of the
fact that the decimal portion would
normally indicate the rounding
would go to the next lower integer.
120
Part II: Counting on Your Money 

Example of Function
Result
Comment
=ROUNDUP(150.255,1)
150.3
The second argument is 1. The
result is rounded to a single deci-
mal point. Note that the full deci-
mal of .255 rounds up to.3. This
would also happen with the stan-
dard ROUND function. 
=ROUNDUP(150.255,2)
150.26
The second argument is 2; the
result is rounded to two decimal
places. Note that the full decimal
of .255 becomes .26. This would
also happen with the standard
ROUND function. 
=ROUNDUP(150.255,3)
150.255
The second argument is 3, and
there are three decimal places. No
rounding takes place.
=ROUNDDOWN(155.798,0)
155
The second argument is 0. The
result is rounded down to the inte-
ger portion of the number, regard-
less of the fact that the decimal
portion would normally indicate
that the rounding would go to the
next higher integer.
=ROUNDDOWN(155.798,1)
155.7
The second argument is 1. The
result is rounded to a single deci-
mal place. Note that the full deci-
mal of .798 rounds down to .7. The
standard ROUND function would
round the decimal up to .8.
=ROUNDDOWN(155.798,2)
155.79
The second argument is 2. The
result is rounded to two decimal
places. Note that the full decimal
of .798 becomes .79. The standard
ROUND function would round the
decimal up to .8.
=ROUNDDOWN(155.798,3)
155.798
The second argument is 3, and
there are three decimal places. No
rounding takes place.
Here’s how to use either the ROUNDUP or ROUNDDOWN function:
1. In a cell of your choice, enter a number with a decimal portion.
2. Position the cursor in the cell where you want the results to appear.
121
Chapter 7: Using Basic Math Functions

3. Enter either =ROUNDUP( or =ROUNDDOWN( to begin the function
entry.
4. Click the cell where you entered the number.
5. Enter a comma (,).
6. Enter a number to indicate how many decimal places to round to.
7. Type a ), and press Enter.
Rounding to the multiple of choice
The FLOOR and CEILING functions take directional rounding to a new level.
With these functions, the second argument is a multiple to which to round to.
What does that mean?
Well, imagine this: You’re a human resources manager and you need to pre-
pare a summary report of employee salaries. You don’t need the figures to be
reported down to the last penny, just rounded to the closest $250 multiple.
Either FLOOR or CEILING can be used to do this. For this example, FLOOR
can be used to round down to the closest multiple of $250 that is less than
the salary, or CEILING can be used to round up to the next $250 multiple
greater than the salary. Figure 7-6 shows how both FLOOR and CEILING
return rounded values.
FLOOR and CEILING exceed the rounding ability of ROUND, ROUNDUP, and
ROUNDDOWN. These three functions can use the positioning of digit place-
holders in how they work. For example, =ROUND(B4,-3) tells the ROUND
function to round on the thousandth position. On the other hand, FLOOR and
CEILING can round to whatever specific multiple you set.
The FLOOR function rounds toward 0, returning the closest multiple of the
second argument that is lower than the number itself.
Figure 7-6:
Using
FLOOR or
CEILING to
round to a
desired
multiple.
122
Part II: Counting on Your Money 

The CEILING function works in the opposite direction. CEILING will round its
first argument, the number to be rounded, to the next multiple of the second
number that is in the direction away from 0.
Certainly, a few examples will make this clear! Table 7-3 shows ways that
FLOOR and CEILING can be used.
Table 7-3
Using FLOOR and CEILING for Sophisticated Rounding
Example of Function
Result
Comment
=FLOOR(30.17,0.05)
30.15
The second argument says to
round to the next 0.05 multiple, in
the direction of 0.
=FLOOR(30.17,0.1)
30.1
The second argument says to
round to the next 0.1 multiple, in
the direction of 0.
=FLOOR(-30.17,-0.1)
–30.1
The second argument says to
round to the next 0.1 multiple, in
the direction of 0.
=CEILING(30.17,0.05)
30.2
The second argument says to
round to the next 0.05 multiple,
away from 0.
=CEILING(30.17,0.1)
30.2
The second argument says to
round to the next 0.1 multiple,
away from 0.
=CEILING(-30.17,-0.1)
–30.2
The second argument says to
round to the next 0.1 multiple,
away from 0.
FLOOR and CEILING can be used to round negative numbers. FLOOR rounds
toward 0, and CEILING rounds away from 0. FLOOR decreases a positive
number as it rounds it towards 0 and also decreases a negative number
toward 0, although in absolute terms, FLOOR actually increases the value of a
negative number. Weird, huh?
CEILING does the opposite. It increases a positive number away from 0 and
also increases a negative number away from 0, which in absolute terms
means the number is getting smaller.
123
Chapter 7: Using Basic Math Functions

For both the FLOOR and CEILING functions, the first and second arguments
must match signs. Trying to apply a positive number with a negative multi-
ple, or vice versa, results in an error.
Here’s how to use either the FLOOR or CEILING function:
1. Enter a number in any cell.
2. Position the cursor in the cell where you want the results to appear.
3. Enter either =FLOOR( or =CEILING( to begin the function entry.
4. Click the cell where you entered the number.
5. Enter a comma (,).
6. Enter a number that is the next multiple you want to round the
number to.
For example, to get the floor value, at the ones place, make sure 1 is the
second argument. The first argument should, of course, be a number
larger than 1, and should be a decimal value, like this: =Floor(19.77,
1). This returns 19 as the floor, but hey — don’t hit the ceiling about it!
7. Type a ), and press Enter.
Rounding to the next even or odd number
The EVEN and ODD functions round numbers away from 0. The EVEN func-
tion will round a number to the next highest even integer. ODD rounds a
number to the next highest odd integer. Table 7-4 has examples of how these
functions work.
Table 7-4
Rounding to Even or Odd Integers
Example of Function
Result
Comment
=EVEN(3)
4
Rounds to the next even integer, moving
away from 0.
=EVEN(4)
4
Because 4 is an even number, no rounding
takes place. The number 4 itself is returned. 
=EVEN(4.01)
6
Rounds to the next even integer, moving
away from 0.
=EVEN(-3.5)
–4
Rounds to the next even integer, moving
away from 0.
124
Part II: Counting on Your Money 

Example of Function
Result
Comment
=ODD(3)
3
Because 3 is an odd number, no rounding
takes place. The number 3 itself is returned.
=ODD(4)
5
Rounds to the next odd integer, moving away
from 0.
=ODD(5.01)
7
Rounds to the next odd integer, moving away
from 0.
=ODD(-3.5)
–5
Rounds to the next odd integer, moving away
from 0.
The EVEN function is helpful in calculations that depend on multiples of two.
For example, let’s say you’re in charge of planning a school trip. You need to
figure out how many bus seats are needed for each class. A seat can fit two
children. When a class has an odd number of children, you still have to count
that last seat as taken, even though only one child will sit there.
Say the class has 17 children. This formula tells you how many seats are
needed: =EVEN(17)/2. The EVEN function returns the number 18 (the next
higher integer), and that result is divided by 2 because two children fit on
each seat. The answer is 9 seats are needed for a class of 17.
Here’s how to use either the EVEN or ODD function:
1. Position the cursor in the cell where you want the results to appear.
2. Enter either =EVEN( or =ODD( to begin the function entry.
3. Click a cell where you entered a number, or enter a number.
4. Type a ), and press Enter.
Leaving All Decimals Behind with INT 
The INT function rounds a number down to the next lowest integer. The effect
is as if the decimal portion is just dropped, and often INT is used to facilitate
just that — dropping the decimal.
INT comes in handy when all you need to know is the integer part of a number
or the integer part of a calculation’s result. For example, you may be estimat-
ing what it will cost to build a piece of furniture. You have the prices for each
type of raw material, and you just want a ballpark total.
125
Chapter 7: Using Basic Math Functions

Figure 7-7 shows a worksheet in which a project has been set up. Column A
contains item descriptions, and Column B has the price for each item.
Columns C and D contain the parameters for the project. That is, Column C
contains the count of each item needed, and Column D has the amount of
how much will be spent for each item, that is the price per item multiplied by
the number needed of the item.
The sums to be spent are then summed into a project total. If you added the
item sums as they are — 83.88, 176.76, and 19.96 — you get a total of $211.60.
Instead, the INT function is used to round the total to a ballpark figure of $211.
In cell D8, INT is applied to the total sum, like this:
=INT(SUM(D3:D5))
The INT function effectively drops the decimal portion, .60, and just returns
the integer part, 211. The project estimate is $211.
INT takes only the number as an argument. INT can work on positive or nega-
tive values, but works a little differently with negative numbers. INT actually
rounds down a number to the next lower integer. When working with positive
numbers the effect appears the same as just dropping the decimal. With neg-
ative numbers the effect is dropping the decimal portion then subtracting 1.
With negative numbers, the function produces an integer that is further away
from 0. Therefore, a number such as –25.25 becomes –26. Here are some
examples:
 INT(25.25) returns 25.
 INT(25.75) returns 25.
 INT(-25.25) returns –26.
 INT(-25.75) returns –26.
Figure 7-7:
Using INT to
drop un-
necessary
decimals.
126
Part II: Counting on Your Money 

Here’s how to use the INT function:
1. In a cell of your choice, enter a number that has a decimal portion.
2. Position the cursor in the cell where you want the results to appear.
3. Enter =INT( to begin the function entry.
4. Click the cell where you entered the number.
5. Enter a closing parenthesis to end the function, and press Enter.
INT can also be used to return just the decimal part of a number. Subtracting
the integer portion of a number from its full value leaves just the decimal as
the answer. For example, 10.95-INT(10.95) equals 0.95.
Leaving Some Decimals 
Behind with TRUNC 
The TRUNC function drops a part of a number. The function takes two argu-
ments. The first argument is the number to be changed. The second argu-
ment indicates how much of the number is to be dropped. A value of 2 for the
second argument says to leave 2 decimal places remaining. A value of 1 for
the second argument says to leave 1 decimal place remaining.
TRUNC does no rounding as it truncates numbers. Here are some examples:
 =TRUNC(212.65, 2) returns 212.65.
 =TRUNC(212.65, 1) returns 212.6.
 =TRUNC(212.65, 0) returns 212.
You can even use TRUNC to drop a portion of the number from the integer
side. To do this, you enter negative values for the second argument, like this:
 =TRUNC(212.65, -1) returns 210.
 =TRUNC(212.65, -2) returns 200.
The INT and TRUNC functions work exactly the same way for positive num-
bers. The only difference is when negative numbers are being changed. Then
INT’s rounding produces a different result than TRUNC’s truncation.
127
Chapter 7: Using Basic Math Functions

Looking for a Sign
Excel’s SIGN function tells you whether a number is positive or negative. The
SIGN function does not alter the number in any way but instead is used to
find out information about the number.
SIGN does actually return a number, but it isn’t a variation of the number
being tested in the function. SIGN returns only three different numbers:
 1 if the number being tested is positive
 –1 if the number being tested is negative
 0 if the number being tested is 0
Consider these examples:
 =SIGN(5) returns 1.
 =SIGN(-5) returns –1.
 =SIGN(0) returns 0.
USING SIGN in combination with other functions presents sophisticated ways
of working with your information. As an example, you may be tallying up a
day’s receipts from your store. You want to know the total value of sold mer-
chandise and the total value of returned merchandise. Sales are recorded as
positive amounts, and returns are recorded as negative amounts.
Figure 7-8 shows a worksheet with these facts. Column A shows individual
transaction amounts. Most are sales and are positive. A few returns occurred
during the day, entered as negative amounts.
Figure 7-8:
Using SIGN
to help
correctly
sum
amounts.
128
Part II: Counting on Your Money 

Just summing the whole transaction list would calculate the net revenue of
the day, but often a business needs better information. Instead, two sums are
calculated: the sum of sales and the sum of returns.
For each value in Column A, there is a value in Column B. The Column B
values are the result of using the SIGN function. For example, cell B3 has this
formula: =SIGN(A3).
As shown in Figure 7-8, values in Column B equal 1 when the associated value
in Column A is positive. Column B displays –1 when the associated value is
negative. This information is then used in a SUMIF function, which selectively
sums information from Column A.
In cell B18 is this formula: =SUMIF(B3:B15,1,A3:A15).
In cell B19 is this formula: =ABS(SUMIF(B3:B15,-1,A3:A15)).
The SUMIF function is used to indicate a criterion to use in determining
which values to sum. For the sum of sales in cell B18, the presence of the
value 1 in Column B determines which values to sum in Column A. For the
sum of returns in cell B19, the presence of the value –1 in Column B deter-
mines which values to sum in Column A.
Also, the ABSOLUTE function (ABS) is used to present the number in cell B19
as a positive number. The answer in cell B19 is the sum of merchandise
returns. You would say there was $64.18 (not –$64.18) in returned merchandise,
if you were asked.
The SUMIF function is covered in Chapter 8. The ABS function is covered next
in this chapter.
Here’s how to use the SIGN function:
1. Position the cursor in the cell where you want the results to appear.
2. Enter =SIGN( to begin the function entry.
3. Click a cell where you entered a number, or enter a number.
4. Type a ), and press Enter.
Ignoring Signs
The ABS function returns the absolute value of a number. The absolute number
is always a positive. The absolute of a positive number is the number itself.
The absolute of a negative number is the number but with the sign changed to
positive. For example, =ABS(100) returns 100, as does =ABS(-100).
129
Chapter 7: Using Basic Math Functions

The ABS function is handy in a number of situations. For example, sometimes
imported data comes in as negative values, which need to be converted to
their positive equivalents. Or, for example, when working with cash flows as
discussed in Chapter 3, the ABS function can be used to present cash flows
as positive numbers.
A common use of the ABS function is to calculate the difference between two
numbers when you don’t know which number has the greater value to begin
with. Say you need to calculate the difference between scores for two contes-
tants. Score 1 is in cell A5, and score 2 is in cell B5. The result goes in cell C5.
The formula in cell C5 would then be =A5-B5.
Plugging in some numbers, assume score 1 is 90 and score 2 is 75. The differ-
ence is 15. Okay, that’s a good answer. What happens when score 1 is 75 and
score 2 is 90? The answer is –15. This answer is mathematically correct but
not presented in a useful way. The difference is still 15, not –15. By using the
ABS function, the result is always returned as positive. Therefore, for this
example, the best formula coding is like this: =ABS(A5-A6).
Now either way, whether score 1 is greater than score 2 or score 2 is greater
than score 1, the correct difference is returned.
Here’s how to use the ABS function:
1. Position the cursor in the cell where you want the results to appear.
2. Enter =ABS( to begin the function entry.
3. Click a cell where you entered a number, or enter a number.
4. Type a ), and press Enter.
130
Part II: Counting on Your Money 

Chapter 8
Advancing Your Math
In This Chapter
 Calculating the diameter, circumference, and area of a circle
 Working with combinations and permutations
 Performing sophisticated multiplication
 Using the MOD function to test other numerical values
 Using the SUBTOTAL function for a variety of arithmetic and statistical totals
 Using the SUMIF function for selective summation
I
n this chapter, we show you some of the more advanced math functions.
You won’t use these functions everyday, but they’re just the right thing
when you need them. Some of this will come back to you because you proba-
bly learned most of this in school.
Using PI to Calculate Circumference 
and Diameter
Pi is the ratio of a circle’s circumference to its diameter. A circle’s circumfer-
ence is its outer edge and is equal to the complete distance around the circle.
A circle’s diameter is the length of a straight line spanning from one side of
the circle, through the middle, and reaching the other side.
Dividing a circle’s circumference by its diameter returns a value of approxi-
mately 3.14159, known as pi. Pi is represented with the Greek letter pi and the
symbol π.
Mathematicians have proven that pi is an irrational number — in other words,
it has an infinite number of decimal places. They have calculated the value of
pi to many thousands of decimal places, but you don’t need that level of pre-
cision in most calculations. Many people use the value 3.14159 for pi, but the

PI function in Excel does a bit better than that. Excel returns a value of pi
accurate to 15 digits — that is 14 decimal places in addition to the integer 3.
This function has no input arguments. The function uses this syntax:
=PI()
In Excel, the PI function always returns 3.14159265358979, but initially it may
look like some of the decimal points are missing. Change the formatting of the
cell to display numbers with 14 decimal places to see the entire number.
If you know the circumference of a circle, you can calculate its diameter with
this formula:
diameter = circumference ÷ pi
If you know the diameter of a circle, you can calculate its circumference with
this formula:
circumference = diameter × pi
If you know the diameter of a circle, you can calculate the area of the circle. A
component of this calculation is the radius, which equals one-half of the
diameter. The formula is:
area = (diameter × 0.5)^2 × pi
Generating and Using Random Numbers
Random numbers are, by definition, unpredictable. That is, given a series of
random numbers, you can’t predict the next number from what has come
before. Random numbers are quite useful for trying out formulas and calcula-
tions. Suppose you’re creating a worksheet to perform various kinds of data
analysis. You may not have any real data yet, but you can generate random
numbers to test the formulas and charts in the worksheet.
For example, an actuary may want to test some calculations based on a dis-
tribution of people’s ages. Random numbers that vary between 18 and 65
could be used for this task. You don’t have to manually enter fixed values
between 18 and 65, because Excel can generate them automatically using the
RAND function.
132
Part II: Counting on Your Money 

The RAND function is simple — it takes no arguments and returns a decimal
value between 0 and 1. That is, RAND never actually returns 0 or 1; the value
is always in between these two numbers. The function is entered like this:
=RAND()
The RAND function returns values such as 0.136852731, 0.856104058, or
0.009277161. “Yikes!” you may be thinking. “How do these numbers help if
you need values between 18 and 65.” Actually it’s easy with a little extra
math.
There is a standard calculation for generating random numbers within a
determined range. The calculation follows:
= RAND() * (high number - low number) + low number
Using 18 and 65 as a desired range of numbers, the formula looks like =RAND()
*(65-18)+18. Some sample values returned with this formula follow:
51.71777896
27.20727871
24.61657068
55.27298686
49.93632709
43.60069745
Almost usable! But what about the long decimal portions of these numbers?
Some people lie about their ages, but I’ve never heard someone say he’s 27.2
years old!
All that is needed now for this 18-to-65 age example is to include the INT or
ROUND function. INT simply discards the decimal portion of a number.
ROUND allows control over how to handle the decimal portion.
The syntax for using the INT function with the RAND function follows:
= INT((high number – low number + 1) * RAND() + low
number)
The syntax for using the ROUND function with the RAND function follows:
=ROUND(RAND() * (high number-low number) + low number,0)
133
Chapter 8: Advancing Your Math

Try it yourself! Here’s how to use RAND and INT together:
1. Position the pointer in the cell where you want the results displayed.
2. Enter =INT(( to begin the formula.
3. Click the cell that has the highest number to be used, or enter such a
value.
4. Enter -- (a minus sign).
5. Click the cell that has the lowest number to be used, or enter such a
value.
6. Enter +1) * RAND( ) + .
7. Click again on the cell that has the lowest number to be used, or enter
the value again.
8. Type a ), and press Enter.
A random number, somewhere in the range of the low and high number, is
returned.
Table 8-1 shows how returned random numbers can be altered with the INT
and ROUND functions.
Table 8-1
Using INT and ROUND to Process Random Values
Value
Value Returned with INT
Value Returned with ROUND
51.71777896
51
52
27.20727871
27
27
24.61657068
24
25
55.27298686
55
55
49.93632709
49
50
43.60069745
43
44
Table 8-1 points out how the INT and ROUND functions return different num-
bers. For example, 51.71777896 is more accurately rounded to 52. Bear in mind
that the second argument in the ROUND function, 0 in this case, has an effect on
how the rounding works. A 0 tells the ROUND function to round the number to
the nearest integer, up or down to whichever integer is closest to the number.
134
Part II: Counting on Your Money 

Random values are volatile. Each time a worksheet is recalculated the
random values change. This behavior can be avoided by typing the formula
directly into the Formula Bar and pressing the F9 key.
A last but not insignificant note about using the RAND function: It is subject
to the recalculation feature built into worksheets. In other words, each time
the worksheet calculates, the RAND function is rerun and returns a new
random number. The calculation setting in your worksheet is probably set to
automatic. You can check this by looking at the Formulas tab in the Excel
Options dialog box. Figure 8-1 shows the calculation setting. On a setting of
Automatic, the worksheet recalculates with every action. The random gener-
ated numbers keep changing, which can become quite annoying — not to
mention the fact that it can ruin your work!
Luckily, you can generate a random number but have it remain fixed regard-
less of the calculation setting. The method is to type the RAND function,
along with any other parts of a larger formula, directly into the Formula Bar.
After you type your formula in, press the F9 key. This tells Excel to calculate
the formula and enter the returned random number as a fixed number
instead of a formula. If you press the Enter key or finish the entry in some
way other than using the F9 key, you’ll have to enter it again.
Figure 8-1:
Setting
worksheet
calculation
options.
135
Chapter 8: Advancing Your Math

Ordering Items
Remember the Beatles? John, Paul, George, and Ringo? If you’re a drummer,
you may think of the Beatles as Ringo, John, Paul, and George. The order of
items in a list is known as a permutation. The more items in a list, the more
possible permutations exist.
Excel provides the PERMUT function. It takes two arguments: the total
number of items to choose from and the number of items to be used in deter-
mining the permutations. The function returns a single whole number. The
syntax of the function follows:
=PERMUT(total number of items, number of items to use)
Use permutations when the order of items is important.
The total number of items must be the same as or greater than the number of
items to use, or else an error is generated.
You may be confused about why the function takes two arguments. On the
surface, it seems that the first argument is sufficient. Well, not quite. Getting
back to the Beatles (anyone have a copy of Abbey Road we can borrow?). If
we plug in 4 as the number for both arguments, like this — =PERMUT(4,4) —
24 permutations are returned:
136
Part II: Counting on Your Money 
 John Paul George Ringo
 John Paul Ringo George
 John George Paul Ringo
 John George Ringo Paul
 John Ringo Paul George
 John Ringo George Paul
 Paul John George Ringo
 Paul John Ringo George
 Paul George John Ringo
 Paul George Ringo John
 Paul Ringo John George
 Paul Ringo George John
 George John Paul Ringo
 George John Ringo Paul
 George Paul John Ringo
 George Paul Ringo John
 George Ringo John Paul
 George Ringo Paul John
 Ringo John Paul George
 Ringo John George Paul
 Ringo Paul John George
 Ringo Paul George John
 Ringo George John Paul
 Ringo George Paul John

Altering the function to use 2 items at a time from the total of 4 items —
PERMUT(4,2) — returns just 12 permutations:
137
Chapter 8: Advancing Your Math
 John Paul
 John George
 John Ringo
 Paul John
 Paul George
 Paul Ringo
 George John
 George Paul
 George Ringo
 Ringo John
 Ringo Paul
 Ringo George
Just for contrast, using the number 2 for both arguments — PERMUT(2,2) —
returns just two items! When using PERMUT, make sure you’ve selected the
correct numbers for the two arguments; otherwise, you’ll end up with an
incorrect result and may not be aware of the mistake. The PERMUT function
simply returns a number. The validity of the number is in your hands.
Combining 
Combinations are similar to permutations but with a distinct difference. The
order of items is intrinsic to permutations. Combinations, however, are
groupings of items when the order doesn’t matter. For example, “John Paul
George Ringo” and “Ringo George Paul John” are two distinct permutations
but identical combinations.
Combinations are grouping of items, regardless of the order of the items.
The syntax for the function follows:
=COMBIN(total number of items, number of items to use)
The first argument is the total number of items to choose from, and the
second argument is the number of items to be used in determining the combi-
nations. The function returns a single whole number. The arguments for the
COMBIN function are the same as those for the PERMUT function. The first
argument must be equal to or greater than the second argument.
Plugging in the number 4 for both arguments — COMBIN(4,4) — returns 1.
Yes, there is just one combination of four items selected from a total of four
items! Using the Beatles once again, just one combination of the four musi-
cians exists, because the order of names doesn’t matter.

Selecting to use two items from a total of four — COMBIN(4,2) — returns 6.
Selecting two items out of two — COMBIN(2,2) — returns 1. In fact, whenever
the two arguments to the COMBIN function are the same, the result is always 1.
Raising Numbers to New Heights 
There is an old tale about a king who loved chess so much he decided to
reward the inventor of chess with any request he had. The inventor asked for
a grain of wheat for the first square of the chessboard on Monday, two grains
for the second square on Tuesday, four for the third square on Wednesday,
eight for the fourth square on Thursday, and so on, each day doubling the
amount until the 64th square was filled with wheat. The king thought this was
a silly request. The inventor could have asked for riches!
What happened is that the kingdom quickly ran out of wheat. By the 15th day,
the number equaled 16,384. By the 20th day, the number was 524,288. On the
64th day, the number would have been an astonishing
9,223,372,036,854,780,000, but the kingdom had run out of wheat at least a
couple of weeks earlier!
This “powerful” math is literally known as raising a number to a power. The
power, in this case, means how many times a number is to be multiplied by
itself. The notation is typically seen as a superscript (23 for example). Another
common way of noting the use of a power is with the carat symbol: 2^3. The
verbiage for this is two to the third power.
In the chess example, 2 is raised to a higher power each day. Table 8-2 shows
the first ten days.
Table 8-2
The Power of Raising Numbers to a Power
Day
Power 
Power 
Basic Math 
Result
That 2 Is 
Notation
Notation
Raised To
1
0
20
1
1
2
1
21
2
2
3
2
22
2 × 2
4
4
3
23
2 × 2 × 2
8
5
4
24
2 × 2 × 2 ×2
16
138
Part II: Counting on Your Money 

Day
Power 
Power 
Basic Math 
Result
That 2 Is 
Notation
Notation
Raised To
6
5
25
2 × 2 × 2 × 2 × 2
32
7
6
26
2 × 2 × 2 × 2 × 2 × 2
64
8
7
27
2 × 2 × 2 × 2 × 2 × 2 × 2
128
9
8
28
2 × 2 × 2 × 2 × 2 × 2 × 2 × 2
256
10
9
29
2 × 2 × 2 × 2 × 2 × 2 × 2 × 2 × 2
512
The concept is easy enough. Each time the power is incremented by 1, the
result doubles. Note that the first entry raises 2 to the 0 power. Isn’t that
strange? Well, not really. Any number raised to the 0 power = 1. Also note that
any number raised to the power of 1 equals the number itself.
Excel provides the POWER function, whose syntax follows:
=POWER(number, power)
Both the number and power arguments can be integer or real numbers, and
negative numbers are allowed.
In a worksheet, either the POWER function or the carat can be used. For
example, in a cell you can enter =POWER(4,3), or =4^3. The result is the
same either way. The carat is inserted by holding Shift and pressing the
number 6 key on the keyboard.
Multiplying Multiple Numbers 
The PRODUCT function is useful for multiplying up to 255 numbers at once.
The syntax follows:
=PRODUCT (number1, number2,...)
Cell references can be included in the argument list, as well as actual num-
bers, and, of course, they can be mixed. Therefore, all these variations work:
=PRODUCT(A2, B15, C20)
=PRODUCT(5, 8, 22)
=PRODUCT(A10, 5, B9)
139
Chapter 8: Advancing Your Math

In fact, you can use arrays of numbers as the arguments. In this case, the
notation looks like this:
=PRODUCT(B85:B88,C85:C88, D86:D88)
Here’s how to use the PRODUCT function:
1. Enter some values on a worksheet.
You can include many values, going down columns or across in rows.
2. Position the pointer in the cell where you want the results displayed.
3. Enter =PRODUCT( to begin the function.
4. Click a cell that has a number. 
Alternatively, you can hold down the left mouse button and drag the
pointer over a range of cells with numbers.
5. Enter a comma (,).
6. Repeat Steps 4 and 5 up to 255 times.
7. Enter a ), and press Enter.
The result you see is calculated by multiplying all the numbers you selected.
Your fingers would probably hurt if you had done this on a calculator.
Figure 8-2 shows this on a worksheet. Cell C10 shows the result of multiplying
12 numbers, although only three arguments, as ranges, have been used in the
function.
Figure 8-2:
Putting the
PRODUCT
function to
work.
140
Part II: Counting on Your Money 

Using What Remains with 
the MOD Function
The MOD function returns the remainder from an integer division operation.
This is called the modulus, hence the function’s name. The function has two
arguments: the number being divided, and the number being used to divide
the first argument. The second argument is the divisor. The syntax follows:
=MOD(number, divisor)
These are examples of the MOD function:
=MOD(12,6) returns 0
=MOD(14,5) returns 4
=MOD(27,7) returns 6
=MOD(25,10) returns 5
=MOD(25,10) returns –5
=MOD(15.675,8.25) returns 7.425
The returned value is always the same sign as the divisor.
You can use MOD to tell whether a number is odd or even. By simply using a
number 2 as the second argument, the returned value will be 0 if the first
argument is an even number and 1 if it is not.
But what’s so great about that? You can just look at a number and tell
whether it’s odd or even. The power of the MOD function is apparent when
testing a reference or formula, such as =MOD(D12 - G15,2). In a complex
worksheet with many formulas, you many not be able to tell when a cell will
contain an odd or even number.
Taking this a step further, the MOD function can be used to identify cells in a
worksheet that are multiples of the divisor. Figure 8-3 shows how this works.
141
Chapter 8: Advancing Your Math

In row 1 of the worksheet in Figure 8-3, the example formulas are entered into
the successive rows of Columns B and C. Column A contains numbers that
will be tested with the MOD function. If looking for multiples of 4, the MOD
function will have 4 as the divisor, and when a value is a multiple of 4, MOD
returns 0. This is evident by comparing the numbers in column A with the
returned values in column B.
The same approach is used in column C, only here the divisor is 10, so multi-
ples of 10 are being tested for in column A. Where a 0 appears in column C,
the associated number in Column A is a multiple of 10.
In this way, the MOD function can be used to find meaningful values in a
worksheet.
Summing Things Up
Ah ha! Just when you think you know how to sum up numbers (really, haven’t
you been doing this since your early school years?) we drum up some fancy-
footing summing that makes you think twice before going for that quick total.
The functions here are very cool — very “in” with the math crowd. To be a
true Excel guru, try out the SUBTOTAL, SUMPRODUCT, and SUMIF functions
shown here, and then strut your stuff around the office!
Using SUBTOTAL
The SUBTOTAL function is very flexible. It doesn’t perform just one calcula-
tion, but rather it can do any one of 11 different calculations depending on
what you need. What’s more, SUBTOTAL can perform these calculations on
Figure 8-3:
Using MOD
to find
specific
values.
142
Part II: Counting on Your Money 

up to 255 ranges of numbers. This gives you the ability to get exactly the type
of summary you need without creating a complex set of formulas. The syntax
for the function follows:
=SUBTOTAL(function number, range1, range2,...)
The first argument determines which calculation is performed. It can be any
of the values shown in Table 8-3. The remaining arguments identify the
ranges containing the numbers to be used in the calculation.
Table 8-3
Argument Values for the SUBTOTAL Function
Function Number 
Function
Description
for First Argument
1
AVERAGE
Returns the average value of a group of
numbers
2
COUNT
Returns the count of cells that contain
numbers and also numbers within the
list of arguments
3
COUNTA
Returns the count of cells that are not
empty and only non-empty values
within the list of arguments
4
MAX
Returns the maximum value found in a
group of numbers
5
MIN
Returns the minimum value found in a
group of numbers
6
PRODUCT
Returns the product of a group of 
numbers
7
STDEV
Returns the standard deviation from a
sample of values
8
STDEVP
Returns the standard deviation from an
entire population, including text and
logical values
9
SUM
Returns the sum of a group of numbers
10
VAR
Returns variance based on a sample
11
VARP
Returns variance based on an entire
population
143
Chapter 8: Advancing Your Math

Figure 8-4 exemplifies a few uses of the SUBTOTAL function. Raw data values
are listed in Column A. The results of using the function in a few variations
are listed in Column C. Column D displays the actual function entries that
returned the respective results in Column C.
Using named ranges with the SUBTOTAL function is useful. For example,
=SUBTOTAL(1, October_Sales, November_Sales, December_
sales) makes for an easy way to calculate the average sale of the fourth
quarter.
Using SUMPRODUCT
The SUMPRODUCT function provides a sophisticated way to add various
products — across ranges of values. It doesn’t just add the products of sepa-
rate ranges; it produces products of the values positioned in the same place in
each range, then sums up those products. The syntax for the function follows:
=SUMPRODUCT(Range1, Range2, ...)
The arguments to SUMPRODUCT must be ranges, although a range can be a
single value. What is required is that all the ranges be the same size, both
rows and columns. Up to 255 ranges are allowed, and at least 2 are required.
SUMPRODUCT works by first multiplying elements, by position, across the
ranges, then adding all the results. To see how this works, take a look at the
three ranges of values in Figure 8-5. We have put letters in the ranges instead
of numbers to make this easier to explain. Suppose you entered the following
formula in the worksheet:
=SUMPRODUCT(B2:C4, E2:F4, H2:I4)
Figure 8-4:
Working
with the
SUBTOTAL
function.
144
Part II: Counting on Your Money 

The result would be calculated by the following steps:
1. Multiplying A times H times N and saving the result.
2. Multiplying D times K times Q and saving the result.
3. Multiplying B times I times O and saving the result.
4. Multiplying E times L times R and saving the result.
5. Multiplying C times J times P and saving the result.
6. Multiplying F times M times S and saving the result.
7. Adding all six results to get the final answer.
Be careful when you’re using the SUMPRODUCT function. It’s easy to mistak-
enly assume the function will add products of individual ranges. It won’t.
SUMPRODUCT returns the sums of products across positional elements.
As confusing as SUMPRODUCT seems, it actually has a sophisticated use.
Imagine you have a list of units sold by product, and another list of the prod-
ucts’ prices. You need to know total sales (that is, the sum of the amounts),
where an amount is units sold times the unit price.
In the old days of spreadsheets, you would use an additional column to first
multiply each unit sold figure by its price. Then you would sum those interme-
diate values. Now, with SUMPRODUCT, the drudgery is over. The single use of
SUMPRODUCT gets the final answer in one step. Figure 8-6 shows how one cell
contains the needed grand total. No intermediate steps were necessary.
Figure 8-6:
Being
productive
with SUM-
PRODUCT.
Figure 8-5:
Following
the steps
used by
SUM-
PRODUCT.
145
Chapter 8: Advancing Your Math

Using SUMIF
SUMIF is one of the real gemstones of Excel functions. It calculates the sum of
a range of values, including only those values that meet a specified criterion.
The criterion can be based on the same column that is being summed, or it
can be based on an adjacent column.
Suppose you use a worksheet to keep track of all your food-store purchases.
For each shopping trip, you put the date in Column A, the amount in Column
B, and the name of the store in column C. You can use the SUMIF function to
tell Excel to add all the values in Column B only where Column C contains
“Great Grocery”. That’s it. SUMIF gives you the answer. Neat!
Figure 8-7 shows this example. The date of purchase, place of purchase, and
amount spent are listed in three columns. SUMIF calculates the sum of pur-
chases at Great Grocery. Here is how the function is written for the example:
=SUMIF(C3:C15,”Great Grocery”,B3:B15)
The dates in this example aren’t used, but asking SUMIF to tell how much is
spent on a given day (or range of dates) instead of which store would be easy
enough.
A couple of important points about the SUMIF function:
 The second argument can accommodate several variations of expres-
sions, such as including greater than (>) or less than (<) signs or other
operators. For example, if a column has regions such as North, South,
East, and West, the criteria could be <>North, which would return the
sum of rows that are not for the North region.
 Unpredictable results occur if the ranges in the first and third arguments
do not match in size.
Figure 8-7:
Using
SUMIF for
targeted
tallying.
146
Part II: Counting on Your Money 

Try it yourself! Here’s how to use the SUMIF function:
1. Enter two ranges of data in a worksheet.
At least one should contain numerical data. Make sure both ranges are
the same size.
2. Position the pointer in the cell where you want the results displayed.
3. Enter =SUMIF( to begin the function.
4. Hold down the left mouse button and drag the pointer over one of the
ranges.
This is the range that can be other than numerical data.
5. Enter a comma (,).
6. Click one of the cells in the first range.
This is the criteria.
7. Enter a comma (,).
8. Hold down the left mouse button and drag the pointer over the
second range.
This is the range that must contain numerical data.
9. Enter a ), and press Enter.
The result you see is a sum of the numeric values where the items in the first
range matched the selected criteria.
147
Chapter 8: Advancing Your Math

148
Part II: Counting on Your Money 

Chapter 9
Throwing Statistics a Curve
In This Chapter
 Understanding key terms used in statistics
 Testing for central tendencies in a data sample
 Analyzing deviation in a data sample
 Looking for similarities in two data samples
 Analyzing by bins and percentiles
 Counting items in a data sample
Just pick up the newspaper or turn on the television or the radio. We’re
bombarded with interesting facts and figures that are the result of statisti-
cal work: There is a 60 percent chance of rain; the Dow Jones Industrial
Average gained 2.8 percent; the Yankees are favored over the Red Sox, 4-3;
and so on.
Statistics are used to tell us facts about the world around us. Statistics are
also used to give us lies about our world. Statistics can be used to confuse 
or obscure information. Imagine you try a new candy bar and you like it. Well,
then you can boast that 100 percent of the people who tried it liked it!
Sometimes statistics produce odd conclusions — to say the least! Imagine
this: Bill Gates helps out at a homeless shelter. The average wealth of the 40
or so people in the room is $1 billion. How about this: You hear on the news
that the price of gasoline dropped 6 percent. Hurray! Let’s go on a trip. But
what is that 6 percent decrease based on? Is it a comparison to last week’s
price, last month’s price, or last year’s price? Perhaps the price of gasoline
dropped 6 percent, compared to last month. But still prices are 20 percent
higher than last year. Is this good news?
Statistics are traditionally divided into two types. Descriptive statistics, cov-
ered in this chapter, help you to summarize and understand data. Inferential
statistics, covered in Chapter 10, are used to draw conclusions about data
comparisons.

Stuck in the Middle with AVERAGE,
MEDIAN, and MODE
Are you of average height? Do you earn an average income? Are your children
getting above-average grades? There is more than a single way to determine
the middle value from a group of values. There are actually three common
statistical functions to describe the center value from a population of values.
These are the mean, the median, and the mode.
The term population refers to all possible measurements or data points, while
the term sample refers to the measurements or data points that you actually
have. For example, if you are conducting a survey of registered voters in New
Jersey, the population is all registered voters in the state, while the sample is
those voters who actually took the survey.
Technically, the term average refers to the mean value, but in common lan-
guage average can also be used to mean the median or the mode instead of
the mean. This leads to all sorts of wonderful claims from advertisers and
anyone else who wants to make a point. 
It’s important to understand the difference between these terms:
 Mean: The mean is a calculated value. It’s the result of summing the
values in a list or set of values and then dividing the sum by the number
of values. For example, the average of the numbers 1, 2, and 3 equals 2.
This is calculated as (1 + 2 + 3) ÷ 3 or 6 ÷ 3.
 Median: The median is the middle value in a sorted list of values. If there
is an odd number of items in the list, then the median is the actual middle
value. In lists with an even number of items there is no actual middle
value. In this case, the median is the mean of the two values in the
middle. For example, the median of 1, 2, 3, 4, 5 is 3 because the middle
value is 3. The median of 1, 2, 3, 4, 5, 6 is 3.5 because the mean of the two
middle values, 3 and 4, is 3.5. 
 Mode: The mode is the value that has the highest occurrence in a list 
of values. It may not exist! In the list of values 1, 2, 3, 4 there is no mode
because each number is present the same number of times. In the list of
values 1, 2, 2, 3, 4 the mode is 2 because 2 is used twice and the other
numbers are used once.
The mean, median, and mode are sometimes called measures of central ten-
dency because they serve to summarize a data sample in a single statistic.
150
Part II: Counting on Your Money 

Get started! These steps create three results in your worksheet, using the
AVERAGE, MEDIAN, and MODE functions:
1. Enter a list of numerical values.
Any mix of numbers will do.
2. Position the cursor in the cell where you want the mean to appear.
3. Enter =AVERAGE( to start the function.
4. Drag the pointer over the list, or enter the address of the range.
5. Enter a ) to end the AVERAGE function.
6. Position the cursor in the cell where you want the median to appear.
7. Enter =MEDIAN( to start the function.
8. Drag the pointer over the list, or enter the address of the range.
9. Enter a ) to end the MEDIAN function.
10. Position the cursor in the cell where you want the mode to appear.
11. Enter =MODE( to start the function.
12. Drag the pointer over the list, or enter the address of the range.
13. Enter a ) to end the MODE function.
Depending on the numbers you entered, the three results may be the same
(very unlikely!), or about the same, or quite different. The MODE function will
have returned #N/A if there were no repeating values in your data.
The mean is calculated using the AVERAGE function.
Imagine this: Three people use a new toothpaste for six months, and then all
go to the dentist. Two have no cavities. Hey, this toothpaste is great! The
third person has three cavities. Uh oh!
Person
Cavities
A
0
B
0
C
3
The average number of cavities for this group is 1. That is, if you’re using 
the mean as the average. This doesn’t sound like a good toothpaste if, on
average, each person who used it got a cavity! On the other hand, both the
median and the mode equal 0. The median equals 0 because that’s the middle
value in the sorted list. The mode equals 0 because that’s the highest occur-
ring value. As you can see, statistics prove that the new toothpaste gives 0
cavities, on average — sort of.
151
Chapter 9: Throwing Statistics a Curve

Look at another example. Figure 9-1 shows the results of a midterm test for a
hypothetical class. The mean, median, and mode are shown for the distribu-
tion of grades.
As almost always happens, the mean, the median, and the mode each return
a different number. Strictly speaking, we should say that the average grade is
86.83, the mean value. But if the teacher or the school wants to make their
impact on students look better, they could point out that the most frequently
occurring score is 94. This is the mode and, sure enough, three students did
receive a 94. But is this the best representation of the overall results?
Probably not.
Working with the functions that return these measures of central tendencies —
AVERAGE, MEDIAN, and MODE — can make for interesting and sometimes mis-
leading results. Here is one more example of how these three functions can
give widely different results for the same data. Here are data for six customers
and what they spent with a company last year:
Customer
Total Amount Spent Last Year
A
$300
B
$90
C
$2,600
D
$850
E
$28,400
F
$1,000
The mean (using the AVERAGE function) is $5,413. The median is $650, and
the mode is $90. These three amounts aren’t even close! Which one best 
represents the typical amount that a customer spent last year? 
The issue with this set of data is that one value — $28,400 — is so much larger
than the other values that it skews the mean. You may be led to believe that
each customer spent about $5,540. But looking at the real values, only one
single customer spent a lot of money, relatively speaking. Customers A, B, C,
D, and F spent nowhere near $5,540, so how can that “average” apply to them?
Figure 9-1:
Defining
central
tendencies
in a list of
grades.
152
Part II: Counting on Your Money 

Figure 9-2 shows this situation in which one value is way out of league with
the rest — sometimes called an outlier — which makes the average not too
useful. Figure 9-2 also shows how much the mean changes if the one spend-
thrift customer is left out, but if you leave out any other customer there is
very little change in the mean.
In Scenario 2, Customer E is left out. The mean and the median are much
closer together — $968 and $850, respectively. Either amount reasonably 
represents the mid value of what customers spent last year.
But can you just drop a customer like that (not to mention the biggest cus-
tomer)? Yikes! Instead, you can consider a couple of creative averaging solu-
tions. Either use the median or use a weighted average (a calculation of the
mean but in which the relevance of each value is taken into account). Figure
9-3 shows the result of each approach.
Scenario 1 shows the mean and the median for the set of customer amounts.
Here, using the median is a better representation of the central tendency of
the group.
Figure 9-3:
Calculating
a creative
mean.
Figure 9-2:
Deciding
what to do
with an
unusual
value.
153
Chapter 9: Throwing Statistics a Curve

When reporting results based on an atypical calculation, it’s good practice to
add a footnote that explains how the answer was determined. If you were to
report that the “average” expenditure was $925, a note should explain this is
the median, not the mean.
Scenario 2 in Figure 9-3 is a little more complex. This involves making a
weighted average, which is used to let individual values be more or less influ-
ential in the calculation of a mean. This is just what you need! Customer E
needs to be less influential.
Weighted averages are the result of applying a weighting factor to each value
that is used in calculating the mean. In our example, all the customers are
given a weight factor of 18 except Customer E, who has a weight factor of 10.
All customers except Customer E have been given increased weight, and
Customer E has been given decreased weight because his sales value is so
different from all of the others. When weights are applied in an average, the
sum of the weights must equal 100. Without applying any weighting factor,
each customer effectively has a weight of 16.667 — the number of customers
divided into 100. Applying a weight of 10 to Customer E, and 18 to all the
other customers, keeps the sum of the weights at 100: 18 × 5 + 10. The values
of 18 and 10 have been subjectively chosen. When you use weighting factors
to calculate a weighted average you must make that fact known when you
present the results.
The mean in Scenario 2 is $3,711. This figure is still way above the median or
even the mean of just the five customers without Customer E; refer to Figure
9-2. Even so, it’s less than the unweighted mean shown in Scenario 1 and is
probably a more accurate reflection of the data.
By the way, the mean in Scenario 2 is not calculated with the AVERAGE 
function, which cannot handle weighted means. Instead, the SUMPRODUCT
function is used. The actual formula in cell F18 looks like this:
=SUMPRODUCT(F9:F14,G9:G14)/SUM(G9:G14)
The amount that each customer spent last year is multiplied by that cus-
tomer’s weight, and a sum of those products is calculated with SUMPROD-
UCT. Finally, the sum of the products is divided by the sum of the weights.
Deviating from the Middle
Life is full of variety! Calculating the mean for a group will not reflect that
variety. Suppose you are doing a survey of salaries for different occupations
and that occupation A has a mean salary of $75,000 a year and occupation B
154
Part II: Counting on Your Money 

has the same mean of $75,000 a year. Does this mean that the two groups are
the same? Not necessarily. Suppose that in group A the salaries range from
$65,000 to $85,000 but in group B they range from $35,000 to $115,000. This
difference — how much the values differ from the mean — is called variance.
Excel provides you with functions to calculate and evaluate variance, and
this is an important part of many statistical presentations.
Measuring variance 
Variance is a measure of how spread out a set of data is in relation to the mean.
Variance is calculated by summing the squared deviations from the mean. 
Mathematics that make you work
Specifically, variance is calculated as follows:
1. Calculate the mean of the set of values.
2. Calculate the difference from the mean for each value.
3. Square each difference.
4. Sum up the squares.
5. Divide the sum by the number of items in the sample, minus 1.
A sample is a selected set of values taken from the population. A sample is
easier to work with. For example, any statistical results found on 1,000 sales
transactions probably would return the same, or close to the same, results if
run on the entire population of 10,000 transactions.
Note that the last step differs depending on whether the VAR or VARP func-
tion is used. VAR uses the number of items, minus 1, as the denominator.
VARP uses the number of items.
Figure 9-4 shows these steps in calculating a variance without using Excel’s
built-in function for the task. Column B has a handful of values. Column C shows
the deviation of each figure from the mean of the values. The mean, which
equals 7.8, is never actually shown. Instead, the mean is calculated within the
formula that computes the difference. For example, cell C8 has this formula:
=B8-AVERAGE($B$4:$B$8)
Column D squares the values in Column C. This is an easy calculation. Here
are the contents of cell D8: =C8^2. Finally, the sum of the squared deviations
is divided by the number of items, less one item. The formula in cell D12 is
=SUM(D4:D8)/(COUNT(B4:B8)-1).
155
Chapter 9: Throwing Statistics a Curve

Functions that do the work: VAR and VARP
Now that you know how to create a variance the textbook way, you can forget
it all! We show the mathematical steps so you could understand what hap-
pens, but Excel provides the VAR and VARP functions to do all the grunge
work for you.
In Figure 9-4, cell D15 shows the variance calculated directly with the VAR
function: =VAR(B4:B8).
Try it yourself. Here’s how:
1. Enter a list of numerical values.
Any mix of numbers will do.
2. Position the cursor in the cell where you want the variance to appear.
3. Enter =VAR( to start the function.
4. Drag the pointer over the list, or enter the address of the range.
5. Enter a ).
Variance is calculated on either a population of data or a sample of the popu-
lation:
 The VAR function calculates variance on a sample of a population’s data.
 The VARP function calculates variance on the full population.
The calculation is slightly different in that the denominator for variance of a
population is the number of items. The denominator for variance of a sample
is the number of items less one. Figure 9-5 shows how VAR and VARP are used
on a sample and the full population. Cells A4:A43 contain the number of
hours of television watched daily by 40 individuals.
The VAR function calculates the variance of a sample of 20 values. The VARP
function calculates the variance of the full population of 40 values. VARP is
entered in the same fashion as VAR. Here’s how:
Figure 9-4:
Calculating
variance
from the
mean.
156
Part II: Counting on Your Money 

1. Enter a list of numerical values.
Any mix of numbers will do.
2. Position the cursor in the cell where you want the variance to appear.
3. Enter =VARP( to start the function.
4. Drag the pointer over the list, or enter the address of the range.
5. Enter a ).
Analyzing deviations
Often, finding the mean is an adequate measure of a sample of data.
Sometimes the mean is not enough — you also want to know the average
deviation from the mean. That is, finding the average of how far individual
values differ from the mean of the sample. For example, you may need to
know the average score on a test and also how far the scores, on average,
differ from the mean. Average deviation is another way to specify variance.
Here’s an example:
Score
Deviation from 83.17 Mean
78
5.17
92
8.83
97
3.83
80
3.17
72
11.17
90
6.83
Figure 9-5:
Calculating
variance
from the
mean.
157
Chapter 9: Throwing Statistics a Curve

The mean of this sample of values is 83.17. Use the AVERAGE function, if you
want to double-check. Each individual value deviates somewhat from the
mean. For example, 92 has a deviation value of 8.83 from the mean. A simple
equation proves this: 92 – 83.17 = 8.83.
If you use the AVERAGE function to get the mean of the deviations, you have
the average deviation. It’s even easier than that, though. Excel provides the
AVEDEV function for this very purpose! AVEDEV calculates the mean and
averages the deviations all in one step.
Here’s how to use the AVEDEV function:
1. Enter a list of numerical values.
2. Position the cursor in the cell where you want the average deviation
to appear.
3. Enter =AVEDEV( to start the function.
4. Drag the pointer over the list, or enter the address of the range.
5. Enter a ).
The AVEDEV function averages the absolute deviations — in other words, neg-
ative deviations (where the data point is less than the mean) are converted to
positive values for the calculation. For example, a value of 10 has a deviation
of –40 from a mean of 50: 10 – 50 = –40. However, AVEDEV uses the absolute
value of the deviation, 40, instead of –40.
The variance, explained earlier in the chapter, serves as the basis for a
common statistical value called the standard deviation. Technically speaking,
the standard deviation is the square root of the variance. Variance is calcu-
lated by squaring deviations from the mean.
The variance and the standard deviation are both valid measurements of
deviation. However, the variance can be a confusing number to work with. In
Figure 9-4, the variance was calculated to be 17.7 for a group of values whose
range is just 12 (14 – 2). How can a range that is only a size of 12 show a vari-
ance of 17.7? Well, it does, as shown earlier in Figure 9-3.
This oddity is removed when using the standard deviation. The reversing of the
squaring brings the result back to the range of the data. The standard deviation
value fits inside the range of the sample values. In addition, you’ll find the stan-
dard deviation is more commonly used than the variance in statistical analyses.
Excel has a standard deviation formula — STDEV. This is how you use it:
158
Part II: Counting on Your Money 

1. Enter a list of numerical values.
2. Position the cursor in the cell where you want the standard deviation
to appear.
3. Enter =STDEV( to start the function.
4. Drag the pointer over the list, or enter the address of the range.
5. Enter a ).
Figure 9-6 takes the data sample and variance shown in Figure 9-4 and adds
the standard deviation to the picture. The standard deviation is 4.207136794.
This number fits inside the range of the sample data.
Looking for normal distribution 
The standard deviation is one of the most widely used measures in statistical
work. It’s often used to analyze deviation in a normal distribution. A distribu-
tion is the frequency of occurrences of values in a population or sample. A
normal distribution often occurs in large data sets that have a natural, or
random, attribute. For example, taking a measurement of the height of 1,000
10-year-old children will produce a normal distribution. Most of the measured
heights will center around and deviate somewhat from the mean. A few mea-
sured heights will be extreme — both considerably larger than the mean, and
considerably smaller than the mean.
Ringing the bell curve
A normal distribution is often visually represented as a graph in the shape of
a bell — hence the popular name, the bell curve. Figure 9-7 shows a normal
distribution.
Figure 9-6:
Calculating
the standard
deviation.
159
Chapter 9: Throwing Statistics a Curve

A normal distribution has a few key characteristics:
 The curve is symmetrical around the mean — half the measurements 
are greater than the mean and half are less than the mean.
 The mean, median, and mode are all the same.
 The highest point of the curve is the mean.
 The width and height are determined by the standard deviation. 
The larger the standard deviation, the wider and flatter the curve. 
You can have two normal distributions with the same mean and 
different standard deviations.
 68.2 percent of the area under the curve is within one standard 
deviation of the mean (both to the left and the right), 95.44 percent 
of the area under the curve is within two standard deviations, and 
99.72 percent of the area under the curve is within three standard 
deviations.
 The extreme left and right ends of the curve are called the tails.
Extreme values are found in the tails. For example, in a distribution 
of height, very short heights are in the left tail, and very large heights
are in the right tail.
Different sets of data almost always produce different means and standard
deviations and, therefore, a different-shaped bell curve. Figure 9-8 shows two
superimposed normal distributions. Each is a perfectly valid normal distribu-
tion; however, each has its own mean and standard deviation, with the nar-
rower curve having a smaller standard deviation.
Figure 9-7:
Displaying a
normal
distribution
in a graph.
160
Part II: Counting on Your Money 

Analysis is often done with normal distributions to determine probabilities.
For example, what is the probability that a 10-year-old child’s height is 54
inches? Somewhere along the curve is a discrete point that represents this
height. Further computation (outside the scope of this discussion) returns
the probability. What about finding the probability that a 10-year-old is 54
inches high or greater? Then the area under the curve is considered. These
are the type of questions and answers determined with normal distributions.
A good amount of analysis of normal distributions involves the values in the
tails — the areas to the extreme left and right of the normal distribution curve.
All normal distributions have a mean and a standard deviation. However, the
standard normal distribution is characterized by having the mean equal 0 and
the standard deviation equal 1.
A table of values serves as a lookup in determining probabilities for areas
under the standard normal curve. This table is useful when working with data
that has been modified to fit the standard normal distribution. This table is
often found in the appendix section of statistics books and on the Internet as
well. Try www.statsoft.com/textbook/sttable.html.
Using STANDARDIZE 
In order to use this table of standard normal curve probabilities, the data
being analyzed must be standardized. Excel provides the STANDARDIZE 
function for just this purpose. STANDARDIZE takes three arguments: the data
point, the mean, and the standard deviation. The returned value is what the
data point value is when the mean is 0 and the standard deviation is 1.
An individual value from a nonstandard normal distribution is referred to as
x. An individual value from a standard normal distribution is referred to as z.
Figure 9-8:
Normal
distributions
come in
different
heights and
widths.
161
Chapter 9: Throwing Statistics a Curve

Figure 9-9 shows how the STANDARDIZE function changes raw values to 
standard values. The standard deviation of the raw data is 9.357842337, 
but the standard deviation of the standardized values is 1. The mean of the
standardized values is 0.
Column B in Figure 9-9 has a long list of 1,200 random values. The mean is
18.74111235, as seen in cell C2. The standard deviation is 9.357842337, as
seen in cell C3. For each data point in Column B, the standardized value is
displayed in Column E. The list of values in Column E are those returned with
the STANDARDIZE function. 
The STANDARDIZE function takes three arguments: 
 Data point 
 Mean of the distribution
 Standard deviation of the distribution
For example, this is the formula in cell E7: =STANDARDIZE(B7,C$2,C$3).
Note how a few key properties of the distribution have changed after the
values are standardized:
 The standard deviation is 1.
 The mean is 0.
 The standardized values fall within the range –3.9 to 3.9.
This third point is determined by using the MIN and MAX functions, respec-
tively, in cells H8 and H9. Having values fall in the range –3.9 to 3.9 allows the
values to be analyzed with the Areas Under the Standard Normal Curve table
mentioned earlier. That is, it’s a property of standard normal curves to have
all values fit into this range.
Figure 9-9:
Standard-
izing a
distribution
of data.
162
Part II: Counting on Your Money 

Here’s how to use the STANDARDIZE function:
1. Enter a list of numerical values into a column.
It makes sense if this list is a set of random observable data, such as
heights, weights, or amounts of monthly rainfall.
2. Calculate the mean and standard deviation.
See the section “Stuck in the Middle with AVERAGE, MEDIAN, and
MODE” to learn about the mean.
The STANDARDIZE function references these values. The mean is 
calculated with the AVERAGE function, and the standard deviation is 
calculated with the STDEV function.
3. Place the cursor in the cell adjacent to the first data point entered 
in Step 1.
4. Enter =STANDARDIZE( to start the function.
5. Click the cell that has the first data point.
6. Enter a comma (,).
7. Click the cell that has the mean.
8. Enter a comma (,).
9. Click the cell that has the standard deviation.
10. Enter a ) to end the function.
The formula with the STANDARDIZE function is now complete. However,
you must edit it to fix the references to the mean and standard devia-
tion. The references need to be made absolute so they won’t change
when the formula is dragged down to other cells.
11. Double-click the cell with the formula to enter the edit mode.
12. Precede the row part of the reference to the cell that contains the
mean with a dollar sign ($).
13. Precede the row part of the reference to the cell that contains the
standard deviation with a dollar sign ($).
14. Press the Enter key, the Tab key, or the Esc key to end the editing.
15. Use the fill handle to drag the formula down to the rest of the cells
that are adjacent to the source data points.
It’s important that the references to the mean and standard deviation are
treated as absolute references so they won’t change when the formula is
dragged to the other cells. Therefore, the formula should end up looking like
this: =STANDARDIZE(B7,C$2,C$3). Note the $ signs.
163
Chapter 9: Throwing Statistics a Curve

Skewed from the norm
There is deviation in a distribution, but who says the deviation has to be uni-
form with deviation the same on both sides of the mean? Not all distributions
are normal — some are skewed, with more values clustered either below the
mean or above it:
 When more values fall below the mean, the distribution is 
positively skewed.
 When more values fall above the mean, the distribution is 
negatively skewed.
The following minitable has a few examples:
Values
Mean
Comment
1, 2, 3, 4, 5
3
No skew. An even number of values 
fall above and below the mean.
1, 2, 3, 6, 8
4
The distribution is positively skewed. 
More values fall below the mean.
1, 2, 8, 9, 10
6
The distribution is negatively skewed. 
More values fall above the mean.
Figure 9-10 shows a distribution plot, where 1,000 values are in the distribu-
tion, ranging between 1 and 100. The values are summarized in a table of fre-
quencies (discussed later in this chapter). The table of frequencies is the
source of the chart.
The mean of the distribution is 50.945, shown in cell D17. Cells D19 and D20
show the number of values that fall above and below the mean. There are
more values above the mean than below. The distribution, therefore, is 
negatively skewed.
Figure 9-10:
Working
with
skewed
data.
164
Part II: Counting on Your Money 

The actual skew factor is –0.0850969. The formula in cell D22 is =SKEW
(A1:A1000). The chart makes it easy to see the amount of skew. The plot 
is leaning to the right.
Finding out the amount of skew in a distribution can help identify bias in 
the data. If, for example, the data is expected to fall into a normal (unskewed) 
distribution (such as a random sampling of height for 10-year-old children)
and the data is skewed, then you have to wonder if some bias got into the
data. Perhaps a number of 14-year-old children were measured by mistake
and those heights were mixed in with the data. Of course, being skewed 
is not itself an indication of bias. Some distributions are skewed by their 
very nature.
SKEW
Here’s how to use the SKEW function to determine the skewness of a 
distribution:
1. Enter a list of numerical values.
2. Position the cursor in the cell where you want the amount of skew 
to appear.
3. Enter =SKEW( to start the function.
4. Drag the pointer over the list, or enter the address of the range.
5. Enter a ).
KURT
Another way that a distribution can differ from the normal distribution is 
kurtosis. This is a measure of the peakedness or flatness of a distribution
compared with the normal distribution. It is also a measure of the size of the
curves’ tails. You determine kurtosis with the KURT function, which returns 
a positive value if the distribution is relatively peaked with small tails com-
pared with the normal distribution. A negative result means the distribution
is relatively flat with large tails.
Figure 9-11 shows the curves of two distributions. The one on the left has a
negative kurtosis of –0.2204 indicating a relatively flat distribution. The distri-
bution on the right is just about 0, which means the distribution is just about
normal. The value of –0.0102 is very close to 0. The uniformity of the curve’s
shape confirms this.
165
Chapter 9: Throwing Statistics a Curve

This is how to use the KURT function:
1. Enter a list of numerical values.
2. Position the cursor in the cell where you want kurtosis to appear.
3. Enter =KURT( to start the function.
4. Drag the pointer over the list, or enter the address of the range.
5. Enter a ).
Comparing data sets
At times you need to compare two sets of data to see how they relate to one
another. For example, how does the amount of snowfall affect the number of
customers entering a store? Does the money spent on advertising increase
the number of new customers? You answer these questions by determining
whether the two data sets are correlated.
Excel provides two functions for this task: COVAR and CORREL. Respectively,
these return the covariance and correlation coefficient results from compar-
ing two sets of data.
COVAR
The COVAR function takes two arrays as its arguments and returns a single
value. The value can be positive or negative. A positive value means that the
two arrays of data tend to move in the same direction: If data set A increases
(or decreases), then data set B also increases (or decreases). A negative
value means that the two data sets tend to move in opposite directions:
When A increases, B decreases, and vice versa. The covariance’s absolute
value reflects the strength of the relationship. 
When COVAR returns 0, there is no relationship between the two sets of data.
Figure 9-11:
Measuring
the kurtosis
of two
distributions.
166
Part II: Counting on Your Money 

Sales of bread will likely create sales of butter; they’re somewhat related. In
other words, the amount of butter a store sells is likely to follow the amount
of bread it sells — more bread, more butter:
Day
Loaves of Bread Sold
Tubs of Butter Sold
Monday
62
12
Tuesday
77
15
Wednesday
95
26
As bread sales increase, so do sales of butter. Therefore, sales of butter are
expected to have a positive relation to sales of bread. These items comple-
ment each other. In contrast, bread and muffins compete against each other.
As bread is purchased, the sales of muffins likely suffer because people will
eat one or the other. Without even using any function, you can conclude that
bread sales and butter sales move in the same direction and that bread sales
and muffin sales move in differing directions. But by how much?
Figure 9-12 shows an example that measures snowfall and the number of cus-
tomers coming into a store. Two covariance calculations are given — one for
snowfall between 0 and 3 inches, and one for snowfall between 0 and 8 inches.
In Figure 9-12, the first COVAR measures the similarity of the amount of snow-
fall with the number of customers, but just for 0 to 3 inches of snow. The for-
mula in cell G7 is =COVAR(B5:B8,D5:D8). The answer is –6.875. This means
that, as snowfall increases, the number of customers decreases. The two sets
of data go in opposite directions. As one goes up, the other goes down. This
is confirmed by the result being negative.
The formula in cell G12 is =COVAR(B5:B13,D5:D13). This examines all the
values of the data sets, inclusive of 0 to 8 inches of snow. The covariance 
is –47.7778. This, too, confirms that as snowfall increases, the number of 
customers decreases.
Figure 9-12:
Using
COVAR to
look for a
relationship
between
two data
sets.
167
Chapter 9: Throwing Statistics a Curve

However, note that the covariance of the first calculation, for 0 to 3 inches of
snow, is not as severe as the second calculation for 0 to 8 inches. When there
is just up to 3 inches of snow on the ground, some customers stay away —
but not that many. On the other hand, when there are 8 inches of snow, no
customers show up. The first covariance is comparably less than the second:
–6.875 versus –47.7778. The former number is closer to 0 — and tells you that
a few inches of snow don’t have much effect. The latter number is signifi-
cantly distanced from 0 — and, sure enough, when up to 8 inches of snow is
considered, customers stay home.
Here’s how to use the COVAR function:
1. Enter two lists of numbers.
The lists must be the same size.
2. Position the cursor in the cell where you want covariance to appear.
3. Enter =COVAR( to start the function.
4. Drag the pointer over the first list, or enter the address of the range.
5. Enter a comma (,).
6. Drag the pointer over the second list, or enter the address of the range.
7. Enter a ).
A problem with covariance is that, although it does produce a result, 
that result is dependent on the actual units of the data sets. The snowfall/
customer example returns a covariance figure of –47.7778. As you can see, this
number is somewhat based on the actual units, such as the customer counts.
CORREL 
The CORREL function works in the manner as COVAR, but the result is always
between –1 and 1. The result is, in effect, set to a standard. Then the result of
one correlation can be compared to another.
A negative result means there is an inverse correlation. As one set of data
goes up, the other goes down. The actual negative value tells to what degree
the inverse correlation is. A value of –1 means the two sets of data move per-
fectly in opposite directions. A value of –0.5, for example, means the two sets
move in somewhat opposite directions.
The CORREL function returns a value between –1 and 0. A positive value
means the two data sets move in the same direction. A negative value means
the two sets of data move in opposite directions. A value of 0 means there is
no relation between the sets of data. 
168
Part II: Counting on Your Money 

Figure 9-13 shows three correlation results. The correlations display how cus-
tomers reacted (as a percentage increase in sales) with regard to three types
of advertising. All three advertising campaigns show a positive correlation.
As more money is spent on advertising, customer responsiveness increases
(or at least doesn’t reverse its direction).
All three returned correlation values fall within the range of 0 to 1 and, there-
fore, are easy to compare with each other. The evidence is clear — direct
mail is not as efficient as magazine or radio advertising. Both the magazine
and radio advertising score high; the returned values are close to 1. However,
direct mail returns a correlation of 0.4472. A positive correlation does exist —
that is, direct-mail expenditures create an increase in customer responsive-
ness. But the correlation is not as strong as magazine or radio advertising.
The money spent on direct mail would be better spent elsewhere.
Here’s how to use the CORREL function:
1. Enter two lists of numbers.
The lists must be the same size.
2. Position the cursor in the cell where you want correlation to appear.
3. Enter =CORREL( to start the function.
4. Drag the pointer over the first list, or enter the address of the range.
5. Enter a comma (,).
6. Drag the pointer over the second list, or enter the address of the range.
7. Enter a ).
Figure 9-13:
Comparing
the 
results of
advertising
campaigns.
169
Chapter 9: Throwing Statistics a Curve

Analyzing Data with 
Percentiles and Bins
No, not with trash bins (although you may want to throw your data out at
times)! The term bins refers to analyzing data by determining how many data
points fall into specified ranges, or bins. Percentiles is a technique for analyz-
ing data by determining where values relate, percentage-wise, to the entire
data set. 
Imagine this: A pharmaceutical company is testing a new drug to lower cho-
lesterol. The data is 500 cholesterol readings from the people in the sample.
In Figure 9-14, the 500 cholesterol readings are in Column A. Of interest is
how the data breaks up with regard to the 25 percent, the 50 percent, and the
75 percent marks. That is, what cholesterol reading is greater than 25 percent
of the data (and therefore smaller than 75 percent of the data)? What value is
at the 50 percent position? These measures are called quartiles because they
divide the sample into four quarters.
QUARTILE 
The QUARTILE function is designed specifically for this kind of analysis. The
function takes two arguments: One is the range of the sample data, and the
other indicates which quartile to return. The second argument can be a 0, 1,
2, 3, or 4:
Formula
Result
=QUARTILE(A4:A503,0)
Minimum value in the data
=QUARTILE(A4:A503,1)
Value at the 25th percentile
=QUARTILE(A4:A503,2)
Value at the 50th percentile
=QUARTILE(A4:A503,3)
Value at the 75th percentile
=QUARTILE(A4:A503,4)
Maximum value in the data
Figure 9-14:
Finding out
values at
quarter
percentiles.
170
Part II: Counting on Your Money 

QUARTILE works on ordered data, but you don’t have to do the sorting; the
function takes care of that. In Figure 9-14, the quartiles have been calculated.
The minimum and maximum values have been returned by using a 0 and a 4,
respectively, as the second argument.
Here’s how to use the QUARTILE function:
1. Enter a list of numerical values.
2. Position the cursor in the cell where you want a particular quartile 
to appear.
3. Enter =QUARTILE( to start the function.
4. Drag the pointer over the list, or enter the address of the range.
5. Enter a comma (,).
6. Enter a value between 0 and 4 for the second argument.
7. Enter a ).
PERCENTILE 
The PERCENTILE function is similar to QUARTILE except you can specify
which percentile to use when returning a value. You aren’t locked into fixed
percentiles such as 25, 50, or 75.
PERCENTILE takes two arguments:
 Range of the sample 
 Value between 0 and 1 
The value tells the function which percentile to use. For example, 0.1 is the
10th percentile, 0.2 is the 20th percentile, and so on.
Use the QUARTILE function to analyze data at the fixed 25th, 50th, and 75th
percentiles. Use the PERCENTILE function to analyze data at any desired 
percentile.
Figure 9-15 shows a sample of test scores. Who scored at or above the 90th
percentile? The highest-scoring students deserve some recognition. Bear in
mind that scoring at the 90th percentile is not the same as getting a score of
90. Values at or above the 90th percentile are those that are in the top 10 per-
cent of whatever scores are in the sample.
171
Chapter 9: Throwing Statistics a Curve

It so happens that the score that is positioned at the 90th percentile is 80.
Cell F4 has the formula =PERCENTILE(B3:B27,0.9), which uses 0.9 as the
second argument.
The cells in C3:C27 all have a formula that tests whether the cell to the left, in
column B, is at or greater than the 90th percentile. For example, cell C3 has
this formula: =IF(B3>=PERCENTILE(B$3:B$27,0.9),”A winner!”,””).
If the value in cell B3 is equal to or greater than the value at the 90th per-
centile, then cell C3 displays the text “A winner!”. The value in cell B3 is
59, which doesn’t make for a winner. On the other hand, the value in cell B5 
is greater than 80, so cell C5 displays the message.
Here’s how to use the PERCENTILE function:
1. Enter a list of numerical values.
2. Position the cursor in the cell where you want the result to appear.
3. Enter =PERCENTILE( to start the function.
4. Drag the pointer over the list, or enter the address of the range.
5. Enter a comma (,).
6. Enter a value between 0 and 1 for the second argument.
This tells the function what percentile to seek.
7. Enter a ).
Figure 9-15:
Using
PERCENTILE
to find high
scorers.
172
Part II: Counting on Your Money 

RANK 
The RANK function tells you the rank of a particular number, in other words
where the value is positioned, within a distribution. In a sample of ten values,
for example, a number could be the smallest (rank = 1), the largest (rank =
10), or somewhere in between. The function takes three arguments:
 The number being tested for rank: If this number isn’t found in the
data, an error is returned.
 The range to look in: A reference to a range of cells goes here.
 A 0 or a 1, telling the function how to sort the distribution: A 0 (or if the
argument is omitted) tells the function to sort the values in descending
order. A 1 tells the function to sort in ascending order. The order of the
sort makes a difference in how the result in interpreted. Is the value in
question being compared to the top value of the data or the bottom value?
Figure 9-16 displays a list of employees and the bonuses they earned. Say
you’re the employee who earned $4,800. You want to know where you rank 
in the range of bonus payouts. Cell F4 contains a formula with the RANK func-
tion: =RANK(C9,C3:C20). The function returns an answer of 4. Note that the
function was entered without the third argument. This tells the function to
sort the distribution descending in determining where the value is positioned.
This makes sense for determining how close to the top of the range a value is.
Follow these steps to use the RANK function:
1. Enter a list of numerical values.
2. Position the cursor in the cell where you want the result to appear.
3. Enter =RANK( to start the function.
Figure 9-16:
Determining
the rank of 
a value.
173
Chapter 9: Throwing Statistics a Curve

4. Click the cell that has the value you want to find the rank for, or 
enter its address.
You can also just enter the actual value.
5. Enter a comma (,).
6. Drag the pointer over the list of values, or enter the address of 
the range.
7. If you want to have the number evaluated against the list in ascend-
ing order, enter a comma (,) and then enter a 1.
Descending order is the default and doesn’t require an argument to 
be entered.
8. Enter a ).
PERCENTRANK 
The PERCENTRANK formula also returns the rank of a value but tells you
where the value is as a percentage. In other words, PERCENTRANK may 
tell you that a value is positioned 20 percent into the ordered distribution.
PERCENTRANK takes three arguments:
 The range of the sample.
 The number being evaluated against the sample.
 An indicator of how many decimal points to use in the returned answer.
(This is an optional argument. If left out, three decimal points are used.)
In Figure 9-16, the percent rank of the $4,800 value is calculated to be 82.3
percent (0.823). Therefore, $4,800 ranks at the 82.3 percent position in the
sample. The formula in cell F8 is =PERCENTRANK(C3:C20,C9).
In the RANK function, the value being evaluated is the first argument, and the
range of the values is the second argument. In the PERCENTRANK function,
the order of these arguments is reversed.
Follow these steps to use the PERCENTRANK function:
1. Enter a list of numerical values.
2. Position the cursor in the cell where you want the result to appear.
3. Enter =PERCENTRANK( to start the function.
174
Part II: Counting on Your Money 

4. Drag the pointer over the list of values, or enter the address of 
the range.
5. Enter a comma (,).
6. Click the cell that has the value you want to find the rank for, or 
enter its address.
You can also just enter the actual value.
7. If you want to have more or less than three decimal points returned 
in the result, enter a comma (,) and then enter the number of desired
decimal points.
8. Enter a closing parenthesis to end the function.
FREQUENCY 
The FREQUENCY function places the count of values in a sample into bins.
A bin represents a range of values such as 0–1 or 20–29. Typically, the bins
used in an analysis are the same size and cover the entire range of values. For
example, if the data values range from 1–100, you might create ten bins each
ten units wide. The first bin would be for values of 1 to 10, the second bin
would be for values of 11 to 20, and so forth.
Figure 9-17 illustrates this. There are 300 values in the range B3:B304. The
values are random, between 1 and 100. Cells D3 through D12 have been set as
bins that each cover a range of ten values. Note that, for each bin, its number
is the top of the range it’s used for. For example, the 30 bin is used for holding
the count of how many values fall between 21 and 30.
A bin holds the count of values within a numeric range — the number of
values that fall into the range. The bin’s number is the top of its range.
Figure 9-17:
Setting up
bins to use
with the
FREQUENCY
function.
175
Chapter 9: Throwing Statistics a Curve

FREQUENCY is an array function and requires specific steps to be used 
correctly. Here is how it’s done:
1. Enter a list of values.
This can be a lengthy list and likely represents some observed data,
such as the age of people using the library or the number of miles driven
on the job. Obviously, you can use many types of observable data.
2. Determine the high and low values of the data.
You can use the MAX and MIN functions for this.
3. Determine what your bins should be.
This is subjective. For example, if the data has values from 1 to 100, you
can use 10 bins that each cover a range of 10 values. Or you can use 20
bins that each cover a range of 5 values. Or you can use 5 bins that each
cover a range of 20 values.
4. Create a list of the bins by entering the high number of each bin’s
range, as shown in cells D3:D12 in Figure 9-17.
5. Click the first cell where you want the output of FREQUENCY to 
be displayed.
6. Drag down to select the rest of the cells.
There should now be a range of selected cells. The size of this range
should match the number of bins. Figure 9-18 shows what the worksheet
should look like at this step.
7. Enter =FREQUENCY( to start the function.
8. Drag the cursor over the sample data, or enter the address of 
the range.
Figure 9-18:
Preparing to
enter the
FREQUENCY
function.
176
Part II: Counting on Your Money 

9. Enter a comma (,).
10. Drag the cursor over the list of bins, or enter the address of that range.
Figure 9-19 shows what the worksheet should look like at this point.
11. Enter a ).
Do not press Enter.
12. Press Ctrl + Shift + Enter at the same time to end the function entry.
Hurray, you did it! You have entered an array function. All the cells in the
range where FREQUENCY was entered have the same exact formula. The
returned values in these cells are the count of values from the raw data that
falls within the bins. This is called a frequency distribution.
Next, take this distribution and plot a curve from it:
1. Select the Count of Values Per Bin range data. 
That’s E5:E12 in this example.
2. Click the Insert tab at the top of the Excel screen.
3. In the Charts section, click the Column Chart item to display a 
selection of column chart styles. 
See Figure 9-20.
4. Select the desired chart style to create the chart.
Figure 9-21 shows the completed frequency distribution chart. 
A frequency distribution is also known as a histogram.
Figure 9-19:
Completing
the entry 
of the
FREQUENCY
function.
177
Chapter 9: Throwing Statistics a Curve

MIN and MAX 
Excel has two functions — MIN and MAX — that return the lowest and high-
est values in a set of data. These functions are simple to use. The functions
take up to 255 arguments, which can be cells, ranges, or values.
Figure 9-22 shows a list of home sales. What are the highest and lowest
values? Cell F4 displays the lowest price in the list of sales, with this formula:
=MIN(C4:C1000). Cell F6 displays the highest price with this formula: =MAX
(C4:C1000).
Figure 9-21:
Displaying a
frequency
distribution
as a column
chart.
Figure 9-20:
Preparing to
plot the
frequency
distribution.
178
Part II: Counting on Your Money 

Here’s how to use the MIN or MAX function:
1. Enter a list of numerical values.
2. Position the cursor in the cell where you want the result to appear.
3. Enter either =MIN( or =MAX( to start the function.
4. Drag the pointer over the list, or enter the address of the range.
5. Enter a ).
MIN and MAX return the upper and lower values of the data. What if you need
to know the value of the second highest price? Or the third?
LARGE and SMALL 
The LARGE and SMALL functions let you find out a value that is positioned at
a certain point in the data. LARGE is used to find the value at a position that
is offset from the highest value. SMALL is used to find the value at a position
that is offset from the lowest value.
Figure 9-22 displays the top five home sales, as well as the bottom five. Both
the LARGE and SMALL functions take two arguments: the range of the data in
which to find the value, and the position relative to the top or bottom.
The top five home sales are found by using LARGE. The highest sale, in cell
F10, is returned with this formula: =LARGE(C$4:C$1000,1). Because the
function used here is LARGE, and the second argument is 1, the function
returns the value at the first position. By no coincidence, this value is also
returned by the MAX function.
To find the second highest home sales, a 2 is entered as the second argument
to LARGE. Cell F11 has this formula: =LARGE(C$4:C$1000,2). The third,
Figure 9-22:
Finding high
and low
values.
179
Chapter 9: Throwing Statistics a Curve

fourth, and fifth largest home sales are returned in the same fashion, respec-
tively, using 3, 4, and 5 as the second argument.
The bottom five sales are returned in the same fashion but by using the SMALL
function. For example, cell F22 has this formula: =SMALL(C$4:C$1000,1).
The returned value, $148,300, matches the value returned with the MIN func-
tion. The cell just above it, F21, has this formula: =SMALL(C$4:C$1000,2).
Hey, wait! You may have noticed that the functions are looking down to row
1000 for values, but the bottom listing is numbered as 60. An interesting thing
to note in this example is that all the functions use row 1000 as the bottom
row to look in, but this doesn’t mean there are that many listings. This in
intentional. There are only 60 listings, for now. What happens when new sales
are added to the bottom of the list? By giving the functions a considerably
larger range than needed, we’ve built in the ability to handle a growing list.
It’s interesting to see how the labels were created with regard to this.
The labels in cells E10:E14 (#1, #2, and so on) are just entered as is. Clearly, any
ranking that starts from the top would begin with #1, proceed to #2, and so on.
However, the labels in cells E18:E22 (#56, #57, and so on) were created with
formulas. The COUNT function is used to count the total number of listings.
Even though the function looks down to row 1000, it only finds 60 listings, so
that is the returned count. The #60 label is based on this count. The other
labels (#59, #58, #57, and #56) are created by reducing the count by 1, 2, 3,
and 4, respectively:
 The formula in cell E22 is =”# “ & COUNT(C$4:C$1000).
 The formula in cell E21 is =”# “ & COUNT(C$4:C$1000)-1.
 The formula in cell E20 is =”# “ & COUNT(C$4:C$1000)-2.
 The formula in cell E19 is =”# “ & COUNT(C$4:C$1000)-3.
 The formula in cell E18 is =”# “ & COUNT(C$4:C$1000)-4.
Here’s how to use the LARGE or SMALL function:
1. Enter a list of numerical values.
2. Position the cursor in the cell where you want the result to appear.
3. Enter either =LARGE( or =SMALL( to start the function.
4. Drag the pointer over the list, or enter the address of the range.
5. Enter a ).
Use LARGE to find a value’s position relative to the highest value. Use SMALL
to find a value’s position relative to the smallest value.
180
Part II: Counting on Your Money 

Going for the Count
The COUNT and COUNTIF functions return, well, a count. What else could it
be with a name like that?
COUNT 
COUNT is straightforward. It counts how many items are in a range of values.
There is a catch, though: Only numeric values and dates are counted. Text
values are not counted, nor are blank cells.
COUNTA works the same as COUNT, but it counts all cells that are not empty,
including text cells.
To use the COUNT function:
1. Enter a list of numerical values.
2. Position the cursor in the cell where you want the result to appear.
3. Enter =COUNT( to start the function.
4. Drag the pointer over the list, or enter the address of the range.
5. Enter a ).
Figure 9-23 shows a list of popular movies along with the sales figure and the
year for each movie. Cell F4 displays the count of movies, returned with the
COUNT function. The formula in cell F4 is =COUNT(C4:C460).
Note that the range entered in the function looks at the years the movies
were made. This is intentional. A year is a numeric value. If COUNT used the
range of movie titles, in Column A, the count would be 0 because this column
contains text data.
Figure 9-23:
Counting
with and
without
criteria.
181
Chapter 9: Throwing Statistics a Curve

COUNTIF 
The COUNTIF function is handy when you need to count how many items are
in a list that meet a certain condition. In Figure 9-23, cell F6 shows the count of
movies made in 1998. The formula in cell F6 is =COUNTIF(C4:C309,1998).
The COUNTIF function takes two arguments. 
 The range address of the list to be counted
 The criterion
Table 9-1 presents some example of criteria for the COUNTIF function.
Table 9-1
Using Criteria with the COUNTIF Function
Example
Comment
=COUNTIF(C4:C309,”=1998”)
Returns the count of movies made 
in 1998.
=COUNTIF(C4:C309,1998)
Returns the count of movies made in
1998. Note that this is unique in that the
criteria do not need to be in double
quotes. This is because the criterion is
a simple equality.
=COUNTIF(C4:C309,”<1998”)
Returns the count of movies made
before 1998.
=COUNTIF(C4:C309,”>=1998”)
Returns the count of movies made in or
after 1998.
=COUNTIF(C4:C309,”<>1998”)
Returns the count of movies not made 
in 1998.
The criteria can also be based on text. For example, COUNTIF can count all
occurrences of Detroit in a list of business trips. You can use wildcards with
COUNTIF. The asterisk (*) is used to represent any number of characters, and
the question mark (?) is used to represent a single character.
As an example, using an asterisk after Batman returns the number of Batman
movies found in Column A in Figure 9-23. A formula to do this looks like this:
=COUNTIF(A4:A309,”Batman*”). Notice the asterisk after Batman. This
lets the function count Batman and Robin, Batman Returns, and Batman
Forever, along with just Batman.
182
Part II: Counting on Your Money 

Your criterion can be entered in a cell rather than directly in the COUNTIF
function. Then just use the cell address in the function. For example, if you
enter “Batman*” in cell C5, then =COUNTIF(A4:A309,C5) would have the
same result as the previous example. Cell F8 in Figure 9-23 returns the count
of movies that have earned over $200,000,000. The formula is
=COUNTIF(B4:B309,”>200000000”). 
What if you need to determine the count of data items that match two condi-
tions? Can do! The formula in cell F12 returns the count of movies that were
made in 1998 and earned $200,000,000 or more. However, COUNTIF is not
useful for this type of multiple condition count. Instead, the SUMPRODUCT
function is used. The formula in cell F12 follows:
=SUMPRODUCT((B4:B309>200000000)*(C4:C309=1998))
Believe it or not, this works. Although this formula looks like it’s multiplying
the number of movies that earned at least $200,000,000 by the number of
movies made in 1998, it’s really returning the count of movies that meet 
the two conditions. (Quick trivia: Which two 1998 movies earned at least
$200,000,000? The answer [drum roll, please]: Armageddon and Saving 
Private Ryan.)
To use the COUNTIF function, follow along:
1. Enter a list of numerical values.
2. Position the cursor in the cell where you want the result to appear.
3. Enter =COUNTIF( to start the function.
4. Drag the pointer over the list, or enter the address of the range.
5. Enter a comma (,).
6. Enter a condition and enclose the condition in double quotes.
Use the following as needed:
• = (equal to)
• > (greater than)
• < (less than)
• * (wildcard)
• ? (wildcard) 
• <> (not equal to)
7. Enter a ).
The result is a count of cells that match the condition.
183
Chapter 9: Throwing Statistics a Curve

184
Part II: Counting on Your Money 

Chapter 10
Using Significance Tests
In This Chapter
 Understanding estimation statistics
 Using the Student t-distribution test functions
 Analyzing probabilities and results with the Chi Square functions
W
hen you have data from a population, you can draw a sample and run
your statistical analysis on the sample. You can also run the analysis
on the population itself. Is the mean of the sample data the same as the mean
of the whole population? You can calculate the mean of both the sample and
the population and then know precisely how well the sample represents the
population. Are the two means exact? Off a little bit? How much different?
The problem with this though is that getting the data of the entire population
in the first place isn’t always feasible. On average, how many miles per gallon
does a Toyota Camry get after five years on the road? You cannot answer 
this question to an exact degree because it’s impossible to test every Camry
out there.
So instead we infer the answer. Testing a handful, or sample, of Camrys is cer-
tainly possible. Then the mean gas mileage of the sample is used to represent
the mean gas mileage of all 5-year-old Camrys. The mean of the sample group
will not necessarily match the mean of the population, but it is the best value
that can be attained.
This type of statistical work is known as estimation, or inferential statistics. In
this chapter, we show you the functions that work with the Student t-distribu-
tion, useful for gaining insight into the unknown population properties. This is
the method of choice when using a small sample, say 30 data points or less.
The tests presented in this chapter deal with probabilities. If the result of a
test — a t-test, for example — falls within a certain probability range, then
the result is said to be significant. Outside that range, the result is considered
nonsignificant. A common rule of thumb is to consider probabilities less than
5 percent, or 0.05, to be significant, but exceptions to this rule exist.

The Student t-distribution has nothing to do with students. The originator of
the method was not allowed to use his real name due to his employer’s rules.
Instead, he used the name Student.
Testing to the T
The TTEST function returns the probability that two samples come from 
populations that have the same mean. For example, a comparison of the
salaries of accountants and professors in New York City is underway. Are the
salaries, overall (on average), the same for these two groups? Each group is a
separate population, but if the means are the same, then the average salaries
are the same.
Polling all the accountants and professors isn’t possible, so a sample of each
is taken. Twenty-five random members of each group divulge their salary in
the interest of the comparison. Figure 10-1 shows the salaries of the two
groups, as well as the results of the TTEST function.
Student t-testing is generally used when the sample size is 30 items or fewer.
The TTEST function returns 73.3 percent (0.732954) based on how the argu-
ments to the function were entered. This percentage says there is a 73.3 per-
cent probability that the mean of the underlying populations are the same.
Said another way, this is the likelihood that the mean of all accountant
salaries in New York City matches the mean of all professor salaries in New
York City. The formula in cell E8 is =TTEST(A3:A27,B3:B27,2,2).
Figure 10-1:
Comparing
salaries.
186
Part II: Counting on Your Money 

The arguments of the TTEST function are listed in Table 10-1.
Table 10-1
Arguments of the TTEST Function
Argument
Comment
Array 1
This is the reference to the range of the first array of data.
Array 2
This is the reference to the range of the second array of data.
Tails
Either a 1 or 2. For a one-tailed test, enter a 1. For a 2-tailed test,
enter a 2.
Type
Type of t-test to perform. The choice is a 1, 2, or 3. A number 1
indicates a paired test. A number 2 indicates a two-sample test
with equal variance. A number 3 indicates a two-sample test
with unequal variance.
The third argument of TTEST tells whether to conduct a one-tailed or two-
tailed test. A one-tailed test is used when there is a question of whether one
set of data is specifically larger or smaller than the other. A two-tailed test is
used to tell whether the two sets are just different from each other without
specifying larger or smaller.
The first two arguments to TTEST are the ranges of the two sets of values. A
pertinent consideration here is how the two sets of data are related. The sets
could be comprised of elements that have a corresponding member in each
set. For example, there could be a set of “before” data and a set of “after”
data.
Seedling
Height at Week 1
Height at Week 2
#1
4 inches
5 inches
#2
33⁄4 inches
5 inches
#3
41⁄2 inches
51⁄2 inches
#4
5 inches
5 inches
This type of data is entered into the function as paired. In other words, each
data value in the first sample is linked to a data value in the second sample.
In this case, the link is due to the fact that the data values are “before” and
“after” measurements from the same seedlings. Data can be paired in other
ways. In the salary survey, for example, each accountant may be paired with
a professor of the same age to ensure that length of time on the job does not
affect the results — in this case, you would also use a paired t-test.
187
Chapter 10: Using Significance Tests

When you’re using TTEST for paired samples, the two ranges entered for the
first and second arguments must be the same size. When you’re comparing
two independent (unpaired) samples, the two samples don’t have to be the
same size, although they happen to be the same size in the figure.
Use TTEST to determine the probability that two samples come from the
same population.
Here’s how to use the TTEST function:
1. Enter two sets of data.
2. Position the cursor in the cell where you want the result to appear.
3. Enter =TTEST( to start the function.
4. Drag the pointer over the first list, or enter the address of its range.
5. Enter a comma (,).
6. Drag the pointer over the second list, or enter the address of its range.
7. Enter a comma (,).
8. Enter a 1 for a one-tailed test, or enter a 2 for a two-tailed test.
9. Enter a comma (,).
10. Enter one of the following:
• 1 for a for a paired test
• 2 for a test of two samples with equal variance
• 3 for a test of two samples with unequal variance
11. Enter a ).
If you ever took a statistics course, you may recall that a t-test returns a 
t-value, which you then had to look up in a table to determine the associated
probability. Excel’s TTEST function combines these two steps. It calculates
the t-value internally and determines the probability. You never see the actual
t-value, just the probability — which is what you’re interested in anyway!
The TDIST function returns the probability for a given t-value and degrees 
of freedom. You would use this function if you had a calculated t-value and
wanted to determine the associated probability. Note that the TTEST function
doesn’t return a t-value but rather a probability, so you wouldn’t use TDIST
with the result that is returned by TTEST. Instead, you would use TDIST if you
had one or more t-values calculated elsewhere and needed to determine the
associated probabilities.
188
Part II: Counting on Your Money 

TDIST takes three arguments:
 The t-value
 The degrees of freedom
 The number of tails (1 or 2)
A t-distribution is similar to a normal distribution. The plotted shape is a bell
curve. However a t-distribution differs particularly in the thickness of the
tails. How much so is dependent on the degrees of freedom. The degrees of
freedom roughly relate to the number of elements in the sample, less one. 
All t-distributions are symmetrical around 0, as is the normal distribution. 
In practice, however, you always work with the right half of the curve — 
positive t-values.
To use the TDIST function, follow along:
1. Position the cursor in the cell where you want the result to appear.
2. Enter =TDIST( to start the function.
3. Enter a value for t, or click a cell that has the value.
4. Enter a comma (,).
5. Enter the degrees of freedom.
6. Enter a comma (,).
7. Enter one of the following:
• 1 for a one-tailed test
• 2 for a two-tailed test
8. Enter a ).
If the t-value is based on a paired test, then the degrees of freedom is equal to
1 less than the count of items in either sample (remember, the samples are
the same size). When the t-value is based on two independent samples, then
the degrees of freedom = (count of sample-1 items – 1) + (count of sample-2
items – 1).
The TINV function produces the inverse of TDIST. That is, TINV takes two
arguments — the probability and the degrees of freedom — and returns the
value of t. To use TINV, follow along:
1. Position the cursor in the cell where you want the result to appear.
2. Enter =TINV( to start the function.
189
Chapter 10: Using Significance Tests

3. Enter the probability value (or click on a cell that has the value).
4. Enter a comma (,).
5. Enter the degrees of freedom.
6. Enter a ).
Comparing Results to an Estimate
The Chi Square test is a statistical method for determining whether observed
results are within an acceptable range compared with what the results were
expected to be. In other words, the Chi Square is a test of how well a before
and after compare. Did the observed results come close enough to the
expected results that we can safely assume there is no real difference? Or
were the observed and expected results far enough apart that we must 
conclude there is a real difference?
A good example is flipping a coin 100 times. The expected outcome is 50
times heads, 50 times tails. Figure 10-2 shows how a Chi Square test statistic
is calculated in a worksheet without using any functions.
Cells B5:B6 are the expected results — that heads and tails will each show up
50 times. Cells C5:C6 show the observed results. Heads appeared 44 times,
and tails appeared 56 times. With this information, here is how the Chi
Square test statistic is calculated:
1. For each expected and observed pair, calculate the difference as
(Expected – Observed).
2. Calculate the square of each difference as (Expected – Observed)2.
3. Divide the squares from the previous step by their respective
expected values.
4. Sum the results of the previous step.
Figure 10-2:
Calculating
a Chi
Square.
190
Part II: Counting on Your Money 

Of course, a comprehensive equation can be used for the first three steps,
such as =(expected - observed)^2/expected.
The result in this example is 1.44. This number — the Chi Square value — is
then looked up in a table of Chi Square distribution values. This table is a
matrix of degrees of freedom and confidence levels. Seeing where the calcu-
lated value is positioned in the table for the appropriate degrees of freedom
(one less than the number of data points) will show you the probability that
the difference between the expected and observed values is significant. That
is, is the difference within a reasonable error of estimation or is it real (for
example, caused by an unbalanced coin)?
The table of degrees of freedom and confidence levels is often found in the
appendix of a statistics book or can be found on the Internet.
The CHITEST function returns the probability value (p) derived from the
expected and observed ranges. There are two arguments to the function: the
range of observed (or actual) values, and the range of expected values. These
ranges must, of course, contain the same number of values, and they must be
matched (first item in the expected list is associated with the first item in the
observed list, and so on). Internally, the function takes the degrees of freedom
into account, calculates the Chi Square statistic value, and computes the
probability.
Use the CHITEST function this way:
1. Enter two ranges of values as expected and observed results.
2. Position the cursor in the cell where you want the result to appear.
3. Enter =CHITEST( to start the function.
4. Drag the cursor over the range of observed (actual) values, or enter
the address of the range.
5. Enter a comma (,).
6. Drag the cursor over the range of expected values, or enter the
address of the range.
7. Enter a ).
Figure 10-3 shows a data set of expected and actual values. The Chi Square
test statistic is calculated as before, delivering a value of 1.594017, seen in
cell F12. The CHITEST function, in cell D16, returns a value of 0.953006566,
the associated probability. Remember that CHITEST doesn’t return the Chi
Square statistic but rather the associated probability.
191
Chapter 10: Using Significance Tests

Now tie in a relationship between the manually calculated Chi Square and 
the value returned with CHITEST. If you looked up your manually calculated
Chi Square value (1.59) in a Chi Square table for degrees of freedom of 6 (one
less than the number of observations), you would find it associated with a
probability value of 0.95. Of course, the CHITEST function does this for you,
returning the probability value, which is what you’re after. But suppose
you’ve manually calculated Chi Square values and want to know the associ-
ated probabilities. Do you have to use a table? Nope — the CHIDIST function
comes to the rescue. And furthermore, if you have a probability and want to
know the associated Chi Square value, you can use the CHIINV function.
Figure 10-3 demonstrates the CHIDIST and CHIINV functions as well. CHIDIST
takes two arguments: a value to be evaluated for a distribution (the Chi
Square value, 1.59 in our example), and the degrees of freedom (6 in the
example). Cell D18 displays 0.953006566, which is the same probability value
returned by the CHITEST function — just as it should be! The formula in cell
D18 is =CHIDIST(F12,6).
CHITEST and CHIDIST both return the same probability value but calculate
the result with different arguments. CHITEST uses the actual expected and
observed values and internally calculates the test statistic to return the 
probability. This is done behind the scenes — just the probability is returned.
CHIDIST needs the test statistic fed in as an argument.
To use the CHIDIST function:
1. Position the cursor in the cell where you want the result to appear.
2. Enter =CHIDIST( to start the function.
3. Click the cell that has the Chi Square test statistic.
4. Enter a comma (,).
5. Enter the degrees of freedom.
6. Enter a ).
Figure 10-3:
Determining
probability.
192
Part II: Counting on Your Money 

The CHIINV function rounds out the list of Chi Square functions in Excel.
CHIINV is the inverse of CHIDIST. That is, with a given probability and degrees
of freedom number, CHINV returns the Chi Square test statistic.
Cell D20 in Figure 10-3 has the formula =CHIINV(D16,6). This returns the
value of the Chi Square: 1.594017094. CHIINV is useful then when you know
the probability and degrees of freedom and need to determine the Chi Square
test statistic value.
To use the CHIINV function, follow these steps:
1. Position the cursor in the cell where you want the result to appear.
2. Enter =CHIINV( to start the function.
3. Click the cell that has the probability.
4. Enter a comma (,).
5. Enter the degrees of freedom.
6. Enter a ).
Working with inferential statistics is difficult! We suggest further reading to
help with the functions and statistical examples discussed in this chapter. A
great book to read is Statistics For Dummies by Deborah Rumsey (Wiley).
193
Chapter 10: Using Significance Tests

194
Part II: Counting on Your Money 

Part III
Doing the Math

In this part . . .
E
xcel is a math-loving, number-crunching, lean, mean
software machine. And Part III shows just how much
this is true! Basic math? No sweat. How about combina-
tions, permutations, subtotals, and summing condition-
based values? Hey, now you are talking some cool math.
Ever try to work your way through a book on statistics?
Boring! Part III does it better. We show you how to use the
statistical functions with examples –– right to the point.
Discover how a couple of these work and impress the
boss. You can even use an Excel statistical function to 
calculate the probability of a getting a raise!

Chapter 11
Rolling the Dice on Predictions
and Probability 
In This Chapter
 Understanding linear and exponential trends
 Predicting future data from existing data
 Working with normal and Poisson distributions
W
hen analyzing data, one of the most important steps is usually to
determine what model fits the data. No, we aren’t talking about a
model car or model plane! This is a mathematical model or, put another way,
a formula that describes the data. The question of a model is applicable for
all data that comes in X-Y pairs, such as the following:
 Comparisons of weight and height measurements
 Data on salary versus educational level
 Number of fish feeding in a river by time of day
 Number of employees calling in sick as related to day of the week
Modeling
Suppose now that you plot all the data points on a chart — a scatter chart in
Excel terminology. What does the pattern look like? If the data is linear, they’ll
fall more or less along a straight line. If they fall along a curve rather than a
straight line, they aren’t linear and are likely to be exponential. These two
models — linear and exponential — are the two most commonly used
models, and Excel provides you with functions to work with them.

Linear model 
In a linear model, the mathematical formula that models the data is as follows:
Y = mX + b
This tells you that for any X value, you calculate the Y value by multiplying X
by a constant m, and then adding another constant b. The value m is called
the line’s slope and b is the Y intercept (the value of Y when X = 0). This for-
mula gives a perfectly straight line, and real-world data doesn’t fall right on
such a line. The point is that the line, called the linear regression line, is the
best fit for the data. The constants m and b are different for each data set.
Exponential model 
In an exponential model, the following formula models the data:
Y = bmX
The values b and m are, again, constants. Many natural processes, including
bacterial growth and temperature change, are modeled by exponential
curves. Figure 11-1 shows an example of an exponential curve. This curve 
is the result of the preceding formula when b = 2 and m = 1.03. 
Again, b and m are constants that are different for each data set.
Figure 11-1:
An
exponential
curve.
198
Part III: Doing the Math 

Getting It Straight: Using SLOPE and
INTERCEPT to Describe Linear Data
As we discuss earlier, many data sets can be modeled by a straight line — in
other words, the data is linear. The line that models the data, known as the
linear regression line, is characterized by its slope and its Y intercept. Excel
provides the SLOPE and INTERCEPT functions to calculate the slope and Y
intercept of the linear regression line for a set of data pairs.
The SLOPE and INTERCEPT functions both take the same two arguments:
 The first argument is a range or array containing the Y values of the 
data set.
 The second argument is a range or array containing the X values of the
data set.
The two ranges must contain the same number of values; otherwise, an error
occurs. Follow these steps to use either of these functions:
1. In a blank worksheet cell, enter =SLOPE( or =INTERCEPT( to start the
function entry.
2. Drag the mouse over the range containing the Y data values, or enter
the range address.
3. Enter a comma (,).
4. Drag the mouse over the range containing the X data values, or enter
the range address.
5. Type a ) and press Enter.
When you know the slope and Y intercept of a linear regression line, you can
calculate predicted values of Y for any X using the formula Y = mX + b where
m is the slope and b is the Y intercept. But Excel’s FORECAST and TREND
functions can do this for you.
Knowing the slope and intercept of a linear regression line is one thing, but
what can you do with this information? One very useful thing is to actually
draw the linear regression line along with the data points. This method of
graphical presentation is commonly used; it lets the viewer see how well the
data fits the model.
199
Chapter 11: Rolling the Dice on Predictions and Probability

To see how this is done, look at the worksheet in Figure 11-2. Columns A and
B contain the X and Y data, and the chart shows a scatter plot of this data. It
seems clear that the data is linear and that you can validly use SLOPE and
INTERCEPT with them. The first step is to put these functions in the work-
sheet as follows. You can use any worksheet that has linear X-Y data in it.
1. Enter the label Slope in an empty cell.
2. In the cell to the right, enter =SLOPE( to start the function entry.
3. Drag over the range containing the Y data values, or enter the 
range address.
4. Enter a comma (,).
5. Drag the mouse over the range containing the X data values, or 
enter the range address.
6. Enter a ).
7. Press Enter to complete the formula.
8. In the cell below the slope label, enter the label Intercept.
9. In the cell to the right, enter =Intercept(.
10. Drag over the range containing the Y data values, or enter the 
range address.
11. Enter a comma (,).
12. Drag the mouse over the range containing the X data values, or 
enter the range address.
13. Type a ) and press Enter to complete the formula.
Figure 11-2:
The scatter
plot
indicates
that the X
and Y data
in this
worksheet
are linear.
200
Part III: Doing the Math 

At this point, the worksheet displays the slope and intercept of the linear
regression line for your data. The next task is to display this line on the chart:
1. If necessary, add a new, empty column to the worksheet to the right of
the Y value column.
Do this by clicking any cell in the column immediately to the right of the
Y value column, and then, on the Home ribbon, clicking the Insert
button and selecting Insert Sheet Columns.
2. Place the cursor in this column in the same row as the first X value.
3. Enter an equal sign (=) to start a formula.
4. Click the cell where the SLOPE function is located to enter its address
in the formula.
5. Press F4 to convert the address to an absolute reference. 
It displays with dollar signs.
6. Enter the multiplication symbol (*).
7. Click the cell containing the X value for that row.
8. Enter the addition symbol (+).
9. Click the cell containing the INTERCEPT function to enter its address
in the formula.
10. Press F4 to convert the address to an absolute reference.
It displays with dollar signs.
11. Press Enter to complete the formula.
12. Make sure the cursor is on the cell where you just entered the formula.
13. Press Ctrl + C to copy the formula to the clipboard.
14. Hold down the Shift key and press the ↓key until the entire column is
highlighted down to the row containing the last X value.
15. Press Enter to copy the formula to all selected cells.
At this point, the column of data you just created contains the Y values for
the linear regression line. The final step is to create a chart that displays both
the actual data as well as the computed regression line.
1. Highlight all three columns of data — the X values, the actual Y
values, and the computed Y values.
2. Click the Chart Wizard button on the toolbar to display the Chart
Wizard dialog box (shown in Figure 11-3).
201
Chapter 11: Rolling the Dice on Predictions and Probability

3. In the Chart Type list, select XY (scatter).
4. Under Chart Subtype, select the option that has symbols but no lines.
5. Click the Finish button.
The chart displays as shown in Figure 11-4. You can see two sets of points.
The scattered ones are the actual data, while the straight line is the linear-
regression line.
What’s in the Future: Using FORECAST,
TREND, and GROWTH to Make Predictions
The FORECAST function does just what its name suggests — it forecasts an
unknown data value based on existing, known data values. The function is
based on a single important assumption — that the data is linear. What
exactly does this mean?
Figure 11-4:
A data set
displayed
with its
linear
regression
line.
Figure 11-3:
Creating a
chart with
the Chart
Wizard.
202
Part III: Doing the Math 

FORECAST
The data that FORECAST works with are in pairs — there’s an X value and a
corresponding Y value in each pair. For example, perhaps you’re investigating
the relationship between people’s heights and their weight. Each data pair
would be one person’s height, the X value, and their weight, the Y value.
Many kinds of data are in this form — sales by month, for example, or income
as a function of educational level.
You can use the CORREL function to determine the degree of linear relation-
ship between two sets of data. See Chapter 9 to find out about the CORREL
function.
To use the FORECAST function, you must have a set of X-Y data pairs. You
then provide a new X value, and the function returns the Y value that would
be associated with that X value based on the known data. The function takes
three arguments:
 The first argument is the X value that you want a forecast for.
 The second argument is a range containing the known Y values.
 The third argument is a range containing the known X values.
Note that the X and Y ranges must have the same number of values or the
function returns an error. The X and Y values in these ranges are assumed 
to be paired in order.
Don’t use FORECAST with data that isn’t linear. Doing so produces 
inaccurate results.
Now you can work through an example of using FORECAST to make a predic-
tion. Imagine that you’re the sales manager at a large corporation. You’ve
noticed that the yearly sales results for each of your salespeople is related to
the number of years of experience each has. You’ve hired a new salesman with
16 years of experience. How much in sales can you expect this person to make?
Figure 11-5 shows the existing data for salespeople — their years of experi-
ence and annual sales last year. This worksheet also contains a scatter chart
of the data to show that it’s linear. It’s clear that the data points fall fairly well
along a straight line. Follow along to create the prediction:
1. In a blank cell, enter =FORECAST( to start the function entry.
The blank cell is C24 in Figure 11-5.
2. Enter 16, the X value that you want a prediction for.
3. Enter a comma (,).
203
Chapter 11: Rolling the Dice on Predictions and Probability

4. Drag over the Y range, or enter the cell range.
C3:C17 is the cell range in the example.
5. Enter a comma (,).
6. Drag over the X range, or enter the cell range.
B3:B17 is the cell range in the example.
7. Enter a ), and press Enter to complete the formula.
After formatting the cell as Currency, the result shown in Figure 11-5 displays
the prediction that your new salesman will make $27,093 in sales his first
year. But remember: This is just a prediction and not a guarantee!
TREND 
You just saw how the FORECAST function can predict a Y value for a known X
based on an existing set of linear X-Y data. What if you have more than one X
value to predict? Have no fear, TREND is here! What FORECAST does for a
single X value, TREND does for a whole array of X values.
Like FORECAST, the TREND function is intended for working with linear data.
If you try to use it with nonlinear data, the results will be incorrect.
The TREND function takes up to four arguments:
 The first argument is a range containing the known Y values.
 The second argument is a range containing the known X values.
Figure 11-5:
Forecasting
sales.
204
Part III: Doing the Math 

 The third argument is a range containing the X values that you want 
predictions for.
 The fourth argument is a logical value. It tells the function whether to
force the constant b to 0. If the fourth argument is TRUE or omitted, the
linear regression line (used to predict Y values) is calculated normally. 
If this argument is FALSE, the linear regression line is calculated to go
through the origin (where both X and Y are 0).
Note that the ranges of known X and Y values must be the same size (contain
the same number of values).
TREND returns an array of values, one predicted Y for each X value. In other
words, it’s an array function and must be treated as such. (See Chapter 3 for
help with array functions.) Specifically, this means selecting the range where
you want the array formula results, typing in the formula, and pressing Ctrl +
Shift + Enter rather than pressing Enter alone to complete the formula.
When would you use the TREND function? Here’s an example: You’ve started
a part-time business, and your income has grown steadily over the past 12
months. The growth seems to be linear, and you want to predict how much
you will earn in the coming six months. The TREND function is ideal for this
situation. Here’s how to do it:
1. In a new worksheet, put the numbers 1 through 12, representing the
past 12 months, in a column.
2. In the adjacent cells, place the income figure for each of these months.
3. Label this area Actual Data.
4. In another section of the worksheet, enter the numbers 13 through 18
in a column to represent the upcoming six months.
5. In the column adjacent to the projected month numbers, select the six
adjacent cells (empty at present) by dragging over them.
6. Type =TREND( to start the function entry.
7. Drag over the range of known Y values, or enter the range address. 
The known Y values are the income figures entered in Step 2.
8. Enter a comma (,).
9. Drag over the range of known X values, or enter the range address. 
The known X values are the numbers 1 through 12 entered in Step 1.
10. Enter a comma (,).
205
Chapter 11: Rolling the Dice on Predictions and Probability

11. Drag over the list of month numbers for which you want projections
(the numbers 13 through 18). 
These are the new X values.
12. Enter a ).
13. Press Ctrl + Shift + Enter to complete the formula.
When you’ve completed these steps, you’ll see the projected income figures,
calculated by the TREND function, displayed in the worksheet. An example is
shown in Figure 11-6. There’s no assurance you’ll have this income — but it
may be even higher! You can always hope for the best.
GROWTH 
The GROWTH function is like TREND in that it uses existing data to predict Y
values for a set of X values. It’s different in that it’s designed for use with data
that fits an exponential model. The function takes four arguments:
 The first argument is a range or array containing the known Y values.
 The second argument is a range or array containing the known X values.
 The third argument is a range or array containing the X values for which
you want to calculate predicted Y values.
 The fourth value is omitted or TRUE if you want the constant b calcu-
lated normally. If this argument is FALSE, b is forced to 1. You won’t use
FALSE except in special situations.
The number of known X and known Y values must be the same for the
GROWTH function or an error occurs. As you’d expect, GROWTH is an array
formula and must be entered accordingly.
Figure 11-6:
Using the
TREND
function to
calculate
predictions
for an array.
206
Part III: Doing the Math 

To use the GROWTH function, follow these steps. Note: This assumes that
you have a worksheet that already contains known X and Y values that fit the
exponential model.
1. Enter the X values for which you want to predict Y values in a column
of the worksheet.
2. Select a range of cells in a column that has the same number of rows
as the X values you entered in Step 1.
Often this range is in the column next to the X values, but it doesn’t 
have to be.
3. Enter =Growth( to start the function entry.
4. Drag over the range containing the known Y values, or enter the
range address.
5. Enter a comma (,).
6. Drag over the range containing the known X values, or enter the
range address.
7. Enter a comma (,).
8. Drag over the range containing the X values for which you want to
predict Y values, or enter the range address.
9. Enter a ).
10. Press Ctrl + Shift + Enter to complete the formula.
Figure 11-7 shows an example of using the GROWTH function to forecast
exponential data. Columns A and B contain the known data, and the range
D10:D19 contains the X values for which predictions are desired. The
GROWTH array formula was entered in E10:E19. The chart shows a scatter
plot of the actual data, up to X = 40, and the projected data, for X values
above 40. You can see how the projected data continues the exponential
curves that are fit by the actual data.
Figure 11-7:
Demon-
strating 
use of the
GROWTH
function 
to project
exponential
data.
207
Chapter 11: Rolling the Dice on Predictions and Probability

Using NORMDIST and POISSON to
Determine Probabilities
You can get a good introduction to the normal distribution in Chapter 9. To
recap briefly, a normal distribution is characterized by its mean (the value in
the middle of the distribution) and by its standard deviation (the extent to
which values spread out on either side of the mean). The normal distribution
is a continuous distribution, which means that X values can be fractional and
aren’t restricted to integers. The normal distribution has a lot of uses
because so many processes, both natural and human, follow it.
NORMDIST 
The word normal in this context doesn’t mean “good” or “okay,” and a distrib-
ution that is not normal is not flawed in some way. Normal is used simply to
mean “typical” or “common.”
Excel provides you with the NORMDIST function for calculating probabilities
from a normal distribution. The function takes four arguments:
 The first argument is the value for which you want to calculate a 
probability.
 The second argument is the mean of the normal distribution.
 The third argument is the standard deviation of the normal distribution.
 The fourth argument is TRUE if you want the cumulative probability and
FALSE if you want the noncumulative probability.
A cumulative probability is the chance of getting any value between 0 and the
specified value. A noncumulative probability is the chance of getting exactly
the specified value.
Normal distributions come into play for a wide variety of measurements.
Examples include blood pressure, atmospheric carbon-dioxide levels, 
wave height, leaf size, and oven temperature. If you know the mean and 
standard deviation of a distribution, you can use NORMDIST to calculate
related probabilities.
Here’s an example: Your firm manufactures hardware, and a customer wants
to buy a large quantity of 50mm bolts. Due to the manufacturing process, the
length of bolts varies slightly. The customer will place the order only if at
208
Part III: Doing the Math 

least 95 percent of the bolts are between 49.9mm and 50.1mm. Measuring
each one isn’t practical, but previous data shows that the distribution of bolt
lengths is a normal distribution with a mean of 50 and a standard deviation of
0.05. You can use Excel and the NORMDIST function to answer the question.
Here’s the plan:
1. Use the NORMDIST function to determine the cumulative probability of a
bolt being at least 50.1mm long.
2. Use the NORMDIST function to determine the cumulative probability of a
bolt being at least 49.9mm long.
3. Subtract the second value from the first to get the probability that a bolt
is between 49.9mm and 50.1mm long.
Here are the steps to follow:
1. In a new worksheet, enter the values for the mean, standard devia-
tion, upper limit, and lower limit in separate cells.
Optionally, add adjoining labels to identify the cells.
2. In another cell, enter =NORMDIST( to start the function entry.
3. Click the cell containing the lower limit value (49.9) or enter the cell
address.
4. Enter a comma (,).
5. Click the cell containing the mean, or enter the cell address.
6. Enter a comma (,).
7. Click the cell containing the standard deviation, or enter the cell
address.
8. Enter a comma (,).
9. Enter TRUE).
10. Press Enter to complete the function.
This cell now displays the probability of a bolt being less than or equal
to the lower limit.
11. In another cell, enter =NORMDIST( to start the function entry.
12. Click the cell containing the upper-limit value (50.1), or enter the cell
address.
13. Repeat steps 4 through 10.
This cell now displays the probability of a bolt being less than or equal
to the upper limit.
209
Chapter 11: Rolling the Dice on Predictions and Probability

14. In another cell, enter a formula that subtracts the lower-limit 
probability from the upper-limit probability.
This cell now displays the probability that a bolt will be within the 
specified limits.
Figure 11-8 shows a worksheet that was created to solve this problem. You
can see from cell B8 that the answer is 0.9545 — in other words, 95.45 per-
cent of your bolts fall in the prescribed limits, and you can accept the cus-
tomer’s order. Note in this worksheet that the formulas in cells B6:B8 are
presented in the adjacent cells so you can see what they look like.
POISSON 
Poisson is another kind of distribution used in many areas of statistics. 
Its most common use is to model the number of events taking place in a 
specified time period. Suppose you were modeling the number of employees
calling in sick each day, or the number of defective items produced at your
factory each week. In these cases, the Poisson distribution is appropriate.
The Poisson distribution is useful for analyzing rare events. What exactly does
rare mean? People calling in sick at work is hardly rare, but a specific number
calling in sick is rare, at least statistically speaking. Situations where Poisson
is applicable includes numbers of car accidents, counts of customers arriving,
manufacturing defects, and the like. One way to express it is that the events
are individually rare, but there are many opportunities for them to happen.
The Poisson distribution is a discrete distribution. This means that the X
values in the distribution can only take on specified, discrete values such as
X = 1, 2, 3, 4, 5 and so on. This is different from the normal distribution, which
is a continuous distribution in which X values can take any value (X = 0.034,
1.2365, and so on). The discrete nature of the Poisson distribution is suited to
the kinds of data you use it with. For example, with employees calling in sick,
you may have 1, 5, or 8 on a given day, but certainly not 1.45, 7.2, or 9.15!
Figure 11-8:
Using the
NORMDIST
function to
calculate
probabilities.
210
Part III: Doing the Math 

Figure 11-9 shows a Poisson distribution that has a mean of 20. Values on the
X axis are number of occurrences (of whatever you’re studying), and values
on the Y axis are probabilities. You can use this distribution to determine the
probability of a specific number of occurrences happening. For example, this
chart tells you that the probability of having exactly 15 occurrences is
approximately 0.05 (5 percent).
The Poisson distribution is a discrete distribution and is used only with data
that takes on discrete (integer) values, such as counting items.
A Poisson distribution is not always symmetrical, as is the one shown in
Figure 11-9. Negative X values make no sense in a Poisson distribution. After
all, you can’t have fewer than zero people calling in sick! If the mean is a small
value, the distribution will be skewed, as shown in Figure 11-10 for a Poisson
distribution with a mean of 4.
Figure 11-10:
A Poisson
distribution
with a 
mean of 4.
Figure 11-9:
A Poisson
distribution
with a mean
of 20.
211
Chapter 11: Rolling the Dice on Predictions and Probability

Excel’s POISSON function lets you calculate the probability that a specified
number of events will occur. All you need to know is the mean of the distribu-
tion. This function can calculate the probability two ways:
 Cumulative: The probability that between 0 and X events will occur.
 Non-cumulative: The probability that exactly X events will occur.
The two Poisson graphs shown earlier were for noncumulative probabilities.
Figure 11-11 shows the cumulative Poisson distribution corresponding to
Figure 11-9. You can see from this chart that the cumulative probability of 15
events — the probability of 15 or fewer events occurring — is about 0.15.
What if you want to calculate the probability that more than X events will
occur? Simple! Just calculate the cumulative probability for X and subtract
the result from 1.
The POISSON function takes three arguments:
 The first argument is the number of events that you want to calculate
the probability for. This must be an integer value greater than 0.
 The second argument is the mean of the Poisson distribution to use.
This too must be an integer value greater than 0.
 The third argument is TRUE if you want the cumulative probability and
FALSE if you want the noncumulative probability.
For example, suppose that you’re the manager of a factory that makes brake
shoes. Your district manager has announced an incentive: You’ll receive a
bonus for each day that the number of defective shoes is less than 20. How
many days a month will you meet this goal, knowing that the average number
of defective brake shoes is 25 per day?
Figure 11-11:
A cumulative
Poisson
distribution
with a 
mean of 20.
212
Part III: Doing the Math 

Here are the steps to follow:
1. In a new worksheet, enter the average number of defects per day (25)
in a cell.
If desired, enter an adjacent label to identify the cell.
2. In the cell below, type =POISSON( to start the function entry.
3. Enter the value 20.
4. Enter a comma (,).
5. Click the cell where you entered the average defects per day, or enter
its cell address.
6. Enter a comma (,).
7. Enter TRUE).
8. Press Enter to complete the formula.
9. If desired, enter a label in an adjacent cell to identify this as the prob-
ability of 20 or fewer defects.
10. In the cell below, enter a formula that multiplies the number of work-
ing days per month (22) by the result just calculated with the POISSON
function.
In our worksheet, this formula is =22*B3, entered in cell B4.
11. If desired, enter a label in an adjacent cell to identify this as the
number of days per month you can expect to have 20 or fewer defects.
The finished worksheet is shown in Figure 11-12. In this example, we have for-
matted cells B3:B4 with two decimal places. You can see that with an average
of 25 defects per day you can expect to earn a bonus 4 days a month.
Figure 11-12:
Using the
POISSON
function to
calculate a
cumulative
probability.
213
Chapter 11: Rolling the Dice on Predictions and Probability

214
Part III: Doing the Math 

Chapter 12
Dressing Up for Date Functions
In This Chapter
 Handling dates
 Working with days, months, and years
 Getting the value of today
 Determining the day of the week
O
ften when working with Excel, you need to manage dates. Perhaps you
have list of dates when you visited a client and you need to count how
many times you were there in September. On the other hand, maybe you are
tracking a project over a few months and want to know how many days are in
between the milestones.
Excel has a number of useful Date functions to make your work easier! This
chapter explains how Excel handles dates, how to compare and subtract dates,
how to work with parts of a date (such as the month or year), and even how to
count the number of days between two dates. You can always reference the
current data from your computer’s clock and use it in a calculation; we show
you how.
Understanding How Excel Handles Dates
Imagine if, on January 1, 1900, you starting counting by ones, each day
adding one more to the total. This is just how Excel thinks of dates. January
1, 1900, is one; January 2, 1900, is two; and so on. We’ll always remember
25,404 as the day man first walked on the moon, and 36,892 as the start of the
new millennium!
The millennium actually started on January 1, 2001. The year 2000 is the last
year of the 20th century. Representing dates as a serial number — specifically,
the number of days between January 1, 1900, and the date in question — may
seem odd but there are very good reasons for it. Excel can handle dates from
January 1, 1900, to December 31, 9999. Using the serial numbering system,
that’s 1 through 2,958,465!

Because Excel represents dates in this way, it can work with dates in the
same manner as numbers. For example, you can subtract one date from
another to find out how many days are between them. Likewise, you can add
14 to today’s date to get a date two weeks in the future. This trick is very
useful, but people are used to seeing dates represented in traditional formats,
not as numbers. Fortunately, Excel uses date serial numbers only behind the
scenes, and what you see in your workbook are dates in the standard date
formats such as Jan 20, 2007, and 12/20/06.
In Excel for the Mac, the serial numbering system begins on January 1, 1904.
The way years are handled requires special mention. When a year is fully dis-
played in four digits, such as 2005, there is no ambiguity. However, when a
date is written in a shorthand style, such as in 3/1/02, it isn’t clear what the
year is. It could be 2002, or it could be 1902. Say 3/1/02 is a shorthand entry
for someone’s birthday. Then on March 1, 2005, he is either 3 years old or 103
years old. In those countries that write dates as dd/mm/yy, this would be
January 3, 1902, or January 3, 2002.
Excel and the Windows operating system have a default way of interpreting
shorthand years. Windows 2000 and later has a setting in the Customize
Regional Options dialog box found in the Control Panel. This setting guides
how Excel will interpret years. If the setting is 1930 through 2029, then 3/1/02
indicates the year 2002, but 3/1/45 indicates the year 1945, not 2045. Figure
12-1 shows this setting.
Here’s how to open and set it:
1. Click your computer’s Start button.
2. Select Control Panel.
3. Select Regional and Language Options.
The Regional and Language Options dialog box opens.
4. Select the Regional Options tab if it is not selected by default.
5. Click the Customize button.
The Customize Regional Options dialog box appears.
6. Select the Date tab.
7. Enter a four-digit ending year (such as 2029) to indicate the latest year
that will be used when interpreting a two-digit year.
8. Click OK to close each dialog box.
216
Part III: Doing the Math 

To ensure full accuracy when working with dates, always enter the full four
digits for the year.
Formatting Dates
When you work with dates, you’ll probably need to format cells in your work-
sheet. It’s great that Excel tells you that June 1, 2005, is serially represented
as 38504, but you probably don’t want that on a report. To format dates, you
use the Format Cells dialog box, shown in Figure 12-2. To format dates, follow
these steps:
1. If not already displayed, click the Home tab at the top of the Excel
screen.
2. Click the small arrow at the bottom-right corner of the Number section. 
The Format Cells dialog box appears, revealing the Number tab. 
3. Select Date in the Category List.
4. Select an appropriate format from the Type List.
Now you can turn the useful but pesky serial dates into a user-friendly format.
When you enter a date into a cell using one of the standard date formats,
Excel recognizes it as a date and automatically assigns a Date format to the
cell. You may want to use the Number Format dialog box to assign a different
Date format.
Figure 12-1:
Setting how
years are
interpreted.
217
Chapter 12: Dressing Up for Date Functions

Making a Date with DATE 
You can use the DATE function to create a complete date from separate year,
month, and day information. The DATE function can be useful because dates
don’t always appear as, well, dates, in a worksheet. You may have a column
of values between 1 and 12 that represents the month, and another column 
of values between 1 and 31 for the day of the month. A third column may
hold years — in either the two-digit shorthand or the full four digits.
The DATE function combines individual day, month, and year components
into a single usable date. This makes using and referencing dates in your
worksheet easy. Follow along to use the DATE function:
1. Select the cell where you want the results displayed.
2. Enter =DATE( to begin the function entry.
3. Click the cell that has the year.
4. Enter a comma ( , ).
5. Click the cell that has the number (1–12) that represents the month.
6. Enter a comma ( , ).
7. Click the cell that has the number (1–31) that represents the day of
the month.
8. Type a ), then press Enter.
Figure 12-3 displays a fourth column of dates that are created using DATE and
the values from the first three columns. The fourth column of dates has been
formatted so the dates are displayed in a standard format, not as a raw date
serial number.
Figure 12-2:
Using the
Format Cells
dialog box
to control
how 
dates are
displayed.
218
Part III: Doing the Math 

DATE provides some extra flexibility with the month number. Negative month
numbers are subtracted from the specified year. For example, the function
=DATE(2006, -5, 15) returns the date July 15, 2005 because July 2005 is 
5 months before the first month of 2006. Numbers greater than 12 work the
same way — =DATE(2001, 15, 1) returns March 1, 2002, because March
2002 is 15 months after the first month of 2001.
Day numbers work the same way. Negative day numbers are subtracted from
the first of the specified month, and numbers that are greater than the last
day of the specified month wrap into later months. Thus, =DATE(2002, 2,
30) returns March 2, 2002, because February does not have 30 days.
Likewise, =DATE(2002, 2, 40) returns March 12, 2002.
Breaking a Date with DAY, 
MONTH, and YEAR 
That which can be put together can also be taken apart. In the preceding sec-
tion, we show you how to use the DATE function to create a date from sepa-
rate year, month, and day data. In this section, you find out how to do the
reverse — split a date into individual year, month, and day components using
the DAY, MONTH, and YEAR functions. In Figure 12-4, the dates in column A
are split apart by day, month, and year, respectively, in Columns B, C, and D.
Isolating the day 
Isolating the day part of a date is useful in applications where just the day, but
not the month or year, is relevant. For example, say you own a store and want to
figure out whether more customers come to shop in the first half or the second
half of the month. You’re interested in this trend over several months. So the
task may be to average the number of sales by the day of the month only.
Figure 12-3:
Using the
DATE
function to
assemble a
date from
separate
month, day,
and year
values.
219
Chapter 12: Dressing Up for Date Functions

The DAY function is useful for this because you can use it to return just the
day for a lengthy list of dates. Then you can examine results by the day only.
Here’s how you use the DAY function:
1. Position the pointer in the cell where you want the results displayed.
2. Enter =DAY( to begin the function entry.
3. Click the cell that has the date.
4. Enter a ), then press Enter.
Excel returns a number between 1 and 31.
Figure 12-5 shows how the DAY function can be used to analyze customer
activity. Column A contains a full year’s sequential dates (most of which are
not visible in the figure). In Column B, the day part of each date has been 
isolated. Column C shows the customer traffic for each day.
This is all the information that is needed to analyze whether there is a differ-
ence in the amount of customer traffic between the first half and second half
of the month.
Cells E4 and E10 show the average daily customer traffic for the first half 
and second half of the month, respectively. The value for the first half of the
month was obtained by adding all the customer values for day values in the
range 1 to 15 and then dividing by the total number of days. The value for the
second half of the month was done the same way but using day values in the
range 16 to 31.
Figure 12-4:
Splitting
apart a date
with the
DAY,
MONTH,
and YEAR
functions.
220
Part III: Doing the Math 

The day parts of the dates, in Column B, were key to these calculations:
 In cell E4 the calculation is =SUMIF(B2:B367,”<16”,C2:C367)/
COUNTIF(B2:B367”<16”).
 In cell E10 the calculation is =SUMIF(B2:B367,”>15”,C2:C367)/
COUNTIF(B2:B367,”>15”).
The SUMIF function is discussed in Chapter 7. The COUNTIF function is 
discussed in Chapter 11.
The DAY function has been instrumental in showing that more customers visit
the fictitious store in the second half of the month. This type of information is
great for a store owner to plan staff assignments, sales specials, and so on.
Isolating the month 
Isolating the month part of a date is useful in applications where just the
month, but not the day or year, is relevant. For example, you may have a list
of dates on which more than five of your employees call in sick and need to
determine if this is more common in certain months than others.
You could sort the dates and then count the number for each month. That
would be easy enough, but sorting may not be an option based on other
requirements. Besides, why manually count when you have, right in front of
you, one of the all-time greatest counting software programs ever made?
Figure 12-5:
Using 
the DAY
function to
analyze
customer
activity.
221
Chapter 12: Dressing Up for Date Functions

Figure 12-6 shows a worksheet in which the MONTH function has extracted
the numeric month value (1–12) into Column B from the dates in Column A.
Cell B2 contains the formula =MONTH(A2) and so on down the column.
Columns C and D contain a summary of dates per month. The formula used 
in cell D3 is =COUNTIF($B$2:$B$201,1).
This counts the number of dates where the month value is 1 — in other
words, January. Cells D4 through D14 contain similar formulas for month
values 2 through 12. The figure’s data plot makes it clear that calling in sick is
more prevalent in December and January. See Chapter 14 for information on
the COUNTIF function.
Use the MONTH function this way:
1. Select the cell where you want the results displayed.
2. Enter =MONTH( to begin the function entry.
3. Click the cell that has the date.
4. Enter a ), and press Enter.
Excel returns a number between 1 and 12.
Isolating the year 
Isolating the year part of a date is useful in applications where just the year,
but not the day or month, is relevant. In practice, this is less used than the
DAY or MONTH functions because date data is often — though not always —
from the same year.
Figure 12-6:
Using the
MONTH
function to
count the
number of
dates falling
in each
month.
222
Part III: Doing the Math 

Follow the steps to use the YEAR function:
1. Select the cell where you want the results displayed.
2. Enter =YEAR( to begin the function entry.
3. Click the cell that has the date.
4. Enter a ), and press Enter.
Excel returns the four-digit year.
Converting a Date from Text 
You may have data in your worksheet that looks like a date but is not repre-
sented as an Excel date value. For example, if you enter 01-14-07 in a cell, Excel
would have no way of knowing whether this is January 14, 2004, or the code
for your combination lock. If it looks like a date, you can use the DATEVALUE
function to convert it into an Excel date value.
In practice, any standard date format entered into a cell is recognized by
Excel as a date and converted accordingly. However, they may be cases, 
such as when text dates are imported from an external data source or data 
is copied and pasted into Excel, that you need DATEVALUE.
Why not enter dates as text data? Because although they may look fine, you
can’t use them for any of Excel’s powerful date calculations without first 
converting them to date values.
The DATEVALUE function recognizes almost all commonly used ways that
dates are written. Here are some ways that you may enter August 5, 2005:
 8/5/05
 5-Aug-2005
 2005/08/05
DATEVALUE can convert these and several other date representations to a
date serial number.
After you’ve converted the dates to a date serial number, the dates can be
used in other date formulas or to perform calculations as described in other
parts of this chapter.
223
Chapter 12: Dressing Up for Date Functions

To use the DATEVALUE function, follow these steps:
1. Select the cell where you want the date serial number located.
2. Enter =DATEVALUE( to begin the function entry.
3. Click the cell that has the text format date.
4. Enter a ), and press Enter.
The result will be a date serial number, unless the cell where the result is
displayed has already been set to a date format.
Figure 12-7 shows how some nonstandard dates in Column A have been con-
verted to serial numbers with the DATEVALUE function in column B. Then
column C displays these serial numbers formatted as dates.
Did you notice something funny in Figure 12-7? Normally, you won’t be able to
enter a value such as the one in cell A4 — 02-28-06 — without losing the lead-
ing 0. The cells in Column A had been changed to the Text format. This format
tells Excel to leave your entry as is. The Text format is one of the choices in
the Category list in the Format Cells dialog box. (Refer to Figure 12-2.)
Note also that the text date in cell A8, Feb 9 05, could not be converted by
DATEVALUE so the function returns the error message #VALUE#. We did say
Excel is great at recognizing dates, but we did not say it is perfect! In cases
such as this, you have to format the date another way so DATEVALUE can
recognize it.
Finding Out What TODAY Is
When working in Excel you often need to use the current date. Each time you
print a worksheet, for example, you may want the day’s date to show. The
TODAY function fills the bill perfectly for this. It simply returns the date from
your computer’s internal clock. To use the TODAY function, follow these steps:
Figure 12-7:
Converting
dates into
their serial
equivalents
with the
DATEVALUE
function.
224
Part III: Doing the Math 

1. Position the pointer in the cell where you want the result.
2. Type =TODAY( ).
3. Press Enter to end the function.
That’s it! You now have the date from your computer. If your computer’s
clock is not set correctly, don’t blame Excel. Like all dates in Excel, what you
really end up with is a serial number, but the Date formatting displays the
date in a readable fashion.
As with all functions in Excel, you can embed functions in other functions.
For example, if you need to know just the current date’s month, you can 
combine the TODAY function with the MONTH function, like this:
=MONTH(TODAY())
Counting the days until your birthday
After a certain age a lot of people wish their birthday would not come around
so often, but if you still like birthdays you can use Excel to keep track of how
many days are left. Entered in a cell, this formula tells you how many days
are left until your birthday (assuming that your next birthday is May 5, 2007):
=DATE(2007,5,5) - TODAY()
Use the DATE function to enter the day, month, and year of your next birth-
day. This avoids having a shorthand entry, such as 5/5/2007, be interpreted
as a mathematical operation on its own.
If the formula were =5/5/2007 – TODAY(), an incorrect answer would be
calculated because this effectively says, “Divide 5 by 5, then divide that result
by 2007, then subtract the serial number of today’s date.” The answer would
be incorrect.
Using the DATE function to represent dates in which a mathematical opera-
tion is performed is a good idea.
Counting your age, in days
When your birthday finally rolls around, someone might ask how old you are.
Maybe you’d rather not say. Here’s a way to respond, but in a way that leaves
some doubt: Answer by saying how old you are in days!
225
Chapter 12: Dressing Up for Date Functions

Excel can help figure this out. All you have to do is count the number of days
between your birth date and the current date. A simple formula tells you this:
=TODAY() - DATE(birth year, birth month, birth day)
Here’s an example, assuming your birthday is March 18, 1956: =TODAY() -
DATE(1956, 3, 18).
Determining the Day of the Week
The Beatles wrote a song called “Eight Days a Week,” but for the rest of us
seven days is the norm. The WEEKDAY function helps you figure out which
day of the week a date falls on. Now you can figure out whether your next
birthday falls on a Friday. Or, you can make sure a planned business meeting
does not fall on a weekend.
Here is how you use the WEEKDAY function:
1. Select the cell where you want the results displayed.
2. Enter =WEEKDAY( to begin the function entry.
3. Select the cell that has the date you want to find out the weekday for.
4. Enter a ), and press Enter.
WEEKDAY returns a number between 1 and 7. Table 12-1 shows what the
returned number means.
Table 12-1
WEEKDAY Returned Values
Returned Value
Weekday
1
Sunday
2
Monday
3
Tuesday
4
Wednesday
5
Thursday
6
Friday
7
Saturday
226
Part III: Doing the Math 

Don’t confuse the returned numbers with actual dates! Just because Table
12-1 shows a value of 4 indicating Wednesday doesn’t mean the fourth of a
month is a Wednesday. The values of the returned numbers are also a bit con-
fusing because most people consider Monday, not Sunday, to be the first day
of the week. You can go argue the point with Microsoft if you like! Or, better
yet, you can include a second, optional, argument that tells WEEKDAY to
return 1 for Monday, 2 for Tuesday, and so on:
=WEEKDAY(A1, 2)
The numbers 1 through 7, returned from the WEEKDAY function, are not the
same as the first through seventh of the month.
The WEEKDAY function lets you extract interesting information from date-
related data. For example, maybe you’re on a diet and you’re keeping a tally
of how many calories you consume each day for a month. Then you start
wondering, “Am I eating more on weekends than on weekdays?” Figure 12-8
shows a worksheet that calculates the average calories consumed on each
day of the week over a month’s time. A quick glance at the results shows that
Saturdays and Sundays are not your high-calorie-consumption days — rather,
it’s Monday and Tuesday that you have to watch out for.
Working with Workdays
Most weeks have five workdays — Monday through Friday — and two week-
end days. I know; some weeks seem to have 20 workdays, but that’s just your
imagination! Excel has two functions that let you perform workday-related
calculations.
Figure 12-8:
Using
WEEKDAY
tells you
which day
of the week
a date 
falls on.
227
Chapter 12: Dressing Up for Date Functions

Determining workdays in a range of dates 
The NETWORKDAYS function tells you how many working days are in a range
of dates. Ever sit at your desk and stare at the calendar trying to count how
many working days are left in the year? Excel can answer this vital question
for you!
NETWORKDAYS counts the number of days, omitting Saturdays and Sundays,
in a range of dates that you supply. You can add a list of dates that should not
be counted, if you want. This optional list is where you can put holidays,
vacation time, and so on.
Figure 12-9 shows an example using NETWORKDAYS. Cells C3 and C4 show
the start and end dates, respectively. In this example, the start date is pro-
vided with the TODAY function. Therefore, the result will always reflect a
count that starts from the current date. The end date is the last day of the
year. The function in cell C6 is =NETWORKDAYS(C3,C4,C10:C24).
The function includes the cells that have the start and end dates. Then there
is a range of cells — C10 through C24. These cells have dates that should not
be counted in the total of workdays: holidays and vacation. You can put any-
thing in here, but they do have to be Excel dates. If a date specified in this list
falls on a workday, then NETWORKDAYS does not count it. If it falls on a
weekend, it would not be counted anyway, so it is ignored.
Figure 12-9:
Counting
workdays
with
NETWORK
DAYS.
228
Part III: Doing the Math 

To use NETWORKDAYS, follow these steps:
1. Select the cell where you want the results displayed.
2. Enter =NETWORKDAYS( to begin the function entry.
3. Click the cell that has the start date for the range of dates to be
counted.
4. Enter a comma ( , ).
5. Click the cell that has the number end date for the range of dates to
be counted.
If you want to add a list of dates to exclude, continue to Steps 6 and 7;
otherwise, skip these and go to Step 8.
6. Enter a comma ( , ).
7. Click and drag the pointer over the cells that have the dates to
exclude.
8. Enter a ), and press Enter.
The result is a count of days, between the start and end dates, that 
do not fall on Saturday or Sunday and are not in an optional list of 
exclusion dates.
Workdays in the future
Sometimes you are given a deadline — or you may give it to someone else:
“Have that back to me in 20 working days.” Fine, but what is the date 20 work-
ing days from now? The WORKDAY function comes to the rescue. You specify
a start date, the number of working days, and an optional list of holidays that
are not to be counted as working days. (This list works just the same as for
the NETWORKDAYS function discussed in the previous section.) 
To use WORKDAYS, follow these steps:
1. Select the cell where you want the results displayed.
2. Enter =WORKDAYS( to begin the function entry.
3. Click the cell that has the start date for the calculation.
229
Chapter 12: Dressing Up for Date Functions

4. Enter a comma ( , ).
5. Click the cell that has the number of workdays, or enter the number
directly in the formula.
If you want to add a list of dates to exclude in the count, continue to
Steps 6 and 7; otherwise, skip these and go to Step 8.
6. Enter a comma ( , ).
7. Click and drag the pointer over the cells that have the dates to be
excluded.
8. Enter a ), and press Enter.
The result is a date that is the specified number of workdays from the
start date, not counting dates in the optional list of exclusion dates.
Calculating Time between Two Dates
with the DATEDIF Function
Excel provides the DATEDIF function to calculate the number of days,
months, or years between two dates. This is an undocumented function, that
is, you will not see it in the Insert Function dialog box, and you cannot find it
in the Excel Help system. Why is it undocumented? Beats us — but it sure
can be useful! Impress your friends and co-workers. The only thing you have
to do is remember how to enter it. Of course, we don’t mind if you keep this
book around to look it up.
DATEDIF takes three arguments: 
 Start date 
 End date 
 Interval 
The interval argument tells the function what type of result to return, 
summarized in Table 12-2.
230
Part III: Doing the Math 

Table 12-2 
Settings for the Interval Argument of DATEDIF
Value
What It Means
Comment
“d”
Days
The count of inclusive days from the start date
through the end date.
“m”
Months
The count of complete months between the dates.
Only those months that fully occur between the
dates are counted. For example, if the first date
starts after the first of the month, then that first
month is not included in the count. For the end date,
even when it is the last day of the month, that month
is not counted. See Figure 12-10 for an example.
“y”
Years
The count of complete years between the dates.
Only those years that fully occur between the dates
are counted. For example, if the first date starts
later than January 1, that first year is not included in
the count. For the end date, even when it is
December 31, that year is not counted. See Figure
12-10 for an example.
“yd”
Days excluding 
The count of inclusive days from the start date 
years
through then end date, but as if the two dates are in
the same year. The year is ignored.
“ym”
Months 
The count of complete months between the dates, 
excluding 
but as if the two dates are in the same year. The 
years
year is ignored.
“md”
Days excluding 
The count of inclusive days from the start date 
months and 
through the end date, but as if the two dates are in 
years
the same month and year. The month and year 
are ignored.
Figure 12-10 shows some examples of using DATEDIF. Column A has start
dates. Column B has end dates. Columns C through H contain formulas with
DATEDIF. The DATEDIF function uses the start and end dates on each given
row, and the interval is labeled at the top of the each column, C through H.
231
Chapter 12: Dressing Up for Date Functions

Here are some highlights from the DATEDIF example in Figure 12-10:
 When the start date and end date are the same, the count of days is
zero. The formula in cell C4 is =DATEDIF(A4,B4,”d”).
 With a start date of 1/1/2005 and an end date of 12/31/2005, only 11
months are counted. The month of the end date is not counted. The 
formula in cell D6 is =DATEDIF(A6,B6,”m”).
 With a start date of 1/1/2005 and an end date of 5/10/2006, DATEDIF used
with the md interval returns 9 as the count of days between the dates,
even though the real count is 494. The formula in cell H8 is =DATEDIF
(A8,B8,”md”).
Here’s how to use DATEDIF:
1. Select the cell where you want the results to appear.
2. Enter =DATEDIF( to begin the function entry.
3. Click a cell where you have a date, or enter its address.
4. Enter a comma ( , ).
5. Click a cell where you want another date.
This date must be the same or greater than the first date from Step 3, or
you get an error.
6. Enter a comma ( , )
7. Enter an interval.
See Table 12-2 for the list of intervals that you can use with the function.
Make sure that the interval is enclosed in double quotes.
8. Enter a ), and press Enter.
The DATEDIF function is not documented, so memorize how to use it or jot
down its syntax and keep it near your computer.
Figure 12-10:
Counting
days,
months, and
years with
DATEDIF.
232
Part III: Doing the Math 

Chapter 13
Keeping Well-Timed Functions
In This Chapter
 Handling time
 Formatting time values
 Working with hours, minutes, and seconds
 Getting the current time
 Calculating elapsed time
E
xcel has a superb handful of functions for working with times and per-
forming calculations on time values. You can analyze data to the hour,
minute, or second. And Excel helps you get this done in a New York minute!
Understanding How Excel Handles Time
In the previous chapter, we explain how Excel uses a serial number system 
to work with dates. Well, guess what? The same system is used to work with
time. The key difference is that, although dates are represented by the inte-
ger portion of a serial number, time is represented by the decimal portion.
What does this mean? Consider this: 38353. That is the serial number repre-
sentation for January 1, 2005. Notice, though, that there is no indication of
the time of day. The assumed time then is 12 a.m. (midnight), the start of the
day. You can, however, represent specific times if needed.
Excel uses the decimal side of the serial number to represent time as a frac-
tion of the 24-hour day. Thus, 12 p.m. (noon) is 0.5 and 6 p.m. is 0.75. Table
13-1 shows some more examples and reveals how dates and time information
are combined in a single serial number.

Table 13-1
How Excel Represents Time
Date and Time
Serial Format
January 1, 2005 12:00 a.m.
38353
January 1, 2005 12:01 a.m.
38353.00069
January 1, 2005 10:00 a.m.
38353.41667
January 1, 2005 12:00 p.m.
38353.5
January 1, 2005 4:30 p.m.
38353.6875
January 1, 2005 10:00 p.m.
38353.91667
January 1, 2005 11:59 p.m.
38353.99931
Time is represented in a decimal value — up to five digits to the right of the
decimal point. A value of 0 is the equivalent of 12 a.m. A value of .5 is the
equivalent of 12 p.m. — the midpoint of the day. The value of .99931 is the
same as the 23rd hour and start of the 59th minute. A value of .99999 is the
same as the 23rd hour, the 59th minute, and the 59th second — in other
words, one second before the start of the next day.
Can you represent time without a date? You bet! Use a value less than 1 for
this purpose. For example, the serial number 0.75 represents 6 p.m. with no
date specified.
Representing time as a serial number provides the same advantages as it
does for dates — the ability to add and subtract times. For example, given a
date/time serial number, you can create the serial number for the date/time
one and a half days later by adding 1.5 to it.
Formatting Time
When you work with time values, you’ll probably need to format cells in your
worksheet so the times display in a standard format that people will under-
stand. The decimal numbers don’t make sense to us human folk. To format
time, you use the Format Cells dialog box, shown in Figure 13-1. To format
time, follow these steps:
1. Choose Format➪Cells.
The Format Cells dialog box appears.
2. Select the Number tab in the Format Cells dialog box, if it is not
already selected.
234
Part III: Doing the Math 

3. Select Time in the Category List.
4. Select an appropriate format in the Type List.
You can display time a number of ways. Excel can format time so that hours
in a day range from 1 a.m. to 12 a.m. and then 1 p.m. to 12 p.m. Alternatively,
the hour can be between 0 and 23 with values 13 through 23 representing 1
p.m. through 11 p.m. The latter system, known to some as military time, is
commonly used in computer systems.
Note that Excel stores a date and time together in a single serial number.
Therefore, some of the formatting options in both the time and date cate-
gories display a complete date and time.
Keeping TIME 
You can use the TIME function to combine hours, minutes, and seconds into
a single usable value. Figuring out the serial number representation of a par-
ticular moment in time isn’t easy. Luckily, the TIME function does this for
you. You provide an hour, minute, and second, and TIME tells you the serial
value. To do this, follow these steps:
1. Select the cell where you want the result displayed.
2. Enter =TIME( to begin the function entry.
3. Click the cell that has the hour (0–23), or enter such a value.
4. Enter a comma ( , ).
5. Click the cell that has the minute (0–59), or enter such a value.
6. Enter a comma ( , ).
Figure 13-1:
Using the
Format Cells
dialog to
specify 
how time 
values are
displayed.
235
Chapter 13: Keeping Well-Timed Functions

7. Click the cell that has the second (0–59), or enter such a value.
8. Enter a ), and press Enter.
The result is a decimal serial number, or a readable time if the cell is for-
matted properly.
You should be aware that the minute and second values “wrap.” A value of 
60 or greater for seconds wraps to the next minute — for example, 75 sec-
onds is interpreted as 1 minute 15 seconds. Likewise, a minutes value of 90 
is interpreted as 1 hour 30 minutes. Hours wrap too — an hours value of 26 
is interpreted as 2 a.m.
Text to Time with TIMEVALUE 
If you enter a time in a standard format into a cell, Excel recognizes it as a
time. It is converted to a serial number and the cell is assigned the default
time format. If, however, you are pasting or importing data from another
application you may encounter times in text format, such as “2:28 PM”. 
You can convert these to a time serial number using the TIMEVALUE function.
Here’s how:
1. Select the cell where you want the result displayed.
2. Enter =TIMEVALUE( to begin the function entry.
3. Click the cell that contains the time in text format.
4. Type ) and press Enter.
If the TIMEVALUE function returns the error code #VALUE#, it probably
means one of two things:
 The time is in a text format that Excel does not recognize, such as
“2:28PM” (no space before PM) instead of “2:28 PM”.
 The time is not actually in text format but is an Excel time serial number
formatted to look that way. Change the cell format to General to check.
Deconstructing Time with HOUR,
MINUTE, and SECOND 
Any moment in time really is a combination of an hour, a minute, and a
second. In the preceding section, we show you how the TIME function puts
these three components together. In this section, we show you how to break
them apart using the HOUR, MINUTE, and SECOND functions. The worksheet
236
Part III: Doing the Math 

in Figure 13-2 shows a date and time in several rows going down Column A.
The same dates and times are shown in Column B, with a different format.
Columns C, D, and E show the hour, minute, and second, respectively, from
the values in Column A.
Note that if the date/time serial number contains a date part, then HOUR,
MINUTE, and SECOND ignore it; all they care about is the time part.
Isolating the hour 
Extracting the hour from a time is useful in applications that tally hourly
events. A common use of this occurs in call centers. If you’ve ever responded
to an infomercial or a pledge drive, you may realize that a group of workers
wait for incoming phone calls such as the one you made (we hope you got a
good bargain). A common metric in this type of business is the number of
calls per hour.
Figure 13-3 shows a worksheet that summarizes calls per hour. Calls have
been tracked for October 2004. The incoming call dates and times are listed
in Column A. In Column B, the hour of each call has been isolated with the
HOUR function. Column D is a summary of calls per hour, over the course of
the month.
Figure 13-3:
Using the
HOUR
function to
summarize
results.
Figure 13-2:
Splitting
time with
the HOUR,
MINUTE,
and
SECOND
functions.
237
Chapter 13: Keeping Well-Timed Functions

In Figure 13-3 the values in Column D are calculated using the COUNTIF func-
tion. There is a COUNTIF for each hour from 10 a.m. through 11 p.m. Each
COUNTIF looks at the range of numbers in Column B (the hours) and counts
the values that match the criteria. Each COUNTIF uses a different hour value
for its criteria. The following is an example:
=COUNTIF($B$3:$B$1002,”=16”)
Here is how to use the HOUR function:
1. Select the cell where you want the result displayed.
2. Enter =HOUR( to begin the function entry.
3. Click the cell that has the full-time (or date/time) entry.
4. Enter a ), and press Enter.
Excel returns a number between 0 and 23.
Isolating the minute 
Isolating the minute part of a time is necessary in applications that track
activity down to the minute. A timed test is a perfect example. Remember in
school when the teacher would yell, “Pencils down”?
Excel can easily calculate how long something takes by subtracting one time
from another. In the case of a test, the MINUTE function helps with the calcu-
lation because how long something took in minutes is being figured out.
Figure 13-4 shows a list of times it took for students to take a test. All stu-
dents started the test at 10 a.m. Then, when each student finished, the time
was noted. The test should have taken a student no more than 15 minutes.
For each data row, Column D contains a formula that subtracts the minute 
in the end time, in Column C, from the start time, in Column B. This math
operation is embedded in an IF statement. If the result is 15 or less, then 
Yes appears in column D; otherwise a No appears:
Figure 13-4:
Calculating
minutes
elapsed
with the
MINUTE
function.
238
Part III: Doing the Math 

=IF(MINUTE(C3)-MINUTE(B3)<=15,”Yes”,”No”)
Like the HOUR function, the MINUTE function takes a single time or date/time
reference as its argument.
Isolating the second 
Isolating the second from a date value is useful in situations where highly
accurate time calculations are needed. In practice, this isn’t a common
requirement in Excel applications.
Follow these steps to use the SECOND function:
1. Position the pointer in the cell where you want the results displayed.
2. Enter =SECOND( to begin the function entry.
3. Click the cell that has the time value, or enter a time value.
4. Enter a closing parenthesis to end the function, and press Enter.
Finding the Time NOW
Sometimes when working in Excel you may need to access the current time.
For example, you may be working on a client project and need to know how
much time you’ve spent on it. Use the NOW function when you first open the
workbook, and use it again when finished. Subtracting one value from the
other provides the elapsed time.
Here’s how to use the NOW function:
1. Select the cell where you want the result.
2. Type in =NOW( ).
3. Press Enter to end the function.
You must take one additional step to make the preceding NOW time calcula-
tion work. When you get the current time at the start, copy the value and
then use Paste Special to paste it back as a value. This strategy prevents it
from updating constantly to the current time. You can also do this by select-
ing the cell, clicking in the Formula Bar, and then pressing F9.
NOW provides not just the current time but also the current date. This is sim-
ilar to the TODAY function. TODAY returns the current date — without the
current time. NOW returns the full current date and time. See Chapter 12 for
more information on the TODAY function.
239
Chapter 13: Keeping Well-Timed Functions

Calculating Elapsed Time over Days
Each day has 24 hours. Multiplying 24 by 7 tells us there are 168 hours in a
week. How many hours are in a month? This is not as easy to tell. A month
may have 28, 29, 30, or 31 days.
Counting elapsed time, in hours, could require a complex algorithm. While
there is no single function in Excel for this task, you can combine a couple of
functions in a formula to get the answer. This is another side benefit of the
fact that Excel represents date/time values as serial numbers. This makes it
easy to calculate the number of hours that have passed between two
date/time values.
Figure 13-5 shows a worksheet with start and end date/time values in two
columns. A third column shows the calculated number of elapsed hours for
each start/end pair.
In Column A and Column B are dates and times. These dates and times are
really just serial numbers with a decimal portion. Using the INT function,
Excel counts the difference in days, even if the span pops over to a new year.
Then the HOUR function is used to calculate the difference of the decimal
portion. The formula for the first row is =(INT(B3)-INT(A3))*24 +
HOUR(B3) - HOUR(A3). Each successive row has the same formula in
Column C but with the cell references pointed to the values on the row. The
first part of the formula calculates the difference in days and multiplies this
by 24 for the total number of hours in the number of days.
The trick is to correctly calculate the time between the start and end values.
The hour portion of both the start and end values is determined with the
HOUR function, and then one value is subtracted from the other. The result 
of this subtraction is added to the precalculated number of hours from the
count of days. Note that minutes are ignored — perhaps you can figure out
how to modify the formula to take seconds into account!
Figure 13-5:
Calculating
elapsed
time.
240
Part III: Doing the Math 

Chapter 14
Using Lookup, Logical, and
Reference Functions
In This Chapter
 Using IF to take a course of action
 Returning a value with CHOOSE
 Applying logic
 Finding where values are
 Looking up values in a table
 Transposing data
D
ecision, decisions! If one of your students gets an 88 on the test, is 
that a B+ or is it an A? If your company’s new product earns at least
$15,000,000 in revenue, how much of a bonus should you give out to the
team? Or do you have to get to $20,000,000 before you do that? How does 
this affect the financial statements?
Excel cannot make decisions for you but it can help you make better deci-
sions. Using functions, such as IF and CHOOSE, you can set up your work-
sheet to chart a course through the possibilities. Hey, things could be worse!
Were it not for Excel, you might have to try the old Ouija board technique.
Excel also can help you find what you’re looking for. Looking for something in
a large, complex worksheet can seem like the old needle-in-a-haystack routine.
It’s okay to admit it. After all, it happens to the best of us! We’re here to help.
In this chapter, we show you a slew of functions that make it easy to look up
information that’s spread around the rows and columns.
Speaking of data, have you ever mistakenly organized your information along
columns and then realized that you were going to run out of room? This a not
a problem anymore. While previous versions of Excel were limited to 256
columns, Excel 2007 lets you have as many as 16,384 columns. Even so, if you
have organized information in rows but then decide it would be better in
columns (or vice versa), the TRANSPOSE function makes the switch easy.

Testing on One Condition
The IF function is like the Swiss Army knife of Excel functions. Really, it is
used in many situations. Often you can use it with other functions, which we
do often in this chapter. IF, structurally, is easy to understand. The function
takes three arguments:
 A test that gives a true or false answer. For example, the test “is the
value in cell A5 equal to the value in cell A8” can have
only two answers, yes or no. In computer talk, that’s true or false. This is
not a calculation, mind you, but a comparison.
 The data to be returned by the IF function if the test is true.
 The data to be returned by the IF function if the test is false.
Sounds easy enough. Here are some examples:
Function
Comment
=IF(D10>D20, 
If the value in D10 is greater than the value in D20, 
D10, D20)
then the value in D10 is returned because the test
is true. If the value in D10 is not greater than —
that is, smaller or equal to — the value in D20,
then the value in D20 is returned. If the values in
D10 and D20 are equal, the test returns false and
the value in D20 is returned.
=IF(D10>D20, 
If the value in D10 is greater than the value in D20,
“Good news!”, 
then the text “Good News!” is returned. 
“Bad news!”)
Otherwise “Bad News!” is returned.
=IF(D10>D20, “”,
If the value in D10 is greater than the value in D20, 
“Bad news!”)
then nothing is returned. Otherwise “Bad News!” is
returned. Note that the second argument is a pair
of empty quotes.
=IF(D10>D20, 
If the value in D10 is greater than the value in D20, 
“Good news!”, “”)
then “Good News!” is returned. Otherwise nothing
is returned. Note that the third argument is 
empty quotes.
An important aspect to note about using IF: letting the second or third argu-
ment return nothing. An empty string is returned, and the best way to do this
is to place two double quote marks together with nothing in the middle. The
result is that the cell containing the IF function remains blank.
242
Part III: Doing the Math 

IF, therefore, lets you set up two results to return — one for when the test is
true and another for when the test is false. Each result can be a number,
some text, a function or formula, or even blank.
As seen in the previous example, a common use of IF is to see how two values
compare to each other and return either one value or the other, depending
on how you set up the test in the first argument.
IF is often used as a validation check to avoid errors. For example, suppose
you have a financial worksheet that uses a variable percentage in its calcula-
tions. The user must enter this percentage each day, but it must never be
greater than 10 percent. To avoid the chance of errors, you could use the IF
function to display an error message in the adjacent cell if you mistakenly
enter a value outside the permitted range. Assuming the percentage is
entered in cell A3, here’s the required IF function:
=IF(A3>.1, “ERROR - % in A3 TOO LARGE”, “”)
Figure 14-1 shows how IF can be put to good use in a business application. A
fictitious store shop — Ken’s Guitars (kinda snappy, don’t you think?) —
keeps tabs on inventory in an Excel worksheet.
Column D shows the inventory levels, and Column E shows the reorder
levels. It works this way: When a product’s inventory level is the same or less
than the reorder level, it is time to order more of the product. (We don’t know
about you, but we love the thought of being surrounded by a bunch of
Stratoblasters!) The cells in column F contain a formula. 
The formula in cell F8 is =IF(D8<=E8,”ORDER”,””). It says that if the
number of Stratoblaster 9000 guitars in stock is the same or less than the
reorder level, then return Order. If the number in stock is greater than the
reorder level, then nothing is returned. Nothing is returned because three are
in stock and the reorder level is two. In the next row, the number of Flying Xs
is equal to the reorder level; therefore, cell F9 displays Order.
Figure 14-1:
Keeping 
an eye on
inventory at
the guitar
shop.
243
Chapter 14: Using Lookup, Logical, and Reference Functions

Using IF is easy:
1. Enter two values in a worksheet.
These values should have some meaning to you, such as the inventory
levels example in Figure 14-1.
2. Click the cell where you want the result to appear.
3. Enter =IF( to start the function.
4. Decide what test you want to perform.
You can see whether the two values equal each other; whether one is
larger than the other; whether subtracting one from the other is greater
than, equal to, or less than 0; and so on. For example, to determine
whether the first value equals the second value, click the first cell (or
enter its address), enter an equal sign (=), and then click the second cell
(or enter its address).
5. Enter a comma ( , ).
6. Enter the result that should appear if the test is true.
For example, enter “The values are equal”. Remember, text must be
enclosed in quotes.
7. Enter a comma ( , ).
8. Enter the result that should appear if the test is false.
For example, enter “The values are not equal”.
9. Enter a ), and press Enter.
The IF function can do a whole lot more. Nested IF functions give you a lot
more flexibility in performing tests on your worksheet data. A bit of persever-
ance is necessary to get through this. Nested means that you can place an IF
function inside another IF function. That is, the inner IF is placed where the
true or false argument in the outer IF goes (or even use internal IFs for both
of the arguments). Why would you do this?
The other night we were deciding where to go out for dinner. We were consid-
ering Italian, and decided that if we went to an Italian place, and it served man-
icotti, then we would have manicotti. Otherwise, we decided to just eat pizza.
Logically, this decision looks like this:
If the restaurant is Italian, then
If the restaurant serves manicotti, then
we will have manicotti
else
we will have pizza
244
Part III: Doing the Math 

This looks a lot like programming code. We have left out the End If
statements on purpose to avoid confusion because the IF function has no
equivalent value.
That’s it! Make note that the inner IF statement has a result for both the true
and false possibilities. The outer IF does not. Here is the structure of this as
nested Excel IF statements: =IF(Restaurant=Italian, IF(Restaurant
serves manicotti, “manicotti”, “pizza”), “”). If the restaurant
were not Italian, then it wouldn’t matter what we ate (as indicated by the
third argument of the outer IF being empty).
You can nest up to 64 IF statements, although things are likely to get very
complicated once you go beyond 4 or 5.
You can apply a nested IF statement to increase the sophistication of the
inventory worksheet from Figure 14-1. Figure 14-2 has an additional column —
Hot Item. A Hot Item can take three forms:
 If the inventory level is half or less of the reorder level and the last order
date is within the last 30 days, then this is a Hot Item. The point of view
is that in 30 days or less the stock sold down to half or less than the
reorder level. This means the inventory is turning over at a fast pace.
 If the inventory level is half or less of the reorder level and the last order
date is within the last 31–60 days, then this is a Warm Item. The point of
view is that in 31–60 days the stock sold down to half or less than the
reorder level. This means the inventory is turning over at a medium pace.
 If neither of the preceding two conditions is met, the item is not
assigned any special status.
There are Hot Items and there are Warm Items. They both must meet the
common criterion that the inventory is 50 percent or less of the reorder level.
Figure 14-2:
Looking 
for hot
inventory
items.
245
Chapter 14: Using Lookup, Logical, and Reference Functions

Only after this first condition is met does the second criterion — the number
of days since the last order — come into play. Sounds like a nested IF to us!
Here is the formula in cell G9: 
=IF(D9<=(E9×0.5),IF(NOW()-C9<=30,”HOT!”,IF(NOW()-
C9<=60,”Warm!”,””)),””).
Okay, take a breath. We leave no Excel user behind! The outer IF tests of the
inventory in column D is equal to or less than half (50 percent) of the reorder
level. The piece of the formula that does that is =IF(D9<=(E9×0.5). This
test, of course, produces a true or false answer. If it is false, then the false
part of the outer IF is taken (which is just an empty string found at the end 
of the formula: ,””)).
That leaves the whole middle part to wade through. Stay with it! If the first
test is true, then the true part of the outer IF is taken. It just so happens that
this true part is another IF function:
IF(NOW()-C9<=30,”HOT!”,IF(NOW()-C9<=60,”Warm!”,””))
The first argument of the inner IF tests whether the number of days since the
last order date (in column C) is less than or equal to 30. You do this by sub-
tracting the last order date from today, as obtained from the NOW function.
If the test is true, and the last order date is within the last 30 days, then HOT!
is returned. A hot seller indeed! If the test is false then . . . wait, what’s this?
Another IF function! Yes: an IF inside an IF inside an IF. If the number of days
since the last order date is greater than 30, then the next nested IF tests
whether the number of days is within the last 60 days: 
IF(NOW()-C9<=60
If this test is true, then Warm! is returned. If the test is false, then nothing is
returned.
A few key points about this triple-level IF statement:
 The IF that tests whether the number of elapsed days is 30 or fewer has
a value to return if true (HOT!) and a value to return for false (whatever
is returned by the next nested IF).
 The outer IF and the innermost IF return nothing when their test is false.
 On the surface, the test for 60 or fewer days also would catch a date that is
30 days or fewer since the last order date! This is not really what is meant
to be. The test should be whether the number of elapsed days is 60 or
fewer but more than 30! You do not have to actually spell it out this way
because the formula got to the point of testing for the 60-day threshold
only because the 30-day threshold already failed. Gotta watch out for
these things!
246
Part III: Doing the Math 

Choosing the Right Value
The CHOOSE function is ideal for converting a value into a literal. In plain-
speak, this means turning a number, such as 4, into a word, such as April.
CHOOSE takes up to 30 arguments. The first argument acts as key to the rest
of the arguments. In fact, the other arguments do not get processed, per se,
by the function. Instead, the function looks at the value of the first argument
and, based on that value, returns one of its other arguments.
The first argument must be, or evaluate to, a number. This number, in turn,
indicates which of the following arguments to return. For example, the follow-
ing returns Two: =CHOOSE(2, “One”, “Two”, “Three”).
The first argument is the number 2. This means that the function will return
the second in the list of arguments following the first argument. But watch
out — this is not the same as returning the second argument! It means to
return the second argument not counting the first one.
Figure 14-3 shows a useful example of CHOOSE. Say you have a column of
months that are in the numerical form (1 through 12). You need to have 
these displayed as the month names (January through December). CHOOSE
to the rescue!
Cells C4:C15 contain formulas with the CHOOSE function. The formula in cell
C4 follows:
=CHOOSE(B4,”January”, “February”, “March”, “April”, “May”,
“June”, “July”, “August”, “September”,
“October”, “November”, “December”)
Cell B4 contains the value 1, so the first argument starting in the list of 
possible returned strings (that is, “January”), is returned.
Figure 14-3:
Choosing
what to see.
247
Chapter 14: Using Lookup, Logical, and Reference Functions

CHOOSE is most often used to return meaningful text that relates to a
number, such as returning the name of a month from its numeric value. 
But CHOOSE is not restricted to returning text strings. You can use it to
return numbers.
Try it yourself! Here’s how:
1. Enter a list of numeric values into a worksheet column.
These values should all be small, such as 1, 2, 3, and so on.
2. Click the cell to the right of the first value.
3. Enter =CHOOSE( to start the function.
4. Click the cell to the left (the one that has the first value). 
Or you can enter its address.
5. Enter a comma ( , ).
6. Enter a list of text strings that each have an association with the 
numbers entered in Step 1. 
Each text string should be in double quotes and separated with commas
(for example, “January”, “February”, “March”).
7. Type a ), and press Enter.
The cell to the right of the first item displays the returned text. 
8. Use the fill handle from the first cell with the formula, and drag the
formula down to all the other cells adjacent to list entries.
Let’s Be Logical
We once worked on a grammar problem that provided a paragraph with no
punctuation and asked that the punctuation be added:
That that is is not that that is not is not that it it is
The answer follows:
That that is, is not that that is not. Is not that it? It is.
So true! That that is, such as an apple, is not that that is not, such as an
orange. (Is your head spinning yet?)
248
Part III: Doing the Math 

NOT
NOT is a logical operator. It is used to reverse a logical value, turning true to
false or false to true.
Enter this formula into a cell:
= 5 + 5 = 10
The result is the word TRUE. Makes sense. The math checks out. Now try this:
=NOT(5 + 5 = 10)
What happens? The word false is returned.
The NOT function provides greater flexibility when designing the test portion
of a SUMIF function (which you read about in Chapter 8). Sometimes it is
easier to define what you want omitted from the sum than to define what you
want included. Figure 14-4 shows an example of how this works. The task is
to sum up all orders except those in June. Column A lists the months and
column C lists the amounts.
Cell C25 calculates the full sum with this formula:
=SUM(C2:C23) 
The total is $4,045.
Figure 14-4:
Being
selective
with
summing.
249
Chapter 14: Using Lookup, Logical, and Reference Functions

On the other hand, the formula in cell C27 is:
{=SUM(IF(NOT(A2:A23=”June”),C2:C23,””))}
This says to sum values in the range C2:C23 only for where the associated
month in column A is not June. 
Note that this formula is an array formula. When entered, the entry was 
completed with Ctrl+Shift+Enter instead of just plain Enter. See Chapter 3 
for more information on array formulas.
AND and OR 
Next are the AND and OR functions. AND and OR both return a single logical
answer — either true or false — based on the values of two or more logical
tests (such as the way IF works):
 The AND function returns true if all the tests are true. Otherwise, false is
returned.
 The OR function returns true if any one or more of the tests is true.
Otherwise, false is returned.
The syntax of both AND and OR is to place the tests inside the function’s
parentheses; the tests themselves are separated by commas. Here is an
example that returns true if the value in cell D10 equals 20 or 30 or 40:
=OR(D10=20,D10=30,D10=40)
Check out how this works. In Figure 14-3, you see how you can use the
CHOOSE function to return the name of a month derived from the number of
the month. That works okay, but what if you type a wrong number or even a
non-numerical value as the first argument in CHOOSE?
As is, the CHOOSE function shown in Figure 14-3 returns the #VALUE! error if
the first argument is a number greater or less than the number of arguments
(not counting the first argument). So, as is, the function only works when the
first argument evaluates to a number between 1 and 12. If only life were that
perfect!
The next best thing, then, is to include a little validation in the function.
Think this through. Both statements must be true:
 The first argument must be greater than 0.
 The first argument must be less than 13.
250
Part III: Doing the Math 

The formula that uses CHOOSE needs a overhaul, and here it is, courtesy of
the AND function:
=IF(AND(B4>0,B4<13),CHOOSE(B4,”January”, “February”,
“March”, “April”, “May”, “June”, “July”,
“August”, “September”, “October”, “November”,
“December”),”That is not a month!”)
Wow, that’s a mouthful (or rather, a cell-full). The CHOOSE function is still
there, but it is nested inside an IF. The IF has a test (which is explained
shortly). If the test returns true, then the CHOOSE function returns the 
name of the month. If the IF test returns false, then a simple That is not 
a month! message is returned. Figure 14-5 shows this in action.
The test part of the IF function is this:
AND(B4>0,B4<13)
The AND returns true if the value in Cell B4 is both greater than 0 and less
than 13. When that happens, the true part of the IF statement is taken, which
uses the CHOOSE statement to return a month name. Otherwise the “That
is not a month!” statement is displayed. In Figure 14-5 this is just what
happens in cells C9 and C15, which, respectively, look at the data values in
cells B9 and B15.
Can you figure out how to accomplish the same thing using OR instead of
AND? Think for a moment and then look at the answer here:
=IF(OR(B4<1,B4>12),”That is not a month!”,
CHOOSE(B4,”January”, “February”, “March”,
“April”, “May”, “June”, “July”, “August”,
“September”, “October”, “November”,
“December”))
Figure 14-5:
Being
logical
about what
to choose.
251
Chapter 14: Using Lookup, Logical, and Reference Functions

AND returns true when every condition is true. OR returns true when any
condition is true.
Here’s how to use AND or OR:
1. Click a cell where you want the result to appear.
2. Enter either =AND( or =OR( to start the function.
3. Enter one or more logical tests.
A test typically is a comparison of values in two cells or an equation,
such as A1 = B1 or A1 + B1 = C1. Separate the tests with commas.
4. Type a ), and press Enter. 
If you enter the AND function, the result is true if all the tests are true. 
If you enter the OR function, the result is true if at least one of the tests
is true.
Finding Where It Is
You can find a plethora of things with the ADDRESS, ROW, ROWS, COLUMN,
COLUMNS, and OFFSET functions.
ADDRESS 
The ADDRESS function takes a row number and a column number as argu-
ments and returns a standard cell reference (cell address). For example, if
you pass the row number 4 and the column number 3, the function returns
C4. ADDRESS can return an absolute or relative reference in either of Excel’s
two reference formats. Before getting to the details, review the differences
between absolute and relative cell references.
 A relative reference is expressed as just the column letter and row
number (for example, M290). When you copy a formula that contains 
a relative cell reference, the reference — the row number and the
column letter — is adjusted to reflect the location to which you 
copied the formula.
 An absolute reference has a dollar sign in front of the column letter and
the row number (for example, $M$290). When you copy a formula that
contains an absolute cell reference, the reference does not change.
 A partial absolute reference has a dollar sign in front of the column letter
or the row number (for example, $M290 or M$290). When you copy a for-
mula that contains a partial absolute cell reference, the part of the refer-
ence with the dollar sign does not change, but the other part does.
252
Part III: Doing the Math 

Figure 14-6 shows a worksheet in which entering a formula with a completely
relative cell reference causes a problem. Totals are the result of adding the
tax to the amount. The tax is a percentage (0.075) for a 7.5 percent tax rate.
This percentage is in cell C1 and is referenced by the formulas. The first for-
mula that was entered is in cell C7 and looks like this: =B7×(1 + C1).
The formula in cell C7 works correctly. It references cell C1 to calculate the
total. But if you use the fill handle to copy the formula from cell C7 to cells C8
and C9, there’s a problem. The reference to cell C1 changed to cell C2 and C3.
Since these cells are empty, the results in cells C8 and C9 are incorrect —
they are the same as the amounts to the left. (No tax is added.)
To better understand, column D displays the formulas that are in column C.
When the formula in cell C7 was dragged down, the C1 reference changed to
C2 in cell C8, and to C3 in cell C9. Often this is what you want — for Excel to
automatically change cell references when a formula is copied. But some-
times, as in this situation, it is not what you want. You need an absolute cell
reference.
The formula is cell C17 is almost identical to the one in cell C7 except that the
reference to cell C1 has been made row absolute by placing a dollar sign in
front of the row number. The formula in cell C17 looks like this: =B17×(1 +
C$1). When this formula was dragged down into C18 and C19, the reference
was not adjusted but stayed pointing at cell C1. Note that in this example
only the row part of the reference is made absolute. That’s all that is neces-
sary. You could have make the reference completely absolute by doing this:
=B17×(1 + $C$1) and the result would be the same, but it’s not required in
this example.
Put a dollar sign in front of the column letter of a cell reference to create an
absolute column reference. Put a dollar sign in front of the row number to
create an absolute row reference.
Figure 14-6:
Changing a
reference
from relative
to absolute.
253
Chapter 14: Using Lookup, Logical, and Reference Functions

Excel supports two cell reference styles: the good old A1 style and the R1C1
style. You see the A1 style — a column letter followed by a row number —
throughout this book (D4 or B2:B10, for example). The R1C1 style uses a
numerical system for both the row and the column, such as this: R4C10 — 
literally, Row 4 Column 10 in this example. 
Now get back to the ADDRESS function. It takes up to five arguments:
 The row number of the reference.
 The column number of the reference.
 A number that tells the function how to return the reference. The 
default is 1, but can be 
• 1 for full absolute 
• 2 for absolute row and relative column
• 3 for relative row and absolute column
• 4 for full relative
 A value of true or false to tell the function which reference style to use. 
• False uses the R1C1 style. 
• True (the default if omitted) uses the A1 style.
 A worksheet or external workbook and worksheet reference.
Only the first two arguments are required. These are the row number and
column number being addressed. The function returns the specified refer-
ence as text. Table 14-1 shows a few examples of using the ADDRESS function.
Table 14-1
Using the ADDRESS Function
Syntax
Result
Comment
=ADDRESS(5,2)
$B$5
Only the column and row are provided as
arguments. The function returns a full
absolute address.
=ADDRESS
$B$5
When a 1 is used for the third argument, 
(5,2,1)
a full absolute address is returned. 
This is the same as leaving out the third
argument.
=ADDRESS
B$5
When a 2 is used for the third argument, 
(5,2,2)
a mixed reference is returned with the
column relative and the row absolute.
=ADDRESS
$B5
When a 3 is used for the third argument, 
(5,2,3)
a mixed reference is returned with the
column absolute and the row relative.
254
Part III: Doing the Math 

Syntax
Result
Comment
=ADDRESS
B5
When a 4 is used for the third argument, 
(5,2,4)
a full relative reference is returned.
=ADDRESS(5,2,
R5C2
When the fourth argument is false, an 
1,FALSE)
R1C1 style reference is returned.
=ADDRESS(5,2,
R[5]C2
This example tells the function to return 
3,FALSE)
a mixed reference in the R1C1 style.
=ADDRESS(5,2,
Sheet4!$B$5
The fifth argument returns a reference to 
1,,”Sheet4”)
a worksheet or external workbook. This
returns an A1 style reference to cell B5
on Sheet 4.
=ADDRESS(5,2,
Sheet4!R5C2
This returns an R1C1 style reference to 
1,FALSE,
B5 on Sheet 4.
”Sheet4”)
Use ADDRESS this way:
1. Click a cell where you want the result to appear.
2. Enter =ADDRESS( to start the function.
3. Enter a row number, a comma ( , ), and a column number. 
You can also enter references to cells where those values are located.
4. If you want the result to be returned in a mixed or full reference, then
enter a comma (,) and the appropriate number: 2, 3, or 4.
5. If you want the result to be returned in R1C1 style, then enter a
comma ( , ) and enter FALSE.
6. If you want the result to be a reference to another worksheet, 
then enter a comma and put the name of the worksheet in double
quote marks. 
Or, if you want the result to be a reference to an external workbook, 
then enter a comma and enter the workbook name and worksheet name
together. The workbook name goes in brackets, and the entire reference
goes in double quote marks, such as this: “[Book1]Sheet2”.
7. Enter a ), and press Enter.
Instead of directly entering a row number and column number into ADDRESS,
you can enter cell references. However, the values you find in those cells must
evaluate to numbers that can be used as a row number and column number.
255
Chapter 14: Using Lookup, Logical, and Reference Functions

ROW, ROWS, COLUMN, and COLUMNS 
The ADDRESS function is rarely used on its own. Most often it is used as part
of a more complex formula. A useful example of ADDRESS follows the discus-
sion of ROW, ROWS, COLUMN, and COLUMNS.
ROW and COLUMN are passed a reference to a cell or range and return the
row number or the column number, respectively. Sounds simple enough.
These functions take a single optional argument. The argument is a reference
to a cell or range. The function returns the associated row number or column
number. When the reference is a range, it is the first cell of the range (the
upper left) that is used by the function.
ROW and COLUMN are particularly useful when the argument is a name (for 
a named area). When you use ROW or COLUMN without an argument, it
returns the row number or column number of the cell the function is in. What
the point of that is, we don’t know. Here are examples of ROW and COLUMN:
Formula
Result
=ROW(D3)
3
=ROW(D3:G15)
3
=COLUMN(D3)
4
=COLUMN(D3:G15)
4
=ROW(Team_Scores)
The first row of the Team_Scores range
=COLUMN(Team_Scores)
The first column of the Team_Scores range
The ROWS and COLUMNS functions (notice these are now plural), respec-
tively, return the number of rows or the number of columns in a reference:
Formula
Result
=ROWS(Team_Scores)
Number of rows in the Team_Scores range
=COLUMNS(Team_Scores)
Number of columns in the Team_Scores range
Now you are getting somewhere. You can use these functions with ADDRESS
to do something useful. Here’s the scenario: You have a named range in
which the bottom row has summary information, such as averages. You need
to get at the bottom row but don’t know the actual row number. Figure 14-7
shows this situation. The Team_Scores range is B3:C9. Row 9 contains the
average score. You need that value in a calculation, even if another team is
added to the list and the row number changes.
256
Part III: Doing the Math 

Cell B15 uses a combination of ADDRESS, ROW, ROWS, and COLUMN to 
determine the cell address where the average score is calculated. That 
formula follows:
=ADDRESS(ROW(Team_Scores) + ROWS(Team_Scores) - 1,
COLUMN(Team_Scores) + 1)
 ROW returns the row number of the first cell of Team_Scores. That row
number is 3. 
 ROWS returns the number of rows in the named range. That count is 7. 
Adding these two numbers is not quite right. A 1 is subtracted from that total
to give the last row (9). In this example, you need only COLUMN to get the
column number because it understood that the range’s second column is the
column of scores. In other words, you have no idea how many rows the range
has, so ROW and ROWS are both used, but you do know the scores are in the
range’s second column. This tells you that cell C9 contains the average score.
Now what? 
Cell B19 contains an IF that uses the address to perform its calculation:
=IF(ADDRESS(ROW(Team_Scores) + ROWS(Team_Scores) - 1,
COLUMN(Team_Scores) + 1)>100,”Great
Teamwork!”,”Try again”)
The IF function tests whether the average score is greater than 100. If it is,
then the “Great Teamwork!” message is displayed. This test is possible
because the ADDRESS, ROW, ROWS, and COLUMN functions all help give the
IF function the address of the cell where the average score is calculated.
Using ROW, ROWS, COLUMN, or COLUMNS is easy. Here’s how:
1. Click the cell where you want the results to appear.
2. Enter =ROW(, =ROWS(, =COLUMN(, or =COLUMNS( to start the function.
Figure 14-7:
Using
reference
functions to
find a value.
257
Chapter 14: Using Lookup, Logical, and Reference Functions

3. Enter a reference or drag the mouse over an area of the worksheet.
4. Type a ), and press Enter.
Again, these functions are rarely used alone, but are almost always used in a
more complex formula as in the example just presented. 
OFFSET 
The OFFSET function lets you get the address of the cell that is offset from
another cell by a certain number of rows and/or columns. For example, cell
E4 is offset from cell B4 by three columns because it is three columns to the
right. OFFSET takes up to five arguments. The first three are required:
 A cell address or a range address: Named ranges are not allowed here.
 The number of rows to offset: This can be a positive or negative
number. Use 0 for no row offset.
 The number of columns to offset: This can be a positive or negative
number. Use 0 for no column offset.
 The number of rows in the returned range: The default is the number
of rows in the reference range (the first argument).
 The number of columns to return: The default is the number of
columns in the reference range.
If you omit the last two arguments, then OFFSET returns a reference to a
single cell. If you include a value greater than 1 for either or both, then the
function’s return references a range of the specified size with the top-left cell
at the specified offset. 
Figure 14-8 shows some examples of using OFFSET. Columns A through C 
contain a ranking of the states in the U.S. by size in square miles. Column E
shows how OFFSET has returned different values from cells that are offset
from cell A3. Some highlights follow:
 Cell E4 returns the value of cell A3 because both the row and column
offset is set to 0: =OFFSET(A3,0,0).
 Cell E7 returns the value you find in cell A1 (the value also is A1). This is
because the row offset is –2. From the perspective of A3, minus two rows
is row number 1: =OFFSET(A3,-2,0).
 Cell E8 displays an error because OFFSET is attempting to reference a
column that is less than the first column: =OFFSET(A3,0,-2).
 Cell E10 makes use of the two optional OFFSET arguments to tell the
SUM function to calculate the sum of the range C4:C53: =SUM(OFFSET
(A3,1,2,50,1)).
258
Part III: Doing the Math 

Here’s how to use the OFFSET function:
1. Click a cell where you want the result to appear.
2. Enter =OFFSET( to start the function.
3. Enter a cell address or a range of cells.
4. Enter a comma ( , ).
5. Enter the number of rows you want to offset where the function looks
for a value.
This number can be a positive number, a negative number, or just 0 for
no offset.
6. Enter a comma ( ,).
7. Enter the number of columns you want to offset where the function
looks for a value. 
This can be a positive number, a negative number, or just 0 for no offset.
8. Type a ), and press Enter.
OFFSET is another of those functions that can be used alone but is usually
used as part of a more complex formula.
Looking It Up
Excel has a neat group of functions that let you extract data from lists and
tables. What is a table? A table is a dedicated matrix of rows and columns
that collectively form a cohesive group of data. Tables usually have labels in
the top row or the left column that identify the columns and rows of data.
The remainder of the table contains the data itself.
Figure 14-8:
Finding
values using
the OFFSET
function.
259
Chapter 14: Using Lookup, Logical, and Reference Functions

HLOOKUP and VLOOKUP 
The HLOOKUP and VLOOKUP functions extract the data from a particular 
cell in a table. HLOOKUP starts by searching across the first row of the table
to find a value that you specify. When it finds that value, it goes down the
column a specified number of rows and returns the value in the target cell.
VLOOKUP works the same way except that it searches down the first column
of the table and then moves across a specified number of columns.
HLOOKUP takes four arguments; the first three are required:
 The value to find in the top row of the table: This can be text or a
number.
 The address of the table itself: This is either a range address or a
named range.
 The row offset from the top row: This is not a fixed row number but
rather the number of rows relative from the top row.
 A true or false value: If true (or omitted), a partial match is acceptable
for step 1. If false, only an exact match is allowed.
Figure 14-9 shows how HLOOKUP pulls values from a table and displays them
elsewhere in the worksheet. This function is quite useful if you need to print
a report with a dedicated print area and must include some, but not all, of the
data in the table. This example uses the HLOOKUP function to extract the
desired data and display it for printing.
Why not just use a cell reference to the table cell that contains the desired
data? A cell reference will not return the correct data if the table is moved or
if one or more columns are added. With HLOOKUP and VLOOKUP you know
you’ll always get data from the correct column or row.
Figure 14-9:
Using
HLOOKUP to
locate data
in a table.
260
Part III: Doing the Math 

In Figure 14-9 the table is the range B24:H25, which has been assigned the
name Daily_Results. Each cell in the range C6:C12 uses HLOOKUP to locate a
specific value in the table. For example, cell C6 has this formula:
HLOOKUP(“Monday”,Daily_Results,2,FALSE)
 The first argument: Tells the function to search for Monday in the first
row of the table. 
 The second argument: The table itself is specified by its assigned name. 
 The third argument: Tells the function to return the data in the second
row of the specified column. While this table has just two rows, there is
no effective size limit to the table you use with HLOOKUP. 
 The fourth argument: Specifies that an exact match for Monday must be
found. If you set this argument to true or omit it, HLOOKUP finds an
approximate match. For approximate matching to work properly, the
values in the row must be sorted, left to right, in ascending order.
VLOOKUP works in the same way, except that it finds a value in the first
column of the table and then moves over a specified number of columns. 
The arguments follow:
 The value to find in the leftmost column of the table.
 The address of the table itself: This is either a range or a named area.
 The column offset from the leftmost column: This is not a fixed column
number but rather the number of columns relative from the leftmost
column.
 A true or false value: If true (or omitted), VLOOKUP finds an approxi-
mate match. If false, an exact match is required. For an approximate
match, the column must be sorted in ascending order.
Figure 14-10 shows an example of using VLOOKUP. The worksheet displays
products and annual revenue data for the fictitious guitar shop. The range
A8:D39 has been named Sales.
The goal is to use VLOOKUP to extract the sales amount for the Wireless Gig
Kit. However, the product names are in the second column of the Sales range,
and VLOOKUP normally searches in the first column. You can use OFFSET 
to force VLOOKUP to search for Wireless Gig Kit in the second column of 
the range, like the following. This is the formula in cell B3: =VLOOKUP
(“Wireless Gig Kit”,OFFSET(Sales,0,1),3, FALSE).
261
Chapter 14: Using Lookup, Logical, and Reference Functions

Note that the offset specified as the third argument to VLOOKUP is 3. That’s
because the sales figures are in the third column relative to the Products
column, where VLOOKUP is performing its search.
Here’s how to use either HLOOKUP or VLOOKUP:
1. Click a cell where you want the result to appear.
2. Enter either =HLOOKUP( or =VLOOKUP( to start the function.
3. If using 
• HLOOKUP: Enter the value that you want to find in the top row
of the table. 
• VLOOKUP: Enter the value that you want to find in the first
column of the table.
4. Enter a comma ( , ).
5. Enter the range address that defines the table of data, or enter its
name if it has been assigned one.
6. Enter a comma ( , ).
7. If using 
• HLOOKUP: Enter a number to indicate the row of the value 
to return. 
• VLOOKUP: Enter a number to indicate the column of the value 
to return.
Figure 14-10:
Using
VLOOKUP to
locate data
in a table.
262
Part III: Doing the Math 

Remember that the number you enter here is relative to the range or
area defined in the second argument.
8. Optionally, enter a comma ( , ) and FALSE. 
This forces the function to find an exact match for the value entered in
the first argument.
9. Type a ), and press Enter.
Excel also provides the LOOKUP function, which is specialized for returning
values from single-column or single-row ranges. See Excel Help for more infor-
mation on this function.
MATCH 
The MATCH function returns the relative row number or column number of a
value in a table. The key point here is that MATCH returns the relative value
but does not return the value itself.
This function is useful when you need an item’s position. You are not often
interested in this information by itself but may use it in a more complex 
formula. We show you how shortly.
MATCH takes three arguments:
 The value to search for: This can be a number, text, or a logical value.
 Where to look: This is a range spanning a single row or column, or a
named area that comprises a single row or column.
 How the match is to be applied: This argument is optional.
The third argument can be one of three values. They work as follows:
 1 tells MATCH to find the largest value that is less than or equal to the
lookup value. The array must be sorted in ascending order. This is the
default value if the argument is omitted.
 –1 tells MATCH to find the smallest value that is greater than or equal 
to the lookup value. The array must be sorted in descending order.
 0 tells MATCH to find the first value that is an exact match. The array
need not be sorted.
263
Chapter 14: Using Lookup, Logical, and Reference Functions

Figure 14-11 shows the products and revenue for the guitar shop. Note that
the information has been sorted in ascending order according to the Amount
column. The goal is to get a count of how many products have sales less than
$10,000. MATCH makes this easy, as shown in Figure 14-11. This formula is in
cell B4: =MATCH(10000,OFFSET(Sales,0,3,ROWS(Sales),1))-1.
Take this formula apart from the inside out. First, you know that MATCH
needs a reference to the column where it is to search — in this case, the
Amount column in the Sales range. Sounds like a job for OFFSET! Type the 
following:
OFFSET(Sales,0,3,ROWS(Sales),1)
This returns a range that has the following characteristics:
 Offset by no rows and three columns from the Sales range
 Has a height equal to the number of rows in Sales
 Has a width of one column
Now that you have this range, you can tell MATCH to look for the largest
value that is less than or equal to 10000. Because the data is sorted, the 
relative position of this value in the range is one more than the number of
products with sales less than $10,000. Why one more? Because the heading
row at the top of the range is counted too — so you subtract 1 to get the 
final answer.
Figure 14-11:
Making a
match.
264
Part III: Doing the Math 

Here’s how to use the MATCH function:
1. Click a cell where you want the result to appear.
2. Enter =MATCH( to start the function.
3. Enter a value to match.
This can be a numeric, text, or logic value. You can enter a cell address
provided the referenced cell has a usable value.
4. Enter a comma ( , ).
5. Enter the range in which to look for a match.
This can be a range reference or a named area.
6. Optionally, enter a comma ( , ) and enter a –1, 0, or 1 to tell the func-
tion how to make a match.
The default is 1. A 0 forces an exact match.
7. Type a ), and press Enter.
The information returned by MATCH can be helpful when you use it with the
INDEX function. INDEX returns the value found at a specified row and column
intersection within a table. You can use MATCH to find the row and find the
column and then use INDEX to get the actual data.
INDEX takes three arguments: 
 The table to look in as a range address or range name
 The row number relative to the table’s first row
 The column number relative to the table’s leftmost column 
The return value is the value of the cell where the row and column intersect.
Figure 14-12 shows an example where INDEX retrieves a value from a table
that summarizes some guitar-shop sales by product and quarter. The table
range in this example has been named Sales_by_qtr. The following formula, 
in cell C2, extracts the sales for 6 Foot Cables for Qtr 2:
=INDEX(Sales_by_qtr, MATCH(“6 Foot Cables”,
OFFSET(Sales_by_qtr,0,0,ROWS(Sales_by_qtr),1),0
), MATCH(“Qtr 2”, OFFSET(Sales_by_qtr,
0,0,1,COLUMNS(Sales_by_qtr))))
265
Chapter 14: Using Lookup, Logical, and Reference Functions

Wow, that’s quite a cell full of formula! But you already know everything you
need to understand it. The first argument to INDEX is no mystery — it is
simply the name assigned to the table. The second and third arguments,
which tell INDEX what cell to look in, are complicated. Look at the first one,
for the row argument:
MATCH(“6 Foot Cables”, OFFSET(Sales_by_qtr,
0,0,ROWS(Sales_by_qtr),1),0)
You want to look down the table’s first column, where the product names are
listed, and find the row that contains 6 Foot Cables. You also know that
the MATCH function is just right for this job and that the function needs to
know where to look. In other words, you must tell it the address of the table’s
first column. Here is where OFFSET comes into play:
OFFSET(Sales_by_qtr, 0, 0, ROWS(Sales_by_qtr), 1)
This call to OFFSET returns a range address that has the following 
characteristics:
 Is located with reference to the range Sales_by_qtr
 Is offset from Sales_by_qtr by zero rows and zero columns (in 
other words, starts at cell B7)
 Contains the same number of rows as Sales_by_qtr
 Contains one column
The result is that this call to OFFSET returns the range B7:B17. The MATCH
function becomes this, in effect:
MATCH(“6 Foot Cables”, B7:B17, 0)
Because an exact match is requested, the data does not have to be sorted.
MATCH finds the search text in the eighth row relative to the top of the table.
This is the value that INDEX uses for its row argument. The column argument
to INDEX is handled in the same way.
Here’s how to use the INDEX function:
1. Click a cell where you want the result to appear.
2. Enter =INDEX( to start the function.
3. Enter a reference to the table. 
You can drag the mouse over the range or enter its address. If the table
has been named, you can enter the name.
266
Part III: Doing the Math 

4. Enter a comma ( , ).
5. Enter the row number relative to the table’s first row.
This number can be the result of a calculation or the value returned
from a function.
6. Enter a comma ( , ).
7. Enter the column number relative to the table’s leftmost column.
This number can be the result of a calculation or the value returned
from a function.
8. Type a ), and press Enter.
Figure 14-12:
Using
INDEX to
extract data
from a table.
267
Chapter 14: Using Lookup, Logical, and Reference Functions

268
Part III: Doing the Math 

Chapter 15
Digging Up the Facts
In This Chapter
 Getting information about a cell or range
 Finding out about Excel or your computer system
 Testing for numbers, text, and errors
I
n this chapter, we show you how to use Excel’s information functions,
which you use to obtain information about cells, ranges, and the work-
book you’re working in. You can even get information about the computer
you’re using. What will they think of next!?
The information functions are great for getting formulas to focus on just the
data that matters. Some functions even help shield you from Excel’s confus-
ing error messages. The first time we saw the #NAME? error we thought Excel
was asking us to enter a name (just another of the more exciting Excel
moments). Now, at least we know to use the ISERROR or ERROR.TYPE func-
tions to make error messages more meaningful. And after reading this chap-
ter, so will you!
Getting Informed with the CELL Function
The CELL function provides feedback about cells and ranges in a worksheet.
You can find out what row and column a cell is in, what type of formatting it
has, whether it’s protected, and so on.
CELL takes two arguments: 
 The first argument, which is enclosed in double quotes, tells the func-
tion what kind of information to return. 
 The second argument tells the function which cell or range to evaluate.
If you specify a range that contains more than one cell, the function
returns information about the top-left cell in the range. The second argu-
ment is optional; when it isn’t provided, Excel reports back on the most
recently changed cell.

270
Part III: Doing the Math 
Table 15-1 shows the list of possible entries for the first argument of the CELL
function.
Table 15-1
Selecting the First Argument for the CELL Function
Argument
Example
Comment
address
=CELL
Returns the address of the last 
(“address”)
changed cell.
col
=CELL(“col”,
Returns the column number of the 
Sales)
first cell in the Sales range.
color
=CELL(“color”,
Tells whether a particular cell (in this 
B3)
case, cell B3) is formatted in such a
way that negative numbers are repre-
sented in color. The number, cur-
rency, and custom formats have
selections for displaying negative
numbers in red. If the cell is formatted
for color-negative numbers, a 1 is
returned; otherwise, a 0 is returned.
contents
=CELL
Returns the contents of a particular 
(“contents”,B3)
cell (in this case, cell B3). If the cell
contains a formula, returns the result
of the formula and not the formula
itself.
filename
=CELL
Returns the path, filename, and work
(“filename”)
sheet name of the workbook and
worksheet that has the CELL function
in it (for example, C:\Customers\
[Acme Company]Sheet1). Results in a
blank answer in a new workbook that
has not yet been saved.
format
=CELL
Returns a cell’s number format (in 
(“format”,D12)
this case, cell D12). See Table 15-2 for
a list of possible returned values.
parentheses
=CELL
Returns 1 if a cell (in this case,D12)
(“parentheses”,
is formatted to have either positive 
D12)
values or all values displayed with
parentheses. Otherwise, 0 is returned.
A custom format is needed to make
parentheses appear with positive
values in the first place.

Argument
Example
Comment
prefix
=CELL(“prefix”,
Returns the type of text alignment in a 
R25)
cell (in this case, cell R25). There are
a few possibilities: a single quotation
mark (‘) if the cell is left-aligned; a
double quotation mark (“) if the cell is
right-aligned; a carat (^) if the cell is
set to centered; or a backslash(\) if
the cell is fill-aligned. If the cell being
evaluated is blank or has a number,
then the function returns nothing.
protect
=CELL
Returns 1 if a cell’s protection (in this 
(“protect”,D12)
case, cell D12) is set to locked; other-
wise, a 0 is returned. The returned
value is not affected by whether the
worksheet is currently protected.
row
=CELL(“row”,
Returns the row number of the first 
Sales)
cell in the Sales range.
type
=CELL(“type”,
Returns a value corresponding to the 
D12)
type of information in a cell (in this
case, cell D12). There are three possi-
ble values: b if the cell is blank; 1 if
the cell has alphanumeric data; and v
for all other possible values including
numbers and errors.
width
=CELL(“width”)
Returns the width of the last changed
cell, rounded to an integer. For exam-
ple a width of 18.3 is returned as 18.
The second argument, whether it’s there or not, plays a key role in how the
CELL function works. When included, the second argument is either a cell
address, such as B12, or a range name, such as Sales. Of course, you could
have a range that is only one cell, but let’s not confuse the issue!
If you enter a nonexistent range name for the second argument, Excel returns
the #NAME? error. Excel can’t return information about something that doesn’t
exist!
An interesting way to use CELL is to keep track of the last entry on a work-
sheet. Say you’re updating a list of values. The phone rings and you’re tied up
for a while on the call. When you get back to your list, you’ve forgotten where
you left off. Yikes! What a time to think “If only I had used the CELL function!”
271
Chapter 15: Digging Up the Facts

Figure 15-1 shows such a worksheet. Cell B18 displays the address of the last
cell that was changed.
Using CELL with the filename argument is great for displaying the workbook’s
path. This technique is common for printed worksheet reports. Being able to
find the workbook file that a report was printed from six months ago is a real
timesaver. Don’t you just love it when the boss gives you an hour to create a
report, doesn’t look at it for six months, and then wants to make a change?
Here’s how you enter the CELL function to return the filename:
=CELL(“filename”)
You can format cells in many ways. When the first argument to CELL is
format, a code is returned that corresponds to the formatting. The possible
formats are those found in the Format Cells dialog box. Table 15-2 shows the
formats and the code that CELL returns.
Table 15-2
Returned Values for the format Argument
Format
Returned Value from 
CELL Function
General
G
0
F0
#,##0
,0
0.00
F2
Figure 15-1:
Keeping
track of
which cell
had the
latest entry.
272
Part III: Doing the Math 

Format
Returned Value from 
CELL Function
#,##0.00
,2
$#,##0_);($#,##0)
C0
$#,##0_);[Red]($#,##0)
C0-
$#,##0.00_);($#,##0.00)
C2
$#,##0.00_);[Red]($#,##0.00)
C2-
0%
P0
0.00%
P2
0.00E+00
S2
# ?/? or ??/??
G
m/d/yy or m/d/yy h:mm or mm/dd/yy
D4
d-mmm-yy or dd-mmmm-yy
D1
d-mmm or dd-mmm
D2
mmm-yy
D3
mm/dd
D5
h:mm AM/PM
D7
h:mm:ss AM/PM
D6
h:mm
D9
h:mm:ss
D8
Using CELL with the format argument lets you add a bit of smarts to your
worksheet. Figure 15-2 shows an example of CELL making sure information is
correctly understood. The dates in Column A are of the d-mmm format. The
downside of this format is that the year is not known. So, cell A1 has been
given a formula that uses CELL to test the dates’ format. If the d-mmm format
is found in the first date (in cell A4), then cell A1 displays a message that
includes the year from cell A4. After all, cell A4 has a year — it’s just format-
ted not to show it. This way the year is always present — either in the dates
themselves, or at the top of the worksheet.
273
Chapter 15: Digging Up the Facts

The formula in cell A1 — =IF(CELL(“format”,A4)=”D2”,”Receipts
for “&YEAR(A4),”Receipts”) — says that if the formatting in A4 is d-
mmm (according to the values in Table 15-2), then display the message with
the year; otherwise, just display Receipts.
Here’s how to use the CELL function:
1. Position the cursor in the cell where you want the results to appear.
2. Enter =CELL( to begin the function entry.
3. Enter one of the first argument choices listed in Table 15-1.
Make sure to surround it with double quotes (“ ”).
4. If you want to tell the function which cell or range to use, enter a
comma ( , ).
5. If you want, enter a cell address or the name of a range.
6. Enter a ), and press Enter.
Getting Information about Excel 
and Your Computer System
Excel provides the INFO function to get information about your computer and
about the program itself. INFO takes a single argument that tells the function
what type of information to return. Table 15-3 shows how to use the INFO
function.
Figure 15-2:
Using CELL
and the
format
argument to
display a
useful
message.
274
Part III: Doing the Math 

Table 15-3
Using INFO to Find Out about Your Computer or Excel
Argument
Example
Comment
directory
=INFO(“directory”)
Returns the path of the cur-
rent directory. Note that this
is not necessarily the same
path of the open workbook.
memavail
=INFO(“memavail”)
Returns the amount of avail-
able memory in bytes.
memused
=INFO(“memused”)
Returns the amount of
memory, in bytes, being used
at the time the function is
run. The more open applica-
tions and/or files, the higher
the number.
numfile
=INFO(“numfile”)
Returns the number of work-
sheets in all open work-
books. Includes worksheets
of add-ins, so the number
could be misleading.
origin
=INFO(“origin”)
Returns the address of the
cell at the top and to the left
of the scrollable area. An A$
prefix in front of the cell
address is for compatibility
with Lotus 1-2-3.
osversion
=INFO(“osversion”)
Returns the name of the cur-
rent operating system.
recalc
=INFO(“recalc”)
Returns the status of the
recalculation mode: either
Automatic or Manual.
release
=INFO(“release”)
Returns the version number
of Excel being run.
system
=INFO(“system”)
Returns the name of the
operating environment:
either mac or pcdos.
totmem
=INFO(“totmem”)
Returns the sum of the avail-
able memory and the used
memory.
275
Chapter 15: Digging Up the Facts

One useful application of the INFO function is to use the returned Excel ver-
sion number to determine whether the workbook can use a newer feature.
For example, the ability to work with XML data has only been available in
Excel 2002 and later. By testing the version number, you can be notified
whether you can work with XML data. This formula uses the release choice
as the argument:
=IF(INFO(“release”)>9,”This version can import XML”, “This
version cannot import XML”)
Figure 15-3 shows values returned with the INFO function. The information
shows facts about Ken’s computer. Please, no comments on how much
memory he has!
Here’s how to use the INFO function:
1. Position the cursor in the cell where you want the results to appear.
2. Enter =INFO( to begin the function entry.
3. Enter one of the argument choices listed in Table 15-3.
Make sure to surround it with double quotes (" ").
4. Type a ), and press Enter.
Finding What IS and What IS Not
A handful of IS functions report back a true or false answer about certain cell
characteristics — for example, is a cell blank or does it contain text? These
functions are often used in combination with other functions, typically the IF
function, to handle errors or other unexpected or undesirable results.
Figure 15-3:
Getting
facts 
about the
computer
with the
INFO
function.
276
Part III: Doing the Math 

The errors Excel reports are not very friendly. What on earth does #N/A
really tell you? The functions we describe in this section won’t make the
error any clearer, but they give you a way to instead display a friendly mes-
sage like “Something is wrong, but I don’t know what it is.”
Table 15-4 shows the IS functions and how they’re used. They all return either
True or False, so the table just lists them.
Table 15-4
Using the IS Functions to See What Really Is
Function
Comment
=ISBLANK(value)
Tells whether a cell is blank.
=ISERR(value)
Tells whether a cell contains any error other
than #N/A.
=ISERROR(value)
Tells whether a cell contains any error.
=ISLOGICAL(value)
Tells whether value is logical.
=ISNA(value)
Tells whether a cell contains the #N/A error.
=ISNONTEXT(value)
Tells whether a cell contains a number or
error.
=ISNUMBER(value)
Tells whether a cell contains a number.
=ISREF(value)
Tells whether value is a reference.
=ISTEXT(value)
Tells whether a cell contains text.
ISERR, ISERROR, and ISNA 
Three of the IS functions — ISERR, ISERROR, and ISNA — tell you about an error.
Error Function
Comments
ISERR
Returns true if the error is anything
except the #N/A error. For example, the
#DIV/0! error returns true.
ISNA
The opposite of ISERR. It only returns
true if the error is #N/A.
ISERROR
Returns true for any type of error. This
includes #N/A, #VALUE!, #REF!,
DIV/0!, #NUM!, #NAME?, and #NULL!.
277
Chapter 15: Digging Up the Facts

Why is #N/A treated separately? It is excluded from being handled with ISERR
and has its own ISNA function. Actually, you can use #N/A to your advantage
to avoid errors. How so? Figure 15-4 shows an example that calculates the
percentage of surveys returned for some of Florida’s larger cities. The calcu-
lation is simple — just divide the returned number by the number sent.
However, errors do creep in. (Creepy errors, yuck!) For example, no surveys
were sent to Gainesville, yet 99 came back. Interesting! The calculation
becomes a division by zero error, which makes sense. On the other hand,
Tallahassee had no surveys sent, but here the returned value is the #N/A
error, purposely entered. Next, look at Column E. In this column, True or
False is returned to indicate whether the calculation, per city, should be
considered an error — Gainesville true, Tallahassee false.
true or false appears in Column E because all the cells in Column E use the
ISERR function. The formula in cell E13, which tests the calculation for
Tallahassee, is =ISERR(D13).
Simply put, D13 displays the #N/A error because its calculation (=C13/B13)
uses a cell with an entered #N/A. The ISERR does not consider #N/A to be an
error; therefore, E13 returns False. The upshot to all this is that eyeballing
Column E makes distinguishing entry and math errors from purposeful flag-
ging of certain rows as having incomplete data easy.
ISBLANK, ISNONTEXT, ISTEXT, 
and ISNUMBER 
The ISBLANK, ISNONTEXT, ISTEXT, and ISNUMBER functions tell you what
type of data is in a cell. 
Error Function
Comments
ISBLANK
Returns true if the cell is empty. Returns
false otherwise.
Figure 15-4:
Putting an
error to your
advantage.
278
Part III: Doing the Math 

Error Function
Comments
ISNONTEXT
Returns true if the cell contains anything
that is not text: a number, a date/time, or
an error. Also returns true if the cell is
blank. Returns false if the cell contains
text or a formula whose result is text.
ISTEXT
The opposite of ISNONTEXT: Returns
true if the cell contains text or a formula
whose result is text. Returns false 
otherwise.
ISNUMBER
Returns true if the cell contains a number
or a formula whose result is a number.
Returns false otherwise.
ISBLANK returns true when nothing is in a cell. Using ISBLANK is useful to
count how many cells in a range are blank. Perhaps you’re responsible for
making sure that 200 employees get their timesheets in every week. You can
use a formula that lets you know how many employees have not yet handed
in their hours.
Such a formula uses ISBLANK along with the IF and SUM functions, like this:
{=SUM(IF(ISBLANK(B5:B204),1,0))}
This formula makes use of an array. See Chapter 3 for more information on
using array formulas. Figure 15-5 shows how this formula works. In columns
A and B are long lists of employees and their hours. The formula in cell A1
reports how many employees are missing their hours.
Figure 15-5:
Calculating
how many
employees
are missing
an entry.
279
Chapter 15: Digging Up the Facts

ISTEXT returns True when a cell contains any type of text. ISNONTEXT
returns True when a cell contains anything that is not text, including num-
bers, dates, and times. The ISNONTEXT function also returns True if the cell
contains an error.
The ISNUMBER function returns True when a cell contains a number, which
can be an actual number or a number resulting from evaluation of a formula
in the cell. You can use ISNUMBER as an aid to help data entry. Say you
designed a worksheet that people fill out. One of the questions is age. Most
people would enter a numeric value such as 18, 25, 70, and so on. But some-
one could type in the age as text, such as eighteen, thirty-two, or “none of
your business.” An adjacent cell could use ISNUMBER to return a message
about entering the numeric age. The formula would look something like this:
=IF(ISNUMBER(B3),””,”Please enter your age as a number”)
Here’s how to use any of the IS functions:
1. Position the cursor in the cell where you want the results to appear.
2. Enter one of the IS functions. 
For example, enter =ISTEXT( to begin the function entry.
3. Enter a cell address.
4. Enter a ), and press Enter.
The result is always either True or False.
Getting to Know Your Type
The TYPE function tells you what the type of the information is. Possible
types follow:
 Number
 Text
 A logical value
 An error 
 An array
280
Part III: Doing the Math 

In all cases TYPE returns a number:
 1 is returned for numbers.
 2 is returned for text.
 4 is returned for logical values.
 16 is returned for errors.
 64 is returned for arrays.
Figure 15-6 shows each of these values returned by the TYPE function. Cells
B3:B7 contain the TYPE function, with each row looking at the adjacent cell in
Column A. The returned value of 64 in cell B7 is a little different. This indi-
cates an array as the type. The formula in cell B7 is =TYPE(A7:A9). This is
an array of values from cells A7:A9.
Here’s how to use the TYPE function:
1. Position the cursor in the cell where you want the results to appear.
2. Enter =TYPE( to begin the function entry.
3. Enter a cell address, or click a cell.
4. Enter a ), and press Enter.
The ERROR.TYPE function returns a number that corresponds to the particu-
lar error in a cell. Table 15-5 shows the error types and the returned numbers.
Table 15-5
Getting a Number of an Error
Error Type
Returned Number
#NULL!
1
#DIV/0!
2
(continued)
Figure 15-6:
Getting the
type of the
data.
281
Chapter 15: Digging Up the Facts

Table 15-5 (continued)
Error Type
Returned Number
#VALUE!
3
#REF!
4
#NAME?
5
#NUM!
6
#N/A
7
The best thing about the ERROR.TYPE function is that you can use it to
change those pesky errors into something readable! To do this, use the
CHOOSE function along with ERROR.TYPE, like this:
=CHOOSE(ERROR.TYPE(H14),”Nothing here!”,”You can’t divide
by 0”,”A bad number has been entered”, “The
formula is referencing a bad cell or
range”,”There is a problem with the
entry”,”There is a problem with the entered
value”,”Something is seriously wrong!”)
See Chapter 14 for assistance on using the CHOOSE function. This is how you
use the ERROR.TYPE function:
1. Position the cursor in the cell where you want the results to appear.
2. Enter =ERROR.TYPE( to begin the function entry.
3. Enter a cell address, or click a cell.
4. Type a ), and press Enter.
282
Part III: Doing the Math 

Part IV
Working with Data

In this part . . .
W
e show you a variety of functions that work with
dates and times, looking up values, getting infor-
mation about your information, and manipulating text. We
show you how to calculate how long something will take.
Excel even has a function that counts elapsed days but
knows not to count the weekends. How cool is that!? We
show you how to determine what day of the week a date
is. In this part is the notable IF function, an Excel work-
horse. Got a lot of data on a worksheet? The Excel lookup
and database functions make it easy to find a needle in
that haystack! Finally, several functions work with text.
What for, you ask? Ever need to go from last name first to
first name last? We show you how. How about finding a
piece of text inside a larger one? Another no-brainer with
Excel on your side.

Chapter 16
Writing Home about 
Text Functions
In This Chapter
 Assembling, altering, and formatting text
 Figuring out the length of text
 Comparing text
 Searching for text
A
rose is still a rose by any other name. Or maybe not, when you use
Excel’s sophisticated text-manipulation functions to change it into
something else. Case in point: You can use the REPLACE function to change a
rose into a tulip or a daisy, literally!
Did you ever have to work on a list where people’s full names are in one
column but you need to use only their last names? You could extract the last
names to another column manually, but that strategy gets pretty tedious for
more than a few names. What if the list contains hundreds of names? This is
just one example of text manipulations that you can easily and quickly do
with Excel’s text functions.
Breaking Apart Text
Excel has three functions that are used to extract part of a text value (often
referred to as a string). The LEFT, RIGHT, and MID functions let you get to the
parts of a text value that their name implies, extracting part of a text value
from the left, the middle, or the right. Mastering these functions gives you the
power to literally break text apart.

286
Part IV: Working with Data 
How about this: You have a list of codes of inventory items. The first three
characters are the vendor ID and the other characters are the part ID. You
need just the vendor IDs. How do you do this? Or how do you get the part
numbers not including the vendor IDs? Excel functions to the rescue!
Bearing to the LEFT
The LEFT function lets you grab a specified number of characters from the
left side of a larger string. All you do is tell the function what or where the
string is and how many characters you need to extract.
Figure 16-1 demonstrates how the LEFT function isolates the vendor ID in a
hypothetical product code list (Column A). The vendor ID is the first three
characters in each product code. You want to extract the first three charac-
ters of each product code and put them in column B. You put the LEFT func-
tion in Column B with the first argument, specifying where the larger string is
(Column A) and you put the second argument, specifying how many charac-
ters to extract (three). See Figure 16-1 for an illustration of this worksheet
with the LEFT formula visible in the Formula Bar. (What’s Column C in this
worksheet? We get to that in the next section.)
What if you ask LEFT to return more characters than the entire original 
string contains? No problem. In this case, LEFT simply returns the entire 
original string. The same is true for the RIGHT function, explained in the 
next section.
Figure 16-1:
Getting the
three left
characters
from a
larger
string.

Try it yourself! The LEFT function is really handy and yet so easy to use!
1. Position the cursor in the cell where you want the extracted string 
displayed.
2. Enter =LEFT( to start the function.
3. Click the cell containing the original string, or enter its address.
4. Enter a comma ( , ).
5. Enter a number.
This number tells the function how many characters to extract from the
left of the larger string. If you enter a number that is equal to or larger than
the number of characters in the string, then the whole string is returned.
6. Type a ), and press Enter.
Swinging to the RIGHT
Excel does not favor sides. Because there is a LEFT function, there also is
RIGHT function. RIGHT extracts a certain number of characters from the right
of a larger string. It works pretty much the same way as the LEFT function.
Column C of Figure 16-1 uses the RIGHT function to extract the rightmost four
characters from the product codes. Cell C4, for example, has this formula:
=RIGHT(A4,4).
Here’s how to use the RIGHT function:
1. Position the cursor in the cell where you want the extracted string 
displayed.
2. Enter =RIGHT( to start the function.
3. Click the cell containing the original string, or enter its address.
4. Enter a comma ( , ).
5. Enter a number.
This number tells the function how many characters to extract from the
right of the larger string. If you enter a number that is equal to or larger
than the number of characters in the string, then the whole string is
returned.
6. Type a ), and press Enter.
287
Chapter 16: Writing Home about Text Functions

Use LEFT and RIGHT to extract characters from the start or end of a text
string. Use MID to extract characters from the middle.
Staying in the MIDdle
MID is a powerful text extraction function. It lets you pull out a portion of a
larger string— from anywhere within the larger string. The LEFT and RIGHT
functions allow you to extract from the start or end of a string but not the
middle. MID gives you essentially complete flexibility.
MID takes three arguments: the larger string (or a reference to one); the char-
acter position to start at; and how many characters to extract. Here’s how to
use MID:
1. Position the cursor in the cell where you want the extracted string 
displayed.
2. Enter =MID( to start the function.
3. Click the cell that has the full text entry, or enter its address.
4. Enter a comma ( , ).
5. Enter a number to tell the function which character to start the extrac-
tion from.
This number can be anything from 1 to the full count of characters of
the string. Typically the starting character position used with MID is
greater than 1. Why? If you need to start at the first position, you may as
well use the simpler LEFT function. If you enter a number for the starting
character position that is greater than the length of the string, then
nothing is returned.
6. Enter a comma ( , ).
7. Enter a number to tell the function how many characters to extract.
If you enter a number that is greater than the remaining length of the
string, then the full remainder of the string is returned. For example, if
you tell MID to extract characters 2 through 8 of a six-character string,
then MID returns characters 2 through 6.
8. Type a ), and press Enter.
288
Part IV: Working with Data 

Here are some examples of how MID works:
Example
Result
=MID(“APPLE”,4,2)
LE
=MID(“APPLE”,4,1)
L
=MID(“APPLE”,2,3)
PPL
=MID(“APPLE”,5,1)
E
Figure 16-2 shows how the MID function helps isolate the fourth and fifth
characters in the hypothetical inventory shown in Figure 16-1. These charac-
ters could represent a storage-bin number for the inventory item. The MID
function makes it easy to extract this piece of information from the larger
product code.
Finding the long of it with LEN 
The LEN function returns a string’s length. It takes a single argument — the
string being evaluated. LEN is often used with other functions such as LEFT
or RIGHT.
Manipulating text sometimes requires a little math. For example, you may need
to calculate how many characters to isolate with the RIGHT function. A common
configuration of functions to do this is RIGHT, SEARCH, and LEN, like this:
=RIGHT(A1,LEN(A1)- SEARCH(“ “,A1))
Figure 16-2:
Using MID
to pull out
characters
from any
position in a
string.
289
Chapter 16: Writing Home about Text Functions

This calculates the number of characters to return as the full count of charac-
ters less the position where the space is. Used with the RIGHT function, this
returns the characters to the right of the space.
The LEN function is often used with other functions, notably LEFT, RIGHT,
and MID. In this manner, LEN helps determine the value of an argument to the
other function.
Here’s how to use LEN:
1. Position the cursor in the cell where you want the results to appear.
2. Enter =LEN( to begin the function.
3. Perform one of these steps:
• Click a cell that contains text
• Enter the cell’s address
• Enter a string, enclosed in double quotation marks
4. Type a ), and press Enter.
Putting Text Together 
with CONCATENATE
The CONCATENATE function pulls multiple strings together into one larger
string. A good use of this is when you have a column of first names and a
column of last names and need to put the two together to use as full names.
CONCATENATE takes up to 255 arguments. Each argument is a string or a cell
reference, and the arguments are separated by commas. The function does
not insert anything, such as a space, between the strings. If you need to sepa-
rate the substrings, as you would with the first name and last name example,
you must explicitly insert the separator. Figure 16-3 makes this clear. You can
see that the second argument to the CONCATENATE function is a space.
In Figure 16-3, the full names displayed in Column C are concatenated from
the first and last names in Columns A and B, respectively. In the function’s
arguments, enter a space between the references to cells in columns A and B.
You enter a space by enclosing a space between double quotation marks, like
this: “ “.
290
Part IV: Working with Data 

There is another way to concatenate strings. You can use the ampersand (&)
character instead and skip using CONCATENATE altogether. For example,
another way to create the full names seen in Figure 16-3 is by entering the fol-
lowing formula in the target cell: =A3 & “ “ & B3. Either method gets the
job done. There really is no compelling reason to use one over the other —
it’s up to you, empowered user!
You can give this a whirl on your own. Surely, you must have a list of names
somewhere in an Excel workbook. Open that workbook, or at least enter first
names and last names on your own, and then do the following:
1. Position the cursor in an empty column, in the same row as the first
text entry, and enter =CONCATENATE( to start the function.
2. Click the cell that has the first name, or enter its address.
3. Enter a comma ( , ).
4. Enter a space inside double quotation marks.
It should look like this: “ “.
5. Enter a comma ( , ).
6. Click the cell that has the last name, or enter its address.
7. Type a ), and press Enter.
8. Use the fill handle to drag the function into the rows below, as many
rows as there are text entries in the first column.
You can combine text strings two ways: use the CONCATENATE function or
use the ampersand (&) operator.
Figure 16-3:
Putting
strings
together
with
CONCAT-
ENATE.
291
Chapter 16: Writing Home about Text Functions

Changing Text
There must be a whole lot of issues around text. We say that because a whole
lot of functions let you work with text. There are functions that format text,
replace text with other text, and clean text. (Yes, text needs a good scrubbing
at times.) There are functions for just making lowercase letters into capitals
and capital letters into lowercase.
Making money
Formatting numbers as currency is a common need in Excel. The Format
Cells dialog box or the Currency Style button on the Formatting toolbar are
the usual places to go to format cells as currency. Excel also has the DOLLAR
function. On the surface, DOLLAR seems to do the same thing as the similar
currency formatting options but has some key differences:
 DOLLAR converts a number to text. This means you cannot perform
math on a DOLLAR value. For example, a series of DOLLAR amounts
cannot be summed into a total.
 DOLLAR displays a value from another cell. As its first argument,
DOLLAR takes a cell address or a number entered directly into the func-
tion. DOLLAR is handy when you want to preserve the original cell’s for-
matting. In other words, you may need to present a value as currency in
one location but also to let the number display in its original format in
another location. DOLLAR lets you take the original number and present it
as currency in another cell — the one you place the DOLLAR function in.
 DOLLAR includes a rounding feature. DOLLAR has a bit more muscle
than the currency style. DOLLAR takes a second argument that specifies
how many decimal places to display. When negative values are entered
for the second argument, this serves to apply rounding to the digits on
the left side of the decimal.
Figure 16-4 shows how the DOLLAR function can display various numeric
values just the way you want. At the bottom of the worksheet is an area of
detailed revenues. At the top is a summary that uses DOLLAR.
Unless a cell has been formatted otherwise, you can tell the type of entry by
alignment. Text aligns to the left; numbers, to the right. 
292
Part IV: Working with Data 

Specifically, the cells in the range C5:D7 use the DOLLAR function to present
values from the detail area and also round them down to no decimals. For
example, cell C5 contains =DOLLAR(G15,0). The grand total in cell C9 takes
advantage of DOLLAR to round to the nearest 1,000. In this case the second
argument is set to –3, like this: =DOLLAR(G25+G30,-3). Here are examples
of how the rounding feature works:
Example
Result
=DOLLAR(1234.56,2)
$1,234.56
=DOLLAR(1234.56,1)
$1,234.6
=DOLLAR(1234.56,0)
$1,235
=DOLLAR(1234.56,-1)
$1,230
=DOLLAR(1234.56,-2)
$1,200
=DOLLAR(1234.56,-3)
$1,000
Using DOLLAR is easy:
1. Position the cursor in the cell where you want the results to appear.
2. Enter =DOLLAR( to begin the function entry.
3. Click a cell that contains a number, or enter a number.
4. Enter a comma ( , ).
Figure 16-4:
Using
DOLLAR to
round
numbers
and format
them as
currency.
293
Chapter 16: Writing Home about Text Functions

5. Enter a number to indicate the number of decimal points to display.
If the number is 0, then no decimal points are displayed. Numbers less
than 0 force rounding to occur to the left of the decimal point.
6. Type a ), and press Enter.
The DOLLAR function is named DOLLAR in countries that use dollars, such as
the United States and Canada. In versions of Excel designed for countries that
use a different currency, the name of the function should match the name of
the currency.
Turning numbers into text
The TEXT function is a bit like the DOLLAR function in that it converts a
number value to text data, but it gives you more result formatting options.
TEXT can format numbers as currency, like DOLLAR, but is not limited to this.
The first TEXT argument is a number or reference to a cell that contains a
number. The second argument is a formatting pattern that tells the function
how to format the number. You can see some formatting patterns in the
Custom category, on the Number tab, in the Format Cells dialog box (shown
in Figure 16-5).
Excel lets you create custom formatting patterns so you can present your
data just the way you need to. For example, you can specify whether num-
bers use a thousands separator, whether decimal values are always displayed
to the third decimal point, and so on.
Figure 16-5:
Formatting
options in
the Format
Cells dialog
box.
294
Part IV: Working with Data 

These patterns are created with the use of a few key symbols. A pound sign (#)
is a placeholder for a number — that is, a single digit. Interspersing pound signs
with fixed literal characters (such as a dollar sign, a percent sign, a comma, or a
period) establishes a pattern. For example, this pattern — $#,###.# — says to
display a dollar sign in front of the number, to use a comma for a thousands sep-
arator, and to display one digit to the right of the decimal point. Some format-
ting options used with the TEXT function are shown in Table 16-1. Look up
custom number formatting in Excel Help for more information on custom format
patterns, or go to www.microsoft.com and search for guidelines for custom
number formats.
Table 16-1
Formatting Options for the TEXT Function
Format
Displays
=TEXT(1234.56,”#.##”)
1234.56
=TEXT(1234.56,”#.#”)
1234.6
=TEXT(1234.56,”#”)
1235
=TEXT(1234.56,”$#”)
$1235
=TEXT(1234.56,”$#,#”)
$1,235
=TEXT(1234.56,”$#,#.##”)
$1,234.56
=TEXT(0.4,”#%”)
40%
=TEXT(“3/15/2005”,”mm/dd/yy”)
03/15/05
=TEXT(“3/15/2005”,”mm/dd/yyyy”)
03/15/2005
=TEXT(“3/15/2005”,”mmm-dd”)
Mar-15
Figure 16-6 shows how the TEXT function is used to format values that are
incorporated into sentences. Column C contains the formulas that use TEXT.
For example, C4 has this formula: =”We spent “ & TEXT(B4,”$#,#.#0”)
& “ on “ & A4. Cell C8 has this formula: =”We opened the office on
“ & TEXT(B8,”mmm d, yyyy”).
Figure 16-6:
Using TEXT
to report in
a well-
formatted
manner.
295
Chapter 16: Writing Home about Text Functions

Here’s how to use TEXT:
1. Position the cursor in the cell where you want the results to appear.
2. Enter =TEXT( to begin the function entry.
3. Click a cell that contains a number or a date, or enter its address.
4. Enter a comma ( , ).
5. Enter a ", and then enter a formatting pattern.
See the Format Cells dialog box (in the Custom category on the Number
tab) for guidance.
6. Enter a " after the pattern is entered.
7. Type a ), and press Enter.
The VALUE function does the opposite of TEXT — it converts strings to num-
bers. (This is not to say text such as twenty, but numbers that have been
formatted as text.) Excel does this by default anyway, so we don’t cover the
VALUE function here. You can look it up in Excel’s Help system if you’re curi-
ous about it.
Repeating text
REPT is a nifty function that does nothing other than repeat a string of text.
REPT has two arguments:
 The string or a reference to a cell that contains text
 The number of times to repeat the text
REPT makes it a breeze to enter a large number of repeating characters.
Figure 16-7 shows how this works. Cells B14 and B15 contain important sum-
mary information. To make this stand out, a string of asterisks (*) has been
place above and below, respectively, in B13 and B16. The REPT function was
used here, with this formula: =REPT(“*”,120). This simple function has
removed the drudgery of having to enter 120 asterisks.
Try it out:
1. Position the cursor in the cell where you want the results to appear.
2. Enter =REPT( to begin the function entry.
3. Either click a cell that contains text, or enter text enclosed in double
quotation marks.
296
Part IV: Working with Data 

Typically, you would enter a character (such as a period or an asterisk),
but any text will work.
4. Enter a comma ( , ).
5. Enter a number to tell the function how many times to repeat the text.
6. Type a ), and press Enter.
Swapping text 
Two functions — REPLACE and SUBSTITUTE — replace a portion of a string
with other text. The functions are nearly identical in concept but are used in
different situations.
Both REPLACE and SUBSTITUTE replace text within other text. Use REPLACE
when you know the position of the text you want to replace. Use SUBSTITUTE
when you don’t know the position of the text you want to replace.
REPLACE 
REPLACE takes four arguments:
 The target string as a cell reference
 The character position in the target string at which to start replacing
 The number of characters to replace
 The string to replace with (does not have to be the same length as the
text being replaced)
For example, if cell A1 contains the string Our Chicago office has
closed., then the formula =REPLACE(A1,5,7,”Dallas”) returns the
string Our Dallas office has closed.
Figure 16-7:
Repeating
text with 
the REPT
function.
297
Chapter 16: Writing Home about Text Functions

Check out how to use REPLACE with the Inventory Control data from earlier
in the chapter, shown in Figure 16-8. A new task is at hand. To be compatible
with a new computer system, you have to modify the product codes with a
dash between the vendor ID and the internal tracking number. The original
codes are in Column A. Use a combination of REPLACE and LEFT functions to
get the job done: =REPLACE(A4, 1, 3, LEFT(A4,3) & “-”).
These arguments replace the original three characters in each product code
with the same three characters followed by a dash. Figure 16-8 shows how
REPLACE alters the product codes. In the figure, the first three product code
characters are replaced with themselves and a dash. The LEFT function and
the dash serve as the fourth argument of REPLACE.
Remember a couple of points about REPLACE:
 You need to know where the text being replaced is in the larger text.
Specifically, you have to tell the function at what position the text starts,
and how many positions it occupies.
 The text being replaced and the new text taking its place don’t have to
be the same size.
Here’s how to use the REPLACE function:
1. Position the cursor in the cell where you want the result to appear.
2. Enter =REPLACE( to begin the function entry.
3. Click a cell that contains the full string of which a portion is to be
replaced.
Figure 16-8:
Using
REPLACE to
change text.
298
Part IV: Working with Data 

4. Enter a comma ( , ).
5. Enter a number to tell the function the starting position of the text to
be replaced.
6. Enter a comma ( , ).
7. Enter a number to tell the function how many characters are to be
replaced.
8. Enter a comma ( , ).
9. Click a cell that contains text, or enter text enclosed in double quota-
tion marks.
This is the replacement text.
10. Type a ), and press Enter.
You can also use REPLACE to delete text from a string. Simply specify an
empty string (“”) as the replacement text.
SUBSTITUTE 
Use the SUBSTITUTE function when you don’t know the position in the target
string of the text to be replaced. Instead of telling the function the starting
position and number of characters (as you do with REPLACE), you just tell it
what string to look for and replace.
SUBSTITUTE takes three required arguments and a fourth optional argument:
 A reference to the cell that contains the target text string.
 The string within the target string that is to be replaced.
 The replacement text.
 An optional number to tell the function which occurrence of the string
to replace.
The fourth argument tells SUBSTITUTE which occurrence of the text to be
changed (the second argument) and actually replaced with the new text (the
third argument). The text to be replaced may appear more than once in the
target string. If you omit the fourth argument, then all occurrences are
replaced. This is the case in the first example in Table 16-2; all spaces are
replaced with commas. In the last example in Table 16-2, only the second
occurrence of the word two is changed to the word three.
299
Chapter 16: Writing Home about Text Functions

Table 16-2
Applying the SUBSTITUTE Function
Example
Returned String
Comment
=SUBSTITUTE(“apple 
apple,banana,
All spaces are 
banana cherry 
cherry,fig
replaced with 
fig”, “ “,”,”)
commas.
=SUBSTITUTE(“apple 
apple,banana 
The first space is 
banana cherry 
cherry fig
replaced with a 
fig”, “ “,”,”,1)
comma. The other
spaces remain as
they are.
=SUBSTITUTE(“apple 
apple banana 
The third space is 
banana cherry 
cherry,fig
replaced with a 
fig”, “ “,”,”,3)
comma. The other
spaces remain as
they are.
=SUBSTITUTE(“There 
There are three 
Both occurrences 
are two cats and 
cats and three 
of two are 
two birds.”,”two”,
birds.
replaced with 
”three”)
three.
=SUBSTITUTE(“There 
There are two 
Only the second 
are two cats and 
cats and three 
occurrence of 
two birds.”,”two”,
birds.
two is replaced 
”three”,2)
with three.
Try it yourself! Here is what you do:
1. Position the cursor in the cell where you want the result to appear.
2. Enter =SUBSTITUTE( to begin the function entry.
3. Click a cell that contains text, or enter its address.
This is the full string of which a portion is to be replaced.
4. Enter a comma ( , ).
5. Click a cell that contains text, or enter text enclosed in double quota-
tion marks.
This is the portion of text that is to be replaced.
6. Enter a comma ( , ).
300
Part IV: Working with Data 

7. Click a cell that contains text, or enter text enclosed in double quota-
tion marks.
This is the replacement text. If you want to specify which occurrence of
text to change, continue with Steps 8 and 9; otherwise, go to Step 10.
8. Enter a comma ( , ).
9. Enter a number that tells the function which occurrence to apply the
substitution to.
10. Type a ), and press Enter.
You can use SUBSTITUTE to remove spaces from text. In the second argu-
ment (what to replace), enter a space enclosed in double-quote marks. In the
third argument, enter two double-quote marks, with nothing in between them.
This is known as an empty string.
Giving text a trim
Spaces have a way of sneaking in and ruining your work. The worst thing is
that you often can’t even see them! When the space you need to remove is at
the beginning or end of a string, use TRIM to remove them. The function
simply clips any leading or trailing spaces from a string. It also removes extra
spaces from within a string, and a sequence of two or more spaces is
replaced by a single space.
Figure 16-9 shows how this works. In Column A is a list of names. Looking
closely, you can see that some unwanted spaces precede the names in cells
A5 and A10. Column B shows the correction using TRIM. Here is the formula
in cell A5: =TRIM(A5).
Figure 16-9:
Removing
spaces with
the TRIM
function.
301
Chapter 16: Writing Home about Text Functions

TRIM takes just one argument — the text to be cleaned of leading and trailing
spaces. Here’s how it works:
1. Position the cursor in the cell where you want the result to appear.
2. Enter =TRIM( to begin the function entry.
3. Click a cell that contains the text that has leading or trailing spaces, or
enter the cell address.
4. Type a ), and press Enter.
Be on the lookout: Although you generally use it to remove leading and trail-
ing spaces, TRIM removes extra spaces in the middle of a string. If there are
two or more spaces next to each other, TRIM removes the extra spaces and
leaves one space in place.
This is usually a good thing. Most times you don’t want extra spaces in the
middle of your text, but what if you do? Here are a couple of alternatives to
remove a leading space, if it is there, without affecting the middle of the
string:
Formula to Remove Leading Space
Comment
=IF(LEFT(E10,1)=” “,
If a space is found in the first 
SUBSTITUTE(E10,” “,””,1), E10)
position, substitute it with an
empty string; otherwise, just
return the original string.
=IF(LEFT(E10,1)=” “,
If a space is found in the first 
RIGHT(E10,LEN(E10)-1), E10)
position, return the right side of
the string, less the first position.
(See the section on LEN, earlier
in this chapter.)
Making a case 
In school you were taught to use an uppercase letter at the start of a sen-
tence as well as for proper nouns. But that was a while ago, and now the
brain cells are a bit fuzzy. Lucky thing Excel has a way to help fix case, er
Case, um CASE — well, you know what we mean.
Three functions alter the case of text: UPPER, LOWER, and PROPER. All three
functions take a single argument — the text that will have its case altered.
Here are a few examples:
302
Part IV: Working with Data 

Formula
Result
=LOWER(“The Cow Jumped 
the cow jumped over the moon
Over The Moon”)
=UPPER(“the cow jumped 
THE COW JUMPED OVER THE MOON
over the moon”)
=PROPER(“the cow jumped 
The Cow Jumped Over The Moon
over the moon”)
Try this out:
1. Enter a sentence in a cell.
Any old sentence will do, but don’t make any letters uppercase. For
example, type “excel is great” or “computers give me a headache.”
2. Position the cursor in an empty cell.
3. Enter =UPPER( to start the function.
4. Click the cell that has the sentence, or enter its address.
5. Type a ), and press Enter.
6. In another empty cell, enter =PROPER( to start the function.
7. Click the cell that has the sentence, or enter its address.
8. Type a ), and press Enter.
You should now have two cells that show the sentence with a case
change. One cell has the sentence in uppercase; the other cell, in proper
case.
Perhaps you noticed there is another possibility that needs to be addressed.
What about when just the first word needs to start with an uppercase letter
and the rest of the string is all lowercase? Some people refer to this as sen-
tence case. You can create sentence case by using the UPPER, LEFT, RIGHT,
and LEN functions. (LEN is explained earlier in this chapter.) With the
assumption that the text is in cell B10, here is how the formula looks:
=UPPER(LEFT(B10,1)) & RIGHT(B10,LEN(B10)-1)
In a nutshell, the UPPER function is applied to the first letter, which is iso-
lated with the help of the LEFT function. This result is concatenated with the
remainder of the string. You know how much is left by using LEN to get the
length of the string and using the RIGHT function to get all the characters
from the right, less one. This type of multiuse function work takes a bit of get-
ting used to.
303
Chapter 16: Writing Home about Text Functions

Comparing, Finding, and Measuring Text
Excel has many functions that manipulate text, but sometimes you just need
to find out about the text before you do anything else! A handful of functions
determine whether text matches other text, lets you find text inside other
text, and tells you how long a string is. These functions are passive — that is,
they do not alter text.
Going for perfection with EXACT 
The EXACT function lets you compare two strings of text to see whether they’re
the same. The function takes two arguments — the two strings of text — and
returns a true or false value. EXACT is case sensitive, so two strings that contain
the same letters but with differing case produces a result of false. For example,
Apple and APPLE are not identical.
EXACT is great for finding changes in data. Figure 16-10 shows two lists of
employees, one for each year, in Columns A and B. Are they identical? You
could spend a number of minutes staring at the two lists. (That would give
you a headache!) Or you can use EXACT. The cells in Column C contain the
EXACT function, used to check Column A against Column B. The returned
values are true for the most part. This means there is no change.
A few names are different in the second year. Marriage, divorce, misspellings —
it could be any of these. EXACT returns false for these names, which means
they aren’t identical in the two lists and should be checked manually.
Figure 16-10:
Comparing
strings with
the EXACT
function.
304
Part IV: Working with Data 

Here’s how you use EXACT:
1. Position the cursor in the cell where you want the results to appear.
2. Enter =EXACT( to begin the function entry.
3. Click a cell that contains text, or enter its address.
4. Enter a comma ( , ).
5. Click another cell that has text, or enter its address.
6. Type a ), and press Enter.
If you get a true result with EXACT, the strings are identical. A false result
means they’re different.
What if you want to compare strings without regard to case? In other words,
APPLE and apple would be considered the same. Excel does not have a func-
tion for this, but the result is easily obtained with EXACT and UCASE. The
idea is to convert both strings to uppercase and compare the results:
=EXACT(UCASE(“APPLE”), UCASE(“apple”))
You could just as well use LCASE here.
Finding and searching
Two functions, FIND and SEARCH, work in a quite similar fashion. A couple of
differences are key to figuring out which to use. Both FIND and SEARCH find
one string inside a larger string and tell you the position at which it was
found (or produce #VALUE if it is not found). The differences follow:
FIND
SEARCH
Case sensitive. It will not, for example, 
Not case Sensitive.
find At inside heat.
You cannot use the wild cards * and ?.
You can use the wild cards * and ?.
FIND 
FIND takes three arguments: 
 The string to find
 The larger string to search in; this argument is optional 
 The position in the larger string to start looking at
305
Chapter 16: Writing Home about Text Functions

If the third argument is left out, the function starts looking at the beginning of
the larger string. Here are some examples:
Value in Cell A1
Function
Result
Happy birthday to you
=FIND(“Birthday”,A1)
#VALUE!
Happy birthday to you
=FIND(“birthday”,A1)
7
Happy birthday to you
=FIND(“y”,A1)
5
Happy birthday to you
=FIND(“y”,A1,10)
14
In the first example using FIND, an error is returned. The #VALUE! error is
returned if the text cannot be found. Birthday is not the same as birthday,
at least to the case-sensitive FIND function.
SEARCH 
The SEARCH function takes the same arguments as FIND. The two common
wildcards you can use are the asterisk (*) and the question mark (?). An
asterisk tells the function to accept any number of characters (including zero
characters). A question mark tells the function to accept any single character.
It is not uncommon to see more than one question mark together as a wild-
card pattern. Table 16-3 shows several examples.
Table 16-3
Using the SEARCH Function
Value in Cell A1
Function
Result
Comment
Happy 
=SEARCH
7
Birthday starts in position 7.
birthday 
(“Birthday”,
to you
A1)
Happy 
=SEARCH
5
The first place where a y is 
birthday 
(“y??”,A1)
followed by any two 
to you
characters is at position 5.
This is the last letter in
Happy, a space, and the
first letter in birthday.
Happy 
=SEARCH
19
The first place where yo is 
birthday 
(“yo?”,A1)
followed by any single 
to you
character is the word you.
306
Part IV: Working with Data 

Value in Cell A1
Function
Result
Comment
Happy 
=SEARCH
7
The search pattern is the 
birthday 
(“b*d”,A1)
letter b, followed by any 
to you
number of characters, 
followed by the letter d. This
starts in position 7. The best
way to use an asterisk 
is between two fixed 
characters, as shown in this 
example.
Happy 
=SEARCH
1
The asterisk says search for 
birthday 
(“*b”,A1)
any number of characters
to you
before the letter b. The start
of characters before the
letter b is at position 1. Using
an asterisk at the start is not
useful. It will either return a
1 or an error if the fixed
character(s) (the letter b in
this example) is not in the
larger text.
Happy 
=SEARCH
10
The asterisk says search for 
birthday 
(“t*”,A1)
any number of characters  
to you
after the letter t. Because
the search starts with a
fixed character, its position
is the result. The asterisk
serves no purpose here.
Happy 
=SEARCH
16
Finds the position of the first 
birthday 
(“t”,A,
letter t, starting after 
to you
1,12)
position 12. The result is the
position of the first letter in
the word to. The letter t in
birthday is ignored.
Back in Figure 16-3 we show you how to concatenate first and last names
together. What if you have full names to separate into first names and last
names? SEARCH to the rescue! (Does that make this a search-and-rescue mis-
sion?) Figure 16-11 shows how the SEARCH, LEFT, RIGHT, and ISERROR func-
tions work together to turn names into individual first and last names.
307
Chapter 16: Writing Home about Text Functions

Isolating the first name from a full name is straightforward. You just use LEFT
to get characters up to the first space. The position of the first space is
returned from the SEARCH function. Here is how this looks:
=LEFT(A3,SEARCH(“ “,A3)-1)
Getting the last names is just as simple — not! When the full name has only
first and last names (no middle name or initials), you need SEARCH, RIGHT,
and LEN, like this:
=RIGHT(A3,LEN(A3)-SEARCH(“ “,A3))
However, this does not work for middle names or initials. What about Franklin
D. Roosevelt? If you rely on the last name being after the first space, then the
last name becomes D. Roosevelt. An honest mistake, but you can do better.
What you need is a way to test for the second space and then return every-
thing to the right of that space. There are likely a number of ways to do this. 
Here is what you see in Column C, in Figure 16-11:
=IF(ISERROR(SEARCH(“ “,RIGHT(A3,LEN(A3)-SEARCH(“
“,A3)))),RIGHT(A3,LEN(A3)-SEARCH(“
“,A3)),RIGHT(A3,LEN(A3)-SEARCH(“ “,A3,SEARCH(“
“,A3)+1)))
Admittedly, it’s a doozy. But it gets the job done. Here is an overview of what
this formula does:
 It’s an IF function and therefore tests for either true or false.
 The test is if an error is returned from SEARCH for trying to find a space
to the right of the first space: ISERROR(SEARCH(“
“,RIGHT(A3,LEN(A3)-SEARCH(“ “,A3)))).
Figure 16-11:
Splitting
names
apart.
308
Part IV: Working with Data 

 If the test is true, then there is no other space. This means there is no
middle initial, so just return the portion of the name after the first space:
RIGHT(A3,LEN(A3)-SEARCH(“ “,A3)).
 If the test is false, then there is a second space, and the task is to return
the portion of the string after the second space. SEARCH tells both the
position of the first space and the second space. This is done by nesting
one SEARCH inside the other. The inner SEARCH provides the third argu-
ment — where to start looking from. A 1 is added so the outer SEARCH
starts looking for a space one position after the first space:
RIGHT(A3,LEN(A3)-SEARCH(“ “,A3,SEARCH(“ “,A3)+1)).
Your eyes have probably glazed over, but that’s it!
Here’s how to use FIND or SEARCH:
1. Position the cursor in the cell where you want the results to appear.
2. Enter either =FIND( or =SEARCH( to begin the function entry.
3. Enter a string of text that you want in a larger string, enclosed with
double quotation marks, or click a cell that contains the text.
4. Enter a comma ( ,).
5. Click a cell that contains the larger text, or enter its address.
If you want the function to begin searching at the start of the larger
string, then go to Step 7. If you want to have the function begin the
search in the larger string at a position other than 1, go to Step 6.
6. Enter a comma ( , ) and the position number.
7. Type a ), and press Enter.
309
Chapter 16: Writing Home about Text Functions

310
Part IV: Working with Data 

Chapter 17
Playing Records with 
Database Functions
In This Chapter
 Understanding an Excel database structure
 Figuring out how criteria work
 Adding, averaging, and counting database records
 Testing for duplicate records
B
elieve it or not, an Excel worksheet has the same structure as a data-
base table. A database table has fields and records; an Excel worksheet
has columns and rows. Same thing. Given this fact, why not ask questions of,
or query, your information in much the same way as is done with a database?
In this chapter, we tell you how to use Excel’s database functions to get quick
answers from big lists. Say you have a client list on a worksheet — name,
address . . . that sort of thing. You want to know how many clients are in New
York. You may think about sorting your list by state and then counting the
number of rows. Forget it. That’s the old way! In this chapter, we show you
how to do this sort of thing with a single function.
Putting Your Data into 
a Database Structure
To use the database functions, you need to put your data into a structured
format. Excel is very flexible. Usually, you put data wherever you want. But to
make the best of the database functions, you need to get your data into a
contiguous area of rows and columns. Each row is a record and each column
is a field. The top row contains labels that identify the fields.

312
Part IV: Working with Data 
Figure 17-1 shows a database on a worksheet. This example is a list of stu-
dents (by ID number), and their class, teacher, and grade. Each student occu-
pies a row — in other words, a record — in the database. Each of the four
fields — Student ID, Class, Teacher, and Final Grade — is in one column and is
identified by a label in the top row.
The data on the worksheet in Figure 17-1 is really just normal data. There is
nothing special about it. However, the data sits in organized rows and
columns, making it ready for working with Excel’s database functions:
 Each column is a field that holds one particular item of data, such as
Student ID or Class. It must contain no other data.
 Each row contains one record. In this example, a record is the data for
one student.
 The top row of the database contains labels that identify the fields.
This sample data is used in this chapter to demonstrate the database func-
tions. Of course, you can have a database in Excel and never use the database
functions, but you have a lot more power at your fingertips if you do use them.
Working with Database Functions 
The database functions all work in basically the same way. They perform
some calculation on a specified field for those records that meet specified 
criteria. For example, you can use a database function to calculate the aver-
age final grade for all students in Accounting 101.
Figure 17-1:
Using a
database to
store
student
information.

All database functions use the following three arguments:
 The database range: This argument tells the function where the data-
base is. You enter it using cell addresses (for example, A1:D200) or a
named range (for example, Students). The range must include all
records, including the top row of field names.
 The field: You must tell a database function which field to operate on.
You can’t expect it to figure this out by itself! You can enter either the
column number or the field name. A column number, if used, is the
number of the column offset from the first column of the database area.
In other words, if a database starts in Column C, and the field is in
Column E, the column number is 3, not 5. If a heading is used, put it
inside a set of double quotation marks. Database functions calculate a
result based on the values in this field. Just how many values are used
depends on the third argument — the criteria.
 The criteria: This tells the function where the criteria are located — it is
not the criteria per se. The criteria tell the function which records to use
in its calculation. You set up the criteria in a separate part of the work-
sheet, apart from the database area. This area’s address is passed to the
database function. Criteria are explained in detail throughout the chapter.
Establishing your database
All database functions take a database reference as the first argument. The
database area must include headers (field names) in the first row. In Figure
17-1, the first row uses Student ID, Class, Teacher, and Final Grade as headers
to the information in each respective column.
A great way to work with the database functions is to name the database area
and then enter the name, instead of the range address, into the function. 
To set up a name, follow these steps:
1. Select the entire database area.
Make sure the top row has headers and is included in the selection.
2. Click the Formulas tab (at the top of the Excel window).
3. Click the Name a Range button.
The Define Name dialog box appears, with the range address set in the
Refers To box.
4. Type a name in the Name Box (or use the suggested name).
5. Click OK to close the dialog box.
313
Chapter 17: Playing Records with Database Functions

Later, if records are added to the bottom of the database, you have to redefine
the named area’s range to include the new rows. You can do this as follows:
1. Click the Name Manager button on the Excel Formulas tab.
The Name Manager dialog box is displayed.
2. Click the name in the list you want to redefine.
3. Click the Edit button in the dialog box.
Excel opens the Edit Name dialog box, shown in Figure 17-2, with infor-
mation about the selected range.
3. Change the reference in the Refers To box.
You can use the small square button to the right of the Refers To box to
define the new reference by dragging the mouse pointer over it. Clicking
the small square button reduces the size of the Define Name dialog box
and allows you access to the worksheet. When you are done dragging
the mouse over the new worksheet area, press Enter to get back to the
Define Name dialog box.
4. Click the OK button to save the reference change and close the dialog
box.
5. Click Close.
If you add records to your database range by inserting new rows somewhere
in the middle, rather than adding them on at the end, Excel automatically
adjusts the reference to the named range.
Establishing the criteria area
As we have mentioned, the criteria are not part of the database function argu-
ments but are somewhere in the worksheet and then referenced by the func-
tion. The criteria area can contain a single criterion or it can contain two or
more criteria. Each individual criterion is structured as follows:
Figure 17-2:
Updating
the
reference to
a named
area.
314
Part IV: Working with Data 

 In one cell, enter the field name (header) of the database column that
the criterion will apply to.
 In the cell below, enter the value that the field data must meet.
Figure 17-3 shows the student database with a criteria area to the right of the
database. There are places to put criteria for the Class, Teacher, and Final
Grade. In the example, a criterion has been set for the Class field. This crite-
rion forces the database function to process only records (rows) where the
Class is Accounting 101. Note, though, that a criterion can be set for more
than one field. In this example, the Teacher and Final Grade criteria have
been left blank so they don’t affect the results.
The DAVERAGE function has been entered into cell F8 and uses this criteria
range. The three arguments are in place: The name Students tells the function
where the database is the Final Grade field (column) is where the function
finds values to calculate the average, and the criteria are set to the worksheet
range that has criteria that tell the function to use only records where the
Class is Accounting 101 — in other words, F2:H3. The entry in cell F8 looks
like this:
=DAVERAGE(Students,”Final Grade”,F2:H3)
Why does this function refer to F2:H3 as the criteria range when the only
defined criterion is located in the range F2:F3? It’s a matter of convenience.
Because cells G3 and H3 in the criteria range are blank, the Teacher and Final
Grade fields are ignored by a database function that uses this criteria range.
However, if you want to enter a criterion for one of those fields, just enter it
in the appropriate cell; there is no need to edit the database function argu-
ments. What about assigning a name to the criteria area and then using the
name as the third argument to the database function? That works perfectly
well, too. 
Whether you use a named area for your criteria or simply type in the range
address, you must be careful to specify an area that includes all the criteria
but does not include any blank rows or columns. If you do, the database func-
tion’s results will be incorrect.
Figure 17-3:
Selecting
criteria to
use with a
database
function.
315
Chapter 17: Playing Records with Database Functions

Here’s how you enter any of the database functions. This example uses the
DSUM function, but the instructions are the same for all the database func-
tions — just use the one that performs the desired calculation.
1. Import or create a database of information on a worksheet.
The information should be in contiguous rows and columns. Be sure to
use field headers.
2. Optionally, use the Define Name dialog box to give the database a
name.
To name your database, see the section on “Establishing your database.”
3. Select a portion of the worksheet to be the criteria area, and then add
headers to this area that match the database headers.
You have to provide criteria headers only for database fields that crite-
ria are applied to. For example, your database area may have ten fields,
but you need to define criteria to three fields. Therefore, the criteria
area can be three columns wide.
4. Position the cursor in the cell where you want the results to appear.
This cell must not be in the database area or the criteria area.
5. Enter =DSUM( to begin the function entry.
6. Enter the database range or a name, if one is set.
7. Enter a comma ( , ).
8. Enter either one of the following:
• The header name, in quotation marks, of the database field that
the function should process
• The column number
9. Enter a comma ( , ).
10. Enter the range of the criteria area.
11. Type a ), and press Enter.
Fine-tuning Criteria with AND and OR 
Excel’s database functions would not be of much use if you could not create
fairly sophisticated queries. A few common types of queries follow:
 Records that match two or more individual criteria
 Records that match any one of several criteria
 Values that fall within a specified range 
316
Part IV: Working with Data 

To find records that match two or more criteria, place the criteria in adjacent
columns in the criteria area. Continuing with the student grade database, the
criteria area shown in Figure 17-4 matches records where the Class field con-
tains Accounting 101 and the Teacher field contains Mr. Harris. This is
called an AND criterion.
To match records that meet any one of several criteria, place the individual
criteria in two or more rows below the field name. Figure 17-5 shows a crite-
ria range that matches all records where the Class field contains either
Accounting 101 or English Literature. This is called an OR criterion.
To combine AND with OR in a criteria range, use two or more columns and
two or more rows. Figure 17-6 shows a criteria range that finds all records
where Class is Accounting 101 and Teacher is either Mr. Harris or Mr.
Richards.
Figure 17-6:
Combining
AND and OR
criteria.
Figure 17-5:
Finding
records that
match any
one of two
or more
criteria.
Figure 17-4:
Finding
records that
match two
criteria.
317
Chapter 17: Playing Records with Database Functions

To define a criterion that uses ranges, use these numerical comparison 
operators:
 < for less than
 > for greater than
 <= for less than or equal to
 >= for greater than or equal to
Of course, you can apply these to fields with numerical values. Figure 17-7
shows two criteria areas. The upper one matches all records where Final
Grade is 90 or higher. The lower one matches all records where Final Grade is
equal to or greater than 80 and less than 90.
Adding Only What Matters with DSUM
The DSUM function lets you sum numbers in a database column for just
those rows that match the criteria you specify. For example, take a database
that contains data on individual sale amounts for sales people. The database
range is named Sales. You want to calculate total sales for each of the three
sales representatives. Figure 17-8 shows how this is done. Three criteria
areas are defined in D2:D3, E2:E3, and F2:F3. The DSUM function is entered in
cells E8:E10. The formula in cell E8 is thus:
=DSUM(SALES, “Sale Amount”, D2:D3)
The functions entered in E9 and E10 are identical except for referencing a dif-
ferent criteria range. The results show clearly that Jack is the sales leader.
Figure 17-7:
Defining
numerical
range
criteria.
318
Part IV: Working with Data 

Going for the Middle with DAVERAGE
The DAVERAGE function lets you find the average, or mean, of a field for just
the rows that match the criteria. For this example you return to the student
database.
Figure 17-9 shows a worksheet in which the average grade for each course
has been calculated using DAVERAGE. For example, cell G22 shows the aver-
age grade for English Literature. Here is the formula:
=DAVERAGE(Students,”Final Grade”,F11:G12)
Each calculated average uses a different criteria area. Each area filters the
result by a particular course. In all cases, the criteria area for the Teacher is
left blank and, therefore, has no effect on the results
Figure 17-9:
Calculating
the average
grade for
each
course.
Figure 17-8:
Calculating
the sum of
sales with
the DSUM
function.
319
Chapter 17: Playing Records with Database Functions

For the sake of comparison, DAVERAGE is also used in cell G25 to show the
overall average for all courses. Because a criterion is a required function
argument, the calculation in cell G25 is set to look at an empty cell. None of
the Class criteria cells are free, so the function looks to the Teacher criterion
in cell G3. Because this cell has no particular teacher entered as a criterion,
all of the records in the database are used to create this average — just what
you want. Here is the formula in cell G25:
=DAVERAGE(Students,”Final Grade”,G2:G3)
It doesn’t matter which field header you use in the criterion when getting a
result based on all records in a database. What does matter is that there is no
actual criterion underneath the header.
Counting Only What Matters 
with DCOUNT
The DCOUNT function lets you determine how many records in the database
match the criteria.
Figure 17-10 shows how DCOUNT can determine how many students took
each course. Cells G19:G23 contain formulas that count records based on the
criterion (the Class) in the associated criteria sections. Here is the formula
used in cell G21, which counts the number of students in Calculus 101:
=DCOUNT(Students,”Final Grade”,F8:G9)
Note that DCOUNT requires a column of numbers to count. Therefore, the
Final Grade heading is put in the function. Counting on Class or Teacher
would result in zero. Using a column that specifically has numbers may seem
a little odd. The function is not summing the numbers; it just counts the
number of records. But what the heck? It works.
Now take this a step further. How about counting the number of students
who got a grade of 90 or better in any class? How can this be done? This cal-
culation requires a different criterion — one that selects all records where
Final Grade is 90 or greater. Figure 17-11 shows a worksheet with this crite-
rion and the calculated result shown. 
The result in cell F6 concatenates — that is, combines but does not add — the
answer from the DCOUNT function with some text. The formula looks like this:
=DCOUNT(Students,”Final Grade”,F2:F3) & “ students
received a 90 or better.”
320
Part IV: Working with Data 

The criterion specifically states to use all records where the Final Grade is
greater than 89 (>89). You can specify >=90 with the exact same result.
Finding Highest and Lowest 
with DMIN and DMAX
The DMIN and DMAX functions find the minimum or maximum value, respec-
tively, in a database column, for just the rows that match the criteria. Figure
17-12 shows how these two functions can find the highest and lowest grade
for English Literature.
The formulas in cells F8 and F10 are practically identical. Here is the formula
in cell F8:
=”The highest grade in “ & $F$3 & “ is “ &
DMAX(Students,”Final Grade”,$F$2:$F$3)
Figure 17-11
Calculating
the number
of students
who earned
a grade of
90 or better.
Figure 17-10:
Calculating
the number
of students
in each
course.
321
Chapter 17: Playing Records with Database Functions

Finding Duplicate Values with DGET 
DGET is a unique database function. It does not perform a calculation but
rather checks for duplicate entries. The function returns one of three values:
 If one record match the criterion, DGET returns the criterion.
 If no records match the criterion, DGET returns the #VALUE! error.
 If more than one record matches the criterion, DGET returns the #NUM!
error.
By testing to see whether DGET returns an error, you can discover problems
with your data. Perhaps you suspect that a student has registered twice for a
specific class. If this is true, two records will have the same Student ID and
Class.
Figure 17-13 shows how to check if student RM2583 is entered more than
once for Calculus 101. If there is more than one record, DGET returns an
error. Cell F5 contains a formula that nests the DGET function inside the 
ISERROR function; all that is inside the IF function. If DGET returns an error,
return one message; if DGET does not return an error, return a different mes-
sage. Here is the formula:
=IF(ISERROR(DGET(Students,”Student ID”,F2:G3)),F3 & “ has
duplicate records”, F3 & “ has one record”)
Figure 17-13:
Using DGET
to test for
duplicate
records in a
database.
Figure 17-12:
Calculating
the highest
and lowest
grades for a
specified
class.
322
Part IV: Working with Data 

Part V
The Part of Tens

In this part . . .
Just when you think you discovered it all, we show you
more! This part includes the top ten tips for working
with formulas. These gems make your work easier than
ever; you can write your own functions. Part V also has
our list of the top ten functions. Actually, we give our top
15; we just could not narrow it down to ten! The hits just
keep on coming!

Chapter 18
Ten-Plus Tips for Working 
with Formulas
In This Chapter
 Making sure the order of operators is correct
 Viewing and fixing formulas
 Referencing cells and using names
 Setting the calculation mode
 Using wizards to get the work done
 Writing your own functions
S
everal elements can help you be as productive as possible when writing
and correcting formulas. You can view all your formulas at once and cor-
rect errors one by one. You can use add-in wizards to help write functions.
You can even create functions all on your own!
Operator Precedence
One of the most important factors when writing formulas is to get the opera-
tors correct, and we do not mean telephone company operators. This has 
to do with mathematical operators — you know, little details such as plus
signs, and multiplication signs, and where the parentheses go. Operator 
precedence — the order in which operations are performed — can make a
big difference in the result. You have an easy way to keep your operator
precedence in order. All you have to remember is “Please excuse my dear
Aunt Sally.”

No, we have not lost our minds! This phrase is a mnemonic for the following:
1. Parentheses
2. Exponents
3. Multiplication
4. Division
5. Addition
6. Subtraction
Thus, parentheses have the first (highest) precedence and subtraction has
the last precedence. Well, to be honest, multiplication has the same prece-
dence as division, and addition has the same precedence as subtraction, but
you get the idea!
For example, the formula =1 + 2 × 15 equals 31. If you think it should
equal 45, then you better go visit your aunt! The answer equals 45 if you
include parentheses, such as this: =(1 + 2) × 15.
Getting the order of the operators correct is critical to the well-being of your
worksheet. Excel generates an error when the numbers of open and closed
parentheses do not match, but if you meant to add two numbers before the
multiplication, Excel will not know that you simply left the parentheses out!
A few minutes of refreshing your memory on operator order can save you a
lot of headaches down the road.
Display Formulas
In case you haven’t noticed, it’s kind of hard to view your formulas without
accidentally editing them. That’s because anytime you are in “edit” mode and
the active cell has a formula, the formula might incorporate the address of
any other cell you click. This totally messes things up.
Wouldn’t it be easy if you could just look at all your formulas? There is a way!
It’s simple. Go to the Options dialog box by choosing Tools➪Options. Then
click the View Tab. Figure 18-1 shows the dialog box with the View tab on top.
326
Part V: The Part of Tens 

Notice that under Window options is a check box for Formulas. This box tells
Excel that for any cells that have formulas to display the formula itself instead
of the calculated result. Figure 18-2 shows a worksheet that displays the for-
mulas. To return to normal view, repeat these steps and uncheck the Formulas
option. This option sure makes it easy to see what all the formulas are!
You can accidentally edit functions even when you have selected the View
Formulas option. Be careful clicking around the worksheet.
Fixing Formulas
Suppose your worksheet has some errors — don’t panic! It happens to even
the savviest users, and Excel can help figure out what’s going wrong. Under
the Tools menu is a nifty item called Error Checking. Clicking the menu item
Figure 18-2:
Viewing
formulas the
easy way.
Figure 18-1:
Setting
Options.
327
Chapter 18: Ten-Plus Tips for Working with Formulas

displays the Error Checking dialog box shown in Figure 18-3. That is, the
dialog box appears if your worksheet has any errors. Otherwise, it just pops
up a message that the error check is complete. It’s that smart!
When there are errors, the dialog box appears and sticks around while you
work on each error. The Next and Previous buttons let you cycle through all
the errors before the dialog box closes. For each error it finds, you choose
what action to take:
 Help On This Error: This leads to the Help system and displays the
topic for the particular type of error.
 Show Calculation Steps: The Evaluate Formula dialog box opens, and
you can watch step by step how the formula is calculated. This lets you
identify the particular step that caused the error.
 Ignore Error: Maybe Excel is wrong? Ignore the error.
 Edit in Formula Bar: This is a quick way to just fix the formula yourself
if you don’t need any other help.
The Error Checking dialog box also has an Options button. Clicking the
button opens the Error Checking tab from the Options dialog box. In the
Error Checking tab you can select settings and rules for how errors are recog-
nized and triggered.
Use Absolute References
If you are going to use the same formula for a bunch of cells, such as those
going down a column, the best method is to write the formula once and then
drag it down to the other cells by using the fill handle. The problem is that
when you drag the formula to new locations, any relative references change.
Often this is the intention. When there is one column of data and an adjacent
column of formulas, typically each cell in the formula column refers to its
neighbor in the data column. But if the formulas all reference a cell that is not
Figure 18-3:
Checking for
errors.
328
Part V: The Part of Tens 

adjacent, usually the intention is for all the formula cells to reference an
unchanging cell reference. Get this to work correctly by using an absolute ref-
erence to the cell.
To use an absolute reference to a cell, use the dollar sign ($) before the row
number, before the column letter, or before both. Do this when you write the
first formula, before dragging it to other cells, or you will have to update all
the formulas. 
For example, don’t write this:
=A4 × (B4 + A2)
Write it this way instead:
=A4 × (B4 + $A$2)
This way all the formulas reference A2 no matter where you copy them,
instead of that reference turning into A3, and A4, and so on.
Here’s another timesaver — when you are entering or editing a formula, you
can cycle a cell reference between relative, row absolute, column absolute, and
fully absolute by placing the editing cursor on the reference and pressing F4.
Turn Calc On/Turn Calc Off
The Excel default is to calculate your formulas automatically as they are
entered or when you change the worksheet. In some situations you may want
to set the calculation to manual. Leaving the setting on automatic is usually
not an issue, but if you are working on a hefty workbook with lots of calcula-
tions, you may need to rethink this one.
Imagine this: You have a cell that innocently does nothing but display the
date. But then there are dozens of calculations throughout the workbook that
reference that cell. Then there are dozens more calculations that reference
the first batch of cells that reference the cell with the data. Get the picture? In
a complex workbook there could be a lot of calculating going on. And the
time this takes can be noticeable.
Turning the calculation setting to manual lets you decide when to calculate.
Do this in the Options dialog box; choose Tools➪Options to get there. In the
dialog box is a Calculation tab, shown in Figure 18-4. You can check for one of
the automatic calculations settings or for manual calculation.
329
Chapter 18: Ten-Plus Tips for Working with Formulas

Pressing F9 calculates the workbook. Use it when the calculation is set to
Manual. Here are some further options:
What You Press
What You Get
F9
Calculates formulas that have changed since the last
calculation, in all open workbooks
Shift + F9
Calculates formulas that have changed since the last
calculation, just in the active worksheet
Ctrl + Alt + F9
Calculates all formulas in all open workbooks,
regardless of when they were last calculated
The calculation setting has no effect on whether you can enter a function.
Even with calculation set to Manual, you can enter functions and get an 
initial returned value. The only catch is that the value won’t update without
pressing F9.
Use Named Areas
Heck, maybe it’s just us, but we think it is easier to remember a word such as
Customers or Inventory or December than it is to remember B14:E26 or
AF220:AR680. So we create names for the ranges we know we’ll reference in
our formulas and functions.
Naming areas is easy to do, and in fact, you can do it two ways. The first is to
use the Define Name dialog box. You can get to this dialog box by choosing
Insert➪Name➪Define. In the dialog box, you set a range, give it a name, and
press the Add button. See this in Figure 18-5.
Figure 18-4:
Setting the
calculation
method.
330
Part V: The Part of Tens 

This dialog box lets you add, update, and delete named areas. A really quick
way to just add them (but not update or delete) is to
1. Select an area on the worksheet.
2. Click in the Name Box and enter the name.
The Name Box is part of the Formula Bar and sits to the left of where for-
mulas are entered.
3. Press Enter.
Done! Now you can use the name as you please. Figure 18-6 shows a name
being entered by using the Name Box. Of course you can use a particular
name only once in a workbook.
Use Formula Auditing
There are precedents and dependents. There are external references. There
is interaction everywhere. How can you track where the formula references
are coming from and going to?
Figure 18-6:
Defining a
named area
the easy
way.
Figure 18-5:
Defining a
named area.
331
Chapter 18: Ten-Plus Tips for Working with Formulas

Use the formula auditing toolbar, that’s how! First, make it visible by choos-
ing View➪Toolbars. Then use it to find the references that go into a formula
and where cells are referenced. Figure 18-7 shows the toolbar and the tracing
arrows that match formulas with references.
The formula auditing toolbar has a number of features for wading through
your formulas. Besides showing tracing arrows, it also can check errors, eval-
uate formulas, check for invalid data, and add comments to worksheets.
Use Conditional Formatting
Just like the IF function returns a certain value when the first argument condi-
tion is true and another value when it’s false, conditional formatting lets you
apply a certain format to a cell when a condition is true. This feature is imple-
mented in the Conditional Formatting dialog box under Format➪Conditional
Formatting.
The dialog box, shown in Figure 18-8, lets you set the condition and select the
format that is applied when the condition is met. For example, you could
specify that the cell be displayed in bold italics when the value it contains is
greater than 100.
Figure 18-8:
Applying a
format
when a
condition 
is met.
Figure 18-7:
Auditing
formulas.
332
Part V: The Part of Tens 

Conditions can be one of the following. A value is:
 Between two numbers
 Not between two numbers
 Equal to a number
 Not equal to a number
 Greater than a number
 Less than a number
 Greater than or equal to a number
 Less than or equal to a number
When the condition is true, formatting can control the following:
 Borders
 Font settings: Style, color, bold, italic, and so on
 Patterns: A cell’s background color
Conditional formatting is useful to call attention to certain values in a work-
sheet. In accounting worksheets, for example, negative values are often dis-
played in red.
Use the Conditional Sum Wizard
The Conditional Sum Wizard is available as an add-in and you must load it
before you can use it. Do this by choosing Tools➪Add-ins, and checking the
Add-Ins dialog box, shown in Figure 18-9. 
Figure 18-9:
Selecting
add-ins to
load.
333
Chapter 18: Ten-Plus Tips for Working with Formulas

After the add-in is loaded, the Tools menu has a new submenu — Conditional
Sum. Selecting this starts the Conditional Sum Wizard. This wizard walks you
through setting the parameters to sum values in a list that meet a condition.
Figure 18-10 shows how the wizard starts.
The wizard picks which column has the values to sum and which column has
the values to test for the condition. The end result is a sum of just the values
that have met the condition.
The Conditional Sum Wizard creates an array formula that uses the SUM and
IF functions. The Conditional Sum Wizard doesn’t provide any functionality
beyond what you could do yourself — it just simplifies the task. The result is
a formula such as this:
=SUM(IF($A$6:$A$11=”San Francisco”,$C$6:$C$11,0))
Of course the wizard makes the entry of such a formula easier, as a good
wizard should.
Use the Lookup Wizard
The Lookup Wizard comes as an add-in. Load it by choosing Tools➪Add-ins,
and then selecting it in the Add-Ins dialog box (shown earlier in Figure 18-9).
The Lookup Wizard finds the value at a selected row and column intersection
in a range you specify. The range must consist of at least two rows or
columns. Figure 18-11 shows the wizard finding a value.
Figure 18-10:
Running the
Conditional
Sum Wizard.
334
Part V: The Part of Tens 

Like the Conditional Sum Wizard, the Lookup Wizard does not do anything
that you could not do yourself, but it does make it easier to find a value in a
table. The result of the Lookup Wizard is a formula that combines the INDEX
and MATCH functions, such as this:
=INDEX($A$5:$C$11, MATCH(C21,$A$5:$A$11,),
MATCH(C17,$A$5:$C$5,))
Both the Conditional Sum Wizard and the Lookup Wizard give an option to
return not just the found value but also the parameters used to get the result.
This means that instead of having a result that by itself is meaningless, you
can copy out the parameters and place them next to the result.
Create Your Own Functions
Despite all the functions provided by Excel, you may need one that you just
don’t see offered. Excel lets you create your own functions by using VBA pro-
gramming code; your functions show up in the Insert Function dialog box.
Okay, we know what you’re thinking: Me, write VBA code? No way! It’s true —
this is not for everyone. But nonetheless, here is a short and sweet example. If
you can conquer this, then you might want to find out more about programming
VBA. Who knows, maybe one day you’ll be churning out add-ins of your own!
Follow along to create custom functions:
1. Choose Tools➪Macro➪Visual Basic Editor or press Alt + F11.
This gets you to the Visual Basic Editor, where VBA is written. 
2. Choose Insert➪Module in the editor.
Figure 18-11:
Using the
Lookup
Wizard.
335
Chapter 18: Ten-Plus Tips for Working with Formulas

You have an empty code module sitting in front of you. Now it’s time to
create your very own function! 
3. All you have to do is type this programming code, shown in Figure
18-12:
Public Function Add(number1 As Double, number2 As
Double)
Add = number1 + number2
End Function
After you type in the first line and press Enter, the last one appears auto-
matically. This example function adds two numbers, and the word Public
lists the function in the Insert Function dialog box. You may have to find
the Excel workbook on the Windows task bar because the Visual Basic
Editor runs as a separate program. 
4. Return to Excel to find and use the function in the Insert Function
dialog box, in the User Defined Category. 
Figure 18-13 shows this.
Figure 18-13:
Finding the
function in
the User
Defined
category.
Figure 18-12:
Writing 
your own
function.
336
Part V: The Part of Tens 

5. Click OK. 
The dialog box opens, ready to receive the arguments; see Figure 18-14.
Isn’t this incredible? It’s as if you are creating an extension to Excel, and
in essence you are.
You can enter =Add( into a cell and use the function you created that
way — just like any other Excel function.
This is a very basic example of what you can do by writing your own func-
tion. The possibilities are endless, but, of course, you need to know how to
program VBA. We suggest reading Excel VBA Programming For Dummies, by
John Walkenbach (Wiley).
Figure 18-14:
Using the
custom Add
function.
337
Chapter 18: Ten-Plus Tips for Working with Formulas

338
Part V: The Part of Tens 

Chapter 19
Ten-Plus Functions You 
Really Should Know
In This Chapter
 Summing, averaging, and counting
 Rounding numbers
 Using IF for conditional results
 Using the current date and time
 Determining whether a value is a number
 Finding the smallest and largest value
 Using conditional summing and counting
T
his chapter lists the top ten Excel functions. Actually, it lists the top 15,
but in some cases two related functions are treated as a single item. To be
fair, there is no absolute top-ten list of functions, but over the years (don’t
ask how many!) we have worked on hundreds of worksheets and saw some of
the same functions used all the time.
The functions in this list are of the type that apply to a wide array of needs.
You won’t see a financial function or any advanced statistical function — just
the basics — but knowing the functions in this chapter is essential to good
Excel work. You can always refer here for a quick brush-up on how to use
these important functions.
SUM
Adding numbers is one of the most basic mathematical operations. And so there
is the SUM function dedicated to doing just that. SUM takes up to 30 arguments.
Each argument can be a single number or a range containing multiple numbers.
That means SUM can add up a whole bunch of numbers! The syntax follows:
=SUM(number 1, number 2, ...)

You can also use SUM with a range, as shown here:
=SUM(A1:A12)
You can also use SUM with more than one range, such as this:
=SUM(A1:A12, B1:B12)
AVERAGE
Although technically a statistical function, AVERAGE is so often used it
deserves a place in the top ten functions. Everyone is interested in averages.
What’s the average score? What’s the average salary? What’s the average
height? What’s the average number of hours we watch TV? (That’s a sore
spot in our households!)
AVERAGE can take up to 30 arguments. Each argument can be a number or a
range that contains numbers. The syntax follows:
=AVERAGE(number 1 ,number 2 ,...)
You can also use AVERAGE with a range, as shown here:
=AVERAGE(A1:A12)
You can also use AVERAGE with more than one range, such as this:
=AVERAGE(A1:A12, B1:B12)
COUNT
COUNT counts the number of cells in a range that contain numbers. It does
not provide any sum — just the count. For a list with ten numbers, for exam-
ple, COUNT returns 10, regardless of what the numbers are.
COUNT takes up to 30 arguments, which can be cell references, range refer-
ences, or numbers themselves. COUNT ignores non-numeric values. If an
argument to COUNT is A1:A10 but only two cells contain a number, then
COUNT returns 2. The syntax follows:
=COUNT(cell reference 1, cell reference 2,...)
340
Part V: The Part of Tens 

You can also use COUNT with a range, as shown here:
=COUNT(A1:A12)
You can also use COUNT with more than one range, such as this:
=COUNT(A1:A12, B1:B12)
INT and ROUND
The INT and ROUND functions both work by removing or reducing a
number’s decimal portion. They differ in exactly how they remove it.
INT
INT simply drops the decimal portion without rounding — that is, without
regard to whether the number is closer to the next higher integer or the next
lower integer. Be aware that INT always truncates to the next lower integer.
For example, INT changes 12.05 to 12, but it also changes 12.95 to 12. Also,
INT changes both –5.1 and –5.9 to –6, not to –5, because –6 is the next lower
integer. INT takes but the single number argument. The syntax follows:
=INT(number)
ROUND
On the other hand, the ROUND function lets you control how the decimal por-
tion is handled. ROUND takes two arguments — the number to be manipulated
and the number of decimal places to round to. This gives you more control. A
number such as 5.6284 can become 5.628, 5.63, 5.6, or just 6. ROUND always
rounds up or down to the nearest number of the next significant digit, so 5.628
becomes 5.63, not 5.62.
ROUND turns 12.95 into either 12.9 or 13, depending on the setting of the
second argument. Note that there are two functions — ROUNDUP and
ROUNDDOWN — that round in one direction only. The syntax for ROUND 
follows:
=ROUND(number, number of decimal places to round to)
341
Chapter 19: Ten-Plus Functions You Really Should Know

The syntax for ROUNDUP and ROUNDDOWN is the same as ROUND:
=ROUNDUP(number, number of decimal places to round to)
=ROUNDDOWN(number, number of decimal places to round to)
IF
IF is a very handy function. It tests a condition and then returns one of two
results depending on the outcome of the test. The test must return a true or
false answer. For example, a test may be B25 > C30. If true, then IF returns
its second argument. If false, IF returns its third argument.
IF is often used as a validation step to avoid unwanted errors. The most
common use of this is to test whether a denominator is 0 before doing a divi-
sion operation. By testing for 0 first, you can avoid the #DIV/0! error.
One of the great things about IF is that the result can be a blank. This func-
tion is great when you want to return a result if the test comes out one way
but not if the result is otherwise. The syntax follows:
=IF(logical test, value if true, value if false)
NOW and TODAY
The NOW function returns the current date and time according to your com-
puter’s internal clock. TODAY returns just the date. If the date or time is
wrong, it can’t help you with that.
A common use of NOW is to return the date and time for a printed report.
You know, so a message such as “Printed on 10/24/2004 10:15” can be put on
the printed paper.
A common use for TODAY is to calculate the elapsed time between a past date
and “today.” For example, you might be tracking a project’s duration. A cell on
the worksheet has the start date. Another cell has a formula that subtracts
that date from TODAY. The answer is the number of days that have gone by.
342
Part V: The Part of Tens 

NOW and TODAY take no arguments. The syntax for each follows:
=NOW()
=TODAY()
When you put either NOW or TODAY in a cell, the format automatically
changes to the default date format. That way the date and (with NOW) time
display properly. You can change to a different date/time format if desired by
right-clicking the cell and selecting Format Cells from the pop-up menu.
HLOOKUP and VLOOKUP
HLOOKUP and VLOOKUP both find a value in a table. A table is an area of
rows and columns that you define. Both of these functions work by using a
search value for the first argument that, when found in the table, helps return
a different value.
In particular you use HLOOKUP to return a value in a row that is in the same
column as the search value. You use VLOOKUP to return a value in a column
that is in the same row as the search value. The syntax for these functions
follows:
=HLOOKUP(lookup value, table area, row , match type)
=VLOOKUP(lookup value, table area, column, match type)
ISNUMBER
A rose is a rose and by any other name would smell as sweet, but numbers
don’t get off that easy. For example, 15 is a digit, but fifteen is a word. The
ISNUMBER function tells you, flat-out true or false, if a value in a cell is a
number (including the results of formulas). The syntax follows:
=ISNUMBER(value)
343
Chapter 19: Ten-Plus Functions You Really Should Know

MIN and MAX
MIN and MAX find the respective lowest or highest numeric value in a range
of values. These functions take up to 30 arguments, and an argument can be a
range. Therefore, you can test a large list of numbers simply by entering the
list as a range. The syntax for these functions follows:
=MAX(number1,number2,...)
=MIN(number1,number2,...)
You can also use MIN and MAX with a range, as shown here:
=MAX(A1:A12)
or with more than one range, such as this:
=MAX(A1:A12, B1:B12)
SUMIF and COUNTIF
SUMIF and COUNTIF, respectively, sum or count values if a supplied criterion
is met. This makes for some robust calculations. With these functions it’s
easy to return answers for a question such as “How many shipments went
out in October?” or “How many times did the DJIA go over 10,000 last year?”
SUMIF takes three arguments: 
 A range in which to apply the criteria
 The actual criteria 
 The range from which to sum values
A key point here is that the first argument may or may not be the same range
from which values are summed. Therefore, you can use SUMIF for a question
such as “How many shipments went out in October?” but also for one such as
“What is the sum of the numbers over 100 in this list?” The syntax for SUMIF
follows:
=SUMIF(range,criteria,sum_range)
344
Part V: The Part of Tens 

Note too that the third argument in SUMIF can be left out. When this hap-
pens, SUMIF uses the first argument as the range in which to apply the crite-
ria and also as the range from which to sum.
COUNTIF counts the number of items in a range that match criteria. This is
just a count. The value of the items that match the criteria doesn’t matter
past the fact that it matches the criteria. But after a cell’s value matches the
criteria, the count of that cell is 1. COUNTIF takes just two arguments: 
 The range from which to count the number of values 
 The criteria to apply
The syntax for COUNTIF follows:
COUNTIF(range,criteria)
345
Chapter 19: Ten-Plus Functions You Really Should Know

346
Part V: The Part of Tens 

• Symbols and Numerics •
& (ampersand), 291
* (asterisk), 182
multiplication operator, 57
wildcard), 182
, (comma), 30
{} (curly braces), 54
. (decimal point) dropping when
rounding
described, 125–127
RAND, using with, 133–134
syntax, 341
. (decimal point)
dropping when rounding (INT
function), 125–127, 133–134, 341
places to round to (ROUND), 341–342
#DIV/0! error type, 28
$ (dollar sign), 24, 102, 253
“ “ (double quotation marks), 291, 301
“ (double quotes), 269
= (equal) sign
formulas, 20, 28
nested functions, 35
E (euro), 83
>= (greater than or equal to sign), 318
> (greater than sign), 146, 318
<= (less than or equal to sign), 318
< (less than sign), 146, 318
#N/A! error type, 28
#NAME? error type, 28
#NULL! error type, 28
#NUM! error type, 28
() (parentheses)
even number of open and closed, 27
matching, 64–66
placement in formula, 26
precedence, 326
+ (plus sign), 20
? (question mark wildcard), 182
#REF!, 28
0, error dividing by, 28
• A •
absolute addressing, 24
ABSOLUTE function (ABS), 129
absolute reference
ADDRESS function, 252
columns, 328–329
denoting, 24
Accounting format
currency versus, 84
described, 18
active worksheet, 9
adding
columns, 241
operator precedence, 26, 326
values in two cells, 21
adding numbers (SUM function)
described, 28, 113–118
subtotals, 142
syntax, 339–340
address, cell
absolute, 108
copying formulas, 23–24
described, 14
fixing, 102
in scrollable area, 275
address, CELL function, 270
ADDRESS reference function, 252–255
age, counting in days, 225–226
Index

All category, 39
ampersand (&), 291
AND function, 250–252, 316–318
annual rate
IPMT function, 89
payment amount, calculating, 87
any number of characters (* or ?), 182
arguments
database functions, 313
function, 30
none, selecting function that takes,
40–42
uses, selecting function that, 42–44
array
described, 53–54
functions that return, 58–62
Student t-distribution, 187
turning formula or function into (Ctrl +
Shift + Enter), 57
using in formulas and functions, 55–58
asset depreciation
accelerated depreciation schedule,
creating (SYD function), 103–104
capital assets, 100
faster accelerated depreciation
schedule, creating (Double Declining
Balance method), 104–106
future value (FV) function, 97–99
Internal Rate of Return (IRR) method,
108–111
methods, 100–102
mid-year depreciation schedule (DB
function), 106–108
straight line, calculating, 102
asterisk (*)
multiplication operator, 57
wildcard, 182
auditing
errors, formula, 72–75
formulas, 331–332
Automatic Calculation, circular
references, 67
automatically calculating formulas,
329–330
AutoSum feature
described, 116
functions, listing commonly used, 38
steps, 117
available memory (memavail argument,
INFO function), 275
AVERAGE function
in array formula, 58
described, 28, 29
nesting, 35
statistics, 340
subtotals, 142
syntax, 340
• B •
bell curve, normal distribution in,
160–161
biggest value in a set of data
finding (MAX function), 178–179, 344
offset from (LARGE function), 179–180
offset from (SMALL function), 179–180
bins and percentiles
described, 170
FREQUENCY function, 175–178
LARGE and SMALL function, 179–180
MIN and MAX function, 178–179, 344
PERCENTILE function, 171–172
PERCENTRANK function, 174–175
QUARTILE function, 170–171
RANK function, 173–174
birthday, counting days until, 225
blank cells, 277
blank (ISBLANK function), 278–280
borrowing, IRR, 110
Break Link button, 70
breaking apart text
described, 285–286
LEFT function, 286–287, 288
LEN (string length, returning), 289–290
348
Microsoft Excel Formulas & Functions For Dummies, 2nd Edition 

MID function, 288–289
RIGHT function, 287–288
broken links, mending, 68–70
• C •
calculation
formulas automatically, 329–330
improper, 27
results, watching, 75–76
settings, managing, 12
steps, showing, 328
calculator, SUM function versus, 113
capital asset depreciation, 100
CASE function, changing to UPPER,
LOWER, and PROPER, 302–303
cash flows, IRR method, 108–111
CEILING function, 122–124
cell
adding values in two, 21
address in scrollable area, 275
described, 13–17
function arguments, 45–47
functions, entering in, 50–52
marquee line around, 24
range of adjacent, 14
referencing, 23
referring to itself, 66–68
rounding functions, 120
CELL function, 269–274
Change Source button, 69
Check Status button, 70
Chi Square test (comparing results to an
estimate), 190–193
CHOOSE function, 247–248
circular references, 66–68
coin flipping, Chi Square test, 190–193
col, CELL function, 270
color, CELL function, 270
color, worksheet tab, 10
column
absolute references, 328–329
adding, 241
described, 13–17
relative number, returning, 263–267
COLUMN reference functions, 256–258
COLUMNS reference functions, 256–258
COMBIN function, 137–138
comma (,), 30
comparing two strings (EXACT), 304–305
computer and program, getting
information about, 274–276
CONCATENATE function, 290–291
condition, testing on one (IF function),
242–246
conditional formatting, formulas,
332–333
Conditional Sum Wizard, 333–334
contents, CELL function, 270
Continue button, fixing broken links, 69
copying
contents of cell with single click and
drag, 25
data, TRANSPOSE function versus, 62
formulas, 23–24
CORREL function, 168–169, 203
cost
average of gasoline per mile driven, 58
depreciation, 100
COUNT function
described, 28, 181, 340–341
subtotals, 142
count of values in sample, putting into
bins, 175–178
COUNTA function, subtotals, 142
COUNTIF function, 35, 182–183, 344–345
COVAR function, 166–168
criteria
area, establishing, 314–316
database, 313
rows matching, 319–320
349
Index

cube functions, 40
cumulative POISSON probability, 212
cumulative probability, 208
curly braces ({}), 54
currency, formatting, 82–84
currency style formatting, 18
current time, accessing, 239
Customize Regional Options dialog box,
216
• D •
data
formatting, 18–19
putting into structured format, 311–312
reorienting (TRANSPOSE function),
59–62
data, extracting from lists and tables
described, 259
HLOOKUP and VLOOKUP from
particular cell in a table, 260–263,
343
MATCH, returning relative row number
or column number of a value in a
table, 263–267
data sets, comparing, 166–169
database functions
AND and OR functions, 316–318
arguments, 313
criteria area, establishing, 314–316
data, putting into structured format,
311–312
database reference as first argument,
313–314
DAVERAGE function, 319–320
DCOUNT function, 320–321
described, 40, 312
DGET, finding duplicate values with,
322
DMIN and DMAX functions, 321–322
DSUM function, 318–319
DATE function, 218–219
date functions
DATE function, 218–219
DATEIF (time between two dates),
230–232
DAY, isolating, 219–221
Excel date handling, 215–217
formatting, 217–218
month, isolating, 221–222
NOW, 239
text, converting from, 223–224
time between two, 230–232
TODAY, 224–226
WEEKDAY, 226–227
workdays, 227–230
year, isolating, 222–223
date & time functions, 39
DATEIF function, 230–232
DATEVALUE function, 223–224
DAVERAGE function, 315, 319–320
DAY, isolating, 219–221
days
DATEIF function, 231
elapsed time over, 240
DCOUNT function, 320–321
DDB (Double Declining Balance)
depreciation, 101, 102, 104–106
decimal point (.),dropping when
rounding (INT function)
described, 125–127
RAND, using with, 133–134
syntax, 341
decimal point (.), places to round to
(ROUND), 341–342
deleted workbooks, broken links, 68
deleting
watch, 76
worksheets, 10
dependents, 73–75
depreciation
accelerated depreciation schedule,
creating (SYD function), 103–104
capital assets, 100
350
Microsoft Excel Formulas & Functions For Dummies, 2nd Edition 

faster accelerated depreciation
schedule, creating (Double Declining
Balance method), 104–106
future value (FV) function, 97–99
Internal Rate of Return (IRR) method,
108–111
methods, 100–102
mid-year depreciation schedule (DB
function), 106–108
straight line, calculating, 102
descriptive statistics, 149
deviations, analyzing, 157–159
DGET, finding duplicate values with, 322
differences, calculating, 130
directory argument, INFO function, 275
discrete distribution, Poisson, 210
displaying value from another cell, 292
#DIV/0! error type, 28
dividing text
described, 285–286
LEFT function, 286–287, 288
LEN (string length, returning), 289–290
MID function, 288–289
RIGHT function, 287–288
division operator, precedence, 26, 326
DMAX function, 321–322
DMIN function, 321–322
DOLLAR function, 292–294
dollar sign ($), 24, 102, 253
Double Declining Balance depreciation
(DDB), 101, 102, 104–106
double quotation marks (“ “), 291, 301
double quotes (“), 269
dropping decimal point when rounding
(INT), 341
DSUM function, 318–319
duplicate values, finding in database, 322
duplicating
contents of cell with single click and
drag, 25
data, TRANSPOSE function versus, 62
formulas, 23–24
duration of the loan, 86
dynamic cell addresses, 12
• E •
earlier versions of Excel, opening files, 7
Edit Links button, 69
editing functions, 48
effective interest rate, 93
elapsed time over days, 240
empty string
creating, 301
IF function, 242
end date
DATEIF function, 230
elapsed time over days, 240
engineering functions, 40
equal sign (=)
formulas, 20, 28
nested functions, 35
Error Checking drop-down, 78
errors
auditing, 72–75
broken links, mending, 68–70
cells containing, 277
circular references, avoiding, 66–68
correcting in Formula Bar, 72, 328
evaluating and checking, 76–78
in formula, 27
Formula Error Checker, 70–72
formulas, assessing, 327–328
IF function validation check, 243
ISERR function, 78, 277–278
ISERROR function, 277–278
operand, 28
parentheses, matching, 64–66
result wrong, 26
returned values, 27
Watch Window, 75–76
as you enter them, 63–64
estimate, comparing results to (Chi
Square test), 190–193
351
Index

estimation, 185
euro (E), 83
Evaluate Formula dialog box, 328
EVEN function, 124–125
even numbers, discerning, 141
EXACT text function, 304–305
Excel (Microsoft)
assembling formulas, 25–28
copying formulas with fill handle, 25
date handling, 215–217
described, 7–8
formatting data, 18–19
Formula Bar, 14
formula, entering basic, 19–22
Formulas Ribbon, 11–13
functions, 28–35
help, 19
references, 23–24
rows, column, cells, ranges, and tables,
13–17
workbooks and worksheets, 8–11
Excel VBA Programming For Dummies
(Walkenbach), 337
expected results, Chi Square test,
190–193
exponential modeling, 197
exponents, precedence, 26, 326
extracting data from lists and tables
described, 259
HLOOKUP and VLOOKUP from
particular cell in a table, 260–263,
343
MATCH, returning relative row number
or column number of a value in a
table, 263–267
• F •
F9 key, 330
fees plus annual interest rate, 93
field, database, 313
figures, adding together (SUM function)
described, 28, 113–118
subtotals, 142
syntax, 339–340
filename, CELL function, 270
files
earlier versions of Excel, opening, 7
by versions of Excel, 9
files, workbooks
described, 8–11
external, referencing, 68–70
worksheet, inserting into, 10–11
fill handle, 25
filtering rows displayed, 17
final date
DATEIF function, 230
elapsed time over days, 240
financial functions, 39
FIND text function, 305–306
fixing cell address, 102
flatness of distribution compared to
normal, 165–166
FLOOR function, 122–124
FORECAST function, 202
format, CELL function, 270
formatting
currency, 82–84
data, 18–19
numbers as currency (DOLLAR),
292–294
time functions, 234–235
Formula Auditing, 12, 73
Formula AutoComplete, 51–52
Formula Bar
errors, correcting, 72, 328
function tools, 49–50
Formula Error Checker, 70–72
formulas
absolute references, 328–329
auditing, 331–332
calculating automatically, 329–330
352
Microsoft Excel Formulas & Functions For Dummies, 2nd Edition 

conditional formatting, 332–333
Conditional Sum Wizard, 333–334
errors, assessing, 327–328
Excel, entering basic, 19–22
functions, creating custom, 335–337
Lookup Wizard, 334–335
named areas, 330–331
operator precedence, 325–326
viewing without editing, 326–327
Formulas Ribbon, 11–13
frequency distribution, 177
FREQUENCY function, 175–178
Friday, WEEKDAY returned value, 226
Function Arguments dialog box, 48
Function Library, 12
function tools. See also Insert Function
dialog box
finding correct, 39–40
Formula Bar, 49–50
worksheet cells, 50–52
Function Wizard button, 38
functions
argument, improper, 28
arguments, 30
arrays, returning, 58–62
AutoSum button, using with, 117–118
creating custom, 335–337
described, 28–29, 28–35
Formulas Ribbon, 11
Insert Function dialog box, 31–33
nesting, 33–36
functions, database
AND and OR functions, 316–318
arguments, 313
criteria area, establishing, 314–316
data, putting into structured format,
311–312
database reference as first argument,
313–314
DAVERAGE function, 319–320
DCOUNT function, 320–321
described, 40, 312
DGET, finding duplicate values with,
322
DMIN and DMAX functions, 321–322
DSUM function, 318–319
functions, date
DATE function, 218–219
DATEIF (time between two dates),
230–232
DAY, isolating, 219–221
Excel date handling, 215–217
formatting, 217–218
month, isolating, 221–222
NOW, 239
text, converting from, 223–224
time between two, 230–232
TODAY, 224–226
WEEKDAY, 226–227
workdays, 227–230
year, isolating, 222–223
functions, math. See also SUM function
ABS value, 129–130
combining, 137–138
EVEN and ODD, 124–125
FLOOR and CEILING, 122–124
INT, 125–127
MOD function, 141–142
ordering items, 136–137
pi, 131–132
power, raising numbers to, 138–139
PRODUCT function, 139–140
random numbers, generating and using,
132–135
ROUND, 118–120, 341–342
ROUNDUP and ROUNDDOWN, 120–122
SIGN, 128–129
SUBPRODUCT, 144–145
SUBTOTAL, 142–144
SUMIF, 146–147, 344–345
TRUNC, 127
353
Index

functions, text
breaking apart text, 285–290
CASE, changing to UPPER, LOWER, and
PROPER, 302–303
comparing two strings (EXACT),
304–305
described, 40
FIND, 305–306
formatting numbers as currency
(DOLLAR), 292–294
putting together (CONCATENATE),
290–291
repeating (REPT), 296–297
REPLACE, 297–299
SEARCH, 306–309
spaces, removing (TRIM), 301–302
SUBSTITUTE, 299–301
turning numbers into text (TEXT),
294–296
functions, time
described, 233
elapsed time over days, 240
formatting, 234–235
hour, isolating, 237–238
HOUR, MINUTE, and SECOND
deconstruction, 236–237
minute, isolating, 238–239
NOW, accessing current time with, 239,
342
representation of time, 234
second, isolating, 239
TIME (combining hours, minutes, and
seconds), 235–236
TIMEVALUE, converting text to time,
236
functions, word
breaking apart text, 285–290
CASE, changing to UPPER, LOWER, and
PROPER, 302–303
comparing two strings (EXACT),
304–305
described, 40
FIND, 305–306
formatting numbers as currency
(DOLLAR), 292–294
putting together (CONCATENATE),
290–291
repeating (REPT), 296–297
REPLACE, 297–299
SEARCH, 306–309
spaces, removing (TRIM), 301–302
SUBSTITUTE, 299–301
turning numbers into text (TEXT),
294–296
future, predictions and probability
described, 197
FORECAST, 202, 203–204
GROWTH, 202, 206–207
modeling, 197–198
NORMDIST, 208–210
POISSON, 210–213
SLOPE and INTERCEPT to describe
linear data, 199–202
TREND, 202, 204–206
future, workdays in, 229–230
FV (future value)
described, 88, 97–99
IPMT function, 90
NPER function, 93
PPMT function, 91
PV function, 96
RATE function, 95
• G •
gasoline, average cost per mile driven,
58
greater than or equal to sign (>=), 318
greater than sign (>), 146, 318
group, calculating statistical mean for
data sets, comparing, 166–169
described, 154–155
354
Microsoft Excel Formulas & Functions For Dummies, 2nd Edition 

deviations, analyzing, 157–159
normal distribution, looking for,
159–163
skewed from norm, 164–166
variance, measuring, 155–157
GROWTH function, 202, 206–207
guess function, interest rate, 95
• H •
headers, database, 313
help
cell errors, 72, 328
Excel, 19
Insert Function dialog box, 48
highest value in a set of data
finding (MAX function), 178–179, 344
offset from (LARGE function), 179–180
offset from (SMALL function), 179–180
histogram, 177
HLOOKUP function, 260–263, 343
hour, isolating, 237–238
HOUR, MINUTE, and SECOND
deconstruction, 236–237
hours, combining, 235–236
• I •
IF function, 242–246, 342
IfError function, 78
Ignore Error button, 72, 77, 328
INDEX function, 265–267
inferential statistics, 149, 185
INFO function, 274–276
information functions, 40
Insert Function dialog box
arguments, selecting function that uses,
42–44
described, 31, 37–38
editing functions with Function
Arguments dialog box, 48
entering cells, ranges, named areas,
and tables as function arguments,
45–47
finding correct, 39–40
help, 48
no arguments, selecting function that
takes, 40–42
Insert Ribbon button, 17
inserting worksheet into workbook,
10–11
INT function (dropping decimal point
when rounding)
described, 125–127
RAND, using with, 133–134
syntax, 341
integers, dropping portion, 127
INTERCEPT function, 199–202
interest portion of payment, ratio of, 90
interest rate
calculating, 93–95
cash flow, 82
FV function, 98
loan, 86
PV (present value) function, 95
interval argument, DATEIF function, 230
IPMT (interest payment for given period)
function, 88–90
irrational number, pi as, 131
IS function
described, 276–277
ISBLANK, ISNONTEXT, ISTEXT, and
ISNUMBER, 278–280
ISERR, ISERROR, and ISNA, 277–278
ISNUMBER, 343
TYPE, 280–282
Italy currency format, 83
iteration
Calculation tab, 67
described, 109
355
Index

• K •
kurtosis (KURT function), 165–166
• L •
LARGE function, 179–180
LEFT function, 286–287
LEN (string length, returning), 289–290
less than or equal to sign (<=), 318
less than sign (<), 146, 318
letter headers, column, 13
linear data, describing, 199–202
linear modeling, 197
linear regression line, 199–202
links, broken, 68–70
lists, extracting data from
described, 259
HLOOKUP and VLOOKUP from
particular cell in a table, 260–263,
343
MATCH, returning relative row number
or column number of a value in a
table, 263–267
literal, converting value to (CHOOSE
function), 247–248
loan payments and interest rates
cash flow, 82
currency, formatting, 82–84
described, 81
interest payments, calculating, 88–90
interest rate, calculating, 93–95
loan factors, 86
number of payments, calculating, 91–93
payment amount, calculating, 87–88
principal, calculating, 95–96
principal, calculating payments toward,
90–91
separators, 84–86
loan principal, 86
logical functions
AND and OR (returning a single logical
answer based on value of two or
more tests), 250–252, 316–318
arguments, 40
CHOOSE (converting value to literal),
247–248
described, 241
IF (testing on one condition), 242–246
NOT (reversing a logical value),
249–250
logical value, discerning, 277
lookup functions, 241
lookup & references functions, 39
Lookup Wizard, 334–335
LOWER case, converting text, 302–303
lowercase letters, 302–303
lowest value in a set of data (MIN
function), 51, 178–179
• M •
marquee line around cell, 24
MATCH, returning relative row number
or column number of a value in a
table, 263–267
math functions. See also SUM function
ABS value, 129–130
combining, 137–138
EVEN and ODD, 124–125
FLOOR and CEILING, 122–124
INT, 125–127
MOD function, 141–142
ordering items, 136–137
pi, 131–132
power, raising numbers to, 138–139
PRODUCT function, 139–140
random numbers, generating and using,
132–135
ROUND, 118–120
356
Microsoft Excel Formulas & Functions For Dummies, 2nd Edition 

ROUNDUP and ROUNDDOWN, 120–122
SIGN, 128–129
SUBPRODUCT, 144–145
SUBTOTAL, 142–144
SUMIF, 146–147, 344–345
TRUNC, 127
math & trig functions, 39
mathematical model, 197
mathematical operators, order of, 26
MAX function
described, 178–179
subtotals, 142, 344
mean
described, 150
of rows matching criteria, 319–320
variance, measuring, 155
mean, calculating for a group
data sets, comparing, 166–169
described, 154–155
deviations, analyzing, 157–159
normal distribution, looking for,
159–163
skewed from norm, 164–166
variance, measuring, 155–157
measures of central tendency, 150–151
median, 150
MEDIAN function, 150–154
memory, computer, 275
memused argument (INFO function), 275
messages
broken links, 68
improperly constructed formulas, 27
IsError function, 78
Microsoft Excel
assembling formulas, 25–28
copying formulas with fill handle, 25
date handling, 215–217
described, 7–8
formatting data, 18–19
Formula Bar, 14
formula, entering basic, 19–22
Formulas Ribbon, 11–13
functions, 28–35
help, 19
references, 23–24
rows, column, cells, ranges, and tables,
13–17
workbooks and worksheets, 8–11
Microsoft Visual Basic for Applications
(VBA), creating your own functions,
335–337
MID (middle) function, 288–289
MIN function
described, 51, 178–179
subtotals, 142
syntax, 344
minute
combining, 235–236
deconstruction, 236–237
isolating (MINUTE function), 238–239
mixed reference type, 24
MODE function, 150–154
modeling predictions and probability,
197–198
modulus (MOD) function, 141–142
Monday, WEEKDAY returned value, 226
month
DATEIF function, 231
isolating, 221–222
Most Recently Used function category,
39
moved workbooks, broken links, 68
multiple ranges, referencing, 28
multiplication
order of operators, 26
precedence, 326
up to 255 numbers at once (PRODUCT
function), 139–140
multiplication operator (*), 57
357
Index

• N •
#N/A! error type, 28
Name Box
described, 14
functions being assembled, 49
#NAME? error type, 28
named areas
arrays, 54
formulas, 330–331
function arguments, 45–47
ranges, 16
named cells, 12
naming
ranges, 15–16
workbooks, broken links, 68–69
worksheets, 10
natural attribute, normal distribution in,
159
negative deviations, 158
negative values
ABSOLUTE function (ABS), 130
rounding, 123
negatively skewed, 164
nesting functions
described, 33–36
IF statement, 245
NETWORKDAYS function, 228–229
next error, viewing, 77
noncumulative POISSON probability, 212
noncumulative probability, 208
nonlinear data, FORECAST function, 203
nonstandard normal distribution,
individual value from (x), 161
normal distribution, looking for, 159–163
NORMDIST function, 208–210
NOT function, 249–250
NOW date function, 239
NOW function, 342
NPER (number of payment periods in
loan)
calculating, 91–93
described, 88
IPMT function, 89
#NULL! error type, 28
#NUM! error type, 28
number
converting to text, 292
discerning, 277
invalid for operation type, 28
ISNUMBER function, 278–280, 343
turning into text (TEXT function),
294–296
number of payment periods in loan
(NPER)
calculating, 91–93
described, 88
IPMT function, 89
number sign (#)
#DIV/0! error type, 28
#N/A! error type, 28
#NAME? error type, 28
#NULL! error type, 28
#NUM! error type, 28
#REF!, 28
numbers, adding together (SUM
function)
described, 28, 113–118
subtotals, 142
syntax, 339–340
numfile argument, INFO function, 275
• O •
ODD function, 124–125
odd numbers, discerning, 141
Office 2007 redesign, 11
OFFSET reference function, 258–259
358
Microsoft Excel Formulas & Functions For Dummies, 2nd Edition 

Open Source button, 69
operand error, 28
operating system, name of current, 275
operator precedence, 325–326
options dialog box, 77
OR function, 250–252, 316–318
order, nested functions, 34
ordering items, 136–137
origin argument, INFO function, 275
osversion argument, INFO function, 275
outlier, 153
• P •
p (probability value), expected and
observed ranges, 191
parameters, function, 30
parentheses (())
even number of open and closed, 27
matching, 64–66
placement in formula, 26
precedence, 326
parentheses, CELL function, 270
partial absolute reference, 252
payment amount, 98
payment, loan, 86
payment on principal for a given period
(PPMT) function, 90–91
payment period, loan, 86
payment periods, number in loan (NPER)
calculating, 91–93
described, 88
IPMT function, 89
payments and interest rates, loan
cash flow, 82
currency, formatting, 82–84
described, 81
interest payments, calculating, 88–90
interest rate, calculating, 93–95
loan factors, 86
number of payments, calculating, 91–93
payment amount, calculating, 87–88
principal, calculating, 95–96
principal, calculating payments toward,
90–91
separators, 84–86
peakedness of distribution compared to
normal, 165–166
per period, interest rate, 94
PERCENTILE function, 171–172
percentiles and bins
described, 170
FREQUENCY function, 175–178
LARGE and SMALL function, 179–180
MIN and MAX function, 51, 178–179, 344
PERCENTILE function, 171–172
PERCENTRANK function, 174–175
QUARTILE function, 170–171
RANK function, 173–174
PERCENTRANK function, 174–175
percents, loan payment amounts, 87
period, interest rate per payment, 87
periodic payment amount, calculating
principal, 95
periods, number of payment in loan
(NPER)
calculating, 91–93
described, 88
IPMT function, 89
PERMUT function, 136–137
permutations, 136–137
pi, 131–132
plus sign (+), 20
PMT function, 87–88
POISSON function, 210–213
positive number, ABSOLUTE function
(ABS), 129
positively skewed, 164
possible errors, checking for, 70–72
359
Index

pound sign (#)
#DIV/0! error type, 28
#N/A! error type, 28
#NAME? error type, 28
#NULL! error type, 28
#NUM! error type, 28
#REF!, 28
power, raising numbers to, 138–139
PPMT (payment on principal for a given
period) function, 90–91
precedence, order of operator, 26
precedents, 73–75
predictions and probability
described, 197
FORECAST, 202, 203–204
GROWTH, 202, 206–207
modeling, 197–198
NORMDIST, 208–210
POISSON, 210–213
SLOPE and INTERCEPT to describe
linear data, 199–202
TREND, 202, 204–206
prefix, CELL function, 271
present value (PV)
described, 88
initial investment, in FV function, 98
principal, calculating, 95–96
previous error, viewing, 77
principal
calculating payments toward, 90–91
described, 82
IPMT function, 89
probability and predictions
described, 197
FORECAST, 202, 203–204
GROWTH, 202, 206–207
modeling, 197–198
NORMDIST, 208–210
POISSON, 210–213
SLOPE and INTERCEPT to describe
linear data, 199–202
TREND, 202, 204–206
probability value (p), expected and
observed ranges, 191
problems
auditing, 72–75
broken links, mending, 68–70
cells containing, 277
circular references, avoiding, 66–68
correcting in Formula Bar, 72, 328
evaluating and checking, 76–78
in formula, 27
Formula Error Checker, 70–72
formulas, assessing, 327–328
IF function validation check, 243
IfError function, 78
ISERR function, 78, 277–278
ISERROR function, 277–278
operand, 28
parentheses, matching, 64–66
result wrong, 26
returned values, 27
Watch Window, 75–76
as you enter them, 63–64
PRODUCT function
arguments, using with, 42–43
described, 33
multiplying up to 255 numbers at once,
139–140
subtotals, 142
PROPER CASE function, changing,
302–303
protect, CELL function, 271
pulling data from lists and tables
described, 259
HLOOKUP and VLOOKUP from
particular cell in a table, 260–263,
343
MATCH, returning relative row number
or column number of a value in a
table, 263–267
PV (present value)
described, 88
initial investment, in FV function, 98
principal, calculating, 95–96
360
Microsoft Excel Formulas & Functions For Dummies, 2nd Edition 

• Q •
QUARTILE function, 170–171
queries, AND and OR, 316–318
question mark (?), 182
Quick Access Toolbar, 12
quotation marks, double (“ “), 291, 301
• R •
random attribute, normal distribution in,
159
random numbers, generating and using,
132–135
random sampling, Student t-distribution,
186
ranges
of adjacent cells, 14
AutoSum feature, 117
database, 313
described, 13–17
function arguments, 45–47
multiple, referencing, 28
naming, 15–16
referencing, 23
sum of values, 28–29
RANK function, 173–174
rare events, analyzing, 210
RATE function, 93–95
rate of interest
calculating, 93–95
cash flow, 82
FV function, 98
loan, 86
PV (present value) function, 95
readability. See formatting
recalc argument, INFO function, 275
#REF!, 28
RefEdit button, 46
reference
circular, 66–68
discerning, 277
error when can’t find, 28
multiplying up to 255 numbers at once
(PRODUCT function), 139–140
ranges, 23
reference functions
ADDRESS, 252–255
data, extracting from lists and tables,
259–267
described, 241
OFFSET, 258–259
ROW, ROWS, COLUMN, and COLUMNS,
256–258
Regional and Language Options,
Windows Control Panel, 84–86
relative reference, 24, 252
relative row number, returning, 263–267
release argument, INFO function, 275
Remove Arrows drop-down menu, 74
removing
watch, 76
worksheets, 10
repeating text functions (REPT), 296–297
REPLACE text function, 297–299
results, comparing to estimate (Chi
Square test), 190–193
returned value, depreciation, 104
reversing logical value (NOT function),
249–250
RIGHT function, 287–288
ROUND function
described, 118–120
RAND, using with, 133–134
syntax, 341–342
ROUNDDOWN function, 120–122
rounding feature, DOLLAR function, 292
ROUNDUP function, 120–122
row
copying formulas, 23–24
described, 13–17
filtering displayed, 17
mean matching criteria, 319–320
relative number, returning, 263–267
361
Index

row, CELL function, 271
ROW reference functions, 256–258
ROWS reference functions, 256–258
• S •
salvage, depreciation, 100
sample
Student t-distribution, 186
variance, calculating, 155
Saturday, WEEKDAY returned value, 226
scrollable area, cells in, 275
Search for a Function box, 38, 39
SEARCH text function, 306–309
SECOND function, 239
seconds
combining, 235–236
deconstruction, 236–237
Select a Category down arrow, 39
sentence case, 303
separators, loan payments and interest
rates, 84–86
serial number, time represented as,
233–234
serial numbering system, 216
sets of values
described, 53–54
functions that return, 58–62
Student t-distribution, 187
turning formula or function into (Ctrl +
Shift + Enter), 57
using in formulas and functions, 55–58
sheet
cells, entering functions in, 50–52
described, 8–11
inserting into workbook, 10–11
open, number of, 275
Show Calculation Steps, 77
SIGN function, 128–129
significance tests
Chi Square test (comparing results to
an estimate), 190–193
described, 185
TTEST function, 186–190
SKEW function, 165
SLN (straight line depreciation), 100, 102
SLOPE function, 199–202
SMALL function, 179–180
Smart Tags, 71
solutions, function, 12
sorted list, median, 150
space
in formula, 28
removing (TRIM), 301–302
spelling, showing list of functions based
on, 51–52
splitting text
described, 285–286
LEFT function, 286–287, 288
LEN (string length, returning), 289–290
MID function, 288–289
RIGHT function, 287–288
spreadsheet
cells, entering functions in, 50–52
described, 8–11
inserting into workbook, 10–11
open, number of, 275
squaring deviations from the mean, 158
standard deviation, 158
standard normal distribution, individual
value from (z), 161
Start date
DATEIF function, 230
elapsed time over days, 240
StartUp Prompt button, 70
statistical functions, 39
statistical mean, calculating for a group
data sets, comparing, 166–169
described, 154–155
362
Microsoft Excel Formulas & Functions For Dummies, 2nd Edition 

deviations, analyzing, 157–159
normal distribution, looking for,
159–163
skewed from norm, 164–166
variance, measuring, 155–157
statistical percentiles and bins
described, 170
FREQUENCY function, 175–178
LARGE and SMALL function, 179–180
MIN and MAX function, 51, 178–179, 344
PERCENTILE function, 171–172
PERCENTRANK function, 174–175
QUARTILE function, 170–171
RANK function, 173–174
statistics
AVERAGE, MEDIAN, and MODE, 150–154
COUNT function, 181
COUNTIF function, 182–183
described, 149
STDEV function, subtotals, 142
STDEVP function, subtotals, 142
stock portfolio value example, 55–56
straight line depreciation (SLN), 100, 102
string
concatenating, 291
LEFT function, 286–287, 288
LEN (length) function, 289–290
MID (middle) function, 288–289
RIGHT function, 287–288
values, breaking apart, 285–286
Student t-distribution, 186–190
SUBPRODUCT function, 144–145
SUBSTITUTE text function, 299–301
SUBTOTAL function, 142–144
subtraction operator precedence, 26, 326
SUM function
described, 28, 113–118
subtotals, 142
syntax, 339–340
sum of values, ranges, 28–29
Sum of Years’ Digits depreciation (SYD),
101, 102, 103–104
SUMIF function, 146–147, 344–345
SUMPRODUCT function, 56
Sunday, WEEKDAY returned value, 226
system argument, INFO function, 275
• T •
tables
described, 13–17, 16, 259
function arguments, 45–47
MATCH function, 263–267
tables, extracting data from
described, 259
HLOOKUP and VLOOKUP from
particular cell in a table, 260–263,
343
MATCH, returning relative row number
or column number of a value in a
table, 263–267
tails
bell curve, 161
Student t-distribution, 187
TDIST function, 188–189
testing
AND and OR logical functions, 250–252,
316–318
on one condition, IF function, 242–246
random numbers, generating, 132–133
tests of significance
Chi Square test (comparing results to
an estimate), 190–193
described, 185
TTEST function, 186–190
text
converting from, 223–224
discerning, 277
363
Index

text (continued)
in formula, 28
ISNONTEXT function, 278–280
ISTEXT function, 278–280
numbers, turning into (TEXT function),
292, 294–296
time, converting to, 236
text functions
breaking apart text, 285–290
CASE, changing to UPPER, LOWER, and
PROPER, 302–303
comparing two strings (EXACT),
304–305
described, 40
FIND, 305–306
formatting numbers as currency
(DOLLAR), 292–294
putting together (CONCATENATE),
290–291
repeating (REPT), 296–297
REPLACE, 297–299
SEARCH, 306–309
spaces, removing (TRIM), 301–302
SUBSTITUTE, 299–301
turning numbers into text (TEXT),
294–296
Thursday, WEEKDAY returned value, 226
time
converting to text, 236
elapsed over days, 240
between two dates, 230–232
TIME function (combining hours,
minutes, and seconds), 235–236
time functions
described, 233
elapsed time over days, 240
formatting, 234–235
hour, isolating, 237–238
HOUR, MINUTE, and SECOND
deconstruction, 236–237
minute, isolating, 238–239
NOW, accessing current time with, 239,
342
representation of time, 234
second, isolating, 239
TIME (combining hours, minutes, and
seconds), 235–236
TIMEVALUE, converting text to time,
236
TIMEVALUE function, converting text to
time, 236
TINV function, 189–190
TODAY function
age, counting in days, 225–226
birthday, counting days until, 225
described, 41–42, 224–225
syntax, 342–343
top value in a set of data
finding (MAX function), 51, 178–179,
344
offset from (LARGE function), 179–180
offset from (SMALL function), 179–180
totmem argument, INFO function, 275
Trace Error command, 78
tracer arrows, 74–75
TRANSPOSE function, 59–62
TREND function, 202
triangles, upper left versus lower-right
corners of cell, 71
trig functions, 39
TRIM functions, 301–302
TRUNC function, 127
Tuesday, WEEKDAY returned value, 226
t-value, 188
type, CELL function, 271
TYPE function, 280–282
type, payments applied at end or
beginning of period
FV, 98
IPMT, 90
NPER, 93
PPMT, 91
364
Microsoft Excel Formulas & Functions For Dummies, 2nd Edition 

PV, 96
RATE, 95
type, Student t-distribution, 187
• U •
understanding, arranging text or figures
for better. See formatting
Update Values button, 69
UPPER case, converting text, 302–303
uppercase letters, 302–303
U.S. default currency format, 83
used memory (memused argument, INFO
function), 275
user defined functions, 40
• V •
value
calculating each, 55–56
displaying from another cell, 292
literal, converting to (CHOOSE
function), 247–248
reversing logical (NOT function),
249–250
string, breaking apart, 285–286
values, sets of
described, 53–54
functions that return, 58–62
Student t-distribution, 187
turning formula or function into (Ctrl +
Shift + Enter), 57
using in formulas and functions, 55–58
VAR function, 142
variance, measuring, 155–157
VARP function, 142
VBA (Visual Basic for Applications),
creating your own functions, 335–337
version number, returning, 275
viewing formulas without editing,
326–327
VLOOKUP function, 260–263, 343
Volatile functions
described, 42
random values, 135
• W •
Walkenbach, John (Excel VBA
Programming For Dummies), 337
Watch Window, formula errors, 75–76
Wednesday, WEEKDAY returned value,
226
weighted averages, 154
width, CELL function, 271
wildcard characters (* or ?), 182
Windows Taskbar, 9
word functions
breaking apart text, 285–290
CASE, changing to UPPER, LOWER, and
PROPER, 302–303
comparing two strings (EXACT),
304–305
described, 40
FIND, 305–306
formatting numbers as currency
(DOLLAR), 292–294
putting together (CONCATENATE),
290–291
repeating (REPT), 296–297
REPLACE, 297–299
SEARCH, 306–309
spaces, removing (TRIM), 301–302
SUBSTITUTE, 299–301
turning numbers into text (TEXT),
294–296
words
converting from, 223–224
discerning, 277
in formula, 28
ISNONTEXT function, 278–280
ISTEXT function, 278–280
365
Index

words (continued)
numbers, turning into (TEXT function),
292, 294–296
time, converting to, 236
workbooks
described, 8–11
external, referencing, 68–70
as files, 8
worksheet, inserting into, 10–11
WORKDAY function, 229–230
workdays
described, 227
in future, 229–230
range of dates, determining in, 228–229
worksheet
cells, entering functions in, 50–52
described, 8–11
inserting into workbook, 10–11
open, number of, 275
• X •
x (individual value from nonstandard
normal distribution), 161
• Y •
Y intercept, 198
year
DATEIF function, 231
isolating, 222–223
• Z •
z (individual value from standard normal
distribution), 161
zero, error dividing by, 28
366
Microsoft Excel Formulas & Functions For Dummies, 2nd Edition 

BUSINESS, CAREERS & PERSONAL FINANCE
Also available:
Business Plans Kit For Dummies 
0-7645-9794-9
Economics For Dummies 
0-7645-5726-2
Grant Writing For Dummies
0-7645-8416-2
Home Buying For Dummies 
0-7645-5331-3
Managing For Dummies 
0-7645-1771-6
Marketing For Dummies 
0-7645-5600-2
Personal Finance For Dummies 
0-7645-2590-5*
Resumes For Dummies 
0-7645-5471-9
Selling For Dummies 
0-7645-5363-1
Six Sigma For Dummies 
0-7645-6798-5
Small Business Kit For Dummies 
0-7645-5984-2
Starting an eBay Business For Dummies 
0-7645-6924-4
Your Dream Career For Dummies 
0-7645-9795-7
0-7645-9847-3
0-7645-2431-3
Also available:
Candy Making For Dummies
0-7645-9734-5
Card Games For Dummies  
0-7645-9910-0
Crocheting For Dummies 
0-7645-4151-X
Dog Training For Dummies 
0-7645-8418-9
Healthy Carb Cookbook For Dummies 
0-7645-8476-6
Home Maintenance For Dummies 
0-7645-5215-5
Horses For Dummies 
0-7645-9797-3
Jewelry Making & Beading 
For Dummies 
0-7645-2571-9
Orchids For Dummies 
0-7645-6759-4
Puppies For Dummies 
0-7645-5255-4
Rock Guitar For Dummies 
0-7645-5356-9
Sewing For Dummies 
0-7645-6847-7
Singing For Dummies 
0-7645-2475-5
FOOD, HOME, GARDEN, HOBBIES, MUSIC & PETS
0-7645-8404-9
0-7645-9904-6
Available wherever books are sold.  For more information or to order direct:  U.S. customers visit www.dummies.com or call 1-877-762-2974. 
U.K. customers visit www.wileyeurope.com or call 0800 243407.  Canadian customers visit www.wiley.ca or call 1-800-567-4797.
HOME & BUSINESS COMPUTER BASICS
Also available:
Cleaning Windows Vista For Dummies 
0-471-78293-9
Excel 2007 For Dummies
0-470-03737-7
Mac OS X Tiger For Dummies 
0-7645-7675-5
MacBook For Dummies 
0-470-04859-X
Macs For Dummies 
0-470-04849-2
Office 2007 For Dummies
0-470-00923-3
Outlook 2007 For Dummies
0-470-03830-6
PCs For Dummies 
0-7645-8958-X
Salesforce.com For Dummies 
0-470-04893-X
Upgrading & Fixing Laptops For 
Dummies 
0-7645-8959-8
Word 2007 For Dummies 
0-470-03658-3
Quicken 2007 For Dummies 
0-470-04600-7
0-470-05432-8
0-471-75421-8
Also available:
Blogging For Dummies 
0-471-77084-1
Digital Photography For Dummies
0-7645-9802-3
Digital Photography All-in-One Desk 
Reference For Dummies
0-470-03743-1
Digital SLR Cameras and Photography 
For Dummies
0-7645-9803-1
eBay Business All-in-One Desk 
Reference For Dummies
0-7645-8438-3
HDTV For Dummies 
0-470-09673-X
Home Entertainment PCs For Dummies 
0-470-05523-5
MySpace For Dummies 
0-470-09529-6
Search Engine Optimization For 
Dummies
0-471-97998-8
Skype For Dummies 
0-470-04891-3
The Internet For Dummies 
0-7645-8996-2
Wiring Your Digital Home For Dummies 
0-471-91830-X
 INTERNET & DIGITAL MEDIA
0-470-04529-9
0-470-04894-8
* Separate Canadian edition also available
† Separate U.K. edition also available

Also available:
3D Game Animation For Dummies 
0-7645-8789-7
AutoCAD 2006 For Dummies 
0-7645-8925-3
Building a Web Site For Dummies 
0-7645-7144-3
Creating Web Pages For Dummies 
0-470-08030-2
Creating Web Pages All-in-One Desk 
Reference For Dummies 
0-7645-4345-8
Dreamweaver 8 For Dummies 
0-7645-9649-7
InDesign CS2 For Dummies 
0-7645-9572-5
Macromedia Flash 8 For Dummies 
0-7645-9691-8
Photoshop CS2 and Digital 
Photography For Dummies 
0-7645-9580-6
Photoshop Elements 4 For Dummies 
0-471-77483-9
Syndicating Web Sites with RSS Feeds 
For Dummies 
0-7645-8848-6
Yahoo! SiteBuilder For Dummies 
0-7645-9800-7
SPORTS, FITNESS, PARENTING, RELIGION & SPIRITUALITY
Also available:
Catholicism For Dummies 
0-7645-5391-7
Exercise Balls For Dummies 
0-7645-5623-1
Fitness For Dummies 
0-7645-7851-0
Football For Dummies 
0-7645-3936-1
Judaism For Dummies 
0-7645-5299-6
Potty Training For Dummies 
0-7645-5417-4
Buddhism For Dummies 
0-7645-5359-3
Pregnancy For Dummies 
0-7645-4483-7 †
Ten Minute Tone-Ups For Dummies 
0-7645-7207-5
NASCAR For Dummies 
0-7645-7681-X
Religion For Dummies 
0-7645-5264-3
Soccer For Dummies 
0-7645-5229-5
Women in the Bible For Dummies 
0-7645-8475-8
Also available:
Alaska For Dummies 
0-7645-7746-8
Cruise Vacations For Dummies 
0-7645-6941-4
England For Dummies 
0-7645-4276-1
Europe For Dummies 
0-7645-7529-5
Germany For Dummies 
0-7645-7823-5
Hawaii For Dummies 
0-7645-7402-7
Italy For Dummies 
0-7645-7386-1
Las Vegas For Dummies 
0-7645-7382-9
London For Dummies 
0-7645-4277-X
Paris For Dummies 
0-7645-7630-5
RV Vacations For Dummies 
0-7645-4442-X
Walt Disney World & Orlando 
For Dummies 
0-7645-9660-8
TRAVEL
GRAPHICS, DESIGN & WEB DEVELOPMENT
0-471-76871-5
0-7645-7841-3
0-7645-7749-2
0-7645-6945-7
0-7645-8815-X
0-7645-9571-7
Also available:
Access 2007 For Dummies 
0-470-04612-0
ASP.NET 2 For Dummies 
0-7645-7907-X
C# 2005 For Dummies 
0-7645-9704-3
Hacking For Dummies 
0-470-05235-X
Hacking Wireless Networks 
For Dummies 
0-7645-9730-2
Java For Dummies 
0-470-08716-1
Microsoft SQL Server 2005 For Dummies 
0-7645-7755-7
Networking All-in-One Desk Reference 
For Dummies 
0-7645-9939-9
Preventing Identity Theft For Dummies 
0-7645-7336-5
Telecom For Dummies 
0-471-77085-X
Visual Studio 2005 All-in-One Desk 
Reference For Dummies 
0-7645-9775-2
XML For Dummies 
0-7645-8845-1
NETWORKING, SECURITY, PROGRAMMING & DATABASES
0-7645-7728-X
0-471-74940-0

Available wherever books are sold.  For more information or to order direct:  U.S. customers visit www.dummies.com or call 1-877-762-2974. 
U.K. customers visit www.wileyeurope.com or call 0800 243407.  Canadian customers visit www.wiley.ca or call 1-800-567-4797.
Get smart @ dummies.com®
• Find a full list of Dummies titles
• Look into loads of FREE on-site articles
• Sign up for FREE eTips e-mailed to you weekly
• See what other products carry the Dummies name
• Shop directly from the Dummies bookstore
• Enter to win new prizes every month!
Also available:
Bipolar Disorder For Dummies 
0-7645-8451-0
Chemotherapy and Radiation 
For Dummies 
0-7645-7832-4
Controlling Cholesterol For Dummies 
0-7645-5440-9
Diabetes For Dummies 
0-7645-6820-5* † 
Divorce For Dummies 
0-7645-8417-0 †
Fibromyalgia For Dummies 
0-7645-5441-7
Low-Calorie Dieting For Dummies 
0-7645-9905-4
Meditation For Dummies 
0-471-77774-9
Osteoporosis For Dummies 
0-7645-7621-6
Overcoming Anxiety For Dummies 
0-7645-5447-6
Reiki For Dummies 
0-7645-9907-0
Stress Management For Dummies 
0-7645-5144-2
HEALTH & SELF-HELP
0-7645-8450-2
0-7645-4149-8
Also available:
The ACT For Dummies 
0-7645-9652-7
Algebra For Dummies 
0-7645-5325-9
Algebra Workbook For Dummies 
0-7645-8467-7
Astronomy For Dummies 
0-7645-8465-0
Calculus For Dummies 
0-7645-2498-4
Chemistry For Dummies 
0-7645-5430-1
Forensics For Dummies 
0-7645-5580-4
Freemasons For Dummies 
0-7645-9796-5
French For Dummies 
0-7645-5193-0
Geometry For Dummies 
0-7645-5324-0
Organic Chemistry I For Dummies 
0-7645-6902-3
The SAT I For Dummies 
0-7645-7193-1
Spanish For Dummies 
0-7645-5194-9
Statistics For Dummies 
0-7645-5423-9
EDUCATION, HISTORY, REFERENCE & TEST PREPARATION
0-7645-8381-6
0-7645-9554-7
* Separate Canadian edition also available
† Separate U.K. edition also available

Check out the Dummies Specialty Shop at www.dummies.com for more information!
Do More with Dummies
Instructional DVDs • Music Compilations
   Games & Novelties • Culinary Kits
        Crafts & Sewing Patterns
Home Improvement/DIY Kits • and more!

