Derek P. Atherton
Control Engineering Problems with
Solutions
Download free books at

2 
 
Derek P. Atherton
Control Engineering Problems with 
Solutions
Download free eBooks at bookboon.com

3 
 
Control Engineering Problems with Solutions
1st edition
© 2013 Derek P. Atherton & bookboon.com
ISBN 978-87-403-0374-2
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
4 
Contents
Contents
	
Preface	
7
1	
Introduction	
8
1.1	
Purpose	
8
2	
Mathematical Models and Block Diagrams	
9
2.1	
Introduction	
9
2.2	
Examples	
12
2.3	
Problems	
26
3	
Transfer Functions and their Time Domain Responses 	
31
3.1	
Introduction 	
31
3.2	
Examples	
32
3.3	
Problems	
44
Download free eBooks at bookboon.com
Click on the ad to read more
www.sylvania.com
We do not reinvent  
the wheel we reinvent 
light.
Fascinating lighting offers an infinite spectrum of 
possibilities: Innovative technologies and new  
markets provide both opportunities and challenges. 
An environment in which your expertise is in high 
demand. Enjoy the supportive working atmosphere 
within our global group and benefit from international 
career paths. Implement sustainable ideas in close 
cooperation with other specialists and contribute to 
influencing our future. Come and join us in reinventing 
light every day.
Light is OSRAM

Control Engineering Problems with Solutions
5 
Contents
4	
Frequency Responses and their Plotting	
47
4.1	
Introduction	
47
4.2	
Examples	
47
4.3	
Problems	
59
5	
Feedback Loop Stability 	
62
5.1	
Introduction	
62
5.2	
Examples	
63
5.3	
Problems	
84
6	
State Space Models and Transformations	
88
6.1	
Introduction	
88
6.2	
Examples	
88
6.3	
Problems	
116
7	
Control System Design	
123
7.1	
Introduction	
123
7.2	
Examples	
124
7.3	
Problems	
148
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
360°
thinking.
© Deloitte & Touche LLP and affiliated entities.
Discover the truth at www.deloitte.ca/careers 

Control Engineering Problems with Solutions
6 
Contents
8	
Phase Plane Analysis	
154
8.1	
Introduction	
154
8.2	
Examples	
154
8.3	
Problems	
168
9	
The Describing Function and Exact Relay Methods	
172
9.1	
Introduction	
172
9.2	
Examples	
172
9.3	
Problems	
195
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
We will turn your CV into 
an opportunity of a lifetime
Do you like cars? Would you like to be a part of a successful brand?
We will appreciate and reward both your enthusiasm and talent.
Send us your CV. You will be surprised where it can take you.
Send us your CV on
www.employerforlife.com

Control Engineering Problems with Solutions
7 
Preface
Preface
The purpose of this book is to provide both worked examples and additional problems, with answers 
only, which cover the contents of the two Bookboon books ‘Control Engineering: An introduction 
with the use of Matlab’ and ‘An Introduction to Nonlinearity in Control Systems’. Although there was 
considerable emphasis in both books on the use of Matlab/Simulink, such usage may not always be 
possible, for example for students taking examinations. Thus in this book there are a large number of 
problems solved ‘long hand’ as well as by Matlab/Simulink. A major objective is to enable the reader 
to develop confidence in analytical work by showing how calculations can be checked using Matlab/
Simulink. Further by plotting accurate graphs in Matlab the reader can check approximate sketching 
methods, for say Nyquist and Bode diagrams, and by obtaining simulation results see the value of 
approximations used in solving some nonlinear control problems. 
I wish to acknowledge the influence of many former students in shaping my thoughts on many aspects 
of control engineering and in relatively recent years on the use of Matlab. In particular, Professor Dingyu 
Xue whose enthusiasm for Matlab began when he was a research student and who has been a great source 
of knowledge and advice for me on its use since that time, and to Dr. Nusret Tan for his assistance and 
advice on some Matlab routines. I wish to thank the University of Sussex for the facilities they have 
provided to me in retirement which have been very helpful in writing all three bookboon books and 
finally to my wife Constance for her love and support over many years.
Derek P. Atherton
University of Sussex
Brighton 
May 2013.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
8 
Introduction
1	 Introduction
1.1	
Purpose
The purpose of this book is to provide both worked examples and additional problems, with answers only, 
which cover the contents of the two Bookboon books Control Engineering: An introduction with the 
use of Matlab[1] and An Introduction to Nonlinearity in Control Systems [2], which will be referred to 
as references 1 and 2, respectively, throughout this book. In reference 1 the emphasis in the book was to 
show how the use of Matlab together with Simulink could avoid the tedium of doing some calculations, 
however, there are situations where this may not be possible, such as some student examinations. Thus 
in this book as well as working out in many cases the examples ‘long hand’, the solutions obtained using 
Matlab/Simulink are also given. Matlab not only allows confirmation of the calculated results but also 
provides accurate graphs of say Nyquist plots or root locus diagrams where an examination question 
may ask for a sketch. Academics have been known to say they gained significant knowledge of a topic 
from designing exercises for students. Unlike 50 years ago when slide rules and logarithmic tables were 
used to solve problems designing exercises is now much easier because in most instances results can be 
checked using appropriate computer programs, such as Matlab. Thus with these tools students can build 
their own exercises and gain confidence in solving them by doing appropriate checks with software. 
The examples and problems have been carefully chosen to try and bring out different aspects and results 
of problem solving without, hopefully creating too much repetition, which can ‘turn off’ the most ardent 
enthusiast. Before the examples in each chapter a very brief overview of aspects of the topics covered is 
given but more details can be found in the relevant chapters of references 1 or 2, which are referred to 
in the relevant chapters of this book.
References
1.	 Control Engineering: An introduction with the use of Matlab, D.P. Atherton. Bookboon 
2009.
2.	 An Introduction to Nonlinearity in Control Systems. D.P. Atherton. Bookboon 2011.
Contents Overview
The examples and problems are included under the following topic titles.
2.	 Mathematical Models and Block Diagrams.
3.	 Transfer Functions and their Time Domain Responses. 
4.	 Frequency Responses and their Plotting
5.	 Feedback Loop Stability
6.	 State Space Models and Transformations
7.	 Control System Design.
8.	 Phase Plane Analysis
9.	 The Describing Function and Exact Relay Methods.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
9 
Mathematical Models and Block Diagrams
2	 Mathematical Models and Block 
Diagrams
2.1	
Introduction
Block diagrams are used by engineers to show how the possibly large number of components, which 
are present in many systems, are interconnected. The information in a block may be purely descriptive, 
such as that shown in Figure 2.1, which describes the components of a typical measurement system, or 
contain a mathematical model of the various components which is required if any dynamic analysis is 
to be undertaken, which will be our concern here. 
Transducer
Variable
conversion
element
Signal
processing
Signal
transmission
Signal
utilization
Physical 
variable
Used
output
Figure 2.1 Components of a typical measurement system.
The basic mathematical model of a component with lumped parameters is a differential equation. 
Although all component models are nonlinear one may often be able to approximate them under certain 
conditions by a linear differential equation. Control engineers usually work with two equivalents of a linear 
differential equation, a transfer function or a state space model, as described in chapter 2 of reference 
1. Thus a component model is typically shown by a block and labelled with its transfer function 
)
(s
G
 
as shown in Figure 2.2, where the input to the block is labelled 
)
(s
U
 and the output 
)
(s
Y
. This means 
that 
)
(
)
(
)
(
s
U
s
G
s
Y
=
, where
)
(s
U
is the Laplace transform of the input signal 
)
(t
u
 and 
)
(s
Y
is the 
Laplace transform of the output signal 
)
(t
y
. The corresponding relationship in the time domain is the 
convolution integral, see appendix A reference 1, given by
∫
∫
−
=
−
=
t
t
d
t
u
g
d
u
t
g
t
y
0
0
)
(
)
(
)
(
)
(
)
(
τ
τ
τ
τ
τ
τ
, 
where 
)
(t
g
 the weighting function, or impulse response, of the block has the Laplace transform 
)
(s
G
. 
It is normally understood that when the lower case is used, i.e u, it is a function of t and when the upper 
cases is used, i.e U it is a function of s.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
10 
Mathematical Models and Block Diagrams
The first set of examples will be concerned with model representations for a single block. The transfer 
function of a component, assumed to behave linearly, is the Laplace transform of its linear constant 
parameter differential equation model, assuming all initial conditions are zero. This transfer function, 
typically denoted by, G(s), will be the ratio of two rational polynomials with real coefficients, that is 
)
(
/)
(
)
(
s
A
s
B
s
G
=
. The roots of A(s) and B(s) respectively are the poles and zeros of G(s). A transfer 
function is strictly proper when it has more poles than zeros. When the number of poles is equal to the 
number of zeros the transfer function is said to be proper. The transfer function is stable if all its poles 
have negative real parts. In Matlab the transfer function is typically entered by declaring the coefficients 
of the polynomials A(s) and B(s) or in the zero-pole-gain form. A state space model represents an nth 
order differential equation by a set of n first order differential equations represented by four matrices A, 
B, C and D. For a single-input single-output system (SISO) the dimensions are nxn; 1xn, an n column 
vector; nx1, an n row vector, and 1x1, a scalar. Whilst a state representation has a unique transfer 
function the reverse is not true. Some simple aspects of state space representations will be covered here 
with more in chapter 6.
The interconnection of model blocks is typically shown in a block diagram or signal flow graph where only 
the former will be considered here. Often the 's' is dropped in the block diagram so that the relationship 
for Figure 2.2 is typically denoted by Y = GU. 
G(s)
U(s)
Y(s)
Figure 2.2 Single block representation.
In connecting block diagrams it is assumed that the connection of one block G2 to the output of another 
G1 does not load the former so that if X = G1U and Y = G2X then Y1 = G2G1X as shown in Figure 2.3
X
Y
G1
G2
U
Figure 2.3 Series connection of blocks.
For two blocks in parallel with Y1 = G1U, Y2 = G2U and Y = Y1 +Y2 then Y = (G1  + G2)U . In Matlab the 
series connection notation is G1 * G2 and the parallel one G1  + G2. Figure 2.4 shows a simple feedback 
loop connection for which the relationships for the two blocks are C = GX and Y= HC with X = R – Y. 
Eliminating X to get the closed loop transfer function, T, between the input R and output C gives 
*+
*
5
&
7

 
 

 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
11 
Mathematical Models and Block Diagrams
R
C
G
+
  _
X
H
Y
Figure 2.4 Closed loop block diagram
The required command in Matlab is T=feedback(G,H). If the positive feedback configuration is required 
then the required statement is T=feedback(G,H,sign) where the sign = 1. This can also be used for 
the negative feedback with sign = -1. Block diagrams and signal flow graphs, an alternative graphical 
representation which will not concern us here, simply describe sets of simultaneous equations. Often 
textbooks give sets of rules for manipulating block diagrams and obtaining relationships between the 
variables involved but in many engineering problems there are not many interconnections between blocks 
and one can work from first principles writing out expressions and eliminating variables as done above. 
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
AXA Global 
Graduate Program
Find out more and apply

Control Engineering Problems with Solutions
12 
Mathematical Models and Block Diagrams
The standard single-input single-output feedback control loop is typically assumed to be of the form 
shown in Figure 2.5. G, Gc and H are respectively the transfer functions of the plant, controller and 
measurement transducer, and the input signals R, D and N are respectively the reference or command 
input, a disturbance and measurement noise. U is the control signal to the plant and C the output or 
controlled variable. The open loop transfer function, 

V
*RO
, is the transfer function around the loop 
with the negative feedback assumed, that is with ‘s’ omitted, 
*+
*
*
F
RO  
. The closed loop transfer 
function C/R is often denoted by T. The error is the difference between the demanded output and the 
actual output C. Normally the units of R and C will be different, for example C might be a speed and 
R a voltage with the transducer H having units of V/rads/s. Typically, the feedback loop is designed to 
achieve zero error between R and HC, which will be a voltage. The error in speed will be C –R/H, which 
with no voltage error will only be the demanded speed if H is known exactly. The transfer function from 
the input to the error at the input to Gc is 1-TH
Gc
G
H
R
C
D
N
+
+
+
+
+
_
U
Figure 2.5 Basic feedback control loop
The first two examples deal with transfer functions and their zeros and poles, and are followed by 
three examples dealing with the interconnection of transfer functions and their evaluation in Matlab. 
Mathematical models can also be entered and their responses to different inputs found using Simulink. 
The ‘Continuous’ category of Simulink includes the following model forms, transfer function blocks 
for either polynomial or zero pole form of entry, a state space block, an integrator block. The ‘Math 
operations’ category, includes a gain block and a sumer. The next example covers a few basic aspects of 
using these blocks in Simulink.
2.2	
Examples
Example 2.1
Find the poles and zeros of the transfer function 
2
3
3
1
)
(
2
3
+
+
+
+
=
s
s
s
s
s
G
.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
13 
Mathematical Models and Block Diagrams
To 
find 
the 
poles 
one 
needs 
to 
find 
the 
roots 
of 
the 
denominator 
polynomial  
0
2
3
3
2
3
=
+
+
+
s
s
s
. Since it is a cubic with real parameters it must have one real root and a quick 
check shows one root is –2 Dividing the polynomial by 
2
+
s
 yields 
1
2
+
+ s
s
which has roots 
of 
)
2
/
3
(
)
2
/
1(
j
s
±
−
=
. Thus the transfer function has a zero at –1, and three poles at –2 and 
)
2
/
3
(
)
2
/
1(
j
±
−
. Using Matlab one has
>> G=tf([1 1],[1 3 3 2])
Transfer function:
s + 1
——————————-
s^3 + 3 s^2 + 3 s + 2
The zero-pole gain version can then be obtained from Matlab with the following instruction:-
>> zpk(G)
Zero/pole/gain:
(s+1)
——————————
(s+2) (s^2 + s + 1)
Note the complex roots are returned as a second order polynomial.
Alternatively the transfer function could have been entered in zero-pole-gain form as below and the 
transfer function in polynomial form found.
>> G=zpk(-1,[-2 -0.5+0.866j -0.5-0.866j],1)
Zero/pole/gain:
(s+1)
——————————
(s+2) (s^2 + s + 1)
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
14 
Mathematical Models and Block Diagrams
>> tf(G)
Transfer function:
s + 1
——————————-
s^3 + 3 s^2 + 3 s + 2
In a practical situation ‘nice’ numbers will not occur and polynomials can have much higher orders 
than three so use of computational software such as Matlab is essential as indicated by the next example.
Example 2.2.
Find the poles and zeros of the transfer function 





















 
V
V
V
V
V
V
V
V
*

Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
ibili
because 
e Graduate Programme  
for Engineers and Geoscientists
Month 16
I was a construction
supervisor in 
the North Sea 
advising and 
helping foremen 
solve problems
I was a
he
s
Real work 
International opportunities 

ree work placements
al 
Internationa
or

ree wo
I wanted real responsibili 
 I joined MITAS because 
www.discovermitas.com

Control Engineering Problems with Solutions
15 
Mathematical Models and Block Diagrams
Finding the roots of the denominator because the polynomial is of fifth order requires quite a bit of trial 
and error and would be even worse for a practical situation where the polynomial coefficients would not 
be integers. The roots command in Matlab gives
>> roots([1 6 14 21 13 6])
ans =
-3.4212 
-0.9474 + 1.5690i
-0.9474 - 1.5690i
-0.3421 + 0.6365i
-0.3421 - 0.6365i
Thus these are the poles, which are seen to be one real and two complex pairs, and the zeros are easily 
seen to be -2 and -3. As all the poles have negative real parts the transfer function is stable.
Example 2.3
Find the transfer function of (a) the series and (b) the parallel combinations of the two transfer functions 
)
4
(
)1
(
)
2
(
)
(
2
2
1
+
+
+
+
=
s
s
s
s
s
G
 and 














 
V
V
V
V
*

Note that in the product 
2
1G
G
the zero at 
2
−
=
s
 from 
1
G cancels the pole at 
2
−
=
s
 of 
2
G  giving:- 
)
4
(
)1
(
4
2
3
2
1
+
+
+
+
=
s
s
s
s
G
G
. What happens in Matlab?
The first transfer function 
1
G  can be entered by making use of the convolution instruction ‘conv’ as 
follows:-
>> G1=tf([1 2],[conv([1 2 1],[1 1 4])])
Transfer function:
s + 2
——————————————-
s^4 + 3 s^3 + 7 s^2 + 9 s + 4
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
16 
Mathematical Models and Block Diagrams
>> G2=tf([1 4],[1 3 2]);
>> G=G1*G2
Transfer function:
s^2 + 6 s + 8
————————————————————————-
s^6 + 6 s^5 + 18 s^4 + 36 s^3 + 45 s^2 + 30 s + 8
Thus the zero pole cancellation has not been done by Matlab. This can be done, however, by using the 
instruction ‘minreal’, short for minimal realisation. Thus 
>> G=minreal(G1*G2)
Transfer function:
s + 4
————————————————————
s^5 + 4 s^4 + 10 s^3 + 16 s^2 + 13 s + 4
To check that the denominator agrees with the above for the product of G1 and G2 one can use the zpk 
function to obtain:- 
>> zpk(G)
Zero/pole/gain:
(s+4)
———————————
(s+1)^3 (s^2 + s + 4).
For the parallel connection of the transfer functions















































 








 
V
V
V
V
V
V
V
V
V
V
V
V
V
V
V
V
V
V
*3
giving 















































 











 
V
V
V
V
V
V
V
V
V
V
V
V
V
V
V
V
V
V
V
V
*3

Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
17 
Mathematical Models and Block Diagrams
And using Matlab
>> GP=minreal(G1+G2)
Transfer function:
s^4 + 6 s^3 + 14 s^2 + 28 s + 20
————————————————————
s^5 + 5 s^4 + 13 s^3 + 23 s^2 + 22 s + 8
Here again if minreal is not used then the denominator is of sixth power as 
3)1
( +
s
is included.
Example 2.4 
Determine the transfer functions for the basic feedback loop block diagram of Figure 2.5 from 
the input R and disturbance D to the output and the error at the input to 
c
G , respectively, with 
V
V
*F






 








 
V
V
V
*
and 
1
=
H
.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
MASTER IN MANAGEMENT
mim.admissions@ie.edu
Follow us on IE MIM Experience
www.ie.edu/master-management
#10 WORLDWIDE
MASTER IN MANAGEMENT 
FINANCIAL TIMES
55 Nationalities
in class
5 Specializations
Personalize your program 
Length: 1O MONTHS
Av. Experience: 1 YEAR
Language: ENGLISH / SPANISH
Format: FULL-TIME
Intakes: SEPT / FEB
• STUDY IN THE CENTER OF MADRID AND TAKE ADVANTAGE OF THE UNIQUE OPPORTUNITIES
  THAT THE CAPITAL OF SPAIN OFFERS
• PROPEL YOUR EDUCATION BY EARNING A DOUBLE DEGREE THAT BEST SUITS YOUR
  PROFESSIONAL GOALS
• STUDY A SEMESTER ABROAD AND BECOME A GLOBAL CITIZEN WITH THE BEYOND BORDERS
  EXPERIENCE
93%
OF MIM STUDENTS ARE
WORKING IN THEIR SECTOR 3 MONTHS
FOLLOWING GRADUATION

Control Engineering Problems with Solutions
18 
Mathematical Models and Block Diagrams
The closed loop transfer function 
+
**
**
5
&
7
F
F

 
 

Z which on substituting the values given gives 
































 






 
V
V
V
V
V
V
V
V
V
V
V
7
 and if the input to Gc 
is denoted by E, since 
*(
*
<
F
 
, gives 
*+
*
5
(
F

 

, which on substituting the values gives












































 







 
V
V
V
V
V
V
V
V
V
V
V
V
V
V
V
V
5
(

Using Matlab and after entering the transfer functions T is obtained from
>> T=feedback(Gc*G,1)
Transfer function:
2 s + 2
——————————————————-
0.25 s^4 + 1.25 s^3 + 2 s^2 + 6 s + 2
And E/R from 1-T, that is
>> 1-T
Transfer function:
0.25 s^4 + 1.25 s^3 + 2 s^2 + 4 s
——————————————————-
0.25 s^4 + 1.25 s^3 + 2 s^2 + 6 s + 2
The transfer function from D to the output corresponds to a negative feedback loop with input D, 
feedforward element, G, and feedback element 
c
G and is 




































 






 

 
V
V
V
V
V
V
V
V
V
V
V
**
*
'
&
F

>> CD=feedback(G,Gc)
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
19 
Mathematical Models and Block Diagrams
Transfer function:
0.5 s + 2
——————————————————-
0.25 s^4 + 1.25 s^3 + 2 s^2 + 6 s + 2
With the input R zero the transfer function 
D
C
D
E
−
=
.
Note the denominator polynomial of the transfer functions is always the same and its roots define the 
stability of the loop, thus from Matlab
>> roots([0.25 1.25 2 6 2])
ans =
-4.3336 
-0.1487 + 2.2317i
-0.1487 - 2.2317i
-0.3690 
Which all have negative real parts showing the feedback loop is stable.
Example 2.5
Figure 2.6 shows a block diagram with two feedback loops for which the transfer functions are 
s
s
s
G
4
4
4
1
)
(
1
+
+
=
, 
s
s
G
5.0
1
1
)
(
2
+
=
, 
2
3
1
1
)
(
s
s
s
G
+
+
=
,
s
s
G
1
)
(
4
=
,
s
s
H
1.0
1
1
)
(
1
+
=
 
and 
s
s
s
H
2.0
1
)
(
2
+
=
. Find the transfer functions from the input R and disturbance D to the output C.
C
+
  _
G1
G4
G2
G3
H1
H2
+
+
+
  _
D
R
 Figure 2.6 Block diagram for example 2.5
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
20 
Mathematical Models and Block Diagrams
To show the possible approaches the transfer functions will first be derived in terms of the block 
descriptors. To find the transfer function from R to C, which will be denoted by T, it is possibly easiest 
to derive the closed loop transfer function of the inner loop first. Denoting this by 
1T gives
2
3
2
3
2
1
1
H
G
G
G
G
T
+
=
 and then the transfer function T is given by
1
4
3
2
1
2
3
2
4
3
2
1
1
4
1
1
4
1
1
1
1
H
G
G
G
G
H
G
G
G
G
G
G
H
G
T
G
G
T
G
T
+
+
=
+
=
.
Alternatively the inner feedback loop can be replaced by noting that the total negative feedback from C 
to the input to 
1
G is 
1
4
2
1
G
G
H
H +
so that, T, can be written
1
4
3
2
1
2
3
2
4
3
2
1
4
3
2
1
1
4
2
1
4
3
2
1
1
)
(
1
H
G
G
G
G
H
G
G
G
G
G
G
G
G
G
G
G
G
H
H
G
G
G
G
T
+
+
=
+
+
=
 as before.
Substituting the transfer function values gives






































 
V
V
V
V
V
V
V
V
V
V
7

Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Control Engineering Problems with Solutions
21 
Mathematical Models and Block Diagrams
Using Matlab after the transfer functions have been entered gives
>> T1=feedback(G2*G3,H2)
Transfer function:
0.2 s + 1
———————————————————-
0.1 s^4 + 0.8 s^3 + 1.8 s^2 + 2.7 s + 1
and 
>> T=feedback(G1*T1*G4,H1)
Transfer function:
0.08 s^3 + 1.22 s^2 + 4.3 s + 1
—————————————————————————————————————
0.04 s^7 + 0.76 s^6 + 4.64 s^5 + 12.2 s^4 + 19.48 s^3 + 16 s^2 + 8.2 s + 1 
The roots of the denominator are
>> roots([0.04 0.76 4.64 12.2 19.48 16 8.2 1])
ans =
-10.0031 
-5.5809 
-1.1400 + 1.4462i
-1.1400 - 1.4462i
-0.4851 + 0.7490i
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
22 
Mathematical Models and Block Diagrams
-0.4851 - 0.7490i
-0.1658 
Thus the system is stable. 
The transfer function from D to C, which will be denoted F, is simply a forward path of 
4
3G
G
 and a 
negative feedback path of 
4
2
2
1
2
1
G
H
G
H
G
G
+
 which gives
1
4
3
2
1
2
3
2
4
3
4
2
2
1
2
1
4
3
4
3
1
)
(
1
H
G
G
G
G
H
G
G
G
G
G
H
G
H
G
G
G
G
G
G
F
+
+
=
+
+
=
 
Using Matlab 
>> F=feedback(G3*G4,G1*G2*H1+G2*H2*inv(G4))
Transfer function:
0.02 s^5 + 0.4 s^4 + 2.66 s^3 + 7.48 s^2 + 9.2 s + 4
—————————————————————————————————-
0.02 s^8 + 0.42 s^7 + 3.08 s^6 + 10.74 s^5 + 21.94 s^4 + 27.48 s^3 + 20.1 s^2 + 8.7 s + 1
>> minreal(F)
Transfer function:
s^4 + 18 s^3 + 97 s^2 + 180 s + 100
———————————————————————-
s^7 + 19 s^6 + 116 s^5 + 305 s^4 + 487 s^3 + 400 s^2 + 205 s + 25
Note the denominator polynomial is the same as that of T, its coefficients are all multiplied by 25, as 
expected.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
23 
Mathematical Models and Block Diagrams
Example 2.6
Enter the transfer 










 
V
V
V
*
L into Simulink using transfer function blocks, a state space 
representation, and using integrators?
The simplest approach is to use one block, but other possibilities are to do as a series or parallel 
combination (partial fraction representation – see also chapter 3) as shown in Figure 2.7 as models 1, 
2 and 3 respectively.
3
Out3
2
Out2
1
Out1
1
s+2
Transfer Fcn4
1
s+2
Transfer Fcn3
1
s+1
Transfer Fcn2
1
s+1
Transfer Fcn1
1
s  +3s+2
2
Transfer Fcn
3
In3
2
In2
1
In1
Figure 2.7 Possible transfer function representations
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
“The perfect start 
of a successful, 
international career.”
CLICK HERE 
to discover why both socially 
and academically the University 
of Groningen is one of the best 
places for a student to be 
www.rug.nl/feb/education
Excellent Economics and Business programmes at:

Control Engineering Problems with Solutions
24 
Mathematical Models and Block Diagrams
The use of an integration block has the advantage that an initial condition can be placed on its output. 
Thus when modelling using integrators their set of outputs provide a possible state vector. For the single 
integrator with input gain and feedback shown in Figure 2.8 the state equation is simply 
EX
D[
[

 

 
and the output equation y = cx which corresponds to a transfer function of 


D
V
EF

 if no initial 
condition is placed on the output x of the integrator.
1
Out1
1
s
Integrator
c
Gain2
b
Gain1
a
Gain
1
In1
Figure 2.8 Integrator with feedback
Note that the numerator of the transfer function, given any specific value, h, can be split arbitrarily 
between b and c. It is quite common to take b = 1 and c = h. Thus in the diagram of Figure 2.7 any of 
the first order transfer functions in the approaches 2 and 3 could have been replaced by the integrator 
implementation of Figure 2.8. For the first implementation, one simple approach using integrators, 
known as the controllable canonical form is shown in Figure 2.9.
1
Out1
1
s
Integrator1
1
s
Integrator
6
Gain1
5
Gain
1
In1
Figure 2.9 Model of second order transfer function using integrators.
The differential equation corresponding to the transfer function is 
u
x
x
=
+
+
6
5

 if the output is denoted 
by x and the input by u. In transform terms after rearranging this can be written as 
8
;
V;
;
V



 



 
which equates the two expressions available for the input to the first integrator. This approach can 
obviously be used to realise a characteristic equation of any order, where if it is of order n there will be 
n integrators in series and n feedback gain paths. Any of the three approaches to modelling the transfer 
function with integrators is a possible state space representation with the integrator outputs as the state 
vector. For the first representation in Figure 2.7 shown in Figure 2.9 the state relationships if the outputs 
of the integrators, from left to right, are respectively x2 and x1 are
2
1
x
x =

 and 
u
x
x
x
+
−
−
=
1
2
2
6
5

Thus, denoting the state vector by x equal to 
T
x
x
)
,
(
2
1
the state equation 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
25 
Mathematical Models and Block Diagrams
%X
$[
[

 

 has 






−
−
=
5
6
1
0
A
and 






= 1
0
B
, and the output equation is 

[
&[
\


 
 

For the second representation of Figure 2.7, with the state vector components being x2 and x1, the outputs 
of the first and second time constants using integrators as in Figure 2.9, the equations will be 
2
1
1
2
x
x
x
+
−
=

 and 
u
x
x
+
−
=
2
2
 so that the state representation has 






−
−
=
1
0
1
2
A
, 






= 1
0
B
 and 
(
)
0
1
=
C
.
Finally for the third representation of Figure 2.7 and denoting the outputs of the integrators in the upper 
and lower time constants as, x1 and x2  respectively, gives a state representation with






−
−
=
2
0
0
1
A
, 






= 1
1
B
 and 
(
)1
1
=
C
.
Note that this approach yields a diagonal form for the A matrix, with the eigenvalues of the matrix (roots 
of the characteristic equation) on the diagonal. Any of these state representations may be used in Matlab 
or Simulink for which the state space block is shown in Figure 2.10.
1
Out1
x' = Ax+Bu
 y = Cx+Du
State-Space
1
In1
Figure 2.10 State space model in Simulink.
Entering the first (A,B,C,D) representation into Matlab as below can be used to find the transfer function
>> A=([0 1;-6 -5]);
>> B=([0;1]);
>> C=([1 0]);
>> D=0;
>> G=ss(A,B,C,D);
>> tf(G)
Transfer function:
1
——————-
s^2 + 5 s + 6
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
26 
Mathematical Models and Block Diagrams
2.3	
Problems
Problem 2.1
Find the poles and zeros of the transfer function 
V
V
V
V
V
V
V

















 and determine if it is 
stable. Check your result using Matlab. 
[0, -2, -4, -0.5±0.866j; -1,-3; stable, all poles negative real part]
Problem 2.2
Find the poles and zeros of the transfer function 
V
V
V
V
V
V
V

















 and determine if it is 
stable. Check your result using Matlab. 
[0, -2, -4, 0.5±1.323j; -1,-3; unstable, complex poles positive real part]
Problem 2.3
Find the transfer function for the block diagram of Figure P2.3 in terms of the individual transfer 
functions. Determine its value if 
1
2
)
(
2
1
+
+
+
=
s
s
s
s
G
, 
1
1
)
(
2
+
= s
s
G
 and 
3
2
)
(
3
+
= s
s
G
. Find its poles 
and zeros.
C
G1
G2
G3
+
+
U
Figure P2.3
>

















V
V
V
V
V
V
 -1, -3, -0.5±0.866j; -2, -5/3.]
Problem 2.4
Find two state representations for the transfer function of Problem 2.3 and check your result in Matlab.
[Controllable form of TF,
¸¸
¸
¸
¸
¹
·
¨¨
¨
¨
¨
©
§




 
5
8
7
3
1
0
0
0
0
1
0
0
0
0
1
0
A
,
¸¸
¸
¸
¸
¹
·
¨¨
¨
¨
¨
©
§
 
1
0
0
0
B
,
¸¸
¸
¸
¸
¹
·
¨¨
¨
¨
¨
©
§
 
0
3
11
10
T
C
,
0
 
D
. 
Controllable form for the TF 
1
G  and diagonal form for 
2
G  and 
3
G . 












−
−
−
−
=
3
0
1
2
0
1
1
2
0
0
1
1
0
0
1
0
A
,
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
27 
Mathematical Models and Block Diagrams












=
0
0
1
0
B
 ,












=
2
1
0
0
T
C
, 
0
=
D
.]
Problem 2.5
Determine the transfer function for Figure P2.3 if 
1
1
)
(
2
1
+
+
+
=
s
s
s
s
G
, 
1
1
)
(
2
+
= s
s
G
 and 
3
2
)
(
3
+
= s
s
G
 . 
Find its poles and zeros.
[
3
4
4
5
3
2
3
+
+
+
+
s
s
s
s
; -3, -0.5±0.866j; -5/3.]
Problem 2.6
Find two state representations for the transfer function of Problem 2.5 and check your result in Matlab.
[Controllable form for the TF, 










−
−
−
=
4
4
3
1
0
0
0
1
0
A
,










=
1
0
0
B
, 
(
)
0
3
5
=
C
,
0
=
D
. 
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
American online      
LIGS University 
▶▶enroll by September 30th, 2014 and 
▶▶save up to 16% on the tuition!
▶▶pay in 10 installments / 2 years
▶▶Interactive Online education
▶▶visit www.ligsuniversity.com to 
      find out more!
is currently enrolling in the
Interactive Online BBA, MBA, MSc, 
DBA and PhD  programs:
Note: LIGS University is not accredited by any 
nationally recognized accrediting agency listed 
by the US Secretary of Education. 
More info here. 

Control Engineering Problems with Solutions
28 
Mathematical Models and Block Diagrams
Controllable form for 
1
G with no zero plus diagonal for pole at -3, 










−
−
−
=
3
0
1
0
1
1
0
1
0
A
,










=
0
1
0
B
, 
(
)
4
0
3
−
=
C
,
0
=
D
.]
Problem 2.7
Find the transfer functions C/R and C/D for the block diagram of Figure P2.7 in terms of the individual 
transfer functions. Determine their values in terms of K if:-
K
s
G
=
)
(
1
,
2
2
)1
(
1
)
(
+
= s
s
G
 , 
s
s
G
2
)
(
3
=
, 
1
)
(
1
=
s
H
, and 






 V
V
+
 Estimate the maximum value of K for stability from the transfer function 
poles and check with Matlab.
C
+
  _
G1
G3
G2
H1
+
+D
R
H2
  _
Figure P2.7
[
1
3
2
1
2
2
3
2
1
1
H
G
G
G
H
G
G
G
G
R
C
+
+
=
, 
1
3
2
1
2
2
3
2
1
H
G
G
G
H
G
G
G
D
C
+
+
=
; 
.
.
V
V
V
V
V
.
5
&




















 

.
.
V
V
V
V
V
'
&




















 

 

|
.
@
Problem 2.8
Determine 
the 
transfer 
functions 
C/R 
and 
C/D 
for 
Figure 
P2.7 
in 
terms 
of 
K  
if:-
s
s
K
s
G
1.0
1
)
1(
)
(
1
+
+
=
,
1
1
)
(
2
+
= s
s
G
, 
s
s
G
2
)
(
3
=
,
1
)
(
1
=
s
H
, and 






 V
V
+
 Estimate the 
maximum value of K for stability from the transfer function poles and check with Matlab.
>
.
.
V
.
V
V
V
V
V
.
5
&



























 

 
.
.
V
.
V
V
V
V
V
'
&



























 
 Stable for all K.]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
29 
Mathematical Models and Block Diagrams
Problem 2.9
Find the transfer functions C/R and C/D for Figure P2.9 in terms of the individual transfer functions. 
Determine their values in terms of K if:- 
K
s
G
=
)
(
1
,
2
1
)
(
2
+
= s
s
G
,
4
2
)
(
3
+
= s
s
G
,
s
s
G
4
)
(
4
=
,
1
)
(
1
=
s
H
, 






 V
V
+
 and
2
)
(
3
=
s
H
. Estimate the maximum value of K for stability from the 
transfer function poles and check with Matlab.
C
+
  _
G1
G4
G2
G3
H1
H2
+
+
+
  _
D
R
H3
  _
Figure P2.9
[
1
3
3
2
1
2
4
3
2
3
3
4
3
2
1
1
H
G
G
G
G
H
G
G
G
H
G
G
G
G
G
R
C



 
,
1
3
3
2
1
2
4
3
2
3
3
4
3
1
H
G
G
G
G
H
G
G
G
H
G
G
G
D
C



 
;
K
K
s
s
s
s
s
K
R
C
80
80
)
8
160
(
116
20
)
10
(
8
2
3
4







 
,
K
K
s
s
s
s
s
s
D
C
80
80
)
8
160
(
116
20
)
10
)(
2
(
8
2
3
4








 
;
27
.
18
 
K
]
Problem 2.10
Find the transfer functions C/R and C/D for Figure P2.10 in terms of the individual transfer functions. 
Determine their values in terms of K if:-
K
s
G
=
)
(
1
,
2
1
)
(
2
+
= s
s
G
,
4
2
)
(
3
+
= s
s
G
,
s
s
G
4
)
(
4
=
,
1
)
(
1
=
s
H
,






 V
V
+
 and
2
)
(
3
=
s
H
. Estimate the maximum value of K  for stability from the 
transfer function poles and check with Matlab.
C
+
  _
G1
G4
G2
G3
H1
H2
+
+
+
  _
D
R
H3
  _
Figure P2.10
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
30 
Mathematical Models and Block Diagrams
[
1
3
3
2
1
2
3
2
3
3
4
3
2
1
1
H
G
G
G
G
H
G
G
H
G
G
G
G
G
R
C



 
,
1
3
3
2
1
2
3
2
3
3
4
3
1
H
G
G
G
G
H
G
G
H
G
G
G
D
C



 
;
K
K
s
s
s
s
s
K
R
C
80
)
8
180
(
116
20
)
10
(
8
2
3
4






 
,
K
K
s
s
s
s
s
s
D
C
80
)
8
180
(
116
20
)
10
)(
2
(
8
2
3
4







 
;
75
.
21
 
K
]
Problem 2.11
Some nonlinear systems are covered in later examples. Check that you can simulate the following 
nonlinear characteristics in Simulink by providing a sinusoidal input and looking at the characteristic 
input-output using an X-Y scope. (i) an ideal saturation with linear gain of 4 and ouput levels of ±2, 
(ii) an on-off relay with hysteresis with input switching levels of ±0.5 and output levels of ±2, (iii) a relay 
with dead zone and hysteresis with input switching levels of ±0.5and ±1.5 and output levels of 0 and ±2, 
(iv) a characteristic 
)
6
/
(
3x
x −
.
Problem 2.12
The signal
θ
θ
3
cos
)
3
/
1(
sin
+
=
y
. Calculate its maximum value and check your result in Simulink by 
feeding the signal to a simout block and using the command max(simout).
[0.471]
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Control Engineering Problems with Solutions
31 
Transfer Functions and their Time Domain Responses
3	 Transfer Functions and their 
Time Domain Responses 
3.1	
Introduction 
In this section the examples and problems relate to the response of transfer functions, G(s) , to different 
inputs, covered in reference 1 chapter 3. If transfer functions with time delays, see reference 1section 
6.2, are neglected then as mentioned in the previous chapter, G(s) , will be the ratio of two rational 
polynomials with real coefficients, that is 
)
(
/)
(
)
(
s
A
s
B
s
G
=
. Inputs to G(s) will also be simple functions 
of s so finding the time response requires inversion of a function of a ratio of polynomials in s. This 
typically requires putting the function into partial fractions so that the inverse Laplace transform can be 
found. If the transfer function is proper then it must first be written as a constant plus a strictly proper 
transfer function. The constant will be the value of D in a state space representation. Many textbooks have 
tables of Laplace transforms but if multiple complex poles are neglected then a simple table, which can 
be used to invert transfer functions, in conjunction with the fact that s in the numerator can be taken as 
a derivative operator, is given below in Table 3.1. Note that the table could have been reduced further by 
noting that the result for poles at the origin can be found from that for multiple real poles for 
∞
= ...
1
n
 
by taking the limit as 
0
→
a
 and that the Laplace transform of 
)
(t
δ
 follows as the derivative of 
)
(t
u
. 
Further number 4 has been added as it will be frequently used but is derived from 3, as suggested above, 
by differentiation. Thus the only results which are ‘basic’ are 2 and 3.
Poles at the origin
ns
1
  ↔ 
)
(t
δ
 an impulse for n = 0.
u(t) a unit step for n = 1.








Q
W Q
 for all other n
Multiple real poles
n
a
s
)
(
1
+
  ↔ 
DW
Q
H
Q
W


 



 note for n = 1, 0!=1
Complex poles




R
R
R
V
V
Z
]Z
Z


ļ
W
H
R
W
R
R










VLQ


]
Z
]
Z
]Z




Derivative of 3




R
R
R
V
V
V
Z
]Z
Z


ļ
@


VLQ




FRV
>














W
W
H
R
R
R
R
W
R
]
Z
]
]Z
]
Z
Z
]Z






Table 3.1 Brief Table for Laplace Transforms
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
32 
Transfer Functions and their Time Domain Responses
Some students have difficulties obtaining partial fractions so that the first four examples are chosen 
to cover this concept and the inversion of Laplace transforms. Time delays do have to be considered 
typically for two situations, first where they may be required to describe an input signal, and secondly 
where a system transfer function involves a time delay, a very common situation for models of process 
control plants. The Laplace transform result that is used is
 
τ
s
e
s
F
−
)
(
 ↔ 
)
(
)
(
τ
τ
−
−
t
u
t
f
where F(s) is the Laplace transform of 
)
(t
f
and 
)
(
τ
−
t
u
is the unit step function at time 
τ
=
t
. The 
next three examples are therefore concerned with time delays. 
The final example derives the complete response of a simple transfer function to a sinusoidal input. 
It is shown that the solution consists of a transient term as well as the steady state sinusoidal solution 
which can be obtained from the transfer function by replacing s by ω
j
.This steady state solution, as ω  
is varied, is known as the frequency response of the transfer function, for which examples are given in 
the next chapter.
3.2	
Examples
Example 3.1
A system has a transfer function of 














 
V
V
V
V
V
*
 Find its poles and zeros, its gain at d.c 
(zero frequency) and its response to a unit step input.
The d.c. gain is obtained by putting 
0
=
s
 so that 
6
/
1
4
3
1
/
2
)
0
(
=
=
x
x
G
. The poles are -1, -3 
and -4 and there is a single zero at -2. The output, Y(s), for a unit step input into G(s) is given by 














 
V
V
V
V
V
V
<
 which needs to be put into partial fractions to find the output time 
function. The partial fractions are 
4
3
1
+
+
+
+
+
+
s
D
s
C
s
B
s
A
 and for this to be equal to Y(s) then

















 




V
'
V
&
V
%
V
$
V
V
V
V
V

(3.1)
Because of the input step function Y(s) has four poles, one at s = 0, in addition to the three of G(s). Thus 
the right hand side (rhs) of eqn. (3.1) has four terms with a coefficient, known as the residue at the pole, 
over each pole. The long way to solve for the residues A, B, C and D is first to work out the rhs with the 
common denominator, that is












































V
V
V
V
V
V
'V
V
V
&V
V
V
%V
V
V
V
$

.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
33 
Transfer Functions and their Time Domain Responses
Then expand the numerator and compare the coefficients in the powers of s, thus for example thes 
cubed term which is zero on the left hand side (lhs) and the constant term which is 2 on the lhs give
0
=
+
+
+
D
C
B
A
 and 


 
$
 respectively. Similarly the s squared and s terms yield two more linear 
equations involving, and which can then be solved for, A, B, C and D. However, the quick approach is 
to recognise that eqn.(3.1) is valid for all values of s so that if both sides of the equation are multiplied 
by s and s is taken equal to zero then
$
V
V
V
V
V  




 
_








 giving 



 
$
as seen earlier. If the same procedure is done for 
1
+
s
, 
3
+
s
and 
4
+
s
 with s put equal to -1,-3 and -4 one obtains
%
V
V
V
V
V
 




 
_







&
V
V
V
V
V
 




 
_






DQG
'
V
V
V
V
V
 




 
_






 Thus 
6
/
1
−
=
B
, 
6
/
1
−
=
C
 and 
6
/
1
=
D
. This procedure is often known as the cover up rule as to work out a residue 
one multiplies the expression by its denominator and then equates s to the pole value. 
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
 
  
 
                . 

Control Engineering Problems with Solutions
34 
Transfer Functions and their Time Domain Responses
The solution for the output from inverting the rhs of eqn. (3.1) is 










W
W
W
H
H
H
W
\






 
 The 
first term in the brackets may also be written as 
)
(t
u
as the solution for 
)
(t
y
is only valid for 
0
>
t
 . Note 
that the final value of the step response, see reference 1 appendix A, which can be obtained from either 
)
(
lim
t
y
t
∞
→
or 


OLP

V
V<
Vo
 is A which is equal to 1/6. Also the initial value, which can be obtained 
from 
)
(
lim
0
t
y
t→
or 


OLP
V
V<
V
f
o
 is zero. When asked to sketch a step response it is useful to have 
the initial slope which can be obtained from differentiating y(t) or in the s domain from 
)
(
lim
2
s
Y
s
s
∞
→
, 
as in the s domain the slope of y(t) is 

V
V<
.
Matlab can be used to check partial fractions using the instruction [r,p,k]=residue(num,den) here r is 
the residue at the pole p, and k is only finite when the number of zeros is equal to the number of poles, 
i.e. when the transfer function is not strictly proper and is D in a state space representation. Thus for 
this example one has
>> num=[1 2];den=[1 8 19 12 0];
>> [r,p,k]=residue(num,den)
r =
0.1667
-0.1667
-0.1667
0.1667
p =
-4.0000
-3.0000
-1.0000
0
k =
[]
The step response which is obtained from the commands
 >> G=tf([1 2],[1 8 19 12]);
>> step(G)
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
35 
Transfer Functions and their Time Domain Responses
is given in figure 3.1, and obviously confirms the final value of 1/6 = 0.167. 
0
1
2
3
4
5
6
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
0.18
Step Response
Time (sec)
Amplitude
Figure 3.1 Step response of the transfer function
Example 3.2
To illustrate the problem of a repeated root consider the evaluation of the unit impulse response of
)
2
(
)1
(
1
)
(
2
+
+
=
s
s
s
G
 . 
Since the Laplace transform of a unit impulse is 1 it is required to find the inverse Laplace transform 
of 
)
(s
G
. This can be put into partial fractions either as 
2)1
(
1
2
+
+
+
+
+
s
C
s
B
s
A
or 







V
(
'V
V
$
 
where B, C are related to D, E as is easily seen by bringing the last two terms in the first expression to 
a common denominator. Since the inverse Laplace transform of the first expression is often easier to 
write down the former is usually preferred. Using the cover up rule it is seen that 
1
=
A
 and 
1
=
C
. To 
find B it is probably easiest to then compare the numerator coefficients for one power of s. In this case 
the constant term looks easy and gives 
1
2
2
=
+
+
C
B
A
, which then yields 
1
−
=
B
. Thus the impulse 
response is 
W
W
W
WH
H
H






.
Matlab can again be used to check the partial fraction expansion and gives the following results
r =
1.0000
-1.0000
1.0000
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
36 
Transfer Functions and their Time Domain Responses
p =
-2.0000
-1.0000
-1.0000
k =
[]
Note the residues are given for the partial fraction expansion involving A, B and C in that order.
Example 3.3
Find the poles and zeros and the unit step response of the transfer function 
1
2
)
(
2
+
+
+
=
s
s
s
s
G
.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
www.mastersopenday.nl
Visit us and find out why we are the best!
Master’s Open Day: 22 February 2014
Join the best at
the Maastricht University
School of Business and
Economics!
Top master’s programmes
• 33rd place Financial Times worldwide ranking: MSc 
International Business
• 1st place: MSc International Business
• 1st place: MSc Financial Economics
• 2nd place: MSc Management of Learning
• 2nd place: MSc Economics
• 2nd place: MSc Econometrics and Operations Research
• 2nd place: MSc Global Supply Chain Management and 
Change
Sources: Keuzegids Master ranking 2013; Elsevier ‘Beste Studies’ ranking 2012; 
Financial Times Global Masters in Management ranking 2012
Maastricht
University is
the best specialist
university in the
Netherlands
(Elsevier)

Control Engineering Problems with Solutions
37 
Transfer Functions and their Time Domain Responses
There is a zero at 
2
−
=
s
and there are two complex poles at
2
/
3
5.0
j
s
±
−
=
, obtained from the 
roots of 
0
1
2
=
+
+ s
s
, found either by using the expression for the roots of a quadratic or going 
back to the basics of ‘completing the square’, i.e writing the expression as 
0
)
2
/
3
(
)
5.0
(
2
2
=
+
+
s
 , 
which is how the expression for the roots of a quadratic equation was derived. The output 
W

















 



 
V
V
%
V
V
$V
V
V
V
V
V
V
<
 with the residue at the pole 
0
=
s
 found  by 
the cover up rule. By comparing the numerator coefficients for the s and 
2s terms one has  
0
2
=
+ A
 and 
1
2
=
+ B
 giving 
2
−
=
A
 and 
1
−
=
B
. Thus inversion, using Table 3.1, of 
)
(s
Y
gives
@



VLQ




>
@



VLQ








>FRV












W
H
W
W
H
W
\
W
W





 
 
which on simplification gives 
)
2
/
3
cos(
2
2
)
(
)
2
/
(
t
e
t
y
t
−
−
=
.
Alternatively if one uses the results given in typical Laplace transform tables one writes
`
@



>
@



^>
@



>
















 




 
V
V
V
V
V
V
V
V
<
 which gives as before 
)
2
/
3
cos(
2
2
)
(
)
2
/
(
t
e
t
y
t
−
−
=
.
In this case if one uses Matlab to get the partial fractions the result shows the residues at the complex 
poles as seen below 
>> num=[1 2];
>> den=[1 1 1 0];
>> [r,p,k]=residue(num,den)
r =
-1.0000 + 0.0000i
-1.0000 - 0.0000i
2.0000 
p =
-0.5000 + 0.8660i
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
38 
Transfer Functions and their Time Domain Responses
-0.5000 - 0.8660i
0 
k =
[] 
Thus one has 
1
1
2
2
866
.0
5.0
1
866
.0
5.0
1
2
)
(
2
+
+
+
−
=
+
+
−
−
+
−
=
s
s
s
s
j
s
j
s
s
s
Y
 as before.
Example 3.4
Determine the values of c for which the step response of the transfer function 













 
V
V
FV
V
*
will 
have an overshoot. Confirm your result using Matlab and obtain plots of the step response for c equal 
to 0.5, 1, 1.5 and 2.
Comment
Many students think that there will be no overshoot when a transfer function has real negative poles. 
This may not be the case when there are zeros as this simple example illustrates.
Putting 








V
V
V
 into partial fractions gives 
)
2
(
5.0
1
1
5.0
+
+
+
−
s
s
s
which on taking the inverse 
Laplace transform gives in the time domain 
t
t
e
e
2
5.0
5.0
−
−+
−
. Thus the response of 
)
(s
G
to a unit step 
is 
t
t
t
t
ce
ce
e
e
2
2
2
2
2
1








, which has a final value of 1 {also given by 
)
0
(
G
}.
Differentiating and equating to zero to find the maximum gives
0
)1
2
(
)
1(
2
=
−
+
−
−
−
c
e
c
e
t
t
 giving 
c
c
e t
2
1
1
−
−
=
−
. Since the solution for 
t
e− must lie between zero and unity 
it requires 
1
>
c
. The overshoot will be 
)1
2
(
)1
(
)
1(
2
)
2
1(
2
2
−
−
=
−
−
−
−
−
c
c
c
e
c
e
t
t
. Thus for the values of c equal 
to 0.5, 1, 1.5 and 2, the overshoots will be 0, 0, 12.5% and 33%. Figure 3.2 shows the responses from 
Matlab. To get multiple plots on the same graph the ‘hold’ facility can be used in Matlab.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
39 
Transfer Functions and their Time Domain Responses
0
1
2
3
4
5
6
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Step Response
Time (sec)
Amplitude
c=2
c=1.5
c=1
c=0.5
Figure 3.2 Step responses for the transfer function of example 3.4.
The peak value of the response can be obtained in Matlab as shown below for c = 1.5
y=step([3 2],[1 3 2]);
>> max(y)
ans =
1.1250
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Control Engineering Problems with Solutions
40 
Transfer Functions and their Time Domain Responses
Example 3.5
A pulse, 
)
(t
x
, defined by 
1
)
(
=
t
x
 for 
∆
<
t
and 
0
)
(
=
t
x
 for 
∆
>
t
, is applied to the transfer function 
)1
//(
1
)
(
+
=
s
s
G
 obtain the output response. If the height of the pulse is changed to 
∆
/
1
so that it has 
unit area, show that by taking the limit as 
0
→
∆
 one obtains the impulse response 
)
(t
g
of 
).
(s
G
.
A quick appraisal of the situation indicates that the input is the sum of two unit steps a positive one 
occurring at time zero and a negative one at time Δ. Thus using superposition the response will be that 
for the unit positive step from time zero to Δ and for 
∆
>
t
the sum of the unit positive step response 
and that of a negative step at time 
∆
=
t
. Since the unit step response of the transfer function is 
t
e−
−
1
the response 
)
(t
y
will be 
t
e−
−
1
for 
∆
≤
< t
0
and 
t
t
t
t
e
e
e
e
−
∆
−
−
∆
−
−
−
−
=
+
−
−
)
(
)
(
1
1
for 
∆
>
t
. Note 
that for the response to the negative step since it occurs at time 
∆
=
t
the time variable is shifted to 
∆
−
t
. There are other ways of writing this result, since by definition of the unit step 
)
(t
u
 is unity for 
0
>
t
and zero for 
0
<
t
, so that u(t –  τ) is unity for 
τ
>
t
 and zero for 
τ
<
t
. Thus one can write 
]
1
)[
(
]
1
)[
(
)
(
)
(
'




'



 
t
t
e
t
u
e
t
u
t
y
 or 
]
1
)[
(
1
)
(
)
(
'




'



 
t
t
e
t
u
e
t
y
 both of which are 
valid for all 
0
>
t
.
The alternative approach which is more logical, certainly for more complicated input functions, is to note 
that the input is 
)
(
)
(
∆
−
−
t
u
t
u
which has the Laplace transform 
s
e
s
s
'


1
.  The output is therefore the inverse 
Laplace transform of 
]
1
1
][
1
[


'

s
s
e
s
s
 which gives as before 
]
1
)[
(
]
1
)[
(
)
(
)
(
'




'



 
t
t
e
t
u
e
t
u
t
y
.
When the pulse has unit area then for 
'
!
t
,
]}
1
)[
(
]
1
)[
(
){
/
1(
)
(
)
(
'




'



'
 
t
t
e
t
u
e
t
u
t
y
,  which 
as 
0
→
∆
 becomes
)
(
)}
1
(
){
/
1(
lim
}
){
/
1(
lim
)
(
0
)
(
0
t
g
e
e
e
e
e
t
y
t
t
t
t
 
 

'
 


'
 

'

o
'
'



o
'
Comment
Here the unit pulse function 
)
(
)
(
)
(
∆
−
−
=
∆
t
u
t
u
t
p
between zero and Δ has been used which is very 
useful for taking the Laplace transform of piecewise continuous functions. Note that if this is time shifted 
to start at 
τ
=
t
, that is 
)
(
)
(
)
(
∆
−
−
−
−
=
−
Λ
τ
τ
τ
τ
t
u
t
u
t
p
, then the function 
)
(
)
(
τ
τ
−
Λ t
p
t
f
is zero 
everywhere except between 
τ
=
t
and 
∆
+
=τ
t
where it is equal to 
)
(t
f
.
Example 3.6
Determine the Laplace transforms of the following signals, 
)
(t
x
:-
a)	
t
t
x
ω
sin
)
(
=
for 
ω
π /
2
≤
t
 and zero elsewhere.
b)	
t
t
x
=
)
(
for 
1
0
≤
≤t
and 
1
)
(
=
t
x
for 
1
>
t
c)	
)
(
)
(
2
τ
−
=
t
u
t
t
x
a)	 The signal is equal to 
)
(
)
(sin
/
2
t
p
t
ω
π
ω
so its Laplace transform is 
`

`^
^




V
H
V
V
V
V Z
S
Z




Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
41 
Transfer Functions and their Time Domain Responses
b)	 The signal is equal to 







W
X
W
WS
so its Laplace transform is 
s
e
s
e
s
s
s
−
−
+
−
2
2
1
. Note the 
signal 
)
(t
x
can also be described as the summation of the two signals t from 0 to ∞,
1
+
−t
 
from 1 to ∞ which can be seen to give the same Laplace transform.
c)	 The signal 
)
(
)
(
2
τ
−
=
t
u
t
t
x
 can be written in the form 


`




>




W
W
W
W





 
W
X
W
W
W
W
[
 
when expanding the 
2t term. Each term is now in the form 
)
(
)
(
τ
τ
−
−
t
u
t
f
so the Laplace 
transform is 
s
e
s
e
s
e
s
s
s
τ
τ
τ
τ
−
−
−
+
+
2
2
3
2
2
.
Example 3.7
The second order underdamped transfer function 
2
2
2
2
)
(
o
o
o
s
s
s
G
ω
ω
ζ
ω
+
+
=
has an input consisting of 
a step of magnitude a at time zero and another of magnitude 
a
−
1
 at time τ. Find the output and show 
that if τ is taken equal to 
2
/
1
2)
1(
/
ζ
ω
π
−
o
and 




'

 
D
where 
@



H[S>




]
]S


 
'
 then 
the output will be unity for 
τ
>
t
.
The input signal is 






W



W
X
D
W
DX
 The step response, y(t), of G(s) is given in many books but 
it will be worked out here. One has 
2
2
2
2
2
2
2
1
)
2
(
)
(
o
o
o
o
o
o
s
s
s
s
s
s
s
s
Y
Z
Z
]
]Z
Z
Z
]
Z




 


 
  and taking the inverse 
Laplace transform gives  

VLQ



H[S

@
VLQ



VLQ


>FRV
H[S















M
Z
]
]Z
Z
]
]
Z
]
]
Z
]Z




 






 
W
W
W
W
W
W
W
\
R
R
 
where 
2
/
1
2)
1(
ζ
ω
ω
−
=
o
 and 
ζ
ϕ =
cos
. From differentiation of y(t) to find its maximum yields 


FRV

VLQ
 



M
Z
Z
M
Z
]Z
W
W
R
 which gives 
ϕ
ϕ
ω
tan
)
tan(
=
+
t
 , so that 
ω
π /
n
t =
 . 
The first overshoot occurs for 
ω
π /
=
t
, which on substituting in the solution for y(t) gives 
'

 



 
1
]
)
1
/(
exp[
1
)
(
2
/
1
2
]
]S
t
y
,  where Δ is the per unit overshoot. Thus the response, c(t)
to the given input is 
]
)
(
sin[
)
1(
)]
(
exp[
1
)[
(
)
1(
)
sin(
)
1(
)
exp(
)
(
2
/
1
2
2
/
1
2
M
W
Z
]
W
]Z
W
M
Z
]
]Z













 
t
t
t
u
a
t
t
a
a
t
c
o
o
 which 
for 
τ
>
t
gives
]
)
(
sin[
)
1(
)]
(
exp[
)
1(
)
sin(
)
1(
)
exp(
1
)
(
2
/
1
2
2
/
1
2
M
W
Z
]
W
]Z
M
Z
]
]Z











 
t
t
a
t
t
a
t
c
o
o
 that is
)]
sin(
)
exp(
)
1(
)
sin(
[
)
1(
)
exp(
1
)
(
2
/
1
2
ZW
M
Z
W
]Z
M
Z
]
]Z








 
t
a
t
a
t
t
c
o
o
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
42 
Transfer Functions and their Time Domain Responses
Now if 
ω
π
ζ
ω
π
τ
/
)
1(
/
2
/
1
2
=
−
=
o
then 
)]}
sin(
)]
1
/(
exp[
)
1(
)
sin(
{
)
1(
)
exp(
1
)
(
2
2
/
1
2
S
M
Z
]
]S
M
Z
]
]Z










 
t
a
t
a
t
t
c
o
The term within the brackets is
)]
1(
)[
sin(
)]
sin(
)]
1
/(
exp[
)
1(
)
sin(
1
2
a
a
t
t
a
t
a

'


 








M
Z
S
M
Z
]
]S
M
Z
 
which 
is zero for 
)
1(
a
a
−
=
∆
, that is 
)
1
/(
1
∆
+
=
a
. Thus 
1
)
(
=
t
c
 for 
τ
>
t
if 
2
/
1
2)
1(
/
ζ
ω
π
τ
−
=
o
and 
)
1
/(
1
∆
+
=
a
, as required. 
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Get Help Now
Go to www.helpmyassignment.co.uk for more info
Need help with your
dissertation?
Get in-depth feedback & advice from experts in your 
topic area. Find out what you can do to improve
the quality of your dissertation!

Control Engineering Problems with Solutions
43 
Transfer Functions and their Time Domain Responses
Comment
There is a nice physical explanation for this result. Consider a load suspended vertically on a rod for 
which the anchor point is free to move horizontally in the x direction and it is moved instantaneously a 
distance a. Then the load will start to move to below the anchor point. If the motion is described by the 
second order differential equation corresponding to the above transfer function it will overshoot. When 
it reaches its overshoot, where its velocity will be zero, if the anchor point is then moved instantaneously 
to be directly above it, which will be a further distance aΔ, then the motion will stop. This concept was 
originally due to Smith [3.1] and called posicast control. More recently the general approach where the 
input form is adjusted to produce a desired output, has become known as input shaping and has received 
considerable attention in recent years in the control engineering literature.
Example 3.8
The sinusoidal signal 
)
sin(
θ
ω +
t
is applied to a network with transfer function 
)
1
/(
1
sT

 at time 
0
=
t
. 
Find the output. What should be the value of θ for no transient to be observed in the output? 
This is a simple example to illustrate the fact that when applying a sinusoidal signal to any dynamic 
system the steady state sinusoidal output which gives the frequency response is only attained after a 
transient has decayed.
First the Laplace transform of 
)
sin(
θ
ω +
t
is required. It can be seen from 3 in Table 1 that with 
0
=
ζ
 
the Laplace transform of 
t
ω
sin
is 
2
2
ω
ω
+
s
so that by differentiation the Laplace transform of 
t
ω
ω cos
is 
2
2
ω
ω
+
s
s
giving the Laplace transform of 
t
ω
cos
as 
2
2
ω
+
s
s
, or the result can be obtained directly 
from 4 with 
0
=
ζ
. Thus the Laplace transform of 
)
sin(
θ
ω +
t
which equals 
θ
ω
θ
ω
sin
cos
cos
sin
t
t
+
is
2
2
sin
cos
ω
θ
θ
ω
+
+
s
s
. 
Therefore the output Y(s) from the transfer function is given by 
}
)
1
1
}{
sin
cos
{
2
2
sT
s
s



Z
T
T
Z
 . 
Putting into partial fractions as 
A
+ Bs + C
1 + sT
s2 + ω2  yields 
2
2
2
1
sin
cos
T
T
T
A
Z
T
T
Z


 
,  
2
2
1
cos
sin
T
T
B
ω
θ
ω
θ
+
−
=
 and 
2
2
2
1
cos
sin
T
T
C
ω
θ
ω
θ
ω
+
+
=
. Inverting the partial fraction expansion gives 
t
C
t
B
Ae
T
t
Z
Z
Z
sin
)
/
(
cos
/



 which on substituting for A, B and C, and after some algebra gives 
the solution for the output, y(t), of
)
sin(
)
1(
1
}
1
sin
cos
{
)
(
2
/
1
2
2
/
2
2
2
φ
ω
ω
ω
θ
θ
ω
+
+
+
+
−
=
−
t
T
e
T
T
T
t
y
T
t
 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
44 
Transfer Functions and their Time Domain Responses
where 
T
ω
θ
φ
1
tan−
−
=
. The first term is the transient term which essentially becomes zero after 
T
5
and the second term is the steady state sinusoidal output signal. Note as expected its amplitude is 
2
/
1
2
2
)
1
/(
1
T
ω
+
and it lags the input by 
T
ω
1
tan−
as is obtained by putting 
ω
j
s =
into the transfer 
function. For the transient term to be zero requires 
0
sin
cos
2
=
−
θ
θ
ω
T
T
so that 
T
ω
θ =
tan
. This 
is as expected since the output starts from zero and must therefore be 
t
ω
sin
 with no transient, which 
is confirmed by the steady state term in the solution as
0
=
φ
.
References
3.1 Smith O.J.M. Feedback Control Systems. McGraw-Hill, New York, 1958.
3.3	
Problems
Problem 3.1 
Find the unit step response of the transfer function 
3
4
8
6
)
(
2
2
+
+
+
+
=
s
s
s
s
s
G
.
[
t
t
e
e
3
)
6
/
1(
)
2
/
3
(
)
3
/
8
(
−
−−
−
]
Problem 3.2 
Find the unit impulse response of the transfer function 
)
3
(
)
2
(
1
)
(
2
+
+
+
=
s
s
s
s
G
.
[
t
t
t
te
e
e
2
3
2
2
2





] 
Problem 3.3 
Find the unit impulse and unit step response of the transfer function 
2)
2
(
1
)
(
+
−
=
−
s
e
s
G
s
.
[
)1
(
}
)1
(
5.0
25
.0
25
.0
{
5.0
25
.0
25
.0
)
1
(
2
)
1
(
2
2
2













t
u
e
t
e
te
e
t
t
t
t
] 
Problem 3.4 
Find the unit impulse response of the transfer function
5
2
1
)
(
2
+
+
=
s
s
s
G
. Use the result to obtain the 
unit impulse response of the transfer function 
5
2
3
)
(
2
+
+
−
=
s
s
s
s
G
.
[
t
e t
2
sin
5.0

;
t
e
t
e
t
t
2
sin
2
2
cos



] 
Problem 3.5 
Find the unit step response of the transfer function 
5
2
5
)
(
2
+
+
=
s
s
s
G
. What is the final value of the 
output? Check this result by using the final value theorem.
[
t
e
t
e
t
t
2
sin
5.0
2
cos
1
−
−
−
−
; 1]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
45 
Transfer Functions and their Time Domain Responses
Problem 3.6
What is the maximum overshoot for the step response of Problem 3.5. Check the result using Matlab
[20.8%, or .208 per unit{
2
/
π
−
e
}]
Problem 3.7 
Find the unit step response of the transfer 
)
2
(
)1
(
)
(
2
2
+
+
=
−
s
s
e
s
G
s
 function.
[
)
2
(
]
5.0
)
2
(
5.0
)
2
(
2
)
2
(
−
−
−
−
−
−
−
−
t
u
e
e
t
t
t
]
Problem 3.8
Use Matlab to obtain the partial fraction expansion 
4
9
10
6
2
)
(
2
3
4





 
s
s
s
s
s
s
G
,  and hence determine 
its impulse response.
[p = 0.0513 0.3333 -0.1923 - 0.1999i -0.1923 + 0.1999i
r = -4.0000 -1.0000 -0.5000 + 0.8660i -0.5000 - 0.8660i
}
866
.0
cos
385
.0
866
.0
sin
288
.0
{
3333
.0
0513
.0
5.0
4
t
t
e
e
e
t
t
t
−
−
+
+
−
−
−
]
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
By 2020, wind could provide one-tenth of our planet’s 
electricity needs. Already today, SKF’s innovative know-
how is crucial to running a large proportion of the 
world’s wind turbines. 
Up to 25 % of the generating costs relate to mainte-
nance. These can be reduced dramatically thanks to our 
systems for on-line condition monitoring and automatic 
lubrication. We help make it more economical to create 
cleaner, cheaper energy out of thin air. 
By sharing our experience, expertise, and creativity, 
industries can boost performance beyond expectations. 
Therefore we need the best employees who can 
meet this challenge!
The Power of Knowledge Engineering
Brain power
Plug into The Power of Knowledge Engineering. 
Visit us at www.skf.com/knowledge

Control Engineering Problems with Solutions
46 
Transfer Functions and their Time Domain Responses
Problem 3.9
An R-C circuit has the input applied to the series combination and the output taken from across the 
capacitor. The input is sin(t+ϕ), R=1MΩ and C=1µF. Find the value of ϕ so that there is no transient in 
the output. Check you answer using Simulink.
[45°] 
Problem 3.10 
Find using Matlab the smallest value of T for which the transfer function 
)
5
2
)(
1(
5
)
(
2



 
s
s
sT
s
G
 
will not have an overshoot for a step input. 
[0.81]
Problem 3.11
Find using Matlab the largest value of T for which the transfer function 
)
5
2
)(
1
2
(
)
1(
5
)
(
2




 
s
s
s
sT
s
G
 will 
not have an overshoot for a step input. 
[1.45]
Problem 3.12
Find using Matlab the largest value of T for which the transfer function 
)
2
(
)1
(
)
1(
2
)
(
2



 
s
s
sT
s
G
 will not 
have an overshoot for a step input. 
[≈1.2]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
47 
Frequency  Response s a nd th eir Plottin
4	 Frequency Responses and their 
Plotting
4.1	
Introduction
The frequency response, or more correctly steady state frequency response, of a transfer function G(s) 
is G(jω). The topic is covered in chapter 4 of reference 1. Briefly G(jω) is a complex number with a 
magnitude and argument (phase) so that if one wishes to show its behaviour over a frequency range then 
one has 3 parameters to deal with the frequency, ω, the magnitude, M, and the phase φ. Alternatively 
it can be written in terms of its real X(jω) and imaginary Y(jω) components. The former is the polar 
representation of a complex number and the latter the rectangular version. Students should become 
familiar with working with both the polar and rectangular forms as dependent on what is required one 
approach may prove superior. Engineers use three common ways to plot the information, which are 
known as Bode diagrams, Nyquist diagrams and Nichols diagrams as discussed in chapter 4 of reference 1.
The examples in this section deal with frequency responses and their plotting and again have been chosen 
to try and illustrate important points.
4.2	
Examples
Example 4.1
A network has a transfer function of 
n
sT
s
G
)
1
/(
1
)
(

 
. Calculate the frequency at which it will have 
a phase shift of -180° and the corresponding gain. What are the values for n = 3 and 6. Check the result 
for n = 3 using Matlab and explain how you have obtained the result. 
This example is chosen to illustrate a situation where the best approach is to work in the polar form (i.e. 
gain and phase). Here
2
/
2
2
)
1(
1
|)
(
|
n
T
j
G
ω
ω
+
=
 and 
)
(
tan
)
(
1
T
n
j
ArgG
ω
ω
−
=
.
Thus the phase is -180° when
π
ω
=
−
)
(
tan 1
T
n
, which gives 
)
/
tan(
n
T
π
ω
=
 and a corresponding gain 
of 
2
/
2
)]
/
(
tan
1[
1
|)
(
|
n
n
j
G
S
Z

 
.
In particular for n = 3, 
3
)
3
/
tan(
=
=
π
ωT
and 
125
.0
8
1
)
3
1(
1
|)
(
|
2
/
3
=
=
+
=
ω
j
G
 ; and for n = 6, 
3
/
1
)
6
/
tan(
=
=
π
ωT
and 
.
650
.0
8
3
3
)
3
1
1(
1
|)
(
|
2
/
3
=
=
+
=
ω
j
G
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
48 
Frequency  Response s a nd th eir Plottin
The commands to get the Nyquist plot in Matlab for n = 3 are
 >>G=tf(1,[1 3 3 1]);
 >> nyquist(G)
The plot is shown in Figure 4.1 and is drawn for both positive and negative frequencies, ω. The arrows 
mark the direction of increasing ω and the plot for negative ω is the mirror image in the real axis of that 
for positive ω. Or stated alternatively, the expression for a Nyquist plot has a real part which is an even 
function of ω and an imaginary part which is an odd function of ω. (See Example 4.2)
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
System: G
Real: -0.122
Imag: -0.000785
Frequency (rad/sec): -1.81
Nyquist Diagram
Real Axis
Imaginary Axis
Figure 4.1 Nyquist plot for example 4.1
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Control Engineering Problems with Solutions
49 
Frequency  Response s a nd th eir Plottin
To find the gain and frequency when the phase is -180° the cursor can be used as shown in Figure 4.1 
to obtain an approximate result or the command margin(G), which gives 18.1dB (this corresponds to 
-0.125) at a frequency of 1.73 rads/s. (See Example 5.2 for a further explanation).
Example 4.2
Prove that the frequency response of a transfer function G(s) has a real part which is even in ω and an 
imaginary part which is odd in ω.
It will be assumed that the transfer function does not have a time delay, although if this may not be 
the case the result is still easily shown to be true. Let 
)
(
)
(
)
(
s
A
s
B
s
G
=
 thus 
)
(
)
(
)
(
ω
ω
ω
j
A
j
B
j
G
=
  which can be 
written 
)
(
)
(
)}
(
)
(
)}{
(
)
(
{
)
(
)
(
)
(
)
(
)
(
2
2
2
2
2
2
2
2
2
2
2
2
2
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
F
E
F
j
E
D
j
C
F
j
E
D
j
C
j
G



 


 
 which can be written 
2
2
2
2
}
{
)
(
F
E
CF
DE
j
DF
CE
j
G
Z
Z
Z
Z




 
 where the dependence of the polynomials C, D, E, and F on
2
ω  
has been omitted. Thus 
2
2
2
2
)}
(
Re{
F
E
DF
CE
j
G
Z
Z
Z


 
 which is even and 
2
2
2
)
(
)
(
Im{
F
E
CF
DE
j
G
Z
Z
Z


 
 which 
is odd. 
Example 4.3
Show that the phase lead network 
T
s
sT
s
G
D


 1
1
)
(
 where 
1
<
α
has a maximum phase lead of sin−
−
+
1 1
1
α
α  
at the angular frequency of ω
α
m
T
=
1
 and that the corresponding gain in dB is 
D
10
log
10

. [Quoted 
without proof in chapter 7 of reference 1].
Here 
T
j
T
j
j
G
ZD
Z
Z


 1
1
)
(
 and to simplify the algebra we let 
T
u
ω
=
so that the phase lead is 
2
1
1
1
1
tan
tan
tan
u
u
u
u
u
α
α
α
+
−
=
−
−
−
−
. Here the very useful relationship for arc tangent functions, namely 
AB
B
A
B
A
#
1
tan
tan
tan
1
1
1
r
 
r



 has been used. Differentiating the expression 
2
1
u
u
u
X
α
α
+
−
=
 with respect to u 
and equating to zero gives 
)
1
)(
1(
2
)
1(
2
u
u
u
D
D
D
D


 

 giving 
1
2 =
u
α
, that is 
α
ω
T
/
1
=
. Thus the 
maximum phase lead is 
α
α
α
α
α
α
+
−
=
−
=
−
−
−
−
−
1
1
sin
2
1
tan
tan
/
1
tan
1
1
1
1
 and the gain is 
2
/
1
2
2
2
/
1
2
)
1(
)
1(
u
u
α
+
+
 
which with 
α
/
1
=
u
substituted becomes 
α
/
1
, that is 
D
10
log
10

 in dB.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
50 
Frequency  Response s a nd th eir Plottin
Example 4.4
Sketch the Bode and Nyquist diagrams for the transfer function 
)
1(
2
1
)
(
s
s
s
s
G
+
−
=
 and check the results 
using Matlab. 
For the Bode diagram the transfer function is considered as the individual terms:-
1)	
s
2
1−
for the rhs plane zero, which in terms of asymptote sketching rises at +6dB/octave 
from a break point at 0.5rad/s. The phase varies from 0° to -90°.
2)	
s
1 for the integrator, a line of slope -6dB/octave with 0dB gain at 1 rad/s. A constant phase of 
-90°
3)	
s
+
1
1  for the lhs plane pole, which has a slope of -6dB/octave from the break point at 1 rad/s. 
The phase varies from 0° to -90°. 
The three individual Bode plots are shown in Figure 4.2, as 1, 2 and 3 respectively together with that 
for their ‘sum’ G(s) as 4. Note that the phase curve cannot be estimated from the magnitude curve as 
the transfer function is not minimum phase, {i.e. the final slope is -6db/octave (or -20dB/decade) but 
the phase is -270°}.
Information from the Bode diagram can, of course, be used to assist in sketching the Nyquist plot, but if 
the former is not required the following points can easily be seen by considering the individual elements 
in G(s) as done in the Bode diagram or directly from
)
( ω
j
G
, from which it can be seen that:-
1)	 At low frequencies the phase shift tends to -90° and the magnitude to infinity
2)	 At high frequency the phase tends to -270° and the gain to zero.
3)	 From low frequencies to high frequencies the phase varies continuously from -90° to -270° 
and the gain reduces continuously. At some frequency the phase must be -180°.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
51 
Frequency  Response s a nd th eir Plottin
-50
0
50
Magnitude (dB)
10
-2
10
-1
10
0
10
1
10
2
-360
-270
-180
-90
0
Phase (deg)
Bode Diagram
Frequency  (rad/sec)
data1
data2
data3
data4
Figure 4.2 Bode diagram for G(s) of example 4.4.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Control Engineering Problems with Solutions
52 
Frequency  Response s a nd th eir Plottin
-3
-2.5
-2
-1.5
-1
-0.5
0
0.5
-10
-8
-6
-4
-2
0
2
4
6
8
10
System: G3
Real: -2
Imag: 0.00269
Frequency (rad/sec): -0.71
Nyquist Diagram
Real Axis
Imaginary Axis
Figure 4.3 Nyquist plot for G(s) of example 4.4
To obtain further information on the Nyquist plot requires some calculations. Points of interest are 
obviously where the phase is -180° and the low frequency asymptote, which is not necessarily the negative 
imaginary axis as many sketches in books often seem to indicate. From phase considerations the argument 
of 
)
( ω
j
G
is 
Z
Z
1
1
tan
90
2
tan





$
. This is -180° where 
$
90
2
1
3
tan
tan
2
tan
2
1
1
1
 

 




Z
Z
Z
Z
, 
which gives 
707
.0
2
/
1
=
=
ω
. The corresponding gain is 
2
)
2
1
1(
2
/
1
)
2
1(
2
/
1
2
/
1
=
+
+
, which are in agreement 
with the Nyquist plot shown in Figure 4.3. Writing 
)
1(
)
1
)(
2
1(
)
1(
2
1
)
(
2
Z
Z
Z
Z
Z
Z
Z
Z



 


 
j
j
j
j
j
j
j
G
 in rectangular 
form 
)
(
)
(
Z
Z
jY
X

 gives 
)
1(
3
)
(
2
ω
ω
+
−
=
j
X
 which tends to -3 as ω tends to zero.
Note that since the Nyquist plot goes to infinity at zero frequency the infinite semicircle closure at this 
frequency given by the theory is not shown as may be required for stability assessment. (See Example 5.4). 
Although this can be found theoretically it can also be found using Matlab by replacing the integrator 
by a ‘lossy integrator’, that is 
s
1  by 
ε
+
s
1
where ε is small. The Nyquist plot is shown in Figure 4.4 with 
05
.0
 
H
.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
53 
Frequency  Response s a nd th eir Plottin
-5
0
5
10
15
20
-15
-10
-5
0
5
10
15
Nyquist Diagram
Real Axis
Imaginary Axis
Figure 4.4 Nyquist plot for example 4 with ‘lossy integrator’.
Example 4.5
Find for the transfer function 
)
2
(
)
(
2
2
2
o
o
o
s
s
s
s
G
Z
]Z
Z


 
 the frequency at which it has a phase shift of 
–180° and the corresponding gain. Check the result using Matlab for 
4
=
o
ω
and 
.2.0
=
ζ
 
The given transfer function 
)
2
(
)
(
2
2
2
o
o
o
j
j
j
G
Z
Z
]Z
Z
Z
Z
Z



 
 may be considered as an integrator 1/s in 
series with an underdamped second order system. The integrator gives a phase of –90° at all frequencies 
so the phase shift of the two in series will be –180° when the second order underdamped transfer function 
has a phase shift of –90°. This can easily be seen to be the case when 
o
ω
ω =
and its response will be 
jζ
2
/
1
−
 (see also Figure 4.2 reference 1 for the frequency response of the second order transfer function). 
Thus the gain of the transfer function at the frequency 
o
ω
ω =
is 
o
]Z
2
/
1
. For 
4
=
o
ω
and 
1.0
=
ζ
 the 
gain is 1.25 = 1.94 dB at 4 rads/s, which is confirmed to cursor accuracy, by the Bode plot of Figure 4.5.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
54 
Frequency  Response s a nd th eir Plottin
-100
-50
0
50
System: G
Frequency (rad/sec): 3.98
Magnitude (dB): 1.95
Magnitude (dB)
10
-1
10
0
10
1
10
2
-270
-225
-180
-135
-90
Phase (deg)
Bode Diagram
Frequency  (rad/sec)
Figure 4.5 Bode plot for example 4.5
Example 4.6
Determine the low frequency asymptote for the Nyquist plot of 
)
1
)(
1(
1
)
(
3
2
1
sT
sT
s
sT
s
G



 
What should be the relationship between the time constants if the asymptote is to be the imaginary axis?
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
EXPERIENCE THE POWER OF 
FULL ENGAGEMENT…
     RUN FASTER.
          RUN LONGER..
                RUN EASIER…
READ MORE & PRE-ORDER TODAY 
WWW.GAITEYE.COM
Challenge the way we run

Control Engineering Problems with Solutions
55 
Frequency  Response s a nd th eir Plottin
For this example it is noted that at low frequencies the gain tends to infinity at a phase of -90° 
and at high frequencies the gain tends to zero and the phase to -180°. The low frequency phase of 
-90° does not necessarily mean that the locus at zero frequency finishes on the negative imaginary 
axis as it may tend to an asymptote other than the imaginary axis. Often this is not clearly shown 
in sketches of Nyquist plots given in some textbooks. To solve this example one needs to work in 
rectangular coordinates. Thus 
)
1
)(
1(
)
1
)(
1
)(
1(
)
1
)(
1(
1
)
(
2
3
2
2
2
2
3
2
1
3
2
1
T
T
j
T
j
T
j
T
j
T
j
T
j
j
T
j
j
G
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z





 



 
giving 
)
1
)(
1(
)
(
)
(
Re
2
3
2
2
2
2
3
2
1
3
2
1
2
T
T
T
T
T
T
T
T
j
G
Z
Z
Z
Z






 
. Hence as the frequency tends to zero the real part of the 
locus tends to the value
3
2
1
T
T
T
−
−
. In particular if 
3
1 =
T
 and 
1
2 =
T
, then for the three values of 1, 2 
and 3 for 
3T the asymptote is at 1, 0 and -1 as shown in the Nyquist plots for positive frequencies only 
shown in Figure 4.6. For the imaginary axis to be the asymptote 
3
2
1
T
T
T
+
=
.
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
-12
-10
-8
-6
-4
-2
0
Real
Ýmaginary
3
2
1
Values of T3
in the boxes
Figure 4.6 Nyquist plots for positive frequencies for different values of T3.
Example 4.7
Sketch the Bode and Nyquist diagrams for the transfer function 
)1
)(
1
(
16
2
)
(
2




 
s
s
s
s
s
s
G
 . 
First, for the Bode diagram, it is best to write the transfer function in the form 
)
1
)(
1(
)
16
2
(
)
(
2
s
s
s
s
s
s
G





 
. The 
transfer function is seen to consist of the five components:-
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
56 
Frequency  Response s a nd th eir Plottin
1)	 A second order numerator term with a natural frequency of 4 and damping ratio of 0.25 
with an asymptotic approximation of an increasing gain at 12dB/octave from ω = 4 and 
phase from 0 to 180°.
2)	 An integrator, constant slope of -6dB/octave with 0dB at ω = 1 and phase of -90°. 
3)	 A time constant term corresponding to a pole at 1. Break point at ω = 1 and decreasing 
gain. Phase shift from from 0° to 90°. 
4)	 A time constant term corresponding to a pole at -1. Break point at ω = 1 and decreasing 
gain. Phase shift from from 0° to -90°. 
5)	 A gain of -1, that is a magnitude of 1 and a phase shift of -180°.
Thus in terms of an asymptotic plot the initial gain decreases with increase in frequency at -6dB/octave (due 
to 2) until ω = 1, where it changes to -18dB/octave (due to 3 and 4), and then at ω = 4 it returns to -6dB/
octave (due to 1). The phase starts at -270° (-90° from 2 and -180° from 5}, at ω = 1 it does not change (due 
to 3 and 4) and after ω = 4 (due to 1) it eventually becomes -90°. The Bode plot is shown in Figure 4.7.
The Nyquist plot has infinite gain at low frequencies (due to 2) and a phase of -270° and at high frequencies 
goes to zero gain at a phase of -90°. It can be seen from the Bode plot that the gain decreases steadily, 
apart from between 4 and 8 rad/s where it is roughly constant. The phase changes continuously from 
low to high frequencies with a rapid variation around ω = 4.
-40
-20
0
20
40
60
Magnitude (dB)
10
-1
10
0
10
1
10
2
-270
-225
-180
-135
-90
Phase (deg)
Bode Diagram
Frequency  (rad/sec)
Figure 4.7 Bode diagram for example 4.7
Obvious other points of interest for the Nyquist plot are the asymptote at low frequencies and where 
the phase is -180°. The latter can be found easily since the phases of 3 and 4 cancel each other the phase 
shift will be -180° when the lead produced by 1 is 90°, which is at ω = 4. 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
57 
Frequency  Response s a nd th eir Plottin
By calculationn
)1
)(
1
(
16
2
)
(
2





 
Z
Z
Z
Z
Z
Z
j
j
j
j
j
G
which has a real part of 
1
2
2 +
−
ω
and therefore tends to -2 as the 
frequency tends to zero. The Nyquist plot is shown in Figure 4.8. 
-1.2
-1
-0.8
-0.6
-0.4
-0.2
0
-8
-6
-4
-2
0
2
4
6
8
System: G
Real: -0.115
Imag: 0.00479
Frequency (rad/sec): -4.05
Nyquist Diagram
Real Axis
Imaginary Axis
Figure 4.8 Nyquist plot for example 4.7.
In this case if the integrator is replaced by a ‘lossy integrator’ with 
2.0
=
ε
 (made quite large so that the 
original plot can also be seen) then the Nyquist plot is as shown in Figure 4.9. This indicates that the 
infinite semicircle for the Nyquist is in the left hand side of the diagram starting at -90° and going to 90°. 
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
PDF components for PHP developers
www.setasign.com
SETASIGN
This e-book  
is made with 
SetaPDF

Control Engineering Problems with Solutions
58 
Frequency  Response s a nd th eir Plottin
-80
-70
-60
-50
-40
-30
-20
-10
0
-80
-60
-40
-20
0
20
40
60
80
Nyquist Diagram
Real Axis
Imaginary Axis
Plot for 'lossy integrator'
Figure 4.9 Nyquist plot with ‘lossy integrator’ for example 4.7
Example 4.8
Discuss the shape of the Nyquist diagram for 
)
70
)(
16
5.0
(
)
1600
10
)(
1
(
70
.0
)
(
2
2






 
s
s
s
s
s
s
s
G
 before plotting it with 
Matlab.
At zero frequency 
1
70
*
16
1600
*
1
*
70
.0
)
0
(
 
 
G
 and as the frequency, ω, tends to infinity 
70
.0
)
(
)
(
70
.0
)
(
3
3
 
 
Z
Z
Z
j
j
j
G
. Thus the locus starts at 1 and finishes at 0.7 on the real axis. In terms of 
increasing frequency there is a lead with breakpoint at 1rad/s, a pair of complex poles with resonant 
frequency at 4 rad/s and damping 0.0625, which is low, a pair of complex zeros with resonant frequency 
at 40 rads/s and damping 0.125 and finally a lag with break point at 70 rads/s. Thus one expects the 
Nyquist to show a lead initially with an increase in gain peaking around 4 rads/s. and increasing phase 
lag until the gain reaches almost zero at 40 rads/s. The Nyquist plot is shown in Figure 4.10 which clearly 
shows the peak gain around 4 rads/s. Figure 4.11 shows the plot for higher frequencies only, finishing at 
0.7 on the real axis and going near to the origin at around 40 rads/s. The plot shows two intersections 
of the imaginary axis which could be calculated to obtain more detail for a sketch.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
59 
Frequency  Response s a nd th eir Plottin
-5
0
5
10
15
20
25
30
35
-25
-20
-15
-10
-5
0
5
10
15
20
25
System: G
Real: 31.6
Imag: -7.88
Frequency (rad/sec): 3.99
System: G
Real: -0.133
Imag: -1
Frequency (rad/sec): 16.6
Nyquist Diagram
Real Axis
Imaginary Axis
Figure 4.10 Nyquist plot for example 4.8
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
-10
-8
-6
-4
-2
0
2
4
6
8
10
System: G
Real: 0.00107
Imag: -7.33
Frequency (rad/sec): 5.2
System: G
Real: 0.00358
Imag: -0.214
Frequency (rad/sec): 31
Nyquist Diagram
Real Axis
Imaginary Axis
Figure 4.11 Nyquist plot at higher frequencies for example 4.8
4.3	
Problems
Problem 4.1
A feedback system has an open loop transfer function 
2)1
(
/
1
)
(
+
=
s
s
s
G
and
1
)
(
=
s
H
. Obtain the 
Nyquist diagram for 
)
( ω
j
G
on a plot with M circles. From this estimate the peak of the closed loop 
frequency response and the frequency at which it occurs. Check the result by obtaining a Bode plot of 
the closed loop frequency response.
[≈10dB (9.17dB), 0.73rads./s]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
60 
Frequency  Response s a nd th eir Plottin
Problem 4.2
A compensator 
)
(s
Gc
 of the form 
s
sT
s
Gc
1.0
1
1
)
(


 
is to be added before G(s) in problem 3.1. Plot the 
Nyquist diagrams of 
)
(
)
(
s
G
s
Gc
for various values of T and estimate the minimum value of T to ensure 
the maximum value in the closed loop frequency response does not exceed 3dB. Check the result on 
the closed loop Bode plot.
[0.73]
Problem 4.3
A feedback system has a plant transfer function of 
2)
1.0
1
)(
5.0
1
/(
4
)
(
s
s
s
G


 
and a feedback transfer 
function 
sT
e
s
H

 
)
(
. Sketch the asymptotic Bode diagram for G(s) and estimate the phase shift when 
the gain is unity and the frequency at which it occurs. Check your result using Matlab and determine the 
maximum value of T for the system to have a phase shift when the gain is unity of (i) -180° and (ii) -140°.
[-130°, 5.7rads/s; 0.153, 0.031]
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
www.sylvania.com
We do not reinvent  
the wheel we reinvent 
light.
Fascinating lighting offers an infinite spectrum of 
possibilities: Innovative technologies and new  
markets provide both opportunities and challenges. 
An environment in which your expertise is in high 
demand. Enjoy the supportive working atmosphere 
within our global group and benefit from international 
career paths. Implement sustainable ideas in close 
cooperation with other specialists and contribute to 
influencing our future. Come and join us in reinventing 
light every day.
Light is OSRAM

Control Engineering Problems with Solutions
61 
Frequency  Response s a nd th eir Plottin
Problem 4.4
Sketch the asymptotic Bode diagram for
)
5.0
1
)(
1(
/)
4
1(
5.0
)
(
2
s
s
s
s
s
s
G




 
and estimate the 
phase shift when the gain is unity. Check your result using Matlab.
[-168.7°]
Problem 4.5 
Sketch the asymptotic Bode diagram for 
2)
5.0
1(
8
/)
4
1
)(
1(
)
(
s
s
s
s
s
G



 
and estimate the phase 
shift when the gain is unity and the gain when the phase is -180°. Sketch also the Nyquist diagram giving 
the frequency at which the real axis is crossed and the value of the asymptote as the frequency tends to 
zero. Check your results using Matlab.
[-76°, -5.71dB; 2.63, 0.25]
Problem 4.6
Sketch the Nyquist diagram for the transfer function 
)
4
)(
1.0
1(
)
1(
)
(
2
2



 
s
s
s
s
s
G
. Calculate the frequency 
for which the phase is -180° and the value of the asymptote to which it tends for low frequencies.
[1.12, -0.475]
Problem 4.7
A unit negative feedback system has an open loop transfer function 
3
2
)
1(
)
1(
)
(
s
s
s
s
K
s
G
+
+
+
=
. Determine 
the maximum value of K if the closed loop frequency response should never exceed 0dB. Check the 
result using Matlab.
[0.25]
Problem 4.8
Sketch the Nyquist plot of 
)1
)(
1
(
4
)
(
2




 
s
s
s
s
s
s
G
 and evaluate any points at which the axes are cut and 
the corresponding frequencies. Determine also the infinite semicircle closure at ω = 0.
[Real axis at -0.2 with
s
rads /
2
=
ω
; lhs plane from -90° to +90° as ω increases.]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
62 
Feedback Loop Stability
5	 Feedback Loop Stability 
5.1	
Introduction
The problems in this chapter are concerned with the determination of the stability and relative stability 
of a closed loop feedback system. This material is covered in reference 1 chapters 5 and 6, and a brief 
summary is given here.
If the open loop transfer function of the feedback loop, is denoted by G(s) rather than 
)
(s
Gol
, then the 
closed loop transfer function, often denoted by T(s), has a denominator of 1+ G(s). The loop will be 
stable if the roots of the denominator, namely the characteristic equation 
0
)
(
)
(
1
=
=
+
s
F
s
G
, all have 
a negative real part, that is lie in the lhs s-plane. If G(s) does not contain a time delay then F(s)will be a 
polynomial in s with real coefficients
nf , that is 
n
ns
f
s
f
s
f
f
s
F
......
)
(
2
2
1
0
+
+
+
=
. Before the advent 
of modern computing facilities finding the roots of a polynomial of order greater than three was not 
an easy problem. A problem addressed during the 19th century by mathematicians was that of trying to 
find conditions for the roots of a polynomial to have negative real parts and this led to the well known 
Hurwitz-Routh criterion found in all control textbooks. For a polynomial with known coefficients the 
criterion provides a solution and symbolic results can be obtained for some low order polynomials. In 
particular it can be shown that a necessary but not sufficient condition (except for polynomials of order 1 
and 2) is that all the coefficients,
nf , of the polynomial must be positive. For the third order polynomial 
a necessary and sufficient condition is all the coefficients must be positive and 
3
0
2
1
f
f
f
f
>
. 
A graphical criterion due to Mikhailov states that if the polynomial F(jω) is plotted for ω increasing from 
zero on a complex plane, then all its roots will lie in the lhs s-plane if from starting on the positive real 
axis at f0 it moves in a counter clockwise direction passing successively through the positive imaginary 
axis, negative real axis etc in turn, cutting n-1 axes before tending to infinity.
The algorithm ‘roots’ given in Matlab now finds the roots of even quite high order polynomials very 
quickly and because of its speed can be used to assess how the roots vary with changes in the coefficients.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
63 
Feedback Loop Stability
Control engineers are interested in finding the stability from the open loop transfer function G(s). There 
are two reasons for this (i) the fact that the information available on the open loop may be the frequency 
response 
)
( ω
j
G
(particularly true several years ago when frequency response identification testing was 
common) and (ii) compensating networks are typically included inside the loop and thus their effect on 
the open loop transfer function is easily seen. The Nyquist criterion states that the closed loop system 
will be stable if the number of clockwise encirclements by the frequency response locus 
)
( ω
j
G
 of the 
(-1,0) point plus the number of rhs s-plane poles of 
)
( ω
j
G
 is zero. The criterion can also be interpreted 
using Bode or Nichols plots.
The root locus is a method which shows how the roots of the characteristic equation vary with variations 
in a parameter, typically the open loop gain, K. One is often interested in ‘how stable’ a feedback loop is 
and typical measures of this, apart from the root locations provided by use of a root locus, are the gain 
and phase margin and the closed loop frequency response peak, which can be found from the open 
loop frequency response.
The examples covered in this section deal with the above topics. 
5.2	
Examples
Example 5.1
Consider a feedback loop with open loop transfer function 
)1
)(
(
)1
(
)
(
2




 
s
s
a
s
s
s
K
s
G
. 
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
360°
thinking.
© Deloitte & Touche LLP and affiliated entities.
Discover the truth at www.deloitte.ca/careers 

Control Engineering Problems with Solutions
64 
Feedback Loop Stability
a)	 Consider initially the case of K = 6 and a = 4 then the open loop characteristic equation is 
0
4
8
5
5
2
3
4
=
+
+
+
+
s
s
s
s
 and using the Routh-Hurwitz array (see reference 1 Appendix B) gives 
Row label
s4
1
5
4
s3
5
8
s2
17/5
4
s
36/17
 s0
4
.
.
There are no sign changes in the first computed column so the system is stable. 
b)	 Consider now the case when K is unknown and a = 4 then the array becomes
Row label
s4
1
5
K
s3
5
4+K
s2
(21-K)/5
K
s
(K2+8K-84)/(K-21)
 s0
K
.
.
and it can be seen that the penultimate term in the first computed column is negative for K > 6. Checking 
the roots in Matlab for K = 6 gives
>> roots([1 5 5 10 6])
ans =
 -4.3028 
 -0.0000 + 1.4142i
 -0.0000 - 1.4142i
 -0.6972 
showing that the two complex roots have zero real part.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
65 
Feedback Loop Stability
G(s) has one zero at -1, and four poles at 0, -0.5±0.866j and -4. Thus root loci start from the four poles, 
will exist on the negative real axis between 0 and -1 and between -4 and -∞ and the loci starting from 
the complex poles will pass into the rhs of the plane for K = 6, tending to asymptotes at ±60°, which 
intersect on the negative real axis at -4/3. The Matlab plot is shown in Figure 5.1 and this allows the 
location of the closed loop poles to be found for different values of K.
-4.5
-4
-3.5
-3
-2.5
-2
-1.5
-1
-0.5
0
0.5
-2
-1.5
-1
-0.5
0
0.5
1
1.5
2
System: g
Gain: 5.81
Pole: -0.00747 + 1.4i
Damping: 0.00534
Overshoot (%): 98.3
Frequency (rad/sec): 1.4
Root Locus
Real Axis
Imaginary Axis
Figure 5.1 Root locus plot for gains from 0 to 10 for example 5.1.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
We will turn your CV into 
an opportunity of a lifetime
Do you like cars? Would you like to be a part of a successful brand?
We will appreciate and reward both your enthusiasm and talent.
Send us your CV. You will be surprised where it can take you.
Send us your CV on
www.employerforlife.com

Control Engineering Problems with Solutions
66 
Feedback Loop Stability
Figure 5.2 shows Mikhailov plots for the polynomial with three different gains K, from which it can 
again be seen that system is stable for K = 4, neutrally stable for K = 6, and unstable for K = 8. For K = 4 
although the system is stable the pole locations are -4.21, -0.608 and -0.091±1.25j, so the complex pair 
are quite near to the imaginary axis.
-5
0
5
10
15
20
-60
-50
-40
-30
-20
-10
0
10
Real
Ýmaginary
K=4
K=6
K=8
Figure 5.2 Mikhailov plots for Example 5.1 with three different gains K.
The routine used for the Mikhailov plot, as one is not given in Matlab, was:-
function mikplot(w,p)
for i=1:length(w);
num=p;
den=[1];
[rea(i),ima(i)]=nyquist(num,den,w(i));
end
plot(rea,ima)
xlabel(‘Real’)
ylabel(‘Ýmaginary’)
grid
where the inputs required are the (angular) frequency string in w and the polynomial coefficients in p. 
Since the magnitude on the plot increases rapidly with frequency after crossing the final axis the last 
frequency value in w has to be selected with care to get a good plot.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
67 
Feedback Loop Stability
c)	 Consider now the case of a variable and K = 4. The characteristic equation is now 
0
4
)
4
(
)
1(
)
1(
2
3
4
=
+
+
+
+
+
+
+
s
a
s
a
s
a
s
 and the Hurwitz-Routh array is
Row label
s4
1
1+a
4
s3
1+a
4+a
s2
(a2+a-3)/(1+a)
4
s
(a3+a2-7a-16)/ (a2+a-3)
 s0
4
.
.
The s2 term is positive for a > 1.30 and the s term is positive for a > 1.30 and a > 3.04, therefore the system 
is stable for a > 3.04. It can be seen from this array involving a and the previous one involving K that the 
arrays can involve quite cumbersome algebra for large order polynomials with an unknown parameter. 
To plot a root locus to show how the roots vary, the above equation can be divided by the terms not 
involving a to give 
0
4
4
)
(
1
2
3
4
2
3
=
+
+
+
+
+
+
+
s
s
s
s
s
s
s
a
 and the root locus is plotted for an open loop transfer 
function of 
4
4
)
(
)
(
2
3
4
2
3
+
+
+
+
+
+
=
s
s
s
s
s
s
s
a
s
G
 where a replaces K as the parameter on the locus. The transfer 
function is typically unlike a usual open loop transfer function and the numerator and denominator 
have to be factored to get the poles and zeros. From Matlab the zeros are at 0,-0.5±0.866j and the poles 
at 0.67±1.46j, -1.17±0.42j. The root locus is shown in Figure 5.3 for a = 1.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
68 
Feedback Loop Stability
-3
-2.5
-2
-1.5
-1
-0.5
0
0.5
1
-1.5
-1
-0.5
0
0.5
1
1.5
System: g
Gain: 3
Pole: 0.0061 + 1.32i
Damping: -0.00462
Overshoot (%): 101
Frequency (rad/sec): 1.32
Root Locus
Real Axis
Imaginary Axis
Figure 5.3 Root locus for the variable parameter a
Example 5.2 
Consider now the frequency response properties of the same open loop transfer function as Example 
5.1 with a = 4 and K = 1. The Nyquist diagram is shown in Figure 5.4.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
AXA Global 
Graduate Program
Find out more and apply

Control Engineering Problems with Solutions
69 
Feedback Loop Stability
-1.4
-1.2
-1
-0.8
-0.6
-0.4
-0.2
0
-8
-6
-4
-2
0
2
4
6
8
Nyquist Diagram
Real Axis
Imaginary Axis
Figure 5.4 Nyquist diagram for transfer function
To find the gain margin and phase margin for this transfer function one can obviously use the cursor 
on the Nyquist plot, although to get any reasonable accuracy one would obviously have to do a replot 
of Figure 5.4 over a more suitable frequency range. However if the Matlab command ‘margin(G)’ is 
used then the Bode diagrams for the transfer function G are drawn as shown in Figure 5.5. The gain 
and phase margins are indicated on the figure with interpolation of the frequency vector points used 
in the plot employed to give their values quite accurately above the plot. For this case the gain margin 
is 3.52dB and the phase margin 14.4°, both of which are low. This is expected from the pole locations 
given in the previous example. Provided the feedback transfer function H = 1, which will be assumed, 
any peak in the closed loop frequency response can be found by placing M circles on the Nyquist plot, 
which can be done in Matlab by right clicking on the plot with the mouse and selecting ‘grid’ from the 
menu obtained. The result is shown in Figure 5.6 where a frequency vector has been selected with a=-0.3 
and b=2 in the ‘logspace’ command.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
70 
Feedback Loop Stability
-150
-100
-50
0
50
Magnitude (dB)
10
-1
10
0
10
1
10
2
-270
-225
-180
-135
-90
Phase (deg)
Bode Diagram
Gm = 3.52 dB (at 1.41 rad/sec) ,  Pm = 14.4 deg (at 1.19 rad/sec)
Frequency  (rad/sec)
Figure 5.5 Bode diagram showing gain and phase margins.
-1.4
-1.2
-1
-0.8
-0.6
-0.4
-0.2
0
-2.5
-2
-1.5
-1
-0.5
0
0.5
1
1.5
2
2.5
0 dB
-20 dB
-10 dB
-6 dB
-4 dB
-2 dB
20 dB
10 dB
6 dB
4 dB
2 dB
System: g
Real: -0.887
Imag: -0.159
Frequency (rad/sec): 1.25
Nyquist Diagram
Real Axis
Imaginary Axis
Figure 5.6 M circles on the Nyquist plot for Example 5.2.
From Figure 5.6 it can be seen that a peak in the closed loop frequency response of around 15dB at a 
frequency of 1.25 can be expected, which is confirmed in Figure 5.7.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
71 
Feedback Loop Stability
-60
-40
-20
0
20
Magnitude (dB)
10
-1
10
0
10
1
-270
-225
-180
-135
-90
-45
0
Phase (deg)
Bode Diagram
Frequency  (rad/sec)
Figure 5.7 Closed loop frequency response plot for Example 5.3.
Example 5.3.
Consider again the transfer of Example 4.6, namely 
)
1
)(
1(
1
)
(
3
2
1
sT
sT
s
sT
s
G



 
, with the parameter values 
1
2 =
T
and 
2
3 =
T
. It is required to investigate the values of additional loop gain K for the choice of 
3
1 =
T
 which will result in a closed loop frequency response with no resonant peak.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
ibili
because 
e Graduate Programme  
for Engineers and Geoscientists
Month 16
I was a construction
supervisor in 
the North Sea 
advising and 
helping foremen 
solve problems
I was a
he
s
Real work 
International opportunities 

ree work placements
al 
Internationa
or

ree wo
I wanted real responsibili 
 I joined MITAS because 
www.discovermitas.com

Control Engineering Problems with Solutions
72 
Feedback Loop Stability
It can be seen from Figure 5.6 that to satisfy this condition the frequency response of the forward 
loop transfer function G(s) must not have a negative real part greater than 0.5, as the M circle for 
0dB is a straight line parallel to the imaginary axis and passing through -0.5. From example 4.6, 
)
1
)(
1(
)
(
)
(
Re
2
3
2
2
2
2
3
2
1
3
2
1
2
T
T
T
T
T
T
T
T
j
G
Z
Z
Z
Z






 
, which with the parameter values 
1
2 =
T
and 
2
3 =
T
substituted 
gives 
)
4
1
)(
1(
)3
(
2
)
(
Re
2
2
1
1
2
Z
Z
Z
Z





 
T
T
j
G
 . Replacing 
2
ω by u, differentiating the expression with respect to 
u and equating to zero gives 
0
)
8
5
)(
2
3
(
2
*
)
4
1
)(
1(
1
1
1
 






u
uT
T
T
u
u
, which on solving the 
quadratic for u gives u = 
T
T
T
T
8
)
18
132
58
(
)
4
12
(
2
/
1
1
2
1
1





. For the particular choice of 
3
1 =
T
 this 
gives the nice solution of u = 0.5 and the corresponding maximum negative value of Re G(jω) as 0.667. 
Thus for this choice of 
1T the maximum value of the gain K for no peak in the closed loop frequency 
response is 0.75. The frequency response of 0.75G(jω) is shown in Figure 5.8 on a Nyquist plot with M 
circles, and the Bode diagram for the closed loop frequency response with H = 1 in Figure 5.9.
-1
-0.9
-0.8
-0.7
-0.6
-0.5
-0.4
-0.3
-0.2
-0.1
0
-5
-4
-3
-2
-1
0
1
2
3
4
5
0 dB
-10 dB
-6 dB
-4 dB
-2 dB
10 dB
6 dB
4 dB
2 dB
System: g
Real: -0.498
Imag: -1.1
Frequency (rad/sec): 0.745
Nyquist Diagram
Real Axis
Imaginary Axis
Figure 5.8 Nyquist plot of KG(jω) for example 5.3.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
73 
Feedback Loop Stability
-80
-60
-40
-20
0
Magnitude (dB)
10
-2
10
-1
10
0
10
1
10
2
-180
-135
-90
-45
0
Phase (deg)
Bode Diagram
Frequency  (rad/sec)
 Figure 5.9 Closed loop frequency response for example 5.3.
Example 5.4.
Determine the range of K for stability from the Nyquist plots of closed loop systems with the following 
open loop transfer functions.
a)	
)
2
)(
1
(
)1
(
)
(
2



 
s
s
s
K
s
G
.
b)	
)1
2.0
(
)1
(
)
(
2
+
−
+
=
s
s
s
K
s
G
.
c)	
)1
)(
2
(
)1
(
)
(
2



 
s
s
s
s
K
s
G
. 
d)	
)
16
2.1
(
)1
(
10
)
(
2
3
2



 
s
s
s
s
K
s
G
.
The solutions to these types of questions are often most easily done using the Routh-Hurwitz criterion 
or the root locus but they are done here to show applications of the Nyquist Criterion.
a) The first example contains a lead term, a lag term and a second order lag with no damping. For K = 1 
it starts on the real axis at 0.5 and finishes at the origin with a phase of 180°. Because there is no damping 
in the second order lag the Nyquist plot goes to infinity for ω = 1, so that use of the Matlab command 
‘nyquist’ gives the very uninformative plot shown in Figure 5.10. 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
74 
Feedback Loop Stability
-14
-12
-10
-8
-6
-4
-2
0
2
x 10
14
-5
-4
-3
-2
-1
0
1
2
3
4
5
x 10
14
Nyquist Diagram
Real Axis
Imaginary Axis
Figure 5.10 Nyquist plot for G(s) of example 5.4(a).
One can generate a frequency vector by taking a set of points from near zero to just less than ω = 1 and 
another set from just above ω = 1 to a relatively large value and then plot the Nyquist as shown below 
to obtain the plot in Figure 5.11
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
MASTER IN MANAGEMENT
mim.admissions@ie.edu
Follow us on IE MIM Experience
www.ie.edu/master-management
#10 WORLDWIDE
MASTER IN MANAGEMENT 
FINANCIAL TIMES
55 Nationalities
in class
5 Specializations
Personalize your program 
Length: 1O MONTHS
Av. Experience: 1 YEAR
Language: ENGLISH / SPANISH
Format: FULL-TIME
Intakes: SEPT / FEB
• STUDY IN THE CENTER OF MADRID AND TAKE ADVANTAGE OF THE UNIQUE OPPORTUNITIES
  THAT THE CAPITAL OF SPAIN OFFERS
• PROPEL YOUR EDUCATION BY EARNING A DOUBLE DEGREE THAT BEST SUITS YOUR
  PROFESSIONAL GOALS
• STUDY A SEMESTER ABROAD AND BECOME A GLOBAL CITIZEN WITH THE BEYOND BORDERS
  EXPERIENCE
93%
OF MIM STUDENTS ARE
WORKING IN THEIR SECTOR 3 MONTHS
FOLLOWING GRADUATION

Control Engineering Problems with Solutions
75 
Feedback Loop Stability
>> w1=logspace(-2,-0.05,500);
>> w2=logspace(0.05,2,500);
>> w=[w1 w2];
 >> nyquist(g,w)
The problem with this plot is that the plot routine joins together the points obtained after the low 
frequency plot is obtained from A (textbox added) to B, the last point at B is joined to C the start of 
the high frequency plot. This means the infinite semicircle is replaced by the straight line from B to C.
-3
-2
-1
0
1
2
3
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
Nyquist Diagram
Real Axis
Imaginary Axis
A
B
C
Figure 5.11 Nyquist plot for defined frequency vector for example 5.4(a).
Alternatively, two separate plots can be done one for the frequencies below ω = 1 and the other for the 
frequencies above to obtain Figure 5.12 by using the Matlab statements:-
>> nyquist(g,w1)
>> hold
Current plot held
 >> nyquist(g,w2)
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
76 
Feedback Loop Stability
-3
-2
-1
0
1
2
3
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
Nyquist Diagram
Real Axis
Imaginary Axis
A
B
C
Figure 5.12 Nyquist plot for two frequency vectors for example 5.4(a).
The true plot has an infinite semicircle from beyond B to before C so there is no encirclement of the 
(-1, 0) point. i.e. N=0. Also since the transfer function has no rhs s-plane poles, P=0, and the loop is 
stable for K > 1. 
b) The Nyquist plot of 
)1
2.0
(
)1
(
)
(
2
+
−
+
=
s
s
s
K
s
G
 for  K = 1 starts at 1 on the real axis and finishes at the origin 
with a phase of -90°. It is easy to show that it crosses the real axis at -5. Since there are two complex rhs 
s-plane poles P = 2. The plot is shown in Figure 5.13 and it has two counter clockwise encirclements 
of the (-1, 0) point so N = -2. Thus Z the number of rhs s-plane closed loop poles is 2 – 2 = 0 and the 
closed loop system is stable.
-6
-5
-4
-3
-2
-1
0
1
2
-8
-6
-4
-2
0
2
4
6
8
Nyquist Diagram
Real Axis
Imaginary Axis
Figure 5.13 Nyquist plot for example 5.4(b)
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
77 
Feedback Loop Stability
If the gain K is reduced to less than 0.2, however, there will be no encirclements of the (-1, 0) point, so 
that N = 0 and Z = 2. Thus the system is unstable for K > 0.2. 
c) For this case 
)1
)(
2
(
)1
(
)
(
2



 
s
s
s
s
K
s
G
 and the Nyquist locus is seen to start at infinity with a phase of -90° 
and finish at the origin with a phase of -90°. There are two real rhs s-plane poles so P = 2. The Nyquist 
plot is shown in Figure 5.14 for K –1 using a defined frequency vector to obtain a better plot near the 
origin. Before the closed loop stability can be assessed the infinite semicircle closure needs to be found. 
Theoretically this is done by taking a small semicircle in the rhs s-plane mapping around the pole at 
the origin. If this is done as frequency increases along the imaginary axis from a negative to a positive 
value (the argument goes from -90° through 0° to +90°) then the argument in 
)
(s
G
 changes from +90° 
through 0° to -90° so the infinite semicircle on 
)
( ω
j
G
 is in the rhs s-plane. This is confirmed in Figure 
5.15 where a ‘leaky integrator’ with 
05
.0
 
H
 has been used. 
-1
-0.5
0
0.5
1
1.5
2
-5
-4
-3
-2
-1
0
1
2
3
4
5
Nyquist Diagram
Real Axis
Imaginary Axis
Figure 5.14 Nyquist plot for Example 5.4(c)
Thus for K = 1, N = 0 and the closed loop system is unstable. As the gain is increased the Nyquist point (-1, 
0) will eventually lie inside the double loop at the lhs of the plot. The point where the Nyquist crosses the 
negative real axis can be found using the ‘margin’ command, which gives a gain margin of 10.6dB, or by 
obtaining a more accurate graph near to the crossover frequency. Note the margin command gives a gain 
where the phase is -180°, it does not indicate stability. The corresponding gain is 
39
.3
10
10
20
/
6.
10
20
/
 
 
dB
. 
Thus for gains greater than this value there will be two counter clockwise encirclements of the (-1, 0) 
point, giving N = -2, so that Z = 0 and the closed loop system will be stable. Thus the closed loop system 
is stable for gains greater than 3.39 which is confirmed by the Hurwitz-Routh criterion.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
78 
Feedback Loop Stability
-2
0
2
4
6
8
10
-5
-4
-3
-2
-1
0
1
2
3
4
5
Nyquist Diagram
Real Axis
Imaginary Axis
Figure 5.15 Nyquist plot for Example 5.4(c) with a ‘leaky integrator’.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Control Engineering Problems with Solutions
79 
Feedback Loop Stability
d) In this case 
)
16
2.1
(
)1
(
10
)
(
2
3
2



 
s
s
s
s
K
s
G
 and since the transfer function contains a triple integration it 
starts at low frequencies at infinity with a phase of -270° and finishes at the origin with the same phase 
of -270°. The numerator lead time constants are both at unity and the lag term is second order with a 
frequency of 4 rad/s. and a light damping ratio of 0.15. There is thus a possibility it may cross the negative 
real axis. The default Nyquist plot with K = 1 is shown in Figure 5.16. This is of no good for assessing 
stability because the detail for frequencies near the origin is missing and the closures at infinity are not 
of course given. For the latter it can be shown theoretical that as the frequency increases around the 
small semicircle to the right of the three poles at the origin the phase of the transfer function due to 
the three poles changes from 270° (-90°) through 180°, 90° and 0° and continues to -270° (+90°), that 
is a total phase change on the Nyquist plot of 540° in a clockwise direction with increasing frequency. 
-700
-600
-500
-400
-300
-200
-100
0
100
-8000
-6000
-4000
-2000
0
2000
4000
6000
8000
Nyquist Diagram
Real Axis
Imaginary Axis
Figure 5.16 Nyquist plot for example 5.4(d).
To examine the plot near the origin a frequency vector from 
3.0
10  to 
2
10  was used and the plot is shown 
in Figure 5.17.
-5
-4
-3
-2
-1
0
1
-4
-3
-2
-1
0
1
2
3
4
Nyquist Diagram
Real Axis
Imaginary Axis
Figure 5.17 Nyquist plot for higher frequencies for example 5.4(d)
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
80 
Feedback Loop Stability
The negative real axis is cut at approximately -1.14 and -0.574. For K = 1 the encirclements N = 0 as the 
small one near the origin is in the counterclockwise direction and the one at infinity is in a clockwise 
direction. For gains less than 1/1.14 = 0.877 or greater than 1/0.574 = 1.74 the Nyquist point will be 
encircled twice in the clockwise direction, giving N = 2. The system is therefore stable for 
74
.1
88
.0

 K
.
Example 5.5
Obtain the root locus for the transfer function given in Example 5.4(d).
The transfer function has a gain of 10, two zeros at -1 and five poles three at the origin and the other two 
at - 0.6 ± 3.95j. The relative degree is 3 so that three loci tend to infinity along asymptotes at ±60° and 
180°, which intersect at 0.8 on the real axis. There is a locus on the negative real axis from the origin (i.e. 
to the left of an odd number of singularities) to infinity, and since the system is unstable for small gains 
the other two branches from the origin must initial go into the rhs s-plane. Since the system becomes 
stable for a small gain range it is likely that the roots starting at the two complex poles move into the 
rhs s-plane for a gain slightly higher than that obtaining when the complex root paths from the origin 
move into the lhs s-plane. The plot obtained from Matlab is shown in Figure 5.18 from which it will be 
seen that the gain range for stability agrees with that from the Nyquist criterion.
Root Locus
Real Axis
Imaginary Axis
-2.5
-2
-1.5
-1
-0.5
0
0.5
1
1.5
2
2.5
-6
-4
-2
0
2
4
6
System: g
Gain: 1.75
Pole: 0.00541 + 3.66i
Damping: -0.00148
Overshoot (%): 100
Frequency (rad/sec): 3.66
System: g
Gain: 0.865
Pole: 0.00228 - 1.08i
Damping: -0.00211
Overshoot (%): 101
Frequency (rad/sec): 1.08
Figure 5.18 Root locus plot for Example 5.4(d)
Example 5.6
Find the value of α and the corresponding value of K on the root locus for all three roots on the locus 
to be real and equal for the transfer function 
)
1(
)
1(
)
(
2
sT
s
sT
K
s
G
D


 
. Show further that as α goes through 
this value the shape of the root locus changes and also that for this choice of α the required value of K 
to provide a maximum phase margin for the closed loop system will be the same as found previously.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
81 
Feedback Loop Stability
It is convenient to do a time scale on the transfer function and replace sT  by p so that the transfer 
function becomes 
)
1(
)
1(
)
(
2
p
p
p
k
p
G
α
+
+
=
 where 
2
KT
k  
.  The closed loop characteristic equation is 
0
2
3
=
+
+
+
λ
λ
λ
k
p
k
p
p
 where 
α
λ
/
1
=
. Assuming the three equal roots are β  then equating the 
coefficients of the characteristic equation with the expansion of 
3)
(
β
+
p
gives 
β
λ
3
=
, 
2
3β
λ =
k
 and 
3
β
λ =
k
from which 
3
=
β
, 
9
=
λ
 and 
3
=
k
. Thus the root locus for 
)
(s
G
 has three equal poles 
when 
9
/
1
=
α
 and 
2
/
3 T
K =
. The transfer function has three poles, two at the origin and one at 
λ
−
, 
and a zero at –1. From the root locus rules one can conclude that (i) there is a locus on the negative 
real axis between the pole and zero and (ii) two roots go to infinity approaching asymptotes at 
$
90
r
, 
which intersect on the real axis at the point 
2
/)1
(
−
λ
. Since the system is stable for all gains the two 
root locus branches starting from the origin must move into the left half plane but what is not known 
without further investigation is whether these branches go to infinity along the asymptotes or return 
first to the negative real axis which according to the previous calculation must be the case when 
9
=
λ
, 
that is 
.9
/
1
=
α
 The root loci are shown in Figure 5.19 for the three values of 
8
/
1
=
α
, 
9
/
1
=
α
 and 
10
/
1
 
D
, respectively.
-8
-7
-6
-5
-4
-3
-2
-1
0
-8
-6
-4
-2
0
2
4
6
8
Root Locus
Real Axis
Imaginary Axis
1/8
-9
-8
-7
-6
-5
-4
-3
-2
-1
0
-8
-6
-4
-2
0
2
4
6
8
Root Locus
Real Axis
Imaginary Axis
1/9
-10
-9
-8
-7
-6
-5
-4
-3
-2
-1
0
-10
-8
-6
-4
-2
0
2
4
6
8
10
Root Locus
Real Axis
Imaginary Axis
1/10
Figure 5.19 Root loci for three values of α for example 5.6.
The maximum phase lead provided by 
sT
sT
D


1
1
 is 
α
α
+
−
−
1
1
sin 1
at a frequency of 
α
ω
T
/
1
=
 where 
the gain is α . Thus for 
9
/
1
=
α
 the maximum phase lead is 
$1.
53
)
8.0
(
sin 1
 

 at a frequency of 
T
/
3
=
ω
 where the gain is 3. Therefore if 
T
/
3
=
ω
 is taken as the phase margin frequency, then the 
phase margin will be a maximum if 
|)
(
|
ω
j
G
 has unit gain at this frequency. This means 
1
3
*
)
/
9
(
2
=
T
K
 , 
giving 
2
/
3 T
K =
, as before.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
82 
Feedback Loop Stability
Example 5.7
A feedback system has an open loop transfer function of 
)1
(
)
(
5.0

 

s
s
Ke
s
G
s
. Calculate its gain and phase 
margins for K = 1 and determine the maximum value of K for stability. Obtain the approximate value 
of K for stability using the Routh-Hurwitz criterion and the standard expansion for the exponential up 
to order 2, and from the Pade approximation of order 3 to 1.
The effects of time delay in a feedback loop are often most easily studied using Nyquist plots as a time 
delay has unit gain at all frequencies and a phase shift which increases linearly with increase in frequency. 
Thus the given G(s) will have a phase shift of 180° when 
$
90
5.0
tan 1
 


Z
Z
 which has a solution of 
307
.1
=
ω
. The gain at this frequency is 
465
.0
)
307
.1
1(
307
.1
1
|)
(
|
2
/
1
2
 

 
Z
j
G
K
. Thus the gain margin in 
dB for K = 1 is 
65
.6
)
465
.0
/
1(
log
20
10
 
 and the value of gain for which the closed system goes unstable is 
6.65dB or 2.15. The gain is 
2
/
1
2)
1(
1
ω
ω
+
 and this is equal to unity when 
1
2
4
=
+ ω
ω
, which has the solution 
786
.0
=
ω
. The phase shift at this frequency is 
$
$
$
69
.
150
)
/
180
*
393
.0
(
)
786
.0
(
tan
90
1

 




S
, 
giving a phase margin of 29.31°. To check in Matlab the transfer function without the delay, say g, is 
entered and then the statement
>> g.inputd=0.5;
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
“The perfect start 
of a successful, 
international career.”
CLICK HERE 
to discover why both socially 
and academically the University 
of Groningen is one of the best 
places for a student to be 
www.rug.nl/feb/education
Excellent Economics and Business programmes at:

Control Engineering Problems with Solutions
83 
Feedback Loop Stability
produces a new transfer function g with the delay. The Nyquist plot for K = 1 for the transfer function is 
shown in Figure 5.20 using a defined frequency vector. If the comment ‘margin(g)’ is used then a Bode 
plot with the gain and phase margin values is given which confirms the above calculations
-1.4
-1.2
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
-3
-2
-1
0
1
2
3
System: g
Real: -0.466
Imag: 0.000332
Frequency (rad/sec): -1.31
Nyquist Diagram
Real Axis
Imaginary Axis
Figure 5.20 Nyquist plot for G(s) of Example 5.7 with K = 1.
The characteristic equation is 
0
5.0
2
 



s
Ke
s
s
, which on substituting the first three terms of the 
expansion for the exponential gives 
0
)
125
.0
5.0
1(
2
2
=
+
−
+
+
s
s
K
s
s
. This will give a stable system 
if all the coefficients are positive, which is true for 
.2
<
K
 Using the 3/1 Pade expansion in the 
characteristic equation gives 
0
)
)
24
*
8
/
1(
)
16
/
1(
)
8
/
3
(
1(
)
125
.0
1
)(
(
3
2
2
 






s
s
s
K
s
s
s
 which 
gives 
0
8
]
3
8
[
)]
2
/
(
9
[
)]
24
/
(
1[
2
3
 






K
K
s
K
s
K
s
.
One of the coefficients becomes negative for 
3
/
8
>
K
 but it is also required for stability that 
]
3
8
)][
2
/
(
9
[
)]
24
/
(
1[
8
K
K
K
K




 which gives 
0
72
31
)
6
/
7
(
2



K
K
, which is true for 
149
.2
<
K
, showing very good agreement with the exact result.
Example 5.8
The frequency normalised open loop transfer function G(s) corresponding to the standard underdamped 
second order closed loop transfer function 
)1
2
/(
1
2


s
s
]
 is 
)
2
(
/
1
)
(
ζ
+
=
s
s
s
G
. Determine the 
phase margin for G(s) in a unit negative feedback system. Plot this phase margin and the percentage 
overshoot for the step response of the closed loop system against the damping ratio ζ. {Note the correlation 
of these two relationships is often used in open loop frequency response design to estimate the overshoot 
in the closed loop step response of the system – see problem 5.8 and chapter 7}.
The 
transfer 
function 
G(s) 
has 
unit 
gain 
when 
1
|)
2
(
/
1
|
=
+ ζ
ω
ω j
, 
that 
is 
1
]
)
4
(
/[
1
2
/
1
2
2
 
 ]
Z
Z
. This gives 
0
1
4
2
2
4
=
+
+
ω
ζ
ω
 which has the positive solution
2
2
2
2
1
4
ζ
ζ
ω
−
+
=
. The phase of 
)
( ω
j
G
 is 
)
2
/
(
tan
)
2
/
(
1
ζ
ω
π
−
−
−
 rads, so that the phase 
margin is 
)
]
2
)1
4
/[(
2
(
tan
)
/
2
(
tan
2
/
1
2
2
/
1
2
1
1
]
]
]
Z
]


 


. 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
84 
Feedback Loop Stability
The percentage overshoot for the closed loop step response is 
)
1
/
exp(
100
2
]
]S


. The results are 
shown plotted against ζ in Figure 5.21.
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
10
20
30
40
50
60
70
80
90
100
Damping ratio
% Overshoot
Phase margin degrees
Figure 5.21 Percentage overshoot and phase margin for second order system
5.3	
Problems
Problem 5.1 
Check the results obtained in Example 5.4 using the Routh-Hurwitz criterion.
Problem 5.2
Check the results obtained in Example 5.4 from root locus plots.
Problem 5.3
Obtain the solution for the gain K of Example 5.3 if the time constants have the values 
6
1 =
T
, 
1
2 =
T
, 
and 
2
3 =
T
. 
[0.555]
Problem 5.4 
The transfer function of problem 4.8 
)1
)(
1
(
4
)
(
2




 
s
s
s
s
s
s
G
 is in a closed loop unit negative feedback 
system with a compensator of gain K. Use the Nyquist criterion to find the values of K for which the 
system will be stable and check your result using the Routh-Hurwitz criterion and a root locus plot. 
Obtain the Mikhailov plot for the critical value of K.
[
5
!
K
] 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
85 
Feedback Loop Stability
Problem 5.5
For the following transfer functions obtain the range of positive values of K for which the system will 
be stable by the Routh-Hurwitz criterion and use of the Nyquist diagram drawn for K = 1
a)	
)
4
(
)1
(
)
(
2
2
−
+
=
s
s
s
K
s
G
b)	
1
1.0
)1
(
)
(
+
−
+
=
s
s
s
K
s
G
c)	
)1
)(
2
)(
3
(
)1
(
)
(
2




 
s
s
s
s
K
s
G
d)	
)
35
.0
)(
2
(
)
8
(
)
(
2 


 
s
s
s
K
s
G
e)	
2)
1(
)
1(
)
(
s
s
s
K
s
G
+
−
=
f)	
)1
1.0
)(
4
(
)1
(
)
(
2
2



 
s
s
s
s
K
s
G
[stable K > 2.5, stable K > 0.1, stable N = 0, unstable all positive K, stable K < 2/3, stable K > 2.5]
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
American online      
LIGS University 
▶▶enroll by September 30th, 2014 and 
▶▶save up to 16% on the tuition!
▶▶pay in 10 installments / 2 years
▶▶Interactive Online education
▶▶visit www.ligsuniversity.com to 
      find out more!
is currently enrolling in the
Interactive Online BBA, MBA, MSc, 
DBA and PhD  programs:
Note: LIGS University is not accredited by any 
nationally recognized accrediting agency listed 
by the US Secretary of Education. 
More info here. 

Control Engineering Problems with Solutions
86 
Feedback Loop Stability
Problem 5.6
Calculate the maximum value of K for stability of the transfer function 
2)
2
(
)
(

 

s
s
Ke
s
G
s
 
in a unit negative 
feedback system. Obtain the exact value from a Nyquist plot and approximate values from the Routh-
Hurwitz criterion using Pade expansions for
s
e− of order 3/0, 1/1.
[3.743 (11.46dB); 3.76; 3.88]
Problem 5.7
A system with unit negative feedback has an open loop transfer function 
2)
3
(
/
)
(
+
=
s
s
K
s
G
. Sketch 
its Nyquist diagram for K = 10 and find its magnitude and frequency when the phase is -180°. Calculate 
also the asymptote to which it tends at zero frequency and the critical gain of K, Kc, for which it is just 
stable. If K is chosen equal to 
2
/
c
K
show that it will have a gain of unity at the frequency 
047
.2
=
ω
rads/s and calculate the phase margin of the system. If 
2
/
c
K
K =
 and the feedback transfer function 
sT
e
s
H

 
)
(
, find the maximum value of T for which the system will be stable. Check your results with 
Matlab.
[10/54, 3 rads/s.; 20/27, 54; 21.4°; 0.183s.]
Problem 5.8
A system with unit negative feedback has an open loop transfer function 
2)
10
(
/
100
)
(

 
s
s
K
s
G
.
Calculate the maximum value of K for which the system is stable. Sketch the root locus, determine any 
breakaway points and the value of K for which they occur and the frequency at which the imaginary 
axis is crossed. Show that if K = 3 the closed loop poles are at -14.54 and -2.73±3.63j. Calculate the 
phase margin for the closed loop system for this value of K and obtain the percentage overshoot from 
the Matlab closed loop step response. 
Assuming the system is approximated by a second order one with the above complex poles, what will 
be the damping ratio, percentage overshoot for the closed loop step response and the phase margin (see 
the graphs in example 5.8). What can you conclude from these results about using phase margin criteria 
for designing third or possibly higher order systems where the desired performance is a limit on the 
closed loop step response overshoot.
[20; +5, 40/27, 10rads/s; 58.9°, 8.87%; 0.60, 9.48%, 52.6°, you will normally have to use a higher phase 
margin to achieve a given overshoot than indicated by Figure 5.21.]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
87 
Feedback Loop Stability
Problem 5.9
Determine from the Nyquist plot and the use of ‘M circles’ the maximum allowable value of K for the 
system of Problem 5.8 to have a closed loop frequency response with a maximum magnitude of 4dB. 
Check the result by using Matlab to plot the closed loop frequency response.
[≈6]
Problem 5.10
Using the standard notation a feedback control system has 
2)
2
(
/
1
)
(
+
=
s
s
s
G
, 
K
s
Gc
=
)
(
and 
1
)
(
=
s
H
.
a)	 Find the value of K which just causes the system to go unstable.
b)	 Find the value of K if the closed loop frequency response must not exceed 0dB.
c)	 If a time delay exists in the feedback path so that 
s
e
s
H
5.0
)
(
−
=
, find the new value of K 
which just causes the system to go unstable.
d)	 Check the last result by finding the solution from the Routh criterion using the 
approximation
)!3
/
(
)!2
/
(
1
3
2
x
x
x
e x
−
+
−
=
−
[(a) 16, (b) 2, (c) 5.81, (d) 5.83]
Problem 5.11
A system has an open loop transfer function G(s) and unit negative feedback. Make use of M circles to 
find the maximum value of gain K for the closed loop frequency response never to exceed unit gain if:-
a)	
)
(
/
)
(
a
s
s
K
s
G
+
=
b)	
2)1
(
/
)
(
+
=
s
s
K
s
G
c)	
3)1
/(
)
(
+
=
s
K
s
G
[(a)  
2
a
K 
(b)
25
.0

K
(c)
2

K
] 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
88 
Stat e Spa ce Mod els  and Transformation
6	 State Space Models and 
Transformations
6.1	
Introduction
The purpose of the examples in this chapter is to cover basic aspects of state space modelling, transfer 
functions of state space models, transformations between state space representations, controllability and 
observability and the response of state space models with external inputs and initial conditions. These 
topics are covered in chapter 10 of reference 1. The first example deals with the physical modelling of 
a permanent magnet dc motor driving a load through gearing. The following 7 examples use a limited 
number of state space models, which allows the relationships between the various methods of determining 
their state space properties and transfer functions to be compared. Finally an example is given on pole 
placement using state variable feedback to show the value of doing this by first transforming the system 
to the controllable canonical form.
6.2	
Examples
Example 6.1 
A permanent magnet dc motor drives a load through a speed reducing gear box of ratio, n. The motor is 
supplied from a voltage, v, has an armature resistance, R, and inductance L, and the inertias and viscous 
friction coefficients of the motor and load shafts are Jm, Fm and JL, FL, respectively. Find the transfer 
function for the motor from input voltage to output shaft position and state space models for the motor 
using (i) the output position and its derivatives as state variables and (ii) the output position, velocity 
and motor current as state variables. What do these state space models become if the motor inductance 
can be neglected?
The equations of motion for the motor and load shafts are 
m
m
m
m
m
m
F
J
Fr
T
T
T



 

 
and 
L
L
L
L
L
F
J
Fr
T
T

 
 
where 
m
θ and
L
θ  are the motor and load shaft positions, F is the force between the gear teeth and the 
r’s the radii of the motor and load shaft gears.
Using the facts that 
L
m
nθ
θ
=
 and rL = nrm the single equation of motion referred to either the motor 
or load shafts becomes
 
m
L
m
m
L
m
m
n
F
F
n
J
J
T
T
T


)
/
(
)
/
(
2
2



 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
89 
Stat e Spa ce Mod els  and Transformation
or 
L
m
L
L
m
L
m
F
n
F
J
n
J
nT
T
T


)
(
)
(
2
2



 
Taking the first equation and denoting the total inertia and friction referred to the motor shaft 
by J and F, that is 
2
/ n
J
J
J
L
m 
 
 and 
2
/ n
F
F
F
L
m 
 
 and dropping the subscripts m gives
 
θ
θ


F
J
T
+
=
 
Since the motor torque is given by 
Ki
T  
 this becomes
T
T


F
J
Ki

 
The equation for the motor armature circuit is
 
T
K
dt
Ldi
Ri
v


 
/
 
where 
θ
K
 is the back emf.
Taking Laplace transforms of the last two equations and with some rearrangement one obtains
T
T
Fs
Js
KI

 
2
)
/(
)
(
sL
R
Ks
V
I


 
T
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Control Engineering Problems with Solutions
90 
Stat e Spa ce Mod els  and Transformation
which on eliminating I gives the transfer function
)
(
)
(
2
2
3
RF
K
s
LF
RJ
s
LJ
s
K
V




 
T
 
Thus if this is put into the controllable canonical form state space representation with state vector
(
)
T
x
θ
θ
θ


=
, then the matrices are
¸
¸
¸
¹
·
¨
¨
¨
©
§




 
LJ
LF
RJ
LJ
FR
K
Ac
/)
(
/)
(
0
1
0
0
0
1
0
2
,
¸
¸
¸
¹
·
¨
¨
¨
©
§
 
LJ
K
Bc
/
0
0
,


0
0
1
 
c
C
and
0
 
D
Alternatively, for the state vector of 
(
)
T
i
z
θ
θ

=
one has, by choice, 
 
2
1
z
z =

 
and from the two equations for which the Laplace transforms were taken above 
2
2
3
Fz
z
J
Kz

 

2
3
3
Kz
z
L
Rz
v


 

These three equations give the state space representation 
¸
¸
¸
¹
·
¨
¨
¨
©
§



 
L
R
L
K
J
K
J
F
A
/
/
0
/
/
0
0
1
0
,
¸
¸
¸
¹
·
¨
¨
¨
©
§
 
L
B
/
1
0
0


0
0
1
 
C
and
0
 
D
 
It can be easily seen that 
0
)
det(
)
det(
=
=
A
Ac
, 
}
{
)
(
)
(
J
F
L
R
A
trace
A
trace
c
+
−
=
=
and the characteristic 
equation for both 
c
A and A is
0
)
(
)
(
2
2
3
 




RF
K
s
LF
RJ
s
LJ
s
. In many cases L can be 
neglected and the resulting transfer function is 
)
(
)
/]
[
(
/
)
(
2
2
2
a
s
s
K
RJ
K
RF
s
s
RJ
K
K
RF
s
RJ
s
K
V
m

 


 


 
T
where 
RJ
K
K m
/
 
and
RJ
K
RF
a
/)
(
2

 
. The corresponding state space representation is
 






−
=
a
A
0
1
0
, 






= 1
0
B
 and 
(
)
0
m
K
C =
 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
91 
Stat e Spa ce Mod els  and Transformation
Example 6.2
For the transfer functions
a)	
)
3
)(
1
(
2
)
(



 
s
s
s
s
G
b)	
8
14
7
3
2
)
(
2
3
2





 
s
s
s
s
s
s
G
Determine 
i.	 The controllable canonical form state space representation. 
ii.	 A diagonal form state space representation.
Use Matlab to check your result in (ii) and also find the companion form of Matlab and compare it with 
your result in (i) 
(a) 
(i) For 
3
4
2
)
3
)(
1
(
2
)
(
2



 



 
s
s
s
s
s
s
s
G
. Thus in controllable canonical form, using the subscript 
c, one has 






−
−
=
4
3
1
0
cA
, 






= 1
0
c
B
, 
(
)1
2
=
c
C
 and 
0
=
c
D
. 
(ii) Putting G(s) into partial fractions gives 
3
5.0
1
5.0
)
(
+
+
+
=
s
s
s
G
 which has a state space representation 
of 
¸¸
¹
·
¨¨
©
§


 
/
3
0
0
1
A
,
¸¸
¹
·
¨¨
©
§
 
/
2
1
b
b
B
,


2
1
c
c
C  
/
,
.0
 
/
D
 The choices for 
Λ
B  and 
Λ
C  are arbitrary as 
the only requirement is that 
5.0
2
2
1
1
=
=
c
b
c
b
, whilst also the eigenvalues on the diagonal of 
Λ
A  could 
be interchanged. Typically one chooses either 
1
2
1
=
= b
b
or 
1
2
1
=
= c
c
. A typical solution would 
therefore be 






−
−
=
Λ
3
0
0
1
A






=
Λ
1
1
B
, 
(
)
5.0
5.0
=
Λ
C
, 
.0
=
Λ
D
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
92 
Stat e Spa ce Mod els  and Transformation
To obtain the diagonal form using Matlab the command is canon(G,’modal’) and because of the various 
alternative solutions the representation returned by Matlab may differ according to the entry form 
used for G. In this case when the system was entered as the transfer function the result was






−
−
=
Λ
1
0
0
3
A
, 






−
−
=
Λ
236
.2
606
.3
B
, 
(
)
2236
.0
1387
.0
−
−
=
Λ
C
, 
0
=
Λ
D
, and when entered as the 
controllable canonical form it was 






−
−
=
Λ
3
0
0
1
A
, 





−
=
Λ
581
.1
7071
.0
B
, 
(
)
3162
.0
7071
.0
=
Λ
C
, 
0
=
Λ
D
. For both entry forms the companion form returned by Matlab was 
¸¸
¹
·
¨¨
©
§


 
4
1
3
0
cm
A
,
¸¸
¹
·
¨¨
©
§
 0
1
cm
B
,


2
1

 
cm
C
,
0
 
cm
D
. It is seen that 
cm
A
 is equal to 
T
c
A  and the unity value in 
cm
B
occurs in the 
first element not the last as with 
c
B . If the command [csys,V]=canon(G,’companion’) is entered into Matlab 
the transformation matrix V, which satisfies 
cm
A
VAV
 
1
 is obtained. 
(b)
(i) For 
8
14
7
3
2
)
(
2
3
2





 
s
s
s
s
s
s
G
 
the controllable canonical form is 
¸
¸
¸
¹
·
¨
¨
¨
©
§



 
7
14
8
1
0
0
0
1
0
c
A
,










=
1
0
0
c
B
, 
(
)1
2
3
=
c
C
 and 
0
=
c
D
. 
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
 
  
 
                . 

Control Engineering Problems with Solutions
93 
Stat e Spa ce Mod els  and Transformation
(ii) Expanding in partial fractions gives 
4
6
/
11
2
2
/
3
1
3
/
2
)
(





 
s
s
s
s
G
 so that one diagonal representation 
is 
¸
¸
¸
¹
·
¨
¨
¨
©
§



 
/
4
0
0
0
2
0
0
0
1
A
,
¸
¸
¸
¹
·
¨
¨
¨
©
§
 
/
1
1
1
B
,


6
/
11
2
/
3
3
/
2

 
/
C
 and 
0
=
Λ
D
. 
One modal representation given by Matlab is 
¸
¸
¸
¹
·
¨
¨
¨
©
§



 
/
1
0
0
0
2
0
0
0
4
A
,
¸
¸
¸
¹
·
¨
¨
¨
©
§


 
/
83
.3
798
.9
659
.7
B
, 
(
)
1741
.0
1531
.0
2394
.0
−
−
=
Λ
C
 and 
0
=
Λ
D
 and the companion representation is 
¸
¸
¸
¹
·
¨
¨
¨
©
§



 
7
1
0
14
0
1
8
0
0
cm
A
,
¸
¸
¸
¹
·
¨
¨
¨
©
§
 
0
0
1
cm
B
,


24
5
1

 
cm
C
and
0
 
cm
D
.  
Again
T
c
cm
A
A
 
 and the unity value in 
cm
B
occurs in the first element.
Example 6.3
Obtain an upper triangular state space representation form for the transfer function  
)
4
)(
1
(
2
)
(



 
s
s
s
s
G
.
The transfer function can be written as the two cascaded transfer functions 
1
2
)
(
2
+
+
= s
s
s
G
and 
4
1
)
(
1
+
= s
s
G
. A state space representation for the first transfer function with input u and output z, 
considering it as 
1
1
1
)
(
2
+
+
=
s
s
G
 is 
2
2
x
u
x
−
=

, 
2x
u
z
+
=
and for the second, with input z and output 
y is 
z
x
x
+
−
= 4
1
, 
1x
y =
. Substituting for z gives
u
x
x
x
+
+
−
=
2
1
1
4

, and also 
1x
y =
, so that 






−
−
=
1
0
1
4
g
A
, 






= 1
1
g
B
, 
(
)
0
1
=
g
C
, and 
0
=
g
D
. Obviously this is not unique as one could 
alternatively separate G(s) into 
1
1
)
(
2
+
= s
s
G
 
and 
4
2
)
(
1
+
+
= s
s
s
G
.
Example 6.4
For the following state space descriptions calculate the eigenvalues and eigenvectors of the A matrix and 
give an equivalent state space representation in terms of a diagonal (modal) form of the A matrix. State 
whether the representations are controllable and observable and give the transfer functions. Check the 
calculations using Matlab.
a)	
¸¸
¹
·
¨¨
©
§



 
2
2
1
5
A
,
¸¸
¹
·
¨¨
©
§
 2
1
B
,


2
1
 
C
,
0
 
D
.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
94 
Stat e Spa ce Mod els  and Transformation
b)	
¸¸
¹
·
¨¨
©
§


 
0
1
4
5
A
,
¸¸
¹
·
¨¨
©
§
 1
1
B
,


2
1
 
C
,
0
 
D
.
c)	
¸
¸
¸
¹
·
¨
¨
¨
©
§






 
0
1
4
2
1
4
1
1
5
A
,
¸
¸
¸
¹
·
¨
¨
¨
©
§

 
1
3
2
B
,


2
1
4

 
C
, D = 0
d)	
¸
¸
¸
¹
·
¨
¨
¨
©
§






 
8
17
16
10
17
15
8
16
15
A
,
¸
¸
¸
¹
·
¨
¨
¨
©
§

 
1
1
1
B
,

1
0
1
 
C
, D = 0
(a) For this case 
¸¸
¹
·
¨¨
©
§



 

2
2
1
5
s
s
A
sI
, which has the characteristic equation 
0
12
7
2
 

 s
s
 , 
with eigenvalues -3 and -4. Taking s equal to -3 the first eigenvector is given by 
0
1
2
1
2
2
3
2
1
5
3
3
21
11
 
¸¸
¹
·
¨¨
©
§
¸¸
¹
·
¨¨
©
§


 
¸¸
¹
·
¨¨
©
§





 


t
t
A
I
 
so that one can take 
¸¸
¹
·
¨¨
©
§

 
¸¸
¹
·
¨¨
©
§
2
1
12
11
t
t
 and for s equal 
to -4 the other eigenvector is given by 
0
2
2
1
1
2
4
2
1
5
4
4
22
12
 
¸¸
¹
·
¨¨
©
§
¸¸
¹
·
¨¨
©
§


 
¸¸
¹
·
¨¨
©
§





 


t
t
A
I
 
so that 
one can take 
¸¸
¹
·
¨¨
©
§

 
¸¸
¹
·
¨¨
©
§
1
1
22
12
t
t
 and the transformation matrix 






−
−
=
1
2
1
1
T
. Thus 






−
−
=
−
1
2
1
1
1
T
 
and 
¸¸
¹
·
¨¨
©
§


 
¸¸
¹
·
¨¨
©
§


¸¸
¹
·
¨¨
©
§



¸¸
¹
·
¨¨
©
§


 
 

/
4
0
0
3
1
2
1
1
2
2
1
5
1
2
1
1
1AT
T
A
, 





−
=












−
−
=
Λ
4
3
2
1
1
2
1
1
B
 
and 
(
)
(
)1
3
1
2
1
1
2
1
−
−
=






−
−
=
Λ
C
. Since neither 
Λ
B  or 
Λ
C contain a zero term the representation is 
controllable and observable and its transfer function is 
12
7
24
5
2



s
s
s
. After entering the state space 
description of G into Matlab then in response to the following command one obtains
>> [T,D]=eig(A)
T =
 -0.7071 	
0.4472
 0.7071 	
-0.8944
D =
 -4 	  0
  0 	 -3
Here T is the transformation matrix and it is seen that the eigenvectors (after allowing for scaling) are 
in the reverse order and so therefore are the eigenvalues in the D matrix. Alternatively if the following 
commands are used the modal form is given directly together with the transformation matrix which is 
the inverse of T.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
95 
Stat e Spa ce Mod els  and Transformation
>> [Gd,V]=canon(G,’modal’)
 a = 
 	
x1 	
x2
 x1 	 -4 	
 0
 x2 	  0 	
-3
 b = 
 	
 u1
 x1 	 -5.657
 x2 	 -6.708
 c = 
 	
x1 	
 x2
 y1 	 0.7071 	 -1.342
 d = 
 	
u1
 y1 	 0
 Continuous-time model.
V =
 -2.8284 	
-1.4142
 -2.2361 	
-2.2361
>> T=inv(V)
T =
 -0.7071 	
 0.4472
  0.7071 	
-0.8944
This state space description yields the same transfer function allowing for rounding errors, which can 
also be found from the command tf(Gd).
(b) For this case 
¸¸
¹
·
¨¨
©
§


 

s
s
A
sI
1
4
5
, which has the characteristic equation 
0
4
5
2
=
+
+ s
s
, with 
eigenvalues -1 and -4. For the eigenvectors 
0
)
(
=
−
i
i
t
A
I
s
 gives for the two values of s 
(
)
T
t
1
1
1 =
and 
(
)
T
t
1
4
2 =
to give 






=
1
1
4
1
T
. This gives 

 
AT
T 1
 
Λ
=






−
−
=












−
−






−
−
A
4
0
0
1
1
1
4
1
0
1
4
5
3
/
1
3
/
1
3
/
4
3
/
1
as expected. 






=












−
−
=
Λ
0
1
1
1
3
/
1
3
/
1
3
/
4
3
/
1
B
 and 
(
)
(
)
6
3
1
1
4
1
2
1
=






=
Λ
C
. Thus due to the zero in 
Λ
B  the second mode -4 is not controllable and the transfer function is 
1
3
+
s
. Using the command 
Gd=canon(G,’modal’) in Malab the response is
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
96 
Stat e Spa ce Mod els  and Transformation
a = 
 	
x1 	
x2
 x1 	 -4 	
 0
 x2 	  0 	
-1
b = 
	
 u1
 x1 	     0
 x2 	 -1.414
c = 
	
 x1 	
x2
 y1 	 -1.455 	 -2.121
d = 
	
 u1
 y1 	    0
From which it can be seen that the transfer function is 3/(s+1) and the mode at -4 is uncontrollable as 
the first element of the B vector is zero. The response in Matlab to tf(G) is
Transfer function:
 3 s + 12
-------------
s^2 + 5 s + 4
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
97 
Stat e Spa ce Mod els  and Transformation
which on cancelling the s+4 factor gives 3/(s+1). Alternatively for the following commands the reduced 
model is obtained. 
>> Gm=minreal(G)
1 state removed.
a = 
	
 x1
 x1 	  -1
b = 
	
 u1
 x1 	  1.414
 c = 
	
 x1
 y1 	  2.121
 d = 
	
 u1
 y1 	    0
 Continuous-time model.
>> tf(Gm)
Transfer function:
 3
-----
s + 1
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
98 
Stat e Spa ce Mod els  and Transformation
(c) For this system 
¸
¸
¸
¹
·
¨
¨
¨
©
§




 

s
s
s
A
sI
1
4
2
1
4
1
1
5
 
which gives the characteristic equation 
0
6
11
6
2
3
 



s
s
s
, 
which has eigenvalues of -1, -2 and -3. The corresponding eigenvectors from
0
)
(
=
−
i
i
t
A
I
s
 can be 
calculated as 
(
)
T
t
2
2
1
1
−
=
, 
(
)
T
t
1
2
1
2
−
=
and 
(
)
T
t
1
1
1
3
−
=
. Thus 










−
−
−
=
1
1
2
1
2
2
1
1
1
T
 
giving 










−
−
−
=
−
0
1
2
1
1
0
1
0
1
1
T
 
so that calculations give 
¸
¸
¸
¹
·
¨
¨
¨
©
§



 

3
0
0
0
2
0
0
0
1
1AT
T
,
¸
¸
¸
¹
·
¨
¨
¨
©
§
 

1
2
1
1B
T
a
 
and 

1
0
2

 
CT
. Thus 
it can be seen that the mode at -2 is unobservable and the transfer function is 
3
4
7
3
3
1
1
2
2
+
+
+
=
+
+
+
s
s
s
s
s
. 
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
www.mastersopenday.nl
Visit us and find out why we are the best!
Master’s Open Day: 22 February 2014
Join the best at
the Maastricht University
School of Business and
Economics!
Top master’s programmes
• 33rd place Financial Times worldwide ranking: MSc 
International Business
• 1st place: MSc International Business
• 1st place: MSc Financial Economics
• 2nd place: MSc Management of Learning
• 2nd place: MSc Economics
• 2nd place: MSc Econometrics and Operations Research
• 2nd place: MSc Global Supply Chain Management and 
Change
Sources: Keuzegids Master ranking 2013; Elsevier ‘Beste Studies’ ranking 2012; 
Financial Times Global Masters in Management ranking 2012
Maastricht
University is
the best specialist
university in the
Netherlands
(Elsevier)

Control Engineering Problems with Solutions
99 
Stat e Spa ce Mod els  and Transformation
Using Matlab gives
>> [Gd,V]=canon(G,’modal’)
 a = 
	
 x1 	
x2 	
x3
 x1 	  -3 	
 0 	
 0
 x2 	   0 	
-1	
 0
 x3 	   0 	
 0 -	
 2
 b = 
	
 u1
 x1 	 -1.732
 x2 	 -3
 x3 	 4.899
 c = 
	
 x1 	
x2 	
x3
 y1 	 -0.5774 	
-0.6667 	
1.11e-016
 d = 
	
 u1
 y1 	    0
Continuous-time model.
V =
	
 -3.4641 	
1.7321 		
-0.0000
	
 -3.0000 	
0.0000 		
-3.0000
	
  0.0000 	
2.4495 		
 2.4495
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
100 
Stat e Spa ce Mod els  and Transformation
>> T=inv(V)
T =
	
 -0.5774 	
 0.3333 		
 0.4082
	
 -0.5774 	
 0.6667 		
 0.8165
	
  0.5774 	
-0.6667 		
-0.4082
>> tf(Gd)
 Transfer function:
 3 s^2 + 13 s + 14
----------------------
s^3 + 6 s^2 + 11 s + 6
The essentially zero term in the last element of C shows that the -2 mode is unobservable and the transfer 
function is equal to 
3
4
7
3
2
+
+
+
s
s
s
when the common factor of 
2
+
s
is cancelled
(d) For the system 
¸
¸
¸
¹
·
¨
¨
¨
©
§






 
8
17
16
10
17
15
8
16
15
A
 , 










−
=
1
1
1
B
 , 
(
)1
0
1
=
C
 , D = 0, the characteristic equation 
is 
0
8
17
16
10
17
15
8
16
15
 





s
s
s
, which on multiplying out gives 
0
6
11
6
2
3
 



s
s
s
, which has roots 
of -1, -2 and -3. Hand calculation of the eigenvectors with the above numbers in the A matrix is laborious 
so going straight to Matlab gives Continuous-time model.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
101 
Stat e Spa ce Mod els  and Transformation
>> [Gd,V]=canon(G,’modal’)
 a = 
	
 x1	
 x2 	
x3
 x1 	 -3 	
 0 	
 0
 x2 	  0 	
-2 	
 0
 x3 	  0 	
 0 	
-1
 b = 
	
 u1
 x1 	 -12.79
 x2 	  14.59
 x3 	 -3.536
 c = 
	
 x1 	
x2 	
x3
 y1 	 -1.056 	 -1.028 	 -0.9899
 d = 
	
 u1
 y1 	    0
Continuous-time model.
V =
 -63.9336 	
-51.1468 	
 0.0000
 102.1616 	
 72.9726 	
-14.5945
 -38.8909 	
-21.2132 	
14.1421
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
102 
Stat e Spa ce Mod els  and Transformation
From this modal representation it can be seen that the system is controllable and observable and further
>> T=inv(V)
T =
 -0.5474 	
-0.5482  	
-0.5657
  0.6648 	
 0.6852  	
 0.7071
 -0.5083 	
-0.4796  	
-0.4243,
and
 >>tf(Gd)
Transfer function:
 2 s^2 - 2 s + 3
----------------------
s^3 + 6 s^2 + 11 s + 6
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Control Engineering Problems with Solutions
103 
Stat e Spa ce Mod els  and Transformation
Example 6.5
For the state space descriptions (a), (b) and (c) of example 6.4 calculate the transfer function and the 
state transition matrix by 
i)	 The inverse Laplace transform method
ii)	 The diagonalisation method
iii)	The Cayley Hamilton theorem.
(a) For this case 
¸¸
¹
·
¨¨
©
§



 

2
2
1
5
s
s
A
sI
 and 
¸
¸
¸
¸
¹
·
¨
¨
¨
¨
©
§











 


)
4
)(
3
(
5
)
4
)(
3
(
2
)
4
)(
3
(
1
)
4
)(
3
(
2
)
(
1
s
s
s
s
s
s
s
s
s
s
A
sI
. 
(i) The transfer function is 

)
4
)(
3
(
24
5
2
1
)
4
)(
3
(
5
)
4
)(
3
(
2
)
4
)(
3
(
1
)
4
)(
3
(
2
2
1



 
¸¸
¹
·
¨¨
©
§
¸
¸
¸
¸
¹
·
¨
¨
¨
¨
©
§











s
s
s
s
s
s
s
s
s
s
s
s
s
 
and putting each term of 
1
)
(

 A
sI
into 
partial 
fractions 
and 
taking 
inverse 
Laplace 
transforms 
gives 
¸¸
¹
·
¨¨
©
§






 
 








t
t
t
t
t
t
t
t
At
e
e
e
e
e
e
e
e
e
t
4
3
4
3
4
3
4
3
2
2
2
2
)
(
M
.
(ii) Using the diagonalizing T matrix found earlier gives
¸¸
¹
·
¨¨
©
§






 
¸¸
¹
·
¨¨
©
§


¸¸
¹
·
¨¨
©
§
¸¸
¹
·
¨¨
©
§


 











/
t
t
t
t
t
t
t
t
t
t
t
e
e
e
e
e
e
e
e
e
e
T
Te
4
3
4
3
4
3
4
3
4
3
1
2
2
2
2
1
2
1
1
0
0
1
2
1
1
 
as before.
(iii) From use of the Cayley-Hamilton theorem one has 
A
I
e At
1
0
D
D

 
 and 
i
t
s
s
e i
1
0
α
α +
=
which yields 
1
0
3
3α
α −
=
−t
e
 and 
1
0
4
4α
α −
=
−t
e
giving 
t
t
e
e
4
3
0
3
4
−
−−
=
α
and 
t
t
e
e
4
3
1
−
−−
=
α
, 
thus again 
¸¸
¹
·
¨¨
©
§






 
¸¸
¹
·
¨¨
©
§








¸¸
¹
·
¨¨
©
§


 




















t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
At
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
4
3
4
3
4
3
4
3
4
3
4
3
4
3
4
3
4
3
4
3
2
2
2
2
2
2
2
2
5
5
3
4
0
0
3
4
(b) For this case 
¸¸
¹
·
¨¨
©
§


 

s
s
A
sI
1
4
5
 and 
¸
¸
¸
¸
¹
·
¨
¨
¨
¨
©
§










 


)
4
)(
1
(
5
)
4
)(
1
(
1
)
4
)(
1
(
4
)
4
)(
1
(
)
(
1
s
s
s
s
s
s
s
s
s
s
A
sI
.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
104 
Stat e Spa ce Mod els  and Transformation
(i) The transfer function is 

1
3
)
4
)(
1
(
12
3
1
1
)
4
)(
1
(
5
)
4
)(
1
(
1
)
4
)(
1
(
4
)
4
)(
1
(
2
1

 



 
¸¸
¹
·
¨¨
©
§
¸
¸
¸
¸
¹
·
¨
¨
¨
¨
©
§










s
s
s
s
s
s
s
s
s
s
s
s
s
s
aand 
putting each term of 
1
)
(

 A
sI
 into partial fractions and taking inverse Laplace transforms 
gives 
¸¸
¹
·
¨¨
©
§






 
 








t
t
t
t
t
t
t
t
At
e
e
e
e
e
e
e
e
e
t
4
4
4
4
4
4
4
4
*
)
3
/
1(
)
(
M
. 
(ii) Using the diagonalizing T matrix found earlier gives
 
¸¸
¹
·
¨¨
©
§






 
¸¸
¹
·
¨¨
©
§


¸¸
¹
·
¨¨
©
§
¸¸
¹
·
¨¨
©
§
 











/
t
t
t
t
t
t
t
t
t
t
t
e
e
e
e
e
e
e
e
e
e
T
Te
4
4
4
4
4
1
4
4
4
4
*
)
3
/
1(
1
1
4
1
0
0
1
1
4
1
*
)
3
/
1(
 
as before.
(iii) From use of the Cayley-Hamilton theorem one has 
A
I
e At
1
0
D
D

 
 and 
i
t
s
s
e i
1
0
α
α +
=
which yields 
1
0
α
α −
=
−t
e
 and 
1
0
4
4α
α −
=
−t
e
 giving 
t
t
e
e
4
0
)
3
/
1(
)
3
/
4
(
−
−−
=
α
 and 
t
t
e
e
4
1
)
3
/
1(
)
3
/
1(
−
−−
=
α
, thus again 
 
¸¸
¹
·
¨¨
©
§






¸¸
¹
·
¨¨
©
§


 










t
t
t
t
t
t
t
t
t
t
At
e
e
e
e
e
e
e
e
e
e
e
4
4
4
4
4
0
4
4
5
5
4
0
0
4
3
¸¸
¹
·
¨¨
©
§














t
t
t
t
t
t
t
t
e
e
e
e
e
e
e
e
4
4
4
4
4
4
4
4
 
(c) For this case 
¸
¸
¸
¹
·
¨
¨
¨
©
§




 

s
s
s
A
sI
1
4
2
1
4
1
1
5
 and 
















+
+
+
+
+
−
+
+
+
+
−
+
+
+
+
+
−
+
+
−
+
+
+
+
−
=










+
+
−
−
−
−
−
−
+
+
+
+
−
−
−
+
+
+
+
=
−
−
)
2
)(
1
(
3
)3
)(
2
(
1
)3
)(
1
(
4
)
2
)(
1
(
2
)3
))(
2
(
4
)3
))(
1
(
4
)
2
))(
1
(
1
)3
))(
2
(
1
)3
))(
1
(
1
9
6
6
2
3
1
4
5
1
8
4
8
4
2
])3
))(
2
))(
1
(
1
[
)
(
2
2
2
1
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
A
sI
T
.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
105 
Stat e Spa ce Mod els  and Transformation
The transfer function is 
 
(
)
(
)
)3
)(
1
(
7
3
)3
)(
2
)(
1
(
14
13
3
6
11
6
8
2
2
6
11
6
2
9
3
6
11
6
8
24
8
2
1
4
1
3
2
)
2
)(
1
(
3
)3
)(
2
(
1
)3
)(
1
(
4
)
2
)(
1
(
2
)3
)(
2
(
4
)3
)(
1
(
4
)
2
)(
1
(
1
)3
)(
2
(
1
)3
)(
1
(
1
2
1
4
)
(
2
2
3
2
2
3
2
2
3
2
1
+
+
+
=
+
+
+
+
+
=
















+
+
+
+
−
−
+
+
+
−
−
−
+
+
+
+
+
−
=










−
















+
+
+
+
+
−
+
+
+
+
−
+
+
+
+
+
−
+
+
−
+
+
+
+
−
−
=
−
−
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
B
A
sI
C
   










−
+
−
−
+
−
−
+
−
+
−
−
+
−
=
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
At
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
2
3
2
3
2
3
2
3
2
3
2
3
2
2
2
2
2
2
2
2
2
and
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Get Help Now
Go to www.helpmyassignment.co.uk for more info
Need help with your
dissertation?
Get in-depth feedback & advice from experts in your 
topic area. Find out what you can do to improve
the quality of your dissertation!

Control Engineering Problems with Solutions
106 
Stat e Spa ce Mod els  and Transformation
(ii)Using the diagonalizing T matrix found earlier gives










−
+
−
−
+
−
−
+
−
+
−
−
+
−
=










−
−
−










−
−
−
=










−
−
−




















−
−
−
=
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
Λ
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
T
Te
2
3
2
3
2
3
2
3
2
3
2
3
3
3
2
2
3
2
1
2
2
2
2
2
2
2
2
2
0
2
0
0
1
1
2
1
2
2
1
1
1
0
1
2
1
1
0
1
0
1
0
0
0
0
0
0
1
1
2
1
2
2
1
1
1
 
as before.
(iii) From use of the Cayley-Hamilton theorem one has 
2
2
1
0
A
A
I
e At
D
D
D


 
 and 
2
2
1
0
i
i
t
s
s
s
e i
α
α
α
+
+
=
. Substituting the eigenvalues in the latter equation gives the three equations 
2
1
0
α
α
α
+
−
=
−t
e
, 
2
1
0
2
4
2
α
α
α
+
−
=
−t
e
and 
2
1
0
3
9
3
α
α
α
+
−
=
−t
e
. These give solutions for the 
alphas of 
t
t
t
e
e
e
3
2
0
3
3
−
−
−
+
−
=
α
, 
t
t
t
e
e
e
3
2
1
5.1
4
5.2
−
−
−
+
−
=
α
and
t
t
t
e
e
e
3
2
2
5.0
5.0
−
−
−
+
−
=
α
. Now 
¸
¸
¸
¹
·
¨
¨
¨
©
§




 
¸
¸
¸
¹
·
¨
¨
¨
©
§






¸
¸
¸
¹
·
¨
¨
¨
©
§






 
2
5
16
6
1
16
3
5
17
0
1
4
2
1
4
1
1
5
0
1
4
2
1
4
1
1
5
2
A
, 
so substituting the alphas in the matrix equation gives 
¸
¸
¸
¹
·
¨
¨
¨
©
§














 
¸
¸
¸
¹
·
¨
¨
¨
©
§























¸
¸
¸
¹
·
¨
¨
¨
©
§























¸
¸
¸
¹
·
¨
¨
¨
©
§






 














































































t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
e
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
At
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
t
2
3
2
3
2
3
2
3
2
3
2
3
3
2
3
2
3
2
3
2
3
2
3
2
3
2
3
2
3
2
3
2
3
2
3
2
3
2
3
2
3
2
3
2
3
2
3
2
3
2
3
2
2
2
2
2
2
2
2
2
2
2
5.2
5
5.2
8
16
8
3
6
3
5.0
5.0
8
16
8
5.1
3
5.1
5.2
5
5.2
5.8
17
5.8
0
5.1
4
5.2
6
16
10
3
8
5
5.1
4
5.2
6
16
10
5.1
4
5.2
5.1
4
5.2
5.7
20
5.
12
3
3
0
0
0
3
3
0
0
0
3
3
as before.
Example 6.6
Use the controllability and observability theorems to check the results obtained for controllability and 
observability in Example 6.4.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
107 
Stat e Spa ce Mod els  and Transformation
(a) For this example 
¸¸
¹
·
¨¨
©
§


 
¸¸
¹
·
¨¨
©
§
¸¸
¹
·
¨¨
©
§



 
2
7
2
1
2
2
1
5
AB
so that 

¸¸
¹
·
¨¨
©
§


 
2
2
7
1
AB
B
, the determinant of which 
is 12, so the system is controllable. Similarly 
¸¸
¹
·
¨¨
©
§


 
¸¸
¹
·
¨¨
©
§
5
1
2
1
CA
C
,which has a determinant of -3, so the 
system is observable. 
(b) For this example 

¸¸
¹
·
¨¨
©
§


 
1
1
1
1
AB
B
,which has a determinant of zero, so that the system 
is uncontrollable. The uncontrollable mode, however, is not revealed by this simple test. Similarly 
¸¸
¹
·
¨¨
©
§

 
¸¸
¹
·
¨¨
©
§
4
7
2
1
CA
C
, which has a determinant of 18 so the system is observable.
(c) For this example 










−
−
−
−
−
−
=
0
1
4
2
1
4
1
1
5
A
 
and 
¸
¸
¸
¹
·
¨
¨
¨
©
§




  
2
5
16
6
1
16
3
5
17
2
A
 
so that 


¸
¸
¸
¹
·
¨
¨
¨
©
§




 
15
5
1
23
9
3
16
6
2
2B
A
AB
B
, which has a determinant of 4 so the system is controllable. 
Similarly 
¸
¸
¸
¹
·
¨
¨
¨
©
§




 
¸
¸
¸
¹
·
¨
¨
¨
©
§
2
9
20
2
3
8
2
1
4
2
CA
CA
C
, which has a determinant of zero, so the system is unobservable.
(d) For this example 
¸
¸
¸
¹
·
¨
¨
¨
©
§






 
8
17
16
10
17
15
8
16
15
A
 
and 
¸
¸
¸
¹
·
¨
¨
¨
©
§



 
¸
¸
¸
¹
·
¨
¨
¨
©
§






¸
¸
¸
¹
·
¨
¨
¨
©
§






 
22
103
113
30
121
130
24
104
113
8
17
16
10
17
15
8
16
15
8
17
16
10
17
15
8
16
15
2
A
 
so that 


¸
¸
¸
¹
·
¨
¨
¨
©
§



 
32
7
1
39
8
1
33
7
1
2B
A
AB
B
, which has a determinant of -1 so that the system is controllable. 
Also 
¸
¸
¸
¹
·
¨
¨
¨
©
§



 
¸
¸
¸
¹
·
¨
¨
¨
©
§
46
207
226
16
33
31
1
0
1
2
CA
CA
C
, which has a determinant of 2835, so the system is observable.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
108 
Stat e Spa ce Mod els  and Transformation
Example 6.7
For the following three state space descriptions
(a)
¸¸
¹
·
¨¨
©
§



 
2
2
1
5
A
,
¸¸
¹
·
¨¨
©
§
 2
1
B
,


2
1
 
C
,
0
 
D
.
¸¸
¹
·
¨¨
©
§
 1
2
)
0
(x
.
(b)
¸¸
¹
·
¨¨
©
§


 
0
1
4
5
A
,
¸¸
¹
·
¨¨
©
§
 1
1
B
,


2
1
 
C
,
0
 
D
.
¸¸
¹
·
¨¨
©
§
 2
1
)
0
(x
.
(c)
¸
¸
¸
¹
·
¨
¨
¨
©
§






 
0
1
4
2
1
4
1
1
5
A
,
¸
¸
¸
¹
·
¨
¨
¨
©
§

 
1
3
2
B
,


2
1
4

 
C
, D = 0.
¸
¸
¸
¹
·
¨
¨
¨
©
§

 
2
1
1
)
0
(x
determine the output for a unit step input at time zero and the initial conditions given using 
i)	 The s-domain approach.
ii)	 The time domain approach.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
By 2020, wind could provide one-tenth of our planet’s 
electricity needs. Already today, SKF’s innovative know-
how is crucial to running a large proportion of the 
world’s wind turbines. 
Up to 25 % of the generating costs relate to mainte-
nance. These can be reduced dramatically thanks to our 
systems for on-line condition monitoring and automatic 
lubrication. We help make it more economical to create 
cleaner, cheaper energy out of thin air. 
By sharing our experience, expertise, and creativity, 
industries can boost performance beyond expectations. 
Therefore we need the best employees who can 
meet this challenge!
The Power of Knowledge Engineering
Brain power
Plug into The Power of Knowledge Engineering. 
Visit us at www.skf.com/knowledge

Control Engineering Problems with Solutions
109 
Stat e Spa ce Mod els  and Transformation
(a)(i) In the s-domain the output 
)
(s
Y
is given by
)
(
)
(
)
0
(
)
(
)
(
)
(
)
0
(
)
(
)
(
1
1
1
s
U
s
G
x
A
sI
C
s
BU
A
sI
C
x
A
sI
C
s
Y


 



 



. Using the values 
for this example gives


)
4
)(
3
(
24
5
)
4
)(
3
(
21
4
)
4
)(
3
(
24
5
1
2
)
4
)(
3
(
5
)
4
)(
3
(
2
)
4
)(
3
(
1
)
4
)(
3
(
2
2
1
)
(







 




¸¸
¹
·
¨¨
©
§
¸
¸
¸
¸
¹
·
¨
¨
¨
¨
©
§











 
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
Y
Putting into partial fractions gives 
4
1
3
3
2
4
5
3
9
)
(
+
+
+
−
+
+
−
+
=
s
s
s
s
s
s
Y
which on inversion gives 
t
t
e
e
t
y
4
3
4
6
2
)
(
−
−−
+
=
.
(ii) In the time domain 
)
(t
y
can be evaluated from 
³


 
t
t
A
At
d
Bu
Ce
x
Ce
t
y
0
)
(
)
(
)
0
(
)
(
W
W
W
. The 
first term is easily found and is equal to 




t
t
t
t
t
t
t
t
t
t
t
t
t
t
e
e
e
e
e
e
e
e
e
e
e
e
e
e
4
3
4
3
4
3
4
3
4
3
4
3
4
3
5
9
2
1
3
2
3
1
2
2
2
2
2
2
1















 
¸¸
¹
·
¨¨
©
§


 
¸¸
¹
·
¨¨
©
§
¸¸
¹
·
¨¨
©
§






. 
For the second term since the input is a unit step 
1
)
(
=
τ
u
 and all the elements in the second integral 
will be of the form 
)1
)(
/
(
0
)
(

 
³

mt
t
t
m
e
m
K
d
Ke
W
W
, where K and m are constants. Thus this term is 




t
t
t
t
t
t
t
t
t
t
t
t
t
t
e
e
e
e
e
e
e
e
e
e
e
e
e
e
4
3
4
3
4
3
4
3
4
3
4
3
4
3
3
2
2
1
)1
)(
4
/
1(
)1
(
)1
)(
2
/
1(
)1
(
2
1
)1
)(
4
/
1(
)1
)(
3
/
2
(
)1
)(
2
/
1(
)1
)(
3
/
2
(
)1
)(
4
/
1(
)1
(
3
/
1(
)1
)(
2
/
1(
)1
)(
3
/
1(
2
1
















 
¸¸
¹
·
¨¨
©
§








 
¸¸
¹
·
¨¨
©
§
¸¸
¹
·
¨¨
©
§














Thus as before the total output 
t
t
e
e
t
y
4
3
4
6
2
)
(
−
−−
+
=
.
(b) (i)In this case 


)
4
)(
1
(
26
5
2
1
)
4
)(
1
(
5
)
4
)(
1
(
1
)
4
)(
1
(
4
)
4
)(
1
(
2
1
(
)
0
(
)
(
1



 
¸¸
¹
·
¨¨
©
§
¸
¸
¸
¸
¹
·
¨
¨
¨
¨
©
§










 


s
s
s
s
s
s
s
s
s
s
s
s
s
x
A
sI
C
, which 
on inversion gives 
t
t
e
e
4
2
7
−
−−
. The unit step response is the inverse Laplace transform of  
)1
(
3
+
s
s
 
which is 3 – 3e–t and contains no term in e–4t as this mode is uncontrollable. The total response 
is 
t
t
e
e
4
2
4
3
−
−−
−
.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
110 
Stat e Spa ce Mod els  and Transformation
(ii) The initial condition response is
 
 


t
t
t
t
t
t
t
t
t
t
At
e
e
e
e
e
e
e
e
e
e
x
Ce
4
4
4
4
4
2
7
2
1
4
4
4
4
3
/
2
3
/
1
)
0
(











 
¸¸
¹
·
¨¨
©
§
¸¸
¹
·
¨¨
©
§






 
 as before and the step 
response is 

t
t
t
t
t
t
t
t
t
e
e
e
e
e
e
e
e
e










 
¸¸
¹
·
¨¨
©
§
¸¸
¹
·
¨¨
©
§














3
3
1
1
)1
)(
4
/
1(
)1
(
4
)1
)(
4
/
1(
1
1
)1
(
4
)1
(
1
3
/
2
3
/
1
4
4
4
4
 
as 
expected.
 
(c) (i)For this case
 


3
3
1
6
)3
)(
1
(
21
9
2
1
1
1
2
3
1
)3
)(
1
(
)
2
(
4
2
1
1
)
2
)(
1
(
3
)3
)(
2
(
1
)3
)(
1
(
4
)
2
)(
1
(
2
)3
)(
2
(
4
)3
)(
1
(
4
)
2
)(
1
(
1
)3
)(
2
(
1
)3
)(
1
(
1
2
1
4
)
0
(
)
(
1



 



 
¸
¸
¸
¹
·
¨
¨
¨
©
§

¸¸
¹
·
¨¨
©
§






 
¸
¸
¸
¹
·
¨
¨
¨
©
§

¸¸
¸
¸
¸
¸
¸
¹
·
¨¨
¨
¨
¨
¨
¨
©
§


























 


s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
s
x
A
sI
C
This is a time domain response of 
t
t
e
e
3
3
6
−
−+
with no term in 
t
e 2
−as this mode is unobservable. The 
step response in the s-domain is 
)
3
)(
1
(
7
3



s
s
s
s
which inverts to 
t
t
e
e
3
)
3
/
1(
2
)
3
/
7
(
−
−−
−
giving a total 
response of 
t
t
e
e
3
)
3
/
8
(
4
)
3
/
7
(
−
−+
+
.
In the time domain the initial condition response is
 
(
)
(
)
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
3
3
3
2
3
2
3
2
3
2
3
2
3
2
3
3
6
2
1
1
2
2
2
2
1
1
2
2
2
2
2
2
2
2
2
2
1
4
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
−
+
=










−
−
+
=










−










−
+
−
−
+
−
−
+
−
+
−
−
+
−
−
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
111 
Stat e Spa ce Mod els  and Transformation
The step response is




¸
¸
¸
¹
·
¨
¨
¨
©
§

¸
¸
¸
¹
·
¨
¨
¨
©
§


















































1
3
2
)1
)(
2
/
1(
)1
(
2
)1
)(
3
/
1(
)1
)(
2
/
1(
)1
)(
3
/
2
(
)1
(
2
)1
(
)1
(
2
)1
)(
3
/
1(
)1
(
)1
)(
3
/
2
(
)1
(
2
)1
)(
2
/
1(
1
)1
)(
3
/
1(
)1
)(
2
/
1
)1
)(
3
/
2
(
1
*
2
1
4
2
3
2
3
2
3
2
3
2
3
2
3
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
e
which gives 


t
t
t
t
t
t
e
e
e
e
e
e
3
3
3
)
3
/
1(
2
)
3
/
7
(
1
3
2
)1
(
2
)1
)(
3
/
1(
)1
)(
3
/
2
(
2
2








 
¸
¸
¸
¹
·
¨
¨
¨
©
§







 as before 
and giving a total response of 
t
t
e
e
3
)
3
/
8
(
4
)
3
/
7
(
−
−+
+
.
Example 6.8
Obtain the controllable canonical form for the state space descriptions of example 6.4 from
i)	 The transfer function
ii)	 Use of the appropriate transformation matrix.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Control Engineering Problems with Solutions
112 
Stat e Spa ce Mod els  and Transformation
(a)(i)The transfer function is 
12
7
24
5
2



s
s
s
so that in controllable canonical form 
¸¸
¹
·
¨¨
©
§


 
7
12
1
0
cA
, 






= 1
0
c
B
, 


5
24
 
c
C
 and Dc = 0.
(ii) The transformation matrix T to give the controllable canonical has column vectors 
nt  given by 
B
tn  
, 
nt
a
At
0
1

 
, 
nt
a
t
At
1
1
2

 
, 
nt
a
t
At
2
2
3

 
,  etc. where the a’s are the coefficients of the 
characteristic equation. For a second order system this gives the three equations 
B
t =
2
, 
2
0
1
t
a
At

 
,
2
1
1
2
t
a
t
At

 
, only two of which need to be used. Using the first two gives 






= 2
1
2t
and 
¸¸
¹
·
¨¨
©
§
 2
1
2t
and
¸¸
¹
·
¨¨
©
§
 
¸¸
¹
·
¨¨
©
§
¸¸
¹
·
¨¨
©
§




 

 

12
0
2
1
12
/
5
6
/
1
12
/
1
6
/
1
*
12
2
1
0
1
t
A
a
t
, thus 
¸¸
¹
·
¨¨
©
§
 
2
12
1
0
T
 
and 
¸¸
¹
·
¨¨
©
§


 
¸¸
¹
·
¨¨
©
§
¸¸
¹
·
¨¨
©
§



¸¸
¹
·
¨¨
©
§
 
 

7
12
1
0
2
12
1
0
2
2
1
5
0
1
12
/
1
6
/
1
1AT
T
Ac
 
¸¸
¹
·
¨¨
©
§
 
¸¸
¹
·
¨¨
©
§
¸¸
¹
·
¨¨
©
§
 
 

1
0
2
1
0
1
12
/
1
6
/
1
1B
T
Bc
,




5
24
2
12
1
0
2
1
 
¸¸
¹
·
¨¨
©
§
 
 CT
Cc
 and Dc = 0. 
(b)(i) This second order system was found to be uncontrollable and its transfer function reduced to 
1
3
+
s
 
. 
(ii) Because the system is uncontrollable no transformation matrix T can be found. The calculations give 






= 1
1
2t
and 






=












−
−
−
=
4
4
1
1
4
/
5
4
/
1
1
0
4
1t
, giving 






=
4
1
4
1
T
, which is singular as its determinant 
is zero and therefore no inverse exists.
(c)(i) This state space description was found to be controllable but not observable with a transfer function 
of 
3
4
7
3
6
11
6
14
13
3
2
2
3
3



 





s
s
s
s
s
s
s
s
 
after cancelling the common factor of 
2
+
s
. As a third order 
system 
it 
has 
a 
controllable 
canonical 
form 
of 










−
−
−
=
6
11
6
1
0
0
0
1
0
c
A
, 










=
1
0
0
c
B
 
and 


3
13
14
 
 CT
Cc
. As a minimum realisation its controllable canonical form is 






−
−
=
4
3
1
0
cA
, 






= 1
0
c
B
 and 
(
)
3
7
=
c
C
.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
113 
Stat e Spa ce Mod els  and Transformation
(ii) The column vectors for the transformation matrix T are given by
B
t =
3
, 
3
1
0
1
t
A
a
t
−
−
=
and 
3
1
1
1
1
2
t
A
a
t
A
t
−
−
−
=
. For this system 










−
−
−
−
−
−
=
0
1
4
2
1
4
1
1
5
A
giving 










−
−
−
−
=
−
2
/
3
6
/
1
3
/
4
1
3
/
2
3
/
4
2
/
1
6
/
1
3
/
1
1
A
so that 










−
=
1
3
2
3t
, 










=










−










−
−
−
−
−
−
=
4
2
2
1
3
2
9
1
8
6
4
8
3
1
2
1t
and 
¸
¸
¸
¹
·
¨
¨
¨
©
§

 
¸
¸
¸
¹
·
¨
¨
¨
©
§


¸
¸
¸
¹
·
¨
¨
¨
©
§




 
1
9
6
15
31
20
2
/
3
6
/
1
3
/
4
1
3
/
2
3
/
4
2
/
1
6
/
1
3
/
1
2t
giving 










−
−
=
1
1
4
3
9
2
2
6
2
T
with 
¸
¸
¸
¹
·
¨
¨
¨
©
§




 

2
/
3
2
/
13
2
/
19
2
/
1
2
/
5
2
/
7
0
1
2
/
3
1
T
. On substituting the appropriate matrices this gives 
¸
¸
¸
¹
·
¨
¨
¨
©
§



 
 

6
11
6
1
0
0
0
1
0
1AT
T
Ac
, 










=
==
−
1
0
0
1B
T
Bc
and 


3
13
14
 
 CT
Cc
as expected.
(d)(i) For this system 
¸
¸
¸
¹
·
¨
¨
¨
©
§






 
8
17
16
10
17
15
8
16
15
A
, giving 


¸
¸
¸
¹
·
¨
¨
¨
©
§





 

15
1
17
30
8
40
24
8
34
6
/
1
1
A
. For the 
transformation matrix 










−
=
1
1
1
3t
, 










−
=
−
=
−
1
2
2
6
3
1
1
t
A
t
and 
¸
¸
¸
¹
·
¨
¨
¨
©
§


 
¸
¸
¸
¹
·
¨
¨
¨
©
§


 

 


1
2
1
10
9
9
)
11
(
1
3
1
1
2
A
t
t
A
t
 
giving 










−
−
−
−
=
1
1
1
1
2
2
1
1
2
T
and 










−
=
−
2
1
0
0
1
1
1
0
1
1
T
. As expected on substituting the appropriate 
matrices 
¸
¸
¸
¹
·
¨
¨
¨
©
§



 
 

6
11
6
1
0
0
0
1
0
1AT
T
Ac
, 










=
=
−
1
0
0
1B
T
Bc
and 
2)
2
3
CT
Cc
.
Example 6.9 
State space descriptions (a), (c) and (d) of example 6.4 are all controllable. Determine the required state 
feedback gains to move the poles in (a) to -5 and -6 and in (c) and (d) to -4, -5 and -6. Determine also 
the resulting system transfer functions from the new input r to the output y.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
114 
Stat e Spa ce Mod els  and Transformation
(a)This system has 






−
−
−
=
2
2
1
5
A
, 






= 2
1
B
, 
(
)
2
1
=
C
 and D = 0, with controllable canonical 
form 
¸¸
¹
·
¨¨
©
§


 
7
12
1
0
cA
, 






= 1
0
c
B
 and 


5
24
 
c
C
. With D = 0 and state feedback such that 
x
k
r
u
T
−
=
, the new system A matrix 
f
A is given by 
T
f
Bk
A
A

 
. Using the controllable 
canonical form this gives 
¸¸
¹
·
¨¨
©
§




 

 
c
c
T
c
c
c
fc
k
k
k
B
A
A
2
1
7
12
1
0
. For the characteristic equation 
to be 
0
30
11
2
 


s
s
, this requires the components of 
T
ck to be 
18
1  
c
k
 and 
4
2 =
c
k
, where 
the 
subscript 
c 
relates 
to 
the 
canonical 
form. 
The 
transfer 
function 
is 
30
11
24
5
)
(
2
1



 


s
s
s
B
A
sI
C
c
fc
c
. Using the transformation matrix T between the original 
system and its canonical form the required feedback in terms of the original system states is 



x
x
x
T
k
x
k
T
c
c
T
c
2
/
3
1
0
1
12
/
1
6
/
1
4
18
1
 
¸¸
¹
·
¨¨
©
§
 
 

. The required feedback is thus 
(
)
2
/
3
1
=
T
k
. 
If 
this 
feedback 
is 
calculated 
directly 
from 
the 
system 
representation 
then
¸¸
¹
·
¨¨
©
§







 

 
2
1
2
1
2
2
2
2
1
5
k
k
k
k
Bk
A
A
T
f
, 
which 
has 
the 
characteristic 
equation 
2
2
1
2
12
12
)
2
7
(
k
k
k
s
s





, where by chance the constant term is independent of 
1k . For 
this characteristic equation to be 
0
30
11
2
 


s
s
, requires 
1
1 =
k
 and 
2
/
3
2 =
k
 as expected. 
Thus if one does not transform to the controllable canonical form one typically has a set of 
simultaneous equations to solve for the gain values. The transfer function is 




30
11
24
5
2
1
6
0
2
/
5
5
30
11
2
1
2
1
5
0
2
/
5
6
2
1
)
(
2
2
1
1



 
¸¸
¹
·
¨¨
©
§
¸¸
¹
·
¨¨
©
§





 
¸¸
¹
·
¨¨
©
§
¸¸
¹
·
¨¨
©
§


 



s
s
s
s
s
s
s
s
s
B
A
sI
C
f
as expected.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
115 
Stat e Spa ce Mod els  and Transformation
(c) This system has 










−
−
−
−
−
−
=
0
1
4
2
1
4
1
1
5
A
, 










−
=
1
3
2
B
, 
(
)
2
1
4
−
=
C
, D = 0, with transformation 
matrix to controllable canonical form of 










−
−
=
1
1
4
3
9
2
2
6
2
T
 and 
¸
¸
¸
¹
·
¨
¨
¨
©
§




 

2
/
3
2
/
13
2
/
19
2
/
1
2
/
5
2
/
7
0
1
2
/
3
1
T
. 
Using the controllable canonical form  
¸
¸
¸
¹
·
¨
¨
¨
©
§






 
c
c
c
fc
k
k
k
A
3
2
1
6
11
6
1
0
0
0
1
0
, and the characteristic 
equation 
0
6
)
11(
)
6
(
1
2
3
2
3
=
+
+
+
+
+
+
c
c
c
k
k
s
k
s
s
 is required to be 
0
120
74
15
2
3
 



s
s
s
. 
This gives


9
63
114
 
T
ck
 and the feedback required from the original states is 




18
15
36
2
/
3
2
/
13
2
/
19
2
/
1
2
/
5
2
/
7
0
1
2
/
3
9
63
114
1

 
¸
¸
¸
¹
·
¨
¨
¨
©
§




 
 

T
k
k
T
c
T
. The transfer function is
c
fc
c
B
A
sI
C
1
)
(


which gives 
)
6
)(
5
)(
4
(
14
13
3 2





s
s
s
s
s
. Note that there is now no numerator root term 
which cancels a denominator one so the transfer function is third order and the system is observable. 
If one does not use the transformation approach then 

¸
¸
¸
¹
·
¨
¨
¨
©
§













 

3
2
1
3
2
1
3
2
1
1
4
3
2
3
1
3
4
2
1
2
1
2
5
k
s
k
k
k
k
s
k
k
k
k
s
A
sI
f
 
and working out the values of the three k’s to obtain 


18
15
36

 
T
k
 for 
)
det(
f
A
sI 
 to equal 
120
74
15
2
3



s
s
s
 is extremely laborious.
(d) Since this system has the same 
c
A and 
c
B as the previous example 
T
ck is again given by 


9
63
114
 
T
ck
 and the transfer function with the state feedback is 
)
6
)(
5
)(
4
(
3
2
2
2





s
s
s
s
s
.  The required 
feedback from the original states is 




210
72
177
2
1
0
0
1
1
1
0
1
9
63
114
1

 
¸
¸
¸
¹
·
¨
¨
¨
©
§

 
 

T
k
k
T
c
T
. 
It should be noted that provided the system is controllable and observable the zeros of the transfer 
function are not changed by state variable feedback. Also since in the last two examples the pole values 
have been moved appreciably relatively high feedback gains are required, which could cause saturation 
problems in a practical implementation.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
116 
Stat e Spa ce Mod els  and Transformation
6.3	
Problems
Problem 6.1 
Figure P6.1 shows an R-C network. Assuming the resistors to be each equal to R and the capacitors 
each equal to C obtain a state space representation in terms of T = RC for the circuit for the following 
two choices of state variables. (i) the output voltage and its derivative and (ii) the voltages across the 
two capacitors. Confirm the A matrices for the two representations have the same trace, determinant 
and eigenvalues.
R1
R2
C1
C2
Input
Output
 Figure P6.1 Simple R-C circuit.
[






−
−
=
T
T
A
/
3
/
1
1
0
2
, 






= 1
0
B
, 
(
)
0
/
1
2
T
C =
, D = 0. 






−
−
=
T
T
T
T
A
/
2
/
1
/
1
/
1
 






=
T
B
/
1
0
 
(
)
0
1
=
C
 D = 0] 
Problem 6.2 
Figure P6.2 shows an RLC circuit. Derive the transfer function from the input voltage Vi to the output 
voltage Vo. Obtain the A,B,C,D matrices for state space models using (i) the output voltage and its 
derivative as the state variables and (ii) the output voltage and the current through the inductance as 
state variables. Check that the A matrices have the same trace, determinant and eigenvalues for the two 
representations.  
R
C
L
Vi
Vo
Figure P6.2 RLC circuit
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
117 
Stat e Spa ce Mod els  and Transformation
[
¸¸
¹
·
¨¨
©
§


 
RC
LC
A
/
1
/
1
1
0
,
¸¸
¹
·
¨¨
©
§
 1
0
B
,


0
/
1 LC
C  
, D = 0. 
¸¸
¹
·
¨¨
©
§


 
0
/
1
/
1
/
1
L
C
RC
A
¸¸
¹
·
¨¨
©
§
 
L
B
/
1
0


0
1
 
C
D = 0]     
Problem 6.3
Give state space descriptions in (a) controllable canonical form and (b) diagonal form for the following 
transfer functions:-
i)	
2
3
1
)
(
2
+
+
=
s
s
s
G
ii)	
3
4
4
2
)
(
2
3
+
+
+
+
=
s
s
s
s
s
G
iii)	
s
s
s
s
s
s
G
12
7
)
2
)(
1
(
10
)
(
2
3




 
iv)	
6
11
6
1
2
)
(
2
3




 
s
s
s
s
s
G
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Control Engineering Problems with Solutions
118 
Stat e Spa ce Mod els  and Transformation
v)	
8
14
7
1
2
)
(
2
3




 
s
s
s
s
s
G
vi)	
6
5
15
12
2
)
(
2
2




 
s
s
s
s
s
G
[(i) 
¸¸
¹
·
¨¨
©
§


 
3
2
1
0
A
,
¸¸
¹
·
¨¨
©
§
 1
0
B
,


0
1
 
C
,
0
 
D
;
¸¸
¹
·
¨¨
©
§


 
2
0
0
1
A
,
¸¸
¹
·
¨¨
©
§
 1
1
B
,

1
1

 
C
,
0
 
D
. (ii) 
¸
¸
¸
¹
·
¨
¨
¨
©
§



 
4
4
3
1
0
0
0
1
0
A
,
¸
¸
¸
¹
·
¨
¨
¨
©
§
 
1
0
0
B
,


0
1
2
 
C
,
0
 
D
;
¸
¸
¸
¹
·
¨
¨
¨
©
§




 
5.0
866
.0
0
866
.0
5.0
0
0
0
3
A
,
¸
¸
¸
¹
·
¨
¨
¨
©
§
 
1
1
1
B
,


2997
.0
4426
.0
1429
.0


 
C
0
 
D
. (iii) 
¸
¸
¸
¹
·
¨
¨
¨
©
§


 
7
12
0
1
0
0
0
1
0
A
,
¸
¸
¸
¹
·
¨
¨
¨
©
§
 
1
0
0
B
,


10
30
20
 
C
,
0
 
D
;
¸
¸
¸
¹
·
¨
¨
¨
©
§


 
4
0
0
0
3
0
0
0
0
A
,
¸
¸
¸
¹
·
¨
¨
¨
©
§
 
1
1
1
B
,


15
667
.6
667
.1
 
C
,
0
 
D
.  (iv) 
¸
¸
¸
¹
·
¨
¨
¨
©
§



 
6
11
6
1
0
0
0
1
0
A
,
¸
¸
¸
¹
·
¨
¨
¨
©
§
 
1
0
0
B
,


0
2
1
 
C
,
0
 
D
;
¸
¸
¸
¹
·
¨
¨
¨
©
§



 
3
0
0
0
2
0
0
0
1
A
¸
¸
¸
¹
·
¨
¨
¨
©
§
 
1
1
1
B
,


5.2
3
5.0


 
C
,
0
 
D
.  (v)
¸
¸
¸
¹
·
¨
¨
¨
©
§



 
7
14
8
1
0
0
0
1
0
A
,
¸
¸
¸
¹
·
¨
¨
¨
©
§
 
1
0
0
B
,


0
2
1
 
C
,
0
 
D
;
¸
¸
¸
¹
·
¨
¨
¨
©
§



 
4
0
0
0
2
0
0
0
1
A
,
¸
¸
¸
¹
·
¨
¨
¨
©
§
 
1
1
1
B
,


6
/
7
2
/
3
3
/
1


 
C
,
0
 
D
. (vi) 
¸¸
¹
·
¨¨
©
§


 
5
6
1
0
A
,
¸¸
¹
·
¨¨
©
§
 1
0
B
,


2
3
 
C
,
2
 
D
;
¸¸
¹
·
¨¨
©
§


 
3
0
0
2
A
,
¸¸
¹
·
¨¨
©
§
 1
1
B
,


3
1

 
C
,
2
 
D
.]
Problem 6.4
Obtain a state representation of the differential equation 
u
u
x
x
x
x
+
=
+
+
+




3
3
with the output 
x
y =
[










−
−
−
=
0
0
1
1
0
3
0
1
3
A
, 










=
1
1
0
B
, 
(
)
0
0
1
=
C
, 
0
=
D
.]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
119 
Stat e Spa ce Mod els  and Transformation
Problem 6.5
A system has a state space representation with matrices:-






−
−
=
1
4
3
6
A
, 






= 1
1
B
, 
(
)1
2
=
C
 and D = 0. Find
a)	 The eigenvalues of the A matrix.
b)	 Its state transition matrix.
c)	 Its transfer function.
d)	 The output response to an initial value of the state vector equal to (
)
T
1
1
and a unit step 
input.
e)	 The phase of the output relative to the input in the steady state if the input is a sinusoid of 
frequency 1 rad/s.
f)	 If 
(
)
T
b
B
1
=
 not (
)
T
1
1
, find any values of b for which the system is uncontrollable.
[-2,-3; 
¸¸
¹
·
¨¨
©
§














t
t
t
t
t
t
t
t
e
e
e
e
e
e
e
e
3
2
3
2
3
2
3
2
3
4
4
4
3
3
4
3
;
)
3
)(
2
(
2
3



s
s
s
;
t
t
e
e
3
2
)
3
/
14
(
2
)
3
/
1(




;11.3°;-1 and -4/3.]
Problem 6.6
Find the transformation matrix T to transform the A matrix in problem 6.5 to the diagonal form and 
use this to obtain the state transition matrix.
[






−
−
=
1
4
1
3
T
.]
Problem 6.7
Find the state transition matrix for problem 6.5 using the Cayley Hamilton theorem.
Problem 6.8
A system has a state space representation with:-






−
−
=
5
4
2
1
A
, 






= 1
0
B
, 
(
)
c
C
1
=
 and D = 0. Find 
i.	 Its state transition matrix.
ii.	 Its transfer function.
iii.	The output response with no input for c = 1 and an initial state vector (
)
T
1
2
.
iv.	 Any values of c for which the system is unobservable.
[
¸¸
¹
·
¨¨
©
§














t
t
t
t
t
t
t
t
e
e
e
e
e
e
e
e
3
3
3
3
2
2
2
2
,
)
3
)(
1
(
2




s
s
c
cs
,
t
t
e
e
3
3
6

 
, -1/2 and -1.]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
120 
Stat e Spa ce Mod els  and Transformation
Problem 6.9
It has been noted in Example 6.9 that the zeros of the transfer function are not changed by state variable 
feedback. This is a consequence of the fact that 
¸¸
¸
¸
¸
¸
¸
¸
¹
·
¨¨
¨
¨
¨
¨
¨
¨
©
§

 



1
2
1
.
.
1
)
det(
1
)
(
n
c
c
c
s
s
s
A
sI
B
A
sI
, where 
c
A and 
c
B are in the controllable canonical form. Prove 
this result.
Problem 6.10
Find the transformation matrix to transform the state space description






−
−
=
2
6
3
7
A
, 






= 1
2
B
, 
(
)
0
1
=
C
, D = 0 to the controllable canonical form and find this form. Determine the state feedback 
gains to place both poles at -2 and the resulting input-output transfer function.
[
¸¸
¹
·
¨¨
©
§


 
1
5
2
1
T
,
¸¸
¹
·
¨¨
©
§


 
5
4
1
0
cA
,
¸¸
¹
·
¨¨
©
§
 1
0
c
B
,


2
1

 
c
C
 and 
0
 
c
D
.


9
/
1
9
/
5

 
T
k
 and 
2)
2
(
)1
2
(


s
s
.]
Problem 6.11 
A system has






=
1
6
1
0
A
, 






= 1
1
B
, show that it is unstable but controllable and find its controllable 
canonical form. Find also the feedback gains required to move the unstable pole to -5 and keep the 
stable pole unchanged.
[
¸¸
¹
·
¨¨
©
§
 
1
6
1
0
cA
,
¸¸
¹
·
¨¨
©
§
 1
0
c
B
, and


3
/
8
3
/
16
 
T
k
.]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
121 
Stat e Spa ce Mod els  and Transformation
Problem 6.12 
Find the transformation matrix to transform the state space description 
¸¸
¹
·
¨¨
©
§


 
5
12
1
2
A
, 






= 1
0
B
, 
(
)
2
1
=
C
, D = 0 to the controllable canonical form and find this form. Determine the state feedback 
gains to place the poles at -3 and -4. Do this both by (i) using the transformation matrix for the controllable 
canonical form and (ii) transforming to diagonal form and using the feedback gains required for the 
diagonal form. What is the new input-output transfer function?
[
¸¸
¹
·
¨¨
©
§

 
1
2
0
1
T
,
¸¸
¹
·
¨¨
©
§


 
3
2
1
0
cA
,
¸¸
¹
·
¨¨
©
§
 1
0
c
B
,


2
3

 
c
C
,


4
18
 
T
k
,
12
7
1
2
2



s
s
s
]
Problem 6.13
For the controllable canonical form of the transfer function (v) of Problem 6.3 find the required feedback 
gains to place all the poles at 
1
−
=
s
. What is the new input-output transfer function?
[


4
11
7
 
T
k
,
3)1
(
1
2


s
s
].
Problem 6.14
A system has the controllable canonical form state space representation 
¸
¸
¸
¹
·
¨
¨
¨
©
§



 
8
19
12
1
0
0
0
1
0
A
,
¸
¸
¸
¹
·
¨
¨
¨
©
§
 
1
0
0
B
,


0
1
2
 
C
,
0
 
D
; Find:-
i)	 The eigenvalues of the A matrix.
ii)	 The required state feedback gains to move all the poles to -1.
iii)	The transformation matrix T to put the system in diagonal form.
iv)	The required state feedback gains to place all the poles at -1 for the diagonal form.
[-1,-3,-4; 
)
5
,
16
,
11
(



 
k
;
¸
¸
¸
¹
·
¨
¨
¨
©
§



 
16
9
1
4
3
1
1
1
1
T
;
)
27
,8
,0
(


 
k
]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
122 
Stat e Spa ce Mod els  and Transformation
Problem 6.15
A system is described by the following A, B, C, D matrices:-
¸
¸
¸
¹
·
¨
¨
¨
©
§




 
36
10
40
36
13
44
37
11
42
A
,
¸
¸
¸
¹
·
¨
¨
¨
©
§


 
1
1
1
B
,


3
2
5

 
C
,
0
 
D
; Find:-
1)	 The eigenvalues of the A matrix
2)	 The transformation matrix T to put the system into the controllable canonical form
3)	 The required state feedback gains to place all the poles at -1.
[-1, -2 , -4;
¸
¸
¸
¹
·
¨
¨
¨
©
§





 
1
1
2
1
2
4
1
1
3
T
;
)
26
,7
,
29
(


 
k
]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
123 
Control System Design
7	 Control System Design
7.1	
Introduction
This chapter is concerned with the design of linear feedback control systems to meet specified design 
criteria. It covers problems relating to the material of chapters 7, 8, 9 and 11 of reference1. Extensive 
use is made of Matlab to get open loop frequency response and closed loop step response data. Many 
numerical answers given have been taken from Matlab plots using the cursor so should not be regarded 
as exact but are sufficiently accurate to compare the results of different design approaches. More time 
could have been taken to get more accurate numbers, for example by doing plots with more points or over 
shorter ranges but this really serves no purpose as in many practical problems models are approximate 
and their parameters are in many cases not known to better than 10%. 
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
EXPERIENCE THE POWER OF 
FULL ENGAGEMENT…
     RUN FASTER.
          RUN LONGER..
                RUN EASIER…
READ MORE & PRE-ORDER TODAY 
WWW.GAITEYE.COM
Challenge the way we run

Control Engineering Problems with Solutions
124 
Control System Design
The initial examples and problems concentrate on the design of classical controllers, namely phase lead, 
phase lag and PID controllers, Their use in both the error channel and feedback paths are considered. 
The advantages of these controllers, which are in series with the plant, are:- (i) there design is not difficult 
and since they have few parameters the effect of changing any one of them is easily understood (ii) the 
input signals they use, either the system output and/or the error, are readily available (iii)in many cases 
they can achieve the desired system performance requirements. Probably their major disadvantage is that 
they may not be able to maintain satisfactory performance if the plant parameters vary significantly, as 
shown in some examples. It may be possible to overcome this difficulty by the use of state feedback to 
change the system poles but this normally requires the measurement or estimation of additional signals. 
Also a state space model is required which may require more modelling effort than finding a transfer 
function or frequency response from plant input-output data. Some of these aspects are considered in 
the later examples.
7.2	
Examples
Example 7.1 
A control system has a plant transfer function of 
2)
4.0
1(
/
2
)
(
s
s
s
G
+
=
. Show that in a feedback loop 
with a unit negative feedback gain it has a phase margin of 28.7° at the frequency 1.48 rads/s. Design both 
phase lead and lag compensators with unit gain at zero frequency so that the phase margin is increased 
to around 45°. Obtain the step responses using Matlab of the closed loop with a unit gain compensator 
and the phase lead and lag designs having the error signal as input. Design also a phase lead compensator 
using pole-zero cancellation to produce the same phase margin. Compare the overshoot, peak time, 
settling time and phase margin for all four designs in a Table. 
2)
4.0
1(
2
)
(
Z
Z
Z
j
j
j
G

 
,  so that 
)
16
.0
1(
2
|)
(
|
2
Z
Z
Z

 
j
G
 giving 
2
16
.0
3
 
 Z
Z
 which has the 
solution 
48
.1
 
Z
. The corresponding phase is 
48
.1
*
4.0
tan
2
90
1



 which equals -151.25°, giving 
a phase margin of 28.7°. 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
125 
Control System Design
Thus to achieve a phase margin of around 45° the lead compensator using the classical design approach 
will require a maximum phase lead of 16.3+ε°. For this transfer function, since both break points occur 
at the same frequency, the phase change will be quite rapid beyond the double break point so a relatively 
high value of ε should be taken. Thus considering Table 7.1 in reference 1 a value of 
3
/
1
=
α
will be 
tried. The peak gain for this value ofα  is 4.77dB. G(jω) is approximately 4.77dB down at 
05
,2
 
Z
, so 
choosing this as the centre frequency of the lead.network 
sT
sT
s
Gc
D


 1
1
)
(
 
gives 
05
.2
/
1
 
D
T
, so 
that 
.
84
.0
|
T
 Using 
s
s
s
Gc
28
.0
1
84
.0
1
)
(


 
 
gives a phase margin of 41°. Because of the rapid phase change 
of G(jω) repeating the design for 
4
/
1
=
α
 gives a smaller phase margin of around 37°. For the phase 
lag design the compensator 
sT
sT
s
Gc
D


 1
1
)
(
 
will now have 
1
>
α
. and typically the breakpoint 
T
/
1
is 
chosen one decade below the required unity gain point of the open loop transfer function. Assuming 
the lag network has a phase lag of around 5° at the required unity gain point this means finding the 
frequency where G(jω) has a lag of about 130°. This is 
91
.0
|
Z
, so that 
91
.0
/
10
 
T
, giving 
approximately 11. The gain of 
)
( Z
j
G
at 
91
.0
|
Z
 is 1.95 so taking 
2
=
α
gives 
s
s
s
Gc
22
1
11
1
)
(


 
.  The 
closed loop step responses for the lead and lag designs and a unit gain compensator are shown in Figure 
7.1.
If the compensator is designed by pole-zero cancellation then 
)
(s
Gc
will be of the form 
sT
s
s
Gc


 1
4.0
1
)
(
. 
Choosing the time constant ratio to be of the same order as the lead design, i.e. 4, gives 
s
s
s
Gc
1.0
1
4.0
1
)
(


 
, 
which results in a phase margin of 47.3° and a step response with an overshoot of 13%. A comparison 
of the results is given in Table 7.1 with that labelled lead being for the classical design.
0
5
10
15
0
0.5
1
1.5
Step Response
Time (sec)
Amplitude
lead
lag
no compensator
Figure 7.1 Comparison of closed loop step responses.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
126 
Control System Design
Compensator
%overshoot
Peak time,s.
Settling time,s.
Phase margin °
None
44
2.1
12.5
29 at 1.48rad/s
Classical phase lead
27
1.4
4.4
41 at 2.06rad/s
Cancellation phase lead
21
1.7
4.0
47 at 1.65rad/s
Phase lag
23
3.2
15
48 at 0.89rad/s
Table 7.1 Summary of step responses
Example 7.2 
A control system has a plant transfer function of 
)
1.0
1
)(
5.0
1(
/
2
)
(
s
s
s
s
G


 
. Calculate the phase 
margin. Design phase lead compensators by the classical approach and also by pole-zero cancellation 
with the same time constant ratio which yields a phase margin of 55° at ω = 1.80. Design also a phase lag 
compensator to give the same phase margin. Estimate the difference in gain of the closed loop frequency 
response at high frequencies and confirm this by obtaining the closed loop frequency response plots. 
What is the significance of this with respect to any high frequency noise generated in the output position 
measurement device?
For the given transfer function 
2
/
1
2
2
/
1
2
)
01
.0
1(
)
25
.0
1(
/
2
|)
(
|
Z
Z
Z
Z


 
j
G
 and this is equal to unity 
when 
56
.1
 
Z
. The corresponding phase of G(jω)  is then 
62
.
136
156
.0
tan
78
.0
tan
90
1
1

 





 
giving a phase margin of 43.4°. The required additional phase lead to produce a phase margin of 55° is 
H

12
, so a value of 
2
/
1
=
α
 may be selected. G(jω) is 3dB down when 
97
.1
 
Z
 so that 
72
.0
97
.1
/
2
|
 
T
 
giving the compensator transfer function 
s
s
s
Gc
36
.0
1
72
.0
1
)
(


 
 
which gives a phase margin of 53.6°at 
98
.1
 
Z
. 
(Note if 
3
/
1
=
α
 is chosen the design gives 
s
s
s
Gc
26
.0
1
77
.0
1
)
(


 
 
which provides a phase margin of 58.8° at 
24
.2
 
Z
). A pole-zero cancellation design with a time constant ratio of 2 gives 
s
s
s
Gc
25
.0
1
5.0
1
)
(


 
 
which 
yields a phase margin of 55.6° at Z = 180.
For a phase lag design allowing for the lag network to give 5° phase lag at the required unit gain frequency 
requires 

120
)
(
/_
−
=
ω
j
G
which is given for 
91
.0
 
Z
 and the corresponding 
j
G
|)
(
|
 
Z
 = 6db which 
corresponds to a gain of 2.0. Thus 
11
91
.0
/
10
|
 
T
 and the resulting lag compensator has a transfer 
function of 
s
s
s
Gc
22
1
11
1
)
(


 
. The characteristics of the step response for all three designs with the 
compensators having the error as input are given in Table 7.2. 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
127 
Control System Design
Compensator
%overshoot
Peak time,s.
Settling time,s.
Phase margin °
Classical phase lead
14
1.38
3.0
53.6 at 1.98rad/s
Cancellation phase lead
12
1.50
2.3
55.6 at 1.80rad/s
Phase lag
12
3.06
11
57.5 at 0.91rad/s
Table 7.2 Summary of step response results
The transfer function from a sensor measuring the output to the output is 
G
G
G
G
c
c

1
 
whether the 
compensator has the output or error as input. At high frequencies the open loop gain will become small 
so that this transfer function approximates the open loop gain transfer function 
G
Gc
. The high frequency 
gain of the compensator 
sT
sT
s
Gc
D


 1
1
)
(
 is 
α
/
1
. For the lead compensators this is 2 and for the lag 
compensator it is 0.5. Thus the difference in the gain at high frequency between the lead and lag 
compensators is 12dB, so that the effect of measurement noise can be significantly less for the lag 
compensator. The closed loop frequency responses for the system with the lead and lag compensators 
are shown in Figure 7.2.
-100
-80
-60
-40
-20
0
20
Magnitude (dB)
10
-1
10
0
10
1
10
2
-270
-180
-90
0
Phase (deg)
Bode Diagram
Frequency  (rad/sec)
lead
lag
lead
lag
Figure 7.2 Closed loop frequency response plots.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
128 
Control System Design
Example 7.3 
Two lead compensators were designed in each of Examples 7.1 and 7.2 and the results for step responses 
summarised in a Table. Add to the Tables the results if the compensators are placed in the feedback path 
having the output rather than error as input. What do you conclude from these results?
Compensator
%overshoot
Peak time,s.
Settling time,s.
Phase margin °
Classical phase lead
1
4.3
3.7
41 at 2.06rad/s
Cancellation phase lead
13
2.1
4.1
47 at 1.65rad/s
Table 7.3a Summary for Example 7.1
Compensator
%overshoot
Peak time,s.
Settling time,s.
Phase margin °
Classical phase lead
0
n/a.
3.3
41 at 2.06rad/s
Cancellation phase lead
4
1.9
2.3
47 at 1.65rad/s
Table 7.3b Summary for Example 7.2
The settling times are comparable with those for the compensator in the error channel but the overshoots 
are lower. This is typical and due to the fact that when the lead compensator is in the feedback path the 
zero in the closed loop transfer function occurs at a higher frequency.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
PDF components for PHP developers
www.setasign.com
SETASIGN
This e-book  
is made with 
SetaPDF

Control Engineering Problems with Solutions
129 
Control System Design
Example 7.4 
A control system has a plant with a transfer function of 
)
2
(
/
5.0
)
(
2
2
2
o
o
o
s
s
s
s
G
ω
ω
ζ
ω
+
+
=
 and 
1
)
(
=
s
H
. The design specifications are to design a series compensator to keep approximately the same 
open loop bandwidth as that with a unit gain compensator and a step response with an overshoot of no 
more than 25% assuming that the parameters 
o
ω  and ζ , which are not known very accurately are 1 and 
0.1, respectively. Is the system stable if 
1
)
(
=
s
Gc
? The designer chooses a P-Z cancellation compensator 
for the feedforward path with transfer function 
2
2
)
1
/(
)1
2.0
(
)
(
sT
s
s
s
Gc



 
 . Determine a suitable 
value of T and from Matlab obtain the percentage overshoot and settling time for the closed loop step 
response and the phase and gain margins. What are the overshoot and settling time if the compensator 
is placed in the feedback path? Because of the uncertainty about the parameters the designer examines 
the performance as ζ varies. Calculate the minimum value of ζ for which the system will be stable and 
the overshoot, settling time and phase margin for
05
.0
 
]
. The designer obtains further results for the 
step response and phase margin for both 
1.0
=
ζ
 , the nominal value, and 
05
.0
 
]
, with 
8.0
=
o
ω
 
and, 
2.1
=
o
ω
. What do you conclude from these results?
With no compensator, that is 
1
)
(
=
s
Gc
 the closed loop characteristic polynomial is 
0
5.0
2.0
2
3
=
+
+
+
s
s
s
 so the system is unstable as applying the Routh criterion 0.5 > 0.2×1.0. 
Since the design must achieve approximately the same open loop bandwidth a suitable choice for T  is 
unity, so that 
2
2
)
1
/(
)1
2.0
(
)
(
s
s
s
s
Gc
+
+
+
=
 and 
2)
1(
/
5.0
)
(
)
(
s
s
s
G
s
Gc
+
=
with ideal pole-zero 
cancellation. The step response gives an overshoot of 25% at a time of 6.72s, a settling time of 19s and 
the system phase and gain margins are 44.1° at 0.424 rad/s and 12dB at 1.00rad/s, respectively. If the 
compensator is placed in the feedback path the overshoot is 91% at a time of 4.8s and the settling time 
is 36s.
If 
the 
damping 
is 
unknown 
the 
compensated 
open 
loop 
transfer 
function 
is
)1
2
(
5.0
)1
(
)1
2.0
(
)
(
)
(
2
2
2
+
+
+
+
+
=
s
s
s
s
s
s
s
G
s
Gc
ζ
. The phase shift of the plant transfer function is -180° at 
the frequency of 1rad/s. where it has a gain of  0.5/2ζ. At this frequency the compensator has no phase 
shift and a gain of 0.2/2, which is 0.1. Thus the compensated system has a gain of 1/40ζ at a phase -180°, 
so that for stability 40ζ > 1 giving ζ > 0.025.
The results for the step responses are summarised in Table 7.4
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
130 
Control System Design
Res. frequency
Damping factor
Overshoot
Settling time
Phase margin°
1.0
0.1
25% at 6.7s
19s
44 at 0.424rad/s
1.0
0.05
20 at 6.3s
24s
47 at 0.425rad/s
0.8
0.1
51% at 7s
124s
35 at 0.485rad/s
0.8
0.05
unstable
16 at 0.696 rad/s
1.2
0.1
26 % at 7.7s
19s
47. at 0.406rad/s
1.2
0.05
25% at 8.1s
54s
49 at 0.406rad/s
Table 7.4 Summary of step response results.
From the tabulated results several interesting aspects can be seen although examination of the complete 
step responses and Bode or Nyquist diagrams yield further interesting aspects. First for the fourth case 
in the Table the system goes unstable, although the phase margin given by Matlab does not reveal this. 
In fact the gain goes through unity at two frequencies and Matlab computes the phase margin from the 
lowest frequency. The gain margin is negative so this confirms the instability. The settling time for the 
closed loop step response often increases significantly due to oscillations resulting from the resonant 
poles not being cancelled by the zeros of the compensator. The effect of overestimating the resonant 
frequency of the plant poles has the most significant effect on the resulting behaviour.
Example 7.5 
A plant with a transfer function of 
2)
1
/(
)
1(
2
)
(
s
s
s
G


 
 is required to be controlled in closed loop 
with a PI controller, with transfer function 
))
/
1(
1(
)
(
i
i
c
sT
K
s
G

 
, to provide a good response to set 
point changes. Compare controller designs using the following methods and comment on your results.
a)	 The zero of the controller is used to cancel a plant pole and then 
i
K  is chosen using the 
root locus approach to place the closed loop poles to give (i) two real and equal poles and 
(ii) complex poles with a damping ratio of 0.6.
b)	 Use of the Ziegler-Nichols rules {
c
i
K
K
45
.0
 
and 
c
i
T
T
8.0
=
where 
c
K and 
cT are 
respectively the critical gain and the critical period of the plant}.
c)	 The critical frequency,
c
c
T
/
2π
ω =
, is placed at the point 0.40 /_-195° on the compensated 
Nyquist plot.
d)	 Simulation is used to determine the
i
K and 
iT which minimise the ISTE.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
131 
Control System Design
(a) The transfer function of the controller is 
)]
/)
1
[(
)
(
i
i
i
c
sT
sT
K
s
G

 
so that for its zero to 
cancel a plant pole 
1
=
iT
, giving the open loop transfer function 
)
1(
/)
1(
2
s
s
s
Ki
+
−
. Thus, since 
the transfer function is second order it is easy to evaluate the required gains from the characteristic 
equation 
0
2
)
2
1(
2
=
+
−
+
i
i
K
K
s
s
. This shows that the system is stable for
5.0
<
i
K
 ; that equal 
roots will occur for 
0858
.0
=
i
K
 (the breakaway point of the root locus from the negative real 
axis) and roots for a damping ratio of 0.6 for 
1603
.0
=
i
K
. Thus using approximate values the 
required PI controller transfer functions have (i) 
086
.0
=
i
K
, 
1
=
iT
and (ii) 
16
.0
 
i
K
,
1
=
iT
.
(b) The plant has a frequency response 
2)
1
/(
)
1(
2
)
(
ω
ω
ω
j
j
j
G
+
−
=
from which it is easily seen that 
the critical frequency is 
732
.1
=
c
ω
and the corresponding gain is unity. 
63
.3
732
.1
/
2
 
 S
c
T
 so 
that from the rules 
90
.2
63
.3
8.0
 
 
x
Ti
and 
45
.0
 
i
K
.
(c) For this case the PI controller must give a gain of 0.40 and a phase lag of 15° at the critical frequency of 
1.732rad/s. Thus 
$
75
tan 1
 

i
cT
Z
giving 
15
.2
 
iT
 and 
4.0
)
1(
2
/
1
2
2
 

i
c
i
c
i
T
T
K
Z
Z
 
so that 
386
.0
=
i
K
.
(d) Since only two parameters are to be adjusted to minimise the ISTE this can be done by iteration with 
the Simulink block diagram shown in Figure 7.3. The results are 
42
.0
 
i
K
 and 
21
.2
 
iT
. 
-2s+2
s  +2s+1
2
Transfer Fcn
y
To Workspace
Step
Scope
Product1
Product
1
s
Integrator2
1
s
Integrator1
1
s
Integrator
-K-
Gain1
-K-
Gain
2.497
Display
Figure 7.3 Simulink diagram for evaluation of ISTE
The results are summarised in Table 7.5 together with the important descriptors of the closed loop step 
response and open loop frequency response. 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
132 
Control System Design
Case
Ki
Ti
Overshoot
Settling time
Phase margin°
Gain margin dB
a(i)
0.086
1.0
No
14.9s
71 at0.172
15.3 at 1.0
a(ii)
0.16
1.0
10% at7.7s
11.3s
54 at 0.320
9.9 at 1.0
b
0.45
2.90
3% at3.7s
14.2s
67 at 0.481
5.8 at 1.46
c
0.39
2.15
7% at4.3s
9.5s
60 at 0.466
6.2 at 1.36
d
0.42
2.21
10% at4.1s
9.3s
58 at 0.489
6.0 at 1.35
Table 7.5
The designs trade off speed of response, which if fast will result in an overshoot, against a longer settling 
time. The low value of 
i
K  in design a(i) results in a slow response with no overshoot and has the largest 
gain and phase margins. If a small overshoot is allowed then designs (b) and (c) would probably be 
preferred.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
www.sylvania.com
We do not reinvent  
the wheel we reinvent 
light.
Fascinating lighting offers an infinite spectrum of 
possibilities: Innovative technologies and new  
markets provide both opportunities and challenges. 
An environment in which your expertise is in high 
demand. Enjoy the supportive working atmosphere 
within our global group and benefit from international 
career paths. Implement sustainable ideas in close 
cooperation with other specialists and contribute to 
influencing our future. Come and join us in reinventing 
light every day.
Light is OSRAM

Control Engineering Problems with Solutions
133 
Control System Design
Example 7.6 
A process has a transfer function of  
2)
2.0
1
)(
1
/(
2
)
(
s
s
s
G


 
 which is to be controlled in a feedback loop 
with 
1
)
(
=
s
H
 and a PID controller with transfer function
)}
1
/
(
)
/
1(
1
{
)
(
d
d
i
c
sT
sT
sT
K
s
G
D



 
, 
with  
1.0
=
α
 What are the critical gain, 
c
K , and frequency,
c
ω , of the plant? It is required to achieve 
a set point step response with an overshoot of no more than 20% and a settling time of 2 seconds. What 
are the results from the following two design approaches? 
a)	 Use of the Ziegler - Nichols tuning parameters, 
c
K
K
6.0
=
, 
c
i
T
T
5.0
=
 and 
c
d
T
T
125
.0
=
, 
where 
c
cT
ω
π /
2
=
.
b)	 Assuming 
0
=
α
 in 
)
(s
Gc
 the critical frequency is moved to the point 0.7/_-135° on the 
compensated Nyquist locus. Give the calculated values of K and 
d
T  to do this assuming 
d
i
T
T
4
=
.
From Matlab the gain margin is 17.1dB at 5.92 rads/s and the phase margin 89.1° at 1.53 rads/s. The 
gain corresponding to 17.1dB is 
16
.7
10
20
/
1.
17
 
 Thus 
16
.7
 
c
K
 and 
92
.5
 
c
Z
.
(a) 
06
.1
92
.5
/
2
 
 S
cT
 so that from the Z-N rules 
3.4
16
.7
6.0
|
 
x
K
, 
53
.0
5.0
 
 
c
i
T
T
 and 
13
.0
|
d
T
. Substituting these values in the given transfer function 
)
(s
Gc
 for the PID controller 
gives 
s
s
s
s
s
Gc
53
.0
00689
.0
)1
543
.0
0758
.0
(
3.4
)
(
2
2



 
. For this controller the system has a gain margin of 19.9dB at 
16.9rads/s , a phase margin of 26.8 at 4.71 rads/s and a closed loop step response with an overshoot of 
51% at 0.64s and a settling time of 2.8s.
(b) With 
0
=
α
and 
d
i
T
T
4
=
the transfer function of the controller is 
d
d
c
sT
sT
K
s
G
4
/
)
2
1(
)
(
2

 
and 
to satisfy the required phase condition of the design it must have a phase shift of 45° at 
c
ω . Thus 
d
cT
Z
2
tan
2
90
45
1



 
$
$
  giving  
204
.0
=
d
T
. To satisfy the gain condition 
7.0
|)
(
||)
(
|
=
ω
ω
j
G
j
G
c
c
which gives 
7.0
4
)
4
1(
16
.7
1
2
2
 

d
c
d
c
T
T
K
Z
Z
, yielding 
54
.3
 
K
 after substituting for 
c
ω  and 
d
T . Taking 
20
.0
 
d
T
and 
82
.0
 
iT
 gives the controller transfer function 
s
s
s
s
s
Gc
82
.0
0164
.0
)1
84
.0
180
.0
(
54
.3
)
(
2
2



 
. 
With this controller the system has a gain margin of 19.3dB at 17.8rads/s, a phase margin of 47.2° at 
4.70 rads/s and a closed loop step response with an overshoot of 24% at 0.62s and a settling time of 1.1s.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
134 
Control System Design
Thus neither controller design meets the step response criterion. However approach (b) meets the settling 
time criterion and several modifications are possible which might achieve the design criterion. One 
possibility is to feed the derivative term from the output rather than the error but this results in a larger 
overshoot and a longer settling time. A second possibility is to just keep the integral term in the error 
channel and feed both the proportional and derivative terms from the output as this delays the effect of 
the step input at the input to the plant. This results in 
s
s
Gc
8.0
/
54
.3
)
(
 
 and 
s
s
s
Gcf
02
.0
1
)
22
.0
1(
54
.3
)
(


 
 
fed from the output. In this case the system has a gain margin of 13dB at 4.43 rads/s, a phase margin of 
68.4° at 1.08 rads/s and a closed loop step response with no overshoot and a settling time of 2.1s. This 
roughly satisfies the criterion which can be achieved by minor modifications of the parameters. A third 
approach is to move the critical point in the approach of (b). Since the settling time for the design was 
easily achieved a gain reduction should reduce the overshoot, so the critical frequency can be moved 
from 
0.7/_-135° 
to 
0.55/_-135° 
giving 
a 
controller 
gain 
75
.2
 
K
. 
Thus 
taking 
s
s
s
s
s
Gc
82
.0
0164
.0
)1
84
.0
180
.0
(
75
.2
)
(
2
2



 
 
gives a system with a gain margin of 21.5dB at 17.8 rads/s, phase 
margin of 52.3° at 3.84 rads/s and a closed loop step response with overshoot of 19% at 0.72s and a 
settling time of 1.5s.
Finally another possibility would be to use a PI-PD controller where a proportional term is included in 
both the error channel and the feedback path.
Example 7.7 
A plant has a transfer function of 
)}
/
(
)
/
2
(
1
{
/
2
)
(
2
2
o
o
s
s
s
s
G
Z
Z
]


 
 with 
25
.1
 
]
 and 
5.2
 
o
Z
.
It is to be controlled in a feedback loop with 
1
)
(
=
s
H
 and a compensator 
)
(s
Gc
 in the error channel. 
What are the gain and phase margins if
1
)
(
=
s
Gc
. Design a phase lead compensator with unit gain at 
zero frequency to give a phase margin of around 45° and give the gain crossover frequencies of the 
uncompensated and compensated open loop frequency responses. Unfortunately there is considerable 
uncertainty about the damping ratio, ζ , and it is believed it might get as small as half the assumed value. 
If this is the case what will be the phase margin of the system. Investigate the design of a compensator 
to achieve the required value of phase margin for both values of damping.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
135 
Control System Design
For the given G(s) the gain margin is 9.9dB at 2.5rads/s and the phase margin is 28.5° at 1.33rads/s. 
Since the plant gain falls off quickly to achieve a phase margin of 45° the compensator will probably 
have to provide a lead of at least 30°. Taking 
3
/
1
=
α
 gives a gain of 4.77dB and a maximum phase lead 
of 30°. G(s) is approximately 4.77dB down at 1.83rads/s so 
95
.0
83
.1
/
3
 
 
T
giving 
s
s
s
Gc
32
.0
1
95
.0
1
)
(


 
. 
This compensator only results in producing a phase margin of 43.9° at 1.83 rads/s for the system. Trying 
4
/
1
=
α
 results in 
s
s
s
Gc
25
.0
1
1
)
(


 
 
and a system with a phase margin of 47.7° at 1.97rads/s. The 
required gain crossover frequencies are 1.33 and 1.97rads/s, respectively. The closed loop step response 
of the compensated system gives an overshoot of 20% at 1.43s and a settling time of 3.3s.
When the compensator is used for the plant with damping reduced by 50% the gain margin is 3.06dB at 
3.67rads/s and the phase margin is 14.6° at 1.32rads/s. The closed loop step response is very oscillatory 
with an overshoot of 41% at 1.23s.and a settling time of 14.6s. {NOTE. If the main concern for the results 
with the reduced damping is the poor step response, not the phase margin, then one could investigate 
the performance with the lead controller in the feedback path. If this is done then for the nominal 
damping the step response has no overshoot and a settling time of 4.6s and for the reduced damping an 
oscillatory behaviour along a time constant so that the first overshoot is 5% at 3.23s and the second 6% 
at 5.13s with a settling time of 10.9s. Possibly an acceptable design.}
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
360°
thinking.
© Deloitte & Touche LLP and affiliated entities.
Discover the truth at www.deloitte.ca/careers 

Control Engineering Problems with Solutions
136 
Control System Design
A phase margin of 45° cannot be achieved for the plant transfer function with the reduced damping 
with a lead compensator so that if speed of response is not a factor then a phase lag compensator can 
be used. The Bode diagrams for the two plant transfer functions are shown in Figure 7.4. As the phase 
shift of the nominal plant (larger damping) is greater initially the phase lag network needs to be designed 
for this transfer function. The transfer function has a phase lag of around -130° at 0.77rads/s where the 
gain is about 6.87dB=2.20. An approximate phase lag with 
13
077
.0
/
1
|
 
T
 is 
s
s
s
Gc
28
1
13
1
)
(


 
which 
gives a phase margin of 46.1° at 0.781rads/s with the nominal plant and 58.5° at 0.952 rads/s with the 
plant with the reduced damping. The closed loop step responses for the two cases have overshoots of 
24% at 3.66s and 12% at 2.7s, and settling times of 13s and 14s, respectively.
-40
-20
0
20
40
Magnitude (dB)
10
-1
10
0
10
1
-270
-225
-180
-135
-90
Phase (deg)
Bode Diagram
Frequency  (rad/sec)
Figure 7.4 Frequency responses for plant transfer functions. (nominal plant blue)
Example 7.8 
A plant has a transfer function 
)
4
(
/)
1(
)
(
2 −
+
=
s
s
s
s
G
 and is to be controlled in a loop with unit 
negative feedback by the phase lead compensator 
)
1.0
1
/(
)
1(
)
(
s
s
K
s
Gc


 
. Plot a root locus for the 
system and find the approximate value of K to give a minimum overshoot to an input step.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
137 
Control System Design
The open loop transfer function 
)
1.0
1
)(
4
(
)
1(
)
(
)
(
2
2
s
s
s
s
K
s
G
s
Gc



 
 
which has two zeros at -1 and poles at 
0, 2, -2 and -10. This is an unstable transfer function due to the pole at 2. The basic rules for the root 
locus indicate there will be a locus on the real axis between the poles at 2 and 0 and between the poles 
-2 and -10. The excess of poles over zeros is 2 so there are two locus branches which tend to infinity 
along an asymptote cutting the real axis at -4. The locus starts at poles and finishes at zeros so that there 
will be two breakaway points from the real axis one between 2 and 0 and the other between -2 and -10. 
The two loci from the former will finish at the two zeros at -1. The root locus from Matlab is shown in 
Figure 7.5. Two points are marked, one shows that the system becomes stable for K > 2.64 and the other 
that the breakaway point between the roots -2 and -10 occurs for a gain K = 3.29.
Root Locus
Real Axis
Imaginary Axis
-10
-8
-6
-4
-2
0
2
-10
-8
-6
-4
-2
0
2
4
6
8
10
System: gl
Gain: 2.64
Pole: -0.00715 + 1.12i
Damping: 0.00638
Overshoot (%): 98
Frequency (rad/sec): 1.12
System: gl
Gain: 3.29
Pole: -4.7 + 7.88e-008i
Damping: 1
Overshoot (%): 0
Frequency (rad/sec): 4.7
Figure 7.5 Root locus plot
Thus whatever the choice of K there will be 4 complex poles. There is little change in the overshoot for 
the step response for gains K over quite a significant range as shown in Figure 7.6 for gains of 10, 20 
and 30, respectively. The minimum overshoot of around 51% occurs for K = 12.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
138 
Control System Design
0
0.5
1
1.5
2
2.5
3
3.5
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
Step Response
Time (sec)
Amplitude
K=10
K=30
K=20
Figure 7.6 Closed loop step responses for different gains.
Example 7.9 
A feedback system has a plant with a transfer function 
)
125
.0
1
)(
5.0
1(
/
)
(
s
s
s
K
s
G


 
 and 
1
)
(
=
s
H
. 
Determine the maximum value of K for the system to be stable. If K is half this value; design a phase 
lead compensator of the form 
)
125
.0
1
/(
)
1(
)
(
s
sT
s
Gc


 
 to achieve a maximum phase margin. Give 
details of the resulting closed loop step response if the compensator is placed (a) in the error channel and 
(b) in the feedback path. Find using simulation the optimum values of T to minimise the ISTE (Integral 
of the square of time times error) for cases (a) and (b). Give details of the corresponding step responses.
A hand calculation to evaluate the required value of T  is extremely time consuming but with Matlab a solution 
can easily be obtained by trial and error using the margin command. The optimum value of T is around 
0.47 and it results in a phase margin of 37.7°. The closed loop step response for (a) results in an overshoot 
of 34% at 0.67s and a settling time of 2.4s and for (b) an overshoot of 1% at 1.01s and a settling time of 2.0s. 
A simulation diagram for evaluating the ISTE is shown in Figure 7.7 for the compensator in the forward 
path. The optimum values of T are 0.60 and 0.44, respectively, and the value of the ISTE is about 12% 
smaller for case (b). The step response has an overshoot of 34% at 0.80s and a settling time of 2.53s for 
case (a) and 5% at 1.06s and settling time of 2.03s for case(b).
0.6s+1
0.125s+1
Transfer Fcn1
80
den(s)
Transfer Fcn
Step
Scope2
Scope1
Scope
Product1
Product
1
s
Integrator1
1
s
Integrator
0.03894
Display
Figure 7.7 Simulink diagram for ISTE evaluation.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
139 
Control System Design
Example 7.10 
A process with a transfer function of 
)
1
/(
4
)
(
s
e
s
G
s

 

 is to be controlled in a feedback loop with 
1
)
(
=
s
H
 and a PID controller with transfer function 
)}
1
/
(
)
/
1(
1
{
)
(
d
d
i
c
sT
sT
sT
K
s
G
D



 
, with 
1.0
=
α
 What are the critical gain,
c
K , and frequency,
c
ω , of the plant? What are the results from the 
following three design approaches? 
a)	 Use of the Ziegler – Nichols tuning parameters, 
c
K
K
6.0
=
, 
c
i
T
T
5.0
=
and 
c
d
T
T
125
.0
=
, 
where 
c
cT
ω
π /
2
=
.
b)	 The critical frequency is moved to the point 0.6/_-135° on the compensated Nyquist locus. 
Give the calculated values of K and 
d
T to do this assuming
0
=
α
and
d
i
T
T
4
=
c)	 The critical frequency is moved to the point 0.6/_-135° on the compensated Nyquist locus. 
Give the calculated values of K  and 
d
T  to do this assuming 
0
=
α
 and 
d
i
T
T
8
=
The phase shift of the plant frequency response is 
ω
ω
1
tan−
−
−
which gives -180° when 
03
.2
 
 
c
Z
Z
rads/s and the corresponding gain 
77
.1
)
03
.2
1(
4
|)
(
|
2
/
1
2
 

 
Z
j
G
 
so that
566
.0
77.1
/
1
=
=
c
K
. 
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
We will turn your CV into 
an opportunity of a lifetime
Do you like cars? Would you like to be a part of a successful brand?
We will appreciate and reward both your enthusiasm and talent.
Send us your CV. You will be surprised where it can take you.
Send us your CV on
www.employerforlife.com

Control Engineering Problems with Solutions
140 
Control System Design
(a ) Since 
10
.3
03
.2
/
2
/
2
 
 
 
S
Z
S
c
cT
 the Z-N parameters are K = 0.34, 
55
.1
 
iT
, and 
39
.0
 
d
T
. 
The controller transfer function is 
sT
T
T
s
T
T
s
T
T
s
K
s
G
i
d
i
d
i
d
i
c
]1
)
(
)
1(
[
)
(
2
2
 





 
D
D
D
 
s
s
s
s
55
.1
0605
.0
)1
59
.1
665
.0
(
34
.0
2
2



. 
For the resulting system the gain and phase margins are 3.85dB at 2.53rads/s and 63.2° at1.01 rads/s. 
The Matlab ‘feedback’ function cannot be used when a transfer function in it contains a delay. If desired 
approximate results can be obtained using this function and approximating any delay in a transfer function 
by its Pade approximation. Alternatively the system can be simulated in Simulink which gave a closed 
loop step response with an overshoot of 37% at 1.9s and a settling time of 9.2s.
(b) With 
0
=
α
and 
d
i
T
T
4
=
the transfer function of the controller is 
d
d
c
sT
sT
K
s
G
4
/
)
2
1(
)
(
2

 
and 
to satisfy the required phase condition of the design it must have a phase shift of 45° at 
c
ω . Thus 
d
cT
Z
2
tan
2
90
45
1



 
$
$
 giving 
414
.2
2
=
d
cT
ω
 so that 
5946
.0
=
d
T
. To satisfy the gain condition 
6.0
|)
(
||)
(
|
=
c
c
c
j
G
j
G
ω
ω
 which gives 
6.0
4
)
4
1(
566
.0
1
2
2
=
+
d
c
d
c
T
T
K
ω
ω
, yielding 
2401
.0
=
K
 after substituting 
for 
c
ω  and 
d
T . Taking K = 0.24,
59
.0
 
d
T
 and 
36
.2
 
iT
gives the controller transfer function 
s
s
s
s
s
Gc
36
.2
139
.0
)1
42
.2
531
.1(
24
.0
)
(
2
2



 
. The resulting system has gain and phase margins of 4.11dB at 2.77rads/s 
and 96.1° at 0.491 rads/s, respectively. The closed loop step response is oscillatory but has no overshoot 
and a settling time of 12s.
(c) With 
0
=
α
and 
d
i
T
T
8
=
 the transfer function of the controller is 
d
d
d
c
sT
T
s
sT
K
s
G
8
/)
8
8
1(
)
(
2
2


 
which gives 
d
d
d
c
T
j
T
T
j
K
j
G
ω
ω
ω
ω
8
/)
8
8
1(
)
(
2
2
−
+
=
 and as in (b) the numerator must provide 
a phase lead at the critical frequency of 135°, thus 
$
135
)]
8
1(,
8
[
tan
2
2
1
 


d
c
d
c
T
T
Z
Z
 which gives 
55
.0
 
d
T
 and 
4.4
=
iT
. The gain K = 0.24, as before, and the controller transfer function is 
s
s
s
s
s
Gc
40
.4
242
.0
)1
46
.4
68
.2
(
24
.0
)
(
2
2



 
. The resulting system has gain and phase margins of 4.27dB at 2.77rads/s 
and 116° at 0.35 rads/s, respectively. The closed loop step response is oscillatory but has no overshoot 
and a settling time of 26s.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
141 
Control System Design
Example 7.11 
A feedback system has a plant with a transfer function
)
1.0
1
)(
1(
/
1
)
(
s
s
s
s
G


 
 and H(s) = 1. It is 
required to design a controller Gc(s) so that the closed loop step response does not have an overshoot 
greater than 10%. Use the root locus approach to find the required controller gain if (a) Gc(s) = K and 
(b) 
)
1.0
1
/(
)
1(
)
(
s
s
K
s
Gc


 
. Obtain the closed loop step responses and comment on their relative 
behaviour.
Figure 7.8 shows the root locus plot using a gain range of 0-12 for case (a), where the complex roots 
cross the axis for K = 11, with an estimated gain value of 0.605 for around 10% overshoot. Since the 
real pole is still at approximately -10 its contribution to the closed loop step response is expected to 
be small. The closed loop step response has an overshoot of 9% at 5.2s and a settling time of 7.8s. For 
case (b) a difficulty in designing a phase lead compensator using the root locus is to have a strategy 
for choosing its zero and pole, and one simple method is the zero-pole cancellation used here. Again 
a point with damping around 0.6 for the complex poles is selected. A gain of 3.03 gives complex pole 
damping of 0.596 with an overshoot of 9.73%. The real part of the complex poles is around -2.7 and the 
real pole is at approximately -14.6 so its effect on the closed loop step response is again expected to be 
small. The closed loop step response has an overshoot of 9% at 0.93s and a settling time of 1.36s. The 
two step responses are quite similar but the speed of response is increased by a factor of more than five 
with the lead compensator.
Root Locus
Real Axis
Imaginary Axis
-12
-10
-8
-6
-4
-2
0
2
-4
-3
-2
-1
0
1
2
3
4
System: g
Gain: 0.605
Pole: -0.467 + 0.619i
Damping: 0.602
Overshoot (%): 9.34
Frequency (rad/sec): 0.775
Figure 7.8 Root locus plot.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
142 
Control System Design
Example 7.12 
A relay autotuning experiment was performed on a process, with a relay having an output of 
1
± , and 
the values obtained for the amplitude of the limit cycle and its frequency at the relay input were 0.64 
and 1.0 rads/s, respectively. It was decided to control the process with an ideal PID controller in the 
error channel and to select the controller parameters so that the integral time constant was four times 
the derivative time constant and the frequency of 1.0 rads/s occurred at a gain of 0.5 and a phase of 
-150° on the compensated Nyquist locus. What are the required values for the controller gain and 
derivative time constant.
The gain through the relay for the limit cycle is 
5.0
5027
.0
64
.0
/
4
/
4
|
 
 
S
S
a
h
which is the estimate 
from DF analysis for the critical gain,
c
K . Now 
)
(
c
c
c
j
G
K
ω
 must have a gain of 0.5, thus 
1
|)
(
|
=
c
c j
G
ω
, 
and a phase shift of 
$
$
$
30
150
180
 

. Now 
i
i
d
i
d
i
c
sT
sT
T
T
s
K
sT
sT
K
s
G
)1
(
)
1
1(
)
(
2
 


 


 
d
d
sT
sT
K
4
)
2
1(
2

with 
d
i
T
T
4
=
, therefore 
$
$
30
2
tan
2
90
1
 



d
cT
Z
giving 
$
60
2
tan 1
 

d
cT
Z
 so that 
3
2
=
d
cT
ω
 and on substituting for 
c
ω  gives 
866
.0
=
d
T
. Now 
3
2
)
3
1(
4
)
4
1(
|)
(
|
2
2
K
T
T
K
j
G
d
c
d
c
c
c
+
=
+
=
ω
ω
ω
 
3
2K
=
 
which equals unity for K = 0.866.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
AXA Global 
Graduate Program
Find out more and apply

Control Engineering Problems with Solutions
143 
Control System Design
Example 7.13
Here the use of state feedback control is considered to improve the control of the plant transfer function 
given in Example 7.4, where it was seen that problems arose with a series compensator design when the 
plant parameters varied. The simulink diagram for the transfer function is given in Figure 7.9, where 
it is assumed that the states are the output of the integrators and that feedback is only possible to the 
plant input. The Gain and Gain1 blocks show the nominal value of unity for 
o
ω and the Gain3 block 
is 
o
]Z
2
with the nominal value of 
1.0
=
ζ
entered. The resulting system, as in Example 4, is required 
to have zero steady state error to a step input. {NOTE:- If the physical structure of the plant had the 
integrator after the second order dynamics the design would be easier as no feedback need be used 
around it and the integrator would ensure zero steady state error to a step input. The same reasoning 
would apply for the situation of Figure 7.9 if it were possible to feedback into the plant at the output of 
the block labelled Integrator2.}
1
Out1
1
s
Integrator2
1
s
Integrator1
1
s
Integrator
0.2
Gain3
0.5
Gain2
1
Gain1
1
Gain
1
In1
Figure 7.9 Simulink model of state variable representation.
The state space description for the plant is 
¸
¸
¸
¹
·
¨
¨
¨
©
§


 
0
0
0
2
0
0
o
o
o
o
A
Z
]Z
Z
Z
, 










=
1
0
0
B
 
and 
(
)
0
0
1
=
C
, D = 0. {NOTE the A matrix is singular}. 
Assuming the feedback is such that 
(
)










−
=
1
0
0
5.0
5.0
3
2
1
k
k
k
r
u
, then the new A matrix is 
¸
¸
¸
¹
·
¨
¨
¨
©
§




 
3
2
1
5.0
5.0
5.0
2
0
0
k
k
k
A
o
o
o
o
f
Z
]Z
Z
Z
, which leads to 
¸
¸
¸
¹
·
¨
¨
¨
©
§




 

3
2
1
5.0
5.0
5.0
2
0
k
s
k
k
s
s
A
sI
o
o
o
o
f
Z
]Z
Z
Z
 
and the characteristic 
equation 
0
)
(
5.0
)
5.0
(
)
5.0
2
(
|
|
3
1
2
2
2
3
3
2
3
 







 

k
k
k
k
s
k
s
s
A
sI
o
o
o
o
o
Z
Z
Z
]Z
]Z
.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
144 
Control System Design
A transfer function with an integration term is required in front of the plant to produce a zero steady 
state error to a step input, so if this is chosen as 
s
s
/)1
( +
 and the feedback gains are chosen to place 
the three poles of the characteristic equation at -1, then the nominal forward path transfer function is 
2)1
(
5.0
+
s
s
 
which is in agreement with the design using the series compensator in Example 7.4. The resulting 
system is shown in Figure 7.10 with the simulation of the nominal transfer function in parallel, which 
allows one to check that the feedback gains have been correctly calculated and also to compare results 
with those of the nominal system when the plant parameters are varied. The required gain values are:- 
6.3
1
−
=
k
, 
88
.2
2  
k
 and 
6.5
3 =
k
. 
0.5
den(s)
Transfer Fcn2
s+1
s
Transfer Fcn1
s+1
s
Transfer Fcn
Step
Scope3
Scope2
Scope1
Scope
1
s
Integrator2
1
s
Integrator1
1
s
Integrator
-K-
Gain6
-K-
Gain5
5.6
Gain4
0.2
Gain3
0.5
Gain2
1
Gain1
1
Gain
Add
Figure 7.10 State feedback design.
Using the same parameter variations as Example 7.4 the step response results, equivalent to Table 7.4, 
are given below in Table 7.6 obtained using the Simulink model of Figure7.10
Res. frequency
Damping factor
Overshoot
Settling time
1.0
0.1
25% at 6.5s
19s
1.0
0.05
26 at 6.0s
23s
0.8
0.1
39% at 7.0s
37s
0.8
0.05
41% at 7.0s
39s
1.2
0.1
24 % at 7.0s
27s
1.2
0.05
25% at 6.5s
22s
Table 7.6 Summary of step response results.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
145 
Control System Design
It can be seen from Table 7.6 that the step responses are not now as sensitive to the parameter changes 
and the system remains stable for 
8.0
=
o
ω
 and 
05
.0
 
]
. Indeed for this value of damping factor the 
system will remain stable until the resonant frequency is less than half the nominal value. This is expected 
due to the ability of the three feedback gains to change the three roots of the characteristic equation.
Example 7.14
A system has a state space description of 






−
−
=
2
6
3
7
A
, 






= 1
2
B
, 
(
)
0
1
=
C
, D = 0. Calculate the required 
feedback gains to move both poles to -2 by (i) by direct calculation and (ii) by first transforming the 
system to the controllable canonical form.
(i) For the given system 
¸¸
¹
·
¨¨
©
§



 

2
6
3
7
s
s
A
sI
, therefore 
)
4
)(
1
(
4
5
2


 


 

s
s
s
s
A
sI
 and 
the poles are at -1 and -4, respectively.
For the state feedback 
T
Bk
r
u

 
, where 
(
)
2
1
k
k
k T =
 the new A matrix is 


¸¸
¹
·
¨¨
©
§






 
¸¸
¹
·
¨¨
©
§

¸¸
¹
·
¨¨
©
§


 

 
2
1
2
1
2
1
2
6
2
3
2
7
1
2
2
6
3
7
k
k
k
k
k
k
Bk
A
A
T
f
.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
ibili
because 
e Graduate Programme  
for Engineers and Geoscientists
Month 16
I was a construction
supervisor in 
the North Sea 
advising and 
helping foremen 
solve problems
I was a
he
s
Real work 
International opportunities 

ree work placements
al 
Internationa
or

ree wo
I wanted real responsibili 
 I joined MITAS because 
www.discovermitas.com

Control Engineering Problems with Solutions
146 
Control System Design
Thus 
1
2
2
1
2
2
1
2
1
5
4
)
2
5
(
2
6
2
3
2
7
k
k
s
k
k
s
k
s
k
k
k
s
A
sI






 







 

.
For both poles to be at -2, the characteristic equation must be 
0
4
4
2
=
+
+ s
s
 so that the values of the 
gains must satisfy
4
2
5
2
1
=
+
+
k
k
 and 
4
5
4
1
2
=
−
−
k
k
, which has the solution 
(
)
9
/
1
9
/
5
−
=
k
.
(ii) The system is controllable as 

¸¸
¹
·
¨¨
©
§


 
10
1
11
2
AB
B
 is not singular.
To transform to controllable canonical form we have
2t
B =
, 
2
0
1
t
a
At

 
 and 
2
1
1
2
t
a
t
At

 
, where 
4
1
0
=
= a
a
, of which we only need to use two.
Thus using the first two relationships 






= 1
2
2t
 , 






−
−
=






−
−






−
−
=
−
5
1
4
8
2
6
3
7
1
1t
, so that 






−
−
=
1
5
2
1
T
, 






−
−
=
−
9
/
1
9
/
5
9
/
2
9
/
1
1
T
 , 






=












−
−
=
−
1
0
1
2
9
/
1
9
/
5
9
/
2
9
/
1
1B
T
, as required, and 


1
5
2
1
0
1
 
¸¸
¹
·
¨¨
©
§


 
CT
 


2
1

. For the state feedback 
T
c
Bk
r
u

 
, where 
(
)
c
c
T
c
k
k
k
2
1
=
 the new A matrix is 


¸¸
¹
·
¨¨
©
§




 
¸¸
¹
·
¨¨
©
§

¸¸
¹
·
¨¨
©
§


 

 
c
c
c
c
T
c
c
c
fc
k
k
k
k
k
B
A
A
2
1
2
1
5
4
1
0
1
0
5
4
1
0
 
with 
the 
characteristic 
equation 
0
4
)
5
(
1
2
2
=
+
+
+
+
c
c
k
s
k
s
 so that 
0
1 =
c
k
 and 
1
2
−
=
c
k
.
Since 
c
Tx
x  
 where x is the original state vector and 
cx that for the controllable canonical form, then 
the feedback 
kx
x
T
k
x
k
c
c
c
 
 
1
, where 
1
−
=
T
k
k
c
, thus 
(
)
(
)
9
/
1
9
/
5
9
/
1
9
/
5
9
/
2
9
/
1
1
0
−
=






−
−
=
k
 
, 
as before.
Example 7.15
A system has a state space description 
¸
¸
¸
¹
·
¨
¨
¨
©
§






 
8
17
16
10
17
15
8
16
15
A
,










−
=
1
1
1
B
,
(
)1
0
1
=
C
 and D = 0. Determine 
the transfer function of the system. Find the eigenvalues of A and the transformation matrix T to put 
the system into the controllable canonical form, where 
AT
T
Ac
1

 
. Use this value of T to obtain the 
controllable canonical form 
c
c
c
c
D
C
B
A
,
,
,
and confirm that this agrees with the transfer function. 
Determine the required feedback gains for the system A, B, C, D to have all its poles at -1 and the 
corresponding input-output transfer function.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
147 
Control System Design
For the transformation to controllable canonical form B = t3, At1 =–a0t3 and At2 = t1–a1t3.
From Matlab after entering the system state space description and the command G = ss
)
,
,
,
(
D
C
B
A
then the command 
)
(G
tf
 yields the transfer function 
6
11
6
3
2
2
2
3
2





s
s
s
s
s
. Entering 
)
(A
eig
gives the 
eigenvalues of A as, -1,-2 and -3, so that the characteristic equation is 
0
6
11
6
2
3
 



s
s
s
 giving 
6
0 =
a
 , 
11
1  
a
 and 
6
2 =
a
, and in addition 










−
−
−
−
−
=
−
5.2
1667
.0
8333
.2
5
3333
.1
6667
.6
4
3333
.1
6667
.5
1
A
 so that 










−
=
=
−
1
2
2
6
3
1
1
t
A
t
 and 
¸
¸
¸
¹
·
¨
¨
¨
©
§


 

 


1
2
1
11
3
1
1
1
2
t
A
t
A
t
. 
Thus 










−
−
−
−
=
1
1
1
1
2
2
1
1
2
T
, 










−
=
−
2
1
0
0
1
1
1
0
1
1
T
and 
¸
¸
¸
¹
·
¨
¨
¨
©
§



 
 

6
11
6
1
0
0
0
1
0
1
c
A
AT
T
 
as expected. 
Further 










=
=
−
1
0
0
1B
T
Bc
 , 


2
2
3

 
 CT
Cc
 and
0
=
= D
Dc
 as expected to yield the known 
transfer function for G. The required characteristic equation after feedback is 
0
1
3
3 2
3
=
+
+
+
s
s
s
 
so that the required feedback gains for the controllable canonical form are given from 
1
6
1 =
+
c
k
, 
3
11
2  

c
k
and
3
6
2 =
+
c
k
 so that 
(
)
3
8
5
−
−
−
=
T
ck
. Thus the feedback required from the states 
of A, B, C, D is 



1
11
13
2
1
0
0
1
1
1
0
1
3
8
5
1



 
¸
¸
¸
¹
·
¨
¨
¨
©
§




 

T
k T
c
. The corresponding input-output transfer 
function is 
3
2
)1
(
3
2
2
+
+
−
s
s
s
 .
{Note:- Pole placement can be done directly in Matlab using the expression 
)
,
,
(
p
B
A
place
k =
where  
p is the vector of the required pole locations. However, the algorithm does not work when the multiplicity 
of a pole in p is greater than the rank of B. A simple check can obviously be made by putting all three 
poles near to -1, so choosing 
]
99
.0
,
01
.1
,1
[



 
p
gives 
]
9999
.0
,
0001
.
11
,
0002
.
13
[



 
k
which 
on rounding gives the solution given above.}
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
148 
Control System Design
7.3	
Problems
Problem 7.1 
A feedback system has 
)
16
4
(
/
32
)
(
2


 
s
s
s
s
G
 and H(s) = 1. It is required to design a controller 
keeping the same velocity constant, that is 2, so that the system has a step response with an overshoot 
no greater than 5%. 
[ [
s
s
s
Gc
1.0
1
25
.0
1
)
(


 
 
(phase lead) in feedback path gives 5% overshoot and settling time of 3.7s or 
s
s
s
Gc
5.
21
1
10
1
)
(


 
 (phase lag) in forward path gives 4% overshoot and settling time of 14s.]
Problem 7.2 
A plant has a transfer function of 
)
2
)(
4
/(
4
)
(
2
2
2
o
o
o
s
s
s
s
G
Z
Z
]
Z



 
with the parameters ζ and 
o
ω estimated as 0.1 and 1.0, respectively. It is therefore decided to design a controller with zeros to cancel 
the poles and since no steady state error is required for a step input the controller transfer function is 
taken as 
)1
(
/)1
2.0
(
)
(
2
+
+
+
=
s
s
s
s
s
Gc
. Determine the gain and phase margins of the compensated 
system and obtain the closed loop step response giving the % overshoot and settling time. There is 
concern about the value of the plant parameters so the behaviour of the system is examined for (i) a 
10% reduction inζ and (ii) a 10% reduction in 
o
ω . Discuss your results. 
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
MASTER IN MANAGEMENT
mim.admissions@ie.edu
Follow us on IE MIM Experience
www.ie.edu/master-management
#10 WORLDWIDE
MASTER IN MANAGEMENT 
FINANCIAL TIMES
55 Nationalities
in class
5 Specializations
Personalize your program 
Length: 1O MONTHS
Av. Experience: 1 YEAR
Language: ENGLISH / SPANISH
Format: FULL-TIME
Intakes: SEPT / FEB
• STUDY IN THE CENTER OF MADRID AND TAKE ADVANTAGE OF THE UNIQUE OPPORTUNITIES
  THAT THE CAPITAL OF SPAIN OFFERS
• PROPEL YOUR EDUCATION BY EARNING A DOUBLE DEGREE THAT BEST SUITS YOUR
  PROFESSIONAL GOALS
• STUDY A SEMESTER ABROAD AND BECOME A GLOBAL CITIZEN WITH THE BEYOND BORDERS
  EXPERIENCE
93%
OF MIM STUDENTS ARE
WORKING IN THEIR SECTOR 3 MONTHS
FOLLOWING GRADUATION

Control Engineering Problems with Solutions
149 
Control System Design
[Gain and phase margins 14dB at 2.0 rads/s and 41.2° at 0.776 rads/s. 28% overshoot at 3.81s and a 
settling time of 11.4s. (i) Effect relatively small (ii) The closed loop system is unstable with gain and 
phase margins of -1.79dB at 0.872 rads/s and -13.7° at 0.907 rads/s]
Problem 7.3 
A process has a transfer function of 
)
1.0
1
)(
5.0
1
)(
1
/(
2
)
(
s
s
s
s
G



 
 which is to be controlled in 
a 
feedback 
loop 
with 
H(s) 
= 
1 
and 
a 
PID 
controller 
with 
transfer 
function
)}
1
/
(
)
/
1(
1
{
)
(
d
d
i
c
sT
sT
sT
K
s
G
D



 
, with 
1.0
=
α
 What are the critical gain,
c
K , and frequency,
c
ω , of the plant? It is required to achieve a set point step response with an overshoot of no more than 
16% and a settling time of 2 seconds. What are the results from the following two design approaches? 
a)	 Use of the Ziegler - Nichols tuning parameters, 
c
K
K
6.0
=
, 
c
i
T
T
5.0
=
and 
c
d
T
T
125
.0
=
, 
where 
c
cT
ω
π /
2
=
.
b)	 The critical frequency is moved to the point 0.6/_-125° on the compensated Nyquist locus. 
Give the calculated values of Kand 
d
T to do this assuming 
0
=
α
 and 
d
i
T
T
4
=
. 
[
9.9
=
c
K
 and 
66
.5
 
c
Z
.  (a) Gain and phase margins of 22.2dB at 20.4rads/s and 24.4° at 4.54 rads/s. 
Step response overshoot of 55% at 0.65s and a settling time of 3.6s. (b) Gain and phase margins of 20.3dB 
at 18.5rads/s and 57.2° at 3.95 rads/s. Step response with an overshoot of 13% at 0.69s and a settling 
time of 1.4s.- meets specifications.]
Problem 7.4 
A plant has a transfer function 
)
4
)(
1
(
/
16
)
(


 
s
s
s
s
G
 and is to be controlled in a loop with unit 
negative feedback by the compensator 
)
1
/(
)
1(
)
(
T
s
sT
s
Gc
D


 
, with
1.0
>
α
.The speed of the 
response to a step input is not critical but a major requirement is that the overshoot should not exceed 
10%, determine suitable values for α and T.
[
1
1.0
1
)
(
+
+
=
s
s
s
Gc
(lead) in feedback path, no overshoot and a settling time of 4.1s. 
1
340
1
34
)
(


 
s
s
s
Gc
 
(lag) in forward path11% overshoot at 7.6s and settling time of around 40s.]
Problem 7.5 
A feedback system has a plant with a transfer function 
)
1.0
1
)(
4.0
1(
/
4
)
(
s
s
s
s
G


 
 and H(s) = 1. 
Design phase lead and phase lag compensators to give the feedback loop a phase margin of around 45°. 
Obtain the closed loop step responses for the two designs with the compensator in the error channel 
and also for the phase lead design with the compensator in the feedback path. 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
150 
Control System Design
[Lead 
1
15
.0
1
45
.0
)
(


 
s
s
s
Gc
 , Step responses:- error channel 24% overshoot settling time 2.3s, feedback path 
no overshoot settling time 2.0s. Lag 
1
6.
14
1
6.6
)
(


 
s
s
s
Gc
gives step response overshoot 24% and settling 
time 6.7s]
Problem 7.6 
A process with a transfer function of 
2
3.0
)
4.0
1
/(
2
)
(
s
e
s
G
s

 

 is to be controlled in a feedback loop 
with H(s) = 1 and a PI controller with transfer function 
)}
/
1(
1
{
)
(
i
c
sT
K
s
G

 
. What are the critical 
gain,
c
K , and frequency,
c
ω , of the plant? What are the results from the following two design approaches 
for the closed loop step response? 
a)	 Use of the Ziegler – Nichols tuning parameters,
c
K
K
45
.0
 
 and 
c
i
T
T
8.0
=
, where 
c
cT
ω
π /
2
=
.
b)	 The PI controller should give a phase lag of 15° and the open loop gain of the compensated 
frequency response should be 
c
K
/
7.0
at the critical frequency 
c
ω . 
[
68
.1
 
c
K
 and 
84
.3
 
c
Z
. (a) 
74
.0
 
K
 and 
31
.1
 
iT
, 19% overshoot at 1.4s and settling time 
5.3s. (b) 
68
.0
 
K
 and 
97
.0
 
iT
, 26% overshoot at 1.5s and settling time 5.3s.]
Problem 7.7 
A feedback system has a plant with a transfer function 
2)
1(
/
1
)
(
s
s
s
G
+
=
. Show that in a feedback 
loop with unit negative feedback gain it will have a phase margin of 21.4° at the frequency 0.682rads/s. 
Design a phase lag controller with unit gain at zero frequency to give a phase margin for the system of 
around 45° and give details of the resultant closed loop step response. 
[
1
60
1
20
)
(


 
s
s
s
Gc
 
gives a phase margin of 46.7°, step response overshoot of 24% at 7.5s and settling 
time 32s.]
Problem 7.8 
A feedback system has a plant with a transfer function 
2)
5.0
1(
/
1
)
(
s
s
s
G
+
=
. Show that in a feedback 
loop with unit negative feedback gain it will have a phase margin of 21.4° at the frequency 1.365rads/s. 
Design phase lag controllers with unit gain at zero frequency, by both frequency response and root locus 
methods, to achieve a closed loop system step response with an overshoot no greater than 10%.
[
1
60
1
20
)
(


 
s
s
s
Gc
 
gives 8% overshoot and settling time of 35s]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
151 
Control System Design
Problem 7.9 
A relay autotuning experiment was performed on a process and the values obtained for the critical gain 
and critical frequency were 2.0 and 1.0 rads/s, respectively. It was decided to control the process with 
an ideal PID controller in the error channel and to select the controller parameters so that the integral 
time constant was four times the derivative time constant and the frequency of 1.0 rads/s occurred at 
a gain of 0.5 and a phase of -150° on the compensated Nyquist locus. What are the required values for 
the controller gain and derivative time constant.
[
866
.0
=
K
 and 
866
.0
=
d
T
]
Problem 7.10 
A relay autotuning experiment was performed on a process and the values obtained for the critical gain 
and critical frequency were 1.8 and 1.0 rads/s, respectively. It was decided to control the process with 
an ideal PID controller in the error channel and to select the controller parameters so that the integral 
time constant was four times the derivative time constant and the frequency of 1.0 rads/s occurred at a 
gain of 0.55 and a phase of -150° on the compensated Nyquist locus. What are the required values for 
the controller gain and derivative time constant.
[
86
.0
 
K
 and 
866
.0
=
d
T
]
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Control Engineering Problems with Solutions
152 
Control System Design
Problem 7.11 
A process with a transfer function of 
3)
1
/(
2
)
(
s
s
G

 
is to be controlled in a feedback loop with 
H(s) = 1and a PI controller with transfer function 
)}
/
1(
1
{
)
(
i
c
sT
K
s
G

 
. What are the critical gain,
c
K , and frequency,
c
ω , of the plant? Determine the parameters of the PI controller if it is designed to:- 
a)	 Use the Ziegler – Nichols tuning parameters, 
c
K
K
45
.0
 
 and 
c
i
T
T
8.0
=
, where 
c
cT
ω
π /
2
=
.
b)	 To move the critical point to a gain of 0.4 and phase -192° on the compensated Nyquist 
locus. 
c)	 A zero of the compensator is used to cancel a pole of the process transfer function and the 
gain margin is adjusted to 12dB.
Compare the closed loop step responses of the three designs.
[
0.4
=
c
K
 and 
732
.1
=
c
ω
. (i) 
80
.1
 
K
 and 
90
.2
 
iT
. 57% overshoot, settling time 33s (ii) 
56
.1
 
K
 and 
71
.2
 
iT
. 52% overshoot, settling time 27s (iii) 
25
.0
 
K
 and 
0.1
=
iT
. 25% 
overshoot, settling time 20s]
Problem 7.12 
A feedback system has a plant with a transfer function 
)
1.0
1
)(
1(
/
4
)
(
s
s
s
s
G


 
 and
1
)
(
=
s
H
. 
Design a phase lead compensator using pole zero cancellation and with unit gain at zero frequency to 
give a phase margin of around 50°. Also design a phase lag compensator, again with unit gain at low 
frequency, to achieve the same phase margin. Obtain the closed loop step responses for the two designs 
with the compensator in the error channel and also for the phase lead design with the compensator in 
the feedback path.
[
1
1.0
1
)
(
+
+
=
s
s
s
Gc
 gives a phase margin of 50.9°. Step response in error channel 17% overshoot and 1.7s 
settling time and in feedback path no overshoot and settling time 4s. 
1
96
1
16
)
(


 
s
s
s
Gc
 gives a phase 
margin of 51.5°. Step response 20% overshoot and settling time 25s.]
Problem 7.13 
Show that for an ideal PID controller, 
}
)
/
1(
1
{
)
(
d
i
c
sT
sT
K
s
G


 
, placed in the error channel and 
controlling a plant with transfer function G(s) that, if the design strategy is to place the critical frequency 
of the plant at a point 

135
/_ −
g
on the compensated frequency response locus, then the PID controller 
gain will be independent of the choice of the ratio 
d
i T
T /
.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
153 
Control System Design
Problem 7.14 
A system has a state space description 
¸
¸
¸
¹
·
¨
¨
¨
©
§





 
59
87
103
0
1
1
30
45
53
A
,









−
=
2
0
1
B
,
(
)
4
5
8
=
C
 and D = 0. 
Determine the transfer function of the system. Find the eigenvalues of A and the transformation matrixT  
to put the system into the controllable canonical form, where 
AT
T
Ac
1

 
. Use this value of T to obtain 
the controllable canonical form 
c
c
c
c
D
C
B
A
,
,
,
and confirm that this agrees with the transfer function. 
Determine the required feedback gains for the system A, B, C, D to have its poles at -2, -2.5 and -3 and 
the corresponding input-output transfer function. Why is the transfer function second order?
[Transfer function is 
8
14
7
3
2
3




s
s
s
s
, Eigenvalues are -1,-2 and -4. 










−
−
−
=
2
1
0
0
1
1
1
0
1
T
and transfer 
function is 
5
5.4
1
2
+
+
s
s
. Pole – zero cancellation.]
Problem 7.15 
A system has a state space description 










−
−
−
−
−
=
1
1
2
4
1
2
0
5.0
2
A
,










=
1
0
1
B
,
(
)1
5.0
1
−
−
=
C
 and D = 0. Determine the 
transfer function of the system and the eigenvalues of A. Find the required feedback gains for the system 
to have its poles at -1, -2 and -3 and the corresponding input-output transfer function. 
[Transfer function is 
1
2
2
1
2
3
+
+
+
s
s
s
, Eigenvalues are -1, and -0.5±0.66j. Gain vector (14,-0.5,-10) and 
transfer function is 
6
11
6
1
2
3



s
s
s
.]
Problem 7.16 
Design the controller for Problem 7.2 by first modifying the plant transfer function with state variable 
feedback so that its poles are at -1, -2 and -3. Then close the loop so that the error, the difference between 
the input R and plant output, is fed through the transfer function 
s
s
/)1
( +
to the modified plant input. 
What is the required feedback gain vector? Compare the closed loop step responses with those of problem 
P7.2 and show that they are less sensitive to plant parameter variations than the design of problem P 7.2.
[Gain vector is (0.5, 2.3, 0.45)]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
154 
Phase Plane Analysis
8	 Phase Plane Analysis
8.1	
Introduction
Phase plane analysis is a method which can be useful in the study of second order nonlinear systems 
and is covered in chapter 2 of reference 2. A second order system has two states and its motion can be 
shown by plotting one state against the other with time a parameter on the locus, known as a trajectory. 
When the second state is the derivative of the first state, typically the output, the state variables are known 
as phase variables, and the trajectory motion is in a phase plane. The method was originally used by 
physicists but was found particularly useful in the early days of control engineering because of the ease 
with which it could be applied to nonlinear second order systems, typically position control systems or 
servomechanisms as they were often called, where the nonlinearities were described by linear segmented 
characteristics. It has the advantage that it can be applied when the feedback loop contains more than 
one nonlinear element. Several phase plane examples, relating to the determination of oscillations or 
step responses, are given in this section. 
8.2	
Examples
Example 8.1
Figure 8.1 shows the block diagram of a second order system where NL1 is an on off relay with 
hysteresis having switching levels 
1
±
=
∆
 and output levels 
1
±
=
h
 and NL2 is 
3
bx . Derive the 
equations which can be used to determine the limit cycle in the system with R = 0 and find its 
phase plane coordinates at the switching times and its frequency if 
1
=
= K
a
 and 
5.0
=
b
. 
Compare the solution with simulation results.
C
  _
NL1
1/s
K/(s+a)
NL2
+
+
  _
R
  _
v
x
Figure 8.1 Block diagram for Example 8.1
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
155 
Phase Plane Analysis
The transfer function
)
(
/
a
s
s
K
+
 has inputs from NL1 of 
1
± . Denote its output as x and its 
derivative (the input to NL2) as v. The input to NL1 will be 
3
bv
x 

and assuming this is positive 
and greater than 1 it will produce a positive output from NL1 until 
1
3

 


bv
x
, that is until 
the curve 
1
3  
 bv
x
 in the phase plane is reached by the trajectory. The differential equation 
for x when the output from NL1 is 1
+  is 
K
x
a
x
=
+


 which to obtain the solution can be written 
in Laplace transform form as 
s
K
x
s
sX
a
x
sx
s
X
s
/
)}
0
(
)
(
{
)
0
(
)
0
(
)
(
2
 





, which can be 
written 
as 
s
x
a
s
s
v
a
s
s
K
s
X
)
0
(
)
(
)
0
(
)
(
)
(
2
+
+
+
+
=
 
and 
on 
inverting 
gives 
the 
solution
)
0
(
)
0
(
)
0
(
)
(
2
2
x
a
e
v
a
v
a
Ke
a
K
a
Kt
t
x
at
at





 


 and by differentiation the expression for its derivative 
is 
at
at
e
v
a
Ke
a
K
t
v




 
)
0
(
)
(
. The equation for a phase plane trajectory for an output of +1 from 
NL1 can 
be 
obtained 
by 
eliminating 
t 
from 
these 
equations 
and 
is
}
)
(
)
0
(
{
log
)
0
(
)
(
)
0
(
)
(
2
K
t
av
K
av
a
K
a
v
t
v
x
t
x
e





 
. This is not a simple curve and the limit cycle can be 
found as easily using the equations for v(t) and x(t), since the limit cycle will be symmetrical 
with two trajectory arcs one for the output of NL1 equal to +1,described by the above equations, 
and the other for the output of NL1 equal to –1. Thus if we assume that for NL1 equal to +1 the 
trajectory starts after switching at the point 
)
,
(
1
1
v
x −
−
in the phase plane it will finish, by 
symmetry, at the point 
)
,
(
1
1 v
x
, where the output of NL1 switches to –1. {Note this concept can 
be used to obtain limit cycles in relay systems for higher order systems and is inherent in the 
time domain method of Hamel and the state space formulation of Chung (reference 8.1) used 
more recently in reference 8.2}. Thus putting these initial and final conditions into the above 
equations gives 
1
1
1
2
2
1
x
a
e
v
a
v
a
Ke
a
K
a
Kt
x
at
at





 


 
and 
at
at
e
v
a
Ke
a
K
v




 
1
1
. Further the point 
)
,
(
1
1 v
x
lies on the curve 
1
3  
 bv
x
 so that 
1
3
1
1
 
 bv
x
. These three equations allow solutions 
to be obtained for the three unknowns x1, v1 and t, when a, band Kare given.
Thus for 
1
=
= K
a
 and 
5.0
=
b
the three equations are:-
t
t
e
v
v
e
t
x
−
−
+
−
+
−
=
1
1
1
1
2
; 
t
t
e
v
e
v
−
−−
−
=
1
1
1
; and 
1
5.0
3
1
1
=
+
v
x
.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
156 
Phase Plane Analysis
Solving these using fminsearch in Matlab gives x1 = 0.622, v1 = 0.911 and t = 3.066. The period of the 
limit cycle is thus 6.13 seconds which corresponds to a fundamental frequency of 1.03 rads/s. The solution 
in simulink for an initial condition on the output, C, of +1 is shown in figure 8.2, which confirms the 
values calculated for x1 and v1, and additional measurements confirm the period.
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
x
v
Figure 8.2 Simulink solution for the limit cycle.
Example 8.2
Consider the system shown in the block diagram of figure 8.3 in which the nonlinearity NL1 is 
a relay with dead zone with output values of 
1
± and switching levels of 1
± . Find the required 
value of b in terms of K and a for the step response not to have an overshoot.
C
  _
NL1
1/s
K/(s+a)
b
+
+
  _
R
  _
v
x
Figure 8.3 Block diagram for example 8.2
Again denoting the output by x and its derivative by v, then for a large step input the maximum 
value of v is K/a, which is typically studied in the phase plane by assuming a large negative 
initial value for x. The output of NL1 switches to zero when 
1
 


bv
x
 so that the response is 
then described by the above equations in example 8.1 with K = 0. From these it is easy to see 
that 
1
1
)
(
)
(
ax
t
v
v
t
ax


 
 which describes a straight line of slope –a in the phase plane. Thus 
for this final motion with no relay output to reach the origin the initial conditions must satisfy 
1
1
ax
v

 
. For a large step input 
a
K
v
/
1 =
 and since the initial value points lie on the switching 
line 
1
1
1
 


bv
x
 elimination of x1 and v1  between these equations gives 
2
)
1(
a
ab
K
 

which 
can be written as 
Ka
a
K
b
/)
(
2

 
. For a finite value of b then 
2
a
K >
. 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
157 
Phase Plane Analysis
Thus if there is no feedback b, that is b = 0, there will be no overshoot for a large step input provided 
2
a
K <
 and the response for a negative initial condition 
0x
−
on the output C will come to rest with 
the output between -1 and zero, reaching zero for a large value of 
0x  if 
2
a
K =
. For 
2
a
K >
there will 
be an overshoot for large 
0x until 
2
2a
K =
when the overshoot will be 1 and a further switch of the 
relay will take place for 
2
2a
K >
. 
Introducing a finite b will prohibit overshoots for large values of 
0x  for larger values of K. For example, 
to avoid overshoots for large values of 
0x  for a = 1 and K = 10 requires b = 0.9 and for a = 2 and 
K = 10 requires b = 0.3.
Example 8.3
A second order conservative nonlinear system is described by the differential equation 
0
)
(
=
+
x
n
x
where 
)
(x
n
is a nonlinearity. Obtain a solution for the period of the undamped oscillation in terms of 
the initial value for x of 
0x
−
. Calculate the value of this period for
1
0
−
=
x
 and 
5.1
0
−
=
x
 for the 
nonlinearities (i) 
x
x
n
=
)
(
, (ii) 
3
)
(
x
x
n
=
and (iii) 
x
x
n
sin
)
(
=
. 
Denoting the derivative of x by v the phase plane differential relationship is 
)
(
/
x
n
dx
vdv

 
, which 
assuming initial values of 
0x
−
 and 
0v  gives 
³


 

x
x
dx
x
n
v
v
0
)
(
2
2
0
2
, which can be written as 
)}
(
)
(
{
2
0
2
0
2
x
F
x
F
v
v


 

 
where 
³
 
x
dx
x
n
x
F
0
)
(
)
(
. 
Writing 
dt
dx
v
/
 
gives 
)}]
(
)
(
{
2
[
0
2
0
x
F
x
F
v
dt
dx



 
 which can be integrated wrt x from 
0x
−
to 0 with 
0
0 =
v
 to give a 
quarter cycle of the oscillation. Thus the period 
³



 
0
2
/
1
0
0
)}]
(
)
(
{
2
[
4
x
x
F
x
F
dx
T
. 
a)	 For 
x
x
n
=
)
(
the linear case one has
³
³
 
 
 
x
x
x
xdx
dx
x
n
x
F
0
2
0
2
/
)
(
)
(
, so that 
³


 
0
2
/
1
2
2
0
0
)}]
2
/
(
)
2
/
{(
2
[
4
x
x
x
dx
T
, which since the integrand has even symmetry can be 
written 
³

 
0
0
2
/
1
2
2
0
)
(
4
x
x
x
dx
T
. This gives the well known result that
π
π
2
)
2
/
(
*
4
|)
/
(
sin
4
0
0
0
1
=
=
=
−
x
x
x
T
, which is independent of the initial condition.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
158 
Phase Plane Analysis
b)	 For 
3
)
(
x
x
n
=
 one has 
³
³
 
 
 
x
x
x
dx
x
dx
x
n
x
F
0
4
3
0
4
/
)
(
)
(
, so that 
³

 
0
0
2
/
1
4
4
0
)}]
2
/
(
)
2
/
[(
4
x
x
x
dx
T
, for which no analytical solution is known. The integral 
depends on the initial condition 
0x
−
 and can be found numerically in Matlab using the 
numerical integration routine ‘quad’. For initial conditions of 1 and 2 the values of T are 7.42 
and 3.61, respectively. They can also be checked by simulation. Figure 8.4 shows the 
Simulink phase plane plots for several different values of 
0x . 
-4
-3
-2
-1
0
1
2
3
4
-15
-10
-5
0
5
10
15
x
y
Figure 8.4 Phase plane plots for cubic nonlinearity
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
“The perfect start 
of a successful, 
international career.”
CLICK HERE 
to discover why both socially 
and academically the University 
of Groningen is one of the best 
places for a student to be 
www.rug.nl/feb/education
Excellent Economics and Business programmes at:

Control Engineering Problems with Solutions
159 
Phase Plane Analysis
c)	  For 
x
x
n
sin
)
(
=
 one has, 
³
³

 
 
 
x
x
x
xdx
dx
x
n
x
F
0
0
cos
sin
)
(
)
(
 so that 
³

 
0
0
2
/
1
0)}]
cos
(cos
2
[
4
x
x
x
dx
T
, for which again no analytical solution is known. The integral 
again also depends on the initial condition 
0x
−
 and can be found numerically in Matlab 
using the numerical integration routine ‘quad’. In this case since 
0
sin
=
x
 for, 
π
n
x =
 there 
are multiple singular points and those for 
π
±
=
x
are saddle points, so that oscillations 
around the origin do not exist for
π
>|
|
0x
. The period of the oscillations increases as 
0x
increases and is 6.38, 6.70, 8.35 and 16.16, respectively for
0x
−
equal to 0.5, 1.0, 2.0 and 3.0. 
Figure 8.5 shows the Simulink phase plane plots for these values of 
0x , obtained using 
default values in the Simulink simulation. Thus the trajectories are not very smooth but 
illustrate the change in shape for the different initial conditions.
-3
-2
-1
0
1
2
3
-2
-1.5
-1
-0.5
0
0.5
1
1.5
2
Figure 8.5 Phase plane plots for conservative system with sinusoidal nonlinearity
Example 8.4.
Figure 8.6 shows the block diagram of a position control system with unit Coulomb friction where the 
nonlinearity is a signum function, that is equals +1 for positive velocity and -1 for negative velocity. 
Determine the response for an input step of 10 and compare with the result if there is no Coulomb friction. 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
160 
Phase Plane Analysis
C
1/s
4/(s+1)
NL
+
+
  _
R
  _
x
v
Figure 8.6 Block diagram for a system with Coulomb friction
The Coulomb friction has the effect of making the singular point +1 for positive values of v and -1 for 
negative values of v. Thus the effective magnitude of the step input is 9 and since the closed loop transfer 
function excluding the Coulomb friction is 
)
4
/(
4
2

 s
s
,which has a damping ratio of 
25
.0
 
]
, the 
overshoot is 
996
.3
)
444
.0
(
9
)
25
.0
1
/(
25
.0
exp(
9
5.0
2
 
 


S
 so that the next motion with a negative 
velocity will be from -2.996 about -1. The overshoot will be 1.996*0.444=0.88, so that the motion comes 
to rest at -0.12. The successive overshoots for the step input of 10 with no Coulomb friction damping 
are 
n)
444
.0
(
*
10
 for 
etc
n
3,2,1
=
. Thus the zero velocity axis is crossed at -4.44, 1.971, -0.875 , etc. The 
responses without and with Coulomb friction are shown as plots (i) and (ii) in Figure 8.7
-10
-5
0
5
-10
-5
0
5
10
15
x
y
(i)
(ii)
Figure 8.7 Responses of the system of Figure 8.6 to a step input of 10
Example 8.5
Figure 8.8 shows a position control system where NL1 is a saturation characteristic with a very 
high gain in the linear regime and output levels of 
2
±
and NL2 is Coulomb friction with levels 
of 
5.0
±
. If K = 8 calculate the required value of b to give a fast response and ensure no overshoot 
for step inputs of magnitude less than 4 units for the system without and with Coulomb friction.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
161 
Phase Plane Analysis
C
  _
NL1
1/s
K/s
NL2
+
+
  _
R
v
x
b
  _
+
+
Figure 8.8 Block diagram for Example 8.5
The response will be faster without Coulomb friction so this case needs to be considered to 
determine b. With the linear regime of NL1 very small, switching from positive to negative 
torque will occur at the line 
0
 


bv
x
 and the motion will be described by parabolas in the 
phase plane. For a response with no overshoot switching from the positive torque parabola to 
the negative one should take place half way to the origin, that is at 
2
−
=
x
. The parabola through 
the origin has the equation 
)}
0
(
{
4
)
0
(
2
2
x
x
K
v
v


 

, where 
0
=
= x
v
, and 
)
0
(
x
,
)
0
(
v
will lie 
on the switching line so that 
0
)
0
(
)
0
(
 


bv
x
. Thus substituting K = 8 and 
2
)
0
(
−
=
x
 gives 
2
*
32
/
2
2
2
 
b
, so that b = 0.25. The point on the switching line where switching takes place is 
thus (-2, 8) and the switching line has a slope of -4. When the Coulomb friction is included, 
which is chosen relatively larger than would be expected in practice to clearly show its effect, 
the maximum value of the input to K/s will be reduced from 2 to 1.5, so the initial part of the 
response will be given by the parabola 
)}
0
(
{
3
)
0
(
2
2
x
x
K
v
v

 

, with 
4
)
0
(
−
=
x
 and 
0
)
0
(
=
v
. 
This will meet the switching line 
0
25
.0
 


v
x
 at the point (-1.81,7.25). Starting from this 
point denoted 
)
0
(
),
0
(
v
x
 the ensuing parabola, because the Coulomb friction assists the 
deceleration, is 
)}
0
(
{
5
)
0
(
2
2
x
x
K
v
v


 

. It will meet the switching line again before the 
origin and the ensuing motion will be a sliding motion down the switching line. Figure 8.9 
shows the responses obtained in Simulink for step inputs of 6, 4 and 2 respectively, with those 
labelled with a * being the ones with the Coulomb friction included. Note that with no Coulomb 
friction the response for a step of 6 shows an overshoot, as expected, and then the final motion 
is along the switching line, and for a step of 2 the response soon returns to the switching line 
after the first switching and then slides down it to the origin. The responses are of course slower 
with the Coulomb friction included, as will be seen if the time responses are plotted, but is 
apparent from the phase plane because of the lower velocity profiles. 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
162 
Phase Plane Analysis
-6
-5
-4
-3
-2
-1
0
1
-4
-2
0
2
4
6
8
10
12
1
1*
2
2*
3
3*
Figure 8.9 Simulink responses for Example 8.5
Example 8.6
It is sometimes appropriate to limit the velocity in a position control system and this can be 
done by limiting the magnitude of the error signal as illustrated in Figure 8.10, where NL3, 
a saturation characteristic, has been added to the block diagram of Figure 8.8. Design the 
saturation characteristic so that the response will not exceed a velocity of 8 units and thus have 
no overshoot for a step input of any magnitude.
C
NL1
1/s
K/s
NL2
+
  _
R
v
x
b
+
+
NL3
_
  _
Figure 8.10 Modification of Figure 8.8 by the addition of saturation.
The response with no overshoot in the previous example for no Coulomb friction has a maximum 
velocity of 8 units reached when 
2
−
=
x
. The switching line with error limiting will be 
0
25
.0
)
(
3
 


v
x
n
 
and for this to be v = 8 requires 
2
)
(
3
=
−x
n
, so that the required saturation level is 2. Thus, when 
8
±
=
v
 in any response sliding will take place. 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
163 
Phase Plane Analysis
XY Graph1
XY Graph
y1
To Workspace3
x1
To Workspace2
y
To Workspace1
x
To Workspace
Scope1
Scope
Saturation1
Saturation
Relay
1
s
Integrator3
1
s
Integrator2
1
s
Integrator1
1
s
Integrator
In1Out1
High gain sat1
In1Out1
High gain sat
8
Gain5
-K-
Gain4
-1
Gain3
8
Gain2
-K-
Gain1
-1
Gain
 Figure 8.11 Simulink diagram for Example 8.6
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
American online      
LIGS University 
▶▶enroll by September 30th, 2014 and 
▶▶save up to 16% on the tuition!
▶▶pay in 10 installments / 2 years
▶▶Interactive Online education
▶▶visit www.ligsuniversity.com to 
      find out more!
is currently enrolling in the
Interactive Online BBA, MBA, MSc, 
DBA and PhD  programs:
Note: LIGS University is not accredited by any 
nationally recognized accrediting agency listed 
by the US Secretary of Education. 
More info here. 

Control Engineering Problems with Solutions
164 
Phase Plane Analysis
The simulink diagram for the example is shown in Figure 8.11, where the systems without and with 
Coulomb friction are simulated in parallel. This is a useful technique when one wishes to compare the 
performance of two systems. Also, some oscilloscopes additional to those shown in the diagram were 
used. Figure 8.12 shows the responses obtained on the phase plane for step inputs of -4, -6 and -10, 
respectively. Those marked with an asterisk are again for the case of Coulomb friction included. If the 
step is large enough for the maximum velocity to be reached then the final part of the response will be 
the parabolic curve straight to the origin when there is no Coulomb friction. With Coulomb friction, 
however, the response will be initially along a parabola followed by some sliding down the switching line.
-10
-8
-6
-4
-2
0
2
-1
0
1
2
3
4
5
6
7
8
9
1
1*
2
2*
3
3*
Figure 8.12 Phase plane responses for Example 8.6
Example 8.7
Figure 8.13 shows the system of the previous example but with the first integrator of transfer function 
s
K /
 replaced by the transfer function 
)
/(
a
s
K

. Discuss how the phase plane trajectories in Figure 
8.12 for K = 8 will change for finite values of a and obtain the responses for 
5.0
=
a
.
C
NL1
1/s
K/(s+a)
NL2
+
  _
R
v
x
b
+
+
NL3
_
  _
Figure 8.13 Block diagram for Example 8.7
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
165 
Phase Plane Analysis
The effect of a, which is equivalent to viscous friction, is to change the phase plane plots from parabolas. 
For positive velocity when the torque is positive the velocity increase in the phase plane trajectory is slower 
than that of the parabola and when the torque is negative the velocity decrease in the phase plane trajectory 
is faster than that of the parabola. Thus as a increases the time taken to reach the velocity limit will increase 
and after switching the retardation will be faster. Figure 8.14 shows the simulations for 
5.0
=
a
, where 
these aspects can be clearly seen when compared with Figure 8.12. In particular it can be seen that the final 
path of the trajectories for large inputs, including the case for no Coulomb friction, end up sliding down 
the switching line to the origin. It is, of course, possible to avoid the sliding by suitable adjustment of the 
saturation to a lower limit level, dependent on whether Coulomb friction is or is not present.
-10
-9
-8
-7
-6
-5
-4
-3
-2
-1
0
-1
0
1
2
3
4
5
6
7
8
1
1*
2
2*
3
3*
Figure 8.14 Phase plane trajectories for Example 8.7
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Control Engineering Problems with Solutions
166 
Phase Plane Analysis
Example 8.8
[Note;- It would probably be inappropriate not to include an example on backlash since the effect on 
performance caused by backlash in gears was one of the ‘driving forces’ for looking at the effects of 
nonlinearity in the early years of control engineering – then often known as servomechanisms. The 
model most often used for backlash is the nonlinearity shown in the Simulink diagram of Figure 8.15 
and it is a relatively crude approximation of the actual physical phenomenon of backlash in gears. First 
it assumes that the friction to inertia ratio for the driven shaft is high so that when the drive shaft starts 
to slow down the driven shaft will remain in contact with the same gear teeth. Secondly, when the drive 
shaft reverses the same dynamics is used for motion through the backlash, whereas in fact the friction 
and inertia of the load should be excluded. Finally, when the drive shaft has moved across the backlash 
the teeth coalesce passively with the two shafts then continuing to move with the velocity achieved by 
the drive shaft. This motion across the backlash corresponds to the horizontal lines in the backlash 
characteristic in Figure 8.15. In practice the approximation by this model of the actual behaviour is 
not good as when the drive shaft slows down multiple impacts (i.e. oscillations between gear teeth in 
contact) may occur and on the reversal of direction the same phenomenon may occur with multiple 
impacts by the drive shaft in ‘picking up’ the driven shaft and the loss of energy in the impacts resulting 
in a velocity reduction. In fact the ‘pick up’ assumptions involve contradictory requirements as to ensure 
the drive shaft does not loose velocity requires it to have a high inertia relative to the driven shaft but 
if this is the case the impact will knock the driven shaft forward causing bouncing across the backlash 
and multiple impacts will occur. The only way to get better solutions for the problem of backlash is by 
simulating the impact phenomenon more accurately as some simulation languages allow.]
Thus after this ‘health warning’ the simple example portrayed by the Simulink diagram of Figure 8.15 is 
considered. Here the forward loop transfer function is of the form 
)
(
/
a
s
s
K
+
and the backlash width 
1
=
b
. The requirements are (i) to simulate the system for the parameters K = 16 and 
1
=
a
 for a step 
input of -6 (ii) give the equations which describe the phase plane motion and (iii) repeat the simulation 
for K = 2 to show that there is then no limit cycle.
XY Graph
16
s+1
Transfer Fcn
y
To Workspace1
x
To Workspace
Scope2
Scope
1
s
Integrator
-1
Gain
Backlash
Figure 8.15 Simulink diagram for system with backlash.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
167 
Phase Plane Analysis
Figure 8.16 shows the phase plane plot which is the velocity of the drive shaft versus the position of the 
output (driven) shaft. The initial output of the backlash is set at -6, the same as the initial value on the 
integrator, which in Simulink means that the drive shaft starts in the middle of the backlash. The first 
part of the motion is across the backlash so that the output shaft is stationary at -6 until the drive shaft 
has moved 0.5 (b/2) units. The motion for the drive shaft is therefore described by a constant input of 
6 into the transfer function 
)
(
/
a
s
s
K
+
with zero initial conditions. Thus from the equations in Example 
8.1, with the parameters for K and a substituted, the expressions for position and velocity are 
)
1
(
96
)
(
t
e
t
t
x



 
 
and 
)
1(
96
)
(
t
e
t
v


 
, respectively. The time to reach the end of the backlash is 
given by the solution of the first equation with x(t) = 0.5 and the velocity achieved at the end of the 
backlash is given from the second equation with the value of time substituted. The solutions are t = 0.104 
and 
47
.9
)
(
 
t
v
, which are confirmed by time responses in the simulation. Motion with the two shafts 
in contact is given by the state equations 
v
x =

and 
v
x
v


 
16

 which can be written as 
v
v
x
dx
dv


 
16
, 
the slope of a trajectory in the phase plane. This gives the response from 
)
47
.9,6
(
 to 
)
0
),
1(
(x
, the 
point marked A in Figure 8.16 where the shafts both come to rest again. The next motion is again through 
the backlash to B where a slightly lower velocity is reached, although the distance travelled is now 1 unit, 
because the input to the motion is the value of x at A. In this case the motion is eventually seen to result 
in a limit cycle because the damping is quite small.
-6
-4
-2
0
2
4
6
-20
-15
-10
-5
0
5
10
15
20
25
A
B
Figure 8.16 Phase plane plot for Example 8.8 with K = 16.
It is easy to repeat the simulation for different parameters and when K = 2 it will be found that the 
response is far less oscillatory and no limit cycle results.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
168 
Phase Plane Analysis
References.
8.1 Chung J.K-C. and Atherton D.P., The Determination of Periodic Modes in Relay Systems Using the 
State Space Approach, International Journal of Control, Vol 4, pp. 105–126, 1966.
8.2 Majhi S. and Atherton D.P., On-line Tuning of Controllers for an unstable FOPDT Process, IEE 
Proceedings Control Theory and Applications, Vol. 147, pp. 421–427, 2000.
8.3	
Problems
Problem 8.1
Check by simulation the results derived in example 8.2 for the required value of b for no overshoot to 
large step inputs with (i) a = 1 and K = 10, (ii) a = 2 and K = 10 and (iii) a = 2 and K = 20.
[
9.0
=
b
;
3.0
=
b
;
4.0
=
b
]
Problem 8.2
Calculate the point at which the final sliding motion to the origin for a step input of 4 starts in example 
8.5 when the Coulomb friction is present.
[-0.69, 2.75]
Problem 8.3
Calculate the point at which the final sliding motion to the origin for large step inputs starts in example 
8.6 when the Coulomb friction is present.
[-0.50, 2.00]
Problem 8.4
Calculate the value of b and saturation level required in example 8.6 if the requirement is that with 
Coulomb friction present the velocity for large step inputs should not exceed 8 and the final response 
should be parabolic straight to the origin.
[
2.0
=
b
; 1.6]
Problem 8.5
If it is required in Example 8.7 for the response from the limit velocity of 8 to reach the origin without 
sliding find the required saturation limit level and gain b for (i) no Coulomb friction and (ii) Coulomb 
friction.
[1.72,0.215;1.41,0.176]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
169 
Phase Plane Analysis
Problem 8.6
Check the results for problems 8.2 to 8.5 by simulation.
Problem 8.7
Sketch phase plane responses for step inputs to the system of Figure P8.7 when NL is an ideal relay with 
ouput levels 
h
±
,
2
o
K
ω
=
and
o
b
ω
/
2
=
. {Note the last two parameters are such that if NL is linear of 
unit slope then the system will be critically damped}. Find the maximum step input for which the system 
will have no overshoot and the percentage overshoot for a step input of twice this value.
C
  _
NL
1/s
K/s
b
+
+
  _
R
  _
v
x
Figure P8.7
[
h
16 , 22%]
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
 
  
 
                . 

Control Engineering Problems with Solutions
170 
Phase Plane Analysis
Problem 8.8
If in Figure P8.7 NL is an ideal saturation characteristic with unit slope in the linear regime and saturation 
levels of 
h
±
, show that the maximum step input for no overshoot with the same parameters for K and 
b as Problem 8.7 is approximately 12.5h.
Problem 8.9
Figure P8.9 shows an additional nonlinear characteristic, NL1, to that of Figure P8.7 and the 
other values are identical to those of Problem P8.7. Determine what the characteristic NL1 with 
input u should be if the system should have no overshoot for all step inputs with K = 4 and 
2
=
h
. Check your result by simulation and show that there will also be no overshoot if the 
relay is replaced by the saturation characteristic as in Problem 8.8
C
  _
NL
1/s
K/s
b
+
+
  _
R
  _
v
x
NL1
Figure P8.9
[
|
|
)
sgn(
4
u
u
]
Problem 8.10
The block diagram below shows a feedback loop with Coulomb friction when the nonlinearity NL for 
input u is defined by
)
(u
dsign
. If 
1
=
d
 find the magnitude of the first overshoot for a step input of 10 
units if c has values of (i) 0.6 and (ii) 1.2. Check your results by simulation.
C
1/s
1/(s+c)
NL
+
+
  _
R
  _
x
v
Figure P8.10
[2.35; 0.47]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
171 
Phase Plane Analysis
Problem 8.11
In the block diagram of Figure P8.11 the nonlinearities NL1 and NL2 are respectively an on off 
relay with dead zone switching at 
1
± with output levels of 
2
±
and an ideal saturation 
characteristic with unit slope saturating at 
2
±
. Calculate the first overshoot and final steady 
state value for initial conditions on the output integrator of (i)-10 and (ii) -6 units. Check your 
results by simulation.
C
1/s
1/s
NL2
+
+
  _
0
  _
x
v
NL1
Figure P8.11
[6, 1; 2,-1]
Problem 8.12
In the block diagram of Figure P8.11the nonlinearities NL1 and NL2 are respectively an on off relay 
with dead zone switching at 1
± with output levels of 
2
±
and 
)
/
(
2
3 b
u
u +
−
. Show that a limit cycle 
without sliding will only occur if 
4
≥
b
. For this situation with no sliding show that the limit cycle 
will have a magnitude of 
)
4
/
(
1
2
b
x
+
=
and of 
b
v =
 and a period of 
b
b
/)
4
2
(
2 +
. Check this out 
in simulation for values of b=4 and 6 and for b=2 show that sliding takes place in the limit cycle. 
Problem 8.13
In the block diagram of Figure P8.13 the nonlinearity NL is an on off relay with dead zone and hysteresis 
with switching levels at ±0.5 and ±1.5 and output levels of ±4 and 0. Determine the limit cycle in the 
system and show that it has a period of 7 seconds. Check your result by simulation.
C
1/s
1/s
0.25
+
+
  _
0
  _
x
v
NL
Figure P8.13
[Amplitude of 
5.2
=
x
, Amplitude of 
2
=
v
]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
172 
Th e Describi ng Funct ion  and Exac t Rela y Method
9	 The Describing Function and 
Exact Relay Methods
9.1	
Introduction
The DF method, which is covered in detail in chapters 3 to 5 in reference 2, enables certain aspects 
of a nonlinear feedback system to be investigated by representing a nonlinear element by a complex 
gain which is the ratio of the fundamental of its output to the amplitude, and possibly frequency, of 
a sinusoidal input. It can be extended to cover more than one sinusoidal input, including a sinusoid 
plus bias, two sinusoids and even random inputs. The examples begin with calculations of DFs for two 
static nonlinear elements and one for a rather complicated nonlinear configuration. The following ten 
examples then use the DF method to assess the stability and/or the calculation of limit cycles in feedback 
loops, including one for an asymmetrical limit cycle and another where two nonlinear elements exist 
in the loop. Results of some simulation studies are also given to enable the accuracy of the approximate 
solutions of the DF method to be seen. Finally a few examples are given on the calculation of the exact 
limit cycle frequency for feedback loops containing relay elements. The Tsypkin method for this analysis 
is described in detail in reference 2 but some calculations are also done using a state space approach 
not given in detail in reference 2. An advantage of the Tsypkin method for evaluating limit cycles in 
relay systems is the easy comparison it allows with the DF method and that the series solutions for the 
different transfer functions can be stored in computer files. With the facilities of Matlab, however, for 
solving nonlinear equations the state space approach originally introduced in reference 9.1 has some 
advantages as will be seen from the examples.
9.2	
Examples
Example 9.1
Determine the DF of the symmetrical odd single valued nonlinear characteristic defined for positive 
values of x by 
0
)
(
=
x
n
 for 
1
δ
<
x
)
(
)
(
1
δ
−
=
x
m
x
n
 for 
2
1
δ
δ
<
< x
)
(
)
(
1
2
δ
δ −
= m
x
n
 for 
2
δ
>
x
The characteristic 
)
(x
n
is shown in Figure 9.1 from which it can be seen that it is equivalent to the sum 
of two saturation characteristics labelled 
)
(
1 x
n
 and 
)
(
2 x
n
−
, respectively.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
173 
Th e Describi ng Funct ion  and Exac t Rela y Method
δ2
-n2(x)
n1(x)
n(x)
Slope m
δ1
Figure 9.1 Nonlinearity and its synthesis from two ideal saturation characteristics.
The DF for an ideal saturation with linear slope m and saturating at an input δ  is 
)
/
(
a
mNS G
 where
[
]
S
1
for 
( / )
 
1
) 2
sin 2
(
for  
a
N
a
a
δ
δ
π
α
α
δ
<

= 
+
>

Thus the DF for 
)
(x
n
is 
)
/
(
)
/
(
1
2
a
mN
a
mN
S
S
G
G

.
Example 9.2
Determine the DF of the symmetrical odd double valued nonlinearity shown in Figure 9.2 for input 
amplitudes 
δ
>
a
.
n1(x)
Δ
Slope m
-δ
n2(x)
-Δ
δ
δ-2Δ
-δ+2Δ
Figure 9.2 Odd symmetric double valued nonlinearity.
Using the approach of reference 2 chapter 3 the in phase and quadrature nonlinearities 
)
(x
np
and 
)
(x
nq
are as shown in Figure 9.3
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
174 
Th e Describi ng Funct ion  and Exac t Rela y Method
m(δ-Δ)
Δ
Slope m
-δ
np(x)
-Δ
δ
Slope m/2
δ-2Δ
-δ+2Δ
nq(x)
Δ
Slope -m/2
-δ
-Δ
δ
δ-2Δ
-δ+2Δ
 Δm
Figure 9.3 In phase and quadrature nonlinearities for nonlinearity of figure 9.2
The 
describing 
function 
)
(
)
(
)
(
a
jN
a
N
a
N
q
p

 
 
where 
³
 
a
p
p
dx
x
p
x
xn
a
a
N
0
2
)
(
)
(
)
/
4
(
)
(
 
and 
³

 
a
q
q
dx
x
n
a
a
N
0
2
)
(
)
/
4
(
)
(
S
. For the above characteristics it can be seen that 
)
(a
N p
can be synthesised 
as two ideal saturation characteristics in parallel both of linear slope 
2
/
m
and with saturation taking 
place for input levels of δ – 2Δ and δ, respectively. Thus 
)]
/
(
}
/)
2
{(
)[
2
/
(
)
(
a
N
a
N
m
a
N
s
s
p
G
G

'

 
 
and  
S
0
2
)
(
)
/
4
(
)
(
dx
x
n
a
a
N
a
q
q
 

 
³
 
S
G
G
S
2
2
2
/)
(
4
}
)
2
(
){
/
4
(
a
m
m
m
a
'

'

 
'

'

'

 
which is (the 
area of the nonlinearity loop) /
π
2
a
−
.
Example 9.3
Figure 9.4 shows the block diagram of a nonlinear network consisting of an absolute value (modulus) 
block, a multiplier, an ideal differentiator and an ideal relay with outputs of ±1. {Note:- if the transfer 
function of the block before the relay is 
sT

1
 not s, then the network is known as a span filter – see 
reference 9.2 section 11.6 and Problem 9.6}. Show that its describing function is 
2
/
)
/
2
(
π
π
je
and check 
this by Fourier analysis in Simulink
Y
X
relay
abs
X
s
 Figure 9.4 Nonlinear network
The output waveform,
)
(t
y
, for an input, 
t
a
t
x
ω
sin
)
(
=
, is shown in Figure 9.5 obtained from the 
simulation of Figure 9.6.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
175 
Th e Describi ng Funct ion  and Exac t Rela y Method
0
1
2
3
4
5
6
7
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
Figure 9.5 Output waveform y(t)
y
To Workspace
Sine Wave1
Sine Wave
Sign
Scope
Product2
Product1
Product
1
s
Integrator1
1
s
Integrator
-K-
Gain1
-K-
Gain
0.6366
Display1
2.482e-009
Display
|u|
Abs
Figure 9.6 Simulink diagram for the determination of the fundamental of y(t)
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
www.mastersopenday.nl
Visit us and find out why we are the best!
Master’s Open Day: 22 February 2014
Join the best at
the Maastricht University
School of Business and
Economics!
Top master’s programmes
• 33rd place Financial Times worldwide ranking: MSc 
International Business
• 1st place: MSc International Business
• 1st place: MSc Financial Economics
• 2nd place: MSc Management of Learning
• 2nd place: MSc Economics
• 2nd place: MSc Econometrics and Operations Research
• 2nd place: MSc Global Supply Chain Management and 
Change
Sources: Keuzegids Master ranking 2013; Elsevier ‘Beste Studies’ ranking 2012; 
Financial Times Global Masters in Management ranking 2012
Maastricht
University is
the best specialist
university in the
Netherlands
(Elsevier)

Control Engineering Problems with Solutions
176 
Th e Describi ng Funct ion  and Exac t Rela y Method
In the simulation a frequency of 1 rad/s. has been used for x(t); the simulation taken over a time of π
2
; 
and the derivative block has been omitted with the signal at the relay input replaced by 
t
a
ω
cos
. Note 
that (i) because of the sign (relay) block the amplitude of this signal is immaterial and (ii) because of 
the lack of dynamics there is no transient involved. (Note to do Fourier analysis of the output waveform 
from a dynamic system one has to obtain the steady state waveform which only results after any transient 
has decayed.)
Since the waveform of y(t) is even it has no fundamental sine component and the cosine component 
is given by y
S
T
S
T
T
T
S
S
S
/
2
|
2
cos
)
4
/
1
)(
/
4
(
cos
sin
)
/
4
(
0
2
/
2
/
0
1
a
a
d
a
b
 
 
 
³
. Thus the describing function is 
2
/
)
/
2
(
π
π
je
. This is confirmed by the simulation of Figure 9.6, where a = 1, with the sinusoidal 
component given by the display box being zero and the cosinusoidal component given by the display1 
box being 0.636. Confirmation that the DF is independent of the input sinusoidal amplitude, a, is 
obtained by varying a.
Example 9.4
A position control system with no input is modelled as a second order differential equation and has the 
state equations
2
1
x
x =

 and 
|
|
4
2
2
2
1
2
x
cx
kx
x
x



 

 
where x1 is the position and x2 the velocity. The damping term 
2
kx  is provided by a velocity feedback 
signal so that the value of k can be adjusted by the designer. Assuming the sign of the damping term 
2
kx  is reversed calculate using the DF method the amplitude of the limit cycle in the system at both 
position and velocity. The value of c is unknown and therefore the designer decides to do an experiment 
to estimate c by taking k = –2 and measuring the amplitude and frequency of the resulting limit cycle in 
x1 and x2. Calculate what these values are predicted to be by the describing function method if c = 0.5. 
Which measurement do you expect to give the best estimate for c? Do the simulation and check these 
estimates for c.
The easiest way to solve the problem is to recognise that if both the terms in x2 are removed from the 
second state equation then one has an ideal oscillator of frequency 
2
=
ω
rads/s. Replacing the third 
term in the second equation by its describing function equivalent with 
2x having amplitude a, then the 
last two terms are zero when 
0
)
(
 


a
a
cN
ka
, which gives 
.
/
)
(
k
c
a
N
=
For the given nonlinearity
π
3
/
8
)
(
a
a
N
=
, which gives 
k
c
a
8
/
3π
=
. Since the estimated frequency is 2 rads/s the amplitude of 
x1 will equal 
k
c 16
/
3S
, half the amplitude of x2. 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
177 
Th e Describi ng Funct ion  and Exac t Rela y Method
For the given values of c and k the two amplitudes are 4.71 and 2.35. Which of the two is most accurately 
predicted by the describing function is not easy to ascertain because although the x1 limit cycle is more 
sinusoidal the describing function analysis is based on assuming x2 to be a sinusoid. Also in doing this 
procedure in practice one would probably measure the peak to peak amplitude of the signals rather than 
perform a Fourier analysis to obtain the fundamental values. A simulation shows both waveforms near 
to sinusoids of 2 rads/s with peak amplitudes of 4.71 and 2.42, respectively. Thus for these measurements 
the velocity amplitude appears best but whichever is used the error is relatively small.
Example 9.5
Obtain using the describing function method the amplitude and frequency of the limit cycle in the 
output C for the system described by the block diagram of Figure 9.7 if G(s) = 1/(s – 2) and the nonlinearity 
NL is 
|
|
5.0
x
x
.
+
  _
G(s)
4/s
NL
R=0
  _
+
C
Figure 9.7 Block diagram for Example 9.5
It can be seen that this is essentially the same system as covered in the previous example, however shown in 
this form an alternative approach is suggested of assuming the loop open at NL, denoting the NL input and 
output by 
oe , 
ie  respectively and finding the ratio of 
i
o e
e /
−
. Doing this gives 
)
(
/
)
/
4
(
s
G
e
e
s
e
o
i
o
=
−
, 
from which 
4
2
)
(
4
)
(
2


 

 

s
s
s
s
G
s
s
sG
e
e
i
o
. The Nyquist plot of this is given by 
4
2
2
+
−
−
ω
ω
ω
j
j
 
which is 
seen to have a phase of -180° at 2rads/s and a magnitude of -0.5. The Nyquist plot is shown in Figure 9.8. 
The describing function for the nonlinearity 
)
3
/
8(5.0
)
(
π
a
a
N
=
, thus 
a
a
N
a
C
4
/
3
)
(
/
1
)
(
π
−
=
−
=
 is 
on the negative real axis of the Nyquist plot moving towards the origin as a increases. The solution for 
the amplitude is given by 
5.0
)
4
/
3
(
−
=
−
a
π
, that is 
71
.
4
 
a
, as before. The intersection between the 
Nyquist plot and 
)
(a
C
is in the direction required for a stable limit cycle.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
178 
Th e Describi ng Funct ion  and Exac t Rela y Method
Nyquist Diagram
Real Axis
Imaginary Axis
-1
-0.9
-0.8
-0.7
-0.6
-0.5
-0.4
-0.3
-0.2
-0.1
0
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
System: G
Real: -0.5
Imag: -0.00356
Frequency (rad/sec): -2.01
Figure 9.8 Nyquist plot for the frequency response in Example 9.5
Example 9.6
A closed loop system with unit negative feedback contains in its forward path an on off relay with dead 
zone, switching at 
δ
±
 and having output levels of 0 and 
h
±
, and a plant with transfer function 
)
2
(
)
(
2
2
2
o
o
o
s
s
s
K
s
G
ω
ω
ζ
ω
+
+
=
. Show that the system will be stable if 
h
K
o
/
0
δ
πζω
<
<
. If 
h
K
o
/
2
δ
πζω
=
 
show that the system has a stable limit cycle with amplitude of approximately 
δ
9.3
 and frequency 
o
ω .
The transfer function 
)
( ω
j
G
 has a phase shift of -180° when the quadratic term has a phase shift of 
-90°. This is obviously the case when 
o
ω
ω =
and the corresponding gain is  
o
o
o
o
K
K
]Z
]Z
Z
Z
2
/
)]
2
(
/[
2
2
 
 . 
The describing function for a relay with dead zone (see Appendix 3.11 reference 2), 
π
δ
2
2
/
1
2
2
/
)
(
4
)
(
a
a
h
a
N
−
=
 for 
δ
>
a
 and 0 for 
δ
<
a
. This is easily shown by differentiation to have 
a maximum value when 
δ
2
=
a
 of 
SG
/
2
)
(
max
h
a
N
 
. The 
)
(
/
1
)
(
a
N
a
C
−
=
locus on a Nyquist plot 
thus starts at 
∞
−
 on the negative real axis, increases as a increases up to 
h
2
/
SG

 and then returns 
to 
∞
−
. If the gain K is large enough the Nyquist plot of 
)
( ω
j
G
will cut 
)
(a
C
 from below, so that 
according to the Loeb intersection criterion the smaller value of a at the intersection point will correspond 
to an unstable limit cycle and the larger value of a to a stable one. Thus for stability the maximum gain 
is given by 
1
/
)
/
2
)(
2
/
(

 
G
S]Z
SG
]Z
o
o
Kh
h
K
, giving 
h
K
o
/
0
δ
πζω
<
<
.
For 
h
K
o
/
2
δ
πζω
=
 the gain of 
)
( ω
j
G
when its phase is -180° is 
h
/
SG
 and therefore the amplitude of 
a limit cycle solution with frequency 
o
ω is given by 
1
}
/
}{
/
)
(
4
{
2
2
/
1
2
2
 

h
a
a
h
SG
S
G
. Taking 
a
x
/
δ
=
then the expression yields the quadratic equation in x  2 of 16x 4 – 16x  2+ 1=0, which has solutions of 
}
4
/)
3
2
{( r
 sqrt
x
, for which the smallest positive value is x = 0.259, yielding 
G
86
.
3
 
a
.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
179 
Th e Describi ng Funct ion  and Exac t Rela y Method
Example 9.7
A closed loop system with unit negative feedback contains in its forward path an on off relay with 
hysteresis of 
∆
±
and output levels of 
1
± , and a plant with transfer function 
)
1
)(
2
(
)
2
(
10
)
(
s
s
s
s
G



 
. For no 
input to the system use the DF method to estimate the amplitude and frequency of the limit cycle at the 
input to the relay for values of Δ equal to 0, 1 and 2, respectively. Compare the results with measured 
values from simulations. 
For the on off relay with hysteresis the describing function (see Appendix 3.11 reference 2) is given by
}
)
){(
/
4
(
)
(
2
/
1
2
2
2
∆
−
∆
−
=
j
a
a
h
a
N
π
 
for 
∆
>
a
. 
Thus 
the 
)
(a
C
 
locus 
is 
given 
by
}
)
){(
4
/
(
)
(
2
/
1
2
2
∆
+
∆
−
−
=
j
a
h
a
C
π
 and it is seen that the imaginary part is independent of a, thus 
the 
)
(a
C
 loci are lines parallel to the negative real axis and a distance 
h
4
/
∆
π
 below for different values 
of Δ. Now the frequency response 
)
1
)(
2
(
)
2
(
10
)
(
Z
Z
Z
Z
j
j
j
j
G



 
 has 
)
1
)(
4
(
)
5
4
(
10
)}
(
Re{
2
2
2
Z
Z
Z
Z



 
j
G
 and 
)
1
)(
4
(
)
8
(
10
)}
(
Im{
2
2
2
Z
Z
Z
Z
Z



 
j
G
 
so the frequency of the limit cycle can be found directly from
4
)
1
)(
4
(
)
8
(
10
2
2
2
'
 



S
Z
Z
Z
Z
 
as 
1
=
h
. This can be written
)
(
)
1
)(
4
(
)
8
(
40
2
2
2
Z
Z
Z
S
Z
Z
f
 



 
'
. Once ω  is found 
from this equation for the given values of Δ then the amplitude a of the oscillation at the relay input can 
be found from 
)
1
)(
4
(
)
4
5
(
10
4
)
(
2
2
2
2
/
1
2
2
Z
Z
Z
S



 
'

a
. The graph of
)
(ω
f
, where ω  is replaced by x, is shown 
in Figure 9.9 computed from the Matlab program 
% f(x) for example 9.7
x=linspace(1.2,3,50);
f=(40/pi).*x.*(8-x.*x)./((4+x.*x).*(1+x.*x));
plot(x,f)
grid
1.2
1.4
1.6
1.8
2
2.2
2.4
2.6
2.8
3
-1
0
1
2
3
4
5
6
7
8
x
f(x)
Figure 9.9 Graph of f(x) for example 9.6.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
180 
Th e Describi ng Funct ion  and Exac t Rela y Method
This shows that the solutions forω  are respectively 2.83, 2.41 and 2.13 rads/s , with as expected the 
frequency of the limit cycle decreasing as Δ increases. The equation for the amplitude of the limit cycle 
can be written 
2
/
1
2
2
2
2
2
}
])
1
)(
4
(
)
5
4
(
40
[
{
Z
Z
S
Z




'
 
a
, which gives the corresponding amplitudes as 4.24, 
4.88 and 5.42, respectively.
The actual limit cycles from simulations are shown in Figure 9.10 for 
0
=
∆
and 
2
=
∆
, which are quite 
distorted. For the three values of Δ the measured amplitudes and frequencies are 5.0 and 2.4 rads/s; 5.9 
and 2.1 rads/s; and 6.6 and 1.9 rads/s. As expected (i) due to the appreciable distortion in the limit cycles 
which show a ‘peaky effect’ the fundamental amplitude, the DF estimate, is less than the measured 
magnitude and (ii) the frequency predicted by the DF method is higher than the actual frequency (From 
comparison of Nyquist locus 
)
( ω
j
G
and 
)
,0
(
ω
o
G
A
).
Figure 9.10 Limit cycles for Δ = 0 (left) and Δ= 2 (right).
Example 9.8
Repeat the DF calculations of example 9.7 for the transfer function 
)
1(
10
)
(
)
2
/
(
s
e
s
G
s

 

 {Note that a first 
order approximation for 
)
2
/
(s
e−
is 
s
s
+
−
2
2
}. 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
181 
Th e Describi ng Funct ion  and Exac t Rela y Method
Since 
)
2
/
sin(
)
2
/
cos(
2
/
ω
ω
ω
j
e
j
−
=
−
this gives 
)
1(
)]
2
/
sin(
)
2
/
[cos(
10
)}
(
Re{
2
Z
Z
Z
Z
Z


 
j
G
and 
)
1(
)]
2
/
sin(
)
2
/
cos(
[
10
)}
(
Im{
2
Z
Z
Z
Z
Z



 
j
G
. Thus for the limit cycle frequency
)
(
)
1(
)]
2
/
sin(
)
2
/
[cos(
40
2
Z
Z
S
Z
Z
Z
f
 


 
'
, which is again plotted in Figure 9.11 as 
)
(x
f
 against x, from 
which for a given Δ the frequency ω  can be found.
2
2.5
3
3.5
4
4.5
5
-2
-1
0
1
2
3
4
5
x
f(x)
Figure 9.11 Graph showing the relationship between the value of the hysteresis and the limit cycle frequency for example 9.8.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Control Engineering Problems with Solutions
182 
Th e Describi ng Funct ion  and Exac t Rela y Method
For Δ equal to 0, 1, 2 the values of ω  are respectively, 3.67, 3.21 and 2.84, and the corresponding 
amplitudes from 
2
/
1
2
2
2
}
]
)
1(
))
2
/
sin(
)
2
/
cos(
(
40
[
{
Z
S
Z
Z
Z




'
 
a
 
are 3.34, 3.79 and 4.23. Note that although 
the previous example uses a first order approximation for the time delay there is a reasonable difference 
between the solutions as the Nyquist loci for the two transfer functions differ quite significantly when 
the phase lag is near to 180°, as shown in Figure 9.12. The inner frequency plot marked time delay being 
the transfer function of this example.
-5
0
5
10
-8
-6
-4
-2
0
2
4
6
8
Nyquist Diagram
Real Axis
Imaginary Axis
Time delay
Figure 9.12 Nyquist plots of transfer functions in examples 9.7 and 9.8.
Example 9.9
A closed loop system with unit negative feedback contains in its forward path an on off relay with 
hysteresis Δ of 
1
± and output levels of h of 
1
± , and a plant with transfer function 
3)
1(
10
)
(
s
s
G

 
. The 
input, R, to the system is constant. Do calculations using the describing function for the on off ratio at 
the output of the relay and the frequency of the limit cycle for constant input values of R equal to 0, 2 
and 4. Compare the results with those from simulations. 
To solve the problem the describing function for an on off relay with hysteresis having a sinusoidal plus 
bias input is required. It can be found in Appendix A2 of reference 9.2 but it is calculated here. Taking 
the input as
θ
γ
sin
a
+
, then the output of the nonlinearity will switch to 1 when 
∆
=
+
1
sinθ
γ
a
and 
to -1 when 
∆
−
=
+
+
)
sin(
2
θ
π
γ
a
, so that 
}
/)
{(
sin 1
1
a
J
T

'
 

 and 
}
/)
{(
sin 1
2
a
J
T

'
 

. The 
in phase fundamental output is
 
}
cos
){cos
/
2
(
}
sin
sin
sin
){
/
1(
2
1
2
0
1
2
2
1
1
T
T
S
T
T
T
T
T
T
S
S
T
S
T
S
T
T

 




 
³
³
³


h
d
h
d
h
d
h
b
 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
183 
Th e Describi ng Funct ion  and Exac t Rela y Method
and the quadrature component is
 
S
T
T
S
T
T
T
T
T
T
S
S
T
S
T
S
T
T
a
h
h
d
h
d
h
d
h
a
/
4
}
sin
){sin
/
2
(
}
cos
cos
cos
){
/
1(
2
1
2
0
1
2
2
1
1
'
 

 




 
³
³
³


. 
The bias output is 
S
D
T
T
S
T
S
S
T
T
S
T
S
/
)
)(
/
(
)}
(
2
{
)
(
)(
2
/
1(
1
2
2
1
2
1
h
h
h
h
h
 

 







, 
where 
1
2
θ
θ
α
−
=
. Thus the describing function expressions for the fundamental and bias signal are 
)
/
4
(
)
cos
)(cos
/
2
(
)
,
(
2
1
π
θ
θ
π
γ
a
h
j
a
h
a
Na
∆
−
+
=
 and 
)
)(
/
(
)
,
(
1
2
T
T
JS
J
J

 h
a
N
.
The equations to balance the fundamental and bias around the loop are 
1
)
(
)
,
(
−
=
ω
γ
j
G
a
Na
 and 
J
J
J
J
 

)
,
(
10
a
N
R
The first equation yields two equations from the real and imaginary parts, so that there are three equations 
to solve for the three unknowns ω, a and γ for given values of R. The simplest form of the first two 
equations is probably obtained by writing 
)
(
/
1
)
,
(
ω
γ
j
G
a
Na
−
=
. The three equations with the unity 
values for h and Δ substituted are
)
cos
)(cos
/
2
(
1
3
2
1
2
θ
θ
π
ω
+
=
−
a
, 
π
ω
ω
2
3
/
4
3
a
−
=
−
 and 
J
T
T
S
 


)
)(
/
10
(
1
2
R
.
The equations can be easily solved in Matlab using an algorithm such as fminsearch and the results obtained 
are respectively for ω, a and γ; 1.3258, 2.7804 and 0.0000; 1.3289, 2.7860 and 0.5750; 1.3225, 2.7742 and 
1.1133; for R = 0, 2 and 4 respectively. The third of the above equations can be written 
10
/)
(
/
J
S
D

 R
 
and therefore the on off ratio, ρ, given by 
)
/(
)
(
α
π
α
π
ρ
=
−
+
=
 
)
10
/(
)
10
(
J
J




R
R
 yields the 
corresponding values for ρ of 1.0000, 1.3323 and 1.8117. It can be seen that the results show a negligible 
change in the frequency and fundamental amplitude of the limit cycle. In the simulations the peak 
amplitude of the limit cycles was measured and the results are compared with the theory in Table 9.1.
Calculated
Calculated
Calculated
Measured
Measured
Measured
R
ω
a
ρ
ω
Peak amp.
ρ
0
1.326
2.780
1.000
1.30
2.83
1.00
2
1.329
2.786
1.332
1.29
2.81
1.33
4
1.323
2.774
1.812
1.24
2.80
1.83
Table 9.1 Comparison of calculated and simulation results.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
184 
Th e Describi ng Funct ion  and Exac t Rela y Method
When R is increased sufficiently the limit cycle disappears and the relay output remains fixed at unity, 
the theoretical limit for this value of R from the above expressions is 6.13 whereas in the simulation it 
is approximately 9.0. This is, of course, a large difference and is due to the fact that the distortion in the 
limit cycle waveform increases significantly, mainly due to second harmonic content, as R increases, and 
the accuracy of the DF solution therefore deteriorates. 
Example 9.10
A closed loop system with unit negative feedback contains in its forward path a gain compensator, an 
on off relay with dead zone, switching at 
1
± and having output levels of 0 and 
1
± , and a plant with 
transfer function 
2)
1(
1
)
(
s
s
s
G
+
=
. Determine using the describing function method the maximum value 
of gain, K, which may be placed in the compensator before the system goes unstable? Check your result 
by simulation. Calculate the value of the frequency and amplitude of the limit cycle at the relay input 
when the compensator has a gain of 6 and compare with simulation results.
The DF for the relay with dead zone is 
2
/
1
2
2
2
)
)(
/
4
(
)
(
G
S

 
a
a
h
a
N
 which has a maximum value of 
SG
/
2
)
(
max
h
a
N
 
. 

180
)
(
/_
−
=
ω
j
G
when 
1
=
ω
 and the corresponding magnitude is 
2
1
)
1(
1
|)
(
|
2
1
=
+
=
=
ω
ω
ω
ω
j
G
. Thus instability will occur with a compensator gain of K when 
1
2
.
2
!
K
h
SG
, 
that is 
h
K
/
SG
!
, giving 
π
>
K
for 
1
=
= h
δ
.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Get Help Now
Go to www.helpmyassignment.co.uk for more info
Need help with your
dissertation?
Get in-depth feedback & advice from experts in your 
topic area. Find out what you can do to improve
the quality of your dissertation!

Control Engineering Problems with Solutions
185 
Th e Describi ng Funct ion  and Exac t Rela y Method
The system was simulated in Simulink as shown in Figure 9.13, with no step input. An initial condition 
of 4 was placed on the integrator and the gain, K, in the gain block varied. For a gain of 3 the response 
persisted for over 200 seconds. 
1
s  +2s+1
2
Transfer Fcn
simout
To Workspace
Step
Scope2
Scope1
Scope
Relay1
Relay
1
s
Integrator
K
Gain
 Figure 9.13 Simulink diagram for Example 9.10
For K = 6 the system is unstable with a limit cycle of frequency 1 rad/s. and amplitude given by 
1
)1
(
4
.
2
6
2
/
1
2
2
=
−
a
a π
giving 
144
/
1
2
4
2
π
a
a
=
−
, which has solutions of 
04
.1
 
a
 and 3.68 with the 
latter being the stable solution. In the simulation the amplitude of the limit cycle was 3.61.
Example 9.11
Discuss the stability of the feedback loop of Figure 9.14 if 
)
2
/(
)
(
1

 
s
K
s
G
, 
)1
/(
1
)
(
2

 
s
s
G
 and 
NL is an ideal saturation characteristic with unit slope in the linear regime and saturating at inputs of 
±1. If K = 8 determine the amplitude and frequency of any possible limit cycle.
C
  _
G1
1/s
G2
NL
+
+
  _
X
R=0
Y
Figure 9.14 Block diagram for Example 9.11
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
186 
Th e Describi ng Funct ion  and Exac t Rela y Method
Here a quick appreciation of the situation can be assessed by considering the bounds of the describing 
function for saturation, N(a), in the system characteristic equation which is s(s + 2) (s + 1 N(a)) + K = 
0
)}
(
1
{
2
)}
(
3
{
2
3
 





K
s
a
N
s
a
N
s
. For stability  K < 2{3 + N(a)}{1 + N(a)} which equals 6 for 
N(a) = 0 and 16 for N(a) = 1. Thus, for K = 8, there is the possibility of a limit cycle for larger values of 
a. To calculate its value at the input to the nonlinearity, X, the negative of the transfer function from Y 
to X with NL removed (the equivalent open loop transfer function) is required. This is 
8
2
3
)
2
(
)
(
2
3
2
1
2




 

 

 
s
s
s
s
s
G
G
s
sG
Y
X
s
Gol
. The Nyquist plot in Matlab shows that this transfer function 
has a phase of -180° when 
58
.1
 
Z
and it crosses the negative real axis from positive to negative 
imaginary values, which means the limit cycle is unstable, at -4.23. Thus  N(a) = 1/4.23 = 0.236. Figure 
9.15 shows the DF plot for saturation with 
1
=
δ
 for amplitudes greater than unity from which it can 
be seen that the corresponding value of a is around 5.4 (more accurate value is 5.36). In practice with 
initial conditions on the output integrator simulations showed that the response went unstable for an 
initial condition greater than 4 (note that in terms of the limit cycle this corresponds to an amplitude 
of 
32
.6
58
.1
*
4
4
 
 
Z
 at the relay input).
1
2
3
4
5
6
7
8
9
10
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
a
N(a)
Figure 9.15 Describing function for ideal saturation.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
187 
Th e Describi ng Funct ion  and Exac t Rela y Method
Example 9.12
The block diagram of Figure 9.16 shows a feedback system with two nonlinear elements. 
NL1 is a saturation characteristic with unit slope and saturation levels and NL2 is a cubic. If 
s
s
s
Gc
25
.0
1
2
1
)
(


 
, 
)
5.0
1
)(
2
1(
10
)
(
1
s
s
s
G


 
, and 
s
s
G
1
)
(
2
=
, show that the system possesses a limit 
cycle and find its frequency and amplitude at the input to the two nonlinearities.
C
  _
NL1
G2
G1
NL2
+
+
  _
R
X2
Gc
X1
Figure 9.16 Block diagram for Example 9.12
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
By 2020, wind could provide one-tenth of our planet’s 
electricity needs. Already today, SKF’s innovative know-
how is crucial to running a large proportion of the 
world’s wind turbines. 
Up to 25 % of the generating costs relate to mainte-
nance. These can be reduced dramatically thanks to our 
systems for on-line condition monitoring and automatic 
lubrication. We help make it more economical to create 
cleaner, cheaper energy out of thin air. 
By sharing our experience, expertise, and creativity, 
industries can boost performance beyond expectations. 
Therefore we need the best employees who can 
meet this challenge!
The Power of Knowledge Engineering
Brain power
Plug into The Power of Knowledge Engineering. 
Visit us at www.skf.com/knowledge

Control Engineering Problems with Solutions
188 
Th e Describi ng Funct ion  and Exac t Rela y Method
Representing the DFs of the two nonlinearities by 
)
(
1
1 a
N
and 
)
(
2
2 a
N
respectively, the forward transfer 
function of the loop is 
)
(
)
(
1
1
s
G
a
N
f
 where 
)}
(
10
1
5.2
{
10
)
25
.0
1(
)
2
1(
)
(
2
2
2
a
N
s
s
s
s
s
s
G f





 
. For small 
amplitudes 
1
)
(
1
1
=
a
N
 and 
0
)
(
2
2
=
a
N
, thus the loop will be unstable if 
)
(s
G f
with 
0
)
(
2
2
=
a
N
is 
unstable with unity negative feedback. The characteristic equation for this situation is 
0
40
84
11
5.6
2
3
4
 




s
s
s
s
 which has a complex pair of roots with a positive real part and is 
thus unstable. As the amplitudes increase 
)
(
1
1 a
N
 will become less than unity as 
1a  becomes greater 
than unity and 
)
(
2
2 a
N
will continue to increase as 
2a  increases. Both these effects will help to ‘stabilise 
a limit cycle’ in the feedback loop and the relationship between 
1a  and 
2a  will depend upon the frequency 
of the limit cycle according to 
2
/
1
2
2
/
1
2
2
1
))}
16
/
(
1
{
)
4
1(
Z
Z
Z


 a
a
. One way to solve the problem is to select values 
for
)
(
2
2 a
N
, or 
2a since 
4
/
3
)
(
2
2
2
2
a
a
N
=
, then find the values of ω for which 
)
( ω
j
G f
will have a 
phase shift of -180° and the corresponding magnitudes 
|)
(
|
ω
j
G f
. Values of 
1a  can be calculated from 
the above equation for the corresponding values of ω, then 
)
(
1
1 a
N
using the known DF for saturation 
and finally the value of 
|)
(
|)
(
1
1
ω
j
G
a
N
f
. The solution is then that combination of ω, 
1a and 
2a for 
which 
1
|)
(
|)
(
2
1
=
ω
j
G
a
N
f
. Table 9.2 shows computed values for this process for values of 
)
(
10
2
2 a
N
from 5 to 8. The values for ω for -180° of
f
G and 
|
|
f
G
can be found using the margin function in Matlab. 
From the Table it is easily seen that the required solution will exist for a frequency between 3.84 and 
3.97 rads/s. Further iteration gives the required solution values as 
89
.3
 
Z
, 
33
.1
1  
a
 and
920
.0
2 =
a
. 
The corresponding three values measured from the simulation were, 3.88, 1.32 and 0.937, respectively, 
where the last two numbers are peak amplitudes. The simulations show that both waveforms at the 
nonlinearity inputs are near sinusoidal, hence the good predictions of the DF method. 
10N2(a2)
5.00
6.00
7.00
8.00
a2
0.8165
0.8944
0.9661
1.0328
ω for -180° of Gf
3.69
3.84
3.97
4.10
|Gf   | dB
1.84
1.46
1.10
0.739
|Gf   |
1.236
1.183
1.135
1.089
a1
1.211
1.301
1.382
1.453
N1(a1)
0.915
0.871
0.833
0.763
N1(a1) |Gf   |
1.131
1.030
0.945
0.831
Table 9.2 Calculations to iterate to the limit cycle solution for Example 9.12
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
189 
Th e Describi ng Funct ion  and Exac t Rela y Method
The simulink diagram for the simulation is given in figure 9.17
2s+1
0.25s+1
Transfer Fcn1
10
s  +2.5s+1
2
Transfer Fcn
y1
To Workspace1
y
To Workspace
Scope3
Scope2
Scope1
Scope
Saturation1
1
s
Integrator
u^3
Fcn
0
Constant
Figure 9.17 Simulink diagram for Example 9.12
Example 9.13
Here we examine the stability of the feedback loop of Example 8.8, which has a simple backlash 
nonlinearity model, using the DF.
The DF for this backlash model is derived in reference 9.2 but will be repeated here as an example of 
working out the DF, as it is a special form of multi-valued nonlinearity. The nonlinearity and its in-phase 
and quadrature characteristics are shown in Figure 9.18 for an input amplitude a, where a > b/2 
a
n1(x)
np(x)={n1(x)+n2(x)}/2
Slope 1
-a
a
a
a-b
a-b
-a
-a
-a+b
-a+b
b/2
Slope 1
Slope 1/2
Slope 1/2
nq(x)={n2(x)-n1(x)}/2
n2(x)
Figure 9.18 Backlash and its in-phase and quadrature nonlinearities
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
190 
Th e Describi ng Funct ion  and Exac t Rela y Method
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
-0.4
-0.3
-0.2
-0.1
0
r
Np
Nq
Figure 9.19 In-phase and quadrature DF components.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Control Engineering Problems with Solutions
191 
Th e Describi ng Funct ion  and Exac t Rela y Method
It can be seen that the in-phase nonlinearity is the equivalent of a linear gain of 0.5 and an ideal saturation 
characteristic of linear gain 0.5 and saturating at
b
a −
. Then the in-phase component of the DF is 
)
/]
([
5.0
5.0
)
(
a
b
a
N
a
N
s
p


 
, where 
s
N  is the DF of ideal saturation. The quadrature component 
)
(a
N q
is 
the 
negative 
of 
twice 
the 
area 
under 
)
(x
nq
 
divided 
by 
π
a , 
thus 
S
S
a
a
b
b
b
b
a
b
a
a
N q
/)
2
(
]
4
/
)
)(
2
/
)[(
/
4
(
)
(
2

 



 
. The DF 
)
(
)
(
)
(
a
N
j
a
N
a
N
q
p
+
=
. Figure 
9.19 shows graphs of 
p
N and 
q
N  plotted against 
a
b
r
/
=
, for 
b
a
2
>
 , that is 
2
<
r
. For the transfer 
function 
)1
(
/
+
s
s
K
, Figure 9.20 shows Nyquist plots of the frequency response for K = 2, 4 and 16 
together with 
)
(
/
1
)
(
a
N
a
C
−
=
, from which it can be seen that for the two higher values of Ka limit 
cycle is predicted. Additional Nyquist plots predict no limit cycle for 
5.3
<
K
. This compares with a 
value of around 
3.2
<
K
found from simulation of the system. {Note. This is a limit cycle approximately 
equal to the backlash width}.
-8
-7
-6
-5
-4
-3
-2
-1
0
-20
-15
-10
-5
0
5
10
15
20
Nyquist Diagram
Real Axis
Imaginary Axis
-1/DF
Gain=16
Gain=4
Gain=2
Figure 9.20 Nyquist plots for different K together with C(a)=-1/N(a)
Example 9.14
Use the Tsypkin method to determine the frequency of the limit cycle in a negative feedback loop 
containing an ideal relay and the transfer function 
)
1
)(
1
)(
1
/(
1
)
(
2
1
sT
sT
s
s
G



 
. Obtain the solution 
for 
2
1 =
T
 and 
4
2 =
T
 and compare it with the DF solution.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
192 
Th e Describi ng Funct ion  and Exac t Rela y Method
Putting the transfer function into partial fractions gives 
2
1
1
1
1
)
(
sT
C
sT
B
s
A
s
G





 
w
 
where 
)
1
)(
1(
1
2
1
T
T
A


 
, 
)
)(
1
(
2
1
1
2
1
T
T
T
T
B


 
 and 
)
)(
1
(
1
2
2
2
2
T
T
T
T
C


 
. Now the solution for the limit cycle is 
given 
by 
0
)
,0
(
Im
 
Z
o
G
A
 
where 
for 
the 
transfer 
function 
)
1
/(
1
sT

, 
O
S
S
Z
O
Z
2
tanh
4
)
,0
(
)
,0
(
Im
1,0

 

 
o
o
G
C
A
, since 
0
)
,0
(
1,1
=
−
ω
o
S
and where 
T
ω
λ =
. The solution for the 
limit cycle frequency is thus given by 
0
2
tanh
2
tanh
2
tanh
2
1
=
+
+
T
C
T
B
A
ω
π
ω
π
ω
π
. The DF solution for 
the problem is 
π
ω
ω
ω
=
+
+
−
−
−
2
1
1
1
1
tan
tan
tan
T
T
. 
For the parameters given the Tsypkin solution is given by 
0
8
tanh
3
8
4
tanh
2
2
tanh
3
1
=
+
−
ω
π
ω
π
ω
π
. The 
equation can be easily solved in Matlab using the ‘fminsearch ‘ routine as follows:-
>> f=@(x) ((1/3)*tanh(pi/(2*x(1)))-2*tanh(pi/(2*x(1)*2))+(8/3)*tanh(pi/(2*x(1)*4)))^2
f = 
 @(x) ((1/3)*tanh(pi/(2*x(1)))-2*tanh(pi/(2*x(1)*2))+(8/3)*tanh(pi/(2*x(1)*4)))^2
>> fminsearch(f,1)
ans =
 0.9196
The above equation for the DF solution can be solved in a similar way and gives an angular frequency 
of 0.9354.
[Note:- The approximate exact solution for the transfer function 
3)
1
/(
1
)
(
s
s
G
+
=
can be computed in 
Matlab by letting 
ε
+
=1
1T
and 
ε
−
=1
2
T
, and taking ε small.]
Example 9.15
Obtain an expression which will give the solution for the limit cycle frequency in a negative feedback 
loop containing a relay with hysteresis and a plant with a time delay using the state space approach, 
where the plant is described by 
)
0,
,
,
(
C
B
A
and the delay is θ. 
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
193 
Th e Describi ng Funct ion  and Exac t Rela y Method
0
2
4
6
8
10
12
14
16
18
20
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
u
ud
-y
t0
Figure 9.21 Simulation to show sample waveforms.
Figure 9.21 shows typical waveforms for a symmetrical oscillation with the relay switching negative at 
time 0t  and with the delay assumed to occur after the relay. The waveform labelled ‘u’ is a scaled version 
of the relay output, the input to the plant is ‘ud’ delayed by θ from ‘u’ and the input to the relay is labelled 
‘-y’, that is minus the loop output. The relay switching levels in the simulation are 
25
.0
r
. The input to 
the plant is 
h
+
for the time period 
θ
+
<
<
0
0
t
t
t
and –h for the period 
T
t
t
t
+
<
<
+
0
0
θ
, where T  
is the half period of the limit cycle. A state space description of the plant transfer function is 
Bu
Ax
x

 

 
and 
Cx
y  
, where B is a column vector and C a row vector. If the state equation is integrated over a 
time τ  from time 0 to τ when u is constant at +h one obtains
Bh
g
x
e
Bh
I
e
A
t
x
e
hdt
B
e
x
e
x
A
A
A
At
A
)
(
)
0
(
)
(
)
(
)
0
(
)
(
1
0
0
W
W
W
W
W
W
W

 


 

 

³
 
where 
)
(
)
(
1
I
e
A
g
A −
=
−
τ
τ
. Thus for the system over the above two time periods of duration θ and 
θ
−
T
one has
Bh
g
t
x
e
t
x
A
)
(
)
(
)
(
0
0
T
T
W

 

 and
Bh
T
g
t
x
e
T
t
x
T
A
)
(
)
(
)
(
0
)
(
0
T
T
T



 


 which on substituting for 
)
( 0
θ
+
t
x
 in the second equation 
gives
Bh
T
g
Bh
g
t
x
e
e
T
t
x
A
T
A
)
(
}
)
(
)
(
{
)
(
0
)
(
0
T
T
T
T



 


 which becomes
Bh
T
g
g
e
t
x
e
T
t
x
T
A
AT
)}
(
)
(
{
)
(
)
(
)
(
0
0
T
T
T



 


Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
194 
Th e Describi ng Funct ion  and Exac t Rela y Method
Now
)
2
(
)
(
)
(
)
(
)
(
)
(
1
)
(
1
1
)
(
)
(
T
T
T
T
T
T
T









 



 


T
A
AT
T
A
A
T
A
T
A
e
I
e
A
I
e
A
I
e
A
e
T
g
g
e
 since 
A
e
A
e
kA
kA
1

 
. For an odd symmetrical limit cycle 
)
(
)
(
0
0
t
x
T
t
x
−
=
+
, thus
Bh
I
e
e
A
e
I
t
x
AT
T
A
AT
)
2
(
)
(
)
(
)
(
1
1
0



 



T
.
The half period, T, for the limit cycle can then be found from the condition 
'
 



 
 



Bh
I
e
e
A
e
I
C
t
Cx
t
y
AT
T
A
AT
)
2
(
)
(
)
(
)
(
)
(
1
1
0
0
T
. 
An equation which is easily solved in Matlab for the value of T when given specific plant parameters 
)
0,
,
,
(
C
B
A
and delay θ.
Example 9.16
Use the result obtained in Example 9.15 to check the limit cycle frequency obtained for the parameters 
given in Example 9.14.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Control Engineering Problems with Solutions
195 
Th e Describi ng Funct ion  and Exac t Rela y Method
For 
0
=
∆
=
θ
 
the 
solution 
for 
the 
limit 
cycle 
frequency 
is 
given 
by 
0
]
)
[exp(
]
)
[exp(
1
1
 




Bh
I
AT
A
I
AT
C
 which can be solved in Matlab after the parameters 
)
,
,
(
C
B
A
have been entered with the function below for fminsearch 
f=@(x) (C*inv(expm(A*x(1))+I)*inv(A)*(expm(A*x(1))-I)*B)^2
or the more general function:-
f=@(x) ((C*inv(expm(A*x(1))+I)*inv(A)*(2*expm(A*(x(1)-z))-expm(A*x(1))-I)*B)-d)^2
where z is the time delay and d is 
h
/
∆
.
It should be noted that the required function for the matrix exponential in Matlab is expm. The function 
exp when used with a matrix takes the exponential of the individual matrix terms. 
)1(x
is the solution 
for the half period T and is 3.4162, which corresponds to an angular frequency of 0.9196, as in Example 
9.14.
[Note:- The solution involves the inverse of the matrix A, which will not exist when A is singular, for 
example when the transfer function has a pole at the origin. A solution, however, can be calculated good 
enough for any engineering purposes by replacing s by 
ε
+
s
, and making ε small.]
References
9.1 Chung J.K-C. and Atherton D.P., The Determination of Periodic Modes in Relay Systems Using the 
State Space Approach. International Journal of Control, Volume 4, pp 105–126, 1966.
9.2 Atherton D.P., Nonlinear Control Engineering: Describing Function Analysis and Design. Van 
Nostrand Reinhold, London, 1975.
9.3	
Problems
Problem 9.1
Repeat the procedure of example 9.1 if the state equations for the system are
2
1
x
x =

3
2
2
1
2
4
cx
kx
x
x



 

[
2
/
1)
3
/
4
(
c
k
, 
2
/
1)
3
/
(
c
k
, 2.31, 2.16, peak amplitudes in simulation 2.32and 1.25]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
196 
Th e Describi ng Funct ion  and Exac t Rela y Method
Problem 9.2
Calculate the amplitude and frequency of the output limit cycle, C, for the system represented by the 
block diagram of Figure 9.7 if the nonlinearity NL is 
3
2x for the two cases of (a)
2
3
1
)
(
2
−
−
=
s
s
s
G
and 
(b) 
2
6
)
(
2 −
+
= s
s
s
G
.
[(a) 1.49,1.15 (b)1.11,3.61]
Problem 9.3
Determine using the DF the amplitude and period of the limit cycle in Problem 8.13.
[2.78, 7.11]
Problem 9.4
A block diagram of a Clegg integrator is shown in Figure P9.4. The zero crossing detector (zcd) and 
reset gate operate such that one integrator is on when the input X is positive and the other when it is 
negative, and the integrator outputs are set to zero when there is no integrator input. Show that its DF 
is independent of the input amplitude, has a magnitude of 
ω
/
619
.1
 and a phase shift of 
$
15
.
38

.
Y
1/s
Reset gate
i/p
gate
X
zcd
+
1/s
Figure P9.4 Block diagram of Clegg Integrator
Problem 9.5
A Simulink diagram of the limited integrator of Somerville and West (see reference 9.2 page 134) is 
shown in Figure P9.5, where Gain 1 is  1/T.  Note that the effect of the dead zone feedback through the 
high Gain K is to limit the integrator output to ±V, where the dead zone is ±V, and it is not the same 
as limiting the output of the integrator with a saturation characteristic. {Note:- The limited integrator in 
Simulink implements the same function.} Show that its DF N(a) = Np(a) + jNp(a) has:-
)
(
4
)
(
2
u
r
r
a
N p
−
= π
  and 
2
sin
2
{
2
1
)
(
α
α
π
−
−
=
u
a
Nq
)} for 
u
r ≥
, and
Np(a) = 0 and Np(a) = –1/u for 
u
r ≤
,
where 
T
u
ω
=
, r = a/V and 
)
/
2
(
1
cos
r
u
−
=
α
.
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
197 
Th e Describi ng Funct ion  and Exac t Rela y Method
1
Out1
1
s
Integrator
-K-
Gain1
-K-
Gain
Dead Zone
1
In1
Figure P9.5 Simulink diagram of limited integrator
Problem 9.6
The block diagram of a SPAN filter is shown in Figure P9.6. Show that its DF,
)
(a
N
, is 
)
1
/(
)
1
/(
)
/
1(
){tan
/
2
(
2
2
2
1
D
D
D
D
D
S





j
where 
T
ω
α =
.
Y
X
relay
abs
X
1+sT
Figure P9.6 Block diagram of SPAN filter.
Problem 9.7
A driven limiter is described by the equations 
)
sgn(
)
,
(
x
T
x
x
x
x
n


+
=
 for 
|
|
|
|
x
T
x
x

+
<
x
T
x
x
x
n


+
=
)
,
(
 for 
|
|
|
|
x
T
x
x

+
>
Show that its DF is 
)
/
2
(
tan
)
/
2
(
tan
2
1
1
α
π
α
α
π
−
−
+ j
where 
T
ω
α =
.
Problem 9.8
A nonlinear feedback loop with unit negative feedback and a zero reference input has an ideal relay, 
with output levels of 
1
± , followed by transfer functions 
)
(
1 s
G
 and 
)
(
2 s
G
in the forward path. A 
constant disturbance U enters the forward path after
)
(
1 s
G
. Find using the DF method the limit cycle 
frequency and amplitude at the relay input, and the relay output on off ratio, ρ, if U = 0, -2 and -4, 
respectively, 
1
10
)
(
1

 s
s
G
and 
)
2
(
1
)
(
2
+
=
s
s
s
G
. 
Calculated
Calculated
Calculated
Measured
Measured
Measured
U
ω
a
ρ
ω
Peak amp.
ρ
0
1.414
2.122
1.00
1.37
2.20
1.00
-2
1.414
2.018
1.50
1.36
2.18
1.50
-4
1.414
1.717
2.33
1.29
2.10
2.29
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
198 
Th e Describi ng Funct ion  and Exac t Rela y Method
Problem 9.9
Use the DF method to estimate the limit cycle in Example 8.12
[Amplitude for both x and v of 
3
/
2b
, period π
2
.]
Problem 9.10
Figure P9.10 shows a simple feedback system. If G1 is a gain K, 
2
2
)
1
/(
1
s
G

 
 and NL is an ideal 
saturation characteristic with unit slope in the linear regime and saturating at unit input, estimate using 
the DF the maximum allowable gain K if the system is to remain stable for initial conditions up to a 
magnitude of 3 on the output C. Check the result by simulation.
C
  _
G1
1/s
G2
NL
+
+
  _
X
R=0
Y
Figure P9.10 Block diagram of feedback loop.
[3.44; simulation 2.85]
Problem 9.11
A negative feedback loop contains an ideal relay with output 
1
± and an FOPDT (first order plus dead 
time) plant with transfer function 
)
1
/(
s
Ke
s

U
. [Note this is the normalised version of the plant 
)
1
/(
sT
Ke s

 W
]. Determine the limit cycle frequency given by the DF method and also the exact value. 
Calculate also the result given for the limit cycle amplitude by the DF method and the exact peak 
amplitude. 
[Using the DF the solution for 
c
ω  is given by
S
Z
UZ
 


c
c
1
tan
 and the amplitude by 
2
/
1
2)
1(
/
4
c
K
ω
π
+
; 
the exact solution is 
)1
2
log(
/
−
=
ρ
π
ω
e
o
and the peak amplitude is 
)
1(
ρ
−
−e
K
]
Problem 9.12
A negative feedback loop contains an ideal relay with output 
1
± and a plant with the transfer function 
s
Ke
s /
U

. Show that the DF method gives the exact frequency 
ρ
π 2
/
 of the limit cycle and that the 
amplitude predicted is the fundamental amplitude of the actual limit cycle waveform. What does this 
suggest about how better results for estimating the critical gain might be obtained for the plant of Problem 
9.11 in the autotuning method.
[Better estimates for 
c
K from the relay test can be obtained by estimating the fundamental of the 
amplitude – approximately triangular waveform for small rho and square waveform for large rho for the 
FOPDT plant – and using this value of amplitude in the DF expression giving 
c
K .]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
199 
Th e Describi ng Funct ion  and Exac t Rela y Method
Problem 9.13
Determine in terms of T the frequency of the limit cycle in a negative feedback loop containing an ideal 
relay and a plant with the transfer function 
)
1
)(
1(
/
)
(
sT
s
s
K
s
G


 
 using both (a) the DF method 
and (b) the exact method of Tsypkin. (Note this is the normalised version of the plant 
)
1
)(
1(
/
)
(
2
1
1
sT
sT
s
K
s
G


 
). Give the values for 
2
=
T
. Check the Tsypkin solution by using the 
state space solution given in Example 9.16 for a state space representation of the transfer function 
)
1
)(
1
)(
/(
)
(
sT
s
s
K
s
G



 
H
 with ε small.
[ (a) 
T
/
1
=
ω
 (b) 
)
2
/
tanh(
)
2
/
tanh(
}
2
/
)1
{(
2
T
T
T
Z
S
Z
S
Z
S



 (a) 0.7070 (b) 0.6903 ]
Problem 9.14
Use the state space method to estimate the limit cycle frequency for a negative feedback loop containing 
a relay with hysteresis having 
2
/
=
∆
h
and the transfer function
3)
1
/(
1
)
(
s
s
G

 
.
[0.8251rads/s. using 
01
.0
 
H
(see Example 9.14)]
Problem 9.15
Use the state space method to determine the half period of the odd symmetrical limit cycle in a negative 
feedback system containing a relay with hysteresis, having 
2
/
=
∆
h
, a delay of 0.5 and a transfer function 
of 
)
4
1
)(
2
1
)(
1
/(
1
)
(
s
s
s
s
G



 
.
[5.2803]
Problem 9.16
Show that in a negative feedback loop with an ideal relay the normalised unstable FOPDT (first order 
plus dead time) plant, 
)1
/(
)
(

 

s
Ke
s
G
sT
, will only possess a limit cycle for 
693
.0
<
θ
.
Problem 9.17
Derive using the state space method the equations which yield the solution for the pulse width τ and 
half period T of the odd symmetrical limit cycle in a negative feedback loop containing a relay with dead 
zone and hysteresis and the plant 
)
0,
,
,
(
C
B
A
.
[
Bh
e
e
A
e
I
t
x
T
A
AT
AT
)
(
)
(
)
(
)
(
1
1
0
W





 
,
Bh
I
e
A
t
x
e
t
x
A
A
)
(
)
(
)
(
1
0
1


 

W
W
,
'

 G
)
( 0t
Cx
and
'

 G
)
( 1t
Cx
.]
Download free eBooks at bookboon.com

Control Engineering Problems with Solutions
200 
Th e Describi ng Funct ion  and Exac t Rela y Method
Problem 9.18
Obtain the limit cycle half period and pulse width using the state space method for the case of Problem 
9.17 if 
)
4
1
)(
2
1
)(
1
/(
24
)
(
s
s
s
s
G



 
, 
1
=
h
,
1
=
δ
 and
5.0
=
∆
.
[3.8412 and 3.1322 for the stable limit cycle; 10.2498 and 1.2995 for the unstable one.]
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
EXPERIENCE THE POWER OF 
FULL ENGAGEMENT…
     RUN FASTER.
          RUN LONGER..
                RUN EASIER…
READ MORE & PRE-ORDER TODAY 
WWW.GAITEYE.COM
Challenge the way we run

