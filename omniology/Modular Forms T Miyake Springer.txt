
Springer Monographs in Mathematics 

Toshitsune Miyake 
Modular Forms 
With 11 Figures 
Springer 

Toshitsune Miyake 
Hokkaido University 
Department of Mathematics 
060-0810 Sapporo, Japan 
e-mflz7; miyake@math.sci.hokudai.ac.jp 
Translator 
Yoshitaka Maeda 
Hokkaido University 
Department of Mathematics 
060-0810 Sapporo, Japan 
e-mflz7: maeda@math.sci.hokudai.ac.jp 
The first English edition was published as a monograph in 1989 by Springer-Verlag 
(ISBN 3-540-50268-8). 
Title of the original Japanese edition: "Hokei keishiki to seisuron" 
© Kinokuniya Company Ltd., Tokyo, 1976. 
Library of Congress Control Number: 2005936235 
Mathematics Subject Classification (2000): 11F03,11F06, iiFii, 11F12,11F27,11F30,11F66, 
11G05,11M06,11R42,11R52,11R56 
ISSN 1439-7382 
ISBN-10 3-540-29592-5 Springer Berlin Heidelberg New York 
ISBN-13 978-3-540-29592-1 Springer Berlin Heidelberg New York 
This work is subject to copyright. All rights are reserved, whether the whole or part of the material is concerned, specifically 
the rights of translation, reprinting, reuse of illustrations, recitation, broadcasting, reproduction on microfilm or in any 
other way, and storage in data banks. Duplication of this publication or parts thereof is permitted only under the 
provisions of the German Copyright Law of September 9,1965, in its current version, and permission for use must always 
be obtained from Springer. Violations are liable for prosecution under the German Copyright Law. 
Springer is a part of Springer Science+Business Media 
springeronline.com 
© Springer-Verlag Berlin Heidelberg 1989, 2006 
Printed in Germany 
The use of general descriptive names, registered names, trademarks, etc. in this publication does not imply, even in 
the absence of a specific statement, that such names are exempt from the relevant protective laws and regulations and 
therefore free for general use. 
Typesetting: Macmillan India Ltd., Bangalore 
Production: LE-TgK Jelonek, Schmidt & Vockler GbR, Leipzig 
Cover design: Erich Kirchner, Heidelberg 
Printed on acid-free paper 
46/3142YL -543210 

Preface 
Modular forms play an essential role in Number Theory. Furthermore the 
importance of modular forms has continued to grow in many areas of mathematics 
including the infinite dimensional representation theory of Lie groups and finite 
group theory. The aim of this book is to introduce some basic theory of modular 
forms of one variable. 
Originally this book was written in Japanese under the title "Automorphic 
forms and Number Theory" by Koji Doi and myself and pubHshed by Kinokuniya, 
Tokyo, in 1976. When the English translation was planned, the first named author 
proposed that only the chapters written mainly by me be translated together with 
some additional material and pubHshed under my sole authorship. 
In Chapters 1 and 2, the general theory of Fuchsian groups, automorphic forms 
and Hecke algebras is discussed. In Chapter 3,1 summarize some basic results on 
Dirichlet series which are necessary in the succeeding chapters. In Chapter 4, the 
classical theories of modular groups and modular forms are studied. Here the 
usefulness of Hecke operators as well as the remarkable relation between modular 
forms and Dirichlet series obtained by Hecke and Weil have been emphasized. 
Chapter 5 briefly reviews quaternion algebras and their unit groups, which are also 
Fuchsian groups and which play a role similar to that of modular groups in their 
application to number theory. Chapter 6 is devoted to the trace formulae of Hecke 
operators by Eichler and Selberg. The formulae have been generalized by many 
people including H. Shimizu, H. Hijikata and H. Saito. A formula computable by 
them is also offered. In our Japanese edition, as an introduction to the automorphic 
forms of several variables. Chapter 7 deals with Eisenstein series of Hilbert modular 
groups and the appHcation to values of zeta-functions (following Siegel). As a result 
of important series of recent work by Shimura on Eisenstein series, I decided to 
rewrite it to introduce some of his results on Eisenstein series restricting it to only 
the case of one variable. 
I should like to express my deepest gratitude to Professor Goro Shimura, who 
constructed the essential part of the arithmetic theory of automorphic functions, for 
his valuable suggestions and encouragement. 
The translation of Chapters 1 through 6 was prepared by my colleague 
Professor Yoshitaka Maeda. He also corrected mistakes in the original text, and 
gave me many appropriate suggestions. I express my deep and sincere thanks to him 
for his collaboration. I also express my hearty thanks to Professor Haruzo Hida 

VI 
Preface 
whose lectures at Hokkaido University during 1983-84 were very helpful for the 
preparation of the present volume, and to Professor Hiroshi Saito and Dr. Masaru 
Ueda who kindly read the manuscript very carefully as a whole or in part and made 
many valuable suggestions. 
Sapporo, February 1989 
Toshitsune Miyake 

Contents 
Notation and Terminology 
IX 
Chapter 1. The Upper Half Plane and Fuchsian Groups 
1 
§1.1. The Group of Automorphisms of the Upper Half Plane 
1 
§1.2. Actions of Groups 
4 
§1.3. Classification of Linear Fractional Transformations 
7 
§1.4. The Invariant Metric and Measure on H 
10 
§1.5. Fuchsian Groups 
17 
§1.6. Fundamental Domains 
20 
§1.7. Quotient Spaces r \ H * 
24 
§1.8. The Structure of r \ H * as a Riemann Surface 
28 
§1.9. Fuchsian Groups of the First Kind 
31 
Chapter 2. Automorphic Forms 
37 
§2.1. Automorphic Forms 
37 
§2.2. Differentials on Compact Riemann Surfaces 
45 
§2.3. Automorphic Forms and Differentials 
48 
§2.4. The Measure of r \ H * 
53 
§2.5. Dimensions of ^^(r) and ^^iH 
57 
§2.6. Poincare Series and Eisenstein Series 
61 
§2.7. Hecke Algebras 
69 
§2.8. Hecke Operators on the Space of Automorphic Forms 
74 
Chapter 3. L-Functions 
79 
§3.1. Dirichlet Characters. 
79 
§3.2. The Riemann Zeta-Function 
84 
§3.3. Hecke L-Functions 
90 
Chapter 4. Modular Groups and Modular Forms 
96 
§4.1. SL2{Z) 
96 
§4.2. Congruence Modular Groups 
103 
§4.3. Modular Forms and Dirichlet Series 
114 

VIII 
Contents 
§4.4. A(z) and r](z) 
129 
§4.5. Hecke Algebras of Modular Groups 
131 
§4.6. Primitive Forms 
153 
§4.7. Dirichlet L-Functions and Modular Forms 
175 
§4.8. L-Functions of Quadratic Fields and Cusp Forms 
182 
§4.9. Theta Functions 
185 
Chapter 5. Unit Groups of Quaternion Algebras 
195 
§5.1. Algebras over Q and Adelization 
195 
§5.2. Quaternion Algebras 
198 
§5.3. Hecke Algebras of Unit Groups of Quaternion Algebras 
210 
Chapter 6. Traces of Hecke Operators 
219 
§6.1. Spaces of Functions on H 
219 
§6.2. The Projection of Lf (H) onto Hf (H) 
225 
§6.3. Function Spaces Consisting of Automorphic Forms 
228 
§6.4. Traces of Hecke Operators (Calculation of Integrals) 
231 
§6.5. Traces of Hecke Operators (Algebraic Calculation) 
243 
§6.6. Local Conjugacy Classes 
248 
§6.7. Class Numbers of Orders of Q[a] 
256 
§6.8. An Explicit Formula for ir(T(n)) 
259 
Chapter 7. Eisenstein Series 
268 
§7.1. Eisenstein Series of Weight k^3 
268 
§7.2. Analytic Continuation of Eisenstein Series 
274 
Numerical Tables 
295 
References 
315 
List of Symbols 
317 
Subject Index 
333 

Notation and Terminology 
1. We denote by / , Q, U and C, the ring of rational integers, the rational number 
field, the real number field and the complex number field, respectively. For a 
rational prime p, Z^ and Qp denote the ring of p-adic integers and the field of p-adic 
numbers, respectively. We also denote by U + , !R_ and C \ the set of positive real 
numbers, the set of negative real numbers and the set of complex numbers with 
absolute value 1, respectively: 
R+ = {xelR 
I x > 0 } , [R_ = {xeR 
| x < 0 } , C^ = {zeC 
| |z| = 1}. 
2. For a complex number z, we denote by Re(z) and Im(z), the real part and the 
imaginary part of z, respectively. When z is a non-zero complex number, we denote 
by arg(z) the argument of z, which we specify by — TT < arg(z) ^ n. For a real 
number x, we denote by [x] the largest integer not exceeding x. When x is a non-
zero real number, sgn(x) denotes + 1 or — 1 according as x > 0 or x < 0. 
3. For a ring R with unity 1, we denote by R"" the group of invertible elements in 
R. Further we write 
M„{R) = the set of square matrices of degree n over R, 
GL„{R) = {oieM„(R) 
\ det(a)eR^}, 
SL„(R) = {aeM„{R) 
\ det(a) = 1}. 
4. We denote by II the disjoint union of sets. For a finite set A,\A\ denotes the 
number of elements in A. We also denote by # { 
}, the number of the 
elements of the set given by { 
}. 
5. When ^ i , . . . , g^ are elements of a group G, <^i, . . . , g^} denotes the 
subgroup of G generated by ^ i , . . . , ^^. When y^,. . . , f^ are vectors in a vector 
space V over a field X, <i;i, . . . , t;^> denotes the subspace of V generated by 
Vi,. . . , v„. For mappings g.A^B 
and/:fi-• C, we denote byf°g 
the mapping 
of A to C given by 
if^g)ia)=f{g{a)) 
(aeA). 

Chapter 1. The Upper Half Plane and 
Fuchsian Groups 
We explain basic properties of the upper half plane H in § 1.1 through § 1.4. We 
introduce Fuchsian groups in §1.5 which play an essential role throughout the 
book. In § 1.6 through § 1.8, we study the quotient spaces of H by Fuchsian groups 
and induce the structure of Riemann surfaces on them. 
§1.1. The Group of Automorphisms of the Upper Half Plane 
We denote by P the Riemann sphere Cu {oo} and define the action of an element 
GL2(C) on P by 
-=[:a°' 
(1.1.1) 
az = ^ ^ ^ 
(zeP). 
cz-\-d 
This mapping "z i—• az" is complex analytic from P into itself. We put 
(1.1.2) 
j{(x,z) = cz + d (zeC). 
If z 6 C and ; (a, z) # 0, then we have 
This equality also holds when considering each constituent as a meromorphic 
function. Calculating aj^ . («»j^e^^2(C)) in two ways, we see that 
;(a.^z)y(A.)[«<f>]=;(aAz)[<«f], 
From this equality, we obtain 
(1-1.4) 
(a)?)z = a()Sz) 
(a, PeGL^^C), zeP), 
and 
(1.1.5) 
j{ap, z) =;•(«, MJiP, z) 
(a, jSeGi2(C), z6C). 

2 
1. The Upper Half Plane and Fuchsian Groups 
By (1.1.4), the mapping "zi-^a"^z" is the inverse mapping of "zh-^az", and 
therefore, "zi—•az" is an automorphism of the Riemann sphere P. This auto-
morphism is called a linear fractional transformation. Putting P = OL~^ in (1.1.5), 
we see 
(1.1.6) 
7(a-\z)=7(a,a-iz)-^ 
Lemma 1.1.1. A linear fractional transformation maps circles and lines on C into 
circles or lines on C. 
=[::] 
Proof We put for an element P = \ 
of GL2(C) 
Cp = {zeP\\Pz\ = l}. 
Since z belongs to C^ n C if and only if \az + b\ = \cz H- dl C^ n C is a Hne (if a = c) or 
a circle (the Appolonius circle). Conversely it is easily seen that circles and lines on 
C can be expressed as C^ n C with some PEGL2(C). 
Let a be an element of GL2(C) 
and denote by a(C^) the image of Cp by a. Since a(C^) = C^^-»»^i^p) n C is again a 
circle or a line on C. 
D 
We define two domains H and K of C by 
H = {zGC|Im(z)>0} 
and 
K = {zeC||z|<l}. 
The domains H and K are called the upper half plane and the unit disk, respectively. 
Lemma 1.1.2. The upper half plane H and the unit disk K are complex analytically 
isomorphic. 
Proof Put P = L 
. . Then "z !-• pz" is an automorphism of P, and satisfies 
^~' <1 
(zeH). 
\pz\ = 
Since we see 
z + i 
lm(p-'w) 
= lm( i 
, ^ )= ,^ 
,.'2>Q 
(weK), 
. w+1 \ _ l-|w|2 
w + 1 / 
|l-wp 
p gives an analytic isomorphism of H onto K. 
D 
We are interested in functions on H which satisfy certain transformation 
equations for automorphisms of H. (We say that they have automorphy) We first 
study automorphisms of H. We denote by Aut(H) and Aut(K) the groups of all 
(complex analytic) automorphisms of H and K, respectively. If a = 
e GL2(U\ 

§1.1. The Group of Automorphisms of the Upper Half Plane 
3 
and z e H, then 
/I 1 ax 
T / . 
^et(a) Im(z) 
(1.1.7) 
i „ ( „ . ) = _ _ _ ^ . 
In particular, if det(a)>0, then we have lm(az)>0, and therefore, "zi—•az" induces 
an automorphism of H. We put 
GmU) = {(xeGL2{U)\ det(a)>0}, 
and denote by I{OL) (aeGL2 (IR)) the automorphism "zi-^az" of H. Then it follows 
from (1.1.4) that this mapping 
i: GLj(IR)9ai-)>i(a)eAut(H) 
is a group-homomorphism. 
Now we put 
(|_ —sm ^ COS0JI 
J 
We identify aeW" with 
^ 
eGL^(IR). If for a = r 
eGL2([R), Ka) is the 
identity of H, then a belongs to R"", since cz^ + (d — a)z —b = 0 for any zeH. Now 
we have 
Theorem 1.1.3. (1) For any zeH, there exists an element a in SLjCIR) satisfying 
OLi = Z. 
(2) The homomorphism i induces an isomorphism 
GLU^)/^'' 
^ SL2(U)/{± 1} ^ Aut(H). 
(3) S02(U) = {oceSL2iU)\(xi = i} 
and 
U" • S02{U) = {a G GL2'" (IR) I (xi = i}. 
Proof. For any z = x + yiell, put '-y'-[i: 
Then a belongs to SL2iU) and 
ai = z; this proves (1). The first isomorphism of (2) is obvious. To see the second 
isomorphism, we have only to verify the surjectivity. For this purpose, it is sufficient 
to show that if an element ij/ of Aut(H) satisfies \l/(i) = i, then there exists an element 
P in -S02(IR) such that ^ = i(p). In fact, for each element (/>eAut(H), we get an 
element aeSL2(U) satisfying OL~^ (j){i) = i by (1). Then taking i(a" ^)(/> in place of ^, 
we have (J) = I(OLP) for some j5eS02(IR); this implies i is surjective. Now let xj/ be an 
element of Aut(H) such that ^(i) = i. We put 
p(z) = (z-0/(2 + 0 
(zeH), 
which is an isomorphism of H onto K. Since p(0 = 0, tj^pif/p'^ is an auto-
morphism of K such that ;/(0) = 0. Applying Schwarz's theorem to rj and ^ " S we see 
that 
|^(w)| = |w| 
(weK). 

4 
1. The Upper Half Plane and Fuchsian Groups 
A further application of Schwarz's theorem shows that there exists 6(0S6<n) 
such 
that 
rj(w) = e^^^w 
(WEK). 
Thus puUing back the function rj by p~^ to H, we see that 
( — sin c7)z + cos u 
namely il/ = i(kQ) with fc^ = 
. _ 
_ eS02(IR). This implies (2) and (3). D 
|_—smt/ cos ^J 
Now let us consider Aut(K). Put 
Since 
(1.1.8) 
pSL2mp-' = SU(ll\ 
p = r[ " j l 
we see by Lemma 1.1.2 and Theorem 1.1.3(2) 
(1.1.9) 
Aut(K)-SC/(l,l)/{±l}. 
§1.2. Actions of Groups 
In this section, we prepare general theory on topological spaces and transformation 
groups to apply it to the upper half plane H. 
Let G be a group and X a topological space (resp. a complex domain). We say 
that G acts on X if there exists a mapping 
GxX3{gyX)\-^gxeX 
satisfying the following three conditions: 
(i) for each element g of G, '*X3x\-^gxeX'' 
is a continuous (resp. complex 
analytic) mapping; 
(ii) {gh)x = g(hx)for two elements g and h ofG; 
(iii) for the unit element 1 o/G, Ix = xfor any element X ofX. 
Since for any element g of G, ''xv-*g~ ^x" is the inverse mapping of "xi-^gx'\ we see 
that if G acts on X, then 
(i') for each element g of G, "Xaxi—•gfxeX" is a topological {resp. complex 
analytic) automorphism of X. 

§1.2. Actions of Groups 
5 
We assume hereafter that G acts on X. For an element x of Z we put 
G^ = {gGG\gx = x}, 
and call it the stabilizer ofx. It is obvious that for any element g of G, 
(1.2.1) 
G,, = 
gG,g-\ 
An element x of A' is called a fixed point 
ofgeGif 
gx — x. 
This is equivalent to saying geG^. Further for each element x of X, a subset of X 
defined by 
Gx = 
{gx\geG} 
is called the G-orbit ofx. The set of all G-orbits in X is denoted by G\X. Since either 
Gx = Gy or GxnGy = 0 for any two elements x, y of X, X can be expressed as a 
disjoint union of G-orbits: 
X = IjGx. 
In particular, HX itself is a G-orbit, then we say that G acts transitively on X. This is 
equivalent to saying that 
(1.2.2) 
for any two elements x, y of X, there exists an element g of G such that 
gx = y. 
Therefore, it follows from (1.2.1) that if G acts transitively on X, then all the 
stabilizers are conjugate. 
Now let us denote by n the canonical mapping of A" onto the set of all G-orbits 
G\X; in other words, TT is a mapping which corresponds any element x of X to the 
element Gx of G\X: 
X3x\-^n(x) = 
GxeG\X. 
We induce the strongest topology on G\X under which the above projection n is 
continuous. More precisely, it is given by defining that a subset U of G\X is open if 
and only if the inverse image TC" ^(C/) of [/ by TC is open in X. The topological space 
G\X with this topology is called the quotient space of X by G. Since for an open 
subset U of X, we have 
n-\n(U))=[j 
gU 
gU = 
{gu\ueU}, 
geG 
n{U) is again open in G\X. Thus n is an open continuous mapping of X onto the 
quotient space G\X. 
If a group G has a topological structure of a Hausdorif space, and the two 
mappings 
GxG3(g,h)h^gheG, 
GBg\-^g~^eG 
are continuous with respect to its topology, then G is called a topological group. Let 

6 
1. The Upper Half Plane and Fuchsian Groups 
G be a topological group and assume that G acts on X. Then we say that a 
topological group G acts on a topological space AT, if the additional condition (iv) 
below is satisfied: 
(iv) 
Gx X3(g,x)\-^gxeX 
is continuous. 
If a topological group G acts on a topological space X, then all the stabilizers are 
closed subgroups of G. Conversely, let G be a topological group and K a closed 
subgroup of G. Then K acts on G by right multipHcation. We denote by G/K the 
quotient space of G by K, and call it the space of the right cosets of G by K. 
Theorem 1.2.1. Assume that a topological group G acts transitively on a topological 
space X. If G is a locally compact group with a countable basis, and X is a locally 
compact Hausdorff space, then for each element xeX, the space of the right cosets 
G/Gx is homeomorphic to X by the correspondence "gfG^ i—• gfjc". 
Proof It is obvious that the correspondence is bijective. Thus it is sufficient to 
show that it is bicontinuous. From the definition of the topology on G/G^, it is 
equivalent to saying that "gf J-> gx'' is an open continuous mapping of G to X. The 
continuity is obvious by definition, and therefore it is sufficient to show that this 
mapping is also open. Let us prove that for any open set U of G,Ux = 
{gx\geU} 
is also open in X. Let gx (gEU)bQ any point of Ux. Take a compact neighbor-
hood V of the unit element of G so that V~^ = V and gV^ d U. Since G has a 
countable basis, there exist countably many elements g„ (n=l, 2, . . .) satisfying 
G = [j^= 1 gn V. Put W„ = g„Vx, then X = 1J„"L i W„, Since W„ is a compact set in 
the Hausdorff space X, it is closed. Now suppose that no W„ contains an open 
subset. Since X is regular, we find inductively non-empty open subsets L/„ so that 
the closures U„ are compact and 
l/„.i-PF„_i3(7„ 
(n^2). 
Then we see that UI^DUJ^U^^ 
Since f]^=i U„^0 
and f]^=i U„ has no 
common point with any IV„, this contradicts the fact X = [j^=i W„. Hence there 
exists a set W^ = g^Vx which contains an open subset of X. Since fif^Kx is 
homeomorphic to Vx, Vx also contains an open subset S. For an element h oi V 
such that hx e S, we have 
gxegh~^S 
c: gV^x c= Ux. 
Therefore gx is an interior point of Ux. This proves that Ux is open. 
D 
Now Theorem 1.L3 implies that the topological group SLjiU) acts transitively 
on the complex domain H and the stabilizer of i is SOjiM). Thus, applying the 
above theorem to X = H and G = SL2(IR), we obtain the following 
Corollary 1.2.2. The space of the cosets SL2(U)/S02W 
is homeomorphic to H by the 
correspondence ''ccSO2iU)\-^ ai". 

§1.3. Classification of Linear Fractional Transformations 
7 
§1.3. Classification of Linear Fractional Transformations 
It follows from Theorem 1.1.3 that every automorphism of the upper half plane H is 
induced by an element of GL J([R). Let us now investigate transformations induced 
by elements of GL2 (U). We are going to classify elements of GL2 (U). 
A non-scalar element a of GL2 (U) is called elliptic, parabolic or hyperbolic, 
when it satisfies 
tr(a)2 < 4det(a), tr(a)2 = 4det(a), or 
tT((xf > 4det(a), 
respectively. This definition appHes also to the automorphisms i(a) of H induced by 
a. We note that 
the eigenvalues of a are tonjugate complex numbers, a multiple real number or two 
distinct real numbers, respectively. 
To see the geometrical meaning of the classification, we shall study the fixed points 
of the elements of GL^(IR) as automorphisms of the Riemann sphere P. Let 
"=[::] 
be a non-scalar element. First assume c — 0. Then tr(a)^ — 4det(a) 
= {a — d)^. Thus a is parabolic if and only if a = ^, and in this case a has a unique 
fixed point 00. We also see that if a^d, 
then a is hyperbolic, and it has two fixed 
points b/(d — a) and 00. Now we assume c # 0. Then the point 00 can not be a fixed 
point of a. If a complex number z is a fixed point of a, then z satisfies the equation 
cz^ + (d — a)z — b = 0. Since the discriminant of this equation is equal to 
tr(a)^ — 4det(a), the fixed points of a are conjugate complex numbers, a real 
number, or two distinct real numbers if a is elliptic, parabolic or hyperbolic, 
respectively. Thus we get the following 
Theorem 1.3.1. A non-scalar element a ofGL2 {U) is characterized by its fixed points 
on P as follows: 
(1) oiis elliptic if and only if OL has the fixed points ZQ and ZQ with ZQEH; 
(2) a is parabolic if and only if a has a unique fixed point on IR u {00}; 
(3) a is hyperbolic if and only if a has two distinct fixed points on IR u {00}. 
For X 6 IR u {00}, the stabilizer GL2 (IR)^ contains both parabolic elements and 
hyperbolic elements. In order to distinguish these, we put for x, x'elRu{oo} 
(x^x') 
(1.3.1) 
(1.3.2) 
GL^(IR)Sf> = {aeGLj(IR)^| a is parabolic or scalar}, 
SL2(Uf^^ = SL2(IR) n GLt (R)Sf^; 
GLt (R),,,, = GL^ (R), n GLt (U),,, 
SL2{U),,,, = SL2m n GLt (R),,,. 

8 
1. The Upper Half Plane and Fuchsian Groups 
Lemma 1.3.2. (1) GmU)i 
= R" •502([R), 
GL,^(m^^) = | r 
J « e R \ 
beU 
GLnu)... = {[l i a, c/elR% 
ad>0 
(2) The groups GL^(U), 
(zeH), 
GL^(UYf^ 
(XEUKJ {oo}) and GL^(U),^,> 
{x,x'eUu{co},x^x') 
are conjugate to GL^([R),., GLj([Ry^> and 
GL^(U)^^o, 
respectively. Further this conjugation is given by an element ofSL2(U). 
Proof. (1): The first equality is nothing but Theorem 1.1.3(3), and the second and 
the third are easily seen. (2): Since SL2(U) acts on H transitively, all stabilizers of 
points of H are conjugate by elements of SL2(U). In particular, GmU), 
is 
conjugate to GL^{U)i by an element of 5L2(IR). Furthermore, for any two distinct 
elements x, x' of IR u {oo}, there exists an element ae5L2([R) such that a(x) = oo, 
a(x') = 0. For such an a, we see 
GLt 
= a-'GLt 
'00,0 a. 
GLt 
\(P) 
a-'GmuY^^(x. 
D 
To see the difference of the transformations of these types, we shall give some 
illustrations below. 
=[?:] (a>0) 
r-z + i a 
(the fixed point =<=) 
(the fixed points °°, 0) 
Fig. 1.3.1 
(cos g) 2-1-sin ^ 
" (-sin^)z-i-cos^ 
(the fixed point i) 
We now study the centralizers of elements of GL2^(IR) and the normalizers of 
the above subgroups GL^(U),, GmU)^^^ and GL2'"(R),,^. We calculate cen-
tralizers and normalizers not only in GL^(U) but also in GL2(IR), since we need 
them in Chapter 6. We note here the property that a e GL2^ (U) is elliptic, paraboHc 
or hyperboHc is invariant under the conjugation in GL2(ff^)- For an element 

§1.3. Classification of Linear Fractional Transformations 
9 
aeGL^([R), we denote by Z(a) the centralizer of a, or 
(1.3.3) 
Z(oi) = {PeGL2iU)\ocp = M' 
Now we have 
Lemma 1.3.3. For a non-scalar element a o/GL^(IR), we have: 
(1) //aeGL2'"(IR)„ 
then Z(a) = Z(a)n GL^(IR) = GLj(IR),; 
(2) IfaeOmuYf, 
then Z(a) = Z{(x)nGL^ (U) = GLl(UYf; 
(3) If(xeGL^(U)^^,, 
then 
[Z(a): Z(oc)n GL^ (U)^ = 2 and 
Z{oc)nGmU) 
= 
GmU),,,,. 
Here zeH and X,X'GUU 
{OO} (X ^ x'). 
Proof. Since Z(p~^(xp) = p~^Z((x)p for pGSL2(U\ we may assume by Lemma 
L3.2(2) that a is r 
^^^^ 
^^^^^\{r > 0,0 < d <2n, 6 ^ nU ^ 
^ (fl,6eIR"), 
|_ —sm0 
COS0J 
L^ 
^J 
fa 
0~|, 
, ^x 
, 
^ 
,x ^. 
, 
r 
cos^ 
sin^l 
, ^, 
or ^ 
, (a, rf 6IR , flrf > 0, a 7^ d). First let a = r 
. ^ 
^ , and B be an 
|_0 f/J 
L —sin^ 
COS0J 
element of Z(a). Since ocpt = j?ai = PU Pl is also a fixed point of a. Hence fit = ± i. If 
det(j5) > 0, then ^i = i and this implies P e GL2 {U)i. Assume that det(j5) < 0. Then 
(1.1.7) implies that pi = -i. Put P' = 
~ 
U. Then det(j5') > 0 and p'i = i; 
therefore, P' e GL^ ([R)f. In particular, both P and ^' are commutative with a, hence 
r - 1 
01 
so is 
. On the other hand, we have 
f - l 
01 f - l 
Ol-i 
fcos^ 
- s i n ^ l 
L 0 
i J l 
0 
i j 
=^Lsin^ 
c o s ^ J ^ " ' 
since a is not scalar. This is a contradiction; thus Z{cc) = Z{cc) n GL2 (U). This 
proves (1). The other cases can be shown by direct calculation. 
D 
For any subgroup G of GL2{U), we denote by N{G) the normalizer of G in 
GL2(IR); namely 
(1.3.4) 
N{G) = {oLeGL2(U)\aGoL-y=G}. 
Then we obtain 
Lemma 1.3.4. Let G he GL^([R), (ZGH), GL^([R)Sf) (xeR u {00}), or GL2'"(IR), 
(x, x'eRu{oo}, X T^x'). Then iN(G):N(G)r\GL^(U)'] 
= 2 and further 
(1) iV(G) n GL2^ (R) = G 
1/ G = GL2'- (U\, 
(2) Ar(G) n GL2'" (IR) = GL2'- (R), 
1/ G = GL2^ {U)^^\ 
(3) [iV(G) n GL2'- (R): G] = 2 
1/ G = GL2'' (fS). x-

10 
1. The Upper Half Plane and Fuchsian Groups 
Proof. Since N{p~^Gp) = p~^N(G)p for peGLj (IR), we may assume that z = i, 
x = oo and x'= 0. Therefore 
~ 
UN(G). 
Since 
lNiG):N(G)nGL^(U)^ 
S IGL2(U): GL^ (IR)] = 2, and r - i 
0 
L 0 1. 
eN(G) by Lemma 1.3.2(1), we see 
[N(G):iV(G) n GL^ (R)] = 2. Let G = GL2'"(lR)i. liPeN{G) n GL^ (IR), then j^i = U 
since j5aj5~^ has a fixed point ^/ for any OCGG. This implies j8eG, and therefore, 
N(G)nGL^ 
(U) = G. A similar argument is also applicable to G = GLJ([R)!^\ 
Next assume that G = GL2 (R)ao,o» and let PeN(G) n GL2 (K). Then by a similar 
argument as above, p induces a permutation of {00,0}. Then we have 
[N(G)n GL2'"(IR):G] ^ 2. Since we see easily that 
~ 
UN(G) n GL^(U) 
but ^ 
~ ^ U G , we have [iV(G)n GL2'"(R):G] = 2 for G = GL2'" Woo.o- 
• 
Lemma L3.5. (1) /4n}; two distinct elliptic elements in GL2 (RL (zeH) are not 
conjugate in GLj(IR). 
(2) If two distinct parabolic elements ofGLjW 
are conjugate by a matrix of 
negative determinant, then they are not conjugate in GL2iU). 
Proof (1): Let a and p be elhptic elements such that P = SocS'^ with ^eGLj(IR). 
Then Sz is also a fixed point of j5, and therefore, Sz = z. This implies that 
SeGL2(U)^. 
Since a and S are commutative, we get a = j5. (2): Let a and p be 
distinct paraboHc elements. Assume that P = yocy~^ = SocS~^ with y, SEGL2iU) 
such that det(y) < 0 and det(^) > 0. Then S~^yeZ(oi). Since det(<5"^y) < 0, this 
contradicts Lemma 1.3.3(2). 
D 
§1.4. The Invariant Metric and Measure on H 
In the upper half plane H, there exist a metric and a measure which are invariant 
under the action of GL2 (IR). Such a metric is unique up to a constant multipHca-
tion and is called the Poincare metric. For a differentiable function f(z) on H, we 
define the differential df by 
considering / as a function of x = Re(z) and y = Im(z). Further for a e GL J (IR), we 
put 
(/°a)(z)=/(az), 
(df)ooi = d{foa). 
Then for z and z and for aeGL^([R), we have 
dz = dx -\- idy, 
dz = dx — idy, 
(1.4.1) 
''^°"=(^)'*^' 
'^^"°"=(^)''^' 

§1.4. The Invariant Metric and Measure on H 
11 
Further we define the metric ds^ and the measure dv on H by 
n A'^\ 
J 2/ X 
dx^ -\-dy^ 
dxdy 
(1.4.2) 
ds^(z)= 
-2 
, 
dv(z) = - ^ . 
We note that dx^ + dy^ = dz • dz, dx A dy = jdz A dz and 
(1.4.3) 
^ ^ = det(a);(a,z)"^ 
(<xeGLU^), ^eH). 
dz 
Therefore ds^ and dv are invariant under the action of GL^ (IR) by (1.4.1) and (1.1.7). 
Let (/> be an injective continuous mapping from the interval [0,1] into H which 
is C°° except for finitely many points. Then the image C of 0 is called a curve on H. 
Then by definition its length is 
0 
0 
yy^) 
which depends only on C. 
Since H is isomorphic to the unit disk K through P = 
. 
. L we can define 
the metric dsi and the measure dv^^ on K by 
dsi = ds^° p~^, 
dvfi = dv° p~^. 
By (1.1.8), they are invariant under the action of SL/(1,1). More explicitly, dsl and 
dvK can be expressed as 
-^ . 
4{dx' + dy') 
Adxdy 
(i^=>F)^ 
dv^(w) = 
— ^ 
(w = X + r> 6 K). 
We denote by / K ( Q ) the length of a curve Q on K. Then for a curve C on H, we see 
that 
/K(P(C)) = /(C). 
Among the curves joining two points Zj and Z2, the shortest one is called a geodesic. 
We note that a curve C on H is a geodesic if and only if p(C) is a geodesic on K. The 
existence and the uniqueness of a geodesic will be shown in the following 
Lemma 1.4.L (1) Any two points on H are jointed by a unique geodesic which is a 
part of a circle orthogonal to the real axis or a line orthogonal to the real axis. 
(2) Any two points on K are jointed by a unique geodesic which is a part of a 
diameter of K or a part of a circle orthogonal to the unit circle. 

12 
1, The Upper Half Plane and Fuchsian Groups 
Proof. Since p is a conformal mapping, we have only to prove (2) by Lemma 1.1.1. 
Let Zi, Z2GK. Since SU{1, 1) acts transitively on K, we may assume that z^ = 0. 
Moreover, 517(1,1) contains pS02{U)p~'^ whose elements give rotations with 
center 0; thus we may also assume that Z2 is a positive real number XQ. Let CQ be a 
horizontal Hne segment between 0 and XQ, and C be another curve joining 0 and XQ. 
Let C be parametrized by 0 and put 0(0 = x{t) + iy{t). Then 
/K(C) = j2(l - mm-' 
J{dx{t)ldtf 
+ {dy{t)ldtf dt 
0 
^\2{\-x{tf)-^\dx{t)ldt\dt 
0 
^ J 2(l-x^)-irfx 
0 
= 'K(CO). 
The equality holds only when C =^ CQ. Therefore CQ is a unique geodesic. 
D 
For any two points z^ and Z2 of H (resp. K), we call the length of the geodesic 
joining z^ and Z2 the distance of z^ and Z2, and denote it by <i(zi, Z2). 
Corollary 1.4.2. (1) Let ZQ be a point o/H {resp. K), and C the set consisting of all 
points o/H {resp. K) of the same distance from ZQ. Then C is a circle orthogonal to 
every geodesic passing through ZQ. 
(2) Let Zi and Z2 be two distinct points of H{resp. K), and C the set consisting 
of all points o/H {resp. K) which have the same distances from z^ and Z2. Then C is a 
geodesic on H {resp. K). 
Proof It is sufficient to prove our assertions only for K. (1): Since 51/(1, 1) acts 
transitively on K, we may assume that ZQ = 0. The distance from 0 is invariant by 
rotations with center 0. Therefore, in this case, C is a circle with center 0. (2): 
Mapping the middle point of the geodesic joining z^ and Z2 into 0 by an element of 
SU{\, 1), we may assume that z^ = iy^ and Z2 = — iyo{^ < yo < !)• f^^r d > 0, let 
Cy (v = 1,2) be the set consisting of the points which have the distance d from z^. 
Then C^ is a circle by (1). Since the metric on K is invariant by the transformation 
(x, >')i-^(x, —y\ Ci and C2 are symmetric with respect to the real axis. Therefore, 
the intersection points of C^ and C2 He on the real axis. Conversely, by a similar 
argument as above, every point on the real axis has equal distance from z^ and Z2. 
n 
Let a be an elliptic element of 5L2([R) which fixes ZQ, and p an isomorphism of H 
onto K such that P{ZQ) = 0. Then we see 
0 
id 
pap-' = P, 
p 
{ — 
n<6<n). 
e 
Since CCZQ = ZQ, it follows from (1.1.5) that 
(1.4.4) 
;(ft 0) =j{p, Zo)j{oi, zo)j{p-\0) 
=j{a, Zo). 

§1.4. The Invariant Metric and Measure on H 
13 
Thus we get 
(1.4.5) 
arga(a, Zo)) = arg(;(ft 0)) =-6. 
Since p is conformal, 
(1.4.6) 
the angle between a geodesic passing through ZQ and its image by cc is 10. 
Lemma 1.4.3. For any a6SL2(IR), we have: 
(1) (y-' dz)oa-y-' 
dz= 
-lid[\og(j{ai,z))y, 
(2) (y-'dx)o(x-y-'dx 
= 2dl2ivg(j(a,z))-]. 
):puta=[;;] 
Proof, (1): Put a = 
^ . By (1.1.7), (1.4.1) and (1.4.3), 
{y-'dz)o^-y-Uz 
= (\j(a,z)\^j(oi,z)-^-\)y-'dz 
= —2icj(oL,z)~^dz 
= -2i^[log(7(a,z))]. 
(2): Taking the real parts of both sides of the equality (1), we get the second 
one. 
D 
Lemma 1.4.4. Let D be the interior of a triangle onHu[Ru{oo} whose sides are 
geodesies with angles 6^, 62 and 6^. Then the area ofD is given by 
v{D) = 
71-{6,-^62-^6^). 
Proof Let Zj, Z2 and Z3 be the apices of D corresponding to O^, 62 and 0^, 
respectively. First assume that all z^ are in H. Let x^ be the intersection point of the 
extension of the side ZiZj and IRu {00} (see Figure 1.4.1). We denote by dD the 
positively oriented boundary of D. Since 
d(y~^ dx) = y~^dx A dy, 
we see by the Stokes theorem that 
j y~^dxdy = ^ y~^ dx 
D 
dD 
/ Z2 
Z3 
Z l \ 
\ZI 
Z2 
23/ 
J + I + I + I + J r'<ix. 
Zl 
X i 2 
Z2 
Ji;32 
Z3 / 
For any real number XQ, we put 
z — Xo = re^^. 
Then on the circle |z — Xol = r, we have 
(1.4.7) 
y-'dx = -de. 

14 
1. The Upper Half Plane and Fuchsian Groups 
Therefore each integral is finite. Let a e SL2{U) be an elHptic element which fixes z^ 
and maps Xi2 to X31 and7 (a, X12) > 0. Then by Lemma L4.3(2), (1.4.5) and (1.4.6), 
we see that 
^ y ^ dx = ^ y ^dx°(x— j 2i/[arg(7(a, z))] 
Zl 
Z l 
|'^-'<ix-[2arg(y(a,z))]J-
f 
y-'dx-\-(n-e,). 
Similarly we obtain 
:i2 
X32 
JC12 
Z3 
Therefore 
J);-2^x^>;= J y-^Jx + (7r-0i)-02 + (7c-^3). 
Let XQ be the center of the arc x^iZ^z^x^^ ^"^ P^t 
z — Xo = (x — XQ) + iy — re^^. 
Then by (1.4.7), we have 
y y-'dx^-]de 
= -n. 
X\3 
0 
Consequently we obtain i;(D) = TT — (^i + ^2 + ^3)- Next we consider the case 
where some vertices are on !Ru {00}. Dividing the triangle into pieces, we may 
assume that the only one vertex is on [Ru{oo}. Moreover since SL2iU) acts 
transitively on IR u {00}, we may assume that it is the point 00. Renumbering the 
indices, we may take z^ = 00. Hence ^^ = 0. Put XQ = Re(z2 + Z3)/2, and let Z4 
(resp. Z5) be the intersection point of the line Re(z) = Re(z2) (resp. Re(z) = Re(z3)) 

§1.4. The Invariant.Metric and Measure on H 
15 
Fig. 1.4.2 
and a circle with center XQ of sufficiently long radius r (see Figure 1.4.2). We denote 
by D{r) the square with vertices 22,23,^5,^4. Then from the above result, we have 
V{D) = 271 - (^2 + ^3 + ^^4 + ^^5)-
Since both LZ4. and Lz^ converge to n/2 and ^i = 0, we have 
v{D) = lim v(D(r)) 
= 7r-(0i + ^2 + ^3). 
• 
We call a measure ^ on a locally compact group G a Haar measure if the 
following two conditions are satisfied: 
(i) any compact subset of G is measurable; 
(ii) fj, is invariant under left translation by G. 
It is known that there always exists a Haar measure and that it is uniquely 
determined up to a constant factor. We say that G is unimodular if a Haar measure 
of G is also invariant under right translation by G. 
We shall give an explicit form of a Haar measure of SL2{U). Put 
(1.4.8) 
•[0;] eSL 
(z = x + iyeYi). 
Let ae5L2(IR) and z = <xi. Then h^ ^cci = i; hence we have h^ ^a = kg with 
(1.4.9) 
• 
• 
"""'^ 
'^ 
[
cosO sinOl 
^^ ,^, 
. 
eS02W. 
— smO 
cos^J 

16 
1. The Upper Half Plane and Fuchsian Groups 
Namely, any cceSL2{U) can be expressed as 
(lAlO) 
oi = hX 
(zeH, 
koeS02{U)). 
Conversely, if a is written as (1.4.10), we see that 
(1.4.11) 
z = (xU 0 = -arg(;(a,O). 
Therefore both z and 8 are uniquely determined by a. Further put a 
\_c 
dj 
y, a, b, c, 
Then we see easily that x, y, 0 are all C°° functions of a, 6, c, ^, and conversel 
d are also C* functions of x, >', 9. Consequently, we obtain isomorphisms as 
manifolds: 
(1.4.12) 
SL2(U) ^ H X SOjiU) - H x C^ 
We define a measure of SL2([R) by 
(1.4.13) 
da = 
(2n)-'y-^dxdyde. 
For any aj eSL2(IR), we have 
(1.4.14) 
aia = K,,ke+<t>^ <t> = -arg(;(ai,z)). 
Since y~^ dxA dy'is invariant under the action of SL2(IR) and </> is independent of ^, 
we see for ajZ = x' + iy\ 
y'-^dx' A dy' A d{e + (j)) = y'^dx A dy A (dS + dcj)) = y~^dx A dy A dO. 
This implies that da is a Haar measure of SL2iU). Further put (x^ = h^^kQ^, 
Zi = Xi + iy^ and define z', 6' by 
aai = /iz'/c^', 
z' = x' + iy. 
Then we see easily that 
, _ >;{(l-|zip)sin^cos0 + xicos20} 
|cos0 —ZjSin^P 
y = 
ZZi 
^ 
|cos0-zisin^|2' 
6' = — arg(cos^ —Zisin^) + ^i +2mt 
with neZ. Therefore we have 
y'-^dx' A dy A dS' = y-^dx A dy A dd. 
This implies that dec is invariant under right translation of G. Thus we obtain 
Theorem 1.4.5. 5L2(IR) is unimodular. Further if f{z) is a measurable function on H, 
"ai->/(ai)" is also measurable on SL2(U) and 
if{z)dv{z)= 
] 
f(ai)da. 
H 
SL2im 

§1.5. Fuchsian Groups 
17 
§1.5. Fuchsian Groups 
Let r be a group acting on a topological space X. We say that a group F acts 
properly discontinuously on A^ if for any two points x, y of X, there exist neighbor-
hoods 1/ of X and V oi y such that 
*{yer\yVnV^0]<ao. 
If X is locally compact, this is equivalent to saying that for any compact subsets 
A, B of X, 
^{yer\yAnB¥^0}<oo. 
A subgroup r of a topological group G is called a discrete subgroup if F is 
discrete with respect to the topology of G. 
Theorem 1.5.1. IfF is a discrete subgroup ofG, then F is a closed subgroup without 
accumulation points. 
Proof. By definition there exists a neighborhood 1/ of 1 satisfying U nF = {1}. Let 
Fbe any neighborhood of 1 such that V~^V a U. Then for any two distinct points 
a, P of r, we have V(xnVP = 0. Let g be an element of the closure of F and 
oceV'^g nF. Then we see V'^gnF 
= {a}, so that we get ^ = a e T. 
D 
Theorem 1.5.2. Let G and X be as in Theorem L2.1, and F a subgroup of G. If all 
stabilizers of elements ofG are compact, then the following statements are equivalent: 
(1) F is discrete', 
(2) F acts properly discontinuously on X. 
Proof (1) => (2): Let x be an element of X, and A, B two compact subsets of X. Put 
M = {gEG\gxEA}, 
N = 
{geG\gxeB}. 
Since G acts transitively on X, we see A = Mx. Take open subsets U^ of G so 
that M cz IJy L^v and U^ are compact. This is possible since G is locally compact. 
Then A (^[j^ U^x. Since U^x is open by Theorem L2.1 and A is compact, we can 
choose finitely many U^ so that A cz[Jl^^U^x. 
Hence M cz [j"^^U^G^. 
Since 
U^G^ is compact and M is closed, M is also compact. Similarly N is compact. Since 
F is discrete and NM~'^ is compact, {yEF\yAnB 
^ 0] = Fr\NM~'^ is also 
discrete and compact; therefore it is a finite set. (2) =>(!): Let Fbe any neighbor-
hood of 1 in G such that V is compact. For a point x G X, T n F is included in the 
set { y G r I yx 6 Vx] which is finite, since both {x} and Vx are compact in X. Hence 
we can take V so that FnV= 
{!}. 
D 
Theorem L5.2 and Theorem LL3(2) imply the following 
Corollary 1.5.3. Any discrete subgroup of SL2iU) acts properly discontinuously on 
the upper half plane H. Conversely, any subgroup of Aut (H) which acts properly 
discontinuously on H is obtained from a discrete subgroup ofSL2{Uy 

18 
1. The Upper Half Plane and Fuchsian Groups 
We call a discrete subgroup of SL2(U) a Fuchsian group. Hereafter we assume 
that r is a Fuchsian group, and put 
z(r) = rn{ + i}. 
If I is the homomorphism of SLjiU) onto Aut(H) as in §1.1, then Theorem 1.1.3 
impHes 
i{r)^r/z{r). 
When z e H u R u j o o } is a fixed point of an elUptic, parabolic or hyperbolic 
element of T, we say that z is an elliptic point, SL parabolic point or a hyperbolic point 
of r, respectively. We also call a parabolic point of T a cusp of F, For z e H and 
X, x ' e R u {oo}, we put 
F, = Fn SL2(UX, / ; = r n SL^CR),, T,,,, = T n SL^CR),,,^. 
Theorem 1.5.4. (1) IfzeH 
is an elliptic point of F, then F^ is a finite cyclic group. 
(2) / / x 6 R u {oo} is a cusp ofF, then F^ a 812^/^ 
and 
FJZiF) ^ / . 
Moreover for o'eSL2(IR) such that ax = oo, we have 
(3) //r,,,. # Z(r)for 
X, x ' e R u {oo} (x ^ x'), then 
r,../z{r) ~ 1. 
Moreover there exists aGSL2(U) such that 
GF^ ^.O ^ • ( + >}={4o «-Th'4 ^"^'^-
Proof (1): Since 5L2(IR) acts transitively on H, SLsCIR)^ is conjugate to 5L2(IRX 
= SO2^ 
which is a compact abelian group isomorphic to C^ Therefore 
F^ = rnSL2(IR)z is finite. Since any finite subgroup of C^ is cycHc, F^ is cyclic. 
(2): We may assume x = oo by taking OFG~^ in place of F. Hence there exists an 
element y of the form 
\(l i^Qi)'mF^. Suppose that OLEF^'IS neither paraboHc 
nor scalar. Then we can write a = I 
_. 
with a ^±\. 
We may assume |«| < 1 
\J) a '] 
by taking a ^ in place of a, if necessary. We get 
fl 
a^nl 
for any positive integer n. This contradicts that F is discrete; therefore 
Since SL2(IR)^o?V{ ± 1} is isomorphic to U as topological groups, we obtain (2). (3): 

§1.5. Fuchsian Groups 
19 
It follows from Lemma 1.3.2 that there exists (7ESL2i^) such that 
'a 
0 
(TF^ 
(7SL2{U):c,x'(^~^ =SL2( 
aei 
0 
a-\ 
Since discrete subgroups of R^'/l + l} are cyclic, we obtain (3). 
D 
For z€H, we put 
e^ = \rjzir)\ 
and call it the order of z with respect to F. Then z is an eUiptic point of T if and only 
iie^> 1. For a cusp x of T, we also put 6^= oo and call it the order of a cusp x of T. 
By the above theorem, we see that 
(1.5.1) 
the order of an elliptic point is finite; 
(1.5.2) 
a cusp of F cannot be a hyperbolic point of F. 
Corollary 1.5.5. IfF' is a subgroup of a Fuchsian group F of finite index, then the set 
of the cusps of F' coincides with that of F. 
Proof Since a cusp of T' is also that of T, it is sufficient to prove the converse. Let x 
be a cusp of F. Since 
lF,:F'nFJSlF:F':i<cx^, 
we see from Theorem 1.5.4(2) that FJ = F' n F^ ^ ^ir). This shows that x is also a 
cusp of F\ 
D 
We are going to discuss the case — 1 ^ T for a while. Let x be a cusp of F and a 
an element of 5L2(IR) such that ax = oo. Then it follows from Theorem 1.5.4(2) that 
there exists h> 0 such that 
<Tr,<7--{+i} = |±[J iJImezj. 
Since—l^r,(7r^(7~^ contains either 
i r^^ 
A 
. We say that a cusp X 
is regular or irregular, respectively. We will see that this definition is independent of 
the choice of a in the following 
Lemma L5.6. Assume 
—l^F. 
(1) The regularity of a cusp x of F is independent of the choice of a. 
(2) The order of any elliptic point of F is odd. 
Proof Let Ci, (72eSL2(IR) such that (T^X = G2X = ao. Since (T2crf ^00 = 00, we 
Then for ysF^ such that 
can write 02(^1 
0 a" 
fresp. 
_ i 
)' we have 
_, 
r i 
a^hl 
I 
r - 1 
a^h~\\ 
-i7-r^ = [J J] 

20 
1. The Upper Half Plane and Fuchsian Groups 
This proves (1). Now let z be an elliptic point of F. Applying Theorem 1.5.4 for 
r ' = r { ± l } , we see that F^ = r^-{±l} 
is cyclic. Hence FJ contains a unique 
element - 1 of order 2 in SL2(U). Since - l ^ T , F^ has no element of order 2. 
Therefore the order of the cychc group F^ is odd. 
D 
Example 1.5.1. Let cceSL2{U). The cyclic group <a> generated by a is a discrete 
subgroup of SL2(IR) if a is either parabolic or hyperboHc. When a is elliptic, <a> is 
discrete only if a is of finite order. 
Example 1.5.2. Let 91 be a compact Riemann surface and assume that its genus 
g > 1. Then the universal covering of 9? is isomorphic to H. We fix this iso-
morphism and consider the homotopy group 7Ci(9?) of 9i as a subgroup of Aut(H). 
Then the subgroup F = i~^(;ri(9l)) of SLjCIR) is a Fuchsian group. Moreover F 
contains neither elliptic elements nor parabolic elements. (We shall give the 
definitions of the Riemann surfaces and their genera in §1.8.) 
Example L5.3. Let 
F = SL2(Z) 
-{[::] 
eSL^ 
a, b, c, deZ 
Since SLjiZ) = M2(I.)nSL2(U) 
and M2(Z) is discrete in MjCK), SLjCZ) is a 
discrete subgroup of SL2(IR), namely, a Fuchsian group. We call F or its subgroups 
of finite index modular groups. We shall study these groups in detail in Chapter 4. 
Example 1.5.4. Let B be an indefinite quaternion algebra over Q and R an order of 
B. We may identify B(S>QR with M2(IR), and then R is discrete in M2(IR). Therefore 
F =^ Rn SL2(U) is a Fuchsian group. Example 1.5.3 is a special case of this. (We 
shall discuss quaternion algebras in Chapter 5.) 
§1.6. Fundamental Domains 
To study the quotient space r \ H for a Fuchsian group T, it is useful if there exists a 
connected domain of H which represents F\H. 
Such a domain is called a 
fundamental domain of F. 
Let r be a Fuchsian group and F a connected domain of H. We call F a 
fundamental domain of F ii F satisfies the following three conditions: 
(ii) F = U with an open set U consisting of all the interior points of F; 
(iii) yUnU 
= 
0foranyyeF-Z{F). 
Put, for example. 
r 
cos7r/3 sin7r/3~|\ 
|_—sin7c/3 
cos7r/3j/' 

§1.6. Fundamental Domains 
21 
Then we can take as fundamental domains of Tj and r2 the domains F^ and Fj 
shown by the figures below. 
Fig. 1.6.1 
Now let us show that any Fuchsian group F has a fundamental domain. We fix 
a point ZQEH which is not an elliptic point of F, For yeF — Z(F\ we put 
Fy = {z6H|rf(z, Zo) ^ d(z, yzo)}, 
L/, = {zeH|rf(z,Zo)<^(z,yzo)}, 
Cy = {zeH I d(z, ZQ) = rf(z, yzo)}. 
Here i/( , ) indicates the distance on H defined in §1.4. We note that Cy is a 
geodesic by Corollary 1.4.2(2). 
Lemma 1.6.1. For any compact subset MofK, 
^{yeF 
— Z(F)\Mr\Cy^ 
0} is 
finite. 
Proof. Put 
M,= {z6HM(z,Zo)^r} 
for r > 0, where ZQ is the point taken above. Assume that M^nCy^ 
0. Then we 
have yzQ e M2,., since 
d(zo, JZQ) ^ (i(zo, z) + d(z, yzo) ^ 2r 
for zeM^nCy. 
Since M2r is compact, the number of such a 7 is finite. This implies 
the assertion since M is contained in M, for some r. 
D 
We define the subsets F and 1/ of H by 
(1.6.1) 
F=[]Fy 
yer 
= {zeHId{z, ZQ) S d{z, yzo) for all yeF}, 
(1.6.2) 
U= 
f] 
Uy 
yer-Z(r) 
= {zeHM(z,Zo) < d(z,yzo) 
for all 
yeF-Z{F)}. 

22 
1. The Upper Half Plane and Fuchsian Groups 
Let us show that F is a fundamental domain of F. First we are going to show that F 
satisfies condition (i) of the definition of the fundamental domain. Let Zj be any 
point of H. Since F is a Fuchsian group, {yzQ |y eF} has no accumulation point in 
H. Hence there exists the minimum in {d(zi,yzQ)\yer}, 
which we denote by 
d{zi, yo^o) with some yo^T. Since d(zi, yo^o) ^ ^(^i» T^o) for any y eF, we have 
ZiEyoF. Next let us show that U is open and F = U. Take an open neighborhood 
V^ for each point z e H so that V^ is compact. Then 
zeH 
yer-Zin 
We easily see that if Uy^V,^ 
0 , then U^nV^^ V^ or CynV,^ 
0. Therefore it 
follows from Lemma 1.6.1 that f]yer-z{r)i^y^^ 
K) is an intersection of finitely 
many open subsets. Therefore it is an open set, so that U is open. By a similar 
argument, we have that 
zeH 
yer-Zin 
zeH yer-Z{r) 
. 
Since obviously F ^ U, we get F = U. Lastly let us verify condition (iii). Let 
yeF — Z(F). Suppose that UnyU 
^ 0 and ZIGUnyU. 
Since Zje U, we see that 
^(zi, Zo) < f/(zi, yzo) = i/(y"^Zi, Zo). 
On the other hand, since Zj ey[/, we see that 
d(y~^Zi,Zo)<d(y-^Zi,y-^Zo) 
= d(zi,Zo). 
This is a contradiction, and therefore we get (/ n7(7 = 0 for yeF — Z(F). 
Thus we have proved that F is a fundamental domain of F, which is the first 
part of the following 
Theorem 1.6.2. The subset FofH 
defined by (1.6.1) is afiindamental domain of F. 
Moreover^ under the same notation as above, F has the following properties: 
(1) any geodesic joining two points of F is contained in F; 
(2) put Ly = Fn yFfor yeF - Z(r). 
Then LyCzCy. IfLy # 0 , then L, is only 
one point or a geodesic; 
(3) for any compact subset M 0/ H, {y e F | M n yF 7^ 0 } is finite. 
Proof. (1): Since Cy is a geodesic, it is obvious that any geodesic joining two points 
of Fy is contained in Fy. Thus we get (1) since F = f]yFy. (2): Let zeLy. Then 
d{z, Zo) ^ d(z, yzo) = diy~^z, ZQ) ^ d(y- ^z, y~^Zo) = d(z, ZQ). 
Thus zeCy. The latter half of (2) follows from (1). (3): We may assume that M is 
connected. Since 
# { y e F | M n y F # 0 } = ^ {yeFlyoM nyF ^ 0} 

§1.6. Fundamental Domains 
23 
for any yoeF, we may assume Mr\F ^ 0 by taking JQM in place of M, if 
necessary. Assume M nSF i^ 0iox deF — Z(r), then M n Q # 0 . In fact, since 
F = Ply Fy, we see that M nF^^" 0 and M n ^F^-1 9^ 0 . By definition, we see that 
Fs=Us^ 
Q , SFs-i = SUs-i u Q, and H = C/^u^l/^-i u Q (disjoint union). If 
M c= Ug^SU^-i, then M czJJ^ or Mci^l/^-i, because M is connected. This 
contradicts the fact that MnFs¥'0 
and M nSF^-i ^ 0. Then we obtain 
M n Q 7^ 0 . Therefore (3) follows from Lemma 1.6.1. 
D 
For each yeF — Z(F\ we put Ly = FnyF. We call Ly a side of F if L^ is 
neither a null set nor a point. The boundary of F consists of sides of F. For two 
distinct sides L and L' of F, Ln L' is either a null set or a point. When L n L' is a 
point z, we call z a i;ertex o/F m H and the angle between L and L the interior angle 
ofF at z. It follows from Theorem 1.6.2(1) that any interior angle of F is less than n. 
For two sides L, L' of F, we say that L and L' are linked and write L ^ L' if either 
L = L' or there exist distinct sides Lj, L2,. . ., L„ of F such that 
L = Li, 
L' = L„ and L , n L , + i 7 ^ 0 
(1 ^ v < n). 
For a side L of F, the connected component of the boundary containing L is a 
union of all sides L which are linked to L. When a side L of F has no end, we call 
the intersection points of the extension of L and R u {00 } the vertices of F on 
IR u {00 } or the ends ofL on R u {00 }. Here the extension is taken by considering L 
a. part of a circle or a Hne orthogonal to the real axis. The following lemma will be 
used in §1.9. 
Lemma 1.63. Let F be a fundamental domain ofF defined by (1.6.1). If a vertex xofF 
on Uu {00} is an end of two distinct sides and x is fixed by a non-scalar element y of 
F, then x is a cusp of F. 

24 
1. The Upper Half Plane and Fuchsian Groups 
Proof. By assumption, y is either parabolic or hyperbolic. Assume that y is 
hyperbolic. We may assume by Lemma 1.3.2(2) that x = oo and y has another fixed 
point 0. Then we see 7 = 
\ {a^deW.a 
^ d) and we may assume that 
a/d < 1 by taking y" in place of 7, if necessary. Since sides of F are geodesies, two 
sides which have the end 00 are on the lines Re(z) = fej, Re(z) = ^2 with real 
numbers ftj, 62 (^1 < ^2)- Pi^t 
M = {zeH|Im(z) ^ c, b^S Re(z) ^ ^2}-
Then M cz F if c is sufficiently large^ Take zeH on the imaginary axis and 
a neighborhood U of z such that U is compact. Then there exist infinitely 
many integers n such that 
U niy"F ^ U ny"M j^ 0. 
This 
contradicts 
Theorem 1.6.2(3). 
D 
§1.7. Quotient Spaces r \ H * 
Suppose that a group G acts on a topological space X. We begin by giving 
sufficient conditions under which the quotient space G\X becomes a Hausdorff 
space. 
Lemma 1.7.1. Assume that for any two points x, y ofX^ there exist neighborhoods U 
ofx and Vofy such that gJJnV — 0for allgeO satisfyinggx # y. Then G\X 
isa 
Hausdorff space. 
Proof Let n be the canonical mapping of X onto G\X. From the definition of the 
quotient topology, n{U) and n{ V) are neighborhoods of 7r(x) and n(y), respect-
ively. We see that n(U)mi(V) 
^ 0 if and only if there exists geG such that 
gU nV ^ 0. By assumption, the latter is equivalent to saying that there exists 
geG such that gx = y, namely, n(x) = n{y). This implies that G\X is a Hausdorff 
space. 
D 
Lemma 1.7.2. / / a group F acts properly discontinuously on a Hausdorff space X, 
then r\X 
is also a Hausdorff space. 
Proof Let x, y be any two points of X. By assumption, there exist neighborhoods 
UQ of X and VQ of y such that # {y6F|y I/Q n F^ 7^ 0 } < 00. Put 
{yeF|7l/on Ko # 0 } = {7i, 72, . . . , ?«}. 
Renumbering the indices, we may assume that 
y,x = >; ( 1 ^ / c ^ / ) , 
y^x:^y 
( / + l ^ / c ^ m ) . 
We can take neighborhoods Wy_ of y^x and V^ oiyiovk>l 
such that W^r\V^ = 0. 
Put 
k=l+1 
k=l+1 

§1.7. Quotient spaces r\H* 
25 
Then U and V are neighborhoods of x and y, respectively, and we see that 
yUnV^0<i>ye{y^,, 
. . ,yi}oyx 
= y. 
Therefore Lemma 1.7.1 implies that r \ X is a Hausdorff space. 
D 
In particular, the quotient space T \ H of a Fuchsian group T is a Hausdorff 
space. If r \ H is compact or has a suitable compactification, then we can apply the 
theory of compact Riemann surfaces to study r\H. We begin by adding cusps of 
r to H to compactify r \ H . 
Let Pp be the set of all cusps of F and put 
(1.7.1) 
H * = H * = HuP^. 
When r has no cusps, Pr = 0 and H* = H. We put 
(1.7.2) 
I/, = {zGH|Im(z)>/}, 
Uf = Ui^{oo}, 
/ > 0. 
Now we define the topology on H* as follows: 
(i) for z e H, we take as the fundamental neighborhood system at z in H* that 
at z in H; 
(ii) for xePp, we take as the fundamental neighborhood system at x the family 
{(7~^ Uf\l> 
0}, where (TESL2iU) such that ax = oo. 
" [ : : ] 
Then H* is also a Hausdorff space under this topology. In fact, put 
and X = — d/c. Then we see that 
(7-'Ui = {zeH|Im(z)/|cz + d\^ > 1} 
and this is the inside of a circle with the radius (2/c^)" ^ tangent to the real axis at x. 
For xePp, we call a~^Ui a neighborhood of x in H. Since the action of T on H 
is a conformal mapping which maps circles or lines to those, F also acts on the 
topological space H*. Therefore the quotient space T \ H* can be defined and we 
may regard T \ H naturally as a subspace of T \ H*. When F has no cusps, we have 
r\H* = r\H. 
Fig. 1.7.1 

26 
1. The Upper Half Plane and Fuchsian Groups 
Now let us show that T \ H* is also a Hausdorff space. 
Lemma 1.7.3. Assume that oo is a cusp of F and put 
Lety = \^ 
e r . If\ch\ < 1, then 
yeT^. 
Proof. Assume that \ch\ < 1. We define inductively y„er'{± 
1} by 
yo = y, 
y« + i = >''» 
Q i V" 
We write 
'•=[:: y-
then we see that 
a„+i = 1 -a„(c„h\ 
b„^i = a^K 
?„ + i = -ciK 
d„ + i = l -\-a„{c„h). 
Hence we get that 
c„=-c{chr-\ 
|fl„|^|a| + n, 
(n>0), 
and 
\a„^,- 
1| = \d„^,- 
1| = \a„\\c„h\ S i\a\ + n)\ch\K 
Therefore y„ converges to 
. Since F is discrete, there exists n such that 
y« ~ 
n 
1 • ^^^^ implies c = 0. 
D 
Lemma L7.4. Let Xj, X2 be two cusps off, and (T^, (TJ elements ofSL2(U) such that 
(TiXi = (72^2 = 00. Put 
a,r,Mi-''{± '^A-[o iTh^^} ^'='^'^' 
Take two positive numbers /j and Ij satisfying /1/2 > I ^1^21- Then for 
yef, 
y(Ji^Ui^na2^Ui^ 
= 0 
if 
yx^^X2. 
Proof By taking a^Fa^^ and a^ya^^'m place of T and a, we may assume Xj = 00 
and (Tj = 1. Assume that yC/ji n c ^ ^ C/j^ ^ 0 - 
P^t ^ = 0-27 and write 
^~ ^ = 
J • Since dUi. n C/,, ^ 0 , we see that 
Ic 
d] 
IJ2 < Im(^" ^z)Im(z) = \m{zfl\cz 
+ ^1^ ^ c-^ 

§ 1.7. Quotient Spaces T \ H* 
27 
where zeSUi^n Ui^. Put 7i = K. 
. |ei"oo * { ± 1 }• Then we see 
Sy^S'^ 
= (T2yyiy~^<^2^^(^2r(T2^-{± 
i } . 
Put 
''•-=[::::] 
then Cj = — c^/ii and 
\c,h2\ = 
\c^h,h2\<c^hl2S^-
Applying Lemma 1.7.3 to a2ra2^ and (5yi ^ ~ S we obtain c = C]^ =0. This implies 
yoo = (T^ ^<5oo = (T^ ^00 = X2. 
• 
In particular, we obtain by taking Xj = X2 the following 
Corollary 1.7.5. Let x be a cusp of T, and G an element of 5L2(IR) such that 
ax = co.Putar^a~^{±\} 
= \±\ 
\mez\withh>O.Ifl> 
hjhenfor 
yer, 
ya-'UinG-'U, 
= 0 
if 
y^T,. 
Lemma 1.7.6. Let x be a cusp of F, and aeSL2(U) 
such that ax = ao. For any 
compact subset M of H, there exists a positive number I such that 
M nya~'^Ui = 0 
for any yeF. 
Proof Taking GFG'^ and aM in place of F and M, we may assume that x = 00, 
<T=1. Put r « , { ± l } = | ±1 
I meZ i. If yer^, then 7C/,= I/,; other-
wise y l/^ cz {z e HI Im (z) < h^/l} by Lemma L7.3. Therefore it is sufficient to take / 
so that M c {zeH|/iV' < Im(z) < /}. 
Lemma 1.7.7. r \ H * is a Hausdorff space. 
Proof We have only to verify the condition in Lemma 1.7.1 for G = F and 
X = H*. In fact, Lemmas 1.7.2, 1.7.6 and 1.7.4 imply this in the cases (i) x, y eH, 
(ii) XEH, yePrand 
(iii) x,yePp, 
respectively. 
D 
We denote by it or Tip the natural mapping of H* onto r\H*. We call 
a = 7r(z)er\H* (zeH*) an elliptic point or a cusp if z is so. When a is neither an 
eUiptic point nor a cusp, we call a an ordinary point. 
Theorem 1.7.8. IfF\¥l* 
is compact, then the numbers of the elliptic points and the 
cusps o / r \ H * are finite. 
Proof. Let a = n(z) be any point of r\H*. As was shown in the proof of 
Lemma 1.7.7, we can take a neighborhood 17 of z so that for y e F, y U n U ^ 0 if 

28 
1. The Upper Half Plane and Fuchsian Groups 
and only if yz = z. Then n{U) — {a} contains neither eUiptic points nor cusps. Since 
n{U) is open in r \ H * and r \ H * is compact, r \ H * can be covered with finitely 
many n(U). Thus r \ H * has only finite elliptic points and cusps. 
n 
We call r a Fuchsian group of the first kind if T \ H* is compact. Such groups are 
our main objects. 
§1.8. The Structure of r \ H * as a Riemann Surface 
Complex manifolds of dimension 1 are called Riemann surfaces. We are going to 
construct a structure of a Riemann surface on r \ H * . 
We begin by recalling the definition of Riemann surfaces. Let 9? be a connected 
topological space. A pair (V„,tJ of an open subset V^ of 91 and a homeomorphism 
tg, of Ka onto a connected complex domain is called a local chart. A collection 
{(K^ta)} is called a (complex) coordinate system of IR if it satisfies the following 
conditions: 
(i)«=U,K,; 
(ii) if Vg^nVp^ 0 , then tpt^^ ^ is a holomorphic mapping of t^iVg^n Vp) onto 
hiV.rsVp). 
We call Ka a coordinate neighborhood, and t^ a local coordinate on K^. Take another 
coordinate system {(F^,r^)} of 9i. We say that {(V^,t^)} and {(V'^.t'^)} are 
equivalent if {(^a, ^a)} '-^ {(^^» ^^)} is also a coordinate system of %. We call 9? a 
Riemann surface if an equivalent class of coordinate systems of 91 is given. 
Example 1.8.1. The Riemann sphere P = Cu{oo}isa Riemann surface. In fact, let 
Ki = C,ri(z) = z; V2 = P - { 0 } , r 2 ( ^ ) = l/z.ThQn{(Vi,ti)\i-= 
1, 2} is a coordin-
ate system of P. Any connected domain of C is also a Riemann surface. 
Let us now define a structure of a Riemann surface on the quotient space T \H* 
for a Fuchsian group F. Let a = 7r(zo)er\H* (ZOEH*). 
1 ° First assume that a is an ordinary point. From the proof of Lemma 1.7.2, we 
can take a neighborhood U of ZQ SO that U ciH and 
(1.8.1) 
yUnU ¥^0oyeZ{F). 
Put VQ^ n(U). Then V^ is a neighborhood of a and U is homeomorphic to V^ by n. 
Let tg be the inverse mapping of n; namely, 
h'-^a~*^ 
^^^ ta°7t(z) = Z for ZEU. 
2° Next let a be an eUiptic point. Take p e5L2(C) so that pz© = 0 and pH = K. 
Put Wr= {zeCI |z| < r} for r > 0 and U = p~^{ W^). Since ZQIS an elliptic point, 
r^Q is a finite cyclic group by Theorem 1.5.4(1), and so is pF^^p'^. 
Thus by 
Schwarz's theorem, the action of an element of pT^^^p" ^ on K is a rotation around 0 
of angle 2nn/e with neZ and e = \F^JZ{F)\{see 
also the proof of Theorem 1.1.3). 
Hence U is stable under the action of F^^. From the proof of Lemma 1.7.2, we can 

§1.8. The Structure of r\H* As a Riemann Surface 
29 
take r so small that 
(1.8.2) 
yUnU^0oyer,^. 
Then n(U) is homeomorphic to r^o\U, which is homeomorphic to pr^^p~^\ W^. 
We define a function 4) on W^ by 
(/>(w) = w^ 
(e = ir,,/z(r)|). 
Since cj) is invariant under rotation of angle 27r/e'with center 0, it induces the 
homeomorphism (j)^oipr^^p~^\Wr onto W^e. Therefore the following diagram is 
commutative and all horizontal arrows are homeomorphisms: 
71(17) 
We put Kg = 7r( 1/) and define the local coordinate t^ by the homeomorphism of Kg 
onto W^e given in the above diagram; namely, 
t^on(z) = (pzr 
(zeV). 
3° Lastly take a cusp a. Let o be an element of SL2 (IR) such that GZQ = 00. Put 
U = (T-^Ui,U* -=(7-^Uf, where Ui and Uf are as in (1.7.2). If / is sufficiently 
large, then we see by Corollary 1.7.5 that 
yU*nU*¥^0<>yer,^. 
Similar to 2°, VQ is homeomorphic to F^^XU* which is homeomorphic to 
(Tr,^(7-^\Uf. Put (Tr^o(T-i-{±l} = 1 ± 
meZ i with /i > 0, and 
define the function ij/ on Uf by 
^iz) = 
^Inizjh 
0 
for zeUi, 
for z = 00. 
Then </^ is an open continuous mapping by the definition of the topology of H*. 
Since xj/ is invariant under o-rj^tr" ^ \j/ induces a mapping \jf^o{or^^o~^\Uf 
onto 
W^ with r = e"^"^^\ where PT^ is as in 2°. Since ipi is injective and i/^ is open 
and continuous, ij/i is the homeomorphism of a F^^a' ^ \U f onto W^. Therefore if 
we put Kg = 7c( 1/ *), we obtain the following commutative diagram: 
Vs = niU*) 

30 
1. The Upper Half Plane and Fuchsian Groups 
We define t^ as the homeomorphism of Kg onto W^ in the above diagram; namely, 
^ 
^ ^ 
' 0 
for z = Zo-
We can easily verify that {(Kg, tg)} given above is a coordinate system of r \ H * , 
and defines on r \ H * a structure of a Riemann surface. We denote by 9?/-the 
Riemann surface r \ H * . For a = 7r(zo)e9i/^, we put 
(1.8.3) 
e, = \rjZ(r)l 
and call it the ramification index of a, which is independent of the choice of a 
representative element ZQ. We note that e^ = 1 imphes a is an ordinary point and 
that ^a = 00 implies a is a cusp. 
Theorem 1.8.1. If r\H is compact, then F has no cusps. 
Proof Assume that F has a cusp x. Put a = n(x)eF\il*. 
Then from the above 
consideration, we can take a neighborhood Kg of a so that 
VQn{F\H) 
= Fa — {a} ~ {zeC|0 < |z| ^ r} for some r > 0, where VQ denotes the closure of 
Fa in r \ H * . Since F a n ( r \ H ) is a closed subset of r \ H , it is compact; this 
contradicts that { z G C | 0 < | z | ^ r } i s not compact. Therefore F has no cusps. D 
If r is a Fuchsian group of the first kind (this is the case we shall discuss in 
Chapter 2 and onwards), 91/^ is a compact Riemann surface. In the following, we 
recall some results on compact Riemann surfaces which we need afterwards. See, 
for example, [Lang] for proofs. 
Let 91 be a compact Riemann surface and {(K^, t„)} a coordinate system of 9?. 
Let </) be a function defined on V^^ and ae F^,. We say that </> is holomorphic (resp. 
meromorphic) at a if (I) ° t~ ^ is holomorphic (resp. meromorphic) at ^^(a). We also 
say that 0 has a pole or a zero at a if so does (/> o t~ ^ at ^^(a). If </> is meromorphic at 
a, then it has a Laurent expansion of the form 
00 
4>ot;y{z)=^a„(z-tMr 
(a,^0) 
n = l 
on a neighborhood of ^^^(a). We write 
(1.8.4) 
Va(</>) = /, 
and call it the order ofcp at a. We note that these definitions are independent of the 
choice of coordinates r^. We say that a function </> on 9? is holomorphic (resp. 
meromorphic) if it is holomorphic (resp. meromorphic) at any point of 9?. We denote 
by X(9l) the field consisting of all meromorphic functions on 91. Since 9? is 
compact, any holomorphic function on 9? must be constant by the maximum 
principle and K(9?) is an algebraic function field of one variable. We simply call 
K(9^) the function field o/9^. For a non-constant function 0 of K(9l), the numbers of 
zeros and poles are finite and we put 
(1.8.5) 
no((/>)= 
S 
Va((/>), 
/i^((/>)= 
X 
|va(0)|. 
V (</>)> 0 
V (</))< 0 

§1.9. Fuchsian Groups of the First Kind 
31 
It is known that 
(1.8.6) 
[K(9?):C((/>)] = no(0) = n^(0). 
Let % 91' be two compact Riemann surfaces and F a mapping of ^' into 9^. 
Take coordinate systems {(F^, t^)} and {(K^, t'^)} of 9? and 9?', respectively. We say 
that F is complex analytic if t^^F'^t'f^ is holomorphic on ^^(^^^^"^(^3^)) 
providing F(F^)n K„ 7^ 0 . In particular, meromorphic functions on 9? are no 
other than complex analytic mappings of 9? into the Riemann sphere P. Let F be a 
complex analytic mapping of 9?' into 91. Assume that the image of F is not one 
point. Then it is open. Since 9?' is compact, it is also closed. Therefore we get 
F(9i') = 9i, since 91 is connected. Under this situation, we call (91', F) or simply 9?' 
the covering of 9?. Moreover we define, for b e 9i', 
providing F[b)e V^, and call it the ramification index o/(9?', F) at b or simply the 
ramification index ofb. Since 9?' is compact, the number of points b of 9?' such that 
e^ F # 1 is finite. Let F~^{a) = {b^, . . . , bJ for ae^, 
then the integer 
is independent of the choice of a. We call n the degree of the covering (9t', F). We see 
0 ° FG K(9i') for 0 GX(9l). This correspondence "0 1-^ (/> Q F " is an isomorphism of 
iC(9{) into A:(91'). Write /C(9J)oF = { 0 O F | 0 G K ( « ) } ; then it is known that 
(1.8.7) 
[K(9i'):X(9?)oF] = n. 
The equality (1.8.6) is a special case of (1.8.7). 
Lastly let x be the Euler-Poincare characteristic of 9?. We define the genus g of 
9? by 
X = 
2-2g. 
Then ^ is a non-negative integer. If (W, F) is a covering of 9t and ^' is the genus of 
9i', then the following relation (the Hurwitz formula) holds: 
(1.8.8) 
2^' - 2 = n(2^ - 2) + ^ K F - 1), 
where n is the degree of the covering (9^', F). 
§ 1.9. Fuchsian Groups of the First Kind 
Let r be a Fuchsian group. For a while we do not assume that F is of the first kind. 
We are going to define a measure on the quotient space r \ H * induced from the 
measure dv on H defined by (1.4.2). Let X be a locally compact space, and Cc(X) the 
space of the continuous functions on X with compact support. For any linear 
functional M on C^X) satisfying M((/>) ^ 0 if (/> ^ 0, there exists a measure dfi on 

32 
1. The Upper Half Plane and Fuchsian Groups 
X such that 
X 
We are going to construct such a linear functional on Cc(r\H*). In the following, 
we use the same notations as in the previous section. Let ^ e Cc(r\H*). Using the 
partition of unity, we may assume that the support of </> is contained in the 
neighborhood Ka(aer\H*). 
r Assume that a is either an ordinary point or an eUiptic point. Let ZQ be a 
point of H such that 7r(zo) = a, and U a neighborhood of ZQ such that %{U)= VQ. 
Since </> o TT is a continuous function with compact support on H, we can define 
M{<l>) = -i<t>^n(z)^ 
(<<»), 
^a u 
y 
where BQ is the ramification index of a. This definition is obviously independent of 
the choice of ZQ. 
2° Let a be a cusp, XoelRu{oo}a point such that 7r(xo) = a, and a an element 
of 5L2(IR) such that GXQ = oo. Moreover let U* = a~ ^ Uf be a neighborhood of XQ 
such that n{U*) = V^. Put I/; = {z6H||Im(z)| ^ /, 0 ^ Re(z) ^ /i}, then 4>on is 
continuous on l/J. We put 
M ( 0 ) = 
j 
ct>on(z)^. 
a-'u\ 
y 
dxdy 
To see that M(</)) is finite, we have only to prove ]a-^u',—2~ ^^ fii^ite, since </)0 7i 
is bounded on (7~'^U[. Since y'^dxdy is invariant under the action of SL2(U), 
we have 
J. dxdy 
J. dxdy 
J ~7i2~ = J 
2 • 
a-'u', y 
u', y 
This is finite by Lemma 1.4.4. The value M(</)) is obviously independent of the 
choice of XQ and a. 
We denote by dv the measure on r\H* attached to the linear functional M. Let 
F be a fundamental domain of T, then by definition, we see 
t;(r\H*) = v{r\H) = v{F). 
Moreover, if ^ is a measurable set of H, then 7r(^) is also measurable on r \ H and 
we have the inequality 
v{A) ^ v(n(A)). 
Theorem 1.9.1. (Siegel) Let F be a Fuchsian group. Then F is of the first kind if and 
only ifv{F\H*) 
is finite. 
Proof. The only-if part is obvious. Assume that t;(r\H*) is finite. Let F be the 
fundamental domain defined by (L6.1). Take an interior point w of F. Let C be a 
connected component of the boundary of F, and {Lf^}^=M{—oo ^ M ^ N -^ oo) 
all the sides of F contained in C. We assume that L^ and L^^ i lie side by side. If C is 

§1.9. Fuchsian Groups of the First Kind 
33 
a closed curve, then F is compact. Therefore r\H* = r \ H = 7r(F) is also compact 
and r is of the first kind. Now assume that C is not a closed curve. Let Zf^ and z^+i 
be the vertices of L^^. Let A^^ be the triangle (whose sides are geodesies) determined 
by three vertices w, z^, 2;^+1, and let a,^, j^^, y^ be the interior angles at the vertices w, 
Z|t, Zjt+1, respectively. Put co^ = y^. ^ + j?jt (M < /c ^ AT), then co^^ is the interior angle 
of F Sit Zfc. Since the area of Af, is given by 
v{Ak) = n-{cCk-\-Pk + yk) 
by Lemma 1.4.4, we see that 
(1.9.1) 
S "(^i) 
k = m 
£ 
(n-cOk)-\-{n-P^-y„)- 
Y^ci^ (m # n), 
k=m+1 
k=m 
T^-^m-Pm-ym 
(^ = «), 
for integers m, n such that M^m^n^N. 
UN is finite, then Zjv+ielRu{oo} and 
7JV = 0; otherwise, since only finitely many Lj^ intersect with a compact subset of H 
by Theorem 1.6.2(3), there exists a subsequence {zj of the sequence {z^} such that 
limj_oo d(w, Zi) = 00. Therefore, there exist infinitely many positive integers k such 
that d{w, Zfc) < d(w, z^+i). Thus ^^ ^ y^* ^^^^ therefore y^ ^ 7r/2. In fact, the longer 
the side is, the larger the opposite angle is. (This can be easily verified by mapping 
the triangle into the unit disk with w to the origin.) Similarly, if M is finite, then 
PM = 0; otherwise, there exist infinitely many negative integers k such that 
Pk ^ n/2. Therefore we get the inequalities 
(1.9.2) 
N 
I 
k = M 
Z v(A,) ^ \ t (n-m,)- t a, (N > M), 
k = M+l 
k = M 
from (L9.1). Since we have these inequalities for all connected components of the 
Zk-l 
Zk+2 
Zk+i 
Fig. 1.9. 

34 
1. The Upper Half Plane and Fuchsian Groups 
boundary of F, we obtain, summing them over all components, the inequality 
(1.9.3) 
v{F) + 271 ^ X(^ - ^) + ^'^' 
CO 
where co runs over all the interior angles of F in H, and I' is taken over all the 
connected components of the boundary which themselves are sides (namely, 
N = M). In particular, 
(1.9.4) 
the number of the components consisting of one side is finite, 
and for any £ > 0, the number of the interior angles w such that n — o^eis 
also 
finite. In particular, taking e = n/3, we get 
(1.9.5) 
the number of a> such that co ^ 2n/3 is finite. 
Now let z be a vertex of F in H. Since # {yer\y{z} nF ^ 0} is finite by 
Theorem 1.6.2(3), there are only finitely many vertices of F equivalent to z by F. We 
write them as Zi = z,Z2 = 72^* • • • » ^i = Vi^ (Vv ^ ^)' Let a>^ be the interior angle of 
F at z^ (1 ^ V ^ /). Then 
(1.9.6) 
(Wi + • • • + c«, = Inle 
(e = |F,/Z(F)|). 
In fact, we can take a neighborhood L/^ of Zj so that 
(1.9.7) 
yU,nU,^0oyeF,^, 
and 
(1.9.8) 
{yeFlyC/i n F # 0 } = {7eF|y{zi} n F ^ 0 } . 
Put F\, = U^r\y~^F. U fi^v, then yF^nF^^ is either empty or a part of the 
boundary of F^ for any yeF^^ — Z(F). In particular, the interior angle of[J[^^F^ 
at Zi is equal to cwi + • • • +co,. Moreover, let u be any point of C/i. Since F is a 
fundamental domain for F, there exists yeF such that yueF. Then yU^nF ^ 0, 
Therefore by (1.9.8), we can write y = y^^o with yQ eF^^. Since yoU = y~ ^yu, we get 
^oweFy. This proves that Uyer^ y(UUi^v) = ^i- Since the action of F on H is 
conformal, we obtain equahty (1.9.6). 
Now a side of F is either an arc or a line orthogonal to the real axis by Theorem 
1.6.2(2), so that 0 <o)^ <n. Therefore, applying the equahty (1.9.6) (considering the 
cases e = l,e = 2ore>2, separately), we see that there exists at least one co„ such 
that cOy ^ 27r/3. Hence if F has infinitely many vertices in H, there exist infinitely 
many interior angles o satisfying co ^ 27r/3; this contradicts (1.9.5). Therefore the 
vertices of F in H are finite. Hence (1.9.4) implies that the number of the connected 
components of the boundary of F is finite, and also that 
(1.9.9) 
the number of the sides of F is finite. 
Next we shall prove that the summation of a^ taken over all the sides of F is equal 
to ln\ in other words, F is completely covered by triangles Aj^. In fact, suppose that 
it is not true. Then there exist two distinct geodesies passing through w such that 
they have no ends and the domain between them is included in F. Therefore F has 

§1.9. Fuchsian Groups of the First Kind 
35 
infinitely many triangles whose vertices are on IR u {oo}. Since the areas of these 
triangles are TT, we get t;(F) = OO; which is a contradiction. 
Since F is a polygon whose sides are geodesies, any vertex x of F on IR u {oo} is 
the ends of two distinct sides of F. Let us show that x is a cusp of F. Let Lj be a side 
of F which has x as its end. By definition, there exists yi G F such that 
Li = F 
njiF. 
Since yi^L^ = 7;" ^ F n F, yj" ^ L^ is also a side of F and yf ^ x is also a vertex of F 
on IR u {00}. Put Xi = X and X2 = yf ^^1 • Let L2 be the other side of F which has 
X2 as the end. Similarly as above, there exists y2^r such that L2 = Fny2F, 
and 
X3 = ^2 ^ X2 is also a vertex of F on IR u {00}. Repeating this process, we obtain the 
sequences {x^} of the vertices of F on IRu {00} and {y^} of the elements of F 
satisfying yjT^^fc = ^jt+i- Since the vertices of F on IR u {00} are finite, there exist 
integers m, n (m < n) such that x„ = x„. Therefore, we get yx^ = x„ with 
y = y~}] . . , y~^. Since x^ is a cusp of F by Lemma 1.6.3, x is also a cusp of F. 
Let {xi,. . . , x j be the set of all vertices of F on IR u {00}. We shall show that 
any cusp xofFis 
equivalent to some x^. Let U*(l ^v ^t) be the neighborhood of 
Xy such that 
U* = (T;I C/f, 
(T,x, = 00 ((7,eSL2(IR)). 
Since F —\J[^^U* is bounded, it is compact. Assume that x is not equivalent to 
any x^. Then, by Lemmas 1.7.6 and 1.7.4, we can take a neighborhood U* of x 
satisfying 
(^-M^0= 
yl/*n(F- U C/J 1 = 0, 
yU*nU* = 0 
(l^v^t) 
for any yeF. In particular, y I/* n F = 0 for any yeF. This contradicts the fact 
H = \JyeryF' Therefore any cusp of F is equivalent to some x^. Consequently we 
obtain 
F\H* = 7 r ( F u { x i , . . . , x J ) 
= 7i(^F-U^C/r)u(^U^7r(C/;)^. 
Since F — \J[^^U* and the closures of n{U*ys in F\H* are compact, F\H* is 
compact. 
D 
Corollary 1.9.2. Let F be a Fuchsian group of the first kind. Any subgroup of F of 
finite index is also of the first kind. 
Proof Let Fj be a subgroup of F of finite index, and put F = \J^^ 1A Tv Let F be a 
fundamental domain of F and TTJ : H -• Fj \ H the canonical projection. Then, since 
^i(Uvyvi') = ^i\H,wesee 
m 
t;(Fi\H) ^ X ^(yyF) = ^^i^) 
= rnv(F\H) < 00. 

36 
1. The Upper Half Plane and Fuchsian Groups 
Therefore F^ is of the first kind. 
D 
The following corollary is proved in the proof of Theorem 1.9.1. 
Corollary 1.9.3. Iff is a Fuchsian group of the first kind, and F is the fiindamental 
domain ojF defined by (1.6.1), then any vertex ofF on U KJ {oo} is a cusp ofF and any 
cusp of F is equivalent to a vertex o/F on IR u {oo}. 

Chapter 2. Automorphic Forms 
In this chapter, we explain the general theory of automorphic forms. Hereafter 
Fuchsian groups always denote Fuchsian groups of the first kind. 
§2.1. Automorphic Forms 
"[: > 
Let a = 
J P^ ^^ element of GL2 (U). We put; (a, z) = cz + ^ as in (1.1.2). This is 
a holomorphic function on H without zero. We recall the basic properties of j(a, z), 
since they are often used. 
Let a, PeOmU) 
and zeH. Then 
(2.1.1) 
7(aft z) =7(a, MJiP, 4 
7(a"S z) =j(a, 
oi-'z)-'; 
(2.1.2) 
rf(az)/Jz 
= det(a)//(a,z)2; 
(2.L3) 
Im(az) = det(a) Im(z)/|7(a, z)\\ 
Moreover, by (2.1.1), we see that 
(2.1.4) 
7(a, z) = const.;()?, z)^(xr'^ 
GLUmoo • 
Let k be an integer. For any function /(z) on H, we define the action of an 
element a of GL2 (K) by 
(2.1.5) 
(Aa)(z) = det(a)'^/27(a,z)-V(a^) 
(zeU). 
By (2.1.1), we have 
(2.1.6) 
A«P = ifMkP 
(a,peGmU)). 
For scalar matrices, we see in particular, 
(2.1.7) 
/ | , P ^1 = sgn(a)V 
(a # 0). 
Let r be a Fuchsian group and k an integer. A meromorphic function/(z) on H 
is called an automorphic form of weight k with respect to F or simply a 

38 
2. Automorphic Forms 
r-automorphic form of weight /c, if it satisfies 
f\ky=f 
for all elements yeP. 
We denote by QkiP) the set of all automorphic forms of weight k with respect to 
r. Then Qk(r) is a vector space over C and 
(2.1.8) 
ifr ID r\ then Q^iF) a Q^{r'); 
(2.1.9) 
iffeQkin 
and a6GLj(IR), then f\kOCGQk(oi~^roc); 
(2.1.10) iffeQ,(r) 
and geQ,(n 
thenfgeQ,^i(r). 
Furthermore by (2.1.7), we see that 
(2.1.11) 
ifk is odd and -1 eT, then Q j r ) = {0}. 
Let Q{r)bQ the module generated by all ^^(r); namely 
Q(r)= 
X 
Q,{r). 
k=-oo 
Then we have 
Lemma 2.1.1. The module Q(r) is a graded ring. 
Proof By (2.1.10), Q(r) is obviously a ring. Now it follows from (2.1.4) that for 
elements a, j5 of T, 
7(a,z)=7(i5,z)oai5-^er^. 
Since we have i;(r\H)<oo and the measure of r ^ \ H is not finite, F/F^ is an 
infinite set. Therefore there exists a set {y„}^=-oo of the elements of F such that 
jiyn.z)^j{ym^z) 
if 
n^m. 
Suppose 
N 
k = M 
with fkeQk(F). Then we see 
k = M 
k = M 
E 7(y™,z)'A(z)= I /»(?„z) = o 
for any y^. Consider these equations for m (M ^ m ^ N) as a system of the Hnear 
equations on f^iz) (M^k^N) 
with the coefficients7(7^, zf. Since 
dctij(y^,zf)=± 
n 
Jiym.z)'' 
n 
U(ym.z)-j(y„,z)l 
N n 
m = Af 
which does not vanish on H, we get /^ = 0 for all fe (M ^ fc ^ N). 
D 
Assume that T has a cusp x. Let a be an element of SL2(U) such that crx = 00. 

§2.1. Automorphic Forms 
39 
Then by Theorem 1.5.4(2), we have 
(2.1.12) 
^ r , a - i - { ± l } = | ± r j j T l m e z j 
(h>0). 
Suppose that k is even. Since flf^G'^eQ^icrra'^) 
for feQ,^(r), 
we have 
( A ^ " ' ) l J j j l = A ^ " S namely, 
(Aa-'){z 
+ h) = 
(Aa-'){z). 
Therefore there exists a function g(w) on K —{0} such that 
(2.1.13) 
(f\,cT-')(z) = g(e'^'^i') 
(zeH), 
where K is the unit disk. Since/is meromorphic on H, g is so on K —{0}. We say 
that an element/of Qk(r) is meromorphic, is holomorphic, or has a zero at x, if the 
above function g is meromorphic, is holomorphic, or has a zero at 0, respectively. 
When k is odd, we say that/is meromorphic, is holomorphic, or has a zero at x when 
/^ is meromorphic, is holomorphic or has a zero at x, respectively. 
Lemma 2.1.2. The above definitions are independent of the choice of a. 
Proof We have only to prove our assertion for an even integer k. Let feQ^(r), and 
X be a cusp of F. We take o, h, g{w) as above. Let o-j, /ii, gfi(w) be another triple. 
Then we can write ^f^ = ^ M ^^ -i 
» since GG^^ OO = OO. We see easily that 
hi = h/a^ and 
g^{w) = a''g(cw) (weK), 
c = e^''''""\ 
This proves the assertion. 
D 
We are going to consider Fourier expansions of automorphic forms at cusps. 
Suppose that feQk(r) 
is meromorphic at a cusp x of T. Take GeSLjiU) and 
/i > 0 as above. First assume k is even, and let ^ be a meromorphic function on K 
defined by (2.1.13). Denote the Laurent expansion of gf at 0 by g{w) = YJ^=N ^n^" 
(a^ # 0). Then we have the expansion of the form: 
(2.1.14) 
(f\^cT-'){z)= 
X 
ay^' 
Ininz/h 
n = N 
on {zeH|Im(z)>/} for a sufficiently large /. Next suppose that k is odd and 
— 1 ^ r . From the above result,/^12k<T"^ = (/IfcO""^)^ has such an expansion as in 
(2.1.14). Since we see 
(f\^-^\(.Mh\ 
I ( A ^ ' ' ) ( ^ ) 
i f x i s a r e 
(f\,G 
)(^ + '^)={_(^|^,-i)(,) 
otherwise. 
regular cusp, 

40 
2. Automorphic Forms 
we get the expansion 
X a^e""'""^ (as^O) 
if x is regular. 
(2.1.15) 
(f\,c7-'){z)= 
^ 
n:even 
a„e"'"^/'' 
(a^ # 0) 
otherwise. 
i^ n:odd 
on {z e HI lm(z) > 1} for a sufficiently large /. We call (2.1.14) and (2.1.15) the Fourier 
expansion of f{z) at a cusp x. The series in (2.1.14) and (2.1.15) are convergent 
absolutely and uniformly on any compact subset of {zeH| Im(z)>/}, and so also 
are on any compact subset of H if/(z) is holomorphic on H. Further we note that 
/(z) is holomorphic {resp. has a zero) at x if and only if N^O (resp. N>0). 
For a Fuchsian group T, we put 
^fc(^) = {/G^k(^)l/is meromorphic at all cusps of T}; 
^^{r)={fGQk(r) 
I / i s holomorphic both on H and at all cusps of T}; 
^fc(r) = {/e(2|t(r)|/is holomorphic on H and has a zero at each cusp of T}. 
We call the elements of ^fc(r), ^^(r) and ^k{r) meromorphic automorphic forms, 
integral forms and cusp forms, respectively. The spaces s/k{r), ^^(r) and ^kiH 
are 
vector spaces over C, and we easily see the following: 
(2.1.16) Qk(n ID ^,(r) =3 ^,(r) ^ ^,(r); 
(2.1.17) ifr has no cusp, then Q^in^j^kin 
and ^kir^^^kiH; 
(2.1.18) for any aEGL^([R), the mapping "/i-^/lfca" gives the following iso-
morphisms: 
^,(r)^^,(a-'roL), 
^,(r)^^»(a-'ra), 
^,(r)^^,(a-'ra); 
(2.1.19) iffej^.^n 
andf¥^ 0, then l//6^_,(r); 
(2.1.20) iffes^tin 
and ge^,ir), 
thenfge^t^m, 
(2.1.21) iffe%(r) 
and ge^,(n 
thenfge^,^,(r); 
(2.1.22) iffe%(n 
and ge^,{n, 
thenfge^,^,(r). 
We also put 
^(r)=^^^(r), nn=i%{n ^(r)=x^*(n. 
k 
k 
k 
Since Q(r) is a graded ring, we see that 
(2.1.23) 
^(r), ^(r) and ^(r) are graded rings. 
Moreover, (2.1.19) and (2.1.20) imply that ^oiH 
is a field. We call J^oiH the 
automorphic function field with respect to F and the elements of J^Q(F) automorphic 
functions with respect to F. Let f be an automorphic function with respect to F. 
Since (/loy)(2)=/(y^)» we can write 
f{z) = (l)onr(z) 
with a meromorphic function </> on r \ H . Moreover, since/(z) is meromorphic at 
each cusp of F, (f) is a. meromorphic function on the Riemann surface 'tRp. 

§2.1. Automorphic Forms 
41 
Conversely, if 0 is an element of the function field X(9l j-) of 91 j^, then the function 
f{z) defined by/(z) = 0 o np(z) (zeH) is obviously an element of s^o(r): Thus we 
obtain that 
(2.1.24) K(^r) is isomorphic to ^o(r) through the correspondence "</> i—• </>o7r/'. 
Lemma 2.1.3. Let F bea Fuchsian group and F' a subgroup ofF of finite index. Then 
we have: 
^,(F) = Q,iF) n ^,(r'), %(F) = Q,iF) n %{F'), 
^,(F)= Q,{F) n ^,(F'). 
In particular, s/,(F) c: s/,(F'l <^,(F) ^ <^,iF'), ^,{F) ^ ^,(r'). 
Proof. We have only to prove the equahties for even weights. We will prove the 
lemma only for cusp forms. Other cases can be proved similarly. If F has no cusp, 
the assertion is obvious; otherwise, it is sufficient to ascertain the conditions at 
cusps. If X is a cusp of T, then it is also a cusp of F' by Corollary 1.5.5. Take an 
element a of SL2(IR) and h>0 satisfying (2.1.12), and put / = [r^• {± 1}: r;• { ± 1}]. 
By assumption, / is finite and we get 
,Tr>-{±l} = |±[J|''J|m6zJ. 
Let/be an element of ^n(r), then we have the Fourier expansion of the form 
I«. 
^Ininlzjlh 
which is the Fourier expansion of / at x as an element of Qk(^'). Hence by 
Corollary 1.5.5, we obtain/e^uiT'). Conversely, suppose/e Qj,{F) n ^'^(r'). Then 
it has the Fourier expansion at x: 
(/|,(7-i)(z)= f a„e2--/'\ 
Since/ belongs to Qk(F\ we have (/lkO-~^)(z + /i) = (/|fc(T~^)(z). Hence a„ = 0 
unless n is divisible by /, and we have 
n = l 
which is the Fourier expansion of/at x as an element of Q^i^). This implies that/ 
belongs to ^i,(F). 
D 
Theorem 2.1.4. Assume thatfeQ^JX) is holomorphic on H. If there exists a positive 
real number v such that 
/(z) = 0(lm(z)-^) 
(Im(z)^O) 
uniformly with respect to Re(z), then f belongs to ^fc(r). Moreover if we can take v so 
that v</c, then f belongs to 6^k(F). 

42 
2. Automorphic Forms 
Proof. We may assume that k is even. If r \ H is compact, the assertion is obvious. 
Suppose that F has cusps, and let x be a cusp of F. First suppose x is on IR. Take 
(JGSL2(U) 
SO that ax = oo, and let /i be a positive real number satisfying (2.1.12). 
Then f\k(T~^ has the expansion of the form: 
00 
n= 
— 00 
which is uniformly convergent on any compact subset of H. The coefficient a„ is 
expressed as 
(2.1.25) 
''n = l^^i' {Aa-'){z)e-'"'"^''dz 
" zo 
for any fixed ZOGH. Write cr~^= 
I, then c # 0. Now Im(<7~^z) 
Ic dJi 
= Im(z)/|cz + ^P = 0(l/Im(z)) (lm(z)-^ oo) uniformly on |Re(z)| ^ h/2. Then by 
assumption, we have 
(2.1.26) 
(f\,a-')(z)=f{a-'z)j(<j-\z)-' 
= 0(lm(z)^-*) 
(Im(z)^oo), 
uniformly on |Re(z)\Sh/2. Taking ZQ = iy-h/2 in (2.1.25), we get 
|aj = 0(/-*e2""^/'') 
(y^oo). 
Thus if n < 0, then a„ = 0. Moreover if v < /c, then QQ = 0. In other words, /(z) is 
holomorphic at x, and if v < /c, then/(z) has a zero at x. Next suppose x = oo. Then 
since T is of the first kind, we have F ^F^. Thus for 7 e T — T^, a real point 700 is a 
cusp of F equivalent to 00. Therefore/(z) is holomorphic at all cusps of T, and if 
V < /c, then /(z) has a zero at any cusp. 
D 
Theorem 2.1.5. Let f(z) be an element of Qf,(F). Then f(z)e6^kin 
if and only if 
f(z)lm(zf'^ 
is bounded on H. 
Proof We may assume that k is even. The if-part is obvious by Theorem 2.1.4. 
Conversely, let/(z) be a cusp form and put g(z) = |/(z)|Im(z)*^^. Since g{yz) = g{z) 
for any ysF, we may regard g(z) as a continuous function on F\H. If F\H is 
compact, then g{z) is bounded on r \ H , and therefore bounded on H. Assume that 
F has cusps. Since F has only finitely many inequivalent cusps, we have only to see 
that g(z) is bounded on a neighborhood of a cusp of T. Let XQ be a cusp of T, and a 
an element of SL2(U) such that ^XQ = 00. Take a positive real number h so that 
'^r,„<T-'{±l} = { ± r j 
i T k ^ ^ j , and let {Ac-'m 
= l^:^, 0^""'" be 
the Fourier expansion of/at XQ. Then we see 
g{G-'z) = \(f\,a-'){z)\lm(zr' 
£ 
a„e^"'"^/'' Im(z)*/^ -• 0 
(Im(z) - 00). 

§2.1. Automorphic Forms 
43 
Thus g(z) is bounded on a neighborhood of XQ. 
• 
Corollary 2.1.6. Letf(z) be an element of^ki^^)^ XQ a cusp off and a an element of 
SL2(U) such that CTXQ = oo. Let 
n= 1 
be the Fourier expansion offat XQ. Then we have 
a„ = Oin"'). 
Proof. Put g(z) = {f\k(T~^){zl then g(z)e^j,(ara~^). By Theorem 2.1.5, there 
exists a constant M > 0 such that \g(z)\ ^ MIm(z)~*/^. Therefore we get 
1""! = ^ 
2ft 
jg(x + yi)e-'''"^''^y'^'^dx\ 
0 
< My'^'^e^"^''*. 
In particular, taking y = 2/n, we obtain \a„\ ^ Ln''^^ with L = Me^"/''2~*/^. 
D 
We note that the estimate of the Fourier coefficients a„ in Corollary 2.1.6 is not 
best possible. In fact, when T is a congruence modular group, it is proved that 
a„ = p(«(*-^)/2) (c.f. Theorem 4.5.17). 
It is convenient to generalize the notion of automorphic forms to automorphic 
forms with a character. Let T be a Fuchsian group, and x a character of F of finite 
order. Put F^ = Ker(x). Since it is a subgroup of F of finite index, it is also a 
Fuchsian group. We put 
Odr.x) = {feQ,ir,)\f\,y 
= xW/for any yeF}, 
%(F,x) = ^kir,x)r^%{F,l 
In particular, if x =1, then Q,(F, x) = Ouin ^kir. x) = ^.(r), %(r, x) = %(n 
^k(r, X) = ^kiry We call the elements of ^fc(r, x) automorphic forms of F with x-
By definition, we easily see the following (2.1.27) through (2.1.31). 
(2.1.27) 
Suppose - 1 er. //x(-1) # ( - l)^ then Q,(F, x) = {0}. 
(2.1.28) 
Let F' be a subgroup of F^^ of finite index. Then we have: 
^,(r,x) = r2,(r,x)n^,(r'), 
^,(r,x) = Ofc(r,x)n^,(n, 
^,(r,x) = D,(r,z)n5^,(r'). 
(2.1.29) 
Let F' be a subgroup of F of finite index. We also denote by x the 

44 
2. Automorphic Forms 
restriction of x to F'. Then we have 
^,(r, X) c: ^,(r\ x\ %{r, x) ^ %ir\ x\ ^^(n x) ^ ^kir\ xl 
(2.1.30) 
Iffe^.ir, 
x) and ge^i{r, 
i/zl thenfgGs/.^^ir, 
# ) . 
(2.1.31) 
Let a be an element ofGL2 (U). Put F' = cc~^F<x, and define the character 
X' of F' by x'(^~^yo(.) = x(y)- Then we obtain the following isomorphisms by the 
correspondence "/ •—•/I ^ a ": 
j^,(F,x)^^kir\x'l 
^,iF,x)^'^kir\x'l 
^,{F.x)^^kir\x'y 
Let /(z), g(z)E^k{F,x)- 
Assume that either /(z) or g(z) is a cusp form. 
Then/(z)sf(z)ey'2fc(Az^), and therefore, |/(z)^(z)|Im(z)* is bounded on H by 
Theorem 2.1.5. Furthermore if yeT, then 
f{yz)g(yz) \m{yzf =f(z) g{z) lm{z)\ 
Hence jr\H/(^)^(^) ^^{zfdv{z) is meaningful and finite. We put 
(2.1.32) 
(/, g) = v(F\U)-' 
J /(z)^Im(z)*rft;(z), 
r\H 
and call it the Petersson inner product (though it is defined only when either/(z) or 
g(z) is a cusp form). It induces an Hermitian inner product on ^^(r, x)-
Let Fi and F2 be two Fuchsian groups, and XnXi characters of Tj, r2 of finite 
order, respectively. Assume that there exists a Fuchsian group F' contained in 
Ker(xi)nKer(/2). For/(z)G5^fc(ri,/i) and ^(z)e^fc(r2, Z2X we can define the 
Petersson inner product (/, g) by considering/(z) G ^^i^') and g(z) e ^^(r'). We see 
easily that 
(2.1.33) 
(/, g) is independent of the choice of F'. 
We put 
^,(F) 
= {ge^,(F)U 
^) = 0 for all/e^,(r)}, 
and 
^fc(A X) = {g^^kir. x)U^) = 0 for all/G^,(r, x)}-
Theorem 2.1.7. (1) ^,(r, x) = ^kir, x) 0 ^ . ( r , x)-
(2) Let F' d F, and x! be the restriction of x to F. Then 
^k(r,x) = ^kir\xlr^%{F,xy 
Proof ([Shimura 12]) The first assertion is an easy exercise of Linear Algebra. Let 
us prove (2). There exists a normal subgroup F" of F of finite index included in 
Ker(x). We are going to show that J^ki^, x) ^ -^fc(^"). Let giz)Gjr,^(F, x)- Since 
gf(z)e^jfc(r"), we can write 
giz) = g,{z) +/i (z), 
g,(z)e ^ , ( r " ) , /i (z) e ^,(r"). 
Let yeF. Then g\ky = xiy)d- Since ^fc(r") is stable under y and (/ijy, ^2) = 
(/ii, /1217 ~ ^) for any /ij e ^^(r"), /12 e ^^(r"), the space J^ki^") is also stable under y. 
Thus 

§2.2. Differentials on Compact Riemann Surfaces 
45 
Then gi\ky = x{y)Qi ^ind fi\ky = xiy)fi by applying (1) for T' and the trivial 
character. This implies/i(z)G^fc(r,x), and 
(/i J i ) = (9-giJi) 
= (gJi) - (91 Ji) = 0. 
Therefore/i (z) = 0 and g{z) = giiz)ejr^(r"). 
Since ^^Cr', /) ^ ^kiri, 
we have 
{f,g) = 0 
forany/(z)e5^,(r,/). 
This implies g{z)eJ^kir\ 
xl- Obviously the right-hand side is included in the left-
hand side. 
D 
§ 2.2. Differentials on Compact Riemann Surfaces 
Let 91 be a Riemann surface, and m any integer. The set {(0^, K^, t^)} consisting of 
the triples (0^, K^, r^) of a coordinate neighborhood V^ of % a local coordinate r^ 
on V^ and a meromorphic function 0^ on V^ is called the local expression of a 
differential of degree m, if the following conditions are satisfied: 
(i) {(Vfi, tf,)} is a coordinate system 
of^; 
(ii) (t)^(a)(dtjdt,)"'{a) = 0,3 for any aG F^n F„ provided V^nV,^ 
0 . 
Two local expressions {((p^, F^, r^)} and {(</)^, K^, r'J} of differentials of degree 
m are called equivalent if {(</>^, F^, t^)} u {(0^, K^, ^v)} also satisfies the above 
conditions (i) and (ii). We call the equivalent classes differentials of^ of degree m. In 
particular, when m= 1, we simply call them the differentials o/9l. We denote by 
D"*(^) the set of all the differentials of degree m. For simplicity, we identify the 
differential of degree m with its local expression, and write 
if there is no confusion. 
Now let {(F^, t^)} be a local coordinate system of % and take for </)^ the function 
which identically vanishes on F^. Then {(0^, F^, r^)} is a differential of degree m for 
any m. We denote it by 0. For a nonzero differential co = {(</)^, F^, t^)} 
of degree m, each 4>^ is not identically 0 on F^, since 9^ is connected. Thus we can 
define the differential co ~ ^ of degree — m by 
(2.2.1) 
oj-' = 
{(ct>;\V,,t,)}. 
For a differential co = {(</)^, F^, r^)} of degree m and a complex number c, we put 
(2.2.2) 
cco = {(c(/)^, F^,t^)}, 
which is also a differential of degree m. 
Next let CO and co' be differentials of degree m. Refining their local coordinate 
systems, if necessary, we can write as 
^ = {(</>., ^.,g}, 
cD' = 
m.v,,t,)} 
with a common local coordinate system {(F^,r^)}. Then using these local 

46 
2. Automorphic Forms 
expressions, we define the sum co -I- co' by 
(2.2.3) 
co + co' = {((/),+ 0;, F„r,)} 
(6Z)'"(9?)). 
Moreover, for co = {(0^, F^, r^)} eD'C^?) and co' = {((/>;, F^, r^)} 6Z)"(9?), we define 
the product coco' by 
(2.2.4) 
cooo' = {((/),(/);, F,, t,)} 
iGD'"^"(m-
The definitions (2.2.1) through (2.2.4) are all independent of the choice of their local 
expressions. It follows from (2.2.3) that D'"(^) is a vector space over C. Further-
more, Z)^(9?) is a field by (2.2.1) through (2.2.4). Let co = {(0^, K^, t^)} be an element 
of D^(^\ and define the function (^ on 91 by 
(2.2.5) 
(/)(a) = 0Ja) 
if 
a e K 
Since <^^ = (j)^ on V^nV^, this is well-defined and (/> is a meromorphic function on 
9?. Conversely, let (/> be an element of the function field K{9i) of 91, and define (^^ by 
(2.2.5) for a local coordinate system {(F^, t^)}. Then {((/)^, F^, r^)} is an element of 
D*^(9l). Through this correspondence, iC(9?) and D^(9i) are isomorphic. Hereafter 
we identify D®(9^) with X(9l) by this correspondence. Then D"'(9?) is regarded as a 
vector space over X(9i) through the product defined by (2.2.4). We put 
D(9?)= 
f 
0^(91), 
m = — 00 
then D(9l) is a graded algebra over C and over X(9^). 
Let (j) be an element of X(9^), and take a local coordinate system {(K^, t^)} of 91. 
We define a function (/)^ on K^ by 
ct>,(a) = (dc^/dt,){a) 
(aeV^). 
Then {(0^, K^, t^)} is a differential of % and we denote it by d(l). The definition is 
obviously independent of the choice of a local coordinate system, and 0 is a 
constant if and only if ^0 = 0. 
Hereafter we assume that 9? is compact. Then D^(9?)^{0}, and therefore, 
D'"(9i) 7^ {0} for any integer m, since (^(Z))"* eD"'(9?). If co and co' are two differentials 
of D'"(9{) and co 9^ 0, then we have co" ^ co' e D^(9?) (= K(9t)); therefore we obtain 
(2.2.6) 
dimj,(9j)D'"(9?) = 1. 
We denote by Div(9?) the free module generated by all points of 9^, or 
Div(9^) = {J^ggg^ CgalCgeZ and 0^= 0except for finitely many points a}, 
and call it the divisor group of 9^. We call the elements of Div(9?) divisors of 91. For a 
divisor a = ^g ^a^ of 9?, we define the degree ofsi by 
cieg(a) = Xca 
(e/). 

§2.2. Differentials on Compact Riemann Surfaces 
47 
We are going to define the divisors for functions and differentials of 9?. For an 
element </> (T^O) of X(iR), we define the divisor of cj) by 
(2.2.7) 
div(0) = X Va(</>)a, 
where Va(</>) is the order of </> at a defined by (1.8.4). Since Va(0) = 0 except for finitely 
many points a, div((/)) is well-defined and an element of Div(9?). Moreover by virtue 
of (1.8.5), we see 
(2.2.8) 
deg(div((/>)) = 0. 
If 0, ^AeX(9l)^ then we see 
(2.2.9) 
div((/)(A) = cliv((/)) + div(i/^). 
Therefore, if we put 
Div,(9?) = {div((/))|</)eX(9l)^}, 
then it is a submodule of Div(9?). We call Div,(9{) the principal divisor group, and 
the quotient group Div(9?)/Div,(9?) the divisor class group. The elements of 
Div(lR)/Divj(9l) are called divisor classes. 
Let CO # 0 be a differential of degree m and co = {(0^, K^, ^^)}. We put 
V a M = Va(</)^) 
for any point aeV^. Since dt^/dt^ is holomorphic and has no zeros on V^nV^, 
Va(co) is independent of the choice of a local expression of o. Moreover, Va(co) = 0 
except for finitely many points a, since 9? is compact. Hence we can define the 
divisor ofco by 
div(co)= X Va(co)a, 
ae5R 
which is an element of Div(9l). If m = 0, then it is nothing but the divisor of a 
function defined above. If ca e Z)'"(9i), co' e Z)"(9l) and G> # 0, co' # 0, then we get 
(2.2.10) 
di\((oo}') = div(co) + div(co'). 
Therefore by (2.2.6), we see 
(2.2.11) 
{diw(co)\coeD'"(m)-{0}} is a divisor class. 
Let a = ^ a Cga be a divisor. When Cg ^ 0 for all a, we say that a is positive and 
write a ^ 0. We put, for a divisor a, 
L(a) = {</)eX(iH)| (/) = 0 or div((/)) + a^O}. 
It is known that L(a) is a finite dimensional vector space over C. By (2.2.8), we see 
(2.2.12) 
L(0) = C; 
(2.2.13) 
L(a) = {0} if deg(a)<0. 
We put 
/(a) = dime L(a). 

48 
2. Automorphic Forms 
Then the following theorem is known (see [Lang]). 
Theorem 2.2.1 (Riemann-Roch). Let ^ be a compact Riemann surface of genus g. 
Fix a nonzero differential w of 91. Then we have 
/(a) = deg(a) - ^ + 1 + /(div(ft>) - a) 
for any divisor a of 9?. 
The following corollary is easily deduced from this. 
Corollary 2.2.2. Let ^ be a compact Riemann surface of genus g. 
(1) If CO is a nonzero differential o/9?, then we have 
deg(div(cy)) = 2 ^ - 2 , 
/(div(ca)) = g. 
(2) // CO is a nonzero differential of 9? of degree m, then we have 
deg(div(co)) = 2m{g - 1). 
(3) / / a is a divisor o/9l such that deg(a) >2g — 2, then we have 
/(a) = deg(a)-sf + l. 
Let CO be a differential of degree m. We say that co is holomorphic, if either co = 0 
or div(co) ^ 0. We denote by Do(9?) the space of the holomorphic differentials of 
degree m. Since 
L(div(cyi)) = {</)eX(lR)|(/) = 0 or 
diy((f)co,)^0} 
for a nonzero differential co^ of 91, we get the isomorphism: 
L(div(coi))~ {o)eD^(m)\o) = 0 or 
div(co)^0} 
= />i(9?). 
Therefore by Corollary 2.2.2(1), we obtain 
(2.2.14) 
dimci)J(9l) = g. 
§2.3. Automorphic Forms and Differentials 
We are going to connect automorphic forms for a Fuchsian group F and differ-
entials on the Riemann surface 91 j^. 
First we assume that k = 2m, and define a mapping from s/^(F) to D"'{^p). Let 
TT = TTj^be the natural projection from H* onto 91^, and / an element of s/^iF). 
For a point a of 9?^-, take a point ZQ of H* such that 7r(zo) = a. Let U*^be SL 
neighborhood of ZQ in H* satisfying the following conditions: 
(2.3.1) 
yUlnUl 
^ 0 if and only ifyeF,^; 
(2.3.2) 
ifyeF^^^thenyUl^Ul. 

§2.3. Automorphic Forms and Differentials 
49 
Let tg be a local coordinate on a neighborhood VQ = n(U*^) of a defined in §1.8. 
r Suppose ZQ is a point of H. We define a function g(z) on C/J, by 
(2.3.3) 
g(z)=f{z){d(t,on{z))/dz)-'" 
(zeC/JJ. 
Since t^°n{yz) = t^°n(z) for any yeF^^, we see 
(2.3.4) 
d(t,onoy(z))/d(yz) 
= 
(d(yz)/dzy'd(t,on(z))/dz 
= j{y,zfd{t,on{z))/dz 
(yerj. 
Thus WQ gQt g(yz) = g(z) for any yeF^^, and therefore, there exists a function </)a on 
Kg satisfying 
(2.3.5) 
(/)3 0 7r(z) = ^(z) 
(zel/?J. 
Since /(z) is meromorphic, so is (f)^. Moreover, if a point b of 91 j^is not a cusp 
and Fg n Kb 7^ 0 , then 
(2.3.6) 
ct>,{c){dtJdt^r{o) 
= cj>^(o) 
for any ceV^n 
V^. 
T Let ZQ be a cusp. Put U^^= U*^ — {ZQ} and define a function ^(z) on t/^o ^Y 
(2.3.7) 
^(z)=/(z)(^(r307r(z))/^z)-- 
( Z G I / , J . 
By a similar argument as in 1°, we see ^(yz) = ^(z) for yeF^^. Thus there exists a 
function (/)a on Kg — {a} satisfying 
</)a°7r(z) = ^(z) 
(zef/^J. 
Since /(z) is meromorphic on (7^^, so is (f)^ on Kg — {a}. Take an element c of 
SL2(U) satisfying CTZQ = oo, and let /i be a positive real number such that 
" m e / y. We define a local coordinate tg by 
-HI' 
tQ°n(z) = e^'''''''^, and put c = (Ini/hy". 
Then we see 
(2.3.8) 
(/>g o niz) = cf(z)(d(Gz)ldzr 
"'{t, o n(z))-"' 
= c/(z)7(a,z)2-(fg0 7r(z))-'" 
= 
c(f\2mCT-')iaz){t,on{z))--
on U^^. Since / is meromorphic at ZQ, so is (/>g at a. Moreover, if b is a point of ^p, 
and Kg n Fjj # 0 , then we see easily that (2.3.6) also holds in this case. 
Thus we have proved that {((/)g, Kg, tg)} is a differential of degree m of 91/-, 
which we denote by coy^ or o){f). Then we easily see that 
(Oj-g = (Of(Og for 
fes^2m(r\ 
ges^2n(n. 
^ / + » = % + <^5 for 
fges/2mir). 
Conversely, let co = {{(l)^,V^,t^)} be an element of D"*(9ij^). We define a 
function /(z) on H by 
/(z) = (t>^(n(zmd{t^ o n(z))ldzr 
(zeH n TT" ^( V^). 

50 
2. Automorphic Forms 
Then /(z) is well-defined and an element of s/jmi^^)- Furthermore we see 
Summing up all together, we obtain the following 
Theorem 2.3.1. Put ^(r)even = Zm'^2m(^)- Then ^{r\^^^ 
is isomorphic to 
D{^r) = Yjm^"^i^r) ^5 graded algebras over C by the correspondence "/i—•co/'. 
In particular, ^2m(T) "^ W-
Let / be a nonzero element of ja^2m(^)- We use the same notations as in 1°, T. 
Let a = 7r(zo)e9?y^with ZQEH*. First suppose ZOGH. Take an element p of 5L2(C) 
so that pH = K and pz^ — 0. Then we can take a local coordinate t^ on Kg so that 
t^°n(z) = (pzy(zeU*J, 
where e is the ramification index at a. Using this local 
coordinate t^, we can rewrite (2.3.3) as 
ct>,on(z)=f(z)(d(pz)/dz)-"^(e(pzy-')-"^ 
(zeC/JJ. 
In other words, putting w = pz, we have 
(l)^onop-^w) 
= e-'"f(p-'w)(d(p-'w)/dwrw-'"^'-'^ 
(wep{Ul)). 
Comparing the orders in w on both sides, we get 
(2.3.9) ord,(03O7rop- 1) = ordMiP~'^)id(p-'w)/dwr) 
- m(e - 1). 
Since tg ° TT o p " ^ (w) = w^, we have 
(2.3.10) 
ord^(</)a°7ro/9" ^) = ev^icj)^) = ev^iOf). 
On the other hand, we have 
(2.3.11) 
ordU/(p-^w)(^(p-iw)/^w)'") = ord,_,,(/), 
since d{pz)/dz has neither a zero nor a pole at ZQ. It is natural to define 
V3(/) = ^ o r 4 _ , , ( / ) . 
Then, from (2.3.9) through (2.3.11), we obtain 
(2.3.12) 
V3(co^) = V 3 ( / ) - m ( l - l / ^ ) . 
In particular, the definition of V3(/) is independent of the choice of both ZQ and p. 
We note that when m = 1, for a = ;r(zo) (ZQEH), 
(2.3.13) 
(Of is holomorphic at a 
of 
is holomorphic at ZQ. 

§2.3. Automorphic Forms and Differentials 
51 
Next assume that ZQ is a cusp of F. Take c, /i, IQ as in 2° above. Since 
{f\2m(T-')(Gz)= f ay^'"^^" 
(a^#0) 
= f 
a„(f3o;t(z))", 
we get 
Va(0a) = ^ - ' W 
by (2.3.8). We put v^(f) = N, then we obtain 
(2.3.14) 
v,(cOf) = v,(f)-m. 
In particular, v^if) is independent of the choice of both ZQ and a. When m = 1, 
we see for a cusp a = 7r(zo), 
(2.3.15) 
coy is holomorphic at a 
< > V 3 ( / ) ^ l 
o / /las a zero at ZQ. 
Consequently, by (2.3.13) and (2.3.15), we obtain the following 
Theorem 2.3.2. The correspondence "/1—• ojf induces the following isomorphism: 
To define divisors of automorphic forms, we shall generalize the notion of the 
divisors. For a compact Riemann surface % we put 
Div(9{)Q = Div(9i)(x)2Q 
= < YJ ^a 3 ka ^ ^ ^^^ <^a = ^ except for finitely many points a 
lae9? 
I 
We call the elements of Div(9?)Q divisors with rational coefficients. 
Now let / be a nonzero element of s/2m(^)- We have Va(/) = Va((Oy^) for every 
ordinary point a. Then the number of the points ae^p such that Va(/) T^ 0 is finite, 
since elhptic points and cusps and points a such that Va(co/) T^ 0 are only finite. 
Therefore, we can define 
div(/)= E V3(/)a 
as an element of Div(lR^)Q. By (2.3.12), (2.3.14) and Corollary 2.2.2, we get the 
following 
Theorem 2.3.3. Let k be an even integer. For a nonzero element f of 
s/^ir), 
we have 
div(/) = div(a)^) + ^ X ( l - 1 / ^ 3 ) 3 , 
^ a 
deg(div(/)) = kig - 1) + ^ 1 ( 1 - l/e,). 

52 
2. Automorphic Forms 
where e^ is the ramification index of a and g is the genus of^p. 
We understand 
i/eQ = 0 if a is a cusp. 
Remark 2.3.1. Since 1 — l/^g == ^ ^^^ ordinary points a, the summation in the 
right-hand side is virtually a finite sum. 
Remark 2.3.2. When m = 0, the divisor div(/) for a nonzero element / of ja/o(r) is 
nothing but the divisor of / as an element of KCtRpy. 
Remark 233. 
Let/GJ3/2m(^)-Then 
o)j-on=f(z){dzr 
as differentials of degree m of H. Keeping this in mind, if we define 
(2.3.16) 
d i v ( ^ z ) = - X ( l - l / ^ a ) a . 
a 
then we have 
(2.3.17) 
div(w^) = div(/) + mdiv(rfz). 
Corollary 2.3.4. Let k be an even integer, and assume that F has cusps. Denote by r 
the number of inequivalent cusps of T, and by s the number of inequivalent elliptic 
points. Let xbe a cusp off and a an element ofSLjiU) such that ax = oo. Let /(z), 
g{z) be elements of%(r) 
and 
«=o 
«=o 
be the Fourier expansions off h at x. Ifa„ = /?„ for every n'^k(g — \) •\- k(r-\-s)/2, 
thenf(z) = h{z). Here g is the genus of^p. 
Proof Put w = co^_ft. Suppose co # 0. Then, by (2.3.14), v„(^)(a>) ^ k(g - 1) 
-\- k(r -\- s — 1)/2H- 1. Since both / and h are holomorphic. Theorem 2.3.3 implies 
that oj is holomorphic at all points except for cusps and elliptic points. 
Furthermore, v^{(o) ^ — /c/2 for all eUiptic points and cusps other than n{x) by 
(2.3.12) and (2.3.14). Therefore deg(div(co)) ^/c(^ - 1) + 1; this contradicts 
Corollary 2.2.2. Consequently, co = 0 and f=h. 
D 
Next we consider the case when k is odd. Assume — 1 ^ T. Let /(z) be a nonzero 
element of s^k(^). Since /(z)^ belongs to s^2k{^\ we may put 
Va(/) = Va(/')/2 
(ae^r\ 
We define div(/) by 
cliv(/)= X V3(/)a. 
a € « r 

§2.4. The Measure of T \H* 
53 
Theorem 2.3.5. Let k be an odd integer. Assume — l^F. For a nonzero element f of 
S2^^{r\ we have: 
(1) 
div(/) = ^ d i v K a ) + ^ 1 ( 1 - 1 / ^ 3 ) 3 , 
deg(div(/)) = fe(g - 1) + ^ X ( l - l/^a); 
^ a 
(2) 
V3(/) = \ 
1/2 
modZ, if a is an irregular cusp, 
an integer/e^ 
modZ, if a is an elliptic point, 
0 
mod Z, otherwise; 
^ 
^ 
f odd, 
if a is a regular cusp, 
even, otherwise. 
Here e^ denotes the ramification index at a. We understand l/eQ = Oifaisa 
cusp. 
Proof The assertion (1) is easily seen by Theorem 2.3.3. Let us prove (2). When a is 
a cusp, the assertion easily follows from (2.1.15). Suppose a is not a cusp and let ZQ 
be a point of H such that 7r(zo) = a. Then 
Va(/) = V3(/')/2 = ord,(/^)/2e3 = ord,(/)/e3, 
{t = z - Zo). 
This implies (2). By definition, we have 
V3(a,^.) = 2v3(/)-fc(l-l/e3). 
Thus, if a is not an eUiptic point, the assertion follows from (2). Assume that a is an 
elliptic point. Then ^g is odd by Lemma 1.5.6(2). Put Va(coj2)=^w. Since 
ue^ + k{eQ — 1) is even by (2), u must be also even. Therefore we get (3). 
D 
§2.4. The Measure of r \ H * 
In this section, we calculate the measure of r \ H * using the genus ^ of r \ H * and 
ramification indices. 
Lemma 2.4.1. Let m be the least common multiple of the orders of all elliptic points of 
r. Then there exists a nonzero element ofs/2mir) ^hich has neither zeros nor poles at 
any cusp and any elliptic point of F. 
Proof. By definition, we have only to show that there exists a nonzero element / of 
s^2mir) such that v^if) = 0 for all elliptic points and cusps a of 9?/-. Let fe be a 
nonzero element of s^2mi^)- We note that div(fe) belongs to Div(9i^) by the 
definition of m and Theorem 2.3.3. Let {ai,. . ., a^} be the set of all elliptic points 
and all cusps of 91 j^. Take an integer n satisfying 
- deg(div(/c)) 
-l-\-n>2g-2. 

54 
2. Automorphic Forms 
Let b be a point of 9? j^ which is neither an elliptic point nor a cusp, and put 
a = — div(/c) + nb, 
b^ = - div(^) -a^ + nb 
{l^n^ 
r). 
Then we see L(a) => L(b^) and, by Corollary 2.2.2(3), 
dimL(a) — dimL(b^) = 1, 
so that there exists a nonzero element h{z) of s/o{r) {^ K(^p)) such that 
/iGL(a)- 0 UK)-
Put f=k/h; 
this is the desired one, since 
Lemma 2.4.2. Let k be an even integer, XQ a cusp off, and f a nonzero element of 
j^k(r) 
which has neither a zero nor a pole at XQ. Let C be a curve contained in a 
neighborhood O/XQ satisfying the following conditions: 
(i) n{C) is a circle around 7r(xo) oriented counterclockwise; 
(ii) C corresponds one-to-one ton(C) except for the initial point and the terminal 
point. 
If C tends to XQ with respect to the topology of H*, then we have 
lim J ^log / = lim^y~ ^ dz = 0. 
c 
c 
Proof Put a = n(xo). Let C/* be a neighborhood of XQ such that V =n(U*) 
is a 
neighborhood of a as in § 1.8. We may assume that C is contained in 1/ * by taking it 
sufficiently close to XQ. Take an element a of SLjCIR) so that (TXQ = oo. Then we see 
(2.4.1) 
J^log/= J^log(/(z)7((T,z)*) - /cJ^log;((7,z). 
c 
c 
c 
We may regard f{z)j((T, zf = {f\k(T~^ )((7z) as a function on V(cf. (2.LI3)) which 
has neither a zero nor a pole at a. Thus the first term of the right-hand side 
n{Q 
Fig. 2.4.1 

§2.4. The Measure of.r\H* 
55 
converges to 0 as C goes to Xo. To calculate the second term, put w = az and 
Then 
(J-' 
= 
a 
bl 
c 
d] 
jd\ogj(G,z)= 
- 
J d\ogj(a 
\w) 
C 
<T(C) 
WQ + h 
= — J ^log(cw + d) 
Wo 
- l o g 
CWQ -\- d -\- ch 
- ^arg 
CWQ -}- d + ch 
CWQ -I- d 
CWQ + d 
where WQ and WQ -^ h (h > 0) SLTQ the initial point and the terminal point of a(C), 
respectively. We note that h is independent of the choice of C. Let C go to XQ. Then 
G(C) converges to oo, and so does WQ. Hence the second term of the right-hand side 
of (2.4.1) converges to 0, so that 
l i m j ^ l o g / = 0 . 
c 
Similarly, since we have, by (2.1.2) and (2.1.3), 
h~'dz 
S J Im(w)-M^w|, 
and (T{C) tends to oo as C -• XQ, we get 
lim jy~ ^ dz = 0. 
D 
Theorem 2.4.3. Let F be a Fuchsian group and g the genus of the Riemann surface 
91 j^. Then we have 
J - , ( r \ H * ) = 2 ^ - 2 + X (l-l/^a). 
Here e^ denotes the ramification index of ae^p, 
and we understand l/^g = 0 if a 
is a cusp. 
Proof Take an integer m and a nonzero element / of j/2m(^) as in Lemma 2.4.1. 
Then / has neither a zero nor a pole at every elHptic point and every cusp of F. 
Since 9?^- is a compact real manifold of dimension 2, there exist curves 
L^(l ^ /i ^ /) such that 9?^-— (JJ^ ^ ^ L^ is simply connected. We may assume that 
no cusps lie on L^. Taking a point b on (JJ^ = ^ L^, we connect elliptic points and 
cusps with b in 9? J-— (JJ^ = j L^ by curves L,,{1 -\- 1 ^v ^t) which do not intersect 
each other (see Figure 2.4.2). We can take L^(l -\- 1 ^v ^t) so that neither zeros 
nor poles of/ lie on it. Now there exists an open connected subset 1/ in H which is 
homeomorphic to 9?/-— (JJ^ = ^ L^. In fact, take a point c on 9ly-— (JJ, = i L^, and 
let ZQ be a point of H such that 7r(zo) = c. Let M be the set of the curves C on H 
which have the initial point ZQ and are mapped bijectively into '*Rp— (JJ, = ^ L^ by TT. 

56 
2. Automorphic Forms 
Fig. 2.4.2 
Then the set U consisting of the terminal points of curves C e M is the desired one. 
Put F = U, then it is a fundamental domain of T. Let Xi,. . . , x^ be the apices of F 
which are cusps of F. Let C^ (1 ^ v ^ r) be a curve contained in a neighborhood of 
Xy whose image n(Cy) by TI is a circle around nix^) oriented counterclockwise. Let 
M be the compact set surrounded by the boundary of F and the curves 
Cy(l ^ V ^ r) (see Figure 2.4.3). By the definition of the measure of r\H*, we have 
v(F\H*) = v(F) = lim J 
1 < v < r 
dx A dy 
(z = X -\- iy). 
By the Stokes theorem, we see 
r dx A dy 
. dz 
c I dz 
\ 
2-^= I — = J — + 
M 
y 
m y 
^M\y 
^ 
f^^Ldlogf)-- 
i rflog/, 
\y 
rn 
J 
m/M 
where dM denotes the boundary of M oriented counterclockwise. Since 
f(yz) =f{z)j(y, z)^"" for yer, we see 
(f/log/)o7-^log/= 2m d\ogj{y,z). 
Fig. 2.4.3 

ij2.5. Dimensions of (^^{7 ) and V),(/) 
57 
This combined with Lemma 1.4.3(1) implies that y~^ dz-{{i/m)d\ogf 
is invariant 
under the action of P. Therefore we can regard it a differential on T \ H*. By 
our construction of M, the boundary of M except for C^ (1 ^ v ^ r) consists of the 
pairs of the sides which are transformed by F and have opposite orientations. 
Consequently, 
J f^ + i<i.og/Vo, 
so that 
y 
m 
I f + i.log/ =-Z J 
dM\y 
^ 
J 
V = 1 Cv 
dz 
/ _ 
— + 
-d\ogf 
y 
m 
)
• 
By Lemma 2.4.2, the right-hand side converges to 0 as C^'s go to x^ for all x^. 
Moreover, when C^ is sufficiently close to x^, we may consider that both zeros and 
poles of / are contained inside of M. Therefore we get 
2n 
m 
J dlog/=—deg(div(/)). 
dM 
^ 
This combined with Theorem 2.3.3 implies the assertion. 
D 
§2.5. Dimensions o{%{r) and ^ J T ) 
We are going to calculate dimensions of ^^(r) and ^k(r) 
using the Riemann-
Roch theorem. We assume — 1 ^ T if /c is odd. For any real number x, [x] denotes 
the largest integer ^ x. For an element a = J^a^^a^ of Div(9?/^)Q, put 
[a]=S[Ca]a. 
a 
Let bi, . . . , b, be all the cusps of ^p. When k is odd, we take bj, . . . , b^ so that 
bi, . . . , by are regular and b„ + i,. . . , b, are irregular. Let ^ be a nonzero element 
of ^fc(r). (The existence of such a form was proved in Theorem 2.3.1 for even /c, 
and will be proved for odd k in Theorem 2.6.8.) Then we have the following 
Lemma 2.5.1. With the above notation, the following isomorphisms hold as vector 
spaces over C. 
(l)^,(r)^L([div(/o)]). 
(2)^fc(r)^ 
'^'-iA) 
div(/c 
div(/o)- l b . - - 
X b 
v = l 
^ \ = u-\- 1 
{k: even), 
(kiodd). 

58 
2. Automorphic Forms 
Proof. Since 
^.(n = {//oi/e^o(n}, 
wee see, by definition, 
%in = {ffo\f^^oin 
/ = 0 or div(//o)^0} 
^ { / e ^ o ( n i / = 0 
or div(/) + div(/o)^0} 
-{(/)eX(9?^)|(/) = 0 or div((/)) + div(/o)^0}. 
The last space is no other than L([div(/o)]), since div(0) + div(/o) ^ 0 is equiv-
alent to saying that div((/)) + [div(/o)] ^ 0. This shows (1). Next suppose ffo is a 
nonzero element of ^fc(r). Then 
ffo^^,{r)ov^Sffo) > 0 
(1 ^ V ^ 0. 
When either k is even, or k is odd and 1 ^ v ^ w, we see 
Vb.(//o)>0<>Vb^(//o)^l 
When k is odd and w + 1 ^ v ^ f, we get 
Vb.(//o)>0<>Vb///o)^l/2 
<>Vb^(/)-fVb^(/o)-1/2^0. 
Therefore a similar argument as above shows (2). 
D 
We are going to calculate dimensions of the spaces in Lemma 2.5.1. Let 
ai, . . . , a^ be all elliptic points of 9?/^, and e^ the ramification index of a^ 
(1 ^ /x ^ r). Put 
^ = 2^-2+ X (l-l/e,) + r 
with genus g of 9?^-. We note that for any nonzero element h{z) oi 
s^^(r\ 
deg(div(;i)) = kdjl and d = {2n)-'v{r\U*) 
> 0 by Theorem 2.4.3. 
r Suppose /c < 0. Since 
cieg([div(/o)]) S deg(div(/o)) = kd/2 < 0, 
we get 
dim^fc(r) = dim5^fc(r) = 0. 
2° Let k = 0. Then /Q can be considered as an element of K(9^y-)'', and 
therefore 
dimmer) = /(div(/o))=l, 
and 
dimy'o(n = /fdiv(/o)- t b , ) = ^^ 
' ^ ^ ^ ^ ' 
v = 1 
0 
i f r > l . 

§2.5. Dimensions of *j(r) and .^^(r) 
59 
3° Assume /c g 3 and put 
Tdivao)- t ^ b . l 
(fcieven), 
[divC/o)- t b . - i 
t 
b^ 
(fc:odd). 
By Theorem 2.3.3 and Theorem 2.3.5, we see 
div(w(/o)) + ^t^ r^(l-l/e,)Ja,+ ^Z ^ b , 
(feieven), 
|ldiv(co(/o^))+ t r^(l-l/e„)la„+ i ^ b „ + 
t 
^ b . 
(k: odd), 
and therefore, 
a = 
2) + t^ [^(1 - Ve,)l + ^ 
f (k: even), 
[^(23-2)+^t |^^(l_l/,jJ+^^„+^(,_„) 
deg(a) 
[^(2.-2).E,[^(l-l/^.)J+^-^ 
(/c: odd). 
In particular. 
deg(a) ^^(2g-2)+ 
t^ [^(1 - l/e,)1 
k-2 
Since -(e^ — 1) is integral. 
so that 
r^(l - l/e,)J ^ ^ ( 1 - 1/e,), 
deg(a)-(2^-2) ^ ^ | ( 2 ^ - 2 ) + ^t^Cl - l/e,) + ^J 
= —;r- ^ > 0. 
2 
Since deg(a) ^ deg([div(/o)]), we get 
deg([div(/o)])>(2^-2). 
By Lemma 2.5.1 and Corollary 2.2.2(3), we obtain 
dim^,(r) = deg[div(/o)]-^+l, 
dim^,(r)=deg(a)-^+l. 

60 
2. Automorphic Forms 
Since deg([div( jj))]) — deg(a) is equal to r if /c is even, or equal to w if /c is odd, we 
see 
dim^fc(r)-dimyfc(r) = t 
{k: even), 
u {k: odd). 
4° Let k = 2. Since ^2(^) - ^K^rl 
we obtain by (2.2.14) that 
dim^2(^) = ^-
Since [div(/o)] = div(a;(/o))+ Xt = i ^v' ^^ have by (2.2.12) and (2.2.13) that 
/(div(co(/o))-[div(/o)]) = / ( ^ - J ^ b , ) = | J 
jJ^^J' 
By Theorem 2.2.1, we get 
dim^,(r) = ;([div(/< .,,={:-
1 (t > 0), 
{t = 0). 
5° When k = 1, we have by Theorem 2.2.1 
/([div(/o)]) - /(div(a;(/o^)) - [div(/o)]) = deg([div(/o)]) - ^ + 1. 
Since by Theorem 2.3.5, 
([• 
Z.(div(co(/o^))-[div(/o)]) = Z,(|div(/o)- S b , - - 
X 
b. 
v = l 
^ v = u+1 
^lin 
and 
deg([div(/o)]) = deg(div(/o))- J t 
{\ - 
\/e,)-{t-u)/2 
we obtain 
= ^ - 1 + M/2, 
dim ^i(r) - dim ^,(r) 
= u/2. 
We note that general calculation of dimensions of ^i(r) and ^ i ( r ) is an open 
problem. 
Summing up all together, we obtain the following 
Theorem 2.5.2. Let k be an even integer, g the genus of^p.e^, 
. . . .e^the orders of 
inequivalent elliptic points off, and t the number of the inequivalent cusps off. Then 
dim^fc(r)= ^ 
( / c - l ) ( ^ - l ) + 
9 
1 
0 
0 
i[^^'-H + l - - l ) t 
{k>2). 
(k = 2), 
{k = 0,t = 0), 
(k = 0,t> 
0), 
(fc < 0), 

§2.6. Poincare Series and Eisenstein Series 
61 
dim%(r) 
dim 6^^{r)-\-t 
(k^4l 
dim9'2{r) + t - \ 
( = g + t-\) 
(/c = 2, t > 0), 
dimy'2(n 
( = 9) 
(k = 2,1 = 0), 
1 
(k = 0), 
0 
(k< 0). 
Theorem 2.5.3. Let k be an odd integer, and assume — 1 ^ T. Let g and {ef,}'j,= ibethe 
same as in Theorem 2.5.2. Further let u and v be the numbers of the inequivalent 
regular and irregular cusps of T, respectively. Then 
k-2 
k-\ 
,, ^ , , 
^ ^ w + —^ 
V {k^ 3), 
dim^,(r) 
; 
-^ 
' 
• ^ 
- • 
' 0 
(k< 0), 
(/c-l)(^-l)+^t r^(l-l/e,)1 
dim^fc(r) = { dim^i(r) + M/2 
(/c = 1), 
0 
{k< 0). 
§2.6. Poincare Series and Eisenstein Series 
We are going to construct automorphic forms called Poincare series. 
Theorem 2.6.1. Let ZQ be a point o/H and S a positive real number such that the set 
M = {z e CI I z — ZQ I S 3(5} /s included in H. For any real numbers k and p ^ 1, there 
exists a constant C satisfying 
|/(zi)| ^ c Q |/(z)Im(z)^/2|Mt;(z)Y'' 
(|z, -Zo| S S) 
for any continuous function f(z) on M which is holomorphic on the interior of M. 
Proof Let /(z) = YJ7=O ^n(^ — ^i)" be the Taylor expansion of /(z) at z^. Since 
In 
5 
00 
j 
f(z)dxdy= 
j J £ a„r"^'e'"'drde = nS^ao, 
\z-Zi\^S 
0 
0 « = 0 
we see 
\f{z,)\g(KS^)-' 
\\f(z)\dxdy 
M 
(nd^C.r' 
\\m\Mzf"'\dv(z) 

62 
2. Automorphic Forms 
with Ci = ini{lm{zf'^~^\zGM}. 
By Holder's inequality, we get 
(2.6.1) 
\f(z,)\ ^ inS'C,)-' Qrft;(z)Y'Y j |/(z)Im(zp|Mt;(z)y'' 
with q such that 1 < ^ ^ oo and l/p+ 1/^ = 1. Thus, it is sufficient to put 
From the above theorem we easily get the following 
Corollary 2.6.2. Let /c, p be the same as in Theorem 2.6.1. For an open subset U o/H 
and a point ZQ of U, there exists a constant C such that 
|/(zo)| g 
cfj^lfiznmizr'l-dviz)]'" 
for any holomorphic function f(z) on U. 
The following theorem will be used in Chapter 6. 
Theorem 2.6.3. Let k, p be the same as in Theorem 2.6.1. Assume that f(z) is 
holomorphic on H and ^^ |/(z)Im(z)''^^|''^t;(z) < oo. Then, for any real number a, b 
such that 0 < a < b, 
lim |/(z)| = 0 
| x | - o o 
uniformly with respect to y on the interval [a, fe], where z = x-\- iy. 
Proof. Take a real number S so that 0 < 2^ < a, and put for a positive integer n 
U„ = {zeH\a-2SS 
Im(z) 
^b-\-2S, 
n-2^^Re(z)^«+H-2^}, 
V„ = {zGU\a ^ Im(z) ^b, 
n^ Re(z) 
Sn-\-\}. 
Let ZQG K„, then {zeC| |z-Zol ^ 2^} c U„. Therefore by (2.6.1), 
\f(zo)\^(nS'C,)-'viU„y'^n 
\f(z)lm{zr'\^dv{z) 
with q such that 1 < g ^ oo, 1/p + \/q — 1, and a constant C^. Since the measure 
v(U„) is independent of n, and 
lim J \f(z)lm(zf^^\Pdv(z) 
= 0 
by assumption, we obtain 
lim |/(zo)| = 0 
(zo = Xo + i>o) 
I X o I - • CO 
uniformly with respect to ^Q ^^ [^» ^]- 
D 

i:;2.6. Poincare Series and Eisenstein Series 
63 
Corollary 2.6.4. Let k, p be the same as in Theorem 2.6.1, and U a suhdomain ofW. 
For a holomorphic function f(z) on U, we put 
\\f\\, = ( 
\\f{z)lmizf"\'^dv{z)''^' 
If a sequence {/„(z)} of holomorphic functions on U satisfies Cauchfs condition with 
respect to the norm || • \\jj, then {/„(z)} converges to a holomorphic function on U 
uniformly on any compact subset of U. 
Proof By Corollary 2.6.2, for any point z of (7, a sequence {/„(z)} of complex 
numbers is a Cauchy sequence. Then we can define /(z) = \im„^^f„{z). For any 
point Zo of C/, take ^ > 0 so that {zeC| |z-Zo| ^ 2(5} c C/. By Theorem 2.6.1, 
there exists a constant C such that 
\fniz)-fm{z)\^C\\f-fJ\^ 
for any z satisfying \z — ZQ\ ^ S. For any s > 0, take an integer N so that 
II/n —/m II t/< e/2C if m, n>N. 
For z satisfying |z — Z Q J ^ ^ , take an integer 
n{z)> N so that |/(z) —/„(.)(z)| < e/2. Then we see 
|/(Z) -f„{z)\ S \f{z) -/„(.)(Z)| + !/„(,) -f„{z)\ < 8 
for any n > N and any z satisfying |z — ZQ j ^ ^. Thus/„ converges to / uniformly on 
jz — ZQI ^ (5. This implies {/„} converges to / uniformly on any compact subset of 
(7, and therefore, / is holomorphic on U. 
D 
Lemma 2.6.5. Let {/„(z)} be a sequence of holomorphic functions on a domain D ofC. 
Let ZQ be a point ofD. Iff„{z) converges uniformly on any compact subset ofD — {ZQ}, 
then so does it uniformly on any compact subset of D. 
Proof We have only to see that it converges uniformly on some neighborhood of 
ZQ. Take a positive number r so small that {zeCjjz — ZQJ < r} c: D. Then 
fniz) = ^ . 
J 
f^dC 
(|z-Zol<r). 
Since/„(0 converges uniformly on |C —ZQ! = ^/«(z) also converges uniformly on 
{ z e C | | z - Z o l < r / 2 } . 
D 
Let r be a Fuchsian group, x a character of F of finite order, and k an integer. 
We suppose z(— 1) = (— 1)'' if —\eF. 
Let A be a. subgroup of T, and (/)(z) a 
meromorphic function of H satisfying the following conditions: 
(i) 
(t>\k^ = Xi^)(pfor any XeA; 
(ii) 
the number of A-inequivalent poles of (l){z) is finite; 
(iii) let Zi, . . . ,z^ be all A-inequivalent poles of (/)(z), and Xj, . . . ,x^ all 
F-inequivalent cusps of F, Then, for any neighborhoods U^ of z^ and V^ ofx^, 
j |(/)(z)|Im(z)''/2^i;(z)< oc, 
A\H' 

64 
2. Automorphic Forms 
m 
r 
where H ' = H - U \j W,,- \j U I'^'v 
For such a function ^(z\ we define 
(2.6.2) 
F(z) = F^(z',4>.X.A,n= 
I 
z(?)((/>l,7)« 
izeW). 
yeA\r 
It is obvious by the definition of the series and condition (i) that if F(z) 
is convergent, then it is independent of the choice of the representatives of / l \ r , 
and 
F\ky = Xiy)F 
for any yer. 
We call this series the Poincare series. 
Theorem 2.6.6. Under the same notation and assumptions as above, wie have: 
(1) F{z) is convergent absolutely and uniformly on any compact subset of 
H — {yz^lyer, 1 ^ /i ^ m}, and F(z) belongs to Qk(F, x)\ 
(2) if (i){z) has a pole at weH and is holomorphic at yw for allyeF — {±\}' 
A, 
then F{z) has also a pole at w and its order is equal to that of (piz). 
Proof Let ZQ be any element of H — {yz^lyeF, 1 ^ /iiSfn}. Take t/^, V^ and a 
neighborhood W of ZQ SO that 
(2.6.3) 
yWnU^ = 0, yWnV, 
= 0 
(yeT, 1 ^ / i ^ m, 1 ^ v ^ r), 
(2.6.4) 
{yer\yWnW^0} = r,^. 
Then 
(2.6.5) 
j X M\ky)iz)\lm(zr'dv{z)= 
^ j \(t>iyz)\lm{yzr'dv(z) 
W yeA\r 
y€A\r 
W 
= X j \cl>{z)\lm{zr'dv{z). 
yeA\r 
yW 
We see that yW^ <= H' by (2.6.3), and for an element y^ of T, (2.6.4) implies 
\A\{yer\XyWr^yiW^0 
for some 2.eA}\ ^ 
\A\Ay,r,J 
Therefore, 
^ i n j J 
\(l>{z)\lmizr'dv(z)<cx). 
A\H' 
Applying Corollary 2.6.4 for p = 1, we see that F(z) is convergent uniformly on any 
compact subset of W, and is holomorphic on W. This implies F(z) is holomorphic 
on H — {yz^lyer, 1 ^ fi^m}. 
Next put z' = y^z^ with y^eF and 
^0 = {y^^l^/^W 
has a pole at yz'}. 
Then y\^F^. a TQ, /lyr^ ^ TQ, and |/l\ro/r^ | ^ m. Write 
F(z) = Zi 
Mi<P\ky)i^)-^^2xiy)iKy)i'l 

§2.6. Poincare Series and Eisenstein Series 
65 
where I^ is the summation taken over the representatives y such that yly cz r©, 
and 12 is the summation over the rest. Then we see by a similar argument as above 
that 11 is a. finite sum, and by Lemma 2.6.5 I'2-part is holomorphic on yiC/i. 
Therefore F(z) is holomorphic on y^Uy — {z'} and has at most a pole at z'. Since 
this also holds for Z2, . . . , z^, F(z) is a meromorphic function on H. The 
automorphy of F{z) has already been proved. Therefore the first assertion is 
proved. Next assume that w = z^ = z' satisfies the condition of (2). Then 
ro = A'Z(r)and 
^ixMWky) 
W = c^(^) with c = \Z(r)\/\Z(A)l 
Therefore F(z) 
has a pole at w and the orders of poles of F and (/> at w are equal. 
D 
We are going to give some sufficient conditions for </)(z) under which F{z) is 
holomorphic at a cusp. Let x be a cusp of F and a an element of SLjiU) such that 
Gx = CO. We impose the following two additional conditions: 
(iv) ifx is not a cusp of A, then there exist positive numbers M, / and s such that 
\(cl>\^c7-'){z)\SM\z\-'-^ 
(Im(z)>/); 
(v) if X is a cusp of A, then there exist M, / (> 0) and £ (^ 0) satisfying 
\((t>\,G-'nz)\^M\z\-^ 
(Im(z)>/). 
Theorem 2.6.7. Assume that T, A, (/)(z) satisfy the foregoing conditions (i) through 
(iii). Let XQ be a cusp ofF. If conditions (iv) and (v) are satisfied for every cusp x which 
is F-equivalent to XQ, then F(z) is holomorphic at XQ. Moreover, if we can take e in (v) 
positive for all x which are F-equivalent to XQ, then F{z) has a zero at XQ. 
Proof First we note that conditions (iv) and (v) are independent of the choice of a. 
(M, /, 8 depend of course on the choice of a.) Let {a} be a complete set of 
representatives of A\F/Fx^. For each a, let {j5} be a complete set of representatives 
of (a-i / l a n r , , ) \ r , , . Then T = U„ .^ocj?- Put 
Then 
(2.6.6) 
F(z) = XIx(ai^)(0l,a^)W = Z</>.(4 
and 
(PoclkJ = xiy)(l>a 
(yer^j. 
By condition (ii), there exists a neighborhood U of Xo in H such that F(z) is 
convergent uniformly on any compact subset of U. In other words, by taking 
(TQeSLjiU) so that ^0^0 = ^ ' 
a 
is convergent uniformly on any compact subset of the domain {zeH|Im(z) > b} 
for some positive number b. Thus it is sufficient to show that (palk^o^ is holo-
morphic at 00, and moreover, has a zero at 00 if 8 > 0. 

66 
2. Automorphic Forms 
r Assume that OCXQ is not a cusp of A. Since a" Ma n T^^ coincides with {1} or 
{±1}, we have 
with C = 1 or 1/2, respectively. Applying condition (iv) for x = OLXQ, a = CFQCC'^, we 
take M, /, e(>0) so that 
|((/>|,a(7o-^)(z)|^M|z|-^- 
(Im(z)>/), 
so that 
|((/)J,(7o^)(z)|^2M X |z + m/i|-^- 
(Im(z)>/), 
meZ 
where /i is a positive number such that OQF^^GQ ^ • {± 1} 
1 /i"|' 
0 ij 
0 
^ • ^ ' " ^ 
Comparing the series on the right-hand side with the series Im~^~^, we see it is 
convergent uniformly on any compact subset of the domain Im(z) > /, so that 
0aL^o ^ is holomorphic at oo. Moreover if z tends to oo along the imaginary axis, 
{(t>a\k^o^)i^) does to 0; namely, (/>alik^o ^ ^^s a zero at oo. 
2° Suppose OLXQ is a cusp of A. Then a~ Ma n r,^ is a subgroup of F^^ of finite 
index, so that the summation ^ ^ is a finite sum and 
From condition (v) for x = axo, c = O-Q^ ^ there exist M, /, e such that 
(2.6.7) 
Ml.aco')iz)\ 
^ M | z | - S M 
(Im(z) > /). 
Noting that (JOPCTQ 
1 m/i"| 
0 ij 
for some integer m, we see that </)a|fcCro 
is holomorphic at oo. If e>0, then we see from (2.6.7) that (^^IfcCTo has a zero 
at 00. 
D 
We can prove the existence of nonzero automorphic forms using the Poincare 
series. Here we prove that if T^ — 1, then .^kiF) ^ {0} for any odd integer k. 
Theorem 2.6.8. IfT^-X, 
then s^ki^) i^ {0} for any odd integer k. 
Proof. Let ZQ be a nonelHptic point of H and put </)(z) = (z —ZQ)"^. Since (/)(z) 
satisfies conditions (i) through (v) for /c = 3 and yl = {l}, the Poincare series 
F{z)=Y^{(t>\Mz) 
yer 
belongs to ^^i^)- 
Theorem 2.6.6(2) implies that F(z) does not vanish identically 
since F{z) has a pole of order 2 at ZQ . Thus ^^(F) ^ {0}. Next let k be any odd 
integer. Take the integer n so that k — 2n = 3, then we obtain 
^,(r) = ^3(r)^2„(n7^{0}. 
• 

§2.6. Poincare Series and Eisenstein Series 
67 
When r has cusps, Poincare series yield one of basic methods to construct 
automorphic forms of weight k^3. Let / be a character of T of finite order. Let x be 
a cusp of r, and a an element of SLjClR) such that (7x = oo. We assume 
(2.6.8) 
xiy)Ji(^y(^-\zf=l 
foryer,. 
This condition is independent of the choice of G. If x is the trivial character, k is odd 
and — 1 ^ r, then (2.6.8) implies that x is a regular cusp. Let /i be a positive number 
such that 
o-r.(T-i-| + i {*[;:ii-
For nonnegative integer m, we put 
(2.6.9) 
(PJz) = ci)^(z- X, a) =j(a, 
z)-'e'^'"'^^'\ 
It is easy to see that 0^(z) satisfies conditions (i) through (v) for F, x and A=^r^. 
Therefore F^iz; (j)^, %, T^, F) is meaningful. If we define the character x"" of 
oFa~^ by 
(2.6.10) 
f(oyo-') = x{y\ 
{yeFl 
then 
(2.6.11) 
F,{z; (/>,, X. r.. n = Fdz; e^^'"^^'\ x\ cjF,a-\ 
GFG-')\^a. 
The following theorem is a direct application of Theorems 2.6.6 and 2.6.7. 
Theorem 2.6.9. Suppose /c ^ 3. Under the same notation and assumptions as above, 
we have: 
(1) / / m ^ 1, then F,{z; (j)^, x. /^., r)e.^,(r, xY 
(2) If m = 0, then F{z) = Fk{z; ^o, X. ^x, r)G^fe(r,x). It has the Fourier 
expansion at x of the form 
(f|,a-')(z)=l+ t ay""'^ 
and vanishes at all cusps which are inequivalent to x. 
We especially call Poincare series Ff^{z\ 00, x^ ^x^ ^) Eisenstein series. 
Theorem 2.6.10. Suppose k^3. Let x he a cusp of F satisfying (2.6.8), and put 
gf\z) 
= F^{,z; <t>„, x, P,, P) 
(m§0). 
For an elementf(z) of ^f^(F, x\ l^t a he an element ofSLjiU) such that ox= oo, and 
(/|^(7-')(z)=X 
ay-'i" 
be the Fourier expansion at x. Then 
0 
(m = 0). 
i 
f{z)gr{z)\m{zfdv{z) 
r\H 
(«m(47rm)^ ^h\k-2)l 
(m^l). 

68 
2. Automorphic Forms 
Proof. Taking oFo'^ in place of T, we may assume that x = oo and o=\. We see 
(2.6.12) 
j |/(z)| 
X 
\j(y.z)-'e''''"''^^^'\\m{zfdv(z) 
r\H 
yer,\r 
yer,\r r\H 
= 
j 
\f{z)e^''''""''\lm{zfdv{z) 
= j J 
\f(z)\e-^'""y^'y^-^dxdy. 
0 0 
Since |/(z)//^| is bounded on H, we have 
(2.6.13) 
|/(z)k-2"'"^/''/"' = 0(//2-2) 
(^._,Q) 
Moreover,/(z) = 0(e~^''^^'') (j^-^oo) uniformly on x. Therefore the integral (2.6.13) 
is convergent. Thus we can exchange the order of integration and summation, so 
that 
J 
fiz)griz)lm{zrdviz) 
r\H 
y€r,\r 
r\H 
= ] ^f{z)e-^''''"'''y'-^dxdy 
0 0 
cx) 
00 
h 
M = l 
0 
0 
0 
(m = 0), 
a^(47rm)^-''/z''r(/c-l) 
(m^l). 
D 
Corollary 2.6.11. Assume /c^3. If there exists a cusp x of F satisfying (2.6.8), then 
{gjr\z)\m^\} 
generates.9',{r,xl 
Proof We may assume x = oo and o- = 1 by the same reason as above. Let J/ be the 
subspace of ^^(r, x) generated by {g]!"^ (z)| m^ 1}, and J^-^ the orthocomplement 
of ^ . Take an element/(z) = Xr= i ^n^^"""^" of^\ 
then by Theorem 2.6.10, we see 
a„ = 0 for all n ^ 1, so that /(z) = 0. Therefore we obtain ^^ (F, x) = ^' 
• 
Assume /c^3 and let {xj,. . . , x^} be a set of complete representatives of cusps 
of r satisfying (2.6.8). For each x,- (1 ^ / ^ r ) , take GiGSLjiU) so that (TfX, = oo, and 
put 
(2.6.14) 
g,{z) = F,iz; 00, X. T,,, F)G%(F, 
xl 
Then we have 

§2.7. Hecke Algebras 
69 
Corollary 2.6.12. ///c^3, then ^^(r, x) is generated by the Eisenstein series ^,(z) 
given by (2.6.14), or 
Proof. Let us denote by ^ i ( r , x) the right-hand side. By Theorem 2.6.10, we see 
^ k ( A x) •= -^ki^y x)- Now let/(z) be an element of ^fc(r, x\ and x a cusp of F 
which does not satisfy (2.6.8). Then it is easy to see that/(z) vanishes at x. For each 
/, let a}J^ be the constant term of the Fourier expansion of/lfcO-^'S or 
{f\,ar){z) 
= a^i^^ •••• 
Then/(z) — ^J"^ ^ ajj^^^ (z) is a cusp form by Theorem 2.6.9(2). Therefore ^^(r, x) is 
generated by J^k(r, x) and ^fc(r, /). This combined with Theorem 2.1.7(1) implies 
the assertion. 
D 
We shall generalize Corollary 2.6.12 to /c^ 1 for modular groups in Chapter 7. 
§2.7. Hecke Algebras 
In this section, we explain the general theory of Hecke algebras. Though our 
purpose is the application to Fuchsian groups and modular forms, the groups 
considered in this section are abstract ones. 
Let G be a group, and T, f two subgroups of G. We say that F and F' are 
commensurable and write F^F' if 
\_F:FnF'^<oo 
and 
IF':F 
nF'^<oo. 
For a subgroup F of G, we put 
f={geG\gFg-'^F}. 
Lemma 2.7.1. (1) The relation % is an equivalent relation. 
(2) F is a subgroup of G. 
(3) 
IfF^F\thenf=f'. 
(4) Suppose F ^ F'. Then for any element a of T, we have the following coset 
decompositions: 
Tar = Llra7, = i J v r , 
'• 
j 
where {yj (resp. {Sj}) is a finite set of the representatives of (F' noL~^ F(x)\F' 
(resp. 
F/(FnoiF'(x-^)). 
Proof. (1): We have only to show the transitive law. Let Tj, Tj, F^ be subgroups of 
G such that F^^Fj. 
Fj^F^. 
Then 
lF,:F,nF2nF,:\ 
= 
lF,:F,nF2nr,nF2:F,nF2nF,:[ 
SL^,:F,nF2n^2•F2r^F,:i<co. 

70 
2. Automorphic Forms 
Similarly, we get [FjiTi n T j n r 3 ] < o o . Since r^nF^ 
^ r^^nFj^r^, 
we 
obtain [r^:T^ n Tj] < oo and IF^: T^ n Tj] < oo, so that F^^ F^. (2): Let g, h be 
two elements of F. Since 
h~^ g also belongs to T by (1). This shows that T is a subgroup of G. (3): If g is an 
element of T, we see 
gF'g~^ ^gFg~^ ^ F ^ F'. 
Thus g belongs to F' by (1); namely F a F'. Exchanging F and F\ we get F' a F. 
Therefore F = F'. (4): We can express every left T-coset contained in TaT' as Tay 
with some yeT'. For two left T-cosets Fay and F'ocy' contained in F(xF\ 
(2.7.1) 
Fay = 
Focy'<>y'y-'eF'na-'F(x. 
Since a ~ ^ Ta 
r', we have ^ = [r': T' n a 
Ta] < oo. Therefore, taking a 
complete set of the representatives {y^, . . . , y^} of (F' n(x~^Fo()\F', we get the 
coset decomposition 
FaF' = U ray, 
i = 1 
by (2.7.1). A similar argument is applicable to the second one. 
D 
Let S be a set consisting of subgroups of G, and A a subsemigroup of G. We 
assume that E and A satisfy the following conditions: 
(i) any two elements of S are commensurable; 
(ii) F ^ A :D F for all subgroups F m E. . 
Hereafter T, F\ T,, etc., indicate subgroups of G belonging to E. 
Let K be a commutative ring with unity. For two elements T, F' of E, we denote 
by ^^(r, F' \ A) the free K-module generated by double cosets FOLF' with cue A; 
namely 
^if(r, r'; J) = < ^ a^FixF' \a^eK, 
and 
«„ = 0 except for finitely many a>. 
Ue4 
J 
When r = r', we write simply 
mAF,A) = 
^^{F,F;A). 
When K = Z, we also write 
.^(r, r; zi) = .^z(r, r; zi), ,^(r, zi) = .^z(A ^). 
Assume that zl acts on a X-module M and write the action as 
M X zl 9 (m, (5) I—• m'^ e M; 
namely, the following properties are satisfied: 
(i) "mi—j-m^" is a K-endomorphism of M; 
(ii) m^^ = (m^)Vo''<5, yezi; 
(iii) m^=mfor the unity \ of A. 

§2.7. Hecke Algebras 
71 
We denote by M^the submodule consisting of the T-invariant elements of M; 
namely, 
M^= {me M \m^'= m for all 
yef}. 
Let rocF' = ]J. r<Xi be a coset decomposition. We define the action of Faf 
on M^ 
by 
m | r a r ' = ^m^', 
meM^. 
We also define the action of an element ^ = Y^^a^ra.r' of .^^^(r, T'; J) on M^by 
Lemma 2.7.2. Let the notation he the same as above. 
(1) m\rar' 
is independent of the choice of the representatives {a,}. 
(2) The mapping "mi—^•mlc" is a K-homomorphism of M^into 
M^. 
Proof For two elements a,, a- of FoeF' satisfying Ta, = Taj, there exists an element 
y of r such that a,' = ya,. Thus m'''= m^'''= m"'. This proves (1). It is obvious 
that "mi—)>m|(^" defines a X-homomorphism. Let us show ml^eM^'. 
Since 
FocF' = ]J. FoLi = \J. Fcn^y' for any element y' of F\ we have 
(m\Fa.F'Y = Im''^'^' = I" m"' = m | FocF' 
by (1). Hence m\F(xF' belongs to M ^ . 
D 
Lei F^OLF2 = III F^oCi, and F2 PF^, = Uj Fj Pj for two elements a, j? of J. We 
define the multiplication of FiCcF2 and F2PF3 by 
(2.7.2) 
F,ocF2'F2Pr, 
= 
^c,F,yF 3' 
where the summation is taken over all double cosets F^yF^ contained in A. 
The right-hand side is a finite sum, since c^ = 0 except for finitely many 
F^yF^s. We extend this multiplication linearly, and define the multiplication of 
i = l^a,r,aF2EPA^iF,^F2;A)sindri 
= 
Ypbf,F2PF,eP^^{F2,F,;A)by 
(2.7.3) 
irj=Y^a,hp{F,aF2-F2PF,). 
Lemma 2.7.3. The multiplication defined by (2.7.2) is independent of the choice of the 
representatives OL^, PJ, y. 
Proof Let KlFi\A'\ 
be the free K-module generated by left T^-cosets F^OL {cceA) 
contained in A, then KlFi\A^ 
is a right J-module by the right multiplication. The 
correspondence of r i a r 2 = [ J ^ i a , to Y^i^i'^i induces an injective K-homo-
morphism of Mf^{F^,F2\ A) into K[F^\A~\. Considering .^^l^n ^2'^ ^) ^s a 
K-submodule of K\^F^\A'] by this mapping, we obtain 
(2.7.4) 
.«^(r„r,;zi) = K[r,\/i]''^ 

72 
2. Automorphic Forms 
Let r^aTj = LJ, ^i^,, and r2pr^ = ]J^. Tj j5j be cosets decompositions, then by 
the definition of the action of i^x(^2' ^35 ^) on /C[ri\zi] ^^ we see 
(2.7.5) 
lr,a,\r2Pr, = Y,Y.ri^iPj. 
i 
I 
J 
Since the right-hand side coincides with the right-hand side of (2.7.2) under our 
identification, we see that 
(2.7.6) 
the action of^j^iFj. 
r^\ A) on ^ ^ ( ^ i . ^2; ^) = ^ [ ^ i \ ^ ] ^ ' is no other 
than the multiplication defined by (2.7.3). 
Hence Lemma 2.7.2(1) impHes the assertion. 
D 
The argument in the proof of Lemma 2.7.3 impHes also the following 
Lemma 2.7.4. Under the notation and assumptions as above, we have: 
(1) {m\i,)\i2 = m\{i,i2)for 
meM''\ i,e0^^(r,, 
T^; A\ and 
(2) (i,42)i3 = ii{i2i3)for i,eM^{r,, r^; A\ ^^^^^^{r^.r.-Ai and 
i,E,^^{r,,r^;A); 
(3) .^^(r, A) is an algebra over K with unity F; 
(4) If M is a right A-module, then M^ is a right ^^(r, A)-module. 
Proof. The first assertion is obvious by definition. The second assertion is obtained 
by (1) and (2.7.6). The third and the fourth are easily verified from (2) and (1), 
respectively. 
D 
We call ,^(r, A) (resp. .^K(^' ^)) the Heche algebra (resp. the Heche algebra over 
K) of r with respect to A. 
Lemma 2.7.5. If A ^ A', then ^/^(r. A) is a subalgebra of iMj^{r, A') under the 
natural correspondence. In particular, .^^(r. A) is a subalgebra of iMf^(r, T). 
Proof. We have only to show that the multiplication of ^^i^. A) coincides with 
that of ^x(r. A'). For two elements Tar, P^T of .^j^(r. A), denote the multipli-
cation of them as elements of .^j^(r. A') by 
P(^rr^r^Y.^y^y^-
y 
Since PyP cz PoLPpP ezl if Cy # 0, this coincides with the multipHcation as ele-
ments of ,^^(r, J). 
D 
Theorem 2.7.6. (1) For two subgroups F and Uofa group G, let A, D be semigroups 
of G such that F ^ A ^ F and U :=i D :D U. Further we assume 
(i) D = UA, 
(ii) UOLU = UOLF for any <xeA, 
(iii) Van A = POL for any oce A. 

§2.7. Hecke Algebras 
73 
Then the correspondence 'TaT i—• l/a(7" induces an isomorphism of Mf^(r, A) onto 
(2) When a K-module M is also a right D-module, the action of Mj^(r, A) on M^ 
corresponds to that of Mf^(LI, D) on M^ under the above isomorphism; namely, 
m|C/a(7 = m\rocr 
for meM^, 
cue A. 
Proof We note that T c [/ by (ii). Let ^ be the mapping of ^^(F, zl) into ^j^{lJ, D) 
induced by the correspondence 'TaF \-^U(xU'\ By (i), 0 is surjective. Suppose 
U(xU = UPU for two elements a, j8 of A. By (ii), there exist elements ueU, 
yef 
such that py = ua. Since Py = ua belongs to C/a n zl = Ta by (iii), we get 
TaT = rf^r. Therefore ^ is also injective, since ^^i^^ 
^) is a free K-module with a 
basis {(7aL/}. To see that <^ is a ring-homomorphism, we have only to prove that 
if r a r = U . r a . (aeJ), then C/a(7 = ]J,(7a,. Let r a r = [J,ra.. Condition (ii) 
implies U(x.U = lj,l/a,. If t/a, = UcCj, then oLjEUcCi n A = FOLI, SO that Ta, = FCLJ. 
Thus (7aC/ = ]J, L/a,.. This proves (2). 
D 
For an element ^ = ^^fl„(rar) of ,^(r, A\ we put 
deg(i) = X « « I A r a r | 
a 
and call it the degree of ^. Here | r \ r a r | indicates the number of left T-cosets 
contained in FOLF. In view of (2.7.5) and (2.7.6), we see easily 
(2.7.7) 
deg((^^/) = deg({)deg(^/) for 
i^rje^F^A). 
Lemma 2.7.7. Let aef. 
If \F\FoiF\ = \F(xF/Fl then F\F(xF and FOLF IF have a 
common set of representatives. 
Proof Let Tar = ]Jf.i Ta,-= WUi^i^- 
Then Fa^np^F ^ 0 
for any i, j . In 
fact, suppose FOLI n ^JF = 0 
for some i, j . Since Ta,- a [jk^jPk A we have 
Tar = r a , r = [jk^^jPh^y this is a contradiction. In particular. Fainp^F ^ 0 , 
so that taking an element SieFainp^F, 
we get Ta, = T^, and p^F = d^F. There-
fore we obtain 
F(xF= \\Fdi= 
\\diF. 
D 
Theorem 2.7.8. Assume that there exists a mapping i of A into itself satisfying 
(i) (apy = p^a' and (a')' = ocfor (x,peA, 
(ii) F' = r, 
(iii) Far = FocF. 
Then the following assertions hold. 
(1) For any oceA, F\FixF and F(xF/F has a common set of representatives. 
(2) The Hecke algebra .^^(r. A) is commutative. 

74 
2. Automorphic Forms 
Proof. Let r a r = ]J^ra, for oieA. Then TaF = TaT = (Far)'= JJ^alT. Thus 
(1) follows from Lemma 2.7.7. Hence we may put Focr — ]J,raf = y , a , r , and 
ry.rrpr = Xc, ryr, rprrar = Y^c^ryr, 
then 
= ^{{ij)\roi,pjr = ryr}/\r\ryr\ 
= j^{{ij)\rpWjr = ryr}/\r\ryr\ 
= ^{(ij)\rp)oi\ 
= ry'} 
Therefore we obtain TaF • rpr = FpF • rocF. 
D 
§2.8. Hecke Operators on the Space of Automorphic Forms 
In the previous section, we defined the Hecke algebra in the general framework. 
Now we are going to let Hecke algebras act on the spaces of automorphic forms. 
Let r be a Fuchsian group, and x a character of T of finite order. Considering F 
as a subgroup of GL2 (R), we put 
f={gEGLnm\9rg~'^r}. 
Let zl be a subsemigroup of F such that F ^ A ^ F. Assume that x can be extended 
to a character of A, which we denote by the same symbol x^ and that the following 
condition is satisfied: 
(2.8.1) 
if(xy<x~^GF(yeF,cceA\ 
then x('^y'^~^) = xij)-
Now 
let 
S 
be 
a 
set 
of 
all 
subgroups 
of 
F 
of 
finite 
index. 
For Ti, F2eS and aezl, put F^ccF2= L[v = i A'^v Then for any element/(z) of 
^fc(A.zX weput 
(2.8.2) 
{f\F,aF2){z) = dctiaf'-' 
X Zi^v) (/l.ocj(z) 
v = l 
d 
1 
v = l 
= det(a)''-' X z(av);(av,z)-''/(avZ) 
Theorem 2.8.1. (1) The above definition is independent of the choice of the rep-
resentatives a^, and 
f\r,ar,esa,(r„i). 

§2.8. Hecke Operators on the Space of Automorphic Forms 
75 
Moreover iffe'»,(r„x) 
{resp. e.9',(r„x)), 
then fir.ar^e^Ar^^X) 
(resp.e.r, 
{r2,x))-
(2) If r,, r2, Ties 
and a, PeA, then 
(f\r,ar2}\r2pr,=f\(r,ar2-r2l3r,). 
(3) Under the above action, ^^ki^^X) ^^ ^ right ,^{r, A)-module, and both 
^fc(r, x) cind e9^fc(r, i) are its ^(F, A)-submodules. 
Proof. Put 
r'eE 
reE 
F'eE 
Since 
.^k(rux) ^ s^A^i. 1) ^ '^kir, n r^, x\ 
for r^, FjEE, .9/^ is a vector space over C. Similarly, both ^^ and .9"^ are subspaces 
of j^k- Wc define the action of an element a of zl on j ^ ^ t>y 
r = d e t ( a f 2 - ^ ; ^ ( / | , a ) , 
/ e ^ , . 
Since by (2.8.1)/'' belongs to ^k(^i 
n a ' ^ r ^ a , / ) provided/ does to s^^ki^i^x) 
( F I G S ) , "/!—•/"" is a linear mapping of s^^. ii^to itself. It is obvious that 
(f'f 
=f'^ for any a, i?ezl. Thus A acts on j / ^ and s/p = ^ ^ ( ^ 1 , ;f) for any 
r^eS. 
Furthermore if/e ^ki^i^ 
X) ^^^ ^\^^2 = Wv^i^v (a^^X then we have 
V 
Hence by Lemma 2.7.2, the above definition is independent of the choice of the 
representatives a^,, a n d / | r i a r 2 belongs s^^ki^i^X)- ^ similar argument is also 
appHcable to the latter half of the first assertion. Assertions (2) and (3) are special 
cases of Lemma 2.7.4(1) and (4), respectively. 
D 
A linear mapping of s^ki^\^X) ii^^o ^^ki^i^X) 
induced by r^ar2 
{(xeA) is 
called a Hecke operator. 
Remark 2.8.1. Since the action of F^ ccFj on ^^ki^i^x) 
depends on k and x, we 
should distinguish an element of ^{F^, F2;A) from the Hecke operator. We use, 
however, the same symbol for simplicity, since the action of F^ cc F2 is determined 
uniquely. 
Remark 2.8.2. When x is the identity character, we can take as A any semigroup 
satisfying f^A^F.ln 
particular, .^(r, f) acts on j^kiH. ^kiH. and .^^ (F). 
Let ( , ) be the Petersson inner product. Then we have 

76 
2. Automorphic Forms 
Theorem 2.8.2. For oc e GL2 (tR), we put a' = clet(a)a~ ^. 
(1) Assume rI ^ Fj. ThenforoLEF]^( = F2), 
{f\k^.9) = {f.g\k^'\ 
f{z)e,9',{F,\ 
g(z)e^,(F,). 
(2) For OLE f, 
(f\FaF,g) 
= (f,g\Foi'F\ 
f{z)e.9^,(F\ 
g{z)e^,(F). 
Proof. (1): Put r = a ^ ^ r ^ a n r2. Since/|fcaG.9^fc(a~^ r^a), we see 
(/|,a,^) = . ( r \ H ) - ^ J 
dtt{ocf'j(a,zr'f{az)^)lm{zfdv{z) 
r\H 
= v{F\Uy' 
j 
dQi{oif^''f{z)g{oi-'z)j{(x,(X-'z)-nm{oi-'zfdv{z). 
ara-'\H 
Since a~^z = a'z, J{OL, a~^z) =j{a, oc'z) = dct{OL)J{(X\ z)~\ 
Im(a"^ z) = Im(a'z) 
= det(a')|7(a', z)\-^ Im(z), det(a) = det(a'), and v{F\H) = v{(xF(x-'\Ul 
we get 
( A a , ^ ) = v{ocFoi-'\Uy' 
j 
/(z) dei{oi'f^j{a\zy' 
g{oi'z)lm{zfdv{z) 
(2): Noting that - 1 e T if and only if - 1 G a " ^ Ta, we see 
[F:Fnoi-'roi^ 
= 
v{iFnoi-'roc)\H)/viF\U) 
= 
v{{aF(x-^nF)\U)/v{F\U) 
= 
lF:Fnocroc-'^. 
Thus Lemma 2.7.1(4) implies \F\F(xF\ = \FoiF/Fl 
so that both 
F\F(xF 
and F(xF/F has a common set of representatives by Lemma 2.7.7. We may put 
FoiF = ]Jy Ta^ = JJ^a^r for some {a^,}, then we have F(x~^F= W^Foc'^ and 
Fa' F = JJ^Ta'^. Therefore we obtain 
(/|rar,^)=det(af^-»X(/lfc«v,^) 
V 
= det(a)"^-'X(/,(/ka'.) 
V 
= (f,g\roi'r). 
a 
Corollary 2.8.3. Let x and \j/ be two characters of F of finite order. If x ¥" il^, then 
(fg) = 
Qforfe.9',{r,x)andge%{r,n 
Proof. Let y be an element of F such that xiy) 7^ '/'()')• Then 
x(y) (f g) = ( / U , g) = ( / 3l*y"') = •/'(rX/ ,</)• 
This implies (/;3) = 0. 
D 

§2.8. Hecke Operators on the Space of Automorphic Forms 
77 
Corollary 2.8.4. IffeJ^^in, 
then f\rareA\{r) 
for any 
aef. 
Proof. This is obvious from Theorem 2.8.2(2). 
• 
We now explain the geometrical meaning of Hecke operators. We assume 
elementary knowledge of algebraic geometry. Let 9? be a compact Riemann 
surface. Then 9^ is isomorphic to a nonsingular algebraic curve as complex 
manifolds. We define a subgroup of the divisor group of ^ by 
Divo(9?) = {aeDiv(9?)|deg(a) = 0}, 
then from (2.2.8), we have Div,(iR) a Divo(9?). The quotient group 
J = Divo(9?)/Div,(9?) 
has a natural structure of a complex manifold which is an abeHan variety. We call 
the abelian variety J the jacobian variety o/9?. We denote by DQ{J) the space of 
holomorphic differentials on J, then 
D'om^D'oiJ). 
Let now T be a Fuchsian group of the first kind. For a e T, the mapping 
H*9ZK^(z,az)eH* x H* 
induces an imbedding of 9^^^^^3^-1 into *iH^x '^p. We denote by r ( r a r ) the image 
of Rf^^f^-i 
in "IRY-X 9?^. Then TiFar) 
is an algebraic correspondence of *iH^ 
into itself. Put Farrpr 
= Y,dC3rSr for oc, pef, 
then 
T(roir) T(rpr) = Y^c^ Tirsr) 
3 
as algebraic correspondences. Moreover let n: V{*-^^j- 
be the canonical 
mapping, and Fotr = U^Fcc^. Then 
(2.8.3) 
T{FocF){n{z))=Y.n{oi^z). 
V 
We call T(F(xF) a modular correspondence. By (2.8.3), T(FccF) induces an endo-
morphism x(FaF) of the jacobian variety Jj-of ^p. The following diagram is 
commutative: 
'^lin 
— ^ ^ 
^s^jiF) 
u 
u 
u 
u 
In particular, take a congruence modular group for F. Then both ''Jip and J p 
are defined over Q or over a cyclotomic field. In the investigation of ^3^^ and J^, in 

78 
2. Automorphic Forms 
particular in the arithmetical investigation, for example, of Hasse zeta functions or 
field extensions generated by section points of J^, etc., the modular cor-
respondences TirccF) and the Hecke operators TaF play important roles. See 
[Shimura 2, 3, 4, 6], etc., for these theories. We shall study the Hecke algebra of 
modular groups in Chapter 4 and calculate the traces of Hecke operators on the 
spaces of cusp forms in Chapter 6. They are of course important in themselves. 
However, apphcations of them to number theory are always in our mind. 

Chapter 3. L-Functions 
In this chapter, we summarize basic facts of number theory and Dirichlet series 
for the succeeding chapters. Most of the important theorems are stated without 
proof. Readers who have number theoretical backgrounds can skip this chapter. 
§3.1. Dirichlet Characters 
Let N be a positive integer, and jf a character of (Z/NZ)"". For any integer /i, we put 
XinmodN) 
if {n, N) = 1, 
0 
if (n, A^) ^ 1, 
then / is a mapping of Z into C satisfying 
(i) ximn) = xi^)xin); 
(ii) x(m) = x(n) ifm = n mod A^; 
(iii) %(n) ^ 0 if and only if(n, N) = \. 
The characters x of (Z/NZ)"" and the mappings ;f of Z into C satisfying conditions 
(i) through (iii) correspond bijectively through (3.1.1). We call such a mapping x of Z 
into C a Dirichlet character mod N, or simply a character mod N. We call N the 
modulus of ;f. We call the Dirichlet character corresponding to the trivial character 
of (Z/NZ)"" the trivial character mod N. Further we denote by Xo the trivial 
character mod 1 and call it the principal character. 
For a Dirichlet character x iriod N, we define the complex conjugate x by 
(3.1.2) 
m-m 
(«ez), 
which is also a character mod N. For a multiple M of N, we put 
Xin) if 
(n,M)=l, 
'^^ ^ 
'0 
if (n,M)^ 1. 
Then x' is a character modM. We call it the character modM induced from x-
For a character x mod N, let M^ be the set of positive integers m satisfying the 
following condition: 
(3.1.3) 
if{n, N) = 1 and n = 1 modm, 
then xi^) = 1-

80 
3. L-Functions 
Since N belongs to M^, M^ is not empty. For any two elements m^, m2 of M^, the 
greatest common divisor of mj and m2 also belongs to M^. Therefore the smallest 
integer m^ contained in M^ is a divisor of all elements of M^. We call m^ the 
conductor ofx- When N = m^,;(is called a primitive character mod N. If an integer n 
is prime to m^, then we can take an integer n' so that {n', N)= \ and n' = n mod m^. 
We put 
{0 
if (n, m^) ^ 1, 
then x^ is a primitive character modm^. We call x^ the primitive character 
associated with x and x is induced from x^-
For two Dirichlet characters x "lod N and \j/ mod M, we put 
{xmn) = x{n)^l;(n) 
(neZ), 
then ;f (/^ is a character mod L for the least common multiple LoiN and M. Let now 
;f be a character modN, and N = WPP^ ^^^ decomposition as the product of 
primes. Fix a prime factor p. For an integer n prime to p, take a positive integer m so 
that 
_ f/t 
modp^ 
^ " j 1 mod N/p^ 
We put 
' X(yn\ if (rt,p)= 1, 
0, 
if 
(n,p)^\. 
lp{n) = 
Then it is independent of the choice of m, and Xp is a character mod p^. Furthermore 
we have 
(3.1.4) 
xin)=UXpin) 
(neZ). 
p\N 
For a primitive Dirichlet character x with conductor m, we define the Gauss sum 
ofx by 
m- 1 
(3.1.5) 
fF(/)= X zWe"""""-
a = 0 
The following lemma is fundamental. 
Lemma 3.LL Let x be a primitive Dirichlet character modm. 
m- 1 
(1) X Xia)e^'''''^^"' = x{b)lV{x) for any integer b. 
a = 0 
(2) 
W(x)W{x)^xi-m-
(3) mx) = xi-'^)mx)-
(4) |H/(z)P = m. 
Proo/ (1): First assume that b is prime to m. Since ;f(a) = xicib)xibX we see 
m - 1 
m - 1 
X /(ale^"'"""" = zW Z x(a/))e^'""'"" = ;((/,) PF(x). 
a = 0 
a = 0 

§3.1. Dirichlet Characters 
81 
Next suppose (b, m) / 1, and put n = m/(b, m). Define a subgroup H of (Z/mZ)"" by 
H = {de(TlmTY\ 
d= 1 modw}, 
and let (Z/m/)'' = ]Jc^^ be a coset decomposition. Since x is primitive, the 
restriction of / on // is not trivial. In addition, bd = b mod m for any deH. Thus 
we see 
a 
c 
deH 
c 
d e H 
(2): By (1), we see 
m- 
1 
b = 0 
m—1 m — 1 
= 
y 
y 
ytf2\^2niab/m^2nib/m 
b=0a=0 
m — 1 
TO— 
1 
= Z xia) Z e^"'"^''''^^/'". 
a=0 
b=0 
Since Z^^ o e^'"'*^'' "^ ^^/'" is equal to m if a + 1 = 0 mod m, and to 0 otherwise, we get 
^(x) ^(x) = x(— l)'w- Since x(— 1) = ± U we see 
m - l 
mx) = Z Z(a)e-^'"'""" = x{--i)mx) 
= 
Xi-'iWix), 
a = 0 
SO that 
W{x)W{x) = W(x)W{x)x(-'^) 
= m. 
Thus (3) and (4) are proved. 
D 
Lemma 3.1.2. Let x, ^ be primitive Dirichlet characters, and m^, m^ their conductors. 
//(m^, m^)= 1, then 
mx^) 
= X{m^)^(m^)lV(x)W(il/). 
Proof. Put m = m^ and n = m^i,. By the assumption, for any integer a, there exist 
integers b, c such that 
a = bn-{- cm. 
The integers b, c are uniquely determined modulo m and n, respectively, and when a 
runs over all the representatives of Z/mnZ, so does the pair (b, c) over the 
representatives of Z/mZ x Z/nZ. Therefore we see 
mx^) = '""t\x^)ia)e''''"'""' 
a = 0 
m-l Z xibn)e^''''""' 
Z ^{cm)e^'''"' 
b = 0 
/ 
\ c = 0 
= xH)^(m,)w(x)fv(,l^). 
a 

82 
3. L-Functions 
Lemma 3.1.3. (1) Let xbe a Dirichlet character mod m. Then for any integers / (> 0) 
and q, we have 
^ 
W i; x{a)e""-'"" 
{r = q/l) 
if l\q. 
a = 0 
(2) Let xbe a primitive Dirichlet character mod m, and x' the Dirichlet character 
mod/m induced from x- Then for an integer q, we have 
Im- 
1 
X X'(a)e''""'""" = mx) 
Z 
cumxWcmci/c), 
« - 0 
0<c\{l,q) 
where fx is the Mobius function. 
Proof We see that 
Im- 
1 
m - 1 
/ - 1 
a = 0 
d = 0 
b = 0 
0 
if /i(7, 
d = 0 
This impHes (1). Furthermore if x is primitive, then we see by Lemma 3.LI that 
(3.1.6) 
S X(a) 
Now we see 
Im - I 
im - 1 
Z z'We^"'-""" = Z 
Z 
/J(rf) Z(a)e'"'"""" 
« = 0 
« = 0 
\ 0 < d | ( a , / ) 
/ 
mc— 1 
= Z /'('')X('/) Z X(n)e'""'""', 
0<d\l 
n = 0 
where l^cd, a = nd. Applying (3.L6) to the last sum, we obtain (2). 
D 
Let p be an odd prime number. For integers n, we put 
1 i/ p\n 
and 
x^ = n modp is solvable in Z, 
(3.1.7) 
( ~ I = ^ ~ 1 if pin 
and x^ = n modp is unsolvable in 
0 
if 
p\n. 
We call I - 1 the quadratic residue symbol, or the Legendre symbol. The mapping 
"n I—• I - I" is a Dirichlet character mod p. We generalize the quadratic residue 
symbol and define I - I for integers a and b ({a, b) ^ (0,0)). When b is an odd prime 

§3.1. Dirichlet Characters 
83 
number, we define ( 7 I by (3.1.7). Next if 6 is 2, ± 1, or 0, we put 
!
1 
if a = \ mod 8, 
- 1 
if a = 5 mod8, 
0 
otherwise, 
(3.1.8) 
a_\_{ 
1 if 
a^d 
=T; 1-1 
if a<0, 
a\ 
| 1 
if 
a=U 
0) 
\0 
if 
a^\. 
In general, let ft be a nonzero integer. Express b as the product of ± 1 and prime 
numbers 
b = EWP 
( e = ± l , 
p: prime), 
and put 
We call [ - J the Kronecker symbol. The following theorem on quadratic fields is 
well known (see, for example, [Borevich-Shafarevich]). 
Theorem 3.1.4. Let F = Q(^m) 
be a quadratic field with a square-free integer m. 
For any prime number p, we have: 
(1) if \ ~] = U then p splits in F; 
(2) (/^ I — I = — U then p remains prime in F; 
(3) (/^ I ~ I = 0^ th^n P ramifies in F. 
Now let F = Q(^/m) be a quadratic field as in Theorem 3.1.4, and d the 
discriminant of F (for the definition of the discriminant, see §3.3). Then we have 
J m if m = 1 mod 4, 
[4m 
if m ^ 1 mod 4, 
so that ( — ) = (— I for odd p. We note that when d is the discriminant of some 
quadratic field, ( - ) coincides with the classical one. The following properties 
are well known. 

84 
3. L-Functions 
(3.1.10) 
For any integer d{^0\ 
the mapping "ni—• j - I" is a Dirichlet character, 
and ifd is the discriminant of a quadratic field, then "n i-* I - I" is a primitive Dirichlet 
character of conductor \d\. 
(3.1.11) If p is a prime number, —\, or —2, then we put 
I 
p 
if p = 
1 mod 4, 
— p if p = —\ mod4 
and p ^ —\, 
p* = { -4 
if p= - 1 , 
8 
if p = 2, 
8 
if 
P=-2. 
Then an integer d is the discriminant of a quadratic field if and only ifd is a product of 
distinct p*'s. In this case, if d = Up*, then 
/ p * \ 
[a\ 
(3.1.12) 
If p is an odd prime, then — 
= 
- ifor any integer a. 
V « / 
\PJ 
The last property is called the Gaussian reciprocity law. 
§3.2. The Riemann Zeta-Function 
For a sequence {a„}^= ^ of complex numbers, we put 
(t>is)= f 
a„n-' 
(seC), 
n= 1 
and call it a Dirichlet series. In particular, when a„ = 1 for all n ^ 1, we write 
n= 1 
and call it the Riemann zeta-function. Since for any s>0, 
f 
\n-'\S^-\-]x-^'^'^dx<<x) 
n = l 
1 
provided Re(s) ^ 1 + a, ((s) is convergent absolutely and uniformly on Re (5) ^ 1 + e. 
Hence C(s) is holomorphic on Re(s)> 1. Let us show that C(s) has the infinite 
product expansion 
as) = Ui^-p-T\ 

§3.2. The Riemann Zeta-Function 
85 
where p runs over all prime numbers. In fact, let s be a positive number. Then for 
any positive integer m, we see 
Ids)- n i^-p~r'\s 
I n-^'^^> 
on Re(s)^l+e. Since the right-hand side converges to 0 when m-^ oo, 
np<m(^ ~P^y^ 
converges to C(s) on Re(s) ^ 1 + £. Since a is arbitrary, the infinite 
product expansion holds on Re(s)> 1. More generally, if a Dirichlet series (/)(s) is 
convergent on a complex domain and has an infinite product expansion of the 
form 
cl>is) = U4>pisl 
p 
with a meromorphic function </)p(s) of p~*, we say that (pis) has an Euler product. 
Lemma 3.2.1. Assume that both Xl*=i ^n"* <^"^ Z«°= i ^n^~^ ^^^ absolutely con-
vergent at s = (To(> 0). // Y,^= 1 cin^~^ = X*= 1 ^n^'^ on Re(s) ^ OQ, then a„ = b„ 
for all n. 
Proof. It is sufficient to show that if Y,T= i ^n^^ = 0, then a„ = 0 for all n. Since 
Zn°=i^n"^ is absolutely convergent at S = (TQ, it converges absolutely and uni-
formly on Re(s) ^ OQ. Let m be the smallest integer such that a^^O. Since we have 
(n/m)"*' < n'*^^^ for n>m^ and o- > 0, we see 
\aJS 
f 
\a„\(n/m)-^ 
n = m H- 1 
g 
X 
l«J(n/m)-''+ 
£ 
|a„|n-°'^ 
(<7S<TO). 
Take a sufficiently large N so that 
and take a > 2(TO SO that 
m2 
N 
Y^ 
|a„|(n/m)-'+ 
^ 
lajn""'^ g |a„|/3. 
Then |fl^| ^f|a^|; this is a contradiction. 
D 
Let now K be any commutative ring, and K the ring of all formal power series 
over K with variables Up for all prime numbers p, or 
K = Kl\_Up I p: prime numbers]]. 
We call elements of K formal Dirichlet series. For the prime factor decomposition 
« = Op P''write 

86 
3. L-Functions 
Then any element of K can be expressed as 
00 
(/>(S)= X 
« « " " ' 
n = 1 
with a sequence {«„} of/C. Let </)p(s) be an element in K [[Wp]] for each p. Assume 
</)p(s) = 1 + (a formal power series in Up of degree ^ 1) 
for almost all p. Then the product np^p(^) ^^ meaningful in K. When a formal 
Dirichlet series (/)(s) can be written as the product 
<P{s) = l\<t>pis) 
(c/>p(s)eK[[Kj]) 
p 
in /C, we say that (pis) has a formal Euler product. Formal Dirichlet series and 
formal Euler products are useful to state relations among numbers a„. 
In general, Dirichlet series appearing in number theory can be analytically 
continued to the whole complex plane and satisfy functional equations. We study 
these for the Riemann zeta-function. For seC such that Re(5) > 0, we put 
00 
r{s)= 
je-'t'-'dt. 
0 
When Re(s) ^ e, 1 > 8 > 0, we see 
e-'t'-' 
= 
0(e-^'-'^') 
(r-^oo), 
0{t'-') 
( r - 0 ) . 
Then r{s) is convergent absolutely and uniformly on Re(s) ^ e. Hence r(s) is a 
holomorphic function on Re(s) > 0. By definition, r{s + 1) = sr{s) on Re(s) > 0. 
Therefore by putting 
r{s) = s-'r{s-\- 
1) 
(Re(s)> -1), 
r{s) becomes a meromorphic function defined on Re(s) > — 1. Repeating this 
procedure, r(s) is continued to a meromorphic function on the whole s-plane. We 
call r{s) the F-function. For complex numbers z( 7^ 0) and 5, we put 
(3.2.1) 
z' = ^^oogl-l + 'arg(z)) 
(-n< 
arg(z) ^ TT). 
The following properties of r(s) are well known (for the proofs, see, for example, 
[Ahlfors]): 
(3.2.2) 
r ( s + l ) = sr(5), 
r{n) = (n-\)\ 
{n^\)\ 
(3.2.3) 
r{s) is entire except for simple poles s = — n [n = 0,\, . . .) with residue 
(— \)"/n\, and has no zeros; 
(3.2.4) 
r{s)r{\ 
- s) = 7r/sin(7r5), 
r(l/2) = Jn; 

§3.2. The Riemann Zeta-Function 
87 
(3.2.5) 
for a, seC such that Re(fl) > 0, Re(s) > 0, 
]e-'"t'-^dt 
= 
a-'r{s); 
0 
(3.2.6) 
(Legendre's relation) 2^'" ^ r{s)r(s 
+ i) = 
^r(2s); 
(3.2.7) 
(Stirling's formula) r{s) = y/2ns'-'^'^e~'-'^^'\ 
where fi{s) is a function 
such that 
fi(s)-*0 
(Isl^oo) 
uniformly on Re{s) '^ (TQ > 0; 
(3.2.8) 
(Stirling's estimate) r(s) - ^^T''-^/^e""'^'/^ 
(s = (T + it, 
|T| -• oo), 
uniformly on any vertical strip v^ ^ c ^ V2; 
(3.2.9) 
(Euler-Gauss) r(s) = lim 
^^'^ , 
(0 < se R). 
Theorem 3.2.2. (1) Put 
A(s) = 
71-^''r{s/2K(s). 
Then A(s) -\ 
1- 
can be holomorphically continued to the whole s-plane, and 
s 
I — s 
we have the functional equation 
A(s) = A(l -s). 
(2) C(s) 
7- is entire. 
s — I 
Proof By definition, we see, on Re(s) > 1, 
(3.2.10) 
A(2s)= f 
(nn'^yje-'t'-'dt 
n= 1 
0 
00 
00 
= Z ie-''""*t'-'dt 
n= I 0 
0 0 / 0 0 
\ 
= 1 ( 1 
e-''""']t'-'dt. 
Here we can exchange the order of integration and summation since 
Zr= 1 ^"""''\t'~^\is integrable. Since for f(x) = e""^'^ Zr= - oo/(^ + ") is uni-
formly convergent, the Poisson summation formula implies 
00 
1 
00 
n = - 00 
y / t n= - CO 

88 
3. L-Functions 
Put (o{t) = Y^^ _ ^ e-^"'\ then (o(t) = ^ co(l/r), so that 
0 
12^ 
'^ ^ ' 
' 
25 
1 - 2 5 
Since co(r) — 1 = 0(e" "^ (f -• oo), the last integral is convergent uniformly on any 
compact subset of the s-plane. Therefore it is an entire function of s. Defining 
y4(25) for any 5 by the last integral, we obtain the analytic continuation of yl(5). In 
particular, A{s) -\- - -\- 
is holomorphic on the whole 5-plane. Moreover the 
5 
1 — 5 
last integral is invariant under the transformation "5i-^l/2 —5". Therefore 
we obtain the functional equation. The second assertion follows from (1) and 
(3.2.3). 
D 
More generally, for a function f(t)oxi 
IR+ = {xelR|x>0}, put 
(3.2.11) 
X{s)=^\f(t)t'-^dt. 
0 
If this integral is convergent on some domain, we call X(s) the Mellin transform 
of fit). By (3.2.10), yl(25) is the Mellin transform of i{co{t) - 1). Let now t = e^ 
and put 5 = (T + it, then we can rewrite 
A((7 + iT)= J /(e*)e^''-'">*^x, 
— 00 
that is, X{a -\- iz) is nothing but the Fourier transform of /(e*)^''* for a fixed 
a. Therefore the Mellin transform of f{t) is meaningful for a such that 
F(x) =f(e^)e*'^ is a Schwarz function; in other words, F(x) is a C°°-function and 
satisfies for any positive integers m and n. 
(3.2.12) 
sup 
„d'"F(x) 
x" 
< 00. 
dx' 
Conversely, f(t) can be obtained by the Mellin inverse transform 
(3.2.13) 
f{t) = ^, 
J 
k{s)t-^ds 
^7tl Re(s) = <T 
by the general theory pf the Fourier transform. Now take e~* for f(t). Since 
/(e*)^''* is a Schwarz function for a > 0, we have 
(3.2.14) 
^"' = T^ 
I 
r(5)r*^5 
((7>0). 

§3.2. The Riemann Zeta-Function 
89 
Also by taking i{(o(t) - 1) for f(tl 
by (3.2.10), we have 
(3.2.15) 
l ( c a ( 0 - 1 ) = / T 
J 
A{2s)t-^ds 
(a > 1). 
Hence i(ca(r) — 1) corresponds to A(2s) by the Mellin transform. 
We now define the theta function 6{z) by 
(3.2.16) 
e(z)= 
X 
e^.'"'^ 
(zeH). 
« = — 00 
Since the right-hand side of (3.2.16) is convergent uniformly on any compact subset 
of H, 6(z) is a holomorphic function on H. By the equality (o(t) = —= (o(l/t) and 
the holomorphy of 6{z), we have the transformation formula 
(3.2.17) 
e(- 
l/4z) = {2z/i)^''^e{z). 
As was shown above, this transformation formula is equivalent to the functional 
equation of the Riemann zeta-function. Hecke generalized this equivalence to the 
equivalence between functional equations of Dirichlet series and automorphy of 
functions on H, which is one of the main topics in Chapter 4. 
We conclude this section by calculating the values of C(s) at positive even 
integers, which we need later. Put 
te' 
F(t) 
and let 
(3.2.18) 
F(t)= 
f 
^ r 
be its Taylor expansion. The coefficient 5„ is called the m-th Bernoulli number. It is 
obvious that 
B„eQ, 
5o = l. 
Since F{-t) 
= F(t) - t, we see 
B, = 111, 
B„ = 0 if m(>i) 
is odd. 
Now we see easily 
(3.2.19) 
zcot(z) = iz -r, 
= iz + 
Comparing this with the well known partial fraction expansion 
(3.2.20) 
cot(z) = -+ 
t 
2 '^\ 2. 
z 
„ = 1 z^ — n^TC 

90 
3. L-Functions 
and putting t = — 2iz, we have 
t 
. * 
t^ 
'^'^='^2^\l.?Ti2^ 
<''^^"'^'' "^^'-
Since 
t^ + (2nny 
we have 
00 
/ 
f 
\2m 
f 
cx) 
00 
f2m 
f ( 0 = l + x + 2 X I (-1)""' 
2m-
2 
„= 1 m=i 
(2nn) 
The right-hand side is absolutely convergent, and therefore, we can exchange the 
order of summation. Thus we see 
Comparing this with (3.2.18), we know the values of f (2m). This combined with the 
functional equation implies 
a 2 m ) = 
, : , , : . 
B2„, 
(m^O), 
Theorem 3.2.3. For an integer m, we have 
- {2ni)^"' 
2(2m)! 
and 
ai-2m)=-B2j2m 
( m ^ l ) . 
We give the values of the first eight BernouUi numbers B„ for even m (see 
[Washington]): 
^^ = 6 ^ ^ = " 3 0 
^^ = 42 ^«=="30 
^^« = 66 
691 
7 
_ 
3617 
^^^""2730 
^^^"6 
^''~~^10' 
§ 3.3. Hecke L-Functions 
In this section, we recall some results from number fields and Hecke L-functions 
which are necessary later. Let F be a number field of degree g, and T^ ,. . . , T^ all the 
isomorphisms of F into C, and put F^ = F^% a^ = a^- for any aeF. The isomorphism 
Ty is called real or imaginary, if F^ cz [R or not, respectively. Hereafter we assume 
that 
(i) if V ^ Ti, then T^ is real, 
(ii) if ri + 1 ^ V, then T^ is imaginary, and ay = d^^r2 for ^^P (''i + 1 
^ v ^ r i + rj). 

§3.3. Hecke L-Functions 
91 
Here ^ = rj + 2r2. We say that F is totally real if r i = g, and that F is totally 
imaginary if r^ = 0. Let r^ c F be the ring of integers of F, / the group of fractional 
ideals of F, and P the subgroup of / consisting of all principal ideals. Then the 
quotient group I/P is of finite order and is called the ideal class group of F. We 
denote the order of I/P by h{F) and call it the class number ofF . For a non-zero 
integral ideal m of r^, we put 
/(m) = {ae/|(a,m) = l}, 
P(m) = {(a)eP\ a = l mod^'m}, 
where mod"" indicates the multiphcative congruence. Let (^ be a character of /(m) 
into C^ We call ^ a Hecke character modm if 
(3.3.1) 
i({a))=U^ 
iaJMpM^^ 
for (a)eP(m), 
v = l 
with real numbers u^, v^{l^v^ri-\-r2) 
such that 
(ii) I r, = 0. 
V = 1 
For a Hecke character ^ mod m, put 
M = {n: integral ideal of F | (3.3.1) holds for (a)eP(n)n/(m)}. 
We call the greatest common ideal m^ of elements of M the conductor of ^. When 
m = m^, i is called primitive. For any Hecke character ^ mod m, there uniquely 
exists a primitive Hecke character ^^ modm^ satisfying 
(3.3.2) 
(^«(n) = <J(n) if ne/(m). 
Furthermore when u^ and v^ satisfy the additional conditions 
(iii) w^ = 0 
(ri + l ^ v ^ r i + r 2 ) , 
(iv) v, = 0 
( l ^ v ^ r i + r 2 ) , 
a Hecke character ^ is called a class character. We can extend a Hecke character ^ 
to a mapping of / into C by defining ^(a) = 0 if a^/(m). 
Now we define the Hecke L-function for ^ by 
(3.3.3) 
L(s,^) = Y,aa)N(a)-^ 
(seC), 
a 
where a runs over all non-zero integral ideals of r^, and N(a) = Npia) is the 
(absolute) norm of a, namely, AT^ (a) = | XF/CL\. Using the convergence of the Riemann 
zeta-function, we see easily that L(s, i) is convergent absolutely and uniformly on 
the set Re (5)^ 1 + e, for any e > 0, and has the Euler product 
(3.3.4) 
L(s,0 = W-iip)N(vyT\ 

92 
3. L-Functions 
where p runs over all prime ideals of r^. In particular, when ^ is the trivial character 
{o, we write 
(3.3.5) 
CF{s) = L(s,io) = lN{a)-^ = 
Yli^-N{p)-T\ 
a 
p 
and call it the Dedekind zeta-function of F. When F = Q, it is nothing but the 
Riemann zeta-function. 
Hecke obtained the functional equation for any Hecke L-function by gen-
eralizing the proof for the Riemann zeta-function described in the previous section 
([Hecke]). Before we state the functional equation, let us define the Gauss sum of a 
Hecke character. We denote by tr = tr^ the trace mapping of F into Q, and put 
T)~^ = {aeF\tr(ab)eZ 
for all bexp}. 
Then X)" Ms a fractional ideal of F and the inverse D = X) (F) of T) ~ Ms an integral 
ideal. We call T)(F) the different of F. For a basis {aj, . . . , a^} of r^ over Z, we put 
4 = det[tr(a,aJ] 
(eZ), 
and call it the discriminant of F. 
Now let f be a primitive Hecke character of conductor m with M^, t^^. We put, 
for aeF (a^O), 
(3.3.6) 
(^^(a) = 'n'(«v/l«vlM«vh, 
v = l 
(3.3.7) 
if{a)=H(a))i^(a)-K 
lfa = b mod m, then if (a) = if{b). Let c be an integral ideal of F such that T)mc is 
principal and (m, c)= 1. Take an element b of Xp so that T)mc = (b), and define the 
Gauss sum W{i) of ^ by 
(3.3.8) 
W{^) = % ^ I^^(a)e^""«'>, 
where a runs over a complete set of representatives for c/mc. The value W{i) is 
independent of the choice of c, b and a set of representatives. By a similar argument 
as in Lemma 3.LI, we have: 
(3.3.9) 
\W(i)\' = N(m); 
(3.3.10) 
let i, rj be two primitive Hecke characters of conductor m and n, respect-
ively, //(m, n)= 1, then 
(3.3.11) 
Wm = i(n)rj{m) W(OW{rj). 
For a Hecke character { mod m, we put 
Ua)=m 
(ae/), 
then I is also a Hecke character modm. To state the functional equation for a 

§3.3. Hecke L-Functions 
93 
Hecke L-function L(s, ^), we put 
(3.3.12) 
A(,A)=y 
p^), 
j 
^ j y 
-^ 
jZ.(..?), 
where 
1 (v^ri), 
"" 
2 (ri + l^v). 
Now the functional equation for a Hecke L-function is as follows. 
Theorem 3.3.1. Let ^ be a primitive Hecke character of conductor m. 
(1) A(s, i) is analytically continued to a meromorphic function on the whole 
s-plane, and satisfies the functional equation 
A(l-s,i)=m)A{s,i), 
where 
T(i) = 
2'T"W(0/N{mYi\ 
ri -l-r2 
ri +r2 
v = l 
v = l 
(2) Ifi is the trivial character, then A(s, i) is holomorphic except for simple poles 
at s = 0 and s = 1; otherwise A(s, ^) is entire. The function A(s, ^) is bounded on any 
set of the form 
{seC|fl^Re(s)^fe, |Im(s)|'^c} {a<b, oO). 
(3) L(s, i) is entire if^ is not trivial. Ifi is trivial, then it is holomorphic except for 
a simple pole at s=l with residue 
T'^'^K'^Rh(F) 
where w is the number of roots of unity contained in F, and R the regulator off. 
Now we consider particularly the case when F = Q. Let x be a Dirichlet 
character modm. For a fractional ideal a = (a)(b)~^ (a, beZ, a,b > 0), we put 
Then x is a Hecke character and a class character. Any Hecke character of Q is 
obtained from a Dirichlet character in this way. We identify them. For a Dirichlet 
character x mod N, the Hecke L-function of x 
(3.3.13) 
L(s,x)= Z X(n)n-' = 
W-Xip)p-T' 
n= 1 
p 
is called the Dirichlet L-function of x- We also write the L-function as Ljv(s, x) in 
place of L(s, xX when we wish to emphasize the modulus N of/. If x^ is the primitive 

94 
3. L-Functions 
character associated with /, then 
(3.3.14) 
L^(s, x)=U 
(l-x'(p)p-')-L(s. 
x'l 
P\N 
We restate the functional equation of Theorem 3.3.1 for Dirichlet L-functions. This 
is necessary in Chapter 4. For a Dirichlet character x, we let 
(3.3.15) 
S^ 
0 
ifz(-l)-l, 
1 
iix(-l)=-L 
Corollary 3.3.2. Let x^^ ci primitive Dirichlet character of conductor m, and S = S^. 
Put 
/l(5,z) = (7r/m)-/2r('^')L(s,x). 
Then A(s, x) ^s meromorphic on the whole s-plane and is bounded on any set of the 
form 
{seC|a^Re(s)^^, |Im(5)|^c} 
(a<b,0<c). 
Moreover, A(s, x) satisfies the functional equation 
A(l-s,x) 
= 
^^A{s,B 
i\ 
m 
If X is not the trivial character, A(s, x) is entire. 
We can restate Theorem 3.1.4 by using Dirichlet L-functions and Dedekind 
zeta-functions as follows. 
Theorem 3.3.3. Let F = Q(^/d) be a quadratic field with discriminant d, and Xd = \ ~] 
the Kronecker symbol. Then we have 
Us) = 
as)L(s,xA 
In the previous section, we calculated the values of the Riemann zeta-function 
at positive even integers using Bernoulli numbers. Leopoldt generalized it 
to Dirichlet L-functions. Let / be a primitive Dirichlet character of conductor m. 
We put 
a= 1 t: 
1 
and let 
m= 
i^t" 
"o ni 
be the Taylor expansion. We call the coefficient B„^ the n-th generalized Bernoulli 
number associated with x- It is obvious that 
B„^,eQ{x) = 
Q(x{a)\aeZ). 
When X is the principal character, B„^ is nothing but the Bernoulli number B„. 

§3.3. Hecke L-Functions 
95 
Theorem 3.3.4. Let x be a primitive Dirichlet character of conductor m and S = S^. 
Let k be a positive integer. 
(1) If k = d modi, then 
L{K x) = 
{-^y'''-'"'^{2n/mf^, 
and 
L{\-Kx)=-B,Jk. 
(2) Ifk^S 
mod 2, then L(l - A;, x) = 0 except for m = \ and x = 1. 
For the proof and further results, see [Iwasawa], or [Washington]. 

Chapter 4. Modular Groups and Modular Forms 
In this chapter, we explain the general theory of modular forms. In §4.1, we discuss 
the full modular group 5L2(Z) and modular forms with respect to SLjCZ), as an 
introduction to the succeeding sections. We define and study congruence modular 
groups in §4.2. In §4.3, we explain the relation between modular forms and 
Dirichlet series obtained by Hecke and Weil. As an application of §4.3, we prove the 
transformation equation of rj(z) in §4.4. We explain Hecke's theory of Hecke 
operators in §4.5 and define primitive forms in §4.6. In §4.7 and §4.8, we construct 
Eisenstein series and some cusp forms from Dirichlet series of number fields. In 
§4.9, we explain theta functions which are also useful for constructing modular 
forms. 
§4.1. SL2{Z) 
We call SLjiZ) and its subgroups of finite index modular groups. We call SLjC^) the 
full modular group. In this section, we restrict ourselves to SLjiT) and give concrete 
examples of automorphic forms to provide a transparent prospect for the suc-
ceeding sections. In this section, we assume F = SL2(T), 
Theorem 4.1.1. SL2(Z) is generated by two elements \ 
and 
\. 
Proof. Put T= 
I ' ^ ^ i 
n ' ^^^ ^^^ ^ ^^ ^^^ subgroup of 5L^ 
ppose A ^ SL2Q 
• " - • = [ : : ] 
foo = min||fc||P 
MeSL2(Z)-^|, 
then hQ ^ 0. Take an element y^ = M^ 
? \oi SLjCZ) — A, and an integer n so 
generated by T and co. Suppose A i^ SL2(Z). Since 
coT~^co"^ = | ~ ' I and co^=—1, 
all elements of the form 
, U>f 5L2(Z) are contained in A. Therefore if we put 

§4.1. SL^iZ) 
that \aQ — UBQ] < BQ. Since 
97 
-1 n 
[-^0 
ao-nbol 
we get 
JQCO ^T"eA 
by the assumption on 
BQ. Hence 
JOEA; 
this is a 
contradiction. 
D 
Theorem 4.1.2. (1) The set 
F = {zeH| 
\z\ ^ 1 and |Re(z)| ^ 1/2} 
is a fundamental domain of F. (See Figure 4.1.1.) 
(2) We have v(F\li) — njl^. In particular, F is a Fuchsian group of the first kind. 
Proof (1): Let z be any point of H, and put L = {cz -\- d\c, deZ}. Since L is a 
lattice in C, any non-empty subset of L contains an element which has the minimal 
absolute value. In particular, there exists the minimal value among in the set 
{\j{y^ ^)ll7^^}- Since Im(7z) = Im(z)/|;(y, z)|^, there exists a point ZQ of H which is 
equivalent to z by an element of F and satisfies that 
(4.1.1) 
Im(zo) ^ Im(7Zo) 
forallyeT. 
Put T = K. 
. L then T'"Z = z + m for any integer m. Replacing ZQ with T'^ZQ, if 
necessary, we may assume | Re(zo)| S 111. Take y 
^ 
as y in (4.1.1), then 
Im(zo) ^ I m ( - 1/zo) = Im(zo)/|zol^ 
so that \ZQ\ ^ 1. This implies ZQEF. Therefore H = {jy^ryP- Next put 
U = {zeH| 
\z\ > 1 and 
|Re(z)| < 1/2}. 
Fig. 4.1. 

98 
4. Modular Groups and Modular Forms 
Then U = F. We are going to verify yU n U = 0 for y ^ ±1. Let y = \ 
, be 
Ic d_\ 
an element of F such that yU nU ^ 0, and take an element zeU so that yzeU. 
We may assume Im(yz) ^ Im(z) by taking 7"Mn place of y, if necessary. Then 
(4.1.2) 
\c\lm(z)S\cz + d\^ 1. 
Since z belongs to 17, we have Im(z) > y/3/2. Thus we get |c| ^ 1 noting that c is 
an integer. Suppose \c\ = 1. Then |z ± fi| ^ 1 by (4.1.2). On the other hand, we have 
\z ±d\> 1 for any integer d, since zeU. This is a contradiction; thus c = 0, 
y = ± 
L and yz = z + fe. For an integer b, both z and z + ft belong to U if 
and only if ft = 0. This imphes y = ± 
. Consequently, F is a fundamental 
domain of F. (2): Since v{F\H) = v{FX we get v(F\H) = n/3 by Lemma L4.4. 
D 
Theorem 4.1.3. (1) Any elliptic point ofF is equivalent toi = ^ — iorC = e"^'^- The 
point i is an elliptic point of order 2 and 
[I :]• <: -;]} 
The point C is an elliptic point of order 3 and 
.={4;:],.[; -;], 4::;]}. 
(2) The set Ppofthe cusps of F is Q u {00}, and all cusps of F are equivalent. 
(3) The genus of ^pis equal to 0. 
Proof (1): It is obvious that interior points of a fundamental domain are ordinary 
points. Thus any elliptic point must be equivalent to a boundary point of the 
fundamental domain F defined in Theorem 4.1.2. Since F contains 
=[i I] """^ "=[? i} 
the boundary points off, other than the three points r, f, and f ( = e^"'^^), are also 
ordinary points. Observing that the interior angle of F at i is TT, we see the order of i 
is at most 2. Since oi = i, and a>^ = — 1, the point i is indeed an elliptic point of 
order 2. Since xC = C and the interior angles of F at C and C are both 7r/3, the order 
of C is at most 3. Now we note 
=[: -;} <•»•'=[: ::]• 
Since TOJ fixes C, C is an elliptic point of order 3, and f' is equivalent to C- (2): It is 
obvious that the point 00 is a cusp of F. Let x (^ 00) be a cusp of F. Since x is a 

§4.1. SL2(Z) 
99 
double root of a quadratic equation with rational coefficients, x is a rational 
number. Conversely, let x be a rational number, and x = a/c its reduced fractional 
expression. Then we can take integers b, d so that ad — hc — 1. Put y [::i 
then yer and y oo = x. Therefore x is T-equivalent to oo. This proves (2). (3): Let g 
be the genus of ^p. By Theorem 2.4.3, Theorem 4.1.2(2) and above (1) and (2), we 
have 
l/6 = 2^-2 + (l-l/2) + ( l - l / 3 ) + l , 
so that ^ = 0. 
D 
We can calculate the dimensions of ^fc(r) and ^fc(r) using Theorem 2.5.2 and 
Theorem 4.1.3. 
0 
ifk^l, 
[/c/12]-l 
1//c = 2 mod 12, /c> 2, 
[/c/12] 
i//c#2modl2. 
Corollary 4.1.4. For an even integer k^2, we have 
Ain.<^<r^-^W12:\ 
ifk^lmodn, 
dim *»(1 ) - j |-^/i2] + 1 ifk^2 
mod 12. 
Here [x] denotes the largest integer ^ x. 
We are going to construct elements of ^kiH- For an even integer /c ^ 4, we put 
(4.1.3) 
E,iz)= 
f 
(mz-^n)-' 
(ZGH). 
m,n= 
— 00 
(m,n)#(0,0) 
We will prove below that Ej^(z) is convergent absolutely and uniformly on any 
compact subset of H, and is an automorphic form of weight k with respect to F. 
[: :h'-
Lemma 4.L5. The correspondence \ 
^ \^-^(c,d) gives a bijection between 
F^\F and the set 
{(c,rf)eZxZ|(c,^)=l}/{±l}. 
Proof. The surjectivity is obvious, while the injectivity is proved by (2.1.4). 
D 
Using the Poincare series in §2.6, we put for an even integer /c ^ 4, 
(4.1.4) 
G,(z) = F,(z;(t>o,Xo,r^.F), 
where (/)o = 1 and Xo is the trivial character of F. Then by Lemma 4.1.5, 
(4.1.5) 
G,(z) = ^ X {mz + n)-\ 
zeH, 
•^ m,neZ 
{m,n)= 1 

100 
4. Modular Groups and Modular Forms 
and 
(4.1.6) 
E,{z) = 2C(fc)G,(z), 
where C(5) is the Riemann zeta-function. 
Lemma 4.1.6. Let k be an even integer ^ 4. 
(1) Ef^{z) is convergent absolutely and uniformly on any compact subset o/H, and 
belongs to ^jt(r). 
(2) £fc(z) has the following Fourier expansion at oo: 
£,(z) = 2C(/c) + 2 - ^ ^ X cT,.An)e'^'"^ 
where 
0<d\n 
Proof Though the first assertion follows from (4.1.4) and the convergence of the 
Poincare series, we here give a direct proof. Let z be any point of H, and put 
L = {cz-\-d\c,dGZ}. For a positive integer n, let M„ be the boundary of the 
parallelogram with the vertices ±nz±n, and r(z) be the distance from the origin 0 
to the set Ml. Then r(z) is a continuous function of z. Since \Ln M„\ = 8n, we see 
(4.1.7) 
X 
|mz + n|-'=X; 
J 
N " ' g 8f(fc-l)r(z)-», 
m , n = — 0 0 
n = l (oeLnM. 
(m,n)/(0,0) 
SO that £fc(z) is convergent absolutely and uniformly on any compact subset of H. 
Lety = [^ 
J]er,then 
(4.1.8) 
m{yz) -\-n = {{am + cn)z + (bm + dn)}icz + d)'^. 
When the pair (m,n) runs over all Z x Z —{(0,0)}, so does the pair {am-\-cn, 
bm + dn). This proves the automorphy of E,,(z). Next let us show (2) and the 
holomorphy of E^iz) at oo. Now we can rewrite (3.2.20) into 
(4.1.9) 
7rcot(7rz) = z-^ + £ {(z + n)"^+(z-n)-^}. 
n = l 
/ i - 2 f ; e2«'«M. 
Moreover, by (3.2.19) we have 
(4.1.10) 
TicotfTTz) = ni\ 
Differentiating (4.1.9) and (4.1.10) k—1 times, we get 
(4.1.11) 
(-l)*(/c - 1)! jz"* + f ((z + n)-* + (z-n)-*)i 
(2nif X "''"'^ Ininz 

§4.1. SL2iZ) 
101 
00 
Since 
^ 
(z + n)"*^ is absolutely convergent, we can exchange the order of 
n = — 00 
summation on the left-hand side and rewrite it as 
(4.1.12) 
( - \ f { k - 1)! f 
(z + n)-'^ = (2nif f n'^-^e^^rmz 
n = — 00 
« = 1 
Therefore we obtain 
£»(z) = 2 X « - ' + 2 I 
Z (mz + n) 
= 1 n = — 00 
(AC— l j ! ; „ = i „ = i 
This proves (2). 
D 
It follows from Corollary 4.1.4 and (4.1.6) that 
(4.1.13) 
jr^(r) = C£fe(z) 
(feieven, ^4). 
Furthermore, for the study of ^^(r), it is useful to define 
(4.1.14) 
A(z)=12-HG^izf-G,{zn 
(4.1.15) 
J{z) = 
GAzf/A(z). 
It is obvious that J(z)e^i2(^) and J(z)e^o(^)- We note that in relation to 
elliptic functions and elliptic curves, it is more useful to consider the functions 
(4.1.16) 
g2(z) = eOE^izX 
g,(z) = 140E,(z). 
Then 
(4.1.17) 
{2n)''A{z) = g^izf - 
21g,{z)\ 
(4.1.18) 
i2ny'J(z)=n'g2iz)VA(z). 
Theorem 4.1.7. (1) A(z) belongs to Se^^iH- Let A(z) = ^^=1 t^e^"'"^ he the Fourier 
expansion, then T„eZ and T^ = 1. 
(2) A(z) has no zeros on H. 
(3) J^oi^) = C(J) and J{z) has the following Fourier expansion at oo: 
J(z) = e-2"'^ + f c„e2"'"^ 
C„GZ. 
n = 0 
Proof. (1): We have only to study the Fourier expansion of zl(z) at oo. For even 
integers /c ^ 2, 
-{2nif 
by Theorem 3.2.3. Since B^= —1/30 and B^ = 1/42, we have 
(4.1.19) 
G^(z) = 1 + 240^2"'"+ 
• , 
(4.1.20) 
G^{z) = 1 - 504e2«'z+ • • • . 

102 
4. Modular Groups and Modular Forms 
Therefore, putting A(z) = Xl^=oT„e^""'^ we get 
123TO = 1 - 1 = 0 , 
12^11 = 3-240+ 2-504= 1728 = 12^ 
Thus Ae6^i2in 
and TJ = 1. We postpone the proofs of the integrahty of T„ and (2) 
until Theorem 4.4.2. (3): The Fourier expansion of J (z) at oo follows from (1) and 
(4.1.20). By (2), J{z) has, as a function on 91 j-, a pole of order 1 at the cusp. Since 
KCtRr) is isomorphic to ^o(^) 
t>y the canonical correspondence, we obtain 
[^o(/^): C(J)] = n^(J) = 1 by (1.8.6). 
D 
Theorem 4.1.8. Let k'^ A he an even integer. Then ^k(r) has a basis 
{G4(z)'"G6(z)"|4m -\-6n = K m, n ^ 0}. 
Proof. It is obvious that if 4m + 6n = /c, and m, n ^ 0, then G4(z)'"G6(z)"e^fe(r). 
An easy calculation shows 
(4.1.21) 
#{(m,n)|4m + 6n = /c, m, n ^ 0} 
_ r[/c/12] 
i//c = 2modl2, 
"j[/c/12] + l 
i/fc^2modl2, 
= dim^fc(r). 
Thus we have only to prove that G4(z)"'G6(z)'' (4m + 6n = /c, m, w ^ 0) are Hnearly 
independent. Suppose they are not so, and let 
(4.1.22) 
X 
c„,„GJGJ = 0 
(c,,„eC) 
4m + 6n = k 
be a non-trivial linear relation. We define a polynomial of two variables X, Y by 
(4.1.23) 
F(X,F)= 
X 
c,,„X'"r. 
4m + 6n = k 
By assumption, F(G4, G^) = 0. Take two complex numbers ^74, b^ so that 
F(/74, feg) 7^ 0 and b^ — bl^ 0. Since for any complex number a,J(z) — a has a zero 
by (1.8.6), there exists a point ZQ of H such that 
(4.1.24) 
-^(^0) = 
^
. 
Now we are going to show the existence of a complex number c satisfying 
c^b^ = G4(zo), 
c^be = G6(zo). 
First assume 64 = 0. Then b^ ^ 0, hence we can take a complex number c so that 
c^b^ = G6(zo). On the other hand, G4(zo) = 0 by (4.1.24) and A{zo) ¥^ 0. This 
implies c^b^ = G4(zo). Next suppose ^4 # 0. Take a complex number c so that 
c^fe4 = G4(zo). Then we get c^b^ = ±G6(zo) by (4.1.24). Replacing c with - c , if 
necessary, we obtain c^b^ = G6(zo). Now, since A(ZQ) = 12~^c^(tJ - feg) # 0, we 

§4.2. Congruence Modular Groups 
103 
get c 7^ 0, so that 
this is a contradiction. 
D 
We conclude this section with a remark on £fc(z). We have 
(4.1.25) 
cE,(z) = - g + J^ a,_ 1 (n)e'^'"\ 
c = (k- 
\)\/2(2nif. 
Using the Fourier coefficients of (4.1.25), we put 
(4.1.26) 
L,{s)= 
f 
^,_i(M)n-. 
11 = 1 
Then we see easily that it is a product of two Riemann zeta-functions 
(4.1.27) 
L,(s) = asK{s-k+l\ 
and therefore, L^is) is convergent on Re(s) > /c, and has an Euler product 
p 
The analytical continuity and the functional equation of ((s) induce those of L^is). 
§4.2. Congruence Modular Groups 
For a positive integer N, we define subgroups FoiNX F^iN) and F{N) of 5L2(Z) by 
ro(Ar) = ] 
^ 
eSL2(/)|c = 0modiV 
ri(iV) = | | ^ 
MeSL2(Z)|c = 0, a = d 
=lmodN 
r(N):=\\^ 
\eSL2(Z)\b = c = 0, a = d= 
ImodN 
We note 
and 
SL2{Z) = Fo(l) = F,il) = F(n 
SL2{Z)^Fo{N):=>F,iN)zDF(N). 
Further if MIN, then 
FO{M)ZDFO(NI 
F,{M)Z,F,(NX 
F(M)^F(N). 
These subgroups are modular groups since IF(1):F{N)^ < oo, which will be 
proved below. We call F(N) a principal congruence modular group, and FQ(N) and 

104 
4. Modular Groups and Modular Forms 
ri(iV) modular groups of Heche type. We call N the level ofToiNX r^iN), and r(N). 
A modular group containing a principal congruence modular group is called a 
congruence modular group. For an element y = \ 
, eM2(Z), we define an 
Ic d] 
element Xf^iy) or y mod AT of M2(^1 NT) by 
A^(7) = 7mod -[^ :-l 
where a = a mod AT, h = bmodN, c = cmodN, d = dmodN. Then >ijv induces a 
homomorphism of SLjil) into SLjCZ/N/). We note that for integers m, w, 
(4.2.1) 
if(m,n,N)= 
1, t/ien f/iere exis^ integers m\ n' such that 
m' = mmodiV, 
n' = nmodN 
and (m\ n') = 1. 
This can be easily shown, for example, by the Dirichlet theorem on arithmetic 
progression. 
Theorem 4.2.1. Let Xf^ he the homomorphism of SL2{T.) into SL2(Z/NZ) defined 
above. 
(1) A^ is surjective. 
(2) Ker(Ajv) = r(N); in particular, r(N) is a normal subgroup of r{l). 
Proof. (2) is obvious. Let us show (1). Let | _ j | be an element of SL2(Z/NZ), 
and take integers a^, b^, c^, d^ so that C 2> 
[:;:;]--[:-'] 
Then a^d^ — biCi = l mod N, so that (cj, i/j, N) = 1. By (4.2.1), we may assume 
(ci,di)= 
1. Let n be an integer such that 
a^di —b^Ci = 1 + nN. 
Since (ci, f/J = 1, we can take integers fl2» ^2 so that a2^i — ^2<^i = — "• Putting 
a = ai -\- a2N, 
b = b^-\-b2N, 
c' = Ci, d = di. 
we see [: :]=-.«-[: :]-«=[: a 

§4.2. Congruence Modular Groups 
105 
Corollary 4.2.2. The mapping 
^ \i-^dmodNe(Z/NZ)'^ 
induces an iso-
morphism 
ro(N)/r,{N)^{z/NZ)\ 
r* *i 
r* b'l 
Proof. For two elements y = \ 
, and ?' = L^ 
^' p^^ ^o(^)» we see that 
^^'"L* cb'-\-dd'J 
and 
cb'-\-dd' = dd'mod N. 
Therefore the mapping is a homomorphism. The latter part is straightforward from 
Theorem 4.2.1. 
D 
We note that we can take a complete set of representatives of 
ro(N)/ri(N) 
consisting of the elements y of the form 
y mod -[::] 
Now let N = YlpP^ t)e the expression as a product of prime numbers. Then Z/NZ 
is isomorphic to ]~Jp(Z//7^Z) by the correspondence "a •—•[^^(^ ^ ^ ^ P^y-> ^^ ^^^^ 
MA^/NZ)^1\^2{^/P'^) 
p 
through the correspondence: 
[: 'Mi: 2]"-) 
It is obvious that if | 
ESL2(Z), then 
^ 
mod/)^G5L2(Z/p^Z). Con-
versely, suppose 
modp^ESL2(Z/p^Z) 
for all prime factors p of N. Then 
ad — bc = 1 mod p^, so that ad — bc= 1 mod N. Therefore we get the following 
Lemma 4.2.3. Let N be a positive integer, and N = YlpP^ ^^^ expression as a 
product of prime numbers. Then 
SL2(Z/NZ) 
- 
Y\SL2(Z/p'Z). 
p 
Theorem 4.2.4. For a positive integer iV, we have: 
(1) \GL2(Z/NZ)\ 
= (t>(N)\SL2(Z/NZ)\; 
(2) \SL2(Z/NZ)\ 
= 
N'Y\(l-\/p'). 
P\N 
Here <j) is the Euler function. 

106 
4. Modular Groups and Modular Forms 
Proof. The first assertion is obvious. We have only to verify (2) for a prime power 
N — p^ by Lemma 4.2.3. First suppose e=\. Then Z/pZ is a field, so that 
|GL2(Z/pZ)| is equal to the number of all ordered basis of the two dimensional 
vector space Z/pZ 0 Z/pZ over Z/pZ. Then it is given by p(p — l)(p^ — 1), thus, 
(1) implies 
\SL^(ZlpZ)\ = p(p^ - 1) = p^(l - 1/p^). 
Next assume e> \. Let 
/l':SL2(Z/p^Z)-SL2(Z/pZ) 
be the canonical homomorphism. Then X' is surjective by Theorem 4.2.1(1) and 
Ker(/l') = : :]'-.«^'H[: a-[; :]"«^4 
For any elements h, c, d of ZIp^Z such that 6 = c = 0 mod p, d = I mod p, 
there exists a unique element a of Z/p^Z such that ad — hc=\. 
Therefore 
|Ker(A')|= p^<"-^>, and 
|SL2(Z/p^Z)|=p3^(l-l/p2). 
D 
For a modular group T, we write 
f=z(r)c:Aut(H), 
where i is the homomorphism of SLjiT) onto Aut(H) defined in §1.1. Then 
r c^ r/Z{r). We also write, for the stabilizers T^ (zeH u IR u {oo}), 
f, = i(rj (^rjz(r)). 
Theorem 4.2.5. For an integer N^2,we have: 
(1) [f(l):f(iV)] = 
K n i ) : r W ] = i N 3 n ( l - l / p ' ) (iV>2), 
P\N 
[r(l):r(2)] = 6 
(iV = 2). 
(2) [f(l):fo(iV)]= [r(l):ro(iV)] = iV n ( l + l/p)-
i[ro(iV):A(N)] = (/>(iV)/2 (iV>2), 
(3) [ro(iV):A(iV)] 
^^^^(,)^^^p)3^, 
( ^ ^ , ) 
Here (j) is the Euler function. 
Proof Since r(2)9 - 1 and r(N)i - 1 for N > 2, we see 
LMiJMJv;j 
|[-^(ij.^(2)] 
(JV = 2). 

§4.2. Congruence Modular Groups 
107 
Thus we obtain (1) by Theorem 4.2.1 and Theorem 4.2.4. Since Ker(Ajv) 
= r(N) c TiCAT), we see that 
[r(l):ro(iV)] = 
lSLAZ/NZ):X^(ro(Nm 
and 
[ro(iV):A(iV)] = [A^(ro(iV)):A^(A(iV))]. 
Furthermore 
eSL2(Z/NZ)\ae(l/NZy,beZ/NZy 
Va b 
1 
\_0 
fl-ij 
and 
^N(A(^^)) = ^ | ' 
] 
\eSL2{Z/NZ)\beZ/NZ 
Therefore \?.j^(ro{N))\ = NcpiN) and |A;v(^i W)l = ^. Noting that -leToCN), 
- 1 e Ti (2) and - 1 ^ Tj (iV) for AT > 2, we obtain (2) and (3). 
D 
Lemma 4.2.6. Iff is a modular group, then any elliptic element off is of order 2 or 3. 
Proof. Though the assertion is obvious from Theorem 4.1.3, we give here an 
algebraic proof. We may assume T a — 1 by taking T • { ± 1} in place of F. Let 
Va 
bl 
y = \ 
, be an eUiptic element of T, and z a point of H such that yz = z. By 
Ic d_\ 
definition, we see |a + ^| < 2, so that the characteristic polynomial of y is X^ + 1 or 
X^ ±X -^ 1. Hence j " ^ = 1 or 7^ = 1. Since the stabilizer F^ is cyclic by Theorem 
1.5.4, and T^a — 1, F^ is a cyclic group of order 2 or 3. 
D 
We are going to study eUiptic points and cusps of modular groups. For a 
modular group T, we denote by V2(F) (resp. v^iF)) the number ofinequivalent elliptic 
points of F of order 2 (resp. 3), and by v^(F) the number ofinequivalent cusps ofF. 
Let Pph^ the set of the cusps of F. By Corollary 1.5.5 and Theorem 4.1.3, we see 
^r=^r(i) = Q^{oo}. 
Since all points of Q u {00} are r(l)-equivalent, 
(4.2.2) 
the correspondence "r(l)9a 1—•aooeP/ induces a bijection of 
F\F{\)/ 
F{\)^ onto 
F\Pr. 
In particular, 
(4.2.3) 
\F\Pr\ = 
\F\F(l)/F(\U. 
Next we assume — 1 ^ T. To distinguish regular and irregular cusps of T, we put 
(4.2.4) 
r ( l ) : = <^l 
. 
\\nel[^r(l) 
^={[; :]l"' 

108 
4. Modular Groups and Modular Forms 
and define a mapping 
»;:r\r(i)/r(i): —> r\r(i)/r(i)„ 
(4.2.5) 
UJ 
U) 
rar(i): 
I—> rar(i)„. 
Since [r(l)„:r(l)*] = 2, the number of the inverse image by rj of each element of 
r\r(l)/r(l)„ is l or 2. Let 7 be an element of r(l), then we see that 
(4.2.6) 
k-i(ryr(i)„)| = i<>rvr(i)„ = ryr(i): 
o(y-iry)r(i):3r(i)„ 
•-[-; -;] 
oy~^ry3\ 
withh>0 
0700 is an irregular cusp. 
Now we shall calculate V2(r) and v^{r) for T = TQCN), TiCN) and r(Ar). 
Theorem 4.2.7. For N ^ 2, we have: 
) 
i/' 4|iV, 
V2(^o(N)) 
RO^IT))'^^^"' 
v3(ro(N))= ^ 
R(-(T)) 
if 
9\N, 
if 
9tAr, 
v„(ro(N))= 
X <l>Hd,N/d)) 
0<d\N 
P\N L/ = 0 
J 
\ 
P 
/ 
Here (j) is the Euler function; ( —) denotes the quadratic residue symbol (see §3.1). 
Proof. Put V, = Vi(ro(N)) for i = 2, 3 and oo. First we calculate V3. Let ZQ be an 
elliptic point of TQCAT) of order-3. Since — 1 ero(N), rQ(N)^^ is a cyclic group of 
order 6. By Lemma 1.3.5(1), there exist exactly two elements of ro(N)zo of order 6, 
which are not conjugate. Therefore, 
^3 = i # {ro(N)-conjugacy classes of the elements of order 6 in FoiN)}. 
On the other hand, 
n 
1 
t>elongs to the normalizer of FQ{N% and the 

§4.2. Congruence Modular Groups 
109 
conjugate of an elliptic element of ToCiV) by 
is also an elliptic element of 
the same order. Put 
••«{-; :i 
then by Lemma 1.3.5(1), 
V3 = # { r j (iV)-conjugacy classes of the elements of order 6 in FoiN)}. 
Put C = ^"'^^, and let a be an element of TQCN) of order 6. Put 
={rah 
We define the action of Z[C] on L by 
ic 
Then L is a left Z[C]-module. Since aeToCiV), the subgroup 
La = \\ ,^, Wa^beZ 
„.«[:]=.[:].M[;]. 
•""{Ulh 
of L is stable under the action of Z[f]. Since Z[f] is a principal ideal domain, L is 
isomorphic to a direct sum of copies of Z[C]. Therefore comparing the ranks of L 
and Z[(] over Z, we see that L is isomorphic to Z[f] as Z[C]-modules. We denote 
this isomorphism by p, and put 
Since LQ is a Z[Q-submodule of L, /„ is an ideal of Z[C]. Since any Z[C]-
automorphism of Z[f] is obtained by the multiplication of a unit of Z[f], /„ is 
independent of the choice of p. Moreover 
(4.2.7) 
ZlCVIa^L/LoC^Z/NZ. 
Let P be an element of ro(N) conjugate to a by an element of FQ (N). Since LQ is 
stable under the left multiplication of any element of FQ(N\ we get Ia = Ip-
Conversely, if / is an ideal of Z[C] satisfying 
(4.2.8) 
Z [ C ] / / ^ Z / N Z , 
then there exists a basis {wj, Wj} of Z[Q over Z such that 
(4.2.9) 
{wi, iVw2} is a basis of I over Z. 
Let a e M2 (Z) be the representation matrix for C with respect to the basis {Wi, Wj}, 
namely 
(4.2.10) 
(Cwi,Cw2) = (wi,W2)a. 
Since the minimal polynomial of C over Q is X^ — X -\- 1, we see det(a) = 1. 
Furthermore since / is an ideal of Z[C] and {wj, NW2} is a basis of /, we see 

110 
4. Modular Groups and Modular Forms 
aeToCiV). Next take another basis {wj, W2} of Z[C] satisfying condition (4.2.9), 
and let a' be an element of ToCAT) determined by a basis {vv'i, Wj} as above. Let y be 
the element of Mj (/) such that 
(w'i,w'2) = (wi,W2)y. 
Then by the choice of {w^, W2} and {w'l, W2}, we see 
and a' = 7~^ay. Consequently, the set of TQ^(Ar)-conjugacy classes of elements of 
FoiN) of order 6 corresponds bijectively to the set of the ideals / of Z[Q satisfying 
(4.2.8). Thus 
V3 = # {ideals / of Z[G 
such that 
Z[C]// ^ Z/ATZ}. 
By Theorem 3.1.4, 
'^0 
if 9|iV, 
U{'<T)) 
' •>*" 
A similar calculation is also applicable to Vj. 
We shall calculate v^. Let M^ be the set of all elements of order N in 
Z/iVZ X Z/NZ. 
We note that for (m, 
n)eZxZ 
(m, n)eMf^o{m, n, N) = 1, 
where m = m mod AT, and n = n mod N. By (4.2.1), we see that 
(4.2.11) 
the mapping of r(i) into Mff defined by "7 = 
, !—>•(«, c)" is surjective. 
We define an equivalence relation on M^ by 
(a, c) ^ (a', c')o(a', c') = ± (ma + nc, m"^ c) 
(me(Z/iVZ)\neZ/iVZ). 
Then the mapping in (4.2.11) induces a bijection: 
ro(iV)\r(i)/r(i)^^M^/^. 
Then M^^ = Y[p ^p^ ^^^ the equivalence relations on M^ and Mpe are compatible 
with the product decomposition. In particular, |Mjv/ ~ I = HPI ^ P « / ^ l» ^^^ there-
fore, we have only to calculate v^ when N = p^. Any element (a, c) of M^^ is 
equivalent to an element of the form (*, p^) (0 ^ / ^ e), and/is uniquely deter-
mined. I f / > 0, then ae(Z/p'Zy, 
and 
(a, J^) - (a', y)od 
= d' mod p"»i"(/'^-/). 
I f / = 0 , then all elements of {(a, T)|aeZ/p^Z} are equivalent to each other. 

§4.2. Congruence Modular Groups 
111 
Therefore we obtain 
Next we study elliptic points and cusps of r^iN) and r(N). 
Lemma 4.2.8. Let F be a Fuchsian group, and F' a normal subgroup of F of finite 
index. For a cusp x ofF, the number of F'-inequivalent cusps which are F-equivalent 
to X is equal to 
if-.r'mf.-f'.']-
Proof Since F' is a normal_ subgroup oj" f, F' F^'is di subgroup of f and the 
number is given by \F'\FIF^\ = \FIF''F^\. Since 
lF'.F'-] = 
lF'.F''F,-]iF''F,'.F'^ 
= if:rf,-]lF,:r,^, 
we obtain the result. 
Theorem 4.2.9. (1) Tj (iV) (AT ^ 4) has no elliptic elements. 
1 
D 
(2) 
v^(F,(N)) 
Y^ (f)(d)(t)(N/d) {all cusps are regular) (N ^ 5), 
(N = 4). 
(We note that F^ (AT) = Fo(N) if iV = 2, 3.) 
2 0<d|iV 
3 (2 regular cusps and 1 irregular cusp) 
Proof (1): Let y = 
:
> 
an eUiptic element of F^iN). By definition, 
\a-\- d\ <2 and a-\- d = 2 mod N. So there is no such element if N ^ 4. 
(2): Let M^ be the set of all elements of order N of Z/NZ x Z/NZ. Define two 
equivalence relations ^ and L on M^y by 
(a, c) ^ (d\ c')o(d\ 
c')= ± (a + nc, c) 
(a, c) ^ (d\ c')o(d\ 
c') = (fl H- fie, c) 
Then we have the commutative diagram: 
r i ( i V ) \ r ( i ) / r ( i ) : ^ M ^ / 
{neZ/NZ), 
(neZ/NZ). 
F,(N)\F(\)IF(\), 
MJ 
Here the horizontal mappings are the bijections induced by the correspondence 
"r(l)9 
!-• (a mod iV,c mod iV)GM^", and the vertical mappings rj and ^ 

112 
4. Modular Groups and Modular Forms 
are the natural mappings. First suppose AT ^ 5. Then f is a two fold covering and 
| M ^ / ^ | = i | M ^ / ^ | . 
Then all cusps of ri(iV) are regular by (4.2.6). By an argument similar to the case of 
To (AT), the calculation of \Mj^/ -^ | reduces to the case N — if. Let cetjifL, 
and/ 
be the largest integer such that 0 ^ / ^ e, and c = 0 mod p^. Then 
(fl, c) ^ (a', c) o a = a' mod p^. 
Thus, for a fixed c, the number of inequivalent (a, c) is </>(p^). Consequently, 
we obtain 
Next let AT = 4. Then the set {(± 1,0), (0, ± 1), (1,2)} is a complete set 
of representatives of MJ'r^ . Since (1,0) ~ (— 1,0) and (0,1) '^ (0, — 1), we get 
|M4/^| = 3, and first two classes are regular and the rest is irregular by 
(4.2.6). 
D 
Theorem 4.2.10. (1) r{N) {N ^ 2) has no elliptic elements. 
r 
Vn(i-i/p') (iv^3), 
3 
(N = 2). 
(2) v^(r{N)) = 
When N ^ 3, all cusps are regular. 
(3) We can take as a complete set of representatives of inequivalent cusps the set 
{m/neQu {oo}|(m, n) = 1, (mmodN, nmodN)eMf^/{ ±1}}, 
where Mjy is the set of elements of order N in Z/NZ x Z/NZ. 
Proof. (1): Since r{N) is a normal subgroup of r(l), any r(l)-conjugate of an 
element of r{N) belongs to r{N). By Theorem 4.1.3, any elliptic element of r(l) is 
conjugate to 
4: -;]• 4; -:]• 4: ::]• 
and none of them belongs to r{N) if N ^ 2. Therefore, r(N) (N ^ 2) has no elhptic 
elements. (2): By Lemma 4.2.8, 
Voo(r(N)) = [f(l):f(N)]/[f(l)^:f(iV)^]. 
Therefore, the assertion is straightforward from Theorem 4.2.5 and the definition of 
regular cusps. (3): Connecting the mappings in (4.2.2) and in (4.2.11), we easily 
obtain a bijection: 
r(N)\Pr,s) ^ r(N)\r(i)/r(i)^ ^ M^/{ ± i}. 
Thus we obtain (3). 
D 
Now the genus of ^pfov a. modular group F is given by the following 

§4.2. Congruence Modular Groups 
113 
Theorem 4.2.11. Let F he a modular group, and g the genus of^p. Then 
where V2 = v^Cr), V3 = v^(n Voo = v^n 
and ft = [ f ( l ) : f ]. 
Proof. Since 111^= Hf-^j, there exists a natural mapping 
F: ^r= r\n*r 
>^rii) = ^(l)\H'^(l). 
We put H* = H* = H'^(l), and 9? = ^^1)- Let TT^: H* - 91^, and TT: H* - 91 be 
the natural mappings. For any point b of 91/^, take a point z e H* so that np{z) = b. 
Let C/ * be a neighborhood of z in H* given in §1.8. Since F°nr= 
n, the following 
diagram is commutative: 
(4.2.12) 
. , / 
\ 
f 
U? 
•71(17?) 
n 
Hence {9?^-, F} is a covering of 9? of degree ft. Let e^ = ^b,F ^ the ramification 
index of the covering at b, and put F(b) = a. Let 82,83 and a^o be the elliptic points 
of order 2 and 3, and the cusp on % respectively. Ifa#a2,a3,aoo, then b is an 
ordinary point, so that n and n^ are homeomorphisms on I/*, and e^= 1. Suppose 
a = 82, then e^ = 1 or 2. We see 
^b = loF induces a homeomorphism of UpiU*) on to n(U*) 
oz is an elliptic point of F. 
Put 
r=#{b69{^|F(b) = a2}, 
then // = V2 + 2(^ —V2). Therefore 
(4.2.13) 
2 : 2 K - l ) = / ^ - ^ = (/^-V2)A 
where E2 is the summation over the points b such that F(b) = 82- A similar 
argument implies 
(4.2.14) 
X,{e^-l) = 2{fi-v,)/3, 
where E3 is the summation over the points b such that F(b) = 83. Next assume 
F(b) = 800. Then b is a cusp on 91 j^, and 
v^=#{be9?^|F(b)=^8„}. 
Denote by 2,^ the summation over the cusps b such that F(b) = a^. Then 
2oo^b = /^' so that 
(4.2.15) 
E«(^b-l) = /^-Voo.. 
Consequently, the formula of the genus follows from (4.2.13), (4.2.14), (4.2.15) and 
the Hurwitz formula (1.8.8). 
D 

114 
4. Modular Groups and Modular Forms 
§4.3. Modular Forms and Dirichlet Series 
Automorphic functions and automorphic forms for modular groups are called 
modular functions and modular forms, respectively. They are closely connected with 
number theory. 
Let r be a congruence modular group. By definition, there exists a positive 
integer N such that T =3 r(iV), so that 
<^,(r)cz%(r(N)). 
Therefore the investigation of ^^(r) is reduced to that of ^fc(^(^))- Furthermore, 
we see 
= l\^ 
^\eSL2(Z)\c 
= 0modN\ 
a = ^ = l m o d i v | 
Hence, if f(z)e<^k(r{N)), then 
f(Nz) = N-'/'(^f\J^ 
^Vj(z)e%ir,{N')y 
We note that if/(z) = Xr=o ^n^^"'"^^^ is the Fourier expansion at oo, then 
2ninz 
f(Nz) = X c^e 
Therefore the Fourier coefficients of f(Nz) essentially coincide with those of/(z). 
Consequently, the study of modular forms with respect to congruence modular groups 
is reduced to that of%{r^(N)). 
Let X be a Dirichlet character mod AT. We define a character x of ToCN) by 
(4.3.2) 
X(y) = x{d\ 
r = h 
^lero(iV). 
Lemma 4.3.1. For a positive integer N, we have 
X 
X 
^*(A(N)) = ©>-»(ro(iV)a), 
X 
where x ^uns over all Dirichlet characters mod N. 

§4.3. Modular Forms and Dirichlet Series 
115 
Proof. Since r^iN) is a normal subgroup of ToCiV ), ToCN) acts on %(ri(N)) 
by 
"f h-+/|j^y", (yGToCN)). This action induces a representation of rQ(N)/ri(N) 
on 
^k(A(^))- Since ro(N)/ri(N) 
^(Z/NZy, 
all irreducible representations of 
rQ(N)/ri{N) 
are induced by Dirichlet characters modiV as above. Therefore we 
obtain the lemma by decomposing the above representation into irreducible 
representations. A similar argument is appHcable to other cases. 
D 
By the above lemma, we shall consider exclusively %{rQ(N), xX ^kiroi^X 
x) 
and ^fc(ro(Ar), /). Hereafter we simply write 
^k(N,x) = ^k{roiN%xX 
^AN,x) = ^kiro{N\xl 
^kiN.x) 
= 
^kiro{Nlxl 
Let M be a multiple of N. We also express the character mod M induced by a 
Dirichlet character x mod N by the same symbol x- Then 
%{N,x)^%iM,xl 
^,(iV,z)c:^,(M,x), 
and by Theorem 2.1.7(2), 
For a modular form f(z) = ^^= Q a„e^''^'''e%{N, x\ we put 
(4.3.3) 
/,(z) = f a„e2"^-, 
n = 0 
where a„ is the complex conjugate of a„. 
We put, for a positive integer AT, 
co^ = cw(A^) 
[N 
O| 
Lemma 4.3.2. Let x be a Dirichlet character mod Af. 
(1) Ifx(-l) 
^ ( - If, (''en «i(N,z) = {0}. 
(2) The correspondence "/•-•/In a>j»" induces the isomorphisms: 
(3) lff(z)e%(N, 
X) (resp. &',(N, x), JV,(N, x)), then 
f,(z)=f(-z) 
and it belongs to 1$t(N, x) {resp. S^^(N, x), J^^N, x))-
Proof. The first assertion is obvious from (2.1.27). (2): For f{z)e%(N, 
x), we put 
g =f\k(ON- P'"' 5* = 
cjv d r ^»^^^' * * ''^^^ 

116 
4. Modular Groups and Modular Forms 
d 
(4.3.4) 
coj^ycoN = 
Therefore 
and 
:]• 
-bN 
co',= -N. 
glkJ = xMg = x(y)9' 
This impHes the automorphy condition. The'rest of (2) follows from (2.1.31) and 
Theorem 2.8.2. (3): The first part is obvious. For an element y = | 
j \eSL2(Z), 
we put 
r ''=L-c 
d\-
Then 
(4.3.5) 
/pLy = (/L7')p, 
yeSL^iZl 
by the first part. In particular, ifyerQ(N), then fp l^y = x(y)fp- The conditions at 
cusps are also verified by (4.3.5). Now for f{z)e\(r^(N)) 
and 
g(z)e9'k(r^(N)\ 
we see easily 
(4.3.6) 
(f,.g) = {f.9,). 
This implies that if/(z)e^fc(N, /), then j;(z)6^fc(Ar, /). 
D 
Any element f(z) o{%(N,x) has a Fourier expansion of the form 
/(z) = f ay^'"\ 
n = 0 
Nevertheless a holomorphic function /(z) on H with a Fourier expansion is not 
necessarily a modular form. If/(z) is an Eisenstein series with respect to r( 1), then 
the Dirichlet series defined in (4.1.26) by using the Fourier coefficients is a product 
of two Riemann zeta-functions. We analogously define a Dirichlet series </)(s) using 
the Fourier coefficients of /(z) by 
00 
</>(«)= Z ««""'• 
n = 1 
If/(z) is a cusp form of weight /c, then we have a„ = 0(n*^^) by Corollary 2.1.6. 
Hence (/)(s) is convergent absolutely and uniformly on any compact subset of 
Re(s) > k/2 + 1. In the rest of this section, we shall show an outstanding equival-
ence obtained by Hecke and Weil between the automorphy of /(z) and certain 
functional equations satisfied by </>(s) and its 'twisted' Dirichlet series by Dirichlet 
characters. 
Let f{z) be a holomorphic function on H satisfying the following conditions: 
(4.3.7) 
/(z) has a Fourier expansion 
/(z) = Z a„e Ininz 

§4.3. Modular Forms and Dirichlet Series 
117 
which converges absolutely and uniformly on any compact subset of H. Further there 
exists V > 0 such that 
/(z) = 0(lm(zr'). 
•••tffiI{z)-»0) 
uniformly on Re(z). 
Then by a similar argument as in Corollary 2.1.6, we have 
(4.3.8) 
a„ = 0{n^). 
Conversely we obtain 
Lemma 4.3.3. For a sequence {a„}^=Q of complex numbers, put 
f(z)= 
f a„e2«- 
(zeH). 
M = 0 
lfa„ = 0{n^) With some v > 0, then the right-hand side i^ convergent absolutely and 
uniformly on any compact subset o/H, and f{z) is holomorphic on H. Moreover, 
/(z) = 0(lm(z)-^-^) 
(Im(z)^O), 
/(z) -ao = 0(e- 2«^™<^>) 
(Im(z) -^ oo) 
uniformly on Re(z). 
Proof By (3.2.9), we have for v > 0, 
Hence there exists L > 0 such that 
( - : - ) = 
limn7(-l)'' 
= r ( v + l ) . 
( - ; - ' ) 
for all n ^ 0. Put z = x + iy, then 
(4.3.9) 
f \a„\\e''"^ g if f (- Iff ~ ' ~ ' )e-''A 
n=0 
\n=0 
\ 
n 
J 
J 
= L ( l - e - 2 " ^ ) - ^ - ^ 
This impHes that /(z) is convergent absolutely and uniformly on any compact 
subset of H. Since (1 — e"^"^) = 0(>^) asy-^0, we see |/(z)| = 0(y"''~^). More-
over (4.3.9) implies that /(z) is bounded when y -• oo. Put 
g{z)= X «« + i^ 
Itiinz 
n = 0 
Since g{z) also satisfies the assumption, it is bounded on a neighborhood of oo. 
Therefore we obtain 
f{z)-ao 
= e^''''g(z) = Oie-^^y) 
(y-^oo). 
D 

118 
4. Modular Groups and Modular Forms 
By the above lemma, all holomorphic functions f(z) on H satisfying (4.3.7) 
correspond bijectively to all sequences {a„}^=Q of complex numbers such that 
an = 0{n^) with V > 0. 
As a preliminary to Hecke's theorem, we shall prove the following 
Lemma 4.3.4. (Phragmen-Lindelof) For two real numbers Vj, V2 (vi < V2), put 
F = {seC|vi ^ R e ( s ) ^ V2}. 
Let (j) be a holomorphic function on a domain containing F satisfying 
\(j>(s)\ = 0{e\^\') 
( I T I ^ O O ) , 
s = (j + ix, 
uniformly on F with d > Q. For a real number b, if 
|(/>(s)| = 0(|T|^) 
(|T| -• 00) 
on Re(s) = Vj and Re(s) = V2, ' 
then 
10(5)1 = 0(111") 
( | T | - O O ) 
uniformly on F. 
Proof By assumption, there exists L > 0 such that \(j>(s)\-^ Le\'^\\ First we con-
sider the case when 6 = 0. Then there exists M > 0 such that |(/)(s)| ^ M on the 
lines Re(s) = Vi and Re(s) = V2. Let m be a positive integer such that m = 2 mod 4. 
Put 5 = (7 + ix. Since Re(s'") = Re((o- + ii)'") is a polynomial of a and T, and the 
highest term of T is — T"*, we have 
(4.3.10) 
Re(s'")= -T'" + 0 ( | T r - ^ ) 
( | T | - O O ) , 
uniformly on F, so that Re(s'") has an upper bound on F. Taking m and N so that 
m> 6 and Re(s'") ^ N, we have, for any 8 > 0, 
\(t>(s)e''"'\ ^ Me'^ on Re(s) = Vj and Re(s) = V2, 
and 
|0(5)^"'"| = 0(^1^'^-^^'" + ^'^''"") -> 0, 
(|r| -> 00) 
uniformly on F. By the maximum principle, we see 
\(j)(s)e''"'\^Me'^, 
(seF). 
Letting e tend to 0, we obtain |</)(5)| ^ M, namely, 0(s) = 0 ( | T | ^ ) . Next assume 
fe # 0. We define a holomorphic function 1/^(5) by 
^(5) = ( s - V i + l)'' = e'""«<^-^^-'^>, 
where log takes the principal value. Since 
Re(log(s-Vi + l)) = log|s-Vi 4- 1|, 

§4.3. Modular Forms and Dirichlet Series 
119 
we have uniformly on F 
\il/(s)\ = \s-v,-^lf^\r\' 
( I T H O ) ) . 
Put 01 (s) = (l)(s)/il/(s). Then </)i(s) satisfies the same assumptions as (j) with ft = 0, 
so that by the above result, </)i(s) is bounded on F. Therefore we obtain 
\(l>(s)\ = o{\x\')(\T\-^^y 
n 
As we already mentioned in §3.2, Hecke generalized the proof of Theorem 3.2.2 
and proved that a transformation of a function /(z) is equivalent to a functional 
equation of the corresponding Dirichlet series. For a holomorphic function 
f(z) = f ay-' 
« = 0 
on H satisfying (4.3.7), we put 
(4.3.11) 
L{s;f)= 
f 
a„n-\ 
« = 1 
Since a„ = 0(n''\ 
L(s;f) 
converges absolutely and uniformly on any compact 
subset of Re(s) > 1 + V, so that it is holomorphic on Re(s) > 1 + v. We call L(s;f) 
the Dirichlet series associated with f. For N > 0, we put 
(4.3.12) 
A^(s;f) = 
{2n/^)-^r(s)L{s;f). 
Theorem 4.3.5. (Hecke) Let /(z) = Xr= o «n^^""" «"^ ^(^) = Zr=o^«^^"'"' be 
holomorphic functions on H satisfyirtg (4.3.7). For positive numbers k and N, the 
following conditions (A) and (B) are equivalent. 
(A) g{z) = 
(-i^z)-'f{-l/Nz). 
(B) Both Aj^{s;f) and Apf(s; g)can he analytically continued to the whole s-plane, 
satisfy the functional equation 
^Nis'J) = 
Aff(k-s;g), 
and 
s 
k — s 
is holomorphic on the whole s-plane and bounded on any vertical strip. 
Proof (A)=>(B): Since there exists v > 0 such that a„ = 0(n'') and b„ = O(n'), 
n = 1 
and 
f 
J |fljre-2^"^/^r^rfr 
( a > v + l ) 
n = 1 0 

120 
4. Modular Groups and Modular Forms 
are convergent. Therefore we see, for Re(s) > v -f 1, 
AAs;f)= t a„(2nn/^)-^]e-U^-'dt 
n= 1 
0 
n= 1 0 
= 
]t^{fiit/^)-ao)t-'dt 
0 
n 
00 
00 
= __» + ^ t-^f(il^t)t-'dt + \ f(f(itl^)- ao)t-'dt. 
^ 
1 
1 
Since g(z) = (— i.Jl^z)~^f( — l/Nz), we obtain 
(4.3.13) 
A^{s'J)= 
-^-^-^]t'-^{g(it/^)-bo)t-'dt 
S 
K 
S 
-^ 
+ 
]f{f(it/^)-ao)t-'dt 
1 
on Re(5) > Max{fe, v + 1}. By Lemma 4.3.3, when t tends to oo, we have 
f{it)-ao = Oie-''"), 
g{it)-bo = 0(e-'"), 
so that 
J('(/(it/v^)-ao)r'A 
and 
Jt'-»(3(,t/VJv)-b„)r'dt 
1 
are convergent absolutely and uniformly on any vertical strip. Therefore they are 
holomorphic on the whole s-plane. If we define Af^{s; f) for any s e C by (4.3.13), it is 
a meromorphic function on the whole s-plane, and 
is an entire function and bounded on any vertical strip. Similarly Af^{s; g) is also 
analytically continued to the whole s-plane, and satisfies 
(4.3.14) AAk-s;g) = - ^ - - ^ + ] t'-^{giit/^)-bo)t-'dt 
S 
K — S 
J 
+ 
]fmtlsf^)-ao)t-'dt. 

§4.3. Modular Forms and Dirichlet Series 
121 
Comparing (4.3.13) and (4.3.14), we obtain vl^(s;/) = Af^{k-s; g), (B)=>(A): By 
(3.2.14), we have 
fiiy) = ^ . l a „ 
j 
{2nny)-^r(s)ds +«« 
Zni „ = 1 
Re (s) = a 
for any a > 0. If a > v + 1, then L(s;f) = ^^=1 ^n"~* is uniformly convergent 
and bounded on Re(s) = a, so that by Stirling's estitnate (3.2.8), Aj^(s;f) = 
{2n/y/N)~^ r(s)L(s;f) is absolutely integrable. Therefore we can exchange the 
order of summation and integration, and 
f(iy) = ^ 
I 
(^y)-'A^(s;f)ds 
+ a^. 
^'^^ Re(s) = a 
Since L(s;f) is bounded on Re(s) = a, we see, for any // > 0, 
(4.3.15) 
\AAs'J)\ = 0(|Im(5)r^) 
(|Im(5)| ^ ^) 
on Re(s) = a by Stirling's estimate. Next take P so that k — p > v-{-l. A similar 
argument implies that for any /x > 0, 
\AAs;f)\ = \A^ik-s;g)\ 
= 0(\lm(s)\-'^) 
(|Im(s)| ^ ex,) 
on Re(s) = p. By assumption, 
is bounded on the domain P ^ Re(s) ^ a. Hence for any /z > 0, we see by 
Lemma 4.3.4, 
(4.3.16) 
(4.3.15) holds uniformly on the domain P ^ Re(s) ^ a. 
Furthermore we assume that a > /c and p <0. Since (y/Ny) M^(s;/) has simple 
poles at s = 0 and s = k with the residues —GQ and (^/Nyy^bo, respectively, we 
can change the integral paths from Re(s) = a to Re(s) = p using (4.3.16) and obtain 
f(iy) = ^ . 
J 
(^yr'A^{s;f)ds 
+ 
{^y)-%. 
By the functional equation, 
fiiy) = ^ . 
I 
(ViVy)-M^(/c - s; g)ds + 
{^y)-'h^ 
^^^ Re(s) = /J 
^^^ Re(s) = fc-/> 
Since /(z) and ^(z) are holomorphic on H, we obtain 
/(Z) = (VNZ/0-*9(-1/NZ), 

122 
4. Modular Groups and Modular Forms 
or 
g(z) = 
{-i^z)-'f(-l/Nz). 
As a special case, we let k = 1/2, N = 4 and 
f(z) = g(z) = \9{z)=\-^ 
f e'^^"\ 
Then (A) is nothing but the theta transformation formula (3.2.17), so that the 
functional equation of the Riemann zeta-function in §3.2 is the special case of the 
part (A) => (B) of the above theorem. 
For latter use, we restate the above theorem. 
Theorem 4.3.6. Let k and N be positive integers. For two holomorphic functions 
/(^) = ln = o ««^'"" «"^ yi^)= ln = o ^n^'""' on H Satisfying (4.3.7), the following 
conditions are equivalent: 
(A) g(z) = (^z)-'fi-l/Nz) 
( = (/|,co^)(z)). 
(B) Both Aff(s;f) and Aff(s; g) can he analytically continued to the whole s-plane, 
satisfy the functional equation 
Aj^(s'J) = 
i^Af^(k-s;gl 
and the function 
s 
k — s 
is holomorphic on the whole s-plane and bounded on any vertical strip. 
Since any element f{z) of ^ki^, x) satisfies (4.3.7), we obtain the following 
Corollary 4.3.7. For any element f(z) of ^j^{N,x\ ^jvte/) ^^ holomorphic on the 
whole s-plane and satisfies the functional equation 
^N(S'J) 
= 
i'^Affik-s-Jlj^Wff). 
We note that the functional equation in Corollary 4.3.7 is also satisfied for any 
element oi^k(N, •/) (see §4.7). It is unknown for an arbitrary Fuchsian group whether 
a non-cusp form /(z) satisfies (4.3.7) or not. For modular groups, we will construct 
elements of the space of Eisenstein series jV^i^, x) using Dirichlet L-functions in 
§4.7. Therefore we can prove the functional equation for any element of ^^(iV, x)-
Since r(l) is generated by two elements 
and 
n ' ^^ ^^^ easily 
characterize an element f(z) of '^^(^(1)) by the functional equation of L(s;/) and 
obtain 
Theorem 4.3.8. Let k be an even integer ^ 2. Assume a holomorphic function 
f{z) on H satisfies (4.3.7). Then f(z) belongs to %ir(l)) 
if and only if 
A(s;f) = (2ny^r(s)L{s;f) 
can be analytically continued to the whole s-plane, 
A(s;f)-\- — + 
s 
k — s 

§4.3. Modular Forms and Dirichlet Series 
123 
is holomorphic on H and bounded on any vertical strip, and satisfies the fiinctional 
equation: 
A(s'J) = 
{-\fl^A(k-s'J). 
Moreover if aQ — 0, thenf(z) is a cusp form. 
The situation for %{N, x) is much more compUcated, since FoiN) has many 
generators. For a holomorphic function f{z) satisfying (4.3.7) and a Dirichlet 
character ip, we put 
(4.3.17) 
f^(z) = i: ,l/(n)ay""^ 
« = 0 
and 
(4.3.18) 
L(s;fil,)= 
f ^{n)a„n-^. 
n = 1 
This is an analogue of the Dirichlet L-function to the Riemann zeta-function. It is 
obvious that f^{z) also satisfies (4.3.7) by (4.3.8) and Lemma 4.3.3. Let m = m^ be 
the conductor of ij/, and put 
(4.3.19) 
A^is;f ij/) = {2n/m^)-^r(s)L(s;f 
xjj). 
By definition, 
(4 3 20) 
^(^' U) = ^te /' 'AX 
Lemma 4.3.9. Let f(z) and g(z) he two holomorphic functions on H satisfying (4.3.7), 
and \j/ a primitive Dirichlet character of'conductor m (>1). Then the following 
conditions (A^) and (B^) are equivalent. 
(^^) 
f^\MNm^) 
= C^Qf-
(B^)Af^(s;f ij/) can be holomorphically continued to the whole s-plane, bounded on 
any vertical strip, and satisfies the functional equation: 
Aj^(s;f il/) = i^C^Af^(k - s; g, ij/) 
for a constant C^. 
Proof. Apply Theorem 4.3.6 for /^, C^gf, and Nm^ in place of /, g, and AT, 
respectively. Then we obtain the theorem by (4.3.20). 
D 
We put 
«(«)= I \ 
(aeW). 
Lemma 4.3.10. (1) Let f be a holomorphic function on H satisfying (4.3.7), and \jf a 
primitive Dirichlet character of conductor m. Then for an integer /c > 0, we have 
u=wm-' t m(f\,<uim)\ 
where W(^) is the Gauss sum ofij/. 

124 
4. Modular Groups and Modular Forms 
(2) Let f(z) be an element of %(N, x\ ^x ^^^ conductor of x, ijj a primitive 
Dirichlet character of conductor m^, and M the least common multiple ofN, mj, and 
m^m^. Then f^ belongs to %(M, x^^)- Moreover iffis a cusp form, so isf^. 
Proof (1): Since for an integer M, we have 
(/|,a(M/m))(z)= X ay^'^^'^'e 
n = 0 
Ininz 
we see by Lemma 3.1.1(1) 
(4.3.21) 
X f(«)(/La(u/m))(z)= X 
Z fMe^""""" a, 
M=l 
fl = 0 \u=l 
J 
Jlninz 
(2): Assume fG%(N, x) and put m = m^. Since 
a(w/m)-^ro(N)a(M/m) ^ r(Nm^l 
f\j,0L{u/m) belongs to %{r{Nm^)). By (1) we seef^e%(r(Nm^)). 
Therefore we have 
only to prove that f^\j = (#^)(y)/^ for all yeToiM). Let y = I ^ 
^ e/'oW 
and put 
y' — (x{u/m)yoc{d^u/m)~^, 
then 7'ero(M) c= ro(iV). Writing 7' = 
, 
j j , we have 
=[: ::]• 
d' = d — cd^uM/m = d mod m^,. 
„ 
-u-.dh 
so that 
/|,a(«/m)y = x(d)f\Md^u/m). 
Hence by (4.3.21), we obtain 
fAy = x(dmd')f^-
A similar argument is applicable to cusp forms. 
D 
Theorem 4.3.11. Let f(z) be an element of %(N, xX and ij/ a primitive Dirichlet 
character of conductor-m. If(m,N)= 
1, then 
f^coiNm^)^ 
C^g^, 
where ^ =/|fcCa^ and 
C^ = Q,^ = 
x(mm-N)W(i^)/W{4;) 
= X(m)il/(N)W(i^)Vm. 
Proof For an integer u prime to m, take integers n, v so that nm — Nuv = 1. Then 
(4.3.22) 
(x(u/m)o)(Nm^) = mco{N)\ 
^ 
~^Hv/m). 
|_ — MiV 
W J 

§4.3. Modular Forms and Dirichlet Series 
125 
Since g = f\^(Off belongs to ^jk(N, x) by Lemma 4.3.2, (4.3.22) implies 
f\M^/m)(o(Nm^) = xim)g\Mv/mX 
so that 
= Xim) X \l/(-Nv)g\kOc(v/m) 
v=l 
v=l 
= Xim)^{-N)Wiilf)gf. 
D 
By this theorem and Lemma 4.3.9, we obtain the following 
Theorem 4.3.12. Let f(z) he an element of ^jt(iV, x)> c^nd ^ a primitive Dirichlet 
character of conductor m. If (m, N) = 1, then Af^(s\ /, ^) can he holomorphically 
continued to the whole s-plane, is hounded on any vertical strip, and satisfies the 
functional equation: 
where C^ is the constant in Theorem 4.3.11. 
To prove the converse of this theorem is the purpose of the rest of this section. 
For two integers m, v such that {m,vN) = 1, take integers n, u so that mn — uvN = 1, 
and put 
'^^[-ul l] 
yi^^^)=^\ 
.r 
l^roiN). 
Though y(m, v) is not uniquely determined, wmodm is uniquely determined, and 
(4.3.23) 
<xiu/m)o}(Nm^) = m • o){N)y{m, v)(xiv/m). 
We now extend the action of GL2{U) on functions on H hnearly to the group 
algebra CCGLj (R)]. For a function f{z) on H, we put 
(4.3.24) 
f\J = T.^J\,oi for p = 
Y,a,oieClGmU)l 
a 
a 
In the following two lemmas, k and N are positive integers, % is a Dirichlet 
character modiV satisfying x(— 1) = (— !)*» and f(z) and g(z) are holomorphic 
functions on H satisfying (4.3.7) and condition (A) of Theorem 4.3.6. 
Lemma 4.3.13. Let m he an odd prime numher or 4 prime to N. Iffiz) and g(z) satisfy 
condition (A^) in Lemma 43.9 for all primitive Dirichlet characters ij/ mod m with the 
constant 
C^ = 
x(m)il>{-N)Wm/lV{n 

126 
4. Modular Groups and Modular Forms 
then 
glkixi^)-y(^^ u))oc(u/m) = g\k(x(m)-y(m, v))(x{v/m) 
for any integers u and v prime to m. 
Proof. By the assumption {A^) and Lemma 4.3.10, we see 
m 
_ 
m 
(4.3.25) 
X mf\Mulm)m(Nm'-) 
= z(M)"/'(-.iV) ^ ^(u)3La(u/m). 
M = l 
U = l 
For each integer u prime to m, take an integer v so that — uvN = 1 mod m. Then we 
have by (4.3.23) 
(4.3.26) 
f\k(x(u/m)o)(Nm^) = g\ky{m, v)(x(v/m). 
Since the left-hand side is independent of the choice of a representative of u mod m, 
so is the right-hand side of the choice of y(m, v). Using (4.3.26), we rewrite (4.3.25) 
into 
(4.3.27) 
T.^{v)g\Mm)-y(m, 
v)Mv/m) = 0. 
V 
Here v runs over a complete set of representatives of Z/mZ. We note that (4.3.27) is 
independent of the choice of representatives of Z/mZ. Let v^, Vj be two integers 
prime to m. Multiply both sides of (4.3.27) by ^(vi) — \j/(v2) and take the sum-
mations with respect to all nontrivial Dirichlet characters i/^modm. Noting that 
•AC^i) ~ ^(^i) = 0 if i/^ is trivial, we obtain 
^lfc(z(w) - 7(m, v^))(x{vjm) = gUx(m) - 7(m, V2))cc(v2lm). 
D 
Lemma 4.3.14. Let m and n be odd prime numbers or 4. Assume both m and n are 
prime to N. Iff(z) and g{z) satisfy condition (A^) in Lemma 4.3.9 with the constant 
C^ = l(m^)^(—N)W(\l/)IW(\l/) for any primitive Dirichlet character ij/ whose 
conductor m^ = m or n, then 
g\ky = xiy)9 
for all yefQiN) of the form y 
l-uN 
n] 
.Jmvl 
[uN nj 
Proof Put y = \ 
. Since we can take y and y' for y(m, v) and y{m, — v) in 
Lemma 4.3.13, respectively, we have 
glkixim) - y')oc{- v/m) = g\k(x{m) - y)oc{v/mX 
so that 
(4.3.28) 
g\Mm) - YM-2v/m) 
= g\Mm) - y). 
We can also take 7'~ ^ = 
^, 
and y " ^ = 
^, 
for 7(n, v) and y(w, - v\ 
\_ — uN 
m_\ 
\_uN m_\ 
and obtain-
(4.3.29) 
g\kixin)-y-') 
= 
g\Mn)-y-'M-2v/n). 

§4.3. Modular Forms and Dirichlet Series 
127 
Since ;f(n);f(m) = 1, we see 
x(n)-y'~^ = -xin)(x{^)-y')y'~\ 
(4.3.30) 
(z(«)-y ^M-2v/n)= 
-x(n){xim)-y)y 
^Gc{-2v/n) 
as elements of C[GL^([R)]. Rewriting (4.3.29) by using (4.3.30), we have 
(4.3.31) 
9\Mm)-Y) 
= 
g\Mm)-y)y-'oi(-2v/n)y\ 
so that from (4.3.28) 
(4.3.32) 
g\^^^(rn)-y)(l-y-'oi(-2v/n)Yoc(-2v/m)) 
= 0. 
Put 
h = g\kix(m) -y) = x(m)g 
-g\ky-
The function h(z) is holomorphic on H and satisfies 
(4.3.33) 
h\,p = K 
^ = , - a ( - 2 . / n ) / a ( - 2 . M ) = [^^;/^ 
4 / ; ' ^ ] 
Since |tr()5)| = \4/mn — 2| < 2, and |tr(^)| 7^ 0,1 by the assumption on m and n, p is 
elliptic and any eigenvalue of p is not a root of unity. In fact, since the entries of p 
are all rational numbers, the eigenvalues of P belong to a quadratic field. Hence if 
an eigenvalue of jS is a root of unity, then it must be + 1, ± i, + e"'/^ or ± e^^'^^, so 
that tr(j?) = 0, ± 1, or +2, which is a contradiction. Let now ZQ be a point of H 
fixed by p. Put 
p = (zo-z-o)-T[ 
"HeGL2(C), 
P(w) = {h\kp-')M = j(p-\ 
wr'h(p-'w) 
(weK). 
Then p(w) is holomorphic on K. Since we can write ppp~^ ~\ a r-i 
^^^^ C^C, 
we see by (4.3.33) 
(4.3.34) 
p(C'w) = C-V(w). 
Let p(w) = X"°=o^«^" t>e the Taylor expansion at w = 0, then we get 
for all n. Since C is an eigenvalue of P which is not a root of unity, we obtain fl„ = 0 
for all n. Therefore h(z) = 0, so that g\ky = X(^)Q = x(y)9' 
D 
Now we are ready to state the main theorem in this section. For two coprime 
positive integers a and h, we put 
(4.3.35) 
A(a,h) = {a + nh\neZ}. 

128 
4. Modular Groups and Modular Forms 
Let M be a set of odd prime numbers or 4 satisfying the following two conditions: 
(i) any element of M is prime to N; 
(ii) N\nA(a,b)^ 
0 for any A{a, b). 
There exists such a set M. We can take as M, for example, the set of all odd prime 
numbers prime to N by Dirichlet's theorem on arithmetic progression. 
Theorem 4.3.15. (Weil) Let k and N be two positive integers, and % ^ Dirichlet 
character modN such that x(— 1) = (— 1)^ For two sequences {a„}^=Q and {b„}^=Q 
of complex numbers such that a„ = O(n^), b„ = Oin") (v > 0), put 
n = 0 
m = I a„e' 
« = o 
and 
g(z)= t^e'^'"' 
(zeH). 
«=o 
Then f{z) e %{N, xX 9(z) ^ %(^^ x) ^^d g =f\^cOff, if the following two conditions are 
satisfied: 
(1) Aj^(s; f) and /l]v(s; g) satisfy condition {B) in Theorem 4.3.6; 
(2) for any primitive Dirichlet character \j/ whose conductor m^ belongs to M, 
yljv(s; /, ^) and Af^(s\ g, ij/) satisfy condition (B^) in Lemma 4.3.9 with the constant 
C^ = C^,^ = 
xH)^{-N)W(il^)/W{ii;). 
Moreover, ifL{s;f) is absolutely convergent at s = k — 6 for ^ > 0, thenf(z) and g(z) 
are cusp forms. 
Proof We shall prove that g\i,y = x{y)g for 7 = 
^^ . eToCN). If c = 0, then 
\_cN a J 
a = ii = ± 1, so that gfl^y = x(d)g = x(y)g since %(— 1) = (— If. Next assume 
c ^0. Since (a, cN) = (d, cN) = i, there exist integers s, t such that a + rciVe M, 
and d + scN e M by condition (ii). Put 
m = a-\- tcN, n = d-\-scN, 
u = —c, 
V = —{b-\-sm + stuN + nt), 
then 
r a bivi 
-tir 
m -viri -si 
\_cN d\~[o 
ijL-MiV 
«J[o 
Ij 
Hence Lemma 4.3.14 implies 
dlkJ = x(n)g = x(d)9 = xiy)g-
Now g(z) = Oiy'"'^) by Lemma 4.3.3, so that g{z)e%(N, x) by Theorem 2.1.4. 
Since/= (- lfg\,,o)ff by (1), we get/(z)e^fc(Ar, x) by Lemma 4.3.2(2). This implies 
the first half of the assertion. Next assume that L{s;f) is absolutely convergent at 

§4.4. Aiz) and ti{z) 
129 
s = k-S with ^ > 0. Put 
c„= t \^J 
(n^ll 
then 
c < "'"'(_^EJ«J'»"'"') 
so that c„ = 0(n''"'). By Lemma 4.3.3, Xr=oC„e"^''"'' is convergent and 
Z"=oC„e-^'"^ = 0(j'-»*''-') (y^O). Since |a.| = c,-c„^„ 
we see 
\f{z)-a„\^(l-e-''y)(yc„e-''A, 
\n=l 
SO that/(z) = 0(y ''•^^). Therefore/(z) is a cusp form by Theorem 2.1.4, and so is 
9iz). 
• 
We note that when AT is not a prime number, /(z) and g{z) are not necessarily 
cusp forms even if a© = ^o = 0-
§4.4. A{z) and f/(z) 
In this section, we give the proof of Theorem 4.1.7(2) which asserts that A{z) has no 
zeros on H. First we define the function ri(z) on H by 
^(Z) = e«'^/12 ^(l-e^"'"^). 
Since J] *= ^ e^"'"^ converges absolutely and uniformly on any compact subset of H, 
so does the above infinite product. We call ri(z) the Dedekind rj-function. 
Theorem 4.4.1. The function ri(z) satisfies the transformation formula 
rji-\/z)Hz/iY''rj(z), 
Proof We follow Weil's proof ([Weil 4]) which reduces a transformation formula 
for a holomorphic function on H to a functional equation of the corresponding 
Dirichlet series. Since rj{z) has no zeros on H, the assertion is equivalent to saying 
that 
(4.4.1) 
log^(-l/z)=logfy(z)+ilog(z/0. 
By definition, we have 
\ogrj(z) = niz/12- 
f m-^e^""'"""'. 

130 
4. Modular Groups and Modular Forms 
Put 
f{z)= f 
m-'e^'''""'' = 
niz/\2-\ogrj(zl 
m,n= 
I 
then/(z) satisfies (4.3.7) and 
L(s'j)=as)C{s+iy 
As in the previous section, put 
A{s;f) = (2n)-^r(s)Lis;f) 
and 
A{s) = n-^''r(s/2)i:{sl 
Since 
A{s;f)=iAis)Ais-^l), 
Theorem 3.2.2 imphes that A(s;f) can be analytically continued to the whole 
s-plane and satisfies the functional equation 
A{s;f) = A(-s'J). 
Moreover f ( — 1) = —1/12, and 
is entire and bounded on any vertical strip. We note here that 
yl(s)4--+ ^ 
S 
1—5 
is bounded on any vertical strip by a similar argument as in the proof of 
Theorem 4.3.5. Now 
m)=^ 
j 
y-'A{s;f)ds, 
and we can change the integral paths from Re(5) = 2 to Re(5) =—2. 
By the 
holomorphy of (4.4.2), y~^A{s;f) has poles only at s=l, 0, —1 with the residues 
7r/12y, ilog>', —Try/12, respectively. Hence 
m) = ^ 
J 
y-'Ais;f)ds + 
n/12y+\\ogy-ny/n 
=^. 
I 
fA{-s;f)ds 
+ 
nn2y+\logy-ny/l2 
= / ( - l A » + 7r/12>'+-log>'-7r3;/12, 
by the functional equation for yl(s;/). Therefore (4.4.1) holds on the imaginary axis. 
Since both sides are holomorphic on H, (4.4.1) is satisfied everywhere on H. D 

§4.5. Hecke Algebras of Modular Groups 
131 
Now we consider rj^'^iz). Since 
(4.4.3) 
^2^(z) = e^"'^ 0 ( 1 - ^^"''")^^ 
n = l 
we have 
(4.4.4) 
rj'\z-hl) = rj'\zl 
rj'\-l/z) 
= z''rj'^(z). 
As r(l) is generated by 
and 
and rj^'^^iz) vanishes at oo by (4.4.3), 
fj'\z)e^,2irWy 
Since dim 5^12(^(1)) = 1» we see ^^"^(z) = czl (z) with a constant c. Comparing the first 
Fourier coefficients of ^^"^(z) and zl(z), we get c= 1, hence 
A(z) = rj'^{z). 
Thus we obtain the following 
Theorem 4.4.2. The function A (z) has no zeros on H and has the infinite product 
expansion 
A(z) = e^'''' f[ (l-e^'^'^'f^ 
n=l 
which converges absolutely and uniformly on any compact subset o/H. 
Theorem 4.4.2 also implies the integrality of the Fourier coefficients T„ of A (z). 
The explicit forms of A (z) and ri(z) are quite useful to calculate modular forms. We 
can construct cusp forms of small level by using A{z) and rj(z). For example, we 
have ([Shimura], pp. 49-50): 
1° If N is 2, 3, 5, or 11, and k = 24/(N+1), then 6^kiroiN)) is one-dimensional 
and is generated by 
(A {z)A (Nz))^'^^^^^ = (r]iz)rj(Nz))\ 
T If N is 2, 3, 4, 6 or 12, and /c= 12/AT, then ^fc(r(iV)) is also one-dimensional 
and is generated by 
(J(z))^/^ = f/2'^(z). 
§4.5. Hecke Algebras of Modular Groups 
Hecke operators play important roles in the study of modular forms. In this 
section, we explain, following Shimura, the relation between Fourier coefficients of 
modular forms and Hecke operators first obtained by Hecke. We begin by studying 
the structure of the Hecke algebras of modular groups. For a Fuchsian group T, we 
put 
f={QeGLim\gTQ-^^T\ 

132 
4. Modular Groups and Modular Forms 
Lemma 4.5.1. For any modular group F, we have 
Proof. Since FwF{l), 
we have only to prove the lemma for F = F{i) by 
Lemma 2.7.1(3). Let aeIR'' GL^CQ). Take ceW" so that j5 = caeM2(Z). Then 
oi~^F(l)(x=^p-^F(l)p. Put m=det(j5), then m)5"^ eMjC/). For any yer(m), we see 
imr')yP^{mr')P 
( = \^ 
^ 1 ) 
mod m, 
so that P~^yPeM2iZX and P~^F{m)P c= F. Therefore we have 
6cF(x-^nF = 
pFp-^nF^Fim). 
"[: a---
Since [r:r(m)]<oo, a belongs to T. Conversely, assume a= 
eT. By 
Corollary 1.5.5, the cusps aoo = a/c and aO = b/d of(xF(x~^ are also cusps of T. Since 
r «'a~ ^r'a, the points 'aoo = a/b and 'aO = c/d are also cusps of F. As any cusp of F 
is an element of Q u {oo}, the ratios of a, b, c, d are all rational numbers, and 
therefore a G R ^ • GL^ (O). 
D 
We define the subsemigroups AQ(N) and ^ J W of GL2 (Q) by 
(4.5.1) 
^ o W = | ^ ^ \eM2{I.)\c = 0modN,{a,N)=l 
ad-bc>oi, 
and 
(4.5.2) 
JJ(N) = | r 
MeM2(Z) c = OmodAr,(^,iV)=l,arf-ftc>oi. 
We see easily that 
(fa 
bl 
\c = 
OmodN,{ad-bc,N)=U] 
We are going to study Hecke algebras ^(Fo{N\ AQ{N)) and ^{FQ(N\ 
Al(N)). We 
simply write 
(4.5.4) 
^(iV) = ^(ro(iV),zlo(Ar)), 
(4.5.5) 
^*(iV) = ^(ro(iV),zlS(iV)). 
Lemma 4.5.2. For any CL£AQ(N) {resp. zlJ(N)), there exist positive integers I and m 
such that /|m, (/, iV)= 1 and 
'o(N)aro(JV)=r„(JV)P 
l\ro(N) 
{0 n 
(resp. r„(JV)aro(N)=ro(JV)| „ 
, |ro(N)). 
77ie paJr (/, m) is uniquely determined by a. 

§4.5. Hecke Algebras of Modular Groups 
Proof. Put 
L = 
133 
M,rGz|, 
Lo = ||^^"j|u,t;Gz|. 
Then M2(/) acts on L by left multiplication and CCLQ a LQ. Put n = det(a), then 
[L: aLo] = [L: aL] [aL: aLo] = nAT. 
By the fundamental theorem of abehan groups, there exists a basis {wi, W2} of L 
such that 
(xLQ = Z{aw^)@Z{bw2) 
with positive integers a and b {ab = nN, a\b). Since OCLQ C/Z tL for any divisor t(> 1) 
of AT, we see that (a, Ar)= 1 and N\b. Then Zw^ © Z(Nw2) is a unique submodule of 
L of index iV containing OCLQ, and therefore, 
Lo = Zwi©Z(Nw2). 
Moreover if we put l = a and m = b/N, then Z(/wi)© Z(mw2) is a unique sub-
module of L of index n containing OLLQ. Therefore we get 
aL = Z(/wi)©Z(mw2). 
We define two elements 7i, 72 of M2(Z) by 
(wi,W2) = M ^ LL Ihu 
N 0 P 
1 N = ('^i''"^2)72. 
= det(7 
{0:]' 
Then 
yi-
We may assume det(7i) = det(72)=l by taking —W2 in place of W2, if necessary. 
Since Wj GLQ and al ^ UaLo, we see Ti, y2^^o(^)- Therefore we obtain 
ro(iV)aro(N)=ro(iV) 
KoW. 
L/aL-Z//Z©Z/mZ, 
Since 
(4.5.6) 
the pair (/, m) is uniquely determined by the fundamental theorem of abehan 
groups. A similar argument is also appUcable to /dg(iV). 
D 
We note by (4.5.6), 
(4.5.7) 
ifl\m and {lm,N)=l 
then UN)^^ 
m l ^ ' ^ ^ ^ ^ ^ ^ ^ ^ f 0 
^l^^^^^' 
Theorem 4.5.3. (1) Both Hecke algebras M{N) and ^*{N) are commutative. 
(2) For any element ro{N)(xro{N) of M{N)KJ^*{N\ 
both 
ro{N)\roiN)oiro{N) 
and rQ{N)(xrQ{N)/rQ(N) have a common set of representatives. 

134 
4. Modular Groups and Modular Forms 
Proof. For an element a= 
ezloW (resp. ^oWX we put 
(iV) (resp. zl?(iV)). 
Then the correspondence "ai-*a'" satisfies the three conditions of Theorem 2.7.8. 
In fact, conditions (i) and (ii) are obvious by definition, and (iii) is proved by 
Lemma 4.5.2 and (i). Therefore ^(N) and ^*(N) are commutative. 
D 
Now let X be a Dirichlet character mod N. We put 
(4.5.8) 
Z(«) = Z(^ for aJ" 
%AoiN). 
Then x is an extension of the character of ToCiV) defined by (4.3.2) to AQ(N). TO let 
Hecke algebra ^(N) act on %iN, /), we have to verify that x satisfies (2.8.1), or 
if oiyoL-'eroiN) (yeToiNl 
ae^oW) 
then x(a7a"') = X(7). 
In fact, by Lemma 4.5.2, we may assume oc = \ 
(/|m, (/, Ar) = l). Put 
U 3'^" 
(AT), and y' = ocyoc ^ If 7' e ro(iV), then bl = 0 mod m and 
Y 
_r 
a 
bl/ml 
IcNm/l 
d J' 
so that x(y) — xiy')' Therefore by Theorem 2.8.1, ^(N) acts on %{N,x)- More 
precisely, if 
ro(N)aro(N) = Uro(iV)a, 
V 
is an element of ^(N), then 
(4.5.9) 
/I ro(iV)aro(iV) = det (a)*/^"'^/(a,)/|,a, 
(/e ^,(N, /)). 
V 
Next we extend the character x of rQ(N) to ^o(^) by 
(4.5.10) 
X*io^) = Xid) 
(oi=\'' 
%At{N) 
Similarly as above, this extension also satisfies (2.8.1), and 3t*{N} also acts on 
%(N, X); namely, if ro(N)«ro(N)e^*(N) and 
ro(Af)aro(Ar)=Uro(N)a„ 
V 
then 
(4.5.11) 
/|ro(N)aro(iV) = det(a)*/2-^Xx*(av)/Lav 
ife^iN^x))-

§4.5. Hecke Algebras of Modular Groups 
135 
We note that when ro(N)oLro(N) is contained in ^(N)n^*(Nl 
the action of 
ro(iV)aro(iV) as an element of ^(AT) does not necessarily coincide with the action as 
an element of ^*(iV). The difference will be clarified in Theorem 4.5.4. We only note 
here that 
(4.5.12) 
Ao(N)^AUN) 
by 
"a h^ w^ ^ aco^", 
and 
(4.5.13) 
x*icoN'oico^) = m 
(aeJo(^)). 
We define the elements T(n) and T{1 m) of ^(N) by 
(4.5.14) 
Til m) = ro(iV)P 
1\UN) 
(/|m, (/, iV)= 1), 
T(n)= 
X 
ro(iV)aro(iV), 
det («) = « 
where the summation is taken over all double cosets ro(N)aro(N) in ^(N) with 
det(a) = n. Similarly we put 
•.,..[: :]r„ 
r*(m,/) = ro(N)| „ 
,\ro(N) 
(l\m,(l,N)=l), 
(4.5.15) 
r*(n)= X r„(N)ar„(Ar), 
det(a) = /i 
where the summation is taken over all double cosets ro{N)arQ{N) in ^*{N) with 
det(a) = n. When we emphasize the level iV, we write 
^r(n),^r(/,m),^r*(n), 
and 
^r*(m,/), 
respectively. Now Lemma 4.5.2 implies 
T(n)= X 
niml 
Im — n 
(4.5.16) 
T*(n)= X r*(m,/), 
lm = n 
and, in particular, for a prime number p we have 
(4.5.17) 
T{p)=T(h p\ 
T*(p)=T*(p, 1). 
Moreover, if (n, iV)= 1, then 
r(n,n)=ro(iV)[j ^jro(iV)=ro(iV)^J ^ ] , 

136 
4. Modular Groups and Modular Forms 
SO that 
T(n, n)T(l m)=T{nl nm), 
(4.5.18) 
r*(n, n)T*{m, l)=T*(nm, nl). 
Theorem 4.5.4. (1) For any element f(z) of%(N, xX ^^ have 
/|r*(m,0 = z(/m)(/|r(/,m)) ,/ (/m,JV)=l, 
/|r*(n) = z(n)(/|7'(n)) 
,/ 
(n,N)=l. 
(2) T{1, m) and T*{m, I) (resp. T(n) and T*(n)) are the mutual adjoint operators 
with respect to the Petersson inner product on £^ki^, x)-
(3) y'ii(JV, x) has a basis consisting of common eigenfunctions of all T(n) and 
T{l,m)((n,N)=l,ilm,N)=l). 
Proof (1): Assume (Im, N) = 1. Put 
and 
X*(a) = x(det(a))x(a) 
for any element a of ^o(^) '^ ^o (^)- Hence we see 
By (4.5.7), we have 
r 
/|r*(m,/) = (/m)*/2-^Xx*(«v)(Aav) 
= Z(M(/m)'^/2-iXx(av)(/l.av) 
V 
= X(lm)(f\T(hm)), 
Moreover, by (4.5.16) we get that/| T*(n) = x(n)(f\ T(n)) if (n, N) = 1. (2): For an 
element a = 
, of GL2 (UX we put 
Ic ^J 
, 
r d 
-bl 
a' = det(a)a"^ = l-c 
aj 
The correspondence "an-^a"' is an anti-isomorphism of ^o(^) onto ^o(^)- By 
Theorem 4.5.3(2), we can take a complete set of representatives {a^} so that 
(4.5.19) 
ro{N)\^ 
^lro(iV) = IJro(iV)a, = IJa,ro(iV). 

§4.5. Hecke Algebras of Modular Groups 
Then 
137 
ro{N)\^ 5^1n(^) = LlnWa;. 
Let T* be the adjoint operator of T(l m) with respect to the Petersson inner 
product. Since xM = Z*(a'v)> we see by Theorem 2.8.2(1) 
(4.5.20) 
/I T* = (Imf^"' ^ z K ) {f\M 
V 
= /|r*(m,/). 
Therefore T(l,m) and T*{mJ) are adjoint to each other. By (4.5.16), so are T(n) and 
T*(n). (3): By (1) and (2), if (/m, N) = 1, then T(n) and T(l m) are normal operators 
on 6^^(N,x)' Since ^{N) 
is commutative, they are simultaneously dia-
gonalizable. 
D 
As was shown in Lemma 4.3.2, ^f,{N,x) is isomorphic to ^^(N,x) by the 
correspondence "/i-^/lfcCo^". 
Theorem 4.5.5. The following diagram is commutative: 
^AN,x) 
^'"""^''•^"•"'" 
. %(N,x) 
(ON 
%(N,x) 
^'<""-P-^<»'-") , ^^iN,x). 
Proof. We have only to prove the theorem for T(l, m). Put F 
= LIvro(N)a.. Then 
»<^(i I] '" 
(N) 
I^o(N)^Q J'lr„(Af) = Uro(N)(mi;'a,co^ 
so that for an element/(z) of ^ii(N, x), we see by (4.5.13) that 
f\,ms' 
T{1, m)m^ = 
(Imf'^-'^xM(/L«^'"v^^) 
V 
=/ir*(m,/). 
n 

138 
4. Modular Groups and Modular Forms 
Lemma 4.5.6. Let p be a prime number, and e a non-negative integer. 
(1) As a complete set of representatives of 
ro(N)\ro(iV)|^J y^»<^'' 
we may take the following set: 
1 o ^ / ^ ^ , 0 ^ m < p ^ (m,p^,/7^-0=l| ifpJ(N, 
p" ^ m 
ifplN. 
(2) deg(r Ho l'}" 
(N)) = 
P' + P' 
ifpJfN, 
P' 
ifp\N. 
Proof. First we are going to prove that for any element ^ = 
„ 
J 
of 
{N\ there exists an element y of TQCN) such that 
•o(N)[J ^.]ro, 
yP Vf-f 
ml 
-[o 
p^\ 
(0 ^ m < p-^). 
In fact, since det(j5) = p^, (a, cN) is a power of p. Suppose p| N. Since (a, AT) = 1, we 
have (a,cN)= 1, so that there exists an element y^ of ro(iV) such that 
' [-cN a J" 
Then y HI 'A-
with some n. Let 
n = lp'-\-m 
(0 ^ m < p^) 
with integers / and m, and put 
72 
Then 
Next assume (p, N) = 1. Put a' = «/(«, cN) and c' = c/(a, cN). Since (a, AT) = 1, c' is 
integral and (a\ c'N)= 1. Thus there exists an element y^ in ro(N) of the form 
Then 
^ [-c'iV a'J' 

§4.5. Hecke Algebras of Modular Groups 
139 
with integers/and n. Similarly as above, we can take an element yj of ToCiV) so that 
r ^~/ 
~i 
72?!;? = I J 
p J (Ogm<pO. 
Consequently we get 
(4.5.21) 
•.<«{i I h (iV) 
Next we are going to prove that the right-hand sides of (4.5.21) are disjoint 
unions. Suppose 
HC :'h''<';] 
FniN) I : 
. I n ro(iV) 
Then there exists an element y of ToCN) such that 
(4.5.22) 
y 
^0. 
Next assume (p, AT) = 1. Put 
na sides 
An easy calculation shows that y is of the form I 
I which implies/= g and 
m = n. This proves the disjointness of the right-hana sides. First assume p\N. Since 
we get 
By Lemma 4.5.2, there exist two integers a,b (0 ^ a ^b, a + b = e) such that 
Put 
and 
Since any element of ro(N) induces an automorphism of L, we have 
L/(xL ^ L/PL - Z/p^Z® 
Z/p^Z. 

140 
4. Modular Groups and Modular Forms 
Therefore, 
ro(N)aro(iV) = ro(iV)^J p^j^W 
if and only H (xLc^ pL. This is equivalent to saying that {p^, p^ ^, m) = 1. This 
concludes the proof of (1). The second assertion follows from (1). 
D 
Lemma 4.5.7. Let p be a prime number, and e a positive integer. Then we have: 
(1) T(p)T(hpn 
= T(hp^^') 
+ 
(p+l)T(p,p) 
ifpJ^N 
and 
e=l 
pT(p,p)T(lp'-') 
ifpXN 
and 
e>l 
0 
ifp\N. 
mT(n^T(ne^ 
. T(r'') 
^ PT{p. p)T(p^-') 
if P)(N. 
(2)T(p)T(p)^i^^^^,,^ 
(fpliV. 
Proof. Let T= ro(N)(xro{N) be a constituent of T(p) 7(1, p^). By the definition of 
the multiplication, we can write 
(x = <x,(X2 
(oi,eT(pl 
0i2eT(l,p')). 
Put 
-{HI"--4-
L 
Since [L: aL] = p^ ^ ^ and 
L/(xL => ai L/(xL :ii L/ct2 L ^ 
r coincides with 7(1, p^""^) or T{p,p^). Hence 
r(p)r(i,p^) =,_,_, 
,^, 
aT{hp^^') 
+ bT(p,f) 
ifpJ^N, 
a'nip^^') 
ifp\N, 
with integers a, b and a'. By Lemma 4.5.6(1) and the definition of the multiplicatuon, 
we get a = a' = 1. Comparing the degrees of both sides using Lemma 4.5.6(2) and 
(2.7.7), we obtain 
[ P 
ife>\. 
This proves (1). When p\N, we see T(p^) = 7(1, p% so that (2) is nothing but the 
first assertion. Now assume that (p, AT) = 1. We prove the assertion by induction on 
e. First let e = 1. Since T{p) = 7(1, p), we see by (1) that 
7(p)7(p)=7(l,p2) + (p+l)7(p,p) 
= 7(p2) + p7(p,p). 

§4.5. Hecke Algebras of Modular Groups 
141 
Next assume e ^ 2 and the assertion is true for all positive integers less than e. 
Applying (4.5.16) and (4.5.18) to T{p% we see 
np)T(p')=np){n\,p') + np,p)T{p'-^)} 
=T(i,p'^')+pT{p,p)ni,p'-') 
+ 
np,p)np)T(p'-') 
= nup'^') + pT(p,p)T(ip''') 
+ T(p,p){T(p'-') + pT(p,p)T{p'-')} 
= 
T{ip'*')+T{p,p)nip'-') 
+pnp,p){ni,p'-')+T{p,p)T(p'-')} 
= T(p''') + pT{p,p)T{p'-'). 
Here we understand r(p^) = 0 if e < 0. This is what we wanted to show. 
D 
Lemma 4,5.8. (1) //(/m, I'm') = 1, then 
T(lm)T{l',m') = T(li',mm'). 
(2) //(m,n) = 1, then T(m)Tin) = T(mn). 
Proof. (1): Let 7 = ro(Ar)aro(iV) be any constituent of T(lm)T(l',m'\ 
then we 
can write a = a^aj with a^ 6 T(l, m), 0L2 6 T{1'\ m'). Put 
"11 
-n\ 
.^^Jl 
J 
then 
LlaL^L^ZIlZ@TlmT, 
OL^LjaL - LI0L2L ^ Z/rZ e Z/m'Z. 
Since (/m, /'m') = 1, we get 
L/aL^Z///'ZeZ/mm'Z, 
namely r = T(ll', mm'). Therefore T(U m)T(l', m') = aT(U', mm') with some integer 
a. We are going to prove a = \. Let 
and 
We may assume 
Vll' 0 1 
^ = L0 rnm'\ 
^^^^{0 ^]^o(iV)=LJ^oWa„ 

142 
4. Modular Groups and Modular Forms 
Now we assume ro(iV)a = ro(iV)a^j5v» ^^^ l^t a = ya^j^v with yeFQiN). Put 
M = 
{lu,v^\u,veZ} 
and define the submodule MQ of M by 
MO = {[NM,I;]|M, i?eZ}. 
We let M2(/) act on M by the right multipHcation of matrices. Then 
{Mp, + Mp,)/Mp, - 
MpJiMP.nMM-
Since the left-hand side is a subgroup of M/MP^, the order is a divisor of 
det(jSi) = /'m'. On the other hand, the right-hand side is the quotient group of 
MP^/M(x; hence the order is a divisor of det(a)/det(j5v) = /m. Since (/m, I'm') = 1, 
we get Mpi — Mp^. Therefore there exists an element yieGLjiZ) 
such that 
yiPi=Pv. 
Since det(^i) = det(j5y), we get y^eSLjil-). 
A similar argument 
for MQ in place of M implies MQP^ = MQP^, SO that MoVi = Mo, namely 
7iero(N). Since j?^ is a representative of left ro(N)-cosets, we get yi = 1 and 
Py = Pi. Similarly we obtain a^ = aj. Consequently a — 1. The second assertion 
easily follows from (1). 
D 
Theorem 4.5.9. The Hecke algebra 0t (N) is the polynomial ring over Z generated by 
T(p\ 
T{p, p) with all prime numbers p prime to N, and T(q) with prime numbers q 
dividing N; namely, 
^(N) = ZlT(plT(p,p\Tiq) 
\ 
pJ^N,q\Nl 
Proof. By Theorem 4.5.3, Lemma 4.5.7 and Lemma 4.5.8, ^(N) is commutative 
and any element of ^(AT) can be expressed as a polynomial with rational integral 
coefficients in r(p), T(p,p) and T{q). Moreover it can be easily verified by 
Lemma 4.5.7 and Lemma 4.5.8 that T(p\ T(p, p) and T{q) are algebraically 
independent over Q. 
D 
Take two positive integers /, m so that l\m and (/, AT) = 1. Let m/l = YlpP^ ^^ 
the prime decomposition. By Lemma 4.5.8, we see 
(4.5.23) 
Tam)= T(ll)T(hm/l)= T(lJ)l\T(lpn. 
p 
where p is taken over prime divisors of m/l, so that we obtain 
(4.5.24) T(lm) = Uro{N)l''^ 
J l (ad = lm,0 ^b < dAa,b,d) = l), 
(4.5.25) 
r(n) = [Jro(iV)h M {ad = n,0 ^ b < d^a, N) = 1), 
by Lemma 4.5.6. Therefore we can express the action of T(l m) and T{n) on 
^ki^^ X) explicitly. In particular, for/(z)e^fc(iV, %), 
(4.5.26) 
(f\T(nmz) 
= n'-' ^ Y X(a)d-'f((az 
+ b)/dl 
0<d\nb 
= O 
ad = n 

§4.5. Hecke Algebras of Modular Groups 
143 
and 
(4.5.27) 
{f\TilJ))iz) = l'-'xil)f{z) 
if (/,iV) = l. 
We note that if (a, iV) # 1, then x(a) = 0. For a positive integer n, we write n|iV* if 
all prime factors of n divide N. We get the following relations between Hecke 
operators of modular groups of different levels. 
Theorem 4.5.10. Let M be a multiple of N, and n a positive integer. If n\N'^ or 
(n, M) = 1, then the following diagram is commutative: 
^T(n) {resp.'^T*{n)) 
Here x is a Dirichlet character mod N and the vertical arrows indicate the natural 
emheddings. 
Now we are going to study relations between the Hecke algebras of modular 
groups of different levels as a preparation for the next section. Let x be a Dirichlet 
character mod AT, and M a multiple of AT. If ae Jo(^X then 
ro(M)aro(iV)c^o(iV). 
Therefore an element of ^(TQCM), ToCAT); ^oW) induces a linear mapping of 
%(M, x) into %(N, x) by Lemma 2.7.2(2). We shall use the following lemma in 
§4.6. 
Lemma 4.5.n. For a positive integer N and a prime number p, we have 
U ro(piV)|^J ^Jy, '/PlJV. 
n(PN) [; >-' 
1 
[ 
v = 0 
p 
Uo^"^^^{i l y ifpJfN. 
u 
p j 
Here 7, (0 g v < p) is an element of F^iN) such that 
^ ' " [ i ; ] modp, 
and yp(p)(N) is an element of rQ(N) such that 
f r o 
-a~\ 
mod p, with an integer a prime to p. 
mod AT. 

144 
4. Modular Groups and Modular Forms 
Proof. Put 
(4.5.28) 
r 
(N)\b = Omodp } . 
By Lemma 2.7.1(4), we have only to get representatives of r'\ro(iV). First suppose 
(p, N) = 1. Since 
ro(iV)=Dr=Dr(piV), 
r'\ro(iV) corresponds bijectively to Apjv(r')\Ap^(ro(iV)) where Xpff is the homo-
morphism of SL2(Z) onto SL2(Z/pNZ) defined in §4.2. Through the isomorphism 
SL2{Z/pNZ) - SL2(Z/pZ) X SL2{Z/NZ), 
Ap^(r') corresponds to X/F') x A^(r'), and so does >^^(ro(iV)) to Ap(ro(iV)) 
X >l^(ro(Ar)). Consequently r'\ro(N) corresponds bijectively to 
A,(r')\A,(ro(N)) X A^(r')\^^(ro(iV)). 
It can be easily verified that 
Xsin = A^(r„(jv)), 
so that r'\ro{N) 
corresponds to -l,(r')\A,(ro(JV)). Since 
A,(r„(AO) = 
SL,{Z/pZ), 
ur •>-{[::] 
eSL2{Z/pZ) 
b = Omodp }• 
we get 
A,(r„(N)) = u A,(r)a, 
v = 0 
where a^ are the elements of Xp(rQ(N)) defined by 
a„ = -^ 
La-' oj 
( O ^ v g p - 1 ) , 
(v = p), 
and V = V mod p, a is an element of (Z/pZy. 
Since /Ip(yv) = a^, we obtain 
v = 0 
Next assume that p\N. Then a direct calculation proves 
v = 0 
D 

§4.5. Hecke Algebras of Modular Groups 
145 
Hecke operators of modular groups have an important property that their 
eigenvalues coincide with Fourier coefficients of modular forms at oo. It can be shown 
from this fact that if a modular form f(z) is a common eigenfunction of Hecke 
operators, then the associated Dirichlet series L(s;f) has an Euler product. Before 
we explain this fact precisely, we state a general lemma. 
Lemma 4.5.12. Let K be a commutative ring with unity. Assume that two sequences 
{t(n)}^= 1 ^nd {d{n)}^= i of elements of K satisfy'the two conditions: 
(i) r(l) = 
rf(l)=l; 
(ii) d{mn) = d(m)d(n) for any positive integers m and n. 
Then the following three conditions are equivalent. 
(1) //(m, n) = 1, then t(mn) = t(m)t(n), and 
t{p)t{pn = tif^') 
+ 
pd{p)t(f-') 
for all prime numbers p and all positive integers e. 
(2) The formal Dirichlet series Yj^= i ^(w)n~* has the formal Euler product 
X f ( « ) « - ' = n ( 1 - '(p)p~'+pd(p)p~ 
'')"'• 
M = 1 
p 
(3) For any positive integers m and n, 
t(m)t(n) = 
X 
ldil)t{mn/l^). 
0<l\(m,n) 
Proof (1)=>(2): By the first condition of (1), we can write formally 
(4.5.29) 
^ f(n)n- = n 
^ 
t(p')p-"l 
n = l 
p \e=0 
J 
Since 
(1 - t{p)p-^ + Vd{p)p-^')ij,^ 
t{f)V-''\ 
= 1 
by the second condition of (1), we obtain (2). 
(2) => (3): It is obvious that if (m, n) = 1, then t{mn) = t{m)t{n\ Let m = W^p^ 
and n — HpP^ t)e the expressions as powers of prime numbers. Then 
X 
ld{\)t{mnll^) = n f 
Z 
V'd{f)t{p^ ^ ^ - ^^)). 
0<l|(m, n) 
V Vogfif gmin{e,/} 
/ 
Therefore we have only to prove (3) when m and n are powers of a prime p. By the 
assumption of (2), we have 
(4.5.30) 
X tip^)v-'' = 
{^-t{p)p-'^pd{,p)p-^T'' 
e = 0 
Let r'(p) and d'{p) be two variables over Q, and 
i^:Zlt'ip),d'ip):i-^K 

146 
4. Modular Groups and Modular Forms 
the ring homomorphism defined by 
(4.5.31) 
iA(l) = l, il^(t'(p)) = t{pX and il/(d^(p)) = d(p). 
We define the elements t'(p^) and J'(p^) of Z[r'(p), d'(p)^ by 
(4.5.32) 
d^if) = d'ipY 
and the formal power series 
(4.5.33) 
f t'(p^)p-- = (1 - f(p)p-^ + pt/'(p)p-2^)- 1. 
e = 0 
Then by (4.5.30) through (4.5.33), we have 
(4.5.34) 
il^{t'{pn) = t{pn and il/id^p^) = d(p% 
Let u and t; be two variables over Q, and 
(/):Z[r'(p),J'(p)]^Q[M,r] 
be the ring homomorphism defined by 
(l)(t'{p)) = u-\-v and (l)(d'(p)) = - Mt?. 
P 
Since w + t; and wr/p are algebraically independent over Q, (p is injective. Consider-
ing Z[r'(p), ^'(p)] as a subring of Q[M, r], we have 
1 - t'(p)p-' + P^'(p)p- ^^ = (1 - up-^)il - vp-^). 
Therefore by (4.5.33), we have 
(4.5.35) 
t'ip') = (u'^' - v'^')J(u - v) 
i + j = e 
Assume e ^f. Then we see 
= 
X 
M^i;^(M^-^^-2^-'i-t;^ + / - 2 ^ + i ) / ( M - t ; ) 
3 = 0 
= i fd'{f)nf^^-^^). 
g = 0 
Applying i/^ to both sides, we see by (4.5.34) 
g = 0 
and we have proved (3) for m = p^ and n = p-^. 

§4.5. Hecke Algebras of Modular Groups 
147 
(3) => (1): This is obvious since (1) is a special case of (3). 
D 
Applying the lemma for 
t(n) = T(n\ 
and 
'T(n,n) 
if(n,N)=l 
^ ( " ^ = ' 
0 
if(.,iV)^l, 
we obtain by Lemma 4.5.7(2) and Lemma 4.5.8(2) the following 
Theorem 4.5.13. (1) 
Tim)Tin)= 
^ 
lT(ll)T{mnm 
0 < / | ( m , n ) 
( / , N ) = 1 
(2) The formal Dirichlet series Y,^= iT(n)n~^ has the formal Euler product 
f T(n)n-^= Y\ i^ - np)p-' + T(p,p)p'-'T' X Ui^ -np)p-T'-
n=l 
pJi'N 
P\N 
Now we study the relation between Fourier coefficients of modular forms f(z) 
and those of (/I r(n))(z). 
Lemma 4.5.14. Let f(z) be an element ^/^^(Ar, x\ cind 
/(z) = t 
cin)e'""\ 
« = 0 
00 
(/|r(m))(z)= X 
Hn)e'""' 
n = 0 
be the Fourier expansions. Then 
Hn)= 
Z 
x{d)d''-'c(mn/d^). 
0 
<d\{m,n) 
Proof We note that 
f({az-^b)/d)= 
f 
c(n)e2"'"^''^-'*>/'^. 
n = 0 
Then by (4.5.26) and the equality 
ft4-o 
[0 
if^^n, 
we get 
(4.5.36) 
b{n)= 
^ 
x(a)a''-'cidn/a). 
0 
<a\(m,n) 
Since ad = m, we have c(dn/a) = c(mn/a^), so that we obtain the result. 
D 

148 
4. Modular Groups and Modular Forms 
Lemma 4.5.15. Letf(z) = 5]^= o c(n)e^""'^ be an element of%{N, x\ ^nd M a set of 
prime numbers p satisfying 
f\np) 
= t(p)f 
(t(p)eC). 
Then we have: 
(1) // all prime factors of a positive integer m belong to M, then f(z) is an 
eigenfunction of T{m). Moreover put 
f\T(m) = t(m)f 
(t(m)eC), 
then 
c(m) = t(m)c(l). 
(2) Lis;f)= 
n i^-tip)p-'-^x(p)p'-'-'T' 
X 
Tc(n)n-\ 
peM 
" 
where the summation ^ ' is taken over all positive integers prime to all elements ofM. 
Proof The first half of (1) is obvious. Let n be a positive integer prime to m. 
Comparing the n-th Fourier coefficients of/|r(m) and t{m)f we obtain 
(4.5.37) 
t(m)c(n) = c{mn) 
by Lemma 4.5.14. In particular, taking n = 1, we obtain the latter half of (1). By 
(4.5.37), we get formally 
(4.5.38) 
L(s;f) = ( ^"t(m)m-^) x ( 
^'c(n)n-\ 
where the summation J]' is taken over 1 and the positive integers whose prime 
factors are all contained in M, and Y,' is taken over the positive integers prime to all 
primes in M. By Theorem 4.5.13(1), 
tin)t{m)= 
X 
x{l)l'-'t(mn/l') 
0<l\{m,n) 
{l,N)=l 
for two integers m, n contained in ^", so that we get at least formally 
(4.5.39) 
Y^U(m)m-^= f] (^ - t{p)p-'+ 
x{p)p'-''-'T' 
m 
peM 
by a similar argument as in Lemma 4.5.12. Furthermore if 
(4.5.40) 
c(n) = 0(n") 
for some a, then (4.5.39) holds on Re(5) > a + 1. In fact, if f{z) is a cusp form, then 
(4.5.40) was proved in Corollary 2.1.6 with a = k/2. If f(z) is not a cusp form, then 
we shall see (4.5.40) in §4.7. 
D 
By Theorem 4.5.4, the Hecke operators T{n) ((n, N) = i) are simultaneously 
diagonalizable on ^k{N, /). If an element f{z)eS^ki^y X) is a common eigenfunc-
tion of Hecke operators T(n) ((n, N) = 1), WQ can write by the above lemma 
L{s;f)= 
n i^-t(p)p-' 
+ xip)p'-'-'T'x 
I'c(n)n-^ 
pJfN 
n 

§4.5. Hecke Algebras of Modular Groups 
149 
where the summation ^ ' is taken over 1 and the positive integers whose prime 
factors are all divisors of N. Moreover if/(z) is a common eigenfunction of all 
Hecke operators r(n), we can take as M the set of all prime numbers. In this case, 
we get the following 
Theorem 4.5.16. Let f(z) = X„°'= o c(n)e^'''"' be a nonzero element of%(N, x)- The 
following conditions are equivalent: 
(1) f(z) is a common eigenfunction of all Hecke operators T(n); 
(2)cil)^0and 
L(s;f) = c(l)n(l - t(p)p-' + 
x(p)p'-'-'r\ 
p 
where p runs over all prime numbers. 
Moreover if f(z) satisfies the above conditions, then 
f\T(n) = t{n)f 
t(n) = cin)/c(l) 
for all 
n^l. 
Proof (1)=>(2): Let f\T(n) = t(n)f By Lemma 4.5.15, we have c(n) = t(n)c(l) 
for n ^ 1. Then if c(l) = 0, then /(z) = c(0). Since /c ^ 1, we get /(z) = 0; which 
contradicts the assumption. Therefore c(i)^0. 
The latter half follows from 
Lemma 4.5.15(2). (2) => (1): Put t(n) = c{n)/c(l) for positive integers n. Then we see 
f t(n)n-^ = Yli^-t(p)p-^-^Xip)p'-'-'T'-
« = 1 
p 
By Lemma 4.5.12, 
t{m)t(n) = 
X 
d'-' x{d)t(mn/d% 
0 <d|(m,«) 
Multiplying both sides by c(l), we get 
t(m)c(n)= 
X 
d'-'xid)c(mn/d'). 
0 <d|(m,n) 
The right-hand side is equal to the n-th Fourier coefficient of/|r(m) by 
Lemma 4.5.14. Let b{0) be the constant term of the Fourier expansion of/|r(m), 
then 
(f\T(m)){z)-t(m)f{z) 
= b{0)-c(0). 
Since/I r(m) - t(m)f is an element of ^fc(N, x) and /c ^ 1, we get ^(0) = c(0). Thus 
f\T{m) = tim)f 
D 
Let us consider the case when N = 1 and /c = 12. Since dim ^12(^(1)) = 1» ^(2) 
is a common eigenfunction of all Hecke operators T{n). Hence, if we let 
A(z)= X T„e 
n = l 
litinz 

150 
4. Modular Groups and Modular Forms 
be the Fourier expansion, then we obtain 
A\T(n)=:x„A 
and 
p 
since TJ = 1. Ramanujan co'njectured by calculating the Fourier coefficients of A(z) 
that L(s; A (z)) has the Euler product as above, and further 
which is the famous Ramanujan conjecture. Petersson generalized it as follows. 
Theorem 4.5.17. (The Ramanujan-Petersson conjecture) Let 
f(z) = f 
fl(n)e2--
n = 1 
be an element of Sfj.iN, x). If(n, N) = 1, then 
a(n) = 0(n^'-'^"'). 
We do not prove this theorem in this book. We only remark here that 
Theorem 4.5.17 is equivalent to saying that 
(4.5.41) 
if a prime number p does not divide N, then the absolute values of roots of 
the equation 
X'-t{p)X-hX(p)p'''=0 
are p^'^'^^'^, where t{p) is an eigenvalue of T(p) on ^^(N, x)-
It is easy to see Theorem 4.5.17 from (4.5.41). Conversely, let u and v be 
solutions of the equation 
X'-t{p)X-^X{p)p'-'=0, 
then 
t{p') = (u'^'-v'^')/(u-vl 
\uv\ = p^-K 
Therefore Theorem 4.5.17 implies \u\ = \v\ = p^*"^^/2. 
The generalized Ramanujan conjecture for k — 2 was proved by [Eichler 2], 
[Shimura 2] and [Igusa]. They solved it as follows. If T is a principal congruence 
modular group, then ^p can be considered as an algebraic curve defined over Q. By 
the congruence relation of Eichler-Shimura, it can be proved that the Hasse zeta-
function of the algebraic curve ^p is essentially the product of L(s;f) 
(fe9'^{r)). 
This reduces the Ramanujan conjecture to the Weil conjecture for congruence zeta-
functions of algebraic curves defined over finite fields, which have been proved by 
Weil. Furthermore, this relation between Hasse zeta-functions and L(s;f) implies 
that the Hasse zeta-function of ^p satisfies a certain functional equation. If /c>2, 
then the conjecture is reduced to the Weil conjecture for congruence zeta-functions 
of higher dimensional algebraic varieties, which was proved by [Dehgne 2]. In the 
case when k = 1, [Dehgne-Serre] solved the problem by proving that the Dirichlet 

§4.5. Hecke Algebras of Modular Groups 
151 
series is nothing but the Artin L-function with respect to a representation of degree 
2 of the Galois group of a certain extension over Q. 
Now as we explained in the beginning of §4.3, the investigation of modular 
forms is reduced to that of ^^(N, x)- However, sometimes it is necessary to consider 
^ki^iiN)) 
and the Hecke operators acting on it. We shall study the Hecke algebra 
of r^iN) and the relation with the Hecke algebra for TQCN). Put 
A,(N) {[::] 
eM2(Z) a = 1, c = OmodAr, 
ad — boO 
which is a subsemigroup of GL2(Q) containing FiiN). 
Theorem 4.5.18. (1) ^(ri(N),Ai(N)) 
is isomorphic to m{ro(Nl Ao(N)) through the 
correspondence: 
r,(N)ar,(N)h^ro(iV)aro(N) 
(oceAdN)). 
(2) The correspondence defined m (1) is commutative with the natural embedding 
of^f^{N, x) into '^kiFi (N)); namely, for any element a of A ^ (N\ the following diagram 
is commutative: 
Proof. We apply Theorem 2.7.6, taking Tj(AT), zli(N), FoiN) and 4oW for r,A,U 
and D, respectively. We shall verify the three conditions there. Since conditions 
(i) and (iii) are satisfied obviously, we have only to prove the second condition, 
that is, 
(4.5.42) 
ro(JV)aro(N) = ro(JV)ari(JV) 
(aezli(JV)). 
^ = [0 I] 
First we prove (4.5.42) is satisfied for any element a = I 
. Put n = /m, 
[0 
mj 
then as was mentioned after Corollary 4.2.2, we can* choose a complete set of 
representatives of ro{N)/ri(N) 
consisting of the elements y such that 
[o:] 
7 = 1^ 
I mod nN. 
Then a ~ ^ a e SL2 (Z) and 
Vu 
01 
modiV, 
«"^""[o!] 
so that ocyeyaFiiN). Therefore we get 
ro(N)aro(N) = r„(N)ari(N). 

152 
4. Modular Groups and Modular Forms 
We note that K 
is not necessarily contained in AJN). Next let a be any 
[0 
mj 
element of Ai(N). Since aeAQ(N), there exist integers / and m such that 
ro(iV)aro(iV) = ro(iV)P N^oW 
by Lemma 4.5.2. Therefore 
ro(iV)ari(iV) cz ro(iv)aro(iV) 
and this implies 
Therefore we obtain 
roiN)aro(N) = ro{N)(xr,(Ny 
n 
Next let r be a modular group such that 
roiN)^r^r,(Ni 
and put 
A = 
A,iN)-rczAoiN). 
From the proof of Theorem 4.5.18, we see easily 
mr,A)^mroiN\Ao(N)) 
and this isomorphism commutes with the natural embedding of ^fc(r) into 
^kiri(N)). Hereafter we identify ^{r^(N\ A^{N)\ ^(r, A) and ^{ro(N\ Ao{N)X 
and write 
^(iv) = mrANX A,(N)) = ^(r, J) = mro(Nl AoiN)). 
We quote from [Shimura]: Theorem 3.48 and Theorem 3.52 the following 
important 
Theorem 4.5.19. Let F be a modular group such that 
Assume fe ^ 2. 
(1) The Heche algebra ^(N) is representable on S^^iH ^y matrices with rational 
integral entries. 
(2) There exists a basis of6^k(r) consisting of elements whose Fourier coefficients 
at 00 are all rational integers. 

§4.6. Primitive Forms 
153 
Since by (4.3.1), 
the investigation of the Hecke algebra of r(N) is reduced to that of a modular 
group r of above type. 
§4.6. Primitive Forms 
We assume k>0 throughout this section. For a positive integer /, we put 
(4.6.1) 
5, = V 
^lecmu). 
Then for a function f(z) on H, 
(4.6.2) 
filz) = l-'''{f\,5,)(z). 
Lemma 4.6.1. lff{z)e^f^{N, %), then for any positive integer /, 
f(lz) = 
l-''i\f\,5,)(z)e%(lN,x). 
Moreover, iff(z) is a cusp form, so isf(lz). 
Proof Let f(z)e<^j,(N,x) (resp. ^^(iV,^)), and put g^f^di- 
For any 
y = \ L 
J k ^o(^^X we have 
Therefore 
= i{d)(f\A) 
= z(y)^-
By Lemma 2.1.3, we see/(/z)G^fe(/Ar, x) (resp. ^fc(/N, x)). 
• 
The Hecke operators T(n) ((n, iV) = 1) on ^jk(N, /) are simultaneously dia-
gonalizable. Furthermore, if/(z) is a common eigenfunction of all Hecke operators 
r(n), then the associated Dirichlet series L(s;f) has an Euler product. We naturally 
ask the question whether all Hecke operators T(n) on S^ki^, x) are simultaneously 
diagonalizable. In the case when iV = 1, it is obviously true. Hecke proved that it is 
true for the following cases: 
1 ° ^fc(ro(N)) when N is prime, k<12ork= 
14; 
2° ^fc(Ar, x) when / is a primitive Dirichlet character of conductor N. 

154 
4. Modular Groups and Modular Forms 
On the other hand, [Shimura, Remark 3.59] implies that S^ki^.x) does not 
necessarily have a basis consisting of eigenfunctions of all Hecke operators T(n). 
This phenomenon arises from the fact that 
(4.6.3) 
iff(z)E^,(N,Xl 
then 
f(z)J{lz)e^,(lN,x\ 
In the above cases 1° and 2°, ^fc(iV, x) contains no cusp forms of smaller level. Thus 
we may expect that if we exclude cusp forms of lower levels, then all Hecke 
operators T(n) are simultaneously diagonalizable on the complementary subspace. 
This is in fact true. We explain this result and some applications following 
[Atkin-Lehner] [Miyake], [Asai] and [Naganuma]. We start from the relation 
between Hecke operators and the embeddings. 
Lemma 4.6.2. For a positive integer I, we put S 
following diagram is commutative: 
%(.N,x) 
^ 
%{IN,X) -
,=[;:}.., /Ar)= 1, then the 
^k(N,x) 
Tin) 
> %ilN,x) 
Proof. Let/(z) be an element of ^fc(iV, /), and put g =/|fc^/. If (n, IN) = 1, then 
f\Tin,n) = x{n)n'-'f 
g\T(n,n) = xin)n^~''g' 
and 
Therefore we have only to prove the assertion for a prime number p prime to IN. By 
Lemma 4.5.6, we may take the set 
{[o :}[o :]|»-<4 ^ 
as a complete set of representatives of rQ{lN)\ro{lN)\ 
\rQ(lN). Then 
Since / and p are coprime, the set 
{['o •:]{i :]|»-<4 

§4.6. Primitive Forms 
155 
is a complete set of representatives of ro(N)\ro(N) _ 
KoC^X so that 
= {f\Tip))\,S,. 
D 
The following lemma used by Hecke in the cases T and 2° plays the funda-
mental role also in the general cases. 
Lemma 4.6.3. (Hecke) Letf(z) be an element of^f,{N, x)- If there exists an element 
i(N) satisfying the following conditions, thenf(z) = 0. 
'-[: :]°^--' 
(i) det(a) > 1, (det(a), N) = 1, (a, b, c, d) = 1; 
(ii) 
f\,oie%{Nay 
Proof By Lemma 4.5.2, there exist two elements ^i, 72 of ro(N) such that 
riay2= 
Q ^ 
il\m, 
m,/>0). 
By (i), (/, m) = 1, so that / = 1 and m> 1. Since 
we get 
Let y be an element of ro(N) such that ocyoc'^ ^FoiN). Since 
det(a)a-^ = r _ ^ 
"Mezlo(iV), 
we see that det(a)a7a"^ ezlo(^)- Thus we can take elements 73, y4^erQ{N) so that 
(4.6.4) 
ciet(a)73aya"^74 = ^ 
^ 
(u\v, 
u,v>0) 
by Lemma 4.5.2. We see uv = det(a)^ by taking the determinants of both sides. If 
u = v, then ocyoc ~ ^ = 7^ ^74 ^ e ^o(^)? which contradicts the assumption on y. There-
fore h — v/u>i. 
Acting (4.6.4) on/(z), we get 
cf(z) =f(z/h) 
(c = h'^'h{y3)xiy)xiy4) ^ o). 
Let/(z) = YJ^^O «(")^^"'"^ be the Fourier expansion. Then 
a(n) = C-^a{n/h) = C-'a(n/h') 
for any positive integer t. Therefore we get a(n) = 0 if n>0. Since /c>0, we obtain 
f{z) = 0. 
D 
Theorem 4.6.4. Let I be a positive integer. If a holomorphic function f(z) on H 
satisfies the two conditions: 
(i)/(z+l)=/(z), 
(ii)/(/z)e^,(iV,;f), 

156 
4. Modular Groups and Modular Forms 
then 
(1) 
iflm^\N,thenf{z)G%{Nllx)'. 
(2) iflm^)(N,thenf(z) 
= Q. 
Here m^ is the conductor of x- Furthermore iff(lz) is a cusp form, then so isf(z). 
Proof We may assume that / is a prime number. First let us show/(z)e^fc(iV, x)-
Put^(z)=/(/z)and 
^' = { U y-^oW|b.Omod/}. 
Take an element y = \ 
^ 
I of T'. Since 
\_cN 
d _\ 
we see 
or 
f\Mr'ySi = xid)f\,s,. 
This implies/I ^y = x(d)f Let F" be the group generated by F' and 
. Since 
[ r " : r ] ^ / 
and 
4i:] 
we see that F" = FQ{N) or TQCAT) is generated by 
over F'. Therefore by (i), 
f(z) belongs to %(N, x)- Next suppose / is prime to N. Then f(z) = 0 by taking 
oc = Si 
in 
Lemma 
4.6.3. 
Now 
we 
assume 
l\N. 
For 
any 
element 
^'"[cAT 
Jero(N),wesee 
and in particular, 
Therefore, if we put 
^^'[cN/l 
' = [i 
^^'[N/I ij 
m"|r 1 
C 
i}\_N/l 1 ][: 
= X(d)f, 
;]• 
then/I^7 = / Let n be any integer such that 
niV//+l ^Omod/. 

§4.6. Primitive Forms 
157 
Then we can take an integer m so that 
(4.6.5) 
nil + mN/l) -\-m = n-\- m{nN/l + 1) = 0 mod /. 
Then 
and hence 
Ay = 
Xi^+nN/l)f. 
Therefore if/(z) ^ 0, then xi^ + nN/l) = 1 for any integer n satisfying (nN/l + 1, /) 
= 1. This impHes that x is defined mod AT//, and N is divisible by Im^. This impHes 
(2). Assume lm^\N. Since ro(N//) is generated by 
over ro(N), we get 
f{z)G%{N/l, 
x)' The last assertion is obvious. 
D 
Lemma 4.6.5. Let f{z) = Yj^=o^n^^'''"^ be an element of%{N, x)- For a positive 
integer L, we put 
Then g{z)e^k{M, x) ^^th 
6f(z)= Z 
a^'-^ 
in,L)=l 
M = NIIP 
UP'-
p\L 
p\L 
p\N 
pJ^N 
Furthermore iff(z) is a cusp form, so is g{z). 
Proof. We have only to prove the assertion when L is a prime number p. Put 
N' = N or N' = pN according as p| AT or not. Since pi AT', we have 
(4.6.6) 
^o(N')\l l\ro{N')=Ur,{N')\l 
""] 
L^ Pj 
m=o 
{_yj p J 
by Lemma 4.5.6. Since ^^(iV, x) ^ %(N\ x\ we get/| '''T{p)e^j,iN\ 
xl By (4.6.6), 
we see 
(/I ^•r(p))(z) = p-' t'^n ' Z e'-'"^^*-"''" 
M=0 
m = 0 
^2ninz 
n = 0 
SO that 
00 
{f\'''T(pMpz)= X a„,e"''"''\ 
n = 0 
which belongs to %{N'p, x) by Lemma 4.6.1. Therefore we obtain 
g{z) =f{z)-{f\ 
'^'T{p)){pz)e^,{N'p, x\ 
The last assertion is obvious. 
D 

158 
4. Modular Groups and Modular Forms 
Lemma 4.6.6. Let x be a Dirichlet character mod iV, / a positive integer, and p a 
prime number prime to I. Put M = IN. Then the following diagrams are commutative: 
roipN) 
(1) 
%(pN.x) 
[I p]'«^^^ 
'^kiN.x) 
il 'M^ 
ro(pM)\ \ro(.M) 
%(pM,x) 
^-^ 
> %(M,x) 
Here the vertical arrows indicate the natural embeddings. 
(2) 
'^,(PN,X) 
%(PM,X) 
UpN)\. 
|r„(jv) 
''o(pM)r 
lr„(M) 
%(N, X) 
%(M, X) 
Similar results as above hold for cusp forms. 
Proof. (1): By assumption, pliV if and only if p\M. Therefore the assertion is 
obvious from Lemma 4.5.11. (2): Let/(z) be an element of %{pN,x\ 
and put 
^ =/U(5,. We put 
and 
^ ^ I p-\ 
ifplM 
[ p 
otherwise, 
yv=iQ 
J J 
( O g v g p - i ) . 
\i d = p, then take an element y,, of FQ^M) as in Lemma 4.5.11. Then 
(4.6.7) 
r„(pM)|^J ^Jro(M)= Uro(pM)|^J 
°Jy„ 
SO that 
(4.6.8) p--.|r„(pM)[J ^]ro(M)= E^,U[; 0]y. 
Since 
( O ^ v ^ p - 1 ) , 

§4.6. Primitive Forms 
and 
^lyp^i 1 [: 
modp, 
modiV, 
159 
provided pJfN,wG see 
by Lemma 4.5.11. Therefore it follows from (4.6.8) that 
^|ro(pM)|^J ^]ro(M) = (^/|ro(pJV)|^J 
P ] ^ ^ ^ ^ ^ 
Si. 
D 
Ininz 
Lemma 4.6.7. Let l(>\)he a positive square-free integer, andf{z) = ^^=0 ^«^ 
an element of%{N, x)- V^n = ^fa^ ^'' ^ prime to /, then we can express 
p\l 
where p runs over all prime factors of I. Furthermore ifl\N, then we can take gp(z) 
from %{Nl, x)- V f(^) is a cusp form, all gp(z) can be taken as cusp forms. 
Proof We prove the assertion by induction on the number of the prime factors 
of /. First suppose / is prime. Then g{z) = f{z/l) satisfies the conditions of 
Theorem 4.6.4, so that g(z)e%(N/l, x) or /(^) = 9(z) = 0 according as lm^\N or 
not. Consequently g(z) e %(Nl, x) and 
fiz) = gilzy 
Next assume that / is a composite number and the assertion is true for any proper 
divisor of /. Let p be a prime factor of / and /' = l/p. Put 
h(z)= 
Y. »ne"'"'. 
( > l . p ) = l 
Then h{z)€%{,Np^, %) by Lemma 4.6.5. Put 
f(z)-h(z)= f b„e^''". 
n = 0 
Then if (n, p) = 1, then h„ = 0. Put 
gp{z)=f{z/p)-h(z/p), 
then gp(z)e^j^{Np, x) by the induction assumption, and 
(4.6.9) 
f{z) = gp(pz) + h(z). 
Moreover h(z) satisfies the assumption of the lemma with Np^ and /' in place of AT 
and /, respectively. Therefore we can find gq{z)e%{Np^r^,x) (= %iNl^,x)) for 

160 
4. Modular Groups and Modular Forms 
each prime factor ^ of /' satisfying 
Hz) = Z gM^y 
q\l' 
This combined with (4.6.9) imphes the first half of the assertion. It is obvious from 
the above proof and Lemma 4.6.5 that if /|iV, then we can take gp(z) from ^fc(N/, x). 
It is also obvious that we can take gp{z) from cusp forms when f{z) is a cusp 
form. 
D 
The following theorem is a generalization of Theorem 4.6.4. 
Theorem 4.6.8. Let I be a positive integer, andf(z) = ^^=0 ««^^"'"^ ^^ element of 
%(N, x)' Let m^ he the conductor of x- Assume a„ = Ofor all n prime to I. 
(1) If{lN/m,) 
= l,thenf(z) = 0. 
(2) //(/, N/m^) 7^ 1, then there exist fp{z)e^j^(Nlp, x)for all prime factors p of 
(/, N/m^) such that 
p\il,N/m,) 
Iff(z) is a cusp form, then we can take fp(z) from cusp forms. 
Proof We may assume that / is square-free. We prove the assertion by induction 
on the number of the factors of/. When / is a prime number, the assertion is nothing 
but Theorem 4.6.4 for/(z//). Next assume that the assertion is true for any proper 
divisor of /. Let p be a prime factor of /, and put /' = I/p. We put 
(4.6.10) 
h(z)= X 
ay'"\ 
( n , / ' ) ^ l 
(4.6.11) 
g(z)=f(z)-h(z)= 
X a„e 
{n,l')=l 
Ininz 
We see h{z) and g(z) belong to %(Nl'^, i) by Lemma 4.6.5. If (n,p) = 1, then the n-th 
Fourier coefficient of g(z) vanishes. First assume pm^J( N, then pm^^XNl'^ and 
therefore g(z) = 0 by Theorem 4.6.4, namely, 
f(z) = h(z)= 
X 
a„e2--. 
This implies that f(z) satisfies the assumption for /' in place of /, and hence, the 
assertion is true by the induction assumption. Next assume pm^ \ N and put 
gpiz) = g{z/p). 
Then gp(z)e%{Nr^/p,x) by Theorem4.6.4. Put d = p-l 
if p^\N, or d = p ii 
p^)(N. Take elements yA^^^^d) 
ofToiNr^/p) so that 
roiNn[, 3^o(ivrVP)=Uro(N/'^)[; J] 

§4,6. Primitive Forms 
161 
(see Lemma 4.5.11). Then we see 
d 
v = 0 
Thus we obtain 
(4.6.12) 
g(z) = g,(pz) 
= p{d + l)-'(g\ro(NnV^ 
^1ro(M'Vp))(pz). 
/,(z) = p(<i+1)-' (/|r„(N)P ^lro(N/p)\z). 
Put 
Then /p(z)6^t(N/p, x), and by Lemma 4.6.6(1), 
(4.6.13) 
M2) = pid+ir'({f\ro(Nn\l 
^lr„(M'Vp))(4 
Let us show that /(r) —fp(pz) satisfies the assumption of the theorem for /'. It is 
obvious that /(z) -fj,(pz)e%(N, %)• We see 
(4.6.14) /(z) -f,(pz) =f(z) -f,(pz) - g(z) + g,(pz) 
= 
(f(z)-g(z)) 
-p(d+ 1)-' ((/-g)|r„(M'^)[J 
°]ro(M'Vp))(pz) 
= h{,z)-p(d+\)-'U\UNV^)\\ 
^1ro(iV/'Vp))(pz). 
Since the w-th Fourier coefficient of h(z) vanishes if n is prime to /', we can express 
h{z)=Y.hM^) 
(K{z)e%(Nl'\i)) 
q\l' 
by Lemma 4.6.7. Moreover for any prime factor q of /', we have 
'•iroCN/'^)^ ^\(Nl'^lp) 
= h\r^(NV\)\^ 
^jr„(Nr'q/p) 

162 
4. Modular Groups and Modular Forms 
by Lemma 4.6.6(1). This combined with Lemma 4.6.6(2) implies 
h\ro(Nn\ 
• - 
\ro{Nl''/p)\z) 
where 
^A = K, 
. • 
In 
particular, 
the 
n-ih 
Fourier 
coefficient 
of 
/i|ro(N/'^) 
ro(iV/'Vp) )(z) vanishes provided (n,/') = 1. Consequently the 
w-th Fourier coefficients of/(z) —/^(pz) vanishes by (4.6.14). Therefore, by the 
induction assumption, we obtain that 
/(z)-/,(pz) = Y.fM') 
(Uz)e%(N/q, x)X 
where q runs over all prime factors of /'. This completes the proof of (2). If/(z) is a 
cusp form, then the modular forms which appear in the proof can be taken as cusp 
forms. 
D 
Hereafter we consider only cusp forms. We denote by ^^ (^» z) the subspace of 
^ki^^ x) generated by the set 
[j[j 
{f{lz)\f{z)eS^,{M,x)}. 
M 
I 
Here M runs over all positive integers such that m^|M, M | AT, and M ^ N;l runs 
over all positive divisors of N/M (including both 1 and N/M); m^ is the conductor 
of X' In other words, ^liN,-/) 
is the subspace of ^^^(N, x) generated by cusp 
forms essentially of lower levels. Furthermore, we denote by ^fe(N, i) the ortho-
complement of ^l(N,x) 
in 9'f^{N,x) with respect to the Petersson inner pro-
duct. Namely, ^l(N, 
x) = ^liN, 
x)^- We also write ^?(ro(Ar)) = y?(N, x) and 
^k{ro{N)) 
= ^l(N,x) 
with the trivial character x mod AT. By definition, the 
following lemma is obvious. 
Lemma 4.6.9. (1) If x is a primitive Dirichlet character of conductor N, then 
^k(^^ X) — ^ki^y 
X)' 
(2) Ifm^\M,M\N 
andM^ 
N, then ^^(M, x) ^ ^1{N, x)-
(3) ^k(A^, x) is generated by the set 
[j[j 
{f{lz)\nz)e9'°(M,x)}-
M 
I 
Here M runs over all positive integers such that m^\M and M\N; I runs over all 
positive divisors of N/M {including both 1 and N/M). 

§4.6. Primitive Forms 
163 
Lemma 4.6.10. ^{(N, x) and 5^?(N, x) are stable under Hecke operators T(n) 
((n,iV)=l). 
Proof. Let/(z)e5^i(iV, x)- By definition, we can write 
V 
Put g,(z) =/v(/vZ)- Since (n, l^N) = 1, we see 
(/|r(«))(z) = X(3vir(/.))(z) 
V 
= Z(/vinn))(W 
V 
by Theorem 4.5.10 and Lemma 4.6.2. Thus if\T(n))(z)e^l(N,x\ 
namely, 
6^1 (N, x) is stable under T{n). By Theorem 4.5.4, the adjoint operator of the Hecke 
operator T(n) on 5^fc(A/^, x) is x{n)T(n\ and therefore, ^'^{N, x) is also stable under 
T(n). 
U 
It follows from the above lemma that subspaces ^^(^^ X) and ^\(N, x) of 
5^fc(Ar, x) have a basis consisting of common eigenfunctions of all Hecke operators 
r(n)((n,iV)=l). 
Lemma 4.6.11. Let f(z) = ^^=1 «n^^"'"' ^^ an element of 6^^{N, xl V f(z) is a 
common eigenfunction of Hecke operators T(n)for all n prime to some integer L, then 
ai^O. 
Proof Assume a^ = 0. Then by Lemma 4.5.15(1), we see a„ = 0 for all n prime to L. 
Therefore f(z)e^\(N, 
x) t>y Theorem 4.6.8, which is a contradiction. 
D 
Theorem 4.6.12. Let f{z) and g(z) be elements of ^^(N, x) and ^ki^, x\ respect-
ively. Iff{z) and g{z) are common eigenfunctions ofT{n) with the same eigenvalue for 
each n prime to some integer L, then g{z) is a constant multiple off(z). 
Proof. Let /(^) = Xr= i ^n^^""*^ ^^ ^^^ Fourier expansion. Since ai # 0 by 
Lemma 4.6.11, we may assume a^ = \. Furthermore we may assume N\L. Put 
g(z) = g^'\z) + g^'\z) 
{g<'\z)e^,'(N, 
x\ g''\z)e^i(N, 
rf). 
By Lemma 4.6.10, both g^^\z) and g^^\z) are common eigenfunctions of T(n) with 
the same eigenvalue a„ for each n prime to L. Assume g^^\z) ^ 0, and put 
9«»(z) = t 
by-'. 
n = 1 
By Lemma 4.6.11, we have b^ ^ 0. Let us show g^^\z) = b^fiz). 
We put 
(4.6.15) 
g^^\z)-bj(z)= 
f 
c„e2--. 

164 
4. Modular Groups and Modular Forms 
Since bia„ = b„ for all n prime to L by Lemma 4.5.15(1), we get c„ = 0 for all n such 
that (n, L) = 1. Applying Theorem 4.6.8, we see g^^\z)-hj(z)e^i 
{N, xl and 
g^'Hz) = bJ(z). 
Next we shall prove that g^^\z) = 0. First suppose N — m^, where m^ is the 
conductor of %. Then ^l(N, /) = 0. In particular, ^^^H^) = 0. Next assume N ^m^. 
We separate the proof into two steps. 
(i) If ^^^^ (z) 7^ 0, then there exist a proper divisor M of AT satisfying m^|M, and a 
non-zero element h{z) of .$^fc(M, x) such that /i| r(n) = a„^ for all n prime to L, In 
fact, by definition, we may write 
(4.6,16) 
g^'Hz) = Y^KiKzl 
(/I,(Z)G5^«(M„ xl KM,\N. M, # iV). 
V 
Since M^ divides AT, Lemma 4.6.10 implies that ^^(My, x) has a basis consisting of 
eigenfunctions of T{n) for all n prime to L, so we may assume that all h^(z) are 
common eigenfunctions of T(n) for all n prime to L. Lemma 4.6.2 implies that 
h^(hz) are also common eigenfunctions of T(n) for all n prime to L. Since 
eigenfunctions with distinct eigenvalues are Hnearly independent, the summation 
on all h^{ly;Z) whose eigenvalues for T(n) are different from a„ must vanish. 
Therefore, by removing such functions we may assume that all /iy(z) appearing 
on the right-hand side of (4.6.16) satisfy 
K\T(n) = a„K 
{(n.L)=\y 
Therefore we may take any h^(z) and M^ as h{z) and M, respectively. 
(ii) Let h(z) = c\ e^"'^ + • • • be the element of 5^?(M, x) obtained in (i). Since 
h\T{n) = a^h for all n prime to L, we see c\ ^0 by Lemma 4.6.11. Put 
h{z)-c[f{z)= 
f 
dy^'"^. 
« = 1 
Then by Lemma 4.5.15(1) d„ = 0 if (n, L)= 1, and by Theorem 4.6.8 
h(z)-c\f{z)e^l{N,xy 
Therefore 
/(z) = -c[-\h(z) 
- c[f(z)) + c[-'h(z) e ^\N, 
X); 
this contradicts the fact that/(z) is a nonzero element of ^^(N, x)- Consequently 
we obtain g^^\z) = 0, and therefore, 
g(z) = g^^\z) = bj(z). 
D 
We call an element f(z)e9'^(N, x) a primitive form of conductor N if the 
following conditions are satisfied: 
(i) /(z) is a common eigenfunction of all T(nX ((w, iV)= 1); 
(ii) letf(z)= YJ^=I «n^^"'"^ be the Fourier expansion, then a^ = 1. 
We also call ^k(^^ x) the space of primitive forms of level N with character x-

§4.6. Primitive Forms 
165 
Theorem 4.6.13. (1) Primitive forms are common eigenfunctions of ^(N)KJ 
^*{N). 
(2) y^CN, y) has a basis consisting of primitive forms. 
Proof (1): Let/(z) be a primitive form in y|?(iV, /), and f\T{n) = aJ for n 
prime to N. Let T and T* be elements of ^{N) and ^*(JV), respectively. Since 
^(N) is commutative, T is commutative with T{n). Furthermore since 
f\T(n)=^X{n)f\T*{n) 
and T* is commutative with T*{n), T* is also commu-
tative with T(n). Therefore/I r and/1 r* are also common eigenfunctions of T(n) 
with the same eigenvalue a„. Therefore Theorem 4.6.12 implies that both/|7 and 
f\T* are constant multiples of/(z), or 
f\T=cf 
f\T* = c'f 
(2): Since S/'^iN, x) has a basis consisting of common eigenfunctions of all 
T(n) ((n, N) = 1) by Theorem 4.5.4(3) and Lemma 4.6.10, (2) follows from (1) and 
Lemma 4.6.11. 
D 
Corollary 4.6.14. Assume that there exists a common eigenfunctionf{z)e6^k{^, 
x) 
of T(n) with eigenvalues a„ for all n prime to N. Then there exist a divisor M of 
N satisfying m^\M and a primitive form g(z)€^^(M, 
x) such that 
g\T{n) = a„'g 
for all n prime to N. Moreover iff(z)t^l{N, 
xX then M ^ N. 
Proof 
If f{z)e^l{N,x\ 
then the assertion is obvious Since u 1 # 0 
by 
Lemma 4.6.11. Suppose f{z)iS^l(N,x)- 
Then by (i) in the proof of Theorem 
4.6.12, we have a divisor M of N and an element g{z) of ^^{M,x) 
such that 
g\T(n) = a„g for all n prime to N. By Lemma 4.6.11, we can take a primitive 
form as g(z). This proves the first half of the assertion. The latter part follows 
from Theorem 4.6.12. 
• 
Let /(z) = Xr=i«/.^^"'"'' t>e a primitive form of ^?(iV,x). Then by 
Lemma 4.5.15(1), 
f\T{n) = aJ 
for all n. 
Moreover since/(z) is an eigenfunction of r*(«), and T*(n) is the adjoint operator 
of T(n) with respect to the Petersson inner product by Theorem 4.5.4(2), we get 
f\T*(n) 
= dJ, 
Furthermore Theorem 4.5.4(1) impHes that 
(4.6.17) 
a, = man 
if 
{n.N)=\. 
Moreover we see by Theorem 4.5.5 
(4^18) 
{f\k(^fi)\T{n)=d„(f\k(^N\ 
( / L c o ^ ) m « ) = «„(/kcoJ, 
for all positive integers n. 

166 
4. Modular Groups and Modular Forms 
Theorem 4.6.15. (1) By the action ofcOf^, ^ki^^ 
X) ^^d S^l(N, y) are isomorphic to 
^|?(Ar, X) and ^1{N, x\ respectively. 
(2) If f(z) is a primitive form of ^t(N, 
/), then fp(z) is a primitive form of 
5^«(iV, X) and 
f\kCON = cfp(z) 
(ceC). 
Proof (1): First let us prove that co^ maps ^i(N, x) into ^{{N, x). We have only 
to show that if 
f(z)==(h \M(z) 
ih{z)E^,(M, x\ M ^ N, IM\N), 
then f\k(Oj^e^l{N, 
x)- Put /' = N/IM. Since 
we see 
= (h \kCOM) \k^l' ' 
Since h\kO)j^^6^k(M, xl we get f\,a)j,e 6^UN, x)- Next assume/(z)e 5^]?(iV, /). 
^^Q sec 
if\kCON.h) = (fi-lfh\,oy^) 
= 0 
for all h{z)e^liN, 
x) by Theorem 2.8.2. Therefore /|fc(w^e<^?(N, xl Since 
^kiN.x) is isomorphic to ^k(iV, x) by ca^, we obtain 6^l(N, x) - ^k(^. x) and 
^l (iV, x) ^ ^fc (iV, /), respectively. (2): Since/lfeCo^ is an element of 6^t(N, x) and it 
is a common eigenfunction of ^(AT), it is a constant multiple of a primitive form. On 
the other hand,/|fcCa^ is also a constant multiple of/p(z) by (4.6.18), and a^ = 1. 
Therefore/p(z) is a primitive form. 
D 
Let/(z) = Y,n = 1 a„e^""'"' be a primitive form of ^]?(iV, xl By Theorem 4.5.16, 
we have the Euler product 
p 
= n i^-ci,p-'+xiP)p'-'-'r' X n ii-a,p-T'-
We mentioned in Theorem 4.5.17 without proof that ifpJ^N, then |ap|^2p^*~^)/^. 
We are going to give a similar estimate of a^ for a prime factor p of AT. Let p be any 
prime factor of iV, Np the p-component of AT, and Xp the Dirichlet character mod Np 
defined by (3.1.4). Moreover for a prime factor q of AT, we put 
X',= U Xp-
Let y^ and y'^ be two elements of SLjiT) such that 
(4.6.19) 
y, ^ [:-;] 
[;:] 
modAT^, 
mod{NIN,)\ 

§4.6. Primitive Forais 
and 
(4.6.20) 
167 
We put 
(4.6.21) 
Then 
and 
Since 
and 
we see 
and 
y<i = 
mod AT; 
mod(NIN,f. 
'.-r=4:-:]. ,;=4T':] 
n,^ 
W oj 
r 0 
- n 
[NIN, 
OJ 
modN|, 
mod(A^/Af,)^ 
moiNl. 
mod(N/N,f. 
L(iV/N,)c d J 
^''' I 
modWN,)^ 
-;[;. 3*-' • 
r a {N/N,)bl 
lN,c 
d J 
r 
d 
-N,c1 
1-{N/N,)b 
a J 
modN, 
modN/N^, 
r\MN)% ' = ro(N), 
ri'roWr,'-' = r^iN), 
x(iqVnq^) = {XqX,){yl 
xWqyri'q ^) = {xM(y\ 
(ye^oW)-
Therefore we get the isomorphisms 

168 
4. Modular Groups and Modular Forms 
by the correspondences "/t-^/lk^/^", "/•—*'/Ik^i", respectively. By a similar argu-
ment as in the proof of Theorem 4.5.5, we obtain the following commutative 
diagrams: 
(4.6.22) 
if (n, iV,) = 1, then 
^k(N, X) 
(4.6.23) 
if(n,N/N^)=l,then 
^.(N, X) 
Un)T{n) 
Tin) 
^kiN. X) 
x'M)nn) 
Tin) 
^k(N, X) 
In particular, if an element/(z) o{^f,{N, x) is a common eigenfunction of T(n) for all 
n prime to N, so are/|k^y^ and/Ik?;^. Since for a prime divisor / of N 
1 (/ = «), 
5,^W = cyj/f'"^,. withceZ, 7sro(N), 
/ ' = 
' 
il^q), 
a similar argument as in the proof of Theorem 4.6.15 combined with these proves 
the first assertion of the following 
Theorem 4.6.16. Under the same notation and assumptions as above, we have: 
(1) By r]q, we have the isomorphisms: 
y^N. 
X) ^ ^UN, X',U 
^liN, 
X) ^ ^liN. 
x:,U 
(2) By r]q, we have the isomorphisms: 
(3) fkll 
= X,{-l)X^(N,)f, 
fM,' 
= z ; ( - 1)Z,(N/JV,)/ 
f\kr!qn'q = X'q(N,)f\i,a}fi, 
forf{z)e^,{N,x). 
Put 
and 
(4) Letfiz) = ^"^ J a„e^'""' be a primitive form of^^(N, x)-
(/U,)(z) = cZ by"" 
(fe, = l), 
n=l 
9q(z)= X Ke Ininz 

§4.6. Primitive Forms 
169 
Then g^iz) is a primitive form of^^iN, XqXq) and 
^ ^ f X<i{P)ap if 
p¥^q, 
for any prime number p 
Proof (2): Tt 
yero(Ar)and 
Proof (2): This can be proved similarly to (1). (3): We put y = fjgilqf^N^^ then 
Therefore we see 
Similarly, putting 
7= . 
r 11 
modiv,, 
|_U 
IJ 
flk^q^q 
=f\kyO)N 
= 
XqiNq)f\kCON. 
-'•{o"-;]"' 
we see SeFQiN) and 
3 = 
and therefore. 
= x.(-i)z;w/ 
A similar argument is applicable to rj'q^, (4): By (4.6.22), if (w, q) = 1, then 
(4.6.24) 
{f\,r,^) I T{n) = Xq(n)if\ T{n))\,ri, 
= Xqi^)an(f\kr}q)-
Similarly, if (n, N/N^) = 1, then 
(4.6.25) 
(/|,fy;)| T(n) = 
7q(n)a„{fM,). 
Since f\,,r}q belongs to ^fc(iV, XqXq) t>y C^Xflk^q is a constant multiple of a primitive 
form, so that gq(z) is a primitive form. Taking a prime number p as n in (4.6.24), we 
get 
bp = Xq{p)ap, 
(P # q)' 

170 
4. Modular Groups and Modular Forms 
It follows from (3) that 
Since flkOjf^e^ki^, 
X\ we see by (4.6.23) that 
iA%)\T(q) 
= cif\,co^rj',)\T{q) 
= cXqiqH{f\kO)Nri'^\ 
= Xq(q)aqif\kVq)' 
Therefore we obtain 
Theorem 4.6.17. Letf(z) = Xr= i ««^^"'"^ be a primitive form of^i(N, 
x\ and m the 
conductor ofx- For a prime factor q ofN, we denote by N^ and m^ the q-components of 
N and m, respectively. 
(1) IfN^ = m,,then\a^\ 
= q^'-'^/\ 
(2) IfN^ = q and m, = 1, then a^ = Xqiq)q''~^-
(3) Otherwise, namely, ifq^\Nq and N^ ^ m^, then a^ = 0. 
Proof (1): Let y^ and rj^ be the elements of 0^2(0) defined by (4.6.19) and (4.6.21), 
respectively. Let a be an integer prime to N^. Taking an integer b so that 
a 6 4 - l = 0 m o d % , 
a = 
bmodN/Nq, 
we put 
y [o Njio NJ ' 
Then yeSL2(Z) and 
0 - J '"°'*^'" 
] 
mod N/N,, 
so that yeFoiN) and xij) = Xq{— b). Therefore 
f\\l ;Jy,=x,(-fc)/i{j y. 
Consequently, taking the summation Y,' over a complete set of representatives of 
(Z/iV^Z)^ wesee 
,4.6.26, 
»:»-(s7i.[; ;J)|.,. 

§4.6. Primitive Forms 
171 
Nil'-' Z,(- 1) J^ fe' Z,(«)e^'"'"""''V„e 
Ininz 
= iV','^-'W'(z,)z,(-l)E Z,(n)a„e 
2rtinz 
n = l 
with the Gauss sum IV(Xg). We note that Xq is a primitive Dirichlet character of 
conductor N^. On the other hand, Lemma 4.5.6 imphes that 
(4.6.27) Nj'^-'(S7k[o lJj=f\T{q')-q"'-Hf\nq'-'))l^^ 
^] 
where N = q^. Next put 
- [ i :]'.(42 :])"• 
Since SeFoiN) and 
'"1 0 
(5 = 
\/q 01 
0 
qj 
mod Ng, 
0 
'« 01 
modN/N, 
we obtain 
(4.6.28) 
N f - ( r / i { ; ; J ) [ , , 
Let fir(z) = J^^iby"" 
be a primitive form of yt(N, x^Z,) such that 
f\k% = eg, 
(c ^ 0). 
Comparing the first and q-th Fourier coefficients of the right-hand sides of (4.6.26) 
and (4.6.28), respectively, we get 
(4.6.29) 
N'J'-'W{x,)x,{-l) 
= ca'„ 
and 
(4.6.30) 
c«b,-x;(q)9'"'<"') = 0-
Since 6, = x'q{<l)^i, by Theorem 4.6.16(4), we obtain 
Furthermore it follows from (4.6.29) that 
(4.6.31) 
c = <^-'fr(z,)z,(-l)K-

172 
4. Modular Groups and Modular Forms 
(2): Since N^—q, we have, by Lemma 4.5.6 and Lemma 4.5.11, 
n w R 
^l/^o(A^/^) = /^oWrj 
Jlro(iV)uro(iV)^, 
(disjoint union). 
Moreover the assumption m^ = 1 implies that x^ is a trivial character. Therefore, 
putting 
9=f\ro(N)Y^ ^\o(Nlq\ 
we have g(z) e ^ki^/q, x'q) and 
g=f\nq)-^q"'-%(q)f\,ri,. 
Since T(n) ({n, N) = 1) is commutative with T{qX and also with rj^ by (4.6.22), g{z) is 
a common eigenfunction of T(n) for all n prime to AT with the same eigenvalue as 
f{z). Since S^^iN/q, xi) is contained in S^ki^, x\ Theorem 4.6.12 implies that 
giz) = af(z) 
(aeC). 
Since/(z) is a primitive form of conductor N and ^(z) belongs to ^^(iV/^, xi), we 
get g{z) = 0, namely, 
(4.6.32) 
aj{z)=-q'''-%(q)f\,rj^, 
or 
(4.6.33) 
/!*';,=-a,^(g)g'-*'^/ 
Acting >;, on both sides, we obtain by Theorem 4.6.16(3), 
(4.6.34) 
a,^ = z;(9)9»-^. 
(3): By assumption, q divides N/q, so that 
ro(N)[J °lr„(Jv/q) = ro(N)P ^lro(N) 
by Lemma 4.5.6 and Lemma 4.5.11. A similar argument as in the proof of (2) 
combined with this imphes 
f\T(q)=f\ro(N)[^^ 
^]ro{N/q) = 0. 
This proves (3). 
• 
We restate (4.6.31) and (4.6.33) as 
Corollary 4.6.18. Under the notation and assumptions in Theorem 4.6.16 and 
Theorem 4.6.17, we have: 
(\) If N^ =^ m^, then 
fin, = eg,, 
c^N-'l^W(x,)x,{-\)d\, 
{N,=q% 
with a primitive form gJz) of6^^{N, XaL)-

§4.6. Primitive Forms 
173 
(2) If N^ = q and m^ = 1, then 
flk^q =cf, 
c= 
-q^-^^\, 
and 
% 
=Xq(Q)ag-
We are going to prove that two primitive forms are equal if almost all a^ are 
equal. More precisely, 
Theorem 4.6.19. Let f(z) = ^^=1 ^n^^""" ^^ « primitive form of ^?(iV, x\ and 
g(z) = ^^^ J hne^""'"^ an element of ^fc(M, X). If g{z) is a common eigenfunction of 
M(M) u ^*(M), 6i = 1, and a„ = b„for all n prime to some integer L, then N = M 
and f{z) = g(z). 
Proof We may assume that L is a common multiple of N and M. If p is a prime 
number prime to L, then we see 
Z(P)P*~' 
=al-ap2 
= 
HP)P'-' 
by Lemma 4.5.7(2), so that x(p) = Hp)- Therefore x(n) = X(n) for all integers n 
prime to L. Let us prove M\N. By Corollary 4.3.7, we have 
.4 ^ 3^. 
^iv(^; / ) ^ 
Aj^(k-s;f\k(o^) 
^M(S;^) 
AMik-s;g\kCOM)' 
Since L(s; f) and L{s\ g) have Euler products by Theorem 4.5.16, we see 
Ms\f) 
, rr;, fV7,sn ^ - ^P~'-^ HP)P'~'~'' 
(4.6.36) 
^ ^ = i ^ / ^ r n r ^ - M Z(P)P' 
,fc - 1 - 2s 
on Re(s) >/c/2+1. Since the right-hand side is a meromorphic function on 
the whole s-plane, (4.6.36) holds on the whole 5-plane. On the other hand, 
g\T(n) = b„g, and g{z) is a common eigenfunction of T*{n) by assumption. Since 
T*{n) is the adjoint operator of r(n), we see g\T*{n) = b„g, and 
i9\k(^M)\T(n) = b„(g\k(OM) 
by Theorem 4.5.5. Therefore Theorem 4.5.16 implies that L{s; g\kCOM) also has an 
Euler product. This combined with Theorem 4.6.15(2) implies 
with a constant c. Thus by (4.6.35), we get 
=c( fNi 
HAfu'-Mi^i^Mi^::!:!. 

174 
4. Modular Groups and Modular Forms 
We denote by Mp and Np the p-components of M and AT, respectively. Then we see, 
for any prime factor p of L, 
with a constant c^ by Lemma 3.2.1. Let u and v be the degrees of 
^-app-'-hx{p)p'-'~'' 
and 
l-6pp-^H-2(p)p''-i-2^ 
as polynomials of p~^ respectively. Then 0 ^u,v 
^2. We are going to discuss 
each case separately. From now on we put 
X = p~* 
and 
M,/Np = p\ 
r If M = i;, then Mp = Np by (4.6.38). 
2° Suppose M = 1 and t; = 0. We can rewrite (4.6.38) into 
Cp{\ -QpX) = x^{l - dpp~^x~^). 
Up ^ 0, 
so that \ap\^ = p*; which contradicts Theorem 4.6.17. If w = 0 and v = 1, then we 
see Np = pMp. 
3° Suppose u = 2 and t; = 0. Then (4.6.38) can be rewritten into 
(4.6.39) 
Cp{\-apX + x{p)p'-'x^) = x^l-app-'x''+ 
x{p)P~'~'x-^), 
Comparing the degrees of both sides, we get e = 2 and 
CpXiP)p'''^ = h 
Cp = 
xiP)P~^~\ 
so that lz(p)P = P^; which is a contradiction. If M = 0 and v = 2, then we see easily 
e = - 2 , so that Np = p^Mp. 
4° Suppose M = 2 and v = 1. We rewrite (4.6.38) into 
. . ^ . m 
^ l-apX-\-xip)p'~'x^ 
_ 
l - V ' ^ x - ^ + x(rt/7-^-^x-" 
^ 
1-fepX 
1 - V 
^ 
Put r = x~^ Then the absolute values of the roots of 
t'-apt-^x{p)p'-'=0 
are p^^~^^/^ by (4.5.41) and the absolute values of the roots of 
X(p)p-'-'t'-app-h+l=x{p)p-'-'{t'-appt 
+ Xip)p'^') = 0 
are p<*+D/^. Therefore this case cannot happen. If M = 1 and v = 2, then we also see 
that iVp=>Mp. 
Consequently, in any case we obtain that M| AT, and / is induced by X. Therefore 
Theorem 4.6.12 implies that f(z) = g{z), and so AT = M. 
D 
This theorem combined with Corollary 4.6.14 implies 

§4.7. Dirichlet L-Functions and Modular Forms 
175 
Corollary 4.6.20. Let f{z) be a nonzero element of ^^(N, /). Iff\ T(n) = a„ffor all 
integers nprime to N, then there uniquely exist a divisor M ofN with my^\M and 
a primitive form g(z) of^^(M, x) such that g\T{n) = UnQ for all n prime to N. 
Moreover 
^, . 
. n\\ 
IH^\\T\ 
f{z)eig{lz) 
I /M|iV>. 
Corollary 4.6.21. Let f{z) = Xr=i a^e^""^' be a non-zero element of6e^(N, x). Then 
f(z) is a constant multiple of a primitive form of 9'^(N, x) if and only if f(z) is a 
common eigenfunction of M(N) and ^*(N). 
By Theorem 4.5.5 and 4.5.16, we see 
Corollary 4.6.22. Let f(z) = Y.^= ^ a„e^'''"' be an element of Sf^iN, x) ^ith a^ = 1, 
and put 
00 
(/i,co^)(z) = c £ v''"•"^ 
(fci = 1). 
Thenf(z) is a primitive form o/yjj (iV, x) if and only ifL(s;f) and L{s;f\kO)ff) have the 
following Euler products: 
ite/) = n(i-«pp"^+z(p)p'"'"'rs 
p 
L{s;f\kCOr,) = 
cYl(l-b,p-^-^Xip)p'-'-'r'-
§4.7. Dirichlet L-Functions and Modular Forms 
In §4.3, we proved that integral forms are characterized by functional equations of 
the associated Dirichlet series. It is natural to ask what such Dirichlet series are. We 
showed in §4.1 that the Dirichlet series associated with Eisenstein series with 
respect to SL2(Z) are nothing but the products of two Riemann zeta-functions. In 
this section, we are going to generalize this and prove that elements of J^^. {N, x) 
correspond to the products of two Dirichlet L-functions. This was proved by Hecke 
by constructing modular forms expHcitly using Eisenstein series. Here we start 
from Dirichlet series and construct modular forms as an application of Weil's 
theorem. We shall discuss on Eisenstein series again in Chapter 7. 
Now let Xi and Xi t>e Dirichlet characters mod Mj and mod Mj, respectively. 
Put 
(/)(s) = L{s,Xi)L{s - fe + 1, xi)^ 
for a positive integer k. Then 
p 
00 

176 
4. Modular Groups and Modular Forms 
on Re(s) > k. Here 
(4.7.1) 
a„= 
I 
xAn/d)x2{d)d'-K 
0 <d\n 
We shall prove that (/)(s) is a Dirichlet series associated with a modular form under 
suitable conditions on Xi and X2' Put 
Z = ZlZ2 
and 
M - M 1 M 2 . 
Assume that x(— 1) = ( — 1)* and 
(4.7.2) 
Xi ^^d Xi satisfy one of the following conditions: 
(i) ifk = 2, and both Xi and Xi ^''^ trivial, then M^ — 1 and M2 is a prime number; 
(ii) otherwise, Xi ond Xi ^^^ primitive characters. 
First suppose that there exists an element/(z) of ^fc(M, x) such that L{s;f) = ^(s), 
and we study the constant term of/(z) by the functional equation of L(s;/). We put 
as in (4.3.12), 
A^(s;f) = 
{2n/^Mrr{s)L{s;f). 
Case (ii): Let ^, be 0 or 1 such that ;^,(—1) = (—1)*^% and A{s,x) be as in 
Corollary 3.3.2. Then 
(4.7.3) 
A(s, Xi)A{s - /c+1, Xi) = l^iM^lnr-^^^l^^l(s)-' 
Aj^(s-J\ 
fi(s) = 
otherwise. 
Therefore A^isif) 
is holomorphic on the whole 5-plane except for s = 0 and s = k, 
and has poles of orders at most 1 at s = 0 and s = /c. More precisely, A^isif) 
is 
holomorphic at s = 0, if either 
(a) k ^ 1 and Xi is a non-trivial character, 
or 
(b) k = 1 and both Xi and Xi are non-trivial. 
In other cases, A]^{s;f) has the residue — ao at s = 0, where 
(4.7.4) 
ao = 
L(l-Kx)/2. 
Case (i): Let 
A(s) = 
n-^''r{s/2)as) 

§4.7. Dirichlet L-Functions and Modular Forms 
177 
with the Riemann zeta-function f (s) as in Theorem 3.2.2. We have 
A(s)A(s - 1) = 4n{s - 1)-'(1 - M'-')-' 
M-"^ 
AM(s;f). 
Hence A^is;/) is holomorphic on the whole s-plane except for s = 0 and 5 = 2, and 
has simple poles at s = 0 and s = 2. The residue at s = 0 is given by —UQ, where 
(4.7.5) 
a o = - ( l - M K ( - l ) / 2 . 
Thus we have determined the expected constant term UQ of/(Z). 
Theorem 4.7.1. Let Xi (^^d ii ^^ Dirichlet characters modMi and modM2, 
respectively, satisfying (4.7.2). Put M = M1M2 and x = XiXi- Then for a positive 
integer k such that ;f( — 1) = (—1)*, there exists an element f(z) of%{M, x) such that 
L(s;f) = 
L{s,Xi)L(s-k+1x2)' 
Moreover if we write f(z) = X^^o ^n^^""*^» then 
0, 
ifk^l, 
and Xi Is non-trivial 
or if both X\ ^^d Xi ctr^ non-trivial, 
- 1 
an= < 
and 
(1 — M), ifk = 2, and both X\ cind Xi or^ trivial, 
-Bfcy/2/c, 
otherwise. 
0<d|n 
Proof Let a„ (n ^ 0) be as in the theorem. Then 
00 
L(s,Xi)L{s-k-\-l,X2)= 
Z ««"''• 
« = i 
We put 
(4.7.6) 
f{z)=f,(z;x,,X2)= 
la„e 2ninz 
n = 0 
By Lemma 4.3.3, f{z) satisfies (4.3.7). Using Weil's theorem (Theorem 4.3.15) we 
shall prove that/(z) is an element of ^^(M, x)- Let il/ be any primitive Dirichlet 
character whose conductor m is prime to M, and L(s;f, xj/) the Dirichlet series 
defined by (4.3.18). Then 
(4.7.7) 
L{s;f ^) = L(s, x,i^)L(s - /c + 1, Xa^A)-
First we consider case (ii) of (4.7.2). Putting S'i = S^.^ (i = 1, 2) (cf. (3.3.15) and 
Corollary 3.3.2), we see that 
(4.7.8) 
A(s, x,il^)A{s - fe + 1, X2«A) = 2 ^ \ — ^ \ 
fi(s)-'A^is;f 
xji). 

178 
4. Modular Groups and Modular Forms 
Where 
(4.7.9) 
/i(s) = 
Otherwise. 
g{z)==Cf(z;x2.Xi)^ 
(4.7.11) 
C = (-l)^ •• ^"^^^^""^(Mi/M^)^^"'^^^^ 
We put 
(4.7.10) 
where 
,, ^(Xi)^te) 
The functional equations of A{s, Xi^) and yl(s, X2'A) combined with (4.7.8) imply 
the functional equation 
(4.7.12) 
V1M(S;/, (A) = i'C^^Mik - s; g, H 
where 
PF(>A)^X(m)iA(M) 
, . ^ ^ W 
w = 
= x('w)iA(-M)—^. 
Therefore/(z)e^fc(M, x) by Theorem 4.3.15. Next we consider case (i). Then 
(4.7.13) 
A{s,il/)A(s-lil/) 
where 
(4.7.14) 
Ks)= i 
1 
if 
^ ( _ i ) = _ i ^ 
^ 
if 
i A ( - l ) = l . 
By the functional equation of A(s, ij/), we obtain the functional equation 
(4.7.15) 
^ ^ ( 5 ; / ^) = - C^A^(2 - s; - / , i/T). 
Thus/(z)e^2(M,z). 
D 
Hereafter we fix a positive integer k, and let^(z: Xi^Xi) be the modular form 
f(z) defined by (4.7.6). By Theorem 4.5.16, we note that 
(4.7.16) 
fkiziXi^Xi) is ^ common eigenfunction of^T{n)for all n'^ 1. 

§4.7. Dirichlet L-Functions and Modular Forms 
179 
For a Dirichlet character % ^^o^ ^ satisfying /( — 1) = (— If, we put 
(4.7.17) 
^,(iV,X) = <fk(lz;XuX2) I IM,M2\N, XiXi = X, and Xi and X2 satisfy 
(4.7.2)>. 
We note that ^^(iV, x) is stable by T(n) ((w, AT) = 1) and generated by common 
eigenfunctions of T{n) ((n, N) = 1) by (4.7.16). 
Theorem 4.7.2. ^,(iV, x) = ^/^(iV, z). 
Proo/ First we show that ^^(Ar, x) c= ^^(Ar, x). Let g{z)GS'k(N, x) be a common 
eigenfunction of all T{n) ((n, N) = 1) with eigenvalue t„. Since 
^k{N,x)-^kiN.x)@^kiN,x\ 
we can write 
9 = 01+92. 
(9ie6^,(N,xl 92^J^kiN.X))' 
By Corollary 2.8.4 and Theorem 4.5.18, ^^(Ar, x) and ./^^(Ar, x) are stable by T(n). 
Therefore g^ \ T(n)e6^k{N, x\ and hence, 
g^\T(n) = t,g,. 
Now there exists/(z) = ^(^J Zi»Z2) which has the same eigenvalues of T(n) as those 
for g(z) for all n prime to AT. On the other hand, by Corollary 4.6.14, there exist a 
divisor AT' of N and a primitive form h(z) of6^,^{N\ x) such that gi(z\ h{z) and g{z) 
have the same eigenvalues for T(n) ((n, AT) = 1). Therefore L(s;f) and L(s; h) has the 
same Euler factors for all prime numbers prime to AT. First assume that Xi is trivial. 
Then 
ris)Lis,Xi)L(s-k-\-lX2) 
has a simple pole at s = /c. Since h{z) is a cusp form, r(s)L{s; h) is an entire function. 
Put 
00 
L{s;h)^ 
X «««"'' 
n = 1 
then 
r{s)L(s, Xi)L(s - /c + 1, Z2) 
T-r 
1 - «pP"' + Z(P)P 
fc-l-2s 
= n 
r(s)L(s;h) 
i^'si^-Xi{p)p-')i^-X2iP)p'-'-r 
and it has a pole at s = /c. This is impossible from the form of the right-hand side. 
Next suppose that X2 is not trivial. Then by taking the twisted modular form g^^ in 
place of g, a similar argument is applicable. Consequently we obtain ^j = 0 or 
gEjVf,{N, x\ To prove that Sj,(N, x) = -^ki.^^ x\ we shall calculate the dimension 
of^,(iV,z). 
1° The case when either /c > 2 or /c = 2 and x is non-trivial. Let us show that 
f^(lz\ Xi> Z2)'s are linearly independent. Let 
Z c(lXi.X2)fkilz\XuX2) = ^. 
(c(/,Xi,Z2)eC). 
Here / runs over all positive integers such that IM\N, and X\ and X2 run over all 

180 
4. Modular Groups and Modular Forms 
Dirichlet characters such that X\li = X- Put 
00 
L(s, Xi)L(s -k-\-hx2)= 
Z a„{xuX2)n~"^ 
« = i 
Then a„(xi,X2) is the eigenvalue of T(n) fovfk(lz; Xi^Xi) provided n is prime to N. 
Moreover if «„(Zi, Z2) = ^n(^i^ ^2) for all n prime to N, then Xi = «Ai and X2 = ^2-
Therefore, for any fixed pair (/i, X2\ we see 
(4.7.18) 
Ic(/,Zi,Z2)/fefeZi,Z2) = 0. 
Since the first Fourier coefficient of^(z; %i, ;(2) is equal to 1, we get c(/, Zi» X2) = ^ 
for all /. This proves the hnear independence of^(/z; Xi, X2)- ^^ particular, 
dim ^fe(N, x) = #{(/, Zi, Z2)|/MiM2|Ar, Xi, Z2 are primitive and ;fi;f2 = x}-
The set of the right-hand side corresponds bijectively to the set of pairs (Xi, ^2) of 
(not necessarily primitive) Dirichlet characters 
{{x'uX2)\x\X2 = X. M\M'2 = N}, 
where x'l is defined modM;. The correspondence is given by 
(lXuX2)^{x'uX2l 
where 
X'l — the Dirichlet character defined mod IM^ induced by Xi^ 
X'2= the. Dirichlet character defined mod N/IM^ induced by X2' 
Thus we obtain 
dim^,{N,x)= 
^{(XuX2)\XiX2 = X, 
M.M^^N). 
2° The case when k = 2 and x is the trivial character. Then N > 1. By a similar 
argument as in l°,^(/z; Zi, Z2) are linearly independent, and 
dim^2(A^,z)= #{(Xi,Z2) I %iX2 = Z, M^M2 = N, and if X2 = X^ then 
M 2 ^ 1 } . 
3° The case when k=\A{^^ 
(AT, x) ¥^ {0}, then AT g 3 .and / ( - 1 ) = - 1 . Since 
/fcfe Xu X2) =fk{z\ lAi, »A2) if and only if {xu X2} = {^u ^2}^ we obtain 
dim^i(A^, X) = H {iXuX2)\XiX2 = X. M.M^ = AT} 
by a similar argument as in 1 °. 
Now we put 
(4.7.19) 
S,{r,(N)) = 
®S,{N,x\ 
where x runs over all Dirichlet characters mod N satisfying /( — 1) = ( — 1)*. Then 
by Theorem 2.1.7, 
^fc(A(iV))c:A(ri(N)). 

§4.7. Dirichlet L-Functions and Modular Forms 
From r, T and 3°, we see 
-J^(f>(M)(l>iN/M), 
if k^3, 
N^3, 
Nj^4, 
181 
dim^,(ri(iV)) = 
M\N 
~ Z! <t>{M)<t>{N/M) - 1, if A: = 2, A^ ^ 3, AT # 4, 
M\N 
-Y,<t>{M)(t>{N/M), 
if /: = 1, A^ ^ 3, iV 7^ 4, 
3 
if AT = 4, ife(even) ^ 4, 
2 
if AT = 4, A;(odd) ^ 3 or /: = 2; 
A^ = 2, fc(even) ^ 4, 
1 
if A^ = 4, ifc = l; A^ = 2, /: = 2; 
A^ = l, yfc(even)^4, 
0 
otherwise 
where 0 is the Euler function. Therefore by Theorem 2.1.7(1), Theorem 4.2.9 and 
Theorem 
2.5.2, dim S^(r^ (N)) = dim jr^(r^ (N)). 
This 
implies 
^^iri (N)) 
= jr^ir, (iV)), and therefore, ^^(iV, /) = ^^(iV, /). 
D 
Using expHcit Fourier expansions (4.7.1), we obtain the following estimate of 
Fourier coefficients of any element of ^^(N, x)-
Theorem 4.7.3. Letf(z) = i;r=o ««^^"'"^ ^^ «« element ofS^(N, x). Then 
0(n'-'l 
if /c>2, 
0(n'-'^% 
if 
/c=l,2, 
for any e > 0. 
Proof For an integer n, we put 
(4.7.20) 
If /c - 1 ^ 2, then 
0 < d | w 
SO that 
If /c = 2, then 
so that 
(T,_i(n) = n*-i 
X 
rfi-*<n*-H(/c-l), 
0 < d | « 
G^(n) = n Z 
^ ^ < " Z ' ^<w(l + logw), 
0 < d | f i 
' = 1 
GM-0(n'n 
for any £ > 0. Suppose /c = 1. Since (To(n) is equal to the number of all the positive 
divisors of n, we have 

182 
4. Modular Groups and Modular Forms 
for e > 0. Since 
aslogl ^ I'" S P''" 
for any positive integer a, we see 
(4.7.22) 
^
g
i 
+ A g i + 
' 
ge'"">^2 
p"^ 
p"^ 
£log2 
If p ^ 2^^ then ^' ^ 2, so that 
(4.7.23) 
^ 
< ^ 
< 1. 
V 
^ 
p«^ 
- 
2^^ 
~ 
By (4.7.22) or (4.7.23) according as Pj < 2^^^ or not, we see 
^
^ 
n 
^'/^'°^'^exp(2i/7elog2), 
SO that 
Go(n) = 0{n^). 
These results combined with (4.7.1) prove the assertion. 
D 
Let us consider the special case when N = 1 and Xi = Z2 = Zo (the principal 
character). Assume /c ^ 4. From the remark mentioned at the end of §4.1, we see 
Aiz; Xo. Xo) = cE,{z) 
(c = (k- 
l)\/2(2nin 
where £^(2) is the Eisenstein series defined by (4.1.3). Even if iV > 1, it is known that 
if /c ^ 3, then fki^lXi^Xi) 
can be expressed as a linear combination of series 
similarly defined as Ek(z). In the case when /c = 1 or 2, a modification is necessary. 
Eisenstein series will be explained in §7.1 and §7.2 again. 
§4.8. L-Functions of Quadratic Fields and Cusp Forms 
In the previous section, we showed that ^^(N, x) is generated by modular forms 
associated with products of two Dirichlet L-functions. It is natural to ask what 
kind of Dirichlet series are associated with cusp forms. If an L-function of a number 
field corresponds to a cusp form, then the field must be a quadratic field from the 
forms of the Euler products. Let X be a quadratic field, and ^ a Hecke character of 
K with My, v^ defined by (3.3.1). Assume that L{s — {k— l)/2, ^) corresponds to some 
cusp form. Then we see 
(i) K is imaginary, 
or 
(ii) K is real, and i;^ = 0 (v = 1, 2), M = MJ + M2 = 1, 
by comparing T-factors which appear in the functional equations in Theorem 3.3.1 
and Corollary 4.3.7. Here we use the same notation as in §3.3. Under the above 
situation, Hecke proved that L(s — (k— l)/2, i) corresponds to a cusp form by 

§4.8. L-Functions of Quadratic Fields and Cusp Forms 
183 
using theta functions which we shall discuss in the next section. We are, however, 
going to prove this again by Weil's theorem. 
Let K = Q(y/d) be a quadratic field with discriminant d, p a. prime number 
with (p, d) = 1, and ij/ a primitive Dirichlet character of conductor p. We denote by 
r and / the ring of integers and the group of fractional ideals of X, respectively. We 
define the Hecke character il/° N^by 
(4.8.1) 
{i^oN^)(a) = ik(NM) 
(ael), 
where Ng; is the norm mapping of/ into Q"". We note j/^ ° iV^^ is a primitive character 
of conductor px. 
Lemma 4.8.1. Let Xd = (~) ^^ ^^^ Kronecker symbol. 
\iJ\d\ 
ifd<0. 
(2) If(d,p)=lthen 
W(il/oN^) = 
xAp)^(\d\)Wiil/)\ 
Proof. We use the notation in Theorem 3.3.1. Since 
i:As) = 
as)L(saa\ 
we get 
T(X,) = 1 
by comparing the functional equations of both sides. Since ;ifd(— 1) = 1 or — 1 if K 
is real or imaginary, respectively, this imphes (1). Since 
L{s, lA ° A^x) = ^s, ^)L{s, il/Xdl 
we obtain 
This combined with Lemma 3.1.2 and (1) implies (2). 
D 
Theorem 4.8.2. Let K = 0 ( ^ 5 ) be an imaginary quadratic field with discriminant d, 
and ^ a Hecke character mod n such that 
iiia)) = (a/\a\r 
( a ^ l m o d n ) 
with a non-negative integer u. We put 
f[z) =f(z; ^) = X ^(a)iV^(a)"'^e2"«'^<°>^ 
a 
where a runs over all integral ideals of K. Then f(z) e ^„ +1 (AT, x) cind further 
/(r)e^„^i(JV,x), 
unless w = 0 and ^ is induced from a Dirichlet character through AT^. Here 
N = \d\Nfr(n), and x is a Dirichlet character defined by 
X (m) = Xrf(m)?((m))sgn(m)" 
(M e Z). 
Moreover if ^ is primitive, then f(z) is a primitive form. 

184 
4. Modular Groups and Modular Forms 
Proof. Let p be a prime ideal. If ^' is the character mod pn induced by i. Then 
Therefore we have only to prove the theorem for a primitive character i. By 
definition, L(s;f) = L(s - u/2, i). Let i/^ be a primitive Dirichlet character of prime 
conductor p. Suppose (p, N) = 1. Then since L(s;/, ij/) = L(s - M/2, ^(i/^ o Nj^)), we 
see from Theorem 3.3.1 and Lemma 4.8.1 that 
where 
A^(s'J, il/) = (p^N/2nYr(s)L(s 
- M/2, ^^ o N^)) 
-(PVN/2n)'i -^^^-^, 
xA{l-\-u/2-s,^(iiJoNf,)) 
x(p)^(iV)^W^^^^)^(_^)^W 
Therefore Theorem 4.3.15 implies that f{z)e%^-^{N, x\ and f(z) is a cusp form if 
M > 0, since L{s;f) is convergent for Re(s) > (M + 2)/2. Since L{s;f) has obviously 
the Euler product of the form in Theorem 4.5.16,/(z) is a common eigenfunction of 
all T{n). Assume that M = 0 and f(z) is not a cusp form. Since f{z) is a common 
eigenfunction of Hecke operators, 
L(s;f) = 
Lis,Xi)Lis,X2) 
with Dirichlet characters Xi^Xi t>y the proof of Theorem 4.7.2. But this can happen 
only when ^ is induced from a Dirichlet character. The last part of the assertion is 
obvious from Corollary 4.6.22. 
D 
For a real quadratic field K, a similar argument is apphcable and we obtain 
Theorem 4.8.3. Let K = Q{y/d) be a real quadratic field with discriminant d, and i a 
Hecke character mod n such that 
i{{a)) = a/\a\ = sgn(a) 
(a=lmodn), 
or 
^(a)) = a'l\a'\ = sgn{a') 
(a = 1 modn), 
where a' is the conjugate of a over Q. We put 
fiz)=fiz;i)=l^iia)e'-^^'^^-K 

§4.9. Theta Functions 
185 
where a runs over all integral ideals of K. Then 
where N = dNg^{n), and % is a Dirichlet character defined by 
x{m) = xAmKm) 
(meZ). 
Furthermore if ^ is primitive, then f{z) is a primitive form. 
Hereafter we assume that readers are familiar with Artin L-functions. Let us 
consider a special case when ^ in Theorem 4.8.2 and Theorem 4.8.3 is a class 
character. Then K is a real quadratic field or K is an imaginary quadratic field and 
^({a)) = 1 provided a= \ modn. Let J be the subgroup of / defined by 
J = {ae/|{(a)=l}. 
Let M be the abelian extension of K corresponding to J, and L the minimal Galois 
extension of Q containing M. Then 
G(L/K)/G(L/M) - G(M/K) - /(n)/J, 
where G(L/K) indicates the Galois group of an extension L/K, and 
/(n) = {a8/|(a,n) = l}. 
Therefore ^ induces a character ^ of G(L/K). Let p be a representation of G(L/Q) 
induced by <J. Then we have 
L (s, p) = L(s, 0, 
so that L(s, (J) is an Artin L-function over Q. In other words, such an Artin L-
function L(s, p) corresponds to a cusp form of weight L Therefore we may expect 
that there exists a correspondence between cusp forms of weight 1 and Artin L-
functions associated with irreducible representations of degree 2 of Galois groups 
over Q. Indeed, [Deligne-Serre] proved that cusp forms of weight 1 always 
correspond to such Artin L-functions. Conversely, it can be shown similarly to the 
above theorems that certain Artin L-functions satisfy functional equations of the 
type required in Weil's theorem. Therefore the above conjecture is equivalent to 
the Artin conjecture for such Artin L-functions. 
§4.9. Theta Functions 
In §2.6, §4.7 and §4.8, we constructed modular forms by using Poincare series or 
Dirichlet series. In this section, we give another way of constructing modular forms 
which is a generalization of the theta function defined by (3.2.16). The advantage of 
theta functions is that we can explicitly calculate Fourier coefficients of modular 
forms. Furthermore, theta functions play essential roles in the theory of quadratic 
forms. Throughout this section, we put 
e(z) = e 
Iniz 

186 
4. Modular Groups and Modular Forms 
Let /I be a symmetric matrix of size r over Z. Assume that A is positive definite, 
namely, all the eigenvalues of A are positive. We put 
A [x] = ^xAx 
for a column vector x of size r, and put formally 
f(z)= 
X e(Alm2z) 
(zeU). 
Hereafter we consider all elements of C, U\ Z** etc., as column vectors. For a non-
negative integer n, We put 
a{n,A)= 
#{m6Z''|^[m] = n). 
Then 
f(z) = f a{n, A)e^^'^\ 
n = 0 
We shall show that /(z) is convergent and is an integral form provided r is even. 
This gives an effective method of constructing integral forms. By this fact, we obtain 
an estimate of a{n. A) from that of Fourier coefficients of modular forms. The aim 
of this section is to prove that /(z), defined as above, is a modular form. We begin 
by defining theta functions from quadratic forms and studying the transformation 
formulae. The discussion below follows [Shimura 7]. 
We now define the differential operator A^ by 
^A= 
t 
b,jd'/dx,dxj, 
A-' = lb,jl 
Let P{x) be a homogeneous polynomial of degree v with complex coefficients in 
variables x^,. . ., x^. We call P(x) a spherical fiinction of degree v with respect to A if 
A^Pix) = 0. 
It is known that any spherical function of degree v is given by 
[ a constant 
(v = 0), 
P{x)=rqAx 
(qeC) 
(v = 1), 
( a linear combination of (^qAxY {qeC, X[^] = 0) (v > 1). 
We take an element /i e Z*" and a positive integer N satisfying 
(4.9.1) 
NA-^GM,(Z); 
(4.9.2) 
AheNr. 
For the above A, N, h, and a spherical function P(x) of degree v with respect to A, 
we put for z e H 
(4.9.3) 
e{z;KAN,P)= ^ 
^W^f^Sr^) 
m = hmodN 
\ ^^ 
/ 
meZ' 
= f,^a(n,h,A,N,P)e(:^z] 

§4.9. Theta Functions 
where 
a(n, K A, iV, P) = z 
A [m] = n 
m = h mod N 
187 
P(m). 
Since A is positive definite, there exist positive numbers c^ and Cj satisfying 
(4.9.4) 
c^'xx^A [x] S C2 'xx, 
/or all x e 1R^ 
Furthermore by Schwarz's inequahty, there exists.C3 > 0 such that 
(4.9.5) 
\P(x)\ S c^Cxxy/\ 
for all xeW. 
Therefore 
^ 
\P(m)\ = Oin^'-^'^^''). 
A [m] = n 
m = h mod N 
Hence by Lemma 4.3.3, 6(z; /i. A, AT, P) is convergent absolutely and uniformly on 
any compact subset of H and is holomorphic on H. We call it a theta function. We 
put 
D = det(^), /c = r/2 + v. 
Lemma 4.9.L (The transformation formula) 
e{- l/z; k A, N, P) = {-iyu-^^^i-izf 
^ 
e{HAh/N^)Oiz; /, A, N, P). 
Al = 0 mod N 
Proof This is a generalization of (3.2.17), and is also proved by using the Poisson 
summation formula. For xeW and zeH, we put 
(4.9.6) 
0(2, x) = Y. A 
^—- ^ 
and 
We denote by/(«) the Fourier transform of/(x). Then 
and by (4.9.4), we can apply the Poisson summation formula and obtain 
(4.9.7) 
e{z, x)= Y. /(m)e('mx) 
We have only to prove the assertion for P(x) = (^qAxyiqeC). 
Let 
q = \qi, ..... 
Qr) and define the differential operator L by 
^ = Z ^i^/^^i' 
i=l 

188 
4. Modular Groups and Modular Forms 
Acting U on both sides of (4.9.7), we see 
'A [m + x] 
(4.9.8) 
X P(m + x)ei 
2 
(_j-)v/)-i/2(^//)-r/2-v ^ {;qmye(-A-^lmyiz 
+ 'mx) 
= i-iYD-''\z/iy'' 
X P{A-'m)e{-A-^[rn\/2z 
+ 'mx). 
meZ' 
This is justified by the uniform convergence of 6(z; h. A, N, P) on any compact 
subset of H. Note that if v > 1, then 
L^Alx^='qAq 
= 0. 
Put X = N~^h, and take — 1/z in place of z. Then the left-hand side is nothing but 
N-^Oi-i/z; 
K A N, P). Put n = NA'^m. 
Then meT 
\i and only if «eZ'' and 
An = 0 mod N. Thus we see 
e(-\lz-KA,N,P) 
= ( - iyD-''\-izf 
X 
Pin)e((A lny2N^)z + 'nAh/N"^). 
An = 0 mod N 
neZ' 
Since e(nAh/N^) is determined by the class of n mod AT, we see 
= {-iyD-"\-izf 
X 
eClAh/N'') 
^ 
P(w)e((^M/2iV^)z) 
/!/ = 0 mod N 
n = l mod N 
/eZ'/iVZ^ 
= (_/)v/)-i/2(_^-2)fc 
Y 
e{'lAh/N^)e(z;lA,N,P). 
D 
^/ = OmodiV 
/eZVNZ' 
Hereafter we fix P{x) and write simply 9(z; h. A, N) in place of 6{z; h, A, N, P). 
The following equaHties are obvious by definition: 
(4.9.9) 
e(z;KA,N)= 
^ 
e(cz; g, cA, cN) 
g = h modiV 
geZ'/cNZ'' 
for any positive integer c; 
(4.9.10) 
d(z + 2; k A, N) = e(Alh']/N^)e(z; K A, N); 
(4.9.11) 
e(z; -h,A,N) 
= (- iye(z; K A, N). 
Now let ^ = 
, \eSL2(Z). Suppose that c > 0 and a = d = 0 mod2. Since 
cSz = a — (cz + d) ^ we obtain by applying (4.9.9), (4.9.10) and Lemma 4.9.1 
e(dz; K A, N) 
= (-iyD-''^c-''^-i{cz-hd)y 
X 
4>{k l)e(cz; /, cA, cN\ 
Al^O mod N 
ler/cNZ' 

§4.9. Theta Functions 
189 
where 
0(k /) = 
Z 
e(M[^] + TlAg + dAlQ)/2cN^). 
g = hmodN 
geZ'/cNZ' 
Since we can express it as 
<P(K I) = e(-b(dAlU + 2nAh)/2N^)0{h + dl, 0), 
it is determined by the class of / mod N. Therefore it follows from (4.9.9) that 
e{Sz; h, A, N) 
= ( - iyo-'^^'c-'-'H- i{cz + d)f 
X 
^(^' 0^(2; h ^ N). 
Al = 0 mod N 
ler/Nr 
Replacing z with — 1/z, and applying Lemma 4.9.1, we see that 
e('-^; 
h,A,N 
\dz — c 
= D-'c-^H-sgnidjiYidz-cf 
X 
nn, h)e(z; n, A, iV), 
An = 0 mod N 
neTINT 
where 
Al = OmodN 
leTjNT 
Here we understand sgn(f/) = 1 when rf = 0. In addition, assume that 
c/ = 0 mod 2N, Then since 
(4.9.12) 
^(/i, /) = e(- bnAh/N^)4>(k 0), 
we obtain 
(4.9.13) 
'P(n, h) = 0(/i, 0) 
X 
^C(« -bh)Al/N^) 
Al = OmodN 
_{0{kO)D 
if n = bhmodN, 
\ 
0 
otherwise. 
Therefore we see 
(4.9.14) 
o(^^; 
KA,N) 
= c-"^(-sgnid)iy(dz-cf0(K 
0)e(z; bh. A, N). 
Rewriting (4.'^. 14), we obtain that 
(4.9.15) 
ify = [l'^]ieSLAZ)) 
is a nu,tri. satisfying 
/? = 0mod2, c = 0mod2N, and d<0, 

190 
4. Modular Groups and Modular Forms 
then 
e{yz; K A, N) = M(y)icz + dfd(z; ah, A, N\ 
where 
(4.9.16) 
M(y) = M|-"^(-sgn(c)0' 
£ 
e(-M[g]/2M|N^). 
g = h modN 
geZ'IdNT 
Lemma 4.9.2. The notation being as above, we have 
M{y) = e(abAlh']/2N^) 
where 
mh--
_ f l 
if^=lmod4, 
** I i 
otherwise. 
Proof. Suppose c = 0. Then a — d — — 1, so that the assertion is obvious. Next 
assume c 7^ 0. We shall reduce the lemma to the case when —d'\s2i prime number. 
Assume that the assertion is true when —d'\s2i prime number. Take an integer n so 
that p = —d — Icn is a prime number, and put a(2/i) = 
. Since 
/^ X r^ b-\-2an~\ 
we see 
M(ya(2n)) = 
M{y)e(a^nA[h'\IN^) 
by (4.9.9) and (4.9.15). Since the assertion is true for yoi{2n) by assumption, we get 
M(y) = e(abAlh']l2N^)i^-\ 
( ^ j ^ 
The character (— | is defined mod 4N, since D is a divisor of N\ Therefore we 
have 
since d ^ —p mod 2c and c is divisible by 2N. Consequently the assertion is true 
for y. Now we shall prove the assertion when p = —d is a prime number. For 
geZ'' satisfying g = h mod N, we take ueZ" so that g = adh + Nu. Note that 
a^ = 1 mod N. Then the set of the classes of g mod pN corresponds to the set of the 
classes of u mod p, so that 
(4.9.17) 
M{y) = {-sgn(c)iye(abAlh-]/2N^)p-'-'^ 
X 
e(-bAlu^/2p). 
ueZ'/pZ' 

§4.9. Theta Functions 
191 
Since (p, 2D) = 1, there exists an element SeM^(Z) such that (det(S), p) = 1 and 
^SAS mod p is diagonal. Let fj, . . . , /^- be the diagonal components of^SAS and put 
b' = — b/2. Since it is easily verified by Lemma 3.LI that 
k"-"H'HQ) 
for a prime number p (p ^ 2, (p, a) = 1), it follows from Lemma 4.8.1(1) that 
p-'" 
X e{b'Alum = 
p-'"tl(teib'tJVp) 
ueZ'/pZ' 
i = l 
\ J = 1 
' P 
Since 2fe'c — ap = 1, we have 
'b 
P 
By taking 8pe-p = i into account 
:)=(7)=--(^> 
-.(T^)=---<~)'(^) 
-(sg„w,T.r(J)'0 
This completes the proof. 
D 
Theorem 4.9.3. Assume that A, h and N satisfy (4.9.1) and (4.9.2). Let P(x) fee a 
spherical function of degree v wit/i respect to A. Then for an element y = \ 
i \^f 
SL2(Z) satisfying 
b = 0mod2, 
c = 0mod2iV, 
we have 
e{yz; K A, iV, P) 
= e(abAm/2N')(^^) 
(^)^ricz 
+ dfe(z; ah, A, N, F), 
w/iere /c = r/2 + v, awf/ 
1 i/ ^ = lmod4, 
'^ 
' / 
if d = 3 mod 4. 
Proo/ If ^ < 0, then the assertion follows from (4.9.15) and Lemma 4.9.2. If d > 0, 
then we may consider — y in place of y. 
D 

192 
4. Modular Groups and Modular Forms 
If we impose some additional conditions on A, Theorem 4.9.3 can be refined as 
follows: 
1° Assume that all the diagonal cprnponents of A qr^even, then 
e(z + 1; h, A, N) = eiA[Ji]/2N^)e(z;h, A, N). 
Note that A [m] is even for any m e Z^ Therefore by using this equality in place of 
(4.9.10), 
the transformation formula of Theorem 4.9.3 holds for any element y of rQ(2N). 
2° Suppose that all the diagonal components of A and NA ~ ^ are even. Then 
(4.9.12) holds for any d such that d = 0 mod AT, so that 
the transformation formula of Theorem 4.9.3 holds for any element y of FQ^N). 
We consider the special cases when r is even or r = 1. 
Corollary 4.9.4. The notation being as in Theorem 4.9.3, if r is even, then 
e{2z;hA,N,P)e%{r,{4N)) 
with k = r/2 -\- v. Furthermore, ifv^l, 
then 0(2z* h, A,N, P) is a cusp form. 
Proof. The automorphy is straightforward from Theorem 4.9.3. Therefore we have 
only to verify the conditions at cusps. First consider the case when all the diagonal 
components of A are even. Let R be the space generated by 
{9(z;KA,N,P)\heZ'-/NZ'-}. 
Lemma 4.9.1 and the above remark 1° imply that R is stable under 
and 
ro - n 
[i 
oj' 
and therefore, under SL2(Z). Since any element of R is holomorphic 
(resp. has a zero if v ^ 1) at oo, and all cusps of r(N) are 5L2(Z)-equivalent to oo, 
any element of R is holomorphic (resp. has zeros if v ^ 1) at all cusps. The general 
case is reduced to the above case by (4.9.9) with c = 2. 
D 
Corollary 4.9.5. The notation being as in Corollary 4.9.4, let 
and put 
0(z;A,P)= 
S 
P(m)e(^z]. 
Then 
(l)e(2z;A,P)e%{4N,x); 
(2) If all the diagonal components of A are even, then 6(z; A, P)e%(2N, /); 
(3) // all the diagonal components of A and NA~^ are even, then 
e{z;A,P)E%iN,x)and 
(^z)-'ei- 
l/Nz; A, P) = ^ i ^ ' H - l M z ; A*, P*), 

§4.9. Theta Functions 
193 
where 
A* = NA-\ 
P*(x) = P{A-^x). 
Ifv^ 
1, then 9{z; A, P) k a cusp form. 
Proof. All the assertions follow from Theorem 4.9.3, the remarks mentioned after 
that, and Corollary 4.9.4 by taking /i = 0, except for the transformation formula in 
(3) which is obvious from (4.9.8). 
D 
As an application of theta functions to quadratic forms, we state the following 
Corollary 4.9.6. Assume that r is even. Then there exists a positive definite symmetric 
matrix A in M^iZ) satisfying the following conditions if and only ifr = 0 mod 8. 
(i) det(^) = 1; 
(ii) all the diagonal components of A and A ^ are even. 
Proof We use the same notation as in Corollary 4.9.5. First let us prove the only-if 
part. For P{x) = 1, we put 
and 
Since 
eiz; A) = e{z; A, P) 
e(z;A-') 
= 
e{z;A-\P). 
e(z;A) = 
eiz;A-'\ 
and e{z; A)e%(r(l)) 
by Corollary 4.9.5(3), we get 
z-'e(-\/z;A) 
= e(z;A\ 
so that comparing this with the transformation formula in Corollary 4.9.5(3), we 
obtain f^^ = 1, namely, r = 0 mod 8. Conversely, if r = 8, then 
2 1 
1 2 1 
1 4 3 
3 4 
5 
5 
20 
3 
3 
12 1 
1 4 
1 
(eMsiZ)) 
satisfies (i) and (ii) (Minkowski). Therefore r = 0 mod 8 is the sufficient 
condition. 
D 
If r is odd, then theta functions are not modular forms in the usual sense. We 
here state the explicit transformation formula only for the case when r = \. 

194 
4. Modular Groups and Modular Forms 
Corollary 4.9.7. Let ^ he a primitive Dirichlet character of conductor N, and v = 0, 
or 1 such that \l/{- 1) = (- \)\ Put 
e^{z)= 
X ^(m)mV 
v„2nim^z 
and 
\d J 
fory = \ 
, ero(4). Then 
(1) 
e^iyz) = tl^{d)(^\j(,y, 
zr^'e^iz) 
foranyy = \ 
^\ero(4N^); 
(2) 
{2Nz/ir^-"'e^{- 
l/4N'z) = (- iyN-'^'W{il,)e^(z). 
Proof. We get 
0^(z)= I 
il/(h)ei2Nz;KN,N,P) 
heZ/NZ 
with F(x) = x" by taking r = 1, A = AT, so that the first assertion follows from 
Theorem 4.9.3. The second one is easily verified by (4.9.7). 
D 
Taking the principal character as i// in Corollary 4.9.7, and writing 
0{z) = 0M 
we have 
e{yz) = J{y,z)e(z) 
(7ero(4)). 
In particular, 
(4.9.18) 
J(yS, z) = J(y, Sz)J(S, z] 
(7, SGro(4)). 
Let r be a Fuchsian group of the first kind, and J(y, z) a holomorphic function on 
H without zeros for yeP. If J(y, z) satisfies (4.9.18), then we call J(y, z) an 
automorphic factor of P. For an automorphic factor of P, we can define similarly 
automorphic forms as in the case j(y, z). Corollary 4.9.7 shows that 6^{z) is an 
automorphic form with respect to the automorphic factor il/{d)l—r- IJ(7, z)^""^^. 
Such automorphic forms are called modular forms of half-integral weight, and are as 
important as modular forms of integral weight. They are closely connected with 
modular forms of integral weight. See [Shimura 7], [Shintani] and [Waldspurger]. 
Furthermore we can obtain again the functional equations of Dirichlet L-functions 
mentioned in §3.3 from Corollary 4.9.7 and Theorem 4.3.5. Theorem 4.8.2 can be 
also proved from Theorem 4.9.3. 

Chapter 5. Unit Groups of Quaternion Algebras 
In the previous chapter, we studied modular groups and modular forms. The unit 
groups r of orders of indefinite quaternion algebras defined over Q are also 
Fuchsian groups and they are generalizations of modular groups. Automorphic 
forms for such groups F also play important roles in the algebraic geometrical 
theory of numbers. In this chapter, we recall fundamental properties of quaternion 
algebras, and study the structure of Hecke algebras of F. We quote some 
basic results on algebras and number theory from [Weil]. We follow [Eichler], 
[Shimizu 4] in §5.2, and [Shimura 3], [Shimizu 3] in §5.3, respectively. For a 
general reference, we mention also [Vigneras]. 
§5.1. Algebras over Q and Adelization 
We call a ring B with unity an algebra of dimension n over afield F, if the following 
three conditions are satisfied: 
1° F a B, and the unity of F coincides with the unity of B; 
T any element of F commutes all elements of B\ 
3° B is a vector space over F of dimension n. 
Let B be an algebra over F. We denote by dim^ B the dimension of B over F. 
We put 
Z{B) = {PEB\(xp = ^a for any 
aeB}, 
and call it the center of B. When F = Z(B), we call B a central algebra over F. For 
two algebras A, B over F, a ring homomorphism / : A-^ B is called an 
F-homomorphism (resp. F-isomorphism), if / is also a homomorphism (resp. iso-
morphism) as vector spaces over F. We denote by E(B) the set of all endo-
morphisms of B as a vector space over F. It is also an algebra over F. For an 
element a of B, we denote by /9(a) the homomorphism "Baj^i—•ajSefi". The 
mapping p of B into E{B) is an injective F-homomorphism. We call p the left 
regular representation of B. If p(a) is an automorphism of B, then there exists an 
element PeB such that p(a)()5) = aj5 = 1. Then p(j?) = p(a)"S and therefore, 
p(oi)p{P) = p{P)p{a)= 1. Since p is injective, we see that aj? = j?a = 1, or a is 
invertible. Conversely, if cceB'', then p(a) is obviously an automorphism of B. 
Therefore, for an element a of B, 
(5.1.1) 
a belongs to B"" if and only ifp (a) is an automorphism ofB as a vector space. 

196 
5. Unit Groups of Quaternion Algebras 
For each prime number p, we denote by Qp and Zp the field of p-adic numbers 
and the ring of p-adic integers, respectively. For a non-zero element a of Q^, we put 
ordp(a) = max{meZ|aep'"Zp}, 
and 
\ci\p^P~" 
{e = OTdpia)). 
We also put |0|p = 0. Moreover we put 
and for any element a^ of Q^, we denote by la^o l^^ the absolute value of a^ in the 
usual sense. Hereafter we call Qp and Q^ local fields, and denote by i; a prime 
number p or oo. We shall study algebras over local fields Q^. Let B be an 
n-dimensional algebra over Q„. Since B is isomorphic to the product Q" of Q^ as 
vector spaces over Q^, we can induce a topology on B under which B is homeo-
morphic to Q". This topology is independent of the isomorphism. Since Q^ is 
locally compact, so is B. Furthermore, since all the coordinates of the sum, the 
subtraction and the product of two elements a, p are polynomial functions of 
coordinates of a and j5, they are continuous with respect to the topology of B, and B 
is a topological ring. Since 
B^ ={aE5|det(p(a))7^0} 
by (5.1.1), JB "" is open in 5, and therefore, it is a locally compact topological group 
with respect to the topology induced from B. 
Let F = Q (resp. Qp), r = Z (resp. Z^), and B an algebra over F. A subset RoiB 
is called an order of B, if the following two conditions are satisfied: 
(i) R is a subring containing the unity of B; 
(ii) R is finitely generated over r, and contains a basis of B over F. 
By definition, orders of B are commensurable as submodules of B. An order of B is 
called maximal if it is maximal with respect to inclusion. 
Lemma 5.1.1. (1) Let B be an algebra over Q^, and R an order of B. Then R is 
compact and R^ is a compact subgroup of B^. 
(2) Let B be an algebra over Q, and R an order of B. We put 
Bp = 
B(E)QQp, 
and let Rp the closure of R in Bp for each prime number p. Then Rp is an order 
ofBp. 
Proof (1): Since R is finitely generated over Z^ and is a submodule of the vector 
space 5, there exist aj,. . ., a„6/? such that 
R = Zp<x,® •••eZpa„ 
by the elementary divisor theory, where n = dim^ B. Therefore R is homeo-
morphic to ZJ and is compact. By a similar argument as in (5.1.1) we obtain 
/?^={aeR|det(p(a))eZ;}, 

§5.1. Algebras over Q and Adelization 
197 
where p is the left regular representation of B, so that R"" is open and closed in R. 
Therefore R"" is compact. (2): A similar argument as above implies that there exists 
a basis of B such that 
R = Zoii® " -eZa^, 
so that 
Rp = Z^ai e • • • e Zpa„. 
Therefore Rp is finitely generated over Z^. It is obvious that Rp contains the unity of 
Bp and a basis oi Bp. 
D 
We denote by Q^ the adele ring ofQ. In other words, it is a locally compact 
topological ring defined by the following conditions: 
(i) as a set, 
QA = {(civ)^Yl'^vlcip^^p 
for almost all prime numbers p}; 
V 
(ii) the topology is defined by considering the subset U x Yip^p O/QA open in 
Q^, and the induced topology on U x YIP^P coincides with the product topology. 
Let Q^ be the set of all invertible elements of Q^. For a = (a„)eQ^, we put 
WA = YlMv 
V 
This is meaningful since \ap\p = 1 for almost all prime numbers p by (i). We consider 
Q as a subset of Q^ through the correspondence "Q9Xh-^(x„)GQ^" with x^ = x 
for all V. Then 
and 
\X\A = 1 
(xeQ^). 
Let a = (ay)eQ^. For each prime number p, put Cp = ordp(ap). Then 
apZp = 
p'''Zp. 
Since e^ = 0 for almost all p,m= 
Y[P P^^ ^^ meaningful and is a rational number. 
We define the fractional ideal of Q by 
id(a) = mZ, 
and call it the ideal associated with a. 
For an algebra B over Q of dimension n, we put 
(5.1.2) 
BA = 
B(S)QQA-
Since BA is isomorphic to the product Q^ as a Q^-module through the coordinates 
with respect to a basis of B, we can induce the topology on BA under which BA is 
homeomorphic to the product space Q^. This topology is uniquely determined and 
BA is a topological ring. Since Q^ is locally compact, so is 5^. Since Q^ is a subset 
of the product Hv^y* we can consider BA as a subset of the product Ylv^v through 
the natural embedding, where B^, = B®QQ„. 
Let R be an order of B, and Rp 

198 
5. Unit Groups of Quaternion Algebras 
the closure of R in Bp for each prime number p. Then we have 
(5.1.3) 
B^ = {(cc^)eY[Bv\(XpeRp for almost all prime numbers p}, 
V 
and the induced topology of B^ on the subset B^ x YlpRp coincides with the 
product topology. We call B^ the adelization of B. Next let B^ be the set of all 
invertible elements of B^, and induce on B^ the weakest topology under which the 
natural injection: B^ -^ B^ is continuous. Then B^ is a topological group. We call 
B^ the adelization of B"". As a. set, 
(5.1.4) 
B^ = {(a^)e]~Jfi„'' \oCpeRp for almost all prime numbers p}, 
V 
and the induced topology on the open subgroup B,^ x H P ^ P ofBJJ coincides with 
the product topology. When B = Q, B^ is nothing but Q^, which is called the 
idele group ofQ. 
§ 5.2. Quaternion Algebras 
Let B be an algebra over a field F. We call B simple if B is simple as a ring, namely, if 
B has no two-sided ideals except for {0} and B itself We call B a division algebra if 
any nonzero element of B is invertible. For an invertible element P of B, the 
correspondence: 
B3(x\-^Pap-^^B 
is an automorphism of B. Such an automorphism is called an inner automorphism 
ofB. 
Theorem 5.2.1. Let B be a central simple algebra over a field F, and Cj , Cj two 
simple subalgebras of B over F. Then any F-isomorphism of C^ onto C2 can be 
extended to an inner automorphism of B. In particular, any automorphism of B is 
derived from an inner automorphism of B. 
Proof Since left ideals of B are vector spaces over F, the descending chain 
condition holds on left ideals. Let M be a minimal left ideal of B. Then M is a simple 
B-module. Since B is simple, the action of B on M is faithful. Put 
D = End5(M), 
the ring of all endomorphisms of M as a B-module. Then D is a central simple 
algebra over F, and 
Endp(M) = B 
([Weil, IX, Prop. 2]). Now let/be an F-isomorphism of Cj onto C2. Since the 
actions of C^ and D on M are mutually commutative, M can be considered as a left 
Ci ®p-D-module. We denote by Mj the Cj 0^D-module M. Similarly, M can also 
be considered as a left C2 (x)^ £)-module, so that we can consider M as a left 

§5.2. Quaternion Algebras 
199 
Ci ®f D-module through the isomorphism / of Cj onto C2. We denote this 
Ci ®pD-modu\e M by M2. Let K be the center of C^. Then K is a field, and 
C,®PD 
= 
C,(S)K{K(S)FDI 
so that Ci ®f Z) is simple ([Weil, IX, Prop. 3-Cor. 1, Cor. 4]). Therefore both 
Ml and M2 are isomorphic to direct sums of copies of a unique simple 
Ci ®f D-module ([Weil, IX, Prop. 1]). By comparing the dimensions of Mj and M2 
over F, we see that Mj is isomorphic to Mj as C^ (x)^D-modules. We denote by (/> 
this isomorphism. Then, first 0 is an F-automorphism of M and is compatible with 
the action of D, so that (/) is an element of Endj){M). Since Endj){M) = B, there 
exists an element P of B"" such that 
(j){m) = Pm 
(meM). 
Next for any yeC^ and any ij/eD, we see 
</)((y (8) <A)m) = {y(S)il/)(p{m) 
{me Ml 
namely, 
i^yiAM = yil/iPm)=f{y)^{M =f(y)mm). 
Taking the identity mapping as J/^, we have Pym = f[y)pm for any meM. Since the 
action of 5 on M is faithful, we get Py = f{y)p, namely, 
for any y 6 C^. Therefore the inner automorphism g of B defined by g{(x) = j9aj5 
is 
an extension of / over B. This proves the first half of the assertion; the latter half is 
obvious. 
D 
A central simple algebra B of dimension 4 over a field F is called a quaternion 
algebra over F. Furthermore, if B is a division algebra, we call B a division 
quaternion algebra. 
Let B be a quaternion algebra over a field F. By Wedderburn's theorem ([Weil, 
IX, Th. 1 and Prop. 3-Cor. 1]), we see 
(5.2.1) 
B is not a division quaternion algebra if and only if B is isomorphic to 
M^iF). 
If F is algebraically closed, then M2(F) is a unique quaternion algebra over F 
up to isomorphisms ([Weil, IX, Prop. 3-Cor. 2]). 
Let K be any extension over F. Then B0pK 
is a. quaternion algebra over K 
([Weil, IX, Prop. 3-Cor. 1]). We say that B is ramified or splits over K if 5 ®f K is a 
division quaternion algebra or is isomorphic to M2(K), respectively. When B splits 
over K, we call K a splitting field ofB. The first assertion of the following lemma can 
be seen in [Weil, IX, Th. 3-Cor. 3]. 
Lemma 5.2.2. Let B be a quaternion algebra over a field F. 
(1) A separable extension K of degree 2 over F is a splitting field ofB if and only if 
B contains a subfield isomorphic to K. 

200 
5. Unit Groups of Quaternion Algebras 
(2) If two elements a, j5 ofB"" have the same minimal polynomials, then cc and P a
B"" -conjugate. 
(3) // an element a of B is not contained in F, then the set of the elements of B 
commutative with a coincides with F[a]. 
Proof (2): Let/(Jf)6F[X] be the minimal polynomial of both a and p. Then 
FM^Flxy{f{X))^FlPl 
First suppose/(A^) is irreducible. Then both F[a] and F[j5] are fields, so that 
the above isomorphism can be extended to an inner automorphism of B by 
Theorem 5.2.1. Therefore a and P are 5""-conjugate. Next assume that f{X) is 
reducible. Then F[a] ^ F[Jr]/(/(X)), and it is not a field, so that B ~ M2(F) by 
(5.2.1). We may assume B = M2(F). Since a and p have the same minimal 
polynomials, their Jordan's normal forms are the same, say y. Since eigenvalues of a 
and P belong to F, a and p are conjugate to y by elements of GLjiF). Since B"" 
= GL2(F\ d and P are 5"^-conjugate. (3): If F[a] is not a field, then B ~ M2{F\ 
Therefore by (2) we may assume that a is a Jordan's normal form. By a direct 
calculation, we obtain the result. Assume that F[a] is a field, and let P be an 
element of B commutative with a. Since F[a, j?] is an-algebra over F[a], we see 
dim^ F[a, J?] = 2 or 4. Since B is not commutative, F[a, j9] = F[a]. 
D 
Let B bea quaternion algebra over a field F, and F the algebraic closure of_F. 
Since 5 (g)p-F is a quaternion algebra over the algebraically closed field F, B (g)^ F is 
isomorphic to M2 (F). For an element P of 5, we put 
iV^(i5) = det(A 
tx^{P) = tAP\ 
where ^et(^) and tr(j5) are the determinant and the trace of p as an element of 
B®pF ^ M2(F), respectively. When B = M2{Fl NgiP) and tr^Cj^) are nothing but 
the determinant and the trace of j? as a matrix. We can prove that both NgiP) and 
tTeiP) belong to F ([Weil, IX, Prop. 6]). We call Ngip) and trgip) the (reduced) 
norm and the (reduced) trace of P, respectively. If F is an infinite field, then NB(P) 
is a polynomial function of the coordinates of P with respect to a fixed basis of B 
over F. 
When F = Q, iVg and tr^ induce mappings from B^ = B®QQ^ into Q^ for any y 
(= p or 00), which are nothing but N^^ and tr^^, respectively. We denote Ng^ and 
tr^^ simply by Ng and tr^, respectively, for simplicity. Moreover Ng and tr^ induce 
the continuous mappings of B^ into Q^, which we also denote by Ng and tr^, 
respectively. 
For an element p of B, we put 
f(X; P) = X'- tTs(P)X + NAP) 
(e F[X]), 
and call it the principal polynomial of p. By definition, 
f(P;P) = o, 
and a piF, then/(X; j?) is the minimal polynomial of P over F. If f(X; P) is 

§5.2. Quaternion Algebras 
201 
irreducible, then F[j5] is a quadratic extension over F, and the restrictions of tr^ 
and ATfi on F[j5] coincide with the trace and the norm of the field F^P'] over F. 
The proof of the following lemma on quaternion algebras over Qp can be seen 
in [Weil, XI, Th. 6, Prop. 5 and X, Th. 1, Prop. 6]. 
Lemma 5.2.3. (1) Let B be a division quaternion algebra over Qp. Put 
R = 
{PEB\Ns(P)eZp,tTs{P)eZp}, 
Then R is a unique maximal order ofB. Any left or right ideal ofR is always a two-
sided ideal. R has a unique maximal ideal m = Rn = nR {n e R). Moreover n^R = pR. 
(We call n a prime element of B.) 
(2) The ring M2(1p) is a maximal order of M2{Qp\ and any maximal order of 
MjCQp) is conjugate to M2(Zp). 
(3) Let Bbea quaternion algebra over Q^, and R a maximal order ofB. Then any 
left or right ideal of R is principal. Moreover, 
NB{B) = QP. 
and 
The following lemma is based on [Weil, XI, Prop. 4, Th. 1 and IV, Th. 4]. 
Lemma 5.2.4. Let B be a quaternion algebra over Q. 
(1) Let R be an order ofB. Then there exists a maximal order ofB containing R, 
and R is maximal if and only ifRp is maximal in Bpfor all prime numbers p, where Rp 
is the closure of R m fi^ = B ®Q Q^. 
(2) For almost all prime numbers p, Bp is isomorphic to M2(Qp), and Rp is 
maximal. 
(3) Suppose that for each prime number p, an order R'p ofBp is given. IfR'p = Rp 
for almost all prime numbers p with some ojder R ofB, then there exists an order S of 
B such that Rp = Spfor all prime numbers p. 
(4) IfR is an order ofB, then R = {B^x 
Y\pRp)nB. 
(5) Put 
B^}^^{PeB:i\\NBmA 
= lh 
If B is a division quaternion algebra, then B^\B^}^ is compact. 
Let B be a quaternion algebra over Q. We call B indefinite or definite according 
as B(g)QlR is isomorphic to MjCR) or is a division quaternion algebra. We are 
going to prove the approximation theorem. We begin with some lemmas. 
Lemma 5.2.5. Let B be a quaternion algebra over Q. Assume that a quadratic 
polynomial 
f{X)=-X^-{-aX-^beQlX^ 

202 
5. Unit Groups of Quaternion Algebras 
has no multiple roots. Then the following four statements are equivalent: 
(1) f(X) is the principal polynomial of some element of B; 
(2) B splits over the splitting field off(X) 
over Q; 
(3) B^ splits over the splitting field off(X) 
over Q^^for all v; 
(4) f(X) is the principal polynomial of some element of B^ for all v. 
Proof (1)=>(2): Let/(X) =f{X; P) for some peB. First suppose/(X) is irreduc-
ible over Q. Then O [ j5] is a quadratic extension of Q included in B, so that B spHts 
over Q[j?] by Lemma 5.2.2(1). Next assume that/(X) is reducible over Q. Since 
f(X) is a principal polynomial, we see B ~ MjiQ) from the proof of Lemma 5.2.2. 
This proves (2). (2) => (1): This is easily verified by Lemma 5.2.2(1). (2)o(3): This is 
nothing but the Hasse principle ([Weil, XI, Th. 2]). (3)o(4): This can be similarly 
proved as (l)o(2). 
D 
Lemma 5.2.6. Let Bbe a quaternion algebra over Qp, Ra maximal order ofB, and h 
a positive integer. Ifb e /^ satisfies b = 1 mod p^Zp, then there exists an element P of 
R satisfying the following three conditions: 
(i) N,(P) = b; 
(ii) p= Imodp^R; 
(iii) f{X; P) is irreducible over Qp. 
Proof. Any quadratic extension K of Qp is a splitting field of B by [Weil], XII, 
Th. 2-Cor. 2, so that we may assume that K is included in B. Take an unramified 
quadratic extension as K, and let r be the maximal order of K. If i?' is a maximal 
order of B including r, then R' is conjugate to R, so that we may assume xczR. If an 
element P of B does notbelongtoQp,then its minimal polynomial coincides with its 
principal polynomial, so that we have only to prove the existence of an element in 
r —Z satisfying (i) and (ii). We simply denote by N the Norm mapping NJ^/Q^. By 
induction we construct a sequence {a„}*=i of elements of r satisfying 
(1) a, = 1, (2) oc„ ^ a„_i modp^<"-^>r, (3) N(a„) 
^bmodp'"Zp. 
Assuming we have constructed {aj, . . ., a„}, we shall show the existence of a„ + j . 
Since K is unramified over Qp, we have 
trx/QpW = Zp, 
so that there exists an element y of r satisfying 
trK/Qp(7)= 1-
Put 
a„^i = a„(l +C7) 
(c = (b-N(oc„))/N(a„)). 
Since a„Gr"" by (1) and (2), we see 
c = Omodp*"Zp. 
Then 
a„ + i = a„modp'"'r. 

§5.2. Quaternion Algebras 
203 
and 
iV(a„^i) = iV(a„)iV(l+cy) 
^iV(aJ(l+c) 
= b 
mod/(" + ^>Zp. 
Therefore a„ + i is a desired one. Since {a„} is a Cauchy sequence by (2), it is 
convergent. So put 
a = lim a„. 
Then a satisfies (i) and (ii). If a ^ Z^, then j5 = a is what we want. Assume aeZp. Let 
{coi, CO2} be a basis of r over Z^, and (7 the generator of Gsi\{K/Qp). Put 
i/^ = lH-p''(niC0i+W2<^2) 
(^^i* " a ^ Z p ) . 
If we can take n^ and ^2 so that 
then p = (x(il/''/il/) is what we seek. Since N{^''l^)= 1, ^°l^sZp 
if and only if 
•A^'/'A = ± 1- Since {ft)i, 0)2} is a basis of X over Q^, we can find n^ and «2 so that 
This completes the proof. 
D 
An element j5 of a quaternion algebra B over a field F is called regular iff{X; p) 
has no multiple roots. 
Lemma 5.2.7. Let B be a quaternion algebra over Q^, R an order of B, and h a 
positive integer. For an element P of B satisfying NB(P)= 1, there exists a regular 
element a of B such that 
(i) iVfiCa) = 1, 
(ii) oi = P modp^R. 
Proof If P is regular, then the assertion is trivial. Assume p is not regular. First 
suppose B = M2(Qp). Then there exists an element y oi B"" such that 
•-[;:]• 
Taking a positive integer / so that 
pV"'M2(Z„)yc/i?, 
we put 
«=±^"{'7' (i-p')-> 
Then a satisfies (i) and (ii). Next assume that B is a division quaternion algebra. 
Then j5 = ± 1, so that the assertion follows from Lemma 5.2.6. 
D 

204 
5. Unit Groups of Quaternion Algebras 
Now let JB be a quaternion algebra over Q. We denote by Q^ the product of two 
copies of Q. For an element p of B, we put 
(5.2.2) 
4>(P) = 
(trB(PlN,(P))EQ\ 
The mapping (/) induces continuous mappings of B^ into Q^, and also of B^ into 
Q^, which are denoted by the same symbol <^, for simpHcity. 
Lemma 5.2.8. Let p be a regular element of Bp. Then we have: 
(1) any element sufficiently close to P is also regular; 
(2) 0 is an open mapping on a neighborhood of p. Namely, if V is an open 
neighborhood of p, then (/)(K) contains an open neighborhood of (f)(P). 
Proof (1): For an element (a, Z?) G Q^, we put 
g(X\a,b) = X^ + aX + b. 
The set of elements (a, b) such that g{X\a,b) = 0 has multiple roots is obviously 
closed. Therefore the continuity of 0 implies (1). (2): First suppose that/CX; j?) 
= X'^ + aX + b is irreducible. Take an element (a^,b^)EQl which is close to (a, b). 
It follows by [Weil, XI, Lemma 1] that if (fli, b^) is sufficiently close to (a, b\ then 
g(X;a^yb^) is also irreducible, and g{X\a^,b^) = 0 has a root a belonging 
to Qp\_P'] and also to V. Therefore 0(F) includes an open neighborhood of 
(t>{p) = (a, b). Next assume that f{X\ P) is reducible and put 
f{X;P) = {X-u)(X-v) 
{u^veQp). 
Since M 7^ t; by assumption, 5^ has a zero divisor, so that we may assume 
Bp — M2(Qp). A similar argument as in [Weil, XI, Lemma 1] implies that if (aj, b^) 
is sufficiently close to (a, b), then g{X;ai,bi) 
= 0 has two roots MJ, t?i in Op, which 
are close to M, V, respectively. In particular, Ui^v^. Therefore, taking yeBp so that 
and putting 
we get ae K and f(X; a) = g{X; a^, b^). This proves (2). 
D 
Theorem 5.2.9. Let B be an indefinite quaternion algebra over Q,Ra maximal order 
ofB, and N a positive integer. Assume that for each prime factor p ofN, an element Pp 
ofBp satisfying Ng(pp) = 1 is given. Then there exists an element p ofB satisfying the 
following three conditions: 
(i) NM 
= 1; 
(ii) p = P,modNR, 
ifp\N; 
(iii) peR, 
ifpJfN. 

§5.2. Quaternion Algebras 
205 
Proof. By Lemma 5.2.7, we may assume that 
(5.2.3) 
Pp is regular for each p. 
Let /c be a positive integer satisfying 
for all prime factors p of N, and {aj,. . ., e j a complete set of representatives of 
(K/iV*R)\ Note that 
iR/NRr^Y\{Rp/N'Rp)\ 
p\N 
since Z is dense in Ylp^p- We see that 
(5.2.4) 
(B^ X n Rp ) \ B A / ^ ' is a finite set. 
p 
In fact, if B is a division quaternion algebra, then it follows from Lemma 5.2.4(5), 
Otherwise it can be verified directly. Let {^^^\ . . ., i^^^} he 3, complete set of 
representatives of (B^ xY\pRp)\B^/B"". 
As is easily seen, we can take all 
^U) ^ (^(i)) so that i\/^ = 1 for all prime factors p of N. 
Now let L be a positive integer such that for all prime numbers p prime to L, 
(5.2.5) 
Bp^M^iQp), 
8,eR;(iSi^r\ 
^^J^ER; [l^j 
^s). 
Moreover take a positive integer h so that 
(5.2.6) 
L'ii'Jhr'r'Rpil/hr'^Rp 
for all i andy and all prime factors p of L. For each prime number p which divides L 
but is prime to iV, we can take an element Pp of Bp by Lemma 5.2.6 so that 
(5.2.7) 
NB(PP) = 1, Pp is regular, and Pp = 1 mod L^Rp. 
Hence a regular element Pp of Bp has been given for each prime factor p of LN. 
By Lemma 5.2.8(1), we can take a neighborhood Up of pp so that 
and all elements of Up 
(5.2.8) 
and put 
Up^pp-\-L'N'Rp 
are regular. Take (a. 
-Mi%, 
l)siQ^ so that 
{p\LN), 
g(X) = X^ 
-aX-^\. 
By assumption, g(X) is a principal polynomial of an element of Bp for all p. 
Furthermore since B is indefinite, g(X) is also a principal polynomial of an element 
of B^ (= M2(IR)). Therefore by Lemma 5.2.5, there exists an element a in 5 such 
thsit 
g(X)=f(X;oc). 
For each prime factor p of LN, there exists a^ e Up such that 
giX)=fiX;ap). 

206 
5. Unit Groups of Quaternion Algebras 
Since a^eBp and aeB"", there exists an element yp of Bp such that 
by Lemma 5.2.2. 
Let p be a prime number prime to LN. Since a e Z^, a is contained in a maximal 
order of Bp. Hence there exists an element jp of Bp such that 
ypay;^eRp, 
since all maximal orders of Bp are conjugate to each other. We may assume 
for almost all p, since a is contained in Rp for almost all p. We put 
y = (yv) 
with the yp defined above and 
700 = 1-
Then 7 s BJJ, so that we can write 
P 
with some ^^^\ By the choice of {ej, there exists e^ such that 
(5.2.9) 
rjpsr ^ e 1+ N^Rp 
for all prime factors p of iV. 
We put 
and shall prove that P satisfies the three conditions in the theorem, 
(i): Obviously NgiP) = 1. 
(ii): Suppose p\N. Since ^^/^ = 1, we have y^ = rjpS, so that 
P = irips;-')-Hyp(^y;'){ripsr') 
= ii1psr^)-^(xpirjpsr^). 
Therefore 
P-Pp = 
{riper')-'oCp(fjp8r')-Pp 
= 0 mod NRp 
by (5.2.9) and the choice of oCp and k. 
(iii): First assume p|L and pJi'N. Then 
i5 = (e,<5)a(8,^)-^ 
= e.O-H^/;'ap^p)^y^^r'. 
Since (XpEUp and rjpERp , we see 
oip = Pp= 1 mod L'Rp 

§5.2. Quaternion Algebras 
207 
and 
^p ^^p^p= 
1 mod 
L'^Rp. 
Since 
8,(i^jrHL'R,K'Jhr'czRp, 
we obtain PeRp. Next suppose pXLN. Then 
and ypCcy'^GRp by assumption. Since rjpERp by definition, and 8„ ^^J'^eRp by 
(5.2.6), we see that 
Therefore PeRp. This completes the proof. 
D 
Theorem 5.2.10. (Approximation Theorem) Let B be an indefinite quaternion 
algebra over Q, R a maximal order of B, n an integer, and N a positive integer. 
Assume that for each prime factor p of AT, an element Pp of Rp satisfies 
n/NsiPp)=imodNZp. 
Then there exists an element P of B satisfying 
(i) Nj,(P) = n, 
(ii) PeR, 
(iii) p = pp mod NRp for all prime factors p of N. 
Proof Since B is indefinite, there exists an element a of 5"" such that ^^(a) = w by 
[Weil, XI, Prop. 3]. Let L be the product of all prime numbers p such that a^Rp. 
For each prime factor p of LN, we take an element dp ofBp as follows. First suppose 
p\N. We can take an element y^ of Rp satisfying 7^—1 = 0 modiVR^ and Ng{yp) 
= n/NeiPp) by Lemma 5.2.6. Put 
Sp = oc-'ypPp 
ip\N). 
Note that NgiSp) = 1. Next assume p \ L and pjf N, We can take an element y^ of Rp 
satisfying Ngiyp) = nby Lemma 5.2.3(3). Put 
^ = oc-'yp 
(p|L,p^iV). 
Note that NgiSp) = 1. Take a power M of LN so that 
(5.2.10) 
ccMRpCi NRp for any prime factor p of LN. 
We note that NRp = RpifpJ^N. Applying Theorem 5.2.9 by taking M and dp for N 
and Pp, respectively, we get an element ^ of B so that 
(1) Nj,(S) = 1, 
(2) ifp\M, then S = dp mod MRp, 
(3) ifpJ(M, 
thenSeRp. 
We put 
P = oiS, 

208 
5. Unit Groups of Quaternion Algebras 
and are going to prove that p is what we want. It is obvious that N^(P) = n. If p|N, 
then we see 
P-Pp = oiS-p^ = oiS^-P^ = iy^-l)p^ 
= OmodNRp 
by (2) and (5.2.10). This impHes especially PeRp.Up\L 
and pj(N, then by (2) and 
(5.2.10), 
P-yp = ct3-yp = ocSp -yp = 0 modRp. 
Since ypERp, p belongs to Rp. Next suppose pJfLN. Then (xeRp and SeRp, so 
that PeRp. Therefore peRhy 
Lemma 5.2.4(4). 
D 
Theorem 5.2.11. Let B be an indefinite quaternion algebra over Q. If an order R ofB 
satisfies that 
N,(R;) = I; 
for all prime numbers p, then 
B^ 
=B^(GLi(U)xl\RpA. 
Proof Let j? = (j5^) be any element of B^ . We shall show that P belongs to the set 
of the right-hand side. We may assume that Pp e Rp for all prime numbers p by 
multiplying an integer, if necessary. Since 
NsiP) = nu 
(neZ,u 
= MeUl 
x 
Y\z;\ 
we can write 
For each prime number p, there exists an element yp of Rp satisfying Ngiyp) = Up 
by assumption. Put 
Lo u^j 
and y = {yJeB^. 
Then yeGL^(U) 
x UpRp 
and Ngiy) = u. Therefore we may 
assume NgiP) = nhy taking Py~^ in place of ft if necessary. Let RQ be a maximal 
order of B including R. For any prime number p such that pptRp 
or RQP i^ Rp, 
take a positive integer / so that 
P^p-p^R^p^pRp. 
Put N = W^ p^ with the above p and / Applying Theorem 5.2.10 for N, n and Pp, 
we obtain an element a of RQ satisfying 
N5(a) = n, 
oi = PpmodNRop 
if 
p\N. 
We have only to prove a"^j5eGLJ(R) x 11^/?/. It is obvious a"^)5^eGL2^(IR). If 
pJCN, then neZp 
by definition, and we see oc'^PeRp . Next assume p\N. Since 

§5.2. Quaternion Algebras 
209 
a-j5pep-^Rop, wesee 
so that P;^(xeRp. 
This impHes oc'^^eGmU) 
^UpRp 
. Since a 6 B ^ we see 
PeGLUmxUpRp' 
D 
We note that maximal orders and orders of Eichler type (for definition, see §5.3) 
of B satisfy the assumption of Theorem 5.2.11 by Lemma 5.2.3(3). 
Theorem 5.2.12. Let B be an indefinite quaternion algebra over Q. All maximal 
orders of B are conjugate. 
Proof. Let R and S be two maximal orders of B. For each prime number p, there 
exists an element Pp of Bp such that 
by Lemma 5.2.3(1), (2) and Lemma 5.2.4(1). Put P = (j5J with the above Pp and 
P^ = 1. Since PeB^.yNt can write P = OLU with OLEB'' and usG^iU) 
x flpRp 
by Theorem 5.2.11, so that 
Sp = ocRpa-'=^{(xRoc-% 
Therefore we obtain S = ccR(x~^ by Lemma 5.2.4(4). 
n 
Let B be an indefinite quaternion algebra over Q. We fix an isomorphism of 
B(X)QIR onto M2([R), and consider B as a subalgebra of M2(IR) through this 
isomorphism. Then the norm NgiP) of an element p oi B is nothing but the 
determinant of j? as a matrix, by definition. Let R be an order of B. We put 
(5.2.11) 
r^ = {PER\NM 
= 1} ^ GL^(UX 
and call it the unit group of norm 1 ofR. We are going to prove that T^ is a Fuchsian 
group of the first kind. 
Theorem 5.2.13. Let B be an indefinite quaternion algebra over Q, and R an order of 
B. Then FR is a Fuchsian group of the first kind. Moreover, ifB is a division quaternion 
algebra, then T^XH is compact. 
Proof First suppose B is a division quaternion algebra. Since H ^ 
SL2(U)/S02m) 
as topological spaces by Corollary 1.2.2, and S02(IR) is compact, the compactness 
of r ^ \ H is equivalent to that of FR\SL2iU). 
Since 
B^2'n(GL2{u) X n^;)=sL2im X n/^;, 
SL2{U) X YlpRp is open in B^^K Put 
W=Bll^-B^'(sL2(mxU^p)-

and 
210 
5. Unit Groups of Quaternion Algebras 
Since W is a union of right SL2(M) x f^^/^p-cosets, it is an open subset of B^^K 
Therefore B''\Wis 
open in B"" \B^}\ Since Wis left B"" -invariant, the complement 
of B^'XWis B'^XB'' '{SL2{U) xYlpRp). 
Then it is a closed subset of a compact 
set B"" \B^^\ so that it is compact. Since 
5^ n (sL2m X n ^ ; J\(sL2(m x n ^ ; ) = ^^ x^^ Y^L^W X n^, 
B-n(sL2{mxl\RA 
= rj, 
by Lemma 5.2.4(4), r^\(SL2(lR) x np^p"") i^ compact. Therefore r«\SL2(IR) is 
compact since rjj\SL2(IR) is the image of rjj\(5L2(IR) x H P ^ P " ) ^y ^^^ natural 
mapping. Next assume that B is not a division algebra. We may assume that 
B = M2(0) by (5.2.1). Let i^o be a maximal order of B including R. Since RQ is 
conjugate to M2(Z) by Theorem 5.2.12, i?o has an element of norm — 1, so that RQ 
is conjugate to M2(/) by an element of positive norm. Therefore we may assume 
r«, = 5L2(Z). 
Since R and RQ are commensurable as modules, there exists a positive integer N 
such that 
hence 
1 + AT/^o ^ ^ 
and 
5L2(Z) :3 r« 13 r(N). 
This implies that SL2{I-) and T^j are commensurable, and T^ is a Fuchsian group of 
the first kind. 
D 
§ 5.3. Hecke Algebras of Unit Groups of Quaternion Algebras 
In the previous section, we proved that any unit group T^j of norm 1 of an order R 
of an indefinite quaternion algebra B over Q is a Fuchsian group of the first kind. 
In this section, we study Hecke algebras of Tjj. 
Lemma 5.3.1. For a non-negative integer e, we put 
«-{[;;] 
eM2(ZJ a, b, c, de Z. 
Then Rp is an order of M2(Qp). Moreover if e^ 1, then we can write 
R, = <>nR«^> 

§5.3. Hecke Algebras of Unit Groups of Quaternion Algebras 
211 
with two maximal orders R^p^ and R^^^ o/M2(Qp). The pair (R^p^\ Rf^) is uniquely 
determined by Rp. 
Proof. It is obvious that Rp is an order and 
Let us study maximal orders including Rp. Any maximal order of MjCQp) is given 
by p-'M2(Zp)P 
(pEGL2(Qp)) by Lemma 5.2.3(2). Since 
M2(Qp) = Qp'M2{Zp\ 
we may assume j?GM2(Zp)n GL2(Qp). Furthermore for any yeGLiCZ^) 
{=M2iZpyi 
we have 
{yp)-'M2{Zp)yP 
= 
r'M2(Zp)P, 
so that the set of all maximal orders of M2(Qp) is given by 
{r'M2{Zp)P\peGL2(Zp)\{GL2{Qp)nM2(lp))}. 
Now we can take the set of matrices of the following two types as a complete set of 
representatives of GL2(Zp)\(GL2(Qp) n M2(Zp)): 
where / and g are non-negative integers, and u runs over the representatives of 
Zp/p^Zp. Since 
^^fa 
b~\ 
Va — cup'^ 
au — cu^p~^ + bp^ — du~\ 
L^ ^J L ^P~^ 
d-\-cup-f 
J 
for j? = 
"/ (/ = 1)' we see easily that 
^ U i^ " ^ Mj (Zp)p. Therefore any 
maximal order including Rp is given by 
In particular, a pair {R^p^\ R^p^) of maximal orders such that i?J,^^ n R^p^ = Rp is 
uniquely given by 
(M,(Z,), [f ?]"V,(Z,)[J^ J]). 
D 
Let B be an indefinite quaternion algebra over Q. We denote by de the square of 
the product of all prime numbers p such that Bp is a division quaternion algebra, 
and call it the discriminant ofB. We understand ds= 1 if B = M2(Q). Let iV be a 
positive integer prime to d^. We say that an order RoiBis ofEichler type of level N, 

212 
5. Unit Groups of Quaternion Algebras 
or simply of level N, if the following two conditions are satisfied: 
(i) ifpJfN, then Rp is a maximal order of Bp\ 
(ii) let N = Hp^ be the prime decomposition. Ifp\N, then Rp is conjugate to an 
order 
a 
bl 
fc 
d\ eMAZp) 
a, b,c, deZp 
Let B be an indefinite quaternion algebra over Q of discriminant dg, and R an 
order of level N. For each prime number p prime to dg, we fix an isomorphism of Bp 
onto M2{Qp) under which 
(5.3.1) 
R 
^ 
i\p 
^ 
MAI,) 
a 
fcl 
We define the subgroup (7^ of B^ by 
(5.3.2) 
lJj, = GLt{ 
a, b,c,dG Z 
UR; 
(pJfNds), 
ip\N). 
Let S be a maximal order of B including R. Then 
by Theorem 5.2.11, and 
^J,= t 7 « n B ^ 
rs=UsnB' 
Therefore 
and 
(UsnB^)Ui, 
= Us 
irs/r«i = ii/snB7c/«nBx I = ii/s/t/«i = n 1^;//?; 
p\N 
A similar (and easier) argument as in Theorem 4.2.5(2) implies 
\S;/R;\ 
= P^I + I/P). 
Thus we obtain the following lemma which is a generalization of Theorem 4.2.5(2). 
Lemma 5.3.2. Let B be an indefinite quaternion algebra over Q, and R an order of 
level N. If S is a maximal order of B including R, then 
[rs:r«] = Nn(i + i/p). 
p\N 
We define the subsemigroup DuOf B^ by 
(5.3.3) 
D„ = 
(GLi 
xY\D,)nB^, 

§5.3. Hecke Algebras of Unit Groups of Quaternion Algebras 
where 
213 
(P^N), 
{I" "c J l e « J « 6 2 ; . « ' i - P ' ' t c ^ o | 
(p|N). 
(5.3.4) 
D, = \ 
Moreover put 
(5.3.5) 
Then the following lemma can be proved by a similar argument as in Lemma 4.5.2 
for pJCdg, and directly by Lemma 5.2.3(1) for pldg-
Lemma 5.3.3. The notation being as above, we have 
Aj, = 
RnD^. 
D, 
U KKR. 
(pIN), 
(PMB), 
where %p(p\ds) is a prime element of Bp, and 
Lemma 5.3.4. (1) g^R^ g; ' ^ R ; for g^eB;; 
(2) 
gU^g-'^Uj^forgeB:^; 
(3) ar^a"^ ^ r^for (xeB''. 
Proof (1): Since Rp and gpRp gp ^ are open compact subgroups of Bp , we see 
gpR; g- ^^R;. 
(2): Let g = (g,)eB'^. Then 
gpR;g-p'=R; 
for almost all prime numbers p, and 
g^GLtmg-J 
= GLn^)-
This combined with (1) implies (2). (3): Since 
(2) implies that 
|(ar^a-Mr^)\r^| ^ |(a(/^a-M C/;,)\C/^| < (^ 
and 
Kar^a" 1 n rji)\ar^a- ^ | ^ KaC/^ja" ^ n [/«)\aUjja- M < oo. 
This proves (3). 
D 

214 
5. Unit Groups of Quaternion Algebras 
The above lemma enable us to define the Hecke algebras ^(r^, zl^j), 
^(i7ji, Djj), and ^(/?p , Dp). Now let / be a Dirichlet character modiV. Since 
P\N 
X induces a character of (Zp/NZpY 
which we denote by Xp. For an element 
^ = (^JofZ)ji, we put 
(5.3.6) 
m^mM.i 
(.. = [:; X]). 
Since 
we also denote the restriction of / on zljj or Fg^ by the same symbol %. Then % 
satisfies (2.8.1), and therefore, the Hecke algebra ^(r^, Ag) acts on ^ki^R, x)- ^^ 
particular, if 5 = M2(Q) and 
R = | p 
MeM2(Z) c = Omodivl 
then 
rg = r^(N\ 
Ag^A^(N\ 
and ^^(r^,/) = ^,(iV,x). 
Next we denote by (8)p^(Rp , Dp) the tensor product o{M(Rp ,Dp) taken over 
all prime numbers p. The relation between the Hecke algebra of T^ and local Hecke 
algebras is given by the following 
Theorem 5.3.5. (I) By the correspondence 'TgaFgh^ UgOcUg', 
M(rg,Ag):^g^(Ug,Dg) 
(2) By the correspondence ''U^gUg^0R;gpR; 
" 
{g = (g,)), 
p 
p 
Proof. (1): Since F^ and Ag are embedded in Bj[ by the canonical injection of R 
into B^, we have only to verify conditions (i), (ii), (iii) of Theorem 2.7.6(1). Let S be a 
maximal order of B including R. First we verify condition (i) or D^ = VRA^. Let 
fif = (^i;) t>e an element of D^, and n a positive integer such that 
n/NB(g)eZp 
for each prime number p. 
There exists an element hpOf Rp such that 
Ns(hp) = n/Ngigp); 
which is shown by Lemma 5.2.3(3) if pldg, and directly if pJi'dg. Put h^ = i and 
h = (h„). Then heUR.lfpisa 
prime factor of niV, then we take a positive integer / 
so that 
(5.3.7) 
P^SpihpgpY'^pRp. 

§5.3. Hecke Algebras of Unit Groups of Quaternion Algebras 
215 
Put M = YipP^' ^y applying Theorem 5.2.10 for M, w, hpQp, there exists an element 
PofS such that NB(^) = n and 
(5.3.8) 
P^h^gptnodMSp 
if p\M. 
If p IM, then by (5.3.7) and (5.3.8), 
PihpQpy '-1=(P- 
Kgp){hpgp)-'epRp, 
so that P(hpgp)- ^eRp. In particular, j5 6 D^. If p ^ M, then Sp = Rp, gpSRp , and 
PeSp, so that PeRp and h^^pY ^ e^p • Therefore fieRhy Lemma 5.2.4(4), so 
that PEAR and P{hg)~^eUR. Thus DR = f/n^n. 
Next let us prove (ii), or UR(XUR= Uj^oLFg^ for any ae J^f. It is sufficient to prove 
that aheUg^oLFn for any h = (h„)eUj^. For each prime number p prime to dg, there 
exist Sp^SpERp such that 
by Lemma 5.3.3. We put 
(5.3.9) 
w, 
1 
(t^=oo). 
and w = (Wy). Then we 1/^ and ae C/^aw. For a prime factor p of ^^(a) or a prime 
number p satisfying Sp=^ Rp, we take a positive integer / so that 
(5.3.10) 
pHciSp(Wphp)-^a-^) c pRp, and pf Sp C Rp. 
We put M = Tlp^ and apply Theorem 5.2.10 for M, 1, vv^/ip. Then there exists an 
element y in 5 such that Ngiy) = 1 and 
(5.3.11) 
y = WphpmodMSp 
if p\M. 
Since WphpERp and y — WphpEMSp c: R^, 7 belongs to R, and therefore, to Tjj. 
Now we define ZEB^ by 
ay = zoiwh. 
If p)( M, then obviously Zp e Rp. Otherwise we see by (5.3.10) and (5.3.11) 
Zp- 1 =(x{y(Wphp)-^ 
- l ) a - i 
= (x{y - y^php){Wphpy^oc- 
^EpRp. 
Therefore ZEUR 
and 
ccwh = z" ^ccyEURaFj^. 
This implies 
ochEllRixwh c 
UROLFR, 

216 
5. Unit Groups of Quaternion Algebras 
and (ii) is proved. The third condition that l/^anzlji = T^a for any aeJ^ is 
obviously satisfied. 
(2): This is obvious by the definition of adelization. 
D 
Theorem 5.3.6. For any prime number p, M{Rp,Dp)is commutative. Furthermore 
(1) 
ifp)(Nds.then 
and for any positive integers e and /, 
{e>\), 
(2) ifp\N, then 
^(R;,Z),) = Z[R;[J ^]K;]. 
and for any positive integer e, 
(3) (/pM«, then 
and for any positive integer e, 
R;KIR;=R;PR;, 
(R; K,R;)(R; 
< R ; ) = R; TT^ ' R; . 
Here 7tp 1*5 a prime element of Bp. 
Proof The assertions for each p prime to dg can be proved similarly to Theorem 
4.5.3(1) and Lemma 4.5.7, respectively. (Since Z- is a local ring, these cases are easier 

§5.3. Hecke Algebras of Unit Groups of Quaternion Algebras 
217 
than the previous ones.) Suppose pldg. Any element of ^{Rp , Dp) can be written as 
a hnear combination of Rp nlRp (0 ^ eeZ) by Lemma 5.3.3. Since 
R;KR; 
=R,K, 
we get 
{R;npR;)(R;n;R;) 
= 
R;ni^'R; 
by definition. In particular, ^(Rp , Dp) is commutative. Since 
p ' ^p 
>P 
R;nl = R;i>. 
we get 
R;niR; 
=R;PR;. 
D 
For a positive integer n, we define the element T(n) of ^{FR, AR) by 
(5.3.12) 
T{n)= 
X 
rj^ar^, 
Nsia) = n 
where the summation is taken over all double cosets FROLFR with Ngioi) = n. 
Moreover for a positive integer n prime to iV, we put 
(5.3.13) 
T(n,n) = FRnFR. 
We consider ^(Rp ,Dp) as a. subring of (S)p^iRp ^ Dp) by the natural injection. 
Then by the isomorphism of ^{Fj^, Aj^) onto (S)p^iRp ,,Dp) in Theorem 5.3.5, 
we have the following conditions: 
1° iffJi^Ndg, then T{p^) and T(p,p) correspond to 
and 
respectively; 
T ifp\N, then T(p^) corresponds to R ; \ 
iWp \ 
3° (f PMB, then T(p^) corresponds to Rp n\,Rp . 
Consequently we obtain the following 
Corollary 5.3.7. ^(T^, J^) is commutative, and 
mrR.A^) 
= ZlT(pl 
T(p,p\ 
T(q)\pJ^Nds,q\Nds:i 
Moreover we have: 
(1) if(n,m) = 1, then T(n)T(m) = r(nm); 
(2) 
n p ) r ( p ) = | j , ^ p . , , ^ 
(pl^^^j_ 

218 
5. Unit Groups of Quaternion Algebras 
Similarly to the case of modular groups, we define a formal Dirichlet series with 
coefficients in ^{rj^,Aj^)by 
(5.3.14) 
D(s)= f 
Tin)n-^. 
n= 1 
Then Corollary 5.3.7 is equivalent to the formal Euler product: 
(5.3.15) 
D(s)= 
n 
{l-T{p)p-^ 
+ 
pT{p,p)p-'T' 
X n 
(i-r(p)p-^)-i. 
p\Nds 
Now let a be an element of B"", If B^ is isomorphic to M2(Qy), then 
det(a)a~^ = NBioL)oc~ ^ 
under the natural embedding of B into 5^, so that det(a)a" Ms independent of the 
choice of v. Therefore by a similar argument as in Theorem 4.5.4, we obtain 
Theorem 5.3.8. (1) If(n, N) — 1, then the Heche operators T{n) and x(n)T(n) on 
^ki^R^X) ^^^ adjoint operators with respect to the Petersson inner product. 
(2) ^k(^R,x) 
has a basis consisting of common eigenfunctions of T{n) 
((n,iV)=l). 
Here x is a Dirichlet character mod N. 

Chapter 6. Traces of Hecke Operators 
The Fourier coefficients of Eisenstein series are quite simple, since they are derived 
from Dirichlet L-functions. To the contrary, the Fourier coefficients of cusp forms, 
or equivalently the eigen values of Hecke operators are quite mysterious and play 
important roles in applications of modular forms to number theory (for example, 
see [Shimura 4] and [Shimura 6]). To obtain eigen values of Hecke operators T(n) 
operating on S^^i^, x\ we have only to calculate the traces tr(r(m)) of T(m) on 
5^fc(iV, x) for finitely many m's (see the end of this chapter). 
In this chapter, we calculate them by the method of Selberg. We refer 
[Godement] for §6.1 through §6.3, [Shimizu 2] for §6.4, and [Hijikata] for §6.5 
through §6.8. 
§6.1. Spaces of Functions on H 
Let /c be a non-negative number. Let p be either a real number such that 1 ^ p or 
00. We call such p an exponent. For a complex valued function/(z) on H, we put 
U\f{z)lm(zfi^\^dv(z)[ 
(l^/7<a)), 
ess. sup |/(z) Im {zf^^ \ 
{p = oo). 
zeH 
Here || /1| oo = 'w implies that the set {z e H | |/(z)| Im {zf^ > m} has measure 0 and 
the set {zeH| |/(z)|Im(z)*/^ > m —8} has non-zero measure for any positive 
number s. We denote by LJ(H) the space of all measurable functions / on H 
satisfying |1/|| p < oo. In particular, Lg(H) is the L^-space of functions on H in the 
usual sense. Hence it is a Banach space. Since LJ(H) is isomorphic to Lg(H) as 
normed spaces by the map y(z) i->/(z)Im(z)''^^", LJ(H) is also a Banach space for 
any k. We call two exponents p and q are conjugate, if they satisfy that 
P 
q 
Here we understand l/p = 0 if p = oo. If p and q are conjugate exponents, we put 

220 
6. Traces of Hecke Operators 
for/eLJ(H)and^eLl(H), 
(6.1.1) 
(/, ^)H = J / ( z ) ^ lm{zfdv{z). 
H 
By this pairing, an element g of LJ(H) can be identified with an element of the dual 
space of LJ(H), or the space of all continuous Hnear functional of LJ(H). Further if 
p 7^ 00, Ll(H) is considered as the dual space of LJ(H) by this identification. 
Further L^(H) is a Hilbert space with the inner product given by (6.1.1). We also 
denote by //f (H) the subspace consisting of holomorphic functions in Z/J(H). 
Theorem 6.1.1. The space HJ(H) is a closed subspace o/LJ(H). 
Proof. Let f{z) be the limit of a sequence {/„(z)} in HJ(H). Applying 
Corollary 2.6.4, we see that f(z) is also holomorphic. 
D 
Let H be a Hilbert space consisting of complex valued functions on a set X. We 
denote by (/, g) (fgeH) 
the inner product of H. We call a function K{x, y) on 
X X X a. kernel function of H if it satisfies the following two conditions: 
(6.1.2) 
as a function ofx, K(x, y) belongs to H for each fixed y; 
(6.1.3) 
for any element f{x) of H, 
f(y) = {f{xlK(x,y)) 
(yeX), 
where the right-hand side is the inner product as functions ofx. 
If K(x, y) is a kernel function, then we see easily 
(6.1.4) 
K(x,y) = K(y,x). 
Kernel functions do not necessarily exist. However, if it exists, it is uniquely 
determined. Furthermore, if H is finite dimensional, then it has the kernel function 
given by 
K{x,y)= 
tfAx)fJj), 
ix,yeX% 
v = 1 
where {/j,. . . ,/d} is an orthonormal basis of H. 
Now we shall show the existence of the kernel function of H^ (H) and calculate 
the expHcit form. By Corollary 2.6.2, there exists a constant C depending only on 
z 6 H and k such that 
|/(z)|^C||/||2 
ifeHKH)). 
Therefore, for each fixed ZQEH, the map "/i—•/(ZQ)" is a continuous linear 
functional of H 1(H), Since Hl{H) is a Hilbert space, there exists a unique element 
^^0 6/f^(H) satisfying 
/ ( 2 O ) = 
( / ^ 2 O ) H -
Put Xfc(zi, Z2) = ^22(^1) ^^^ Zi, Z2eH. Then it is the kernel function of Hl(H) and 
/(z) = J K,(z, Z2)fiz2)lm{z2fdv(z2) 
for any/e/f2(H). 
H 

§6.1. Spaces of Functions on H 
221 
Let a be an element of SL2(^y For any feHl{ll), 
the function f{oLz)j(oi,z)~^ 
belongs to H^(H). Since the measure dv{z) of H is invariant under the action of 
SL2(Ul we see for any/eiff (H) 
JXfc(azi,az2)7(a,Zi) ''j{oc,Z2) ^f(z2)lm(z2fdv(z2) 
= ;(a,zi) * JiCfc(azi,Z2)/(a ^Z2);(a,a ^Z2)*Im(z2)*t/r(z2) 
H 
= ;(a,Zi)-'/(zi);(«,Zi)''=/(zi)-
By the uniqueness of the kernel function, we have 
(6.1.5) 
K^iazi, az^) = K»(zi, Z2);(a, z.fjia, z^)' 
(a6SL2(R)), 
and 
(6.1.6) Kt(az„z,);(a,Zi)-* = A:»(z.,a-'z2);(a-',Z2)-'' 
(aeSL,(R)). 
ing[J J](fc 
In particular, taking 
(fe e IR) as a, we see 
(6.1.7) 
X,(zi + 6, Z2 + fe) = X,(zi, Z2) 
(beU). 
We put 
M = {(zi, Z2)eC^ I Zi eH, zi - Z2 eH}, 
and 
/l(Zi,Z2) = Kfc(Zi,Zi-Z2) 
((Zi,Z2)eM). 
Then /i(zi, Z2) is a holomorphic function on M. Since /i(zi + b, Z2) = /i(zi, Z2) for 
any foeIR, /i(zi, Z2) is independent of z^. For zeH, take z^eH so that {Z]^,z)eM 
and put 
Pf,{z) = h{z^, z) = Kf,{zi,zi - z). 
Then P^iz) is a holomorphic function on H and 
KkizuZ2)=^Pk{zi-Z2) 
(zi,Z2eH). 
Take \^ 
_A (aelR^) for a in (6.1.5), then we have Pk(a^z) = a'^'^Pkiz). In 
particular, 
Pkiiy) = y"'n(0 
(3^ > 0). 
Since P^iz) is holomorphic on H, we see that 
Pt(z) = c,(z/2i)-' 
with a constant c^. Thus we obtain the following 

222 
6. Traces of Hecke Operators 
Theorem 6.1.2. The Hilbert space ^^(H) has the kernel function 
with a constant c^. 
Corollary 6.L3. H|(H) c= H^CH). 
Proof. Let f{z) be an element in i4^(H). For any point ZQ^H, we see that 
l/(^o)l' = |(/(Z),K,(Z,ZO))HP ^ ll/lli- l|X.(z,Zo)||i 
= ||/||iX,(zo,Zo)=c,Im(zo)-Ml/lll 
This implies |/(zo)Im(zo)*^^| ^ ^Jc^ WfWi for any ZQEH, and therefore/belongs 
toH^(H). 
D 
Let us calculate the constant c^ in Theorem 6.12. We denote by R+ and (R_ the 
set of all positive real numbers and the set of negative real numbers, respectively. 
For an element /(z) in //^(H) and a point 3;6 IR+, we put 
fy(x)^f{x 
+ iy) 
(xeU). 
Since || / 1 | i = JH | / ( X + iy)\^y^~^ dxdy is finite, there exists a subset Sf of measure 
zero in IR+ such that/yGL^(IR) iiy^Sf. 
Denote by^(M) the Fourier transform oify 
for yiSf, 
or ^(M) = l.i.m.„^Qo J"_„^(x)e"^"*"''i/x, where l.i.m. implies the limit 
in L^{U). 
Theorem 6.L4. (1) For a function f{z)eHl{H% 
there exists a function f(u) on U 
satisfying 
and f(u) vanishes almost everywhere onU-. 
(2) Ifk^hthenHl(Yi) 
= {Q}. 
Proof. For any positive integer n, we put 
/ ^ ^ ( M ) = J / ( x + i»e-2"'"^^-''»Jx = e2""^ ] 
fy{x)e-^'''"''dx. 
— n 
—n 
Since^(w) = Li.m.^ „(M)e"^""^ for y^Sy, there exists a subset Ty of U of measure zero 
such that lim„^oo/y „(M) exists if M^ T^. Let y^ and ^2 t>e two positive numbers such 
that ^1,^2^^/ ^^^ yi <y2' Take M€ IR so that M^ 7^^ u Ty^. Since/eHfe(H), we see 
by Corollary 2.6.3. that lim,^, ^.^ \f{x + iy)e-2«i«(*+t3')| = Q uniformly on the inter-
val [3^1 > ^i]- Since /(z)e"^"*"^ is holomorphic on H, we have 
{
n + iyi 
n + iy2 
—n + iy2 
- n + iyi 'J 
I 
+ J + 
J + 
J 
^/(z)e-2"'"^^z = 0. 
Therefore 
lim„^^/y^,„(M) = l i m „ _ ^ ^ „l(w). This implies 
lim„^^^„(M) 
is 
independent of y. If we put/(M) = lim„_ ^ ^ „(«) then it satisfies the equation in (1). 

§6.1. Spaces of Functions on H 
223 
Now we see that 
(6.1.8) ^>\\f\\l = ]y'-'dy 
] \f,(x)\Ux = ] y'-'dy J I/MI^^-^-MM 
0 
~ 00 
0 
""00 
- 
00 
0 
The integral with respect to y is finite if and only if /c > ^ and M > 0. Then, if /c > 1, 
f(u) vanishes almost everywhere on [R_. If /c ^ 1, f(u) should vanish almost 
everywhere on R, and therefore f(z) = 0. This completes the proof. 
D 
For /(z)eiffc(H), we call the function f(u) on U the Fourier transform of/ 
Hereafter we assume /c> 1. We put 
G,(u) = j I y'~'^~^"'dy 
= {nu)'-'r{k-l) 
(u > 0), 
We denote by H^ the space of complex valued measurable functions (/)(M) on U 
satisfying the following two conditions: 
(6.1.9) 
</)(w) = 0 almost everywhere on U_; 
(6.1.10) 
J \(l)(u)\^G,,i4u)du < 00. 
- 
00 
The space H^ is a Hilbert space with the inner product 
<(/), (p} = j (t>iu)(p(u)G,(4u)du 
(^,q>eHi). 
0 
By (6.1.8), we obtain 
(6.1.11) 
||/||2= J \f(u)\'G,(4u)du = ifjy 
ifeHiiU)). 
— 00 
Therefore, if feH^iH), then/eH^. Conversely, let 0 be an element of H^. For 
zeH and a positive integer n, we put 
(6.1.12) 
(^(z)= J (/>(M)e2"'""dM, (^„(z)= J (l)(u)e^'''"'du. 
We shall prove that the map "/(z) ^-^f(uf' gives an isomorphism of /f|t^(H) onto 
Hj^. We need the following general 
Lemma 6.1.5. Let (X, dx) be a measure space and D a domain in C. Letf{z, x) he a 
function on D x X holomorphic in z for each fixed x. Assume that for any circle C 
contained in D,f(z, x) is integrahle onC x X. Then the function F (z) = J;^/(z, x) dx is 
holomorphic on D. 

224 
6. Traces of Hecke Operators 
Proof. Let z be a point of D, and C a circle around z. Then 
Therefore 
1 ./(C, x) 
/(Z,X) = —TJ-T^ 
C 
Thus F{z) is holomorphic on D. 
D 
Theorem 6.1.6. The correspondence 'J(z)\-^f(uy' gives an isomorphism of H^iH) 
onto Hi. 
Proof. We have only to show that the map "(/) i—• 0" is an isomorphism of Hi into 
/ffc (H) and it is the inverse of *y(z) !—•/(«)". Let </)„(z) be the function given by 
(6.1.12). By Lemma 6.1.5, it is holomorphic on H. Let us prove that {0„(z)} 
converges to </)(z) uniformly on any compact subset of H. By definition, we obtain 
I + 1 )\<l>(u)e'"-^du= I mu)e'"-'\du. 
— CO 
n / 
n 
By Schwarz's inequality, 
foo 
) 1/2 
(-00 
-)^I2 
S I J murG,(4u)du[ 
• I J 
\G,i4uy"'e'^n'du^ 
The first term is independent of z, and converges to 0 if n tends to oo. The second 
term is bounded on any compact subset of H. In fact, 
/c-1 
j \Gk{4u)-^'^e^'''"'\^du S J Gfc*(4M)"'e"^""^^M = 
4ny^ 
which is bounded on any compact subset of H. This implies the uniform con-
vergence of {<^„(z)} on any compact subset of H, and therefore (/>(z) is holomorphic. 
Moreover we obtain 
H\\l=imz)\Hm(zfdviz)=]y'-'dy 
J mx-^iy)\'dx. 
H 
0
-
0
0 
Since </)(x + iy) is the Fourier inverse transform of 0(M)e~^'"'^ considering it as a 
function of x for each fixed y, the Plancherel theorem implies 
= ]y'-'dy 
I \cl>(ure-^^"ydu = ] \cl>(u)\'G,(4u)du = ((l>,cl>}. 
0 
- 0 0 
0 
This implies "0 H-^ (/>" is an isomorphism of H^ into HKH). It is easy to see that 
these two isomorphisms are inverse to each other. 
D 
Corollary 6.1.7. Hl(l{) ^ {0} if and only 
ifk>\. 
Proof It is obvious that if/c > 1 then Hi ^ {0}. Then by Theorem 6.1.6, we obtain 
the result. 
D 

§6.2. 
The Projection of L^H) onto //j^(H) 
225 
Now we are ready to calculate the constant c^ in Theorem 6.1.2. We denote by 
Kfc(M, z) the Fourier transform of K^iz^^z) considering it as a function of Zj for a 
fixed z. Then for any 4){u)eHl, we see that 
<(^(M), K,{U, Z)> = (<^(zi), K,(zi, Z))H = <^(z) = J (l>iu)e'^'"^du. 
0 
On the other hand, we have 
< ct>(ul K,(M, z)> = J </>(«)X,(M, z) G,(4t/) JM. 
0 
Therefore we obtain 
Xfc(M,z) = Gfc(4M)-1 e-2"'""" ((M,Z)GUX 
H). 
Take the inverse transform of Kf^(u, z) as a function of M, and we get 
0 
namely, Cfe(z/20"* = J^ Gk(4uy^e^'''"^du. Putting z = 2i, we obtain 
c, = ,(/c-l)/47r. 
Thus we obtain the following 
Theorem 6.1.8. Ifk> 
1, then the kernel function of H^{H) is given by 
K * ( Z l , Z 2 ) = ^ ( ^ ^ ^ l 
(Zl,Z,6H). 
§6.2. 
The Projection of L/fCH) onto Hjf(H) 
Using the kernel function /Cj(zi, Zj) of Hj(H), we define the integral operator K on 
LAH) by 
(6.2.1) 
(X/)(z) = J Kt(z, Z2)/(z,)Im(z3)'<i(;(z,), 
/eL«H). 
H 
The purpose of this section is to prove that the integral operator K is a projection 
of Ljf(K) onto its subspace H^{ll) for all /? (1 ^ p ^ 00). Hereafter we assume k> 2. 
For this purpose, we had better to consider function spaces Ljf(K) and Hjf(K) 
consisting of functions on K. We denote by dv^(w) the measure of K defined in §1.4 
given by 
dv^iw) = 4(1 - \w\^)~^dxdy 
(w = x + iy). 
For a complex valued measurable function f(w) on K, we put 
\ i / p 
J i/(w)(i - M^r^i^dv^iw)] 
(1 ^ p < o)), 
ess. sup |/(w)(l - |w|2)*/2| 
(p = 00). 
weK 

226 
6. Traces of Hecke Operators 
We denote by Ljf(K) the space consisting of measurable functions / satisfying 
ll/llp < 00. We also denote by //jf(K) the subspace of L^{K) consisting of holo-
morphic elements. Then mK) is a Banach space and if jf(K) is a closed subspace of 
Ljf(K). Let p and q be conjugate exponents. For functions fe Ll(K) and g e LjJ(K), 
we put 
K 
Theorem 6.2.1. (1) The Banach space L|f(H) {resp. HUH)) is isomorphic to 
Ljf(K) (resp. H^(K)) by the map "/(z)h^/(w) = (\-w)-^f{p-^w) 
(weKf, where 
[: 1]^ 
(2) Any holomorphic function bounded on K belongs to //jf(K) for all 
p (1 ^ p ^ (X)). 
(3) For a fixed Z2eH, the function K^{zi,Z2) belongs to i/jf(H) for all p 
(1 ^ p ^ 00). 
Proof The first and second assertions can be easily proved. Let/(w) be the function 
in Hjf(K) corresponding to the function Kf^izi^Zj) in H[{H) as a function of Zj. 
Then 
/(w) = (l-pz,r'K,(z,,Z2) 
= ' ^ [ — 0 
i'l = P~'^)> 
and it is bounded. By (2), we obtain (3). 
D 
Theorem 6.2.2. The integral operator K is a projection ofLKH) onto H£{H)for any 
p(\^p^co). 
Proof. By Theorem 6.2.1 (3), the integral in (6.2.1) is finite. Now we define a function 
Kf{(x) on SL2(U) by 
(6.2.2) 
X,*(a) = ICfc(ai, i); (a, 0"* 
(ae5L, 
Then for a, )SeSL2(lR), we see that 
(6.2.3) 
X,(ai, pi)j(0L, i)-'j{p, 
i) -' = 
Knr'oi) 
and 
(6.2.4) 
X,*(a-^) = X*(^. 
For a measurable function cp on 5L2(IR) with respect to the Haar measure da 
defined by (1.4.13), we put 
( 
j 
\(pioi)\'doX 
( l < p < a ) ) , 
ess. sup|(/)(a)| 
(p = oo). 

§6.2. The Projection of Lj^(H) onto //j[(H) 
227 
For a function /(z) in L|f(H), we put 
/*(a)=/(aO;(a,0-' 
(aeSL^W). 
Then Theorem 1.4.5 imphes ||/||p = ||/*||p. In particular, we have 
\\K,{zJ)\\,= \\Kno^n, 
for all /? (1 < p < 00). For a function /eLjf(H), we put 
g{z) = J K,{z, Z2)fiz2)lm(z2fdv(z2) 
(zeH). 
H 
Then we see by (6.2.3), 
g*(oc)= J 
Knr'oi)f*{P)dp. 
SL 2iU) 
Since 
SLjC"^) is unimodular, we have by [Weil 
5, pp. 54-55], 
II ^* II p ^ II i^.* Ill-II n i p and therefore 
||^||,^||K,(z,Olli-||/llp. 
This implies that K is a continuous Hnear mapping of Ljf(H) into itself. Next we are 
going to prove that the image of K is included in H|f(H). Let H„ (n = 1, 2,. . . .) be 
compact subsets of H satisfying H„ c= H„+i and IJ^H„ = H. We put 
(K«/)(z)= i K,(z,Z2)f(z2)lm{z,fdv{z,) 
(/6L«H)). 
H, 
Then X'"*/ is a holomorphic function by Lemma 6.1.5 and 
lim (X<">/)(z) = (Kf)(z). 
Let M be a compact subset of H. Then by Theorem 6.1.8, there exist a point ZQEM 
and a constant C such that 
\K,iz,,Z2)\ ^ C|iC,(zo,Z2)| 
(zieM,Z2 6H). 
Hence for zeM, 
|(X/)(z)^(X(«>/)(z)|gC 
J |K,(zo,Z2)/(z2)|Im(z2)*dt;(z2). 
H-H„ 
Therefore {K^"^f)(z) converges to {Kf){z) uniformly on any compact subsets of H 
and Kf is holomorphic on H. 
In the end, we shall prove that if/eHjf(H), then Kf=f. We define a function 
Kfc(wi, W2) on K X K by 
K,(wi, W2) = K,{p-'w,,p-'w2){l 
- wi)-*(l - 1.2)-^ (-[: -;]) 
Then Kfc(wi, W2) isjhe kernel function of H^iK) by the isomorphism given in 
Theorem 6.2.1. For/eLf(K), we also put 
(Kf)M 
= j X,(W, 
W2)f(W2)i\-\W2ndVKiW2y 
K 

228 
6. Traces of Hecke Operators 
Put g„(w) = w" for n^O. Since ^„e/ffc (K), we have Kg„ = g„. Then for a function/ 
in HJ(K), we have 
Therefore (Kf—f, ^„)K = 0 for all integer n(>0). Denote the Taylor expansion 
of K7-/at w = 0 by ( Kf-f){w) = X"=o ««vv". Then 
0 
This implies a„ = 0 for all n >0 and Kf = f. By the isomorphism in Theorem 6.2.1(1), 
we obtain Kf=f for all fe HJ(H). 
D 
§6.3. Function Spaces Consisting of Automorphic Forms 
Let r be a Fuchsian group of the first kind, x ^ character of F of finite order and 
fc(> 2) an integer. We assume /(— 1) = (— 1)* if/" contains — 1. For any measurable 
function/(z) on H satisfying 
(6.3.1) 
if\,y) (z) = xW/(4 
for any yer, 
we put 
i/p 
I J \fiz)lm{zr''\^dviz)\ 
(l<p<^). 
lr\H 
J 
ess. sup I f(z)Im(z)*^^ I 
(p = oo). 
zeH 
Since |/(z)Im(z)'^/^| is invariant under the action of T, ||/||r,p is well defined. For 
each p(l<p<oo), we denote by LJ(r, x) the set of measurable functions on H 
satisfying (6.3.1) and ||/||/;p<oo, and by Hf(r, x) the subspace of LJ(r, x) 
consisting of holomorphic ones. Then mr, x) is a Banach space and H^(r, x) is a 
closed subspace. The space L^iF, x) is a Hilbert space with the inner product 
(f.g)r= 
j f(z)^)lm{zfdv(z) 
(f,geLl{F,x)\ 
r\H 
Since the volume of T \H is finite, L^(F, x) ^ ^(r, x) and H^(r, x) ^ H^if, x) for 
all p(l <p< oo). Moreover by Theorem 2.1.5, Hj^iT, x) = ^ki^, x) and the restric-
tion of the inner product of L^ (r, x) to H^(F, x) coincides with the Petersson inner 
product up to a constant multiple. 
Theorem 6.3.1. Hi(F, x)=H^{F, xY 
Proof. The assertion is obvious when r \ H is compact. Assume that F has a cusp 
XQ. Let/ be an element in Hi(F, x)- To prove feH^{F, x\ we may assume x is 

§6.3. Function Spaces Consisting of Automorphic Forms 
229 
trivial by taking a subgroup of F of finite index on which x is trivial. Take an 
element a of SL2(U) such that coo = XQ, and put 
<T-'r,„<7-{±i} = | + [J i l h ^ ^ } 
^''^^^-
Denote the Fourier expansion of/ljir by 
(/l»'T)(z)= 
i 
a„e""'*-
W = 
— 00 
Let />0. Then we see by Corollary 1.7.5, 
00 > j 
\f(z)\Hm{zfdviz) 
r\H 
^\ 
ii 
\f(<yz)Ji(T,z)-'\'lmizfdv{z) 
^ 
0<Re(z)<2fi 
/<Im(z)<oo 
1 
00 2/i 
00 
^ 
Z 
0 
m, n = - 00 
for any integer n. Since /c>2, we have a„ = 0 if n^O. Thus we proved 
For any element/(z) in Z.fc(H), we put 
(6.3.2) 
/^(z)= |Z(r)|-i X %W/(y^);(7,^r' 
(zeuy 
We also put 
i633)K[{z„Z2) 
= \Z(r)\-' 
X zW^.(y^i, ^2)7(7, ^i)'* 
(^i,^2eH). 
Theorem 6.3.2. (1) The right hand side of {6.3.2) is absolutely convergent almost 
everywhere on H and f^{z)eLl(r, x)' 
(2) Iff{z)eHlill\ 
thenf^(z)GHl(r, /). In particular, K[{z, z^) belongs to 
Hi (r, x) as a function of z for each fixed Zj • 
(3) The right-hand side o/(6.3.3) is uniformly convergent on any compact subset of 
HxH. 
Proof. We see 
\Z(r)\ 
\ 
\nz)\\m(zfiHv{z) 
r\H 
^ J 
Zl/(yz)7(y,z)-Mlm(zFt/t;(z) 
r\H yer 
= |Z(r)| J|/(z)|Im(zf2t/t;(z)<oo. 
H 

230 
6. Traces of Hecke Operators 
Therefore the right-hand side of (6.3.2) is absolutely convergent almost everywhere 
on H. Since it is obvious that/^(z) satisfies (6.3.1),/^belongs to Ll(r, /). The 
second assertion is derived from this and Theorem 2.6.6(1). Take ^^(zi, Z2) as/(z) 
in (1), and we see by (6.1.6) 
J X \K,(yz,, Z2)\ l7(y, 
z,)\-nm{z,r'dv{z,) 
r\H y^^ 
= |Z(r)| 
i\K,(z„z,)\lm(z^r'dv(z,) 
H 
= \Z{r)\lm{z2)-"' 
J |K,(zi, 
i)\lm(z,rUviz,). 
H 
Therefore we obtain (3) by Corollary 2.6.4. 
D 
Theorem 6.3.3. The function K[{z^, Z2) is the kernel function of Hl(r, 
-/). 
Proof We note that Hl(r, x) = H^(r, x)- Let/be a function in H^(r, x)- Take 
a fundamental domain F of F. Since/(z)Im(z)*^^ is bounded, we see by (6.1.6), 
X 
J 
\K,{yz,,z,)Jiy,z,)-'f(z2)\lm(z2fdv{z2) 
^C X i\K,(y-'z2. 
z,)Jiy-\ 
Z2y'\lm{z2f"dv{z2) 
yer F 
= C|Z(r)| l\K,(z„ 
z,)\lm(z2)''"dv(z,) 
H 
with a constant C. Therefore we obtain 
j Kf(z„ 
z,)f{z,)lm{z2Uv{z2) 
r\H 
^\Z{F)\-' 
X 
I 
K,{z,,Z2)fiz2)lmiz2fdv(z2) 
= I Kfe(Zi, Z2)/(Z2)Im(Z2)*i/t;(Z2) 
H 
because/eH^(r, x) ^ ^^(H). To prove that Kfiz^, Z2) belongs to H^{F, x) as a 
function of Zj, we have only to show that K[(z^, Z2) belongs to H^ (H) as a function 
of Zj. It is well known that L^ifX) is the dual space of Lfc(H). A sequence {/„} in 
Ljf'(H) is called weakly* convergent if {(/„, S')H} is convergent for any ^GL^ (H). It 
can be proved that if a sequence {/„} is weakly* convergent, then there exists/in 
Lfc*(H) such that the sequence {(/„, ^)H} converges to (/, g)yi for any g ([Yoshida, V, 
Theorem 9]) and the function/is uniquely determined as a measurable function on 
H. Therefore we have only to prove that Y^y^r zW^fcCT^i^ ^2)7(7» ^i)'^ is 
weakly* convergent for a fixed Z2, namely that for a fixed Z2eH and ^eLfc(H), 

§6.4. Traces of Hecke Operators (Calculation of Integrals) 
231 
ZverJH ^W ^kiy^u Z2)Jiy^ ^i) *^(^i) Im(zif dv{z^) is convergent. Since 
J Xfc(yzi, Z2)Jiy, Zi) ^giz^) Imiz^fdviz^) 
H 
= J K,(r^Z2, z,)j{y-\ 
Z2r'g{z,)lmiz,fdv{z,) 
H 
= (X^)(y-lz2);(r-^Z2)-^ 
and Y^y^p x(y~^)(Kg)(y~^z2)j(y~\z2)~^ 
is absolutely convergent by Theorem 
6.3.2, we obtain the result. 
D 
§ 6.4. Traces of Hecke Operators (Calculation of Integrals) 
Before calculating the traces of Hecke operators, we express the dimension of the 
space of automorphic forms in terms of integral to illustrate our calculation. 
Theorem 6.4.1. dim^fc(r, x) = J K[{z, z)lm(zf 
dviz\ 
Proof. Let {/)(z)}J= i be an orthonormal basis of ^it(A X) with respect to the inner 
product (,)j^. Then we have 
K[{ZuZ2)= 
T,fj(z,)fjiZ2)-
Therefore 
dim^,(r,x)= t 
ifpfj)r= 
j K[(z,z)lm{zfdv{z). 
D 
i = i 
r\H 
Now let zl be a subsemigroup of GL^ (R) contained in F (see §2.8). We assume x 
can be extended to a homomorphism of zl to C satisfying (2.8.1). As we showed in 
§2.7 and §2.8, we can let the Hecke algebra ^ ( r . A) act on ^^^(r, x)- Let T be a 
subset of A. We assume T is a union of finitely many double T-cosets and write 
T = ]J7= 1 rPiF. We identify T with the element Y7= i rpiF of ^ ( r , A) and let it 
operate on ^^(r, x)- More precisely, the operation of T on fe^k(r, 
x) is given by 
(6.4.1) 
f\T= 
t 
d e t ( a , ) * / 2 - i ^ A a , . 
(T= 
J J TaA 
For example, take T = ro(iV), A = Ao{N) and T= {aezlo(iV)|det(a) = n}. Then T 
corresponds to T(n) of ^(iV) = ^{rQ{N% AQ{N)). Our purpose in this section is to 
calculate the trace of the operator T on ^^^(r, x)-
For an element a in T, we put 
(6.4.2) 
K(z; a) = det(a)'^-^^ X,(az, z)7(a, z)-'^Im(z)* 
(zeH). 

232 
6. Traces of Hecke Operators 
Theorem 6.4.2. Put tr(r) = trace (rj,$^fc(/:,j^)). Then 
tT(T)=\Z(r)\-' 
J X K(z;a)dv(zy 
r\H aer 
Proo/ Let {fi(z)}1= i be an orthonormal basis of ^^^(r, x) and T = ]J^= i Ta^. Then 
we see that 
tr(r)= t Ui\TJi)r 
= Z 
I Z det(a,)'^-ix(a.)//(ai^);(ai,^)-V.WIm(z)'^rft;(z) 
'=1 
r\H i = i 
J X ciet(a,.)'"' zCa.) K[{oijZ, z)j{oi,, z)-nm(zfdv{z) 
r\H J = i 
= |Z(r)ri j 
X det(a)'^-^z(a)X,(az,z);(a,z)-Mm(z)*rft;(z). 
D 
r\H «eT 
Now we are going to calculate the integral in the Theorem 6.4.2. The integrand 
is uniformly convergent on any compact subset of H by Theorem 6.3.2(3). There-
fore we can exchange the order of summation and integration if F \H is compact. 
In the case where F has cusps, we divide the integral into an integral on a compact 
subset and integrals on neighborhoods of cusps. For a cusp x of T, we put 
T^ = {ae T\ ax = x}. For a neighborhood U^ of x in H stable under T^, we have 
(6.4.3) 
J 
X /c(z; a) dv(z) 
= J 
X 
K(z\ci)dv(z)-\- J 
Y. K(ssci)dv{z\ 
Let us consider the first term of the right-hand side. For a = 
, L we write c and 
d as Ca and d«, respectively. We note that if peF^ocF^, then Ic^l = |c^|. 
Lemma 6.4.3. Assume oo is a cusp of F. Then for any /(>0), 
X 
det(a)'|cj-'^ 
<^€r^\{T-Tjir^ 
is convergent. 
Proof Let {a} be a set of complete representatives of F^\(T—T^)/F^ 
and T 
= ]Jj= 1 FoCj. Then we see 
Xdet(a)'|7(a,z)|-*^ 
X 
ciet(a)'|;(a, z)!"* 
{«} 
ocer^\T 
= t dct(oijy\j{aj,z)\-' 
Z 
\Ji%oijz)n. 
For a compact subset M of H, we put m = # {y e T | yM n M 7^ 0 }. Further, there 
exists, by Lemma 1.7.6, a positive number u satisfying that 7M c= {z e H | Im(z) < M} 

§6.4. Traces of Hecke Operators (Calculation of Integrals) 
233 
for any yeF. Since 
I 
I 
\j{y. z)\-nm{zf'^dv(z)^m] J f""-^dxdy<ao, 
M yer^\r 
0 0 
X?er„\r 17 (7» ^) I * is convergent almost everywhere on M. Since M is arbitrary, the 
set of points z at which Yj{u} det (a)' 17 (a, z)| "* is convergent is dense in H. Let /i be a 
positive number such that roo{±l} = <±L. 
meZ>, and take the set {a} 
so that \dj < \hCg,\. Take a point z so that ^.{a} d^t (a) \j (a, z)|~* is convergent and 
\z\ ^ /i, then we obtain 
Xdet(ay|cJ-'^<|2z|'^ X ^et(«)'!;(«, ^)r'<00. 
D 
{«} 
{«} 
Lemma 6.4.4. For any two real numbers h{h>0) and I (l> 1/2), there exists a positive 
number C such that 
f 
{(a-^nh)^-hb^}-'<Cm~^'^' + \b\-''') 
n = - 00 
for any real numbers a and b. 
Proof. We see easily that 
n = - 00 
n 
— 00 
Dividing the integral into the sum of jjj^' and J|°^|, we obtain the estimate. 
D 
Theorem 6.4.5. Let x and U^ be the same as above. Then 
Proof Put 
J 
X 
K(Z; (x)dv{z) = 
X 
j K{z;(x)dv(z). 
z) = Siz;r,x)= 
X 
I'^fea)!-
«eT-Tx 
We have only to prove that S(z) is convergent on U^ and integrable on 
r^\C/^. Since S{z; T, x) = S((TZ; GFO'^, 00) for asSLjiU) satisfying ax = 00, 
we may assume x = 00. Let /i be a positive number such that 
r^'{±\} 
={±[J tJr^^}-'^'^^" 
S(z) = \Z(r)\ 
Y. 
det(a)*-'|;(a,z)r'Ini(z)' 
OL&r^\{T-T^) 
X Y. \Kt,(<xz + nkz)\. 

234 
6. Traces of Hecke Operators 
Now by Lemma 6.4.4, 
fl = — 00 
^ ^ 
f l = — 00 
^Ci{Im(az-z)-*-'i + Im(az-z)-*} 
with a constant Cj. Since Im(az —z) = Im(az)H-Im(z)^Im(z), we see by 
Lemma 6.4.4, 
(6.4.4) 
S(z)^Ci(Im(z) + l) 
^ 
det(a)*-M7(a, ^ ) r ' 
aer<,\(r-r,) 
^Ci(Im(z)+l) 
X 
detCa)*^-^ 
f 
|c,(z + «/i) + 4 r ' ^ 
^C2lm(z)-'^(Im(z)+ 1)2 
X 
dct((xf-' 
\cj-' 
uer^\{T-TJ/r^ 
with a constant Cj. By Lemma 6.4.3, S(z) is convergent and bounded on U^. Since 
r^\U^ 
has finite volume, S(z) is integrable on r^\U^ 
and we can exchange the 
order of integration on the left-hand side of the equahty in the theorem. 
D 
Next let us investigate the second term on the right-hand side of (6.4.3). 
Lemma 6.4.6. Ifx is a cusp of F, then |r^\r;c|<oo. 
Proof. If a and P are elements of T^ such that ocP'^eF, then (xP~^x = x, and 
therefore ap-^eT^. 
This implies | r ^ \ r ^ | ^ | r \ r | < o o . 
D 
Theorem 6.4.7. Let xbe a cusp off, and o an element ofSL2(U) such that o-x = oo. 
Then 
J 
X 
f^i^'. oc)dv(z) 
= lim 
X 
j 
K(z;a)lm(z)-^|7((7, z)|2^^r(z). 
Proof We may assume x = oo and c = 1 as usual. Since Im(z)~* is convergent to 1 
monotonously increasingly when s( > 0) tends to 0, we see 
j 
X K{Z; (x) dv{z) = lim 
j 
YJ 'C(Z; a)Im(z)"*^i?(z). 
We shall show that the order of integration and summation on the right-hand side 
is exchangable. Put 
S(z,5)= X |/c(z;a)|Im(z)-^ 
(5>0). 
We have only to see that 5(z, s) is integrable on r^\U^, 
Similarly to (6.4.4), 
we have 
S(z,5)^Ci(Im(z)^-^ + Im(z)-^) 
^ 
dcm'-'\j((x, 
z)\-' 
aer„\r„ 

§6.4. Traces of Hecke Operators (Calculation of Integrals) 
235 
with a constant Cj. Since (Im(z)^~* + Im(z)~*)| j(a, z)|"* is integrable on r^\U^ 
and r^\T^ 
is a finite set, 5(z, s) is also integrable on r^\U^. 
D 
Let Pp be the set of all cusps of F. Take neighborhoods U^ of cusps x so that 
they satisfy 
(6.4.5) 
Uy^ = yUAy^n 
and U^nU,- = 0 
ifx7«^x'. 
Also take elements o-^eSL2(IR) so that a^x = oo and Imiay^yz) = Im((TjfZ) iyeF). 
We put 
Z ( r ) = r n R " , 
r 2 = y 
(T^-Z(T)) 
and T' = 
T-T\ 
xePr 
For a 6 r^, we put 
K(Z;OC) 
( Z ^ 
(6.4.6) 
K:(Z; a, S) = -l 
U t/.\ 
I K(z;a)Im(z)-|;(<T„z)p' ( z e (J l / , \ 
Then by Theorems 6.4.2, 6.4.5 and 6.4.7, we obtain 
(6.4.7) 
|Z(r)|tr(r)= X 
j K(z;o^)dviz) 
+ lim 
J 
J K(Z; a, s)^f(z). 
Before calculating the right-hand side, we introduce notations on conjugacy 
classes. Let G be a group, and H a subgroup of G. We say two elements g^ and gj of 
G are H-conjugate and write giuGi^ if there exists an element h in H such that 
02 = h~^ g^h. For an element ^ of G, we put 
C H ( ^ ) = Cn,G(g) 
= 
{g'eG\g'Hg}-
The H-conjugacy gives an equivalence relation in any subset of G. For a subset M 
of G stable under inner automorphisms of G by elements of H, we denote by M//H 
the set of all /f-conjugacy classes in M, or M//H = M/g. 
Let us return to the present situation. Since yr^y" ^ = Ty^ for any yeP, both T^ 
and T^ are unions of F-conjugacy classes. For any CCET^WQ put 
r(ot)={yEr\ 
ccy = ya}. 
Then we can rewrite (6.4.7) and obtain 
Theorem 6.4.8. 
|Z(r)|tr(r)= 
X 
j 
K:(Z; a)^t;(z) 
oteT^f/r 
r(a)\H 
+ hm 
^ 
j 
K:(Z; a, s)f/t;(z). 
*"*'^^ oceT^//r r(a)\H 
Proo/ Let F be a fundamental domain of F. Then by the choice of a^, we see 
for 7 e r, 
j K:(Z; y"^a)')^!;(z) = j K:(Z; a)^t?(z). 
F 
yF 

236 
6. Traces of Hecke Operators 
Therefore for each fixed (xeT^yV/Q obtain 
X 
J /c(z; p)dv (z) = 
X 
J Kiz; y "' oiy)dv (z) 
= 
J 
K(Z; QL)dv(z). 
r(a)\H 
A similar argument is also appHcable to the terms for (xeT^. 
D 
The next step is the calculation of the integrals in Theorem 6.4.8 depending on 
the type of a. 
r . The case where aeZ(r). Put a = Mj 
. Since r(a) = T, we see 
J 
K{z;oi)dviz) = ^^dQti(xf-'x{oi)a-'' 
J dviz) 
r(a)\H 
^'^ 
r\H 
= ^W) 
sgn(a)* det(af/2 -1 t;(r\H). 
2°. The case where a is elliptic. Let ZQEH be the fixed point of a, and put 
P — 1 
-° ' which maps H onto K. We see p(xp~^ = 
(^y, CeC) and 
LI -^oj 
L^ 
fj 
7 (a, z) = C(z —Zo)/(az —Zo). Put w = pz, w' = pz and write w = re'^ w' = r ^ e*^. 
Since the anharmonic ratio is invariant under the action of linear fractional 
transformations, we have 
Z — Z(X.Z — Zn 
W — W' 
OLz — z Z — ZQ 
rjC ^w — w' 
and therefore 
Since ^r^ (w) = 4r (1 — r^)" ^ Jr^0, we obtain 
J 
/c(z; a)iit;(z) 
r(a)\H 
= ^ d e t ( a ) ' ^ - i ^ C " * 
j 
4r(l-r2)*-2(l-^;j-ir2)-'^^rrf^ 
(/c-l)det(a)^-^^r^ f n 
^^-2n 
r-i ^-^^ 
[r(a):Z(r)]f/-C 
3°. The case where a is hyperbolic and all fixed points of a are not cusps of F. 
Let Xi, X2G[RU {OO} be two distinct fixed points of a. Take (7eSL2{U) so that 

§6.4. Traces of Hecke Operators (Calculation of Integrals) 
237 
(TXi = 00 and 0X2 = 0. Then 
We see r(a) = T^^,^, by Lemma 1.3.3(3). If r(a) ^ Z(r\ then by Theorem 1.5.4(3), 
Gr((x)G-^'{±\}=ar,^^,^G-^'{±\} 
= \ ± 
with ueW such that |M|>1. Put w = oz = re . Similarly to 2°, we obtain 
J 
K{Z\ (x)dv(z) 
r(a)\H 
471 
k-\ 
~4^ 
-det(ar-x(«)C-M-j(^^-,^,._^_.) - ^ 
(r(a) = Z(r)), 
Assume r(a) = Z(r). Since the integral jr(a)\H '^^(^J a)i/i;(z) is convergent, the 
integral j ^ r"^fir should be convergent, which is a contradiction. Therefore 
r(a) 7^ Z(r). Now we can express the integrand as 
depending on ;;C~^<1 or ^C~^>1» respectively. Since the series is uniformly 
convergent, we have JJ t y-\ te 
^^WJi dO = 0 by termwise integration. Therefore 
J 
K(Z; (x)dv(z) = 0. 
r(a)\H 
4°. The case where a is hyperbolic and at least one fixed point of a is a cusp of T. 
In this case, we have r(a) = Z(r) by Lemma 1.3.3(3) and Theorem 1.5.4(2), and 
therefore r(a)\H = H. Let x^ and Xj be the fixed points of a. Suppose only one 
fixed point, say X2, is a cusp of F. Let (7, rj and C be as in 3°, and U = U^^ a, 
neighborhood of Xj such that 
(Tl/ = {zeH| |z-ifl|<a} 
(a>0). 
Then similarly to 3°, we see 
J 
K(Z; OL, s)dv{z) 
r(a)\(H-t/) 
=—det(a)^ ^X(aK ^j (,^-.,.a_,-. j ^ e 
±,T^ 

238 
6. Traces of Hecke Operators 
which is not finite. Therefore, both x^ and X2 should be cusps of F. Let U^ be a 
neighborhood of Xv(v = 1, 2), and put H' = H —(C/i u 1/2)- Divide the integral as 
j 
K{Z; oi, s)dv(z) 
r(a)\H 
= J K(Z; a, s)dv(z)-\- j K{Z; a, s)dv(z)-\- J K{Z; a, s)dv(z). 
H' 
1^1 
U2 
Let cr, f/ and C be the same as in 3°. We may assume \rj\ < \Q by exchanging x^ and 
X2, if necessary. Put 
(Tl/i = {zeH|Im(z)>ri}, 
(TI/2 = {ZGH| |z-ir2l<r2} 
with positive numbers 2r2 < ri. Then 
j K:(Z; a, s)^t?(z) 
Similarly we have ^u2^(^'-> ^^ s)dv(z) = 0. Next we see that 
J K(Z; OL, s)dv(z) 
H' 
= —A—det(af ^%(a)C M 
^_. .. 
37^ 
^-777 
f 
— 
471 
^' ' 
i V/C ^e'^-e 
' V sm^^ 2r2sin0 r 
Integrating it by parts, we have 
_ i 
/--fc 
jr / 
pie_p-ie 
\k-i ^ie, 
-id 
Expanding the integrand as the uniformly convergent series in e^^^ with the 
constant term — 1, we obtain 
jK(z;a,s)dv(z) = -dot(a)'-'m^i^^= 
- ^ p L y r sgn(Cf, 
and therefore 
r(a)\H 
I** ^1 
5°. The case where a is parabolic. Let x be the fixed point of a, and (T an element 
of SL2iU) such that GX = 00. Put 
•=KJ] 
aa(T-^= 
; 
I 
(C,2G(R). 

§6.4. Traces of Hecke Operators (Calculation of Integrals) 
239 
Suppose that x is not a cusp of F. Then r(a) = Z{r) by Lemma 1.3.3(2), and 
J 
K(Z; <x)dv{z) 
r(a)\H 
/ 
z-z 
V 
Since I 
z—7737 =y*(y —i>lC 72) *()^ = Im(z)), this integral is not finite. 
\Z — Z + AL, J 
Therefore x must be a cusp of F and r(a) = T^. Denote by T^ the set of parabolic 
elements of T, and put 71=7^^ T^ for each cusp x of T. Since r, = r(a) for a e r|, 
any two elements are not T-conjugate. Therefore we can take the set (Jxerxp^^x ^s 
a complete set of representatives of T^l/F. Since r\Pj^ is a finite set, we see 
^^^ Z 
J '^^fe <^» s)^i^(z) 
s-^+0a6rP//rr(a)\H 
= Z 
lin^ Z 
I 
K;(Z; a, s)f/i;(z). 
Weput (Tr^<T"^{±l} = < ± 
meZ > (/i>0) for each xePj^as usual, and 
/i(a) = AC " ^ for a e TjP. Then we see 
J 
K(Z\ a, s)dv(z) 
r(a)\H 
471 
Now 
-det(a)'-'x(a)r' 
| 
( ^ - ^ Y l m ( 2 ) - d y ( z ) . 
j 
( — ! ~ ! , J Ini(z)-'<it)(z) 
}ixf/-2-(j;-,7.(a)/2)-'dj' 
0 
0 
= ih{2ilh{oi)f^^ l(itY-^-'(it^\)-Ht 
0 
= /i(2///i(a))^-'^ J M*(l -uf-^-'du 
(it = (1 -u)/u) 
c 
= /i(2i//i(a))*-'^ j M*(l -M)'^-2-*dM 
c 
1 
J 
0 
;i(2i7;i(a))*-' ^r(s+i)F{k - s - i)/r(/c). 

240 
6. Traces of Hecke Operators 
Here C is the upper (or lower) half of the circle with center 1/2 and radius 1/2. Thus 
we obtain 
1^^ Z 
i 
^i^'y o^> s)dv{z) 
= lim 
^^2^^'h'r{s-\-l)r(k-s-l)/rik) 
= lim - ^ X zWsgn(C)Met(a)*/2-^(i/i//i(a))^^^ 
Put m(a) = /i(a)//i and sgn(a) = sgn(C), which are independent of the choice of G. 
Then we obtain 
lim 
Yu 
J 
'^fe ^^ s)dv(z) 
s^+0a6rv/rr(a)\H 
= lim ;^ X 
x(a)sgn(a)*det(a)*/2-i(j/m(a))^-'^ 
s-*+0 
^'^(xeTP//r 
Summing up the calculations in 1° through 5°, we obtain a formula for tr(r). To 
state it, we put 
Z(r) = Tn R ^ 
r" = {a e r| a is elliptic}, 
T^ = {aer|a is hyperboHc, and all fixed points of a are cusps of T}, 
r*' = {aer|a is hyperbolic, and no fixed point of a is a cusp of T} 
and 
r'' = {ae r|a is parabolic, and the fixed point of a is a cusp of T}. 
Then 
T = Z{r) u T^ u r'' u r*' u r^' 
(disjoint union). 
We note that if r\U 
is compact, then 7^ = 7^ = 0 and 
T=Z(r)^r^T^'. 
Further for an element aeGL2 (R), we use the following notations. 
(6.4.8) 
We denote the eigen values of oc by rj^^ and Ca- V ^ ^^ elliptic, then take 
(7eSL2(U) so that 
aOLG J 
r 
COS0 sin^n 
|_ —sin0 
cos^J' 
and specify rjg, and Ca by 
(6.4.9) 
For a non-elliptic a, we put sgn(a) = sgn(C«). 
(6.4.10) 
Ifoc is parabolic, then rjg^ = Ca' Denote the fixed point ofoc by x, and take 
aeSL2(U) so that (TX = oo. Let A be a discrete subgroup ofSL2(U)^. Then 
aaa -KJ} --.*..={4;-]H 

§6.4. Traces of Hecke Operators (Calculation of Integrals) 
241 
with C = Ca ^^d h>0. We put 
m(a, A) = A//iC, 
'w(a) = m(a, r(a)). 
We note m(a, A) and m(a) are independent of the choice of G. NOW using these 
notations, we can write the trace of T as follows. 
Theorem 6.4.9. 
tr(r) = ro + r, + r, + ^p, 
where 
^« = ^ ~ ^ m r ? 
S 
:^sgn(a)'det(a)*'^-S 
a€7^//rin°')l'/.-C 
t,= 
lim 
^ 
X 
;^sgn(a)Met(af/^-H^ym(a))^^^ 
The terms r^ and tp are simpHfied if T and / satisfy the following condition: 
(6.4.11) 
there exists an element g in GLjCIR) such that det(g) = — 1 and satisfies 
gocg~^€T 
and xigccg'^) = i{ci) 
forallcceT. 
In the most cases we apply the formula, (6.4.11) is satisfied. In fact, if T = ro(iV), 
A = ^o(^) ai^d X is the character defined by (4.3.2), it is satisfied by taking 
^ = ["J ?]• 
More generally, let R be an order of level N of an indefinite 
quaternion algebra, F = FR and A=Ag^. Take a maximal order i?o including R 
and apply the approximation theorem (Theorem 5.2.10) to i^o ^nd N with n = — 1 
andjS 
r - 1 0 
^ L 0 1 for all prime factors p of N. Take P in Theorem 5.2.10 as g, then 
(6.4.11) is satisfied for the character x defined by (5.3.6). 
Theorem 6.4.10. If T and x satisfy the condition (6.4.11), then 
2„,^//^|r(a)| 
fy„-C« 
' 
^p = - 
^"^ J^VTFVi I 
z(S)sgn(a)*det(a)*/2-Mm(a)ri-. 
s-^+o4|Z(i jl agj-P///^ 
Proo/ Let g be an element satisfying (6.4.11). For each OLET, we put cc' = gocg~^. 
Then a' is of the same type as a, and if a is either elHptic or parabolic, then a and a' 
are not T-conjugate by Lemma 1.3.5. First suppose oceT^. Take c, ^y„ and C« as 

242 
6. Traces of Hecke Operators 
in (6.4.8). Put <T' = 
« r ^"' ^''®" 
, , ,_, 
r 
cos(-0) sin(-e)"| 
^ 
. ^ 
- « - 
' = l - s i n ( - 0 ) 
c o s ( - 4 
'''^^' 
' " ' 
^'• = ''-
Therefore we have 
rj'.-' ^ n\-' 
nl-'-^\-' 
Pairing a and a' in the summation ^aerv/r* we obtain the formula for t^. Next 
assume cueT^. Let x, <7 and h be the same as in (6.4.10). Put o^' = 
o-^~ ^ 
and x' = ^x. Then x' is the fixed point of a', and 
This implies m(a') = — m(a). Pairing a and a', we have 
5-+o47r|Z(r)| 
X Z 
x(a)sgn(a)Met(af2-i|^(Q^)|-i-s 
Since we can take the set (JxerxPr ^^ ^^ ^ complete set of representatives of T^l/F, 
X S 
Z 
;d^sgn(a)*det(a)"^-' 
xsr\Pr!ieTlir^ 
X Z' Z(r)sgn(y)'|m(a) + m(7)|-i-'. 
Here Z' implies that we omit the term m(a) + niy)=0. Let y,, 6 r, be a generator of 
r,-{±l}/{ + l}.Then 
E'z(v)sgn(y)'|m(a) + /n(y)r'-^ 
= \Z{n\ E ' x(>^"sgn(yonm(a) + n r l - ^ 
n=—oo 
and it has a pole of order at most 1 at s = 0 by Theorem 3.2.2. Further we see that 
- ( i ' " ' ' + ( - i V ' ) = - s + fl2S^ + a3s3+ 
71 
Therefore we obtain the formula for t„. 
D 

§6.5. Traces of Hecke Operators (Algebraic Calculation) 
243 
For the further calculation, we arrange each term. For CLET^KJT^KJ T^, we put 
fc(a) = ^g„°„).min{ICJ,l-,jr' 
IC-'/J 
(aer). 
and 
/(«) = 
Corollary 6.4.11. We have 
and 
-sgn(a)*det(a)*/2-i 
{OLET^ 
l/(2|r(a)|) 
(aen, 
l/|Z(r)| 
(a e n 
mZ(r)V\m(0L)r') 
{oLETn. 
te=- 1 xm(oi)m\ 
0Ler//r 
(xeT^lir 
tp= - lim 
X 
Z(a)fc(a)/(a). 
If r\H is compact, then t^ = tp = 0. 
§6.5. Traces of Hecke Operators (Algebraic Calculation) 
In the rest of the chapter, we apply the general formula of traces of Hecke operators 
in §6.4 to Fuchsian groups obtained as unit groups of norm 1 of indefinite 
quaternion algebras. We use the notation in §5.3 for quaternion algebras. 
Let B be an indefinite quaternion algebra over Q with discriminant dg, R Sin 
order of B of level N, and 
rj, = 
{yeR^\Ns{y)=l}. 
Let r = Lir^iarjj be a (disjoint) union of finitely many double T^j-cosets included in 
AR. We identify T with the element SruaTu in ^(r^, A^). Moreover we put 
T^=Uj,TU^. 
It is a disjoint union of finitely many double UR-COSQIS by Theorem 5.3.5. We 
identify T^ with the element ZC/jj a l/^ of ^(l/^j, Djj). Note that T corresponds to T^ 
through the isomorphism of ^(r^, zj^) onto M(Uj^,Dj^). Let ;f be a Dirichlet 
character mod N. Then x can be considered as a character of T^ by (5.3.6). The 

244 
6. Traces of Hecke Operators 
purpose of the remaining sections of this chapter is to obtain a computable form of 
trace formulae of Hecke operators T= T{n) defined by (5.3.12) operating on 
^ki^Ri x)' Hereafter we also denote Fj^ and U^ simply by F and 17, respectively. 
For the convenience of the reader, we recall the notation in the case of modular 
groups. In this case, B = M2(Q) and 
UR = GL^(U)XY[R; 
^B 
c = OmodAf/ }• 
A » 
where 
fffl 
hi 
eM2(/,) 
Therefore Tjj = L/^j n 5"" = FoiN), Moreover 
D„ = 
c = OmodNZ, 
D^ = (GLUU) 
X 
llD,)nGL2iQA 
ip\N) 
As for Hecke operators, we see 
r(n) = {a6ZloW|det(a) = n}, 
where 
T{n)^ = U^T{n)U^ - {GmU) 
xl[\T(n),\nGL2{QA 
r(n) ={a^EDJdet(aJenZ;}. 
Now we return to the initial situation in this section. We are going to calculate 
rV/r, T^//F and T^/fF, For an element a of B^ ni^ not contained in Q, we put 
C(a) = CBx(a) = {^a^-i|^eB^}. 
Lemma 6.5.1. (1) Assume OLET^^T^KJTP. 
Then 
an imaginary quadratic field K, if cue T^, 
Q [ a ] ^ < Q x Q , 
if 
(xeT\ 
Q[£] 
(8^ = 0), 
if oceT^, 
(2) Let S be T\ T" or T^. Then for aeS^we have 
SnC(oL)=TnC(oi). 

§6.5. Traces of Hecke Operators (Algebraic Calculation) 
245 
Proof. (1): Leif(X) (eQ\_XJ) be the principal polynomial of a. Then 
Q[a]^Q[Z]/(/(X)). 
By definition, f(X) = 0 has two imaginary roots, two distinct real roots, or a 
multiple real root if a is elliptic, hyperbolic, or parabolic, respectively. This implies 
(1). (2): Since the type of any conjugate of a is the same as a, the assertion is true for 
5 = r^ or TP. Suppose S = ^^ If T* 7^ 0 , then B = MjCQ), and therefore 
Pr = Q u {00}, and any element of B '^ = GLjCQ) maps Pf onto itself. Therefore if a 
is contained in T*, all fixed points of conjugates of a by elements of B"" are also 
cusps of r. This impHes the assertion for S = T*. 
D 
Since 
k((x) = k(S(xS-^) for any SeB\ 
the above lemma impHes that if 5 = ^^ T" or T^ then 
^6.5.1) 
X xm{oi)m= X fc(a) s 
xmim 
oceSf/r 
aeSZ/B** 
/56(rnC(a))//r 
For any element ^ of 5"", (Q[a] n <5" ^7?^ is an order of Q [a]. For each order r of 
Q [a], we put 
Ci(x,x) = {SoLS-^\3eB\ 
Qloc']nS-^RS = x}. 
Since Ql(x]nS~^RSis determined by j5 = ^a^ " ^ and is independent of the choice 
of S by Lemma 5.2.2(3), we see 
(6.5.2) 
C(a) = L[C(a,r), 
r 
where r runs over all orders of Q[a]. Suppose OLET^KJT^. Let r be an order of 
Q[a], and p = S(xd~^ (SGE"") an element of C(a,r)nr. Then p is elliptic or 
parabolic, and Ngiej^O for any eeQ[j5]. This combined with Lemma 5.2.2(3) 
implies 
r(P) = {yEr\yP = Py} 
We put 
'l/2|r^| 
(a e n , 
(6.5.3) 
/(r) = { 1/2 
(a e n 
l/2|m(a,r")|^-'^ (oceT^). 
Then we see 
l{p) = /(r) for any i^e C(a, r), 
since |Z(r)| = 2. Assume TnC(oc,x) ¥" 0 and let P = Sixd~^ be an element of 

246 
6. Traces of Hecke Operators 
rnC(a,r). Then PeSxS~\ and therefore, aer. This impHes that if TnC((x,x) 
# 0 , then r 3 Z[a]. Therefore we can rewrite (6.5.1) into 
(6.5.4) 
X 
mmm 
(xeS//r 
= Z m I /(r) 
I 
z(«. 
<xeS//B'' 
Z[a]cr 
/36(rnC(a,r))//r 
We are going to locaHze the calculation of each term. 
Let K be an algebra over Q of dimension 2. We denote by Ni^{x) and trj^(x) the 
determinant and the trace of the regular representation of x, respectively. When K 
is a subalgebra of a quaternion algebra B over Q, ^^(x) and trj^(x) coincide with the 
reduced norm and the reduced trace of x in B. When K is a quadratic field, Nfr and 
trj^ are usual ones. We note that N^ and trj^ can be extended to the mappings of K^ 
into Q^ in the usual manner. For an order r of K, we put 
r^ = r(8)zZ^, 
rj;+ = {(ajGr^^|det(a«,)>0}, 
where 
Moreover we put 
h{x) = 
\K:i/(xi^'K^)l 
and call it the class number of r. 
Now we return to the calculation of (6.5.4) and put 
CAoc) = Cs:^{oi) = {hoih-'\heB:i}, 
CAoi.x) = {h(xh-'\heB:i,Q^loc-]nh-'R^h 
= x^}. 
Obviously 
C(a)c:C^(a), 
C(a, r) c= Q(a, r). 
Lemma 6.5.2. Let a be an element of T^KJT**KJ T^, and 6 the natural mapping of 
C(oc)//r into Q(a)//(/. Then 
(1) 0 is surjective. 
(2) Ifg is an element ofC^OL, x) with an order x of Q[a], then 
\e-HCvig))\ = Hxi 
where 
Cu{g) = {ugu-'\uEU}. 
Proof Let g = hoih~^ (heB^) be an element of C^(a). Since h = uP with ueU and 
peB"" by Theorem 5.2.11, we see that 
This impHes (1). For an element { of 5"", we see that 

§6.5. Traces of Hecke Operators (Algebraic Calculation) 
247 
Moreover for two elements <^, rjeB'', 
CAioir')=CAwri-')of^Qloir=rrjQloir. 
Since 
we see 
\0-HCv(9))\==\r\(UhQAoir nB^)/Qlocr\ 
= 
\r\(UPQAoirr^B^)/Qlocr\ 
= 
\r\(UQAPocr'rnBn/QlPar'ri 
Now we are going to prove that if £ is a commutative subgroup of B^, then 
(6.5.5) 
|r\(l/£nB^)/(£n5^)| = |£:/(£nL/)-(£n5^)|. 
In fact, Theorem 5.2.11 implies that for any element t of £, there exists an element u 
of U such that 
uteUEnB''. 
Let fi, ^2 be two elements of £, and MJ, M2 two elements of U. Assume that u^ti, 
U2t2eUEnB''. 
Noting that T = C / n 5 \ we see that 
ru,t,(EnB'') 
= 
ru2t2iEnB'')otit2^e(EnU)-(EnB''). 
This implies (6.5.5). Since 
QALM'^T 
r^B'' 
=QiM~'V. 
we can apply (6.5.5) for E = QAIP<^P~^^ "", and see 
\0-HCv(9))\ = 
\QALM-'rmAlM-':inuyQiM-'r\ 
= |O^MV(O^Mnj?-^L/)?)-Q[a]^|.. 
Now assume that ^GC^(a, r) with an order r of Q[a]. Then 
QAMnp-'up^x^^, 
since 
p 
Therefore 
l^-HCt;(^))l = |O^MVr;+-QM^| = /i(r). 
• 
Since T^ is a union of finitely many double l/-cosets, 6 transforms 
(Tn C(a, r))//r onto (T^n C^(a, r))//l/, and therefore, by Lemma 6.5.2, (6.5.4) is 
rewritten into 
(6.5.6) 
X z(«)Ma)'(a) 
(xeS//r 
j ; fe(a) X '(»)''(») 
Z 
Z(3)-
aeS//Bx 
Z M c t 
g€(r^nC^(a,t))//l/ 

248 
6. Traces of Hecke Operators 
Now let V be either a prime number or oo. We put 
^v — ^v TR^ , 
C^(a) = C^. (a) = {xax" ^ IX 6 5 ; }. 
For a prime number p, let r^ be the closure of r in B^, and put 
Cp(a,r) = {xax-M^eB;,Qp[a]nx-^/?pX = rp}, 
C^(a,r)=C^(a). 
Moreover we write 
R:, = GLim 
Then 
V 
and 
(r,nQ(a,r))//C/ = n{(7;nC,(a,r))///?:;}, 
V 
where the product is taken over all prime numbers and 00. Therefore we obtain 
(6.5.7) 
Z 
M=Y\{ 
Z 
iJg^) 
Here if i? is a prime number prime to iV or 00, then we understand Xvidv)= 1-
§ 6.6. Local Conjugacy Classes 
In this section, we calculate each factor in the right-hand side of (6.5.7). First let 
t; = 00. Since 
C^(a,r) = C«,(a) and T^ = R^ = 
GmR\ 
we see 
(Too n Cooioi, x))l/R^ = {xax-' \ x e GL2(M)}//GL+(R). 
Since GL^(IR)\GL2(IR)/Z(a) corresponds bijectively to the set in the right-hand 
side, Lemma 1.3.3 implies that 
(6.6.1) 
|(r^nC^(a,r))//i?il=|^ 
^^^^^^ 
Next suppose v = p, a prime number. We note that any algebra L over Qp of 
dimension 2 is isomorphic to one of the following: 
r a quadratic field Kp over Q^; 
2° Hp = QpXQp; 
3° Ep^QplBlB' 
= 0. 
In fact, if X is a generator of L over Q^, and/(X) is the defining polynomial of x, 
then 
L^QplXV(f{X)). 

§6.6. Local Conjugacy Classes 
249 
We get the above three cases 1°, 2° or 3° according as the equation/(X) = 0 has no 
roots in Q^, has two distinct roots in Qp, or has a multiple root in Q^, respectively. 
When Lis Kp, Hp or Ep, we put 
(6.6.2) 
the ring of all integral elements of Kp (L = Kp), 
^ p X Z , 
{L = HpX 
Iple] 
(L = Ep). 
If L is Kp or Hp, then o^ is the maximal order of L. Further we obtain 
Lemma 6.6.1. Let L he Kp, Hp or Ep. Then any order of L is 
^p-^fOp, 
where e is an integer. Moreover e^OifLis 
Kp or Hp. 
Proof. Let r^ be an order of L. Since Z^ is a principal ideal domain, we can write 
with an element ueXp. Since 
Xp^Zp^ZpU 
Qptp = QpOp = L, 
there exists an integer e such that 
ueZp + p^Op and u^Zp + p'^^o^ 
If L is Kp or Hp, then we see easily that 
e^O. 
D 
Now let p be a prime number prime to dg. Then Bp = M2(Qp) and 
(6.6.3) 
- { [ : I] 
€M,(Z,) c = 0 mod '•} 
with a non-negative integer v. Moreover let N(Kp) be the normalizer of Rp, or 
(6.6.4) 
N(R,)= 
{geGL2(Q,)\gR,g-' 
= R,}. 
Lemma 6.6.2. We have 
' Q ; R ; 
if 
V=0, 
N(RJ=-{ 
Q;«;^[pv J]Q;«; «/ v>o. 
Proof First suppose v = 0. Then Rp = M2(Zp). For an element a of GL2(Qp), there 
exist Ui,U2eGL2(Zp) such that 
WiaM2= Q 
/ 
(eJeZ) 
by elementary divisor theory. Therefore (xRp(x~^ = Rp if and only if e =/(namely 

250 
6. Traces of Hecke Operators 
OLEQp Rp ). Next assume v > 0. Since there is a unique pair (R^p\ Rf^) of maximal 
orders of M2(Qp) such that 
by Lemma 5.3.1, any element o{N(Rp) induces a permutation of {R^p\ Rf^}- Since 
we can take 
for (R'^K R^p^) in our case, we see 
[N(R,):Q;R;] = l o r 2 . 
'•[:•;]" 
On the other hand, 
^ 
is an element of N(Rp) but does not belong to Qp Rp , 
so that 
N{RP)^Q;R;. 
This impHes the assertion. 
D 
Let a be a non-scalar element of Rp such that det(a) ^ 0, and 
UX) = X^-tX 
+ n 
(t.neZp) 
be the principal polynomial of a. Let r^ be an order of Op [a] including Tp[ix\. 
We put 
[rp:Zp[a]]=p^ 
(p ^ 0), 
then Lemma 6.6.1 implies that r^ is uniquely determined by p. Put 
(6.6.5) 
(2(a, Xp) = {^eZpUM) ^ 0 modp^-^^^ t-U^O 
modp^}. 
Furthermore, for an element { e Q(OL, Xp\ we put 
(6.6.6) 
^^=[-P4,) 
uy. 
Since/,(fif^) = 0, wesee 
^ ^ e C » = {xax-MxGGL2(Qp)}. 
Lemma 6.6.3. Let Rp he an order o/M2(Zp) defined by (6.6.3), a a non-scalar element 
of Rp, and Xp an order o/Op[a] such that 
tp^ZpM 
and [rp:Zp[a]]=p^ (p^O). 
For an element g of Cp((x\ the following four statements are equivalent. 
(1) geCp(ci,Xp). 
(2) geZp-^ p'Rp, and g^Zp-^ p^^' Rp. 

§6.6. Local Conjugacy Classes 
251 
[:a 
(3) Ifg = \ ^ ^ L then 
b = a-d 
= Omodp^, 
c = 0 mod p^ •" \ 
and any one of the following three conditions is satisfied: 
(i) 
b^Omodp^^'; 
(ii) 
c^Omodp^^'^'; 
(iii) 
a-d^Omodp^^K 
(4) There exists an element {e^(a, r^) such that g is N{Rp)-conjugate to g^. 
Proof (l)o(2): Put g = hoch-^ with heGL2(Qp). Then 
geCpioi, Xp)<>Qplg;\ nRp = hXph~^ 
oZplg:\ = 
Zp-¥Qplg-]np'Rp 
by Lemma 6.6.1. This implies the equivalence of (1) and (2). (2)o(3): This follows 
from the definition of Rp. (4)=>(2): Suppose that g is Ar(i?p'')-conjugate to g^ 
with an element ieQ(ix,Xp). Since g^ always satisfies (3), it does (2), so that 
V n ^^ 
V A 
^^^^ satisfies (2). This combined with Lemma 6.6.2 implies 
that g satisfies (2). (3) => (4): Suppose that g satisfies (3). First assume condition (i), 
and put 
b = p^b^ 
(b^eZ;). 
Since g is conjugate to a, we seeX(S') = 0. In particular, 
t = a-\-d, 
n = ad — bc, 
so that 
/,(a)=-Z)c = 0modp^•^2^ 
and 
r - 2 a = 0modp^. 
Thus aeQ{<x, Xp). Moreover we see 
ugu ^ = g. ("[: :.]-'•) 
Next suppose that g satisfies condition (ii). Since 
v ^ U' 
^ 
satisfies 
[_P OJ LP 
OJ 
condition (i), it is 1?^-conjugate to g^ with some <^ei2(a, r^). Lastly assume 
condition (iii). We may suppose that 
b = Omodp^-'\ 
c = Omodp^-'"-'^ 
Then 
_i 
[a-\-c 
—a-\-d-\-b — c 
ugu --[': 
c-^d 

252 
6. Traces of Hecke Operators 
withM= 
^ G/^;,and 
-a + 
d-\-b-c^Omodpf''^K 
This implies that ugu~^ satisfies (i) and it is Rp""-conjugate to g^. 
D 
If V ^ 1, we put 
(6.6.7) 
w=|^^, 
l\eNiR,). 
Then for iEQioL,Xp\ 
(6.6.8) 
wg^w 
=[^v+p 
^ 
J' 
and both g^ and wgf^w"^ belong to Cp(a, r^). Lemma 6.6.3 implies 
(6.6.9) 
C>,r,)//K, - |{^^,,,^,-.|^,Q(„,,^)}//;,;, 
(,^1). 
Lemma 6.6.4. Assume v ^ 1. TTien ^ = 
eCp(a, r^) is Rp-conjugate to some 
g^ (^€0(a, rp)) if and only if 
fe^Omodp^-"^ or a-rf # Omodp^-'^ 
Proo/ The if-part was already proved in the proof of the (3) => (4) of Lemma 6.6.3. 
Now assume that 
h = a-d = Omodp''^\ 
and 
ugu-'=g^ 
r 
c' ^. Mp^^^^(<^'^p)) 
Since c = Omodp""^^ by Lemma 6.6.3, we see 
g^ = ugu~^ 
^ r* 
{-a'b'ia -d)^ 
a'H}l(a'd' - 
b'c')^^^.^p 
Since 
-a'h'{a -d)-\- a'^h = 0 modp^-'S 
this contradicts the definition of ^^. 
D 
Lemma 6.6.5. Let ^, r\ he two elements ofQ((x, Xp). 
(I) g^ and g^ are Rp-conjugate if and only if 

§6.6. Local Conjugacy Classes 
253 
(2) Suppose V ^ 1. Then g^ and vv^^w"^ are Rp-conjugate if and only if ^ and rj 
satisfy the following two conditions: 
(i) t^-4n^0modp^^^' 
or 
fMi^Omodp'^^''^\ 
(ii) ^ = 
t-rjuiodp^^P. 
Proof (1): First suppose ^ = ri modp^"^^. Then 
and 
ug^u ^ = g^. 
Conversely assume g^ = ug^u ^ with ueRp . Since 
g^-i 
= Omodp'', 
we see 
p-^(g^-i)^Rp, 
so that 
p-'{g,-i) 
= 
up-^(g^-i)u-'eRp. 
Since u is congruent modp" to an upper triangular matrix, we get 
p-^(^-^) = Omodp\ 
Thus rj = i modp"'^^. (2): By definition, we have 
»..»--[;.-.: -""'^^-'''j.c,,...,.. 
By Lemma 6.6.4 and an argument similar to (1), g^ and wg^w~ ^ are Rp -conjugate if 
and only if they satisfy 
(i') fM # Omodp^-'^p-Hi or 2?/ - t # Omodp^-'S 
(ii) i = 
t-rimodp'^^. 
Since 
t == rj-\-{t — rj) and ri{t —rj) = n modp^'^^^, 
we see 
t^-4n 
= 
i2rj-tfmodp''^^^. 
Therefore (i') is equivalent to (i). 
D 
Now we assume ^(a, r^) # 0 and let i be an element of Q((x, r^). Then 
r^-4n = (r-2(^)2 modp^-'^p 
Therefore we obtain 
(6.6.10) 
r2-4n = 0modp2p 
by the definition of Q{a, Xp). Conversely suppose that a satisfies (6.6.10). If {eZ^ 
satisfies 
/„({)^Omodp^^^ 

254 
6. Traces of Hecke Operators 
then 
r - 2 ^ = 0 mod p^. 
Therefore 
,^^,,, 
^ , 
, 
f {^GZ,|/,(^)^0modp^ + 2^}, 
I / r 2 - 4 n ^ 0 m o d p 2 ^ 
(6.6.11) 
Q(<x,Xp)= < 
. 
I 0 , 
otherwise. 
Further we put 
(6.6.12) (2'(a,r^) = 
_ r {<JeZp|X((^) = 0modp^-'2^-'^}, i/f^-4n = Omodp^^-'i 
andv^h 
1 0 , 
otherwise. 
Then we have the following 
Theorem 6.6.6. Assume v ^ 1. Let OL he a non-scalar element of Rp, and fo,{X) 
= X^ — tX -\-n the principal polynomial of a. For any order XpOf Qloc] including 
Zp[a] such that 
[rp:Z,[a]] = p ^ 
we can take as a complete set of representatives of Cp{oL, Xp)//Rp the set 
where Q/p^'^^ (resp. Q'/p^'^^) is a complete set of representatives of Q{a, r^) 
moA p'^-^Piresp. r2'(a, tp)mod/7^+^). 
Theorem 6.6.7. IfRp = M^{lLp\ then |C^(a, r^)//K; | = 1. 
Froof. 
Since any order r^ of Qp[a] is a Z^-free module, we can write 
tp = ^ p [ « 
with 
j?eQp[a]. 
Put 
P = a-\-b(x 
{a,beQp). 
Then Cp((x,Xp)//Rp corresponds bijectively to Cp(P,Xp)//Rp through the corre-
spondence "^ !-• a + bg'\ Since 
[rp:Z,[«] = l, 
we see that 
p = 0, and 
^(ftrp) = Zp. 
Therefore by Lemma 6.6.5(1), we obtain 
ic,(a, X,)//R; I = |c,(A X,)//R; \ = i. 
n 
Next we consider the case when p divides dg. Then Bp is a division algebra, and 
K^ = {ae5^|iV5^(a),trB,(a)6Z^} 
is a unique maximal order of Bp by Lemma 5.2.3(1). Therefore, for any non-scalar 
element a of B^ , we see 
Cp(a) nRp^ 
0 
if and only if a e Rp. 

§6.6. Local Conjugacy Classes 
255 
Let a be a non-scalar element of Rp. Since Qp[a] nRp is a. unique maximal order of 
QpM» we see 
Xp is the maximal order of Qp[a], 
otherwise. 
(6.6.13) 
|CJa,rJ//fi;| 
fl, if 
[0, ot 
Since any two-sided ideal of R is given by nlRpinlRp = pRp, n ^ 0), and 
Bp= [jn;"R, 
n = 0 
we get 
(6 6 14) 
B = I'^p^^^^P' 
^^P ramifies in Q^M, 
' 
\Qplor\Rp^npQpl(x]Rp, 
otherwise. 
Since p ramifies in Bp by assumption, p does not spHt in Qp[a]. Taking this into 
account, we obtain the following 
Theorem 6.6.8. Let Bp be a division quaternion algebra, Rp the maximal order ofBp, 
and a a non-scalar element ofRp, For an order Xp o/Qp[a], we have 
C>,rJ//R;= ^ 
0, 
ifXp is not maximal, 
{a}, 
ifXp is maximal and p ramifies 
in Qp[a], 
{a, UpOLUp^}, ifXp is maximal and p remains 
prime in Qp[a]. 
Now using (6.6.1), Theorem 6.6.7 and Theorem 6.6.8, we calculate the right-
hand side of (6.5.7) and obtain 
(6.6.15) 
Z 
x(9) = vYl\ 
I 
Zp(«)+ 
Z 
Xpit-i) 
ge{T^nCAo^,x))//U 
(6.6.16) 
Here N is the level of R;t = tr(a); Q = 0(a, r^), Q' = Q'((x, Xp); and 
0 
if a € r^, Xp ^ max for some /7|JB, 
2^+" if a € ^^ Xp = max for all p\dB, 
1 
if Of € r \ 
2 
if a e T^, 
where the integer M for a e T^ is given by 
(6.6.17) 
u — #{prime numbers unramifled in Q[a]}. 

256 
6. Traces of Hecke Operators 
§6.7. Class Numbers of Orders of Q[a] 
In this section, we calculate the class number h{x) of an order r of Q[a]. 
Lemma 6.7.1. Let p be a prime number. 
(1) Let K = Q(.^) 
be a quadratic field with discriminant d, XQ the maximal order 
ofK, and x an order ofK. Put 
and 
Xp = X®jI.p. 
If 
then 
[r„Vt;] = P ^ ( l - ( ^ ) p - ' ) 
where (—) is the Legendre symbol. 
(2) Let 
XQ=ZpXZp, 
and X be an order of Hp. If 
[ro:r] = p^ 
(e > 0\ 
then 
[ro^r'<]=p»(l-p-'). 
(3) Ut 
£p = Q,M 
(«' = 0), 
and Xi^Xzbe two orders of Ep. Ifx^ ^ X2 and 
[ri:r2]=p^ 
(e>0), 
then 
[ r r : r n = P'. 
Proof We begin by proving (2). By Lemma 6.6.1, we have 
x = Zp-\- P^XQ = {(a, b)eXo\a = b modp^}. 
Since 
to" = z ; X z ; , 
we see 
xs/x^^(z/p^zr 
by the correspondence "(a, b) i-> a/b'\ Therefore we get 
Next let us prove (3). We can write 
ri = Z. + p-^Z_8 and 
X2 = Zp +p'^-^ZpS 

§6.7. Class Numbers of Orders of Q [a] 
257 
with some integer/by Lemma 6.6.1. Thus 
r r = Z ; + p ^ Z ^ £ 
and 
x^ =Z; -h p'^-^Z^e, 
so that 
through the correspondence "a + p^bsh-*b/a'\ Therefore we get 
[tr:tn=P'. 
Lastly we are going to prove (1). Put 
If p splits in K, then 
so that this case is reduced to (2). Assume that p remains prime or ramifies in K. 
The Kp is a quadratic field over Q^, and 
by Lemma 6.6.1. Then the sequence 
1 ^ Z;/(1 + p^Zp) -. ro^,/(l + p^xop) - toVr; -. 1 
is exact, 
|roV(l+P^WI = |(ro>^ro,)^| 
{
p^^(l — p^^) 
(p: remains prime), 
p^^(l —p~^) 
(p: ramifies) 
and 
iz;/(i + p^Zp)\ = i(z,/p^z,)^ I = 
p%i-p-'\ 
so that we get (1). 
D 
Class numbers are given by the following 
Theorem 6.7.2. (1) Let K = Q{^) 
be an imaginary quadratic field with discriminant 
d, XQ the maximal order of K. If x is an order of K and 
[ro:r] = n, 
then 
Hx) = ''•"!?.('-(?>"•) 
[ro^:t^] 
where hj^ = /i(to) is the class number of K. 
(2) Let H = Q X Q, and x an order ofH. If 
[Z X Z:r] = n, 
then 
h(x)=nY\(l-p-'). 
p\n 

258 
6. Traces of Hecke Operators 
(3) Let E = Q[£] (e^ = 0). Ifx is an order of E, then 
h(x)=L 
Proof. (1): By definition, we see that x^+ =x^ and 
= V l r o V r ; i - | ( K ' ' n r o ^ ^ ) / ( K ^ o r ; ) r ' . 
Since K is imaginary, we see 
X^nro'^ = ro' 
and 
K " n r ; = r \ 
This combined with Lemma 6.7.1(1) implies (1). (2): Put 
ro = / X Z. 
Similarly as above, we have 
h(x) = 
\H:i/H^xSA^\'\xSAjxl.\'\{H''nx^^^)/{H^nx^^)\-K 
Lemma 6.6.1 implies 
r = {(a, b)exQ\a = b modn}, 
so that 
H^nro^^ = / / ' ^ n r ; = { ( l , l ) , ( - l , - 1 ) } . 
Moreover, since 
Q; = Q ^ z;, 
we see 
Therefore we get 
p\n 
by Lemma 6.7.1(2). (3): We see 
r = {a + 
tbe\a,beZ} 
with some tGQ"" by Lemma 6.6.1. Since 
£ J ; = Q ; ( I + Q^£), 
£^ = (Q^(H-Qe), 
and 
r ; = Z ; ( l + t Z ^ 8 ) , 
we see that x^+=x2 and 
/i(r) = | £ ; / £ ^ r ; i 
= 1(1 + Q^6)/(l + Q8)(l + tZ^s)\ 
= I Q A / ( Q + ZA)I = 1. 
D 

§6.8. An Explicit Formula for tr(r(n)) 
259 
Remark 6.7.1. As for the class number hfr, see [Borevich-Shafarevich]. When K is 
an imaginary quadratic field, we easily see 
{±'i, ± \ / 5 t | 
if K = Q ( y ^ ) and r is maximal, 
{±1, ±e"'/^ ±e2"'/3} if K = Q ( y ^ ) and r is maximal, 
{± 1} 
otherwise. 
§6.8. An Explicit Formula for tr(r(n)) 
Finally in this section, we present an explicit form of tr( T(n)). First we calculate the 
terms for elliptic a's. 
Lemma 6.8.1. Let K = Q(^/5) be a quadratic field with discriminant d, and XQ the 
ring of integers ofK. For an element (xofxQ(oLtZ),letX^ 
— tX-\-n be the minimal 
polynomial of a. Ifm is the positive integer given by 
t^ -4n = m^d, 
then 
[ro:Z[a]] = m. 
Proof It is easily seen that XQ = Z-\-ZS 
with S = (d -{- y/d)/2. Put oc = I-\-mS 
(/, meZ), then r^ - 4n = m^d. Since Z[a] = Z[m^], we get [to: Z[a]] = m. D 
Notation being as above, we suppose that K is imaginary. For any positive 
integer/, there uniquely exists an order r of K such that [roir] = / ; in fact, 
r = Z +/ro. We put 
h(pd) 
= h{x\ 
w(/2^) = |r^|. 
Then Theorem 6.7.2 implies 
Hpd) 
h(d) 
w(pd) 
w(d) ^PX-©'-') 
Let a be an element of T^. Then Q [a] is isomorphic to an imaginary quadratic 
field Q(>/5) with discriminant d. Let f^(X) = X^ — tX-{-nhQXhQ minimal poly-
nomial of a. We define m (> 0) by r^ — 4n = m^d. Then by Lemma 6.8.1 combined 
with (6.5.3) and (6.6.15), we obtain 
(6.8.1) 
X l{x)h(x) 
X 
x{g) 
Z[a]c:r 
ge{T^nCA<x.,x))IIV 
=2" z S ^ n i I z,(«)+ z x,(t-o 
0 < / | m ' ^ U 
(^) p\N \^eQlp''^'' 
S^eQ'lp"-^" 

260 
6. Traces of Hecke Operators 
where r runs over all orders of Q[a] including Z[a], and p = ordp(m//) 
(=max{MeZ| 
p^\{mlf)}). 
Now take T{n) for T. Then Lemma 5.2.5, (6.5.6) and (6.8.1) imply 
(6.8.2) 
Y. 
xMkMlia) 
aeTinr//r 
^fc - 1 
/-fc - 1 
0<f\m^U 
^) p\N l^eQ/p^^" 
^ea'/p^-"" 
J 
if,dB) = i 
Here ^, f are the roots of X^ — tX -\- n = 0; for each t, m (> 0) is given by 
t^ — 4n = m^d with the discriminant d of the quadratic field Q(C); p = ordp(m//); 
for p, t a n d / and Q and (2' are given by 
(6.8.3) 
Q = Q{tJ,p) = {ieZ^\i^ 
- ti ^ n 
^Omod{mlffNT^], 
and 
(6.8.4) 
Q' = 
Q'(tJ,p) 
={ 
{i€T,\^^ 
-t^ 
+ n^O modpim/ffNZ^}, 
ifdf^ 0 modp, 
0 , 
otherwise. 
Let us proceed to the case T^. The following lemma is easily proved. 
Lemma 6.8.2. Let H = Q x Q,XQ = Z x Z.OCEXQ - Z, and let X^ -tX 
-\-nbe the 
minimal polynomial of a. Then 
t^ - 4n = m^ 
(m > 0), 
and 
[ro:Z[a]] = m. 
Let a be an element of T^. Then Q[a] :^ Q x Q. Similarly to the elHptic case, 
Lemma 6.8.2 and Theorem 6.7.2(2) imply 
(6.8.5) 
X li^)h{r) 
I 
X(g) 
Z[a]cr 
ge{T^nCAo^,x))//U 
= i z </>(/) n I I x.(^)+ I 
xAt-o 
^0<f\m 
p\N A^eQ/p'^" 
^eQ'lp'^" 
where </> is the Euler function. 

§6.8. An Explicit Formula for tr{T{n)) 
261 
Take r(n) for r,thenweobtain by Leinma5.2.5, (6.5.4), (6.5.6), and(6.8.5) that 
(6.8.6) 
X 
xMHoi)m 
oiennflir 
^ 
teZ 
\^ ~ U 
0 < / | m 
p|iV Uefl/p^-^" 
^eQ'lp"^" 
) 
Here ^/, C are the two roots of X^ — tX -^n = ^\ t^ — 4n = m^ (m > 0); 
p = ordp(m//); for p, t and /, ^ and Q' are given by (6.8.3) and (6.8.4) with d = 1. 
Now let a be an element of T^, rj a unique eigenvalue of a, and put e = OL — rj. 
Then 6^ = 0, and Q[a] = Q[e]. Since fy is a rational integer, we have 
Z[a] = Z[e]. Therefore any order of Q[a] including Z[a] is given by 
r(/) = Z + j z e - 
(/=1,2,...). 
An easy calculation shows 
|m(a,r(/)^)| = //|f7|. 
Thus by Theorem 6.7.2(3), (6.5.3) and (6.6.15), We get 
(6.8.7) 
X 
IMHx) 
X 
xig) 
Z[a]er 
ge(r,nQ(a,r))//C/ 
1 ^liM/iy^' 
E 
xig) 
p\N 
Here X(^) = ^^ — ^^ + w is the principal polynomial of a; ?; is a unique root of 
/«(jr) = 0;and 
(6.8.8) 
Q = Q(rj,p,p) = {ieZ,\i 
^ rjmodp^<^^'^''^^^Z,}, 
(6.8.9) 
Q' = 
Q'(ri,p,p)=={ieZ,\i^rjmodp^^'^^^^^'Z^}. 
Take T(n) for T. If n is not square, then T(nY = 0. Let n = ri^ (rjeZ), and 
m^ = YlpP^ ^^ the conductor of x- Then e ^ v, so that 
(6.8.10) 
y 
(^)=i^' 
ifp|n,orp^n 
and [(v + l)/2] + p < e, 
^ e 4 - ^ ' 
1 Zp(^)P^-^^^^^^^^^, otherwise. 

262 
6. Traces of Hecke Operators 
and 
(6.8.11) 
fO, 
if p\n or pj^n and [v/2] + p + 1 < e, 
l e i ; , - ^' 
"
1 
X.Mf-''"'-'^ 
otherwise. 
wg^w'^ €T(n)P 
Therefore by (6.5.6) and (6.8.7), we see that 
(6.8.12) 
X 
xMk(oc)l(oc) 
(xeT{nYlir 
= 2^(5+1) I 
\r}\^^Hgn(rifx{n)n"'-' 
X n 
( n" " f^" "^ 1)/^^ - M(s + 1) _|_ pv - [v/2] - 1 - n'(s + 1)\ 
where 
/z = m a x { 0 , e - [ ( v + l)/2]}, 
/x'= max{0,e - [v/2] - 1}. 
Hence we obtain 
(6.8.13) 
lim 
YJ 
X(a)^(a)'(a) 
= 2 Z sgn(f/)*x(^)w^*"'^/^n(P'"^^'"''^^'^"'' + P'"^'^^^"'"^')-
^ t}^ = n 
p\N 
The calculation of tr(7(n)) is completed if we know the volume of T \H, which 
is given by the following 
Theorem 6.8.3. Let B be an indefinite quaternion algebra over Q with discriminant 
dg, and R an order of B of level N. Then 
t^(/^i.\H) = ^ivn(i+p-^)n(p-i)-
^ 
P\N 
P M B 
Proof If R is maximal, then it is known that 
(6.8.14) 
v(r^\H) 
= ^ ^ l \ ( p - l l 
C(2) = n'/6. 
(For the proof see [Shimizu 3]). We note that if dB= 1, namely 5 = M2(Q), then 
(6.8.14) is nothing but Theorem 4.1.2(2). The result for arbitrary order follows from 
(6.8.14) and Lemma 5.3.2. 
D 
We write down an exphcit form of tr(r(n)). 
Theorem 6.8.4. Let B be an indefinite quaternion algebra over Q with discriminant 
ds, R an order of B of level N = flpPMC^,^) = 1), r^ = {^eK^ {Nsiy) = 1}, 

§6.8. An Explicit Formula for tr(r(n)) 
263 
1 a Dirichlet character mod AT, m^ = YlpP^ ^^^ conductor of x, and T(n) the Heche 
operator defined by (5.3.12). Then 
tr(r(n)) = tr(r(n)|y;(r^,Z)) 
:(y«) 
k - \ 
12 n'i^-'NY\(\+p-')Y\{p-\) 
p\N 
PMB 
-Y,a(t)Y^b(tJ)c(tJ). 
t 
f 
Each term is as follows. 
1° We understand x(V") = 0 i/n is not square. 
2° t runs over all integers such that t^ — 4n are negative or square. For such a t, 
let C, ^ be two roots of X^ — tX -\- n = 0, and put 
d = 
the discriminant ofQ{^t^-4n), 
ift^-4n<0, 
1 
if t^ — An is a positive square, 
0 
ift^-4n 
= 0. 
Then we put 
fc - 1 
^ k - 1 
imindcrM^/r^} 
a(t)=i 
\C-rj\ 
X{t/2)sgnitfn^''-'^/^ 
0, 
where 
u=#\ 
ifd z^{),\andl-\i^\for 
any prime 
factor p ofdB, 
sgn(0*, 
ifd=l, 
d^=h 
ifd = 0, 
ds=l 
otherwise (dg^l and either d = 0 or 1), 
prime numbers p\ plds, ©=-l 
3° / runs over all positive divisors of m, where m is a positive integer given by 
r^ — 4/1 = ni^d ifd ¥= 0; otherwise m = 1. For such an f 
bit, f) = 
h{d) 
w(.d) pi^ 
/ n (l - ( ^ ) P"') . 
ifd < 0, (/. ds) = 1, 
0 
ifd<0, 
( / , d B ) ^ l . 
0(/), 
ifd = 1. 
1, 
ifd = 0, 

264 
6. Traces of Hecke Operators 
where h(d) is the class number ofQ(y/d\ 
and w(d) the number of units in Q{^/d), 
namely 
' 4, 
ifd=-4, 
w(d) = < 6, 
ifd=—3, 
2, otherwise. 
and (j) is the Euler function. 
4° For each prime factor p of AT, and each positive divisor f of m, we put 
Q = Q{tJ,p) = {^eZ,|(j2 -t^-^n^ 
Omod{m/f)'NZ^}, 
Q' = 
Q'(t,fp) 
( {(JeZ^|(^2 -ti-\-n 
= Omodp(m/ffNZ^}, 
ifdf= Omodp, 
I 
0 , 
otherwise. 
Then 
c{tj) 
= < 
1, 
ifN=l 
n l 
I 
xAi)+ 
I 
Xp{t-i)\ 
ifd^o,N>i 
where 
]-[(pV-[(v+i)/2]-,._^^v-[v/2]-i-M')^ 
ifd=.0,N>l 
p = ordp(m//), 
M = max{0,e-[(v + l)/2]}, 
/i' = max{0,e- [v/2] - 1}, 
and Xp is the character of (Zp/NTpY 
induced from %- ^e note that ip(a) = 0 if 
(a, N) ^ I for aeZp (even ifxp is trivial). 
Remark 6.8.1. Though we have assumed /c ^ 3, a similar consideration using 
certain limit process is appHcable to the case when k = 2 (see [Ishikawa]), but it 
needs the knowledge of infinite dimensional representation theory of SL2{U). 
Another method by Eichler enables us to calculate traces for the case when fc = 2 
([Eichler 4], [Saito]). In any case, we can also calculate tr(r(n)) for the case when 
k = 2. We state the results without proof. 
Ifx is not trivial, then the above formula holds. Otherwise, tr( r(n)) is given by the 
above formula with the additional term 
S(N,n)= 
^ 
where n = I~[pP'. 
j + i 
p\n 
y 
UP'U 
p\n 
p\n 
p\N 
PXN 
. 1 + 1 
( N = l ) , 

§6.8. An Explicit Formula for tr{T{n)) 
265 
Remark 6.8.2. When B = M2(Q), we have FR = ToCAT), and T{n) is the Hecke 
operator defined by (4.5.4). 
Theorem 6.8.4 is still somewhat complicated to calculate in a general case. In 
many cases, we can still simplify it. As an example, we write down here, without 
proof, a computable formula for the special case when T = ToCA^) with N = pq" 
{p,q: odd prime numbers, v ^ 0) and (n,N)= 
1. Furthermore we assume that x is 
induced by a Dirichlet character modp and satisfies x{— 1) = (— 1 )*• Then 
tr{T(n)\^,(Na)) 
(V = 0), 
-xiy/nW'-'^^-
X < 
- 
Z 
ix(t) + 
xin/t))t'-'xi 
t\n 
-
0<t 
<y/n 
q^-'iq+l) 
(v>0), 
1 
(v = 0), 
^v/2_^^v/2-i 
(y:even>0), 
Iq^'-^^l^ 
(viodd), 
1 
(v = 0), 
^[v/2]_^^[(v-l)/2] 
( 0 < V ^ 2 T ) , 
2q' 
(2T < V), 
- 
I 
a,(t)Y^b(tJ)c^{tJ)xW 
]\l\ 
teZ 
f 
[Cg(tJ) 
( V > 0 ) , 
t^ 
-4n<0 
U(pq\nl 
i 
j o , 
c 
ifk = 2, and x is trivial, 
otherwise. 
We explain each term, T = ord^(n/^ — t). For each integer t satisfying t^ — 4n< 0, 
a^it) is given by 
%(0 = 
k - 1 _ ^k- 1 
C-ri 
where C and r] are the roots of X^ - tX + n = 0. For example, 
^2(0=1, 
a^{t) = t, a^(t) = t^-n, 
a^it) = t(t^ - In), 
a^(t) = 1"^ - 3nt^ H- n^ . . . , 
a,2(t) = r'^ - 9nt^ + 2Snh^ - 35nh'' + ISn'^t^ - n^ etc. 
The summation Z / is taken over all positive divisors / of m, where m is the positive 
integer given by 
t^ -4n = m^d 
with the discriminant d of Q(^t^ — 4n); Cp(tJ) is the p-component of c{tj\ or 

266 
more explicitly, 
6. Traces of Hecke Operators 
CpitJ) = -{ 
ifpu(^]=-h 
0, 
X(a), 
ifp)(f.p\d, 
2x(oi\ 
ifp\f. 
where a and P are the roots oi X^ — tX -\- n = 0 mod p. We note that if p I m and 
- 1 = 1, then X^ — tX-\-n = Omodp has two roots in Z/pZ andif p|(im,then 
Pj 
X^ — tx-\-n = Omodp has a multiple root. Lastly cAt.f) is given by the following 
table with /i = oxdq(df^). 
r (t f\ -
^q\^U ) 
n = o 
2 
0 
0 < 
H<v 
2(^^/2 ^ ^ ^ / 2 - l ) 
0 
H = v 
q"'-'iq + 2) 
q^^ 
fl> 
V 
qO + ^CV"] 
^[i] + qCV"] 
'(:)=• 
'0" 
We conclude this section by giving a method to calculate eigenvalues of 
Hecke operators. Let Tbe a linear transformation of an r-dimensional vector space 
over C and AJ, . . . , a^ the eigenvalues of T. Put 
n iX-a,) 
= X''-b,X''-'+ 
••• H-(-irfe,. 
v = 1 
Since 6^ is the fi-ih symmetric function of ai,. . ., a^ and 
tr(r^) = a?+ • • • + < , 
we have only to calculate tr(r^) (1 ^ /i ^ r) in order to get b^. Now apply the 
above argument to the case when F = ^^^(iV,/) and T= T{n). Thus the calcu-
lation of the eigenvalues of the Hecke operator T(n) is. reduced to those of 
tr(r(nf). Since T(nY is a linear combination of Tim) {m\n'') by Lemma 4.5.7(2) 

§6.8. An Explicit Formula for tr(r(«)) 
267 
and Lemma 4.5.8(2), we have only to calculate tr(r(m)). In particular, for a prime 
number n = p, we easily obtain, for example, 
b, = tr(r(p)), 
fe, = {fc?-tr(r(p^)) + Z(p)p'-'r}/2, 
^3 = {tr(r(p^)) + 2x(p)p'"h 
-bl + 
b,b,}/Xetc. 

Chapter 7. Eisenstein Series 
We defined Eisenstein series as a special case of Poincare series in §2.6 for weight 
/c ^ 3. On the other hand, we also constructed the space of Eisenstein series by 
modular forms corresponding to products of two Dirichlet L-functions in §4.7. In 
this chapter, we further investigate Eisenstein series. Though the general arguments 
in §7.2 are applicable to any weight /c, we explain in §7.1 the case of weight 
k^3 
separately, since that case is easy to handle because of the convergence of the series. 
In §7.2, we generalize the notion of Eisenstein series and define Eisenstein series 
with a complex parameter s. We calculate the Fourier expansions of these 
Eisenstein series and obtain the analytic continuation on parameter s following 
[Shimura 9, 12]. 
§7.1. Eisenstein Series of Weight /c ^ 3 
For modular groups, there are two types of Eisenstein series, though they essen-
tially coincide. One is a series of which the summation is over cosets of a group, and 
the other is a series of which the summation is taken over elements of a lattice. The 
former is a special case of Poincare series and was discussed in general in §2.6 for 
weight /c ^ 3. As an example of the latter, we mention the Eisenstein series E^(z) for 
SL2(Z) in §4.1. Their relation is seen, for example, in (4.1.4). The former series 
appear in various applications of Eisenstein series, and the latter ones are easier 
for calculating Fourier expansions and are closely connected with Dirichlet 
L-functions. We shall begin with a generalization of E^iz). 
Let X and i/^ be Dirichlet characters mod L and mod M, respectively. For any 
positive integer /c ^ 3, we put 
(7.1.1) 
E,(z;x.ik)= 
t' 
Ximmn)imz + ny' 
(zeH). 
m, n= 
— 00 
Here Y,' is the summation over all pairs of integers (m, n) except (0,0). We showed 
in the proof of Lemma 4.1.5 that there is a real valued continuous function r{z) 
satisfying 
(7.1.2) 
f 
|mz + n r ' ' ^ 8 a a - l ) r ( z ) - ' ^ 
((7>2). 

§7.1. Eisenstein Series of Weight /c ^ 3 
269 
Therefore the right-hand side of (7.1.1) is convergent absolutely and uniformly on 
any compact subset of H. In particular, Ef^(z; x^ ^) is a holomorphic function on H. 
We put 
{[: :]• 
(7.1.3) 
ro(L,M) = <\ 
6SL2(/)|^ = 0modM, c = OmodL 
Then ro(L, M) is a modular group. 
=[::]-.' 
Lemma 7.1.1. Fory = \ 
e FoiL, M), 
Ekiz; 1. ^\y 
= xid)ii/id)Ek{z; i, ijj). 
Proof. We put for integers m, n, 
m' = am-\- en, 
n' = bm-\- dn, 
then 
(7.1.4) 
m(yz) -\-n = (cz-\-d)~ ^ {m'z + n') 
and 
Z(m') = z(a)z(m), W) = 
Wmn). 
Therefore we see 
(7.1.5) 
x{m)^{n){m{yz) + n)-\cz + d)-'' 
= 
X{dmd)lirn')W){m'z^nr'. 
When (m, n) runs over all pairs of integers except (0,0), so does {m\ n'). Then we 
obtain the lemma by taking the summation of both sides of (7.1.5) on (m, n) and 
(m', n'). 
D 
Applying Lemma 7.1.1 to 7= — 1, we obtain 
(7.1.6) 
, / ; ^ ( _ i ) ^ ( _ l ) ^ ( _ l ) ^ , 
then 
E,{z; x,i^) = 0. 
Hereafter we assume 
(7.1.7) 
;^(_1)^(_1) = (_1)^ 
We easily see the following 
Lemma 7.1.2. £,(z; z, ^A)l.p 
Q ] = Xi-1)£.(^; 
^. xl 
We are going to calculate Fourier expansions of Ej^(z; x^^)- Since the 
right-hand side of (7.1.1) is absolutely convergent, we can exchange the order of 
summation. Thus 
(7.1.8) 
£,(z;z,.A) = C + 2 X Z(m) I 
nn){mz + n)-\ 
C 
m= \ 
n= — 00 
0 
(Z # Zo). 

270 
7. Eisenstein Series 
where Xo is the principal character and L^is, if/) is the Dirichlet L-function. We 
rewrite (4.1.12) into 
(7.1.9) 
E (z+ «)-* = i ^ - ^ I «'-^e^"'". 
« = - o o 
[K— i)\ 
n=l 
Let m^ be the conductor of \j/, and \j/^ the primitive character associated with \j/. 
Put l = M/m^, then by Lemma 3.1.3, 
(7.1.10) 
f 
(A(n)(mz + n)-'^ 
n = 
— 00 
w-k^'v^^ ,, , ^ 
/mz + a 
^"'^ 
(-2nifW{il/'') 
M'ik-1)\ 
where W^(i/<^) is the Gauss sum of ij/^, and 
(7.1.11) 
b(n)= 
X 
dKWrWdmn/d) 
0<d\(l,n) 
with the Mobius function /i. Substituting (7.1.10) into (7.1.8), we obtain 
Theorem 7.1.3. Assume /c ^ 3. Let x ^nd \j/ he Dirichlet characters mod L and 
modM, respectively, satisfying x( — 1)<A(~1) = (~1)*- Let m^ he the conductor ofxj/, 
and \j/^ the primitive character associated with i//. Then 
E,{z;x.ik) = C + A f 
a(n)e^--/^ 
where 
A = 
2(-2nifW(il/'^)/M^(k-l)l 
1 
0 
i»iv .'A) (x'-the principal character), 
(otherwise), 
«(«)= z z(«/c)c'-' I 
dti(iid)rm)r{.cid). 
0<c\n 
0<d|(/,c) 
/fere l^M/m^ and fi is the Mohius function. In particular, Ef,{z; x,^) is holomorphic 
at 00. 
We observe that if ^ is primitive, then 
(7.1.12) 
a{n)= ^ 
xin/c)iii{c)c'-K 
0<c\n 

§7.1. Eisenstein Series of Weight k^3 
271 
For a fixed fe ^ 3, let/(z; x, ij/) be the modular form defined in Theorem 4.7.1. 
Then for primitive characters x and ij/, we have 
(7.1.13) 
E,(Mz; x.«A) = Afiz; x,H 
A = 2(-2Kif 
W(il/)/M'ik-1)!. 
Now we are going to prove that £^(2; x, ^) is also holomorphic at all cusps, and 
therefore it is an integral modular form. Let AT be a positive integer. For two 
integers jU, v such that 0 ^ ^, v < N, we put 
(7.1.14) 
£,(z;/i,v;iV)= 
Y 
(mz+ «)"*. 
Here ^' implies as usual that we omit m = n = 0 from the summation when /x = v = 0. 
Let y= 
, eSL2(Z)- If w and n are integers satisfying m = /imodiV and 
{c 
d] 
n = V mod AT, then by (7.1.4) we have 
(7.1.15) 
m(7z) + « = (cz + d)-^(m'z + n') 
and 
(7.1.16) 
m' = am-i-cn = a^-\- cv 
mod N, 
n' = bm + dn = b^-\- dv 
mod N. 
Therefore 
(7.1.17) 
E,iz; n,v; N)\,y = E,(z; /i',v'; N) 
(yeSL2(Z)), 
where /x', v' are integers (0 ^ ju', v' < iV) given by 
(7.1.18) 
(/i',v') = (/i,v)y mod AT. 
In particular, if y e r(N\ then 
£fc(z; //,v; Ar)!^^ = E^{z; ^,v; N). 
We also note that for a positive integer /, 
(7.1.19) 
E,{z; //i, Iv; IN) = /-%(z; fi, v; AT). 
Now we put 
(7.1.20) 
<^i'\r(N)) = <£,(z; /i,v; N)|0 ^ /x,v < N>, 
(7.1.21) 
<^i'\r(N)) = 
(E,(^z;x.A 
where X,«AJ"»^ iii (7.1.21) are such that 
X» ^^u,v ), 
(7.1.22) 
X ^''^ ^ ^''^ Dirichlet characters mod L and mod M/or divisors L and M 
of N, respectively; 
(7.1.23) 
u and v are positive integers satisfying uL\N and vM\N. 
By (7.1.17) and (7.1.18), 
(7.1.24) 
(^i^\riN)) is stable under the action ofSLjiZ). 

272 
7. Eisenstein Series 
Lemma 7.1.4. ^i'\riN)) 
= (Tf >(r(Ar)). 
Proof. Let x, <A» " and v be as in (7.L22) and (7.L23). Then 
(7.L25) 
EJ-Z; X, A = v' f' 
x(m)iAW(mMz + m)"* 
u\n,v\v 
= t^* 
Z 
xMu)il/(v/v)Ek(z; /I, v; iV). 
0 ^ /i, V < N 
u|^,t;| V 
This impHes that ^i^\r{N)) ^ ^i^\r(N)). Let /z, v be integers such that 0 ^ )U, 
V < N. Put M = (/i,iV) and v = (v,N). Further put ^' = fi/u, v' = v/v, L = N/u, and 
M = iV/t;. Then 
(7.L26) 
E,(z; /i, v; N) = 
Y 
('""^ + «^)"' 
m = fi' mod L 
n = v' mod M 
= {<^(L)<^(M)}-i 
f 
Xz(/^')"A(v')z(m)^(«)(muz+ «<;)-' 
where Y,x, ^ i^ipli^s the summation over all characters x mod L and ij/ mod M. This 
implies that ^i^\r(N)) cz S^^\r{N)). 
D 
Lemma 7.L5. ^li>(r(Ar)) c: ^„(r(N)). 
Proof. By Theorem 7.1.3 and Lemma 7.1.4, all elements of (^i^\r{N)) are holo-
morphic at co. Let g{z) be an element of <^[^^(r{N)). For any yeSLjC/), gl^y is 
holomorphic at oo, since ^1^7 belongs to S[^\r(N)) by (7.1.24). Therefore g(z) is 
holomorphic at any cusp of r(N). 
D 
In particular, E^iz; /, i/<) is an integral form for any Dirichlet characters x and ij/. 
We are going to prove that (^[^\r{N)) coincides with the space of Eisenstein series 
jV^(r(N)) defined in §2.1. To prove this, we define Eisenstein series of Poincare 
type. Let x be a Dirichlet character mod N. We put 
^1ll^ 
F* i 
^ J ^ 
Xid)icz + d)-' 
i f x ( - l ) = ( - l ) ^ 
(7.1.27) 
Elff(z;x) = {yer^\r 
0 
ifx(-l)^(-l)*, 
r* *1 
where T = ro(iV) and y = \ 
. \. This is nothing but the Poincare series at oo 
Ic d_\ 
defined in §2.6. More precisely, if x(—1)=(— 1)*, then 
(7.1.28) 
£? »(z;x) = F,(z; <i>o,X,r^J) 

§7.1. Eisenstein Series of Weight fc ^ 3 
273 
with the constant function 0o(2)= 1. Therefore Ef^j^(z\ y) belongs to jV'ui^, %) t>y 
Corollary 2.6.12. To express the summation of the right-hand side of (7.1.27) more 
expHcitly, we need the following 
:[* *^^(c,d)U 
Lemma 7.1.6. The correspondence: 
\\-^{c,d) induces the following bijections: 
(1) ro{N)^\ro{N) ^ {(c,^)|c ^ 0modN, (c,d)=ld>0}; 
{(cj)\c = 0 mod N, d=lmodN, 
(c,d)=i} 
(N ^ 3), 
I {(c,d)\c = 0modN, 
d= 1 modN, (c,d)= 
Ud>0} 
[ 
(N = l,2). 
Proof. It is easy to see that the mapping is well-defined and surjective in both cases. 
Let us prove the injectivity. Let y = \ 
\ and y' = \ 
j \^^ ^^^ elements of 
ToCN) (resp. r(N)) having the second row (c, d) in common. Then by a direct 
calculation, we see 
yy • = C : } 
which belongs to FoiN)^ (resp. r(N)^). This implies the injectivity. 
D 
This lemma implies that when ;f(— 1) = (— 1)*, 
ElsU;x)= 
I 
x(d){cz + d)-\ 
c = 0 mod TV 
{c,d)=\,d>0 
and therefore, for any Dirichlet character x niod N, we obtain 
(7.1.29) 
El^(z;x) = \ 
Z 
xid)(cz + dy\ 
•^ c = 0 mod N 
ic,d)=\ 
Thus 
(7.1.30) 
E,(Nz; Xoa) = 2L^(/c, x)El ^(z; x) 
for the principal character Xo> and 
(7.1.31) 
E,(z; 0,1; iV) = ^ | ; L ^ ( / C , X ) £ , % ( Z ; X) 
by (7.1.26), where x runs over all characters mod AT. Since £^,^(z;x) belongs to 
J^kir{N)) by Theorem 2.1.7(2), we see 
(7.1.32) 
E,{z;OA;N)e^,ir(N)). 

274 
7. Eisenstein Series 
Theorem 7.1.7. Ifk^3, 
then 
Proof. We see by (7.1.17) and (7.1.19) that ^[^^ {r(N)) is generated by 
{£,(z;0, 1;L)|,7 | L|iV, yeSL^i 
Since 
£,(z;.0, 1; L)e^,(r(L)) c: ^,(r(iV)), 
we see Sj,^^ {r(N)) cz jr^{r(N)). Let us prove ^fc(r(iV)) c= ^^i)(r(N)). First by 
Lemma 7.1.6(2) and (7,1.29), we see 
(7.1.33) 
F,{z; cj>^, Xo. r{N)^, 
r(iV)) =C 
^ 
(^^ + ^ ) " ' 
modN 
) = i 
2C 
0(iV) , 
where 
' 1 
(N^3), 
^ 
"2 (N = l,2), 
and X runs over all Dirichlet characters mod N. Since Ej^^ ^ (z; ;f) belongs to 
^i^\r(N)) 
by (7.1.30) and Lemma 7.1.4, so does Fj,(z; (j)^, Xo> ^(A^)ao, r{N)). Since 
^JE^H^W) is stable under SLjiZ), we see 
F,iz;^o.Xo,r(N)^,r(N))\,ye^l'\r(N)) 
for 
yeSL2(Z). 
By (2.6.11) and Corollary 2.6.12, we obtain J^k(r(N)) cz ^j^^\r(N)). 
D 
§ 7.2. Analytic Continuation of Eisenstein Series 
When k is smaller than 3, the right-hand side of (7.1.1) is not convergent. Therefore 
we need some modification to discuss the case when k ^2. Though the main object 
is the case when /c ^ 2, we note that the arguments and the results here cover any 
integral weight k. 
Now for any integer k and a complex number s, we put 
(7.2.1) 
£,(2, s; X, JA) = 
T 
x(m)il^(n){mz + n)-'\mz + n\-^^ 
m,n= 
- 00 
The right-hand side is uniformly and absolutely convergent for s on k-\- 2Re(s) 
^ 2 + e (e>0). Therefore it is holomorphic on /c 4- 2Re(s)>2. We call £^(2, s; x, ^) 
an Eisenstein series with parameter s. Similarly to Lemma 7.1.1, we obtain that 
(7.2.2) 
E,{yz, s; x, lA) = x{d)if(d)(cz + df\cz + d\^'E,(z, s; x. ^A) 
[::]-
(L, M). 

§7.2. Analytic Continuation of Eisenstein Series 
275 
As was mentioned above, if fe ^ 2, then the right-hand side of (7.2.1) is not defined 
for s — 0. But if £fc(z, s\x^^) is continued analytically to s = 0 and holomorphic at 
s = 0, then we will obtain a modular form even for weight /c = 1 and 2. The purpose 
of this section is the investigation of the analytic continuation of E^fe s; x,^) and 
its property as a function of z and s. Since we easily see that 
if x(-l)H-^)^i-^)\ 
then JS.Cz, s; z, lA) = 0, 
we assume 
(7.2.3) 
;^(_l)^(_l) = (_l)fc 
throughout this section. We also see 
(7.2.4) 
E,(z,s;x,il/) = xi-m-k{-^.k-\-s;x,ik) 
if /c + 2Re(s)>2. 
When k + 2Re(s) > 2, we can exchange the order of summation of the right-
hand side of (7.2.1) and see 
(7.2.5) £,(z,5;x,iA) = C(s) + 2 f 
z(m) f 
i^{n)(mz + 
ny'\mz-^n\-'\ 
m = 1 
n= — ao 
where 
0 
(ZT^ZOX 
For complex numbers a and p, we put 
(7.2.7) 
S(z;a,^)= 
f 
(z + n)-'(z + n)-i> 
(zeH). 
W = 
— 00 
The right-hand side is absolutely convergent for a, j? with Re(a + j?) > 1, and 
(7.2.8) 
f il/(n)imz-\-n)-''\mz-\-n\-^' 
n= - 00 
ffiM - 1 
/ 2 
fl 
Further we put 
(7.2.9) 
4>(r,a,p;x) = {x + iyr''ix-iy)-f 
(xeU, y>0, a, peC). 
If we write z = x + iy (eH), then 
(7.2.10) 
S(z;a,/?)= 
f 
<t>(y, a, p; x + n). 
n = — 00 
We wish to apply the Poisson summation formula to the right-hand side. 
When Re(a + j?)> 1, </)(>;; a, ft x) belongs to L^ (R) as a function of x. Therefore 
there exists the Fourier transform of </), which we denote by <^(>'; a, ft t). In other 
words, 
(7.2.11) ay; a, ft t) = J </>(>'; «, ft x)^-^""- t/x 
(y > O, Re(a + )5)> 1). 
IR 

276 
7. Eisenstein Series 
This is a holomorphic function of a and P on the domain 
{(a, j?)GCxC|Re(a + j5)>l}, 
since the right-hand side is uniformly convergent on any compact subset of the 
domain. Now the Poisson summation formula implies 
(7.2.12) 
f 
(l>(y;oi,P;x-hn)= 
f 
^^--(^(y; a, ft n). 
n= - 00 
n = - o o 
To justify this formula, it is sufficient to verify the following two conditions: 
00 
(7.2.13) 
YJ \^(y*'> oc, P; x + n)\ 
is uniformly convergent for x; 
n = — 00 
00 
(7.2.14) 
X 
l^(>'' <^' ft ") I ^^ convergent. 
fl = — 00 
When Re(a + ft > 1, (7.2.13) is obvious and (7.2.14) will be shown in Theorem 7.2.8 
below. Keeping it in mind, we are going to investigate the function ^. We put 
(7.2.15) 
H' = {z6C|Re(z)>0} 
and call it the right half plane. If Zj, Z2 eH', then 
(z,Z2r = zlzl 
(aeC) 
by definition (see (3.2.1)). We define the confluent hypergeometric function 
G{Z; OC, P) by 
(7.2.16) 
(T(Z; a, ft = J e-'"(u-\-If-^ 
u^''du 
(z, j^eH', aeC) 
0 
and put 
(7.2.17) 
r](y; oc, P;t) = ] 
e-'"(u-^tY-'{u-ty-'du 
\t\ 
(y>0,teU,oi, 
PeC). 
We see easily the following properties: 
(7.2.18) 
ifriiy; a, ft t) is convergent, then so is rj{y; ft a; —t) and 
r](y;cc, P; t) == r](y; P, ot; -t); 
(7.2.19) 
ifa>0 
and r](ay; a, ft t) is convergent, then so is rj{y; a, ft at) and 
rjiay; a, ft t) = fl^-"-^ ri(y; a, ft at). 
As for the convergence of the functions rj and <T, we obtain the following 
Lemma 7.2.1. (1) Ift > 0, then rj(y; a, ft t) is uniformly convergent on any compact 
subset ofCxH'asa 
function of a and p. 
(2) The function G(Z\ OL, ft is uniformly convergent on any compact subset of 
H x C x H . 

§7.2, Analytic Continuation of Eisenstein Series 
277 
(3) //(>;, a, P)eU+ x C x H', then 
Proof. First we prove (2). Let The an arbitrary compact subset of H' x C x H'. Put 
p = min{Re(z) I (z, a, i8)er}, 
^ = min{Re(iS)|(z,a,i?)er}. 
Let p' be a number satisfying 0<p' <p, then there exist constants Cj and C2 
satisfying 
\e''"(u+ I f u ' " ' = 
K 
(«+i) 
I 
^o(«'-') 
(u^+0), 
for any point (z, a, j8)Er. This impHes J^ |e~^"(M + l)*~^M^~M^w is uniformly 
convergent on T. The first assertion is similarly proved. Let us show (3). If 
{y, a, P)eU+ x C x H', then 
rj(y;(x,P; 1)= ] e-y"{u 
+lY-'{u-l)P-'du 
1 
0 
This impHes (3). 
D 
Lemma 7.2.2. //Re(a) > 0, Re(j5) > 1 (r ^ 0) or Re(a) > 1, Re(j?) > 0 (r < 0), then 
i{y; a, ft t) = iP-'{2n)r{oi)-'r{P)-'rj{2y; 
oi, ft nt). 
Proof, We note that ^(y; a, ft t) is holomorphic for a, j5 with Re(a + j?) > 1. Now 
we see 
i(y;oi,P;t)= 
J e-^^^^'^x + iyy^^ix-iyy^ 
dx 
— 00 
- 00 
Since y±ixe H', we see easily 
(i{y±ix)y'' = 
r%y±ixy\ 
Therefore 
(7.2.20) 
^(y;oL,P;t) = i^-' J ^-2""^(};-ix)-"(}; + ix)-^f/x. 
— 00 
Assume that Re (a) > 0 and Re(j?) > 1. We put s = oi, a = y±ix in (3.2.5), then 
(7.2.21) 
(y±ix)-« = r(a)-i J e-<^±'^>"M«-^^M. 
0 

278 
7. Eisenstein Series 
Substituting this into (7.2.20), we see 
(7.2.22) 
^(^;a,ftr) 
- oo 
0 
(Re(a) > 0, Re(j?) > 1). 
Since the right-hand side is absolutely convergent, we can exchange the order of 
integration and obtain 
(7.2.23) 
=i^-T(a)-^] 
e-^'n'-^du J e'''^"-^'''\y-\-ix)-^dx. 
0 
- 00 
If we put f(x) = (y-\- ix)~^, then/(x)eL^(lR). Let/be the Fourier transform off. 
Then 
(7.2.24) 
J e'^^"-'^*^f{x)dx = 
f(~^^)-
To calculate /, we put 
('•'•'') 
^(")=io 
(u^O). 
Since Re(j5) > 1, we have g(u) e O (R). If we denote by g the Fourier transform of ^, 
then we see by (7.2.21) 
f(x) = 
r{P)-'g(xlln). 
Taking the Fourier transform of both sides, we see 
(7.2.26) 
f(u) = 
lKrm-'g(-2Tiu\ 
By (7.2.24), (7.2.25), and (7.2.26), we obtain 
(7.2.27) 
J e'^'^^-^'^'^y^ixy^dx 
— 00 
_ r27tr(j?)-ie-^^"-2"'>(M-27rO^-i 
(M>27rr), 
~ [ 0 
(M ^ Int). 
Now we assume t ^ 0. Then by (7.2.23) and (7.2.27), we see for Re(a) > 0, Re(jS) > 1, 
(7.2.28) 
^(y, a, ft t) 
= i^-«-27rr(a)-^r(i5)-^ 
J 
e-23'("-«OM«-i(M_27rf)^-i^u 
u> 2nt 
= i^-^'-inriay^ripy^ j e-^y"(u-{-nty-Hu-nt)^-'du 
nt 
= if-'-2nr(a)-'r(p)-'ri(2r, 
a, p; nt). 
We note that if t > 0 then i(y,ix, P; t) is continued to a holomorphic function of a 

§7.2. Analytic Continuation of Eisenstein Series 
279 
and i5 on C X H' by (7.2.28) and Lemma 7.2.1(1). If t < 0, then 
(7.2.29) 
ay; oi. ft t) = (-ly-^^y; 
ft 
a; |r|) 
as long as Re(a + j5) > 1 by definition. Therefore if we define ^y; a, ft t) for 
(a, j5)6H' X C by (7.2.29), it is a meromorphic function and 
(7.2.30) 
Uy; a, ft t) = (-\y-'i^-^'2nr(oc)-'r(P)-'rj{2y; 
ft 
a; |7rr|) 
= i^-''2nr(oi)-'r(P)-'ri(2y; 
a, ft Tir). 
Therefore the case when r < 0 is also proved. 
D 
When r = 0, (^ is explicitly calculated in the following 
Lemma 7.2.3. The function ^y; cc, ft 0) is continued analytically to a meromorphic 
function on C x C and satisfies 
ay;a,P;0) = i^-^'2nr{o^)-'r{p)-'r(oi-^p-i)(2yy-'-p, 
Proof When Re (a + j5) > 1, we see 
rj(y;a,P;0)= 
] e-^^u^^^P-^du 
0 
= r(a + 
p-l)y l - a - / J 
Since the right-hand side is a meromorphic function on C x C, we obtain the 
analytic continuation of the function by Lemma 7.2.2. 
D 
We shall calculate ^(y; a, ft t) for t ^ 0. The calculation of ^(y; a, ft t) is reduced 
to that of t](y; a, ft 1) by Lemma 7.2.2, (7.2.18) and (7.2.19). Furthermore by 
Lemma 7.2.1(3), we have only to consider o-(z; a, P). Now we put 
(7.2.31) 
co(z; a, P) = r(p)-'2^(7(2; a, p) 
((z, a, p)eU' x C x H'). 
By Lemma 7.2.1(2), a)(z; a, p) is a holomorphic function on H' x C x H'. 
Theorem 7.2.4. The function co(z; oc, P) is continued analytically to a holomorphic 
function on H' x C x C and satisfies: 
(1) a)(z;l-ft l - a ) = a;(z;a,i9); 
(2) a;(z;a,i5) = ( - l ) W ^ ( e - ^ z - ^ c o ( z ; a - n , i 5 ) ) 
{neN). 
Proof For a, )?eH' and Z6IR+ , we see 
(7.2.32) 
r(P)G{z\ \-P,OL) 
= ] 
e-'T(p){u+\)-^u^-^du. 
0 
Since 
r{P)(u^\)-^ 
= ] e-'^^^'^^^v^-^dv, 

280 
7. Eisenstein Series 
we have 
(7.2.33) 
r(p)(7{z; l-j?, a) = J e-'"u°'-'du ] e-''^"-'^^v^-Uv. 
0 
0 
The integral is absolutely convergent, so that we can exchange the order of 
integration, and therefore, 
0 
0 
0 
= r(a)z^-«(7(z;l-a,i5). 
Since r(p)(7{z;l—p,(x) and r{c()z^~"(7{z;l—<x,p) are holomorphic on 
H' X H' X H', they coincide with each other there. 
Thus we obtain 
(7.2.34) 
(o{z; 1 - ft 1 - a) = co{z; a, P) 
(zeH',Re(a)< 1, Re(j?) > 0). 
Define (o(z; a, P) for a e C with Re(a) < 1 and j? e C by the left-hand side of (7.2.34). 
Then it is a holomorphic function on H' x {a|Re(a) < 1} x C, which coincides 
with the original (o(z; OL, P) when Re(^) > 0. Now when (z, a, j5)eH' x H' x H', the 
integral of the right-hand side of (7.2.16) is uniformly convergent with respect to z 
on any compact subset of H'. Therefore we obtain 
(7.2.35) 
^(e-'(Tiz; a, P)) = (-\fe-'G(z- 
oc + n,P) 
((z,a,i5)eH' X H' x H'), 
so that the continued function ca(z; a, P) also satisfies 
(7.2.36) 
^ (e-^z-Pco(z; a, P)) = {- Ife-'z-Pcoiz; a + n, i?) 
((z, a, P)eW X {oi\ Re(a) < 1} x C). 
For any (z, a, j?)eH' x C x C, take a positive integer n so that Re(a) < n + 1 and 
define co(z; a, P) by 
(7.2.37) 
co(z; a, P) = (- l)"e^z^ ^ 
(^-^z-^ca(z; a - n, ^ 
then CO is a holomorphic function on H' x C x C. 
D 
Now we have 

§7.2. Analytic Continuation of Eisenstein Series 
281 
Theorem 7.2.5. (1) For each y > 0, as a function ofoc and j5, ^(y; a, p; t) is analyti-
cally continued to a meromorphic function on C x C which is expressed as 
(i^-%2nYr{oc)-\2y)-^t'-'e-^''y'o)i4nyt; 
a, p) 
{t > 0), 
i{y;oi.P;t) = | i^-'{2nr^^r(oi)-'rm-'rioi-^p-i)i4nyY-^-p 
(r = 0), 
[j^-"(27cfr(j5)-^(2y)-«|rK-^^-2">'l'lft)(4;r};|r|;fta) 
(r < 0). 
(2) As a function of a and j5, ^{y; a, j5; t) is holomorphic onC x Cfor t ^0, and 
r(a + j5 - 1)" ^ i(y; a, P; 0) is holomorphic on C x C. 
Proof The expression of ^(y; cc, P;t) in (1) is straightforward from Lemma 7,2.1, 
Lemma 7.2.2, Lemma 7.2.3, (7.2.18), (7.2.19) and (7.2.31) on a certain subdomain. 
Since the right-hand side is meromorphic on C x C in each case, we obtain the 
analytic continuation. The second assertion is obvious from this expression and 
Lemma 7.2.4. 
D 
Lemma 7.2.6. For (z, a) e H' x C, we have 
co(z;a,0) = l. 
Proof If Re(a) > 0, then Lemma 7.2.4 and (7.2.31) imply that 
a>{z; 1 — a, 0) = ci>(z; 1, a) 
= r(a)-^zM^;i,a) 
0 
= 1. 
Since (o(z; a, 0) is holomorphic on a, we get the assertion. 
D 
Theorem 7.2.7. For any compact subset TofC x C, there exist positive numbers A 
and B satisfying 
\oj(y;oi,P)\SA(l-¥y-") 
({y,oc,P)EU^ x T). 
Proof First we prove the assertion when Tis contained in C x H'. Take a positive 
integer n so that Re(a) ^ n + 1 for any (a, p)eT. Let (a, p) be any point in T. Since 
RQ(P) > 0, we see by (7.2.16) and (7.2.31) that 
\(o{y;oi,P)\ S 
\r(p)\-'y^'^^^]e-y"(u+l)"u'^'^^^-'du 
0 
Since r(fe + Re(^)) and |r(^)|"' are continuous functions of )?, there exists a 
positive constant Ai satisfying 
k = 0 

282 
7. Eisenstein Series 
Therefore putting A = A^n and B = n, we obtain the assertion. Next we have 
to remove the assumption on T. If j5 e H', then taking integration by parts of the 
right-hand side of (7.2.16), we have 
(7.2.38) 
c7{y;a,p-^l) = 
y-'{oi-l)Giy;oi-hP+l)-^y-'PcT(y;oi,P). 
Muhiplying y^'^^FiP-\-1)~^ 
to both sides, we obtain 
(7.2.39) 
co(y; a, p) = co{y; oi, ^ + l)-\-{l-oi)y-'co(y; 
a-I 
p-^ l), 
((a, i9)6 CxH'). 
Since both sides of (7.2.39) are holomorphic functions of a and j?, (7.2.39) holds on 
C X C. Using (7.2.39) repeatedly, we obtain 
- « = ! . ( : ) 
(7.2.40) 
co(y; a, P)= Y.(j^] 
>'"'(! - a)(2- a) • • • (/c- a)co(y; oc-Kp + m). 
For any compact subset T of C x C, we take a positive integer m so that 
{(a,j? + m)|(a,i?)er}c=C x H'. 
Then we see easily the existence of the desired constants A and B from the result 
when T is contained in C x H'. 
D 
Now we can justify the Poisson summation formula and prove (7.2.12). 
Theorem 7.2.8. Let S(z; a, P) be the function defined in (7.2.7). Then it is analyti-
cally continued to a meromorphic function on C x C with respect to (a, p), and is 
expressed as 
(7.2.41) 
S(z;oc,p) = ay;oi,P;0)+ 
f 
^2«--(^();; a, ft m) {z = x + iyeU). 
m = — 00 
The 
^immx^^y.^ a, P; m) is convergent uniformly and absolutely on any 
compact subset o/H x C x C. Further r(a + P — l)~^S{z; a, P) is an entire function 
of IX and p. 
Proof Let T be a compact subset of H x C x C. By Theorem 7.2.5, there exist 
positive constants Cj, /? and q such that 
(7.2.42) 
\iiy; a, P; m)\ ^ C^m^e-^'''''"\w{^nym\ a, P)\ 
for any point (z, oc, p)eT and any positive integer m. We also see by Theorem 7.2.7 
the existence of a positive constant C2 satisfying 
\co(4nym; (x, p)\ < C2 
for any (z, cc, P)eT and any positive integer m. Therefore we have 
(7.2.43) 
f 
|e2"''"^(^(>;;a,ftm)|^CiC2 £ m^e'^^^'". 

§7.2. Analytic Continuation of Eisenstein Series 
283 
Since the right-hand side is clearly convergent, the left-hand side is uniformly 
convergent on T. We can also similarly prove that Yum=-ao [^^"'"""^(y; a, jS;'w)! 
is uniformly convergent on T. Hence (7.2.14) is verified for a and ^ with 
Re(a + jS) > 1. Therefore the Poisson summation formula is appHcable, and (7.2.10) 
and (7.2.12) imply that (7.2.41) holds for a and ^ with Re(a + j?)> 1. Since 
Zm= 1 ^^"'""'^(}^; a, P\ m) and ^ ^ i _ oo e^"'"''<?(>'; a, P\ m) are holomorphic on a and 
^, and f (y; a, j?; 0) is meromorphic, the right-hand side of (7.2.41) is a meromorphic 
function on C x C and its poles coincide with those of ^{y\ a, j9; 0). Therefore if we 
define S(z; a, ^) on H x C x C by the right-hand side of (7.2.41), we obtain the 
assertion by Theorem 7.2.5(2). 
D 
Now by (7.2.5), (7.2.8) and Theorem 7.2.8, we obtain 
(7.2.44) 
E,(z,s-x.^) 
00 
mAf—1 
/ 
7 
CL 
= C(s)+2M-*-^^ X xMm-'-^^ 
X 
^(a)s{- 
+ —--k 
+ s,s 
00 
mM — 1 
00 
= C ( 5 ) + 2 M - ' ^ - 2 ^ 
X 
^ W ' ^ " ' ' " ^ ' 
Z 
' A W 
Z 
^2;ri«(mx + a)/mM 
m=l 
a = 0 
n= — 00 
X(J( -^;/c + s,s;n 
for s with /c + 2Re(s) > 2, where C(s) is the function given by (7.2.6). If we put 
o = Re(s), then 
m 
k-2a 
m = l 
^A{ 
Y. m 
mM— 1 
00 
z z 
a = 0 
n = - I 
-Jk-2<T+1 
^ I -^; fc + s, s;" 
m = l 
)(KM'''^''''^)h^j/'^''""') 
with some positive constants A, B, p and q. Therefore the right-hand side is 
absolutely convergent if /c + 2Re(s) > 2. Therefore we can exchange the order of 
summation of the right-hand side of (7.2.44) and obtain 
(7.2.45) E,(z,s;x,il^) 
C(s) + 2M-*-2^ f 
a(n,s;z,jA)^'"""^''i('^;/c + s , s ; A 
where 
a(n,s;x,iA)= Z 
XH 
mM 
m 
k-2s 
a = 0 
Now by Lemma 3.1.3(1), we have 
(7.2.46) 
m M - l 
a = 0 
M - 1 
a = 0 
0 
a mjfn. 

284 
7. Eisenstein Series 
Let i/^° be the primitive character associated with i/^ of conductor m^ = M/l 
Lemma 3A3(2) and (7.2.46) imply that for n > 0, 
(7.2.47) 
a(«,5;x,iA) 
M - l 
InianlmM 
0<m|n 
a = 0 
= n" --••jF(./<») X z("/c)c'"'^-' I 
dnm)rm)r(cid\ 
_ 
^ - f c - 2 s + l 
0<c|n 
0<d|(I,c) 
where fx is the Mobius function. We also see for —n< 0 
(7.2.48) 
a(-«,5;;c,iA) = n-''-2*-'V(-l)^('A^) Z /(w/^)^''''^'"^ 
0<c|« 
X 
X 
dn(lld)r(lld)r(cld). 
0<d\(l,c) 
Lastly (7.2.46) impHes that 
(7.2.49) a(0,s;/,iA) = 
<j)(M) Y, Xi^)^ 
^ ^'^^ 
(xj/: the trivial 
m=l 
character modM), 
\ 
0 
{othermse\ 
where (^ is the Euler function. Substituting {12A1\ (7.2.48), (7.2.49) into (7.2.45), we 
obtain the following 
Theorem 7.2.9. Let x and \j/ he Dirichlet characters mod L and mod M, respectively, 
satisfying x(~^)^{~^) 
= (~^Y- 
Then for any integer /c, the Eisenstein series 
E^iz, s; x^ ^) Is analytically continued to a meromorphic function on the whole s-plane 
and has the Fourier expansion 
£fc(z, s; X, JA) = C(s) + D(s)y^ k-2s 
n=l 
where 
-¥A(s)y-' 
£ 
a„is)n-'e^'''""'^a)(4nyn/M;k-\-s,s) 
n = l 
00 
_ 
+ B(s)y-''-' 
X a„(s)n-*-*e-2"'"""/^co(47ryn/M;s,/c + s), 
(X ^ Xol 
l2L„(2s + 
fi^r' 
n (i-p-')r(s)-ir(s + fc)-i 
'"' 
'^' • k,^) 
(x = Xo), 
D{s) = 
p\M -(^^)^m«-'-..^. 
(ij/: the trivial character modM), 
(otherwise), 

§7.2. Analytic Continuation of Eisenstein Series 
285 
A(s) = 
2'''-U-''W(il/'')(n/Mf^''ris-^k)-\ 
B(s) = 
2'-H-^il/(-\)W(il/''){n/Myr{sy\ 
anis)= 
Z x(n/c)c'^''-' 
Z 
d^i(l/d)rm)r(c/d). 
0<c\n 
0<d\(l,c) 
Here ij/^ is the primitive character associated with xj/ of conductor m^ = M/l; fiis the 
Mobius function; 0}(z; a, P) is the holomorphic function on H' x C x C defined by 
(7.2.31). Moreover two series on the right-hand side are convergent uniformly and 
absolutely with respect to s on any compact subset of C. 
Proof. First let us calculate each term. Assume that n = 0 and ^ is the trivial 
character mod M. Then by (7.2.49), Theorem 7.2.5, and (3.2.6), 
2M -*-2^a(0, s; /, ij/my/M; s + k,s; 0) 
= 23-*-2*^^r'^7rr(s)-^r(5 + /c)-ir(2s + /c-l)LJ2s + / c - l , x)/-'^-2* 
M 
= 27^1-' n (i-p-')r(s)-'r(s + fc)-' 
P\M 
r{^^^y[^y,i2s^k-lx)y---
The terms for n 7«^ 0 are calculated similarly by (7.2.47), (7.2.48), and Theorem 7.2.5. 
We shall prove the convergence of the series. Let K be any compact subset of C. 
Then by Theorem 7.2.7, there exist positive constants A and B satisfying 
\co(4nny/M; k-\-s, s)\ ^ A{1 + y-^) 
for any positive integer n and any seK. We also see easily the existence of the 
constant u satisfying \a„(s)\ ^ n" for any seK. Then the two series are convergent 
uniformly and absolutely on X, and therefore, they are entire functions of s. 
D 
Corollary 7.2.10. (1) Ifij/ is non-trivial, then E^{z, s;x,^) is an entire function ofs. 
(2) Assume xj/ is trivial. If /c ^ 1, then Ej^(z, s; x, ^) is holomorphic for 
Re(s) > (1 -/c)/2. When fe = 1, £i(z, s; x, ^) is holomorphic for Re(s) > - 1/2. 
(3) If both X and \j/ are trivial, then EQ(Z, s;Xi^)is holomorphic for Re (5) > 1 and 
has a simple pole at s — 1 with residue — 0 ( 1 — 1 0 ( 1 — I-
yp\L\ 
pJp\M\ 
pj 
Proof. The first assertion is straightforward from Theorem 7.2.9, Corollary 3.3.2 
and (3.3.5). If /c> 0, then we easily see that both C{s) and D{s) are holomorphic for 
Re(s) > (1 — k)/2 by Theorem 3.2.2(2). If/c = 1 and ij/ is trivial, then x is non-trivial. 
Then C(s) = 0 and D(s) is holomorphic for Re(s) > - 1 / 2 by Corollary 3.3.2. Next 
assume that k = 0, and x and ij/ are trivial. Then it is easy to see that C{s) and 
D{s) are holomorphic for Re(s) > 1. The residue at s = 1 is also obtained by 
by Theorem 3.2.2(2). 
D 

286 
7. Eisenstein Series 
Corollary 7.2.11. Put 
i)E,,(z, s; X, JA) 
(/C < 0). 
Then £fc(s) is an entire function except for the case where /c = 0 and /, i/^ are trivial. 
Moreover when /c = 0 an^ x^ ^ ^^^ trivial, 
(1) if either / or i/^ is not principal, then Ef^(s) is holomorphic on the whole s-plane 
except for a simple pole at s = 1; 
(2) if both X and \j/ are principal, then E^{s) is holomorphic on the whole s-plane 
except for simple poles at s = 0 and s = 1. 
Proof We shall prove our assertions only for /c ^ 0, since the argument for /c < 0 is 
quite similar. First of all, we see that both 
ris-\-k)A(s) = 
2'^H-''W(il/'')(n/Mf^'' 
and 
r(s + k)B(s) = 2'-'^rV(-1) 
Wiil/''){n/Mys(s + 1). • • (s + i^ - 1) 
are entire functions. Now we shall study the behavior of r(s -\- k)(C(s) 
+ D(s)y^-fc-2s) pjj.g^ consider r(s + /c)C(s). li x ^ Xo^ then C(s) = 0. Otherwise, 
we see 
2r(s + k) 
r{s + k)C(s) = 
lu^Ln^' 
^«^^ + ^ + ^)/2)^M(25 + K lA), 
r((2s + /c + o)/2) 
where S = S^. Since iA(— 1) = (— If, we see that k-\-S = 0 mod2, and therefore 
r{s + k)r{(2s + /c + (5)/2)" ^ is entire. If i^ is non-trivial, then r{s + k)C{s) is entire 
since r((2s + /c + ^)/2)Ljv/(2s + /c, i//) is entire by Corollary 3.3.2. Assume that ij/ is 
the trivial character mod M. If /c > 0, then r{s + /c)C(s) is holomorphic except for a 
simple pole at s = (1 — k)/2 with residue 
r((\+k)/2)Yli^-p-')-
p\M 
If /c = 0, then r(s H- /c)C(s) is holomorphic except for simple poles at s = 0 and 
s = 1/2 and the residue at s = 1/2 is 
r(i/2)n(i-p-M. 
P\M 
Next we consider r(s + k)D{s). If i^ is non-trivial, then D(s) = 0. If i/^ is the 
trivial character mod M, then 
r(s + /c)D(s)}; l-k-2s 
= 2^;^,-'n (1 - P - ' ) / ' ' - ^ r ' r ( ? i ± ^ y ( ^ ^ ) L , ( 2 5 + fc - 1,z) 

§7.2. Analytic Continuation of Eisenstein Series 
287 
fe-l 
rl^-]L,{2s 
+ k-l,x) 
(k-odd). 
r(s) 
V 2 
k 
^ ' ' + 2 / 
/2s + ;t-l 
r{—^ 
|L^(2s + 
fe-l,z) 
(/c:even). 
This implies that if x is non-trivial, then r{s + k)D(s)y^~''~^^ is entire by 
Corollary 3.3.2. Assume that x is trivial and L ^ 1. Then k is even and 
r((2s + 
fc—l)/2)C(2s-l-k-1) 
is holomorphic except for simple poles at 
s = (1 — k)/2 and s = 1 — k/2. Then we see 
^ ' ' ^ 2 ) , / 2 s + 
fc-l\ 
,, 
, 
, 
, 
r 
r 
Li(2s + 
fc-l,z) 
r(5) 
V 
2 
= s(s + i)...(s + ^-i)r(^?^±^)c(2s + k-i)n(i-p'-'-'^) 
and it is entire if /c > 0, or it is holomorphic except for a simple pole at s = 1 if 
k = 0. Assume x = Xo'^^^>^^ then r(s -\- k)D(s)y^ ~^~^^ is holomorphic except for 
a simple pole at s = (1 — k)/2 with residue 
2^i-ir'ni-k)/2)-'r{i/2) n (i-p-')m 
p\M 
= -r((i + k)/2)Yiii-p-') 
p\M 
by (3.2.4). If /c = 0, then r(5 + /c)D(s)y^~''~^* is holomorphic except for simple 
poles at s = 1/2 and s = 1, and the residue at s = 1/2 is 
p\M 
This completes the proof. 
D 
If /c ^ 3, then we see that 
and the Fourier expansion in Theorem 7.2.9 with s = 0 is nothing but that of 
£fc(z; X, ^) obtained in Theorem 7.1.3 by Lemma 7.2.6. 
Now let us consider the cases when k = 1, 2. Since ^^(z, s;x^^) is holomorphic 
at 5 = 0 by Corollary 7.2.10, we put 
(7.2.50) 
E,iz;x,i^) = 
E,{z,0;x.n 
and 
(7.2.51) 
E2{z) = £2(2; Xo.Xo) 
with the principal character Xo-

288 
7. Eisenstein Series 
Theorem 7.2.12. Ifx and xj/ are Dirichlet characters mod L and mod M, respectively, 
satisfying x^(—^)= 
U then 
£2(2; X, lA) = C + Dy- ^ + ^ £ a„e2"'"^/*^. 
n = l 
0 
(z ^ ;(o). 
Here 
r - ^ n ( l - P " ' ) n ( l - P " ' ) 
(h'k-trivial), 
D = •{ 
p|M 
P i t 
L 
0 
(otfcerivwe), 
a„= Z X{n/c)c X 
dnm)Vm)¥{cld), 
0<c\n 
0<d|(I,c) 
where ij/^, /, ^ are as in Theorem 7.2.9. 
Theorem 7.2.13. Ifx and \j/ are Dirichlet characters mod L and mod M, respectively, 
satisfying x^(—\)= 
— 1, r/ien 
Here 
£i(z; X, (A) = C + D + A X a„e^"'"'/^. 
« = i 
0 
(Z # Zo). 
^ 
-21^(1,11^) {x = Xo\ 
D = 
0 
(i/*: non-trivial), 
-Ini n (1 -p-')LJO,z) (lA: f'wa'), 
p|M 
«„= I 
x(«/c) Z 
dti{l/d)rWd)^(c/d), 
0<c\n 
0<d|(/,c) 
where \j/^, /, n are as in Theorem 7.2.9. 
Corollary 7.2.14. Assume k> 0. Then E^(z\ %, \\i)isa holomorphic function ofz on H 
except for the case when k = 2 and both % cmd ij/ are trivial. Further £2(2) — pE2(pz) 
is holomorphic on Hfor any prime number p. 
Proof We have only to verify the assertion when /c = 1 and k = 2. Let a„ be as in 
Theorem 7.2.12(if fe = 2) or in Theorem 7.2.13 (if k =^ 1). Then a„ = 0(n^), Thus 
Sr=i^«^^"""'^^ ^^ convergent uniformly on {zeH|Im(z) > c} with any positive 
constant c. Therefore it is holomorphic on H. Since the coefficient of y~^ in 
^2(^) — P^2(P^) vanishes, we see the second assertion. 
D 

§7.2. Analytic Continuation of Eisenstein Series 
289 
Let iV be a positive integer. For integers fi, v such that 0 ^ /i, v < N, we put 
(7.2.52) 
EfcCz, s;/x, v; AT) = 
Y 
{mz-]-n)-^\mz-\-n\ 2s 
If^/^modN 
Here ^ ' impHes that we omit m = n = 0 from the summation when /i = v = 0. We 
also put 
(7.2.53) 
ii'\r{N)) 
= <E,(z, 5; fi, v; N)\0 ^ ^u, v < iV>, 
(7.2.54) 
^['\r{N)) = (E, ("z,5;x,^) L^,u,v 
where x, ^A^ "» ^^^^ ^ ^^ (7.2.54) are those satisfying (7.1.22) and (7.1.23). For any 
element g(z, s) of i[^\r(N)) 
and i[^Hr(N)X we put 
(7.2.55) 
{9\u,sy)(z) = g(yz.s)j(y, z)-'\j(y, z)\-'^ 
yeSL^^iZ). 
We see that 
(7.2.56) 
41^ (r(N)) is stable under the action of 5^2(1). 
Now we have 
Theorem 7.2.15. (l)ii'\r(N)) 
= 
ii^\r{N)). 
(2) Let g{z, s)ei^[^\r{N)). 
Ifg{z, s) is holomorphic on a compact subset T of the 
s-plane, then there exists a constant c such that 
Sf(z,s)=-0(/) 
(z = x + iy\ 
{y^co) 
uniformly on xeU and seT. 
Proof The first assertion is proved by a similar argument to that in Lemma 7.1.4. 
The latter is proved by Theorem 7.2.7, Theorem 7.2.9, (7.2.56) and (1). 
D 
By the above theorem, if /c > 0, then E^(z, s; fi,v;N) is holomorphic at 5 = 0. 
For /c> 0, we put 
(7.2.57) 
E,{z; //, v; N) = E^(z, 0; fi, v; N\ 
and 
(7.2.58) 
^i''(r(N)) 
= <£,(z; /x, v; iV) 10 ^ /x, v < iV>, 
(7.2.59) 
4^>(r(iV)) = ( £ j -
:.("z;x,^) X,^.u,v ), 
where /, i/^, M, and v are as in (7.2.54). If /c > 2, then these definitions coincide with 
those in §7.1. 
Theorem 1.2.16. Let k be a positive integer. Then 
(i)4i'(r(N)) = ^f>(r(N)). 
(2) ///(z)e^^" {r(N)) is holomorphic, then it belongs to «?t(r(Ar)). In particular 

290 
7. Eisenstein Series 
Si'\r(N))^^,(F(N))ifk^2. 
(3) E2{Nz, 0; X. iA)e^2(^W) tf^ is not trivial. Moreover if 
g(z)eS^i\r(N)\ 
then there exists a constant c such that g{z) — 
cE2{z)e^2ir(N)). 
Proof. When /c> 2, we have already proved the assertions in §7.1. The first 
assertion for general k is straightforward from Theorem 7.2.15(1). We also see 
easily that S'l^\r(N)) is stable under the action of SLjCZ). Let/(z) be an element of 
(^l^\r(N)). If/(z) is holomorphic on H, then it is also holomorphic at oo by (1) and 
Theorem 7.2.9. Let x be a cusp of r{N) and take yeSLjil.) 
so that yoo = x. Since 
/l^y belongs to ^^^\r(N)), 
it is also holomorphic at oo. This implies that/(z) is 
holomorphic at x and (2) is proved. The first part of (3) is obvious. Now let g{z) be 
an element of ^i^\r(N)). 
Then by (1) and Theorem 7.2.12, we see 
g(z) — CQ H—- + a power series of ^^nir/iv 
Then there exists a constant c such that g(z) — cE2iz) is holomorphic on H and 
is also holomorphic at oo. Let x be a cusp of r(N) and take yeSLjCZ) so that 
yoo = X. Then since (^ —0^2)LT belongs to <f^2^^(r(N)), 
c' 
(g — 0^2) 127 = Co + — + a power series of e^jriz/N 
Since (g — cE2)127 is holomorphic on H, we see c\ = 0. This implies that g — CE2 is 
also holomorphic at x. 
D 
For a Dirichlet character x mod AT, we define 
r lx{d)j{y.z)-'\j(y,z)\-'^ 
(;((_1) = (_1)^ / = [* j]) 
(7.2.60) El,(z,s;x)=\ 
y^^ 
L 
0 
(z(-i)^(-i)'), 
where R is a. complete set of representatives for ro(N)J\ro(N). 
We also put 
(7.2.61) 
£,%(z,s) = £,%(z,5;x) 
with the trivial character x mod N. Then we see, similarly to (7.1.30), 
(7.2.62) 
E.iNz, s; Xo. x) = 2L^(k +2s, X)EIN{Z. 
S;xl 
If/c > 0, then Ef^f^(z, s; x) is holomorphic at s = 0 by Corollary 7.2.10. Therefore we 
may define EIJ^(Z; X) and EIJ^(Z) by 
(7.2.63) 
El^(z;x) 
= 
El^(z,0;xl 
(7.2.64) 
£,%(z) = £,%(z,0). 
By Theorem 7.2.16(2) and (3), £fc%(z, x) belongs to %(r(N)) except for fc = 2 and x 
is trivial. 

§7.2. Analytic Continuation of Eisenstein Series 
291 
Theorem 7.2.17. £O,N(^» ^) has a simple pole at s = 1 and 
r'(fNn(i.p-')f 
Proof. The assertion is easily obtained by calculating the residue using 
Corollary 7.2.10(3) combined with Theorem 4.1.2(2) and Theorem 4.2.5(2). But we 
shall here give a rather direct proof of the first equahty, which also reproves 
Theorem 4.1.2(2). We put 
(7.2.65) 
M{z,s) = X e-»™<^^>|;(r,z)|-2»-^ 
yeR 
where Ris a. complete set of representatives for rQ{N)^\rQ(N). 
Since 
l-y^e-y^l 
for >; > 0, 
M{z,s) is absolutely convergent if Re(s) > 0. Further if s is a positive number, then 
(7.2.66) 
El^(z, s + 1) - £* ^(z, 5 + 2)>; ^ M(z,-5) ^ El^(z, s + 1). 
Therefore 
lim sM(z, s) = ReSs= i £^O,JV(^» S) 
= c/y 
by Corollary 7.2.10(3) and (7.2.62). Now we have 
(c-(fNn(...-.y') 
(7.2.67) 
By (7.2.60), we see 
r(s) = 
]je-yy'-'dxdy 
0 0 
= 
J 
e-yy'^Uv(z) 
ro(NUH 
= 
J 
M{z,s)y'''^dv(z). 
ro{N)\H 
£ S , N ( Z , S + 1 ) = 1 + X l7(y,z)l 2s-2 
yen 
Therefore by Theorem 7.2.9 and (7.2.62), 
(7.2.68) 
5 X \j(y,z)\~^'~^y''^' 
^C 
(>;-• 00, C: constant) 
y€R 
and sE'^^j^iz, s + l));*"^^ is bounded on neighborhoods of cusps of FQIN) inequi-

292 
7. Eisenstein Series 
valent to oo, uniformly on s (0 ^ s ^ e). Since 
-2s-2 
yeR 
we see that the integral 
ro(N)\H 
is uniformly convergent by (7.2.68). Therefore 
1 = lim sr(s) 
= lim 
j 
sM(z,s)y'^^dv{z) 
= 
J 
( lim sM(z,s)y'^ A dv{z) 
= cv(roiN)\H). 
This implies the first equality. The second equahty follows from this with a direct 
calculation of c by Corollary 7.2.10(3) and (7.2.62). 
D 
Theorem 7.2.18. For a positive integer N, we have: 
(1) ^'i\r{N))n<^2iriN))^ 
jr,ir{N)). 
(2)^</>(r(iV)) = ^,(r(iV)). 
Proof. Let/(z) be an element of ^^^(Ar, /). Then by a similar argument to that in 
Theorem 2.6.10, we have 
(7.2.69) 
J mEl^{z,s;x)y'^''-'dxdy 
= 0, 
ro(iV)\H 
if Re(s) is sufficiently large. By Corollary 7.2.15(2), the integral is uniformly 
convergent on any compact subset of s-plane on which Eli^(z, 5; /) is holomorphic. 
Therefore we see 
(7.2.70) 
J f^)ElAz;x)y'-'dxdy 
= 0. 
ro(N)\H 
If fe = 1 or /c = 2 and x is not trivial, then this implies £f,jv(z; x)e^fc(N, x), and 
therefore £f,^(z; x)^^kir(N)) 
by Theorem 2.1.7. Assume /c = 2. We shall prove 
(7.2.71) 
J f{^)El^(z)y'dv(z)=:0, 
f(z)e6^2ir{N)). 
r{N)\H 
We may assume AT ^ 6 (since dim^^C^C^)) = 0 if AT ^ 5). We put 
(7.2.72) 
F2(z,s)= Y.{cz-\-d)-^\cz + d\-^\ 
yeR' 
where R' is a complete set of representatives for r{N)^\r(N) 
and y [c d\-

§7.2. Analytic Continuation of Eisenstein Series 
293 
Then by a similar calculation to that in (7.1.33), we see 
(7.2.73) 
F2iz. s) = ^ I ; £ 1 N ( Z , 5; x\ 
where x runs over all characters mod N. Thus Fjiz, s) is holomorphic at 5 = 0. We 
also put 
(7.2.74) 
F2(z) = F2(z,0). 
Then by a similar argument to that in Theorem 2.6.10, we have 
(7.2.75) 
j 
f{i)F2(z,s)y''dxdy 
= 0, 
f(z)G^2(r{N)), 
r{N)\H 
and therefore, 
(7.2.76) 
j 
mFAz)y'dv{z) 
= 0, 
/(z)e^2(r(^)). 
r(iV)\H 
Since FJ.NC^) is a Hnear combination of F2(z) and Ff.ivC^J x) (X- non-trivial) by 
(7.2.73), we proved (7.2.71). Combining all together, we obtain 
(7.2.77) 
j 
f{z)El^{z;x)y'dv(z) 
= 0, 
f(z)e^,(r(N)l 
r(iV)\H 
for any character x modN and any positive integer k. Since (7.1.17), (7.1.19), and 
(7.1.31) also hold for /^ = 1 and 2, 
{Elsiz;x)\ky I yeSL2\ 
generates (^i^\r (AT)), so that 
<r^i>(r(iV)) n ^2inN)) 
cz jr2{r(N)l 
^{'\r{N)) 
c= 
^.(FiN)). 
The converse can be obtained by Theorem 4.7.2 and the following lemma. 
D 
Lemma 7.2.19. Let x ^nd ijf he primitive Dirichlet characters mod L and mod M, 
respectively, satisfying x'AC—l) = (—!)*• Let fj^(z\x^^) 
be the modular form 
f(z; X, ^) of weight k defined in §4.7. 
(1) If either x or \j/ is not trivial, then 
E.iMz; X, Ik) = (-8J:^ wm/M')Mz; 
x, <A)-
(2) For any prime number p, 
£2(2) - vE2{pz) = -87r%(z; Xo, X'\ 
where Xo ^^ the principal character and x! the trivial character mod p. 
(3) 
E,{Mz; X, «A) = (-4niW(i^)/M)A{z; 
x. 
n 
Proof We see easily the equalities by comparing the Fourier coefficients by 
Theorem 7.2.12 and Theorem 7.2.13. 
D 

Numerical Tables 
As some applications of trace formulae in Chapter 6, we present here some tables. 
Table A is on the dimensions of modular forms, Table B gives eigenvalues 
and characteristic polynomials of Hecke operators operating on 5^2(^0 (^)X and 
Table C is on the coefficients of primitive forms in 6^2\^A — 
Table A was prepared by Y. Maeda, and Table B and Table C by H. Wada and 
N. Iwasaki. 
Table A 
This Hsts the dimensions of the following spaces: 
(i) dim5^fc(ro(N)). 
Weights 
k,2Sk^50; 
Levels N, 1 ^ N ^ 50, 
50 < AT < 100: prime numbers. 
(ii) dim5^«(ro(iV)). 
Weights and levels are as in (i). 
(iii) dim^,(^, 
Weights /c, 2 k /c ^ 50; 
Levels q, 3 ^ q < 100; prime numbers. 

296 
Numerical Tables 
Dimension of ^^(ro{N)) 
r ^ 
2 
4 
6 
8 
10 
12 
14 
16 
18 
20 
22 
24 
26 
28 
30 
32 
34 
36 
38 
40 
42 
44 
46 
48 
50 
1 
0 
0 
0 
0 
0 
1 
0 
1 
1 
1 
1 
2 
1 
2 
2 
2 
2 
3 
2 
3 
3 
3 
3 
4 
3 
2 
0 
0 
0 
1 
1 
2 
2 
3 
3 
4 
4 
5 
5 
6 
6 
7 
7 
8 
8 
9 
9 
10 
10 
11 
11 
3 
0 
0 
1 
1 
2 
3 
3 
4 
5 
5 
6 
7 
7 
8 
9 
9 
10 
11 
11 
12 
13 
13 
14 
15 
15 
4 
0 
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 
12 
13 
14 
15 
16 
17 
18 
19 
20 
21 
22 
23 
5 
0 
1 
1 
3 
3 
5 
5 
7 
7 
9 
9 
11 
11 
13 
13 
15 
15 
17 
17 
19 
19 
21 
21 
23 
23 
6 
0 
1 
3 
5 
7 
9 
11 
13 
15 
17 
19 
21 
23 
25 
27 
29 
31 
33 
35 
37 
39 
41 
43 
45 
47 
7 
0 
1 
3 
3 
5 
7 
7 
9 
11 
11 
13 
15 
15 
17 
19 
19 
21 
23 
23 
25 
27 
27 
29 
31 
31 
8 
0 
1 
3 
5 
7 
9 
11 
13 
15 
17 
19 
21 
23 
25 
27 
29 
31 
33 
35 
37 
39 
41 
43 
45 
47 
9 
0 
1 
3 
5 
7 
9 
11 
13 
15 
17 
19 
21 
23 
25 
27 
29 
31 
33 
35 
37 
39 
41 
43 
45 
47 
10 
0 
3 
5 
9 
11 
15 
17 
21 
23 
27 
29 
33 
35 
39 
41 
45 
47 
51 
53 
57 
59 
63 
65 
69 
71 
11 
1 
2 
4 
6 
8 
10 
12 
14 
16 
18 
20 
22 
24 
26 
28 
30 
32 
34 
36 
38 
40 
42 
44 
46 
48 
12 
0 
3 
7 
11 
15 
19 
23 
27 
31 
35 
39 
43 
47 
51 
55 
59 
63 
67 
71 
75 
79 
83 
87 
91 
95 
13 
0 
3 
5 
7 
9 
13 
13 
17 
19 
21 
23 
27 
27 
31 
33 
35 
37 
41 
41 
45 
47 
49 
51 
55 
55 
14 
1 
4 
8 
12 
16 
20 
24 
28 
32 
36 
40 
44 
48 
52 
56 
60 
64 
68 
72 
76 
80 
84 
88 
92 
96 
15 
1 
4 
8 
12 
16 
20 
24 
28 
32 
36 
40 
44 
48 
52 
56 
60 
64 
68 
72 
76 
80 
84 
88 
92 
96 
Dimension of^^iroiN)) 
r ^ 
2 
4 
6 
8 
10 
12 
14 
16 
18 
20 
22 
24 
26 
28 
30 
32 
34 
36 
38 
40 
42 
44 
46 
48 
50 
1 
0 
0 
0 
0 
0 
1 
0 
1 
1 
1 
1 
2 
1 
2 
2 
2 
2 
3 
2 
3 
3 
3 
3 
4 
3 
2 
0 
0 
0 
1 
1 
0 
2 
1 
1 
2 
2 
1 
3 
2 
2 
3 
3 
2 
4 
3 
3 
4 
4 
3 
5 
3 
0 
0 
1 
1 
2 
1 
3 
2. 
3 
3 
4 
3 
5 
4 
5 
5 
6 
5 
7 
6 
7 
7 
8 
7 
9 
4 
0 
0 
1 
0 
1 
1 
1 
1 
2 
1 
2 
2 
2 
2 
3 
2 
3 
3 
3 
3 
4 
3 
4 
4 
4 
5 
0 
1 
1 
3 
3 
3 
5 
5 
5 
7 
7 
7 
9 
9 
9 
11 
11 
11 
13 
13 
13 
15 
15 
15 
17 
6 
0 
1 
1 
1 
1 
3 
1 
3 
3 
3 
3 
5 
3 
5 
5 
5 
5 
7 
5 
7 
7 
7 
7 
9 
7 
7 
0 
1 
3 
3 
5 
5 
7 
7 
9 
9 
11 
11 
13 
13 
15 
15 
17 
17 
19 
19 
21 
21 
23 
23 
25 
8 
0 
1 
1 
2 
2 
3 
3 
4 
4 
5 
5 
6 
6 
7 
7 
8 
8 
9 
9 
10 
10 
11 
11 
12 
12 
9 
0 
1 
1 
3 
3 
4 
5 
6 
6 
8 
8 
9 
10 
11 
11 
13 
13 
14 
15 
16 
16 
18 
18 
19 
20 
10 
0 
1 
3 
1 
3 
5 
3 
5 
7 
5 
7 
9 
7 
9 
11 
9 
11 
13 
11 
13 
15 
13 
15 
17 
15 
11 
1 
2 
4 
6 
8 
8 
12 
12 
14 
16 
18 
18 
22 
22 
24 
26 
2« 
28 
32 
32 
34 
36 
38 
38 
42 
12 
0 
1 
0 
2 
1 
2 
2 
3 
2 
4 
3 
4 
4 
5 
4 
6 
5 
6 
6 
7 
6 
8 
7 
8 
8 
13 
0 
3 
5 
7 
9 
11 
13 
15 
17 
19 
21 
23 
25 
27 
29 
31 
33 
35 
37 
39 
41 
43 
45 
47 
49 
14 
1 
2 
2 
4 
4 
6 
6 
8 
8 
10 
10 
12 
12 
14 
14 
16 
16 
18 
18 
20 
20 
22 
22 
24 
24 
15 
~ 
2 
4 
4 
6 
8 
8 
10 
12 
12 
14 
16 
16 
18 
20 
20 
22 
24 
24 
26 
28 
28 
30 
32 
32 

Table A 
297 
Dimension o( ^^{ro{N)) 
7^ 
2 
4 
6 
8 
10 
12 
14 
16 
18 
20 
22 
24 
26 
28 
30 
32 
34 
36 
38 
40 
42 
44 
46 
48 
50 
16 
0 
3 
7 
11 
15 
19 
23 
27 
31 
35 
39 
43 
47 
51 
55 
59 
63 
67 
71 
75 
79 
83 
87 
91 
95 
17 
1 
4 
6 
10 
12 
16 
18 
22 
24 
28 
30 
34 
36 
40 
42 
46 
48 
52 
54 
58 
60 
64 
66 
70 
72 
18 
0 
5 
11 
17 
23 
29 
35 
41 
47 
53 
59 
65 
71 
77 
83 
89 
95 
101 
107 
113 
119 
125 
131 
137 
143 
19 
1 
4 
8 
10 
14 
18 
20 
24 
28 
30 
34 
38 
40 
44 
48 
50 
54 
58 
60 
64 
68 
70 
74 
78 
80 
20 
1 
6 
12 
18 
24 
30 
36 
42 
48 
54 
60 
66 
72 
78 
84 
90 
96 
102 
108 
114 
120 
126 
132 
138 
144 
21 
T 
6 
12 
16 
22 
28 
32 
38 
44 
48 
54 
60 
64 
70 
76 
80 
86 
92 
96 
102 
108 
112 
118 
124 
128 
22 
2 
7 
13 
19 
25 
31 
37 
43 
49 
55 
61 
67 
73 
79 
85 
91 
97 
103 
109 
115 
121 
127 
133 
139 
145 
23 
2 
5 
9 
13 
17 
21 
25 
29 
33 
37 
41 
45 
49 
53 
57 
61 
65 
69 
73 
77 
81 
85 
89 
93 
97 
24 
1 
8 
16 
24 
32 
40 
48 
56 
64 
72 
80 
88 
96 
104 
112 
120 
128 
136 
144 
152 
160 
168 
176 
184 
192 
25 
0 
5 
9 
15 
19 
25 
29 
35 
39 
45 
49 
55 
59 
65 
69 
75 
79 
85 
89 
95 
99 
105 
109 
115 
119 
26 
2 
9 
15 
23 
29 
37 
43 
51 
57 
65 
71 
79 
85 
93 
99 
107 
113 
121 
127 
135 
141 
149 
155 
163 
169 
27 
T 
6 
12 
18 
24 
30 
36 
42 
48 
54 
60 
66 
72 
78 
84 
90 
96 
102 
108 
114 
120 
126 
132 
138 
144 
28 
2 
9 
17 
25 
33 
41 
49 
57 
65 
73 
81 
89 
97 
105 
113 
121 
129 
137 
145 
153 
161 
169 
177 
185 
193 
29 
2 
7 
11 
17 
21 
27 
31 
37 
41 
47 
51 
57 
61 
67 
71 
77 
81 
87 
91 
97 
101 
107 
111 
117 
121 
30 
3 
14 
26 
38 
50 
62 
74 
86 
98 
110 
122 
134 
146 
158 
170 
182 
194 
206 
218 
230 
242 
254 
266 
278 
290 
Dimension of 6^^ (roiN)) 
s 
2 
4 
6 
8 
10 
12 
14 
16 
18 
20 
22 
24 
26 
28 
30 
32 
34 
36 
38 
40 
42 
44 
46 
48 
50 
16 
0 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 
12 
13 
14 
15 
16 
17 
18 
19 
20 
21 
22 
23 
24 
17 
1 
4 
6 
10 
12 
14 
18 
20 
22 
26 
28 
30 
34 
36 
38 
42 
44 
46 
50 
52 
54 
58 
60 
62 
66 
18 
0 
1 
3 
2 
4 
5 
5 
6 
8 
7 
9 
10 
10 
11 
13 
12 
14 
15 
15 
16 
18 
17 
19 
20 
20 
19 
1 
4 
8 
10 
14 
16 
20 
22 
26 
28 
32 
34 
38 
40 
44 
46 
50 
52 
56 
58 
62 
64 
68 
70 
74 
20 
T" 
1 
1 
3 
3 
3 
5 
5 
5 
7 
7 
7 
9 
9 
9 
11 
11 
11 
13 
13 
13 
15 
15 
15 
17 
21 
P 
4 
4 
8 
8 
12 
12 
16 
16 
20 
20 
24 
24 
28 
28 
32 
32 
36 
36 
40 
40 
44 
44 
48 
48 
22 
0 
3 
5 
5 
7 
11 
9 
13 
15 
15 
17 
21 
19 
23 
25 
25 
27 
31 
29 
33 
35 
35 
37 
41 
39 
23 
2 
5 
9 
13 
17 
19 
25 
27 
31 
35 
39 
41 
47 
49 
53 
57 
61 
63 
69 
71 
75 
79 
83 
85 
91 
24 
1 
1 
3 
3 
5 
5 
7 
7 
9 
9 
11 
11 
13 
13 
15 
15 
17 
17 
19 
19 
21 
21 
23 
23 
25 
25 
0 
3 
7 
9 
13 
16 
19 
22 
26 
28 
32 
35 
38 
41 
45 
47 
51 
54 
57 
60 
64 
66 
70 
73 
76 
26 
2 
3 
5 
7 
9 
11 
13 
15 
17 
19 
21 
23 
25 
27 
29 
31 
33 
35 
37 
39 
41 
43 
45 
47 
49 
27 
1 
4 
7 
9 
12 
15 
17 
20 
23 
25 
28 
31 
33 
36 
39 
41 
44 
47 
49 
52 
55 
57 
60 
63 
65 
28 
0 
2 
2 
4 
4 
6 
6 
8 
8 
10 
10 
12 
12 
14 
14 
16 
16 
18 
18 
20 
20 
22 
22 
24 
24 
29 
2 
7 
11 
17 
21 
25 
31 
35 
39 
45 
49 
53 
59 
63 
67 
73 
77 
81 
87 
91 
95 
101 
105 
109 
115 
30 
1 
2 
2 
6 
6 
6 
10 
10 
10 
14 
14 
14 
18 
18 
18 
22 
22 
22 
26 
26 
26 
30 
30 
30 
34 

298 
Numerical Tables 
Dimension of ^^{ro{N)) 
ZK 
2 
4 
6 
8 
10 
12 
14 
16 
18 
20 
22 
24 
26 
28 
30 
32 
34 
36 
38 
40 
42 
44 
46 
48 
50 
31 
2 
7 
13 
17 
23 
29 
33 
39 
45 
49 
55 
61 
65 
71 
77 
81 
87 
93 
97 
103 
109 
113 
119 
125 
129 
32 
T 
8 
16 
24 
32 
40 
48 
56 
64 
72 
80 
88 
96 
104 
112 
120 
128 
136 
144 
152 
160 
168 
176 
184 
192 
33 
3 
10 
18 
26 
34 
42 
50 
58 
66 
74 
82 
90 
98 
106 
114 
122 
130 
138 
146 
154 
162 
170 
178 
186 
194 
34 
3 
12 
20 
30 
38 
48 
56 
66 
74 
84 
92 
102 
110 
120 
128 
138 
146 
156 
164 
174 
182 
192 
200 
210 
218 
35 
3 
10 
18 
26 
34 
42 
50 
58 
66 
74 
82 
90 
98 
106 
114 
122 
130 
138 
146 
154 
162 
170 
178 
186 
194 
36 
1 
12 
24 
36 
48 
60 
72 
84 
96 
108 
120 
132 
144 
156 
168 
180 
192 
204 
216 
228 
240 
252 
264 
276 
288 
37 
2 
9 
15 
21 
27 
35 
39 
47 
53 
59 
65 
73 
77 
85 
91 
97 
103 
111 
115 
123 
129 
135 
141 
149 
153 
38 
4 
13 
23 
33 
43 
53 
63 
73 
83 
93 
103 
113 
123 
133 
143 
153 
163 
173 
183 
193 
203 
213 
223 
233 
243 
39 
3 
12 
22 
30 
40 
50 
58 
68 
78 
86 
96 
106 
114 
124 
134 
142 
152 
162 
170 
180 
190 
198 
208 
218 
226 
40 
3 
14 
26 
38 
50 
62 
74 
86 
98 
110 
122 
134 
146 
158 
170 
182 
194 
206 
218 
230 
242 
254 
266 
278 
290 
41 
3 
10 
16 
24 
30 
38 
44 
52 
58 
66 
72 
80 
86 
94 
100 
108 
114 
122 
128 
136 
142 
150 
156 
164 
170 
42 
5 
20 
36 
52 
68 
84 
100 
116 
132 
148 
164 
180 
196 
212 
228 
244 
260 
276 
292 
308 
324 
340 
356 
372 
388 
43 
3 
10 
18 
24 
32 
40 
46 
54 
62 
68 
76 
84 
90 
98 
106 
112 
120 
128 
134 
142 
150 
156 
164 
172 
178 
44 
4 
15 
27 
39 
51 
63 
75 
87 
99 
111 
123 
135 
147 
159 
171 
183 
195 
207 
219 
231 
243 
255 
267 
279 
291 
45 
3 
14 
26 
38 
50 
62 
74 
86 
98 
110 
122 
134 
146 
158 
170 
182 
194 
206 
218 
230 
242 
254 
266 
278 
290 
Dimension of^^{ro{N)) 
>
^ 
2 
4 
6 
8 
10 
12 
14 
16 
18 
20 
22 
24 
26 
28 
30 
32 
34 
36 
38 
40 
42 
44 
46 
48 
50 
31 
2 
7 
13 
17 
23 
27 
33 
37 
43 
47 
53 
57 
63 
67 
73 
77 
83 
87 
93 
97 
103 
107 
113 
117 
123 
32 
1 
3 
5 
7 
9 
11 
13 
15 
17 
19 
21 
23 
25 
27 
29 
31 
33 
35 
37 
39 
41 
43 
45 
47 
49 
33 
1 
6 
8 
12 
14 
20 
20 
26 
28 
32 
34 
40 
40 
46 
48 
52 
54 
60 
60 
66 
68 
72 
74 
80 
80 
34 
1 
4 
8 
8 
12 
16 
16 
20 
24 
24 
28 
32 
32 
36 
40 
40 
44 
48 
48 
52 
56 
56 
60 
64 
64 
35 
3 
6 
10 
14 
18 
22 
26 
30 
34 
38 
42 
46 
50 
54 
58 
62 
66 
70 
74 
78 
82 
86 
90 
94 
98 
36 
1 
1 
2 
3 
4 
4 
6 
6 
7 
8 
9 
9 
11 
11 
12 
13 
14 
14 
16 
16 
17 
18 
19 
19 
21 
37 
2 
9 
15 
21 
27 
33 
39 
45 
51 
57 
63 
69 
75 
81 
87 
93 
99 
105 
111 
117 
123 
129 
135 
141 
147 
38 
2 
5 
7 
11 
13 
17 
19 
23 
25 
29 
31 
35 
37 
41 
43 
47 
49 
53 
55 
59 
61 
65 
67 
71 
73 
39 
3 
6 
10 
14 
18 
22 
26 
30 
34 
38 
42 
46 
50 
54 
58 
62 
66 
70 
74 
78 
82 
86 
90 
94 
98 
40 
1 
3 
5 
7 
9 
11 
13 
15 
17 
19 
21 
23 
25 
27 
29 
31 
33 
35 
37 
39 
41 
43 
45 
47 
49 
41 
3 
10 
16 
24 
30 
36 
44 
50 
56 
64 
70 
76 
84 
90 
96 
104 
110 
116 
124 
130 
136 
144 
150 
156 
164 
42 
1 
2 
6 
6 
10 
10 
14 
14 
18 
18 
22 
22 
26 
26 
30 
30 
34 
34 
38 
38 
42 
42 
46 
46 
50 
43 
3 
10 
18 
24 
32 
38 
46 
52 
60 
66 
74 
80 
88 
94 
102 
108 
116 
122 
130 
136 
144 
150 
158 
164 
172 
44 
1 
3 
3 
7 
7 
9 
11 
13 
13 
17 
17 
19 
21 
23 
23 
27 
27 
29 
31 
33 
33 
37 
37 
39 
41 
45 
1 
5 
9 
11 
15 
19 
21 
25 
29 
31 
35 
39 
41 
45 
49 
51 
55 
59 
61 
65 
69 
71 
75 
79 
81 

Table A 
299 
Dimension of ^ki^oiN)) 
^K 
2 
4 
6 
8 
10 
12 
14 
16 
18 
20 
22 
24 
26 
28 
30 
32 
34 
36 
38 
40 
42 
44 
46 
48 
50 
46 
5 
16 
28 
40 
52 
64 
76 
88 
100 
112 
124 
136 
148 
160 
172 
184 
196 
208 
220 
232 
244 
256 
268 
280 
292 
47 
4 
11 
19 
27 
35 
43 
51 
59 
67 
75 
83 
91 
99 
107 
115 
123 
131 
139 
147 
155 
163 
171 
179 
187 
195 
48 
3 
18 
34 
50 
66 
82 
98 
114 
130 
146 
162 
178 
194 
210 
226 
242 
258 
274 
290 
306 
322 
338 
354 
370 
386 
49 
1 
10 
20 
28 
38 
48 
56 
66 
76 
84 
94 
104 
112 
122 
132 
140 
150 
160 
168 
178 
188 
196 
206 
216 
224 
50 
2 
17 
31 
47 
61 
77 
91 
107 
121 
137 
151 
167 
181 
197 
211 
227 
241 
257 
271 
287 
301 
317 
331 
347 
361 
53 
4 
13 
21 
31 
39 
49 
57 
67 
75 
85 
93 
103 
111 
121 
129 
139 
147 
157 
165 
175 
183 
193 
201 
211 
219 
59 
5 
14 
24 
34 
44 
54 
64 
74 
84 
94 
104 
114 
124 
134 
144 
154 
164 
174 
184 
194 
204 
214 
224 
234 
244 
61 
4 
15 
25 
35 
45 
57 
65 
77 
87 
97 
107 
119 
127 
139 
149 
159 
169 
181 
189 
201 
211 
221 
231 
243 
251 
67 
5 
16 
28 
38 
50 
62 
72 
84 
96 
106 
118 
130 
140 
152 
164 
174 
186 
198 
208 
220 
232 
242 
254 
266 
276 
71 
6 
17 
29 
41 
53 
65 
77 
89 
101 
113 
125 
137 
149 
161 
173 
185 
197 
209 
221 
233 
245 
257 
269 
281 
293 
73 
5 
18 
30 
42 
54 
68 
78 
92 
104 
116 
128 
142 
152 
166 
178 
190 
202 
216 
226 
240 
252 
264 
276 
290 
300 
79 
6 
19 
33 
45 
59 
73 
85 
99 
113 
125 
139 
153 
165 
179 
193 
205 
219 
233 
245 
259 
273 
285 
299 
313 
325 
83 
7 
20 
34 
48 
62 
76 
90 
104 
118 
132 
146 
160 
174 
188 
202 
216 
230 
244 
258 
272 
286 
300 
314 
328 
342 
89 
7 
22 
36 
52 
66 
82 
96 
112 
126 
142 
156 
172 
186 
202 
216 
232 
246 
262 
276 
292 
306 
322 
336 
352 
366 
97 
7 
24 
40 
56 
72 
90 
104 
122 
138 
154 
170 
188 
202 
220 
236 
252 
268 
286 
300 
318 
334 
350 
366 
384 
398 
Dimension of yfc°(ro(iV)) 
2 
4 
6 
8 
10 
12 
14 
16 
18 
20 
22 
24 
26 
28 
30 
32 
34 
36 
38 
40 
42 
44 
46 
48 
50 
46 
1 
6 
10 
12 
16 
22 
22 
28 
32 
34 
38 
44 
44 
50 
54 
56 
60 
66 
66 
72 
76 
78 
82 
88 
88 
47 
4 
11 
19 
27 
35 
41 
51 
57 
65 
73 
81 
87 
97 
103 
111 
119 
127 
133 
143 
149 
157 
165 
173 
179 
189 
48 
1 
3 
5 
7 
9 
11 
13 
15 
17 
19 
21 
23 
25 
27 
29 
31 
33 
35 
37 
39 
41 
43 
45 
47 
49 
49 
1 
8 
14 
22 
28 
35 
42 
49 
55 
63 
69 
76 
83 
90 
96 
104 
110 
117 
124 
131 
137 
145 
151 
158 
165 
50 
2 
5 
7 
12 
14 
17 
21 
24 
26 
31 
33 
36 
40 
43 
45 
50 
52 
55 
59 
62 
64 
69 
71 
74 
78 
53 
4 
13 
21 
31 
39 
47 
57 
65 
73 
83 
91 
99 
109 
117 
125 
135 
143 
151 
161 
169 
177 
187 
195 
203 
213 
59 
5 
14 
24 
34 
44 
52 
64 
72 
82 
92 
102 
110 
122 
130 
140 
150 
160 
168 
180 
188 
198 
208 
218 
226 
238 
61 
4 
15 
25 
35 
45 
55 
65 
75 
85 
95 
105 
115 
125 
135 
145 
155 
165 
175 
185 
195 
205 
215 
225 
235 
245 
67 
5 
16 
28 
38 
50 
60 
72 
82 
94 
104 
116 
126 
138 
148 
160 
170 
182 
192 
204 
214 
226 
236 
248 
258 
270 
71 
6 
17 
29 
41 
53 
63 
77 
87 
99 
111 
123 
133 
147 
157 
169 
181 
193 
203 
217 
227 
239 
251 
263 
273 
287 
73 
5 
18 
30 
42 
54 
66 
78 
90 
102 
114 
126 
138 
150 
162 
174 
186 
198 
210 
222 
234 
246 
258 
270 
282 
294 
79 
6 
19 
33 
45 
59 
71 
85 
97 
111 
123 
137 
149 
163 
175 
189 
201 
215 
227 
241 
253 
267 
279 
293 
305 
319 
83 
7 
20 
34 
48 
62 
74 
90 
102 
116 
130 
144 
156 
172 
184 
198 
212 
226 
238 
254 
266 
280 
294 
308 
320 
336 
89 
7 
22 
36 
52 
66 
80 
96 
110 
124 
140 
154 
168 
184 
198 
212 
228 
242 
256 
272 
286 
300 
316 
330 
344 
360 
97 
7 
24 
40 
56 
72 
88 
104 
120 
136 
152 
168 
184 
200 
216 
232 
248 
264 
280 
296 
312 
328 
344 
360 
376 
392 

300 
Numerical Tables 
Dimension of ^fc(<?, (^)) 
fe"M^ 
2 
4 
6 
8 
10 
12 
14 
16 
18 
20 
22 
24 
26 
28 
30 
32 
34 
36 
38 
40 
42 
44 
46 
48 
50 
5 
0 
0 
2 
2 
4 
4 
6 
6 
8 
8 
10 
10 
12 
12 
14 
14 
16 
16 
18 
18 
20 
20 
22 
22 
24 
13 
0 
2 
6 
6 
10 
12 
14 
16 
20 
20 
24 
26 
28 
30 
34 
34 
38 
40 
42 
44 
48 
48 
52 
54 
56 
17 
0 
4 
6 
10 
12 
16 
18 
22 
24 
28 
30 
34 
36 
40 
42 
46 
48 
52 
54 
58 
60 
64 
66 
70 
72 
29 
2 
6 
12 
16 
22 
26 
32 
36 
42 
46 
52 
56 
62 
66 
72 
76 
82 
86 
92 
96 
102 
106 
112 
116 
122 
37 
2 
8 
16 
20 
28 
34 
40 
46 
54 
58 
66 
72 
78 
84 
92 
96 
104 
110 
116 
122 
130 
134 
142 
148 
154 
41 
2 
10 
16 
24 
30 
38 
44 
52 
58 
66 
72 
80 
86 
94 
100 
108 
114 
122 
128 
136 
142 
150 
156 
164 
170 
53 
4 
12 
22 
30 
40 
48 
58 
66 
76 
84 
94 
102 
112 
120 
130 
138 
148 
156 
166 
174 
184 
192 
202 
210 
220 
61 
4 
14 
26 
34 
46 
56 
66 
76 
88 
96 
108 
118 
128 
138 
150 
158 
170 
180 
190 
200 
212 
220 
232 
242 
252 
73 
4 
18 
30 
42 
54 
68 
78 
92 
104 
116 
128 
142 
152 
166 
178 
190 
202 
216 
226 
240 
252 
264 
276 
290 
300 
89 
6 
22 
36 
52 
66 
82 
96 
112 
126 
142 
156 
172 
186 
202 
216 
232 
246 
262 
276 
292 
306 
322 
336 
352 
366 
97 
6 
24 
40 
56 
72 
90 
104 
122 
138 
154 
170 
188 
202 
220 
236 
252 
268 
286 
300 
318 
334 
350 
366 
384 
398 
Dimension of ^k(<?, {<?)) 
i
^
^ 
3 
5 
7 
9 
11 
13 
15 
17 
19 
21 
23 
25 
27 
29 
31 
33 
35 
37 
39 
41 
43 
45 
47 
49 
3 
0 
0 
1 
2 
2 
3 
4 
4 
5 
6 
6 
7 
8 
8 
9 
10 
10 
11 
12 
12 
13 
14 
14 
15 
7 
1 
1 
3 
5 
5 
7 
9 
9 
11 
13 
13 
15 
17 
17 
19 
21 
21 
23 
25 
25 
27 
29 
29 
31 
11 
1 
3 
5 
7 
9 
11 
13 
15 
17 
19 
21 
23 
25 
27 
29 
31 
33 
35 
37 
39 
41 
43 
45 
47 
19 
3 
5 
9 
13 
15 
19 
23 
25 
29 
33 
35 
39 
43 
45 
49 
53 
55 
59 
63 
65 
69 
73 
75 
79 
23 
3 
7 
11 
15 
19 
23 
27 
31 
35 
39 
43 
47 
51 
55 
59 
63 
67 
71 
75 
79 
83 
87 
91 
95 
31 
5 
9 
15 
21 
25 
31 
37 
41 
47 
53 
57 
63 
69 
73 
79 
85 
89 
95 
101 
105 
111 
117 
121 
127 
43 
7 
13 
21 
29 
35 
43 
51 
57 
65 
73 
79 
87 
95 
101 
109 
117 
123 
131 
139 
145 
153 
161 
167 
175 
47 
7 
15 
23 
31 
39 
47 
55 
63 
71 
79 
87 
95 
103 
111 
119 
127 
135 
143 
151 
159 
167 
175 
183 
191 
59 
9 
19 
29 
39 
49 
59 
69 
79 
89 
99 
109 
119 
129 
139 
149 
159 
169 
179 
189 
199 
209 
219 
229 
239 
67 
11 
21 
33 
45 
55 
67 
79 
89 
101 
113 
123 
135 
147 
157 
169 
181 
191 
203 
215 
225 
237 
249 
259 
271 
71 
11 
23 
35 
47 
59 
71 
83 
95 
107 
119 
131 
143 
155 
167 
179 
191 
203 
215 
227 
239 
251 
263 
275 
287 
79 
13 
25 
39 
53 
65 
79 
93 
105 
119 
133 
145 
159 
173 
185 
199 
213 
225 
239 
253 
265 
279 
293 
305 
319 
83 
13 
27 
41 
55 
69 
83 
97 
111 
125 
139 
153 
167 
181 
195 
209 
223 
237 
251 
265 
279 
293 
307 
321 
335 

Table B 
301 
Table B 
For iV = 11, 17 and 19, eigenvalues a^ of T{p) on 5^2(^o(^)) for prime numbers p 
are given. 
For N = 23, 29, 41, 47, 61, 67 and 71, the coefficients of the characteristic 
polynomials F(X) of T{p) on ^2(^o(^)) ^re given. When F{X) is reducible over Q, 
the coefficients of each irreducible factor are presented. They are separated by "/". 
For example, when N = 41 and p = 2, 
1, - 1 , -5,5, - 1 
should be read as 
X'^-X^-SX^ + SX-l, 
and when iV = 61 and p = 2, 
1 1 / 1 - 1 - 3 1 
should be read as 
iX-\-\){X^-X^-3X-\-l). 
We note the order of decomposition is not consistent for p\ 
The polynomial/* in the decomposition for AT = 61, 67 is the part correspond-
ing to the cusp forms invariant by cojy. 

302 
Numerical Tables 
^ 
c^ 
^ 
^ 
Q 
^ 
ex 
^ 
Q 
ex 
ex 
cx 
c^ 
ex 
cx. 
oo 
oo 
1 
i 
^ 
c^ 
m 
r-
S 
o 
7 
as 
1 
(N 
7 
OS 
in 
00 
u^ 
OS 
oo 
oo 
7 
^ 
so 
00 
r^ 
5 
ON 
7 
Tt 
ON 
VO 
1 
en 
OO 
7 
m 
m 
1 
ON 
*0 
ON 
OO 
^ 
^n 
7 
00 
1 
en 
? 
ON 
ON 
7 
r-
o 
g 
1 
ON 
1 
r-
1 
oo 
oo 
o 
OS 
m 
<N 
^ 
00 
00 
^ 
1 
si 
SO 
1 
rsi 
CN 
rsi 
O 
-^ 
-
7 
1 
00 
00 
1 
so 
7 
m 
S 
1 
oo 
CO 
OS 
so 
7 
O 
^ 
m 
o 
ON 
00 
oo 
s 
1 
r-* 
7 
§ 
1 
oo 
so 
o 
OS 
1 
u^ 
OS 
O 
s 
o 
ON 
(N 
ON 
CN 
SO 
1 
ON 
en 
oo 
1 
ON 
ON 
cn 
7 
O 
OS 
ON 
O 
OS 
vO 
r-
NO 
00 
1 
OS 
7 
so 
m 
o 
1 
OS 
00 
o 
OS 
o 
1 
ON 
OS 
vO 
1 
1 
oo 
OS 
m 
1 
oo 
ON 
OS 
ON 
1 
T-H m 
r^ 
S 3 S 
a 
1 
so 
1 
oo 
1 
S 
oo 
7 
m 
r^ 
m 
SO 
1 
O 
in 
in 
1 
ON 
1 
in 
1 
m 
in 
S 
in 
7 
00 
1 
in 
o 
OS 
oo 
1 
^ 
1 
Os 
O 
s 
oo 
5 
1 
in 
so 
1 
in 
in 
7 
OS 
oo 
^ 
m 
so 
o 
7 
^ 
1 
m 
OS 
00 
1 
oo 
o 
OS 
in 
so 
7 
in 
1 
OS 
o 
ON 
NO 
<N 
in 
oo 
m 
1 
NO 
ON 
oo 
S 
00 
1 
in 
<N 
? 
oo 
1 
1 
in 
NO 
1 
m 
in 
ON 
ON 
00 
2; 
VO 
OO 
in 
o 
m 
1 
1 
1 
Tt 
NO 
in 
OS 
in 
1 
OS 
in 
1 
00 
1 
NO 
1 
in 
in 
^ 
OS 
5 
00 
7 
00 
7 
vo 
rv| 
3 
OS 
00 
OS 
in 
ON 
OO 
SO 
7 
m 
oo 
NO 
^ 
OO 00 
1 ^ 
OS OS 
OS ON 
in Tt 
1 -^ 
ON 
m 
m 
in 1 
oo 00 
r- (N 
OS O 
so r-
O 
00 
1 
m OS 
^ 
so so r^ 
in nn in 
r3 
Tf 
00 
SO 
1 
1 
so 
00 
^ 
7 7 
Tf 00 
OS O 
in r^ 
7 
ON 
^ 
r^ 00 
1 
^ 
m 
r- r-

Table B 
303 
c^ 
^ 
ex 
*^ 
<^ 
cx 
^3 
cx 
1^ 
Ci. 
o 
00 
1 
7 
1 
as 
00 
m 
so 
7 
ON 
CN 
as 
1 
rsi 
ON 
in 
00 
'^ 
a\ 
'^ 
00 
IT) 
oo 
so 
m 
so 
00 
^ 
oo 
ON 
ro ON 
^ 5 
1 
<N 
ON 
1 
m 
00 
O 
m 
O 
7 
00 
7 
as 
o 
ON 
00 
1 
in 
so 
oo 
O 
»n 
1 
1 
as 
as 
so 
1 
'^^f 
1 
OS 
as 
c^ 
ON 
^ 
r^ 
so 
1 
OO 
oo 
oo 
04 
ON 
o 
7 
m 
00 
oo 
CN 
^ 
si 
1 
S 
Tt 
7 
oo 
O 
7 
o 
o 
04 
00 
oo 
o 
04 
so 
04 
1 
so 
04 
00 
O 
04 
1 
m 
OO 
7 
04 
1 
04 
Ol 
OO 
o 
11-H 
04 
o 
ON 
04 
04 
so 
1 
so 
SO 
ON 
O 
1 
so 
ON 
04 
OJ 
SO 
s 
1 
ON 
1 
as 
o^ 
04 
1 
00 
1 
ON 
o 
04 
oo 
o 
ON 
»n 
vO 
1 
en 
m 
04 
7 
m 
Tf 
04 
^ 
ON 
o^ 
2; 
7 
ON 
SO 
SO 
so 
O 
04 
00 
04 
so 
so 
7 
as 
m 
OJ 
00 
04 
so 
ON 
04 
O 
m 
1 
ON 
04 
as 
so 
04 
1 
o 
m 
1 
o 
m 
as 
04 
1 
o-
oo 
04 
so 
ON 
o 
«n 
1 
ON 
00 
^ m o-
so so so 
1 
OS 
so 
00 
S 
so 
m 
^ 
m 
o^ 
7 
m 
O 
oo 
1 
as 
04 
04 
so 
1 
04 
1 
04 
1 
1 
04 
1 
oo 
00 
04 
00 
1 
as 
VO 
1 
^ 
04 
r-
^ 
so 
04 
1 
OO 
so 
so 
SO 
04 
04 
»n 
SO 
ON 
oo 
SO 
1 
so 
O^ 
O 
7 
^ 
^ 
04 
Ol 
1 
«n 
as 
^ 
00 
Tf 
ON 
SO 
SO 
m 
1 
04 
SO 
ON 
m 
04 
04 
ON 
SO 
04 
SO 
1 
in 
O 
o 
o-
so 
as 
00 
7 
04 
OO 
00 
S 
so 
5 
7 
§ 
so 
7 
04 
04 
1 
so 
in 
04 
7 
as 
^ 
04 
00 
04 
m 
o-
so 
O^ 
m 
1 
so 
04 
1 
Tf 
Ol 
^ 
CO 
VO 
04 
7 
ON 
00 
o-
ON 
OO 
1 
04 
00 
o 
o-
so 
o 
»n 
oo 
ON 
so 
1 
00 
o^ 
1 
so 
o 
7 
s 
04 
00 
ON 
1 
ON 
O^ 
00 
1 
oo 
so 
1 
so 
04 
04 
Ol 
so 
7 
00 
04 
04 
04 
^ 
so 
04 SO 
1 
^ ^ 
^2 1 
ON CO 
m in 
00 00 
00 oo 
5 S 1 
so r-
00 04 
1 1 
as ^ 
so r--
04 Ol 
en m 
so 04 
7 
ON O 
o4 m 
04 04 
OS '-H 
t^ OO 
^ so 
1 1 
o- r-* 

304 
Numerical Tables 
^ 
^ 
Q 
^ 
^ 
Ci, 
^ 
^ 
Q 
^ 
^ 
(^ 
Q 
ex 
^" 
Ci. 
00 
00 
1 
= 
o 
7 
ON 
1 
m 
m 
as 
00 
OS 
o 
(N 
1 
ON 
00 
»o 
00 
in 
1 
oo 
VO 
oo 
ON 
7 
1 
en 
ON 
«n 
O 
m 
ON 
5 ^ 
O 
1 
1 
m 
OS 
CN 
m 
00 
1 
cn 
SO 
00 
ON 
CN 
ON 
00 
m 
m 
1 
00 
1 
NO 
m 
1 
O N 
O N 
1 
00 
1 
T-H 
ON 
OS 
00 
ON 
7 
r-
t^ r^ oo 
fN Tt 
^ 
1 
^ m r-
00 00 00 
00 00 00 
^ 
Tf CN 
^ 
rv| m 
1 
OS m 
^ 
m Tf m 
r- r-- r-
VO CN ON 
CN m 
CNI 
o o 2 
NO VO VO 
ON ^ 
r^ 
1 1 
^-H m 
r^ 
(N ^ r^ 
m rsi ^ 
r^ r^ ON 
(^ CO C^ 
Tf o rs| 
^-H v-H ^-H 
1 
^-H cn r^ 
^ 
rsi <N 
rs| rs| cN 
VO Tf oo 
1 
^-^ m r-
o o o 
m Tt m 
1 1 
^ m r^ 
oo 
1 
ON 
7 
O N 
VO 1 
in 
ON 
VO 
7 
s 
-^ 
OS 
VO 1 
OS 
VO 
5 
OS 
CN 
r-
^ 
ON 
1 
VO 
m 
O 
m 
ra 
O 
OS 
ON 
ON 
VO 
-
so 
rs 
? 
oo 
SO 
m 
in 
ON 
m 
eN 
VO 
ON 
OO 
1 
OS 
OS 
VO 1 
o 
1 
ON 
1 
00 
7 
00 
7 
ON 
1 
^ ro r-
s s s 
m 
ON 
1 
O 
1 
S 
1 
1 
m 
m 
1 
ON 
m 
r>i 
1 
r-
m 
(N 
o 
1 
00 
O 
in 
7 
ON 
m 
so 1 
Tf 
so 
m 
1 
ON 
OS 
1 
00 
ON 
CO 
1 
CO 
»n 
so 
o 
m 
ON 
OO 
OS 
m 
VO 
CN 
rs 
^ 
7 
oo 
1 
m 
OS 
SO 
7 
00 
o 
1 
so 
oo 
1 
OS 
^ 
ON 
VO 
O 
1 
«n 
en 1 
1 
SO 
OS 
00 
»n 
1 
§ 
VO 
1 
CN 
^ 
CN 
in 
OS 
1 
rsi 
00 
O 
7 
so 
00 
CN 
1 
< * 
1 
1 
ON 
1 
CN 
^ 
VO 
so 
1 
OS 
in 
CN 
OS 
CN 
CN 
00 
1 
CN 
m 
in 
CN 
7 
ON 
SO 
00 
CN 
00 
7 
so 
7 
s 
so 
m 
1 
00 
OS 
so 
7 
ON 
CN 
00 
so 
m 
00 
so 
so 
m 
VO 
in 
00 
CN 
1 
m 
00 
CN 
00 
1 
1 
VO 
1 
OS ON 
OS OS 
00 so 
^ 
CN 
OS 
m 
m in 
00 oo 
r- so 
a\ o 
VO r-
7 1 
OS 
^ 
VO r^ 
in m 
-^ CN 
CN 
1 
CN 
O 
^ 
CN 
1 
O N 
O 
CN m 
00 CN 
7 
OS 
^ 
r- 00 
so r-
1 

Table B 
305 
N = 23 
dim 5^2 (^o(23)) = 2 
p 
2 
] 
3 
] 
5 
] 
7 
] 
11 
1 
13 
] 
17 
1 
19 
1 
23 
] 
29 
] 
31 
] 
37 
] 
41 
] 
43 
] 
47 
] 
53 
] 
59 
] 
61 
] 
67 
] 
71 
] 
73 
1 
79 
] 
83 
1 
89 
] 
97 
1 
101 
] 
103 
] 
107 
] 
109 
] 
113 
] 
127 
] 
131 
] 
137 
] 
139 
1 
149 
] 
151 
1 
157 
] 
163 
1 
167 
] 
173 
] 
179 
] 
181 
] 
191 
] 
193 
1 
197 
1 
199 
] 
211 
] 
223 
] 
227 
1 
229 
1 
233 
] 
239 
] 
241 
] 
251 
] 
257 
1 
263 
1 
1 
[ 
0 
2 
-2 
6 
I 
-3/ 1 
[ 
- 6 
I 
2/ 1 
I 
- 1 / 1 
I 
3/ 1 
I 
0 
[ 
- 2 
[ 
- 2 
[ 
0/ 1 
[ 
0 
[ 
8 
-4 
-4 
10 
-20 
-22 
[ 
4 
22 
12 
-22 
[ 
0 
I -14 
0 
0/ 1 
-22 
28 
-24 
8 
8 
[ -12 
[ 
- 4 
-4 
16 
-12 
-28 
12 
-2 
30 
-2 
-6 
38 
20 
- 4 / 1 
2 
12/ 1 
22 
-32 
6 
-18 
6 
1 
12 
-1 
-5 
-4 
-4 
4 
-3 
4 
2 
-1 
3 
-45 
-4 
-19 
0 
-5 
-4 
-16 
-76 
-20 
95 
101 
-76 
116 
16 
76 
-20 
-76 
-180 
0 
116 
151 
99 
-304 
-29 
-284 
-1 
-176 
59 
16 
116 
-9 
-244 
100 
-79 
-11 
316 
-80 
-4 
-124 
12 
101 
251 
-396 
36 
-11 
-44 
\P 
269 
] 
271 
] 
277 
] 
281 
] 
283 
] 
293 
] 
307 
] 
311 
] 
313 
] 
317 
] 
331 
] 
337 
] 
347 
] 
349 
] 
353 
] 
359 
] 
367 
] 
373 
1 
379 
] 
383 
1 
389 
] 
397 
] 
401 
] 
409 
] 
419 
] 
421 
] 
431 
] 
433 
] 
439 
] 
443 
] 
449 
] 
457 
] 
461 
1 
463 
] 
467 
] 
479 
] 
487 
] 
491 
] 
499 
] 
503 
] 
509 
] 
521 
] 
523 
] 
541 
547 
557 
] 
563 
569 
571 
577 
587 
593 
599 
601 
607 
613 
[ 
- 2 
[ 
- 8 / 1 
[ 
-22 
[ 
22 
[ 
-42 
I 
12 
[ 
-28 
I 
- 4 
I 
- 4 
[ 
- 2 4 
I 
8 
[ 
-20 
[ 
-16 
[ 
-22 
[ 
26 
[ 
4 
[ 
-14 
I 
- 2 
1 
- 4 
I 
-32 
I 
-60 
[ 
22 
I 
6 
I 
2 
I 
36 
I 
34 
I 
44 
I 
-58 
I 
24 
[ 
-36 
I 
12 
[ 
- 3 0 
I 
- 6 
I 
20/ 1 
[ 
4 4 
I 
-14 
I 
16 
I 
-48 
I 
-52 
I 
36 
I 
- 6 
I 
-36 
I 
-42 
I 
42 
I 
- 8 
I 
-12 
I 
48 
I 
22 
I 
42 
I 
-10 
I 
36 
I 
-12 
I 
-32 
[ 
-58 
I 
-44 
I 
2 
-79 
-8 
101 
116 
396 
16 
176 
-121 
-496 
-36 
-229 
-80 
-256 
-59 
-331 
-316 
-76 
-44 
-496 
176 
880 
-59 
-116 
-499 
144 
244 
464 
716 
99 
-81 
-44 
-180 
-11 
20 
404 
-556 
19 
331 
631 
244 
-971 
144 
36 
261 
-1109 
-144 
496 
-4 
396 
-295 
279 
-44 
-64 
521 
464 
-44 
P 
617 
1 
619 
1 
631 
1 
641 
1 
643 
1 
647 
1 
653 
1 
659 
1 
661 
1 
673 
1 
677 
1 
683 
1 
691 
1 
701 
1 
709 
1 
719 
] 
727 
] 
733 
] 
739 
] 
743 
1 
751 
1 
757 
] 
761 
] 
769 
] 
773 
] 
787 
] 
797 
] 
809 
] 
811 
] 
821 
] 
823 
] 
827 
] 
829 
] 
839 
] 
853 
] 
857 
] 
859 
863 
877 
881 
883 
887 
907 
911 
919 
929 
937 
941 
947 
953 
967 
971 
977 
983 
991 
997 
24 
-12 
20 
-28 
10 
0 
14 
-10 
28 
-3/ 1 
-18/ 1 
-4 
-32 
30 
26 
24 
42 
58 
-76 
-42 
44 
46 
-30 
6 
[ 
20 
[ 
-76 
[ 
24 
I 
-60 
I 
80 
I 
60 
I 
12 
I 
-12 
I 
0 
I 
42 
I 
48 
I 
6 
I 
20 
I 
-24 
I 
64 
I 
-66 
1 
- 4 / 1 
1 
12 
1 
0 
I 
0 
I 
-42 
1 
66 
I 
-46 
I 
18 
1 
44 
1 
-32 
1 
12 
I 
-24 
1 
78 
1 
72 
1 
-24/ 1 
1 
20 
124 
-144 
-400 
-784 
-580 
-45 
-931 
-220 
116 
-3 
-18 
-601 
176 
100 
-676 
64 
396 
836 
1319 
36 
-16 
-76 
-755 
-396 
80 
1264 
-356 
580 
1355 
820 
-1089 
16 
-1620 
36 
396 
-11 
55 
-981 
1004 
964 
-4 
-809 
-1620 
-980 
36 
1009 
404 
164 
359 
236 
-1089 
124 
1276 
1276 
-24 
-620 

306 
Numerical Tables 
TV = 29 
dim ^2(^o(29)) = 2 
p 
2 
3 
5 
7 
11 
13 
17 
19 
23 
29 
31 
37 
41 
43 
47 
53 
59 
61 
67 
71 
73 
79 
83 
89 
97 
101 
103 
107 
109 
113 
127 
131 
137 
139 
149 
151 
157 
163 
167 
] 
173 
] 
179 
] 
181 
] 
191 
193 
197 
199 
] 
211 
223 
227 
229 
233 
239 
241 
251 
257 
263 
1 
2 
1 
- 2 
1 
1/ 
1 
0 
I 
- 2 
1 
2 
1 
4 
1 
-6/ 
1 
4 
I 
- 1 / 
1 
- 6 
I 
4/ 
1 
- 8 
1 
-10 
I 
- 2 
I 
- 2 
I 
- 4 
I 
4 
I 
0 
I 
12 
I 
- 4 / 
1 
2 
[ 
- 4 
1 
8 
[ 
8 
I 
16 
I 
4 
I 
24 
1 
-14 
1 
4 
I 
20 
[ 
-20 
I -12/ 
1 -14/ 
I 
10 
1 
0 
I 
0 
[ 
-22 
I 
12 
I 
-36 
1 
- 4 
I 
6 
I 
-28 
I 
16 
I 
- 2 / 
I 
-16 
I 
2 
1 
12 
1 
-12 
I 
24 
I 
-14 
I 
28 
I 
14 
1 
-26 
I 
42 
I 
-14 
-1 
-1 
1 
1 
-8 
-1 
-7 
-4 
1 - 6 
-28 
1 -1 
-41 
1 
4 
-56 
23 
-17 
-71 
-28 
-4 
-32 
28 
1 
- 4 
-1 
-28 
-56 
-56 
32 
-4 
136 
17 
-124 
68 
-28 
1 -12 
1 -14 
17 
-200 
-72 
71 
28 
292 
-68 
-119 
68 
56 
1 
- 2 
-8 
-337 
28 
-164 
72 
-79 
164 
-79 
119 
433 
31 
P 
269 
] 
271 
] 
277 
] 
281 
] 
283 
] 
293 
] 
307 
] 
311 
313 
317 
] 
331 
337 
] 
347 
349 
353 
359 
367 
373 
379 
383 
] 
389 
] 
397 
401 
409 
419 
421 
431 
433 
1 
439 
1 
443 
] 
449 
1 
457 
461 
1 
463 
] 
467 
] 
479 
1 
487 
1 
491 
1 
499 
1 
503 
] 
509 
521 
] 
523 
] 
541 
] 
547 
] 
557 
1 
563 
] 
569 
] 
571 
] 
577 
] 
587 
593 
599 
] 
601 
] 
607 
] 
613 
I 
-12 
I 
- 2 
I 
12 
1 
-30 
[ 
-12 
1 
- 4 
[ 
14 
I 
-28 
I 
-14 
I 
12 
I 
2 
I 
- 4 
I 
12 
I 
-18 
1 
-20 
I 
-22 
I 
-18/ 
I 
30 
I 
-20 
I 
24 
I 
-40 
I 
-50 
26 
I 
4 
36 
-12 
I 
-28 
-16 
12 
60 
36 
I 
-36 
I 
-14/ 
26/ 
I 
6 
I 
6 
[ 
40 
34 
-4 
1 
-26 
I 
38 
30 
-32 
I 
32 
I 
-32 
I 
12 
I 
10 
[ 
68 
I 
16 
I 
20 
1 
- 4 
I 
22 
I 
34 
I 
40 
I 
-10 
I 
9/ 
-612 
-241 
-92 
-63 
4 
-28 
-49 
68 
41 
-612 
-1 
-388 
-36 
-119 
-188 
71 
1 -18 
97 
-188 
72 
112 
593 
137 
-284 
252 
-932 
164 
-448 
4 
868 
36 
36 
1 -14 
1 
26 
-1241 
-89 
328 
271 
-284 
7 
289 
25 
128 
224 
-136 
-92 
7 
1124 
-448 
-292 
-28 
49 
-433 
392 
-137 
1 
9 
P 
617 
1 
619 
] 
631 
1 
641 
] 
643 
] 
647 
] 
653 
] 
659 
] 
661 
] 
673 
] 
677 
] 
683 
] 
691 
] 
701 
] 
709 
] 
719 
] 
727 
] 
733 
] 
739 
] 
743 
1 
751 
] 
757 
] 
761 
1 
769 
] 
773 
787 
] 
797 
] 
809 
811 
821 
823 
827 
829 
839 
853 
857 
859 
863 
877 
881 
883 
887 
907 
911 
919 
929 
937 
941 
947 
953 
967 
971 
977 
983 
991 
997 
-24 
-70 
68 
4 
-48 
-68 
32 
[ 
-26 
-44 
[ 
- 2 
I 
22/ 
I 
- 8 
I 
-48/ 
I 
18 
I 
-30 
1 
12 
1 
20 
I 
- 8 
I 
6 
I 
-36 
1 
-28 
I 
-68 
1 
-12 
1 
36 
I 
56 
1 
12 
I 
4 
I 
-16 
I 
-16 
1 
-14 
I 
52 
[ 
-46 
1 
20 
I 
30 
[ 
12 
I 
18 
I 
-14 
I 
28 
[ 
46 
I 
-14/ 
1 
8 
I 
-54 
I 
12 
I 
62 
I 
12 
I 
-60 
I 
-12 
I 
34 
1 
-42 
I 
26 
I 
62 
1 
20 
1 
-78 
1 
-10 
1 
20 
1 
0 
16 
1223 
1148 
-388 
504 
1124 
56 
167 
356 
-511 
1 
22 
-272 
1 
-48 
-887 
25 
-164 
-28 
-2032 
-41 
292 
68 
1084 
-1532 
-644 
712 
-2276 
-2884 
-736 
56 
-23 
-124 
431 
-292 
175 
-252 
73 
-113 
-772 
329 
1 
-14 
-1784 
631 
-764 
719 
-164 
772 
-476 
-1279 
103 
-343 
943 
68 
1513 
-697 
92 
-800 

Table B 
307 
yv = 4i 
dim ^2irom)) = 3 
p 
2 
3 
5 
7 
11 
13 
17 
19 
23 
29 
31 
37 
41 
43 
47 
53 
59 
61 
67 
71 
73 
79 
83 
89 
97 
101 
103 
107 
] 
109 
113 
127 
131 
U7 
139 
149 
151 
157 
] 
163 
] 
167 
] 
173 
] 
179 
] 
181 
] 
191 
1 
193 
1 
197 
] 
199 
] 
211 
] 
223 
] 
227 
] 
229 
] 
233 
] 
239 
] 
241 
] 
251 
] 
257 
] 
1 
1 
I 
0 
1 
2 
I 
- 6 
I 
- 2 
I 
2 
I 
2/ 1 
I 
- 4 
I 
- 4 
I 
6 
I 
-16 
I 
6 
I 
-1/1 
I 
• 4 
I 
0 
I 
- 6 
I 
8 
I 
- 2 
I 
2 
I 
-20 
I 
2 
I 
-32 
1 
0 
1 
6 
I 
- 6 
1 
-18 
1 
4 
I 
16 
I 
6 
I 
- 6 
I 
-16 
I 
20 
1 
-18 
I 
12 
1 
-10 
I 
-28 
I 
14 
I 
16 
I 
14 
I 
30 
1 
- 2 
34 
[ 
-14 
26 
1 
-50 
I 
-46 
I 
-10 
I 
8 
I 
- 8 
I 
6 
1 
-26 
[ 
- 1 6 
I 
- 6 
I 
28 
I 
-10 
-5 
-4 
-4 
8 
-20 
-12 
2/ 
-16 
-32 
-4 
64 
-36 
-1/1 
-8 
-120 
-4 
-16 
-52 
-20 
84 
-180 
328 
-64 
-148 
-52 
-12 
-256 
0 
-124 
-148 
48 
80 
-148 
-352 
-212 
196 
-172 
32 
28 
236 
-296 
140 
-412 
188 
780 
612 
-160 
-64 
-28 
-268 
-116 
-48 
-388 
208 
-276 
-1 
2 
-4 
-2 
50 
-8 
1 
2 
-10 
-32 
-40 
-32 
-108 
-1 
-16 
-502 
8 
-160 
184 
-50 
134 
244 
-1090 
-128 
-920 
248 
488 
-1424 
-256 
-760 
-116 
-32 
-208 
2344 
-3680 
1720 
-338 
-2392 
-128 
-122 
232 
-610 
-2264 
3562 
248 
-3592 
-2510 
1382 
-256 
214 
-1240 
4616 
430 
2792 
464 
-344 
P 
263 
269 
271 
277 
281 
283 
293 
307 
311 
313 
317 
331 
337 
347 
349 
353 
359 
367 
373 
379 
] 
383 
] 
389 
] 
397 
401 
409 
1 
419 
] 
421 
] 
431 
] 
433 
439 
] 
443 
] 
449 
] 
457 
] 
461 
] 
463 
] 
467 
] 
479 
] 
487 
] 
491 
] 
499 
] 
503 
] 
509 
] 
521 
] 
523 
] 
541 
] 
547 
] 
557 
] 
563 
1 
569 
] 
571 
] 
577 
1 
587 
] 
593 
] 
599 
] 
601 
] 
I 
-20 
I 
-10 
I 
4 
I 
2 
I 
-38 
I 
4 
I 
-42 
I 
40 
I 
-10 
I 
34 
I 
42 
I 
- 6 
I 
38 
I 
-12 
I 
50 
I 
22 
I 
24 
I 
16 
I 
54 
I 
-48 
I 
22 
I 
- 2 
I 
-22 
I 
6 
I 
- 6 
[ 
4 
[ 
- 2 2 
I 
12 
I 
-30 
I 
-50 
1 
-80 
I 
-22 
I 
-10 
I 
38 
4 
I 
56 
1 
2 
[ 
- 8 
I 
8 
I 
-48 
I 
40 
[ 
50 
[ 
42 
[ 
-20 
[ 
-30 
[ 
68 
[ 
50 
[ 
-58 
[ 
- 2 
i 
6 
[ 
46 
I 
18 
[ 
38 
I 
40 
I 
-26 
-740 
-228 
-16 
-332 
428 
-448 
140 
480 
-360 
76 
452 
-576 
164 
-144 
828 
-172 
-256 
-216 
716 
656 
-32 
-596 
68 
-700 
-436 
-1224 
-100 
-424 
-1044 
-268 
2048 
76 
-116 
300 
-516 
1024 
-192 
-1552 
-352 
764 
176 
532 
188 
-720 
-436 
1168 
684 
732 
-44 
-1212 
364 
104 
-564 
-432 
-116 
12506 
-200 
-32 
2116 
-1352 
-1376 
5528 
1808 
-1718 
-712 
344 
4658 
-3676 
1678 
4540 
-4388 
-6400 
-1648 
2248 
-2720 
-1798 
3560 
152 
-5132 
-2740 
80 
2600 
-4688 
29592 
25750 
-16976 
520 
1096 
100 
1286 
6112 
670 
2416 
-3616 
-4030 
-3098 
-200 
-712 
5696 
14044 
3622 
2536 
-1934 
20 
-9838 
-2008 
194 
-9176 
-160 
1928 

308 
Numerical Tables 
iV = 47 
dim5^2(/;)(47)) = 4 
p 
2 
] 
3 ] 
5 ] 
7 ] 
11 ] 
13 ] 
17 ] 
19 ] 
23 ] 
29 ] 
31 ] 
37 ] 
41 
] 
43 ] 
47 ] 
53 ] 
59 ] 
61 
] 
67 ] 
71 
] 
73 ] 
79 ] 
83 ] 
89 ] 
97 ] 
101 
] 
103 ] 
107 ] 
109 ] 
113 ] 
127 ] 
131 ] 
137 ] 
139 ] 
149 ] 
151 ] 
157 ] 
163 ] 
167 ] 
173 ] 
179 ] 
181 
] 
191 
] 
193 ] 
197 ] 
199 ] 
211 
] 
223 
] 
227 ] 
229 
] 
233 
] 
239 
] 
241 
] 
251 
] 
257 ] 
I 
- 1 
I 
0 
I 
2 
I 
- 4 
I 
6 
I 
- 8 
I 
- 6 
I 
0 
I 
6 
I 
10 
I 
8 
I 
- 1 0 
I 
- 6 
I 
- 2 
I . - 1 / 
I 
6 
I 
- 4 
I 
6 
I 
-10 
I 
12 
I 
-22 
L 
-20 
I 
- 2 0 
I 
6 
[ 
-30 
I 
22 
[ 
20 
I 
- 1 2 
I 
6 
I 
4 
I 
- 2 2 
I 
-28 
I 
-36 
[ 
28 
I 
6 
[ 
0 
I 
2 
I 
- 6 
I 
- 6 
I 
42 
L 
-28 
[ 
36 
[ 
-20 
[ 
-48 
[ 
12 
[ 
2 
[ 
- 2 
[ 
2 
[ 
14 
[ 
-10 
[ 
- 2 
[ 
- 8 
[ 
-18 
[ 
4 
[ 
24 
-5 
-7 
-16 
-7 
-4 
0 
-21 
-16 
-20 
20 
0 
15 
-8 
-80 
1 - 1 / 
-101 
-115 
-73 
-120 
-19 
60 
77 
80 
-161 
179 
35 
77 
-84 
-276 
-216 
-76 
173 
376 
-136 
-189 
-224 
-25 
-56 
-60 
503 
0 
408 
-48 
732 
-336 
-300 
-652 
-824 
-248 
-768 
-192 
-475 
-165 
-667 
-264 
5 
4 
-16 
44 
-56 
56 
74 
-8 
-40 
-8 
-56 
34 
32 
-112 
1 - 1 / 
-314 
704 
10 
752 
-320 
1368 
240 
192 
206 
1634 
-1398 
-240 
848 
-1064 
-1656 
4088 
-144 
-1256 
-7992 
-1030 
8 
-78 
304 
152 
1234 
3184 
1304 
320 
-4208 
-2224 
-2952 
4344 
-928 
-2896 
8272 
-1216 
472 
3382 
1888 
-3080 
_1 
1 
48 
-43 
-48 
48 
141 
16 
-16 
-16 
48 
9 
-16 
432 
1 - 1 
2429 
-519 
337 
3184 
657 
-7664 
-47 
-256 
4841 
-14307 
-5903 
-47 
1488 
5776 
-3024 
-20688 
-199 
368 
-41488 
721 
12368 
-59 
-304 
912 
-371 
752 
-1328 
768 
7984 
7984 
-7472 
17872 
39056 
8912 
2576 
-2128 
8741 
-11723 
21441 
6576 
P 
263 
269 
271 
277 
281 
. 283 
293 
307 
311 
313 
317 
331 
337 
347 
349 
353 
359 
367 
373 
379 
383 
389 
397 
401 
409 
419 
4^1 
431 
433 
439 
443 
449 
457 
461 
463 
467 
479 
487 
491 
499 
503 
509 
521 
523 
541 
547 
557 
563 
569 
571 
577 
587 
593 
599 
601 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
16 
-32 
44 
14 
-26 
52 
-6 
-48 
26 
6 
-20 
56 
-90 
16 
-18 
30 
0 
4 
-24 
24 
-16 
42 
74 
42 
0 
8 
-2 
12 
-18 
-20 
6 
26 
-62 
-56 
-22 
-24 
0 
-20 
12 
-36 
40 
16 
-58 
-20 
26 
26 
-6 
-16 
20 
-32 
26 
-84 
-14 
40 
-6 
-467 
168 
101 
-357 
-56 
757 
-592 
689 
-400 
-248 
-592 
977 
3003 
-803 
-524 
-441 
-312 
-304 
-616 
141 
-171 
344 
2027 
67 
-544 
-868 
-112 
-1099 
-32 
-576 
-744 
-296 
899 
288 
-1412 
-712 
-559 
-224 
-375 
376 
-64 
-184 
415 
-624 
-853 
-604 
-1408 
-216 
-16 
321 
140 
2160 
-500 
-152 
-365 
-3376 
2432 
-16720 
-6350 
2704 
760 
2000 
-2212 
-10656 
-1792 
10216 
4524 
-44026 
-10336 
4232 
-16902 
-2776 
64 
18536 
-104 
1984 
-656 
24398 
-11594 
-4160 
-4240 
112 
-21728 
1216 
17024 
-5536 
-11536 
1158 
24896 
25048 
4064 
1348 
640 
-2012 
-328 
-10248 
-3072 
13186 
3136 
-28918 
-15880 
-13024 
5016 
-856 
-932 
-88 
-16832 
4040 
-10784 
-2414 
56349 
-17328 
-182799 
-22639 
8144 
-30439 
72208 
-9839 
-47248 
3824 
21936 
-12911 
239373 
103341 
49616 
-80919 
-6704 
5888 
-103184 
-1523 
10629 
-752 
109001 
-73039 
9472 
104816 
2832 
-56807 
-2128 
-108288 
10512 
-70864 
-35303 
-320256 
7824 
59152 
18217 
-256 
21973 
-8752 
-29872 
-5552 
10089 
256 
-204739 
-43984 
-13584 
-22544 
1008 
-719 
-1296 
40192 
-7536 
27728 
-3259 

Table B 
309 
AT = 61 
P 
Y 
3 
5 
7 
11 
13 
17 
19 
23 
29 
31 
37 
41 
43 
47 
53 
59 
61 
67 
71 
73 
79 
83 
89 
97 
101 
103 
107 
109 
113 
127 
131 
137 
139 
149 
151 
157 
163 
167 
173 
179 
181 
191 
193 
197 
199 
211 
223 
227 
229 
233 
239 
241 
251 
257 
d 
Fix) =f* 
~1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
I 
1 
1 
1 
1/ 1 
2/ 1 
3/ 1 
-1/ ] 
5/ 1 
-1/ 1 
- 4 / 1 
4/ ] 
9/ ] 
6/ 1 
0/ ] 
- 8 / ] 
-5/ ] 
8/ 
] 
- 4 / 1 
-6/ 1 
-9/ 1 
1/ ] 
7/ 1 
8/ 1 
11/ 1 
-3/ 1 
- 4 / 1 
4/ 1 
14/ 1 
0/ 1 
- 4 / 1 
2/ 1 
17/ 1 
- 1 / 1 
-6/ 1 
16/ 1 
-9/ 1 
11/ 1 
-19/ 1 
-11/ 1 
4/ 1 
-18/ 1 
12/ 1 
-10/ 1 
18/ 1 
-8/ 1 
-3/ 1 
8/ 1 
3/ 1 
-6/ 1 
- 4 / 1 
-23/ 1 
-21/ 1 
-9/ 1 
14/ 1 
- 2 / 1 
3/ 1 
12/ 1 
22/ 1 
ini5^2(ro(61)) = 4 
ix)f{x) 
[ -
1 
[ 
- 2 
I 
1 
[ 
3 
[ - 1 3 
9 
[ 
2 
[ 
0 
[ 
- 5 
[ 
- 4 
2 
6 
[ 
- 3 
[ 
14 
4 
2 
-29 
-1/ 
-9 
-14 
1 
-13 
8 
4 
-10 
10 
-12 
-26 
-13 
9 
18 
-8 
-3 
3 
-9 
-3 
10 
-10 
32 
10 
-42 
20 
-31 
20 
29 
50 
-22 
11 
-11 
9 
40 
38 
-7 
-38 
-2 
-3 
-4 
-9 
-1 
53 
11 
-8 
-48 
5 
-4 
-76 
-36 
-61 
56 
-88 
-12 
231 
1 
- 1 / 
-85 
-12 
-45 
-51 
-64 
-56 
-116 
0 
0 
92 
3 
-133 
68 
-24 
-253 
-1 
11 
-277 
-300 
-284 
148 
-4 
476 
-80 
139 
80 
203 
812 
-52 
-183 
-483 
-133 
440 
404 
-345 
296 
-36 
1 
4 
-13 
-1 
-67 
-37 
4 
-20 
1 
20 
116 
-108 
191 
68 
16 
-8 
-325 
1 
-1 
559 
92 
-25 
625 
-256 
80 
1096 
-148 
108 
1096 
145 
-1061 
52 
92 
859 
-5 
5 
2033 
-3412 
-668 
-1604 
-8 
-760 
-1088 
-167 
-64 
323 
4280 
764 
-1343 
5891 
-25 
796 
1220 
1675 
-548 
184 
P 
26r 
269 
1 271 
277 
281 
283 
293 
307 
311 
313 
317 
331 
337 
347 
349 
353 
359 
367 
373 
379 
383 
389 
397 
401 
409 
419 
421 
431 
433 
439 
443 
449 
457 
461 
463 
467 
479 
487 
491 
499 
503 
509 
521 
523 
541 
547 
557 
563 
569 
571 
577 
587 
593 
599 
601 
F{x)=f*{x)f{x) 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
^ 
16/ 
18/ 
--14/ 
-10/ 
0/ 
-6/ 
-18/ 
19/ 
15/ 
6/ 
30/ 
17/ 
2/ 
-8/ 
24/ ] 
-19/ 
-12/ 
-14/ 
10/ 
14/ ] 
-5/ ] 
14/ ] 
-8/ ] 
-16/ ] 
-30/ ] 
- 4 / ] 
-8/ ] 
-6/ ] 
8/ ] 
0/ ] 
-12/ ] 
35/ ] 
20/ -
18/ ] 
4/ ] 
-11 ] 
-14/ ] 
12/ ] 
28/ ] 
-13/ ] 
-10/ 1 
-28/ 1 
20/ ] 
9/ ] 
-28/ 1 
29/ ] 
28/ 1 
10/ ] 
15/ ] 
-38/ ] 
-10/ 1 
-32/ ] 
6/ ] 
35/ 1 
43/ ] 
I 
28 
I 
10 
I 
2 
I 
- 4 
I -28 
I -34 
I 
2 
I 
- 7 
1 -15 
I 
30 
I -58 
t 
13 
I -26 
I -32 
I -14 
I 
15 
I -14 
I 
38 
I -24 
I -18 
I 
37 
I 
34 
I 
- 6 
I 
28 
I 
2 
I -50 
I 
- 2 
I 
- 2 
I 
44 
I 
44 
I 
4 
I 
29 
-90 
I 
- 6 
I -36 
[ 
21 
I -22 
I -20 
I 
- 8 
I -45 
I 
22 
[ 
5 8 
[ 
5 8 
I 
19 
I 
8 
[ 
31 
[ 
40 
L 
22 
[ 
1 
[ 
46 
[ 
- 8 
[ 
22 
[ -12 
L -45 
[ -15 
20 
-268 
-496 
-256 
176 
232 
-668 
-291 
-43 
188 
1068 
35 
-748 
264 
-116 
-1009 
-564 
428 
-532 
-696 
297 
324 
-580 
208 
-196 
-92 
-8 
-388' 
584 
464 
-256 
191 
2672 
-756 
-48 
35 
-76 
-176 
-164 
-225 
-48 
1076 
140 
-483 
-928 
169 
320 
-212 
-33 
252 
-512 
-268 
0 
-225 
-205 
-2732 
-1160 
-2404 
92 
272 
-68 
856 
919 
823 
-536 
-6344 
25 
17896 
-556 
-380 
-18043 
8780 
1352 
7108 
12580 
131 
920 
6652 
464 
680 
21380 
-4 
-1304 
2096 
860 
-1424 
335 
-26108 
2808 
3904 
-691 
-40 
-4 
-388 
16875 
-604 
6340 
-23300 
-871 
8576 
137 
-512 
-4588 
-85 
344 
5996 
-1916 
108 
16875 
587 

310 
Numerical Tables 
N = 61 
P 
2 
3 
5 
7 
11 
13 
17 
19 
23 
29 
31 
37 
41 
43 
47 
53 
59 
61 
67 
71 
73 
79 
83 
89 
97 
101 
103 
107 
] 
109 
] 
113 
127 
] 
131 
] 
137 
] 
139 
] 
149 
] 
151 
] 
157 
] 
163 
] 
167 
] 
173 
] 
179 
] 
181 
] 
191 
] 
193 
] 
197 
] 
199 
] 
211 
] 
223 
] 
227 
] 
229 
] 
233 
] 
239 
] 
241 
1 
251 
] 
257 
] 
dim^(ro(67)) = t 
F{x)=f*{x)Mx)Mx) 
I 
3 
I 
3 
I 
3/ 
1 
I 
1 
I 
0 
1 
7 
I 
6 
1 
- 1 
I 
- 6 
I 
6 
[ 
1/ 
1 
I 
1 
I 
3 
I 
- 3 
I 
15 
I 
9/ 
1 
I 
- 6 / 
1 
I 
7 
I 
1/ 
1 
I 
12 
I 
4/ 
1 
I 
7 
I 
15 
I 
0 
I 
- 2 
I 
9 
I 
5 
I 
- 2 4 
I 
3 
I 
- 3 3 
I 
5 
I 
3/ 
1 
I 
12 
I 
3/ 
1 
I 
- 9 
I 
1/ 
1 
I 
- 1 3 
I 
7 
I 
- 1 2 
-
[ 
39 
I 
18 
[ 
7 
[ 
6 
[ 
- 2 7 
I 
18 
[ 
13 
-
[ 
11 
[ 
- 1 8 
[ 
3 
-
[ 
31 
[ 
- 1 2 
[ 
27 
[ 
- 4 5 
[ 
- 1 8 
[ 
18 
1/ 
1/ 
] 
3/ 
- 1 1 / 
- 5 / 
1/ 
] 
4/ 
- 1 1 / 
- 1 1 / 
- 1 1 / 
] 
1/ 
] 
- 1 1 / 
] 
1/ 
] 
- 9 / 
55/ 
] 
9/ 
- 6 / 
- 8 9 / 
] 
1/ 1 
31/ 
] 
4/ 
] 
- 8 9 / 
] 
- 5 / 
] 
- 5 / 
] 
-179/ 
] 
- 1 1 / 
] 
- 9 5 / 
] 
99/ 
] 
- 9 / 
] 
271/ 
] 
- 5 / 
] 
3/ 
] 
- 9 / 
] 
3/ 
] 
- 1 9 1 / 
] 
1/ 
] 
- 5 9 / 
] 
1/ 
1 
-284/ 
] 
349/ 
] 
76/ 
] 
- 8 9 / 
] 
- 1 1 / 
] 
171/ 
] 
61/ 
] 
-239/ 
] 
19/ 
] 
36/ 
1 
-359/ 
J 
229/ 
] 
16/ 
] 
151/ 
1 
495/ 
] 
76/ 
1 
-239/ 
] 
I 
- 2 / 
I 
2/ 
] 
I 
- 2 / 
] 
I 
2/ 
] 
I 
4/ 
] 
I 
- 2 / 
] 
I 
- 3 / 
] 
I 
- 7 / 
] 
I 
- 9 / 
] 
I 
5/ 
] 
I 
10/ 
] 
I 
1/ 
] 
I 
0/ 
] 
I 
2/ 
] 
I 
1/ 
] 
I 
- 1 0 / 
] 
I 
- 9 / 
] 
I 
2/ 
] 
I 
- 1 / 
I 
0/ 
] 
I 
7/ 
] 
I 
8/ 
] 
I 
- 4 / 
] 
I 
- 7 / 
] 
I 
0/ 
] 
[ 
- 2 / 
] 
[ 
16/ 
] 
I 
7/ 
] 
I 
- 2 / 
] 
I 
12/ 
] 
L 
- 7 / 
] 
[ 
12/ 
] 
[ 
- 1 2 / 
] 
[ 
- 2 2 / 
] 
I 
- 2 1 / 
] 
[ 
- 3 / 
] 
[ 
- 9 / 
] 
[ 
- 1 9 / 
] 
[ 
- 2 4 / 
] 
[ 
- 1 1 / 
] 
[ 
12/ 
] 
L 
- 7 / 
] 
L 
6/ 
] 
[ 
23/ 
] 
[ 
2/ 
] 
[ 
- 7 / 
] 
[ 
12/ 
] 
[ 
- 1 1 / 
] 
[ 
- 3 / 
] 
[ 
- 4 / 
1 
[ 
- 1 0 / 
] 
I 
20/ 
] 
[ 
19/ 
] 
[ 
2/ 
] 
i 
1/ 
] 
I 
1 
I 
- 1 
I 
- 4 
I 
- 1 
I 
- 1 / 
1 
I 
1 
I 
- 6 
I 
11 
I 
2 
I 
- 1 0 
I 
0 
I 
- 3 
I 
- 5 
I 
9 
I 
7 
I 
0 
I 
6/ 
1 
I 
9 
I 
- 1 / 
1 
I 
0 
I 
- 8 / 
1 
i 
11 
I 
- 1 3 
i 
16 
i 
0 
I 
- 1 9 
I 
- 3 
i 
- 1 6 
I 
- 9 
I 
- 1 1 
I 
21 
L 
- 6 
[ 
26 
[ 
- 2 4 
i 
3 
I 
- 6 
L 
- 1 3 
L 
- 1 3 
[ 
- 1 4 / 
1 
i 
- 1 7 
i 
-6 
i 
11 
[ 
32 
L 
1 
i 
- 3 6 
L 
- 3 9 
i 
- 1 
[ 
-2 
i 
- 2 1 
I 
7 
[ 
20 
L 
- 1 5 
[ 
- 1 7 
I 
14 
I 
2 
— 1 
- 1 
- 1 
- 1 
- 1 
- 1 
4 
29 
- 1 9 
5 
- 4 5 
1 
- 2 5 
- 1 1 
11 
- 4 5 
6 
9 
- 1 
- 2 4 5 
- 8 
- 3 1 
31 
19 
- 4 5 
59 
1 
19 
- 1 1 
- 7 1 
79 
- 1 1 
149 
139 
- 5 9 
- 7 1 
- 2 3 9 
41 
- 1 4 
61 
- 3 6 
19 
211 
- 1 
319 
349 
- 6 1 
- 4 0 4 
- 1 7 1 
- 2 6 9 
- 8 0 
- 1 5 5 
11 
- 1 9 6 
- 7 9 

Table B 
311 
N = 71 
dim5^2(^o(71)) = 6 
p 
F{x)=Mx)Mx) 
2 
] 
3 
] 
5 
] 
7 
] 
11 
] 
13 
] 
17 
] 
19 
] 
23 
] 
29 
] 
31 
] 
37 
] 
41 
] 
43 
] 
47 
1 
53 
] 
59 
] 
61 
] 
67 
] 
71 
] 
73 
1 
79 
] 
83 
] 
89 
] 
97 
] 
101 
] 
103 
1 
107 
1 
109 
1 
113 
] 
127 
] 
131 
1 
137 
] 
139 
] 
149 
1 
151 
] 
157 
] 
163 
1 
167 
173 
179 
181 
191 
193 
] 
197 
199 
211 
223 
227 
229 
233 
239 
241 
251 
257 
I 
0 
I 
1 
I 
3 
I 
- 2 
I 
2 
I 
- 4 / 1 
I 
- 2 
I 
-11 
i 
4/ 1 
I 
5 
-4/ 1 
I 
- 9 
I 
-14 
I 
17 
I 
10 
I 
0 
22 
I 
- 8 
12 
1 
- 1 / 1 
I 
- 3 
I 
- 7 
-23 
I 
-13 
I 
- 4 
I 
3 
9 
12 
I 
-19 
I 
0 
26 
I 
13 
I 
22 
-26 
10 
27 
1 
7 
-10 
1 
-55 
1 
6 
3 
I 
-38 
1 
23 
1 
2 
0 
1 
25 
1 
-14 
1 
- 5 
I 
- 4 
1 
-23 
I 
21 
I 
46 
I 
-62 
I 
- 7 
I 
12 
-5 
-8 
-2 
-16 
-16 
-4/ 
-16 
36 
4/ 
-2 
-4/ 
-26 
48 
72 
0 
-20 
144 
-76 
-32 
-1/ 
-2 
-136 
172 
-82 
-36 
-62 
-48 
-32 
-14 
-260 
60 
-12 
-48 
192 
-132 
196 
-30 
-72 
984 
-288 
-356 
376 
-80 
-528 
-80 
128 
-68 
-312 
-428 
-114 
-242 
616 
1248 
-192 
-380 
3/ 
-3/ 
-7/ 
24/ 
-24/ 
1 
- 4 / 
24/ 
-35/ 
1 
4/ 
-25/ 
1 
- 4 / 
37/ 
-8/ 
81/ 
-72/ 
-24/ 
280/ 
536/ 
-64/ 
1 
- 1 / 
7/ 
525/ 
-419/ 
45/ 
152/ 
129/ 
-191/ 
-64/ 
735/ 
-1544/ 
-1576/ 
-371/ 
-1256/ 
-360/ 
280/ 
367/ 
25/ 
504/ 
-5679/ 
-648/ 
-945/ 
-888/ 
-925/ 
-4824/ 
-192/ 
185/ 
504/ 
2479/ 
2168/ 
1935/ 
-1777/ 
1960/ 
-8136/ 
1629/ 
-200/ 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
1 
-1 
-5 
-2 
0 
6 
2 
-1 
-8 
-11 
6 
15 
2 
-13 
-4 
18 
4 
-16 
12 
-1/1 
-27 
3 
19 
-1 
-22 
-9 
7 
-28 
1 
8 
-10 
-9 
-8 
-8 
4 
-47 
23 
42 
-9 
22 
1 
6 
-15 
-12 
20 
-37 
38 
5 
0 
-11 
-7 
-4 
-36 
-37 
38 
-4 
-4 
-2 
-16 
-20 
-8 
-32 
-20 
-12 
14 
-8 
70 
-68 
48 
-28 
28 
-36 
16 
28 
-1/1 
202 
-44 
96 
-22 
144 
22 
-152 
192 
-26 
-12 
-64 
-236 
-112 
-68 
-84 
732 
-14 
508 
-20 
92 
-124 
-200 
-260 
-132 
92 
436 
296 
-740 
-596 
-518 
-346 
-348 
276 
324 
348 
-3 
3 
25 
24 
24 
-56 
-24 
-25 
72 
71 
-56 
97 
56 
-45 
40 
-456 
-152 
320 
-40 
-1 
-461 
15 
63 
-27 
-280 
-15 
-53 
-64 
15 
-72 
-8 
2287 
320 
-56 
-392 
-3779 
-691 
1816 
175 
-216 
477 
-1176 
-743 
1304 
120 
-1657 
648 
-8911 
-3896 
-821 
-1061 
200 
-200 
315 
360 

312 
Numerical Tables 
Table C 
This table gives the Fourier coefficients Qp (2 ^ p ^ 761: prime numbers) of a 
primitive form in .5^2 ( ^A — 1 I for iV = 29 and 37. Since the dimension of each 
space is 2, 
I 
f i = l 
n = l 
J 
is a basis of ^2 ( ^» I T7 I )• 
p 
2 
7 
17 
29 
41 
53 
67 
79 
97 
107 
127 
139 
157 
173 
(s) 
— 
+ 
— 
-
+ 
+ 
-
-
+ 
-
+ 
-
+ 
«P 
y^ 
2 
-27"^ 
-3 + 2^"^ 
-2V^ 
-9 
8 
-3V^ 
6^-5 
18 
0 
-10 
-67"^ 
-6 
P 
3 
11 
19 
31 
43 
59 
71 
83 
101 
109 
131 
149 
163 
179 
© 
— 
-
-
— 
-
+ 
+ 
+ 
-
+ 
-
+ 
-
+ 
«P 
-V^ 
y-5 
0 
3^"^ 
- 3 ^ ^ 
6 
0 
-6 
-sy^ 
5 
V^ 
15 
-V^ 
0 
P 
5 
13 
23 
37 
47 
61 
73 
89 
103 
113 
137 
151 
167 
181 
[Q 
+ 
+ 
+ 
— 
-
-
-
-
+ 
-
-
+ 
+ 
+ 
«P 
-3 
-1 
6 
0 
v ^ 
6V-5 
0 
- 2 ^ ^ 
-4 
V^ 
V-5 
-10 
-12 
5 

Table C 
313 
Sf; ( « ( . ) ) 
V 
191 
199 
227 
239 
257 
271 
283 
311 
331 
349 
367 
383 
401 
421 
439 
457 
467 
491 
509 
541 
563 
577 
599 
613 
631 
647 
661 
683 
709 
733 
751 
ii 
— 
+ 
+ 
+ 
+ 
-
+ 
-
-
+ 
-
+ 
+ 
-
+ 
+ 
-
-
+ 
-
-
-
-
+ 
+ 
+ 
+ 
+ 
+ 
-
— 
flp 
V^ 
14 
12 
6 
-3 
-V^ 
14 
V ^ 
15V-5 
-1 
- 1 2 ^ ^ 
6 
15 
6 ^ ^ 
-34 
2 
y ^ 
-llV-5 
15 
0 
- 5 ^ " ^ 
-isy"^ 
137"^ 
-31 
32 
-18 
-10 
-36 
35 
1 2 ^ ^ 
iV"^ 1 
p 
193 
211 
229 
241 
263 
277 
293 
313 
337 
353 
373 
389 
409 
431 
443 
461 
479 
499 
521 
547 
569 
587 
601 
617 
641 
653 
673 
691 
719 
739 
757 
ii 
— 
-
-
+ 
-
+ 
-
+ 
-
+ 
+ 
-
-
+ 
-
-
-
+ 
+ 
+ 
-
+ 
-
-
-
-
+ 
+ 
+ 
-
-
«p 
- 6 ^ " ^ 
3 V ^ 
-6^-5 
-25 
-57"^ 
2 
V"^ 
29 
-67"^ 
-6 
-31 
- 8 ^ ^ 
1 2 ^ ^ 
18 
-sy^ 
V^ 
- 5 ^ ^ 
-10 
-27 
38 
- 8 ^ " ^ 
-42 
6V^ 
-20V^ 
loy^ 
2 2 ^ ^ 
11 
20 
36 
-9Vr^ 
-18^-5 
P 
197 
223 
233 
251 
269 
281 
307 
317 
347 
359 
379 
397 
419 
433 
449 
463 
487 
503 
523 
557 
571 
593 
607 
619 
643 
659 
677 
701 
727 
743 
761 
(il 
+ 
+ 
+ 
-
-
+ 
-
-
+ 
-
-
+ 
+ 
-
-
+ 
+ 
-
+ 
+ 
+ 
+ 
-
-
+ 
-
-
+ 
-
-
+ 
«p 
-18 
-16 
-9 
V^ 
-27"^ 
3 
V^ 
loV-5 
-12 
s / ^ 
0 
-7 
24 
0 
167^ 
26 
2 
V^ 
-4 
18 
32 
9 
3v/"^ 
15>/-5 
26 
-nV"^ 
-8V^ 
-45 
-\1sh'^ 
v^ 
-30 

314 
Numerical Tables 
^
•
. (-4)) 
V 
2 
7 
17 
29 
41 
53 
67 
79 
97 
107 
127 
139 
157 
173 
191 
199 
227 
239 
257 
271 
283 
311 
331 
349 
367 
383 
401 
421 
439 
457 
467 
491 
509 
541 
563 
577 
599 
613 
631 
647 
661 
683 
709 
733 
751 
( ^ ) 
— 
+ 
-
-
+ 
+ 
+ 
-
-
+ 
+ 
+ 
+ 
+ 
-
-
-
-
-
+ 
-
-
-
+ 
+ 
-
-
-
-
-
-
+ 
+ 
-
-
-
+ 
+ 
-
-
-
-
-
+ 
+ 
«P 
2i 
3 
2i 
-4i 
-3 
9 
-12 
6i 
12i 
-12 
-7 
0 
3 
-21 
20i 
-24i 
-Si 
16i 
-8i 
-3 
24i 
lOi 
0 
30 
8 
-16i 
-lOi 
30i 
-24i 
-18i 
-28i 
12 
15 
0 
-26i 
42i 
45 
29 
-30i 
2i 
30i 
-46i 
6i 
-31 
27 
P 
3 
11 
19 
31 
43 
59 
71 
83 
101 
109 
131 
149 
163 
179 
193 
211 
229 
241 
263 
277 
293 
313 
337 
353 
373 
389 
409 
431 
443 
461 
479 
499 
521 
547 
569 
587 
601 
617 
641 
653 
673 
691 
719 
739 
757 
( ^ 
+ 
+ 
-
-
-
-
+ 
+ 
+ 
-
-
+ 
-
-
-
+ 
+ 
-
+ 
-
+ 
-
+ 
-
+ 
-
-
-
+ 
-
-
-
+ 
-
-
-
+ 
+ 
+ 
-
+ 
+ 
+ 
+ 
— 
«P 
~\ 
-3 
6i 
0 
-6i 
-4i 
-3 
9 
-3 
6i 
-lOi 
15 
-6i 
16i 
-6i 
-13 
-5 
0 
9 
12i 
-6 
-6i 
13 
14i 
-21 
16i 
-24i 
lOi 
-21 
lOi 
-4i 
36i 
-3 
12i 
-44i 
22i 
-18 
3 
-33 
44i 
-21 
12 
15 
25 
12i 
P 
5 
13 
23 
37 
47 
61 
73 
89 
103 
113 
137 
151 
167 
181 
197 
223 
233 
251 
269 
281 
307 
317 
347 
359 
379 
397 
419 
433 
449 
463 
487 
503 
523 
557 
571 
593 
607 
619 
643 
659 
677 
701 
727 
743 
761 
(S[ 
— 
-
-
+ 
-
+ 
-
-
-
+ 
+ 
-
+ 
+ 
+ 
+ 
-
+ 
-
+ 
+ 
-
+ 
+ 
+ 
+ 
+ 
-
-
-
-
-
-
+ 
+ 
-
+ 
-
+ 
+ 
-
-
+ 
+ 
flp 
-2i 
-6i 
4i 
- l + 6 i 
3 
0 
9 
-14i 
-6i 
4i 
18 
-8 
2i 
-3 
3 
19 
-6 
lOi 
-30 
-20i 
-7 
18 
32i 
-15 
15 
33 
15 
9 
26i 
-36i 
-18i 
14i 
-6i 
-28i 
-33 
-21 
-18i 
-35 
24i 
-45 
3 
20i 
-18i 
39 
-33 

References 
Ahlfors, L. (1966) Complex analysis, 2nd edition, McGraw-Hill. 
Artin, E. (1923) Uber eine neue Art von L-Reihen, Abh. Math. Sem. Univ. Hamburg 3, 89-108. 
Asai, T. (1976) On the Fourier coefficients of automorphic forms at various cusps and some applications 
to Rankin's convolution, J. Math. Soc. Japan 28, 48-61. 
Atkin, A. O. L., Lehner, J. (1970) Hecke operators on ro(m). Math. Ann. 185, 134-160. 
Borevich, Z. I., Shafarevich, I. R. (1966) Number Theory, Academic Press. 
Dehgne, P. (1968/69) Formes modulaires et representations /-adiques, Seminaire Bourbaki n° 355. 
Dehgne 2, (1974) La conjecture de Weil I, Publ. Math. I.H.E.S. 43, 273-307. 
Deligne, P., Serre, J.-P. (1974) Formes modulaires de poids 1, Ann. Sc. de V Ec. Norm. Sup. 7, 507-530. 
Doi, K., Naganuma, H. (1969) On the functional equation of certain Dirichlet series. Invent. Math. 9, 
1-14. 
Eichler, M. (1938) Allgemeine Kongruenzklasseneinteilungen der Ideale einfacher Algebren iiber 
algebraischen Zahlkorpern und ihre L-Reihen, J. Reine Angew. Math. 179, 227-251. 
Eichler 2, (1954) Quaternare quadratische Formen und die Riemannsche Vermutung fur die 
Kongruenzzetafunktion, Arch. Math. 5, 355-366. 
Eichler 3, (1956) Uber die Darstellbarkeit von Modulformen durch Thetareihen, J. Reine Angew. Math. 
195, 156-171. 
Eichler 4, (1957) Eine Verallgemeinerung der Abelschen Integrate, Math. Z. 67, 267-298. 
Fricke-F., Klein, R. (1897, 1912) Vorlesungen iiber die Theorie der automorphen Funktionen I, II, 
Teubner. 
GelTand, I. M., Graev, M. I., Pyatetskii-Shapiro, 1.1. (1969) Representation Theory and Automorphic 
Functions, Saunders. 
Godement, R. (1957/1958) Ou V on generalise une integrate etudiee par Siegel at generalisant la fonction 
r, Fonctions holomorphes de carre sommable dans le demi-plan de Siegel, Generalites sur les formes 
modulaires I, II, Seminaire Henri Cartan lOe anee. 
Godement 2, (1970) Notes on Jacquet-Langlands' theory, Inst, for Advanced Study. 
Hasse, H. (1952) Uber die Klassenzahl abelscher Zahlkorper, Akademie-Verlag. 
Hecke, E. (1918, 1920) Eine neue Art von Zetafunktionen und ihre Beziehungen zur Verteilung der 
Primzahlen I, II, Math. Z. 1, 357-376; 6, 11-51 (Werke 12,14). 
Hecke 2, (1936) Uber die Bestimmung Dirichletscher Reichen durch ihre Funktionalgleichung, Math. 
Ann. 112, 664-699 (Werke 33). 
Hecke 3, (1937) Uber Modulfunktionen und die Dirichletscher Reihen mit Eulerscher Produktentwick-
lung I, II, Math. Ann. 114, 1-28; 316-351 (Werke 35, 36). 
Hijikata, H. (1974) Explicit formula of the traces of Hecke operators for ro(iV), J. Math. Soc. Japan 26, 
56-82. 
Igusa, J. (1959) Kroneckerian model of fields of elliptic modular functions, Amer. J. Math. 81, 561-577. 
Igusa 2, (1972) Theta Functions. Springer, Berlin Heidelberg New York. 
Ihara, Y. (1967) Hecke polynomials as congruence C functions in elliptic modular case, Ann. Math. 85, 
267-295. 
Ishikawa, H. (1973) On the trace formula for Hecke operators, J. Fac. Sci. Univ. Tokyo 20, 217-238. 
Iwasawa, K. (1972) Lectures on p-adic L-function, Ann. Math. Studies 74. 
Jacquet, H., Langlands, R. P. (1970) Automorphic Forms on GL (2), Lecture Notes in Mathematics 114, 
Springer, Berlin Heidelberg New York. 

316 
References 
Kuga, M., Shimura, G. (1965) On the zeta-function of a fibre variety whose fibres are abelian varieties, 
Ann. Math. 82, 478-539. 
Lang, S. (1982) Introduction to algebraic and abeUan functions, 2nd edition, Springer, Berlin 
Heidelberg New York. 
Langlands, R. P. (1970) Problems in the Theory of Automorphic Forms, Lectures in modern analysis 
and applications III, Lecture Notes in Mathematics 170, Springer, Berlin Heidelberg New York. 
Miyake, T. (1971) On automorphic forms on GLj and Hecke operators, Ann. Math. 94, 174-189. 
Naganuma, H. (1973) On the coincidence of two Dirichlet series associated with cusp forms of Hecke's 
"Neben"-type and Hilbert modular forms over a real quadratic field, J. Math. Soc. Japan 25, 547-555. 
Saito, H. (1972) On Eichler's trace formula, J. Math. Soc. Japan 24, 333-340. 
Selberg, A. (1956) Harmonic analysis and discontinuous groups in weakly symmetric Riemannian 
spaces with applications to Dirichlet series, J. Indian Math. Soc. 20, 47-87. 
Shimizu, H. (1963) On discontinuous groups operating on the product of the upper half planes, Ann. 
Math. 77, 33-71. 
Shimizu 2, (1963) On traces of Hecke operators, J. Fac. Sci. Univ. Tokyo 10, 1-19. 
Shimizu 3, (1965) On Zeta Functions of Quaternion Algebras, Ann. Math. 81, 166-193. 
Shimizu 4, (1968) Approximation theorem, Hecke algebras and zeta-functions, Seminary Notes, Univ. of 
Tokyo (in Japanese). 
Shimura, G. (1971) Introduction to the arithmetic theory of automorphic functions, Iwanami Shoten 
and Princeton Univ. Press. 
Shimura 2, (1958) Correspondances modulaires et les fonctions C de courbes algebriques, J. Math. Soc. 
Japan 10, 1-28. 
Shimura 3, (1961) On the zeta-functions of the algebraic curves uniformized by certain automorphic 
functions, J. Math. Soc. Japan 13, 275-331. 
Shimura 4, (1966) A reciprocity law in non-solvable extensions, J. Reine Angew. Math. 221, 209-220. 
Shimura 5, (1971) On elliptic curves with complex multiplication as factors of the jacobians of modular 
function fields, Nagoya Math. J. 43, 199-208. 
Shimura 6, (1972) Class'fields over real quadratic fields and Hecke operators, Ann. Math. 95, 130-190. 
Shimura 7, (1973) On modular forms of half integral weight, Ann. Math. 97, 440-481. 
Shimura 8, (1975) On some arithmetic properties of modular forms of one and several variables, Ann. 
Math. 102,491-515. 
Shimura 9, (1982) Confluent hypergeometric functions on tube domains. Math. Ann. 260, 260-302. 
Shimura 10, (1983) On Eisenstein series, Duke Math, J. 50, 417^76. 
Shimura 11, (1985) On Eisenstein series of half-integral weight, Duke Math. J. 52, 281-314. 
Shimura 12, (1985) On the Eisenstein series of Hilbert modular groups, Revista mathematica Ibero-
americana 1, 1^2. 
Shintani, T. (1975) On construction of holomorphic cusp forms of half integral weight, Nagoya Math. J. 
58, 83-126. 
Siegel, C. L. Gesammelte Abhandlungen, Springer, Berlin Heidelberg New York. 
Siegel 2, (1961) On Advanced Analytic Number Theory, Tata Institute. 
Stein, E. M., Weiss, G. (1971) Introduction to Fourier analysis on Euclidean spaces, Princeton Univ. 
Press. 
Vigneras, M.-F. (1980) Arithmetique des Algebres de Quaternions, Lecture Notes in Mathematics 
800, Springer, Berlin Heidelberg New York. 
Waldspurger, J.-L. (1982) Sur les coefficients de Fourier des formes modulaires de poids demi-entier, J. 
Math, pures et appl, 60, 375^84. 
Washington, L. C. (1982) Introduction to cyclotomic fields, Springer, Berlin Heidelberg New York, 
Weil, A. (1967) Basic Number Theory, Springer, Berlin Heidelberg New York. 
Weil 2, (1971) Dirichlet series and automorphic forms. Lecture Notes in Mathematics 189, Springer, 
Berlin Heidelberg New York. 
Weil 3, (1967) Uber die Bestimmung Dirichletscher Reihen durch Funktionalgleichungen, Math. Ann. 
168, 149-156. 
Weil 4, (1968) Sur une formule classique, J. Math. Soc. Japan 20, 400-402. 
Weil 5, (1965) L'integration dans les groupes topologiques et ses applications, Hermann. 
Yoshida, K. (1971) Functional analysis. Springer, Berlin Heidelberg New York. 

List of Symbols 
§1.1 
p 
H 
K 
Aut(H) 
Aut(K) 
j{cc,z) 
the Riemann sphere (= IR u {oo}) 
the upper half plane (= {z e C 
| 
Im 
(z) > 0}) 
the unit disk (={z6C 
| |z| < 1}) 
the group of automorphisms of H 
the group of automorphisms of K 
{az + b)/{cz + d) 
[::]) 
CZ 
+ ' ("[::]) 
Page 
1 
2 
2 
2 
2 
1(1.1.1) 
1 (1.1.2) 
GL^ 
(IR) 
SO 2m 
5C/(1, 1) 
= {aGCL2(IR) 
1 det(a)>0} 
-{ 
={ 
cos 0 
sin 
0 ~| 
1 
1 
0^0 
<2n} 
_—sin0 
cosOj 
1 
J 
,.sz.,,c, 
v-Q _;].=[; 
0 
§1.2 
Gx 
G\X 
G/K 
the stabilizer of x {^ {geG 
\ gx = x}) 
= {gx 
I 
geG} 
the quotient space of A' by G 
the space of the right cosets of G by K 
§1.3 
Gmuyf 
sL^iuyf 
GL+([R),,,-
SL2([R),,,, 
Z(a) 
NiG) 
§1.4 
(/oa)(z) 
= {aeGL2 (!R)x 1 « is parabolic or scalar} 
= 
SL2{U)nGmU)i^^ 
= 
GLl{U)^nGmm.' 
= 
SL2{U)nGmU)^^^. 
the centralizer of a ( = {^6GL2(1R) 
| 
ocp = j9a}) 
the normalizer of G (= {a e GL2 (K) | 
aGa 
"' = G}) 
= /(az) 
7(1.3.1) 
7(1.3.1) 
7 (1.3.2) 
7 (1.3.2) 
9(1.3.3) 
9 (1.3.4) 
10 

318 
List of Symbols 
df 
dxJ 
\dyj 
dy 
df°a 
dz 
dz 
ds^iz) 
dsKiw) 
dv{z) 
dv^iw) 
da 
v{D) 
d{,) 
K 
ke 
= difoa) 
= dx + idy (z = X + iy) 
= dx — idy (z = X + iy) 
= {dx' + dy')/y' 
{z 
= 4{dx^ + dy^)/{l-\w\^)'' 
(w 
= dxdyly-^ 
(z 
= Adxdyl{\-\w\^Y 
(w 
Haar measure of SL2 (R) (= {In)' 
= Jt/y(z) 
(DczH) 
D 
the distance in H 
= y>'"'K ^J (Z-X + I>GH) 
r 
cos 9 sin 6 
L —sin0 
cos0_ 
{OGU) 
= X + t> e H) 
= x + iyeK) 
= x + iyeH) 
= x + i>eK) 
y'^dxdydO) 
10 
10 
10(1.4.1) 
10(1.4.1) 
11 (1.4.2) 
11 
11 (1.4.2) 
11 
16(1.4.13) 
13 
12 
15 (1.4.8) 
15 (1.4.9) 
§1.5 
z{r) 
r , 
= rn{±i} 
= rnSL2(IR), 
(zeHuRujoo}) 
= rnSL2(II^L,x' 
(X,X'GRU{OO}) 
the order of z( = | T, /Z(r)| 
(z e H), =00 (z: a cusp)) 
§1.6 
= {zeH I 
rf(z,Zo)^^(z,yzo)} 
= {ZGH I 
rf(z,zo)<i(z,yzo)} 
= {ZGH I rf(z,Zo) = d(z,yZo)} 
§1.7 
H*,H* 
r\H 
r\H* 
71, 7 1 ^ 
the set of cusps of T 
= H u P ^ 
the quotient space of H by T 
the quotient space of H* by T 
the natural mapping of H* onto r \ H * 
= {ZGH I Im(z)>/} 
= l/,u{oo} 
25 
25 (1.7.1) 
25 
25 
27 
25 (1.7.2) 
25 (1.7.2) 
§1.8 
{V^^ fa) 
9? 
a local chart 
a coordinate system of a Riemann surface 
a Riemann surface 

List of Symbols 
319 
Km) 
m\F) 
eb,F 
^yir 
V 
a 
^a 
Va(</') 
«o(0) 
nA4>) 
§1.9 
CAX) 
§2.1 
(/Ua)(z) 
ag) 
the function field of 9? 
a covering of a Riemann surface 
the ramification index of a covering F at b 
= r \ H * 
(as a Riemann surface) 
a neighborhood of aeTXH* 
the ramification index of a G ''Jip 
the order of </> at a 
= 
X 
^'a(^) 
(/C (9?) 3 </>: non-constant) 
Va(0)>O 
= 
Z 
l^'a (</>)! 
(K(9?) 3 0: non-constant) 
Va(</))<0 
the space of continuous functions on X with co 
= det(a)''/27(a,z)-7(az) 
the Petersson inner product 
r2,(r) 
.^jr) 
,r,(r) 
i2,(r,z) 
^.(Az) 
^^jr, I) 
Q{r) 
nn 
v{r\H)-' 
J 
f{z)g(z)lm{zfdviz) 
r\H 
= Ker(x) 
(x-a. character of F) 
the space of automorphic forms of weight k with respect to F 
^{feQi^if) 
I / : meromorphic} 
= {/G(2fc(r) 
I /: holomorphic} 
= {f€Q,{r) 
I /: cusp form} 
= {fe%ir) 
I (/,fif) = 0 
forany6fe^k(r)} 
= ifeQ,{r^) 
I /|,y = z(y)/ 
foranyyef} 
= Q,{r,x)n.^,{r^) 
= {fe%ir,x) 
I {f,g) = 0 (or any gG6^,{r,x)} 
•nr) 
/c= - X 
/c= - X 
= Z -ncr) 
Page 
30 
31 
31 
30 
28 
30(1.8.3) 
30(1.8.4) 
30(1.8.5) 
30(1.8.5) 
31 
37(2.1.5) 
44 (2.1.32) 
43 
38 
40 
40 
40 
44 
43 
43 
43 
43 
44 
38 
40 
40 
40 
§2.2 
d(f) 
a differential on a Riemann surface 
the differential of ( / ) G K ( ^ ) ( = {{d(j)/dt^, V^, t^)}) 

320 
List of Symbols 
VaM 
Z)'"(9?) 
Dm 
Div(9l) 
deg(a) 
cliv(</)) 
div(co) 
L(a) 
/(a) 
the space of differentials of degree m on 9? 
= {co 6 D'"m 
I CO = 0 or div(w) ^ 0} 
m = — 00 
= < Z ^a 3 
I Cg G Z, Cg = 0 for almost all a 
= {div(<^) I 0eK(9?)'^} 
(cDiv(9?)) 
= ZaCa (<i = SaCaaeDiv(9?)) 
= I 
V3(0)a 
(</>6X(9?)>^) 
ae« 
= X Va(«)a 
(^e/^'C^?)) 
aelR 
= {(/>GA:(9?) 
I </) = 0 or 
div((/)) + a^O} 
(aGDiv(9?)) 
= dimcL(a) 
(aGDiv(9?)) 
Page 
47 
45 
48 
46 
46 
47 
46 
47 (2.2.7) 
47 
47 
47 
§2.3 
^ ( r ) e v e „ 
Z 
^2m(^) 
50 
Div(9?)Q 
Va(/) 
Div(«R)®2Q 
re3-^ord,_,„(/) 
{fGs/,jn 
a = nizo)Emr) 
lva(/')/2 
( / e ^ 2 . + i(/^)) 
coj, a)(/) 
the differential of an automorphic form / 
div(/) 
= Z V3(/)a 
ifG,^jr)) 
ae«r 
div (Jz) 
- Z 0-^a-M< 
ae^Jtr 
52(2.3.16) 
§2.5 
[a] 
§2.6 
11/111; 
F^{z; 0, X, A 
(t>mizl (t>miz; 
gJTKz) 
,n 
X, a) 
= 5:3[c3]a 
{a = l.c 3aGDiv(9?r)Q) 
= 
{j^,\fiz)lm{zr'\''dvi^)y"' 
a Poincare series ( = 
= 7((T,z)"*e^"'""'^/'' 
= 
F,{z;e'^^'"''\x,r^, 
Z 
x(y)i<t>\,y)(z) 
yeA\r 
n 
57 
63 
64 (2.6.2) 
67 (2.6.9) 
67 

mx) 
0 
List of Symbols 
321 
Page 
§2.7 
69 
69 
70 
70 
70 
70 
73 
71 
71 
71 
§2.8 
f 
={geGmm I grg-'^r] 
74 
f\r,ocr, 
= dQt{oif"-'i:,xMf\,oi, 
(r.ar^ = JJv A^v) 
74 (2.8.2) 
Divo(9?) 
={aeDiv(9l) | deg(a) = 0} 
77 
Jr 
the jacobian variety of 9?^ ( = Divo(9?^)/Div,(9?y-)) 
77 
T{rar) 
the modular correspondence 
77 (2.8.3) 
§3.1 
Xo 
the principal character 
79 
X 
the complex conjugate of x (x(") = /(«)) 
79 (3.1.2) 
X° 
the primitive character associated with x 
80 
Xp 
the p-factor of x (z = YlpXp) 
80 
r^r' 
f 
^Ar,r' 
mr,T'; 
^Ar,A) 
M{r,A) 
deg(<^) 
M^ 
mirar' 
mK 
;^) 
^) 
[r:rnr'] < oo 
= {geG 1 gfrgr-
= ^z(r,r;d) 
= ^^(r,r;.j) 
= 
^z{r,A) 
= i,cjr\rar'| 
= {mGM 1 m^ = 
= 2:,.m"" ( F a r ' 
= E„c>|rar') 
and 
[ r ' : r n r ' ] < o o 
-'^n 
c^eK, c^ = 0 for almost all c 
{^ = i.,cja.r'Egi{r,r')) 
= m for all y e r } 
= U.^«.) 
(i^i.c.r^r-) 
the Gauss sum of ;f I = X x(«)e^"'''^'") 
80(3.1.5) 
\ fl 
= 0 
/ 
the Legendre symbol 
82 (3.1.7) 
the Kronecker symbol 
83 (3.1.9) 
§3.2 
(,{s) 
the Riemann zeta-function = y n - M 
84 
r(s) 
the gamma function i = ^ e 't^ ^ dt j 
86 
Z' 
=gS(log|z|+iarg(z)) 
(^^ 5 g Q) 
86(3.2.1) 
/l(s) 
=71-'"'ris/lKis) 
87 

322 
List of Symbols 
Page 
00 
e{z) 
= 
X 
^^'""'Mtheta function) 
89(3.2.16) 
B„ 
m-th Bernoulli number 
89 
§3.3 
r^ 
the ring of integers of F 
91 
/ 
the ideal group 
91 
P 
={{a)El 
I aeF''} 
91 
/(m) 
={a€l 
I (Q,m)=l} 
91 
P(m) 
={{a)eP 
\ a=\ 
mod'^m} 
91 
h{F) 
the class number of F (= \I/P\) 
91 
N{a), Np{a) 
the norm of a e / 
91 
^° 
the primitive Hecke character associated with ^ 
91 
if 
the complex conjugate of ^ (f(a) = ^(a)) 
92 
L{s, 0 
the Hecke L-function (= Z„(^(a)N(a)-^) 
91 (3.3.3) 
§4.1 
L{s,x) 
the Dirichlet L-function I = ^ Z(«)«"M 
93 (3.3.13) 
^N(S,X) 
= 
i 
Z(«)«"^ 
93 
( n , N ) = l 
Cpis) 
the Dedekind zeta-function of F (= i:„N(a)"^) 
92 (3.3.5) 
t) = D(F) 
the different of F 
92 
df, 
the discriminant of F 
92 
^oo(«) 
="ri'(«v/l«viri«vl''^^ 
(«eF'^) 
92(3.3.6) 
^^(a) 
=<^((fl))^,,(fl)-' 
(aGF^) 
92(3.3.7) 
W{^) 
the Gauss sum of ^ 
(-UihKicy' 
Z 
<^^(fl)^2'"'^"'/''M 
92(3.3.8) 
\ 
aec/mc 
/ 
F(<^) 
=2'''r''Jr(^)/N(m)i/2 
93 
'2'-'|J^.|N(m)V2„+r2 
/ n^i^s + iv,) + \uS 
Ais, ^) 
= \ ^
^
-
^ ] 
n 
r ( - 
^ - ^ } Lis, 0 
93 (3.3.12) 
the generalized Bernoulli number 
94 
0 
( z ( - l ) = l ) 
94(3.3.15) 
Ffc(z) 
= 
X; 
(mz + n)-* 
99(4.1.3) 
(m,'n) #(o!o) 

List of Symbols 
323 
G,iz) 
F,{z;l,Xo^SL2{I)^,SL,{Z)) 
Page 
99(4.1.4) 
.^2(2) 
g^iz) 
Aiz) 
J{z) 
§4.2 
roiN) 
r,(N) 
r{N) 
ro-m 
= \ 
X (^2 + ")"' 
m,neZ 
(w,«) = 1 
= 60£4(z) 
= 140£,(z) 
= 12-3(G4(2)^-G6(z)^) 
= {ln)-''-{g^{zf' 
-llg^{zf) 
= G4(z)V^(z) 
= 12^(271)-^2-^2(z)VA(2) 
= {[; ^].5L.(Z) 
^{[c !]^^^^^^^ 
c = 0 mod N 
c = 0,a = ds 
fr« ^1 
1 
= < 
G S L 2 ( Z ) 
/> = C = 0, 
fli 
= ro(iV)uro(N) 
- 1 
_ 0 :] 
r{i): 
1^^ JGSL^CZ) I nezj 
99(4.1.5) 
101 (4.1.16) 
101 (4.1.16) 
101 (4.1.14) 
101 (4.1.17) 
101 (4.1.15) 
101 (4.1.18) 
103 
103 
103 
109 
107 (4.2.4) 
r 
My) 
V2(r) 
V3(r) 
Vooin 
§4.3 
xiy) 
%iN,x) 
^,iN,x) 
•y^uiN, X) 
the image of F in Aut (H) 
= y mod N 
the number of inequivalent elHptic points of F of order 2 
the number of inequivalent elHptic points of F of order 3 
the number of inequivalent cusps of F 
Xid) (A: a 
efoiN) 
w^, ojiN) 
%iroiN),x) 
^,{ro{N), X) 
^.(ro(N), X) 
ro 
- n 
IN 
OJ 
106 
104 
107 
107 
107 
114(4.3.2) 
115 
115 
115 
115 

324 
L{s;f) 
L{s-f, iP) 
AAs;f, «A) 
§4.4 
riiz) 
§4.5 
MN) 
X(a) 
X*(a) 
f\ro{N)<xroiN) 
mm) 
T*{mJ) 
n=0 
\ 
n=0 
/ 
"=0 
\ 
„=o 
/ 
= Z ^nn-" 
(f(z)= Z ay^'A 
n=l 
\ 
fi = 0 
/ 
= Z <A(«)a„n- 
(/(z)= Z ««^'"'"^) 
=(27r/yiVr^r(5)L(5;/) 
= (27c/myN)-T(s)L(5;/, .A) 
the Dedekind //-function 
={[:;] 
4::].«. 
6M2(Z) 
c = OmodN, (a, N)=l, af/ 
c = OmodiV, (d,iV) = l, a(i -/>c>0> 
m 
mrdN), 
AoiN)) 
c=0, a = l mod N, ad — boO 
'^"^ 
("=C d]"''"*'") 
ist of Symbols 
Page 
115(4.3.3) 
123 (4.3.17) 
119(4.3.11) 
123 (4.3.18) 
119(4.3.12) 
123 (4.3.19) 
129 
132 (4.5.1) 
132 (4.5.2) 
151 
132 (4.5.4) 
132 (4.5.5) 
134 (4.5.8) 
.) 
^a = Lc 
A^'^^'V 
i 
detiar'-'Y^jMAoiy 
(/G ^,(N, X), UNWoiN) = U^roiN)a. e ^(N)) 
1 det(a)*/2-^ZvX*(^/l-^«v 
[ 
{fE%{N, X), ro(N)aro(iV) = L[,ro(N)a,E^*(N)) 
o(N) 
ro(N)G^(iV) 
LO mj 
[m 01 
o(N)[^ 
Jro(N)e^*(N) 
134(4.5.10) 
134 (4.5.9) 
134(4.5.11) 
135 (4.5.14) 
135 (4.5.15) 

List of Symbols 
325 
T{n) 
T*in) 
{/I TinMz) 
(/I T{1, l)){z) 
X 
ro(iV)aro{iV)G^{Ar) 
AoiN) 
(«) = " 
X 
ro(N)aro(N)e^*(N) 
ao*(iV) 
(«) = « 
n'-' Z Z ;f(«)^-y(—7-1 if^^dN, 
0<d\nb 
= 0 
\ 
a 
/ 
ad — n 
aeAo(N) 
det(a) = n 
aeA^iN) 
det(a) = « 
X)) 
Page 
135 (4.5.14) 
135 (4.5.15) 
142 (4.5.26) 
143 (4.5.27) 
^UN,X) 
y. 
^7,,C 
§4.7 
fkiz',XuX2) 
^k{N,x) 
•[::] 
:/*/2/(/z) 
:</(/2) I 
fG^^(M,x),lM\N,M¥'Ny 
•.{fe^,{N,x) 
I if,g) = OioT any 
ge^liN,x)} 
the p-component of iV (N = YIP^P) 
(y.GSL^iZ)) 
mod (N/N,)2 
modN3 
[::] 
mod(N/iV,)^ 
iy',€SL,{Z)) 
= ao + Z ( E 
Xiin/d)x2id)d'-')e'^^''' 
w = l \ 0 < d | n 
/ 
= <fkilr,XuX2) 
I 
lM,M2\N,xa2-X> 
153 (4.6.1) 
153 (4.6.2) 
162 
162 
166 
166 (4.6.19) 
167 (4.6.20) 
167 (4.6.21) 
167 (4.6.21) 
177 (4.7.6) 
179 (4.7.17) 
180 (4.7.19) 

326 
List of Symbols 
Page 
Za<^{a)Nfc(ar''^e^'''^^^"^' 
(K: imaginary) 
183 
Xa^(a)e^'""^*^"^' 
(K: real) 
184 
§4.8 
fir, ^) 
§4.9 
e(z) 
=^2"'"^ 
185 
A 
a positive symmetric matrix in M^(Z) 
186 
P 
a spherical function with respect to A 
186 
^A 
= t 
b,jd'/dx,dxj 
{A-' = lb,j^) 
186 
^[x] 
='xAx 
( X G C ) 
186 
a(n,A) 
=#{m€Z' 
| y4[m] = n} 
186 
a{n,h,A,N,P) 
= 
^ 
^('w) 
187 
Alm] = n 
m = h mod A/ 
0iz;KA,N,P) 
= 
X 
P{m)e( 
z 
186(4.9.3) 
e{z,x) 
= X ^1—-—z] 
lo 
187 (4.9.6) 
meZ' 
00 
0^(z) 
= 
I 
il/im)m''eimh) 
{v = S^) 
194 
fl 
(J=lmod4) 
e, 
= i 
190 
C i 
(otherwise) 
J{y,z) 
=(^^y;[Hcz + dy'' 
[y = ^^^ ^dy^'^V 
^^"^ 
§5.1 
ordp(a) 
=max{meZ 
\ aep^Zp} 
(aeQp) 
196 
|a|, 
=i;^ 
(aeQ,) 
196 
(a = 0) 
l«L 
l«L 
Z{B) 
Bp 
« P 
Q^ 
fi^ 
Q ; 
fi; 
= \a\ 
{aEQ^ = U) 
= X\Mv 
(a = (fl,)eQ;) 
the center of B( = {i?GB | ajS = j9a for any aeB}) 
= B ® Q Q P 
the closure of R in Bp 
the adele ring of Q 
the adelization ofB( = B®QQ^) 
the idele group of Q 
the adelization of B '^ 
196 
197 
195 
196 
196 
197 
197 (5.1.2) 
197 
198 (5.1.4) 

List of Symbols 
327 
§5.2 
trB 
§5.3 
the (reduced) norm of B 
the (reduced) trace of B 
the principal polynomial of jS 
= {i8eB; 
I \NBmA = l} 
the discriminant of B 
= 
Gmu)xY\R; 
{geR, I NM^O] 
ip^N) 
a 
bl 
aeZ^,ad-p'bc^O> 
{p\N) 
DR 
^R 
xig) 
Tin) 
= {GmU)xY\D^)nB:^ 
p 
= Rr\Dn 
= X r^ar«e^(r«,j«) 
A/B(a) = n 
a e J R 
r(n,n) 
r«nr«G^(r«,.j«) 
Page 
200 
200 
200 
201 
209(5.2.11) 
211 
212 (5.3.2) 
213 (5.3.4) 
212 (5.3.3) 
213 (5.3.5) 
214 (5.3.6) 
217 (5.3.12) 
217(5.3.13) 
ll/ll, 
HUH) 
(f,9)H 
/ 
(ji/(^)i mizf^lPdviz) 
ess.sup|/(z)Im(z)''/2| 
zeH 
= {/ I ll/llp<^} 
= {/eLnH) 
I /: holomorphic} 
= 
lHfiz)giz)lm{zfdv{z) 
the kernel function of //^ (H) 
the Fourier transform 
o{feHl{H) 
(l^p<oo) 
(p = co) 
219 
219 
220 
220(6.1.1) 
220 
222 
G,iu) 
"" 
0 
(M^O) 
223 

328 
Hi 
§6.2 
iKf){z) 
ll/llp 
(/, 9)K 
//J(K) 
§6.3 
WfWrp 
mr,x) 
mir,x) 
if,9)r 
f'iz) 
K/iz„z, 
= {<j) I (/)(u) = OonlR_, i \(i)iu)\^Gki4u)du<oo 
- 00 
= ] cpiu)^)G,{4u)du 
0 
00 
— 00 
the Fourier transform of ^^(zi, Zj) 
= J K^iz, w)fiw)lm{w)''dv{w) 
(< \f{w)(l-\wn''\''dv^{w) 
. . . p<oo) 
ess. sup |/(w)(l -1 w|2)''/2| 
(p= 00) 
weK 
j/(w)^(w)(l-|wp)''dt)K(w) 
K 
{/ 
I ll/llp<a)} 
:{/eLj?(K) 
I /: holomorphic) 
|/{z)Im(z)*/2|Prfy(2) 
( l ^ p < 0 0 ) 
ess. sup|/(z)Im(z)*/2| 
zeH 
(p=oo) 
= {/ 
I \\f\\rp< 
^Jy 
= Xiy)f (or any ye r} 
= {fEmr,x) 
I /holomorphic} 
= f /(z)^Im(z)''dt;(z) 
(/, g G L,2(r, ;c)) 
r\H 
=|Z(r)|-» X x(y)/(72)j(y,^)-' 
(/e^i(H)) 
=\zin\-' l,MK,{yz„zMy,zir' 
yer 
List of Symbols 
Page 
223 
223 
223 (6.1.12) 
225 
225 (6.2.1) 
225 
226 
226 
226 
228 
228 
228 
228 
229 (6.3.2) 
229 (6.3.3) 

List of Symbols 
§6.4 
Kiz; a.) 
Z{T) 
K(Z; a, s) 
=d^i{oLf-'x{y)K,{oiz, 
= U 
{T,-Z{T)) 
xePr 
= 1 
K{Z; a) 
K{z;a)lm{zy'\j{(7^ 
2)7(a, 
,z)P 
zynmizf 
329 
^i^gfj 
01 is conjugate to 02 by an element of H 
C„{g),C„,Gi9) 
={9'^G 
I g'sg} 
M//H 
the set of H-conjugacy classes of M 
r(a) 
r"' 
sgn(a) 
= { a e r 
= {aGr 
= { a e r 
= {aGr 
a is elliptic} 
a is hyperbolic and all fixed points of a are cusps} 
a is hyperbolic and no fixed points of a is a cusp} 
a is parabolic and the fixed point of a is a cusp} 
the eigen values of a 
= sgn(CJ 
m{oc. A) 
m(a) 
= m(a,r(a)) 
k-1 
y(r\H) 
= - ^ 7 ^ ; 7 ^ 
^ 
X(oc)sgn(a)Met(a)*/^-^ 
47t 
|Z(r)| „^2(^) 
1^(^)1 aerV/r 
1 
X 
z(a)sgn(a)* minjI^JJ^J}"-^ 
= lim 
/c(a) 
minjIf/JJCJ}"-^ 
X 
;c(a)sgn(a)Met(a)''^2 -1 (i/^(a))i +^ 
sgn(a)' 
IC.-^al 
sgn(a)*det(a)*/ 
(a e n , 
(aer*), 
(a e n 
Page 
231 (6.4.2) 
232 
235 
235 
235 
235 
235 
235 
235 
235 
240 
240 
240 
240 
240 
240 
241 
241 
241 
241 
241 
241 
243 

330 
/(a) 
\/2\r{a)\ 
iaeT"), 
l/|Z(r)| 
(aer"), 
l/(|Z(r)Mm(a)r+i) 
(aer") 
List of Symbols 
Page 
243 
§6.5 
TA 
n 
z. 
/?^ 
r^ 
1^+ 
h{x) 
= U^TU^ 
=R:TR: 
=^^U^p 
p 
= X®Z^A 
= {(a,)er; 
| det(a«)>0} 
= |/c;/(r;,K^)| 
/(r) 
l/2|r''| 
( a e n 
1/2 
(aer") 
l/2|m(a,r")r^ 
(aeT") 
243 
248 
246 
246 
246 
246 
246 
245 
C(a), Cg. 
CM CB 
C^(a), C, 
C(a,r) 
Cp(a,r) 
C.,(a,r) 
C^(a,r) 
§6.6 
(a) 
.(a) 
,.(a) 
= {(5a^-^ 
= {xax~^ 
={;ia/j-^ 
= {^a^-^ 
= {x<xx'^ 
= CM 
= 
{hoLh-' 
-I 
'a b~ 
_c d_ 
\ 
SeB^} 
1 
XGB:} 
1 ^efi^} 
1 ^eB^Q[a]n<5-^R^ = r} 
1 xGB;,Qp[a]nx-^RpX = r^ 
1 /i€B;,Q^[a]nr^/?^;j = r^ 
EMjiZp) 
1 c = 0 m o d p 4 
•iV(/?p) 
p 
Q{oi,x,) 
9^ 
the principal polynomial of a( = X^ — tX + n) 
the order of Qp[a] including Zp[a] 
= ord,([r,:Z,[a]]) 
= {<^GZ, I /,(<^) = 0modp^^^r = 2<^modp''} 
{(^eZp I /,(^)=0modp^ + 2''+^} (f^ = 4nmod/?2p+i) 
</) 
(otherwise) 
= fl(a, tp) mod p'^" 
= 0'(a, rp)modp'+^^* 
244 
248 
246 
245 
248 
248 
246 
249 (6.6.3) 
249 (6.6.4) 
250 
250 
250 
250 (6.6.5) 
254(6.6.12) 
254 
254 
250 (6.6.6) 

List of Symbols 
331 
§7.1 
ro(L,M) 
: ] | 
G5L2(Z) I ft = OmodL,c = OmodM} 
00 
Page 
269 (7.1.3) 
268 (7.1.1) 
271 (7.1.14) 
E^{z;n,v;N) 
= 
£ 
(mz + n) " 
Z 
X{d){cz + d)-'' (y = \ 
\] (x(-l) = (-l)*) 
/).\r„(N) 
V L^ dV 
272(7 
KN(ZIX) 
0 
.27) 
(otherwise) 
^i'\r{N)) 
^i'WN)) 
§7.2 
£fc(z, s; ;f, i/^) 
E^(z, s; n, v; N) 
£*/v(2,s;z) = ^ 
£*^(2,5) 
£*(2; X, «A) 
£2(^) 
£,(z; /., v; N) 
Elsi^;x) 
ElA^) 
ii'\r(N)) 
ii'\r{N)) 
4^>(r(N)) 
K'\r{N)) 
= (E,{z;n,v;N) 
| O^/i, v<iV> 
= ( £ . ( " . . ^ ) ) 
0 0 
m,n= 
— 00 
= 
Z' 
imz + n)~''\mz + n\~^' 
' " " ' ' m o d AT 
^ 
X(rf)(cz + J)-''|cz + ^|-2^ 
LJ"" 
y6ro(NL\ro(N) 
V Lc 
0 
= E^^f^{z, s; x) ix- the trivial character mod N) 
= E,{z,0;x,il^) 
= E2{z;xo,Xo) 
= 
E,(z,0;n,v;N) 
= E*^(z,0;x) 
= £.%(z,0) 
= <£fc(2,s;/i,v;N) 
| 
0^n,v<N} 
=(£.(;.„.,)) 
= (E^{z;n,v;N) 
| 0^/x,v<N> 
=("'(^^-^)) 
271 (7.1.20) 
271 (7.1.21) 
274(7.2.1) 
289 (7.2.52) 
(x(-i)=(-if) 
(otherwise) 290 (7.2.60) 
290 (7.2.61) 
287 (7.2.50) 
287 (7.2.51) 
289 (7.2.57) 
290 (7.2.63) 
290 (7.2.64) 
289 (7.2.53) 
289 (7.2.54) 
289 (7.2.58) 
289 (7.2.59) 

332 
5(z;a,i9) 
= X (z + n)-(z+ «)-'' 
</)(>;; a, P; x) 
={x + iy) '"{x- iy)' ^ 
00 
a{z\ <x, P) 
r\{y\ a, )S; x) 
co(z; a, i?) 
A{s) 
Bis) 
C{s) 
= ^ 
e-"'{u+\Y-'u^-'du 
0 
0 0 
= 
rm-'z^a{z;oLj) 
= 2'^ + U-''lV{il/''){n/My^T{s + k)-' 
= 2^ " T V ( - l)^^(«A°)(7r/M)^r(s)-' 
_ f 
0 
{x = Xo) 
~\2L^{2s + k,ilj) 
(x#Zo) 
.ist of Symbc 
Page 
275 (7.2.7) 
275 (7.2.9) 
275(7.2.11) 
276 (7.2.16) 
276 (7.2.17) 
279 (7.2.31) 
285 
285 
275 (7.2.6) 
D{s) 
a„(s) 
2i-'^n Y\(^-p~')ris)-'r{s + k)-'r 
p\M 
( ^ ) 
xr ir) 
Li^{2s + k-\,x) 
(lA: trivial) 
0 
(otherwise) 
0<c\n 
0<d\{l,c) 
284 
285 

Subject Index 
Action of 
a group 
4 
Far on . < (r, x) 74 
F a r ' on M^ 
71 
a e GLJ(R) on a function on H 
Adele ring of Q 
197 
Adelization of 
an algebra B over Q 
198 
B 
198 
Algebra over a field 195 
Approximation theorem 
207 
Artin L-function 
185 
Automorphic 
factor 
194 
form 
37 
form with character 
43 
function field 40 
Automorphy 
2 
Bernoulli number 
89 
37 
Central algebra 
195 
Centralizer 
9 
Character mod N 
79 
Class 
character 
91 
number (of an algebraic number field) 91 
number (of an order) 
246 
Commensurable 
69 
Complex conjugate of a Dirichlet character 
79 
Conductor 
of a Dirichlet character 
80 
of a Hecke character 
91 
of a primitive form 
164 
Confluent hypergeometric function 
276 
Conjugate 
elements of a group are 
235 
exponents are 
219 
Coordinate 
neighborhood 
28 
system 
28 
Covering of a Riemann surface 
31 
Cusp 
o f r 
18 
a point of r \ H * is 27 
form 
40 
Dedekind 
zeta-function 
92 
^/-function 
129 
Definite quaternion algebra 
201 
Degree 
of a covering 
31 
of a divisor 
46 
of an element of ^{F, A) 73 
Differential 
10 
of 9? of degree m 45 
Dirichlet 
L-function 
93 
character 
79 
series 
84 
series associated with a function on 
H 
119 
Discrete subgroup 
17 
Discriminant 
of a quaternion algebra 
211 
of an algebraic number field 92 
Distance of two points 
12 
Division 
algebra 
198 
quaternion algebra 
199 
Divisor 
class group 
47 
group of 9? 46 
of a differential 
47 
of a function 
47 
of 9? 46 
with rational coefficients 
51 
Eisenstein 
series 
67, 268 
series with parameter 
274 
Elliptic 
point 
18 
a point of r \ H * is 27 
matrix 
7 

334 
Subject Index 
Euler product 
85 
Exponent 
219 
Kernel function 
220 
Kronecker symbol 
83 
Fixed point 
5 
Formal 
Dirichlet series 
85 
Euler product 
86 
Fourier 
expansion of an automorphic form at a 
cusp 
40 
transform of an element of //^(H) 
223 
Fuchsian 
group 
18 
group of the first kind 
28 
Full modular group 
96 
Function field of a Riemann surface 
30 
Fundamental domain 
20 
Gamma function 
86 
Gauss sum 
of a Dirichlet character 
80 
of a Hecke character 
92 
Generalized Bernoulli number 
94 
Genus 
31 
Geodesic 
11 
Haar 
measure 
15 
measure of SL2{U) 
16 
Hecke 
algebra (over K) 
72 
character 
91 
operator 
75 
Holomorphic 
39 
at a cusp 
39 
a differential is 48 
a function on 9? is 30 
Homomorphism of algebras 
195 
Hurwitz formula 
31 
Hyperbolic 
matrix 
7 
point 
18 
Ideal 
associated with aeQ 
197 
class group 
91 
Indefinite quaternion algebra 
201 
Induced (Dirichlet character) 
79 
Inner automorphism of an algebra 
198 
Integral form 
40 
Interior angle 
23 
Irregular cusp 
19 
Jacobian variety 
77 
Legendre symbol 
82 
Legendre's relation 
87 
Level 
of a congruence modular group 
104 
of an order of Eichler type 
211 
Linear fractional transformation 
2 
Linked (sides are) 23 
Local 
chart 
28 
coordinate 
28 
expression of a differential 
45 
field 
196 
Maximal order of an algebra 
196 
Mellin transform 
88 
Meromorphic 
a function on 9? is 30 
at a cusp 
39 
automorphic form 
40 
Modular 
correspondence 
77 
form 
114 
function 
114 
group 
20, 96 
group of Hecke type 
104 
Modulus 
79 
Multiplication in a Hecke ring 
71 
Neighborhood of a cusp in H 
25 
Norm 
of a quaternion algebra 
200 
of an ideal 91 
Normalizer 
9 
Orbit (G-orbit) 5 
Order 
of a point 
19 
of a quaternion algebra 
211 
of an algebra 
196 
Ordinary (a point of r \ H * is) 27 
Parabolic 
matrix 
7 
point 
18 
Petersson inner product 
44 
Phragmen-Lindelof's Theorem 
118 
Poincare series 64 
Pole of a function on 9? 30 
Positive (a divisor is) 47 

Subject Index 
335 
Primitive 
Hecke character 91 
character 
80 
character associated with a Dirichlet 
character 
80 
form 
164 
Principal 
character 79 
congruence modular group 
103 
divisor group 47 
polynomial 
200 
Product 
of differentials 
46 
of double cosets 71 
Properly discontinuously 
17 
Quadratic residue symbol 
Quaternion algebra 
199 
Quotient space 5 
82 
Schwarz function 
88 
Side of a fundamental domain 
23 
Simple algebra 
198 
Space of primitive forms 
164 
Spherical function 
186 
Split (a quaternion algebra splits) 
199 
Splitting field of a quaternion algebra 
199 
Stabilizer 5 
Stirling's estimate 87 
Sum of differentials 
46 
Theta function 
89, 187 
Topological group 5 
Totally 
imaginary algebraic number field 91 
real algebraic number field 91 
Trace (of a quaternion algebra) 200 
Transitive (action is) 5 
Trivial character mod N 
79 
Ramanujan-Petersson conjecture 
150 
Ramification index 
of a covering 31 
of a point on r\H* 
30 
Ramify (a quaternion algebra is ramified) 
199 
Regular 
cusp 19 
element of a quaternion algebra 
203 
representation of an algebra 
195 
Riemann 
sphere 
1, 28 
surface 28 
zeta-function 
84 
Right half plane 276 
Unimodular 
15 
Unit 
disk 
2 
group of norm 1 of a quaternion 
algebra 209 
Upper half plane 2 
Vertex 23 
Weight of an automorphic form 37 
Zero 
of a function on 9? 30 
at a cusp 39 

