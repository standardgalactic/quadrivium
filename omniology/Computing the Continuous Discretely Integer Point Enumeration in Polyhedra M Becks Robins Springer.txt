Matthias Beck Sinai Robins
Computing the Continuous 
Discretely
Integer-Point Enumeration in Polyhedra

Matthias Beck
Mathematics Department
San Francisco State University
San Francisco, CA 94132
USA
beck@math.sfsu.edu
Sinai Robins
Department of Mathematics
Temple University
Philadelphia, PA 19122
USA
srobins@math.temple.edu
Editorial Board
S. Axler
Mathematics Department
San Francisco State University
San Francisco, CA 94132
USA
axler@sfsu.edu
K.A. Ribet
Department of Mathematics
University of California, Berkeley
Berkeley, CA 94720-3840
USA
ribet@math.berkeley.edu
ISBN-13: 978-0-387-29139-0  
eISBN-13: 978-0-387-46112-0
Library of Congress Control Number: 2006931787
Mathematics Subject Classiï¬ cations (2000): 05Axx 11Dxx 11Pxx 11Hxx 52Bxx 52Cxx 68Rxx
Â© 2007 Springer Science+Business Media, LLC
All rights reserved. This work may not be translated or copied in whole or in part without the written 
permission of the publisher (Springer Science+Business Media, LLC, 233 Spring Street, New York, 
NY 10013, USA), except for brief excerpts in connection with reviews or scholarly analysis. Use 
in connection with any form of information storage and retrieval, electronic adaptation, computer 
 software, or by similar or dissimilar methodology now known or hereafter developed is forbidden.
The use in this publication of trade names, trademarks, service marks, and similar terms, even if they 
are not identiï¬ ed as such, is not to be taken as an expression of opinion as to whether or not they are 
subject to proprietary rights.
Printed on acid-free paper.
9 8 7 6 5 4 3 2
springer.com

To Tendai
To my mom, Michal Robins
with all our love.

Preface
The world is continuous, but the mind is discrete.
David Mumford
We seek to bridge some critical gaps between various ï¬elds of mathematics by
studying the interplay between the continuous volume and the discrete vol-
ume of polytopes. Examples of polytopes in three dimensions include crystals,
boxes, tetrahedra, and any convex object whose faces are all ï¬‚at. It is amusing
to see how many problems in combinatorics, number theory, and many other
mathematical areas can be recast in the language of polytopes that exist in
some Euclidean space. Conversely, the versatile structure of polytopes gives
us number-theoretic and combinatorial information that ï¬‚ows naturally from
their geometry.
Fig. 0.1. Continuous and discrete volume.
The discrete volume of a body P can be described intuitively as the number
of grid points that lie inside P, given a ï¬xed grid in Euclidean space. The
continuous volume of P has the usual intuitive meaning of volume that we
attach to everyday objects we see in the real world.

VIII
Preface
Indeed, the diï¬€erence between the two realizations of volume can be
thought of in physical terms as follows. On the one hand, the quantum-
level grid imposed by the molecular structure of reality gives us a discrete
notion of space and hence discrete volume. On the other hand, the New-
tonian notion of continuous space gives us the continuous volume. We see
things continuously at the Newtonian level, but in practice we often compute
things discretely at the quantum level. Mathematically, the grid we impose
in spaceâ€”corresponding to the grid formed by the atoms that make up an
objectâ€”helps us compute the usual continuous volume in very surprising and
charming ways, as we shall discover.
In order to see the continuous/discrete interplay come to life among the
three ï¬elds of combinatorics, number theory, and geometry, we begin our fo-
cus with the simple-to-state coin-exchange problem of Frobenius. The beauty
of this concrete problem is that it is easy to grasp, it provides a useful com-
putational tool, and yet it has most of the ingredients of the deeper theories
that are developed here.
In the ï¬rst chapter, we give detailed formulas that arise naturally from
the Frobenius coin-exchange problem in order to demonstrate the intercon-
nections between the three ï¬elds mentioned above. The coin-exchange problem
provides a scaï¬€old for identifying the connections between these ï¬elds. In the
ensuing chapters we shed this scaï¬€olding and focus on the interconnections
themselves:
(1) Enumeration of integer points in polyhedraâ€”combinatorics,
(2) Dedekind sums and ï¬nite Fourier seriesâ€”number theory,
(3) Polygons and polytopesâ€”geometry.
We place a strong emphasis on computational techniques, and on com-
puting volumes by counting integer points using various old and new ideas.
Thus, the formulas we get should not only be pretty (which they are!) but
should also allow us to eï¬ƒciently compute volumes by using some nice func-
tions. In the very rare instances of mathematical exposition when we have a
formulation that is both â€œeasy to writeâ€ and â€œquickly computable,â€ we have
found a mathematical nugget. We have endeavored to ï¬ll this book with such
mathematical nuggets.
Much of the material in this book is developed by the reader in the more
than 200 exercises. Most chapters contain warm-up exercises that do not de-
pend on the material in the chapter and can be assigned before the chapter
is read. Some exercises are central, in the sense that current or later material
depends on them. Those exercises are marked with â™£, and we give detailed
hints for them at the end of the book. Most chapters also contain lists of open
research problems.
It turns out that even a ï¬fth grader can write an interesting paper on
integer-point enumeration [145], while the subject lends itself to deep inves-
tigations that attract the current eï¬€orts of leading researchers. Thus, it is an
area of mathematics that attracts our innocent childhood questions as well

Preface
IX
as our reï¬ned insight and deeper curiosity. The level of study is highly ap-
propriate for a junior/senior undergraduate course in mathematics. In fact,
this book is ideally suited to be used for a capstone course. Because the three
topics outlined above lend themselves to more sophisticated exploration, our
book has also been used eï¬€ectively for an introductory graduate course.
To help the reader fully appreciate the scope of the connections between
the continuous volume and the discrete volume, we begin the discourse in two
dimensions, where we can easily draw pictures and quickly experiment. We
gently introduce the functions we need in higher dimensions (Dedekind sums)
by looking at the coin-exchange problem geometrically as the discrete volume
of a generalized triangle, called a simplex.
The initial techniques are quite simple, essentially nothing more than ex-
panding rational functions into partial fractions. Thus, the book is easily ac-
cessible to a student who has completed a standard college calculus and linear
algebra curriculum. It would be useful to have a basic understanding of par-
tial fraction expansions, inï¬nite series, open and closed sets in Rd, complex
numbers (in particular, roots of unity), and modular arithmetic.
An important computational tool that is harnessed throughout the text is
the generating function f(x) = Pâˆ
m=0 a(m) xm, where the a(m)â€™s form any
sequence of numbers that we are interested in analyzing. When the inï¬nite
sequence of numbers a(m), m = 0, 1, 2, . . . , is embedded into a single generat-
ing function f(x), it is often true that for hitherto unforeseen reasons, we can
rewrite the whole sum f(x) in a surprisingly compact form. It is the rewriting
of these generating functions that allows us to understand the combinatorics
of the relevant sequence a(m). For us, the sequence of numbers might be the
number of ways to partition an integer into given coin denominations, or the
number of points in an increasingly large body, and so on. Here we ï¬nd yet
another example of the interplay between the discrete and the continuous: we
are given a discrete set of numbers a(m), and we then carry out analysis on
the generating function f(x) in the continuous variable x.
What Is the Discrete Volume?
The physically intuitive description of the discrete volume given above rests
on a sound mathematical footing as soon as we introduce the notion of a
lattice. The grid is captured mathematically as the collection of all integer
points in Euclidean space, namely Zd = {(x1, . . . , xd) : all xk âˆˆZ}. This
discrete collection of equally spaced points is called a lattice. If we are given
a geometric body P, its discrete volume is simply deï¬ned as the number of
lattice points inside P, that is, the number of elements in the set Zd âˆ©P.
Intuitively, if we shrink the lattice by a factor k and count the number
of newly shrunken lattice points inside P, we obtain a better approximation
for the volume of P, relative to the volume of a single cell of the shrunken
lattice. It turns out that after the lattice is shrunk by an integer factor k, the
number #
 P âˆ©1
kZd
of shrunken lattice points inside an integral polytope P

X
Preface
is magically a polynomial in k. This counting function #
 P âˆ©1
kZd
is known
as the Ehrhart polynomial of P. If we kept shrinking the lattice by taking a
limit, we would of course end up with the continuous volume that is given by
the usual Riemannian integral deï¬nition of calculus:
vol P = lim
kâ†’âˆ#

P âˆ©1
k Zd
 1
kd .
However, pausing at ï¬xed dilations of the lattice gives surprising ï¬‚exibility
for the computation of the volume of P and for the number of lattice points
that are contained in P.
Thus, when the body P is an integral polytope, the error terms that mea-
sure the discrepancy between the discrete volume and the usual continuous
volume are quite nice; they are given by Ehrhart polynomials, and these enu-
meration polynomials are the content of Chapter 3.
The Fourierâ€“Dedekind Sums Are the Building Blocks: Number
Theory
Every polytope has a discrete volume that is expressible in terms of certain
ï¬nite sums that are known as Dedekind sums. Before giving their deï¬nition, we
ï¬rst motivate these sums with some examples that illustrate their building-
block behavior for lattice-point enumeration. To be concrete, consider for
example a 1-dimensional polytope given by an interval P = [0, a], where a is
any positive real number. It is clear that we need the greatest integer function
âŒŠxâŒ‹to help us enumerate the lattice points in P, and indeed the answer is
âŒŠaâŒ‹+ 1.
Next, consider a 1-dimensional line segment that is sitting in the 2-
dimensional plane. Letâ€™s pick our segment P so that it begins at the origin
and ends at the lattice point (c, d). As becomes apparent after a momentâ€™s
thought, the number of lattice points on this ï¬nite line segment involves an
old friend, namely the greatest common divisor of c and d. The exact number
of lattice points on the line segment is gcd(c, d) + 1.
To unify both of these examples, consider a triangle P in the plane whose
vertices have rational coordinates. It turns out that a certain ï¬nite sum is
completely natural because it simultaneously extends both the greatest integer
function and the greatest common divisor, although the latter is less obvious.
An example of a Dedekind sum in two dimensions that arises naturally in the
formula for the discrete volume of the rational triangle P is the following:
s(a, b) =
bâˆ’1
X
m=1
m
b âˆ’1
2
 ma
b
âˆ’
jma
b
k
âˆ’1
2

.
The deï¬nition makes use of the greatest integer function. Why do these sums
also resemble the greatest common divisor? Luckily, the Dedekind sums sat-
isfy a remarkable reciprocity law, quite similar to the Euclidean algorithm

Preface
XI
that computes the gcd. This reciprocity law allows the Dedekind sums to be
computed in roughly log(b) steps rather than the b steps that are implied by
the deï¬nition above. The reciprocity law for s(a, b) lies at the heart of some
amazing number theory that we treat in an elementary fashion, but that also
comes from the deeper subject of modular forms and other modern tools.
We ï¬nd ourselves in the fortunate position of viewing an important tip of
an enormous mountain of ideas, submerged by the waters of geometry. As we
delve more deeply into these waters, more and more hidden beauty unfolds
for us, and the Dedekind sums are an indispensable tool that allow us to see
further as the waters get deeper.
The Relevant Solids Are Polytopes: Geometry
The examples we have used, namely line segments and polygons in the plane,
are special cases of polytopes in all dimensions. One way to deï¬ne a polytope
is to consider the convex hull of a ï¬nite collection of points in Euclidean
space Rd. That is, suppose someone gives us a set of points v1, . . . , vn in
Rd. The polytope determined by the given points vj is deï¬ned by all linear
combinations c1v1+c2v2+Â· Â· Â·+cnvn, where the coeï¬ƒcients cj are nonnegative
real numbers that satisfy the relation c1 +c2 +Â· Â· Â·+cn = 1. This construction
is called the vertex description of the polytope.
There is another equivalent deï¬nition, called the hyperplane description
of the polytope. Namely, if someone hands us the linear inequalities that
deï¬ne a ï¬nite collection of half-spaces in Rd, we can deï¬ne the associated
polytope as the simultaneous intersection of the half-spaces deï¬ned by the
given inequalities.
There are some â€œobviousâ€ facts about polytopes that are intuitively clear
to most students but are, in fact, subtle and often nontrivial to prove from ï¬rst
principles. Two of these facts, namely that every polytope has both a vertex
and a hyperplane description, and that every polytope can be triangulated,
form a crucial basis to the material we will develop in this book. We carefully
prove both facts in the appendices. The two main statements in the appen-
dices are intuitively clear, so that novices can skip over their proofs without
any detriment to their ability to compute continuous and discrete volumes of
polytopes. All theorems in the text (including those in the appendices) are
proved from ï¬rst principles, with the exception of the last chapter, where we
assume basic notions from complex analysis.
The text naturally ï¬‚ows into two parts, which we now explicate.
Part I
We have taken great care in making the content of the chapters ï¬‚ow seamlessly
from one to the next, over the span of the ï¬rst six chapters.
â€¢
Chapters 1 and 2 introduce some basic notions of generating functions, in
the visually compelling context of discrete geometry, with an abundance
of detailed motivating examples.

XII
Preface
Chapter 1
The Coin-Exchange
Problem of Frobenius
@@
R
?
Chapter 2
A Gallery of Discrete Volumes
  	
Chapter 3
Counting Lattice Points in
Polytopes: The Ehrhart Theory
?
Chapter 7
Finite Fourier Analysis


Chapter 4
Reciprocity
?





9
XXXX
z
Chapter 8
Dedekind Sums
Chapter 6
Magic Squares
Chapter 5
Face Numbers and the
Dehnâ€“Sommerville Relations
CCW
Chapter 12
A Discrete Version of
Greenâ€™s Theorem
Chapter 9
The Decomposition of a
Polytope into Its Cones
  	
@
@
R
Chapter 10
Eulerâ€“MacLaurin
Summation in Rd
Chapter 11
Solid Angles
Fig. 0.2. The partially ordered set of chapter dependencies.
â€¢
Chapters 3, 4, and 5 develop the full Ehrhart theory of discrete volumes
of rational polytopes.
â€¢
Chapter 6 is a â€œdessertâ€ chapter, in that it enables us to use the theory
developed to treat the enumeration of magic squares, an ancient topic that
enjoys active current research.
Part II
We now begin anew.
â€¢
Having attained experience with numerous examples and results about in-
teger polytopes, we are ready to learn about the Dedekind sums of Chap-
ter 8, which form the atomic pieces of the discrete volume polynomials. On

Preface
XIII
the other hand, to fully understand Dedekind sums, we need to understand
ï¬nite Fourier analysis, which we therefore develop from ï¬rst principles in
Chapter 7, using only partial fractions.
â€¢
Chapter 9 answers a simple yet tricky question: how does the ï¬nite geo-
metric series in one dimension extend to higher-dimensional polytopes?
Brionâ€™s theorem give the elegant and decisive answer to this question.
â€¢
Chapter 10 extends the interplay between the continuous volume and the
discrete volume of a polytope (already studied in detail in Part I) by
introducing Eulerâ€“Maclaurin summation formulas in all dimensions. These
formulas compare the continuous Fourier transform of a polytope to its
discrete Fourier transform, yet the material is completely self-contained.
â€¢
Chapter 11 develops an exciting extension of Ehrhart theory that deï¬nes
and studies the solid angles of a polytope; these are the natural extensions
of 2-dimensional angles to higher dimensions.
â€¢
Finally, we end with another â€œdessertâ€ chapter that uses complex ana-
lytic methods to ï¬nd an integral formula for the discrepancy between the
discrete and continuous areas enclosed by a closed curve in the plane.
Because polytopes are both theoretically useful (in triangulated manifolds,
for example) and practically essential (in computer graphics, for example) we
use them to link results in number theory and combinatorics. There are many
research papers being written on these interconnections, even as we speak,
and it is impossible to capture them all here; however, we hope that these
modest beginnings will give the reader who is unfamiliar with these ï¬elds a
good sense of their beauty, inexorable connectedness, and utility. We have
written a gentle invitation to what we consider a gorgeous world of counting
and of links between the ï¬elds of combinatorics, number theory, and geometry
for the general mathematical reader.
There are a number of excellent books that have a nontrivial intersec-
tion with ours and contain material that complements the topics discussed
here. We heartily recommend the monographs of Barvinok [12] (on general
convexity topics), Ehrhart [81] (the historic introduction to Ehrhart theory),
Ewald [82] (on connections to algebraic geometry), Hibi [96] (on the interplay
of algebraic combinatorics with polytopes), Millerâ€“Sturmfels [132] (on com-
putational commutative algebra), and Stanley [172] (on general enumerative
problems in combinatorics).
Acknowledgments
We have had the good fortune of receiving help from many gracious people
in the process of writing this book. First and foremost, we thank the stu-
dents of the classes in which we could try out this material, at Binghamton
University (SUNY), San Francisco State University, and Temple University.
We are indebted to our MSRI/Banï¬€2005 graduate summer school students.
We give special thanks to Kristin Camenga and Kevin Woods, who ran the

XIV
Preface
problem sessions for this summer school, detected numerous typos, and pro-
vided us with many interesting suggestions for this book. We are grateful
for the generous support for the summer school from the Mathematical Sci-
ences Research Institute, the Paciï¬c Institute of Mathematics, and the Banï¬€
International Research Station.
Many colleagues supported this endeavor, and we are particularly grateful
to everyone notifying us of mistakes, typos, and good suggestions: Daniel An-
tonetti, Alexander Barvinok, Nathanael Berglund, Andrew Beyer, Tristram
Bogart, Garry Bowlin, Benjamin Braun, Robin Chapman, Yitwah Cheung,
Jessica Cuomo, Dimitros Dais, Aaron Dall, Jesus De Loera, David Desario,
Mike Develin, Ricardo Diaz, Michael Dobbins, Jeï¬€Doker, Han Minh Duong,
Richard Ehrenborg, David Einstein, Joseph Gubeladze, Christian Haase,
Mary Halloran, Friedrich Hirzebruch, Brian Hopkins, Serkan HoÂ¸sten,
Ben-
jamin Howard, Piotr Maciak, Evgeny Materov, Asia Matthews, Peter Mc-
Mullen, MartÂ´Ä±n Mereb, Ezra Miller, Mel Nathanson, Julian Pfeiï¬‚e, Peter
Pleasants, Jorge RamÂ´Ä±rez AlfonsÂ´Ä±n, Bruce Reznick, Adrian Riskin, Steven
Sam, Junro Sato, Kim Seashore, Melissa Simmons, Richard Stanley, Bernd
Sturmfels, Thorsten Theobald, Read Vanderbilt, Andrew Van Herick, Sven
Verdoolaege, Mich`ele Vergne, Julie Von Bergen, Neil Weickel, Carl Woll,
Zhiqiang Xu, Jon Yaggie, Ruriko Yoshida, Thomas Zaslavsky, GÂ¨unter Ziegler,
and two anonymous referees. We will collect corrections, updates, etc., at the
Internet website
math.sfsu.edu/beck/ccd.html.
We are indebted to the Springer editorial staï¬€, ï¬rst and foremost to Mark
Spencer, for facilitating the publication process in an always friendly and
supportive spirit. We thank David Kramer for the impeccable copyediting,
Frank Ganz for sharing his LATEX expertise, and Felix Portnoy for the seamless
production process.
Matthias Beck would like to express his deepest gratitude to Tendai
Chitewere, for her patience, support, and unconditional love. He thanks his
family for always being there for him. Sinai Robins would like to thank Michal
Robins, Shani Robins, and Gabriel Robins for their relentless support and un-
derstanding during the completion of this project. We both thank all the cafÂ´es
we have inhabited over the past ï¬ve years for enabling us to turn their coï¬€ee
into theorems.
San Francisco
Matthias Beck
Philadelphia
Sinai Robins
May 2007

Contents
Part I The Essentials of Discrete Volume Computations
1
The Coin-Exchange Problem of Frobenius . . . . . . . . . . . . . . . . .
3
1.1
Why Use Generating Functions?. . . . . . . . . . . . . . . . . . . . . . . . . . .
3
1.2
Two Coins . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5
1.3
Partial Fractions and a Surprising Formula . . . . . . . . . . . . . . . . .
7
1.4
Sylvesterâ€™s Result. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
1.5
Three and More Coins . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
Notes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
Open Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
2
A Gallery of Discrete Volumes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
2.1
The Language of Polytopes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
2.2
The Unit Cube . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
2.3
The Standard Simplex . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
2.4
The Bernoulli Polynomials as Lattice-Point Enumerators
of Pyramids . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
2.5
The Lattice-Point Enumerators of the Cross-Polytopes . . . . . . . 36
2.6
Pickâ€™s Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
2.7
Polygons with Rational Vertices . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
2.8
Eulerâ€™s Generating Function for General Rational Polytopes . . 45
Notes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
Open Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54
3
Counting Lattice Points in Polytopes: The Ehrhart Theory
57
3.1
Triangulations and Pointed Cones . . . . . . . . . . . . . . . . . . . . . . . . . 57
3.2
Integer-Point Transforms for Rational Cones . . . . . . . . . . . . . . . . 60
3.3
Expanding and Counting Using Ehrhartâ€™s Original Approach. . 64
3.4
The Ehrhart Series of an Integral Polytope . . . . . . . . . . . . . . . . . 67

XVI
Contents
3.5
From the Discrete to the Continuous Volume of a Polytope . . . 71
3.6
Interpolation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73
3.7
Rational Polytopes and Ehrhart Quasipolynomials . . . . . . . . . . . 75
3.8
Reï¬‚ections on the Coin-Exchange Problem and the Gallery
of Chapter 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
Notes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77
Open Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82
4
Reciprocity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83
4.1
Generating Functions for Somewhat Irrational Cones . . . . . . . . . 84
4.2
Stanleyâ€™s Reciprocity Theorem for Rational Cones . . . . . . . . . . . 86
4.3
Ehrhartâ€“Macdonald Reciprocity for Rational Polytopes . . . . . . 87
4.4
The Ehrhart Series of Reï¬‚exive Polytopes . . . . . . . . . . . . . . . . . . 88
4.5
More â€œReï¬‚ectionsâ€ on the Coin-Exchange Problem
and the Gallery of Chapter 2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90
Notes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91
Open Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93
5
Face Numbers and the Dehnâ€“Sommerville Relations
in Ehrhartian Terms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
5.1
Face It! . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
5.2
Dehnâ€“Sommerville Extended . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97
5.3
Applications to the Coeï¬ƒcients of an Ehrhart Polynomial . . . . 98
5.4
Relative Volume . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
Notes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103
6
Magic Squares . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
6.1
Itâ€™s a Kind of Magic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106
6.2
Semimagic Squares: Integer Points in the Birkhoï¬€â€“von
Neumann Polytope . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108
6.3
Magic Generating Functions and Constant-Term Identities . . . . 111
6.4
The Enumeration of Magic Squares . . . . . . . . . . . . . . . . . . . . . . . . 116
Notes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
Open Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120

Contents
XVII
Part II Beyond the Basics
7
Finite Fourier Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123
7.1
A Motivating Example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123
7.2
Finite Fourier Series for Periodic Functions on Z . . . . . . . . . . . . 125
7.3
The Finite Fourier Transform and Its Properties. . . . . . . . . . . . . 129
7.4
The Parseval Identity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131
7.5
The Convolution of Finite Fourier Series. . . . . . . . . . . . . . . . . . . . 133
Notes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135
8
Dedekind Sums, the Building Blocks of Lattice-point
Enumeration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139
8.1
Fourierâ€“Dedekind Sums and the Coin-Exchange Problem
Revisited . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139
8.2
The Dedekind Sum and Its Reciprocity and Computational
Complexity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143
8.3
Rademacher Reciprocity for the Fourierâ€“Dedekind Sum . . . . . . 144
8.4
The Mordellâ€“Pommersheim Tetrahedron . . . . . . . . . . . . . . . . . . . 147
Notes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 150
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151
Open Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153
9
The Decomposition of a Polytope into Its Cones . . . . . . . . . . . 155
9.1
The Identity â€œP
mâˆˆZ zm = 0â€. . . or â€œMuch Ado About Nothingâ€155
9.2
Tangent Cones and Their Rational Generating Functions . . . . . 159
9.3
Brionâ€™s Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 160
9.4
Brion Implies Ehrhart . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 162
Notes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 163
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 164
10
Eulerâ€“Maclaurin Summation in Rd . . . . . . . . . . . . . . . . . . . . . . . . . 167
10.1 Todd Operators and Bernoulli Numbers . . . . . . . . . . . . . . . . . . . . 167
10.2 A Continuous Version of Brionâ€™s Theorem . . . . . . . . . . . . . . . . . . 170
10.3 Polytopes Have Their Moments . . . . . . . . . . . . . . . . . . . . . . . . . . . 172
10.4 From the Continuous to the Discrete Volume of a Polytope . . . 174
Notes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 176
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 177
Open Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 178
11
Solid Angles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179
11.1 A New Discrete Volume Using Solid Angles . . . . . . . . . . . . . . . . . 179
11.2 Solid-Angle Generating Functions and a Brion-Type Theorem . 182
11.3 Solid-Angle Reciprocity and the Brianchonâ€“Gram Relations. . . 184

XVIII
Contents
11.4 The Generating Function of Macdonaldâ€™s Solid-Angle
Polynomials . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 188
Notes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 189
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 189
Open Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 190
12
A Discrete Version of Greenâ€™s Theorem Using Elliptic
Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191
12.1 The Residue Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191
12.2 The WeierstraÃŸ â„˜and Î¶ Functions . . . . . . . . . . . . . . . . . . . . . . . . . 193
12.3 A Contour-Integral Extension of Pickâ€™s Theorem . . . . . . . . . . . . 195
Notes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 196
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 196
Open Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 197
A
Vertex and Hyperplane Descriptions of Polytopes . . . . . . . . . 199
A.1 Every h-cone is a v-cone . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 200
A.2 Every v-cone is an h-cone. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 202
B
Triangulations of Polytopes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 205
Hints for â™£Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 209
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 217
List of Symbols . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 227
Index . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 229


1
The Coin-Exchange Problem of Frobenius
The full beauty of the subject of generating functions emerges only from tuning in
on both channels: the discrete and the continuous.
Herbert Wilf [187]
Suppose weâ€™re interested in an inï¬nite sequence of numbers (ak)âˆ
k=0 that arises
geometrically or recursively. Is there a â€œgood formulaâ€ for ak as a function of
k? Are there identities involving various akâ€™s? Embedding this sequence into
the generating function
F(z) =
X
kâ‰¥0
ak zk
allows us to retrieve answers to the questions above in a surprisingly quick
and elegant way. We can think of F(z) as lifting our sequence ak from its
discrete setting into the continuous world of functions.
1.1 Why Use Generating Functions?
To illustrate these concepts, we warm up with the classic example of the
Fibonacci sequence fk, named after Leonardo Pisano Fibonacci (1170â€“
1250?)1 and deï¬ned by the recursion
f0 = 0, f1 = 1,
and fk+2 = fk+1 + fk for k â‰¥0 .
This gives the sequence (fk)âˆ
k=0 = (0, 1, 1, 2, 3, 5, 8, 13, 21, 34, . . . ) (see also
[165, Sequence A000045]). Now letâ€™s see what generating functions can do for
us. Let
1 For more information about Fibonacci, see
http://www-groups.dcs.st-and.ac.uk/âˆ¼history/Biographies/Fibonacci.html.

4
1 The Coin-Exchange Problem of Frobenius
F(z) =
X
kâ‰¥0
fk zk.
We embed both sides of the recursion identity into their generating functions:
X
kâ‰¥0
fk+2 zk =
X
kâ‰¥0
(fk+1 + fk) zk =
X
kâ‰¥0
fk+1 zk +
X
kâ‰¥0
fk zk.
(1.1)
The leftâ€“hand side of (1.1) is
X
kâ‰¥0
fk+2 zk = 1
z2
X
kâ‰¥0
fk+2 zk+2 = 1
z2
X
kâ‰¥2
fk zk = 1
z2 (F(z) âˆ’z) ,
while the rightâ€“hand side of (1.1) is
X
kâ‰¥0
fk+1 zk +
X
kâ‰¥0
fk zk = 1
z F(z) + F(z) .
So (1.1) can be restated as
1
z2 (F(z) âˆ’z) = 1
z F(z) + F(z) ,
or
F(z) =
z
1 âˆ’z âˆ’z2 .
Itâ€™s fun to check (e.g., with a computer) that when we expand the function F
into a power series, we indeed obtain the Fibonacci numbers as coeï¬ƒcients:
z
1 âˆ’z âˆ’z2 = z + z2 + 2 z3 + 3 z4 + 5 z5 + 8 z6 + 13 z7 + 21 z8 + 34 z9 + Â· Â· Â· .
Now we use our favorite method of handling rational functions: the par-
tial fraction expansion. In our case, the denominator factors as 1 âˆ’z âˆ’z2 =

1 âˆ’1+
âˆš
5
2
z
 
1 âˆ’1âˆ’
âˆš
5
2
z

, and the partial fraction expansion is (see Exer-
cise 1.1)
F(z) =
z
1 âˆ’z âˆ’z2 =
1/
âˆš
5
1 âˆ’1+
âˆš
5
2
z
âˆ’
1/
âˆš
5
1 âˆ’1âˆ’
âˆš
5
2
z
.
(1.2)
The two terms suggest the use of the geometric series
X
kâ‰¥0
xk =
1
1 âˆ’x
(1.3)
(see Exercise 1.2) with x = 1+
âˆš
5
2
z and x = 1âˆ’
âˆš
5
2
z, respectively:
F(z) =
z
1 âˆ’z âˆ’z2 =
1
âˆš
5
X
kâ‰¥0
 
1 +
âˆš
5
2
z
!k
âˆ’1
âˆš
5
X
kâ‰¥0
 
1 âˆ’
âˆš
5
2
z
!k
=
X
kâ‰¥0
1
âˆš
5
ï£«
ï£­
 
1 +
âˆš
5
2
!k
âˆ’
 
1 âˆ’
âˆš
5
2
!kï£¶
ï£¸zk.

1.2 Two Coins
5
Comparing the coeï¬ƒcients of zk in the deï¬nition of F(z) = P
kâ‰¥0 fk zk and
the new expression above for F(z), we discover the closed form expression for
the Fibonacci sequence
fk =
1
âˆš
5
 
1 +
âˆš
5
2
!k
âˆ’1
âˆš
5
 
1 âˆ’
âˆš
5
2
!k
.
This method of decomposing a rational generating function into partial
fractions is one of our key tools. Because we will use partial fractions time
and again throughout this book, we record the result on which this method
is based.
Theorem 1.1 (Partial fraction expansion). Given any rational function
F(z) :=
p(z)
Qm
k=1 (z âˆ’ak)ek ,
where p is a polynomial of degree less than e1 + e2 + Â· Â· Â· + em and the akâ€™s are
distinct, there exists a decomposition
F(z) =
m
X
k=1
 
ck,1
z âˆ’ak
+
ck,2
(z âˆ’ak)2 + Â· Â· Â· +
ck,ek
(z âˆ’ak)ek
!
,
where ck,j âˆˆC are unique.
One possible proof of this theorem is based on the fact that the polynomials
form a Euclidean domain. For readers who are acquainted with this notion,
we outline this proof in Exercise 1.35.
1.2 Two Coins
Letâ€™s imagine that we introduce a new coin system. Instead of using pennies,
nickels, dimes, and quarters, letâ€™s say we agree on using 4-cent, 7-cent, 9-cent,
and 34-cent coins. The reader might point out the following ï¬‚aw of this new
system: certain amounts cannot be changed (that is, created with the available
coins), for example, 2 or 5 cents. On the other hand, this deï¬ciency makes our
new coin system more interesting than the old one, because we can ask the
question, â€œwhich amounts can be changed?â€ In fact, we will prove in Exercise
1.20 that there are only ï¬nitely many integer amounts that cannot be changed
using our new coin system. A natural question, ï¬rst tackled by Ferdinand
Georg Frobenius (1849â€“1917),2 and James Joseph Sylvester (1814â€“1897)3 is,
2 For more information about Frobenius, see
http://www-groups.dcs.st-and.ac.uk/âˆ¼history/Biographies/Frobenius.html.
3 For more information about Sylvester, see
http://www-groups.dcs.st-and.ac.uk/âˆ¼history/Biographies/Sylvester.html.

6
1 The Coin-Exchange Problem of Frobenius
â€œwhat is the largest amount that cannot be changed?â€ As mathematicians,
we like to keep questions as general as possible, and so we ask, given coins of
denominations a1, a2, . . . , ad, which are positive integers without any common
factor, can you give a formula for the largest amount that cannot be changed
using the coins a1, a2, . . . , ad? This problem is known as the Frobenius coin-
exchange problem.
To be precise, suppose weâ€™re given a set of positive integers
A = {a1, a2, . . . , ad}
with gcd (a1, a2, . . . , ad) = 1 and we call an integer n representable if there
exist nonnegative integers m1, m2, . . . , md such that
n = m1a1 + Â· Â· Â· + mdad .
In the language of coins, this means that we can change the amount n us-
ing the coins a1, a2, . . . , ad. The Frobenius problem (often called the linear
Diophantine problem of Frobenius) asks us to ï¬nd the largest integer that is
not representable. We call this largest integer the Frobenius number and
denote it by g(a1, . . . , ad). The following theorem gives us a pretty formula
for d = 2.
Theorem 1.2. If a1 and a2 are relatively prime positive integers, then
g (a1, a2) = a1a2 âˆ’a1 âˆ’a2 .
This simple-looking formula for g inspired a great deal of research into
formulas for g (a1, a2, . . . , ad) with only limited success; see the notes at the
end of this chapter. For d = 2, Sylvester gave the following result.
Theorem 1.3 (Sylvesterâ€™s theorem). Let a1 and a2 be relatively prime
positive integers. Exactly half of the integers between 1 and (a1 âˆ’1) (a2 âˆ’1)
are representable.
Our goal in this chapter is to prove these two theorems (and a little more)
using the machinery of partial fractions. We approach the Frobenius problem
through the study of the restricted partition function
pA(n) := #

(m1, . . . , md) âˆˆZd : all mj â‰¥0, m1a1 + Â· Â· Â· + mdad = n
	
,
the number of partitions of n using only the elements of A as parts.4 In
view of this partition function, g(a1, . . . , ad) is the largest integer n for which
pA(n) = 0.
There is a beautiful geometric interpretation of the restricted partition
function. The geometric description begins with the set
4 A partition of a positive integer n is a multiset (i.e., a set in which we allow
repetition) {n1, n2, . . . , nk} of positive integers such that n = n1 + n2 + Â· Â· Â· + nk.
The numbers n1, n2, . . . , nk are called the parts of the partition.

1.3 Partial Fractions and a Surprising Formula
7
P =

(x1, . . . , xd) âˆˆRd : all xj â‰¥0, x1a1 + Â· Â· Â· + xdad = 1
	
.
(1.4)
The nth dilate of any set S âŠ†Rd is
{(nx1, nx2, . . . , nxd) : (x1, . . . , xd) âˆˆS} .
The function pA(n) counts precisely those integer points that lie in the nth
integer dilate of the body P. The dilation process in this context is tantamount
to replacing x1a1+Â· Â· Â·+xdad = 1 in the deï¬nition of P by x1a1+Â· Â· Â·+xdad = n.
The set P turns out to be a polytope. We can easily picture P and its dilates
for dimension d â‰¤3; Figure 1.1 shows the three-dimensional case.
x
y
z
1
a
1
b
1
c
n
a
n
b
n
c
Fig. 1.1. d = 3.
1.3 Partial Fractions and a Surprising Formula
We ï¬rst concentrate on the case d = 2 and study

8
1 The Coin-Exchange Problem of Frobenius
p{a,b}(n) = #

(k, l) âˆˆZ2 : k, l â‰¥0, ak + bl = n
	
.
Recall that we require a and b to be relatively prime. To begin our discus-
sion, we start playing with generating functions. Consider the product of the
following two geometric series:

1
1 âˆ’za
 
1
1 âˆ’zb

=
 1 + za + z2a + Â· Â· Â·
  1 + zb + z2b + Â· Â· Â·

(see Exercise 1.2). If we multiply out all the terms weâ€™ll get a power series all
of whose exponents are linear combinations of a and b. In fact, the coeï¬ƒcient
of zn in this power series counts the number of ways that n can be written as
a nonnegative linear combination of a and b. In other words, these coeï¬ƒcients
are precisely evaluations of our counting function p{a,b}:

1
1 âˆ’za
 
1
1 âˆ’zb

=
X
kâ‰¥0
X
lâ‰¥0
zakzbl =
X
nâ‰¥0
p{a,b}(n) zn.
So this function is the generating function for the sequence of integers
 p{a,b}(n)
âˆ
n=0. The idea is now to study the compact function on the left.
We would like to uncover an interesting formula for p{a,b}(n) by looking at
the generating function on the left more closely. To make our computational
life easier, we study the constant term of a related series; namely, p{a,b}(n) is
the constant term of
f(z) :=
1
(1 âˆ’za) (1 âˆ’zb) zn =
X
kâ‰¥0
p{a,b}(k) zkâˆ’n.
The latter series is not quite a power series, since it includes terms with neg-
ative exponents. These series are called Laurent series, after Pierre Alphonse
Laurent (1813â€“1854). For a power series (centered at 0), we could simply eval-
uate the corresponding function at z = 0 to obtain the constant term; once
we have negative exponents, such an evaluation is not possible. However, if
we ï¬rst subtract all terms with negative exponents, weâ€™ll get a power series
whose constant term (which remains unchanged) can now be computed by
evaluating this remaining function at z = 0.
To be able to compute this constant term, we will expand f into partial
fractions. As a warm-up to partial fraction decompositions, we ï¬rst work out
a one-dimensional example. Letâ€™s denote the ï¬rst ath root of unity by
Î¾a := e2Ï€i/a = cos 2Ï€
a + i sin 2Ï€
a ;
then all the ath roots of unity are 1, Î¾a, Î¾2
a, Î¾3
a, . . . , Î¾aâˆ’1
a
.
Example 1.4. Letâ€™s ï¬nd the partial fraction expansion of
1
1âˆ’za . The poles of
this function are located at all ath roots of unity Î¾k
a for k = 0, 1, . . . , a âˆ’1. So
we expand

1.3 Partial Fractions and a Surprising Formula
9
1
1 âˆ’za =
aâˆ’1
X
k=0
Ck
z âˆ’Î¾ka
.
How do we ï¬nd the coeï¬ƒcients Ck? Well,
Ck = lim
zâ†’Î¾k
a
 z âˆ’Î¾k
a
 
1
1 âˆ’za

= lim
zâ†’Î¾k
a
1
âˆ’a zaâˆ’1 = âˆ’Î¾k
a
a ,
where we have used Lâ€™HË†opitalâ€™s rule in the penultimate equality. Therefore,
we arrive at the expansion
1
1 âˆ’za = âˆ’1
a
aâˆ’1
X
k=0
Î¾k
a
z âˆ’Î¾ka
.
âŠ“âŠ”
Returning to restricted partitions, the poles of f are located at z = 0 with
multiplicity n, at z = 1 with multiplicity 2, and at all the other ath and bth
roots of unity with multiplicity 1 because a and b are relatively prime. Hence
our partial fraction expansion looks like
f(z) = A1
z + A2
z2 +Â· Â· Â·+ An
zn + B1
z âˆ’1 +
B2
(z âˆ’1)2 +
aâˆ’1
X
k=1
Ck
z âˆ’Î¾ka
+
bâˆ’1
X
j=1
Dj
z âˆ’Î¾j
b
. (1.5)
We invite the reader to compute the coeï¬ƒcients (Exercise 1.21)
Ck = âˆ’
1
a (1 âˆ’Î¾kb
a ) Î¾k(nâˆ’1)
a
,
(1.6)
Dj = âˆ’
1
b

1 âˆ’Î¾ja
b

Î¾j(nâˆ’1)
b
.
To compute B2, we multiply both sides of (1.5) by (z âˆ’1)2 and take the limit
as z â†’1 to obtain
B2 = lim
zâ†’1
(z âˆ’1)2
(1 âˆ’za) (1 âˆ’zb) zn = 1
ab ,
by applying Lâ€™HË†opitalâ€™s rule twice, for example. For the more interesting con-
stant B1, we compute
B1 = lim
zâ†’1 (z âˆ’1)
 
1
(1 âˆ’za) (1 âˆ’zb) zn âˆ’
1
ab
(z âˆ’1)2
!
= 1
ab âˆ’1
2a âˆ’1
2b âˆ’n
ab ,
again by applying Lâ€™HË†opitalâ€™s rule.
We donâ€™t need to compute the coeï¬ƒcients A1, . . . , An, since they con-
tribute only to the terms with negative exponents, which we can safely ne-
glect; these terms do not contribute to the constant term of f. Once we have

10
1 The Coin-Exchange Problem of Frobenius
the other coeï¬ƒcients, the constant term of the Laurent series of f isâ€”as we
said aboveâ€”the following function evaluated at 0:
p{a,b}(n) =
ï£«
ï£­B1
z âˆ’1 +
B2
(z âˆ’1)2 +
aâˆ’1
X
k=1
Ck
z âˆ’Î¾ka
+
bâˆ’1
X
j=1
Dj
z âˆ’Î¾j
b
ï£¶
ï£¸

z=0
= âˆ’B1 + B2 âˆ’
aâˆ’1
X
k=1
Ck
Î¾ka
âˆ’
bâˆ’1
X
j=1
Dj
Î¾j
b
.
With (1.6) in hand, this simpliï¬es to
p{a,b}(n) = 1
2a + 1
2b + n
ab + 1
a
aâˆ’1
X
k=1
1
(1 âˆ’Î¾kb
a )Î¾kn
a
+ 1
b
bâˆ’1
X
j=1
1
(1 âˆ’Î¾ja
b )Î¾jn
b
. (1.7)
Encouraged by this initial success, we now proceed to analyze each sum in
(1.7) with the hope of recognizing them as more familiar objects.
For the next step we need to deï¬ne the greatest-integer function âŒŠxâŒ‹,
which denotes the greatest integer less than or equal to x. A close sibling
to this function is the fractional-part function {x} = x âˆ’âŒŠxâŒ‹. To readers
not familiar with the functions âŒŠxâŒ‹and {x} we recommend working through
Exercises 1.3â€“1.5.
What weâ€™ll do next is study a special case, namely b = 1. This is appealing
because p{a,1}(n) simply counts integer points in an interval:
p{a,1}(n) = #

(k, l) âˆˆZ2 : k, l â‰¥0, ak + l = n
	
= # {k âˆˆZ : k â‰¥0, ak â‰¤n}
= #
n
k âˆˆZ : 0 â‰¤k â‰¤n
a
o
=
jn
a
k
+ 1 .
(See Exercise 1.3.) On the other hand, in (1.7) we just computed a diï¬€erent
expression for this function, so that
1
2a + 1
2 + n
a + 1
a
aâˆ’1
X
k=1
1
(1 âˆ’Î¾ka) Î¾kn
a
= p{a,1}(n) =
jn
a
k
+ 1 .
With the help of the fractional-part function {x} = x âˆ’âŒŠxâŒ‹, we have derived
a formula for the following sum over ath roots of unity:
1
a
aâˆ’1
X
k=1
1
(1 âˆ’Î¾ka) Î¾kn
a
= âˆ’
nn
a
o
+ 1
2 âˆ’1
2a .
(1.8)
Weâ€™re almost there: we invite the reader (Exercise 1.22) to show that

1.4 Sylvesterâ€™s Result
11
1
a
aâˆ’1
X
k=1
1
(1 âˆ’Î¾bk
a ) Î¾kn
a
= 1
a
aâˆ’1
X
k=1
1
(1 âˆ’Î¾ka) Î¾bâˆ’1kn
a
,
(1.9)
where bâˆ’1 is an integer such that bâˆ’1b â‰¡1 mod a, and to conclude that
1
a
aâˆ’1
X
k=1
1
(1 âˆ’Î¾bk
a ) Î¾kn
a
= âˆ’
bâˆ’1n
a

+ 1
2 âˆ’1
2a .
(1.10)
Now all thatâ€™s left to do is to substitute this expression back into (1.7), which
yields the following beautiful formula due to Tiberiu Popoviciu (1906â€“1975).
Theorem 1.5 (Popoviciuâ€™s theorem). If a and b are relatively prime, then
p{a,b}(n) = n
ab âˆ’
bâˆ’1n
a

âˆ’
aâˆ’1n
b

+ 1 ,
where bâˆ’1b â‰¡1 mod a and aâˆ’1a â‰¡1 mod b.
âŠ“âŠ”
1.4 Sylvesterâ€™s Result
Before we apply Theorem 1.5 to obtain the classical Theorems 1.2 and 1.3, we
return for a moment to the geometry behind the restricted partition function
p{a,b}(n). In the two-dimensional case (which is the setting of Theorem 1.5),
we are counting integer points (x, y) âˆˆZ2 on the line segments deï¬ned by the
constraints
ax + by = n ,
x, y â‰¥0 .
As n increases, the line segment gets dilated. It is not too far-fetched (al-
though Exercise 1.13 teaches us to be careful with such statements) to expect
that the likelihood for an integer point to lie on the line segment increases
with n. In fact, one might even guess that the number of points on the line
segment increases linearly with n, since the line segment is a one-dimensional
object. Theorem 1.5 quantiï¬es the previous statement in a very precise form:
p{a,b}(n) has the â€œleading termâ€ n/ab, and the remaining terms are bounded
as functions in n. Figure 1.2 shows the geometry behind the counting func-
tion p{4,7}(n) for the ï¬rst few values of n. Note that the thick line segment
for n = 17 = 4 Â· 7 âˆ’4 âˆ’7 is the last one that does not contain any integer
point.
Lemma 1.6. If a and b are relatively prime positive integers and n âˆˆ[1, abâˆ’1]
is not a multiple of a or b, then
p{a,b}(n) + p{a,b}(ab âˆ’n) = 1 .
In other words, for n between 1 and ab âˆ’1 and not divisible by a or b, exactly
one of the two integers n and ab âˆ’n is representable in terms of a and b.

12
1 The Coin-Exchange Problem of Frobenius
x
0
1
2
3
4
5
6
7
8
9
y
0
1
2
3
4
5
Fig. 1.2. 4x + 7y = n, n = 1, 2, . . .
Proof. This identity follows directly from Theorem 1.5:
p{a,b}(ab âˆ’n) = ab âˆ’n
ab
âˆ’
bâˆ’1(ab âˆ’n)
a

âˆ’
aâˆ’1(ab âˆ’n)
b

+ 1
= 2 âˆ’n
ab âˆ’
âˆ’bâˆ’1n
a

âˆ’
âˆ’aâˆ’1n
b

(â‹†)
= âˆ’n
ab +
bâˆ’1n
a

+
aâˆ’1n
b

= 1 âˆ’p{a,b}(n) .
Here, (â‹†) follows from the fact that {âˆ’x} = 1âˆ’{x} if x Ì¸âˆˆZ (see Exercise 1.5).
âŠ“âŠ”
Proof of Theorem 1.2. We have to show that p{a,b}(ab âˆ’a âˆ’b) = 0 and that
p{a,b}(n) > 0 for every n > ab âˆ’a âˆ’b. The ï¬rst assertion follows with Exer-
cise 1.24, which states that p{a,b}(a + b) = 1, and Lemma 1.6. To prove the
second assertion, we note that for any integer m,
 m
a
	
â‰¤1âˆ’1
a. Hence for any
positive integer n,
p{a,b}(ab âˆ’a âˆ’b + n) â‰¥ab âˆ’a âˆ’b + n
ab
âˆ’

1 âˆ’1
a

âˆ’

1 âˆ’1
b

+ 1 = n
ab > 0 .
âŠ“âŠ”
Proof of Theorem 1.3. Recall that Lemma 1.6 states that for n between 1 and
abâˆ’1 and not divisible by a or b, exactly one of n and abâˆ’n is representable.
There are
ab âˆ’a âˆ’b + 1 = (a âˆ’1)(b âˆ’1)

1.5 Three and More Coins
13
integers between 1 and ab âˆ’1 that are not divisible by a or b. Finally, we
note that p{a,b}(n) > 0 if n is a multiple of a or b, by the very deï¬nition of
p{a,b}(n). Hence the number of nonrepresentable integers is 1
2(aâˆ’1)(bâˆ’1).
âŠ“âŠ”
Note that we have proved even more. Essentially by Lemma 1.6, every
positive integer less than ab has at most one representation. Hence, the rep-
resentable integers less than ab are uniquely representable (see also Exer-
cise 1.25).
1.5 Three and More Coins
What happens to the complexity of the Frobenius problem if we have more
than two coins? Letâ€™s go back to our restricted partition function
pA(n) = #

(m1, . . . , md) âˆˆZd : all mj â‰¥0, m1a1 + Â· Â· Â· + mdad = n
	
,
where A = {a1, . . . , ad}. By the very same reasoning as in Section 1.3, we can
easily write down the generating function for pA(n):
X
nâ‰¥0
pA(n) zn =

1
1 âˆ’za1
 
1
1 âˆ’za2

Â· Â· Â·

1
1 âˆ’zad

.
We use the same methods that were exploited in Section 1.3 to recover our
function pA(n) as the constant term of a useful generating function. Namely,
pA(n) = const

1
(1 âˆ’za1) (1 âˆ’za2) Â· Â· Â· (1 âˆ’zad) zn

.
We now expand the function on the right into partial fractions. For reasons
of simplicity we assume in the following that a1, . . . , ad are pairwise relatively
prime; that is, no two of the integers a1, a2, . . . , ad have a common factor.
Then our partial fraction expansion looks like
f(z) =
1
(1 âˆ’za1) Â· Â· Â· (1 âˆ’zad) zn
= A1
z + A2
z2 + Â· Â· Â· + An
zn +
B1
z âˆ’1 +
B2
(z âˆ’1)2 + Â· Â· Â· +
Bd
(z âˆ’1)d
(1.11)
+
a1âˆ’1
X
k=1
C1k
z âˆ’Î¾ka1
+
a2âˆ’1
X
k=1
C2k
z âˆ’Î¾ka2
+ Â· Â· Â· +
adâˆ’1
X
k=1
Cdk
z âˆ’Î¾kad
.
By now weâ€™re experienced in computing partial fraction coeï¬ƒcients, so that
the reader will easily verify that (Exercise 1.29)
C1k = âˆ’
1
a1

1 âˆ’Î¾ka2
a1
 
1 âˆ’Î¾ka3
a1

Â· Â· Â·

1 âˆ’Î¾kad
a1

Î¾k(nâˆ’1)
a1
.
(1.12)

14
1 The Coin-Exchange Problem of Frobenius
As before, we donâ€™t have to compute the coeï¬ƒcients A1, . . . , An, because they
donâ€™t contribute to the constant term of f. For the computation of B1, . . . , Bd,
we may use a symbolic manipulation program such as Maple or Mathematica.
Again, once we have calculated these coeï¬ƒcients, we can compute the constant
term of f by dropping all negative exponents and evaluating the remaining
function at 0:
pA(n) =
 
B1
z âˆ’1 + Â· Â· Â· +
Bd
(z âˆ’1)d +
a1âˆ’1
X
k=1
C1k
z âˆ’Î¾ka1
+ Â· Â· Â· +
adâˆ’1
X
k=1
Cdk
z âˆ’Î¾kad
!
z=0
= âˆ’B1 + B2 âˆ’Â· Â· Â· + (âˆ’1)dBd âˆ’
a1âˆ’1
X
k=1
C1k
Î¾ka1
âˆ’
a2âˆ’1
X
k=1
C2k
Î¾ka2
âˆ’Â· Â· Â· âˆ’
adâˆ’1
X
k=1
Cdk
Î¾kad
.
Substituting the expression we found for C1k into the latter sum over the
nontrivial ath
1 roots of unity, for example, gives rise to
1
a1
a1âˆ’1
X
k=1
1

1 âˆ’Î¾ka2
a1
 
1 âˆ’Î¾ka3
a1

Â· Â· Â·

1 âˆ’Î¾kad
a1

Î¾kn
a1
.
This motivates the deï¬nition of the Fourierâ€“Dedekind sum
sn (a1, a2, . . . , am; b) := 1
b
bâˆ’1
X
k=1
Î¾kn
b

1 âˆ’Î¾ka1
b
 
1 âˆ’Î¾ka2
b

Â· Â· Â·

1 âˆ’Î¾kam
b
 . (1.13)
We will study these sums in detail in Chapter 8. With this deï¬nition, we have
arrived at the following result.
Theorem 1.7. The restricted partition function for A = {a1, a2, . . . , ad},
where the akâ€™s are pairwise relatively prime, can be computed as
pA(n) = âˆ’B1 + B2 âˆ’Â· Â· Â· + (âˆ’1)dBd + sâˆ’n (a2, a3, . . . , ad; a1)
+ sâˆ’n (a1, a3, a4, . . . , ad; a2) + Â· Â· Â· + sâˆ’n (a1, a2, . . . , adâˆ’1; ad) .
Here B1, B2, . . . , Bd are the partial fraction coeï¬ƒcients in the expansion
(1.11).
âŠ“âŠ”
Example 1.8. We give the restricted partition functions for d = 3 and 4.
These closed-form formulas have proven useful in the reï¬ned analysis of the
periodicity that is inherent in the restricted partition function pA(n). For
example, one can visualize the graph of p{a,b,c}(n) as a â€œwavy parabola,â€ as
its formula plainly shows.

Notes
15
p{a,b,c}(n) = n2
2abc + n
2
 1
ab + 1
ac + 1
bc

+ 1
12
3
a + 3
b + 3
c + a
bc + b
ac + c
ab

+ 1
a
aâˆ’1
X
k=1
1
(1 âˆ’Î¾kb
a ) (1 âˆ’Î¾kc
a ) Î¾kn
a
+ 1
b
bâˆ’1
X
k=1
1
 1 âˆ’Î¾kc
b
  1 âˆ’Î¾ka
b

Î¾kn
b
+ 1
c
câˆ’1
X
k=1
1
(1 âˆ’Î¾ka
c ) (1 âˆ’Î¾kb
c ) Î¾kn
c
,
p{a,b,c,d}(n) =
n3
6abcd + n2
4
 1
abc +
1
abd +
1
acd + 1
bcd

+ n
12
 3
ab + 3
ac + 3
ad + 3
bc + 3
bd + 3
cd + a
bcd +
b
acd +
c
abd + d
abc

+ 1
24
 a
bc + a
bd + a
cd + b
ad + b
ac + b
cd + c
ab + c
ad + c
bd
+ d
ab + d
ac + d
bc

âˆ’1
8
1
a + 1
b + 1
c + 1
d

+ 1
a
aâˆ’1
X
k=1
1
(1 âˆ’Î¾kb
a ) (1 âˆ’Î¾kc
a ) (1 âˆ’Î¾kd
a ) Î¾kn
a
+ 1
b
bâˆ’1
X
k=1
1
 1 âˆ’Î¾kc
b
  1 âˆ’Î¾kd
b
  1 âˆ’Î¾ka
b

Î¾kn
b
+ 1
c
câˆ’1
X
k=1
1
(1 âˆ’Î¾kd
c ) (1 âˆ’Î¾ka
c ) (1 âˆ’Î¾kb
c ) Î¾kn
c
+ 1
d
dâˆ’1
X
k=1
1
 1 âˆ’Î¾ka
d
  1 âˆ’Î¾kb
d
  1 âˆ’Î¾kc
d

Î¾kn
d
.
âŠ“âŠ”
Notes
1. The theory of generating functions has a long and powerful tradition. We
only touch on its utility. For those readers who would like to dig a little
deeper into the vast generating-function garden, we strongly recommend Herb
Wilfâ€™s generatingfunctionology [187] and LÂ´aszlÂ´o LovÂ´aszâ€™s Combinatorial Prob-
lems and Exercises [122]. The reader might wonder why we do not stress
convergence aspects of the generating functions we play with. Almost all of
our series are geometric series and have trivial convergence properties. In the
spirit of not muddying the waters of lucid mathematical exposition, we omit
such convergence details.
2. The Frobenius problem is named after Georg Frobenius, who apparently
liked to raise this problem in his lectures [41]. Theorem 1.2 is one of the

16
1 The Coin-Exchange Problem of Frobenius
famous folklore results and might be one of the most misquoted theorems
in all of mathematics. People usually cite James J. Sylvesterâ€™s problem in
[177], but his paper contains Theorem 1.3 rather than 1.2. In fact, Sylvesterâ€™s
problem had previously appeared as a theorem in [176]. It is not known who
ï¬rst discovered or proved Theorem 1.2. It is very conceivable that Sylvester
knew about it when he came up with Theorem 1.3.
3. The linear Diophantine problem of Frobenius should not be confused with
the postage-stamp problem. The latter problem asks for a similar determina-
tion, but adds an additional independent bound on the size of the integer
solutions to the linear equation.
4. Theorem 1.5 has an interesting history. The earliest appearance of this
result that we are aware of is in a paper by Tiberiu Popoviciu [148]. Popoviciuâ€™s
formula has since been resurrected at least twice [161, 183].
5. Fourierâ€“Dedekind sums ï¬rst surfaced implicitly in Sylvesterâ€™s work (see,
e.g., [175]) and explicitly in connection with restricted partition functions
in [104]. They were rediscovered in [25], in connection with the Frobenius
problem. The papers [157, 83] contain interesting connections to Bernoulli
and Euler polynomials. We will resume the study of the Fourierâ€“Dedekind
sums in Chapter 8.
6. As we already mentioned above, the Frobenius problem for d â‰¥3 is much
harder than the case d = 2 that we have discussed. Certainly beyond d = 3,
the Frobenius problem is wide open, though much eï¬€ort has been put into its
study. The literature on the Frobenius problem is vast, and there is still much
room for improvement. The interested reader might consult the comprehensive
monograph [153], which surveys the references to almost all articles dealing
with the Frobenius problem and gives about 40 open problems and conjectures
related to the Frobenius problem. To give a ï¬‚avor, we mention two landmark
results that go beyond d = 2.
The ï¬rst one concerns the generating function r(z) := P
kâˆˆR zk, where
R is the set of all integers representable by a given set of relatively prime
positive integers a1, a2, . . . , ad. It is not hard to see (Exercise 1.34) that
r(z) = p(z)/ (1 âˆ’za1) (1 âˆ’za2) Â· Â· Â· (1 âˆ’zad) for some polynomial p. This ra-
tional generating function contains all the information about the Frobenius
problem; for example, the Frobenius number is the total degree of the function
1
1âˆ’z âˆ’r(z). Hence the Frobenius problem reduces to ï¬nding the polynomial
p, the numerator of r. Marcel Morales [134, 135] and Graham Denham [73]
discovered the remarkable fact that for d = 3, the polynomial p has either 4
or 6 terms. Moreover, they gave semi-explicit formulas for p. The Moralesâ€“
Denham theorem implies that the Frobenius number in the case d = 3 is
quickly computable, a result that is originally due, in various disguises, to
JÂ¨urgen Herzog [95], Harold Greenberg [89], and J. Leslie Davison [65]. As

Exercises
17
much as there seems to be a well-deï¬ned border between the cases d = 2
and d = 3, there also seems to be such a border between the cases d = 3
and d = 4: Henrik Bresinsky [43] proved that for d â‰¥4, there is no absolute
bound for the number of terms in the numerator p, in sharp contrast to the
Moralesâ€“Denham theorem.
On the other hand, Alexander Barvinok and Kevin Woods [14] proved
that for ï¬xed d, the rational generating function r(z) can be written as a
â€œshortâ€ sum of rational functions; in particular, r can be eï¬ƒciently computed
when d is ï¬xed. A corollary of this fact is that the Frobenius number can
be eï¬ƒciently computed when d is ï¬xed; this theorem is due to Ravi Kannan
[105]. On the other hand, Jorge RamÂ´Ä±rez-AlfonsÂ´Ä±n [152] proved that trying to
eï¬ƒciently compute the Frobenius number is hopeless if d is left as a variable.
While the above results settle the theoretical complexity of the computa-
tion of the Frobenius number, practical algorithms are a completely diï¬€erent
matter. Both Kannanâ€™s and Barvinokâ€“Woodsâ€™s ideas seem complex enough
that nobody has yet tried to implement them. Currently, the fastest algo-
rithm is presented in [32].
Exercises
1.1. â™£Check the partial fraction expansion (1.2):
z
1 âˆ’z âˆ’z2 =
1/
âˆš
5
1 âˆ’1+
âˆš
5
2
z
âˆ’
1/
âˆš
5
1 âˆ’1âˆ’
âˆš
5
2
z
.
1.2. â™£Suppose z is a complex number, and n is a positive integer. Show that
(1 âˆ’z)
 1 + z + z2 + Â· Â· Â· + zn
= 1 âˆ’zn+1,
and use this to prove that if |z| < 1,
X
kâ‰¥0
zk =
1
1 âˆ’z .
1.3. â™£Find a formula for the number of lattice points in [a, b] for arbitrary
real numbers a and b.
1.4. Prove the following. Unless stated diï¬€erently, n âˆˆZ and x, y âˆˆR.
(a) âŒŠx + nâŒ‹= âŒŠxâŒ‹+ n.
(b) âŒŠxâŒ‹+ âŒŠyâŒ‹â‰¤âŒŠx + yâŒ‹â‰¤âŒŠxâŒ‹+ âŒŠyâŒ‹+ 1.
(c) âŒŠxâŒ‹+ âŒŠâˆ’xâŒ‹=

0
if x âˆˆZ,
âˆ’1 otherwise.
(d) For n âˆˆZ>0,
j
âŒŠxâŒ‹
n
k
=
 x
n

.
(e) âˆ’âŒŠâˆ’xâŒ‹is the least integer greater than or equal to x, denoted by âŒˆxâŒ‰.

18
1 The Coin-Exchange Problem of Frobenius
(f) âŒŠx + 1/2âŒ‹is the nearest integer to x (and if two integers are equally near
to x, it is the larger of the two).
(g) âŒŠxâŒ‹+ âŒŠx + 1/2âŒ‹= âŒŠ2xâŒ‹.
(h) If m and n are positive integers,
 m
n

is the number of integers among
1, . . . , m that are divisible by n.
(i) â™£If m âˆˆZ>0, n âˆˆZ, then
 nâˆ’1
m

= âˆ’
 âˆ’n
m

âˆ’1.
(j) â™£If m âˆˆZ>0, n âˆˆZ, then
 nâˆ’1
m

+ 1 is the least integer greater than or
equal to n/m.
1.5. Rewrite in terms of the fractional-part function as many of the above
identities as you can make sense of.
1.6. Suppose m and n are relatively prime positive integers. Prove that
mâˆ’1
X
k=0
kn
m

=
nâˆ’1
X
j=0
jm
n

= 1
2(m âˆ’1)(n âˆ’1) .
1.7. Prove the following identities. They will become handy at least twice:
when we study partial fractions, and when we discuss ï¬nite Fourier series. For
Ï†, Ïˆ âˆˆR, n âˆˆZ>0, m âˆˆZ,
(a) ei0 = 1,
(b) eiÏ† eiÏˆ = ei(Ï†+Ïˆ),
(c) 1/eiÏ† = eâˆ’iÏ†,
(d) ei(Ï†+2Ï€) = eiÏ†,
(e) e2Ï€i = 1,
(f)
eiÏ† = 1,
(g)
d
dÏ† eiÏ† = i eiÏ†,
(h) Pnâˆ’1
k=0 e2Ï€ikm/n =
 n if n|m,
0 otherwise,
(i) Pnâˆ’1
k=1 k e2Ï€ik/n =
n
e2Ï€i/nâˆ’1.
1.8. Suppose m, n âˆˆZ and n > 0. Find a closed form for Pnâˆ’1
k=0
 k
n
	
e2Ï€ikm/n
(as a function of m and n).
1.9. â™£Suppose m and n are relatively prime integers, and n is positive. Show
that
n
e2Ï€imk/n : 0 â‰¤k < n
o
=
n
e2Ï€ij/n : 0 â‰¤j < n
o
and
n
e2Ï€imk/n : 0 < k < n
o
=
n
e2Ï€ij/n : 0 < j < n
o
.
Conclude that if f is any complex-valued function, then
nâˆ’1
X
k=0
f

e2Ï€imk/n
=
nâˆ’1
X
j=0
f

e2Ï€ij/n

Exercises
19
and
nâˆ’1
X
k=1
f

e2Ï€imk/n
=
nâˆ’1
X
j=1
f

e2Ï€ij/n
.
1.10. Suppose n is a positive integer. If you know what a group is, prove
that the set

e2Ï€ik/n : 0 â‰¤k < n
	
forms a cyclic group of order n (under
multiplication in C).
1.11. Fix n âˆˆZ>0. For an integer m, let (m mod n) denote the least nonneg-
ative integer in G1 := Zn to which m is congruent. Letâ€™s denote by â‹†addition
modulo n, and by â—¦the following composition:
nm1
n
o
â—¦
nm2
n
o
=
m1 + m2
n

,
deï¬ned on the set G2 :=
 m
n
	
: m âˆˆZ
	
. Deï¬ne the following functions:
Ï† ((m mod n)) = e2Ï€im/n,
Ïˆ

e2Ï€im/n
=
nm
n
o
,
Ï‡
nm
n
o
= (m mod n) .
Prove the following:
Ï† ((m1 mod n) â‹†(m2 mod n)) = Ï† ((m1 mod n)) Ï† ((m2 mod n)) ,
Ïˆ

e2Ï€im1/ne2Ï€im2/n
= Ïˆ

e2Ï€im1/n
â—¦Ïˆ

e2Ï€im2/n
,
Ï‡
nm1
n
o
â—¦
nm2
n
o
= Ï‡
nm1
n
o
â‹†Ï‡
nm2
n
o
.
Prove that the three maps deï¬ned above, namely Ï†, Ïˆ, and Ï‡, are one-to-one.
Again, for the reader who is familiar with the notion of a group, let G3 be
the group of nth roots of unity. What we have shown is that the three groups
G1, G2, and G3 are all isomorphic. It is very useful to cycle among these three
isomorphic groups.
1.12. â™£Given integers a, b, c, d, form the line segment in R2 joining the point
(a, b) to (c, d). Show that the number of integer points on this line segment is
gcd(a âˆ’c, b âˆ’d) + 1.
1.13. Give an example of a line with
(a) no lattice point;
(b) one lattice point;
(c) an inï¬nite number of lattice points.
In each case, stateâ€”if appropriateâ€”necessary conditions about the (ir)rationa-
lity of the slope.

20
1 The Coin-Exchange Problem of Frobenius
1.14. Suppose a line y = mx+b passes through the lattice points (p1, q1) and
(p2, q2). Prove that it also passes through the lattice points
 p1 + k(p2 âˆ’p1), q1 + k(q2 âˆ’q1)

, k âˆˆZ .
1.15. Given positive irrational numbers p and q with 1
p + 1
q = 1, show that
Z>0 is the disjoint union of the two integer sequences {âŒŠpnâŒ‹: n âˆˆZ>0} and
{âŒŠqnâŒ‹: n âˆˆZ>0}. This theorem from 1894 is due to Lord Rayleigh and was
rediscovered in 1926 by Sam Beatty. Sequences of the form {âŒŠpnâŒ‹: n âˆˆZ>0}
are often called Beatty sequences.
1.16. Let a, b, c, d âˆˆZ. We say that {(a, b) , (c, d)} is a lattice basis of Z2 if
any lattice point (m, n) âˆˆZ2 can be written as
(m, n) = p (a, b) + q (c, d)
for some p, q âˆˆZ. Prove that if {(a, b) , (c, d)} and {(e, f) , (g, h)} are lattice
bases of Z2 then there exists an integer matrix M with determinant Â±1 such
that
 a b
c d

= M
 e f
g h

.
Conclude that the determinant of
 a b
c d

is Â±1.
1.17. â™£Prove that a triangle with vertices on the integer lattice has no other
interior/boundary lattice points if and only if it has area 1
2. (Hint: You may
begin by â€œdoublingâ€ the triangle to form a parallelogram.)
1.18. Letâ€™s deï¬ne a northeast lattice path as a path through lattice points that
uses only the steps (1, 0) and (0, 1). Let Ln be the line deï¬ned by x + 2y = n.
Prove that the number of northeast lattice paths from the origin to a lattice
point on Ln is the (n + 1)th Fibonacci number fn+1.
1.19. Compute the coeï¬ƒcients of the Taylor series of 1/(1 âˆ’z)2 expanded at
z = 0
(a) by a counting argument,
(b) by diï¬€erentiating the geometric series.
Generalize.
1.20. â™£Prove that if a1, a2, . . . , ad âˆˆZ>0 do not have a common factor then
the Frobenius number g(a1, . . . , ad) is well deï¬ned.
1.21. â™£Compute the partial fraction coeï¬ƒcients (1.6).

Exercises
21
1.22. â™£Prove (1.9): For relatively prime positive integers a and b,
1
a
aâˆ’1
X
k=1
1
(1 âˆ’Î¾bk
a ) Î¾kn
a
= 1
a
aâˆ’1
X
k=1
1
(1 âˆ’Î¾ka) Î¾bâˆ’1kn
a
,
where bâˆ’1b â‰¡1 mod a, and deduce from this (1.10), namely,
1
a
aâˆ’1
X
k=1
1
(1 âˆ’Î¾bk
a ) Î¾kn
a
= âˆ’
bâˆ’1n
a

+ 1
2 âˆ’1
2a .
(Hint: Use Exercise 1.9.)
1.23. Prove that for relatively prime positive integers a and b,
p{a,b}(n + ab) = p{a,b}(n) + 1 .
1.24. â™£Show that if a and b are relatively prime positive integers, then
p{a,b}(a + b) = 1 .
1.25. To extend the Frobenius problem, let us call an integer n k-representable
if pA(n) = k; that is, n can be represented in exactly k ways using the integers
in the set A. Deï¬ne gk = gk(a1, . . . , ad) to be the largest k-representable
integer. Prove:
(a) Let d = 2. For any k âˆˆZâ‰¥0 there is an N such that all integers larger than
N have at least k representations (and hence gk(a, b) is well deï¬ned).
(b) gk(a, b) = (k + 1)ab âˆ’a âˆ’b.
(c) Given k â‰¥2, the smallest k-representable integer is ab(k âˆ’1).
(d) The smallest interval containing all uniquely representable integers is
[min(a, b), g1(a, b)].
(e) Given k â‰¥2, the smallest interval containing all k-representable integers
is [gkâˆ’2(a, b) + a + b, gk(a, b)].
(f) There are exactly ab âˆ’1 integers that are uniquely representable. Given
k â‰¥2, there are exactly ab k-representable integers.
(g) Extend all of this to d â‰¥3 (see open problems).
1.26. Find a formula for p{a}(n).
1.27. Prove the following recursion formula:
p{a1,...,ad}(n) =
X
mâ‰¥0
p{a1,...,adâˆ’1}(n âˆ’mad) .
(Here we use the convention that pA(n) = 0 if n < 0.) Use it in the case d = 2
to give an alternative proof of Theorem 1.2.

22
1 The Coin-Exchange Problem of Frobenius
1.28. Prove the following extension of Theorem 1.5: Suppose gcd(a, b) = d.
Then
p{a,b}(n) =
(
nd
ab âˆ’
n
Î²n
a
o
âˆ’
 Î±n
b
	
+ 1 if d|n,
0
otherwise,
where Î² b
d â‰¡1 mod a
d, and Î± a
d â‰¡1 mod b
d.
1.29. â™£Compute the partial fraction coeï¬ƒcient (1.12).
1.30. Find a formula for p{a,b,c}(n) for the case gcd(a, b, c) Ì¸= 1.
1.31. â™£With A = {a1, a2, . . . , ad} âŠ‚Z>0, let
pâ—¦
A(n) := #

(m1, . . . , md) âˆˆZd : all mj > 0, m1a1 + Â· Â· Â· + mdad = n
	
;
that is, pâ—¦
A(n) counts the number of partitions of n using only the elements
of A as parts, where each part is used at least once. Find formulas for pâ—¦
A for
A = {a} , A = {a, b} , A = {a, b, c} , A = {a, b, c, d}, where a, b, c, d are pairwise
relatively prime positive integers. Observe that in all examples, the counting
functions pA and pâ—¦
A satisfy the algebraic relation
pâ—¦
A(âˆ’n) = (âˆ’1)dâˆ’1pA(n) .
1.32. Prove that pâ—¦
A(n) = pA (n âˆ’a1 âˆ’a2 âˆ’Â· Â· Â· âˆ’ad). (Here, as usual, A =
{a1, a2, . . . , ad}.) Conclude that in the examples of Exercise 1.31 the algebraic
relation
pA(âˆ’t) = (âˆ’1)dâˆ’1 pA (t âˆ’a1 âˆ’a2 âˆ’Â· Â· Â· âˆ’ad)
holds.
1.33. For relatively prime positive integers a, b, let
R := {am + bn : m, n âˆˆZâ‰¥0} ,
the set of all integers representable by a and b. Prove that
X
kâˆˆR
zk =
1 âˆ’zab
(1 âˆ’za) (1 âˆ’zb) .
Use this rational generating function to give alternative proofs of Theorems 1.2
and 1.3.
1.34. For relatively prime positive integers a1, a2, . . . , ad, let
R := {m1a1 + m2a2 + Â· Â· Â· + mdad : m1, m2, . . . , md âˆˆZâ‰¥0} ,
the set of all integers representable by a1, a2, . . . , ad. Prove that
r(z) :=
X
kâˆˆR
zk =
p(z)
(1 âˆ’za1) (1 âˆ’za2) Â· Â· Â· (1 âˆ’zad)
for some polynomial p.

Open Problems
23
1.35. Prove Theorem 1.1: Given any rational function
p(z)
Qm
k=1(zâˆ’ak)ek , where p
is a polynomial of degree less than e1 +e2 +Â· Â· Â·+em and the akâ€™s are distinct,
there exists a decomposition
m
X
k=1
 
ck,1
z âˆ’ak
+
ck,2
(z âˆ’ak)2 + Â· Â· Â· +
ck,ek
(z âˆ’ak)ek
!
,
where the ck,j âˆˆC are unique.
Here is an outline of one possible proof. Recall that the set of polynomials
(over R or C) forms a Euclidean domain, that is, given any two polynomials
a(z), b(z), there exist polynomials q(z), r(z) with deg(r) < deg(b), such that
a(z) = b(z)q(z) + r(z) .
Applying this procedure repeatedly (the Euclidean algorithm) gives the great-
est common divisor of a(z) and b(z) as a linear combination of them, that
is, there exist polynomials c(z) and d(z) such that a(z)c(z) + b(z)d(z) =
gcd (a(z), b(z)).
Step 1: Apply the Euclidean algorithm to show that there exist polynomials
u1, u2 such that
u1(z) (z âˆ’a1)e1 + u2(z) (z âˆ’a2)e2 = 1 .
Step 2: Deduce that there exist polynomials v1, v2 with deg (vk) < ek such
that
p(z)
(z âˆ’a1)e1 (z âˆ’a2)e2 =
v1(z)
(z âˆ’a1)e1 +
v2(z)
(z âˆ’a2)e2 .
(Hint: Long division.)
Step 3: Repeat this procedure to obtain a partial fraction decomposition for
p(z)
(z âˆ’a1)e1 (z âˆ’a2)e2 (z âˆ’a3)e3 .
Open Problems
1.36. Come up with a new approach or a new algorithm for the Frobenius
problem in the d = 4 case.
1.37. There are a very good lower [65] and several upper bounds [153, Chap-
ter 3] for the Frobenius number. Come up with improved upper bounds.
1.38. Solve Vladimir I. Arnoldâ€™s Problems 1999-8 through 1999-11 [7]. To give
a ï¬‚avor, we mention two of the problems explicitly:

24
1 The Coin-Exchange Problem of Frobenius
(a) Explore the statistics of g (a1, a2, . . . , ad) for typical large a1, a2, . . . , ad. It
is conjectured that g (a1, a2, . . . , ad) grows asymptotically like a constant
times
dâˆ’1âˆša1a2 Â· Â· Â· ad.
(b) Determine what fraction of the integers in the interval [0, g (a1, a2, . . . , ad)]
is representable, for typical large a1, a2, . . . , ad. It is conjectured that this
fraction is asymptotically equal to 1
d. (Theorem 1.3 implies that this con-
jecture is true in the case d = 2.)
1.39. Study vector generalizations of the Frobenius problem [155, 164].
1.40. There are several special cases of A = {a1, a2, . . . , ad} for which the
Frobenius problem is solved, for example, arithmetic sequences [153, Chap-
ter 3]. Study these special cases in light of the generating function r(x), deï¬ned
in the Notes and in Exercise 1.34.
1.41. Study the generalized Frobenius number gk (deï¬ned in Exercise 1.25),
e.g., in light of the Moralesâ€“Denham theorem mentioned in the Notes. Derive
formulas for special cases, e.g., arithmetic sequences.
1.42. For which 0 â‰¤n â‰¤b âˆ’1 is sn (a1, a2, . . . , ad; b) = 0?

2
A Gallery of Discrete Volumes
Few things are harder to put up with than a good example.
Mark Twain (1835â€“1910)
A unifying theme of this book is the study of the number of integer points
in polytopes, where the polytopes lives in a real Euclidean space Rd. The
integer points Zd form a lattice in Rd, and we often call the integer points lat-
tice points. This chapter carries us through concrete instances of lattice-point
enumeration in various integral and rational polytopes. There is a tremendous
amount of research taking place along these lines, even as the reader is looking
at these pages.
2.1 The Language of Polytopes
A polytope in dimension 1 is a closed interval; the number of integer points in
 a
b , c
d

is easily seen to be
 c
d

âˆ’
 aâˆ’1
b

(Exercise 2.1). A 2-dimensional convex
polytope is a convex polygon: a compact convex subset of R2 bounded by
a simple, closed curve that is made up of ï¬nitely many line segments.
In general dimension d, a convex polytope is the convex hull of ï¬nitely
many points in Rd. To be precise, given any ï¬nite point set {v1, v2, . . . , vn} âŠ‚
Rd, the polytope P is the smallest convex set containing those points; that is,
P = {Î»1v1 + Î»2v2 + Â· Â· Â· + Î»nvn : all Î»k â‰¥0 and Î»1 + Î»2 + Â· Â· Â· + Î»n = 1} .
This deï¬nition is called the vertex description of P, and we use the notation
P = conv {v1, v2, . . . , vn} ,
the convex hull of v1, v2, . . . , vn. In particular, a polytope is a closed sub-
set of Rd. Many polytopes we will study, however, are not deï¬ned this way,

26
2 A Gallery of Discrete Volumes
but rather as bounded intersections of ï¬nitely many half-spaces and hyper-
planes. One example is the polytope P deï¬ned by (1.4) in Chapter 1. This
hyperplane description of a polytope is, in fact, equivalent to the vertex
description. The fact that every polytope has both a vertex and a hyperplane
description is highly nontrivial, both algorithmically and conceptually. We
carefully work out a proof in Appendix A.
The dimension of a polytope P is the dimension of the aï¬ƒne space
span P := {x + Î»(y âˆ’x) : x, y âˆˆP, Î» âˆˆR}
spanned by P. If P has dimension d, we use the notation dim P = d and call
P a d-polytope. Note that P âŠ‚Rd does not necessarily have dimension d. For
example, the polytope P deï¬ned by (1.4) has dimension d âˆ’1.
Given a convex polytope P âŠ‚Rd, we say that the hyperplane H =

x âˆˆRd : a Â· x = b
	
is a supporting hyperplane of P if P lies entirely on
one side of H, that is, P âŠ‚

x âˆˆRd : a Â· x â‰¤b
	
or P âŠ‚

x âˆˆRd : a Â· x â‰¥b
	
.
A face of P is a set of the form P âˆ©H, where H is a supporting hyperplane
of P. Note that P itself is a face of P, corresponding to the degenerate hyper-
plane Rd,1 and the empty set âˆ…is a face of P, corresponding to a hyperplane
that does not meet P. The (d âˆ’1)-dimensional faces are called facets, the 1-
dimensional faces edges, and the 0-dimensional faces vertices of P. Vertices
are the â€œextreme pointsâ€ of a polytope.
A convex d-polytope has at least d + 1 vertices. A convex d-polytope with
exactly d+1 vertices is called a d-simplex. Every 1-dimensional convex poly-
tope is a 1-simplex, namely, a line segment. The 2-dimensional simplices are
the triangles, the 3-dimensional simplices the tetrahedra.
A convex polytope P is called integral if all of its vertices have inte-
ger coordinates, and P is called rational if all of its vertices have rational
coordinates.
2.2 The Unit Cube
As a warm-up example, we begin with the unit d-cube 2 := [0, 1]d, which
simultaneously oï¬€ers simple geometry and an endless fountain of research
questions. The vertex description of 2 is given by the set of 2d vertices
{(x1, x2, . . . , xd) : all xk = 0 or 1}. The hyperplane description is
2 =

(x1, x2, . . . , xd) âˆˆRd : 0 â‰¤xk â‰¤1 for all k = 1, 2, . . . , d
	
.
Thus, there are the 2d bounding hyperplanes x1 = 0, x1 = 1, x2 = 0, x2 =
1, . . . , xd = 0, xd = 1.
1 In the remainder of the book, we will reserve the term hyperplane for non-
degenerate hyperplanes, i.e., sets of the form

x âˆˆRd : a Â· x = b
	
, where not all
of the entries of a are zero.

2.2 The Unit Cube
27
We now compute the discrete volume of any integer dilate of 2. That is,
we seek the number of integer points t 2âˆ©Zd for all t âˆˆZ>0. Here tP denotes
the dilated polytope
{(tx1, tx2, . . . , txd) : (x1, x2, . . . , xd) âˆˆP} ,
for any polytope P. What is the discrete volume of 2? We dilate by the
positive integer t, as depicted in Figure 2.1, and count:
#
 t 2 âˆ©Zd
= #
 [0, t]d âˆ©Zd
= (t + 1)d.
x1
x2
6
6
Fig. 2.1. The sixth dilate of 2 in dimension 2.
We generally denote the lattice-point enumerator for the tth dilates of
P âŠ‚Rd by
LP(t) := #
 tP âˆ©Zd
,
a useful object that we also call the discrete volume of P. We may also
think of leaving P ï¬xed and shrinking the integer lattice:
LP(t) = #

P âˆ©1
t Zd

.
With this convention, L2(t) = (t + 1)d, a polynomial in the integer variable t.
Notice that the coeï¬ƒcients of this polynomial are the binomial coeï¬ƒcients
 d
k

, deï¬ned through
m
n

:= m(m âˆ’1)(m âˆ’2) Â· Â· Â· (m âˆ’n + 1)
n!
(2.1)
for m âˆˆC, n âˆˆZ>0.

28
2 A Gallery of Discrete Volumes
What about the interior 2â—¦of the cube? The number of interior integer
points in t 2â—¦is
L2â—¦(t) = #
 t 2â—¦âˆ©Zd
= #
 (0, t)d âˆ©Zd
= (t âˆ’1)d.
Notice that this polynomial equals (âˆ’1)dL2(âˆ’t), the evaluation of the poly-
nomial L2(t) at negative integers, up to a sign.
We now introduce another important tool for analyzing any polytope P,
namely the generating function of LP:
EhrP(z) := 1 +
X
tâ‰¥1
LP(t) zt.
This generating function is also called the Ehrhart series of P.
In our case, the Ehrhart series of P = 2 takes on a special form. To
illustrate, we deï¬ne the Eulerian number A (d, k) through
X
jâ‰¥0
jd zj =
Pd
k=0 A (d, k) zk
(1 âˆ’z)d+1
.
(2.2)
It is not hard to prove that the polynomial Pd
k=1 A (d, k) zk is the numerator
of the rational function

z d
dz
d 
1
1 âˆ’z

= z d
dz Â· Â· Â· z d
dz
|
{z
}
d times

1
1 âˆ’z

.
The Eulerian numbers have many fascinating properties, including
A (d, k) = A (d, d + 1 âˆ’k) ,
A (d, k) = (d âˆ’k + 1) A (d âˆ’1, k âˆ’1) + k A (d âˆ’1, k) ,
d
X
k=0
A (d, k) = d! ,
(2.3)
A (d, k) =
k
X
j=0
(âˆ’1)j
d + 1
j

(k âˆ’j)d,
for all 1 â‰¤k â‰¤d. The ï¬rst few Eulerian numbers A (d, k) for 0 â‰¤k â‰¤d are
d = 0: 1
d = 1: 0 1
d = 2: 0 1 1
d = 3: 0 1 4
1
d = 4: 0 1 11 11
1
d = 5: 0 1 26 66
26
1
d = 6: 0 1 57 302 302 57 1 .

2.3 The Standard Simplex
29
(See also [165, Sequence A008292].)
With this deï¬nition, we can now express the Ehrhart series of 2 in terms
of Eulerian numbers:
Ehr2(z) = 1 +
X
tâ‰¥1
(t + 1)d zt =
X
tâ‰¥0
(t + 1)d zt = 1
z
X
tâ‰¥1
td zt
=
Pd
k=1 A (d, k) zkâˆ’1
(1 âˆ’z)d+1
.
To summarize, we have proved the following theorem.
Theorem 2.1. Let 2 be the unit d-cube.
(a) The lattice-point enumerator of 2 is the polynomial
L2(t) = (t + 1)d =
d
X
k=0
d
k

tk.
(b) Its evaluation at negative integers yields the relation
(âˆ’1)dL2(âˆ’t) = L2â—¦(t) .
(c) The Ehrhart series of 2 is Ehr2(z) =
Pd
k=1 A(d,k)zkâˆ’1
(1âˆ’z)d+1
.
âŠ“âŠ”
2.3 The Standard Simplex
The standard simplex âˆ†in dimension d is the convex hull of the d + 1
points e1, e2, . . . , ed and the origin; here ej is the unit vector (0, . . . , 1, . . . , 0),
with a 1 in the jth position. Figure 2.2 shows âˆ†for d = 3. On the other hand,
âˆ†can also be realized by its hyperplane description, namely
âˆ†=

(x1, x2 . . . , xd) âˆˆRd : x1 + x2 + Â· Â· Â· + xd â‰¤1 and all xk â‰¥0
	
.
In the case of the standard simplex, the dilate tâˆ†is now given by
tâˆ†=

(x1, x2, . . . , xd) âˆˆRd : x1 + x2 + Â· Â· Â· + xd â‰¤t and all xk â‰¥0
	
.
To compute the discrete volume of âˆ†, we would like to use the methods devel-
oped in Chapter 1, but thereâ€™s an extra twist. The counting functions in Chap-
ter 1 were deï¬ned by equalities, whereas the standard simplex is deï¬ned by an
inequality. We are trying to count all integer solutions (m1, m2, . . . , md) âˆˆZd
â‰¥0
to
m1 + m2 + Â· Â· Â· + md â‰¤t .
(2.4)
To translate this inequality in d variables into an equality in d + 1 vari-
ables, we introduce a slack variable md+1 âˆˆZâ‰¥0, which picks up the dif-
ference between the right-hand and left-hand sides of (2.4). So the number

30
2 A Gallery of Discrete Volumes
x1
x2
x3
0
1
1
1
Fig. 2.2. The standard simplex âˆ†in dimension 3.
of solutions (m1, m2, . . . , md) âˆˆZd
â‰¥0 to (2.4) equals the number of solutions
(m1, m2, . . . , md+1) âˆˆZd+1
â‰¥0 to
m1 + m2 + Â· Â· Â· + md+1 = t .
Now the methods of Chapter 1 apply:
#
 tâˆ†âˆ©Zd
= const
ï£«
ï£­
ï£«
ï£­X
m1â‰¥0
zm1
ï£¶
ï£¸
ï£«
ï£­X
m2â‰¥0
zm2
ï£¶
ï£¸Â· Â· Â·
ï£«
ï£­X
md+1â‰¥0
zmd+1
ï£¶
ï£¸zâˆ’t
ï£¶
ï£¸
= const

1
(1 âˆ’z)d+1zt

.
(2.5)
In contrast with Chapter 1, we do not require a partial fraction expansion but
simply use the binomial series
1
(1 âˆ’z)d+1 =
X
kâ‰¥0
d + k
d

zk
(2.6)
for d â‰¥0. The constant-term identity (2.5) requires us to ï¬nd the coeï¬ƒcient
of zt in the binomial series (2.6), which is
 d+t
d

. Hence the discrete volume
of âˆ†is given by Lâˆ†(t) =
 d+t
d

, a polynomial in the integer variable t of
degree d. Incidentally, the coeï¬ƒcients of this polynomial function in t have an
alternative life in traditional combinatorics:
Lâˆ†(t) = 1
d!
d
X
k=0
(âˆ’1)dâˆ’k stirl(d + 1, k + 1) tk,

2.4 The Bernoulli Polynomials as Lattice-Point Enumerators of Pyramids
31
where stirl(n, j) is the Stirling number of the ï¬rst kind (see Exercise 2.11). We
also notice that (2.6) is, by deï¬nition, the Ehrhart series of âˆ†.
Let us repeat this computation for the interior âˆ†â—¦of the standard d-
simplex. Now we introduce a slack variable md+1 > 0, so that strict inequality
is forced:
Lâˆ†â—¦(t) = #

(m1, m2, . . . , md) âˆˆZd
>0 : m1 + m2 + Â· Â· Â· + md < t
	
= #

(m1, m2, . . . , md+1) âˆˆZd+1
>0 : m1 + m2 + Â· Â· Â· + md+1 = t
	
.
Now
Lâˆ†â—¦(t) = const
ï£«
ï£­
 X
m1>0
zm1
!  X
m2>0
zm2
!
Â· Â· Â·
ï£«
ï£­X
md+1>0
zmd+1
ï£¶
ï£¸zâˆ’t
ï£¶
ï£¸
= const
 
z
1 âˆ’z
d+1
zâˆ’t
!
= const
ï£«
ï£­zd+1âˆ’t X
kâ‰¥0
d + k
d

zk
ï£¶
ï£¸
=
t âˆ’1
d

.
It is a fun exercise to prove that
(âˆ’1)d
d âˆ’t
d

=
t âˆ’1
d

(2.7)
(see Exercise 2.10). We have arrived at our destination:
Theorem 2.2. Let âˆ†be the standard d-simplex.
(a) The lattice-point enumerator of âˆ†is the polynomial Lâˆ†(t) =
 d+t
d

.
(b) Its evaluation at negative integers yields (âˆ’1)dLâˆ†(âˆ’t) = Lâˆ†â—¦(t).
(c) The Ehrhart series of âˆ†is Ehrâˆ†(z) =
1
(1âˆ’z)d+1 .
âŠ“âŠ”
2.4 The Bernoulli Polynomials as Lattice-Point
Enumerators of Pyramids
There is a fascinating connection between the Bernoulli polynomials and cer-
tain pyramids over unit cubes. The Bernoulli polynomials Bk(x) are de-
ï¬ned through the generating function
z exz
ez âˆ’1 =
X
kâ‰¥0
Bk(x)
k!
zk
(2.8)

32
2 A Gallery of Discrete Volumes
and are ubiquitous in the study of the Riemann zeta function, among other
objects; they are named after Jacob Bernoulli (1654â€“1705).2 The Bernoulli
polynomials will play a prominent role in Chapter 10 in the context of Eulerâ€“
Maclaurin summation. The ï¬rst few Bernoulli polynomials are
B0(x) = 1 ,
B1(x) = x âˆ’1
2 ,
B2(x) = x2 âˆ’x + 1
6 ,
B3(x) = x3 âˆ’3
2x2 + 1
2x ,
B4(x) = x4 âˆ’2x3 + x2 âˆ’1
30 ,
B5(x) = x5 âˆ’5
2x4 + 5
3x3 âˆ’1
6x ,
B6(x) = x6 âˆ’3x5 + 5
2x4 + 1
2x2 + 1
42 ,
B7(x) = x7 âˆ’7
2x6 + 7
2x5 + 7
6x3 + 1
6x .
The Bernoulli numbers are Bk := Bk(0) (see also [165, Sequences A000367
& A002445]) and have the generating function
z
ez âˆ’1 =
X
kâ‰¥0
Bk
k! zk.
Lemma 2.3. For integers d â‰¥1 and n â‰¥2,
nâˆ’1
X
k=0
kdâˆ’1 = 1
d (Bd(n) âˆ’Bd) .
Proof. We play with the generating function of Bd(n)âˆ’Bd
d!
:
X
dâ‰¥0
Bd(n) âˆ’Bd
d!
zd = z enz âˆ’1
ez âˆ’1 = z
nâˆ’1
X
k=0
ekz = z
nâˆ’1
X
k=0
X
jâ‰¥0
(kz)j
j!
=
X
jâ‰¥0
 nâˆ’1
X
k=0
kj
!
zj+1
j!
=
X
jâ‰¥1
 nâˆ’1
X
k=0
kjâˆ’1
!
zj
(j âˆ’1)! .
Now compare coeï¬ƒcients on both sides.
âŠ“âŠ”
2 For more information about Bernoulli, see
http://www-groups.dcs.st-and.ac.uk/âˆ¼history/Biographies/Bernoulli Jacob.html.

2.4 The Bernoulli Polynomials as Lattice-Point Enumerators of Pyramids
33
Consider a (d âˆ’1)-dimensional unit cube embedded into Rd and form
a d-dimensional pyramid by adjoining one more vertex at (0, 0, . . . , 0, 1), as
depicted in Figure 2.3. More precisely, this geometric object has the following
hyperplane description:
P =

(x1, x2, . . . , xd) âˆˆRd : 0 â‰¤x1, x2, . . . , xdâˆ’1 â‰¤1 âˆ’xd â‰¤1
	
.
(2.9)
By deï¬nition, P is contained in the unit d-cube; in fact, its vertices are a
subset of the vertices of the d-cube.
x1
x3
x2
1
1
1
Fig. 2.3. The pyramid P in dimension 3.
We now count lattice points in integer dilates of P. This number equals
#

(m1, m2, . . . , md) âˆˆZd : 0 â‰¤mk â‰¤t âˆ’md â‰¤t for all k = 1, 2, . . . , d âˆ’1
	
.
In this case we just count the solutions to 0 â‰¤mk â‰¤t âˆ’md â‰¤t directly: once
we pick the integer md (between 0 and t), we have t âˆ’md + 1 independent
choices for each of the integers m1, m2, . . . , mdâˆ’1. Hence
LP(t) =
t
X
md=0
(t âˆ’md + 1)dâˆ’1 =
t+1
X
k=1
kdâˆ’1 = 1
d (Bd(t + 2) âˆ’Bd) ,
(2.10)
by Lemma 2.3. This is, naturally, a polynomial in t.
We now turn our attention to the number of interior lattice points in P:
LPâ—¦(t) = #

(m1, m2, . . . , md) âˆˆZd : 0 < mk < t âˆ’md < t
for all k = 1, 2, . . . , d âˆ’1

.

34
2 A Gallery of Discrete Volumes
By a similar counting argument,
LPâ—¦(t) =
tâˆ’1
X
md=1
(t âˆ’md âˆ’1)dâˆ’1 =
tâˆ’2
X
k=0
kdâˆ’1 = 1
d (Bd(t âˆ’1) âˆ’Bd) .
Incidentally, the Bernoulli polynomials are known (Exercise 2.15) to have the
symmetry
Bd(1 âˆ’x) = (âˆ’1)dBd(x) .
(2.11)
This identity coupled with the fact (Exercise 2.16) that
Bd = 0 for all odd d â‰¥3
(2.12)
gives the relation
LP(âˆ’t) = 1
d (Bd(âˆ’t + 2) âˆ’Bd) = 1
d (Bd (1 âˆ’(t âˆ’1)) âˆ’Bd)
= (âˆ’1)d 1
d (Bd(t âˆ’1) âˆ’Bd) = (âˆ’1)d LPâ—¦(t) .
Next we compute the Ehrhart series of P. We can actually do this in
somewhat greater generality. Namely, for a (d âˆ’1)-polytope Q with vertices
v1, v2, . . . , vm, deï¬ne Pyr(Q), the pyramid over Q, as the convex hull of
(v1, 0) , (v2, 0) , . . . , (vm, 0) , (0, . . . , 0, 1). In our example above, the d-polytope
P is equal to Pyr(2) for the unit (dâˆ’1)-cube 2. The number of integer points
in t Pyr(Q) is, by construction,
LPyr(Q)(t) = 1 + LQ(1) + LQ(2) + Â· Â· Â· + LQ(t) = 1 +
t
X
j=1
LQ(j) ,
because in t Pyr(Q), there is one lattice point with xd-coordinate t, LQ(1)
lattice points with xd-coordinate tâˆ’1, LQ(2) lattice points with xd-coordinate
tâˆ’2, etc., up to LQ(t) lattice points with xd = 0. Figure 2.4 shows the instance
t = 3 for a pyramid over a square.
This identity for LPyr(Q)(t) allows us to compute the Ehrhart series of
Pyr(Q) from the Ehrhart series of Q:
Theorem 2.4. EhrPyr(Q)(z) = EhrQ(z)
1 âˆ’z
.
Proof.
EhrPyr(Q)(z) = 1 +
X
tâ‰¥1
LPyr(Q)(t) zt = 1 +
X
tâ‰¥1
ï£«
ï£­1 +
t
X
j=1
LQ(j)
ï£¶
ï£¸zt
=
X
tâ‰¥0
zt +
X
tâ‰¥1
t
X
j=1
LQ(j) zt =
1
1 âˆ’z +
X
jâ‰¥1
LQ(j)
X
tâ‰¥j
zt
=
1
1 âˆ’z +
X
jâ‰¥1
LQ(j) zj
1 âˆ’z =
1 + P
jâ‰¥1 LQ(j) zj
1 âˆ’z
.
âŠ“âŠ”

2.4 The Bernoulli Polynomials as Lattice-Point Enumerators of Pyramids
35
x1
x3
x2
Fig. 2.4. Counting the lattice points in t Pyr(Q).
Our pyramid P that started this section is a pyramid over the unit (dâˆ’1)-
cube, and so
EhrP(z) =
1
1 âˆ’z
Pdâˆ’1
k=1 A (d âˆ’1, k) zkâˆ’1
(1 âˆ’z)d
=
Pdâˆ’1
k=1 A (d âˆ’1, k) zkâˆ’1
(1 âˆ’z)d+1
. (2.13)
Incidentally, this Ehrhart series gives rise to a generating function (diï¬€erent
from (2.8)) for the Bernoulli polynomial Bd (see Exercise 2.22).
Letâ€™s summarize what we have proved for the pyramid over the unit cube.
Theorem 2.5. Let P be the d-pyramid
P =

(x1, x2, . . . , xd) âˆˆRd : 0 â‰¤x1, x2, . . . , xdâˆ’1 â‰¤1 âˆ’xd â‰¤1
	
.
(a) The lattice-point enumerator of P is the polynomial
LP(t) = 1
d (Bd(t + 2) âˆ’Bd) .
(b) Its evaluation at negative integers yields (âˆ’1)dLP(âˆ’t) = LPâ—¦(t).
(c) The Ehrhart series of P is EhrP(z) =
Pdâˆ’1
k=1 A(dâˆ’1,k)zkâˆ’1
(1âˆ’z)d+1
.
âŠ“âŠ”
Patterns are emerging...

36
2 A Gallery of Discrete Volumes
2.5 The Lattice-Point Enumerators
of the Cross-Polytopes
Consider the cross-polytope 3 in Rd given by the hyperplane description
3 :=

(x1, x2, . . . , xd) âˆˆRd : |x1| + |x2| + Â· Â· Â· + |xd| â‰¤1
	
.
(2.14)
Figure 2.5 shows the 3-dimensional instance of 3, an octahedron. The vertices
of 3 are (Â±1, 0, . . . , 0) , (0, Â±1, 0, . . . , 0) , . . . , (0, . . . , 0, Â±1).
x1
x2
x3
Fig. 2.5. The cross-polytope 3 in dimension 3.
To compute the discrete volume of 3, we use a process similar to that of
Section 2.4. Namely, for a (d âˆ’1)-polytope Q with vertices v1, v2, . . . , vm,
deï¬ne BiPyr(Q), the bipyramid over Q, as the convex hull of
(v1, 0) , (v2, 0) , . . . , (vm, 0) , (0, . . . , 0, 1) ,
and (0, . . . , 0, âˆ’1) .
In our example above, the d-dimensional cross-polytope is the bipyramid
over the (d âˆ’1)-dimensional cross-polytope. The number of integer points in
t BiPyr(Q) is, by construction,
LBiPyr(Q)(t) = 2 + 2LQ(1) + 2LQ(2) + Â· Â· Â· + 2LQ(t âˆ’1) + LQ(t)
= 2 + 2
tâˆ’1
X
j=1
LQ(j) + LQ(t) .
This identity allows us to compute the Ehrhart series of BiPyr(Q) from the
Ehrhart series of Q, in a manner similar to the proof of Theorem 2.4. We leave
the proof of the following result as Exercise 2.23.

2.5 The Lattice-Point Enumerators of the Cross-Polytopes
37
Theorem 2.6. If Q contains the origin, then EhrBiPyr(Q)(z) = 1+z
1âˆ’z EhrQ(z).
âŠ“âŠ”
This theorem allows us to compute the Ehrhart series of 3 eï¬€ortlessly:
The cross-polytope 3 in dimension 0 is the origin, with Ehrhart series
1
1âˆ’z.
The higher-dimensional cross-polytopes can be computed recursively through
Theorem 2.6 as
Ehr3(z) =
(1 + z)d
(1 âˆ’z)d+1 .
Since Ehr3(z) = 1 + P
tâ‰¥1 L3(t) zt, we can retrieve L3(t) by expanding
Ehr3(z) into its power series at z = 0:
Ehr3(z) =
(1 + z)d
(1 âˆ’z)d+1 =
Pd
k=0
 d
k

zk
(1 âˆ’z)d+1
=
d
X
k=0
d
k

zk X
tâ‰¥0
t + d
d

zt =
d
X
k=0
d
k
 X
tâ‰¥k
t âˆ’k + d
d

zt
=
d
X
k=0
d
k
 X
tâ‰¥0
t âˆ’k + d
d

zt.
In the last step we used the fact that
 tâˆ’k+d
d

= 0 for 0 â‰¤t < k. But then
1 +
X
tâ‰¥1
L3(t) zt =
X
tâ‰¥0
d
X
k=0
d
k
t âˆ’k + d
d

zt,
and hence L3(t) = Pd
k=0
 d
k
 tâˆ’k+d
d

for all t â‰¥1.
We ï¬nish this section by counting the interior lattice points in t3. We
start by noticing, since t is an integer, that
L3â—¦(t) = #

(m1, m2, . . . , md) âˆˆZd : |m1| + |m2| + Â· Â· Â· + |md| < t
	
= #

(m1, m2, . . . , md) âˆˆZd : |m1| + |m2| + Â· Â· Â· + |md| â‰¤t âˆ’1
	
= L3(t âˆ’1) .
On the other hand, we can use (2.7):
L3(âˆ’t) =
d
X
k=0
d
k
âˆ’t âˆ’k + d
d

=
d
X
k=0
d
k

(âˆ’1)d
t âˆ’1 + k
d

= (âˆ’1)d
d
X
k=0

d
d âˆ’k
t âˆ’1 + d âˆ’k
d

= (âˆ’1)dL3(t âˆ’1) .

38
2 A Gallery of Discrete Volumes
Comparing the last two computations, we see that (âˆ’1)dL3(âˆ’t) = L3â—¦(t).
Let us summarize:
Theorem 2.7. Let 3 be the cross-polytope in Rd.
(a) The lattice-point enumerator of 3 is the polynomial
L3(t) =
d
X
k=0
d
k
t âˆ’k + d
d

.
(b) Its evaluation at negative integers yields (âˆ’1)dL3(âˆ’t) = L3â—¦(t).
(c) The Ehrhart series of P is Ehr3(z) =
(1+z)d
(1âˆ’z)d+1 .
âŠ“âŠ”
2.6 Pickâ€™s Theorem
Going back to basic concepts, we now give a complete account of LP for all
integral convex polygons P in R2. Denote the number of integer points inside
the polygon P by I, and the number of integer points on the boundary of P by
B. The following result, called Pickâ€™s theorem in honor of its discoverer Georg
Alexander Pick (1859â€“1942), presents the astonishing fact that the area A of
P can be computed simply by counting lattice points:
Theorem 2.8 (Pickâ€™s theorem). For an integral convex polygon,
A = I + 1
2B âˆ’1 .
Proof. We start by proving that Pickâ€™s identity has an additive character: we
can decompose P into the union of two integral polygons P1 and P2 by joining
two vertices of P with a line segment, as shown in Figure 2.6.
P1
P2
Fig. 2.6. Decomposition of a polygon into two.
We claim that the validity of Pickâ€™s identity for P follows from the validity
of Pickâ€™s identity for P1 and P2. Denote the area, number of interior lattice

2.6 Pickâ€™s Theorem
39
points, and number of boundary lattice points of Pk by Ak, Ik, and Bk,
respectively, for k = 1, 2. Clearly,
A = A1 + A2 .
Furthermore, if we denote the number of lattice points on the edge common
to P1 and P2 by L, then
I = I1 + I2 + L âˆ’2
and
B = B1 + B2 âˆ’2L + 2 .
Thus
I + 1
2B âˆ’1 = I1 + I2 + L âˆ’2 + 1
2B1 + 1
2B2 âˆ’L + 1 âˆ’1
= I1 + 1
2B1 âˆ’1 + I2 + 1
2B2 âˆ’1 .
This proves the claim. Note that our proof also shows that the validity of
Pickâ€™s identity for P1 follows from the validity of Pickâ€™s identity for P and P2.
Fig. 2.7. Triangulation of a polygon.
Now, any convex polygon can be decomposed into triangles that share a
common vertex, as illustrated in Figure 2.7. Hence it suï¬ƒces to prove Pickâ€™s
theorem for triangles. Further simplifying the picture, we can embed any
integral triangle into an integral rectangle as suggested by Figure 2.8.




J
J
JJ

,
,
,
,
,
,




Fig. 2.8. Embedding a triangle in a rectangle.

40
2 A Gallery of Discrete Volumes
This reduces the proof of Pickâ€™s theorem to proving the theorem for integral
rectangles whose edges are parallel to the coordinate axes, and for rectangular
triangles two of whose edges are parallel to the coordinate axes. These two
cases are left to the reader as Exercise 2.24.
âŠ“âŠ”
Pickâ€™s theorem allows us not only to count the lattice points strictly inside
the polygon P but also the total number of lattice points contained in P,
because this number is
I + B = A âˆ’1
2B + 1 + B = A + 1
2B + 1 .
(2.15)
From this identity, it is now easy to describe the lattice-point enumerator LP:
Theorem 2.9. Suppose P is an integral convex polygon with area A and B
lattice points on its boundary.
(a) The lattice-point enumerator of P is the polynomial
LP(t) = A t2 + 1
2B t + 1 .
(b) Its evaluation at negative integers yields the relation
LP(âˆ’t) = LPâ—¦(t) .
(c) The Ehrhart series of P is
EhrP(z) =
 A âˆ’B
2 + 1

z2 +
 A + B
2 âˆ’2

z + 1
(1 âˆ’z)3
.
Note that in the numerator of the Ehrhart series, the coeï¬ƒcient of z2 is LPâ—¦(1),
and the coeï¬ƒcient of z is LP(1) âˆ’3.
Proof. Statement (a) follows from (2.15) if we can prove that the area of tP
is At2, and the number of boundary points on tP is Bt, which is the content
of Exercise 2.25. Statement (b) follows with LPâ—¦(t) = LP(t)âˆ’Bt. Finally, the
Ehrhart series is
EhrP(z) = 1 +
X
tâ‰¥1
LP(t) zt
=
X
tâ‰¥0

A t2 + B
2 t + 1

zt
= A z2 + z
(1 âˆ’z)3 + B
2
z
(1 âˆ’z)2 +
1
1 âˆ’z
=
 A âˆ’B
2 + 1

z2 +
 A + B
2 âˆ’2

z + 1
(1 âˆ’z)3
.
âŠ“âŠ”

2.7 Polygons with Rational Vertices
41
2.7 Polygons with Rational Vertices
In this section we will establish formulas for the number of integer points in
any rational convex polygon and its integral dilates.
A natural ï¬rst step is to ï¬x a triangulation of the polygon P, which reduces
our problem to that of counting integer points in rational triangles. However,
this procedure merits some remarks. After counting lattice points in the tri-
angles, we need to put those back together to form the polygon. But then we
need to take care of the overcounting on line segments (where the triangles
meet). Computing the number of lattice points on rational line segments is
considerably easier than enumerating lattice points in 2-dimensional regions;
however, it is still nontrivial (see Popoviciuâ€™s Theorem 1.5).
After triangulating P, we can further simplify the picture by embedding an
arbitrary rational triangle in a rational rectangle as in Figure 2.8. To compute
lattice points in a triangle, we can ï¬rst count the points in a rectangle with
edges parallel to the coordinate axes, and then subtract the number of points
in three right triangles, each with two edges are parallel to the axes, and
possibly another rectangle, as shown in Figure 2.8. Since rectangles are easy
to deal with (see Exercise 2.2), the problem reduces to ï¬nding a formula for
a right triangle two of whose edges are parallel to the coordinate axes.
We now adjust and expand our generating-function machinery to these
right triangles. Such a triangle T is a subset of R2 consisting of all points
(x, y) satisfying
x â‰¥a
d , y â‰¥b
d , ex + fy â‰¤r
for some integers a, b, d, e, f, r (with ea+fb â‰¤rd; otherwise, the triangle would
be empty). Because the lattice point count is invariant under horizontal and
vertical integer translations and under ï¬‚ipping about the x- or y-axis, we may
assume that a, b, d, e, f, r â‰¥0 and a, b < d. (One should meditate about this
fact for a minute.) Thus we arrive at the triangle T depicted in Figure 2.9.
To make our life a little easier, letâ€™s assume for the moment that e and f
are relatively prime; we will deal with the general case in the exercises. So let
T =

(x, y) âˆˆR2 : x â‰¥a
d , y â‰¥b
d , ex + fy â‰¤r

.
(2.16)
To derive a formula for
LT (t) = #

(m, n) âˆˆZ2 : m â‰¥ta
d , n â‰¥tb
d , em + fn â‰¤tr

we want to use methods similar to those in Chapter 1. As in Section 2.3, we
introduce a slack variable s:
LT (t) = #

(m, n) âˆˆZ2 : m â‰¥ta
d , n â‰¥tb
d , em + fn â‰¤tr

= #

(m, n, s) âˆˆZ3 : m â‰¥ta
d , n â‰¥tb
d , s â‰¥0, em + fn + s = tr

.

42
2 A Gallery of Discrete Volumes
x
y
r âˆ’fb/d
e
, b
d

a
d, b
d

a
d, r âˆ’ea/d
f

Fig. 2.9. A right rational triangle.
This counting function can now, as earlier, be interpreted as the coeï¬ƒcient of
ztr in the function
ï£«
ï£­X
mâ‰¥ta
d
zem
ï£¶
ï£¸
ï£«
ï£­X
nâ‰¥tb
d
zfn
ï£¶
ï£¸
ï£«
ï£­X
sâ‰¥0
zs
ï£¶
ï£¸.
Here the subscript (e.g., m â‰¥ta
d ) under a summation sign means â€œsum over
all integers satisfying this condition.â€ For example, in the ï¬rst sum we start
with the least integer greater than or equal to ta
d , which is denoted by
 ta
d

(and is equal to
 taâˆ’1
d

+ 1 by Exercise 1.4 (j)). Hence the above generating
function can be rewritten as
ï£«
ï£¬
ï£­
X
mâ‰¥âŒˆta
d âŒ‰
zem
ï£¶
ï£·
ï£¸
ï£«
ï£¬
ï£­
X
nâ‰¥âŒˆtb
d âŒ‰
zfn
ï£¶
ï£·
ï£¸
ï£«
ï£­X
sâ‰¥0
zs
ï£¶
ï£¸= zâŒˆta
d âŒ‰e
1 âˆ’ze
zâŒˆtb
d âŒ‰f
1 âˆ’zf
1
1 âˆ’z
=
zu+v
(1 âˆ’ze) (1 âˆ’zf) (1 âˆ’z) , (2.17)
where we have introduced, for ease of notation,
u :=
ta
d

e
and
v :=
tb
d

f .
(2.18)
To extract the coeï¬ƒcient of ztr of our generating function (2.17), we use
familiar methods. As usual, we shift this coeï¬ƒcient to a constant term:

2.7 Polygons with Rational Vertices
43
LT (t) = const

zu+vâˆ’tr
(1 âˆ’ze) (1 âˆ’zf) (1 âˆ’z)

= const

1
(1 âˆ’ze) (1 âˆ’zf) (1 âˆ’z)ztrâˆ’uâˆ’v

.
Before we apply the partial fraction machinery to this function, we should
make sure that it is indeed a proper rational function, that is, that the total
degree satisï¬es
u + v âˆ’tr âˆ’e âˆ’f âˆ’1 < 0
(2.19)
(see Exercise 2.31). Then we expand into partial fractions (here weâ€™re using
our assumption that e and f do not have any common factors!):
1
(1 âˆ’ze) (1 âˆ’zf) (1 âˆ’z)ztrâˆ’uâˆ’v
=
eâˆ’1
X
j=1
Aj
z âˆ’Î¾j
e
+
fâˆ’1
X
j=1
Bj
z âˆ’Î¾j
f
+
3
X
k=1
Ck
(z âˆ’1)k +
trâˆ’uâˆ’v
X
k=1
Dk
zk .
(2.20)
As numerous times before, the coeï¬ƒcients Dk do not contribute to the con-
stant term, so that we obtain
LT (t) = âˆ’
eâˆ’1
X
j=1
Aj
Î¾j
e
âˆ’
fâˆ’1
X
l=1
Bl
Î¾l
f
âˆ’C1 + C2 âˆ’C3 .
(2.21)
We invite the reader to compute the coeï¬ƒcients appearing in this formula
(Exercise 2.32):
Aj = âˆ’
Î¾j(vâˆ’tr+1)
e
e

1 âˆ’Î¾jf
e

(1 âˆ’Î¾j
e)
,
Bl = âˆ’
Î¾l(uâˆ’tr+1)
f
f

1 âˆ’Î¾le
f

(1 âˆ’Î¾l
f)
,
C1 = âˆ’(u + v âˆ’tr)2
2ef
+ u + v âˆ’tr
2

âˆ’1
ef + 1
e + 1
f

+ 1
4
1
e + 1
f âˆ’1

âˆ’1
12
 e
f + 1
ef + f
e

,
(2.22)
C2 = âˆ’u + v âˆ’tr + 1
ef
+ 1
2e + 1
2f ,
C3 = âˆ’1
ef .
Putting these ingredients into (2.21) yields the following formula for our
lattice-point count.

44
2 A Gallery of Discrete Volumes
Theorem 2.10. For the rectangular rational triangle T given by (2.16), where
e and f are relatively prime,
LT (t) =
1
2ef (tr âˆ’u âˆ’v)2 + 1
2 (tr âˆ’u âˆ’v)
1
e + 1
f + 1
ef

+ 1
4

1 + 1
e + 1
f

+ 1
12
 e
f + f
e + 1
ef

+ 1
e
eâˆ’1
X
j=1
Î¾j(vâˆ’tr)
e

1 âˆ’Î¾jf
e
 
1 âˆ’Î¾j
e
 + 1
f
fâˆ’1
X
l=1
Î¾l(uâˆ’tr)
f

1 âˆ’Î¾le
f
 
1 âˆ’Î¾l
f
 .
âŠ“âŠ”
This identity can be rephrased in terms of the Fourierâ€“Dedekind sum that
we introduced in (1.13):
LT (t) =
1
2ef (tr âˆ’u âˆ’v)2 + 1
2 (tr âˆ’u âˆ’v)
1
e + 1
f + 1
ef

+ 1
4

1 + 1
e + 1
f

+ 1
12
 e
f + f
e + 1
ef

+ svâˆ’tr(f, 1; e) + suâˆ’tr(e, 1; f) .
The general formula for LT â€”not assuming that e and f are relatively
primeâ€”is the content of Exercise 2.34.
Let us pause for a moment and study the nature of LT as a function
of t. Aside from the last two ï¬nite sums (which will be put in the spotlight
in Chapter 8) and the appearance of u and v, LT is a quadratic polynomial
in t. And in those two sums, t appears only in the exponent of roots of unity,
namely as the exponent of Î¾e and Î¾f. As a function of t, Î¾t
e is periodic with
period e, and similarly Î¾t
f is periodic with period f. We should also remember
that u and v are functions of t; but they can be easily written in terms of
the fractional-part function, which again gives rise to periodic functions in t.
So LT (t) is a (quadratic) â€œpolynomialâ€ in t, whose coeï¬ƒcients are periodic
functions in t. This is reminiscent of the counting functions of Chapter 1, which
showed a similar periodic-polynomial behavior. Inspired by both examples, we
deï¬ne a quasipolynomial Q as an expression of the form Q(t) = cn(t) tn +
Â· Â· Â· + c1(t) t + c0(t), where c0, . . . , cn are periodic functions in t. The degree
of Q is n,3 and the least common period of c0, . . . , cn is the period of Q.
Alternatively, for a quasipolynomial Q, there exist a positive integer k and
polynomials p0, p1, . . . , pkâˆ’1 such that
Q(t) =
ï£±
ï£´
ï£´
ï£´
ï£´
ï£²
ï£´
ï£´
ï£´
ï£´
ï£³
Q(t) = p0(t)
if t â‰¡0 mod k,
Q(t) = p1(t)
if t â‰¡1 mod k,
...
Q(t) = pkâˆ’1(t)
if t â‰¡k âˆ’1 mod k.
3 Here we tacitly assume that cn is not the zero function.

2.8 Eulerâ€™s Generating Function for General Rational Polytopes
45
The minimal such k is the period of Q, and for this minimal k, the polynomials
p0, p1, . . . , pkâˆ’1 are the constituents of Q.
By the triangulation and embedding-in-a-box arguments that started this
section, we can now state a general structural result for rational polygons.
Theorem 2.11. Let P be any rational polygon. Then LP(t) is a quasipolyno-
mial of degree 2. Its leading coeï¬ƒcient is the area of P (in particular, it is a
constant).
We have the technology at this point to also study the period of LP ; we
let the reader enjoy the ensuing details (see Exercise 2.35).
Proof. By Exercises 2.2 and 2.34 (the general form of Theorem 2.10), the the-
orem holds for rational rectangles and right triangles whose edges are parallel
to the axes. Now use the additivity of both degree-2 quasipolynomials and
areas, and Popoviciuâ€™s theorem (Theorem 1.5).
âŠ“âŠ”
2.8 Eulerâ€™s Generating Function for General Rational
Polytopes
By now we have computed several instances of counting functions by set-
ting up a generating function that ï¬ts the particular problem weâ€™re interested
in. In this section, we set up such a generating function for the lattice-point
enumerator of any rational polytope. Such a polytope is given by its hyper-
plane description as an intersection of half-spaces and hyperplanes. The half-
spaces are algebraically given by linear inequalities, the hyperplanes by linear
equations. If the polytope is rational, we can choose the coeï¬ƒcients of these
inequalities and equations to be integers (Exercise 2.7). To unify both de-
scriptions, we can introduce slack variables to turn the half-space inequalities
into equalities. Furthermore, by translating our polytope into the nonnegative
orthant (we can always shift a polytope by an integer vector without changing
the lattice-point count), we may assume that all points in the polytope have
nonnegative coordinates. In summary, after a harmless integer translation, we
can describe any rational polytope P as
P =

x âˆˆRd
â‰¥0 : A x = b
	
(2.23)
for some integral matrix A âˆˆZmÃ—d and some integer vector b âˆˆZm. (Note
that d is not necessarily the dimension of P.) To describe the tth dilate of P,
we simply scale a point x âˆˆP by 1
t , or alternatively, multiply b by t:
tP =
n
x âˆˆRd
â‰¥0 : A x
t = b
o
=

x âˆˆRd
â‰¥0 : A x = tb
	
.
Hence the lattice-point enumerator of P is the counting function
LP(t) = #

x âˆˆZd
â‰¥0 : A x = tb
	
.
(2.24)

46
2 A Gallery of Discrete Volumes
Example 2.12. Suppose P is the quadrilateral with vertices (0, 0), (2, 0),
(1, 1), and
 0, 3
2

:
@
@
@
@
@
@
@
@
@
@
@
@
HHHHHHHHHHHHHHHHH
t
 0, 3
2

t
(2, 0)
t(1, 1)
t
(0, 0)
The half-space-inequality description of P is
P =

(x1, x2) âˆˆR2 : x1, x2 â‰¥0, x1 + 2x2 â‰¤3,
x1 + x2 â‰¤2

.
Thus,
LP(t) = #

(x1, x2) âˆˆZ2 : x1, x2 â‰¥0, x1 + 2x2 â‰¤3t,
x1 + x2 â‰¤2t

= #

(x1, x2, x3, x4) âˆˆZ4 : x1, x2, x3, x4 â‰¥0, x1 + 2x2 + x3 = 3t,
x1 + x2 + x4 = 2t

= #

x âˆˆZ4
â‰¥0 :

1 2 1 0
1 1 0 1

x =

3t
2t

.
Using the ideas from Sections 1.3, 1.5, 2.3, and 2.7, we now construct a gen-
erating function for this counting function. In these previous sections, the
lattice-point enumerator could be described with only one nontrivial linear
equation, whereas now we have a system of such linear constraints. However,
we can use the same approach of encoding the linear equation into geometric
series; we just need more than one variable. When we expand the function
f (z1, z2) :=
1
(1 âˆ’z1z2) (1 âˆ’z2
1z2) (1 âˆ’z1) (1 âˆ’z2) z3t
1 z2t
2
into geometric series, we have
f (z1, z2) =
 X
n1â‰¥0
(z1z2)n1
! X
n2â‰¥0
 z2
1z2
n2
! X
n3â‰¥0
zn3
1
! X
n4â‰¥0
zn4
2
!
1
z3t
1 z2t
2
=
X
n1,...,n4â‰¥0
zn1+2n2+n3âˆ’3t
1
zn1+n2+n4âˆ’2t
2
.
When we compute the constant term (in both z1 and z2), we are counting
solutions (n1, n2, n3, n4) âˆˆZ4
â‰¥0 to

2.8 Eulerâ€™s Generating Function for General Rational Polytopes
47
 1 2 1 0
1 1 0 1

ï£«
ï£¬
ï£¬
ï£­
n1
n2
n3
n4
ï£¶
ï£·
ï£·
ï£¸=
 3t
2t

,
that is, the constant term of f (z1, z2) counts the integer points in P:
LP(t) = const
1
(1 âˆ’z1z2) (1 âˆ’z2
1z2) (1 âˆ’z1) (1 âˆ’z2) z3t
1 z2t
2
.
We invite the reader to actually compute this constant term (Exercise 2.36).
It turns out to be
7
4 t2 + 5
2 t + 7 + (âˆ’1)t
8
.
âŠ“âŠ”
Returning to the general case of a polytope P given by (2.23), we denote
the columns of A by c1, c2, . . . , cd. Let z = (z1, z2, . . . , zm) and expand the
function
1
(1 âˆ’zc1) (1 âˆ’zc2) Â· Â· Â· (1 âˆ’zcd) ztb
(2.25)
in terms of geometric series:
ï£«
ï£­X
n1â‰¥0
zn1c1
ï£¶
ï£¸
ï£«
ï£­X
n2â‰¥0
zn2c2
ï£¶
ï£¸Â· Â· Â·
ï£«
ï£­X
ndâ‰¥0
zndcd
ï£¶
ï£¸1
ztb .
Here we use the abbreviating notation zc := zc1
1 zc2
2 Â· Â· Â· zcm
m
for the vectors
z = (z1, z2, . . . , zm) âˆˆCm and c = (c1, c2, . . . , cm) âˆˆZm. When multiplying
out everything, a typical term will look like
n1c1 + n2c2 + Â· Â· Â· + ndcd âˆ’tb = An âˆ’tb ,
where n = (n1, n2, . . . , nd) âˆˆZd
â‰¥0. That is, if we take the constant term of our
generating function (2.25), weâ€™re counting integer vectors n âˆˆZd
â‰¥0 satisfying
An âˆ’tb = 0 ,
that is,
An = tb .
So this constant term will pick up exactly the number of lattice points n âˆˆZd
â‰¥0
in tP:
Theorem 2.13 (Eulerâ€™s generating function). Suppose the rational poly-
tope P is given by (2.23). Then the Ehrhart quasipolynomial of P can be
computed as follows:
LP(t) = const

1
(1 âˆ’zc1) (1 âˆ’zc2) Â· Â· Â· (1 âˆ’zcd) ztb

.
âŠ“âŠ”
We ï¬nish this section with rephrasing this constant-term identity in terms
of Ehrhart series.

48
2 A Gallery of Discrete Volumes
Corollary 2.14. Suppose the rational polytope P is given by (2.23). Then the
Ehrhart series of P can be computed as
EhrP(x) = const
 
1
(1 âˆ’zc1) (1 âˆ’zc2) Â· Â· Â· (1 âˆ’zcd)
 1 âˆ’x
zb

!
.
Proof. By Theorem 2.13,
EhrP(x) =
X
tâ‰¥0
const

1
(1 âˆ’zc1) (1 âˆ’zc2) Â· Â· Â· (1 âˆ’zcd) ztb

xt
= const
ï£«
ï£­
1
(1 âˆ’zc1) (1 âˆ’zc2) Â· Â· Â· (1 âˆ’zcd)
X
tâ‰¥0
xt
ztb
ï£¶
ï£¸
= const

1
(1 âˆ’zc1) (1 âˆ’zc2) Â· Â· Â· (1 âˆ’zcd)
1
1 âˆ’x
zb

.
âŠ“âŠ”
Notes
1. Convex polytopes are beautiful objects with a rich history and interest-
ing theory, which we have only glimpsed here. For a good introduction to
polytopes, we recommend [47, 90, 193]. Polytopes appear in a vast range
of current research areas, including GrÂ¨obner bases and commutative algebra
[174], combinatorial optimization [159], integral geometry [110], and geometry
of numbers [163].
2. The distinction between the vertex and hyperplane description of a convex
polytope leads to an interesting algorithmic question; namely, how quickly can
we retrieve the ï¬rst piece of data from the second and vice versa [159, 193]?
3. Ehrhart series are named after Eug`ene Ehrhart (1906â€“2000),4 in antici-
pation of the theorems we will prove in Chapter 3. The Ehrhart series of a
polytope belonging to the special class of normal polytopes equals another
rational generating function, the Hilbertâ€“PoincarÂ´e series. These series appear
in the study of graded algebras (see, for example, [96, 171]). Ehrhart series also
appear in the context of toric varieties, a vast and fruitful subject [64, 84].
4. The Eulerian numbers A (d, k) are named after Leonhard Euler (1707â€“
1783)5 and arise naturally in the statistics of permutations: A (d, k) counts
permutations of {1, 2, . . . , d} with k âˆ’1 ascents. For more on A (d, k), see [62,
Section 6.5].
4 For more information about Ehrhart, see
http://icps.u-strasbg.fr/âˆ¼clauss/Ehrhart.html.
5 For more information about Euler, see
http://www-groups.dcs.st-and.ac.uk/âˆ¼history/Biographies/Euler.html.

Notes
49
5. The pyramids of Section 2.4 have an interpretation as order polytopes [172].
A curious fact about the lattice-point enumerators of these pyramids is that
they have arbitrarily large real roots as the dimension grows [24].
6. The counting function L3 for the cross-polytope can, incidentally, also be
written as
min(d,t)
X
k=0
2k
d
k
t
k

.
In particular, L3 is symmetric in d and t. The cross-polytope counting func-
tions bear a connection to Laguerre polynomials, the d-dimensional harmonic
oscillator, and the Riemann hypothesis. This connection appeared in [51],
where Daniel Bump, Kwok-Kwong Choi, PÂ¨ar Kurlberg, and Jeï¬€rey Vaaler
also found a curious fact about the roots of the polynomials L3: they all have
real part âˆ’1
2 (an instance of a local Riemann hypothesis). This fact was proved
independently by Peter Kirschenhofer, Attila PethËo, and Robert Tichy [109];
see also the Notes in Chapter 4.
7. Theorem 2.8 marks the beginning of the general study of lattice-point
enumeration in polytopes. Its amazingly simple statement was discovered by
Georg Alexander Pick (1859â€“1942)6 in 1899 [143]. Pickâ€™s theorem holds also
for a nonconvex polygon, provided its boundary forms a simple curve. In Chap-
ter 12, we prove a generalization of Pickâ€™s theorem that includes nonconvex
curves.
8. The results of Section 2.7 appeared in [29]. We will see in Chapter 8 that
the ï¬nite sums over roots of unity can be rephrased in terms of Dedekindâ€“
Rademacher sums, whichâ€”as we will see in Chapter 8â€”can be computed very
quickly. The theorems of Section 2.7 will then imply that the discrete volume
of any rational polygon can be computed eï¬ƒciently.
9. If we replace tb in (2.24) by a variable integer vector v, the counting
function
f(v) = #

x âˆˆZd
â‰¥0 : A x = v
	
is called a vector partition function: it counts partitions of the vector v in terms
of the columns of A. Vector partition functions are the multivariate analogues
of our lattice-point enumerators LP(t), have many interesting properties, and
give rise to intriguing open questions [20, 40, 63, 173, 178].
10. While Leonhard Euler most likely did not think of lattice-point enumer-
ation in the sense of Ehrhart, we attribute Theorem 2.13 to him, since he
certainly worked with generating functions of this type, probably thinking of
6 For more information about Pick, see
http://www-groups.dcs.st-and.ac.uk/âˆ¼history/Biographies/Pick.html.

50
2 A Gallery of Discrete Volumes
them as vector partition functions. The potential of Eulerâ€™s generating func-
tion for Ehrhart polynomials was already realized by Ehrhart [79, 81]. Several
modern approaches to computing Ehrhart polynomials are based on Theo-
rem 2.13 (see, for example, [19, 46, 119]).
Exercises
2.1. â™£Fix positive integers a, b, c, d such that a/b < c/d, and let P be the
interval
 a
b , c
d

(so P is a 1-dimensional rational convex polytope). Compute
LP(t) = # (tP âˆ©Z) and LPâ—¦(t) and show directly that LP(t) and LPâ—¦(t) are
quasipolynomials with period lcm(b, d) that satisfy
LPâ—¦(âˆ’t) = âˆ’LP(t) .
(Hint: Exercise 1.4 (i).)
2.2. â™£Fix positive rational numbers a1, b1, a2, b2 and let R be the rectan-
gle with vertices (a1, b1), (a2, b1), (a2, b2), and (a1, b2). Compute LR(t) and
EhrR(z).
2.3. Fix positive integers a and b, and let T be a triangle with vertices (0, 0),
(a, 0), and (0, b).
(a) Compute LT (t) and EhrT (z).
(b) Use (a) to derive the following formula for the greatest common divisor of
a and b:
gcd(a, b) = 2
bâˆ’1
X
k=1
ka
b

+ a + b âˆ’ab .
(Hint: Exercise 1.12.)
2.4. Prove that for two polytopes P âŠ‚Rm and Q âŠ‚Rn,
#
 (P Ã— Q) âˆ©Zm+n
= # (P âˆ©Zm) Â· # (Q âˆ©Zn) .
Hence, LPÃ—Q(t) = LP(t) LQ(t).
2.5. Prove that if F is a face of P and G is a face of F, then G is also a face
of P. (That is, the face relation is transitive.)
2.6. â™£Suppose âˆ†is a d-simplex with vertices V = {v1, v2, . . . , vd+1}. Prove
that for any nonempty subset W âŠ†V , conv W is a face of âˆ†, and conversely,
that any face of âˆ†is of the form conv W for some W âŠ†V . Conclude the
following corollaries from this characterization of the faces of a simplex:
(a) A face of any simplex is again a simplex.
(b) The intersection of two faces of a simplex âˆ†is again a face of âˆ†.

Exercises
51
2.7. â™£Prove that a rational convex polytope can be described by a system
of linear inequalities and equations with integral coeï¬ƒcients.
2.8. â™£Prove the properties (2.3) of the Eulerian numbers for all integers
1 â‰¤k â‰¤d, namely:
(a) A (d, k) = A (d, d + 1 âˆ’k) ;
(b) A (d, k) = (d âˆ’k + 1)A (d âˆ’1, k âˆ’1) + kA (d âˆ’1, k) ;
(c)
d
X
k=0
A (d, k) = d! ;
(d) A (d, k) =
k
X
j=0
(âˆ’1)j
d + 1
j

(k âˆ’j)d.
2.9. â™£Prove (2.6); namely, for d â‰¥0,
1
(1âˆ’z)d+1 = P
kâ‰¥0
 d+k
d

zk.
2.10. â™£Prove (2.7): For t, k âˆˆZ and d âˆˆZ>0,
(âˆ’1)d
âˆ’t + k
d

=
t + d âˆ’1 âˆ’k
d

.
2.11. The Stirling numbers of the ï¬rst kind, stirl(n, m), are deï¬ned through
the ï¬nite generating function
x(x âˆ’1) Â· Â· Â· (x âˆ’n + 1) =
n
X
m=0
stirl(n, m) xm.
(See also [165, Sequence A008275].) Prove that
1
d!
d
X
k=0
(âˆ’1)dâˆ’k stirl(d + 1, k + 1) tk =
d + t
d

,
the lattice-point enumerator for the standard d-simplex.
2.12. Give a direct proof that the number of solutions (m1, m2, . . . , md+1) âˆˆ
Zd+1
â‰¥0 to m1 +m2 +Â· Â· Â·+md+1 = t equals
 d+t
d

. (Hint: think of t objects lined
up and separated by d walls.)
2.13. Compute LP(t), where P is the regular tetrahedron with vertices
(0, 0, 0) , (1, 1, 0) , (1, 0, 1) , (0, 1, 1).
2.14. â™£Prove that the power series
X
kâ‰¥0
Bk
k! zk
that deï¬nes the Bernoulli numbers has radius of convergence 2Ï€.

52
2 A Gallery of Discrete Volumes
2.15. â™£Prove (2.11); namely, Bd(1 âˆ’x) = (âˆ’1)dBd(x).
2.16. â™£Prove (2.12); namely, Bd = 0 for all odd d â‰¥3.
2.17. Show that for each positive integer n,
n xnâˆ’1 =
n
X
k=1
n
k

Bnâˆ’k(x) .
This gives us a change of basis for the polynomials of degree â‰¤n, allowing us
to represent any polynomial as a sum of Bernoulli polynomials.
2.18. As a complement to the previous exercise, show that we also have a
change of basis in the other direction. Namely, we can represent a single
Bernoulli polynomial in terms of the monomials as follows:
Bn(x) =
n
X
k=0
n
k

Bk xnâˆ’k.
2.19. Show that for all positive integers m, n, and any x âˆˆR,
1
m
mâˆ’1
X
k=0
Bn

x + k
m

= mâˆ’nBn(mx) .
(This is a Hecke-operator-type identity, originally found by Joseph Ludwig
Raabe in 1851.)
2.20. Show that Bn(x + 1) âˆ’Bn(x) = n xnâˆ’1.
2.21. An alternative way to deï¬ne the Bernoulli polynomials is to give ele-
mentary properties that uniquely characterize them. Show that the following
three properties uniquely determine the Bernoulli polynomials, as deï¬ned in
the text by (2.8):
(a) B0(x) = 1.
(b) dBn(x)
dx
= n Bnâˆ’1(x), for all n â‰¥1.
(c)
R 1
0 Bn(x) dx = 0, for all n â‰¥1.
2.22. Prove that for d = 1,
X
tâ‰¥0
B1(t) zt =
3z âˆ’1
2(1 âˆ’z)2 ,
and for d â‰¥2,
X
tâ‰¥0
Bd(t) zt = d Pdâˆ’1
k=1 A (d âˆ’1, k) zk+1
(1 âˆ’z)d+1
+
Bd
1 âˆ’z .

Exercises
53
2.23. â™£Prove Theorem 2.6: EhrBiPyr(Q)(z) = 1+z
1âˆ’z EhrQ(z).
2.24. â™£Let R be an integral rectangle whose edges are parallel to the coordi-
nate axes, and let T be a rectangular triangle two of whose edges are parallel
to the coordinate axes. Show that Pickâ€™s theorem holds for R and T .
2.25. â™£Suppose P is an integral polygon with area A and B lattice points on
its boundary. Show that the area of tP is At2, and the number of boundary
points on tP is Bt. (Hint: Exercise 1.12.)
2.26. Let P be the self-intersecting polygon deï¬ned by the line segments
[(0, 0), (4, 2)], [(4, 2), (4, 0)], [(4, 0), (0, 2)], and [(0, 2), (0, 0)]. Show that Pickâ€™s
theorem does not hold for P.
2.27. Suppose that P and Q are integral polygons, and that Q lies entirely
inside P. Then the area bounded by the boundaries of P and Q, denoted
by P âˆ’Q, is a â€œdoubly connected polygon.â€ Find and prove the analogue of
Pickâ€™s theorem for P âˆ’Q. Generalize your formula to a polygon with n â€œholesâ€
(instead of one).
2.28. Consider the rhombus
R = {(x, y) : a|x| + b|y| â‰¤ab} ,
where a and b are ï¬xed positive integers. Find a formula for LR(t).
2.29. We deï¬ne the nth Farey sequence as all the rational numbers a
b in the
interval [0, 1] when a and b are coprime and b â‰¤n. For instance, the sixth
Farey sequence is 0
1, 1
6, 1
5, 1
4, 1
3, 2
5, 1
2, 3
5, 2
3, 3
4, 4
5, 5
6, 1
1.
(a) For two consecutive fractions
a
b and
c
d in a Farey sequence, prove that
bc âˆ’ad = 1.
(b) For three consecutive fractions a
b , c
d, and e
f in a Farey sequence, show that
c
d = a+e
b+f .
2.30. Let âŒˆxâŒ‰denote the smallest integer larger than or equal to x. Prove that
for all positive integers a and b,
a + (âˆ’1)b
a
X
m=0
(âˆ’1)âŒˆbm
a âŒ‰â‰¡b + (âˆ’1)a
b
X
n=0
(âˆ’1)âŒˆan
b âŒ‰mod 4 .
(Hint: This is a variation of Exercise 1.6. One way to obtain this identity is by
counting lattice points in a certain triangle, keeping track only of the parity.)
2.31. â™£Verify (2.19).
2.32. â™£Compute the partial fraction coeï¬ƒcients (2.22).

54
2 A Gallery of Discrete Volumes
2.33. Let a, b be positive integers. Show that
1
1 âˆ’zab = âˆ’Î¾k
a
ab
 z âˆ’Î¾k
a
âˆ’1+ab âˆ’1
2ab + terms with positive powers of
 z âˆ’Î¾k
a

.
2.34. â™£Let T be given by (2.16), and let c = gcd(e, f). Prove that
LT (t) =
1
2ef (tr âˆ’u âˆ’v)2 + 1
2 (tr âˆ’u âˆ’v)
1
e + 1
f + 1
ef

+ 1
4

1 + 1
e + 1
f

+ 1
12
 e
f + f
e + 1
ef

+
 1
2e + 1
2f âˆ’u + v âˆ’tr
ef
 câˆ’1
X
k=1
Î¾âˆ’ktr
c
1 âˆ’Î¾kc
âˆ’1
ef
câˆ’1
X
k=1
Î¾k(âˆ’tr+1)
c
(1 âˆ’Î¾c)2
+ 1
e
eâˆ’1
X
j=1
e
c Ì¸ | j
Î¾j(vâˆ’tr)
e

1 âˆ’Î¾jf
e
 
1 âˆ’Î¾j
e
 + 1
f
fâˆ’1
X
l=1
f
c Ì¸ | l
Î¾l(uâˆ’tr)
f

1 âˆ’Î¾le
f
 
1 âˆ’Î¾l
f
 .
2.35. Let P be a rational polygon, and let d be the least common multiple
of the denominators of the vertices of P. Prove directly (using Exercise 2.34)
that the period of LP divides d.
2.36. â™£Finish the calculation in Example 2.12, that is, compute
const
1
(1 âˆ’z1z2) (1 âˆ’z2
1z2) (1 âˆ’z1) (1 âˆ’z2) z3t
1 z2t
2
.
2.37. Compute the vector partition function of the quadrilateral given in Ex-
ample 2.12, that is, compute the counting function
f (v1, v2) := #

x âˆˆZ4
â‰¥0 :
 1 2 1 0
1 1 0 1

x =
 v1
v2

for v1, v2 âˆˆZ. (This function depends on the relationship between v1 and v2.)
2.38. Search on the Internet for the program polymake [86]. You can download
it for free. Experiment.
Open Problems
2.39. Pick d + 1 of the 2d vertices of the unit d-cube 2, and let âˆ†be the
simplex deï¬ned by their convex hull.
(a) Which choice of vertices maximizes vol âˆ†?
(b) What is the maximum volume of such a âˆ†?

Open Problems
55
2.40. Find classes of integer d-polytopes (Pd)dâ‰¥1 for which LPd(t) is symmet-
ric in d and t. (The standard simplices âˆ†and the cross-polytopes 3 form two
such classes.)
2.41. We mentioned already in the Notes that all the roots of the polynomials
L3 have real part âˆ’1
2 [51, 109]. Find other classes of polytopes whose lattice-
point enumerator exhibits such a special behavior.


3
Counting Lattice Points in Polytopes:
The Ehrhart Theory
Ubi materia, ibi geometria.
Johannes Kepler (1571â€“1630)
Given the profusion of examples that gave rise to the polynomial behavior of
the integer-point counting function LP(t) for special polytopes P, we now ask
whether there is a general structure theorem. As the ideas unfold, the reader
is invited to look back at Chapters 1 and 2 as appetizers and indeed as special
cases of the theorems developed below.
3.1 Triangulations and Pointed Cones
Because most of the proofs that follow work like a charm for a simplex, we ï¬rst
dissect a polytope into simplices. This dissection is captured by the following
deï¬nition.
A triangulation of a convex d-polytope P is a ï¬nite collection T of d-
simplices with the following properties:
â€¢
P =
[
âˆ†âˆˆT
âˆ†.
â€¢
For any âˆ†1, âˆ†2 âˆˆT, âˆ†1 âˆ©âˆ†2 is a face common to both âˆ†1 and âˆ†2.
We say that P can be triangulated using no new vertices if there exists
a triangulation T such that the vertices of any âˆ†âˆˆT are vertices of P.
Theorem 3.1 (Existence of triangulations). Every convex polytope can
be triangulated using no new vertices.
This theorem seems intuitively obvious but is not entirely trivial to prove.
We carefully work out a proof in Appendix B.

58
3 Counting Lattice Points in Polytopes: The Ehrhart Theory
Fig. 3.1. Two (very diï¬€erent) triangulations of the 3-cube.
A pointed cone K âŠ†Rd is a set of the form
K = {v + Î»1w1 + Î»2w2 + Â· Â· Â· + Î»mwm : Î»1, Î»2, . . . , Î»m â‰¥0} ,
where v, w1, w2, . . . , wm âˆˆRd are such that there exists a hyperplane H for
which H âˆ©K = {v}; that is, K \ {v} lies strictly on one side of H. The
vector v is called the apex of K, and the wkâ€™s are the generators of K.
The cone is rational if v, w1, w2, . . . , wm âˆˆQd, in which case we may choose
w1, w2, . . . , wm âˆˆZd by clearing denominators. The dimension of K is the
dimension of the aï¬ƒne space spanned by K; if K is of dimension d, we call it a
d-cone. The d-cone K is simplicial if K has precisely d linearly independent
generators.
Just as polytopes have a description as an intersection of half-spaces, so
do pointed cones: A rational pointed d-cone is the d-dimensional intersection
of ï¬nitely many half-spaces of the form

x âˆˆRd : a1x1 + a2x2 + Â· Â· Â· + adxd â‰¤b
	
with integral parameters a1, a2, . . . , ad, b âˆˆZ such that the corresponding
hyperplanes of the form

x âˆˆRd : a1x1 + a2x2 + Â· Â· Â· + adxd = b
	
meet in exactly one point.
Cones are important for many reasons. The most practical for us is a
process called coning over a polytope. Given a convex polytope P âŠ‚Rd with
vertices v1, v2, . . . , vn, we lift these vertices into Rd+1 by adding a 1 as their
last coordinate. So, let
w1 = (v1, 1) , w2 = (v2, 1) , . . . , wn = (vn, 1) .
Now we deï¬ne the cone over P as
cone(P) = {Î»1w1 + Î»2w2 + Â· Â· Â· + Î»nwn : Î»1, Î»2, . . . , Î»n â‰¥0} âŠ‚Rd+1.
This pointed cone has the origin as apex, and we can recover our original
polytope P (strictly speaking, the translated set {(x, 1) : x âˆˆP}) by cutting
cone(P) with the hyperplane xd+1 = 1, as shown in Figure 3.2.

3.1 Triangulations and Pointed Cones
59
x3
x1
x2
Fig. 3.2. Coning over a polytope.
By analogy with the language of polytopes, we say that the hyperplane
H = {x âˆˆRd : aÂ·x = b} is a supporting hyperplane of the pointed d-cone
K if K lies entirely on one side of H, that is,
K âŠ‚

x âˆˆRd : a Â· x â‰¤b
	
or
K âŠ‚

x âˆˆRd : a Â· x â‰¥b
	
.
A face of K is a set of the form K âˆ©H, where H is a supporting hyperplane
of K. The (d âˆ’1)-dimensional faces are called facets and the 1-dimensional
faces edges of K. The apex of K is its unique 0-dimensional face.
Just as polytopes can be triangulated into simplices, pointed cones can be
triangulated into simplicial cones. So, a collection T of simplicial d-cones is a
triangulation of the d-cone K if it satisï¬es:
â€¢
K =
[
SâˆˆT
S .
â€¢
For any S1, S2 âˆˆT, S1 âˆ©S2 is a face common to both S1 and S2.

60
3 Counting Lattice Points in Polytopes: The Ehrhart Theory
We say that K can be triangulated using no new generators if there
exists a triangulation T such that the generators of any S âˆˆT are generators
of P.
Theorem 3.2. Any pointed cone can be triangulated into simplicial cones us-
ing no new generators.
Proof. This theorem is really a corollary to Theorem 3.1. Given a pointed d-
cone K, there exists a hyperplane H that intersects K only at the apex. Now
translate H â€œintoâ€ the cone, so that Hâˆ©K consists of more than just one point.
This intersection is a (d âˆ’1)-polytope P, whose vertices are determined by
the generators of K. Now triangulate P using no new vertices. The cone over
each simplex of the triangulation is a simplicial cone. These simplicial cones,
by construction, triangulate K.
âŠ“âŠ”
3.2 Integer-Point Transforms for Rational Cones
We want to encode the information contained by the lattice points in a set
S âŠ‚Rd. It turns out that the following multivariate generating function allows
us to do this in an eï¬ƒcient way if S is a rational cone or polytope:
ÏƒS(z) = ÏƒS (z1, z2, . . . , zd) :=
X
mâˆˆSâˆ©Zd
zm.
The generating function ÏƒS simply lists all integer points in S in a special
form: not as a list of vectors, but as a formal sum of monomials. We call ÏƒS
the integer-point transform of S; the function ÏƒS also goes by the name
moment generating function or simply generating function of S. The integer-
point transform ÏƒS opens the door to both algebraic and analytic techniques.
Example 3.3. As a warm-up example, consider the 1-dimensional cone K =
[0, âˆ). Its integer-point transform is our old friend
ÏƒK(z) =
X
mâˆˆ[0,âˆ)âˆ©Z
zm =
X
mâ‰¥0
zm =
1
1 âˆ’z .
âŠ“âŠ”
Example 3.4. Now we consider the two-dimensional cone
K := {Î»1(1, 1) + Î»2(âˆ’2, 3) : Î»1, Î»2 â‰¥0} âŠ‚R2
depicted in Figure 3.3. To obtain the integer-point transform ÏƒK, we tile K
by copies of the fundamental parallelogram
Î  := {Î»1(1, 1) + Î»2(âˆ’2, 3) : 0 â‰¤Î»1, Î»2 < 1} âŠ‚R2.
More precisely, we translate Î  by nonnegative integer linear combinations
of the generators (1, 1) and (âˆ’2, 3), and these translates will exactly cover

3.2 Integer-Point Transforms for Rational Cones
61
K. How can we list the integer points in K as monomials? Letâ€™s ï¬rst list all
vertices of the translates of Î . These are nonnegative integer combinations of
the generators (1, 1) and (âˆ’2, 3), so we can list them using geometric series:
X
m=j(1,1)+k(âˆ’2,3)
j,kâ‰¥0
zm =
X
jâ‰¥0
X
kâ‰¥0
zj(1,1)+k(âˆ’2,3) =
1
(1 âˆ’z1z2)
 1 âˆ’zâˆ’2
1 z3
2
 .
We now use the integer points (m, n) âˆˆÎ  to generate a subset of Z2 by adding
to (m, n) nonnegative linear integer combinations of the generators (1, 1) and
(âˆ’2, 3). Namely, we let
L(m,n) := {(m, n) + j(1, 1) + k(âˆ’2, 3) : j, k âˆˆZâ‰¥0} .
It is immediate that Kâˆ©Z2 is the disjoint union of the subsets L(m,n) as (m, n)
ranges over Î  âˆ©Z2 = {(0, 0), (0, 1), (0, 2), (âˆ’1, 2), (âˆ’1, 3)}. Hence
ÏƒK(z) =
 1 + z2 + z2
2 + zâˆ’1
1 z2
2 + zâˆ’1
1 z3
2

X
m=j(1,1)+k(âˆ’2,3)
j,kâ‰¥0
zm
= 1 + z2 + z2
2 + zâˆ’1
1 z2
2 + zâˆ’1
1 z3
2
(1 âˆ’z1z2)
 1 âˆ’zâˆ’2
1 z3
2

.
âŠ“âŠ”
x2
x1
(1, 1)
(âˆ’2, 3)
Fig. 3.3. The cone K and its fundamental parallelogram.

62
3 Counting Lattice Points in Polytopes: The Ehrhart Theory
Similar geometric series suï¬ƒce to describe integer-point transforms for
simplicial d-cones. The following result utilizes the geometric series in several
directions simultaneously.
Theorem 3.5. Suppose
K := {Î»1w1 + Î»2w2 + Â· Â· Â· + Î»dwd : Î»1, Î»2, . . . , Î»d â‰¥0}
is a simplicial d-cone, where w1, w2, . . . , wd âˆˆZd. Then for v âˆˆRd, the
integer-point transform Ïƒv+K of the shifted cone v+K is the rational function
Ïƒv+K(z) =
Ïƒv+Î (z)
(1 âˆ’zw1) (1 âˆ’zw2) Â· Â· Â· (1 âˆ’zwd) ,
where Î  is the half-open parallelepiped
Î  := {Î»1w1 + Î»2w2 + Â· Â· Â· + Î»dwd : 0 â‰¤Î»1, Î»2, . . . , Î»d < 1} .
The half-open parallelepiped Î  is called the fundamental parallelepiped
of K.
Proof. In Ïƒv+K(z) = P
mâˆˆ(v+K)âˆ©Zd zm, we list each integer point m in v + K
as the monomial zm. Such a lattice point can, by deï¬nition, be written as
m = v + Î»1w1 + Î»2w2 + Â· Â· Â· + Î»dwd
for some numbers Î»1, Î»2, . . . , Î»d â‰¥0. Because the wkâ€™s form a basis of Rd, this
representation is unique. Letâ€™s write each of the Î»kâ€™s in terms of their integer
and fractional part: Î»k = âŒŠÎ»kâŒ‹+ {Î»k}. So
m = v+
 {Î»1} w1+{Î»2} w2+Â· Â· Â·+{Î»d} wd

+âŒŠÎ»1âŒ‹w1+âŒŠÎ»2âŒ‹w2+Â· Â· Â·+âŒŠÎ»dâŒ‹wd ,
and we should note that, since 0 â‰¤{Î»k} < 1, the vector
p := v + {Î»1} w1 + {Î»2} w2 + Â· Â· Â· + {Î»d} wd
is in v+Î . In fact, p âˆˆZd, since m and âŒŠÎ»kâŒ‹wk are all integer vectors. Again
the representation of p in terms of the wkâ€™s is unique. In summary, we have
proved that any m âˆˆv + K âˆ©Zd can be uniquely written as
m = p + k1w1 + k2w2 + Â· Â· Â· + kdwd
(3.1)
for some p âˆˆ(v + Î ) âˆ©Zd and some integers k1, k2, . . . , kd â‰¥0. On the other
hand, let us write the rational function on the right-hand side of the theorem
as a product of series:
Ïƒv+Î (z)
(1 âˆ’zw1) Â· Â· Â· (1 âˆ’zwd) =
ï£«
ï£­
X
pâˆˆ(v+Î )âˆ©Zd
zp
ï£¶
ï£¸
ï£«
ï£­X
k1â‰¥0
zk1w1
ï£¶
ï£¸Â· Â· Â·
ï£«
ï£­X
kdâ‰¥0
zkdwd
ï£¶
ï£¸.
If we multiply everything out, a typical exponent will look exactly like (3.1).
âŠ“âŠ”

3.2 Integer-Point Transforms for Rational Cones
63
Our proof contains a crucial geometric idea. Namely, we tile the cone v+K
with translates of v + Î  by nonnegative integral combinations of the wkâ€™s. It
is this tiling that gives rise to the nice integer-point transform in Theorem 3.5.
Computationally, we therefore favor cones over polytopes due to our ability
to tile a simplicial cone with copies of the fundamental domain, as above.
Another reason for favoring cones over polytopes appears in Brionâ€™s theorem
in Chapter 9.
Theorem 3.5 shows that the real complexity of computing the integer-
point transform Ïƒv+K is embedded in the location of the lattice points in the
parallelepiped v + Î .
By mildly strengthening the hypothesis of Theorem 3.5, we obtain a
slightly easier generating function, a result we shall need in Section 3.4 and
Chapter 4.
Corollary 3.6. Suppose
K := {Î»1w1 + Î»2w2 + Â· Â· Â· + Î»dwd : Î»1, Î»2, . . . , Î»d â‰¥0}
is a simplicial d-cone, where w1, w2, . . . , wd âˆˆZd, and v âˆˆRd, such that the
boundary of v + K contains no integer point. Then
Ïƒv+K(z) =
Ïƒv+Î (z)
(1 âˆ’zw1) (1 âˆ’zw2) Â· Â· Â· (1 âˆ’zwd) ,
where Î  is the open parallelepiped
Î  := {Î»1w1 + Î»2w2 + Â· Â· Â· + Î»dwd : 0 < Î»1, Î»2, . . . , Î»d < 1} .
Proof. The proof of Theorem 3.5 goes through almost verbatim, except that
v+Î  now has no boundary lattice points, so that there is no harm in choosing
Î  to be open.
âŠ“âŠ”
Since a general pointed cone can always be triangulated into simplicial
cones, the integer-point transforms add up in an inclusionâ€“exclusion manner
(note that the intersection of simplicial cones in a triangulation is again a
simplicial cone, by Exercise 3.2). Hence we have the following corollary.
Corollary 3.7. Given any pointed cone
K = {v + Î»1w1 + Î»2w2 + Â· Â· Â· + Î»mwm : Î»1, Î»2, . . . , Î»m â‰¥0}
with v âˆˆRd, w1, w2, . . . , wm âˆˆZd, the integer-point transform ÏƒK(z) evalu-
ates to a rational function in the coordinates of z.
âŠ“âŠ”
Philosophizing some more, one can show that the original inï¬nite sum
ÏƒK(z) converges only for z in a subset of Cd, whereas the rational function
that represents ÏƒK gives us its meromorphic continuation. Later, in Chapters
4 and 9, we make use of this continuation.

64
3 Counting Lattice Points in Polytopes: The Ehrhart Theory
3.3 Expanding and Counting Using Ehrhartâ€™s Original
Approach
Here is the fundamental theorem concerning the lattice-point count in an
integral convex polytope.
Theorem 3.8 (Ehrhartâ€™s theorem). If P is an integral convex d-polytope,
then LP(t) is a polynomial in t of degree d.
This result is due to Eug`ene Ehrhart, in whose honor we call LP the
Ehrhart polynomial of P. Naturally, there is an extension of Ehrhartâ€™s
theorem to rational polytopes, which we will discuss in Section 3.7.
Our proof of Ehrhartâ€™s theorem uses generating functions of the form
P
tâ‰¥0 f(t) zt, similar in spirit to the ones discussed in the beginning of Chap-
ter 1. If f is a polynomial, this power series takes on a special form, which we
invite the reader to prove (Exercise 3.8):
Lemma 3.9. If
X
tâ‰¥0
f(t) zt =
g(z)
(1 âˆ’z)d+1 ,
then f is a polynomial of degree d if and only if g is a polynomial of degree at
most d and g(1) Ì¸= 0.
âŠ“âŠ”
The reason we introduced generating functions of the form ÏƒS(z) =
P
mâˆˆSâˆ©Zd zm in Section 3.2 is that they are extremely handy for lattice-point
problems. The connection to lattice points is evident, since we are summing
over them. If weâ€™re interested in the lattice-point count, we simply evaluate
ÏƒS at z = (1, 1, . . . , 1):
ÏƒS(1, 1, . . . , 1) =
X
mâˆˆSâˆ©Zd
1m =
X
mâˆˆSâˆ©Zd
1 = #
 S âˆ©Zd
.
(Here we denote by 1 a vector all of whose components are 1.) Naturally, we
should make this evaluation only if S is bounded; Theorem 3.5 already tells
us that itâ€™s no fun evaluating ÏƒK(1) if K is a cone.
But the magic of the generating function ÏƒS does not stop there. To liter-
ally take it to the next level, we cone over a convex polytope P. If P âŠ‚Rd has
the vertices v1, v2, . . . , vn âˆˆZd, recall that we lift these vertices into Rd+1,
by adding a 1 as their last coordinate. So let
w1 = (v1, 1) , w2 = (v2, 1) , . . . , wn = (vn, 1) .
Then
cone(P) = {Î»1w1 + Î»2w2 + Â· Â· Â· + Î»nwn : Î»1, Î»2, . . . , Î»n â‰¥0} âŠ‚Rd+1.

3.3 Expanding and Counting Using Ehrhartâ€™s Original Approach
65
Recall that we can recover our original polytope P by cutting cone(P) with
the hyperplane xd+1 = 1. We can recover more than just the original polytope
in cone(P): By cutting the cone with the hyperplane xd+1 = 2, we obtain a
copy of P dilated by a factor of 2. (The reader should meditate on why this cut
is a 2-dilate of P.) More generally, we can cut the cone with the hyperplane
xd+1 = t and obtain tP, as suggested by Figure 3.4.
Fig. 3.4. Recovering dilates of P in cone(P).
Now letâ€™s form the integer-point transform Ïƒcone(P) of cone(P). By what we
just said, we should look at diï¬€erent powers of zd+1: there is one term (namely,
1), with z0
d+1, corresponding to the origin; the terms with z1
d+1 correspond to
lattice points in P (listed as monomials in z1, z2, . . . , zd), the terms with z2
d+1
correspond to points in 2P, etc. In short,

66
3 Counting Lattice Points in Polytopes: The Ehrhart Theory
Ïƒcone(P) (z1, z2, . . . , zd+1)
= 1 + ÏƒP (z1, . . . , zd) zd+1 + Ïƒ2P (z1, . . . , zd) z2
d+1 + Â· Â· Â·
= 1 +
X
tâ‰¥1
ÏƒtP (z1, . . . , zd) zt
d+1 .
Specializing further for enumeration purposes, we recall that ÏƒP (1, 1, . . . , 1) =
#
 P âˆ©Zd
, and so
Ïƒcone(P) (1, 1, . . . , 1, zd+1) = 1 +
X
tâ‰¥1
ÏƒtP (1, 1, . . . , 1) zt
d+1
= 1 +
X
tâ‰¥1
#
 tP âˆ©Zd
zt
d+1 .
But by deï¬nition, the enumerators on the right-hand side are just evaluations
of Ehrhartâ€™s counting function, that is, Ïƒcone(P) (1, 1, . . . , 1, zd+1) is nothing
but the Ehrhart series of P:
Lemma 3.10. Ïƒcone(P) (1, 1, . . . , 1, z) = 1 +
X
tâ‰¥1
LP(t) zt = EhrP(z) .
âŠ“âŠ”
With all this machinery at hand, we can prove Ehrhartâ€™s theorem.
Proof of Theorem 3.8. It suï¬ƒces to prove the theorem for simplices, because
we can triangulate any integral polytope into integral simplices, using no new
vertices. Note that these simplices will intersect in lower-dimensional integral
simplices.
By Lemma 3.9, it suï¬ƒces to prove that for an integral d-simplex âˆ†,
Ehrâˆ†(z) = 1 +
X
tâ‰¥1
Lâˆ†(t) zt =
g(z)
(1 âˆ’z)d+1
for some polynomial g of degree at most d with g(1) Ì¸= 0. In Lemma 3.10
we showed that the Ehrhart series of âˆ†equals Ïƒcone(âˆ†) (1, 1, . . . , 1, z), so letâ€™s
study the integer-point transform attached to cone(âˆ†).
The simplex âˆ†has d+1 vertices v1, v2, . . . , vd+1, and so cone(âˆ†) âŠ‚Rd+1
is simplicial, with apex the origin and generators
w1 = (v1, 1) , w2 = (v2, 1) , . . . , wd+1 = (vd+1, 1) âˆˆZd+1.
Now we use Theorem 3.5:
Ïƒcone(âˆ†) (z1, z2, . . . , zd+1) =
ÏƒÎ  (z1, z2, . . . , zd+1)
(1 âˆ’zw1) (1 âˆ’zw2) Â· Â· Â· (1 âˆ’zwd+1) ,
where Î  = {Î»1w1 + Î»2w2 + Â· Â· Â· + Î»d+1wd+1 : 0 â‰¤Î»1, Î»2, . . . , Î»d+1 < 1}. This
parallelepiped is bounded, so the attached generating function ÏƒÎ  is a Laurent
polynomial in z1, z2, . . . , zd+1.

3.4 The Ehrhart Series of an Integral Polytope
67
We claim that the zd+1-degree of ÏƒÎ  is at most d. In fact, since the xd+1-
coordinate of each wk is 1, the xd+1-coordinate of a point in Î  is Î»1+Î»2+Â· Â· Â·+
Î»d+1 for some 0 â‰¤Î»1, Î»2, . . . , Î»d+1 < 1. But then Î»1 +Î»2 +Â· Â· Â·+Î»d+1 < d+1,
so if this sum is an integer it is at most d, which implies that the zd+1-degree
of ÏƒÎ  (z1, z2, . . . , zd+1) is at most d. Consequently, ÏƒÎ  (1, 1, . . . , 1, zd+1) is a
polynomial in zd+1 of degree at most d. The evaluation ÏƒÎ  (1, 1, 1, . . . , 1) of this
polynomial at zd+1 = 1 is not zero, because ÏƒÎ  (1, 1, 1, . . . , 1) = #
 Î  âˆ©Zd+1
and the origin is a lattice point in Î .
Finally, if we specialize zwk to z1 = z2 = Â· Â· Â· = zd = 1, we obtain z1
d+1, so
that
Ïƒcone(âˆ†) (1, 1, . . . , 1, zd+1) = ÏƒÎ  (1, 1, . . . , 1, zd+1)
(1 âˆ’zd+1)d+1
.
The leftâ€“hand side is Ehrâˆ†(zd+1) = 1+P
tâ‰¥1 Lâˆ†(t) zt
d+1 by Lemma 3.10.
âŠ“âŠ”
3.4 The Ehrhart Series of an Integral Polytope
We can actually take our proof of Ehrhartâ€™s theorem one step further by study-
ing the polynomial ÏƒÎ  (1, 1, . . . , 1, zd+1). As mentioned above, the coeï¬ƒcient
of zk
d+1 simply counts the integer points in the parallelepiped Î  cut with the
hyperplane xd+1 = k. Let us record this.
Corollary 3.11. Suppose âˆ†is an integral d-simplex with vertices v1, v2, . . . ,
vd+1, and let wj = (vj, 1). Then
Ehrâˆ†(z) = 1 +
X
tâ‰¥1
Lâˆ†(t) zt = hd zd + hdâˆ’1 zdâˆ’1 + Â· Â· Â· + h1 z + h0
(1 âˆ’z)d+1
,
where hk equals the number of integer points in
{Î»1w1 + Î»2w2 + Â· Â· Â· + Î»d+1wd+1 : 0 â‰¤Î»1, Î»2, . . . , Î»d+1 < 1}
with last variable equal to k.
âŠ“âŠ”
This result can actually be used to compute Ehrâˆ†, and therefore the
Ehrhart polynomial, of an integral simplex âˆ†in low dimensions very quickly
(a fact that the reader may discover in some of the exercises). We remark,
however, that things are not as simple for arbitrary integral polytopes. Not
only is triangulation a nontrivial task in general, but one would also have to
deal with overcounting where simplices of a triangulation meet.
Corollary 3.11 implies that the numerator of the Ehrhart series of an inte-
gral simplex has nonnegative coeï¬ƒcients, since those coeï¬ƒcients count some-
thing. Although the latter cannot be said of the coeï¬ƒcients of the Ehrhart
series of a general integral polytope, the nonnegativity property magically
survives.

68
3 Counting Lattice Points in Polytopes: The Ehrhart Theory
Theorem 3.12 (Stanleyâ€™s nonnegativity theorem). Suppose P is an in-
tegral convex d-polytope with Ehrhart series
EhrP(z) = hd zd + hdâˆ’1 zdâˆ’1 + Â· Â· Â· + h0
(1 âˆ’z)d+1
.
Then h0, h1, . . . , hd â‰¥0.
Proof. Triangulate cone(P) âŠ‚Rd+1 into the simplicial cones K1, K2, . . . , Km.
Now Exercise 3.14 ensures that there exists a vector v âˆˆRd+1 such that
cone(P) âˆ©Zd = (v + cone(P)) âˆ©Zd
(that is, we neither lose nor gain any lattice points when shifting cone(P) by
v) and neither the facets of v + cone(P) nor the triangulation hyperplanes
contain any lattice points. This implies that every lattice point in v+cone(P)
belongs to exactly one simplicial cone v + Kj:
cone(P) âˆ©Zd = (v + cone(P)) âˆ©Zd =
m
[
j=1
 (v + Kj) âˆ©Zd
,
(3.2)
and this union is a disjoint union. If we translate the last identity into
generating-function language, it becomes
Ïƒcone(P) (z1, z2, . . . , zd+1) =
m
X
j=1
Ïƒv+Kj (z1, z2, . . . , zd+1) .
But now we recall that the Ehrhart series of P is just a special evaluation of
Ïƒcone(P) (Lemma 3.10):
EhrP(z) = Ïƒcone(P) (1, 1, . . . , 1, z) =
m
X
j=1
Ïƒv+Kj (1, 1, . . . , 1, z) .
(3.3)
It suï¬ƒces to show that the rational generating functions Ïƒv+Kj (1, 1, . . . , 1, z)
for the simplicial cones v + Kj have nonnegative numerator. But this fact
follows from evaluating the rational function in Corollary 3.6 at (1, 1, . . . , 1, z).
âŠ“âŠ”
This proof shows a little more: Since the origin is in precisely one simplicial
cone on the right-hand side of (3.2), we get on the right-hand side of (3.3)
precisely one term that contributes 1/(1 âˆ’z)d+1 to EhrP; all other terms
contribute to higher powers of the numerator polynomial of EhrP. That is,
the constant term h0 equals 1. The reader might feel that we are chasing our
tail at this point, since we assumed from the very beginning that the constant
term of the inï¬nite series EhrP is 1, and hence h0 has to be 1, as a quick look
at the expansion of the rational function representing EhrP shows. The above
argument shows merely that this convention is geometrically sound. Let us
record this:

3.4 The Ehrhart Series of an Integral Polytope
69
Lemma 3.13. Suppose P is an integral convex d-polytope with Ehrhart series
EhrP(z) = hd zd + hdâˆ’1 zdâˆ’1 + Â· Â· Â· + h0
(1 âˆ’z)d+1
.
Then h0 = 1.
âŠ“âŠ”
For a general integral polytope P, the reader has probably already discov-
ered how to extract the Ehrhart polynomial of P from its Ehrhart series:
Lemma 3.14. Suppose P is an integral convex d-polytope with Ehrhart series
EhrP(z) = 1 +
X
tâ‰¥1
LP(t) zt = hd zd + hdâˆ’1 zdâˆ’1 + Â· Â· Â· + h1 z + 1
(1 âˆ’z)d+1
.
Then
LP(t) =
t + d
d

+ h1
t + d âˆ’1
d

+ Â· Â· Â· + hdâˆ’1
t + 1
d

+ hd
t
d

.
Proof. Expand into a binomial series:
EhrP(z) = hd zd + hdâˆ’1 zdâˆ’1 + Â· Â· Â· + h1 z + 1
(1 âˆ’z)d+1
=
 hd zd + hdâˆ’1 zdâˆ’1 + Â· Â· Â· + h1 z + 1
 X
tâ‰¥0
t + d
d

zt
= hd
X
tâ‰¥0
t + d
d

zt+d + hdâˆ’1
X
tâ‰¥0
t + d
d

zt+dâˆ’1 + Â· Â· Â·
+ h1
X
tâ‰¥0
t + d
d

zt+1 +
X
tâ‰¥0
t + d
d

zt
= hd
X
tâ‰¥d
t
d

zt + hdâˆ’1
X
tâ‰¥dâˆ’1
t + 1
d

zt + Â· Â· Â·
+ h1
X
tâ‰¥1
t + d âˆ’1
d

zt +
X
tâ‰¥0
t + d
d

zt.
In all inï¬nite sums on the right-hand side, we can start the index t with 0
without changing the sums, by the deï¬nition (2.1) of the binomial coeï¬ƒcient.
Hence
EhrP(z)
=
X
tâ‰¥0

hd
t
d

+ hdâˆ’1
t + 1
d

+ Â· Â· Â· + h1
t + d âˆ’1
d

+
t + d
d

zt.
âŠ“âŠ”

70
3 Counting Lattice Points in Polytopes: The Ehrhart Theory
The representation of the polynomial LP(t) in terms of the coeï¬ƒcients
of EhrP can be interpreted as the Ehrhart polynomial expressed in the basis
 t
d

,
 t+1
d

, . . . ,
 t+d
d

(see Exercise 3.9). This representation is very useful, as
the following results show.
Corollary 3.15. If P is an integral convex d-polytope, then the constant term
of the Ehrhart polynomial LP is 1.
Proof. Use the expansion of Lemma 3.14. The constant term is
LP(0) =
d
d

+ h1
d âˆ’1
d

+ Â· Â· Â· + hdâˆ’1
1
d

+ hd
0
d

=
d
d

= 1 .
âŠ“âŠ”
This proof is exciting, because it marks the ï¬rst instance where we extend
the domain of an Ehrhart polynomial beyond the positive integers, for which
the lattice-point enumerator was initially deï¬ned. More precisely, Ehrhartâ€™s
theorem (Theorem 3.8) implies that the counting function
LP(t) = #
 tP âˆ©Zd
,
originally deï¬ned for positive integers t, can be extended to all real or even
complex arguments t (as a polynomial). A natural question arises: are there
nice interpretations of LP(t) for arguments t that are not positive integers?
Corollary 3.15 gives such an interpretation for t = 0. In Chapter 4, we will
give interpretations of LP(t) for negative integers t.
Corollary 3.16. Suppose P is an integral convex d-polytope with Ehrhart se-
ries
EhrP(z) = hd zd + hdâˆ’1 zdâˆ’1 + Â· Â· Â· + h1 z + 1
(1 âˆ’z)d+1
.
Then h1 = LP(1) âˆ’d âˆ’1 = #
 P âˆ©Zd
âˆ’d âˆ’1.
Proof. Use the expansion of Lemma 3.14 with t = 1:
LP(1) =
d + 1
d

+ h1
d
d

+ Â· Â· Â· + hdâˆ’1
2
d

+ hd
1
d

= d + 1 + h1 .
âŠ“âŠ”
The proof of Corollary 3.16 suggests that there are also formulas for
h2, h3, . . . in terms of the evaluations LP(1), LP(2), . . . , and we invite the
reader to ï¬nd them (Exercise 3.10).
A ï¬nal corollary to Theorem 3.12 and Lemma 3.14 states how large the
denominators of the Ehrhart coeï¬ƒcients can be:
Corollary 3.17. Suppose P is an integral polytope with Ehrhart polynomial
LP(t) = cd td +cdâˆ’1 tdâˆ’1 +Â· Â· Â·+c1 t+1. Then all coeï¬ƒcients satisfy d! ck âˆˆZ.

3.5 From the Discrete to the Continuous Volume of a Polytope
71
Proof. By Theorem 3.12 and Lemma 3.14,
LP(t) =
t + d
d

+ h1
t + d âˆ’1
d

+ Â· Â· Â· + hdâˆ’1
t + 1
d

+ hd
t
d

,
where the hkâ€™s are integers. Hence multiplying out this expression yields a
polynomial in t whose coeï¬ƒcients can be written as rational numbers with
denominator d!.
âŠ“âŠ”
We ï¬nish this section with a general result that gives relations between
negative integer roots of a polynomial and its generating function. This the-
orem will become handy in Chapter 4, in which we ï¬nd an interpretation for
the evaluation of an Ehrhart polynomial at negative integers.
Theorem 3.18. Suppose p is a degree-d polynomial with the rational gener-
ating function
X
tâ‰¥0
p(t) zt = hd zd + hdâˆ’1 zdâˆ’1 + Â· Â· Â· + h1 z + h0
(1 âˆ’z)d+1
.
Then hd = hdâˆ’1 = Â· Â· Â· = hk+1 = 0 and hk Ì¸= 0 if and only if p(âˆ’1) = p(âˆ’2) =
Â· Â· Â· = p (âˆ’(d âˆ’k)) = 0 and p (âˆ’(d âˆ’k + 1)) Ì¸= 0.
Proof. Suppose hd = hdâˆ’1 = Â· Â· Â· = hk+1 = 0 and hk Ì¸= 0. Then the proof of
Lemma 3.14 gives
p(t) = h0
t + d
d

+ Â· Â· Â· + hkâˆ’1
t + d âˆ’k + 1
d

+ hk
t + d âˆ’k
d

.
All the binomial coeï¬ƒcients are zero for t = âˆ’1, âˆ’2, . . . , âˆ’d + k, so those are
roots of p. On the other hand, all binomial coeï¬ƒcients but the last one are
zero for t = âˆ’d + k âˆ’1, and since hk Ì¸= 0, âˆ’d + k âˆ’1 is not a root of p.
Conversely, suppose p(âˆ’1) = p(âˆ’2) = Â· Â· Â· = p (âˆ’(d âˆ’k)) = 0 and
p (âˆ’(d âˆ’k + 1)) Ì¸= 0. The ï¬rst root âˆ’1 of p gives
0 = p(âˆ’1) = h0
d âˆ’1
d

+h1
d âˆ’2
d

+Â· Â· Â·+hdâˆ’1
0
d

+hd
âˆ’1
d

= hd
âˆ’1
d

,
so we must have hd = 0. The next root âˆ’2 forces hdâˆ’1 = 0, and so on, up to
the root âˆ’d + k, which forces hk+1 = 0. It remains to show that hk Ì¸= 0. But
if hk were zero then, by a similar line of reasoning as in the ï¬rst part of the
proof, p(âˆ’d + k âˆ’1) = 0, a contradiction.
âŠ“âŠ”
3.5 From the Discrete to the Continuous Volume
of a Polytope
Given a geometric object S âŠ‚Rd, its volume, deï¬ned by the integral vol S :=
R
S dx, is one of the fundamental data of S. By the deï¬nition of the integral, say

72
3 Counting Lattice Points in Polytopes: The Ehrhart Theory
in the Riemannian sense, we can think of computing vol S by approximating
S with d-dimensional boxes that get smaller and smaller. To be precise, if
we take the boxes with side length 1/t then they each have volume 1/td. We
might further think of the boxes as ï¬lling out the space between grid points in
the lattice
  1
t Z
d. This means that volume computation can be approximated
by counting boxes, or equivalently, lattice points in
  1
t Z
d:
vol S = lim
tâ†’âˆ
1
td Â· #
 
S âˆ©
1
t Z
d!
.
It is a short step to counting integer points in dilates of S, because
#
 
S âˆ©
1
t Z
d!
= #
 tS âˆ©Zd
.
Let us summarize:
Lemma 3.19. Suppose S âŠ‚Rd is d-dimensional. Then
vol S = lim
tâ†’âˆ
1
td Â· #
 tS âˆ©Zd
.
âŠ“âŠ”
We emphasize here that S is d-dimensional, because otherwise (since S could
be lower-dimensional although living in d-space), by our current deï¬nition
vol S = 0. (We will extend our volume deï¬nition in Chapter 5 to give nonzero
relative volume to objects that are not full-dimensional.)
Part of the magic of Ehrhartâ€™s theorem lies in the fact that for an integral
d-polytope P, we do not have to take a limit to compute vol P; we need to
compute â€œonlyâ€ the d + 1 coeï¬ƒcients of a polynomial.
Corollary 3.20. Suppose P âŠ‚Rd is a integral convex d-polytope with Ehrhart
polynomial cd td + cdâˆ’1 tdâˆ’1 + Â· Â· Â· + c1 t + 1. Then cd = vol P.
Proof. By Lemma 3.19,
vol P = lim
tâ†’âˆ
cd td + cdâˆ’1 tdâˆ’1 + Â· Â· Â· + c1 t + 1
td
= cd .
âŠ“âŠ”
On the one hand, this should not come as a surprise, because counting
integer points in some object should grow roughly like the volume of the
object as we make it bigger and bigger. On the other hand, the fact that we
can compute the volume as one term of a polynomial should be very surprising:
the polynomial is a counting function and as such is something discrete, yet by
computing it (and its leading term), we derive some continuous data. Even
more, we canâ€”at least theoreticallyâ€”compute this continuous datum (the
volume) of the object by calculating a few values of the polynomial and then
interpolating; this can be described as a completely discrete operation!
We ï¬nish this section by showing how to retrieve the continuous volume
of an integer polytope from its Ehrhart series.

3.6 Interpolation
73
Corollary 3.21. Suppose P âŠ‚Rd is an integral convex d-polytope, and
EhrP(z) = hd zd + hdâˆ’1 zdâˆ’1 + Â· Â· Â· + h1 z + 1
(1 âˆ’z)d+1
.
Then vol P = 1
d! (hd + hdâˆ’1 + Â· Â· Â· + h1 + 1) .
Proof. Use the expansion of Lemma 3.14. The leading coeï¬ƒcient is
1
d! (hd + hdâˆ’1 + Â· Â· Â· + h1 + 1) .
âŠ“âŠ”
3.6 Interpolation
We now use the polynomial behavior of the discrete volume LP of an integral
polytope P to compute the continuous volume vol P and the discrete volume
LP from ï¬nite data.
Two points uniquely determine a line. There exists a unique quadratic
passing through any three given points. In general, a degree-d polynomial
p is determined by d + 1 points (x, p(x)) âˆˆR2. Namely, evaluating p(x) =
cdxd + cdâˆ’1xdâˆ’1 + Â· Â· Â· + c0 at distinct inputs x1, x2, . . . , xd+1 gives
ï£«
ï£¬
ï£¬
ï£¬
ï£­
p (x1)
p (x2)
...
p (xd+1)
ï£¶
ï£·
ï£·
ï£·
ï£¸= V
ï£«
ï£¬
ï£¬
ï£¬
ï£­
cd
cdâˆ’1
...
c0
ï£¶
ï£·
ï£·
ï£·
ï£¸,
(3.4)
where
V =
ï£«
ï£¬
ï£¬
ï£¬
ï£­
xd
1
xdâˆ’1
1
Â· Â· Â·
x1
1
xd
2
xdâˆ’1
2
Â· Â· Â·
x2
1
...
...
...
...
xd
d+1 xdâˆ’1
d+1 Â· Â· Â· xd+1 1
ï£¶
ï£·
ï£·
ï£·
ï£¸,
so that
ï£«
ï£¬
ï£¬
ï£¬
ï£­
cd
cdâˆ’1
...
c0
ï£¶
ï£·
ï£·
ï£·
ï£¸= Vâˆ’1
ï£«
ï£¬
ï£¬
ï£¬
ï£­
p (x1)
p (x2)
...
p (xd+1)
ï£¶
ï£·
ï£·
ï£·
ï£¸.
(3.5)
(Exercise 3.16 makes sure that V is invertible.) The identity (3.5) gives the
famous Lagrange interpolation formula.
This gives us an eï¬ƒcient way to compute LP, at least when dim P is not
too large. The continuous volume of P will follow instantly, since it is the
leading coeï¬ƒcient cd of LP. In the case of an Ehrhart polynomial LP, we
know that LP(0) = 1, so that (3.4) simpliï¬es to

74
3 Counting Lattice Points in Polytopes: The Ehrhart Theory
ï£«
ï£¬
ï£¬
ï£¬
ï£­
LP (x1) âˆ’1
LP (x2) âˆ’1
...
LP (xd) âˆ’1
ï£¶
ï£·
ï£·
ï£·
ï£¸=
ï£«
ï£¬
ï£¬
ï£¬
ï£­
xd
1 xdâˆ’1
1
Â· Â· Â· x1
xd
2 xdâˆ’1
2
Â· Â· Â· x2
...
...
...
xd
d xdâˆ’1
d
Â· Â· Â· xd
ï£¶
ï£·
ï£·
ï£·
ï£¸
ï£«
ï£¬
ï£¬
ï£¬
ï£­
cd
cdâˆ’1
...
c1
ï£¶
ï£·
ï£·
ï£·
ï£¸.
Example 3.22 (Reeveâ€™s tetrahedron). Let Th be the tetrahedron with
vertices (0, 0, 0), (1, 0, 0), (0, 1, 0), and (1, 1, h), where h is a positive integer
(see Figure 3.5).
2h
h
(2, 2, 2h)
(1, 1, h)
1
2
1
2
x
y
z
Fig. 3.5. Reeveâ€™s tetrahedron Th (and 2Th).
To interpolate the Ehrhart polynomial LTh(t) from its values at various
points, we use Figure 3.5 to deduce the following:
4 = LTh(1) = vol (Th) + c2 + c1 + 1 ,
h + 9 = LTh(2) = vol (Th) Â· 23 + c2 Â· 22 + c1 Â· 2 + 1 .
Using the volume formula for a pyramid, we know that

3.7 Rational Polytopes and Ehrhart Quasipolynomials
75
vol (Th) = 1
3(base area)(height) = h
6 .
Thus h + 1 = h + 2c2 âˆ’1, which gives us c2 = 1 and c1 = 2 âˆ’h
6 . Therefore
LTh(t) = h
6 t3 + t2 +

2 âˆ’h
6

t + 1 .
âŠ“âŠ”
3.7 Rational Polytopes and Ehrhart Quasipolynomials
We do not have to change much to study lattice-point enumeration for rational
polytopes, and most of this section will consist of exercises for the reader. The
structural result paralleling Theorem 3.8 is as follows.
Theorem 3.23 (Ehrhartâ€™s theorem for rational polytopes). If P is a
rational convex d-polytope, then LP(t) is a quasipolynomial in t of degree
d. Its period divides the least common multiple of the denominators of the
coordinates of the vertices of P.
We will call the least common multiple of the denominators of the co-
ordinates of the vertices of P the denominator of P. Theorem 3.23, also
due to Ehrhart, extends Theorem 3.8, because the denominator of an integral
polytope P is one. Exercises 3.21 and 3.22 show that the word â€œdividesâ€ in
Theorem 3.23 is far from being replaceable by â€œequals.â€
We start the path toward a proof of Theorem 3.23 by stating the analogue
of Lemma 3.9 for quasipolynomials (see Exercise 3.19):
Lemma 3.24. If
X
tâ‰¥0
f(t) zt = g(z)
h(z) ,
then f is a quasipolynomial of degree d with period dividing p if and only if g
and h are polynomials such that deg(g) < deg(h), all roots of h are pth roots
of unity of multiplicity at most d + 1, and there is a root of multiplicity equal
to d+1 (all of this assuming that g/h has been reduced to lowest terms).
âŠ“âŠ”
Our goal is now evident: we will prove that if P is a rational convex d-
polytope with denominator p, then
EhrP(z) = 1 +
X
tâ‰¥1
LP(t) zt =
g(z)
(1 âˆ’zp)d+1 ,
for some polynomial g of degree less than p(d + 1). As in Section 3.3, we will
have to prove this only for the case of a rational simplex. So suppose the d-
simplex âˆ†has vertices v1, v2, . . . , vd+1 âˆˆQd, and the denominator of âˆ†is p.
Again we will cone over âˆ†: let

76
3 Counting Lattice Points in Polytopes: The Ehrhart Theory
w1 = (v1, 1) , w2 = (v2, 1) , . . . , wd+1 = (vd+1, 1) ;
then
cone(âˆ†) = {Î»1w1 + Î»2w2 + Â· Â· Â· + Î»d+1wd+1 : Î»1, Î»2, . . . , Î»d+1 â‰¥0} âŠ‚Rd+1.
To be able to use Theorem 3.5, we ï¬rst have to ensure that we have a descrip-
tion of cone(âˆ†) with integral generators. But since the denominator of âˆ†is p,
we can replace each generator wk by pwk âˆˆZd+1, and weâ€™re ready to apply
Theorem 3.5. From this point, the proof of Theorem 3.23 proceeds exactly like
that of Theorem 3.8, and we invite the reader to ï¬nish it up (Exercise 3.20).
Although the proofs of Theorem 3.23 and Theorem 3.8 are almost identical,
the arithmetic structure of Ehrhart quasipolynomials is much more subtle and
less well known than that of Ehrhart polynomials.
3.8 Reï¬‚ections on the Coin-Exchange Problem
and the Gallery of Chapter 2
At this point, we encourage the reader to look back at the ï¬rst two chapters in
light of the basic Ehrhart-theory results. Popoviciuâ€™s theorem (Theorem 1.5)
and its higher-dimensional analogue give a special set of Ehrhart quasipoly-
nomials. On the other hand, in Chapter 2 we encountered many integral
polytopes. Ehrhartâ€™s theorem (Theorem 3.8) explains why their lattice-point
enumeration functions were all polynomials.
Notes
1. Triangulations of polytopes and manifolds are an active source of research
with many interesting open problems; see, e.g., [69].
2. Eug`ene Ehrhart laid the foundation for the central theme of this book in
the 1960s, starting with the proof of Theorem 3.8 in 1962 [79]. The proof we
give here follows Ehrhartâ€™s original lines of thought. An interesting fact is that
he did his most beautiful work as a teacher at a lycÂ´ee in Strasbourg (France),
receiving his doctorate at age 60 on the urging of some colleagues.
3. Given any d linearly independent vectors w1, w2, . . . , wd âˆˆRd, the lat-
tice generated by them is the set of all integer linear combinations of
w1, w2, . . . , wd. Alternatively, one can deï¬ne a lattice as a discrete subgroup
of Rd, and these two notions can be shown to be equivalent. One might won-
der whether replacing the lattice Zd by an arbitrary lattice L throughout the
statements of the theoremsâ€”requiring now that the vertices of a polytope be
in Lâ€”gives us any diï¬€erent results. The fact that the theorems of this chapter

Exercises
77
remain the same follows from the observation that any lattice can be mapped
to Zd by an invertible linear transformation.
4. Richard Stanley developed much of the theory of Ehrhart (quasi-)polyno-
mials, initially from a commutative-algebra point of view. Theorem 3.12 is
due to him [170]. The proof we give here appeared in [30]. An extension of
Theorem 3.12 was found by Takayuki Hibi; he proved that if hd > 0 then
hk â‰¥h1 for all 1 â‰¤k â‰¤d âˆ’1 (using the notation of Theorem 3.12) [98].
5. The tetrahedron Th of Example 3.22 was used by John Reeve to show that
Pickâ€™s theorem does not hold in R3 (see Exercise 3.18) [154]. Incidentally, the
formula for LTh also proves that the coeï¬ƒcients of an Ehrhart polynomial (of
a closed polytope) are not always positive.
6. There are several interesting questions (some of which are still open) regard-
ing the periods of Ehrhart quasipolynomials. Some particularly nice examples
about what can happen with periods were given by Tyrrell McAllister and
Kevin Woods [126].
7. Most of the results remain true if we replace â€œconvex polytopeâ€ by â€œpoly-
topal complex,â€ that is, a ï¬nite union of polytopes. One important exception
is Corollary 3.15: the constant term of an â€œEhrhart polynomialâ€ of an integral
polytopal complex C is the Euler characteristric of C.
8. The reader might wonder why we do not discuss polytopes with irrational
vertices. The answer is simple: nobody has yet found a theory that would par-
allel the results in this chapter, even in dimension two. One notable exception
is [11], in which irrational extensions of Brionâ€™s theorem are given; we will
study the rational case of Brionâ€™s theorem in Chapter 9. On the other hand,
Ehrhart theory has been extended to functions other than strict lattice-point
counting; one instance is described in Chapter 11.
Exercises
3.1. To any permutation Ï€ âˆˆSd on d elements, we associate the simplex
âˆ†Ï€ := conv

0, eÏ€(1), eÏ€(1) + eÏ€(2), . . . , eÏ€(1) + eÏ€(2) + Â· Â· Â· + eÏ€(d)
	
,
where e1, e2, . . . , ed denote the unit vectors in Rd.
(a) Prove that {âˆ†Ï€ : Ï€ âˆˆSd} is a triangulation of the unit d-cube [0, 1]d.
(b) Prove that all âˆ†Ï€ are congruent to each other, that is, each one can be
obtained from any other by reï¬‚ections, translations, and rotations.
(c) Show that for all Ï€ âˆˆSd, Lâˆ†Ï€(t) =
 d+t
d

.

78
3 Counting Lattice Points in Polytopes: The Ehrhart Theory
3.2. â™£Suppose T is a triangulation of a pointed cone. Prove that the inter-
section of two simplicial cones in T is again a simplicial cone.
3.3. Find the generating function ÏƒK(z) for the following cones:
(a) K = {Î»1(0, 1) + Î»2(1, 0) : Î»1, Î»2 â‰¥0} ;
(b) K = {Î»1(0, 1) + Î»2(1, 1) : Î»1, Î»2 â‰¥0} ;
(c) K = {(3, 4) + Î»1(0, 1) + Î»2(2, 1) : Î»1, Î»2 â‰¥0} .
3.4. â™£Let S âŠ†Rm and T âŠ†Rn. Show that ÏƒSÃ—T (z1, z2, . . . , zm+n) =
ÏƒS (z1, z2, . . . , zm) ÏƒT (zm+1, zm+2, . . . , zm+n) .
3.5. â™£Let K be a rational d-cone, and let m âˆˆZd. Show that Ïƒm+K(z) =
zmÏƒK(z).
3.6. â™£For a set S âŠ‚Rd, let âˆ’S := {âˆ’x : x âˆˆS}. Prove that
Ïƒâˆ’S (z1, z2, . . . , zd) = ÏƒS
 1
z1
, 1
z2
, . . . , 1
zd

.
3.7. Given a pointed cone K âŠ‚Rd with apex at the origin, let S := K âˆ©Zd.
Show that if x, y âˆˆS then x + y âˆˆS. (In algebraic terms, S is a semi-
group, since 0 âˆˆS and associativity of the addition in S follows trivially from
associativity in Rd.)
3.8. â™£Prove Lemma 3.9: If
X
tâ‰¥0
f(t) zt =
g(z)
(1 âˆ’z)d+1 ,
then f is a polynomial of degree d if and only if g is a polynomial of degree
at most d and g(1) Ì¸= 0.
3.9. Prove that
 x+n
n

,
 x+nâˆ’1
n

, . . . ,
 x
n

is a basis for the vector space Poln of
polynomials (in the variable x) of degree less than or equal to n.
3.10. For a polynomial p(t) = cdtd + cdâˆ’1tdâˆ’1 + Â· Â· Â· + c0, let Hp(z) be deï¬ned
by
X
tâ‰¥0
p(t) zt =
Hp(z)
(1 âˆ’z)d+1 .
Consider the map Ï†d : Pold â†’Pold, p 7â†’Hp.
(a) Show that Ï†d is a linear transformation.
(b) Compute the matrix describing Ï†d for d = 0, 1, 2, . . . .
(c) Deduce formulas for h2, h3, . . . , similar to the one in Corollary 3.16.
3.11. Compute the Ehrhart polynomials and the Ehrhart series of the sim-
plices with the following vertices:

Exercises
79
(a) (0, 0, 0), (1, 0, 0), (0, 2, 0), and (0, 0, 3);
(b) (0, 0, 0, 0), (1, 0, 0, 0), (0, 2, 0, 0), (0, 0, 3, 0), and (0, 0, 0, 4).
3.12. Deï¬ne the hypersimplex âˆ†(d, k) as the convex hull of
{ej1 + ej2 + Â· Â· Â· + ejk : 1 â‰¤j1 < j2 < Â· Â· Â· < jk â‰¤d} ,
where e1, e2, . . . , ed are the standard basis vectors in Rd. For example, âˆ†(d, 1)
and âˆ†(d, dâˆ’1) are regular (dâˆ’1)-simplices. Compute the Ehrhart polynomial
and the Ehrhart series of âˆ†(d, k).
3.13. â™£Suppose H is the hyperplane given by
H =

x âˆˆRd : a1x1 + a2x2 + Â· Â· Â· + adxd = 0
	
for some a1, a2, . . . , ad âˆˆZ, which we may assume to have no common factor.
Prove that there exists v âˆˆZd such that S
nâˆˆZ
 (nv + H) âˆ©Zd
= Zd. (This
implies, in particular, that the points in Zd \ H are all at least some minimal
distance away from H; this minimal distance is essentially given by the dot
product of v with (a1, a2, . . . , ad).)
3.14. â™£A hyperplane H is rational if it can be written in the form
H =

x âˆˆRd : a1x1 + a2x2 + Â· Â· Â· + adxd = b
	
for some a1, a2, . . . , ad, b âˆˆZ. A hyperplane arrangement in Rd is a ï¬nite
set of hyperplanes in Rd. Prove that a rational hyperplane arrangement H
can be translated so that no hyperplane in H contains any integer points.
3.15. The conclusion of the previous exercise can be strengthened: Prove that
a rational hyperplane arrangement H can be translated such that no hyper-
plane in H contains any rational points.
3.16. Show that, given distinct numbers x1, x2, . . . , xd+1, the matrix
V =
ï£«
ï£¬
ï£¬
ï£¬
ï£­
xd
1
xdâˆ’1
1
Â· Â· Â·
x1
1
xd
2
xdâˆ’1
2
Â· Â· Â·
x2
1
...
...
...
...
xd
d+1 xdâˆ’1
d+1 Â· Â· Â· xd+1 1
ï£¶
ï£·
ï£·
ï£·
ï£¸
is not singular. (V is known as the Vandermonde matrix.)
3.17. Let P be an integral d-polytope. Show that
vol P = 1
d!
 
(âˆ’1)d +
d
X
k=1
d
k

(âˆ’1)dâˆ’kLP(k)
!
.

80
3 Counting Lattice Points in Polytopes: The Ehrhart Theory
3.18. As in Example 3.22, let Tn be the tetrahedron with vertices (0, 0, 0),
(1, 0, 0), (0, 1, 0), and (1, 1, n), where n is a positive integer. Show that the
volume of Tn is unbounded as n â†’âˆ, yet for all n, Tn has no interior and
four boundary lattice points. This example proves that Pickâ€™s theorem does
not hold for a three-dimensional integral polytope P, in the sense that there
is no linear relationship among vol P, LP(1), and LPâ—¦(1).
3.19. â™£Prove Lemma 3.24: If
X
tâ‰¥0
f(t) zt = g(z)
h(z) ,
then f is a quasipolynomial of degree d with period dividing p if and only if g
and h are polynomials such that deg(g) < deg(h), all roots of h are pth roots
of unity of multiplicity at most d + 1, and there is a root of multiplicity equal
to d + 1 (all of this assuming that g/h has been reduced to lowest terms).
3.20. â™£Provide the details for the proof of Theorem 3.23: If P is a rational
convex d-polytope, then LP(t) is a quasipolynomial in t of degree d. Its period
divides the least common multiple of the coordinates of the vertices of P.
3.21. Let T be the rational triangle with vertices (0, 0),

1, pâˆ’1
p

, and (p, 0),
where p is a ï¬xed integer â‰¥2. Show that LT (t) =
pâˆ’1
2
t2 + p+1
2 t + 1; in
particular, LT is a polynomial.
3.22. Prove that for any d â‰¥2 and any p â‰¥1, there exists a d-polytope P
whose Ehrhart quasipolynomial is a polynomial (i.e., it has period 1), yet P
has a vertex with denominator p.
3.23. Prove that the period of the Ehrhart quasipolynomial of a 1-dimensional
polytope is always equal to the lcm of the denominators of its vertices.
3.24. Let T be the triangle with vertices
 âˆ’1
2, âˆ’1
2

,
  1
2, âˆ’1
2

, and
 0, 3
2

. Show
that LT (t) = t2 + c(t) t + 1, where
c(t) =
(
1
if t is even,
0
if t is odd.
(This shows that the periods of the â€œcoeï¬ƒcientsâ€ of an Ehrhart quasipoly-
nomial do not necessarily increase with decreasing power.) Find the Ehrhart
series of T .
3.25. Prove the following extension of Theorem 3.12: Suppose P is a rational
d-polytope with denominator p. Then
EhrP(z) =
f(z)
(1 âˆ’zp)d+1 ,
where f is a polynomial with nonnegative integral coeï¬ƒcients.

Exercises
81
3.26. Find and prove a statement that extends Lemma 3.14 to Ehrhart qua-
sipolynomials.
3.27. Prove the following extension of Corollary 3.15 to rational polytopes.
Namely, the Ehrhart quasipolynomial LP of the rational convex polytope
P âŠ‚Rd satisï¬es LP(0) = 1.
3.28. Prove the following analogue of Corollary 3.17 for rational polytopes:
Suppose P is a rational polytope with Ehrhart quasipolynomial LP(t) =
cd(t) td + cdâˆ’1(t) tdâˆ’1 + Â· Â· Â· + c1(t) t + c0(t). Then for all t âˆˆZ and 0 â‰¤k â‰¤d,
we have d! ck(t) âˆˆZ.
3.29. â™£Prove that Corollary 3.20 also holds for rational polytopes: Sup-
pose P âŠ‚Rd is a rational convex d-polytope with Ehrhart quasipolynomial
cd(t) td + cdâˆ’1(t) tdâˆ’1 + Â· Â· Â· + c0(t). Then cd(t) equals the volume of P; in
particular, cd(t) is constant.
3.30. Suppose P is a rational convex polytope. Show that as rational func-
tions,
Ehr2P(z) = 1
2
 EhrP
 âˆšz

âˆ’EhrP
 âˆ’âˆšz

.
3.31. Suppose f and g are quasipolynomials. Prove that the convolution
F(t) :=
t
X
s=0
f(s) g(t âˆ’s)
is also a quasipolynomial. What can you say about the degree and the period
of F, given the degrees and periods of f and g?
3.32. Given two positive, relatively prime integers a and b, let
f(t) :=
(
1
if a|t,
0
otherwise,
and
g(t) :=
(
1
if b|t,
0
otherwise.
Form the convolution of f and g. What function is it?
3.33. Suppose P âŠ‚Rm and Q âŠ‚Rn are rational polytopes. Prove that the
convolution of LP and LQ equals the Ehrhart quasipolynomial of the polytope
given by the convex hull of P Ã— {0n} Ã— {0} and {0m} Ã— Q Ã— {1}. Here 0d
denotes the origin in Rd.
3.34. We deï¬ne the unimodular group SLd (Z) as the set of all dÃ—d matrices
with integer entries and determinant Â±1.
(a) Show that SLd (Z) acts on the integer lattice Zd as a one-to-one, onto
map. That is, ï¬x any A âˆˆSLd (Z). Then A maps Zd to itself in a bijective
fashion.

82
3 Counting Lattice Points in Polytopes: The Ehrhart Theory
(b) For any open simplex âˆ†â—¦âŠ‚Rd and any A âˆˆSLd (Z), consider the image
of âˆ†â—¦under A, deï¬ned by A (âˆ†â—¦) := {A x : x âˆˆâˆ†â—¦}. Show that
#

âˆ†â—¦âˆ©Zd	
= #

A (âˆ†â—¦) âˆ©Zd	
.
(c) Let P be an integral polytope, and let Q := A (P), where A âˆˆSLd (Z),
so that P and Q are unimodular images of each other. Show that LP(t) =
LQ(t). (Hint: Write P as the disjoint union of open simplices.)
3.35. Search on the Internet for the program LattE: Lattice-Point Enumera-
tion [66, 115]. You can download it for free. Experiment.
Open Problems
3.36. How many triangulations are there for a given polytope?
3.37. What is the minimal number of simplices needed to triangulate the unit
d-cube? (These numbers are known for d â‰¤7.)
3.38. Classify the polynomials of a ï¬xed degree d that are Ehrhart polyno-
mials. This is completely done for d = 2 [160] and partially known for d = 3
and 4 [24, Section 3].
3.39. Study the roots of Ehrhart polynomials of integral polytopes in a ï¬xed
dimension [24, 37, 42, 94]. Study the roots of the numerators of Ehrhart series.
3.40. Come up with an eï¬ƒcient algorithm that computes the period of an
Ehrhart quasipolynomial. (See [188], in which Woods describes an eï¬ƒcient
algorithm that checks whether a given integer is a period of an Ehrhart qua-
sipolynomial.)
3.41. Suppose P and Q are integer polytopes with the same Ehrhart poly-
nomial, that is, LP(t) = LQ(t). What additional conditions on P and Q do
we need to ensure that integer translates of P and Q are unimodular images
of each other? That is, when is Q = A (P) + m for some A âˆˆSLd (Z) and
m âˆˆZd?
3.42. Find an â€œEhrhart theoryâ€ for irrational polytopes.

4
Reciprocity
In mathematics you donâ€™t understand things. You just get used to them.
John von Neumann (1903â€“1957)
While Exercise 1.4 (i) gave us the elementary identity
t âˆ’1
a

= âˆ’
âˆ’t
a

âˆ’1
(4.1)
for t âˆˆZ and a âˆˆZ>0, this fact is a special instance of a more general theme.
Namely, (4.1) marks the simplest (one-dimensional) case of a reciprocity the-
orem that is central to Ehrhart theory. Let I := [0, 1/a] âŠ‚R, a rational
0
t
a
Fig. 4.1. Lattice points in tI.
1-polytope (see Figure 4.1). Its discrete volume is (recalling Exercise 1.3)
LI(t) =
 t
a

+ 1 .
The lattice-point enumerator for the interior Iâ—¦= (0, 1/a), on the other hand,
is
LIâ—¦(t) =
t âˆ’1
a

(4.2)
(see Exercise 4.1). The identity (4.1) says that algebraically,
LIâ—¦(t) = âˆ’LI(âˆ’t) .

84
4 Reciprocity
This chapter is devoted to proving that a similar identity holds for rational
polytopes in any dimension:
Theorem 4.1 (Ehrhartâ€“Macdonald reciprocity). Suppose P is a convex
rational polytope. Then the evaluation of the quasipolynomial LP at negative
integers yields
LP(âˆ’t) = (âˆ’1)dim PLPâ—¦(t) .
This theorem belongs to a class of famous reciprocity theorems. A common
theme in combinatorics is to begin with an interesting object P, and
1. deï¬ne a counting function f(t) attached to P that makes physical sense
for positive integer values of t;
2. recognize the function f as a polynomial in t;
3. substitute negative integral values of t into the counting function f, and
recognize f(âˆ’t) as a counting function of a new mathematical object Q.
For us, P is the closure of a polytope and Q is its interior.
4.1 Generating Functions for Somewhat Irrational Cones
Our approach to proving Theorem 4.1 parallels the steps of Chapter 3: we
deduce Theorem 4.1 from an identity for rational cones. We start with a
reciprocity theorem for simplicial cones.
Theorem 4.2. Fix linearly independent vectors w1, w2, . . . , wd âˆˆZd, and let
K = {Î»1w1 + Î»2w2 + Â· Â· Â· + Î»dwd : Î»1, . . . , Î»d â‰¥0}, the simplicial cone gener-
ated by the wjâ€™s. Then for those v âˆˆRd for which the boundary of the shifted
simplicial cone v + K contains no integer point,
Ïƒv+K
 1
z1
, 1
z2
, . . . , 1
zd

= (âˆ’1)d Ïƒâˆ’v+K (z1, z2, . . . , zd) .
Remark. This theorem is meaningless on the level of formal power series;
however, the identity holds at the level of rational functions. We will establish
that Ïƒv+K is a rational function in the process of proving the theorem.
Proof. As in the proofs of Theorem 3.5 and Corollary 3.6, we have the formula
Ïƒv+K(z) =
Ïƒv+Î (z)
(1 âˆ’zw1) (1 âˆ’zw2) Â· Â· Â· (1 âˆ’zwd) ,
where Î  is the open parallelepiped
Î  = {Î»1w1 + Î»2w2 + Â· Â· Â· + Î»dwd : 0 < Î»1, Î»2, . . . , Î»d < 1} .
(4.3)
This also proves that Ïƒv+K is a rational function. Note that by assumption,
v + Î  contains no integer points on its boundary. Naturally,

4.1 Generating Functions for Somewhat Irrational Cones
85
Ïƒâˆ’v+K(z) =
Ïƒâˆ’v+Î (z)
(1 âˆ’zw1) (1 âˆ’zw2) Â· Â· Â· (1 âˆ’zwd) ,
so we need to relate the parallelepipeds v + Î  and âˆ’v + Î . This relation is
illustrated in Figure 4.2 for the case d = 2; the identity for general d is (see
Exercise 4.2)
v + Î  = âˆ’(âˆ’v + Î ) + w1 + w2 + Â· Â· Â· + wd .
(4.4)
Now we translate the geometry of (4.4) into generating functions:
v
w1
w2
v + Î 
âˆ’v + Î 
âˆ’(âˆ’v + Î )
âˆ’(âˆ’v + Î ) + w1 + w2
Fig. 4.2. From âˆ’v + Î  to v + Î .
Ïƒv+Î (z) = Ïƒâˆ’(âˆ’v+Î )(z) zw1zw2 Â· Â· Â· zwd
= Ïƒâˆ’v+Î 

1
z1 , 1
z2 , . . . , 1
zd

zw1zw2 Â· Â· Â· zwd
(the last equation follows from Exercise 3.6). Letâ€™s abbreviate the vector

1
z1 , 1
z2 , . . . , 1
zd

by 1
z. Then the last identity is equivalent to
Ïƒv+Î 
1
z

= Ïƒâˆ’v+Î (z) zâˆ’w1zâˆ’w2 Â· Â· Â· zâˆ’wd,
whence

86
4 Reciprocity
Ïƒv+K
1
z

=
Ïƒv+Î 
  1
z

(1 âˆ’zâˆ’w1) (1 âˆ’zâˆ’w2) Â· Â· Â· (1 âˆ’zâˆ’wd)
=
Ïƒâˆ’v+Î (z) zâˆ’w1zâˆ’w2 Â· Â· Â· zâˆ’wd
(1 âˆ’zâˆ’w1) (1 âˆ’zâˆ’w2) Â· Â· Â· (1 âˆ’zâˆ’wd)
=
Ïƒâˆ’v+Î (z)
(zw1 âˆ’1) (zw2 âˆ’1) Â· Â· Â· (zwd âˆ’1)
= (âˆ’1)d
Ïƒâˆ’v+Î (z)
(1 âˆ’zw1) (1 âˆ’zw2) Â· Â· Â· (1 âˆ’zwd)
= (âˆ’1)d Ïƒâˆ’v+K(z) .
âŠ“âŠ”
4.2 Stanleyâ€™s Reciprocity Theorem for Rational Cones
For the general reciprocity theorem for cones, we patch the simplicial cones of a
triangulation together, in a manner very similar to our proof of Theorem 3.12.
Theorem 4.3 (Stanley reciprocity). Suppose K is a rational d-cone with
the origin as apex. Then
ÏƒK
 1
z1
, 1
z2
, . . . , 1
zd

= (âˆ’1)d ÏƒKâ—¦(z1, z2, . . . , zd) .
Proof. Triangulate K into the simplicial cones K1, K2, . . . , Km. Now Exer-
cise 3.14 ensures that there exists a vector v âˆˆRd such that the shifted cone
v + K contains exactly the interior lattice points of K,
Kâ—¦âˆ©Zd = (v + K) âˆ©Zd,
(4.5)
and there are no boundary lattice points on any of the triangulation cones:
âˆ‚(v + Kj) âˆ©Zd = âˆ…
for all j = 1, . . . , m,
(4.6)
as well as
âˆ‚(âˆ’v + Kj) âˆ©Zd = âˆ…
for all j = 1, . . . , m.
(4.7)
We invite the reader (Exercise 4.3) to realize that (4.5)â€“(4.7) imply
K âˆ©Zd = (âˆ’v + K) âˆ©Zd.
(4.8)
Now by Theorem 4.2,
ÏƒK
  1
z

= Ïƒâˆ’v+K
  1
z

=
m
X
j=1
Ïƒâˆ’v+Kj
  1
z

=
m
X
j=1
(âˆ’1)d Ïƒv+Kj (z)
= (âˆ’1)d Ïƒv+K (z) = (âˆ’1)d ÏƒKâ—¦(z) .
Note that the second and fourth equalities are true because of the validity of
(4.7) and (4.6), respectively.
âŠ“âŠ”

4.3 Ehrhartâ€“Macdonald Reciprocity for Rational Polytopes
87
4.3 Ehrhartâ€“Macdonald Reciprocity for Rational
Polytopes
In preparation for the proof of Theorem 4.1, we deï¬ne the Ehrhart series
for the interior of the rational polytope P as
EhrPâ—¦(z) :=
X
tâ‰¥1
LPâ—¦(t) zt.
Our convention of beginning the series with t = 1 stems from the fact that
this generating function is a special evaluation of the integer-point transform
of the open cone (cone(P))â—¦: Much in sync with Lemma 3.10, we have
EhrPâ—¦(z) = Ïƒ(cone(P))â—¦(1, 1, . . . , 1, z) .
(4.9)
We are now ready to prove the Ehrhart-series analogue of Theorem 4.1.
Theorem 4.4. Suppose P is a convex rational polytope. Then the evaluation
of the rational function EhrP at 1/z yields
EhrP
1
z

= (âˆ’1)dim P+1 EhrPâ—¦(z) .
Proof. Suppose P is a d-polytope. We recall Lemma 3.10, which states that
the generating function of the Ehrhart polynomial of P is an evaluation of
the generating function of cone(P):
EhrP(z) =
X
tâ‰¥0
LP(t) zt = Ïƒcone(P) (1, 1, . . . , 1, z) .
Equation (4.9) above gives the analogous evaluation of Ïƒ(cone(P))â—¦that yields
EhrPâ—¦. Now we apply Theorem 4.3 to the (d + 1)-cone K = cone(P):
Ïƒ(cone(P))â—¦(1, 1, . . . , 1, z) = (âˆ’1)d+1 Ïƒcone(P)

1, 1, . . . , 1, 1
z

.
âŠ“âŠ”
Theorem 4.1 now follows like a breeze.
Proof of Ehrhartâ€“Macdonald reciprocity (Theorem 4.1). We ï¬rst apply Exer-
cise 4.5 to the Ehrhart series of P: namely, as rational functions,
EhrP
1
z

=
X
tâ‰¤0
LP(âˆ’t) zt = âˆ’
X
tâ‰¥1
LP(âˆ’t) zt.
Now we combine this identity with Theorem 4.4 to obtain
X
tâ‰¥1
LPâ—¦(t) zt = (âˆ’1)d+1 EhrP
1
z

= (âˆ’1)d X
tâ‰¥1
LP(âˆ’t) zt.
Comparing the coeï¬ƒcients of the two power series yields the reciprocity the-
orem.
âŠ“âŠ”

88
4 Reciprocity
With Ehrhartâ€“Macdonald reciprocity, we can now restate Theorem 3.18
in terms of Ehrhart polynomials:
Theorem 4.5. Suppose P is an integral d-polytope with Ehrhart series
EhrP(z) = hd zd + hdâˆ’1 zdâˆ’1 + Â· Â· Â· + h1 z + 1
(1 âˆ’z)d+1
.
Then hd = hdâˆ’1 = Â· Â· Â· = hk+1 = 0 and hk Ì¸= 0 if and only if (d âˆ’k + 1)P is
the smallest integer dilate of P that contains an interior lattice point.
Proof. Theorem 3.18 says that hk is the highest nonzero coeï¬ƒcient if and only
if LP(âˆ’1) = LP(âˆ’2) = Â· Â· Â· = LP (âˆ’(d âˆ’k)) = 0 and LP (âˆ’(d âˆ’k + 1)) Ì¸= 0.
Now use Ehrhartâ€“Macdonald reciprocity (Theorem 4.1).
âŠ“âŠ”
The largest k for which hk Ì¸= 0 is called the degree of P. The above
theorem says that the degree of P is k precisely if (d âˆ’k + 1)P is the smallest
integer dilate of P that contains an interior lattice point.
4.4 The Ehrhart Series of Reï¬‚exive Polytopes
As an application of Theorem 4.4, we now study a special class of integral
polytopes whose Ehrhart series have an additional symmetry structure. We
call a polytope P that contains the origin in its interior reï¬‚exive if it is
integral and has the half-space description
P =

x âˆˆRd : A x â‰¤1
	
,
where A is an integral matrix. (Here 1 denotes a vector all of whose co-
ordinates are 1.) The following theorem gives a characterization of reï¬‚exive
polytopes through their Ehrhart series.
Theorem 4.6 (Hibiâ€™s palindromic theorem). Suppose P is an integral
d-polytope that contains the origin in its interior and that has the Ehrhart
series
EhrP(z) = hd zd + hdâˆ’1 zdâˆ’1 + Â· Â· Â· + h1 z + h0
(1 âˆ’z)d+1
.
Then P is reï¬‚exive if and only if hk = hdâˆ’k for all 0 â‰¤k â‰¤d
2.
The two main ingredients for the proof of this result are Theorem 4.4 and
the following:
Lemma 4.7. Suppose a1, a2, . . . , ad, b âˆˆZ satisfy gcd (a1, a2, . . . , ad, b) = 1
and b > 1. Then there exist positive integers c and t such that tb < c < (t+1)b
and

(m1, m2, . . . , md) âˆˆZd : a1m1 + a2m2 + Â· Â· Â· + admd = c
	
Ì¸= âˆ….

4.4 The Ehrhart Series of Reï¬‚exive Polytopes
89
Proof. Let g = gcd (a1, a2, . . . , ad); by our assumption, gcd(g, b) = 1, so one
can ï¬nd integers k and t such that
kg âˆ’tb = 1 .
(4.10)
Furthermore, we can choose k and t in such a way that t > 0. Let c = kg;
equation (4.10) and the condition b > 1 imply that tb < c < (t + 1)b. Finally,
since g = gcd (a1, a2, . . . , ad) there exist m1, m2, . . . , md âˆˆZ such that
a1m1 + a2m2 + Â· Â· Â· + admd = kg = c .
âŠ“âŠ”
Proof of Theorem 4.6. We recall that P is reï¬‚exive if and only if
P =

x âˆˆRd : A x â‰¤1
	
for some integral matrix A.
(4.11)
We claim that P has such a half-space description if and only if
Pâ—¦âˆ©Zd = {0}
and for all t âˆˆZ>0, (t + 1)Pâ—¦âˆ©Zd = tP âˆ©Zd.
(4.12)
This condition means that the only lattice points that we gain when pass-
ing from tP to (t + 1)P are those on the boundary of (t + 1)P. The fact
that (4.11) implies (4.12) is the content of Exercise 4.11. Conversely, if P
satisï¬es (4.12) then there are no lattice points between tH and (t + 1)H for
any facet hyperplane H of P (Exercise 4.12). That is, if a facet hyperplane
is given by H =

x âˆˆRd : a1x1 + a2x2 + Â· Â· Â· + adxd = b
	
, where we may as-
sume gcd (a1, a2, . . . , ad, b) = 1, then

x âˆˆZd : tb < a1x1 + a2x2 + Â· Â· Â· + adxd < (t + 1)b
	
= âˆ….
But then Lemma 4.7 implies that b = 1, and so P has a half-space description
of the form (4.11).
Thus we have established that P is reï¬‚exive if and only if it satisï¬es (4.12).
Now by Theorem 4.4,
EhrPâ—¦(z) = (âˆ’1)d+1 EhrP
1
z

= h0 zd+1 + h1 zd + Â· Â· Â· + hdâˆ’1 z2 + hd z
(1 âˆ’z)d+1
.
By condition (4.12), P is reï¬‚exive if and only if this rational function is equal
to
X
tâ‰¥1
LP(t âˆ’1) zt = z
X
tâ‰¥0
LP(t) zt = z EhrP(z)
= hd zd+1 + hdâˆ’1 zd + Â· Â· Â· + h1 z2 + h0 z
(1 âˆ’z)d+1
,
that is, if and only if hk = hdâˆ’k for all 0 â‰¤k â‰¤d
2.
âŠ“âŠ”

90
4 Reciprocity
4.5 More â€œReï¬‚ectionsâ€ on the Coin-Exchange Problem
and the Gallery of Chapter 2
We have already encountered special cases of Ehrhartâ€“Macdonald reciprocity
several times. Note that Theorem 4.1 allows us to conclude that counting
the number of interior lattice points in a rational polytope is tantamount to
counting lattice points in its closure. Exercises 1.31, 2.1, and 2.7, as well as
part (b) of each theorem in the gallery of Chapter 2, conï¬rm that
LP(âˆ’t) = (âˆ’1)dim PLPâ—¦(t) .
Notes
1. Ehrhartâ€“Macdonald reciprocity (Theorem 4.1) had been conjectured (and
proved in several special cases) by Eug`ene Ehrhart for about a decade before
I. G. Macdonald found a general proof in 1971 [123]. One can actually relax the
condition of Ehrhartâ€“Macdonald reciprocity: it holds for polytopal complexes
that are homeomorphic to a d-manifold. The proof we give here (including
the proof of Theorem 4.3) appeared in [30].
2. Theorem 4.3 is due to Richard Stanley [169], who proved more general
versions of this theorem. The reader might recall that the rational function
representing the Ehrhart series of a rational cone can be thought of as its
meromorphic continuation. Stanley reciprocity (Theorem 4.3) gives a func-
tional identity for such meromorphic continuations.
3. The term reï¬‚exive polytope was coined by Victor Batyrev, who found ex-
citing applications of these polytopes to mirror symmetry in physical string
theory [16]. Batyrev proved that the toric variety XP deï¬ned by a reï¬‚exive
polytope P is Fano, and that every generic hypersurface of XP is Calabiâ€“Yau.
That the Ehrhart series of a reï¬‚exive polytope exhibits an unexpected sym-
metry (Theorem 4.6) was discovered by Takayuki Hibi [97]. The number of
reï¬‚exive polytopes in dimension d is known for d â‰¤4 [117, 118]; for example,
there are precisely 16 reï¬‚exive polytopes in dimension 2, up to symmetries
(see also [165, Sequence A090045]). A striking result is that the sum of the
numbers of lattice points on the boundaries of a reï¬‚exive polygon and its dual
is always 12 [147]. A similar result holds in dimension 3 (with 12 replaced by
24) [18], but no elementary proof of the latter fact is known [22, Section 4].
4. There is an equivalent deï¬nition for reï¬‚exive polytopes: P is reï¬‚exive
if and only if both P and its dual Pâˆ—are integral polytopes. The dual
polytope of P (often also called the polar polytope) is deï¬ned as Pâˆ—:=

x âˆˆRd : x Â· y â‰¤1 for all y âˆˆP
	
. The concept of (polar) duality is not con-
ï¬ned to polytopes but can be deï¬ned for any nonempty subset of Rd. Duality

Exercises
91
is a crucial chapter in the theory of polytopes, and one of its applications is
the equivalence of the vertex and hyperplane description of a polytope. For
more about (polar) duality, the reader might consult [12, Chapter IV].
5. The cross-polytopes 3 from Section 2.5 form a special class of reï¬‚exive
polytopes. We mentioned in the Notes of Chapter 2 that the roots of the
Ehrhart polynomials L3 all have real part âˆ’1
2 [51, 109]. Christian Bey, Martin
Henk, and JÂ¨org Wills proved in [37] that if all roots of LP, for some integral
polytope P, have real part âˆ’1
2, then P is the unimodular image of a reï¬‚exive
polytope.
Exercises
4.1. â™£Prove (4.2): For a âˆˆZ>0, L(0,1/a)(t) =
t âˆ’1
a

.
4.2. â™£Explain (4.4): If w1, w2, . . . , wd âˆˆRd are linear independent and
Î  = {Î»1w1 + Î»2w2 + Â· Â· Â· + Î»dwd : 0 < Î»1, Î»2, . . . , Î»d < 1} ,
then v + Î  = âˆ’(âˆ’v + Î ) + w1 + w2 + Â· Â· Â· + wd .
4.3. â™£Prove that (4.5)â€“(4.7) imply (4.8); that is, if K is a rational pointed
d-cone K with the origin as apex, and v âˆˆRd is such that
Kâ—¦âˆ©Zd = (v + K) âˆ©Zd,
âˆ‚(v + Kj) âˆ©Zd = âˆ…
for all j = 1, . . . , m,
and
âˆ‚(âˆ’v + Kj) âˆ©Zd = âˆ…
for all j = 1, . . . , m,
then
K âˆ©Zd = (âˆ’v + K) âˆ©Zd.
4.4. Prove the following generalization of Theorem 4.3 to rational pointed
cones with arbitrary apex: Suppose K is a rational pointed d-cone K with the
origin as apex, and v âˆˆRd. Then the integer-point transform Ïƒv+K(z) of the
pointed d-cone v + K is a rational function that satisï¬es
Ïƒv+K
1
z

= (âˆ’1)dÏƒ(âˆ’v+K)â—¦(z) .
4.5. â™£Suppose Q: Z â†’C is a quasipolynomial. We know that R+
Q(z) :=
P
tâ‰¥0 Q(t) zt evaluates to a rational function.

92
4 Reciprocity
(a) Prove that Râˆ’
Q(z) := P
t<0 Q(t) zt also evaluates to a rational function.
(b) Let Q(t) = 1. Prove that as rational functions, R+
Q(z) + Râˆ’
Q(z) = 0.
(c) Suppose Q is a polynomial. Prove that as rational functions, R+
Q(z) +
Râˆ’
Q(z) = 0.
(d) Suppose Q is a quasipolynomial. Prove that as rational functions, R+
Q(z)+
Râˆ’
Q(z) = 0.
4.6. â™£Suppose that P is a rational d-polytope for which
LPâ—¦(t) = LP(t âˆ’k)
and
LPâ—¦(1) = LPâ—¦(2) = Â· Â· Â· = LPâ—¦(k âˆ’1) = 0
for some integer k. (This situation applies to some of the polytopes in the
gallery of Chapter 2.) Prove that
EhrP
1
z

= (âˆ’1)d+1zk EhrP(z) .
4.7. Suppose P is an integral d-polytope with Ehrhart series
EhrP(z) = hd zd + hdâˆ’1 zdâˆ’1 + Â· Â· Â· + h1 z + 1
(1 âˆ’z)d+1
.
Prove that hd = LPâ—¦(1).
4.8. Suppose P is a convex integral d-polytope. Show that the dilate (d+1)P
contains an interior lattice point.
4.9. Suppose P is a convex integral polytope. Denote the boundary of P by
âˆ‚P. Prove that Lâˆ‚P(t) is a polynomial that is either even or odd. Determine
its constant term.
4.10. Recall the restricted partition function
p{a1,a2,...,an}(t) := #

(m1, . . . , md) âˆˆZd
â‰¥0 : m1a1 + Â· Â· Â· + mdad = t
	
from Chapter 1. Prove that as quasipolynomials,
p{a1,a2,...,an}(âˆ’t âˆ’a1 âˆ’a2 âˆ’Â· Â· Â· âˆ’an) = (âˆ’1)nâˆ’1 p{a1,a2,...,an}(t)
and that
p{a1,a2,...,an}(âˆ’1) = p{a1,a2,...,an}(âˆ’2) = Â· Â· Â·
= p{a1,a2,...,an}(âˆ’a1 âˆ’a2 âˆ’Â· Â· Â· âˆ’an + 1) = 0 .
4.11. â™£Prove that (4.11) implies (4.12), that is, show that if the polytope P
is given by P =

x âˆˆRd : A x â‰¤1
	
for an integral matrix A, then Pâ—¦âˆ©Zd =
{0} and for all t âˆˆZ>0, (t + 1)Pâ—¦âˆ©Zd = tP âˆ©Zd.
4.12. â™£Suppose P is an integral polytope that satisï¬es (4.12): Pâ—¦âˆ©Zd = {0}
and for all t âˆˆZ>0, (t + 1)Pâ—¦âˆ©Zd = tP âˆ©Zd. Then for any t âˆˆZ, there are
no lattice points between tH and (t + 1)H for any facet hyperplane H of P.

Open Problems
93
Open Problems
4.13. Prove the following conjecture of Batyrev [17]: For an integer polytope
P of degree j, the volume of P is bounded by a constant that depends only
on hj.
4.14. Suppose P is a 3-dimensional reï¬‚exive polytope. Denote by eâˆ—the edge
in the dual polytope Pâˆ—that corresponds to the edge e in P. Give an elemen-
tary proof that
X
e edge of P
length (e) Â· length (eâˆ—) = 24 .
4.15. Find the number of reï¬‚exive polytopes in dimension d â‰¥5.


5
Face Numbers and the Dehnâ€“Sommerville
Relations in Ehrhartian Terms
â€œData! Data! Data!â€ he cried, impatiently. â€œI canâ€™t make bricks without clay.â€
Sherlock Holmes (â€œThe Adventure of the Copper Beeches,â€ by Arthur Conan Doyle,
1859â€“1930)
Our goal in this chapter is twofold, or rather, there is one goal in two diï¬€erent
guises. The ï¬rst one is to prove a set of fascinating identities, which give
linear relations among the face numbers fk. They are called Dehnâ€“Sommerville
relations, in honor of their discoverers Max Wilhelm Dehn (1878â€“1952)1 and
Duncan MacLaren Young Sommerville (1879â€“1934).2 Our second goal is to
unify the Dehnâ€“Sommerville relations (Theorem 5.1 below) with Ehrhartâ€“
Macdonald reciprocity (Theorem 4.1).
5.1 Face It!
We denote the number of k-dimensional faces of P by the symbol fk. As k
varies from 0 to d, the face numbers fk encode intrinsic information about
the polytope P.
The d-polytope P is simple if each vertex of P lies on
precisely d edges of P.
Theorem 5.1 (Dehnâ€“Sommerville relations). If P is a simple d-polytope
and 0 â‰¤k â‰¤d, then
fk =
k
X
j=0
(âˆ’1)j
d âˆ’j
d âˆ’k

fj .
1 For more information about Dehn, see
http://www-groups.dcs.st-and.ac.uk/âˆ¼history/Biographies/Dehn.html.
2 For more information about Sommerville, see
http://www-groups.dcs.st-and.ac.uk/âˆ¼history/Biographies/Sommerville.html.

96
5 Face Numbers and the Dehnâ€“Sommerville Relations in Ehrhartian Terms
This theorem takes on a particularly nice form for k = d, namely the
famous Euler relation, which holds for any polytope (not just simple ones).
Theorem 5.2 (Euler relation). If P is a convex d-polytope, then
d
X
j=0
(âˆ’1)jfj = 1 .
This identity is less trivial than it might look. We give a quick proof
for rational polytopes, for which we can use Ehrhartâ€“Macdonald reciprocity
(Theorem 4.1).
Proof of Theorem 5.2, assuming P is rational. Let us count the integer points
in tP according to the (relatively) open faces that contain them:3
LP(t) =
X
FâŠ†P
LFâ—¦(t) =
X
FâŠ†P
(âˆ’1)dim FLF(âˆ’t) .
Here, and in the remainder of this chapter, the sums are over all nonempty
faces. (Alternatively, we could agree that Lâˆ…(t) = 0.) The constant term of
LF(t) is 1, for any face F (by Exercise 3.27). Hence the constant terms of the
identity above give
1 =
X
FâŠ†P
(âˆ’1)dim F =
d
X
j=0
(âˆ’1)jfj ,
which proves our claim.
âŠ“âŠ”
There is a natural structure on the faces of a polytope P induced by the
containment relation F âŠ†G. This relation gives a partial ordering on the set
of all faces of P, called the face lattice of P.4 A useful way to illustrate
this partially ordered set is through a graph whose nodes correspond to the
faces of P, such that two nodes are adjacent if one of their corresponding
faces contains the other. In Figure 5.1, we give the face lattice for a triangle.
Exercise 2.6 implies that the face lattice of any simplex is a Boolean lattice,
which is the partially ordered set formed by all subsets of a ï¬nite set, where
the partial ordering is again subset containment.
We already mentioned that we will unify the Dehnâ€“Sommerville relations
(Theorem 5.1) with Ehrhartâ€“Macdonald reciprocity (Theorem 4.1). It is for
this reason that we will prove Theorem 5.1 only for rational polytopes. To
combine the notions of face numbers and lattice-point enumeration, we deï¬ne
3 Note that the relative interior of a vertex is the vertex itself.
4 The usage of the word lattice here is disjoint from our previous deï¬nition of the
word.

5.2 Dehnâ€“Sommerville Extended
97
v1
v2
v3
E1
E2
E3
âˆ…
v1
v2
v3
E3
E2
E1
âˆ†
Fig. 5.1. The face lattice of a triangle.
Fk(t) :=
X
FâŠ†P
dim F=k
LF(t) ,
the sum being taken over all k-faces of P. By Ehrhartâ€™s theorem (Theo-
rem 3.23), Fk is a quasipolynomial. Since LF(0) = 1 for all F,
Fk(0) = fk ,
the number of k-faces of P. We also remark that the leading coeï¬ƒcient of Fk
measures the relative volume of the k-skeleton of P, that is, the union of all
k-faces; see Section 5.4 for a precise deï¬nition of relative volume.
Our common extension of Theorems 5.1 and 4.1 is the subject of the next
section.
5.2 Dehnâ€“Sommerville Extended
Theorem 5.3. If P is a simple rational d-polytope and 0 â‰¤k â‰¤d, then
Fk(t) =
k
X
j=0
(âˆ’1)j
d âˆ’j
d âˆ’k

Fj(âˆ’t) .
The classical Dehnâ€“Sommerville equations (Theorem 5.1)â€”again, only for
rational polytopesâ€”are obtained from the constant terms of the counting
functions on both sides of the identity. On the other hand, for k = d, Theo-
rem 5.3 gives (with t replaced by âˆ’t)
LP(âˆ’t) = Fd(âˆ’t) =
d
X
j=0
(âˆ’1)jFj(t) = (âˆ’1)d
d
X
j=0
(âˆ’1)dâˆ’jFj(t) .
The sum on the right-hand side is an inclusionâ€“exclusion formula for the
number of lattice points in the interior of tP (count all the points in P,
subtract the ones on the facets, add back what youâ€™ve overcounted, etc.), so
in a sense we recover Ehrhartâ€“Macdonald reciprocity.

98
5 Face Numbers and the Dehnâ€“Sommerville Relations in Ehrhartian Terms
Proof. Suppose F is a k-face of P. Then, again by counting the integer points
in F according to relatively open faces of F,
LF(t) =
X
GâŠ†F
LGâ—¦(t) ,
or, by the Ehrhartâ€“Macdonald reciprocity (Theorem 4.1),
LF(t) =
X
GâŠ†F
(âˆ’1)dim GLG(âˆ’t) =
k
X
j=0
(âˆ’1)j
X
GâŠ†F
dim G=j
LG(âˆ’t) .
(5.1)
Now sum both left- and right-hand sides over all k-faces and rearrange the
sum on the right-hand side:
Fk(t) =
X
FâŠ†P
dim F=k
k
X
j=0
(âˆ’1)j
X
GâŠ†F
dim G=j
LG(âˆ’t)
=
k
X
j=0
(âˆ’1)j
X
FâŠ†P
dim F=k
X
GâŠ†F
dim G=j
LG(âˆ’t)
=
k
X
j=0
(âˆ’1)j
X
GâŠ†P
dim G=j
fk(P/G)LG(âˆ’t)
=
k
X
j=0
(âˆ’1)j
X
GâŠ†P
dim G=j
d âˆ’j
d âˆ’k

LG(âˆ’t)
=
k
X
j=0
(âˆ’1)j
d âˆ’j
d âˆ’k

Fj(âˆ’t) .
Here fk(P/G) denotes the number of k-faces of P containing a given j-face G
of P. Since P is simple, this number equals
 dâˆ’j
dâˆ’k

(see Exercise 5.4).
âŠ“âŠ”
5.3 Applications to the Coeï¬ƒcients of an Ehrhart
Polynomial
We will now apply Theorem 5.3 to the computation of the Ehrhart polynomial
of an integral d-polytope P. The only face-lattice-point enumerator involving
the face P is Fd(t), for which Theorem 5.3 specializes to
LP(t) = Fd(t) =
d
X
j=0
(âˆ’1)jFj(âˆ’t) .

5.3 Applications to the Coeï¬ƒcients of an Ehrhart Polynomial
99
In fact, we do not have to assume that P is simple, since this identity simply
counts integer points by faces. (Recall that (âˆ’1)jFj(âˆ’t) counts the integer
points in the t-dilates of the interior of the j-faces.)5 The last term on the
right-hand side is
(âˆ’1)dFd(âˆ’t) = (âˆ’1)dLP(âˆ’t) = LPâ—¦(t)
by Ehrhartâ€“Macdonald reciprocity. Shifting this term to the left gives
LP(t) âˆ’LPâ—¦(t) =
dâˆ’1
X
j=0
(âˆ’1)jFj(âˆ’t) .
(5.2)
The diï¬€erence on the left-hand side of this identity has a natural interpre-
tation: it counts the integer points on the boundary of tP. (And in fact, the
right-hand side is once more an inclusionâ€“exclusion formula for this num-
ber.) Let us write LP(t) = cd td + cdâˆ’1 tdâˆ’1 + Â· Â· Â· + c0. Then LPâ—¦(t) =
cd td âˆ’cdâˆ’1 tdâˆ’1 + Â· Â· Â· + (âˆ’1)dc0, so that
LP(t) âˆ’LPâ—¦(t) = 2cdâˆ’1 tdâˆ’1 + 2cdâˆ’3 tdâˆ’3 + Â· Â· Â· ,
where this sum ends with 2c0 if d is odd and 2c1t if d is even (this should
look familiar; see Exercise 4.9). Combining this expression with (5.2) yields
the following useful result.
Theorem 5.4. Suppose LP(t) = cd td + cdâˆ’1 tdâˆ’1 + Â· Â· Â· + c0 is the Ehrhart
polynomial of P. Then
cdâˆ’1 tdâˆ’1 + cdâˆ’3 tdâˆ’3 + Â· Â· Â· = 1
2
dâˆ’1
X
j=0
(âˆ’1)jFj(âˆ’t) .
âŠ“âŠ”
We can make the statement of this theorem more precise (but also more
messy) by writing
Fj(t) =
X
FâŠ†P
dim F=j
LF(t) = cj,j tj + cj,jâˆ’1tjâˆ’1 + Â· Â· Â· + cj,0 .
Then collecting the coeï¬ƒcients of tk in Theorem 5.4 yields the following rela-
tions.
Corollary 5.5. If k and d are of diï¬€erent parity, then
ck = 1
2
dâˆ’1
X
j=0
(âˆ’1)j+kcj,k .
âŠ“âŠ”
5 So one might argue that we did not need the Dehnâ€“Sommerville machinery for
the computations in the current section. This argument is correct, although The-
orem 5.3 is a strong motivation.

100
5 Face Numbers and the Dehnâ€“Sommerville Relations in Ehrhartian Terms
If k and d have the same parity, then the left-hand side has to be replaced
by 0.
The ï¬rst coeï¬ƒcient ck in the Ehrhart polynomial of a d-polytope P satis-
fying the parity condition is cdâˆ’1. In this case Corollary 5.5 tells us that cdâˆ’1
equals 1
2 times the sum of the leading terms of the Ehrhart polynomials of
the facets of P.
The next interesting coeï¬ƒcient is cdâˆ’3. For example, if dim P = 4, we can
use Corollary 5.5 to compute c1 entirely from (the linear coeï¬ƒcients of) the
Ehrhart polynomials of the faces of dimension â‰¤3.
5.4 Relative Volume
Itâ€™s time to return to continuous volume. Recall Lemma 3.19: if S âŠ‚Rd is
d-dimensional, then vol S = limtâ†’âˆ1
td Â· #
 tS âˆ©Zd
. Back in Chapter 3, we
stressed the importance of S being d-dimensional, because otherwise (i.e., S
is lower-dimensional although living in d-space), by our deï¬nition vol S = 0.
However, the case that S âŠ‚Rd is not of dimension d is often very in-
teresting; an example is the polytope P that we encountered in connec-
tion with the coin-exchange problem in Chapter 1. We still would like to
compute the volume of such objects, in the relative sense. This makes for
a slight complication. Letâ€™s say S âŠ‚Rd is of dimension m < d, and let
span S = {x + Î»(y âˆ’x) : x, y âˆˆS, Î» âˆˆR}, the aï¬ƒne span of S. If we follow
the same procedure as above (counting boxes or grid points), we compute
the volume relative to the sublattice (span S) âˆ©Zd; we call this the relative
volume of S.
For example, the line segment L from (0, 0) to (4, 2) in R2 has the relative
volume 2, because in span L =

(x, y) âˆˆR2 : y = x/2
	
, L is covered by two
segments of â€œunit lengthâ€ in this aï¬ƒne subspace, as pictured in Figure 5.2. A
three-dimensional instance that should be reminiscent of Chapter 1 is illus-
trated in Figure 5.3.
(0, 0)
(4, 2)
Fig. 5.2. The line segment from (0, 0) to (4, 2) and its aï¬ƒne sublattice.

5.4 Relative Volume
101
2
20
5
x
y
z
Fig. 5.3. The triangle deï¬ned by x
5 +
y
20 + z
2 = 1, x â‰¥0, y â‰¥0, z â‰¥0. The shaded
region is a fundamental domain for the sublattice that lies on the aï¬ƒne span of the
triangle.
If S âŠ†Rd has full dimension d, the relative volume coincides with the
â€œfull-dimensionalâ€ volume. Henceforth, when we write vol S we refer to the
relative volume of S. With this convention we can rewrite Lemma 3.19 to
accommodate a set S âŠ‚Rd that is m-dimensional: its relative volume can be
computed as
vol S = lim
tâ†’âˆ
1
tm Â· #
 tS âˆ©Zd
.
In the case that #
 tS âˆ©Zd
has the special form of a polynomialâ€”for
example, if S is an integral polytopeâ€”we can further simplify this theorem.
Suppose P âŠ‚Rd is an integral m-polytope with Ehrhart polynomial
LP(t) = cm tm + cmâˆ’1 tmâˆ’1 + Â· Â· Â· + c1 t + 1 .
Then, according to the above discussion, and much in sync with Lemma 3.19,

102
5 Face Numbers and the Dehnâ€“Sommerville Relations in Ehrhartian Terms
vol P = lim
tâ†’âˆ
1
tm LP(t) = lim
tâ†’âˆ
cm tm + cmâˆ’1 tmâˆ’1 + Â· Â· Â· + c1 t + 1
tm
= cm .
The relative volume of P is the leading term of the corresponding counting
function LP.
For example, in the previous section we found that Corollary 5.5 implies
that the second leading coeï¬ƒcient cdâˆ’1 of the Ehrhart polynomial of the
d-polytope P equals
1
2 times the sum of the leading terms of the Ehrhart
polynomials of the facets of P. The leading term for one facet is simply the
relative volume of that facet:
Theorem 5.6. Suppose LP(t) = cd td + cdâˆ’1 tdâˆ’1 + Â· Â· Â· + c0 is the Ehrhart
polynomial of the integral polytope P. Then
cdâˆ’1 = 1
2
X
F a facet of P
vol F .
âŠ“âŠ”
Notes
1. The Dehnâ€“Sommerville relations (Theorem 5.1) ï¬rst surfaced in the work
of Max Dehn, who proved them in 1905 for dimension ï¬ve [71]. (The Dehnâ€“
Sommerville relations are not that complicated for d â‰¤4; see Exercise 5.3.)
Some two decades later, D. M. Y. Sommerville proved the general case [167].
Theorem 5.1 was neither well known nor much used in the ï¬rst half of the
twentieth century, but only after its rediscovery by Victor Klee [111] and its
appearance in Branko GrÂ¨unbaumâ€™s famous and widely read book [90].
2. The Euler relation (Theorem 5.2) is easy to prove directly for d = 3 (this
case is attributed to Euler), but for higher dimension, one has to be somewhat
careful, as we already remarked in the text. The classical proof for general d
was found in 1852 by Ludwig SchlÂ¨aï¬‚i [158], although it (like numerous later
proofs) assumes that the boundary of a convex polytope can be built up
inductively in a â€œgoodâ€ way. This nontrivial factâ€”which is called shelling of
a polytopeâ€”was proved by Heinz Bruggesser and Peter Mani in 1971 [50].
Shellability is nicely discussed in [193, Lecture 8]. There are short proofs of
the Euler relation that do not use the shelling of a polytope (see, for example,
[120, 139, 184]).
3. The reader might suspect that proving Theorems 5.1 and 5.2 for rational
polytopes suï¬ƒces for the general case, since it seems that we can transform
a polytope with irrational vertices slightly to one with only rational vertices
without changing the face structure of the polytope. This is true in our every-
day world but fails in dimension â‰¥4 (see [156] for dimension 4 and [193,
pp. 172/173] for general dimension).

Exercises
103
4. Theorem 5.3 is due to Peter McMullen [127], who, in fact, proved this result
in somewhat greater generality. Another generalization of Theorem 5.3 can be
found in [59].
Exercises
5.1. Consider a simple 3-polytope with at least ï¬ve facets. Two players play
the following game: Each player, in turn, signs his or her name on a previously
unsigned face. The winner is the player who ï¬rst succeeds in signing three
facets that share a common vertex. Show that the player who signs ï¬rst will
always win by playing as well as possible.6
5.2. Show that for the d-cube, fk = 2dâˆ’k d
k

.
5.3. Give an elementary proof of the Dehnâ€“Sommerville relations (Theo-
rem 5.1) for d â‰¤4.
5.4. â™£Let P be a simple d-polytope. Prove that the number of k-faces of P
containing a given j-face of P equals
 dâˆ’j
dâˆ’k

.
5.5. â™£Show directly, without using Theorem 5.2, that for a d-simplex:
(a) fk =
 d+1
k+1

.
(b)
d
X
k=0
(âˆ’1)kfk = 1.
5.6. Prove Theorem 5.1 directly (and hence not requiring P to be an integral
polytope). (Hint: Orient yourself along the proof of Theorem 5.3, but start
with the Euler relation (Theorem 5.2) for a given face F instead of (5.1).)
5.7. Let F be a face of a simple polytope P. Prove that
X
GâŠ‡F
(âˆ’1)dim G
dim G
k

= (âˆ’1)d
dim F
d âˆ’k

,
k = 0, . . . , d.
5.8. Show that the equations in Theorem 5.3 are equivalent to the following
identities. If P is a simple lattice d-polytope and k â‰¤d, then
k
X
j=0
(âˆ’1)kâˆ’j
d âˆ’j
k âˆ’j

Fdâˆ’j(âˆ’n) =
d
X
i=k
(âˆ’1)iâˆ’k
i
k

Fi(n) .
6 This was one of the 2002 Putnam contest problems.

104
5 Face Numbers and the Dehnâ€“Sommerville Relations in Ehrhartian Terms
5.9. Prove that the equations in the previous exercise imply the following
identities which compare the number of lattice points in faces and relative
interiors of faces of the simple polytope P:
k
X
j=0
(âˆ’1)j
d âˆ’j
k âˆ’j

X
FâŠ†P
dim F=dâˆ’j
#
 F âˆ©Zd
=
d
X
i=k
i
k

X
GâŠ†P
dim G=i
#
 Gâ—¦âˆ©Zd
,
where k = 0, . . . , d = dim P. For example, for k = 0, we have
#(P âˆ©Zd) =
X
GâŠ†P
#
 Gâ—¦âˆ©Zd
,
and for k = d we obtain the inclusionâ€“exclusion formula
#(Pâ—¦âˆ©Zd) =
d
X
j=0
(âˆ’1)dâˆ’j
X
FâŠ†P
dim F=j
#
 F âˆ©Zd
.
5.10. Another nice reformulation of Theorem 5.3 is the following generalized
reciprocity law. For an integral d-polytope P, deï¬ne the generalized Ehrhart
polynomial
Ek(t) :=
k
X
j=0
(âˆ’1)j
d âˆ’j
k âˆ’j

X
FâŠ†P
dim F=dâˆ’j
LF(t) ,
k = 0, . . . , d.
Prove the generalized reciprocity law
Ek(âˆ’t) = (âˆ’1)d Edâˆ’k(t) ,
k = 0, . . . , d,
which implies Ehrhartâ€“Macdonald reciprocity (Theorem 4.1) when k = 0.
5.11. What happens when P is not simple? Give an example for which The-
orem 5.3 fails.
5.12. Give an alternative proof of Theorem 5.6 by considering LP(t)âˆ’LPâ—¦(t)
as the lattice-point enumerator of the boundary of P.

6
Magic Squares
The peculiar interest of magic squares and all lusus numerorum in general lies in
the fact that they possess the charm of mystery.
W. S. Andrews
Fig. 6.1. Magic square at the Temple de la Sagrada FamÂ´Ä±lia (Barcelona, Spain).
Equipped with a solid base of theoretical results, we are now ready to return
to computations. We use Ehrhart theory to assist us in enumerating magic
squares.
Loosely speaking, a magic square is an n Ã— n array of integers (usually
required to be positive, often restricted to the numbers 1, 2, . . . , n2, usually
required to have distinct entries) whose sum along any row, column, and main
diagonal is the same number, called the magic sum. Magic squares have turned

106
6 Magic Squares
up time and again, some in mathematical contexts, others in philosophical or
religious contexts. According to legend, the ï¬rst magic square (the ancient Luo
Shu square) was discovered in China sometime before the ï¬rst century B.C.E.
on the back of a turtle emerging from a river. It was the square pictured in
Figure 6.2.
4
9
2
3
5
7
8
1
6
Fig. 6.2. The Luo Shu square.
Our task in this chapter is to develop a theory for counting certain classes
of magic squares, which we now introduce.
6.1 Itâ€™s a Kind of Magic
One should notice that the Luo Shu square has the distinct entries 1, 2, . . . , 9,
so these entries are positive, distinct integers drawn from a particular set. Such
requirements are too restrictive for our purposes. We deï¬ne a semimagic
square to be a square matrix whose entries are nonnegative integers and
whose rows and columns (called lines in this setting) sum to the same number.
A magic square is a semimagic square whose main diagonals also add up to
the line sum. Figure 6.3 shows two examples.
3
0
0
0
1
2
0
2
1
1
2
0
0
1
2
2
0
1
Fig. 6.3. A semimagic and a magic square.
We caution the reader about clashing deï¬nitions in the literature. For
example, some people reserve the term â€œmagic squareâ€ for what we will call
a traditional magic square, a magic square of order n whose entries are
the distinct integers 1, 2, . . . , n2. (The Luo Shu square is an example of a
traditional magic square.) Others are slightly less restrictive and use the term

6.1 Itâ€™s a Kind of Magic
107
â€œmagic squareâ€ for a magic square with distinct entries. We stress that we do
not make this requirement in this chapter.
Our goal is to count semimagic and magic squares. In the traditional case,
this is in some sense not very interesting:1 for each order there is a ï¬xed
number of traditional magic squares. For example, there are 7040 traditional
4 Ã— 4 magic squares.
The situation becomes more interesting if we drop the condition of tra-
ditionality and study the number of magic squares as a function of the line
sum. We denote the total numbers of semimagic and magic squares of order
n and line sum t by Hn(t) and Mn(t), respectively.
â™¥
t âˆ’â™¥
t âˆ’â™¥
â™¥
t
2
t
2
t
2
t
2
Fig. 6.4. Semimagic and magic squares for n = 2.
Example 6.1. We illustrate these notions for the case n = 2, which is not
very complicated. Here a semimagic square is determined once we know one
entry, say the upper left one, denoted by â™¥in Figure 6.4. Because of the upper
row sum, the upper right entry has to be t âˆ’â™¥, as does the lower left entry
(because of the left column sum). But then the lower right entry has to be
t âˆ’(t âˆ’â™¥) = â™¥(for two reasons: the lower row sum and the right column
sum). The entry â™¥can be any integer between 0 and t. Since there are t + 1
such integers,
H2(t) = t + 1 .
(6.1)
In the magic case, we also have to think of the diagonals. Looking back at our
semimagic square in Figure 6.4, the ï¬rst diagonal gives 2 Â· â™¥= t, or â™¥= t/2.
In this case, t âˆ’â™¥= t/2, and so a 2 Ã— 2 magic square has to have identical
entries in each position. Because we require the entries to be integers, this is
possible only if t is even, in which case we obtain precisely one solution, the
square on the right in Figure 6.4. That is,
M2(t) =
 1 if t is even,
0 if t is odd.
These easy results already hint at something: the counting function Hn is of
a diï¬€erent character than the function Mn.
âŠ“âŠ”
1 It is, nevertheless, an incredibly hard problem to count all traditional magic
squares of a given size n. At present, these numbers are known only for n â‰¤5
[165, Sequence A006052].

108
6 Magic Squares
6.2 Semimagic Squares: Integer Points
in the Birkhoï¬€â€“von Neumann Polytope
Just as the Frobenius problem was intrinsically connected to questions about
integer points on line segments, triangles, and higher-dimensional simplices,
magic squares and their relatives have a life in the world of geometry. The
most famous example is connected to semimagic squares.
A semimagic nÃ—n square has n2 nonnegative entries that sum to the same
number along any row or column. Consider therefore the polytope
Bn :=
ï£±
ï£´
ï£²
ï£´
ï£³
ï£«
ï£¬
ï£­
x11 Â· Â· Â· x1n
...
...
xn1 . . . xnn
ï£¶
ï£·
ï£¸âˆˆRn2 : xjk â‰¥0,
P
j xjk = 1 for all 1 â‰¤k â‰¤n
P
k xjk = 1 for all 1 â‰¤j â‰¤n
ï£¼
ï£´
ï£½
ï£´
ï£¾
,
(6.2)
consisting of nonnegative real matrices, in which all rows and columns sum
to one. Bn is called the nth Birkhoï¬€â€“von Neumann polytope, in honor
of Garrett Birkhoï¬€(1911â€“1996)2 and John von Neumann (1903â€“1957).3 Be-
cause the matrices contained in the Birkhoï¬€â€“von Neumann polytope appear
frequently in probability and statistics (the line sum 1 representing probabil-
ity 1), Bn is often described as the set of all n Ã— n doubly stochastic matrices.
Geometrically, Bn is a subset of Rn2 and as such diï¬ƒcult to picture once
n exceeds 1.4 However, we can get a glimpse of B2 âŠ‚R4 when we think about
what form points in B2 can possibly attain. Very much in sync with Figure 6.4,
such a point is determined by its upper left entry â™¥, pictured in Figure 6.5.
This entry â™¥is a real number between 0 and 1, which suggests that B2 should

â™¥
1 âˆ’â™¥
1 âˆ’â™¥
â™¥

Fig. 6.5. A point in B2.
look like a line segment in 4-space. Indeed, the vertices of B2 should be given
by â™¥= 0 and â™¥= 1, that is, by the points

1 0
0 1

,

0 1
1 0

âˆˆB2 .
2 For more information about Birkhoï¬€, see
http://www-groups.dcs.st-and.ac.uk/âˆ¼history/Biographies/Birkhoff Garrett.html.
3 For more information about von Neumann, see
http://www-groups.dcs.st-and.ac.uk/âˆ¼history/Biographies/Von Neumann.html.
4 The case n = 1 is not terribly interesting: B1 = {1} is a point.

6.2 Semimagic Squares: Integer Points in Birkhoï¬€â€“von Neumann Polytope
109
These results generalize: Bn is an (n âˆ’1)2-polytope (see Exercise 6.3), whose
vertices (Exercise 6.5) are the permutation matrices, namely, those n Ã— n
matrices that have precisely one 1 in each row and column (every other entry
being zero). For dimensional reasons, we can talk about the continuous volume
of Bn only in the relative sense, following the deï¬nition of Section 5.4.
The connection of the semimagic counting function Hn(t) to the Birkhoï¬€â€“
von Neumann polytope Bn becomes clear in the light of the lattice-point enu-
merator for Bn: the counting function Hn(t) enumerates precisely the integer
points in tBn, that is,
Hn(t) = #

tBn âˆ©Zn2
= LBn(t) .
We can say more after noticing that permutation vertices are integer points
in Bn, and so Ehrhartâ€™s theorem (Theorem 3.8) applies:
Theorem 6.2. Hn(t) is a polynomial in t of degree (n âˆ’1)2.
âŠ“âŠ”
The fact that Hn is a polynomialâ€”apart from being mathematically
appealingâ€”has the same nice computational consequence that we exploited
in Section 3.6: we can calculate this counting function by interpolation. For
example, to compute H2, a linear polynomial, we need to know only two val-
ues. In fact, since we know that the constant term of H2 is 1 (by Corollary
3.15), we need only one value. It is not hard to convince even a lay person
that H2(1) = 2 (which two semimagic squares are those?), from which we
interpolate
H2(t) = t + 1 .
To interpolate the polynomial H3, we need to know 4 values aside from
H3(0) = 1. In fact, we do not even have to know that many values, because
Ehrhartâ€“Macdonald reciprocity (Theorem 4.1) assists us in computations. To
see this, let Hâ—¦
n(t) denote the number of n Ã— n square matrices with positive
integer entries summing up to t along each row and column. A momentâ€™s
thought (Exercise 6.6) reveals that
Hâ—¦
n(t) = Hn(t âˆ’n) .
(6.3)
But there is a second relationship between Hn and Hâ—¦
n, namely, Hâ—¦
n(t) counts,
by deï¬nition, the integer points in the relative interior of the Birkhoï¬€â€“von
Neumann polytope Bn, that is, Hâ—¦
n(t) = LBâ—¦n(t). Now Ehrhartâ€“Macdonald
reciprocity (Theorem 4.1) gives
Hâ—¦
n(âˆ’t) = (âˆ’1)(nâˆ’1)2Hn(t) .
Combining this identity with (6.3) gives us a symmetry identity for the count-
ing function for semimagic squares:

110
6 Magic Squares
Theorem 6.3. The polynomial Hn satisï¬es
Hn(âˆ’n âˆ’t) = (âˆ’1)(nâˆ’1)2Hn(t)
and
Hn(âˆ’1) = Hn(âˆ’2) = Â· Â· Â· = Hn(âˆ’n + 1) = 0 .
âŠ“âŠ”
The roots of Hn at the ï¬rst n âˆ’1 negative integers follow from (Exer-
cise 6.7)
Hâ—¦
n(1) = Hâ—¦
n(2) = Â· Â· Â· = Hâ—¦
n(n âˆ’1) = 0 .
Theorem 6.3 gives the degree of Bn, and it implies that the numerator of the
Ehrhart series of the Birkhoï¬€â€“von Neumann polytope is palindromic:
Corollary 6.4. The Ehrhart series of the Birkhoï¬€â€“von Neumann polytope Bn
has the form
EhrBn(z) = h(nâˆ’1)(nâˆ’2) z(nâˆ’1)(nâˆ’2) + Â· Â· Â· + h0
(1 âˆ’z)(nâˆ’1)2+1
,
where h0, h1, . . . , h(nâˆ’1)(nâˆ’2) âˆˆZâ‰¥0 satisfy hk = h(nâˆ’1)(nâˆ’2)âˆ’k for 0 â‰¤k â‰¤
(nâˆ’1)(nâˆ’2)
2
.
Proof. Denote the Ehrhart series of Bn by
EhrBn(z) = h(nâˆ’1)2 z(nâˆ’1)2 + Â· Â· Â· + h0
(1 âˆ’z)(nâˆ’1)2+1
.
The fact that h(nâˆ’1)2 = Â· Â· Â· = h(nâˆ’1)2âˆ’(nâˆ’2) = 0 follows from the second
part of Theorem 6.3 and Theorem 4.5. The palindromy of the numerator
coeï¬ƒcients follows from the ï¬rst part of Theorem 6.3 and Exercise 4.6: it
implies
EhrBn
1
z

= (âˆ’1)(nâˆ’1)2+1zn EhrBn(z) ,
which yields hk = h(nâˆ’1)(nâˆ’2)âˆ’k upon simplifying both sides of the equation.
âŠ“âŠ”
Letâ€™s return to the interpolation of H3: Theorem 6.3 gives, in addition to
H3(0) = 1, the values
H3(âˆ’3) = 1
and
H3(âˆ’1) = H3(âˆ’2) = 0 .
These four values together with H3(1) = 6 (see Exercise 6.1) suï¬ƒce to inter-
polate the quartic polynomial H3, and one computes
H3(t) = 1
8 t4 + 3
4 t3 + 15
8 t2 + 9
4 t + 1 .
(6.4)

6.3 Magic Generating Functions and Constant-Term Identities
111
This interpolation example suggests the use of a computer; we let it calcu-
late enough values of Hn and then simply interpolate. As far as computations
are concerned, however, we should not get too excited about the fact that
we computed H2 and H3 so eï¬€ortlessly. In general, the polynomial Hn has
degree (n âˆ’1)2, so we need to compute (n âˆ’1)2 + 1 values of Hn to be
able to interpolate. Of those, we know n (the constant term and the roots
given by Theorem 6.3), so n2 âˆ’3n + 1 values of Hn remain to be computed.
Ehrhartâ€“Macdonald reciprocity reduces the number of values to be computed
to n2âˆ’3n
2
+ 1. Thatâ€™s still a lot, as anyone can testify who has tried to get a
computer to enumerate all semimagic 7 Ã— 7 squares with line sum 15. Never-
theless, it is a fun fact that we can compute Hn for small n by interpolation.
It is amusing to test oneâ€™s computer against the constant-term computation
we will outline below, and we invite the reader to try both. For small n, in-
terpolation is clearly superior to a constant-term computation in the spirit
of Chapter 1. The turning point seems to be right around n = 5: the com-
puter needs more and more time to compute the values Hn(t) as t increases.
Methods superior to interpolation are needed.
6.3 Magic Generating Functions and Constant-Term
Identities
Now we will construct a generating function for Hn, for which we will use
Theorem 2.13. The semimagic counting function Hn is the Ehrhart polynomial
of the nth Birkhoï¬€â€“von Neumann polytope Bn, which, in turn, is deï¬ned as a
set of matrices by (6.2). First we rewrite the deï¬nition of Bn to ï¬t the general
description (2.23) of a polytope. If we consider the points in Bn as column
vectors in Rn2 (rather than as matrices in RnÃ—n) then
Bn =
n
x âˆˆRn2
â‰¥0 : A x = b
o
,
where
A =
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£­
1 Â· Â· Â· 1
1 Â· Â· Â· 1
...
1 Â· Â· Â· 1
1
1
1
...
...
Â· Â· Â·
...
1
1
1
ï£¶
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£¸
âˆˆZ2nÃ—n2
(6.5)
(here we omit the zero entries) and
b =
ï£«
ï£¬
ï£¬
ï£¬
ï£­
1
1
...
1
ï£¶
ï£·
ï£·
ï£·
ï£¸âˆˆZ2n.

112
6 Magic Squares
From this description of Bn, we can easily build the generating function
for Hn. According to Theorem 2.13, for a general rational polytope P =

x âˆˆRd
â‰¥0 : A x = b
	
, we have
LP(t) = const

1
(1 âˆ’zc1) (1 âˆ’zc2) Â· Â· Â· (1 âˆ’zcd) ztb

,
where c1, c2, . . . , cd denote the columns of A. In our special case, the columns
of A are of a simple form: they contain exactly two 1â€™s and elsewhere 0â€™s. We
need one generating-function variable for each row of A. To keep things as
clear as possible, we use z1, z2, . . . , zn for the ï¬rst n rows of A (representing
the row constraints of Bn) and w1, w2, . . . , wn for the last n rows of A (rep-
resenting the column constraints of Bn). With this notation, Theorem 2.13
applied to Bn gives the following starting point for our computations:
Theorem 6.5. The number Hn(t) of semimagic n Ã— n squares with line sum
t satisï¬es
Hn(t) = const
ï£«
ï£¬
ï£­
1
Q
1â‰¤j,kâ‰¤n (1 âˆ’zjwk)
Q
1â‰¤jâ‰¤n zj
Q
1â‰¤kâ‰¤n wk
t
ï£¶
ï£·
ï£¸.
âŠ“âŠ”
This identity is of both theoretical and practical use. One can use it to compute
H3 and even H4 by hand. For now, we work on reï¬ning it further, exempliï¬ed
by the case n = 2.
We ï¬rst note that in the formula for H2, the variables w1 and w2 are
separated, in the sense that we can write this formula as a product of two
factors, one involving only w1 and the other involving only w2:
H2(t) = const
 1
zt
1zt
2
1
(1 âˆ’z1w1) (1 âˆ’z2w1) wt
1
1
(1 âˆ’z1w2) (1 âˆ’z2w2) wt
2

.
Now we put an ordering on the constant-term computation: let us ï¬rst com-
pute the constant term with respect to w2, then the one with respect to w1.
(We donâ€™t order the computation with respect to z1 and z2 just yet.) Since z1,
z2, and w1 are considered constants when we do constant-term computations
with respect to w2, we can simplify:
H2(t) = constz1,z2
 1
zt
1zt
2
constw1

1
(1 âˆ’z1w1) (1 âˆ’z2w1) wt
1
Ã— constw2

1
(1 âˆ’z1w2) (1 âˆ’z2w2) wt
2

.
Now we can see the eï¬€ect of the separate appearance of w1 and w2: the
constant-term identity factors. This is very similar to the factoring that can
appear in computations of integrals in several variables. Let us rewrite our
identity to emphasize the factoring:

6.3 Magic Generating Functions and Constant-Term Identities
113
H2(t) = constz1,z2
 1
zt
1zt
2
constw1

1
(1 âˆ’z1w1) (1 âˆ’z2w1) wt
1

Ã— constw2

1
(1 âˆ’z1w2) (1 âˆ’z2w2) wt
2

.
But now the expressions in the last two sets of parentheses are identical,
except that in one case the constant-term variable is called w1 and in the
other case w2. Since these are just â€œdummyâ€ variables, we can call them w,
and combine:
H2(t) = constz1,z2
 
1
zt
1zt
2

constw
1
(1 âˆ’z1w) (1 âˆ’z2w) wt
2!
.
(Note the square!) Naturally, all of this factoring works in the general case,
and we invite the reader to prove it (Exercise 6.8):
Hn(t) = constz1,...,zn

(z1 Â· Â· Â· zn)âˆ’t

constw
1
(1 âˆ’z1w) Â· Â· Â· (1 âˆ’znw)wt
n
.
(6.6)
We can go further, namely, we can compute the innermost constant term
constw
1
(1 âˆ’z1w) Â· Â· Â· (1 âˆ’znw)wt .
It should come as no surprise that weâ€™ll use a partial fraction expansion to do
so. The w-poles of the rational function are at w = 1/z1, w = 1/z2, . . . , w =
1/zn, and so we expand
1
(1 âˆ’z1w) Â· Â· Â· (1 âˆ’znw)wt =
A1
w âˆ’1
z1
+
A2
w âˆ’1
z2
+Â· Â· Â·+
An
w âˆ’
1
zn
+
t
X
k=1
Bk
wk . (6.7)
Just as in Chapter 1, we can forget about the Bk-terms, since they do not
contribute to the constant term, that is,
constw
1
(1 âˆ’z1w) Â· Â· Â· (1 âˆ’znw)wt
= constw
 
A1
w âˆ’1
z1
+
A2
w âˆ’1
z2
+ Â· Â· Â· +
An
w âˆ’
1
zn
!
= âˆ’A1z1 âˆ’A2z2 âˆ’Â· Â· Â· âˆ’Anzn .
We invite the reader to show (Exercise 6.9) that
Ak = âˆ’
ztâˆ’1
k

1 âˆ’z1
zk

Â· Â· Â·

1 âˆ’zkâˆ’1
zk
 
1 âˆ’zk+1
zk

Â· Â· Â·

1 âˆ’zn
zk

= âˆ’
zt+nâˆ’2
k
Q
jÌ¸=k(zk âˆ’zj) .
(6.8)

114
6 Magic Squares
Putting these coeï¬ƒcients back into the partial fraction expansion yields the
following identity.
Theorem 6.6. The number Hn(t) of semimagic n Ã— n squares with line sum
t satisï¬es
Hn(t) = const
 
(z1 Â· Â· Â· zn)âˆ’t
 n
X
k=1
zt+nâˆ’1
k
Q
jÌ¸=k(zk âˆ’zj)
!n!
.
âŠ“âŠ”
Amidst all this generality, we almost forgot to compute H2 with our partial
fraction approach. The last theorem says that
H2(t) = const
 
(z1z2)âˆ’t
 zt+1
1
z1 âˆ’z2
+
zt+1
2
z2 âˆ’z1
2!
= const
 zt+2
1
zâˆ’t
2
(z1 âˆ’z2)2 âˆ’2
z1z2
(z1 âˆ’z2)2 +
zâˆ’t
1 zt+2
2
(z1 âˆ’z2)2

.
(6.9)
Now itâ€™s time to put more order on the constant-term computation. Letâ€™s say
we ï¬rst compute the constant term with respect to z1, and after that with
respect to z2. So we have to compute ï¬rst
constz1
 zt+2
1
zâˆ’t
2
(z1 âˆ’z2)2

, constz1

z1z2
(z1 âˆ’z2)2

, and
constz1
 zâˆ’t
1 zt+2
2
(z1 âˆ’z2)2

.
To obtain these constant terms, we need to expand the function
1
(z1âˆ’z2)2 . As
we know from calculus, this expansion depends on the order of the magnitudes
of z1 and z2. For example, if |z1| < |z2| then
1
z1 âˆ’z2
= 1
z2
1
z1
z2 âˆ’1 = âˆ’1
z2
X
kâ‰¥0
z1
z2
k
= âˆ’
X
kâ‰¥0
1
zk+1
2
zk
1 ,
and hence
1
(z1 âˆ’z2)2 = âˆ’d
dz1

1
z1 âˆ’z2

=
X
kâ‰¥1
k
zk+1
2
zkâˆ’1
1
=
X
kâ‰¥0
k + 1
zk+2
2
zk
1 .
So letâ€™s assume for the moment that |z1| < |z2|. This might sound funny, since
z1 and z2 are variables. However, as such they are simply tools that enable
us to compute some quantity that is independent of z1 and z2. In view of
these ideas, we may assume any order of the magnitudes of the variables. In
Exercise 6.11 we will check that indeed the order does not matter. Now,

6.3 Magic Generating Functions and Constant-Term Identities
115
constz1
 zt+2
1
zâˆ’t
2
(z1 âˆ’z2)2

= zâˆ’t
2 constz1

zt+2
1
(z1 âˆ’z2)2

= zâˆ’t
2 constz1
ï£«
ï£­zt+2
1
X
kâ‰¥0
k + 1
zk+2
2
zk
1
ï£¶
ï£¸
(6.10)
= zâˆ’t
2 constz1
ï£«
ï£­X
kâ‰¥0
k + 1
zk+2
2
zk+t+2
1
ï£¶
ï£¸
= 0 ,
since there are only positive powers of z1 (remember that t â‰¥0). Analogously
(see Exercise 6.10) one checks that
constz1

z1z2
(z1 âˆ’z2)2

= 0 .
(6.11)
For the last constant term, we compute
constz1
 zâˆ’t
1 zt+2
2
(z1 âˆ’z2)2

= zt+2
2
constz1
ï£«
ï£­zâˆ’t
1
X
kâ‰¥0
k + 1
zk+2
2
zk
1
ï£¶
ï£¸
= zt+2
2
constz1
ï£«
ï£­X
kâ‰¥0
k + 1
zk+2
2
zkâˆ’t
1
ï£¶
ï£¸.
The constant term on the right-hand side is the term with k = t, that is,
constz1
 zâˆ’t
1 zt+2
2
(z1 âˆ’z2)2

= zt+2
2
t + 1
zt+2
2
= t + 1 .
So of the three constant terms only one survives, and with constz2(t+1) = t+1
we recover what we have known since the beginning of this chapter:
H2(t) = const
 zt+2
1
zâˆ’t
2
(z1 âˆ’z2)2 âˆ’2
z1z2
(z1 âˆ’z2)2 +
zâˆ’t
1 zt+2
2
(z1 âˆ’z2)2

= t + 1 .
This was a lot of work for this seemingly trivial polynomial. Recall, for
example, that we can get the same result by an easy interpolation. How-
ever, to compute a similar interpolation, e.g., for H4, we likely would need
to use a computer (to obtain the interpolation values). On the other hand,
the constant-term computation of H4 boils down to only ï¬ve iterated con-
stant terms, which can actually be computed by hand (see Exercise 6.14).
The result is
H4(t) =
11
11340 t9 + 11
630 t8 + 19
135 t7 + 2
3 t6 + 1109
540 t5 + 43
10 t4 + 35117
5670 t3
+ 379
63 t2 + 65
18 t + 1 .

116
6 Magic Squares
6.4 The Enumeration of Magic Squares
What happens when we bring the diagonal constraints, which are not present
in the semimagic case, into the magic picture? In the introduction of this
chapter we have already seen an example, namely the number of 2 Ã— 2 magic
squares,
M2(t) =
1 if t is even,
0 if t is odd.
This is a very simple example of a quasipolynomial. In fact, like Hn, the
counting function Mn is deï¬ned by integral linear equations and inequalities,
so it is the lattice-point enumerator of a rational polytope, and Theorem 3.23
gives at once the following result.
Theorem 6.7. The counting function Mn(t) is a quasipolynomial in t.
âŠ“âŠ”
We invite the reader to prove that the degree of Mn is n2 âˆ’2n âˆ’1 (Exer-
cise 6.16).
Letâ€™s see what happens in the ï¬rst nontrivial case, 3 Ã— 3 magic squares.
We follow our recipe and assign variables m1, m2, . . . , m9 to the entries of our
3 Ã— 3 squares, as in Figure 6.6.
m1
m2
m3
m4
m5
m6
m7
m8
m9
Fig. 6.6. Variables in a magic 3 Ã— 3 square.
The magic conditions require now that m1, m2, . . . , m9 âˆˆZâ‰¥0 and
m1 + m2 + m3 = t ,
m4 + m5 + m6 = t ,
m7 + m8 + m9 = t ,
m1 + m4 + m7 = t ,
m2 + m5 + m8 = t ,
m3 + m6 + m9 = t ,
m1 + m5 + m9 = t ,
m3 + m5 + m7 = t ,
according to the row sums (the ï¬rst three equations), the column sums (the
next three equations), and the diagonal sums (the last two equations). By

Notes
117
now, weâ€™re experienced in translating this system into a generating function:
we need one variable for each equation, so letâ€™s take z1, z2, z3 for the ï¬rst
three, w1, w2, w3 for the next three, and y1, y2 for the last two equations. The
function M3(t) is the constant term of
1
(1 âˆ’z1w1y1) (1 âˆ’z1w2) (1 âˆ’z1w3y2) (1 âˆ’z2w1) (1 âˆ’z2w2y1y2) (1 âˆ’z2w3)
Ã—
1
(1 âˆ’z3w1y2) (1 âˆ’z3w2) (1 âˆ’z3w3y1) (z1z2z3w1w2w3y1y2)t .
(6.12)
It does take some work, but it is instructive to compute this constant term
(just try it!). The result is
M3(t) =
(
2
9 t2 + 2
3 t + 1
if 3|t,
0
otherwise.
(6.13)
As predicted by Theorem 6.7, M3 is a quasipolynomial. It has degree 2 and
period 3. This may be more apparent if we rewrite it as
M3(t) =
ï£±
ï£´
ï£²
ï£´
ï£³
2
9 t2 + 2
3 t + 1
if t â‰¡0 mod 3,
0
if t â‰¡1 mod 3,
0
if t â‰¡2 mod 3,
and we can see the three constituents of the quasipolynomial M3. There is
an alternative way to describe M3; namely, let
c2(t) =
ï£±
ï£´
ï£²
ï£´
ï£³
2
9
if t â‰¡0 mod 3,
0
if t â‰¡1 mod 3,
0
if t â‰¡2 mod 3,
c1(t) =
ï£±
ï£´
ï£²
ï£´
ï£³
2
3
if t â‰¡0 mod 3,
0
if t â‰¡1 mod 3,
0
if t â‰¡2 mod 3,
c0(t) =
ï£±
ï£´
ï£²
ï£´
ï£³
1
if t â‰¡0 mod 3,
0
if t â‰¡1 mod 3,
0
if t â‰¡2 mod 3.
Then the quasipolynomial M3 can be written as
M3(t) = c2(t) t2 + c1(t) t + c1(t) .
Notes
1. Magic squares date back to China in the ï¬rst millennium B.C.E. [53]; they
underwent much further development in the Islamic world late in the ï¬rst

118
6 Magic Squares
millennium C.E. and in the next millennium (or sooner; the data are lacking)
in India [54]. From Islam they passed to Christian Europe in the later Middle
Ages, probably initially through the Jewish community [54, Part II, pp. 290
ï¬€.] and later possibly Byzantium [54, Part I, p. 198], and no later than the
early eighteenth century (the data are buried in barely tapped archives) to
sub-Saharan Africa [191, Chapter 12]. The contents of a magic square have
varied with time and writer; usually they have been the ï¬rst n2 consecutive
integers, but often any arithmetic sequence or arbitrary positive numbers.
In the past century, mathematicians have made some simpliï¬cations in the
interest of obtaining results about the number of squares with a ï¬xed magic
sum, in particular, allowing repeated entries as in this chapter.
2. The problem of counting magic squares (other than traditional magic
squares) seems to have occurred to anyone only in the twentieth century,
no doubt because there was no way to approach the question previously. The
ï¬rst nontrivial formulas addressing the counting problem, namely (6.4) and
(6.13) for H3 and M3, were established by Percy Macmahon (1854â€“1929)5
[124] in 1915. Recently there has grown up a literature on exact formulas (see
for example [80, 168] for semimagic squares; for magic squares see [1, 23]; for
magic squares with distinct entries see [31, 189]).
3. Another famous kind of square is latin squares (see, for example, [72]).
Here each row and column has n diï¬€erent numbers, the same n numbers in
every row/column (usually taken to be the ï¬rst n positive integers). There
are counting problems associated with latin squares, which can be attacked
using Ehrhart theory [31] (see also [165, Sequence A002860]).
4. Recent work includes mathematical-historical research, such as the discov-
ery of unpublished magic squares of Benjamin Franklin [2, 141]. Aside from
mathematical research, magic squares and their siblings naturally continue
to be an excellent source of topics for popular mathematics books (see, for
example, [4] or [144]).
5. The Birkhoï¬€â€“von Neumann polytope Bn possesses fascinating combinato-
rial properties [38, 48, 49, 58, 192] and relates to many mathematical areas
[74, 112]. Its name honors Garrett Birkhoï¬€and John von Neumann, who
proved that the extremal points of Bn are the permutation matrices [39, 186]
(see Exercise 6.5). A long-standing open problem is the determination of
the relative volume of Bn, which is known only for n â‰¤10 [165, Sequence
A037302]. In fact, the last two records (n = 9 and 10) for computing vol Bn
rely on the theory of counting functions that is introduced in this book, more
precisely, Theorem 6.6 [28].
5 For more information about MacMahon, see
http://www-groups.dcs.st-and.ac.uk/âˆ¼history/Biographies/MacMahon.html.

Exercises
119
6. An important generalization of the Birkhoï¬€â€“von Neumann polytope is the
transporation polytopes, which consist of contingency tables. They have appli-
cations to statistics and in particular to disclosure limitation procedures [68].
The Birkhoï¬€â€“von Neumann polytopes are special transportation polytopes
that consist of two-way contingency tables with given 1-marginals.
7. The polynomiality of Hn (Theorem 6.2) and its symmetry (Theorem 6.3)
were conjectured in 1966 by Harsh Anand, Vishwa Dumir, and Hansraj Gupta
[3] and proved seven years later independently by Eug`ene Ehrhart [80] and
Richard Stanley [168]. Stanley also conjectured that the numerator coeï¬ƒcients
in Corollary 6.4 are unimodal, a fact that was proved only in 2005, by Christos
Athanasiadis [8]. The quasipolynomiality of Mn (Theorem 6.7) and its degree
are discussed in [23]. The period of Mn is in general not known. In [23] it
is conjectured that it is always nontrivial for n > 1. The work in [1] gives
some credence to this conjecture by proving that the polytope of magic n Ã— n
squares is not integral for n â‰¥2.
8. We close with a story about Cornelius Agrippaâ€™s De Occulta Philosophia,
written in 1510. In it he describes the spiritual powers of magic squares and
produces some squares of orders from three up to nine. His work, although
inï¬‚uential in the mathematical community, enjoyed only brief success, for
the Counter-Reformation and the witch hunts of the Inquisition began soon
thereafter: Agrippa himself was accused of being allied with the devil.
Exercises
6.1. â™£Find and prove a formula for Hn(1).
6.2. Let (xij)1â‰¤i,jâ‰¤3 be a magic 3 Ã— 3 square.
(a) Show that the center term x22 is the average over all xij.
(b) Show that M3(t) = 0 if 3 does not divide t.
6.3. â™£Prove that dim Bn = (n âˆ’1)2.
6.4. Prove the following characterization of a vertex of a convex polytope P: A
point v âˆˆP is a vertex of P if for any line L through v and any neighborhood
N of v there exists a point in L âˆ©N that is not in P.
6.5. â™£Prove that the vertices of Bn are the n Ã— n-permutation matrices.
6.6. â™£Let Hâ—¦
n(t) denote the number of n Ã— n matrices with positive integer
entries summing up to t along each row and column. Show that Hâ—¦
n(t) =
Hn(t âˆ’n) for t > n.
6.7. â™£Show that Hâ—¦
n(1) = Hâ—¦
n(2) = Â· Â· Â· = Hâ—¦
n(n âˆ’1) = 0.

120
6 Magic Squares
6.8. â™£Prove (6.6):
Hn(t) = constz1,...,zn

(z1 Â· Â· Â· zn)âˆ’t

constw
1
(1 âˆ’z1w) Â· Â· Â· (1 âˆ’znw)wt
n
.
6.9. â™£Compute the partial fraction coeï¬ƒcients (6.8).
6.10. â™£Verify (6.11).
6.11. Repeat the constant-term computation of H2 starting from (6.9), but
now by ï¬rst computing the constant term with respect to z2, and after that
with respect to z1.
6.12. Use your favorite computer program to calculate the formula for H3(t),
H4(t), . . . by interpolation.
6.13. Compute H3 using Theorem 6.6.
6.14. Compute H4 using Theorem 6.6.
6.15. Show that
n
X
k=1
zt+nâˆ’1
k
Q
jÌ¸=k(zk âˆ’zj) =
X
m1+Â·Â·Â·+mn=t
zm1
1
Â· Â· Â· zmn
n ,
and use this identity to give an alternative proof of Theorem 6.6.
6.16. â™£Prove that for n â‰¥3, the degree of Mn is n2 âˆ’2n âˆ’1.
6.17. Compute the vertices of the polytope of 3 Ã— 3 magic squares.
6.18. â™£Verify (6.12) and use it to compute M3.
6.19. Compute M3 by interpolation. (Hint: Use Exercises 6.2 and 6.17.)
6.20. A symmetric semimagic square is a semimagic square that is a sym-
metric matrix. Show that the number of symmetric semimagic n Ã— n squares
with line sum t is a quasipolynomial in t. Determine its degree and period.
Open Problems
6.21. Compute the number of traditional magic n Ã— n squares for n > 5.
6.22. Compute vol Bn for n > 10. Compute Hn for n > 9.
6.23. Prove that the period of Mn is nontrivial for n > 1.
6.24. The vertices of the Birkhoï¬€â€“von Neumann polytope are in one-to-one
correspondence with the elements of the symmetric group Sn. Consider a sub-
group of Sn and take the convex hull of the corresponding permutation matri-
ces. Compute the Ehrhart polynomials of this polytope. (The face numbers of
the polytope corresponding to the subgroup An, the even permutations, were
studied in [102].)
6.25. Prove that the graph formed by the vertices and edges of any 2-way
transportation polytope is Hamiltonian.

7
Finite Fourier Analysis
God created inï¬nity, and man, unable to understand inï¬nity, created ï¬nite sets.
Gian-Carlo Rota (1932â€“1999)
We now consider the vector space of all complex-valued periodic functions
on the integers with period b. It turns out that every such function a(n) on
the integers can be written as a polynomial in the bth root of unity Î¾n :=
e2Ï€in/b. Such a representation for a(n) is called a ï¬nite Fourier series.
Here we develop the ï¬nite Fourier theory using rational functions and their
partial fraction decomposition. We then deï¬ne the Fourier transform and the
convolution of ï¬nite Fourier series, and show how one can use these ideas to
prove identities on trigonometric functions, as well as ï¬nd connections to the
classical Dedekind sums.
The more we know about roots of unity and their various sums, the deeper
are the results that we can prove (see Exercise 7.19); in fact, certain statements
about sums of roots of unity even imply the Riemann hypothesis! However,
this chapter is elementary and draws connections to the sawtooth functions
and Dedekind sums, two basic sums over roots of unity. The general philos-
ophy here is that ï¬nite sums of rational functions of roots of unity are basic
ingredients in many mathematical structures.
7.1 A Motivating Example
To ease the reader into the general theory, letâ€™s work out the ï¬nite Fourier
series for a simple example ï¬rst, an arithmetic function with a period of 3.
Example 7.1. Consider the following arithmetic function, of period 3:
n : 0, 1, 2, 3, 4, 5, . . .
a(n) : 1, 5, 2, 1, 5, 2, . . .

124
7 Finite Fourier Analysis
We ï¬rst embed this sequence into a generating function as follows:
F(z) := 1 + 5z + 2z2 + z3 + 5z4 + 2z5 + Â· Â· Â· =
X
nâ‰¥0
a(n) zn.
Since the sequence is periodic, we can simplify F(z) using a geometric series
argument:
F(z) =
X
nâ‰¥0
a(n) zn
= 1 + 5z + 2z2 + z3  1 + 5z + 2z2
+ z6  1 + 5z + 2z2
+ Â· Â· Â·
=
 1 + 5z + 2z2 X
kâ‰¥0
z3k
= 1 + 5z + 2z2
1 âˆ’z3
.
We now use the same technique that was employed in Chapter 1, namely the
technique of expanding a rational function into its partial fraction decompo-
sition. Here all the poles are simple, and located at the three cube roots of
unity, so that
F(z) = Ë†a(0)
1 âˆ’z +
Ë†a(1)
1 âˆ’Ïz +
Ë†a(2)
1 âˆ’Ï2z ,
(7.1)
where the constants Ë†a(0), Ë†a(1), Ë†a(2) remain to be found, and where Ï := e2Ï€i/3,
a third root of unity. Using the geometric series for each of these terms sepa-
rately, we arrive at
F(z) =
X
nâ‰¥0
 Ë†a(0) + Ë†a(1)Ïn + Ë†a(2)Ï2n
zn,
so that weâ€™ve derived the ï¬nite Fourier series of our sequence a(n)! The only
remaining piece of information that we need is the computation of the con-
stants Ë†a(j), for j = 0, 1, 2. It turns out that this is also quite easy to do. We
have, from (7.1) above, the identity
Ë†a(0) (1 âˆ’Ïz)
 1 âˆ’Ï2z

+ Ë†a(1) (1 âˆ’z)
 1 âˆ’Ï2z

+ Ë†a(2) (1 âˆ’z) (1 âˆ’Ïz)
= 1 + 5z + 2z2,
valid for all z âˆˆC. Upon letting z = 1, Ï2, and Ï, respectively, we obtain
3 Ë†a(0) = 1 + 5 + 2 ,
3 Ë†a(1) = 1 + 5Ï2 + 2Ï4,
3 Ë†a(2) = 1 + 5Ï + 2Ï2,
where weâ€™ve used the identity (1 âˆ’Ï)(1 âˆ’Ï2) = 3 (see Exercise 7.2). We can
simplify a bit to get Ë†a(0) = 8
3, Ë†a(1) = âˆ’4âˆ’3Ï
3
, and Ë†a(2) = âˆ’1+3Ï
3
. Thus the
ï¬nite Fourier series for our sequence is

7.2 Finite Fourier Series for Periodic Functions on Z
125
a(n) = 8
3 +

âˆ’4
3 âˆ’Ï

Ïn +

âˆ’1
3 + Ï

Ï2n.
âŠ“âŠ”
The object of the next section is to show that this simple process follows just
as easily for any periodic function on Z. The ensuing sections contain some
applications of the ï¬nite Fourier series of periodic functions.
7.2 Finite Fourier Series for Periodic Functions on Z
The general theory is just as easy conceptually as the example above, and we
now develop it. Consider any periodic sequence on Z, deï¬ned by {a(n)}âˆ
n=0, of
period b. Throughout the chapter, we ï¬x the bth root of unity Î¾ := e2Ï€i/b. As
before, we embed our periodic sequence {a(n)}âˆ
n=0 into a generating function,
F(z) :=
X
nâ‰¥0
a(n) zn,
and use the periodicity of the sequence to immediately get
F(z) =
 bâˆ’1
X
k=0
a(k) zk
!
+
 bâˆ’1
X
k=0
a(k) zk
!
zb +
 bâˆ’1
X
k=0
a(k) zk
!
z2b + Â· Â· Â·
=
Pbâˆ’1
k=0 a(k) zk
1 âˆ’zb
= P(z)
1 âˆ’zb ,
where the last step simply deï¬nes the polynomial P(z) = Pbâˆ’1
k=0 a(k) zk. Now
we expand the rational generating function F(z) into partial fractions, as
before:
F(z) = P(z)
1 âˆ’zb =
bâˆ’1
X
m=0
Ë†a(m)
1 âˆ’Î¾mz .
As in the example of the previous section, we expand each of the terms
1
1âˆ’Î¾mz
as a geometric series, and substitute into the sum above to get
F(z) =
X
nâ‰¥0
a(n) zn =
bâˆ’1
X
m=0
Ë†a(m)
1 âˆ’Î¾mz
=
bâˆ’1
X
m=0
Ë†a(m)
X
nâ‰¥0
Î¾mnzn =
X
nâ‰¥0
 bâˆ’1
X
m=0
Ë†a(m) Î¾mn
!
zn.
Comparing the coeï¬ƒcients of any ï¬xed zn gives us the ï¬nite Fourier series for
a(n), namely
a(n) =
bâˆ’1
X
m=0
Ë†a(m) Î¾mn.

126
7 Finite Fourier Analysis
We now ï¬nd a formula for the Fourier coeï¬ƒcients Ë†a(n), as in the example.
To recapitulate, we have
P(z) =
bâˆ’1
X
m=0
Ë†a(m) 1 âˆ’zb
1 âˆ’Î¾mz =
bâˆ’1
X
m=0
Ë†a(m)
Y
1â‰¤kâ‰¤b,kÌ¸=m
 1 âˆ’Î¾kz

,
where we have used the factorization 1 âˆ’zb = Qb
k=1(1 âˆ’Î¾kz) of Exercise 7.1.
To solve for P(Î¾âˆ’n), we note that
lim
zâ†’Î¾âˆ’n
1 âˆ’zb
1 âˆ’Î¾mz = 0
if m âˆ’n Ì¸â‰¡0 mod b,
and
lim
zâ†’Î¾âˆ’n
1 âˆ’zb
1 âˆ’Î¾mz =
lim
zâ†’Î¾âˆ’n
bzbâˆ’1
Î¾m
= b Î¾nâˆ’m = b
if m âˆ’n â‰¡0 mod b.
Thus P(Î¾âˆ’n) = b Ë†a(n) and so
Ë†a(n) = 1
b P(Î¾âˆ’n) = 1
b
bâˆ’1
X
k=0
a(k) Î¾âˆ’nk.
We have just proved the main result of ï¬nite Fourier series, using only ele-
mentary properties of rational functions:
Theorem 7.2 (Finite Fourier series expansion and Fourier inver-
sion). Let a(n) be any periodic function on Z, with period b. Then we have
the following ï¬nite Fourier series expansion:
a(n) =
bâˆ’1
X
k=0
Ë†a(k) Î¾nk,
where the Fourier coeï¬ƒcients are
Ë†a(n) = 1
b
bâˆ’1
X
k=0
a(k) Î¾âˆ’nk,
(7.2)
with Î¾ = e2Ï€i/b.
âŠ“âŠ”
The coeï¬ƒcients Ë†a(m) are known as the Fourier coeï¬ƒcients of the func-
tion a(n), and if Ë†a(m) Ì¸= 0 we sometimes say that the function has fre-
quency m. The ï¬nite Fourier series of a periodic function provides us with
surprising power and insight into its structure. We are able to analyze the func-
tion using its frequencies (only ï¬nitely many), and this window into the fre-
quency domain becomes indispensable for computations and simpliï¬cations.

7.2 Finite Fourier Series for Periodic Functions on Z
127
We note that the Fourier coeï¬ƒcients Ë†a(n) and the original sequence ele-
ments a(n) are related by a linear transformation given by the matrix
L =

Î¾(iâˆ’1)(jâˆ’1)
,
(7.3)
where 1 â‰¤i, j â‰¤b, as is evident from (7.2) in the proof above. We further note
that the second half of the proof, namely solving for the Fourier coeï¬ƒcients
Ë†a(n), is just tantamount to inverting this matrix L.
One of the main building blocks of our lattice-point enumeration formulas
in polytopes is the sawtooth function, deï¬ned by
((x)) :=
(
{x} âˆ’1
2
if x /âˆˆZ,
0
if x âˆˆZ.
(7.4)
(As a reminder, {x} = x âˆ’âŒŠxâŒ‹is the fractional part of x.) The graph of this
function is displayed in Figure 7.1. We have seen a closely related function
before, in Chapter 1, in our study of the coin-exchange problem. Equation
(1.8) gave us the ï¬nite Fourier series for essentially this function from the
discrete-geometry perspective of the coin-exchange problem; however, we now
compute the ï¬nite Fourier series for this periodic function directly, pretending
that we do not know about its other life as a counting function.
x
y
Fig. 7.1. The sawtooth function y = ((x)).
Lemma 7.3. The ï¬nite Fourier series for the discrete sawtooth function
   a
b

, a periodic function of a âˆˆZ with period b, is given by
a
b

= 1
2b
bâˆ’1
X
k=1
1 + Î¾k
1 âˆ’Î¾k Î¾ak = i
2b
bâˆ’1
X
k=1
cot Ï€k
b Î¾ak.
Here the second equality follows from 1+e2Ï€ix
1âˆ’e2Ï€ix = i cot(Ï€x), by the deï¬nition
of the cotangent.

128
7 Finite Fourier Analysis
Proof. Using Theorem 7.2, we know that our periodic function has a ï¬nite
Fourier series
   a
b

= Pbâˆ’1
k=0 Ë†a(k) Î¾ak, where
Ë†a(k) = 1
b
bâˆ’1
X
m=0
m
b

Î¾âˆ’mk.
We ï¬rst compute Ë†a(0) = 1
b
Pbâˆ’1
m=0
   m
b

= 0, by Exercise 7.14. For k Ì¸= 0, we
have
Ë†a(k) = 1
b
bâˆ’1
X
m=1
m
b âˆ’1
2

Î¾âˆ’mk = 1
b2
bâˆ’1
X
m=1
m Î¾âˆ’mk + 1
2b
= 1
b

Î¾k
1 âˆ’Î¾k + 1
2

= 1
2b
1 + Î¾k
1 âˆ’Î¾k ,
where we used Exercise 7.5 in the penultimate equality above.
âŠ“âŠ”
We deï¬ne the Dedekind sum by
s(a, b) =
bâˆ’1
X
k=0
ka
b
 k
b

,
for any two relatively prime integers a and b > 0. Note that the Dedekind
sum is a periodic function of the variable a, with period b, by the periodicity
of the sawtooth function. That is,
s(a + jb, b) = s(a, b)
for all j âˆˆZ .
(7.5)
Using the ï¬nite Fourier series for the sawtooth function, we can now easily
reformulate the Dedekind sums as a ï¬nite sum over the bth roots of unity or
cotangents:
Lemma 7.4.
s(a, b) = 1
4b
bâˆ’1
X
Âµ=1
1 + Î¾Âµ
1 âˆ’Î¾Âµ
1 + Î¾âˆ’Âµa
1 âˆ’Î¾âˆ’Âµa = 1
4b
bâˆ’1
X
Âµ=1
cot Ï€Âµ
b cot Ï€Âµa
b
.
Proof.
s(a, b) =
bâˆ’1
X
k=0
ka
b
 k
b

=
1
4b2
bâˆ’1
X
k=0
  bâˆ’1
X
Âµ=1
1 + Î¾Âµ
1 âˆ’Î¾Âµ Î¾Âµka
!  bâˆ’1
X
Î½=1
1 + Î¾Î½
1 âˆ’Î¾Î½ Î¾Î½k
!!
=
1
4b2
bâˆ’1
X
Âµ=1
bâˆ’1
X
Î½=1
1 + Î¾Âµ
1 âˆ’Î¾Âµ
1 + Î¾Î½
1 âˆ’Î¾Î½
 bâˆ’1
X
k=0
Î¾k(Î½+Âµa)
!
.

7.3 The Finite Fourier Transform and Its Properties
129
We note that the last sum Pbâˆ’1
k=0 Î¾k(Î½+Âµa) vanishes, unless Î½ â‰¡âˆ’Âµa mod b
(Exercise 7.6), in which case the sum equals b, and we obtain
s(a, b) = 1
4b
bâˆ’1
X
Âµ=1
1 + Î¾Âµ
1 âˆ’Î¾Âµ
1 + Î¾âˆ’Âµa
1 âˆ’Î¾âˆ’Âµa .
Rewriting the right-hand side in terms of cotangents gives
s(a, b) = i2
4b
bâˆ’1
X
Âµ=1
cot Ï€Âµ
b cot âˆ’Ï€Âµa
b
= 1
4b
bâˆ’1
X
Âµ=1
cot Ï€Âµ
b cot Ï€Âµa
b
,
because the cotangent is an odd function.
âŠ“âŠ”
7.3 The Finite Fourier Transform and Its Properties
Given a periodic function f on Z, we have seen that f possesses a ï¬nite
Fourier series, with the ï¬nite collection of Fourier coeï¬ƒcients that we called
Ë†f(0), Ë†f(1), . . . , Ë†f(b âˆ’1). We now regard f as a function on the ï¬nite set
G = {0, 1, 2, . . . , b âˆ’1}, and let VG be the vector space of all complex-valued
functions on G. Equivalently, VG is the vector space of all complex-valued,
periodic functions on Z with period b.
We deï¬ne the Fourier transform of f, denoted by F(f), to be the peri-
odic function on Z deï¬ned by the sequence of uniquely determined values
Ë†f(0), Ë†f(1), . . . , Ë†f(b âˆ’1) .
Thus
F(f)(m) = Ë†f(m) .
Theorem 7.2 above gave us these coeï¬ƒcients as a linear combination of the
values f(k), with k = 0, 1, 2, . . . , b âˆ’1. Thus F(f) is a linear transformation
of the function f, thought of as a vector in VG. In other words, weâ€™ve shown
that F(f) is a one-to-one and onto linear transformation of VG.
The vector space VG is a vector space of dimension b; indeed, an explicit
basis can easily be given for VG using the â€œdelta functionsâ€ (see Exercise 7.7)
deï¬ned by
Î´m(x) :=
(
1
if x = m + kb, for some integer k,
0
otherwise.
In other words, Î´m(x) is the periodic function on Z that picks out the arith-
metic progression {m + kb : k âˆˆZ}.
But there is another natural basis for VG. For any ï¬xed integer a the roots
of unity {ea(x) := e2Ï€iax/b : x âˆˆZ} can be thought of as a single function

130
7 Finite Fourier Analysis
ea(x) âˆˆVG because of its periodicity on Z. As we saw in Theorem 7.2, the
functions {e1(x), . . . , eb(x)} give a basis for the vector space of functions VG.
A natural question now arises: how are the two bases related to each other?
An initial observation is
bÎ´a(n) = 1
b eâˆ’2Ï€ian/b,
which simply follows from the computation
bÎ´a(n) = 1
b
bâˆ’1
X
k=0
Î´a(k) Î¾âˆ’kn = 1
b Î¾âˆ’an = 1
b eâˆ’2Ï€ian/b.
So to get from the ï¬rst basis to the second basis, we need precisely the ï¬nite
Fourier transform!
It is extremely useful to deï¬ne the following inner product on this vector
space:
âŸ¨f, gâŸ©=
bâˆ’1
X
k=0
f(k) g(k) ,
(7.6)
for any two functions f, g âˆˆVG. Here the bar denotes complex conjugation.
The following elementary properties show that âŸ¨f, gâŸ©is an inner product (see
Exercise 7.8):
1. âŸ¨f, fâŸ©â‰¥0, with equality if and only if f = 0, the zero function.
2. âŸ¨f, gâŸ©= âŸ¨g, fâŸ©.
Equipped with this inner product, VG can now be regarded as a metric
space. We can now measure distances between any two functions, and in
particular between any two basis elements ea(x) := e2Ï€iax/b and ec(x) :=
e2Ï€icx/b. Any positive deï¬nite inner product gives rise to the distance function
d(f, g) = âŸ¨f âˆ’g, f âˆ’gâŸ©.
Lemma 7.5 (Orthogonality relations).
1
b âŸ¨ea, ecâŸ©= Î´a(c) =
(
1
if b | (a âˆ’c),
0
otherwise.
Proof. We compute the inner product
âŸ¨ea, ecâŸ©=
bâˆ’1
X
m=0
ea(m) ec(m) =
bâˆ’1
X
m=0
e2Ï€i(aâˆ’c)m/b.
If b | (aâˆ’c), then each term equals 1 in the latter sum, and hence the sum
equals b. This veriï¬es the ï¬rst case of the lemma.
If b âˆ¤(aâˆ’c), then eaâˆ’c(m) = e2Ï€im(aâˆ’c)/b is a nontrivial root of unity, and
we have the ï¬nite geometric series

7.4 The Parseval Identity
131
bâˆ’1
X
m=0
e
2Ï€i(aâˆ’c)m
b
= eb 2Ï€im(aâˆ’c)
b
âˆ’1
e
2Ï€im(aâˆ’c)
b
âˆ’1
= 0 ,
verifying the second case of the lemma.
âŠ“âŠ”
Example 7.6. We recall the sawtooth function again, since it is one of the
building blocks of lattice point enumeration, and compute its Fourier trans-
form. Namely, we deï¬ne
B(k) :=
k
b

=
( k
b
	
âˆ’1
2
if k
b /âˆˆZ,
0
if k
b âˆˆZ,
a periodic function on the integers with period b. What is its ï¬nite Fourier
transform? We have already seen the answer, in the course of the proof of
Lemma 7.3:
bB(n) = 1
2b
1 + Î¾n
1 âˆ’Î¾n = i
2b cot Ï€n
b
for n Ì¸= 0, and bB(0) = 0. As always, Î¾ = e2Ï€i/b.
âŠ“âŠ”
In the next section we delve more deeply into the behavior of this inner
product, where the Parseval identity is proved.
7.4 The Parseval Identity
A nontrivial property of the inner product deï¬ned above is the following iden-
tity, linking the â€œnorm of a functionâ€ to the â€œnorm of its Fourier transform.â€ It
is known as the Parseval identity, and also goes by the name of the Plancherel
theorem.
Theorem 7.7 (Parseval identity). For all f âˆˆVG,
âŸ¨f, fâŸ©= b âŸ¨Ë†f, Ë†fâŸ©.
Proof. Using the deï¬nition em(x) = Î¾mx and the relation
Ë†f(x) = 1
b
bâˆ’1
X
m=0
f(m) em(x)
from Theorem 7.2, we have

132
7 Finite Fourier Analysis
âŸ¨Ë†f, Ë†fâŸ©=
*
1
b
bâˆ’1
X
m=0
f(m) em , 1
b
bâˆ’1
X
n=0
f(n) en
+
= 1
b2
bâˆ’1
X
k=0
bâˆ’1
X
m=0
f(m) em(k)
bâˆ’1
X
n=0
f(n) en(k)
= 1
b2
bâˆ’1
X
m=0
bâˆ’1
X
n=0
f(m) f(n) âŸ¨em, enâŸ©
= 1
b
bâˆ’1
X
m=0
bâˆ’1
X
n=0
f(m) f(n) Î´m(n)
= 1
b âŸ¨f, fâŸ©,
where the essential step in the proof was using the orthogonality relations
(Lemma 7.5) in the fourth equality above.
âŠ“âŠ”
A basically identical proof yields the following stronger result, showing that
the â€œdistance between any two functionsâ€ is essentially equal to the â€œdistance
between their Fourier transforms.â€
Theorem 7.8. For all f, g âˆˆVG, we have
âŸ¨f, gâŸ©= b âŸ¨Ë†f, Ë†gâŸ©.
âŠ“âŠ”
Example 7.9. A nice application of the generalized Parseval identity above
now gives us Lemma 7.4 very quickly, the reformulation of the Dedekind sum
as a sum over roots of unity. Namely, we ï¬rst ï¬x an integer a relatively prime
to b and deï¬ne f(k) =
   k
b

, and g(k) =
   ka
b

. Then, using Example 7.6, we
have Ë†f(n) =
i
2b cot Ï€n
b . To ï¬nd the Fourier transform of g we need an extra
twist. Since
ka
b

= i
2b
bâˆ’1
X
m=1
cot Ï€m
b
Î¾mka,
we can multiply each index m by aâˆ’1, the multiplicative inverse of a modulo
b (recall that we require a and b to be relatively prime for the reformulation
of the Dedekind sum). Since aâˆ’1 is relatively prime to b, this multiplication
just permutes m = 1, 2, . . . , b âˆ’1 modulo b, but the sum stays invariant (see
Exercise 1.9):
bâˆ’1
X
m=1
cot Ï€m
b
Î¾mka =
bâˆ’1
X
m=1
cot Ï€maâˆ’1
b
Î¾maâˆ’1ka =
bâˆ’1
X
m=1
cot Ï€maâˆ’1
b
Î¾mk,
that is,
Ë†g(n) = i
2b
bâˆ’1
X
m=1
cot Ï€maâˆ’1
b
Î¾mk.

7.5 The Convolution of Finite Fourier Series
133
Hence Theorem 7.8 immediately gives us the reformulation of the Dedekind
sum:
s(a, b) :=
bâˆ’1
X
k=0
k
b
 ka
b

= b
bâˆ’1
X
m=1
 i
2b cot Ï€m
b
  i
2b cot Ï€maâˆ’1
b

= 1
4b
bâˆ’1
X
m=1
cot Ï€m
b
cot Ï€maâˆ’1
b
= 1
4b
bâˆ’1
X
m=1
cot Ï€ma
b
cot Ï€m
b
.
For the last equality, we again used the trick of replacing m by ma.
âŠ“âŠ”
7.5 The Convolution of Finite Fourier Series
Another basic tool in ï¬nite Fourier analysis is the convolution of two ï¬nite
Fourier series. Namely, let f(t) =
1
b
Pbâˆ’1
k=0 ak Î¾kt and g(t) =
1
b
Pbâˆ’1
k=0 ckÎ¾kt,
where Î¾ = e2Ï€i/b. We deï¬ne the convolution of f and g by
(f âˆ—g)(t) =
bâˆ’1
X
m=0
f(t âˆ’m)g(m) .
Indeed, it is this convolution tool (the proof of the convolution theorem be-
low is almost trivial!) that is responsible for the fastest known algorithm for
multiplying two polynomials of degree b in O(b log(b)) steps (see the Notes at
the end of this chapter).
Theorem 7.10 (Convolution theorem for ï¬nite Fourier series). Let
f(t) = 1
b
Pbâˆ’1
k=0 ak Î¾kt and g(t) = 1
b
Pbâˆ’1
k=0 ck Î¾kt, where Î¾ = e2Ï€i/b. Then their
convolution satisï¬es
(f âˆ—g)(t) = 1
b
bâˆ’1
X
k=0
akck Î¾kt.
Proof. The proof is straightforward: we just compute the left-hand side, and
obtain

134
7 Finite Fourier Analysis
bâˆ’1
X
m=0
f(t âˆ’m)g(m) = 1
b2
bâˆ’1
X
m=0
 bâˆ’1
X
k=0
ak Î¾k(tâˆ’m)
!  bâˆ’1
X
l=0
cl Î¾lm
!
= 1
b2
bâˆ’1
X
k=0
bâˆ’1
X
l=0
akcl
 bâˆ’1
X
m=0
Î¾kt+(lâˆ’k)m
!
= 1
b
bâˆ’1
X
k=0
akck Î¾kt,
because the sum Pbâˆ’1
m=0 Î¾(lâˆ’k)m vanishes, unless l = k (see Exercise 7.6). In
the case that l = k, we have Pbâˆ’1
m=0 Î¾(lâˆ’k)m = b.
âŠ“âŠ”
It is an easy exercise (Exercise 7.22) to show that this convolution theorem
is equivalent to the following statement:
F(f âˆ—g) = b F(f)F(g) .
Note that the proof of Theorem 7.10 is essentially identical with the proof of
Lemma 7.4 above; we could have proved the lemma, in fact, by applying the
convolution theorem. We now show how Theorem 7.10 can be used to derive
identities on trigonometric functions.
Example 7.11. We claim that
bâˆ’1
X
k=1
cot2
Ï€k
b

= (b âˆ’1)(b âˆ’2)
3
.
The sum suggests the use of the convolution theorem, with a function whose
Fourier coeï¬ƒcients are ak = ck = cot Ï€k
b . But we already know such a function!
It is just the sawtooth function 2b
i
   m
b

. Therefore
âˆ’1
4b
bâˆ’1
X
k=1
cot2
Ï€k
b

Î¾kt =
bâˆ’1
X
m=1
t âˆ’m
b
 m
b

,
where the equality follows from Theorem 7.10. On setting t = 0, we obtain
bâˆ’1
X
m=1
âˆ’m
b
 m
b

= âˆ’
bâˆ’1
X
m=1
m
b
 m
b

= âˆ’1
b2
bâˆ’1
X
m=1
m2 + 1
b
bâˆ’1
X
m=1
m âˆ’1
4(b âˆ’1)
= âˆ’(b âˆ’1)(b âˆ’2)
12b
,
as desired. We used the identity
   âˆ’m
b

= âˆ’
   m
b

in the ï¬rst equality above,
and some algebra was used in the last equality. Notice, moreover, that the
convolution theorem gave us more than we asked for, namely an identity for
every value of t.
âŠ“âŠ”

Exercises
135
Notes
1. Finite Fourier analysis oï¬€ers a wealth of applications and is, for example,
one of the main tools in quantum information theory. For the reader inter-
ested in going further than the humble beginnings outlined in this chapter,
we heartily recommend Audrey Terrasâ€™s monograph [180].
2. The Dedekind sum is our main motivation for studying ï¬nite Fourier series,
and in fact, Chapter 8 is devoted to a detailed investigation of these sums, in
which the Fourierâ€“Dedekind sums of Chapter 1 also ï¬nally reappear.
3. The reader may consult [116, p. 501] for a proof that two polynomials of
degree N can be multiplied in O(N log N) steps. The actual proof of this fact
runs along the following conceptual lines. First, let the two given polynomials
of degree N be f(x) = PN
n=0 a(n)xn and g(x) = PN
n=0 b(n)xn. Then we know
that f(Î¾) and g(Î¾) are two ï¬nite Fourier series, and we abbreviate them by
f and g, respectively. We now note that fg = F(Fâˆ’1(f) âˆ—Fâˆ’1(g)). If we
can compute the ï¬nite Fourier transform (and its inverse) quickly, then this
argument shows that we can multiply polynomials quickly. It is a fact of life
that we can compute the Fourier transform of a periodic function of period
N in O(N log N) steps, by an algorithm known as the fast Fourier transform
(again, see [116] for a complete description).
4. The continuous Fourier transform, deï¬ned by
R âˆ
âˆ’âˆf(t)eâˆ’2Ï€itxdt, can be
related to the ï¬nite Fourier transform in the following way. We approximate
the continuous integral by discretizing a large interval [0, a]. Precisely, we let
âˆ†:= a
b , and we let tk := kâˆ†= ka
b . Then
Z a
0
f(t)eâˆ’2Ï€itxdt â‰ˆ
b
X
k=1
f(tk)eâˆ’2Ï€itkxtk ,
a ï¬nite Fourier series for the function f( a
b x) as a function of x âˆˆZ. Hence
ï¬nite Fourier series ï¬nd an application to continuous Fourier analysis as an
approximation tool.
Exercises
Throughout the exercises, we ï¬x an integer b > 1 and let Î¾ = e2Ï€i/b.
7.1. â™£Show that 1 âˆ’xb = Qb
k=1(1 âˆ’Î¾kx).
7.2. â™£Show that Qbâˆ’1
k=1(1 âˆ’Î¾k) = b.

136
7 Finite Fourier Analysis
7.3. Consider the matrix that came up in the proof of Theorem 7.2, namely
L = (aij), with aij := Î¾(iâˆ’1)(jâˆ’1) and with 1 â‰¤i, j â‰¤b. Show that the matrix
1
âˆš
bL is a unitary matrix (recall that a matrix U is unitary if U âˆ—U = I, where
U âˆ—is the conjugate transpose of U). Thus, this exercise shows that the Fourier
transform of a periodic function is always given by a unitary transformation.
7.4. Show that
det

1
âˆš
bL
 = 1, where |z| denotes the norm of the complex
number z. (It turns out the det(L) can sometimes be a complex number, but
we will not use this fact here.)
7.5. â™£For any integer a relatively prime to b, show that
1
b
bâˆ’1
X
k=1
k Î¾âˆ’ak =
Î¾a
1 âˆ’Î¾a .
7.6. â™£Let n be an integer. Show that the sum Pbâˆ’1
k=0 Î¾kn vanishes, unless
n â‰¡0 (mod b), in which case it is equal to b.
7.7. â™£For an integer m, deï¬ne the delta function Î´m(x) by
Î´m(x) =
(
1
if x = m + ab, for some integer a,
0
otherwise.
The b functions Î´1(x), . . . , Î´b(x) are clearly in the vector space VG, since they
are periodic on Z with period b. Show that they form a basis for VG.
7.8. â™£Prove that for all f, g âˆˆVG:
(a) âŸ¨f, fâŸ©â‰¥0, with equality if and only if f = 0, the zero function.
(b) âŸ¨f, gâŸ©= âŸ¨g, fâŸ©.
7.9. Show that Pbâˆ’1
k=1
1
1âˆ’Î¾k = bâˆ’1
2 .
7.10. Show that âŸ¨Î´a, Î´câŸ©= Î´a(c).
7.11. Prove that (f âˆ—Î´a)(x) = f(x âˆ’a).
7.12. Prove that Î´a âˆ—Î´c = Î´a+c(mod b).
7.13. Prove that
\
f(x âˆ’a) = bf(x)e
2Ï€iax
b
.
7.14. â™£For any real number x, prove that ((x)) = Pbâˆ’1
k=0
   x+k
b

.
7.15. If x is not an integer, show that Pbâˆ’1
n=0 cot
 Ï€ n+x
b

= b cot (Ï€x).

Exercises
137
7.16. For any integer a relatively prime to b, show that
X
Î¾
Î¾a+1 âˆ’1
(Î¾a âˆ’1)(Î¾ âˆ’1) = 0 ,
where the sum is taken over all bth roots of unity Î¾ except Î¾ = 1.
7.17. We call a root of unity e2Ï€ia/b a primitive bth root of unity if a is
relatively prime to b. Let Î¦b(x) denote the polynomial with leading coeï¬ƒcient
1 and of degree Ï†(b)1 whose roots are the Ï†(b) distinct primitive bth roots of
unity. This polynomial is known as the cyclotomic polynomial of order b. Show
that
Y
d|b
Î¦d(x) = xb âˆ’1 ,
where the product is taken over all positive divisors d of b.
7.18. We deï¬ne the MÂ¨obius Âµ-function for positive integers n by
Âµ(n) =
ï£±
ï£´
ï£²
ï£´
ï£³
1
if n = 1,
0
if n is divisible by a square,
(âˆ’1)k
if n is square-free and has k prime divisors.
Deduce from the previous exercise that
Î¦b(x) =
Y
d|b
 xd âˆ’1
Âµ(b/d) .
7.19. Prove that for any positive integer b,
X
1â‰¤aâ‰¤b,(a,b)=1
e2Ï€ia/b = Âµ(b) ,
the MÂ¨obius Âµ-function.
7.20. Show that for any positive integer k, s(1, k) = âˆ’1
4 +
1
6k + k
12.
7.21. Show that Pbâˆ’1
k=1 tan2   Ï€k
b

= b(b âˆ’1).
7.22. â™£Show that Theorem 7.10 is equivalent to the following statement:
F(f âˆ—g) = b F(f)F(g) .
7.23. Consider the trace of the linear transformation L =
 Î¾(iâˆ’1)(jâˆ’1)
, de-
ï¬ned in (7.3). The trace of L is G(b) := Pbâˆ’1
m=0 Î¾m2, known as a GauÃŸ sum.
Show that |G(b)| =
âˆš
b if b is an odd prime.
1 Ï†(b) := # {k âˆˆ[1, b âˆ’1] : (k, b) = 1} is the Euler Ï†-function.


8
Dedekind Sums, the Building Blocks
of Lattice-point Enumeration
If things are nice there is probably a good reason why they are nice: and if you donâ€™t
know at least one reason for this good fortune, then you still have work to do.
Richard Askey
Weâ€™ve encountered Dedekind sums in our study of ï¬nite Fourier analysis and
we became intimately acquainted with their siblings in our study of the coin-
exchange problem in Chapter 1. They have one shortcoming, however (which
weâ€™ll remove): the deï¬nition of s(a, b) requires us to sum over b terms, which
is rather slow when b = 2100, for example. Luckily, there is a magical reci-
procity law for the Dedekind sum s(a, b) that allows us to compute it in
roughly log2(b) = 100 steps. This is the kind of magic that saves the day
when we try to enumerate lattice points in integral polytopes of dimensions
d â‰¤4. There is an ongoing eï¬€ort to extend these ideas to higher dimensions,
but there is much room for improvement. In this chapter we focus on the
computational-complexity issues that arise when we try to compute Dedekind
sums explicitely.
8.1 Fourierâ€“Dedekind Sums and the Coin-Exchange
Problem Revisited
Recall from Chapter 1 the Fourierâ€“Dedekind sum (deï¬ned in (1.13))
sn (a1, a2, . . . , ad; b) = 1
b
bâˆ’1
X
k=1
Î¾kn
b

1 âˆ’Î¾ka1
b
 
1 âˆ’Î¾ka2
b

Â· Â· Â·

1 âˆ’Î¾kad
b
 ,
which appeared as a main player in our analysis of the Frobenius coin-
exchange problem. We can now recognize the Fourierâ€“Dedekind sums as hon-
est ï¬nite Fourier series with period b. The Fourierâ€“Dedekind sums unify many

140
8 Dedekind Sums, the Building Blocks of Lattice-point Enumeration
variations of the Dedekind sum that have appeared in the literature, and form
the building blocks of Ehrhart quasipolynomials. For example, we showed in
Chapter 1 that sn (a1, a2, . . . , ad; b) appears in the Ehrhart quasipolynomial
of the d-simplex
n
(x1, . . . , xd+1) âˆˆRd+1
â‰¥0 : a1x1 + Â· Â· Â· + adxd + bxd+1 = 1
o
.
Example 8.1. We ï¬rst notice that when n = 0 and d = 2, the Fourierâ€“
Dedekind sum reduces to a classical Dedekind sum (whichâ€”ï¬nallyâ€”explains
the name): for relatively prime positive integers a and b,
s0(a, 1; b) = 1
b
bâˆ’1
X
k=1
1
 1 âˆ’Î¾ka
b
  1 âˆ’Î¾k
b

= 1
b
bâˆ’1
X
k=1

1
1 âˆ’Î¾ka
b
âˆ’1
2
 
1
1 âˆ’Î¾k
b
âˆ’1
2

+ 1
2b
bâˆ’1
X
k=1
1
1 âˆ’Î¾k
b
+ 1
2b
bâˆ’1
X
k=1
1
1 âˆ’Î¾ka
b
âˆ’1
b
bâˆ’1
X
k=1
1
4
= 1
4b
bâˆ’1
X
k=1
1 + Î¾ka
b
1 âˆ’Î¾ka
b
 1 + Î¾k
b
1 âˆ’Î¾k
b

+ 1
b
bâˆ’1
X
k=1
1
1 âˆ’Î¾k
b
âˆ’b âˆ’1
4b
.
In the last step we used the fact that multiplying the index k by a does not
change the middle sum. This middle sum can be further simpliï¬ed by recalling
(1.8):
1
b
bâˆ’1
X
k=1
1
 1 âˆ’Î¾k
b

Î¾kn
b
= âˆ’
nn
b
o
+ 1
2 âˆ’1
2b ,
whence
s0(a, 1; b) = 1
4b
bâˆ’1
X
k=1
1 + Î¾ka
b
1 âˆ’Î¾ka
b
 1 + Î¾k
b
1 âˆ’Î¾k
b

+ 1
2 âˆ’1
2b âˆ’b âˆ’1
4b
= âˆ’1
4b
bâˆ’1
X
k=1
cot
Ï€ka
b

cot
Ï€k
b

+ b âˆ’1
4b
(8.1)
= âˆ’s(a, b) + b âˆ’1
4b
.
âŠ“âŠ”
Example 8.2. The next special evaluation of a Fourierâ€“Dedekind sum is very
similar to the computation above, so that we leave it to the reader to prove
(Exercise 8.5) that for a1, a2 relatively prime to b,
s0 (a1, a2; b) = âˆ’s
 a1aâˆ’1
2 , b

+ b âˆ’1
4b
,
(8.2)
where aâˆ’1
2 a2 â‰¡1 mod b.
âŠ“âŠ”

8.1 Fourierâ€“Dedekind Sums and the Coin-Exchange Problem Revisited
141
Returning to the general Fourierâ€“Dedekind sum, we now prove the ï¬rst
of a series of reciprocity laws: identities for certain sums of Fourierâ€“Dedekind
sums. We ï¬rst recall how these sums came up in Chapter 1, namely, from the
partial fraction expansion of the function
f(z) =
1
(1 âˆ’za1) Â· Â· Â· (1 âˆ’zad) zn
= A1
z + A2
z2 + Â· Â· Â· + An
zn +
B1
z âˆ’1 +
B2
(z âˆ’1)2 + Â· Â· Â· +
Bd
(z âˆ’1)d
(8.3)
+
a1âˆ’1
X
k=1
C1k
z âˆ’Î¾ka1
+
a2âˆ’1
X
k=1
C2k
z âˆ’Î¾ka2
+ Â· Â· Â· +
adâˆ’1
X
k=1
Cdk
z âˆ’Î¾kad
.
(Here we assume that a1, a2, . . . , ad are pairwise relatively prime.) Theo-
rem 1.7 states that with the help of the partial fraction coeï¬ƒcients B1, . . . , Bd
and Fourierâ€“Dedekind sums, we can compute the restricted partition function
for A = {a1, a2, . . . , ad}:
pA(n) = âˆ’B1 + B2 âˆ’Â· Â· Â· + (âˆ’1)dBd + sâˆ’n (a2, a3, . . . , ad; a1)
+ sâˆ’n (a1, a3, a4, . . . , ad; a2) + Â· Â· Â· + sâˆ’n (a1, a2, . . . , adâˆ’1; ad) .
We note that B1, B2, . . . , Bd are polynomials in n (Exercise 8.6), whence we
call
polyA(n) := âˆ’B1 + B2 âˆ’Â· Â· Â· + (âˆ’1)dBd
the polynomial part of the restricted partition function pA(n).
Example 8.3. The ï¬rst few expressions for poly{a1,...,ad}(n) are
poly{a1}(n) = 1
a1
,
poly{a1,a2}(n) =
n
a1a2
+ 1
2
 1
a1
+ 1
a2

,
poly{a1,a2,a3}(n) =
n2
2a1a2a3
+ n
2

1
a1a2
+
1
a1a3
+
1
a2a3

(8.4)
+ 1
12
 3
a1
+ 3
a2
+ 3
a3
+
a1
a2a3
+
a2
a1a3
+
a3
a1a2

,

142
8 Dedekind Sums, the Building Blocks of Lattice-point Enumeration
poly{a1,a2,a3,a4}(n) =
n3
6a1a2a3a4
+ n2
4

1
a1a2a3
+
1
a1a2a4
+
1
a1a3a4
+
1
a2a3a4

+ n
4

1
a1a2
+
1
a1a3
+
1
a1a4
+
1
a2a3
+
1
a2a4
+
1
a3a4

+ n
12

a1
a2a3a4
+
a2
a1a3a4
+
a3
a1a2a4
+
a4
a1a2a3

+ 1
24
 a1
a2a3
+
a1
a2a4
+
a1
a3a4
+
a2
a1a3
+
a2
a1a4
+
a2
a3a4
+ a3
a1a2
+
a3
a1a4
+
a3
a2a4
+
a4
a1a2
+
a4
a1a3
+
a4
a2a3

+ 1
8
 1
a1
+ 1
a2
+ 1
a3
+ 1
a4

.
âŠ“âŠ”
We are about to combine the Ehrhart results of Chapter 3 with the partial
fraction expansion of Chapter 1 that gave rise to the Fourierâ€“Dedekind sums.
Theorem 8.4 (Zagier reciprocity). For any pairwise relatively prime pos-
itive integers a1, a2, . . . , ad,
s0 (a2, a3, . . . , ad; a1) + s0 (a1, a3, a4, . . . , ad; a2) + Â· Â· Â·
+ s0 (a1, a2, . . . , adâˆ’1; ad)
= 1 âˆ’poly{a1,a2,...,ad}(0) .
At ï¬rst sight, this reciprocity law should come as a surprise. The Fourierâ€“
Dedekind sums can be complicated, long sums, yet when combined in this
fashion, they add up to a trivial rational function in a1, a2, . . . , ad.
Proof. We compute the constant term of the quasipolynomial pA(n):
pA(0) = polyA(0) + s0 (a2, a3, . . . , ad; a1)
+ s0 (a1, a3, a4, . . . , ad; a2) + Â· Â· Â· + s0 (a1, a2, . . . , adâˆ’1; ad) .
On the other hand, Exercise 3.27 (the extension of Corollary 3.15 to Ehrhart
quasipolynomials) states that pA(0) = 1, whence
1 = polyA(0) + s0 (a2, a3, . . . , ad; a1)
+ s0 (a1, a3, a4, . . . , ad; a2) + Â· Â· Â· + s0 (a1, a2, . . . , adâˆ’1; ad) .
âŠ“âŠ”

8.2 The Dedekind Sum and Its Reciprocity and Computational Complexity
143
8.2 The Dedekind Sum and Its Reciprocity
and Computational Complexity
We derived in (8.1) the classical Dedekind sum s(a, b) as a special evaluation
of the Fourierâ€“Dedekind sum. Naturally, Theorem 8.4 takes on a particular
form when we specialize this reciprocity law to the classical Dedekind sum.
Corollary 8.5 (Dedekindâ€™s reciprocity law). For any relatively prime
positive integers a and b,
s(a, b) + s(b, a) = 1
12
a
b + b
a + 1
ab

âˆ’1
4 .
Proof. A special case of Theorem 8.4 is
s0(a, 1; b) + s0(b, a; 1) + s0(1, b; a) = 1 âˆ’poly{a,1,b}(0)
= 1 âˆ’1
12
3
a + 3 + 3
b + a
b + 1
ab + b
a

= 3
4 âˆ’1
12
a
b + b
a + 1
ab

âˆ’1
4a âˆ’1
4b .
Now we use the fact that s0(b, a; 1) = 0 and the identity (8.1):
s0(a, 1; b) = âˆ’s(a, b) + 1
4 âˆ’1
4b .
âŠ“âŠ”
Dedekindâ€™s reciprocity law allows us to compute the Dedekind sum s(a, b)
as quickly as the gcd algorithm for a and b. Letâ€™s get a better feeling for
the way we can compute the Dedekind sum by working out an example. We
remind the reader of another crucial property of the Dedekind sums that we
already pointed out in (7.5): s(a, b) remains invariant when we replace a by
its residue modulo b, that is,
s(a, b) = s(a mod b, b) .
(8.5)
Example 8.6. Let a = 100 and b = 147. Now we alternately use Corollary 8.5
and the reduction identity (8.5):

144
8 Dedekind Sums, the Building Blocks of Lattice-point Enumeration
s(100, 147) = 1
12
100
147 + 147
100 +
1
14700

âˆ’1
4 âˆ’s(147, 100)
= âˆ’1249
17640 âˆ’s(47, 100)
= âˆ’1249
17640 âˆ’
 1
12
 47
100 + 100
47 +
1
4700

âˆ’1
4 âˆ’s(100, 47)

= âˆ’773
20727 + s(6, 47)
= âˆ’773
20727 + 1
12
 6
47 + 47
6 +
1
282

âˆ’1
4 âˆ’s(47, 6)
= 166
441 âˆ’s(5, 6)
= 166
441 âˆ’
 1
12
5
6 + 6
5 + 1
30

âˆ’1
4 âˆ’s(6, 5)

= 2003
4410 + s(1, 5)
= 2003
4410 âˆ’1
4 + 1
30 + 5
12
= 577
882 .
In the last step we used Exercise 7.20: s(1, k) = âˆ’1
4 +
1
6k +
k
12. A priori,
s(100, 147) takes 147 steps to compute, whereas we were able to compute it
in nine steps using Dedekindâ€™s reciprocity law and (8.5).
âŠ“âŠ”
As a second corollary to Theorem 8.4, we mention the following three-
term reciprocity law for the special Fourierâ€“Dedekind sum s0(a, b; c). This
reciprocity law could be restated in terms of the classical Dedekind sum via
the identity (8.2).
Corollary 8.7. For pairwise relatively prime positive integers a, b, and c,
s0(a, b; c) + s0(c, a; b) + s0(b, c; a) = 1 âˆ’1
12
3
a + 3
b + 3
c + a
bc + b
ca + c
ab

.
âŠ“âŠ”
8.3 Rademacher Reciprocity for the Fourierâ€“Dedekind
Sum
The next reciprocity law will be again for the general Fourierâ€“Dedekind sums.
It extends Theorem 8.4 beyond n = 0.
Theorem 8.8 (Rademacher reciprocity). Let a1, a2, . . . , ad be pairwise
relatively prime positive integers. Then for n = 1, 2, . . . , (a1 + Â· Â· Â· + ad âˆ’1),

8.3 Rademacher Reciprocity for the Fourierâ€“Dedekind Sum
145
sn (a2, a3, . . . , ad; a1) + sn (a1, a3, a4, . . . , ad; a2) + Â· Â· Â·
+ sn (a1, a2, . . . , adâˆ’1; ad) = âˆ’poly{a1,a2,...,ad}(âˆ’n) .
Proof. We recall the deï¬nition
pâ—¦
A(n) = #

(m1, . . . , md) âˆˆZd : all mj > 0, m1a1 + Â· Â· Â· + mdad = n
	
of Exercise 1.31, that is, pâ—¦
A(n) counts the number of partitions of n using
only the elements of A as parts, where each part is used at least once. This
counting function is, naturally, connected to pA through Ehrhartâ€“Macdonald
reciprocity (Theorem 4.1):
pâ—¦
A(n) = (âˆ’1)dâˆ’1pA(âˆ’n) ,
that is,
(âˆ’1)dâˆ’1pâ—¦
A(n) = polyA(âˆ’n) + sn (a2, a3, . . . , ad; a1)
+ sn (a1, a3, a4, . . . , ad; a2) + Â· Â· Â· + sn (a1, a2, . . . , adâˆ’1; ad) .
On the other hand, by its very deï¬nition,
pâ—¦
A(n) = 0
for n = 1, 2, . . . , (a1 + Â· Â· Â· + ad âˆ’1) ,
so that for those n,
0 = polyA(âˆ’n) + sn (a2, a3, . . . , ad; a1)
+ sn (a1, a3, a4, . . . , ad; a2) + Â· Â· Â· + sn (a1, a2, . . . , adâˆ’1; ad) .
âŠ“âŠ”
Just as Zagier reciprocity takes on a special form for the classical Dedekind
sum, Rademacher reciprocity specializes for d = 2 to a reciprocity identity for
the Dedekindâ€“Rademacher sum
rn(a, b) :=
bâˆ’1
X
k=0
ka + n
b
 k
b

.
The classical Dedekind sum is, naturally, the specialization r0(a, b) = s(a, b).
To be able to state the reciprocity law for the Dedekindâ€“Rademacher sums,
we deï¬ne the function
Ï‡a(n) :=
(
1
if a|n,
0
otherwise,
which will come in handy as a book keeping device.
Corollary 8.9 (Reciprocity law for Dedekindâ€“Rademacher sums).
Let a and b be relatively prime positive integers. Then for n = 1, 2, . . . , a + b,

146
8 Dedekind Sums, the Building Blocks of Lattice-point Enumeration
rn(a, b) + rn(b, a) = n2
2ab âˆ’n
2
 1
ab + 1
a + 1
b

+ 1
12
a
b + b
a + 1
ab

+ 1
2
aâˆ’1n
b

+
bâˆ’1n
a

+
n
a

+
n
b

+ 1
4 (1 + Ï‡a(n) + Ï‡b(n)) ,
where aâˆ’1a â‰¡1 mod b and bâˆ’1b â‰¡1 mod a.
This identity follows almost instantly once we are able to express the
Dedekindâ€“Rademacher sum in terms of Fourierâ€“Dedekind sums.
Lemma 8.10. Suppose a and b are relatively prime positive integers and n âˆˆ
Z. Then
rn(a, b) = âˆ’sn(a, 1; b) + 1
2
n
b

+ 1
2
naâˆ’1
b

âˆ’1
4b + 1
4 Ï‡b(n) ,
where aâˆ’1a â‰¡1 mod b.
Proof. We start by rewriting the ï¬nite Fourier series (1.8) for the sawtooth
function ((x)):
1
b
bâˆ’1
X
k=1
Î¾kn
b
1 âˆ’Î¾k
b
= âˆ’
âˆ’n
b

+ 1
2 âˆ’1
2b
= âˆ’
âˆ’n
b

+ 1
2 Ï‡b(n) âˆ’1
2b
=
n
b

+ 1
2 Ï‡b(n) âˆ’1
2b .
Hence we also have
1
b
bâˆ’1
X
k=1
Î¾kn
b
1 âˆ’Î¾ka
b
= 1
b
bâˆ’1
X
k=1
Î¾kaâˆ’1n
b
1 âˆ’Î¾k
b
=
aâˆ’1n
b

+ 1
2 Ï‡b
 aâˆ’1n

âˆ’1
2b
=
aâˆ’1n
b

+ 1
2 Ï‡b (n) âˆ’1
2b .
Now we use the convolution theorem for ï¬nite Fourier series (Theorem 7.10)
for the functions
f(n) := 1
b
bâˆ’1
X
k=1
Î¾kn
b
1 âˆ’Î¾k
b
and
g(n) := 1
b
bâˆ’1
X
k=1
Î¾kn
b
1 âˆ’Î¾ka
b
.
It gives

8.4 The Mordellâ€“Pommersheim Tetrahedron
147
1
b
bâˆ’1
X
k=1
Î¾kn
b
 1 âˆ’Î¾k
b
  1 âˆ’Î¾ka
b
 =
bâˆ’1
X
m=0
f(n âˆ’m) g(m) =
bâˆ’1
X
m=0
n âˆ’m
b

+ 1
2 Ï‡b(n âˆ’m) âˆ’1
2b
 aâˆ’1m
b

+ 1
2 Ï‡b (m) âˆ’1
2b

.
We invite the reader to check (Exercise 8.9) that the sum on the right-hand
side simpliï¬es to
âˆ’
bâˆ’1
X
m=0
am + n
b
 m
b

+ 1
2
aâˆ’1n
b

+ 1
2
n
b

âˆ’1
4b + 1
4 Ï‡b(n) ,
whence
sn(a, 1; b) = âˆ’rn(a, b) + 1
2
aâˆ’1n
b

+ 1
2
n
b

âˆ’1
4b + 1
4 Ï‡b(n) .
âŠ“âŠ”
Proof of Corollary 8.9. We use the special case of Theorem 8.8
sn(a, 1; b) + sn(1, a; b) + sn(a, b; 1) = âˆ’poly{a,1,b}(âˆ’n)
= âˆ’n2
2ab + n
2
 1
ab + 1
a + 1
b

âˆ’1
12
3
a + 3
b + 3 + a
b + b
a + 1
ab

,
which holds for n = 1, 2, . . . , a + b. Lemma 8.10 allows us to translate this
identity into one for Dedekindâ€“Rademacher sums:
rn(a, b) + rn(b, a) = n2
2ab âˆ’n
2
 1
ab + 1
a + 1
b

+ 1
12
a
b + b
a + 1
ab

+ 1
2
aâˆ’1n
b

+
bâˆ’1n
a

+
n
a

+
n
b

+ 1
4 (1 + Ï‡a(n) + Ï‡b(n)) .
âŠ“âŠ”
The two-term reciprocity law allows us to compute the Dedekindâ€“
Rademacher sum as quickly as the gcd algorithm, just as obtained for the clas-
sical Dedekind sum. This fact has an interesting consequence: In Theorem 2.10
and Exercise 2.34 we showed implicitly (see Exercise 8.10) that Dedekindâ€“
Rademacher sums are the only nontrivial ingredients of the Ehrhart quasi-
polynomials of rational polygons. Corollary 8.9 ensures that these Ehrhart
quasipolynomials can be computed almost instantly.
8.4 The Mordellâ€“Pommersheim Tetrahedron
In this section we return to Ehrhart polynomials and illustrate how Dedekind
sums appear naturally in generating-function computations. We will study

148
8 Dedekind Sums, the Building Blocks of Lattice-point Enumeration
the tetrahedron that historically ï¬rst gave rise to the connection of Dedekind
sums and lattice-point enumeration in polytopes. It is given by
P =
n
(x, y, z) âˆˆR3 : x, y, z â‰¥0, x
a + y
b + z
c â‰¤1
o
,
(8.6)
a tetrahedron with vertices (0, 0, 0), (a, 0, 0), (0, b, 0), and (0, 0, c), where a, b, c
are positive integers. We insert the slack variable n and interpret
LP(t) = #

(k, l, m) âˆˆZ3 : k, l, m â‰¥0, k
a + l
b + m
c â‰¤t

= #

(k, l, m, n) âˆˆZ4 : k, l, m, n â‰¥0, bck + acl + abm + n = abct
	
as the Taylor coeï¬ƒcient of zabct for the function
ï£«
ï£­X
kâ‰¥0
zbck
ï£¶
ï£¸
ï£«
ï£­X
lâ‰¥0
zacl
ï£¶
ï£¸
ï£«
ï£­X
mâ‰¥0
zabm
ï£¶
ï£¸
ï£«
ï£­X
nâ‰¥0
zn
ï£¶
ï£¸
=
1
(1 âˆ’zbc) (1 âˆ’zac) (1 âˆ’zab) (1 âˆ’z) .
As we have done numerous times before, we shift this coeï¬ƒcient to the con-
stant term:
LP(t) = const

1
(1 âˆ’zbc) (1 âˆ’zac) (1 âˆ’zab) (1 âˆ’z) zabct

.
To reduce the number of poles, it is convenient to change this function slightly;
the constant term of 1/
 1 âˆ’zbc
(1 âˆ’zac)
 1 âˆ’zab
(1 âˆ’z) is 1, so that
LP(t) = const

zâˆ’abct âˆ’1
(1 âˆ’zbc) (1 âˆ’zac) (1 âˆ’zab) (1 âˆ’z)

+ 1 .
This trick becomes useful in the next step, namely expanding the function into
partial fractions. Strictly speaking, we cannot do that, since the numerator
is not a polynomial in z. However, we can think of this rational function as
a sum of two functions. The higher-order poles of both summands that we
will not include in our computation below cancel each other, so we can ignore
them at this stage. The only poles of
zâˆ’abct âˆ’1
(1 âˆ’zbc) (1 âˆ’zac) (1 âˆ’zab) (1 âˆ’z)
(8.7)
are at the ath, bth, cth roots of unity and at 0. (As before, we donâ€™t have
to bother with the coeï¬ƒcients of z = 0 of the partial fraction expansion.) To
make life momentarily easier (the general case is the subject of Exercise 8.12),
letâ€™s assume that a, b, and c are pairwise relatively prime; then all the poles
besides 0 and 1 are simple. The computation of the coeï¬ƒcients for z = 1 is

8.4 The Mordellâ€“Pommersheim Tetrahedron
149
very similar to what we did with the restricted partition function in Chapter 1.
The coeï¬ƒcient in the partial fraction expansion of a nontrivial root of unity,
say Î¾k
a, is also computed practically as easily as in earlier examples: it is
âˆ’
t
a (1 âˆ’Î¾kbc
a
) (1 âˆ’Î¾ka)
(8.8)
(see Exercise 8.11). Summing this fraction over k = 1, 2, . . . , a âˆ’1 gives rise
to the Fourierâ€“Dedekind sum
âˆ’t
a
aâˆ’1
X
k=1
1
(1 âˆ’Î¾kbc
a
) (1 âˆ’Î¾ka) = âˆ’t s0 (bc, 1; a) .
Putting this coeï¬ƒcient and its siblings for the other roots of unity into the par-
tial fraction expansion and computing the constant term yields (Exercise 8.11)
LP(t) = abc
6 t3 + ab + ac + bc + 1
4
t2
+
a + b + c
4
+ 1
4
1
a + 1
b + 1
c

+ 1
12
bc
a + ca
b + ab
c + 1
abc

t
+ (s0 (bc, 1; a) + s0 (ca, 1; b) + s0 (ab, 1; c)) t
+ 1 .
We recognize instantly that the Fourierâ€“Dedekind sums in this Ehrhart poly-
nomial are in fact classical Dedekind sums by (8.1), and so we arrive at the
following celebrated result.
Theorem 8.11. Let P be given by (8.6) with a, b, and c pairwise relatively
prime. Then
LP(t) = abc
6 t3 + ab + ac + bc + 1
4
t2 +
3
4 + a + b + c
4
+ 1
12
bc
a + ca
b + ab
c + 1
abc

âˆ’s (bc, a) âˆ’s (ca, b) âˆ’s (ab, c)

t + 1 .
âŠ“âŠ”
We ï¬nish this chapter by giving the Ehrhart series of the Mordellâ€“
Pommersheim tetrahedron P. It follows simply from the transformation for-
mulas (computing the Ehrhart numerator coeï¬ƒcients from the Ehrhart poly-
nomial coeï¬ƒcients) of Corollary 3.16 and Exercise 3.10, and hence the Ehrhart
series of P naturally contains Dedekind sums.
Corollary 8.12. Let P be given by (8.6) with a, b, and c pairwise relatively
prime. Then
EhrP(z) = h3 z3 + h2 z2 + h1 z + 1
(1 âˆ’z)4
,

150
8 Dedekind Sums, the Building Blocks of Lattice-point Enumeration
where
h3 = abc
6 âˆ’ab + ac + bc + a + b + c
4
âˆ’1
2 + 1
12
bc
a + ca
b + ab
c + 1
abc

âˆ’s (bc, a) âˆ’s (ca, b) âˆ’s (ab, c)
h2 = 2abc
3
+ a + b + c
2
+ 3
2 + 1
6
bc
a + ca
b + ab
c + 1
abc

âˆ’2 (s (bc, a) + s (ca, b) + s (ab, c))
h1 = abc
6 + ab + ac + bc + a + b + c
4
âˆ’2 + 1
12
bc
a + ca
b + ab
c + 1
abc

âˆ’s (bc, a) âˆ’s (ca, b) âˆ’s (ab, c) .
âŠ“âŠ”
It is a curious fact that the above expressions for h1, h2, and h3 are non-
negative integers due to Corollary 3.11.
Notes
1. The classical Dedekind sums came to life in the 1880s when Richard
Dedekind (1831â€“1916)1 studied the transformation properties of the Dedekind
Î·-function [70]
Î·(z) := eÏ€iz/12 Y
nâ‰¥1
 1 âˆ’e2Ï€inz
,
a useful computational gadget in the land of modular forms in number theory.
Dedekindâ€™s reciprocity law (Corollary 8.5) follows from one of the functional
transformation identities for Î·. Dedekind also proved that
12k s(h, k) â‰¡k + 1 âˆ’2
h
k

(mod 8) ,
establishing a beautiful connection between the Dedekind sum and the Jacobi
symbol
  h
k

(the reader may want to consult the lovely Carus monograph
entitled Dedekind Sums, by Emil Grosswald and Hans Rademacher, where the
above result is proved [151, p. 34]), and then used this identity to show that
the reciprocity law for the Dedekind sums (for which [151] contains several
diï¬€erent proofs) is equivalent to the reciprocity law for the Jacobi symbol.
2. The Dedekind sums and their generalizations appear in various contexts be-
sides analytic number theory and discrete geometry. Other mathematical areas
in which Dedekind sums show up include topology [101, 131, 190], algebraic
number theory [129, 166], and algebraic geometry [85]. They also have con-
nections to algorithmic complexity [114] and continued fractions [10, 99, 138].
1 For more information about Dedekind, see
http://www-groups.dcs.st-and.ac.uk/âˆ¼history/Biographies/Dedekind.html.

Exercises
151
3. The reciprocity laws (Theorems 8.4 and 8.8) for the Fourierâ€“Dedekind
sums were proved in [25]. Theorem 8.4 is equivalent to the reciprocity law for
Don Zagierâ€™s higher-dimensional Dedekind sums [190]. Corollary 8.7 (stated
in terms of the classical Dedekind sum) is originally due to Hans Rademacher
[149]. Theorem 8.8 generalizes reciprocity laws by Rademacher [150] (essen-
tially Corollary 8.9) and Ira Gessel [87].
4. The Fourierâ€“Dedekind sums form only one set of generalizations of the
classical Dedekind sums. A long, but by no means complete, list of other
generalizations is [5, 6, 21, 34, 35, 36, 56, 77, 78, 87, 92, 93, 113, 129, 131,
130, 150, 179, 190].
5. The connection of Dedekind sums and lattice-point problems, namely The-
orem 8.11 for t = 1, was ï¬rst established by Louis Mordell in 1951 [136]. Some
42 years later, James Pommersheim established a proof of Theorem 8.11 as
part of a much more general machinery [146]. In fact, Pommersheimâ€™s work
implies that the classical Dedekind sum is the only nontrivial ingredient one
needs for Ehrhart polynomials in dimensions three and four.
6. We touched the question of eï¬ƒcient computability of Ehrhart (quasi-)po-
lynomials in this chapter. Unfortunately, our current state of knowledge on
generalized Dedekind sums does not suï¬ƒce to make any general statement.
However, Alexander Barvinok proved in 1994 [15] that in ï¬xed dimension,
the rational generating function of the Ehrhart quasipolynomial of a ratio-
nal polytope can be eï¬ƒciently computed. Barvinokâ€™s proof did not employ
Dedekind sums but rather used a decomposition theorem of Brion, which is
the subject of Chapter 9.
Exercises
8.1. Show that s(a, b) = 0 if and only if a2 â‰¡âˆ’1 mod b.
8.2. Prove that 6b s(a, b) âˆˆZ. (Hint: Start with rewriting the deï¬nition of the
Dedekind sum as 6b s(a, b) = 6a
b
Pbâˆ’1
k=1 k2 âˆ’6 Pbâˆ’1
k=1 k
 ka
b

âˆ’3 Pbâˆ’1
k=1 k.)
8.3. Let a and b be any two relatively prime positive integers. Show that the
reciprocity law for the Dedekind sums implies that for b â‰¡r mod a,
12ab s(a, b) = âˆ’12ab s(r, a) + a2 + b2 âˆ’3ab + 1 .
Deduce the following identities:
(a) For b â‰¡1 mod a,
12ab s(a, b) = âˆ’a2b + b2 + a2 âˆ’2b + 1 .

152
8 Dedekind Sums, the Building Blocks of Lattice-point Enumeration
(b) For b â‰¡2 mod a,
12ab s(a, b) = âˆ’1
2a2b + a2 + b2 âˆ’5
2b + 1 .
(c) For b â‰¡âˆ’1 mod a,
12ab s(a, b) = a2b + a2 + b2 âˆ’6ab + 2b + 1 .
8.4. Denote by fn the sequence of Fibonacci numbers, deï¬ned by
f1 = f2 = 1
and
fn+2 = fn+1 + fn for n â‰¥1 .
Prove that
s (f2k, f2k+1) = 0
and
12f2kâˆ’1f2k s (f2kâˆ’1, f2k) = f 2
2kâˆ’1 + f 2
2k âˆ’3f2kâˆ’1f2k + 1 .
8.5. â™£Prove (8.2):
s0(a1, a2; b) = âˆ’s
 a1aâˆ’1
2 , b

+ b âˆ’1
4b
,
where aâˆ’1
2 a2 â‰¡1 mod b.
8.6. Prove that B1, B2, . . . , Bd in the partial fraction expansion (8.3),
f(z) =
1
(1 âˆ’za1) Â· Â· Â· (1 âˆ’zad) zn
= A1
z + A2
z2 + Â· Â· Â· + An
zn +
B1
z âˆ’1 +
B2
(z âˆ’1)2 + Â· Â· Â· +
Bd
(z âˆ’1)d
+
a1âˆ’1
X
k=1
C1k
z âˆ’Î¾ka1
+
a2âˆ’1
X
k=1
C2k
z âˆ’Î¾ka2
+ Â· Â· Â· +
adâˆ’1
X
k=1
Cdk
z âˆ’Î¾kad
,
are polynomials in n (of degree less than d) and rational functions in a1, . . . , ad.
8.7. â™£Verify the ï¬rst few expressions for poly{a1,...,ad}(n) in (8.4).
8.8. Show that the Dedekindâ€“Rademacher sum satisï¬es râˆ’n(a, b) = rn(a, b).
8.9. â™£Show that
bâˆ’1
X
m=0
n âˆ’m
b

+ 1
2 Ï‡b(n âˆ’m) âˆ’1
2b
 aâˆ’1m
b

+ 1
2 Ï‡b (m) âˆ’1
2b

=
bâˆ’1
X
m=0
am âˆ’n
b
 m
b

+ 1
2
aâˆ’1n
b

+ 1
2
âˆ’n
b

âˆ’1
4b
+ 1
4 Ï‡b(n) .

Open Problems
153
8.10. Rephrase the Ehrhart quasipolynomials for rational triangles given in
Theorem 2.10 and Exercise 2.34 in terms of Dedekindâ€“Rademacher sums.
8.11. â™£Prove Theorem 8.11 by verifying (8.8) and computing the coeï¬ƒcients
for z = 1 in the partial fraction expansion of (8.7).
8.12. Generalize the Ehrhart polynomial of the Mordellâ€“Pommersheim tetra-
hedron to the case that a, b, and c are not necessarily pairwise relatively
prime.
8.13. Compute the Ehrhart polynomial of the 4-simplex
n
(x1, x2, x3, x4) âˆˆR4
â‰¥0 : x1
a + x2
b + x3
c + x4
d â‰¤1
o
,
where a, b, c, d are pairwise relatively prime positive integers. (Hint: You may
use Corollary 5.5 to compute the linear term.)
Open Problems
8.14. Find new relations between various Dedekind sums.
8.15. It is known [21] that the Fourierâ€“Dedekind sums are eï¬ƒciently com-
putable. Find a fast algorithm that can be implemented in practice.
8.16. For any ï¬xed integers b and k, ï¬nd a nice characterization for the set
of all a âˆˆZ such that s(a, b) = k.


9
The Decomposition of a Polytope
into Its Cones
Mathematics compares the most diverse phenomena and discovers the secret analo-
gies that unite them.
Jean Baptiste Joseph Fourier (1768â€“1830)
In this chapter, we return to integer-point transforms of rational cones and
polytopes and connect them in a magical way that was ï¬rst discovered by
Michel Brion. The power of Brionâ€™s theorem has been applied to various do-
mains, such as Barvinokâ€™s algorithm in integer linear programming, and to
higher-dimensional Eulerâ€“Maclaurin summation formulas, which we study in
Chapter 10. In a sense, Brionâ€™s theorem is the natural extension of the familiar
ï¬nite geometric series identity Pb
m=a zm = zb+1âˆ’za
zâˆ’1
to higher dimensions.
9.1 The Identity â€œP
mâˆˆZ zm = 0â€. . .
. . . or â€œMuch Ado About Nothingâ€
We start gently by illustrating Brionâ€™s theorem in dimension one. To this end,
letâ€™s consider the line segment I := [20, 34]. We recall that its integer-point
transform lists the lattice points in I in the form of monomials:
ÏƒI(z) =
X
mâˆˆIâˆ©Z
zm = z20 + z21 + Â· Â· Â· + z34.
Already in this simple example, we are too lazy to list all integers in I and
use Â· Â· Â· to write the polynomial ÏƒI. Is there a more compact way to write
ÏƒI? The reader might have guessed it even before we asked the question: this
integer-point transform equals the rational function
ÏƒI(z) = z20 âˆ’z35
1 âˆ’z
.

156
9 The Decomposition of a Polytope into Its Cones
This last sentence is not quite correct: the deï¬nition of ÏƒI(z) yielded a poly-
nomial in z, whereas the rational function above is not deï¬ned at z = 1.
We can overcome this deï¬ciency by noticing that the limit of this rational
function as z â†’1 equals the evaluation of the polynomials ÏƒI(1) = 15, by
Lâ€™HË†opitalâ€™s rule. Notice that the rational-function representation of ÏƒI has
the unquestionable advantage of being much more compact than the original
polynomial representation. The reader who is not convinced of this advantage
should replace the right vertex 34 of I by 3400.
Now letâ€™s rewrite the rational form of the integer-point transform of I
slightly:
ÏƒI(z) = z20 âˆ’z35
1 âˆ’z
=
z20
1 âˆ’z +
z34
1 âˆ’1
z
.
(9.1)
There is a natural geometric interpretation of the two summands on the right-
hand side. The ï¬rst term represents the integer-point transform of the interval
[20, âˆ):
Ïƒ[20,âˆ)(z) =
X
mâ‰¥20
zm =
z20
1 âˆ’z .
The second term in (9.1) corresponds to the integer-point transform of the
interval (âˆ’âˆ, 34]:
Ïƒ(âˆ’âˆ,34](z) =
X
mâ‰¤34
zm =
z34
1 âˆ’1
z
.
So (9.1) says that on a rational-function level,
Ïƒ[20,âˆ)(z) + Ïƒ(âˆ’âˆ,34](z) = Ïƒ[20,34](z) .
(9.2)
This identity, which we illustrate graphically in Figure 9.1, should come
20
34
20
34
20
34
Fig. 9.1. Decomposing a line segment into two inï¬nite rays.
as a mild surprise. Two rational functions that represent inï¬nite sequences
somehow collapse, when being summed up, to a polynomial with a ï¬nite
number of terms. We emphasize that (9.2) does not make sense on the level of
inï¬nite series; in fact, the two inï¬nite series involved here have disjoint regions
of convergence.

9.1 The Identity â€œP
mâˆˆZ zm = 0â€. . . or â€œMuch Ado About Nothingâ€
157
Even more magical is the geometry behind this identity: on the right-hand
side we have a polynomial that lists the integer points in a ï¬nite interval P,
while on the left-hand side each of the rational generating functions represents
the integer points in an inï¬nite ray that begins at a vertex of P. The two
half-lines will be called vertex cones below, and indeed the remainder of this
chapter is devoted to proving that an identity similar to (9.2) holds in general
dimension.
We now extend the deï¬nition of integer-point transforms ÏƒA(z) from the
case of cones A to the case of aï¬ƒne spaces A. Any such aï¬ƒne space A âŠ†Rd
equals w + V for some w âˆˆRd and some n-dimensional vector subspace
V âŠ†Rd, and if A contains integer points (which is the only interesting case
for our purposes), we may choose w âˆˆZd. The integer points V âˆ©Zd in V
form a vector space, and hence there exists a basis v1, v2, . . . , vn for V âˆ©Zd.
This implies that any integer point m âˆˆA âˆ©Zd can be uniquely written as
m = w + k1v1 + k2v2 + Â· Â· Â· + knvn
for some
k1, k2, . . . , kn âˆˆZ .
Using this ï¬xed lattice basis for V, we deï¬ne the skewed orthants of A as the
sets of the form {w + Î»1v1 + Î»2v2 + Â· Â· Â· + Î»nvn}, where for each 1 â‰¤j â‰¤n,
we require either Î»j â‰¥0 or Î»j < 0. So there are 2n such skewed orthants,
and their disjoint union equals A. We denote them by O1, O2, . . . , O2n. All of
them are (half-open) pointed cones, and so their integer-point transforms are
rational.
Lemma 9.1. Suppose A is an n-dimensional aï¬ƒne space with skewed or-
thants O1, O2, . . . , O2n. Then as rational functions,
ÏƒO1(z) + ÏƒO2(z) + Â· Â· Â· + ÏƒO2n(z) = 0 .
Proof. Suppose
A = {w + Î»1v1 + Î»2v2 + Â· Â· Â· + Î»nvn : Î»1, Î»2, . . . , Î»n âˆˆR} .
Then a typical skewed orthant O looks like
O = {w + Î»1v1 + Î»2v2 + Â· Â· Â· + Î»nvn : Î»1, . . . , Î»k â‰¥0, Î»k+1, . . . , Î»n < 0} ,
and its integer-point transform is
ÏƒO(z)
= zw
ï£«
ï£­X
j1â‰¥0
zj1v1
ï£¶
ï£¸Â· Â· Â·
ï£«
ï£­X
jkâ‰¥0
zjkvk
ï£¶
ï£¸
ï£«
ï£­X
jk+1<0
zjk+1vk+1
ï£¶
ï£¸Â· Â· Â·
ï£«
ï£­X
jn<0
zjnvn
ï£¶
ï£¸
= zw
1
1 âˆ’zv1 Â· Â· Â·
1
1 âˆ’zvk
1
zvk+1 âˆ’1 Â· Â· Â·
1
zvn âˆ’1 .
Now consider the skewed orthant Oâ€² with the same conditions on the Î»â€™s as in
O except that we switch Î»1 â‰¥0 to Î»1 < 0. Then the integer-point transform
of Oâ€² is

158
9 The Decomposition of a Polytope into Its Cones
ÏƒOâ€²(z) = zw
1
zv1 âˆ’1
1
1 âˆ’zv2 Â· Â· Â·
1
1 âˆ’zvk
1
zvk+1 âˆ’1 Â· Â· Â·
1
zvn âˆ’1 ,
so that ÏƒO(z) + ÏƒOâ€²(z) = 0. Since we can pair up all skewed orthants in this
fashion, the sum of all their rational generating functions is zero.
âŠ“âŠ”
Since O1 âˆªO2 âˆªÂ· Â· Â· âˆªO2n is equal to A as a disjoint union, it now makes
sense to set
ÏƒA(z) := 0
(9.3)
for any n-dimensional aï¬ƒne space with n > 0. Lemma 9.1 says that this deï¬n-
ition is not as arbitrary as it might seem, and the following result strengthens
our motivation for the deï¬nition (9.3).
Theorem 9.2. Given half-open pointed cones K1, K2, . . . , Km âŠ†Rd with a
common apex in Zd such that the disjoint union of K1, K2, . . . , Km is an aï¬ƒne
space, then as rational functions,
ÏƒK1(z) + ÏƒK2(z) + Â· Â· Â· + ÏƒKm(z) = 0 .
Proof. Suppose the disjoint union of K1, K2, . . . , Km is the n-dimensional
aï¬ƒne space A, and w âˆˆZd is the common apex of K1, K2, . . . , Km. Now
we decompose A into the skewed orthants O1, O2, . . . , O2n, which are also
pointed cones with common apex w. The intersection of one of the Kjâ€™s with
one of the Okâ€™s is again a half-open pointed cone, and all these cones form yet
another disjoint union of A, which is a common reï¬nement of the dissection
of A in terms of the Kjâ€™s and in terms of the Okâ€™s:
A =
[
1â‰¤jâ‰¤m
1â‰¤kâ‰¤2n
(Kj âˆ©Ok) .
For each 1 â‰¤j â‰¤m, Kj = S2n
k=1 (Kj âˆ©Ok) as a disjoint union, and so we can
write the integer-point transform of Kj as
ÏƒKj(z) =
2n
X
k=1
ÏƒKjâˆ©Ok(z) ,
as a rational-function identity. Similarly, we obtain for each 1 â‰¤k â‰¤2n,
ÏƒOk(z) =
m
X
j=1
ÏƒKjâˆ©Ok(z) .
Thus
m
X
j=1
ÏƒKj(z) =
m
X
j=1
2n
X
k=1
ÏƒKjâˆ©Ok(z) =
2n
X
k=1
m
X
j=1
ÏƒKjâˆ©Ok(z) =
2n
X
k=1
ÏƒOk(z) = 0 ,
by Lemma 9.1.
âŠ“âŠ”

9.2 Tangent Cones and Their Rational Generating Functions
159
9.2 Tangent Cones and Their Rational Generating
Functions
The goal of this section, apart from setting the language that allows us to prove
Brionâ€™s theorem, is to prove a sort of analogue of (9.2) in general dimension.
We recall a deï¬nition that was touched on only brieï¬‚y, in Exercise 3.14:
A hyperplane arrangement H is a ï¬nite collection of hyperplanes. An
arrangement H is rational if all its hyperplanes are, that is, if each hy-
perplane in H is of the form

x âˆˆRd : a1x1 + a2x2 + Â· Â· Â· + adxd = b
	
for
some a1, a2, . . . , ad, b âˆˆZ. An arrangement H is called a central hyperplane
arrangement if its hyperplanes meet in (at least) one point.
Our next deï¬nition generalizes (ï¬nally) the notion of a pointed cone,
deï¬ned in Chapter 3. A convex cone is the intersection of ï¬nitely many
half-spaces of the form

x âˆˆRd : a1x1 + a2x2 + Â· Â· Â· + adxd â‰¤b
	
for which the
corresponding hyperplanes

x âˆˆRd : a1x1 + a2x2 + Â· Â· Â· + adxd = b
	
form a
central arrangement. This deï¬nition extends that of a pointed cone: a cone
is pointed if the deï¬ning hyperplanes meet in exactly one point. A cone is
rational if all of its deï¬ning hyperplanes are rational. Cones and polytopes
are special cases of polyhedra, which are convex bodies deï¬ned as the inter-
section of ï¬nitely many half-spaces.
We now attach a cone to each face F of P, namely its tangent cone,
deï¬ned by
KF := {x + Î» (y âˆ’x) : x âˆˆF, y âˆˆP, Î» âˆˆRâ‰¥0} .
It turns out that KF is the smallest convex cone containing both span F and
P. We note that KP = span P. For a vertex v of P, the tangent cone Kv is
often called a vertex cone; it is pointed. For a k-face F of P with k > 0, the
tangent cone KF is not pointed. For example, the tangent cone of an edge of
a 3-polytope is a wedge.
Lemma 9.3. For any face F of P, span F âŠ†KF.
Proof. As x and y vary over all points of F, x + Î» (y âˆ’x) varies over span F.
âŠ“âŠ”
We note that this lemma implies that KF contains a line, unless F is a
vertex. More precisely, if KF is not pointed, it contains the aï¬ƒne space span F,
which is called the apex of the tangent cone. (A pointed cone has a point as
apex.)
An aï¬ƒne space A âŠ†Rd equals w + V for some w âˆˆRd and some vector
subspace V âŠ†Rd. The orthogonal complement AâŠ¥of this aï¬ƒne space A
is deï¬ned by
AâŠ¥:=

x âˆˆRd : x Â· v = 0 for all v âˆˆV
	
.
We note that A âŠ•AâŠ¥= Rd, which gives us the following result.

160
9 The Decomposition of a Polytope into Its Cones
Lemma 9.4. For any face F of P, the tangent cone KF has the decomposition
KF = span F âŠ•

(span F)âŠ¥âˆ©KF

.
Consequently, unless F is a vertex,
ÏƒKF (z) = 0 .
Proof. Since span F âŠ•(span F)âŠ¥= Rd,
KF =

span F âŠ•(span F)âŠ¥
âˆ©KF
= (span F âˆ©KF) âŠ•

(span F)âŠ¥âˆ©KF

= span F âŠ•

(span F)âŠ¥âˆ©KF

,
where the last step follows from Lemma 9.3. The second part of the lemma is
immediate since Ïƒspan FâŠ•((span F)âŠ¥âˆ©KF)(z) = Ïƒspan F(z) Ïƒ(span F)âŠ¥âˆ©KF (z) and
Ïƒspan F(z) = 0.
âŠ“âŠ”
Although we do not need this fact in the sequel, itâ€™s nice to know that
(span F)âŠ¥âˆ©KF is a pointed cone (see Exercise 9.1).
9.3 Brionâ€™s Theorem
The following theorem is a classical identity of convex geometry named after
Charles Julien Brianchon (1783â€“1864)1 and JÃ¸rgen Pedersen Gram (1850â€“
1916).2 It holds for any convex polytope. However, its proof for simplices
is considerably simpler than that for the general case. We need only the
Brianchonâ€“Gram identity for simplices, so we restrict ourselves to this special
case. (One could prove the general case along similar lines as below; however,
we would need some additional machinery not covered in this book.) The
indicator function 1S of a set S âŠ‚Rd is deï¬ned by
1S(x) :=
 1 if x âˆˆS,
0 if x Ì¸âˆˆS.
Theorem 9.5 (Brianchonâ€“Gram identity for simplices). Let âˆ†be a d-
simplex. Then
1âˆ†(x) =
X
FâŠ†âˆ†
(âˆ’1)dim F1KF (x) ,
where the sum is taken over all nonempty faces F of âˆ†.
1 For more information about Brainchon, see
http://www-groups.dcs.st-and.ac.uk/âˆ¼history/Biographies/Brainchon.html.
2 For more information about Gram, see
http://www-groups.dcs.st-and.ac.uk/âˆ¼history/Biographies/Gram.html.

9.3 Brionâ€™s Theorem
161
Proof. We distinguish between two disjoint cases: whether or not x is in the
simplex.
Case 1: x âˆˆâˆ†. Then x âˆˆKF for all F âŠ†âˆ†, and the identity becomes
1 =
X
FâŠ†âˆ†
(âˆ’1)dim F =
dim âˆ†
X
k=0
(âˆ’1)kfk .
This is the Euler relation for simplices, which we proved in Exercise 5.5.
Case 2: x /âˆˆâˆ†. Then there is a unique minimal face F âŠ†âˆ†(minimal with
respect to dimension) such that x âˆˆKF and x âˆˆKG for all faces G âŠ†âˆ†that
contain F (Exercise 9.2). The identity to be proved is now
0 =
X
GâŠ‡F
(âˆ’1)dim G.
(9.4)
The validity of this identity again follows from the logic of Exercise 5.5; the
proof of (9.4) is the subject of Exercise 9.4.
âŠ“âŠ”
Corollary 9.6 (Brionâ€™s theorem for simplices). Suppose âˆ†is a rational
simplex. Then we have the following identity of rational functions:
Ïƒâˆ†(z) =
X
v a vertex of âˆ†
ÏƒKv(z) .
Proof. We translate the Brianchonâ€“Gram theorem into the language of inte-
ger-point transforms: we sum both sides of the identity in Theorem 9.5 for all
m âˆˆZd,
X
mâˆˆZd
1âˆ†(m) zm =
X
mâˆˆZd
X
FâŠ†âˆ†
(âˆ’1)dim F1KF (m) zm,
which is equivalent to
Ïƒâˆ†(z) =
X
FâŠ†âˆ†
(âˆ’1)dim FÏƒKF (z) .
But Lemma 9.4 implies that ÏƒKF (z) = 0 except when F is a vertex. Hence
Ïƒâˆ†(z) =
X
v a vertex of âˆ†
ÏƒKv(z) .
âŠ“âŠ”
Now we extend Corollary 9.6 to any convex rational polytope:
Theorem 9.7 (Brionâ€™s theorem). Suppose P is a rational convex polytope.
Then we have the following identity of rational functions:
ÏƒP(z) =
X
v a vertex of P
ÏƒKv(z) .
(9.5)

162
9 The Decomposition of a Polytope into Its Cones
Proof. We use the same irrational trick as in the proofs of Theorems 3.12 and
4.3. Namely we start by triangulating P into the simplices âˆ†1, âˆ†2, . . . , âˆ†m
(using no new vertices). Consider the hyperplane arrangement
H := {span F : F is a facet of âˆ†1, âˆ†2, . . . , or âˆ†m} .
We will now shift the hyperplanes in H, obtaining a new hyperplane arrange-
ment Hshift. Those hyperplanes of H that deï¬ned P now deï¬ne, after shifting,
a new polytope that we will call Pshift. Exercise 9.6 ensures that we can shift
H in such a way that:
â€¢
no hyperplane in Hshift contains any lattice point;
â€¢
Hshift yields a triangulation of Pshift;
â€¢
the lattice points contained in a vertex cone of P are precisely the lattice
points contained in the corresponding vertex cone of Pshift.
This setup implies that
â€¢
the lattice points in P are precisely the lattice points in Pshift;
â€¢
the lattice points in a vertex cone of Pshift can be written as a disjoint
union of lattice points in vertex cones of simplices of the triangulation that
Hshift induces on Pshift.
The latter two conditions, in turn, mean that Brionâ€™s identity (9.5) follows
from Brionâ€™s theorem for simplices: the integer-point transforms on both sides
of the identity can be written as a sum of integer-point transforms of simplices
and their vertex cones.
âŠ“âŠ”
9.4 Brion Implies Ehrhart
We conclude this chapter by showing that Ehrhartâ€™s theorem (Theorem 3.23)
for rational polytopes (which includes the integral case, Theorem 3.8) follows
from Brionâ€™s theorem (Theorem 9.7) in a relatively straightforward manner.
Second proof of Theorem 3.23. As in our ï¬rst proof of Ehrhartâ€™s theorem, it
suï¬ƒces to prove Theorem 3.23 for simplices, because we can triangulate any
polytope (using only the vertices). So suppose âˆ†is a rational d-simplex whose
vertices have coordinates with denominator p. Our goal is to show that, for a
ï¬xed 0 â‰¤r < p, the function Lâˆ†(r + pt) is a polynomial in t; this means that
Lâˆ†is a quasipolynomial with period dividing p.
By Theorem 9.7,
Lâˆ†(r + pt) =
X
mâˆˆ(r+pt)âˆ†âˆ©Zd
1
= lim
zâ†’1 Ïƒ(r+pt)âˆ†(z)
(9.6)
= lim
zâ†’1
X
v vertex of âˆ†
Ïƒ(r+pt)Kv(z) .

Notes
163
We used the limit computation for the integer-point transform Ïƒ(r+pt)âˆ†rather
than the evaluation Ïƒ(r+pt)âˆ†(1), because this evaluation would have yielded
singularities in the rational generating functions of the vertex cones. Note that
the vertex cones Kv are all simplicial, because âˆ†is a simplex. So suppose
Kv = {v + Î»1w1 + Î»2w2 + Â· Â· Â· + Î»dwd : Î»1, Î»2, . . . , Î»d â‰¥0} ;
then
(r + pt)Kv = {(r + pt)v + Î»1w1 + Î»2w2 + Â· Â· Â· + Î»dwd : Î»1, Î»2, . . . , Î»d â‰¥0}
= tpv + {rv + Î»1w1 + Î»2w2 + Â· Â· Â· + Î»dwd : Î»1, Î»2, . . . , Î»d â‰¥0}
= tpv + rKv .
Whatâ€™s important to note here is that pv is an integer vector. In particular,
we can safely write
Ïƒ(r+pt)Kv(z) = ztpvÏƒrKv(z)
(we say â€œsafelyâ€ because tpv âˆˆZd, so ztpv is indeed a monomial). Now we
can rewrite (9.6) as
Lâˆ†(r + pt) = lim
zâ†’1
X
v vertex of âˆ†
ztpvÏƒrKv(z) .
(9.7)
The exact forms of the rational functions ÏƒrKv(z) is not important, except for
the fact that they do not depend on t. We know that the sum of the generating
functions of all vertex cones is a polynomial in z; that is, the singularities of
the rational functions cancel. To compute Lâˆ†(r + pt) from (9.7), we write
all the rational functions on the right-hand side over one denominator and
use Lâ€™HË†opitalâ€™s rule to compute the limit of this one huge rational function.
The variable t appears only in the simple monomials ztpv, so the eï¬€ect of
Lâ€™HË†opitalâ€™s rule is that we obtain linear factors of t every time we diï¬€erentiate
the numerator of this rational function. At the end we evaluate the remaining
rational function at z = 1. The result is a polynomial in t.
âŠ“âŠ”
Notes
1. Theorem 9.5 (in its general form for convex polytopes) has an interesting
history. In 1837 Charles Brianchon proved a version of this theorem involving
volumes of polytopes in R3 [44]. In 1874 JÃ¸rgen Gram gave a proof of the same
result [88]; apparently he was unaware of Brianchonâ€™s paper. In 1927 Duncan
Sommerville published a proof for general d [167], which was corrected in the
1960s by Victor Klee [111], Branko GrÂ¨unbaum [90, Section 14.1], and many
others.
2. Michel Brion discovered Theorem 9.7 in 1988 [45]. His proof involved the
Baumâ€“Fultonâ€“Quart Riemannâ€“Roch formula for equivariant K-theory of toric

164
9 The Decomposition of a Polytope into Its Cones
varieties. A more elementary proof of Theorem 9.7 was found by Masa-Nori
Ishida a few years later [103]. Our approach in this chapter follows [27].
3. As we have already remarked earlier, Brionâ€™s theorem led to an eï¬ƒcient
algorithm by Alexander Barvinok to compute Ehrhart quasipolynomials [15].
More precisely, Barvinok proved that in ï¬xed dimension, one can eï¬ƒciently3
compute the Ehrhart series P
tâ‰¥0 LP(t) zt as a short sum of rational func-
tions.4 Brionâ€™s theorem essentially reduces the problem to computing the
integer-point transforms of the rational tangent cones of the polytope. Barvi-
nokâ€™s ingenious idea was to use a signed decomposition of a rational cone to
compute its integer-point transform: the cone is written as a sum and diï¬€er-
ence of unimodular cones, which we will encounter in Section 10.4 and which
have a trivial integer-point transform. Finding a signed decomposition involves
triangulations, Minkowskiâ€™s theorem on lattice points in convex bodies (see,
for example, [57, 133, 140, 163]), and the LLL algorithm which ï¬nds a short
vector in a lattice [121]. At any rate, Barvinok proved that one can ï¬nd a
signed decomposition quickly, which is the main step towards computing the
Ehrhart series of the polytope. Barvinokâ€™s algorithm has been implemented
in the software packages barvinok [185] and LattE [66, 67, 115]. Barvinokâ€™s
algorithm is described in detail in [13].
Exercises
9.1. â™£Prove that for any face F of a polytope, (span F)âŠ¥âˆ©KF is a pointed
cone. (Hint: Show that if H is a deï¬ning hyperplane for F, then Hâˆ©(span F)âŠ¥
is a hyperplane in the vector space (span F)âŠ¥.)
9.2. â™£Suppose âˆ†is a simplex and x /âˆˆâˆ†. Prove that there is a unique
minimal face F âŠ†âˆ†(minimal with respect to dimension) such that the corre-
sponding tangent cone KF contains x. Show that x âˆˆKG for all faces G âŠ†âˆ†
that contain F, and x /âˆˆKG for all other faces G.
9.3. Show that Exercise 9.2 fails to be true if âˆ†is a quadrilateral (for exam-
ple). Show that the Brianchonâ€“Gram identity holds for your quadrilateral.
9.4. â™£Prove (9.4): for a face F of a simplex âˆ†,
X
GâŠ‡F
(âˆ’1)dim G = 0 ,
where the sum is taken over all faces of âˆ†that contain F.
3 â€œEï¬ƒcientlyâ€ here means that for every dimension, there exists a polynomial that
gives an upper bound on the running time of the algorithm, when evaluated at
the logarithm of the input data of the polytope (e.g., its vertices).
4 â€œShortâ€ means that the set of data needed to output this sum of rational functions
is also of polynomial size in the logarithm of the input data of the polytope.

Exercises
165
9.5. Give a direct proof of Brionâ€™s theorem for the 1-dimensional case.
9.6. â™£Provide the details of the irrational-shift argument in the proof of
Theorem 9.7: Given a rational polytope P, triangulate it into the simplices
âˆ†1, âˆ†2, . . . , âˆ†m (using no new vertices). Consider the hyperplane arrangement
H := {span F : F is a facet of âˆ†1, âˆ†2, . . . , âˆ†m} .
We will now shift the hyperplanes in H, obtaining a new hyperplane arrange-
ment Hshift. Those hyperplanes of H that deï¬ned P now deï¬ne, after shifting,
a new polytope that we will call Pshift. Prove that we can shift H in such a
way that:
â€¢
no hyperplane in Hshift contains any lattice point;
â€¢
Hshift yields a triangulation of Pshift;
â€¢
the lattice points contained in a vertex cone of P are precisely the lattice
points contained in the corresponding vertex cone of Pshift.
9.7. â™£Prove the following â€œopen polytopeâ€ analogue for Brionâ€™s theorem: If
P is a rational convex polytope, then we have the identity of rational functions
ÏƒPâ—¦(z) =
X
v a vertex of P
ÏƒKâ—¦v(z) .


10
Eulerâ€“Maclaurin Summation in Rd
All means (even continuous) sanctify the discrete end.
Doron Zeilberger
Thus far we have often been concerned with the diï¬€erence between the dis-
crete volume of a polytope P and its continuous volume. In other words, the
quantity
X
mâˆˆPâˆ©Zd
1 âˆ’
Z
P
dy ,
(10.1)
which is by deï¬nition LP(1) âˆ’vol(P), has been on our minds for a long time
and has arisen naturally in many diï¬€erent contexts. An important extension is
the diï¬€erence between the discrete integer-point transform and its continuous
sibling:
X
mâˆˆPâˆ©Zd
emÂ·x âˆ’
Z
P
eyÂ·xdy ,
(10.2)
where we have replaced the variable z that we have commonly used in generat-
ing functions by the exponential variable (z1, z2, . . . , zd) = (ex1, ex2, . . . , exd).
Note that upon setting x = 0 in (10.2) we get the former quantity (10.1). Re-
lations between the two quantities P
mâˆˆPâˆ©Zd emÂ·x and
R
P eyÂ·xdy are known as
Eulerâ€“Maclaurin summation formulas for polytopes. The â€œbehind-the-scenesâ€
operators that are responsible for aï¬€ording us with such connections are the
diï¬€erential operators known as Todd operators, whose deï¬nition utilizes the
Bernoulli numbers in a surprising way.
10.1 Todd Operators and Bernoulli Numbers
Recall the Bernoulli numbers Bk from Section 2.4, deï¬ned by the generating
function

168
10 Eulerâ€“Maclaurin Summation in Rd
z
ez âˆ’1 =
X
kâ‰¥0
Bk
k! zk.
We now introduce a diï¬€erential operator via essentially the same generating
function, namely
Toddh := 1 +
X
kâ‰¥1
(âˆ’1)k Bk
k!
 d
dh
k
.
(10.3)
This Todd operator is often abbreviated as
Toddh =
d
dh
1 âˆ’eâˆ’d
dh ,
but we should keep in mind that this is only a shorthand notation for the
inï¬nite series (10.3). We ï¬rst show that the exponential function is an eigen-
function of the Todd operator.
Lemma 10.1. For z âˆˆC \ {0} with |z| < 2Ï€,
Toddh ezh =
z ezh
1 âˆ’eâˆ’z .
Proof.
Toddh ezh =
X
kâ‰¥0
(âˆ’1)k Bk
k!
 d
dh
k
ezh
=
X
kâ‰¥0
(âˆ’1)k Bk
k! zkezh
= ezh X
kâ‰¥0
(âˆ’z)k Bk
k!
= ezh
âˆ’z
eâˆ’z âˆ’1 .
The condition |z| < 2Ï€ is needed in the last step, by Exercise 2.14.
âŠ“âŠ”
The Todd operator is a discretizing operator, in the sense that it transforms
a continuous integral into a discrete sum, as the following theorem shows.
Theorem 10.2 (Eulerâ€“Maclaurin in dimension 1). For all a < b âˆˆZ
and z âˆˆC with |z| < 2Ï€,
Toddh1 Toddh2
Z b+h1
aâˆ’h2
ezxdx

h1=h2=0
=
b
X
k=a
ekz.

10.1 Todd Operators and Bernoulli Numbers
169
Proof. Case 1: z = 0. Then ezx = 1, and so
Toddh1 Toddh2
Z b+h1
aâˆ’h2
ezxdx

h1=h2=0
= Toddh1 Toddh2
Z b+h1
aâˆ’h2
dx

h1=h2=0
= b âˆ’a + Toddh1 h1 + Toddh2 h2|h1=h2=0
= b âˆ’a + h1 + 1
2 + h2 + 1
2

h1=h2=0
= b âˆ’a + 1
by Exercise 10.1. Since Pb
k=a ekÂ·0 = b âˆ’a + 1, weâ€™ve veriï¬ed the theorem in
this case.
Case 2: z Ì¸= 0. Then
Toddh1 Toddh2
Z b+h1
aâˆ’h2
ezxdx = Toddh1 Toddh2
1
z

ez(b+h1) âˆ’ez(aâˆ’h2)
= 1
z
 Toddh1 ezb+zh1 âˆ’Toddh2 ezaâˆ’zh2
= ezb
z Toddh1 ezh1 âˆ’eza
z Toddh2 eâˆ’zh2
= ezb
z
z ezh1
1 âˆ’eâˆ’z âˆ’eza
z
âˆ’z eâˆ’zh2
1 âˆ’ez
,
where the last step follows from Lemma 10.1. Hence
Toddh1 Toddh2
Z b+h1
aâˆ’h2
ezxdx

h1=h2=0
= ezb
1
1 âˆ’eâˆ’z + eza
1
1 âˆ’ez
= ez(b+1) âˆ’eza
ez âˆ’1
=
b
X
k=a
ekz.
âŠ“âŠ”
We will need a similar multivariate version of the Todd operator later, so
that we deï¬ne for h = (h1, h2, . . . , hm),
Toddh :=
m
Y
j=1
ï£«
ï£­
âˆ‚
âˆ‚hj
1 âˆ’exp

âˆ’âˆ‚
âˆ‚hj

ï£¶
ï£¸,
keeping in mind that this is a product over inï¬nite series of the form (10.3).

170
10 Eulerâ€“Maclaurin Summation in Rd
10.2 A Continuous Version of Brionâ€™s Theorem
In the following two sections, we develop the tools that, once fused with the
Todd operator, will enable us to extend Eulerâ€“Maclaurin summation to higher
dimensions. A lemma, which is of independent interest, but will be used in
the proof of the continous version of Brionâ€™s theorem, now follows.
Lemma 10.3. Suppose w1, w2, . . . , wd âˆˆZd are linearly independent, and let
Î  = {Î»1w1 + Î»2w2 + Â· Â· Â· + Î»dwd : 0 â‰¤Î»1, Î»2, . . . , Î»d < 1} .
Then
#
 Î  âˆ©Zd
= vol Î  = |det (w1, . . . , wd)|
and for any positive integer t,
#
 tÎ  âˆ©Zd
= (vol Î ) td.
In other words, for the half-open parallelepiped Î , the discrete volume
#
 tÎ  âˆ©Zd
coincides with the continuous volume (vol Î ) td.
Proof. Because Î  is half open, we can tile the tth dilate tÎ  by td translates
of Î , and hence
LÎ (t) = #
 tÎ  âˆ©Zd
= #
 Î  âˆ©Zd
td.
On the other hand, by the results of Chapter 3, LÎ (t) is a polynomial with
leading coeï¬ƒcient vol Î  = |det (w1, . . . , wd)|. Since we have equality of these
polynomials for all positive integers t,
#
 Î  âˆ©Zd
= vol Î  .
âŠ“âŠ”
We now give an integral analogue of Theorem 9.7 for simple rational poly-
topes. We start by translating Brionâ€™s integer-point transforms
ÏƒP(z) =
X
v a vertex of P
ÏƒKv(z)
into an exponential form:
ÏƒP(exp z) =
X
v a vertex of P
ÏƒKv(exp z) .
For the continuous analogue of Brionâ€™s theorem, we replace the sum on the
left-hand side,
ÏƒP(exp z) =
X
mâˆˆPâˆ©Zd
(exp z)m =
X
mâˆˆPâˆ©Zd
exp(m Â· z) ,
by an integral.

10.2 A Continuous Version of Brionâ€™s Theorem
171
Theorem 10.4 (Brionâ€™s theorem: continuous form). Suppose P is a
simple rational convex d-polytope. For a vertex cone Kv of P, ï¬x a set of
generators w1(v), w2(v), . . . , wd(v) âˆˆZd. Then
Z
P
exp(x Â· z) dx = (âˆ’1)d
X
v a vertex of P
exp (v Â· z) |det (w1(v), . . . , wd(v))|
Qd
k=1 (wk(v) Â· z)
for all z such that the denominators on the right-hand side do not vanish.
Proof. We start with the assumption that P is an integral polytope; we will
see in the process of the proof that this assumption can be relaxed. Letâ€™s
write out the exponential form of Brionâ€™s theorem (Theorem 9.7), using the
assumption that the vertex cones are simplicial (because P is simple). By
Theorem 3.5,
X
mâˆˆPâˆ©Zd
exp(m Â· z) =
X
v a vertex of P
exp(v Â· z) ÏƒÎ v(exp z)
Qd
k=1 (1 âˆ’exp (wk(v) Â· z))
,
(10.4)
where
Î v = {Î»1w1(v) + Î»2w2(v) + Â· Â· Â· + Î»dwd(v) : 0 â‰¤Î»1, Î»2, . . . , Î»d < 1}
is the fundamental parallelepiped of the vertex cone Kv. We would like to
rewrite (10.4) with the lattice Zd replaced by the reï¬ned lattice
  1
nZ
d, be-
cause then the left-hand side of (10.4) will give rise to the sought-after integral
by letting n approach inï¬nity. The right-hand side of (10.4) changes accord-
ingly; now every integral point has to be scaled down by 1
n:
X
mâˆˆPâˆ©( 1
n Z)
d
exp(m Â· z) =
X
v a vertex of P
exp(v Â· z) P
mâˆˆÎ vâˆ©Zd exp
  m
n Â· z

Qd
k=1

1 âˆ’exp

wk(v)
n
Â· z

.
(10.5)
The proof of this identity is in essence the same as that of Theorem 3.5; we
leave it as Exercise 10.2. Now our sought-after integral is
Z
P
exp(x Â· z) dx = lim
nâ†’âˆ
1
nd
X
mâˆˆPâˆ©( 1
n Z)
d
exp(m Â· z)
= lim
nâ†’âˆ
1
nd
X
v a vertex of P
exp(v Â· z) P
mâˆˆÎ vâˆ©Zd exp
  m
n Â· z

Qd
k=1

1 âˆ’exp

wk(v)
n
Â· z

.
(10.6)
At this point we can see that our assumption that P has integral vertices can
be relaxed to the rational case, since we may compute the limit only for nâ€™s
that are multiples of the denominator of P. The numerators of the terms on
the right-hand side have a simple limit:

172
10 Eulerâ€“Maclaurin Summation in Rd
lim
nâ†’âˆexp(v Â· z)
X
mâˆˆÎ vâˆ©Zd
exp
m
n Â· z

= exp(v Â· z)
X
mâˆˆÎ vâˆ©Zd
1
= exp (v Â· z) |det (w1(v), . . . , wd(v))| ,
where the last identity follows from Lemma 10.3. Hence (10.6) simpliï¬es to
Z
P
exp(x Â· z) dx =
X
v a vertex of P
exp (v Â· z) |det (w1(v), . . . , wd(v))|
Qd
k=1 limnâ†’âˆn

1 âˆ’exp

wk(v)
n
Â· z
 .
Finally, using Lâ€™HË†opitalâ€™s rule, we have
lim
nâ†’âˆn

1 âˆ’exp
wk(v)
n
Â· z

= âˆ’wk(v) Â· z ,
and the theorem follows.
âŠ“âŠ”
It turns out (Exercise 10.4) that for each vertex cone Kv,
Z
Kv
exp(x Â· z) dx = (âˆ’1)d exp (v Â· z) |det (w1(v), . . . , wd(v))|
Qd
k=1 (wk(v) Â· z)
,
(10.7)
and Theorem 10.4 shows that the Fourierâ€“Laplace transform of P equals the
sum of the Fourierâ€“Laplace transforms of the vertex cones. In other words,
Z
P
exp(x Â· z) dx =
X
v a vertex of P
Z
Kv
exp(x Â· z) dx .
We also remark that |det (w1(v), . . . , wd(v))| has a geometric meaning: it
is the volume of the fundamental parallelepiped of the vertex cone Kv.
The curious reader might wonder what happens to the statement of The-
orem 10.4 if we scale each of the generators wk(v) by a diï¬€erent factor. It is
immediate (Exercise 10.5) that the right-hand side of Theorem 10.4 remains
invariant.
10.3 Polytopes Have Their Moments
The most common notion for moments of a set P âŠ‚Rd is
Âµa :=
Z
P
ya dy =
Z
P
ya1
1 ya2
2 Â· Â· Â· yad
d dy
for any ï¬xed vector a = (a1, a2, . . . , ad) âˆˆCd. For a = 0 = (0, 0, . . . , 0), we
get Âµ0 = vol P. As an application of moments, consider the problem of ï¬nding
the center of mass of P, which is deï¬ned by
1
vol P
Z
P
y1 dy ,
Z
P
y2 dy , . . . ,
Z
P
yd dy

.

10.3 Polytopes Have Their Moments
173
This integral is equal to
1
Âµ0
 Âµ(1,0,0,...,0), Âµ(0,1,0,...,0), . . . , Âµ(0,...,0,1)

.
Similarly, one can deï¬ne the variance of P and other statistical data attached
to P and use moments to compute them.
Our next task is to present the moments Âµa in terms of Theorem 10.4. We
make the change of variables yk = exk in the deï¬ning integral of Âµa:
Âµa =
Z
P
ya dy =
Z
P
ex1a1ex2a2 Â· Â· Â· exdad ex1ex2 Â· Â· Â· exd dx =
Z
P
exÂ·(a+1) dx .
Thus Theorem 10.4 gives us the following formulas for the moments of a simple
rational d-polytope P:
Âµa = (âˆ’1)d
X
v a vertex of P
exp (v Â· (a + 1)) |det (w1(v), . . . , wd(v))|
Qd
k=1 (wk(v) Â· (a + 1))
,
for all a such that the denominators on the right-hand side do not vanish.
Going a step further, we can use Theorem 10.4 to obtain information for a
diï¬€erent set of moments. Along the way, we stumble on an amazing formula
for the continuous volume of a polytope.
Theorem 10.5. Suppose P is a simple rational convex d-polytope. For a ver-
tex cone Kv of P, ï¬x a set of generators w1(v), w2(v), . . . , wd(v) âˆˆZd. Then
vol P = (âˆ’1)d
d!
X
v a vertex of P
(v Â· z)d |det (w1(v), . . . , wd(v))|
Qd
k=1 (wk(v) Â· z)
for all z such that the denominators on the right-hand side do not vanish.
More generally, for any integer j â‰¥0,
Z
P
(x Â· z)j dx = (âˆ’1)dj!
(j + d)!
X
v a vertex of P
(v Â· z)j+d |det (w1(v), . . . , wd(v))|
Qd
k=1 (wk(v) Â· z)
.
Proof. We replace the variable z in the identity of Theorem 10.4 by sz, where
s is a scalar:
Z
P
exp (x Â· (sz)) dx = (âˆ’1)d
X
v a vertex of P
exp (v Â· (sz)) |det (w1(v), . . . , wd(v))|
Qd
k=1 (wk(v) Â· (sz))
,
which can be rewritten as
Z
P
exp (s (x Â· z)) dx = (âˆ’1)d
X
v a vertex of P
exp (s (v Â· z)) |det (w1(v), . . . , wd(v))|
sd Qd
k=1 (wk(v) Â· (z))
.

174
10 Eulerâ€“Maclaurin Summation in Rd
The general statement of the corollary follows now by ï¬rst expanding the
exponential functions as Taylor series in s, and then comparing coeï¬ƒcients
on both sides:
X
jâ‰¥0
Z
P
(x Â· z)j dx sj
j!
= (âˆ’1)d
X
v a vertex of P
X
jâ‰¥0
(v Â· z)j sjâˆ’d
j!
|det (w1(v), . . . , wd(v))|
Qd
k=1 (wk(v) Â· (z))
=
X
jâ‰¥âˆ’d
(âˆ’1)d
X
v a vertex of P
(v Â· z)j+d |det (w1(v), . . . , wd(v))|
Qd
k=1 (wk(v) Â· (z))
sj
(j + d)! .
âŠ“âŠ”
The proof of this corollary reveals yet more identities between rational
functions. Namely, the coeï¬ƒcients of the negative powers of s in the last line
of the proof have to be zero. This immediately yields the following curious set
of d identities for simple d-polytopes:
Corollary 10.6. Suppose P is a simple rational convex d-polytope. For a ver-
tex cone Kv of P, ï¬x a set of generators w1(v), w2(v), . . . , wd(v) âˆˆZd. Then
for 0 â‰¤j â‰¤d âˆ’1,
X
v a vertex of P
(v Â· z)j |det (w1(v), . . . , wd(v))|
Qd
k=1 (wk(v) Â· (z))
= 0 .
âŠ“âŠ”
10.4 From the Continuous to the Discrete Volume
of a Polytope
In this section, we apply the Todd operator to a perturbation of the continuous
volume. Namely, consider a simple full-dimensional polytope P, which we may
write as
P =

x âˆˆRd : A x â‰¤b
	
.
Then we deï¬ne the perturbed polytope
P(h) :=

x âˆˆRd : A x â‰¤b + h
	
for a â€œsmallâ€ vector h âˆˆRm. A famous theorem due to Askold KhovanskiË˜Ä± and
Aleksandr Pukhlikov says that the integer-point count in P can be obtained
from applying the Todd operator to vol (P(h)). Here we prove the theorem
for a certain class of polytopes, which we need to deï¬ne ï¬rst.
We call a rational pointed d-cone unimodular if its generators are a basis
of Zd.
An integral polytope is unimodular if each of its vertex cones is
unimodular.1
1 Unimodular polytopes go by two additional names, namely smooth and
Delzant.

10.4 From the Continuous to the Discrete Volume of a Polytope
175
Theorem 10.7 (KhovanskiË˜Ä±â€“Pukhlikov theorem). For a unimodular d-
polytope P,
#
 P âˆ©Zd
= Toddh vol (P(h))|h=0 .
More generally,
ÏƒP(exp z) = Toddh
Z
P(h)
exp(x Â· z) dx

h=0
.
Proof. We use Theorem 10.4, the continuous version of Brionâ€™s theorem; note
that if P is unimodular, then P is automatically simple. For a vertex cone
Kv of P, denote its generators by w1(v), w2(v), . . . , wd(v) âˆˆZd. Then The-
orem 10.4 states that
Z
P
exp(x Â· z) dx = (âˆ’1)d
X
v a vertex of P
exp (v Â· z) |det (w1(v), . . . , wd(v))|
Qd
k=1 (wk(v) Â· z)
= (âˆ’1)d
X
v a vertex of P
exp (v Â· z)
Qd
k=1 (wk(v) Â· z)
,
(10.8)
where the last identity follows from Exercise 10.3. A similar formula holds
for P(h), except that we have to account for the shift of the vertices. The
vector h shifts the facet-deï¬ning hyperplanes. This shift of the facets induces
a shift of the vertices; letâ€™s say that the vertex v gets moved along each edge
direction wk (the vectors that generate the vertex cone Kv) by hk(v), so that
P(h) has now the vertex v âˆ’Pd
k=1 hk(v)wk(v). If h is small enough, P(h)
will still be simple,2 and we can apply Theorem 10.4 to P(h):
Z
P(h)
exp(x Â· z) dx = (âˆ’1)d
X
v a vertex of P
exp

v âˆ’Pd
k=1 hk(v)wk(v)

Â· z

Qd
k=1 (wk(v) Â· z)
= (âˆ’1)d
X
v a vertex of P
exp

v Â· z âˆ’Pd
k=1 hk(v)wk(v) Â· z

Qd
k=1 (wk(v) Â· z)
= (âˆ’1)d
X
v a vertex of P
exp(v Â· z) Qd
k=1 exp (âˆ’hk(v)wk(v) Â· z)
Qd
k=1 (wk(v) Â· z)
.
Strictly speaking, this formula holds only for h âˆˆQm, so that the vertices
of P(h) are rational. Since we will eventually set h = 0, this is a harmless
restriction. Now we apply the Todd operator:
2 The cautious reader may consult [193, p. 66] to conï¬rm this fact.

176
10 Eulerâ€“Maclaurin Summation in Rd
Toddh
Z
P(h)
exp(x Â· z) dx

h=0
= (âˆ’1)d
X
v vertex of P
Toddh
exp(v Â· z) Qd
k=1 exp (âˆ’hk(v)wk(v) Â· z)
Qd
k=1 (wk(v) Â· z)

h=0
= (âˆ’1)d
X
v vertex of P
exp(v Â· z)
Qd
k=1 (wk(v) Â· z)
Ã—
d
Y
k=1
Toddhk(v) exp (âˆ’hk(v)wk(v) Â· z)

hk(v)=0
.
By a multivariate version of Lemma 10.1,
Toddh
Z
P(h)
exp(x Â· z) dx

h=0
= (âˆ’1)d
X
v vertex of P
exp (v Â· z)
Qd
k=1 (wk(v) Â· z)
d
Y
k=1
âˆ’wk(v) Â· z
1 âˆ’exp(wk(v) Â· z)
=
X
v vertex of P
exp (v Â· z)
d
Y
k=1
1
1 âˆ’exp(wk(v) Â· z) .
However, Brionâ€™s theorem (Theorem 9.7), together with the fact that P is
unimodular, says that the right-hand side of this last formula is precisely the
integer-point transform of P (see also (10.8)):
Toddh
Z
P(h)
exp(x Â· z) dx

h=0
= ÏƒP(exp z) .
Finally, setting z = 0 gives
Toddh
Z
P(h)
dx

h=0
=
X
mâˆˆPâˆ©Zd
1 ,
as claimed.
âŠ“âŠ”
We note that
R
P(h) exp(x Â· z) dx is, by deï¬nition, the continuous Fourierâ€“
Laplace transform of P(h). Upon being acted on by the discretizing operator
Toddh,
R
P(h) exp(xÂ·z) dx gives us the discrete integer-point transform ÏƒP(z).
Notes
1. The classical Eulerâ€“Maclaurin formula states that

Exercises
177
n
X
k=1
f(k) =
Z n
0
f(x) dx + f(0) + f(n)
2
+
p
X
m=1
B2m
(2m)!
h
f (2mâˆ’1)(x)
in
0
+
1
(2p + 1)!
Z n
0
B2p+1 ({x}) f (2p+1)(x) dx ,
where Bk(x) denotes the kth Bernoulli polynomial. It was discovered indepen-
dently by Leonhard Euler and Colin Maclaurin (1698â€“1746).3 This formula
provides an explicit error term, whereas Theorem 10.2 provides a summation
formula with no error term.
2. The Todd operator was introduced by Friedrich Hirzebruch in the 1950s
[100], following a more complicated deï¬nition by J. A. Todd [181, 182] some
twenty years earlier. The KhovanskiË˜Ä±â€“Pukhlikov theorem (Theorem 10.7)
can be interpreted as a combinatorial analogue of the algebro-geometric
Hirzebruchâ€“Riemannâ€“Roch theorem, in which the Todd operator plays a
prominent role.
3. Theorem 10.4, the continuous form of Brionâ€™s theorem, was generalized by
Alexander Barvinok to any polytope [11]. In fact, [11] contains a certain ex-
tension of Brionâ€™s theorem to irrational polytopes as well. The decomposition
formula for moments of a polytope in Theorem 10.5 is due to Michel Brion
and Mich`ele Vergne [46].
4. Theorem 10.7 was ï¬rst proved in 1992 by Askold KhovanskiË˜Ä± and Alek-
sandr Pukhlikov [108]. The proof we give here is essentially theirs. Their paper
[108] also draws parallels between toric varieties and lattice polytopes. Subse-
quently, many attempts to provide formulas for Ehrhart quasipolynomialsâ€”
some based on Theorem 10.7â€”have provided fertile ground for deeper con-
nections and future work; a long but by no means complete list of references
is [9, 33, 46, 55, 60, 61, 76, 91, 106, 107, 119, 125, 137, 146, 178].
Exercises
10.1. â™£Show that Toddh h = h + 1
2. More generally, prove that Toddh hk =
Bk(h + 1) for k â‰¥1, where Bk(x) denotes the kth Bernoulli polynomial.
10.2. â™£Prove (10.5): Suppose P is a simple integral d-polytope. For a vertex
cone Kv of P, denote its generators by w1(v), w2(v), . . . , wd(v) âˆˆZd and its
fundamental parallelepiped by Î v. Then
X
mâˆˆPâˆ©( 1
n Z)
d
exp(m Â· z) =
X
v a vertex of P
exp(v Â· z) P
mâˆˆÎ vâˆ©Zd exp
  m
n Â· z

Qd
k=1

1 âˆ’exp

wk(v)
n
Â· z

.
3 For more information about Maclaurin, see
http://www-groups.dcs.st-and.ac.uk/âˆ¼history/Biographies/Maclaurin.html.

178
10 Eulerâ€“Maclaurin Summation in Rd
10.3. â™£Given a unimodular cone
K = {v + Î»1w1 + Î»2w2 + Â· Â· Â· + Î»dwd : Î»1, Î»2, . . . , Î»d â‰¥0} ,
where v, w1, w2, . . . , wd âˆˆZd such that w1, w2, . . . , wd are a basis for Zd,
show that
ÏƒK(z) =
zv
Qd
k=1 (1 âˆ’zwk)
and |det (w1, . . . , wd)| = 1.
10.4. â™£Prove (10.7). That is, for the simple cone
K =
(
v +
d
X
k=1
Î»kwk : Î»k â‰¥0
)
with v, w1, w2, . . . , wd âˆˆQd, show that
Z
K
exp(x Â· z) dx = (âˆ’1)d exp (v Â· z) |det (w1(v), . . . , wd(v))|
Qd
k=1 (wk(v) Â· z)
.
10.5. Show that in the statement of Theorem 10.4, the expression
|det (w1(v), . . . , wd(v))|
Qd
k=1 (wk(v) Â· z)
remains invariant upon scaling each wk(v) by an independent positive integer.
Open Problems
10.6. Find all diï¬€erentiable eigenfunctions of the Todd operator.
10.7. Classify all polytopes whose discrete and continuous volumes coincide,
that is, LP(1) = vol P.
10.8. Which integer polytopes have a triangulation into d-simplices such that
each of the simplices is unimodular?

11
Solid Angles
Everything youâ€™ve learned in school as â€œobviousâ€ becomes less and less obvious as
you begin to study the universe. For example, there are no solids in the universe.
Thereâ€™s not even a suggestion of a solid. There are no absolute continuums. There
are no surfaces. There are no straight lines.
Buckminster Fuller (1895â€“1983)
The natural generalization of a two-dimensional angle to higher dimensions is
called a solid angle. Given a pointed cone K âŠ‚Rd, the solid angle at its apex
is the proportion of space that the cone K occupies. In slightly diï¬€erent words,
if we pick a point x âˆˆRd â€œat random,â€ then the probability that x âˆˆK is
precisely the solid angle at the apex of K. Yet another view of solid angles is
that they are in fact volumes of spherical polytopes: the region of intersection
of a cone with a sphere. There is a theory here that parallels the Ehrhart
theory of Chapters 3 and 4, but which has some genuinely new ideas.
11.1 A New Discrete Volume Using Solid Angles
Suppose P âŠ‚Rd is a convex rational d-polyhedron. The solid angle Ï‰P(x)
of a point x (with respect to P) is a real number equal to the proportion of a
small ball centered at x that is contained in P. That is, we let BÇ«(x) denote
the ball of radius Ç« centered at x and deï¬ne
Ï‰P(x) := vol (BÇ«(x) âˆ©P)
vol BÇ«(x)
for all positive Ç« suï¬ƒciently small. We note that when x /âˆˆP, Ï‰P(x) = 0;
when x âˆˆPâ—¦, Ï‰P(x) = 1; when x âˆˆâˆ‚P, 0 < Ï‰P(x) < 1. The solid angle
of a face F of P is deï¬ned by picking any point x in the relative interior Fâ—¦
and setting Ï‰P(F) = Ï‰P(x).

180
11 Solid Angles
Example 11.1. We compute the solid angles of the faces belonging to the
standard 3-simplex âˆ†= conv {(0, 0, 0), (1, 0, 0), (0, 1, 0), (0, 0, 1)}. As we just
mentioned, a point interior to âˆ†has solid angle 1. Every facet has solid angle
1
2 (and this remains true for any polytope).
The story gets interesting with the edges: here we are computing dihedral
angles. The dihedral angle of any one-dimensional edge is deï¬ned by the
angle between the outward-pointing normal to one of its deï¬ning facets and
the inward-pointing normal to its other deï¬ning facet.
B
C
A
O
Each of the edges OA, OB, and OC in the above ï¬gure have the same
solid angle
1
4. Turning to the edge AB, we compute the angle between its
deï¬ning facets as follows:
cosâˆ’1
 1
âˆš
3 (âˆ’1, âˆ’1, âˆ’1) Â· (0, 0, âˆ’1)

= cosâˆ’1
 1
âˆš
3

.
The edges AC and BC have the same solid angle by symmetry.
Finally, we compute the solid angle of the vertices: the origin has solid
angle 1
8, and the other three vertices all have the same solid angle Ï‰. With
Corollary 11.9 below (the Brianchonâ€“Gram relation), we can compute this
angle via
0 =
X
FâŠ†P
(âˆ’1)dim FÏ‰P(F) = âˆ’1 + 4 Â· 1
2 âˆ’3 Â· 1
4 âˆ’3 Â· cosâˆ’1
 1
âˆš
3

+ 1
8 + 3 Â· Ï‰ ,
which gives Ï‰ = cosâˆ’1 
1
âˆš
3

âˆ’1
8.
âŠ“âŠ”
We now introduce another measure of discrete volume; namely, we let

11.1 A New Discrete Volume Using Solid Angles
181
AP(t) :=
X
mâˆˆtPâˆ©Zd
Ï‰tP(m) ,
the sum of the solid angles at all integer points in tP; recalling that Ï‰P(x) = 0
if x /âˆˆP, we can also write
AP(t) =
X
mâˆˆZd
Ï‰tP(m) .
This new discrete volume measure diï¬€ers in a substantial way from the
Ehrhart counting function LP(t). Namely, suppose P is a d-polytope that can
be written as the union of the polytopes P1 and P2 such that dim (P1 âˆ©P2) <
d, that is, P1 and P2 are glued along a lower-dimensional subset. Then at each
lattice point m âˆˆZd, Ï‰P1(m) + Ï‰P2(m) = Ï‰P(m), and so the function AP
has an additive property:
AP(t) = AP1(t) + AP2(t) .
(11.1)
In contrast, the Ehrhart counting functions satisfy
LP(t) = LP1(t) + LP2(t) âˆ’LP1âˆ©P2(t) .
On the other hand, we can transfer computational eï¬€ort from the Ehrhart
counting functions to the solid-angle sum and vice versa, with the use of the
following lemma.
Lemma 11.2. Let P be a polytope. Then
AP(t) =
X
FâŠ†P
Ï‰P(F) LFâ—¦(t) .
Proof. The dilated polytope tP is the disjoint union of its relative open faces
tFâ—¦, so that we can write
AP(t) =
X
mâˆˆZd
Ï‰tP(m) =
X
FâŠ†P
X
mâˆˆZd
Ï‰tP(m) 1tFâ—¦(m) .
But Ï‰tP(m) is constant on each relatively open face tFâ—¦, and we called this
constant Ï‰P(F), whence
AP(t) =
X
FâŠ†P
Ï‰P(F)
X
mâˆˆZd
1tFâ—¦(m) =
X
FâŠ†P
Ï‰P(F) LFâ—¦(t) .
âŠ“âŠ”
Thus AP(t) is a polynomial (respectively quasipolynomial) in t for an
integral (respectively rational) polytope P. We claim that Lemma 11.2 is in
fact useful in practice. To drive the point home, we illustrate this identity by
computing the solid-angle sum over all integer points of âˆ†in Example 11.1.

182
11 Solid Angles
Example 11.3. We continue the solid-angle computation for the 3-simplex
âˆ†= conv {(0, 0, 0), (1, 0, 0), (0, 1, 0), (0, 0, 1)}. We recall from Section 2.3 that
Lâˆ†â—¦=
 tâˆ’1
3

. The facets of âˆ†are three standard triangles and one triangle
that appeared in the context of the Frobenius problem. All four facets have
the same interior Ehrhart polynomial
 tâˆ’1
2

. A similar phenomenon holds for
the edges of âˆ†: all six of them have the same interior Ehrhart polynomial
t âˆ’1. These polynomials add up, by Lemma 11.2 and Example 11.1, to the
solid-angle sum
Aâˆ†(t) =
t âˆ’1
3

+ 4 Â· 1
2
t âˆ’1
2

+

3 Â· 1
4 + 3 Â· cosâˆ’1
 1
âˆš
3

(t âˆ’1)
+ 1
8 + 3 Â·

cosâˆ’1
 1
âˆš
3

âˆ’1
8

= 1
6 t3 +

3 cosâˆ’1
 1
âˆš
3

âˆ’5
12

t .
The magic cancellation of the even terms of this polynomial is not a coinci-
dence, as we will discover in Theorem 11.7. The curious reader may notice
that the coeï¬ƒcient of t in this example is not a rational number, in stark
contrast with Ehrhart polynomials.
âŠ“âŠ”
The analogue of Ehrhartâ€™s theorem (Theorem 3.23) in the world of solid
angles is as follows.
Theorem 11.4 (Macdonaldâ€™s theorem). Suppose P is a rational convex
d-polytope. Then AP is a quasipolynomial of degree d whose leading coeï¬ƒcient
is vol P and whose period divides the denominator of P.
Proof. The denominator of a face F âŠ‚P divides the denominator of P, and
hence so does the period of LF, by Ehrhartâ€™s theorem (Theorem 3.23). By
Lemma 11.2, AP is a quasipolynomial with period dividing the denominator
of P. The leading term of AP equals the leading term of LPâ—¦, which is vol P,
by Corollary 3.20 and its extension in Exercise 3.29.
âŠ“âŠ”
11.2 Solid-Angle Generating Functions
and a Brion-Type Theorem
By analogy with the integer-point transform of a polyhedron P âŠ†Rd, which
lists all lattice points in P, we form the solid-angle generating function
Î±P(z) :=
X
mâˆˆPâˆ©Zd
Ï‰P(m) zm.
Using the same reasoning as in (11.1) for AP, this function satisï¬es a nice
additivity relation. Namely, if the d-polyhedron P equals P1 âˆªP2, where
dim (P1 âˆ©P2) < d, then

11.2 Solid-Angle Generating Functions and a Brion-Type Theorem
183
Î±P(z) = Î±P1(z) + Î±P2(z) .
(11.2)
This generating function obeys the following reciprocity relation, which par-
allels both the statement and proof of Theorem 4.3:
Theorem 11.5. Suppose K is a rational pointed d-cone K with the origin as
apex, and v âˆˆRd. Then the solid-angle generating function Î±v+K(z) of the
pointed d-cone v + K is a rational function that satisï¬es
Î±v+K
1
z

= (âˆ’1)dÎ±âˆ’v+K (z) .
Proof. Because solid angles are additive by (11.2), it suï¬ƒces to prove this the-
orem for simplicial cones. The proof for this case proceeds along the same lines
as the proof of Theorem 4.2; the main geometric ingredient is Exercise 4.2.
We invite the reader to ï¬nish the proof (Exercise 11.4).
âŠ“âŠ”
The analogue of Brionâ€™s theorem in terms of solid angles is as follows.
Theorem 11.6. Suppose P is a rational convex polytope. Then we have the
following identity of rational functions:
Î±P(z) =
X
v a vertex of P
Î±Kv(z) .
Proof. As in the proof of Theorem 9.7, it suï¬ƒces to prove Theorem 11.6 for
simplices. So let âˆ†be a rational simplex. We write âˆ†as the disjoint union of
its open faces and use Brionâ€™s theorem for open polytopes (Exercise 9.7) on
each face. That is, if we denote the vertex cone of F at vertex v by Kv(F),
then by a monomial version of Lemma 11.2,
Î±âˆ†(z) =
X
FâŠ†âˆ†
Ï‰âˆ†(F) ÏƒFâ—¦(z)
=
X
v a vertex of âˆ†
Ï‰âˆ†(v) zv +
X
FâŠ†âˆ†
dim F>0
Ï‰âˆ†(F)
X
v a vertex of F
ÏƒKv(F)â—¦(z) ,
where we used Brionâ€™s theorem for open polytopes (Exercise 9.7) in the second
step. By Exercise 11.5,
X
FâŠ†âˆ†
dim F>0
Ï‰âˆ†(F)
X
v a vertex of F
ÏƒKv(F)â—¦(z) =
X
v a vertex of âˆ†
X
FâŠ†Kv
dim F>0
Ï‰Kv(F) ÏƒFâ—¦(z) ,
and so
Î±âˆ†(z) =
X
v a vertex of âˆ†
Ï‰âˆ†(v) zv +
X
v a vertex of âˆ†
X
FâŠ†Kv
dim F>0
Ï‰Kv(F) ÏƒFâ—¦(z)
=
X
v a vertex of âˆ†
X
FâŠ†Kv
Ï‰Kv(F) ÏƒFâ—¦(z)
=
X
v a vertex of âˆ†
Î±Kv(z) .
âŠ“âŠ”

184
11 Solid Angles
11.3 Solid-Angle Reciprocity and the Brianchonâ€“Gram
Relations
With the help of Theorems 11.5 and 11.6, we can now prove the solid-angle
analogue of Ehrhartâ€“Macdonald reciprocity (Theorem 4.1):
Theorem 11.7 (Macdonaldâ€™s reciprocity theorem). Suppose P is a ra-
tional convex polytope. Then the quasipolynomial AP satisï¬es
AP(âˆ’t) = (âˆ’1)dim PAP(t) .
Proof. We give the proof for an integral polytope P and invite the reader to
generalize it to the rational case. The solid-angle counting function of P can
be computed through the generating function:
AP(t) = Î±tP(1, 1, . . . , 1) = lim
zâ†’1 Î±tP(z) .
By Theorem 11.6,
AP(t) = lim
zâ†’1
X
v a vertex of P
Î±tKv(z) ,
where Kv is the tangent cone of P at the vertex v. We write Kv = v + K(v),
where K(v) := Kv âˆ’v is a rational cone with the origin as its apex. Then
tKv = tv + K(v) because a cone whose apex is the origin does not change
under dilation. Hence we obtain, with the help of Exercise 11.3,
AP(t) = lim
zâ†’1
X
v a vertex of P
Î±tv+K(v)(z) = lim
zâ†’1
X
v a vertex of P
ztvÎ±K(v)(z) .
The rational functions Î±K(v)(z) on the right-hand side do not depend on t. If
we think of the sum over all vertices as one big rational function, to which we
apply Lâ€™HË†opitalâ€™s rule to compute the limit as z â†’1, this gives an alternative
proof that AP(t) is a polynomial, in line with our proof for the polynomiality
of LP(t) in Section 9.4. At the same time, this means we can view the identity
AP(t) = lim
zâ†’1
X
v a vertex of P
ztvÎ±K(v)(z)
in a purely algebraic fashion: on the left-hand side we have a polynomial that
makes sense for any complex t, and on the right-hand side we have a rational
function of z, whose limit we compute, for example, by Lâ€™HË†opitalâ€™s rule. So
the right-hand side, as a function of t, makes sense for any integer t. Hence
we have the algebraic relation, for integral t,
AP(âˆ’t) = lim
zâ†’1
X
v a vertex of P
zâˆ’tvÎ±K(v)(z) .

11.3 Solid-Angle Reciprocity and the Brianchonâ€“Gram Relations
185
But now by Theorem 11.5, Î±K(v)(z) = (âˆ’1)dÎ±K(v)
  1
z

, and so
AP(âˆ’t) = lim
zâ†’1
X
v a vertex of P
zâˆ’tv(âˆ’1)d Î±K(v)
1
z

= (âˆ’1)d lim
zâ†’1
X
v a vertex of P
1
z
tv
Î±K(v)
1
z

= (âˆ’1)d lim
zâ†’1
X
v a vertex of P
Î±tv+K(v)
1
z

= (âˆ’1)d lim
zâ†’1 Î±tP
1
z

= (âˆ’1)dAP(t) .
In the third step we used Exercise 11.3 again.
This proves Theorem 11.7 for integral polytopes. The proof for rational
polytopes follows along the same lines; one deals with rational vertices in the
same manner as in our second proof of Ehrhartâ€™s theorem in Section 9.4. We
invite the reader to ï¬nish the details in Exercise 11.6.
âŠ“âŠ”
We remark that throughout the proof, we cannot simply take the limit
inside the ï¬nite sum over the vertices of P, since z = 1 is a pole of each rational
function Î±K(v). It is precisely the magic of Brionâ€™s theorem that makes these
poles cancel each other, to yield AP(t).
If P is an integral polytope, then AP is a polynomial, and Theorem 11.7
tells us that AP is always even or odd:
AP(t) = cd td + cdâˆ’2tdâˆ’2 + Â· Â· Â· + c0 .
We can say more.
Theorem 11.8. Suppose P is a rational convex polytope. Then AP(0) = 0.
This is a meaningful zero. We note that the constant term of AP is given by
AP(0) =
X
FâŠ†P
Ï‰P(F) LFâ—¦(0) =
X
FâŠ†P
Ï‰P(F) (âˆ’1)dim F,
by Lemma 11.2 and Ehrhartâ€“Macdonald reciprocity (Theorem 4.1). Hence
Theorem 11.8 implies a classical and useful geometric identity:
Corollary 11.9 (Brianchonâ€“Gram relation). For a rational convex poly-
tope P,
X
FâŠ†P
(âˆ’1)dim FÏ‰P(F) = 0 .

186
11 Solid Angles
Example 11.10. Consider a triangle T in R2 with vertices v1, v2, v3 and
edges E1, E2, E3. The Brianchonâ€“Gram relation tells us that for this triangle,
Ï‰T (v1) + Ï‰T (v2) + Ï‰T (v3) âˆ’(Ï‰T (E1) + Ï‰T (E2) + Ï‰T (E3)) + Ï‰T (T ) = 0 .
Since the solid angles of the edges are all
1
2 and Ï‰T (T ) = 1, we recover
our friendly high-school identity â€œthe sum of the angles in a triangle is 180
degreesâ€:
Ï‰T (v1) + Ï‰T (v2) + Ï‰T (v3) = 1
2 .
Thus the Brianchonâ€“Gram relation is the extension of this well-known fact to
any dimension and any convex polytope.
âŠ“âŠ”
Proof of Theorem 11.8. It suï¬ƒces to prove Aâˆ†(0) = 0 for a rational simplex
âˆ†, since solid angles of a triangulation simply add, by (11.1). Theorem 11.7
gives Aâˆ†(0) = 0 if dim âˆ†is odd.
So now suppose âˆ†is a rational d-simplex, where d is even, with vertices
v1, v2, . . . , vd+1. Let P(n) be the (d + 1)-dimensional pyramid that we obtain
by taking the convex hull of (v1, 0) , (v2, 0) , . . . , (vd+1, 0), and (0, 0, . . . , 0, n),
where n is a positive integer (see Figure 11.1). Note that, since d + 1 is odd,
x1
x2
x3
n
Fig. 11.1. The pyramid P(n) for a triangle âˆ†.
AP(n)(0) =
X
F(n)âŠ†P(n)
(âˆ’1)dim F(n)Ï‰P(n)(F(n)) = 0 .
We will conclude from this identity that P
FâŠ†âˆ†(âˆ’1)dim FÏ‰âˆ†(F) = 0, which
implies that Aâˆ†(0) = 0. To this end, we consider two types of faces of P(n):
(a) those that are also faces of âˆ†, and

11.3 Solid-Angle Reciprocity and the Brianchonâ€“Gram Relations
187
(b) those that are not contained in âˆ†.
We start with the latter: Aside from the vertex (0, 0, . . . , 0, n), every face F(n)
of P(n) that is not a face of âˆ†is the pyramid over a face G of âˆ†; letâ€™s denote
this pyramid by Pyr (G, n). Further, as n grows, the solid angle of Pyr (G, n)
(in P(n)) approaches the solid angle of G (in âˆ†):
lim
nâ†’âˆÏ‰P(n) (Pyr (G, n)) = Ï‰âˆ†(G) ,
since weâ€™re forming âˆ†Ã—[0, âˆ) in the limit. On the other hand, a face F(n) = G
of P(n) that is also a face of âˆ†obeys the following limit behavior:
lim
nâ†’âˆÏ‰P(n) (F(n)) = 1
2 Ï‰âˆ†(G) .
The only face of P(n) that we still have to account for is the vertex v :=
(0, 0, . . . , 0, n). Hence
0 =
X
F(n)âŠ†P(n)
(âˆ’1)dim F(n)Ï‰P(n)(F(n))
= Ï‰P(n)(v) +
X
GâŠ†âˆ†
(âˆ’1)dim G+1Ï‰P(n) (Pyr (G, n))
+
X
GâŠ†âˆ†
(âˆ’1)dim GÏ‰P(n) (G) .
Now we take the limit as n â†’âˆon both sides; note that limnâ†’âˆÏ‰P(n)(v) =
0, so that we obtain
0 =
X
GâŠ†âˆ†
(âˆ’1)dim G+1Ï‰âˆ†(G) +
X
GâŠ†âˆ†
(âˆ’1)dim G 1
2 Ï‰âˆ†(G)
= 1
2
X
GâŠ†âˆ†
(âˆ’1)dim G+1Ï‰âˆ†(G) ,
and so
Aâˆ†(0) =
X
GâŠ†âˆ†
(âˆ’1)dim GÏ‰âˆ†(G) = 0 .
âŠ“âŠ”
The combination of Theorems 11.7 and 11.8 implies that summing solid
angles in a polygon is equivalent to computing its area:
Corollary 11.11. Suppose P is a 2-dimensional integral polytope with area
A. Then AP(t) = A t2.

188
11 Solid Angles
11.4 The Generating Function of Macdonaldâ€™s
Solid-Angle Polynomials
We conclude this chapter with the study of the solid-angle analogue of Ehrhart
series. Given an integral polytope P, we deï¬ne the solid-angle series of P as
the generating function of the solid-angle polynomial, encoding the solid-angle
sum over all dilates of P simultaneously:
SolidP(z) :=
X
tâ‰¥0
AP(t) zt.
The following theorem is the solid-angle analogue to Theorems 3.12 and 4.4,
with the added bonus that we get the palindromy of the numerator of SolidP
for free.
Theorem 11.12. Suppose P is an integral d-polytope. Then SolidP is a ra-
tional function of the form
SolidP(z) = adzd + adâˆ’1zdâˆ’1 + Â· Â· Â· + a1z
(1 âˆ’z)d+1
.
Furthermore, we have the identity
SolidP
1
z

= (âˆ’1)d+1 SolidP(z)
or, equivalently, ak = ad+1âˆ’k for 1 â‰¤k â‰¤d
2.
Proof. The form of the rational function SolidP follows by Lemma 3.9 from
the fact that AP is a polynomial. The palindromy of a1, a2, . . . , ad is equivalent
to the relation
SolidP
1
z

= (âˆ’1)d+1 SolidP(z) ,
which, in turn, follows from Theorem 11.7:
SolidP(z) =
X
tâ‰¥0
AP(t) zt =
X
tâ‰¥0
(âˆ’1)dAP(âˆ’t) zt = (âˆ’1)d X
tâ‰¤0
AP(t) zâˆ’t.
Now we use Exercise 4.5:
(âˆ’1)d X
tâ‰¤0
AP(t) zâˆ’t = (âˆ’1)d+1 X
tâ‰¥1
AP(t) zâˆ’t = (âˆ’1)d+1 SolidP
1
z

.
In the last step we used the fact that AP(0) = 0 (Theorem 11.8).
âŠ“âŠ”

Exercises
189
Notes
1. I. G. Macdonald inaugurated the systematic study of solid-angle sums in
integral polytopes. The fundamental Theorems 11.4, 11.7, and 11.8 can be
found in his 1971 paper [123]. The proof of Theorem 11.7 we give here follows
[26].
2. The Brianchonâ€“Gram relation (Corollary 11.9) is the solid-angle analogue
of the Euler relation for face numbers (Theorem 5.2). The 2-dimensional case
discussed in Example 11.10 is ancient; it was most certainly known to Euclid.
The 3-dimensional case of Corollary 11.9 was discovered by Charles Julien
Brianchon in 1837 andâ€”as far as we knowâ€”was independently reproved by
JÃ¸rgen Gram in 1874 [88]. It is not clear who ï¬rst proved the general d-
dimensional case of Corollary 11.9. The oldest proofs we could ï¬nd were from
the 1960s, by Branko GrÂ¨unbaum [90], Micha A. Perles, and Geoï¬€rey C. Shep-
hard [142, 162].
3. Theorem 11.5 is a particular case of a reciprocity relation for simple lattice-
invariant valuations due to Peter McMullen [128], who also proved a parallel
extension of Ehrhartâ€“Macdonald reciprocity to general lattice-invariant val-
uations. There is a current resurgence of activity on solid angles; see, for
example, [52].
Exercises
11.1. Compute AP(t), where P is the regular tetrahedron with vertices
(0, 0, 0), (1, 1, 0), (1, 0, 1), and (0, 1, 1) (see Exercise 2.13).
11.2. Compute AP(t), where P is the rational triangle with vertices (0, 0),
  1
2, 1
2

, and (1, 0).
11.3. â™£Let K be a rational d-cone and let m âˆˆZd. By analogy with Exer-
cise 3.5, show that Î±m+K(z) = zmÎ±K(z).
11.4. â™£Complete the proof of Theorem 11.5: For a rational pointed d-cone
K, Î±K(z) is a rational function that satisï¬es
Î±K
1
z

= (âˆ’1)dÎ±K (z) .
11.5. â™£Suppose âˆ†is a rational simplex. Prove that
X
FâŠ†âˆ†
dim F>0
Ï‰âˆ†(F)
X
v a vertex of F
ÏƒKv(F)â—¦(z) =
X
v a vertex of âˆ†
X
FâŠ†Kv
dim F>0
Ï‰Kv(F) ÏƒFâ—¦(z) .

190
11 Solid Angles
11.6. â™£Provide the details of the proof of Theorem 11.7 for rational poly-
topes: Prove that if P is a rational convex polytope, then the quasipolynomial
AP satisï¬es
AP(âˆ’t) = (âˆ’1)dim PAP(t) .
11.7. Recall from Exercise 3.1 that to any permutation Ï€ âˆˆSd on d elements
we can associate the simplex
âˆ†Ï€ := conv

0, eÏ€(1), eÏ€(1) + eÏ€(2), . . . , eÏ€(1) + eÏ€(2) + Â· Â· Â· + eÏ€(d)
	
.
Prove that for all Ï€ âˆˆSn, Aâˆ†Ï€(t) = 1
d! td.
11.8. Give a direct proof of Corollary 11.11, e.g., using Pickâ€™s theorem (The-
orem 2.8).
11.9. State and prove the analogue of Theorem 11.12 for rational polytopes.
Open Problems
11.10. Study the roots of solid-angle polynomials.
11.11. Classify all polytopes that have only rational solid angles at their ver-
tices.
11.12. Among all d-simplices âˆ†, does the regular d-simplex have the property
that P
v a vertex of âˆ†Ï‰âˆ†(v) is a minimum?
11.13. Which integral polytopes P have solid-angle polynomials AP(t) âˆˆ
Q[t]? That is, for which integral polytopes P are all the coeï¬ƒcients of AP(t)
rational?
11.14. Are there solid-angle polynomials with negative coeï¬ƒcients?
11.15. Does the numerator polynomial of the rational generating function
SolidP(z) always have nonnegative coeï¬ƒcients, by analogy with Theorem 3.12?

12
A Discrete Version of Greenâ€™s Theorem
Using Elliptic Functions
The shortest route between two truths in the real domain passes through the complex
domain.
Jacques Salomon Hadamard (1865â€“1963)
We now allow ourselves the luxury of using basic complex analysis. In par-
ticular, we assume that the reader is familiar with contour integration and
the residue theorem. We may view the residue theorem as yet another re-
sult that intimately connects the continuous and the discrete: it transforms a
continuous integral into a discrete sum of residues.
Using the WeierstraÃŸ â„˜and Î¶ functions, we show here that Pickâ€™s theorem
is a discrete version of Greenâ€™s theorem in the plane. As a bonus, we also
obtain an integral formula (Theorem 12.5 below) for the discrepancy between
the area enclosed by a general curve C and the number of integer points
contained in C.
12.1 The Residue Theorem
We begin this chapter by reviewing a few concepts from complex analysis.
Suppose the complex-valued function f has an isolated singularity w âˆˆG;
that is, there is an open set G âŠ‚C such that f is analytic on G \ {w}. Then
f can be expressed locally by the Laurent series
f(z) =
X
nâˆˆZ
cn (z âˆ’w)n ,
valid for all z âˆˆG; here cn âˆˆC. The coeï¬ƒcient câˆ’1 is called the residue of f
at w; we will denote it by Res(z = w). The reason to give câˆ’1 a special name
can be found in the following theorem. We call a function meromorphic if
it is analytic in C with the exception of isolated poles.

192
12 A Discrete Version of Greenâ€™s Theorem Using Elliptic Functions
Theorem 12.1 (Residue theorem). Suppose f is meromorphic and C is
a positively oriented, piecewise diï¬€erentiable, simple, closed curve that does
not pass through any pole of f. Then
Z
C
f = 2Ï€i
X
w
Res(z = w) ,
where the sum is taken over all singularities w inside C.
âŠ“âŠ”
If f is a rational function, Theorem 12.1 gives the same result as the
partial fraction expansion of f. We illustrate this philosophy by returning to
the elementary beginnings of Chapter 1.
Example 12.2. Recall our constant-term identity for the restricted partition
function for A = {a1, a2, . . . , ad} in Chapter 1:
pA(n) = const

1
(1 âˆ’za1) (1 âˆ’za2) Â· Â· Â· (1 âˆ’zad) zn

.
Computing the constant term of the Laurent series of
1
(1âˆ’za1)Â·Â·Â·(1âˆ’zad)zn ex-
panded about z = 0 is, naturally, equivalent to â€œshiftingâ€ this function by one
exponent and computing the residue at z = 0 of the function
f(z) :=
1
(1 âˆ’za1) (1 âˆ’za2) Â· Â· Â· (1 âˆ’zad) zn+1 .
Now let Cr be a positively oriented circle of radius r > 1, centered at the
origin. The residue Res(z = 0) = pA(n) is one of the residues that are picked
up by the integral
1
2Ï€i
Z
Cr
f = Res(z = 0) +
X
w
Res(z = w) ,
where the sum is over all nonzero poles w of f that lie inside Cr. These
poles are at the ath
1 , ath
2 , . . . , ath
d
roots of unity. Moreover, with the help of
Exercise 12.1 we can show that
0 = lim
râ†’âˆ
1
2Ï€i
Z
Cr
f
= lim
râ†’âˆ
 
Res(z = 0) +
X
w
Res(z = w)
!
= Res(z = 0) +
X
w
Res(z = w) ,
where the sum extends over all ath
1 , ath
2 , . . . , ath
d roots of unity. In other words,
pA(n) = Res(z = 0) = âˆ’
X
w
Res(z = w) .

12.2 The WeierstraÃŸ â„˜and Î¶ Functions
193
To obtain the restricted partition function pA, it remains to compute the
residues at the roots of unity, and we invite the reader to realize that this
computation is equivalent to the partial fraction expansion of Chapter 1 (Ex-
ercise 12.2).
âŠ“âŠ”
Analogous residue computations could replace any of the constant-term
calculations that we performed in the earlier chapters.
12.2 The WeierstraÃŸ â„˜and Î¶ Functions
The main character in our play is the WeierstraÃŸ Î¶-function, deï¬ned by
Î¶(z) = 1
z +
X
(m,n)âˆˆZ2\(0,0)
 
1
z âˆ’(m + ni) +
1
m + ni +
z
(m + ni)2
!
.
(12.1)
This inï¬nite sum converges absolutely for z belonging to compact subsets of
the lattice-punctured plane C \ Z2 (Exercise 12.4), and hence forms a mero-
morphic function of z.
The WeierstraÃŸ Î¶-function possesses the following salient properties, which
follow immediately from (12.1):
(1) Î¶ has a simple pole at every integer point m+ni and is analytic elsewhere.
(2) The residue of Î¶ at each integer point m + ni equals 1.
We can easily check (Exercise 12.5) that
â„˜(z) := âˆ’Î¶â€²(z) =
1
z2 +
X
(m,n)âˆˆZ2\(0,0)
 
1
(z âˆ’(m + ni))2 âˆ’
1
(m + ni)2
!
,
(12.2)
the WeierstraÃŸ â„˜-function. The â„˜-function has a pole of order 2 at each
integer point m+ni and is analytic elsewhere, but has residue equal to zero at
each integer point m+ni. However, â„˜possesses a very pleasant property that
Î¶ does not: â„˜is doubly periodic on C. We may state this more concretely:
Lemma 12.3. â„˜(z + 1) = â„˜(z + i) = â„˜(z) .
Proof. We ï¬rst invite the reader to prove the following two properties of â„˜â€²
(Exercises 12.6 and 12.7):
â„˜â€² (z + 1) = â„˜â€²(z) ,
(12.3)
Z z1
z0
â„˜â€² (z) dz is path independent.
(12.4)
By (12.3),
d
dz (â„˜(z + 1) âˆ’â„˜(z)) = â„˜â€² (z + 1) âˆ’â„˜â€²(z) = 0 ,

194
12 A Discrete Version of Greenâ€™s Theorem Using Elliptic Functions
so â„˜(z + 1) âˆ’â„˜(z) = c for some constant c. On the other hand, â„˜is an even
function (Exercise 12.8), and so z = âˆ’1
2 gives us
c = â„˜
  1
2

âˆ’â„˜
 âˆ’1
2

= 0 .
This shows that â„˜(z + 1) = â„˜(z) for all z âˆˆC\Z2. An analogous proof, which
we invite the reader to construct in Exercise 12.9, shows that â„˜(z + i) = â„˜(z).
âŠ“âŠ”
Lemma 12.3 implies that â„˜(z + m + ni) = â„˜(z) for all m, n âˆˆZ. The
following lemma shows that the WeierstraÃŸ Î¶-function is only a conjugate-
analytic term away from being doubly periodic.
Lemma 12.4. There is a constant Î± such that the function Î¶(z)+Î±z is doubly
periodic with periods 1 and i.
Proof. We begin with w = m + ni:
Î¶ (z + m + ni) âˆ’Î¶(z) = âˆ’
Z m+ni
w=0
â„˜(z + w) dw ,
(12.5)
by deï¬nition of â„˜(z) = âˆ’Î¶â€²(z). To make sure that (12.5) makes sense, we
should also check that the deï¬nite integral in (12.5) is path independent (Ex-
ercise 12.10).
Due to the double periodicity of â„˜,
Z m+ni
w=0
â„˜(z + w) dw = m
Z 1
0
â„˜(z + t) dt + ni
Z 1
0
â„˜(z + it) dt
:= mÎ±(z) + niÎ²(z) ,
where
Î±(z) :=
Z 1
0
â„˜(z + t) dt
and
Î²(z) :=
Z 1
0
â„˜(z + it) dt .
Now we observe that Î± (z + x0) = Î±(z) for any x0 âˆˆR, so that Î± (x + iy)
depends only on y. Similarly, Î² (x + iy) depends only on x. But
Î¶ (z + m + in) âˆ’Î¶(z) = âˆ’(mÎ±(y) + inÎ²(x))
must be analytic for all z âˆˆC \ Z2. If we now set m = 0, we conclude that
Î²(x) must be analytic in C \ Z2, so that Î²(x) must be a constant by the
Cauchyâ€“Riemann equations for analytic functions. Similarly, setting n = 0
implies that Î±(y) is constant. Thus
Î¶ (z + m + in) âˆ’Î¶(z) = âˆ’(mÎ± + inÎ²)
with constants Î± and Î². Going back to the WeierstraÃŸ â„˜-function, we can
integrate the identity (Exercise 12.11)

12.3 A Contour-Integral Extension of Pickâ€™s Theorem
195
â„˜(iz) = âˆ’â„˜(z)
(12.6)
to obtain the relationship Î² = âˆ’Î±, since
Î² =
Z 1
0
â„˜(z + it) dt =
Z 1
0
â„˜(it) dt = âˆ’
Z 1
0
â„˜(t) dt = âˆ’Î± .
To summarize, we have
Î¶ (z + m + in) âˆ’Î¶(z) = âˆ’mÎ± + inÎ± = âˆ’Î±
 z + m + in âˆ’z

,
so that Î¶(z) + Î±z is doubly periodic.
âŠ“âŠ”
12.3 A Contour-Integral Extension of Pickâ€™s Theorem
For the remainder of this chapter, let C be any piecewise-diï¬€erentiable, simple,
closed curve in the plane, with a counterclockwise parametrization. We let D
denote the region that C contains in its interior.
Theorem 12.5. Let C avoid any integer point, that is, C âˆ©Z2 = âˆ…. Let I
denote the number of integer points interior to C, and A the area of the region
D enclosed by the curve C. Then
1
2Ï€i
Z
C
(Î¶(z) âˆ’Ï€z) dz = I âˆ’A .
Proof. We have
Z
C
(Î¶(z) + Î±z) dz =
Z
C
Î¶(z) dz + Î±
Z
C
(x âˆ’iy) (dx + idy) .
By Theorem 12.1,
R
C Î¶(z) dz is equal to the sum of the residues of Î¶ at all of
its interior poles. There are I such poles, and each pole of Î¶ has residue 1.
Thus
1
2Ï€i
Z
C
Î¶(z) dz = I .
(12.7)
On the other hand, Greenâ€™s theorem tells us that
Z
C
(x âˆ’iy) (dx + idy) =
Z
C
(x âˆ’iy) dx + (y + ix) dy
=
Z
D
âˆ‚
âˆ‚x (y + ix) âˆ’âˆ‚
âˆ‚y (x âˆ’iy)
=
Z Z
D
2i
= 2iA .

196
12 A Discrete Version of Greenâ€™s Theorem Using Elliptic Functions
Going back to (12.7), we get
Z
C
(Î¶(z) + Î±z) dz = 2Ï€iI + Î± (2iA) .
(12.8)
We only have to show that Î± = âˆ’Ï€. Consider the particular curve C that is
a square path, centered at the origin, traversing the origin counterclockwise,
and bounding a square of area 1. Thus I = 1 for this path. Since Î¶(z) + Î±z
is doubly periodic by Lemma 12.4, the integral in (12.8) vanishes. We can
conclude that
0 = 2Ï€i Â· 1 + Î± (2i Â· 1) ,
so that Î± = âˆ’Ï€.
âŠ“âŠ”
Notice that Theorem 12.5 has given us information about the WeierstraÃŸ
Î¶-function, namely that Î± = âˆ’Ï€.
This chapter oï¬€ers a detour into an inï¬nite landscape of discrete results
that meet their continuous counterparts. Equipped with the modest tools
oï¬€ered in this book, we hope we have motivated the reader to explore this
landscape further. . .
Notes
1. The WeierstraÃŸ â„˜-function, named after Karl Theodor Wilhelm Weier-
straÃŸ (1815â€“1897),1 can be extended to any two-dimensional lattice L =
{kw1 + jw2 : k, j âˆˆZ} for some w1, w2 âˆˆC that are linearly independent
over R:
â„˜L(z) = 1
z2 +
X
mâˆˆL\{0}
 
1
(z âˆ’m)2 âˆ’1
m2
!
.
The WeierstraÃŸ â„˜L-function and its derivative â„˜â€²
L satisfy a polynomial rela-
tionship, namely, (â„˜â€²
L)2 = 4 (â„˜L)3 âˆ’g2 â„˜L âˆ’g3 for some constants g2 and g3
that depend on L. This is the beginning of a wonderful friendship between
complex analysis and elliptic curves.
2. Theorem 12.5 appeared in [75]. There it is also shown that one can retrieve
Pickâ€™s theorem (Theorem 2.8) from Theorem 12.5.
Exercises
12.1. â™£Show that for positive integers a1, ad, . . . , ad, n,
1 For more information about WeierstraÃŸ, see
http://www-groups.dcs.st-and.ac.uk/âˆ¼history/Biographies/Weierstrass.html.

Open Problems
197
lim
râ†’âˆ
Z
Cr
1
(1 âˆ’za1) Â· Â· Â· (1 âˆ’zad) zn+1 = 0 .
This computation shows that the integrand above â€œhas no pole at inï¬nity.â€
12.2. â™£Compute the residues at the nontrivial roots of unity of
f(z) =
1
(1 âˆ’za1) Â· Â· Â· (1 âˆ’zad) zn+1 .
For simplicity, you may assume that a1, a2, . . . , ad are pairwise relatively
prime.
12.3. Give an integral version of Theorem 2.13.
12.4. â™£Show that
Î¶(z) = 1
z +
X
(m,n)âˆˆZ2\(0,0)
 
1
z âˆ’(m + ni) +
1
m + ni +
z
(m + ni)2
!
converges absolutely for z belonging to compact subsets of C \ Z2.
12.5. â™£Prove (12.2), that is,
Î¶â€²(z) = âˆ’1
z2 âˆ’
X
(m,n)âˆˆZ2\(0,0)
 
1
(z âˆ’(m + ni))2 âˆ’
1
(m + ni)2
!
.
12.6. â™£Prove (12.3), that is, show that â„˜â€² (z + 1) = â„˜â€²(z).
12.7. â™£Prove (12.4), that is, show that for any z0, z1 âˆˆC \ Z2,
R z1
z0 â„˜â€²(w) dw
is path independent.
12.8. â™£Show that â„˜is even, that is, â„˜(âˆ’z) = â„˜(z).
12.9. â™£Finish the proof of Lemma 12.3 by showing that â„˜(z + i) = â„˜(z).
12.10. â™£Prove that the integral in (12.5),
Î¶ (z + m + ni) âˆ’Î¶(z) = âˆ’
Z w=m+ni
w=0
â„˜(z + w) dw ,
is path independent.
12.11. â™£Prove (12.6), that is, â„˜(iz) = âˆ’â„˜(z).
Open Problems
12.12. Can we get even more information about the WeierstraÃŸ â„˜and Î¶ func-
tions by using more detailed knowledge of the discrepancy between I and A
for special curves C?
12.13. Find a complex-analytic extension of Theorem 12.5 to higher dimen-
sions.


A
Vertex and Hyperplane Descriptions
of Polytopes
Everything should be made as simple as possible, but not simpler.
Albert Einstein
In this appendix, we prove that every polytope has a vertex and a hyperplane
description. This appendix owes everything to GÂ¨unter Zieglerâ€™s beautiful ex-
position in [193]; in fact, these pages contain merely a few cherries picked from
[193, Lecture 1].
As in Chapter 3, it is easier to move to the world of cones. To be as concrete
as possible, let us call K âŠ†Rd an h-cone if
K =

x âˆˆRd : A x â‰¤0
	
for some A âˆˆRmÃ—d; in this case K is given as the intersection of m halfspaces
determined by the rows of A. We use the notation K = hcone(A).
On the other hand, we call K âŠ†Rd a v-cone if
K = {B y : y â‰¥0}
for some B âˆˆRdÃ—n, that is, K is a pointed cone with the column vectors of
B as generators. In this case we use the notation K = vcone(B).
Note that, according to our deï¬nitions, any h- or v-cone contains the origin
in its apex. We will prove that every h-cone is a v-cone and vice versa. More
precisely:
Theorem A.1. For every A âˆˆRmÃ—d there exists B âˆˆRdÃ—n (for some n)
such that hcone(A) = vcone(B). Conversely, for every B âˆˆRdÃ—n there exists
A âˆˆRmÃ—d (for some m) such that vcone(B) = hcone(A).
We will prove the two halves of Theorem A.1 in Sections A.1 and A.2. For
now, let us record that Theorem A.1 implies our goal, that is, the equivalence
of the vertex and halfspace description of a polytope:

200
Appendix A: Vertex and Hyperplane Descriptions of Polytopes
Corollary A.2. If P is the convex hull of ï¬nitely many points in Rd, then P
is the intersection of ï¬nitely many half spaces in Rd. Conversely, if P is given
as the bounded intersection of ï¬nitely many half spaces in Rd, then P is the
convex hull of ï¬nitely many points in Rd.
Proof. If P = conv {v1, v2, . . . , vn} for some v1, v2, . . . , vn âˆˆRd, then coning
over P (as deï¬ned in Chapter 3) gives
cone(P) = vcone

v1 v2 . . . vn
1
1
1

.
By Theorem A.1 we can ï¬nd a matrix (A, b) âˆˆRmÃ—(d+1) such that
cone(P) = hcone(A, b) =

x âˆˆRd+1 : (A, b) x â‰¤0
	
.
We recover the polytope P upon setting xd+1 = 1, that is,
P =

x âˆˆRd : Ax â‰¤âˆ’b
	
,
which is a hyperplane description of P.
These steps can be reversed: Suppose the polytope P is given as
P =

x âˆˆRd : Ax â‰¤âˆ’b
	
for some A âˆˆRmÃ—d and b âˆˆRm. Then P can be obtained from
hcone(A, b) =

x âˆˆRd+1 : (A, b) x â‰¤0
	
by setting xd+1 = 1. By Theorem A.1 we can construct a matrix B âˆˆR(d+1)Ã—n
such that
hcone(A, b) = vcone(B) .
We may normalize the generators of vcone(B), that is, the columns of B, such
that they all have (d + 1)st variable equal to one:
B =
 v1 v2 . . . vn
1
1
1

.
Since P can be recovered from vcone(B) by setting xd+1 = 1, we conclude
that P = conv {v1, v2, . . . , vn}.
âŠ“âŠ”
A.1 Every h-cone is a v-cone
Suppose
K = hcone(A) =

x âˆˆRd : Ax â‰¤0
	
for some A âˆˆRmÃ—d. We introduce an auxiliary m-dimensional variable y and
write

A.1 Every h-cone is a v-cone
201
K =
x
y

âˆˆRd+m : A x â‰¤y

âˆ©
x
y

âˆˆRd+m : y = 0

.
(A.1)
(Strictly speaking, this is K lifted into a d-dimensional subspace of Rd+m.)
Our goal in this section is to prove the following two lemmas.
Lemma A.3. The h-cone
n x
y

âˆˆRd+m : A x â‰¤y
o
is a v-cone.
Lemma A.4. If K âŠ†Rd is a v-cone, then so is K âˆ©

x âˆˆRd : xk = 0
	
, for
any k.
The ï¬rst half of Theorem A.1 follows with these two lemmas, as we can start
with (A.1) and intersect with one hyperplane yk = 0 at a time.
Proof of Lemma A.3. We start by noting that
K =
x
y

âˆˆRd+m : A x â‰¤y

=
x
y

âˆˆRd+m : (A, âˆ’I)
x
y

â‰¤0

is an h-cone; here I represents an m Ã— m identity matrix. Let us denote the
kth unit vector by ek. Then we can decompose
x
y

=
d
X
j=1
xj
 ej
A ej

+
m
X
k=1
(yk âˆ’(A x)k)
 0
ek

=
d
X
j=1
|xj| sign (xj)
 ej
A ej

+
m
X
k=1
(yk âˆ’(A x)k)
 0
ek

.
Note that if
 x
y

âˆˆK then yk âˆ’(A x)k â‰¥0 for all k, and so
 x
y

can be written
as a nonnegative linear combination of the vectors sign (xj)
  ej
A ej

, 1 â‰¤j â‰¤d,
and
  0
ek

, 1 â‰¤k â‰¤m. But this means that K is a v-cone.
âŠ“âŠ”
Proof of Lemma A.4. Suppose K = vcone(B), where B has the column vec-
tors b1, b2, . . . , bn âˆˆRd; that is, b1, b2, . . . , bn are the generators of K. Fix
k â‰¤d and construct a new matrix Bk whose column vectors are all bj for
which bjk = 0, and the combinations bikbj âˆ’bjkbi whenever bik > 0 and
bjk < 0. We claim that
K âˆ©

x âˆˆRd : xk = 0
	
= vcone (Bk) .
Every x âˆˆvcone (Bk) satisï¬es xk = 0 by construction of Bk, and so
vcone (Bk) âŠ†Kâˆ©

x âˆˆRd : xk = 0
	
follows immediately. We need to do some
more work to prove the reverse containment.

202
Appendix A: Vertex and Hyperplane Descriptions of Polytopes
Suppose x âˆˆKâˆ©

x âˆˆRd : xk = 0
	
, that is, x = Î»1b1 +Î»2b2 +Â· Â· Â·+Î»nbn
for some Î»1, Î»2, . . . , Î»n â‰¥0 and xk = Î»1b1k + Î»2b2k + Â· Â· Â· + Î»nbnk = 0. This
allows us to deï¬ne
Î› =
X
i: bik>0
Î»ibik = âˆ’
X
j: bjk<0
Î»jbjk .
Note that Î› â‰¥0. Now consider the decomposition
x =
X
j: bjk=0
Î»jbj +
X
i: bik>0
Î»ibi +
X
j: bjk<0
Î»jbj .
(A.2)
If Î› = 0 then Î»ibik = 0 for all i such that bik > 0, and so Î»i = 0 for these i.
Similarly, Î»j = 0 for all j such that bjk < 0. Thus we conclude from Î› = 0
that
x =
X
j: bjk=0
Î»jbj âˆˆvcone (Bk) .
Now assume Î› > 0. Then we can expand the decomposition (A.2) into
x =
X
j: bjk=0
Î»jbj + 1
Î›
ï£«
ï£­âˆ’
X
j: bjk<0
Î»jbjk
ï£¶
ï£¸
 X
i: bik>0
Î»ibi
!
+ 1
Î›
 X
i: bik>0
Î»ibik
! ï£«
ï£­X
j: bjk<0
Î»jbj
ï£¶
ï£¸
=
X
j: bjk=0
Î»jbj + 1
Î›
X
i: bik>0
j: bjk<0
Î»iÎ»j (bikbj âˆ’bjkbi) ,
which is by construction in vcone (Bk).
âŠ“âŠ”
A.2 Every v-cone is an h-cone
Suppose
K = vcone(B) = {B y : y â‰¥0}
for some B âˆˆRdÃ—n. Then K is the projection of
x
y

âˆˆRd+n : y â‰¥0, x = B y

(A.3)
to the subspace
n x
y

âˆˆRd+n : y = 0
o
. The constraints for (A.3) can be writ-
ten as
y â‰¥0
and
(I, âˆ’B)
x
y

= 0 .
Thus the set (A.3) is an h-cone, for which we can project one component of
y at a time to obtain K. This means that it suï¬ƒces to prove the following
lemma to ï¬nish the second half of Theorem A.1.

A.2 Every v-cone is an h-cone
203
Lemma A.5. If K is an h-cone, then the projection {x âˆ’xkek : x âˆˆK} is
also an h-cone, for any k.
Proof. Suppose K = hcone(A) for some A âˆˆRmÃ—d. Fix k and consider
Pk = {x + Î»ek : x âˆˆK, Î» âˆˆR} .
The projection weâ€™re after can be constructed from this set as
{x âˆ’xkek : x âˆˆK} = Pk âˆ©

x âˆˆRd : xk = 0
	
,
so that it suï¬ƒces to prove that Pk is an h-cone.
Suppose a1, a2, . . . , am are the row vectors of A. We construct a new ma-
trix Ak whose row vectors are all aj for which ajk = 0, and the combinations
aikaj âˆ’ajkai whenever aik > 0 and ajk < 0. We claim that Pk = hcone (Ak).
If x âˆˆK then A x â‰¤0, which implies Ak x â‰¤0 because each row of Ak is
a nonnegative linear combination of rows of A; that is, K âŠ†hcone (Ak). How-
ever, the kth component of Ak is zero by construction, and so K âŠ†hcone (Ak)
implies Pk âŠ†hcone (Ak).
Conversely, suppose x âˆˆhcone (Ak). We need to ï¬nd a Î» âˆˆR such that
A (x âˆ’Î»ek) â‰¤0, that is,
a11x1 + Â· Â· Â· + a1k (xk âˆ’Î») + Â· Â· Â· + a1dxd â‰¤0
...
am1x1 + Â· Â· Â· + amk (xk âˆ’Î») + Â· Â· Â· + amdxd â‰¤0 .
The jth constraint is aj Â· x âˆ’ajkÎ» â‰¤0, that is, aj Â· x â‰¤ajkÎ». This gives the
following conditions on Î»:
Î» â‰¥ai Â· x
aik
if aik > 0 ,
Î» â‰¤aj Â· x
ajk
if ajk < 0 .
Such a Î» exists because if aik > 0 and ajk < 0 then (since x âˆˆhcone (Ak))
(aikaj âˆ’ajkai) Â· x â‰¤0 ,
which is equivalent to
ai Â· x
aik
â‰¤aj Â· x
ajk
.
Thus we can ï¬nd a Î» that satisï¬es
ai Â· x
aik
â‰¤Î» â‰¤aj Â· x
ajk
,
which proves hcone (Ak) âŠ†Pk.
âŠ“âŠ”

B
Triangulations of Polytopes
Obvious is the most dangerous word in mathematics.
Eric Temple Bell
The goal of this appendix is to prove Theorem 3.1. Recall that a triangula-
tion of a convex d-polytope P is a ï¬nite collection T of d-simplices with the
following properties:
â€¢
P =
[
âˆ†âˆˆT
âˆ†.
â€¢
For any âˆ†1, âˆ†2 âˆˆT, âˆ†1 âˆ©âˆ†2 is a face common to both âˆ†1 and âˆ†2.
Theorem 3.1 says that P can be triangulated using no new vertices, that is,
there exists a triangulation T such that the vertices of any âˆ†âˆˆT are vertices
of P. In preparation, we ï¬rst show that a triangulation of a polytope induces
a triangulation on any of its facets in a natural way.
Lemma B.1. Suppose T(P) is a triangulation of the d-polytope P, and F is
a facet of P. Then
T(F) := {S âˆ©F : S âˆˆT(P), dim (S âˆ©F) = d âˆ’1}
is a triangulation of F.
Proof. To avoid unnecessary notation, we write S T(F) for S
âˆ†âˆˆT (F) âˆ†. We
have to show:
(i) F = S T(F) .
(ii) For any âˆ†1, âˆ†2 âˆˆT(F), âˆ†1 âˆ©âˆ†2 is a face common to both âˆ†1 and âˆ†2.
(i) First, S T(F) âŠ†F by deï¬nition of T(F). Now we will show that F \
S T(F) = âˆ…, by means of contradiction. Let x âˆˆF \ S T(F). If there is a
neighborhood N of x in F that contains no points of S T(F), then N consists

206
Appendix B: Triangulations of Polytopes
only of points contained in some simplices from T(P) that meet F in a set of
dimension less than d âˆ’1, which is impossible since dim N = d âˆ’1 and there
are only ï¬nitely many simplices in T(P). Hence any neighborhood of x in F
contains points in some âˆ†âˆˆT(F). However, S T(F) is closed, and so such
an x cannot exist. Hence F \ S T(F) = âˆ….
(ii) Given âˆ†1, âˆ†2 âˆˆT(F), there are S1, S2 âˆˆT(P) such that
âˆ†1 = S1 âˆ©F
and
âˆ†2 = S2 âˆ©F
and the intersections of both S1 and S2 with F are (d âˆ’1)-dimensional. Now
âˆ†1 âˆ©âˆ†2 = S1 âˆ©S2 âˆ©F, and since S1, S2 âˆˆT(P), S1 âˆ©S2 is a face of both S1
and S2. That is, there are hyperplanes H1 and H2 in Rd such that
S1 âˆ©S2 = S1 âˆ©H1
and
S1 âˆ©S2 = S2 âˆ©H2 .
The (d âˆ’1)-hyperplanes H1, H2 in Rd induce the (d âˆ’2)-hyperplanes
h1 := H1 âˆ©span F
and
h2 := H2 âˆ©span F
in span F. We claim that h1 âˆ©âˆ†1 = âˆ†1 âˆ©âˆ†2 = h2 âˆ©âˆ†2, that is, âˆ†1 âˆ©âˆ†2 is a
face of both âˆ†1 and âˆ†2. Indeed,
h1 âˆ©âˆ†1 = h1 âˆ©(S1 âˆ©F)
= (H1 âˆ©span F) âˆ©(S1 âˆ©F)
= (H1 âˆ©S1) âˆ©(F âˆ©span F)
= (S1 âˆ©S2) âˆ©F
= âˆ†1 âˆ©âˆ†2 ,
and a practically identical calculation gives h2 âˆ©âˆ†2 = âˆ†1 âˆ©âˆ†2 .
âŠ“âŠ”
Proof of Theorem 3.1. We use induction on the number of vertices of the d-
polytope P. If P has d + 1 vertices, then P is a simplex, and {P} is a trian-
gulation.
For the induction step, suppose we are given a d-polytope P with at least
d+2 vertices. Fix a vertex v of P such that Q, the convex hull of the remaining
vertices of P, is still of dimension d. By the induction hypothesis, we can
triangulate Q.
We call a facet F of Q visible from v if for any x âˆˆF, the half-open line
segment (x, v] is disjoint from Q. By the Lemma, the triangulation T(Q) of
Q induces the triangulation
T(F) = {âˆ†âˆ©F : âˆ†âˆˆT(Q), dim (âˆ†âˆ©F) = d âˆ’1}
of a facet F of Q.
Let T consist of the convex hulls of v with each (d âˆ’1)-simplex in the tri-
angulations of the visible facets. We claim that T âˆªT(Q) forms a triangulation
of P. To prove this, we have to show:

Appendix B: Triangulations of Polytopes
207
(i) P = S (T âˆªT(Q)) .
(ii) For any âˆ†1, âˆ†2 âˆˆT âˆªT(Q), âˆ†1 âˆ©âˆ†2 is a face common to both âˆ†1
and âˆ†2.
(i) P âŠ‡S (T âˆªT(Q)) follows by the deï¬nitions of T and T(Q). To prove
P âŠ†S (T âˆªT(Q)), assume x âˆˆP is given. If x âˆˆQ then x âˆˆS T(Q). If
x âˆˆP \Q, consider the line through v and x. This line meets Q (because P is
convex), so let y âˆˆQ be the ï¬rst point in Q that we meet when traveling along
the line towards Q. This point y is on a facet of Q that is, by construction,
visible from v, and hence x âˆˆâˆ†for some âˆ†âˆˆT.
(ii) Given âˆ†1, âˆ†2 âˆˆT âˆªT(Q), there are three cases:
(a) âˆ†1, âˆ†2 âˆˆT(Q);
(b) âˆ†1, âˆ†2 âˆˆT;
(c) âˆ†1 âˆˆT, âˆ†2 âˆˆT(Q).
In each case we have to show that âˆ†1 âˆ©âˆ†2 is a face common to âˆ†1 and âˆ†2.
(a) Since T(Q) is a triangulation, âˆ†1 âˆ©âˆ†2 is a face of both âˆ†1 and âˆ†2.
(b) Given âˆ†1, âˆ†2 âˆˆT, there exist S1, S2 âˆˆT(F) such that âˆ†1 = conv {v, S1}
and âˆ†2 = conv {v, S2}. Since T(F) is a triangulation, S1âˆ©S2 is a face common
to S1 and S2. By convexity, âˆ†1 âˆ©âˆ†2 = conv {v, S1 âˆ©S2}. Exercise 2.6 shows
that S1 âˆ©S2 is a simplex, and that this simplex is the convex hull of some
of the common vertices of S1 and S2. But then âˆ†1 âˆ©âˆ†2 = conv {v, S1 âˆ©S2}
is the convex hull of some of the common vertices of âˆ†1 and âˆ†2 and hence,
again by Exercise 2.6, a face of both âˆ†1 and âˆ†2.
(c) Since âˆ†1 âˆˆT, there exists S âˆˆT(F) such that âˆ†1 = conv {v, S}. By
construction, âˆ†1 âˆ©Q = S, and S is a face of some âˆ†âˆˆT(Q). Since T(Q) is
a triangulation, âˆ†âˆ©âˆ†2 is a face common to âˆ†and âˆ†2. But then
âˆ†1 âˆ©âˆ†2 = S âˆ©âˆ†2 = (S âˆ©âˆ†) âˆ©âˆ†2 = S âˆ©(âˆ†âˆ©âˆ†2)
is an intersection of two faces of âˆ†and hence by Exercise 2.6 again a face of
âˆ†and a simplex. The vertices of âˆ†1 âˆ©âˆ†2 = S âˆ©(âˆ†âˆ©âˆ†2) form a subset of
the vertices common to S and âˆ†2. Since S is a face of âˆ†1, âˆ†1 âˆ©âˆ†2 is a face
of both âˆ†1 and âˆ†2, by Exercise 2.6.
âŠ“âŠ”

Hints for â™£Exercises
Well hereâ€™s another clue for you all.
John Lennon & Paul McCartney (â€œGlass Onion,â€ The White Album)
Chapter 1
1.1 Set up the partial fraction expansion as
z
1 âˆ’z âˆ’z2 =
A
1 âˆ’1+
âˆš
5
2
z
+
B
1 âˆ’1âˆ’
âˆš
5
2
z
and clear denominators to compute A and B; one can do so, for example, by
specializing z.
1.2 Multiply out (1 âˆ’z)
 1 + z + z2 + Â· Â· Â· + zn
. For the inï¬nite sum, note
that limkâ†’âˆzk = 0 if |z| < 1.
1.3
Start with the observation that there are âŒŠxâŒ‹+ 1 lattice points in the
interval [0, x].
1.4 (i) & (j) Write n = qm + r for some integers q, r such that 0 â‰¤r < m.
Distinguish the cases r = 0 and r > 0.
1.9 Use the fact that if m and n are relatively prime, given any a âˆˆZ there
exists b âˆˆZ (which is unique modulo n) such that mb â‰¡a (mod n). For the
second equality of sets, think about the case a = 0.
1.12 First translate the line segment to the origin and explain why this trans-
lation leaves the integer-point enumeration invariant. For the case (a, b) =
(0, 0), ï¬rst study the problem under the restriction that gcd (c, d) = 1.
1.17
Given a triangle T with vertices on the integer lattice, consider the
parallelogram P formed by two ï¬xed edges of T . Use integral translates of P

210
Hints for â™£Exercises
to tile the plane R2. Conclude from this tiling that P contains only its vertices
as lattice points if and only if the area of P is 1.
1.20
Given an integer b, the Euclidean algorithm asserts the existence
of m1, m2, . . . , md âˆˆZ such that b can be represented as b = m1a1 +
m2a2 + Â· Â· Â· + mdad. Convince yourself that we can demand that in this rep-
resentation 0 â‰¤m2, m3, . . . , md < a1. Conclude that all integers beyond
(a1 âˆ’1) (a2 + a3 + Â· Â· Â· + ad) are representable in terms of a1, a2, . . . , ad. (This
argument can be reï¬ned to yield another proof of Theorem 1.2.)
1.21 Use the setup
f(z) = A1
z + A2
z2 + Â· Â· Â· + An
zn +
B1
z âˆ’1 +
B2
(z âˆ’1)2 +
aâˆ’1
X
k=1
Ck
z âˆ’Î¾ka
+
bâˆ’1
X
j=1
Dj
z âˆ’Î¾j
b
.
To compute Ck, multiply both sides by
 z âˆ’Î¾k
a

and calculate the limit as
z â†’Î¾k
a. The coeï¬ƒcients Dj can be computed in a similar fashion.
1.22 Use Exercise 1.9 (with m = bâˆ’1) on the left-hand side of the equation.
1.24 Suppose a > b. The integer a+b certainly has a representation in terms
of a and b, namely, 1 Â· a + 1 Â· b. Think about how the coeï¬ƒcient of b would
change if we changed the coeï¬ƒcient of a.
1.29 Use the partial fraction setup (1.11), multiply both sides by
 z âˆ’Î¾k
a1

,
and take the limit as z â†’Î¾k
a1.
1.31 Convince yourself of the generating-function setup
X
nâ‰¥1
pâ—¦
A(n) zn =

za1
1 âˆ’za1
 
za2
1 âˆ’za2

Â· Â· Â·

zad
1 âˆ’zad

.
Now use the machinery of Section 1.5.
Chapter 2
2.1 Use Exercise 1.3 for the closed interval. For open intervals, you can use
Exercise 1.4(j) or the âŒˆ. . . âŒ‰notation of Exercise 1.4(e). To show the quasi-
polynomial character, rewrite the greatest-integer function in terms of the
fractional-part function.
2.2 Write R as a direct product of two intervals and use Exercise 1.3.
2.6 Start by showing that the convex hull of a d-element subset W of V is
a face of âˆ†. This allows you to prove the ï¬rst statement by induction (using
Exercise 2.5). For the converse statement, given a supporting hyperplane H
that deï¬nes the face F of âˆ†, let W âŠ†V consist of those vertices of âˆ†that
are in H. Now prove that any point

Hints for â™£Exercises
211
x = Î»1v1 + Î»2v2 + Â· Â· Â· + Î»d+1vd+1
in F has to satisfy Î»k = 0 for all vk /âˆˆW.
2.7 First show that the linear inequalities and equations describing a rational
polytope can be chosen with rational coeï¬ƒcients, and then clear denominators.
2.9
Write
1
(1âˆ’z)d+1 =
P
k1â‰¥0 zk1
 P
k2â‰¥0 zk2

Â· Â· Â·
P
kd+1â‰¥0 zkd+1

and
come up with a combinatorial enumeration scheme to compute the coeï¬ƒcients
of this power series.
2.10 Write
 t+k
d

= (t+k)(t+kâˆ’1)Â·Â·Â·(t+kâˆ’d+1)
d!
and switch t to âˆ’t.
2.14
Think about the poles of the function
z
ezâˆ’1 and use a theorem from
complex analysis.
2.15 Compute the generating function of Bd(1 âˆ’x) and rewrite it as zeâˆ’xz
1âˆ’eâˆ’z .
2.16 Show that
z
ezâˆ’1 + 1
2z is an even function of Z.
2.23 Follow the steps of the proof of Theorem 2.4.
2.24 Extend T to a rectangle whose diagonal is the hypotenuse of T , and
consider the lattice points on this diagonal separately.
2.25
For the area use elementary calculus. For the number of boundary
points on tP, extend Exercise 1.12 to a set of line segments whose union
forms a simple closed curve.
2.31 Rewrite the inequality as
  ta
d

âˆ’1

e +
  tb
d

âˆ’1

f â‰¤tr and compare
this with the deï¬nition of T .
2.32 To compute C3, multiply both sides of (2.20) by (z âˆ’3)2 and compute
the limit as z â†’1. The coeï¬ƒcients Aj and Bl can be computed in a similar
fashion. To compute C2, ï¬rst move
C3
(zâˆ’1)3 in (2.20) to the left-hand side,
then multiply by (z âˆ’1)2 and take the limit as z â†’1. A similar, even more
elaborate, computation gives C1. (Alternatively, compute the Laurent series
of the function in (2.20) at z = 1 with a computer algebra system such as
Maple or Mathematica.)
2.34 Follow the proof of Theorem 2.10. Use Exercise 2.33 to compute the ad-
ditional coeï¬ƒcients in the partial fraction expansion of the generating function
corresponding to this lattice-point count.
2.36 Start with computing the constant term of
1
(1 âˆ’z1z2) (1 âˆ’z2
1z2) (1 âˆ’z1) (1 âˆ’z2) z3t
1 z2t
2
with respect to z2 by treating z1 as a constant and setting up a partial fraction
expansion of this function with respect to z2.

212
Hints for â™£Exercises
Chapter 3
3.2 Write the simplicial cones as cones over simplices and use Exercise 2.6.
3.4 Write down a typical term of the product
ÏƒS (z1, z2, . . . , zm) ÏƒT (zm+1, zm+2, . . . , zm+n) .
3.5 Multiply out zmÏƒK(z).
3.6 Write a typical term in ÏƒS

1
z1 , 1
z2 , . . . , 1
zd

= ÏƒS
 zâˆ’1
1 , zâˆ’1
2 , . . . , zâˆ’1
d

.
3.8 Given the polynomial f, split up the generating function on the left-hand
side according to the terms of f and use (2.2). Conversely, if the polynomial
g is given, use (2.6).
3.13 Show that H âˆ©Zd is a Z-module. Therefore it has a basis; extend this
basis to a basis of Zd.
3.14
Start by proving the result for a single hyperplane, for example, by
referring to Exercise 3.13.
3.19 Given f, split up the generating function on the left-hand side according
to the constituents of f; then use Exercise 3.8. Conversely, given g and h,
multiply both by a polynomial to get the denominator on the right-hand side
into the form (1 âˆ’zp)d+1; then use (2.6).
3.20 Start with the setup on page 75, and closely orient yourself along the
proof of Theorem 3.8.
3.29 Use Lemma 3.19.
Chapter 4
4.1 Use Exercise 2.1.
4.2 Use the explicit description of Î  given by (4.3).
4.3 Consider each simplicial cone Kj separately, and look at the arrangement
of its bounding hyperplanes. For each hyperplane, use Exercise 3.13.
4.5 For (a), convince yourself that Q(âˆ’t) is also a quasipolynomial. For (b),
use (1.3). For (c), diï¬€erentiate (1.3). For (d), think about one constituent of
the quasipolynomial at a time.
4.6 In the generating function for LP(tâˆ’k), make a change in the summation
variable; then use Theorem 4.4.
4.11 Use the fact that A has only integral entries. For the second part, write
down the explicit hyperplane descriptions of (t + 1)Pâ—¦and tP.

Hints for â™£Exercises
213
4.12 Assume that there exist t âˆˆZ and a facet hyperplane H of P such that
there is a lattice point between tH and (t + 1)H. Translate this lattice point
to a lattice point that violates (4.12).
Chapter 5
5.4 Consider an interval [F, P] in the face lattice of P: [F, P] contains all
faces G such that F âŠ†G âŠ†P. Prove that if P is simple, any such interval is
isomorphic to a Boolean lattice.
5.5 Use Exercise 2.6 to show that the face lattice of a simplex is isomorphic
to a Boolean lattice.
Chapter 6
6.1 Think permutation matrices.
6.3 Show that the rank of (6.5) is 2n âˆ’1.
6.5 Start by showing that all permutation matrices are indeed vertices. Then
use Exercise 6.4 to show that there are no other vertices.
6.6 Establish a bijection between semimagic squares with line sum t âˆ’n and
semimagic squares with positive entries and line sum t.
6.7 Think about the smallest possible line sum if the entries of the square
are positive integers.
6.8 Follow the computation on page 112 that led to the formula for H2.
6.9 Multiply both sides of (6.7) by

w âˆ’1
zk

and take the limit as w â†’
1
zk .
6.10 Orient yourself along the computation in (6.10).
6.16 Compute the matrix equivalent to (6.5) for the polytope describing all
magic squares of a given size. Show that this matrix has rank 2n + 1.
6.18 Orient yourself along the computation on page 112.
Chapter 7
7.1 Show that both polynomials have the same roots and the same constant
term.
7.2 Use Exercise 7.1.
7.5 Diï¬€erentiate (1.3).

214
Hints for â™£Exercises
7.6 Use (1.3).
7.7 Write an arbitrary function on Z with period b in terms of Î´m(x), 1 â‰¤
m â‰¤b.
7.8 Use the deï¬nition (7.6) of the inner product and the properties zz = |z|2
and (zw) = z Â· w for complex numbers z and w.
7.14 Use the deï¬nition (7.4) and simplify the fractional-part function in the
sum on the right-hand side.
7.22 Use the deï¬nition of F.
Chapter 8
8.5 Use Exercise 1.9.
8.7
Use the methods outlined in the hints for Exercises 1.21 and 2.32 to
compute the partial fraction coeï¬ƒcients for z = 1 in (8.3).
8.9 Multiply out all the terms on the left-hand side and make use of Exercises
1.9 and 7.14.
8.11
Use the methods outlined in the hints for Exercises 1.21 and 2.32 to
compute a partial fraction expansion of (8.7).
Chapter 9
9.1 Show that (span F)âŠ¥âˆ©KF is a cone. Then prove that if H is a deï¬ning
hyperplane for F, then H âˆ©(span F)âŠ¥is a hyperplane in the vector space
(span F)âŠ¥. Finally, show that this hyperplane H âˆ©(span F)âŠ¥deï¬nes the apex
of (span F)âŠ¥âˆ©KF, and that this apex is a point.
9.2 Consider the hyperplanes H1, H2, . . . , Hd+1 that bound âˆ†. For each hy-
perplane Hk, denote by H+
k the closed half-space bounded by Hk that con-
tains âˆ†, and by Hâˆ’
k the open half-space bounded by Hk that does not con-
tain âˆ†. Show that every tangent cone of âˆ†is the intersection of some of the
H+
k â€™s, and conversely, that every intersection of some of the H+
k â€™s, except
for âˆ†= Sd+1
k=1 H+
k , is a tangent cone of âˆ†. Since H+
k âˆªHâˆ’
k = Rd as a dis-
joint union, for each k, the point x is either in H+
k or Hâˆ’
k . Prove that the
intersection of those H+
k that contain x is the sought-after tangent cone.
9.4 As in Exercise 5.5, show that the face lattice of a simplex is a Boolean
lattice. Note that any sublattice of a Boolean lattice is again Boolean.
9.6 One approach to this problem is ï¬rst to dilate P and the corresponding
hyperplanes in H by a small factor. To avoid subtleties, ï¬rst translate P by

Hints for â™£Exercises
215
an integer vector, if necessary, to ensure that none of the hyperplanes in H
contains the origin. Use Exercise 3.13.
9.7
Adjust the steps in Section 9.3 to open polytopes. Start by proving a
Brianchonâ€“Gram identity for open simplices, by analogy with Theorem 9.5.
This implies a Brion-type identity for open simplices, as in Corollary 9.6.
Finally, adjust the proof of Theorem 9.7 to open polytopes.
Chapter 10
10.1 Use (10.3), Exercise 2.18, and (2.11).
10.3 Use the deï¬nition of unimodularity to show that the only integer point
in the fundamental parallelepiped of K is v.
10.4 Orient yourself along the proof of Theorem 10.4; instead of a sum over
vertex cones, just consider one simple cone K.
Chapter 11
11.3 Multiply out zmÎ±K(z).
11.4
Orient yourself along the proof of Theorem 4.2. Note that for solid
angles, we do not require the condition that the boundary of K contains no
lattice point.
11.5 As a warm-up exercise, show that
X
FâŠ†âˆ†
dim F>0
X
v a vertex of F
ÏƒKv(F)â—¦(z) =
X
v a vertex of âˆ†
X
FâŠ†Kv
dim F>0
ÏƒFâ—¦(z) .
11.6 Start with the setup of our second proof of Ehrhartâ€™s theorem in Sec-
tion 9.4; that is, it suï¬ƒces to prove that if p is the denominator of P, then
AP(âˆ’r âˆ’pt) = (âˆ’1)dim PAP(r + pt) for any integers r and t with 0 â‰¤r < p
and t > 0. (Think of r as ï¬xed and t as variable.) Now orient yourself along
the proof on page 184.
Chapter 12
12.1
Bound the integral from above, using the length of Cr and an upper
bound for the absolute value of the integrand.
12.2 The nontrivial roots of unity are simple poles of f, for which the residue
computation boils down to a simple limit.

216
Hints for â™£Exercises
12.4 Start by combining the terms
1
zâˆ’(m+ni) and
1
m+ni into one fraction.
12.5 Diï¬€erentiate (12.1) term by term.
12.6 Compute â„˜â€² explicitly.
12.7 Use a famous theorem from complex analysis.
12.8 Compute â„˜(âˆ’z) and use the fact that (âˆ’(m + in))2 = (m + in)2.
12.9
Repeat the proof of Lemma 12.3, but now starting with the proof of
â„˜â€² (z + i) = â„˜â€²(z).
12.10 Use a famous theorem from complex analysis.
12.11 Use the deï¬nition of the WeierstraÃŸ â„˜function.

References
1. Maya Ahmed, JesÂ´us A. De Loera, and Raymond Hemmecke.
Polyhedral
cones of magic cubes and squares.
In Discrete and Computational Geome-
try, volume 25 of Algorithms Combin., pages 25â€“41. Springer, Berlin, 2003.
arXiv:math.CO/0201108.
2. Maya Mohsin Ahmed. How many squares are there, Mr. Franklin?: construct-
ing and enumerating Franklin squares. Amer. Math. Monthly, 111(5):394â€“410,
2004.
3. Harsh Anand, Vishwa Chander Dumir, and Hansraj Gupta. A combinatorial
distribution problem. Duke Math. J., 33:757â€“769, 1966.
4. W. S. Andrews. Magic Squares and Cubes. Dover Publications Inc., New York,
1960.
5. Tom M. Apostol. Generalized Dedekind sums and transformation formulae of
certain Lambert series. Duke Math. J., 17:147â€“157, 1950.
6. Tom M. Apostol and Thiennu H. Vu. Identities for sums of Dedekind type. J.
Number Theory, 14(3):391â€“396, 1982.
7. Vladimir I. Arnold. Arnoldâ€™s problems. Springer-Verlag, Berlin, 2004. Trans-
lated and revised edition of the 2000 Russian original, With a preface by V.
Philippov, A. Yakivchik and M. Peters.
8. Christos A. Athanasiadis. Ehrhart polynomials, simplicial polytopes, magic
squares and a conjecture of Stanley.
J. Reine Angew. Math., 583:163â€“174,
2005.
9. Welleda Baldoni-Silva and Mich`ele Vergne. Residue formulae for volumes and
Ehrhart polynomials of convex polytopes. Preprint (arXiv:math.CO/0103097),
2001.
10. Philippe Barkan. Sur les sommes de Dedekind et les fractions continues ï¬nies.
C. R. Acad. Sci. Paris SÂ´er. A-B, 284(16):A923â€“A926, 1977.
11. Alexander Barvinok. Exponential integrals and sums over convex polyhedra.
Funktsional. Anal. i Prilozhen., 26(2):64â€“66, 1992.
12. Alexander Barvinok. A Course in Convexity, volume 54 of Graduate Studies
in Mathematics. American Mathematical Society, Providence, RI, 2002.
13. Alexander Barvinok and James E. Pommersheim. An algorithmic theory of
lattice points in polyhedra. In New Perspectives in Algebraic Combinatorics
(Berkeley, CA, 1996â€“97), volume 38 of Math. Sci. Res. Inst. Publ., pages 91â€“
147. Cambridge Univ. Press, Cambridge, 1999.

218
References
14. Alexander Barvinok and Kevin Woods. Short rational generating functions for
lattice point problems. J. Amer. Math. Soc., 16(4):957â€“979 (electronic), 2003.
arXiv:math.CO/0211146.
15. Alexander I. Barvinok.
A polynomial time algorithm for counting integral
points in polyhedra when the dimension is ï¬xed. Math. Oper. Res., 19(4):769â€“
779, 1994.
16. Victor V. Batyrev.
Dual polyhedra and mirror symmetry for Calabi-Yau
hypersurfaces in toric varieties.
J. Algebraic Geom., 3(3):493â€“535, 1994.
arXiv:alg-geom/9310003.
17. Victor V. Batyrev. Lattice polytopes with a given hâˆ—-polynomial. Preprint
(arXiv:math.CO/0602593), 2006.
18. Victor V. Batyrev and Dimitrios I. Dais. Strong McKay correspondence, string-
theoretic Hodge numbers and mirror symmetry. Topology, 35(4):901â€“929, 1996.
19. Matthias Beck.
Counting lattice points by means of the residue theorem.
Ramanujan J., 4(3):299â€“310, 2000. arXiv:math.CO/0306035.
20. Matthias Beck. Multidimensional Ehrhart reciprocity. J. Combin. Theory Ser.
A, 97(1):187â€“194, 2002. arXiv:math.CO/0111331.
21. Matthias Beck. Dedekind cotangent sums. Acta Arith., 109(2):109â€“130, 2003.
arXiv:math.NT/0112077.
22. Matthias Beck, Beifang Chen, Lenny Fukshansky, Christian Haase, Allen Knut-
son, Bruce Reznick, Sinai Robins, and Achill SchÂ¨urmann. Problems from the
Cottonwood Room. In Integer Points in Polyhedraâ€”Geometry, Number The-
ory, Algebra, Optimization, volume 374 of Contemp. Math., pages 179â€“191.
Amer. Math. Soc., Providence, RI, 2005.
23. Matthias Beck, Moshe Cohen, Jessica Cuomo, and Paul Gribelyuk.
The
number of â€œmagicâ€ squares, cubes, and hypercubes. Amer. Math. Monthly,
110(8):707â€“717, 2003. arXiv:math.CO/0201013.
24. Matthias Beck, JesÂ´us A. De Loera, Mike Develin, Julian Pfeiï¬‚e, and Richard P.
Stanley.
Coeï¬ƒcients and roots of Ehrhart polynomials.
In Integer Points
in Polyhedraâ€”Geometry, Number Theory, Algebra, Optimization, volume 374
of Contemp. Math., pages 15â€“36. Amer. Math. Soc., Providence, RI, 2005.
arXiv:math.CO/0402148.
25. Matthias Beck, Ricardo Diaz, and Sinai Robins. The Frobenius problem, ra-
tional polytopes, and Fourier-Dedekind sums. J. Number Theory, 96(1):1â€“21,
2002. arXiv:math.NT/0204035.
26. Matthias Beck and Richard Ehrenborg. Ehrhartâ€“Macdonald reciprocity ex-
tended. Preprint (arXiv:math.CO/0504230), 2006.
27. Matthias Beck, Christian Haase, and Frank Sottile.
Theorems of Brion,
Lawrence, and Varchenko on rational generating functions for cones. Preprint
(arXiv:math.CO/0506466), 2006.
28. Matthias
Beck
and
Dennis
Pixton.
The
Ehrhart
polynomial
of
the Birkhoï¬€polytope.
Discrete Comput. Geom., 30(4):623â€“637, 2003.
arXiv:math.CO/0202267.
29. Matthias Beck and Sinai Robins. Explicit and eï¬ƒcient formulas for the lattice
point count in rational polygons using Dedekindâ€“Rademacher sums. Discrete
Comput. Geom., 27(4):443â€“459, 2002. arXiv:math.CO/0111329.
30. Matthias Beck and Frank Sottile. Irrational proofs for two theorems of Stanley.
Preprint (arXiv:math.CO/0506315), to appear in European J. Combin., 2006.

References
219
31. Matthias Beck and Thomas Zaslavsky. An enumerative geometry for magic
and magilatin labellings.
Preprint (arXiv:math.CO/0506315), to appear in
Ann. Combin., 2006.
32. Dale Beihoï¬€er, Jemimah Hendry, Albert Nijenhuis, and Stan Wagon. Faster
algorithms for Frobenius numbers. Electron. J. Combin., 12(1):Research Paper
27, 38 pp. (electronic), 2005.
33. Nicole Berline and Mich`ele Vergne. Local Eulerâ€“Maclaurin formula for poly-
topes. Preprint (arXiv:math.CO/0507256), 2006.
34. Bruce C. Berndt. Reciprocity theorems for Dedekind sums and generalizations.
Advances in Math., 23(3):285â€“316, 1977.
35. Bruce C. Berndt and Ulrich Dieter. Sums involving the greatest integer func-
tion and Riemann-Stieltjes integration. J. Reine Angew. Math., 337:208â€“220,
1982.
36. Bruce C. Berndt and Boon Pin Yeap.
Explicit evaluations and reciprocity
theorems for ï¬nite trigonometric sums. Adv. in Appl. Math., 29(3):358â€“385,
2002.
37. Christian Bey, Martin Henk, and JÂ¨org M. Wills. Notes on the roots of Ehrhart
polynomials. Preprint (arXiv:math.MG/0606089), 2006.
38. Louis J. Billera and A. Sarangarajan. The combinatorics of permutation poly-
topes. In Formal Power Series and Algebraic Combinatorics (New Brunswick,
NJ, 1994), pages 1â€“23. Amer. Math. Soc., Providence, RI, 1996.
39. Garrett Birkhoï¬€. Tres observaciones sobre el Â´algebra lineal. Revista Faculdad
de Ciencias Exactas, Puras y Aplicadas Universidad Nacional de TucumÂ´an,
Serie A (MatemÂ´aticas y FÂ´Ä±sica TeÂ´oretica), 5:147â€“151, 1946.
40. G. R. Blakley. Combinatorial remarks on partitions of a multipartite number.
Duke Math. J., 31:335â€“340, 1964.
41. Alfred Brauer. On a problem of partitions. Amer. J. Math., 64:299â€“312, 1942.
42. Benjamin Braun.
Norm bounds for Ehrhart polynomial roots.
Preprint
(arXiv:math.CO/0602464), to appear in Discrete Comput. Geom., 2006.
43. Henrik Bresinsky. Symmetric semigroups of integers generated by 4 elements.
Manuscripta Math., 17(3):205â€“219, 1975.
44. Charles J. Brianchon. ThÂ´eor`eme nouveau sur les poly`edres. J. Ecole (Royale)
Polytechnique, 15:317â€“319, 1837.
45. Michel Brion.
Points entiers dans les poly`edres convexes.
Ann. Sci. Â´Ecole
Norm. Sup. (4), 21(4):653â€“663, 1988.
46. Michel Brion and Mich`ele Vergne. Residue formulae, vector partition functions
and lattice points in rational polytopes. J. Amer. Math. Soc., 10(4):797â€“833,
1997.
47. Arne BrÃ¸ndsted. An Introduction to Convex Polytopes, volume 90 of Graduate
Texts in Mathematics. Springer-Verlag, New York, 1983.
48. Richard A. Brualdi and Peter M. Gibson. Convex polyhedra of doubly sto-
chastic matrices. I. Applications of the permanent function. J. Combinatorial
Theory Ser. A, 22(2):194â€“230, 1977.
49. Richard A. Brualdi and Peter M. Gibson. Convex polyhedra of doubly stochas-
tic matrices. III. Aï¬ƒne and combinatorial properties of Un. J. Combinatorial
Theory Ser. A, 22(3):338â€“351, 1977.
50. Heinz Bruggesser and Peter Mani.
Shellable decompositions of cells and
spheres. Math. Scand., 29:197â€“205 (1972), 1971.
51. Daniel Bump, Kwok-Kwong Choi, PÂ¨ar Kurlberg, and Jeï¬€rey Vaaler. A local
Riemann hypothesis. I. Math. Z., 233(1):1â€“19, 2000.

220
References
52. Kristin A. Camenga. Vector spaces spanned by the angle sums of polytopes.
Preprint (arXiv:math.MG/0508629), 2005.
53. Schuyler Cammann. Old Chinese magic squares. Sinologica, 7:14â€“53, 1962.
54. Schuyler Cammann. Islamic and Indian magic squares, Parts I and II. History
of Religions, 8:181â€“209; 271â€“299, 1969.
55. Sylvain E. Cappell and Julius L. Shaneson. Euler-Maclaurin expansions for
lattices above dimension one. C. R. Acad. Sci. Paris SÂ´er. I Math., 321(7):885â€“
890, 1995.
56. Leonard Carlitz. Some theorems on generalized Dedekind sums. Paciï¬c J.
Math., 3:513â€“522, 1953.
57. John W. S. Cassels. An Introduction to the Geometry of Numbers. Classics
in Mathematics. Springer-Verlag, Berlin, 1997. Corrected reprint of the 1971
edition.
58. Clara S. Chan, David P. Robbins, and David S. Yuen. On the volume of a cer-
tain polytope. Experiment. Math., 9(1):91â€“99, 2000. arXiv:math.CO/9810154.
59. Beifang Chen. Weight functions, double reciprocity laws, and volume formulas
for lattice polyhedra.
Proc. Natl. Acad. Sci. USA, 95(16):9093â€“9098 (elec-
tronic), 1998.
60. Beifang Chen.
Lattice points, Dedekind sums, and Ehrhart polynomials of
lattice polyhedra. Discrete Comput. Geom., 28(2):175â€“199, 2002.
61. Beifang Chen and Vladimir Turaev. Counting lattice points of rational poly-
hedra. Adv. Math., 155(1):84â€“97, 2000.
62. Louis Comtet. Advanced Combinatorics. D. Reidel Publishing Co., Dordrecht,
enlarged edition, 1974.
63. Wolfgang Dahmen and Charles A. Micchelli. The number of solutions to linear
Diophantine equations and multivariate splines.
Trans. Amer. Math. Soc.,
308(2):509â€“532, 1988.
64. Vladimir I. Danilov.
The geometry of toric varieties.
Uspekhi Mat. Nauk,
33(2(200)):85â€“134, 247, 1978.
65. J. Leslie Davison. On the linear Diophantine problem of Frobenius. J. Number
Theory, 48(3):353â€“363, 1994.
66. JesÂ´us A. De Loera, David Haws, Raymond Hemmecke, Peter Huggins, and
Ruriko Yoshida. A userâ€™s guide for LattE v1.1, software package LattE. 2004.
Electronically available at http://www.math.ucdavis.edu/âˆ¼latte/.
67. JesÂ´us A. De Loera, Raymond Hemmecke, Jeremiah Tauzer, and Ruriko
Yoshida.
Eï¬€ective lattice point counting in rational convex polytopes.
J.
Symbolic Comput., 38(4):1273â€“1302, 2004.
68. JesÂ´us A. De Loera and Shmuel Onn.
The complexity of three-way
statistical tables.
SIAM J. Comput., 33(4):819â€“836 (electronic), 2004.
arXiv:math.CO/0207200.
69. JesÂ´us A. De Loera, JÂ¨org Rambau, and Francisco Santos.
Triangulations of
Point Sets: Applications, Structures, Algorithms. Springer (to appear), 2006.
70. Richard Dedekind.
ErlÂ¨auterungen zu den Fragmenten xxviii.
In Collected
Works of Bernhard Riemann, pages 466â€“478. Dover Publ., New York, 1953.
71. Max Dehn. Die Eulersche Formel im Zusammenhang mit dem Inhalt in der
nicht-euklidischen Geometrie. Math. Ann., 61:279â€“298, 1905.
72. JÂ´ozsef DÂ´enes and Anthony D. Keedwell. Latin Squares and Their Applications.
Academic Press, New York, 1974.
73. Graham Denham.
Short generating functions for some semigroup algebras.
Electron. J. Combin., 10:Research Paper 36, 7 pp. (electronic), 2003.

References
221
74. Persi Diaconis and Anil Gangolli. Rectangular arrays with ï¬xed margins. In
Discrete Probability and Algorithms (Minneapolis, MN, 1993), pages 15â€“41.
Springer, New York, 1995.
75. Ricardo Diaz and Sinai Robins. Pickâ€™s formula via the Weierstrass â„˜-function.
Amer. Math. Monthly, 102(5):431â€“437, 1995.
76. Ricardo Diaz and Sinai Robins. The Ehrhart polynomial of a lattice polytope.
Ann. of Math. (2), 145(3):503â€“518, 1997.
77. Ulrich Dieter.
Das Verhalten der Kleinschen Funktionen log Ïƒg,h(Ï‰1, Ï‰2)
gegenÂ¨uber Modultransformationen und verallgemeinerte Dedekindsche Sum-
men. J. Reine Angew. Math., 201:37â€“70, 1959.
78. Ulrich Dieter. Cotangent sums, a further generalization of Dedekind sums. J.
Number Theory, 18(3):289â€“305, 1984.
79. Eug`ene Ehrhart. Sur les poly`edres rationnels homothÂ´etiques `a n dimensions.
C. R. Acad. Sci. Paris, 254:616â€“618, 1962.
80. Eug`ene Ehrhart. Sur les carrÂ´es magiques. C. R. Acad. Sci. Paris SÂ´er. A-B,
277:A651â€“A654, 1973.
81. Eug`ene Ehrhart. PolynË†omes arithmÂ´etiques et mÂ´ethode des poly`edres en com-
binatoire. BirkhÂ¨auser Verlag, Basel, 1977. International Series of Numerical
Mathematics, Vol. 35.
82. GÂ¨unter Ewald. Combinatorial Convexity and Algebraic Geometry, volume 168
of Graduate Texts in Mathematics. Springer-Verlag, New York, 1996.
83. Leonid G. Fel and Boris Y. Rubinstein.
Restricted partition function as
Bernoulli and Euler polynomials of higher order. Ramanujan J., 11(3):331â€“
348, 2006. arXiv:math.NT/0304356.
84. William Fulton. Introduction to Toric Varieties, volume 131 of Annals of Math-
ematics Studies. Princeton University Press, Princeton, NJ, 1993.
85. Stavros Garoufalidis and James E. Pommersheim. Values of zeta functions at
negative integers, Dedekind sums and toric geometry. J. Amer. Math. Soc.,
14(1):1â€“23 (electronic), 2001.
86. Ewgenij Gawrilow and Michael Joswig. polymake: a framework for analyzing
convex polytopes. In Polytopesâ€”combinatorics and computation (Oberwolfach,
1997), volume 29 of DMV Sem., pages 43â€“73. BirkhÂ¨auser, Basel, 2000. Software
polymake available at www.math.tu-berlin.de/polymake/.
87. Ira M. Gessel. Generating functions and generalized Dedekind sums. Electron.
J. Combin., 4(2):Research Paper 11, approx. 17 pp. (electronic), 1997.
88. Jorgen P. Gram. Om rumvinklerne i et polyeder. Tidsskrift for Math. (Copen-
hagen), 4(3):161â€“163, 1874.
89. Harold Greenberg.
An algorithm for a linear Diophantine equation and a
problem of Frobenius. Numer. Math., 34(4):349â€“352, 1980.
90. Branko GrÂ¨unbaum. Convex Polytopes, volume 221 of Graduate Texts in Math-
ematics. Springer-Verlag, New York, second edition, 2003. Prepared and with
a preface by Volker Kaibel, Victor Klee, and GÂ¨unter M. Ziegler.
91. Victor Guillemin. Riemann-Roch for toric orbifolds. J. Diï¬€erential Geom.,
45(1):53â€“73, 1997.
92. Ulrich Halbritter.
Some new reciprocity formulas for generalized Dedekind
sums. Results Math., 8(1):21â€“46, 1985.
93. Richard R. Hall, J. C. Wilson, and Don Zagier. Reciprocity formulae for general
Dedekindâ€“Rademacher sums. Acta Arith., 73(4):389â€“396, 1995.

222
References
94. Martin Henk, Achill SchÂ¨urmann, and JÂ¨org M. Wills. Ehrhart polynomial and
successive minima. Preprint (arXiv:math.MG/0507528), to appear in Mathe-
matika, 2005.
95. JÂ¨urgen Herzog. Generators and relations of abelian semigroups and semigroup
rings. Manuscripta Math., 3:175â€“193, 1970.
96. Takayuki Hibi. Algebraic Combinatorics on Convex Polytopes. Carslaw, 1992.
97. Takayuki Hibi. Dual polytopes of rational convex polytopes. Combinatorica,
12(2):237â€“240, 1992.
98. Takayuki Hibi.
A lower bound theorem for Ehrhart polynomials of convex
polytopes. Adv. Math., 105(2):162â€“165, 1994.
99. Dean Hickerson. Continued fractions and density results for Dedekind sums.
J. Reine Angew. Math., 290:113â€“116, 1977.
100. Friedrich Hirzebruch. Neue topologische Methoden in der algebraischen Geome-
trie.
Ergebnisse der Mathematik und ihrer Grenzgebiete (N.F.), Heft 9.
Springer-Verlag, Berlin, 1956.
101. Friedrich Hirzebruch and Don Zagier. The Atiyah-Singer Theorem and Ele-
mentary Number Theory. Publish or Perish Inc., Boston, Mass., 1974.
102. Jeï¬€rey Hood and David Perkinson. Some facets of the polytope of even per-
mutation matrices. Linear Algebra Appl., 381:237â€“244, 2004.
103. Masa-Nori Ishida. Polyhedral Laurent series and Brionâ€™s equalities. Internat.
J. Math., 1(3):251â€“265, 1990.
104. Maruf Israilovich Israilov. Determination of the number of solutions of lin-
ear Diophantine equations and their applications in the theory of invariant
cubature formulas. Sibirsk. Mat. Zh., 22(2):121â€“136, 237, 1981.
105. Ravi Kannan. Lattice translates of a polytope and the Frobenius problem.
Combinatorica, 12(2):161â€“177, 1992.
106. Jean-Michel Kantor and Askold G. KhovanskiË˜Ä±. Une application du thÂ´eor`eme
de Riemann-Roch combinatoire au polynË†ome dâ€™Ehrhart des polytopes entiers
de Rd. C. R. Acad. Sci. Paris SÂ´er. I Math., 317(5):501â€“507, 1993.
107. Yael Karshon, Shlomo Sternberg, and Jonathan Weitsman.
The Euler-
Maclaurin formula for simple integral polytopes. Proc. Natl. Acad. Sci. USA,
100(2):426â€“433 (electronic), 2003.
108. Askold G. KhovanskiË˜Ä± and Aleksandr V. Pukhlikov. The Riemann-Roch theo-
rem for integrals and sums of quasipolynomials on virtual polytopes. Algebra
i Analiz, 4(4):188â€“216, 1992.
109. Peter Kirschenhofer, Attila PethËo, and Robert F. Tichy. On analytical and
Diophantine properties of a family of counting polynomials. Acta Sci. Math.
(Szeged), 65(1-2):47â€“59, 1999.
110. Daniel A. Klain and Gian-Carlo Rota. Introduction to Geometric Probability.
Lezioni Lincee. Cambridge University Press, Cambridge, 1997.
111. Victor Klee. A combinatorial analogue of PoincarÂ´eâ€™s duality theorem. Canad.
J. Math., 16:517â€“531, 1964.
112. Donald E. Knuth. Permutations, matrices, and generalized Young tableaux.
Paciï¬c J. Math., 34:709â€“727, 1970.
113. Donald E. Knuth. Notes on generalized Dedekind sums. Acta Arith., 33(4):297â€“
325, 1977.
114. Donald E. Knuth. The Art of Computer Programming. Vol. 2. Addison-Wesley
Publishing Co., Reading, Mass., second edition, 1981.

References
223
115. Matthias KÂ¨oppe. A primal Barvinok algorithm based on irrational decompo-
sitions. Preprint (arXiv:math.CO/0603308), 2006. Software LattE macchiato
available at http://www.math.uni-magdeburg.de/âˆ¼mkoeppe/latte/.
116. Thomas W. KÂ¨orner.
Fourier Analysis.
Cambridge University Press, Cam-
bridge, 1988.
117. Maximilian Kreuzer and Harald Skarke.
Classiï¬cation of reï¬‚exive poly-
hedra in three dimensions.
Adv. Theor. Math. Phys., 2(4):853â€“871, 1998.
arXiv:hep-th/9805190.
118. Maximilian Kreuzer and Harald Skarke. Complete classiï¬cation of reï¬‚exive
polyhedra in four dimensions. Adv. Theor. Math. Phys., 4(6):1209â€“1230, 2000.
arXiv:hep-th/0002240.
119. Jean B. Lasserre and Eduardo S. Zeron.
On counting integral points in a
convex rational polytope. Math. Oper. Res., 28(4):853â€“870, 2003.
120. Jim Lawrence. A short proof of Eulerâ€™s relation for convex polytopes. Canad.
Math. Bull., 40(4):471â€“474, 1997.
121. Arjen K. Lenstra, Hendrik W. Lenstra, Jr., and LÂ´aszlÂ´o LovÂ´asz.
Factoring
polynomials with rational coeï¬ƒcients. Math. Ann., 261(4):515â€“534, 1982.
122. LÂ´aszlÂ´o LovÂ´asz. Combinatorial Problems and Exercises. North-Holland Pub-
lishing Co., Amsterdam, second edition, 1993.
123. Ian G. Macdonald. Polynomials associated with ï¬nite cell-complexes. J. Lon-
don Math. Soc. (2), 4:181â€“192, 1971.
124. Percy A. MacMahon. Combinatory Analysis. Chelsea Publishing Co., New
York, 1960.
125. Evgeny N. Materov. The Bott formula for toric varieties. Mosc. Math. J.,
2(1):161â€“182, 2002. arXiv:math.AG/9904110.
126. Tyrrell B. McAllister and Kevin M. Woods.
The minimum period of the
Ehrhart quasi-polynomial of a rational polytope. J. Combin. Theory Ser. A,
109(2):345â€“352, 2005. arXiv:math.CO/0310255.
127. Peter McMullen.
Valuations and Euler-type relations on certain classes of
convex polytopes. Proc. London Math. Soc. (3), 35(1):113â€“135, 1977.
128. Peter McMullen.
Lattice invariant valuations on rational polytopes.
Arch.
Math. (Basel), 31(5):509â€“516, 1978/79.
129. Curt Meyer.
Â¨Uber einige Anwendungen Dedekindscher Summen.
J. Reine
Angew. Math., 198:143â€“203, 1957.
130. Jeï¬€rey L. Meyer. Character analogues of Dedekind sums and transformations
of analytic Eisenstein series. Paciï¬c J. Math., 194(1):137â€“164, 2000.
131. Werner Meyer and Robert Sczech. Â¨Uber eine topologische und zahlentheoretis-
che Anwendung von Hirzebruchs Spitzenauï¬‚Â¨osung. Math. Ann., 240(1):69â€“96,
1979.
132. Ezra Miller and Bernd Sturmfels. Combinatorial Commutative Algebra, volume
227 of Graduate Texts in Mathematics. Springer-Verlag, New York, 2005.
133. Hermann Minkowski. Geometrie der Zahlen. Bibliotheca Mathematica Teub-
neriana, Band 40. Johnson Reprint Corp., New York, 1968.
134. Marcel Morales. Syzygies of monomial curves and a linear Diophantine problem
of Frobenius. Preprint, Max-Planck-Institut fÂ¨ur Mathematik, Bonn, 1986.
135. Marcel Morales. Noetherian symbolic blow-ups. J. Algebra, 140(1):12â€“25, 1991.
136. Louis J. Mordell. Lattice points in a tetrahedron and generalized Dedekind
sums. J. Indian Math. Soc. (N.S.), 15:41â€“46, 1951.
137. Robert Morelli. Pickâ€™s theorem and the Todd class of a toric variety. Adv.
Math., 100(2):183â€“231, 1993.

224
References
138. Gerald Myerson.
On semiregular ï¬nite continued fractions.
Arch. Math.
(Basel), 48(5):420â€“425, 1987.
139. Walter Nef. Zur EinfÂ¨uhrung der Eulerschen Charakteristik. Monatsh. Math.,
92(1):41â€“46, 1981.
140. C. D. Olds, Anneli Lax, and Giuliana P. Davidoï¬€. The Geometry of Numbers,
volume 41 of Anneli Lax New Mathematical Library. Mathematical Association
of America, Washington, DC, 2000.
141. Paul C. Pasles. The lost squares of Dr. Franklin: Ben Franklinâ€™s missing squares
and the secret of the magic circle. Amer. Math. Monthly, 108(6):489â€“511, 2001.
142. Micha A. Perles and Geoï¬€rey C. Shephard. Angle sums of convex polytopes.
Math. Scand., 21:199â€“218 (1969), 1967.
143. Georg Alexander Pick.
Geometrisches zur Zahlenlehre.
Sitzenber. Lotos
(Prague), 19:311â€“319, 1899.
144. Cliï¬€ord A. Pickover. The Zen of Magic Squares, Circles, and Stars. Princeton
University Press, Princeton, NJ, 2002.
145. Christopher Polis. Pickâ€™s theorem extended and generalized. Math. Teacher,
pages 399â€“401, 1991.
146. James E. Pommersheim. Toric varieties, lattice points and Dedekind sums.
Math. Ann., 295(1):1â€“24, 1993.
147. Bjorn Poonen and Fernando Rodriguez-Villegas.
Lattice polygons and the
number 12. Amer. Math. Monthly, 107(3):238â€“250, 2000.
148. Tiberiu Popoviciu. Asupra unei probleme de patitie a numerelor. Acad. Re-
publicii Populare Romane, Filiala Cluj, Studii si cercetari stiintiï¬ce, 4:7â€“58,
1953.
149. Hans Rademacher.
Generalization of the reciprocity formula for Dedekind
sums. Duke Math. J., 21:391â€“397, 1954.
150. Hans Rademacher. Some remarks on certain generalized Dedekind sums. Acta
Arith., 9:97â€“105, 1964.
151. Hans Rademacher and Emil Grosswald. Dedekind Sums. The Mathematical
Association of America, Washington, D.C., 1972.
152. Jorge L. RamÂ´Ä±rez-AlfonsÂ´Ä±n. Complexity of the Frobenius problem. Combina-
torica, 16(1):143â€“147, 1996.
153. Jorge L. RamÂ´Ä±rez-AlfonsÂ´Ä±n. The Diophantine Frobenius Problem. Oxford Uni-
versity Press, 2006.
154. J. E. Reeve. On the volume of lattice polyhedra. Proc. london Math. Soc. (3),
7:378â€“395, 1957.
155. Les Reid and Leslie G. Roberts. Monomial subrings in arbitrary dimension. J.
Algebra, 236(2):703â€“730, 2001.
156. JÂ¨urgen Richter-Gebert. Realization Spaces of Polytopes, volume 1643 of Lecture
Notes in Mathematics. Springer-Verlag, Berlin Heidelberg, 1996.
157. Boris Y. Rubinstein.
An explicit formula for restricted partition function
through Bernoulli polynomials. Preprint, to appear in Ramanujan Journal,
2005.
158. Ludwig SchlÂ¨aï¬‚i.
Theorie der vielfachen KontinuitÂ¨at.
In Ludwig SchlÂ¨aï¬‚i,
1814â€“1895, Gesammelte Mathematische Abhandlungen, Vol. I, pages 167â€“387.
BirkhÂ¨auser, Basel, 1950.
159. Alexander Schrijver. Combinatorial Optimization. Polyhedra and Eï¬ƒciency.
Vol. Aâ€“C, volume 24 of Algorithms and Combinatorics.
Springer-Verlag,
Berlin, 2003.

References
225
160. Paul R. Scott.
On convex lattice polygons.
Bull. Austral. Math. Soc.,
15(3):395â€“399, 1976.
161. Sinan SertÂ¨oz.
On the number of solutions of the Diophantine equation of
Frobenius. Diskret. Mat., 10(2):62â€“71, 1998.
162. Geoï¬€rey C. Shephard.
An elementary proof of Gramâ€™s theorem for convex
polytopes. Canad. J. Math., 19:1214â€“1217, 1967.
163. Carl Ludwig Siegel. Lectures on the Geometry of Numbers. Springer-Verlag,
Berlin, 1989. Notes by B. Friedman, rewritten by Komaravolu Chandrasekha-
ran with the assistance of Rudolf Suter, with a preface by Chandrasekharan.
164. R. Jamie Simpson and Robert Tijdeman.
Multi-dimensional versions of a
theorem of Fine and Wilf and a formula of Sylvester. Proc. Amer. Math. Soc.,
131(6):1661â€“1671 (electronic), 2003.
165. Neil J. A. Sloane. On-line encyclopedia of integer sequences. http://www.
research.att.com/âˆ¼njas/sequences/index.html.
166. David Solomon.
Algebraic properties of Shintaniâ€™s generating functions:
Dedekind sums and cocycles on PGL2(Q). Compositio Math., 112(3):333â€“362,
1998.
167. Duncan M. Y. Sommerville. The relation connecting the angle-sums and vol-
ume of a polytope in space of n dimensions. Proc. Roy. Soc. London, Ser. A,
115:103â€“119, 1927.
168. Richard P. Stanley.
Linear homogeneous Diophantine equations and magic
labelings of graphs. Duke Math. J., 40:607â€“632, 1973.
169. Richard P. Stanley. Combinatorial reciprocity theorems. Advances in Math.,
14:194â€“253, 1974.
170. Richard P. Stanley. Decompositions of rational convex polytopes. Ann. Dis-
crete Math., 6:333â€“342, 1980.
171. Richard P. Stanley. Combinatorics and Commutative Algebra, volume 41 of
Progress in Mathematics. BirkhÂ¨auser Boston Inc., Boston, MA, second edition,
1996.
172. Richard P. Stanley. Enumerative Combinatorics. Vol. 1, volume 49 of Cam-
bridge Studies in Advanced Mathematics. Cambridge University Press, Cam-
bridge, 1997. With a foreword by Gian-Carlo Rota, Corrected reprint of the
1986 original.
173. Bernd Sturmfels. On vector partition functions. J. Combin. Theory Ser. A,
72(2):302â€“309, 1995.
174. Bernd Sturmfels. GrÂ¨obner Bases and Convex Polytopes, volume 8 of University
Lecture Series. American Mathematical Society, Providence, RI, 1996.
175. James J. Sylvester. On the partition of numbers. Quaterly J. Math., 1:141â€“152,
1857.
176. James J. Sylvester. On subinvariants, i.e. semi-invariants to binary quanties of
an unlimited order. Amer. J. Math., 5:119â€“136, 1882.
177. James J. Sylvester. Mathematical questions with their solutions. Educational
Times, 41:171â€“178, 1884.
178. AndrÂ´as Szenes and Mich`ele Vergne.
Residue formulae for vector partitions
and Euler-MacLaurin sums.
Adv. in Appl. Math., 30(1-2):295â€“342, 2003.
arXiv:math.CO/0202253.
179. Lajos TakÂ´acs. On generalized Dedekind sums. J. Number Theory, 11(2):264â€“
272, 1979.

226
References
180. Audrey Terras. Fourier Analysis on Finite Groups and Applications, volume 43
of London Mathematical Society Student Texts. Cambridge University Press,
Cambridge, 1999.
181. John A. Todd.
The geometrical invariants of algebraic loci.
Proc. London
Math. Soc., 43:127â€“141, 1937.
182. John A. Todd. The geometrical invariants of algebraic loci (second paper).
Proc. London Math. Soc., 45:410â€“424, 1939.
183. Amitabha Tripathi. The number of solutions to ax+by = n. Fibonacci Quart.,
38(4):290â€“293, 2000.
184. Helge Tverberg. How to cut a convex polytope into simplices. Geometriae
Dedicata, 3:239â€“240, 1974.
185. Sven Verdoolaege. Software package barvinok. 2004. Electronically available
at http://freshmeat.net/projects/barvinok/.
186. John von Neumann. A certain zero-sum two-person game equivalent to the
optimal assignment problem. In Contributions to the Theory of Games, vol.
2, Annals of Mathematics Studies, no. 28, pages 5â€“12. Princeton University
Press, Princeton, N. J., 1953.
187. Herbert S. Wilf.
generatingfunctionology.
Academic Press Inc., Boston,
MA, second edition, 1994.
Electronically available at http://www.cis.
upenn.edu/âˆ¼wilf/.
188. Kevin Woods. Computing the period of an Ehrhart quasi-polynomial. Electron.
J. Combin., 12(1):Research Paper 34, 12 pp. (electronic), 2005.
189. Guoce Xin. Constructing all magic squares of order three. Preprint (arXiv:
math.CO/0409468), 2005.
190. Don Zagier. Higher dimensional Dedekind sums. Math. Ann., 202:149â€“172,
1973.
191. Claudia Zaslavsky. Africa Counts. Prindle, Weber & Schmidt, Inc., Boston,
Mass., 1973.
192. Doron Zeilberger. Proof of a conjecture of Chan, Robbins, and Yuen. Electron.
Trans. Numer. Anal., 9:147â€“148 (electronic), 1999.
193. GÂ¨unter M. Ziegler.
Lectures on polytopes.
Springer-Verlag, New York,
1995. Revised edition, 1998; â€œUpdates, corrections, and moreâ€ at www.math.
tu-berlin.de/âˆ¼ziegler.

List of Symbols
The following table contains a list of symbols that are frequently used through-
out the book. The page numbers refer to the ï¬rst appearance/deï¬nition of
each symbol.
Symbol
Meaning
Page
Ë†a(m)
Fourier coeï¬ƒcient of a(n)
126
A (d, k)
Eulerian number
28
AâŠ¥
orthogonal complement of A
159
AP(t)
solid-angle sum of P
180
Î±P(z)
solid-angle generating function
182
Bk(x)
Bernoulli polynomial
31
Bk
Bernoulli number
32
Bn
Birkhoï¬€polytope
108
BiPyr (P)
bipyramid over P
36
cone P
cone over P
58
const f
constant term of the generating function f
13
conv S
convex hull of S
25
d-cone
d-dimensional cone
58
d-polytope
d-dimensional polytope
26
dim P
dimension of P
26
Î´m(x)
delta function
129
EhrP(z)
Ehrhart series of P
28
EhrPâ—¦(z)
Ehrhart series of the interior of P
87
ea(x)
root-of-unity function e2Ï€iax/b
129
fk
face number
95
Fk(t)
lattice-point enumerator of the k-skeleton
96
F(f)
Fourier transform of f
129
g (a1, a2, . . . , ad) Frobenius number
6
Hn(t)
number of semimagic n Ã— n squares with line sum t
107
KF
tangent cone of F âŠ†P
159

228
List of Symbols
Symbol
Meaning
Page
LP(t)
lattice-point enumerator of P
27
LPâ—¦(t)
lattice-point enumerator of the interior of P
28
Mn(t)
number of magic n Ã— n squares with line sum t
107
Ï‰P(x)
solid angle of x (with respect to P)
179
pA(n)
restricted partition function
6
polyA(n)
polynomial part of pA(n)
141
P
a closed polytope
25
Pâ—¦
interior of the polytope P
28
P(h)
perturbed polytope
174
Pyr (P)
pyramid over P
34
â„˜(z)
WeierstraÃŸ â„˜-function
193
Î 
fundamental parallelepiped of a cone
62
rn(a, b)
Dedekindâ€“Rademacher sum
145
s(a, b)
Dedekind sum
128
sn (a1, a2, . . . , am; b) Fourierâ€“Dedekind sum
14
SolidP(x)
solid-angle series
188
span P
aï¬ƒne space spanned by P
26
ÏƒS(z)
integer-point transform of S
60
tP
tth dilation of P
27
Toddh
Todd operator
168
vol P
(continuous) volume of P
71
VG
vector space of all complex-valued functions
129
on G = {0, 1, 2, . . . , b âˆ’1}
Î¾a
root of unity e2Ï€i/a
8
Î¶(z)
WeierstraÃŸ Î¶-function
193
âŒŠxâŒ‹
greatest integer function
10
{x}
fraction-part function
10
((x))
sawtooth function
127
 m
n

binomial coeï¬ƒcient
27
âŸ¨f, gâŸ©
inner product of f and g
130
(f âˆ—g)(t)
convolution of f and g
133
1S(x)
characteristic function of S
160
#S
number of elements in S
6
â™£
an exercise that is used in the text
VIII

Index
aï¬ƒne space, 26
aï¬ƒne span, 100
apex, 58, 159
area, 38
arrangement of hyperplanes, 79, 159
Barvinokâ€™s algorithm, 164
basis, 129
Beatty sequence, 20
Bernoulli number, 32, 51, 167
Bernoulli polynomial, 31, 52, 177
binomial coeï¬ƒcient, 27
binomial series, 30
bipyramid over a polytope, 36
Birkhoï¬€â€“von Neumann polytope, 108,
118
Boolean lattice, 96, 214
boundary, 99
Brianchonâ€“Gram relation, 185, 189
Brionâ€™s theorem, 161
continuous form of, 170
for solid angles, 183
complex conjugation, 130
cone, 159
pointed, 58
rational, 159
simplicial, 58
unimodular, 174
coning over a polytope, 58, 64, 75
constituent, 45, 117
contingency table, 119
continuous Fourier transform, 135
continuous volume, 71, 100, 109, 182
convex cone, 159
convex hull, 25
convex polygon, 25
convex polytope, 25, 48
convolution
of ï¬nite Fourier series, 133
of quasipolynomials, 81
cotangent, 127
cross-polytope, 36, 49
cube, 26
cyclotomic polynomial, 137
Dedekind Î·-function, 150
Dedekind sum, 128, 132, 140, 147
Dedekindâ€™s reciprocity law, 143
Dedekindâ€“Rademacher sum, 145
degenerate hyperplane, 26
degree
of a polytope, 88
of a quasipolynomial, 44
Dehnâ€“Sommerville relations, 95
delta function, 129, 136
Delzant polytope, 174
denominator, 75
dihedral angle, 180
dilate, 7
dimension
of a pointed cone, 58
of a polytope, 26
discrete volume, 27, 29, 36, 73, 83, 180
distance, 130
doubly periodic function, 193
doubly stochastic matrix, 108

230
Index
dual polytope, 90
edge
of a pointed cone, 59
of a polytope, 26
Ehrhart polynomial, 64, 67, 88, 98, 147
constant term of, 70
interpolation of, 73
leading coeï¬ƒcient of, 72
second coeï¬ƒcient of, 102
Ehrhart quasipolynomial, 75
Ehrhart series, 28, 48, 68, 87, 149
Ehrhartâ€™s theorem, 64, 66, 75, 109
Ehrhartâ€“Macdonald reciprocity, 84, 96,
109, 145
Euler Ï†-function, 137
Euler characteristric, 77
Euler relation, 96
Eulerian number, 28, 48
face
lattice, 96
number, 95
of a pointed cone, 59
of a polytope, 26
facet
of a pointed cone, 59
of a polytope, 26
Farey sequence, 53
Fibonacci sequence, 3, 152
ï¬nite Fourier series, 123
ï¬nite Fourier transform, 129
ï¬nite geometric series, 17, 130, 155
Fourier coeï¬ƒcient, 126
Fourier transform, 129
Fourierâ€“Dedekind sum, 14, 139
fractional-part function, 10, 18, 127
frequency, 126
Frobenius number, 6
Frobenius problem, 3
fundamental parallelepiped, 62
GauÃŸ sum, 137
gcd algorithm, 143, 147
generating function, 3, 8, 13, 28, 60, 64,
111
constant term of, 8, 13, 42, 117, 142,
148
generator of a pointed cone, 58
geometric series, 4, 17, 62, 124
graded algebra, 48
greatest-integer function, 10, 17, 83, 127
h-cone, 199
half-space, 26
Hibiâ€™s palindromic theorem, 88
Hilbertâ€“PoincarÂ´e series, 48
hyperplane, 26, 59
degenerate, 26
rational, 79
hyperplane arrangement, 79, 159
central, 159
rational, 159
hyperplane description, 26, 48, 199
hypersimplex, 79
indicator function, 160
inï¬nite sequence, 3
inner product, 130, 136
integer-point transform, 60, 65, 84, 155,
157
of a simplicial cone, 62
integral polygon, 38
integral polytope, 26, 64, 101, 188
interior, 28, 83, 87
relative, 96, 109, 179
interpolation, 72, 109
isolated singularity, 191
Jacobi symbol, 150
KhovanskiË˜Ä±â€“Pukhlikov theorem, 175
Lagrange interpolation formula, 73
Laguerre polynomial, 49
latin square, 118
lattice, 25, 76, 196
lattice basis, 20
lattice point, 19, 25, 33, 60
lattice-point enumerator, 27, 45
Laurent series, 8, 191
line segment, 11, 19, 26
linear Diophantine problem of
Frobenius, 6
local Riemann hypothesis, 49
Luo Shu square, 106
MÂ¨obius function, 137
magic square, 106

Index
231
traditional, 106
magic sum, 105
metric space, 130
moment, 172
moment generating function, 60
northeast lattice path, 20
octahedron, 36
order polytope, 49
orthogonal complement, 159
orthogonality relations, 130
palindromy
of the Ehrhart series of a reï¬‚exive
polytope, 88
of the solid-angle generating function,
188
Parseval identity, 131
part of a partition, 6
partial fractions, 4, 8, 13, 43, 124, 141,
148
partition, 6
period, 44, 75
periodic function, 44, 123, 129
periodic sequence, 125
permutation matrix, 109
Pickâ€™s theorem, 38, 195
Plancherel theorem, 131
pointed cone, 58, 159
rational, 58
polar polytope, 90
polygon, 25
integral, 38
rational, 41, 45
polyhedron, 159
polynomial, 27, 30, 33, 40, 64, 70â€“72,
78, 101, 109, 135, 155
interpolation of, 73, 109
polytope, 7, 25
Delzant, 174
dual, 91
integral, 26, 64, 101, 188
normal, 48
polar, 91
rational, 26, 45, 75, 182
simple, 95, 170
smooth, 174
unimodular, 174
Popoviciuâ€™s theorem, 11
power series, 8
primitive root of unity, 137
pyramid, 33, 49, 187
over a polytope, 34
quasipolynomial, 44, 75, 80, 116, 182
constituent of, 45, 117
degree of, 44
period of, 44, 75
Rademacher reciprocity, 144
rational pointed cone, 58
rational polygon, 41, 45
rational polytope, 26, 45, 75, 182
reciprocity law
for the classical Dedekind sum, 143
for the Dedekindâ€“Rademacher sum,
145
for the Fourierâ€“Dedekind sum, 142,
144
reciprocity theorem
for integer-point transforms, 86
for lattice-point enumeration, 84
for solid-angle generating functions,
183
for solid-angle sums, 184
regular tetrahedron, 51, 189
relative interior, 96, 109, 179
relative volume, 100
representable, 6
residue, 191
residue theorem, 192
restricted partition function, 6, 13, 141
polynomial part of, 141
Riemann zeta function, 32
root, 71
root of unity, 8
primitive, 137
sawtooth function, 127, 146
semigroup, 78
semimagic square, 106
symmetric, 120
shelling, 102
simple polytope, 95, 170
simplex, 26, 57, 75
faces of, 50
simplicial cone, 58

232
Index
skewed orthants, 157
slack variable, 29, 41, 45
smooth polytope, 174
solid angle, 179
generating function, 182
of a face, 179
polynomial, 185
series, 188
sum of, 181
standard simplex, 29, 180
Stanleyâ€™s nonnegativity theorem, 68
Stanleyâ€™s reciprocity theorem, 86
Stirling number of the ï¬rst kind, 31, 51
sublattice, 100
supporting hyperplane, 26, 59
Sylvesterâ€™s theorem, 6
symmetric semimagic square, 120
tangent cone, 159
tetrahedron, 26, 148
Todd operator, 168, 174
toric variety, 48
traditional magic square, 106
transporation polytope, 119
triangle, 20, 26, 41
triangulation
of a pointed cone, 60
of a polygon, 39
of a polytope, 57, 205
trigonometric identities, 134
trivial, 115
unimodular
cone, 174
polytope, 174
unit cube, 26, 33
unitary transformation, 136
v-cone, 199
valuation, 189
Vandermonde matrix, 79
vector partition function, 49
vector space, 129
vertex, 26, 119
vertex cone, 159
vertex description, 25, 48, 199
visible, 206
volume, 26, 71, 83, 100, 109, 174, 182
WeierstraÃŸ â„˜-function, 193
WeierstraÃŸ Î¶-function, 193
Zagier reciprocity, 142
zero, 185

Irving: Integers, Polynomials, and Rings: A 
Course in Algebra.
Isaac: The Pleasures of Probability. 
Readings in Mathematics.
James: Topological and Uniform Spaces.
JÃ¤nich: Linear Algebra.
JÃ¤nich: Topology.
JÃ¤nich: Vector Analysis.
Kemeny/Snell: Finite Markov Chains.
Kinsey: Topology of Surfaces.
Klambauer: Aspects of Calculus.
Lang: A First Course in Calculus. Fifth edition.
Lang: Calculus of Several Variables. Third 
edition.
Lang: Introduction to Linear Algebra. 
Second edition.
Lang: Linear Algebra. Third edition.
Lang: Short Calculus: The Original Edition 
of â€œA First Course in Calculus.â€
Lang: Undergraduate Algebra. Third edition.
Lang: Undergraduate Analysis.
Laubenbacher/Pengelley: Mathematical 
Expeditions.
Lax/Burstein/Lax: Calculus with Applications 
and Computing. Volume 1.
LeCuyer: College Mathematics with APL.
Lidl/Pilz: Applied Abstract Algebra. Second 
edition.
Logan: Applied Partial Differential Equations, 
Second edition.
Logan: A First Course in Differential Equations.
LovÃ¡sz/PelikÃ¡n/Vesztergombi: Discrete 
Mathematics.
Macki-Strauss: Introduction to Optimal Control 
Theory.
Malitz: Introduction to Mathematical Logic.
Marsden/Weinstein: Calculus I, II, III. 
Second edition.
Martin: Counting: The Art of Enumerative 
Combinatorics.
Martin: The Foundations of Geometry and the 
Non-Euclidean Plane.
Martin: Geometric Constructions.
Martin: Transformation Geometry: An 
Introduction to Symmetry.
Millman/Parker: Geometry: A Metric Approach 
with Models. Second edition.
Moschovakis: Notes on Set Theory. Second 
edition.
Owen: A First Course in the Mathematical 
Foundations of Thermodynamics.
Palka: An Introduction to Complex Function 
Theory.
Pedrick: A First Course in Analysis.
Peressini/Sullivan/Uhl: The Mathematics of 
Nonlinear Programming.
Prenowitz/Jantosciak: Join Geometries.
Priestley: Calculus: A Liberal Art. Second 
edition.
Protter/Morrey: A First Course in Real Analysis. 
Second edition.
Protter/Morrey: Intermediate Calculus. Second 
edition.
Pugh: Real Mathematical Analysis.
Roman: An Introduction to Coding and 
Information Theory.
Roman: Introduction to the Mathematics of 
Finance: From Risk management to options 
Pricing.
Ross: Differential Equations: An Introduction 
with MathematicaÂ®. Second Edition.
Ross: Elementary Analysis: The Theory 
of Calculus.
Samuel: Projective Geometry. 
Readings in Mathematics.
Saxe: Beginning Functional Analysis
Scharlau/Opolka: From Fermat to Minkowski.
Schiff: The Laplace Transform: Theory 
and Applications.
Sethuraman: Rings, Fields, and Vector Spaces: 
An Approach to Geometric Constructability.
Sigler: Algebra.
Silverman/Tate: Rational Points on Elliptic 
Curves.
Simmonds: A Brief on Tensor Analysis. 
Second edition.
Singer: Geometry: Plane and Fancy.
Singer: Linearity, Symmetry, and Prediction in 
the Hydrogen Atom.
Singer/Thorpe: Lecture Notes on Elementary 
Topology and Geometry.
Smith: Linear Algebra. Third edition.
Smith: Primer of Modern Analysis. Second 
edition.
Stanton/White: Constructive Combinatorics.
Stillwell: Elements of Algebra: Geometry, 
Numbers, Equations.
Stillwell: Elements of Number Theory.
Stillwell: The Four Pillars of Geometry.
Stillwell: Mathematics and Its History. 
Second edition.
Stillwell: Numbers and Geometry.
Readings in Mathematics.
Strayer: Linear Programming and Its 
Applications.
Toth: Glimpses of Algebra and Geometry. 
Second Edition.
Readings in Mathematics.
Troutman: Variational Calculus and Optimal 
Control. Second edition.
Valenza: Linear Algebra: An Introduction to 
Abstract Mathematics.
Whyburn/Duda: Dynamic Topology.
Wilson: Much Ado About Calculus.
Undergraduate Texts in Mathematics (continued from p.ii)

Printed in the United States of America

