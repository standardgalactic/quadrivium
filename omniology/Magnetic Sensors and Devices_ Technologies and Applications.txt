
Magnetic Sensors and 
Devices 
Technologies and Applications

Devices, Circuits, and Systems
Series Editor 
Krzysztof Iniewski
Emerging Technologies CMOS Inc.  
Vancouver, British Columbia, Canada
PUBLISHED TITLES:
Advances in Imaging and Sensing
Shuo Tang and Daryoosh Saeedkia
Analog Electronics for Radiation Detection
Renato Turchetta
Atomic Nanoscale Technology in the Nuclear Industry
Taeho Woo
Biological and Medical Sensor Technologies
Krzysztof Iniewski
Building Sensor Networks: From Design to Applications
Ioanis Nikolaidis and Krzysztof Iniewski
Cell and Material Interface: Advances in Tissue Engineering,  
Biosensor, Implant, and Imaging Technologies
Nihal Engin Vrana
Circuits and Systems for Security and Privacy
Farhana Sheikh and Leonel Sousa
Circuits at the Nanoscale: Communications, Imaging, and Sensing
Krzysztof Iniewski
CMOS: Front-End Electronics for Radiation Sensors
Angelo Rivetti
CMOS Time-Mode Circuits and Systems: Fundamentals  
and Applications
Fei Yuan
Design of 3D Integrated Circuits and Systems
Rohit Sharma
Diagnostic Devices with Microfluidics
Francesco Piraino and Šeila Selimovi´c
Electrical Solitons: Theory, Design, and Applications 
David Ricketts and Donhee Ham
Electronics for Radiation Detection 
Krzysztof Iniewski

Electrostatic Discharge Protection: Advances and Applications
Juin J. Liou
Embedded and Networking Systems:  
Design, Software, and Implementation
Gul N. Khan and Krzysztof Iniewski
Energy Harvesting with Functional Materials and Microsystems
Madhu Bhaskaran, Sharath Sriram, and Krzysztof Iniewski
Gallium Nitride (GaN): Physics, Devices, and Technology
Farid Medjdoub
Graphene, Carbon Nanotubes, and Nanostuctures:  
Techniques and Applications
James E. Morris and Krzysztof Iniewski
High-Speed Devices and Circuits with THz Applications
Jung Han Choi
High-Speed Photonics Interconnects
Lukas Chrostowski and Krzysztof Iniewski
High Frequency Communication and Sensing:  
Traveling-Wave Techniques
Ahmet Tekin and Ahmed Emira
High Performance CMOS Range Imaging:  
Device Technology and Systems Considerations
Andreas Süss
Integrated Microsystems: Electronics, Photonics, and Biotechnology 
Krzysztof Iniewski
Integrated Power Devices and TCAD Simulation
Yue Fu, Zhanming Li, Wai Tung Ng, and Johnny K.O. Sin
Internet Networks: Wired, Wireless, and Optical Technologies 
Krzysztof Iniewski
Introduction to Smart eHealth and eCare Technologies 
Sari Merilampi, Krzysztof Iniewski, and Andrew Sirkka
Ionizing Radiation Effects in Electronics: From Memories to Imagers
Marta Bagatin and Simone Gerardin
Labs on Chip: Principles, Design, and Technology
Eugenio Iannone
Laser-Based Optical Detection of Explosives
Paul M. Pellegrino, Ellen L. Holthoff, and Mikella E. Farrell
Low Power Emerging Wireless Technologies
Reza Mahmoudi and Krzysztof Iniewski
PUBLISHED TITLES:

Magnetic Sensors and Devices: Technologies and Applications
Kirill Poletkin and Laurent A. Francis 
Medical Imaging: Technology and Applications
Troy Farncombe and Krzysztof Iniewski
Metallic Spintronic Devices
Xiaobin Wang
MEMS: Fundamental Technology and Applications
Vikas Choudhary and Krzysztof Iniewski
Micro- and Nanoelectronics: Emerging Device Challenges and Solutions
Tomasz Brozek
Microfluidics and Nanotechnology: Biosensing to the Single Molecule Limit
Eric Lagally
MIMO Power Line Communications: Narrow and Broadband Standards,  
EMC, and Advanced Processing
Lars Torsten Berger, Andreas Schwager, Pascal Pagani, and Daniel Schneider
Mixed-Signal Circuits
Thomas Noulis
Mobile Point-of-Care Monitors and Diagnostic Device Design
Walter Karlen
Multisensor Attitude Estimation: Fundamental Concepts and Applications 
Hassen Fourati and Djamel Eddine Chouaib Belkhiat
Multisensor Data Fusion: From Algorithm and Architecture Design  
to Applications
Hassen Fourati
MRI: Physics, Image Reconstruction, and Analysis
Angshul Majumdar and Rabab Ward
Nano-Semiconductors: Devices and Technology
Krzysztof Iniewski
Nanoelectronic Device Applications Handbook
James E. Morris and Krzysztof Iniewski
Nanomaterials: A Guide to Fabrication and Applications
Sivashankar Krishnamoorthy
Nanopatterning and Nanoscale Devices for Biological Applications
Šeila Selimovic´
Nanoplasmonics: Advanced Device Applications 
James W. M. Chon and Krzysztof Iniewski
Nanoscale Semiconductor Memories: Technology and Applications 
Santosh K. Kurinec and Krzysztof Iniewski
PUBLISHED TITLES:

Noise Coupling in System-on-Chip
Thomas Noulis
Novel Advances in Microsystems Technologies and Their Applications
Laurent A. Francis and Krzysztof Iniewski
Optical, Acoustic, Magnetic, and Mechanical Sensor Technologies
Krzysztof Iniewski
Optical Fiber Sensors: Advanced Techniques and Applications 
Ginu Rajan
Optical Imaging Devices: New Technologies and Applications 
Ajit Khosla and Dongsoo Kim
Organic Solar Cells: Materials, Devices, Interfaces, and Modeling
Qiquan Qiao
Physical Design for 3D Integrated Circuits 
Aida Todri-Sanial and Chuan Seng Tan
Power Management Integrated Circuits and Technologies 
Mona M. Hella and Patrick Mercier
Radiation Detectors for Medical Imaging 
Jan S. Iwanczyk
Radiation Effects in Semiconductors 
Krzysztof Iniewski
Reconfigurable Logic: Architecture, Tools, and Applications 
Pierre-Emmanuel Gaillardon
Semiconductor Devices in Harsh Conditions 
Kirsten Weide-Zaage and Malgorzata Chrzanowska-Jeske
Semiconductor Radiation Detection Systems 
Krzysztof Iniewski
Semiconductor Radiation Detectors, Technology, and Applications
Salim Reza
Semiconductors: Integrated Circuit Design for Manufacturability 
Artur Balasinski
Smart Grids: Clouds, Communications, Open Source, and Automation
David Bakken
Smart Sensors for Industrial Applications 
Krzysztof Iniewski
Soft Errors: From Particles to Circuits
Jean-Luc Autran and Daniela Munteanu
Solid-State Radiation Detectors: Technology and Applications
Salah Awadalla
PUBLISHED TITLES:

Structural Health Monitoring of Composite Structures Using Fiber  
Optic Methods 
Ginu Rajan and Gangadhara Prusty
Technologies for Smart Sensors and Sensor Fusion
Kevin Yallup and Krzysztof Iniewski
Telecommunication Networks
Eugenio Iannone
Testing for Small-Delay Defects in Nanoscale CMOS Integrated Circuits
Sandeep K. Goel and Krishnendu Chakrabarty
Tunable RF Components and Circuits: Applications in Mobile Handsets
Jeffrey L. Hilbert
VLSI: Circuits for Emerging Applications
Tomasz Wojcicki
Wireless Medical Systems and Algorithms: Design and Applications
Pietro Salvo and Miguel Hernandez-Silveira
Wireless Technologies: Circuits, Systems, and Devices
Krzysztof Iniewski
Wireless Transceiver Circuits: System Perspectives and Design Aspects
Woogeun Rhee
FORTHCOMING TITLES:
3D Integration in VLSI Circuits: Design, Architecture, and  
Implementation Technologies
Katsuyuki Sakuma
Energy Efficient Computing: Devices, Circuits, and Systems
Santosh K. Kurinec
High-Speed and Lower Power Technologies: Electronics and Photonics 
Jung Han Choi and Krzysztof Iniewski
IoT and Low-Power Wireless: Circuits, Architectures, and Techniques 
Christopher Siu and Krzysztof Iniewski
Nanoelectronics: Devices, Circuits, and Systems 
Nikos Konofaos
Radio Frequency Integrated Circuit Design 
Sebastian Magierowski
Sensors for Diagnostics and Monitoring 
Kevin Yallup and Krzysztof Iniewski
X-Ray Diffraction Imaging: Technology and Applications 
Joel Greenberg and Krzysztof Iniewski
PUBLISHED TITLES:

Magnetic Sensors and 
Devices 
Technologies and Applications
Edited by 
Kirill Poletkin and Laurent A. Francis 
Managing Editor
Krzysztof Iniewski

MATLAB®  is a trademark of The MathWorks, Inc. and is used with permission. The MathWorks 
does not warrant the accuracy of the text or exercises in this book. This book’ s use or discussion 
of MATLAB®  software or related products does not constitute endorsement or sponsorship by The 
MathWorks of a particular pedagogical approach or particular use of the MATLAB®  software.
CRC Press
Taylor & Francis Group
6000 Broken Sound Parkway NW, Suite 300
Boca Raton, FL 33487-2742
©  2018 by Taylor & Francis Group, LLC 
CRC Press is an imprint of Taylor & Francis Group, an Informa business
No claim to original U.S. Government works
Printed on acid-free paper
International Standard Book Number-13: 978-1-4987-1097-8 (Hardback)
This book contains information obtained from authentic and highly regarded sources. Reasonable 
efforts have been made to publish reliable data and information, but the author and publisher cannot 
assume responsibility for the validity of all materials or the consequences of their use. The authors 
and publishers have attempted to trace the copyright holders of all material reproduced in this 
publication and apologize to copyright holders if permission to publish in this form has not been 
obtained. If any copyright material has not been acknowledged, please write and let us know so we 
may rectify in any future reprint.
Except as permitted under U.S. Copyright Law, no part of this book may be reprinted, reproduced, 
transmitted, or utilized in any form by any electronic, mechanical, or other means, now known 
or hereafter invented, including photocopying, microfilming, and recording, or in any information 
storage or retrieval system, without written permission from the publishers.
For permission to photocopy or use material electronically from this work, please access www.copy-
right.com (http://www.copyright.com/) or contact the Copyright Clearance Center, Inc. (CCC), 222 
Rosewood Drive, Danvers, MA 01923, 978-750-8400. CCC is a not-for-profit organization that pro-
vides licenses and registration for a variety of users. For organizations that have been granted a 
photocopy license by the CCC, a separate system of payment has been arranged.
Trademark Notice:  Product or corporate names may be trademarks or registered trademarks, and 
are used only for identification and explanation without intent to infringe.
Visit the Taylor & Francis Web site at 
http://www.taylorandfrancis.com 
and the CRC Press Web site at 
http://www.crcpress.com 

ix
Contents
Series Editor.............................................................................................................xi
Editors.................................................................................................................... xiii
Contributors............................................................................................................xv
	 1	 Biosensor Application for Bovine Mastitis Diagnosis............................1
Carla M. Duarte, Susana Cardoso, and Paulo P. Freitas
	 2	 Giant (GMR) and Tunnel (TMR) Magnetoresistance Sensors: 
From Phenomena to Applications..............................................................35
Cà ndid Reig and Marí a-Dolores Cubells-Beltrá n
	 3	 Frequency Tuning Investigation of an Out-of-Plane Resonant 
Microstructure for a Capacitive Detection Magnetometer...................65
Petros Gkotsis, Mohamed Hadj Said, Farès Tounsi, Brahim Mezghani, 
and Laurent A. Francis
	 4	 Micromachined Inductive Contactless Suspension: Technology 
and Modeling............................................................................................... 101
Kirill V. Poletkin, Vlad Badilita, Zhiqiu Lu, Ulrike Wallrabe, and 
Christopher Shearwood
	 5	 Application of Magnetic Sensors for Ecological Monitoring 
of Stationary Ferromagnetic Masses from On Board Mobile 
Platforms.......................................................................................................133
Alexander I. Chernomorsky, Vyacheslav E. Plekhanov, and 
Vladimir N. Maximov
	 6	 A Model to Calculate Force Characteristics of a Magnetic 
Suspension of a Superconducting Sphere.............................................. 165
Sergey I. Kuznetsov and Yury M. Urman
	 7	 Magnetic Angle Sensors............................................................................201
Udo Ausserlechner
Index......................................................................................................................251


xi
Series Editor
Krzysztof (Kris) Iniewski is managing R&D at Redlen Technologies Inc., a 
start-up company in Vancouver, Columbia, Canada. Redlen’s revolutionary 
production process for advanced semiconductor materials enables a new gen-
eration of more accurate, all-digital, radiation-based imaging solutions. Kris 
is also a founder of Emerging Technologies CMOS Inc. (www.etcmos.com), 
an organization of high-tech events covering communications, micro-
systems, optoelectronics, and sensors. In his career, Dr. Iniewski has held 
numerous faculty and management positions at the University of Toronto, 
University of Alberta, SFU, and PMC-Sierra Inc. He has published over 100 
research papers in international journals and conferences. He holds 18 inter-
national patents granted in the United States, Canada, France, Germany, and 
Japan. He is a frequent invited speaker and has consulted for multiple orga-
nizations internationally. He has written and edited several books for CRC 
Press, Cambridge University Press, IEEE Press, Wiley, McGraw-Hill, Artech 
House, and Springer. His personal goal is to contribute to healthy living and 
sustainability through innovative engineering solutions. In his leisurely 
time, Kris can be found hiking, sailing, skiing, or biking in beautiful British 
Columbia. He can be reached at kris.iniewski@gmail.com.


xiii
Editors
Kirill V. Poletkin  is a research associate at the Institute of Microstructure 
Technology at Karlsruhe Institute of Technology. He received an honors 
diploma in electromechanical engineering, majoring in aviation devices 
and measurement systems, in 2001 from Nizhny Novgorod State Technical 
University, and his PhD from Moscow Aviation Institute (State University of 
Aerospace Technologies), Russia, in 2007. His master’s thesis won the Ministry 
of Education and Science of the Russian Federation’ s best research work at an 
all-Russian student competition in 2002. Then, he was awarded the Humboldt 
Research Fellowship for Experienced Researchers in 2012 and successfully per-
formed his Humboldt project titled “Micromachined contactless suspension 
with zero spring constant for application as an accelerometer”  at University 
of Freiburg, Germany from 2013 until 2015. Between 2009 and 2013, he did 
postdoctoral research at Nanyang Technological University, Singapore. He has 
also worked previously with Giesecke & Devrient GmbH (G&D), JSC Temp-
Avia, and the Russian Federal Nuclear Center (VNIITF). His research interests 
include micro- and nano-scales device and the processes of energy transfer 
within these scales. He is an author of a number of peer-reviewed journal arti-
cles, conference papers, and two chapters in books published by CRC Press.
Laurent A. Francis is a professor at the Institute of Information and 
Communication Technologies, Electronics and Applied Mathematics 
(ICTEAM) of the Université catholique de Louvain (UCL), Belgium. He 
received his degree in materials science engineering with a minor in electrical 
engineering in 2001, and in 2006 he received his PhD in applied science from 
UCL. His main focus is on the micro- and nanotechnology of co-integrated, 
ultra-low power CMOS MEMS sensors for biomedical applications and 
harsh environments. While working on his PhD, he worked as a researcher 
at IMEC in Leuven, Belgium, in the field of acoustic and optical biosensors 
and piezoelectric RF-MEMS. In 2007, he joined UCL as microsystems chair 
and created the Sensors, Microsystems and Actuators Laboratory of Louvain 
(SMALL), which he has led since. In 2011, he served as visiting professor at the 
Université de Sherbrooke, Canada, where he is currently professeur associé 
at the Département de génie électrique et de génie informatique. He has pub-
lished more than 100 research papers in international journals, is co-editor 
of one book in microsystems technology published by CRC Press, and holds 
four patents. He served as TPC for conferences in the fields of harsh environ-
ments and materials science. He is a board member of the Belgian National 
Committee Biomedical Engineering and Belgian representative at IMEKO, 
the International Measurement Confederation. He is a regular member of the 
IEEE and serves as treasurer of the IEEE CPMT Benelux Chapter.


xv
Contributors
Udo Ausserlechner 
Infineon Technologies Austria AG
Villach, Austria
Vlad Badilita 
Institute of Microstructure 
Technology
Karlsruhe Institute of Technology
Karlsruhe, Germany
Susana Cardoso
INESC—Microsistemas e 
Nanotecnologias
and 
Instituto Superior Técnico, Physics 
Department 
Universidade de Lisboa
Lisbon, Portugal
Alexander I. Chernomorsky
School of Control Systems, 
Informatics and Electrical 
Engineering
Moscow Aviation Institute
Moscow, Russia
María-Dolores Cubells-Beltrán
University of Valencia
Valencia, Spain
Carla M. Duarte 
INESC—Microsistemas e 
Nanotecnologias 
and 
Faculdade de Medicina Veterinária
Lisbon, Portugal 
Paulo P. Freitas
INESC—Microsistemas e 
Nanotecnologias
and
Instituto Superior Técnico, Physics 
Department 
Universidade de Lisboa
Lisbon, Portugal
Petros Gkotsis
European Commission–Joint 
Research Centre
Seville, Spain
Sergey Kuznetsov 
N. I. Lobachevsky State University 
of Nizhniy Novgorod
Nizhniy Novgorod, Russia
and
Johns Hopkins University
Baltimore, Maryland
Zhiqiu Lu 
Department of Microsystems 
Engineering—IMTEK
University of Freiburg
Freiburg, Germany
Vladimir N. Maximov 
School of Control Systems, 
Informatics and Electrical 
Engineering
Moscow Aviation Institute
Moscow, Russia

xvi
Contributors
Brahim Mezghani
National Engineering School of Sfax
Sfax, Tunisia
Vyacheslav E. Plekhanov
School of Control Systems 
Informatics and Electrical 
Engineering
Moscow Aviation Institute
Moscow, Russia
Càndid Reig
University of Valencia
Valencia, Spain
Mohamed Hadj Said
National Engineering School of Sfax 
Sfax, Tunisia
Christopher Shearwood 
School of Mechanical & Aerospace 
Engineering
Nanyang Technological University
Singapore
Farès Tounsi 
National Engineering School of Sfax 
Sfax, Tunisia
Yury M. Urman 
Nizhniy Novgorod Institute of 
Management and Business
Nizhniy Novgorod, Russia
Ulrike Wallrabe 
Department of Microsystems 
Engineering—IMTEK
University of Freiburg
Freiburg, Germany

1
1
Biosensor Application for 
Bovine Mastitis Diagnosis
Carla M. Duarte, Susana Cardoso, and Paulo P. Freitas
CONTENTS
1.1	
Introduction.....................................................................................................2
1.1.1	 Bacterial Detection Methods.............................................................3
1.1.2	 Technological Advances....................................................................5
1.2	
Portable “Lab-on-Chip” Platform for Bovine Mastitis Diagnosis 
in Raw Milk.....................................................................................................5
1.2.1	 Magnetic Detection Principles..........................................................6
1.2.2	 Biosensor Fabrication.........................................................................8
1.2.3	 Microfluidic Channel Fabrication................................................... 10
1.2.4	 Readout Electronics.......................................................................... 10
1.2.5	 Biological Functionalization of Nanoparticles............................. 11
1.2.6	 Biosensor Calibration.......................................................................12
1.2.7	 Bacterial Cells....................................................................................12
1.2.8	 Sterile Milk Samples.........................................................................13
1.2.9	 Mastitic Milk Samples......................................................................13
1.2.10	 PCR Reference Method Analysis....................................................13
1.2.11	 Biosensor Analysis............................................................................ 14
1.2.12	 Data Analysis.................................................................................... 16
1.3	
Results............................................................................................................17
1.3.1	 Evaluation of Biosensor’s Bacterial Quantification......................17
1.3.2	 Validation of Magnetic Detection with mAb 
Anti-S. agalactiae and pAb Anti-GB Streptococci......................... 18
1.3.3	 Validation of Magnetic Detection with mAb Anti-
Staphylococcus spp. and pAb Anti-Staphylococcus aureus..............22
1.4	
Discussion......................................................................................................24
1.4.1	 Strengths, Weaknesses, Opportunities, and Threats..................27
1.5	
Future Perspectives......................................................................................30
References................................................................................................................30

2
Magnetic Sensors and Devices
ABSTRACT  Bovine mastitis is an inflammation of the mammary gland, 
most often of infectious origin. It is the most frequent disease of dairy cat-
tle and one of the main reasons for culling dairy cows (Gröhn et al., 1998; 
Hortet & Seegers, 1998; Hovi & Roderick, 1999). Bovine mastitis is also an 
economic burden for farmers because of decreased milk yield, cost of vet-
erinary treatments, and other factors (Korhonen & Kaartinen, 1995). Dairy 
farm management focusing on animal health and hygiene improvement 
program implementation helps to control mastitis. The timely identifica-
tion of causing microorganisms is necessary to control the disease, reduce 
the risk of chronic infections, and target the antimicrobial therapy to be 
used. Also, several studies showed that the early detection of mastitis may 
increase the cure rate by 60% and reduce the time required to recover nor-
mal milk production when combined with appropriate antimicrobial ther-
apy (Milner et al., 1997).
1.1  Introduction
Bovine mastitis is an inflammation of the mammary gland, most often of 
infectious origin. It is the most frequent disease of dairy cattle and one of 
the main reasons for culling dairy cows (Gröhn et al., 1998; Hortet & Seegers, 
1998; Hovi & Roderick, 1999). Bovine mastitis is also an economic burden on 
farmers because of decreased milk yields, cost of veterinary treatments, and 
other factors (Korhonen & Kaartinen, 1995). Dairy farm management focus-
ing on animal health and hygiene improvement program implementation 
contributes to control mastitis. The timely identification of causative micro-
organisms is necessary to control the disease, reduce the risk of chronic 
infections, and target the antimicrobial therapy to be used. Also, several 
studies have shown that the early detection of mastitis may increase the cure 
rate by 60% and reduce the time required to recover normal milk produc-
tion when combined with appropriate antimicrobial therapy (Milner et al., 
1997). The rapid identification of pathogens such as Staphylococcus spp. and 
Streptococcus spp. and among these, the discrimination of major contagious 
pathogens Staphylococcus aureus, Streptococcus agalactiae, and Streptococcus 
uberis (Bradley, 2002; Zadoks et al., 2011), will therefore contribute to decreas-
ing the economic burden of bovine mastitis. Coagulase-negative staphylo-
cocci, as Staphylococcus epidermidis, are considered minor mastitis pathogens, 
but they are the most common agents isolated from milk samples in several 
large-scale surveys worldwide (Tenhagen et al., 2006).
This work describes the application of a novel biosensor device for the 
identification and quantification of S. agalactiae, S. uberis, and S. aureus and 
of the genus Staphylococcus in raw milk samples. The biosensor consists of 
a magnetoresistive (MR) sensor and microfluidics, with electronic readout, 

3
Biosensor Application for Bovine Mastitis Diagnosis
and the detection of bacteria is achieved through the detection of magnetic 
nanoparticles (NP) labeling the bacteria.
1.1.1  Bacterial Detection Methods
Because of the high impact on human health, bacteria detection in milk has 
prompted many years of research and development toward reliable and uni-
versal diagnosis tests. Table 1.1 summarizes the different strategies and tech-
niques used for the analysis of milk samples toward bacteria detection and 
quantification.
One of the most widely used methods for subclinical mastitis diagnosis is 
the California Mastitis Test (CMT), a common indirect method for somatic 
cell count (SCC) measurement. However, this portable method only dis-
criminates sick from healthy animals and is unable to identify the causative 
agent of infection. Therefore, a microbiological culture is considered the gold 
standard for diagnosing mastitis pathogens (Britten, 2012), allowing for a tar-
geted control and treatment decision, in addition to presenting high sensitiv-
ity and specificity. Another advantage of microbial culture–based methods is 
the possibility of identifying the antibiotic susceptibility of bacteria. The lim-
itations of a microbiological culture include delays in obtaining results and 
suboptimal accuracy in identifying mastitis pathogens. On the other hand, 
the use of polymerase chain reaction (PCR)-based tests may be of interest 
for intramammary infection (IMI) diagnosis when milk samples with high 
SCC are culture-negative or when culturing only detects minor pathogens 
(Taponen et al., 2009; Bexiga et al., 2011). PCR is a semi-quantitative technique 
that generates information about the number of copies of DNA fragments 
that have been detected in a sample, being difficult to assign mastitis causal-
ity to a particular microorganism. We also cannot assume that one bacterial 
species is more important in terms of the negative effects on a mammary 
gland, simply because it is present in higher numbers.
Immunodiagnostics also create new perspectives for the diagnosis of 
bovine mastitis as an alternative to a microbiological culture. Methods based 
on serology have the desired characteristics for an ideal diagnostic test such 
as speed, sensitivity, ease of handling, and low cost (Fabres-Klein et al., 2014). 
The market already provides several portable commercialized immunoassays 
for the diagnosis of diseases of veterinary relevance (Zschöck et al., 2005).
The successful choice of a test that evaluates milk requires methodologi-
cal knowledge and diagnostic capabilities for each test currently available. 
The sensitivity of culture tests may be complemented by PCR analysis, 
which are often combined to yield more robust results. However, to make 
treatment decisions, this combination does not allow for a timely answer. 
Proteomic research for reliable biomarkers, as enzymes and acute phase 
proteins (Pyörälä, 2003; Grönlund, et al., 2003; Åkerstedt et al., 2011; Mansor 
et al., 2013), is viable for the early detection of mastitis and drug efficacy, 
and to discover potentially novel targets for the development of alternative 

4
Magnetic Sensors and Devices
TABLE  1.1 
Overview of the Existing Strategies for Bacteria Detection in Milk
Method Basis for Bacteria Detection 
in Milk 
LOD (Limit 
of 
Detection) 
Sensitivity 
and 
Specificity 
References 
Microbiological 
On-farm culture test
Sensitivities of 
97.9% and 
93.8%
McCarron et al. 
(2009)
Specificities of 
68.6% and 
70.1%
Lago et al. (2011)
Genetics 
Pathogen-specific targets of DNA were 
amplified and transferred to react 
and hybridize with specific probes 
that were pre-spotted on the biochip
103 – 105  
CFU/mL
Sensitivity of 
94.1%
Lee et al. (2008)
Specificity of 
100%
Immunological 
Magnetic bead– based ELISA 
employing monoclonal antibodies for 
the detection of staphylococci in milk
104 – 105  
CFU/mL
Yazdankhah et al. 
(1998)
Immunological 
ELISA for detecting S. aureus  in milk 
samples
103 – 105  
CFU/mL
Sensitivities of 
69%– 90%
Matsushita et al. 
(1990)
Specificities of 
61%– 97%
Hicks et al. (1994)
Immunoagglutination 
S. aureus  identification in milk samples
Sensitivity of 
86.7%
Zschö ck et al. 
(2005)
Specificity of 
90.1%
Immunological 
Sandwich ELISA test to detect S. aureus 
105  CFU/mL
Libing et al. 
(2012)
Immunological 
Competitive immunoassay performed 
by an amperometric 
magnetoimmunosensor for the 
specific detection and quantification 
of staphylococcal  protein A and 
S. aureus  cells
1 CFU/mL
de Á vila et al. 
(2012)

5
Biosensor Application for Bovine Mastitis Diagnosis
therapies (Lippolis & Reinhardt, 2010). However, these innovations are still 
not possible to use for routine diagnosis. Therefore, it remains important to 
develop a low-cost tool for the differentiation of clinically relevant mastitis 
pathogens that may be used on-farm.
1.1.2  Technological Advances
Flow cytometers have been optimized for use in portable platforms, where 
cell separation, identification, and counting can be achieved in a compact 
and modular format. In this work, this feature was combined with magnetic 
detection, where MR sensors were integrated within microfluidic channels 
to detect magnetically labeled cells.
Over the past years, the drawbacks of conventional flow cytometers have 
encouraged efforts to take advantage of microfabrication technologies and 
advanced microfluidics to achieve smaller, simpler, more innovative, and 
low-cost instrumentation with enhanced portability for on-site measure-
ments. This miniaturization approach has in general made use of inexpen-
sive polymers such as polydimethylsiloxane (PDMS) (Huh et al., 2005) and 
detection techniques easily integrated with electronics (Chung & Kim, 2007), 
such as MR sensors (Loureiro et al., 2011, Kokkinis et al., 2017). A previously 
reported work for magnetic particle detection (Loureiro et al., 2011; Freitas 
et al., 2012) used an integrated cytometer platform, consisting of MR sen-
sors, readout/acquisition electronics, and a microfluidic channel where the 
sample with magnetic particles was injected.
Biosensors are fast becoming the next generation of tools in analyzing areas 
such as environmental research, medicine, biodefense, agriculture, and food 
control (Lazcka et al., 2007). The suitability of a detection method for routine 
diagnosis depends on its specificity, sensitivity, cost, processing time, and suit-
ability for a large number of milk samples. New technical advances in mastitis 
diagnosis still require specialized training and experience to interpret results. 
The personnel responsible should be aware of the strict compliance to each 
step in the process for good quality control in obtaining reliable data.
1.2  Portable “Lab-on-Chip” Platform for Bovine 
Mastitis Diagnosis in Raw Milk
This work describes a platform for the in-flow detection of magnetically 
labeled cells with an MR-based cell cytometer. This portable device is com-
posed of MR sensors (Freitas et al., 2007), namely, spin-valve sensors (SVs), 
integrated with a microfluidic platform and connected to an amplification 
and acquisition setup. The sensors have excellent spatial resolution (on 
the micrometer range) and are sensitive to the magnetic field created by 

6
Magnetic Sensors and Devices
magnetized beads flowing in PDMS microchannels above the sensors. The 
detection scheme used in this platform relies on the MR sensor’s sensitivity 
to count individual cells in flow, contrary to other approaches (Mujika et al., 
2009) while providing information on NPs’ magnetization direction along 
the flow process. Therefore, no additional cell culture is needed. In addi-
tion, this platform is compatible with complex matrixes without the need for 
intricate sample preprocessing, while using a detection principle (magnetic) 
non-existent in nature (thus greatly reducing biological background noise 
and false positives). The use of MR sensors also simplifies the connection 
with electrical equipment while still allowing coupling with other detec-
tion techniques (e.g., fluorescence or a laser-irradiated magnetic bead system 
[LIMBS]) if needed. The sensors are sensitive to the magnetic field created by 
magnetically labeled cells flowing in microchannels above the sensors. This 
dynamic detection is based on immunoassay methodology since the selected 
specific antibodies (probes) recognize immunogenic proteins on bacteria cell 
walls (targets). The SV sensor detects the fringe field of the magnetic labels 
bound around the target cell through the specific probe.
1.2.1  Magnetic Detection Principles
SVs are MR sensors (Baibich et al., 1988; Dieny, 1994) consisting of a non-
magnetic (NM) metal film between two layers of ferromagnetic (FM) metals. 
The film thicknesses are of nanometer dimensions (1–3 nm), and the sen-
sor mechanism is based on the property of the magnetic layer to align with 
an external magnetic field. Since the resistance of these materials depends 
on the relative magnetic orientations of the FM layers (from parallel to 
­anti‑parallel), the SV is the optimum transductor between magnetic field and 
resistance. Figure 1.1 shows an example of an SV sensor, microfabricated into 
a 10 × 2 µm2 active area, with a linear response as a function of the external 
Ta 10 nm
NiFe 3.0 nm
MnIr 6 nm
CoFe 2.5 nm
Cu  2.2 nm
Ta 1.0 nm
CoFe  2.2 nm
Substrate
–8
–6
–4
–2
0
2
4
6
8
460
480
500
 Resistance (Ω)
µ0H (mT)
MR = 9.2%
FIGURE  1.1 
Typical structure for a magnetoresistive spin-valve stack and resistance vs. magnetic field 
transfer curve of a spin-valve magnetoresistive sensor.

7
Biosensor Application for Bovine Mastitis Diagnosis
magnetic field. Many successful examples of SV sensors have been published 
over the past years, from magnetic recording, memories, biomedical, auto-
motive, among many other applications (Loureiro et al., 2011; Freitas et al., 
2012; Wang & Li, 2008). Thus, SV sensors are a mature technology with a 
large community of industrial and academic users. As a consequence, large-
scale integration is offered by manufacturers to biomedical and biotechno-
logical researchers toward hybrid integration with microfluidic platforms, 
for example.
The dimensions of the SV sensors are optimized taking into account the 
final sensor application. In biological applications, the detection targets 
have sizes ranging between a few nanometers (nm; molecules such as DNA, 
RNA, and various proteins) to tens of micrometers (µm; cells can vary in size 
from 1 µm, like the target cell described in this chapter, to 100 µm, the size 
of a big plant eukaryotic cell). Detection is performed through the magnetic 
labeling of these biological targets with nano- or micrometer superpara-
magnetic particles that, under a magnetic field, acquire a magnetic moment. 
This creates a fringe field that can be detected by the sensor through its 
changed resistance.
The sensor output can be written as
	
∆
= −×
× ×
+
+
(
)
V
S R
I
H
H
H
sq
ext
bias
coup 	
(1.1)
where:
Hbias	 	
is the bias field used to center the SV transfer curve (e.g., Oersted 
field created by the electrical current)
Hcoup	 	
includes the internal FM and magnetostatic fields across the thin 
film layers of the SV stack
S	
=	 MR/(2 (Hk + Hdemag)) is the sensor’s sensitivity
Rsq 	
=	 R × L/W is the sensor’s resistance accounting for the dimensions 
(L = length, W = width)
Hext	
	
represents the external magnetic field, averaged over the sensor’s area
In our case, this is the fringe field created by the magnetic labels (Freitas et 
al., 2000, 2012, 2007). Normally, the NP used for biomedical applications are 
weakly magnetic or paramagnetic, to avoid clustering inside the microchan-
nels. Therefore, the sensors are required to read small magnetic fields (few 
micro to nanotesla).
The dynamic detection approach employed in this work involves the appli-
cation of a magnetic field perpendicular to the sensors in order to magnetize 
the beads labeling the cells, with minimum impact on the in-plane sensing 
direction of the sensor (as will be described in Section 1.2.2.). The dynamic 
detection mechanism is illustrated in Figure 1.2, where a vertically magne-
tized particle is injected through a microchannel and generates a variable 
field over the sensor. In Position 1, because of the large distance to the sen-
sor, the fringe field produced by the particles is negligible. As the particle 

8
Magnetic Sensors and Devices
approaches the sensor, the free layer will sense the right-side component of 
the particles’ fringe field, which changes the sensor resistance (Position 2). 
When the particle is in the center of the sensor, the average fringe field of 
the particle is equal to zero, thereby vanishing the signal (Position 3). Finally, 
as the particle passes the sensor (Position 4), the free layer magnetization is 
affected by an opposite fringe field component when compared to Position 2. 
When the cells go away, the signal goes back to zero since no fringe field is 
sensed (Position 5). As a result, a bipolar peak is the signature of the passage 
of a perpendicularly magnetized particle over the SV sensor.
In a dynamic approach, sample acquisition velocity depends on the electron-
ics, thus allowing a high throughput and the direct number of cells to the num-
ber of signals relation. A dynamic acquisition requires magnetic labels with a 
high magnetic moment under an applied external magnetic field to obtain a 
large detectable fringe field, significantly larger than the noise background 
level. However, there needs to be careful label selection, as these should pos-
sess a non-remnant moment in order to avoid particle clustering during the 
labeling process of the cells, which can result in cell clustering creating an 
underestimation of the cell count. A reduced label size is also important to 
avoid the detection of isolated particles (Freitas et al., 2012; Wang & Li, 2008).
1.2.2  Biosensor Fabrication
Magnetic detection in a cytometer biochip platform was first reported in 
2007 (Loureiro et al., 2007). In this and subsequent work (Loureiro et al., 2011; 
Freitas et al., 2012), magnetic particle detection was done with an integrated 
cytometer platform, consisting of MR sensors and readout/acquisition 
Magnet 
1
2
3
Magnet’s ﬁeld direction
Distance from the center of the sensor (mm)
–20 –15 –10 –5
0
5
10
15
20
25
500
1
3
4
5
2
Voltage output (mV)
Particle/cell magnetic alignment
with the magnetic ﬁeld
Particle’s magnetic fringe ﬁeld
(horizontal component)
4
5
Sensor
FIGURE  1.2 
Schematics of MR sensor detection of magnetically labeled targets flowing above the sensor, 
from left (Position 1) to right (Position 5). (Adapted from Fernandes, A.C. et al., Sensors , 14, 
15496– 15524, 2014.)

9
Biosensor Application for Bovine Mastitis Diagnosis
electronics and a microfluidic channel where the magnetically labeled sam-
ple (in this case, the milk) was injected. The device geometry and physical 
principles of operation are described (Fernandes et al., 2014) and are based 
on SVs deposited by ion beam deposition on a Nordiko 3000 tool (Gehanno et 
al., 1999) with the following structure: Si/Al2O3 60/Ta 1.5/Ni80Fe20 2.5/Co90Fe10 
2.0/Cu 2.1/Co90Fe10 2.0/Mn76Ir24 6.0/Ta 5.0 (Freitas et al., 2007) (thickness in 
nm, compositions in atomic %), patterned with 3 × 100 μm active dimensions 
(measured between the AlSiCu 300 nm thick contact leads), according to 
Figure 1.3. Passivation was done with a 300 nm thick Si3N4 layer deposited 
by a plasma-enhanced chemical vapor deposition (PECVD; Electrotech Delta 
chemical vapor deposition system). Sensors were annealed at 250°C for 15 
min, in vacuum, and cooled down under 1 T magnetic field.
The SV sensors’ electrical transport characterization (resistance vs. direct 
current [dc] magnetic field) provided information on the magnetoresistance, 
defined as MR = (Rmax – Rmin)/Rmin (where Rmax and Rmin are the maximum and 
minimum resistance levels). The sensor sensitivity is defined as the slope of 
the curve over the linear range of operation and ranges 0.15%–0.17%/Oe for 
the sensors measured across the wafer.
The magnetic detection mechanism used NP that had a superparamag-
netic signature, thereby requiring an external magnetic field to activate 
their magnetization. This was done with an external vertical field created 
by a permanent magnet (NdFeB, 20-10-01STIC, Supermagnete) mounted 
below the printed circuit board (PCB). After magnet alignment below this 
sensor, the effect of the small components in the plane of the sensors was 
visible in their sensitivity decrease to 0.074%/Oe. The magnetic field at the 
microfluidic channel center was ~31 mT, so the individual NP were magne-
tized with a magnetic moment of 2.0 × 10−18 Am2. Upon magnetization, the 
NP created a magnetic field fringe field at the sensor surface; therefore, the 
(a)
(b)
(c)
100 mm
921 mm
Contacts
5 sensors
Contact lead
0
300 mm
Top
microchannel
Silicone protecting
wirebonding
5.3 mm
Microchannel’s inlets
100 x 3 mm2
Sensor
FIGURE  1.3 
(a) Device with the magnetoresistive chip bonded to the polydimethylsiloxane (PDMS) micro-
channels. The sensor’ s wire bonding wires are protected with silicone. (b) Spin-valve (SV) 
sensor distribution along the microchannels. (c) Microscope photo of the fabricated SVs with 
the PDMS microchannel over them (20×  amplification).

10
Magnetic Sensors and Devices
particle presence was detected through the changes in the sensor resistance 
(or voltage).
1.2.3  Microfluidic Channel Fabrication
The microchannels (Figure 1.3b) were fabricated in PDMS, with 100 × 50 μm 
(length × height), following the method described in the work of Fernandes 
et al. (2014).
The integration of the MR chip with the PDMS microchannels was 
achieved through irreversible bonding of the Si3N4 and PDMS surfaces. Both 
surfaces were exposed to ultraviolet/ozone (UVO Cleaner, Jelight, Irvine, 
CA) for 15 min and then mounted face to face and manually aligned and 
kept at room temperature (RT) overnight. The ensemble was then mounted 
in a PCB, where the sensors were wire bonded and the wires protected with 
silicone (Figure 1.3a).
The raw milk sample’s constant flowing through the microchannel’s sec-
tion of 50 µm in height and 100 µm in length was challenging because of 
its density and colloidal behavior. A surfactant addition to the milk sample, 
namely Tween 20, was used to achieve a higher dispersion of fat globules 
(0.1–10 µm), allowing lower interfacial tension and its dimension reduction 
(Walstra et al., 2006). On the other hand, we adopted the milk preparation 
method of dairy industries for milk homogenization, using agitation (vor-
tex) and higher temperatures (60°C) to decrease fat globules dimension and 
allow its uniform distribution in the sample.
1.2.4  Readout Electronics
The multichannel PCB designed to interface 15 SVs was connected to an 
amplifier with an operating gain of 5000×, a high-pass and low-pass filter 
of 300 Hz and 10 kHz, respectively. Each channel included a configurable dc 
source, from 0.25 to 2 mA (Costa et al., 2014).
In this work, only one sensor per channel was monitored. One syringe 
pump was attached to the system, and was the only device not operating 
under dc batteries (thus, introducing the 50 Hz noise from the main power 
grid). The sensor output signals were recorded over time using a connection 
to an acquisition setup composed of a 16 bit analog-to-digital converter (ADC 
board DT9836-12-2-BNC), at 50 kHz acquisition frequency. The resulting dig-
ital signals were then post-processed in a software developed in MATLAB, 
to apply a low-pass digital filter with a cut-off frequency of 2 kHz, allow-
ing real-time noise characterization and data storing in the hard drive for 
further analysis (Figure 1.4). The sensors used for this work showed a noise 
level of 2.5–4 µV (peak-to-peak). During the experiments, the pump opera-
tion increased the noise level to 3–4.5 µV.

11
Biosensor Application for Bovine Mastitis Diagnosis
1.2.5  Biological Functionalization of Nanoparticles
This dynamic detection approach is based on the detection of the fringe field 
created by magnetic particles attached to the bacterial cells. By selecting suitable 
antibodies (Ab) (or immunoglobulins [Ig]), it is possible to perform immunolog-
ical recognition of the targeted mastitis pathogens. The specificity of selected 
antibodies was tested and proved by immunoblotting (data not shown).
One general differentiation of the streptococci is the Lancefield groups 
based on serological grouping determined by the antigen C-substance that is 
a group-specific cell wall polysaccharide. S. agalactiae belongs to Lancefield 
Group B (GB). A polyclonal anti-GB streptococci immunoglobulin G (IgG; 
8435-2000, AbDSerotec), one monoclonal anti-S. agalactiae immunoglobu-
lin M (IgM; MA1-10871, Thermo Fisher), a rabbit polyclonal IgG to S. aureus 
ScpA protein (ab 92983, Abcam), and a mouse monoclonal IgM anti-S. aureus 
ATCC 29740 (MCA 5793, AbDSerotec—which also recognizes S. epidermidis), 
were used separately. The antibodies were expected to attach to protein A of 
Nanomag®-D-spio 50 nm particles (79-20-501, MicromodPartikeltechnolo-
gie GmbH) by the Fc fraction (fragment crystallizable region) in IgG and by 
the joining chain (J chain) in IgM (Figure 1.5). Antibodies and bacterial cells 
dimensions are shown in Figure 1.5.
The bio-functionalization of NP was achieved by the addition of 7.27 μL 
from the NP original vial (with 5.5 × 1013 NP per mL) to 0.53 μL of polyclonal 
anti-GB streptococci antibody (1 mg/mL) (or to 5.5 μL of monoclonal anti-S. 
agalactiae antibody [0.5 mg/mL]) in 492.2 µL (or 487.2 µL) of phosphate buff-
ered saline buffer (PBS), or to 1.08 μL of pAb anti-S. aureus (0.5 mg/mL) (or 
to 2.65 μL of mAb anti-Staphylococcus spp. [1 mg/mL]) in 492.2 µL of PBS (or 
in 490.08 µL for mAb), respectively. The incubation step required 1 h RT and 
continuous agitation. Final functionalized NP were magnetically isolated by 
magnetic separation (MS) column (130-042-201 Miltenyi) according to MACS 
MiltenyiBiotec protocol and eluted with PBS + 0.5% bovine serum albumin 
(BSA) + 2 mM ethylenediaminetetraacetic acid (EDTA) buffer after removal 
of the MS column from the magnet. A volume of 2 µL of this final suspension 
DAC board
Syringe
pump
Milk samples
8 x 1.5 V
batteries
PCB’s outputs
Ampliﬁers
and ﬁlters
Inlet and outlet
tubes
(a)
(b)
FIGURE  1.4 
(a) Acquisition setup assembly and (b) multichannel PCB connected to external electronics.

12
Magnetic Sensors and Devices
with 8 × 106 functionalized NP was diluted in 98 µL of phosphate buffered 
saline Tween (PBST) and added to each milk sample with bacteria.
1.2.6  Biosensor Calibration
A blank sample (only PBS or sterile raw milk) and a negative control sample 
(PBS or sterile raw milk), with 2 µL of functionalized NP were always mea-
sured prior to the measurements with contaminated milk, giving the back-
ground signal of the system.
A first calibration assay was then made with S. agalactiae/pAb anti-GB 
streptococci spiked on a PBS sample.
Finally, S. agalactiae/pAb anti-GB streptococci, S. uberis/pAb anti-GB strep-
tococci, and S. agalactiae/mAb anti-S. agalactiae were spiked in sterile milk 
samples and the correspondent calibration curves made. Each concentration 
point was the result of three different assays’ measurements.
The calibration range between 0.1 and 20 CFU/µL was established tak-
ing into account the detection limit for conventional microbiology of 500 
CFU/mL (0.5 CFU/µL).
1.2.7  Bacterial Cells
S. agalactiae (strain CECT 183) and S. uberis (strain CECT 994) cells were grown 
separately onto Columbia agar supplemented with 5% sheep blood (bioMéri-
eux, 43021) and incubated at 37°C overnight. A single colony of each isolate 
was selected and resuspended in 4 mL of Trypticase soy broth over 24 h at 
37°C. Subsequently, the bacterial cells were collected through centrifugation 
(15 min, 17°C, 2700 rpm) and resuspended in PBS 1X (pH 7.2) to allow optical 
density measurement (at 600 nm) (BECKMAN DU-68 Spectrophotometer) 
and for colony-forming unit (CFU) estimation. A bacterial suspension with a 
(a)
(b)
(c)
Cells
0.6–1 mm
15 nm
30 nm
lgG
Fc fraction
lgM
J chain
Anti-group B streptococci
polyclonal antibody
Protein A
Immunogenic proteins
50 nm superparamagnetic
particle
Anti-Streptococcus agalactiae
monoclonal antibody
Streptococcus
agalactiae
cell
Functionalized
nanobeads
Functionalized
nanobeads
FIGURE  1.5 
Schematics of immunomagnetic detection of cells. (a) Incubation of functionalized beads with 
bacterial cells; (b) biological affinities between different functionalized nanoparticles with 
bacterial cell wall immunogenic proteins; (c) predictable protein A binding site to each anti-
body. (Adapted from Duarte, C.M. et al., Biosensors , 6(2), 19, 2016.)

13
Biosensor Application for Bovine Mastitis Diagnosis
known concentration of 104 CFU/µL was the starting point to get seven dif-
ferent bacterial concentrations for each species, in PBS or in raw milk sam-
ples: 0.1, 0.3, 0.5, 1, 2, 10, and 20 CFU/µL.
1.2.8  Sterile Milk Samples
Raw milk used for the definition of calibration curves experiments was col-
lected aseptically from healthy cows. Conventional microbiological tests 
were performed according to the National Mastitis Council protocols (NMC, 
1999), to confirm no bacterial growth. Briefly, a raw milk sample (10 μL) was 
plated on a Columbia agar plate and on a MacConkey agar plate (CM0007, 
Oxoid) and both were incubated at 37°C for 48 h. The absence of growth on 
both plates was considered to be equivalent to the presence of no viable bac-
teria in the milk.
Each sample for biosensor testing had a 500 µL volume consisting of 2 µL 
of a suspension of functionalized NP, 98 µL of PBST, and 400 µL of one of 
seven bacterial suspensions with predefined bacterial concentrations in PBS 
or sterile raw milk. The incubation of these samples was performed at RT for 
3 h under agitation.
All raw milk samples were submitted to a pretreatment of 15 min at 60°C 
in a dry bath incubator (Grant, model QBD2) and 15 min of continuous cen-
trifugation in a vortex mixer (Labnet) after adding bacteria and PBST. Only 
then, 2 µL of functionalized NP suspension was added for the final incuba-
tion step.
1.2.9  Mastitic Milk Samples
Mastitic milk samples were needed to validate biosensor detection. In these 
instances, milk samples were collected aseptically from the cows (n = 81) of 
12 Portuguese dairy farms. Animal selection was based on SCC higher than 
1,000,000 cells/mL and quarter selection based on CMT results with a score of 
3. The quarter was the experimental unit considered (n = 95). Bacteriological 
identification was performed as previously mentioned. Milk sample selec-
tion was based on bacteriological results that included S. aureus (n = 10), 
S. agalactiae (n = 16), S. uberis (n = 12), Streptococcus spp. (n = 5), coagulase-neg-
ative staphylococci (CNS) (n = 13), Enterococcus spp. (n = 11), Escherichia coli 
(n = 10), yeasts (n = 9), and Prototheca (n = 9). All mastitic milk samples were 
also submitted for PCR analysis.
1.2.10  PCR Reference Method Analysis
PCR analysis was performed by an external laboratory (VACUNEK, SL) with 
the PathoProof Mastitis Complete-16® (Thermo Scientific), which allows for 
the detection of 16 bovine mastitis pathogens. This method is semi-quanti-
tative, classifying the amount of bacterial cells in mastitic milk samples as 
“high,” “average,” or “low.”

14
Magnetic Sensors and Devices
1.2.11  Biosensor Analysis
A volume of 400 µL of mastitic milk was collected and mixed with 98 µL of 
PBST. Each 498 µL sample was submitted to a pretreatment of heating (15 
min at 60°C) and homogenization (15 min in vortex). After these steps, a 
volume of 2 µL of a functionalized NP suspension was added to reach a final 
volume of 500 µL to be submitted for incubation (RT, 3 h, under agitation) 
and further biosensor analysis.
The magnetic detection validation was performed with 95 different mas-
titic milk samples, consisting on 124 independent trials with four specific 
antibodies (four groups of 31 milk samples analyzed by specific antibodies 
as shown in Figure 1.6).
Each assay began with a noise level measurement (Figure 1.7) and each 
sample was injected at a flow rate of 50 µL/min, through a PDMS microchan-
nel (Figure 1.7). The microchannel was always cleaned between samples with 
PBST followed by deionized water, both at a 90 µL/min flow rate, until reach-
ing noise level values again, denoting a magnetic-free microchannel filling. 
A blank sample and a negative control sample were measured whenever a 
new SV sensor was used and always before mastitic samples analysis.
Samples with functionalized NP on PBS or sterile milk (negative con-
trols) evidenced signals less than 50 µV (Figures 1.8a and 1.9a). Mastitic milk 
16
14 samples tested only with
15 samples tested only with
16 samples tested only with
11 samples tested only with
8435-2000
anti-group B
Streptococcus
MA1-10871
anti-S. agalactiae
MCA 5793
anti-Staphylococcus
spp.
Ab 92983
anti-S. aureus
1
2
2
13
FIGURE  1.6 
Number of mastitic samples analyzed per antibody. The interception numbers correspond to 
the common samples analyzed by respective antibodies. (Adapted from Duarte, C.M., Portable 
“ Lab-on-Chip”  Platform for Bovine Mastitis Diagnosis in Raw Milk . Lisbon, Faculdade de Medicina 
Veteriná ria: Universidade de Lisboa, 2016.)

15
Biosensor Application for Bovine Mastitis Diagnosis
samples without the targeted bacteria (proved by PCR) and tested with NP 
functionalized with chosen antibodies, also evidenced signals less than 50 
µV. Samples used for calibration assays spiked with bacterial cells on sterile 
milk showed magnetic signals greater than 50 µV (Figures 1.8b and 1.9b).
The classification of mastitic milk samples by the biosensor was based 
on bacterial detection (presence or absence). Consequently, the “Positive” 
samples were those with at least one magnetic peak above 50 µV, therefore 
higher than the signal found in negative control samples and in mastitic 
Sensor voltage (mV)
Time (s)
noise < 4 mV
Step 1: Measure 
system background 
noise 
Sensor voltage (mV)
Time (s)
Step 2: Measure 
sensor output while 
milk samples ﬂow 
inside channel at 50 
mL/min  
Step 3: Clean channel with  
PBST + DI water at 90 mL/min 
FIGURE  1.7 
Biosensor analysis procedure steps.
–10
23.3412
23.3418
Time (s)
(a)
(b)
0
10
Sensor voltage output variation (mV)
–1000
8.253
8.254
8.255
8.256
Time (s)
–800
–600
–400
–200
0
200
Sensor voltage output variation (mV)
20
FIGURE   1.8 
Sensor output for (a) negative control with the higher amplitude of 23  µ V, and the highest 
amplitude peak of (b) 923.7  µ V was obtained in raw milk with anti-S. agalactiae  and 0.3 CFU/µ L 
of S. agalactiae . (Adapted from Duarte, C.M. et al., Biosensors , 6(2), 19, 2016.)

16
Magnetic Sensors and Devices
milk samples without targeted bacteria. Next, this “Positive” sample mag-
netic peak evidenced a bipolar or unipolar shape similar to those found in 
samples used for calibration trials, as shown in Figures 1.8b and 1.9b.
Biosensor analysis was a dynamic detection where a heterogeneous milk 
sample flowed inside the microchannel. Magnetically labeled bacterial cells 
were randomly mixed in milk leading to the impossibility of predicting 
its position above the sensor over time. Consequently, the magnetic peaks 
shape and time resulting from biosensor analysis were expected to be differ-
ent between samples (Figures 1.8 and 1.9).
1.2.12  Data Analysis
Isolates were considered to be correctly identified by magnetic detection 
if the same species was found by the reference method, or if the magnetic 
detection did not identify the species it was targeting and PCR identified 
one of the other bacteria. For example, a correct identification referred to S. 
agalactiae being identified magnetically in a sample that PCR had identified 
as S. agalactiae, but also when not identifying as S. agalactiae a sample that 
through PCR was identified as Staphylococcus spp. Regarding conventional 
microbiology, isolates were considered to be correctly identified if the same 
species was found as with the reference method. Misidentification was con-
sidered when the magnetic detection and conventional microbiology identi-
fied a different species than the reference method. For example, a sample 
that was identified as Staphylococcus spp. by PCR and that was identified 
as S. agalactiae by magnetic detection or a sample that was identified as S. 
agalactiae by PCR and not identified as such by magnetic detection. For both 
magnetic detection and conventional microbiology methods, sensitivity, 
(b)
Time (s)
–1200
–1000
–800
–600
–400
–200
0
200
400
600
800
1000
9.302
9.303
9.304
Sensor voltage output variation (mV)
–10
23.3406
23.3415
23.3424
Time (s)
(a)
0
10
20
Sensor voltage output variation (mV)
–1400
FIGURE   1.9 
Sensor output for (a) negative control with the higher amplitude of 23  µ V, and the highest 
amplitude peak of (b) 1703.4  µ V was obtained in raw milk with pAb anti-S. aureus  and 10 
CFU/µ L of S. aureus . (Adapted from Duarte, C.M. et al., Journal of Dairy Research , 23, 1– 9, 2016.)

17
Biosensor Application for Bovine Mastitis Diagnosis
specificity, and positive predictive value were calculated in comparison 
with PCR species identification. Sensitivity was calculated as the propor-
tion of true positive isolates that were correctly identified with magnetic 
detection or microbiological tests, for example, the proportion of S. agalactiae 
isolates based on PCR analysis that were identified as such by magnetic 
detection and microbiology testing. Specificity was calculated as the pro-
portion of true negatives that were correctly identified with magnetic detec-
tion and microbiological tests, for example, the proportion of isolates other 
than S. agalactiae based on PCR analysis that were identified as something 
other than S. agalactiae by magnetic detection and by microbiological test-
ing. Finally, PPV was calculated as the proportion of isolates identified as 
a specific species based on magnetic detection or on microbiological test-
ing that truly represented that particular species, for example, the propor-
tion of isolates that were identified as S. agalactiae by magnetic detection 
or microbiological testing that had been identified as S. agalactiae based on 
PCR analysis.
1.3  Results
1.3.1  Evaluation of Biosensor’s Bacterial Quantification
The outcome of the calibration trials are shown in Figures 1.10 and 1.11 for 
Streptococcus and Staphylococcus species, respectively. The peak’s number 
per signal amplitude was calculated evidencing no linear correlation with 
increasing bacterial concentration, in both calibration sets. The milk sam-
ples with the anti-GB streptococci antibody revealed the most exuberant 
signal with S. uberis when compared with the other two bacteria–antibody 
pairs (Figure  1.10). Only the S. agalactiae/pAb anti-GB streptococci pair 
evidenced no peaks higher than 200 µV. Despite that, these MR sensors 
could detect S. agalactiae and S. uberis in milk samples from 0.1 CFU/µL 
(100 CFU/mL).
The milk samples with functionalized NP with the anti-Staphylococcus spp. 
antibody evidenced the highest peak number with S. epidermidis when com-
pared with the other two bacteria–antibody pairs (Figure 1.11). Overall, the 
biosensor could detect S. aureus and S. epidermidis in milk samples from 100 
CFU/mL.
The calibration curve for PBS samples with bacteria was only obtained for 
the S. agalactiae/pAb anti-GB streptococci pair. It was evidenced that different 
bacterial concentrations, as in sterile milk, also presented similar amplitude 
peaks (under 200 µV). Performing experimental data fitting to simulations 
for cell quantity estimation by peak, we obtained different results depend-
ing on the considered functionalized NP number per cell and cells cluster 
positioning above the MR sensor (height z) (Figure 1.12b and c).

18
Magnetic Sensors and Devices
1.3.2  Validation of Magnetic Detection with mAb Anti‑S. 
agalactiae and pAb Anti-GB Streptococci
Forty-six mastitic milk samples with known bacteriology results, obtained 
through conventional microbiology, were analyzed by PCR. A total of 160 
identifications were performed by PCR for all 46 milk samples analyzed with 
mAb anti-S. agalactiae and pAb anti-GB streptococci. The most frequently iso-
lated species based on PCR were Staphylococcus spp., E. coli, and yeasts, fol-
lowed by S. uberis and S. agalactiae. As a result of the high sensitivity of the 
PCR methodology, an average of four different pathogens were detected per 
mastitic milk sample, not allowing for the true causative agent of mastitis to 
be determined. Therefore, it was decided to use conventional bacteriology 
results as the basis for the true identification, confirmed by PCR (Table 1.2).
Magnetic detection with the anti-S. agalactiae antibody tested 31 mastitic 
milk samples from the total of 46 analyzed by conventional microbiology, 
of which 10 and 13 were identified as S. agalactiae, respectively (Table 1.2). 
However, from these 31 samples tested, 11 were identified as S. agalactiae by 
PCR and only 1 was not identified as such by microbiology, but as S. uberis. 
Magnetic detection with the anti-S. agalactiae antibody identified 8 S. aga-
lactiae isolates correctly in 11 (72.7%) milk samples with this species when 
0 0.1 CFU/mL
Bacterial concentration in sterile milk
Peak number average
3
8
3
Ab8435_S. agalactiae
Ab8435_S. uberis
Ab MA1_S. agalactiae
0.3 CFU/mL
3
22
2
0.5 CFU/mL
4
26
2
1 CFU/mL
10
23
6
2 CFU/mL
5
5
12
10 CFU/mL
2
103
13
20 CFU/mL
2
24
8
5
10
15
20
25
30
35
40
45
50
FIGURE   1.10 
Calibration trial results for milk samples with seven bacterial concentrations (S. agalactiae  or S. 
uberis ) and functionalized NP with pAb anti-GB streptococci  (Ab 8435) and mAb anti-S. agalac-
tiae  (Ab MA1). The peak number average for each bacteria– antibody pair is counted. (Adapted 
from Duarte, C.M. et al., Biosensors , 6(2), 19, 2016.)

19
Biosensor Application for Bovine Mastitis Diagnosis
compared to PCR. Five mastitic milk samples did not lead to an identification 
by this polyclonal antibody because they did not present S. agalactiae accord-
ing to the PCR analysis (true negatives) (Table 1.3). Misidentification was 
observed for 18 of 31 (58%) isolates in the 31 mastitic milk samples tested with 
the anti-S. agalactiae antibody (Table 1.2). Only three misidentified S. agalac-
tiae isolates were found in milk samples with this species analyzed by PCR, 
evidencing a failure of recognition by this monoclonal antibody (Table 1.2). 
Adding to that, 5 mastitic milk samples with S. uberis and/or S. dysgalac-
tiae and 10 mastitic milk samples without any streptococci species according 
to the PCR analysis were misidentified by biosensor analysis as having S. 
agalactiae and all were classified as false positives (Table 1.3). Overall, 73% 
sensitivity, 25% specificity, and 35% PPV were found for magnetic detection 
with the anti-S. agalactiae antibody. The highest sensitivity value represents 
the proportion of true positives (8) that were correctly identified with this 
monoclonal antibody (Table 1.3).
Using the polyclonal anti-GB streptococci in magnetic detection, the 31 
mastitic samples tested included 16 identified equitably as S. agalactiae and 
S. uberis by conventional microbiology (Table 1.2). However, PCR analysis 
identified 2 more samples as S. uberis in the 31 analyzed by this antibody, 
amounting to 18 bacterial target possibilities. Magnetic detection with the 
anti-GB streptococci antibody correctly identified 7 streptococci isolates pres-
ent in 18 (38.9%) milk samples with S. agalactiae and/or S. uberis according to 
Bacterial concentration in sterile milk
Peak number average
0 0.1 CFU/mL
9
42
14
Ab 92983_S aureus
Ab MCA 5793_S aureus
Ab MCA 5793_S epidermidis
10
0.3 CFU/mL
5
10
13
0.5 CFU/mL
4
1
1
1 CFU/mL
8
6
4
2 CFU/mL
2
13
62
10 CFU/mL
4
4
75
20 CFU/mL
10
5
11
20
30
40
50
60
70
80
FIGURE   1.11 
Calibration trial results for milk samples with seven bacterial concentrations (S. aureus  or S. 
epidermidis ) and functionalized NP with pAb anti-S. aureus  (Ab 92983) or mAb anti-Staphylococ-
cus  spp. (Ab MCA 5793). The peak number average for each bacteria– antibody pair is counted. 
(Adapted from Duarte, C.M. et al., Journal of Dairy Research , 23, 1– 9, 2016.)

20
Magnetic Sensors and Devices
PCR analysis. The microorganisms that were not identified as GB strepto-
cocci or S. uberis (13/31) by the reference method in mastitic milk samples 
were magnetically detected as GB streptococci and/or S. uberis in those sam-
ples (5 false positives) or else undetected as true negatives (8) (Table 1.3). 
Misidentification was observed for 16 isolates in the 31 (51.6%) mastitic sam-
ples tested. Eleven misidentified S. agalactiae and S. uberis isolates were found 
in milk samples analyzed by PCR with these two streptococci, evidencing a 
–200
–100
31.1056
100×
(a)
(b)
(c)
31.1064
0.5 CFU/mL
Time (s)
902 bacterial cells
952 NP/cell
z = 15 mm
31.1072
0
Sensor voltage output (mV)
100
200
–200
–100
20.6536
20.6544
Time (s)
132 bacterial cells
397 NP/cell
z = 2 mm
20.6552
0
Sensor voltage output (mV)
100
200
10 mm
5 mm
0 mm
–5 mm
5 mm
5 mm
10 mm
X axis
Y axis
0.0
0.0
10 mm
5 mm
0 mm
–5 mm
5 mm
0.0
5 mm
X axis
Y axis
0.0
–5 mm
0.5 CFU/mL
FIGURE   1.12 
Microscopic image of S. agalactiae  cells where a spherical cluster and an elongated cluster are 
evidenced (a). Experimental data fitting of the highest amplitude peaks obtained in PBS sam-
ples with different S. agalactiae  concentrations (0.5  CFU/µ L: 162  µ V (b) and 10 CFU/µ L: 146 µ V 
(c)) during calibration curve settlement. (Adapted from Duarte, C.M. et al., Biosensors , 6(2), 19, 
2016.)

21
Biosensor Application for Bovine Mastitis Diagnosis
failure of recognition by this polyclonal antibody (Table 1.2). Overall, a sensi-
tivity of 41%, a specificity of 57%, and a PPV of 54% were found for magnetic 
detection with the anti-GB streptococci antibody. The highest specificity 
value represents the proportion of true negatives (8) that were correctly iden-
tified with this polyclonal antibody (Table 1.3).
TABLE  1.2 
Identification of Isolates in Mastitic Milk Samples with Both Magnetic Detection 
(mAb anti-S. agalactiae ; pAb anti-GB streptococci ) and Conventional Microbiology, 
Compared to PCR Analysis as the Reference Method
Mastitic Milk 
Isolates 
Magnetic Detection 
Microbiological 
Tests 
Anti- S. agalactiae  
Anti-GB  
Streptococci  
Correctly 
Identified 
Correctly 
Identified 
Correctly 
Identified 
n  
n  
% 
MI a  
n  
% 
MI 
n  
% 
MI 
S. aureus 
1
0
0.0
0
1
100.0
0
0
0.0
1
S. agalactiae 
13
7
70.0
3
2
25.0
6
13
100.0
0
S. uberis 
11
3
33.3
6
5
62.5
3
8
72.7
3
Streptococcus  spp.
4
0
0.0
3
2
50.0
2
1
25.0
3
Staphylococcus  spp.
2
0
0.0
0
1
50.0
1
2
100.0
0
Enterococcus  spp.
7
3
75.0
1
1
33.3
2
0
0.0
7
Escherichia coli 
3
0
0.0
1
1
50.0
1
3
100.0
0
Yeasts
3
0
0.0
2
1
100.0
0
2
66.7
1
Prototheca 
2
0
0.0
2
1
50.0
1
2
100.0
0
Total
46
13
41.9
18
15
48.4
16
31
67.4
15
Source: 	 Duarte, C.M. et al., Biosensors , 6(2), 19, 2016a.
Note: 	
Correctly identified  =  true positives  +  true negatives.
a 	 MI (Misidentified) = false negatives + false positives.
TABLE  1.3 
Sensitivity, Specificity, and Positive Predictive Value of Magnetic Detection and 
Conventional Microbiology, Using PCR Analysis as the Reference Method
Magnetic Detection 
Microbiological 
Tests 
Anti- S. agalactiae  
Anti-GB  Streptococci  
True positives
8
7
31
True negatives
5
8
0
False positives
3
10
0
False negatives
15
6
15
Sensitivity
73%
41%
100%
Specificity
25%
57%
– 
PPVa 
35%
54%
67%
Source :	  Duarte, C.M. et al., Biosensors , 6(2), 19, 2016.
a	 PPV  =  positive predictive value.

22
Magnetic Sensors and Devices
With regard to microbiological testing for all 46 samples analyzed with 
mAb anti-S. agalactiae and pAb anti-GB streptococci, the highest microor-
ganism identification, in comparison with PCR analysis, was found to be 
100% for S. agalactiae, Staphylococcus spp., E. coli, and Prototheca, as shown in 
the percentage data of correct identification in Table 1.2. However, incom-
plete microbiological identification of 67.4% (31/46) and a misidentification 
of 32.6% (15/46) were observed (Table 1.2). Microbiological tests evidenced a 
PPV value of 67% and a sensitivity of 100% to identify mastitis pathogens in 
milk samples, showing that conventional microbiology correctly identified 
true negatives (Table 1.3).
1.3.3  Validation of Magnetic Detection with mAb Anti-
Staphylococcus spp. and pAb Anti-Staphylococcus aureus
Forty-nine mastitic milk samples with known bacteriology results, obtained 
through conventional microbiology, were analyzed by PCR. A total of 123 
agent identifications were attained by PCR for all 49 milk samples ana-
lyzed with mAb anti-Staphylococcus spp. and pAb anti-S. aureus. The species 
detected by PCR were, in decreasing order of detection, Staphylococcus spp., 
S. aureus, yeasts, and E. coli, followed by S. uberis and Prototheca. As a result 
of the high sensitivity of the PCR methodology, an average of three differ-
ent pathogens were detected per mastitic milk sample, not allowing for the 
true causative agent of mastitis to be determined. Therefore, it was decided 
to use conventional bacteriology results as the basis for true identification, 
confirmed by PCR (Table 1.4).
Magnetic detection with the anti-S. aureus antibody tested 31 mastitic milk 
samples from the total of 46, of which 6 and 9 were identified as S. aureus by 
conventional microbiology, respectively (Table 1.4). However, of these 31 sam-
ples tested, 7 were identified as S. aureus by PCR and the one not identified 
as such by microbiology was Prototheca. Magnetic detection with the anti-S. 
aureus antibody identified four S. aureus isolates correctly out of seven (57.1%) 
milk samples with this species according to PCR results. Eighteen mastitic 
milk samples did not lead to an identification by this polyclonal antibody 
as they did not present S. aureus according to the PCR, thus being true nega-
tives (Table 1.5). Misidentification was observed for 9 of 31 (29%) isolates in all 
mastitic milk samples tested with the anti-S. aureus antibody (Table 1.4). Only 
three misidentified S. aureus isolates were found in milk samples with this 
species analyzed by PCR, evidencing a failure of recognition by this monoclo-
nal antibody (Table 1.4). Adding to that, the remaining six mastitic milk sam-
ples were misidentified as having S. aureus (Table 1.4), while really presenting 
S. uberis, yeasts, S. agalactiae, and other Staphylococcal species according to 
PCR. Overall, 57.1% sensitivity, 75% specificity, and 40% PPV were found for 
magnetic detection with the anti-S. aureus ScpA antibody. The highest speci-
ficity value represents the proportion of true negatives (18) that were correctly 
identified with this monoclonal antibody (Table 1.5).

23
Biosensor Application for Bovine Mastitis Diagnosis
TABLE  1.4 
Identification of Isolates in Mastitic Milk Samples with Both Magnetic Detection 
(pAb anti-S. aureus ; mAb anti-Staphylococcus  spp.) and Conventional Microbiology, 
Compared to PCR Analysis as the Reference Method
Mastitic Milk 
Isolates 
Magnetic Detection 
Microbiological 
Tests 
Anti- S. aureus  
Anti-  
Staphylococcus   
spp. 
Correctly 
Identified 
Correctly 
Identified 
Correctly 
Identified 
n  
n  
% 
MI a  
n  
% 
MI 
n  
% 
MI 
S. aureus 
9
3
50.0
3
5
83.3
1
9
100.0
0
Staphylococcus  spp.
11
6
75.0
2
5
71.4
2
10
90.9
1
S. agalactiae 
3
2
66.7
1
3
100.0
0
3
100.0
0
S. uberis 
1
1
100.0
0
1
100.0
0
1
100.0
0
Streptococcus  spp.
1
0
0.0
1
0
0.0
0
0
0.0
1
Enterococcus  spp.
4
1
33.3
2
1
100.0
0
0
0.0
4
E. coli 
7
2
100.0
0
4
80.0
1
7
100.0
0
Yeasts
6
4
100.0
0
3
100.0
0
4
66.7
2
Prototheca 
7
3
100.0
0
2
40.0
3
7
100.0
0
Total
49
22
71.0
9
24
77.4
7
41
83.7
8
Source: 	 Duarte, C.M. et al., Journal of Dairy Research , 23, 1– 9, 2016.
Note:	 Correctly identified = true positives + true negatives.
a	 MI (misidentified) = false negatives + false positives.
TABLE  1.5 
Sensitivity, Specificity, and Positive Predictive Value of Magnetic Detection and 
Conventional Microbiology, Using PCR Analysis as the Reference Method
Magnetic Detection 
Microbiological 
Tests 
pAb Anti- S. aureus  
mAb 
Anti- Staphylococcal   spp. 
True positives
4
23
41
True negatives
18
1
0
False positives
3
6
1
False negatives
6
1
7
Sensitivity
57.1%
79.3%
97.6%
Specificity
75.0%
50.0%
– 
PPVa
40.0%
95.8%
85.4%
Source :	 Duarte, C.M. et al., Journal of Dairy Research , 23, 1– 9, 2016b.
a	 PPV  =  positive predictive value.

24
Magnetic Sensors and Devices
Using the monoclonal anti-Staphylococcus spp. antibody in magnetic detec-
tion, the 31 mastitic samples tested included 6 S. aureus and 7 Staphylococcus 
spp. identified by conventional microbiology (Table 1.4). However, PCR anal-
ysis identified 29 as Staphylococcus spp. of which 8 samples also evidenced 
S. aureus, showing incomplete identification by microbiological analysis. 
Magnetic detection with the anti-Staphylococcus spp. antibody correctly 
identified 23 staphylococci present in 29 (79.3%) milk samples with mostly 
staphylococci other than S. aureus, or also with S. aureus according to PCR 
analysis. Only one mastitic milk sample was not detected by this monoclonal 
antibody (true negative) because it did not present any Staphylococcus spp. 
according to PCR (Table 1.5). Misidentification was observed for 7 isolates 
out of the 31 (22.6%) mastitic samples tested. Six isolates were found in milk 
samples with Staphylococcal species analyzed by PCR, evidencing a failure of 
recognition by this anti-Staphylococcus spp. antibody (Table 1.4). Moreover, 
only one false positive was found in a mastitic sample without any staphylo-
cocci evidenced by PCR. Overall, a sensitivity of 79.3%, a specificity of 50%, 
and a PPV of 95.8% were found for magnetic detection with the anti-Staphy-
lococcus spp. antibody (Table 1.5).
Regarding microbiological testing for all 49 samples considered, 100% of 
S. aureus, S. agalactiae, S. uberis, E. coli, and Prototheca were correctly identified 
when comparing with PCR (Table 1.4). Incomplete microbiological identifica-
tion of 85.7% (42/49) and a misidentification of 14.3% (7/49) were observed. 
Microbiological tests evidenced a PPV value of 85.4% and a sensitivity of 
97.6% to identify mastitis pathogens in milk samples, showing that conven-
tional microbiology correctly identified true positives (41/49) (Table 1.5).
1.4  Discussion
Sensitivities of 73% and 41% and specificity values of 25% and 57% were 
obtained for the magnetic identification of streptococci species with an anti-
S. agalactiae antibody and an anti-GB streptococci antibody, respectively. With 
regard to the magnetic identification of staphylococci species in mastitic milk 
samples with an anti-S. aureus ScpA antibody and an anti-Staphylococcus spp. 
antibody, sensitivities of 57.1% and 79.3% and specificity values of 75% and 
50% were obtained, respectively.
The knowledge of S. aureus as an important cause of udder infections in 
dairy herds sustains the greatest interest in treatment and prevention stud-
ies of S. aureus mastitis (Fabres-Klein et al., 2014). So, comparing the sensitiv-
ity and specificity values of this magnetic detection with another study that 
used immunological detection of mastitis pathogens through an enzyme-
linked immunosorbent assay (ELISA) for detecting S. aureus in milk, a sen-
sitivity of between 69% and 90% and specificity values of 61%–97% (Hicks 

25
Biosensor Application for Bovine Mastitis Diagnosis
et al., 1994) were observed. That test had a detection limit of 104–105 CFU/mL, 
when the minimum bacterial presence detected by the present immunologi-
cal recognition was 100 CFU/mL, independently of antibody and targeted 
bacteria. Adding to that, a sandwich ELISA test recently patented to detect 
S. aureus in artificially contaminated milk (Libing et al., 2012), found a similar 
detection limit of 105 CFU/mL. However, a competitive immunoassay per-
formed by an amperometric magnetoimmunosensor (de Ávila et al., 2012) 
for the specific detection and quantification of Staphylococcal protein A and 
S. aureus cells, evidenced a detection limit of 1 CFU/mL, also in artificially 
contaminated milk samples.
Comparing again the sensitivity (41% and 73%; 57.1% and 79.3%) and speci-
ficity (25% and 57%; 50% and 75%) values obtained for the magnetic identi-
fication of streptococci and staphylococci species, respectively, with another 
study based on immuno-agglutination, which compared six commercially 
available slide agglutination tests for S. aureus identification in milk samples 
(Zschöck et al., 2005), the highest sensitivity (86.7%) and specificity (90.1%) val-
ues were obtained for a test consisting of latex particles coated with human 
fibrinogen and IgG. Still, strain typing methods that are DNA sequence 
based have also been used to improve S. aureus detection. The Bittar et al. 
(2009) study to differentiate between positive and negative S. aureus strains 
for Panton–Valentine leukocidin, used matrix-assisted laser desorption ion-
ization–time of flight mass spectrometry (MALDI-TOF MS) analysis, which 
evidenced higher sensitivity (100%) and specificity (90.6%) compared with 
our magnetic detection method.
Another method for the identification of bovine mastitis pathogens resorted 
to microarray technology, which was capable of detecting seven common 
species of mastitis-causing pathogens within 6 h, with an observed sensi-
tivity of 94.1% and a specificity of 100% (Lee et al., 2008). The platform used 
was based on PCR technology where pathogen-specific targets of DNA were 
amplified and transferred to react and hybridize with specific probes that 
were pre-spotted on a biochip. At the end of the process, colorimetric tech-
niques were used to identify pathogen patterns present on the sample. The 
detection limit of this method was 103–105 CFU/mL. Despite the advantage 
of using nucleic acid amplification strategies, which increase the sensitivity, 
specificity, and efficiency, these methods always required the pre-isolation 
of bacterial cells from milk, not allowing for the direct analysis of mastitic 
milk samples and, consequently, their use on-farm, unless the pretreatment 
step was incorporated inside the analysis system, reducing its time and cost.
According to Lazcka et al. (2007), in order to become attractive, biosensors 
first need to show that they are capable of reaching at least the same detection 
levels as traditional techniques (between 10 and 100 CFU/mL). Next, they 
need to do so in a fraction of time without overlooking cost. Currently, the 
detection limits of biosensors for on-site use are a hundred to a million cells 
per milliliter of sample (102–106 CFU/mL) and are able to achieve extremely 
high sensitivities (Yoon & Kim, 2012).

26
Magnetic Sensors and Devices
Regarding the validation of the magnetic detection method, some false 
positive results could be explained by NP agglomeration by the mastitic milk 
matrix heterogeneity, the sporadic low cleaning efficiency of the channel’s 
inlet chamber, and also due to the electrical conductivity of mastitic milk 
samples. An effect of bovine mastitis is the ion concentration changes in the 
mammary gland due to increased vascular permeability resulting from an 
inflammatory response, leading to modifications in the electrical conduc-
tivity of milk (Hovinen et al., 2006). The conductance in milk causes a sen-
sor’s resistivity variation translated by higher background noise. Despite a 
detergent (Tween 20) being in milk samples to reduce fat globules dimen-
sions, to distribute the bacterial cells in the milk, to improve NP mobiliza-
tion, and to allow a more homogeneous milk matrix, the optimization trials 
(not described in this chapter) showed the need for a compromise between 
Tween 20 quantity and magnetic peak discrimination. Different volumes of 
PBST in 500 µL of milk samples were used. The higher volumes (>100 µL) 
evidenced bubbles inside the microchannel that hampered the milk flow, 
caused NP agglomeration, and did not help magnetic peaks discrimination 
between control samples (milk with only NP) and samples with bacteria. 
On the other hand, false negatives may have occurred because of three cir-
cumstances. Firstly, the binding yield variations between antibodies and NP 
and/or failure in bacterial cells magnetic labeling could narrow bacterial 
cells identification. This fact should be recognized as possible because IgM 
and NP dimensions are closer, so it will be more difficult to have the same 
number of attached IgM when comparing with NP functionalization with 
smaller IgG. Secondly, according to Henriksen et al.’s (2015) study, it is pos-
sible that the rotating nature of the magnetic dipole field of NP magnetized 
by an external magnetic field can induce signal cancelation. Therefore, the 
fields from two differently placed NP can partially cancel each other. Finally, 
microchannel current height (50 µm) could be reduced to improve a sensor’s 
detection by forcing bacterial cells dragging over it, but mastitic milk trials 
showed that milk clots hamper sample flowing and height decrease leads to 
microchannel obstruction, pointing to a compromise between the sensor’s 
detection and sample fluidity.
As regards bacterial quantification data, this magnetic detection method 
showed some microbiological and immunological constraints. Bacterial cells 
group together randomly depending on growth conditions (Quinn et al., 1994). 
Each bacteria may express a different number of cell wall proteins, includ-
ing the immunogenic ones (van der Woude & Baümler, 2004). Together, these 
facts limit the knowledge of how many immunogenic proteins there are per 
cell and, consequently, how many proteins will be recognized by each spe-
cific antibody used. On the other hand, the chemical and colloidal changes 
of milk components in a state of inflammatory response (Walstra et al., 2006) 
as occurs with mastitis, prevent and reduce bacterial magnetic labeling effi-
cacy (Duarte et al., 2016a). Consequently, it was not possible to predict peak 
profiles (number, shape) for each bacterial concentration.

27
Biosensor Application for Bovine Mastitis Diagnosis
Although the sensitivity of the magnetic detection method is important, 
many additional factors must be considered, including rapidity, easy to use, 
flexibility, portability, and costs (Mortari & Lorenzelli, 2014). This dynamic 
methodology showed that it was possible for a mastitic milk sample to be 
processed until a final result was obtained in 5 h, but was not suitable for 
processing a large number of samples (maximum of 10–12 per day). It also 
showed technical simplicity when established, and ease of scoring and inter-
preting the results. Despite the lower sensitivities obtained, both antibodies 
used were capable of detecting bacterial cells in real milk samples. However, 
other antibodies could be used for further identification of different bovine 
mastitis pathogens, reinforcing this method’s flexibility.
Therefore, despite the need for improvements in bacteriological infection 
screening and considering the low values for sensitivity and specificity, the 
magnetic detection method that the current study describes, may be a tool in 
the future to complement traditional methods in the identification of some 
important mastitis pathogens. Data gathered from this work, including the 
minimum bacterial concentration detected (100 CFU/mL), may provide a 
useful tool for rapid on-farm diagnosis of mastitis pathogens, contributing to 
both improving animal health and welfare and rationalizing and reducing 
the use of antibiotics, with positive effects on the economy of dairy farming 
and on public health.
1.4.1  Strengths, Weaknesses, Opportunities, and Threats
The two main strengths of this magnetic detection method are the successful 
evidence of immunological recognition of targeted bacteria by the specific 
antibodies used, and the NP attachment to selected antibodies on positive 
milk samples (sterile milk with functionalized NP and spiked with known 
bacterial concentration) when compared to the control samples (sterile milk 
with only functionalized NP).
Despite this, bacterial quantification is a limitation as there is a lack of 
knowledge of how many immunogenic proteins are expressed per cell, and 
consequently, how many proteins will be recognized by each specific anti-
body used. Simulations reported in Jitariu et al. (2016) can partially support 
the experimental results, were helpful for the peak’s amplitude and shape 
interpretation, without the assurance of bacterial cells number.
Loureiro et al.’s (2011) study describes an accurate way to extrapolate cell 
numbers from a known saturation moment of NP of a sample using a hemo-
cytometer. Unfortunately for us, that model fits well with single human cells 
from the acute myeloid leukemia cell line, but not with bacterial clusters.
The number of NP attached to bacterial cells due to the interaction between 
the specific antibody and the immunogenic cell wall protein depends pri-
marily on the number and distribution of the different antigens over the 
bacterial cell’s surface. Even knowing the saturation moment of one NP 
(2.7 × 1018 Am2), it was not possible, in our working case, to extrapolate the 

28
Magnetic Sensors and Devices
average number of NP per bacterial cluster because we could not know the 
total number of cells in it.
Adding to this, neighboring cells to bacterial clusters probably could not be 
magnetically identified. This second method’s weakness is explained by the 
rotating nature of the magnetic dipole field of NP magnetized by an external 
magnetic field, which can induce signal cancelation (Henriksen et al., 2015). 
Therefore, the magnetic fields from two differently placed NP could par-
tially cancel each other.
Nevertheless, we can identify five opportunities to improve the developed 
magnetic method. The first one is about the biosensor’s suitability for routine 
diagnosis, meaning its applicability to large numbers of milk samples. The 
current number of analyzed samples is 10–12 per day. The external perma-
nent magnet positioned below the 28 sensors (7 per microchannel) creates a 
magnetic field that affects its transfer curves and sensitivities, except for one 
sensor focused by the magnet for correct positioning. Thus, only one micro-
channel can be used, from four available, limiting to one the sample analysis 
rate. To correct this issue, present research on this topic toward multiplexing 
includes varying the magnet’s type and strengths and also its relative dis-
tances to a sensor’s PCB (Soares, 2015). However, for the magnet optimal dis-
tance found (2 cm), corresponding to unchanged transfer curves for every 28 
SVs, an NP size of 130 nm or more was needed to be magnetically detected, 
because of the weak magnetic fringe field from smaller particles. Further 
optimization trials could be done to confirm bacterial identification in mas-
titic milk samples with these larger NP (higher volume), but inherent bind-
ing yield issues should be expected.
The biosensor’s flexibility is the second opportunity for improvement, 
which includes using other specific antibodies for further identification of 
other important bovine mastitis pathogens.
Thirdly, the binding yield variations of NP functionalization could also 
be enhanced. The difficulty of having the same number of attached IgM (30 
nm) to an NP (50 nm) is predictable when compared to smaller IgG (15 nm), 
which is translated by uncontrollable binding yield variation. This issue is 
justified by both antibodies stereochemistry and NP volume, which are not 
possible to change. Consequently, it affects bacterial cells magnetic label-
ing efficiency. However, there are some methods that can be used, such as 
thermogravimetric analysis, which applied to a functionalized NP solution, 
will be able to extrapolate the weight for antibodies and NP in a sample and, 
consequently, to quantify the binding yield. The thermogravimetric method 
consists of a thermal analysis that changes the physical and chemical prop-
erties of materials measured, as a function of increasing temperature (with 
constant heating rate) or as a function of time (with constant temperature 
and/or constant mass loss). This method is commonly used to determine 
the selected characteristics of materials that exhibit either mass loss or gain 
due to decomposition, oxidation, or loss of volatiles (such as moisture). The 
inconvenience of this analysis in our case, was the minimum quantity of 

29
Biosensor Application for Bovine Mastitis Diagnosis
sample required. Forty milligrams was too much when compared to 364.03 
µg in solution per trial day when we used IgG antibodies or 366.25 µg in 
solution per trial day when we used IgM antibodies, and the cost to obtain 
such higher quantity of functionalized NP, was also expensive.
The fourth magnetic method’s improvement opportunity includes the 
multichannel PCB electronic troubleshooting. The multichannel PCB was 
the main component of the magnetic detection device. Consequently, the 
identification of the causative problem was critical for further correction and 
continuing daily work. The major problem found was translated visually on 
signal output oscillations, which prevented further measurements.
Two threats were identified: the first one was based on the sterile and mastitic 
milk matrix heterogeneity. The first main goal of this project was the achieve-
ment of a portable lab-on-chip device, able to be used on-site and to analyze 
raw milk collected directly from a potentially infected cow. However, milk is a 
colloid of fat globules and water with dissolved carbohydrates and protein com-
plexes (Walstra, 2006), where bacteria, when present, are distributed throughout 
the emulsion, suspended in solution as well as entrapped and adsorbed on pro-
teins micelles and fat globules. This knowledge led us to several months of tri-
als with different experimental conditions, including thawing or filtering milk 
samples (pore diameter >2–3 µm) to remove fat globules from raw milk; rede-
signing the microchannel’s layout including pillars for milk sieving, to help fat 
globules to disperse; detergent/surfactant concentration (PBST) added to raw 
milk; temperature variation (4°C or RT) of milk samples with bacterial-labeled 
cells, before biosensor analysis; different bacterial concentrations spiked into 
sterile milk to achieve detection limit and NP content optimization in control 
milk samples for no magnetic signal achievement.
The thawing and filtering steps removed fat globules but also bacterial 
cells from mastitic milk samples. These hypotheses to improve magnetic 
detection in raw milk samples were thus abandoned.
We evidenced that we could not get away from a milk sample pretreatment 
step, even a short one, which should include higher temperature, surfactant 
addition, and stronger agitation, to reduce fat globule dimensions, to distrib-
ute the bacterial cells in the milk, to improve NP mobilization, and to allow 
for a more homogeneous milk matrix. The 60°C temperature value was tested 
because it is the same used by the dairy industry for the milk homogenization 
step, to reduce fat globules dimensions and to allow their uniform distribu-
tion in raw milk. Those conditions were expected to allow better access to 
bacterial cells by functionalized NP and were confirmed by further results.
Finally, the last threat to the biosensor’s performance was the fact that MR 
sensors were affected by the electrical conductivity of mastitic milk.
An effect of bovine mastitis is changes in milk’s ion concentrations due 
to increased vascular permeability leading to modifications in its electrical 
conductivity (Hovinen et al., 2006). The conductance in milk causes a sen-
sor’s resistivity variation translated by higher background noise instead of a 
true magnetic signal.

30
Magnetic Sensors and Devices
Studies taking advantage of the electrical conductivity of ions in a sample 
(Hassan et al., 2014), or an impedance signal of particles and cells using the 
surrounding media as a reference (Gawad et al., 2001), are not suitable for 
mastitic milk samples because these present high sensitivity to the sample 
matrix and cannot distinguish between the conductance of milk compo-
nents and bacterial presence, which greatly hinders these devices’ use out-
side laboratory facilities. This knowledge reinforces the better suitability of 
the magnetic detection method studied and described in this work.
1.5  Future Perspectives
The development prospects for new bovine mastitis diagnosis methodolo-
gies point to new biomarkers and technological advances for high sensitivity 
and specificity, fast and efficient devices that can offer a “cow-side” use.
Giouroudi and Keplinger (2013) outlined that several novel manipulation, 
separation, and detection mechanisms based on magnetic methods are con-
tinuously emerging, proving that magnetic biosensing has the potential to 
become competitive and probably replace in the future the current optical 
and fluorescence detection technologies, while maintaining the high sensi-
tivity and fast readout time.
Consequently, the magnetic detection device described in this chapter can 
also be a part of that future. Taking into account the mentioned strengths 
and opportunities, this biosensor can be submitted for further improve-
ments, which may include a milk pretreatment step incorporated into the 
microfluidic platform and also further studies on electronics to allow multi-
plex analysis of several samples at a time. Currently, this biosensor requires 
an external computer for system operation and displaying test results, so a 
fully integrated system into a single device could also be made.
The bacterial quantification, however, may be done within lower/upper 
threshold limits. Simulations of the sensor output as a function of the NP 
distribution over the cells (using colonies/clusters configurations compatible 
with that experimentally observed under a microscope) can provide an indi-
cation on minimum and maximum numbers. Further work could be done 
toward a more accurate quantification based on simulations.
References
Åkerstedt, M., Forsbäcka, L., Larsena, T. & Svennersten-Sjaunja, K. (2011). Natural 
variation in biomarkers indicating mastitis in healthy cows. Journal of Dairy 
Research, 78, 88–96.

31
Biosensor Application for Bovine Mastitis Diagnosis
Baibich, M.N., Broto, J.M., Fert, A., Nguyen Van Dau, F., Petroff, F., Etienne, P., Creuzet, 
G., Friederich, A. & Chazelas, J. (1988). Giant magnetoresistance of (001)Fe/(001)
Cr magnetic superlattices. Physical Review Letters, 61(21), 2472–2475.
Bexiga, R., Koskinen, M.T., Holopainen J., Carneiro, C., Pereira, H., Ellis, K.A. & Vilela, 
C.L. (2011). Diagnosis of intramammary infection in samples yielding negative 
results or minor pathogens in conventional bacterial culturing. Journal of Dairy 
Research, 78, 49–55.
Bittar, F., Ouchenane, Z., Smati, F., Raoult, D. & Rolain, J.M. (2009). MALDI-TOF MS 
for rapid detection of staphylococcal Panton–Valentine leukocidin. International 
Journal of Antimicrobial Agents, 34, 467–470.
Bradley, A. (2002). Bovine mastitis: An evolving disease. The Veterinary Journal, 164(2), 
116–128.
Britten, A.M. (2012). The role of diagnostic microbiology in mastitis control pro-
grams. Veterinary Clinics: Food Animal Practice, 28(2), 187–202.
Chung, T.D. & Kim, H.C. (2007). Recent advances in miniaturized microfluidic flow 
cytometry for clinical use. Electrophoresis, 28(24), 4511–4520.
Costa, T., Piedade, M.S., Germano, J., Amaral, J. & Freitas, P.P. (2014). A neuronal sig-
nal detector for biologically generated magnetic fields. IEEE Transactions on 
Instrumentation and Measurement, 63(5), 1171–1180.
Cremonesi, P., Pisoni, G., Severgnini, M., Consolandi, C., Moroni, P., Raschetti, M. 
& Castiglioni, B. (2009). Pathogen detection in milk samples by ligation detec-
tion reaction-mediated universal array method. Journal of Dairy Science, 92(7), 
3027–3039.
de Ávila, B.E.F., Pedrero, M., Campuzano, S., Escamilla-Gómez, V. & Pingarrón, J.M. 
(2012). Sensitive and rapid amperometric magnetoimmunosensor for the deter-
mination of Staphylococcus aureus. Analytical and Bioanalytical Chemistry, 403(4), 
917–925.
Dieny, B. (1994). Giant magnetoresistance in spin-valve multi-layers. Journal of 
Magnetism and Magnetic Materials, 136(3), 335–359.
Duarte, C.M. (2016c). Portable “lab-on-chip” platform for bovine mastitis diagno-
sis in raw milk. Physical Doctor degree in Veterinary Sciences. Dissertation 
in Biomedical and Biological Sciences. Lisbon: Faculdade de Medicina 
Veterinária—Universidade de Lisboa.
Duarte, C.M., Carneiro, C., Cardoso, S., Freitas, P.P. & Bexiga, R. (2016b). Semi-
quantitative method for staphylococci magnetic detection in raw milk. Journal 
of Dairy Research, Dec 23, 1–9.
Duarte, C.M., Costa, T., Carneiro, C., Soares, R., Jitariu, A., Cardoso, S., Piedade, M.S., 
Bexiga, R. & Freitas, P.P. (2016a). Semi-quantitative method for Streptococci mag-
netic detection in raw milk. Biosensors, 6(2), 19.
Fabres-Klein, M.H., Aguilar, A.P., Silva, M.P., Silva, D.M. & Ribon, A.O.B. (2014). 
Moving towards the immunodiagnosis of staphylococcal intramammary 
infections. European Journal of Clinical Microbiology and Infectious Diseases, 33, 
2095–2104.
Fernandes, A.C., Duarte, C.M., Cardoso, F.A., Bexiga, R., Cardoso, S. & Freitas, P.P. 
(2014). Lab-on-chip cytometry based on magnetoresistive sensors for bacteria 
detection in milk. Sensors, 14, 15496–15524.
Freitas, P.P., Cardoso, F.A., Martins, V.C., Martins, S.A.M., Loureiro, J., Amaral, J., 
Chaves, R.C. et al. (2012). Spintronic platforms for biomedical applications. Lab 
on a Chip, 12(3), 546–557.

32
Magnetic Sensors and Devices
Freitas, P.P., Ferreira, R., Cardoso, S. & Cardoso, F. (2007). Magnetoresistive sensors. 
Journal of Physics: Condensed Matter, 19, 165221.
Gawad, S., Schild, L. & Renaud, Ph. (2001). Micromachined impedance spectroscopy 
flow cytometer for cell analysis and particle sizing. Lab on a Chip, 1, 76–82.
Gehanno, V., Freitas, P.P., Veloso, A., Ferreira, J., Almeida, B., Sousa, J.B., Kling, A., 
Soares, J.C. & Silva, MF. (1999), Ion beam deposition of Mn-Ir spin valves. IEEE 
Transactions on Magnetics, 35 (5), 4361–4367.
Giouroudi, I. & Keplinger, F. (2013). Microfluidic biosensing systems using magnetic 
nanoparticles. International Journal of Molecular Sciences, 14, 18535–18556.
Gröhn, Y.T., Eicker, S.W., Ducrocq, V. & Hertl, J.A. (1998). Effect of diseases on the 
culling of Holstein dairy cows in New York state. Journal of Dairy Science, 81(4), 
966–978.
Grönlund, U., Hultén, C., Eckersall, P.D., Hogarth, C. & Waller, K.P. (2003). Haptoglobin 
and serum amyloid A in milk and serum during acute and chronic experi-
mentally induced Staphylococcus aureus mastitis. Journal of Dairy Research, 70(4), 
379–386.
Hassan, U., Watkins, N.N., Edwards, C. & Bashir, R. (2014). Flow metering charac-
terization within an electrical cell counting microfluidic device. Lab on a Chip, 
14(8), 1469–1476.
Henriksen, A.D., Wang, S.X. & Hansen, M.F. (2015). On the importance of sensor 
height variation for detection of magnetic labels by magnetoresistive sensors. 
Scientific Reports, 5, 12282.
Hicks, C.R., Eberhart, R.J. & Sischo, W.M. (1994). Comparison of microbiologic cul-
ture, an enzyme-linked immunosorbent assay, and determination of somatic 
cell count for diagnosing Staphylococcus aureus mastitis in dairy cows. Journal of 
the American Veterinary Medical Association, 204(2), 255–260.
Hortet, P. & Seegers, H. (1998). Calculated milk production losses associated with ele-
vated somatic cell counts: Review and critical discussion. Veterinary Research, 
29(6), 497–510.
Hovi, M. & Roderick, S. (1999). Mastitis in organic dairy herds: Results of a two 
year survey. Proceedings of a Soil Association Conference: Mastitis, the Organic 
Perspective. Stoneleigh, 3 September. Reading, UK.
Hovinen, M., Aisla, A.M. & Pyörälä S. (2006). Accuracy and reliability of mastitis 
detection with electrical conductivity and milk colour measurement in auto-
matic milking. Acta Agriculturae Scandinavica, Section A: Animal Science, 56(3–4), 
121–127.
Huh, D., Gu, W., Kamotani, Y., Grotberg, J.B. & Takayama, S. (2005). Microfluidics for 
flow cytometric analysis of cells and particles. Physiological Measurement, 26(3), 
R73–R98.
Jitariu, A., Duarte, C., Cardoso, S., Freitas, P.P. & Chiriac, H. (2016). Theoretical method 
for the evaluation of bacterial concentration by magnetoresistive cytometry. 
IEEE Transactions on Magnetics (in press, 2016), 10.1109/TMAG.2016.2623675.
Kokkinis, G., Cardoso, S., Keplinger, F. & Giouroudi, I. (2017). Microfluidic plat-
form with integrated GMR sensors for quantification of cancer cells. Sensors & 
Actuators: B. Chemical, 241, 438–445.
Korhonen, H. & Kaartinen, L. (1995). Changes in the composition of milk induced 
by mastitis. In: Sandholm M., Honkanen-Buzalski T., Kaartinen L., Pyörälä 
S. (Eds.). The Bovine Udder and Mastitis (pp. 76–82). Gummerus, Jyväskylä, 
Finland.

33
Biosensor Application for Bovine Mastitis Diagnosis
Lago, A., Godden, S.M., Bey, R., Ruegg, P.L. & Leslie, K. (2011). The selective treatment 
of clinical mastitis based on on-farm culture results: I. Effects on antibiotic use, 
milk withholding time, and short-term clinical and bacteriological outcomes. 
Journal of Dairy Science, 94(9), 4441–4456.
Lazcka, O., Del Campo, F.J. & Muñoz, F.X. (2007). Pathogen detection: A perspec-
tive of traditional methods and biosensors. Biosensors and Bioelectronics, 22(7), 
1205–1217.
Lee, K.H., Lee, J.W., Wang, S.W., Liu, L.Y., Lee, M.F., Chuang, S.T., Shy, Y.M., Chang, 
C.L., Wu, M.C. & Chi, C.H. (2008). Development of a novel biochip for rapid 
multiplex detection of seven mastitis-causing pathogens in bovine milk sam-
ples. Journal of Veterinary Diagnostic Investigation, 20, 463–471.
Libing, W., Chuanlai, X., Qianqian, Y., Xiaofang, D., Shanshan, S. & Xun, Z. (2012). 
Kit for rapid detection of Staphylococcus aureus in sample and detection method 
thereof. Pat. No. CN102323416 (A).
Lippolis, J.D. & Reinhardt, T.A. (2010). Utility, limitations, and promise of proteomics 
in animal science. Veterinary Immunology and Immunopathology, 138(4), 241–251.
Loureiro, J., Andrade, P.Z., Cardoso, S., da Silva, C.L., Cabral, J.M. & Freitas, P.P. (2011). 
Magnetoresistive chip cytometer. Lab on a Chip, 11(13), 2255–2261.
Loureiro, J., Cardoso, S., Cabral, J.M. and Freitas, P.P. (2007). The 52nd Magnetism and 
Magnetic Materials Conference, Tampa, FL, EUA, Micro Total Analysis System 
for hematopoietic stem/progenitor cell separation and counting, Proceedings.
Mansor, R., Mullen, W., Albalat, A., Zerefos, P., Mischak, H., Barrett, D.C., Biggs, A. 
& Eckersall, P.D. (2013). A peptidomic approach to biomarker discovery for 
bovine mastitis. Journal of Proteomics, 85, 89–98.
Matsushita, T., Dinsmore, R.P., Eberhart, R.J., Jones, G.M., McDonald, J.S., Sears, P.M. 
& Adams, D.S. (1990). Performance studies of an enzyme-linked immunosor-
bent assay for detecting Staphylococcus aureus antibody in bovine milk. Journal 
of Veterinary Diagnostic Investigation, 2(3), 163–166.
McCarron, J.L., Keefe, G.P., McKenna, S.L., Dohoo, I.R. & Poole, D.E. (2009). Laboratory 
evaluation of 3M Petrifilms and University of Minnesota Bi-plates as potential 
on-farm tests for clinical mastitis. Journal of Dairy Science, 92(10), 2297–2305.
Milner, P., Page, K.L. & Hillerton, J.E. (1997). The effects of early antibiotic treatment 
following diagnosis of mastitis detected by a change in the electrical conduc-
tivity of milk. Journal of Dairy Science, 80, 859–863.
Mortari, A. & Lorenzelli, L. (2014). Recent sensing technologies for pathogen detec-
tion in milk: A review. Biosensors and Bioelectronics, 60(15), 8–21.
Mujika, M., Arana, S., Castaño, E., Tijero, M., Vilares, R., Ruano-López, J.M., Cruz, A., 
Sainz, L. & Berganza, J. (2009). Magnetoresistive immunosensor for the detec-
tion of Escherichia coli O157:H7 including a microfluidic network. Biosensors and 
Bioelectronics, 24(5), 1253–1258.
National Mastitis Council (NMC). (1999). Sampling collection and handling. Laboratory 
Handbook on Bovine Mastitis. National Mastitis Council Inc., Verona, WI.
Pyörälä, S. (2003). Indicators of inflammation in the diagnosis of mastitis. Veterinary 
Research, 34, 565–578.
Quinn, P.J., Carter, M.E., Markey, B. & Carter, G.R. (1994). Veterinary Clinical 
Microbiology (pp. 127–136). Mosby Editors/Elsevier, London.
Soares, A.R.S. (2015). Portable lab-on-chip platform for bovine mastitis diagno-
sis in raw milk. Master degree Dissertation in Biomedical and Biophysics 
Engineering. Lisbon: Faculdade de Ciências—Universidade de Lisboa.

34
Magnetic Sensors and Devices
Taponen, S., Koort, J., Björkroth, J., Saloniemi, H. & Pyörälä, S. (2007). Bovine intra-
mammary infections caused by coagulase-negative staphylococci may persist 
throughout lactation according to amplified fragment length polymorphism 
based analysis. Journal of Dairy Science, 90(7), 3301–3307.
Taponen, S., Salmikivi, L., Simojoki, H., Koskinen, M.T. & Pyörälä, S. (2009). Real-time 
polymerase chain reaction-based identification of bacteria in milk samples 
from bovine clinical mastitis with no growth in conventional culturing. Journal 
of Dairy Science, 92(6), 2610–2617.
Tenhagen, B.A., Koster, G., Wallmann, J. & Heuwieser, W. (2006). Prevalence of mas-
titis pathogens and their resistance against antimicrobial agents in dairy cows 
in Brandenburg, Germany. Journal of Dairy Science, 89(7), 2542–2551.
van der Woude, M.W. & Bäumler, A.J. (2004). Phase and antigenic variation in bacte-
ria. Clinical Microbiology Reviews, 17(3), 581–611.
Walstra, P., Wouters, J. & Geurts, T. (2006). Dairy Science and Technology. (2nd Edn.). 
Taylor & Francis Group, New York.
Wang, S.X. & Li, G. (2008). Advances in giant magnetoresistance biosensors with 
magnetic nanoparticle tags: Review and outlook. IEEE Transactions on Magnetics, 
44(7), 1687–1702.
Wolff, A., Perch-Nielsen, I.R., Larsen, U.D., Friis, P., Goranovic, G., Poulsen, C.R., 
Kutter, J.P. & Telleman, P. (2003). Integrating advanced functionality in a micro-
fabricated high-throughput fluorescent-activated cell sorter. Lab on a Chip, 3(1), 
22–27.
Yazdankhah, S.P., Hellemann, A.L., Rønningen, K. & Olsen, E. (1998). Rapid and sen-
sitive detection of Staphylococcus species in milk by ELISA based on monodis-
perse magnetic particles. Veterinary Microbiology, 62(1), 17–26.
Yoon, J.-Y. & Kim, B. (2012). Lab-on-a-chip pathogen sensors for food safety. Sensors, 
12, 10713–10741.
Zadoks, R.N., Middleton, J.R., McDougall, S., Katholm, J. & Schukken, Y.H. (2011). 
Molecular epidemiology of mastitis pathogens of dairy cattle and compara-
tive relevance to humans. Journal of Mammary Gland Biology and Neoplasia, 16(4), 
357–372.
Zadoks, R.N. & Watts, J.L. (2009). Species identification of coagulase-negative staphy-
lococci: Genotyping is superior to phenotyping. Veterinary Microbiology, 134(1–
2), 20–28.
Zschöck, M., Nesseler, A. & Sudarwanto, I. (2005). Evaluation of six commercial iden-
tification kits for the identification of Staphylococcus aureus isolated from bovine 
mastitis. Journal of Applied Microbiology, 98(2), 450–455.

35
2
Giant (GMR) and Tunnel (TMR) 
Magnetoresistance Sensors: From 
Phenomena to Applications
Cà ndid Reig and Marí a-Dolores Cubells-Beltrá n
CONTENTS
2.1	
Introduction...................................................................................................36
2.2	
Structures and Phenomena .........................................................................37
2.2.1	 Sandwich............................................................................................37
2.2.2	 Spin Valves.........................................................................................37
2.2.3	 Magnetic Tunnel Junctions..............................................................39
2.2.4	 Other GMR Structures.....................................................................40
2.3	
Devices...........................................................................................................40
2.3.1	 Technological Issues.........................................................................40
2.3.1.1	 Spin Valves..........................................................................41
2.3.1.2	 Magnetic Tunnel Junctions...............................................41
2.3.2	 Devices Design..................................................................................41
2.4	
Limitations.....................................................................................................43
2.4.1	 Range of Application........................................................................43
2.4.1.1	 Noise Mechanisms in GMR/TMR Sensors....................43
2.4.2	 Hysteresis...........................................................................................46
2.4.3	 Voltage Offset....................................................................................46
2.4.4	 Temperature Drifts...........................................................................46
2.4.5	 Bandwidth..........................................................................................48
2.5	
Applications...................................................................................................49
2.5.1	 General Purpose Magnetometers (Compass)...............................49
2.5.2	 Industrial Applications....................................................................49
2.5.2.1	 Automotive..........................................................................49
2.5.2.2	 Space....................................................................................49
2.5.2.3	 Electric Current Measurement.........................................51
2.5.3	 Non-Destructive Evaluation............................................................54
2.5.3.1	 Magnetic Detection............................................................54
2.5.3.2	 Eddy Current Testing........................................................54

36
Magnetic Sensors and Devices
ABSTRACT   Solid state magnetic sensors have inherent characteristics that 
make them potential candidates in a huge range of applications regarding mag-
netic field sensing. We mention their high level of integration with electron-
ics, their low weight, low cost, and wide bandwidth, among others. Hall effect 
devices and magnetoresistance sensors are excellent examples. Giant magne-
toresistance (GMR) and tunneling magnetoresistance (TMR) sensors, while 
maintaining these advantages, have demonstrated better performance figures 
regarding sensitivity and signal-to-noise ratio (SNR). In this way, GMR/TMR 
sensors have been considered in scenarios requiring sub-nT measurements, with 
demonstrated success. In this chapter, we will present the fundamental basis of 
GMR/TMR and we will describe the state-of-the-art use of GMR/TMR sensors. 
2.1  Introduction
The giant magnetoresistance (GMR) effect was first described in 1988 by A. 
Fert (Baibich et al. 1988) and then in 1989 by P. Grunberg (Binasch et al. 1989). 
In 2007, both were awarded the Nobel Prize in Physics for their contribu-
tions (Thompson 2008). Basically, the GMR effect is a significant change in its 
resistance with an external field at room temperature. It is observed in mul-
tilayered structures with ferromagnetic layers separated by a non-magnetic 
spacer due to the relative orientation of the magnetization vectors.
Initially, GMR structures were used as sensing elements in the read heads 
of hard drives. In these applications, the magnetoresistance (MR) level 
shifted, with the influence of the magnetic field generated by the magneti-
cally stored bits, between two limit states: maximum and minimum resis-
tance, as described by
	
MR
R
R
R
=
−
↑↓
↑↑
↑↑
	
where:
	MR 	 is the so-called magnetoresistance level
	R↑↓	 is the (maximum) resistance in the anti‑parallel state
	R↑↑	 is the (minimum) resistance in the parallel state
2.5.4	 Bio-Applications................................................................................56
2.5.4.1	 Detection of Bioanalytes...................................................57
2.5.4.2	 Monitoring of Magnetic Fluids........................................58
2.5.4.3	 Biomedical Signal Detection.............................................58
2.6	
Conclusions....................................................................................................58
Acknowledgments.................................................................................................58
References ...............................................................................................................59

37
Giant and Tunnel MR Sensors
Nowadays, these multilayered structures can be engineered in such a way 
that the quiescent state of the structure is obtained with layers having their 
magnetic moments in a crossed-axis (orthogonal) conﬁ guration by means of 
a particular deposition process or by the application of an external magnetic 
biasing. In this way, the transfer curve of the device is notably smoothed, and 
the quiescent working point is placed in a medium state, thereby providing 
a useful quasi-linear region that can be utilized for analog magnetic sensing 
applications.
2.2  Structures and Phenomena 
GMR phenomena were initially reported on Fe/Cr thin multilayers (Baibich 
et al. 1988; Binasch et al. 1989). It was demonstrated that the electric current in 
a magnetic multilayer consisting of a sequence of thin magnetic layers sepa-
rated by equally thin non-magnetic metallic layers is strongly inﬂ uenced by 
the relative orientation of the magnetizations of the magnetic layers (about 
50% at 4.2  K). The cause of this giant variation in the resistance is attrib-
uted to the scattering of the electrons at the layers’  interfaces. In this way, 
any structure with metal–magnetic interfaces is a candidate to display GMR. 
Since then, a huge effort has been made to find structures that enhance this 
effect (MR levels at room temperature above 200% are achieved in modern 
GMR structures). We will next describe some of these structures.
2.2.1  Sandwich
A sandwich structure is the general name for multilayered structures. 
They usually consist of two magnetic layers of an Fe–Co–Ni alloy, such as 
­permalloy, separated by a non-magnetic conductive layer, such as Cu (Ranchal 
et al. 2002). A general scheme is shown in Figure  2.1a. With magnetic ﬁ lms 
of about 4–6  nm wide and a conductor layer of about 35  nm, magnetic cou-
pling between layers is slightly small. With these conﬁ gurations, MR levels 
of about 4%–9% are achieved, with linear ranges of about 50  Oe. The ﬁ gures 
of merit of sandwich devices can be improved by continuously repeating the 
basic structure, thereby creating a multilayered system. Successful applica-
tions of sandwich structures in magnetic ﬁ eld sensing include bio-electron-
ics (Mujika et al. 2009) and angle sensors (Lopez-Martin and Carlosena 2009).
2.2.2  Spin Valves
The origin of spin valves (SVs) comes from the sandwich structure. In SVs, 
an additional antiferromagnetic (pinning) layer is added to the top or bottom 
part of the structure, as shown in Figure  2.1b. In this sort of structure, there is 

38
Magnetic Sensors and Devices
no need for an external excitation to get the anti‑parallel alignment. Despite 
this, the pinned direction (easy axis) is usually ﬁ xed by raising the tempera-
ture above the knee temperature (at which the antiferromagnetic coupling 
disappears) and then cooling it within a ﬁ xing magnetic ﬁ eld. Obviously, 
devices so obtained have a temperature limitation below the knee tempera-
ture. Typical values displayed by SVs are an MR of 4%–20% with saturation 
ﬁ elds of 0.8–6  kA/m (Freitas et al. 2007).
For linear applications, and without excitation, pinned (easy axis) and free 
layers are arranged in a crossed-axis conﬁ guration (at 90° ), as detailed in 
Figure  2.2a. The response of this structure is given by (Freitas et al. 2007)
	
∆
∆
R
R
R
R i W
h
sq
p
f
=




−
(
)
1
2
cos θ
θ
	
where:
	(Δ R /R )	 is the maximum MR level (5%–20%)
	R sq  	
	
is the sensor sheet resistance (15–20  Ω /sq)
	 L 	
	
is the length of the element
	W 	
	
is its width
	 h 	
	
is the thickness
	 i 	
	
is the sensor current
	θ p   and θ f  	are the angle of the magnetization angle of the pinned and free 
layers, respectively
Assuming uniform magnetization for the free and pinned layers, for a lin-
earized output, θ p  =90°  and θ f  =0.
Magnetization
Current direction
Magnetic
Free layer
Conductor
Pinned layer
Pinning layer
Magnetic
Sandwich
(a)
(b)
(c)
(d)
Spin valve
Conductor
Magnetic
Cu
Ag
Co
Magnetic
Magnetic tunnel junction
Granular alloy
Isolator
FIGURE  2.1  
Basic structures displaying GMR phenomena.

39
Giant and Tunnel MR Sensors
2.2.3  Magnetic Tunnel Junctions
Magnetic tunnel junctions (MTJ), also called tunnel magnetoresistance 
(TMR) structures, were initially described as GMR structures (Hirota et al. 
2002). Nowadays, they are considered a specific MR effect (Reig et al. 2013). 
Nevertheless, due to the similarity of both families of structures and their 
shared applications, we will also consider them in this chapter.
In this case, the magnetic layers are separated not by a conductive layer but 
by a very thin isolating layer, following a current perpendicular to planes 
(CPP) conﬁ guration (see Figures  2.1c and 2.2b). Electrons can cross this 
thin ﬁ lm by means of the quantum tunnel effect. As deduced from quan-
tum mechanics arguments, the crossing probability is higher when both 
magnetic moments are aligned in parallel and lower when both magnetic 
moments are not aligned in parallel. The equation describing the output of 
these structures is
Pinning
Pinned
Spacer
Free
θp
θf
(a)
(b)
Pinning
Pinned
Spacer
Free
θp
θf
FIGURE  2.2  
Multilayer structures corresponding to typical spin valves (a) and magnetic tunnel junctions (b).

40
Magnetic Sensors and Devices
	
∆V
TMR
=
×
−
(
)
1
2
cos
i R
A
Wh
p
f
θ
θ
	
where:
	TMR		
is the maximum MR level
	 i 	
	
is the biasing current
	R   ×   A 	 is the resistance per area parameter
	Wh 	 	
are the dimensions
These devices usually make use of the SV principle in order to ﬁ x the easy 
axis by means of a pinning antiferromagnetic layer. Typical MR levels of 
MTJ are above 40%, with Al2 O3  as the isolating layer (Ziese and Thornton 
2001). More recently, MR levels of about 200% have been reported for MgO-
based structures (Ferreira et al. 2006). Saturation ﬁ elds are of the order of 
1− 100  Oe. The basis of linear MTJs is analogous to that of a linear SV. When 
conﬁ gured in a crossed-axis conﬁ guration, linear ranges suitable for sensor 
applications can be achieved (Freitas et al. 2007).
2.2.4  Other GMR Structures
Granular ﬁ lms of Co–Cu and Co–Ag also exhibit a GMR effect. In this 
case, the GMR effect is due to the spin-dependent scattering taking place 
at the boundaries of Co clusters embedded in the host lattice, as depicted in 
Figure  2.1d. Because these binary systems are not miscible, the characteris-
tics of the devices are highly conditioned by the growth conditions and the 
post-deposition treatments. In fact, the amount of MR is accepted to be asso-
ciated with the size of the Co clusters (André s et al. 1999).
GMR can also be found in other structures. We collected two illustrative 
examples. Pena et al. (2005) report on GMR in ferromagnet/superconductor 
superlattices and Pullini et al. (2007) describe GMR in multilayered nanow-
ires. In any case, a magnetic–non-magnetic interface is required in order to 
allow the spin-electron scattering to produce the effect.
2.3  Devices
In order to have functional devices, GMR/TMR multilayered structures 
have to be patterned into elements with proper resistance values for use as 
sensors. Then, these elements need to be contacted.
2.3.1  Technological Issues
The deposition of these structures can be done with low temperature pro-
cesses and then patterned by selective physical etching, so avoiding damage 

41
Giant and Tunnel MR Sensors
in the substrate. In this sense, the deposition of these structures can be 
accomplished by ion beam deposition (IBD) or by sputtering. In any case, 
the substrate temperature does not exceed 120° C. Thus, both processes can 
be directly masked with photoresist without damaging the substrate. In 
some cases, a ﬁ nal heat treatment of between 200° C and 300° C is required to 
increase the MR ratio (He et al. 2010).
2.3.1.1  Spin Valves
A typical structure can be found in Reig et al. (2004). It was deposited by ion 
beam sputtering (IBD) onto a 3″  Si/SiO2  1500  Å  substrate. The SV structure 
was Ta (20  Å )/NiFe (30  Å )/CoFe (20  Å )/Cu (22  Å )/CoFe (25  Å )/MnIr (60  Å )/
Ta (40  Å ). This structure was demonstrated to give MR responses of about 
6%–7%, linear ranges of about 20  Oe, and sheet resistivities of about 10–15  Ω /
sq. Deposition rates ranged from 0.3 to 0.6  Å /s. A 40  Oe ﬁ eld was applied to 
the substrates during the deposition step in order to state the easy axis in the 
pinned and free layers. The wafer was rotated 90°  between both depositions 
to ensure a crossed-axis SV conﬁ guration.
Nano-oxide layers (NOL) inserted in the pinned layer and above the free 
layer have been found to increase the MR ratio (Reig et al. 2005). The enhance-
ment of GMR is attributed to the specular scattering effect of the conduction 
electrons at the metal–insulator interfaces.
2.3.1.2  Magnetic Tunnel Junctions
A typical MTJ structure was deposited by ion beam sputtering (IBD) onto 
3″  Si/SiO2  1000  Å  substrates. The ﬁ nal structure of the MTJ was Al (600  Å )/
Ta (90  Å )/NiFe (70  Å )/MnIr (250  Å )/CoFe (50  Å )/Al2 O3  (12  Å )/CoFe (50  Å )/
NiFe (25  Å )/Ta (60  Å )/TiW (300  Å ), as described in Reig et al. (2008). This 
particular structure was demonstrated to give MR responses close to 40% 
while keeping linear ranges above 20  Oe.
2.3.2  Devices Design
To implement an SV-based device, only one lithographic step is required for 
patterning the structures (L1), and then another to design the contacts (L2), 
at the ends of the SV strip, as shown in Figure  2.3 (left). The sheet resistance 
is inherent to the specific SV structure, but the final resistance value can be 
tuned by properly setting L  and W  of the strip. Usually, the minimum W  
value is constrained by the lithography resolution, and then the L  value is 
obtained. For SV structures such as those described in the Section 2.3.1.1, 
devices of 200  ×   3  µ m give nominal resistances of the order of 1  kΩ .
For MTJs, due to their CPP nature, two masks are required for deﬁ ning an 
elemental device. In the ﬁ rst step, a mesa structure is deﬁ ned (L1) (Figure  2.3, 
right). Then, a second mask (L2) is applied to deﬁ ne the pillars comprising 

42
Magnetic Sensors and Devices
the active region. Usually, a conductive bottom layer is included in the mul-
tilayered structure to connect devices in pairs, and facilitating the electrical 
contacts on the top of the structures (L3).
Because these elements are resistance, once they have been defined, they 
can be arranged in different configurations, depending on the specific 
requirement. MTJs are commonly arranged in arrays of elements in series 
and parallel, due to their better SNR performance and the intrinsic depen-
dence of the MR level with the voltage bias (Chen and Freitas 2012).
In linear applications involving resistive sensors, bridge setups are often 
considered. They display a highly linear response, a better signal level, 
zeroed output, and high immunity to undesired external effects. Successful 
examples of the use of GMR/TMR sensors configured as bridges can be 
found in Cubells-Beltrá n et al. (2009), Guerrero et al. (2009), and Le Phan et 
al. (2005).
When magnetic imaging is the objective, GMR sensors can also be arranged 
in arrays, as described, for example, by Cardoso et al. (2006), where MTJ 
elements have been integrated with a thin-film transistor (TFT) diode for 
improving the addressing process, or in Hall et al. (2013), where 256  pixels 
arrays with integrated complementary metal-oxide semiconductor (CMOS) 
circuitry have been demonstrated.
Silicon
L1
L2
L1
L2
L3
Silicon oxide
Aluminum
Spin valve multilayered structure
Magnetic tunnel junction multilayered structure
Fabrication process of the elemental devices
Spin valves (SV)
Magnetic tunnel junctions (MTJ)
FIGURE   2.3  
GMR/TMR basic fabrication steps.

43
Giant and Tunnel MR Sensors
2.4  Limitations
The limitations of use of these sensors arise from very different reasons 
including the range of application, reproducibility, voltage offset, tempera-
ture drifts, or bandwidth constrictions. In the following sections, we describe 
some of these limitations and we give the direction of current investigations 
for overcoming them.
2.4.1  Range of Application
The intrinsically useful range of MR-based sensors is mainly limited by two 
mechanisms. At the low-level region, the SNR ratio sets the detection limit. 
Then, a study of the related noise sources is mandatory. The noise power 
spectrum density (PSD) is commonly given in square volts per hertz (V2 /
Hz). Often, it is much more convenient to use the amplitude spectrum den-
sity (ASD), expressed in volts per square root hertz (V/√ Hz), for a compar-
ison with voltage signals. The sensitivity for an MR signal, S V  , is usually 
given in V/V/T. Typical values for GMR sensors are 20–40  V/V/T, for exam-
ple, 20–40  nV/nT when they are biased with 1  V. For comparing diﬀ erent 
sensors, it is recommended to use the ﬁ eld equivalent noise power spectra 
density, sometimes called detectivity . It corresponds to the PSD divided by 
the sensitivity. For example, if a sensor displays a noise of 10  nV/√ Hz at a 
given frequency and a sensitivity of 25  V/V/T, its detectivity will be 400  pT 
for 1  V bias (Reig et al. 2013). At the high signal region, the saturation ﬁ eld is 
the limitation mechanism. For sensing applications, a good approximation is 
to consider the linear range to be one-half of the saturation ﬁ eld.
GMR/TMR can be applied in the range from some petatesles (pT) to almost 
kilotesles (kT), which is more than 14 orders of magnitude, as observed in 
Figure  2.4, compared with other magnetic sensors.
2.4.1.1  Noise Mechanisms in GMR/TMR Sensors
2.4.1.1.1  Thermal Noise
The most relevant noise is the thermal noise (also called the Johnson–Nyquist 
noise or white noise), which is directly related to the resistance of the sensor. 
It is a white noise, so it is independent of the frequency. It was ﬁ rst observed 
by Johnson (1928) and interpreted by Nyquist (1928). It is expressed as
	
S
Rk T
V
B
ω
( ) =
4
	
where:
	 R 	
is the sensor resistance
	k B  	
is the Boltzmann constant
	 T 	
is the temperature

44
Magnetic Sensors and Devices
For example, a 1  kΩ  resistor at room temperature has 4  nV/√ Hz.
2.4.1.1.2  1/f Noise
The origin of the 1/f  noise or “ pink”  noise or Flicker noise is from resistance 
ﬂ uctuations, so it can only be revealed by applying a current to the sensor. 
Its dependence with the frequency is described by the following phenom-
enological formula:
	
S
R I
N f
V
H
c
ω
γ
β
( ) =
2 2
	
where:
	γ H  	
is a dimensionless constant proposed by Hooge (1976)
	 R 	
is the sensor resistance
	 I 	
is the bias current
	N c  	
is the number of current carriers
	 f 	
is the frequency
	 β 	
is an exponent typically of the order of 1
1/f  noise can exhibit a non-magnetic and a magnetic component with pos-
sible diﬀ erent slopes. For TMRs, the formula becomes
	
S
R I
A f
V ω
α
( ) =
2 2
	
Magnetic diode
Magnetic transistor
Hall 
GMR
EMR
Magnetostriction
MTJ
Magneto optical
GMI
Optical ﬁber
AMR
Fluxgate
Nuclear presession
Optical pumping
Search coil
SQUID
1 fT
1 pT
1 nT
1 µT
1 mT
1 T
1 kT
Tomography
Variation
of Earth
magnetic
ﬁeld
NDE
Magnetic ﬁeld range
Detection
Y/N
Detection
guidance
of vehicles
Position
sensing
Navigation
Archeology
supercond.
Rotation
FIGURE  2.4  
Range of applications of different magnetic field sensors. (From Dí az-Michelena, M., Sensors 
[Basel, Switzerland],  9(4), 2271–88, 2009.)

45
Giant and Tunnel MR Sensors
where:
	 A 	
is the active surface of the device
	 α 	
is a parameter with the dimension of a surface
The size and shape of the sensors have a strong eﬀ ect on the 1/f  noise.
In GMRs and TMRs, this low‑frequency noise is dominant and is often a 
drawback in the performance of the sensors. Although the TMR in MTJs is 
signiﬁ cantly higher than the MR in SVs, the intrinsic noise of an MTJ sensor 
is also higher than that of an SV (by a factor of about 3 [Freitas et al. 2007]). 
Due to its average nature, small GMR sensors display more 1/f  noise than 
bigger sensors. By considering equally thin sensors, the 1/f  noise is roughly 
inversely proportional to their area (Reig et al. 2013). As a graphical sum-
mary, Figure  2.5 shows the measured noise for several GMR commercial 
sensors, expressed as detectivity (Stutzke et al. 2005).
2.4.1.1.3  Random Telegraph Noise
The random telegraph noise (RTN; or “ popcorn”  noise) is due to the fluc-
tuations of a specific source between two different levels with comparable 
energies and a barrier height able to give a typical characteristic time in 
the measurement range. RTN is difficult to handle and a sensor with RTN 
noise is in general very difficult to use even if it is theoretically possible to 
partially suppress this noise by data treatment.
2.4.1.1.4  Shot Noise
Shot noise (Freitas et al. 2007) arises in discontinuities in the conduction 
medium as a consequence of the discrete nature of the electrical charge and 
Honeywell HMC1001
10–1
10–2
10–1
100
101
102
100
101
102
103
104
Honeywell HMC1021
NVE AAL002
Frequency (Hz)
Detectivity (nT/Hz1/2)
NVE SDT
NVE AA002
NVE AAH002
FIGURE  2.5  
Low‑frequency noise of commercial GMR sensors. (Reprinted with permission from Stutzke, 
N. A. et al., Journal of Applied Physics  97(10), 10Q107, 2005.)

46
Magnetic Sensors and Devices
is described by the following equation, where e  stands for the electron elec-
trical charge and I  is the current flowing through the device (for practical 
device operating temperatures).
	
S
eI R
V ω
( ) = 2
2 	
The tunnel barrier of an MTJ is an example of a discontinuity in the con-
duction medium, which is why shot noise is found in MTJs but not in SVs or 
anisotropic magnetoresistance (AMR) sensors, which are made of continu-
ous metallic layers.
2.4.2  Hysteresis
The magnetic nature of GMR-based sensors implies an associated hyster-
esis. Such effect has been analyzed for GMR sensors both numerically (Á č  
2008) and experimentally (Liu et al. 2012). Intrinsically, this inherent hys-
teresis can be internally reduced by considering a so-called crossed-axis 
conﬁ guration of the magnetization moments of the constituent layers of the 
MR structure. In this case, since the free layer would never reverse, but 
merely displace by 90° , hysteretic errors below 1% of the full scale can be 
achieved (Reig et al. 2004). Alternating current (ac) biasing schemes have 
been proposed for reducing the hysteresis. In Ripka et al. (1999), by using 
an ac biasing of 5  mA at 10  kHz, the hysteresis of a commercial NVE sen-
sor was reduced from 5% to 1% in the 0.3  mT range. In addition, both SNR 
and offset were also partially reduced. Hysteresis has also been reduced 
by biasing the sensors with an external magnetic ﬁ eld (Vopá lenský  et al. 
2004). More recently, electrical models have been developed to reduce the 
hysteresis in specific GMR-based current sensors (Jedlicska et al. 2010; Han 
et al. 2015).
2.4.3  Voltage Offset
MR sensors are commonly used in a bridge conﬁ guration, so voltage off-
sets are introduced during the fabrication process. Common sources of these 
deviations are deposition inhomogeneities and lithography tolerances. As 
the dimensions of MR structures are close to the lithography resolution 
limit, these tolerances need to be externally corrected using external circuits.
2.4.4  Temperature Drifts
Temperature is always a limiting parameter in electronics. Every electronic 
device has a temperature-dependent response arising from its physical 
nature. Regarding speciﬁ c GMR sensors, not only does the resistance (and 
the sensor impedance) vary with the temperature, but so does the MR level 
(and then the sensitivity).

47
Giant and Tunnel MR Sensors
The resistance of GMR sensors is a function of the temperature. For GMR-
based devices, and in the usual range of utilization, this dependence can be 
considered linear, and can be deﬁ ned by a temperature coefﬁ cient (TEMPCO) 
as follows:
	
TCR %
(
) =
×
100
1
0
R
R
T
T
∆
∆
	
An analog relationship can be deﬁ ned for the thermal dependence of sen-
sitivity as
	
TCS
S
%
(
) =
×
100
1
0
S
T
T
∆
∆
	
When a full bridge conﬁ guration is considered, this thermal dependence is 
partially compensated and is expected to be low. Due to the inherent voltage 
offset of sensors conﬁ gured as bridges, the temperature drift of the offset 
voltage must be speciﬁ ed:
	
TCVoff
off
off
%
,
(
) =
×
100
0
∆
∆
V
T
V
T
	
MR structures are temperature dependent. For real applications, the 
temperature coefﬁ cient of the output voltage of a given sensor can be set 
below 0.1%/K in a Wheatstone bridge conﬁ guration with a direct cur-
rent (dc) bias instead of a direct voltage bias (Cubells-Beltrá n et al. 2011). 
Experimental parameters are only related to the nature of the GMR struc-
tures, and they have been measured elsewhere. In Figure  2.6, we show the 
typical values for full bridge sensors composed of equal SV elements, as 
0.95
–20°C
0°C
20°C
Normalized Zinp
40°C 60°C
1.00
1.05
0.8
–20°C
0.9
1.0
1.1
1.2
0°C
20°C
Normalized S
40°C 60°C
–0.4
–20°C
–0.2
0.0
0.2
0.4
0°C
20°C
DVoﬀ (mV)
40°C 60°C
FIGURE  2.6  
Temperature dependence of the characteristic parameters in typical spin valves. (From 
Cubells-Beltrá n, M. et al., IEEE Sensors Journal,  9(12), 1756–62, 2009.)

48
Magnetic Sensors and Devices
described in Cubells-Beltrá n et al. (2009). From these graphs, we can extract 
TCR  ≈   0.11%/° C, TCVoff   <   10  µ V/° C, and TCS  ≈   − 0.15%/° C, as they were 
defined before.
When thermal drifts are not sufficiently lowered by using bridge configu-
rations, different temperature compensation schemes have been proposed 
in the literature, specifically developed for GMR sensors–based applications 
(Ramí rez Muñ oz et al. 2006; Sá nchez Moreno et al. 2011).
2.4.5  Bandwidth
Theoretically, due to the inherent quantum mechanism involved, MR struc-
tures have bandwidths of the order of 1  GHz (Hirota et al. 2002). In real 
applications, a reduction in the bandwidth is introduced by the associated 
circuitry. Such an effect can be important in electric current monitoring appli-
cations because of the necessity to drive the current path close to the sensor. 
In principle, due to the inductive character of the coupling, a “ zero”  behav-
ior in the transfer function should be observed. In Figure  2.7, the frequency 
responses of some illustrative examples are compiled: an HMC1O21 sensor 
soldered onto a typical (3  mm width) printed circuit board (PCB) strap, a 
meandered engineered SV sensor (Reig et al. 2004), and an MTJ compact 
current sensor prototype both in a full Wheatstone bridge conﬁ guration and 
a single resistor (Reig et al. 2008). As observed, an inductive effect appears 
well below 1  MHz. Moreover, the more complicated the sensing structure is, 
the less bandwidth obtained. Regarding real applications, MR current sen-
sors have been successfully applied up to 1  MHz (Cubells-Beltrá n et al. 2009; 
Singh and Khambadkone 2014).
3
2
1
1
10
HMC1021 (onto a single PCB current track)
Meandered engineered spin valve sensor
MTJ (full bridge conﬁguration)
MTJ (stand-alone resistor)
Frequency (kHz)
Normalized output voltage
100
FIGURE  2.7  
Frequency dependence of some selected GMR/MTJ current sensors. (From Cubells-Beltrá n, 
M.-D. et al., International Review of Electrical Engineering (IREE)  6(1), 423–29, 2011.)

49
Giant and Tunnel MR Sensors
2.5  Applications
Now that we have described the principal characteristics of GMR/TMR sen-
sors, we will describe some real applications in which these sensors have 
demonstrated their intrinsic capabilities.
2.5.1  General Purpose Magnetometers (Compass)
The measurement of the Earth’ s magnetic field is the ancient application of 
magnetic field sensors. The Earth’ s magnetic field ranges between approxi-
mately 25 and 60  µ T, which is well covered by GMR/TMR sensors. With the 
increasing demand for digital compasses for mobile applications (mainly 
smartphones), GMR/TMR sensors have entered the market in serious com-
petition with standard Hall solutions. Table  2.1 shows the main parameters 
of some selected MR compasses, including electronics (Reig et al. 2013).
2.5.2  Industrial Applications
2.5.2.1  Automotive
GMR sensors have entered the automotive market in several applications: 
steering angle measurement, rotor position measurement, speed sensing or 
crank shaft speed, and positions sensing. All of these can be classified as 
speed measurement or angle measurement. SV structures are commonly 
preferred for both sets of applications. A typical GMR angle sensor consists 
of several GMR resistors arranged in two bridges, one for each orthogonal 
direction (see Figure  2.8, left). Meandered geometries are used for increasing 
the total resistance to the kiloohms (kΩ ) range. In this way, they provide a 
sine and a cosine signal that can be used in the calculation of the absolute 
angle of the magnetic field vector (see Figure  2.8, right). Due to this measure-
ment principle, only the field direction, not the field magnitude, is relevant. 
The use of the GMR principle allows the measurement of angles in the full 
range of 360°  in contrast to AMR-based sensors that cover only 180° . In any 
case, calibration of the devices is commonly required.
2.5.2.2  Space
In space sector applications, mass, volume, and power savings are important 
issues. GMR sensors are excellent candidates not only in planetary magnetom-
etry, but also as magnetic encoders and angular or position sensors. It must be 
mentioned that space is an environment of extreme parameters, including wide 
temperature swings, very low pressures, moderate to high radiation, mechani-
cal vibrations and impacts, and so on. GMR sensors have been used on several 
occasions in different satellite missions. As a summary, the evolution of MR 

50
Magnetic Sensors and Devices
TABLE  2.1  
Detailed Parameters of Selected Commercial Magnetoresistance-Based Compasses
General
Technology
AMR 
GMR 
MTJ 
Company
MEMSIC
Honeywell
Yamaha
Freescale
Product
MMC314XMR
HMC5883L
YAS529
Mag3110
PKG
PKG
LGA10
LGA16
WLCSP10
DFN10
Size (mm3 )
3  ×   3  ×   1
3  ×   3  ×   0.9
2  ×   2  ×   1
2  ×   2  ×   0.85
I/O
Voltage (V)
1.7–3.6
2.7–5.25
2.16–3.6
1.95–3.6
Working current (mA)
~2
~2
4
> 1
Samples per s @mA
50 @ 0.55
7.5 @ 0.10
4
10 @ 0.14
Interface
I2C
I2C
I2C
I2C
Interrupt
–
–
–
Y
Maximum ratings
Storage temp (° C)
− 55/+125
− 40/+125
− 50/+125
− 40/+125
Operating temp (° C)
− 40/+85
− 30/+85
− 40/+95
− 40/+85
Max exposed field (G)
–
10k
2k
1k
Performance
Range (+/−  G)
4
1–8
3
10
ADC (output bits)
12
12
10
15
Resolution (mG)
2
2
6 (x ,y )/12 (z )
1
Offset (+/−  G)
0.2
–
–
0.01
Accuracy (° )
2
2
5
–
Linearity (%FS)
1
0.1
–
1
Hysteresis (%FS)
0.1
0.0025
–
1
Repeatability (%FS)
–
0.1
–
–
Sensitivity TC (%/° )
0.11
–
–
0.1
Offset TC (mG/° )
0.4
–
–
0.1
Bandwidth (Hz)
40
75
40
40
Noise (RMS)
0.6  mG @ 25  Hz
–
–
0.5  mG
Features
On-chip temp sensor
Y
–
Y
Y
Single-chip integration
–
–
Y
–
Offset removal
Y
Y
–
–
Self test
–
Y
–
–
Others
3 external AD
Oversampling

51
Giant and Tunnel MR Sensors
technologies in space applications is depicted in Figure  2.9 (Dí az-Michelena 
2009).
2.5.2.3  Electric Current Measurement
Traditional methods for measuring an electric current include shunt resistors 
and the transformer principle, and its indirect measurement is by means of 
the generated magnetic field (Ziegler et al. 2009). This latter scheme has suc-
cessfully approached making use of different magnetic field sensors (Pavel 
Ripka and Janosek 2010). In this sense, GMR sensors display some intrinsic 
properties, making them optimal for electric current measurement schemes, 
namely, high sensitivity, capable of integrating with other technologies (PCB 
or CMOS), and the measurement of in-plane magnetic fields. An extensive 
review on the application of GMR sensors in electrical current measurement 
can be found in Reig et al. (2009). The basic scheme is very simple: we just 
need to drive the desired current path to the neighborhood of the sensor, as 
depicted in Figure  2.10a. The sensor can be placed either above or below the 
current path. As observed, the magnetic field lines fall almost parallel to the 
sensor layers.
Sensing performance can be improved by using a bridge configuration. 
When the current path is already defined (usually a straight line), a scheme, 
as shown in Figure  2.10b1, with a half bridge is applicable. In this case, 
R 1  and R 3  are active and R 2  and R 4  are usually shielded as suggested, for 
example, in Singh and Khambadkone (2008) or Vieth et al. (2000). To get the 
full bridge behavior, we can fabricate the sensor with four active (opposite) 
elements (Pelegri Sebastia et al. 2004) or actuate on the design of the cur-
rent path, as illustrated in Figure  2.10b2–b4. The successful application of 
these schemes can be found in Sanchez et al. (2012) and Pannetier-Lecoeur 
Vx (cos_N)
Vx (cos_P)
VY (sin_N)
VY (sin_P)
90°
90°
0°
S
N
0°
0°
90°
180°
270°
360°
Angle a
Y component (sin)
GMR resistors
X component (cos)
VY
VX
VX
ADCX+ ADCX–
ADCY+ ADCY–
V¥
GND
VY
FIGURE  2.8  
Typical arrangement of GMR angle sensors for automotive applications.

52
Magnetic Sensors and Devices
et al. (2007) (Figure  2.10b2); Reig et al. (2004) and Cubells-Beltrá n et al. 
(2009) (Figure  2.10b3); and Reig et al. 2005 and Cubells-Beltrá n et al. (2009) 
(Figure  2.10b4). For an optimal geometric design of the current paths and the 
position of the sensors, numerical models (mainly the finite element method 
[FEM]) are commonly used (Beltran et al. 2007).
Limitations on the performance of GMR-based current sensors arise 
mainly from packaging issues (Cubells-Beltrá n et al. 2011). Most significant 
is heating from the joule effect because of current and bandwidth constraints 
due to the capacitive/inductive coupling of the current path. Thermal drifts 
due to joule heating (Vopalensky and Platil 2013) can be significant not only 
in medium/high current applications, but also in integrated circuits (ICs) 
environments. They can be reduced either with the use of full Wheatstone 
bridge sensors (Reig et al. 2004; Cubells-Beltrá n et al. 2009) or with the use 
of external compensation electronic circuitry (Ramírez Muñ oz et al. 2006; 
Sá nchez Moreno et al. 2011). To properly analyze such effects, numerical 
modeling is commonly used, from both a physical (Beltran et al. 2007) and 
an electrical point of view (Roldá n et al. 2010a).
Actual system “ﬂight proven” through
successful mission operations
NANOSAT launch
December 2004
Launch of CanX-1
DTUsat and
AAU Cubesat
June 2003
AMR technologies
for vehieles
AMR
GMR
Discovery of
the GMR eﬀect
GMR sensor elements
for automotive applications
Demonstration
on-ground
Demonstration
in-ﬂight
Demonstration
in-ﬂight
GMR heads
replace AMR
Flight qualiﬁed
gmr sensor
for OPTOS
OPTOS launch
August 2009
First
sensor
by NVE
First read-out
ed on
GMR
AMR and GMR roadmap to space
1950
TRL - Technology readiness level
1
2
3
4
5
6
7
8
9
1960
1970
1980
Time (years)
1990
2000
2010
System/subsystem model or prototype
demonstration in a relevant
environment
Component and/or breadboard
validation in relevant environment
Component and/or breadboard
validation in laboratory environment
Technology concept and/or
application formulated
Basic principles observed and
reported
Analytical and experimental critical
function and/or characteristic proof
of concept
System prototype demonstration in an
operational environment
Actual system completed and ‘ﬂight
qualiﬁed’ through test and
demonstration
Demonstration
on-ground
FIGURE  2.9  
Recent history of AMR and GMR technologies in space applications. (From Dí az-Michelena, 
M., Sensors (Basel, Switzerland),  9(4), 2271–88, 2009.)

53
Giant and Tunnel MR Sensors
(1)
I
R
(a)
(b1)
(b2)
(b3)
(b4)
H–
r–
(2)
(1’)
A
A
R2
R3
a
c
b
R1
R2
R3
R4
R3
R2
R1
R3
R4
R2
R4
R1
R4
a
a
b
b
a
A
B
B
B
d
d
A
B
c
d
c
d
b
R1
c
(2’)
FIGURE  2.10  
Current measurement with GMR sensors: (a) principle description, (b) different geometrical approaches.

54
Magnetic Sensors and Devices
Specific applications of GMR sensors for electrical current measurement 
include built-in current sensing (BICS) schemes in ICs. This was first demon-
strated in 2005 (Reig et al. 2005) and then improved with low noise devices 
(Pannetier-Lecoeur et al. 2007), using MTJ sensors (Le Phan et al. 2005), full 
bridge arrangements (Cubells-Beltrá n et al. 2009), and improved conditioning 
circuitry (Madrenas et al. 2014). Electric currents in the range of 1  µ A have been 
resolved in this way. In addition, these schemes have become successful when 
integrated with standard CMOS technologies (Cubells-Beltrá n et al. 2014).
We should also mention that GMR sensors have also been used in related 
applications such as analog electric isolators (Reig et al. 2008) and integrated 
wattmeters (Roldá n et al. 2010b).
2.5.3  Non-Destructive Evaluation
Non-destructive evaluation (NDE) refers to any examination, test, or evalu-
ation performed on any type of object without changing or altering it in any 
way, in order to determine the absence (or presence) of discontinuities that 
could jeopardize its functionality. The most common NDE methods are opti-
cal inspection (including non-visible range such as infrared or x-rays), ultra-
sonic tests, and magnetic measurements.
2.5.3.1  Magnetic Detection
As mentioned, magnetic measurements are commonly used in NDE in gen-
eral and scan systems (imaging or detecting) in particular. We can measure 
the magnetic field of the scanned objects (if existing) or the perturbation 
that they produce in the Earth’ s magnetic field. Traditionally, pick-up coils 
and Hall sensors have been used. We will enumerate some of the successful 
applications in which GMR sensors have been considered in these scenarios.
GMR sensors have been successfully used for the detection/monitoring of 
different kinds of objects, including traffic speed monitoring (Pelegrí  Sebastiá  et 
al. 2007), tool vibration (Sebastia et al. 2009), weapon detection (Tian et al. 2012), 
localization of hidden metallic objects (Renhart et al. 2011), robot movement con-
trol (Ku et al. 2000), and even electric guitar monitoring (Lenssen et al. 2002).
Regarding specific imaging techniques (also scanning microscopy), GMR 
sensors have been applied to the evaluation of current faults at the IC level 
with sub-micron resolution involving electric currents below 1  mA (Reig et 
al. 2013). The magnetic field microscopy of rock samples using a GMR-based 
scanning magnetometer has also been reported (Hankard et al. 2009).
2.5.3.2  Eddy Current Testing
Within magnetic field–based techniques, eddy current testing (ECT) has 
been specifically considered in a wide range of modern testing processes, 
including defects in metallic surfaces and subsurfaces.

55
Giant and Tunnel MR Sensors
Eddy currents are closed loops of induced current circulating in a plane 
that is perpendicular to the direction of a time-varying magnetic flux den-
sity B  , as depicted in Figure  2.11. The variation of B   generates an electric 
field intensity E  , in a loop as expressed by the Maxwell equation:
	
∇×
= −∂
∂
E
B
t 	
Therefore, the current density J, in a material with conductivity σ, also cir-
culates in the loop, because
	
J
E
= σ
	
Such currents, due to conductivity σ, can degrade the performance of the 
affected surfaces, but they can also be used for detecting flaws or cracks 
on metallic materials, conductivity variations, spacing between probe and 
device under test, material thickness, thickness of platting or cladding on a 
base material, spacing between conductive layers, or permeability variations.
The concept of using GMR in ECT measurements was first introduced 
by Dogaru and Smith (2001), through two geometrical approaches tak-
ing advantage of the inherent properties of GMR sensors, as detailed in 
Figure  2.11. In this particular experiment, currents of the order of 1  A at 
30  kHz were used for the exciting coils, and NVE commercial unipolar 
devices (~25  mV/V/mT sensitivity, 2  mT, linear range) as GMR sensors. In 
this way, cracks 1–15  mm long, 0.5  mm wide, and 0.25–4  mm deep were 
Magnetic ﬁelds
from exciting coil
Magnetic ﬁelds
from
eddy currents
Eddy currents
Ammeter
GMR sensor
Pick-up coil
AC
Exciting coil
FIGURE  2.11  
Scheme of an eddy current testing system, with a GMR as sensing element.

56
Magnetic Sensors and Devices
scanned. A similar system with portable characteristics is described in 
Betta et al. 2012). By including a feedback coil in the scheme in Figure  2.12, 
resolution in depth can be achieved (Jeng et al. 2006). The depth of the 
defects can also be detected (Espina-Herná ndez et al. 2012). In this scenario, 
the use of numerical models (mainly based on FEM) is highly helpful (Zeng 
et al. 2011).
ECT based on GMR sensors has been extensively applied to the evalu-
ation of PCBs. Initially, Chomsuwan and co-workers (Yamada et al. 2004) 
demonstrated it with a specifically designed SV sensor (200  mV/mT sen-
sitivity) with a printed meandered coil, by mapping PCB defects of the 
order of 100  µ m size. These results were better than those obtained with 
a pick-up coil–based system. Novel experiments were performed on 
high-density double-layer PCBs with an improved ECT probe including 
an optimized meander coil and an array of GMR sensors (Chomsuwan 
et al. 2005, 2007a,b). Defects with sizes below 100  µ m were resolved on 
both sides of the PCB. This topic is revisited frequently (Cacciola et al. 
2011).
The ECT technique based on GMR sensors has also been applied to the 
evaluation of the health of an aircraft’ s structure (Nair et al. 2006). Pulsed 
currents have been demonstrated to improve the performance of ECT probes 
in this sense (Tamburrino et al., 2010).
2.5.4  Bio-Applications
Magnetic fields (generated and/or measured) are extensively used in bio-
logic sciences including genetics, bio-technology, different fields of medi-
cine (physiology, oncology, etc.), among others. Most of these applications 
require the measurement of very low magnetic fields (below the nT limit) in 
small spaces (commonly in the sub-mm range). At the beginning of the cen-
tury, MR sensors started to be explored as the sensing elements in biochips. 
A biosensor can be deﬁ ned as a “ compact analytical device or unit incor-
porating a biological or biologically-derived sensitive element integrated or 
associated with a physio-chemical transducer”  (Graham et al. 2004).
GMR sensor
Coil
Crack
Especiment
FIGURE  2.12  
Different arrangements for integrating GMR sensors with exciting coils in ECT systems.

57
Giant and Tunnel MR Sensors
2.5.4.1  Detection of Bioanalytes
General bioanalytes (molecules, cells, viruses, bacteria, tissues) are not 
magnetic. In order to take advantage of GMR for monitoring or detecting 
bioanalytes, they must be bonded to magnetic elements (usually nanopar-
ticles [NPs]) (Wang et al. 2014; Lee et al. 2009) and driven near the sensor by 
means of microfluidics (Muluneh and Issadore 2014) or guiding magnetic 
fields (Giouroudi and Keplinger 2013; Gooneratne et al. 2011). GMR sensors 
have been successfully applied to the detection of proteins (Gaster et al. 2011), 
DNA (Wang et al. 2013), viruses (Zhi et al. 2014), and bacteria (Mujika et al. 
2009). In this way, two approaches can be defined: static and dynamic, as 
depicted in Figure  2.13.
An example of the static approach is the analysis of DNA (Koets et al. 2009). 
For DNA detection, single-stranded DNA receptors are first immobilized on 
the surface of magnetic sensors. Oligonucleotides of unknown sequence are 
selectively captured by complementary probes. SA-coated magnetic NPs are 
then introduced and bind to the biotin of the hybridized DNA. Finally, mag-
netic ﬁ eld disturbances because of the NPs are sensed by magnetic sensors. 
Biotin and streptavidin are often used in this process (Wang et al. 2013). To 
improve the performance of the sensor system, microcoils can be integrated 
in association with the sensing elements. These coils generate a magnetic 
field that is used to attract the magnetic beads to the sensor area and activate 
them (Freitas et al. 2011). In this way, the femtomolar limit of detection has 
been achieved.
For the detection of general cells (cytometry), magnetic nanobeads need 
to be bonded to them (Freitas et al. 2012). Then, by means of microfluidics 
or guiding magnetic fields, they are driven close to the sensors, where the 
detection is performed, as described in Shoshi et al. (2012).
H
(a)
(b)
H
FIGURE   2.13  
Static (a) and dynamic (b) approaches for bioanalytes detection with GMR sensors.

58
Magnetic Sensors and Devices
2.5.4.2  Monitoring of Magnetic Fluids
Fluids incorporating magnetic particles (usually nanobeads) are known as 
magnetic fluids . They can be made biocompatible for in vivo  applications, such 
as hyperthermia cancer therapy. A magnetic fluid is injected into the affected 
area and an external ac magnetic flux density is applied to exploit the self-
heating properties of the magnetic beads in the fluid. Temperatures in excess 
of 42° C destroy tumors (Reig et al. 2013). Hence, the accurate estimation of 
magnetic fluid content density is critical for the success of the treatment. In 
Mukhopadhyay et al. (2007), a GMR-based needle probe  20 mm long and 
310  µ m wide, comprising four SV sensors was analyzed. The needle probe 
was successfully tested in tumor-simulating cylindrical agar cavities.
2.5.4.3  Biomedical Signal Detection
GMR/TMR-based micromachined probe needles have also been designed 
for detecting brain activity through the measurement of generated mag-
netic fields. After demonstrating the concept (Amaral et al. 2011), MTJ-based 
microneedles were developed and characterized (Amaral et al. 2013). The 
associated electronics were also specifically implemented (Costa et al. 2014).
A non-invasive detection system for magnetocardiography applications 
has also been described by Pannetier-Lecoeur et al. (2010), where a GMR 
sensor is integrated with a high-temperature superconductor (YBCO).
2.6  Conclusions
GMR/TMR sensors have rapidly passed their initial potentiality in real 
applications and have become the first option in a huge number of scenar-
ios demanding the measurement of low magnetic fields with a high level 
of integration devices. Complete knowledge of the underlying phenomena 
has allowed the specific design of different kinds of devices. Their SNR, and 
subsequent detectivity, make them suitable for most applications in different 
fields such as bio-technology, microelectronics, and space.
Acknowledgments
The authors are grateful for the very fruitful collaborations that have made 
possible some of the results presented in this chapter: INESC-MN (Lisboa, 
Portugal), University of L’ Aquila (Italy), UPC (Barcelona, Spain), and CNM 
(Barcelona, Spain).

59
Giant and Tunnel MR Sensors
References 
Ač , V. 2008. A study of hysteresis in the GMR layer structures by FEM. Physica B: 
Condensed Matter  403 (2–3): 460–63.
Amaral, J., S. Cardoso, P. P. Freitas, and A. M. Sebastiã o. 2011. Toward a system to 
measure action potential on mice brain slices with local magnetoresistive 
probes. Journal of Applied Physics  109 (7): 07B308.
Amaral, J., V. Pinto, T. Costa, J. Gaspar, R. Ferreira, E. Paz, S. Cardoso, and P. P. Freitas. 
2013. Integration of TMR sensors in silicon microneedles for magnetic mea-
surements of neurons. IEEE Transactions on Magnetics  49 (7): 3512–15.
André s, J. P., J. Colino, and J. M. Riveiro. 1999. Enhancement of GMR in as-depos-
ited Co-Cu granular films with RF sputtering power. Journal of Magnetism and 
Magnetic Materials  196–197 (May): 493–94.
Baibich, M. N., J. M. Broto, A. Fert, F. N. Vandau, F. Petroff, P. Eitenne, G. Creuzet, A. 
Friederich, and J. Chazelas. 1988. Giant magnetoresistance of (001)Fe/(001)Cr 
magnetic superlattices. Physical Review Letters  61 (21): 2472–75.
Beltran, H., C. Reig, V. Fuster, D. Ramí rez, and M. D. Cubells-Beltrá n. 2007. Modeling 
of magnetoresistive-based electrical current sensors: A technological approach. 
IEEE Sensors Journal  7 (11): 1532–37.
Betta, G., L. Ferrigno, and M. Laracca. 2012. GMR-based ECT instrument for detec-
tion and characterization of crack on a planar specimen: A hand-held solution. 
IEEE Transactions on Instrumentation and Measurement  61 (2): 505–12.
Binasch, G., P. Grunberg, F. Saurenbach, and W. Zinn. 1989. Enhanced magneto-
resistance in layered magnetic-structures with antiferromagnetic interlayer 
exchange. Physical Review B  39 (7): 4828–30.
Cacciola, M., G. Megali, D. Pellicanó , and F. C. Morabito. 2011. A GMR–ECT based 
embedded solution for applications on PCB inspections. Sensors and Actuators 
A: Physical  167 (1): 25–33.
Cardoso, F. A., H. A. Ferreira, J. P. Conde, V. Chu, P. P. Freitas, D. Vidal, J. Germano, 
et al. 2006. Diode/magnetic tunnel junction cell for fully scalable matrix-based 
biochip. Journal of Applied Physics  99 (8): 08B307.
Chen, X., and P. P. Freitas. 2012. Magnetic tunnel junction based on MgO barrier prepared 
by natural oxidation and direct sputtering deposition. Nano-Micro Letters  4 (1): 25–29.
Chomsuwan, K., S. Yamada, and M. Iwahara. 2007a. Improvement on defect detec-
tion performance of PCB inspection based on ECT technique with multi-SV-
GMR sensor. IEEE Transactions on Magnetics  43 (6): 2394–96.
Chomsuwan, K., S. Yamada, and M. Iwahara. 2007b. Bare PCB inspection system with 
SV-GMR sensor eddy-current testing probe. IEEE Sensors Journal  7 (5): 890–96.
Chomsuwan, K., S. Yamada, M. Iwahara, H. Wakiwaka, and S. Shoji. 2005. Application 
of eddy-current testing technique for high-density double-layer printed circuit 
board inspection. IEEE Transactions on Magnetics  41 (10): 3619–21.
Costa, T., M. S. Piedade, J. Germano, J. Amaral, and P. P. Freitas. 2014. A neuronal 
signal detector for biologically generated magnetic fields. IEEE Transactions on 
Instrumentation and Measurement  63 (5): 1171–80.
Cubells-Beltrá n, M. D., C. Reig, A. De Marcellis, E. Figueras, A. Yú fera, B. Zadov, 
E. Paperno, S. Cardoso, and P. P. Freitas. 2014. Monolithic integration of giant 
magnetoresistance (GMR) devices onto standard processed CMOS dies. 
Microelectronics Journal  45 (6): 702–7.

60
Magnetic Sensors and Devices
Cubells-Beltrá n, M.-D., C. Reig, J. Martos, J. Torres, and J. Soret. 2011. Limitations 
of magnetoresistive current sensors in industrial electronics applications. 
International Review of Electrical Engineering (IREE)  6 (1): 423–29.
Cubells-Beltrá n, M. D., C. Reig, D. R. Muñ oz, S. I. P. C. de Freitas, and P. J. P. De Freitas. 
2009. Full Wheatstone bridge spin-valve based sensors for IC currents monitor-
ing. IEEE Sensors Journal  9 (12): 1756–62.
Dí az-Michelena, M. 2009. Small magnetic sensors for space applications. Sensors 
(Basel, Switzerland)  9 (4): 2271–88.
Dogaru, T., and S. T. Smith. 2001. Giant magnetoresistance-based eddy-current sen-
sor. IEEE Transactions on Magnetics  37 (5): 3831–38.
Espina-Herná ndez, J. H., E. Ramí rez-Pacheco, F. Caleyo, J. A. Pé rez-Benitez, and J. 
M. Hallen. 2012. Rapid estimation of artificial near-side crack dimensions in 
aluminium using a GMR-based eddy current sensor. NDT & E International  51 
(October): 94–100.
Ferreira, R., P. Wisniowski, P. P. Freitas, J. Langer, B. Ocker, and W. Maass. 2006. 
Tuning of MgO barrier magnetic tunnel junction bias current for picotesla 
magnetic field detection. Journal of Applied Physics  99 (8): 08K706.
Freitas, P. P., F. A. Cardoso, V. C. Martins, S. A. M. Martins, J. Loureiro, J. Amaral, R. 
C. Chaves, et al. 2012. Spintronic platforms for biomedical applications. Lab on 
a Chip  12 (3): 546–57.
Freitas, P. P., S. Cardoso, R. Ferreira, V. C. Martins, A. Guedes, F. A. Cardoso, J. 
Loureiro, R. Macedo, R. C. Chaves, and J. Amaral. 2011. Optimization and inte-
gration of magnetoresistive sensors. SPIN  01 (01): 71–91.
Freitas, P. P., R. Ferreira, S. Cardoso, and F. Cardoso. 2007. Magnetoresistive sensors. 
Journal of Physics: Condensed Matter  19 (16). IOP Publishing: 165221.
Gaster, R. S, L. Xu, S-J. Han, R. J. Wilson, D. A. Hall, S. J. Osterfeld, H. Yu, and S. X. 
Wang. 2011. Quantification of protein interactions and solution transport using 
high-density GMR sensor arrays. Nature Nanotechnology  6 (5): 314–20.
Giouroudi, I., and F. Keplinger. 2013. Microfluidic biosensing systems using mag-
netic nanoparticles. International Journal of Molecular Sciences  14 (9): 18535–56.
Gooneratne, C. P., C. Liang, and J. Kosel. 2011. A planar conducting microstructure to 
guide and confine magnetic beads to a sensing zone. Microelectronic Engineering  
88 (8): 1757–60.
Graham, D. L., H. A. Ferreira, and P. P. Freitas. 2004. Magnetoresistive-based biosen-
sors and biochips. Trends in Biotechnology  22 (9): 455–62.
Guerrero, R., M. Pannetier-Lecoeur, C. Fermon, S. Cardoso, R. Ferreira, and P. P. 
Freitas. 2009. Low frequency noise in arrays of magnetic tunnel junctions con-
nected in series and parallel. Journal of Applied Physics  105 (11): 113922.
Hall, D. A., R. S. Gaster, K. Makinwa, S. X. Wang, and B. Murmann. 2013. A 256 pixel 
magnetoresistive biosensor microarray in 0.18μ m CMOS. IEEE Journal of Solid-
State Circuits  48 (5): 1290–1301.
Han, J., J. Hu, Y. Ouyang, S. X. Wang, and J. He. 2015. Hysteretic modeling of output 
characteristics of giant magnetoresistive current sensors. IEEE Transactions on 
Industrial Electronics  62 (1): 516–24.
Hankard, F., J. Gattacceca, C. Fermon, M. Pannetier-Lecoeur, B. Langlais, Y. Quesnel, 
P. Rochette, and S. A. McEnroe. 2009. Magnetic field microscopy of rock samples 
using a giant magnetoresistance-based scanning magnetometer. Geochemistry, 
Geophysics, Geosystems  10: Q10Y06.

61
Giant and Tunnel MR Sensors
He, H., K. Zhernenkov, M. Vadala ́ , N. Akdogan, D. Gorkov, R. M. Abrudan, B. P. 
Toperverg, H. Zabel, H. Kubota, and S. Yuasa. 2010. The effect of annealing on 
the junction profile of CoFeB/MgO tunnel junctions. Journal of Applied Physics  
108 (6): 063922.
Hirota, E., H. Sakakima, and K. Inomata. 2002. Giant Magneto-Resistance 
Devices . Vol. 40. Springer Series in Surface Sciences. Berlin: Springer. 
doi:10.1007/978-3-662-04777-4.
Hooge, F. N. 1976. 1/f  noise. Physica B+C  83 (1): 14–23.
Jedlicska, I., R. Weiss, and R. Weigel. 2010. Linearizing the output characteristic 
of GMR current sensors through hysteresis modeling. IEEE Transactions on 
Industrial Electronics  57 (5): 1728–34.
Jeng, J.-T., G-S. Lee, W-C. Liao, and C-L. Shu. 2006. Depth-resolved eddy-current 
detection with GMR magnetometer. Journal of Magnetism and Magnetic Materials  
304 (1): e470–73.
Johnson, J. B. 1928. Thermal agitation of electricity in conductors. Physical Review  32 
(1): 97–109.
Koets, M., T. van der Wijk, J. T. W. M. van Eemeren, A. van Amerongen, and M. W. J. 
Prins. 2009. Rapid DNA multi-analyte immunoassay on a magneto-resistance 
biosensor. Biosensors and Bioelectronics  24 (7): 1893–98.
Ku, W., P. P. Freitas, P. Compadrinho, and J. Barata. 2000. Precision X-Y robotic object 
handling using a dual GMR bridge sensor. IEEE Transactions on Magnetics  36 
(5): 2782–84.
Le, P., K., H. Boeve, F. Vanhelmont, T. Ikkink, and W. Talen. 2005. Geometry opti-
mization of TMR current sensors for on-chip IC testing. IEEE Transactions on 
Magnetics  41 (10): 3685–87.
Lee, K., S. Lee, B. K. Cho, K-S. Kim, and B. Kim. 2009. The limit of detection of giant 
magnetoresistive (GMR) sensors for bio-applications. Journal of the Korean 
Physical Society  55 (1): 193–96.
Lenssen, K.-M. H., G. H. J. Somers, and J. B. A. D. van Zon. 2002. Magnetoresistive 
sensors for string instruments. Journal of Applied Physics  91 (10): 7777.
Liu, S., Q. Huang, Y. Li, and W. Zhen. 2012. Experimental research on hysteresis 
effects in GMR sensors for analog measurement applications. Sensors and 
Actuators A: Physical  182 (August): 72–81.
Lopez-Martin, A. J., and A. Carlosena. 2009. Performance tradeoffs of three novel 
GMR contactless angle detectors. IEEE Sensors Journal  9 (3): 191–98.
Madrenas, J., M.-D. Cubells-Beltrá n, B. Zadov, S. Cardoso, C. Reig, P. P. Freitas, E. 
Paperno, and A. De Marcellis. 2014. Quasi-digital front-ends for current mea-
surement in integrated circuits with giant magnetoresistance technology. IET 
Circuits, Devices {&} Systems  8 (4): 291–300.
Mujika, M., S. Arana, E. Castañ o, M. Tijero, R. Vilares, J. M. Ruano-Ló pez, A. Cruz, 
L. Sainz, and J. Berganza. 2009. Magnetoresistive immunosensor for the detec-
tion of Escherichia coli  O157:H7 including a microfluidic network. Biosensors & 
Bioelectronics  24 (5): 1253–58.
Mukhopadhyay, S. C., K. Chomsuwan, C. P. Gooneratne, and S. Yamada. 2007. A 
novel needle-type SV-GMR sensor for biomedical applications. IEEE Sensors 
Journal  7 (3): 401–8.
Muluneh, M., and D. Issadore. 2014. A multi-scale PDMS fabrication strategy to 
bridge the size mismatch between integrated circuits and microfluidics. Lab on 
a Chip  14 (23): 4552–58.

62
Magnetic Sensors and Devices
Nair, N. V., V. R. Melapudi, H. R. Jimenez, X. Liu, Y. Deng, Z. Zeng, L. Udpa, T. J. 
Moran, and S. S. Udpa. 2006. A GMR-based eddy current system for NDE of 
aircraft structures. IEEE Transactions on Magnetics  42 (10): 3312–14.
Nyquist, H. 1928. Thermal agitation of electric charge in conductors. Physical Review  
32 (1): 110–13.
Pannetier-Lecoeur, M., C. Fermon, A. de Vismes, E. Kerr, and L. Vieux-Rochaz. 2007. 
Low noise magnetoresistive sensors for current measurement and compasses. 
Journal of Magnetism and Magnetic Materials  316 (2): e246–48.
Pannetier-Lecoeur, M., C. Fermon, H. Dyvorne, J. F. Jacquinot, H. Polovy, and A. 
L. Walliang. 2010. Magnetoresistive-superconducting mixed sensors for bio-
magnetic applications. Journal of Magnetism and Magnetic Materials  322 (9–12): 
1647–50.
Pelegrí  Sebastiá , J., J. Alberola Lluch, and J. Rafael Lajara Vizcaí no. 2007. Signal condi-
tioning for GMR magnetic sensors applied to traffic speed monitoring. Sensors 
and Actuators A: Physical  137 (2): 230–35.
Pelegri Sebastia, J., D. R. Munoz, and P. J. P. de Freitas. 2004. A novel spin-valve bridge 
sensor for current sensing. IEEE Transactions on Instrumentation and Measurement  
53 (3): 877–80.
Peñ a, V., Z. Sefrioui, D. Arias, C. Leon, J. Santamaria, J. L. Martinez, S. G. E. Te 
Velthuis, and A. Hoffmann. 2005. Giant magnetoresistance in ferromagnet/
superconductor superlattices. Physical Review Letters  94 (5): 057002.
Pullini, D., D. Busquets, A. Ruotolo, G. Innocenti, and V. Amigó . 2007. Insights into 
pulsed electrodeposition of GMR multilayered nanowires. Journal of Magnetism 
and Magnetic Materials  316 (2): e242–45.
Ramírez Muñoz, D., J. Sá nchez Moreno, S. Casans Berga, E. Castro Montero, C. Reig 
Escrivà , and A. Edith Navarro Anto ́ n. 2006. Temperature compensation of 
Wheatstone bridge magnetoresistive sensors based on generalized impedance con-
verter with input reference current. Review of Scientific Instruments  77 (10): 105102.
Ranchal, R., M. Torija, E. Ló pez, M. C. Sá nchez, C. Aroca, and P. Sá nchez. 2002. The 
influence of anisotropy on the magnetoresistance of permalloy-copper-permal-
loy thin films. Nanotechnology  13 (3): 392–97.
Reig, C., S. Cardoso, and S. Mukhopadhyay. 2013. Giant Magnetoresistance (GMR) 
Sensors: From Basis to State-of-the-Art Applications . Berlin: Springer.
Reig, C., M.-D. Cubells-Beltran, D. Ramirez, S. Cardoso, and P.P. Freitas. 2008. 
Electrical isolators based on tunneling magnetoresistance technology. IEEE 
Transactions on Magnetics 44 (11): 4011–14.
Reig, C., M.-D. Cubells-Beltran, and D. Ramí rez Muñ oz. 2009. Magnetic field sensors 
based on giant magnetoresistance (GMR) technology: Applications in electrical 
current sensing. Sensors (Basel, Switzerland)  9 (10): 7919–42.
Reig, C., D. Ramirez, H. H. Li, and P. P. Freitas. 2005. Low-current sensing with specular 
spin valve structures. IEE Proceedings: Circuits, Devices and Systems  152 (4): 307–11.
Reig, C., D. Ramí rez, F. Silva, J. Bernardo, P. Freitas, D. Ramı ́ rez, F. Silva, J. Bernardo, 
and P. Freitas. 2004. Design, fabrication, and analysis of a spin-valve based cur-
rent sensor. Sensors and Actuators, A: Physical  115: 259–66.
Renhart, W., M. Bellina, C. Magele, and A. Kö stinger. 2011. Hidden metallic object 
localization by using giant magnetic resistor sensors. COMPEL: The International 
Journal for Computation and Mathematics in Electrical and Electronic Engineering  30 
(6): 1927–37.

63
Giant and Tunnel MR Sensors
Ripka, P., and M. Janosek. 2010. Advances in magnetic field sensors. IEEE Sensors 
Journal  10 (6): 1108–16.
Ripka, P., M. Tondra, J. Stokes, and R. Beech. 1999. AC-driven AMR and GMR magne-
toresistors. Sensors and Actuators A: Physical  76 (1–3): 225–30.
Roldá n, A., C. Reig, M. D. Cubells-Beltrá n, J. B. Roldá n, D. Ramí rez, S. Cardoso, and P. 
P. Freitas. 2010a. Analytical compact modeling of GMR based current sensors: 
Application to power measurement at the IC level. Solid-State Electronics  54 (12): 
1606–12.
Roldá n, A., C. Reig, M. D. D. Cubells-Beltrá n, J. B. B. Roldá n, D. Ramí rez, S. Cardoso, 
and P. P. P. Freitas. 2010b. Analytical compact modeling of GMR based cur-
rent sensors: Application to power measurement at the IC level. Solid-State 
Electronics  54 (12): 1606–12.
Sanchez, J., D. Ramirez, S. I. Ravelo, A. Lopes, S. Cardoso, R. Ferreira, and P. P. Freitas. 
2012. Electrical characterization of a magnetic tunnel junction current sensor 
for industrial applications. IEEE Transactions on Magnetics  48 (11): 2823–26.
Sá nchez Moreno, J., D. Ramí rez Muñ oz, S. Cardoso, S. Casans Berga, A. E. Navarro 
Antó n, and P. J. Peixeiro de Freitas. 2011. A non-invasive thermal drift com-
pensation technique applied to a spin-valve magnetoresistive current sensor. 
Sensors (Basel, Switzerland)  11 (3): 2447–58.
Sebastia, J. P., J. Alberola Lluch, J. R. Lajara Vizcaino, and J. Santiso Bellon. 2009. 
Vibration detector based on GMR sensors. IEEE Transactions on Instrumentation 
and Measurement  58 (3): 707–12.
Shoshi, A., J. Schotter, P. Schroeder, M. Milnera, P. Ertl, V. Charwat, M. Purtscher, 
et al. 2012. Magnetoresistive-based real-time cell phagocytosis monitoring. 
Biosensors & Bioelectronics  36 (1): 116–22.
Singh, R. P., and A. M. Khambadkone. 2008. Giant magneto resistive (GMR) effect 
based current sensing technique for low voltage/high current voltage regulator 
modules. IEEE Transactions on Power Electronics  23 (2): 915–25.
Singh, R. P., and A. M. Khambadkone. 2014. A giant magneto resistive (GMR) effect 
based current sensor with a toroidal magnetic core as flux concentrator and 
closed-loop configuration. IEEE Transactions on Applied Superconductivity  24 (3): 
1–5.
Stutzke, N. A., S. E. Russek, D. P. Pappas, and M. Tondra. 2005. Low-frequency noise 
measurements on commercial magnetoresistive magnetic field sensors. Journal 
of Applied Physics  97 (10): 10Q107.
Tamburrino, A., L. Udpa, and S. S. Udpa. 2010. Pulsed eddy-current based giant mag-
netoresistive system for the inspection of aircraft structures. IEEE Transactions 
on Magnetics  46 (3): 910–17.
Thompson, S. M. 2008. The discovery, development and future of GMR: The Nobel 
Prize 2007. Journal of Physics D: Applied Physics  41 (9): 093001.
Tian, G. Y., A. Al-Qubaa, and J. Wilson. 2012. Design of an electromagnetic imaging 
system for weapon detection based on GMR sensor arrays. Sensors and Actuators 
A: Physical  174 (February): 75–84.
Vieth, M., W. Clemens, H. van den Berg, G. Rupp, J. Wecker, and M. Kroeker. 2000. 
Contactless current detection with GMR sensors based on an artificial antifer-
romagnet (AAF) subsystem. Sensors and Actuators A: Physical  81 (1–3): 44–48.
Vopalensky, M., and A. Platil. 2013. Temperature drift of offset and sensitivity in full-
bridge magnetoresistive sensors. IEEE Transactions on Magnetics  49 (1): 136–39.

64
Magnetic Sensors and Devices
Vopá lenský , M., P. Ripka, J. Kubı ́ k, and M. Tondra. 2004. Improved GMR sensor bias-
ing design. Sensors and Actuators A: Physical  110 (1–3): 254–58.
Wang, W., Y. Wang, L. Tu, Y. Feng, T. Klein, and J.-P. Wang. 2014. Magnetoresistive 
performance and comparison of supermagnetic nanoparticles on giant mag-
netoresistive sensor-based detection system. Scientific Reports  4 (January): 5716.
Wang, W., Y. Wang, L. Tu, T. Klein, Y. Feng, and J.-P. Wang. 2013. Surface modification 
for protein and DNA immobilization onto GMR biosensor. IEEE Transactions on 
Magnetics  49 (1): 296–99.
Yamada, S., K. Chomsuwan, Y. Fukuda, M. Iwahara, H. Wakiwaka, and S. Shoji. 2004. 
Eddy-current testing probe with spin-valve type GMR sensor for printed cir-
cuit board inspection. IEEE Transactions on Magnetics  40 (4): 2676–78.
Zeng, Z., Y. Deng, X. Liu, L. Udpa, S. S. Udpa, B. E. C. Koltenbah, R. H. Bossi, and G. 
Steffes. 2011. EC-GMR data analysis for inspection of multilayer airframe struc-
tures. IEEE Transactions on Magnetics  47 (12): 4745–52.
Zhi, X., M. Deng, H. Yang, G. Gao, K. Wang, H. Fu, Y. Zhang, D. Chen, and D. Cui. 
2014. A novel HBV genotypes detecting system combined with microfluidic 
chip, loop-mediated isothermal amplification and GMR sensors. Biosensors & 
Bioelectronics  54 (April): 372–77.
Ziegler, S., R. C. Woodward, H. Ho-Ching Iu, and L. J. Borle. 2009. Current sensing 
techniques: A review. IEEE Sensors Journal  9 (4): 354–76.
Ziese, M., and M. J. Thornton. 2001. Spin Electronics . Lecture Notes in Physics . Berlin: 
Springer-Verlag.

65
3
Frequency Tuning Investigation of an Out-
of-Plane Resonant Microstructure for a 
Capacitive Detection Magnetometer
Petros Gkotsis, Mohamed Hadj Said, Farès Tounsi, 
Brahim Mezghani, and Laurent A. Francis
ABSTRACT  In this chapter, we are interested in resonant magnetic sen-
sors using capacitive detection. Specifically, we will analyze their sensing 
behavior and their performances. The device under test, the xylophone mag-
netometer, is a sensor designed and fabricated at the Université Catholique 
de Louvain (UCL), Belgium. This design is different from other designs gen-
erally reported in literature because it relies on interdigitated finger elec-
trodes for sensing. Moreover, we will study potential problems that can 
provide an erroneous operation of this kind of magnetometer design and 
report possible solutions.
CONTENTS
3.1	
Introduction...................................................................................................66
3.2	
Lorentz Force– Based Capacitive Magnetometers....................................67
3.2.1	 In-Plane Capacitive Detection.........................................................67
3.2.2	 Out-of-Plane Capacitive Detection.................................................70
3.3	
Magnetometer with Capacitive Detection................................................ 74
3.4	
Mechanical and Electrical Behavior........................................................... 76
3.4.1	 Magnetometer Mechanical Model Analysis................................. 76
3.4.2	 Electric Model Analysis...................................................................79
3.4.3	 Magnetometer Sensitivity Evaluation............................................81
3.5	
Frequency Tuning by Applying dc Voltage..............................................85
3.5.1	 Physical Modeling............................................................................86
3.5.2	 Numerical Resolution.......................................................................89
3.5.3	 Experimental Validation and Discussion......................................95
3.6	
Conclusion.....................................................................................................98
References ...............................................................................................................98

66
Magnetic Sensors and Devices
3.1  Introduction
Micromechanical resonators are the basic components of numerous 
microdevices, such as accelerometers [1,2], microelectromechanical filters 
[3– 5], gyroscopes [6,7], and magnetometers [8,9]. Resonant magnetometers 
are magnetic field sensors that exploit the Lorentz force exerted on resonat-
ing micromachined structures. It is a kind of inertial microelectromechani-
cal system (MEMS) that uses a spring-mass resonant system. Indeed, when 
an alternating current (ac) passes through the resonant structure and is cou-
pled to a magnetic field, a Lorentz force is generated and the resulting dis-
placement of the structure can be measured either by optical, piezoresistive, 
piezoelectric, or capacitive sensing techniques [10]. If the frequency of the ac 
is set equal to one of the resonance frequencies of the suspended structure 
(generally chosen the first), the amplitude of the resulting vibration will be 
maximum. These resonant sensors can detect magnetic fields up to 1  T with 
a resolution down to 1  nT, and have a wide sensitivity range [11]. They could 
compete with fluxgate sensors and Hall sensors in numerous applications 
where the measurement of magnetic fields is a requirement [11]. In this chap-
ter, we are interested in resonant magnetic sensors using capacitive detection. 
Specifically, we will analyze their sensing behavior and their performances. 
The device under test, the xylophone magnetometer, is a sensor that has 
been designed and fabricated at the Université  Catholique de Louvain (UCL), 
Belgium. This design is different from other designs generally reported in 
the literature because it relies on interdigitated finger electrodes for sens-
ing. Moreover, we will study potential problems that can provide erroneous 
operation of this kind of magnetometer design and report possible solutions.
This chapter is organized as follows: in the first section, we discuss the 
operational principle of capacitive magnetometers for both in-plane and out-
of-plane detection reported in the literature. We then present the xylophone 
bar magnetometer designed at the UCL and its operation, and the mechani-
cal and electrical properties of this microsensor are evaluated. Next, the main 
part of this chapter, is a detailed method for tuning the resonant frequency of 
the microresonant clamped-clamped beam by applying an external potential. 
The resonant frequency of the structure is tuned by applying a direct current 
(dc) bias voltage between the interdigitated comb fingers defined on both the 
moving part of the sensor and the stationary part of the substrate, in order 
to control the spring constant of the moving part. It has been observed that 
an applied dc voltage causes the resonant frequency to shift to higher val-
ues, especially for small vibrations. A simple analytic model has been devel-
oped to accurately describe the shift. The measured resonance frequency of 
the clamped-clamped beam structure changed by up to 38% from its original 
value (around 18.8  kHz) when a bias voltage of 52  V was applied. Tuning the 
resonant frequency of the resonating structure has many advantages for the 
magnetometer as it can serve as a feedback mechanism for error compensation.

67
Out-of-Plane Resonant Capacitive Detection Magnetometer
3.2  Lorentz Force– Based Capacitive Magnetometers
Capacitive detection is widely used in many applications due to its afford-
ability and superior performance in terms of noise and low power consump-
tion [12]. Specifically, the capacitive technique is commonly used in MEMS 
magnetometers [12]. Generally, the magnetometer comprises a resonant 
structure that vibrates due to the Lorentz force when a magnetic field inter-
acts with a current passing through the resonant structure. This vibration 
causes a periodic capacitance variation between the fixed and the moving 
electrodes, which can be measured. This change in capacitance, which is 
generally part of an electronic resonating circuit, introduces a variation in 
the resonant frequency and/or in the output voltage. Therefore, measure-
ment of the magnetic field is achieved by measuring the frequency and/or 
the voltage shift. Several magnetometers using the capacitive method have 
been presented in the literature; most of them were designed to improve the 
magnetometer performance by using different types of capacitance struc-
tures, and different ways of detection, including in-plane and out-of-plane 
detection, have been demonstrated. The next section summarizes some of 
these magnetometers and their performance.
3.2.1  In-Plane Capacitive Detection
Magnetometers based on in-plane capacitive detection are usually based on 
interdigitated fingers; moving and fixed fingers to detect the magnetic field. 
These types of magnetometers require a complex fabrication process [13].
During 2000, Emmerich proposed a new prototype shown in Figure  3.1. 
This proposed sensor has capacitive finger– type electrodes defined on a 
moving beam (moving electrodes) that is perpendicular to the excitation 
path and stationary finger– type electrodes that are bonded to the substrate 
(fixed part) [14]. Due to the presence of the Lorentz force, the moving beam 
position varies, leading to a capacitance change proportional to the applied 
magnetic field. First mode of resonance has been used to achieve maximum 
displacement. The sensor was fabricated using Bosch’ s standard surface 
micromachining process, which is used in many sensors such as accelerom-
eters [15,16] and gyroscopes [17,18]. The fabrication process starts with a ther-
mally grown oxide on a silicon substrate followed by a polycrystalline silicon 
layer, which is deposited on top of the oxide and then doped and patterned. 
Then, a sacrificial oxide layer is deposited and patterned, and a thick polysili-
con (epi-poly) is grown and doped. Finally, as a conductor layer, aluminum is 
deposited on top of the stack followed by trench etching of the epi-poly layer 
prior to the release of micromechanical structures by etching the sacrificial 
oxide through holes using hydrofluoric acid (HF) vapor. The reported sensi-
tivity value of the Emmerich magnetometer was 820  µ V/µ T, with a minimum 
resolution of 200  nT at a bandwidth of between 1 and 10  Hz. The resonant 

68
Magnetic Sensors and Devices
frequency of the resonant structure was found to be 1.3  kHz and the quality 
factor was estimated to be 30 at 101  Pa [14].
In 2007, Bahreyni and Shafai designed a new resonant magnetometer that 
measures the frequency variation using in-plane electrostatic detection [19]. 
The sensor, shown in Figure  3.2, contains a shuttle-type structure connected 
to two bars using four microbeams. The shuttle connection is driven and 
kept in resonance by means of electrostatic actuation and sensing. The inter-
action between a dc drive current flowing in both bars and a magnetic field 
normal to the plane of the sensor, gives rise to a Lorentz force. This force pro-
duces axial stress on microbeams, which changes the resonance frequency 
of the comb. The shift in resonant frequency is controlled using capacitive 
detection with signal processing electronics. This device has a resolution of 
217  nT and a sensitivity of 69.6  Hz/T for a current of 10  mA. The resonance 
frequency is around 27  kHz with a quality factor of 15,000 at 2  Pa. It should 
be mentioned here that the sensor’ s performance can be affected by the self-
heating effect caused when a current is flowing through the microbeams [19].
In 2009, Thomson and Harsley [20] proposed a prototype that is quite simi-
lar to the Bahreyni et al.  device. The main difference is related to the geom-
etry of the structures and their shapes. A scanning electron microscope 
(SEM) photo of Thomson and Harsley’ s sensor is shown in Figure  3.3a. It 
consists basically of interdigitated fingers and a microbeam for the actuating 
current. An out-of-plane magnetic field produces the in-plane Lorentz force 
modulated at the device’ s natural frequency using an ac passing through the 
Fixed ﬁnger electrodes
Movable
comb electrodes
Spring
elements
500 µm
1300 µm
Current
connectors
Substrate
Bx
I
I
I
FL
Movable current
conductor
y
z
x
FIGURE  3.1
Schematic and operation principle of Emmerich resonator. (From Manjarrez, E. et al.,  Sensors 
Journal  , 39(9), 7785– 7813, 2009; Emmerich, H. and Schofthaler, M.,  IEEE Transactions on Electron 
Devices  , 47, 972– 977, 2000.) 

69
Out-of-Plane Resonant Capacitive Detection Magnetometer
flexures. The device is parametrically driven by electrostatically modulating 
the mechanical spring stiffness at twice the natural frequency using a pump 
voltage applied to capacitive plates that are defined symmetrically around 
the device. This microsensor has a sensitivity of 31.4  mVrms /T, a resonant fre-
quency close to 8.46 kHz, and a quality factor of 48.8 at ambient pressure [20].
During the same year of 2009, Brugger and Paul developed a novel mag-
netic field microsensor combining both electrostatic and magnetic effects (see 
Figure  3.3b) [13]. A micromechanical resonating structure that is suspended 
by four straight flexural springs is electrostatically driven through interdigi-
tated combs. The device is driven by applying a dc and a superimposed ac 
voltage to half of the interdigitated combs while the other half is used for the 
capacitive detection. In this sensor, the magnetic effect was monitored using a 
concentrator and a pair of planar coils. The concentrator is divided into three 
parts separated by two narrow gaps. The inner segment is attached to the res-
onator while both outer parts are fixed. The magnetic concentrator saturates 
at a magnetic field over 713  µ T. The planar coil can add an auxiliary magnetic 
field parallel to the magnetic concentrator when it is actuated by an external 
current. Because of the magnetic field created by both the coil and the concen-
trator, a magnetic force counteracts the restoring force that is exerted on the 
resonator and affects its spring constant inducing a shift in the frequency of 
the resonance value. Finally, a relationship between the resonant frequency 
and the magnetic field can be obtained. For a current of 80  mA flowing 
Crossbars
Magnetic
ﬁeld
Shuttle
Motion
direction
Microbeam
springs
Lorentz
force
FL
FL
IXB
–VEE
VG
Va
y
x
VB
Iout
Bz
FIGURE  3.2
Schematic and operation principle of the Bahreyni resonator. (From Manjarrez, E. et al.,  Sensors 
Journal  , 39(9), 7785– 7813, 2009; Bahreyni, B. and Shafai, C .  ,  IEEE Sensors Journal  , 7(9), 1326– 1334, 
2007.) 

70
Magnetic Sensors and Devices
through the coil and with V dc   =  20  V and V ac   =  404  mV and under a pressure 
of 10– 5  mbar, the microsensor presents a resolution of 1.3  µ T with a sensitivity 
of 1.91  MHz/T, and a quality factor around 2400. It should also be mentioned 
here that the resolution of the sensor can reach 400  nT in vacuum [13].
3.2.2  Out-of-Plane Capacitive Detection
This section describes MEMS-based resonant magnetic field microsensors 
that use out-of-plane capacitive sensing. In 1998, Kadar developed a resonant 
(a)
(b)
Straight ﬂexural
spring
Fixed magnetic
concentrator section
Magnetic f ield
Planar coils
Movable magnetic
concentrator section
C1
C1
C2
C2
Capacitive
sensing plates
Acc. V
2.00 kV
Spot
3.0
Magn
35x
WD
15.0
500 µm
Lorentz
force beam
UCD MEMSLab
Det
SE
Icoil
Icoil
Comb f ingers for capacitive
excitation and detection
FIGURE  3.3
(a) SEM image of Thompson resonator. (From Thompson, M.J. and Horsley, D.A.,  IEEE Sensors 
Conference  , 992– 995, 2009.) (b) Operation principle of a magnetic field microsensor based on 
a magnetic concentrator developed by Brugger and Paul. (From Herrera-May, A.L. et al., 
Development of resonant magnetic field microsensors: Challenges and future applications, in  
Microsensors  , I. Minin (Ed.), Chapter 3, InTech, Rijeka, Croatia, 2010; Brugger, S. and Paul, O.,  
Journal of Microelectromechanical Systems  , 18(6), 1432– 1443, 2009.) 

71
Out-of-Plane Resonant Capacitive Detection Magnetometer
magnetic field sensor with an out-of-plane capacitive detection scheme [21]. 
The microsensor combines bipolar processing with a micromachined struc-
ture that is obtained by glass to silicon anodic bonding. The structure is 
illustrated in Figure  3.4a. It comprises a resonant silicon plate with dimen-
sions 2800  ×   1400  µ m with a rectangular coil deposited on top of it. When a 
sinusoidal current is passed through the coil, it interacts with the external 
magnetic field and a Lorentz force arises causing the motion of the moving 
plate. This movement induces a variation in capacitance between the mov-
ing structure and electrodes located on the packaging of the device. Then, 
an external circuit is used to convert the capacitance variation into induced 
voltages. This magnetometer has a sensitivity of 500  µ V/µ T and a resolution 
of 1  nT. The resonant frequency is close to 2.4  kHz with a quality factor of 
700 at 5  Pa and the power consumption is a few milliwatts. The microsensor 
(b)
(a)
Glass cap
Lorentz force
Magnetic ﬁeld
Excitation current
Ie
Ie
Ie
FL
B
Aluminum
loop
Substrate
54.7°
Torsional
support
1400 µm
525 µm
Sensing and feedback capacitors 
FIGURE  3.4 
(a) Schematic of Kadar magnetometer. (From Manjarrez, E. et al., Sensors Journal , 39(9), 
7785– 7813, 2009; Ká dá r, Z., Bossche, A., Sarro, P.M. and Mollinger, J.R., Sensors and Actuators 
A Physical , 70(3), 225– 232, 1998.) (b) Operation principle of a magnetic field microsensor devel-
oped by Tucker. (From Herrera-May, A.L. et al., Development of resonant magnetic field micro-
sensors: Challenges and future applications, in Microsensors , I. Minin (Ed.), Chapter 3, InTech, 
Rijeka, Croatia, 2010; Tucker, J. et al., 2000 NanoTech , Houston, TX, 1– 5, 2002.)

72
Magnetic Sensors and Devices
requires a complex electronic circuitry for signal processing and vacuum 
packaging.
In 2002, Tucker designed a new structure for an out-of-plane capacitive 
detection (see Figure  3.4b) [22]. The structure consists of an xylophone 
microbar, supported by four arms, to detect external magnetic fields. When 
a sinusoidal current flows through the microbar, which is submitted to an 
external magnetic field, a Lorentz force is generated that causes the microbar 
to vibrate. This vibration is measured as a capacitance variation. The magne-
tometer area is close to 0.5  mm2  and was fabricated using a complementary 
metal-oxide semiconductor (CMOS) 0.5  µ m standard commercial process. 
A post-process release step was added to release the microbar. The sensor 
has a resonant frequency of around 100  kHz with a quality factor of 1000. 
The power consumption is around 7.5  mW and the noise is measured to be 
0.5 nT
Hz . In order to increase the vibration amplitude of the microbar, 
the device has to be packaged in vacuum.
In 2008, Kyynä rä inen et al. fabricated a magnetometer, shown in Figure  3.5, 
which is based on an out-of-plane capacitive detection scheme [23] between 
a square coil on top of a moving structure (electrode) and a fixed electrode. 
When current flows through the coil in the presence of an external mag-
netic field in the y -axis direction, an out-of-plane Lorentz force appears and 
the movement of the structure gives a capacitance variation between the 
electrodes that is proportional to the component of the magnetic field in 
the y -axis. The sensor is fabricated with direct bonding of a double-sided 
polished silicon wafer and a silicon on insulator (SOI) wafer. The main steps 
in the manufacturing process of this magnetometer are patterning of the 
anti-stiction studs and metalizing of the coil metal compensation layers, 
cavity etching and metalizing of sensing electrodes for torsional sensors, 
and direct wafer bonding followed by the removal of the SOI wafer han-
dle layer. The excitation coil is patterned next, followed by the deposition 
of the isolation and the bridge metal layers and then the final release etch 
step. The magnetometers operate in vacuum to increase sensitivity read-
ings. The measurement of the field component along the chip surface gives 
a flux density resolution of about 1  nT
Hz
0
 at a coil current of 100  µ A. 
I
I
F
F
B
FIGURE  3.5
Schematic of Kyynä rä inen magnetometer design. (From Kyynä rä inen, J.,  Sensors and Actuators 
A  , 142(2), 561– 568, 2008.) 

73
Out-of-Plane Resonant Capacitive Detection Magnetometer
Magnetometers measuring the field component perpendicular to the chip 
surface are less sensitive with a flux density resolution of about 7  nT
Hz
0
.
Another alternative structure was proposed by Ren in 2009 [24]. Similar to 
the previous techniques but with different geometry, the prototype has a low 
resistivity silicon structure suspended by two torsional beams over a glass 
substrate. On top of the silicon, a thin layer coil with a thickness of 1  µ m and 
a width of 0.5  µ m is deposited for excitation. When feeding the coil with an ac 
in the presence of an external magnetic field, the suspended structure starts 
oscillating, producing a capacitance change between the silicon resonator and 
the capacitance plate (see Figure  3.6). A capacitance detection circuit mea-
sures the capacitance change, which actually depends on both the magnitude 
and the direction of the external magnetic field. The magnetometer has been 
microfabricated using conventional MEMS micromachining and silicon-to-
glass anodic bonding. For a 150  mV driving voltage, the microsensor shows an 
improved performance with sensitivity equal to 481  mV/T, for a magnetic field 
varying from 3 to 30  µ T. The resolution is estimated to be 30  nT and the reso-
nant frequency is close to 1380  Hz, with a quality factor of 2500 at a pressure of 
10  Pa. This type of sensor has a nonlinear response from 0 to 3  μ T.
Generally, a resonant magnetic field microsensor with capacitive detec-
tion needs vacuum packaging in order to increase the quality factor, thereby 
enhancing the displacement of the resonant microstructure. Therefore, both 
the sensitivity and the resolution of the device will increase [11]. The quality 
factor, Q , is important for the resonant microstructure performance and is 
closely related to the damping effect. This factor is expressed as
	
Q
f m
= 2
0
π
α 	
(3.1)
where:
f 0 	 	
is the structure resonant frequency
m 	 	
is the mass
α 	 	
is the damping coefficient
Torsional beam
Glass substrate
Coil
Low resistivity
silicon resonator
Capacitance plate
X
Y
Z
FIGURE  3.6 
Operation principle of a magnetic field microsensor developed by Ren. (From Ren, D., Sensors 
Journal , 9(9) 6951– 6966, 2009.)

74
Magnetic Sensors and Devices
In reality, energy is dissipated during the structure’ s motion and the mag-
nitude of the oscillation decreases until the oscillation stops. This energy 
dissipation is known as damping . If an undamped structure is allowed to 
vibrate freely, the amplitude of vibration will be infinite. The damping level 
of a system is determined by the quality factor, which measures the amount 
of energy loss per cycle during the operation of the resonant structure. Then, 
due to the damping effect, the total Q  factor can be written as the ratio of the 
total energy that is stored in the structure (E M  ) over the energy loss per cycle 
(E C  ) [25]:
	
Q
E
E
M
C
= 2π
	
(3.2)
The energy loss can be due to different mechanisms. Some of these mech-
anisms are intrinsic to the material (thermoelastic damping), while others 
are influenced by the geometry of the structure, or by interactions with the 
environment in which the solid body vibrates (air damping, squeeze film 
damping) [26]. As a result, quality factors depend on the fluid type and pres-
sure, the vibration mode of the structure, the size and shape of the resonant 
structure, and the distance (gap) with respect to adjacent surfaces. The MEMS 
designer needs to carefully consider this parameter in order to increase the 
magnetometer’ s performance. For example, many magnetometer designs 
use a perforated microstructure to decrease the damping effect [27]. Since for 
most MEMS operating in air, the main energy loss is air damping, operating 
at lower pressures or in vacuum increases the quality factor; however, in this 
case, current-driven devices such as the Lorentz force– based magnetometers 
may be severely impacted by joule self-heating effects [26]. Finally, another 
important drawback of this type of microsensor is that it suffers from para-
sitic capacitances, which can be reduced through the monolithic integration 
of the micromachined resonators with electronic circuitry. In the next sec-
tion, the design for the developed out-of-plane capacitive detection will be 
described and analyzed. The prototype was designed at UCL in Belgium.
3.3  Magnetometer with Capacitive Detection
A schematic of the xylophone-based magnetometer with capacitive detec-
tion is shown in Figure  3.7. In this sensor, the out-of-plane displacement of 
a resonating beam structure affects the capacitance between interdigitated 
fingers defined on the two sides of the beam and the substrate [28,29]. The 
contribution of our design is the capacitance detection scheme, which is dif-
ferent from previous designs of sensors using out-of-plane detection [22]. 

75
Out-of-Plane Resonant Capacitive Detection Magnetometer
The design of the magnetometer consists of a movable clamped-clamped 
beam with fixed comb electrodes defined along its entire length. These elec-
trodes form interdigitated pairs with combs attached to the substrate on both 
sides of the resonant beam. Then, the sensor is placed in an external static 
magnetic field. According to the Lorentz force law, when a current passes 
through a suspended beam (between pads A and B in Figure  3.7) and is cou-
pled to the external magnetic field, a Lorentz force arises on the beam that 
is oriented according to the right-hand rule (perpendicular to both the mag-
netic field and the current). The clamped-clamped beam will thus move out 
of the plane (z -direction) when the magnetic field is oriented in the plane. As 
a result, the capacitance between the interdigitated electrodes changes and 
can be measured between pads A and C. In this design, the beam is made 
long enough to accommodate a relatively high number of comb fingers on 
both sides. This will eventually produce a more pronounced variation in the 
capacitance formed by the interdigitated combs, making it easier to measure. 
The choice of beam length is restricted by limitations on the maximum area 
that can be etched from the substrate, which are imposed by the fabrication 
technology. On the other hand, the beam’ s width should be minimized to 
reduce energy loss due to air damping. The width of the capacitive fingers on 
each side of the beam has been chosen small enough to maximize the num-
ber of fingers along the beam length. In addition, the fingers are made long 
and are located very close to each other to increase the capacitance variation. 
The fingers’  thickness depends on the beam and is imposed by the fabrica-
tion process. So, the magnetometers come in two versions: “ thin”  or “ thick,”  
with 10 and 20  µ m thick Si structural layers, respectively. The optimized geo-
metrical parameters that were used for the fabrication of our magnetic field 
sensor are summarized in Table  3.1. The sensor has been fabricated using the 
silicon-on-insulator multiuser MEMS process  (SOIMUMPs) foundry process 
(MEMSCAP Inc., Durham, North Carolina) with a silicon thickness equal to 
10  µ m.
Movable comb
ﬁngers
Fixed comb
ﬁngers
Beam
Contact pads
A
B
C
FIGURE  3.7 
Top view schematic of the xylophone-based magnetic field sensor with capacitive detection.

76
Magnetic Sensors and Devices
3.4  Mechanical and Electrical Behavior
3.4.1  Magnetometer Mechanical Model Analysis
The key mechanical parameter of the magnetometer is the resonant fre-
quency of the clamped-clamped beam. In practice, the sensor is placed in 
a 150  mT static magnetic field (generated by Nd– Fe– B magnets). The beam 
is driven by an ac with a frequency equal to its first resonant frequency to 
ensure the highest amplitude of vibration. The beam eigenfrequencies are 
mainly determined by the material properties and the dimensions of the 
structural layer. The resonance frequency, f n  , of a given vibration mode n  of 
the clamped-clamped resonant beam, shown in Figure  3.6, is obtained by [30]
	
f
R
L
EI
A
n
n
=
2
2
2
ρ
	
(3.3)
where:
ρ 	 	
is the density of the structural material
A	 	
is the beam cross-sectional area
E	 	
is Young’ s modulus
R n  		
is a constant that depends on the boundary conditions and the natu-
ral mode of the beam (values are given in Table  3.2)
I 	 	
is the area moment of inertia given, for a rectangular section beam, 
by W.h3 /12
Based on the values given in Table  3.1, the frequency, f 0 , of the first reso-
nant mode is calculated from Equation  3.3 and is equal to 17.5  kHz.
The resonant frequency and the displacement of the clamped-clamped 
beam for the first mode of vibration are measured using laser Doppler velo-
cimetry (LDV; Polytec MSA-500), as shown in Figure  3.8. In this setup, the 
TABLE  3.1 
Used Optimized Dimensions for the Magnetic 
Field Sensor Design
Part 
Parameters Designation 
Value (µ m) 
Beam
Length (L )
1969
Width (W )
62.5
Height (h )
10
Fingers
Length (l )
100
Width (a )
3
Thickness (t )
10 and 25
Fingers number (n t  )
312
Gap between fingers (d )
3

77
Out-of-Plane Resonant Capacitive Detection Magnetometer
beam is actuated first by a periodic chirp signal of fixed amplitude that is 
applied between pads A and B (see Figure  3.7) in order to determine the 
resonant frequencies. Based on this experiment and referring to the obtained 
spectrum shape, the resonant frequency was measured and was equal to 
18.8  kHz. The difference between experimental and theoretically obtained 
values is because the assumed model is a simple silicon beam without fin-
gers and without the Au on its top layer.
The response of the sensor is defined by the displacement of the vibrating 
beam. In order to measure this using LDV, a pure sinusoidal current with a 
frequency equal to the first resonant frequency of the resonating mechanical 
structure is used to drive the beam. Figure  3.9a shows the displacement of the 
beam center at resonance as a function of the root mean square (rms) value of 
the actuating current. It is worth noting that the variation in the maximum 
displacement is almost linear between 0 and 48  mA rms. Figure  3.9b shows 
the normalized modal shape of the beam when actuated by a current at its 
first resonant mode. The amplitude of vibration was measured to be close 
to 3.8  µ m in the beam’ s center when an rms current of 48  mA is flowing 
through the beam.
TABLE  3.2 
R n   Constant Values for the 
First Five Eigenmodes
Parameter 
Value 
R 1 
4.738
R 2 
7.853
R 3 
10.995
R 4 
14.131
R 5 
17.278
X
Y
Z
FIGURE  3.8 
Out-of-plane displacement of the resonant clamped-clamped beam illustrated using Polytec 
MSA-500.

78
Magnetic Sensors and Devices
The measured resonant frequency is plotted in Figure  3.10 as a function of 
the supply current. It can be immediately seen that the resonant frequency 
shifts slightly from its initial value when the actuating current increases. We 
note here that contrary to this observation when testing our thicker struc-
tures (25  µ m thickness), we observe small shifts of the resonant frequency 
with current toward smaller values. This is expected because during oper-
ation, the temperature of the device rises due to the joule heating effects, 
causing a compressive internal stress to arise and lowering the resonant 
frequency [29]. As the excitation current increases, the temperature rise is 
intensified resulting in a higher compressive stress and larger shifts. In this 
0
10
20
30
40
50
0.0
0.5
1.0
1.5
2.0
2.5
3.0
3.5
4.0
Mid–beam displacement (µm)
Actuating current (mA rms)
0.0
0.5
1.0
1.5
2.0
–1.0
–0.8
–0.6
–0.4
–0.2
0.0
Normalized deﬂection
Position on the beam (mm)
(a)
(b)
FIGURE  3.9 
(a) Measurement of the central beam displacement as a function of the supply current. 
(b) Normalized beam deflection shape when actuated at resonance frequency.

79
Out-of-Plane Resonant Capacitive Detection Magnetometer
case, however, the shift to higher frequencies suggests that another physi-
cal mechanism is present, especially at higher currents, and dominates the 
impact of the compressive thermal stress. We currently suspect that the 
vibration of the thinner sensors becomes nonlinear as the current exceeds 
a certain value and this causes the observed shift in the first resonant fre-
quency with the current. Based on Figure  3.10a, a linear fit was plotted and 
an analytical expression was developed between the measured resonance 
frequency and the used rms current, J , which can be given by
	
f
f
J
1
0
0 0193
=
+ .
	
(3.4)
The fact that the resonant frequency of the beam shifts due to thermal 
and nonlinear effects can cause a serious dysfunction during the operation 
of our magnetometer that may affect its response and reduce its sensitivity. 
Consequently, there is a need to accurately tune the microsensor and this 
will be investigated hereafter.
3.4.2  Electric Model Analysis
The parameters of the sensor electric model are deduced from the mea-
surements of the input and output impedances. Both of these quantities 
are measured using the Agilent 4284A LCR meter in a frequency range of 
between 20  Hz and 1  MHz. The input impedance of the sensor is equiva-
lent to a resistance formed by the metal layer that is deposited on top of the 
beam. Experimentally, this impedance is measured between pads A and B 
(see Figure  3.7). In Figure  3.11, the input impedance and the corresponding 
20
30
40
50
60
70
80
90
18.8
19.0
19.2
19.4
19.6
19.8
20.0
20.2
Resonance frequency (kHz)
Actuating current (mA rms)
FIGURE  3.10 
Measured resonance frequency variation as a function of the supply current.

80
Magnetic Sensors and Devices
phase as a function of frequency are plotted for a 10  μ m-thick structure. 
From these curves, the resistance of the Au layer was deduced and is equal 
to 5.62  Ω  for a frequency less than 100  kHz, after that an inductive effect 
appears. The output impedance of our structure is also important because it 
is defined by the total capacitance of the finger electrodes. Experimentally, 
this impedance is measured between pads A and C (see Figure  3.7). From 
the schematic in Figure  3.12 (modulus and phase of output impedance), the 
impedance reduces with frequency, which clearly explains the effect added 
by the capacitance. A direct measurement with an LCR meter also shows the 
presence of a serial resistance with the capacitance in this output impedance. 
The values obtained from these measurements at different frequencies are 
summarized in  Tables  3.2 and 3.3.
The magnetometer electric model can be represented as shown in 
Figure  3.13, where R_act  represents the input impedance. The impedance 
(C_ eq  , R_ eq  ) models the equivalent circuit of the RC dipole, which was derived 
from the output impedance. The beam is actuated between A and B pads 
and the capacitive measurement is measured between A and C pads or B 
and C pads. For high frequencies, the input impedance can change in the 
electric model.
In the next section, the sensitivity of the magnetometer will be evaluated. 
To do this, we need to group the different domains involved: magnetic, 
mechanical, and electrical domains.
101
0
10
20
30
40
Frequency (Hz)
Impedance (Ohm)
0
20
40
60
80
Phase (deg)
102
103
104
105
106
101
Frequency (Hz)
102
103
104
105
106
FIGURE  3.11 
Experimental measurement of the magnetometer input impedance.

81
Out-of-Plane Resonant Capacitive Detection Magnetometer
3.4.3  Magnetometer Sensitivity Evaluation
To determine the electrical properties of the sensor, we calculate the change 
in the capacitance for different beam displacements. Since the beam is mov-
ing in the out-of-plane direction (z -axis), the magnetometer is more sensitive 
along the z -axis direction. The Lorentz force applied on the beam, F L  , can be 
given by
	
F
B L J
L
y
=
	
(3.5)
where:
	B y  	
is the magnetic flux density in the y -direction
	 J 	
is the current flowing in the beam in the x -direction
200
250
300
350
Frequency (Hz)
Impedance (Ohm)
–96
–94
–92
–90
–88
Frequency (Hz)
Phase (deg)
103
104
105
106
101
102
103
104
105
106
FIGURE  3.12 
Experimental measurement of the magnetometer output impedance.
TABLE  3.3 
Capacitance and Resistance Values Obtained from Output 
Impedance Measurements at Different Frequencies for 
10  mm-Thick Structure
Frequency (kHz) 
Capacitance (pF) 
Resistance (MΩ ) 
1
6.76
> 200
100
6.72
> 200
1000
6.61
> 200

82
Magnetic Sensors and Devices
The deflection profile of a fixed-fixed beam submitted to a uniform load 
given by Equation  3.5, expressed by J , B y  , throughout its length is given by
	
z x
B J
x
EI L
x
y
( ) =
−
(
)
2
2
24
	
(3.6)
where x  is the direction across the beam length (see Figure  3.7). To discretize 
this equation, we can write that x   =  n   ×   (d   +  a ), where n  denotes the rank of the 
finger, thus z (n ) becomes the out-of-plane displacement of the n th finger. The 
theoretical expression of the capacitance in this configuration is given by [31]
	
C n
n
l t
z n
d
z n
t
z n
t
t
( ) =
−( )
(
)
<
>



ε0
0
,
( )
,
( )
if
if
	
(3.7)
where:
ε 0 	 	
is the relative permittivity of the air
n t  	 	
is the number of comb capacitance fingers
The others parameters are given in Table  3.1. In order to accurately evalu-
ate this capacitance, a finite element method (FEM) simulation was carried 
out using Comsol®   Multiphysics. Firstly, a single interdigitated finger pair 
was studied and simulated using an electrostatics module. This was accom-
plished by applying a dc voltage between the finger pair while using silicon 
as the material and air in the gap. Then, the distance was varied between the 
movable and the fixed fingers along the z -direction, and we tried to determine 
numerically the capacitance between the finger pair. Thereafter, two meth-
ods were developed and compared to estimate the total capacitance. The first 
method is calculating the capacitance between two fingers pair as described, 
R_act/2
R_act/2
C_eq
C
A
B
R_eq
FIGURE  3.13 
Electric model of the magnetometer sensor.

83
Out-of-Plane Resonant Capacitive Detection Magnetometer
then multiplying the result by the total number of finger pairs throughout 
the clamped-clamped beam n t  ; the result is plotted in Figure  3.14a. The sec-
ond method is more realistic, and takes into consideration the edges effect 
during the beam motion, so that the elevation is not the same throughout 
its length, as show in Figure  3.9b. The partial capacitance produced by each 
comb fingers throughout the clamped-clamped beam length is presented in 
Figure  3.14b. The simulated resulting total capacitance variation as a func-
tion of the gap between fingers, for both methods, is plotted in Figure  3.14a. 
It clearly shows that the capacitance value is maximum at the equilibrium 
position, then decreases as the beam moves away from its rest position.
–40
–20
0
20
40
0.0
0.8
1.6
2.4
Total capacitance (pF)
Displacement (µm)
 Capacitance without edges eﬀect 
 Capacitance with edges eﬀect 
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
× 10–2
0
0.002
0.004
0.006
0.008
0.01
0.012
0.014
0.016
0.018
x-Position of the ﬁnger
Capacitance per pair ﬁngers (pF)
(a)
(b)
FIGURE  3.14 
(a) Total capacitance change as a function of the displacement between the comb fingers. 
(b) Partial capacitance produced by each comb finger throughout the clamped-clamped beam 
length.

84
Magnetic Sensors and Devices
A key parameter for the function of the microsensor is sensitivity, which 
can be defined by Equation  3.8 for a constant static magnetic field:
	
S
C
J
C
z
z
J
B cte
B cte
=
=
=
=
∆
∆
∆
∆
∆
∆
	
(3.8)
The sensitivity equation can be divided into two parts as shown in 
Equation  3.8, and can be determined graphically. In fact, the first part can be 
deduced from Figure  3.14a, whereas the second part can be extracted from 
Figure  3.9a, which presents the displacement as a function of the actuat-
ing current. In Figure  3.15a and b, respectively, we plot the change in total 
0
10
20
30
40
50
2.38
2.40
2.42
2.44
2.46
2.48
2.50
2.52
2.54
2.56
2.58
2.60
Capacitance (pF)
Actuating current (mA rms)
0
10
20
30
40
50
–5
–4
–3
–2
–1
0
Sensitivity (fF/mArms)
Actuating current (mA rms)
(a)
(b)
FIGURE  3.15 
Simulated (a) capacitance and (b) sensitivity of the magnetometer as a function of the actuation 
current.

85
Out-of-Plane Resonant Capacitive Detection Magnetometer
capacitance and the sensitivity for different actuating currents. The capaci-
tance is maximum for low actuating currents (low displacement) while the 
sensitivity in that case is lowest. For a current of 48  mA rms and when a 
static magnetic field of 150  mT is applied, the sensitivity is around − 7  fF/
mA rms, as shown in Figure  3.15b. The maximum sensitivity is found to be 
around − 46.6  fF/T mA rms.
The sensor sensitivity depends mainly on the chosen geometrical param-
eters during the SOIMUMPs fabrication process and on the quality factor 
[18]. The sensor performance can be improved when using a vacuum pack-
age. Indeed, in vacuum both the quality factor and the amplitude of vibra-
tion increase by reducing the main energy losses. It may be noted that the 
sensitivity is also directly proportional to the current passing through the 
beam; however, increasing this current causes a shift of the resonant fre-
quency as shown in Figure  3.10, which presents a drawback for the pres-
ent resonant sensor design. Again, the implementation of a tuning system 
to solve this problem becomes a necessity. In the next section, a proposed 
tuning technique will be discussed using the electrostatic actuation force 
between fingers.
3.5  Frequency Tuning by Applying dc Voltage
In practice, the measured resonant frequencies always shift from the desired 
design values because of several mechanisms, such as joule heating, exter-
nal temperature influence, and external vibration. Two solutions could be 
conceived to compensate for the frequency deviation: widening the operat-
ing frequency bandwidth and/or tuning the resonant frequency. The first 
method can be implemented by adjusting the quality factor of the vibrating 
structure as mentioned in [32]. The quality factor is tuned using an anneal-
ing technique that is based on filament-like heating of our microstructure. 
However, the resonant frequency tuning method is a more efficient tech-
nique for applications with single time-varying dominant frequency [32]. 
Frequency tuning could be achieved by one of three basic methods: the first 
consists of using an additional electrostatic stiffness component, wherein the 
stiffness can be adjusted electrostatically through an interdigitated fingers 
capacitive structure. In fact, Lee et al. [33] demonstrated that by inducing a 
control voltage between microresonator comb fingers when structures are 
actuated laterally, the resonant frequency decreases. They show that this 
decrease is due to the stiffness from the electrostatic force component that 
actually reduces the total effective stiffness of the structure [33]. So, design 
dimensions were chosen to generate higher electrostatic stiffness to get a 
wide tuning frequency variation. The second method exploits the tempera-
ture dependence of Young’ s modulus during the elastic deformation of some 

86
Magnetic Sensors and Devices
materials. It is well known that Young’ s modulus of silicon, for instance, 
depends on temperature. Therefore, any temperature change can cause a shift 
in the stiffness of any silicon-based structure, which in turn affects its initial 
resonant frequency [25]. The last method is based on tuning by inducing an 
internal stress in the structure (compressive or tensile) in order to cause shift-
ing of the resonance frequency. Todd and Liwei [34] used the joule heating 
effect by applying a current to the comb structure through a straight beam 
designed with specific dimensions and materials to induce thermal stress. 
The resonant frequency was then changed by around 6.5% for a tuning cur-
rent of 5  mA [34]. The method presented in this chapter exploits the former 
principle. During the out-of-plane movement of the clamped-clamped beam, 
its resonant frequency was tuned via the electrostatic method by applying a 
dc voltage between its capacitive fingers. For this magnetometer design, the 
resonant frequency increased with increasing dc voltage. This is different 
from other models described in the literature since the electrostatic force is 
produced in the z -direction and not laterally [35,36].
3.5.1  Physical Modeling
In Figure  3.16a, a 3-D schematic of a sensor with comb fingers is depicted. 
The two components of the electrostatic force at equilibrium, across the x - 
and y -directions, are also shown. However, during the out-of-plane motion, 
the stationary electrodes are positioned exactly in the middle of the movable 
finger, so the in-plane electrostatic force components (x  and y ) from both 
sides are opposed and cancel each other out, as shown in Figure  3.16a. Thus, 
only when the beam starts oscillating out of plane will the z -axis component 
of the electrostatic force rise. This force, F ez  , can be evaluated through the 
electric energy using [12]
	
F
w
z
z
ez
e
V cte
= ∂
( )
∂
=
	
(3.9)
where w e   is the electrostatic energy stored between the finger electrodes 
when a dc voltage V  is applied, and can be expressed by
	
w
C z V
e =
( )
1
2
2
dc 	
(3.10)
The total electric energy is presented in Figure  3.16b for different bias volt-
ages over the finger’ s displacement. As expected, Figure  3.16b shows that the 
electrical energy is at its maximum in the vicinity of the equilibrium posi-
tion, then decreases as the beam moves away.
The moving part of the sensor (blue in Figure  3.16a) is modeled as a simple 
clamped-clamped beam with both ends fixed to the substrate. The effects of 
build-in and thermal stresses, which may rise due to joule heating of the Au 
electrodes, are ignored. It is further assumed that the geometry of this beam 
is simple with no comb fingers. However, the presence of the comb fingers 

87
Out-of-Plane Resonant Capacitive Detection Magnetometer
alters the geometry and the flexural rigidity of the structure. In order to take 
this into account, we introduce an equivalent width, b eq  , as the width of a 
beam with a constant cross section having the same length and thickness as 
our sensor, which— assuming pure bending conditions— will deform with 
the same curvature under the action of an external bending moment M . This 
is mathematically formulated in Equation  3.11, when assuming a homoge-
neous beam with constant Young modulus E , given by
	
M
EI
dx
M
EI x dx
L
I
dx
I x
eq
L
L
eq
L
0
0
0
∫
∫
∫
=
( )
⇒
=
( )
	
(3.11)
The integral in Equation  3.11 is transformed to a sum of terms and the equiv-
alent area moment of the beam, I eq  , is obtained. From this, an equivalent 
width can be calculated. We further take into account the bilayer structure of 
the sensor by calculating the flexural rigidity of the bilayer beam formed by 
Si– Au, which is given by
	
EI
E
I
E
I
eq
eq
(
)
=
( )
( )+ (
)
(
)
bilayer
Si
Si
Au
Au 	
(3.12)
–40
–20
0
20
40
1E-10
Z
Y
X
Fey
Fex
1E-9
Electrical energy (J)
Displacement (µm)
V = 12 V
V = 25 V
V = 52 V
(a) 
(b) 
FIGURE  3.16 
(a) 3-D schematic of the sensor with electrostatic force distribution in equilibrium (z   =  0) 
between two fixed combs when a dc voltage is applied. (b) Total electric energy over the fin-
ger’ s displacement for different bias voltages.

88
Magnetic Sensors and Devices
The Euler– Lagrange dynamic beam equation, describing the vibrations 
of a beam subject to an external load q , is given next. In Equation  3.12, 
x- coordinate is chosen across the direction of the beam length. The out-of-
plane deflection at the z -direction in position x  at time t  is given by z (x ,t ). 
Constant α  is the damping ratio and p  is the mass of the beam. Equation  3.13 
was formulated making the usual assumption that bending effects are much 
more important than tension effects in a clamped-clamped beam.
	
∂
∂
∂
∂



−
∂
∂
=
∂
∂
+ (
)
2
2
2
2
2
2
x
EI
z
x
z
x
z
x
q x t
α
µ
,
	
(3.13)
In the case of our sensor, external load variable q  can be divided into two dis-
crete components. The first is the actuating external force, F L    =  BJL   cos(ω t ), 
due to the Lorentz interaction between the ac and the external magnetic field 
B

, which is applied to the midpoint of the suspended structure. The other 
contribution to q  is the electrostatic interaction between the comb fingers at 
the two sides of the vibrating beam with the stationary comb fingers on the 
substrate. This electrostatic force is always attractive and is assumed that it is 
homogeneously distributed along the length of the beam.* We next attempt 
to calculate the electrostatic attraction that is exerted on each comb finger as 
a function of the tuning dc voltage (V dc ). The governing equation of motion 
of a single finger moving in the electrostatic field generated by a pair of sta-
tionary fingers on the substrate is given by
	
µ
ε
ε
f
z
t
z
x
∂
∂
= −
∇
= −
∂
∂



+ ∂
∂












2
2
0
2
0
2
2
2
2
Φ
Φ
Φ
	
(3.14)
In Equation  3.14, elastic and damping effects are ignored. It is thus assumed 
that the fingers are 2-D bodies that do not deform and vibrate without losses. 
The right-hand side of Equation  3.14 corresponds to the electrostatic force due 
to the presence of a potential Φ , ε 0  is the dielectric permittivity of vacuum, 
and μ f   is the surface mass density of one comb finger. In Figure  3.17, a cross-
sectional view of a pair of stationary comb fingers at constant potential V 0  
and a floating finger vibrating between them is schematically depicted. This 
is a simplified model of a comb finger moving as a dielectric slab between the 
two stationary fingers that form a capacitor. In reality, we need to take into 
account the contribution of neighbor fingers in the potential Φ . However, we 
can ignore this effect for this first approximation of the electrostatic force on 
one comb finger. In Figure  3.17, the main dimensions that are relevant to this 
problem are also drawn. In what follows, we scale the terms in Equation  3.14 
using appropriate non-dimensional parameters for x , z , t , and Ф  in order to 
*	 This is a simplification that is not expected to affect our results because the comb fingers are 
defined across the central section of the beam spanning a length of 1860  µ m, which is slightly 
shorter than the beam’ s length.

89
Out-of-Plane Resonant Capacitive Detection Magnetometer
draw important conclusions about the physical characteristics of the system 
described by Equation  3.14. By choosing d  as the length scale for both x  and 
z  since x   ≈   z, V 0  as the scale for potential Ф , and T  as the scale for time t , we 
get the non-dimensional primed parameters x ʹ   =  x/d , z ʹ   =  z/d , Ф ʹ   =  Ф 0 /V 0 , and 
t ʹ   =  t/T .
By transforming the partial derivatives using the chain and substituting 
into Equation  4.14, we get the non-dimensional form:
	
µ
ε
ε
f d
T
z
t
V
d
z
x
2
2
2
0
2
0
0
2
2
2
2
2
2
∂
′
∂′
= −
∇
= −
∂
′
∂′



+ ∂
′
∂′




Φ
Φ
Φ








	
(3.15)
It immediately follows from Equation  3.15 that the appropriate scaling factor 
T  for time t  is given by Equation  3.16. Here, the terms on the right-hand side 
can be reordered in the form m/k  and the denominator (ε 0 V 0 2 /2d 3 ), which is a 
quadratic function of the external potential V 0 , is the key factor that controls 
the “ tuning”  effect [37].
	
T
d
V
V
d
f
f
=
=
2
2
3
0
0
2
0
0
2
3
µ
ε
µ
ε
	
(3.16)
3.5.2  Numerical Resolution
An analytic solution of the total electrostatic force exerted on a dielectric slab 
of length l , with dielectric permittivity ε , which is inserted in a parallel plate 
capacitor whose plates are kept at a distance d , exists and is well known in the 
literature as F elec   1  =  (ε   –   ε 0 )lΔ Ф 2 /2d , where Δ Ф  in this case is the potential dif-
ference between the parallel plates of the capacitor. However, the assumptions 
behind its derivation are not always clearly discussed and, as a result, it is 
usually used in the wrong context. For an in-depth discussion of the physical 
V = 0
V = –V0
z
x
V = V0
l = 9 µm 
d = 10 µm
FIGURE  3.17 
In-plane schematic representation of comb fingers.

90
Magnetic Sensors and Devices
interactions involved, interested readers should refer to [38]. Under more gen-
eral conditions, Equation  3.15 is not open to analytic solutions. We have thus 
resorted to finite element analysis in order to calculate the electrostatic force 
exerted on a comb finger– type electrode from a parallel plate capacitor. The 
z -component of the electrostatic force that is exerted on the device as a func-
tion of the out-of-plane displacement can be determined by differentiating 
the total electric energy of the system. The resulting electrostatic force values 
are plotted as a function of the displacement in Figure  3.18 (dashed line with 
circle dots) for the case V dc   =  12  V. This latter does not represent a linear func-
tion except in a narrow region around the equilibrium position. It assumes its 
maximum/minimum value in a distance approximately equal to 1.2  μ m away 
from the rest point, after which it decreases exponentially to zero.
The electrostatic restoring force can be approximated by a function that 
should be almost linear close to zero and tends to die out at large distances 
away from the equilibrium position. Based on these two prerequisites, the 
function describing the total force exerted on the moving part, as a function 
of the displacement z , can be expressed as
	
F
ze
z
elec =
−
β
δ
/ 	
(3.17)
We now return to Equation  3.13 and reformulate it in order to take into 
account the extra restoring force due to the electrostatic interaction. We 
ignore damping effects but we also take into account the equivalent area 
moment of inertia, I eq  , and the flexural rigidity of the bilayer structure, cal-
culated from Equations  3.11 and 3.12, and we end up with
6
´10–6
´10–5
4
2
0
Electrostatic force (N)
–2
–4
–4
–2
0
Beam position (m)
Felectr Vdc = 12 V
–2.6*z*e–|Z/7.3|
2
4
–6
FIGURE  3.18 
Representation of the electrostatic force exerted on a magnetometer (dashed line with solid 
blue circle), and the fitting function (red dashed line) obtained by applying a least squares fit-
ting method, as a function of the out-of-plane displacement for V dc   =  12  V.

91
Out-of-Plane Resonant Capacitive Detection Magnetometer
	
µ
β
δ
∂
∂
+
∂
∂
+
=
−
2
2
4
4
z
t
EI
z
x
ze
F
z
L
/
	
(3.18)
Next, the parameters used in Equation  3.18 are scaled. For this, the x -coordi-
nate across the length L  of the beam is scaled using L  as the scaling param-
eter; w  the coordinate in the direction of oscillation is scaled by d , which 
should correspond to a measure of the out-of-plane deflection; and T  is a 
time parameter that is chosen equal to L
EI
2 µ/
. By transforming the par-
tial derivatives using the chain rule, we get the non-dimensional form:
	
∂
′
∂′ + ∂
′
∂′ +
′
=
−
′
2
2
4
4
4
z
t
z
x
L
EI z e
L
EId F
dz
L
β
δ
/
4
	
(3.19)
The total force due to the Lorentz interaction is given by F L    =  BJL   cos(tʹ  ). This 
force is applied at the midpoint of the beam when the excitation current with 
an amplitude J  is used in the presence of an external magnetic field B

. The 
equivalent spring constant of a suspended clamped-clamped beam is given 
by k eq     =  192EI/L 3  when a point load is applied at the midpoint of the beam, 
choosing d  as the ratio of static load over spring constant (BJL/EI/L 3 ) looks 
the most straightforward choice. This corresponds to the expected maxi-
mum deflection of the beam under the action of the Lorentz force. It is a 
function of the excitation current and of the external magnetic field B . We 
should further notice that the coefficient of the electrostatic term β L/EI/L 3  is 
the ratio of the stiffness due to the electrostatic attraction over the stiffness of 
the beam and represents, as a result, an indication of the relative importance 
of the two terms. From the foregoing explanations, Equation  3.19 becomes
	
∂
+ ∂
+
=
( )
−
tt
xxxx
dz
z
z
Kze
t
/
cos
δ
	
(3.20)
In Equation  3.20, we have dropped primed variable names for simplicity. We 
have also adopted a simpler symbol for partial derivatives over t  and x  and 
have introduced K   =  β L 4 /EI  as the coefficient of the electrostatic term. If we 
further focus on the free vibrations of the structure and replace the stiffness 
term with the equivalent spring constant, we obtain
	
∂
+
+
=
−
tt
dz
z
z
Kze
/δ
0 	
(3.21)
In the absence of an external electrostatic field, K   =  0 and Equation  3.21 cor-
responds to the free vibrations of a 1-D harmonic oscillator with ω 2    =  1. As 
V dc  increases, K  also increases to 1 and beyond, making the electrostatic 
term increasingly important and even dominant. The natural frequency of 
the system is now given for small vibrations by ω 2   =  1  +  K  and the phase 
diagram of the oscillatory motion can be derived for different values of K .

92
Magnetic Sensors and Devices
Next, we investigate the modeling of the damping effects included in 
Equation  3.19. In this case, scaling of the time parameter t  is done using T   =  μ / α  
as the scale factor, where α  is a damping-related parameter. Then, we obtain
	
∂
′
∂′ −∂′
∂′ +
∂
′
∂′ +
′
=
′
( )
−
′
2
2
4
4
2
z
t
z
t
EI
L
z
x
z e
t
dz
µ
α
βµ
α
δ
4
/
cos
	
(3.22)
For the derivation of Equation  3.22, we have made the choice of the scaling 
parameter d  following the same logic as for Equation  3.19. In this case, we 
set d   =  F L  μ /α 2 . Next, we simplify the format of Equation  3.22 by following the 
same steps as before (see derivation of Equation  3.21). Here, however, we set 
K 1   =  μ EI/ α 2 L 4  and K 2   =  β μ /α 2  and we observe that K 2 /K 1  is now equal to the coef-
ficient K  of the electrostatic term in Equation  3.21. Then, Equation  3.22 becomes
	
∂
−∂
+
∂
+
=
′
( )
−
tt
t
xxxx
dz
z
z
K
z
K ze
t
1
2
/
cos
δ
	
(3.23)
An alternative way to scale Equation  3.22 is by introducing t ʹ  from 
Equation  3.19 instead of dividing by T   =  μ /α  as we did. In that case, we end 
up with the following form:
	
∂
−∂
+ ∂
+
=
′
( )
−
tt
t
xxxx
dz
z
z
z
Kze
t
γ
δ
/
cos
	
(3.24)
In Equation  3.24, the constant K  is defined in the same way as in Equation  3.20 
and measures the relative strength of the electrostatic force: it is thus a mea-
sure of the tuning effect. Constant γ , which appears as the coefficient of the 
first derivative with respect to time, is the reciprocal of the quality factor Q  
of the system and is defined from
	
γ
α
µ
=
L
EI
2
	
(3.25)
In order to get a non-dimensional force term in the right-hand side of 
Equation  3.24, we need to set d , which as before is used for scaling lengths in 
the out-of-plane direction, equal to F L  L 4  /EI  or d   =  μ F L  γ 2 /α , which is derived 
from solving Equation  3.25 for L 4 /EI   =  μ γ 2 /α 2 .
Given that for these devices Q  was obtained experimentally (Q   ≈   100), we 
get γ   ≈   0.01 and as a result of Equation  3.24, α   ≈   10– 5 . The partial differential 
of Equation  3.24 was numerically solved in MATLAB©  . The solution is calcu-
lated for three units T  of time and the resonance frequency is extracted from 
the period of the oscillation of the beam.
In Figure  3.19, the numeric solutions obtained from MATLAB for a driving 
current with amplitude J   =  10  mA are plotted for the different values of the 
externally applied electrostatic potential V dc .  Low voltages cause negligible 
shift and the solutions almost coincide with the solution for V dc   =  0. As the 
external potential increases, the electrostatic force acts as an extra restor-
ing force, which corresponds to an additional stiffness causing the resonant 

93
Out-of-Plane Resonant Capacitive Detection Magnetometer
frequency of the structure to shift higher. The maximum deflection of the 
beam at resonance also decreases slightly as the external tuning potential 
increases due to the added force.
Next, we calculate the resonant frequency to be expected when the sensor 
vibrates under the action of the Lorentz force in the presence of an external 
potential V dc . The external potential is varied between 1 and 52  V. Numerical 
solutions are obtained for different values of the amplitude of the driving cur-
rent. In Figure  3.20, the first resonant frequency of the sensor as a function 
of the externally applied electrostatic potential is plotted for a driving cur-
rent with an amplitude between 2 and 70  mA. A linear fit is then applied to 
the model data in order to compare the results with those obtained from the 
experiment. For zero voltage, we get a constant equal to 19.2  kHz from the least 
square fit, which is close to the experimentally obtained value of 18.8  kHz.
The model accurately describes the tuning effect and the dependence on 
the driving current. The first resonant frequency shifts higher as the electro-
static potential between the comb fingers increases and the effect is much 
more pronounced when the amplitude of the driving current is low (< 20  mA). 
This should be expected since for small driving currents, the amplitude of 
the Lorentz force is small and the resulting maximum deflection at reso-
nance is also relatively small. In this regime of small vibrations, the expo-
nential term due to the electrostatic attraction is significant and contributes 
to the total restoring force, thereby altering the resonant frequency of the 
structure. As the amplitude of the driving current increases, the maximum 
deflection at resonance also increases. This causes the beam to bend further 
t (T)
w (d)
Driving current J = 0.01 A
2
–1.5
–1
–0.5
–0
0.5
1
1.5
×10–3
2.2
2.4
2.6
2.8
3
Vdc = 0 V
Vdc = 1 V
Vdc = 12 V
Vdc = 25 V
Vdc = 38 V
Vdc = 52 V
FIGURE  3.19 
Solutions of the governing PDE for different V dc  values and a driving current amplitude of 
J   =  10  mA.

94
Magnetic Sensors and Devices
away from the substrate where the exponential term of the electrostatic 
attraction vanishes. The shift when the driving current is low is calculated 
quite accurately; however, for higher amplitudes (beyond 20  mA) the model 
gives a zero shift while our experiments suggest that even for 70  mA a small 
tuning effect should be expected. The main reason for this failure is proba-
bly because the model does not account for thermal stress effects due to joule 
heating or for nonlinear effects due to large deflections that might rise when 
the driving current is sufficiently high. Finally, an indirect consequence of 
the dependence of the tuning effect on the amplitude of the driving current 
is that it should also depend on the quality factor of the vibrating structure 
that, for a given stimulus, controls the maximum deflection at resonance. 
Thus, similar structures with different Q  will behave differently when we 
attempt to tune their frequency of resonance using an external electrostatic 
field. For a given driving current, the device with the higher Q  will deflect 
more and will be less prone to tuning. The model also extracts the modal 
shape of the beam and the maximum deflection at resonance, which is nor-
mally observed at the midpoint in the case of the first resonant frequency. In 
Figure  3.21, the modal shape for an excitation current with amplitude 10  mA 
is plotted for different values of the dc bias. The x -axis of the plot corre-
sponds to the dimensionless length of the beam and the y -axis corresponds 
to the dimensionless (measured in units of d ) out-of-plane deflection.
The out-of-plane deflection is maximum at the midpoint (a distance of 
almost 1  mm from the two anchors) as should be expected in the case of the 
Vdc (V)
0
10
20
30
40
50
f1 (kHz)
20
22
24
26
28
J = 2 mA
J = 5 mA
J = 10 mA
J = 35 mA
J = 70 mA
164*Vdc + 19264
89*Vdc + 19264
32*Vdc + 19264
0*Vdc +19264
FIGURE  3.20 
Frequency shifts estimated as a function of the external V dc  estimated from the model for dif-
ferent values of driving current amplitudes.

95
Out-of-Plane Resonant Capacitive Detection Magnetometer
first mode of resonance. The amplitude decreases with the tuning bias from 
440  nm for V dc   =  0  V to 310  nm for V dc   =  52  V. It is interesting to note that if 
we double the amplitude of the driving current, the amplitude at resonance 
for V dc   =  0  V doubles to 880  nm as should be expected; however, the response 
for V dc   =  52  V is close to 850  nm, which is much larger than twice the value for 
J   =  10  mA. As the excitation current increases, the amplitude of the Lorentz 
force also increases resulting in larger amplitudes at resonance. As the comb 
fingers on the vibrating beam move away from the stationary fingers at dis-
tances over 1.2  μ m, the electrostatic force exerted on them (Equation  3.17 and 
Figure  3.18) decreases fast. For an excitation current J   =  70  mA, the maximum 
deflection at resonance is 3.1  μ m and does not change with V dc . This is lower 
than the experimentally obtained value of 3.8  μ m for J   =  48  mA rms, which 
suggests that possibly thermal and nonlinear effects that were ignored in 
our analysis become dominant at these high currents. We finally obtain the 
phase diagram of Equation 3.21 in Figure  3.22, after adding a damping term, 
for K   =  0, 1, and 5, assuming an excitation current with amplitude J   =  5  mA. 
As previously discussed, constant K  is a measure of the relative importance 
of the added stiffness due to the tuning effect over the mechanical stiffness 
of the structure. K   =  0 corresponds to no tuning (V dc   =  0), K   =  1 corresponds 
to tuning with a V dc , which produces a restoring force with β  equal to the 
equivalent stiffness of the beam (approximately 20  N/m), and so on.
3.5.3  Experimental Validation and Discussion
In order to check the validity of the model, the effect of dc bias on the reso-
nant frequency of the beam for different values of the driving current was 
×10–3
Driving current J = 0.01 A
0 V
1 V
12 V
25 V
38 V
52 V
0
0
0.5
1
1.5
0.2
0.4
0.6
L
w (d)
0.8
1
FIGURE  3.21 
Modal shape of the beam when it vibrates at its first resonant frequency under the action of 
Lorentz force for a current with amplitude J   =  10  mA.

96
Magnetic Sensors and Devices
investigated. The dc bias was varied between 0 and 52  V for two rms val-
ues of the driving current. The first series of measurements was obtained 
using a low rms current of J   =  2  mA. In this case, both thermal stress and 
the amplitude of the vibration were expected to be low. The second series 
of measurements was obtained using a high driving current J   =  70  mA. All 
measurements were performed at ambient temperature using a Polytec 
MSA-500 laser Doppler vibrometer. In Figure  3.23, experimentally obtained 
values of the first resonant frequency of the beam for dc bias between 0 and 
52  V are plotted for the two different actuating currents. Black squares cor-
respond to J   =  2  mA, while red squares correspond to J   =  70  mA [39].
Based on these measurements, we can confirm that the first resonant fre-
quency increases with dc bias and shifts almost 38% when a dc voltage of 
52  V is applied and a 2  mA rms current is flowing between the beam ends. 
Under these conditions, both the amplitude of vibration and the thermally 
induced stress due to joule heating effects are small. As a result, there is good 
agreement between our model predictions and the experimentally obtained 
results. To facilitate comparisons, we apply a linear fit (solid black line) to the 
experimentally obtained points and we notice that the resulting linear equa-
tion (18,800  +  144  ×   V dc ) is very similar to the one obtained previously from 
the model (19,264  +  164  ×   V dc ).
For the high intensity actuating current, the tuning effect is less pro-
nounced and the frequency shifts about 7% higher. We see that the tuning 
effect is higher at lower displacements. This is obviously linked to the range 
of the electrostatic force, which is decreasing exponentially to zero as the 
out-of-plane deflection of the beam increases. For small displacements, the 
3
2
1
0
–1
–2
–3–3
–2
–1
0
Beam position (d)
Beam velocity (d/T)
1
2
3
K = 5
K = 5
K = 1
K = 1
K = 0
K = 0
FIGURE  3.22 
Phase diagram for different damping value (K = 0, 1, and 5), when the excitation current 
­amplitude J = 5 mA.

97
Out-of-Plane Resonant Capacitive Detection Magnetometer
electrostatic force is almost linear and affects both the beam displacement 
and the resonant frequency. For large deflections, however, the effect of the 
electrostatic force becomes small and, as a result, the frequency shift should 
diminish as well. In Figure  3.23, a linear fit and the corresponding analytic 
equation relating the resonant frequency to the bias voltages for the case of 
J   =  70  mA rms are also presented. From this, we immediately see that our 
model fails to predict the shift under these conditions probably because the 
combined effect of thermal stress and large deflections cannot be neglected 
in this case.
We can deduce from Section  3.5.2 that the increase in resonant frequency 
is mainly due to the electrostatic force that arises between the movable and 
the stationary interdigitated electrodes when a dc bias is applied between 
them. This force is attractive and linear in case displacements are kept low, 
as illustrated by Figure  3.23. In this configuration, an additional electrostatic 
stiffness component, K elec , is generated and added to the initial elastic stiff-
ness, K elas , of the clamped-clamped resonant beam. For larger magnitude 
displacements, the electrostatic force is no longer linear and the electric stiff-
ness has less effect on the resonance frequency. We note that the frequency 
change in this structure was different from that reported in the literature, 
since the external electrostatic force is generated in the z -direction and 
not laterally [15,16]. Tuning frequencies with electrostatic actuation is very 
important and interesting because it can serve as a feedback mechanism to 
compensate for measurement errors, such as the nonlinear problem encoun-
tered due to the actuating current.
0
10
20
30
40
50
60
18
19
20
21
22
23
24
25
26
27
Frequency (kHz)
Bias voltages Vdc (V)
Low actuation current 2 mA rms
High actuation current 70 mA rms
f1 = 18.8 + 0.0126*Vdc
f1 = 18.8 + 0.1437*Vdc
FIGURE  3.23 
Measured resonant frequency as a function of the biasing voltage for low and high actuation 
currents.

98
Magnetic Sensors and Devices
3.6  Conclusion
In this chapter, a MEMS magnetometer with capacitive detection, fabricated 
in a SOIMUMPS process, was presented and characterized. This magnetom-
eter relies on a set of comb fingers for capacitive detection. A tuning method 
was applied to this kind of magnetometer by setting a dc voltage between 
the comb fingers that led to a change in the structure’ s equivalent spring 
constant. The experimental values show that the curve is nearly linear for 
specific bias voltages and the resonant frequency increases by 38% from its 
original value. This shift is very interesting especially when the displace-
ments of the fingers are kept low since the electrostatic forces are then linear 
and provide an electrical stiffness component that affects the mechanical 
stiffness of the vibrating beam. Electrostatic tuning in this type of magne-
tometer can serve as a feedback mechanism to compensate for measurement 
errors, and may also increase the sensor performance by increasing the 
bandwidth of the measurement of an alternating magnetic field.
References 
	
1.	 T.A. Roessig, R.T. Howe, A.P. Pisano and J.H. Smith, Surface micromachined 
resonant accelerometer, in Proceedings of the International Conference on Solid-State 
Sensors and Actuators (Transducers’ 97) , pp. 859– 862, Chicago, 16– 19 June 1997.
	
2.	 Y. Omura, Y. Nonomura and O. Tabata, New resonant accelerometer based 
on rigidity change, in Proceedings of the International Conference on Solid-State 
Sensors and Actuators (Transducers’ 97) , pp. 855– 858, Chicago, 16– 19 June 1997.
	
3.	 L. Lin, R.T. Howe and A.P. Pisano, Microelectromechanical filters for signal pro-
cessing, Journal of Microelectromechanical Systems , Vol. 7, No. 3, pp. 286– 294, 1998.
	
4.	 K. Wang and C.T.-C. Nguyen, High-order micromechanical electronic filters, 
in Proceedings of the IEEE International Microelectromechanical Systems Workshop , 
pp. 25– 30, Nagoya, Japan, 26– 30 January 1997.
	
5.	 C.T.-C. Nguyen, Frequency-selective MEMS for miniaturized low power com-
munication devices, IEEE Transactions on Microwave Theory Technology , Vol. 47, 
No. 8, pp. 1486– 1503, 1999.
	
6.	 Y. Oh, B. Lee, S. Baek, H. Kim, J. Kim, S. Kang and C. Song, Surface-
micromachined tunable vibratory gyroscope, in Proceedings of the IEEE 
International Microelectromechanical Systems Workshop , pp. 272– 277, Nagoya, 
Japan, 26– 30 January 1997.
	
7.	 K. Tanaka, Y. Mochida, M. Sugimoto, K. Moriya, T. Hasegawa, K. Atsuchi and 
K. Ohwada, A micromachined vibrating gyroscope, Sensors and Actuators , Vol. 
50, pp. 111– 115, 1995.
	
8.	 S.K. Clark and K.D. Wise, Pressure sensitivity in anisotropically etched thin-
diaphragm pressure sensors, IEEE Transactions on Electron Devices , Vol. 26, No. 
12, pp. 1887– 1896, December 1979.

99
Out-of-Plane Resonant Capacitive Detection Magnetometer
	
9.	 A.L. Herrera-May, P.J. Garcí a-Ramí rez, L.A. Aguilera-Corté s, J. Martí nez-
Castillo, A. Sauceda-Carvajal, L. Garcí a-Gonzá lez and E. Figueras-Costa, A 
resonant magnetic field microsensor with high quality factor at atmospheric 
pressure, Journal of Micromechanics and Microengineering , Vol. 19, No. 1, pp. 1– 11, 
January 2009.
	 10.	 E. Manjarrez, A.L. Herrera-May, L.A. Aguilera-Corté s and P.J. Garcí a-Ramí rez, 
Resonant magnetic field sensors based on MEMS technology, Sensors Journal , 
Vol. 39, No. 9, pp. 7785– 7813, 2009.
	 11.	 M.T. Todaro, L. Sileo and M. De Vittorio, Magnetic field sensors based on micro-
electromechanical systems (MEMS) technology, in Magnetic Sensors: Principles 
and Applications , Chapter 6, K. Kuang Ed., Intech, Croatia, 2012.
	 12.	 V. Kaajakari, Practical MEMS: Design of Microsystems, Accelerometers, Gyroscopes, 
RF MEMS, Optical MEMS, and Microfluidic Systems , Small Gear Publishing, Las 
Vegas, NV, 2009.
	 13.	 S. Brugger and O. Paul, Field-concentrator-based resonant magnetic sensor 
with integrated planar coils, Journal of Microelectromechanical Systems , Vol. 18, 
No. 6, pp. 1432– 1443, December 2009.
	 14.	 H. Emmerich and M. Schofthaler, Magnetic field measurements with a novel 
surface micromachined magnetic-field sensor, IEEE Transactions on Electron 
Devices , Vol. 47, pp. 972– 977, 2000.
	 15.	 J.W. Kang, H. Guckel and Y. Ahn, Amplitude detecting micromechanical res-
onating beam magnetometer, in The Eleventh International Workshop on Micro 
Electro Mechanical Systems , pp. 372– 377, Heidelberg, Germany, 1998.
	 16.	 M. Offenberg, F. Larmer, B. Elsner, H. Munzel and W. Riethmuller, Novel pro-
cess for a monolithic integrated accelerometer, in Eighth International Conference 
on Solid-State Sensors and Actuators (Transducers’ 95) , pp. 582– 592, Stockholm, 
Sweden, 1995.
	 17.	 M. Offenberg, H. Mü nzel, D. Schubert, O. Schatz, F. Lä rmer, E. Mü ller, B. 
Maihö fer and J. Marek, Acceleration sensor in surface micromachining for air-
bag applications with high signal/noise ratio, in Proceedings of the International 
Congress and Exposition , pp. 35– 41, Detroit, MI, 26– 29 February 1996.
	 18.	 D. Ullmann et al., Sensors for automotive safety systems in surface microma-
chining, VDI Rep. 1415, 1998.
	 19.	 B. Bahreyni and C. Shafai, A resonant micromachined magnetic field sensor, 
IEEE Sensors Journal , Vol. 7, No. 9, pp. 1326– 1334, 2007.
	 20.	 M.J. Thompson and D.A. Horsley, Resonant MEMS magnetometer with capaci-
tive read-out, in 2009  IEEE Sensors Conference , pp. 992– 995, Christchurch, New 
Zealand, 25– 28 October 2009.
	 21.	 Z. Ká dá r, A. Bossche, P.M. Sarro and J.R. Mollinger, Magnetic-field measure-
ments using an integrated resonant magnetic-field sensor, Sensors Actuators A 
Physical , Vol. 70, No. 3, pp. 225– 232, 1998.
	 22.	 J. Tucker, D. Wesoleck and D. Wickenden, An integrated CMOS MEMS xylo-
phone magnetometer with capacitive sense electronics, 2000  NanoTech , pp. 1– 5, 
Houston, TX, 2002.
	 23.	 J. Kyynä rä inen et al., A 3D micromechanical compass, Sensors and Actuators A , 
Vol. 142, No. 2, pp. 561– 568, 2008.
	 24.	 D. Ren, L. Wu, M. Yan, M. Cui, Z. You and M. Hu, Design and analyses of 
a MEMS based resonant magnetometer, Sensors Journal , Vol. 9, No. 9, pp. 
6951– 6966, 2009.

100
Magnetic Sensors and Devices
	 25.	 A.L. Herrera-May, L.A. Aguilera-Corté s, P.J. Garcí a-Ramí rez, N.B. Mota-
Carrillo, W.Y. Padró n-Herná ndez and E. Figueras, Development of reso-
nant magnetic field microsensors: Challenges and future applications, in 
Microsensors , I. Minin (Ed.), Chapter 3, InTech, Rijeka, Croatia, 2010.
	 26.	 P. Gkotsis, M. Lara-Castro, F. Ló pez-Huerta, A.L. Herrera-May and J.-P. Raskin, 
Mechanical characterization and modeling of Lorentz force based MEMS mag-
netic field sensors, Solid-State Electronics , Vol. 112, pp. 68– 77, 2015.
	 27.	 J.A. Tapia, A.L. Herrera-May, P.J. Garcí a-Ramí rez, J. Martí nez-Castillo, E. 
Figueras, A. Flores and E. Manjarrez, Sensing magnetic flux density of arti-
ficial neurons with a MEMS device, Biomedical Microdevices , Vol. 13, No. 2, pp. 
303– 313, April 2011.
	 28.	 S. Ranvier, V. Rochus, S. Druart, H. Lamy, P. Rochus and L.A. Francis, Detection 
methods for MEMS-based xylophone bar magnetometer for pico satellites, 
Journal of Mechanics Engineering and Automation , Vol. 1, pp. 342– 350, 2011.
	 29.	 M.H. Said, F. Tounsi, P. Gkotsis, M. Masmoudi and L.A Francis, MEMS-based 
clamped-clamped beam resonator capacitive magnetometer, Transactions on 
Systems, Signals and Devices , Vol. 9, No. 4, pp. 483– 499, 2013.
	 30.	 W. Weaver, S.P. Timoshenko and D.H. Young, Vibration Problems in Engineering , 
5th Edn, Wiley, New York, 1990.
	 31.	 M.H. Said, F. Tounsi, P. Gkotsis, M. Masmoudi and L.A Francis, A MEMS 
resonant magnetometer based on capacitive detection, 10th IEEE International 
Multi-Conference on Systems, Signals and Devices (SSD) , Tunisia, 2013.
	 32.	 W.S. Ibrahim and W.G. Ali, A review on frequency tuning methods for piezo-
electric energy harvesting systems, Journal of Renewable Sustainable Energy , Vol. 
4, No. 6, pp. 29, November 2012.
	 33.	 K.B. Lee, L. Len and Y.H. Cho, A closed-form approach for frequency tunable 
comb resonators with curved ﬁ nger contour, Sensors and Actuators A , Vol. 141, 
No. 2, pp. 523– 529, 2008.
	 34.	 R. Todd and W. Liwei, Active frequency tuning for micro resonator by localized 
thermal stressing effects, Sensors and Actuators A , Vol. 91, No. 3, pp. 326– 332, 
2001.
	 35.	 G. Shim, R. Mimoto, S. Kumagai and M. Sasaki, Macro model study for non-
linear spring of tense torsion bar in gap-closing type electrostatic micromirror, 
Journal of Mechanics Engineering and Automation , Vol. 2, No. 7, pp. 446– 454, 2012.
	 36.	 W. Sul Lee, K.C. Kwon, B.K. Kim, J.H. Cho and S.K. Youn, Frequency-shifting 
analysis of electrostatically tunable micro-mechanical actuator, Journal of 
Modeling and Simulation of Microsystems , Vol. 2, No. 1, pp. 83– 88, 2001.
	 37.	 J.A. Pelesko and D.H. Bernstein, Modeling MEMS and NEMS , CRC Press, Boca 
Raton, FL, 2002.
	 38.	 S. Margulies, Force on a dielectric slab inserted in a parallel plate capacitor, 
American Journal of Physics , Vol. 52, No. 6, pp. 515– 518, June 1984.
	 39.	 M.H. Said, F. Tounsi, P. Gkotsis, B. Mezghani and L.A Francis, A resonant 
microstructure tunability analysis for an out-of-plane capacitive detec-
tion MEMS magnetometer, Microsystem Technologies , July 2016, DOI:10.1007/
s00542-016-3093-y.

101
4
Micromachined Inductive Contactless 
Suspension: Technology and Modeling
Kirill V. Poletkin, Vlad Badilita, Zhiqiu Lu, 
Ulrike Wallrabe, and Christopher Shearwood
ABSTRACT  Microelectromechanical systems (MEMS) have been used 
in an ever-increasing number of applications, on the one hand, replacing 
traditional sensors based on the bulk technologies; and on the other hand, 
applied principally to new applications, for instance, in healthcare, energy 
harvesting, active safety systems, computer hard drives, mobile devices, and 
adaptive optics. One of the main features of MEMS technology is minia-
turization, which offers a multitude of advantages.  However, as a result of 
shrinking size, the sensitivity of a microsensor is dramatically decreased 
due to the scaling effect and the domination of friction over inertial forces 
in the microworld. In turn, these facts also limit the performance of a micro-
actuator. An indisputable solution is levitation, which eliminates completely 
CONTENTS
4.1	
Introduction................................................................................................. 102
4.1.1	 Micromachined Electromagnetic Contactless Suspensions..... 105
4.1.2	 Micromachined Inductive Suspension........................................ 106
4.2	
Technology................................................................................................... 107
4.2.1	 Planar Coils Technology................................................................ 107
4.2.2	 3-D Microcoil Technology............................................................. 108
4.3	
Modeling...................................................................................................... 110
4.3.1	 Analytical Model............................................................................ 112
4.3.1.1	 Static Behavior of MIS..................................................... 115
4.3.1.2	 MIS Linear Model............................................................ 117
4.3.1.3	 Stable Levitation............................................................... 119
4.3.2	 Analysis of MIS Designs................................................................ 119
4.3.2.1	 Preliminary Analysis of Stability of MIS Based on 
Plane Coils......................................................................... 121
4.3.2.2	 Analysis of MIS Design Based on Two 3-D Coils........123
Acknowledgments...............................................................................................128
References..............................................................................................................128

102
Magnetic Sensors and Devices
physical attachment and, consequently reduces drastically mechanical fric-
tion. In particular, a micromachined inductive contactless suspension as a 
promising technology, to realize mentioned above scenario, is discussed in 
this chapter.
4.1  Introduction
Microelectromechanical systems (MEMS) are used in an ever-increasing 
number of applications. On the one hand, they are replacing traditional sen-
sors based on the bulk technologies and, on the other hand, they are applied 
principally to new applications, for instance, in health care, energy harvest-
ing, active safety systems, computer hard disk drives, mobile devices, and 
adaptive optics. Due to the remarkable progress in microsensors and actua-
tors, micromotors with a diameter of one-tenth of a millimeter [1,2], iner-
tial microsensors having a size less than 1  ×   1  mm2  [3,4], or microgenerators 
with a diameter of a few millimeters [5] are possible. These devices have also 
confirmed the feasibility of other advanced device concepts for the further 
improvement of performances in MEMS.
One of the main features of MEMS technology is miniaturization, which 
offers a multitude of advantages [6]. Indeed, micromachined inertial sen-
sors can be easily incorporated into human clothes (i.e., shoes) to provide 
autonomous navigation parameters compared with bulk inertial sensors. A 
microsensor can be comfortably and gently embedded into the human body 
to continuously monitor its medical parameters. Micro-objects can be much 
more cautiously handled and precisely transported by a micromanipulator 
and a microtransporter, respectively, than their macro-counterparts [7]. In 
fact, the Internet of everything and wearable interfaces are only made pos-
sible by the availability of MEMS technology.
However, as a result of its shrinking size, the sensitivity of a microsensor 
is dramatically decreased due to the scaling effect and the domination of the 
friction over inertial forces in the microworld. In turn, these facts also limit 
the performance of a microactuator. An indisputable solution is levitation, 
which completely eliminates the mechanical attachment, and consequently 
the friction, between the stationary and moving parts of a microsensor and 
a microactuator. Besides, for a microactuator, levitation provides the exten-
sion of a motion range of its moving parts and reduces dissipated or wasted 
energy significantly. Although different physical mechanisms can be used to 
provide levitation, such as a jet of gas, intense sound waves, or beams of laser 
light [8], only levitation by means of electric and magnetic fields or electro-
magnetic levitation are practicable and have already attracted a great deal of 
attention from researchers, giving a rise to a new generation of microsensors 
and microactuators (see Table  4.1).

103
Micromachined Inductive Contactless Suspension
TABLE 4.1 
 Micromachined Electromagnetic Contactless Suspensions
Types of 
Suspension 
Sources of Force 
Field 
Materials of Levitated 
Mass/Rotor 
Applications  
Technologies  
Ref.  
Active 
Contactless 
Suspensions 
Conductive material
Suspension
Surface micromachining
[9]
Electric 
Electrical field
Dielectric
Suspension
Bulk
[10]
Semiconductors and 
conductive material
Accelerometer 
Exotic ball micromachining
[11,12]
Gyroscope 
multisensor
Bulk micromachining
[13,14,16,17]
Magnetic 
Direct current
Magnet
Actuator
Surface micromachining
[18]
Passive 
Contactless 
Suspensions 
Inductive
Alternating current
Conductive material
Gyroscope
Surface micromachining
[19–21]
Accelerator 
[22,23] 
Suspension 
[24] 
3-D microcoil
[25] 
Diamagnetic 
Magnet 
Diamagnetic 
Accelerometer 
Mix of surface micromachining 
and bulk
[26]
Motor 
Surface micromachining
[27]
Gyroscope 
Bulk micromachining
[15]
(Continued)

104
Magnetic Sensors and Devices
TABLE 4.1  (CONTINUED)
Micromachined Electromagnetic Contactless Suspensions
Types of 
Suspension
Sources of Force 
Field
Materials of Levitated 
Mass/Rotor
Applications 
Technologies 
Ref. 
Superconducting
Magnet
Superconductor
Actuator
Surface micromachining
[28]
Suspension
[29]
Hybrid 
Suspensions 
Diamagnetic-
Inductive 
Magnet ac
Diamagnetic conductive 
material
Gyroscope 
Mix of surface micromachining 
and bulk
[30]
Electrostatic-
Inductive 
Electrostatic field ac
Conductive material
Suspension 
Mix of surface micromachining 
and 3-D microcoil
[31,43]

105
Micromachined Inductive Contactless Suspension
4.1.1  Micromachined Electromagnetic Contactless Suspensions
The main issue of employing levitation in MEMS relates to stability or sta-
ble levitation. Stable levitation (suspension) means that a levitated mass is 
restored to rest when it is slightly displaced in any linear and angular direc-
tion from an equilibrium position. According to Earnshaw’ s theorem, in a 
system of electric charges or magnetic monopoles, stable levitation is impos-
sible. In other words, from the point of view of the Lagrange– Maxwell equa-
tions, the potential energy (stored energy) of such a system does not have 
a local minimum. Therefore, stable levitation in a micromachined suspen-
sion based on an electrostatic field is only reached by using active control, 
in which an electric field is varied in such a way that the levitated mass 
is held at an equilibrium position. Such an approach to stable levitation is 
called active contactless suspension  (AS). However, a static magnetic field cre-
ated by a magnet can itself imitate the control system if the levitated mass 
is, for instance, diamagnetic. Hence, the restrictions of Earnshaw’ s theorem 
are overcome and stable levitation in a static magnetic field becomes pos-
sible. This is referred to as passive contactless suspension  (PS). A summary of 
achievements in the fabrication and application of micromachined active 
and passive contactless suspensions is shown in Table  4.1.
The use of either AS or PS has its own advantages as well as disadvan-
tages. Nevertheless, the principal difference between AS and PS is that AS 
requires displacement sensors to control all motion of the levitated mass, 
but PS isn’ t constrained in the same way. Hence, in assuming other condi-
tions being equal, the realization of a micromachined contactless suspen-
sion based on PS is easier than that based on AS. As seen from Table  4.1, 
there are three possible techniques to build a micromachined PS, namely, 
diamagnetic, superconducting, or inductive contactless suspension. A key 
advantage of the first technique is that a permanent magnet is used. Due 
to this fact, we have a manifest benefit, which is stable levitation without 
the requirement of direct energy consumption [32]. Unfortunately, the load 
bearing capability of a diamagnetic suspension is small, which is reflected in 
its current performances and applications. The second technique requires a 
cryogenic environment, which becomes the major limit for the application of 
a superconducting suspension. An inductive suspension does not share the 
disadvantages previously mentioned. Moreover, recent achievements in the 
development of a micromachined inductive suspension (MIS), which estab-
lished its micromachining fabrication process [35] and led to dramatically 
reducing heat dissipation [45], announce it as a very promising candidate as 
an integrated element for levitating microsystems.
Now, consider for a moment, the benefits from combining a diamagnetic and 
inductive suspension. Such a hybrid suspension is possible by the fabrication 
of the levitated mass as a multilayer consisting of conductive and diamagnetic 
materials, and for levitation, two sources of force fields are required, namely, an 
alternating current (ac) feeding the coils and a permanent magnet. As a result, a 

106
Magnetic Sensors and Devices
micromachined PS is created, in which, on the one hand, using an inductive sus-
pension increases the carrying capability of the diamagnetic suspension and, on 
the other hand, the inductive suspension dissipates less energy because of the 
diamagnetic contribution. As seen, this hybrid suspension improves the energy 
performance of the PS in comparison with that of the diamagnetic or inductive 
suspension separately. It is worth noting that the hybrid suspension based on 
diamagnetic and inductive levitation was successfully fabricated and demon-
strated in a micromachined gyroscope application by Liu et al. in [30]. Another 
hybrid suspension based on electrostatic actuation and induction levitation has 
recently been reported in [31]. This hybrid suspension is capable of adjusting 
dynamics by means of changing the values of its stiffness components and 
operating as a bistable microactuator. Moreover, such a hybrid suspension pro-
vides a platform to obtain a quasi-zero spring constant as was proposed in [33]. 
A micromachined prototype of this hybrid suspension and preliminary results 
of its experimental investigations accompanied by quasi-exact nonlinear mod-
eling are presented in [43]. Hence, a new dynamic performance in the microma-
chined PS can be demonstrated by means of this electrostatic-inductive hybrid 
suspension. Thus, the hybrid suspension becomes a very promising technique 
to provide further improvements in the performance of a micromachined con-
tactless suspension and, consequently, the expansion of its application.
4.1.2  Micromachined Inductive Suspension
The MIS is one of the key techniques to realizing a micromachined PS as well 
as a hybrid suspension, as shown in Table  4.1. As a rule, the MIS consists of a 
coil and a conductive proof mass (PM). The coil is fed by a high-frequency ac 
and generates a time-variable magnetic flux in space, which in turn induces 
an eddy current within the PM. Due to Ampere’ s law, the interaction between 
the eddy and the coil current produces a repulsive force between the coil and 
the PM. The repulsive force is the cause of the PM levitation.
As an illustrative example, consider the design of the MIS shown 
in Figure  4.1, which provides stable levitation of the disk-shaped PM. 
Originally, this design was proposed and a proof of concept demonstrated 
in [24]. Although the operating principle is the same as just mentioned, to 
provide stable levitation two coils are required, namely, a stabilization and 
PM
IL
IS
Stabilization coil
Levitation coil
Eddy current
FIGURE  4.1 
Design of MIS for stable levitation.

107
Micromachined Inductive Contactless Suspension
a levitation coil. Both coils are fed by ac at a high frequency, but with a 180 
phase shift between the stabilization and levitation coil. Due to its intrinsic 
simplicity, this design is widely used in other prototypes of MIS reported in 
the literature. Besides, a simple extension of this design can provide phased 
poles to rotate the PM, as was demonstrated by Shearwood [34]. It is obvious 
that in depending on the MIS application, there are other MIS designs (see 
Table  4.1); however, the common point for all of them encompasses two main 
factors: the microcoils fabrication and stable levitation of the PM.
This chapter aims to consider these two issues in detail. Namely, Section  4.2 
considers micromachined technologies, which have already been established for 
microcoil fabrication. These technologies are surface micromachining and 3-D 
coil technology. Section  4.3 discusses analytical mathematical methods, which 
have been extensively applied to model the MIS stability, dynamics, and statics.
4.2  Technology
The MIS has been actively studied since 1995, when Shearwood [24] fabri-
cated the first prototype targeted at applications including a micromachined 
motor and gyroscope. Then, in 2006, the Zhang group presented the MIS with 
an improved planar coil design [20]. An alternative coil design in the shape 
of a rectangular spiral, which also provides stable levitation, was employed 
in the microgyroscope prototype reported in [21]. All the aforementioned 
research groups used surface micromachining technology for coil fabrica-
tion. Due to this technology, the coils and levitated PM dissipated a lot of 
energy. As a result, the observed temperatures of the coils and PM were as 
high as 600° C and 100°  C, respectively. In 2011, using recently developed 3-D 
coil technology [35], the Badilita group dramatically reduced the energy dis-
sipation in the MIS [25] and proposed a new application for the MIS as a 
micromachined transporter. This group also established the technological 
direction for further improvement of the MIS.
4.2.1  Planar Coils Technology
In general, microcoil fabrication for the MIS focuses on the following target 
characteristics: a high electrical quality factor and hence low electrical resis-
tance, an increase in the number of winding turns to reduce the amplitude of 
the coil current, electrical winding insulation, and low manufacturing and 
assembly costs.
Designs of the planar microcoils used in the MIS are shown in Figure  4.2. 
Both designs of the MIS shown in Figures  4.1 and 4.2a provide only stable levita-
tion of the disk-shaped PM, while Figure  4.2b and c demonstrate designs that in 
addition to stable levitation allow us to rotate the PM. The rotation is achieved 
by using poles, which are sequentially excited by a high-frequency current. The 
frequency of the excitation of the poles defines the PM rotation speed.

108
Magnetic Sensors and Devices
Planar microcoil fabrication exploits surface macromachining technology, 
which includes the following essential techniques: metal evaporation, elec-
troplating, and wet chemical etching. An outline of the fabrication process 
for a one-layer planar microcoil is shown in Figure  4.3.
As seen from Figure  4.3, the fabrication of a one-layer coil is relatively sim-
ple. As a result, within the framework of one layer, designing the coil becomes 
flexible allowing for the design of a complex coil structure. However, the fab-
rication complexity is dramatically increased once the number of layers and, 
consequently, the number of coil turns are increased. Moreover, on the one 
hand, the need to increase coil turns arises due to the technological problem of 
obtaining a low electrical resistance coil, which limits the current amplitude in 
the coil and, as a result, the performance of the MIS. On the other hand, there 
is a physical limit to the maximum possible current density of metal.
4.2.2  3-D Microcoil Technology
Using 3-D microcoil technology, a microcoil with an unlimited number of 
turns can be fabricated. Moreover, irrespective of the number of turns, only 
two masks are required for the fabrication. The typical design of 3-D coils, 
which is applied to the MIS (3-D MIS), is shown in Figure  4.4a. This design 
includes two 3-D microcoils, namely, stabilization and levitation, which have 
I
I
(a)
I2
I3
I1
(b)
I4
I1
I2
I3
(c)
FIGURE  4.2 
Designs of planar microcoils: I  is the electric current.

109
Micromachined Inductive Contactless Suspension
the same targets as the coils in the planar design shown in Figure  4.1. As an 
example, Figure  4.4b shows the fabricated 3-D microcoil structure according 
to the design of two 3-D microcoils shown in Figure  4.4a.
The fabrication process consists of three main steps. In the first step, using 
surface micromachining, pads for electrical contacts are fabricated on the 
substrate by the same process outlined in Figure  4.3, where the first mask 
is used. In the second step, usually 600– 700 μ m-thick SU-8 2150 is cast on 
the substrate. Using the second mask, the cylindrical pillars are structured 
by ultraviolet (UV) lithography. An outline of this process is shown in 
Figure  4.5. In the last step, the coils are manufactured using an automatic 
wirebonder, which allows us to freely define the total number of windings 
Process:
(a)
(d)
(e)
(f)
(b)
(c)
Evaporation of seed layer Au/Cr on the
substrate
Coating photoresist
Deﬁne, pattern, and develop coils housing
Electroplating gold
Removing photoresist
Etching gold, then chrome
Materials:
Substrate
Photoresist
Gold
Chrome
FIGURE  4.3 
Outline of the fabrication process for a one-layer planar microcoil.
Levitation coil
(a)
Stabilization coil
IL
IS
SU8
Au wires
Au pads
(b)
1 mm
FIGURE  4.4 
(a) Design of 3-D microcoils for the MIS; (b) fabricated 3-D microcoils.

110
Magnetic Sensors and Devices
per coil, the pitch between the windings, and the number of winding layers. 
Although using a wirebonder for coil fabrication is a serial process, this pro-
cess is very fast—hundreds of milliseconds per coil depending on the exact 
dimensions—and perfectly integrates with traditional MEMS processes [35].
Thus, 3-D microcoils as opposed to planar microcoils dramatically increase 
the number of winding turns and, at the same time, drastically reduce the 
fabrication complexity. By embracing 3-D microcoils, energy dissipation is 
significantly reduced. The measured temperatures of coils and levitated 
PM were around 100°  C and 55°  C, respectively, for a PM levitation height 
of 120  μ m, and the levitation coil with 20 windings and the stabilization 
coil with 15 windings as reported in [36]. The abovementioned advantages 
of 3-D microcoils, which are supported by using 3-D coil technology, fur-
ther improve the MIS performance and open a new application of MIS, for 
instance, in microtransporters. Such a 3-D structure, which was fabricated in 
cooperation with the Laboratory for Microactuators and the Laboratory for 
Simulation at IMTEK, Freiburg University, and can be applied as a micro-
transporter, is shown in Figure  4.6. Figure  4.6 also shows that 3-D coil tech-
nology allows for the fabrication of noncylindrical coils.
4.3  Modeling
As previously mentioned, upon designing the MIS a key issue is to provide 
stable levitation of PM. This means that a proposed design of MIS, namely, 
geometrical parameters of coils and PM, and the values of currents in each 
Process:
(a)
(c)
(b)
Developing SU-8
Materials:
Substrate
Viscous SU-8
Gold
Solid SU-8
SU-8 is cast on the substrate
Structuring the cylindrical pillars by UV
lithography
Greenlight
Photomask
Pads
FIGURE  4.5 
 Outline of the fabrication process of cylindrical pillars.

111
Micromachined Inductive Contactless Suspension
coil, must fulfill the condition for stable levitation. Considering the MIS as 
an electromechanical system, this condition for stable levitation results from 
the existence of a local minimum of potential energy (stored energy) of such 
a system. Thus, in order to obtain this condition for stable levitation for a 
particular design of the MIS, its potential energy should be known and pre-
sented in analytical form. In general, the MIS is a system with distributed 
parameters and is described by a set of partial differential equations. Hence, 
the presentation of the MIS potential energy in analytical form has an obvi-
ous difficulty. Due to this fact, the first design of the MIS (see Figure  4.1), 
which provided stable levitation of the disk-shaped PM, was a result of pure 
experiential development of the Shearwood group.
However, for the case when the MIS consists of a disk-shaped PM and a 
ring-shaped coil fed by a high-frequency current, I , as shown in Figure  4.7a, 
the distribution of the eddy current density within the PM induced by the 
FIGURE  4.6 
Wirebonded nonsolenoidal structure realized in cooperation with the Laboratory for 
Microactuators and the Laboratory for Simulation.
I
PM
Coil
(a)
I
Ie
(b)
FIGURE  4.7 
(a) Design of the MIS with the disk-shaped PM and ring-shaped coil; (b) idealization: I e   is the 
eddy current.

112
Magnetic Sensors and Devices
time-variable magnetic flux is well known. The maximum density of the 
eddy current is distributed along the edge of the PM. The value of the eddy 
current density is exponentially reduced from the PM circumference to its 
center. Hence, it can be assumed that the eddy current flowing along the 
edge of the PM and the coil current define the acting forces between the disk-
shaped PM and the ring-shaped coil; the design shown in Figure  4.7a can be 
idealized and represented as the lumped system depicted in Figure  4.7b. The 
interaction between the coil and the disk can be considered as the interac-
tion between two ring-shaped coils. Now, in the framework of this lumped 
system, the analytical form of the potential energy can be written and then 
applied to a more complex design consisting of more coils. Moreover, know-
ing the MIS potential energy, the dynamic and static characteristics of the 
MIS can be evaluated. Thus, the analytical model of the MIS can be obtained, 
which describes the MIS behavior qualitatively. It becomes a powerful math-
ematical tool for MIS modeling that can be used to develop new MIS designs 
with, for instance, an improved dynamic performance [37–39,44].
4.3.1  Analytical Model
To describe the behavior of the PM with respect to the coil shown in 
Figure  4.7a, let us assign the following coordinate frames (CF), namely, the 
fixed CF XYZ  to the coil and the movable CF xyz  to the PM. The Z -axis of the 
fixed CF is coincident with the coil axis, which is passed through the coil cen-
ter and perpendicular to the coil plane. The origin A  of the fixed CF is located 
at the intersection of the coil axis and its equatorial plane. Meanwhile, the 
axes of the movable CF coincide with the principal axes of inertia of the disk-
shaped PM.
An arbitrary position of the PM, when the PM is disturbed, is shown in 
Figure  4.8. Assume that the origin B  of the movable CF is coincident with the 
center of mass of PM and, in rest (equilibrium state), with the origin O . The 
position of the origin O  in space with respect to the fixed CF is character-
ized by a vector r ⃗ o    =  (X o  , Y o  , Z o  ). In particular, the vector r ⃗  o   can be defined as 
r ⃗  o    =  (0, 0, h ), where h  is the levitation height of the PM. Also, let us introduce 
the following auxiliary CFs, namely, x 1 y 1 z 1 , the origin of which is coincident 
with point O , x 2 y 2 z 2 , and x 3 y 3 z 3 , the origins of which are assigned to point 
B . In addition to the axes of CF x 1 y 1 z 1 , CF x 2 y 2 z 2  and fixed CF are collinear. 
The position of CF x 3 y 3 z 3  with respect to CF x 2 y 2 z 2  is defined by the angle 
α , which characterizes the angular misalignment of CF x 3 y 3 z 3  relative to the 
Bz 2  axis. Besides, the Bx 3  is coincident with the x -axis of the movable CF. In 
turn, the movable CF has angular misalignment with respect to CF x 3 y 3 z 3  
defined by the angle φ  relative to the Bz 3  axis.
Due to the particular design of the MIS under consideration, and since the 
linear displacements of PM are assumed to be small, the mechanical proper-
ties of the suspension can be considered isotropic in the radial direction and 
independent of the angle α . Also, it is assumed that there is no rotation of the 

113
Micromachined Inductive Contactless Suspension
PM relative to the Bz  axis. Then, the generalized coordinates for describing 
the mechanical part of the MIS can be introduced as follows. The generalized 
coordinate, s   =  √ (x 1 2   +  y 1 2 ), characterizes the linear displacement of the center 
of mass of the PM in the radial direction. The generalized coordinate, l , char-
acterizes the linear displacement of the center of mass of the PM along the 
Oz 1 , and the generalized coordinate, φ , characterizes the angular displace-
ment of the PM relative to an axis coincident with the principal axis of inertia 
of the disk-shaped PM lying on its equatorial plane, as shown in Figure  4.8. 
It is worth noting that the introduced generalized coordinates allow us 
to reduce the system from six to three degrees of freedom to describe the 
mechanical part of the MIS.
The electrical part of the MIS can be represented by two electrical circuits 
having mutual induction between the coil and PM, L m  . The first circuit con-
tains the inductance of the coil, L c  , and its resistance, R c  , and the source 
of ac, i c  , while the second circuit has only the inductance of the PM, L pm  , 
and its resistance, R pm  . The ac can be described by i c    =  Ie j  ω  t  , where I  is the 
amplitude, ω  is the frequency, and j   =  √ (– 1) is an imaginary unit. Due to 
the mutual inductance, L m  , between the coil and PM, the eddy current, i e  , 
is induced. Hence, the current, i e  , is taken as the velocity of the general-
ized coordinate of the electrical part of the MIS. Finally, the state of the 
MIS as an electromechanical system can be described by four generalized 
coordinates.
O
B
A
Z, z1
rÆ
A
rÆ
O
X
Y
x,x3
y
j
j
a
j˙
a
y3
z2, z3
x2
y2
z
x1
y1
s
l
B¢
FIGURE  4.8 
An arbitrary position of the PM, with respect to the fixed CF: x 1 y 1 z 1 , x 2 y 2 z 2 , and x 3 y 3 z 3  are 
auxiliary CFs (green color); r ⃗  A   and r ⃗  B   are vectors characterized by the position of point B  with 
respect to the fixed and auxiliary x 1 y 1 z 1  CFs, respectively; s   =  √ (x 1
2   +  y 1
2 ), l  and φ  are the general-
ized coordinates of the mechanical part of the MIS.

114
Magnetic Sensors and Devices
Adopting the foregoing generalized coordinates and assumptions, the 
model of the MIS can be written using the Lagrange– Maxwell equations as 
follows:
	
d
dt
L
i
i
d
dt
L
l
L
l
l
F
d
dt
L
e
e
l
∂
∂



+ ∂
∂
=
∂
∂



−∂
∂+ ∂
∂
=
∂
∂
Ψ
Ψ
0;
;






s
L
s
s
F
d
dt
L
L
M
s



−∂
∂+ ∂
∂
=
∂
∂



−∂
∂
+ ∂
∂
=





Ψ
Ψ
;
,
ϕ
ϕ
ϕ
ϕ







	
(4.1)
where:
L
T l s
l
W
l s
i i
m
c
e
= (
) −
+
  
, ,
( )
( , , , , )
ϕ
ϕ
Π
  is the Lagrange function for the PM– coil 
system
	T l s
  
, ,ϕ
(
)  and Π (l )	
are the kinetic and potential energies of the system
	W m  (l , s ,φ ,i c  , i e  )		
is the energy stored in the electromagnetic field
Ψ  
l s
i i
c
e
, , , ,
ϕ
(
) 		
is the dissipation function of the system
F l  , F s  , and M φ  		
are the generalized forces and torque acting on the 
PM relative to the appropriate generalized coordi-
nates l , s , and φ , respectively
Assuming that the acceleration due to gravity is directed along the Z -axis, 
the potential energy Π  is dependent on the generalized coordinate l  only.
The kinetic energy is
	
T
ml
ms
J
=
+
+
1
2
1
2
1
2
2
2
2


ϕ , 	
(4.2)
where:
	 m 	
is the mass of PM
	 J 	
is the moment of inertia of the PM about the axis lying on its equato-
rial plane
The equations for potential energy and the energy stored within the elec-
tromagnetic field are
	
Π = mgl, 	
(4.3)
	
W
L i
L
l s
i i
L
i
m
c c
m
c e
pm e
=
+
+
1
2
1
2
2
2
( , , )
,
ϕ
	
(4.4)

115
Micromachined Inductive Contactless Suspension
respectively. Note that in Equation  4.4, the mutual inductance L m   is a func-
tion of the generalized coordinates l , s , and φ . Thus, the Lagrange function 
for the system under consideration can be written as
	
L
ml
ms
J
mgl
L i
L
l s
i i
L
i
c c
m
c e
pm e
=
+
+
−
+
+
+
1
2
1
2
1
2
1
2
1
2
2
2
2
2
2


ϕ
ϕ
( , , )
.
	
(4.5)
The dissipation function is
	
Ψ =
+
+
+
+
1
2
1
2
1
2
1
2
1
2
2
2
2
2
2
µ
µ
µ ϕ
ϕ
l
s
c c
pm e
l
s
R i
R
i



, 	
(4.6)
where μ l  , μ s  , and μ φ   are the damping coefficients.
In this study, the coefficients of dissipative function are assumed to be con-
stant. Substituting Equations  4.5 and 4.6 into set  4.1, we obtain the following 
model of the MIS:
	
L
di
dt
L di
dt
L
l l
L
s s
L
i
R
i
m
pm
e
m
c
m
m
m
c
pm e
+
+ ∂
∂
+ ∂
∂
+ ∂
∂




+
=



ϕ ϕ
0;






l
l
mg
L
l i i
F
ms
s
L
s i i
F
J
l
m
c e
l
s
m
c e
s
+
+
−∂
∂
=
+
−∂
∂
=
+
µ
µ
ϕ
µ ϕ
ϕ
;
;
−∂
∂
=














L i i
M
m
c e
ϕ
ϕ,
	
(4.7)
Equation  4.7 is a set of nonlinear equations describing the dynamics of the 
levitated disk-shaped PM, suspended by the MIS in space.
4.3.1.1  Static Behavior of MIS
In the framework of developing the linear model of the MIS, the function of 
mutual inductance L m  , which is a function of the generalized coordinates, 
can be represented in quadratic form as follows:
	
L
l s
c
c l
c s
c
c l
c s
c
c ls
c
m
l
s
ll
ss
ls
l
( , , )
ϕ
ϕ
ϕ
ϕ
ϕϕ
ϕ
=
+
+
+
+
+
+
+
+
0
2
2
2
1
2
1
2
1
2
l
c s
s
ϕ
ϕ
ϕ
+
,
	
(4.8)

116
Magnetic Sensors and Devices
where the coefficients c 0 , c nm   (n   =  l , s , φ ; m   =  l , s , φ ) can be defined as follows. 
Assuming that the equilibrium position of the PM is occupied at the point O  
with the coordinates l   =  h ,  s   =  0, and φ   =  0 (these coordinates of the equilib-
rium point of the PM follow directly from the experimental observation of 
MIS [20,25,34,38]). Then, we can write
	
c
L
h
m
0
0 0
=
( , , ), 	
(4.9)
	
c
L
n
n
l s
n
m
l h
s
= ∂
∂
=
=
=
=
0
0
ϕ
ϕ
, (
, , ),
 
	
(4.10)
	
c
L
n m
n
l s
m
l s
nm
m
l h
s
= ∂
∂∂
=
=
=
=
=
2
0
0
ϕ
ϕ
ϕ
, (
, , ),(
, , ).
 
	
(4.11)
In the static state, the influence of velocities   
l s, ,ϕ , accelerations   
l s, ,ϕ , and 
the generalized forces and torque F l  ,  F s  , M φ   acting on the PM are neglected. 
Hence, set  4.7 becomes
	
L
di
dt
L di
dt
R
i
mg
L
l i i
L
s i i
L
pm
e
m
c
pm e
m
c e
m
c e
m
+
+
=
−∂
∂
=
−∂
∂
=
−∂
∂
0
0
0
;
;
;
ϕ i i
c e =











0.
	
(4.12)
As the current i c   is defined by the current generator, using the first equa-
tions of set  4.12, the amplitude, I e  , of the current, i e  , can be expressed in terms 
of the amplitude of current, i c  , in the complex form as follows:
	
I
I
L
R
L
R
L e
e
pm
pm
pm
pm
m
j
= −
+
+
ω
ω
ω
φ
4
2
2
2
2 2
2
, 	
(4.13)
where φ   =  arctan(R 2 )/(ω L 2 ).
Assuming that the condition for the normal operation of the MIS, which 
requires that the frequency of the feeding current, ω , has to fulfill the inequal-
ity L pm  ω ≫ R pm  , is satisfied [33], Equation  4.13 can be reduced to
	
I
I L
L
e
m
pm
= −
.	
(4.14)
Taking into account Equation  4.14, set  4.12 can be rewritten as follows:

117
Micromachined Inductive Contactless Suspension
	
mg
I
L
L
l
L
h
I
L
L
s
L
h
pm
m
l h
s
m
pm
m
l h
s
m
+
∂
∂
=
∂
∂
=
=
=
=
=
=
2
0
0
2
0
0
0 0
0
ϕ
ϕ
( , , )
;
( ,0 0
0
0 0
0
2
0
0
, )
;
( , , )
.
=
∂
∂
=














=
=
=
I
L
L
L
h
pm
m
l h
s
m
ϕ
ϕ
	
(4.15)
Thus, the obtained set  4.15 describes the static behavior of the MIS. As 
L m  (h ,0,0) and I 2  ⁄   L pm are positive constants and accounting for Equations  4.9 
and 4.10, we can conclude that
	
∂
∂
=
= −
∂
∂
=
=
∂
∂
=
=
=
=
=
=
L
l
L
h
c
C
L
s
c
L
m
l h
s
m
l
m
l h
s
s
m
l
0
0
0
0
0
0 0
0
ϕ
ϕ
ϕ
( , , )
c
;
;
=
=
=
=
=
h
s
c
0
0
0
ϕ
ϕ
,
	
(4.16)
where C   =  (L pm  mg )/(I 2 ).
Hence, the quadratic form of mutual inductance L m   (Equation  4.8) can be 
modified as
	
L
l s
C
c l
c l
c s
c
c ls
c l
c
m
ll
ss
ls
l
( , , )
c
ϕ
ϕ
ϕ
ϕϕ
ϕ
=
−
+
+
+
+
+
+
0
0
2
2
2
1
2
1
2
1
2
   
s s
ϕ ϕ.
	
(4.17)
4.3.1.2  MIS Linear Model
Substituting Equation  4.17 into Equation  4.7, the linear model of the MIS, 
which describes the dynamics of the levitated disk-shaped PM in space, near 
the equilibrium point can be written as follows [39]:
	
ml
l
c
I
L
c
c
c
l
c s
c
F
m
l
pm
ll
l
ls
l
l



+
+
+





+
+








=
µ
ϕ
ϕ
0
2
2
0
;
s
s
c
I
L
C l
c s
c
F
J
c
I
L
c l
s
pm
ls
ss
s
s
pm
l
+
+
+
+

=
+
+
µ
ϕ
ϕ
µ ϕ
ϕ
ϕ
ϕ



0
2
0
2
;
+
+

=










c s
c
M
sϕ
ϕϕ
ϕ
ϕ
.
	
(4.18)

118
Magnetic Sensors and Devices
The analysis of MIS designs [19,20,24,34,40] shows that the following geo-
metrical limits can be applied, namely,
	
h
r
r
h
d
r r
c
pm
pm
c
pm
≪
≪
,r
;
| |
| |
,
,
ϕ <  and 
	
(4.19)
where:
r c   and r pm   are the radii of the coil and PM, respectively
d   =  r pm    −   r c  
Then, the mutual induction as a function of the generalized coordinates 
can be represented in the integral form as follows:
	
L
r
r
l
d
m
c
c
c
=
+
−
−








∫
µ
π
ρ
α
λ
π
0
2
2
0
8
1 92
ln
(
r )
.
, 	
(4.20)
where:
ρ   =  ρ (s )  ≈   √ (r pm  2   +  2r pm  ⋅ s cosα   +  s 2 )
l λ    =  l λ  (l , φ )  =  l   −   r pm  sinφ cosα 
μ 0  is the magnetic permeability of vacuum
Hence, for the particular MIS design shown in Figure  4.7a, the coeffi-
cients  4.9 through 4.11 can be expressed analytically using Equation  4.20 and 
written as follows:
	
c
L
l
a
h
d
h
d
d
a h
d
h
d
ll
m
l h
s
= ∂
∂
=
−
+
=
−
+
=
=
=
∫
2
2
0
0
2
2
2
2 2
0
2
2
2
2 2
ϕ
π
π
α α
[
]
[
] ; 	
(4.21)
	
c
L
r
a
h
d
h
d
d
r
a
h
m
l h
s
pm
pm
ϕϕ
ϕ
π
ϕ
π
α α
= ∂
∂
=
−
+
=
=
=
=
∫
2
2
0
0
2
2
2
2
2 2
2
0
2
2
[
]
cos
2
2
2
2 2
−
+
d
h
d
[
] ; 	
(4.22)
	
c
L
s
a d r
d
h r
d
r
h
d
ss
m
l h
s
pm
pm
pm
= ∂
∂
=
⋅
−
−
+
⋅
+
=
=
=
2
2
0
0
2
2
2
2 2
2
ϕ
(
)
(
)
[
]
; 	
(4.23)
	
c
L
s
a r
d h
h
d
s
m
l h
s
pm
ϕ
ϕ
ϕ
= ∂
∂∂
= −⋅
⋅
+


=
=
=
2
0
0
2
2
2 ; 	
(4.24)
	
c
a
r
h
d
c
a
h
h
d
c
l
0
2
2
2
2
8
1 92
=
+
−






= −
+
ln
.
,
, 	
(4.25)

119
Micromachined Inductive Contactless Suspension
where a   =  μ 0 r c  .
Since c l  φ    =  c ls    =  0, model  4.18 can be reduced to
	
ml
l
c
I
L
c
c
c
l
F
ms
s
c
I
L
c s
l
pm
ll
l
l
s
pm
ss




+
+
+





=
+
+
µ
µ
0
2
2
0
0
2
;
+

=
+
+
+

=









c
F
J
c
I
L
c s
c
M
s
s
pm
s
ϕ
ϕ
ϕ
ϕϕ
ϕ
ϕ
ϕ
µ ϕ
ϕ
;
.


0
2

	
(4.26)
4.3.1.3  Stable Levitation
From Equation  4.26, we can write the stiffness matrix of the MIS, which is
	
S =
⋅
+












c
I
L
c
c
c
c
c
c
c
pm
ll
l
ss
s
s
0
2
2
0
0
0
0
0
ϕ
ϕ
ϕϕ
.
	
(4.27)
Applying the Sylvester criterion to Equation  4.27, the condition for the sta-
ble levitation of the PM in space can be obtained and written in terms of the 
coefficients of the quadratic form of the function of mutual inductance:
	
c
c
c
c
c
c
c
c c
c
ll
l
ll
l
ss
ss
l
+
>
+






>
>
2
0
2
0
2
0
0
,
,
.
ϕϕ
ϕ 	
(4.28)
Thus, inequalities  4.28 are the general condition for the stable levitation of 
the disk-shaped PM in space for the design with a one-ring coil under geo-
metrical limits (Equation  4.19).
4.3.2  Analysis of MIS Designs
Although the model of the MIS (Equation  4.26) and the condition for stable 
levitation (Equation  4.28) are derived for a design consisting of a one-ring-
shaped coil and a disk-shaped PM, it can be easily generalized and applied 
to more complex MIS designs consisting of two or more coaxial ring-shaped 
coils located on one plane as well as in space [37]. In the framework of linear 
modeling, the generalization is reached by means of applying the superposi-
tion rule. Hence, for a general case, when the MIS design consists of n  coaxial 
coils, model  4.26 can be rewritten as follows:

120
Magnetic Sensors and Devices
	
ml
l
c I
L
c I
c I
c I
l
n
pm
ll
l
n


+
+
±
±
+
±








±
=
=
∑
∑
µ
ρ
ρ
ρ
ρ
ρ
ρ
ρ
ρ
ρ
ρ
0
1
1
2
0
ρ
ρ
ρ
ρ
ρ
µ
=
=
=
∑
∑
∑
















⋅=
+
+
±
±
1
1
0
1
n
n
l
s
n
pm
l
F
ms
s
c I
L
;


c I
s
c I
F
J
c I
ss
s
n
n
s
ρ
ρ
ϕ
ρ
ρ
ρ
ρ
ϕ
ρ
ρ
ρ
ϕ
ϕ
µ ϕ
⋅+
±
⋅








=
+
+
±
=
=
∑
∑
1
1
0
;


=
=
=
∑
∑
∑
±
⋅+
±
⋅








=









1
1
1
n
pm
s
n
n
L
c I
s
c I
M
ϕ
ρ
ρ
ρ
ϕϕ
ρ
ρ
ρ
ϕ
ϕ
,















	
(4.29)
where:
	 ρ 	
denotes the coil number as the subscript in the current 
I ρ   and the superscript in coefficients of mutual induction 
c
c
c
n
l s
w
l s
nw
0
1
ρ
ρ
ρ
ϕ
ϕ
,
,
, , ;
, ,
=
=
(
)
(
)
	 I ρ  	
is the amplitude of the current within coil with ρ  number, the ±  sign 
defines the direction of the I ρ   current
In assuming that phase shifts between the currents can be 0°   and 180°   
only, let us assign the + sign to the current flowing in the clockwise direc-
tion, while the –  sign to the counterclockwise direction.
Then, as in Section  4.3.1.3, the condition for stable levitation can be written 
in detail as follows:
	
±
>
±
+
±








±
=
=
=
=
∑
∑
∑
c I
L
c I
c I
c I
n
pm
ll
n
l
n
0
1
1
1
0
1
0
ρ
ρ
ρ
ρ
ρ
ρ
ρ
ρ
ρ
ρ
ρ
ρ
;
n
ss
n
n
ss
n
c I
c I
c I
c I
∑
∑
∑
∑
>
±
>
±
>
±
⋅
±
=
=
=
=
0
0
0
1
1
1
,
,
,
ρ
ρ
ρ
ϕϕ
ρ
ρ
ρ
ρ
ρ
ρ
ϕϕ
ρ
ρ
ρ 1
1
2
n
s
n
c I
∑
∑
>
±



























=
ϕ
ρ
ρ
ρ
.
	
(4.30)

121
Micromachined Inductive Contactless Suspension
Now, using model  4.29 and the condition for stable levitation (Equation  4.30), 
a procedure for analyzing MIS designs can be suggested as follows. In the 
first step, condition  4.30 is applied to a proposed MIS design. If, in the pro-
posed design, stable levitation is possible, then the stability domain as a 
function of the geometrical parameters of the MIS is defined and mapped. In 
the second step, within the defined stability domain the components of the 
MIS stiffness are calculated and mapped.
4.3.2.1  Preliminary Analysis of Stability of MIS Based on Plane Coils
Let us apply the previously mentioned models for the simplest MIS designs, 
which are shown in Figures  4.1. and 4 7b, in order to study their stability. A 
one-plane coil design of the MIS shown in Figure  4.7b is unstable and as a 
result it is not of practical use and so the analysis of its stability is left here as 
an exercise for the reader. (Also the stability analysis for a one-plane coil MIS 
design can be found in [37].)
At the beginning of the stability study of the two-plane coils MIS design, 
let us define its geometrical parameters as shown in Figure  4.9. It is assumed 
that the currents in the coils have the same amplitudes but opposite direc-
tions of flowing. Then, accounting for Equations  4.21 through 4.25 the coef-
ficients of mutual induction become as follows:
c
c
c
a
h
d
c
h
d
c
a
h
d
h
d
h
a
ll
l
s
l
+
=
−
−
+
−


−
−
+


+
2
0
2
2
2
2
2
2
2
2
2
2
2
(
)
(
)
ε
s
l
h
d
c
a
h
d
2
2
2
2
2
+
−
−
+




(
)
, 	
(4.31)
c
a
d
c
r
c
d
h r
c
d
r
h
d
c
a
d
ss
s
pm
pm
pm
l
=
⋅
−
+ −
−
−+
⋅
+
−
−
⋅
2
2
2
2
2
2 2
2
(
) (
)
(
)
[
(
) ]
(
)
(
)
[
]
,
r
d
h r
d
r
h
d
pm
pm
pm
−
−
+
⋅
+
2
2
2 2
	
(4.32)
h
d
rpm
rl
Proof mass
Levitation coil
rs
Stabilization coil
c
FIGURE  4.9 
Two coils MIS design: r pm  , r l  , and r s   are radii of the PM, levitation coil, and stabilization coil, 
respectively; d   =  r pm    −   r l  , c   =  r s    −   r l  .

122
Magnetic Sensors and Devices
	
c
r
a
h
d
c
h
d
c
a
h
d
h
d
pm
s
l
ϕϕ =
−
−
+
−


−
−
+







2
2
2
2
2
2
2
2
2
2 2
2
2
(
)
(
)
[
] , 	
(4.33)
	
c
r h a
c
d
h
d
c
a
d
h
d
s
pm
s
l
ϕ =
−
+
−


+
+










(
)
(
)
,
2
2
2
2
2
2
	
(4.34)
where:
a s    =  μ 0 r s  
a l     =   μ 0 r l  
	
ε =
+
−
−








+
+
−







a
r
h
d
c
a
r
h
d
s
s
l
l
ln
ln
8
1 92
8
1 92
2
2
2
2
(
)
.
.




−1
.	
(4.35)
Analysis of Equations  4.31 through 4.42 shows that d  (d   =  r pm    −   r l  ) and h  
can be considered as independent variables for the stability study. Applying 
condition  4.28, the stability domain can be mapped as shown in Figure  4.10. 
Thus, in the two-plane coils MIS design, stable levitation is possible for the 
size of the PM defined in the range from c β /(1  +  β ) to c β /(β   +  √ (β )), where 
β   =  r l  /r s  .
d
h
cjjcss – c 2
js = 0
cjj = 0
=0
css =0
cll +
c/4
c/2
00
c
b
b
1 + b
b + b
c
cl
2
c0
0
0
0
0
0
0
FIGURE  4.10 
The stability domain of d  and h  shown in blue-gray: arrows show the change of sign from 
minus to plus of the respective equality, when its boundary is crossed in the indicated direc-
tion; β   =  r l/  r s  .

123
Micromachined Inductive Contactless Suspension
4.3.2.2  Analysis of MIS Design Based on Two 3-D Coils
Now, let us study the MIS based on 3-D coils design (3-D MIS) presented in 
Figure  4.4. Although, this design consists of two coils, which is similar to the 
two-plane coils design previously considered; however, 3-D coils allow us to 
add windings for each coil. The winding is characterized by the pitch and a 
number of turns. Figure  4.11 presents the scheme of 3-D MIS, which reflects 
the particularities of the winding, to define the geometrical parameters of 
the design under consideration.
Since there are two ac feeding the coils with amplitudes I S   and I L   in the 
stabilization and levitation coil, respectively, model  4.29 can be rewritten as 
follows:
	
ml
l
c I
c I
L
c I
c I
c I
c I
c I
l
S
S
L
L
PM
ll
S
S
ll
L
L
l
S
S
l
L
L
S
S


+
+
±
±
+
±
(
)
±
µ
0
0
2
0
c I
l
F
ms
s
c I
c I
L
c I
c I
L
L
l
s
S
S
L
L
PM
ss
S
S
ss
L
0
0
0








⋅=
+
+
±
±
;


µ
L
s
S
S
s
L
L
s
S
S
L
L
PM
s
s
c I
c I
F
J
c I
c I
L
c
(
)⋅+
±
(
)⋅

=
+
+
±
ϕ
ϕ
ϕ
ϕ
ϕ
µ ϕ
;


0
0
ϕ
ϕ
ϕϕ
ϕϕ
ϕ
ϕ
S
S
s
L
L
S
S
L
L
I
c I
s
c I
c I
M
±
(
)⋅+
±
(
)⋅

=












,
	 (4.36)
where the coefficient superscripts L  and S  correspond to the stabilization 
and levitation coil, respectively. Using Equations  4.21 through 4.25 and the 
geometry of the design presented in Figure  4.11, the coefficients can be cal-
culated by
h
d
rpm
rl
Proof mass
Levitation coil
rs
Stabilization coil
c
p
N
M
FIGURE  4.11 
3-D coils MIS design: p  is the coils pitch of winding; N  and M  are numbers of winding turns 
for the stabilization and levitation coil, respectively.

124
Magnetic Sensors and Devices
	
c
a
r
h
v p
d
c
c
a
S
s
s
s
v
N
L
l
l
0
2
2
0
1
0
8
1 92
=
+
⋅
+
−
−








=
=
−
∑γ
γ
ln
l
(
)
(
)
.
;
n
8
1 92
2
2
0
1
r
h
v p
d
l
v
M
(
)
.
;
+
⋅
+
−








=
−
∑
	
(4.37)
	
c
a
h
v p
h
v p
d
c
c
a
h
v p
h
l
S
s
s
v
N
l
L
l
l
=
−
+
⋅
+
⋅
+
−
=
−
+
⋅
+
=
−
∑
γ
γ
(
)
(
)
(
) ;
(
)
(
2
2
0
1
v p
d
v
M
⋅
+
=
−
∑
)
;
2
2
0
1
	
(4.38)
	
c
a
h
v p
d
c
h
v p
d
c
c
ll
S
s s
v
N
ll
L
=
+
⋅
−
−
+
⋅
+
−


=
=
−
∑γ
γ
(
)
(
)
(
)
(
)
;
2
2
2
2
2
0
1
l l
v
M
a
h
v p
d
h
v p
d
(
)
(
)
;
+
⋅
−
+
⋅
+


=
−
∑
2
2
2
2
2
0
1
	 (4.39)
	
c
a
d
c r
h
v p
r
c
d
r
c
d
h
v p
ss
S
s
s
s
s
s
=
⋅
−
−
+
⋅
−
−
−
−
⋅
+
⋅
γ 2
2
2
2
(
)
(
) (
(
))
(
(
)) [(
)2
2 2
0
1
2
2
1
1
2
2
+
−
=
⋅
−
+
⋅
+
+
⋅
=
−
∑
(
) ] ;
c
(
) (
)
(
) [
d
c
a
d r
h
v p
r
d
r
d
v
N
ss
L
l
l
l
γ
(
)
] ;
h
v p
d
v
M
+
⋅
+
=
−
∑
2
2 2
0
1
	
(4.40)
	
c
a
r
d
h
v p
d
c
h
v p
d
c
S
s
s
l
v
N
ϕϕ
γ
=
⋅
+
⋅
+
⋅
−
−
+
⋅
+
−


=
(
)
(
)
(
)
(
)
(
)
2
2
2
2
2
2
0
2
−
=
−
∑
∑
=
⋅
+
⋅
+
⋅
−
+
⋅
+


1
2
2
2
2
2
2
0
1
2
;
(
)
(
)
(
)
c
a
r
d
h
v p
d
h
v p
d
L
l
l
l
v
M
ϕϕ
γ
;
	
(4.41)
c
a
r
d h
v p c
d
h
v p
d
c
s
S
s
sl
s
l
v
N
ϕ
γ γ
=
+
+
⋅
−
+
⋅
+
−


=
−
∑
(
)(
)(
)
(
)
(
)
;
2
2
2
0
1
c
a
r
d h
v p d
h
v p
d
s
L
l
sl
l
l
v
M
ϕ
γ γ
=
−
+
+
⋅
+
⋅
+


=
−
∑
(
)(
)
(
)
,
2
2
2
0
1
	 (4.42)
where:
	μ 0  	
	
=  4π   ×   10 −  7   H/m is the magnetic permeability of vacuum
	a s    	
	
=  μ 0 r s  
	a l    	
	
=  μ 0 r l  , r s  
	 r l   	 	
are the radii of the stabilization and levitation coil, respectively
	 p  	 	
is the coils pitch of winding
	 c   	
	
=  r s    −   r l  , r pm   is the radius of the PM
	 d   	
	
=  r pm    −   r l  
	 N  	 and M  	are numbers of winding turns for the stabilization and levita-
tion coil, respectively
	γ sl  , γ s  , and γ l   	are coefficients of similarity

125
Micromachined Inductive Contactless Suspension
Coefficients of similarity are introduced to rearrange the real contribution 
of each coefficient of the quadratic form and adapt model  4.36 to the real 
condition of the suspension operation. This becomes necessary due in real-
ity to the induced eddy current that is distributed along the PM surface, a 
distribution that is frequency dependent. However, analytical model  4.36 is 
obtained by considering the suspension as a lumped system.
From Equation  4.30, the condition for stable levitation is
	
c I
c I
c I
c I
c I
c I
c I
c I
S
S
L
L
ll
S
S
ll
L
L
l
S
S
l
L
L
S
S
L
L
0
0
2
0
0
0
0
±
>
±
+
±
(
)
±
>
;
;
 
	
(4.43a)
	
c I
c I
ss
S
S
ss
L
L
±
> 0; 	
(4.43b)
 	
c I
c I
S
S
L
L
ϕϕ
ϕϕ
±
> 0; 	
(4.43c)
	
c I
c I
c I
c I
c I
c I
S
S
L
L
ss
S
S
ss
L
L
s
S
S
s
L
L
ϕϕ
ϕϕ
ϕ
ϕ
±
(
)⋅
±
(
) >
±
(
)
2. 	
(4.43d)
 Let us consider the 3-D MIS design with the geometrical parameters 
shown in Table  4.2. An experimental study of the 3-D MIS prototype with 
the same parameters was reported in [67].
Using the foregoing set of inequalities (Section  4.3.2.2), the stability of the 
3-D MIS design is studied. Analysis of Equations  4.37 through 4.42 shows 
that d  (d   =  r pm    −   r l  ) and h  can be considered as independent variables for this 
study. Note that the currents in the coils have a 180°   phase shift between 
them, which corresponds to the minus sign in Equation  4.36. Also, we rec-
ommend the following values for coefficients of similarity, γ s    =  0.3, γ l    =  1.2, 
and γ sl    =  0.14, as was previously explained.
Substituting the parameters of the prototype shown in Table  4.2 and the 
values for the currents in the coils, I S    =  0.106  A and I L    =  0.11  A taken from 
[38], into Equations  4.37 through 4.42, we find the boundaries of inequali-
ties  4.43a through 4.43d and the stability domain of d  and h . This stabil-
ity domain is mapped in Figure  4.12. The analysis of Figure  4.12 shows 
TABLE  4.2 
Parameters of the 3-D MIS Design
Radius of the levitation coil, r l  
1000  μ m 
Radius of the stabilization coil, r s  
1900  μ m 
The coils pitch of winding, p 
25  μ m 
Number of windings for stabilization coil, N 
12
Number of windings for levitation coil, M 
20
Radius of PM, r pm  
1600  μ m
Thickness of PM
25  μ m

126
Magnetic Sensors and Devices
that stable levitation in such a prototype is possible. However, solving the 
inequalities  4.43a through 4.43d for the case when there is no phase shift 
between the currents in the two coils, one can demonstrate that there is no 
stability domain, that is, stable levitation is impossible. This fact agrees with 
the experimental observation, which confirmed that stable levitation in the 
prototype under consideration is only possible when the currents have a 180°   
phase shift.
Now, let us calculate the stiffnesses of the 3-D MIS prototype, namely, k l  , 
k s  , and k φ  , which can be defined according to model  4.18 as follows:
	
k
c I
c I
L
c I
C I
c I
c I
c I
c I
l
S
S
L
L
PM
ll
S
S
ll
L
L
l
S
S
l
L
L
S
S
L
L
=
−
−
+
−
(
)
−


0
0
2
0
0






; 	
(4.44)
	
k
c I
c I
L
c I
c I
s
S
S
L
L
PM
ss
S
S
ss
L
L
=
−
−
(
)
0
0
; 	
(4.45)
	
k
c I
c I
L
c I
c I
S
S
L
L
PM
S
S
L
L
ϕ
ϕϕ
ϕϕ
=
−
−
(
)
0
0
, 	
(4.46)
where the self-inductance of the PM, L PM  , can be calculated as [41]
	
L
r
d
r
d
PM
l
l
=
+
+
−




µ
δ
0
8
1 92
(
) ln (
)
.
, 	
(4.47)
0
Stabilization coil
Levitation coil
Pillars
Levitation height h (µm)
2
1
0
×102
0
d (µm)
8
6
4
2
8
00
0
×102
0
0
0
0
0
0
0
0
0
0
Inequality(3.43a)
Inequality(3.43b)
Inequality(3.43c)
Inequality(3.43d)
FIGURE   4.12 
Boundaries of inequalities 4.43a through 4.43d and the stability domain of d  and h  filled by 
the blue-gray color: the arrows show the change of sign from minus to plus of the respective 
inequality, when its bound is crossed in the shown direction.

127
Micromachined Inductive Contactless Suspension
where δ  is the effective width in which the maximum of an induced eddy 
current within the PM is distributed.
As shown in [42], the effective width can be evaluated as δ   =  0.05… 0.1⋅ r pm  . 
Using Equations  4.47 through 4.49, the distribution of stiffnesses within 
the stability domain of a 3-D MIS prototype is mapped and presented in 
Figure  4.13. Figure  4.13 also shows the positioning of the coils and the PM 
relative to the stability domain. The region of interest for the calculation is 
located at the outer edge of the PM. In this particular case, the levitation 
height is 114  μ m and the diameter of the levitated PM is 3.2  mm. Hence, 
the coordinates for calculation are d   =  600  μ m and h   =  114  μ m. The results 
Stabilization coil
Levitation coil
Pillars
Levitation height h (mm)
2
1
0
0
d (mm)
8
6
4
2
Proof mass
kl (N m–1)
114 mm
0.10
0.08
0.06
0.04
0.02
0.12
0.14
´102
´102
0
0
0
0
(a)
(b)
Stabilization coil
Levitation coil
Pillars
Levitation height h (mm)
2
1
00
d (mm)
8
6
4
2
´102
´102
´10–3
Proof mass
114 mm
4
3
2
1
6
5
ks (N m–1)
0
0
0
0
(c)
Stabilization coil
Levitation coil
Pillars
Levitation height h (mm)
2
1
0
×102
×10–6
0
8
6
4
2
8
00
00
0
Proof mass
114 mm
10
8
6
4
2
12
14
kj (mN m rad–1)
×102
0
0
0
0
d (mm)
FIGURE   4.13 
Distribution of the stiffness components, namely, (a) k l  , (b) k s  , and (c) k φ  , within the stability 
domain.

128
Magnetic Sensors and Devices
of both measurements and calculation are shown in Table  4.3. Note that 
the outer edge of the PM is located within the stability domain. This fact 
confirms theoretically that the levitation of the PM under consideration is 
stable. The analysis of Table  4.3 shows that model  4.18 agrees well with the 
measurements.
Acknowledgments
Dr. Zhiqiu Lu gratefully acknowledges the support from the Siemens-DAAD 
Scholarship. Dr. Kirill Poletkin acknowledges with thanks the support of the 
Alexander von Humboldt Foundation. Dr. Vlad Badilita kindly acknowl-
edges support from the German Research Foundation (DFG) through project 
number BA 4275/2-1.
References
	
1.	 L-S Fan, Y-C Tai, and RS Muller, IC-processed electrostatic micromotors, Sensors 
and Actuators , vol. 20, no. 1, pp. 41– 47, 1989.
	
2.	 U Wallrabe, P Bley, B Krevet, W Menz, and J Mohr, Theoretical and experimen-
tal results of an electrostatic micro motor with large gear ratio fabricated by the 
liga process, in Micro Electro Mechanical Systems, 1992, MEMS’ 92, Proceedings. 
An Investigation of Micro Structures, Sensors, Actuators, Machines and Robot. IEEE . 
IEEE, 1992, Travemunde, Germany, pp. 139– 140.
	
3.	 B Boxenhorn and P Greiff, Monolithic silicon accelerometer, Sensors and 
Actuators A: Physical , vol. 21, no. 1, pp. 273– 277, 1990.
	
4.	 P Greiff, B Boxenhorn, T King, and L Niles, Silicon monolithic micromechanical 
gyroscope, in Solid-State Sensors and Actuators, 1991. Digest of Technical Papers, 
TRANSDUCERS' 91., 1991 International Conference on . IEEE, 1991, San Francisco, 
CA. pp. 966– 968.
TABLE  4.3 
Comparison of Suspension Stiffness from Modeling and 
Experiment Results
Stiffnesses 
Measured Values 
Calculated Values by Model  4.36 
k s   (N⋅ m– 1 )
3.0  ×   10– 3 
3.0  ×   10– 3 
k l   (N⋅ m– 1 )
4.5  ×   10– 2 
4.2  ×   10– 2 
k φ   (N⋅ m⋅ rad– 1 )
1.5  ×   10– 8 
0.8  ×   10– 8 

129
Micromachined Inductive Contactless Suspension
	
5.	 C Shearwood and RB Yates, Development of an electromagnetic microgenera-
tor, Electronics Letters , vol. 33, no. 22, pp. 1883– 1884, 1997.
	
6.	 H Fujita, Microactuators and micromachines, Proceedings of the IEEE , vol. 86, no. 
8, pp. 1721– 1732, 1998.
	
7.	 RP Feynman, There’ s plenty of room at the bottom, Engineering and Science , vol. 
23, no. 5, pp. 22– 36, 1960.
	
8.	 EH Brandt, Levitation in physics, Science , vol. 243, no. 4889, pp. 349– 355, 1989.
	
9.	 J Jin, T Higuchi, and M Kanemoto, Electrostatic levitator for hard disk media, 
Industrial Electronics, IEEE Transactions on , vol. 42, no. 5, pp. 467– 473, 1995.
	 10.	 JU Jeon and T Higuchi, Electrostatic suspension of dielectrics, Industrial 
Electronics, IEEE Transactions on , vol. 45, no. 6, pp. 938– 946, 1998.
	 11.	 R Toda, N Takeda, T Murakoshi, S Nakamura, and M Esashi, Electrostatically 
levitated spherical 3-axis accelerometer, in Micro Electro Mechanical Systems, 
2002. The Fifteenth IEEE International Conference on . IEEE, 2002, Las Vegas, NV. 
pp. 710– 713.
	 12.	 F Han, B Sun, L Li, and Q Wu, Performance of a sensitive micromachined accel-
erometer with an electrostatically suspended proof mass, IEEE Sensors Journal , 
vol. 15, pp. 209– 217, 2015.
	 13.	 B Damrongsak and M Kraft, A micromachined electrostatically suspended 
gyroscope with digital force feedback, in Sensors , 2005 IEEE . IEEE, 2005, Irvine, 
CA. pp. 401–404.
	 14.	 B Damrongsak, M Kraft, S Rajgopal, and M Mehregany, Design and fabrica-
tion of a micromachined electrostatically suspended gyroscope, Proceedings of 
the Institution of Mechanical Engineers, Part C: Journal of Mechanical Engineering 
Science , vol. 222, no. 1, pp. 53– 63, 2008.
	 15.	 Y Su, Z Xiao, Z Ye, and K Takahata, Micromachined graphite rotor based on dia-
magnetic levitation, Electron Device Letters, IEEE , vol. 36, no. 4, pp. 393– 395, 2015.
	 16.	 T Murakoshi, Y Endo, K Fukatsu, S Nakamura, and M Esashi, Electrostatically 
levitated ring-shaped rotational gyro/accelerometer, Japanese Journal of Applied 
Physics , vol. 42, no. 4B, pp. 2468– 2472, 2003.
	 17.	 S Nakamura, MEMS inertial sensor toward higher accuracy & multi-axis sens-
ing, in Sensors , 2005 IEEE . IEEE, 2005, Irvine, CA, pp. 939–942.
	 18.	 C Ruffert, R Gehrking, B Ponick, and HH Gatzen, Magnetic levitation assisted 
guide for a linear micro-actuator, Magnetics, IEEE Transactions on , vol. 42, no. 11, 
pp. 3785– 3787, 2006.
	 19.	 C Shearwood, KY Ho, CB Williams, and H Gong, Development of a levitated 
micromotor for application as a gyroscope, Sensors and Actuators A-Physical , vol. 
83, no. 1– 3, pp. 85– 92, 2000.
	 20.	 W Zhang, W Chen, X Zhao, X Wu, W Liu, X Huang, and S Shao, The study of an 
electromagnetic levitating micromotor for application in a rotating gyroscope, 
Sensors and Actuators A-Physical , vol. 132, no. 2, pp. 651– 657, 2006.
	 21.	 N-C Tsai, W-M Huan, and C-W Chiang, Magnetic actuator design for single-
axis micro-gyroscopes, Microsystem Technologies , vol. 15, pp. 493– 503, 2009.
	 22.	 I Sari and M Kraft, A micro electrostatic linear accelerator based on electromag-
netic levitation, in Solid-State Sensors, Actuators and Microsystems Conference 
(TRANSDUCERS) , 2011 16th International . IEEE, 2011, Beijing, China, pp. 1729– 1732.
	 23.	 I Sari and M Kraft, A MEMS linear accelerator for levitated micro-objects, 
Sensors and Actuators A-Physical , vol. 222, pp. 15– 23, 2015.

130
Magnetic Sensors and Devices
	 24.	 C Shearwood, CB Williams, PH Mellor, RB Yates, MRJ Gibbs, and AD 
Mattingley, Levitation of a micromachined rotor for application in a rotating 
gyroscope, Electronics Letters , vol. 31, no. 21, pp. 1845– 1846, 1995.
	 25.	 V Badilita, S Rzesnik, K Kratt, and U Wallrabe, Characterization of the 2nd genera-
tion magnetic microbearing with integrated stabilization for frictionless devices, 
in Solid-State Sensors, Actuators and Microsystems Conference (TRANSDUCERS) , 
2011 16th International. 2011 , Beijing, China, pp. 1456– 1459, IEEE.
	 26.	 D Garmire, H Choo, R Kant, S Govindjee, CH Sequin, RS Muller, and J Demmel, 
Diamagnetically levitated mems accelerometers, in Solid-State Sensors, Actuators 
and Microsystems Conference, 2007. TRANSDUCERS 2007. International . IEEE, 
2007, Lyon, France, pp. 1203– 1206.
	 27.	 W Liu, W-Y Chen, W-P Zhang, X-G Huang, and Z-R Zhang, Variablecapacitance 
micromotor with levitated diamagnetic rotor, Electronics Letters , vol. 44, no. 11, 
pp. 681– 683, 2008.
	 28.	 Y-K Kim, M Katsurai, and H Fujita, A superconducting actuator using the 
meissner effect, Sensors and Actuators , vol. 20, no. 1, pp. 33– 40, 1989.
	 29.	 TA Coombs, I Samad, D Ruiz-Alonso, and K Tadinada, Superconducting 
micro-bearings, Applied Superconductivity, IEEE Transactions on , vol. 15, no. 2, 
pp. 2312– 2315, 2005.
	 30.	 K Liu, W Zhang, W Liu, W Chen, K Li, F Cui, and S Li, An innovative micro-dia-
magnetic levitation system with coils applied in micro-gyroscope, Microsystem 
Technologies , vol. 16, no. 3, pp. 431– 439, 2010.
	 31.	 K Poletkin, Z Lu, U Wallrabe, and V Badilita, JMEMS Letters A new hybrid 
micromachined contactless suspension with linear and angular positioning 
and adjustable dynamics, Journal of Microelectromechanical Systems , vol. 24, no. 5, 
pp. 1248–1250,  2015.
	 32.	 O Cugat, J Delamare, and G Reyne, Magnetic microactuators and systems 
(magmas), Magnetics , IEEE Transactions on , vol. 39, no. 6, pp. 3607– 3612, 2003.
	 33.	 KV Poletkin, AI Chernomorsky, and C Shearwood, A proposal for microma-
chined accelerometer, base on a contactless suspension with zero spring con-
stant, IEEE Sensors Journal , vol. 12, no. 07, pp. 2407– 2413, 2012.
	 34.	 CB Williams, C Shearwood, and PH Mellor, Modeling and testing of a friction-
less levitated micromotor, Sensors and Actuators A-Physical , vol. 61, pp. 469– 473, 
1997.
	 35.	 K Kratt, V Badilita, T Burger, JG Korvink, and U Wallrabe, A fully MEMS-
compatible process for 3D high aspect ratio micro coils obtained with an 
automatic wire bonder, Journal of Micromechanics and Microengineering , vol. 20, 
pp. 015021, 2010.
	 36.	 Z Lu, K Poletkin, U Wallrabe, and V Badilita, Performance characterization of 
micromachined inductive suspensions based on 3D wirebonded microcoils, 
Micromachines , vol. 5, no. 4, pp. 1469– 1484, 2014.
	 37.	 K Poletkin, A Chernomorsky, C Shearwood, and U Wallrabe, A qualitative 
analysis of designs of micromachined electromagnetic inductive contactless 
suspension, International Journal of Mechanical Sciences , vol. 82, pp. 110– 121, 2014.
	 38.	 Z Lu, K Poletkin, B den Hartogh, U Wallrabe, and V Badilita, 3D micro-
machined inductive contactless suspension: Testing and modeling, Sensors and 
Actuators A Physical , vol. 220, pp. 134– 143, 2014.

131
Micromachined Inductive Contactless Suspension
	 39.	 K Poletkin, AI Chernomorsky, C Shearwood, and U Wallrabe, An analytical 
model of micromachined electromagnetic inductive contactless suspension, in 
The ASME 2013 International Mechanical Engineering Congress & Exposition , San 
Diego, CA, 2013, pp. V010T11A072– V010T11A072, ASME.
	 40.	 V Badilita, M Pauls, K Kratt, and U Wallrabe, Contactless magnetic micro-bear-
ing based on 3D solenoidal micro-coils for advanced powerMEMS components, 
in Proceedings of PowerMEMS  2009, 2009, pp. 87– 90.
	 41.	 FW Grover, Inductance Calculations: Working Formulas and Tables . Chicago, IL: 
Dover, 2004.
	 42.	 Z Lu, F Jia, JG Korvink, U Wallrabe, and V Badilita, Design optimization of an 
electromagnetic microlevitation system based on copper wirebonded coils, in 
2012  Power MEMS  Proceedings of PowerMEMS , Atlanta, GA, 2012, pp. 363– 366.
	 43.	 KV, Poletkin A novel hybrid contactless suspension with adjustable spring 
constant, in Solid-State Sensors, Actuators and Microsystems Conference 
(TRANSDUCERS), 2017 19th International. IEEE, 2017 , Taiwan. (In press).
	 44.	 KV, Poletkin, Z, Lu, U Wallrabe, J Korvink, and V Badilita, A qualitative tech-
nique to study stability and dynamics of micro-machined inductive contact-
less suspensions, in Solid-State Sensors, Actuators and Microsystems Conference 
(TRANSDUCERS), 2017 19th International . IEEE, 2017 , Taiwan. (in press).
	 45.	 KV Poletkin, Z Lu, A Moazenzadeh, SG Mariappan, J Korvink, U Wallrabe, 
and V Badilita, Polymer magnetic composite core boosts performance of 3-D 
micromachined inductive contactless suspension. IEEE Magnetics Letters . vol. 7, 
pp. 1–3 2016.


133
5
Application of Magnetic Sensors for 
Ecological Monitoring of Stationary 
Ferromagnetic Masses from On 
Board Mobile Platforms
Alexander I. Chernomorsky, Vyacheslav E. 
Plekhanov, and Vladimir N. Maximov
CONTENTS
5.1	
Introduction.................................................................................................134
5.2	
Monitoring Local Stationary Ferromagnetic Masses from On 
Board the AUV............................................................................................135
5.2.1	 Particularities of Monitoring Local Stationary 
Ferromagnetic Masses from On Board Mobile Platforms�������135
5.2.2	 Estimation of Magnetic Conditions On Board the AUV...........135
5.2.3	 Analysis of FM Magnetic Field and Estimation of Distance 
to Area of FM Location�����������������������������������������������������������������137
5.2.4	 Overview of Typical MS Magnetometers.................................... 139
5.3	
Calibration of Vector Magnetic Sensors: Magnetometers..................... 140
5.3.1	 First Method for VMS Calibration................................................ 142
5.3.2	 Second Method for VMS Calibration........................................... 144
5.3.2.1	 Algorithm for Parameters Estimation of 
Background Magnetic Field Model������������������������������144
5.3.2.2	Optimization Algorithm for Changing AUV Angular 
Orientation on Trajectory of Its Motion��������������������������������������145
5.4	
Determining Location of FM Relative to Mobile Platform and Its 
Transportation to Area of FMs Location................................................. 151
5.4.1	 Determining Location of FM........................................................ 151
5.4.2	 Algorithms for Determining FM Location Relative to AUV....153
5.4.3	 Transportation of MP to the Area of FM Location....................156
5.5	
Electromagnetic System for Positioning and Azimuth Angular 
Orientation of Ground Mobile Platform..................................................156
5.5.1	 EONS Configuration...................................................................... 157
5.5.2	 Orientation and Positioning by Means of EONS....................... 160
References ............................................................................................................. 162

134
Magnetic Sensors and Devices
ABSTRACT   In this chapter, the application of magnetic sensors (MS), in 
particular vector magnetic sensors (VMSs), for solving problems related to 
the ecological monitoring of local stationary ferromagnetic masses (FMs; 
e.g., sunken watercrafts and underwater structures) on board autonomous 
robotic mobile platforms (MPs) is discussed. An autonomous underwater 
vehicle—robots (AUV) [ 1,2 ] and a ground uniaxial wheel transport plat-
form (UWTP) [ 3,4 ] are considered as such MPs. As a rule, the monitoring 
of FMs aboard these MPs is reduced to the following procedure. First, the 
coordinates of an FM relative to the MP are determined. Second, the MP is 
transported to the location of the FM. Obviously, in order to perform this 
monitoring, inertial information on the MP is essential for its navigation and 
orientation. 
5.1  Introduction
In Section  5.2, the local stationary monitoring of ferromagnetic masses  (FMs), 
in particular by means of a vector magnetic sensor  (VMS) mounted on the 
autonomous underwater vehicle—robots  (AUV), is studied. An estimation of the 
magnetic conditions on board the AUV is given. Also in this section, the 
characteristic of a magnetic field induced by FMs is analyzed. Based on the 
results of the analysis, the distance to the area of the FM’s location is esti-
mated. In addition, a review of existing magnetic sensors  (MS) magnetometers 
is presented.
In Section  5.3, the calibration methods of the VMS on board a stationary 
and moving AUV are described. The proposed methods provide the pos-
sibility for compensation of magnetic disturbances due to magnetic field 
sources on board the mobile platform (MP). In particular, an algorithm that 
optimizes the profile of changing the AUV angular orientation on a trajec-
tory of its motion is proposed. The proposed algorithm is used to maximize 
the accuracy of determination of the parameters of the model describing the 
induction vector of the background magnetic field.
In Section  5.4, a determination of FM coordinates relative to an MP (AUV) 
by means of VMSs mounted onboard the MP is studied. It is important to 
note that the well-known method for solving this problem based on employ-
ing a magnetic field sensor and a magnetic gradiometer has the difficulty of 
implementing its hardware on board the MP. Because of this, it is proposed 
to use only one VMS to perform the measurements of the gradient of a mag-
netic field and its induction with further determining coordinates of an FM. 
Moreover, the gradient of a magnetic field induced by an FM is calculated by 
measuring the increment of the vector of magnetic induction upon moving 
the MP along a known trajectory, the parameters of which are defined by the 
MP navigation system. In order to transport the MP to the area where the 

135
Application of Magnetic Sensors
FM is located, guidance of the MP is realized by utilizing the information 
received on the MP trajectory about the gradient vector of the module of the 
FM magnetic field.
In Section  5.54, the operational principle and the results of the development 
of algorithms for measuring the electromagnetic orientation and navigation 
system (EONS) of the MP, such as a UWTP, which is used for monitoring 
FMs located on local land surfaces, are discussed. As an MS, UWTP uses the 
inductive MS.
5.2  Monitoring Local Stationary Ferromagnetic 
Masses from On Board the AUV
In this section, the magnetic conditions on board the AUV are considered. 
The characteristics of a magnetic field induced by an FM are analyzed. Also, 
an estimation of the distance to the area of the FM location is given. In addi-
tion, a review of MS, which are suitable for monitoring FMs, is provided.
5.2.1  Particularities of Monitoring Local Stationary Ferromagnetic 
Masses from On Board Mobile Platforms
As a rule, the application of MS for monitoring a local FM is accompanied 
by a high level of magnetic disturbance compared with the small values of a 
magnetic field induced by an FM located an acceptable distance for its detec-
tion. Magnetic disturbance is due to the background magnetic field of the 
MP, which is the sum of the permanent magnetic field of the MP itself and 
the magnetic field of inductively magnetized ferromagnetic elements of the 
MP design, as well as the Earth’ s magnetic field (EMF).
Thus, upon monitoring local FMs, initially, the background magnetic field 
should be restored (determined) on board the MP. Then, the induction of a 
magnetic field generated by FMs on a trajectory of the MP motion can be 
defined as the difference between the current measurement vector of mag-
netic field induction and the restored vector of the background magnetic 
field. To restore a vector of the background magnetic field on board the MP, 
information about the current linear coordinates and angular orientation of 
the VMS mounted on the MP is necessary.
5.2.2  Estimation of Magnetic Conditions On Board the AUV
The background magnetic field in the monitoring area can be represented as 
the sum of its stationary and transient components. The stationary compo-
nent can be identified during the calibration of a VMS, while the transient 
component defines the overall error of monitoring. In its turn, the stationary 

136
Magnetic Sensors and Devices
component of the EMF is the sum of its normal and anomalous fields. The 
normal field is defined by the global structure of the EMF and is changed 
within a range of 30– 60  µ T. The intensity of the anomalous field of the EMF 
and its distribution in space are dependent on its magnetic properties, geo-
logical structure, and the depth of occurrence of non-magnetic rocks of the 
Earth’ s crust. The value of the anomalous part of the EMF can be up to 1  µ T.
As previously mentioned, the other source of a stationary magnetic field 
is the AUV itself, namely, the permanent and inductively magnetized fer-
romagnetic elements of its design, as well as the electrical loads. Permanent 
magnetization of elements of the AUV design occurs during the fabrication 
of these elements and their exploitation. It depends essentially on the various 
mechanical and thermal treatments of these elements. In general, inductive 
magnetization of ferromagnetic elements of the AUV design is dependent on 
their magnetic permeability, geometrical shape, and orientation in the exter-
nal magnetic field. The magnetic permeability, in turn, as well as the residual 
magnetization, is dependent on the chemical composition and processing 
technology of the design elements. Usually, structural steels have small val-
ues of magnetic permeability. This explains the fact that a magnetic field of 
inductive magnetization is much weaker than one of permanent magnetiza-
tion of elements of the AUV design. Also note that magnetic fields generated 
by inductively magnetized elements of an MP design are hardly changed 
with mechanical and thermal influences. Typical levels of stationary mag-
netic fields generated by various sources, which have been previously dis-
cussed, are depicted in Figure 5.1
1: normal EMF; 2: EMF anomaly; 3: permanent platform 
magnetic ﬁeld; 4: platform inductive magnetic ﬁeld;  
5: magnetometer noise 
Magnetic induction (µT)
60
50
40
30
20
10
0
1
2
1
10
50
6
4.00E-03
3
4
5
FIGURE  5.1 
Typical levels of stationary magnetic fields on board an AUV.

137
Application of Magnetic Sensors
Transient magnetic fields on board the AUV can be viewed mainly as the 
sum of the transient magnetic fields of the EMF and the AUV. A transient 
magnetic field of the EMF includes secular EMF variations (0.02  µ T), solar 
and lunar daily EMF variations (0.02  µ T), and variations generated by mag-
netic storms (0.1  µ T). The AUV’ s own magnetic fields make the main contri-
bution to the transient fields. Indeed, the transient magnetic field of the AUV 
is determined by the transient magnetic fields of inductively magnetized fer-
romagnetic elements of the AUV, the transient magnetic fields of electrical 
loads, as well as the moving magnetic elements of the AUV.
Transient inductive magnetization is mostly defined by the transient mag-
netic field of the EMF. In a general case, transient magnetic fields are defined 
by electrical loads. In turn, transient processes in electrical loads are depen-
dent on the area of electric circuits occupied by electrical loads and the loca-
tion of these electric circuits relative to the MS. The largest value of magnetic 
disturbance created by the electric circuits is due to single-wire electric sys-
tems, where the housing of the AUV is used as an electric conductor. In this 
case, the area of the electric circuits becomes significant. The induction of the 
single-wire electric system is decreased inversely proportional to the first 
power of the distance from an electric source. Also, a significant disturbance 
can be created by microchips located near the MS.
5.2.3  Analysis of FM Magnetic Field and Estimation 
of Distance to Area of FM Location
It is assumed that an FM has the residual magnetization, В res , and a signifi-
cant value of the relative magnetic permeability µ  (order of 10 and larger). 
Some typical parameters of monitoring FMs (sunken watercrafts, underwa-
ter structures, etc.) such as their dimensions, В res  and µ , as well as relation-
ships that allow to estimate the value of an FM magnetic field depending on 
the distance to the FM are shown in Table  5.1. The dependences of magnetic 
fields induced by FMs with residual and inductive magnetizations on the 
distance to these FMs are shown in Figures  5.2 and 5.3 for В res   =  0.5 and 10  µ T, 
respectively. Also, these figures depict the average values of the transient 
background magnetic field (0.2  µ T) and the noise of the VMS (4*10− 4   µ T). The 
distance to the area of FM location is estimated by points of crossing the 
dependence of magnetic field induction with straight lines corresponding 
to the values of a transient background magnetic field and the noise of the 
VMS, as shown in Figures  5.2 and 5.3. Hence, from the analysis of Table  5.1 
and Figures  5.2 and 5.3, we can conclude that for a typical value of a tran-
sient background magnetic field of 0.2  µ T, the possible distance to the area 
of FM location lies in the range from 100 to 150  m. At the same time, it is 
assumed that a stationary magnetic disturbance due to inductively magne-
tized elements of the AUV design can be identified and eliminated during 
the calibration of the VMS on board the AUV. This becomes possible due to 
the stability of the model parameters of this disturbance.

138
Magnetic Sensors and Devices
TABLE  5.1
Relationships for Estimating FM Monitoring Range
FM Magnetic Moment Estimation 
Estimation of FM Magnetic Field ( B  ) 
from Distance ( R  ) 
Moment М p  
from 
permanent 
magnetization 
of FM
Moment М i  from inductive 
magnetization of FM
B  =  M/R3 
R  >   l
B  =  M/l R2 
R  <   l
М p   =  В res   V
М i   =  В n V(m  −   1)/(m  +  2)
В res   =  10  μ T—
residual 
induction of the 
material;
V  =  7854  m3 —
FM volume
В n   =  50 μ T—normal EMF;
m  =  10—relative magnetic 
permeability of FM 
material
l   =  100  m− length of the 
cylindrical FM, D  =  10  m—
FM diameter
D
l
2E–1 µT—transient
background ﬁeld
1.00E+01
1.00E+00
1.00E–01
1.00E–02
1.00E–03
1.00E–04
1.00E–0550
100
200
Distance to the FM (m)
99
270
500
1000
4E–3 µT—MS noise
Magnetic induction (µT)
FIGURE  5.2 
FM monitoring range and permanent magnetization (В res   =  0.5  µ T).

139
Application of Magnetic Sensors
5.2.4  Overview of Typical MS Magnetometers
Upon choosing the VMS for monitoring FMs, it should be taken into account 
that the entire level of the transient background magnetic field can be up to 
0.3  µ T, while the total induction of the magnetic field can be up to 100  µ T. Key 
types of MS magnetometers and their characteristics are shown in Table  5.2.
An analysis of Table  5.2 shows that is advisable to use magnetoresis-
tive MS (fabricated by Honeywell) for monitoring FMs from on board the 
AUV. The operating principle of this type of MS is based on changing the 
electrical resistance of the ferromagnetic material (magnetoresistor, e.g., 
permalloy—80% Ni and 20% Fe) subjected to the magnetic field. The sen-
sitivity of magnetoresistive MS to the magnetic field is also dependent on 
the value of the induction of the magnetic field being measured and on the 
angle between the vector of induction and the direction of the current flow-
ing through the ferromagnetic material. The sensor provides the calibration 
2E–1 µT—transient
background ﬁeld
1.00E+01
1.00E+00
1.00E–01
1.00E–02
1.00E–03
1.00E–0450
100
200
Distance to the FM (m)
143
419
500
1000
4E–3 µT—MS noise
Magnetic induction (µT)
FIGURE   5.3 
FM monitoring range and inductive magnetization (В res   =  10  µ T).
TABLE  5.2 
MS Types and Their Typical Parameters
Sensor Type 
Parameter 
Hall 
Sensors 
Inductive 
Sensors 
Fluxgate 
Sensors 
Protonic 
Sensors 
Magnetoresistive 
Sensors 
Measurement 
range (mT)
From 01 
to 3*104 
From 10− 10  
to 106 
From 10− 4  
to 1
From 0.02 
to 0.1
From 10− 3  to 5
Frequency 
range (Hz)
Up to 10
From 0.1 
to 106 
Up to 2000
Up to 2
Up to 107 
Resolution 
(μ Т )
0.1
10− 3 
From 10− 3  
to 10− 6 
From 10− 4  
to 10– 5 
10− 2 
Magnetometer 
type
Vectorial
Vectorial
Vectorial
Scalar
Vectorial
Temperature 
range (° С )
From − 10 
to +40
From − 4 
to +40
From − 25 
to +55
From − 20 
to +50
From − 55 to +150

140
Magnetic Sensors and Devices
mode and compensation for the background magnetic disturbance. In using 
microtechnology, magnetoresistive MS has a small size and a relatively low 
cost. Since the MS has only one measuring axis, three sensors are required 
for measuring the vector of magnetic induction.
Employing an MP, such as a UWTP, for monitoring FMs located on local 
land surfaces, the inductive MS is used. Because this MS works effectively as 
a low-frequency electromagnetic field receiver, it is used in an EONS, as will 
be discussed later. Mounted in the UWTP, the inductive MS is involved in 
determining the relevant kinematic motion parameters of this MP.
5.3  Calibration of Vector Magnetic Sensors: Magnetometers
As mentioned in Section  5.2, for monitoring an FM from on board an MP, 
the background magnetic field on board the MP should be restored. For this 
purpose, the deviation coefficients of the magnetic field model created by 
inductively magnetized ferromagnetic elements of the MP (so-called soft 
iron distortion) are defined. Then, the magnetic field created by the perma-
nent magnetization of MP elements (so-called hard iron distortion) and the 
EMF are also defined.
For further analysis, let us introduce the coordinate frame (CF) fixed to 
the AUV denoted as OX  cY  cZ  c and the CF for inertial orientation denoted as 
OXYZ  . Noting that the OX and OY axes are lying on the horizontal plane, 
the position of the OX  cY  cZ  c CF with respect to OXYZ   is shown in Figure  5.4. 
The measuring axis of each VMS is directed along one axis of OX  cY  cZ  c 
CF. The axes of OXYZ   CF are modeled by a strapdown inertial orientation 
Z
Y
X
Zc
Yc
Xc
γ
γ
ψ
ψ
ϑ
ϑ
ϑ
γ
ψ
FIGURE   5.4
Coordinate systems.

141
Application of Magnetic Sensors
system (IOS). The angles corresponding to yaw, pitch, and roll are denoted 
as ψ , ϑ, γ , respectively.
A model of a magnetic field vector measured by VMSs related to the 
OX  cY  cZ  c CF can be represented as
	
Tm
A C
T
T
A
C
T
T
w
FM
FM
=
×
×
+
+
×
×
+
+
0
, 	
(5.1)
where
	
A =










a
a
a
a
a
a
a
a
a
xx
xy
xz
yx
yy
yz
zx
zy
zz
	
(5.2)
is the deviation coefficients of the Poisson matrix determining the deforma-
tion of the EMF in the MP volume due to “ soft iron distortion”  [5,6];
C =
−
−
cos
cos
sin
cos
sin
sin
sin
cos sin
cos
cos cos
sin
co
ϑ
ψ
ϑ
ϑ
ψ
γ
ψ
γ
ϑ
ψ
γ
ϑ
γ
s
cos sin
sin
cos sin
sin
sin
cos
sin
cos
cos cos
sin
ψ
γ
ϑ
ψ
γ
ψ
γ
ϑ
ψ
γ
ϑ
γ
ψ
+
+
−
−
γ
ϑ
ψ
sin
sin










	 (5.3)
is the orientation matrix relative to the OXYZ   CF [7,8];
	
T = 

TxTyTz
T 	
(5.4)
is the EMF vector related to the OXYZ   CF;
	
T0
0
0
0
= 

T T T
x
y
z
T 	
(5.5)
where w noise vector is the vector of the MP’ s own permanent magnetic field 
related to the OX  cY  cZ  c CF;
A FM   is the deviation coefficients matrix determining the deformation EMF 
in the FM volume; T FM   is the vector of the permanent magnetic field of the 
FM; C FM   is the orientation matrix of the FM relative to the OXYZ   CF; w  is 
the vector of noise.
In the absence of an FM, the model of the background magnetic field is 
rewritten as follows:
	
T
A C
T
T
w.
m =
×
×
+
+
0
	
(5.6)
In order to restore this magnetic field, matrix A  and vectors T 0   and T  
should be estimated. The estimation procedure for A   , T   0  , T    is called the 
calibration of the VMS on board the MP.

142
Magnetic Sensors and Devices
Let us consider two methods for the calibration of a VMS. The first method 
is based on the assumption that A   , T   0  , T    are unchanged during monitor-
ing. Hence, the first method of the calibration is performed onboard the MP 
before the monitoring starts. The second method is performed during the 
monitoring process, when A   , T   0  , T    are assumed to be changing. Next, two 
common approaches to the implementation of these methods for VMS cali-
bration are considered.
5.3.1  First Method for VMS Calibration
This method is based on the fact that the rotational motion of an MP (AUV) 
creates a modulation of the projections of the EMF on the axes of OX  с Y  с Z  с  
CF [9,10] (Figure  5.5).
It is assumed that the vector Т  is normalized; in other words, that the mea-
surements of T  using the model (Equation  5.6) are normalized relative to the 
EMF. The rotation of the AUV is carried out in such a way as to provide dif-
ferent orientations of vector Т  in the OX  с Y  с Z  с  CS. Rotating a VMS mounted 
in an AUV, the end point of vector Т   describes a smooth ellipsoidal surface 
in the OX  с Y  с Z  с  CS, as shown in Figure  5.6.
In the case of an ideal AUV and VMS (А   is the identity matrix, Т  0   is the null 
vector), this surface becomes a sphere centered at the origin of the related CS. 
The presence of the AUV’ s own permanent field, Т  0   leads to the displace-
ment of the sphere center from the origin of OX  с Y  с Z  с  CS. The presence of 
soft iron distortion in the AUV and cross-links between the measuring chan-
nels of VMSs lead to the deformation of the sphere (due to the difference of 
matrix А   from an identity matrix).
Upon rotating the AUV, according to Equation  5.6 the normalized VMS 
output signal Т  m  /|Т  | is described by the following relationship:
	
T
T
A
C
T
T
T
T
w
T
m
0
=
×
×
+
+
. 	
(5.7)
Z
X
Y
T
T0
AU
VM
γ
ψ
ϑ
FIGURE   5.5 
AUV and VMS in EMF prior to the monitoring process.

143
Application of Magnetic Sensors
Now the VMS calibration is reduced to obtaining the best estimations 
for components of the A  matrix and the T  vector, providing the solution 
to Equation  5.7 for the vector Т  m /|Т  |. For these estimations, the nonlinear 
least squares method [11,12] can be used and the following residuals are 
minimized:
	
∆=
−
(
)
=∑
i
N
i
1
2
1
R
; 	
(5.8)
	
R
A
T
T
T
T
m
i
i
=





−






−
ˆ
ˆ
1
0
,
where:
R i		
is the radius vector of a point on the surface of the sphere correspond-
ing to the i th measurement of VMSs of the induction of a magnetic 
field
i 	 =	 1, 2, 3, … , N  is the sequence number of the VMS measurement when 
changing its orientation
Â	 	
is the matrix A  estimation
ˆT0 		
is the vector T 0   estimation
The feature of this VMS calibration is the simplicity of its technical imple-
mentation. This is because this VMS calibration is performed autonomously 
and doesn’ t require information about the AUV orientation.
1.5
1
0.5
0
–0.5
–1
–1.5
1.5
1
0.5
0
–0.5
–1
–1.5
–1
0
1
Uncalibrated
Calibrated
FIGURE   5.6 
Surfaces described by the endpoint of vector Т ,  upon rotating VMS mounted into an AUV.

144
Magnetic Sensors and Devices
5.3.2  Second Method for VMS Calibration
The core of the calibration restoring the background magnetic field on board 
the AUV in the area of FM monitoring is as follows [13,14]. As in Section  5.3.1, 
model  5.6 is considered the model of a background magnetic field. During 
the FM monitoring process, the magnetic field on board the AUV is mea-
sured by means of a VMS in the CF related to the AUV. At the same time, the 
AUV angular orientation is defined by, for instance, IOS. Based on this infor-
mation, the model parameters are estimated, and the vector of induction of 
the background magnetic field on board the AUV is restored on a trajectory 
of its motion.
The analysis shows that the accuracy of the estimation of the model param-
eters of the background magnetic field is mostly dependent on an algorithm, 
as well as on a profile of changing the AUV angular orientation on its motion 
trajectory.
5.3.2.1  Algorithm for Parameters Estimation of 
Background Magnetic Field Model
Using Equations  5.2 through 5.6, the measurements in each VMS channel 
can be presented in the following form:
=
+
+
+
+
+
+
+
+
+
+
=


+
=
+
T
c
a
T
c
a
T
c
a
T
c
a
T
c
a
T
c
a
T
c
a
T
c
a T
c
a T
T
w
c
c
c
c
c
c
c c
c
T Xx Xx Xx Xx Xx Xx Xx Xx Xx
w
H X
w
1
;
x
mx
xx
x
xx
y
xx
z
xy
x
xy
y
xy
z
xz
x
xz
y
xz
z
ox
x
ox
T
x
x
11
12
13
21
22
23
31
32
33
11
12
13
21
22
23
31
32
33
1
2
3
4
5
6
7
8
9
	(5.9)
=
+
+
+
+
+
+

+
+
+
+
=


+
=
+
T
c
a
T
c
a
T
c
a
T
c
a
T
c
a
T
c
a
T
c
a T
c
a T
c
a T
T
w
c
c
c c
c
c
c
c
c
T Xy Xy Xy Xy Xy Xy Xy Xy Xy
w
H X
w
1
;
y
my
yx
x
yx
y
yx
z
yy
x
yy
y
yy
z
yz
x
yz
y
yz
z
oy
y
oy
T
y
y
11
12
13
21
22
23
31
32
33
11
12
13
21
22
23
31
32
33
1
2
3
4
5
6
7
8
9
	
 
T
c a T
c
a T
c
a T
c
a T
c
a T
c
a T
mz
zx
x
zx
y
zx
z
zy
x
zy
y
zy
z
=
+
+
+
+
+
+
11
12
13
21
22
23
c
a T
c
a T
c
a T
T
w
c c c c c
c
zz
x
zz
y
zz
z
oz
z
31
32
33
11
12
13
21
22
23
1

+
+
+
+
=
c c
c
T Xz Xz Xz Xz Xz Xz Xz Xz Xz
w
H X
w
oz
T
z
z
31
32
33
1
2
3
4
5
6
7
8
9



+
=
+
z,
where:
c ij   (i , j   =  1, 2, 3)	
are the elements of orientation in matrix  5.3
a nm   (n , m   =  x , y , z )	 are the elements of the Poisson matrix  5.2

145
Application of Magnetic Sensors
	
H = 

1
11
12
13
21
22
23
31
32
33
 c c c c c
c
c c
c
; 	
	
Xx = 

T Xx Xx Xx Xx Xx Xx Xx Xx Xx
ox
T
1
2
3
4
5
6
7
8
9
; 	
	
Xy = 

T Xy Xy Xy Xy Xy Xy Xy Xy Xy
oy
T
1
2
3
4
5
6
7
8
9
; 	
(5.10)
	
Xz = 

T Xz Xz Xz Xz Xz Xz Xz Xz Xz
oz
T
1
2
3
4
5
6
7
8
9
; 	
T mx  , T my  , T mz   are the components of the measured vector of induction of the 
magnetic field in relation to CS.
The components of the state vectors X  x  , X  y  , X  z   are the components of the 
product of the matrix A  and the vector of the magnetic field, T   . They are 
subject to the estimation as model parameters of a background magnetic 
field onboard the AUV based on solving Equation  5.9. It is easy to see that 
there are 15 linear equations defining the linear relationships between these 
components. Basically, the 30th order of set Equation  5.9 can be reduced to 
the 15th order. However, the analysis of numerical and experimental results 
shows that from a practical point of view the parameters of Equation  5.10 
based on set Equation  5.9 should be estimated in the presence of the real 
noise w .
In this case, the efficient algorithm is one that is based on the method of 
least squares (MLS) applied to each of the measurement channels individu-
ally and described by the following equation:
	
ˆ
,
, , ,
Xi
H
H
H
T
=
×
(
)
×
×
=
−
T
T
mi
i
x y z
1
	
(5.11)
where ˆXi  is the estimation for the vector of model parameters X  i  , including 
(each channel) the vector projection of induction of the permanent magnetic 
field of AUV, Т   0 , on the respective axes and nine components of the vectors 
X  x, X  y, X  z and EMF projections on the axes of the OXYZ   CS.
It is worth noting that upon employing the set Equation  5.9 instead of 
Equation  5.11 for monitoring an FM from onboard the AUV in real time, the 
quasi-recurrent algorithm of MLS should be used.
5.3.2.2  Optimization Algorithm for Changing AUV Angular 
Orientation on Trajectory of Its Motion
In the framework of the admissible range in the variation of AUV ori-
entation angles (Ψ, ϑ, γ ), the accuracy of the parameters estimation of 
model  5.9 depends essentially on the behavior of the process changing 
these angles with time on a trajectory of the AUV motion. The optimiza-
tion of this process can be solved based on a D-optimal experimental 
design [8].

146
Magnetic Sensors and Devices
Hence, using Equation  5.9, equations for a single channel of VMS are as 
follows:
	
T
w
i
x y z
mi
i
i
=
(
)
+
=
H
X
ψ υ γ
, ,
,
, , .
 
	
(5.12)
Let us introduce the dispersion matrix of errors, D,  for the vector X  i   esti-
mation and the information matrix, M (y ), which are as follows:
	
D
M
M
H
H
1
=
=
( )
( )
( )
( )
−
y
y
y
y
σ2,
,
T
	
(5.13)
where:
	
H
h
h
( )
( )
( )
y
T
T
N
T
= 

1 y
y
…
	
y  	 	
is the vector of the optimization parameters (in our case y  T =[ψ , υ , γ ])
σ 	 	
is the standard deviation of error measurement
In this case, the optimization algorithm building the optimal profile of 
changing orientation angles, y   with time is reduced to minimize the deter-
minant value of the dispersion matrix D  (or to maximize the determinant 
value of the information matrix, M ).
A design set is a collection of three-dimensional space points with the ψ , υ , 
γ  coordinates. Since the most constructive results of the experimental design 
theory were obtained for a one-dimensional collection [15,16], the mapping 
of a 3-D dimension onto 1-D based on the Peano space-filling curves is used 
[17,18]. The continuous design is as follows:
	
ξ = 





≥
=
=∑
y
y
p
p
p
p
n
n
i
i
i
n
1
1
1
0
1
,...,
,...,
,
,
, 	
(5.14)
where:
y i   (i   =  1, … , n )	 is the design points (i.e., changing the angles within a 
range of ± 20°  and with a sampling step of 2° , we have 21 
points for each variable and n   =  213   =  9261 design points in 
total)
p i  	 	
		
is the weight of the design points, proportional to a number 
of measurements at the point of optimal design, y i  
The algorithm for finding the optimal design is built for the functional 
Ф [D  ]  =  ln (det D  ) (generalized D-optimality); it includes the following steps 
(algorithm).
Step 1 . Choose a non-degenerate initial design, ξ s  , type of Equation  5.14 
at step number s   =  0.

147
Application of Magnetic Sensors
Step 2 . Search for a design with unit measure, for the rewritten point y s :
	
y
d y
s
s
=
(
)
(
)
argmax
,
,
ξ
γ 	
where d (y ,ξ s  )  =  h  T  (y )D  (ξ s  )h  (y ).
Step 3 . Define the step length γ s  :
	
γ
ξ
ξ
s
s
s
d y
m
d y
m
=
(
) −


−
(
)


,
,
,
(
)
1
	
where m is the size of M  matrix.
Step 4 . Build the design:
	
ξ
γ
ξ
γ ξ
s
s
s
s
sy
= (
)
+
(
)
1–
	
and then return to Step 2, replacing s  with s   +  1.
The iteration procedure described is completed when an asymptotically 
decreasing increment of the functional Ф [D  ] is reached with an acceptable 
low increment value.
It is worth noting that the step length specified in Step 3 of the algo-
rithm provides a high convergence rate and is obtained from the following 
equation:
	
γ
γ ξ
γξ
γ
s
s
sy
=
−
(
)
+
(
)


( )
argmin D 1
,
	
At the same time, the dispersion matrix on each step is defined as follows:
	
D
E
D
D
ξ
γ
γ
ξ
γ
γ
ξ
ξ
s
m
s
T
s
s
h y h
y
d y
+
(
) =
−
−
( ) ( )
( )
−
+
(
)








( )
1
1
1
1
,
, 	
where E m   is the identity matrix.
To demonstrate the algorithm’ s operability, let us consider an example 
of the program written in the MATLAB environment. The initial distri-
bution of the weights p i   for 9261 design points was chosen either homo-
geneously or by arbitrary sampling followed by normalization. In both 
cases, there was a convergence to a single optimal design. The resulting 
optimal design in the 3-D space of the orientation angles (the limit value 
of AUV orientation angles was set to 20° ) at a sufficient number of itera-
tions equal to 500, comprises 22 points and is shown in Figure  5.7 and 
Table  5.3. The information matrix M  determinant value of the normalized 
optimal design is 9.1074e-19, and the initial (evenly distributed over all 
points) design is 2.7042e-22.

148
Magnetic Sensors and Devices
The points of the optimal design are connected according to their number-
ing in Table  5.3 and as shown in Figure  5.7. The first row of Table  5.3 specifies 
the point number from the general design. The second row specifies the nor-
malized weight of this point of the design. The third, fourth, and fifth rows 
specify the corresponding values of the yaw, pitch, and roll angles, respec-
tively. Guidance on changing the angular orientation of the AUV in time 
can be performed by using the values of the design points from Table  5.3 
(excluding the reorientation costs). An example of the reorientation guidance 
is shown in Figure  5.8. In these figures, the abscissa axis is dimensionless 
time t/T (t is the time spent by the object at the corresponding design point, 
proportional to the weight of this point p, T is the total time of the experi-
ment). If we consider the reorientation costs of the AUV, in particular the 
energy costs, and also the dynamic features of the AUV, then in order to 
build an improved reorientation guidance, it is necessary to solve the prob-
lem of resources optimization. Thus, in order to minimize reorientation 
costs, a route bypassing the points of the obtained optimal design should 
be built. This case is represented by the traveling salesman problem [19,20].
In order to determine the comparative effectiveness of the optimal design 
for the estimation accuracy of the state vector components, a numerical 
experiment was performed. This experiment includes calculating and com-
paring the standard deviations (SD) of estimation errors of the state vector X  
20
15
10
5
0
–5
–10
–15
–20
20
10
0
–10
–20
–20
–15
–10
–5
0
5
10
PsiP (deg)
TetaP (deg)
GammaP (deg)
15
20
FIGURE   5.7 
Dependency of GammaP from PsiP, TetaP.

149
Application of Magnetic Sensors
by MLS in optimal and non-optimal designs. The SD of estimation errors σ i  () 
is defined by the following equation:
	
σ
ξ
ξ
σ
i
i
i
i
2
1
2
1 2
()
,
, ,
=
=
( )
( )




−
H
H
T
	
where:
ξ 1 	 	
is the optimal design of the experiment
ξ 2 	 	
is the experiment design based on the use of standard evolutions of 
AUV (“ snake movement”  for yaw angle, “ climbing movement”  for 
pitch angle, and “ rolling movement”  for roll angle, Figure  5.9)
σ 	 	
is the SD of the measurement errors (0.1  μ Т )
The calculation results are shown in Table  5.4.
An analysis of Table  5.4 shows that the SD for the state vector estimations 
obtained in the optimal experiment design are smaller than the SD of state 
vector estimations obtained in the non-optimal experiment design, ranging 
from 3 to 20 times.
Noting that the analytical solution of a similar problem, for building an 
optimal design for the AUV roll angle, applied to the evaluation of drifts of 
the gyroscopes using IOS was obtained in [21,22]. This analytical solution 
TABLE  5.3 
Optimal Design Distribution over All Points
No.
1
2
3
4
5
6
Weight
0.089092
0.0048485
0.093241
0.049254
0.093971
0.0036797
Ψ  (deg)
− 20
− 4
20
0
− 20
4
υ  (deg)
− 20
− 20
− 20
0
20
20
γ  (deg)
− 20
− 20
− 20
− 20
− 20
− 20
No.
7
8
9
10
11
12
Weight
0.091295
0.0033493
0.0038517
0.002693
0.04865
0.050248
Ψ  (deg)
20
− 20
20
− 20
− 20
20
υ  (deg)
20
− 20
20
− 20
0
0
γ  (deg)
− 20
− 4
− 4
− 2
0
0
No.
13
14
15
16
17
18
Weight
0.0027813
0.00176
0.0040216
0.094233
0.0048343
0.09131
Ψ  (deg)
20
20
− 20
− 20
4
20
υ  (deg)
− 20
− 20
20
− 20
− 20
− 20
γ  (deg)
2
4
4
20
20
20
No.
19
20
21
22
Weight
0.049492
0.090595
0.0039026
0.094668
Ψ  (deg)
0
− 20
− 4
20
υ  (deg)
0
20
20
20
γ  (deg)
20
20
20
20

150
Magnetic Sensors and Devices
20
15
10
5
0
–5
–10
–15
–20
0
0.1
0.2
0.3
0.4
0.5
Relative time t/T
(a)
(b)
(c)
Psi angle (deg)
0.6
0.7
0.8
0.9
1
20
15
10
5
0
–5
–10
–15
–20
0
0.1
0.2
0.3
0.4
0.5
Relative time t/T
Psi angle (deg)
0.6
0.7
0.8
0.9
1
20
15
10
5
0
–5
–10
–15
–200
0.1
0.2
0.3
0.4
0.5
Relative time t/T
Psi angle (deg)
0.6
0.7
0.8
0.9
1
FIGURE   5.8 
(a) Heading angle optimal design and time. (b) Pitch angle optimal design and time. (c) Roll 
angle optimal design and time.

151
Application of Magnetic Sensors
provides the same results as the results obtained in the developed algorithm 
for the 1-D case of the roll angle.
The obtained results substantiate the possibility of optimizing the process 
of determining the induction vector of the background magnetic field on 
board the AUV by directional variation of its angular orientation on a trajec-
tory of its motion.
5.4  Determining Location of FM Relative to Mobile Platform 
and Its Transportation to Area of FMs Location
5.4.1  Determining Location of FM
Let us assume that the distance to the area of the FM location is sufficiently 
large. Then, the magnetic field induced by the FM can be adequately modeled 
Heading angle proﬁle 
Relative time t/T
Pitch angle proﬁle
Roll angle proﬁle
(deg) 
20
10
0
–10
–200
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Relative time t/T
(deg)
20
10
0
–10
–20
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Relative time t/T
(deg)
0
–5
–10
–15
–20
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
FIGURE   5.9 
Attitude angles profile: Standard approach.

152
Magnetic Sensors and Devices
TABLE  5.4 
SD of State Vector’ s X  Estimation Errors
σ ( X  1  ), µ Т  
σ ( X  2  ), µ Т  
σ ( X  3  ), µ Т  
σ ( X  4  ), µ Т  
σ ( X  5  ), µ Т  
σ ( X  6  ), µ Т  
σ ( X  7  ), µ Т  
σ ( X  8  ), µ Т  
σ ( X  9  ), µ Т  
σ ( X  10  ), µ Т  
Design ξ 1 
0.0274
0.0399
0.0097
0.0114
0.0103
0.0399
0.0108
0.0108
0.0114
0.0290
Design ξ 2 
0.4685
0.3935
0.2131
0.0582
0.1091
0.4648
0.1167
0.0380
0.1255
0.4036

153
Application of Magnetic Sensors
by the field of magnetic dipole. Hence, the objective is to identify components 
of the radius vector defined in OXYZ   CS from the FM dipole center to the 
AUV one. In other words, the problem is reduced to determining the location 
of the FM relative to the AUV. It is called the inverse dipole localization problem . 
In the known methods of its solution, measured values of the vector of mag-
netic induction induced by the FM, and the absolute value of its magnetic 
induction, and their gradients are used as the original information [23,24]. 
Thus, to achieve the desired result on board the AUV, a magnetometer and a 
magnetic gradiometer are required. Building a magnetic gradiometer based 
on combining data from several magnetometers on board the AUV is a dif-
ficult technical problem. The main difficulties are as follows:
	
1.	The design of an AUV does not allow setting an extended and sta-
ble base between the magnetometer and the gradiometer due to 
the small size of the AUV, the high “ packing”  density of its units 
and systems, and the stiffness of the AUV design, which is not high 
enough.
	
2.	Hence, a short base is used. As a result, for realizing a gradiom-
eter on short base magnetometers with a high sensitivity, a large 
dynamic range, a high linearity, and stability of its characteristics 
are required. Such magnetometers have a high cost, large size, and 
low resistance to perturbing operational factors.
	
3.	The identity of the characteristics of the magnetometers under a high 
level of magnetic disturbance generated by equipment mounted in 
the AUV needs to be obtained.
	
4.	The calibration during the FM monitoring process significantly 
increases the difficulty of compensating for magnetic disturbance 
due to the magnetic gradients of the AUV’ s own field. Intensive fil-
tering of this magnetic disturbance is required (at the level of 120  dB).
Due to the foregoing difficulties, using one VMS to measure the magnetic 
gradient is the effective approach to solving the problem of determining the 
FM location relative to the AUV. The gradient is calculated by measuring the 
increment of the vector of the magnetic induction upon moving the AUV 
along the known trajectory. The parameters of this known trajectory are 
defined by an onboard navigation system, for instance, a strapdown inertial 
navigation system (INS) [7,8].
5.4.2  Algorithms for Determining FM Location Relative to AUV
The vector of the dipole magnetic induction is defined as follows [23,24]:
	
B
M R
R
M
=
⋅
(
)⋅
−




µ
π
0
5
3
4
3
R
R
, 	
(5.15)

154
Magnetic Sensors and Devices
where:
μ 0 		
is the magnetic constant
R 	 	
is the radius vector from the dipole center to the observation point
M 		
is the vector of the magnetic dipole moment
The gradient of the magnetic field vector is a second-order tensor:
	
D =
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂
∂


B
R
B
R
B
R
B
R
B
R
B
R
B
R
B
R
B
R
x
x
x
y
x
x
y
x
y
y
y
z
z
x
z
y
z
z


















, 	
(5.16)
where x ,y ,z  are the indexes indicating the projections of the vector on the 
axes of OXYZ   CS, respectively.
There are several methods for solving the inverse dipole localization 
problem.
Method 1:
	
D R
B
R
D B
1
×
= −
= −
−
3
3
;
,
	
(5.17)
Method 2:
	
R
D
I B
= −
+
(
)⋅
3
2
3
1
λ λ
λ
, 	
(5.18)
Method 3:
	
R
D
= −
⋅∇
−
3
2B
B, 	
(5.19)
Method 4:
	
R
B
=
⋅∇+
(
)
3
2
3
1
λ λ
λ
B
B
, 	
(5.20)
where:
λ 1 , λ 2 , λ 3	
are the eigenvalues of the characteristic equation of tensor D  
I  	
	
is the identity matrix

155
Application of Magnetic Sensors
	
B
c
R
M
R
B
B
x
B
y
B
z
G
G
G
G
c
x
y
z
x
= ⋅
⋅(
) +
∇
= ∂
∂
+ ∂
∂
+ ∂
∂
=
=
+
+
=
⋅
3
2
8
2
6
2
MR
i
j
k
G
i
j
k
6
24
6
2
6
2
2
2
2
10
2
⋅
⋅(
)⋅
−
⋅
⋅(
) −⋅
⋅
⋅
(
)
⋅
⋅
=
⋅
⋅
⋅
M
R
R
M
R
R
B R
G
c
M
x
x
x
y
y
MR
MR
MR
(
)⋅
−
⋅
⋅(
) −⋅
⋅
⋅
(
)
⋅
⋅
=
⋅
⋅
⋅(
)⋅
−
R
R
M
R
R
B R
G
c
M
R
y
y
z
z
2
2
2
2
10
2
2
24
6
2
6
2
MR
MR
4
6
2
2
2
2
10
⋅
⋅(
) −⋅
⋅
⋅
(
)
⋅
⋅
R
M
R
R
B R
z
z
MR
	
(5.21)
B 	
is the magnitude of the vector of magnetic field induction
∇B	
is the gradient of the magnitude of the magnetic field induction
	
c = µ
π
0
4
Thus, in the framework of the foregoing methods, solving the inverse 
dipole localization problem based on using one VMS can be reduced to the 
following algorithm [25,26]:
	
1.	Magnetic induction is measured at two different points on a trajec-
tory of the AUV motion. Also, the coordinates of these points are 
determined by a strapdown INS.
	
2.	The increments for each component of the magnetic induction vec-
tor and coordinates are calculated.
	
3.	Using these increments, partial derivatives from Equations  5.16 
through 5.21 are calculated. At the same time, it is assumed that the 
gradient of the magnetic field between the points, in which the mea-
surements occur, is constant.
	
4.	Employing one from the following Equations  5.17 through 5.20, 
the position of the dipole relative to the AUV (components of the 
radius vector R  from the FM dipole center to the AUV one) is 
calculated.

156
Magnetic Sensors and Devices
5.4.3  Transportation of MP to the Area of FM Location
In a general case, the magnetic “ image”  of an FM is an image of random 
type. Moreover, the corresponding model of the FM magnetic field is sig-
nificantly different from the dipole model in the nearest area of the FM 
location. Hence, the abovementioned approach to determining the FM 
location relative to the AUV is inadequate for the nearest area of its loca-
tion. Therefore, the transportation of the MP to the FM location is solved by 
the guidance of the MP, which is independent of the shape of the magnetic 
field induced by the FM, based on the measured and calculated parameters 
of the FM magnetic field providing the motion of the MP on a trajectory 
leading to the location. For such guidance of the MP, it is reasonable to use 
the vector of gradient of magnetic field magnitude (Equation  5.21), which is 
calculated by means of the measured increment of magnitude of induction 
of the magnetic field on a trajectory of the AUV motion [27,28]. The guid-
ance is carried out in such a way that in each moment of time, the direction 
of the longitudinal AUV axis coincides with the current direction of the 
vector gradient of the FM magnetic field magnitude. In a general case, this 
direction does not have the same direction as the radius vector from the 
FM dipole center to the AUV center. The closer the AUV comes to the FM, 
the more the vector of magnitude’ s gradient is directed toward the FM. 
Simultaneously, the dependence of this magnitude on the distance to the 
FM is a potential and smooth function even for the complex image of an 
FM magnetic field.
5.5  Electromagnetic System for Positioning and Azimuth 
Angular Orientation of Ground Mobile Platform
Monitoring an FM located on local land surfaces can be realized based on 
previously discussed methods in Sections  5.2 and 5.3, using a UWTP as the 
ground MP. The design of a UWTP and its operating principle are similar to 
a robotic vehicle such as a Segway [2]. A UWTP is a uniaxial, two-wheeled 
vehicle with its own platform for measurement equipment. The platform 
has a rotational degree of freedom around the axis of the wheels, relative to 
the horizon plane (α  angle). Counter-rotating wheels provide the azimuth 
rotation of the UWTP, characterized by angle ψ . The non-horizontality of 
the surface under the UWTP is characterized by the roll angle, γ . The posi-
tion of the UWTP on the local land surface is evaluated using a reference 
point.
The positioning and orientation in particular around the azimuth angle ψ  
can be implemented by an EONS. The advantages of an EONS are its simple 
design and small size.

157
Application of Magnetic Sensors
5.5.1  EONS Configuration
An EONS consists of a ground-based emitter setting at the reference point 
and an onboard receiver setting in the UWTP. The scheme of an EONS is 
shown in Figure  5.10. The ground-based emitter of EONS with frame anten-
nas includes a low-frequency controlled generator and an emission mode 
control unit with a sync signal transmitter. The radio channel (RC) provides 
the synchronization of the emitted and received signals.
The onboard equipment of a UWTP includes a magnetic field receiver 
(inductive vector magnetometer), a receiver of sync signals, and a signal pro-
cessing unit (SPU). In turn, the SPU provides orientation and navigation of 
the UWTP, eliminates errors, and generates output signals.
The relative position of an EONS emitter and receiver is shown in 
Figure  5.11. In this figure, AX  EY  EZ  E is the fixed CF related to the emitter 
(the point A is the reference one, the X  E and Y  E axes are lying on the horizon 
plane, the AY  E axis determines a basic direction), and OX  RY  RZ  R is the CS 
related to the EMSON receiver (the point O is assigned to the center of the 
UWTP platform). The distance between CF centers is characterized by the 
radius vector R,  see Figure  5.11a.
Three angles, namely, the yaw angle, ψ , the inclination angle of the plat-
form, α , and the roll angle, γ , characterize the angular position of the X  RY  RZ  R 
CS with respect to the X  E  Y  E  Z  E   CS as shown in Figure  5.11b.
The relative orientation of the listed CSs is determined by the direction 
cosine matrix A  R/ E,  which is as follows:
	 AR/E =
−
+
cos
cos
cos
sin
sin
sin
cos
cos
sin
cos
sin
sin
cos
α
ψ
ψ
α
γ
ψ
γ
ψ
α
γ
ψ
γ
α
ψ
ψ
α
γ
ψ
γ
ψ
α
γ
ψ
γ
α
α
sin
sin
sin
sin
cos
cos
sin
sin
cos
cos
sin
sin
cos
s
+
−
−
in
cos
cos
.
γ
α
γ










Controlled 
generator
Sync signal 
transmitter
MCL
RC
Vector 
magnetometer
Sync signal 
receiver
SPU
Coordinates and 
orientation angles
EONS emitter
EONS receiver
FIGURE   5.10 
Scheme of EONS: MCL is the magnetic communication line; RC is the radio channel; SPU is 
the signal processing unit.

158
Magnetic Sensors and Devices
The matrix A  R/ E maps the projections of a vector from X  RY  RZ  R CS into 
X  E  Y  E  Z  E   CS. In this case, the angle of the UWTP azimuth orientation relative 
to the basic direction is defined as
	
ψ =




arctg a
a
21
11
,	
(5.22)
where a 21 , a 11  are the corresponding elements of matrix A  R/ E. In a similar way, 
the angles α  and γ  can also be defined in terms of elements of matrix A  R/ E.
The power supply of mutually perpendicular frame antennas of the emit-
ter is performed sequentially, and provided by a controlled generator. The 
timing signal provides the sequential connection of the controlled generator 
Z2
ZE
ZR
ZR
ZE
Y1
YE
YR
YR
YE
M2
M3
M1
XE
R
Receiver
Emitter
O
A
X1
XE
XR
XR
H1
(a)
(b)
H2
H3
α
α
α
γ
γ
γ.
ψ
ψ
ψ
FIGURE   5.11 
Relative position of an EONS emitter and receiver CS.

159
Application of Magnetic Sensors
to the respective frame antennas. At the same time, the index of the cur-
rently emitting antenna is reported to the controlled generator through the 
RC receiver.
The vector magnetometer measures the three components of the navi-
gation magnetic field emitting frame antennas. A signal diagram for the 
EONS channel is shown in Figure  5.12. In this diagram, M i  , H i   (i   =  1,2,3) are 
the magnetic moments generated by the i th antenna and the magnetic field 
intensity at the point O (observation point) generated by these moments, 
respectively; H ij   (i   =  1,2,3; j   =  X  RY  RZ  R) are the components of the magnetic 
field intensity, created in every j th receiver’ s magnetometer by the i th emit-
ter’ s antenna.
Switch 1
Switch 2
Switch 3
Emitter
Receiver
Antenna 1
Antenna 2
Antenna 3
Timing signal
Time
t,[s]
0
1/75
2/75
1/25
M1
H1XR
M2
M3
H2XR
H3XR
H1YR
H2YR
H3YR
H1ZR
H2ZR
H3ZR
FIGURE   5.12 
Signal diagram for EONS channel.

160
Magnetic Sensors and Devices
According to the magnetometer measurements, the matrix of signals H  is 
formed in an SPU. The elements of this matrix are proportional to the projec-
tions of the magnetic field’ s intensity on the axis of X  RY  RZ  R CS:
	
H =










H
H
H
H
H
H
H
H
H
R
R
R
R
R
R
R
R
R
1
1
2
2
3
3
3
2
X
1Y
Z
Y
Z
X
Y
Z
X
.	
(5.23)
5.5.2  Orientation and Positioning by Means of EONS
The orientation and positioning parameters of an EONS receiver relative 
to the emitter are determined based on the measurement of the navigation 
magnetic field at the point O. Estimation of the  position and azimuth orien-
tation of the UWTP is performed at a distance from the emitter larger than 
the linear dimensions of the emitter antennas of more than one order. Hence, 
let us use the dipole representation of the navigation magnetic field intensity 
at the point O.
The value of magnetic moment, M i  , created by the corresponding emitter 
antenna is as follows [15]:
	
M
R RH
H
i
i
i
i
i
i
H R
R RH
H
i
=
−




=
3
3
2
1 2 3
,
, , .	
(5.24)
The scalar product of magnetic moments, for example, M 1 M 2 , created by 
the first antenna and the second one of the emitter (note that the antennas 
are mutually perpendicular), is as follows:
	
M M
R RH
H
R RH
H
1
2
1
3
1
1
1
1
2
3
2
2
2
2
3
2
3
2
0
=
−




−



=
H R
R RH
H
H R
R RH
H
.	
(5.25)
where:
	
RH1
1
1
RH = cosα 	
	
RH2
2
2
RH
= cosα 	
	
R
r
R =
	
	
H
h
1
1
1
H =
	
	
H
h
2
2
2
H =
	

161
Application of Magnetic Sensors
α 1	 	
	
is the angle between vectors R  and H 1 
α 2	 	
	
is the angle between vectors R  and H 2 
r , h 1 , h 2	 are the basis vectors of R, H 1 , H 2  respectively
Accounting for h 1 r   =  cos α 1 , h 2 r   =  cos α 2 , H H
1
2
1
2
1
2
/H H = h h , from condi-
tion  5.25, we have H H
1
2
1
2
3
4
1
2
/H H =
cos
cos
α
α  or
	
β
β β
12
3
4
1
2
=
,	
(5.26)
where:
β 1	     =  cos α 1 
β 2	   =  cos α 2 
β12
1
2
1
2
= H H
H H
 is the cosine of the angle between vectors H 1  and H 2 
	
H H
1
2
1
2
1
2
1
2
=
+
+
H
H
H
H
H
H
R
R
R
X
X
Y
Y
Z
Z
R
R
R 	
Writing scalar products of the magnetic moments of other antennas (M 1 M 3 , 
M 2 M 3 ), we obtain a set of three equations for β 1 , β 2 , β 3 , which are cosines of 
the angles between the radius vector R  and vectors H 1 , H 2 , H 3 , as follows:
	
β
β β
β
β β
β
β β
12
3
4
1
2
13
3
4
1
3
23
3
4
2
3
=
=
=
;
;
. 	
(5.27)
The solution of set  5.27 becomes
	
β
β β
β
β
β β
β
β
β β
β
1
2
12
13
23
2
2
12
23
13
3
2
13
23
12
4
3
4
3
4
3
=
=
=
;
. 	
(5.28)
Directional cosines r x  , r y  , r z   of the radius vector R  in relation to X  RY  RZ  R CF 
are determined by the following equations:
	
h r
h r
h r
1
11
12
13
1
2
21
22
23
2
3
31
=
+
+
=
=
+
+
=
=
h r
h r
h r
h r
h r
h r
h r
x
y
z
x
y
z
β
β
;
;
x
y
z
h r
h r
+
+
=
32
33
3
β ,
	
(5.29)
where:
	
r
R
R
x
x
=
	
	
r
R
R
y
y
=
	

162
Magnetic Sensors and Devices
	
r
R
R
z
z
=
	
h ij   (i , j   =  1,2,3) are the projections of h  i   on the axes of X  RY  RZ  R CF
Knowing the magnitude of vector R  and the directional cosines r x  , r y  , r z  , 
the coordinates of the radius vector R  in relation to the receiver X  RY  RZ  R CF 
are calculated as follows:
	
R
Rr
R
Rr
R
Rr
x
x
y
y
z
z
=
=
=
;
.	
(5.30)
The angular orientation in relation to the receiver CS (X  RY  RZ  R) relative to 
the emitter CS (X  EY  EZ  E) can be determined by directional cosines matrix 
′
AR/E:
	
′
=
−




−
−




−
AR/E
3
2
1
1 3
4
3
2
1 3
4
3
2
11
1
2
1
12
1
2
1
r
h
r
h
r
x
y
z
β
β
β
β
β −




−
−




−
−




h
r
h
r
h
x
y
13
1
2
2
21
2
2
2
22
1 3
4
3
2
1 3
4
3
2
1
β
β
β
β
−
−




−
−




−
3
4
3
2
1 3
4
3
2
1 3
4
3
2
2
2
2
23
2
2
3
31
3
2
β
β
β
β
β
β
r
h
r
h
r
z
x
y
3
32
3
2
3
33
3
2
1 3
4
3
2
1 3
4
−




−
−




−
















h
r
h
z
β
β
β





(5.31)
where 
′
=
A
A
R E
R E
/
/ .
Moreover, substituting the corresponding elements of the matrix  5.31 into 
Equation  5.22, the equation for ψ  angle is as follows:
	
ψ
β
β
β
β
=
−




−




⋅
−
−




arctg
3
2
3
2
1
3
4
1
3
4
2
21
1
11
1
2
2
2
r
h
r
h
x
x






. 	
(5.32)
Thus, Equations  5.30 through 5.32 determine the positioning parameters 
of the UWTP relative to the reference point A, and its azimuth orientation 
relative to the basic direction of AY  E.
References 
	
1. 	Ageev M., Kiselev L., and Matvienko U. Autonomous Underwater Robots: Systems 
and Technologies , Nauka, Moscow, 2005. p. 398.
	
2. 	Inzartsev A.E. (ed.) Underwater Vehicles , Intech, https://www.intechopen.com/
books/underwater_vehicles, Austria, 2009. p. 582.

163
Application of Magnetic Sensors
	
3. 	Aleshin B., Chernomorcky A., Plehanov V., Makeinov V., and others. 
Orientation, navigation and stabilization of uniaxial wheeled vehicles, M.: 
MAI , 2012, p. 271.
	
4. 	Segway Advanced Development http://www.segway.com/puma/.
	
5. 	Blednov V. Method for determination of angular components of geomagnetic 
field induction vector on board the moving ferromagnetic carriers, Geophysics , 
Academy of Science Reports, 1995, Vol. 341, No. 2, pp. 251– 254.
	
6. 	Certenais J. and Periou J.J. Electromagnetic measurements at sea (Thomas 
Marconi Sonar SAS, Brest Department, France). Proceedings of the International 
Conference on Marine Electromagnetics , London, 1997.
	
7. 	Aleshin B., Plehanov V., Chernomorsky A., and others. Orientation and naviga-
tion of moving objects: Modern information technologies, M.: Physmathlit , 2006, 
p. 422.
	
8. 	Titterton D.H. and Weston J.L. Strapdown Inertial Navigation Technology , Peter 
Peregrinus and IEE, London, 1997.
	
9. 	Anchutin S., Kuris E., Maximov V., Plehanov V., and Chernomorsky A. Result 
of experimental studies of vector magnetometer in micromechanical AHRS, 
MNTS XVI Proceedings: Modern Technologies in Problems of Control, Automatics 
and Information Processing , Tulsky GU, 2007, pp. 89– 90.
	 10. 	Crassidis J.L., Lai K.-L., and Harman R.R. Real-time attitude-independent 
three-axis magnetometer calibration, Journal of Guidance, Control, and Dynamics , 
2005, Vol. 28, No. 1, pp. 115– 120.
	 11. 	Trifonov A. Optimization problems and numerical methods for their solution. 
M.: Business , 2003, p. 230.
	 12. 	Crassidis J.L. and Junkins, J.L. Optimal Estimation of Dynamic Systems , Chapter 
5, CRC Press, Boca Raton, FL, 2004.
	 13. 	Tihonov V., Chernomosky A., Plehanov V., and Maximov V. Optimization of 
the process of magnetic field induction vector determination on board the mov-
ing ferromagnetic object, Aerospace Instrumentation , 2005, No. 4, pp. 30–34.
	 14. 	Challa M. and Natanson G, Effects of magnetometer calibration and maneu-
vers on accuracies of magnetometer-only attitude and rate determination, 
Proceedings of the AAS/GSFC 13th International Symposium on Space Flight 
Dynamics , Vol. 1, (NASA/CP-1998-206858/VOLl) NASA-Goddard Space Flight 
Center, Greenbelt, MD, May 1998, pp. 389– 401.
	 15. 	Ermakov S. and Jiglavsky A. Optimal design of experiments mathematic the-
ory, M.: Science , 1987, p. 320.
	 16. 	Eriksson L., Johansson E., Kettaneh-Wold N., Wikstrom C., and Wold S. Design 
of Experiments: Principles and Applications , Ume, Learnways AB, 2000.
	 17. 	Batishev D. Methods of optimal design, Radio and Communications , 1984, p. 242.
	 18. 	Cook R.D. and Nachtsheim C.J. A comparison of algorithms for constructing 
exact D-optimal designs, Technometrics , 1980, Vol. 22, No. 3, pp. 315– 324.
	 19. 	Moiseev N. Optimization methods, M.: Science , 1982, p. 310.
	 20. 	Bertsimas, D. and Tsitsiklis J. Introduction to Linear Optimization , Athena 
Scientific, Belmont, MA, 1997.
	 21. 	Tihonov V. and Chernomorsky A. Autonomous detection of gyroscopes drift 
in strapdown inertial navigation system, Aerospace Instrumentation , 2004, No. 1, 
pp. 24– 27.
	 22. 	Johnson C. Adaptive corrective alignment for a carouseling strapdown INS, 
1984 American Control Conference , San Diego, CA, 1984,  pp. 1856–1861.

164
Magnetic Sensors and Devices
	 23. 	Semevsky R., Averkiev V., and Yarotsky V. Special magnetometry, S.Pb.: Science , 
2002, p. 360.
	 24. 	Brennan J.B. and Davis T.M. The influence of the natural environment on MAD 
operations. Technical Report, USA, 1969, September.
	 25. 	Plehanov V., Maximov V., Chernomorsky A., and Shvetskova A. Determination 
of magnitude gradient of the ferromagnetic object’ s magnetic field on board 
the mobile platform, MNTS XVIII Proceedings: Modern Technologies in Problems 
of Control, Automatics and Information Processing , Moscow, Moscow Institute of 
Radio-electronics and Automatics, 2009, p. 110.
	 26. 	McFee J.E. and Das Y. Determination of the parameters of a dipole by measure-
ment of its magnetic field, IEEE Transactions on Antennas and Propagation , 1981, 
AP-29 282– 286.
	 27. 	Plehanov V., Chernomorsky A., and Shvetskova A. Using information about 
magnitude gradient of magnetic field of ferromagnetic object for its posi-
tion determination, MNTS XIX Proceedings: Modern Technologies in Problems 
of Control, Automatics and Information Processing , Moscow, Moscow Institute of 
Electrical Engineering, 2010, p. 292.
	 28. 	Arie S., Lerner B., Salomonski N. et al. Localization and magnetic moment esti-
mation of a ferromagnetic target by simulated annealing, Measurement Science 
and Technology , 2007, Vol. 18, pp. 3451– 3457.

165
6
A Model to Calculate Force 
Characteristics of a Magnetic Suspension 
of a Superconducting Sphere
Sergey I. Kuznetsov and Yury M. Urman
ABSTRACT: In magnetic levitation systems, a magnetized object is held 
in space by magnetic force interaction and without mechanical contact to a 
support. The absence of mechanical contact minimizes friction, wear, and 
energy dissipation, motivating their use in a number of applications[1-3], 
including motion creation systems (motors and precise positioning for 
CONTENTS
6.1	
Magnetic Levitation and Its Applications............................................... 166
6.2	
Superconductor in Magnetic Field........................................................... 168
6.3	
Solving Field Problem................................................................................ 169
6.3.1	 Secondary Field............................................................................... 169
6.3.2	 Integral Equations for Secondary Field....................................... 170
6.3.3	 Solution for Spherical Shape......................................................... 171
6.3.4	 Total Field......................................................................................... 173
6.4	
Energy, Force Characteristics, and Dynamics........................................ 174
6.4.1	 Energy Integrals.............................................................................. 174
6.4.2	 Forces................................................................................................ 176
6.4.3	 Stiffness............................................................................................177
6.4.4	 Dynamics......................................................................................... 178
6.5	
Suspension on Circular Current Loops................................................... 179
6.5.1	 System of Circular Current Loops................................................ 179
6.5.2	 One Current Loop...........................................................................180
6.6	
Suspensions on Permanent Magnets....................................................... 182
6.6.1	 Permanent Magnets and Magnetic Charges............................... 182
6.6.2	 Force Function of a Sphere in a Suspending Field 
Produced by N  Point Magnetic Poles...........................................183
6.6.3	 Two Point Magnets.........................................................................185
6.6.4	 Circular Magnet..............................................................................190
6.7	
Conclusions.................................................................................................. 196
References.............................................................................................................. 196

166
Magnetic Sensors and Devices
microsystems [4], orientation systems for space vehicles [5]), sensors (accel-
erometers, gravimeters, inclinometers, gyroscopes, seismometers), motion 
storage systems (energy and momentum storages [6]), and systems for har-
vesting energy [7]. Magnetic levitation systems make it possible to isolate an 
object from external influences of extreme environments,  such as mechani-
cal, heat, and chemical, to cancel vibrations [8,9], create microgravity [10–12], 
providing means for new approaches to material synthesis and processing, 
such as crystal, protein, bacterial cluster growth [13], precise measurement of 
thermophysical properties [14], manipulation and separation of small-scale 
objects [15,16], including bio-objects [17].
6.1  Magnetic Levitation and Its Applications
In magnetic levitation systems, a magnetized object is held in space by magnetic 
force interaction and without mechanical contact to a support. The absence of 
mechanical contact minimizes friction, wear, and energy dissipation, moti-
vating their use in a number of applications [1– 3], including motion creation 
systems (motors and precise positioning for microsystems [4], orientation sys-
tems for space vehicles [5]), sensors (accelerometers, gravimeters, inclinometers, 
gyroscopes, seismometers), motion storage systems (energy and momentum 
storages [6]), and systems for harvesting energy [7]. Magnetic levitation systems 
make it possible to isolate an object from the external influences of extreme 
environments, such as mechanical, heat, and chemical influences, to cancel 
vibrations [8,9] and create microgravity [10– 12], providing the means for new 
approaches to material synthesis and processing, such as crystal, protein, and 
bacterial cluster growth [13]; the precise measurement of thermophysical prop-
erties [14]; and the manipulation and separation of small-scale objects [15,16], 
including bio-objects [17]. Such systems are natural to a cryogenic environment 
and require little to no energy supply, making them particularly appealing for 
aerospace applications, especially for micro- and nano-satellites, where power 
supply, spatial dimensions, and weight are extremely limited, while high preci-
sion measurements of orientation and acceleration are required [18].
Of particular interest are the passive levitation systems that are intrinsi-
cally stable and thus do not need control systems, which significantly reduces 
the complexity and cost of a suspension system and increases its robustness. 
According to the Earnshaw– Braunbeck theorem, stable passive levitation in 
free space is only possible when diamagnetic materials are present either on the 
levitated body or in the supporting system [19,20]. Diamagnetism is typically 
very low for common substances, requiring very strong magnetic fields to sus-
pend even very small diamagnetic objects [21–23]. However, weak diamagnetic 
material may be used to stabilize the levitation of a permanent magnet [24]. 
The only strong diamagnetism is present in superconductors (SC) that force out 

167
Force Characteristics of a Magnetic Suspension of an SC Sphere
a magnetic field (Meissner effect), and may be considered ideal diamagnetics 
with zero magnetic permeability. The absence of resistance to electric currents 
and perfect diamagnetism allow creating electromagnetic bearings with high 
stability parameters and the possibility to work with a turned off energy sup-
ply using non-decaying currents in superconducting coils, which makes super-
conductors especially interesting for use in non-contact bearings.
In order to provide levitation of a diamagnetic or superconductor, one 
has to compensate for gravity and inertia forces by a magnetic field force, 
defined by the field gradient product B (∂ B /∂ z ), where B  is the induction of 
the magnetic field. Additionally, to provide mechanical stability, the field 
should possess a particular spatial configuration with an isolated minimum 
of potential energy, also referred to as a magnetic potential well (MPW) [25].
Field strength and its distribution in the space define the parameters of 
the devices utilizing the non-contact suspension, such as the mass of the 
levitated body, stiffness, overload capacity, torques, and so on. The propor-
tional increase in the field strength increases the lifting force and stiffness. 
However, for a superconducting body there is a constraint: the magnetic field 
on the surface of the levitated body should always be less than the critical 
field H cr  1 , and the current in the superconducting suspension coils, if they are 
used, must be less than the critical current, I cr  , otherwise the superconducting 
state breaks down [3]. Therefore, one can’ t just increase the field of support, 
but should find such spatial configuration of the sources that would provide 
the optimal characteristics of the suspension, while the constraints on the 
strength of the magnetic field and the currents in the superconducting coils 
are satisfied. Therefore, one needs a model that may be used to determine 
equilibrium, stability, and various characteristics of the superconducting 
suspensions for different spatial distributions of the sources, and to possibly 
allow for solving the problem of finding optimal source distributions [26].
Magnetic levitation systems are very interesting dynamical systems from 
both scientific and engineering points of view. Typically, the levitated body 
performs fast rotations and various rotational and translational oscillations are 
superimposed on this rotational motion. The dynamics of the levitated body 
in a non-contact suspension may be very complex due to the nonlinearities 
and coupling between translational and rotational motions, elasticity [27], and 
two-way electromechanical coupling with the support system. Therefore, one 
needs a model to study the various complex motions, energy transforms, and 
stability, which is complex enough to include these effects on the one hand. On 
the other hand, this model needs to be analytical or semi-analytical to allow a 
qualitative study of the dynamics. The existing analytical models are too sim-
plistic. Typically, researchers consider dipole approximation for the levitated 
body with a quasi-homogeneous field, when the size of the levitated body is 
considered very small and it is replaced with a dipole with a magnetic dipole 
moment dependent on the external field [20,22,28], thus excluding from con-
sideration all the effects related to the size and shape of the levitated body and 
field inhomogeneity, which are important for applications. In particular, the 

168
Magnetic Sensors and Devices
size of the body affects its stability in a magnetic field [29], the shape of the body 
affects its equilibrium, and a change of shape or rotations of a non-spherical 
body may cause parametric oscillations [30]. Even for close to spherical (quasi-
spherical) levitated bodies, it is important to be able to account for the effects 
of non-sphericity and related torques, to be able to properly describe rotational 
motions, and estimate the precision of devices such as gyroscopes [31].
In this chapter, we present a model based on a calculation of the interaction 
energy between a spherical superconducting body of finite size and a support-
ing field created by a system of permanent magnets or electromagnets and 
represented in terms of expansions in spherical functions. The expressions 
for energy are obtained first in terms of expansions in spherical functions, in 
which case a finite number of terms in the sum may be calculated numerically. 
For some important cases (the case of N  point magnetic charges and the case of 
N  coaxial current loops), these expansions are converted into simple close-form 
analytical expressions. By placing N  point charges or N  coaxial current loops, 
one may construct rather complex source configurations, obtain various field 
distributions, and look for those configurations that provide the best charac-
teristics for a particular device. Simple analytical expressions for energy allow 
the calculation of force characteristics, determine stability, study qualitatively 
the dynamics of the levitated body, see their dependence on the distributions 
of the field sources, and pose an inverse problem: find the source distribution 
providing the desired characteristics of the suspension. Even though the deri-
vations are done for a spherical body, it is possible to consider small deviations 
from the spherical shape of the levitated body [30] and investigate the effects 
of non-sphericity on the dynamics of the levitated body [32–34]. The model 
may be useful to find distributions of sources providing a stable and robust 
equilibrium while satisfying mechanical and potentially thermal demands on 
the entire system. We use a quasi-static approximation, excluding the electro-
magnetic waves from the consideration [35].
6.2  Superconductor in Magnetic Field
Superconducting materials may be considered as perfect diamagnetics with 
zero permeability µ   =  0 due to the flux exclusion, known as the Meissner 
effect [3], causing repulsive forces exerted on superconductors placed in 
a magnetic field, pushing it to regions with a weaker magnetic field. The 
screening of magnetic flux is accompanied by persistent surface currents i , 
while inside the superconductor magnetic induction B  is identically zero and 
no macroscopic currents may exist. The surface currents are not produced by 
an electric field, but arise by virtue of the discontinuity in the tangential 
component of the induction at the boundary of the superconducting body.
The tangential component of a magnetic field experiences discontinuity on 
the interface with the surface current [35]:

169
Force Characteristics of a Magnetic Suspension of an SC Sphere
	
n
H
H
i
×
−
=
(
)
,
e
i
	
(6.1)
where:
	
	 n 	  is the normal vector to the surface of the body
H e  , H i   is the magnetic field outside and inside the body, respectively
Since B i    =   0 inside a superconductor, the density of the surface current is
	
i
n H
=
×
e.	
(6.2)
The magnetic field near the current-carrying coils in the presence of super-
conductors can be calculated as the field in free space, created by bound sur-
face currents i k   and the currents of the magnetizing coils j k   [35]:
H
i
j
Q
M
r
dS
P
k
k
Q
QM
M
S
k
L
k
k
Q
QP
k
k
k
( ) = −
(
)× ∇






−
(
)× ∇
∫
∑
µ
π
µ
π
0
0
4
1
4
1
r
k
k
k
V
P
k
N
dV






∫
∑
, 	(6.3)
The forces and torques acting on a superconductor in a magnetic field 
are due to the interaction of the induced surface currents with the external 
magnetic field. Thus, for known bound currents, i k   gives the formal solu-
tion of the problem. However, because the bound currents are not known 
in advance and are determined by the source currents, the problem reduces 
to determining the unknown superconducting sources (surface currents i  
or magnetic charges on the superconducting surfaces). This may be done 
by devising a system of Fredholm integral equations of the second kind in 
the densities of the secondary sources. By solving these integral equations 
and finding the distribution of the secondary sources, one can, by simple 
integration, calculate the entire field and then the force characteristics. For a 
spherical body, based on integral representation for vector potential [36], it 
is possible to find the Green function of the system made up of the sphere 
and the current-carrying coils, which solves integral equations by integrat-
ing the coil-type suspension with screens (or without them) placed close to 
the spherical rotor [37,38]. In other cases, numerical calculations are required; 
details of a numerical approach may be found in [39–45].
For the case without screens with constant currents in the sources, one may 
find the magnetic field by solving Laplace’ s equation for magnetic poten-
tial, using the perfect diamagnetism of a superconductor and satisfying the 
boundary conditions on its surface. We will use this approach, restricting 
ourselves to the case of suspension without screens.
6.3  Solving Field Problem
6.3.1  Secondary Field
Consider a homogeneous body S  with relative magnetic permeability µ , 
placed in a known (in the absence of S ) magnetic field H 0 , generated by a 

170
Magnetic Sensors and Devices
system of currents j . The total magnetic field H  is the sum of the “ primary”  
field H 0  and the “ secondary”  field Hʹ   due to the presence of body S . The very 
general case of a magnetized body with a continuously varying permeability 
magnetic field satisfies Maxwell equations [35]:
	
∇×
= ∇×
+
′ =
∇⋅
=
H
H
H
j
B
(
)
,
,
0
0 	
(6.4)
whereas the primary field H 0  is
	
∇×
=
∇⋅
=
H
j
H
0
0
0
,
. 	
(6.5)
Subtracting the first Equation  6.5 from the first Equation  6.4, we have
	
∇×
′ =
H
0, 	
(6.6)
that is, the secondary field has potential, and
	
′ = −∇′
H
ϕ , 	
(6.7)
where ′
ϕ  is the magnetic potential of the “ secondary”  field, and the problem 
of field determination in a suspension volume with a known external field 
reduces to finding the scalar function. This is true for an arbitrary-shaped 
body S .
Potential ′
ϕ  satisfies Laplace’ s equation:
	
∆′ =
ϕ
0 ,	
 (6.8)
with boundary conditions following from the continuity conditions for the 
normal component of the flux density and the tangential component of the 
field on S :
	
′ = ′
∂′
∂
−∂′
∂
=
−
⋅
ϕ
ϕ
µ ϕ
ϕ
µ
i
e
i
e
n
n
,
(
)(
),
1
0
H
n 	
(6.9)
where:
	
	
n 	
is the vector of the outer normal to S 
ϕ’i , ϕ’e 	
are the potentials of the secondary field inside and outside 
the body S 
Furthermore, it is required that potential ϕ’→0 at infinity, and have no 
singularities in the origin. We assumed permeability of the outer space 
µext = 1.
6.3.2  Integral Equations for Secondary Field
After adding 1−
(
)∂
∂
µ
ϕ’/
i
n to both parts of Equation  6.9, it may be rewritten 
in the form:

171
Force Characteristics of a Magnetic Suspension of an SC Sphere
	
ϕ
ϕ
ϕ
ϕ
σ
’
’ ,
’
’
,
i
e
i
e
M
n
n
=
∂
∂
−∂
∂
=
	
(6.10)
where σ
µ
ϕ
M
i
n
=
−
⋅
+ ∂′
∂
(
)[(
)
(
/
)]
1
0
H
n
The Laplace equation with boundary conditions (Equation  6.10) defines a 
problem of determining the field inside and outside the body S  with a charge 
distributed on its surface with density σµ  . Thus, the potential may be for-
mally expressed as
	
ϕ
π
σ
µ
π
µ
π
ϕ
µ
’
(
)
(
)
(
)
’
i
QM
S
QM
S
QM
i
S
r
ds
r
ds
r
n ds
=
=
−
+
−
∂
∂
∫
∫
∫
1
4
1
4
1
4
1
0
H n
, 	
(6.11)
where r QM   is the distance between point Q  inside the body, where the 
potential is calculated, and variable point M  on the surface S . From the sec-
ond Green’ s identity and the identity ∆
= −
−
( /
)
(
)
1
4
r
Q
M
QM
πδ
, where Δ  is 
Laplacian and δ  is Dirac’ s delta-function [35], it follows that
	
1
4
1
r
n ds
Q
n r
ds
QM
i
S
i
i
QM
S
∂
∂
=
+
∂
∂
∫
∫
ϕ
πϕ
ϕ
’
’ ( )
’
. 	
(6.12)
Substituting Equation  6.12 into Equation  6.11 results in an integral equation 
for the secondary field inside the body S :
	
ϕ
µ
πµ
µ
πµ
ϕ
’ ( )
(
)
’ (
)
.
i
QM
i
QM
S
S
Q
r
ds
M
n
r
ds
=
−
(
)
+
−
∂
∂






∫
∫
1
4
1
4
1
0
H n
	
(6.13)
Similarly, the integral equation for the “ secondary”  field outside the body 
S  will be
	
ϕ
µ
π
µ
π
ϕ
’ ( )
(
)
(
)
(
)
’ (
)
.
e
QM
e
S
S
QM
Q
r
ds
M
n
r
ds
=
−
+
−
∂
∂






∫
∫
1
4
1
4
1
0
H n
	
(6.14)
Here, the point Q  is located outside the body S .
6.3.3  Solution for Spherical Shape
Equations  6.13 and 6.14 are derived for the arbitrary-shaped body S . Now 
assume that S  has a spherical shape and put the origin in the center of S , then 
expand rQM
−1  in the series of spherical functions [35]:
	
1
4
2
1
1
r
r
l
r
Y
Y
QM
l
l
lm
lm
l m
=
+
+
∑
π
θ ϕ
θ ϕ
(
) ’
( , )
( ’, ’),
*
,
	
(6.15)

172
Magnetic Sensors and Devices
where primed and unprimed angles stay for points M  and Q , respectively. 
Substituting Equation  6.15 into Equation  6.13, we obtain
ϕ
µ
µ
µ
µ
µ
’
( )
(
)
(
)
(
’)
(
)
,
*
i
l
lm
l
l m
r Y
l
R
Y
ds
l
l
=
−
+
−
−
+
+
−
1
2
1
1
1
2
1
1
0
0
Ω
Ω
H n
r Y
R
Y
ds
r Y
l
R
l
lm
l
l m
S
i
l m
S
l m
l
l m
( )
’
(
’)
( )
(
)
,
,
*
,
,
Ω
Ω
Ω
∑
∫
∫
∑
=
−
+
ϕ
µ
µ
1
2
1
l
lm
i
l
l
l m
lm
i
l m
l m
E
l
l
r
R
Y
C
+
+
−
−
+
+
∑
∑
1
2
1
1
2
1
µ
µ
(
)
( )
,
,
,
,
Ω
(6.16)
where
E
Y
ds
lm
i
l m
S
=∫(
)
(
)
,
,
*
*
H n
0
Ω
	

(6.17)
C
Y
ds
lm
i
i
lm
S
=∫ϕ’
(
’)
,
* Ω

(6.18)
R  is the radius of the sphere and Ω  is the set of angles θ ,φ .
Substituting Equation  6.16 into Equation  6.18 and integrating over a unit 
sphere gives
	
 C
E R
l
l
l
C
lm
i
lm
i
lm
i
=
+
−
−
+
+
2
1
1
1
2
1
µ
µ
,
therefore,
	
C
E R
l
l
lm
i
lm
i
=
−
+ +
(
)
.
1
1
µ
µ
	
(6.19)
Then, the potential could be written in the following form:
	
ϕ
µ
’
(
)(
)
( ,
)
,
i
i
S
Q M ds
=
−
∫1
0
H n Φ
	
(6.20)
where
	
Φ
Ω
Ω
i
l
l
lm
Q
lm
M
l m
Q M
l
l
r
R
Y
Y
( ,
)
(
)
(
)
*
,
=
+ +
+
∑
1
1
1
µ
	
(6.21)
is the potential inside the sphere with magnetic permeability µ  due to a unit 
point charge on its surface.
For the external potential of the secondary field, the formula is

173
Force Characteristics of a Magnetic Suspension of an SC Sphere
	
ϕ
µ
’ ( )
(
)(
)
( ,
)
,
e
e
S
Q
Q M ds
=
−
∫1
0
H n Φ
	
(6.22)
where Φe Q M
( ,
)  is obtained from Φi Q M
( ,
) by switching R  and r . In the 
simplest case of a uniform external field, Equations  6.20 and 6.21 yield the 
well-known result [46]:
	
ϕ
µ
µ
ϕ
µ
µ
’
(
),
’
(
).
i
e
R
r
=
−
+
=
−
+
1
2
1
2
3
3
0
Hr
H r 	
(6.23)
6.3.4  Total Field
It is convenient to represent the potential of the primary field H0
0
= −∇ϕ  in 
terms of spherical functions Ylm :
	
ϕ
π
0
4
2
1
=
+
∑
l
a r Y
lm
l
lm
l m
( )
,
Ω.	
 (6.24)
Such an expansion is always possible since the potential of the primary field 
in any point outside the field sources, where ∇×
=
H0
0 , satisfies the Laplace 
equation. The expansion coefficients a lm   could be calculated analytically or 
numerically for a known sources distribution; they depend on the sources’  
geometry, the distances between sources and origin, and the currents’  val-
ues. If the field has an axis of symmetry that coincides with the polar axis of 
a spherical system of reference, then a lm    =  0 for all m   ≠   0.
Substituting Equation  6.24 into Equation  6.17 and integrating gives
	
E
l
a lR
lm
i
lm
l
=
+
+
4
2
1
1
π
,	
 (6.25)
it is obvious that E
E
lm
l
lm
i
=
. Therefore, the potential of the total field inside the 
sphere is
	
ϕ
ϕ
ϕ
π
µ
i
i
l m
lm
l
lm
l
l
l
l a r Y
=
+
=
+
+
+ +
∑
0
4
2
1
2
1
1
’
( ),
,
Ω	
(6.26)
and outside the sphere is
	
ϕ
ϕ
ϕ
π
µ
µ
e
e
lm
l
l
l
l m
lm
l
a
r
l
l
l
R
r
Y
=
+
=
+
+
−
+ +




+
+
∑
0
2
1
1
4
2
1
1
1
’
(
)
(
,
Ω).	
(6.27)

174
Magnetic Sensors and Devices
The case of a superconductor follows from these equations when µ   =  0 and 
only the potential outside the sphere has a physical sense; for ferromagnetic 
µ   =  ∞ . 
6.4  Energy, Force Characteristics, and Dynamics
6.4.1  Energy Integrals
When the total magnetic field H  and currents i  on the surface of a supercon-
ductor are known, one may use them to determine the forces and torques 
exerted on the superconductor and then plug the forces and torques into 
the equations of motion. However, instead of dealing with vector quantities 
of force and torque, it is convenient to calculate the first scalar quantity, the 
potential energy of interaction, and then use it to define the force character-
istics and use Lagrange formalism to study dynamics.
When surface currents on a levitated superconducting body and currents 
in the support system are known, one may use the integral [35]:
	
W
dV
dV
dV
V
i
N
V
j
N
i
j
i
j
V
i
=
⋅
=
⋅
(
)
−
∫
∑∫
∑∫
=
=
1
2
8
0
1
1
1
2
2
A j
j j
x
x
µ
π
.	
(6.28)
It may also be expressed in terms of total currents I  and their integral geo-
metrical characteristics inductances:
	
W
L I I
L
I I
dV
dV
jk j k
j k
ij
i j
i
C
j
C
i j
i
j
i
j
=
=
−
∑
∫
∫
1
2
4
0
,
,
.
µ
π
j j
x
x
	
(6.29)
Alternatively, one may use the expression for a magnetized body in an 
external field (the case of linear isotropic media) [35]:
W
dV
dV
dV
V
V
i
V
= −
⋅
=
−
(
)
⋅
=
−
(
)∇∇
∫
∫
∫
1
2
1
2
1
1
2
1
0
0
0
0
0
M B
H H
µ
µ
µ
µ
ϕ
ϕ
, 	
(6.30)
where:
B 	 =	  µ 0 µ H  is magnetic induction
M  	=	 (µ   –   1)H  is the magnetization per unit volume
µ 	  =	  constant, in terms of potentials
	
W
dV
i
V
=
−
(
)∇∇
∫
1
2
1
0
0
µ
µ
ϕ
ϕ
. 	
(6.31)

175
Force Characteristics of a Magnetic Suspension of an SC Sphere
Using Green’ s identity
	
 
∇∇
=
∂
∂
−
∆
∫
∫
∫
ϕ
ϕ
ϕ
ϕ
ϕ
ϕ
i
V
i
S
i
V
dV
n dS
dV
0
0
0
and condition ∆
=
ϕ0
0  inside the levitated body, energy (Equation  6.30) may 
be represented as
	
W
n dS
i
S
=
−
(
)
∂
∂
∫
µ
µ
ϕ
ϕ
0
0
1
2
.	
(6.32)
Substitution Equations  6.24 and 6.27 into Equation  6.32 and integrating 
over the sphere, using the orthogonality of the spherical functions, results 
in the expression for the interaction energy in terms of the expansion coef-
ficients of the primary field [29]:
	
W
lR
l
l a a
l
lm lm
l m
=
−
+ +
+
∑
2
1
1
0
2
1
πµ
µ
µ
(
)
*
,
.	
 (6.33)
In [47], the interaction energy is calculated in terms of the integral from the 
field of suspension in the absence of the sphere:
	
W
r
R
H
dV
V
=




+
(
)
∫
µ α
α
0
0
2
’
’
,
rr
rr
	
(6.34)
where:
	α
µ
µ
=
−
+
1
1
/
	
ρ  
is the vector from the center of mass of the sphere to some fixed point 
in space, in particular it can be the center of suspension
It can be shown that Equations  6.33 and 6.34 are equivalent. Expression 
6.33 is more convenient for calculating energy in terms of expansion coef-
ficients, while Equation  6.34 is convenient for deriving forces and stiffness.
For the case when the levitated body is very small, one may neglect the 
change of the field over the extent of the levitated body (quasi-homogeneous 
field) and take it out of the integral in Equation  6.34, in which case:
	
W
H
r
R
dV
R H
V
=
+
(
) 



=
+
( )
∫
µ α
ρ
πµ α
α
ρ
α
0
0
2
0
3
2
4
3
r’
’
. 	
(6.35)
This expression coincides with the expression used in [ 20 ] and for a weak 
diamagnetic, that is, small  χ
µ
=
−1 , reduces to the approximate expressions 
used by [ 22 , 28 ],  W
B V
= −χ
µ
0
2
0
2
/
. 

176
Magnetic Sensors and Devices
6.4.2  Forces
Forces may be calculated directly from Equation  6.33 by differentiation, in 
which case the derivatives of the coefficient a lm   must be calculated. It is, how-
ever, possible to calculate the derivatives of H  in terms of coefficient a lm   using 
the Clebsch– Gordan coefficients formalism. We will use Expression  6.34 to 
calculate the forces between a magnetized sphere and a support field. The 
force components in a cyclic coordinates system [48] are as follows:
F
x W
x
r
R
H
dV
r
R
V
ν
ν
ν
α
ρ
µ α
ρ
µ α
= −∂
∂
( ) = −
∂
∂




+
(
)
= −




∫
0
0
2
0
’
’
’
r
α
ν
α
ν
ρ
µ α
ρ
∂
∂
+
(
)
= −




∂
∂
+
(
)
∫
∫
x H
dV
r
R
x H
dV
V
V
0
2
0
0
2
r
r
’
’
’
’
.
	
(6.36)
The derivative without prime corresponds to differentiation with respect 
to ρ , while the derivative with prime corresponds to differentiation with 
respect to r’. Index ν  runs through -1, 0, 1, and
	
F
F
F
F
iF
F
F
iF
z
x
y
x
y
0
1
1
1
2
1
2
=
= −
+
(
)
=
−
(
)
−
,
,
. 	
(6.37)
Calculating the derivative of the square of the magnetic field (
/
)
′∂
∂x H
ν
0
2 
and substituting it into Equation  6.36 yields [35]
	
F
lR
l
l
l
m
l
m
l
m
l
ν
πµ
µ
µ
ν
ν
ν
ν
=
−
(
)
+ +
+ +
+
(
)
+ −
−
(
)
−
(
)
+
(
)
−
+
4
1
1
1
1
1
1
0
2
1
!
!
!(
)
+
(
)
+
+
∑
!
!
.
,
*
,
l
m
a a
lm l
m
l m
1
µ 	(6.38)
From Equation  6.38, it follows that force differs from zero only if field har-
monics with neighboring l  are not zeros. In particular, if the field of suspen-
sion has a symmetry or antisymmetry axis, that is, there are only even or 
uneven harmonics in the expansion, force vanishes.
For the case of superconductor µ   =  0, we have
	
F
l
l
l
m
l
m
l
m
l
m
R l
ν
πµ
ν
ν
ν
ν
= −
+
+ +
+
(
)
+ −
−
(
)
−
(
)
+
(
)
−
(
)
+
(
)
4
1
1
1
1
1
0
2
!
!
!
!
!
+
+
+
∑
1
1
a a
lm l
m
l m
,
*
,
µ	
(6.39)
It is clear from physical considerations that in the case of an axisymmetric 
field when the center of the sphere is on the symmetry axis, then the only 
possible non-vanishing component is F z  . In this case, all coefficients with a 

177
Force Characteristics of a Magnetic Suspension of an SC Sphere
non-zero second index vanish in the potential expansion and Equation 6.38 
reduces to
	
F
l l
l
l R
a a
z
l
l l
l
=
−
(
)
+
(
)
+ +
+
+
=
∞
∑
4
1
1
1
0
2
1
1
1
πµ
µ
µ
.	
(6.40)
6.4.3  Stiffness
Using Equation  6.35, one may calculate stiffness as follows:
	
k
F
x
r
R
x
x H dV
V
νλ
ν
λ
λ
ν
αµ
= −∂
∂
=




∂
∂
∂
∫
0
2
0
2
’
,	
(6.41)
where v and λ  run through values 0, 1, –1. Due to the conservative nature of 
forces, the stiffness tensor k vλ   is symmetrical:
	
k
k
k
k
k
ik
k
k
k
k
k
zz
zx
zy
0 0
0 1
10
0
1
1 0
01
1
1
1 1
1
2
,
,
,
,
*
,
,
=
=
= −
+
(
)
=
= −
=
−
−
−
−
= −
+
(
)
=
−−
1
2
1
1
1 1
k
k
k
k
xx
yy
,
,
*
	
(6.42)
and
	
k
k
k
k
k
k
k
k
xx
yy
=
+
−
(
)
= −
+
+
(
)
−−
−
−−
−
1
2
2
1
2
2
1 1
1
1
1
1
1 1
1
1
1
1
,
,
,
,
,
,
,
.	
(6.43)
For an axisymmetric field, the expressions for stiffness simplify, since the 
field is described by the expansion, where the coefficients with a second non-
zero index vanish. In this case, expressions for stiffness reduce to [49]
	
k
l l
l
l R
l
a
l
a a
zz
l
l
l l
l
=
−
(
)
+
(
)
+ +
+
(
)
+
+
(
)
{
}
+
+
+
=
∞
4
1
1
1
1
2
0
2
1
1
2
2
1
πµ
µ
µ
∑
,	
(6.44)
	
k
k
k
l l
l
l R
la
l
a a
xx
yy
l
l
l l
l
=
=
=
−
+
(
)
+ +
−
+
(
)
{
}
⊥
+
+
+
∑
4
1
2
1
1
2
0
2
1
1
2
2
πµ
µ
µ
.	
(6.45)
For stable equilibrium, components k zz  , k xx  , and k yy   must be positive. 
A summation stiffness components of k xx  , k yy  , and k zz   yields

178
Magnetic Sensors and Devices
	
k
k
k
lR
l
l
l
a
zz
xx
yy
l
l
m
l m
+
+
=
−
(
)
+ +
+
(
)
+
(
)
+
+
∑
4
1
1
1
2
1
0
2
1
1
2
πµ
µ
µ
l
,
,
	
(6.46)
In the case of a diamagnetic or a superconductor (µ   <   0), the sum of the 
stiffness components is positive, and it may be possible that each compo-
nent is positive and that conservative stability is possible in the suspension, 
which is consistent with the Braunbeck– Earnshaw theorem [19].
6.4.4  Dynamics
With energy, forces, and torques calculated, one may study the dynam-
ics of the levitated body in the suspension. It is convenient to use the 
Lagrange– Maxwell formalism [ 3 , 50 ], which states that the motion in an 
electromechanical system may be deduced from the Lagrange function. The 
Lagrange function for electromechanical system is 
	
L
T q q
q
W
q i
i
i
i
m
i
k
=
(
) −
( ) +
(
)
,
,
,

Π
	
(6.47)
where: 
	q  i, q  i	 		
are the generalized coordinates and velocities of the 
mechanical part 
	 i  k	
		
are the source currents 
	T   and ∏ 
are the kinetic and potential energy 
	W  m	 		
is the magnetic and electrostatic interaction energy 
Kinetic energy  T   of a rigid body consists of translational and rotational 
parts [ 51 ]: 
	
T
mv
Iik
i
k
=
+
2
2
1
2
ΩΩ,	
(6.48)
where: 
Ωi 	
are the components of angular velocity 
	 I  ik	
   are the components of inertia tensor 
The potential energy assuming a vertical  z  -axis will be 
	
Π = mgz.	
(6.49)
For constant current sources, the magnetic energy must be related to the 
kinetic energy, and for constant fluxes it is related to the potential energy. 
Then, the equation of motion of the rotor in the superconducting suspension 
will have the form of a Lagrange equation:

179
Force Characteristics of a Magnetic Suspension of an SC Sphere
	
d
dt
L
q
L
q
Q
S
S
qS
∂
∂
−∂
∂
=
, 	
(6.50)
where Q qS   is the generalized force of a non-conservative nature, conjugated 
to the generalized coordinate q S  . The case of constant flux through the coil 
implies the presence of cyclic integrals in the system; therefore, in addition 
to the Lagrange– Maxwell function, we can construct the Routh– Maxwell 
function. Clearly, the two means of constructing the equation are equivalent.
6.5  Suspension on Circular Current Loops
6.5.1  System of Circular Current Loops
A typically supporting field is created by electromagnets or superconduct-
ing circuits [3]. Assume that magnetic field H  is created by a system of coax-
ial current loops with radius r i  , carrying currents εi  I i  , where εi    =  ± 1 and 
I i   is the current magnitude, i   =  1,2,… . Then, a spherical coordinate system 
with its origin in the center of the sphere magnetic field potential may be 
written as
	
ϕ
θ
0 =
(
)
∑A r P
l
l
l cos
,	
(6.51)
where
	
A
I
r l
P
l
i
i
i
l
i
l
l
i
= −
(
)
(
)
+
∑
πµ
ε
α
α
0
1
1
sin
cos
.	
(6.52)
and 2α i  is an angle in which the diameter of the i th loop is seen from the ori-
gin of the coordinate system. Substituting Equation  6.52 into Equation  6.33 
and taking µ   =  0, results in the following expression of energy:
	
W
R
I I rr
b b
P
P
l l
i k i k
i k
l
i
l
k
l
i k
=
(
)
(
)
+
(
)
=
∞
∑
∑
π
µ
α
α
2
1
0
1
1
1
cos
cos
.
,
	
(6.53)
Summing Equation  6.53, yields [49]
	
W
I I
rr k C k
i k
i k
i k
ik
i k
=
(
)
∑
µ0
3
2
,
,
, 	
(6.54)

180
Magnetic Sensors and Devices
where
	
k
R rr
R
R
z z
rr
b b
ik
i k
i
k
i k
i
k
2
2
4
2
2
2
4
2
=
−
−
(
) +
, 	
(6.55)
	
C k
k
k
K k
E k
ik
ik
ik
ik
ik
(
) =
−
(
) (
) −
(
)


1
2
2
4
2
. 	
(6.56)
K , E  are elliptic integrals.
6.5.2  One Current Loop
Consider a superconducting sphere in the field of a single circular current 
loop of radius r b  , as shown on Figure  6.1. The energy of interaction with one 
current loop is obtained from Equation  6.54 when i   =  k   =  1:
	
W
I r k C k
b
=
( )
µ0
2
3
2
, 	
(6.57)
where
	
k
R r
R
r
r
R
z
z
b
b
b
2
2 2
2
2 2
2
2
2
4
4
2
=
+
(
) +
−
(
)
+
. 	
(6.58)
From Equation  6.57 it is now easy to find the force acting on the sphere and 
the longitudinal stiffness.
The transversal stiffness is much harder to calculate, as it is not possible to 
obtain a simple analytical expression even for one current loop and the sum 
(Equation  6.45) must be calculated numerically. In the case of a small sphere, 
the sum converges very fast and it is sufficient to take only few terms. The 
R
rb
x
z
FIGURE  6.1 
A superconducting sphere in the field of a circular loop.

181
Force Characteristics of a Magnetic Suspension of an SC Sphere
dependence of stiffness on the parameter η = z
rb
/ , characterizing the relative 
displacement of the sphere from the loops plane, is depicted in Figure  6.2.
The analytical dependence of force and stiffness when R
b
/ << 1 has the 
form:
	
F
F
k
F
r
k
F
r
C
C
z
C
C
b
C
C
b
= −
+
(
)
=
−
+
(
)
=
−
+
(
⊥
0
2
4
0
2
2 5
0
2
2
1
7
1
1
4
2
5
1
η
η
η
η
η
η
,
,
)
5 , 	
(6.59)
where
	
F
I
R
r
z
r
C
b
b
0
0
2
3
3
2
=




=
πµ
η
,
. 	
From Equation  6.59, it follows that in the interval:
	
0 378
0 63
.
.
<
<
η
	
all stiffness components are positive and suspension is conservatively stable. 
The weight of the body will be restricted by the limits:
	
0 97
1 12
0
.
.
<
<
mg
F
	
–1
–0.8
–0.6
–0.4
–0.2
0.2
0.4
0
F
F0
0.2
0.4
0.6
0.8
1
1.2
Stability area
1.4
1.6
z
rb
k⊥rb
η =
F0
k⊥rb
F0
FIGURE  6.2 
Dependence of energy, force, and stiffness on the parameter η.

182
Magnetic Sensors and Devices
so that the equilibrium point fits the stability interval. If it is too heavy, then 
it will fall through the ring, if it is too light, then it will lift up and slide side-
ways, since transverse stiffness becomes negative above the point η  =  0.63.
With the increase in the size of the sphere, the stability regions change, for 
example, for R   =  0.56r b   the stability region is
	
0 435
0 767
.
.
.
<
<
η
	
6.6  Suspensions on Permanent Magnets
6.6.1  Permanent Magnets and Magnetic Charges
We have previously discussed suspensions created by a system of current 
loops. However, a supporting magnetic field may also be generated by a sys-
tem of permanent magnets. An important advantage of such a setup is that 
the support is truly passive as no energy is required to feed electromagnets. 
Moreover, such a system is very simple and reliable.
Recent technological advances have made it possible to create rare earth 
elements (REE)-based permanent magnets generating a field that is sufficient 
for levitation. Appropriately processed, REE compounds, such as SmCo5  and 
NdCo5 , provide coercive forces as high as 1.4  T (the highest known value for 
this type of material) and a giant magnetic energy of up to104   T  A/m, which 
is two orders of magnitude higher than the corresponding energy for mag-
nets made of iron-group metals. This makes it possible to produce magnets 
several tens of times stronger than those based on iron-group metals [52].
Permanent magnets are characterized by remnant magnetization B r  , 
which reaches 1.4  T in modern magnets [52,53].
A magnetic field created by permanent magnets may be effectively mod-
eled using the concept of a magnetic charge, even though magnetic charges 
do not exist in nature. In the following, we consider a superconducting 
sphere in the magnetic field generated by a system of permanent cylindrical 
magnets with axial magnetization. One pole of each of the magnets faces the 
suspended body. The field produced by a thin cylindrical magnet (magnetic 
needle, Figure  6.3) may be viewed as a dipole field [25,54]. For sufficiently 
N
FIGURE  6.3 
Thin magnet and its field near one end.

183
Force Characteristics of a Magnetic Suspension of an SC Sphere
long magnets, the field of one pole can be assumed to be negligible near the 
other pole (the encircled region in Figure  6.3). Therefore, we assume that the 
field in this region is produced by N  point magnetic poles.
A charge corresponding to one of the poles of a cylindrical magnet can 
be estimated by the formula q   =  πa 2 M  [25,54], where a  is the radius of the 
cylinder and M  is the magnetization of the magnet. The magnetization of 
a cylindrical magnet is related to the remnant induction by the expression 
M
Br
=
/µ0 [35,46,54], thus q
a Br
= π
µ
2
0
/
.
6.6.2  Force Function of a Sphere in a Suspending Field 
Produced by N  Point Magnetic Poles
At some point B  outside the sphere S , potential ϕ0  of a set of N  magnetic 
poles with spherical coordinates b i  , θi  , and ϕi  (i   =  1, 2, … , N ) originating at 
the center of the sphere can be written in the following form [35]:
ϕ
µ
π
µ
π
θ
θ
θ
θ
ϕ
ϕ
0
0
0
2
2
4
4
2
=
=
+
−
+
−
q
r
q
r
b
rb
i
BA
i
i
i
i
i
i
(cos cos
sin sin
cos(
i
i
N
i
N
l
i
i
l
lm
i
i
l m
i
N
l
r
q
b
Y
Y
)
(
)
( , )
(
,
)
*
,
=
=
+
=
∑
∑
∑
∑
=
+
=
1
1
0
1
1
2
1
µ
θ ϕ
θ ϕ
1
2
1
1
2
1
0
1
1
l
r Y
l
q
b
Y
l
lm
i
i
l
i
i
i
N
l m
+
+






+
=∑
∑
( , )
(
,
)
*
,
θ ϕ
µ
θ ϕ
=
+
∑a
l
r Y
l m
l m
l
lm
,
*
,
(
)
( , ),
1
2
1
θ ϕ
	(6.60)
where
	
a
l
q
b
Y
l m
i
i
l
i
i
i
N
,
*
*
(
)
(
,
).
=
+
+
=∑
1
2
1
0
1
1
µ
θ ϕ
	
(6.61)
Here, r , θ, and ϕ  are the spherical coordinates of point B .
Due to the principle of superposition, one can create a rather complex field 
from N  magnetic poles. For example, from Equations  6.60 and 6.61 it is easy 
to obtain the potential of the field, generated by a magnetic ring, which can 
be considered as consisting of an infinite number of poles, or a set of mag-
netic rings. For this purpose, one has to integrate Equation  6.61 over ϕ  from 
0 to 2π, assuming that the poles are distributed evenly along the rings. Then, 
Equation  6.61 reduces to

184
Magnetic Sensors and Devices
	
a
q
b
P
l
i
i
l
l
i
i
N
0
0
1
1
4
=
+
=∑
µ
π
θ
(cos
),	
(6.62)
where Pl cosθ
(
) are the Legendre polynomials.
Substituting Equation  6.61 into Equation  6.33 yields
	
W
lR
l
l
l
q q
b b
Y
Y
l
i
k
i k
l
l m
i
i
l m
=
−
(
)
+ +
+
+
+
µ
µ
µ
θ ϕ
θ
0
2
1
1
1
2
1
1
2
1 (
)
(
,
)
(
,
*
,
k
k
i k
l m
l
i
k
i k
l
l
ik
lR
l
l
q q
b b
P
,
)
(
)
(cos
,
,
ϕ
µ
µ
π
µ
θ
∑
∑
=
−
(
)
+ +
+
+
0
2
1
1
1
8
1
),
,
l
i k ∑
∑
	 (6.63)
where
	
cos
cos
cos
sin
sin
cos(
).
θ
θ
θ
θ
θ
ϕ
ϕ
ik
i
k
i
k
i
k
=
+
−
	
(6.64)
This expression holds for arbitrary material: diamagnetic, paramagnetic, 
and ferromagnetic. The case of a superconductor corresponds to µ   =  0, the 
case of a ferromagnetic corresponds to µ   =  ∞ . For arbitrary µ , the summa-
tion in index l may not be converted to a closed-form expression. However, 
for µ   =  0 and µ   =  ∞ , it can be done.
Taking µ   =  0 for a superconducting rotor:
	
W
q q
R
b b
l
l
R
b b
P
i
k
i k
i k
l
i k
l
l
ik
=
+






=
∞
∑
∑
µ
π
θ
0
2
1
8
1
,
(cos
).	
(6.65)
The sum may be converted to the closed-form expression [29]:
	
W
q R b
R
R
b
b
R
q q R
b
i
i
i
i
i
N
i
k
i
= 8
−
−
−






+ 8
=∑
µ
π
µ
π
0
2
2
2
2
2
2
2
1
0
2
1
1
1
ln
(
−
−
+



−
−
−
+
<∑
R
b
R
R
R
b
R
b
R
R
k
ik
i k
i
k
ik
2
2
2
2
2
2
2
2
2
2
2
1
2
)(
)
ln
(
)(
)
η
η
2
2
2
2
2
2
2
2
−
+
+
+
−
−



(
)
(
)
.
b
b
R
b
b
i
k
ik
ik
i
k
η
η
	
(6.66)
In this expression, η
θ
ik
i
i
i k
ik
b
b
b b
2
2
2
2
=
+
−
cos
is the distance between the i th 
and k th poles.

185
Force Characteristics of a Magnetic Suspension of an SC Sphere
6.6.3  Two Point Magnets
Consider a superconducting sphere of radius R  in the field of two magnetic 
poles with charge q and coordinates z 1   =  d  and z 2   =  – d , as shown in Figure  6.4.
For displacements along the y -axis, the potential energy:
	
W
q R d
y
R
R
d
y
d
y
R
q R
d
y
⊥=
+
−
−
+
+
−








+
+
µ
π
0
2
2
2
2
2
2
2
2
2
2
2
2
2
4
1
1
1
ln
(
−
+



−
+
−
+
+
+
−




R
d R
R
d
y
R
d R
R
d
y
d
2 2
2
2
2
2
2
2 2
2
2
2
2
2
2
4
1
4
2
)
ln
(
)



,
	
(6.67)
or, in the dimensionless form:
	
w
W
W
⊥
⊥
=
=
−
+
−
+
−
+
+
−
+
+



−
0
2
2
2
2
2
2
2 2
2
1
1
1
1
1
4
1
γ
γ
ε
γ
ε
γ
ε
γ
γ
ε
γ
γ
ln
(
)
ln
(
)
,
1
4
1
2
2
2 2
2
2
2
−
+
+
+ +
−



γ
ε
γ
γ
ε
	
(6.68)
R
y
x
2d
z
FIGURE  6.4 
Superconductor of a spherical shape in the field of two magnetic poles.

186
Magnetic Sensors and Devices
where γ = R d
/ , ε = y d
/ , W
q
d
0
0
2
4
= (
/
)(
/ )
µ
π
. Then, the associated force is 
given by
f
F
F
w
⊥
⊥
=
= −∂
∂
=
−
+
+
−
+
−
+
(
)
−
+
(
)



0
2
2
2
2
2
2
2 2
2
1
2
1
2 1
1
ε
γε
γ
ε
ε
γ
ε
ε
ε
γ
ε
(
)





−
+
(
)
+
(
)









+
−
+
(
)
+
+
1
1
4
4
4
2 1
2
2
2
2
2
2
3
2
2
γ
ε
γ
ε
γ
ε
γ ε
ε
γ
ε +
−
+
(
)
+
−
+
+
+
+
−
+
−
+
γ
γ ε
ε
ε
γ ε
ε
γ
ε
γ
γ ε
ε
ε
γ
4
2 2
4
3 2
2
3
2
2
4
2 2
4
2
4
4
4
4 1
2
2
2
1
2
/
γ
ε
γ
γ ε
ε
γ
ε
2
2
4
2 2
4
2
2
2
2
2
1
2
2
2
+
+
−
+
+
+
−













,
	
(6.69)
where F
q
d
0
0
2
2
4
= µ
π
/(
) , and stiffness
	
k
K
K
w
K
q
d
⊥
⊥
⊥
=
= ∂
∂
=
0
2
2
0
0
2
3
4
ε
µ
π
,
.	
(6.70)
Expression  6.70 for arbitrary may be obtained in close form in Maple, but it 
is cumbersome. The first term of the expansion in powers of ε is
	
k⊥=
−
+
+
(
)
−
(
)
+
(
)
2
1
7
1
1
3
2
4
6
2
2
2
3
γ
γ
γ
γ
γ
γ
.	
(6.71)
Expressions  6.70 and 6.71 allow one to estimate stiffness k⊥ as a function 
of the parameter γ. This dependence is shown in Figure  6.5. Stiffness k⊥ is 
positive for γ  <   0.37 and then becomes negative.
Figure  6.6 plots the transverse stiffness against the displacement along the 
y- axis for γ  =  0.5 and γ  =  0.32 (q   =  3.5  A m, R   =  0.001  m, d   =  0.03  m). The value 
of the charge, q   =  3.5  A m, was obtained for B r    =   1.4  T and a   =  0.001  m. Here, a  
is small compared to the rotor radius and the rotor– magnet distance; accord-
ingly, the charge can be considered as a point charge.
The parameters of a suspension should be selected so that the rotor 
remains in the stable state under the action of inertial forces. Depending 

187
Force Characteristics of a Magnetic Suspension of an SC Sphere
on a particular application, one may want to maximize or minimize (as is 
required for accelerometers) stiffness. From Equation  6.71 and Figure  6.6, it 
follows that the stiffness achieves maximum at γ  =  0.32.
Stiffness also depends on the radius of the rotor. Expressing d  in 
Equations  6.70 and 6.71 in terms of R :
	
k
q
R
⊥=
+
(
)
+
−
(
)








µ
π
γ
γ
γ
0
2
3
6
2 3
2 2
4
2
2
1
1
1
,	
(6.72)
one may see that k⊥ is inversely proportional to the cube of a radius. Note 
that this dependence may not be obtained in simpler models with a quasi-
homogeneous approximation.
For longitudinal displacement, the potential energy is given by
0.1
0.2
0.3
0.4
g
k^
FIGURE  6.5 
Dependence lateral stiffness on the parameter γ.
W
ymax
F^
F^
K^
K^
W^
y
y
FIGURE  6.6 
Energy, transverse force, and stiffness for the cases γ  =  0.5 and γ  =  0.32.

188
Magnetic Sensors and Devices
	
W
q R
d
z
R
R
d
z
d
z
R
q
||
(
)
ln
(
)
(
)
=
−
−
−
−
−
−








+
µ
π
0
2
2
2
2
2
2
2
2
4
1
2
1
1
1
2
R
d
z
R
R
d
z
d
z
R
q R d
z
R
R
1
1
1
1
2
2
2
2
2
2
2
2
2
2
2
(
)
ln
(
)
(
)
ln
+
−
−
+
+
−






+
−
+
−
d
z
R
d
z
2
2
2
2
2
−
+
−







,
	
(6.73)
or, in the dimensionless form,
	
w
W
W
||
ln
=
=
−
(
) −
−
−
(
)
−
(
) −
+
+
(
) −




0
2
2
2
2
2
2
2
2
1
2
1
1
1
1
1
1
1
γ
ζ
γ
γ
ζ
ζ
γ
ζ
γ

−
+
(
)
+
(
) −
+
−
+
−
−
+
−



1
1
1
2
1
2
1
1
2
2
2
2
2
2
2
2
2
2
γ
ζ
ζ
γ
ζ
γ
γ
ζ
γ
ζ
ln
ln
,
	
(6.74)
where ζ = z
d
/
.
The respective expressions for the force and the stiffness are
	
f
F
F
|| =
=
−
−
−−
+
(
)
−
−
(
)
+
+
−

0
3
4
2
2
2
2
4
2
2
2
2
2
8
3
2
6
1
2
3
1
1
2
γ ζ
ζ
ζ
ζ γ
γ
γ
ζ
γ
ζ
ζ
γ
(
)
−
+
−
(
)
2
2
2 2
1
2ζ
ζ
γ
, 	
(6.75)
	
k
K
K
||
||
(
)
(
)
=
−
−
−
+




0
3
3
2 3
2 2
2
5
1
1
1
γ
γ
γ
γ
	
(6.76)
Expression  6.76 is valid for small and shows that longitudinal stiffness 
varies with the rotor radius as 1
3
/R . Again, the exact expression is too large 
to be presented here, but may be obtained in closed form in Maple. Figure  6.7 
plots longitudinal and transversal stiffness against γ, longitudinal stiffness 
is positive for any γ.
Thus, if γ  <   0.37, equilibrium at the point x   =  y   =  z   =0 is stable. From 
Figure  6.7, which compares the longitudinal and transverse stiffness, it is 
seen that the former exceeds the latter and is always positive. Therefore, it 
is the transverse stiffness that is a critical factor in choosing parameter γ. 
For opposite charges, equilibrium is unstable, since transverse stiffness k⊥ is 
negative for any γ.
If the rotor is subjected to gravitational or inertial forces F  (see Figure  6.8) 
along the z-axis, the equilibrium position shifts downward and the rotor 
would sag. The coordinates of a new equilibrium state are found from the 
expressions:

189
Force Characteristics of a Magnetic Suspension of an SC Sphere
	
F
F z
=
||(
),
0
	
(6.77)
	
mg =
−
−
−−
+
(
)
−
−
(
)
+
+
−
(
)
−
8
3
2
6
1
2
3
1
1
2
1
2
3
4
2
2
2
2
4
2
2
2
2
2 2
γ ζ
ζ
ζ
ζ γ
γ
γ
ζ
γ
ζ
ζ
γ
ζ
ζ
γ
+
−
(
)
2
2 2
0F , 	
(6.78)
0
0.1
0.2
0.2
k^
k||
g
0.4
FIGURE  6.7 
Longitudinal and transverse stiffness as a function of parameter γ.
z
Fll
y
z = z0
F
x
FIGURE  6.8 
Spherical sphere in the field of two poles displaced due to gravity.

190
Magnetic Sensors and Devices
where g  is the acceleration of gravity.
For a given R , d , and q  from Equation  6.78, one obtains the equilibrium 
point z 0 ; however, the stability of the new equilibrium position must be 
checked. The longitudinal stiffness is always positive; as to the transverse 
stability of the new equilibrium state, one must first obtain an expression 
for the energy at this point and then calculate the stiffness. For this purpose, 
we will take advantage of the general formula (Equation  6.66) for the energy 
with b
y
d
z
1
2
2
=
+
−
(
) , b
y
d
z
2
2
2
=
+
+
(
) , η12   =  2d , x   =  0. The dependence of 
energy W  on the coordinates z  and y  is shown in Figure  6.9. The second 
derivative of the energy with respect to y  at z   =  z 0  gives the stiffness. It is seen 
from Figure  6.9 that there is a critical longitudinal displacement, z cr  , at which 
the transverse stability is lost and the transverse stiffness becomes negative. 
The position of the critical point, z cr  , can be determined by solving the fol-
lowing equation in z :
	
∂
∂
=
=
2
2
0
0
W y z
y
y
( , )
. 	
(6.79)
The configuration presented in Figure  6.8 is stable at z 0   <   z cr  . A general 
solution to Equation  6.79 is impossible to find. Substituting particular val-
ues of parameters q , R , and d  (q   =  3.5  A m, d   =  0.03  m, and R   =  0.01  m), we 
find that z cr    =  ± 0.0025  m. It defines the minimum force leading to laterally 
unstable equilibrium.
6.6.4  Circular Magnet
As a final example, consider a superconducting sphere in the field of a cir-
cular magnet. In the absence of a superconductor, the magnetic field may 
–0.3
W
–0.2
–0.1 0
01
0.2
3
2
1
0
–1 –2 –3
FIGURE  6.9 
Dependence of energy on the coordinates z  and y .

191
Force Characteristics of a Magnetic Suspension of an SC Sphere
be easily calculated. Consider a circular magnet of length 2l  with an inter-
nal radius R 1  and an external radius R 2  (Figure  6.10). We will use again the 
notion of magnetic charge. A circular magnet may be modeled as a positive 
and a negative magnetic charge evenly distributed over the top and bottom 
of the magnet. Magnetic induction B  may be defined from the Coulomb law. 
Its components are
	
B
z
B
z
l
d
d
dz
z
l
z( , )
cos
ρ
π
ρ ρ θ
ρ
ρ
ρρ
θ
π
=
+
(
)
+
(
) +
+
+
(
)
0
1
1
1
1
2
2
1
2
1
1
32
0
2
4
2
∫∫
−
−
(
)
−
(
) +
+
+
(
)
R
R
B
z
l
d
d
dz
z
l
1
2
0
1
1
1
1
2
2
1
2
1
1
32
0
2
4
2
π
ρ ρ θ
ρ
ρ
ρρ
θ
π
cos
∫∫
R
R
1
2
,
	
(6.80)
	
B
z
B
d
d
z
l
cos
ρ ρ
π
ρ
ρ
θ
ρ ρ θ
ρ
ρ
ρρ
θ
,
cos
(
) =
−
(
)
+
(
) +
+
+
(
)
0
1
1
1
1
1
2
2
1
2
1
1
32
4
2
0
2
0
1
1
1
1
1
2
2
1
2
1
1
1
2
4
2
π
π
ρ
ρ
θ
ρ ρ θ
ρ
ρ
ρρ
θ
∫∫
−
−
(
)
−
(
) +
+
+
(
R
R
B
d
d
z
l
cos
cos
)
∫∫
32
0
2
1
2
π
R
R
,
	
(6.81)
where:
	B 0 	
    is remnant magnetization corresponding to the surface density of 
the magnetic charge
ρ, z 	
    are the coordinates of the point where magnetic induction is 
calculated
ρ1 , θ1 , z1  are the integration points
N
S
2l
R1
R2
Z
N
S
ρ
FIGURE  6.10 
Circular magnet.

192
Magnetic Sensors and Devices
The plots showing the axial and radial components of the magnetic 
induction, created by a circular magnet and their magnitudes (for R 1   =  3.5, 
R 2   =  4  cm, B 0   =  14000Gs ) are depicted in Figure  6.11a and b, respectively.
The magnets’  boundaries are marked by a dashed line. It can be seen that 
the magnitude of the axial component Bz  has a minimum near the mag-
net’ s surface: the first minimum is located in the point −
< −
z
l
0
, the second 
minimum is located in the point z
l
0 > . When the length of the magnet l  is 
increased, an additional minimum appears in the point z   =  0. Thus, the mag-
nitude of the axial component may have one or two minima depending on 
the length of the magnet. The magnitude of the radial component has a mini-
mum on the magnet’ s axis. In the points with coordinates ρ  =  0 and z   =  ± z 0 , 
quantity B  reaches minimum and equals 0.
Therefore, in the vicinity of the magnet’ s surface there exists an MPW, 
a region with a minimum of magnitude of magnetic induction. With an 
increase in the magnet’ s size, this minimum moves toward the plane of the 
magnet’ s pole.
When the magnet’ s length is increased, point z 0  is approaching the point 
z   =  l . If the magnet is long enough, then one can neglect the second term in 
Expressions  6.80 and 6.81 and assume that the magnetic field is created by 
a magnetic ring with a surface charge distributed with surface density B 0 . 
Figure  6.12 shows the components of a magnetic induction generated by a 
magnetic ring, that is, one pole of a circular magnet (a: transverse component 
and its magnitude; b: radial component and its magnitude). Here, the cen-
ter of the magnetic ring coincides with the origin of the coordinates. From 
Figure  6.12 it can be seen that B  reaches the plane of the ring on its axis; B  
reaches maximum in the points with coordinates z   =  ± z m  , and then reduces 
when z
zm
>
.
–15
–10
–5
–z0
z0
|Bz|
|Bz| , Bz
Bz
z
0
–200
–1,000
–5,000
5,000
10,000
–l
l
200
400
600
5
–4
–2
rho
ρ
Bρ
|Bρ|
|Bρ|, Bρ
4
10
15
2
(a)
(b)
FIGURE  6.11 
Axial and radial components of magnetic inductions of a circular magnet as functions of z  and 
ρ, respectively.

193
Force Characteristics of a Magnetic Suspension of an SC Sphere
For the stable confinement of a superconducting rotor in the magnetic 
field, it is necessary that its potential energy reaches minimum. The poten-
tial energy of a magnetic field is determined by the square of the magnetic 
induction. Due to the shape of a circular magnet, a region in the vicinity of 
the magnet exists where magnetic induction reaches minimum. Thus, we 
can expect that if we put a diamagnetic in this region, it will experience 
restoring forces, returning it to this region, and the diamagnetic body may 
be held both above and below the circular magnet. The latter does not seem 
possible due to the repulsive character of the magnetic force in a diamag-
netic. It is shown [55] that a superconducting sphere may be levitated below 
a circular magnetic ring.
We will calculate the energy of a spherical superconducting rotor in the 
field of a thin magnetic ring (Figure  6.13). A magnetic ring is considered to 
be thin if the difference between the external and internal radiuses is small 
compared to the internal radius, ρe    –  ρ i    ≪   ρ i  .
Assuming that the ring is formed by point magnetic charges evenly dis-
tributed along the circumference, we can use Expressions  6.33 and 6.62. 
Given a full charge distributed over the ring, it is easy to calculate the coeffi-
cients (Equation  6.62), the dependence of the energy on displacements along 
the symmetry axis, force, and stiffness.
These calculations were carried out in Maple. Figure  6.14a through c 
shows the dependencies of energy W , the longitudinal components of force 
F z  , and the stiffness k z   of the rotor in the field of the circular magnet for 
values R   =  1  cm, ρi    =  3.95  cm, ρe    =  4.05  cm, and q   =  280  A m for displacements 
along the symmetry axis Oz ; z   =  0 corresponds to the plane of the ring. From 
Figure  6.14, it can be seen that the stable confinement of the sphere in the 
–300
–15
–10
–5
5
10
–200
–100
0
100
200
300
–10
–8
–6
–4
–2
–zm
|Bz|, Bz
|Bz|
Bz
|Bρ|, Bρ⋅10−4
Bρ
|Bρ|
–ρm
ρm
ρ
–4
–2
2
4
zm
2
4
6
8
Z
FIGURE  6.12 
Axial and radial components of magnetic inductions of a magnetic ring as functions of z  and 
ρ, respectively.

194
Magnetic Sensors and Devices
absence of gravity is possible in the plane of the ring. The calculation of 
transversal stiffness using Equation  6.45 gives k
k
k
x
y
ρ =
=
= 52 800
,
  kg/s.
Coefficients Equation  6.62 are calculated only for the displacements along 
the symmetry axis and are not appropriate for calculating off-axis dis-
placements. More complete information may be obtained from coefficients 
Equation  6.61. They were used to obtain Expression  6.66, which in the limit 
transition allows the calculation of energy for distributed sources. After 
transition from summation to integration, we will have
	
W
B
R
b b
l
l
R
b b
P
l
l
l
i
e
=
+






(
)
∑
∫∫∫
1
2
1
0
2
1
2
1 2
2
1 2
12
0
2
0
2
ρ ρ
θ
π
π
ρ
ρ
cos
ρ
ρ
ϕ ϕ
ρ ρ
i
e
d
d
d
d
∫
1
2
1
2. 	 (6.82)
–10
(a)
(b)
(c)
–5
0
2
4
6
8
10
12
14
16
18
W⋅10−4
Fz⋅10−4
5
10 z
–20
–10
0
10
20
–2
–4
–6
–8
–10
2
4
6
8
–10 –8 –6 –4 –2 0
5
5
10
2
4
6
8 10
10 z
z
z0
kz⋅10−4
FIGURE  6.14 
Dependence of energy, force, and stiffness on the z  coordinate.
η
ξ
ζ
R
z
r⃗
ρ⃗
ρi
ρe
x
y
FIGURE  6.13 
Superconducting sphere in the field of a magnetic ring.

195
Force Characteristics of a Magnetic Suspension of an SC Sphere
The results of calculations using Expression  6.82 are presented in 
Figure  6.15 for the values R   =  1  cm, ρi    =  3.0  cm, ρe    =  4.0  cm, and q   =  280  A· m.
Taking into account the gravity or inertia force along Oz  would cause a 
shift of the equilibrium position to the point z e   (Figure  6.16), which is deter-
mined from the equilibrium condition:
	
F
dW z
dz
g
z ze
−
=
=
( )
.0 	
(6.83)
If stiffness is positive in this point, that is, condition z
z
e <
0  is satisfied, 
then a new equilibrium state will be stable. From Figure  6.16, one can see 
that the stable confinement of a rotor is possible both above and below the 
magnet, despite the repulsive character of the magnetic force. Forces from 
the first magnet previously considered are reaching 1  N and allow the hold-
ing of an in-field mass up to 100  g.
0
5
10
15
20
W⋅10–6
z
z
z0
z
Fz⋅10–6
kz⋅10–6
2
4
6
8
10
12
–12
–10
–10
–5
0
2
4
6
8
10
12
5
10
15
20
–8
–10
–4
–2
0
2
2
4
6
8
10
12
4
6
(a)
(b)
(c)
FIGURE  6.15 
Energy, axial force, stiffness, and functions of the z  coordinate calculated using Expression  6.82.
FZ⋅10−4
FZ
–Fg
–20
–15
–10
–5
5
Ze
Z
2
4
6
8
10
10
FIGURE  6.16 
Magnetic force, force of gravity, and equilibrium position.

196
Magnetic Sensors and Devices
6.7  Conclusions
We presented a model to calculate the interaction energy between a supercon-
ducting sphere and a supporting magnetic field generated by a system of mag-
netic charges or current loops. In some important cases, these sums may be 
converted to simple closed-form analytical expressions. This approach allows 
us to consider different configurations of sources, to find lifting forces and 
stiffness, and to look for the source distributions providing the desired force 
characteristics of the suspension, and provides a means to analytically study 
dynamics and a superconducting spherical and close to spherical body in the 
field generated by a system of magnetic charges or coaxial current loops.
References
	
1.	 J. R. Hull, Using high-temperature superconductors for levitation applications, 
JOM , 51(7), pp. 13– 18, 1999.
	
2.	 K. B. Ma, Y. V. Postrekhin, and K. K. Chu, Superconductor and magnetic levita-
tion devices, Review of Scientific Instruments , 74(12), pp. 4989– 5017, 2003.
	
3.	 F. C. Moon, Superconducting Levitation , Wiley, Weinheim, 2004.
	
4.	 R. Moser, J. Sandtner, and H. Bleuler, Diamagnetic suspension system for small 
rotors, Journal of Mechatronics , 1(2), pp. 131– 137, 2001.
	
5.	 L. Rossini, O. Chetelat, E. Onillon, and Y. Perriad, Force and torque analytical 
models of a reaction sphere actuator based on spherical harmonic rotation and 
decomposition, IIIE/ASME Transactions on Mechatronics , 18(3), pp. 1006– 1018, 
2013.
	
6.	 G. C. Schroll, Design of a spherical vehicle with flywheel momentum storage 
for high torque capabilities, Thesis for Bachelor Degree, MIT, 2008.
	
7.	 B. P. Mann and N. D. Sims, Energy harvesting from the nonlinear oscillations 
of magnetic levitation, Journal of Sound and Vibration , 319, pp. 515– 530, 2009.
	
8.	 M. E. Hoque and T. Mizuno, Magnetic levitation technique for active vibration 
control, in B. Polajzer (Ed.), Magnetic Bearings, Theory and Applications , Chapter 
4, InTech, 2010.
	
9.	 Y. Zhu, Q. Li, D. Xu, C. Hu, and M. Zhang, Modeling and analysis of a negative 
stiffness magnetic suspension vibrator isolator with experimental investiga-
tions, Review of Scientific Instruments , 93, 095108, 2012.
	 10.	 J. Szekely, E. Schwartz, and R. Hyers, Electromagnetic levitation: A useful tool 
in microgravity research, JOM , 47(5), pp. 50– 53, 1995.
	 11.	 M. J. A. Moes, J. C. Gielen, R.-J. Bleichrodt, J. W. A. van Loon, P. C. M. Christianen, 
and J. Boonstra, Simulation of microgravity by magnetic levitation and random 
positioning: Effect on human A431 cell morphology, Microgravity Science and 
Technology , 23(2), pp. 249– 261, 2011.
	 12.	 B. E. Hammer, L. S. Kidder, P. C. Williams, and W. W. Xu, Magnetic levita-
tion of MC3T3 osteoblast cells as a ground-based simulation of microgravity, 
Microgravity Science and Technology , 21(4), pp. 311– 318, 2009.

197
Force Characteristics of a Magnetic Suspension of an SC Sphere
	 13.	 C. E. Dijkstra et al., Diamagnetic levitation enhances growth of liquid bacterials 
cultures by increasing oxygen availability, Journal of the Royal Society Interface , 
8(56), pp. 334– 344, 2010.
	 14.	H. Minagawa et al., Control of levitation in electromagnetic levitators under 
microgravity, Japanese Journal of Applied Physics, 35(Pt. 2 No. 12B, L1714), 
1996.
	 15.	 H. Chetouani, C. Jeandey, V. Haguet, H. Rostaing, C. Dieppedale, and G. Reyne, 
Diamagnetic levitation with permanent magnets for contactless guiding and 
trapping of microdroplets and particles in air and liquids, IEEE Transactions on 
Magnetics  42(10), pp. 3557– 3559, 2006.
	 16.	 P. Kaufmann, P. Pham, A. Masse, M. Kustov, T. Honegger, D. Peyrade, V. Haguet, 
and G. Reyne, Contactless dielectrophoretic handling of diamagnetic levitating 
water droplets in air, IEEE Transactions on Magnetics , 46(8), p. 201, 2006.
	 17.	 J. Castillo, M. Dimaki, and W. E. Svendsen, Manipulation of biological samples 
using micro and nano techniques, Integrative Biology , 1, pp. 30– 42, 2009.
	 18.	 T. Inamori and S. Nakasuka, Application of magnetic sensors to nano and 
micro-satellite attitude control systems, in K. Kuang (Ed.), Magnetic Sensors: 
Principles and Applications , InTech, 2012, pp. 85–102.
	 19.	 W. Braunbeck, Freischwebende Korper im elektischen und magnetischen Feld, 
Z. Phys.  112, p. 753, 1939.
	 20.	 H. Austin and K. T. McDonald, Diamagnetic Levitation , Joseph Henry 
Laboratories, Princeton University Communication, Nov. 15, 2001.
	 21.	 R. Perline, Diamagnetic levitation, American Scientist , 92(5), pp. 428– 435, 2004.
	 22.	 M. D. Simon and A. K. Geim, Diamagnetic levitation: Flying frogs and floating 
magnets, Journal of Applied Physics , 87(9), pp. 6200– 6204, 2000.
	 23.	 Y. M. Urman et al., On levitation of diamagnetic bodies in a magnetic field, 
Technical Physics,  55(9), pp. 1257– 1265, 2010.
	 24.	 M. D. Simon, L. O. Heflinger, and A. K. Geim, Diamagnetically stabilized mag-
net levitation, American Journal of Physics , 69(6), pp. 702– 713, 2001.
	 25.	 V. S. Mikhalevich, V. V. Kozorez, V. M. Rashkovan, et al., Magnetic Potential Well: 
The Effect of Stabilization of Dynamic Superconducting Systems , Naukova Dumka, 
Kiev, 1991 [in Russian].
	 26.	 S. Kuznetsov, and J. K. Guest, Topology optimization of magnetic source distri-
butions for diamagnetic and superconducting levitation, Journal of Magnetism 
and Magnetic Materials,  438, pp. 60– 69, 2017.
	 27.	 Y.M. Urman, and V. V. Novikov, Effect of elasticity on the dynamics of a super-
conducting rotor rotating in a magnetic field, Journal of Applied Mechanics and 
Technical Physics , 42(3), pp. 518– 522, 2001.
	 28.	 M. V. Berry and A. K. Geim, Of flying frogs and levitrons, European Journal of 
Physics , 18, pp. 307– 313, 1997.
	 29.	 S. I. Kuznetsov and Y. M. Urman, Levitation of a superconducting body in the 
field of N  magnetic poles, Technical Physics , 51, pp. 297– 306, 2006.
	 30.	 S. I. Kuznetsov, A. O. Malkhanov, and Yu. M. Urman, Effect of periodic shape 
changes in the shape of a superconducting body on its dynamics in a noncon-
tact magnetic suspension, Technical Physics , 53(12), pp. 1529– 1535, 2008.
	 31.	 Y. M. Xiao et al., Observation of the London moment and trapped flux in precision 
gyroscopes, IEEE Transactions on Applied Superconductivity , 3(1), pp. 2144, 1993.
	 32.	 Y.M. Urman, Method of irreducible tensors in problems of evolution motions of 
a rigid body with a fixed point, Mechanics of Solids , 4, pp. 10– 20, 1997.

198
Magnetic Sensors and Devices
	 33.	 Y.M. Urman, Method of irreducible tensors in problems of rotation of a conduc-
tive body in nonuniform magnetic fields, Mechanics of Solids , 36(2), pp. 8– 15, 
2001.
	 34.	 Y.M. Urman, Irreducible tensors and their application in problems of dynamics 
of solids, Mechanics of Solids , 42(6), pp. 52– 68, 2007.
	 35.	 J. D. Jackson, Classical Electrodynamics , 3rd ed., Wiley, New York, 1999.
	 36.	 I. V. Veselitskii and Y. M. Urman, Integral representation of inductance for the 
system superconducting sphere-current coils, Sov. Phys. Tech. Phys ., 24, 881, 
1979.
	 37.	 Y.M. Urman, Theory for the calculation of the force characteristics of an elec-
tromagnetic suspension of a superconducting body, Technical Physics , 42(1), pp. 
1– 6, 1997.
	 38.	 Y.M. Urman, Calculation of the force characteristics of a multi-coil suspension 
of a superconducting sphere, Technical Physics , 42(1), pp. 7– 13, 1997.
	 39.	 V. E. Plehanov, A. I. Chernomorkiy, and K. B. Yakovlev, Numerical calcula-
tions of spherical contactless suspension, in A.V. Remnikov (Ed.), Systems 
for Orientation and Navigation and Their Elements , Moscow Aviation Institute, 
Moscow, 1979, pp. 118– 122 [in Russian].
	 40.	 S. A. Kostrykov, V. V. Peshkov, and G. E. Shunin, Finite elements method in the 
computer modeling of superconducting screens and suspensions, Bulletin of the 
Russian Academy of Sciences: Physics ,  61(5), pp. 985– 989.
	 41.	 G. E. Shunin et al., FEMPDESolver 2.0 software package for finite-element 
analysis of superconducting current systems, Bulletin of the Russian Academy of 
Sciences: Physics ,  68(7), pp. 1172– 1180, 2004
	 42.	 Y. S. Ermolaev and I. A. Rudnev, A method to calculate levitation force in the 
system magnet-superconductor, Letters to Technical Physics , 31(24), pp. 60– 66, 
2005
	 43.	 L. I. Bataronov, S. A. Kostrykov, V. V. Peshkov, and G. E. Shunin, Computer 
modeling of spherical superconducting suspension,, Bulletin of the Russian 
Academy of Sciences: Physics , 70(8), 2006
	 44.	 M. I. Bataronova, S. A. Kostrykov, V. V. Peshkov, and G. E. Shunin, Computer 
modeling of superconducting systems using finite elements method, Bulletin of 
the Voronezh State Technical University , 3(8), 2007
	 45.	 G. E. Shunin, S. A. Kostrykov, V. V. Peshkov, and M. I. Islentieva, The devel-
opment of the system of superconducting suspension computer simulation, 
Bulletin of Voronezh State Technical University , 10(1), pp. 21– 26, 2014
	 46.	 L. D. Landau and E. M. Lifshitz, Electrodynamics of Continuous Media  (Volume 
8 of A Course of Theoretical Physics), Butterworth and Heinemann, Oxford, 
1984.
	 47.	 A. N. Tverdokhlebov and A. L. Shuster, A sphere in an arbitrary quasistatic 
electric or magnetic field, Journal of Technical Physics , 42(9), pp. 2477– 2484, 1972 
[in Russian].
	 48.	 D. A. Varshalovich et al., Quantum Theory of Angular Momentum , World 
Scientific, Singapore, 1988.
	 49.	 Yu. M. Urman, To the Calculation of Force Characteristics of External Spherical 
Suspension of Cryogenic Gyroscope, Izv. Vyssh. Uchebn. Zaved., Priborostroenie , 
8(72), pp. 72– 74, 1973 [in Russian].
	 50.	 D. Skubov and K. Khodzaev, Non-Linear Electromechanics , Springer, Berlin 
Heidelberg, 2008.

199
Force Characteristics of a Magnetic Suspension of an SC Sphere
	 51.	 L. D. Landau and E. M. Lifshitz, Mechanics  (Volume 1 of A Course of Theoretical 
Physics), Butterworth-Heinemann, Oxford, 1976.
	 52.	 K. P. Belov, Rare-Earth Magnets and Their Applications , Nauka, Moscow, 1980 [in 
Russian].
	 53.	 Pyatin, Yu. M. (Ed.), Permanent Magnets: A Handbook , Energiya, Moscow, 1980 
[in Russian].
	 54.	 W. R. Smythe, Static and Dynamic Electricity , 2nd ed., McGraw-Hill, New York, 
1950.
	 55.	 S. I. Kuznetsov and Yu. M. Urman, On the possibility of levitation of supercon-
ducting sphere in the field of circular magnet, Bulletin of N. I. Lobachevsky State 
University of Nizhny Novgorod . Series: Mechanics, 1(7), pp. 5– 14, 2006.


201
7
Magnetic Angle Sensors
Udo Ausserlechner
ABSTRACT: For many industrial and automotive applications, one needs to 
measure the absolute rotational position of a shaft with an accuracy of about 
1° , a resolution of 0.1° , and costs of a few euros. Examples are headlight level-
ing (120° stroke), throttle valve position (120° stroke), motor commutation and 
torque control (360° range), cam shaft and cam phaser angle sensing, steering 
wheel (10*360° range), and rotational vibration damping (20*360° range) [1]. 
Although some of these applications can also be served by potentiometers 
and optical, capacitive, and inductive angle sensors, a major group of applica-
tions calls for magnetic angle sensors [2]. They are small, their installation 
requires only moderate assembly tolerances, they are free of wear, they are 
robust against dirt and pollution, they are also sufficiently robust against 
electromagnetic interference, they are fast, and they are economic.
CONTENTS
7.1	
Scope of This Chapter................................................................................202
7.2	
Technologies of Magnetic Field Sensing Elements................................203
7.2.1	 Magnetoresistors.............................................................................204
7.2.2	 Hall Effect Devices.........................................................................209
7.2.3	 Comparison of Technologies for Magnetic Angle Sensing 
Devices............................................................................................. 211
7.3	
Assembly Tolerances and Sensor Offset, Gain Mismatch, and 
Misalignment.............................................................................................. 216
7.3.1	 Assembly Tolerances, Offset, Gain Mismatch, and 
Misalignment in GMRs/TMRs����������������������������������������������������224
7.3.1.1	 Autocalibration of GMR Angle Sensors for 
Continuously Rotating Shafts���������������������������������������231
7.3.2	 Assembly Tolerances, Offset, Gain Mismatch, and 
Misalignment in AMRs, VHalls, and HHalls with IMC���������236
7.4	
Field-Gradient Angle Sensors...................................................................237
7.5	
Magnets for Magnetic Angle Sensors...................................................... 241
References .............................................................................................................246

202
Magnetic Sensors and Devices
7.1  Scope of This Chapter
For many industrial and automotive applications, one needs to measure the 
absolute rotational position of a shaft with an accuracy of about 1° , a resolu-
tion of 0.1° , and costs of a few euros. Examples are headlight leveling (120°  
stroke), throttle valve position (120°  stroke), motor commutation and torque 
control (360°  range), cam shaft and cam phaser angle sensing, steering 
wheel (10*360°  range), and rotational vibration damping (20*360°  range) [1]. 
Although some of these applications can also be served by potentiometers 
and optical, capacitive, and inductive angle sensors, a major group of appli-
cations calls for magnetic angle sensors [2]. They are small, their installation 
requires only moderate assembly tolerances, they are free of wear, they are 
robust against dirt and pollution, they are also sufficiently robust against 
electromagnetic interference, they are fast, and they are economic. This is 
the type of angle sensor that we will discuss in the following. We limit the 
discussion to the position detection of a shaft where magnetic fields of the 
order of 40  mT are used. Hence, weak-field sensors, such as compass sen-
sors [3] and navigation via magnetic fields [4], and very small angle strokes 
as in torque meters [5] are excluded. The latter uses large ferrous structures 
that collect magnetic flux from a permanent magnet depending on the rota-
tional position and guide this flux to a magnetic field sensor (e.g., Hall plate). 
Some throttle valve position sensors use similar macroscopic flux guides to 
measure angles with strokes of 100° – 160°  [2]. We exclude such sensors with 
macroscopic flux guides from our discussion. We also skip the discussion of 
incremental angle sensors that are in widespread use in anti-lock braking 
systems (ABS) and for transmission-, crank-, and cam-angle sensors [6,7].
We consider angle sensors according to Figure  7.1: they have a permanent 
magnet attached to a rotatable shaft. Through-shaft sensors have a long 
shaft whose ends are not accessible to the sensor. Thus, a ring magnet has 
to be slipped over the shaft. If an end of the shaft can be used to mount a 
magnet, we call this an end-of-shaft sensor . In general, the best performance 
is obtained if we drill a hole into the end of the shaft to accommodate the 
magnet— this is called an in-shaft sensor . End-of-shaft sensors may have 
Shaft
Ring magnet
Sensor 
package
Printed circuit board
Shaft
Ring
magnet
Sensor 
package
Printed 
circuit 
board
Shaft
Puck
magnet
Sensor 
package
Printed 
circuit 
board
FIGURE  7.1  
Three types of magnetic angle sensors: through-shaft, in-shaft, end-of-shaft. Parts of the in-
shaft sensor are cut off to give a view of the sensor package.

203
Magnetic Angle Sensors
small, simple, and cheap magnets in the shape of blocks (parallelepipeds) 
or short cylinders (like a puck). In-shaft sensors preferably use small ring 
magnets, and through-shaft sensors need rather large ring magnets, which 
are more expensive to manufacture. Figure  7.2 gives a classification scheme 
of these common magnetic angle sensors.
In most practical cases, the shaft is ferrous; a soft-magnetic material with 
a large relative permeability of µ r    >   100, typically on the order of 1000– 2500. 
Therefore, the shaft interacts with the magnet and distorts its magnetic field. 
Moreover, the shaft also interacts with external magnetic disturbance fields, 
which can be an advantage or a drawback.
End-of-shaft and in-shaft sensors may use single sensor packages with sin-
gle sensor chips, because they need to sample the magnetic field only in a sin-
gle spot right on the rotation axis or in the immediate vicinity (± 2  mm) around 
the rotation axis. Through-shaft sensors usually need two, three, or more sen-
sor packages because they have to measure the field on a concentric reading 
circle around the shaft. Thus, through-shaft sensors are more challenging as 
they have larger magnets and more sensor packages and these increase the 
system’ s costs. Due to space limitations, we will only touch on them here.
7.2  Technologies of Magnetic Field Sensing Elements
The rotating magnetic field has to be detected by magnetic field sensing 
elements. There are several competing sensor technologies such as vari-
ous types of magnetoresistors (MR) and Hall effect devices (Figure  7.3). 
Often, commercial suppliers specialize in a specific technology and tend to 
Magnetic angle sensors (w/o macroscopic flux guides) 
Through-shaft
End-of-shaft 
Ring 
magnet 
Block/puck 
magnet 
Gear based 
In-shaft
Multi-turn 
nonius 
Dipole 
(diam.)
Quadrupole 
(axial magn.) 
Multi- 
pole 
Halbach 
(int. dipole)
Ferrous target 
+ bias magnet 
Dipole 
(axial)  
FIGURE  7.2  
Classification scheme of common magnetic angle sensor systems.

204
Magnetic Sensors and Devices
overemphasize the advantages of their proprietary one. Only a few compa-
nies are in the luxurious position to offer many kinds of sensor technolo-
gies. With the experience he has gained in one such company, the author has 
come to the conclusion that the differences in the various sensor technolo-
gies for angle sensors matter less than generally presumed. This is sketched 
in the subsequent introduction to these sensor technologies followed by a 
comparison of their pros and cons with respect to angle sensors.
7.2.1  Magnetoresistors
Magnetoresistance (MR) is generally defined as the change of electrical resis-
tance in a material caused by a magnetic field.
	
MR =
−
R
R
R
max
min
min
	
(7.1)
R max  and R min  are the maximum and minimum observed resistances, respec-
tively. The anisotropic MR (AMR) was first observed in 1857 [8]. It takes place 
in a thin sheet— the free layer— made of a ferromagnetic metal such as Ni, 
Co, or Fe. In practice, one prefers permalloy, an alloy of 81% Ni and 19% 
Fe, because there the magnetostrictive constant vanishes and this makes the 
resistance independent of mechanical stress. In the absence of an applied 
magnetic field, the magnetization in the thin free layer should be homoge-
neous (“ single domain particle” ) and it is aligned along an easy axis. The 
easy axis is defined by the geometry of the device via the so-called shape 
anisotropy: in permalloy it is along the longest dimension of the sample. 
MRs are very thin (~30  nm). Their thickness is much lower than the lateral 
(x ,y )-dimensions and so the lateral dimensions define the sensitive plane, 
which is identical to the main surface of the substrate to which the AMRs 
are sputtered and which we call the (x ,y )-plane. As a consequence of shape 
anisotropy, their magnetization is parallel to the (x ,y )-plane and the applied 
magnetic field only rotates the magnetization in this (x ,y )-plane. Therefore, 
Magnetic angle sensor technologies
Strong-field MR
Hall
AMR
GMR
TMR
HHall+IMC
VHall
MAGFET
HHall
HHall+VHall
field-gradient angle sensors
perpendicular field angle sensors
FIGURE  7.3  
The most common sensor technologies used for magnetic angle sensors.

205
Magnetic Angle Sensors
MRs respond only to the in-plane component of the applied magnetic field 


 



B
B
B n
n
B n
B n
z
z
x
x
y
y
in-plane =
−
⋅
(
)
=
+
. If an external magnetic field is applied to 
the MR and points in a direction different from the easy axis, it tries to pull 
out the magnetization from its easy axis. In strong-field angle sensors , the field 
is much stronger than the lateral shape anisotropy so that the magnetization 
points essentially in the same direction as the applied field. Then, the resis-
tance of the free layer depends on the angle φ  between the applied in-plane 
field component and the current streamlines according to
	
{
}
(
)
=
+
ϕ
=
+
+
−
+
ϕ


=
+
ϕ
−
R
R
MR
R
R
R
R
R
R
R
h
h
1
cos
2
1
cos(2 )
1
2 cos(2 )
1
/2
(AMR)
min
(AMR)
2
max
min
max
min
max
min
min
	 (7.2)
So, the resistance is at maximum when the magnetization direction is parallel 
to the current flow and it is at minimum when the magnetization direction is 
orthogonal to the current flow. The resistance does not change if one swaps 
the polarity of the current and/or the magnetic field— the φ -periodicity is 
180° . Therefore, simple* AMR angle sensors cannot discriminate rotational 
positions ϕ against ϕ +
°
180 — they are unambiguous only within an angular 
stroke of 180° . In the following, we replace R
R
R
R
h
max
min
max
min
−
(
)
+
(
) →
2. 
It holds that h =
+
(
)
2
2
MR
MR  and we call this the magnetic stroke  or the 
magnetic sensitivity . The AMR effect is MR
AMR
(
) =
≅
0 025
.
h  for a 30  nm thick 
permalloy film and it decreases for thinner layers [10]. In commercial devices, 
layout restrictions and wiring reduce this value by about 10%.
Giant MR (GMR) was discovered in the mid-1980s. In GMRs, several ferro-
magnetic regions (Co or Fe) with different directions of magnetization are closer 
together than a certain critical length (the mean free path of the spin of the con-
duction electrons or their spin diffusion length). Therefore, the electrons do not 
change their spin when they traverse these regions, which are usually thin lay-
ers. Each time an electron crosses a region with magnetization anti-parallel to 
its spin, it is scattered much more than if the magnetization were parallel to its 
spin. More scattering means higher electrical resistance. In multilayer GMRs, 
several ferromagnetic layers are magnetized with alternating polarity at a zero 
applied magnetic field. Therefore, spin-up and spin-down electrons are scat-
tered in every second layer. If a sufficiently strong magnetic field is applied, it 
pulls the magnetizations of all layers in the same direction. Then, the electrons 
*	 Some commercial suppliers offer advanced sensor systems where integrated coils superim-
pose additional magnetic fields on the AMRs [9]. From the changes of signals induced by 
these superimposed fields, they can discriminate rotational positions φ  against φ   +  180° . 
Other systems add Hall sensors to discriminate φ  against φ   +  180° . Their intention is to 
use AMR technology to measure full 360°  rotations, because in the past AMR technology 
achieved the highest angle accuracy at the highest bandwidth.

206
Magnetic Sensors and Devices
with their spin parallel to this common direction have no scattering while the 
other electrons are scattered in each ferromagnetic layer, and this reduces the 
overall resistance. The alternating direction of magnetization in neighbor-
ing layers at zero external field can be obtained by non-magnetic spacer lay-
ers in-between (Au, Cr, Cu). The thickness of these spacer layers determines if 
the two magnetization directions are parallel or anti-parallel at zero field [11]. 
The strength of this ferromagnetic or anti-ferromagnetic coupling can be var-
ied via thickness according to theory (oscillatory RKKY exchange coupling). 
For specific thicknesses of the spacer layer, the coupling between neighboring 
ferromagnetic layers even vanishes. This is used in spin valve angle GMRs, 
where one ferromagnetic layer (“ hard”  or “ pinned”  or “ reference”  layer) has a 
fixed reference magnetization while the magnetization of the other layer is free 
to follow the applied magnetic field (“ soft”  or “ free”  or “ sensing”  layer) [12]. 
The direction of magnetization of the pinned layer is defined by a so-called 
exchange bias coupling to an anti-ferromagnet, which usually comprises one 
layer next to the pinned layer. The anti-ferromagnet is magnetized by a strong 
external field (in the range of 1  T) at an elevated temperature (> 200° C) during 
the fabrication of the GMR. Spin valve GMRs have fewer layers and therefore 
they are cheaper to manufacture but they have lower MR ratios than multilayer 
GMRs. With spin-valve GMRs, one can make sensors, which are sensitive to the 
strength of an applied field (so-called weak-field sensors) or to the direction of 
an applied field (so-called strong-field or saturated sensors):
	
1.	In weak-field sensors, the free layer is designed to have an anisot-
ropy perpendicular to the direction of the pinned layer magnetiza-
tion. This means that at zero external field, the magnetization of the 
free layer is at a right angle (90° ) to the magnetization of the pinned 
layer. The anisotropy can be defined by the elongated shape of the 
free layer, or by its growth conditions, or by an anneal in a magnetic 
field. Then, for small applied fields, the resistance varies linearly 
around zero field. For larger applied fields, the magnetization of the 
free layer is parallel (+Hk) or anti-parallel (– Hk) to the pinned layer. 
This type of GMR is not used for the types of magnetic angle sensors 
that we are discussing in this chapter.
	
2.	In strong-field sensors, the free layer is designed to have zero anisot-
ropy so that its magnetization can freely follow a rotating applied 
field. On the other hand, it is necessary for the applied field to be con-
tinuously present during operation, otherwise the magnetization of 
the free layer is undefined. If the applied field is present, but too weak, 
the magnetization of the free layer may not be perfectly parallel to the 
applied field, because it may be trapped by small imperfections. This 
will lead to hysteresis when the rotation direction is reversed.
In GMRs, the non-magnetic spacer is a metal while in tunneling MRs 
(TMRs) it is a dielectric sufficiently thin for tunneling current. Due to the 

207
Magnetic Angle Sensors
tunneling effect, TMRs have different temperature coefficients and they 
are electrically nonlinear (therefore, they are often called magnetic tunnel 
junctions [MTJs] instead of resistors). They have their maximum sensitivity 
at low voltage (< 100  mV). Therefore, one has to connect many elements in 
series for common supply voltages of several volts. Since the tunnel junc-
tion generates notable excess noise, one may reduce the effective resistance 
by the parallel connection of several elements. In the end, this leads to TMR 
angle sensors, which are not much smaller than AMR/GMR angle sensors. 
In a spin-valve GMR/TMR, the resistance changes as a function of angle 
φ  between the magnetizations of free and pinned layers [13], whereby in 
strong-field angle GMR/TMRs the free layer magnetization very accurately 
points in the same direction as the applied magnetic in-plane field.
	
R
R
R
R
R
R
R
GMR
GMR
MR
(
)
(
)
=
+
−


=
+
−
−
min
max
min
max
min
ma
cos
1
1
2
2
1
ϕ
x
min
min
cos
cos
+


=
−
−
R
R
h
h
ϕ
ϕ
1
2
1
2
	
(7.3a)
The literature also states that in TMRs the conductance instead of the resis-
tance varies with cos  φ  [13].
	
R
R
R
R
R
R
TMR
TMR
TMR
MR
MR
(
)
(
)
(
)
=
+
+
+
=
+
+
min
max
min
max
min
cos
1
1
1
2
2
1
1
ϕ
R
R
R
R
R
h
h
max
min
max
min
min
cos
cos
−
+
=
+
+
ϕ
ϕ
1
2
1
2
	
(7.3b)
For angle sensors, the difference between Equations 7.3a and 7.3b is irrelevant, 
because both cases give the same output signal of a typical Wheatstone bridge 
as in Figure  7.6. In both cases, the resistance is at a minimum when the mag-
netization vectors in the free layer and in the pinned layer are parallel (φ   =  0° ). 
The resistance is at a maximum when the magnetization vectors in the free 
layer and in the pinned layer are anti-parallel (φ   =  180° ). The resistance of a 
single GMR/TMR has a 360°  periodicity. Therefore, GMR/TMR angle sen-
sors can measure the direction of an applied magnetic field unambiguously 
within an angular stroke of 360° . A typical sensitivity for strong-field angle 
GMRs is MR
GMR
(
) =
≅
0 04
.
h  and for strong-field angle TMRs a value of 
MR(TMR)   =  0.86  (h   =  0.6) is reported in [14]. Hence, the output signals of AMR, 
GMR, and TMR scale as 1:1.8:27, but the angle resolution of TMRs is only 
approximately 10 times better than for AMRs (cf. Table  7.1). The AMR effect is 
also present in GMR/TMR devices and should be eliminated in practice [15,16].

208
Magnetic Sensors and Devices
TABLE  7.1  
Comparison of “Ex Fab”  (i.e., Uncalibrated) Key Parameters of Common Magnetic Angle Sensor Technologies
AMR 
GMR 
TMR 
HHall 
HHall with IMC 
VHall 
Angle range 
180° 
360° 
360° 
360° 
360° 
360° 
Magnetic sensitivity 
h   =  0.022
h   =  0.04
h   =  0.6
Su   =  51  mV/V/T
Su   =  255  mV/V/T
Su   =  40  mV/V/T
Peak signal amplitude  at 2  V supply
22  mV
40  mV
600  mV
4.6  mV for 
B   =  45  mT
23  mV for 
B   =  45  mT
3.6  mV for 
B   =  45  mT
Impedance  per sin/cos-channel
1  kOhm
1  kOhm
1  kOhm
1  kOhm
1  kOhm
1  kOhm
Thermal noise  (rms) at 300  K per 
channel
4.07  nV/sqrt 
(Hz)
4.07  nV/sqrt 
(Hz)
4.07  nV/sqrt 
(Hz)
4.07  nV/sqrt 
(Hz)
4.07  nV/sqrt (Hz)
4.07  nV/sqrt (Hz)
Flicker noise 
x
x
xx(!)
0
0
0
Standard deviation of angle noise  for 
150  kHz corner frequency of 
first-order low-pass filter including 
signal conditioning (NF  =  1)
0.0036° 
+x
0.0040° 
+x
0.0003° 
+ xx(!)
0.0349° 
0.0070° 
0.0445° 
Standard deviation of signal offset  
per channel
0.33  mV
0.67  mV
1.7  mV
30  µ T
30  µ T
100  µ T… 30  µ T 
(stacked+parallel)
Standard deviation of angle error 
due to signal offset 
0.43° 
0.95° 
0.16° 
0.04° 
0.04° 
0.14° … 0.04°  
(stacked+parallel)
Worst-case (=6 sigma) gain mismatch 
error  of sin/cos-channels
0.5%
=0.07° 
3%
=0.85° 
1%
=0.29° 
1%
=0.29° 
2%
=0.57° 
1%
=0.29° 
Worst-case (=6 sigma) orthogonality 
error  of sin/cos-channels
0° 
3° 
2° 
0° 
3° 
0.5° 
Hysteresis error 
0.05° 
0.05° 
0.05° 
0° 
0.05° 
0° 
Worst-case anisotropy/nonlinearity 
errors  over temperature and lifetime
0.11° 
0.4° 
0.3° 
< 0.01° 
< 0.1° 
< 0.01° 
Note: 	 The values given do not refer to real products, but denote sound limits that can be achieved by optimized design with state-of-the-art 
technology.

209
Magnetic Angle Sensors
7.2.2  Hall Effect Devices
The discovery of the Hall effect dates back nearly as far as the AMR 
effect [17]. Semiconductor Hall plates have been widely used in indus-
trial applications since the 1950s and they have been integrated into sili-
con application-specific integrated circuits (ASICs) since the 1970s. In the 
1990s, complementary metal-oxide semiconductor (CMOS) technology 
was mature enough to implement the spinning current principle on-chip 
[18], which greatly improved the initial or raw offset of silicon Hall plates 
of around 2– 5  mT (standard deviation) down to the residual offset of spin-
ning current Hall plates of around 5– 50  µ T (standard deviation). Finally, 
in the last decade, the long-term drift of their magnetic sensitivity induced 
by mechanical stress was pushed well below 1% by stress compensa-
tion circuits [19]. Hence, silicon Hall plates are a very well understood 
technology.
In silicon technology, Hall plates are simple tubs with low n -doping, 
roughly 50  ×   50  ×   1  µ m large, with four contacts regularly spaced around 
the perimeter of the tub. Electric current flows through two diametrically 
opposite contacts and the voltage is tapped between the other two contacts. 
The symmetrical placement of the output contacts ideally gives no voltage 
between them in the absence of a magnetic field. If a magnetic field is applied 
perpendicular to the Hall plate, a Lorentz force acts on the majority carriers 
in the Hall plate and pushes them closer to one contact. This gives an asym-
metrical potential in the Hall plate and an output voltage V out,h   between the 
two output contacts, which is fairly linear to the applied field:
	
V
B S V
z
u
out,h
in,h
=
	
(7.4a)
with the magnetic flux density B z   orthogonal through the Hall plate, the 
voltage-related magnetic sensitivity S u  , and the supply voltage V in,h   across 
the Hall plate. The output voltage reverses its sign when the magnetic field 
reverses its sign. Therefore, Hall effect devices can detect rotational positions 
unambiguously in the full range of 360° . Their magnetic sensitivity, S u  , is
	
S
G
L W
u
n h
=
(
)
µ ,
H
eff
	
(7.4b)
with µ n,h   the Hall mobility of electrons in low n -doped silicon, G H , the Hall 
geometry factor that describes the short-circuiting effects of finite sized con-
tacts, and (L /W )eff  the effective number of squares (which is the ratio of input 
resistance over sheet resistance). These quantities can be computed and 
measured very accurately [20– 22]. In practice, one wants to maximize the 
signal-to-noise ratio (SNR) of a Hall plate at a fixed input resistance, which 
is suitable for the signal conditioning circuit. Thereby, the noise is merely 
thermal noise, because low-frequency noise is cancelled out by the spinning 

210
Magnetic Sensors and Devices
current Hall probe technique [23]. It can be shown that this is equivalent to 
maximizing S u   while keeping the input resistance constant. This calls for 
high mobility and thus low doping according to Equation  7.4b. In silicon, 
a low phosphorus doping of 2  ×   1016 /cm3  gives a Hall mobility of 0.1084/T. 
The second term on the right-hand side of Equation 7.4b depends only on the 
layout. For Hall plates with 90°  symmetry and at a moderate magnetic field, 
it is maximized by medium-sized contacts with L W
(
)
=
eff
2 , from which 
follows G H   =  2/3 (see appendix  B of [24], where it is also shown that Hall 
plates without 90°  symmetry have smaller SNR at the same supply voltage 
and current). So, the maximum SNR of Hall plates for fixed input resistance 
is obtained for Su ≅
×
≅
0 108
2 3
51
.
mV V T . For larger contacts, larger dop-
ing, and thicker Hall plates, it is possible to further increase the SNR at a 
fixed supply voltage, but this drastically increases current consumption.
In practice, the circuit design engineer chooses the lowest Hall plate resis-
tance with which the sensor can still fulfill the specification of maximum 
allowed current drain. Then, he or she opts for the lowest Hall doping level 
that Bi/CMOS technology allows. He or she chooses the layout in order to 
fulfill L W
(
)
=
eff
2 . This defines the Hall plate thickness in order to achieve 
the target resistance. If this Hall plate thickness is not available in the given 
Bi/CMOS technology, one can connect various Hall plates in parallel to 
replace a single thick Hall plate, but this needs more chip area.
A major error of Hall effect devices is offset: due to tiny unavoidable asym-
metries in the device, the output voltage is not exactly zero at a vanishing 
magnetic field. However, the Hall sensor circuit operates the Hall effect 
device in several consecutive operating phases, whereby inputs and out-
puts are swapped and the outputs of these phases are added up [18]. This is 
known as the spinning current Hall probe  and it drastically reduces the offset 
error from an equivalent value of several millitesla (mT) down to several tens 
of microtesla (µ T), in some cases even down to 1  µ T [3]. It also eliminates 
flicker noise. The operating phases are executed at frequencies up to several 
hundred kilohertz (kHz), so that analog bandwidths of 150  kHz are achiev-
able, and this is sufficient for nearly all angle sensing applications. Note that 
the scheme of the spinning current Hall probe eliminates Hall plate offsets 
without knowing the exact value of the offset, whereas the offset of MRs 
can only be reduced by first measuring it, storing it as a calibration data in 
a memory, and subtracting this value from the signals during operation in 
the field.* Therefore, Hall effect devices need no individual offset calibration 
*	 Here we talk of offset cancellation at a static magnetic field. If the magnetic field varies sinu-
soidally due to a continuous rotation of the magnet in an angle sensor, MR sensors can cancel 
out major parts of the offset by autocalibration schemes, which are discussed in Section  7.3.1. 
But this is a completely different procedure, which only works at the system level and requires 
continuous 360°  rotation of the magnetic field. Such an autocalibration scheme works for all 
types of MR sensors, and it works also for Hall sensors. In Hall sensors, autocalibration can 
be used on top of spinning current schemes to suppress offset errors below conventional 
detection limits.

211
Magnetic Angle Sensors
as MR sensors do, and this reduces the test costs, temperature, and lifetime 
drifts of Hall effect devices.
Magnetic field-effect transistors (MAG-FETs) are N-Channel MOS (NMOS) 
transistors with additional sense contacts. In total, they may have three (split-
drain MAG-FET) or four contacts (like Hall plates). MAG-FETs use the Hall 
effect in their thin channel region, and therefore they can be optimized for 
low current consumption. The spinning current principle also works with 
MAG-FETs, but due to their electrical nonlinearity it is less efficient than for 
Hall plates.
The basic idea behind vertical Hall effect devices (VHalls) is to measure a 
magnetic field in the x -direction by turning a Hall plate from its horizontal 
(x ,y )-plane into its vertical (y ,z )-plane. This was originally proposed in 1984 
[25]. The first obvious problem of VHalls in Bi/CMOS technology is that it 
is difficult to make electrical contacts on the three sides of the vertical plate, 
which are in the depth of the substrate. Yet, it is possible to make contacts 
on a single side of a Hall plate [26]. This reduces the electrical symmetry 
of the device, but in linear theory the spinning current scheme still works 
perfectly for asymmetric devices [27]. The real blocking point for VHalls 
is the low depths of 3– 10  µ m of available tubs in Bi/CMOS technologies, 
because the spacing of the contacts on the top side has to be roughly equal 
to the depth to get a strong signal. Therefore, the contact spacing of VHalls 
is only a few micrometers, whereas in traditional Hall plates it is around 
50  µ m. Hence, at a usual supply voltage of 1– 3  V, the electric field in VHalls 
is roughly 0.3– 1  MV/m, which leads to velocity saturation, electrical nonlin-
earity, and inhomogeneous self-heating of the VHalls. It is known that these 
effects reduce the effectiveness of spinning schemes [27,28]. Therefore, single 
VHalls have roughly 10 times larger residual offset errors than conventional 
Hall plates. However, VHalls are also much smaller in chip layout than Hall 
plates. So, the solution is parallel connection and stacking of many VHalls 
[29– 31]. Then, at identical chip space and current consumption, the offset of 
VHalls can be as low as the offset of Hall plates. It is also a widespread mis-
conception, that VHalls have smaller SNR than Hall plates. This is only the 
case for shallow (3  µ m) tubs with relatively large doping (> 5*10^16/cm³ ). For 
BiCMOS technologies with 5– 10  µ m deep epitaxial layers and doping levels 
below 10^16/cm³ , the SNR of VHalls is comparable to that of Hall plates. 
Of course, new circuit architectures are needed to leverage the potential of 
VHalls, and there are many different proposals for VHall effect devices, so 
it will take a few years until the most cost-efficient variants are identified.
7.2.3  Comparison of Technologies for Magnetic Angle Sensing Devices
The advantage of AMRs over GMRs and TMRs is the absence of the pinned 
layer magnetization. This reduces manufacturing costs and it avoids errors 
originating from the reference magnetization: in GMRs and TMRs the inaccu-
rate alignment of pinned layer magnetization and the drift of magnetization 

212
Magnetic Sensors and Devices
at high temperature and large applied field may lead to orthogonality 
errors. AMRs can be packed more densely than GMRs and TMRs, because 
the latter need minimum spacing when their pinned layer is magnetized 
to avoid cross-talk errors. AMRs can be aligned arbitrarily in many direc-
tions whereas each further direction of pinned layer magnetization in GMRs 
and TMRs needs an additional magnetization pulse. A drawback of AMRs 
over GMRs and TMRs is their smaller signal amplitude: GMRs are twice 
as sensitive and TMRs are 27 times more sensitive. This poses no relevant 
problem for modern signal conditioning circuits: for h   =  0.022 the output of 
an AMR Wheatstone full bridge is 192  µ V/° (=h /2*pi/180) at a supply volt-
age of 1  V. This is neither critical for pre-amp noise nor for pre-amp offset 
(chopped pre-amps have less than 1  µ V offset error). However, the main 
limitation is the offset and offset drift of the AMR Wheatstone bridge itself. 
We assume 0.33  mV standard deviation of the bridge offset at 2  V supply: 
this corresponds to 0.42° . Thus, often this sensor system needs some kind 
of calibration. One can measure the offset (and probably also its drift over 
temperature) in an end-of-line test and store these calibration data in an on-
chip EEPROM to correct for it— yet, this calibration is a significant cost adder 
and it does not account for lifetime drifts. Conversely, for continuously rotat-
ing 360°  applications the system may execute an autocalibration procedure, 
which improves offset errors (cf. Section  7.3.1). Although GMR signals are 
twice as large as AMR signals, they do not sufficiently solve this problem. 
Finally, TMRs have such a large sensitivity that the offset-induced angle 
error is less than 0.2°  standard deviation. Yet, for worst-case devices without 
calibration this may add up to 1° .
For all MRs, it is possible to sputter them on top of a silicon CMOS wafer 
with the sensor circuit below them. Therefore, MRs do not need additional 
chip space beyond the one used for the signal conditioning ASIC. Yet, 
since AMRs and GMRs are metallic conductors, their sheet resistance is 
low. Therefore, they have to be long in order to sum up to the convenient 
impedance levels of kiloohms, and this calls for considerable size of each 
resistor. As we explained previously, TMR angle sensors are similarly 
large. The large number of eight resistors for both Wheatstone bridges 
leads to sensor systems of roughly 0.5  mm in diameter. The field of small 
magnets is not perfectly homogeneous across such a large area. Thus, the 
size of the complete sensor layout generally leads to non-negligible angle 
errors [38].
For testing and calibration purposes, one can place conductors above/
below the sensing elements and send a current through them to generate 
magnetic test fields. For small Hall effect devices, this is more efficient than 
for large MR sensors. Besides, testing Hall effect devices can be done at weak 
fields, because they are linear versus field strength— but for strong-field 
MRs, one needs to apply much larger fields, which calls for massive conduc-
tors. This effectively costs chip space because the interconnect layer is used 
for the test conductors and so it is not available for the chip circuit in this 

213
Magnetic Angle Sensors
area, even though the MRs themselves would only float above the circuit 
elements.
Every now and then, it is stressed that an apparent advantage of MRs is 
their intrinsic angular dependence [32]: their signals vary sinusoidally with 
the angle of the applied field. Taking a closer look, we doubt that this argu-
ment is valid: in MR sensors the angle is computed as the arctangent of the 
ratio of two bridge output voltages, while in Hall sensors the angle is com-
puted as the arctangent of the ratio of two Hall outputs— so the computa-
tional effort is the same. For the circuit, the only difference in extracting 
the angle is the larger signal amplitude of the MRs (see Table  7.1); however, 
signal amplitudes down to the microvolt (µ V) range are not a blocking point 
for contemporary integrated circuits. The additional amount of circuit com-
plexity for smart Hall sensors integrated with the signal conditioning circuit 
on the same chip need not be a relevant cost factor. MRs have a larger SNR 
than silicon Hall sensors, but there are only niche applications where noise 
is an issue. In fact, the sinusoidal dependence of MRs on the magnetic field 
angle is a disadvantage, because accurate information on the strength of the 
applied field is lost. Hall sensors directly measure the field components and 
so they can compute the magnitude of the applied field with an accuracy 
of 1% in a wide temperature range: – 50° C to 150° C. Also, some MR sensors 
offer a rough check of the strength of the applied field: they compute the 
sum of both squared Wheatstone bridge outputs 
OUT
OUT
cos
sin
2
2
+
, which 
is independent of the rotational position and proportional to temperature-
dependent magnetic sensitivity h . It decreases monotonously (but not lin-
early) with magnetic field strength. This may be used for the detection of lost 
magnets, if the rotating magnet loosens from the shaft. Yet, it cannot reliably 
detect, if the distance between the magnet and sensor varies inappropriately 
on the order of 1  mm due to axial play, if ferromagnetic filings cling to the 
magnet and change its field, if magnet portions break off the magnet due to 
thermomechanical stress or collision, or if the magnet demagnetizes due to 
excessive mechanical shock or thermal load or corrosion. The relevant issue 
for the application is: Suppose the magnet changes gradually from its origi-
nal strength to complete absence. First, the angle sensor can cope with a mod-
erate decline in a magnetic field but at some point it will suffer from large 
error and finally it will fail. Hall sensors can detect and signal the decline 
in a magnetic field long before it impairs their accuracy, while MR sensors 
reliably detect an inappropriate magnetic field with 
OUT
OUT
cos
sin
2
2
+
 only 
when it already causes notable angle errors. However, a system with inte-
grated coils like in [9] can implicitly measure the field of the magnet by 
comparison with the known coil field, yet this costs power, chip space, and 
system complexity.
Historically, MR sensors were preferred for angle sensing because they 
were the first to accurately measure a magnetic field parallel to the chip sur-
face, and conventional end-of-shaft angle sensors place the chip perpendicu-
lar to the rotation axis and detect the diametrical field component. We call 

214
Magnetic Sensors and Devices
this classical type of angle sensor a perpendicular field angle sensor , because it 
detects the magnetic field perpendicular to the rotation axis. In the late 1990s, 
VHall effect devices were not yet mature enough to measure the perpendic-
ular field component with sufficient accuracy. Alternatively, one could place 
two chips with Hall plates perpendicular to the x - and y -directions, respec-
tively, but this suffers from assembly tolerances and the inhomogeneous 
field of the magnet, which makes it less attractive than several MR-sensing 
elements on a single chip. Another class of sensors uses integrated magnetic 
concentrators (IMC) on the chip. A soft-magnetic disk of 210  µ m in diam-
eter and 24  µ m thick bends the magnetic flux lines from a diametrical to a 
vertical direction near its perimeter, so that Hall plates can be used [33,34]. 
Although the flux on the Hall plates is amplified by the flux concentrator, its 
angle accuracy is limited by the placement tolerance and shape imperfec-
tions of the flux concentrator, its saturation and coercivity, and the inhomo-
geneous mechanical stress (both in- and out-of-plane) on the Hall plates near 
the perimeter of the flux concentrator. Besides, the Hall plates have to be 
fairly small to benefit from the magnetic gain of the IMC, and this increases 
their residual offset error. The same arrangement of Hall plates can also be 
used for end-of-shaft angle sensing without  any microscopic flux concentra-
tor. Then, the Hall plates are located on a nearly 10 times larger circle. This 
sensor system does not detect the diametrical field component B n
B n
x
x
y
y


+
 
but the gradients of the axial field components ∂
∂
∂
∂
B
x
B
y
z
z
,
 [35,36]. We 
call it the axial field-gradient angle sensor . The simple fact of skipping the flux 
concentrator completely changes the sensing principle from perpendicular 
field  to axial field gradient : The former is severely impaired by superimposed 
magnetic disturbance fields while the latter cancels out homogeneous dis-
turbances very effectively. On the other hand, perpendicular field angle sen-
sors suffer much less from angle errors due to assembly tolerances than axial 
field-gradient angle sensors (see Sections  7.3 and 7.4). Meanwhile, VHall 
effect technology in silicon achieves SNRs comparable with silicon Hall 
plates and residual offsets down to 100  µ T. In the next decade, VHall tech-
nology should become a serious competitor to all MR and IMC technologies, 
because it achieves the same accuracy without the need for individual mag-
netic calibration over temperature while still offering the highest versatility 
at the lowest costs in standard CMOS/BiCMOS technology.
Table  7.1 compares the key parameters of common magnetic angle sensor 
technologies. A “ fair”  comparison is difficult because some parameters of 
one technology depend on boundary conditions such as the magnet, while 
the same parameters of another technology do not. In such cases, we have 
tried to avoid extreme boundary conditions (e.g., we assume standard mag-
nets instead of optimized ones for MRs or Hall). For strong-field MRs, signal 
amplitude does not depend on magnetic field strength, whereas Hall signals 
scale linearly. In both cases, we assume a supply voltage of 2  V. At typical fields 
of 45  mT, TMRs are 130 times more sensitive than silicon Hall plates without 
IMC. For the IMC, we assumed a realistic magnetic gain of ~5 (compared to 

215
Magnetic Angle Sensors
the horizontal Hall [HHall] system without  IMC on a 10 times larger reading 
radius). For VHalls, we conservatively assumed an optimized five-contact 
device (see also [24]). Table  7.1 assumes identical impedance for all sensors: 
MRs have input and output resistances of 1  kOhm for the Wheatstone bridges 
of the sine and the cosine channel. Hall sensors also have two channels (sin/
cos) and we assume the same input and output resistances per channel. Thus, 
in each case, the sensing elements of both channels consume 4  mA.
Equal impedance gives equal thermal noise voltage at room temperature. 
Flicker noise is not quantified for MRs, although it may be significant for the 
tunneling effect. We denote it by “ x”  in Table  7.1. Flicker noise is cancelled out 
in Hall sensors by the spinning current scheme. For the noise in the computed 
angle, we assume the signals of both channels A
Nx
cosϕ +
 and A
Ny
sinϕ +
 
with identical peak amplitude A  and additive noise N x  ,  N y  . Per definition, it 
holds that tan
sin
cos
ϕ
ϕ
ϕ
ϕ
+
(
) =
+
(
)
+
(
)
noise
A
N
A
N
y
x . We expand this equa-
tion in a Taylor series for the small angle noise, keep only the dominant lin-
ear term, and separate it at the left-hand side, ϕ
ϕ
ϕ
noise ≅
−
(
)
N
N
A
y
x
cos
sin
. 
If the noise of both channels is uncorrelated with equal standard deviation, 
one can sum up the squares of both channels and then take the square root 
to obtain stdev
stdev
noise
ϕ
{
} ≅
{
}
N
A
x
. It also means that angle noise is inde-
pendent on the angular position. For AMRs, this leads to an additional fac-
tor 2 in the denominator stdev
stdev
noise
ϕ
{
} ≅
{
} (
)
N
A
x
2
. The values reported 
for the angle noise in Table  7.1 also include the noise of the signal condi-
tioning circuit (pre-amp and analog-to-digital [A/D] converter), whereby 
we assume a conventional noise figure NF  =  1 (which means that the circuit 
adds the same noise power as the sensing elements). In Table  7.1, we assume 
that the total sensor circuit behaves like a low-pass filter of first order with 
a corner frequency of 150  kHz, which gives an effective noise bandwidth 
of 150
2
236
 kHz
 kHz
×(
) =
π
. We ignore the fact that AMRs need twice 
this bandwidth due to their cos 2ϕ
(
)  dependence. At a rotational speed of 
50,000  rpm (=833  Hz), a 150  kHz first-order low-pass filter leads to a reason-
ably small phase-lag of only 0.32°  or a delay time of 1.1  µ s. This should be 
sufficient for control of nearly all kinds of motors— even fast ones. We see 
that all MRs, particularly TMRs, have much lower noise than Hall sensors 
due to their high signal amplitude, and this is often seen as an advantage for 
MRs. On the other hand, even Hall sensors have sufficiently low noise for 
most applications (0.035° – 0.045°  standard deviation without IMC).
The following three errors (offset, gain mismatch, orthogonality) are dif-
ficult to compare, because we have to distinguish between the errors “ ex fab,”  
“ end of factory trim,”  and “ with autocalibration”  (cf. Section  7.3.1). Process 
tolerances may lead to large errors “ ex fab,”  but in a final test at the sensor 
manufacturer they can be largely trimmed off in an “ end of factory trim.”  
But, of course, this requires test time, costs for precise magnetic tests, and a 
memory to store the trim data— and it does not cancel the errors completely; 
it only reduces them by a factor of ~5 due to limitations in the test procedure 
(position, magnetic field tolerances, limited test time, and test temperatures) 

216
Magnetic Sensors and Devices
and due to temperature and lifetime drift. Table  7.1 gives estimations of these 
errors “ ex fab,”  because with sufficient effort they might be calibrated to com-
parable accuracy, where clear differences can be seen only with regard to spe-
cific application use cases. Offset errors are stochastic and so we can treat 
them like noise: if the errors of both channels are statistically independent 
and equal, the standard deviation of the angle error is equal to stdev
offset
∆ϕ
{
} ≅
stdev Off
A
x y
,
{
}
 (again for AMRs, we have to replace A
A
→2
). Table  7.1 
shows that offset angle errors of TMRs are 2.7 times smaller than that of 
AMRs and six times smaller than that of GMRs. However, Hall sensors are 
four times better than TMRs. Although the IMC provides a magnetic gain of 
~5, this does not improve the offset over pure HHalls due to the necessary 
small size of Hall plates (see Figure  2 in [33,34]). Gain mismatch between sin/
cos-channels of AMRs leads to the largest errors near ϕ =
°
22.5  with an error 
dϕ =
+
(
) −
°
(
)
arctan 1
45
2
gain_mismatch
. For all other sensors, the worst-
case angle is ϕ =
°
45  and the error doubles. GMRs and HHalls with IMC have 
largest gain mismatch errors “ ex fab.”  Orthogonality errors of HHalls with 
IMC, GMRs, and TMRs are significant. The large gain mismatch and orthogo-
nality errors of IMCs come from misalignment with the HHalls. VHalls may 
show some orthogonality error due to the misalignment of small devices, 
which can be reduced by a larger number of small devices. Hysteresis errors 
are small for all sensors. They are sometimes corrupted by spurious iron con-
tent in the copper lead frame (Fe  ~0.1%).
If offset, gain mismatch, and orthogonality are trimmed off, there is still 
some deviation from sinusoidal angle dependence. This is called anisotropy 
error  for MR sensors and nonlinearity  for Hall sensors. Here, TMRs tend to 
have a systematic dependence versus magnetic field strength, so that at a spe-
cific strength this error vanishes nominally, yet over process variations and 
temperature and lifetime drift some residual error still remains. Anisotropy 
error is mainly irregular versus rotation angle, so that it is difficult to elimi-
nate without a detailed characterization of each individual device. This error 
is one reason why AMRs are still considered to be more accurate than TMRs 
(note that GMRs are not superior to AMRs in any parameter of Table  7.1, 
except that they can measure full 360°  unambiguously). In principle, Hall 
sensors also have nonlinearity errors, yet in silicon they are negligible at 
practical field strengths (see also appendix  B in [36]). IMCs with a diameter-
thickness ratio of ~10 start saturating at diametrical fields of 60  mT [33].
7.3  Assembly Tolerances and Sensor Offset, 
Gain Mismatch, and Misalignment
The accuracy of magnetic angle sensors is limited by several errors (see 
Table  7.2). The dominant ones can be clustered into errors of the magnetic 

217
Magnetic Angle Sensors
TABLE  7.2 
List of Error Sources of Magnetic Angle Sensors
Origin of Error 
Description of Error 
Single sensor element
Offset/zero-point error (bridge asymmetry, perming)
Magnetic nonlinearity/anisotropy error
Hysteresis (cw vs. ccw)
Noise
Finite size and shape of sensitive area
Sensor elements (sin/cos-channels 
or X/Y-Wheatstone bridges)
Gain mismatch
Orthogonality error (misalignment)
Cross-talk
Arrangement/placement of elements in layout
Signal conditioning
Quantization error
Algorithmic errors (e.g., zero-crossing, 
autocalibration)
Time synchronization error of both channels
Propagation delay and delay mismatch
Finite bandwidth and bandwidth mismatch
Assembly tolerances
Chip warpage and mechanical stress
Position and shape of microscopic flux-guide (IMC)
Chip within sensor package (e.g., on lead frame)
Sensor package on component board
Sensor package against other sensor packages in 
through-shaft sensors
Component board against rotation axis
Magnet on shaft
Shaft against rotation axis (e.g., bearing, mechanical 
load)
Variation of airgap (=spacing of sensor to magnet)
Rotating magnet
Imperfect magnetization pattern
Systematic errors of magnetic field (e.g., E -/T -shape 
functions)
Partial demagnetization during lifetime (mechanical 
shock, too low coercivity, temp. cycling, 
desaccomodation)
Magnetic disturbance fields
Asynchronous fields from external disturbers
Synchronous fields (e.g., in motor control, nonius 
cross-talk, dc fields)
Nearby ferrous objects distorting field of rotating 
magnet
Note: 	 Some errors, for example, offset, gain mismatch, and noise, have more than one origin. In 
the table they are only listed once.

218
Magnetic Sensors and Devices
field sensing elements, errors of the magnet, and mechanical assembly toler-
ances of the system.
•	 Errors of the sensing elements are mainly offset or zero-point errors 
and sensitivity mismatch and misalignment between sin/cos-chan-
nels or X/Y-Wheatstone bridges.
•	 Magnet imperfections are stochastic properties, such as misaligned 
direction of magnetization (e.g., if it is tilted out of the diametrical 
direction by inaccurate alignment of the magnetization field pulse) 
or inhomogeneous material composition (e.g., non-homogeneous 
filler content in injection-molded magnets). Slightly elliptical shapes 
due to systematic anisotropic sinter shrinkage or systematic non-
homogeneity of the magnetic field (described by E - and T -shape 
functions in Equations  7.12 and 7.25) are not imperfections of a mag-
net— these are just aspects of suboptimal design. The following theory 
accounts for these aspects accurately, and one can figure out how to 
optimize the magnet to minimize relevant field non-homogeneities.
•	 Assembly tolerances are the inaccurate placement and alignment of 
magnet and sensing elements against the rotation axis in a statistical 
sense.
In the following, we focus on assembly tolerances and include errors of sens-
ing elements, but we do not treat magnet imperfections explicitly. Although 
it is simple to model specific imperfections of the magnet, a general theory on 
all imperfections is hardly imaginable. Moreover, magnet imperfections lead 
to similar errors such as assembly tolerances: imagine a magnet whose left 
side contains less magnetic filler content than its right side— this will give 
similar results as a perfectly homogeneous magnet, which is slightly shifted 
to the right side. Also, a magnet whose magnetization is slightly tilted out of 
the diametrical direction will act similarly as a magnet with perfectly dia-
metrical magnetization, which is mounted with the same small tilt on the 
shaft. Thus, we can take account of magnet imperfections by using rather 
pessimistic values for the mechanical assembly tolerances.
For perpendicular field angle sensors, the effect of magnet eccentricity or 
sensor eccentricity on angle error is straightforward: the magnetic field on 
the chip surface is inhomogeneous not only in magnitude but also in direc-
tion. Therefore, at a specific rotational position of the magnet, the angle sen-
sor will give slightly different angle readings, if it is shifted laterally. So, we 
could measure the direction of the in-plane magnetic field component on the 
chip surface and identify a region within which the angle deviates by less 
than 0.5°  or similar. This procedure was proposed to identify the maximum 
allowed eccentricity and to select good from bad magnets [37]. The follow-
ing theory will show that such a method detects only a part of the problem, 
namely, eccentricities and not tilts (this measurement is sensitive only to the 

219
Magnetic Angle Sensors
E  function, not to the T  function in Equations  7.22b and 7.24). It does not tell 
us how large the angle error will be, if the magnet or sensor chip is tilted 
against the rotation axis.
In fact, even a perfectly homogeneous magnetic field will lead to angle 
errors, if the sensor chip is tilted. Figure  7.4 shows such a case, where a 
homogeneous field is perpendicular to the z -axis and rotates around it. The 
tip of the field vector moves along a circle in the (B x  , B y  )-plane. However, if 
the chip is tilted by λ  around the y -axis, the projection of the field on the chip 
surface moves along an ellipse. The difference between circle and ellipse 
leads to the angle error d ϕ  with
	sin
cos
sin
cos
cos
sin
cos
cos
sin
d
d
ϕ
ϕ
ϕ
ϕ
λ
ϕ
ϕ
λ
ϕ
= 


× 



+
→
1
2
2
2
ϕ
λ
ϕ
≅(
)
(
)
2 4
2
sin
	
(7.5)
Here, we note that the error is of second order, because the tilt angle λ  is 
squared, and this gives fairly small angle errors despite the large allowed 
tilts: a tilt of 5°  gives only 0.11°  angle error. Compared to through-shaft opti-
cal angle sensors, end-of-shaft and in-shaft magnetic angle sensors are very 
robust against assembly tolerances, and this is one of their main advantages 
for cheap mass production (cf. appendix  C of [38]). Nevertheless, a number 
of questions arise in this respect: How do we optimize the magnets? Can we 
optimize the layout of the sensor elements in this respect? What is the maxi-
mum achievable angle accuracy with certain assembly tolerances? What is 
the probability density distribution of angle errors? Are perpendicular field 
angle sensors preferable over axial field-gradient angle sensors? This is the 
motivation for an in-depth treatment of tolerances in the following.
z, Bz
Chip plane
x, Bx
x, Bx
y, By
λ
dϕ
ϕ
λ
Bin-plane ´cos ϕ
Bin-plane ´cos ϕ cos λ
Bin-plane
FIGURE  7.4  
Angle error in a perpendicular field angle sensor caused by sensor tilt in a perfectly homoge-
neous diametrical magnetic field.

220
Magnetic Sensors and Devices
Here, we describe the geometrical relationships of magnet, sensor, and 
shaft. To this end, we need nine reference systems Σ ,  Σ 1 ,… ,  Σ 8 , which are 
linked by translations and rotations. We use the same conventions and sym-
bols as in [36,38– 40].
The reference frame Σ 3  for the assembly tolerances of the magnet is fixed 
to the shaft and centered to the rotation axis. Its rotational movement is 
described by the mechanical rotation angle φ  around the z 3 -axis:
	
x
y
z
Rz
x
y
z
4
4
4
3
3
3








=
( )








ϕ
with the rotation maatrix Rz ϕ
ϕ
ϕ
ϕ
ϕ
( ) =
−








cos
sin
sin
cos
0
0
0
0
1
	
(7.6a)
Coordinate system Σ 4  is also centered to the rotation axis, but fixed in 
space. The assembly tolerances of the sensor elements are referred to Σ 4 .
Turning back to the magnet, we define a coordinate system Σ  that is cen-
tered with respect to the magnet and fixed to the magnet. In the absence of 
assembly tolerances, in this system Σ  the sensor elements are ideally on the 
z -axis and the diametrical magnetic field on the sensor elements points in 
positive or negative y -direction. Eccentric mounting of the magnet on the 
shaft is modeled by a translation of the coordinate system Σ   →   Σ 1 :
	
x
y
z
x
y
z
r
r
z








=








+








1
1
1
δ
η
δ
η
δ
cos
sin
	
(7.6b)
whereby the x -axis is parallel to the x 1 -axis, the y -axis is parallel to the 
y 1 -axis, and the z -axis is parallel to the z 1 -axis. We use δ z   to model the small 
axial play of the shaft. Small tilts of the magnet can be around the x -axis or 
y -axis or around any other direction in the (x ,y )-plane. We model this by first 
twisting the magnetization by an angle α  out of its original y -direction and 
then tilting it by a small angle β .
	
x
y
z
Rz
x
y
z
Rz
2
2
2
1
1
1
0








=
( )








( ) =
α
α
α
α
with 
cos
sin
−








sin
cos
α
α
0
0
0
1
	
(7.6c)
	
x
y
z
Ry
x
y
z
Ry
3
3
3
2
2
2
0








=
( )








( ) =
−
β
β
β
with 
cos
sinβ
β
β
0
1
0
0
sin
cos








	
(7.6d)
Rz (α ) and Ry(β) are rotation matrices. 

221
Magnetic Angle Sensors
Hence, from Σ 1  to Σ 4 , we have three consecutive rotations that we can sum 
up as
	
x
y
z
A
x
y
z
A
Rz
4
4
4
1
1
1








=
(
)








(
) =
α β ϕ
α β ϕ
ϕ
, ,
, ,
with 
( )
( )
( )
Ry
Rz
β
α 	
(7.6e)
With its three parameters, A (α ,β ,φ ) describes the most general rotation in 3-D 
space and α ,β ,φ  are known as Euler angles [41]. Thus, we do not need any 
further parameters to model the most general assembly tolerances of mag-
nets. In fact, the last rotation Rz (φ ) denotes not only the mechanical rotation 
but also a rotational assembly tolerance— but we do not have to separate the 
two, because this assembly tolerance would only mean a shift in the 0°  refer-
ence position of the sensor system.
Let us compute the angle θ ʹ  between the magnetization in the magnet 
and its ideal plane, which is orthogonal to the rotation axis: we transfer the 
y -direction of the diametrical magnetization in Σ  to Σ 4 , which is aligned 
with the rotation axis:
	
A α β ϕ
, ,
(
)








0
1
0
	
(7.6f)
and compute the scalar product with the z 4 -direction:
	
A α β ϕ
β
α
β
, ,
sin sin
si
(
)


















⋅








=
≅
0
1
0
0
0
1
nα 	
(7.6g)
This result must be equal to cos
sin
π
θ
θ
2 −′
(
) =
′. So, we get ′ ≅
θ
β
α
sin . Thus, 
in a Monte Carlo simulation, we may assume β  to be Gaussian distributed 
with zero mean and then α  has to be uniformly distributed in [0° ,90° ] or 
[– 90° ,90° ] or [0° ,180° ] or [0° ,360° ].
Now, we discuss the assembly tolerances of the sensor elements. We 
define the coordinate system Σ 8  so that the chip surface is the (x 8 ,  y 8 )-plane, 
and in the absence of assembly tolerances, the rotation axis intersects the 
chip surface in the origin of Σ 8  with z 8  the rotation axis. Σ 8  is obtained by 
twisting Σ 7  by an angle ϑ  around the common z -axes: 

r
Rz
r
8
7
=
( )
ϑ
. The 
angle ϑ  will be of little interest to us because it just describes a misalign-
ment of the sensor arrangement against the chip edges. Similarly to the 
magnet, we model the tilt of the sensor plane by two degrees of freedom: a 

222
Magnetic Sensors and Devices
small tilt angle λ  and a large twist angle γ. We start from a reference system 
Σ 5  and first we twist it around z 5  by γ. This gives Σ 6 , which is then tilted 
around y 6  to give Σ 7 .
	
x
y
z
Rz
x
y
z
Rz
6
6
6
5
5
5
0








=
( )








( ) =
γ
γ
γ
γ
with 
cos
sin
−








sin
cos
γ
γ
0
0
0
1
	
(7.7a)
	
x
y
z
Ry
x
y
z
Ry
7
7
7
6
6
6
0








=
( )








( ) =
−
λ
λ
λ
cos
si
with 
n
sin
cos
λ
λ
λ
0
1
0
0








	
(7.7b)
Again, the three Euler angles γ λ ϑ
, ,
 describe the most general rotation 
A
Rz
Ry
R
γ λ ϑ
ϑ
λ
γ
, ,
(
) =
( )
( ) ( )  in 3-D space. The angle between the chip nor-
mal and the rotation axis is λ  because in Σ 4  we can write
	
Rz
Ry
Rz
T
T
T
γ
λ
ϑ
( )
( )
( )


















⋅








=
0
0
1
0
0
1
cos sin
sin sin
cos
cos
γ
λ
γ
λ
λ
λ








⋅








=
0
0
1
	
(7.7c)
The suffix T  denotes the transpose of the rotation matrix, which is identical 
to its inverse. If we project the unit vector in the axial direction onto the chip 
surface, we get
	
Rz
Ry
Rz
ϑ
λ
γ
λ
ϑ
λ
ϑ
λ
( )
( )
( )








=
−







0
0
1
sin cos
sin sin
cos

≅
−








λ
ϑ
λ
ϑ
cos
sin
1
	
(7.7d)
Since the probability density of this projection should be symmetri-
cally distributed over all four quadrants in the chip surface, ϑ  must be 
evenly distributed between 0°  and 360° . Figure  7.5 shows the meaning 
of the angles γ λ ϑ
, ,
: reference frame Σ 5  is aligned to the rotation axis, and 
in the (x 5 ,y 5 )-plane there is the tilt axis TA . The angle γ  is between the TA  
and the y 5 -axis and the angle γ +
°
90  is between the TA  and the x 5 -axis. 
Then, the rotation axis (=z 5 -axis) is rotated around the TA  by the small tilt 
angle λ  to become the chip normal (=z 8 -axis). Obviously, if we consider 
all possible tilts, the angle γ  can vary between 0°  and 360° , whereby a 
change of sign in λ  is the same as if we add 180°  to γ. The TA  also lies in 
the (x 8 ,y 8 )-plane at an angle ϑ  with the y 8 -axis and at an angle 90° −ϑ 
with the x 8 -axis. Here, we see that ϑ  may vary between 0°  and 360°  for 

223
Magnetic Angle Sensors
all possible tilts (whereby a change in the sign of λ  is equal to adding 
180°  to ϑ ).
The eccentricity of the sensor chip against the rotation axis is modeled by 
a translation between Σ 4  and Σ 5 :
	
x
y
z
x
y
z
r
r
z
4
4
4
5
5
5








=








+








ε
χ
ε
χ
ε
cos
sin
	
(7.7e)
In the absence of assembly tolerances, the axial spacing between the sensor 
and the center of the magnet is ε z  , which is often a few millimeters (but of 
course there may also be a small fluctuation superimposed due to mounting 
tolerance).
With all these coordinate transformations, we can express the magnetic 
field of the permanent magnet in the chip reference frame Σ 8 :
	

 






B
B r
n
n
n
n
n
n
x
y
z
x
y
z
8
8
8
8
8
8
8
=
( )⋅
















⋅








	
(7.7f)
Chip
γ
z5
x5
y5
z8
x8
y8
TA
ϑ
λ
FIGURE  7.5 
The three Euler angles γ λ ϑ
, ,
 for a general rotation in 3-D space. The blue reference system Σ 5  
is aligned to the rotating shaft— its z 5 -axis is parallel to the rotation axis. The green system Σ 8  
is the chip reference system. The intersection between the (x ,y )-planes of Σ 5  and Σ 8  is the red 
tilt axis TA , around which the small tilt λ  is performed. The direction of the tilt axis is speci-
fied by the two angles γ ϑ
,
: between TA  and both y -axes. The parameters for the drawing are 
γ
λ
ϑ
=
°
=
°
=
°
30
20
25
,
,
.

224
Magnetic Sensors and Devices
	
with r
A
r
r
z
T
r
r
z
=







+
(
)





δ
η
δ
η
δ
α β ϕ
ε
χ
ε
χ
ε
cos
sin
, ,
cos
sin


+
(
)















=
(
A
r
n
n
n
A
T
x
y
z
γ λ ϑ
γ λ ϑ
, ,
, ,




8
8
8
8
and
) (
)








A
n
n
n
x
y
z
α β ϕ
, ,



	
(7g)
7.3.1  Assembly Tolerances, Offset, Gain Mismatch, 
and Misalignment in GMRs/TMRs
Figure  7.6 shows the circuit diagram of strong-field GMR/TMR angle sen-
sors. Four X-MRs are aligned with their pinned layer magnetizations in 
the x -direction and connected in order to constitute a full bridge circuit 
(Wheatstone bridge) and four Y-MRs are along the y -direction. Occasionally, 
we say sin/cos-channels instead of X/Y-bridges. If the field points in the pos-
itive x -direction, resistors R 1  and R 2  are minimum and resistors R 3  and R 4  
are maximum, while resistors R 5 , R 6 , R 7 , and R 8  are right between minimum 
and maximum. Consequently, the X-bridge has a negative output signal and 
the Y-bridge has zero output.
Yet, we have to take into account that the direction of the pinned layer 
magnetization is imperfectly aligned to the ± x -direction for X-MRs R 1 , R 2 , 
R 3 , and R 4  or to the ± y -direction for Y-MRs R 5 , R 6 , R 7 , and R 8 : there is a small 
angular deviation τ i   for the i th resistor (Figure  7.7). The reason is that the 
pinned layer magnetization is defined during production by exposing the 
MR to a large magnetic field and a high temperature. This field may have 
some tiny misalignment and non-homogeneity and the hot temperature can-
not be confined sharply to a single MR device without slightly affecting its 
(a)
(b)
x
y
R1
R3
R2
R4
Sx
R5
R7
R6
R8
Sy
Reference frame of 
chip-layout:
FIGURE  7.6 
Schematics of the four GMRs/TMRs of the X-bridge (a) and the Y-bridge (b). The arrows in the 
resistors denote the direction of pinned layer magnetization in the MRs. All MRs should be 
close together near the point where the rotation axis intersects the chip surface.

225
Magnetic Angle Sensors
immediate neighbors. With Equation  7.3a and Figure  7.7, we can write for the 
GMR resistances in Figure  7.6:
	
X-bridge:
cos
sin
min
,
,
R
R
o
h
h
K
K
i
i
i
i
x i
i
y i
i
=
+
−
±
+
(
)


1
1
2 1
2
τ
τ
	
(7.8a)
	
Y-bridge:
cos
sin
min
,
,
R
R
o
h
h
K
K
i
i
i
i
y i
i
x i
i
=
+
−
±
−
(
)


1
1
2 1
2
τ
τ
	
(7.8b)
with the plus sign for i   =  3,4,7,8 and the minus sign for i   =  1,2,5,6. Here, o i  
denotes the offset error of the i th resistor (resistor mismatch), h i   is the mag-
netic sensitivity, and τ i   is the small alignment error of the pinned layer mag-
netization. For TMRs, we simply insert Equation  7.3b instead of Equation 
7.3a into Equation 7.8a,b, which will lead to tiny differences in the results. For 
the sake of brevity, we write out only the GMR equations explicitly and point 
to the differences of TMRs only in the results. Note that hi ≈0 04
.
 for GMRs 
and hi ≈
×
=
15 0 04
0 6
.
.  for TMRs. The quantities K x   and K y   in Figure  7.7 and 
Equation 7.8 denote the components of the normalized in-plane field:
	
K
B
B
B
i
x i
i
x
x
y
,
cos
=
=
+
κ
2
2 on the location of the th MR resistor  
i =
(
)
1
4
,
,
…
	
(7.9a)
	
K
B
B
B
i
y i
i
y
x
y
,
sin
=
=
+
κ
2
2 on the location of the th MR resistor
i =
(
)
5
8
,...,
	
(7.9b)
x
y
Bin-plane
Bin-plane
Pinned layer 
magnetization
τ
κ
cos(κ−τ)
= cos(κ)cos(τ) + sin(κ)sin(τ)
= Kx cos(τ) + Ky sin(τ)
x
y
τ
κ
Pinned layer 
magnetization
cos(τ + π/2−κ)
= cos(κ)cos(τ + π/2) + sin(κ)sin(τ + π/2) 
= –Kx sin(τ) + Ky cos(τ)
X-GMR/TMR:
Y-GMR/TMR:
FIGURE  7.7 
In a strong-field magnetic angle sensor the resistance of a GMR/TMR depends on the angle 
between its pinned layer magnetization and the in-plane magnetic field from the rotatable 
magnet.

226
Magnetic Sensors and Devices
Thus, in a homogeneous magnetic field, all K x,i   are identical: K x  ,1   =  K x  ,2   =  · · ·   =  
K x  ,8 . The same holds for K y,i  . The same holds if all MR elements are very small 
(point sized) and at the same location (e.g., in the center of the die). In the ideal 
case (i.e., without offset, gain mismatch, or orthogonality errors and in the 
absence of assembly tolerances and for homogeneous magnetic fields or point-
sized sensor), the GMR resistances and TMR conductances are ∝±
1
2
(
)
h
Kx  
for i   =  1,2,3,4 and ∝±
1
2
(
)
h
Ky  for i   =  5,6,7,8 with K
B
B
B
x
x
x
y
=
+
=
2
2
sinϕ and 
K
B
B
B
y
y
x
y
=
+
=
2
2
cosϕ and φ  is the rotational position of the magnet (by 
convention, we assume that the magnet is aligned in the positive y -direction 
at 0°  rotational position). Thus, the resistances depend on the sine and cosine 
of the rotation angle from which one can extract the rotational position.
However, in the general case of non-vanishing assembly tolerances and 
finite-sized MR sensor, K x,i   and K y,i   depend in a complicated way on the rota-
tional position φ  of the magnet, from the spatial distribution of the applied 
magnetic field, and from all assembly tolerances. In [38], we made a Taylor 
series expansion of K x,i   in all small tolerance parameters β ,δ r  ,λ ,εr   and in the 
small distance r 1  of the sensor element of finite size from the rotation axis. 
There, we found that due to the symmetry of the system, all first-order deriv-
atives vanish. Hence, the dominant error terms are of second order and we 
can immediately use the results of [38]:
K
k
K
k
x i
x i
y i
y i
,
,
,
,
sin
cos
=
+
+
+
(
)+
=
+
+
+
(
)+
σ
α
γ
ϕ
ϑ
σ
α
γ
ϕ
ϑ
and
	
(7.10a,b)
where σ is the sign of the B y   field at the sensor location σ
ε
δ
=
+
By
z
z
( , ,
)
0 0
/
|
( , ,
)|
By
z
z
0 0
1
ε
δ
+
= ± . All error terms of small tolerance parameters are 
summed up in k x,i  , k y,i  :
k
K
K
K
K
K
x i
x
x
r
r
x
x
r
r
x
, ≅∂
∂
+ ∂
∂
+ ∂
∂
+ ∂
∂
+ ∂
∂
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
β
β
δ
δ
λ
λ
ε
ε
r
r
K
K
K
K
r
r
x
x
r
r
x
r
r
x
1
2
1
2
2
2
2
2
1
1
2 + ∂
∂∂
+ ∂
∂∂
+ ∂
∂∂
+ ∂
∂∂
β λ βλ
β ε βε
β δ βδ
β
β + ∂
∂∂
+ ∂
∂∂
+ ∂
∂∂
+ ∂
∂∂
+ ∂
2
2
2
1
1
2
2
K
K
K
r
r
K
x
r
r
x
r
r
x
x
r
r
r
r
λ ε λε
λ δ λδ
λ
λ
ε
δ ε δ
K
r
r
K
r
r
x
r
r
x
r
r
∂∂
+ ∂
∂
∂
ε
ε
δ
δ
1
1
2
1
1
	
(7.10c)
For k y,i  , simply replace the index x  with y  in Equation  7.10c. The k x,i  , k y,i   are 
small of second order: kx i, << 1, ky i, << 1.
	
∂
∂
=
+
+
+
(
)
2
2
2
K
E
x
rδ
α
γ
ϕ
ϑ
η
cos
sin
	
(7.11a)

227
Magnetic Angle Sensors
	
∂
∂
=
+
+
+
(
)
+
+
(
)
2
2
2
K
E
x
rε
α
γ
ϕ
ϑ
α
χ
ϕ
cos
sin
	
(7.11b)
	
∂
∂
= −
×
+
+
+
(
)
+
+
(
)
2
2
0 5
2
Kx
λ
σ
α
γ
ϕ
ϑ
α
γ
ϕ
.
cos
sin
	
(7.11c)
	
(
)
(
)
(
)
∂
∂β
=
α + γ+ ϕ + ϑ
α ε
+ε
−
× σ


K
T
E
cos
sin 2
0.5
x
z
z
2
2
	
(7.11d)
	
∂
∂∂
=
+
+
+
(
)
+
+
(
)
(
)
2K
T
E
x
r
z
β δ
α
γ
ϕ
ϑ
α
η
ε
α
η
cos
cos
sin
sin
	
(7.11e)
∂
∂∂
=
+
+
+
(
)
+
+
(
)

+
+
+
(
)
2
2
K
T
E
x
r
z
β ε
α
γ
ϕ
ϑ
α
α
χ
ϕ
ε
α
χ
ϕ
cos
cos
sin
sin
	 (7.11f)
	
(
)
(
)(
)
∂
∂β∂λ =
α + γ+ ϕ + ϑ
α + χ+ ϕ
α ε
−σ
K
T
cos
cos
sin
(
)
x
z
2
	
(7.11g)
	
∂
∂∂
=
+
+
+
(
)
+
+
+
(
)
2K
E
x
r
r
ε
δ
α
γ
ϕ
ϑ
α
χ
η
ϕ
cos
sin
	
(7.11h)
	
∂
∂∂
=
+
+
+
(
)
+
+
(
)
2K
T
x
r
λ δ
α
γ
ϕ
ϑ
α
γ
ϕ
η
cos
cos
sin
	
(7.11i)
	
∂
∂∂
=
+
+
+
(
)
+
+
(
)
+
+
(
)
2K
T
x
r
λ ε
α
γ
ϕ
ϑ
α
γ
ϕ
α
χ
ϕ
cos
cos
sin
	
(7.11j)
Equations 7.11a through 7.11j have the factor cos α
γ
ϕ
ϑ
+
+
+
(
) . For the 
Taylor series of K y  , one simply has to replace it by −(
)
+
+
+
(
)
1 sin α
γ
ϕ
ϑ .
In Equations 7.11a through 7.11j, the shape functions E  and T  describe how 
a non-homogeneity of the field of the permanent magnet affects the angle 
error. These are normalized derivatives of the magnetic field:
	
E
B
z
B
z
x
T
B
z
B
z
z
y
y
y
y
=
(
)
∂
(
)
∂
=
−
(
)
∂
(
)
∂
1
0 0
0 0
1
0 0
0 0
2
2
, ,
, ,
, ,
, ,
and
	 (7.12a,b)
at the axial position z  = εz  +  δ z   of the sensor. For the ideal case of homoge-
neous magnetic fields, E   =  T   =  0, so that many error terms of Equations  7.11a 
through 7.11j vanish. The T -function is more intuitive because it means 
that the diametrical field component of the magnet on the sensor should 
have zero slope versus axial distance. However, it is also highly recom-
mended that the E -function vanishes. The meaning of the E -function is 

228
Magnetic Sensors and Devices
readily explained in a scan of the angle homogeneity over the chip surface 
according to [37]: Suppose the magnet is in position ϕ = °
0 . Then, the in-
plane component of the field on the chip (in the absence of assembly toler-
ances) is per definition parallel to the y -direction. If the sensor elements are 
shifted laterally off the rotation axis at position (x ,y ), they detect the angle 
tan
,
,
′ =
(
)
(
)
ϕ
B
x y
B
x y
x
y
. Thus, the angle error (or angle non-homogeneity) 
is tan
tan
tan
∆ϕ
ϕ
ϕ
ϕ
=
−′
(
) =
−′
(
)
0
=
(
)
(
)
B
x y
B
x y
x
y
,
,
. We develop the field 
components into a Taylor series up to second order.
	
B
x y
B
B
x
x
B
y
y
B
x
x
x
x
x
x
x
,
,
,
,
,
(
) =
(
)+ ∂
(
)
∂
+ ∂
(
)
∂
+
∂
(
)
∂
+
0 0
0 0
0 0
1
2
0 0
1
2
2
2
2
0 0
0 0
2
2
2
2
∂
(
)
∂
+ ∂
(
)
∂∂
B
y
y
B
x y
xy
x
x
,
,
	
(7.13a)
Due to the symmetry of the magnet, only the last term does not vanish 
[39]. Therefore, the non-homogeneity of the angle in this xy -scan* is equal to
	
∆ϕ
σ
ε
χ
≅
−
(
)
∂
(
)
∂∂
→−
(
)
1
0 0
0 0
2
2
2
2
B
B
x y
xy
E
y
x
r
,
,
sin
	
(7.13b)
In Equation  7.13b, we used ∂
∂= ∂
∂
B
y
B
x
x
y
, which follows from 
curlB


= 0, and we used x
y
r
r
=
=
ε
χ
ε
χ
cos ,
sin
 from Equation  7.7e. This kind 
of (x ,y )-angle scan is a method to measure the E -function and it also explains 
the name eccentricity-function E  in contrast to tilt function T  [39].
 In general, large magnets have smaller shape functions (cf. Table  III in 
[38]). Therefore, one should prefer large ferrite magnets over small rare-earth 
magnets for perpendicular field angle sensors. It is also known that magnets 
with stud holes facing the sensor elements can be designed to have E   =  T   =  0 
[40]. Such an optimization of the magnet is by far (!) the most effective way 
to minimize angle errors.
In Equation  7.10c, the five terms which contain r 1  account for the finite size 
of the sensor system. We discussed their influence on angle errors in [38]. 
Here, we briefly report these results:
	
1.	The finite size of the sensor elements adds a notable error to typical  
angle errors; however, it adds only a small error to worst-case  angle 
errors.
*	 It is difficult to obtain accurate values of the E -function from lateral scans of diametrical field 
components, because of the second derivative involved. Therefore, it is simpler to measure 
the angle of the diametrical field in the (x ,y )-plane at a fixed position of the magnet, and fit 
the data to Equation  7.13b.

229
Magnetic Angle Sensors
	
2.	The finite size of the sensor elements adds no angle error if the shape 
functions of the permanent magnet vanish (E   =  T   =0).
	
3.	The layout of the sensor elements can be optimized to add no angle 
error due to finite size (even for magnets with non-vanishing shape 
functions). In such optimized layouts, the elements of each bridge 
must fulfill three requirements (see Figure  3 in [42], the same holds 
also for AMRs: see equations  21 and 22 in [40] and Figure  4 in [32]).
	
a.	 Their gravity centers must lie on the rotation axis.
	
b.	 Their deviation moments must vanish.
	
c.	 Their moments of inertia around the x -axis must be equal to 
those around the y -axis.
In the following discussion, we assume an optimized layout so that we can 
skip the terms with r 1  in Equation  7.10c.
The output signals of the bridge circuits at 1  V supply voltage are
	
S
R
R
R
R
R
R
S
R
R
R
R
R
R
x
y
=
+
−
+
=
+
−
+
2
2
3
4
1
4
6
6
7
8
5
8
and
	
(7.14a,b)
We insert Equation  7.10 into Equations  7.8 and 7.14 to get the signals as 
functions of rotational position and tolerances. Since offsets o i   and orthogo-
nality errors τi  are small, we may develop the signals into a Taylor series 
in these parameters. For GMRs, we may consider the magnetic sensitivities 
h i   similarly small as assembly tolerances, yet for TMRs this is not the case. 
Therefore, in contrast to [38– 40], we replace h
h
dh
i
i
→
+
 where h  is the average 
magnetic sensitivity of all MR elements and dh i  is the sensitivity mismatch of 
the i th element. Then, we develop the signals into a Taylor series in dh i  . The 
calculation can be done in a single step, for example, with MATHEMATICA, 
if we multiply all small parameters dh
dh o
o
r
r
1
8
1
8
1
8
…
…
…
,
,
, , ,
,
τ
τ β λ δ ε  with the 
multiplier s  (s  denotes “ small” ). Then, we develop the signals into a Taylor 
series in s  keeping terms up to s ² . Afterward, we may take out s  from the 
result by setting s   =  1. This procedure gives
	
S
h
s
s
S
h
s
x
x
x
y
y
= −
+
+
+
(
)+ ∂
+ ∂
= −
+
+
+
(
)+ ∂
+
σ
α
γ
ϕ
ϑ
σ
α
γ
ϕ
ϑ
2
2
1
2 2
1
sin
cos
and
∂ys
2 2
	
(7.15a,b)
where ∂
∂
x
y
1
1
,
 are first-order and ∂
∂
x
y
2
2
,
 are second-order error terms in the 
tolerance parameters dh
dh o
o
r
r
1
8
1
8
1
8
…
…
…
,
,
, , ,
,
τ
τ β λ δ ε . In the dominant terms 
of Equation  7.15a,b, the angles α γ ϑ
, ,
 are added to ϕ. These angles are not 
small, so we cannot shift them into the error terms. They were used to take 
account of the most general tilts of magnet and sensor, because they are not 

230
Magnetic Sensors and Devices
only tilted around their y -axes, but also around any axis in their (x ,y )-planes. 
So, both magnet and sensor were first twisted in their (x ,y )-planes by α and γ, 
respectively, before being tilted out of their (x ,y )-planes. ϑ  is a final twist of 
the sensor layout in the chip plane. Of course, all these twists add up to the 
angle error, but they are easily calibrated out when one defines 0°  at a specific 
reference position after the system has been assembled. This just means that 
we shift the zero point from ϕ = °
0  to ϕ
α
γ
ϑ
= ° −
−
−
0
. The exact rotational 
position of the shaft is the “ mechanical”  angle ϕ , but the sensor computes 
the angle ′ =
{
} −
−
−
ϕ
α
γ
ϑ
arctan
,
2 S
S
y
x
. We call the difference between the 
true angle ϕ and the estimated angle ′
ϕ  the delta angle ∆ϕ. It holds
∆
∆
ϕ
ϕ
ϕ
ϕ
α
γ
ϕ
ϑ
α
γ
ϕ
ϑ
α
γ
ϕ
ϑ
≅
=
−′
(
) =
+
+
+
(
) −
+
+
′ +
(
)
(
)
=
+
+
+
(
) −
tan
tan
tan
tan
tan
tan
tan
α
γ
ϕ
ϑ
α
γ
ϕ
ϑ
α
γ
ϕ
ϑ
+
+
′ +
(
)
−
+
+
+
(
)
+
+
′ +
(
)
1
	
(7.16a)
In Equation  7.16a, we replace tan
tan
α
γ
ϕ
ϑ
+
+
′ +
(
) =
(
)
S S
x
y , insert 
Equation  7.15a,b, and make again a series expansion.
∆
∆
∆
ϕ
ϕ
ϕ
µ
α
γ
ϕ
ϑ
ν
α
γ
ϕ
ϑ
ϕ
≅
+
+
+
+
+
(
)
(
) +
+
+
+
(
)
(
)
=
const
opt
n
n
n
n
n
cos
sin
,1 2, , ,
3 4 6
∑
	
	
+
+
−
−
(
)
+
+
+
(
)
−
+
+
+
(
)
(
)
−
+
−
σ
α
γ
ϕ
ϑ
α
γ
ϕ
ϑ
σ
8
4
8
1
2
3
4
2
2
5
6
h o
o
o
o
h
h o
o
cos
sin
o
o
h
7
8
2
2
4
−
(
)
+
+
+
(
)
−
+
+
+
(
)
(
)
sin
cos
α
γ
ϕ
ϑ
α
γ
ϕ
ϑ
	
	
−
+
+
+
(
)
+
+
+
+
+
−
−
+
+
+
(
)


cos
sin
2
1
2
3
4
1
2
3
4
4
8
α
γ
ϕ
ϑ
τ
τ
τ
τ
σ τ
τ
τ
τ
α
γ
ϕ
ϑ
G h

	
	
−
+
+
+
(
)
+
+
+
+
+
−
−
+
+
+
(
)


sin
cos
2
5
6
7
8
5
6
7
8
4
8
α
γ
ϕ
ϑ
τ
τ
τ
τ
σ τ
τ
τ
τ
α
γ
ϕ
ϑ
G h

	
	
+
+
+
+
(
)
−
+
+
+
(
)
−
+
−
−


σ
α
γ
ϕ
ϑ
α
γ
ϕ
ϑ
4
2
2
2
1
2
3
4
cos
sin
Gh
Gh
dh
h
dh
h
dh
h
dh
h


−
+
+
+
(
)
−
+
+
+
(
)
−
+
−
−
σ
α
γ
ϕ
ϑ
α
γ
ϕ
ϑ
4
2
2
2
5
6
7
8
sin
cos
Gh
Gh
dh
h
dh
h
dh
h
dh
h
dh
h
dh
h
dh
h
dh
h
dh
h
dh
h
dh
h




−
+
+
+
(
)
+
+
+
−
−
−
−
sin2
8
1
2
3
4
5
6
7
α
γ
ϕ
ϑ
dh
h
8



	(7.16b)

231
Magnetic Angle Sensors
	
∆ϕ
λ
α
γ
ϕ
λβ
α
α
γ
ϕ
ϕ
opt = (
)
+
+
(
)+
+
+
(
)
2 4
2
2
2
sin
sin
cos
	
	
−
+
+
(
)+
+
+
+
(
)+
+
+
(
)




σε
βε
α
χ
ϕ
δ
α
χ
η
ϕ
ε
α
χ
ϕ
r
z
r
r
E
sin
sin
sin
2
2
2
2
2
	
	
−
+
+
(
)
+
[
]
(
+
+
+
(
)
+
+
+
σ
λ
α
γ
ϕ βε
α
δ
η
ε
α
χ
ϕ
β
α
λ
α
γ
T
z
r
r
cos
sin
sin
sin
cos
cos
ϕ
(
)

) 	
(7.16c)
Equation  7.16b is valid for both GMRs and TMRs, whereby G   =  1 for GMRs 
and G   =  – 1 for TMRs. Obviously, the difference in the equation between GMRs 
and TMRs is small. ∆ϕconst  is a constant angle that does not depend on ϕ. 
∆ϕ
ϕ
opt  is the angle error of GMRs and TMRs caused by assembly tolerances— it 
was studied in detail in [36,38– 40]. The rest of Equation  7.16b gives angle errors 
caused merely by mismatches o dh
i
i
i
,
,τ  of GMR/TMR elements, whereby µ n  ,v n  
are of second order and therefore they are small (µ n  ,v n   are different for GMRs 
and TMRs). Lines 2– 8 in Equation  7.16b give the dominant first-order GMR/
TMR mismatch terms. For the standard deviation of “ ex fab”  angle errors due 
to these first-order GMR/TMR mismatch terms from Equation  7.16b, we get 
~1°  for GMRs and ~0.22°  for TMRs with the values from Table  7.1.
∆ϕ
ϕ
opt  is identical to equation  25 in [39], if we sort out the constant angle 
terms independent of ϕ in [39]. Also, Equations  7.5 and 7.13b are special 
cases of Equation  7.16c.
In principle, Equation  7.16b gives the angle error “ ex fab”  (i.e., without cali-
bration) for every particular combination of tolerance parameters at a specific 
rotational angle. We are not usually interested in the angle error at a specific 
rotational position, but we want to judge the delta-angle in the full 0° – 360°  
range. Typically, the plot “ ∆ϕ versus ϕ”  will be a wavy line that meanders 
between two extreme values ∆
∆
ϕ
ϕ
min
max
,
. Both extremes may be symmetric 
to zero or not— in case they are not symmetric, we can make them symmet-
ric by changing our reference point ϕ = °
0 . Thus, in most applications, one is 
mainly interested in the error band ∆
∆
ϕ
ϕ
max
min
−
. If we select the reference 
point ϕ = °
0  in an optimum way, the largest possible angle error within 360°  
will be AE =
−
(
)
∆
∆
ϕ
ϕ
max
min
2.
7.3.1.1  Autocalibration of GMR Angle Sensors for 
Continuously Rotating Shafts
To make the situation even more complex, commercial sensors often use cali-
bration routines, which are continuously executed during operation. This so-
called autocalibration estimates the deviation of signals S x  ,S y   from the ideal 
sine waves (cf. Equation  7.15a,b).

232
Magnetic Sensors and Devices
Obviously, the signals S x  ,S y   suffer from offset error. It is not just depending 
on the oi , because the four resistances of each bridge have different sensitivi-
ties h i   and different phase errors τi , so that a mixture of all these tolerances 
will add up to the signal offset. At a continuous rotation over 360° , the sensor 
circuit can estimate these offset errors, for example, by computing the signal 
averages:
	
o
S d
h
o
o
o
o
h
h
dh
dh
dh
dh
x
x
=
=
−
(
)
+
−
−
+
−
−
+
−
−
=∫
1
2
8
32
4
2
0
2
2
1
2
3
4
1
2
3
4
π
ϕ
ϕ
π
16
16 2
8
64
1
2
2
2
3
2
4
2
2
2
1
2
2
2
3
2
4
2
+
+
−
−
−
(
)
−
−
(
)
+
−
−
−
dh
dh
dh
dh
h
h
o
o
o
o
h dh
dh
o
o
dh
dh
o
o
h
T
T
z
r
1
4
1
4
2
3
2
3
32
+
(
)
−
(
)+
+
(
)
−
(
)
+
−
(
)
−
λ
ϑ β σ
ε
α
δ
cos
sin
sin
cos
sin
sin
sin
η
ε β
α
χ
γ
ϑ
βε
α
χ
γ
ϑ
δ
χ
η
γ
ϑ
4
−
−
−
(
)+
+
−
−
(
)+
+
−
−
(
h
T
E
E
r
z
r
)
4
	
(7.17)
From Equation  7.17, we obtain the average o y   of the S y  -signal by increas-
ing the indices of o i  , dh i   by four and replacing sin
cos
→−
 and cos
sin
→−
 
except for sin ,cos ,sin
α
α
η. In the calculation of Equation  7.17, the sensor 
does not know the exact angles ϕ, but it can use its estimations ′
ϕ  to cor-
rect the offset error and obtain an improved estimation ′′
ϕ . After several 
iterations, this procedure converges to the accurate value of the mechani-
cal angle ϕ. Alternatively to the integration in Equation  7.17, the sensor can 
sample minimum and maximum values of S x  ,S y   and estimate the offset by 
(max  +  min)/2. This will lead to slightly different results than Equation  7.17: 
in a strict sense it will not give the precise signal offset because by chance 
several errors may incidentally add up right near a maximum or minimum. 
However, in practice the differences between both offset estimation methods 
seem negligible, especially if the offset is small.
The signal offsets o x  ,o y   in Equation  7.17 are a mixture of ohmic offsets of 
the MRs o i  , of magnetic sensitivity mismatches dh i  , of tilts β ,λ  and eccen-
tricities εr  ,δ r  , and of non-homogeneity of the field of the permanent magnet 
E ,T . This may be problematic if the sensor is calibrated in an end-of-line test 
by the semiconductor manufacturer prior to its final installation. The signal 
offsets o x  ,o y   are not only affected by MR parameters but also by assembly 
tolerances and the magnet used in the end-of-line test. If they are stored in 
the memory of the sensor chip, they will not be exact for later use in the 

233
Magnetic Angle Sensors
application, where a different magnet is used and different assembly toler-
ances occur. Therefore, it is vital that the magnet during the end-of-line test 
is optimized according to β   =  E   =  T   =  0.
In fact, Equation  7.17 is just the first term of a Fourier series expansion of 
S x  , which we can write in the following form with A x,n    ≥   0, A y,n    ≥   0:
	
∑
∑
(
)
(
)
(
)
(
)
=
+
α + γ+ ϕ + ϑ + τ
=
+
α + γ+ ϕ + ϑ + τ
=
∞
=
∞
S
o
A
n
S
o
A
n
sin
and
cos
x
x
x n
x n
n
y
y
y n
y n
n
,
,
1
,
,
1
	
(7.18a,b)
with large A x  ,1 ,A y  ,1 , small A x  , n  ,A y  , n   for n   ≥   2 and small o x  ,o y  . Autocalibration 
estimates the signal amplitudes:
	
A
S
n
d
S
n
d
x n
x
x
,
cos
sin
=
(
)



+
(
)




∫
∫
1
0
2
2
0
2
2
π
ϕ
ϕ
ϕ
ϕ
π
π
	
(7.19)
For A y  , n  , we simply replace S
S
x
y
→
 in Equation  7.19. From Equation  7.18, we 
get for the signal orthogonality errors:
	
sin
sin
sin
cos
,
,
τ
τ
ϕ
ϕ
ϕ
ϕ
ϕ
ϕ
π
π
x n
y n
x
y
x
S
n
d
S
n
d
S
n
d
S
−
(
)
=
(
)
(
)
+
(
)
∫
∫
0
2
0
2
y
x n
y n
n
d
A
A
cos
,
,
ϕ
ϕ
π
π
π
(
)
∫
∫
0
2
0
2
2
	
(7.20a)
	
cos
sin
cos
cos
,
,
τ
τ
ϕ
ϕ
ϕ
ϕ
ϕ
ϕ
π
π
x n
y n
x
y
x
S
n
d
S
n
d
S
n
d
−
(
)
=
(
)
(
)
−
(
)
∫
∫
0
2
0
2
0
2
0
2
2
π
π
ϕ
ϕ
π
∫
∫
(
)
S
n
d
A
A
y
x n
y n
sin
,
,
	
(7.20b)
The sensor constructs new orthonormal signals from Equation  7.18a,b with 
ϕ
ϕ
τ
=
+
x,1 :
	


S
S
o
A
x
x
x
x
=
−
=
+
+
+
(
)+
,
sin
1
α
γ
ϕ
ϑ
higher harmonics 	
(7.21a)

234
Magnetic Sensors and Devices
	 


S
S
o
A
S
y
y
y
y
x
x
y
x
y
=
−
(
)
−
−
(
)
−
(
)
=
+
+
+
,
,
,
,
,
sin
cos
cos
1
1
1
1
1
τ
τ
τ
τ
α
γ
ϕ
ϑ
(
)+ higher harmonics 	
(7.21b)
where the higher harmonics are proportional to A
A
x n
x
,
,1  and A
A
y n
y
,
,1  
with n   ≥   2 according to Equation  7.18a,b. The sensor computes the angle 
′ =
(
) −
−
−



ϕ
α
γ
ϑ
arctan S
S
x
y
. After a lengthy calculation where we insert 
Equation  7.15 into Equations  7.19 through 7.21, we get the angle error ∆ϕ  
after autocalibration of the first harmonic
  
∆
∆
∆






ϕ
ϕ
ϕ
ϕ
ϕ
µ
α
γ
ϕ
ϑ
ν
ϕ
≅
−′
(
) =
+
+
+
+
+
(
)
(
)+
tan
cos
sin
const
opt
n
n
n
n α
γ
ϕ
ϑ
+
+
+
(
)
(
)
=∑
n 1 2 3 4 6
, , , ,
	
	
+
+
+
+
(
)
(
)
+
−
−
(
)
+
+
+
(
)+
+
−
−
(
)
σ
α
γ
ϕ
ϑ
α
γ
ϕ
ϑ
h
o
o
o
o
o
o
o
o
cos
cos
s
2
1
2
3
4
5
6
7
8
in α
γ
ϕ
ϑ
+
+
+
(
)
16
	
	
−
+
+
+
(
)
(
)
+
−
−
(
)
+
+
+
(
)+
+
−
−
(
)
σ
α
γ
ϕ
ϑ
τ
τ
τ
τ
α
γ
ϕ
ϑ
τ
τ
τ
τ
hsin
cos
s
2
1
2
3
4
5
6
7
8
in α
γ
ϕ
ϑ
+
+
+
(
)
16
	
+
+
+
+
(
)
(
)
+
−
−
(
)
+
+
+
(
) +
+
−
σ
α
γ
ϕ
ϑ
α
γ
ϕ
ϑ
cos
cos
2
1
2
3
4
5
6
7
dh
dh
dh
dh
dh
dh
dh −
(
)
+
+
+
(
)
−
(
)
dh
h
8
8 2
sin α
γ
ϕ
ϑ 	
(7.22a)
	
∆
∆
ϕ
ϕ
ϕ
ϕ
opt
opt
=
2 	
(7.22b)
∆ϕconst  is a constant angle that does not depend on ϕ . In many cases, it is irrele-
vant. ∆ϕ
ϕ
opt  gives the ϕ -dependent angle error after autocalibration for van-
ishing mismatches of GMR elements o
o
o
dh
dh
1
2
8
1
8
1
8
0
=
=
=
=
=
=
=
…
…
…
τ
τ
, 
whereas ∆ϕ
ϕ
opt  in Equation  7.16b is the same error without  autocalibration. It is 
of second order in the small parameters of assembly tolerances (β
λ
δ
ε
2
2
2
2
,
,
,
,
r
r
β λ ,β δ ,λ δ r  ,λ  εhr  ,δ rεhr  ). Hence, the first harmonic autocalibration of GMRs halves 

235
Magnetic Angle Sensors
angle errors due to assembly tolerances ! The second line in Equation  7.22a are 
second-order errors caused by offset, gain mismatch, and orthogonality 
errors of the MRs. They are proportional to o o dh dh
o dh dh
o
i
j
i
j
i
j
i
j
i
j
i
j
,
,
,
,
,
τ τ
τ τ
 and 
vary versus nϕ with n   =  1,2,3,4,6 ( 

µ
ν
5
5
0
=
=
). Lines number three to eight in 
Equation  7.22a are first-order errors caused by offset, gain mismatch, and 
orthogonality errors of the MRs o
o dh
dh
1
8
1
8
1
8
…
…
…
,
, τ
τ . Fortunately, there 
are no mixed terms proportional to o
dh
o
i
i
i
r
i
r
β
λ τ δ
ε
,
,
,
… in Equation  7.22a: The 
angle error after autocalibration scheme is simply a linear superposition of MR mis-
matches and assembly tolerances . It is a plain sum of two errors, where the first 
error is caused by MR mismatches in the absence of assembly tolerances, 
and the second error is caused by assembly tolerances in the absence of MR 
mismatches.
Due to its second order, the error ∆ϕ
ϕ
opt  is small for single error param-
eters (i.e., if one considers only sensor eccentricity εr   or only magnet tilt β ). 
However, in rare cases there are worst-case combinations of all error param-
eters, which are significantly larger. In Figure  8 of [38], we showed that 0.1% 
of all assembled systems with an optimized layout have six (!) times larger 
error than the median. The explanation for rare outliers are the mixed terms 
β λ ,β δ r ,β εr  ,λ δ r  ,λ εr  ,δ rεr  , which make the total error larger than the sum of only 
four individual errors β
λ
δ
ε
2
2
2
2
,
,
,
r
r . In practice, the combinations of tilts and 
eccentricities (β δ r  ,β ε r  ,λ δ r  ,λ ε r  ) give the largest angle errors, while combina-
tions of both tilts or combinations of both eccentricities are less severe. The 
rare outliers are a consequence of the high degree of symmetry of this sensor 
arrangement: the sensor elements are located at the rotation axis, which is 
the symmetry center of the magnetic field. Due to this symmetry, all relevant 
first-order derivatives vanish and so the dominant terms in the angle error 
are of second order. For typical systems, this gives high accuracy, but for 
very rare cases the large number of second-order error terms can sum up to 
much larger errors.
Conversely, the first-order terms generally have a larger impact on the typ-
ical performance and they contribute less to the rare outliers. Interestingly, 
they are proportional to the magnetic sensitivity h . We compute the stan-
dard deviation of this linear sum of MR-mismatch terms by summing their 
squares and taking the square root:
	
h
dh h
h
o
i
i
8
2
2
2
2
2
2
2
2
stdev
stdev
{
}
−



+
{ }
(
)






+
+
+
cos
α
γ
ϕ
2
2
2
2
2
2
2
ϑ
τ
α
γ
ϕ
ϑ
(
)
+
{ }
(
)
+
+
+
(
)
stdev
i
sin
	 (7.22c)
Equation  7.22c has a small ripple versus ϕ  but a four times larger mean 
value. Inserting the values of Table  7.1 gives ~0.002°  for GMRs and ~0.02°  
for TMRs (whereby we tacitly assume that the results for GMRs can also be 

236
Magnetic Sensors and Devices
applied to TMRs despite the small differences in Equation  7.3a,b). Compared 
to the “ ex fab”  values of Table  7.1, this is an improvement of factor 540 for 
GMRs and only 19 for TMRs (whereby we set the given worst-case values 
equal to six times the standard deviation).
For the second-order mismatch terms (i.e., the second line in Equation  7.22a), 
an evaluation is tedious due to the large number of terms. We expect rather 
small errors, because already the first-order terms were small.
To sum up, autocalibration of the first harmonic very effectively suppresses off-
set, gain mismatch, and orthogonality errors of the MRs, but it only halves errors 
caused by assembly tolerances . It should be noted that there are more elabo-
rate schemes of autocalibration, including higher harmonics, and they lead 
to further improvement of angle errors. Finally, for continuous rotations, it 
seems only a matter of computational effort to achieve angle accuracies bet-
ter than 0.1°  irrespective of the magnetic field sensing technology.
7.3.2  Assembly Tolerances, Offset, Gain Mismatch, and 
Misalignment in AMRs, VHalls, and HHalls with IMC
Angle sensors with VHall effect devices can be treated similarly to GMRs/
TMRs. VHalls also detect the in-plane magnetic field component and the 
system has two groups of VHalls, one that detects the x -component and one 
that detects the y -component of the in-plane field. These signals also suffer 
from offset errors (despite spinning schemes), gain mismatch, and small non-
orthogonality. Again, these errors lead to first-order terms of the angle error 
and again autocalibration can suppress them to values far below 0.1° . Tilts and 
eccentricities lead to exactly (!) the same angle errors as given in Equation  7.16c.
AMR angle sensors also respond to in-plane magnetic fields. They behave 
similarly to GMRs/TMRs and again Equation  7.16c describes their errors 
caused by tilts and eccentricities [40].
Surprisingly, Equation  7.16c also applies for angle sensors with four Hall 
plates regularly spaced near the perimeter of a 210 µ m large and 24 µ m thick 
IMC: the same shape functions apply as for perpendicular field angle sen-
sors, and so the same magnets can be used, and assembly tolerances lead 
to the same angle error. Yet, additional angle errors show up if the IMC 
gets larger or the Hall plates are not perfectly centered against the IMC. 
On the other hand, block-shaped magnets lead to systematic angle errors 
at the fourth harmonic sin 4ϕ
(
) — in this single respect the sensor resem-
bles an axial field-gradient angle sensor , which needs diametrically magne-
tized magnets of rotational geometry (cf. Section  7.4). All these properties 
can be proven by an analytical calculation similar to [39] but in oblate 
spheroidal coordinates, where the scalar magnetic potential is developed 
into a series of associated Legendre polynomials evaluated for imaginary 
arguments.
To sum up, all perpendicular field angle sensors behave very similar with 
respect to assembly tolerances.

237
Magnetic Angle Sensors
7.4  Field-Gradient Angle Sensors
Axial field-gradient angle sensors are less intuitive than perpendicular 
field angle sensors. The basic idea is to sample the pattern of the axial field 
in a plane orthogonal to the rotation axis: B z  (x,y ). The motivation is that the 
(x ,y )-plane can be a chip surface and one can use ordinary Hall plates to sam-
ple the axial field. Of course, small magnets with diametrical magnetization 
not only generate a large diametrical field, but they also generate a useful 
axial field except right on the rotation axis. Thus, as long as the chip sur-
face extends far enough from the rotation axis, a reasonable B z  field can be 
detected there. In fact, we need not be worried about the exact shape of the 
magnet— it can be very general, asymmetric, and mounted eccentrically and 
tilted. In any case, it will produce an asymmetric (i.e., not rotationally sym-
metric) B z  pattern on the chip. We may arrange a large number of Hall plates 
on a reading circle of 0.5– 1.5  mm radius on the chip surface. The center of 
the reading circle should lie on the rotation axis. Obviously, the B z  field on 
the reading circle is a periodic function of azimuthal position ψ , and so we 
can express it as a Fourier series. The first harmonic of this Fourier series has 
a certain phase, which rotates synchronously with the shaft. This phase can 
be obtained via a spatial Fourier transform over 0
2
≤
<
ψ
π . Since the sensor 
chip has only a finite number of N  sample points, it has to approximate the 
Fourier series by a discrete Fourier series. Then, the first harmonic is given by
	 F
B
R
R
j
d
N
B
R
R
j
z
r
z
r
m
m
m
1
0
2
1
2
1
=
=
(
)
(
)
→
=
=
(
)
(
)
∫
( )
( )
π
ψ
ψ
ψ
ψ
ψ
ψ
π
,
exp
,
exp
=
−
∑
0
1
N
	 
(7.23a)
with j =
−1. The Hall plates are located on the reading radius R r   at equi-
distant azimuthal spacing ψ
m
m N
( ) =
°×
360
 with m   =  0,1,… ,  N   –   1. From 
Equation  7.23a, the sensor computes the estimated rotation angle with 
′ =
{ }
{ }
{
}
ϕ
arctan
Re
,Im
2
1
1
F
F
. Note that this sensor principle does not 
require any specific properties of the magnet, except that the B z  field is suf-
ficiently strong to be detectable. It is also obvious that a homogeneous mag-
netic background field superimposed on the sensor will be cancelled out 
in Equation  7.23a. This is a very important advantage of this type of angle 
sensor: it is much more robust against magnetic disturbances than the per-
pendicular field angle sensors discussed in earlier chapters.
However, in practice, one has to limit the number of Hall plates to N   ≤   4: on 
the one hand, they consume a lot of current and use much space on the chip. 
On the other hand, one needs a signal path for each Hall plate because the real 
and imaginary parts of Equation  7.23a are linear combinations of Hall plate sig-
nals with “ odd”  coefficients cos
,sin
2
2
π
π
m N
m N
(
)
(
). It is not economical to 

238
Magnetic Sensors and Devices
implement these linear combinations in an analog signal domain; instead, one 
should convert each Hall signal from analog to digital and compute the linear 
combinations Re{F 1 } and Im{F 1 } in the digital domain. Hence, this costs a large 
number of A/D converters. Therefore, one is bound to limit the number of Hall 
plates. However, this means that the discrete Fourier transform returns a phase 
that may deviate significantly from the rotation angle, depending on the B z  pat-
tern, that is, on the magnet. An early system [35] proposes N   =  4, which gives
	
F
B
R
R
B
R
R
j B
R
R
B
R
R
z
r
z
r
z
r
z
r
1
0
180
90
∝
=
= °
(
) −
=
=
°
(
)
+
=
=
°
(
) −
=
=
,
,
,
,
ψ
ψ
ψ
ψ
270°
(
)
(
) 	
(7.23b)
The nice feature of Equation  7.23b is that we can connect opposite Hall 
plates so that their signals subtract and then we need only two A/D convert-
ers— one for the real part and one for the imaginary part. From Equation  7.23b 
it becomes obvious why we call this type of sensor system a gradiometer , 
because it responds only to gradients of the B z  field and not to absolute val-
ues of the B z  field. It cancels out homogeneous disturbance fields.
The small number of Hall plates may lead to systematic angle errors: sup-
pose a general magnetic field pattern expressed as a Taylor series around 
the rotation axis B
x y
c
x y
z
m
n
m n
m
n
,
,
(
) = ∑
∑
=
∞
=
∞
0
0
. A rotation of the magnet is 
described by the rotational coordinate transformation where a point on the 
reading circle with coordinates R
R
r
r
cos
,
sin
ψ
ψ  transforms into the rotated 
coordinates x
R
y
R
r
r
=
−
(
)
=
−
(
)
cos
,
sin
ψ
ϕ
ψ
ϕ . Inserting these two equa-
tions into Equation  7.23a with N →∞ (a continuous Fourier series instead 
of a discrete one) shows that F 1  contains only terms proportional to sinϕ  
and cosϕ , from which ϕ  can be inferred accurately. However, if we use 
Equation  7.23b instead of Equation  7.23a, F 1  contains additional error terms 
sin
, cos
, sin
, cos
,...
4
4
8
8
ϕ
ϕ
ϕ
ϕ
(
)
(
)
(
)
(
)
, from which the dominant ones are 
octupoles c 3,0 ,c 2,1 ,c 1,2 ,c 0,3 . In [36] it was shown by way of example that this 
may be relevant in practice for block-shaped magnets 6    ×  6 ×   3  mm (~0.7°  
error). In other words, diametrically magnetized magnets need to have rotational 
geometry  (e.g., cylindrical, conical, spherical) to generate ideal fields of the 
shape of a straight plane B z  (x ,y )  =  c 0,0   +  c 1,0 x   +  c 0,1 y  and this gives no system-
atic angle errors for axial field-gradient angle sensors with N   =  4 test points.
So, we can say that it is the principle of axial field-gradient angle sensors 
to detect the orientation of the B z  plane. To this end, we need at least three 
locations of Hall plates N   =  3, which gives
F
B
R
R
B
R
R
j
B
R
R
B
R
z
r
z
r
z
r
z
1
3
120
240
2
0
∝
=
=
°
(
) −
=
=
°
(
)
(
)
+
=
= °
(
) −
=
,
,
,
ψ
ψ
ψ
R
B
R
R
r
z
r
,
,
ψ
ψ
=
°
(
) −
=
=
°
(
)
(
)
120
240
	 (7.23c)

239
Magnetic Angle Sensors
Now F1 contains systematic error terms 
(
)
(
)
(
)
(
)
ϕ
ϕ
ϕ
ϕ …
sin 3
,cos 3
,sin 6
,cos 6
,
, from 
which the dominant ones are quadrupoles c 2,0 ,c 1,1 ,c 0,2 . Systems with N   =  3,4,5,…  
test points may also be used for through-shaft angle sensors on a much larger 
reading radius (cf. Figure  7.1).
We should mention that the original idea of sensing axial fields to detect 
the angular position of a small permanent magnet used only N   =  2 test 
points [43]. This was not a gradiometer and it used MAG-FETs instead of 
Hall plates.
Alternatively, the orientation of the B z  plane is determined by its zero 
crossing line B z  (x ,y )  =  0. At zero disturbance field, this line goes through 
the rotation axis because c 0,0   =  0 for diametrically magnetized magnets. A 
disturbance field shifts the B z  plane up or down thereby shifting the zero-
line B z  (x ,y )  =  0 parallel within the (x ,y )-chip surface. The orientation of the 
zero-line gives the rotation angle. This system does not rely on the linear-
ity of the sensing elements, because it only detects the zeros of B z . One can 
use MAG-FETs instead of Hall plates [44]. It needs many elements densely 
populating a closed curve around the rotation center and so it costs a lot 
of chip space.
All these types of axial field-gradient angle sensors with finite N  use 
derivatives of the magnetic field to estimate the rotation angle and this 
leads to larger errors caused by assembly tolerances. This is shown in 
detail in [36] with the same principles as in the preceding chapters. Here, 
we can report only the results for the condition “ ex fab”  (i.e., without 
calibration):
	
∆
∆
ϕ
ϕ
λ
α
γ
ϕ
λβ
α
α
γ
opt
const
axial
axial
=
+ (
)
+
+
(
)+
+
+
3
4
2
2
2
3
2
sin
sin
cos
ϕ
λβ
γ
ϕ
ε
βε
α
χ
ϕ
δ
α
χ
η
ϕ
ε
(
)+
+
(
)
+
+
+
(
)+
+
+
+
(
)+
sin
sin
sin
r
z
r
r
E
4
2
 axial
2
2
2
2
1
4
3
2
2
sin
sin
sin
α
χ
ϕ
βε
α
χ
ϕ
χ
ϕ
+
+
(
)




+
+
+
(
)+
+
(
)
(
)
T
r
axial 
+
+
+
(
) −
+
(
)
(
)
+
+
+
+
(
) −
−
βε λ
α
γ
ϕ
γ
ϕ
δ λ
α
η
γ
ϕ
α
z
r
3
2
2
3
2
sin
sin
sin
sin
η
γ
ϕ
ε λ
α
χ
γ
ϕ
+
+
(
)
(
)+
+
+
+
(
)
3
2
2
r sin
	
(7.24)
∆ϕconst
axial  denotes a constant angle shift independent of ϕ. The shape functions 
in Equation  7.24 differ from the shape functions of perpendicular field angle 
sensors.

240
Magnetic Sensors and Devices
	


E
B
R z
B
R z
z
T
R
z
z
z
z
R
axial
axial
and
=
=
(
)
∂
=
(
)
∂
=
→
→
lim
,
,
lim
0
2
2
0
1
1
ε
ε
B
R z
B
R z
z
z
z
z
z
,
,
=
(
)
∂
=
(
)
∂
ε
ε
	
(7.25)
Thus, axial field-gradient angle sensors prefer different magnets with 


T
E
axial
axial
=
= 0  (see also Section  7.5) and even for these optimized magnets 
the angle error is larger than for perpendicular field angle sensors (note the 
extra factor 3 in the first line of Equation  7.24 vs. Equation  7.16c, see also [36]). 
Using a computer code, we searched for the maximum AE -angle error for a 
given set of worst-case assembly tolerances and the same magnet for both 
types of angle sensors: A puck magnet was 2.5 mm thick with a 6 mm diam-
eter and homogeneous diametrical magnetization; the gap between sensing 
elements and magnet was 1.75  mm and the assembly tolerances were 5°  for 
both tilts, 0.3  mm magnet eccentricity, and 0.5 mm sensor eccentricity. Then, 
the worst-case “ ex fab”  AE -error for perpendicular field angle sensors is 2.4°  
and for axial field-gradient angle sensors it is 2.66°. So, the difference is only 
small, but this comes from the small magnet diameter, which favors axial 
field-gradient angle sensors. If we change the magnet diameter to 12  mm 
and keep all other parameters, the worst-case “ ex fab”  AE -errors are 0.88°  
and 1.74° , respectively. Here, we see that perpendicular field angle sensors 
can be easily designed to be much more robust against assembly tolerances 
than axial field-gradient angle sensors. To sum up, in practice we have to decide 
whether the angle sensor is robust against disturbance fields or robust against assem-
bly tolerances ! One possible remedy is to place both types of angle sensors on 
the very same chip so that they experience the same assembly tolerances [45]. 
Then, assembly errors can be calibrated with the perpendicular field angle 
sensor after installation of the system. Later, during operation in the field, 
the axial field-gradient angle sensor uses these calibration values.
Yet another group of field-gradient angle sensors  uses a rotationally sym-
metric magnet with axial magnetization and a ferromagnetic target that is 
not rotationally symmetric [46]. The target may be machined into the shaft. 
The bias magnet can be attached to the rotating shaft or to the sensor. The 
rotating asymmetric field pattern is generated by the target. The sensing ele-
ments are distributed on the chip to detect the phase of the first harmonic as 
in Equation  7.23a, yet the field component may be axial (B z  ) or diametrical 
(B x  , B y  ). For end-of-shaft angle sensors, the latter should be even more robust 
against magnetic disturbances than the former.
Axial field-gradient angle sensors with N   =  4 test points sample ∂
∂
B
x
z
 
and ∂
∂
B
y
z
; however, according to Maxwell’ s law curlB


= 0  this is equiv-
alent to ∂
∂
B
z
x
 and ∂
∂
B
z
y
. Thus, we can place a sensor chip in a leaded 
package upright on the rotation axis (z -axis), so that its long edge is parallel 
to the z -axis and its short edge is parallel to the y -axis. Two HHalls on the 

241
Magnetic Angle Sensors
z -axis spaced apart by 1.5  mm sample the B x  -field and their difference gives 
∂
∂
B
z
x
. Two VHalls on the z -axis spaced apart by 1.5  mm sample the B y  -field 
and their difference gives ∂
∂
B
z
y
. Both differences are like sinϕ and cosϕ  
from which the system can compute the rotation angle. We call this a dia-
metrical field-gradient angle sensor . Obviously, it cancels out homogeneous dis-
turbance fields.
7.5  Magnets for Magnetic Angle Sensors
In Figure  7.2, we show a classification scheme for magnetic angle sensors 
including common types of magnets. Basically, magnets should be cheap 
and supply a sufficiently strong field on the magnetic field sensing elements. 
But they should also provide a well-defined field pattern with sufficient 
homogeneity. For end-of-shaft sensors, we have to distinguish between per-
pendicular field angle sensors and axial field-gradient angle sensors. In the 
first case, magnets should apply a large diametrical field on the sensing ele-
ments located on the rotation axis, which leads to magnet diameters above 
8  mm and thicknesses around 2  mm. In the second case, magnets should 
apply a strong axial field gradient on the sensing elements located on the 
1–2  mm large reading circle around the axis of rotation, which leads to mag-
net diameters of less than 8  mm. In fact, the maximum B z  -field gradient is 
near 5  mm in diameter at ~5  mm thickness: for an axial spacing of 2  mm 
between sensing elements and magnet and at a remanence of 1  T the gradi-
ent is 44  mT/mm. For small shape functions E  and T  (cf. Equation  7.12a,b), 
we can simply increase the diameter of the magnets for perpendicular 
field angle sensors: it makes the field stronger and more homogeneous. For 
axial field-gradient angle sensors this does not work, because a larger mag-
net makes the field more homogeneous and so the gradient drops and the 
sensor signals drop, too! Conversely, for perpendicular field angle sensors 
we can even make both  shape functions vanish, by choosing a diametrical 
magnetization and introducing a stud hole into this side of the magnet, 
which faces the sensing elements (cf. Figure  7.8a). A stud hole for axial field-
gradient angle sensors was also proposed to make it robust against assem-
bly tolerances. Yet, the solution is of no practical use, because it drastically 
reduces the field gradient [36]. Figure  7.8b shows an alternative version of a 
magnet for vanishing shape functions in axial field-gradient angle sensors. 
Obviously, it is a ring axially spaced apart from a concentric short cylinder. 
In general, optimized magnets for perpendicular field angle sensors have a 
simple geometry and so they can be manufactured by injection molding or 
by sintering, whereas for axial field-gradient angle sensors it is difficult to 
optimize magnets— often they can only be manufactured by injection mold-
ing, which means weaker magnets. If we want a strong diametrical field with 

242
Magnetic Sensors and Devices
Non-
ferrous 
shaft
Optimized
magnet
(diam.
dipole)
Sensor 
package
Printed 
circuit 
board
(a)
Ferrous shaft
Plastic holder
Puck magnet
Sensor package
Ring magnet
Sensor dome
PCB
(b)
Non-
ferrous 
shaft
Magnet
(diam.
dipole)
Sensor 
package
Printed 
circuit 
board
(c)
FIGURE  7.8 
Various types of magnets for end-of-shaft angle sensors. (a) Diametrically magnetized puck magnet with a stud hole for perpendicular field angle 
sensors with E   =  T   =  0 and B diametral /B rem   =  0.058. The magnet is 10  mm in diameter and 2.5  mm thick; the hole is 4.72  mm in diameter and 0.5  mm in 
depth; the axial spacing magnet vs. XMRs/VHalls  =  0.8  mm [40]. (b) Assembly of a ring and a puck magnet, both with parallel diametrical magne-
tization, achieves 

E
T
axial
axial
=
= 0  at the axial field-gradient angle sensor in the center sensor dome. B rem   =  0.655  T, HcB  =  496  kA/m, ring: ID  =  8  mm, 
OD  =  16  mm, 4.5  mm thick, puck: OD  =  8  mm, 5  mm thick, axial distance ring vs. puck  =  4.2  mm, shaft: OD  =  6  mm, µ r    =  1500. B z   =  35  mT at R r   =  1  mm. 
(c) Conical magnet with diametrical dipole magnetization achieves strong diametrical field with a comparably small magnet volume. For a strong 
NdFeB magnet with 1.2  T remanence, an outer diameter of 20  mm, axial thickness of 10  mm, aperture angle 60° , axial spacing magnet vs. MRs/
VHalls  =  2  mm, the diametrical field is ~190  mT with E ≈−6700 m2, T ≈240 m.

243
Magnetic Angle Sensors
a limited amount of magnet material, the magnet should have a truncated 
cone geometry that can be manufactured of sintered NdFeB (cf. Figure  7.8c).
Simple block or puck magnets are often homogeneously magnetized in a 
diametrical direction— we call this a diametrical dipole. However, one can 
achieve larger fields on the sensing elements with axially magnetized quad-
rupoles; there, the magnetization in the right half is in the axial direction and 
in the left mirror symmetric half it is anti-parallel. So, they have no dipole 
moment* and their lowest-order multi-pole moment is a quadrupole, which 
has a stronger near-field and a weaker far-field. In practice, it is difficult to 
manufacture pure quadrupoles, so that one is bound to use a mixture of dia-
metrical dipole and axially magnetized quadrupole; then the magnetization 
is arc shaped (Figure  7.9). It is preferable to use magnets with rotational sym-
metry as they have smaller shape functions than block magnets for equal 
diameter (cf. Figure  3 in [39]). Moreover, as explained in Section  7.4, axial 
field-gradient angle sensors with N   =  4 have a systematic fourth harmonic 
error for non-rotational geometries like block magnets ([36]).
The field of diametrically magnetized ring magnets is closely related to 
the field of short cylinders, if we think in terms of fictitious magnetic charges 
[47]. At the perimeter of the cylinder there are charges with a surface den-
sity equal to the scalar product of magnetization and surface normal vec-
tor: σmagnetic
surface
=
⋅


M n
. The same holds for the bore and the perimeter of 
diametrically magnetized rings, yet with a different sign on both surfaces, 
because nsurface  points to the outside of the magnet volume. So, the ring is 
equal to two cylinders with anti-parallel diametrical magnetization. If the 
outer diameter of the ring is large, the field of the ring magnet near the axis 
is similar to the field of a cylinder with the ring’ s bore diameter, yet it points 
in the opposite direction. This principle has already been used in Figure  7.8b 
*	 Note that the dipole moment is the volume average of the magnetization. If a magnet consists 
of two equal halves with anti-parallel magnetization, the volume average vanishes, and we 
have no dipole moment, yet a strong quadrupole moment.
(a)
N N N N N
S S S S S S
N N N N N
S S S S S S
S
S
S S S 
N
N
N N N 
(b)
Dipole
=
+
Quadrupole
(c)
FIGURE  7.9 
Magnet with diametrical dipole and axially magnetized quadrupole. (a) Top and bottom view. 
(b) Arc-shaped remanent magnetization and equivalent surface magnetic charges “ North/
South-poles”  (volume charges also exist due to inhomogeneous magnetization, but they are 
not shown here). (c) Decomposition of arc-shaped magnetization pattern into dipole and 
quadrupole.

244
Magnetic Sensors and Devices
to construct a field with a symmetry plane orthogonal to the rotation axis 
and through the magnetic field sensing elements. We can use a single ring 
magnet with diametrical magnetization to replace a short cylinder. The ring 
magnet has the advantage that its center is accessible and the slope of the 
field versus the axial direction vanishes by symmetry, that is, the T -function 
vanishes. This arrangement causes the inconvenience that the sensor has to 
be placed inside the ring magnet. So, the inner diameter of the ring has to be 
large enough to prevent collision and the sensor package has to be precisely 
aligned to the field, which may require a sensor dome. However, it offers 
the additional advantage that we may pull a cylindrical ferrous sleeve over 
the ring magnet. If the sleeve is an integral part of the shaft, this minimizes 
eccentricities and we have an in-shaft sensor. The sleeve reduces external 
magnetic disturbances on the sensing elements by a factor ~30 as long as 
the sensing elements are sufficiently deep inside the bore (at least half a 
bore diameter). With variation in the permeability and wall thickness of the 
sleeve and with two or more concentric sleeves the shielding efficiency can 
be increased much further [48].
This ring magnet with homogeneous diametrical magnetization also mag-
netizes the ferrous sleeve. The resulting magnetization pattern in the sleeve 
prevents flux leakage to the outside of the sleeve and it also increases the 
field and its homogeneity on the sensing elements (see Figure  7.10a) [49]. This 
brings us to the idea that the magnetization pattern of the sleeve could also 
be used in the magnet ring itself— then the field on the axis would increase, 
it would be more homogeneous, and there would no longer be a field outside 
the ring. Such kinds of magnetization patterns are called Halbach magnetiza-
tion  [50]. They are described by the equation:
(a)
Diametrical with ferrous sleeve
Sleeve
Magnet
(b)
Halbach magnetization
nR
M
Magnet
(c)
Diametrical magnetization
M
Magnet
nR
FIGURE  7.10 
Magnetization vector field 

M in various magnet arrangements. (a) Homogeneous diametrical 
magnetization inside ferrous sleeve. (b) Magnet with Halbach magnetization without sleeve. 
(c) Magnet with homogeneous diametrical magnetization without sleeve. The magnetization 
in the sleeve of (a) has a similar pattern to the Halbach magnetization in (b). The angle between 
nR and 

M (at arbitrary test points) has identical magnitude but a different sign in cases (b) 
and (c).

245
Magnetic Angle Sensors
	





M
M
n
M
n
M
n
M
n
s
R
s
s
x
s
y
=
( )
−
( )
=
(
)
−
(
)
…
sin
cos
sin
cos
ψ
ψ
ψ
ψ
ψ
2
2
for Halbach magnetization 	
(7.26a)
	



 …
M
M
n
M
n
M n
s
R
s
s
y
=
( )
+
( )
=
sin
cos
ψ
ψ
ψ
for homogeneous diametrical magnetization 	
(7.26b)
The difference between homogeneous diametrical magnetization in the 
y -direction and Halbach magnetization is simply the sign of the azimuthal 
component (Figure  7.10b and c). Therefore, both magnetization patterns 
have the same surface magnetic charges σmagnetic
surface
=
⋅


M n
, but only the 
Halbach magnetization has additional volume magnetic charges due to the 
inhomogeneous magnetization ρmagnetic = −∇
= −
+
(
)

M
M y
x
y
s
2
2
2 . Hence, 
the magnetic field of a Halbach magnet is given by the field of a diametrical 
magnet plus an additional term— this holds in air and also inside a con-
centric ferrous sleeve. Note that the original paper by Halbach deals with 
magnets with infinite axial length (pure 2-D fields). In this case, a Halbach 
magnet, according to Equation  7.26a, has no external field and a diametrical 
ring magnet, according to Equation  7.26b, has no internal field. However, if 
the axial length of the magnet is finite, Halbach magnets have weak external 
fields and diametrical ring magnets have weak internal fields. Therefore, a 
Halbach magnet of finite axial length does interact with the ferrous sleeve, 
but this interaction is small: it does not saturate the sleeve nor does it cause 
a notable field dependency on the poorly defined µ r   of the sleeve or on the 
eccentric mounting of the magnet inside the sleeve. Since the sleeve is not 
exposed to a strong field of the magnet, care has to be taken to avoid residual 
magnetization of the sleeve by other strong magnets, which would again add 
some small disturbance field.
The results of an experimental prototype are shown in Figure  7.11. The mag-
net ring has an inner diameter of 16  mm, an outer diameter of 21.8  mm, and 
an axial length of 16  mm. It is an anisotropic plastic injection molded ferrite 
material called Sprox11/21p from Magnetfabrik Bonn with B rem   =  0.235  T. It was 
tried in order to achieve a magnetization pattern, which is close to an internal 
Halbach dipole. This goal was achieved reasonably well, because the strength of 
the field (~57  mT) decreases by only 1.7% when the magnet is placed inside the 
ferrous sleeve. On the other hand, the homogeneity is good but suffers notably 
due to the sleeve: E   ~  3500/m²  without the sleeve whereas E   ~  5100/m²  inside 
the sleeve— this corresponds to angle errors of AE   =  0.1°  and AE   =  0.15° , respec-
tively, if the sensor is placed 1  mm off the rotation axis (see Equation  7.13b). 
The magnet was mounted inside a sleeve with a 22  mm inner diameter and 
a 26  mm outer diameter made from steel DIN 1.0037-S235JR. As a sensor, we 
used a TLE5309D, which has two chips inside the package: one chip is mounted 

246
Magnetic Sensors and Devices
above the die-paddle and carries a GMR angle sensor while the other chip is 
mounted below the die-paddle and carries an AMR angle sensor. The axial 
spacing of AMR and GMR is only 0.56  mm and both are on the very same 
radial position to avoid systematic errors caused by eccentric sensor placement. 
The magnet arrangement is sketched in the inset of the plot in Figure  7.11: mag-
net and sleeve are flush. The axial position z  is zero at the entrance of the bore 
and increases when the test point moves inside the bore. The center of the mag-
net is at z   =  8  mm. The measurement results show quite low AE -angle errors 
over a large axial distance z   =  6–13   mm, whereby the AMR has smaller errors 
(~0.13° ) than the GMR (~0.27° ) when both are autocalibrated (results of GMR 
not shown in Figure  7.11). For sensor positions in the center of the magnet, a 
4  mT diametrical disturbance field gives ~0.1°  additional angle error.
References 
	
1. 	Audi MediaCentre. www.audi-mediacenter.com/en/press-releases/the-inno-
vative-shock-absorber-system-from-audi-new-technology-saves-fuel-and-
enhances-comfort-6551, Aug. 10, 2016, Ingolstadt.
	
2. 	Granig, W., S. Hartmann, and B. Kö ppl. Performance and Technology 
Comparison of GMR versus Commonly Used Angle Sensor Principles for 
Automotive Applications. No. 2007-01-0397. SAE Technical Paper, 2007.
0 mT
1 mT
2 mT
3 mT
4 mT
0
0.2
0.4
0.6
0.8
1
1.2
–3
0
3
6
9
12
15
18
21
24
AE-angle error (°)
z-position of AMR-sensing element (mm)
z
FIGURE  7.11 
AE -angle error measurement of a calibrated on-axis AMR in-shaft sensor versus axial position 
at diametrical disturbance fields of 0, 1,… , 4  mT. Inset shows magnet flush with hollow ferrous 
shaft at z   =  0 (z  increases with depth inside the bore). The magnet extends from z   =  0 up to 
z   =  16  mm (denoted by the dashed vertical line). The error is 0.023°  per millitesla disturbance 
field in the center of the magnet and it scales linearly with the disturbance field. For locations 
closer to the entrance or deeper in the sleeve, the angle error increases because of the non-ideal 
field of the magnet (see 0  mT-curve). At these locations, the magnet field weakens, so that the 
sensor gets more sensitive to disturbance fields that partly penetrate the sleeve.

247
Magnetic Angle Sensors
	
3. 	Van Der Meer, J. C., et al. A fully integrated CMOS Hall sensor with a 3.65 
µ T 3σ  offset for compass applications. ISSCC. 2005 IEEE International Digest of 
Technical Papers. Solid-State Circuits Conference, 2005.  IEEE, 2005.
	
4. 	Portelli, B., et al. Design considerations and optimization for 3-axis anisotropic 
magneto-resistive sensors. Electrotechnical Conference (MELECON) , 2016 18th 
Mediterranean . IEEE, 2016.
	
5. 	Angleviel, D., D. Frachon, and G. Masson. Development of a Contactless 
Hall Effect Torque Sensor for Electric Power Steering. No. 2006-01-0939. SAE 
Technical Paper, 2006.
	
6. 	Koci, P. The effect of air gap, wheel speed and drive angle on the anti-lock 
braking system efficiency. Carpathian Control Conference (ICCC) , 2011 12th 
International . IEEE, 2011.
	
7. 	Motz, M., et al. A chopped Hall sensor with small jitter and programmable 
“ true power-on”  function. IEEE Journal of Solid-State Circuits  40.7 (2005): 
1533– 1540.
	
8. 	Thomson, W. On the electro-dynamic qualities of metals: Effects of magnetiza-
tion on the electric conductivity of nickel and of iron. Proceedings of the Royal 
Society of London  8 (1856): 546– 550.
	
9. 	Bartos, A., A. Meisenberg, and R. Noetzel. Novel redundant magnetoresistive 
angle sensors. Sensoren und Messsysteme  (2006): 99– 102.
	 10. 	McGuire, T. and R. L. Potter. Anisotropic magnetoresistance in ferromagnetic 
3D alloys. IEEE Transactions on Magnetics  11.4 (1975): 1018– 1038.
	 11. 	Binasch, G., et al. Enhanced magnetoresistance in layered magnetic struc-
tures with antiferromagnetic interlayer exchange. Physical Review B  39.7 
(1989): 4828.
	 12. 	Dieny, B., et al. Giant magnetoresistive in soft ferromagnetic multilayers. 
Physical Review B  43.1 (1991): 1297.
	 13. 	Coehoorn, R. Giant magnetoresistance in exchange-biased spin-valve layered 
structures and its application in read heads. In U. Hartmann (ed.) Magnetic 
Multilayers and Giant Magnetoresistance . Springer, Berlin Heidelberg, 2000. 
65– 127.
	 14. 	Yamazaki, H., et al. Characteristics of TMR angle sensors. Proceedings SENSOR 
2011  (2011): B8 361– 365.
	 15. 	Sudo, Y., et al. Angle sensor having low waveform distortion. U.S. Patent No. 
7,265,540. 4 Sep. 2007.
	 16. 	Ausserlechner, U. GMR sensors having reduced AMR effects. U.S. Patent No. 
8,564,286. 22 Oct. 2013.
	 17. 	Hall, E. H. On a new action of the magnet on electric currents. American Journal 
of Mathematics  2.3 (1879): 287– 292.
	 18. 	Munter, P. J. A. A low-offset spinning-current Hall plate. Sensors and Actuators 
A: Physical  22.1 (1990): 743– 746.
	 19. 	Motz, M., and U. Ausserlechner. Electrical compensation of mechanical stress 
drift in precision analog circuits. In A. Baschirotto, P. Harpe, and K. A. A. 
Makinwa (eds) Wideband Continuous-Time Σ Δ  ADCs, Automotive Electronics, and 
Power Management . Springer International Publishing, Cham, 2017. 297– 326.
	 20. 	Ausserlechner, U. A method to compute the Hall-geometry factor at weak mag-
netic field in closed analytical form. Electrical Engineering   98.3 (2016): 189–206.
	 21. 	Ausserlechner, U. Simple formula for Hall-geometry factor of Hall-plates with 
90°  symmetry. UPB Science Bulletin Series A  78.1 (2016): 275– 282.

248
Magnetic Sensors and Devices
	 22. 	Ausserlechner, U. Closed form expressions for sheet resistance and mobility 
from Van-der-Pauw measurement on 90°  symmetric devices with four arbi-
trary contacts. Solid-State Electronics  116 (2016): 46– 55.
	 23. 	Banjevic, M. High bandwidth CMOS magnetic sensors based on the miniatur-
ized circular vertical Hall device. Thesis EPFL, Lausanne (2011).
	 24. 	Ausserlechner, U. Hall effect devices with three terminals: Their magnetic 
sensitivity and offset cancellation scheme. Journal of Sensors  2016, Article ID 
5625607, 16 pages, 2016.
	 25. 	Popovic, R. S. The vertical Hall-effect device. IEEE Electron Device Letters  5.9 
(1984): 357– 358.
	 26. 	Fluitman, J. H. J. Hall-effect device with both voltage leads on one side of the 
conductor. Journal of Physics E: Scientific Instruments  13.7 (1980): 783.
	 27. 	Udo, A. Limits of offset cancellation by the principle of spinning current Hall 
probe. Sensors , 2004. Proceedings of IEEE . IEEE, 2004.
	 28. 	Ruther, P., et al. Thermomagnetic residual offset in integrated Hall plates. IEEE 
Sensors Journal  3.6 (2003): 693– 699.
	 29. 	Banjevic, M., S. Reymond, and R. S. Popovic. On performance of series con-
nected CMOS vertical Hall devices. Microelectronics, 2008. MIEL 2008. 26th 
International Conference on . IEEE, 2008.
	 30. 	Motz, M. and U. Ausserlechner. Vertical Hall sensor with series-connected Hall 
effect regions. U.S. Patent No. 9,285,439. 15 Mar. 2016.
	 31. 	Stoica, D., and M. Motz. A dual vertical Hall latch with direction detection. 
ESSCIRC (ESSCIRC) , 2013 Proceedings of the . IEEE, 2013.
	 32. 	Kolbe, N., and M. Prochaska. Ü ber den Einsatz von hochintegri-
erten 
Magnetfeldsensoren 
im 
Antriebsstrang. 
GMM-Fachbericht-AmE 
2010-Automotive Meets Electronics  (2010), Conference proceedings, April 15–16, 
2010, VDE-Verlag, Berlin.
	 33. 	Drljaca, P. M., et al. Nonlinear effects in magnetic angular position sensor with 
integrated flux concentrator. Microelectronics , 2002. MIEL 2002. 23rd International 
Conference on . Vol. 1. IEEE, 2002.
	 34. 	Schott, C., R. Racz, and S. Huber. Smart CMOS sensors with integrated mag-
netic concentrators. IEEE Sensors , 2005. IEEE, 2005.
	 35. 	Metz, M., et al. Contactless angle measurement using four Hall devices on 
single chip. Solid State Sensors and Actuators, 1997. TRANSDUCERS’ 97 Chicago., 
1997 International Conference on . Vol. 1. IEEE, 1997.
	 36. 	Ausserlechner, U. A theory of magnetic angle sensors with Hall plates and 
without fluxguides. Progress in Electromagnetics Research B  49 (2013): 77– 106.
	 37. 	Blagojevic, M., N. Markovic, and R. S. Popovic. Testing the homogeneity of 
magnets for rotary position sensors. IEEE Transactions on Magnetics  50.11 (2014): 
1– 5.
	 38. 	Ausserlechner, U. The optimum layout for giant magneto-resistive angle sen-
sors. IEEE Sensors Journal  10.10 (2010): 1571– 1582.
	 39. 	Ausserlechner, U. Inaccuracies of giant magneto-resistive angle sensors due to 
assembly tolerances. IEEE Transactions on Magnetics  45.5 (2009): 2165– 2174.
	 40. 	Ausserlechner, U. Inaccuracies of anisotropic magneto-resistance angle sen-
sors due to assembly tolerances. Progress in Electromagnetics Research B  40 (2012): 
79– 99.
	 41. 	Arfken, G. Mathematical Methods for Physicists , 3rd ed. Academic, San Diego, 
CA, 1985. 198– 200.

249
Magnetic Angle Sensors
	 42. 	Schmollngruber, P., et al. GMR sensor element and its use. U.S. Patent No. 
7,312,609. 25 Dec. 2007.
	 43. 	Kaulberg, T. and G. Bogason. An angle detector based on magnetic sensing. 
Proceedings of IEEE International Symposium on Circuits and Systems-ISCAS’ 94 . 
Vol. 5. IEEE, 1994.
	 44. 	Kawahito, S., et al. A CMOS rotary encoder system based on magnetic pattern 
analysis with a resolution of 10b per rotation. ISSCC. 2005 IEEE International 
Digest of Technical Papers.  Solid-State Circuits Conference, 2005 . IEEE, 2005.
	 45. 	Ausserlechner, U. Axial and perpendicular angle sensor in single package. U.S. 
Patent Application No. 14/174,580.
	 46. 	Ausserlechner, U. On-axis magnetic field angle sensors, systems and methods. 
U.S. Patent No. 9,267,781. 23 Feb. 2016.
	 47. 	Jackson, J. D. Classical Electrodynamics , 2nd ed. Walter de Gruyter, Berlin, 1983. 
Equation (5.100).
	 48. 	Kaden, H. Wirbelströ me und Schirmung in der Nachrichtentechnik. 
Wirbelströ me und Schirmung in der Nachrichtentechnik , by H. Kaden. 2006 XVII, 
354 S. 195 Abb. 2., vollst. neu bearb. Aufl. 1959. Nachdruck 3-540-32569-7. 
Springer, Berlin, 2006. Chapters C.3. and F.2.
	 49. 	Peng, Q., S. M. McMurry, and J. M. David Coey. Cylindrical permanent-magnet 
structures using images in an iron shield. IEEE Transactions on Magnetics  39.4 
(2003): 1983– 1989.
	 50.	 Halbach, K. Design of permanent multipole magnets with oriented rare earth 
cobalt material. Nuclear Instruments and Methods  169.1 (1980): 1– 10.


251
Index
1/f noise, 44– 45
3-D coil MIS design, 123– 128
3-D microcoil technology, 108– 110
Active contactless suspension (AS), 105
Agilent 4284A LCR meter, 79, 80
Ampere’ s law, 106
Amplitude spectrum density (ASD), 43
Anisotropic magnetoresistance (AMR), 
203, 205, 209– 210, 214, 234
Application-specific integrated circuits 
(ASICs), 207
AS, see  Active contactless suspension 
(AS)
ASD, see  Amplitude spectrum density 
(ASD)
ASICs, see  Application-specific 
integrated circuits (ASICs)
Autonomous underwater vehicle (AUV)
algorithms for determining FM 
location relative to, 153– 155
FMs monitoring from on board, 
135– 140
magnetic conditions estimation, 
135– 137
magnetic field analysis and 
estimation of distance to area, 
137– 139
MS magnetometers, 139– 140
particularities, 135
optimization algorithm for changing 
angular orientation, 145– 151
AUV, see  Autonomous underwater 
vehicle (AUV)
Axial field-gradient angle sensor, 212, 
234, 238, 239
Bacterial cells, 12– 13
Bacterial detection methods, 3– 5
Bahreyni resonator, 68
Bi/CMOS technology, 209
BICS, see  Built-in current sensing (BICS)
Bioanalytes detection, 57
Bio-applications, of GMR sensors, 56– 58
bioanalytes detection, 57
biomedical signal detection, 58
magnetic fluids monitoring, 58
Biomedical signal detection, 58
Biosensor, 56
Biosensor application, for bovine 
mastitis diagnosis, 1– 30
overview, 2– 5
bacterial detection methods, 3– 5
technological advances, 5
portable “ lab-on-chip”  platform in 
raw milk, 5– 17
bacterial cells, 12– 13
biological functionalization of 
nanoparticles, 11– 12
calibration, 12
cytometer platform, magnetic 
detection with, 8– 10
data analysis, 16– 17
mastitic milk samples, 13
microfluidic channel fabrication, 10
PCR reference method analysis, 13
principles, magnetic detection, 
6– 8
readout electronics, 10– 11
sterile milk samples, 13
validation, magnetic detection, 
14– 16
results, 17
bacterial quantification 
evaluation, 17– 18
mAb Anti-S. agalactiae  and pAb 
Anti-GB Streptococci, 18– 22
mAb Anti-Staphylococcus  spp. and 
pAb Anti-Staphylococcus aureus , 
22– 24
sensitivity and specificity, 24– 30
strengths, weaknesses, 
opportunities, and threats, 27– 30
Bovine mastitis diagnosis, biosensor 
application for, 1– 30
overview, 2– 5
bacterial detection methods, 3– 5
technological advances, 5

252
Index
portable “ lab-on-chip”  platform in 
raw milk, 5– 17
bacterial cells, 12– 13
biological functionalization of 
nanoparticles, 11– 12
calibration, 12
cytometer platform, magnetic 
detection with, 8– 10
data analysis, 16– 17
mastitic milk samples, 13
microfluidic channel fabrication, 10
PCR reference method analysis, 13
principles, magnetic detection, 6– 8
readout electronics, 10– 11
sterile milk samples, 13
validation, magnetic detection, 
14– 16
results, 17
bacterial quantification 
evaluation, 17– 18
mAb Anti-S. agalactiae  and pAb 
Anti-GB Streptococci, 18– 22
mAb Anti-Staphylococcus  spp. and 
pAb Anti-Staphylococcus aureus , 
22– 24
sensitivity and specificity, 24– 30
strengths, weaknesses, 
opportunities, and threats, 27– 30
Brugger magnetic field microsensor, 
69– 70
Built-in current sensing (BICS), 54
California Mastitis Test (CMT), 3
Capacitive detection magnetometer, 65– 98
electric model analysis, 79– 81
frequency tuning method, 85– 97
experimental validation, 95– 97
numerical resolution, 89– 95
physical modeling, 86– 89
Lorentz force– based, 67– 74
in-plane, 67– 70
out-of-plane, 70– 74
mechanical model analysis, 76– 79
overview, 66
sensitivity evaluation, 81– 85
xylophone-based, 74– 76
Circular current loops, 179– 182
Circular magnet, 190– 195
Clebsch– Gordan coefficients 
formalism, 176
CMOS, see  Complementary metal-oxide 
semiconductor (CMOS)
CMT, see  California Mastitis Test (CMT)
Co– Cu, and Co– Ag granular films, 40
Complementary metal-oxide 
semiconductor (CMOS), 42, 207
Comsol®   Multiphysics, 82
Damping effect, 74
Data analysis, 16– 17
Diamagnetic, and inductive suspension, 
105, 106
Diamagnetism, 166
Diametrical field-gradient angle 
sensor, 239
Diametrical magnetization, 241– 242
Digital compasses, 49
Dipole magnetic induction, 153
DNA detection, 57
Earnshaw– Braunbeck theorem, 
105, 166
Earth’ s magnetic field (EMF), 136
Eddy current testing (ECT), 54– 56
Electric model analysis, 79– 81
Electromagnetic orientation and 
navigation system (EONS), 
156– 162
configuration, 157– 160
orientation and positioning 
parameters, 160– 162
Electrostatic stiffness component, 85
ELISA, see  Enzyme-linked 
immunosorbent assay (ELISA)
EMF, see  Earth’ s magnetic field (EMF)
Emmerich magnetometer, 67– 68
End-of-shaft sensor, 200– 201
Energy integrals, 174– 175
Enzyme-linked immunosorbent assay 
(ELISA), 24, 25
EONS, see  Electromagnetic orientation 
and navigation system (EONS)
Escherichia coli , 18, 22
Euler– Lagrange dynamic beam 
equation, 88
Fabrication, 3-D microcoils, 109– 110
FEM, see  Finite element method (FEM)
Ferromagnetic masses (FMs), 133– 162
algorithms for determining location 
relative to AUV, 153– 155
determining location of, 151– 153

253
Index
electromagnetic orientation and 
navigation system (EONS), 
156– 162
configuration, 157– 160
orientation and positioning 
parameters, 160– 162
mobile platforms transportation, 156
monitoring from on board AUV, 
135– 140
magnetic conditions estimation, 
135– 137
magnetic field analysis and 
estimation of distance to area, 
137– 139
MS magnetometers, 139– 140
particularities, 135
overview, 134– 135
vector magnetic sensors calibration, 
140– 151
first method, 142– 143
optimization algorithm for 
changing AUV angular 
orientation, 145– 151
second method, 144– 145
Fert, A., 36
Field-gradient angle sensors, 235– 239
Finite element method (FEM), 82
Flicker noise, see  1/f  noise
Flow cytometers, 5
FMs, see  Ferromagnetic masses (FMs)
Force characteristics, of magnetic 
suspension, 176– 177
Fredholm integral equations, 169
Frequency tuning method, 85– 97
experimental validation, 95– 97
numerical resolution, 89– 95
physical modeling, 86– 89
Giant magnetoresistance (GMR), and 
TMR sensors, 35– 58, 203, 
209– 210, 214
applications, 49– 58
bio-, 56– 58
general purpose 
magnetometers, 49
industrial, 49– 54
non-destructive evaluation, 54– 56
assembly tolerances, offset, gain 
mismatch, and misalignment 
in, 222– 234
autocalibration for continuously 
rotating shafts, 229– 234
devices, 40– 42
design, 41– 42
technological issues, 40– 41
limitations, 43– 48
bandwidth, 48
hysteresis, 46
range of application, 43– 46
temperature drifts, 46– 48
voltage offset, 46
overview, 36– 37
structures and phenomena, 37– 40
magnetic tunnel junctions, 
39– 40, 205
other GMR structures, 40
sandwich, 37
spin valves, 37– 39, 204
Green function, 169
Grunberg. P., 36
Halbach magnetization, 242– 243
Hall effect devices, 207– 209
Horizontal Hall (HHall) system, 234
Hysteresis, 46
IBD, see  Ion beam deposition (IBD)
ICs, see  Integrated circuits (ICs)
IMC, see  Integrated magnetic 
concentrators (IMC)
IMI, see  Intramammary infection (IMI)
Immunodiagnostics, 3
Inductive magnetization, 136
Industrial applications, of GMR sensors, 
49– 54
automotive, 49
electric current measurement, 51– 54
space, 49– 51
In-plane capacitive detection, 67– 70
In-shaft sensor, 200, 201
Integral equations, for secondary field, 
170– 171
Integrated circuits (ICs), 54
Integrated magnetic concentrators 
(IMC), 234
Intramammary infection (IMI), 3
Inverse dipole localization problem, 153
Ion beam deposition (IBD), 41
Johnson– Nyquist noise, see  Thermal 
noise
Kadar magnetometer, 70– 71

254
Index
Kyynä rä inen magnetometer, 72
Lagrange– Maxwell equations, 105, 178
Laplace’ s equation, 169, 171
Laser Doppler velocimetry (LDV), 76
Linear model, MIS, 117– 119
Longitudinal, and transverse stiffness, 
188, 190
Lorentz force– based capacitive 
magnetometers, 67– 74
in-plane detection, 67– 70
out-of-plane detection, 70– 74
mAb anti-S. agalactiae , 18– 22
mAb anti-Staphylococcus  spp., 22– 24
MAG-FETs, see  Magnetic field-effect 
transistors (MAG-FETs)
Magnetic angle sensors, 199– 244
assembly tolerances, offset, gain 
mismatch, and misalignment, 
214– 234
AMRs, VHalls, and HHalls with 
IMC, 234
in GMRs/TMRs, 222– 234
field-gradient angle sensors, 235– 239
magnets for, 239– 244
overview, 200– 201
technologies, 201– 214
comparison, 209– 214
Hall effect devices, 207– 209
magnetoresistors, 202– 206
Magnetic detection, 27
with cytometer platform, 8– 10
in NDE, 54
principles, 6– 8
validation, 14– 16
Magnetic field-effect transistors (MAG-
FETs), 209
Magnetic fluids, 58
Magnetic gradiometer, 153
Magnetic levitation, 165– 196
and applications, 166– 168
circular magnet, 190– 195
dynamics, 178– 179
energy integrals, 174– 175
force characteristics, 176– 177
force function of sphere in 
suspending field, 183– 184
integral equations for secondary 
field, 170– 171
one current loop, 180– 182
permanent magnets and magnetic 
charges, 182– 183
secondary field, 169– 170
solution for spherical shape, 171– 173
stiffness, 177– 178
superconductor in magnetic field, 
168– 169
system of circular current loops, 
179– 180
total field, 173– 174
two point magnets, 185– 190
Magnetic permeability, 136
Magnetic sensitivity, 203, 227
Magnetic sensors (MS), for ecological 
monitoring, 133– 162
algorithms for determining FM 
location relative to AUV, 153– 155
determining location of FM, 151– 153
electromagnetic orientation and 
navigation system (EONS), 
156– 162
configuration, 157– 160
orientation and positioning 
parameters, 160– 162
overview, 134– 135
stationary FMs from on board AUV, 
135– 140
magnetic conditions estimation, 
135– 137
magnetic field analysis and 
estimation of distance to area, 
137– 139
MS magnetometers, 139– 140
particularities, 135
transportation of mobile platforms to 
area of FM location, 156
vector magnetic sensors calibration, 
140– 151
first method, 142– 143
optimization algorithm for 
changing AUV angular 
orientation, 145– 151
second method, 144– 145
Magnetic stroke, see  Magnetic 
sensitivity
Magnetic suspension, see  Magnetic 
levitation
Magnetic tunnel junctions (MTJ), 39– 40, 
41, 205

255
Index
Magnetoresistors (MR), 5, 202– 206, 211
MALDI-TOF MS, see  Matrix-
assisted laser desorption 
ionization– time of flight 
mass spectrometry (MALDI-
TOF MS)
MATLAB©  , 10, 92
Matrix-assisted laser desorption 
ionization– time of flight mass 
spectrometry (MALDI-TOF 
MS), 25
Mechanical model analysis, 76– 79
Meissner effect, 168
MEMS, see  Microelectromechanical 
systems (MEMS)
Method of least squares (MLS), 145
Microelectromechanical systems 
(MEMS), 102– 104
Microfluidic channel fabrication, 10
Micromachined electromagnetic 
contactless suspensions, 
105– 106
Micromachined Inductive Suspension 
(MIS), 101– 128
MEMS, 102– 107
design, MIS, 106– 107
micromachined electromagnetic 
contactless suspensions, 
105– 106
modeling, 110– 128
analytical model, 112– 119
plane coils and 3-D coils design, 
119– 128
technology, 107– 110
3-D microcoil, 108– 110
planar coils, 107– 108
MLS, see  Method of least squares 
(MLS)
Mobile platforms (MPs), 133– 162
algorithms for determining FM 
location relative to AUV, 
153– 155
determining location of FM, 151– 153
electromagnetic orientation and 
navigation system (EONS), 
156– 162
configuration, 157– 160
orientation and positioning 
parameters, 160– 162
FMs monitoring from on board AUV, 
135– 140
magnetic conditions estimation, 
135– 137
magnetic field analysis and 
estimation of distance to area, 
137– 139
MS magnetometers, 139– 140
particularities, 135
overview, 134– 135
transportation to area of FM 
location, 156
vector magnetic sensors calibration, 
140– 151
first method, 142– 143
optimization algorithm for 
changing AUV angular 
orientation, 145– 151
second method, 144– 145
MR, see  Magnetoresistors (MR)
MS, see  Magnetic sensors (MS)
MS magnetometers, 139– 140
MTJ, see  Magnetic tunnel junctions (MTJ)
Multichannel PCB, 29
Nanoparticles (NP), 7, 27, 28
agglomeration, 26
biological functionalization, 11– 12
National Mastitis Council protocols 
(NMC), 13
N-Channel MOS (NMOS), 209
NDE, see  Non-destructive evaluation 
(NDE)
NMC, see  National Mastitis Council 
protocols (NMC)
NMOS, see  N-Channel MOS (NMOS)
Noise mechanisms, in GMR/TMR 
sensors
1/f, 44– 45
random telegraph, 45
shot, 45– 46
thermal, 43– 44
Non-destructive evaluation (NDE), 
54– 56
eddy current testing, 54– 56
magnetic detection, 54
Non-invasive detection system, 58
NP, see  Nanoparticles (NP)
One-plane coil MIS design, 121
Out-of-plane capacitive detection, 70– 74

256
Index
pAb anti-GB Streptococci, 12, 17, 18– 22
pAb anti-Staphylococcus aureus , 22– 24
Panton– Valentine leukocidin, 25
Passive contactless suspension (PS), 105
Passive levitation systems, 166
PathoProof Mastitis Complete-16®  , 13
PCB, see  Printed circuit board (PCB)
PCR, see  Polymerase chain reaction 
(PCR)
PDMS, see  Polydimethylsiloxane 
(PDMS)
Permanent magnetization, 136
Permanent magnets, and magnetic 
charges, 182– 183
Perpendicular field angle sensor, 212, 239
Pink noise, see  1/f  noise
Planar coils technology, 107– 108
Plane coil MIS design, 121– 122
PM, see  Proof mass (PM)
Polydimethylsiloxane (PDMS), 10
Polymerase chain reaction (PCR), 3, 
16– 17, 18– 20, 22, 24
reference method analysis, 13
Polytec MSA-500 laser Doppler 
vibrometer, 96
Popcorn noise, see  Random telegraph 
noise (RTN)
Portable “ lab-on-chip”  platform, in raw 
milk, 5– 17
bacterial cells, 12– 13
biological functionalization of 
nanoparticles, 11– 12
calibration, 12
cytometer platform, magnetic 
detection with, 8– 10
data analysis, 16– 17
mastitic milk samples, 13
microfluidic channel fabrication, 10
PCR reference method analysis, 13
principles, magnetic detection, 6– 8
readout electronics, 10– 11
sterile milk samples, 13
validation, magnetic detection, 14– 16
Power spectrum density (PSD), 43
Printed circuit board (PCB), 56
Proof mass (PM), 106– 107, 110, 112– 23, 
127
Prototheca , 22, 24
PS, see  Passive contactless suspension (PS)
PSD, see  Power spectrum density (PSD)
Random telegraph noise (RTN), 45
Rare earth elements (REE)-based 
permanent magnets, 182
Readout electronics, 10– 11
REE, see  Rare earth elements (REE)-
based permanent magnets
Ren magnetic field microsensor, 73
Resonant magnetometers, 66
RTN, see  Random telegraph noise 
(RTN)
Sandwich structures, in magnetic field 
sensing, 37
SC, see  Superconductors (SC)
SCC, see  Somatic cell count (SCC)
Shot noise, 45– 46
Signal processing unit (SPU), 157
Silicon Hall plates, 207
Silicon-on-insulator multiuser MEMS 
process (SOIMUMPs), 75, 85
Soft iron distortion, 140
SOIMUMPs, see  Silicon-on-insulator 
multiuser MEMS process 
(SOIMUMPs)
Somatic cell count (SCC), 3
Spinning current Hall probe, 208
Spin valves (SVs), 6– 7, 9, 37– 39, 41, 204
SPU, see  Signal processing unit (SPU)
Stable levitation, 105, 111, 119
Staphylococcus aureus , 2, 11, 17, 22, 24
Staphylococcus epidermidis , 17
Static behavior, of MIS, 115– 117
Streptococcus agalactiae , 2, 11, 12, 16– 17, 
18– 19
Streptococcus uberis , 2, 12, 18, 19
Strong-field angle sensors, 203, 204
Superconductor, in magnetic field, 
168– 169
Superconductors (SC), 166
SVs, see  Spin valves (SVs)
TFT, see  Thin-film transistor (TFT)
Thermal noise, 43– 44
Thermogravimetric method, 28
Thin-film transistor (TFT), 42
Thomson and Harsley’ s sensor, 68
TMR, see  Giant magnetoresistance 
(GMR)
TMR structures, see  Magnetic tunnel 
junctions (MTJ)

257
Index
Transient inductive magnetization, 137
Transient magnetic fields, 137
Tucker magnetic field microsensor, 72
Tunneling magnetoresistance 
(TMR) sensor, see  Giant 
magnetoresistance (GMR)
Two-plane coils MIS design, 121, 122
UCL, see  Université  Catholique de 
Louvain (UCL)
Uniaxial wheel transport platform 
(UWTP), 156, 157, 158
Université  Catholique de Louvain 
(UCL), 66
UWTP, see  Uniaxial wheel transport 
platform (UWTP)
Vector magnetic sensors (VMSs) 
calibration, 135, 140– 151
first method, 142– 143
optimization algorithm for changing 
AUV angular orientation, 
145– 151
second method, 144– 145
parameters estimation of 
background magnetic field 
model, 144– 145
Vertical Hall effect devices (VHalls), 
209, 234
VMSs, see  Vector magnetic sensors 
(VMSs) calibration
Voltage offset, 46
Weak-field sensors, 204
White noise, see  Thermal noise
Xylophone magnetometer, 66, 74– 75
Young’ s modulus, 85– 86

