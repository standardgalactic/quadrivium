THE CALCULUS INTEGRAL
(2009)
Brian S. Thomson
Simon Fraser University
CLASSICALREALANALYSIS.COM
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

This text is intended for a rigorous course introducing integration theory to calculus students, but starting at a level
preceding the more rigorous courses in real analysis. Any student with a suitably thorough course on derivatives should
be able to handle the ﬁrst few chapters of the integration theory without trouble. Since “all” exercises are worked through
in the appendix, the text is particularly well suited to self-study.
For further information on this title and others in the series visit our website.
www.classicalrealanalysis.com
There are PDF ﬁles of all of our texts freely available for download as well as instructions on how to order trade paperback
copies.
Cover Image: Sir Isaac Newton
And from my pillow, looking forth by light
Of moon or favouring stars, I could behold
The antechapel where the statue stood
Of Newton with his prism and silent face,
The marble index of a mind for ever
Voyaging through strange seas of Thought, alone.
...William Wordsworth, The Prelude.
Citation: The Calculus Integral, Brian S. Thomson, ClassicalRealAnalysis.com (2010), xiv xxx pp. [ISBN 1442180951]
Date PDF ﬁle compiled: July 19, 2009
BETA VERSION β0.2
The ﬁle or paperback that you are reading should be considered a work in progress. In a classroom setting
make sure all participants are using the same beta version. We will add and amend, depending on feedback
from our users, until the text appears to be in a stable condition.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

iii
ISBN: 1442180951
EAN-13: 9781442180956
CLASSICALREALANALYSIS.COM
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

PREFACE
There are plenty of calculus books available, many free or at least cheap, that discuss integrals. Why add another one?
Our purpose is to present integration theory at a calculus level and in an easier manner by deﬁning the deﬁnite
integral in a very traditional way, but a way that avoids the equally traditional Riemann sums deﬁnition.
Riemann sums enter the picture, to be sure, but the integral is deﬁned in the way that Newton himself would surely
endorse. Thus the fundamental theorem of the calculus starts off as the deﬁnition and the relation with Riemann sums
becomes a theorem (not the deﬁnition of the deﬁnite integral as has, most unfortunately, been the case for many years).
As usual in mathematical presentations we all end up in the same place. It is just that we have taken a different route
to get there. It is only a pedagogical issue of which route offers the clearest perspective. The common route of starting
with the deﬁnition of the Riemann integral, providing the then necessary detour into improper integrals, and ultimately
heading towards the Lebesgue integral is arguably not the best path although it has at least the merit of historical ﬁdelity.
Acknowledgments
I have used without comment material that has appeared in the textbook
[TBB] Elementary Real Analysis, 2nd Edition, B. S. Thomson, J. B. Bruckner, A. M. Bruckner, Classical-
RealAnalyis.com (2008).
I wish to express my thanks to my co-authors for permission to recycle that material into the idiosyncratic form that
appears here and their encouragement (or at least lack of discouragement) in this project.
I would also like to thank the following individuals who have offered feedback on the material, or who have supplied
interesting exercises or solutions to our exercises: [your name here], . . .
i
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

ii
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

Note to the instructor
Since it is possible that some brave mathematicians will undertake to present integration theory to undergraduates stu-
dents using the presentation in this text, it would be appropriate for us to address some comments to them.
What should I teach the weak calculus students?
Let me dispense with this question ﬁrst. Don’t teach them this material. I also wouldn’t teach them the Riemann integral.
I think a reasonable outline for these students would be this:
(1). An informal account of the indeﬁnite integral formula
Z
F′(x)dx = F(x)+C
just as an antiderivative notation with a justiﬁcation provided by the mean-value theorem.
(2). An account of what it means for a function to be continuous on an interval [a,b].
(3). The deﬁnition
Z b
a F′(x)dx = F(b)−F(a)
for continuous functions F : [a,b] →R that are differentiable at all but ﬁnitely many points in (a,b). The mean-value
theorem again justiﬁes the deﬁnition. You won’t need improper integrals, e.g., because of (3),
Z 1
0
1
√x dx =
Z 1
0
d
dx
¡
2√x
¢
dx = 2−0.
(4). Any properties of integrals that are direct translations of derivative properties.
iii
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

iv
(5). The Riemann sums identity
Z b
a f(x)dx =
n
∑
i=1
f(ξ∗
i )(xi −xi−1)
where the points ξ∗
i that make this precise are selected (yet again) by the mean-value theorem.
(6). The Riemann sums approximation
Z b
a f(x)dx ≈
n
∑
i=1
f(ξi)(xi −xi−1)
where the points ξi can be freely selected inside the interval. Continuity of f justiﬁes this since f(ξi) ≈f(ξ∗
i ).
That’s all! On the other hand, for students that are not considered marginal, the presentation in the text should lead
to a full theory of integration on the real line provided at ﬁrst that the student is sophisticated enough to handle ε, δ
arguments and simple compactness proofs (notably Bolzano-Weierstrass and Cousin lemma proofs).
Why the calculus integral?
Perhaps the correct question is “Why not the Lebesgue integral?” After all, integration theory on the real line is not
adequately described by either the calculus integral or the Riemann integral.
The answer that we all seem to have agreed upon is that Lebesgue’s theory is too difﬁcult for beginning students of
integration theory. Thus we need a “teaching integral,” one that will present all the usual rudiments of the theory in way
that prepares the student for the later introduction of measure and integration.
Using the Riemann integral as a teaching integral requires starting with summations and a difﬁcult and awkward
limit formulation. Eventually one reaches the fundamental theorem of the calculus. The fastest and most efﬁcient way
of teaching integration theory on the real line is, instead, at the outset to interpret the calculus integral
Z b
a F′(x)dx = F(b)−F(a)
as a deﬁnition. The primary tool is the very familiar mean-value theorem. That theorem leads quickly back to Riemann
sums in any case.
The instructor must then drop the habit of calling this the fundamental theorem of the calculus. Within a few lectures
the main properties of integrals are available and all of the computational exercises are accessible. This is because
everything is merely an immediate application of differentiation theorems. There is no need for an “improper” theory of
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

v
the integral since integration of unbounded functions requires no additional ideas or lectures.
There is a long and distinguished historical precedent for this kind of deﬁnition. For all of the 18th century the integral
was understood only in this sense1 The descriptive deﬁnition of the Lebesgue integral, which too can be taken as a starting
point, is exactly the same: but now requires F to be absolutely continuous and F′ is deﬁned only almost everywhere. The
Denjoy-Perron integral has the same descriptive deﬁnition but relaxes the condition on F to that of generalized absolute
continuity. Thus the narrative of integration theory on the real line can told simply as an interpretation of the integral as
meaning merely
Z b
a F′(x)dx = F(b)−F(a).
Why not the Riemann integral?
Or you may prefer to persist in teaching to your calculus students the Riemann integral and its ugly step-sister, the
improper Riemann integral. There are many reasons for ceasing to use this as a teaching integral; the web page, “Top
ten reasons for dumping the Riemann integral” which you can ﬁnd on our site
www.classicalrealanalysis.com
has a tongue-in-cheek account of some of these.
The Riemann integral does not do a particularly good job of introducing integration theory to students. That is not
to say that students should be sheltered from the notion of Riemann sums. It is just that a whole course conﬁned to the
Riemann integral wastes considerable time on a topic and on methods that are not worthy of such devotion.
In this presentation the Riemann sums approximations to integrals simply enters into the discussion naturally by way
of the mean-value theorem of the differential calculus. It does not require several lectures on approximations of areas
and other motivating stories.
1Certainly Newton and his followers saw it in this sense. For Leibnitz and his advocates the integral was a sum of inﬁnitesimals, but that only
explained the connection with the derivative. For a lucid account of the thinking of the mathematicians to whom we owe all this theory see Judith
V. Grabiner, Who gave you the epsilon? Cauchy and the origins of rigorous calculus, American Mathematical Monthly 90 (3), 1983, 185–194.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

vi
The calculus integral
For all of the 18th century and a good bit of the 19th century integration theory, as we understand it, was simply the
subject of antidifferentiation. Thus what we would call the fundamental theorem of the calculus would have been
considered a tautology: that is how an integral is deﬁned. Both the differential and integral calculus are, then, simply,
the study of derivatives with the integral calculus largely focussed on the inverse problem.
This is often expressed by modern analysts by claiming that the Newton integral of a function f : [a,b] →R is deﬁned
as
Z b
a f(x)dx = F(b)−F(a)
where F : [a,b] →R is any continuous function whose derivative F′(x) is identical with f(x) at all points a < x < b.
While Newton would have used no such notation or terminology, he would doubtless agree with us that this is precisely
the integral he intended.
The technical justiﬁcation for this deﬁnition of the Newton integral is little more than the mean-value theorem of the
calculus. Thus it is ideally suited for teaching integration theory to beginning students of the calculus. Indeed, it would
be a reasonable bet that most students of the calculus drift eventually into a hazy world of little-remembered lectures and
eventually think that this is exactly what an integral is anyway. Certainly it is the only method that they have used to
compute integrals.
For these reasons we have called it the calculus integral2. But none of us teach the calculus integral. Instead we
teach the Riemann integral. Then, when the necessity of integrating unbounded functions arise, we teach the improper
Riemann integral. When the student is more advanced we sheepishly let them know that the integration theory that they
have learned is just a moldy 19th century concept that was replaced in all serious studies a full century ago. We do
not apologize for the fact that we have misled them; indeed we likely will not even mention the fact that the improper
Riemann integral and the Lebesgue integral are quite distinct; most students accept the mantra that the Lebesgue integral
is better and they take it for granted that it includes what they learned. We also do not point out just how awkward and
misleading the Riemann theory is: we just drop the subject entirely.
Why is the Riemann integral the “teaching integral” of choice when the calculus integral offers a better and easier
approach to integration theory? The transition from the Riemann integral to the Lebesgue integral requires abandoning
Riemann sums in favor of measure theory. The transition from the improper Riemann integral to the Lebesgue integral
2The play on the usual term “integral calculus” is intentional.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

vii
is usually ﬂubbed.
The transition from the calculus integral to the Lebesgue integral (and beyond) can be made quite logically. In-
troduce, ﬁrst, sets of measure zero and some simple related concepts. Then an integral which completely includes the
calculus integral and yet is as general as one requires can be obtained by repeating Newton’s deﬁnition above: the
integral of a function f : [a,b] →R is deﬁned as
Z b
a f(x)dx = F(b)−F(a)
where F : [a,b] →R is any continuous function whose derivative F′(x) is identical with f(x) at all points a < x < b with
the exception of a set of points N that is of measure zero and on which F has zero variation.
We are employing here the usual conjuror’s trick that mathematicians often use. We take some late characterization
of a concept and reverse the presentation by taking that as a deﬁnition. One will see all the familiar theory gets presented
along the way but that, because the order is turned on its head, quite a different perspective emerges.
Give it a try and see if it works for your students. By the end of the Part One the student will have learned the calculus
integral, seen all of the familiar integration theorems of the integral calculus, worked with Riemann sums, functions of
bounded variation, studied countable sets and sets of measure zero, and given a working deﬁnition of the Lebesgue
integral.
Part Two returns to the general calculus integral and gives the full Henstock-Kurzweil characterization. Chapter 6
presents the theory of the Lebesgue measure and integral on the line and all of the usual material of a ﬁrst graduate
course, but again in an untraditional manner. By this point the student is ready for a typical graduate course in abstract
measure theory. If you choose to present only Part One (the elementary calculus integral) your students should still be
as adequately prepared for their studies as the usual route through the Riemann integral would have done. Maybe better
prepared.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

viii
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

Contents
Preface
i
Note to the instructor
iii
Table of Contents
viii
I
Elementary Theory of the Integral
xxvii
1
What you should know ﬁrst
1
1.1
What is the calculus about? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2
1.2
What is an interval? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2
1.3
Sequences and series . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5
1.3.1
Sequences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5
1.3.2
Series . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
8
1.4
Partitions
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
1.4.1
Cousin’s partitioning argument . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
10
1.5
What is a function? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
11
1.6
Continuous functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
12
1.6.1
Uniformly continuous and continuous functions . . . . . . . . . . . . . . . . . . . . . . . . . .
13
ix
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

x
CONTENTS
1.6.2
Oscillation of a function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
17
1.6.3
Endpoint limits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
18
1.6.4
Boundedness properties
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
22
1.7
Existence of maximum and minimum
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
24
1.7.1
The Darboux property of continuous functions
. . . . . . . . . . . . . . . . . . . . . . . . . .
25
1.8
Derivatives
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
27
1.9
Differentiation rules . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
30
1.10 Mean-value theorem
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
30
1.10.1 Rolle’s theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
31
1.10.2 Mean-Value theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
32
1.10.3 The Darboux property of the derivative
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
37
1.10.4 Vanishing derivatives and constant functions
. . . . . . . . . . . . . . . . . . . . . . . . . . .
38
1.10.5 Vanishing derivatives with exceptional sets
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
38
1.11 Lipschitz functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
40
2
The Indeﬁnite Integral
43
2.1
An indeﬁnite integral on an interval
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
44
2.1.1
Role of the ﬁnite exceptional set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
45
2.1.2
Features of the indeﬁnite integral
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
46
2.1.3
The notation
R f(x)dx . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
46
2.2
Existence of indeﬁnite integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
48
2.2.1
Upper functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
49
2.2.2
The main existence theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
50
2.3
Basic properties of indeﬁnite integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
51
2.3.1
Linear combinations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
52
2.3.2
Integration by parts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
52
2.3.3
Change of variable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
53
2.3.4
What is the derivative of the indeﬁnite integral? . . . . . . . . . . . . . . . . . . . . . . . . . .
54
2.3.5
Partial fractions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
55
2.3.6
Tables of integrals
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
58
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

CONTENTS
xi
3
The Deﬁnite Integral
59
3.1
Deﬁnition of the calculus integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
60
3.1.1
Alternative deﬁnition of the integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
61
3.1.2
Inﬁnite integrals
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
62
3.1.3
Simple properties of integrals
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
63
3.1.4
Integrability of bounded functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
66
3.1.5
Integrability for the unbounded case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
67
3.1.6
Products of integrable functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
69
3.1.7
Notation:
R a
a f(x)dx and
R a
b f(x)dx
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
70
3.1.8
The dummy variable: what is the “x” in
R b
a f(x)dx? . . . . . . . . . . . . . . . . . . . . . . . .
70
3.1.9
Deﬁnite vs. indeﬁnite integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
71
3.1.10 The calculus student’s notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
72
3.2
Mean-value theorems for integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
73
3.3
Riemann sums . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
75
3.3.1
Exact computation by Riemann sums
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
76
3.3.2
Uniform Approximation by Riemann sums . . . . . . . . . . . . . . . . . . . . . . . . . . . .
79
3.3.3
Theorem of G. A. Bliss . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
81
3.3.4
Pointwise approximation by Riemann sums . . . . . . . . . . . . . . . . . . . . . . . . . . . .
83
3.4
Properties of the integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
85
3.4.1
Inequalities . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
85
3.4.2
Linear combinations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
86
3.4.3
Subintervals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
86
3.4.4
Integration by parts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
87
3.4.5
Change of variable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
87
3.4.6
What is the derivative of the deﬁnite integral? . . . . . . . . . . . . . . . . . . . . . . . . . . .
89
3.5
Absolute integrability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
90
3.5.1
Functions of bounded variation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
91
3.5.2
Indeﬁnite integrals and bounded variation . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
95
3.6
Sequences and series of integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
95
3.6.1
The counterexamples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
96
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

xii
CONTENTS
3.6.2
Uniform convergence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
102
3.6.3
Uniform convergence and integrals
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
108
3.6.4
A defect of the calculus integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
110
3.6.5
Uniform limits of continuous derivatives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
111
3.6.6
Uniform limits of discontinuous derivatives . . . . . . . . . . . . . . . . . . . . . . . . . . . .
113
3.7
The monotone convergence theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
114
3.7.1
Summing inside the integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
114
3.7.2
Monotone convergence theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
116
3.8
Integration of power series . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
117
3.9
Applications of the integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
126
3.9.1
Area and the method of exhaustion
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
128
3.9.2
Volume . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
131
3.9.3
Length of a curve . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
134
3.10 Numerical methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
136
3.10.1 Maple methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
142
3.10.2 Maple and inﬁnite integrals
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
144
3.11 More Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
145
4
Beyond the calculus integral
147
4.1
Countable sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
148
4.1.1
Cantor’s theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
149
4.2
Derivatives which vanish outside of countable sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
150
4.2.1
Calculus integral [countable set version] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
150
4.3
Sets of measure zero
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
152
4.3.1
The Cantor dust . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
154
4.4
The Devil’s staircase
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
158
4.4.1
Construction of Cantor’s function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
158
4.5
Functions with zero variation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
161
4.5.1
Zero variation lemma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
163
4.5.2
Zero derivatives imply zero variation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
164
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

CONTENTS
xiii
4.5.3
Continuity and zero variation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
164
4.5.4
Absolute continuity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
165
4.5.5
Absolute continuity in Vitali’s sense . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
167
4.6
The integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
168
4.6.1
Inﬁnite integrals
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
171
4.7
Lipschitz functions and bounded integrable functions . . . . . . . . . . . . . . . . . . . . . . . . . . .
172
4.8
Approximation by Riemann sums
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
173
4.9
Properties of the integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
174
4.9.1
Inequalities . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
174
4.9.2
Linear combinations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
175
4.9.3
Subintervals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
175
4.9.4
Integration by parts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
176
4.9.5
Change of variable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
176
4.9.6
What is the derivative of the deﬁnite integral? . . . . . . . . . . . . . . . . . . . . . . . . . . .
177
4.9.7
Monotone convergence theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
177
4.9.8
Summation of series theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
178
4.9.9
Null functions
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
179
4.10 The Henstock-Kurweil integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
180
4.11 The Lebesgue integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
181
4.12 The Riemann integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
183
II
Theory of the Integral on the Real Line
185
5
Covering Theorems
187
5.1
Covering Relations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
188
5.1.1
Partitions and subpartitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
188
5.1.2
Covering relations
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
189
5.1.3
Prunings
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
189
5.1.4
Full covers
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
190
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

xiv
CONTENTS
5.1.5
Fine covers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
190
5.1.6
Uniformly full covers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
190
5.1.7
Cousin covering lemma
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
194
5.1.8
Decomposition of full covers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
195
5.1.9
Riemann sums
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
196
5.2
Sets of measure zero
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
200
5.2.1
Lebesgue measure of open sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
200
5.2.2
Sets of Lebesgue measure zero . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
202
5.2.3
Sequences of measure zero sets
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
202
5.2.4
Almost everywhere language . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
206
5.3
Full null sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
207
5.4
Fine null sets
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
209
5.5
The Mini-Vitali Covering Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
210
5.5.1
Covering lemmas for families of compact intervals . . . . . . . . . . . . . . . . . . . . . . . .
211
5.5.2
Proof of the Mini-Vitali covering theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
212
5.6
Functions having zero variation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
215
5.6.1
Zero variation and zero derivatives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
217
5.6.2
Generalization of the zero derivative/variation . . . . . . . . . . . . . . . . . . . . . . . . . . .
218
5.6.3
Absolutely continuous functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
220
5.6.4
Absolute continuity and derivatives
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
221
5.7
Lebesgue differentiation theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
223
5.7.1
Upper and lower derivates . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
224
5.7.2
Geometrical lemmas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
225
5.7.3
Proof of the Lebesgue differentiation theorem . . . . . . . . . . . . . . . . . . . . . . . . . . .
226
6
The Integral
231
6.1
The integral and integrable functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
232
6.1.1
Inﬁnite integrals
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
233
6.1.2
Approximation by Riemann sums . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
234
6.2
The Henstock-Kurzweil characterization of the integral . . . . . . . . . . . . . . . . . . . . . . . . . .
237
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

CONTENTS
xv
6.2.1
Deﬁnition of Henstock and Kurzweil
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
237
6.2.2
Upper and lower integrals
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
238
6.2.3
The integral and integrable functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
240
6.2.4
First Cauchy criterion
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
242
6.2.5
Second Cauchy criterion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
243
6.2.6
Proof of equivalence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
245
6.3
Elementary properties of the integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
250
6.3.1
Integration and order . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
250
6.3.2
Integration of linear combinations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
251
6.3.3
Integrability on subintervals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
251
6.3.4
Additivity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
251
6.3.5
Change of variable . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
251
6.3.6
Integration by parts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
252
6.3.7
Derivative of the integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
253
6.3.8
Null functions
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
254
6.3.9
Monotone convergence theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
255
6.3.10 Summing inside the integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
256
6.3.11 Two convergence lemmas
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
257
6.4
Equi-integrability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
262
7
Lebesgue’s Integral
263
7.1
The Lebesgue integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
264
7.2
Lebesgue measure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
264
7.2.1
Basic property of Lebesgue measure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
265
7.3
Vitali covering theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
266
7.3.1
Classical version of Vitali’s theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
267
7.3.2
Proof that λ = λ∗= λ∗. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
269
7.4
Density theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
270
7.5
Additivity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
272
7.6
Measurable sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
275
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

xvi
CONTENTS
7.6.1
Deﬁnition of measurable sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
275
7.6.2
Properties of measurable sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
275
7.6.3
Increasing sequences of sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
277
7.6.4
Existence of nonmeasurable sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
278
7.7
Measurable functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
280
7.7.1
Continuous functions are measurable
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
280
7.7.2
Derivatives and integrable functions are measurable . . . . . . . . . . . . . . . . . . . . . . . .
281
7.7.3
Simple functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
282
7.7.4
Series of simple functions
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
283
7.7.5
Limits of measurable functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
284
7.8
Construction of the integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
285
7.8.1
Characteristic functions of measurable sets
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
285
7.8.2
Characterizations of measurable sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
286
7.8.3
Integral of simple functions
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
288
7.8.4
Integral of nonnegative measurable functions . . . . . . . . . . . . . . . . . . . . . . . . . . .
288
7.8.5
Fatou’s Lemma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
289
7.8.6
Derivatives of functions of bounded variation . . . . . . . . . . . . . . . . . . . . . . . . . . .
292
7.8.7
Characterization of the Lebesgue integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
293
7.8.8
McShane’s Criterion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
294
7.8.9
Nonabsolutely integrable functions
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
298
7.9
The Lebesgue integral as a set function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
299
7.10 Characterizations of the indeﬁnite integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
303
7.10.1 Integral of nonnegative, integrable functions . . . . . . . . . . . . . . . . . . . . . . . . . . . .
305
7.10.2 Integral of absolutely integrable functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
305
7.10.3 Integral of nonabsolutely integrable functions . . . . . . . . . . . . . . . . . . . . . . . . . . .
306
7.10.4 Proofs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
306
7.11 Denjoy’s program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
309
7.12 The Riemann integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
310
8
Stieltjes Integrals
313
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

CONTENTS
xvii
8.1
Stieltjes integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
313
8.1.1
Deﬁnition of the Stieltjes integral
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
315
8.1.2
Henstock’s zero variation criterion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
318
8.2
Regulated functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
319
8.3
Variation expressed as an integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
322
8.4
Representation theorems for functions of bounded variation . . . . . . . . . . . . . . . . . . . . . . . .
324
8.4.1
Jordan decomposition
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
324
8.4.2
Jordan decomposition theorem: differentiation
. . . . . . . . . . . . . . . . . . . . . . . . . .
325
8.4.3
Representation by saltus functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
327
8.4.4
Representation by singular functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
327
8.5
Reducing a Stieltjes integral to an ordinary integral . . . . . . . . . . . . . . . . . . . . . . . . . . . .
327
8.6
Properties of the indeﬁnite integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
330
8.6.1
Existence of the integral from derivative statements . . . . . . . . . . . . . . . . . . . . . . . .
334
8.7
Existence of the Stieltjes integral for continuous functions
. . . . . . . . . . . . . . . . . . . . . . . .
335
8.8
Integration by parts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
336
8.9
Lebesgue-Stieltjes measure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
338
8.10 Mutually singular functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
341
8.11 Singular functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
343
8.12 Length of curves
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
344
8.12.1 Formula for the length of curves . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
345
9
Nonabsolutely Integrable Functions
349
9.1
Variational Measures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
350
9.1.1
Full and ﬁne variational measures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
351
9.1.2
Finite variation and σ-ﬁnite variation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
352
9.1.3
The Vitali property . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
353
9.1.4
Kolmogorov equivalence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
353
9.1.5
Variation of continuous, increasing functions . . . . . . . . . . . . . . . . . . . . . . . . . . .
354
9.1.6
Variation and image measure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
355
9.1.7
Variational classiﬁcations of real functions
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
356
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

xviii
CONTENTS
9.2
Derivates and variation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
359
9.2.1
Ordinary derivates and variation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
359
9.2.2
Dini derivatives and variation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
360
9.2.3
Lipschitz numbers
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
362
9.2.4
Six growth lemmas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
364
9.3
Continuous functions with σ-ﬁnite variation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
369
9.3.1
Variation on compact sets
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
370
9.3.2
λ-absolutely continuous functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
372
9.4
Vitali property and differentiability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
372
9.5
The Vitali property and variation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
374
9.5.1
Monotonic functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
374
9.5.2
Functions of bounded variation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
375
9.5.3
Functions of σ-ﬁnite variation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
375
9.6
Characterization of the Vitali property . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
376
9.7
Characterization of λ-absolute continuity
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
377
9.8
Mapping properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
378
9.9
Lusin’s conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
380
9.10 Banach-Zarecki Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
380
9.11 Local Lebesgue integrability conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
382
9.12 Continuity of upper and lower integrals
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
386
9.13 A characterization of the integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
387
9.14 Integral of Dini derivatives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
391
9.14.1 Motivation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
391
9.14.2 Quasi-Cousin covering lemma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
393
9.14.3 Estimates of integrals from derivates . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
394
9.14.4 Estimates of integrals from Dini derivatives . . . . . . . . . . . . . . . . . . . . . . . . . . . .
395
10 Integration in Rn
399
10.1 Some background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
399
10.1.1 Intervals and covering relations
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
400
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

CONTENTS
xix
10.2 Measure and integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
402
10.2.1 Lebesgue measure in Rn . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
403
10.2.2 The fundamental lemma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
403
10.3 Measurable sets and measurable functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
406
10.3.1 Measurable functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
407
10.3.2 Notation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
409
10.4 General measure theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
410
10.5 Iterated integrals
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
411
10.5.1 Formulation of the iterated integral property . . . . . . . . . . . . . . . . . . . . . . . . . . . .
413
10.5.2 Fubini’s theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
416
10.6 Expression as a Stieltjes integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
417
11 Appendix
419
11.1 Glossary of terms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
419
11.1.1 absolute continuity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
419
11.1.2 absolute convergence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
420
11.1.3 absolute convergence test . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
421
11.1.4 absolute integration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
421
11.1.5 almost everywhere . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
421
11.1.6 Baire category theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
422
11.1.7 Bolzano-Weierstrass argument . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
424
11.1.8 bounded set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
424
11.1.9 bounded function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
425
11.1.10 bounded sequence
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
425
11.1.11 bounded variation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
425
11.1.12 bounded monotone sequence argument
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
425
11.1.13 Cantor dust . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
426
11.1.14 Cauchy sequences
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
426
11.1.15 characteristic function of a set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
427
11.1.16 closed set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
427
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

xx
CONTENTS
11.1.17 compactness argument . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
427
11.1.18 connected set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
428
11.1.19 convergence of a sequence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
428
11.1.20 component of an open set
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
428
11.1.21 composition of functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
429
11.1.22 constant of integration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
429
11.1.23 continuous function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
429
11.1.24 contraposition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
430
11.1.25 converse . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
430
11.1.26 countable set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
431
11.1.27 Cousin’s partitioning argument . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
431
11.1.28 Cousin’s covering argument . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
432
11.1.29 Darboux property . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
433
11.1.30 deﬁnite integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
433
11.1.31 De Morgan’s Laws . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
433
11.1.32 dense . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
434
11.1.33 derivative . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
434
11.1.34 Devil’s staircase
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
434
11.1.35 domain of a function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
435
11.1.36 empty set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
435
11.1.37 equivalence relation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
435
11.1.38 graph of a function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
435
11.1.39 partition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
436
11.1.40 Henstock-Kurzweil integral
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
436
11.1.41 indeﬁnite integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
437
11.1.42 indirect proof . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
437
11.1.43 infs and sups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
438
11.1.44 integers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
438
11.1.45 integral test for series . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
438
11.1.46 intermediate value property
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
439
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

CONTENTS
xxi
11.1.47 interval . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
439
11.1.48 least upper bound argument
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
439
11.1.49 induction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
440
11.1.50 inverse of a function
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
440
11.1.51 isolated point . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
441
11.1.52 Jordan decomposition
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
441
11.1.53 Lebesgue integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
441
11.1.54 limit of a function
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
442
11.1.55 linear combination . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
444
11.1.56 Lipschitz function
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
444
11.1.57 locally bounded function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
444
11.1.58 lower bound of a set
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
444
11.1.59 managing epsilons . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
445
11.1.60 meager
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
445
11.1.61 mean-value theorem
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
446
11.1.62 measure zero . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
446
11.1.63 monotone subsequence argument
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
447
11.1.64 mostly everywhere . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
447
11.1.65 natural numbers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
448
11.1.66 nearly everywhere
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
448
11.1.67 negations of quantiﬁed statements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
448
11.1.68 nested interval argument . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
449
11.1.69 nowhere dense
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
449
11.1.70 open set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
450
11.1.71 one-to-one and onto function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
450
11.1.72 ordered pairs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
450
11.1.73 oscillation of a function
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
451
11.1.74 partition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
451
11.1.75 perfect set . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
452
11.1.76 pointwise continuous function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
452
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

xxii
CONTENTS
11.1.77 preimage of a function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
453
11.1.78 quantiﬁers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
453
11.1.79 range of a function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
454
11.1.80 rational numbers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
454
11.1.81 real numbers
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
454
11.1.82 relations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
455
11.1.83 residual . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
455
11.1.84 Riemann sum . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
455
11.1.85 Riemann integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
456
11.1.86 series . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
457
11.1.87 set-builder notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
458
11.1.88 set notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
458
11.1.89 subpartition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
459
11.1.90 summation by parts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
459
11.1.91 sups and infs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
459
11.1.92 subsets, unions, intersection, and differences
. . . . . . . . . . . . . . . . . . . . . . . . . . .
460
11.1.93 total variation function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
460
11.1.94 uniformly continuous function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
460
11.1.95 upper bound of a set
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
461
11.1.96 variation of a function
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
461
11.2 Answers to exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
463
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

Part I
Elementary Theory of the Integral
xxiii
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

Chapter 1
What you should know ﬁrst
This chapter begins a review of the differential calculus. We go, perhaps, deeper than the reader has gone before because
we need to justify and prove everything we shall do. If your calculus courses so far have left the proofs of certain
theorems (most notably the existence of maxima and minima of continuous functions) to a “more advanced course” then
this will be, indeed, deeper. If your courses proved such theorems then there is nothing here in Chapters 1–3 that is
essentially harder.
The text is about the integral calculus. The entire theory of integration can be presented as an attempt to solve the
equation
dy
dx = f(x)
for a suitable function y = F(x). Certainly we cannot approach such a problem until we have some considerable expertise
in the study of derivatives. So that is where we begin. Well-informed, or smug students, may skip over this chapter and
begin immediately with the integration theory. The indeﬁnite integral starts in Chapter 2. The deﬁnite integral continues
in Chapter 3. The material in Chapter 4 takes the integration theory, which up to this point has been at an elementary
level, to the next stage.
We assume the reader knows the rudiments of the calculus and can answer the majority of the exercises here without
much trouble. Later chapters will introduce topics in a very careful order. Here we assume in advance that you know
basic facts about functions, limits, continuity, derivatives, sequences and series and need only a careful review.
1
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

2
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
1.1
What is the calculus about?
The calculus is the study of the derivative and the integral. In fact, the integral is so closely related to the derivative that
the study of the integral is an essential part of studying derivatives. Thus there is really one topic only: the derivative.
Most university courses are divided, however, into the separate topics of Differential Calculus and Integral Calculus, to
use the old-fashioned names.
Your main objective in studying the calculus is to understand (thoroughly) what the concepts of derivative and
integral are and to comprehend the many relations among the concepts.
It may seem to a typical calculus student that the subject is mostly all about computations and algebraic manipula-
tions. While that may appear to be the main feature of the courses it is, by no means, the main objective.
If you can remember yourself as a child learning arithmetic perhaps you can put this in the right perspective. A child’s
point of view on the study of arithmetic centers on remembering the numbers, memorizing addition and multiplication
tables, and performing feats of mental arithmetic. The goal is actually, though, what some people have called numeracy:
familiarity and proﬁciency in the world of numbers. We all know that the computations themselves can be trivially
performed on a calculator and that the mental arithmetic skills of the early grades are not an end in themselves.
You should think the same way about your calculus problems. In the end you need to understand what all these
ideas mean and what the structure of the subject is. Ultimately you are seeking mathematical literacy, the ability to think
in terms of the concepts of the calculus. In your later life you will most certainly not be called upon to differentiate a
polynomial or integrate a trigonometric expression (unless you end up as a drudge teaching calculus to others). But, if
we are successful in our teaching of the subject, you will able to understand and use many of the concepts of economics,
ﬁnance, biology, physics, statistics, etc. that are expressible in the language of derivatives and integrals.
1.2
What is an interval?
We should really begin with a discussion of the real numbers themselves, but that would add a level of complexity to the
text that is not completely necessary. If you need a full treatment of the real numbers see our text [TBB]1. Make sure
especially to understand the use of suprema and inﬁma in working with real numbers. We can begin by deﬁning what
1Thomson, Bruckner, Bruckner, Elementary Real Analysis, 2nd Edition (2008). The relevant chapters are available for free download at
classicalrealanalysis.com .
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.2. WHAT IS AN INTERVAL?
3
we mean by those sets of real numbers called intervals.
All of the functions of the elementary calculus are deﬁned on intervals or on sets that are unions of intervals. This
language, while simple, should be clear.
An interval is the collection of all the points on the real line that lie between two given points [the endpoints], or the
collection of all points that lie on the right or left side of some point. The endpoints are included for closed intervals and
not included for open intervals.
Here is the notation and language: Take any real numbers a and b with a < b. Then the following symbols describe
intervals on the real line:
• (open bounded interval) (a,b) is the set of all real numbers between (but not including) the points a and b, i.e.,
all x ∈R for which a < x < b.
• (closed, bounded interval) [a,b] is the set of all real numbers between (and including) the points a and b, i.e., all
x ∈R for which a ≤x ≤b.
• (half-open bounded interval) [a,b) is the set of all real numbers between (but not including b) the points a and
b, i.e., all x ∈R for which a ≤x < b.
• (half-open bounded interval) (a,b] is the set of all real numbers between (but not including a) the points a and
b, i.e., all x ∈R for which a < x ≤b.
• (open unbounded interval) (a,∞) is the set of all real numbers greater than (but not including) the point a, i.e.,
all x ∈R for which a < x.
• (open unbounded interval) (−∞,b) is the set of all real numbers lesser than (but not including) the point b, i.e.,
all x ∈R for which x < b.
• (closed unbounded interval) [a,∞) is the set of all real numbers greater than (and including) the point a, i.e., all
x ∈R for which a ≤x.
• (closed unbounded interval) (−∞,b] is the set of all real numbers lesser than (and including) the point b, i.e., all
x ∈R for which x ≤b.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
• (the entire real line) (−∞,∞) is the set of all real numbers. This can be reasonably written as all x for which
−∞< x < ∞.
Exercise 1 Do the symbols −∞and ∞stand for real numbers? What are they then?
Answer
Exercise 2 (bounded sets) Which intervals are bounded? [To ﬁnd out what a bounded set is see page 424.]
Answer
Exercise 3 (open sets) Show that an open interval (a,b) or (a,∞) or (−∞,b) is an open set. [To ﬁnd out what an open
set is see page 450.]
Answer
Exercise 4 (closed sets) Show that an closed interval [a,b] or [a,∞) or (−∞,b] is an closed set. [To ﬁnd out what a
closed set is see page 427. ]
Answer
Exercise 5 Show that the intervals [a,b) and (a,b] are neither closed nor open.
Answer
Exercise 6 (intersection of two open intervals) Is the intersection of two open intervals an open interval?
Answer
Exercise 7 (intersection of two closed intervals) Is the intersection of two closed intervals a closed interval?
Answer
Exercise 8 Is the intersection of two unbounded intervals an unbounded interval?
Answer
Exercise 9 When is the union of two open intervals an open interval?
Answer
Exercise 10 When is the union of two closed intervals an open interval?
Answer
Exercise 11 Is the union of two bounded intervals a bounded set?
Answer
Exercise 12 If I is an open interval and C is a ﬁnite set what kind of set might be I \E?
Answer
Exercise 13 If I is a closed interval and C is a ﬁnite set what kind of set might be I \C?
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.3. SEQUENCES AND SERIES
5
1.3
Sequences and series
We will need the method of sequences and series in our studies of the integral. In this section we present a brief review.
By a sequence we mean an inﬁnite list of real numbers
s1,s2,s3,s4,...
and by a series we mean that we intend to sum the terms in some sequence
a1 +a2 +a3 +a4 +....
The notation for such a sequence would be {sn} and for such a series ∑∞
k=1 ak.
1.3.1
Sequences
A sequence converges to a number L if the terms of the sequence eventually get close to (and remain close to) the number
L. A sequence is Cauchy if the terms of the sequence eventually get close together (and remain close together). The
notions are very intimately related.
Deﬁnition 1.1 (convergent sequence) A sequence of real numbers {sn} is said to
converge to a real number L if, for every ε > 0 there is an integer N so that
L−ε < sn < L+ε
for all integers n ≥N. In that case we write
lim
n→∞sn = L.
If a sequence fails to converge it is said to diverge.
Deﬁnition 1.2 (Cauchy sequence) A sequence of real numbers {sn} is said to be
a Cauchy sequence if, for every ε > 0 there is an integer N so that
|sn −sm| < ε
for all pairs of integers n, m ≥N.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

6
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
Deﬁnition 1.3 (divergent to ∞) A sequence of real numbers {sn} is said to diverge
to ∞if, for every real number M there is an integer N so that sn > M for all integers
n ≥N. In that case we write
lim
n→∞sn = ∞.
[We do not say the sequence “converges to ∞.”]
In the exercises you will show that every convergent sequence is a Cauchy sequence and, conversely, that every
Cauchy sequence is a convergent sequence. We will also need to review the behavior of monotone sequences and of
subsequences. All of the exercises should be looked at as the techniques discussed here are used freely throughout the
rest of the material of the text.
Exercise 14 A sequence {sn} is said to be bounded if there is a number M so that |sn| ≤M for all n. Show that every
convergent sequence is bounded. Give an example of a bounded sequence that is not convergent.
Answer
Exercise 15 Show that every Cauchy sequence is bounded. Give an example of a bounded sequence that is not Cauchy.
Answer
Exercise 16 Show that every convergent sequence is Cauchy. [The converse is proved below after we have looked for
convergent subsequences.]
Answer
Exercise 17 (theory of sequence limits) Suppose that {sn} and {tn} are convergent sequences.
1. What can you say about the sequence xn = asn +btn for real numbers a and b?
2. What can you say about the sequence yn = sntn?
3. What can you say about the sequence yn = sn
tn ?
4. What can you say if sn ≤tn for all n?
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.3. SEQUENCES AND SERIES
7
Exercise 18 A sequence {sn} is said to be nondecreasing [or monotone nondecreasing] if
s1 ≤s2 ≤s3 ≤s4 ≤....
Show that such a sequence is convergent if and only if it is bounded, and in fact that
lim
n→∞sn = sup{sn : n = 1,2,3,...}.
Answer
Exercise 19 (nested interval argument) A sequence {[an,bn]} of closed, bounded intervals is said to be a nested se-
quence of intervals shrinking to a point if
[a1,b1] ⊃[a2,b2] ⊃[a3,b3] ⊃[a4,b4] ⊃...
and
lim
n→∞(bn −an) = 0.
Show that there is a unique point in all of the intervals.
Answer
Exercise 20 Given a sequence {sn} and a sequence of integers
1 ≤n1 < n2 < n3 < n4 < ...
construct the new sequence
{snk} = sn1,sn2,sn3,sn4,sn5,....
The new sequence is said to be a subsequence of the original sequence. Show that every sequence {sn} has a subsequence
that is monotone, i.e., either monotone nondecreasing
sn1 ≤sn2 ≤sn3 ≤sn4 ≤...
or else monotone nonincreasing
sn1 ≥sn2 ≥sn3 ≥sn4 ≥....
Answer
Exercise 21 (Bolzano-Weierstrass property) Show that every bounded sequence has a convergent subsequence.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
Exercise 22 Show that every Cauchy sequence is convergent. [The converse was proved earlier.]
Answer
Exercise 23 Let E be a closed set and {xn} a convergent sequence of points in E. Show that x = limn→∞xn must also
belong to E.
Answer
1.3.2
Series
The theory of series reduces to the theory of sequence limits by interpreting the sum of the series to be the sequence limit
∞
∑
k=1
ak = lim
n→∞
n
∑
k=1
ak.
Deﬁnition 1.4 (convergent series) A series
∞
∑
k=1
ak = a1 +a2 +a3 +a4 +....
is said to be convergent and to have a sum equal to L if the sequence of partial
sums
Sn =
n
∑
k=1
ak = a1 +a2 +a3 +a4 +···+an
converges to the number L. If a series fails to converge it is said to diverge.
Deﬁnition 1.5 (absolutely convergent series) A series
∞
∑
k=1
ak = a1 +a2 +a3 +a4 +....
is said to be absolutely convergent if both of the sequences of partial sums
Sn =
n
∑
k=1
ak = a1 +a2 +a3 +a4 +···+an
and
Tn =
n
∑
k=1
|ak| = |a1|+|a2|+|a3|+|a4|+···+|an|
are convergent.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.4. PARTITIONS
9
Exercise 24 Let
Sn =
n
∑
k=1
ak = a1 +a2 +a3 +a4 +···+an
be the sequence of partial sums of a series
∞
∑
k=1
ak = a1 +a2 +a3 +a4 +....
Show that Sn is Cauchy if and only if for every ε > 0 there is an integer N so that
¯¯¯¯¯
n
∑
k=m
ak
¯¯¯¯¯ < ε
for all n ≥m ≥N.
Answer
Exercise 25 Let
Sn =
n
∑
k=1
ak = a1 +a2 +a3 +a4 +···+an
and
Tn =
n
∑
k=1
|ak| = |a1|+|a2|+|a3|+|a4|+···+|an|.
Show that if {Tn} is a Cauchy sequence then so too is the sequence {Sn}. What can you conclude from this?
Answer
1.4
Partitions
When working with an interval and functions deﬁned on intervals we shall frequently ﬁnd that we must subdivide the
interval at a ﬁnite number of points. For example if [a,b] is a closed, bounded interval then any ﬁnite selection of points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b
breaks the interval into a collection of subintervals
{[xi−1,xi] : i = 1,2,3,...,n}
that are nonoverlapping and whose union is all of the original interval [a,b].
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

10
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
Most often when we do this we would need to focus attention on certain points chosen from each of the intervals. If
ξi is a point in [xi−1,xi] then the collection
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
will be called a partition of the interval [a,b].
In sequel we shall see many occasions when splitting up an interval this way is useful. In fact our integration theory
for a function f deﬁned on the interval [a,b] can often be expressed by considering the sum
n
∑
k=1
f(ξk)(xk −xk−1)
over a partition. This is known as a Riemann sum for f.
1.4.1
Cousin’s partitioning argument
The simple lemma we need for many proofs was ﬁrst formulated by Pierre Cousin.
Lemma 1.6 (Cousin) For every point x in a closed, bounded interval [a,b] let
there be given a positive number δ(x). Then there must exist at least one parti-
tion
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
of the interval [a,b] with the property that each interval [xi−1,xi] has length smaller
than δ(ξi).
Exercise 26 Show that this lemma is particularly easy if δ(x) = δ is constant for all x in [a,b].
Answer
Exercise 27 Prove Cousin’s lemma using a nested interval argument.
Answer
Exercise 28 Prove Cousin’s lemma using a “last point” argument.
Answer
Exercise 29 Use Cousin’s lemma to prove this version of the Heine-Borel theorem: Let C be a collection of open
intervals covering a closed, bounded interval [a,b]. Then there is a ﬁnite subcollection {(ci,di) : i = 1,2,3,...,n} from
C that also covers [a,b].
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.5. WHAT IS A FUNCTION?
11
Exercise 30 (connected sets) A set of real numbers E is disconnected if it is possible to ﬁnd two disjoint open sets G1
and G2 so that both sets contain at least one point of E and together they include all of E. Otherwise a set is connected.
Show that the interval [a,b] is connected using a Cousin partitioning argument.
Answer
Exercise 31 (connected sets) Show that the interval [a,b] is connected using a last point argument.
Answer
Exercise 32 Show that a set E that contains at least two points is connected if and only if it is an interval.
Answer
1.5
What is a function?
For most calculus students a function is a formula. We use the symbol
f : E →R
to indicate a function (whose name is “ f”) that must be deﬁned at every point x in the set E (E must be, for this course,
a subset of R) and to which some real number value f(x) is assigned. The way in which f(x) is assigned need not, of
course, be some algebraic formula. Any method of assignment is possible as long as it is clear what is the domain of the
function [i.e., the set E] and what is the value [i.e., f(x)] that this function assumes at each point x in E.
More important is the concept itself. When we see
“Let f : [0,1] →R be the function deﬁned by f(x) = x2 for all x in the interval [0,1] . . . ”
or just simply
“Let g : [0,1] →R . . . ”
we should be equally comfortable. In the former case we know and can compute every value of the function f and we
can sketch its graph. In the latter case we are just asked to consider that some function g is under consideration: we
know that it has a value g(x) at every point in its domain (i.e., the interval [0,1]) and we know that it has a graph and we
can discuss that function g as freely as we can the function f.
Even so calculus students will spend, unfortunately for their future understanding, undue time with formulas. For
this remember one rule: if a function is speciﬁed by a formula it is also essential to know what is the domain of the
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

12
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
function. The convention is usually to specify exactly what the domain intended should be, or else to take the largest
possible domain that the formula given would permit. Thus f(x) = √x does not specify a function until we reveal what
the domain of the function should be; since f(x) = √x (0 ≤x < ∞) is the best we could do, we would normally claim
that the domain is [0,∞).
Exercise 33 In a calculus course what are the assumed domains of the trigonometric functions sinx, cosx, and tanx?
Answer
Exercise 34 In a calculus course what are the assumed domains of the inverse trigonometric functions arcsinx and
arctanx?
Answer
Exercise 35 In a calculus course what are the assumed domains of the exponential and natural logarithm functions ex
and logx?
Answer
Exercise 36 In a calculus course what might be the assumed domains of the functions given by the formulas
f(x) =
1
(x2 −x−1)2 , g(x) =
p
x2 −x−1, and h(x) = arcsin(x2 −x−1)?
Answer
1.6
Continuous functions
Most of the functions that one encounters in the calculus are continuous. Continuity refers to the idea that a function
f should have small increments f(d) −f(c) on small intervals [c,d]. That is, however, a horribly imprecise statement
of it; what we wish is that the increment f(d)−f(c) should be as small as we please provided that the interval [c,d] is
sufﬁciently small.
The interpretation of
. . . as small as . . . provided . . . is sufﬁciently small . . .
is invariably expressed in the language of ε, δ, deﬁnitions that you will encounter in all of your mathematical studies and
which it is essential to master. Nearly everything in this course is expressed in ε, δ language.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.6. CONTINUOUS FUNCTIONS
13
1.6.1
Uniformly continuous and continuous functions
The notion of uniform continuity below is a global condition: it is a condition which holds throughout the whole of
some interval. Often we will encounter a more local variant where the continuity condition holds only close to some
particular point in the interval where the function is deﬁned. We ﬁx a particular point x0 in the interval and then repeat
the deﬁnition of uniform continuity but with the extra requirement that it need hold only near the point x0.
Deﬁnition 1.7 (uniform continuity) Let f : I →R be a function deﬁned on an
interval I. We say that f is uniformly continuous if for every ε > 0 there is a δ > 0
so that
| f(d)−f(c)| < ε
whenever c, d are points in I for which |d −c| < δ.
Deﬁnition 1.8 (pointwise continuity) Let f : I →R be a function deﬁned on an
open interval I and let x0 be a point in that interval. We say that f is [pointwise]
continuous at x0 if for every ε > 0 there is a δ(x0) > 0 so that
| f(x)−f(x0)| < ε
whenever x is a point in I for which |x−x0| < δ(x0). We say f is continuous on the
open interval I provided f is continuous at each point of I.
Note that continuity at a point requires that the function is deﬁned on both sides of the point as well as at the point.
Thus we would be very cautious about asserting continuity of the function f(x) = √x at 0. Uniform continuity on an
interval [a,b] does not require that the function is deﬁned on the right of a or the left of b. We are comfortable asserting
that f(x) = √x is uniformly continuous on [0,1]. (It is.)
A comment on the language: For most textbooks the language is simply
“continuous on a set” vs. “uniformly continuous on a set”
and the word “pointwise” is dropped. For teaching purposes it is important to grasp the distinction between these two
deﬁnitions; we use here the pointwise/uniform language to emphasize this very important distinction. We will see
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

14
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
this same idea and similar language in other places. A sequence of functions can converge pointwise or uniformly. A
Riemann sum approximation to an integral can be pointwise or uniform.
Exercise 37 Show that uniform continuity is stronger than pointwise continuity, i.e., show that a function f(x) that is
uniformly continuous on an open interval I is necessarily continuous on that interval.
Answer
Exercise 38 Show that uniform continuity is strictly stronger than pointwise continuity, i.e., show that a function f(x)
that is continuous on an open interval I is not necessarily uniformly continuous on that interval.
Answer
Exercise 39 Construct a function that is deﬁned on the interval (−1,1) and is continuous only at the point x0 = 0.
Answer
Exercise 40 Show that the function f(x) = x is uniformly continuous on the interval (−∞,∞).
Answer
Exercise 41 Show that the function f(x) = x2 is not uniformly continuous on the interval (−∞,∞).
Answer
Exercise 42 Show that the function f(x) = x2 is uniformly continuous on any bounded interval.
Answer
Exercise 43 Show that the function f(x) = x2 is not uniformly continuous on the interval (−∞,∞) but is continuous at
every real number x0.
Answer
Exercise 44 Show that the function f(x) = 1
x is not uniformly continuous on the interval (0,∞) or on the interval (−∞,0)
but is continuous at every real number x0 ̸= 0.
Answer
Exercise 45 (linear combinations) Suppose that F and G are functions on an open interval I and that both of them
are continuous at a point x0 in that interval. Show that any linear combination H(x) = rF(x) + sG(x) must also be
continuous at the point x0. Does the same statement apply to uniform continuity?
Answer
Exercise 46 (products) Suppose that F and G are functions on an open interval I and that both of them are continuous
at a point x0 in that interval. Show that the product H(x) = F(x)G(x) must also be continuous at the point x0. Does the
same statement apply to uniform continuity?
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.6. CONTINUOUS FUNCTIONS
15
Exercise 47 (quotients) Suppose that F and G are functions on an open interval I and that both of them are continuous
at a point x0 in that interval. Must the quotient H(x) = F(x)/G(x) must also be pointwise continuous at the point x0. Is
there a version for uniform continuity?
Answer
Exercise 48 (compositions) Suppose that F is a function on an open interval I and that F is continuous at a point x0
in that interval. Suppose that every value of F is contained in an interval J. Now suppose that G is a function on the
interval J that is continuous at the point z0 = f(x0). Show that the composition function H(x) = G(F(x)) must also be
continuous at the point x0.
Answer
Exercise 49 Show that the absolute value function f(x) = |x| is uniformly continuous on every interval.
Exercise 50 Show that the function
D(x) =
(
1
if x is irrational,
1
n
if x = m
n in lowest terms,
where m, n are integers expressing the rational number x = m
n , is continuous at every irrational number but discontinuous
at every rational number.
Exercise 51 (Heaviside’s function) Step functions play an important role in integration theory. They offer a crude way
of approximating functions. The function
H(x) =
½ 0
if x < 0
1
if x ≥0
is a simple step function that assumes just two values, 0 and 1, where 0 is assumed on the interval (−∞,0) and 1 is
assumed on [0,∞). Find all points of continuity of H.
Answer
Exercise 52 (step Functions) A function f deﬁned on a bounded interval is a step function if it assumes ﬁnitely many
values, say b1, b2, . . . , bN and for each 1 ≤i ≤N the set
f −1(bi) = {x : f(x) = bi},
which represents the set of points at which f assumes the value bi, is a ﬁnite union of intervals and singleton point sets.
(See Figure 1.1 for an illustration.) Find all points of continuity of a step function.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

16
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
b1
b2
b3
b4
b5
Figure 1.1: Graph of a step function.
Exercise 53 (characteristic function of the rationals) Show that function deﬁned by the formula
R(x) = lim
m→∞lim
n→∞|cos(m!πx)|n
is discontinuous at every point.
Answer
Exercise 54 (distance of a closed set to a point) Let C be a closed set and deﬁne a function by writing
d(x,C) = inf{|x−y| : y ∈C}.
This function gives a meaning to the distance between a set C and a point x. If x0 ∈C, then d(x0,C) = 0, and if x0 ̸∈C,
then d(x0,C) > 0. Show that function is continuous at every point. How might you interpret the fact that the distance
function is continuous?
Answer
Exercise 55 (sequence deﬁnition of continuity) Prove that a function f deﬁned on an open interval is continuous at a
point x0 if and only if limn→∞f(xn) = f(x0) for every sequence {xn} →x0.
Answer
Exercise 56 (mapping deﬁnition of continuity) Let f : (a,b) →R be deﬁned on an open interval. Then f is continuous
on (a,b) if and only if for every open set V ⊂R, the set
f −1(V) = {x ∈A : f(x) ∈V}
is open.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.6. CONTINUOUS FUNCTIONS
17
1.6.2
Oscillation of a function
Continuity of a function f asserts that the increment of f on an interval (c,d), i.e., the value f(d)−f(c), must be small
if the interval [c,d] is small. This can often be expressed more conveniently by the oscillation of the function on the
interval [c,d].
Deﬁnition 1.9 Let f be a function deﬁned on an interval I. We write
ω f(I) = sup{| f(x)−f(y)| : x,y ∈I}
and call this the oscillation of the function f on the interval I.
Exercise 57 Establish these properties of the oscillation:
1. ω f([c,d]) ≤ω f([a,b]) if [c,d] ⊂[a,b].
2. ω f([a,c]) ≤ω f([a,b])+ω f([b,c]) if a < b < c.
Exercise 58 (uniform continuity and oscillations) Let f : I →R be a function deﬁned on an interval I. Show that f is
uniformly continuous on I if and only if, for every ε > 0, there is a δ > 0 so that
ω f([c,d]) < ε
whenever [c,d] is a subinterval of I for which |d −c| < δ.
[Thus uniformly continuous functions have small increments f(d)−f(c) or equivalently small oscillations ω f([c,d]) on
sufﬁciently small intervals.]
Answer
Exercise 59 (uniform continuity and oscillations) Show that f is a uniformly continuous function on a closed, bounded
interval [a,b] if and only if, for every ε > 0, there are points
a = x0 < x1 < x2 < x3 < ··· < xn−1 < xn = b
so that each of
ω f([x0,x1]), ω f([x1,x2]),..., and ω f([xn−1,xn])
is smaller than ε. (Is there a similar statement for uniform continuity on open intervals?)
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

18
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
Exercise 60 (continuity and oscillations) Show that f is continuous at a point x0 in an open interval I if and only if for
every ε > 0 there is a δ(x0) > 0 so that
ω f([x0 −δ(x0),x0 +δ(x0)]) ≤ε.
Answer
Exercise 61 (continuity and oscillations) Let f : I →R be a function deﬁned on an open interval I. Show that f is
continuous at a point x0 in I if and only if for every ε > 0 there is a δ > 0 so that
ω f([c,d]) < ε
whenever [c,d] is a subinterval of I that contains the point x0 and for which |d −c| < δ.
Answer
Exercise 62 (limits and oscillations) Suppose that f is deﬁned on a bounded open interval (a,b). Show that a necessary
and sufﬁcient condition in order that F(a+) = limx→a+ F(x) should exist is that for all ε > 0 there should exist a positive
number δ(a) so that
ω f((a,a+δ(a)) < ε.
Answer
Exercise 63 (inﬁnite limits and oscillations) Suppose that F is deﬁned on (∞,∞). Show that a necessary and sufﬁcient
condition in order that F(∞) = limx→∞F(x) should exist is that for all ε > 0 there should exist a positive number T so
that
ω f((T,∞)) < ε.
Show that the same statement is true for F(−∞) = limx→−∞F(x) with the requirement that
ω f((−∞,−T)) < ε.
Answer
1.6.3
Endpoint limits
We are interested in computing, if possible the one-sided limits
F(a+) = lim
x→a+F(x) and F(b−) = lim
x→b−F(x)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.6. CONTINUOUS FUNCTIONS
19
for a function deﬁned on a bounded, open interval (a,b). Pointwise continuity will not help us here, but uniform
continuity does and this is an important application of uniform continuity.
There is a close connection between uniform and pointwise continuity. Uniform continuity is the stronger condition.
But under the conditions stated in our next theorem continuity and uniform continuity are equivalent. This theorem
should be attributed to Cauchy but cannot be, for he failed to notice the difference between the two concepts and simply
took it for granted that they were equivalent.
Theorem 1.10 (endpoint limits) Let F : (a,b) →R be a function that is continu-
ous on the bounded, open interval (a,b). Then the two limits
F(a+) = lim
x→a+F(x) and F(b−) = lim
x→b−F(x)
exist if and only if F is uniformly continuous on (a,b).
Corollary 1.11 (extension property) Let F : (a,b) →R be a function that is con-
tinuous on the bounded, open interval (a,b). Then F can be extended to a uni-
formly continuous function on all of the closed, bounded interval [a,b] if and only
if F is uniformly continuous on (a,b). That extension is obtained by deﬁning
F(a) = F(a+) = lim
x→a+F(x) and F(b) = F(b−) = lim
x→b−F(x)
both of which limits exist if F is uniformly continuous on (a,b).
Corollary 1.12 (subinterval property) Let F : (a,b) →R be a function that is
continuous on the bounded, open interval (a,b). Then F is uniformly continuous on
every closed, bounded subinterval [c,d] ⊂(a,b), but may or may not be a uniformly
continuous function on all of (a,b).
Corollary 1.13 (monotone property) Let F : (a,b) →R be a function that is con-
tinuous on the bounded, open interval (a,b) and is either monotone nondecreasing
or monotone nonincreasing. Then F is uniformly continuous on (a,b) if and only
if F is bounded on (a,b).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

20
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
Exercise 64 Prove one direction of the endpoint limit theorem [Theorem 1.10]: Show that if F is uniformly continuous
on (a,b) then the two limits
F(a+) = lim
x→a+F(x) and F(b−) = lim
x→b−F(x)
exist.
Answer
Exercise 65 Prove the other direction of the endpoint limit theorem [Theorem 1.10] using Exercise 62 and a Cousin
partitioning argument: Suppose that F : (a,b) →R is continuous on the bounded, open interval (a,b) and that the two
limits
F(a+) = lim
x→a+F(x) and F(b−) = lim
x→b−F(x)
exist. Show that F is uniformly continuous on (a,b).
Answer
Exercise 66 Prove the extension property [Corollary 1.11].
Answer
Exercise 67 Prove the subinterval property [Corollary 1.12].
Answer
Exercise 68 Prove the monotone property [Corollary 1.13].
Answer
Exercise 69 Prove the other direction of the endpoint limit theorem using a Bolzano-Weierstrass compactness argument:
Suppose that F : (a,b) →R is continuous on the bounded, open interval (a,b) and that the two limits
F(a+) = lim
x→a+F(x) and F(b−) = lim
x→b−F(x)
exist. Show that F is uniformly continuous on (a,b).
Answer
Exercise 70 Prove the other direction of the endpoint limit theorem using a Heine-Borel argument: Suppose that F :
(a,b) →R is continuous on the bounded, open interval (a,b) and that the two limits
F(a+) = lim
x→a+F(x) and F(b−) = lim
x→b−F(x)
exist. Show that F is uniformly continuous on (a,b).
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.6. CONTINUOUS FUNCTIONS
21
Exercise 71 Show that the theorem fails if we drop the requirement that the interval is bounded.
Answer
Exercise 72 Show that the theorem fails if we drop the requirement that the interval is closed.
Answer
Exercise 73 Criticize this proof of the false theorem that if f is continuous on an interval (a,b) then f must be uniformly
continuous on (a,b).
Suppose if f is continuous on (a,b). Let ε > 0 and for any x0 in (a,b) choose a δ > 0 so that | f(x)−f(x0)| <
ε if |x −x0| < δ. Then if c and d are any points that satisfy |c −d| < δ just set c = x and d = x0 to get
| f(d)−f(c)| < ε. Thus f must be uniformly continuous on (a,b).
Answer
Exercise 74 Suppose that G : (a,b) →R is continuous at every point of an open interval (a,b). Then show that G is
uniformly continuous on every closed, bounded subinterval [c,d] ⊂(a,b).
Answer
Exercise 75 Show that, if F : (a,b) →R is a function that is continuous on the bounded, open interval (a,b) but not
uniformly continuous, then one of the two limits
F(a+) = lim
x→a+F(x) or F(b−) = lim
x→b−F(x)
must fail to exist.
Answer
Exercise 76 Show that, if F : (a,b) →R is a function that is continuous on the bounded, open interval (a,b) and both
of the two limits
F(a+) = lim
x→a+F(x) and F(b−) = lim
x→b−F(x)
exist then F is in fact uniformly continuous on (a,b).
Answer
Exercise 77 Suppose that F : (a,b) →R is a function deﬁned on an open interval (a,b) and that c is a point in that
interval. Show that F is continuous at c if and only if both of the two one-sided limits
F(c+) = lim
x→c+F(x) and F(c−) = lim
x→c−F(x)
exist and F(c) = F(c+) = F(c−).
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

22
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
1.6.4
Boundedness properties
Continuity has boundedness implications. Pointwise continuity supplies local boundedness; uniform continuity supplies
global boundedness, but only on bounded intervals.
Deﬁnition 1.14 (bounded function) Let f : I →R be a function deﬁned on an
interval I. We say that f is bounded on I if there is a number M so that
| f(x)| ≤M
for all x in the interval I.
Deﬁnition 1.15 (locally bounded function) A function f deﬁned on an interval I
is said to be locally bounded at a point x0 if there is a δ(x0) > 0 so that f is bounded
on the set
(x0 −δ(x0),x0 +δ(x0))∩I.
Theorem 1.16 Let f : I →R be a function deﬁned on a bounded interval I and
suppose that f is uniformly continuous on I. Then f is a bounded function on I.
Theorem 1.17 Let f : I →R be a function deﬁned on an open interval I and sup-
pose that f is continuous at a point x0 in I. Then f is locally bounded at x0.
Remember that, if f is continuous on an open interval (a,b), then f is uniformly continuous on each closed subin-
terval [c,d] ⊂(a,b). Thus, in order for f to be unbounded on (a,b) the large values are occurring only at the endpoints.
Let us say that f is locally bounded on the right at a if there is at least one interval (a,a + δa) on which f is bounded.
Similarly we can deﬁne locally bounded on the left at b. This corollary is then immediate.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.6. CONTINUOUS FUNCTIONS
23
Corollary 1.18 Let f : (a,b) →R be a function deﬁned on an open interval (a,b).
Suppose that
1. f is continuous at every point in (a,b).
2. f is locally bounded on the right at a.
3. f is locally bounded on the left at b.
Then f is bounded on the interval (a,b).
Exercise 78 Use Exercise 59 to prove Theorem 1.16.
Answer
Exercise 79 Prove Theorem 1.17 by proving that all continuous functions are locally bounded.
Answer
Exercise 80 It follows from Theorem 1.16 that a continuous, unbounded function on a bounded open interval (a,b)
cannot be uniformly continuous. Can you prove that a continuous, bounded function on a bounded open interval (a,b)
must be uniformly continuous?
Answer
Exercise 81 Show that f is not bounded on an interval I if and only if there must exist a sequence of points {xn} for
which f|(xn)| →∞.
Answer
Exercise 82 Using Exercise 81 and the Bolzano-Weierstrass argument, show that if a function f is locally bounded at
each point of a closed, bounded interval [a,b] then f must be bounded on [a,b].
Exercise 83 Using Cousin’s lemma, show that if a function f is locally bounded at each point of a closed, bounded
interval [a,b] then f must be bounded on [a,b].
Exercise 84 If a function is uniformly continuous on an unbounded interval must the function be unbounded? Could it
be bounded?
Answer
Exercise 85 Suppose f, g : I →R are two bounded functions on I. Is the sum function f +g necessarily bounded on I?
Is the product function fg necessarily bounded on I?
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

24
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
Exercise 86 Suppose f, g : I →R are two bounded functions on I and suppose that the function g does not assume the
value zero. Is the quotient function f/g necessarily bounded on I?
Answer
Exercise 87 Suppose f, g : R →R are two bounded functions. Is the composite function h(x) = f(g(x)) necessarily
bounded?
Answer
Exercise 88 Show that the function f(x) = sinx is uniformly continuous on the interval (−∞,∞).
Answer
Exercise 89 A function deﬁned on an interval I is said to satisfy a Lipschitz condition there if there is a number M with
the property that
|F(x)−F(y)| ≤M|x−y|
for all x, y ∈I. Show that a function that satisﬁes a Lipschitz condition on an interval is uniformly continuous on that
interval.
Answer
Exercise 90 Show that f is not uniformly continuous on an interval I if and only if there must exist two sequences of
points {xn} and {xn} from that interval for which xn −yn →0 but f(xn)−f(yn) does not converge to zero.
Answer
1.7
Existence of maximum and minimum
Uniformly continuous function are bounded on bounded intervals. Must they have a maximum and a minimum value?
We know that continuous functions need not be bounded so our focus will be on uniformly continuous functions on
closed, bounded intervals.
Theorem 1.19 Let F : [a,b] →R be a function deﬁned on a closed, bounded in-
terval [a,b] and suppose that F is uniformly continuous on [a,b]. Then F attains
both a maximum value and a minimum value in that interval.
Exercise 91 Prove Theorem 1.19 using a least upper bound argument.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.7. EXISTENCE OF MAXIMUM AND MINIMUM
25
Exercise 92 Prove Theorem 1.19 using a Bolzano-Weierstrass argument.
Answer
Exercise 93 Give an example of a uniformly continuous function on the interval (0,1) that attains a maximum but does
not attain a minimum.
Answer
Exercise 94 Give an example of a uniformly continuous function on the interval (0,1) that attains a minimum but does
not attain a maximum.
Answer
Exercise 95 Give an example of a uniformly continuous function on the interval (0,1) that attains neither a minimum
nor a maximum.
Answer
Exercise 96 Give an example of a uniformly continuous function on the interval (−∞,∞) that attains neither a minimum
nor a maximum.
Answer
Exercise 97 Give an example of a uniformly continuous, bounded function on the interval (−∞,∞) that attains neither
a minimum nor a maximum.
Answer
Exercise 98 Let f : R →R be an everywhere continuous function with the property that
lim
x→∞f(x) = lim
x→−∞f(x) = 0.
Show that f has either an absolute maximum or an absolute minimum but not necessarily both.
Answer
Exercise 99 Let f : R →R be an everywhere continuous function that is periodic in the sense that for some number p,
f(x+ p) = f(x) for all x ∈R. Show that f has an absolute maximum and an absolute minimum.
Answer
1.7.1
The Darboux property of continuous functions
We deﬁne the Darboux property of a function and show that all continuous functions have this property.
Deﬁnition 1.20 (Darboux Property) Let f be deﬁned on an interval I. Suppose
that for each a,b ∈I with f(a) ̸= f(b), and for each d between f(a) and f(b),
there exists c between a and b for which f(c) = d. We then say that f has the
Darboux property [intermediate value property] on I.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

26
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
Functions with this property are called Darboux functions after Jean Gaston Darboux (1842–1917), who showed in
1875 that for every differentiable function F on an interval I, the derivative F′ has the intermediate value property on I.
Theorem 1.21 (Darboux property of continuous functions) Let f : (a,b) →R
be a continuous function on an open interval (a,b). Then f has the Darboux
property on that interval.
Exercise 100 Prove Theorem 1.21 using a Cousin covering argument.
Answer
Exercise 101 Prove Theorem 1.21 using a Bolzano-Weierstrass argument.
Answer
Exercise 102 Prove Theorem 1.21 using the Heine-Borel property.
Answer
Exercise 103 Prove Theorem 1.21 using the least upper bound property.
Answer
Exercise 104 Suppose that f : (a,b) →R is a continuous function on an open interval (a,b). Show that f maps (a,b)
onto an interval. Show that this interval need not be open, need not be closed, and need not be bounded.
Answer
Exercise 105 Suppose that f : [a,b] →R is a uniformly continuous function on a closed, bounded interval [a,b]. Show
that f maps [a,b] onto an interval. Show that this interval must be closed and bounded.
Answer
Exercise 106 Deﬁne the function
F(x) =
½ sinx−1
if x ̸= 0
0
if x = 0.
Show that F has the Darboux property on every interval but that F is not continuous on every interval. Show, too, that
F assumes every value in the interval [−1,1] inﬁnitely often.
Answer
Exercise 107 (ﬁxed points) A function f : [a,b] →[a,b] is said to have a ﬁxed point c ∈[a,b] if f(c) = c. Show that
every uniformly continuous function f mapping [a,b] into itself has at least one ﬁxed point.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.8. DERIVATIVES
27
Exercise 108 (ﬁxed points) Let f : [a,b] →[a,b] be continuous. Deﬁne a sequence recursively by z1 = x1, z2 = f(z1),
.. . , zn = f(zn−1) where x1 ∈[a,b]. Show that if the sequence {zn} is convergent, then it must converge to a ﬁxed point of
f.
Answer
Exercise 109 Is there a continuous function f : I →R deﬁned on an interval I such that for every real y there are
precisely either zero or two solutions to the equation f(x) = y?
Answer
Exercise 110 Is there a continuous function f : R →R such that for every real y there are precisely either zero or three
solutions to the equation f(x) = y?
Answer
Exercise 111 Suppose that the function f : R →R is monotone nondecreasing and has the Darboux property. Show
that f must be continuous at every point.
Answer
1.8
Derivatives
A derivative2 of a function is another function “derived” from the ﬁrst function by a procedure (which we do not have to
review here). Thus, for example, we remember that, if
F(x) = x2 +x+1
then the derived function is
F′(x) = 2x+1.
The values of the derived function, 2x + 1, represent (geometrically) the slope of the tangent line at the points (x,x2 +
x + 1) that are on the graph of the function F. There are numerous other interpretations (other than the geometric) for
the values of the derivative function.
Recall the usual notations for derivatives:
d
dx sinx = cosx.
F(x) = sinx, F′(x) = cosx.
2The word derivative in mathematics almost always refers to this concept. In ﬁnance, you might have noticed, derivatives are ﬁnancial
instrument whose values are “derived” from some underlying security. Observe that the use of the word “derived” is the same.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

28
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
y = sinx, dy
dx = cosx.
The connection between a function and its derivative is straightforward: the values of the function F(x) are used,
along with a limiting process, to determine the values of the derivative function F′(x). That’s the deﬁnition. We need to
know the deﬁnition to understand what the derivative signiﬁes, but we do not revert to the deﬁnition for computations
except very rarely.
The following facts should be familiar:
• A function may or may not have a derivative at a point.
• In order for a function f to have a derivative at a point x0 the function must be deﬁned at least in some open
interval that contains that point.
• A function that has a derivative at a point x0 is said to be differentiable at x0. If it fails to have a derivative there
then it is said to be nondifferentiable at that point.
• There are many calculus tables that can be consulted for derivatives of functions for which familiar formulas are
given.
• There are many rules for computation of derivatives for functions that do not appear in the tables explicitly, but
for which the tables are nonetheless useful after some further manipulation.
• Information about the derivative function offers deep insight into the nature of the function itself. For example a
zero derivative means the function is constant; a nonnegative derivative means the function is increasing. A change
in the derivative from positive to negative indicates that a local maximum point in the function was reached.
Exercise 112 (ε, δ(x) version of derivative) Suppose that F is a differentiable function on an interval I. Show that for
every x ∈I and every ε > 0 there is a δ(x) > 0 so that
¯¯F(y)−F(x)−F′(x)(y−x)
¯¯ ≤ε|y−x|
whenever y and x are points in I for which |y−x| < δ(x).
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.8. DERIVATIVES
29
Exercise 113 (differentiable implies continuous) Prove that a function that has a derivative at a point x0 must also be
continuous at that point.
Answer
Exercise 114 (ε, δ(x) straddled version of derivative) Suppose that F is a differentiable function on an interval I.
Show that for every x ∈I and every ε > 0 there is a δ(x) > 0 so that
¯¯F(z)−F(y)−F′(x)(z−y)
¯¯ ≤ε|z−y|
whenever y and z are points in I for which |y−z| < δ(x) and either y ≤x ≤z or z ≤x ≤y.
Answer
Exercise 115 (ε, δ(x) unstraddled version of derivative) Suppose that F is a differentiable function on an open inter-
val I. Suppose that for every x ∈I and every ε > 0 there is a δ(x) > 0 so that
¯¯F(z)−F(y)−F′(x)(z−y)
¯¯ ≤ε|z−y|
whenever y and z are points in I for which |y −z| < δ(x) [and we do not require either y ≤x ≤z or z ≤x ≤y]. Show
that not all differentiable functions would have this property but that if F′ is continuous then this property does hold.
Answer
Exercise 116 (locally strictly increasing functions) Suppose that F is a function on an open interval I. Then F is said
to be locally strictly increasing at a point x0 in the interval if there is a δ > 0 so that
F(y) < F(x0) < F(z)
for all
x0 −δ < y < x0 < z < x0 +δ.
Show that, if F′(x0) > 0, then F must be locally strictly increasing at x0. Show that the converse does not quite hold: if
F is differentiable at a point x0 in the interval and is also locally strictly increasing at x0, then necessarily F′(x0) ≥0
but that F′(x0) = 0 is possible.
Answer
Exercise 117 Suppose that a function F is locally strictly increasing at every point of an open interval (a,b). Use the
Cousin partitioning argument to show that F is strictly increasing on (a,b).
[In particular, notice that this means that a function with a positive derivative is increasing. This is usually proved using
the mean-value theorem that is stated in Section 1.10 below.]
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

30
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
1.9
Differentiation rules
We remind the reader of the usual calculus formulas by presenting the following slogans. Of course each should be given
a precise statement and the proper assumptions clearly made.
Constant rule: if f(x) is constant, then f ′ = 0.
Linear combination rule: (r f +sg)′ = r f ′ +sg′ for functions f and g and all real numbers r and s.
Product rule: (fg)′ = f ′g+ fg′ for functions f and g.
Quotient rule:
µ f
g
¶′
= f ′g−fg′
g2
for functions f and g at points where g does not vanish.
Chain rule: If f(x) = h(g(x)), then
f ′(x) = h′(g(x))·g′(x).
1.10
Mean-value theorem
There is a close connection between the values of a function and the values of its derivative. In one direction this is
trivial since the derivative is deﬁned in terms of the values of the function. The other direction is more subtle. How
does information about the derivative provide us with information about the function? One of the keys to providing that
information is the mean-value theorem.
The usual proof presented in calculus texts requires proving a weak version of the mean-value theorem ﬁrst (Rolle’s
theorem) and then using that to prove the full version.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.10. MEAN-VALUE THEOREM
31
1.10.1
Rolle’s theorem
Theorem 1.22 (Rolle’s Theorem) Let f be uniformly continuous on [a,b] and dif-
ferentiable on (a,b). If f(a) = f(b) then there must exist at least one point ξ in
(a,b) such that f ′(ξ) = 0.
Exercise 118 Prove the theorem.
Answer
Exercise 119 Interpret the theorem geometrically.
Answer
Exercise 120 Can we claim that the point ξ whose existence is claimed by the theorem, is unique?. How many points
might there be?
Answer
Exercise 121 Deﬁne a function f(x) = xsinx−1, f(0) = 0, on the whole real line. Can Rolle’s theorem be applied on
the interval [0,1/π]?
Answer
Exercise 122 Is it possible to apply Rolle’s theorem to the function f(x) =
√
1−x2 on [−1,1].
Answer
Exercise 123 Is it possible to apply Rolle’s theorem to the function f(x) =
p
|x| on [−1,1].
Answer
Exercise 124 Use Rolle’s theorem to explain why the cubic equation
x3 +αx2 +β = 0
cannot have more than one solution whenever α > 0.
Answer
Exercise 125 If the nth-degree equation
p(x) = a0 +a1x+a2x2 +···+anxn = 0
has n distinct real roots, then how many distinct real roots does the (n−1)st degree equation p′(x) = 0 have?
Answer
Exercise 126 Suppose that f ′(x) > c > 0 for all x ∈[0,∞). Show that limx→∞f(x) = ∞.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

32
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
Exercise 127 Suppose that f : R →R and both f ′ and f ′′ exist everywhere. Show that if f has three zeros, then there
must be some point ξ so that f ′′(ξ) = 0.
Answer
Exercise 128 Let f be continuous on an interval [a,b] and differentiable on (a,b) with a derivative that never is zero.
Show that f maps [a,b] one-to-one onto some other interval.
Answer
Exercise 129 Let f be continuous on an interval [a,b] and twice differentiable on (a,b) with a second derivative that
never is zero. Show that f maps [a,b] two-one onto some other interval; that is, there are at most two points in [a,b]
mapping into any one value in the range of f.
Answer
1.10.2
Mean-Value theorem
If we drop the requirement in Rolle’s theorem that f(a) = f(b), we now obtain the result that there is a point c ∈(a,b)
such that
f ′(c) = f(b)−f(a)
b−a
.
Geometrically, this states that there exists a point c ∈(a,b) for which the tangent to the graph of the function at (c, f(c))
is parallel to the chord determined by the points (a, f(a)) and (b, f(b)). (See Figure 1.2.)
This is the mean-value theorem, also known as the law of the mean or the ﬁrst mean-value theorem (because there
are other mean-value theorems).
Theorem 1.23 (Mean-Value Theorem) Suppose that f is a continuous function
on the closed interval [a,b] and differentiable on (a,b) . Then there exists a point
ξ ∈(a,b) such that
f ′(ξ) = f(b)−f(a)
b−a
.
Exercise 130 Prove the theorem.
Answer
Exercise 131 Suppose f satisﬁes the hypotheses of the mean-value theorem on [a,b]. Let S be the set of all slopes of
chords determined by pairs of points on the graph of f and let
D = { f ′(x) : x ∈(a,b)}.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.10. MEAN-VALUE THEOREM
33
a
b
c
Figure 1.2: Mean value theorem [ f ′(c) is slope of the chord].
1. Prove that S ⊂D.
2. Give an example to show that D can contain numbers not in S.
Answer
Exercise 132 Interpreting the slope of a chord as an average rate of change and the derivative as an instantaneous rate
of change, what does the mean-value theorem say? If a car travels 100 miles in 2 hours, and the position s(t) of the car
at time t, measured in hours satisﬁes the hypotheses of the mean-value theorem, can we be sure that there is at least one
instant at which the velocity is 50 mph?
Answer
Exercise 133 Give an example to show that the conclusion of the mean-value theorem can fail if we drop the requirement
that f be differentiable at every point in (a,b) .
Answer
Exercise 134 Give an example to show that the conclusion of the mean-value theorem can fail if we drop the requirement
of continuity at the endpoints of the interval.
Answer
Exercise 135 Suppose that f is differentiable on [0,∞) and that
lim
x→∞f ′(x) = C.
Determine
lim
x→∞[ f(x+a)−f(x)].
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

34
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
Answer
Exercise 136 Suppose that f is continuous on [a,b] and differentiable on (a,b). If
lim
x→a+ f ′(x) = C
what can you conclude about the right-hand derivative of f at a?
Answer
Exercise 137 Suppose that f is continuous and that
lim
x→x0 f ′(x)
exists. What can you conclude about the differentiability of f? What can you conclude about the continuity of f ′?
Answer
Exercise 138 Let f : [0,∞) →R so that f ′ is decreasing and positive. Show that the series
∞
∑
i=1
f ′(i)
is convergent if and only if f is bounded.
Answer
Exercise 139 Prove this second-order version of the mean-value theorem.
Theorem 1.24 (Second order mean-value theorem) Let f be continuous on [a,b]
and twice differentiable on (a,b) . Then there exists c ∈(a,b) such that
f(b) = f(a)+(b−a)f ′(a)+(b−a)2 f ′′(c)
2!
.
Answer
Exercise 140 Determine all functions f : R →R that have the property that
f ′
µx+y
2
¶
= f(x)−f(y)
x−y
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.10. MEAN-VALUE THEOREM
35
for every x ̸= y.
Answer
Exercise 141 A function is said to be smooth at a point x if
lim
h→0
f(x+h)+ f(x−h)−2 f(x)
h2
= 0.
Show that a smooth function need not be continuous. Show that if f ′′ is continuous at x, then f is smooth at x.
Answer
Exercise 142 Prove this version of the mean-value theorem due to Cauchy.
Theorem 1.25 (Cauchy mean-value theorem) Let f and g be uniformly continu-
ous on [a,b] and differentiable on (a,b). Then there exists ξ ∈(a,b) such that
[ f(b)−f(a)]g′(ξ) = [g(b)−g(a)]f ′(ξ).
(1.1)
Answer
Exercise 143 Interpret the Cauchy mean-value theorem geometrically.
Answer
Exercise 144 Use Cauchy’s mean-value theorem to prove any simple version of L’Hôpital’s rule that you can remember
from calculus.
Answer
Exercise 145 Show that the conclusion of Cauchy’s mean-value can be put into determinant form as
¯¯¯¯¯¯
f(a)
g(a)
1
f(b)
g(b)
1
f ′(c)
g′(c)
0
¯¯¯¯¯¯
= 0.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

36
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
Exercise 146 Formulate and prove a generalized version of Cauchy’s mean-value whose conclusion is the existence of
a point c such that
¯¯¯¯¯¯
f(a)
g(a)
h(a)
f(b)
g(b)
h(b)
f ′(c)
g′(c)
h′(c)
¯¯¯¯¯¯
= 0.
Answer
Exercise 147 Suppose that f : [a,c] →R is uniformly continuous and that it has a derivative f ′(x) that is monotone
increasing on the interval (a,c). Show that
(b−a)f(c)+(c−b)f(a) ≥(c−a)f(b)
for any a < b < c.
Answer
Exercise 148 (avoiding the mean-value theorem) The primary use [but not the only use] of the mean-value theorem
in a calculus class is to establish that a function with a positive derivative on an open interval (a,b) would have to be
increasing. Prove this directly without the easy mean-value proof.
Answer
Exercise 149 Prove the “converse” to the mean-value theorem:
Let F, f : [a,b] →R and suppose that f is continuous there. Suppose that for every pair of points a < x <
y < b there is a point x < ξ < y so that
F(y)−F(x)
y−x
= f(ξ).
Then F is differentiable on (a,b) and f is its derivative.
Answer
Exercise 150 Let f : [a,b] →R be a uniformly continuous function that is differentiable at all points of the interval
(a,b) with possibly ﬁnitely many exceptions. Show that there is a point a < ξ < b so that
¯¯¯¯
f(b)−f(a)
b−a
¯¯¯¯ ≤|f ′(ξ)|.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.10. MEAN-VALUE THEOREM
37
Exercise 151 (Flett’s theorem) Given a function differentiable at every point of an interval [a,b] and with f ′(a) = f ′(b),
show that there is a point ξ in the interval for which
f(ξ)−f(a)
ξ−a
= f(ξ).
Answer
1.10.3
The Darboux property of the derivative
We have proved that all continuous functions have the Darboux property. We now prove that all derivatives have the
Darboux property. This was proved by Darboux in 1875; one of the conclusions he intended was that there must be
an abundance of functions that have the Darboux property and are yet not continuous, since all derivatives have this
property and not all derivatives are continuous.
Theorem 1.26 (Darboux property of the derivative) Let F be differentiable on
an open interval I. Suppose a,b ∈I, a < b, and F′(a) ̸= F′(b). Let γ be any
number between F′(a) and F′(b). Then there must exist a point ξ ∈(a,b) such that
F′(ξ) = γ.
Exercise 152 Compare Rolle’s theorem to Darboux’s theorem. Suppose G is everywhere differentiable, that a < b and
G(a) = G(b). Then Rolle’s theorem asserts the existence of a point ξ in the open interval (a,b) for which G′(ξ) = 0.
Give a proof of the same thing if the hypothesis G(a) = G(b) is replaced by G′(a) < 0 < G′(b) or G′(b) < 0 < G′(a).
Use that to prove Theorem 1.26.
Answer
Exercise 153 Let F : R →R be a differentiable function. Show that F′ is continuous if and only if the set
Eα = {x : F′(x) = α}
is closed for each real number α.
Answer
Exercise 154 A function deﬁned on an interval is piecewise monotone if the interval can be subdivided into a ﬁnite
number of subintervals on each of which the function is nondecreasing or nonincreasing. Show that every polynomial is
piecewise monotone.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

38
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
1.10.4
Vanishing derivatives and constant functions
When the derivative is zero we sometimes use colorful language by saying that the derivative vanishes! When the
derivative of a function vanishes we expect the function to be constant. But how is that really proved?
Theorem 1.27 (vanishing derivatives) Let F : [a,b] →R be uniformly continuous
on the closed, bounded interval [a,b] and suppose that F′(x) = 0 for every a < x <
b. Then F is a constant function on [a,b].
Corollary 1.28 Let F : (a,b) →R and suppose that F′(x) = 0 for every a < x < b.
Then F is a constant function on (a,b).
Exercise 155 Prove the theorem using the mean-value theorem.
Answer
Exercise 156 Prove the theorem without using the mean-value theorem.
Answer
Exercise 157 Deduce the corollary from the theorem.
Answer
1.10.5
Vanishing derivatives with exceptional sets
When a function has a vanishing derivative then that function must be constant. What if there is a small set of points at
which we are unable to determine that the derivative is zero?
Theorem 1.29 (vanishing derivatives with a few exceptions) Let F : [a,b] →R
be uniformly continuous on the closed, bounded interval [a,b] and suppose that
F′(x) = 0 for every a < x < b with ﬁnitely many possible exceptions. Then F is a
constant function on [a,b].
Corollary 1.30 Let F : (a,b) →R be continuous on the open interval (a,b) and
suppose that F′(x) = 0 for every a < x < b with ﬁnitely many possible exceptions.
Then F is a constant function on (a,b).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.10. MEAN-VALUE THEOREM
39
Exercise 158 Prove the theorem by subdividing the interval at the exceptional points.
Answer
Exercise 159 Prove the theorem by applying Exercise 150.
Exercise 160 Prove the corollary.
Answer
Exercise 161 Let F, G : [a,b] →R be uniformly continuous functions on the closed, bounded interval [a,b] and suppose
that F′(x) = f(x) for every a < x < b with ﬁnitely many possible exceptions, and that G′(x) = f(x) for every a < x < b
with ﬁnitely many possible exceptions. Show that F and G differ by a constant [a,b].
Answer
Exercise 162 Construct a non-constant function which has a zero derivative at all but ﬁnitely many points.
Answer
Exercise 163 Prove the following major improvement of Theorem 1.29. Here, by many exceptions, we include the pos-
sibility of inﬁnitely many exceptions provided, only, that it is possible to arrange the exceptional points into a sequence.
Theorem 1.31 (vanishing derivatives with many exceptions) Let F : [a,b] →R be
uniformly continuous on the closed, bounded interval [a,b] and suppose that
F′(x) = 0 for every a < x < b with the possible exception of the points c1, c2,
c3, . . . forming an inﬁnite sequence. Show that F is a constant function on [a,b].
[The argument that was successful for Theorem 1.29 will not work for inﬁnitely many exceptional points. A Cousin
partitioning argument does work.]
Answer
Exercise 164 Suppose that F is a function continuous at every point of the real line and such that F′(x) = 0 for every x
that is irrational. Show that F is constant.
Answer
Exercise 165 Suppose that G is a function continuous at every point of the real line and such that G′(x) = x for every x
that is irrational. What functions G have such a property?
Answer
Exercise 166 Let F, G : [a,b] →R be uniformly continuous functions on the closed, bounded interval [a,b] and suppose
that F′(x) = f(x) for every a < x < b with the possible exception of points in a sequence {c1,c2,c3,...}, and that
G′(x) = f(x) for every a < x < b with the possible exception of points in a sequence {d1,d2,d3,...}. Show that F and G
differ by a constant [a,b].
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

40
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
1.11
Lipschitz functions
A function satisﬁes a Lipschitz condition if there is some limitation on the possible slopes of secant lines, lines joining
points (x, f(x)) and (y, f(x). Since the slope of such a line would be
f(y)−f(x)
y−x
any bounds put on this fraction is called a Lipschitz condition.
Deﬁnition 1.32 A function f is said to satisfy a Lipschitz condition on an interval
I if
| f(x)−f(y)| ≤M|x−y|
for all x, y in the interval.
Functions that satisfy such a condition are called Lipschitz functions and play a key role in many parts of analysis.
Exercise 167 Show that a function that satisﬁes a Lipschitz condition on an interval must be uniformly continuous on
that interval.
Exercise 168 Show that if f is assumed to be continuous on [a,b] and differentiable on (a,b) then f is a Lipschitz
function if and only if the derivative f ′ is bounded on (a,b).
Answer
Exercise 169 Show that the function f(x) = √x is uniformly continuous on the interval [0,∞) but that it does not satisfy
a Lipschitz condition on that interval.
Answer
Exercise 170 A function F on an interval I is said to have bounded derived numbers if there is a number M so that, for
each x ∈I one can choose δ > 0 so that
¯¯¯¯
F(x+h)−F(x)
h
¯¯¯¯ ≤M
whenever x + h ∈I and |h| < δ. Using a Cousin partitioning argument, show that F is Lipschitz if and only if F has
bounded derived numbers.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

1.11. LIPSCHITZ FUNCTIONS
41
Exercise 171 Is a linear combination of Lipschitz functions also Lipschitz?
Answer
Exercise 172 Is a product of Lipschitz functions also Lipschitz?
Answer
Exercise 173 Is f(x) = logx a Lipschitz function?
Answer
Exercise 174 Is f(x) = |x| a Lipschitz function?
Answer
Exercise 175 If F : [a,b] →R is a Lipschitz function show that the function G(x) = F(x) + kx is increasing for some
value k and decreasing for some other value of k. Is the converse true?
Exercise 176 Show that every polynomial is a Lipschitz function on any bounded interval. What about unbounded
intervals?
Exercise 177 In an idle moment a careless student proposed to study a kind of super Lipschitz condition: he supposed
that
| f(x)−f(y)| ≤M|x−y|2
for all x, y in an interval. What functions would have this property?
Answer
Exercise 178 A function f is said to be bi-Lipschitz on an interval I if there is an M > 0 so that
1
M|x−y| ≤|f(x)−f(y)| ≤M|x−y|
for all x, y in the interval. What can you say about such functions? Can you give examples of such functions?
Exercise 179 Is there a difference between the following two statements:
| f(x)−f(y)| < |x−y| for all x, y in an interval
and
| f(x)−f(y)| ≤K|x−y| for all x, y in an interval, for some K < 1?
Answer
Exercise 180 If Fn : [a,b] →R is a Lipschitz function for each n = 1,2,3,... and F(x) = limn→∞Fn(x) for each a ≤x ≤b,
does it follow that F must also be a Lipschitz function.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

42
CHAPTER 1. WHAT YOU SHOULD KNOW FIRST
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

Chapter 2
The Indeﬁnite Integral
You will, no doubt, remember the formula
Z
x2 dx = x3
3 +C
from your ﬁrst calculus classes. This assertion includes the following observations.
•
d
dx
·x3
3 +C
¸
= x2.
• Any other function F for which the identity F′(x) = x2 holds is of the form F(x) = x3/3+C for some constant C.
• C is called the constant of integration and is intended as a completely arbitrary constant.
• The expression
R x2 dx is intended to be ambiguous and is to include any and all functions whose derivative is x2.
In this chapter we will make this rather more precise and we will generalize by allowing a ﬁnite exceptional set
where the derivative need not exist.
43
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

44
CHAPTER 2. THE INDEFINITE INTEGRAL
2.1
An indeﬁnite integral on an interval
We will state our deﬁnition for open intervals only. We shall assume that indeﬁnite integrals are continuous and we
require them to be differentiable everywhere except possibly at a ﬁnite set.
Deﬁnition 2.1 Let (a,b) be an open interval (bounded or unbounded) and let f be
a function deﬁned on that interval except possibly at ﬁnitely many points. Then any
continuous function F : (a,b) →R for which F′(x) = f(x) for all a < x < b except
possibly at ﬁnitely many points is said to be an indeﬁnite integral for f on (a,b).
The notation
Z
F′(x)dx = F(x)+C
will frequently be used. Our indeﬁnite integration theory is essentially the study of continuous functions F : (a,b) →R
deﬁned on an open interval, for which there is only a ﬁnite number of points of nondifferentiability. Note that, if there
are no exceptional points, then we do not have to check that the function is continuous: every differentiable function is
continuous.
The indeﬁnite integration theory is, consequently, all about derivatives. We shall see too, in the next chapter, that the
deﬁnite integration theory is also all about derivatives.
Exercise 181 Suppose that F : (a,b) →R is differentiable at every point of the open interval (a,b). Is F an indeﬁnite
integral for F′?
Answer
Exercise 182 If F is an indeﬁnite integral for a function f on an open interval (a,b) and a < x < b, is it necessarily true
that F′(x) = f(x).
Answer
Exercise 183 Let F, G : (a,b) →R be two continuous functions for which F′(x) = f(x) for all a < x < b except possibly
at ﬁnitely many points and G′(x) = f(x) for all a < x < b except possibly at ﬁnitely many points. Then F and G must
differ by a constant. In particular, on the interval (a,b) the statements
Z
f(x)dx = F(x)+C1
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

2.1. AN INDEFINITE INTEGRAL ON AN INTERVAL
45
and
Z
f(x)dx = G(x)+C2
are both valid (where C1 and C2 represent arbitrary constants of integration).
Answer
2.1.1
Role of the ﬁnite exceptional set
The simplest kind of antiderivative is expressed in the situation F′(x) = f(x) for all a < x < b [no exceptions]. Our theory
is slightly more general in that we allow a ﬁnite set of failures and compensate for this by insisting that the function F is
continuous at those points.
There is a language that is often adopted to allow exceptions in mathematical statements. We do not use this language
in Chapter 2 or Chapter 3 but, for classroom presentation, it might be useful. We will use this language in Chapter 4 and
in Part Two of the text.
mostly everywhere A statement holds mostly everywhere if it holds everywhere with the exception of a ﬁnite set of
points c1, c2, c3, . . . , cn.
nearly everywhere A statement holds nearly everywhere if it holds everywhere with the exception of a sequence of
points c1, c2, c3, . . . .
almost everywhere A statement holds almost everywhere if it holds everywhere with the exception of a set of measure
zero1.
Thus our indeﬁnite integral is the study of continuous functions that are differentiable mostly everywhere. It is
only a little bit more ambitious to allow a sequence of points of nondifferentiability. This is the point of view taken
in the elementary analysis text, Elias Zakon, Mathematical Analysis I, ISBN 1-931705-02-X, published by The Trillia
Group, 2004. Thus, in his text, all integrals concern continuous functions that are differentiable nearly everywhere. The
mostly everywhere case is the easiest since it needs an appeal only to the mean-value theorem for justiﬁcation. The
nearly everywhere case is rather harder, but if you have worked through the proof of Theorem 1.31 you have seen all the
difﬁculties handled fairly easily.
1This notion of a set of measure zero will be deﬁned in Chapter 4. For now understand that a set of measure zero is small in a certain sense of
measurement.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

46
CHAPTER 2. THE INDEFINITE INTEGRAL
The ﬁnal step in the program of improving integration theory is to allow sets of measure zero and study functions that
are differentiable almost everywhere. This presents new technical challenges and we shall not attempt it until Chapter 4.
Our goal is to get there using Chapters 2 and 3 as elementary warmups.
2.1.2
Features of the indeﬁnite integral
We shall often in the sequel distinguish among the following four cases for an indeﬁnite integral.
Theorem 2.2 Let F be an indeﬁnite integral for a function f on an open interval
(a,b).
1. F is continuous on (a,b) but may or not be uniformly continuous there.
2. If f is bounded then F is Lipschitz on (a,b) and hence uniformly continuous
there.
3. If f unbounded then F is not Lipschitz on (a,b) and may or not be uniformly
continuous there.
4. If f is nonnegative and unbounded then F is uniformly continuous on (a,b)
if and only if F is bounded.
Exercise 184 Give an example of two functions f and g possessing indeﬁnite integrals on the interval (0,1) so that, of
the two indeﬁnite integrals F and G, one is uniformly continuous and the other is not.
Answer
Exercise 185 Prove this part of Theorem 2.2: If a function f is bounded and possesses an indeﬁnite integral F on (a,b)
then F is Lipschitz on (a,b). Deduce that F is uniformly continuous on (a,b).
Answer
2.1.3
The notation
R f(x)dx
Since we cannot avoid its use in elementary calculus classes, we deﬁne the symbol
Z
f(x)dx
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

2.1. AN INDEFINITE INTEGRAL ON AN INTERVAL
47
to mean the collection of all possible functions that are indeﬁnite integrals of f on an appropriately speciﬁed interval.
Because of Exercise 183 we know that we can always write this as
Z
f(x)dx+F(x)+C
where F is any one indeﬁnite integral and C is an arbitrary constant called the constant of integration. In more advanced
mathematical discussions this notation seldom appears, although there are frequent discussions of indeﬁnite integrals
(meaning a function whose derivative is the function being integrated).
Exercise 186 Why exactly is this statement incorrect:
Z
x2 dx = x3/3+1?
Answer
Exercise 187 Check the identities
d
dx(x+1)2 = 2(x+1)
and
d
dx(x2 +2x) = 2x+2 = 2(x+1).
Thus, on (−∞,∞),
Z
(2x+2)dx = (x+1)2 +C
and
Z
(2x+2)dx = (x2 +2x)+C.
Does it follow that (x+1)2 = (x2 +2x)?
Answer
Exercise 188 Suppose that we drop continuity from the requirement of an indeﬁnite integral and allow only one point
at which the derivative may fail (instead of a ﬁnite set of points). Illustrate the situation by ﬁnding all possible indeﬁnite
integrals [in this new sense] of f(x) = x2 on (0,1).
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

48
CHAPTER 2. THE INDEFINITE INTEGRAL
Exercise 189 Show that the function f(x) = 1/x has an indeﬁnite integral on any open interval that does not include
zero and does not have an indeﬁnite integral on any open interval containing zero. Is the difﬁculty here because f(0) is
undeﬁned?
Answer
Exercise 190 Show that the function
f(x) =
1
p
|x|
has an indeﬁnite integral on any open interval, even if that interval does include zero. Is there any difﬁculty that arises
here because f(0) is undeﬁned?
Answer
Exercise 191 Which is correct
Z 1
x dx = logx+C or
Z 1
x dx = log(−x)+C or
Z 1
x dx = log|x|+C?
Answer
2.2
Existence of indeﬁnite integrals
We cannot be sure in advance that any particular function f has an indeﬁnite integral on a given interval, unless we
happen to ﬁnd one. We turn now to the problem of ﬁnding sufﬁcient conditions under which we can be assured that
one exists. This is a rather subtle point. Many beginning students might feel that we are seeking to ensure ourselves
that an indeﬁnite integral can be found. We are, instead, seeking for assurances that an indeﬁnite integral does indeed
exist. We might still remain completely unable to write down some formula for that indeﬁnite integral because there is
no “formula” possible.
We shall show now that, with appropriate continuity assumptions on f, we can be assured that an indeﬁnite integral
exists without any requirement that we should ﬁnd it. Our methods will show that we can also describe a procedure that
would, in theory, produce the indeﬁnite integral as the limit of a sequence of simpler functions. This procedure would
work only for functions that are mostly continuous. We will still have a theory for indeﬁnite integrals of discontinuous
functions but we will have to be content with the fact that much of the theory is formal, and describes objects which are
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

2.2. EXISTENCE OF INDEFINITE INTEGRALS
49
not necessarily constructible2.
2.2.1
Upper functions
We will illustrate our method by introducing the notion of an upper function. This is a piecewise linear function whose
slopes dominate the function.
Let f be deﬁned and bounded on an open interval (a,b) and let us choose points
a = x0 < x1 < x2 < x3 < ··· < xn−1 < xn = b.
Suppose that F is a uniformly continuous function on [a,b] that is linear on each interval [xi−1,xi] and such that
F(xi)−F(xi−1)
xi −xi−1
≥f(ξ)
for all xi−1 ≤ξ ≤xi (i = 1,2,...,n). Then we can call F an upper function for f on [a,b].
The method of upper functions is to approximate the indeﬁnite integral that we require by suitable upper functions.
Upper functions are piecewise linear functions with the break points (where the corners are) at x1, x2, .. . , xn−1. The
slopes of these line segments exceed the values of the function f in the corresponding intervals. See Figure 2.1 for an
illustration of such a function.
Exercise 192 Let f(x) = x2 be deﬁned on the interval [0,1]. Deﬁne an upper function for f using the points
0, 1
4, 1
2, 3
4,1.
Answer
Exercise 193 (step functions) Let a function f be deﬁned by requiring that, for any integer n (positive, negative, or
zero), f(x) = n if n −1 < x < n. (Values at the integers can be omitted or assigned arbitrary values.) This is a simple
example of a step function. Find a formula for an indeﬁnite integral and show that this is an upper function for f.
Answer
2Note to the instructor: Just how unconstructible are indeﬁnite integrals in general? See Chris Freiling, How to compute antiderivatives, Bull.
Symbolic Logic 1 (1995), no. 3, 279–316. This is by no means an elementary question.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

50
CHAPTER 2. THE INDEFINITE INTEGRAL
Figure 2.1: A piecewise linear function.
2.2.2
The main existence theorem
For bounded, continuous functions we can always determine an indeﬁnite integral by a limiting process using appropriate
upper functions. The theorem is a technical computation that justiﬁes this statement.
Theorem 2.3 Suppose that f : (a,b) →R is a bounded function on an open in-
terval (a,b) [bounded or unbounded].
Then there exists a Lipschitz function
F : (a,b) →R so that F′(x) = f(x) for every point a < x < b at which f is contin-
uous.
Corollary 2.4 Suppose that f : (a,b) →R is a bounded function on an open in-
terval (a,b) [bounded or unbounded] and that there are only a ﬁnite number of
discontinuity points of f in (a,b). Then f has an indeﬁnite integral on (a,b),
which must be Lipschitz on (a,b).
Our theorem applies only to bounded functions, but we remember that if f is continuous on (a,b) then it is uniformly
continuous, and hence bounded, on any subinterval [c,d] ⊂(a,b). This allows the following corollary. Note that we will
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

2.3. BASIC PROPERTIES OF INDEFINITE INTEGRALS
51
not necessarily get an indeﬁnite integral that is Lipschitz on all of (a,b).
Corollary 2.5 Suppose that f : (a,b) →R is a function on an open interval (a,b)
[bounded or unbounded] and that there are no discontinuity points of f in (a,b).
Then f has an indeﬁnite integral on (a,b).
Exercise 194 Use the method of upper functions to prove Theorem 2.3. It will be enough to assume that f : (0,1) →R
and that f is nonnegative and bounded. (Exercises 195 and 196 ask for the justiﬁcations for this assumption.)
Answer
Exercise 195 Suppose that f : (a,b) →R and set g(t) = f(a+t(b−a)) for all 0 ≤t ≤1. If G is an indeﬁnite integral
for g on (0,1) show how to ﬁnd an indeﬁnite integral for f on (a,b).
Answer
Exercise 196 Suppose that f : (a,b) →R is a bounded function and that
K = inf{ f(x) : a < x < b}.
Set g(t) = f(t)−K for all a < t < b. Show that g is nonnegative and bounded. Suppose that G is an indeﬁnite integral
for g on (a,b); show how to ﬁnd an indeﬁnite integral for f on (a,b).
Answer
Exercise 197 Show how to deduce Corollary 2.5 from the theorem.
Answer
2.3
Basic properties of indeﬁnite integrals
We conclude our chapter on the indeﬁnite integral by discussing some typical calculus topics. We have developed a
precise theory of indeﬁnite integrals and we are beginning to understand the nature of the concept.
There are a number of techniques that have traditionally been taught in calculus courses for the purpose of evaluating
or manipulating integrals. Many courses you will take (e.g., physics, applied mathematics, differential equations) will
assume that you have mastered these techniques and have little difﬁculty in applying them.
The reason that you are asked to study these techniques is that they are required for working with integrals or
developing theory, not merely for computations. If a course in calculus seems to be overly devoted to evaluating indeﬁnite
integrals it is only that you are being drilled in the methods. The skill in ﬁnding an exact expression for an indeﬁnite
integral is of little use: it won’t help in all cases anyway. Besides, any integral that can be handled by these methods can
be handled in seconds in Maple or Mathematica (see Section 2.3.5).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

52
CHAPTER 2. THE INDEFINITE INTEGRAL
2.3.1
Linear combinations
There is a familiar formula for the derivative of a linear combination:
d
dx {rF(x)+sG(x)} = rF′(x)+sG′(x).
This immediately provides a corresponding formula for the indeﬁnite integral of a linear combination:
Z
(r f(x)+sg(x))dx = r
Z
f(x)dx+s
Z
g(x)dx
As usual with statements about indeﬁnite integrals this is only accurate if some mention of an open interval is made.
To interpret this formula correctly, let us make it very precise. We assume that both f and g have indeﬁnite integrals F
and G on the same interval I. Then the formula claims, merely, that the function H(x) = rF(x)+sG(x) is an indeﬁnite
integral of the function h(x) = r f(x)+sg(x) on that interval I.
Exercise 198 (linear combinations) Prove this formula by showing that H(x) = rF(x)+sG(x) is an indeﬁnite integral
of the function h(x) = r f(x)+sg(x) on any interval I, assuming that both f and g have indeﬁnite integrals F and G on
I.
Answer
2.3.2
Integration by parts
There is a familiar formula for the derivative of a product:
d
dx {F(x)G(x)} = F′(x)G(x)+F(x)G′(x).
This immediately provides a corresponding formula for the indeﬁnite integral of a product:
Z
F(x)G′(x)dx = F(x)G(x)−
Z
F′(x)G(x)dx.
Again we remember that statements about indeﬁnite integrals are only accurate if some mention of an open interval
is made. To interpret this formula correctly, let us make it very precise. We assume that F′G has an indeﬁnite integral
H on an open interval I. Then the formula claims, merely, that the function K(x) = F(x)G(x) −H(x) is an indeﬁnite
integral of the function F(x)G′(x) on that interval I.
Exercise 199 (integration by parts) Explain and verify the formula.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

2.3. BASIC PROPERTIES OF INDEFINITE INTEGRALS
53
Exercise 200 (calculus student notation) If u = f(x), v = g(x), and we denote du = f ′(x)dx and dv = g′(x)dx then in
its simplest form the product rule is often described as
Z
udv = uv−
Z
vdu.
Explain how this version is used.
Answer
Exercise 201 (extra practise) If you need extra practise on integration by parts as a calculus technique here is a stan-
dard collection of examples all cooked in advance so that an integration by parts technique will successfully determine
an exact formula for the integral. This is not the case except for very selected examples.
[The interval on which the integration is performed is not speciﬁed but it should be obvious which points, if any, to
avoid.]
Z
xex dx ,
Z
xsinxdx ,
Z
xlnxdx ,
Z
xcos3xdx ,
Z lnx
x5 dx ,
Z
arcsin3xdx ,
Z
lnxdx ,
Z
2xarctanxdx ,
Z
x2e3x dx ,
Z
x3 ln5xdx ,
Z
(lnx)2 dx ,
Z
x
√
x+3dx ,
Z
xsinxcosxdx ,
Z ³lnx
x
´2
dx ,
Z
x5ex3 dx ,
Z
x3 cos(x2)dx ,
Z
x7p
5+3x4 dx ,
Z
x3
(x2 +5)2 dx ,
Z
e6x sin(e3x)dx ,
Z
x3ex2
(x2 +1)2 dx ,
Z
ex cosxdx and
Z
sin3xcos5xdx.
Answer
2.3.3
Change of variable
The chain rule for the derivative of a composition of functions is the formula:
d
dxF(G(x)) = F′(G(x))G′(x).
This immediately provides a corresponding formula for the indeﬁnite integral of a product:
Z
F′(G(x))G′(x)dx =
Z
F′(u)du = F(u)+C = F(G(x))+C
[u = G(x)]
where we have used the familiar device u = G(x), du = G′(x)dx to make the formula more transparent.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

54
CHAPTER 2. THE INDEFINITE INTEGRAL
This is called the change of variable rule, although it is usually called integration by substitution is most calculus
presentations.
Again we remember that statements about indeﬁnite integrals are only accurate if some mention of an open interval
is made. To interpret this formula correctly, let us make it very precise. We assume that F is a differentiable function
on an open interval I. We assume too that G′ has an indeﬁnite integral G on an interval J and assumes all of its values
in the interval I. Then the formula claims, merely, that the function F(G(x)) is an indeﬁnite integral of the function
F′(G(x))G′(x) on that interval J [not on the interval I please].
Exercise 202 In the argument for the change of variable rule we did not address the possibility that F might have ﬁnitely
many points of nondifferentiability. Discuss.
Answer
Exercise 203 Verify that this argument is correct:
Z
xcos(x2 +1)dx = 1
2
Z
2xcos(x2 +1)dx = 1
2
Z
cosudu = 1
2 sinu+C = 1
2 sin(x2 +1)+C.
Answer
Exercise 204 Here is a completely typical calculus exercise (or exam question). You are asked to determine an explicit
formula for
R xex2 dx. What is expected and how do you proceed?
Answer
Exercise 205 Given that
R f(t)dt = F(t)+C determine
R f(rx+s)dx for any real numbers r and s.
Answer
2.3.4
What is the derivative of the indeﬁnite integral?
What is
d
dx
Z
f(x)dx?
By deﬁnition this indeﬁnite integral is the family of all functions whose derivative is f(x) [on some pre-speciﬁed
open interval] but with a possibly ﬁnite set of exceptions. So the answer trivially is that
d
dx
Z
f(x)dx = f(x)
at most points inside the interval of integration. (But not necessarily at all points.)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

2.3. BASIC PROPERTIES OF INDEFINITE INTEGRALS
55
The following theorem will do in many situations, but it does not fully answer our question. There are exact deriva-
tives that have very large sets of points at which they are discontinuous.
Theorem 2.6 Suppose that f : (a,b) →R has an indeﬁnite integral F on the in-
terval (a,b). Then F′(x) = f(x) at every point in (a,b) at which f is continuous.
Exercise 206 Prove the theorem.
Answer
2.3.5
Partial fractions
Many calculus texts will teach, as an integration tool, the method of partial fractions. It is, actually, an important algebraic
technique with applicability in numerous situations, not merely in certain integration problems. It is best to learn this
in detail outside of a calculus presentation since it invariably consumes a great deal of student time as the algebraic
techniques are tedious at best and, often, reveal a weakness in the background preparation of many of the students.
It will sufﬁce for us to recount the method that will permit the explicit integration of
Z
x+3
x2 −3x−40 dx.
The following passage is a direct quotation from the Wikipedia site entry for partial fractions.
“Suppose it is desired to decompose the rational function
x+3
x2 −3x−40
into partial fractions. The denominator factors as
(x−8)(x+5)
and so we seek scalars A and B such that
x+3
x2 −3x−40 =
x+3
(x−8)(x+5) =
A
x−8 +
B
x+5.
One way of ﬁnding A and B begins by "clearing fractions", i.e., multiplying both sides by the common denominator
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

56
CHAPTER 2. THE INDEFINITE INTEGRAL
(x−8)(x+5). This yields
x+3 = A(x+5)+B(x−8).
Collecting like terms gives
x+3 = (A+B)x+(5A−8B).
Equating coefﬁcients of like terms then yields:
A
+
B
=
1
5A
−
8B
=
3
The solution is A = 11/13, B = 2/13. Thus we have the partial fraction decomposition
x+3
x2 −3x−40 = 11/13
x−8 + 2/13
x+5 =
11
13(x−8) +
2
13(x+5).
Alternatively, take the original equation
x+3
(x−8)(x+5) =
A
x−8 +
B
x+5.
multiply by (x−8) to get
x+3
x+5 = A+ B(x−8)
x+5
.
Evaluate at x = 8 to solve for A as
11
13 = A.
Multiply the original equation by (x+5) to get
x+3
x−8 = A(x+5)
x−8
+B.
Evaluate at x = −5 to solve for B as
−2
−13 = 2
13 = B.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

2.3. BASIC PROPERTIES OF INDEFINITE INTEGRALS
57
As a result of this algebraic identity we can quickly determine that
Z
x+3
x2 −3x−40 dx = [11/13]log(x−8)+[2/13]log(x+5)+C.
This example is typical and entirely representative of the easier examples that would be expected in a calculus course.
The method is, however, much more extensive than this simple computation would suggest. But it is not part of integra-
tion theory even if your instructor chooses to drill on it.
Partial fraction method in Maple
Computer algebra packages can easily perform indeﬁnite integration using the partial fraction method without a need
for the student to master all the details. Here is a short Maple session illustrating that all the partial fraction details given
above are handled easily without resorting to hand calculation. That is not to say that the student should entirely avoid
the method itself since it has many theoretical applications beyond its use here.
[32]dogwood% maple
|\^/|
Maple 12 (SUN SPARC SOLARIS)
._|\|
|/|_. Copyright (c) Maplesoft, a division of Waterloo Maple Inc. 2008
\
MAPLE
/
All rights reserved. Maple is a trademark of
<____ ____>
Waterloo Maple Inc.
> int( (x+3) /
( x^2-3*x-40), x);
11
2/13 ln(x + 5) + -- ln(x - 8)
13
# No constant of integration appears in the result for indefinite integrals.
Exercise 207 In determining that
Z
x+3
x2 −3x−40 dx = [11/13]log(x−8)+[2/13]log(x+5)+C
we did not mention an open interval in which this would be valid. Discuss.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

58
CHAPTER 2. THE INDEFINITE INTEGRAL
2.3.6
Tables of integrals
Prior to the availability of computer software packages like Maple3, serious users of the calculus often required access
to tables of integrals. If an indeﬁnite integral did have an expression in terms of some formula then it could be found in
the tables [if they were extensive enough] or else some transformations using our techniques above (integration by parts,
change of variable, etc.) could be applied to ﬁnd an equivalent integral that did appear in the tables.
Most calculus books (not this one) still have small tables of integrals. Much more efﬁcient, nowadays, is simply to
rely on a computer application such as Maple or Mathematica to search for an explicit formula for an indeﬁnite integral.
These packages will even tell you if no explicit formula exists.
It is probably a waste of lecture time to teach for long any method that uses tables and it is a waste of paper to write
about them. The interested reader should just Google “tables of integrals” to see what can be done. It has the same
historical interest that logarithms as devices for computation have. Store your old tables of integrals in the same drawer
with your grandparent’s slide rules.
3See especially Section 3.10.1.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

Chapter 3
The Deﬁnite Integral
We have deﬁned already the notion of an indeﬁnite integral
Z
F′(x)dx = F(x)+C.
The deﬁnite integral
Z b
a F′(x)dx = F(b)−F(a)
is deﬁned as a special case of that and the connection between the two concepts is immediate. In other calculus courses
one might be introduced to a different (also very limited) version of the integral introduced in the middle of the 19th
century by Riemann. Then the connection with the indeﬁnite integral is established by means of a deep theorem known
as the fundamental theorem of the calculus. Here we run this program backwards. We take the simpler approach of
starting with the fundamental theorem as a deﬁnition and then recover the Riemann integration methods later.
There are numerous advantages in this. We can immediately start doing some very interesting integration theory and
computing integrals. Since we have already learned indeﬁnite integration we have an immediate grasp of the new theory.
We are not conﬁned to the limited Riemann integral and we have no need to introduce the improper integral. We can
make, eventually, a seamless transition to the Lebesgue integral and beyond.
This calculus integral (also known as “Newton’s integral”) is a limited version of the full integration theory on the
real line. It is intended as a teaching method for introducing integration theory. Later, in Chapter 4, we will present an
59
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

60
CHAPTER 3. THE DEFINITE INTEGRAL
introduction to the full modern version of integration theory on the real line.
3.1
Deﬁnition of the calculus integral
The deﬁnite integral is deﬁned directly by means of the indeﬁnite integral and uses a similar notation.
Deﬁnition 3.1 Let f be a function deﬁned at every point of a closed, bounded
interval [a,b] with possibly ﬁnitely many exceptions. Then f is said to be integrable
[calculus sense] if there exists a uniformly continuous function F : [a,b] →R that
is an indeﬁnite integral for f on the open interval (a,b). In that case the number
Z b
a f(x)dx = F(b)−F(a),
is called the deﬁnite integral of f on [a,b].
To make this perfectly clear let us recall what this statement would mean. We require:
1. f is deﬁned on [a,b] except possibly at points of a ﬁnite set. [In particular f(a) and f(b) need not be deﬁned.]
2. There is a uniformly continuous function F on [a,b],
3. F′(x) = f(x) at every point a < x < b except possibly at points of a ﬁnite set.
4. We compute F(b)−F(a) and call this number the deﬁnite integral of f on [a,b].
Thus our integration is essentially the study of uniformly continuous functions F : [a,b] →R for which there is only
a ﬁnite number of points of nondifferentiability. For these functions we use the notation
Z b
a F′(x)dx = F(b)−F(a).
(3.1)
The integration theory is, consequently, all about derivatives, just as was the indeﬁnite integration theory. The state-
ment (3.1) is here a deﬁnition not, as it would be in many other textbooks, a theorem.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.1. DEFINITION OF THE CALCULUS INTEGRAL
61
3.1.1
Alternative deﬁnition of the integral
In many applications it is more convenient to work with a deﬁnition that expresses everything within the corresponding
open interval (a,b).
Deﬁnition 3.2 Let f be a function deﬁned at every point of a bounded, open in-
terval (a,b) with possibly ﬁnitely many exceptions. Then f is said to be integrable
[calculus sense] on the closed interval [a,b] if there exists a uniformly continuous
indeﬁnite integral F for f on (a,b). In that case the number
Z b
a f(x)dx = F(b−)−F(a+),
is called the deﬁnite integral of f on [a,b].
This statement would mean.
1. f is deﬁned at least on (a,b) except possibly at points of a ﬁnite set.
2. There is a uniformly continuous function F on (a,b), with F′(x) = f(x) at every point a < x < b except possibly
at points of a ﬁnite set.
3. Because F is uniformly continuous on (a,b), the two one-sided limits
lim
x→a+F(x) = F(a+) and
lim
x→b−F(x) = F(b−)
will exist.
4. The number F(b−)−F(a+) is the deﬁnite integral of f on [a,b].
Exercise 208 To be sure that a function f is integrable on a closed, bounded interval [a,b] you need to ﬁnd an indeﬁnite
integral F on (a,b) and then check one of the following:
1. F is uniformly continuous on (a,b), or
2. F is uniformly continuous on [a,b], or
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

62
CHAPTER 3. THE DEFINITE INTEGRAL
3. F is continuous on (a,b) and the one-sided limits,
lim
x→a+F(x) = F(a+) and
lim
x→b−F(x) = F(b−)
exist.
Show that these are equivalent.
Answer
3.1.2
Inﬁnite integrals
Exactly the same deﬁnition for the inﬁnite integrals
Z ∞
−∞f(x)dx,
Z ∞
a
f(x)dx, and
Z b
−∞f(x)dx
can be given as for the integral over a closed bounded interval.
Deﬁnition 3.3 Let f be a function deﬁned at every point of (∞,∞) with possibly
ﬁnitely many exceptions. Then f is said to be integrable in the calculus sense on
(∞,∞) if there exists an indeﬁnite integral F : (∞,∞) →R for f for which both
limits
F(∞) = lim
x→∞F(x) and F(−∞) = lim
x→−∞F(x)
exist. In that case the number
Z ∞
−∞f(x)dx = F(∞)−F(−∞),
is called the deﬁnite integral of f on (∞,∞) .
This statement would mean.
1. f is deﬁned at all real numbers except possibly at points of a ﬁnite set.
2. There is a continuous function F on (∞,∞), with F′(x) = f(x) at every point except possibly at points of a ﬁnite
set.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.1. DEFINITION OF THE CALCULUS INTEGRAL
63
3. The two inﬁnite limits
F(∞) = lim
x→∞F(x) and F(−∞) = lim
x→−∞F(x)
exist. This must be checked. For this either compute the limits or else use Exercise 63: for all ε > 0 there should
exist a positive number T so that
ωF((T,∞)) < ε and ωF((−∞,T)) < ε.
4. The number F(∞)−F(−∞) is the deﬁnite integral of f on [a,b].
Similar assertions deﬁne
Z b
−∞f(x)dx = F(b)−F(−∞)
and
Z ∞
a
f(x)dx = F(∞)−F(a).
In analogy with the terminology of an inﬁnite series ∑∞
k=1 ak we often say that the integral
R ∞
a f(x)dx converges when
the integral exists. That suggests language asserting that the integral converges absolutely if both integrals
Z ∞
a
f(x)dx and
Z ∞
a | f(x)|dx
exist.
3.1.3
Simple properties of integrals
As preliminaries let us state three theorems for this integral that can be proved very quickly just by translating into
statements about derivatives. We state these three simple theorems for integrals on bounded intervals but the same
methods handle inﬁnite integrals.
Theorem 3.4 (integrability on subintervals) If f is integrable on a closed,
bounded interval [a,b] then f is integrable on any subinterval [c,d] ⊂[a,b].
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

64
CHAPTER 3. THE DEFINITE INTEGRAL
Theorem 3.5 (additivity of the integral) If f is integrable on the closed, bounded
intervals [a,b] and [b,c] then f is integrable on the interval [a,c] and, moreover,
Z b
a f(x)dx+
Z c
b f(x)dx =
Z c
a f(x)dx.
Theorem 3.6 (integral inequalities) Suppose that the two functions f, g are both
integrable on a closed, bounded interval [a,b] and that f(x) ≤g(x) for all x ∈[a,b]
with possibly ﬁnitely many exceptions. Then
Z b
a f(x)dx ≤
Z b
a g(x)dx.
Exercise 209 Prove Theorem 3.4 both for integrals on [a,b] or (−∞,∞).
Answer
Exercise 210 Prove Theorem 3.5 both for integrals on [a,b] or (−∞,∞).
Answer
Exercise 211 Prove Theorem 3.6 both for integrals on [a,b] or (−∞,∞).
Answer
Exercise 212 Show that the function f(x) = x2 is integrable on [−1,2] and compute its deﬁnite integral there.
Answer
Exercise 213 Show that the function f(x) = x−1 is not integrable on [−1,0], [0,1], nor on any closed bounded interval
that contains the point x = 0. Did the fact that f(0) is undeﬁned inﬂuence your argument? Is this function integrable on
(∞,−1] or on [1,∞)?
Answer
Exercise 214 Show that the function f(x) = x−1/2 is integrable on [0,2] and compute its deﬁnite integral there. Did the
fact that f(0) is undeﬁned interfere with your argument? Is this function integrable on [0,∞)?
Answer
Exercise 215 Show that the function f(x) = 1/
p
|x| is integrable on any interval [a,b] and determine the value of the
integral.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.1. DEFINITION OF THE CALCULUS INTEGRAL
65
Exercise 216 (why the ﬁnite exceptional set?) In the deﬁnition of the calculus integral we permit a ﬁnite exceptional
set. Why not just skip the exceptional set and just split the interval into pieces?
Answer
Exercise 217 (limitations of the calculus integral) Deﬁne a function F : [0,1] →R in such a way that F(0) = 0, and
for each odd integer n = 1,3,5..., F(1/n) = 1/n and each even integer n = 2,4,6..., F(1/n) = 0. On the intervals
[1/(n+1),1/n] for n = 1,2,3, the function is linear. Show that
R b
a F′(x)dx exists as a calculus integral for all 0 < a <
b ≤1 but that
R 1
0 F′(x)dx does not.
Hint: too many exceptional points.
Answer
Exercise 218 Show that each of the following functions is not integrable on the interval stated:
1. f(x) = 1 for all x irrational and f(x) = 0 if x is rational, on any interval [a,b].
2. f(x) = 1 for all x irrational and f(x) is undeﬁned if x is rational, on any interval [a,b].
3. f(x) = 1 for all x ̸= 1,1/2,1/3,1/4,... and f(1/n) = cn for some sequence of positive numbers c1, c2, c3, . . . , on
the interval [0,1].
Answer
Exercise 219 Determine all values of p for which the integrals
Z 1
0 xp dx or
Z ∞
1 xp dx
exist.
Answer
Exercise 220 Are the following additivity formulas for inﬁnite integrals valid:
1.
Z ∞
−∞f(x)dx =
Z a
−∞f(x)dx+
Z b
a f(x)dx+
Z ∞
b
f(x)dx?
2.
Z ∞
0
f(x)dx =
∞
∑
n=1
Z n
n−1 f(x)dx?
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

66
CHAPTER 3. THE DEFINITE INTEGRAL
3.
Z ∞
−∞f(x)dx =
∞
∑
n=−∞
Z n
n−1 f(x)dx?
Answer
3.1.4
Integrability of bounded functions
What bounded functions are integrable on an interval [a,b]? According to the deﬁnition we need to ﬁnd an indeﬁnite
integral on (a,b) and then determine whether it is uniformly continuous. If there is an indeﬁnite integral we know from
the mean-value theorem that it would have to be Lipschitz and so must be uniformly continuous. Thus integrability of
bounded functions on bounded intervals reduces simply to ensuring that there is an indeﬁnite integral.
Theorem 3.7 If f : (a,b) →R is a bounded function that is continuous at all but
ﬁnitely many points of an open bounded interval (a,b) then f is integrable on [a,b].
Corollary 3.8 If f : [a,b] →R is a uniformly continuous function then f is inte-
grable on [a,b].
Exercise 221 Show that all step functions are integrable.
Answer
Exercise 222 Show that all differentiable functions are integrable.
Answer
Exercise 223 Show that the Heaviside function is integrable on any interval and show how to compute that integral.
Exercise 224 If f : (a,b) →R is a function that is continuous at all points of (a,b) then f is integrable on every closed,
bounded subinterval [c,d] ⊂(a,b). Show that f is integrable on [a,b] if and only if the one-sided limits
lim
t→a+
Z c
t
f(x)dx and
lim
t→b−
Z t
c f(x)dx
exist for any a < c < b. Moreover, in that case
Z b
a f(x)dx = lim
t→a+
Z c
t
f(x)dx+ lim
t→b−
Z t
c f(x)dx.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.1. DEFINITION OF THE CALCULUS INTEGRAL
67
3.1.5
Integrability for the unbounded case
What unbounded functions are integrable on an interval [a,b]? What functions are integrable on an unbounded interval
(−∞,∞)? Once again we need to ﬁnd an indeﬁnite integral on (a,b). The indeﬁnite integral will be continuous but we
need to check further details to be sure the deﬁnite integral exists. In both cases attention shifts to the endpoints, F(a+)
and F(b−) in the case of the integral on [a,b], and F(−∞) and F(∞) in the case of the integral on (−∞,∞).
The following simple theorems are sometimes called comparison tests for integrals.
Theorem 3.9 (comparison test I) Suppose that f, g : (a,b) →R are functions on
(a,b), both of which have an indeﬁnite integral on (a,b). Suppose that | f(x)| ≤
g(x) for all a < x < b. If g is integrable on [a,b] then so too is f.
Theorem 3.10 (comparison test II) Suppose that f, g : (a,∞) →R are functions
on (a,∞), both of which have an indeﬁnite integral on (a,∞). Suppose that | f(x)| ≤
g(x) for all a < x. If g is integrable on [a,∞) then so too is f.
We recall that we know already:
If f : (a,b) →R is an unbounded function that is continuous at all points of (a,b) then f has an indeﬁnite
integral on (a,b). That indeﬁnite integral may or may not be uniformly continuous.
That provides two quick corollaries of our theorems.
Corollary 3.11 Suppose that f is an unbounded function on (a,b) that is contin-
uous at all but a ﬁnite number of points, and suppose that g : (a,b) →R with
| f(x)| ≤g(x) for all a < x < b. If g is integrable on [a,b] then so too is f.
Corollary 3.12 Suppose that f is function on (a,∞) that is continuous at all but a
ﬁnite number of points, and suppose that g : (a,∞) →R with | f(x)| ≤g(x) for all
a < x. If g is integrable on [a,∞) then so too is f.
Exercise 225 Prove the two comparison tests [Theorems 3.9 and 3.10].
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

68
CHAPTER 3. THE DEFINITE INTEGRAL
Exercise 226 Prove Corollary 3.11.
Answer
Exercise 227 Prove Corollary 3.12.
Answer
Exercise 228 Which, if any, of these integrals exist:
Z π/2
0
r
sinx
x
dx,
Z π/2
0
r
sinx
x2 dx,
and
Z π/2
0
r
sinx
x3 dx?
Answer
Exercise 229 Apply the comparison test to each of these integrals:
Z ∞
1
sinx
√x dx,
Z ∞
1
sinx
x
dx,
and
Z ∞
1
sinx
x2 dx.
Answer
Exercise 230 (nonnegative functions) Show that a nonnegative function f : (a,b) →R is integrable on [a,b] if and
only if it has a bounded indeﬁnite integral on (a,b).
Answer
Exercise 231 Give an example of a function f : (a,b) →R that is not integrable on [a,b] and yet it does have a bounded
indeﬁnite integral on (a,b).
Answer
Exercise 232 Discuss the existence of the deﬁnite integral
Z b
a
p(x)dx
q(x)
where p(x) and q(x) are both polynomials.
Answer
Exercise 233 Discuss the existence of the integral
Z ∞
a
p(x)
q(x) dx
where p(x) and q(x) are polynomials.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.1. DEFINITION OF THE CALCULUS INTEGRAL
69
Exercise 234 (the integral test) Let f be a continuous, nonnegative, decreasing function on [1,∞). Show that the inte-
gral
R ∞
1 f(x)dx exists if and only if the series ∑∞
n=1 f(n) converges.
Answer
Exercise 235 Give an example of a function f that is continuous and nonnegative on [1,∞) so that the integral
R ∞
1 f(x)dx
exists but the series ∑∞
n=1 f(n) diverges.
Answer
Exercise 236 Give an example of a function f that is continuous and nonnegative on [1,∞) so that the integral
R ∞
1 f(x)dx
does not exist but the series ∑∞
n=1 f(n) converges.
Answer
3.1.6
Products of integrable functions
When is the product of a pair of integrable functions integrable? When both functions are bounded and deﬁned on a
closed, bounded interval we shall likely be successful. When both functions are unbounded, or the interval is unbounded
simple examples exist to show that products of integrable functions need not be integrable.
Exercise 237 Suppose we are given a pair of functions f and g such that each is uniformly continuous on [a,b]. Show
that each of f, g and the product fg is integrable on [a,b].
Answer
Exercise 238 Suppose we are given a pair of functions f and g such that each is bounded and has at most a ﬁnite
number of discontinuities in (a,b). Show that each of f, g and the product fg is integrable on [a,b].
Answer
Exercise 239 Find a pair of functions f and g, integrable on [0,1] and continuous on (0,1) but such that the product fg
is not.
Answer
Exercise 240 Find a pair of continuous functions f and g, integrable on [1,∞) but such that the product fg is not.
Answer
Exercise 241 Suppose that F, G : [a,b] →R are uniformly continuous functions that are differentiable at all but a ﬁnite
number of points in (a,b). Show that F′G is integrable on [a,b] if and only if FG′ is integrable on [a,b].
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

70
CHAPTER 3. THE DEFINITE INTEGRAL
3.1.7
Notation:
R a
a f(x)dx and
R a
b f(x)dx
The expressions
Z a
a f(x)dx and
Z a
b f(x)dx
for b > a do not yet make sense since integration is required to hold on a closed, bounded interval. But these notations
are extremely convenient.
Thus we will agree that
Z a
a f(x)dx = 0
and, if a < b and the integral
R b
a f(x)dx exists as a calculus integral, then we assign this meaning to the “backwards”
integral:
Z a
b f(x)dx = −
Z b
a f(x)dx.
Exercise 242 Suppose that the integral
R b
a f(x)dx exists as a calculus integral and that F is an indeﬁnite integral for f
on that interval. Does the formula
Z t
s f(x)dx = F(t)−F(s)
(s,t ∈[a,b])
work even if s = t or if s > t?
Answer
Exercise 243 Check that the formula
Z b
a f(x)dx+
Z c
b f(x)dx =
Z c
a f(x)dx
works for all real numbers a, b and c.
Answer
3.1.8
The dummy variable: what is the “x” in
R b
a f(x)dx?
If you examine the two statements
Z
x2 dx = x3/3+C and
Z 2
1 x2 dx = 23/3−13/3 = 7/3
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.1. DEFINITION OF THE CALCULUS INTEGRAL
71
you might notice an odd feature. The ﬁrst integral [the indeﬁnite integral] requires the symbol x to express the functions
on both sides. But in the second integral [the deﬁnite integral] the symbol x plays no role except to signify the function
being integrated. If we had given the function a name, say g(x) = x2 then the ﬁrst identity could be written
Z
g(x)dx = x3/3 or
Z
g(t)dt = t3/3+c
while the second one might be more simply written as
Z 2
1 g = 7/3.
In deﬁnite integrals the symbols x and dx are considered as dummy variables, useful for notational purposes and
helpful as aids to computation, but carrying no signiﬁcance. Thus you should feel free [and are encouraged] to use any
other letters you like to represent the dummy variable. But do not use a letter that serves some other purpose elsewhere
in your discussion.
Here are some bad and even terrible abuses of this:
. . . let x = 2 and let y =
R 2
1 x2 dx.
. . . Show that
R x
1 x2 dx = x3/3−1/3.
Exercise 244 Do you know of any other bad uses of dummy variables?
Answer
3.1.9
Deﬁnite vs. indeﬁnite integrals
The connection between the deﬁnite and indeﬁnite integrals is immediate; we have simply deﬁned one in terms of the
other.
If F is an indeﬁnite integral of an integrable function f on an interval (a,b) then
Z b
a f(x)dx = F(b−)−F(a+).
In the other direction if f is integrable on an interval [a,b] then, on the open interval (a,b), the indeﬁnite integral can be
expressed as
Z
f(x)dx =
Z x
a f(t)dt +C.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

72
CHAPTER 3. THE DEFINITE INTEGRAL
Both statements are tautologies; this is a matter of deﬁnition not of computation or argument.
Exercise 245 A student is asked to ﬁnd the indeﬁnite integral of e2x and he writes
Z
e2x dx =
Z x
0 e2t dt +C.
How would you grade?
Answer
Exercise 246 A student is asked to ﬁnd the indeﬁnite integral of ex2 and she writes
Z
ex2 dx =
Z x
0 et2 dt +C.
How would you grade?
Answer
3.1.10
The calculus student’s notation
The procedure that we have learned to compute a deﬁnite integral is actually just the deﬁnition. For example, if we wish
to evaluate
Z 6
−5 x2 dx
we ﬁrst determine that
Z
x2 dx = x3/3+C
on any interval. So that, using the function F(x) = x3/3 as an indeﬁnite integral,
Z 6
−5 x2 dx = F(6)−F(−5) = 63/3−(−5)3/3 = (63 +53)/3.
Calculus students often use a shortened notation for this computation:
Z 6
−5 x2 dx = x3
3
¸x=6
x=−5
= 63/3−(−5)3/3.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.2. MEAN-VALUE THEOREMS FOR INTEGRALS
73
Exercise 247 Would you accept this notation:
Z ∞
1
dx
√
x3 = −2
√x
¸x=∞
x=1
= 0−(−2)?
Answer
3.2
Mean-value theorems for integrals
In general the expression
1
b−a
Z b
a f(x)dx
is thought of as an averaging operation on the function f, determining its “average value” throughout the whole interval
[a,b]. The ﬁrst mean-value theorem for integrals says that the function actually attains this average value at some point
inside the interval, i.e., under appropriate hypotheses there is a point a < ξ < b at which
1
b−a
Z b
a f(x)dx = f(ξ).
But this is nothing new to us. Since the integral is deﬁned by using an indeﬁnite integral F for f this is just the observation
that
1
b−a
Z b
a f(x)dx = F(b)−F(a)
b−a
= f(ξ),
the very familiar mean-value theorem for derivatives.
Theorem 3.13 Let f : (a,b) →R be integrable on [a,b] and suppose that F is an
indeﬁnite integral. Suppose further that F′(x) = f(x) for all a < x < b with no
exceptional points. Then there must exist a point ξ ∈(a,b) so that
Z b
a f(x)dx = f(ξ)(b−a).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

74
CHAPTER 3. THE DEFINITE INTEGRAL
Corollary 3.14 Let f : (a,b) →R be integrable on [a,b] and suppose that f is
continuous at each point of (a,b). Then there must exist a point ξ ∈(a,b) so that
Z b
a f(x)dx = f(ξ)(b−a).
Exercise 248 Give an example of an integrable function for which the ﬁrst mean-value theorem for integrals fails.
Answer
Exercise 249 (another mean-value theorem) Suppose that G : [a,b] →R is a continuous function and ϕ : [a,b] →R
is an integrable, nonnegative function. If G(t)ϕ(t) is integrable, show that there exists a number ξ ∈(a,b) such that
Z b
a G(t)ϕ(t)dt = G(ξ)
Z b
a ϕ(t)dt.
Answer
Exercise 250 (and another) Suppose that G : [a,b] →R is a positive, monotonically decreasing function and ϕ : [a,b] →
R is an integrable function. Suppose that Gϕ is integrable. Then there exists a number ξ ∈(a,b] such that
Z b
a G(t)ϕ(t)dt = G(a+0)
Z ξ
a ϕ(t)dt.
Note: Here, as usual, G(a + 0) stands for limx→a+ G(x) , the existence of which follows from the monotonicity of the
function G. Note that ξ in the exercise might possibly be b.
Exercise 251 (. . . and another) Suppose that G : [a,b] →R is a monotonic (not necessarily decreasing and positive)
function and ϕ : [a,b] →R is an integrable function. Suppose that Gϕ is integrable. Then there exists a number ξ ∈(a,b)
such that
Z b
a G(t)ϕ(t)dt = G(a+0)
Z ξ
a ϕ(t)dt +G(b−0)
Z b
ξ ϕ(t)dt.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.3. RIEMANN SUMS
75
Exercise 252 (Dirichelet integral) As an application of mean-value theorems, show that the integral
Z ∞
0
sinx
x
dx
is convergent but is not absolutely convergent.
Answer
3.3
Riemann sums
If F : [a,b] →R is a uniformly continuous function that is differentiable at every point of the open interval (a,b) [i.e.,
every point with no exceptions] then we know that f = F′ is integrable and that the ﬁrst mean-value theorem can be
applied to express the integral in the form
Z b
a f(x)dx = F(b)−F(a) = f(ξ)(b−a)
for some ξ ∈(a,b).
Take any point a < x1 < b and do the same thing in both of the intervals [a,x1] and [x1,b]. Then
Z b
a f(x)dx = f(ξ1)(x1 −a)+ f(ξ2)(b−x1)
for some points ξ1 ∈(a,x1) and ξ2 ∈(x1,b).
In fact then we can do this for any number of points. Let
a = x0 < x1 < x2 < ··· < xn−1 < xn = b.
Then there must exist points ξi ∈(xi−1,xi) for i = 1,2,...,n so that
Z b
a f(x)dx =
n
∑
i=1
f(ξi)(xi −xi−1).
(3.2)
We express this observation in the language of partitions and Riemann sums.1
1These sums and the connection with integration theory do not originate with Riemann nor are they that late in the history of the subject.
Poisson in 1820 proposed such an investigation as “the fundamental proposition of the theory of deﬁnite integrals.” Euler by at least 1768 had
already used such sums to approximate integrals. Of course, for both of them the integral was understood in our sense as an antiderivative. See
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

76
CHAPTER 3. THE DEFINITE INTEGRAL
Deﬁnition 3.15 (Riemann sum) Suppose that
{([xi−1,xi],ξi) : i = 1,2,...,n}
is a partition of an interval [a,b] and that a function f is deﬁned at every point of
the interval [a,b]. Then any sum of the form
n
∑
i=1
f(ξi)(xi −xi−1).
is called a Riemann sum for the function f.
Using this language, we have just proved in the identity (3.2) that an integral in many situations can be computed
exactly by some Riemann sum. This seems both wonderful and, maybe, not so wonderful. In the ﬁrst place it means
that an integral
R b
a f(x)dx can be computed by a simple sum using the values of the function f rather than by using the
deﬁnition and having, instead, to solve a difﬁcult or impossible indeﬁnite integration problem. On the other hand this
only works if we can select the right points {ξi}.
3.3.1
Exact computation by Riemann sums
We have proved the following theorem that shows that, in some situations, the deﬁnite integral can be computed exactly
by a Riemann sum. The proof is obtained directly from the ﬁrst mean-value theorem for integrals, which itself is simply
the mean-value theorem for derivatives.
Judith V. Grabiner, Who gave you the epsilon? Cauchy and the origins of rigorous calculus, American Mathematical Monthly 90 (3), 1983,
185–194.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.3. RIEMANN SUMS
77
Theorem 3.16 Let f : (a,b) →R be integrable on [a,b] and suppose that F is an
indeﬁnite integral. Suppose further that F′(x) = f(x) for all a < x < b with the
possible exception of points in a ﬁnite set C ⊂(a,b). Choose any points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b
so that at least all points of C are included. Then there must exist points ξi ∈
(xi−1,xi) for i = 1,2,...,n so that
Z xi
xi−1
f(x)dx = f(ξi)(xi −xi−1) (i = 1,2,3,...,n)
and
Z b
a f(x)dx =
n
∑
i=1
f(ξi)(xi −xi−1).
Exercise 253 Show that the integral
R b
a xdx can be computed exactly by any Riemann sum
Z b
a xdx =
n
∑
i=1
xi +xi−1
2
(xi −xi−1) = 1
2
n
∑
i=1
(x2
i −x2
i−1).
Answer
Exercise 254 Subdivide the interval [0,1] at the points x0 = 0, x1 = 1/3, x2 = 2/3 and x3 = 1. Determine the points ξi
so that
Z 1
0 x2 dx =
3
∑
i=1
ξ2
i (xi −xi−1).
Exercise 255 Subdivide the interval [0,1] at the points x0 = 0, x1 = 1/3, x2 = 2/3 and x3 = 1. Determine the points
ξi ∈[xi−1,xi] so that
3
∑
i=1
ξ2
i (xi −xi−1).
is as large as possible. By how much does this sum exceed
R 1
0 x2 dx?
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

78
CHAPTER 3. THE DEFINITE INTEGRAL
Exercise 256 Subdivide the interval [0,1] at the points x0 = 0, x1 = 1/3, x2 = 2/3 and x3 = 1. Consider various choices
of the points ξi ∈[xi−1,xi] in the sum
3
∑
i=1
ξ2
i (xi −xi−1).
What are all the possible values of this sum? What is the relation between this set of values and the number
R 1
0 x2 dx?
Exercise 257 Subdivide the interval [0,1] by deﬁning the points x0 = 0, x1 = 1/n, x2 = 2/n, . . . xn−1 = (n −1)/n, and
xn = n/n = 1. Determine the points ξi ∈[xi−1,xi] so that
n
∑
i=1
ξ2
i (xi −xi−1).
is as large as possible. By how much does this sum exceed
R 1
0 x2 dx?
Exercise 258 Let 0 < r < 1. Subdivide the interval [0,1] by deﬁning the points x0 = 0, x1 = rn−1, x2 = rn−2, . . . ,
xn−1 = rn−(n−1) = r, and xn = rn−(−n) = 1. Determine the points ξi ∈[xi−1,xi] so that
n
∑
i=1
ξ2
i (xi −xi−1).
is as large as possible. By how much does this sum exceed
R 1
0 x2 dx?
Exercise 259 (error estimate) Let f : [a,b] →R be an integrable function. Suppose further that F′(x) = f(x) for all
a < x < b where F is an indeﬁnite integral. Suppose that
{([xi,xi−1],ξi) : i = 1,2,...n}
is an arbitrary partition of [a,b]. Show that
¯¯¯¯
Z xi
xi−1
f(x)dx−f(ξi)(xi −xi−1)
¯¯¯¯ ≤ω f([xi,xi−1])(xi −xi−1) (i = 1,2,3,...,n)
and that
¯¯¯¯¯
Z b
a f(x)dx−
n
∑
i=1
f(ξi)(xi −xi−1)
¯¯¯¯¯ ≤
n
∑
i=1
ω f([xi,xi−1])(xi −xi−1).
(3.3)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.3. RIEMANN SUMS
79
Note: that, if the right hand side of the inequality (3.3) is small then the Riemann sum, while not precisely equal to the
integral, would be a good estimate. Of course, the right hand side might also be big.
Answer
3.3.2
Uniform Approximation by Riemann sums
While Theorem 3.16 shows that all calculus integrals can be exactly computed by Riemann sums, it gives no procedure
for determining the correct partition. Suppose we relax our goal. Instead of asking for an exact computation perhaps an
approximate computation might be useful:
Z b
a f(x)dx ≈
n
∑
i=1
f(ξi)(xi −xi−1)?
By a uniform approximation we mean that we shall specify the smallness of the intervals [xi,xi−1] by a single small
number δ. In Section 3.3.4 we specify this smallness in a more general way, by requiring that the length of [xi,xi−1] be
smaller than δ(ξi). This is the pointwise version.
Theorem 3.17 Let f be a bounded function that is deﬁned and continuous at every
point of (a,b) with at most ﬁnitely many exceptions: Then, f is integrable on [a,b]
and moreover the integral may be uniformly approximated by Riemann sums: for
every ε > 0 there is a δ > 0 so that
n
∑
i=1
¯¯¯¯
Z xi
xi−1
f(x)dx−f(ξi)(xi −xi−1)
¯¯¯¯ < ε
and
¯¯¯¯¯
Z b
a f(x)dx−
n
∑
i=1
f(ξi)(xi −xi−1)
¯¯¯¯¯ < ε
whenever {([xi,xi−1],ξi) : i = 1,2,...n} is a partition of [a,b] with each
xi −xi−1 < δ
and ξi ∈[xi−1,xi] is a point where f is deﬁned.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

80
CHAPTER 3. THE DEFINITE INTEGRAL
Corollary 3.18 Let f : [a,b] →R be a uniformly continuous function. Then, f is
integrable on [a,b] and moreover the integral may be uniformly approximated by
Riemann sums.
Exercise 260 Prove Theorem 3.17 in the case when f is uniformly continuous on [a,b] by using the error estimate in
Exercise 259.
Answer
Exercise 261 Prove Theorem 3.17 in the case when f is continuous on (a,b).
Answer
Exercise 262 Complete the proof of Theorem 3.17.
Answer
Exercise 263 Let f : [a,b] →R be an integrable function on [a,b] and suppose, moreover, the integral may be uniformly
approximated by Riemann sums. Show that f would have to be bounded.
Answer
Exercise 264 Show that the integral
Z 1
0 x2 dx = lim
n→∞
12 +22 +32 +42 +52 +62 +···+n2
n3
.
Answer
Exercise 265 Show that the integral
Z 1
0 x2 dx = lim
r→1−
£
(1−r)+r(r −r2)+r2(r2 −r3)+r3(r3 −r4)+...
¤
.
Answer
Exercise 266 Show that the integral
R 1
0 x5 dx can be exactly computed by the method of Riemann sums provided one has
the formula
15 +25 +35 +45 +55 +65 ++···+N5 = N6
6 + N5
2 + 5N4
12 −N2
12 .
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.3. RIEMANN SUMS
81
3.3.3
Theorem of G. A. Bliss
Students of the calculus and physics are often required to “set up” integrals by which is meant interpreting a problem as
an integral. Basically this amounts to interpreting the problem as a limit of Riemann sums
Z b
a f(x)dx = lim
n
∑
i=1
f(ξi)(xi −xi−1).
In this way the student shows that the integral captures all the computations of the problem. In simple cases this is easy
enough, but complications can arise.
For example if f and g are two continuous functions, sometimes the correct set up would involve a sum of the form
lim
n
∑
i=1
f(ξi)g(ηi)(xi −xi−1)
and not the more convenient
lim
n
∑
i=1
f(ξi)g(ξi)(xi −xi−1).
Here, rather than a single point ξi associated with the interval [xi,xi−1], two different points ξi and ηi must be used.
Nineteenth century students had been taught a rather murky method for handling this case known as the Duhamel
principle; it involved an argument using inﬁnitesimals that, at bottom, was simply manipulations of Riemann sums.
Bliss2 felt that this should be clariﬁed and so produced an elementary theorem of which Theorem 3.19 is a special case.
It is just a minor adjustment to our Theorem 3.17.
2G. A. Bliss, A substitute for Duhamel’s theorem, Annals of Mathematics, Ser. 2, Vol. 16, (1914).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

82
CHAPTER 3. THE DEFINITE INTEGRAL
Theorem 3.19 (Bliss) Let f and g be bounded functions that are deﬁned and con-
tinuous at every point of (a,b) with at most ﬁnitely many exceptions: Then, fg is
integrable on [a,b] and moreover the integral may be uniformly approximated by
Riemann sums in this alternative sense: for every ε > 0 there is a δ > 0 so that
¯¯¯¯¯
Z b
a f(x)g(x)dx−
n
∑
i=1
f (ξi)g(ξ∗
i )(xi −xi−1)
¯¯¯¯¯ < ε
whenever {([xi,xi−1],ξi) : i = 1,2,...n} is a partition of [a,b] with each
xi −xi−1 < δ
and ξi, ξ∗
i ,∈[xi−1,xi] with both ξi and ξ∗
i points in (a,b) where fg is deﬁned.
Exercise 267 Prove the Bliss theorem.
Answer
Exercise 268 Prove this further variant of Theorem 3.17.
Theorem 3.20 (Bliss) Let f1, f2, . . . , fp bounded functions that are deﬁned and
continuous at every point of (a,b) with at most ﬁnitely many exceptions: Then,
the product f1 f2 f3 ... fp is integrable on [a,b] and moreover the integral may be
uniformly approximated by Riemann sums in this alternative sense: for every ε > 0
there is a δ > 0 so that
¯¯¯¯
Z b
a f1(x)f2(x)f3(x)... fp(x)dx
−
n
∑
i=1
f1 (ξi) f2
³
ξ(2)
i
´
f3
³
ξ(3)
i
´
... fp
³
ξ(p)
i
´
(xi −xi−1)
¯¯¯¯¯ < ε
whenever {([xi,xi−1],ξi) : i = 1,2,...n} is a partition of [a,b] with each
xi −xi−1 < δ
and ξi,ξ(2)
i ,ξ(3)
i ,...,ξ(p)
i
∈[xi−1,xi] with these being points in (a,b) where the
functions are deﬁned.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.3. RIEMANN SUMS
83
Answer
Exercise 269 Prove one more variant of Theorem 3.17.
Theorem 3.21 Suppose that the function H(s,t) satisﬁes
|H(s,t)| ≤M(|s|+|t|)
for some real number M and all real numbers s and t. Let f and g be bounded func-
tions that are deﬁned and continuous at every point of (a,b) with at most ﬁnitely
many exceptions: Then, H(f(x),g(x)) is integrable on [a,b] and moreover the in-
tegral may be uniformly approximated by Riemann sums in this sense: for every
ε > 0 there is a δ > 0 so that
¯¯¯¯¯
Z b
a H(f(x),g(x))dx−
n
∑
i=1
H (f (ξi),g(ξ∗
i ))(xi −xi−1)
¯¯¯¯¯ < ε
whenever {([xi,xi−1],ξi) : i = 1,2,...n} is a partition of [a,b] with each
xi −xi−1 < δ
and ξi, ξ∗
i ,∈[xi−1,xi] with both ξi and ξ∗
i points in (a,b) where f and g are
deﬁned.
Answer
3.3.4
Pointwise approximation by Riemann sums
For unbounded, but integrable, functions there cannot be a uniform approximation by Riemann sums. Even for bounded
functions there will be no uniform approximation by Riemann sums unless the function is mostly continuous; we have
proved one direction and later will be able to characterize those functions permitting a uniform approximation as func-
tions that are bounded and “almost everywhere” continuous.
If we are permitted to adjust the smallness of the partition in a pointwise manner, however, then such an approxima-
tion by Riemann sums is available. This is less convenient, of course, since for each ε we need ﬁnd not merely a single
positive δ but a positive δ at each point of the interval. While this appears, at the outset, to be a deep property of calculus
integrals it is an entirely trivial property.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

84
CHAPTER 3. THE DEFINITE INTEGRAL
Much more remarkable is that Henstock,3 who ﬁrst noted the property, was able also to recognize that all Lebesgue
integrable functions have the same property and that this property characterized the much more general integral of Denjoy
and Perron. Thus we will see this property again, but next time it will appear as a condition that is both necessary and
sufﬁcient.
Theorem 3.22 (Henstock property) Let f : [a,b] →R be deﬁned and integrable
on [a,b]. Then, for every ε > 0 and for each point x in [a,b] there is a δ(x) > 0 so
that
n
∑
i=1
¯¯¯¯
Z xi
xi−1
f(x)dx−f(ξi)(xi −xi−1)
¯¯¯¯ < ε
and
¯¯¯¯¯
Z b
a f(x)dx−
n
∑
i=1
f(ξi)(xi −xi−1)
¯¯¯¯¯ < ε
whenever {([xi,xi−1],ξi) : i = 1,2,...n} is a partition of [a,b] with each
xi −xi−1 < δ(ξi) and ξi ∈[xi−1,xi].
Note that our statement requires that the function f being integrated is deﬁned at all points of the interval [a,b]. This
is not really an inconvenience since we could simply set f(x) = 0 (or any other value) at points where the given function
f is not deﬁned. The resulting integral is indifferent to changing the value of a function at ﬁnitely many points.
Note also that, if there are no such partitions having the property of the statements in Theorem 3.22, then the
statement is certainly valid, but has no content. This is not the case, i.e., no matter what choice of a function δ(x) occurs
in this situation there must be at least one partition having this property. This is precisely the Cousin covering argument.
Exercise 270 In the statement of the theorem show that if the ﬁrst inequality
n
∑
i=1
¯¯¯¯
Z xi
xi−1
f(x)dx−f(ξi)(xi −xi−1)
¯¯¯¯ < ε
3Ralph Henstock (1923-2007) ﬁrst worked with this concept in the 1950s while studying nonabsolute integration theory. The characterization
of the Denjoy-Perron integral as a pointwise limit of Riemann sums was at the same time discovered by the Czech mathematician Jaroslav Kurweil
and today that integral is called the Henstock-Kurzweil integral by most users.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.4. PROPERTIES OF THE INTEGRAL
85
holds then the second inequality
¯¯¯¯¯
Z b
a f(x)dx−
n
∑
i=1
f(ξi)(xi −xi−1)
¯¯¯¯¯ < ε
must follow by simple arithmetic.
Answer
Exercise 271 Prove Theorem 3.22 in the case when f is the exact derivative of an everywhere differentiable function
F.
Answer
Exercise 272 Prove Theorem 3.17 in the case where F is an everywhere differentiable function except at one point c
inside (a,b) at which F is continuous.
Answer
Exercise 273 Complete the proof of Theorem 3.17.
Answer
3.4
Properties of the integral
The basic properties of integrals are easily obtained for us because the integral is deﬁned directly by differentiation.
Thus we can apply all the rules we know about derivatives to obtain corresponding facts about integrals.
3.4.1
Inequalities
Formula for inequalities:
Z b
a f(x)dx ≤
Z b
a g(x)dx
if f(x) ≤g(x) for all but ﬁnitely many points x in (a,b).
Here is a precise statement of what we intend by this statement: If both functions f(x) and g(x) have a calculus
integral on the interval [a,b] and, if f(x) ≤g(x) for all but ﬁnitely many points x in (a,b), then the stated inequality must
hold.
The proof is an easy exercise in derivatives. We know that if H is uniformly continuous on [a,b] and if
d
dxH(x) ≥0
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

86
CHAPTER 3. THE DEFINITE INTEGRAL
for all but ﬁnitely many points x in (a,b) then H(x) must be nondecreasing on [a,b].
Exercise 274 Complete the details needed to prove the inequality formula.
Answer
3.4.2
Linear combinations
Formula for linear combinations:
Z b
a [r f(x)+sg(x)]dx = r
Z b
a f(x)dx+s
Z b
a g(x)dx
(r,s ∈R).
Here is a precise statement of what we intend by this formula: If both functions f(x) and g(x) have a calculus integral
on the interval [a,b] then any linear combination r f(x)+sg(x) (r, s ∈R) also has a calculus integral on the interval [a,b]
and, moreover, the identity must hold. The proof is an easy exercise in derivatives. We know that
d
dx (rF(x)+sG(x)) = rF′(x)+sG′(x)
at any point x at which both F and G are differentiable.
Exercise 275 Complete the details needed to prove the linear combination formula.
3.4.3
Subintervals
Formula for subintervals: If a < c < b then
Z b
a f(x)dx =
Z c
a f(x)dx+
Z b
c f(x)dx.
(3.4)
The intention of the formula is contained in two statements in this case:
If the function f(x) has a calculus integral on the interval [a,b] then f(x) must also have a calculus integral
on any closed subinterval of the interval [a,b] and, moreover, the identity (3.4) must hold.
and
If the function f(x) has a calculus integral on the interval [a,c] and also on the interval [c,b] then f(x) must
also have a calculus integral on the interval [a,b] and, moreover, the identity (3.4) must hold.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.4. PROPERTIES OF THE INTEGRAL
87
Exercise 276 Supply the details needed to prove the subinterval formula.
3.4.4
Integration by parts
Integration by parts formula:
Z b
a F(x)G′(x)dx = F(x)G(x)−
Z b
a F′(x)G(x)dx
The intention of the formula is contained in the product rule for derivatives:
d
dx (F(x)G(x)) = F(x)G′(x)+F′(x)G(x)
which holds at any point where both functions are differentiable. One must then give strong enough hypotheses that the
function F(x)G(x) is an indeﬁnite integral for the function
F(x)G′(x)+F′(x)G(x)
in the sense needed for our integral.
Exercise 277 Supply the details needed to prove the integration by parts formula in the special case where F and G are
continuously differentiable everywhere.
Exercise 278 Supply the details needed to state and prove an integration by parts formula that is stronger than the one
in the preceding exercise.
3.4.5
Change of variable
The change of variable formula (i.e., integration by substitution):
Z b
a f(g(t))g′(t)dt =
Z g(b)
g(a) f(x)dx.
The intention of the formula is contained in the following statement which contains a sufﬁcient condition that allows
this formula to be proved: Let I be an interval and g : [a,b] →I a continuously differentiable function. Suppose that
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

88
CHAPTER 3. THE DEFINITE INTEGRAL
F : I →R is an integrable function. Then the function F(g(t))g′(t) is integrable on [a,b] and the function f is integrable
on the interval [g(a),g(b)] (or rather on [g(a),g(b)] if g(b) < g(a)) and the identity holds. There are various assumptions
under which this might be valid.
The proof is an application of the chain rule for the derivative of a composite function:
d
dxF(G(x)) = F′(G(x))G′(x).
Exercise 279 Supply the details needed to prove the change of variable formula in the special case where F and G are
differentiable everywhere.
Answer
Exercise 280 (a failed change of variables) Let F(x) = |x| and G(x) = x2 sinx−1, G(0) = 0. Does
Z 1
0 F′(G(x))G′(x)dx = F(G(1))−F(G(0)) = |sin1|?
Answer
Exercise 281 (calculus student notation) Explain the procedure being used by this calculus student:
In the integral
R 2
0 xcos(x2 +1)dx we substitute u = x2 +1, du = 2xdx and obtain
Z 2
0 xcos(x2 +1)dx = 1
2
Z u=5
u=1 cosudu = 1
2(sin(5)−sin(1)).
Exercise 282 (calculus student notation) Explain the procedure being used by this calculus student:
The substitution x = sinu, dx = cosudu is useful, because
p
1−sin2 u = cosu. Therefore
Z 1
0
p
1−x2 dx =
Z
π
2
0
p
1−sin2 ucosu du =
Z
π
2
0 cos2 u du.
Exercise 283 Supply the details needed to prove the change of variable formula in the special case where G is strictly
increasing and differentiable everywhere.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.4. PROPERTIES OF THE INTEGRAL
89
Exercise 284 Show that the integral
Z π2
0
cos√x
√x
dx
exists and use a change of variable to determine the exact value.
Answer
3.4.6
What is the derivative of the deﬁnite integral?
What is
d
dx
Z x
a f(t)dt?
We know that
R x
a f(t)dt is an indeﬁnite integral of f and so, by deﬁnition,
d
dx
Z x
a f(t)dt = f(x)
at all but ﬁnitely many points in the interval (a,b) if f is integrable on [a,b].
If we need to know more than that then there is the following version which we have already proved:
d
dx
Z x
a f(t)dt = f(x)
at all points a < x < b at which f is continuous. We should keep in mind, though, that there may also be many points
where f is discontinuous and yet the derivative formula holds.
Advanced note. If we go beyond the calculus interval, as we do in Chapter 4, then the same formula is valid
d
dx
Z x
a f(t)dt = f(x)
but there may be many more than ﬁnitely many exceptions possible. For “most” values of t this is true but there may
even be inﬁnitely many exceptions possible. It will still be true at points of continuity but it must also be true at most
points when an integrable function is badly discontinuous (as it may well be).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

90
CHAPTER 3. THE DEFINITE INTEGRAL
3.5
Absolute integrability
If a function f is integrable, does it necessarily follow that the absolute value of that function, | f|, is also integrable?
This is important in many applications. Since a solution to this problem rests on the concept of the total variation of a
function, we will give that deﬁnition below in Section 3.5.1.
Deﬁnition 3.23 (absolutely integrable) A function f is absolutely integrable on
an interval [a,b] if both f and | f| are integrable there.
Exercise 285 Show that, if f is absolutely integrable on an interval [a,b] then
¯¯¯¯
Z b
a f(x)dx
¯¯¯¯ ≤
Z b
a |f(x)| dx.
Answer
Exercise 286 (preview of bounded variation) Show that if a function f is absolutely integrable on a closed, bounded
interval [a,b] and F is its indeﬁnite integral then, for all choices of points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b,
n
∑
i=1
|F(xi)−F(xi−1)| ≤
Z b
a | f(x)|dx.
Answer
Exercise 287 (calculus integral is a nonabsolute integral) An integration method is an absolute integration method if
whenever a function f is integrable on an interval [a,b] then the absolute value | f| is also integrable there. Show that
the calculus integral is a nonabsolute integration method4.
Hint: Consider
d
dxxcos
³π
x
´
.
Answer
4Both the Riemann integral and the Lebesgue integral are absolute integration methods.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.5. ABSOLUTE INTEGRABILITY
91
Exercise 288 Repeat Exercise 287 but using
d
dxx2 sin
µ 1
x2
¶
.
Show that this derivative exists at every point. Thus there is an exact derivative which is integrable on every interval but
not absolutely integrable.
Answer
Exercise 289 Let f be continuous at every point of (a,b) with at most ﬁnitely many exceptions and suppose that f is
bounded. Show that f is absolutely integrable on [a,b].
Answer
3.5.1
Functions of bounded variation
The clue to the property that expresses absolute integrability is in Exercise 286. The notion is due to Jordan and the
language is that of variation, meaning here a measurement of how much the function is ﬂuctuating.
Deﬁnition 3.24 (total variation) A function F : [a,b] →R is said to be of bounded
variation if there is a number M so that
n
∑
i=1
|F(xi)−F(xi−1)| ≤M
for all choices of points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b.
The least such number M is called the total variation of F on [a,b] and is written
V(F,[a,b]). If F is not of bounded variation then we set V(F,[a,b]) = ∞.
Deﬁnition 3.25 (total variation function) let F : [a,b] →R be a function of
bounded variation. Then the function
T(x) = V(F,[a,x])
(a < x ≤b),
T(a) = 0
is called the total variation function for F on [a,b].
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

92
CHAPTER 3. THE DEFINITE INTEGRAL
Our main theorem in this section establishes the properties of the total variation function and gives, at least for
continuous functions, the connection this concept has with absolute integrability.
Theorem 3.26 (properties of the total variation) let F : [a,b] →R be a function
of bounded variation and let T(x) = V(F,[a,x]) be its total variation. Then
1. for all a ≤c < d ≤b,
|F(d)−F(c)| ≤V(F,[c,d]) = T(d)−T(c).
2. T is monotonic, nondecreasing on [a,b].
3. If F is continuous at a point a < x0 < b then so too is T.
4. If F is uniformly continuous on [a,b] then so too is T.
5. If F is continuously differentiable at a point a < x0 < b then so too is T and,
moveover T ′(x0) = |F′(x0)|.
6. If F is uniformly continuous on [a,b] and continuously differentiable at all
but ﬁnitely many points in (a,b) then F′ is absolutely integrable and
F(x)−F(a) =
Z x
a F′(t)dt and T(x) =
Z x
a |F′(t)|dt.
As we see here in assertion (6.) of the theorem and will discover further in the exercises, the two notions of total
variation and absolute integrability are closely interrelated. The notion of total variation plays such a signiﬁcant role
in the study of real functions in general and in integration theory in particular that it is worthwhile spending some
considerable time on it, even at an elementary calculus level. Since the ideas are closely related to other ideas which we
are studying this topic should seem a natural development of the theory. Indeed we will ﬁnd that our discussion of arc
length in Section 3.9.3 will require a use of this same language.
Exercise 290 Show directly from the deﬁnition that if F : [a,b] →R is a function of bounded variation then F is a
bounded function on [a,b].
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.5. ABSOLUTE INTEGRABILITY
93
Exercise 291 Compute the total variation for a function F that is monotonic on [a,b].
Answer
Exercise 292 Compute the total variation function for the function F(x) = sinx on [−π,π].
Answer
Exercise 293 Let F(x) have the value zero everywhere except at the point x = 0 where F(0) = 1. Choose points
−1 = x0 < x1 < x2 < ··· < xn−1 < xn = 1.
What are all the possible values of
n
∑
i=1
|F(xi)−F(xi−1)|?
What is V(F,[−1,1])?
Answer
Exercise 294 Give an example of a function F deﬁned everywhere and with the property that V(F,[a,b]) = ∞for every
interval [a,b].
Answer
Exercise 295 Show that if F : [a,b] →R is Lipschitz then F is a function of bounded variation. Is the converse true?
Answer
Exercise 296 Show that V(F +G,[a,b]) ≤V(F,[a,b])+V(G,[a,b]).
Answer
Exercise 297 Does
V(F +G,[a,b]) = V(F,[a,b])+V(G,[a,b]).
Answer
Exercise 298 Prove Theorem 3.26.
Answer
Exercise 299 (Jordan decomposition) Show that a function F has bounded variation on an interval [a,b] if and only if
it can expressed as the difference of two monotonic, nondecreasing functions.
Answer
Exercise 300 Show that the function F(x) = xcos
¡ π
x
¢
, F(0) = 0 is continuous everywhere but does not have bounded
variation on the interval [0,1], i.e., that V(F,[0,1]) = ∞.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

94
CHAPTER 3. THE DEFINITE INTEGRAL
Exercise 301 (derivative of the variation) Suppose that F(x) = xr cosx−1 for x > 0, F(x) = −(−x)r cosx−1 for x < 0,
and ﬁnally F(0) = 0. Show that if r > 1 then F has bounded variation on [−1,1] and that F′(0) = 0. Let T be the total
variation function of F. Show that T ′(0) = 0 if r > 2, that T ′(0) = 2/π if r = 2, and that T ′(0) = ∞if 1 < r < 2.
Note: In particular, at points where F is differentiable, the total variation T need not be. Theorem 3.26 said, in contrast,
that at points where F is continuously differentiable, the total variation T must also be continuously differentiable.
Answer
Exercise 302 (uniformly approximating the variation) Suppose that F is uniformly continuous on [a,b]. Show that
for any v < V(F,[a,b] there is a δ > 0 so that so that
v <
n
∑
i=1
|F(xi)−F(xi−1)| ≤V(F,[a,b]
for all choices of points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b
provided that each xi −xi−1 < δ. Is it possible to drop or relax the assumption that F is continuous?
Note: This means the variation of a continuous function can be computed much like our Riemann sums approximation
to the integral.
Answer
Exercise 303 Let Fk : [a,b] →R (k = 1,2,3,...) be a sequence of functions of bounded variation, suppose that
F(x) = lim
k→∞Fk(x)
for every k = 1,2,3,... and suppose that there is a number M so that
V(Fk,[a,b]) ≤M.
k = 1,2,3,....
Show that F must also have bounded variation.
Does this prove that every limit of a sequence of functions of bounded variation must also have bounded variation?
Exercise 304 (locally of bounded variation) Let F : R →R be a function. We say that F is locally of bounded variation
at a point x if there is some positive δ so that V(F,[x −δ,x + δ]) < ∞. Show that F has bounded variation on every
compact interval [a,b] if and only if F is locally of bounded variation at every point x ∈R.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.6. SEQUENCES AND SERIES OF INTEGRALS
95
3.5.2
Indeﬁnite integrals and bounded variation
In the preceding section we spent some time mastering the important concept of total variation. We now see that it
precisely describes the absolute integrability of a function. Indeﬁnite integrals of nonabsolutely integrable functions will
not be of bounded variation; indeﬁnite integrals of absolutely integrable functions must be of bounded variation.
Theorem 3.27 Suppose that a function f : (a,b) →R is absolutely integrable on
a closed, bounded interval [a,b]. Then its indeﬁnite integral F must be a function
of bounded variation there and, moreover,
V(F,[a,b]) =
Z b
a | f(x)|dx.
This theorem states only a necessary condition for absolute integrability. If we add in a continuity assumption we
can get a complete picture of what happens. Continuity is needed for the calculus integral, but is not needed for more
advanced theories of integration.
Theorem 3.28 Let F : [a,b] →R be a uniformly continuous function that is contin-
uously differentiable at every point in a bounded, open interval (a,b) with possibly
ﬁnitely many exceptions. Then F′ is integrable on [a,b] and will be, moreover, ab-
solutely integrable on [a,b] if and only if F has bounded variation on that interval.
Exercise 305 Prove Theorem 3.27.
Answer
Exercise 306 Prove Theorem 3.28.
Answer
3.6
Sequences and series of integrals
Throughout the 18th century much progress in applications of the calculus was made through quite liberal use of the
formulas
lim
n→∞
Z b
a fn(x)dx =
Z b
a
n
lim
n→∞fn(x)
o
dx
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

96
CHAPTER 3. THE DEFINITE INTEGRAL
and
∞
∑
k=1
Z b
a gk(x)dx =
Z b
a
(
∞
∑
k=1
gk(x)
)
dx.
These are vitally important tools but they require careful application and justiﬁcation. That justiﬁcation did not come
until the middle of the 19th century.
We introduce two deﬁnitions of convergence allowing us to interpret what the limit and sum of a sequence,
lim
n→∞fn(x) and
∞
∑
k=1
gk(x)
should mean. We will ﬁnd that uniform convergence allows an easy justiﬁcation for the basic formulas above. Point-
wise convergence is equally important but more delicate. At the level of a calculus course we will ﬁnd that uniform
convergence is the concept we shall use most frequently.
3.6.1
The counterexamples
We begin by asking, naively, whether there is any difﬁculty in taking limits in the calculus. Suppose that f1, f2, f3, . . . is
a sequence of functions deﬁned on an open interval I = (a,b). We suppose that this sequence converges pointwise to a
function f, i.e., that for each x ∈I the sequence of numbers { fn(x)} converges to the value f(x).
Is it true that
1. If fn is bounded on I for all n, then is f also bounded on I?
2. If fn is continuous on I for all n, then is f also continuous on I?
3. If fn is uniformly continuous on I for all n, then is f also uniformly continuous on I?
4. If fn is differentiable on I for all n, then is f also differentiable on I and, if so, does
f ′ = lim
n→∞f ′
n?
5. If fn is integrable on a subinterval [c,d] of I for all n, then is f also integrable on [c,d] and, if so, does
lim
n→∞
Z d
c fn(x)dx =
Z d
c
n
lim
n→∞fn(x)
o
dx?
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.6. SEQUENCES AND SERIES OF INTEGRALS
97
1
1
1
Figure 3.1: Graphs of xn on [0,1] for n = 1, 3, 5, 7, 9, and 50.
These ﬁve questions have negative answers in general, as the examples that follow show.
Exercise 307 (An unbounded limit of bounded functions) On the interval (0,∞) and for each integer n let fn(x) =
1/x for x > 1/n and fn(x) = n for each 0 < x ≤1/n. Show that each function fn is both continuous and bounded on
(0,∞). Is the limit function f(x) = limn→∞fn(x) also continuous ? Is the limit function bounded?
Answer
Exercise 308 (A discontinuous limit of continuous functions) For each integer n and −1 < x ≤1, let fn(x) = xn. For
x > 1 let fn(x) = 1. Show that each fn is a continuous function on (−1,∞) and that the sequence converges pointwise to
a function f on (−1,∞) that has a single point of discontinuity.
Answer
Exercise 309 (A limit of uniformly continuous functions) Show that the previous exercise supplies a pointwise con-
vergence sequence of uniformly continuous functions on the interval [0,1] that does not converge to a uniformly contin-
uous function.
Exercise 310 (The derivative of the limit is not the limit of the derivative) Let fn(x) = xn/n for −1 < x ≤1 and let
fn(x) = x −(n −1)/n for x > 1. Show that each fn is differentiable at every point of the interval (−1,∞) but that the
limit function has a point of nondifferentiability.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

98
CHAPTER 3. THE DEFINITE INTEGRAL
-
1
1
2n
1
n
6
2n
¦
¦
¦
¦
¦
¦
¦
¦
¦¦
E
E
E
E
E
E
E
E
E
Figure 3.2: Graph of fn(x) on [0,1] in Exercise 311.
Exercise 311 (The integral of the limit is not the limit of the integrals) In this example we consider a sequence of
continuous functions, each of which has the same integral over the interval. For each n let fn be deﬁned on [0,1]
as follows: fn(0) = 0, fn(1/(2n)) = 2n, fn(1/n) = 0, fn is linear on [0,1/(2n)] and on [1/(2n),1/n], and fn = 0 on
[1/n,1]. (See Figure 3.2.)
It is easy to verify that fn →0 on [0,1]. Now, for each n,
Z 1
0 fnx = 1.
But
Z 1
0 (lim
n→∞n fn(x))dx =
Z 1
0 0dx = 0.
Thus
lim
n→∞n
Z 1
0 fnx ̸=
Z 1
0 lim
n→∞n fn(x)dx
so that the limit of the integrals is not the integral of the limit.
Exercise 312 (interchange of limit operations) To prove the (false) theorem that the pointwise limit of a sequence of
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.6. SEQUENCES AND SERIES OF INTEGRALS
99
continuous functions is continuous, why cannot we simply write
lim
x→x0
³
lim
n→∞fn(x)
´
= lim
n→∞fn(x0) = lim
n→∞
µ
lim
x→x0 fn(x)
¶
and deduce that
lim
x→x0 f(x) = f(x0)?
This assumes fn is continuous at x0 and “proves” that f is continuous at x0. that
Answer
Exercise 313 Is there anything wrong with this “proof” that a limit of bounded functions is bounded? If each fn is
bounded on an interval I then there must be, by deﬁnition, a number M so that | fn(x)| ≤M for all x in I. By properties
of sequence limits
| f(x)| = | lim
n→∞fn(x)| ≤M
also, so f is bounded.
Answer
Exercise 314 (interchange of limit operations) Let
Smn =
½ 0,
if m ≤n
1,
if m > n.
Viewed as a matrix,
[Smn] =


0
0
0
···
1
0
0
···
1
1
0
···
...
...
...
...


where we are placing the entry Smn in the mth row and nth column. Show that
lim
n→∞
³
lim
m→∞Smn
´
̸= lim
m→∞
³
lim
n→∞Smn
´
.
Answer
Exercise 315 Examine the pointwise limiting behavior of the sequence of functions
fn(x) =
xn
1+xn .
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

100
CHAPTER 3. THE DEFINITE INTEGRAL
Exercise 316 Show that the natural logarithm function can be expressed as the pointwise limit of a sequence of “sim-
pler” functions,
logx = lim
n→∞n
¡ n√x−1
¢
for every point in the interval. If the answer to our initial ﬁve questions for this particular limit is afﬁrmative, what can
you deduce about the continuity of the logarithm function? What would be its derivative? What would be
R 2
1 logxdx?
Exercise 317 Let x1,x2,... be a sequence that contains every rational number, let
fn(x) =
½ 1,
if x ∈{x1,...,xn}
0,
otherwise,
and f(x) =
½ 1,
if x is rational
0,
otherwise.
1. Show that fn →f pointwise on any interval.
2. Show that fn has only ﬁnitely many points of discontinuity while f has no points of continuity.
3. Show that each fn has a calculus integral on any interval [c,d] while f has a calculus integral on no interval.
4. Show that, for any interval [c,d],
lim
n→∞
Z d
c fn(x)dx ̸=
Z d
c
n
lim
n→∞fn(x)
o
dx.
Answer
Exercise 318 Let fn(x) = sinnx/√n. Show that limn→∞n fn = 0 but limn→∞n f ′
n(0) = ∞.
Exercise 319 Let fn →f pointwise at every point in the interval [a,b]. We have seen that even if each fn is continuous
it does not follow that f is continuous. Which of the following statements are true?
1. If each fn is increasing on [a,b], then so is f.
2. If each fn is nondecreasing on [a,b], then so is f.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.6. SEQUENCES AND SERIES OF INTEGRALS
101
3. If each fn is bounded on [a,b], then so is f.
4. If each fn is everywhere discontinuous on [a,b], then so is f.
5. If each fn is constant on [a,b], then so is f.
6. If each fn is positive on [a,b], then so is f.
7. If each fn is linear on [a,b], then so is f.
8. If each fn is convex on [a,b], then so is f.
Answer
Exercise 320 A careless student5 once argued as follows: “It seems to me that one can construct a curve without a
tangent in a very elementary way. We divide the diagonal of a square into n equal parts and construct on each subdivision
as base a right isosceles triangle. In this way we get a kind of delicate little saw. Now I put n = ∞. The saw becomes a
continuous curve that is inﬁnitesimally different from the diagonal. But it is perfectly clear that its tangent is alternately
parallel now to the x-axis, now to the y-axis.” What is the error? (Figure 3.3 illustrates the construction.)
Answer
Exercise 321 Consider again the sequence { fn} of functions fn(x) = xn on the interval (0,1). We saw that fn →0
pointwise on (0,1), and we proved this by establishing that, for every ﬁxed x0 ∈(0,1) and ε > 0,
|x0|n < ε if and only if n > logε/logx0.
Is it possible to ﬁnd an integer N so that, for all x ∈(0,1),
|x|n < ε if f n > N?
Discuss.
Answer
5In this case the “careless student” was the great Russian analyst N. N. Luzin (1883–1950), who recounted in a letter [reproduced in
Amer. Math. Monthly, 107, (2000), pp. 64–82] how he offered this argument to his professor after a lecture on the Weierstrass continuous nowhere
differentiable function.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

102
CHAPTER 3. THE DEFINITE INTEGRAL
Figure 3.3: Construction in Exercise 320.
3.6.2
Uniform convergence
The most immediate of the conditions which allows an interchange of limits in the calculus is the notion of uniform
convergence. This is a very much stronger condition than pointwise convergence.
Deﬁnition 3.29 Let { fn} be a sequence of functions deﬁned on an interval I. We
say that { fn} converges uniformly to a function f on I if, for every ε > 0, there
exists an integer N such that
| fn(x)−f(x)| < ε for all n ≥N and all x ∈I.
Exercise 322 Show that the sequence of functions fn(x) = xn converges uniformly on any interval [0,η] provided that
0 < η < 1.
Answer
Exercise 323 Using this deﬁnition of the Cauchy Criterion
Deﬁnition 3.30 (Cauchy Criterion) Let { fn} be a sequence of functions deﬁned on
an interval set I. The sequence is said to be uniformly Cauchy on I if for every ε > 0
there exists an integer N such that if n ≥N and m ≥N, then | fm(x)−fn(x)| < ε for
all x ∈I.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.6. SEQUENCES AND SERIES OF INTEGRALS
103
prove the following theorem:
Theorem 3.31 Let { fn} be a sequence of functions deﬁned on an interval I. Then
there exists a function f deﬁned on the interval I such that the sequence uniformly
on I if and only if { fn} is uniformly Cauchy on I.
Answer
Exercise 324 In Exercise 322 we showed that the sequence fn(x) = xn converges uniformly on any interval [0,η], for
0 < η < 1. Prove this again, but using the Cauchy criterion.
Answer
Exercise 325 (Cauchy criterion for series) The Cauchy criterion can be expressed for uniformly convergent series too.
We say that a series ∑∞
k=1 gk converges uniformly to the function f on an interval I if the sequence of partial sums {Sn}
where
Sn(x) =
n
∑
k=1
gk(x)
converges uniformly to f on I. Prove this theorem:
Theorem 3.32 Let {gk} be a sequence of functions deﬁned on an interval I. Then
the series ∑∞
k=1 fk converges uniformly to some function f on the interval I if and
only if for every ε > 0 there is an integer N so that
¯¯¯¯¯
n
∑
j=m
f j(x)
¯¯¯¯¯ < ε
for all n ≥m ≥N and all x ∈I.
Answer
Exercise 326 Show that the series
1+x+x2 +x3 +x4 +...
converges pointwise on [0,1), converges uniformly on any interval [0,η] for 0 < η < 1, but that the series does not
converge uniformly on [0,1).
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

104
CHAPTER 3. THE DEFINITE INTEGRAL
Exercise 327 (Weierstrass M-Test) Prove the following theorem, which is usually known as the Weierstrass M-test for
uniform convergence of series.
Theorem 3.33 (M-Test) Let { fk} be a sequence of functions deﬁned on an interval
I and let {Mk} be a sequence of positive constants. If
∞
∑
k=1
Mk < ∞and | fk(x)| ≤Mk
for each x ∈I and k = 0,1,2,...,
then the series ∑∞
k=1 fk converges uniformly on the interval I.
Answer
Exercise 328 Consider again the geometric series 1 + x + x2 + ... (as we did in Exercise 326). Use the Weierstrass
M-test to prove uniform convergence on the interval [−a,a], for any 0 < a < 1.
Answer
Exercise 329 Use the Weierstrass M-test to investigate the uniform convergence of the series
∞
∑
k=1
sinkθ
kp
on an interval for values of p > 0.
Answer
Exercise 330 (Abel’s Test for Uniform Convergence) Prove Abel’s test for uniform convergence:
Theorem 3.34 (Abel) Let {ak} and {bk} be sequences of functions on an interval
I. Suppose that there is a number M so that
−M ≤sN(x) =
N
∑
k=1
ak(x) ≤M
for all x ∈I and every integer N. Suppose that the sequence of functions {bk} →0
converges monotonically to zero at each point and that this convergence is uniform
on I. Then the series ∑∞
k=1 ak(x)bk(x) converges uniformly on I.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.6. SEQUENCES AND SERIES OF INTEGRALS
105
Exercise 331 Apply Theorem 3.34, to the following series that often arises in Fourier analysis:
∞
∑
k=1
sinkθ
k
.
Answer
Exercise 332 Examine the uniform limiting behavior of the sequence of functions
fn(x) =
xn
1+xn .
On what sets can you determine uniform convergence?
Exercise 333 Examine the uniform limiting behavior of the sequence of functions
fn(x) = x2e−nx.
On what sets can you determine uniform convergence? On what sets can you determine uniform convergence for the
sequence of functions n2 fn(x)?
Exercise 334 Prove that if { fn} and {gn} both converge uniformly on an interval I, then so too does the sequence
{ fn +gn}.
Exercise 335 Prove or disprove that if { fn} and {gn} both converge uniformly on an interval I, then so too does the
sequence { fngn}.
Exercise 336 Prove or disprove that if f is a continuous function on (−∞,∞), then
f(x+1/n) →f(x)
uniformly on (−∞,∞). (What extra condition, stronger than continuity, would work if not?)
Exercise 337 Prove that fn →f converges uniformly on an interval I, if and only if
lim
n sup
x∈I
| fn(x)−f(x)| = 0.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

106
CHAPTER 3. THE DEFINITE INTEGRAL
Exercise 338 Show that a sequence of functions { fn} fails to converge to a function f uniformly on an interval I if and
only if there is some positive ε0 so that a sequence {xk} of points in I and a subsequence { fnk} can be found such that
|fnk(xk)−f(xk)| ≥ε0.
Exercise 339 Apply the criterion in the preceding exercise to show that the sequence fn(x) = xn does not converge
uniformly to zero on (0,1).
Exercise 340 Prove Theorem 3.31.
Answer
Exercise 341 Verify that the geometric series ∑∞
k=0 xk, which converges pointwise on (−1,1), does not converge uni-
formly there.
Exercise 342 Do the same for the series obtained by differentiating the series in Exercise 341; that is, show that
∑∞
k=1 kxk−1 converges pointwise but not uniformly on (−1,1). Show that this series does converge uniformly on ev-
ery closed interval [a,b] contained in (−1,1).
Exercise 343 Verify that the series
∞
∑
k=1
coskx
k2
converges uniformly on (−∞,∞).
Exercise 344 If { fn} is a sequence of functions converging uniformly on an interval I to a function f, what conditions
on the function g would allow you to conclude that g◦fn converges uniformly on I to g◦f?
Exercise 345 Prove that the series
∞
∑
k=0
xk
k converges uniformly on [0,b] for every b ∈[0,1) but does not converge uni-
formly on [0,1).
Exercise 346 Prove that if ∑∞
k=1 fk converges uniformly on an interval I, then the sequence of terms { fk} converges
uniformly on I.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.6. SEQUENCES AND SERIES OF INTEGRALS
107
Exercise 347 A sequence of functions { fn} is said to be uniformly bounded on an interval [a,b] if there is a number M
so that
| fn(x)| ≤M
for every n and also for every x ∈[a,b]. Show that a uniformly convergent sequence { fn} of continuous functions on
[a,b] must be uniformly bounded. Show that the same statement would not be true for pointwise convergence.
Exercise 348 Suppose that fn →f on (−∞,+∞). What conditions would allow you to compute that
lim
n→∞fn(x+1/n) = f(x)?
Exercise 349 Suppose that { fn} is a sequence of continuous functions on the interval [0,1] and that you know that { fn}
converges uniformly on the set of rational numbers inside [0,1]. Can you conclude that { fn} uniformly on [0,1]? (Would
this be true without the continuity assertion?)
Exercise 350 Prove the following variant of the Weierstrass M-test: Let { fk} and {gk} be sequences of functions on an
interval I. Suppose that | fk(x)| ≤gk(x) for all k and x ∈I and that ∑∞
k=1 gk converges uniformly on I. Then the series
∑∞
k=1 fk converges uniformly on I.
Exercise 351 Prove the following variant on Theorem 3.34: Let {ak} and {bk} be sequences of functions on an interval
I. Suppose that ∑∞
k=1 ak(x) converges uniformly on I. Suppose that {bk} is monotone for each x ∈I and uniformly
bounded on E. Then the series ∑∞
k=1 akbk converges uniformly on I.
Exercise 352 Prove the following variant on Theorem 3.34: Let {ak} and {bk} be sequences of functions on an interval
I. Suppose that there is a number M so that
¯¯¯¯¯
N
∑
k=1
ak(x)
¯¯¯¯¯ ≤M
for all x ∈I and every integer N. Suppose that
∞
∑
k=1
|bk −bk+1|
converges uniformly on I and that bk →0 uniformly on I. Then the series ∑∞
k=1 akbk converges uniformly on I.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

108
CHAPTER 3. THE DEFINITE INTEGRAL
Exercise 353 Prove the following variant on Abel’s test (Theorem 3.34): Let {ak(x)} and {bk(x)} be sequences of
functions on an interval I. Suppose that ∑∞
k=1 ak(x) converges uniformly on I. Suppose that the series
∞
∑
k=1
|bk(x)−bk+1(x)|
has uniformly bounded partial sums on I. Suppose that the sequence of functions {bk(x)} is uniformly bounded on I.
Then the series ∑∞
k=1 ak(x)bk(x) converges uniformly on I.
Exercise 354 Suppose that { fn(x)} is a sequence of continuous functions on an interval [a,b] converging uniformly to a
function f on the open interval (a,b). If f is also continuous on [a,b], show that the convergence is uniform on [a,b].
Exercise 355 Suppose that { fn} is a sequence of functions converging uniformly to zero on an interval [a,b]. Show that
limn→∞fn(xn) = 0 for every convergent sequence {xn} of points in [a,b]. Give an example to show that this statement
may be false if fn →0 merely pointwise.
Exercise 356 Suppose that { fn} is a sequence of functions on an interval [a,b] with the property that limn→∞fn(xn) = 0
for every convergent sequence {xn} of points in [a,b]. Show that { fn} converges uniformly to zero on [a,b].
3.6.3
Uniform convergence and integrals
We state our main theorem for continuous functions. We know that bounded, continuous functions are integrable and we
have several tools that handle unbounded continuous functions.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.6. SEQUENCES AND SERIES OF INTEGRALS
109
Theorem 3.35 (uniform convergence of sequences of continuous functions)
Let f1, f2, f3, . . . be a sequence of functions deﬁned and continuous on an open
interval (a,b). Suppose that { fn} converges uniformly on (a,b) to a function f.
Then
1. f is continuous on (a,b).
2. If each fn is bounded on the interval (a,b) then so too is f.
3. For each closed, bounded interval [c,d] ⊂(a,b)
lim
n→∞
Z d
c fn(x)dx =
Z d
c
n
lim
n→∞fn(x)
o
dx =
Z d
c f(x)dx.
4. If each fn is integrable on the interval [a,b] then so too is f and
lim
n→∞
Z b
a fn(x)dx =
Z b
a
n
lim
n→∞fn(x)
o
dx =
Z b
a f(x)dx.
We have deﬁned uniform convergence of series in a simple way, merely by requiring that the sequence of partial
sums converges uniformly. Thus the Corollary follows immediately from the theorem applied to these partial sums.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

110
CHAPTER 3. THE DEFINITE INTEGRAL
Corollary 3.36 (uniform convergence of series of continuous functions) Let
g1, g2, g3, . . . be a sequence of functions deﬁned and continuous on an open
interval (a,b). Suppose that the series ∑∞
k=1 gk converges uniformly on (a,b) to a
function f. Then
1. f is continuous on (a,b).
2. For each closed, bounded interval [c,d] ⊂(a,b)
∞
∑
k=1
Z d
c gk(x)dx =
Z d
c
(
∞
∑
k=1
gk(x)
)
dx =
Z d
c f(x)dx.
3. If each gk is integrable on the interval [a,b] then so too is f and
∞
∑
k=1
Z b
a gk(x)dx =
Z b
a
(
∞
∑
k=1
gk(x)
)
dx =
Z b
a f(x)dx.
Exercise 357 To prove Theorem 3.35 and its corollary is just a matter of putting together facts that we already know.
Do this.
3.6.4
A defect of the calculus integral
In the preceding section we have seen that uniform convergence of continuous functions allows for us to interchange the
order of integration and limit to obtain the important formula
lim
n→∞
Z b
a fn(x)dx =
Z b
a
n
lim
n→∞fn(x)
o
dx.
Is this still true if we drop the assumption that the functions fn are continuous?
We will prove one very weak theorem and give one counterexample to show that the class of integrable functions
in the calculus sense is not closed under uniform limits6. We will work on this problem again in Section 3.6.6 but we
cannot completely handle the defect. We will remedy this defect of the calculus integral in Chapter 4.
6Had we chosen back in Section 2.1.1 to accept sequences of exceptional points rather than ﬁnite exceptional sets we would not have had this
problem here.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.6. SEQUENCES AND SERIES OF INTEGRALS
111
Theorem 3.37 Let f1, f2, f3, . . . be a sequence of functions deﬁned and integrable
on a closed, bounded interval [a,b]. Suppose that { fn} converges uniformly on
[a,b] to a function f. Then, provided we assume that f is integrable on [a,b],
Z b
a f(x)dx = lim
n→∞
Z b
a fn(x)dx.
Exercise 358 Let
gk(x) =
(
0
if 0 ≤x ≤1−1
k
2−k
if 1−1
k < x ≤1.
Show that the series ∑∞
k=2 gk(x) of integrable functions converges uniformly on [0,1] to a function f that is not integrable
in the calculus sense.
Answer
Exercise 359 Prove Theorem 3.37.
Answer
3.6.5
Uniform limits of continuous derivatives
We saw in Section 3.6.3 that a uniformly convergent sequence (or series) of continuous functions can be integrated term-
by-term . As an application of our integration theorem we obtain a theorem on term-by-term differentiation. We write
this in a form suggesting that the order of differentiation and limit is being reversed.
Theorem 3.38 Let {Fn} be a sequence of uniformly continuous functions on an
interval [a,b], suppose that each function has a continuous derivative F′
n on (a,b),
and suppose that
1. The sequence {F′
n} of derivatives converges uniformly to a function on (a,b).
2. The sequence {Fn} converges pointwise to a function F.
Then F is differentiable on (a,b) and, for all a < x < b,
F′(x) = d
dxF(x) = d
dx lim
n→∞Fn(x) = lim
n→∞
d
dxFn(x) = lim
n→∞F′
n(x).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

112
CHAPTER 3. THE DEFINITE INTEGRAL
For series, the theorem takes the following form:
Corollary 3.39 Let {Gk} be a sequence of uniformly continuous functions on an
interval [a,b], suppose that each function has a continuous derivative F′
n on (a,b),
and suppose that
1. F(x) = ∑∞
k=1 Gk(x) pointwise on [a,b].
2. ∑∞
k=0 G′
k(x) converges uniformly on (a,b).
Then, for all a < x < b,
F′(x) = d
dxF(x) = d
dx
∞
∑
k=1
Gk(x) =
∞
∑
k=1
d
dxGk(x) =
∞
∑
k=1
G′
k(x).
Exercise 360 Using Theorem 3.35, prove Theorem 3.38.
Answer
Exercise 361 Starting with the geometric series
1
1−x =
∞
∑
k=0
xk
on (−1,1),
(3.5)
show how to obtain
1
(1−x)2 =
∞
∑
k=1
kxk−1
on (−1,1).
(3.6)
[Note that the series ∑∞
k=1 kxk−1 does not converge uniformly on (−1,1). Is this troublesome?]
Answer
Exercise 362 Starting with the deﬁnition
ex =
∞
∑
k=0
xk
k!
on (−∞,∞),
(3.7)
show how to obtain
d
dxex =
∞
∑
k=0
xk
k! = ex
on (−∞,∞).
(3.8)
[Note that the series ∑∞
k=1
xk
k! does not converge uniformly on (−∞,∞). Is this troublesome?]
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.6. SEQUENCES AND SERIES OF INTEGRALS
113
Exercise 363 Can the sequence of functions fn(x) = sinnx
n3
be differentiated term-by-term?
Exercise 364 Can the series of functions
∞
∑
k=1
sinkx
k3
be differentiated term-by-term?
Exercise 365 Verify that the function
y(x) = 1+ x2
1! + x4
2! + x6
3! + x8
4! +...
is a solution of the differential equation y′ = 2xy on (−∞,∞) without ﬁrst ﬁnding an explicit formula for y(x).
3.6.6
Uniform limits of discontinuous derivatives
The following theorem reduces the hypotheses of Theorem 3.38 and, accordingly is much more difﬁcult to prove. Here
we have dropped the continuity of the derivatives as an assumption.
Theorem 3.40 Let { fn} be a sequence of uniformly continuous functions deﬁned
on an interval [a,b]. Suppose that f ′
n(x) exists for each n and each x ∈(a,b) except
possibly for x in some ﬁnite set C. Suppose that the sequence { f ′
n} of derivatives
converges uniformly on (a,b)\C and that there exists at least one point x0 ∈[a,b]
such that the sequence of numbers { fn(x0)} converges. Then the sequence { fn}
converges uniformly to a function f on the interval [a,b], f is differentiable with,
at each point x ∈(a,b)\C,
f ′(x) = lim
n→∞f ′
n(x) and
lim
n→∞
Z b
a f ′
n(x)dx =
Z b
a f ′(x)dx.
Exercise 366 Prove Theorem 3.40.
Answer
Exercise 367 For inﬁnite series, how can Theorem 3.40 be rewritten?
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

114
CHAPTER 3. THE DEFINITE INTEGRAL
Exercise 368 (uniform limits of integrable functions) At ﬁrst sight Theorem 3.40 seems to supply the following obser-
vation: If {gn} is a sequence of functions integrable in the calculus sense on an interval [a,b] and gn converges uniformly
to a function g on [a,b] then g must also be integrable. Is this true?
Answer
Exercise 369 In the statement of Theorem 3.40 we hypothesized the existence of a single point x0 at which the sequence
{ fn(x0)} converges. It then followed that the sequence { fn} converges on all of the interval I. If we drop that requirement
but retain the requirement that the sequence { f ′
n} converges uniformly to a function g on I, show that we cannot conclude
that { fn} converges on I, but we can still conclude that there exists f such that f ′ = g = limn→∞f ′
n on I.
Answer
3.7
The monotone convergence theorem
Two of the most important computations with integrals are taking a limit inside an integral,
lim
n→∞
Z b
a fn(x)dx =
Z b
a
³
lim
n→∞fn(x)
´
dx
and summing a series inside an integral,
∞
∑
k=1
Z b
a gk(x)dx =
Z b
a
Ã
∞
∑
k=1
gk(x)
!
dx.
The counterexamples in Section 3.6.1, however, have made us very wary of doing this. The uniform convergence
results of Section 3.6.5, on the other hand, have encouraged us to check for uniform convergence as a guarantee that
these operations will be successful.
But uniform convergence is not a necessary requirement. There are important weaker assumptions that will allow
us to use sequence and series techniques on integrals. For sequences an assumption that the sequence is monotone will
work. For series an assumption that the terms are nonnegative will work.
3.7.1
Summing inside the integral
We establish that the summation formula
Z b
a
Ã
∞
∑
n=1
gk(x)
!
dx =
∞
∑
n=1
µZ b
a gk(x)dx
¶
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.7. THE MONOTONE CONVERGENCE THEOREM
115
is possible for nonnegative functions. We need also to assume that the sum function f(x) = ∑∞
n=1 gk(x) is itself integrable
since that cannot be deduced otherwise.
This is just a defect in the calculus integral; in a more general theory of integration we would be able to conclude both
that the sum is indeed integrable and also that the sum formula is correct. (See Part Two of this text.) This defect is more
serious than it might appear. In most applications the only thing we might know about the function f(x) = ∑∞
n=1 gk(x) is
that it is the sum of this series. We may not be able to check continuity and we certainly are unlikely to be able to ﬁnd
an indeﬁnite integral.
We split the statement into two lemmas for ease of proof. Together they supply the integration formula for the sum
of nonnegative integrable functions.
Lemma 3.41 Suppose that f, g1, g2, g3,. . . is a sequence of nonnegative functions,
each one integrable on a closed bounded interval [a,b]. If, for all but ﬁnitely many
x in (a,b)
f(x) ≥
∞
∑
k=1
gk(x),
then
Z b
a f(x)dx ≥
∞
∑
k=1
µZ b
a gk(x)dx
¶
.
(3.9)
Lemma 3.42 Suppose that f, g1, g2, g3,. . . is a sequence of nonnegative functions,
each one integrable on a closed bounded interval [a,b]. If, for all but ﬁnitely many
x in (a,b),
f(x) ≤
∞
∑
k=1
gk(x),
then
Z b
a f(x)dx ≤
∞
∑
k=1
µZ b
a gk(x)dx
¶
.
(3.10)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

116
CHAPTER 3. THE DEFINITE INTEGRAL
Exercise 370 In each of the lemmas show that we may assume, without loss of generality, that the inequalities
f(x) ≤
∞
∑
k=1
gk(x),
or
f(x) ≥
∞
∑
k=1
gk(x),
hold for all values of x in the entire interval [a,b].
Answer
Exercise 371 Prove the easier of the two lemmas.
Answer
Exercise 372 Prove Lemma 3.42, or rather give it a try and then consult the write up in the answer section. This is just
an argument manipulating Riemann sums so it is not particularly deep; even so it requires some care.
Answer
Exercise 373 Construct an example of a convergent series of continuous functions that converges pointwise to a function
that is not integrable in the calculus sense.
3.7.2
Monotone convergence theorem
The series formula immediately supplies the monotone convergence theorem.
Theorem 3.43 (Monotone convergence theorem) Let
fn : [a,b] →R
(n =
1,2,3,...) be a nondecreasing sequence of functions, each integrable on the in-
terval [a,b] and suppose that
f(x) = lim
n→∞fn(x)
for every x in [a,b] with possibly ﬁnitely many exceptions. Then, provided f is also
integrable on [a,b],
Z b
a f(x)dx = lim
n→∞
Z b
a fn(x)dx.
Exercise 374 Deduce Theorem 3.43 from Lemmas 3.41 and 3.42.
Answer
Exercise 375 Prove Theorem 3.43 directly by a suitable Riemann sums argument.
Answer
Exercise 376 Construct an example of a convergent, monotonic sequence of continuous functions that converges point-
wise to a function that is not integrable in the calculus sense.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.8. INTEGRATION OF POWER SERIES
117
3.8
Integration of power series
A power series is an inﬁnite series of the form
f(x) =
∞
∑
n=0
an (x−c)n = a0 +a1(x−c)1 +a2(x−c)2 +a3(x−c)3 +···
where an is called the coefﬁcient of the nth term and c is a constant. One usually says that the series is centered at c. By
a simple change of variables any power series can be centered at zero and so all of the theory is usually stated for such a
power series
f(x) =
∞
∑
n=0
anxn = a0 +a1x+a2x2 +a3x3 +....
The set of points x where the series converges is called the interval of convergence. (We could call it a set of convergence,
but we are anticipating that it will turn out to be an interval.)
The main concern we shall have in this chapter is the integration of such series. The topic of power series in general
is huge and central to much of mathematics. We can present a fairly narrow picture but one that is complete only insofar
as applications of integration theory are concerned.
Theorem 3.44 (convergence of power series) Let
f(x) =
∞
∑
n=0
anxn = a0 +a1x+a2x2 +a3x3 +....
be a power series. Then there is a number R, 0 ≤R ≤∞, called the radius of
convergence of the series, so that
1. If R = 0 then the series converges only for x = 0.
2. If R > 0 the series converges absolutely for all x in the interval (−R,R).
3. If 0 < R < ∞the interval of convergence for the series is one of the intervals
(−R,R), (−R,R], [−R,R) or [−R,R]
and at the endpoints the series may converge absolutely or nonabsolutely.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

118
CHAPTER 3. THE DEFINITE INTEGRAL
The next theorem establishes the continuity of a power series within its interval of convergence.
Theorem 3.45 (continuity of power series) Let
f(x) =
∞
∑
n=0
anxn = a0 +a1x+a2x2 +a3x3 +....
be a power series with a radius of convergence R, 0 < R ≤∞. Then
1. f is a continuous function on its interval of convergence [i.e., continuous at
all interior points and continuous on the right or left at an endpoint if that
endpoint is included].
2. If 0 < R < ∞and the interval of convergence for the series is [−R,R] then f
is uniformly continuous on [−R,R].
Finally we are in position to show that term-by-term integration of power series is possible in nearly all situations.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.8. INTEGRATION OF POWER SERIES
119
Theorem 3.46 (integration of power series) Let
f(x) =
∞
∑
n=0
anxn = a0 +a1x+a2x2 +a3x3 +....
be a power series and let
F(x) =
∞
∑
n=0
anxn+1
n+1 = a0x+a1x2/2+a2x3/3+a3x4/4+....
be its formally integrated series. Then
1. Both series have the same radius of convergence R, but not necessarily the
same interval of convergence.
2. If R > 0 then F′(x) = f(x) for every x in (−R,R) and so F is an indeﬁnite
integral for f on the interval (−R,R).
3. f is integrable on any closed, bounded interval [a,b] ⊂(−R,R) and
Z b
a f(x)dx = F(b)−F(a).
4. If the interval of convergence of the integrated series for F is [−R,R] then f
is integrable on [−R,R] and
Z R
−R f(x)dx = F(R)−F(−R).
5. If the interval of convergence of the integrated series for F is (−R,R] then f
is integrable on [0,R] and
Z R
0 f(x)dx = F(R)−F(0).
6. If the interval of convergence of the integrated series for F is [−R,R) then f
is integrable on [−R,0] and
Z 0
−R f(x)dx = F(0)−F(−R).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

120
CHAPTER 3. THE DEFINITE INTEGRAL
Note that the integration theorem uses the interval of convergence of the integrated series. It is not a concern whether
the original series for f converges at the endpoints of the interval of convergence, but it is essential to look at these
endpoints for the integrated series. The proofs of the separate statements in the two theorems appear in various of the
exercises. Note that, while we are interested in integration problems here the proofs are all about derivatives; this is not
surprising since the calculus integral itself is simply about derivatives.
Exercise 377 Compute, if possible, the integrals
Z 1
0
Ã
∞
∑
n=0
xn
!
dx and
Z 0
−1
Ã
∞
∑
n=0
xn
!
dx.
Answer
Exercise 378 Repeat the previous exercise but use only the fact that
∞
∑
n=0
xn = 1+x+x2 +x3 +x4 +···+ =
1
1−x.
Is the answer the same?
Answer
Exercise 379 (careless student) “But,” says the careless student, “both of Exercises 377 and 378 are wrong surely.
After all, the series
f(x) = 1+x+x2 +x3 +x4 +···+
converges only on the interval (−1,1) and diverges at the endpoints x = 1 and x = −1 since
1−1+1−1+1−1+1−1 =?
and
1+1+1+1+···+ = ∞.
You cannot expect to integrate on either of the intervals [−1,0] or [0,1].” What is your response?
Answer
Exercise 380 (calculus student notation) For most calculus students it is tempting to write
Z ¡
a0 +a1x+a2x2 +a3x3 +...
¢
dx =
Z
a0 dx+
Z
a1xdx+
Z
a2x2 dx+
Z
a3x3 dx+....
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.8. INTEGRATION OF POWER SERIES
121
Is this a legitimate interpretation of this indeﬁnite integral?
Answer
Exercise 381 (calculus student notation) For most calculus students it is tempting to write
Z b
a
¡
a0 +a1x+a2x2 +a3x3 +...
¢
dx =
Z b
a a0 dx+
Z b
a a1xdx+
Z b
a a2x2 dx+
Z b
a a3x3 dx+....
Is this a legitimate interpretation of this deﬁnite integral?
Answer
Exercise 382 Show that the series
f(x) = 1+2x+3x2 +4x3 +...
has a radius of convergence 1 and an interval of convergence exactly equal to (−1,1). Show that f is not integrable on
[0,1], but that it is integrable [−1,0] and yet the computation
Z 0
−1
¡
1+2x+3x2 +4x3 +...
¢
dx =
Z 0
−1 dx+
Z 0
−1 2xdx+
Z 0
−1 3x2 dx+
Z 0
−1 4x3 dx+...
= −1+1−1+1−1+1−...
cannot be used to evaluate the integral.
Note: Since the interval of convergence of the integrated series is also (−1,1), Theorem 3.46 has nothing to say about
whether f is integrable on [0,1] or [−1,0].
Answer
Exercise 383 Determine the radius of convergence of the series
∞
∑
k=1
kkxk = x+4x2 +27x3 +....
Answer
Exercise 384 Show that, for every 0 ≤s ≤∞, there is a power series whose radius of convergence R is exactly s.
Answer
Exercise 385 Show that the radius of convergence of a series
a0 +a1x+a2x2 +a3x3 +...
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

122
CHAPTER 3. THE DEFINITE INTEGRAL
can be described as
R = sup{r : 0 < r and
∞
∑
k=0
akrk converges}.
Exercise 386 (root test for power series) Show that the radius of convergence of a series
a0 +a1x+a2x2 +a3x3 +...
is given by the formula
R =
1
limsupk→∞
kp
|ak|
.
Exercise 387 Show that the radius of convergence of the series
a0 +a1x+a2x2 +a3x3 +...
is the same as the radius of convergence of the formally differentiated series
a1 +2a2x+3a3x2 +4a4x3 +....
Exercise 388 Show that the radius of convergence of the series
a0 +a1x+a2x2 +a3x3 +...
is the same as the radius of convergence of the formally integrated series
a0x+a1x2/2+a2x3/3+a3x4/4+....
Answer
Exercise 389 (ratio test for power series) Show that the radius of convergence of the series
a0 +a1x+a2x2 +a3x3 +...
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.8. INTEGRATION OF POWER SERIES
123
is given by the formula
R = lim
k→∞
¯¯¯¯
ak
ak+1
¯¯¯¯,
assuming that this limit exists or equals ∞.
Answer
Exercise 390 (ratio/root test for power series) Give an example of a power series for which the radius of convergence
R satisﬁes
R =
1
limk→∞
kp
|ak|
but
lim
k→∞
¯¯¯¯
ak
ak+1
¯¯¯¯
does not exist.
Answer
Exercise 391 (ratio test for power series) Give an example of a power series for which the radius of convergence R
satisﬁes
liminf
k→∞
¯¯¯¯
ak+1
ak
¯¯¯¯ < R < limsup
k→∞
¯¯¯¯
ak+1
ak
¯¯¯¯.
Note: for such a series the ratio test cannot give a satisfactory estimate of the radius of convergence.
Answer
Exercise 392 If the coefﬁcients {ak} of a power series
a0 +a1x+a2x2 +a3x3 +...
form a bounded sequence show that the radius of convergence is at least 1.
Answer
Exercise 393 If the coefﬁcients {ak} of a power series
a0 +a1x+a2x2 +a3x3 +...
form an unbounded sequence show that the radius of convergence is no more than 1.
Answer
Exercise 394 If the power series
a0 +a1x+a2x2 +a3x3 +...
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

124
CHAPTER 3. THE DEFINITE INTEGRAL
has a radius of convergence Ra and the power series
b0 +b1x+b2x2 +b3x3 +...
has a radius of convergence Rb and |ak| ≤|bk| for all k sufﬁciently large, what relation must hold between Ra and Rb?
Answer
Exercise 395 If the power series
a0 +a1x+a2x2 +a3x3 +...
has a radius of convergence R, what must be the radius of convergence of the series
a0 +a1x2 +a2x4 +a3x6 +...
Answer
Exercise 396 Suppose that the series
a0 +a1x+a2x2 +a3x3 +...
has a ﬁnite radius of convergence R and suppose that |x0| > R. Show that, not only does
a0 +a1x0 +a2x2
0 +a3x3
0 +...
diverge but that limn→∞|anxn
0| = ∞.
Exercise 397 Suppose that the series
a0 +a1x+a2x2 +a3x3 +...
has a positive radius of convergence R. Use the Weierstrass M-test to show that the series converges uniformly on any
closed, bounded subinterval [a,b] ⊂(−R,R).
Exercise 398 Suppose that the series
f(x) = a0 +a1x+a2x2 +a3x3 +...
has a positive radius of convergence R. Use Exercise 397 to show that f is differentiable on (−R,R) and that, for all x
in that interval,
f ′(x) = a1 +2a2x+3a3x2 +4a4x3 +....
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.8. INTEGRATION OF POWER SERIES
125
Exercise 399 Suppose that the series
f(x) = a0 +a1x+a2x2 +a3x3 +...
has a positive radius of convergence R. Use Exercise 398 to show that f has an indeﬁnite integral on (−R,R) given by
the function
F(x) = a0x+a1x2/2+a2x3/3+a3x4/4+....
Exercise 400 Suppose that the series
f(x) = a0 +a1x+a2x2 +a3x3 +...
has a positive, ﬁnite radius of convergence R and that the series converges absolutely at one of the two endpoints R or
−R of the interval of convergence. Use the Weierstrass M-test to show that the series converges uniformly on [−R,R].
Deduce from this that f ′ is integrable on [−R,R].
Note: this is the best that the Weierstrass M-test can do applied to power series. If the series converges nonabsolutely at
one of the two endpoints R or −R of the interval then the test does not help.
Answer
Exercise 401 Suppose that the series
f(x) = a0 +a1x+a2x2 +a3x3 +...
has a positive, ﬁnite radius of convergence R and that the series converges nonabsolutely at one of the two endpoints
R or −R of the interval of convergence. Use a variant of the Abel test for uniform convergence to show that the series
converges uniformly on any closed subinterval [a,b] of the interval of convergence. Deduce from this that f ′ is integrable
on any such interval [a,b].
Note: this completes the picture for the integrability problem of this section.
Answer
Exercise 402 What power series will converge uniformly on (−∞,∞)?
Exercise 403 Show that if ∑∞
k=0 akxk converges uniformly on an interval (−r,r), then it must in fact converge uniformly
on [−r,r]. Deduce that if the interval of convergence is exactly of the form (−R,R), or [−R,R) or [−R,R), then the series
cannot converge uniformly on the entire interval of convergence.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

126
CHAPTER 3. THE DEFINITE INTEGRAL
Exercise 404 Suppose that a function f(x) has two power series representations
f(x) = a0 +a1x+a2x2 +a3x3 +...
and
f(x) = b0 +b1x+b2x2 +b3x3 +...
both valid at least in some interval (−r,r) for r > 0. What can you conclude?
Exercise 405 Suppose that a function f(x) has a power series representations
f(x) = a0 +a1x+a2x2 +a3x3 +...
valid at least in some interval (−r,r) for r > 0. Show that, for each k = 0,1,2,3,...,
ak = f (k)(0)
k!
.
Exercise 406 In view of Exercise 405 it would seem that we must have the formula
f(x) =
∞
∑
k=0
f (k)(0)
k!
xk
provided only that the function f is inﬁnitely often differentiable at x = 0. Is this a correct observation?
Answer
3.9
Applications of the integral
It would be presumptuous to try to teach here applications of the integral, since those applications are nearly unlimited.
But here are a few that follow a simple theme and are traditionally taught in all calculus courses.
The theme takes advantage of the fact that an integral can (under certain hypotheses) be approximated by a Riemann
sum
Z b
a f(x)dx ≈
n
∑
i=1
f(ξi)(xi −xi−1).
If there is an application where some concept can be expressed as a limiting version of sums of this type, then that
concept can be captured by an integral. Whatever the concept is, it must be necessarily “additive” and expressible as
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.9. APPLICATIONS OF THE INTEGRAL
127
sums of products that can be interpreted as
f(ξi)×(xi −xi−1).
The simplest illustration is area. We normally think of area as additive. We can interpret the product
f(ξi)×(xi −xi−1).
as the area of a rectangle with length (xi −xi−1) and height f(ξi). The Riemann sum itself then is a sum of areas
of rectangles. If we can determine that the area of some ﬁgure is approximated by such a sum, then the area can be
described completely by an integral.
For applications in physics one might use t as a time variable and then interpret
Z b
a f(t)dt ≈
n
∑
i=1
f(τi)(ti −ti−1)
thinking of f(τi) as some measurement (e.g., velocity, acceleration, force) that is occurring throughout the time interval
[ti−1,ti].
An accumulation point of view
For many applications of the calculus the Riemann sum approach is an attractive way
of expressing the concepts that arise as a deﬁnite integral. There is another way which bypasses Riemann sums and goes
directly back to the deﬁnition of the integral as an antiderivative.
We can write this method using the slogan
Z x+h
a
f(t)dt −
Z x
a f(t)dt ≈f(ξ)×h.
(3.11)
Suppose that a concept we are trying to measure can be captured by a function A(x) on some interval [a,b]. We suppose
that we have already measured A(x) and now wish to add on a bit more to get to A(x+h) where h is small. We imagine
the new amount that we must add on can be expressed as
f(ξ)×h
thinking of f(ξ) as some measurement that is occurring throughout the interval [x,x+h]. In that case our model for the
concept is the integral
R b
a f(t)dt. This is because (3.11) suggests that A′(x) = f(x).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

128
CHAPTER 3. THE DEFINITE INTEGRAL
3.9.1
Area and the method of exhaustion
There is a long historical and cultural connection between the theory of integration and the geometrical theory of area.
Usually one takes the following as the primary deﬁnition of area.
Deﬁnition 3.47 Let f : [a,b] →R be an integrable, nonnegative function and sup-
pose that R(f,a,b) denotes the region in the plane bounded on the left by the line
x = a, on the right by the line x = b, on the bottom by the line y = 0 and on the top
by the graph of the function f (i.e., by y = f(x)). Then this region is said to have
an area and value of that area is assigned to be
Z b
a f(x)dx.
The region can also be described by writing it as a set of points:
R(f,a,b) = {(x,y) : a ≤x ≤b, 0 ≤y ≤f(x)}.
We can justify this deﬁnition by the method of Riemann sums combined with a method of the ancient Greeks known as
the method of exhaustion of areas.
Let us suppose that f : [a,b] →R is a uniformly continuous, nonnegative function and suppose that R(f,a,b) is the
region as described above. Take any subdivision
a = x0 < x1 < x2 < ··· < xn−1 < xn = b
Then there must exist points ξi, ηi ∈[xi−1,xi] for i = 1,2,...,n so that f(ξi) is the maximum value of f in the interval
[xi−1,xi] and f(ηi) is the minimum value of f in that interval. We consider the two partitions
{([xi,xi−1],ξi) : i = 1,2,...n} and {([xi,xi−1],ηi) : i = 1,2,...n}
and the two corresponding Riemann sums
n
∑
i=1
f(ξi)(xi −xi−1) and
n
∑
i=1
f(ηi)(xi −xi−1).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.9. APPLICATIONS OF THE INTEGRAL
129
The larger sum is greater than the integral
R b
a f(x)dx and the smaller sum is lesser than that number. This is because
there is a choice of points ξ∗
i that is exactly equal to the integral,
Z b
a f(x)dx =
n
∑
i=1
f(ξ∗
i )(xi −xi−1)
and here we have f(ηi) ≤f(ξ∗
i ) ≤f(ξi). (See Section 3.3.1.)
But if the region were to have an “area” we would expect that area is also between these two sums. That is because
the larger sum represents the area of a collection of n rectangles that include our region and the smaller sum represents
the area of a collection of n rectangles that are included inside our region. If we consider all possible subdivisions then
the same situation holds: the area of the region (if it has one) must lie between the upper sums and the lower sums. But
according to Theorem 3.17 the only number with this property is the integral
R b
a f(x)dx itself.
Certainly then, for continuous functions anyway, this deﬁnition of the area of such a region would be compatible
with any other theory of area.
Exercise 407 (an accumulation argument) Here is another way to argue that integration theory and area theory must
be closely related. Imagine that area has some (at the moment) vague meaning to you. Let f : [a,b] →R be a uniformly
continuous, nonnegative function. For any a ≤s < t ≤b let A(f,s,t) denote the area of the region in the plane bounded
on the left by the line x = s, on the right by the line x = t, on the bottom by the line y = 0 and on the top by the curve
y = f(x). Argue for each of the following statements:
1. A(f,a,s)+A(f,s,t) = A(f,a,t).
2. If m ≤f(x) ≤M for all s ≤x ≤t then m(t −s) ≤A(f,s,t) ≤M(t −s).
3. At any point a < x < b,
d
dxA(f,a,x) = f(x).
4. At any point a < x < b,
A(f,a,x) =
Z x
a f(t)dt.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

130
CHAPTER 3. THE DEFINITE INTEGRAL
Exercise 408 Show that the area of the triangle
{(x,y) : a ≤x ≤b, 0 ≤y ≤m(x−a)}.
is exactly as you would normally have computed it precalculus.
Exercise 409 Show that the area of the trapezium
{(x,y) : a ≤x ≤b, 0 ≤y ≤c+m(x−a)}.
is exactly as you would normally have computed it precalculus.
Exercise 410 Show that the area of the half-circle
{(x,y) : −1 ≤x ≤1, 0 ≤y ≤
p
1−x2}.
is exactly as you would normally have computed it precalculus.
Answer
Exercise 411 One usually takes this deﬁnition for the area between two curves:
Deﬁnition 3.48 Let f, g : [a,b] →R be integrable functions and suppose that
f(x) ≥g(x) for all a ≤x ≤b. Let R( f,g,a,b) denote the region in the plane
bounded on the left by the line x = a, on the right by the line x = b, on the bottom
by the curve y = g(x) and on the top by the curve by y = f(x). Then this region is
said to have an area and value of that area is assigned to be
Z b
a [ f(x)−g(x)]dx.
Use this deﬁnition to ﬁnd the area inside the circle x2 +y2 = r2.
Answer
Exercise 412 Using Deﬁnition 3.48 compute the area between the graphs of the functions g(x) = 1+x2 and h(x) = 2x2
on [0,1]. Explain why the Riemann sum
n
∑
i=1
[g(ξi)−h(ξi)](xi −xi−1)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.9. APPLICATIONS OF THE INTEGRAL
131
1 2
4
8b
1
Figure 3.4: Computation of an area by
Z ∞
1 x−2 dx.
and the corresponding integral
R 1
0 [g(x)−h(x)]dx cannot be interpreted using the method of exhaustion to be computing
both upper and lower bounds for this area. Discuss.
Answer
Exercise 413 In Figure 3.4 we show graphically how to interpret the area that is represented by
R ∞
1 x−2 dx. Note that
Z 2
1 x−2 dx = 1/2,
Z 4
2 x−2 dx = 1/4,
Z 8
4 x−2 dx = 1/8
and so we would expect
Z ∞
1 x−2 dx = 1/2+1/4+1/8+....
Check that this is true.
Answer
3.9.2
Volume
A full treatment of the problem of deﬁning and calculating volumes is outside the scope of a calculus course that focusses
only on integrals of this type:
Z b
a f(x)dx.
But if the problem addresses a very special type of volume, those volumes obtained by rotating a curve about some line,
then often the formula
π
Z b
a [ f(x)]2 dx
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

132
CHAPTER 3. THE DEFINITE INTEGRAL
Figure 3.5: sinx rotated around the x-axis.
can be interpreted as providing the correct volume interpretation and computation.
Once again the justiﬁcation is the method of exhaustion. We assume that volumes, like areas, are additive. We
assume that a correct computation of the volume of cylinder that has radius r and height h is πr2h. In particular the
volume of a cylinder that has radius f(ξi) and height (xi −xi−1) is
π[f(ξi)]2(xi −xi−1).
The total volume for a collection of such cylinders would be (since we assume volume is additive)
π
n
∑
i=1
[ f(ξi)]2(xi −xi−1).
We then have a connection with the formula
π
Z b
a [ f(x)]2 dx.
One example with suitable pictures illustrates the method. Take the graph of the function f(x) = sinx on the interval
[0,π] and rotate it (into three dimensional space) around the x-axis. Figure 3.5 shows the football (i.e., American football)
shaped object.
Subdivide the interval [0,π],
0 = x0 < x1 < x2 < ··· < xn−1 < xn = π
Then there must exist points ξi, ηi ∈[xi−1,xi] for i = 1,2,...,n so that sin(ξi) is the maximum value of sinx in the interval
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.9. APPLICATIONS OF THE INTEGRAL
133
[xi−1,xi] and sin(ηi) is the minimum value of sinx in that interval. We consider the two partitions
{([xi,xi−1],ξi) : i = 1,2,...n} and {([xi,xi−1],ηi) : i = 1,2,...n}
and the two corresponding Riemann sums
π
n
∑
i=1
sin2(ξi)(xi −xi−1) and π
n
∑
i=1
sin2(ηi)(xi −xi−1).
The “football” is entirely contained inside the cylinders representing the ﬁrst sum and the cylinders representing the
second sum are entirely inside the football.
There is only one value that lies between these sums for all possible choice of partition, namely the number
π
Z π
0 [sinx]2 dx.
We know this because this integral can be uniformly approximated by Riemann sums. The method of exhaustion then
claims that the volume of the football must be this number.
In general this argument justiﬁes the following working deﬁnition. This is the analogue for volumes of revolution of
Deﬁnition 3.48 .
Deﬁnition 3.49 Let f and g be continuous, nonnegative functions on an interval
[a,b] and suppose that g(x) ≤f(x) for all a ≤x ≤b. Then the volume of the solid
obtained by rotating the region between the two curves y = f(x) and y = g(x) about
the x-axis is given by
π
Z b
a
¡
[ f(x)]2 −[g(x)]2¢
dx.
Exercise 414 (shell method) There is a similar formula for a volume of revolution when the curve y = f(x) on [a,b]
(with a < 0) is rotated about the y-axis. One can either readjust by interchanging x and y to get a formula of the form
π
R d
c [g(y)]2 dy or use the so-called shell method that has a formula
2π
Z b
a x×hdx
where h is a height measurement in the shell method. Investigate.
Exercise 415 (surface area) If a nonnegative function y = f(x) is continuously differentiable throughout the interval
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

134
CHAPTER 3. THE DEFINITE INTEGRAL
[a,b], then the formula for the area of the surface generated by revolving the curve about the x-axis is generally claimed
to be
π
Z b
a 2 f(x)
q
1+[ f ′(x)]2 dx.
Using the same football studied in this section how could you justify this formula.
3.9.3
Length of a curve
In mathematics a curve [sometimes called a parametric curve] is a pair of uniformly continuous functions F, G deﬁned
on an interval [a,b]. The points (F(t),G(t)) in the plane are considered to trace out the curve as t moves from the
endpoint a to the endpoint b. The curve is thought of as a mapping taking points in the interval [a,b] to corresponding
points in the plane.
Elementary courses often express the curve this way,
x = F(t), y = G(t) a ≤t ≤b,
referring to the two equations as parametric equations for the curve and to the variable t as a parameter.
The set of points
{(x,y) : x = F(t), y = G(t),a ≤t ≤b}
is called the graph of the curve. It is not the curve itself but, for novices, it may be difﬁcult to make this distinction. The
curve is thought to be oriented in the sense that as t moves in its positive direction [i.e., from a to b] the curve is traced
out in that order. Any point on the curve may be covered many times by the curve itself; the curve can cross itself or be
very complicated indeed, even though the graph might be simple.
For example, take any continuous function F on [0,1] with F(0) = 0 and F(1) = 1 and 0 ≤F(x) ≤1 for 0 ≤x ≤1.
Then the curve (F(t),F(t)) traces out the points on the line connecting (0,0) to (1,1). But the points can be traced and
retraced many times and the “trip” itself may have inﬁnite length. All this even though the line segment itself is simple
and short (it has length
√
2).
The length of a curve is deﬁned by estimating the length of the route taken by the curve by approximating its length
by a polygonal path. Subdivide the interval
a = t0 < t1 < t2 < ··· < tn−1 < tn = b
and then just compute the length of a trip to visit each of the points (F(a),G(a)), (F(t1),G(t1)), (F(t2),G(t2)), . . . ,
(F(b),G(a)) in that order. The deﬁnition should resemble our deﬁnition of a function of bounded variation and, indeed,
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.9. APPLICATIONS OF THE INTEGRAL
135
the two ideas are very closely related.
Deﬁnition 3.50 (rectiﬁable curve) A curve give by a pair of functions F, G :
[a,b] →R is said to be rectiﬁable if there is a number M so that
n
∑
i=1
q
[F(ti)−F(ti−1)]2 +[G(ti)−G(ti−1)]2 ≤M
for all choices of points
a = t0 < t1 < t2 < ··· < tn−1 < tn = b.
The least such number M is called the length of the curve.
Exercise 416 Show that a curve given by a pair of uniformly continuous functions F, G : [a,b] →R is rectiﬁable if and
only if both functions F and G have bounded variation on [a,b]. Obtain, moreover, that the length L of the curve must
satisfy
max{V(F,[a,b]),V(G,[a,b])} ≤L ≤V(F,[a,b])+V(G,[a,b]).
Answer
Exercise 417 Prove the following theorem which supplies the familiar integral formula for the length of a curve.
Theorem 3.51 Suppose that a curve is given by a pair of uniformly continuous
functions F, G : [a,b] →R and suppose that both F and G have bounded, continu-
ous derivatives at every point of (a,b) with possibly ﬁnitely many exceptions. Then
the curve is rectiﬁable and, moreover, the length L of the curve must satisfy
L =
Z b
a
q
[F′(t)]2 +[G′(t)]2 dt.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

136
CHAPTER 3. THE DEFINITE INTEGRAL
Exercise 418 Take any continuous function F on [0,1] with F(0) = 0 and F(1) = 1 and 0 ≤F(x)1 ≤for 0 ≤x ≤1.
Then the curve (F(t),F(t)) traces out the points on the line segment connecting (0,0) to (1,1). Why does the graph of
the curve contain all points on the line segment?
Answer
Exercise 419 Find an example of a continuous function F on [0,1] with F(0) = 0 and F(1) = 1 and 0 ≤F(x)1 ≤for
0 ≤x ≤1 such that the curve (F(t),F(t)) has inﬁnite length. Can you ﬁnd an example where the length is 2? Can you
ﬁnd one where the length is 1?. Which choices will have length equal to
√
2 which is, after all, the actual length of the
graph of the curve?
Exercise 420 A curve in three dimensional space is a triple of uniformly continuous functions (F(t),G(t),H(t)) deﬁned
on an interval [a,b]. Generalize to the theory of such curves the notions presented in this section for curves in the
plane.
Exercise 421 The graph of a uniformly continuous function f : [a,b] →R may be considered a curve in this sense using
the pair of functions F(t) = t, G(t) = f(t) for a ≤t ≤b. This curve has for its graph precisely the graph of the function,
i.e., the set
{(x,y) : y = f(x) a ≤x ≤b}.
Under this interpretation the graph of the function has a length if this curve has a length. Discuss.
Answer
Exercise 422 Find the length of the graph of the function
f(x) = 1
2(ex +e−x), 0 ≤x ≤2.
[The answer is 1
2(e2 −e−2). This is a typical question in a calculus course, chosen not because the curve is of great
interest, but because it is one of the very few examples that can be computed by hand.]
Answer
3.10
Numerical methods
This is a big subject with many ideas and many pitfalls. As a calculus student you are mainly [but check with your
instructor] responsible for learning a few standard methods, eg., the trapezoidal rule and Simpson’s rule.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.10. NUMERICAL METHODS
137
In any practical situation where numbers are needed how might we compute
Z b
a f(x)dx?
The computation of any integral would seem (judging by the deﬁnition) to require ﬁrst obtaining an indeﬁnite integral
F [checking to see it is continuous, of course, and that F′(x) = f(x) at all but ﬁnitely many points in (a,b)]. Then the
formula
Z b
a f(x)dx = F(b)−F(a)
would give the precise value.
But ﬁnding an indeﬁnite integral may be impractical. There must be an indeﬁnite integral if the integral exists, but
that does not mean that it must be given by an accessible formula or that we would have the skills to ﬁnd it. The history
of our subject is very long so many problems have already been solved but ﬁnding antiderivatives is most often not the
best method even when it is possible to carry it out.
Finding a close enough value for
R b
a f(x)dx may be considerably easier and less time consuming than ﬁnding an
indeﬁnite integral. The former is just a number, the latter is a function, possibly mysterious.
Just use Riemann sums?
If we have no knowledge whatever about the function f beyond the fact that it is bounded
and continuous mostly everywhere then to estimate
R b
a f(x)dx we could simply use Riemann sums. Divide the interval
[a,b] into pieces of equal length h
a < a+h < a+2h < a+3h < a+(n−1)h < b.
Here there are n−1 pieces of equal length and the last piece, the nth piece, has (perhaps) smaller length
b−(a+(n−1)h ≤h.
Then
Z b
a f(x)dx ≈[ f(ξ1)+ f(ξ2)+... f(ξn−1)]h+ f(ξn)[b−(a+(n−1)h].
We do know that, for small enough h, the approximation is as close as we please to the actual value. And we can estimate
the error if we know the oscillation of the function in each of these intervals.
If we were to use this in practise then the computation is simpler if we choose always ξi as an endpoint of the
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

138
CHAPTER 3. THE DEFINITE INTEGRAL
corresponding interval and we choose for h only lengths (b−a)/n so that all the pieces have equal length. The methods
that follow are better for functions that arise in real applications, but if we want a method that works for all continuous
functions, there is no guarantee that any other method would surpass this very naive method.
Trapezoidal rule
Here is the (current) Wikipedia statement of the rule:
In mathematics, the trapezoidal rule (also known as the trapezoid rule, or the trapezium rule in British
English) is a way to approximately calculate the deﬁnite integral
Z b
a f(x)dx.
The trapezoidal rule works by approximating the region under the graph of the function f(x) by a trapezoid
and calculating its area. It follows that
Z b
a f(x)dx ≈(b−a) f(a)+ f(b)
2
.
To calculate this integral more accurately, one ﬁrst splits the interval of integration [a,b] into n smaller
subintervals, and then applies the trapezoidal rule on each of them. One obtains the composite trapezoidal
rule:
Z b
a f(x)dx ≈b−a
n
"
f(a)+ f(b)
2
+
n−1
∑
k=1
f
µ
a+kb−a
n
¶#
.
This can alternatively be written as:
Z b
a f(x)dx ≈b−a
2n (f(x0)+2 f(x1)+2 f(x2)+···+2 f(xn−1)+ f(xn))
where
xk = a+kb−a
n
, for k = 0,1,...,n
The error of the composite trapezoidal rule is the difference between the value of the integral and the nu-
merical result:
error =
Z b
a f(x)dx−b−a
n
"
f(a)+ f(b)
2
+
n−1
∑
k=1
f
µ
a+kb−a
n
¶#
.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.10. NUMERICAL METHODS
139
This error can be written as
error = −(b−a)3
12n2
f ′′(ξ),
where ξ is some number between a and b.
It follows that if the integrand is concave up (and thus has a positive second derivative), then the error is
negative and the trapezoidal rule overestimates the true value. This can also been seen from the geometric
picture: the trapezoids include all of the area under the curve and extend over it. Similarly, a concave-
down function yields an underestimate because area is unaccounted for under the curve, but none is counted
above. If the interval of the integral being approximated includes an inﬂection point, then the error is harder
to identify.
Simpson’s rule
Simpson’s rule is another method for numerical approximation of deﬁnite integrals. The approxima-
tion on a single interval uses the endpoints and the midpoint. In place of a trapezoidal approximation, an approximation
using quadratics produces:
Z b
a f(x)dx ≈b−a
6
·
f(a)+4 f
µa+b
2
¶
+ f(b)
¸
.
It is named after the English mathematician Thomas Simpson (1710–1761). An extended version of the rule for f(x)
tabulated at 2n evenly spaced points a distance h apart,
a = x0 < x1 < ··· < x2n = b
is
Z x2n
x0
f(x)dx = h
3[ f0 +4(f1 + f3 +...+ f2n−1)+2(f2 + f4 +...+ f2n−2)+ f2n]−Rn,
where fi = f(xi) and where the remainder term is
Rn = nh5 f ′′′′(ξ)
90
for some ξ ∈[x0,x2n].
Exercise 423 Show that the trapezoidal rule can be interpreted as asserting that a reasonable computation of the mean
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

140
CHAPTER 3. THE DEFINITE INTEGRAL
value of a function on an interval,
1
b−a
Z b
a f(x)dx,
is simply to average the values of the function at the two endpoints.
Answer
Exercise 424 Establish the identity
Z b
a f(x)dx = f(a)+ f(b)
2
(b−a)−1
2
Z b
a (x−a)(b−x)f ′′(x)dx
under suitable hypotheses on f.
Answer
Exercise 425 Establish the identity
Z b
a f(x)dx−f(a)+ f(b)
2
(b−a) = −(b−a)3 f ′′(ξ)
12
for some point a < ξ < b, under suitable hypotheses on f.
Answer
Exercise 426 Establish the inequality
¯¯¯¯
Z b
a f(x)dx−f(a)+ f(b)
2
(b−a)
¯¯¯¯ ≤(b−a)2
8
Z b
a | f ′′(x)|dx.
under suitable hypotheses on f.
Answer
Exercise 427 Prove the following theorem and use it to provide the estimate for the error given in the text for an
application of the trapezoidal rule.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.10. NUMERICAL METHODS
141
Theorem 3.52 Suppose that f is twice continuously differentiable at all points of
the interval [a,b]. Let
Tn = b−a
n
"
f(a)+ f(b)
2
+
n−1
∑
k=1
f
µ
a+kb−a
n
¶#
denote the usual trapezoidal sum for f. Then
Z b
a f(x)dx−Tn = −
n
∑
k=1
(b−a)3
12n3
f ′′(ξi)
for appropriately chosen points ξi in each interval
[xi−1,xi] =
·
a+ (i−1)(b−a)
n
,a+ i(b−a)
n
¸
(i = 1,2,3,...,n)
Answer
Exercise 428 Prove the following theorem which elaborates on the error in the trapezoidal rule.
Theorem 3.53 Suppose that f is twice continuously differentiable at all points of
the interval [a,b]. Let
Tn = b−a
n
"
f(a)+ f(b)
2
+
n−1
∑
k=1
f
µ
a+kb−a
n
¶#
denote the usual trapezoidal sum for f. Show that the error term for using Tn to
estimate
R b
a f(x)dx is approximately
−(b−a)2
12n2
[ f ′(b)−f ′(a)].
Answer
Exercise 429 The integral
Z 1
0 ex2 dx = 1.462651746
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

142
CHAPTER 3. THE DEFINITE INTEGRAL
is correct to nine decimal places. The trapezoidal rule, for n = 1,2 would give
Z 1
0 ex2 dx ≈e0 +e1
2
= 1.859140914
and
Z 1
0 ex2 dx ≈e0 +2e1/2 +e1
4
= 1.753931093.
At what stage in the trapezoidal rule would the approximation be correct to nine decimal places?
Answer
3.10.1
Maple methods
With the advent of computer algebra packages like Maple and Mathematica one does not need to gain any expertise in
computation to perform deﬁnite and indeﬁnite integration. The reason, then, why we still drill our students on these
methods is to produce an intelligent and informed user of mathematics. To illustrate here is a short Maple session on a
unix computer named dogwood. After giving the maple command we are in Maple and have asked it to do some calculus
questions for us. Speciﬁcally we are seeking
Z
x2 dx,
Z 2
0 x2/dx,
Z
sin(4x)dx, and
Z
x[3x2 +2]5/3 dx.
All of these can be determined by hand using the standard methods taught for generations in calculus courses. Note that
Maple is indifferent to our requirement that constants of integration should always be speciﬁed or that the interval of
indeﬁnite integration should be acknowledged.
[31]dogwood% maple
|\^/|
Maple 12 (SUN SPARC SOLARIS)
._|\|
|/|_. Copyright (c) Maplesoft, a division of Waterloo Maple Inc. 2008
\
MAPLE
/
All rights reserved. Maple is a trademark of
<____ ____>
Waterloo Maple Inc.
|
Type ? for help.
> int(x^2,x);
3
x
----
3
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.10. NUMERICAL METHODS
143
> int(x^2,x=0..2);
8/3
>
int(sin(4*x),x);
-1/4 cos(4 x)
>
int(x*(3*x^2+2)^(5/3),x);
2
8/3
(3 x
+ 2)
-------------
16
If we go on to ask problems that would not normally be asked on a calculus examination then the answer may be
more surprising. There is no simple expression of the indeﬁnite integral
R cosx3 dx and consequently Maple will not ﬁnd
a method. The ﬁrst try to obtain a precise value for
R 1
0 cosx3 dx produces
> int(cos(x^3),x=0..1);
memory used=3.8MB, alloc=3.0MB, time=0.36
memory used=7.6MB, alloc=5.4MB, time=0.77
/
2/3
2/3
1/2
(1/3) |
2
sin(1)
2 2
(-3/2 cos(1) + 3/2 sin(1))
1/6 Pi
2
|30/7 ----------- - ---------------------------------
|
1/2
1/2
\
Pi
Pi
2/3
2/3
\
2
sin(1) LommelS1(11/6, 3/2, 1)
3 2
(cos(1) - sin(1)) LommelS1(5/6, 1/2, 1)|
- 9/7 ---------------------------------- - ----------------------------------------------|
1/2
1/2
|
Pi
Pi
/
The second try asks Maple to give a numerical approximation. Maple uses a numerical integration routine with
automatic error control to evaluate deﬁnite integrals that it cannot do analytically.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

144
CHAPTER 3. THE DEFINITE INTEGRAL
> evalf(int(cos(x^3),x=0..1));
0.9317044407
Thus we can be assured that
R 1
0 cosx3 dx = 0.9317044407 correct to 10 decimal places.
In short, with access to such computer methods, we can be sure that our time in studying integration theory is best
spent on learning the theory so that we will understand what we are doing when we ask a computer to make calculations
for us.
3.10.2
Maple and inﬁnite integrals
For numerical computations of inﬁnite integrals one can again turn to computer algebra packages. Here is a short Maple
session that computes the inﬁnite integrals
Z ∞
0 e−x dx,
Z ∞
0 xe−x dx,
Z ∞
0 x3e−x dx, and
Z ∞
0 x10e−x dx.
We have all the tools to do these by hand, but computer methods are rather faster.
[32]dogwood% maple
|\^/|
Maple 12 (SUN SPARC SOLARIS)
._|\|
|/|_. Copyright (c) Maplesoft, a division of Waterloo Maple Inc. 2008
\
MAPLE
/
All rights reserved. Maple is a trademark of
<____ ____>
Waterloo Maple Inc.
|
Type ? for help.
> int( exp(-x), x=0..infinity );
1
> int(x* exp(-x), x=0..infinity );
1
> int(x^3* exp(-x), x=0..infinity );
6
> int(x^10* exp(-x), x=0..infinity );
3628800
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

3.11. MORE EXERCISES
145
Exercise 430 Show that
Z ∞
0 xne−x dx = n!.
Answer
3.11
More Exercises
Exercise 431 If f is continuous on an interval [a,b] and
Z b
a f(x)g(x)dx = 0
for every continuous function g on [a,b] show that f is identically equal to zero there.
Exercise 432 ( (Cauchy-Schwarz inequality)) If f and g are continuous on an interval [a,b] show that
µZ b
a f(x)g(x)dx
¶2
≤
µZ b
a [ f(x)]2 dx
¶µZ b
a [g(x)]2 dx
¶
.
Answer
Exercise 433 In elementary calculus classes it is sometimes convenient to deﬁne the natural logarithm by using the
integration theory,
logx =
Z x
1 dx.
Taking this as a deﬁnition, not a computation, use the properties of integrals to develop the properties of the logarithm
function.
Answer
Exercise 434 Let f be a continuous function on [1,∞) such that limx→∞f(x) = α. Show that if the integral
R ∞
1 f(x)dx
converges, then α must be 0.
Exercise 435 Let f be a continuous function on [1,∞) such that the integral
R ∞
1 f(x)dx converges. Can you conclude
that limx→∞f(x) = 0?
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

146
CHAPTER 3. THE DEFINITE INTEGRAL
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

Chapter 4
Beyond the calculus integral
Our goal in this chapter is to develop the modern integral by allowing more functions to be integrated. We still insist on
the viewpoint that
Z b
a F′(x)dx = F(b)−F(a)
but we wish to relax our assumptions to allow this formula to hold even when there are inﬁnitely many points of
nondifferentiability of F. There may seem not too much point in allowing more functions to be integrated, except
perhaps when one encounters a function without an integral where one seems to be needed.
But, in fact, the theory itself demands it. Too many processes of analysis lead from integrable functions [in the
calculus sense] to functions for which a broader theory of integration is required. The modern theory is an indispensable
tool of analysis and its theory is elegant and complete.
Remember that, for the calculus integral, an integrable function f must have an indeﬁnite integral F for which
F′(x) = f(x) at every point of an interval with ﬁnitely many exceptions. The path to generalization is to allow inﬁnitely
many exceptional points where the derivative F′(x) may not exist or may not agree with f(x).
Although we will allow an inﬁnite set, we cannot allow too large a set of exceptions. In addition, as we will ﬁnd, we
must impose some restrictions on the function F if we do allow an inﬁnite set of exceptions. Those two ideas will drive
the theory.
147
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

148
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
4.1
Countable sets
The ﬁrst notion, historically, of a concept that captures the smallness of an inﬁnite set is due to Cantor.
Deﬁnition 4.1 A set of real numbers is countable if there is a sequence of real
numbers r1, r2, r3, . . . that contains every element of the set.
Exercise 436 Prove that the empty set is countable.
Answer
Exercise 437 Prove that every ﬁnite set is countable.
Answer
Exercise 438 Prove that every subset of a countable set is countable.
Answer
Exercise 439 Prove that the set of all integers (positive, negative or zero) is countable.
Answer
Exercise 440 Prove that the set of all rational numbers is countable.
Answer
Exercise 441 Prove that the union of two countable sets is countable.
Answer
Exercise 442 Prove that the union of a sequence of countable sets is countable.
Answer
Exercise 443 Suppose that F : (a,b) →R is a monotonic, nondecreasing function. Show that such a function may have
many points of discontinuity but that the collection of all points where F is not continuous is countable.
Answer
Exercise 444 If a function F : (a,b) →R has a right-hand derivative and a left-hand derivative at a point x0 and the
derivatives on the two sides are different, then that point is said to be a corner. Show that a function may have many
corners but that the collection of all corners is countable.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.1. COUNTABLE SETS
149
4.1.1
Cantor’s theorem
Your ﬁrst impression might be that few sets would be able to be the range of a sequence. But having seen in Exercise 440
that even the set of rational numbers that is seemingly so large can be listed, it might then appear that all sets can be so
listed. After all, can you conceive of a set that is “larger” than the rationals in some way that would stop it being listed?
The remarkable fact that there are sets that cannot be arranged to form the elements of some sequence was proved by
Georg Cantor (1845–1918).
Theorem 4.2 (Cantor) No interval of real numbers is countable.
The proof is given in the next few exercises.
Exercise 445 Prove that there would exist a countable interval if and only if the open interval (0,1) is itself countable.
Answer
Exercise 446 Prove that the open interval (0,1) is not countable, using (as Cantor himself did) properties of inﬁnite
decimal expansions to construct a proof.
Answer
Exercise 447 Some novices, on reading the proof of Cantor’s theorem, say “Why can’t you just put the number c that
you found at the front of the list.” What is your rejoinder?
Answer
Exercise 448 Give a proof that the interval (a,b) is not countable using the nested sequence of intervals argument.
Answer
Exercise 449 We deﬁne a real number to be algebraic if it is a solution of some polynomial equation
anxn +an−1xn−1 +···+a1x+a0 = 0,
where all the coefﬁcients are integers. Thus
√
2 is algebraic because it is a solution of x2 −2 = 0. The number π is not
algebraic because no such polynomial equation can ever be found (although this is hard to prove). Show that the set of
algebraic numbers is countable.
Answer
Exercise 450 A real number that is not algebraic is said to be transcendental. For example, it is known that e and π are
transcendental. What can you say about the existence of other transcendental numbers?
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

150
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
4.2
Derivatives which vanish outside of countable sets
Our ﬁrst attempt to extend the indeﬁnite and deﬁnite integral to handle a broader class of functions is to introduce a
countable exceptional set into the deﬁnitions. We have used ﬁnite exceptional sets up to this point. This will produce a
more general integral.
The principle is the following: if F is a continuous function on an interval I and if F′(x) = 0 for all but countably
many points in I then F must be constant. The proof has appeared in Section 1.10.5.
Theorem 4.3 Let F : (a,b) →R be a function that is continuous at every point in
an open interval (a,b) and suppose that F′(x) = 0 for all x ∈(a,b) with possibly
countably many exceptions. Then F is a constant function.
4.2.1
Calculus integral [countable set version]
Our original calculus integral was deﬁned in way that was entirely dependent on the simple fact that continuous functions
that have a zero derivative at all but a ﬁnite number of points must be constant. We now know that that continuous
functions that have a zero derivative at all but a countable number of points must also be constant. Thus there is no
reason not to extend the calculus integral to allow a countable exceptional set.
Deﬁnition 4.4 The following describes an extension of our integration theory:
• f is a function deﬁned at each point of a bounded open interval (a,b) with
possibly countably many exceptions.
• f is the derivative of some function in this sense: there exists a uniformly
continuous function F : (a,b) →R with the property that F′(x) = f(x) for
all a < x < b with at most a countable number of exceptions.
• Then the function f is said to be integrable [in the new sense] and the value
of the integral is determined by
Z b
a f(x)dx = F(b−)−F(a+).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.2. DERIVATIVES WHICH VANISH OUTSIDE OF COUNTABLE SETS
151
Zakon’s Analysis text.
There is currently at least one analysis textbook available1that follows exactly this program,
replacing the Riemann integral by the Newton integral (with countably many exceptions):
Mathematical Analysis I, by Elias Zakon, ISBN 1-931705-02-X, published by The Trillia Group, 2004.
355+xii pages, 554 exercises, 26 ﬁgures, hypertextual cross-references, hyperlinked index of terms. Down-
load size: 2088 to 2298 KB, depending on format.
This can be downloaded freely from the web site
www.trillia.com/zakon-analysisI.html
Inexpensive site licences are available for instructors wishing to adopt the text.
Zakon’s text offers a serious analysis course at the pre-measure theory level, and commits itself to the Newton
integral. There are rigorous proofs and the presentation is carried far enough to establish that all regulated2 functions are
integrable in this sense.
Exercise 451 Show that the countable set version of the calculus integral determines a unique value for the integral,
i.e., does not depend on the particular antiderivative F chosen.
Answer
Exercise 452 In Exercise 217 we asked the following:
Deﬁne a function F : [0,1] →R in such a way that F(0) = 0, and for each odd integer n = 1,3,5...,
F(1/n) = 1/n and each even integer n = 2,4,6..., F(1/n) = 0. On the intervals [1/(n + 1),1/n] for
n = 1,2,3, the function is linear. Show that
R b
a F′(x)dx exists as a calculus integral for all 0 < a < b ≤b
but that
R 1
0 F′(x)dx does not.
Show that the new version of the calculus integral would handle this easily.
Answer
1I am indebted to Bradley Lucier, the founder of the Trillia Group, for this reference. The text has been used by him successfully for beginning
graduate students at Purdue.
2Since regulated functions are uniform limits of step functions, it is easy to anticipate how this could be done. Also, regulated functions are
bounded and have only a countable set of points of discontinuity. So our methods would establish integrability in this sense. One could easily
rewrite this text to use the Zakon integral instead of the calculus integral. We won’t.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

152
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
Exercise 453 Show that all bounded functions with a countable number of discontinuities must be integrable in this new
sense.
Answer
Exercise 454 Show that the new version of the integral has a property that the ﬁnite set version of the integral did not
have: if fn is a sequence of functions converging uniformly to a function f on [a,b] and if each fn is integrable on [a,b]
then the function f must be integrable there too.
Exercise 455 Rewrite the text to use the countable set version of the integral rather than the more restrictive ﬁnite set
version.
Answer
Exercise 456 (limitations of the calculus integrals) Find an example of a sequence of nonnegative, integrable func-
tions gk(x) on the interval [0,1] such that such that
∞
∑
k=1
µZ b
a gk(x)dx
¶
is convergent, and yet f = ∑∞
k=1 gk is not integrable in the calculus sense for either the ﬁnite set or countable set version.
[Note: this function should be integrable and the value of this integral should be the sum of the series. The only difﬁculty
is that we cannot integrate enough functions. The Riemann integral has the same defect; the integral introduced later on
does not.
Answer
4.3
Sets of measure zero
We shall go beyond countable sets in our search for a suitable class of small sets. A set is countable if it is small in the
sense of “counting.” This is because we have deﬁned a set to be countable if we can list off the elements of the set in the
same way we list off all the counting numbers (i.e., 1, 2, 3, 4, . . . ).
We introduce a larger class of sets that is small in the sense of measuring; here we mean measuring the same way
that we measure the length of an interval [a,b] by the number b−a.
Our sets of measure zero are deﬁned using subpartitions and very simple Riemann sums. Later on in Part Two we
will ﬁnd several characterizations of this important class of sets.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.3. SETS OF MEASURE ZERO
153
Deﬁnition 4.5 A set N is said to be a set of measure zero if for every ε > 0 and
every point ξ ∈N there is a δ(ξ) > 0 with the following property: whenever a
subpartition
{([ci,di],ξi) : i = 1,2,...,n}
is given with each ξi ∈N and so that
0 < di −ci < δ(ξi) (i = 1,2,...,n)
then
n
∑
i=1
(di −ci) < ε.
Recall that in order for the subset
{([ai,bi],ξi) : i = 1,2,...,n}
to be a subpartition, we require merely that the intervals {[ai,bi]} do not overlap. The collection here is not necessarily
a partition. Our choice of language, calling it a subpartition, indicates that it could be (but won’t be) expanded to be a
partition.
Exercise 457 Show that every ﬁnite set has measure zero.
Answer
Exercise 458 Show that every countable set has measure zero.
Answer
Exercise 459 Show that no interval has measure zero.
Answer
Exercise 460 Show that every subset of a set of measure zero must have measure zero.
Answer
Exercise 461 Show that the union of two sets of measure zero must have measure zero.
Answer
Exercise 462 Show that the union of a sequence of sets of measure zero must have measure zero.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

154
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
Exercise 463 Suppose that {(ak,bk)} is a sequence of open intervals and that
∞
∑
k=1
(bk −ak) < ∞.
If E is a set and every point in E belongs to inﬁnitely many of the intervals {(ak,bk)}, show that E must have measure
zero.
Answer
4.3.1
The Cantor dust
In order to appreciate exactly what we intend by a set of measure zero we shall introduce a classically important example
of such a set: the Cantor ternary set. Mathematicians who are fond of the fractal language call this set the Cantor dust.
This suggestive phrase captures the fact that the Cantor set is indeed truly small even though it is large in the sense of
counting; it is measure zero but uncountable.
We begin with the closed interval [0,1]. From this interval we shall remove a dense open set G. It is easiest to
understand the set G if we construct it in stages. Let G1 =
¡ 1
3, 2
3
¢
, and let K1 = [0,1]\G1. Thus
K1 =
·
0, 1
3
¸
∪
·2
3,1
¸
is what remains when the middle third of the interval [0,1] is removed. This is the ﬁrst stage of our construction.
We repeat this construction on each of the two component intervals of K1. Let G2 =
¡ 1
9, 2
9
¢
∪
¡7
9, 8
9
¢
and let K2 =
[0,1]\(G1 ∪G2). Thus
K2 =
·
0, 1
9
¸
∪
·2
9, 1
3
¸
∪
·2
3, 7
9
¸
∪
·8
9,1
¸
.
This completes the second stage.
We continue inductively, obtaining two sequences of sets, {Kn} and {Gn}. The set K obtained by removing from
[0,1] all of the open sets Gn is called the Cantor set. Because of its construction, it is often called the Cantor middle
third set. In an exercise we shall present a purely arithmetic description of the Cantor set that suggests another common
name for K, the Cantor ternary set. Figure 6.1 shows K1, K2, and K3.
We might mention here that variations in the constructions of K can lead to interesting situations. For example, by
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.3. SETS OF MEASURE ZERO
155
1
0
1
3
2
3
1
9
2
9
7
9
8
9
K1
K2
K3
Figure 4.1: The third stage in the construction of the Cantor ternary set.
changing the construction slightly, we can remove intervals in such a way that
G′ =
∞
[
k=1
(a′
k,b′
k)
with
∞
∑
k=1
(b′
k −a′
k) = 1/2
(instead of 1), while still keeping K′ = [0,1]\ G′ nowhere dense and perfect. The resulting set K′ created problems for
late nineteenth-century mathematicians trying to develop a theory of measure. The “measure” of G′ should be 1/2; the
“measure” of [0,1] should be 1. Intuition requires that the measure of the nowhere dense set K′ should be 1 −1
2 = 1
2.
How can this be when K′ is so “small?”
Exercise 464 We have given explicit statements for K1 and K2,
K1 =
·
0, 1
3
¸
∪
·2
3,1
¸
and
K2 =
·
0, 1
9
¸
∪
·2
9, 1
3
¸
∪
·2
3, 7
9
¸
∪
·8
9,1
¸
.
What is K3?
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

156
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
Exercise 465 Show that if this process is continued inductively, we obtain two sequences of sets, {Kn} and {Gn} with
the following properties: For each natural number n
1. Gn is a union of 2n−1 pairwise disjoint open intervals.
2. Kn is a union of 2n pairwise disjoint closed intervals.
3. Kn = [0,1]\(G1 ∪G2 ∪···∪Gn).
4. Each component of Gn+1 is the “middle third” of some component of Kn.
5. The length of each component of Kn is 1/3n.
Exercise 466 Establish the following observations:
1. G is an open dense set in [0,1].
2. Describe the intervals complementary to the Cantor set.
3. Describe the endpoints of the complementary intervals.
4. Show that the remaining set K = [0,1]\G is closed and nowhere dense in [0,1].
5. Show that K has no isolated points and is nonempty.
6. Show that K is a nonempty, nowhere dense perfect subset of [0,1].
Answer
Exercise 467 Show that each component interval of the set Gn has length 1/3n. Using this, determine that the sum of
the lengths of all component intervals of G, the set removed from [0,1], is 1. Thus it appears that all of the length inside
the interval [0,1] has been removed leaving “nothing” remaining.
Answer
Exercise 468 Show that the Cantor set is a set of measure zero.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.3. SETS OF MEASURE ZERO
157
Exercise 469 Let E be the set of endpoints of intervals complementary to the Cantor set K. Prove that the closure of the
set E is the set K.
Exercise 470 Let G be a dense open subset of real numbers and let {(ak,bk)} be its set of component intervals. Prove
that H = R\G is perfect if and only if no two of these intervals have common endpoints.
Exercise 471 Let K be the Cantor set and let {(ak,bk)} be the sequence of intervals complementary to K in [0,1]. For
each integer k let ck = (ak +bk)/2 (the midpoint of the interval (ak,bk)) and let N be the set of points ck for integers k.
Prove each of the following:
1. Every point of N is isolated.
2. If ci ̸= cj, there exists an integer k such that ck is between ci and cj (i.e., no point in N has an immediate
“neighbor” in N).
Exercise 472 Show that the Cantor dust K can be described arithmetically as the set
{x = .a1a2a3 ... (base three) : ai = 0 or 2 for each i = 1,2,3,...}.
Answer
Exercise 473 Show that the Cantor dust is an uncountable set.
Answer
Exercise 474 Find a speciﬁc irrational number in the Cantor ternary set.
Answer
Exercise 475 Show that the Cantor ternary set can be deﬁned as
K =
(
x ∈[0,1] : x =
∞
∑
n=1
in
3n for in = 0 or 2
)
.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

158
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
Exercise 476 Let
D =
(
x ∈[0,1] : x =
∞
∑
n=1
jn
3n for jn = 0 or 1
)
.
Show that D+D = {x+y : x,y ∈D} = [0,1]. From this deduce, for the Cantor ternary set K, that K +K = [0,2].
Exercise 477 A careless student makes the following argument. Explain the error.
“If G = (a,b), then G = [a,b]. Similarly, if G = S∞
i=1(ai,bi) is an open set, then G = S∞
i=1[ai,bi]. It follows
that an open set G and its closure G differ by at most a countable set. The closure just adds in all the
endpoints.”
Answer
4.4
The Devil’s staircase
The Cantor set allows the construction of a rather bizarre function that is continuous and nondecreasing on the interval
[0,1]. It has the property that it is constant on every interval complementary to the Cantor set and yet manages to increase
from f(0) = 0 to f(1) = 1 by doing all of its increasing on the Cantor set itself. It has sometimes been called “the devil’s
staircase” or simply the Cantor function.
Thus this is an example of a continuous function on the interval [0,1] which has a zero derivative everywhere outside
of the Cantor set. If we were to try to develop a theory of indeﬁnite integration that allows exceptional sets of measure
zero we would have to impose some condition that excludes such functions. We will see that condition in Section 4.5.4.
4.4.1
Construction of Cantor’s function
Deﬁne the function f in the following way. On the open interval ( 1
3, 2
3), let f = 1
2; on the interval (1
9, 2
9), let f = 1
4; on
(7
9, 8
9), let f = 3
4. Proceed inductively. On the 2n−1 open intervals appearing at the nth stage of our construction of the
Cantor set, deﬁne f to satisfy the following conditions:
1. f is constant on each of these intervals.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.4. THE DEVIL’S STAIRCASE
159
- x
6
y
1
1
2
1
4
3
4
1
8
3
8
5
8
7
8
1
1
3
2
3
1
9
2
9
7
9
8
9
Figure 4.2: The third stage in the construction of the Cantor function.
2. f takes the values
1
2n , 3
2n ,..., 2n −1
2n
on these intervals.
3. If x and y are members of different nth-stage intervals with x < y, then f(x) < f(y).
This description deﬁnes f on G = [0,1]\K. Extend f to all of [0,1] by deﬁning f(0) = 0 and, for 0 < x ≤1,
f(x) = sup{ f(t) : t ∈G, t < x}.
Figure 4.2 illustrates the initial stages of the construction. The function f is called the Cantor function. Observe that
f “does all its rising” on the set K.
The Cantor function allows a negative answer to many questions that might be asked about functions and derivatives
and, hence, has become a popular counterexample. For example, let us follow this kind of reasoning. If f is a continuous
function on [0,1] and f ′(x) = 0 for every x ∈(0,1) then f is constant. (This is proved in most calculus courses by using
the mean value theorem.) Now suppose that we know less, that f ′(x) = 0 for every x ∈(0,1) excepting a “small” set E
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

160
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
of points at which we know nothing. If E is ﬁnite it is still easy to show that f must be constant. If E is countable it is
possible, but a bit more difﬁcult, to show that it is still true that f must be constant. The question then arises, just how
small a set E can appear here; that is, what would we have to know about a set E so that we could say f ′(x) = 0 for every
x ∈(0,1)\E implies that f is constant?
The Cantor function is an example of a function constant on every interval complementary to the Cantor set K (and
so with a zero derivative at those points) and yet is not constant. The Cantor set, since it is both measure zero and
nowhere dense, might be viewed as extremely small, but even so it is not insigniﬁcant for this problem.
Exercise 478 In the construction of the Cantor function complete the veriﬁcation of details.
1. Show that f(G) is dense in [0,1].
2. Show that f is nondecreasing on [0,1].
3. Infer from (a) and (b) that f is continuous on [0,1].
4. Show that f(K) = [0,1] and thus (again) conclude that K is uncountable.
Exercise 479 Show that the Cantor function has a zero derivative everywhere on the open set complementary to the
Cantor set in the interval [0,1]. [In more colorful language, we say that this function has a zero derivative almost
everywhere.]
Exercise 480 Each number x in the Cantor set can be written in the form
x =
∞
∑
i=1
23−ni
for some increasing sequence of integers n1 < n2 < n3 < .... Show that the Cantor function assumes the value F(x) =
∑∞
i=1 2−ni at each such point.
Exercise 481 Show that the Cantor function is a monotone, nondecreasing function on [0,1] that has these properties:
1. F(0) = 0,
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.5. FUNCTIONS WITH ZERO VARIATION
161
2. F(x/3) = F(x)/2„
3. F(1−x) = 1−F(x).
[In fact the Cantor function is the only monotone, nondecreasing function on [0,1] that has these three properties.]
Answer
4.5
Functions with zero variation
Sets of measure zero have been deﬁned by requiring certain small sums
n
∑
i=1
(bi −ai)
whenever a subpartition
{([ai,bi],ξi) : i = 1,2,...,n}
is controlled by a function δ(x). We are interested in other variants on this same theme, involving sums of the form
n
∑
i=1
|F(bi)−F(ai)| or
n
∑
i=1
| f(ξi)|(bi −ai) or even
n
∑
i=1
|F(bi)−F(ai)−f(ξi)|(bi −ai)|.
A measurement of the sums
n
∑
i=1
|F(bi)−F(ai)|
taken over nonoverlapping subintervals is considered to compute the variation of the function F. This notion appears in
the early literature and was formalized by Jordan in the late 19th century under the terminology “variation of a function.”
We do not need the actual measurement of variation. What we do need is the notion that a function has zero variation.
This is a function that has only a small change on a set, or whose growth on the set is insubstantial.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

162
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
Deﬁnition 4.6 A function F : (a,b) →R is said to have zero variation on a set
E ⊂(a,b) if for every ε > 0 and every x ∈E there is a δ(x) > 0
n
∑
i=1
|F(bi)−F(ai)| < ε
whenever a subpartition {([ai,bi],ξi) : i = 1,2,...,n} is chosen for which
ξi ∈E ∩[ai,bi] and bi −ai < δ(ξi).
We saw a deﬁnition very similar to this when we deﬁned a set of measure zero. In fact the formal nature of the
deﬁnition is exactly the same as the requirement that a set E should have measure zero. The following exercise makes
this explicit. As we shall discover, all of the familiar functions of the calculus turn out to have zero variation on sets of
measure zero. Only rather pathological examples (notably the Cantor function) do not have this property.
Exercise 482 Show that a set E has measure zero if and only if the function F(x) = x has zero variation on E.
Answer
Exercise 483 Suppose that F : R →R has zero variation on a set E1 and that E2 ⊂E1. Show that then F has zero
variation on E2.
Answer
Exercise 484 Suppose that F : R →R has zero variation on the sets E1 and E2. Show that then F has zero variation on
the union E1 ∪E2.
Answer
Exercise 485 Suppose that F : R →R has zero variation on each member of a sequence of sets E1, E2, E3, . . . . Show
that then F has zero variation on the union S∞
n=1 En.
Answer
Exercise 486 Prove the following theorem that shows another important version of zero variation. We could also de-
scribe this as showing a function has small Riemann sums over sets of measure zero.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.5. FUNCTIONS WITH ZERO VARIATION
163
Theorem 4.7 Let f be deﬁned at every point of a measure zero set N and let ε > 0.
Then for every x ∈N there is a δ(x) > 0 so that
n
∑
i=1
| f(ξi)|(bi −ai) < ε
whenever a subpartition {([ai,bi],ξi) : i = 1,2,...,n} is chosen for which
ξi ∈N ∩[ai,bi] and bi −ai < δ(ξi).
Answer
Exercise 487 Let F be deﬁned on an open interval (a,b) and let f be deﬁned at every point of a measure zero set
N ⊂(a,b). Suppose that F has zero variation on N. Let ε > 0. Show for every x ∈N there is a δ(x) > 0 such that
n
∑
i=1
|F(bi)−F(ai)−f(ξi)(bi −ai)| < ε
whenever a subpartition {([ai,bi],ξi) : i = 1,2,...,n} is chosen for which
Answer
Exercise 488 Let F be deﬁned on an open interval (a,b) and let f be deﬁned at every point of a set E. Suppose that
F′(x) = f(x) for every x ∈E. Let ε > 0. Show for every x ∈E there is a δ(x) > 0 such that
n
∑
i=1
|F(bi)−F(ai)−f(ξi)(bi −ai)| < ε
whenever a subpartition {([ai,bi],ξi) : i = 1,2,...,n} is chosen for which
ξi ∈E ∩[ai,bi] and bi −ai < δ(ξi).
Answer
Exercise 489 Show that the Cantor function has zero variation on the open set complementary to the Cantor set in the
interval [0,1].
Answer
4.5.1
Zero variation lemma
The fundamental growth theorem that we need shows that only constant functions have zero variation on an interval.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

164
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
Theorem 4.8 Suppose that a function F : (a,b) →R has zero variation on the
entire interval (a,b). Then F is constant on that interval.
Exercise 490 Use a Cousin covering argument to prove the theorem.
Answer
Exercise 491 Show that the Cantor function does not have zero variation on the Cantor set.
Answer
4.5.2
Zero derivatives imply zero variation
There is an immediate connection between the derivative and its variation in a set. In the simplest case we see that a
function has zero variation on a set on which it has everywhere a zero derivative.
Theorem 4.9 Suppose that a function F : (a,b) →R has a zero derivative F′(x)
at every point x of a set E ⊂(a,b). Then F has zero variation on E.
Exercise 492 Prove Theorem 4.9 by applying Exercise 488.
Exercise 493 Give a direct proof of Theorem 4.9.
Answer
4.5.3
Continuity and zero variation
There is an intimate and immediate relation between continuity and zero variation.
Theorem 4.10 Suppose F : (a,b) →R. Then F is continuous at a point x0 ∈(a,b)
if and only if F has zero variation on the singleton set E = {x0}.
Corollary 4.11 Suppose F : (a,b) →R.
Then F is continuous at each point
c1, c2, c3, . . . ck ∈(a,b) if and only if F has zero variation on the ﬁnite set
E = {c1,c2,c3,...ck}.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.5. FUNCTIONS WITH ZERO VARIATION
165
Corollary 4.12 Suppose F : (a,b) →R. Then F is continuous at each point c1, c2,
c3,... from a sequence of points in (a,b) if and only if F has zero variation on the
countable set E = {c1,c2,c3,...}.
Exercise 494 Suppose F : (a,b) →R. Show that F is continuous at every point in a set E if and only F has zero
variation in every countable subset of E.
4.5.4
Absolute continuity
We have seen that the function F(x) = x has zero variation on a set N precisely when that set N is a set of measure
zero. We see, then, that F has zero variation on all sets of measure zero. Most functions that we have encountered in the
calculus also have this property. We shall see that all differentiable functions have this property. It plays a vital role in
the theory; such functions are said to be absolutely continuous3.
Deﬁnition 4.13 A function F : (a,b) →R is said to be absolutely continuous on
the open interval (a,b) if F has zero variation on every subset N of the interval
that has measure zero.
The exercises show that most continuous functions we encounter in the calculus will be absolutely continuous. In
fact the only continuous function we have seen so far that is not absolutely continuous is the Cantor function.
Exercise 495 Show that the function F(x) = x is absolutely continuous on every open interval.
Exercise 496 Show that a linear combination of absolutely continuous functions is absolutely continuous.
Exercise 497 Suppose that F : (a,b) →R is is absolutely continuous on the interval (a,b). Show that F must be
continuous at every point of that interval.
Exercise 498 Show that a Lipschitz function deﬁned on an open interval is absolutely continuous there.
3Note to the instructor: this notion is strictly more general than the traditional notion (due to Vitali) of a function absolutely continuous on a
closed, bounded interval [a,b]. In particular an absolutely continuous function in this sense need not have bounded variation. See Exercise 4.14
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

166
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
Exercise 499 Give an example of an absolutely continuous function that is not Lipschitz.
Exercise 500 Show that the Cantor function is not absolutely continuous on (0,1).
Exercise 501 Suppose that F : (a,b) →R is differentiable at each point of the open interval (a,b). Show that F is
absolutely continuous on the interval (a,b).
Exercise 502 Suppose that F : (a,b) →R is differentiable at each point of the open interval (a,b) with ﬁnitely many
exceptions but that F is continuous at those exceptional points. Show that F is absolutely continuous on the interval
(a,b).
Exercise 503 Suppose that F : (a,b) →R is differentiable at each point of the open interval (a,b) with countably many
exceptions but that F is continuous at those exceptional points. Show that F is absolutely continuous on the interval
(a,b).
Exercise 504 Suppose that F : (a,b) →R is differentiable at each point of the open interval (a,b) with the exception
of a set N ⊂(a,b). Suppose further that N is a set of measure zero and that F has zero variation on N. Show that F is
absolutely continuous on the interval (a,b).
Exercise 505 Suppose that F : (a,b) →R is absolutely continuous on the interval (a,b). Then by deﬁnition F has zero
variation on every subset of measure zero. Is it possible that F has zero variation on subsets that are not measure zero?
Exercise 506 A function F on an open interval I is said to have ﬁnite derived numbers on a set E ⊂I if, for each x ∈E,
there is a number Mx and one can choose δ > 0 so that
¯¯¯¯
F(x+h)−F(x)
h
¯¯¯¯ ≤Mx
whenever x + h ∈I and |h| < δ. Show that F is absolutely continuous on E if F has ﬁnite derived numbers there.
[cf. Exercise 170.]
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.5. FUNCTIONS WITH ZERO VARIATION
167
4.5.5
Absolute continuity in Vitali’s sense
There is a type of absolute continuity, due to Vitali, that is very similar to the ε–δ deﬁnition of uniform continuity.
Deﬁnition 4.14 (Absolute continuity in Vitali’s sense) A function F : [a,b] →R
is absolutely continuous in Vitali’s sense on [a,b] provided that for every ε > 0
there is a δ > 0 so that
n
∑
i=1
|F(xi)−F(yi)| < ε
whenever {[xi,yi]} are nonoverlapping subintervals of [a,b] for which
n
∑
i=1
(yi −xi) < δ.
This condition is strictly stronger than absolute continuity: there are absolutely continuous functions that are not
absolutely continuous in Vitali’s sense.
Exercise 507 Prove: If F is absolutely continuous in Vitali’s sense on [a,b] then F is uniformly continuous there.
Exercise 508 Prove: If F is absolutely continuous in Vitali’s sense on [a,b] then F is absolutely continuous on the open
interval (a,b).
Exercise 509 Prove: If F is absolutely continuous in Vitali’s sense on [a,b] then F has bounded variation on [a,b].
Exercise 510 If F is Lipschitz show that F is absolutely continuous in Vitali’s sense.
Exercise 511 Show that an everywhere differentiable function must be absolutely continuous on any interval (a,b) but
need not be absolutely continuous in Vitali’s sense on [a,b].
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

168
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
4.6
The integral
Our theory so far in Part One has introduced and studied the calculus integral, both as indeﬁnite and deﬁnite integral.
The key point in that theory was simply this observation:
Continuous functions on open intervals whose derivatives are determined at all but ﬁnitely many points are
unique up to an additive constant.
The whole theory of the calculus integral was based on this simple concept. We can consider that this simple phrase is
enough to explain the elementary theory of integration.
The exceptional set that we allowed was always ﬁnite. To go beyond that and provide a more comprehensive
integration theory we must allow inﬁnite sets. We have see that sets of measure zero offer a useful class of exceptional
sets. But we also saw the Cantor function whose derivative is zero everywhere except on the measure zero Cantor set,
and yet the Cantor function is not constant.
Absolutely continuous functions behave on sets of measure zero in precisely the manner that we require. To avoid
pathological functions like the Cantor function we need to assume some kind of absolute continuity or we need to assume
that the functions we use have zero variation on certain sets. Thus we can build a new theory of integration on a statement
that generalizes the one above:
Absolutely continuous functions on open intervals whose derivatives are determined at all but a set of
measure zero are unique up to an additive constant.
We can consider that this simple phrase, too, is enough to explain the modern theory of integration. We formulate our
deﬁnitions in a way that mimics and extends the calculus integral, taking advantage now of sets of measure zero and
absolutely continuous functions.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.6. THE INTEGRAL
169
Deﬁnition 4.15 (Deﬁnite integral) Let f : (a,b) →R be a function deﬁned at all
points of the open interval (a,b) with the possible exception of a set of measure
zero. Then f is said to be integrable on the closed, bounded interval [a,b] provided
there is a function F : (a,b) →R so that
1. F is uniformly continuous on (a,b).
2. F is absolutely continuous on (a,b).
3. F′(x) = f(x) at all points x of (a,b) with the possible exception of a set of
measure zero.
In that case we deﬁne
Z b
a f(x)dx = F(b−)−F(a+).
We recall that, because F is uniformly continuous on (a,b), the two one-sided limits F(b−) and F(a+) must exist.
Most often we have determined F on all of [a,b] and so can simply use F(b) and F(a). Sometimes it is more convenient to
state the conditions for the integral with direct attention to the set of exceptional points where the derivative F′(x) = f(x)
may fail.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

170
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
Deﬁnition 4.16 (Deﬁnite integral) Let f : (a,b) →R be a function deﬁned at all
points of the open interval (a,b) with the possible exception of a set of measure
zero. Then f is said to be integrable on the closed, bounded interval [a,b] provided
there is a function F : [a,b] →R and there is a set N ⊂(a,b) so that
1. F is uniformly continuous on (a,b).
2. N has measure zero.
3. F′(x) = f(x) at all points x of (a,b) with the possible exception of points in
N.
4. F has zero variation on N.
In that case we deﬁne
Z b
a f(x)dx = F(b−)−F(a+).
Exercise 512 Show that Deﬁnition 4.15 and Deﬁnition 4.16 are equivalent.
Exercise 513 Show that the following requirements are not equivalent to those in Deﬁnition 4.15 but are stronger.
1. F is absolutely continuous in Vitali’s sense on [a,b].
2. F′(x) = f(x) at all points x of (a,b) with the possible exception of points in a set of measure zero.
3.
Z b
a f(x)dx = F(b)−F(a).
[This set of stronger requirements describes Lebesgue’s integral which is less general than the integral deﬁned here.]
Answer
Exercise 514 Under what hypotheses is
Z b
a F′(x)dx = F(b)−F(a)
a correct statement?
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.6. THE INTEGRAL
171
Exercise 515 Show that the new deﬁnition of deﬁnite integral (either Deﬁnition 4.15 or Deﬁnition 4.16) includes the
notion of deﬁnite integral from Chapter 3.
Exercise 516 Show that the new deﬁnition of deﬁnite integral (either Deﬁnition 4.15 or Deﬁnition 4.16) includes, as
integrable, functions that would not be considered integrable in Chapter 3.
4.6.1
Inﬁnite integrals
Exactly the same deﬁnition for the inﬁnite integrals
Z ∞
−∞f(x)dx,
Z ∞
a
f(x)dx, and
Z b
−∞f(x)dx
can be given as for the integral over a closed bounded interval.
Deﬁnition 4.17 Let f be a function deﬁned at every point of (∞,∞) with the pos-
sible exception of a set of measure zero. Then f is said to be integrable on (∞,∞)
provided there is a function F : (−∞,∞) →R so that
1. F is absolutely continuous on (∞,∞).
2. F′(x) = f(x) at all points x with the possible exception of a set of measure
zero.
3. Both limits F(∞) = limx→∞F(x) and F(−∞) = limx→−∞F(x) exist.
In that case the number
Z ∞
−∞f(x)dx = F(∞)−F(−∞), is called the deﬁnite integral
of f on the interval (∞,∞) .
Similar assertions deﬁne
Z b
−∞f(x)dx = F(b)−F(−∞)
and
Z ∞
a
f(x)dx = F(∞)−F(a).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

172
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
In analogy with the terminology of an inﬁnite series ∑∞
k=1 ak we often say that the integral
R ∞
a f(x)dx converges when
the integral exists. That suggests language asserting that the integral converges absolutely if both integrals
Z ∞
a
f(x)dx and
Z ∞
a | f(x)|dx
exist.
4.7
Lipschitz functions and bounded integrable functions
We know that Lipschitz functions are absolutely continuous. They are even absolutely continuous in Vitali’s sense which
is a stronger statement. Thus the theory of integration for bounded functions can be restated in the following language.
Theorem 4.18 (Deﬁnite integral of bounded functions) Let f : (a,b) →R be a
bounded function deﬁned at all points of the open interval (a,b) with the possible
exception of a set of measure zero. Then f is integrable on the closed, bounded
interval [a,b] if and only if there is a function F : [a,b] →R so that
1. F is Lipschitz on the closed interval [a,b].
2. F′(x) = f(x) at all points x of the open interval (a,b) with the possible ex-
ception of points in a set of measure zero.
In that case
Z b
a f(x)dx = F(b)−F(a).
This can also be considered the deﬁnition of the classical Lebesgue integral of bounded functions. Since Lebesgue
started with the bounded functions this is an historically important integral. Since a vast number of problems in integra-
tion theory consider only bounded functions this is also a reasonable working deﬁnition for any problem in integration
theory that does not lead to unbounded functions.
Exercise 517 Prove Theorem 4.18.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.8. APPROXIMATION BY RIEMANN SUMS
173
4.8
Approximation by Riemann sums
We have seen that all calculus integrals can be approximated by Riemann sums, pointwise approximated that is. The
same theorem is true for the advanced integration theory. In Theorem 4.19 below we see that the property of being
an integral (which is a property expressed in the language of derivatives, zero measure sets and zero variation) can be
completely described by a property expressed by partitions and Riemann sums.
This theorem was ﬁrst observed by the Irish mathematician Ralph Henstock. Since then it has become the basis for
a deﬁnition of the modern integral. The proof is elementary. Even so, it is remarkable and was not discovered until the
1950s, in spite of intense research into integration theory in the preceding half-century.
Theorem 4.19 (Henstock’s criterion) Suppose that f is an integrable function
deﬁned at every point of a closed, bounded interval [a,b]. Then for every ε > 0
and every point x ∈[a,b] there is a δ(x) > 0 so that
n
∑
i=1
¯¯¯¯
Z bi
ai
f(x)dx−f(ξi)(bi −ai)
¯¯¯¯ < ε
and
¯¯¯¯¯
Z b
a f(x)dx−
n
∑
i=1
f(ξi)(bi −ai)
¯¯¯¯¯ < ε
whenever a partition of the interval [a,b] {([ai,bi],ξi) : i = 1,2,...,n} is chosen
for which
ξi ∈[ai,bi] and bi −ai < δ(ξi).
This theorem is stated in only one direction: if f is integrable then the integral has a pointwise approximation using
Riemann sums. The converse direction is true too and can be used to deﬁne the integral by means of Riemann sums.
Of course, one is then obliged to develop the full theory of zero measure sets, zero variation and absolute continuity in
order to connect the two theories and show that they are equivalent.
The theorem provides only for a pointwise approximation by Riemann sums. It is only under rather severe condi-
tions that it is possible to ﬁnd a uniform approximation by Riemann sums. Exercises 519, 520, and 521 provide that
information.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

174
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
Exercise 518 Prove Theorem 4.19.
Answer
Exercise 519 (Riemann criterion) Theorem 4.19 shows that the integral has a pointwise approximation using Riemann
sums. Show that a function f would have a uniform approximation using Riemann sums if and only if, for any ε > 0,
there is a partition of the interval [a,b] {([ai,bi],ξi) : i = 1,2,...,n} for which
n
∑
i=1
ω( f,[ai,bi])(bi −ai) < ε.
Exercise 520 (Lebesgue criterion) Theorem 4.19 shows that the integral has a pointwise approximation using Riemann
sums. Show that, if f is bounded and the set of points of discontinuity form a set of measure zero, then the integral has a
uniform approximation using Riemann sums.
Exercise 521 (Lebesgue criterion) Theorem 4.19 shows that the integral has a pointwise approximation using Riemann
sums. Show that, if the integral has a uniform approximation using Riemann sums, then f must be bounded and the set
of points of discontinuity must form a set of measure zero.
4.9
Properties of the integral
The basic properties of integrals are easily studied for the most part since they are natural extensions of properties we
have already investigated for the calculus integral. There are some surprises and some deep properties which were either
false for the calculus integral or were hidden too deep for us to ﬁnd without the tools we have now developed.
We know these formulas for the narrow calculus integral and we are interested in extending them to full generality.
If you are working largely with continuous functions then there is little need to know just how general these properties
can be developed.
4.9.1
Inequalities
Formula for inequalities:
Z b
a f(x)dx ≤
Z b
a g(x)dx
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.9. PROPERTIES OF THE INTEGRAL
175
if f(x) ≤g(x) for all points x in (a,b) except possibly points of a set of measure zero.
We have seen this statement before for the calculus integral in Section 3.4.1 where we allowed only a ﬁnite number
of exceptions for the inequality. Here is a precise statement of what we intend here by this statement: If both functions
f(x) and g(x) have an integral on the interval [a,b] and, if f(x) ≤g(x) for all points x in (a,b) except possibly points of
a set of measure zero. then the stated inequality must hold.
Exercise 522 Complete the details needed to prove the inequality formula.
Answer
4.9.2
Linear combinations
Formula for linear combinations:
Z b
a [r f(x)+sg(x)]dx = r
Z b
a f(x)dx+s
Z b
a g(x)dx
(r,s ∈R).
We have seen this statement before for the calculus integral in Section 3.4.2 Here is a precise statement of what
we intend now by this formula: If both functions f(x) and g(x) have an integral on the interval [a,b] then any linear
combination r f(x)+sg(x) (r, s ∈R) also has an integral on the interval [a,b] and, moreover, the identity must hold. The
proof is an exercise in derivatives, taking proper care of the exceptional sets of measure zero. We know, as usual, that
d
dx (rF(x)+sG(x)) = rF′(x)+sG′(x)
at any point x at which both F and G are differentiable.
Exercise 523 Complete the details needed to prove the linear combination formula.
Answer
4.9.3
Subintervals
Formula for subintervals: If a < c < b then
Z b
a f(x)dx =
Z c
a f(x)dx+
Z b
c f(x)dx
The intention of the formula is contained in two statements in this case:
If the function f(x) has an integral on the interval [a,b] then f(x) must also have an integral on any closed
subinterval of the interval [a,b] and, moreover, the identity must hold.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

176
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
and
If the function f(x) has an integral on the interval [a,c] and also on the interval [c,b] then f(x) must also
have an integral on the interval [a,b] and, moreover, the identity must hold.
Exercise 524 Supply the details needed to prove the subinterval formula.
Answer
4.9.4
Integration by parts
Integration by parts formula:
Z b
a F(x)G′(x)dx = F(b)G(b)−F(a)G(b)−
Z b
a F′(x)G(x)dx
The intention of the formula is contained in the product rule for derivatives:
d
dx (F(x)G(x)) = F(x)G′(x)+F′(x)G(x)
which holds at any point where both functions are differentiable. One must then give strong enough hypotheses that the
function F(x)G(x) is an indeﬁnite integral for the function
F(x)G′(x)+F′(x)G(x)
in the sense needed for our integral.
Exercise 525 Supply the details needed to state and prove an integration by parts formula for this integral.
Answer
4.9.5
Change of variable
The change of variable formula (i.e., integration by substitution):
Z b
a f(g(t))g′(t)dt =
Z g(b)
g(a) f(x)dx.
The proof for the calculus integral was merely an application of the chain rule for the derivative of a composite function:
d
dxF(G(x)) = F′(G(x))G′(x).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.9. PROPERTIES OF THE INTEGRAL
177
Since our extended integral includes the calculus integral we still have this formula for all the old familiar cases. It
is possible to extend the formula to handle much more general situations.
Exercise 526 Supply the details needed to state and prove a change of variables formula for this integral.
Answer
Exercise 527 (no longer failed change of variables) In Exercise 280 we discovered that the calculus integral did not
permit the change of variables, F(x) = |x| and G(x) = x2 sinx−1, G(0) = 0 in the integral
Z 1
0 F′(G(x))G′(x)dx = F(G(1))−F(G(0)) = |sin1|.
Is this valid now?
Answer
4.9.6
What is the derivative of the deﬁnite integral?
What is
d
dx
Z x
a f(t)dt?
We know that
R x
a f(t)dt is an indeﬁnite integral of f and so, by deﬁnition,
d
dx
Z x
a f(t)dt = f(x)
at all points in the interval (a,b) except possibly at the points of a set of measure zero.
We can still make the same observation that we did in Section 3.4.6 for the calculus integral:
d
dx
Z x
a f(t)dt = f(x)
at all points a < x < b at which f is continuous. But this is quite misleading here. The function may be discontinuous
everywhere, and yet the differentiation formula always holds for most points x.
4.9.7
Monotone convergence theorem
For this integral we can integrate a limit of a monotone sequence by interchanging the limit and the integral.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

178
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
Theorem 4.20 (Monotone convergence theorem) Let
fn : [a,b] →R
(n =
1,2,3,...) be a nondecreasing sequence of functions, each integrable on the in-
terval [a,b]. Suppose that, for all x in (a,b) except possibly a set of measure zero,
f(x) = lim
n→∞fn(x).
Then f is integrable on [a,b] and
Z b
a f(x)dx = lim
n→∞
Z b
a fn(x)dx
provided this limit exists.
The exciting part of this statement has been underlined. Unfortunately it is more convenient for us to leave the proof
of this fact to a more advanced course. Thus in the exercise you are asked to prove only a weaker version.
Exercise 528 Prove the formula without the underlined statement, i.e., assume that f is integrable and then prove the
identity.
Answer
Exercise 529 State and prove a version of the formula
Z b
a
³
lim
n→∞fn(x)
´
dx = lim
n→∞
Z b
a fn(x)dx.
using uniform convergence as your main hypothesis.
4.9.8
Summation of series theorem
For this integral we can sum series of nonnegative terms and integrate term-by-term.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.9. PROPERTIES OF THE INTEGRAL
179
Theorem 4.21 (summation of series) Suppose that g1, g2, g3,. . . is a sequence of
nonnegative functions, each one integrable on a closed bounded interval [a,b].
Suppose that, for all x in (a,b) except possibly a set of measure zero,
f(x) =
∞
∑
k=1
gk(x).
Then f is integrable on [a,b] and
Z b
a f(x)dx =
∞
∑
k=1
µZ b
a gk(x)dx
¶
(4.1)
provided the series converges.
The exciting part of this statement, again, has been underlined. Unfortunately it is more convenient for us to leave
the proof of this fact to a more advanced course. Thus in the exercise you are asked to prove only a weaker version.
Exercise 530 Prove the formula without the underlined statement, i.e., assume that f is integrable and then prove the
identity.
Answer
4.9.9
Null functions
A function f : [a,b] →R is said to be a null function on [a,b] if it is deﬁned at almost every point of [a,b] and is zero
at almost every point of [a,b]. Thus these functions are, for all practical purposes, just the zero function. They are
particularly easy to handle in this theory for that reason.
Exercise 531 Let f : [a,b] →R be a null function on [a,b]. Then f is integrable on [a,b] and
Z b
a f(x)dx = 0.
Answer
Exercise 532 Suppose that f : [a,b] →R is an integrable function on [a,b] and that
Z d
c f(x)dx = 0 for all a ≤c < d ≤b.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

180
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
Then f is a null function on [a,b].
Answer
Exercise 533 Suppose that f : [a,b] →R is a nonnegative, integrable function on [a,b] and that
Z b
a f(x)dx = 0.
Then f is a null function on [a,b].
Answer
4.10
The Henstock-Kurweil integral
Deﬁnition 4.22 (Henstock-Kurzweil integral) Suppose that f is deﬁned at every
point of a closed, bounded interval [a,b]. Then f is said to be Henstock-Kurzweil
integrable on [a,b] if there is a number I with the property that, for every ε > 0 and
every point x ∈[a,b] there is a δ(x) > 0 so that
¯¯¯¯¯I −
n
∑
i=1
f(ξi)(bi −ai)
¯¯¯¯¯ < ε
whenever a partition of [a,b] {([ai,bi],ξi) : i = 1,2,...,n} is chosen for which
ξi ∈[ai,bi] and bi −ai < δ(ξi).
The number I is set equal to
R b
a f(x)dx and the latter is called the Henstock-
Kurzweil integral of f on [a,b].
Here are some remarks that you should be able to prove or research.
1. The Henstock-Kurzweil integral not only includes, but is equivalent to the integral deﬁned in this chapter.
2. There are bounded, Henstock-Kurzweil integrable functions that are not integrable [calculus sense].
3. There are unbounded, Henstock-Kurzweil integrable functions that are not integrable [calculus sense].
4. The Henstock-Kurzweil integral is a nonabsolute integral, i.e., there are integrable functions f for which | f| is not
integrable.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.11. THE LEBESGUE INTEGRAL
181
5. The Henstock-Kurzweil integral is often considered to be the correct version of integration theory on the line, but
one that only specialists would care to learn. (?)
There are now a number of texts that start with Deﬁnition 4.22 and develop the theory of integration on the real line
in a systematic way. Too much time, however, working with the technical details of Riemann sums may not be entirely
proﬁtable since most advanced textbooks will use measure theory exclusively. Our text
[TBB] B. S. Thomson, J. B. Bruckner, A. M.Bruckner, Elementary Real Analysis: Dripped Version,
ClassicalRealAnalysis.com (2008).
available for free at our website contains a brief account of the calculus integral and several chapters devoted to the
Henstock-Kurweil integral. After that integration theory is developed we then can give a fairly rapid and intuitive
account of the measure theory that most of us are expected to know by a graduate level.
4.11
The Lebesgue integral
Lebesgue gave a number of deﬁnitions for his integral; the most famous is the constructive deﬁnition using his measure
theory. He also gave a descriptive deﬁnition similar to the calculus deﬁnitions that we are using in this text. For bounded
functions his deﬁnition4 is exactly as given below. The second deﬁnition, for unbounded functions, uses the later notion
due to Vitali that we have investigated in Section 4.5.5.
4Here is a remark on this fact from Functional Analysis, by Frigyes Riesz, Béla Szökefalvi-Nagy, and Leo F. Boron: “Finally, we discuss a
deﬁnition of the Lebesgue integral based on differentiation, just as the classical integral was formerly deﬁned in many textbooks of analysis. A
similar deﬁnition, if only for bounded functions, was already formulated in the ﬁrst edition of Lebesgue’s Leçons sur l’intégration, but without
being followed up: ‘A bounded function f(x) is said to be summable if there exists a function F(x) with bounded derived numbers [i.e., Lipschitz]
such that F(x) has f(x) for derivative, except for a set of values of x of measure zero. The integral in (a,b) is then, by deﬁnition, F(b)−F(a).’
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

182
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
Deﬁnition 4.23 Let f be a bounded function that is deﬁned at every point of [a,b].
Then, f is said to be Lebesgue integrable on [a,b] if there is a Lipschitz function
F : [a,b] →R such that F′(x) = f(x) at every point of (a,b) with the exception of
points in a set of measure zero. In that case we deﬁne
Z b
a f(x)dx = F(b)−F(a)
and this number is called the Lebesgue integral of f on [a,b].
Deﬁnition 4.24 Let f be a function, bounded or unbounded, that is deﬁned at
every point of [a,b]. Then, f is said to be Lebesgue integrable on [a,b] if there is a
function F : [a,b] →R that is absolutely continuous in the sense of Vitali on [a,b]
such that F′(x) = f(x) at every point of (a,b) with the exception of points in a set
of measure zero. In that case we deﬁne
Z b
a f(x)dx = F(b)−F(a)
and this number is called the Lebesgue integral of f on [a,b].
Strictly speaking the Lebesgue integral does not quite go “beyond the calculus integral.” For bounded functions,
the Lebesgue integral includes the calculus integral and integrates many important classes of functions that the calculus
integral cannot manage. But for unbounded functions the relation between the calculus integral and the Lesbesgue
integral is more delicate: there are functions integrable in the calculus sense but which are not absolutely integrable.
Any one of these functions must fail to have a Lebesgue integral.
Here are some remarks that you should be able to prove or research.
1. There are unbounded, integrable functions [calculus sense] that are not Lebesgue integrable.
2. All bounded, integrable functions [calculus sense] are Lebesgue integrable.
3. All Lebesgue integrable functions are integrable in the sense of this chapter.
4. For bounded functions the Lebesgue integral and the integral of this chapter are completely equivalent.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

4.12. THE RIEMANN INTEGRAL
183
5. For nonnegative functions the Lebesgue integral and the integral of this chapter are completely equivalent.
6. The Lebesgue integral is an absolute integral, i.e., if f is integrable then so too is the absolute value | f|.
7. The Lebesgue integral is considered the most important integration theory on the real line and yet viewed as too
difﬁcult for most undergraduate mathematics students. (?)
Further study of the Lebesgue integral requires learning the measure theory. The traditional approach is to start
with the measure theory and arrive at these descriptive descriptions of his integral only after many weeks. There is an
abundance of good texts for this. Try to remember when you are going through such a study that eventually, after much
detail, you will indeed arrive back at this point of seeing the integral as an antiderivative.
4.12
The Riemann integral
The last word in Part I of our text goes to the unfortunate Riemann integral, long taught to freshman calculus students
in spite of the clamor against it. The formal deﬁnition is familiar, of course, since we have already studied the notion of
uniform approximation by Riemann sums in Section 3.3.2.
The Riemann integral does not go “beyond the calculus integral.” The Riemann integral will handle no unbounded
functions and we have been successful with the calculus integral in handling many such functions. Even for bounded
functions the relation between the calculus integral and the Riemann integral is confused: there are functions integrable
in either of these senses, but not in the other.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

184
CHAPTER 4. BEYOND THE CALCULUS INTEGRAL
Deﬁnition 4.25 Let f be a bounded function that is deﬁned at every point of [a,b].
Then, f is said to be Riemann integrable on [a,b] if there is a number I so that for
every ε > 0 there is a δ > 0 so that
¯¯¯¯¯I −
n
∑
i=1
f(ξi)(xi −xi−1)
¯¯¯¯¯ < ε
whenever {([xi,xi−1],ξi) : i = 1,2,...n} is a partition of [a,b] with each
xi −xi−1 < δ and ξi ∈[xi−1,xi].
The number I is set equal to
R b
a f(x)dx and the latter is called the Riemann integral
of f on [a,b].
Here are some remarks that you should be able to prove or research.
1. There are Riemann integrable functions that are not integrable [calculus sense].
2. There are bounded, integrable functions [calculus sense] that are not Riemann integrable.
3. All Riemann integrable functions are integrable in the sense of this chapter.
4. All Riemann integrable functions are integrable in the sense of Lebesgue.
5. A bounded function is Riemann integrable if and only if it is continuous at every point, excepting possibly at
points in a set of measure zero.
6. The Riemann integral is considered to be a completely inadequate theory of integration and yet is the theory that
is taught to most undergraduate mathematics students. (?)
We do not believe that you need to know more about the Riemann integral than these bare facts. Certainly any study
that starts with Deﬁnition 4.25 and attempts to build and prove a theory of integration is a waste of time; few of the
techniques generalize to other settings.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

Part II
Theory of the Integral on the Real Line
185
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

Chapter 5
Covering Theorems
We embark now on a complete theory for the integral on the real line. In Chapter 3 we studied a very narrow integration
theory, which we will now call the naive calculus integral, describable as simply interpreting the statement
Z b
a F′(x)dx = F(b)−F(a)
to require that F : [a,b] →R is uniformly continuous and differentiable mostly everywhere.1
In Chapter 4 we extended this deﬁnition by relaxing “mostly everywhere” to almost everywhere.2 To investigate
this new extended calculus integral requires some further techniques before we can advance much further than we did in
Chapter 4.
There are a few highlights of the material from Chapter 4 that we wish the reader to recall (or study). We will go
deeper now by exploring measure zero sets in greater detail. In particular we prove the Mini-Vitali covering theorem
that characterizes measure zero sets in terms of full and ﬁne covers.
Here is our goal for both the review and the new material that will be introduced in this chapter:
• covering relations.
1Mostly everywhere = everywhere with at most ﬁnitely many exceptions.
2Almost everywhere = everywhere excepting a set of measure zero.
187
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

188
CHAPTER 5. COVERING THEOREMS
• Riemann sums.
• measure zero set.
• full null set.
• ﬁne null set.
• Mini-Vitali theorem asserting the equivalence of measure zero, full null, and ﬁne null.
• zero variation and its relation to zero derivative.
• absolute continuity.
• Lebesgue differentiation theorem asserting the almost everywhere differentiability of functions of bounded varia-
tion.
5.1
Covering Relations
The language of integration theory and many of our most important techniques, as presented in the next few chapters,
depends on an understanding of and facility with partitions and Riemann sums. A partition is a special case of a covering
relation. This section deﬁnes and reviews all of the terminology and examines all of the techniques needed to carry on
to a complete investigation of the integral.
5.1.1
Partitions and subpartitions
Construct a subdivision of a compact interval [a,b] by choosing points
a = a0 < a1 < a2 < ··· < ak−1 < ak = b
and then select points ξ1, ξ2, . . . , ξk so that each point ξi belongs to the corresponding interval [ai−1,ai]. Then the
collection
π = {([ai−1,ai],ξi) : i = 1,2,...,k}
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.1. COVERING RELATIONS
189
is called a partition of [a,b]. Note that the intervals do not overlap and that their union is the whole of the interval
[a,b]. The associated points must be selected from their corresponding interval. Any subset of a partition is called a
subpartition.
We consider this a special kind of covering relation.
5.1.2
Covering relations
Families of pairs ([u,v],w), where [u,v] is a compact interval and w a point in that interval, are called covering relations.
Every partition and every subpartition is a covering relation. It is a relation because it provides an association of points
with intervals.
All covering relations are just subsets of one big covering relation:
ˆβ = {([u,v],w) : u,v,w ∈R, u < v and u ≤w ≤v }.
We shall most frequently use the Greek symbol β to denote a covering relation. We have already used the Greek symbol
π to denote those covering relations which are partitions or subpartitions.
5.1.3
Prunings
Given a number of covering relations arising in a problem we often have to combine them or “prune out” certain subsets
of them. We use the following techniques quite frequently:
Deﬁnition 5.1 If β is a covering relation and E a set of real numbers then we
write:
• β[E] = {([u,v],w) ∈β : w ∈E}.
• β(E) = {([u,v],w) ∈β : [u,v] ⊂E}.
to indicate these subsets of the covering relation β from which we have removed
inconvenient members.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

190
CHAPTER 5. COVERING THEOREMS
5.1.4
Full covers
A full cover is one that, in very loose language, contains all sufﬁciently small intervals at a point.
Deﬁnition 5.2 Let E be a set of real numbers. A covering relation β is said to be a
full cover of E if for each w ∈E there is a positive number δ(w) so that β contains
every pair ([u,v],w) for which v−u < δ(w).
By a full cover without reference to any set we mean a full cover of all of R.
Full covers arise naturally as ways to describe continuity, differentiation, integration, and numerous other processes
of analysis. The student should attempt many (perhaps all) of the exercises in order to gain a facility in covering
arguments.
5.1.5
Fine covers
A ﬁne cover3 is one that, in very loose language, contains arbitrarily small intervals at a point.
Deﬁnition 5.3 Let E be a set of real numbers. A covering relation β is said to be
a ﬁne cover of E if for each w ∈E and any positive number ε the covering relation
β contains at least one pair ([u,v],w) for which v−u < ε.
By a ﬁne cover without reference to any set we mean a ﬁne cover of all of R.
Fine covers arise in the same way that full covers arise. In a sense the ﬁne cover comes from a negation of a full
cover. For example (as you will see in the Exercises) full covers could be used to describe continuity conditions and ﬁne
covers would then twist this to describe the situation where continuity fails.
5.1.6
Uniformly full covers
A uniformly full cover is one that, in very loose language, contains all sufﬁciently small intervals at a point, where the
smallness required is considered the same for all points
3Known also as a Vitali cover.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.1. COVERING RELATIONS
191
Deﬁnition 5.4 Let E be a set of real numbers. A covering relation β is said to be
a uniformly full cover of E if there is a positive number δ so that β contains every
pair ([u,v],w) for which v−u < δ.
Only occasionally shall we use uniformly full covers. To verify that a covering relation is full just requires us to test
what happens at each point. To verify that a covering relation is uniformly full requires more: we have to ﬁnd a positive
number δ that works at every point. The exclusive use of uniformly full covers would lead to a restrictive theory: the
Riemann integral (which is mostly banished from this textbook) is based on uniformly full covers. Our integration theory
uses full covers and, as a consequence, is much more general and is easier.4
Exercises
Exercise 534 Suppose that G is an open set. Show that
β = {([u,v],w) : u ≤w ≤v, [u,v] ⊂G}
is a full cover of G.
Exercise 535 Suppose that β is a full cover of a set E and that G is an open set containing E. Show that β(G) is also a
full cover of E. [This is described as “pruning the full cover” by the open set G.]
Answer
Exercise 536 Suppose that β is a ﬁne cover of a set E and that G is an open set containing E. Show that β(G) is also a
ﬁne cover of E. [This is described as “pruning the ﬁne cover” by the open set G.]
Answer
Exercise 537 Suppose that β is a uniformly full cover of a set E and that G is an open set containing E. Show that β(G)
is not necessarily a uniformly full cover of E. Would it be a full cover?
Exercise 538 Suppose that β1 and β2 are both full covers of a set E. Show that β1 ∩β2 is also a full cover of E.
Exercise 539 Suppose that β1 and β2 are both ﬁne covers of a set E. Show that β1 ∩β2 need not be a ﬁne cover of E.
4It is easier since the requirement in Riemann integration to always check that the covers used are not merely full, but uniformly full, imposes
unnecessary burdens on many proofs.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

192
CHAPTER 5. COVERING THEOREMS
Exercise 540 Suppose that β1 is a full cover of a set E and β2 is a ﬁne cover. Show that β1 ∩β2 is also a ﬁne cover of E.
Need it be a full cover?
Exercise 541 Suppose that β1 and β2 are full covers of sets E1 and E2 respectively. Show that β1 ∪β2 is a full cover of
E1 ∪E2.
Exercise 542 Suppose that β1 and β2 are ﬁne covers of sets E1 and E2 respectively. Show that β1 ∪β2 is a ﬁne cover of
E1 ∪E2.
Exercise 543 Let E1, E2, E3, . . . be a sequence of sets. Suppose that β1, β2, β3, . . . are full covers of sets E1, E2, E3,
...respectively. Show that
β = β1 ∪β2 ∪β3 ∪...
is a full cover of E = S∞
n=1 En.
Exercise 544 Let E1, E2, E3, . . . be a sequence of sets. Suppose that β1, β2, β3, . . . are ﬁne covers of sets E1, E2, E3,
...respectively. Show that
β = β1 ∪β2 ∪β3 ∪...
is a ﬁne cover of E = S∞
n=1 En.
Exercise 545 Let F : R →R . Deﬁne
β = {([u,v],w) : |F(u)−F(v)| < ε}.
Show that β is full at a point x0 for all ε > 0 if and only if F is continuous at that point.
Exercise 546 Let F : R →R, c ∈R and deﬁne
β = {([u,v],w) : |F(u)−F(v)−c(v−u)| < ε(v−u)}.
Show that β is full at a point x0 for all ε > 0 if and only if F′(x0) = c.
Exercise 547 Let F : R →R and deﬁne
β = {([u,v],w) : |F(u)−F(v)| ≥ε}.
Show that β is ﬁne at a point x0 for some value of ε > 0 if and only if F is not continuous at that point.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.1. COVERING RELATIONS
193
Exercise 548 Let F : R →R, c ∈R and deﬁne
β = {([u,v],w) : |F(u)−F(v)−c(v−u)| ≥ε(v−u)}.
Show that β is ﬁne at a point x0 for some value of ε > 0 if and only if F′(x0) = c is false.
Exercise 549 Show that β is ﬁne at a point w if and only if for all β1 that are full at w there is at least one pair ([u,v],w)
belonging to both β and β1.
Answer
Exercise 550 Show that β is full at a point w if and only if for all β1 that are ﬁne at w there is at least one pair ([u,v],w)
belonging to both β and β1.
Answer
Exercise 551 (Heine-Borel) Let G be a family of open sets so that every point in a compact set K is contained in at
least one member of the family. Show that the covering relation
β = {(I,x) : x ∈I and I ⊂G for some G ∈G}.
is a full cover of K (cf. the Heine-Borel Theorem).
Exercise 552 (Bolzano-Weierstrass) Let E be an inﬁnite set that contains no points of accumulation. Show that
β = {(I,x) : x ∈I and I ∩E is ﬁnite}.
must be a full cover (cf. the Bolzano-Weierstrass Theorem).
Exercise 553 Let {xn} be a sequence of real numbers and let
β = {(I,x) : x ∈I and I contains only ﬁnitely many of the xn}.
If β is a ﬁne cover of a set E what (if anything) can you conclude?
Answer
Exercise 554 Let {xn} be a sequence of real numbers and let
β = {(I,x) : x ∈I and I contains only ﬁnitely many of the xn}.
If β is not a ﬁne cover of a set E what (if anything) can you conclude?
Answer
Exercise 555 Let {xn} be a sequence of real numbers and let
β = {(I,x) : x ∈I and I contains only ﬁnitely many of the xn}.
If β is a full cover of a set E what (if anything) can you conclude?
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

194
CHAPTER 5. COVERING THEOREMS
Exercise 556 Let {xn} be a sequence of real numbers and let
β = {(I,x) : x ∈I and I contains only ﬁnitely many of the xn}.
If β is not a full cover of a set E what (if anything) can you conclude?
Answer
Exercise 557 Let {xn} be a sequence of real numbers and let
β = {(I,x) : x ∈I and I contains inﬁnitely many of the xn}.
If β is a ﬁne cover of a set E what (if anything) can you conclude?
Answer
Exercise 558 Let {xn} be a sequence of real numbers and let
β = {(I,x) : x ∈I and I contains inﬁnitely many of the xn}.
If β is a not a ﬁne cover of a set E what (if anything) can you conclude?
Answer
Exercise 559 Let {xn} be a sequence of real numbers and let
β = {(I,x) : x ∈I and I contains inﬁnitely many of the xn}.
If β is a full cover of a set E what (if anything) can you conclude?
Answer
Exercise 560 Let {xn} be a sequence of real numbers and let
β = {(I,x) : x ∈I and I contains inﬁnitely many of the xn}.
If β is a not a full cover of a set E what (if anything) can you conclude?
Answer
5.1.7
Cousin covering lemma
Throughout Chapters 1–4 we have made extensive use of the Cousin covering lemma, but we repeat it here for conve-
nience and to stress the role that it plays in covering arguments in analysis and in integration theory. This also allows us
a chance to rewrite the proof in the language of this chapter.
Lemma 5.5 (Cousin covering lemma) Let β be a full cover. Then β contains a
partition of every compact interval.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.1. COVERING RELATIONS
195
Proof. Note, ﬁrst, that if β fails to contain a partition of some interval [a,b] then it must fail to contain a partition of
much smaller subintervals. For example if a < c < b, if π1 is a partition of [a,c] and π2 is a partition of [c,b], then π1 ∪π2
is certainly a partition of [a,b].
We use this feature repeatedly. Suppose that β fails to contain a partition of [a,b]. Choose a subinterval [a1,b1] with
length less than 1/2 the length of [a,b] so that β fails to contain a partition of [a1,b1]. Continue inductively, selecting a
nested sequence of compact intervals [an,bn] with lengths shrinking to zero so that β fails to contain a partition of each
[an,bn].
By the nested interval property there is point z belonging to each of the intervals. As β is a full cover, there must
exist a δ > 0 so that β contains (I,z) for any compact subinterval I of [a,b] with length smaller than δ. In particular β
contains all ([an,bn],z) for n large enough to assure us that bn −an < δ. The set π = {([an,bn],z)}} containing a single
element is itself a partition of [an,bn] that is contained in β. That contradicts our assumptions. Consequently β must
contain a partition of [a,b]. Since [a,b] was arbitrary, β must contain a partition of any compact interval.
5.1.8
Decomposition of full covers
There is a decomposition of full covers that is often of use in constructing a proof. Here is a good place to put it for easy
reference, although it is entirely unmotivated for the moment. This shows that, while a full cover is a much more general
object than a uniformly full cover, it can be broken into pieces that are themselves uniform covers.
Lemma 5.6 (Decomposition Lemma) Let β be a full cover of a set E.
Then
there is an increasing sequence of sets {En} with E = S∞
n=1 En and a sequence
of nonoverlapping compact intervals {Ikn} covering En so that if x is any point in
En and I is any subinterval of Ikn that contains x then (I,x) belongs to β.
Proof. Let β be a full cover of a set E. By the nature of the cover there must exist, for each x ∈E a positive number δ(x)
on E with the property that (I,x) belongs to β whenever if x ∈E, x ∈I and the length of the interval I is smaller than
δ(x). Deﬁne
En = {x ∈E : δ(x) > 1/n}.
This is an expanding sequence of subsets of E whose union is E itself. If I is any compact interval that contains a point
x in En and has length less than 1/n, then (I,x) must belong to β.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

196
CHAPTER 5. COVERING THEOREMS
A way of exploiting this property is to introduce the intervals
Imn =
·m
n , m+1
n
¸
for integers m = 0, ±1, ±2, . . . . Then β([En ∩Imn]) has this property: if x is any point in En ∩Imn and I is any subinterval
of Imn that contains x then (I,x) is a member of β([En ∩Imn]).
Thus the condition of being a full cover, which is a local condition deﬁned in a special way at each point, has been
made uniform throughout each piece of the decomposition. If we relabel these sets in a convenient way then we now
have our decomposition property.
5.1.9
Riemann sums
The integral can be characterized as a limit of Riemann sums. The original Riemann integral has such a deﬁnition and
the Lebesgue integral, although deﬁned in a completely different manner, also has such a characterization although not
as simple as that for the Riemann integral.
In fact we will wish to deﬁne upper and lower integrals, so the upper integral is a limsup of Riemann sums and the
lower integral is a liminf of Riemann sums. The notation for Riemann sums can assume any of the following forms
(5.1), (5.2), (5.3), or (5.4), depending on which is convenient:
Take an interval [a,b] and subdivide as follows:
a = x0 < x1 < x2 < x3 < ··· < xn−1 < xn = b.
Then form a partition of [a,b] by selecting points ξi from each of the corresponding intervals:
π = ([x0,x1],ξ1), ([x1,x2],ξ2), ..., ([xn−1,xn],ξn).
Sums of the following form are called Riemann sums with respect to this partition:
n
∑
k=1
f(ξk)(xk −xk−1).
(5.1)
These can also be more conveniently written as
∑
([u,v],w)∈π
f(w)(v−u)
(5.2)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.1. COVERING RELATIONS
197
or
∑
([u,v],w)∈π
f(w)λ([u,v])
(5.3)
or even as
∑
(I,w)∈π
f(w)λ(I).
(5.4)
Here we are using λ as a length function:
λ([u,v]) = v−u
is simply the length of the interval [u,v]. We can in this way also conveniently assign a length to the intersection of two
compact intervals. For example,
λ([u1,v1]∩[u2,v2])
would be the length of the interval [u1,v1] ∩[u2,v2] (if it is an interval) and would have length zero if the two intervals
do not overlap.
General Riemann sums
In general, let h([u,v],w) denote any real-valued function which assigns to an interval-point
pair ([u,v],w) a real value. Let π be any partition or subpartition. Then we will (loosely) call any sum
∑
([u,v],w)∈π
h([u,v],w)
(5.5)
or
∑
(I,w)∈π
h(I,w)
(5.6)
a Riemann sum. Such sums will play a role in many diverse investigations.
Exercises
Exercise 561 Let F : [a,b] →R and let π be a partition of [a,b]. Verify the computations
∑
([u,v],w)∈π
(v−u) = b−a
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

198
CHAPTER 5. COVERING THEOREMS
and
∑
([u,v],w)∈π
(F(v)−F(u)) = F(b)−F(a).
Exercise 562 Let F : [a,b] →R and let π be a partition of [a,b]. Show that
∑
([u,v],w)∈π
|F(v)−F(u)| ≥|F(b)−F(a)|.
Exercise 563 Let F : [a,b] →R be a Lipschitz function with Lipschitz constant M and let π be a partition of the interval
[a,b]. Show that
∑
([u,v],w)∈π
|F(v)−F(u)| ≤M(b−a)|.
Exercise 564 Let F, f : [a,b] →R and let π be a partition of [a,b] and suppose that
F(v)−F(u) ≥f(w)(v−u)
for all ([u,v],w) ∈π. Show that
∑
([u,v],w)∈π
f(w)(v−u)) ≤F(b)−F(a).
Exercise 565 Let F : [a,b] →R be a function with the property that
∑
([u,v],w)∈π
|F(v)−F(u)| = 0.
for every partition π of the interval [a,b]. What can you conclude?
Exercise 566 Let F : [0,1] →R be a function with the property that it is monotonic on each of the intervals [0, 1
3], [ 1
3, 2
3],
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.1. COVERING RELATIONS
199
and [ 2
3,1]. What is the largest possible value of
∑
([u,v],w)∈π
|F(v)−F(u)|
for arbitrary partitions π of the interval [a,b].
Exercise 567 Describe the difference between the two sums
∑
([u,v],w)∈π
f(w)(v−u)
and
∑
(I,w)∈π([c,d])
f(w)(v−u)
where [c,d] is an interval.
Answer
Exercise 568 Describe the difference between the two sums
∑
([u,v],w)∈π
f(w)(v−u)
and
∑
([u,v],w)∈π[E]
f(w)(v−u).
where E is a set.
Answer
Exercise 569 How could you interpret the expression
∑
([u,v],w)∈π1∪π2
f(w)(v−u)?
Exercise 570 How could you interpret the expression
∑
(([u1,v1],w1)∈π1
∑
([u2,v2],w2)∈π2
f(w1)λ([u1,v1]∩[u2,v2])?
if π1 and π2 are both partitions of the same interval [a,b]?
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

200
CHAPTER 5. COVERING THEOREMS
Exercise 571 Show that
∑
(([u1,v1],w1)∈π1
f(w1)λ([u1,v1])−
∑
([u2,v2],w2)∈π2
f(w2)λ([u2,v2]) =
∑
(([u1,v1],w1)∈π1
∑
([u2,v2],w2)∈π2
[ f(w1)−f(w2)]λ([u1,v1]∩[u2,v2])
if π1 and π2 are both partitions of the same interval [a,b]?
Exercise 572 Let f : [a,b] →R be a continuous function. What could you require of two partitions π1 and π2 of the
interval [a,b] in order to conclude that
¯¯¯¯¯
∑
(([u1,v1],w1)∈π1
f(w1)(v1 −u1)−
∑
([u2,v2],w2)∈π2
f(w2)(v2 −u2)
¯¯¯¯¯ < ε?
5.2
Sets of measure zero
We review the notion of a set of measure zero already studied in Chapter 4. We will present three distinct versions of
measure zero. The ﬁrst is due to Lebesgue and arises from his theory of measure. The second and third use full and ﬁne
coverings and estimates using Riemann sums. In Chapter 4 we used the full covering version for our ﬁrst deﬁnition of
measure zero. Now we begin with Lebesgue’s deﬁnition.
5.2.1
Lebesgue measure of open sets
The property that a set E will be a set of measure zero is actually a statement about the family of open sets containing
E. A set E is measure zero if there are arbitrarily “small” open sets containing E.
For a precise version of this we require a deﬁnition for the Lebesgue measure λ(G) of an open set G. Later on, in
Chapter 7, we will study Lebesgue’s measure in general. The attention here is directed only on that measure for open
sets.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.2. SETS OF MEASURE ZERO
201
Deﬁnition 5.7 Let G be an open set. Then the Lebesgue measure λ(G) of an open
set G is deﬁned to be the total sum of the lengths of all the component intervals of
G.
According to this deﬁnition λ(/0) = 0 (since there are no component intervals). If G consists of inﬁnitely many
bounded component intervals ({ai,bi)} then the measure is the sum of an inﬁnite series:
λ(G) =
∞
∑
i=1
(bi −ai).
[An unbounded component interval would have length ∞and so an open set with an unbounded component has inﬁnite
measure.]
The only tool we need for working with this concept for the moment is given by the subadditivity property.
Lemma 5.8 (Subadditivity) Let G1, G2, G3, . . . be a sequence of open sets. Then
the union
G =
∞
[
i=1
Gi
is also an open set and
λ(G) ≤
∞
∑
i=1
λ(Gi).
Proof. Certainly G is open since any union of open sets is open. Let
T =
∞
∑
i=1
λ(Gi).
Note that T is simply the sum of the lengths of all the component intervals of all the Gi.
Let ({aj,b j)} denote the component intervals of G. Take (a1,b1) and choose any [c1,d1] ⊂(a1,b1). A compactness
argument shows that [c1,d1] is contained in ﬁnitely many of the component intervals making up the sum T. We conclude
that d1 −c1 ≤T. That would be true for any choice of [c1,d1] ⊂(a1,b1), so that b1 −a1 ≤T. A similar argument using
m components (a1,b1), (a2,b2), . . . , (am,bm) will establish that
m
∑
j=1
(bj −a j) ≤T
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

202
CHAPTER 5. COVERING THEOREMS
from which
λ(G) =
∞
∑
j=1
(bj −a j) ≤T
evidently follows.
5.2.2
Sets of Lebesgue measure zero
Our ﬁrst deﬁnition of measure zero set expresses this as a property of open sets that contain the set.
Deﬁnition 5.9 Let E be a set of real numbers. Then E is said to have measure zero
if for every ε > 0 there is an open set G containing E for which λ(G) < ε.
Recall that we have given a completely different deﬁnition of measure zero in Chapter 4. Thus we are obliged very
quickly to show that these two deﬁnitions are equivalent. In the meantime the following exercises should be attempted
but now with the new deﬁnition. In Section 5.5 we will show that the two deﬁnitions (along with a third deﬁnition for
measure zero) are equivalent.
Exercises
Exercise 573 The empty set has measure zero.
Answer
Exercise 574 Every ﬁnite set has measure zero.
Answer
Exercise 575 Every inﬁnite, countable set has measure zero.
Answer
Exercise 576 The Cantor set has measure zero.
Answer
5.2.3
Sequences of measure zero sets
One of the most fundamental of the properties of sets having measure zero is how sequences of such sets combine. We
recall that the union of any sequence of countable sets is also countable. We now prove that the union of any sequence
of measure zero sets is also a measure zero set.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.2. SETS OF MEASURE ZERO
203
Theorem 5.10 Let E1, E2, E3, . . . be a sequence of sets of measure zero. Then the
set E formed by taking the union of all the sets in the sequence is also of measure
zero.
Proof. Let ε > 0. Choose open sets Gn ⊃En so that
λ(Gn) < 2−nε.
Then set G = S∞
n=1 Gn. Observe, by the subadditivity property (i.e., from Lemma 5.8), that G is an open set containing
E for which λ(G) < ε.
Exercises
Exercise 577 Show that E is a set of measure zero if and only if there is a ﬁnite or inﬁnite sequence
(a1,b1),(a2,b2),(a3,b3),(a4,b4),...
of open intervals covering the set E so that
∞
∑
k=1
(bk −ak) ≤ε.
Exercise 578 (compact sets of measure zero) Let E be a compact set of measure zero. Show that for every ε > 0 there
is a ﬁnite collection of open intervals
{(ak,bk) : k = 1,2,3,...,N}
that covers the set E and so that
N
∑
k=1
(bk −ak) < ε.
Answer
Exercise 579 Show that E is a set of measure zero if and only if there is a ﬁnite or inﬁnite sequence
[a1,b1],[a2,b2],[a3,b3],[a4,b4],...
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

204
CHAPTER 5. COVERING THEOREMS
of compact intervals covering the set E so that
∞
∑
k=1
(bk −ak) ≤ε.
Exercise 580 Show that every subset of a set of measure zero also has measure zero.
Exercise 581 Suppose that E ⊂[a,b] is a set of measure zero. Show that
Z b
a χE(x)dx = 0.
Exercise 582 If E has measure zero, show that the translated set
E +α = {x+α : x ∈E}
also has measure zero.
Exercise 583 If E has measure zero, show that the expanded set
cE = {cx : x ∈E}
also has measure zero for any c > 0.
Exercise 584 If E has measure zero, show that the reﬂected set
−E = {−x : x ∈E}
also has measure zero.
Exercise 585 Without referring to Theorem 5.10, show that the union of any two sets of measure zero also has measure
zero.
Exercise 586 If E1 ⊂E2 and E1 has measure zero but E2 has not, what can you say about the set E2 \E1?
Exercise 587 Show that any interval (a,b) or [a,b] is not of measure zero.
Exercise 588 Give an example of a set that is not of measure zero and does not contain any interval [a,b].
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.2. SETS OF MEASURE ZERO
205
Exercise 589 A careless student claims that if a set E has measure zero, then it is true that the closure E must also have
measure zero. After all, if E is contained in S∞
i=1(ai,bi) with small total length then E is contained in S∞
i=1[ai,bi], also
with small total length. Is this correct?
Exercise 590 If a set E has measure zero what can you say about interior points of that set?
Exercise 591 If a set E has measure zero what can you say about boundary points of that set?
Exercise 592 Suppose that a set E has the property that E ∩[a,b] has measure zero for every compact interval [a,b].
Must E also have measure zero?
Exercise 593 Show that the set of real numbers in the interval [0,1] that do not have a 7 in their inﬁnite decimal
expansion is of measure zero.
Exercise 594 Describe completely the class of sets E with the following property: For every ε > 0 there is a ﬁnite
collection of open intervals
(a1,b1),(a2,b2),(a3,b3),(a4,b4),...(aN,bN)
that covers the set E and so that
N
∑
k=1
(bk −ak) < ε.
(These sets are said to have zero content.)
Exercise 595 Show that a set E has measure zero if and only if there is a sequence of intervals
(a1,b1),(a2,b2),(a3,b3),(a4,b4),...
so that every point in E belongs to inﬁnitely many of the intervals and ∑∞
k=1(bk −ak) converges.
Exercise 596 Suppose that {(ai,bi)} is a sequence of open intervals for which
∞
∑
i=1
(bi −ai) < ∞.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

206
CHAPTER 5. COVERING THEOREMS
Show that the set
E =
∞
\
n=1
∞
[
i=n
(ai,bi)
has measure zero. What relation does this exercise have with the preceding exercise?
Exercise 597 By altering the construction of the Cantor set, construct a nowhere dense closed subset of [0,1] so that
the sum of the lengths of the intervals removed is not equal to 1. Will this set have measure zero?
5.2.4
Almost everywhere language
Some commonly used language is used in discussions of measure zero sets. Let P(x) be a property that may or not be
possessed by a point x ∈R. We say that
P(x) is true almost everywhere.
or
P(x) is true for almost every x.
if the set
{x ∈R : P(x) is not true}
is a measure zero set.
We have suggested this language before in Section 2.1.1 and we shall now ofﬁcially take it on. Thus we write:
(mostly everywhere) A statement holds mostly everywhere if it holds everywhere with the exception of a ﬁnite set of
points c1, c2, c3, . . . , cn.
(nearly everywhere) A statement holds nearly everywhere if it holds everywhere with the exception of a countable set.
(almost everywhere) A statement holds almost everywhere if it holds everywhere with the exception of a set of measure
zero.
Nearly everywhere might be abbreviated “n.e.” but only in a context where the reader is reminded of such usage.
Almost everywhere is very frequently abbreviated “a.e.” and most advanced readers are familiar with this usage.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.3. FULL NULL SETS
207
Exercises
Exercise 598 What would it mean to say that a function is almost everywhere discontinuous?
Exercise 599 What would it mean to say that a function is almost everywhere differentiable? Give an example of
function that is almost everywhere differentiable, but not everywhere differentiable.
Exercise 600 What would it mean to say that almost every point in R is irrational? Is this a true statement?
Exercise 601 What would it mean to say that almost everywhere point in a set A belongs to a set B? Give an example
for which this is true and an example for which this is false.
Exercise 602 What would it mean to say that a function is almost everywhere equal to zero?
Exercise 603 What would it mean to say that a function is almost everywhere different from zero?
Exercise 604 Suppose that the function f : [a,b] →R is integrable and is almost everywhere in [a,b] nonnegative. Show
that
R b
a f(x)dx ≥0.
Exercise 605 Suppose that the functions f, g : [a,b] →R are integrable and that f(x) ≤g(x) for almost every x in [a,b].
Show that
R b
a f(x)dx ≤
R b
a g(x)dx.
Exercise 606 Suppose that the functions F, G : [a,b] →R are continuous almost everywhere in [a,b]. Is the sum function
F(x)+G(x) also continuous almost everywhere in [a,b].
Exercise 607 Suppose that the functions F, G : [a,b] →R are differentiable almost everywhere in [a,b]. Is the sum
function F(x)+G(x) also differentiable almost everywhere in [a,b].
5.3
Full null sets
Sets of measure zero are deﬁned using open sets that contain them. There is a variant on this using full covers instead. We
have already taken advantage of this variant in Chapter 4 because that variant has the closest connection with integration
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

208
CHAPTER 5. COVERING THEOREMS
theory as we have presented it. For the moment we refer to this version of measure zero as “full null.” Once we have
proved the equivalence we can revert to normal usage and just label such sets as “measure zero.”
This new deﬁnition has the advantage that, since it is deﬁned using full covers, the deﬁnition is more closely related
to the differentiation and integration properties of functions. It has the disadvantage that, unlike the measure zero sets, it
is not constructive; full covers themselves are not necessarily constructive.
Deﬁnition 5.11 A set E of real numbers is said to be full null if for every ε > 0
there is a full cover β of the set E with the property that
∑
([u,v],w)∈π
(v−u) < ε
(5.7)
for every subpartition π chosen from β.
We will show that the two deﬁnitions, full null and measure zero, are equivalent later. For the moment one direction
is easy.
Theorem 5.12 Every set of measure zero is also full null.
Proof. Assume that a set E measure zero and let ε > 0. Choose an open set G containing E for which λ(G) < ε. Let
{(ai,bi)} be the component intervals of G. Deﬁne β to be the collection of all pairs ([u,v],w) with the property that
w ∈[u,v] ⊂G. It is easy to check that β is a full cover of E.
Consider any subpartition π chosen from β. For each ([u,v],w) ∈π, [u,v] is a subinterval of some component (ai,bi)
of G. Holding i ﬁxed, the sum of the lengths of those intervals [u,v] ⊂(ai,bi) would certainly be smaller than (bi −ai).
It follows that
∑
([u,v],w)∈π
(v−u) ≤
∞
∑
i=1
(bi −ai) = λ(G) < ε.
This veriﬁes that E is full null.
Exercises
Exercise 608 Show that every subset of a full null set is also a full null set.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.4. FINE NULL SETS
209
Exercise 609 Show that E ⊂[a,b] is a full null set if and only if
Z b
a χE(x)dx = 0. Compare this with Exercise 581.
Exercise 610 Show that E ⊂R is a full null set if and only if
R b
a χE(x)dx = 0 for every compact interval [a,b].
Exercise 611 Show that the union of any two full null sets is also a full null set.
Exercise 612 Show that the union of any sequence of full null sets is also a full null set.
Exercise 613 Deﬁne a set E to be uniformly full null if for every ε > 0 there is a uniformly full cover β of the set E with
the property that
∑
([u,v],w)∈π
(v−u) < ε
(5.8)
for every subpartition π chosen from β. Show that uniformly full null sets are the same as sets of zero content. (cf. Exer-
cise 594).
5.4
Fine null sets
Sets of measure zero are deﬁned with attention to the open sets that contain them. Full null sets are deﬁned using full
covers. There is a third variant on this using ﬁne covers instead. This offers yet a more delicate way of working with
measure zero sets, since ﬁne covers can express very subtle properties of derivatives and integrals. We will show in
Section 5.5 that all three notions are equivalent.
Deﬁnition 5.13 A set E of real numbers is said to be ﬁne null if for every ε > 0
there is a ﬁne cover β of the set E with the property that
∑
([u,v],w)∈π
(v−u) < ε
(5.9)
for every subpartition π chosen from β.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

210
CHAPTER 5. COVERING THEOREMS
Exercises
Exercise 614 Show that every set of measure zero is also ﬁne null.
Exercise 615 Show that every full null set is also ﬁne null.
Exercise 616 Show that every subset of a ﬁne null set is also a ﬁne null set.
Exercise 617 Show that the union of any two ﬁne null sets is also a full null set.
Exercise 618 Show that the union of any sequence of ﬁne null sets is also a ﬁne null set.
5.5
The Mini-Vitali Covering Theorem
The original Vitali covering theorem asserts that the Lebesgue measure of an arbitrary set can be determined either by
open coverings of E, or by full covers of E, or by ﬁne covers of E. Our goals in this chapter are narrower. We want to
establish these same facts, but only for sets of measure zero. Later, in Chapter 7 we will return and complete the Vitali
covering theorem.
Theorem 5.14 (Mini-Vitali covering theorem) For any set E ⊂R the following
are equivalent:
1. E is a set of measure zero.
2. E is a full null set.
3. E is a ﬁne null set.
As a result of this theorem we can now simply refer to these sets as measure zero sets and use any of the three
characterizations that is convenient. The proof requires some simple geometric arguments and an application of the
Heine-Borel theorem; it is given in the sections that now follow.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.5. THE MINI-VITALI COVERING THEOREM
211
3∗[c1,d1]
[u,v]
[c1,d1]
Figure 5.1: Note that 3∗[c1,d1] will then include any shorter interval [u,v] that intersects [c1,d1].
5.5.1
Covering lemmas for families of compact intervals
We begin with some simple covering lemmas for ﬁnite and inﬁnite families of compact intervals.
Lemma 5.15 Let C be a ﬁnite family of compact intervals. Then there is a pairwise
disjoint subcollection [ci,di] (i = 1,2,...,m) of that family witha
[
[u,v]∈C
[u,v] ⊂
m
[
i=1
3∗[ci,di].
aBy 3 ∗[u,v] we mean the interval centered at the same point as [u,v] but with three times the
length.
Proof. For [c1,d1] simply choose the largest interval. Note that 3∗[c1,d1] will then include any other interval [u,v] ∈C
that intersects [c1,d1]. See Figure 5.1.
For [c2,d2] choose the largest interval from among those that do not intersect [c1,d1]. Note that together 3 ∗[c1,d1]
and 3∗[c2,d2] include any interval of the family that intersects either [c1,d1] or [c2,d2]. Continue inductively, choosing
[ck+1,dk+1] as the largest interval in C that does not intersect one the previously chosen intervals [c1,d1], [c2,d2], . . . ,
[ck,dk]. Stop when you run out of intervals to select.
The next covering lemma addresses arbitrary families of compact intervals.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

212
CHAPTER 5. COVERING THEOREMS
Lemma 5.16 Let C be any collection of compact intervals. Then the set
G =
[
[u,v]∈C
(u,v)
is an open set that contains all but countably many points of the set
E =
[
[u,v]∈C
[u,v]
Proof. Let
C = {x : x ̸∈G and x = c or x = d for at least one [c,d] ∈C }.
We observe that G is open, being a union of a family of open intervals. Clearly G contains all of E except for points that
are in the set C. To complete the proof of the lemma, we show that C is countable. Write, for n = 1,2,3,...,
Cn = {x : x ̸∈G, x = c for at least one [c,d] ∈C with d −c > 1/n}.
C′
n = {x : x ̸∈G, x = d for at least one [c,d] ∈C with d −c > 1/n}.
We easily show that each Cn and C′
n is countable. For example if c ∈Cn then the interval (c,c+1/n) can contain no
other point of C. This is because there is at least one interval [c,d] from C with d −c > 1/n. Thus (c,c+1/n) ⊂(c,d) ⊂
G. Consequently there can be only countably many such points. It follows that the set C = S∞
n=1(Cn ∪C′
n) is a countable
subset of E.
5.5.2
Proof of the Mini-Vitali covering theorem
We begin with a simple lemma that is the key to the argument, both for our proof of the mini version as well as the proof
of the full Vitali covering theorem.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.5. THE MINI-VITALI COVERING THEOREM
213
Lemma 5.17 Let β be a covering relation and write
G =
[
([u,v],w)∈β
(u,v).
Then G is an open set and, if g = λ(G), is ﬁnite then there must exist a subpartition
π ⊂β for which
∑
([u,v],w)∈π
(v−u) ≥g/6.
(5.10)
In particular
G′ = G\
[
([u,v],w)∈π
[u,v]
is an open subset of G and λ(G′) ≤5g/6.
Proof. It is clear that the set G of the lemma, expressed as the union of a family of open intervals, must be an open set.
Let {(ai,bi)} be the sequence of component intervals of G. Thus, by deﬁnition,
g = λ(G) =
∞
∑
i=1
(bi −ai).
Choose an integer N large enough that
N
∑
i=1
(bi −ai) > 3g/4.
Inside each open interval (ai,bi), for i = 1, 2, . . . , N, choose a compact interval [ci,di] so that
N
∑
i=1
(di −ci) > g/2.
Write
K =
N
[
i=1
[ci,di]
and note that it is a compact set covered by the family
{(u,v) : ([u,v],w) ∈β}.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

214
CHAPTER 5. COVERING THEOREMS
By the Heine-Borel theorem there must be a ﬁnite subset
([u1,v1],w1), ([u2,v2],w2), ([u3,v3],w3), ...,([um,vm],wm)
from β for which
K ⊂
m
[
i=1
(ui,vi).
By Lemma 5.15 we can extract a subpartition π from this list so that
K ⊂
[
([u,v],w)∈π
3∗[u,v].
and so
∑
([u,v],w∈π
3(v−u) ≥
N
∑
i=1
(di −ci) > g/2.
Statement (5.10) then follows. [Not that we need it here, but recall that Lemma 5.15 allows us to claim that the intervals
in the subpartition π are disjoint, not merely nonoverlapping.]
The ﬁnal statement of the lemma requires just checking the length of a ﬁnite number of the components of G′. We
have removed all the intervals [u,v] from G for which ([u,v],w) ∈π. Since the total length removed is greater than g/6
what remains cannot be larger than 5g/6.
Proof of the Mini-Vitali covering theorem:
We already know that every set of measure zero is full null, and that
every full null set is ﬁne null. To complete the proof we show that every ﬁne null set is a set of measure zero. Let us
suppose that E is not a set of measure zero. We show that it is not ﬁne full then. Deﬁne
ε0 = inf{λ(G) : G open and G ⊃E}.
Since E is not measure zero, ε0 > 0.
Let β be an arbitrary ﬁne cover of E. Deﬁne
G =
[
([u,v],w)∈β
(u,v).
This is an open set and, by Lemma 5.16, G covers all of E except for a countable set. It follows that λ(G) ≥ε0, since
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.6. FUNCTIONS HAVING ZERO VARIATION
215
if λ(G) < ε0 we could add to G a small open set G′ that contains the missing countable set of points and for which the
combined set G∪G′ is an open set containing E but with measure smaller than ε0.
By Lemma 5.17 there must exist a subpartition π ⊂β for which
∑
([u,v],w)∈π
(v−u) ≥ε0/6.
But that means that E is not a ﬁne null set, since this is true for every ﬁne cover β.
5.6
Functions having zero variation
A set E is full null (i.e., measure zero) if there is a full cover β of the set E so that
∑
([u,v],w)∈π
(v−u) < ε
whenever π is a subpartition, π ⊂β. This generalizes easily by considering instead sums
∑
([u,v],w)∈π
|F(v)−F(u)|
for some function F. We have used this deﬁnition in Chapter 4 but repeat and review it here.
Deﬁnition 5.18 Let F be deﬁned on an open set that contains a set E of real num-
bers. We say that F has zero variation on the set E provided that for every ε > 0
there is a full cover β of the set E so that
∑
([u,v],w)∈π
|F(v)−F(u)| < ε
whenever π is a subpartition, π ⊂β.
Lemma 5.19 Let F : (a,b) →R. Then F has zero variation on the open interval
(a,b) if and only if F is constant on (a,b).
Proof. One direction is obvious; the other direction is an application of the Cousin covering lemma. Suppose that F has
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

216
CHAPTER 5. COVERING THEOREMS
zero variation on (a,b). Let ε > 0 and choose a full cover β of the set (a,b) so that
∑
([u,v],w)∈π
|F(v)−F(u)| < ε
whenever π is a subpartition, π ⊂β. If [c,d] ⊂(a,b) then there is a partition π ⊂β of the whole interval [c,d]. Conse-
quently
|F(d)−F(c)| ≤
∑
([u,v],w)∈π
|F(v)−F(u)| < ε.
This holds for every such interval [c,d] and every positive ε. It follows that F must be constant on (a,b).
Lemma 5.20 Let F be deﬁned on an open set that contains each of the sets E1, E2,
E3, . . . and suppose that F has zero variation on each Ei (i = 1,2,3,...). Then F
has zero variation on any subset of the union S∞
i=1 Ei.
Proof. Let ε > 0 and, for each integer i, choose a full cover βi of Ei so that
∑
([u,v],w)∈π
|F(v)−F(u)| < 2−iε
(5.11)
whenever π is a subpartition, π ⊂βi. Construct β as the union of the sequence βi[Ei]. This is a full cover of any subset E
of the union S∞
i=1 Ei. Now simply check that, if π is a subpartition, π ⊂β then
∑
([u,v],w)∈π
|F(v)−F(u)| ≤
∞
∑
i=1
∑
([u,v],w)∈π[Ei]
|F(v)−F(u)| <
∞
∑
i=1
2−iε = ε.
(5.12)
It follows that F has zero variation on E.
Exercises
Exercise 619 Show that a constant function has zero variation on any set.
Exercise 620 Show that if F has zero variation on a set E then it has zero variation on any subset of E.
Exercise 621 Let E contain a single point x0. What does it mean for F to have zero variation on E?
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.6. FUNCTIONS HAVING ZERO VARIATION
217
Exercise 622 Let E have countably many points. Show that F has zero variation on the set E if and only if F has zero
variation on the singleton sets {e} for each e ∈E.
Exercise 623 Show that N is a null set if and only if the function F(x) = x has zero variation on N.
Exercise 624 Suppose that both the functions F and G have zero variation on a set E. Show that so too does every
linear combination rF +sG.
Exercise 625 Suppose that both the functions F and G have zero variation on a set E. Does it follow that the product
FG must have zero variation on E?
Exercise 626 Show that a continuous function has variation zero on every countable set.
Exercise 627 Show that a function that has variation zero on every countable set must be continuous.
5.6.1
Zero variation and zero derivatives
There is an intimate connection between the notion of zero variation and the fact of zero derivatives. The following two
theorems are central to our theory. Note that zero derivatives imply zero variation and that, conversely, zero variation
implies zero derivatives (but only almost everywhere).
Theorem 5.21 Let F : R →R and suppose that F′(x) = 0 at every point of the set
E. Then F has zero variation on E.
Proof. Fix an integer n and write En = (−n,n)∩E. Let ε > 0 and consider the collection
β = {([u,v],w) : w ∈E, w ∈[u,v] ⊂(−n,n), |F(v)−F(u)| < ε(v−u)}.
By our assumption that F′(x) = 0 at every point of E we see easily that β is a full cover of En. But if π ⊂β is any
subpartition we must have
∑
([u,v],w)∈π
|F(v)−F(u)| <
∑
([u,v],w)∈π
ε(v−u) < 2εn.
This proves that F has zero variation on each set En. It follows from Lemma 5.20 that F has zero variation on the set E
which is, evidently, the union of the sequence of sets {En}.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

218
CHAPTER 5. COVERING THEOREMS
Theorem 5.22 Let F : R →R and suppose that F has zero variation on a set E.
Then F′(x) = 0 at almost every point of the set E.
Proof. This theorem is deeper than the preceding and will require, for us, an appeal to our version of the Vitali covering
theorem. Let N be the set of points x in E at which F′(x) = 0 is false. A ﬁne covering argument allows us to analyze
this. There must be some positive number ε(x) for each x ∈N so that
β1 = {([u,v],w) : w ∈E, |F(v)−F(u)| ≥ε(w)(v−u)}
(5.13)
is a ﬁne cover of N. This is how the full/ﬁne arguments work. For, if not, then there would be some point x in E so that,
for every ε > 0,
β2 = {([u,v],w) : w ∈E, |F(v)−F(u)| < ε(v−u)}
(5.14)
would have to be full at x. But that says exactly that F′(x) = 0. Write Ni = {w ∈N : ε(w) > 1/i} for each integer i and
note that N is the union of the sequence of sets {Ni}.
Fix i. Let η > 0. Since F has zero variation on E we can ﬁnd a full cover β3 of E so that
∑
([u,v],w)∈π
|F(v)−F(u)| < η
(5.15)
whenever π is a subpartition, π ⊂β3. The intersection β = β1 ∩β3 is a ﬁne cover of N.
For the set Ni and any subpartition π ⊂β[Ni] we compute, with some help from (5.13) and (5.15), that
∑
([u,v],w)∈π
(v−u) <
∑
([u,v],w)∈π
ε(w)|F(v)−F(u)|
≤i
∑
([u,v],w)∈π
|F(v)−F(u)| < iη.
This veriﬁes that each set Ni is a ﬁne null set and so, by the Mini-Vitali covering theorem, also a set of measure zero.
Consequently N itself, as the union of a sequence of measure zero sets, is also a set of measure zero. This completes the
proof.
5.6.2
Generalization of the zero derivative/variation
We wish to interpret this result in a much more general manner. Let h be any real-valued function that assigns values
h(([u,v],w)) to pairs ([u,v],w)). We can deﬁne zero variation and zero derivative for h just as easily as we can for a
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.6. FUNCTIONS HAVING ZERO VARIATION
219
function F : R →R.
If h(I,x) is any function which assigns real values to interval-point pairs it will be convenient to have a notation for
the following limits:
limsup
(I,x) =⇒x
h(I,x) = inf
δ>0(sup{h(I,x) : λ(I) < δ, x ∈I})
and
liminf
(I,x) =⇒xh(I,x) = sup
δ>0
(inf{h(I,x) : λ(I) < δ, x ∈I}).
These are just convenient expressions for the lower and upper limits of h(I,x) as the interval I (always assumed to contain
x) shrinks to the point x.
We say that h has a zero derivative at a point w if
limsup
(I,w) =⇒w
¯¯¯¯
h(I,w)
λ(I)
¯¯¯¯ = 0.
This is equivalent to requiring that
lim
δ→0+sup
½¯¯¯¯
h(([u,v],w))
v−u
¯¯¯¯ : u ≤w ≤v, 0 < v−u < δ
¾
= 0.
We say too that h has zero variation on a set E if for every ε > 0 there is a full cover β of E so that
∑
([u,v],w)∈π
|h(([u,v],w))| < ε
whenever π is a subpartition, π ⊂β.
A repeat of the proofs just given, with minor changes, allows us to claim that Theorems 5.21 and 5.22 can be extended
to these general versions:
Theorem 5.23 If h has a zero derivative everywhere in a set E then h has zero
variation on E.
Theorem 5.24 Zero variation for h on a set E implies h has a zero derivative
almost everywhere in E.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

220
CHAPTER 5. COVERING THEOREMS
Exercise 628 Show that if
limsup
(I,x) =⇒x
h(I,x) < t
at every point x of a set E then
{(I,x) : x ∈I, h(I,x) < t}
is a full cover of E.
Exercise 629 Show that if
liminf
(I,x) =⇒xh(I,x) < t
at every point x of a set E then
{(I,x) : x ∈I, h(I,x) < t}
is a ﬁne cover of E.
5.6.3
Absolutely continuous functions
Our formulation of the notions of zero variation and full null set are immediately related by the fact that the function
F(x) = x has zero variation on a set N precisely when that set N is a set of measure zero. We see, then, that F(x) = x
has zero variation on all sets of measure zero. Most functions that we have encountered in the calculus also have this
property. We shall see that all differentiable functions have this property. It plays a vital role in the theory; such functions
are said to be absolutely continuous5.
We ﬁrst introduced this notion in Chapter 4 and we repeat and review it here for convenience.
Deﬁnition 5.25 A function F : (a,b) →R is said to be absolutely continuous on
the open interval (a,b) if F has zero variation on every subset N of the interval
that has measure zero.
Absolute continuity is stronger than continuity.
5Note to the instructor: this notion is strictly more general than the traditional notion (due to Vitali) of a function absolutely continuous on a
compact interval [a,b]. In particular an absolutely continuous function in this sense need not have bounded variation.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.6. FUNCTIONS HAVING ZERO VARIATION
221
Lemma 5.26 If a function F : (a,b) →R is absolutely continuous on the open
interval (a,b) then F is continuous at each point of that interval.
Proof. If F has zero variation on each measure zero subset of (a,b) then F has zero variation on any set {x0} containing
a single point x0 from that interval. If we translate what this would mean into ε, δ language we ﬁnd that for every ε > 0
there must be a δ > 0 so that
|F(v)−F(u)| < ε
if v−u < δ and x0 ∈[u,v]. But this is exactly the statement that F is continuous at the point x0.
The exercises show that most continuous functions we encounter in the calculus will be absolutely continuous. In fact
the only continuous function we have seen so far that is not absolutely continuous is the Cantor function of Section 4.4.
5.6.4
Absolute continuity and derivatives
There is an intimate relationship between the differentiability properties of a function and its absolute continuity prop-
erties. The ﬁrst such connection is easy to make. Our lemma shows that all differentiable functions are absolutely
continuous.
Lemma 5.27 Suppose that F is a real-valued function deﬁned on an open set that
contains the measure zero set N and that F is differentiable at every point of N.
Then F is has zero variation on N.
Proof. For each natural number n let Nn be the collection of those points x in N at which |F′(x)| < n. We show that F
has zero variation on each Nn. It follows then that F is has zero variation on N = S∞
n=1 Nn.
Let ε > 0. Since There must be a full cover β1 of N so that
∑
([u,v],w)∈π
(v−u) < ε/n
whenever π is a subpartition, π ⊂β1. Deﬁne
β2 = {([u,v],w) : w ∈En, |F(v)−F(u)| < n(v−u)}.
This is evidently a full cover of Nn, because |F′(w)| < n for each w ∈Nn.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

222
CHAPTER 5. COVERING THEOREMS
Consequently β = β1 ∩β2 is a full cover of Nn for which
∑
([u,v],w)∈π
|F(v)−F(u)| <
∑
([u,v],w)∈π
n(v−u) < ε
whenever π is a subpartition, π ⊂β. This proves that F has zero variation on Nn. Since N is the union of the sequence of
set Nn this proves our assertion.,
Exercises
Exercise 630 Show that the function F(x) = x is absolutely continuous on every open interval.
Exercise 631 Show that a linear combination of absolutely continuous functions is absolutely continuous.
Exercise 632 Suppose that F : (a,b) →R is is absolutely continuous on the interval (a,b). Show that F must be
pointwise continuous at every point of that interval.
Exercise 633 Show that a Lipschitz function deﬁned on an open interval is absolutely continuous there.
Exercise 634 Give an example of an absolutely continuous function that is not Lipschitz.
Exercise 635 Show that the Cantor function is not absolutely continuous on (0,1).
Exercise 636 Suppose that F : (a,b) →R is differentiable at each point of the open interval (a,b). Show that F is
absolutely continuous on the interval (a,b).
Answer
Exercise 637 Suppose that F : (a,b) →R is differentiable at each point of the open interval (a,b) with countably many
exceptions but that F is pointwise continuous at those exceptional points. Show that F is absolutely continuous on the
interval (a,b).
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.7. LEBESGUE DIFFERENTIATION THEOREM
223
Exercise 638 Suppose that F : (a,b) →R is differentiable at each point of the open interval (a,b) with the exception
of a set N ⊂(a,b). Suppose further that N is a set of measure zero and that F has zero variation on N. Show that F is
absolutely continuous on the interval (a,b).
Exercise 639 Suppose that F : (a,b) →R is absolutely continuous on the interval (a,b). Then by deﬁnition F has zero
variation on every subset of measure zero. Is it possible that F has zero variation on subsets that are not measure zero?
Exercise 640 A function F on an open interval I is said to have ﬁnite derived numbers on a set E ⊂I if, for each x ∈E,
there is a number Mx and one can choose δ > 0 so that
¯¯¯¯
F(x+h)−F(x)
h
¯¯¯¯ ≤Mx
whenever x + h ∈I and |h| < δ. Show that F is absolutely continuous on E if F has ﬁnite derived numbers there.
[cf. Exercise 170.]
5.7
Lebesgue differentiation theorem
Our second application of the Mini-Vitali theorem is to prove a famous and useful theorem of Lebesgue asserting that
functions of bounded variation are almost everywhere differentiable. We shall need this in our study of the Lebesgue
integral in Chapter 7.
Theorem 5.28 Let F : [a,b] →R be a function of bounded variation. Then F is
differentiable at almost every point in (a,b).
Corollary 5.29 Let F : [a,b] →R be a monotonic function. Then F is differen-
tiable at almost every point in (a,b).
The proof of the theorem will require an introduction, ﬁrst, to the upper and lower derivates and then a simple
geometric lemma that allows us to use a ﬁne covering argument to show that the set of points where F′(x) does not exist
is measure zero.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

224
CHAPTER 5. COVERING THEOREMS
5.7.1
Upper and lower derivates
The proof uses the upper and lower derivates. To analyze how a derivative F′(x) may fail to exist we split that failure
into two pieces, an upper and a lower, deﬁned as
DF(x) = inf
δ>0sup
½F(v)−F(u)
v−u
: x ∈[u,v], 0 < v−u < δ
¾
and
DF(x) = sup
δ>0
inf
½F(v)−F(u)
v−u
: x ∈[u,v], 0 < v−u < δ
¾
We will prove that, for almost every point x in (a,b),
DF(x) > −∞,
DF(x) < ∞,
and
DF(x) = DF(x).
From these three assertions it follows that F has a ﬁnite derivative F′(x) at almost every point x in (a,b).
The proof will depend on a ﬁne covering argument. For that we need to recognize the following connection between
derivates and covers. The proof is trivial; it is only a matter of interpreting the statements.
Lemma 5.30 Let F : [a,b] →R, α ∈R, and let
β =
½
([u,v],w) : F(v)−F(u)
v−u
> α, w ∈[u,v] ⊂[a,b]
¾
.
Then, β is a full cover of the set
E1 = {x ∈(a,b) : DF(x) > α}
and a ﬁne cover of the larger set
E2 = {x ∈(a,b) : DF(x) > α}.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.7. LEBESGUE DIFFERENTIATION THEOREM
225
5.7.2
Geometrical lemmas
The proof employs an elementary geometric lemma that Donald Austin6 used in 1965 to give a simple proof of this
theorem. Our proof of the differentiation theorem is essentially his, but written in different language. See also the
version of Michael Botsko7.
Lemma 5.31 (Austin’s lemma) Let G : [a,b] →R, α > 0 and suppose that G(a) ≤
G(b). Let
β =
½
([u,v],w) : G(v)−G(u)
v−u
< −α, w ∈[u,v] ⊂[a,b]
¾
.
Then, for any nonempty subpartition π ⊂β,
α
Ã
∑
([u,v],w)∈π
(v−u)
!
< V(G,[a,b])−|G(b)−G(a)|.
Proof. To prove the lemma, let π1 be a partition of [a,b] that contains the subpartition π. Just write
|G(b)−G(a)| = G(b)−G(a) =
∑
([u,v],w)∈π1
[G(v)−G(u)]
=
∑
([u,v],w)∈π
[G(v)−G(u)]+
∑
([u,v],w)∈π1\π
[G(v)−G(u)]
< −α
Ã
∑
([u,v],w)∈π
[v−u]
!
+V(G,[a,b]).
The statement of the lemma follows.
As a corollary we can replace F with −F to obtain a similar statement.
6D. Austin, A geometric proof of the Lebesgue differentiation theorem. Proc. Amer. Math. Soc. 16 (1965) 220–221.
7M. W. Botsko, An elementary proof of Lebesgue’s differentiation theorem. Amer. Math. Monthly 110 (2003), no. 9, 834–838.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

226
CHAPTER 5. COVERING THEOREMS
Corollary 5.32 Let G : [a,b] →R, α > 0 and suppose that G(b) ≤G(a). Let
β =
½
([u,v],w) : G(v)−G(u)
v−u
> α, w ∈[u,v] ⊂[a,b]
¾
.
Then, for any nonempty subpartition π ⊂β,
α
Ã
∑
([u,v],w)∈π
(v−u)
!
< V(G,[a,b])−|G(b)−G(a)|.
5.7.3
Proof of the Lebesgue differentiation theorem
We now prove the theorem. The ﬁrst step in the proof is to show that at almost every point t in (a,b),
DF(t) = DF(t).
If this is not true then there must exist a pair of rational numbers r and s for which the set
Ers = {t ∈(a,b) : DF(t) < r < s < DF(t)}
is not a set of measure zero. This is because the union of the countable collection of sets Ers contains all points t for
which DF(t) ̸= DF(t).
Let us show that each such set Ers is ﬁne null. By the Mini-Vitali theorem we then know that Ers is a set of measure
zero. Write α = (s−r)/2, B = (r +s)/2, G(t) = F(t)−Bt. Note that
Ers = {t ∈(a,b) : DG(t) < −α < 0 < α < DG(t)}.
Since F has bounded variation on [a,b], so too does the function G. In fact
V(G,[a,b]) ≤V(F[a,b])+B(b−a).
Let ε > 0 and select points
a = s0 < s1 < ··· < sn−1 < sn = b
so that
n
∑
i=1
|G(si)−G(si−1)| > V(G,[a,b])−αε.
Let E′
rs = Ers \ {s1,s2,...,sn−1}. Let us call an interval [si−1,si] black if G(si) −G(si−1) ≥0 and call it red if
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.7. LEBESGUE DIFFERENTIATION THEOREM
227
G(si)−G(si−1) < 0.
For each i = 1,2,3,...,n we deﬁne a covering relation βi as follows. If [si−1,si] is a black interval then
βi =
½
([u,v],w) : G(v)−G(u)
v−u
< −α, w ∈[u,v] ⊂[si−1,si]
¾
.
If, instead, [si−1,si] is a red interval then
βi =
½
([u,v],w) : G(v)−G(u)
v−u
> α, w ∈[u,v] ⊂[si−1,si]
¾
.
Let β = Sn
i=1 βi. Because of Lemma 5.30 we see that this collection β is a ﬁne cover of E′
rs.
Let π be any nonempty subpartition contained in β. Write
πi = π∩βi.
By Lemma 5.31 applied to the black intervals and Corollary 5.31 applied to the red intervals we obtain that
α
Ã
∑
([u,v],w)∈πi
(v−u)
!
< V(G,[si−1,si])−|G(si)−G(si−1)|.
Consequently
α
Ã
∑
([u,v],w)∈π
(v−u)
!
= α
Ã
n
∑
i=1
∑
([u,v],w)∈πi
(v−u)
!
≤
n
∑
i=1
V(G,[si−1,si])−
n
∑
i=1
|G(si −G(si−1)|
≤V(G,[a,b])−[V(G,[a,b])−αε] = αε.
We have proved that β is a ﬁne cover of E′
rs with the property that
∑
([u,v],w)∈π
(v−u) < ε
for every subpartition π ⊂β. It follows that E′
rs is ﬁne null, and hence a set of measure zero. So too then is Ers since the
two sets differ by only a ﬁnite number of points.
We know now that the function F has a derivative, ﬁnite or inﬁnite, almost everywhere in (a,b). We wish to exclude
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

228
CHAPTER 5. COVERING THEOREMS
the possibility of the inﬁnite derivative, except on a set of measure zero.
Let
E∞= {t ∈(a,b) : DF(t) = ∞}.
Choose any B so that F(b)−F(a) ≤B(b−a) and set G(t) = F(t)−Bt. Note that G(b) ≤G(a) which will allow us to
apply Corollary 5.32.
Let ε > 0 and choose a positive number α large enough so that
V(G,[a,b])−|G(b)−G(a)| < αε.
Deﬁne
β =
½
([u,v],w) : G(v)−G(u)
v−u
> α,[u,v] ⊂[a,b]
¾
.
This is a ﬁne cover of E∞. Let π be any subpartition π ⊂β. By our corollary then
α
∑
([u,v],w)∈π
(v−u) < V(G,[a,b])−|G(b)−G(a)| < αε.
We have proved that β is a ﬁne cover of E∞with the property that
∑
([u,v],w)∈πi
(v−u) < ε
for every subpartition π ⊂β. It follows that E∞is ﬁne null, and hence a set of measure zero. The same arguments will
handle the set
E−∞= {t ∈(a,b) : DF(t) = −∞}.
Exercise 641 The formula
d
dx
∞
∑
n=1
Fn(x) =
∞
∑
n=1
d
dxFn(x)
is not generally valid without assumptions about uniform convergence (see Chapter 3). Fubini’s differentiation theo-
rem says that, with some assumptions on the nature of the functions Fn, we can have this differentiation formula, not
everywhere, but almost everywhere. Prove this as an application of the Lebesgue differentiation theorem:
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

5.7. LEBESGUE DIFFERENTIATION THEOREM
229
Theorem 5.33 (Fubini) Let {Fn} be a sequence of monotonic, nondecreasing
functions on the interval [a,b] and suppose that F(x) = ∑∞
n=1 Fn(x) is absolutely
convergent for all a ≤x ≤b. Then, for almost every x in (a,b),
F′(x) =
∞
∑
n=1
F′
n(x).
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

230
CHAPTER 5. COVERING THEOREMS
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

Chapter 6
The Integral
This chapter studies the natural integral on the real line. We started our study of the deﬁnite integral in Chapter 3 with
this limited deﬁnition.
Deﬁnition 6.1 (Naive calculus integral) By the statement
Z b
a F′(x)dx = F(b)−F(a)
we mean that F : [a,b] →R is uniformly continuous and differentiable mostly ev-
erywhere.
In Chapter 4 we replaced this with the correct version. We repeat that deﬁnition now and we shall review some of
the deﬁnitions and properties in this chapter.
Deﬁnition 6.2 (The calculus integral) By the statement
Z b
a F′(x)dx = F(b)−F(a)
we mean that F : [a,b] →R is uniformly continuous and differentiable almost ev-
erywhere, and is absolutely continuous on (a,b).
231
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

232
CHAPTER 6. THE INTEGRAL
To see that the second deﬁnition is a generalization of the ﬁrst requires us to recall that a continuous function that is
differentiable mostly everywhere on an open interval (a,b) is absolutely continuous there (Exercise 503).
The naive version is strong enough for a wide variety of applications and is certainly accessible to calculus students
since it depends only on an understanding of the derivative, continuity, and the mean-value theorem. One discovers that
the deﬁnition is “naive” only when one begins to work on harder problems that arise in working with sequences and
series of integrable functions.
One advantage we shall have in our studies is that the naive calculus integral is a very good teaching tool in preparing
us to study the correct version of integration theory on the real line. It leads by mostly easy proofs and natural arguments
to the full theory without too much detailed development. The Lebesgue integral will appear in Chapter 7 but our
presentation should prove a little easier than the usual introductions to that integral. If one starts with Lebesgue’s
deﬁnition it is necessary ﬁrst to prove all properties of the integral using that deﬁnition. Since we already have an
integration theory developed, we need only check that Lebesgue’s methods can be used to construct the value of the
integral.
6.1
The integral and integrable functions
Here is the formal deﬁnition of the integral. We shall not necessarily always call it a “calculus integral” although that is
the intent. Most authors would call it a “descriptive deﬁnition” of the integral. It describes the situation of integrability
without offering any methods for the computation of the integral. There is an illusion of constructibility since the value
is given as F(b)−F(a) but, in fact, the deﬁnition offers us no method for ever ﬁnding such a function F.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

6.1. THE INTEGRAL AND INTEGRABLE FUNCTIONS
233
Deﬁnition 6.3 (Deﬁnite integral) Let f : (a,b) →R be a function deﬁned at all
points of the open interval (a,b) with the possible exception of a set of measure
zero. Then f is said to be integrable on the compact interval [a,b] provided there
is a function F : [a,b] →R so that
1. F is uniformly continuous on [a,b].
2. F is absolutely continuous on (a,b).
3. F′(x) = f(x) at all points x of (a,b) with the possible exception of a set of
measure zero.
In that case we deﬁne
Z b
a f(x)dx = F(b)−F(a).
Sometimes it is more convenient to state the conditions for the integral with direct attention to the set of exceptional
points where the derivative F′(x) = f(x) may fail. Conditions 1, 2, and 3 of the deﬁnition can be replaced by requiring
instead that
1. F is uniformly continuous on [a,b].
2. There is a set N of measure zero.
3. F′(x) = f(x) at all points x of (a,b) with the possible exception of points in N.
4. F has zero variation on N.
Exercise 504 can be used to show that these four statements are equivalent to the three statements in the deﬁnition.
6.1.1
Inﬁnite integrals
Exactly the same deﬁnition for the inﬁnite integrals
Z ∞
−∞f(x)dx,
Z ∞
a
f(x)dx, and
Z b
−∞f(x)dx
can be given as for the integral over a compact interval.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

234
CHAPTER 6. THE INTEGRAL
Deﬁnition 6.4 Let f be a function deﬁned at every point of (∞,∞) with the possible
exception of a set of measure zero. Then f is said to be integrable on (∞,∞)
provided there is a function F : (−∞,∞) →R so that
1. F is absolutely continuous on (∞,∞).
2. F′(x) = f(x) at all points x with the possible exception of a set of measure
zero.
3. Both limits F(∞) = limx→∞F(x) and F(−∞) = limx→−∞F(x) exist.
In that case the number
Z ∞
−∞f(x)dx = F(∞)−F(−∞), is called the deﬁnite integral
of f on the interval (∞,∞) .
Similar assertions deﬁne
Z b
−∞f(x)dx = F(b)−F(−∞)
and
Z ∞
a
f(x)dx = F(∞)−F(a).
In analogy with the terminology of an inﬁnite series ∑∞
k=1 ak we often say that the integral
R ∞
a f(x)dx converges when
the integral exists. That suggests language asserting that the integral converges absolutely if both integrals
Z ∞
a
f(x)dx and
Z ∞
a | f(x)|dx
exist.
6.1.2
Approximation by Riemann sums
We have seen in Chapter 3 that all naive calculus integrals can be approximated by Riemann sums, pointwise approxi-
mated that is. The same theorem is true for the advanced integration theory. The proof is elementary if detailed.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

6.1. THE INTEGRAL AND INTEGRABLE FUNCTIONS
235
Theorem 6.5 (Henstock’s criterion) Suppose that f is an integrable function de-
ﬁned at every point of a compact interval [a,b]. Then for every ε > 0 there is a full
cover β of [a,b] so that
∑
[u,v],w)∈π
¯¯¯¯
Z v
u f(x)dx−f(w)(v−u)
¯¯¯¯ < ε
and
¯¯¯¯¯
Z b
a f(x)dx−
∑
[u,v],w)∈π
f(w)(v−u)
¯¯¯¯¯ < ε
whenever π is a partition of the interval [a,b] chosen from β.
Note that the function here is deﬁned at every point of the interval [a,b]. We do not usually insist on this, permitting
instead integrable functions to be deﬁned only almost everywhere. The way to make this theorem accessible in general
is assign arbitrary values to the function at points where it is undeﬁned. This does not alter integrability or change the
integral in any way. A frequent convention, given a function f deﬁned almost everywhere on an interval (a,b), is to
work instead with the function g where we take g(x) = f(x) when that exists and g(x) = 0 otherwise.
Proof. Let F be an indeﬁnite integral for f on the interval [a,b]. We can set F(x) = F(a) for x < a, F(x) = F(b) for
x > b and set f(x) = 0 outside of (a,b). We suppose that F′(x) = f(x) for all x excepting a set N of measure zero. Write,
for every integer j = 1,2,3,...,
Nj = {x ∈N : j −1 ≤|f(x)| < j}
and note that the set N is the union of the sequence of sets {Nj}. Each Nj is a measure zero set and so there is a full
cover βj of Nj so that
¯¯¯¯¯
∑
([u,v],w)∈π
(v−u)
¯¯¯¯¯ < ε2−j−2 j−1
whenever π is a subpartition chosen from βj. Note that
∑
([u,v],w)∈π
|f(w)|(v−u) < ε2−j−1
whenever π is a subpartition chosen from β j[Nj]. Since N is measure zero and F is absolutely continuous we know that
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

236
CHAPTER 6. THE INTEGRAL
F has zero variation on N. Consequently there is full cover β′ of N so that
∑
([u,v],w)∈π
|F(v)−F(u)| < ε/4
whenever π is a subpartition chosen from β′.
Finally F′(x) = f(x) for all x ̸∈N. Thus
β′′ =
½
([u,v],w) : |F(v)−F(u)−f(w)(v−u)| ≤ε v−u
2(b−a)
¾
is a full cover of R\N.
Now we can construct our full cover β needed in the statement of the theorem. Let
β = β′′ ∪
Ã
β′[N]∩
∞
[
j=1
βj[Nj]
!
.
Let π be a partition of the interval [a,b] chosen from β and estimate
∑
[u,v],w)∈π
|F(v)−F(u)−f(w)(v−u)|.
If w is a point where F′(w) = f(w) then
|F(v)−F(u)−f(w)(v−u)| ≤ε v−u
2(b−a)
and the contribution to the sum of such terms is evidently smaller than ε/2.
If w is not a point where F′(w) = f(w) then we can treat the sum of such terms by estimating using the larger value
|F(v)−F(u)−f(w)(v−u)| ≤|F(v)−F(u)|+| f(w)|(v−u).
The sum of the terms
|F(v)−F(u)|
where w ∈N cannot exceed ε/4. The sum of the terms
| f(w)|(v−u)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

6.2. THE HENSTOCK-KURZWEIL CHARACTERIZATION OF THE INTEGRAL
237
where w ∈Nj cannot exceed ε2−j−1. Putting these together shows that
∑
[u,v],w)∈π
¯¯¯¯
Z v
u f(x)dx−f(w)(v−u)
¯¯¯¯ ≤
∑
[u,v],w)∈π
|F(v)−F(u)−f(w)(v−u)| < ε
as required. The ﬁnal inequality of the theorem follows directly from this inequality since
¯¯¯¯¯
Z b
a f(x)dx−
∑
[u,v],w)∈π
f(w)(v−u)
¯¯¯¯¯ ≤
∑
[u,v],w)∈π
¯¯¯¯
Z v
u f(x)dx−f(w)(v−u)
¯¯¯¯
follows immediately from the triangle inequality.
6.2
The Henstock-Kurzweil characterization of the integral
We turn to the converse direction suggested by the preceding section. Since every calculus integral can be captured
by the Riemann sums approach we ask whether the Riemann sums approach captures the calculus integral itself. The
answer is yes and we devote all of this section to exploring this relation. At the end we will have two tools for working
with our integration theory: the methods of the calculus integral and the methods of Henstock and Kurzweil.
6.2.1
Deﬁnition of Henstock and Kurzweil
So far we have the Henstock criterion as a necessary condition for integrability of a function. Our goal now is to show
that it is also a sufﬁcient condition for integrability. That then gives us two very different ways of completely describing
the integral. Our ﬁrst way is to state the integral as a calculus integral that merely interprets conditions under which
Z b
a F′(x)dx = F(b)−F(a)
is valid. The second describes the integral as a limit of Riemann sums, similar to the methods that Riemann originally
used to describe his integral.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

238
CHAPTER 6. THE INTEGRAL
Deﬁnition 6.6 (Henstock-Kurzweil) Suppose that f is a function deﬁned at every
point of a compact interval [a,b]. Then f is integrable in the Henstock-Kurzweil
sense if there is a real number I such that for every ε > 0 there is a full cover β of
[a,b] so that
¯¯¯¯¯I −
∑
[u,v],w)∈π
f(w)(v−u)
¯¯¯¯¯ < ε
whenever π is a partition of the interval [a,b] chosen from β. In that case the
number I is set equal to
I =
Z b
a f(x)dx
and this integral is said to be interpreted in the Henstock-Kurzweil sense.
6.2.2
Upper and lower integrals
The Henstock-Kurzweil integral can be studied by means of an upper and a lower integral. This is a useful way to
develop the theory and so we can leave Deﬁnition 6.6 behind us for a moment and start the theory of this integral in
this way. This notion of using upper and lower integrals goes back at least to 1875 and is due to Jean-Gaston Darboux
(1842–1917).
Deﬁnition 6.7 For a function f : [a,b] →R we deﬁne an upper integral by
Z b
a f(x)dx = inf
β sup
π⊂β
(
∑
([u,v],w)∈π
f(w)(v−u)
)
where the supremum is taken over all partitions π of [a,b] contained in β, and the
inﬁmum over all full covers β of the interval [a,b].
Note that the ﬁrst step is to estimate the largest possible value for the Riemann sums for partitions π of [a,b] contained
in β, and the second step is to reﬁne this by shrinking to smaller and smaller full covers β.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

6.2. THE HENSTOCK-KURZWEIL CHARACTERIZATION OF THE INTEGRAL
239
Similarly we deﬁne a lower integral as
Z b
a f(x)dx = sup
β
inf
π⊂β
(
∑
([u,v],w)∈π
f(w)(v−u)
)
where, again, π is a partition of [a,b] and β is a full cover.
Exercises
Exercise 642 Check that, for any full cover β,
−∞< sup
π⊂β
∑
([u,v],w)∈π
f(w)(v−u).
Exercise 643 Check that
Z b
a f(x)dx = −
Z b
a [−f(x)]dx.
Exercise 644 Let f : [a,b] →R. Show that
Z b
a f(x)dx ≤
Z b
a f(x)dx.
Answer
Exercise 645 Show that a function f can be altered at a ﬁnite number of points without altering the values of the upper
and lower integrals.
Exercise 646 Show that a function f can be altered at a countable number of points without altering the values of the
upper and lower integrals.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

240
CHAPTER 6. THE INTEGRAL
Exercise 647 Let f : [a,c] →R and suppose that a < b < c. Show that
Z c
a f(x)dx =
Z b
a f(x)dx+
Z c
b f(x)dx,
assuming the sum makes sense.
Answer
Exercise 648 Let f, g : R →R. What rule should hold for the upper and lower integrals
Z b
a [ f(x)+g(x)]dx and
Z b
a [ f(x)+g(x)]dx?
Exercise 649 Deﬁne a partition π to be endpointed if only elements of the form ([u,w],w) or ([w,v],w) appear and there
is no element ([u,v],w) ∈π for which u < w < v. Show that a restriction in the deﬁnition of integrals to use endpointed
partitions only would not change the theory at all.
Answer
6.2.3
The integral and integrable functions
If the upper and lower Henstock-Kurzweil integrals are identical we write the common value as
Z b
a f(x)dx =
Z b
a f(x)dx =
Z b
a f(x)dx
allowing ﬁnite or inﬁnite values. We say in this case that the integral is determined. When the integral is not determined
then (by Exercise 642)
Z b
a f(x)dx <
Z b
a f(x)dx
and there is no integral.
If the integral is determined and this value is also ﬁnite then f is Henstock-Kurzweil integrable and
Z b
a f(x)dx
is called the Henstock-Kurzweil integral, now assuming a ﬁnite value. Our ﬁrst goal will be to check that this account is
equivalent to Deﬁnition 6.6.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

6.2. THE HENSTOCK-KURZWEIL CHARACTERIZATION OF THE INTEGRAL
241
Exercises
Exercise 650 Let f : [a,b] →R show that a sufﬁcient condition for f to be Henstock-Kurzweil integrable on [a,b] with
c =
R b
a f(x)dx is that for every ε > 0 there is a full cover so that
¯¯¯¯¯c−
∑
([u,v],w)∈π
f(w)(v−u)
¯¯¯¯¯ < ε
for every partition π of [a,b] contained in β.
Answer
Exercise 651 Let f : [a,b] →R be a Henstock-Kurzweil integrable function and let π be any partition of [a,b]. Show
that
¯¯¯¯¯
Z b
a f(x)dx−
∑
([u,v],w)∈π
f(w)(v−u)
¯¯¯¯¯ ≤
∑
([u,v],w)∈π
ω f([u,v])λ([u,v]).
Here ω f(I) denotes the oscillation of the function f on the interval I, deﬁned as
sup
s,t∈I
| f(s)−f(t)|.
Exercise 652 Show that a Henstock-Kurzweil integrable function f can be altered at a ﬁnite number of points without
altering the value of the integral.
Exercise 653 Show that a Henstock-Kurzweil integrable function f can be altered at a countable number of points
without altering the value of the integrals.
Exercise 654 Deﬁne a function to be uniformly integrable [i.e., Riemann integrable] if in the deﬁnition one uses the
uniformly full covers from Section 5.1.6, rather than the more general full covers. Show that a function that is integrable
in this narrow sense must be bounded.
Exercise 655 Continuing the study of the Riemann integral begun in the preceding exercise, show that a function f that
is uniformly integrable on an interval [a,b] must satisfy the following restrictive property: for every ε > 0 there must
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

242
CHAPTER 6. THE INTEGRAL
exist a partition π for which
∑
([u,v],w)∈π
ω f([u,v])(v−u) < ε.
Exercise 656 Continuing the preceding two exercises (if you have the patience to work this hard on the Riemann inte-
gral), show that a function f is uniformly integrable on an interval [a,b] if and only if it is bounded and satisﬁes the
following property: for every ε > 0 there must exist a partition π for which
∑
([u,v],w)∈π
ω f([u,v])(v−u) < ε.
6.2.4
First Cauchy criterion
Our ﬁrst criterion for integrability returns us to Deﬁnition 6.6 and shows that the upper/lower integral approach is
equivalent to the original Henstock-Kurzweil deﬁnition.
Theorem 6.8 A necessary and sufﬁcient condition in order for a function f :
[a,b] →R to be Henstock-Kurzweil integrable on a compact interval [a,b] is that
there is a number c so that for all ε > 0 a full cover β of [a,b] can be found so that
¯¯¯¯¯
∑
([u,v],w)∈π
f(w)(v−u)−c
¯¯¯¯¯ < ε
for all partitions π of [a,b] contained in β.
Proof. In Exercise 650 we checked that this condition is sufﬁcient. On the other hand, if we know that f is integrable
with c =
R b
a f(x)dx then, using the deﬁnition of the upper integral, for any ε > 0 we choose a full cover β1 so that
∑
([u,v],w)∈π
f(w)(v−u) < c+ε
for all partitions π of [a,b] contained in β1. Similarly, using the deﬁnition of the lower integral, we choose a full cover
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

6.2. THE HENSTOCK-KURZWEIL CHARACTERIZATION OF THE INTEGRAL
243
β2 so that
∑
([u,v],w)∈π
f(w)(v−u) > c−ε
for all partitions π of [a,b] contained in β2. Take β = β1 ∩β2. This is a full cover with the property stated.
6.2.5
Second Cauchy criterion
Theorem 6.9 A necessary and sufﬁcient condition in order for a function f :
[a,b] →R to be Henstock-Kurzweil integrable on a compact interval [a,b] is that,
for all ε > 0, a full cover β of [a,b] can be found so that
¯¯¯¯¯ ∑
(I,w)∈π
∑
(I′,w′)∈π′
[ f(w)−f(w′)]λ(I ∩I′)
¯¯¯¯¯ < ε
(6.1)
for all partitions π, π′ of [a,b] contained in β.
Proof. Start by checking that when π and π′ are both partitions of the same interval [a,b] then, for any subinterval I of
[a,b]
λ(I) =
∑
(I′,w′)∈π′
λ(I ∩I′)
from which it is easy to see that
∑
(I,w)∈π
f(w)λ(I) = ∑
(I,w)∈π ∑
(I′,w′)∈π′
f(w)λ(I ∩I′).
This allows the difference that would normally appear in a Cauchy type criterion
¯¯¯¯¯ ∑
(I,w)∈π
f(w)λ(I)−∑
(I′,w′)∈π′
f(w′)λ(I′)
¯¯¯¯¯
to assume the simple form given in (6.1). In particular that statement can be rewritten as
¯¯¯¯¯ ∑
(I,w)∈π
f(w)λ(I)−∑
(I′,w′)∈π′
f(w)λ(I)
¯¯¯¯¯ < ε.
(6.2)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

244
CHAPTER 6. THE INTEGRAL
The condition is necessary. For if f is integrable then the ﬁrst Cauchy criterion supplies a full cover β so that
¯¯¯¯¯ ∑
(I,w)∈π
f(w)λ(I)−c
¯¯¯¯¯ < ε/2
for all partitions π of [a,b] contained in β. Any two Riemann sums would both be this close to c and hence within ε of
each other.
Suppose the condition holds. We can see from (6.2) that the upper and lower integrals must be ﬁnite. We wish to
show that they are equal.
Using the deﬁnition of the upper integral, there is at least one partition π of [a,b] contained in β with
∑
(I,w)∈π
f(w)λ(I) >
Z b
a f(x)dx−ε
Using the deﬁnition of the lower integral, there is at least one partition π′ of [a,b] contained in β with
∑
(I,w)∈π′
f(w)λ(I) <
Z b
a f(x)dx+ε.
Together with (6.2) these show that
Z b
a f(x)dx−
Z b
a f(x)dx < 2ε.
Since ε is an arbitrary positive number the upper and lower integrals are equal.
Exercise 657 (McShane’s criterion) A function f : [a,b] →R is said to satisfy McShane’s criterion on [a,b] provided
that for all ε > 0 a full cover β can be found so that
∑
(I,w)∈π
∑
(I′,w′)∈π′
¯¯f(w)−f(w′)
¯¯λ(I ∩I′) < ε
for all partitions π, π′ of [a,b] contained in β. Show that if a function satisﬁes this criterion then both f and | f| are
integrable on [a,b].
Note: the converse is proved in Chapter 7.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

6.2. THE HENSTOCK-KURZWEIL CHARACTERIZATION OF THE INTEGRAL
245
6.2.6
Proof of equivalence
Our goal now is to prove that the Henstock-Kurzweil integral is exactly the same as the general calculus integral. One
direction is simple and we have already stated it in Henstock’s criterion (Theorem 715).
Here is the outline of the proof in this section. If the goal is only to effect a proof then the steps are not of much
importance in themselves. They are interesting, however, for a different reason: if one wished to start with Deﬁnition 6.6
and use the Henstock-Kurzweil integral without ﬁrst deﬁning the calculus integral, then these are the ﬁrst steps in
developing the theory of that integral. In particular this section outlines the proof of the fundamental theorem of the
calculus for the Henstock-Kurzweil integral.
Step 1 Henstock-Kurzweil integrability on subintervals.
Step 2 The Henstock criterion for the Henstock-Kurzweil indeﬁnite integral.
Step 3 The Henstock criterion implies uniform continuity and absolute continuity of the indeﬁnite Henstock-Kurzweil
integral.
Step 4 The Henstock criterion implies the almost everywhere differentiability of the indeﬁnite Henstock-Kurzweil inte-
gral.
Lemma 6.10 (HK integrability on subintervals) If f : [a,b] →R is Henstock-
Kurzweil integrable then it is also integrable on any compact subinterval of [a,b].
Proof. Let ε > 0. Suppose that f is Henstock-Kurzweil integrable on [a,b] and [c,d] is a compact subinterval. Take any
full cover β so that the second Cauchy criterion is satisﬁed for β.
Observe that for every pair of partitions π1, and π2 ⊂β of the subinterval [c,d], there is a subpartition π from β so
that π1 ∪π and π1 ∪π are partitions of the full interval [a,b]. In particular then
¯¯¯¯¯ ∑
(I,w)∈π1
f(w)λ(I)−∑
(I,w)∈π2
f(w)λ(I)
¯¯¯¯¯ =
¯¯¯¯¯
∑
(I,w)∈π∪π1
f(w)λ(I)−
∑
(I,w)∈π∪π2
f(w)λ(I)
¯¯¯¯¯ < ε
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

246
CHAPTER 6. THE INTEGRAL
The integrability of f on [c,d] follows now from the second Cauchy criterion.
Lemma 6.11 (The indeﬁnite HK integral) If f : [a,b] →R is Henstock-Kurzweil
integrable then there is a function F : [a,b] →R, called an indeﬁnite integral for
f, so that
Z d
c f(x)dx = F(d)−F(c)
for every compact subinterval [c,d] of [a,b].
Proof. Lemma 6.10 supplies the existence of the integral on the subintervals. Then the function
F(t) =
Z t
a f(x)dx
(a ≤t ≤b)
will have this property.
To see this ﬁrst check that if a < c < d ≤b then
Z c
a f(x)dx+
Z d
c f(x)dx =
Z d
a f(x)dx.
(6.3)
Consequently
Z d
c f(x)dx =
Z d
a f(x)dx−
Z c
a f(x)dx = F(d)−F(c)
as we require. Thus the remainder of the proof is devoted to proving the identity (6.3). We will leave as an exercise to
the reader to attempt this using the ﬁrst Cauchy criterion. This also follows from Exercise 647.
Lemma 6.12 (Henstock’s criterion for the HK integral) A necessary and sufﬁ-
cient condition for a function f : [a,b] →R to be Henstock-Kurzweil integrable on
a compact interval [a,b] and for F to be its indeﬁnite integral is that for every ε > 0
there exists a full cover β of [a,b] such that
∑
([u,v],w)∈π
|F(v)−F(u)−f(w)(v−u)| < ε,
(6.4)
for every subpartition π of [a,b] contained in β.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

6.2. THE HENSTOCK-KURZWEIL CHARACTERIZATION OF THE INTEGRAL
247
Proof. Suppose that this criterion holds. Then (6.4) immediately shows that
¯¯¯¯¯F(b)−F(a)−
∑
([u,v],w)∈π
f(w)(v−u)
¯¯¯¯¯
=
¯¯¯¯¯
∑
([u,v],w)∈π
[F(v)−F(u)−f(w)(v−u)
¯¯¯¯¯
≤
∑
([u,v],w)∈π
|F(v)−F(u)−f(w)(v−u)| < ε.
It follows that F(b) −F(a) =
R b
a f(x)dx by the ﬁrst Cauchy criteria. The same argument will work on any subinterval
to check that F is an indeﬁnite integral for f.
Conversely let us suppose that F is an indeﬁnite integral for f on [a,b] and ε > 0. By the Cauchy criterion there is a
full cover β such that
¯¯¯¯¯F(b)−F(a)−
∑
([u,v],w)∈π
f(w)(v−u)
¯¯¯¯¯ < ε/4
(6.5)
for every partition π of [a,b] contained in β and it will be our goal to establish (6.4) from this.
Fix π and let π′ ⊂π be any nonempty subset. Since β is full and contains partitions of any compact interval, we will
ﬁnd a useful way to supplement the subpartition π′ so as to form a useful partition of [a,b]: we write
π\π′ = {([u1,v1],w1),([u2,v2],w2),...([uk,vk],wk)}.
Our hypothesis requires F to be an indeﬁnite integral for f on each [ui,vi] (i = 1,2,...,k) and so for each i = 1,2,...,k
we are able to select a partition πi ⊂β of the interval [ui,vi] in such a way that
¯¯¯¯¯F(vi)−F(ui)−
∑
([u,v],w)∈πi
f(w)(v−u)
¯¯¯¯¯ < ε/(4k).
(6.6)
Thus if we augment π′ to form
π′′ = π∪π1 ∪π2 ∪···∪πk
we obtain a partition of [a,b] contained in β and thus also satisfying an inequality of the form (6.5). Computing with
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

248
CHAPTER 6. THE INTEGRAL
these ideas, we see
∑
([u,v],x)∈π′
[F(v)−F(u)] = F(b)−F(a)−
k
∑
i=1
[F(vi)−F(ui)]
and
∑
([u,v],w)∈π′
f(w)(v−u) =
∑
([u,v],w)∈π′′
f(w)(v−u)−
k
∑
i=1
Ã
∑
([u,v],w)∈πi
f(w)(v−u)
!
.
Putting these together with the estimates (6.5) and (6.6) we obtain
¯¯¯¯¯
∑
([u,v],x)∈π′
[[F(v)−F(u)]−f(x)(v−u)]
¯¯¯¯¯ ≤
¯¯¯¯¯F(b)−F(a)−
∑
([u,v],x)∈π′′
f(x)(v−u)
¯¯¯¯¯
+
k
∑
i=1
¯¯¯¯¯[F(vi)−F(ui)]−
∑
([u,v],x)∈πi
f(x)(v−u)
¯¯¯¯¯ < ε/4+k(ε/(4k) = ε/2.
Let us emphasize what we now see: if π′ is any subset of π we have obtained this inequality:
¯¯¯¯¯
∑
([u,v],w)∈π′
[F(v)−F(u)−f(x)(v−u)]
¯¯¯¯¯ < ε/2.
To complete the proof let
π+ = {([u,v],w) ∈π : F(v)−F(u)−f(w)(v−u) ≥0}
and
π−= {([u,v],w) ∈π : F(v)−F(u)−f(w)(v−u) < 0}.
Then
∑
([u,v],w)∈π+
|F(v)−F(u)−f(w)(v−u)|
=
∑
([u,v],w)∈π+
[F(v)−F(u)−f(w)(v−u)] < ε/2
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

6.2. THE HENSTOCK-KURZWEIL CHARACTERIZATION OF THE INTEGRAL
249
and
∑
([u,v],w)∈π−
|F(v)−F(u)−f(w)(v−u)|
=
∑
([u,v],w)∈π−
−[F(v)−F(u)−f(w)(v−u)] < ε/2.
Adding the two inequalities proves (6.4).
Lemma 6.13 (HK integral is equivalent to the calculus integral) Suppose that
the function f : [a,b] →R is Henstock-Kurzweil integrable on a compact interval
[a,b] and that F is its indeﬁnite Henstock-Kurzweil integral. Then
1. F is uniformly continuous on [a,b].
2. F is absolutely continuous on (a,b).
3. F′(x) = f(x) for almost every x in (a,b).
Proof. Let F be extended to allow F(x) = F(a) for x < a and F(x) = F(b) for x > b and let f be extended so that
f(x) = 0 if x is not in the interval [a,b]. We can make use of the Henstock criterion proved in Lemma 715 and this
extended version of F and f to claim that, for every ε > 0 there exists a full cover β (of the real line) such that
∑
([u,v],w)∈π
|F(v)−F(u)−f(w)(v−u)| < ε,
for every subpartition π contained in β.
Write
h([u,v],w) = |F(v)−F(u)−f(w)(v−u)|
and observe that, in the language of Section 5.6.1, this function h has zero variation. Consequently it has a zero derivative
almost everywhere. But at every point w at which h has a zero derivative, F′(w) = f(w). In particular F′(x) = f(x) for
almost every x in (a,b).
Take now any set N of measure zero. Write, for every integer j = 1,2,3,...
Nj = {x ∈N : j −1 ≤|f(x)| < j}.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

250
CHAPTER 6. THE INTEGRAL
Each of these is a measure zero set and so there is a full cover β j of Nj so that
¯¯¯¯¯
∑
([u,v],w)∈π
(v−u)
¯¯¯¯¯ < ε j−1
and, hence,
∑
([u,v],w)∈π
| f(w)|(v−u) < ε
whenever π is a subpartition chosen from βj. The covering relation β′ = β∩βj is a full cover of Nj and
∑
([u,v],w)∈π
|F(v)−F(u)| ≤
∑
([u,v],w)∈π
|F(v)−F(u)−f(w)(v−u)|
+
∑
([u,v],w)∈π
| f(w)|(v−u) < 2ε.
It follows that F has zero variation on Nj. This is true for each j = 1,2,3,... and so F has zero variation on N. This is
true for any set of measure zero. Consequently F is absolutely continuous on (−∞,∞). In particular it is continuous at
each point and so also uniformly continuous on [a,b].
6.3
Elementary properties of the integral
All of our elementary properties of the integral are anticipated by the naive calculus integral which shares all the same
properties in somewhat weaker forms. Our interest here is that these same properties now hold under very general
hypotheses. The reader should be able to construct proofs that use either the descriptive version of the calculus integral
or the Henstock-Kurzweil version.
6.3.1
Integration and order
Theorem 6.14 Suppose that f, g are both integrable on a compact interval [a,b]
and that f(x) ≤g(x) for almost every x in that interval. Then
Z b
a f(x)dx ≤
Z b
a g(x)dx.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

6.3. ELEMENTARY PROPERTIES OF THE INTEGRAL
251
6.3.2
Integration of linear combinations
Theorem 6.15 Suppose that f, g are both integrable on a compact interval [a,b] .
Then so too is any linear combination r f +sg and
Z b
a [r f(x)+sg(x)] dx = r
µZ b
a f(x)dx
¶
+s
µZ b
a g(x)dx
¶
.
6.3.3
Integrability on subintervals
Theorem 6.16 Suppose that f is integrable on a compact interval [a,b] . Then f
is integrable on any compact subinterval of [a,b].
6.3.4
Additivity
Theorem 6.17 If f is integrable on each of the intervals [a,b], [b,c], and [a,c] then
Z c
a f(x)dx =
Z b
a f(x)dx+
Z c
b f(x)dx.
6.3.5
Change of variable
Let φ : [a,b] →R be a strictly increasing differentiable function. We would expect from elementary formulas of the
calculus that
Z φ(b)
φ(a) f(x)dx =
Z b
a f(φ(t))φ′(t)dt.
If f is itself everywhere a derivative then this could be justiﬁed. If f is assumed only to be integrable then a different
proof, using φ to map full covers and partitions, is needed.
Theorem 6.18 (Change of variable) Let φ : R →R be a strictly increasing, dif-
ferentiable function. If f : R →R is integrable on [φ(a),φ(b)] then
Z φ(b)
φ(a) f(x)dx =
Z b
a f(φ(t))φ′(t)dt.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

252
CHAPTER 6. THE INTEGRAL
Proof. Let ε > 0 and deﬁne β to be the collection of all pairs ([x,y],z) subject only to the conditions that
¯¯¯¯
φ(y)−φ(x)
y−x
−φ′(z)
¯¯¯¯ <
ε
2(b−a)|(1+| f(φ(z)|).
Since φ is everywhere differentiable this is a full cover. Note that we can write φ(y)−φ(x) also as λ(J) where J = φ([x,y])
is just the compact interval that φ maps [x,y] onto.
Write
β′
1 = {(φ([x,y]),φ(x)) : ([x,y],z) ∈β1}
and check that β′
1 is also a full cover. Observe that elements (J,x) = (φ([x,y]),φ(z)) of β′
1 must satisfy
| f(φ(x))λ(φ([x,y]))−f(φ(x))φ′(x)λ([x,y])| < ελ([x,y])/2(b−a).
The expression f(φ(t))λ(φ([x,y])) here is better viewed as f(x)λ(J).
Choose a full cover β′
2 so that
¯¯¯¯¯
Z φ(b)
φ(a) f(x)dx−∑
(J,x)∈π′
f(x)λ(J)
¯¯¯¯¯ < ε/2
for all partitions π′ ⊂β′
2 of the interval [φ(a),φ(b)]. Write β2 for the collection of all (I,x) for which (I,x) = (φ(J),φ(t))
for some (J,t) ∈β′
2. This is a full cover of [a,b].
Write β = β1 ∩β2. Check that β is a full cover of [a,b] and check that
¯¯¯¯¯
Z φ(b)
φ(a) f(x)dx−∑
(I,x)∈π
f(φ(x))φ′(x)λ(I)
¯¯¯¯¯ < ε
for all partitions π ⊂β of the interval [a,b]. An appeal to the ﬁrst Cauchy criterion then completes the proof.
6.3.6
Integration by parts
Integration by parts formula:
Z b
a F(x)G′(x)dx = F(b)G(b)−F(a)G(b)−
Z b
a F′(x)G(x)dx.
(6.7)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

6.3. ELEMENTARY PROPERTIES OF THE INTEGRAL
253
The formula can be derived from the product rule for derivatives:
d
dx (F(x)G(x)) = F(x)G′(x)+F′(x)G(x)
which holds at any point where both functions are differentiable. One must then give strong enough hypotheses that the
function F(x)G(x) is an indeﬁnite integral for the function
F(x)G′(x)+F′(x)G(x)
in the sense needed for our integral.
The most general statement is the following: if f and g are both integrable on [a,b] and F and G are their indeﬁnite
integrals on that interval then Fg+ fG is integrable on [a,b] and
Z b
a (F(x)g(x)+ f(x)G(x)) dx = F(b)G(b)−F(a)G(b).
In particular the usual formula (6.7) holds if and only if one of the two integrals in that statement exists. The proof is
easiest to deduce from the Stieltjes version
Z b
a F(x)dG(x)+G(x)dF(x) = F(b)G(b)−F(a)G(b)
(6.8)
that we will study in Chapter 8. The reader may wish to try, however, to prove it directly.
Remark: For the Lebesgue integral of Chapter 7 the integration by parts formula is available but not quite as straight-
forward. It is possible that Fg + fG is integrable on [a,b] but that only one of Fg and fG is Lebesgue integrable (i.e.,
absolutely integrable) on [a,b]. For example take F(x) = x and G(x) = xcosx−2 on [0,1]. It is also possible neither is
Lebesgue integrable: take F(x) = x1/2 sinx−1 and G(x) = x1/2 cosx−1.
6.3.7
Derivative of the integral
If f is integrable on an interval [a,b] then the formula
d
dx
Z x
a f(t)dt = f(x)
holds at almost every point in (a,b). This is merely by deﬁnition. To make a claim, however, at some particular point
the following simple observation is useful. We have seen it before in our study of the naive calculus integral. The proof
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

254
CHAPTER 6. THE INTEGRAL
is the same.
Theorem 6.19 Let f : [a,b] →R be an integrable function on the interval [a,b].
Let
F(t) =
Z t
a f(x)dx
(a ≤t ≤b).
Assume that x0 ∈[a,b] is a point of continuity of f. Then
1. If a < x0 < b then F′(x0) = f(x0).
2. If a = x0 then the right hand derivative F′
+(a) = f(a).
3. If x0 = b then the left hand derivative F′
−(b) = f(b).
Proof. Let x0 be a point of continuity of f and let ε > 0. Then there is a δ > 0 so that | f(x)−f(x0)| < ε if |x−x0| < δ
and x ∈[a,b]. Let [u,v] ⊂[a,b] be any interval that contains x0 and has length less than δ. Simply compute
¯¯¯¯
Z v
u f(x)dx−f(x0)(v−u)
¯¯¯¯ =
¯¯¯¯
Z v
u f(x)dx−
Z v
u f(x0)dx
¯¯¯¯
≤
Z v
u |f(x)−f(x0)| dx ≤ε(v−u).
From this the conclusions of the theorem are easy to check.
6.3.8
Null functions
A function is a null function if it is equal to zero at every point with only a small set of exceptions. It is immediately
clear that every null function has a constant indeﬁnite integral. Thus the following statements are obvious.
Theorem 6.20 Let f : [a,b] →R be a null function. Then f is integrable on [a,b]
and
Z b
a f(x)dx = 0.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

6.3. ELEMENTARY PROPERTIES OF THE INTEGRAL
255
Theorem 6.21 Let f : [a,b] →R be an integrable function with the property that
Z d
c f(x)dx = 0 for all [c,d] ⊂[a,b].
Then f is a null function.
Corollary 6.22 Let f : [a,b] →R be a nonnegative integrable function with the
property that
Z b
a f(x)dx = 0.
Then f is a null function.
6.3.9
Monotone convergence theorem
The formula
lim
n→∞
Z b
a fn(x)dx =
Z b
a
³
lim
n→∞fn(x)
´
dx
is extremely useful but not generally valid. If the sequence of integrable functions { fn} is monotone then this does hold.
Theorem 6.23 (Monotone convergence theorem) Let
fn : [a,b] →R
(n =
1,2,3,...) be a nondecreasing sequence of integrable functions and suppose that
f(x) = lim
n→∞fn(x)
for almost every x in [a,b]. Then
Z b
a f(x)dx = lim
n→∞
Z b
a fn(x)dx.
(6.9)
In particular, if the limit exists and is ﬁnite the function f is integrable on [a,b] and
the identity (6.9) holds. If the limit is inﬁnite then the function f is not integrable
but the integral is determined and
Z b
a f(x)dx = ∞.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

256
CHAPTER 6. THE INTEGRAL
Here we are using the ideas from Section 6.2.2 that allow us to express an integral as inﬁnite. This was not available
to us in our study of the calculus integral but the Henstock-Kurzweil theory of upper and lower integrals allowed this.
The proof of Theorem 6.23 is given in Section 6.3.11 below.
6.3.10
Summing inside the integral
We establish here that the summation formula
Z b
a
Ã
∞
∑
n=1
fn(x)
!
dx =
∞
∑
n=1
µZ b
a fn(x)dx
¶
is possible for nonnegative integrable functions.
Theorem 6.24 (summing inside the integral) Let fn : [a,b] →R (n = 1,2,3,...)
be a sequence of nonnegative integrable functions and suppose that
f(x) =
∞
∑
n=1
fn(x)
for almost every x. Then
Z b
a f(x)dx =
∞
∑
n=1
µZ b
a fn(x)dx
¶
.
In particular, if the series converges the function f is integrable on [a,b] and the
identity (6.12) holds. If the series diverges then the function f is not integrable but
the integral is determined and
Z b
a f(x)dx = ∞.
The proof is obtained from the two lemmas given in Section 6.3.11 below.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

6.3. ELEMENTARY PROPERTIES OF THE INTEGRAL
257
6.3.11
Two convergence lemmas
The monotone convergence theorem and the formula for summing inside the integral are directly related by the following
observation. If
f1(x) ≤f2(x) ≤f3(x) ≤...
and
lim
n→∞fn(x) = f(x)
then
f(x) = f1(x)+
∞
∑
n=1
(fn(x)−fn−1(x))
expresses f as the sum of a series. Thus it is enough to prove Theorem‘6.24. This is obtained from the following two
lemmas.
Lemma 6.25 Suppose that f, f1, f2, . . . is a sequence of nonnegative functions
deﬁned on a compact interval [a,b]. If, for almost every x
f(x) ≥
∞
∑
n=1
fn(x),
then
Z b
a f(x)dx ≥
∞
∑
n=1
µZ b
a fn(x)dx
¶
.
(6.10)
Proof. We can assume that the inequality assumed is valid for every x; simply redeﬁne fn(x) = 0 for those points in the
null set where the inequality doesn’t work. The resulting functions will have the same lower integrals as fn.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

258
CHAPTER 6. THE INTEGRAL
Let ε > 0. Take any integer N and choose full covers βn (n = 1,2,...,N) so that all the Riemann sums1
∑
π
fn(w)(v−u) ≥
Z b
a fn(x)dx−ε2−n
whenever π ⊂βn is a partition of [a,b]. (If the integrals here are not ﬁnite then there is nothing to prove, since both sides
of the inequality (6.10) will be inﬁnite.)
Let
β =
N
\
n=1
βn.
This too is a full cover, one that is contained in all of the others.
Take any partition of [a,b] with π ⊂β, and compute
∑
π
f(w)(v−u) ≥∑
π
Ã
N
∑
n=1
fn(w)(v−u)
!
=
N
∑
n=1
µ
∑
π
fn(w)(v−u)
¶
≥
N
∑
n=1
µZ b
a fn(x)dx−ε2−n
¶
.
This gives a lower bound for all Cauchy sums and hence, since ε is arbitrary, shows that
Z b
a f(x)dx ≥
N
∑
n=1
µZ b
a fn(x)dx
¶
.
As this is true for all N the inequality (6.10) must follow.
1We simplify our notation for Riemann sums a bit by replacing
∑
([u,v],w)∈π
f(w)(v−u) by ∑
π
f(w)(v−u).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

6.3. ELEMENTARY PROPERTIES OF THE INTEGRAL
259
Lemma 6.26 Suppose that f, f1, f2, . . . is a sequence of nonnegative functions
deﬁned on a compact interval [a,b]. If, for almost every x
f(x) ≤
∞
∑
n=1
fn(x),
then
Z b
a f(x)dx ≤
∞
∑
n=1
ÃZ b
a fn(x)dx
!
.
(6.11)
Proof. As before, we can assume that the inequality assumed is valid for every x; simply redeﬁne f(x) = 0 for those
points in the null set where the inequality doesn’t work. The resulting function will have the same integral and same
upper integral as f.
This lemma is similar to the preceding one, but requires a bit of bookkeeping and a new technique with the covers.
Let t < 1 and choose for each x ∈[a,b] the ﬁrst integer N(x) so that
t f(x) ≤
N(x)
∑
n=1
fn(x).
Choose, again and using the same ideas as before, full covers βn (n = 1,2,...) so that β1 ⊃β2 ⊃β3 ... and all
Riemann sums2
∑
π
fn(w)(v−u) ≤
Z b
a fn(x)dx+ε2−n
whenever π ⊂βn is a partition of [a,b]. (Again, if the integrals here are not ﬁnite then there is nothing to prove, since the
larger side of the inequality (6.11) will be inﬁnite.)
Let
En = {x ∈[a,b] : N(x) = n}.
2As before, we simplify our notation for Riemann sums by replacing
∑
([u,v],w)∈π
f(w)(v−u) by ∑
π
f(w)(v−u).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

260
CHAPTER 6. THE INTEGRAL
We use these sets to carve up the covering relations. Write
βn[En] = {([u,v],w) ∈βn : w ∈En}.
There must be a full cover β so that
β[En] ⊂βn[En]
for all n = 1,2,3,....
Take any partition of [a,b] with π ⊂β. Let N be the largest value of N(x) for the ﬁnite collection of pairs (I,x) ∈π.
We need to carve the partition π into a ﬁnite number of disjoint subsets by writing, for j = 1,2,3,...,N,
πj = {([u,v],w) ∈π : w ∈E j}
and
σ j = πj ∪πj+1 ∪···∪πN.
for integers j = 1,2,3,...,N. Note that
σ j ⊂βj
and that
π = π1 ∪π2 ∪···∪πN.
Check the following computations, making sure to use the fact that for x ∈Ei,
t f(x) ≤f1(x)+ f2(x)+···+ fi(x).
∑
π
t f(w)(v−u) =
N
∑
i=1∑
πi
t f(w)(v−u)
≤
N
∑
i=1∑
πi
(f1(w)+ f2(w)+···+ fi(w))(v−u)
=
N
∑
j=1
Ã
∑
σ j
f j(w)(v−u)
!
≤
N
∑
j=1
ÃZ b
a f j(x)dx+ε2−j
!
≤
∞
∑
j=1
ÃZ b
a f j(x)dx
!
+ε.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

6.3. ELEMENTARY PROPERTIES OF THE INTEGRAL
261
This gives an upper bound for all Cauchy sums and hence, since ε is arbitrary, shows that
Z b
a t f(x)dx ≤
∞
∑
n=1
ÃZ b
a fn(x)dx
!
.
As this is true for all t < 1 the inequality (6.11) must follow too.
Exercises
Exercise 658 Give an example to show that it is possible that
R b
a f(x)dx = ∞in Theorem 6.24.
Exercise 659 Give an example to show that it is possible for the Theorem 6.24 to fail if we drop the assumption that the
functions are nonnegative in the theorem.
Exercise 660 Let fn : [a,b] →R (n = 1,2,3,...) be a sequence of absolutely integrable functions and suppose that
∞
∑
n=1
| fn(x)| < ∞
for almost every x and that
∞
∑
n=1
µZ b
a | fn(x)|dx
¶
< ∞.
Then show that
f(x) =
∞
∑
n=1
fn(x)
is ﬁnite for almost every x in [a,b], is absolutely integrable, and that
Z b
a f(x)dx =
∞
∑
n=1
µZ b
a fn(x)dx
¶
.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

262
CHAPTER 6. THE INTEGRAL
6.4
Equi-integrability
We can use Deﬁnition 6.6 to describe a uniform version of integrability that is useful in discussions of the convergence
of sequences of integrable functions.
Deﬁnition 6.27 (equi-integrability) Suppose that { fn} is a sequence of integrable
functions deﬁned at every point of a compact interval [a,b]. Then { fn} is said to
be equi-integrable on [a,b] if, for every ε > 0, there is a full cover β of [a,b] so that
¯¯¯¯¯
Z b
a fn(x)dx−
∑
[u,v],w)∈π
fn(w)(v−u)
¯¯¯¯¯ < ε
whenever π is a partition of the interval [a,b] chosen from β.
Uniform convergence is a sufﬁcient condition for equi-integrability, but the condition itself is much more general.
Lemma 6.28 Suppose that { fn} is a sequence of integrable functions deﬁned at
every point of a compact interval [a,b] and that { fn} is uniformly convergent on
[a,b]. Then { fn} is equi-integrable on [a,b].
Equi-integrability along with pointwise convergence gives a simply stated criterion for taking the limit inside the
integral.
Theorem 6.29 Suppose that { fn} is a sequence of equi-integrable functions de-
ﬁned at every point of a compact interval [a,b] and that { fn} is pointwise conver-
gent on [a,b] to a function f. Then f is integrable on [a,b] and
Z b
a f(x)dx = lim
n→∞
Z b
a fn(x)dx.
(6.12)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

Chapter 7
Lebesgue’s Integral
Lebesgue’s program is the construction of the value of the integral
Z b
a f(x)dx
directly from the measure and the values of the function f in the integral. Our formal deﬁnition of the integral appears
to do this. Since full covers are not themselves, in general, constructible from the function being integrated we cannot
claim that our integral is constructed in the sense Lebesgue intends.
For his program he invented the integral as a heuristic device, imagined what properties it should possess and then
went about discovering how to construct it based on this ﬁction. At the end he then had to take his construction as the
deﬁnition itself. For us to follow the same program is much easier: we have an integral, we know many of its properties,
and we can use this information to construct it.
This chapter presents an introduction to Lebesgue’s methods, but backwards in a sense from conventional presenta-
tions. We already have a formal deﬁnition of the integral, so we do not need to deﬁne an integral by Lebesgue’s method.
We need to show how to construct the value of an object
R b
a f(x)dx that we have already deﬁned by other means.
263
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

264
CHAPTER 7. LEBESGUE’S INTEGRAL
7.1
The Lebesgue integral
The Lebesgue integral is a special case of the general calculus integral. It is not merely a special case, but certainly the
most important special case.
Deﬁnition 7.1 Let f be a function deﬁned almost everywhere on an interval [a,b].
Then f is said to be Lebesgue integrable if f is absolutely integrable, i.e., if both f
and | f| are integrable on [a,b].
Functions that are integrable but not Lebesgue integrable are said to be nonabsolutely integrable. The theory of such
functions is less powerful and more delicate than the theory of the Lebesgue integrable functions. There are also fewer
applications. We return to this topic in Chapter 9.
7.2
Lebesgue measure
We deﬁne the following three versions of Lebesgue measure (similar to the three versions of a measure zero set) for a
set E ⊂R:
• λ(E) = inf{λ(G) : G open and G ⊃E }.
• λ∗(E) = inf
β
Ã
sup
π⊂β
∑
([u,v],w)∈π
(v−u)
!
where the inﬁmum is taken over all full covers β of the set E and π ⊂β is an arbitrary subpartition.
• λ∗(E) = inf
β
Ã
sup
π⊂β
∑
([u,v],w)∈π
(v−u)
!
where the inﬁmum is taken over all ﬁne covers β of the set E and π ⊂β is an arbitrary subpartition.
The ﬁrst of these λ is Lebesgue’s original version of his measure. We have already (in Section 5.2.1) deﬁned the
Lebesgue measure of open sets. This deﬁnition extends that, by a simple inﬁmum, to all sets. The deﬁnition of the full
measure λ∗is closely related to the integral.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.2. LEBESGUE MEASURE
265
Lemma 7.2 Let E be a set of real numbers contained in an interval [a,b]. Then
λ∗(E) =
Z b
a χE(x)dx.
The three deﬁnitions are equivalent, a fact which is proved as the Vitali covering theorem in Section 7.3 below.
7.2.1
Basic property of Lebesgue measure
Theorem 7.3 Lebesgue measure λ is a nonnegative real-valued set function de-
ﬁned for all sets of reals numbers that is a measurea on R, i.e., it has the following
properties:
1. λ(/0) = 0.
2. For any sequence of sets E, E1, E2, E3, . . . for which
E ⊂
∞
[
n=1
En
the inequality
λ(E) ≤
∞
∑
n=1
λ(En)
must hold.
aMost authors would call this an outer measure.
This result is often described by the following language that splits the property (2) in two parts:
Subadditivity: λ
Ã ∞
[
n=1
En
!
≤
∞
∑
n=1
λ(En).
Monotonicity: λ(A) ≤λ(B) if A ⊂B.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

266
CHAPTER 7. LEBESGUE’S INTEGRAL
Since we have three representations of the Lebesgue measure, as λ, λ∗, or as λ∗we can prove this using any one of
the three. The exercises ask for all three; any one would sufﬁce in view of the Vitali covering theorem proved in the next
section.
Exercises
Exercise 661 Establish the identity
λ∗(E) =
Z b
a χE(x)dx
for any set E ⊂[a,b].
Answer
Exercise 662 Prove that λ is a measure in the sense of Theorem 7.3.
Answer
Exercise 663 Prove that λ∗is a measure in the sense of Theorem 7.3.
Exercise 664 Prove that λ∗is a measure in the sense of Theorem 7.3.
Exercise 665 Prove that λ(A) < t if and only if there is an open set G that contains all but countably many points of A
and for which λ(G) < t.
7.3
Vitali covering theorem
These three measures are identical and we can use any version. The identity λ = λ∗= λ∗is Vitali’s theorem, although
his theorem is normally expressed in different language.1
The proof is just a bit more difﬁcult than the proof of the narrower version, the mini-Vitali theorem given in Sec-
tion 5.5, where we showed that sets of measure zero were equivalent to both full null and ﬁne null sets.
Theorem 7.4 (Vitali Covering Theorem) λ = λ∗= λ∗.
1The language here, will no doubt, shock some traditionalists for whom it appears to suggest Lebesgue inner and outer measure. But this has
nothing to do with inner/outer measure. The measures λ∗and λ∗are those derived from full and ﬁne covers.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.3. VITALI COVERING THEOREM
267
7.3.1
Classical version of Vitali’s theorem
Vitali’s covering theorem asserts that the measure of an arbitrary set can be determined from full and ﬁne covers of that
set. The basic computation about ﬁne covers is the following lemma, known as the classical version of Vitali’s theorem.
Lemma 7.5 (Vitali covering theorem) Let β be a ﬁne cover of a bounded set E
and suppose that ε > 0. Then there must exist a subpartition π ⊂β for which
λ

E \
[
([u,v],w)∈π
[u,v]

< ε.
(7.1)
Proof. For the proof of this theorem we need only one simple fact (Exercise 665) about the Lebesgue measure λ(E) of
a real set A:
⋆λ(A) < ε if and only if there is an open set G containing all but countably many points of A and for which
λ(G) < ε.
Thus the proof is really about open sets. Indeed in our proof we use only the Lebesgue measure of open sets and several
covering lemmas.
The proof is just a repeated application of Lemma 5.17. Since E is bounded there is an open set U1 containing E for
which λ(U1) < ∞. If λ(U1) < ε then, since E ⊂U1, λ(E) < ε and there is nothing more to prove: take π = /0 and the
statement (7.1) is satisﬁed. If λ(U1) ≥ε we start our process.
We prune β by the open set U1: deﬁne β1 = β(U1). Note that this, too, is a ﬁne cover of E. Set
G1 =
[
([u,v],w)∈β1
(u,v).
Then G1 is an open set and g1 = λ(G1) < λ(U1) is ﬁnite. We know from Lemma 5.16, that G1 covers all of E except for
a countable set. [We shall ignore countable sets in this proof, to keep the bookkeeping simple]. By Lemma 5.17 there
must exist a subpartition π1 ⊂β1 for which
U2 = G1 \
[
([u,v],w)∈π
[u,v]
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

268
CHAPTER 7. LEBESGUE’S INTEGRAL
is an open subset of G1 and
λ(U2) ≤5g1/6 ≤5λ(U1)/6.
Deﬁne
E1 = E \
[
([u,v],w)∈π1
[u,v].
If λ(U2) < ε then λ(E1) < ε. This is because U2 is an open set containing all of E1 except possibly some countable set;
thus ⋆stated above implies that λ(E1) < ε. But if λ(E1) < ε the process can stop: take π = π1 and the statement (7.1) is
satisﬁed.
If λ(U2) ≥ε we continue our process. Deﬁne β2 = β(U2) and note that this is a ﬁne cover of E1 (i.e., the points in E
not already handled by the subpartition π1 or the countably many points of E discarded in the ﬁrst stage of our proof).
Set
G2 =
[
([u,v],w)∈β2
(u,v).
Then G2 is an open set and
g2 = λ(G2) ≤λ(U2).
As before, we know from Lemma 5.16, that G2 covers all of E1 except for a countable set. [We are ignoring countable
sets in this proof, throw these points away].
Again applying Lemma 5.17, we ﬁnd a subpartition π2 ⊂β2 for which
U3 = G2 \
[
([u,v],w)∈π2
[u,v]
is an open subset of G2 and λ(U3) ≤5g2/6. Deﬁne
E2 = E1 \
[
([u,v],w)∈π2
[u,v]
= E \
[
([u,v],w)∈π1∪π2
[u,v].
If λ(U3) < ε then λ(E2) < ε. This because U3 is an open set containing all of E2 except possibly some countable set;
thus ⋆stated above implies that λ(E2) < ε. But if λ(E2) < ε the process can stop: take π = π1 ∪π2 and the statement
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.3. VITALI COVERING THEOREM
269
(7.1) is satisﬁed. [Be sure to check that the intervals from π1 have been arranged to be disjoint from the intervals in π2.]
This process is continued, inductively, until it stops. It certainly must stop since
λ(Uk+1) < 5
6λ(Uk) ≤··· ≤
µ5
6
¶k
λ(U1)
so that eventually λ(Uk+1) < ε and λ(Ek) < ε. Take
π = π1 ∪π2 ∪...πk
and the statement (7.1) is satisﬁed.
7.3.2
Proof that λ = λ∗= λ∗.
The inequality
λ∗≤λ∗≤λ
is trivial. First of all, any full cover is also a ﬁne cover so that λ∗≤λ∗must be true. Second, if λ(E) < t there is an open
set G containing E for which it is also true that λ(G) < t. But then we can deﬁne a covering relation β to consist of all
pairs ([u,v],w) provided w ∈[u,v] ⊂G. This is a full cover of E. Note that
∑
([u,v],w)∈π
(v−u) ≤λ(G) < t
whenever π ⊂β is an arbitrary subpartition. It follows that λ∗(E) < t. As this is true for all t,
λ∗(E) ≤λ(E).
Finally, then, Lemma 7.5 completes the proof. Let β be any ﬁne cover of a bounded set E and suppose that ε > 0.
Then there must exist a subpartition π ⊂β for which
λ

E \
[
([u,v],w)∈π
[u,v]

< ε.
(7.2)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

270
CHAPTER 7. LEBESGUE’S INTEGRAL
In particular, using subadditivity measure property of λ,
λ(E) ≤λ

E \
[
([u,v],w)∈π
[u,v]

+
∑
([u,v],w)∈π
λ([u,v])
<
∑
([u,v],w)∈π
(v−u)+ε.
So, since this is true for any ﬁne cover of E,
λ(E) ≤λ∗(E)+ε.
It follows that λ(E) ≤λ∗(E) for all bounded sets E.
That establishes the identity λ = λ∗= λ∗for all bounded sets. The extension to unbounded sets can be accomplished
with the standard measure properties.
7.4
Density theorem
As an application of the Vitali covering theorem we prove the density theorem. This asserts that for an arbitrary set E
almost every point is a point of density, a point x where
λ(E ∩[u,v])
λ([u,v])
→1
as [u,v] shrinks to x.
Theorem 7.6 Almost every point of an arbitrary set E is a point of density.
Proof. To deﬁne this with a bit more precision write
d(E,x) = sup
δ>0
inf
½λ(E ∩[u,v])
λ([u,v])
: u ≤x ≤v, 0 < v−u < δ
¾
.
This is called the lower density of E at x. The theorem asserts that
d(E,x) = 1
at almost every point x of E.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.4. DENSITY THEOREM
271
We may assume that E is bounded. Take any α < 1 and deﬁne
Eα = {x ∈E : d(E,x) < α}
and
E′ = {x ∈E : d(E,x) < 1}.
We show that Eα is necessarily a set of measure zero. It follows that E′ is then a set of measure zero since evidently
E′ =
∞
[
n=1
E
n
n+1 .
Fix α < 1 and any open set G containing Eα, and deﬁne
β = {([u,v],w) : u ≤x ≤v, λ(E ∩[u,v]) < αλ([u,v])}.
This is a ﬁne cover of Eα, and since G is an open set containing Eα, the pruned relation β(G) is also a ﬁne cover of Eα.
Let ε > 0. By the Vitali covering theorem (Lemma 7.5) there must exist a subpartition π ⊂β(G) for which
λ

Eα \
[
([u,v],w)∈π
[u,v]

< ε.
(7.3)
Now we simply compute, using subadditivity, that
λ(Eα) ≤λ

Eα \
[
([u,v],w)∈π
[u,v]

+
∑
([u,v],w)∈π
λ(Eα ∩[u,v])
≤ε+
∑
([u,v],w)∈π
λ(E ∩[u,v])
≤ε+α
∑
([u,v],w)∈π
λ([u,v]) ≤ε+αλ(G).
We deduce that λ(Eα) ≤λ(G) for all such open sets G and hence that λ(Eα) ≤αλ(Eα). This is possible only if
λ(Eα) = 0.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

272
CHAPTER 7. LEBESGUE’S INTEGRAL
7.5
Additivity
Lebesgue measure is subadditive in general on the union of two sets E1 and E2. The subadditivity formula is
λ(A∩(E1 ∪E2)) ≤λ(A∩E1)+λ(A∩E2)
We know that this same subadditivity formula holds for a sequence of sets {Ei}:
λ
Ã
A∩
Ã ∞
[
i=1
Ei
!!
≤
∞
∑
i=1
λ(A∩Ei).
We now ask for conditions under which we can claim equality (not inequality). The additivity formula we wish to
investigate is
λ
Ã
A∩
Ã ∞
[
i=1
Ei
!!
=
∞
∑
i=1
λ(A∩Ei)?
Our ﬁrst observation is that this is possible if the sets {Ei} are separated by open sets. This means merely that there
exist open sets Gi and G j that have no point in common, with Ei ⊂Gi and E j ⊂G j. This is stronger than the requirement
that Ei and E j have no point in common. But note that two disjoint closed sets can always be separated in this fashion.
Lemma 7.7 Let E1 and E2 be sets that are separated by open sets. Then, for any
set A
λ(A∩(E1 ∪E2)) = λ(A∩E1)+λ(A∩E2).
Proof. Let us use the full version λ∗. We know that
λ∗(A∩(E1 ∪E2)) ≤λ∗(A∩E1)+λ∗(A∩E2).
Let us prove the opposite direction. Let β be any full cover of A ∩(E1 ∪E2). Select G1 and G2, disjoint open sets
containing E1 and E2 (respectively). Then β(G1 ∪G2) is necessarily a full cover of A∩(E1 ∪E2). Note that β(G1) is a
full cover of A ∩E1 and that β(G2) is a full cover of A ∩E2. If t1 < λ∗(A ∩E1) and t2 < λ∗(A ∩E2) then there must be
subpartitions π1 ⊂β(G1) and π2 ⊂β(G2) with
∑
([u,v],w)∈π1
(v−u) > t1
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.5. ADDITIVITY
273
and
∑
([u,v],w)∈π2
(v−u) > t2.
It follows that β contains a subpartition π = π1 ∪π2 for which
∑
([u,v],w)∈π
(v−u) > t1 +t2.
From this we deduce that λ∗(A∩(E1 ∪E2)) > t1 +t2. Then
λ∗(A∩(E1 ∪E2)) ≥λ∗(A∩E1)+λ∗(A∩E2)
follows.
Corollary 7.8 Let E1, E2, E3, . . . be a sequence of pairwise disjoint subsets of R
and write
E =
∞
[
i=1
Ei.
Suppose that each pair of sets in the sequence are separated by open sets. Then,
for any set A,
λ(A∩E) =
∞
∑
i=1
λ(A∩Ei).
Proof. We know from the usual measure properties that
λ(A∩E) ≤
∞
∑
i=1
λ(A∩Ei).
We also know that
λ(A∩(E1 ∪E2)) = λ(A∩E1)+λ(A∩E2).
An inductive argument would show, too, that for any n > 1,
λ(A∩(E1 ∪E2 ···∪En)) = λ(A∩E1)+λ(A∩E2)+···+λ(A∩En).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

274
CHAPTER 7. LEBESGUE’S INTEGRAL
Thus, from the monotonicity property of measures,
n
∑
i=1
λ(A∩Ei) ≤λ(A∩E) ≤
∞
∑
i=1
λ(A∩Ei).
From this the corollary evidently follows.
Corollary 7.9 Let E1, E2, E3, . . . be a sequence of pairwise disjoint closed subsets
of R. Then, for any set A,
λ(A∩E) =
∞
∑
i=1
λ(A∩Ei).
To push the countable additivity one step further we use the previous corollary in a natural way. This looks like a
highly technical lemma, but it is the basis and motivation for our deﬁnition of measurable sets and the theory is more
natural than it might appear. The proof is left as an exercise; working through a proof should make it clear how and why
the measurability deﬁnition in the next section works.
Lemma 7.10 Let E1, E2, E3, . . . be a sequence of pairwise disjoint subsets of R
and write
E =
∞
[
i=1
Ei.
Suppose that for every ε > 0 and for every n there is an open set Gn so that En \Gn
is closed and so that λ(Gn) < ε. Then, for any set A,
λ(A∩E) =
∞
∑
i=1
λ(A∩Ei).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.6. MEASURABLE SETS
275
7.6
Measurable sets
7.6.1
Deﬁnition of measurable sets
Deﬁnition 7.11 An arbitrary subset E of R is measurablea if for every ε > 0 there
is an open set G with λ(G) < ε and so that E \G is closed.
aMost advanced courses will start with a different deﬁnition of measurable and later on show that
this property used here is equivalent in certain settings. See Section 7.8.2 for the connections.
Thus a set is measurable if it is “almost closed.” Immediately from this deﬁnition we see that all closed sets are
measurable and that all null sets are measurable. The deﬁnition is exactly designed to produce the following Theorem.
Theorem 7.12 Let E1, E2, E3, . . . be a sequence of pairwise disjoint measurable
subsets of R and write
E =
∞
[
i=1
Ei.
Then, for any set A,
λ(A∩E) =
∞
∑
i=1
λ(A∩Ei).
Proof. This follows immediately from Lemma 7.12.
7.6.2
Properties of measurable sets
Theorem 7.13 The class of all measurable subsets of R forms a Borel familya that
contains all closed sets and all null sets.
aThe deﬁnition of a Borel family is outlined in the proof.
Proof. The class of all measurable subsets of R forms a Borel family: it a collection of sets that is closed under the
formation of unions and intersections of sequences of its members, and contains the complement of each of its members.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

276
CHAPTER 7. LEBESGUE’S INTEGRAL
Here are the details of the proof. Items (3), (4), and (5) are speciﬁcally the requirements that the class of measurable sets
forms a Borel family.
We prove that the family of all measurable sets has the following properties:
1. Every null set is measurable.
2. Every closed set is measurable.
3. If E1, E2, E3, is a sequence of measurable sets then the union S∞
n=1 En is also measurable.
4. If E1, E2, E3, is a sequence of measurable sets then the intersection T∞
n=1 En is also measurable.
5. If E is measurable then the complement R\E is also measurable.
Items (1) and (2) are easy. Let us prove (5) ﬁrst. Let E be measurable and E′ is its complement. Let ε > 0 and choose
an open set G1 so that E \G1 is closed and λ(G1) < ε/2. Let O be the complement of E \G1; evidently O is open.
First ﬁnd an open set G2 with λ(G2) < ε/2 so that O\G2 is closed. [Simply display the component intervals of O,
handle the inﬁnite components ﬁrst, and then a ﬁnite number of the bounded components.] Now observe that
E′ \(G1 ∪G2) = O\G2
is a closed set while G1 ∪G2 is an open set with measure smaller than ε. This veriﬁes that E′ is measurable.
Now check (e): let ε > 0 and choose open sets Gn so that λ(Gn) < ε2−n and each En \Gn is closed. Observe that the
set G = S∞
n=1 Gn is an open set for which
λ(G) ≤
∞
∑
n=1
λ(Gn) ≤
∞
∑
n=1
ε2−n = ε.
Finally
E′ = E \G =
∞
\
n=1
(En \Gn)
is closed.
For (4), write E′
n for the complementary set to En. Then the complement of the set A = S∞
n=1 En is the set B = T∞
n=1 E′
n.
Each E′
n is measurable by (5) and hence B is measurable by (d). The complement of B, namely the set A, is measurable
by (5) again.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.6. MEASURABLE SETS
277
7.6.3
Increasing sequences of sets
If
E1 ⊂E2 ⊂E3 ⊂...
is an increasing sequence of sets then we would expect that
λ
Ã ∞
[
n=1
En
!
= lim
n→∞λ(En).
This is particularly easy to prove if the sets are measurable. We show that this identity holds in general.
Theorem 7.14 Suppose that {En} is an increasing sequence of sets. Then
λ
Ã ∞
[
n=1
En
!
= lim
n→∞λ(En).
Proof. Suppose ﬁrst that the sets are measurable. Then simply write A0 = /0 and An = En \En−1 for each n = 1,2,3,....
Then these sets are also measurable and Lemma 7.12 shows us that
λ
Ã ∞
[
n=1
En
!
= λ
Ã ∞
[
n=1
An
!
=
∞
∑
n=1
λ(An) =
∞
∑
n=1
(λ(En)−λ(En−1)) = lim
n→∞λ(En).
Now we drop the assumption that the sets {En} are measurable. Observe ﬁrst that
λ
Ã ∞
[
n=1
En
!
≥lim
m→∞λ(Em)
merely because each set Em is contained in this union.
To prove the opposite inequality, begin by choosing measurable sets Hn ⊃En with the same measures, i.e., so that
λ(En) = λ(Hn). (For example, start with a sequence of open sets Gnm containing En with λ(En) ≤λ(Gnm) ≤λ(En)+1/n
and take Hn = T∞
m=1 Gnm.)
Write Vm = T∞
k=m Hk and V = S∞
m=1Vm. These sets are all measurable because we choose the {Hk} to be measurable.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

278
CHAPTER 7. LEBESGUE’S INTEGRAL
We obtain
λ(V) = lim
m→∞λ(Vm).
But Em ⊂Vm ⊂Hm so that V ⊃E and λ(Em) = λ(Vm) = λ(Hm). Consequently
λ
Ã ∞
[
n=1
En
!
≤λ(V) = lim
m→∞λ(Vm) = lim
m→∞λ(Em).
This completes the proof.
7.6.4
Existence of nonmeasurable sets
We turn now to a search for Lebesgue nonmeasurable sets. The ﬁrst proof that nonmeasurable sets must exist is due to
G. Vitali (1875–1932). It uses the axiom of choice which has to this point not been needed in the text.
Theorem 7.15 There exist subsets of R that are not Lebesgue measurable.
Proof. Let I = [−1
2, 1
2]. We deﬁne an equivalence relation on this interval by relating points to rational numbers; we use
Q to denote the set of all rationals. For x,y ∈I write x ∼y if x−y ∈Q. For all x ∈I, let
K(x) = {y ∈I : x−y ∈Q} = {x+r ∈I : r ∈Q}.
We show that ∼is an equivalence relation. It is clear that x ∼x for all x ∈I and that if x ∼y then y ∼x. To show transitivity
of ∼, suppose that x,y,z ∈I and x −y = r1 and y −z = r2 for r1,r2 ∈Q. Then x −z = (x −y) + (y −z) = r1 + r2, so
x ∼z. Thus the set of all equivalence classes K(x) forms a partition of I: S
x∈I K(x) = I, and if K(x) ̸= K(y), then
K(x)∩K(y) = /0.
Let A be a set containing exactly one member of each equivalence class. (The existence of such a set A follows from
the axiom of choice.) We show that A is nonmeasurable. Let 0 = r0,r1,r2,... be an enumeration of Q ∩[−1,1], and
deﬁne
Ak = {x+rk : x ∈A}
so that Ak is obtained from A by the translation x →x+rk.
Then
[−1
2, 1
2] ⊂
∞
[
k=0
Ak ⊂[−3
2, 3
2].
(7.4)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.6. MEASURABLE SETS
279
To verify the ﬁrst inclusion, let x ∈[−1
2, 1
2] and let x0 be the representative of K(x) in A. We have {x0} = A∩K(x). Then
x−x0 ∈Q∩[−1,1], so there exists k such that x−x0 = rk. Thus x ∈Ak. The second inclusion is immediate: the set Ak
is the translation of A ⊂[−1
2, 1
2] by the rational number rk ∈[−1,1].
Suppose now that A is measurable. It is easy to see that then each of the translated sets Ak is also measurable and that
λ(Ak) = λ(A) for every k. But the sets {Ai} are pairwise disjoint. If z ∈Ai ∩A j for i ̸= j, then xi = z−ri and xj = z−r j
are in different equivalence classes. This is impossible, since xi −x j ∈Q. It now follows from (7.4) and the countable
additivity of λ for measurable set that
1 = λ([−1
2, 1
2]) ≤λ(
∞
[
k=1
Ak) =
∞
∑
k=1
λ(Ak) ≤λ([−3
2, 3
2]) = 3.
(7.5)
Let α = λ(A) = λ(Ak). From (7.5), we infer that
1 ≤α+α+··· ≤3.
(7.6)
But it is clear that no number α can satisfy both inequalities in (7.6). The ﬁrst inequality implies that α > 0, but the
second implies that α = 0. Thus A is nonmeasurable.
The proof has invoked the axiom of choice in order to construct the nonmeasurable set. One might ask whether it is
possible to give a more constructive proof, one that does not use this principle. This question belongs to the subject of
logic rather than analysis, and the logicians have answered it. In 1964, R. M. Solovay showed that, in Zermelo–Fraenkel
set theory with a weaker assumption than the axiom of choice, it is consistent that all sets are Lebesgue measurable. On
the other hand, the existence of nonmeasurable sets does not imply the axiom of choice. Thus it is no accident that our
proof had to rely on the axiom of choice: it would have to appeal to some further logical principle in any case.2
2See also K. Ciesielski, “How good is Lebesgue measure?” Math. Intelligencer 11(2), 1989, pp. 54–58, for a discussion of material related to
this section and for references to the literature. That same author’s text, Set Theory for the Working Mathematician, Cambridge University Press,
London (1997) is an excellent source for students wishing to go deeper into these ideas.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

280
CHAPTER 7. LEBESGUE’S INTEGRAL
7.7
Measurable functions
Deﬁnition 7.16 An arbitrary function f : R →R is measurable if for any real num-
ber r
Ar = {x ∈R : f(x) < r}
is a measurable set.
A function f : [a,b] →R would be measurable if there is a measurable function g : R →R and f(x) = g(x) for all
x ∈[a,b].
Exercises
Exercise 666 Let f be a measurable function. Show that each of | f|, [ f]+, and [ f]−must also be measurable.
Exercise 667 Show that the function f(x) = χA(x) is measurable if and only if the set A is a measurable set.
7.7.1
Continuous functions are measurable
Lemma 7.17 A function f : R →R that is continuous everywhere is measurable.
Proof. To prove that f is measurable we need to verify that, for any real number r,
Ar = {x ∈R : f(x) < r}
is a measurable set. But we already know that, for continuous functions, such sets are open.
We know too that a continuous function f : [a,b] →R is also measurable by our deﬁnition since f agrees on [a,b]
with the continuous function g deﬁned by g(t) = f(t) for a ≤t ≤b, g(t) = g(b) for t > b, and g(t) = g(a) for t < a.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.7. MEASURABLE FUNCTIONS
281
7.7.2
Derivatives and integrable functions are measurable
Suppose that f : R →R is almost everywhere the derivative of some function. Then f is measurable3. If we combine
that fact with the deﬁnition of the calculus integral we see that all integrable functions must be measurable.
Lemma 7.18 A function f : R →R that is almost everywhere the derivative of
some function is measurable.
Proof. We suppose that F : R →R and F′(x) = f(x) almost everywhere, say everywhere in R \ N where N is a set of
measure zero. Consider the set E = {x : DF(x) > r} for any r. Let m, n be positive integers and deﬁne βmn to be the
covering relation consisting of all pairs ([u,v],w) for which u ≤w ≤v, and for which 0 < v−u < 1/m and
F(v)−F(u)
v−u
≥r +1/n.
Write
Emn =
[
{[u,v] : ([u,v],w) ∈βmn}.
Each set Emn is thus a fairly simple object: it is a union of a family of compact intervals. In Lemma 5.16 we have
seen that this means it has a simple structure: it differs from an open set by a countable set. In particular each Emn is an
measurable set. We check that
E =
∞
[
n=1
∞
\
m=1
Emn.
(7.7)
To begin suppose that x ∈E. Then DF(x) > r. There must be at least one integer n with DF(x) > r+1/n. Moreover, for
every integer m there would have to be at least one compact interval [u,v] containing x with length less than 1/m so that
F(v)−F(u)
v−u
≥r +1/n.
Hence x is a point in the set on the right-hand side of the proposed identity. Conversely, should x belong to that set, then
there is at least one n so that for all m, x belongs to Emn. It would follow that DF(x) > r and so x ∈E.
The identity (7.7) now exhibits E as a combination of sequences of measurable sets and so E too is an measurable
3A theorem of Lusin states the converse: if f is measurable then there is a continuous function F for which F′(x) = f(x) almost everywhere.
This should not be confused with the fundamental theorem of the calculus.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

282
CHAPTER 7. LEBESGUE’S INTEGRAL
set because the measurable sets form a Borel family (Theorem 7.13). Finally then
{x : f(x) > r} =
¡
{x : DF(x) > r}∩[R\N]
¢
∪N′
where N′ is an appropriate subset of N. This exhibits the set {x : f(x) > r} as the union of a measurable set and a set of
measure zero. Consequently that set is measurable. This is true for all r and veriﬁes that f is a measurable function.
Corollary 7.19 If f : [a,b] →R is integrable then f is measurable.
Exercise 668 Let f : R →R. Show that the set of points where f is differentiable is a measurable set.
Answer
7.7.3
Simple functions
A function f : R →R is simple if there is a ﬁnite collection of measurable sets E1, E2, E3, . . . , En and real numbers r1,
r2, r3, . . . , rn so that
f(x) =
n
∑
k=1
rkχEk(x)
for all real x.
Lemma 7.20 Any simple function is measurable.
Proof. Suppose that
f(x) =
n
∑
k=1
rkχEk(x)
and s is any real number. It is easy to sort out, for any value of s, exactly what the set
As = {x : f(x) < s}
must be in terms of the sets {Ek}. In each case we see that As is some simple combination of measurable sets and so is
itself measurable.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.7. MEASURABLE FUNCTIONS
283
7.7.4
Series of simple functions
Theorem 7.21 Every nonnegative, measurable function f : R →R can be written
as the sum of a series of nonnegative simple functions by the following inductive
procedure: Take {rk} to be any sequence of positive numbers for which rk →0 and
∑∞
k=1 rk = +∞. Deﬁne the sets
Ak =
(
x : f(x) ≥rk + ∑
j<k
r jχA j(x)
)
inductively, starting with A0 = /0. Then
f(x) =
∞
∑
k=1
rkχAk(x)
at every x.
The proof is just a matter of deciding whether and why this works.
Exercises
Exercise 669 Prove Theorem 7.21.
Exercise 670 Show that the following procedure expresses a nonnegative, measurable function f : R →R as a nonde-
creasing limit of a sequence { fk} of simple functions: Fix an integer k. Subdivide [0,k] into subintervals
[(j −1)2−k, j2−k] (j = 1,2,3,...,k2k)
and, for all x ∈[a,b], deﬁne fk(x) to be (j −1)2−k if
(j −1)2−k ≤f(x) < j2−k
and to be k if f(x) ≥k.
Exercise 671 In the preceding exercise show that, if f is bounded, then f is the uniform limit of the sequence of simple
functions { fk}.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

284
CHAPTER 7. LEBESGUE’S INTEGRAL
7.7.5
Limits of measurable functions
Theorem 7.22 Let fn : R →R be a sequence of measurable functions. Suppose
that f : R →R is a function for which
f(x) = lim
n→∞fn(x)
for almost every x. Then f is measurable.
Proof. We ﬁx a real number r and verify that
{x ∈R : f(x) < r}
is a measurable set. We use the fact that sets of the form
{x ∈R : fn(x) < s}
are measurable. This follows from the measurability of each function fn.
Let N be the null set consisting of points x where we do not have
f(x) = lim
n→∞fn(x)
and let E = R\N. Then both E and N are measurable.
We claim the following set identity:
{x ∈E : f(x) < r} =
∞
[
k=1
∞
[
m=1
∞
\
n=m
{x ∈E : fn(x) < r −1/k}.
This is a matter of close interpretation. If x0 belongs to the simple set on the left of the proposed identity, then x0 ∈E
and f(x0) < r. There must exist a k so that f(x0) < r −1/k. Then there must exist an integer m so that fn(x) < r −1/k
for all n ≥m. That places x0 in the set on the right.
In the other direction if x0 belongs to the complicated set on the right of the proposed identity, then for some k and
m, fn(x0) < r −1/k for all n ≥m. It follows that f(x0) ≤r −1/k < r. That places x0 in the set on the left.
Each set
{x ∈E : fn(x) < r −1/k} = E ∩{x ∈R : fn(x) < r −1/k}
thus is measurable since it is the intersection of a measurable set and an open set. As measurable sets form a Borel family
the intersections and unions of these sets remain measurable.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.8. CONSTRUCTION OF THE INTEGRAL
285
Finally then
{x ∈R : f(x) < r}
is seen to be the union of the measurable set
{x ∈E : f(x) < r}
and some subset of N. This checks the measurability of the function f.
7.8
Construction of the integral
We now give Lebesgue’s construction of the integral in a series of steps, starting with characteristic functions, then
simple functions, then nonnegative measurable functions, and ﬁnally all absolutely integrable functions.
7.8.1
Characteristic functions of measurable sets
Lemma 7.23 Let E be a subset of an interval [a,b]. Then χE is integrable on [a,b]
if and only if E is a measurable set, and in that case
λ(E) =
Z b
a χE(x)dx.
Proof. For any set E ⊂[a,b], measurable or not, we can easily establish the (Exercise 661) identity
λ∗(E) =
Z b
a χE(x)dx.
The two concepts in this identity are deﬁned by the same process. Thus the proof of the lemma depends only on showing
that integrability of χE(x) is equivalent to the measurability of E.
We already know that if χE(x) is integrable then it is a measurable function. But this can happen only if E is a
measurable set. Conversely let us suppose that E is measurable and verify that χE is integrable on [a,b]. In fact we show
that this function satisﬁes the McShane criterion on this interval (see Exercise 657).
Since E is measurable we know that
λ(E)+λ([a,b]\E) = b−a.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

286
CHAPTER 7. LEBESGUE’S INTEGRAL
Let ε > 0. Select open sets E ⊂G1 and [a,b]\G2 so that
λ(G1) < λ(E)+ε/2
and
λ(G2) < λ([a,b]\E)+ε/2.
Then, use the identity
λ(G1 ∪G2) = λ(G1)+λ(G2)−λ(G1 ∩G2)
to get
λ(G1 ∩G2) = λ(G1)+λ(G2)−λ(G1 ∪G2)
< [λ(E)+ε/2]+[λ([a,b]\E)+ε/2]−(b−a) = ε.
This will enable us to apply the McShane criterion to establish that χE is integrable on [a,b]. Deﬁne β as the collection
of all pairs ([u,v],w) for which either w ∈E and [u,v] ⊂G1 or w ∈[a,b]\E and [u,v] ⊂G2. This is a full cover of [a,b].
Choose any two partitions π, π′ of [a,b] contained in β. We compute
∑
([u,v],w)∈π
∑
([u′,v′],w′)∈π′
¯¯χE(w)−χE(w′)
¯¯λ([u,v]∩[u′,v′]).
(7.8)
Note, in this sum, that terms for which both w and w′ are in E or for which neither is in E vanish. Terms for which w ∈E
and w′ ∈[a,b]\E must have |χE(w)−χE(w′)| = 1, [u,v] ⊂G1 and [u′,v′] ⊂G2. In particular [u,v]∩[u′,v′] ⊂(G1 ∩G2).
The same is true if w′ ∈E and w ∈[a,b]\E. Remembering that λ(G1 ∩G2) < ε, we see that the sum in (7.8) is smaller
than ε. By the McShane criterion χE is integrable on [a,b].
7.8.2
Characterizations of measurable sets
As corollaries we obtain a number of characterizations of measurable sets, including the original Lebesgue deﬁnition
which is assertion (3). Assertion (4) is known as Carathéodory’s criterion.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.8. CONSTRUCTION OF THE INTEGRAL
287
Corollary 7.24 Let E be a set of real numbers. Then the following assertions are
equivalent:
1. E is measurable.
2. χE is integrable on every compact interval [a,b].
3. For every compact interval [a,b],
λ([a,b]∩E)+λ([a,b]\E) = b−a.
(7.9)
4. For every set T ⊂R,
λ(T) ≥λ(T ∩E)+λ(T \E).
(7.10)
5. For every ε > 0 and every compact interval [a,b], there is a full cover β of
[a,b] so that
∑
([u,v],w)∈π
∑
([u′,v′],w′)∈π′
λ([u,v]∩[u′,v′]) < ε
whenever π, π′ are subpartitions of [a,b] with π ⊂β[E] and π′ ⊂β[[a,b]\E]].
Proof. First note that a set E is measurable if and only if E ∩[a,b] is measurable for every compact interval [a,b]. In one
direction this is because [a,b] is a measurable set (it is closed) and the intersection of measurable sets is also measurable.
In the other direction, if E ∩[a,b] is measurable for every compact interval [a,b], then E = S∞
n=1 E ∩[−n,n] expresses E
as a measurable set.
The ﬁrst three conditions (a), (b), and (c) we have explicitly shown to be equivalent in the proof of the lemma. Let
us check that (d) implies (c). Observe that the inequality,
λ(T) ≤λ(T ∩E)+λ(T \E)
holds in general, so that the condition (7.10) is equivalent to the assertion of equality:
λ(T) = λ(T ∩E)+λ(T \E).
Thus (c) is a special case of (d) with T = [a,b]. On the other hand, (a) implies (d). Measurability of E implies that E and
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

288
CHAPTER 7. LEBESGUE’S INTEGRAL
R\E are disjoint measurable sets for which
λ(T) = λ(T ∩E)+λ(T \E)
must hold for any set T ⊂R. Finally the ﬁfth condition (e) is just a rewriting of the McShane criterion for integrability
of the function χE on [a,b]. We have seen in the proof of the lemma that measurability of E ∩[a,b] is equivalent to that
criterion applied to χE on [a,b].
7.8.3
Integral of simple functions
Recall that a function f : R →R is simple if there is a ﬁnite collection of measurable sets E1, E2, E3, . . ., En and real
numbers r1, r2, r3, . . . , rn so that
f(x) =
n
∑
k=1
rkχEk(x)
for all real x. Since this is a ﬁnite linear combination it follows from the integration theory and the integration of
characteristic functions (Lemma 7.23) that such a function is necessarily integrable on any compact interval [a,b] and
that
Z b
a f(x)dx =
n
∑
k=1
µZ b
a rkχEk(x)dx
¶
=
n
∑
k=1
rkλ(Ek ∩[a,b]).
Thus the integral of simple functions can be constructed from the values of the function in a ﬁnite number of steps using
the Lebesgue measure.
7.8.4
Integral of nonnegative measurable functions
We have seen (Theorem 7.21) that every nonnegative measurable function can be represented by simple functions.
Consequently the integral of such a function can be constructed.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.8. CONSTRUCTION OF THE INTEGRAL
289
Theorem 7.25 Let f be a nonnegative, measurable function on an interval [a,b].
Then, for any representation of f as the sum of a series of nonnegative, simple
functions
f(x) =
∞
∑
k=1
fn(x) (a ≤x ≤b)
the identity
Z b
a f(x)dx =
∞
∑
k=1
µZ b
a fn(x)dx
¶
must hold (ﬁnite or inﬁnite). Moreover f is integrable on [a,b] if and only if this
series of integrals converges to a ﬁnite value.
Proof. This requires only an appeal to the monotone convergence theorem.
Corollary 7.26 Let f be a nonnegative, measurable function on an interval [a,b].
Then
Z b
a f(x)dx
exists (ﬁnitely or inﬁnitely). Moreover f is integrable on [a,b] if and only if this
value is ﬁnite.
Proof. This follows from the theorem.
7.8.5
Fatou’s Lemma
Theorem 7.27 (Fatou’s lemma) Let fn be a sequence of nonnegative, measurable
functions deﬁned at every point of an interval [a,b]. Then, assuming that
f(x) = liminf
n→∞fn(x)
is ﬁnite almost everywhere,
Z b
a liminf
n→∞fn(x)dx ≤liminf
n→∞
Z b
a fn(x)dx..
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

290
CHAPTER 7. LEBESGUE’S INTEGRAL
Proof. Fatou’s lemma is proved using the monotone convergence theorem, Theorem 3.43. Let f denote the limit inferior
of the fn. For every natural number k deﬁne the function
gk(x) = inf
n≥k fn(x).
Then the sequence g1, g2, . . . is a nondecreasing sequence of measurable functions and converges pointwise to f. For
k ≤n, we have gk(x) ≤fn(x), so that
Z b
a gk(x)dx ≤
Z b
a fn(x)dx,
hence
Z b
a gk(x)dx ≤inf
n≥k
Z b
a fn(x)dx.
Using the monotone convergence theorem, the last inequality, and the deﬁnition of the limit inferior, it follows that
Z b
a liminf
n→∞fn(x)dx = lim
k→∞
Z b
a gk(x)dx ≤lim
k→∞inf
n≥k
Z b
a fn(x)dx = liminf
n→∞
Z b
a fn(x)dx.
Exercises
Exercise 672 On the interval [0,1] for every natural number n deﬁne
fn(x) =
(
n
for x ∈(0,1/n),
0
otherwise.
Show that
Z 1
0 liminf
n→∞fn(x)dx < liminf
n→∞
Z 1
0 fn(x)dx.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.8. CONSTRUCTION OF THE INTEGRAL
291
Exercise 673 On the interval [0,∞) for every natural number n deﬁne
fn(x) =
(
1
n
for x ∈[0,n],
0
otherwise.
Show that { fn} is uniformly convergent and that
Z ∞
0 liminf
n→∞fn(x)dx < liminf
n→∞
Z ∞
0
fn(x)dx.
Exercise 674 On the interval [0,∞) for every natural number n deﬁne
fn(x) =
(
−1
n
for x ∈[n,2n],
0
otherwise.
Show that { fn} is uniformly convergent and that the inequality in Fatou’s lemma
Z ∞
0 liminf
n→∞fn(x)dx ≤liminf
n→∞
Z ∞
0
fn(x)dx.
fails.
Exercise 675 (reverse Fatou lemma) Let { fn} be a sequence of measurable functions deﬁned on an interval [a,b].
Suppose that there exists a Lebesgue integrable function g on [a,b] such that fn ≤g for all n. Show that
Z b
a limsup
n→∞
fn(x)dx ≥limsup
n→∞
Z b
a fn(x)dx.
Answer
Exercise 676 (dominated convergence theorem) Let { fn} be a sequence of measurable functions deﬁned on an inter-
val [a,b]. Assume that the sequence converges pointwise and is dominated by some nonnegative, Lebesgue integrable
function g. Then the pointwise limit is an integrable function and
lim
n→∞
Z b
a fn(x)dx =
Z b
a lim
n→∞fn(x)dx.
To say that the sequence is "dominated" by g means that | fn(x)| ≤g(x) for all natural numbers n and all points x in
[a,b].
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

292
CHAPTER 7. LEBESGUE’S INTEGRAL
7.8.6
Derivatives of functions of bounded variation
As a consequence of Lebesgue’s program to this point we can prove some facts about derivatives of monotonic functions
and derivatives of functions of bounded variation. These are due to Lebesgue, but our proofs are rather easier since we
do not need much of the measure theory to obtain them.
Theorem 7.28 Let F : [a,b] →R be a function of bounded variation. Then F′(x)
exists almost everywhere in [a,b] and
Z b
a |F′(x)|dx ≤V(F,[a,b]).
Proof. We know from the Lebesgue differentiation theorem that F is a.e. differentiable. Let f(x) = |F′(x)| at every point
at which F′(x) exists and as zero elsewhere. Then f is a nonnegative function. At every point w in [a,b] there is a δ > 0
so that, whenever u ≤w ≤v and 0 < v−u < δ,
f(w)−ε ≤|F(v)−F(u)|
v−u
.
At points w where f(w) = 0 this is obvious, while at points w where F′(w) exists this follows from the deﬁnition of the
derivative.
Take β as the collection of all pairs ([u,v],w) subject to the requirement only that
|F(v)−F(u)| > [ f(w)−ε](v−u)
if w ∈[a,b] and [u,v] ⊂[a,b]. This collection β is a full cover.
Every partition π ⊂β of the interval [a,b] satisﬁes
∑
([u,v],w)∈π
[ f(w)−ε](v−u) <
∑
([u,v],w)∈π
|F(v)−F(u)| ≤V(F,[a,b]).
It follows that
−ε(b−a)+
Z b
a f(x)dx ≤V(F,[a,b]).
Since ε is an arbitrary positive number,
Z b
a f(x)dx ≤V(F,[a,b]).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.8. CONSTRUCTION OF THE INTEGRAL
293
Since f is almost everywhere a derivative it is necessarily measurable. Thus we may use the integral in place of the
upper integral.
Corollary 7.29 Let F : [a,b] →R be a nondecreasing function. Then F′(x) exists
almost everywhere in [a,b] and
Z b
a F′(x)dx ≤F(b)−F(a).
Corollary 7.30 (Lebesgue decomposition) Let F : [a,b] →R be a continuous,
nondecreasing function. Then F′(x) exists almost everywhere in [a,b] and
F(t) =
Z t
a F′(x)dx+S(t) (a ≤t ≤b)
expresses F as the sum of an integral and a continuous, nondecreasing singular
function.
Proof. Simply deﬁne
S(t) = F(t)−
Z t
a F′(x)dx (a ≤t ≤b).
Check that S′(t) = 0 almost everywhere (trivial) and so S is singular. That S is continuous is evident since it is the
difference of two continuous functions. That S is nondecreasing follows from the theorem, since
S(d)−S(c) = F(d)−F(c)−
Z d
c F′(x)dx ≥0
for any [c,d] ⊂[a,b].
7.8.7
Characterization of the Lebesgue integral
Recall that a function f is Lebesgue integrable on an interval [a,b] if both f and | f| are integrable on that interval.
Theorem 7.31 Let f : [a,b] →R. Then f is Lebesgue integrable if and only if f is
measurable and
Z b
a | f(x)|dx < ∞.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

294
CHAPTER 7. LEBESGUE’S INTEGRAL
Proof. We know, from Exercise 666, that the functions | f|, [ f]+, and [ f]−are also measurable. The ﬁniteness of
this integral implies (by Corollary 7.26) that each of these functions are integrable. In particular both functions f =
[ f]+ −[ f]−and | f| are integrable. Thus f must be absolutely integrable. Conversely if f is absolutely integrable, this
means that | f| is integrable and consequently, by deﬁnition, it has a ﬁnite integral.
Our ﬁnal theorem for Lebesgue’s program shows that the integral is constructible by his methods for all Lebesgue
integrable functions. We see in the next section that this is as far as one can go.
Theorem 7.32 If f is Lebesgue integrable on a compact interval [a,b] then f, | f|,
[ f]+, and [ f]−are measurable and
Z b
a | f(x)|dx =
Z b
a [ f(x)]+ dx+
Z b
a [ f(x)]−dx
and
Z b
a f(x)dx =
Z b
a [ f(x)]+ dx−
Z b
a [ f(x)]−dx
Proof. If f is Lebesgue integrable then we know that f and | f| are integrable. It follows that [ f]+ = (f + | f|)/2 and
[ f]−= (|f|−f)/2 are both integrable. All functions are measurable since all are integrable. Since
| f(x)| = [ f(x)]+ +[f(x)]−
and
f(x) = [f(x)]+ −[ f(x)]−
the integration formulas are immediately available.
7.8.8
McShane’s Criterion
Lebesgue’s integral can also be characterized by the McShane criterion. Using normal inequality techniques we easily
observe that the expression
¯¯¯¯¯ ∑
(I,w)∈π
∑
(I′,w′)∈π′
[ f(w)−f(w′)]λ(I ∩I′)
¯¯¯¯¯ < ε
(7.11)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.8. CONSTRUCTION OF THE INTEGRAL
295
that we use for the second Cauchy criterion must be smaller than a quite similar expression:
¯¯¯¯¯ ∑
(I,w)∈π
∑
(I′,w′)∈π′
[ f(w)−f(w′)]λ(I ∩I′)
¯¯¯¯¯ ≤
∑
(I,w)∈π ∑
(I′,w′)∈π′
¯¯f(w)−f(w′)
¯¯λ(I ∩I′).
It takes a sharp (and young) eye to spot the difference, but the larger side of this inequality may be strictly larger. This
leads to a stronger integrability criterion than that in the second Cauchy criterion. This is the motivation for the criterion,
named after E. J. McShane. We prove that McShane’s criterion is a necessary and sufﬁcient condition for Lebesgue
integrability.
Deﬁnition 7.33 (McShane’s criterion) A function f : [a,b] →R is said to satisfy
McShane’s criterion on [a,b] provided that for all ε > 0 a full cover β can be found
so that
∑
(I,w)∈π
∑
(I′,w′)∈π′
¯¯ f(w)−f(w′)
¯¯λ(I ∩I′) < ε
for all partitions π, π′ of [a,b] contained in β.
Theorem 7.34 If f satisﬁes McShane’s criterion on [a,b] then f is absolutely in-
tegrable, i.e., both f and | f| are integrable there and
−
Z b
a f(x)dx ≤
Z b
a | f(x)|dx ≤
Z b
a f(x)dx.
Proof.
Theorem 7.35 Let f : [a,b] →R. Then f is Lebesgue integrable on an interval if
and only if it satisﬁes McShane’s criterion on that interval.
Proof. It is immediate that if f satisﬁes McShane’s criterion it also satisﬁes Cauchy’s second criterion. Thus the function
f is integrable. We then observe that, since¯¯| f(x)|−|f(x′)| ≤
¯¯¯¯ f(x)−f(x′)
¯¯,
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

296
CHAPTER 7. LEBESGUE’S INTEGRAL
it is clear that whenever f satisﬁes McShane’s criterion so too does | f|. Thus | f| too is integrable on [a,b]. The
inequalities of the theorem simply follow from the inequalities −|f(x)| ≤f(x) ≤|f(x)| which hold for all x.
Here is the proof in the other direction. To simplify the notation let us write
S(f,π,π′) =
∑
([u,v],w)∈π
∑
([u′,v′],w′)∈π′
¯¯ f(w)−f(w′)
¯¯λ([u,v]∩[u′,v′])
(7.12)
for any two partitions π, π′ of [a,b]. Some preliminary computations will help. If g1, g2, . . . , gn are functions on [a,b]
then,
S
Ã
n
∑
i=1
gi,π,π′
!
≤
n
∑
i=1
S(gi,π,π′).
(7.13)
If
Z b
a | f(x)|dx < t
then there must exist a full cover β with the property that for any two partitions π, π′ of [a,b] from β,
S(f,π,π′) < 2t.
(7.14)
Finally
S(f,π,π′) ≤sup{| f(t)| : a ≤t ≤b}·2(b−a).
(7.15)
Each of the statements (7.13), (7.14), and (7.15) require only simple computations that we leave to the reader.
Now for our argument. We assume that f is absolutely integrable and verify the criterion. But f can be written as
a difference of two nonnegative integrable functions. If both of these satisfy the criterion then, using (7.13) we deduce
that so too does f. Consequently for the remainder of the proof we assume that f is nonnegative and integrable.
The ﬁrst step is to observe that every characteristic function of a measurable set satisﬁes the McShane criterion. This
is proved in Lemma 7.23. Using (7.13) we easily deduce, as our second step, that every nonnegative simple function
also satisﬁes the McShane criterion.
The third step is to show that every nonnegative, bounded measurable function also satisﬁes this criterion. But such
a function is the uniform limit of a sequence of nonnegative simple functions. It follows then, from (7.15), that such
functions satisfy the McShane criterion. For if f is a bounded measurable function, ε > 0, choose a simple function g so
that
| f(t)−g(t)| < ε/(4[b−a])
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.8. CONSTRUCTION OF THE INTEGRAL
297
for all a ≤t ≤b. Now using McShane’s criterion on g we can select a full cover β for which S(g,π,π′) < ε/2 for all
partitions π, π′ of [a,b] from β. Then
S(f,π,π′) ≤S(f −g,π,π′)+S(g,π,π′) ≤ε/2+ε/2 = ε.
The ﬁnal step requires an appeal to the monotone convergence theorem. Set fN(t) = min{N, f(t)} and use the
monotone convergence theorem to ﬁnd an integer N large enough so that
Z b
a [ f(x)−fN(x)]dx < ε/4.
Using (7.14) select a full cover β1 for which S(f −fN,π,π′) < ε/2 for all partitions π, π′ of [a,b] from β1. Select a full
cover β2 for which S(fN,π,π′) < ε/2 for all partitions π, π′ of [a,b] from β2. Then set β = β1 ∩β2. This is a full cover
and we can check that
S(f,π,π′) ≤S(f −fN,π,π′)+S(fN,π,π′) ≤ε/2+ε/2 = ε.
for all partitions π, π′ of [a,b] from β. This veriﬁes the McShane criterion for an arbitrary nonnegative integrable function
f.
Exercises
Exercise 677 Suppose that each of the functions f1, f2, . . . , fn : [a,b] →R satisﬁes McShane’s criterion on a compact
interval [a,b] and that a function L : Rn →R is given satisfying
|L(x1,x2,...,xn)−L(y1,y2,...,yn)| ≤M
n
∑
i=1
|xi −yi|
for some number M and all (x1,x2,...,xn) and (y1,y2,...,yn) in Rn. Show that the function g(x) = L(f1(x), f2(x),..., fn(x))
satisﬁes McShane’s criterion on [a,b].
Exercise 678 Let F, f : R →R. A necessary and sufﬁcient condition in order that f be the derivative of F at each point
is that for every ε > 0 there is a full cover β of the real line with the property that for every compact interval [a,b] and
every partition π ⊂β of [a,b],
∑
(I,x)∈π
|∆F(I)−f(x)λ(I)| < ελ([a,b]).
(7.16)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

298
CHAPTER 7. LEBESGUE’S INTEGRAL
Answer
Exercise 679 (Freiling’s criterion) Let f : R →R. Show that necessary and sufﬁcient condition4 in order that f be the
derivative of some function F at each point is that for every ε > 0 there is a full cover β of the real line with the property
that for every compact interval [a,b] and every pair of partitions π1, π2 ⊂β of [a,b],
¯¯¯¯¯ ∑
(I,z)∈π
∑
(I′,z′)∈π′
[ f(z)−f(z′)]λ(I ∩I′)
¯¯¯¯¯ < ελ([a,b]).
(7.17)
Answer
Exercise 680 Let f : R →R. Characterize the following property: for every ε > 0 there is a full cover β of the real line
with the property that for every compact interval [a,b] and every pair of partitions π1, π2 ⊂β of [a,b],
∑
(I,z)∈π
∑
(I′,z′)∈π′
| f(z)−f(z′)|λ(I ∩I′) < ελ([a,b]).
7.8.9
Nonabsolutely integrable functions
A function f is nonabsolutely integrable on an interval [a,b] if it is integrable, but not absolutely integrable there, i.e.,
f is integrable [a,b] but | f| is not integrable. Lebesgue’s program will not construct the integral of a nonabsolutely
integrable function. The only method that his program offers is the hope that
Z b
a f(x)dx =
Z b
a [ f(x)]+ dx−
Z b
a [ f(x)]−dx?
Theorem 7.36 If f is nonabsolutely integrable on a compact interval [a,b] then
Z b
a | f(x)|dx =
Z b
a [ f(x)]+ dx =
Z b
a [ f(x)]−dx = ∞.
4This is from Chris Freiling, On the problem of characterizing derivatives. Real Anal. Exchange 23 (1997/98), no. 2, 805–812.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.9. THE LEBESGUE INTEGRAL AS A SET FUNCTION
299
Proof. If f is nonabsolutely integrable then it is measurable. It follows from Exercise 666 that the functions | f|, [ f]+,
and [ f]−are also measurable. If, for example,
Z b
a [ f(x)]+ dx < ∞,
contrary to what we wish to prove, then we must conclude (from Theorem 7.31) that [ f]+ is integrable. But if [ f]+ is
integrable then from the identity
[ f(x)]−= [ f(x)]+ −f(x)
we could conclude that [ f]−must also be integrable and consequently each of the functions f, | f|, [ f]+, and [ f]−must
be integrable, contradicting the hypothesis of the theorem.
7.9
The Lebesgue integral as a set function
In many presentations of the Lebesgue integral (although not in Lebesgue’s original thesis) the integral is deﬁned over
arbitrary measurable sets E and denoted as
Z
E f(x)dx.
Then the integral over a compact interval [a,b] would be written as
Z
[a,b] f(x)dx
and all of the theory is stated, as far as is possible, for the more general set-valued integral (rather than the interval-valued
integral of this chapter). We can deﬁne this set-valued integral in somewhat greater generality by using estimates arising
from full and ﬁne covers.
Deﬁnition 7.37 Let f : R →R be a function and β a covering relation. We write
V(fλ,β) = sup
π⊂β
(
∑
([u,v],w)∈π
| f(w)|λ(([u,v])
)
where the supremum is taken over all π, arbitrary subpartitions contained in β.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

300
CHAPTER 7. LEBESGUE’S INTEGRAL
Deﬁnition 7.38 (Full and Fine Variations) Let f : R →R and let E be any set
of real numbers. Then we deﬁne the full and ﬁne variational measures associated
with fλ by the expressions:
V ∗(fλE) = inf{V(fλ,β) : β a full cover of E}
and
V∗(fλ,E) = inf{V(fλ,β) : β a ﬁne cover of E}.
In the special case where f is a nonnegative function and E an arbitrary set we write
Z
E f(x)dx = V ∗(fλ,E)
and we will check later to see if ﬁne variation can be used as well. We have already sufﬁcient techniques to study this
set-valued integral and so we shall develop the theory in the exercises.
Exercises
Exercise 681 (measure estimates for Lebesgue’s integral) Suppose that f : R →R is an arbitrary nonnegative func-
tion and that r < f(x) < s for all x in a set E. Then
rλ(E) ≤
Z
E f(x)dx ≤sλ(E).
Answer
Exercise 682 (comparison with upper integral) Show that if f is a nonnegative function and E is an arbitrary set
contained in an interval [a,b] then
Z
E f(x)dx =
Z b
a χE(x)f(x)dx.
Exercise 683 (comparison with Lebesgue integral) Show that if f is a nonnegative measurable function and E is a
measurable set contained in an interval [a,b] then
Z
E f(x)dx =
Z b
a χE(x)f(x)dx
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.9. THE LEBESGUE INTEGRAL AS A SET FUNCTION
301
where the integral may be interpreted as a Lebesgue integral. (In particular the value of the integral
R
E f(x)dx can be
constructed by Lebesgue’s methods.)
Exercise 684 (measure properties) Show that if f is a nonnegative function and E, E1, E2, E3, . . . is a sequence of sets
for which E ⊂S∞
n=1 En then
Z
E f(x)dx ≤
∞
∑
n=1
Z
En
f(x)dx
i.e., the set function integral is a measure in the sense of Theorem 7.3.
Exercise 685 (absolute continuity (zero/zero)) Show that if f is a nonnegative function and E is a set of Lebesgue
measure zero then
Z
E f(x)dx = 0.
Answer
Exercise 686 Show that if f is a nonnegative function and
Z
E f(x)dx = 0
then f(x) = 0 for almost every point x ∈E.
Exercise 687 Show that if f is a nonnegative function and E1, E2, E3, . . . is a sequence of pairwise disjoint closed sets
for which E = S∞
n=1 En then
Z
E f(x)dx =
∞
∑
n=1
Z
En
f(x)dx
i.e., the set function integral is additive over disjoint closed sets as in Corollary 7.9.
Exercise 688 Suppose that f is a nonnegative, bounded function and that E is a measurable set. Show that for every
ε > 0 there is an open set G so that E \G is closed and
Z
E\G f(x)dx < ε.
[This is a warm-up to the next exercise where bounded is dropped.]
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

302
CHAPTER 7. LEBESGUE’S INTEGRAL
Exercise 689 Suppose that f is a nonnegative, measurable function and that E is a measurable set. Show that for every
ε > 0 there is an open set G so that E \G is closed and
Z
E\G f(x)dx < ε.
[This is an improvement on the preceding exercise where it was assumed that the function is bounded.]
Exercise 690 Show that if f is a nonnegative measurable function and E1, E2, E3, . . . is a sequence of pairwise disjoint
measurable sets for which E = S∞
n=1 En then, for any set A,
Z
A∩E f(x)dx =
∞
∑
n=1
Z
A∩En
f(x)dx
i.e., the set function integral is additive over disjoint sets as in Lemma 7.12 provided we assume that the sets and the
function are measurable.
Exercise 691 Show that if f is a nonnegative measurable function and E1 ⊂E2 ⊂E3 ⊂..., is an increasing sequence
of measurable sets for which E = S∞
n=1 En then
Z
E f(x)dx = lim
n→∞
Z
En
f(x)dx.
Exercise 692 Suppose that f : R →R and that f is nonnegative and bounded. Then for every ε > 0 there is a δ > 0 so
that if G is an open set with λ(G) < δ then
Z
G f(x)dx < ε.
[This is a warm-up to the next exercise where bounded is dropped.]
Answer
Exercise 693 (absolute continuity (ε, δ)) Suppose that f : R →R, that f is nonnegative and measurable, and that
Z
E f(x)dx < ∞.
Then for every ε > 0 there is a δ > 0 so that if G is an open set with λ(G) < δ then
Z
E∩G f(x)dx < ε.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.10. CHARACTERIZATIONS OF THE INDEFINITE INTEGRAL
303
Answer
Exercise 694 (construction of the Lebesgue integral) Suppose that f : R →R and that f is a nonnegative, measurable
function. Let r > 1 and write
Akr = {x : rk−1 < f(x) ≤rk}.
Then, for any set E,
Z
E f(x)dx ≤
∞
∑
k=−∞
rkλ(E ∩Akr) ≤r
Z
E f(x)dx.
[In particular as r ր 1 the sum approaches the value of the integral.]
Answer
Exercise 695 (full and ﬁne characterization) Suppose that f : R →R and that f is a nonnegative, measurable func-
tion. Show that
Z
E f(x)dx = V ∗(fλ,E) = V∗(fλ,E).
Answer
7.10
Characterizations of the indeﬁnite integral
Under what conditions can we be sure that a function F : [a,b] →R can be written as
F(t) = C +
Z t
a f(t)dt
for a constant C and an integrable function f. The property and the characterization itself for absolutely integrable
functions were given by Giuseppe Vitali in 1905, only shortly after the publication by Lebesgue of his integration theory.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

304
CHAPTER 7. LEBESGUE’S INTEGRAL
Deﬁnition 7.39 Suppose that F : [a,b] →R is a function. Then F is absolutely
continuous in the Vitali sensea on [a,b] if for all ε > 0 there is a δ > 0 so that
∑
i
|F(vi)−F(ui)| < ε
whenever {[ui,vi]} are nonoverlapping subintervals of [a,b] for which ∑i[vi −ui] <
δ.
aMost texts call this (as did Vitali himself) “absolute continuity.” We prefer to reserve this term
for the “zero variation on zero measure sets” which is the preferred use of the expression in measure
theory.
There are several simple consequences of this deﬁnition that we will require in order to better understand this concept.
Lemma 7.40 Suppose that F : [a,b] →R is a function that is absolutely continuous
in the Vitali sense on [a,b]. Then
1. F is uniformly continuous on [a,b],
2. F is absolutely continuous on (a,b), and
3. F has bounded variation on [a,b].
Proof. The ﬁrst two statements are trivial and follow easily from the deﬁnition. For the third, choose a positive number
δ so that
∑
i
|F(vi)−F(ui)| < 1
whenever {[ui,vi]} are nonoverlapping subintervals of [a,b] for which
∑
i
[vi −ui] < δ.
Then any partition of [a,b] into subintervals smaller than δ must have
∑
i
|F(vi)−F(ui)| < N
where N is an integer chosen large enough so that Nδ > b−a.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.10. CHARACTERIZATIONS OF THE INDEFINITE INTEGRAL
305
7.10.1
Integral of nonnegative, integrable functions
Theorem 7.41 Let F : [a,b] →R. A necessary and sufﬁcient condition in order
that F can be written as
F(t) = C +
Z t
a f(t)dt
for a constant C and a nonnegative integrable function f is that F is absolutely
continuous in the Vitali sense and monotonic nondecreasing.
7.10.2
Integral of absolutely integrable functions
Theorem 7.42 Let F : [a,b] →R. A necessary and sufﬁcient condition in order
that F can be written as
F(t) = C +
Z t
a f(t)dt
for a constant C and an absolutely integrable function f is that F is absolutely
continuous in the Vitali sense.
Corollary 7.43 Let F : [a,b] →R. A necessary and sufﬁcient condition in order
that F can be written as
F(t) = C +
Z t
a f(t)dt
for a constant C and an absolutely integrable function f is that
1. F is continuous on [a,b].
2. F is absolutely continuous on (a,b).
3. V(F,[a,b]) < ∞.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

306
CHAPTER 7. LEBESGUE’S INTEGRAL
7.10.3
Integral of nonabsolutely integrable functions
Theorem 7.44 Let F : [a,b] →R. A necessary and sufﬁcient condition in order
that F can be written as
F(t) = C +
Z t
a f(t)dt
for a constant C and a nonabsolutely integrable function f are that
1. F is continuous on [a,b].
2. F is absolutely continuous on (a,b).
3. V(F,[a,b]) = ∞.
4. F is differentiablea almost everywhere in (a,b).
aIt is possible but not easy to show that when F is absolutely continuous on (a,b), F must be
almost everywhere differentiable. Thus (4) follows from (3).
7.10.4
Proofs
The necessity of the conditions in the three theorems can be addressed ﬁrst. Suppose that
F(t) = C +
Z t
a f(t)dt
for a constant C and an integrable function f.
If f is nonnegative then F is certainly nondecreasing We check that it is also absolutely continuous in the Vitali
sense.
Let fn(x) = min{ f(x),n} and note that fn is measurable and nonnegative, and that limn→∞fn(x) = f(x) everywhere.
Then, by the monotone convergence theorem, on every subinterval [c,d] ⊂[a,b],
0 <
Z d
c f(x)dx−
Z d
c fn(x)dx <
Z d
c [ f(x)−fn(x)]dx →0.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.10. CHARACTERIZATIONS OF THE INDEFINITE INTEGRAL
307
Choose N so large that
Z b
a f(x)dx <
Z b
a fN(x)dx+ε/2.
Choose δ = ε/(2N). Then check that, if [ci,di] are nonoverlapping subintervals of [a,b] with ∑i(di −ci) < δ, then
0 ≤∑
i
[F(di)−F(ci)] = ∑
i
Z di
ci
f(x)dx
≤∑
i
Z di
ci
fN(x)dx+ε/2
≤∑
i
N((di −ci)+ε/2 < Nδ+ε/2 < ε.
This veriﬁes that F is absolutely continuous in the Vitali sense.
If we assume instead that f is absolutely integrable we can again obtain the fact that F is absolutely continuous in
the Vitali sense merely by splitting f into its positive and negative parts.
Finally, if f is merely integrable, then we already know that the relation
F(t) = C +
Z t
a f(t)dt
requires that F is continuous everywhere, and that F is absolutely continuous. The fundamental theorem of the calculus
requires F′(x) = f(x) almost everywhere in [a,b]. Thus each of the necessity parts of the three theorems is proved.
Conversely the stated conditions in the theorems are sufﬁcient to verify that
F(t) = C +
Z t
a f(t)dt
for some function f as stated and constant C. For the third theorem we already know this from the fundamental theorem
of the calculus.
That same theorem shows that the proof of the ﬁrst theorem is also complete provided we know that F is differentiable
almost everywhere and that F′(x) ≥0 almost everywhere. But we already know that nondecreasing functions are almost
everywhere differentiable. Take f(x) = F′(x) at points where the derivative exists and f(x) = 0 elsewhere and the ﬁrst
theorem is proved.
We complete the proof of the second theorem in the same way. The assumption that F is absolutely continuous in the
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

308
CHAPTER 7. LEBESGUE’S INTEGRAL
Vitali sense assures us that F is continuous and has bounded variation. So again F is almost everywhere differentiable
and again the same argument supplies the representation.
Exercises
Exercise 696 Show that a function that is absolutely continuous in the Vitali sense on [a,b] must be uniformly continuous
there.
Exercise 697 Give an example of a uniformly continuous on an interval [a,b] that is not absolutely continuous in the
Vitali sense there.
Exercise 698 Show that a function that is Lipschitz on [a,b] is also absolutely continuous in the Vitali sense on [a,b].
Exercise 699 Given an example of a function that is not Lipschitz on [a,b] but is absolutely continuous in the Vitali
sense on [a,b].
Exercise 700 Show that a function that is absolutely continuous in the Vitali sense on [a,b] must have bounded variation
on [a,b].
Exercise 701 Show that if a function is absolutely continuous in the Vitali sense on [a,b] then both parts of the Jordan
decomposition have the same property on [a,b].
Exercise 702 Show that any continuously differentiable function on an interval [a,b] is absolutely continuous in the
Vitali sense on [a,b].
Exercise 703 Show that a differentiable function on an interval [a,b] need not be absolutely continuous in the Vitali
sense on [a,b] but that it must be absolutely continuous in the more general sense (zero variation on zero measure
sets).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.11. DENJOY’S PROGRAM
309
Exercise 704 Show that a function may be absolutely continuous but not absolutely continuous in the Vitali sense.
Answer
Exercise 705 Let F : R →R and suppose that F is absolutely continuous in the Vitali sense on every compact interval
[a,b]. Show that F is absolutely continuous.
Answer
Exercise 706 Suppose that F, f : [a,b] →R, that f is bounded and integrable and that
F(t) =
Z b
a f(x)dx (a ≤t ≤b).
Show directly that F is absolutely continuous in the Vitali sense on [a,b].
Answer
Exercise 707 Suppose that F : [a,b] →R is absolutely continuous in [a,b]. Show that F is also absolutely continuous
on [a,b] in the sense of Vitali if and only if F has ﬁnite total variation on [a,b], i.e., V(F,[a,b] < ∞.
Exercise 708 (Fichtenholz) Suppose that F : [a,b] →R satisﬁes the following condition: for every ε > 0 there is a
δ > 0 so that whenever {[ci,di]} is any sequence of subintervals of [a,b] satisfying ∑i(di −ci) < δ then necessarily
∑i |F(di)−F(ci)| < ε. Show that this condition is strictly stronger than absolutely continuity in the Vitali sense.
Answer
Exercise 709 Show that every Lipschitz function satisﬁes the condition of the preceding exercise.
Exercise 710 Show that a function that satisﬁes the condition of the preceding exercises must be a Lipschitz function.
7.11
Denjoy’s program
For nonabsolutely integrable functions the integral is not constructive by any of the methods of Lebesgue. If we know in
advance that F′(x) = f(x) everywhere, then certainly we can “construct” the value of the integral by using the formula
Z b
a f(x)dx = F(b)−F(a).
But even if we are assured that f is a derivative of some function, but we are not provided that function itself, then
there may be no constructive method of determining either the value of the integral or the antiderivative function itself.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

310
CHAPTER 7. LEBESGUE’S INTEGRAL
This may surprise some calculus students since much of an elementary course is devoted to various methods of ﬁnding
antiderivatives.
After Lebesgue’s constructive integral was presented there still remained this problem. All bounded derivatives can
be handled by his methods, but there exist unbounded derivatives that are nonabsolutely integrable. What procedure
(outside of our formal integration theory) would handle these?
Starting with the class of absolutely integrable functions, Arnaud Denjoy discovered in 1912 that a series of exten-
sions of this class could be constructed that would eventually encompass all derivatives and, indeed, all nonabsolutely
integrable functions. The methods are beyond the scope of this text as they require not merely an ordinary sequence of
extensions, but a transﬁnite sequence of extensions using inﬁnite ordinal numbers. He called his process totalization.
Added to Lebesgue’s methods, totalization reveals exactly how constructive our integral is. His process completely cat-
alogues the class of nonabsolutely integrable functions. In effect the integral that is discussed in this text could be (and
has been) called the Denjoy integral.
7.12
The Riemann integral
We conclude this chapter with a brief discussion of the Riemann integral. Since this has been used as the teaching
integral of choice for many generations (in spite of criticisms) it can hardly be avoided. The student will surely encounter
numerous references to it in the literature.
Deﬁnition 7.45 (Riemann integral) Suppose that f is an integrable function de-
ﬁned at every point of a compact interval [a,b]. Then f is said to be Riemann
integrable on [a,b] if for every ε > 0 there is a uniformly full cover β of [a,b] so
that
¯¯¯¯¯
Z b
a f(x)dx−
∑
[u,v],w)∈π
f(w)(v−u)
¯¯¯¯¯ < ε
whenever π is a partition of the interval [a,b] chosen from β.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

7.12. THE RIEMANN INTEGRAL
311
Exercises
Exercise 711 Show that if f is almost everywhere continuous then f must be measurable. Deduce that if f : [a,b] →R
is bounded and almost everywhere continuous then f is Lebesgue integrable on [a,b].
Exercise 712 Show that if f is bounded and almost everywhere continuous then f must satisfy McShane’s criterion.
Deduce that if f : [a,b] →R is bounded and almost everywhere continuous then f is Lebesgue integrable on [a,b].
Answer
Exercise 713 Let f : [a,b] →R be a bounded function. Prove that assertion (1) implies assertion (2):
1. For every ε > 0 there is a partition π of [a,b] for which
∑
(I,x)∈π
ω f(I)λ(I) < ε.
2. f is continuous at almost every point of [a,b].
Answer
Exercise 714 Let f : [a,b] →R be a bounded function. Prove that assertion (2) implies assertion (1):
1. For every ε > 0 there is a partition π of [a,b] for which
∑
(I,x)∈π
ω f(I)λ(I) < ε.
2. f is continuous at almost every point of [a,b].
Answer
Exercise 715 (Lebesgue’s criterion) Suppose that f is a function deﬁned at every point of a compact interval [a,b].
Then f is Riemann integrable on [a,b] if and only if f is bounded and almost everywhere continuous on (a,b).
Answer
.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

312
CHAPTER 7. LEBESGUE’S INTEGRAL
Exercise 716 (Riemann’s integrability criterion) Let f : [a,b] →R be a bounded function. Then f is Riemann inte-
grable if and only if for every ε > 0 there is a partition π of [a,b] for which
∑
(I,x)∈π
ω f(I)λ(I) < ε.
Exercise 717 A careless student argues: If a bounded function f is almost everywhere continuous that means that there
is a continuous function g that is almost everywhere equal to f. Obviously this gives a much easier proof of Exercise 711.
Your comments?
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

Chapter 8
Stieltjes Integrals
Recall that the total variation of a function F on a compact interval is the supremum of sums of the form
V(F,[a,b]) =
∑
([u,v],w)∈π
|F(v)−F(u)|
taken over all possible partitions π of [a,b]. This is a measure of the variability of the function F on this interval.
Functions of bounded variation play a signiﬁcant role in real analysis. The earliest application was to the study of arc
length of curves (see Section 3.9.3, a subject we will review in this chapter as well.
Our main tool in the study of this important class of functions is a slight generalization of the integral, called the
Stieltjes integral. Our deﬁnitions for this integral will now be of the Henstock-Kurzweil type. Ideas related to the
calculus integral will certainly return.
8.1
Stieltjes integrals
The deﬁnition of the total variation V(F,[a,b]) and the deﬁnition of the Lebesgue-Stieltjes measure both contain what
looks very much like one of our Riemann sums, but in place of the usual sum
∑
([u,v],w)∈π
f(w)(v−u)
313
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

314
CHAPTER 8. STIELTJES INTEGRALS
we are here checking values of the sum
∑
([u,v],w)∈π
|F(v)−F(u)|.
This might suggest to us that integration methods would prove a useful tool in the study of functions of bounded variation.
Let us, accordingly, enlarge the scope of our integration theory by considering limits of Riemann sums that are more
general than we have used so far. Let f, G : [a,b] →R and by analogy with
Z b
a f(x)dx ∼
∑
([u,v],w)∈π
f(w)(v−u)|
we introduce new integrals by making only the obvious changes suggested by the following slogans:
Z b
a f(x)dG(x) ∼
∑
([u,v],w)∈π
f(w)(G(v)−G(u))
Z b
a f(x)|dG(x)| ∼
∑
([u,v],w)∈π
f(w)|G(v)−G(u)|
Z b
a f(x)[dG(x)]+ ∼
∑
([u,v],w)∈π
f(w)[G(v)−G(u)]+
Z b
a f(x)[dG(x)]−∼
∑
([u,v],w)∈π
f(w)[G(v)−G(u)]−
as well as a few other variants we consider in later sections:
Z b
a
p
|dG(x)|dx ∼
∑
([u,v],w)∈π
p
|G(v)−G(u)|(v−u)
and
Z b
a
q
[dG(x)]2 +[dx]2 ∼
∑
([u,v],w)∈π
q
|G(v)−G(u)|2 +(v−u)2.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8.1. STIELTJES INTEGRALS
315
We will refer to all of these as Stieltjes integrals, although it is only the ﬁrst variant of these,
Z b
a f(x)dG(x),
that the Dutch mathematician Thomas Stieltjes (1856–1894) himself used and the one that most people would mean by
the terminology.
8.1.1
Deﬁnition of the Stieltjes integral
The slogans in the preceding section should be enough to lead the reader to the correct deﬁnition of the various Stieltjes
integral. Even so, let us give precise deﬁnitions for the simplest case. This is just a copying exercise: take the usual
deﬁnition and repeat it with the Riemann sums adjusted in the manner required.
Deﬁnition 8.1 For functions G, f : [a,b] →R we deﬁne an upper integral by
Z b
a f(x)dG(x) = inf
β sup
π⊂β
∑
([u,v],w)∈π
f(w)(G(v)−G(u))
where the supremum is taken over all partitions π of [a,b] contained in β, and the
inﬁmum over all full covers β.
Similarly we deﬁne a lower integral, as
Z b
a f(x)dG(x) = sup
β
inf
π⊂β
∑
([u,v],w)∈π
f(w)(G(v)−G(u))
where, again, π is a partition of [a,b] and β is a full cover.
If the upper and lower integrals are identical we say the integral is determined and we write the common value as
Z b
a f(x)dG(x).
We are interested, mostly, in the case in which the integral is determined and ﬁnite.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

316
CHAPTER 8. STIELTJES INTEGRALS
Exercises
Exercise 718 Let G : [a,b] →R. Show that
Z b
a dG(x) = G(b)−G(a).
Exercise 719 Let G : R →R deﬁned so that G(x) = 0 for all x ̸= 0 and G(1) = 1. Compute
Z 2
0 |dG(x)| and
Z 2
0 |dG(x)|.
Exercise 720 Let G : [0,1] →R and let f(x) = 0 for all x ̸= 1/2 with f(1/2) = 1. What are
Z 1
0 f(x)dG(x) and
Z 1
0 f(x)dG(x)?
Exercise 721 Let G, f : [0,1] →R and let G(x) = 0 for all x ≤1/2 and with G(x) = 1 for all x > 1/2. What are
Z 1
0 f(x)dG(x) and
Z 1
0 f(x)dG(x)?
Answer
Exercise 722 Let G, f : [a,b] →R and let f be continuous and let G be a step function, i.e. there are points
a < ξ1 < ξ2 < ··· < ξm < b
so that G is constant on each interval (ξi−1,ξi). What are possible values for
Z b
a f(x)dG(x) and
Z b
a f(x)dG(x)?
Answer
Exercise 723 Let G, F : [−1,1] →R be deﬁned by F(x) = 0 for −1 ≤x < 0, F(x) = 1 for 0 ≤x ≤1, G(x) = 0 for
−1 ≤x ≤, and G(x) = 1 for 0 < x ≤1. Discuss
R 1
−1 F(x)dG(x) and
R 1
−1 G(x)dF(x).
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8.1. STIELTJES INTEGRALS
317
Exercise 724 If a < b < c is the formula
Z b
a f(x)dG(x)+
Z c
b f(x)dG(x) =
Z c
a f(x)dG(x)
valid?
Answer
Exercise 725 Show that a function f can be altered at a ﬁnite number of points where G is continuous without altering
the values of the upper and lower integrals. Give an example to show that continuity may not be dropped here.
Exercise 726 Show that a function f can be altered at a countable number of points where G is continuous without
altering the values of the upper and lower integrals.
Exercise 727 Give a Cauchy I criterion for
Z b
a f(x)dG(x).
Exercise 728 Give a Cauchy II criterion for
Z b
a f(x)dG(x).
Exercise 729 Give a McShane criterion for
Z b
a f(x)dG(x).
Exercise 730 Give a Henstock criterion for
Z b
a f(x)dG(x).
Exercise 731 For integrals of the form
Z b
a f(x)|dG(x)| what changes have to be made in the various criteria?
Answer
Exercise 732 For integrals of the form
Z b
a f(x)[dG(x)]+ what changes have to be made in the various criteria?
Exercise 733 Let F : [0,2] →R with F(t) = 0 for all t ̸= 1 and F(1) = 1. Show that
Z 2
0 |dF(x)| <
Z 2
0 |dF(x)| = V(F,[0,2]).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

318
CHAPTER 8. STIELTJES INTEGRALS
Exercise 734 Let F : [a,b] →R. Show that the total variation of F can be expressed as an upper integral:
V(F,[a,b]) =
Z b
a |dF(x)|.
Exercise 735 Let F : [a,b] →R and suppose that one at least of the integrals
Z b
a |dF(x)|,
Z b
a [dF(x)]+ or
Z b
a [dF(x)]−
is ﬁnite. Show that F is a function of bounded variation on [a,b] and that, for all a < t ≤b,
F(t)−F(a) =
Z t
a [dF(x)]+ −
Z t
a [dF(x)]−.
(8.1)
The identity (8.1) is a representation of F as a difference of two nondecreasing functions.
Exercise 736 Let F : [a,b] →R be a continuous function. Show that F has bounded variation on [a,b] if and only if there
is a continuous, strictly increasing function G : [a,b] →R for which F(d)−F(c) < G(d)−G(c) for all a ≤c < d ≤b.
Exercise 737 What basic properties of the ordinary integral
Z b
a f(x)dx from Chapter 6 can you prove for Stieltjes
integrals without any but the most obvious of changes in the proofs?
8.1.2
Henstock’s zero variation criterion
Since the Stieltjes integral is deﬁned in exactly the same way as the ordinary integral one expects almost the same
properties. Indeed this integral has the same linear, additive, and monotone properties (suitably expressed). There also
must be an indeﬁnite integral. Finally, the most important of these properties that carries over, is the Henstock criterion.
We give that now.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8.2. REGULATED FUNCTIONS
319
Theorem 8.2 Let F, G, f : [a,b] →R. Then a necessary and sufﬁcient condition
for the existence of the Stieltjes integral and the formula
Z d
c f(x)dG(x) = F(d)−F(c) [c,d] ⊂[a,b]
is that
Z b
a |dF(x)−f(x)dG(x)| = 0.
The proof would merely be a copying exercise of material from Chapter 6. Note that we are taking advantage of our
general Stieltjes notation here to allow us to interpret the integral
Z b
a |dF(x)−f(x)dG(x)|
as a limit of the Riemann sums
∑
([u,v],w)∈π
|F(v)−F(u)−f(x)[G(v)−G(u)]|.
8.2
Regulated functions
Recall that the one-sided limit F(c+) exists if, for all sequences of positive numbers tn tending to zero,
lim
n→∞F(c+tn) = F(c+).
Similarly, we say F(c−) exists if, for all sequences of positive numbers tn tending to zero,
lim
n→∞F(c−tn) = F(c−).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

320
CHAPTER 8. STIELTJES INTEGRALS
Deﬁnition 8.3 Let F : [a,b] →R. Then
• F is said to be regulated if the one-sided limit F(c+) exists and is ﬁnite for
all a ≤c < b and the limit on the other side F(c−) exists and is ﬁnite for all
a < c ≤b.
• F is said to be naturally regulated if F is regulated and, for all a < c < b,
either
F(c+) ≤F(c) ≤F(c−)
or else
F(c−) ≤F(c) ≤F(c+).
Theorem 8.4 Let F : [a,b] →R be monotonic. Then F is naturally regulated.
Proof. Simply notice that
F(c−) = sup{F(t) : a ≤t < c} ≤F(c)
≤inf{F(t) : c < t ≤b} = F(c+).
for all a < c < b.
Theorem 8.5 Let F : [a,b] →R be a function of bounded variation. Then F is
regulated and has at most countably many discontinuitiesa.
aIn fact it can be proved that all regulated functions have at most countably many discontinuities.
Proof. Suppose that a < c ≤b and F(c−) does not exist. Then there is a positive number ε and a sequence of numbers
cn increasing to c so that, for all n,
F(cn)−F(cn+1) < −ε < ε < F(cn+2)−F(cn+1).
But then, for all m,
∞> V(F,[a,b]) ≥
m
∑
n=1
|F(cn)−F(cn+1)| > mε.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8.2. REGULATED FUNCTIONS
321
This is impossible. Similarly F(c+) must exist for all a ≤c < b.
Let us show that there are only countably many points c ∈[a,b) for which F(c) ̸= F(c+). Let c1, c2, . . . cm denote
some set of m points from (a,b) for which
|F(cm+)−F(c)| > 1/n.
Then there is a disjointed collection of intervals [ci,ti] for which
|F(ti)−F(ci)| > 1/(2n).
In particular
∞> V(F,[a,b]) ≥
m
∑
i=1
|F(ti)−F(ci)| > m/(2n).
Thus there are only ﬁnitely many such choices of points c1, c2, . . . cm for which
|F(cm+)−F(cm)| > 1/n.
It follows that there are only countably many choices of points ci for which
|F(ci+)−F(ci)| > 0.
A similar argument handles the points c ∈(a,b)] for which F(c) ̸= F(c−). It follows that the set of points of discontinuity
must be countable.
Lemma 8.6 (Approximate additivity) Suppose that F : [a,b] →R is a function
that is naturally regulated. Then at any point a < c < b, and for any ε > 0 there is
δ > 0 so that, for all c−δ < u < c < v < c+δ,
|F(v)−F(c)|+|F(c)−F(u)| ≥|F(v)−F(u)|
and
|F(v)−F(u)| ≥|F(v)−F(c)|+|F(c)−F(u)|−ε.
(8.2)
Proof. Since F is naturally regulated we know that
|F(c+)−F(c−)| = |F(c+)−F(c)|+|F(c−)−F(c)|
for each a < c < b. At such points there is a δ > 0 so that
|F(u)−F(c−)| < ε/4 and |F(v)−F(c+)| < ε/4
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

322
CHAPTER 8. STIELTJES INTEGRALS
for all c−δ < u < c < v < c+δ. In particular
|F(c+)−F(c−)| ≤|F(c+)−F(v)|+|F(v)−F(u)|+|F(u)−F(c−)|
≤|F(v)−F(u)|+ε/2
and so
|F(v)−F(c)|+|F(c)−F(u)| ≤
|F(v)−F(c+)|+|F(c+)−F(c)|+|F(c−)−F(c)|+|F(c−)−F(u)|
≤|F(c+)−F(c−)|+ε/2 ≤|F(v)−F(u)|+ε.
Thus
|F(v)−F(u)| ≥|F(v)−F(c)|+|F(c)−F(u)|−ε.
The other inequality
|F(v)−F(c)|+|F(c)−F(u)| ≥|F(v)−F(u)|
is obviously true.
8.3
Variation expressed as an integral
We begin by pointing out the obvious relation between the Jordan variation and a certain Stieljtes integral.
Lemma 8.7 Suppose that F : [a,b] →R. Then
V(F,[a,b]) =
Z b
a |dF(x)|.
Our interest is in the special case where this integral exists and we are not forced to use the upper integral.
Lemma 8.8 Suppose that F : [a,b] →R is a function of bounded variation that is
naturally regulated. Then
V(F,[a,b]) =
Z b
a |dF(x)|.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8.3. VARIATION EXPRESSED AS AN INTEGRAL
323
Proof. It is clear that
V(F,[a,b]) ≥
Z b
a |dF(x)|.
In fact these are equal for all functions, but we do not need that. Let ε > 0 and select points
a = s0 < s1 < ··· < sn−1 < sn = b
so that
n
∑
i=1
|F(si)−F(si−1)| > V(F,[a,b])−ε.
Deﬁne a covering relation β to include only those pairs ([u,v],w) for which either w ̸= s1,s2,...,sn−1 and [u,v]
contains no point s1,s2,...,sn−1, or else w = si for some i = 1,2,...,n−1 and
|F(v)−F(u)| ≥|F(v)−F(si)|+|F(si)−F(u)|−ε/n.
(8.3)
It is clear that β is full at every point w. For points w ̸= s1,s2,...,sn−1 this is transparent, while for points w = si for
some i = 1,2,...,n−1, Lemma 8.6 may be applied.
We use a standard endpointed argument. Take any partition π of [a,b] chosen from β. Scan through π looking for any
elements of the form ([u,v],si) for u < si < w and i = 1,2,...,n −1. Replace each one by the new elements ([u,si],si)
and ([si,v],si). Call the new partition π′. Because of (8.3) we see that
∑
([u,v],w)∈π
|F(v)−F(u)| ≥
∑
([u,v],w)∈π′
|F(v)−F(u)|−ε.
Write πi = π′([si−1,si]) and note that, by the way we have arranged π′, each πi is a partition of the interval [si−1,si].
Consequently
∑
([u,v],w)∈π
|F(v)−F(u)| ≥
∑
([u,v],w)∈π′
|F(v)−F(u)|−ε
≥
n
∑
i=1
∑
([u,v],w)∈πi
|F(v)−F(u)|−ε
≥
n
∑
i=1
|F(si)−F(si−1)|−ε > V(F,[a,b])−2ε.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

324
CHAPTER 8. STIELTJES INTEGRALS
We have shown that for every partition π of [a,b] contained in β this sum is larger than V(F,[a,b])−2ε. It follows that
Z b
a |dF(x)| ≥V(F,[a,b])−2ε.
Since ε is arbitrary the inequality
V(F,[a,b]) ≤
Z b
a |dF(x)| ≤
Z b
a |dF(x)| ≤V(F,[a,b])
must hold and the theorem is proved.
Corollary 8.9 Suppose that F : [a,b] →R is a function of bounded variation that
is naturally regulated. Then
V(F,[a,b]) =
Z b
a |dF(x)| =
Z t
a [dF(x)]+ +
Z t
a [dF(x)]−.
Proof. The proof of the lemma can easily be adjusted to prove that all three of these integrals must exist. The identity is
trivial: the expression
dF(x) = [dF(x)]+ +[dF(x)]−
integrated over [a,b] produces the required identity.
The role of the naturally regulated assumption is exhibited in Exercise 733. It can be checked that if a function is not
naturally regulated then the integral is not determined and the variation must be displayed using the upper integrals.
8.4
Representation theorems for functions of bounded variation
8.4.1
Jordan decomposition
The structure of functions of bounded variation is particularly simpliﬁed by a theorem of Jordan: every function of
bounded variation is merely a linear combination of monotonic functions. We prove this for functions that are naturally
regulated, by interpreting the statement as an integration assertion about certain Stieltjes integrals. The statement is true
in general for all functions of bounded variation, but then the upper integrals would be needed (cf. Exercise 735).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8.4. REPRESENTATION THEOREMS FOR FUNCTIONS OF BOUNDED VARIATION
325
Theorem 8.10 Let F : [a,b] →R be a function of bounded variation and suppose
that F is naturally regulated. Then, for all a < t ≤b,
F(t)−F(a) =
Z t
a [dF(x)]+ −
Z t
a [dF(x)]−.
(8.4)
The identity (8.4) is a representation of F as a difference of two functions, both
nondecreasing, both naturally regulated.
Proof. The existence of the integrals is given in Corollary 8.9. The identity is trivial: the expression
dF(x) = [dF(x)]+ −[dF(x)]−
integrated over [a,b] produces the required identity.
Corollary 8.11 Let F : [a,b] →R be a function of bounded variation and suppose
that F is continuous. Then, for all a < t ≤b,
F(t)−F(a) =
Z t
a [dF(x)]+ −
Z t
a [dF(x)]−.
(8.5)
The identity (8.5) is a representation of F as a difference of two functions, both
continuous and nondecreasing.
8.4.2
Jordan decomposition theorem: differentiation
We know that all functions of bounded variation and all monotonic functions are almost everywhere differentiable. This
and the integral representation given in Theorem 8.10 allows the following corollary.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

326
CHAPTER 8. STIELTJES INTEGRALS
Corollary 8.12 Let F : [a,b] →R be a function of bounded variation and suppose
that F is naturally regulated. Write
F1(t) =
Z t
a [dF(x)]+ (a ≤t ≤b),
(8.6)
and
F2(t) =
Z t
a [dF(x)]−(a ≤t ≤b),
(8.7)
Then
F(t)−F(a) = F1(t)−F2(t) and T(t) = V(F,[a,t]) = F1(t)+F2(t).
Moreover, at almost every t in [a,b],
F′(t) = F′
1(t)−F′
2(t), F′
1(t) = max{F′(t),0}, F′
2(t) = max{−F′(t),0},
T ′(t) = F′
1(t)+F′
2(t) = |F′(t)| and F′
1(t)F′
2(t) = 0.
Proof. There are three tools needed for the differentiation statements: the Lebesgue differentiation theorem (that mono-
tonic functions have derivatives a.e.), the Henstock zero variation criterion for integrals, and the zero variation implies
zero derivative a.e. rule.
We illustrate with a proof for one of the statements in the corollary. Deﬁne
h([u,v],w) = F1(v)−F1(u)−[F(v)−F(u)]+.
The identity F1(t) =
R t
a[dF(x)]+ requires that h have zero variation on (a,b). This, in term, requires that
lim
h→0+
F1(t +h)−F1(t)−max{F(t +h)−F(t),0}
h
= lim
h→0+
F1(t)−F1(t −h)−max{F(t)−F(t −h),0}
h
= 0
for almost every t in (a,b). From that we deduce that F′
1(t) = max{F′(t),0} must be true for almost every t in (a,b).
Proofs for the other statements are similar.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8.5. REDUCING A STIELTJES INTEGRAL TO AN ORDINARY INTEGRAL
327
8.4.3
Representation by saltus functions
Theorem 8.13 Let F : [a,b] →R be a monotonic nondecreasing function and let
C be the set of points of continuity of F in [a,b]. Then, for all a < t ≤b,
F(t)−F(a) =
Z t
a χC(x)dF(x)+
Z t
a [1−χC(x)]dF(x).
(8.8)
and
Z t
a [1−χC(x)]dF(x) = [F(t)−F(t−)]+ ∑
s∈[a,t)\C
[F(s+)−F(s−)]
The identity (8.8) is a representation of F as a sum of two functions, the ﬁrst con-
tinuous and nondecreasing, the second a saltus function.
8.4.4
Representation by singular functions
Theorem 8.14 Let F : [a,b] →R be a continuous monotonic function. Let D be
the set of points of differentiability of F in [a,b]. Then
F(t)−F(a) =
Z t
a χD(x)dF(x)+
Z t
a [1−χD(x)]dF(x)
(8.9)
and
Z t
a χD(x)dF(x) =
Z t
a F′(x)dx.
The identity (8.9) is a representation of F as a sum of two monotonic functions, the
ﬁrst Vitali absolutely continuous and the second a continuous singular function.
8.5
Reducing a Stieltjes integral to an ordinary integral
The Stieltjes integral reduces to an ordinary integral in a number of interpretations. When the integrating function G
is an indeﬁnite integral the whole theory reduces to ordinary integration. The formula is compelling since, as calculus
students often learn,
dG(x) = G′(x)dx
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

328
CHAPTER 8. STIELTJES INTEGRALS
can be assigned a meaning. That meaning is convenient here too and suggests that
Z b
a f(x)dG(x) =
Z b
a f(x)G′(x)dx.
Theorem 8.15 Suppose that G, f, g : R →R and that g is integrable on a compact
interval [a,b] with an indeﬁnite integral
G(d)−G(c) =
Z d
c g(x)dx (a ≤c < d ≤b).
Then the Stieltjes integral
Z b
a f(x)dG(x)
exists if and only if fg is integrable on [a,b], in which case
Z b
a f(x)dG(x) =
Z b
a f(x)g(x)dx.
Proof. The proof depends simply on the Henstock criterion. The existence of the ordinary integral
Z b
a g(x)dx
with an indeﬁnite integral G is equivalent to the zero criterion:
Z b
a |dG(x)−g(x)dx| = 0
Whenever this identity holds, then one checks that, for any function f,
Z b
a |f(x)dG(x)−f(x)g(x)dx| = 0
would also be true. For example, if we have a bounded f this is trivial; for unbounded one only has to split [a,b] into the
sequence of sets
{x ∈[a,b] : n−1 ≤|f(x)| < n}
and argue on each of these (cf. Exercise 739).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8.5. REDUCING A STIELTJES INTEGRAL TO AN ORDINARY INTEGRAL
329
The existence of the Stieltjes integral
Z b
a f(x)dG(x)
with an indeﬁnite integral F is equivalent to the zero criterion:
Z b
a |dF(x)−f(x)dG(x)| = 0.
Together these give
Z b
a |dF(x)−f(x)g(x)dx| ≤
Z b
a |dF(x)−f(x)dG(x)|+
Z b
a |f(x)dG(x)−f(x)g(x)dx| = 0.
From this it is easy to read off the required identity.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

330
CHAPTER 8. STIELTJES INTEGRALS
8.6
Properties of the indeﬁnite integral
Theorem 8.16 Suppose that
F(t) =
Z t
a f(x)dG(x) (a ≤t ≤b).
Then
1. F is continuous at every point at which G is continuous.
2. F is absolutely continuous in any set E ⊂(a,b) in which G is absolutely
continuous.
3. F has zero variation on any set E ⊂(a,b) on which G has zero variation.
4. F has bounded variation on [a,b] if f is bounded and if G has bounded
variation.
5. If G is Vitali absolutely continuous on [a,b] and if f is bounded then F is
also Vitali absolutely continuous on [a,b].
6. If G is a saltus function on [a,b] and f is nonnegative then so too is the
indeﬁnite integral F. Moreover the jumps of F occur precisely at points that
are jumps of G for which f does not vanish.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8.6. PROPERTIES OF THE INDEFINITE INTEGRAL
331
Theorem 8.17 (Differentiation properties) Suppose that
F(t) =
Z t
a f(x)dG(x) (a ≤t ≤b).
Then
1. For almost every point x in [a,b]
lim
y→x
F(y)−F(x)−f(x)(G(y)−G(x))
y−x
= 0.
2. For almost every point x in [a,b],
DF(x) = f(x)DG(x) and DF(x) = f(x)DG(x)
or else
DF(x) = f(x)DG(x) and DF(x) = f(x)DG(x)
depending on whether f(x) ≥0 or f(x) ≤0.
3. In particular, F′(x) = f(x)G′(x) at almost every point x at which either F or
G is differentiable.
4. Finally, F′(x) = 0 at almost every point x where f(x) = 0.
The proof for each of these statements depends simply on the Henstock criterion. The existence of the Stieltjes
integral
Z b
a fx)dG(x)
with an indeﬁnite integral F is equivalent to the zero criterion:
Z b
a |dF(x)−f(x)dG(x)| = 0
From the latter will ﬂow each of the statements of the theorem. The individual proofs are left in the Exercises to the
reader.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

332
CHAPTER 8. STIELTJES INTEGRALS
Exercises
Exercise 738 Suppose that
Z b
a |dF(x)−f(x)dx| = 0.
Show that if g is any bounded function on [a,b] then
Z b
a |g(x)dF(x)−f(x)g(x)dx| = 0.
Exercise 739 Suppose that
Z b
a |dF(x)−f(x)dx| = 0.
Show that if g is any real-valued function on [a,b] then
Z b
a |g(x)dF(x)−f(x)g(x)dx| = 0.
Exercise 740 Suppose that
Z b
a |dF(x)−f(x)dG(x)| = 0.
Show that F is continuous at any point at which G is continuous. Is the converse necessarily true?
Exercise 741 Suppose that
Z b
a |dF(x)−f(x)dG(x)| = 0.
Show that F has zero variation on any set on which G has zero variation. Is the converse necessarily true?
Exercise 742 Suppose that
Z b
a |dF(x)−f(x)dG(x)| = 0
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8.6. PROPERTIES OF THE INDEFINITE INTEGRAL
333
and suppose that G has bounded variation on [a,b] and that f is bounded. Show that F has bounded variation on [a,b].
Exercise 743 Suppose that
Z b
a |dF(x)−f(x)dG(x)| = 0.
Show that
lim
y→x
F(y)−F(x)−f(x)(G(y)−G(x))
y−x
= 0
almost everywhere by using the zero variation implies zero derivative criterion.
Exercise 744 Complete the remaining arguments needed to establish the parts of the theorem.
Exercise 745 Suppose that
Z b
a |dF(x)−f(x)dG(x)| = 0.
Show that, for every point x in [a,b]
lim
y→x
F(y)−F(x)
G(y)−G(x) = f(x)
except perhaps for points x in a set N in which G has ﬁne variation zero.
Exercise 746 Suppose that at every point x of a compact interval [a,b]
lim
y→x
F(y)−F(x)−f(x)[G(y)−G(x)]
y−x
= 0.
Show that
Z b
a |dF(x)−f(x)dG(x)| = 0.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

334
CHAPTER 8. STIELTJES INTEGRALS
Exercise 747 Suppose that at every point x of a compact interval [a,b]
lim
y→x
F(y)−F(x)−f(x)[G(y)−G(x)]
y−x
= 0
except for points x in a set N for which both F and G have zero variation. Show that
Z b
a |dF(x)−f(x)dG(x)| = 0.
Exercise 748 Suppose that
Z b
a |dF(x)−f(x)dG(x)| = 0.
Show that, at almost every point x,
DF(x) = f(x)DG(x) and DF(x) = f(x)DG(x)
if f(x) ≥0 while
DF(x) = f(x)DG(x) and DF(x) = f(x)DG(x)
if f(x) ≤0. In particular F′(x) = 0 at almost every point x where f(x) = 0.
8.6.1
Existence of the integral from derivative statements
The existence of the integral
Z b
a f(x)dG(x)
can be deduced from a variety of differentiation statements. For example, using Exercise 747, we can prove the following
simple version:
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8.7. EXISTENCE OF THE STIELTJES INTEGRAL FOR CONTINUOUS FUNCTIONS
335
Theorem 8.18 Suppose that at every point x of a compact interval [a,b]
lim
y→x
F(y)−F(x)−f(x)[G(y)−G(x)]
y−x
= 0
except for points x in a set N for which both F and G have zero variation. Then the
Stieltjes integral exists and
Z b
a f(x)dG(x) = F(b)−F(a).
8.7
Existence of the Stieltjes integral for continuous functions
Theorem 8.19 Let f, G : R →R and suppose that f is continuous on a compact
interval [a,b] and that G is monotonic nondecreasing throughout that interval.
Then the Stieltjes integral exists and
¯¯¯¯
Z b
a f(x)dG(x)
¯¯¯¯ ≤∥f∥∞[G(b)−G(a)].
where ∥f∥∞= maxt∈[a,b] | f(t)|.
Proof. The inequality is easy since, for any pair ([u,v],w) with [u,v] ⊂[a,b],
|f(w)(G(v)−G(u)| ≤∥f∥∞[G(v)−G(u)].
(8.10)
To prove that the integral exists we can invoke a version of the McShane criterion here. The details are left as an exercise.
The next theorem is similar.
Theorem 8.20 Let f, G : R →R and suppose that f is continuous on a compact
interval [a,b] and that G has bounded variation throughout that interval. Then the
Stieltjes integral exists and
¯¯¯¯
Z b
a f(x)dG(x)
¯¯¯¯ ≤∥f∥∞V(G,[a,b]).
where ∥f∥∞= maxt∈[a,b] | f(t)|.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

336
CHAPTER 8. STIELTJES INTEGRALS
8.8
Integration by parts
Integration by parts for the Stieltjes integral assumes the following form1:
Theorem 8.21 Let F, G : R →R. Then
Z b
a [F(x)dG(x)+G(x)dF(x)] = F(b)G(b)−F(a)G(a)−
Z b
a dF(x)dG(x)
in the sense that if one of the integrals exists, so too does the other with the stated
identity.
Proof. First check a simple identity: that, for any u and v,
F(u)[G(v)−G(u)]+G(u)[F(v)−F(u)]
= F(v)G(v)−G(u)G(u)−[F(v)−F(u)][G(v)−G(u).
This suggests that
Z b
a |F(x)dG(x)+G(x)dF(x)−dF(x)dG(x)−dF(x)dG(x)| = 0
(8.11)
is simply true because of an identity. If indeed this is true then the statement in the theorem is obvious because
Z b
a dF(x)dG(x) = F(b)G(b)−F(a)G(a).
To complete the proof we have to address just one concern here. If a partition π of the interval [a,b] contains only
pairs ([u,v],u) or ([u,v],v) [i.e., ([u,w],w) with w only at an endpoint] then our simple identity would indeed supply
∑
([u,v],w)∈π
[F(w)[G(v)−G(u)]+G(w)[F(v)−F(u)]−F(v)G(v)−G(u)G(u)]
=
∑
([u,v],w)∈π
[F(v)−F(u)][G(v)−G(u)].
That surely proves (8.11) if we are allowed to use only such partitions. But what happens if we permit (as we must)
partitions π containing a pair ([u,v],w) ∈π for which u < w < v?
1For the Riemann-Stieltjes integral the extra term
R b
a dF(x)dG(x) does not appear, since this would be zero whenever the integral exists in that
sense. (See Corollary 8.23, which should look familiar to fans of the Riemann-Stieltjes integral.)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8.8. INTEGRATION BY PARTS
337
To clear this up note that we can always adjust full covers and partitions π by replacing any pair ([u,v],w) ∈π for
which u < w < v by the two items ([u,w],w) and ([w,v],w). That does not change the sums here because, for example,
F(w)[G(v)−G(u)] = F(w)[G(w)−G(u)]+F(w)[G(v)−G(w)].
This “endpointed” argument (which we have seen before in Exercise 649) means that in these simple Stieltjes integrals
the partitions used can all be restricted to ones where only elements of the form ([u,v],u) or ([u,v],v) can appear.
Corollary 8.22 Let F, G : R →R and suppose that
Z b
a |dF(x)dG(x)| = 0.
Then
Z b
a [F(x)dG(x)+G(x)dF(x)] = F(b)G(b)−F(a)G(a).
If, in addition one of the following two integrals exists then so too does the other
and
Z b
a F(x)dG(x)+
Z b
a G(x)dF(x) = F(b)G(b)−F(a)G(a).
Corollary 8.23 Let F, G : R →R and suppose that F is continuous and G has
bounded variation. Then
Z b
a F(x)dG(x)+
Z b
a G(x)dF(x) = F(b)G(b)−F(a)G(a).
Proof. The assumption that F is continuous and G has bounded variation requires that
Z b
a |dF(x)dG(x)| = 0.
Thus Theorem 8.21 can be applied. But we know, from Theorem 8.19, that the integral
R b
a F(x)dG(x) must exist. It
follows, from Corollary 8.22, that
R b
a G(x)dF(x) must also exist and that the integration by parts formula is valid.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

338
CHAPTER 8. STIELTJES INTEGRALS
8.9
Lebesgue-Stieltjes measure
The variation of a function F on an interval [a,b] can be described by the identity
V(F,[a,b]) = sup
∑
([u,v],w)∈π
|F(v)−F(u)|
where the supremum is taken over all possible partitions π of the interval [a,b]. We recall that a somewhat similar
expression describes the Lebesgue measure λ(E) of a set E:
λ(E) = inf
β sup
π⊂β
∑
([u,v],w)∈π
(v−u).
Here π denotes an arbitrary subpartition contained in β and the inﬁmum is taken over all full covers β of the set E. There
is an obvious generalization of Lebesgue measure available by replacing (v−u) by |F(v)−F(u)|.
Deﬁnition 8.24 Let F be a function deﬁned at least on an open set G and we
suppose that E ⊂G. Then we write
λF(E) = inf
β sup
π⊂β
∑
([u,v],w)∈π
|F(v)−F(u)|.
Here π denotes an arbitrary subpartition contained in β. The set function λF de-
ﬁned for all subsets of G is called the Lebesgue-Stieltjes measure associated with
F or, often, the variational measure associated with F.
In the literature often the Lebesgue-Stieltjes measure is studied only for monotonic functions that are continuous on
the left-hand side at every point. It is convenient for us to usurp this language for the completely general case. The
deﬁnition of the Lebesgue-Stieltjes measure is closely related to the Stieltjes integral, just as the deﬁnition of Lebesgue
measure in Lemma 7.2 was expressible as an upper integral.
Lemma 8.25 If F is deﬁned on a compact interval [a,b] and E ⊂(a,b) then
λF(E) =
Z b
a χE(x)|dF(x)|.
By comparing this deﬁnition with some earlier notions that are almost identical we will be able to deduce the
following properties of this measure:
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8.9. LEBESGUE-STIELTJES MEASURE
339
Properties of the Lebesgue-Stieltjes measures
1. λF is a measure, i.e., if F is deﬁned on an open set G and E, E1, E2, E3, . . . are subsets of G for which E ⊂S∞
n=1 En
then this inequality must hold:
λF(E) ≤
∞
∑
n=1
λF(En).
2. If F is monotonic then
λF([a,b]) = |F(b+)−F(a−)|,
λF((a,b)) = |F(b−)−F(a+)|,
and
λF({x0}) = |F(x0+)−F(x0−)|.
3. F has zero variation on a set E if and only if λF(E) = 0.
4. F is continuous at a point x0 if and only if λF({x0}) = 0.
5. F is continuous at every point of an open interval (a,b) if and only if λF(C) = 0 for every countable subset of
(a,b).
6. F is absolutely continuous on an interval (a,b) if and only if λF(N) = 0 for every subset N of (a,b) that has
measure zero.
7. λF((a,b)) = 0 if and only if F is constant on (a,b).
8. F is locally bounded at a point x0 if and only if λF({x0}) < ∞.
9. If F is deﬁned on a compact interval [a,b] then F has bounded variation on [a,b] if and only if λF((a,b)) < ∞.
10. If F is deﬁned on an open set G and has a bounded derivative at each point of a bounded subset E of G then
λF(E) < ∞.
11. If F is deﬁned on an open set G and λF(E) < ∞then F is differentiable at almost every point of E.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

340
CHAPTER 8. STIELTJES INTEGRALS
It is clear from the deﬁnitions that F has zero variation on a set E if and only if λF(E) = 0. Thus the assertions
(4)–(8) are immediate from our early study of zero variation. The other assertions are proved in the exercises.
Exercises
Exercise 749 Prove that λF is a measure.
Answer
Exercise 750 Show that if F is monotonic then F is monotonic then
λF([a,b]) = |F(b+)−F(a−)|,
λF((a,b)) = |F(b−)−F(a+)|,
and
λF({x0}) = |F(x0+)−F(x0−)|.
Exercise 751 Show that, if the one-sided limits F(x0+) and F(x0−) exist then
λF({x0}) = |F(x0+)−F(x0)|+|F(x0−)−F(x0)|.
Exercise 752 Suppose that F is deﬁned on an open set G. Show that F is locally bounded at a point x0 ∈G if and only
if λF({x0}) < ∞.
Exercise 753 Suppose that F is deﬁned on a compact interval [a,b]. Show that F has bounded variation on [a,b] if and
only if λF((a,b)) < ∞. Show that λF((a,b)) ≤V(F,[a,b]) but that the inequality may be strict unless F is continuous.
Answer
Exercise 754 Suppose that F is deﬁned on an open set G and has a bounded derivative at each point of a bounded
subset E of G. Show that λF(E) < ∞.
Answer
5We recall that every function of bounded variation is
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8.10. MUTUALLY SINGULAR FUNCTIONS
341
8.10
Mutually singular functions
Deﬁnition 8.26 Let F, G : [a,b] →R be functions of bounded variation. Then F
and G are said to be mutually singular provided that
Z b
a
p
|dF(x)dG(x)| = 0.
Lemma 8.27 Let F, G : [a,b] →R be functions of bounded variation. If F and G
are mutually singular, then F′(x)G′(x) = 0 almost everywhere in [a,b].
Proof. This follows easily (as usual) from the zero variation implies zero derivative a.e. rule together with the fact that
both F′(x) and G′(x) must exist a.e..
Our main theorem shows that mutually singular functions grow on separate parts of the interval [a,b] in a sense made
precise here.
Theorem 8.28 Let F, G : [a,b] →R be functions of bounded variation. Then F
and G are mutually singular on [a,b] if and only for every ε > 0 there is a full cover
β with the property that every partition π of [a,b] contained in β can be split into
two disjoint subpartitions π = π′ ∪π′′ so that
∑
([u,v],w)∈π′
|F(v)−F(u)| < ε
and
∑
([u,v],w)∈π′′
|G(v)−G(u)| < ε.
Proof. Suppose that
Z b
a
p
|dF(x)dG(x)| = 0.
Let ε > 0 and select a full cover β so that
∑
([u,v],w)∈π
p
|[F(v)−F(u)][G(v)−G(u)]| < ε
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

342
CHAPTER 8. STIELTJES INTEGRALS
for all partitions π of [a,b] contained in β. Split such a π as follows:
π′ = {([u,v],w) : |[F(v)−F(u)]| ≤|[G(v)−G(u)]|}
and
π′′ = {([u,v],w) : |[F(v)−F(u)]| > |[G(v)−G(u)]|}.
Verify that π = π′ ∪π′′ and that
∑
([u,v],w)∈π′
|[F(v)−F(u)]| ≤
∑
([u,v],w)∈π′
p
|[F(v)−F(u)][G(v)−G(u)]| < ε
and that
∑
([u,v],w)∈π′′
|[G(v)−G(u)]| ≤
∑
([u,v],w)∈π′′
p
|[F(v)−F(u)][G(v)−G(u)]| < ε.
This proves one direction in the theorem.
For the converse select a number M > 0 and a full cover β1 so that
∑
([u,v],w)∈π
[|[F(v)−F(u)]|+|[G(v)−G(u)]|] < M
for all partitions π of [a,b] from β1. This is possible merely because the functions F and G have bounded variation.
Select a full cover β2 with the property presented in the statement of the theorem (for ε). Let β = β1 ∩β2. This is a full
cover. Consider any partition π of [a,b] contained in β. There must be, by hypothesis, a split π = π′ ∪π′′ so that
∑
([u,v],w)∈π′
|[F(v)−F(u)]| < ε
and
∑
([u,v],w)∈π′′
|[G(v)−G(u)]| < ε.
We now compute
∑
([u,v],w)∈π
p
|[F(v)−F(u)][G(v)−G(u)]| =
∑
([u,v],w)∈π′
p
|[F(v)−F(u)][G(v)−G(u)]|
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8.11. SINGULAR FUNCTIONS
343
+
∑
([u,v],w)∈π′′
p
|[F(v)−F(u)][G(v)−G(u)]|
≤
s
∑
([u,v],w)∈π′
|[F(v)−F(u)]|
s
∑
([u,v],w)∈π′
|[G(v)−G(u)]|
+
s
∑
([u,v],w)∈π′′
|[F(v)−F(u)]|
s
∑
([u,v],w)∈π′′
|[G(v)−G(u)]|
≤2
√
Mε.
Here we have used the Cauchy-Schwartz inequality. Since ε is an arbitrary positive number it follows that
Z b
a
p
|dF(x)dG(x)| = 0.
Consequently F and G must be mutually singular.
8.11
Singular functions
We have deﬁned the notion of a singular function elsewhere and given the usual remarkable example of such a function,
the Cantor function (Devil’s staircase). We show that there are further characterizations of this notion, in particular one
given exactly by a Stieltjes-type integral.
Theorem 8.29 Let F : [a,b] →R be a function of bounded variation. Then the
following are equivalent:
1. F is singular.
2. F′(x) = 0 almost everywhere in [a,b].
3.
Z b
a
p
|dF(x)|dx = 0.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

344
CHAPTER 8. STIELTJES INTEGRALS
Proof. It is only the third property that we show here, since we know from elsewhere that the ﬁrst two are equivalent. If
the third statement is true then we can check, using the zero variation implies zero derivative a.e. rule that F′(x) = 0 a.e..
Conversely suppose that F′(x) = 0 almost everywhere. Let ε > 0 and choose a sequence of open intervals {(ci,di)}
with total length smaller than ε so that F′(x) = 0 for all x ∈[a,b] not in one of the intervals. Deﬁne two covering relations.
The ﬁrst β1 consists of all pairs ([u,v],w) subject only to the condition that if w is in [a,b] and not covered by an open
interval {(ci,di)} then
|F(v)−F(u)| < ε(v−u)/(b−a).
The second β2 consists of all pairs ([u,v],w) subject only to the condition that if w is contained in one of the open
intervals {(ci,di)} then so too is [u,v]. Then β1, β2, and β = β1 ∩β2 are all full covers.
Note that if π is a subpartition contained in β1 consisting of pairs ([u,v],w) not covered by an open interval from
{(ci,di)} then
∑
([u,v],w)∈π
|F(v)−F(u)| ≤
∑
([u,v],w)∈π
ε(v−u)/(b−a) ≤ε.
Note that if π is a subpartition contained in β2 consisting of pairs ([u,v],w) that are covered by an open interval from
{(ci,di)} then
∑
(I,x)∈π
(v−u) ≤
∞
∑
i=1
(di −ci) < ε.
Thus any partition of [a,b] chosen from β can be split into two subpartitions with these inequalities. This veriﬁes the
conditions asserted in Theorem 8.28 for F and the function G(x) = x. But that is exactly our third condition in the
statement of the theorem.
8.12
Length of curves
A curve is a pair of continuous functions F, G : [a,b] →R. We consider that the curve is the pair of functions itself,
rather than that the curve is the geometric set of points
{(F(t),G(t)) : t ∈[a,b]}
that is the object we might likely think about when contemplating a curve.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8.12. LENGTH OF CURVES
345
Deﬁnition 8.30 Suppose that F, G : [a,b] →R is a pair of continuous functions.
By the length of the curve given by the pair F and G we shall mean
Z b
a
q
[dF(x)]2 +[dG(x)]2.
That this integral is determined (but may be inﬁnite) is pointed out in the proof of the next theorem.
Theorem 8.31 A curve given by a pair of continuous functions F, G : [a,b] →R
has ﬁnite length if and only if both functions F and G have bounded variation.
Proof. Note that as F and G are continuous, then so too is the interval function
h([u,v]) =
q
[F(v)−F(u)]2 +[G(v)−G(u)]2.
A simple application of the Pythagorean theorem will verify that the function h here is a continuous, subadditive interval
function. The existence of the integral can be established by a repetition of the argument of Lemma 8.8.
Thus the integral
Z b
a
q
[dF(x)]2 +[dG(x)]2
in the deﬁnition must necessarily be determined, although it might have an inﬁnite value. It will have a ﬁnite value if h
has bounded variation. That follows from a simple computation:
max
½Z b
a |dF(x)|,
Z b
a |dG(x)|
¾
≤
Z b
a
q
[dF(x)]2 +[dG(x)]2
and
Z b
a
q
[dF(x)]2 +[dG(x)]2 ≤
Z b
a |dF(x)|+
Z b
a |dG(x)|.
8.12.1
Formula for the length of curves
In the elementary (computational) calculus one usually assumes that a curve is given by a pair of continuously differ-
entiable functions (i.e., a pair F, G of continuous functions for which F′ and G′ are also continuous). In that case the
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

346
CHAPTER 8. STIELTJES INTEGRALS
familiar formula for length used in elementary applications is
Z b
a
q
[F′(x)]2 +[G′(x)]2 dx.
We study this now. Note that the formula is rather compelling if we think that dF(x) = F′(x)dx and dG(x) = G′(x)dx
would be possible here.
Lemma 8.32 For any pair of continuous functions F, G : [a,b] →R of bounded
variation on [a,b] deﬁne the following function
L(t) =
Z t
a
q
[dF(x)]2 +[dG(x)]2
(a < t ≤b).
Then
L′(t) =
q
[F′(t)]2 +[G′(t)]2
almost everywhere in [a,b].
Proof. We are now quite familiar with the zero variation implies zero derivative a.e. rule. This is all that is needed here
to establish this fact, since the statement in the Lemma can be expressed, by the Henstock zero variation criterion, as
Z b
a
¯¯¯¯dL(x)−
q
[dF(x)]2 +[dG(x)]2
¯¯¯¯ = 0.
.
Lemma 8.33 The function L in the lemma is Vitali absolutely continuous if and
only if both F and G are Vitali absolutely continuous.
Proof. This follows easily from the inequalities of Lemma 8.31.
The length of the curve is now available as a familiar formula precisely in the case where the two functions deﬁning
the curve are absolutely continuous.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

8.12. LENGTH OF CURVES
347
Lemma 8.34 For any pair of continuous functions F, G : [a,b] →R of bounded
variation on [a,b],
Z b
a
q
[dF(x)]2 +[dG(x)]2 ≥
Z b
a
q
[F′(x)]2 +[G′(x)]2 dx.
The two expressions are equal if and only if both F and G are Vitali absolutely
continuous on [a,b].
Proof. Using the function L introduced above we see that this assertion is easily deduced from the fact that
L(t) ≥
Z t
a L′(x)dx
with equality precisely when L is Vitali absolutely continuous.
Exercises
Exercise 755 For any continuous function F : [a,b] →R deﬁne the length of the graph of F to mean
Z b
a
q
[dx]2 +[dF(x)]2.
Show that the graph has ﬁnite length if and only if F has bounded variation. Discuss the availability of the familiar
formula for length used in elementary applications:
Z b
a
q
1+[F′(x)]2 dx.
Exercise 756 Let F, G : [a,b] →R where [a,b] is a compact interval. Suppose that the Hellinger integral2
H(t) =
Z t
a
dF(x)dG(x)
dx
(a < t ≤b)
exists. Show that H′(t) = F′(t)G′(t) at almost every point t in [a,b] at which both F and G are differentiable.
Answer
2Named after Ernst Hellinger (1883–1950).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

348
CHAPTER 8. STIELTJES INTEGRALS
Exercise 757 (Reduction theorem) Let F, G : [a,b] →R where [a,b] is a compact interval. Suppose that F is Vitali
absolutely continuous on [a,b] and that G is a Lipschitz function. Show that
Z t
a
dF(x)dG(x)
dx
=
Z b
a F′(x)dG(x) =
Z b
a F′(x)G′(x)dx.
Exercise 758 Let F, G : [a,b] →R where [a,b] is a compact interval. Suppose that F is Vitali absolutely continuous on
[a,b] and that G is the indeﬁnite integral of a function of bounded variation. Show that
Z t
a
dF(x)dG(x)
dx
=
Z b
a F′(x)dG(x) =
Z b
a F′(x)G′(x)dx.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

Chapter 9
Nonabsolutely Integrable Functions
The study of the Lebesgue integral in Chapter 7 usually marks the culmination of the study of integration theory on the
real line for most mathematics students. They are prepared now for the more abstract theories of integration on measure
spaces and studies of the important function spaces.
But the story is still not complete; part of the narrative remains. What about those functions that are integrable, but
not absolutely integrable? If f is integrable on an interval [a,b] but
Z b
a | f(x)|dx = ∞
then f is not Lebesgue integrable. Its indeﬁnite integral
F(x) =
Z x
a f(t)dt
has inﬁnite variation on the interval [a,b] since it is always true that
V(F,[a,b]) =
Z b
a | f(x)|dx.
To complete the story of the integral on the real line we must persist1 to study the nonabsolute case and to the study of
1Note to the instructor: Well you may not want to persist. These topics, while well-known to all specialists in real analysis, are not necessary
to the backgrounds of all students, who should be encouraged now to study general measure theory and return to this subject later. The level of
349
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

350
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
indeﬁnite integrals that do not have bounded variation. Most of the theory was developed in the decades shortly after
Lebesgue’s thesis. The standard account is given in
Stanislaw Saks, Theory of the Integral. 2nd revised edition. English translation by L. C. Young. Monografje
Matematyczne, vol. 7. Warsaw, 1937.
and much of what we shall do can be found there but expressed in different language. Many mathematicians know none
of this theory since the usual courses of instruction move directly to the measure-theoretic treatment of integration theory
that does not address such questions.
Since we have committed our text to an account of the calculus integral we must forge ahead. The Lebesgue integral
does not encompass the calculus integral for there are derivatives that are unbounded and nonabsolutely integrable. All
bounded derivatives are, of course, Lebesgue integrable so that it is in the realm of the unbounded derivatives and some
rather delicate considerations that this chapter will lead.
9.1
Variational Measures
The Jordan variation that we studied extensively in Chapters 3 and 8 is restricted to the study of functions of bounded
variation on a compact interval [a,b]. When V(f,[a,b]) = ∞there is not much more to be said. For a large part of the
calculus program this is a sufﬁciently useful tool. But there are differentiable functions which do not have bounded
variation and all nonabsolutely integrable functions have indeﬁnite integrals that are not of bounded variation.
Jordan’s theory was extended in the early 20th century to handle functions of ﬁnite variation on arbitrary compact
sets by A. Denjoy, N. Lusin, and S. Saks. This theory was clariﬁed later by the introduction, by R. Henstock, of measures
carrying the variational information of a function. This theory includes the Jordan version and the Denjoy-Lusin-Saks
versions and is the appropriate technical tool for the full range of problems arising in the calculus program.
We have already, in Chapter 8, introduced the Lebesgue-Stieltjes measures λ f and we return to that study now with
an additional variational measure that is dual to the measure λf called the ﬁne variation.
this chapter is, accordingly, somewhat raised above the expository level of the preceding chapters.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.1. VARIATIONAL MEASURES
351
9.1.1
Full and ﬁne variational measures
The variation of a function f on an interval [a,b] is described by the identity
V(f,[a,b]) = sup
π
Ã
∑
([u,v],w)∈π
| f(v)−f(u)|
!
(9.1)
where the supremum is taken over all possible partitions π of the interval [a,b]. We recall that a similar expression
describes the Lebesgue-Stieltjes measure
λf (E) = inf
β
(
sup
π⊂β
Ã
∑
([u,v],w)∈π
| f(v)−f(u)|
!)
(9.2)
where the supremum is taken over all possible subpartitions π contained in β and the inﬁmum is taken over all full
covers β of the set E. The two expressions (9.1) and (9.2) are clearly closely related but the exact relationship needs
some thinking (see Exercise 770).
The generalization of Lebesgue measure to the Lebesgue-Stieltjes measure arises by replacing (v −u) by | f(v) −
f(u)|. It is more convenient for our purposes to write
∆f([u,v]) = f(v)−f(u)
so that ∆f(I) is an interval function that computes the increment of the function f on the interval I. This is often useful
in conjunction with the notation ω f(I) denoting the oscillation of the function f on the interval I, deﬁned, we recall, as
ω f(I) = sup
u,v∈I
| f(v)−f(u)|.
We review the Lebesgue-Stieltjes measure construction and add to it a new variational measure based on ﬁne covers
instead of full covers.
Deﬁnition 9.1 Let f : R →R be a function and β a covering relation. We write
V(∆f,β) = sup
π⊂β
(
∑
([u,v],w)∈π
|∆f([u,v])|
)
where the supremum is taken over all subpartitions π contained in β.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

352
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
Deﬁnition 9.2 (Full and Fine Variations) Let f : R →R and let E be any set of
real numbers. Then we deﬁne the full and ﬁne variational measures associated
with f by the expressions:
λf (E) = V ∗(∆f,E) = inf{V(∆f,β) : β a full cover of E}
and
λ⋆
f (E) = V∗(∆f,E) = inf{V(∆f,β) : β a ﬁne cover of E}.
Note that the star ⋆(not an asterisk ∗) indicates the ﬁne variation. In general the inequality λ⋆
f (E) ≤λ f (E) holds
and identity holds only for a certain (important) class of functions. These set functions share the same properties as the
measure λ. Speciﬁcally they are countably subadditive for sequences of sets and they are countably additive for disjoint
sequences of closed sets.
9.1.2
Finite variation and σ-ﬁnite variation
Deﬁnition 9.2 allows us to extend the notion of bounded variation to describe the situation on arbitrary sets.
1. f has bounded variation on an interval [a,b] if V(f,[a,b]) < ∞.
2. f has ﬁnite variation on a set E if λ f (E) < ∞.
3. f has σ-ﬁnite variation on a set E if there is a sequence of sets {En} covering E and λf (En) < ∞for each
n = 1,2,3,....
We shall state now and prove (eventually) that the Lebesgue differentiation theorem of Chapter 5 can be extended to
this larger class of functions. Recall that our original statement required that the function have bounded variation on the
whole of some interval.
Theorem 9.3 (Lebesgue differentiation theorem) Let f be a continuous func-
tion deﬁned on some open set that contains a set E on which f has σ-ﬁnite varia-
tion. Then f is differentiable λ-almost everywhere in E and has a ﬁnite or inﬁnite
derivative λf -almost everywhere in E.
The proof follows from Theorem 9.20 that we shall prove much later.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.1. VARIATIONAL MEASURES
353
9.1.3
The Vitali property
The two measures λf and λ⋆
f together express the variation of the function f. We recall that they are analogous to the
full and ﬁne versions of Lebesgue measure, λ∗and λ∗. Those two measures are identical because of the Vitali covering
theorem and the identity
λf = λ⋆
f
(when it holds) would be considered a generalization of the Vitali covering theorem. It is not the case that λ f = λ⋆
f in
general, but for a most important class of functions this will be true. When the Vitali theorem holds for these measures
we say that the function f has the Vitali property.
Deﬁnition 9.4 Let f : R →R and let E be any set of real numbers. Then we say
that the function f has the Vitali property on E provided that the two measures λ f
and λ⋆
f agree on all subsets of E.
9.1.4
Kolmogorov equivalence
The variation describes a convenient equivalence relation between functions. The notion originated with the Russian
mathematician Kolmogorov, and was exploited in this context by Henstock who used the terminology “variational equiv-
alence.”
Deﬁnition 9.5 (Kolmogorov equivalent) Two functions f and g are said to be
Kolmogorov equivalent on E if
V ∗(∆f −∆g,E) = 0.
By means of this equivalence relation we can lift a number of properties that we already know for functions of
bounded variation to a more general class of functions. When two functions are equivalent in this sense then they must
share many properties in common. Here is a list of such properties. Proofs are left for the exercises.
Implications of Kolmogorov equivalence.
If the functions f and g are Kolmogorov equivalent on E then:
1. f ′(x) = g′(x) at almost every point in E at which g is differentiable. [A partial converse is given in Exercise 764.]
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

354
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
2. f is continuous at every point in E at which g is continuous.
3. f is locally bounded at every point in E at which g is locally bounded.
4. f has the Vitali property on E if and only if g has the Vitali property on E.
5. f has ﬁnite variation on E if and only if g has ﬁnite variation on E.
6. f has zero variation on E if and only if g has zero variation on E.
7. λf (E) = λg(E) and λ⋆
f (E) = λ⋆
g(E).
9.1.5
Variation of continuous, increasing functions
In special cases it is easy to estimate the full and ﬁne variations. Note that as a result of this ﬁrst computation we see that
continuous, increasing functions possess the Vitali property.
Theorem 9.6 Let f : R →R be continuous and strictly increasing. Then, for any
set E,
λ⋆
f (E) = λf (E) = λ(f(E))
and f has the Vitali property on every set.
Proof. If β is a full [ﬁne] cover of E then check that
β′ = {(f(I), f(x)) : (I,x) ∈β}
is a full [ﬁne] cover of f(E). Note too that ∆f(I) = λ(f(I)) for such a function. From this we deduce that
λ∗(f(E)) = λf (E)
and
λ∗(f(E)) = λ⋆
f (E).
By the Vitali covering theorem λ∗= λ∗so that the identity in the theorem now follows.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.1. VARIATIONAL MEASURES
355
9.1.6
Variation and image measure
In general the full variation is larger than the image measure.
Theorem 9.7 For an arbitrary function f : R →R and any real set E,
λ(f(E)) ≤λ f (E).
Proof. Let λf (E) < t and select a full cover β of E so that V(∆f,β) < t. We apply the decomposition lemma, Lemma 5.6,
for β. There is an increasing sequence of sets {En} with E = S∞
n=1 En and a sequence of nonoverlapping compact
intervals {Ikn} covering E so that if x is any point in En and I is any subinterval of Ik that contains x then (I,x) belongs
to β([En ∩Ikn]).
Thus let us estimate the λ-measure of the set f(En ∩Ikn). Our estimate need only be crude: if f(x1), f(x2) with
x1 < x2 are any two points in this set then certainly ([x1,x2],x1) ∈β(Ik). Thus
| f(x1)−f(x2)| = |∆f([x1,x2])| ≤V(∆f,β(Ikn))
so it follows that
λ(f(En ∩Ikn) ≤V(∆f,β(Ikn)).
Hence, using Exercise 759 and usual properties of Lebesgue measure„ we have that
λ(f(En)) ≤∑
k
λ(f(En ∩Ikn) ≤∑
k
V(∆f,β(Ikn) ≤V(∆f,β) < t.
Note that the sequence {En} is expanding and that its union is the whole set E; it follows that { f(En)} is expanding
and that its union is the whole set f(E). Accordingly then, by Theorem 7.14,
lim
n→∞λ(f(En)) = λ(f(E)).
It follows that
λ(f(E)) ≤t.
Since t was merely chosen so that λf (E) < t it follows that λ(f(E)) ≤λ f (E) as required.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

356
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
9.1.7
Variational classiﬁcations of real functions
Let us review and enlarge some of our terminology for the behavior of functions. All of the following ideas are express-
ible in the language of the variation. Let f : R →R and let E be any set of reals.
(zero variation) f has zero variation on E if λf (E) = 0.
(ﬁnite variation) f has ﬁnite variation on E if λf (E) < ∞.
(σ-ﬁnite variation) f has σ-ﬁnite variation on E if E ⊂S∞
k=1 Ek so that λf (Ek) < ∞for each k = 1,2,3,....
(Kolmogorov equivalent) f and g are Kolmogorov equivalent on E if V ∗(∆f −∆g,E) = 0.
(Vitali property on a set) f has the Vitali property on E provided that, for all subsets A of E, λ f (A) = λ⋆
f (A).
(continuous at a point) f is continuous at a point x0 provided that λf ({x0}) = 0.
(weakly continuous at a point) f is weakly continuous at a point x0 provided that λ⋆
f ({x0}) = 0.
(λ-absolutely continuous on a set) f is λ-absolutely continuous2 on E provided that, for every set N ⊂E that has
Lebesgue measure zero, λf (N) = 0.
(λ-singular on E) f is λ-singular on E provided λ f (E \N) = 0 for some set N ⊂E that has Lebesgue measure zero.
(mutually singular) Two functions f and g are said to be mutually singular on a set E if E = E1 ∪E2 and λf (E2) =
λg(E1) = 0.
(saltus function) f is a saltus function on an open interval (a,b) if there is a countable set C so that λ f ((a,b)\C) = 0
and λf ((a,b)∩C) < ∞.
Since each of these terms is deﬁnable or describable directly in terms of the variational measures it should be expected
that there are many interrelationships. Some of these are explored in the exercises.
2We previously referred to this simply as absolutely continuous without specifying the measure to which λ f is being compared.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.1. VARIATIONAL MEASURES
357
Exercises
Exercise 759 Let β be a covering relation and f : R →R. If {Ik} is a sequence of nonoverlapping subintervals of an
interval I (open or closed) then show that
∞
∑
k=1
V(∆f,β(Ik)) ≤V(∆f,β(I)).
Exercise 760 (Subadditivity property) Let h1 and h2 be real-valued functions deﬁned on interval-point pairs. Then,
for any set E, show that
V∗(h1 +h2,E) ≤V∗(h1,E)+V ∗(h2,E)
and
V ∗(h1 +h2,E) ≤V ∗(h1,E)+V ∗(h2,E).
Answer
Exercise 761 Let f, g : R →R. Write f ∼g on E if f and g are Kolmogorov equivalent on E. Show that this is an
equivalence relation.
Exercise 762 Let f, g : R →R. Show that, if f and g are Kolmogorov equivalent on a set E, then λ f (E) = λg(E) and
λ⋆
f (E) = λ⋆
g(E).
Exercise 763 Let f, g : R →R. Show that, if f and g are Kolmogorov equivalent on each of the sets E1, E2, E3, . . . then
f and g are Kolmogorov equivalent on the union of these sets.
Exercise 764 Let f, g : R →R. Show that, if f ′(x) = g′(x) at every point of a set E then f and g are Kolmogorov
equivalent on E.
Exercise 765 Let f : R →R. Show that f is λ-singular on a set E if f ′(x) = 0 at almost every point x of E.
Answer
Exercise 766 Let f : R →R. Show, conversely, that if f is λ-singular on a set E then f ′(x) = 0 at almost every point x
of E.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

358
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
Exercise 767 Show that if f : R →R has ﬁnite variation or σ-ﬁnite variation on a set E then f is continuous at each
point of E with countably many exceptions.
Answer
Exercise 768 Show that a function f : R →R is weakly continuous at a point x0 if and only if there are sequences
cn ր x0 and dn ց x0 so that dn −cn > 0 and
f(dn)−f(cn) →0.
Answer
Exercise 769 Let f : R →R. Show that f must be weakly continuous at every point with at most countably many
exceptions.
Answer
Exercise 770 Let f : R →R. Establish the following relation between the Jordan variation and the variational mea-
sures:
λf ((a,b)) ≤V(f,[a,b]) ≤λ f ([a,b]) = λf ((a,b))+λf({a})+λf ({b}).
In particular show that
λf ((a,b)) = λf ([a,b]) = V(f,[a,b])
if f is continuous at a and b.
Exercise 771 Let f : R →R. Show that f has bounded variation on [a,b] if and only if f has ﬁnite variation on (a,b).
Give an example to show that, even so, V(f,[a,b]) may be different from λ f ((a,b)).
Answer
Exercise 772 Let E ⊂(a,b) be a compact set and let {(ai,bi)} be the component intervals of (a,b)\E. Suppose that f
is a continuous function satisfying f(x) = 0 for all x ∈E and that
∑
i
ω f([ai,bi]) < ∞.
Show that λf (E) = 0.
Exercise 773 (local recurrence) A function f : R →R is locally recurrent at a point x if there is a sequence of points
xn with xn ̸= x and limn→∞xn = x so that f(x) = f(xn) for all n. Let f : R →R and suppose that f is locally recurrent at
every point of a set E. Show that λ⋆
f (E) = 0.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.2. DERIVATES AND VARIATION
359
Exercise 774 (local monotonicity) A function f : R →R is locally nondecreasing at a point x if there is a δ > 0 so that
∆f(I) ≥0 for every compact interval I containing x for which λ(I) < δ. Let f : R →R and suppose that f is locally
nondecreasing at every point of a set E and that λ f ({x}) < ∞for each x in E. Show that f has σ-ﬁnite variation on
E.
Answer
Exercise 775 (continuous functions have σ-ﬁnite ﬁne variation) Let f : R →R be a continuous function. Show that
λ⋆
f must be σ-ﬁnite.
Answer
Exercise 776 (Lebesgue differentiation theorem) Prove Theorem 9.3:
Let f be a continuous function deﬁned on some open set that contains a set E on which f has σ-ﬁnite
variation. Then f is differentiable at almost every point of E.
Hint: You may assume here the conclusion of Theorem 9.20 that there is a sequence of compact sets covering E on each
of which f is Kolmogorov equivalent to some continuous function of bounded variation.
Answer
9.2
Derivates and variation
If the derivates of a function f : R →R are ﬁnite on a set E this has implications for the variation λ f on E.
9.2.1
Ordinary derivates and variation
Theorem 9.8 Let f : R →R and suppose that f is differentiable at every point x
of a set E. Then
λf (E) = λ⋆
f (E) =
Z
E | f ′(x)|dx.
In particular f has σ-ﬁnite variation, is λ-absolutely continuous, and has the Vitali
property on that set.
Proof. The fact that f ′(x) exists on E leads immediately to the variational identity
V ∗(∆f −f ′λ,E) = 0.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

360
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
From this, using Exercise 760, we can deduce that
V ∗(∆f,E) ≤V ∗(∆f −f ′λ,E)+V ∗(f ′λ,E)
and hence that
λf (E) = V ∗(∆f,E) ≤V ∗(f ′λ,E) =
Z
E | f ′(x)|dx.
The opposite inequality is proved the same way.
Again, using the other inequality in Exercise subaddprop, we can deduce that
V∗(f ′λ,E) ≤V ∗(∆f −f ′λ,E)+V∗(∆f,E) = λ⋆
f (E)
Since f ′ is measurable the identity
Z
E | f ′(x)|dx = V∗(f ′λ,E) = V ∗(f ′λ,E)
can be used to complete the proof.
Theorem 9.9 Let f : R →R and suppose at every point x of a set E that λ f ({x}) <
∞and that either D f(x) < ∞or D f(x) > −∞. Then f has σ-ﬁnite variation in E.
Proof. For example let us consider that the set E consists of all points at which D f(x) > −∞. Write
En = {x : Df(x) > −n}.
Note that E is the union of the sequence of sets {En}.
Observe that the function fn(x) = f(x)+nx is locally nondecreasing at each x ∈En. It follows (from Exercise 774)
that fn has σ-ﬁnite variation on En. But
λf ≤λ fn +nλ.
Thus f too has σ-ﬁnite variation on En. In consequence, f has σ-ﬁnite variation on E.
9.2.2
Dini derivatives and variation
For many functions a closer analysis is needed than would be available using the upper and lower derivates: we require
one-sided versions.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.2. DERIVATES AND VARIATION
361
Deﬁnition 9.10 (Dini derivatives) Let f : R →R and suppose that x ∈R. Then
the four values
D+ f(x) = inf
δ>0sup
½ f(x+h)−f(x)
h
: 0 < h < δ
¾
D+ f(x) = sup
δ>0
inf
½ f(x+h)−f(x))
h
: 0 < h < δ
¾
D−f(x) = inf
δ>0sup
½ f(x)−f(x−h)
h
: 0 < h < δ
¾
D−f(x) = sup
δ>0
inf
½ f(x)−f(x−h)
h
: 0 < h < δ
¾
are called the Dini derivatives of f at x.
We do not need much more information than this for our main theorem. The reader interested in pursuing the Dini
derivatives further should try Exercises 777–786. We will return in Section 9.14 to the Dini derivatives and show how a
continuous function can be recovered by integrating one of its Dini derivatives.
Theorem 9.11 Let f : R →R be a continuous function and suppose that at every
point x of a set E either
−∞< D+ f(x) ≤D+ f(x) < ∞
or
−∞< D−f(x) ≤D−f(x) < ∞.
Then f has σ-ﬁnite variation in E and is λ-absolutely continuous there.
Proof. We ﬁrst show that, for any positive integer c, f has σ-ﬁnite variation and is λ-absolutely continuous on the set of
points
A = {x : −c < D+ f(x) ≤D+ f(x) < c}.
The geometry of this situation is expressed by the covering relation
β = {[x,x+h],x) : |∆f([x,x+h])| < cλ([x,x+h])}.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

362
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
This relation has none of the properties we have so far encountered, but a modiﬁcation of our methods will handle.
First apply the ideas of the decomposition from Section 5.6 for β. There is an increasing sequence of sets {An} with
A = S∞
n=1 An and a sequence of compact intervals {Ikn} covering A so that if x is any point in An and [x,x + h] is any
subinterval of Ikn then ([x,x+h],x) belongs to β.
In particular if {[ci,di]} is a sequence of subintervals of Ikn with endpoints in the set An, then a brief computation
shows that
∞
∑
i=1
ω f([ci,di]) ≤
∞
∑
i=1
2cλ([ci,di]) ≤2cλ(Ikn).
Let Cnk denote the closure of the set An ∩Ikn. Since f is continuous this same inequality extends to points in that closure.
Thus if {[ci,di]} is a sequence of intervals with endpoints in the compact set Cnk, then
∞
∑
i=1
ω f([ci,di]) ≤
∞
∑
i=1
2cλ([ci,di]) ≤2cλ(Ikn) < ∞.
Deﬁne a function gn so that gn(x) = f(x) for all x ∈Cnk and extend to all of the real line so as to be continuous and
linear on all of the complementary intervals to Cnk. Such a function gn is evidently continuous and has bounded variation.
The same inequality shows that gn is absolutely continuous in the sense of Vitali and so also λ-absolutely continuous.
The computations of Exercise 772 can be used here to check that
V ∗(∆f −∆gn,Ckn) = 0.
This shows that f is Kolmogorov equivalent on each set Cnk to a continuous function of bounded variation. In particular
λf is ﬁnite on each set Cnk. It follows that λf is σ-ﬁnite on A. The function f also inherits from gn the property of being
λ-absolutely continuous on Cnk.
Finally the set E of the theorem can be expressed as a union of a sequence of sets of the same type as A, so that λ f
is σ-ﬁnite and vanishes on null subsets of each member of the sequence. The theorem follows.
9.2.3
Lipschitz numbers
A Lipschitz condition on a function is a global upper estimate of the ratio
¯¯¯¯
F(y)−F(x)
y−x
¯¯¯¯ =
¯¯¯¯
∆F([x,y])
λ([x,y])
¯¯¯¯
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.2. DERIVATES AND VARIATION
363
We can make this same estimate locally in which case the estimates are called Lipschitz numbers and they serve as a
local estimate of the growth of a function. We reﬁne this a bit by introducing a lower estimate as well. In Section 9.2.4
we show how these numbers relate to the variations.
If h(I,x) is any function which assigns real values to interval-point pairs we recall that in Section 5.6.2 we introduced
the following notation for the limits:
limsup
(I,x) =⇒x
= inf
δ>0(sup{h(I,x) : λ(I) < δ, x ∈I})
and
liminf
(I,x) =⇒x = sup
δ>0
(inf{h(I,x) : λ(I) < δ, x ∈I}).
These are just convenient expressions for the lower and upper limits of h(I,x) as the interval I (always assumed to contain
x) shrinks to the point x. As usual if the limsup and liminf are same then the common value (including ∞and −∞) would
be written as
lim
(I,x) =⇒xh(I,x).
When working with such limits Exercises 793 and 794 offer useful estimates of some associated variations.
Deﬁnition 9.12 Let f : R →R. Then
lip f (x) = limsup
(I,x) =⇒x
¯¯¯¯
∆f(I)
λ(I)
¯¯¯¯
lip f (x) = liminf
(I,x) =⇒x
¯¯¯¯
∆f(I)
λ(I)
¯¯¯¯
are called the upper and lower Lipschitz number of f at a point x.
Lemma 9.13 Let f : R →R. For any real number r the sets
{x : lip f (x) < r} and {x : lip f (x) < r}
are measurable.
This is nearly identical to Lemma 7.18.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

364
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
9.2.4
Six growth lemmas
The growth lemmas we present all follow easily from the general limit lemmas of Exercises 793 and 794. Proofs are left
to the student. They can be considered as generalizations of these simple facts:
1. If f ′(x) ≤r for all x then
f(b)−f(a) ≤r(b−a).
2. If f ′(x) ≥r for all x then
f(b)−f(a) ≥r(b−a).
Now, however, the derivative is replaced by upper and lower Lipschitz estimates, the interval [a,b] is replaced by an
arbitrary set and the increments are replaced by variational measures.
Lemma 9.14 Let f : R →R. If lip f (z) < r for every z ∈E then
λ⋆
f (E) ≤rλ(E).
Lemma 9.15 Let f : R →R. If lip f (z) > r > 0 for every z ∈E then
rλ(E) ≤λ f (E).
Lemma 9.16 Let f : R →R. If lip f (z) < r for every z ∈E then
λf (E) ≤rλ(E).
Lemma 9.17 Let f : R →R. If lip f (z) > r > 0 for every z ∈E then
rλ(E) ≤λ⋆
f (E).
Lemma 9.18 Let f : R →R. If λ f (E) < ∞, then lip f (x) < ∞for almost every point
x in E.
Lemma 9.19 Let f : R →R. If λ⋆
f (E) < ∞then lip f (z) < ∞for almost every point
x in E.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.2. DERIVATES AND VARIATION
365
Exercises
Exercise 777 Show that
D f(x) ≤D+ f(x) ≤D+ f(x) ≤D f(x) and D f(x) = max{D−f(x),D+ f(x)}.
Exercise 778 (Grace Chisolm Young) Let f : R →R. Show that the sets of points
{x : D−f(x) < D+ f(x)}
and
{x : D+ f(x) < D−f(x)}
are both countable.
Answer
Exercise 779 (Beppo Levi) Let f : R →R and suppose that f has one-sided derivatives f ′
+(x) and f ′
−(x) at each point
of a set E. Show that the set of points x in E at which
f ′
+(x) ̸= f ′
−(x)
is countable.
Exercise 780 It is easy to misinterpret the theorem of Beppo Levi (Exercise 779). To avoid this construct a continuous
function f : R →R so that for some uncountable set E the right-hand derivative f ′
+(x) exists at each point of E and the
left-hand derivative f ′
−(x) fails to exist at each point of E.
Exercise 781 (William Henry Young) Let f : R →R be a continuous function. Show that the sets of points
{x : D−f(x) = D+ f(x)}
and
{x : D−f(x) = D+ f(x)}
are both residual subsets of R.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

366
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
Exercise 782 Let f : [a,b] →R be a continuous function. Show that the set of points at which f has a right-hand
derivative but no left-hand derivative is a meager subset of [a,b].
Exercise 783 Let f : [a,b] →R be a continuous function with f([a,b]) = [c,d]. Write
D = {x ∈[a,b] : D+ f(x) ≤0}.
Show that either f is nondecreasing on [a,b] or else f(D) contains a compact subinterval of [c,d].
Answer
Exercise 784 (Anthony P. Morse) Let f : [a,b] →R be a continuous function with f([a,b]) = [c,d]. Write
A = {x ∈[a,b] : D+ f(x) ≥0},
B = {x ∈[a,b] : D+ f(x) < 0},
and
C = {x ∈[a,b] : D+ f(x) = 0}.
Suppose that A is dense in [a,b]. Show that B is a meager subset of [a,b] and f(B) is a meager subset of [c,d]. Moreover,
show that either f is nondecreasing on [a,b] or else f(C) contains a residual subset of some compact subinterval of
[c,d].
Answer
Exercise 785 (Darboux property of Dini derivatives) Let f : R →R be a continuous function and suppose that the
Dini derivative D+ f(x) is unbounded both above and below on each interval. Show, for every real number r and
compact interval [a,b], that f maps the set
Er = {x ∈[a,b] : D+ f(x) = r}
onto a residual subset of some compact interval. (In particular D+ f(x) assumes every real number at many points in
any subinterval.)
Exercise 786 For any continuous function f : R →R and any real number r show that the sets
{x : D+ f(x) ≤r} and {x : D+ f(x) ≤r}
are Lebesgue measurable.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.2. DERIVATES AND VARIATION
367
Exercise 787 Let f : R →R. Verify that
lip f (x) = max{|Df(x)|,|Df(x)|}
and also
lip f (x) = max{|D+ f(x)|, |D+ f(x)|, |D−f(x)|, |D−f(x)|}.
Exercise 788 Let f : R →R. Suppose that f has a derivative at x (ﬁnite or inﬁnite). Show that lip f (x) = lip f (x) = | f ′(x)|.
Exercise 789 Let f : R →R be a continuous function, and suppose that lip f (x) = lip f (x) < ∞. Show that f has a ﬁnite
derivative at x and that
lip f (x) = lip f (x) = | f ′(x)|.
Answer
Exercise 790 If f : R →R is continuous and lip f (x) = ∞show that either f ′(x) = ∞or f ′(x) = −∞. Give an example
to show that continuity cannot be dropped.
Exercise 791 Let f : R →R be a continuous function. Show that lip f (z) < ∞for almost every point x.
Answer
Exercise 792 For this exercise and the next three exercises we shall use the following generalized variations. Let h be
any real-valued function deﬁned on interval-point pairs and deﬁne
V(h,β) = sup
π⊂β
(
∑
([u,v],w)∈π
|h([u,v],w)|
)
where the supremum is taken over all π, arbitrary subpartitions contained in β;
h∗(E) = inf{V(h,β) : β a full cover of E}
and
h∗(E) = inf{h,β) : β a ﬁne cover of E}.
Show that h∗and h∗are measures and that h∗≤h∗.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

368
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
Exercise 793 (limsup comparison lemma) Suppose that, for every x in a set E,
s < limsup
(I,x) =⇒x
¯¯¯¯
h(I,x)
λ(I)
¯¯¯¯ < r
Show that
sλ(E) ≤V ∗(h,E) ≤rλ(E)
and
V∗(h,E) ≤rλ(E).
Answer
Exercise 794 (liminf comparison lemma) Suppose that, for every x in a set E,
s < liminf
(I,x) =⇒x
¯¯¯¯
h(I,x)
k(I,x)
¯¯¯¯ < r
Show that
sλ(E) ≤V∗(h,E) ≤rλ(E)
and
sλ(E) ≤V ∗(h,E).
Answer
Exercise 795 Deduce all of the growth lemmas in Section 9.2.4 from the liminf comparison and limsup comparison
lemmas (i.e., Exercises 793 and 794).
Exercise 796 Let f : R →R. If lip f (z) < ∞for every z ∈E then show that f has σ-ﬁnite variation in E and is λ-
absolutely continuous there.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.3. CONTINUOUS FUNCTIONS WITH σ-FINITE VARIATION
369
9.3
Continuous functions with σ-ﬁnite variation
We begin now a deeper analysis of those continuous functions that have σ-ﬁnite full variation on a set. Because of
part (3) of this theorem we now can deduce the Lebesgue differentiation theorem (Theorem 9.3) asserting that these
functions are almost everywhere differentiable.
Theorem 9.20 Let f : R →R be a continuous function and E a real set. Then the
following are equivalent:
1. f has σ-ﬁnite variation on E,
2. there is a sequence {En} of compact sets covering E so that f has ﬁnite
variation on each E,
3. there is a sequence {En} of compact sets covering E so that on each En, f is
Kolmogorov equivalent to some continuous function of bounded variation.
Proof. The implication (2) =⇒(1) is trivial. The implication (3) =⇒(2) is easy: if (3) holds then, for some continuous
function of bounded variation gn : R →R, the equivalence relation
V ∗(∆f −∆gn,En) = 0
implies that λf (En) = λ∗
gn(En) < ∞.
Thus the proof is completed by showing that (1) =⇒(3). It is enough to consider the situation for which E is a
bounded set for which λf (E) < ∞. Choose a full cover β of E and a real number t so that
V(∆f,β) < t < ∞.
Apply the decomposition in Lemma 5.6 to β. Accordingly there is an increasing sequence of sets {Bn} with E = S∞
n=1 Bn
and a sequence of nonoverlapping compact intervals {Ikn} covering E so that if x is any point in Bn and I is any subinterval
of Ikn that contains x then (I,x) belongs to β.
Let Akn = Bn ∩Ikn. We check some facts about the variation of f on Akn. Suppose that {[ai,bi]} is any disjointed
sequence of compact subintervals of Ikn each of which contains at least one point, say xi, of Bn. Then {([ai,bi],xi)} must
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

370
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
form a subpartition contained in β. Consequently
∑
i
| f(bi)−f(ai)| ≤V(∆f,β) < t.
Now let Ckn denote the closure of Akn, i.e., Ckn is the smallest compact set that contains Akn. We extend these
considerations to estimating the variation of f on the larger set Ckn. Suppose now that {[ai,bi]} is any disjointed sequence
of compact subintervals of Ikn each of which contains at least one point ofCnk. We enlarge each interval slightly as needed
to ensure that the intervals remain disjointed but contain also a point, now, of the dense subset Akn. As f is continuous
we can do this without much of an increase in the sums, and so we can certainly guarantee that for the given sequence
{[ai,bi]} that
∑
i
| f(bi)−f(ai)| < 2t < ∞.
Let us deﬁne a function gnk so as to be equal to f(x) on the compact set Ckn and extended to the real line so as to
be linear and continuous on the intervals complementary to Ckn. Such a function gnk is continuous and has bounded
variation.
The computations of Exercise 772 can be used here to check that
V ∗(∆f −∆gnk,Ckn) = 0.
As every compact set from the sequence {Ckn} can be treated the same way, we have veriﬁed the implication (1) =⇒(3)
provided we merely relabel the full collection {Ckn} as a single sequence {En}.
9.3.1
Variation on compact sets
We can reﬁne our analysis of σ-ﬁnite variation with a few further steps.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.3. CONTINUOUS FUNCTIONS WITH σ-FINITE VARIATION
371
Theorem 9.21 Let f : R →R be a continuous function and E a compact set. Then
the following are equivalent:
1. f has σ-ﬁnite variation on E.
2. Every nonempty compact subset S of E has a portion S ∩(a,b) on which f
has ﬁnite variation.
3. f has σ-ﬁnite variation on every null set Z ⊂E that is a Gδ set.
Proof. By a Gδ set we mean a set Z of the form Z = T∞
n=1 Gn for some sequence {Gn} of open sets. Every closed set
can be written in this form.
We begin with (a) =⇒(b). As we have seen in Theorem 9.20, if f has σ-ﬁnite variation on E, then there is a
sequence of compact sets {En} covering the compact set S so that λf (En) < ∞for each n. By the Baire category theorem
there must be a portion S ∩(a,b) of E contained in one at least from the sequence {En}. In particular, for some n,
λf (S∩(a,b) ≤λ f (En) < ∞as required to prove (b).
Let us now prove that (b) =⇒(a) Suppose that every nonempty closed subset S of E has a portion S∩(a,b) on which
f has ﬁnite variation. Let G denote the real set consisting of all real x with the property that there is a δ(x) > 0 so that f
has σ-ﬁnite variation on the set E ∩(x−δ(x),x+δ(x)). Note that
G =
[
x∈G
(x−δ(x),x+δ(x))
so G is open.
Consider the set G∩E. Any point in this set would be contained in an open interval (c,d) with rational endpoints so
that f has σ-ﬁnite variation on G∩(c,d). It follows that f has σ-ﬁnite variation on G∩E. If G ⊃E then, we deduce that
f has σ-ﬁnite variation on E as we wished to prove to verify (a).
Suppose, in order to obtain a contradiction that G does not contain E. Let E′ = E \ G. This would be a nonempty
closed subset of E and so, by hypothesis, there would have to be a portion E′ ∩(a,b) on which f has ﬁnite variation.
But if f has ﬁnite variation on E′ ∩(a,b) and also, evidently, has σ-ﬁnite variation on E \ E′ then f must have σ-ﬁnite
variation on E ∩(a,b). Every point of this set should belong to G which is impossible in view of the assumption that
E′ ∩(a,b) is a portion. This contradiction completes our proof that (b) =⇒(a).
The implication (a) =⇒(c) is trivial. To complete the proof, then, it will sufﬁce to verify that (c) =⇒(b). Suppose
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

372
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
that f has σ-ﬁnite variation on every set Z ⊂E that is a Gδ set of λ-measure zero.
Let S be a nonempty closed subset of E. To verify (b) we need to ﬁnd a portion of S on which f has ﬁnite variation.
If S is a null set then we are almost there. A closed set is also of type Gδ. Thus, λf is σ-ﬁnite on S by hypothesis. As we
have already argued above, in this situation we are assured that S has a portion S∩(a,b) on which f has ﬁnite variation.
Suppose instead that S is a closed set having positive measure. Exercise 797, which follows the proof, shows exactly
how to choose a null subset Z of S that is a Gδ-set that is dense in S. By our assumption (c), there must be a portion
Z ∩(a,b) on which f has σ-ﬁnite variation. We apply Theorem 9.20 to obtain a sequence of compact sets {Kn} whose
union includes Z ∩(a,b) so that each λ f (Kn) < ∞.
Apply the Osgood-Baire theorem, now to the sequence of compact sets {Kn} that covers the Gδ-set Z ∩(a,b). Recall
that the Osgood-Baire theorem, stated in Section 11.1.6 for closed sets, applies equally well to Gδ-sets. Thus we can
conclude that there is a portion Z ∩(c,d) and an integer k so that Z ∩(c,d) ⊂Kk. Since Z is dense in the compact set S
we also have S∩(c,d) ⊂Kk. In particular
λf (S∩(c,d)) ≤λ f (Kn) < ∞.
We have obtained again (but this time without the additional assumption that S has measure zero) exactly property (b).
Exercise 797 Let S be a compact set. Show that there is a subset Z of S that is of type Gδ, is a null set, and is dense in
S.
Answer
9.3.2
λ-absolutely continuous functions
As a corollary to Theorem 9.21 immediately we have a special observation, since an λ-absolutely continuous function
must have ﬁnite variation (indeed zero variation) on every set of λ-measure zero.
Corollary 9.22 Let f : R →R be a continuous function that is λ-absolutely con-
tinuous on a compact set E. Then f has σ-ﬁnite variation there.
9.4
Vitali property and differentiability
In this section we show that differentiability on a set implies the Vitali property on that set and, conversely, that the Vitali
property on a set implies almost everywhere differentiability.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.4. VITALI PROPERTY AND DIFFERENTIABILITY
373
Theorem 9.23 Let f : R →R have a ﬁnite derivative at every point of a set E.
Then f has the Vitali property on E and, moreover,
λf (E) = λ⋆
f (E) =
Z
E | f ′(x)|dx.
Proof. This is already proved in Theorem 9.8.
Theorem 9.24 Let f : R →R be a continuous function that has the Vitali property
on a set E. Then f has a ﬁnite derivative at almost every point of E and, except at
the points of a set N for which λf (N) = 0, f has a ﬁnite or inﬁnite derivative f ′(z).
Proof. We need work only with the Lipschitz numbers here. Recall that if lip f (z) = ∞then necessarily f has an inﬁnite
derivative, f ′(z) = ∞or f(z) = −∞(see Exercise 790). Also if
lipf (z) = lip f (z) < ∞
then f has a ﬁnite derivative at z (see Exercise 789).
It is enough to prove the theorem under the assumption that E is a bounded set. We examine
A = {x ∈E : lip f (x) < lip f (x)}.
As is usual in arguments of this type, introduce rational numbers 0 < r < s and the subsets
Ars = {x ∈A : lip f (x) < r < s < lip f (x)}.
Note that A is the countable union of this collection of sets taken over all rationals r and s with r < s.
By the growth lemmas of Section 9.2.4 we obtain
λ⋆
f (Ars) ≤rλ(Ars) ≤sλ(Ars) ≤λ f (Ars).
Our assumption that f has the Vitali property on E gives the identity λ f = λ⋆
f on each of these subsets of E. None of these
numbers are inﬁnite, r < s, and so the inequality makes sense only in the case that λ f (Ars) = λ(Ars) = 0. Consequently
λf (A) = λ(A) = 0.
At every point x in E \A we know that either
lipf (x) = lip f (x) < ∞
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

374
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
or else
lip f (x) = lip f (x) = +∞.
In the former case, as we have already noted, f has a ﬁnite derivative and in the latter case f has an inﬁnite derivative.
This latter case can occur only on a set of Lebesgue measure zero (as a consequence of Lemma 9.19).
Corollary 9.25 Let f : R →R be a continuous function that has the Vitali property
on a set E and let us specify the following subsets of E at which the derivative exists
ﬁnitely or inﬁnitely:
1. Ed = {x ∈E : f is differentiable at x}.
2. E∞= {x ∈E : f ′(x) = ±∞}.
Then
λ⋆
f (E) = λf (E) =
Z
Ed
|F′(x)|dx+λ f(E∞).
9.5
The Vitali property and variation
The Vitali property is closely related to the ﬁniteness of the variation. Indeed, since the ﬁne variation λ⋆
f of a continuous
function f is always σ-ﬁnite, we know that the identity λ⋆
f (E) = λf (E) can only hold if f has σ-ﬁnite variation on E.
9.5.1
Monotonic functions
Theorem 9.26 Let f : R →R be a continuous, strictly increasing function. Then
f has the Vitali property.
Proof. Theorem 9.6 supplies the identity
λ⋆
f (E) = λf (E) = λ(f(E)).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.5. THE VITALI PROPERTY AND VARIATION
375
Theorem 9.27 Let f : R →R be a continuous, monotonic nondecreasing function.
Then f has the Vitali property.
Proof. Let ε > 0 and deﬁne a new function g(x) = f(x)+εx. The function g is continuous and strictly increasing so, by
the previous theorem, λg∗= λg∗. From Exercise 760 we deduce the inequalities
λf ≤λg∗≤λf +ελ∗
and
λ⋆
f ≤λg∗≤λ⋆
f +ελ∗.
From these two inequalities and the identity λg∗= λ∗
g we can deduce λf = λ⋆
f .
Exercise 798 Let f : R →R be a monotonic, nondecreasing function. Show that if λ⋆
f ({x}) = λf ({x}) for a point x then
f must be continuous at x.
9.5.2
Functions of bounded variation
Theorem 9.28 Let f : R →R be a continuous function that is locally of bounded
variation. Then f has the Vitali property on the real line.
Proof. Fix a compact interval [a,b] and let g be the total variation function of f on [a,b]. We know that this relation
between a function and its total variation function requires the identity
V ∗(∆g−|∆f|,(a,b)) = 0.
In particular λf (E) = λg(E) and λ⋆
f (E) = λ⋆
g(E) for all subsets E of (a,b). By the previous theorem λg(E) = λ⋆
g(E) and
so λf (E) = λ⋆
f (E) follows. This argument produces the identity we require on all bounded sets, and the extension to
arbitrary sets follows from measure properties.
9.5.3
Functions of σ-ﬁnite variation
Theorem 9.29 Let f : R →R be a continuous function. Then f has σ-ﬁnite vari-
ation on a set E if and only if f has the Vitali property on E.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

376
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
Proof. We already know that the Vitali property for a continuous function will imply σ-ﬁnite variation. Let us prove the
converse.
Suppose that f is continuous function that has σ-ﬁnite variation on E. By Theorem 9.20 there is a sequence of
compact sets {En} covering E and a sequence of functions gn each continuous and locally of bounded variation so that
V ∗(∆f −∆gn,En) = 0
(9.3)
We know then, from the previous theorem, that λgn∗= λ∗
gn. We also know that the equivalence (9.3) requires that
λgn
∗= λf and λgn∗= λ⋆
f on all subsets of En.
Introduce the notation
An = En \
[
k<n
Ek
so that S∞
n=1 An = S∞
n=1 En and the sets {An} are pairwise disjoint, measurable sets. The student should justify that the
following computations are permitted:
λf (E) =
∞
∑
n=1
λf (E ∩An) =
∞
∑
n=1
λgn
∗(E ∩An) =
∞
∑
n=1
λgn∗(E ∩An) =
∞
∑
n=1
λ⋆
f (E ∩An) = λ⋆
f (E).
As this applies as well to any subset of E we see that f must have the Vitali property on E as required.
Corollary 9.30 If f : R →R is a continuous function that is λ-absolutely contin-
uous on a compact set E, then f has the Vitali property on E.
Proof. Use Corollary 9.22.
9.6
Characterization of the Vitali property
The class of functions satisfying the Vitali property on a set is fundamental to an understanding of the calculus program
demanding the relation among the concepts of derivative, integral and variation. We have already found a number of
characterizations in Theorem 9.20 and Theorem 9.21. Here are some more. Some are easy consequences of what we
have proved [e.g., (a) and Theorem 775 immediately imply (b)]. Others are left as entertainments for the student.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.7. CHARACTERIZATION OF λ-ABSOLUTE CONTINUITY
377
Theorem 9.31 Let f : R →R be a continuous real function and let E be a compact
set. The following are equivalent:
1. f has the Vitali property on E.
2. f has σ-ﬁnite variation on E.
3. there is a sequence of compact sets {En} with E = S∞
n=1 En so that for each n
there is a continuous function gn that is locally of bounded variation so that
f and gn are Kolmogorov equivalent on En.
4. f has a derivative (ﬁnite or inﬁnite) at λf -almost every point of E.
5. There is a continuous, increasing function g so that
limsup
(I,x) =⇒x
¯¯¯¯
∆f(I)
∆g(I)
¯¯¯¯ < ∞
at every point x ∈E.
6. There is a continuous, increasing function g and a real function f1 so that
V ∗(∆f −f1∆g,E) = 0.
7. There is a continuous, increasing function g so that the composed function
f ◦g has a ﬁnite derivative everywhere in the compact set g−1(E).
9.7
Characterization of λ-absolute continuity
The Vitali property expresses the most important property arising in studies of the derivative in the calculus. The special
subclass of λ-absolutely continuous functions plays its most signiﬁcant role in the integration theory. Here are some
similar characterizations for this class, most easily proved from previously proved statements or techniques.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

378
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
Theorem 9.32 Let f : R →R be a continuous function and let E be a compact set.
The following are equivalent:
1. f is λ-absolutely continuous on E.
2. f has σ-ﬁnite variation on E and is λ-absolutely continuous there.
3. there is a sequence of compact sets {En} with E = S∞
n=1 En so that for each n
there is a continuous function gn that is of locally of bounded variation and
absolutely continuous in the sense of Vitali so that f and gn are Kolmogorov
equivalent on En.
4. f has a ﬁnite derivative at λf -almost every point of E.
5. There is an increasing, λ-absolutely continuous function g so that
limsup
(I,x)→x
¯¯¯¯
∆f(I)
∆g(I)
¯¯¯¯ < ∞
at every point x ∈E.
6. There is an increasing, λ-absolutely continuous function g and a real func-
tion f1 so that
V ∗(∆f −f1∆g,E) = 0.
9.8
Mapping properties
For any set E and any function f : R →R the image of E under the mapping f is written as
f(E) = { f(x) : x ∈E}.
We already know some properties of the image set for continuous functions. We recall from elementary studies (e.g.,
Chapter 1) that the image of any compact interval [a,b] under f is again a compact interval. It is easy to check that that
the image of any compact set E under f is again a compact set f(E). A natural question is whether the image of an
measurable set must also be measurable .
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.8. MAPPING PROPERTIES
379
Theorem 9.33 Let f : R →R be an measurable function and P an measurable set.
The following are equivalent:
(M) f(E) is measurable for every measurable subset E of P,
(N) λ(f(N)) = 0 for every subset N of P for which λ(N) = 0.
Proof. Suppose that E is measurable and that the second statement of the theorem holds. We need consider only the
case where E is bounded. Since f is measurable , then by deﬁnition, we can ﬁnd open sets Gn so that λ(Gn) < 1/n,
E \Gn is compact and f is equal to a continuous function gn : R →R on the compact set E \Gn.
In particular
E = Z ∪
∞
[
n=1
(E \Gn)
where
Z = E ∩
∞
\
n=1
Gn
has λ-measure zero. By hypothesis f(Z) must be a set of λ-measure zero and hence is measurable . Also each
f(E \Gn) = gn(E \Gn)
is a compact set (since the continuous function gn maps compact sets to compact sets). In particular each set here is also
measurable . Thus
f(E) = f(Z)∪
∞
[
n=1
f(E \Gn)
displays f(E) as the union of a sequence of measurable sets. Thus f(E) is also measurable .
Conversely suppose that the ﬁrst statement of the theorem does not hold, yet the second does. Then there is a set
Z ⊂P for which λ(Z) = 0 and yet f(Z) does not have λ-measure zero. For (b) to be true, however, f(Z) should be an
measurable set of positive measure. Such a set must have a subset A that is not measurable .
We shall not pause to prove this assertion but leave it as a project for the student to ﬁnd elsewhere (or prove). A
proof will require use of a logical principle that is beyond our elementary calculus course.
Then there is a set Z1 ⊂Z with f(Z1) = A. The set Z1 must be measurable merely because λ(Z1) ≤λ(Z) = 0. But
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

380
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
then f maps an measurable set Z1 to a set f(Z1) = A that is not measurable. We have contradicted the second statement
thus completing the proof.
9.9
Lusin’s conditions
Deﬁnition 9.34 A function f : R →R is said to satisfy Lusin’s conditions on a set
P when these equivalent conditions hold:
(M) f(E) is measurable for every measurable subset E of P,
(N) λ(f(N)) = 0 for every subset N of P for which λ(N) = 0.
Theorem 9.35 If f : R →R is λ-absolutely continuous on an measurable set P
then f satisﬁes Lusin’s conditions on P.
Proof. This follows immediately from Theorem 9.7 that asserts that λ(f(N)) is smaller than the full variation of f on
N. Thus for every null set N ⊂P,
λ(f(N)) ≤λ f (N) = 0.
9.10
Banach-Zarecki Theorem
In the converse direction we should expect that Lusin’s conditions play a role in characterizing the important property of
absolute continuity.
Theorem 9.36 (Banach-Zarecki) Let f : R →R be a continuous function and E
a compact set. Then the following are necessary and sufﬁcient conditions in order
that f is λ-absolutely continuous on E:
1. f has σ-ﬁnite variation on E, and
2. f satisﬁes Lusin’s condition on E.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.10. BANACH-ZARECKI THEOREM
381
Proof. Certainly if f is λ-absolutely continuous then we already know that (a) holds because of Theorem 9.21 and that
(b) holds because of Theorem 9.35.
Conversely let us suppose that (a) and (b) now hold. We know from Theorem 9.20 that when f has σ-ﬁnite variation
on a compact set E, there is a sequence {En} of compact sets covering E and a sequence of continuous functions of
bounded variation gn so that f and gn are Kolmogorov equivalent on En. Recall in the proof that the construction there
required f = gn on the set En. We can insist on that here. Moreover the functions gn in the proof that extended f were
also chosen to be merely linear or constant in the intervals complementary to En. We can insist also on that here.
We note that the condition (b) of the theorem asserting that f satisﬁes Lusin’s condition on E means that gn satisﬁes
this same condition on En. Moreover by the nature of the construction the function gn satisﬁes Lusin’s condition on all
sets. The proof is completed now by addressing the special case of proving that gn is λ-absolutely continuous.
Note that each gn constructed in our proof above satisﬁes the hypotheses of Exercise 799 below. Indeed, since gn has
bounded variation on every interval it is differentiable outside of a set N of λ-measure zero. The assumption of Lusin’s
condition on gn then provides λ(gn(N)) = 0. The ﬁniteness of
λgn(R\N) =
Z
R\N |g′
n(x)|dx
follows from the fact that gn, as constructed have ﬁnite variation.
Now let Z be any set for which λ(Z) = 0. Let ε > 0 and choose δ > 0 by applying the Exercise 799 to this function
gn. Choose an open set G ⊂Z with λ(G) < δ. Choose any full cover β of Z; then β(G) is also a full cover of Z and the
exercise provides
V ∗(∆gn,Z) ≤V(∆gn,β(G)) < ε.
From this we deduce that λgn(Z) = 0. In consequence gn is λ-absolutely continuous.
From this we can prove that f is λ-absolutely continuous on the set E in question. For if Z is a set of λ-measure zero
then λgn(Z) = 0 will imply that
λf (En ∩Z) = λgn(En ∩Z) = 0
and hence that
λf (E ∩Z) ≤
∞
∑
n=1
λf (En ∩Z) = 0.
This will then show that f is λ-absolutely continuous on E.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

382
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
Corollary 9.37 Let f : [a,b] →R. The following are necessary and sufﬁcient con-
ditions in order that f is absolutely continuous in the sense of Vitali on [a,b]:
1. f is continuous,
2. f has bounded variation on [a,b], and
3. f satisﬁes Lusin’s conditions on [a,b].
A crucial step in the proof of the theorem uses the following classical problem:
Exercise 799 Let g : R →R be a continuous function. Suppose that g is differentiable at each point with the exception
of points in a set N for which λ(g(N)) = 0 and suppose that
R
R\N |g′(x)|dx < ∞. Show that, for every ε > 0, there is a
δ > 0 so that any sequence of nonoverlapping intervals {[cn,dn]} for which ∑n λ([cn,dn]) < δ it follows that
∑
n
|∆g([cn,dn])| < ε.
Answer
9.11
Local Lebesgue integrability conditions
A measurable function f is Lebesgue integrable on an interval [a,b] provided that the integral
R b
a | f(x)|dx is ﬁnite. If
the integral is not ﬁnite then f cannot be Lebesgue integrable on [a,b]. But need it be Lebesgue integrable on some
subinterval? The theorem we now prove gives a sufﬁcient condition in order for an measurable functions to have a local
integrability property. In the theorem we use the following notation for a function f and a closed set E: the function fE
is deﬁned as fE(x) = f(x) whenever x ∈E and fE(x) = 0 otherwise.
Theorem 9.38 Let E be a nonempty closed subset of [a,b] and f an measurable
function. Suppose that
−∞<
Z b
a f(x)dx ≤
Z b
a f(x)dx < ∞.
Then E contains a portion E ∩(c,d) so that fE is Lebesgue integrable on [c,d].
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.11. LOCAL LEBESGUE INTEGRABILITY CONDITIONS
383
Proof. We make a simplifying assumption that allows a small technical detail later. We remove from the set E all points
that are isolated on either the right side or the left side or both sides. There are only countably many such points and that
does not inﬂuence either measure or integration statements. While the resulting set is not closed, it is a set of type Gδ so
that we may still apply the Baire-Osgood theorem to it.
Choose t so that
−t <
Z b
a f(x)dx ≤
Z b
a f(x)dx < t
and a Cousin cover β of [a,b] so that3
¯¯¯¯∑
π
fλ
¯¯¯¯ < t
for all partitions π ⊂β of [a,b]. Let [c,d] be any subinterval and let π ⊂β be a partition of [c,d]. Choose π′ ⊂β so that
it consists of a partition of [a,c] and [d,b]. Then
¯¯¯¯¯ ∑
π∪π′
fλ
¯¯¯¯¯ < t
so that
¯¯¯¯∑
π
fλ
¯¯¯¯ ≤t +
¯¯¯¯¯∑
π′
fλ
¯¯¯¯¯
In particular we can write
T(c,d) = sup
½¯¯¯¯∑
π
fλ
¯¯¯¯ : π ⊂β is a partition of [c,d]
¾
< ∞.
We need a decomposition argument for β similar to that in Section 5.1.8. Choose δ(x) > 0 so that x ∈I ⊂[a,b] and
λ(I) < 2δ(x) requires (I,x) ∈β. Deﬁne
E+
n = {x ∈E : δ(x) > 1/n, 0 ≤f(x) ≤n}
3We are using ∑π fλ to denote the sum ∑(I,x)∈π f(x)λ(I) in this proof as many such sums will be considered.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

384
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
and
E−
n = {x ∈E : δ(x) > 1/n, 0 ≥f(x) ≥−n}.
This sequence of sets exhausts the set E so that, by the Baire-Osgood theorem, there must be a portion of E so that
one of the sets is dense there. Thus we are able to choose an integer m and a subinterval [c,d] so that d −c < 1/m and so
that E+
m (say) is dense in the nonempty portion E ∩(c,d).
We shall investigate the Lebesgue integrability of fE on [c,d]. For that, let π be an arbitrary partition of [c,d] chosen
from β. We shall estimate
∑
π
f +
E λ and ∑
π
f −
E λ
(where, as usual, f +
E and f −
E denote the positive and negative parts of fE).
Deﬁne π1 = π[E] and π2 = π\π1. We alter π1 in two different ways. The ﬁrst alteration denoted as π′
1 will replace
each (I,x) ∈π1 by (I,x′) where x′ ∈E+
m . Since x ∈E and is not isolated on either side in E, and since E+
m is dense in this
portion of E, such points are available. For any such point x′ we see that the pair (I,x′) ∈β because λ(I) < 1/m < δ(x′).
The second alteration denoted as π′′
1 will replace each (I,x) ∈π1 for which f(x) < 0 by (I,x′′) where x′ ∈E+
m . For the
same reasons as before, the pair (I,x′′) ∈β. We will make use of the fact that, for the adjusted points x′ and x′′, we have
the inequalities 0 ≤f(x′) ≤m and f(x) < 0 ≤f(x′′).
Now we do our computations:
¯¯¯¯¯ ∑
π1∪π2
fλ
¯¯¯¯¯ ≤T(c,d)
(9.4)
¯¯¯¯¯¯ ∑
π′
1∪π2
fλ
¯¯¯¯¯¯
≤T(c,d)
(9.5)
¯¯¯¯¯¯∑
π′
1
fλ
¯¯¯¯¯¯
≤m(d −c) ≤1.
(9.6)
Combining (9.5) and (9.6) we see that
¯¯¯¯¯∑
π2
fλ
¯¯¯¯¯ ≤T(c,d)+1
(9.7)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.11. LOCAL LEBESGUE INTEGRABILITY CONDITIONS
385
Thus we can estimate
∑
π
f +
E λ = ∑
π1
f +
E λ = ∑
π′′
1
f +
E λ ≤∑
π′′
1
fλ
≤∑
π′′
1
fλ+
"
∑
π2
fλ+T(c,d)+1
#
= ∑
π′′
1∪π2
fλ+T(c,d)+1 ≤2T(c,d)+1.
As such sums have this upper bound we can conclude that
Z d
c f +
E (x)dx
is ﬁnite and hence that the measurable function f +
E is Lebesgue integrable on [c,d].
Now we show that f −
E is also Lebesgue integrable on [c,d]. Since
f −
E (x) = f +
E (x)−f(x)
for every x ∈E, we ﬁnd that
∑
π
f −
E λ = ∑
π1
f −
E λ = ∑
π1
f +
E λ−∑
π1
fλ
=
"
∑
π1
f +
E λ+∑
π2
f +
E λ
#
−∑
π1
fλ
≤[2T(c,d)+1]−∑
π1
fλ−
"
∑
π2
fλ−T(c,d)−1
#
= [3T(c,d)+2]−∑
π
fλ ≤4T(c,d)+2.
Once again such sums have this upper bound we can conclude that the measurable function f −
E is Lebesgue integrable
on [c,d]. Finally then fE = f +
E + f −
E too must be Lebesgue integrable on [c,d]. This gives us our portion E ∩(c,d) and
completes the proof.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

386
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
9.12
Continuity of upper and lower integrals
The indeﬁnite integral of an integrable function is continuous. We can express this by saying that, if f is integrable on a
compact interval [a,b], then for every ε > 0 there is a δ > 0 so that
−ε <
Z d
c f(x)dx < ε
for every subinterval [c,d] ⊂[a,b] for which λ([c,d]) < δ. We wish a version of this that does not assume integrability
and that can be used for a characterization.
Deﬁnition 9.39 A function f is said to have continuous upper and lower integrals
on a compact interval [a,b] if for every ε > 0 there is a δ > 0 so that
−ε <
Z d
c f(x)dx ≤
Z d
c f(x)dx < ε
for every subinterval [c,d] ⊂[a,b] for which λ([c,d]) < δ.
Lemma 9.40 Suppose that f : [a,b] →R has continuous upper and lower integrals
on a compact interval [a,b]. Then
−∞<
Z d
c f(x)dx ≤
Z d
c f(x)dx < ∞
for every subinterval [c,d] ⊂[a,b].
Proof. There must be a δ > 0 so that
−1 <
Z d
c f(x)dx ≤
Z d
c f(x)dx < 1
for every subinterval [c,d] ⊂[a,b] for which λ([c,d]) < δ. Subdivide
a = a0 < a1 < ··· < an−1 < an = b
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.13. A CHARACTERIZATION OF THE INTEGRAL
387
in such a way that each ai −ai−1 < δ. Then compute, using Exercise 647, that
Z b
a f(x)dx =
n
∑
i=1
Z ai
ai−1
f(x)dx ≤n < ∞.
A similar argument handles the lower integral.
Exercises
Exercise 800 (Cauchy extension property) Let f be integrable on every subinterval [c,d] ⊂(a,b). Show that f is
integrable on [a,b] if and only if if f has continuous upper and lower integrals on [a,b].
Answer
Exercise 801 (Harnack extension property) Let F : R →R, let E be a closed subset of [a,b], and let {(ai,bi)} be the
sequence of intervals complementary to E in (a,b). Suppose that
1. f(x) = 0 for all x ∈E,
2. f is integrable on all intervals [ai,bi], and
3.
∞
∑
i=1
sup
ai≤ci<di≤bi
¯¯¯¯
Z di
ci
f(x)dx
¯¯¯¯ < ∞.
Show that f is integrable on [a,b] and
Z b
a f(x)dx =
∞
∑
i=1
Z bi
ai
f(x)dx.
Answer
9.13
A characterization of the integral
The class of Lebesgue integrable functions on an interval [a,b] can be characterized as those measurable functions f for
which
Z b
a | f(x)|dx < ∞.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

388
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
We now show that the full class of integrable functions (absolutely or nonabsolutely) on an interval [a,b] can be charac-
terized as those measurable functions that have continuous upper and lower integrals.
Theorem 9.41 A function f is integrable on [a,b] if and only if f is measurable
and f has continuous upper and lower integrals on [a,b].
Proof. We already know that an integrable function has these properties. Conversely suppose that f is measurable and
that f has continuous upper and lower integrals on [a,b]. An open interval (s,t) ⊂(a,b) will be called “accepted” if f
is integrable on every [c,d] ⊂(s,t). Let G be the union of all accepted intervals. This is an open subset of (a,b). Note
that, if [c,d] ⊂G, then by the Heine-Borel property [c,d] can be written as the union of a ﬁnite collection of intervals
{[ci,di]} each of which is inside an accepted interval. It follows that f is integrable on [c,d] too.
Let
G =
∞
[
i=1
(ai,bi),
displaying G as a union of its component intervals. We claim ﬁrst that f must be integrable on each of the compact
intervals [ai,bi]. This follows directly from the Cauchy extension property (Exercise 800) using the hypothesis that f
has continuous upper and lower integrals. We shall use a single function F to represent the indeﬁnite integral of f on
each of these intervals, but we are cautioned not to use F outside of the intervals.
In particular if G = (a,b) then the proof is completed since then f must be integrable on [a,b] as required. Suppose
not, i.e., that the theorem fails and G ̸= (a,b). Then E = [a,b] \ G is a nonempty closed set. Note that E can have no
isolated points. Indeed if c ∈E is isolated then (c−t,c) ⊂G and (c,c+t) ⊂G for some t > 0 and another application of
the Cauchy extension property would show that (c−t,c+t) is accepted so that (c−t,c+t) ⊂G which is not possible.
The goal of the proof now will be to obtain a portion E ∩(c′,d′) of E with the property that (c′,d′) is accepted, which
would be impossible. Portions cannot be empty and no point of E would be allowed to belong to an accepted interval.
The local integrability Theorem 9.38 and the Harnack extension property (Exercise 801) will play key roles.
The assumption that f satisﬁes the continuity condition in Deﬁnition 9.39 together with Lemma 9.40 shows that the
upper and lower integrals of f are ﬁnite. Thus, we can apply Theorem 9.38 to ﬁnd a portion E ∩[c,d] so that fE is
Lebesgue integrable on [c,d].
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.13. A CHARACTERIZATION OF THE INTEGRAL
389
Since f has continuous upper and lower integrals on [c,d] it follows from Lemma 9.40 that
−∞<
Z d
c f(x)dx ≤
Z d
c f(x)dx < ∞.
Since fE is Lebesgue integrable on [c,d] it follows that
Z d
c | fE(x)|dx < ∞.
Thus we can select a real number M > 0 and a Cousin cover β of [c,d] so that for any partition π of [c,d] from β both
¯¯¯¯∑
π
fλ
¯¯¯¯ < M
and
∑
π
| fE|λ < M.
We need a decomposition argument for β similar to that in Section 5.1.8. Choose δ(x) > 0 so that x ∈I ⊂[a,b] and
λ(I) < 2δ(x) requires (I,x) ∈β. Deﬁne
En = {x ∈E ∩[c,d] : δ(x) > 1/n}.
This sequence of sets exhausts the set E ∩[c,d] so that, by the Baire-Osgood theorem, there must be a portion of so that
one of the sets is dense there. Let us agree that Em is dense in E ∩(c′,d′) and that [c′,d′] is smaller in length than 1/m.
Let {(ci,di)} denote the component intervals of (c′,d′) \ E. There must be inﬁnitely many such component intervals
since otherwise it would follow that f is integrable on [c′,d′]. We claim that
∞
∑
i=1
ωF([ci,di] = ∞.
(9.8)
For, if not, then the Harnack extension property (Exercise 801) shows that f −fE must be integrable on [c′,d′] and hence
f is integrable there. But that contradicts the fact that [c′,d′] must contain points of E.
From the continuity of F we know that
ωF([ci,di] = |F(s)−F(t)|
(9.9)
for some subinterval [s,t] ⊂[ci,di]. Consequently we may choose a sequence of intervals {[sk,tk]}, chosen from different
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

390
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
component intervals [ci,di] in such a way that either
0 ≤
∞
∑
k=1
F(tk)−F(sk) = ∞
(9.10)
or
0 ≥
∞
∑
k=1
F(tk)−F(sk) = −∞.
(9.11)
Let us assume the former. If (9.11) holds instead the same argument with a slight adjustment in the inequalities will
work.
Now we ﬁx an integer p and carefully construct a partition π of the interval [c,d] from β. The ﬁrst step is to choose
π′ from β to form a partition of [c,c′], then π′′ from β to form a partition of [d′,d]. For each of the intervals {[sk,tk]} for
k = 1,2,3..., p we select a partition πk of [sk,tk] in such a way that
|F(tk)−F(sk)−∑
πk
fλ| < 2−k.
(9.12)
This is possible since f is integrable on each such interval and F is an indeﬁnite integral. To complete the partition we
take the remaining intervals, not yet covered by
π′ ∪π′′ ∪
p
[
k=1
πk.
There are only ﬁnitely many of these intervals, say I1, I2, . . . , Iq. Each is a subinterval of [c′,d′] and each one contains
many points of E; thus each one also contains a point of Em. Select a point xi from Em ∩Ii (i = 1,2,...,q) and note that
(Ii,xi) belongs to β. Thus if we set
π′′′ = {(Ii,xi) : i = 1,2,...,q}
then we have obtained a partition
π = π′ ∪π′′ ∪π′′′ ∪
p
[
k=1
πk
of the interval [c,d] that is contained in β.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.14. INTEGRAL OF DINI DERIVATIVES
391
Consequently, by the way in which we chose M and β,
¯¯¯¯∑
π
fλ
¯¯¯¯ ≤M.
We know too that
¯¯¯¯¯∑
π′′′
fλ
¯¯¯¯¯ ≤∑
π′′′
| fE|λ ≤M.
We combine these inequalities with (9.12) and the simple inequality
p
∑
k=1
2−k ≤1
to obtain
p
∑
k=1
F(tk)−F(sk) ≤
¯¯¯¯¯ ∑
π′∪π′′
fλ
¯¯¯¯¯+2M +1.
This is true for any p and conﬂicts with our assumption that the inequality (9.10) holds.
Since neither inequality (9.10) nor (9.11) can hold it follows that inequality (9.9) also fails, thus f is integrable on
[c′,d′]. In other words (c′,d′) is accepted, which would be impossible. This completes the proof.
9.14
Integral of Dini derivatives
If F is a continuous function on an interval [a,b] and has a ﬁnite Dini derivative, say D+F(x), at each point then f is
determined up to an additive constant by that Dini derivative. One suspects that
F(x)−F(a) =
Z x
a D+F(t)dt
but this is not necessarily true and even when it is true we need some further methods to handle.
9.14.1
Motivation
We require a variant on the Cousin covering lemma that is more appropriate for handling the Dini derivatives of contin-
uous functions.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

392
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
The Cousin covers are particularly suited to describing properties of the ordinary derivative. For example if DF(x) >
r then the covering relation
β = {(I,x) : ∆F(I) > rλ(I)
has the property that for some δ > 0, if x ∈I and λ(I) < δ then necessarily (I,x) ∈β. Indeed DF(x) > r if and only if β
has this property.
We conclude this chapter by determining how to recover a function from one of its Dini derivatives and so will
require a one-sided analogue. The simplest version could come from the observation that D+F(x) > r if and only if the
covering relation
β = {(I,x) : ∆F(I) > rλ(I)
has the property that for some δ > 0, if 0 < h < δ then necessarily ([x,x+h],x) ∈β.
But in fact our covering relation needs to be designed to handle the upper Dini derivative, not the lower. For that the
description is more delicate: D+F(x) > r if and only if the covering relation
β = {(I,x) : ∆F(I) > rλ(I)}
has the property that for any ε > 0, there is at least one value of h with 0 < h < ε for which ([x,x + h],x) ∈β. We
strengthen this by insisting that F is continuous. In that case, if we found h so that
F(x+h)−F(x)
(x+h)−x
> r,
notice that there must be a δ > 0 so that
F(x′ +h)−F(x)
(x′ +h)−x
> r
for every value of x′ in the interval [x−δ,x].
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.14. INTEGRAL OF DINI DERIVATIVES
393
Deﬁnition 9.42 Let K be a compact set with endpoints a = infK and b = supK. A
covering relation β is said to be a quasi-Cousin cover of K provided that
1. There is at least one pair ([a,d],a) ∈β with a < d ≤b.
2. For every a < x < b, x ∈K there is a δ > 0 so that there is at least one
x < d ≤b for which all pairs ([c,d],x) ∈S whenever x−δ < c ≤x.
3. There is a δ > 0 so that all pairs ([c,b],b) ∈β whenever b−δ < c < b.
9.14.2
Quasi-Cousin covering lemma
Even though the notion of a quasi-Cousin cover is much weaker than that of a Cousin cover the covering lemma gener-
alizes.
Lemma 9.43 (Quasi-Cousin covering lemma) Let β be a quasi-Cousin cover of
a compact set K with endpoints a = infK and b = supK. Then β contains a sub-
partition π so that
K ⊂
[
(I,x)∈π
I ⊂[a,b].
Proof. Let us assume ﬁrst that K = [a,b]. Let E be the set of all points z, with b ≥z > a and with the property that β
contains a partition π of [a,z].
Argue that (i) E ̸= /0, (ii) if supE = t then t cannot be less than b, (iii) if supE = b then b ∈E.
We know that (i) is true since there is at least one pair ([a,d],a) ∈β with a < d ≤b and so d ∈E. Thus we may set
t = supE and be assured that a < d ≤t ≤b. To see (ii) note that it is not possible for t < b for if so then there is a δ > 0
and d′ > t for which all pairs (t,[c,d′]) ∈β with t −δ < c ≤t. But that supplies a point t′ ∈(c−δ,c]∩E and the partition
of [a,t′] can be enlarged by including (t,[t′,d′]) to form a partition of [a,d′]; thus d′ ∈E. But this violates t = supE.
Finally for (iii) if t = b and yet b ̸∈E then, repeating much the same argument, there is a δ > 0 for which all pairs
(b,[c,b]) ∈β with b−δ < c < b. But that supplies a point t′ ∈(b−δ,b)∩E and the partition for [a,t′] can be enlarged
by including (b,[t′,b]) to form a partition π for [a,b]. This shows that b ∈E after all.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

394
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
Now let us handle the general case for an arbitrary compact set K ⊂[a,b]. Let G = (a,b)\K and
β1 = {(I,x) : x ∈I and I ⊂G}.
Since β is a quasi-Cousin cover of K we can check that β ∪β1 is a quasi-Cousin cover of [a,b]. By the ﬁrst part of the
proof there is a partition π ⊂β∪β1 of [a,b]. Remove those elements of π that do not belong to β to form a subpartition
with exactly the required properties.
The proof contains explicitly the statement of the corollary:
Corollary 9.44 Let β be a quasi-Cousin cover of a compact interval [a,b]. Then
β contains a partition of [a,b] (although not necessarily of other subintervals of
[a,b]).
Exercises
Exercise 802 (variant on the quasi-Cousin covering) Let K be a compact set and β a covering relation. Suppose that,
for each x ∈K, there are s, t > 0 so that all pairs
([x′,x+s],x) ∈β
whenever x−t ≤x′ ≤x. Show that β contains a subpartition π for which
K ⊂
[
(I,x)∈π
I.
Exercise 803 Let f : R →R be continuous at each point of an open interval (a,b) and suppose that D+ f(x) > m for
each x ∈(a,b). Then f(d)−f(c) > m(d −c) for each [c,d] ⊂(a,b).
9.14.3
Estimates of integrals from derivates
As a warm-up to our theorem about Dini derivatives let us show that the ordinary derivates are easily handled.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.14. INTEGRAL OF DINI DERIVATIVES
395
Lemma 9.45 Let F, f : [a,b] →R. If F is continuous at a and b and
DF(x) ≥f(x)
at every point of (a,b), then
Z b
a f(x)dx ≤F(b)−F(a).
Proof. Let ε > 0. Take the covering relation
β1 = {(I,x) : ∆F(I) ≥(f(x)−ε)λ(I)}
and
β2 = {(I,x) : x = a or b, x ∈I and |∆F(I)|+| f(x)|λ(I) < ε}.
Check that β = β1 ∪β2 is a Cousin cover of [a,b]. At the endpoints a or b the continuity of F needs to be used in the
veriﬁcation, while at the points in (a,b) the inequality DF(x) ≥f(x) is used.
Any partition π ⊂β of the interval [a,b] will satisfy
∑
(I,x)∈π
f(x)λ(I) ≤∑
(I,x)∈π
[∆F(I)+ελ(I)]+2ε = F(b)−F(a)+ε(2+b−a).
This is true for all partitions π from this β and all ε > 0 and so the conclusion that
Z b
a f(x)dx ≤F(b)−F(a)
now follows.
Lemma 9.46 Let F, f : [a,b] →R. If F is continuous at a and b and
DF(x) ≤f(x)
at every point of (a,b), then
Z b
a f(x)dx ≥F(b)−F(a).
Proof. Apply Lemma 9.45 to the functions −F and −f.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

396
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
9.14.4
Estimates of integrals from Dini derivatives
For Dini derivatives there is a weaker version of Theorem 9.45 available using similar arguments (but employing quasi-
Cousin covers as well as Cousin covers). Note that this weaker version uses lower and upper rather than upper and lower
integrals; in particular no corollary can be derived asserting the integrability of the Dini derivative (indeed it may not be
integrable).
Theorem 9.47 Suppose that F : [a,b] →R is continuous and that g is a ﬁnite-
valued function. If D+F(x) ≥g(x) at every point a < x < b, then,
F(b)−F(a) ≥
Z b
a g(x)dx.
(9.13)
If D+F(x) ≤g(x) at every point a < x < b, then
F(b)−F(a) ≤
Z b
a g(x)dx.
(9.14)
Proof. Let ε > 0. Take the covering relation β1 of all pairs ([x,y],z) with
∆F([x,y]) ≥(f(z)−ε)λ([x,y])
and β2 of all pairs ([a,y],a) and ([x,b],b) for which
∆F([a,y])−f(a)λ([a,y]) > −ε
and
∆F([x,b]) ≥f(b)λ([x,b])−ε.
It is easy to verify that β = β1 ∪β2 is a quasi-Cousin cover of [a,b]. At the endpoints a or b the continuity of F needs to
be used in the veriﬁcation, while at the points in (a,b) the inequality D+F(x) ≥g(x) is used.
This may not seem too much of a help since the integral is deﬁned by Cousin covers, not by quasi-Cousin covers.
But let β3 be any Cousin cover of [a,b]. Check that, as deﬁned, β3 ∩β must be a quasi-Cousin cover of [a,b]. Thus there
is at least one partition π from β3 that is also in β. For that partition a familiar argument gives us
∑
(I,x)∈π
f(x)λ(I) ≤∑
(I,x)∈π
[∆F(I)+ελ([x,y])]+2ε = F(b)−F(a)+ε(2+b−a).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

9.14. INTEGRAL OF DINI DERIVATIVES
397
Note that this means any Cousin cover of [a,b] contains at least one partition π with this property. Thus, while we
can say nothing about the upper integral, we certainly can assert that the lower integral must always be lesser than
F(b)−F(a)+ε(2+b−a) and from this the theorem follows.
As a consequence of this theorem we observe that if an everywhere ﬁnite function g is assumed to be integrable on
[a,b] and lies between the two derivates then an integral identity holds. The assumption that g is integrable cannot be
dropped here.
Corollary 9.48 Let F : [a,b] →R be continuous and g : [a,b] →R be integrable
on [a,b] and suppose that
D+F(x) ≤g(x) ≤D+F(x)
at every point x on [a,b]. Then
F(b)−F(a) =
Z b
a g(x)dx.
Exercises
Exercise 804 Suppose that F : R →R is a continuous function and that D+F(x) > r at every point of an interval [a,b].
Verify that the covering relation
β = {(I,x) : ∆F(I) > rλ(I)}
satisﬁes the ﬁrst two conditions (but not necessarily the third) in Deﬁnition 9.42.
Exercise 805 Continuing the previous exercise, let ε > 0 and let
β′ = {([x−t,x)],x) : |F(x−t)−F(x)| < ε}.
Show that β∪β′ is a quasi-Cousin cover of [a,b].
Exercise 806 Show that every Cousin cover of an interval [a,b] is also a quasi-Cousin cover for any compact subset of
[a,b].
Exercise 807 Let f : R →R and suppose that the function D+ f(x) is ﬁnite-valued and continuous at a point x0. Show
that f is differentiable at x0.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

398
CHAPTER 9. NONABSOLUTELY INTEGRABLE FUNCTIONS
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

Chapter 10
Integration in Rn
In this chapter we shall sketch a theory of integration for functions of several variables. This is just a sketch to illustrate
that the methods developed in the text extend without too much trouble to higher dimensions. The reader is, by now,
ready for a full treatment using any of the standard presentations but may ﬁnd it convenient to see a rapid account
extending some of our techniques here.
The exercises do the technical work and, for the most part we have been content to give references to where the
techniques needed can be found. We consider this ﬁnal chapter more of a guide to thinking about this subject and the
exercises and discussions in the Answers section are more a dialogue than a course of study.
10.1
Some background
We must assume the reader is familiar with the rudiments of analysis in the space Rn. In particular these facts will be
used.
• Rn is the collection of all n-tuples of real numbers x = (x1,x2,...,xn).
• Addition in Rn is deﬁned by
(x1,x2,...,xn)+(y1,y2,...,yn) = (x1 +y1,x2 +y2,...,xn +yn).
399
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

400
CHAPTER 10. INTEGRATION IN RN
• Scalar multiplication in Rn is deﬁned by
r(x1,x2,...,xn) = (rx1,rx2,...,rxn).
• Distances in Rn are deﬁned by
∥(x1,x2,...,xn)−(y1,y2,...,yn)∥=
q
(x1 −y1)2 +(x2 −y2)2 +...(xn −yn)2.
• The open ball with center x = (x1,x2,...,xn) and radius r in Rn is
B(x;r) = {y : ∥x−y∥< r}.
10.1.1
Intervals and covering relations
By a closed interval in R we mean, of course, the set
I = [a,b] = {x : a ≤x ≤b}.
That set has two endpoints and the interior is the open interval (a,b) between them. The symbol |I| denotes the length
of I, i.e., |I| = b−a.
By an interval in R2 we mean a product of two intervals in R. Thus the closed rectangle
I = [a,b]×[c,d] = {(x,y) : a ≤x ≤b, c ≤y ≤d}.
That set has four vertices, (a,c), (b,c), (b,c), and (b,d). The symbol |I| denotes the area of I, i.e., |I| = (b−a)(d −c)
which is the product of the length and width of the rectangle.
These ideas and notation extend without difﬁculty to any dimension greater than two. By an interval in Rn we shall
mean a cartesian product of one-dimensional intervals. It will be a closed interval if it is a product of closed intervals.
Thus
I = [a1,b1]×[a2,b2]×···×[an,bn]
is the set of points in Rn described by these inequalities:
{(x1,x2,...,xn) : a1 ≤x1 ≤b1, a2 ≤x2 ≤b2,..., an ≤xn ≤bn}.
This interval has 2n vertices. The symbol |I| denotes the n-dimensional volume of I, i.e.,
|I| = (b1 −a1)(b2 −a2)(b3 −a3)...(bn −an)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

10.1. SOME BACKGROUND
401
which is the product of the length of all the edges in the interval.
Two intervals are nonoverlapping if their intersection has no interior points. Thus nonoverlapping intervals are either
disjoint or else they meet only at some boundary points. A packing is a ﬁnite covering relation
{(I1,x1), (I2,x2), (I2,x2),..., (Ik,xk)}
where each Ii is an interval and xi is a point in the corresponding interval Ii, and distinct pairs of intervals Ii and Ij do not
overlap.
By a full interval cover of a set E ⊂Rn we mean a covering relation β that consists of pairs (I,x) again for which
each I is an interval and x is a point in the corresponding interval I, and which is full in the following (by now familiar)
sense: for each x ∈E there is a positive δ(x) so that β contains every pair (I,x) for which I is an interval containing x
and contained in the open ball B(x;δ(x)).
Exercise 808 (additivity of the volume) Show that the n-dimensional volume is an additive interval function, i.e., show
that if J is a closed interval in Rn and π a packing for which
J =
[
(I,x)∈π
I
then
|J| = ∑
(I,x)∈π
|I|.
Answer
Exercise 809 (Cousin’s lemma) Show that if β is a full interval cover of a closed interval J in Rn then there is a packing
π ⊂β for which
J =
[
(I,x)∈π
I.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

402
CHAPTER 10. INTEGRATION IN RN
10.2
Measure and integral
The measure theory and the integration are deﬁned by means of full interval covers and packings. This is the analogue
of the Riemann sums expression that was available in dimension one for all of our integrals in the early chapters.
Deﬁnition 10.1 Let E ⊂Rn and let f be a nonnegative real-valued function de-
ﬁned on E. Then we deﬁne the upper integral
Z
E f(x)dx = inf
β sup
π⊂β ∑
(I,x)∈π
f(x)|I|
where the supremum is with regard to all packings π ⊂β where β is an arbitrary
full interval cover of E. We use also the notation
Ln(E) =
Z
E dx
and refer to the set function Ln as Lebesgue measure in Rn.
The reader might well have expected a higher dimensional integral to look more like the one-dimensional version.
For example if f : R2 →R perhaps we would expect an indeﬁnite integral F : R2 →R deﬁned as
F(x,y) =
Z x
a
Z y
b f(s,t)dsdt.
But the theory is far better expressed by the set function
E →
Z
E f(x)dx
and it is this idea and notation that we pursue.
Note that if E is a bounded set then the upper integral could have been simply stated as an interval function by
noticing that
Z
I f(x)χE(x)dx =
Z
E f(x)dx
for every interval I that contains E. Thus the theory could have been developed by Riemann sums over partitions
of intervals. We prefer to pass immediately to the set version E →
R
E f(x)dx which is closer to the mainstream of
integration theory.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

10.2. MEASURE AND INTEGRAL
403
We shall not introduce a lower integral (as might be expected) but we will instead deﬁne what is meant by a Ln-
measurable set and a Ln-measurable function. When E is a Ln-measurable set and a f is a Ln-measurable function then
the Lebesgue integral
Z
E f(x)dx
will be deﬁned to be the value
Z
E[ f(x)]+ dx−
Z
E[ f(x)]−dx
provided this has a meaning (i.e., is not ∞−∞). Thus the upper integral will serve us only as a tool that leads quickly to
a formal expression for the value of the Lebesgue integral and the Lebesgue measure.
10.2.1
Lebesgue measure in Rn
We use the special notion
Ln(E) =
Z
E dx
and refer to this as n-dimensional Lebesgue [outer] measure on Rn. This is deﬁned for all subsets E of Rn as is the upper
integral
Z
E f(x)dx
which is deﬁned for all functions f that assign a nonnegative number at every point of the set E.
We shall discover that for intervals Ln(I) = |I| so that Lebesgue measure is an extension of the volume function from
the class of closed intervals to the class of all subsets of Rn. Some authors prefer to keep the same notation in which
case |E| is deﬁned for all subsets of Rn as
|E| =
Z
E dx.
10.2.2
The fundamental lemma
The fundamental lemma that we need that describes the key property of the upper integral and the measure is the
following, seen already in its one-dimensional version in Lemma 6.26. The same proof works here to give essentially
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

404
CHAPTER 10. INTEGRATION IN RN
the same conclusion.
Lemma 10.2 Let E ⊂Rn and let f, f1, f2, f3, . . . be a sequence of nonnegative
real-valued functions deﬁned on E. Suppose that
f(x) ≤
∞
∑
k=1
fk(x)
for every x ∈E. Then
Z
E f(x)dx ≤
∞
∑
k=1
Z
E fk(x)dx.
The two corollaries follow immediately and show that the set functions
E →
Z
E dx
and
E →
Z
E f(x)dx
are measures on Rn in the sense we make precise in Section 10.4 below.
Corollary 10.3 Let E, E1, E2, E3, . . . be a sequence of subsets of Rn. Suppose that
E ⊂
∞
[
k=1
Ek.
Then
Ln(E) ≤
∞
∑
k=1
Ln(Ek).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

10.2. MEASURE AND INTEGRAL
405
Corollary 10.4 Let E, E1, E2, E3, . . . be a sequence of subsets of Rn. Suppose that
E ⊂
∞
[
k=1
Ek
and that f is a nonnegative function deﬁned at least on the set S∞
k=1 Ek. Then
Z
E f(x)dx ≤
∞
∑
k=1
Z
Ek
f(x)dx.
Exercise 810 Show, for all intervals I in Rn, that Ln(I) = |I|.
Exercise 811 Let f and g be nonnegative functions on a set E ⊂Rn and such that f(x) ≤g(x) for all x ∈E. Show that
Z
E f(x)dx ≤
Z
Eg(x)dx.
Exercise 812 Let f be a nonnegative function on a set E ⊂Rn and such that r ≤f(x) ≤s for all x ∈E for some real
numbers r and s. Show that
rLn(E) ≤
Z
E f(x)dx ≤sLn(E)
Exercise 813 Suppose that E1,E2 ⊂Rn are separated by open sets, i.e., there is a disjoint pair of open sets G1 and G2
in Rn so that E1 ⊂G1 and E2 ⊂G2. Show that
Z
E1∪E2
f(x)dx =
Z
E1
f(x)dx+
Z
E2
f(x)dx.
Exercise 814 Suppose that E1,E2 ⊂Rn are separated, i.e.,
inf{∥e1 −e2∥: e1 ∈E1, e2 ∈E2} > 0.
Show that
Z
E1∪E2
f(x)dx =
Z
E1
f(x)dx+
Z
E2
f(x)dx.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

406
CHAPTER 10. INTEGRATION IN RN
Exercise 815 Suppose that E1,E2 ⊂Rn are separated by open sets, i.e., there is a disjoint pair of open sets G1 and G2
in Rn so that E1 ⊂G1 and E2 ⊂G2. Show that
Ln(E1 ∪E2) = Ln(E1)+Ln(E2).
Exercise 816 Show that
Z
E f(x)dx = 0
if and only if f(x) is equal to zero for Ln-almost every x in E.
Exercise 817 Show that
Z
E∪N f(x)dx = 0
for any set N for which Ln(N) = 0.
10.3
Measurable sets and measurable functions
For the deﬁnition of measurability we can repeat our theory from Chapter 7. We could choose to generalize to higher
dimensions by taking any one of the characterizations of Corollary 7.24 and apply it in this setting. We choose here to
take the simplest deﬁnition.
Later on in Section 10.4 we take another of the six characterizations of measurability in dimension one proved in
that corollary.
Deﬁnition 10.5 A subset E of Rn is said to be Ln-measurable if for every ε > 0
there is an open set G with Ln(G) < ε and so that E \G is closed.
With only minor changes in wording we can prove, using the methods of Chapter 7, that the usual properties of
one-dimensional Lebesgue measure are enjoyed also by Ln. Here is a fast summary.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

10.3. MEASURABLE SETS AND MEASURABLE FUNCTIONS
407
• Let E1, E2, E3, . . . be a sequence of pairwise disjoint Ln-measurable subsets of Rn and write E = S∞
i=1 Ei. Then,
for any set A ⊂Rn,
Ln(A∩E) =
∞
∑
i=1
Ln(A∩Ei).
• The class of all Ln-measurable subsets of Rn forms a Borel family that contains all closed sets and all Ln-measure
zero sets.
• If E1 ⊂E2 ⊂E3 ⊂... is an increasing sequence of subsets of Rn then
Ln
Ã ∞
[
n=1
En
!
= lim
n→∞Ln(En).
10.3.1
Measurable functions
Deﬁnition 10.6 Let E be a Ln-measurable subset of Rn and f a real-valued func-
tion deﬁned on E. Then f is said to be Ln-measurable if
{x ∈E : f(x) > r}
is a Ln-measurable subset of Rn for every real number r.
Deﬁnition 10.7 Let E be a Ln-measurable subset of Rn and f a Ln-measurable
function deﬁned on E. Then the Lebesgue integral
Z
E f(x)dx
is be deﬁned to be the value
Z
E[ f(x)]+ dx−
Z
E[ f(x)]−dx
provided that both of these are not inﬁnite. If both of these are ﬁnite then f is said
to be Lebesgue integrable on E and the integral
R
E f(x)dx has a ﬁnite value.
The key reason for this deﬁnition and for the restriction of the integration theory to measurable functions is the
following fundamental additive property.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

408
CHAPTER 10. INTEGRATION IN RN
Theorem 10.8 Let E be a Ln-measurable subset of Rn and f, g be Ln-measurable
functions deﬁned on E. Then
Z
E (f(x)+g(x)) dx =
Z
E f(x)dx+
Z
Eg(x)dx
provided that these are deﬁned. (In particular this identity is valid if both f and g
are Lebesgue integrable on E.)
Combining this additive theorem with the property of Lemma 10.2 we have immediately one of our most useful tools
in the integration theory.
Theorem 10.9 Let be a Ln-measurable subset of Rn and let f1, f2, f3, . . . be a
sequence of nonnegative real-valued functions deﬁned and Lebesgue integrable on
E. Suppose that the series
f(x) =
∞
∑
k=1
fk(x)
converges for every x ∈E. Then
Z
E f(x)dx =
∞
∑
k=1
Z
E fk(x)dx.
In particular, f is Lebesgue integrable on E if and only if the series of integrals
converges.
Exercise 818 Show that, for any simple function
f(x) =
n
∑
k=1
ckχEi(x)
where E1, E2, E3, . . . , En are Ln-measurable, that
Z
E f(x)dx =
n
∑
k=1
ckLn(E ∩Ek).
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

10.3. MEASURABLE SETS AND MEASURABLE FUNCTIONS
409
Exercise 819 Show that any nonnegative Ln-measurable function f : Rn →R can be written in the form
f(x) =
∞
∑
k=1
ckχEk(x)
for appropriate Ln-measurable sets E1, E2, E3, . . . , and that
Z
E f(x)dx =
∞
∑
k=1
ckLn(E ∩Ek).
Answer
Exercise 820 Suppose that f : Rn →R is a Ln-measurable function that is integrable on an interval I. Show that, for
every ε > 0 there is a full interval cover β of I so that if π ⊂β is a packing with J ⊂I for each (J,x) ∈π then
∑
(J,x)∈π
¯¯¯¯
Z
J f(t)dt −f(x)|J|
¯¯¯¯ < ε.
10.3.2
Notation
We have preserved the notation from the elementary calculus in the expression
Z
E f(x)dx
interpreting now x as a dummy variable representing an arbitrary point in Rn. There are other suggestive notations that
assist in some situations. For example if f : R2 →R and E is a subset of R2 then the integral may appear instead as
Z Z
E f(x1,x2)dx1dx2
or
Z Z
E f(x,y)dxdy.
The “double” integral
R R represents the fact that the dimension is two and contains a hint that an iterated integral may
be useful in its computation (see Section 10.5 below).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

410
CHAPTER 10. INTEGRATION IN RN
10.4
General measure theory
The set function
E →
Z
E f(x)dx
is deﬁned for every subset E of Rn. Such set functions play a role in many investigations and the students should be
made acquainted with the usual general theory and its techniques.
Deﬁnition 10.10 A set function M deﬁned for all subsets E of Rn is said to be a
measure on Rn provided that
1. M (/0) = 0.
2. 0 ≤M (E) ≤∞for all subsets E of Rn.
3. M (E1) ≤M (E2) if E1 ⊂E2 ⊂Rn.
4. M (S∞
k=1 Ek) ≤∑∞
k=1M (Ek) for any sequence {Ek} of subsets of Rn.
If, moreover,
M (E1 ∪E2) = M (E1)+M (E2).
whenever
inf{∥e1 −e2∥: e1 ∈E1, e2 ∈E2} > 0
then M is said to be a metric measure on Rn.
Note that Lebesgue measure Ln and the set function
M (E) =
Z
E f(x)dx
for any nonnegative function f : Rn →R are metric measures according to this deﬁnition. Many authors reserve the term
“measure” for set functions deﬁned only on special classes of sets and with stronger additive properties; they would then
prefer the term “outer measure” for the concept introduced in this deﬁnition. In your readings this should not be hard to
keep track of.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

10.5. ITERATED INTEGRALS
411
For the deﬁnition of measurability we take another one of the six characterizations of measurability in dimension
one that we presented in Corollary 7.24.
Deﬁnition 10.11 A subset E of Rn is said to be M -measurable if for every set
A ⊂Rn
M (A) = M (A∩E)+M (A\E).
We can prove that this deﬁnition of measurability, applied to the Lebesgue measure is equivalent to that we are
currently using in Deﬁnition 10.5. Using this new deﬁnition a more general theory emerges that applies to any measure
on Rn (or indeed on any suitable space equipped with a measure). Here is a fast summary.
• Let E1, E2, E3, . . . be a sequence of pairwise disjoint M -measurable subsets of Rn and write E = S∞
i=1 Ei. Then,
for any set A ⊂Rn,
M (A∩E) =
∞
∑
i=1
M (A∩Ei).
• The class of all M -measurable subsets of Rn forms a Borel family that contains all M -measure zero sets.
• If M is a metric measure then the class of all M -measurable subsets contains all closed sets.
This material is standard and should be part of the background for any advanced student. Almost all texts that
discuss outer measures will provide detailed proofs of these facts. You may wish to consult Chapters 2 and 3 of our
text Bruckner, Bruckner, and Thomson, Real Analysis, 2nd Ed., ClassicalRealAnalysis.com (2008). Those chapters are
available for free download.
10.5
Iterated integrals
In many cases the computation of a integral in a higher dimensional space can be accomplished only through a series of
one-dimensional integrations. We do not have anything that is as convenient and useful as the calculus computation
Z b
a F′(x)dx = F(b)−F(a)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

412
CHAPTER 10. INTEGRATION IN RN
that did most of the work in our ﬁrst calculus course. But if we can reduce an integral in Rn to several ordinary integrals
then the computations can be carried out.
The reader has likely seen in some elementary calculus classes the computation
Z Z
[a,b]×[c,d] f(x,y)dxdy =
Z d
c
µZ b
a f(x,y)dx
¶
dy =
Z b
a
µZ d
c f(x,y)dy
¶
dx.
Another similar, and no doubt also familiar, kind of computation appears in the form
Z Z
E f(x,y)dxdy =
Z b
a
µZ U(u)
L(u)
f(u,v)dv
¶
du
when E is the set
E = {(u,v) ∈R2 : a ≤u ≤b, L(u) ≤v ≤U(u)}.
To formulate the problem correctly we need to consider how best to state it. For example, what would we wish to
state for a three dimensional Lebesgue integral
Z Z Z
[a,b]×[c,d]×[e,f] F(x,y,z)dxdydz?
We might wish to have three iterations
Z b
a
µZ d
c
µZ f
e F(x,y,z)dz
¶
dy
¶
dx
performed in the order here as 3–2–1. But there are six possible orders in which we could iterate. We also might wish to
iterate this as
Z f
e
µZ Z
[a,b]×[c,d] F(x,y,z)dxdy
¶
dz
in the order (1×2)–3. There are three possible such orders in which this might be performed. To capture all of these it
is best to keep to a level of abstraction. This is more convenient inside the general theory of measure and integration by
using product measures. We will be a little less ambitious.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

10.5. ITERATED INTEGRALS
413
10.5.1
Formulation of the iterated integral property
Let m and n be positive integers and consider the Lebesgue integral
Z
I f(x)dx
for a function f : I →Rm+n →R where I is an interval in Rm+n. Every point x in Rm+n can be written as
x = (u,v)
(u ∈Rm, v ∈Rn)
and the interval I = A(1)×A(2) where A(1) is an interval in Rm and A(2) is an interval in Rn.
We shall ask for conditions on a function f : Rm+n →R that is integrable on the interval I = A(1)×A(2) so that
• For every1 u ∈A(1) the function
v →f(u,v)
is integrable over A(2) and
• the function
u →
Z
A(2) f(u,v)dv
is integrable on A(1), and
• the identity
Z
A(1)×A(2) f(x)dx =
Z Z
A(1)×A(2) f(u,v)dudv =
Z
A(1)
µZ
A(2) f(u,v)dv
¶
du
(10.1)
is valid.
Exercise 821 Check that formula 10.2 holds if f(x) = χI(x) where I = A(1)×A(2) is an interval in Rm+n.
Exercise 822 Check that formula 10.2 holds if f(x) is a step function on I = A(1)×A(2) assuming values c1, c2, . . . ck
on subintervals I1, I2, . . . , Ik of I.
1Here we insist on every u, but as we know we could and should sometimes ignore a set of measure zero where this fails. That will be covered
in Section 10.5.2.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

414
CHAPTER 10. INTEGRATION IN RN
Exercise 823 Check that formula 10.2 holds if f(x) is a bounded function for which there exists a sequence of step
functions S1, S2, S3, . . . on I = A(1)×A(2) such that f(x) = limk→∞Sk(x) for every x ∈I.
Answer
Exercise 824 Show that if f is a continuous function on the closed interval I then Exercise 823 can be applied to verify
the formula 10.2.
Exercise 825 Let f1, f2, and G be continuous functions on the closed interval I and deﬁne a function
f(x) =
(
f1(x)
if x ∈I and g(x) > 0,
f2(x)
if x ∈I and g(x) ≤0.
Show that Exercise 823 can be applied to verify the formula 10.2.
Answer
Exercise 826 (counterexample #1) There are a number of standard counterexamples that show some caution is needed
in applying the iterated technique to multiple integrals of unbounded functions. On the interval [−1,1] × [−1,1] in R2
deﬁne the function
f(x,y) = xy(x2 +y2)−2
f(0,0) = 0.
Examine the integrals
Z Z
[−1,1]×[−1,1] f(x,y)dxdy,
Z 1
−1
µZ 1
−1 f(x,y)dx
¶
dy,
and
Z 1
−1
µZ 1
−1 f(x,y)dy
¶
dx.
Answer
Exercise 827 (counterexample #2) On the interval [0,1]×[−1,1] in R2 deﬁne the function
f(x,y) = yx−3
if x > 0 and −x < y < x
with f(x,y) = 0 elsewhere. Examine the integrals
Z Z
[0,1]×[−1,1] f(x,y)dxdy,
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

10.5. ITERATED INTEGRALS
415
Z 1
−1
µZ 1
0 f(x,y)dx
¶
dy,
and
Z 1
0
µZ 1
−1 f(x,y)dy
¶
dx.
Answer
Exercise 828 (counterexample #3) On the interval [0,1]×[0,1] in R2 deﬁne the function
f(x,y) = 2(x−y)(x+y)−3
(x > 0, y > 0)
with f(x,y) = 0 elsewhere. Examine the integrals
Z Z
[0,1]×[0,1] f(x,y)dxdy,
Z 1
0
µZ 1
0 f(x,y)dx
¶
dy,
and
Z 1
0
µZ 1
0 f(x,y)dy
¶
dx.
Answer
Exercise 829 A “clever” student points out that all this trouble over integrals in R2 (or indeed in any dimension) can
easily be avoided by simply deﬁning double integrals as being two iterated integrals. Thus instead of proving that
Z Z
[a,b]×[c,d] f(x,y)dxdy =
Z b
a
µZ d
c f(x,y)dy
¶
dx
we just take that as a deﬁnition. Any comments?
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

416
CHAPTER 10. INTEGRATION IN RN
10.5.2
Fubini’s theorem
In the preceding section we obtained a limited version of the iterated integral property, one that applied only to bounded
functions and which required in the iteration (10.2) that the inside integral
Z
A(2) f(u,v)dv
exist for every value of u. The most general theorem, usually described as Fubini’s theorem, asserts that this iteration is
available for all integrable functions provided that we accept a set of measure zero where the inside integral might not
exist.
Here are the ingredients of that theorem.
Let m and n be positive integers and we suppose that f : Rm+n →R is a function Lebesgue integrable on an interval
I = A(1)×A(2) where A(1) is an interval in Rm and A(2) is an interval in Rn. As before every point x in Rm+n is to be
written as
x = (u,v)
(u ∈Rm, v ∈Rn).
Then
• There is a set N(1) ⊂A(1) with m-dimensional Lebesgue measure equal to zero.
• For every u ∈A(1)\N(1) the function
v →f(u,v)
is integrable over A(2) and
• the function
u →
Z
A(2) f(u,v)dv
is integrable on A(1), and
• the identity
Z
A(1)×A(2) f(x)dx =
Z Z
A(1)×A(2) f(u,v)dudv =
Z
A(1)\N(1)
µZ
A(2) f(u,v)dv
¶
du
(10.2)
is valid.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

10.6. EXPRESSION AS A STIELTJES INTEGRAL
417
This theorem is proved as Theorem 7–1, pp. 300–303 in E. J. McShane, Uniﬁed Integration, Academic Press (1983).
There is a version in Chapter 6 of R. Henstock, Lectures on the Theory of Integration, World Scientiﬁc (1988). His
version is more general (and less accessible) but uses the same deﬁning structure essentially. The reader is, however,
encouraged now to learn this theorem in the setting of general measure theory where the arguments are simpler and more
straightforward. For that there are an abundance of excellent texts. We cannot resist recommending, from among them,
Bruckner, Bruckner, and Thomson, Real Analysis, 2nd Ed., ClassicalRealAnalysis.com (2008).
10.6
Expression as a Stieltjes integral
Suppose that f : Rn →R is a Ln-measurable function that is integrable on a measurable set E. We shall show that the
Lebesgue integral
Z
E f(x)dx
can be realized as a one-dimensional Stieltjes integral. Let us ﬁx f and E for our discussion in this section and suppose
that Ln(E) < ∞. We deﬁne for each real number s the function
w(s) = Ln ({x ∈E : f(x) > s})
called the distribution function of the function f on the set E.
Then the following properties of the distribution function are easily established:
• The function w : R →[0,∞) is nonincreasing with
lim
s→∞w(s) = 0 and
lim
s→−∞w(s) = Ln(E).
• Ln ({x ∈E : a < f(x) ≤b}) = w(b)−w(a).
• w(s+) = w(s) (i.e., w is continuous on the right at each point).
• w(s−) = Ln ({x ∈E : f(x) ≥s}).
The representation theorem expresses the Lebesgue integral of f in terms of the Stieltjes integral
Z b
a sdw(s).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

418
CHAPTER 10. INTEGRATION IN RN
We know from our study of the Stieltjes integral that this must exist since w is a nonincreasing function.
Theorem 10.12 Suppose that f : Rn →R is a Ln-measurable function that is in-
tegrable on a measurable set E and that Ln(E) < ∞. Then
Z
{x∈E:a< f(x)≤b} f(x)dx =
Z b
a sdw(s)
(10.3)
and
Z
E f(x)dx =
Z ∞
−∞sdw(s).
(10.4)
There are numerous textbooks where the details of this development can be found. A most readable account appears
in pp. 76–79 of Wheeden and Zygmund, Measure and Integral, Marcel Dekker (1977).
Exercise 830 Prove the identity (10.3) in Theorem 10.12:
Z
{x∈E:a< f(x)≤b} f(x)dx =
Z b
a sdw(s).
Answer
Exercise 831 Deduce the identity (10.4) from the identity (10.3) in Theorem 10.12.
Answer
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

Chapter 11
Appendix
11.1
Glossary of terms
In this section we present a fast account of some of the language of the course. These deﬁnitions are meant to refresh
your memory or orient you in the right direction in your reading. It is still necessary to study the exact deﬁnitions and
use them to prove theorems or to solve problems.
11.1.1
absolute continuity
In Chapter 4 of the text we discuss two notions of absolute continuity. We can consider that these are similar in some
respects to the separate notions of pointwise continuity and uniform continuity.
The strongest version is due to Vitali and, accordingly, in this text we name it after him:
A function F : [a,b] →R is absolutely continuous in Vitali’s sense on [a,b] provided that for every ε > 0
there is a δ > 0 so that
n
∑
i=1
|F(xi)−F(yi)| < ε
419
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

420
CHAPTER 11. APPENDIX
whenever {[xi,yi]} are nonoverlapping subintervals of [a,b] for which
n
∑
i=1
(yi −xi) < δ.
A weaker version of absolute continuity employs the concepts of zero variation and sets of measure zero:
A function F : (a,b) →R is said to be absolutely continuous on the open interval (a,b) if F has zero
variation on every subset N of the interval that has measure zero.
In more advanced courses the weaker version is more often used rather than an ε, δ version. A measure is absolutely
continuous when it has zero value on sets of measure zero. The equivalence with the ε, δ version happens only in some
cases. Our use in Chapter 4 is completely analogous to the modern use. Classical textbooks use only the Vitali deﬁnition.
11.1.2
absolute convergence
A series ∑∞
k=1 ak is said to converge absolutely if both of the series
∞
∑
k=1
ak and
∞
∑
k=1
|ak|
converge. If ∑∞
k=1 ak converges but ∑∞
k=1 |ak| diverges we say that the series converges nonabsolutely [or conditionally
in some presentations].
The reason for the distinction is that when a series converges absolutely there is much more that one can do with
it. Nonabsolutely convergent series are rather fragile; for example you cannot rearrange the terms of the series without
possibly changing the sum.
This same language of convergent and absolutely convergent is used for inﬁnite integrals. Thus we say that the
integral
R ∞
a f(x)dx is absolutely convergent if both of the integrals
Z ∞
a
f(x)dx and
Z ∞
a | f(x)|dx
are convergent. Nonabsolutely convergent integrals are also rather fragile.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
421
11.1.3
absolute convergence test
In order to test for the convergence of a series ∑∞
k=1 ak it is often sufﬁcient just to check that the corresponding series of
absolute values
∞
∑
k=1
|ak|
converges. When the latter series converges the former series must converge.
Make sure you are familiar with the language of absolute convergence and nonabsolute convergence.
11.1.4
absolute integration
An integration method is an absolute integration method if whenever a function f is integrable on an interval [a,b] then
the absolute value | f| is also integrable there. We know that the calculus integral is not an absolute integration method
since we were able to ﬁnd an integrable function f so that | f| failed to be integrable.
The integrals of Riemann and Lebesgue are both absolute integration methods; the calculus integral and the Henstock-
Kurweil integrals are nonabsolute integration methods.
11.1.5
almost everywhere
The phrase almost everywhere means except on a set of measure zero. For example, a function is continuous almost
everywhere if the set of points where it is not continuous form a set of measure zero.
It is useful to extend this language to weaker situations:
mostly everywhere A statement holds mostly everywhere if it holds everywhere with the exception of a ﬁnite set of
points c1, c2, c3, . . . , cn.
nearly everywhere A statement holds nearly everywhere if it holds everywhere with the exception of a sequence of
points c1, c2, c3, . . . .
almost everywhere A statement holds almost everywhere if it holds everywhere with the exception of a set of measure
zero.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

422
CHAPTER 11. APPENDIX
11.1.6
Baire category theorem
See also meager.
Students carrying on to Chapter 9 will need to understand this theorem. Here is a full exposition suitable for most
courses of instruction.
Portions
If E is a closed set and (a,b) an open interval then
E ∩(a,b)
is called a portion of E provided only that E ∩(a,b) ̸= /0. It is possible that a portion could be trivial in that E ∩(a,b)
might contain only a single point of E; such a point is said to be an isolated point of E and we should be alert to the
possibility that a portion might merely contain such a point.
Baire-Osgood Theorem
Our interest is in situations where E, E1, E2, E3, . . . is a sequence of closed sets and we wish
to be assured that one of the sets En contains a portion of E. This requires a compactness argument; the nested interval
property is particularly suited to this problem.
Exercise 832 Suppose that E and E1 are nonempty closed sets and that E1 contains no portion of E. Then there must
exist a portion
E ∩(a,b)
so that E1 ∩(a,b) = /0.
Answer
Exercise 833 Suppose that E, E1, E2, . . . , En are nonempty closed sets and that
E ⊂
n[
k=1
Ek.
Show that at least one of the sets Ek must contain a portion of E.
Answer
The Baire-Osgood theorem, one of the basic tools in our analysis later on, takes this exercise and extends the result
to inﬁnite sequences of closed sets.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
423
Exercise 834 (Baire-Osgood Theorem) Suppose that E, E1, E2, . . . , En, . . . are nonempty closed sets and that
E ⊂
∞
[
k=1
Ek.
Then at least one of the sets Ek must contain a portion of E.
Answer
Exercise 835 Later on we will need this theorem without having to assume that E is closed. Show that theorem remains
true if E = T∞
j=1 G j where {Gj} is some sequence of open sets.
Answer
Exercise 836 If the closed set E is contained in a sequence of sets {En} but we cannot be assured that they are closed
sets then a simple device is to replace them by their closures. [The closure of a set E is the set E deﬁned as the smallest
closed set containing E.] If we do this show that the conclusion of the theorem would have to be, not that some set En
contains a portion of E, but that some set En is dense in a portion of E.
Language of meager/residual subsets
The exploitation of the Osgood-Baire theorem can often be clariﬁed by using
the language of meager and residual subsets. If E is a closed set1 of real numbers then a meager subset is one that
represents a “small,” insubstantial part of E; what remains after a meager subset is removed would be called a residual
subset. It would be considered a “large” subset since only an insubstantial part has been removed. Residual sets are
dense, but more than dense. A countable intersection of residual sets would still be dense.
Deﬁnition 11.1 Let E be a closed set. A subset A of E is said to be a meager
subset of E provided that there exists a sequence of closed sets {En} none of which
contains a portion of E so that
A ⊂
∞
[
n=1
En.
Deﬁnition 11.2 Let E be a closed set. A subset A of E is said to be a residual
subset of E provided that the complementary subset E \A is a meager subset of E.
1In this section the language is restricted to subsets of closed sets. In view of Exercise 835 all of this would apply equally well to subsets of Gδ
sets, that is sets that are intersections of some sequence of open sets.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

424
CHAPTER 11. APPENDIX
11.1.7
Bolzano-Weierstrass argument
While a sequence {sn} may not be convergent there are many situations in which there is a convergent subsequence {snk}.
The Bolzano-Weierstrass theorem asserts that every bounded sequence must have at least one convergent subsequence.
This is particularly easy to prove if you ﬁrst notice that all sequences have monotone subsequences.
11.1.8
bounded set
A nonempty set of real numbers is bounded if there is a real number M so that |x| ≤M for all x in the set.
More often we would split this into upper bounds and lower bounds by ﬁnding two numbers m and M so that
m ≤x ≤M
for all x in the set. If we can ﬁnd only M then we would say that the set is bounded above. If we can ﬁnd only m then we
would say that the set is bounded below.
If E is a bounded set then you should be able to ﬁnd M and m so that
m ≤x ≤M
for all x ∈E.
What are the best numbers for this inequality. It makes little sense, if we want to be precise, to take just any m and M that
happen to work. There “must be” a maximum choice for m and a minimum choice for M. Those choices are called the
inﬁmum and supremum and abbreviated as infE and supE. It is a deep property of the real numbers that such points
do exist.
Thus we write for a bounded set E,
infE ≤x ≤supE
for all x ∈E.
Note 1. If E is not bounded above then we use the symbol supE = ∞to indicate that. If E is not bounded below then
we use the symbol infE = −∞to indicate that.
Note 2.
What if E = /0 is empty? Is it bounded? Does it have a sup and inf? We usually agree that empty sets are
bounded and we commonly write the (rather mysterious) expressions sup /0 = −∞and inf /0 = ∞. Just take this as the
convention and don’t fuss too much about the meaning. If precise deﬁnitions are given then one would have to conclude
from those deﬁnitions that this convention is valid.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
425
Note 3. A sup is also called a least upper bound. An inf is also called a greatest lower bound. Note that this is
accurate: among all the upper bounds the minimum one is the sup. Similarly among all the lower bounds the maximum
one is the inf.
11.1.9
bounded function
A function f is bounded if the set of values assumed by the function is bounded, i.e., if there is a number M so that
| f(x)| ≤M for all x in the domain of the function.
11.1.10
bounded sequence
A sequence {sn} is bounded if the set of values assumed by the sequence is bounded, i.e., if there is a number M so that
|sn| ≤M for all n = 1,2,3,....
11.1.11
bounded variation
A function F : [a,b] →R is said to be of bounded variation if there is a number M so that
n
∑
i=1
|F(xi)−F(xi−1)| ≤M
for all choices of points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b.
The least such number M is called the total variation of F on [a,b] and is written V(F,[a,b]). If F is not of bounded
variation then we set V(F,[a,b]) = ∞.
11.1.12
bounded monotone sequence argument
While a bounded sequence {sn} need not converge and while a monotone sequence {sn} need not converge, if the
sequence is both bounded and monotone then it converges: either
s1 ≤s2 ≤s3 ≤s4 ≤··· ≤sn ր L
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

426
CHAPTER 11. APPENDIX
or
s1 ≥s2 ≥s3 ≥s4 ≥··· ≥sn ց L.
If the sequence is unbounded then it does not converge and, in fact, either
s1 ≤s2 ≤s3 ≤s4 ≤··· ≤sn ր ∞
or
s1 ≥s2 ≥s3 ≥s4 ≥··· ≥sn ց −∞.
11.1.13
Cantor dust
This is the Cantor set. See the material in Chapter 4 for a construction. It is the most important example of a closed
set without isolated points, that contains no interval [i.e., it is nowhere dense], that is uncountable and that is a set of
measure zero.
11.1.14
Cauchy sequences
A sequence {sn} converges to a number L if for ε > 0 there is an integer N large enough so that
|sn −L| < ε
whenever n ≥N. If we are required to prove convergence of a sequence using the deﬁnition we would need to know the
limit value L in advance and to have some intimate knowledge of how it relates to sn otherwise it will be difﬁcult to work
with the deﬁnition.
The Cauchy criterion for convergence allows us to bypass any need for the actual limit L:
A sequence {sn} converges if and only if for every ε > 0 there is an integer N large enough so that
|sn −sm| < ε
whenever n, m ≥N.
Sequences with this property are said to be Cauchy sequences. The language is a bit odd since, evidently, convergent
sequences are Cauchy sequences and Cauchy sequences are convergent sequences. The reason why the language survives
is that in other settings than the real numbers there is an important distinction between the two ideas.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
427
11.1.15
characteristic function of a set
Let E ⊂R. Then a convenient function for discussing properties of the set E is the function
χE(x) =
(
1
if x is in the set E,
0
if x is not in the set E.
Thus this function assumes only the values 0 and 1 and is deﬁned to be 1 on E and to be 0 at every other point. This is
called the characteristic function of E or, sometimes, the indicator function.
11.1.16
closed set
A set is said to be closed if the complement of that set is open. Thus, according to this deﬁnition, saying that a set F is
closed says that all points outside of F are at some distance from F.
Speciﬁcally, see the deﬁnition of open set on page 450. According to that deﬁnition, for every point x that is not in
F it is possible to ﬁnd a positive number δ(x) so that the interval
(x−δ(x),x+δ(x))
contains no point in F.
Fix a point x that is not in F. Then, not only is there some open interval that contains x and has no points belonging
to F, there is a largest such interval, say (c,d). That interval is called a component of the open set R \ F. If c [or d]
happens to be ﬁnite then that point would have to belong to F (otherwise we didn’t make (c,d) as large as possible.
Sometimes, when both c and d are ﬁnite, the interval [c,d] is said to be contiguous to F. Both endpoints c and d
belong to F but no point inside from (c,d) can belong to F.
11.1.17
compactness argument
By a compactness argument in the calculus is meant the invoking of one of the following arguments: the Cousin covering
argument, the Bolzano-Weierstrass argument or the Heine-Borel argument.
All of these are particularly adapted to handling analysis on closed, bounded sets. Since closed, bounded sets are said
to be compact these arguments are classiﬁed as compactness arguments. There are versions of compactness arguments
in many other parts of analysis.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

428
CHAPTER 11. APPENDIX
11.1.18
connected set
A set of real numbers E is disconnected if it is possible to ﬁnd two disjoint open sets G1 and G2 so that both sets contain
at least one point of E and together they include all of E. Otherwise a set is connected.
11.1.19
convergence of a sequence
A sequence {sn} converges to a number L if the sequence values sn are close to L and remain close to L for large enough
integers n. The formal deﬁnition must be stated in the usual ε, N form.
A sequence {sn} converges to a number L if for every ε > 0 there is an integer N large enough so that
|sn −L| < ε
whenever n ≥N.
11.1.20
component of an open set
A set G is an open set if every point is contained in an open interval (c,d) that is itself contained in G. Thus every point
is inside some open interval, where (if you like) it resides. In fact the set G can be show to be nothing but a collection of
such open intervals where the points “reside.” Thus either
G = /0 or
G =
n[
k=1
(ck,dk) or
G =
∞
[
k=1
(ck,dk)
where the open intervals (ck,dk) are disjoint. These intervals are called the components of G. Thus a set can have no
components [the empty set], ﬁnitely many components or a sequence of components.
The component containing a particular point x0 in G can be accurately described as the largest open interval (c,d)
that contains x0 and is contained inside G.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
429
11.1.21
composition of functions
Suppose that f and g are two functions. For some values of x it is possible that the application of the two functions one
after another
f(g(x))
has a meaning. If so this new value is denoted f ◦g(x) or (f ◦g)(x) and the function is called the composition of f and
g. The domain of f ◦g is the set of all values of x for which g(x) has a meaning and for which then also f(g(x)) has a
meaning; that is, the domain of f ◦g is
{x : x ∈dom(g) and g(x) ∈dom(f)}.
Note that the order matters here so f ◦g and g ◦f have, usually, radically different meanings. This is likely one of the
earliest appearances of an operation in elementary mathematics that is not commutative and that requires some care.
11.1.22
constant of integration
This is part of the theory of the indeﬁnite integral. The symbol
Z
f(x)dx
is meant to include all functions F whose derivative is F′(x) = f(x) on some interval. The theory says that if you are
able to ﬁnd one such function F(x) then every other such function is equivalent to F(x)+C for some constant C. Thus
we may consider that we have a formula for indeﬁnite integrals:
Z
f(x)dx = F(x)+C.
Here F(x) is any one of the many possible functions whose derivative is f(x) and C is interpreted as a completely
arbitrary constant, called the constant of integration.
11.1.23
continuous function
For beginning calculus courses the term continuity refers simply to the property
lim
x→x0 f(x) = f(x0)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

430
CHAPTER 11. APPENDIX
that a function might have at a point x0. For the purposes of this course you should study carefully the notions of
pointwise continuity and uniform continuity that appear in Chapter 1.
11.1.24
contraposition
The most common mathematical assertions that we wish to prove can be written symbolically as
P =⇒Q,
which we read aloud as “Statement P implies statement Q .” The real meaning attached to this is simply that if statement
P is true, then statement Q is true.
A moment’s reﬂection about the meaning shows that the two versions
If P is true, then Q must be true
and
If Q is false, then P must be false
are identical in meaning. These are called contrapositives of each other. Any statement
P =⇒Q
has a contrapositive
not Q =⇒
not P
that is equivalent. To prove a statement it is sometimes better not to prove it directly, but instead to prove the contrapos-
itive.
11.1.25
converse
Suppose that we have just completed, successfully, the proof of a theorem expressed symbolically as
P
=⇒Q.
A natural question is whether the converse is also true. The converse is the opposite implication
Q =⇒P.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
431
Indeed once we have proved any theorem it is nearly routine to ask if the converse is true. Many converses are false, and
a proof usually consists in looking for a counterexample.
11.1.26
countable set
That a set of real numbers is countable only means that it is possible to describe a sequence of real numbers
s1,s2,s3,...
that contains every element of the set. This deﬁnition seems harmless enough but it has profound consequences and
surprising conclusions.
11.1.27
Cousin’s partitioning argument
Suppose that [a,b] is a closed, bounded interval and at every point x of that interval we have been provided with a positive
number δ(x). Then we can manufacture a partition of the interval [a,b] using small intervals, intervals whose smallness
is measured by δ(x).
From [a,b] we are able to choose points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b
arriving at a collection of intervals
{[xi−1,xi] : i = 1,2,3,...,n}
forming a ﬁnite number of nonoverlapping intervals whose union is the whole interval [a,b] in such a way that we can
associate some appropriate point ξi to each of these intervals [xi−1,xi].
We can do this in such a way that the collection
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
satisﬁes the requirement that
xi −xi−1 < δ(ξi).
To use the argument, just state this:
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

432
CHAPTER 11. APPENDIX
Let δ(x) > 0 for each a ≤x ≤b. Then there must exist a partition
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
of the whole interval [a,b] such that
ξi ∈[xi−1,xi] and xi −xi−1 < δ(ξi).
The argument will prove useful when you need to take a local property [here expressed by δ(x) > 0] and deduce a
global property [here expressed by the partition of the interval].
11.1.28
Cousin’s covering argument
Cousin’s partitioning argument was expressed in the language of local smallness, i.e., at each point x of an interval
[a,b] we were provided with a small, positive number δ(x). Using that we could construct a partition
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
of the interval [a,b] with each interval [xi−1,xi] having length smaller than δ(ξi).
We can translate this into the language of covering relations and gain some ﬂexibility as well as prepare us for
deeper covering arguments. The collection of interval-point pairs
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
is an example of a covering relation. A relation because there is an association between the interval [xi−1,xi] and the
corresponding points ξi; a covering because the points are invariably inside the interval. We say any collection C at all
is covering relation if it contains only pairs ([x,y],ξ) where [x,y] is a closed, bounded interval and ξ is a point in [x,y].
The following two statements translate the Cousin lemma into a covering argument.
A covering relation C is said to be a full cover of a set E if for every ξ ∈E there is a δ > 0 so that
([x,y],ξ) ∈C for all 0 < y−x < δ.
If C is a full cover of a closed, bounded interval [a,b] then there exists a partition
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
of the whole interval [a,b] that is a subset of C.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
433
In many instances a covering argument is preferable to an argument that uses a small δ(x) at each point. Construct
the cover C. Check the full property at each point. Deduce the existence of a partition that can be extracted from the
cover.
11.1.29
Darboux property
The Darboux property (also known as the intermediate value property) is the assertion that a function deﬁned on an
interval I has the property that, whenever x and y are points in I and c is any number between f(x) and f(y) there must
be at least one point ξ between x and y where f(ξ) = c.
In particular note that such a function has this property: if there are points where f is positive and points where f is
negative, then in between these points the function has a zero.
11.1.30
deﬁnite integral
In this text the deﬁnite integral of a function f on a closed, bounded interval is a number deﬁned as
Z b
a f(x)dx = F(b)−F(a)
where F is a suitably chosen antiderivative of f. There are a number of possible interpretations of this statement.
11.1.31
De Morgan’s Laws
Many manipulations of sets require two or more operations to be performed together. The simplest cases that should
perhaps be memorized are
A\(B1 ∪B2) = (A\B1)∩(A\B2)
and a symmetrical version
A\(B1 ∩B2) = (A\B1)∪(A\B2).
If you sketch some pictures these two rules become evident.
There is nothing special that requires these “laws” to be
restricted to two sets B1 and B2. Indeed any family of sets {Bi : i ∈I} taken over any indexing set I must obey the same
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

434
CHAPTER 11. APPENDIX
laws:
A\
Ã
[
i∈I
Bi
!
=
\
i∈I
(A\Bi)
and
A\
Ã
\
i∈I
Bi
!
=
[
i∈I
(A\Bi).
Here S
i∈I Bi is just the set formed by combining all the elements of the sets Bi into one big set (i.e., forming a large
union). Similarly, T
i∈I Bi is the set of points that are in all of the sets Bi, that is, their common intersection.
11.1.32
dense
A set of real numbers E is dense in an interval I if every subinterval of I contains a point of the set E. The most familiar
example is the set of all rational numbers which is dense in (−∞,∞) because every interval (c,d) contains a rational
number.
11.1.33
derivative
For elementary calculus courses the term derivative refers simply to the computation
lim
x→x0
F(x)−F(x0)
x−x0
= F′(x0)
that is possible for many functions at a point x0. Those functions are said to be differentiable.
You will need a rather broad understanding of derivatives in order to proceed to study the calculus integral. All the
necessary background material is reviewed in Chapter 1.
11.1.34
Devil’s staircase
This is the name often given to the Cantor function. There is a full account of the Cantor function in Chapter 4.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
435
11.1.35
domain of a function
The set of points at which a function is deﬁned is called the domain of the function. It is an essential ingredient of the
deﬁnition of any function. It should be considered incorrect to write
Let the function f be deﬁned by f(x) = √x.
Instead we should say
Let the function f be deﬁned with domain [0,∞) by f(x) = √x.
The ﬁrst assertion is sloppy; it requires you to guess at the domain of the function. Calculus courses, however, often
make this requirement, leaving it to you to ﬁgure out from a formula what domain should be assigned to the function.
Often we, too, will require that you do this.
11.1.36
empty set
We use /0 to represent the set that contains no elements, the empty set.
11.1.37
equivalence relation
A relation x ∼y on a set S is said to be an equivalence relation if
1. x ∼x for all x ∈S.
2. x ∼y implies that y ∼x.
3. x ∼y and y ∼z imply that x ∼z.
11.1.38
graph of a function
If f is a real function deﬁned on an interval [a,b] then the set of ordered pairs
{(x,y) : a ≤x ≤b, y = f(x)}
is called the graph of the function. In many presentations the graph is considered to be the function since there is
nothing about the function that is not completely described by presenting its graph. In calculus courses one usually
makes a distinction between a function and its graph, even though such a distinction is not particularly real.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

436
CHAPTER 11. APPENDIX
11.1.39
partition
If [a,b] is a closed bounded interval and we choose points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b
then the collection of intervals
{[xi−1,xi] : i = 1,2,3,...,n}
forms a ﬁnite collection of nonoverlapping intervals whose union is the whole interval [a,b]. Many authors call this
collection a partition.
When working with Riemann sums [as we do very frequently] one must associate some point ξi to each of these
intervals [xi−1,xi]. Thus, for us a partition is actually the collection
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
of interval-point pairs with the associated point as the second entry in the pair ([xi−1,xi],ξi).
11.1.40
Henstock-Kurzweil integral
In this course we address several theories of integration. They are
1. The Riemann integral.
2. The calculus integral [ﬁnite exceptional set case].
3. The calculus integral [countable exceptional set case].
4. The calculus integral [measure zero exceptional set case].
5. The Lebesgue integral.
6. The Henstock-Kurzweil integral.
The ﬁrst three of these should be considered teaching integrals, designed to introduce beginning students to the
theory of integration on the real line. Chapters 2 and 3 concern the calculus integral [ﬁnite exceptional set case]. The
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
437
fourth integral in the list here appears in Chapter 4. That integral includes all the others. In fact that integral, deﬁned as
a calculus integral, is equivalent to the Henstock-Kurzweil integral and includes Lebesgue’s integral.
Later on, in Part Two, we will develop the full program of Lebesgue which addresses methods of constructing the
integral based on measure theory and we will investigate the Henstock-Kurzweil integral in greater detail.
11.1.41
indeﬁnite integral
Our indeﬁnite integrals are all deﬁned on an open interval and require that that open interval be speciﬁed. The most
severe deﬁnition would be:
Let f be a function deﬁned on an open interval I. Then a function F : I →R is said to be an indeﬁnite
integral of f on I if F′(x) = f(x) at every point x in I.
This is the deﬁnition taken in most calculus texts (although they are usually pretty sloppy about the interval I). For
this text we take a more general deﬁnition:
Let f be a function deﬁned on an open interval I except possibly at ﬁnitely many points. Then a pointwise
continuous function F : I →R is said to be an indeﬁnite integral of f on I if F′(x) = f(x) at every point x
in I with possibly ﬁnitely many exceptions.
An indeﬁnite integral, in either sense, is unique up to an additive constant. Thus by writing
Z
f(x)dx = F(x)+C on the interval I
we capture all possible indeﬁnite integrals. The number C is intended to be completely arbitrary and is called the
constant of integration.
11.1.42
indirect proof
Many proofs in analysis are achieved as indirect proofs. This refers to a speciﬁc method.
The method argues as follows. I wish to prove a statement P is true. Either P is true or else P is false, not both. If
I suppose P is false perhaps I can prove that then something entirely unbelievable must be true. Since that unbelievable
something is not true, it follows that it cannot be the case that P is false. Therefore, P is true.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

438
CHAPTER 11. APPENDIX
The pattern of all indirect proofs (also known as proofs by contradiction) follows this structure: We wish to prove
statement P is true. Suppose, in order to obtain a contradiction, that P is false. This would imply the following
statements. (Statements follow.) But this is impossible. It follows that P is true as we were required to prove.
11.1.43
infs and sups
See bounded set on page 424.
11.1.44
integers
The integers (positive integers, negative integers, and zero). This includes the natural numbers (positive integers) 1, 2, 3,
4, .. . , the negative integers −1, −2, −3, −4, . . . , and zero.
11.1.45
integral test for series
Consider an integer N and a nonnegative, monotone decreasing function f deﬁned on the unbounded interval [N,∞) and
that is assumed to be integrable on any closed, bounded subinterval.
Then the inequality
Z ∞
N f(x)dx ≤
∞
∑
n=N
f(n) ≤f(N)+
Z ∞
N f(x)dx
is called the integral test for series, comparing an inﬁnite integral with a series. Thus the series ∑∞
n=N f(n) converges if
and only if the integral
Z ∞
N f(x)dx
is ﬁnite. In particular, if the integral diverges, then the series diverges as well. Since f is a monotone decreasing function,
we know that
f(x) ≤f(n)
for x ∈[n,∞)
and
f(n) ≤f(x)
for x ∈[N,n],
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
439
hence for every n > N
Z n+1
n
f(x)dx ≤
Z n+1
n
f(n)dx = f(n) =
Z n
n−1 f(n)dx ≤
Z n
n−1 f(x)dx.
Since the lower estimate is also valid for f(N), we get by summation
Z M+1
N
f(x)dx ≤
M
∑
n=N
f(n) ≤f(N)+
Z M
N
f(x)dx.
Let M →∞,
Z ∞
N f(x)dx ≤
∞
∑
n=N
f(n) ≤f(N)+
Z ∞
N f(x)dx.
11.1.46
intermediate value property
The intermediate value property (also known as the Darboux property) is the assertion that a function deﬁned on an
interval I has the property that, whenever x and y are points in I and c is any number between f(x) and f(y) there must
be at least one point ξ between x and y where f(ξ) = c.
In particular note that such a function has this property: if there are points where f is positive and points where f is
negative, then in between these points the function has a zero.
11.1.47
interval
See Section 1.2 on page 2 for a full list.
11.1.48
least upper bound argument
If a set E of real numbers is nonempty and bounded then it is possible to ﬁnd numbers M and m so that
m ≤x ≤M
for all x in the set. It is a basic principle in the study of the real numbers that there is a best choice for m and M. That is
to say there is a minimum choice for M and a maximum choice for m. We call M the least upper bound of E and write
it as supE. We call M the greatest lower bound of E and write it as infE.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

440
CHAPTER 11. APPENDIX
A least upper bound argument is simply an argument that invokes this principle. To obtain your proof, construct a
set E, show E is bounded and nonempty, and then claim that there is a number M = supE. Such a number has two key
properties:
1. x ≤M for all x ∈E.
2. if t < M then x > t for some x ∈E.
11.1.49
induction
This method may be used to try to prove any statement about an integer n. Here are the steps:
Step 1 Verify the statement for n = 1.
Step 2 (The induction step) Show that whenever the statement is true for any positive integer m it is necessarily also
true for the next integer m+1.
Step 3 Claim that the formula holds for all n by the principle of induction.
11.1.50
inverse of a function
Some functions allow an inverse. If f : A →B is a function, there is, sometimes, a function f −1 : B →A that is the
reverse of f in the sense that
f −1(f(a)) = a for every a ∈A
and
f(f −1(b)) = b for every b ∈B.
Thus f carries a to f(a) and f −1 carries f(a) back to a while f −1 carries b to f −1(b) and f carries f −1(b) back to b.
This can happen only if f is one-to-one and onto B.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
441
11.1.51
isolated point
A point x0 in a set E is isolated if there is an open interval (a,b) that contains the point x0 but contains no other point of
E, i.e.,
E ∩(a,b) = {x0}.
All points of a ﬁnite set are isolated. A countable set may or may not have an isolated point. (Intervals, of course, have
no isolated points.)
A set is perfect if it is nonempty, closed, and contains no isolated points.
11.1.52
Jordan decomposition
Every function F of bounded variation on an interval [a,b] can be written as the difference of two monotonic, nonde-
creasing functions:
F(x) = G(x)−H(x).
The natural way to do this is to write
F(x) =
µ
V(F,[a,x])+ F(x)
2
¶
−
µ
V(F,[a,x])−F(x)
2
¶
in which case this expression is called the Jordan decomposition. This is part of the study of functions of bounded
variation that appears in Chapter 3.
11.1.53
Lebesgue integral
In this course we address several theories of integration. They are
1. The Riemann integral.
2. The calculus integral [ﬁnite exceptional set case].
3. The calculus integral [countable exceptional set case].
4. The calculus integral [measure zero exceptional set case].
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

442
CHAPTER 11. APPENDIX
5. The Lebesgue integral.
6. The Henstock-Kurzweil integral.
The ﬁrst three of these should be considered teaching integrals, designed to introduce beginning students to the theory
of integration on the real line. Chapters 2 and 3 concern the calculus integral [ﬁnite exceptional set case]. The extensions
to the countable exceptional set case and, ﬁnally, to the measure zero exceptional set case appear in Chapter 4. The
Lebesgue integral, which is considered rather too difﬁcult for a teaching integral, appears in Chapter 4 and is included in
the theory there. In the presentation here Lebesgue’s integral appears as a natural generalization of the calculus integral.
Later on, in Part Two, we will develop the full program of Lebesgue which addresses methods of constructing the
integral based on measure theory. If you proceed no further than Chapter 4 you have indeed learned the Lebesgue integral
and seen some of its properties, but you have missed the interesting trip through measure theory that a full account of
Lebesgue’s methods will explore.
11.1.54
limit of a function
The limit of a function is deﬁned entirely and simply by εs and δs. Prior to the reworking of the foundations of the
calculus by Cauchy around 1820 this idea was considered powerful but mysterious.
By the statement
lim
x→c f(x) = L
we mean that for any ε > 0 there is an open interval (c−δ,c+δ) so that all values of f(x) for x in that interval (except
possibly for x = c) are between L+ε and L−ε.
The more formal presentation is this:
Let f be deﬁned at least on the set (a,c)∪(c,b) for some a < c < b. Then
lim
x→c f(x) = L
if, for any ε > 0, there is an δ > 0 so that
L−ε < f(x) < L+ε
if
c < x < c+δ or c−δ < x < c.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
443
Notice that the deﬁnition carefully excludes the value of f(c) from inﬂuencing the statement. Thus f(c) could be
any value at all or may not even be deﬁned. Also notice that a feature of the limit deﬁnition is that it is two-sided. The
function must be deﬁned on open intervals on either side of the point c, and those values will inﬂuence the existence of
the limit.
One-sided limits just copy this deﬁnition with the obvious changes:
Let f be deﬁned at least on the set (c,b) for some c < b. Then
f(c+) = lim
x→c+ f(x) = L
if, for any ε > 0, there is an δ > 0 so that
L−ε < f(x) < L+ε
if c < x < c+δ.
and
Let f be deﬁned at least on the set (a,c) for some a < c. Then
f(c−) = lim
x→c−f(x) = L
if, for any ε > 0, there is an δ > 0 so that
L−ε < f(x) < L+ε
if c−δ < x < c.
In working with limits it will be very convenient to have access to sequence methods. Here is the two-sided version;
one-sided versions are similar.
Let f be deﬁned at least on the set (a,c)∪(c,b) for some a < c < b. Then
lim
x→c f(x) = L
if and only if
lim
n→∞f(xn) = L
for every sequence {xn} of points from (a,c)∪(c,b) that converges to c.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

444
CHAPTER 11. APPENDIX
These methods allow us to apply the powerful methods of Cauchy sequences, Bolzano-Weierstrass property or monotone
sequence arguments in discussions of limits.
11.1.55
linear combination
If f(x) and g(x) are functions and r and s are real numbers then the function
h(x) = r f(x)+s(g(x)
is said to be a linear combination of the two functions f and g. The same phrase would be used for any ﬁnite number
of functions, not just two.
11.1.56
Lipschitz function
If a function F deﬁned on an interval I has this property for some number C,
|F(x)−F(y)| ≤C|x−y| for all x, y ∈I,
then F is said to be a Lipschitz function. Such functions arise all the time in the study of derivatives and integrals.
If you are able to determine the smallest number C with this property then that number is called the Lipschitz
constant for the function F on the interval I.
11.1.57
locally bounded function
A function f deﬁned on an open interval is said to be locally bounded at a point x0 in that interval is there is at least one
interval (c,d) contained in I and containing x0 such that f is bounded on (c,d). This is the same as saying that, for some
positive number δ, the function is bounded on (x0 −δ,x0 +δ).
11.1.58
lower bound of a set
See bounded set on page 424.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
445
11.1.59
managing epsilons
The student should have had some familiarity with ε, δ proofs prior to taking on this course. Certainly the notions of
continuity, limits, and derivatives in an earlier course will have prepared the rudiments.
In such arguments here we frequently have several steps or many steps. With two steps the student is by now
accustomed to splitting ε into two pieces
ε = ε
2 + ε
2.
Then the argument needed to show something is smaller than ε breaks into showing the two separate pieces are smaller
than ε
2.
It is only moderately more difﬁculty to handle inﬁnitely many pieces in a proof. In the calculus as presented in these
notes we frequently have to handle some condition described by an inﬁnite sequence of steps. For that a very simple
device is available, similar to splitting the ε into two or three or more pieces:
ε = ε
2 + ε
4 + ε
8 + ε
16 +···+ ε
2n +....
It would be reasonable to use this computation even prior to any study of sequences and series. In fact, however, an
inﬁnite series can be avoided in all the proofs anyway since all sums are ﬁnite. Thus the student never needs anything
beyond the inequality
ε
2 + ε
4 + ε
8 + ε
16 +···+ ε
2n < ε.
This can be proved with elementary algebra.
11.1.60
meager
A set of real numbers is countable if it can be expressed as a countable union of a sequence of ﬁnite sets. If I is an
interval and E is a countable set then I \E is dense in I.
This generalizes to meager sets. A of real numbers is meager if it can be expressed as a countable union of a sequence
of nowhere dense sets. If I is an interval and E is a meager set then I \E is dense in I. The proof for meager sets and for
countable sets is exactly the same, using the nested interval argument. For example: if En is a sequence of nowhere dense
sets [ﬁnite sets] inside an interval I, then take any subinterval (c,d) ⊂I. There must be a nested sequence of intervals
with [cn,dn] ⊂I and [cn,dn]∩En = /0. There is a point that belongs to all of the intervals and that point fails to belong to
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

446
CHAPTER 11. APPENDIX
E = S∞
n=1 En. This shows that I \E is dense in I.
The complement of the meager set E is said to be residual in I. Residual sets are dense as we have just seen. This is
usually described as the Baire category theorem.
See also Baire category theorem.
11.1.61
mean-value theorem
In the differential calculus the mean-value theorem is the assertion that
F(b)−F(a)
b−a
= F′(ξ)
at some point ξ between a and b. The most economical assumptions are that F is uniformly continuous on [a,b] and
differentiable on (a,b).
The corresponding assertion for the integral is also called the mean-value theorem,
1
b−a
Z b
a F′(x)dx = F′(ξ),
and has the same assumptions and is the same statement expressed in different language.
11.1.62
measure zero
There are a number of deﬁnitions possible and, ultimately, we would need to check that they are equivalent. The
deﬁnition that we use in Section 4.3 is stated in terms of Riemann sums over subpartitions and a small measurement δ(x)
at each point of the measure zero set.
A set of real numbers N is said to be a set of measure zero if for every ε > 0 and every point ξ ∈N there is
a δ(ξ) > 0 with the following property: whenever a subpartition
{[ci,di],ξi) : i = 1,2,...,n}
is given with each ξi ∈N and so that
0 < di −ci < δ(ξi) (i = 1,2,...,n)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
447
then
n
∑
i=1
(di −ci) < ε.
An equivalent deﬁnition might be more familiar to some readers since other textbooks are likely to start here:
A set of real numbers N is said to be a set of measure zero if for every ε > 0 it is possible to ﬁnd a
sequence of open intervals {(ck,dk)} so that every point in N appears in at least one of the intervals and
∑∞
k=1(dk −ck) < ε.
11.1.63
monotone subsequence argument
While a sequence {sn} need not be monotone it always possesses at least one monotonic subsequence: either
sn1 ≤sn2 ≤sn3 ≤sn4 ≤...
or
sn1 ≥sn2 ≥sn3 ≥sn4 ≥....
In particular if the original sequence is bounded then there is a monotonic subsequence that converges.
11.1.64
mostly everywhere
The phrase almost everywhere is in common use in all advanced analysis; it means except on a set of measure zero.
It is useful to extend this language to weaker situations. For this course especially, we have made frequent use of
ﬁnite exceptional sets or countable exceptional sets. Nearly everywhere is common usage, but it is not universal. Mostly
everywhere is peculiar to us and we don’t use it, but we do recommend it would be useful in classroom discussions.
mostly everywhere A statement holds mostly everywhere if it holds everywhere with the possible exception of a ﬁnite
set of points c1, c2, c3, . . . , cn.
nearly everywhere A statement holds nearly everywhere if it holds everywhere with the possible exception of a se-
quence of points c1, c2, c3, . . . .
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

448
CHAPTER 11. APPENDIX
almost everywhere A statement holds almost everywhere if it holds everywhere with the possible exception of a set of
measure zero.
11.1.65
natural numbers
The natural numbers (positive integers): 1, 2, 3, 4, . . . .
11.1.66
nearly everywhere
The phrase almost everywhere is in common use in all advanced analysis; it means except on a set of measure zero.
Nearly everywhere is often used to indicate except on a countable set. Mostly everywhere is just a suggestion. We don’t
use it in the text, but we do recommend it would be useful in classroom discussions.
mostly everywhere A statement holds mostly everywhere if it holds everywhere with the possible exception of a ﬁnite
set of points c1, c2, c3, . . . , cn.
nearly everywhere A statement holds nearly everywhere if it holds everywhere with the possible exception of a se-
quence of points c1, c2, c3, . . . .
almost everywhere A statement holds almost everywhere if it holds everywhere with the possible exception of a set of
measure zero.
11.1.67
negations of quantiﬁed statements
Here is a tip that helps in forming negatives of assertions involving quantiﬁers. The two quantiﬁers ∀and ∃are com-
plementary in a certain sense. The negation of the statement “All birds ﬂy” would be (in conventional language) “Some
bird does not ﬂy.” More formally, the negation of
For all birds b, b ﬂies
would be
There exists a bird b, b does not ﬂy.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
449
In symbols let B be the set of all birds. Then the form here is
∀b ∈B “statement about b” is true
and the negation of this is
∃b ∈B “statement about b” is not true.
This allows a simple device for forming negatives. The negation of a statement with ∀is a statement with ∃replacing it,
and the negation of a statement with ∃is a statement with ∀replacing it.
11.1.68
nested interval argument
The nested interval argument is a way of ﬁnding a point with a particular desirable property. We ﬁrst construct intervals
that we are sure will contain the point we want and then shrink down to the point.
Nested interval argument: If [a1,b1] ⊃[a2,b2] ⊃[a3,b3]... is a shrinking sequence of closed, bounded
intervals with lengths decreasing to zero,
lim
n→∞(bn −an) = 0
then there is a unique point z that belongs to each of the intervals.
Note that the argument requires the intervals are both closed and bounded. The examples
(0,1), (1, 1
2), (0, 1
3), (0, 1
4), ...
and
[1,∞), [2,∞), [3,∞), [4,∞), ...
do not have any point in the intersection.
11.1.69
nowhere dense
A set of real numbers E is nowhere dense in an interval [a,b] if for every subinterval [c,d] ⊂[a,b] it is possible to ﬁnd a
further subinterval [c1,d1] ⊂[c,d] that contains no points of the set E. It is easy to check that a closed set of real numbers
E is nowhere dense in an interval [a,b] it is contains no subinterval of [a,b].
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

450
CHAPTER 11. APPENDIX
Apart from ﬁnite sets, some countable sets, and the Cantor set we have not seen many nowhere dense sets in the text.
Dense and nowhere dense are not exact opposites, but instead extreme opposites: a dense set appears in every
subinterval and a nowhere dense set makes no appearance in most subintervals.
11.1.70
open set
The notion of an open set is built up by using the idea of an open interval. A set G is said to be open if for every point
x ∈G it is possible to ﬁnd an open interval (c,d) that contains the point x and is itself contained entirely inside the set G.
It is possible to give an ε, δ type of deﬁnition for open set. (In this case just the δ is required.) A set G is open if for
each point x ∈G it is possible to ﬁnd a positive number δ(x) so that
(x−δ(x),x+δ(x)) ⊂G.
Fix a point x ∈G. Then, not only is there some open interval that contains x and is contained in G, there is a largest
such interval. That interval is called a component of G.
See also component of an open set on page 428.
11.1.71
one-to-one and onto function
If to each element b in the range of f there is precisely one element a in the domain so that f(a) = b, then f is said to be
one-to-one or injective. We sometimes say, about the range f(A) of a function, that f maps A onto f(A). If f : A →B,
then f would be said to be onto B if B is the range of f, that is, if for every b ∈B there is some a ∈A so that f(a) = b.
A function that is onto is sometimes said to be surjective. A function that is both one-to-one and onto is sometimes said
to be bijective.
11.1.72
ordered pairs
Given two sets A and B, we often need to discuss pairs of objects (a,b) with a ∈A and b ∈B. The ﬁrst item of the pair
is from the ﬁrst set and the second item from the second. Since order matters here these are called ordered pairs. The
set of all ordered pairs (a,b) with a ∈A and b ∈B is denoted
A×B
and this set is called the Cartesian product of A and B.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
451
11.1.73
oscillation of a function
Let f be a function deﬁned at least on an interval [c,d]. We write
ω f([c,d]) = sup{| f(x)−f(y)| : c ≤y < x ≤d.}
The number ω f([c,d]) is called the oscillation of the function f on the interval [c,d].
11.1.74
partition
If [a,b] is a closed bounded interval and we choose points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b
then the collection of intervals
{[xi−1,xi] : i = 1,2,3,...,n}
forms a ﬁnite collection of nonoverlapping intervals whose union is the whole interval [a,b].
When working with Riemann sums [as we do very frequently] one must associate some point ξi to each of these
intervals [xi−1,xi]. Thus, for us a partition is actually the collection
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
of interval-point pairs with the associated point as the second entry in the pair ([xi−1,xi],ξi).
If f is a function deﬁned at points of [a,b] the sum
n
∑
i=1
f(ξi)(xi −xi)
is called a Riemann sum for the function and the partition.
But we also consider sums of the following form, loosely, as Riemann sums:
n
∑
i=1
| f(ξi)|(xi −xi−1)
n
∑
i=1
|F(xi −F(xi−1)|
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

452
CHAPTER 11. APPENDIX
n
∑
i=1
|[F(xi −F(xi−1)]−f(ξi)(xi −xi)|
and we continue to call these Riemann sums even if we use only part of the partition in the sum (i.e., a subpartition).
11.1.75
perfect set
A set is perfect if it is nonempty, closed, and contains no isolated points.
A point x0 in a set E is isolated if there is an open interval (a,b) that contains the point x0 but contains no other point
of E, i.e.,
E ∩(a,b) = {x0}.
All points of a ﬁnite set are isolated. A countable set may or may not have an isolated point. (Intervals, of course, have
no isolated points.)
11.1.76
pointwise continuous function
Make sure to distinguish between pointwise continuous and uniform continuous.
What in this text is called “pointwise” continuous is usually simply called continuous. We are using this as a teaching
device to emphasize as much as possible the subtle and important distinction between uniform continuity and the local
version that is deﬁned in a pointwise manner. The instructor should, no doubt, apologize to the students and ask them
to strike the nonstandard word “pointwise” from all such occurrences. But this pointwise/uniform distinction will occur
again in the text anyway in situations where the language is standard.
Let f : I →R be a function deﬁned on an interval I. We say that f is uniformly continuous if for every
ε > 0 there is a δ > 0 so that
| f(d)−f(c)| < ε
whenever c, d are points in I for which |d −c| < δ.
and
Let f : I →R be a function deﬁned on an open interval I and let x0 be a point in that interval. We say that f
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
453
is pointwise continuous at x0 if for every ε > 0 there is a δ > 0 so that
| f(x)−f(x0)| < ε
whenever x is a point in I for which |x−x0| < δ.
11.1.77
preimage of a function
If f : X →Y and E ⊂Y, then
f −1(E) = {x : f(x) = y for some y ∈E } ⊂X
is called the preimage of E under f. [There may or may not be an inverse function here; f −1(E) has a meaning even if
there is no inverse function.]
11.1.78
quantiﬁers
We often encounter two phrases used repeatedly:
For all ... it is true that ...
and
There exists a ... so that it is true that . . .
For example, the formula
(x+1)2 = x2 +2x+1
is true for all real numbers x. There is a real number x such that
x2 +2x+1 = 0
(indeed x = −1).
It is extremely useful to have a symbolic way of writing this. It is universal for mathematicians of all languages to
use the symbol ∀to indicate “for all” or “for every” and to use ∃to indicate “there exists.” Originally these were chosen
since it was easy enough for typesetters to turn the characters “A” and “E” around or upside down. These are called
quantiﬁers.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

454
CHAPTER 11. APPENDIX
11.1.79
range of a function
The set of points B in the deﬁnition of a function
f : D →B
is sometimes called the range or co-domain of the function. Most writers do not like the term “range” for this and prefer
to use the term range for the set
f(A) = { f(x) : x ∈A} ⊂B
that consists of the actual output values of the function f, not some larger set that merely contains all these values.
11.1.80
rational numbers
The rational numbers, are all the fractions m/n where m and n are integers (and n ̸= 0). The rational numbers can
also be described by inﬁnite decimal expansions: they are precisely those expansions which are either repeating or
terminating.
In a proper course of instruction on the real numbers it would be veriﬁed that all real numbers have a representation
as an inﬁnite decimal expansion and, conversely, that an inﬁnite decimal expansion does represent some real number.
In our course we are taking it for granted that the student has seen an adequate presentation of the real numbers
and can sort out, from the minimal description given here, which numbers are rational and which are not (irrational) in
simple situations.
11.1.81
real numbers
We use the symbol R to denote the set of all the real numbers. We have also agreed to interpret the set of real numbers
in the language of intervals as the set (−∞,∞).
There is insufﬁcient space in this short glossary to deﬁne exactly what the real numbers are. From a practical point
of view the student needs mainly to understand how to do simple algebra, work with inequalities and manage the use of
the supremum and inﬁmum (sup and inf).
Our textbook
[TBB] Elementary Real Analysis, 2nd Edition, B. S. Thomson, J. B. Bruckner, A. M. Bruckner, Classical-
RealAnalyis.com (2008).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
455
starts with a chapter on this (which you can download for free). At some point in your career it would be of great beneﬁt
to see a constructive presentation of the real numbers.
11.1.82
relations
Often in mathematics we need to deﬁne a relation on a set S. Elements of S could be related by sharing some common
feature or could be related by a fact of one being “larger” than another. For example, the statement A ⊂B is a relation
on families of sets and a < b a relation on a set of numbers. Fractions of integers p/q and a/b are related if they deﬁne
the same number; thus we could deﬁne a relation on the collection of all fractions by p/q ∼a/b if pb = qa.
A relation R on a set S then would be some way of deciding whether the statement xRy (read as x is related to y) is
true. If we look closely at the form of this we see it is completely described by constructing the set
R = {(x,y) : x is related to y}
of ordered pairs. Thus a relation on a set is not a new concept: It is merely a collection of ordered pairs. Let R be any set
of ordered pairs of elements of S. Then (x,y) ∈R and xRy and “x is related to y” can be given the same meaning. This
reduces relations to ordered pairs. In practice we usually view the relation from whatever perspective is most intuitive.
[For example, the order relation on the real line x < y is technically the same as the set of ordered pairs {(x,y) : x < y}
but hardly anyone thinks about the relation this way.]
11.1.83
residual
See meager.
11.1.84
Riemann sum
For us a partition of an interval [a,b] is a collection
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

456
CHAPTER 11. APPENDIX
of interval-point pairs with the intervals nonoverlapping and having union all of [a,b]. A subpartition is just a subset of
a partition We refer to all of the following sums as Riemann sums over either a partition or subpartition.
n
∑
i=1
(xi −xi−1),
n
∑
i=1
f(ξi)(xi −xi−1),
n
∑
i=1
| f(ξi)|(xi −xi−1),
n
∑
i=1
|F(xi −F(xi−1)|,
n
∑
i=1
|[F(xi −F(xi−1)]−f(ξi)(xi −xi)|,
n
∑
i=1
f(ξi)[G(xi)−G(xi−1)].
11.1.85
Riemann integral
In this course we address several theories of integration. They are
1. The Riemann integral.
2. The calculus integral [ﬁnite exceptional set case].
3. The calculus integral [countable exceptional set case].
4. The calculus integral [measure zero exceptional set case].
5. The Lebesgue integral.
6. The Henstock-Kurzweil integral.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
457
The ﬁrst three of these should be considered teaching integrals, designed to introduce beginning students to the
theory of integration on the real line. Chapters 2 and 3 concern the calculus integral [ﬁnite exceptional set case]. The
Riemann integral, which is another candidate for a teaching integral, is merely mentioned in Chapter 4 although various
themes associated with that integral (notably uniform approximation by Riemann sums) appear frequently in the text.
The Riemann integral is of limited use as a teaching integral. If one spends very little time with it and uses it as a
platform for a fast launch of integration theories based on pointwise approximation by Riemann sums, then (possibly) it
could be justiﬁed as a teaching tool.
11.1.86
series
An inﬁnite sum
a1 +a2 +a3 +···+an +...
is called a series. The usual notation is
∞
∑
k=1
ak = a1 +a2 +a3 +....
The sum of the series is the limit, if it exists, of the sequence of partial sums,
lim
n→∞
n
∑
k=1
ak = lim
n→∞(a1 +a2 +a3 +···+an).
Series are sometimes called inﬁnite series, but for mathematicians the term series always means an inﬁnite sum and
the word series is not used for ﬁnite sequences or ﬁnite lists as the common dictionary deﬁnition would suggest.
A series is convergent if the sum exists, i.e., the limit
lim
n→∞
n
∑
k=1
ak
exists (and has a ﬁnite value). It is said to be divergent otherwise.
If both series
∞
∑
k=1
ak and
∞
∑
k=1
|ak|
converge then the series is said to be absolutely convergent. It is possible for a series to be convergent but not absolutely
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

458
CHAPTER 11. APPENDIX
convergent; such series are said to be nonabsolutely convergent.
If the terms of a series are summed in a different order, e.g.,
a2 +a1 +a5 ++a4 +a15 +···+
the new series is called a rearrangement. If all rearrangements of a series converge then the series is said to be
unconditionally convergent. If the series converges but has a divergent rearrangement then the series is said to be
conditionally convergent. It is a theorem in the study of series that absolute convergence and unconditional convergence
are equivalent.
11.1.87
set-builder notation
We use the notation {x : x2 + x < 0} to represent the set of all real numbers x satisfying the inequality x2 + x < 0. It
may take some time but if you are adept at inequalities and quadratic equations you can recognize that this set is exactly
the open interval (−1,0). This is a useful way of describing a set (when possible): Just describe, by an equation or an
inequality, the elements that belong. In general, if C(x) is some kind of assertion about an object x, then {x : C(x)} is the
set of all objects x for which C(x) happens to be true. Other formulations can be used. For example,
{x ∈A : C(x)}
describes the set of elements x that belong to the set A and for which C(x) is true. The example {1/n : n = 1,2,3,...}
illustrates that a set can be obtained by performing computations on the members of another set.
11.1.88
set notation
Sets are just collections of objects If the word “set” becomes too often repeated, you might ﬁnd that words such as
collection, family, or class are used. Thus a set of sets might become a family of sets. The statement x ∈A means that
x is one of those numbers belonging to A. The statement x ̸∈A means that x is not one of those numbers belonging to A.
(The stroke through the symbol ∈here is a familiar device, even on road signs or no smoking signs.)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
459
11.1.89
subpartition
If [a,b] is a closed bounded interval and we choose points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b
then the collection of intervals
{[xi−1,xi] : i = 1,2,3,...,n}
forms a ﬁnite collection of nonoverlapping intervals whose union is the whole interval [a,b].
When working with Riemann sums [as we do very frequently] one must associate some point ξi to each of these
intervals [xi−1,xi]. A partition is the collection
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
of interval-point pairs with the associated point as the second entry in the pair ([xi−1,xi],ξi).
Any subset of a partition is a subpartition. Thus, in order for a collection
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
to be a subpartition the intervals must not overlap, the points ξi must be chosen from the corresponding interval [xi−1,xi],
but the union of all the intervals need not ﬁll out an entire interval, just part of it.
11.1.90
summation by parts
The summation by parts formula is just the elementary identity
n
∑
k=m
akbk =
n
∑
k=m
(sk −sk−1)bk
= sm(bm −bm+1)+sm+1(bm+1 −bm+2)···+sn−1(bn−1 −bn)+snbn.
It is a discrete analogue of integration by parts, and is occasionally a useful identity to have in the study of series.
11.1.91
sups and infs
See bounded set on page 424.
A sup is also called a least upper bound. An inf is also called a greatest lower bound.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

460
CHAPTER 11. APPENDIX
11.1.92
subsets, unions, intersection, and differences
The language of sets requires some special notation that is, doubtless, familiar. If you ﬁnd you need some review, take
the time to learn this notation well as it will be used in all of your subsequent mathematics courses.
1. A ⊂B (A is a subset of B) if every element of A is also an element of B.
2. A∩B (the intersection of A and B) is the set consisting of elements of both sets.
3. A∪B (the union of the sets A and B) is the set consisting of elements of either set.
4. A\B (the difference2 of the sets A and B) is the set consisting of elements belonging to A but not to B.
In the text we will need also to form unions and intersections of large families of sets, not just of two sets.
11.1.93
total variation function
Let F : [a,b] →R be a function of bounded variation. Then the function
T(x) = V(F,[a,x])
(a < x ≤b),
T(a) = 0
is called the total variation function for F on [a,b].
See also function of bounded variation on page425.
11.1.94
uniformly continuous function
Make sure to distinguish between [pointwise] continuous and uniformly continuous.
Let f : I →R be a function deﬁned on an interval I. We say that f is uniformly continuous if for every
ε > 0 there is a δ > 0 so that
| f(d)−f(c)| < ε
whenever c, d are points in I for which |d −c| < δ.
2Don’t use A−B for set difference since it suggests subtraction, which is something else.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.1. GLOSSARY OF TERMS
461
and
Let f : I →R be a function deﬁned on an open interval I and let x0 be a point in that interval. We say that f
is pointwise continuous at x0 if for every ε > 0 there is a δ > 0 so that
| f(x)−f(x0)| < ε
whenever x is a point in I for which |x−x0| < δ.
When you are ﬁnished with the course you may drop the word “pointwise” since it is not standard. We are using this
to emphasize the distinction between the two levels of continuity assumptions.
11.1.95
upper bound of a set
See bounded set on page 424.
11.1.96
variation of a function
The variation of a function concerns estimates on the size of the sums
n
∑
i=1
|F(xi)−F(xi−1)|
for choices of points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b.
There are two (related) deﬁnitions that we use:
A function F : [a,b] →R is said to be of bounded variation if there is a number M so that
n
∑
i=1
|F(xi)−F(xi−1)| ≤M
for all choices of points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b.
The least such number M is called the total variation of F on [a,b] and is written V(F,[a,b]). If F is not of
bounded variation then we set V(F,[a,b]) = ∞.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

462
CHAPTER 11. APPENDIX
and
A function F : (a,b) →R is said to have zero variation on a set E ⊂(a,b) if for every ε > 0 and every
x ∈E there is a δ(x) > 0
n
∑
i=1
|F(bi)−F(ai)| < ε
whenever a subpartition
{([ai,bi],ξi) : i = 1,2,...,n}
is chosen for which
ξi ∈E ∩[ai,bi] and bi −ai < δ(ξi).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
463
11.2
Answers to exercises
Exercise 1, page 4
The symbols −∞and ∞do not stand for real numbers; they are used in various contexts to describe a situation. For
example limn→∞
n
n+1 = 1 and limn→∞n2
n+1 = ∞have meanings that do not depend on there being a real number called ∞.
Thus stating a < x < ∞simply means that x is a real number larger than a. [It does not mean that x is a real number
smaller than ∞, because there is no such thing.]
Exercise 2, page 4
Well, we have labeled some intervals as “bounded” and some as unbounded. But the deﬁnition of a bounded set E
requires that we produce a real number M so that |x| ≤M for all x ∈E or, equivalently that −M ≤x ≤M for all x ∈E
Show that the labels are correct in terms of this deﬁnition of what bounded means.
Exercise 3, page 4
Well, we have labeled some intervals as “open” and some as not. But the deﬁnition of an open set G requires that we
produce, for each x ∈G at least one interval (c,d) that contains x and is contained inside the set G. Show that the labels
are correct in terms of the deﬁnition of what open means here. (It is almost immediate from the deﬁnition but make sure
that you understand the logic and can write it down.)
Exercise 4, page 4
Again, we have labeled some intervals as “closed” and some as not. Show that the labels are correct in terms of the
deﬁnition of what closed means here. Remember that the deﬁnition of closed is given in terms of the complementary set.
A set E is closed if the set R\E is an open set. So, for these intervals, write down explicitly what that complementary
set is.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

464
CHAPTER 11. APPENDIX
Exercise 5, page 4
For example [a,b) is not open because the point a is in the set but we cannot ﬁnd an open interval that contains a and
is also a subset of [a,b). Thus the deﬁnition fails at one point of the set. For not closed, work with the complement of
[a,b), i.e., the set (−∞,a)∪[b,∞) and ﬁnd a point that illustrates that this set cannot be open.
Exercise 6, page 4
Yes, if the two open intervals have a point in common [i.e., are not disjoint]. Otherwise the intersection would be the
empty set /0; for this reason some authors [not us] call the empty set a degenerate open interval.
Exercise 7, page 4
Not in general. If the two intervals have only one point in common or no points in common the intersection is not an
interval. Yes, if the two closed intervals have at least two point in common.
If we have agreed (as in the discussion to the preceding exercise) to call the empty set a degenerate open interval we
would be obliged also to call it a degenerate closed interval.
Exercise 8, page 4
Not necessarily. The intersection could, of course, be the empty set which we do not interpret as an interval, and we must
consider the empty set as bounded. Even if it is not empty it need not be unbounded. Consider (∞,1)∩(0,∞) = (0,1).
Exercise 9, page 4
The only possibility would be
(a,b)∪(c,d) = (s,t)
where the two intervals (a,b) and (c,d) have a point in common. In that case s = min{a,c} and t = max{b,d}. If (a,b)
and (c,d) are disjoint then (a,b)∪(c,d) is not an interval, but a disjoint union of two open intervals.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
465
Exercise 10, page 4
The only possibility would be (−∞,c]∪[c,∞) = (−∞,,∞).
Exercise 11, page 4
Yes. Prove, in fact, that the union of a ﬁnite number of bounded sets is a bounded set.
Exercise 12, page 4
Remember that A\B is the set of all points that are in the set A but are not in the set B. If I is open you should discover
that I \C is a union of a ﬁnite number of disjoint open intervals, and is an open set itself. For example if I = (a,b) and
C = {c1,c2,...,cm} where these are points inside (a,b) then
(a,b)\C = (a,c1)∪(c1,c2)∪(c2,c3)∪···∪(cm,b).
Exercise 13, page 4
Remember that A\B is the set of all points that are in the set A but are not in the set B.
The set I \C must be a union of intervals. There are a number of possibilities and so, to answer the exercise, it
is best to just catalogue them. For example if I = [a,b] and C = {a,b} then [a,b] \C is the open interval (a,b). If
C = {c1,c2,...,cm} where these are points inside (a,b) then
[a,b]\C = [a,c1)∪(c1,c2)∪(c2,c3)∪···∪(cm,b].
After handling all the possibilities it should be clear that I \C is a union of a ﬁnite number of disjoint intervals. The
intervals need not all be open or closed.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

466
CHAPTER 11. APPENDIX
Exercise 14, page 6
If a sequence of real numbers {sn} converges to a real number L then, for any choice of ε0 > 0 there is an integer N so
that
L−ε0 < sn < L+ε0
for all integers n = N,N +1,N +2,N +3,....
Thus to ﬁnd a number M larger than all the values of |sn| we can select the maximum of these numbers:
|s1|,|s2|,|s3|,...,|sN−2|,|sN−1|,|L|+ε0.
The simplest bounded sequence that is not convergent would be sn = (−1)n. It is clearly bounded and obviously
violates the deﬁnition of convergent.
Exercise 15, page 6
If a sequence of real numbers {sn} is Cauchy then, for any choice of ε0 > 0 there is an integer N so that
|sn −sN| < ε0
for all integers n = N,N +1,N +2,N +3,....
Thus to ﬁnd a number M larger than all the values of |sn| we can select the maximum of these numbers:
|s1|,|s2|,|s3|,...,|sN−2|,|sN−1|,|sN|+ε0.
The simplest bounded sequence that is not Cauchy would be sn = (−1)n. It is clearly bounded and obviously violates
the deﬁnition of a Cauchy sequence.
Exercise 16, page 6
If a sequence of real numbers {sn} converges to a real number L then, for every ε > 0 there is an integer N so that
L−ε/2 < sn < L+ε/2
for all integers n ≥N.
Now consider pairs of integers n, m ≥N. We compute that
|sn −sm| = |sn −L+L−sm| ≤|sn −L|+|L−sm| < ε.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
467
By deﬁnition then {sn} is a Cauchy sequence.
Exercise 17, page 6
The easiest of these is the formula
lim
n→∞(asn +btn) = a
³
lim
n→∞sn
´
+b
³
lim
n→∞tn
´
.
You should certainly review your studies of sequence limits if it does not immediately occur to you how to prove this
using the deﬁnition of limit.
The product sntn and quotient sn
tn formulas are a little harder to prove and require a bit of thinking about the inequali-
ties. Make that when you state and try to prove the quotient formula
lim
n→∞
sn
tn
= limn→∞sn
limn→∞tn
you include an hypothesis to exclude division by zero on either side of the identity.
Exercise 18, page 7
We already know by an earlier exercise that a convergent sequence would have to be bounded, so it is enough for us to
prove that on the assumption that this sequence is bounded it must converge.
Since the sequence is bounded
L = sup{sn : n = 1,2,3,...}
is a real number. It has the property (as do all suprema) that sn ≤L for all n and, if ε > 0, then sn > L−ε for some n.
Choose any integer N such that sN > L−ε. Then for all integers n ≥N,
L−ε < sN ≤sn ≤L < L+ε.
By deﬁnition, then,
lim
n→∞sn = L.
Notice that if the sequence is unbounded then
sup{sn : n = 1,2,3,...} = ∞
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

468
CHAPTER 11. APPENDIX
and the sequence diverges to ∞,
lim
n→∞sn = ∞.
You should be able to give a precise proof of this that refers to Deﬁnition 1.3.
Exercise 19, page 7
The condition on the intervals immediately shows that the two sequences {an} and {bn} are bounded and monotone.
The sequence {an} is monotone nondecreasing and bounded above by b1; the sequence {bn} is monotone nonincreasing
and bounded below by a1.
By Exercise 18 these sequences converge. Take either z = limn→∞an or z = limn→∞bn. This point is in all of the
intervals. The assumption that
lim
n→∞(bn −an) = 0
makes it clear that only one point can be in all of the intervals.
Exercise 20, page 7
We construct ﬁrst a nonincreasing subsequence if possible. We call the mth element sm of the sequence {sn} a turn-back
point if all later elements are less than or equal to it, in symbols if sm ≥sn for all n > m. If there is an inﬁnite subsequence
of turn-back points sm1, sm2, sm3, sm4, . . . then we have found our nonincreasing subsequence since
sm1 ≥sm2 ≥sm3 ≥sm4 ≥....
This would not be possible if there are only ﬁnitely many turn-back points. Let us suppose that sM is the last turn-
back point so that any element sn for n > M is not a turn-back point. Since it is not there must be an element further on
in the sequence greater than it, in symbols sm > sn for some m > n. Thus we can choose sm1 > sM+1 with m1 > M +1,
then sm2 > sm1 with m2 > m1, and then sm3 > sm2 with m3 > m2, and so on to obtain an increasing subsequence
sM+1 < sm1 < sm2 < sm3 < sm4 < ...
as required.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
469
Exercise 21, page 7
This follows immediately from Exercises 18 and 20. Take any monotone subsequence. Any one of them converges by
Exercise 18 since the sequence and the subsequence must be bounded.
Exercise 22, page 7
By the way, before seeing a hint you might want to ask for a reason for the terminology. If every Cauchy sequence
is convergent and every convergent sequence is Cauchy why bother with two words for the same idea. The answer is
that this same language is used in other parts of mathematics where every convergent sequence is Cauchy, but not every
Cauchy sequence is convergent. Since we are on the real line in this course we don’t have to worry about such unhappy
possibilities. But we retain the language anyway.
What is most important for you to remember is the logic of this exercise so we will sketch that and leave the details
for you to write out:
1. Every Cauchy sequence is bounded.
2. Every sequence has a monotone subsequence.
3. Every bounded, monotone sequence converges.
4. Therefore every Cauchy sequence has a convergent subsequence.
5. When a Cauchy sequence has a subsequence converging to a number L the sequence itself must converge to the
number L. [Using an ε, N argument.]
Exercise 23, page 8
If x does not belong to E then it belongs to a component interval (a,b) of R\E that contains no points of E. Thus there
is a δ > 0 so that (x −δ,x +δ) does not contain any points of E. Since all points in the sequence {xn} belong to E this
would contradict the statement that x = limn→∞xn.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

470
CHAPTER 11. APPENDIX
Exercise 24, page 9
Just notice that
Sn −Sm =
n
∑
k=m−1
ak
provided that n ≥m.
Exercise 25, page 9
First observe, by the triangle inequality that
¯¯¯¯¯
n
∑
k=m
ak
¯¯¯¯¯ ≤
n
∑
k=m
|ak|.
Then if we can choose an integer N so that
n
∑
k=m
|ak| < ε
for all n ≥m ≥N, we can deduce immediately that
¯¯¯¯¯
n
∑
k=m
ak
¯¯¯¯¯ < ε
for all n ≥m ≥N.
What can we conclude? If the series of absolute values
n
∑
k=1
|ak| = |a1|+|a2|+|a3|+|a4|+...
converges then it must follow, without further checking, that the original series
n
∑
k=1
ak = a1 +a2 +a3 +a4 +...
is also convergent. Thus to determine whether a series ∑n
k=1 ak is absolutely convergent we need only check the corre-
sponding series of absolute values.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
471
Exercise 26, page 10
Just choose any ﬁnite number of points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b
so that the points are closer together than δ. Then no matter what points ξi in [xi−1,xi] we choose the partition
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
of the interval [a,b] has the property that each interval [xi−1,xi] has length smaller than δ(ξi) = δ.
Note that this construction reveals just how hard it might seem to arrange for a partition if the values of δ(x) are
allowed to vary.
Exercise 27, page 10
For every point x in a closed, bounded interval [a,b] let there be given a positive number δ(x). Let us call an interval
[c,d] ⊂[a,b] a black interval if there exists at least one partition
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
of the interval [c,d] with the property that each interval [xi−1,xi] has length smaller than δ(ξi). If an interval is not black
let us say it is white.
Observe these facts about black intervals.
1. If [c,d] and [d,e] are black then [c,e] is black.
2. If [c,d] contains a point z for which d −c < δ(z) then [c,d] is black.
The ﬁrst statement follows from the fact that any partitions for [c,d] and [d,e] can be joined together to form a partition
of [c,e]. The second statement follows from the fact that {[c,d],z)} alone makes up a partition satisfying the required
condition in the Cousin lemma.
Now here is the nested interval argument. We wish to prove that [a,b] is black. If it is not black then one of the
two intervals [a, 1
2(a + b)] or [ 1
2(a + b),b] is white. If both were black then statement (1) makes [a,b] black. Choose
that interval (the white one) as [a1,b1]. Divide that interval into half again and produce another white interval of half the
length. This produces [a1,b1] ⊃[a2,b2] ⊃[a3,b3]..., a shrinking sequence of white intervals with lengths decreasing to
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

472
CHAPTER 11. APPENDIX
zero,
lim
n→∞(bn −an) = 0.
By the nested interval argument then there is a unique point z that belongs to each of the intervals and there must be an
integer N so that (bN −aN) < δ(z). By statement (2) above that makes [aN,bN] black which is a contradiction.
Exercise 28, page 10
For every point x in a closed, bounded interval [a,b] let there be given a positive number δ(x). Let us say that a number
a < r ≤b can be reached if there exists at least one partition
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
of the interval [a,r] with the property that each interval [xi−1,xi] has length smaller than δ(ξi).
Deﬁne R as the last point that can be reached, i.e.,
R = sup{r : a < r ≤b and r can be reached}.
This set is not empty since all points in (a,a+δ(a)) can be reached. Thus R is a real number no larger than b. Check that
R itself can be reached. Indeed there must be points r in the interval (R−δ(R),R] that can be reached (by the deﬁnition
of sups). If R−δ(R) < r < R and r can be reached, then R also can be reached by simply adding the element ([r,R],R)
to the partition for [a,r].
Is R < b? No since if it were then we could reach a bigger point by adding a suitable pair ([R,s],R) to a partition for
[a,R]. Consequently R = b and b can be reached, i.e., it is the last point that can be reached.
Exercise 29, page 10
For each x in [a,b] select a positive number δ(x) so that the open interval
(x−δ(x),x+δ(x))
is inside some open interval of the family C.
By Cousin’s lemma there exists at least one partition
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
473
of the interval [a,b] with the property that each interval [xi−1,xi] has length smaller than δ(ξi). For each i = 1,2,3,...
select from C some open interval (ci,di) that contains
(ξi −δ(ξi),ξi +δ(ξi)).
This ﬁnite list of intervals from C
(c1,d1), (c2,c3), ,..., (cn,dn)
contains every point of [a,b] since every interval [xi−1,xi] is contained in one of these open intervals.
Exercise 30, page 10
Use a proof by contradiction. For example if (a,b) ⊂G1 ∪G2, G1 ∪G2 = /0, then for every x ∈G1 ∩[a,b] there is a
δ(x) > 0 so that
(x−δ(x),x+δ(x)) ⊂G1
and for every x ∈G2 ∩[a,b] there is a δ(x) > 0 so that
(x−δ(x),x+δ(x)) ⊂G2.
By Cousin’s lemma there exists at least one partition
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
of the interval [a,b] with the property that each interval [xi−1,xi] has length smaller than δ(ξi). Consequently each interval
[xi−1,xi] belongs entirely either to G1 or belongs entirely either to G2.
This is impossible. For if a ∈G1, then [x0,x1] ⊂G1. But that means [x1,x2] ⊂G1, and [x2,x3] ⊂G1, ... , and indeed
all of the intervals are subsets of G1.
Exercise 31, page 11
Use a proof by contradiction. Suppose, for example that [a,b] ⊂G1 ∪G2, G1 ∪G2 = /0. Then a is in one of these two
open sets, say a ∈G1. Take the last point t for which [a,t) ⊂G1, i.e.,
t = sup{r : a < r ≤b, [a,r) ⊂G1}.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

474
CHAPTER 11. APPENDIX
That number cannot be b, otherwise G2 contains no point of the interval. And that number cannot be in the open set G1,
otherwise we failed to pick the last such number. Thus t ∈G2. But the situation t ∈G2 requires there to be some interval
(c,d) containing t and entirely contained inside G2. That gives us (c,t) ⊂G1 and (c,t) ⊂G2. This is a contradiction to
the requirement that G1 ∪G2 = /0.
Exercise 32, page 11
Take any two points in the set, s < t. If there is a point s < c < t that is not in the set E then E ⊂(−∞,c)∪(c,∞) exhibits,
by deﬁnition, that the set is disconnected. So the set E contains all points between any two of its elements. Consequently
E is either (a,b) or [a,b) or (a,b] or [a,b] where for a take infE and for b take supE.
Exercise 33, page 12
You should remember that these functions are deﬁned for all real numbers, with the exception that tan(±π/2) = ±∞.
So, since we do not consider functions to have inﬁnite values, the function tanx is considered to be deﬁned at all reals
that are not of the form (n+1/2)π/2 for some integer n.
Exercise 34, page 12
The value of arcsinx is deﬁned to be the number −π/2 ≤y ≤π/2 such that siny = x. The only numbers x that permit a
solution to this equation are from the interval [−1,1]. The value of arctanx is deﬁned to be the number −π/2 ≤y ≤π/2
such that tany = x. This equation can be solved for all real numbers x so the assumed domain of arctanx is the entire
real line.
Exercise 35, page 12
The exponential function ex is deﬁned for all values of x so its domain is the whole real line. The logarithm function is
the inverse deﬁned by requiring logx = y to mean ey = x. Since ey is always positive the logarithm function cannot be
deﬁned at zero or at any negative number. In fact the domain of logx is the open unbounded interval (0,∞).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
475
Exercise 36, page 12
Check that x2 −x −1 only at the points c1 = 1/2 +
√
5/2 and c2 = 1/2 −
√
5/2. Thus the domain of the ﬁrst function
would be assumed to be (−∞,c2)∪(c2,c1)∪(c1,∞)>
Also x2 −x −1 ≥0 only on the intervals (∞,c2] and [c1,∞) so the the domain of the second function would be
assumed to be (∞,c2]∪[c1,∞).
Finally, the third function is a composition. We cannot write arcsint unless −1 ≤t ≤1, consequently we cannot
write arcsin(x2 −x−1) unless −1 ≤x2 −x−1 ≤1, or equivalently 0 ≤x2 −x ≤2.
But −1 ≤x2 −x −1 on the intervals (−∞,0) and (1,∞), while x2 −x −1 ≤1 on the interval [−1,2]. So ﬁnally
arcsin(x2 −x −1) can only be written for x in the intervals [−1,0] and [1,2]. So the the domain of the third function
would be assumed to be [−1,0]∪[1,2].
Exercise 37, page 14
This is trivial. Just state the deﬁnition of uniform continuity and notice that it applies immediately to every point.
Exercise 38, page 14
Find a counterexample, i.e., ﬁnd a function that is continuous on some open interval I and that is not necessarily uni-
formly continuous on that interval.
Exercise 39, page 14
There are lots of choices. Our favorite might be to set f(x) = x if x is rational and f(x) = −x if x is irrational. Then just
check the deﬁnition at each point.
Exercise 40, page 14
To work with the deﬁnition one must know it precisely and also have an intuitive grasp. Usually we think that uniform
continuity of f means
. . . if d −c is small enough f(d)−f(c) should be small.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

476
CHAPTER 11. APPENDIX
For the function f(x) = x this becomes
. . . if d −c is small enough d −c should be small.
That alone is enough to indicate that the exercise must be trivial. Just write out the deﬁnition using δ = ε.
Exercise 41, page 14
Obtain a contradiction by assuming [falsely] that f(x) = x2 is uniformly continuous on the interval (−∞,∞).
Usually we think that uniform continuity of f means
. . . if d −c is small enough f(d)−f(c) should be small.
That means that the failure of uniform continuity should be thought of this way:
. . . even though d −c is small f(d)−f(c) might not be small.
For the function f(x) = x2 this becomes
. . . even though d −c is small d2 −c2 might not be small.
A similar way of thinking is
. . . even though t is small (x+t)2 −x2 might not be small.
That should be enough to indicate a method of answering the exercise.
Thus, take any particular ε > 0 and suppose [wrongly] that
|d2 −c2)| < ε
whenever c, d are points for which |d −c| < δ. Take any large integer N so that 1/N < δ. Then
|(N +1/N)2 −1/N2)| = N2 +2 < ε.
This cannot be true for all large integers N so we have a contradiction.
By the way, this method of ﬁnding two sequences xN = N and yN = N +1/N to show that uniform continuity fails is
turned into a general method in Exercise 90.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
477
Exercise 42, page 14
The key is to factor
x2 −y2 = (x+y)(x−y).
Then, we think that uniform continuity of f means
. . . if x−y is small enough f(x)−f(y) should be small.
For the function f(x) = x2 this becomes
. . . if x−y is small enough [x+y](x−y) should be small.
In any bounded interval we can control the size of [x+y].
Here is a formal proof using this thinking. Let I be a bounded interval and suppose that |x| ≤M for all x ∈I. Let
ε > 0 and choose δ = ε/(2M). Then, if |d −c| < δ
| f(d)−f(c)| = |d2 −c2| = |[d +c](d −c)| ≤[|d|+|c|]|d −c| ≤[2M]|d −c| < 2Mδ = ε.
By deﬁnition, f is uniformly continuous on I.
Exercise 43, page 14
We have already proved that this function is uniformly continuous on any bounded interval. Use that fact on the interval
(x0 −1,x0 +1).
Exercise 44, page 14
Suppose [falsely] that f(x) = 1
x is uniformly continuous on the interval (0,∞); then it must also be uniformly continuous
on the bounded interval (0,1). Using ε = 1 choose δ > 0 so that
¯¯¯¯
1
x −1
y
¯¯¯¯ < 1
if |x−y| < δ. In particular take a point 0 < y0 < δ and notice that
¯¯¯¯
1
x
¯¯¯¯ < 1+ 1
y0
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

478
CHAPTER 11. APPENDIX
for all 0 < x < δ. For δ ≤x < 1
¯¯¯¯
1
x
¯¯¯¯ ≤1
δ
We know that this function f(x) = 1
x is unbounded and yet we seem to have produced an upper bound on the interval
(0,1). This is a contradiction and hence the function cannot be uniformly continuous.
In fact we can make this particular observation into a method. When a function is uniformly continuous on a bounded
interval we will prove that the function is bounded. Hence unbounded functions cannot be uniformly continuous on a
bounded interval.
We now show that f(x) = 1
x is continuous at every real number x0 ̸= 0. Take any point x0 > 0 and let ε > 0. We must
choose a δ > 0 so that
|1/x−1/x0| < ε
whenever x is a point in (0,∞) for which |x−x0| < δ. This an exercise in inequalities. Write
|1/x−1/x0| =
¯¯¯¯
x−x0
xx0
¯¯¯¯.
Note that if x > x0/2 then xx0/2 > x2
0 so that 1/[xx0] ≤1/[2x2
0]. These inequalities reveal the correct choice of δ and
reveal where we should place the argument. We need not work in the entire interval (0,∞) but can restrict the argument
to the subinterval (x0/2,3x0/2).
Let x0 be a point in the interval (0,∞). Work entirely inside the interval (x0/2,3x0/2). Let ε > 0. Choose δ = εx2
0
and suppose that |x−x0| < δ = εx2
0 and that x is a point in the interval (x0/2,3x0/2). Then since x0/2 < x,
| f(x)−f(x0)| =
¯¯¯¯
x−x0
xx0
¯¯¯¯ ≤εx2
0
2x2
0
< ε.
By deﬁnition f(x) = 1
x is continuous at the point x0.
Note this device used here: since pointwise continuity at x0 is a local property at a point we can restrict the argument
to any open interval that contains x0. If, by doing so, you can make the inequality work easier then, certainly, do so.
Note: We have gone into some great detail in the exercise since this is at an early stage in our theory and it is an
opportunity for instruction. You should be able to write up this proof in a shorter, more compelling presentation.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
479
Exercise 45, page 14
It is easy to check that both rF(x) and sG(x) must be continuous at the point x0. Thus it is enough to prove the result for
r = s = 1, i.e., to prove that F(x)+G(x) must be continuous at the point x0.
The inequality
|F(x)+G(x)−[F(x0)+G(x0)| ≤|F(x)−F(x0)|+|G(x)−G(x0)|
suggests an easy proof.
Using the same method you should be successful in proving the following statement:
Let F and G be functions that are uniformly continuous on an interval I. Then any linear combination
H(x) = rF(x)+sG(x) must also be uniformly continuous on I.
Exercise 46, page 14
The key is to use the simple inequality
|F(x)G(x)−F(x0)G(x0)| = |F(x)G(x)−F(x0)G(x)+F(x0)G(x0)−F(x0)G(x0)|
≤|F(x)G(x)−F(x0)G(x)|+|F(x0)G(x)−F(x0)G(x0)|
= |G(x)|·|F(x)−F(x0)|+|F(x0)|·|G(x)−G(x0)|
Since G is continuous at the point x0 there must be at least one interval (c,d) ⊂I containing the point x0 so that G is
bounded on (c,d). In fact we can use the deﬁnition of continuity to ﬁnd a η > 0 so that
|G(x)−G(x0)| < 1 for all x in (x0 −η,x0 +η)
and so, also
|G(x)| < |G(x0)|+1 for all x in (x0 −η,x0 +η).
Thus we can select such an interval (c,d) and a positive number M that is larger than |G(x)| + |F(x0)| for all x in the
interval (c,d).
Let ε > 0. The assumptions imply the existence of the positive numbers δ1 and δ2, such that
|F(x)−F(x0)| < ε
2M
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

480
CHAPTER 11. APPENDIX
if |x−x0| < δ1 and
|G(x)−G(x0)| < ε
2M
if |x−x0| < δ2.
Then, using any δ smaller than both δ1 and δ2, and arguing inside the interval (c,d) we observe that
|F(x)G(x)−F(x0)G(x0)| ≤M|F(x)−F(x0)|+M|G(x)−G(x0)| < 2Mε/(2M) = ε.
if |x −x0| < δ. This is immediate from the inequalities above. This proves that the product H(x) = F(x)G(x) must be
continuous at the point x0.
Does the same statement apply to uniform continuity? In view of Exercise 45 you might be tempted to prove the
following false theorem:
FALSE: Let F and G be functions that are uniformly continuous on an interval I. Then the product H(x) =
F(x)G(x) must also be uniformly continuous on I.
But note that F(x) = G(x) = x are both uniformly continuous on (−∞,∞) while FG(x) = F(x)G(x) = x2 is not. The key
is contained in your proof of this exercise. You needed boundedness to make the inequalities work.
Here is a true version that you can prove using the methods that we used for the pointwise case:
TRUE: Let F and G be functions that are uniformly continuous on an interval I. Suppose that G is bounded
on the interval I. Then the product H(x) = F(x)G(x) must also be uniformly continuous on I.
Later on we will ﬁnd that, when working on bounded intervals, all uniformly continuous functions must be bounded.
If you use this fact now and repeat your arguments you can prove the following version:
Let F and G be functions that are uniformly continuous on a bounded interval I. Then the product H(x) =
F(x)G(x) must also be uniformly continuous on I.
Exercise 47, page 14
Yes, if G(x0) ̸= 0. The identity
¯¯¯¯
F(x)
G(x) −F(x0)
G(x0)
¯¯¯¯ =
¯¯¯¯
F(x)G(x0)−F(x)G(x)+F(x)G(x)−F(x0)G(x)
G(x)G(x0
¯¯¯¯.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
481
should help. You can also prove the following version for uniform continuity.
Let F and G be functions that are uniformly continuous on an interval I. Then the quotient H(x) =
F(x)/G(x) must also be uniformly continuous on I provided that the functions F and 1/G are also deﬁned
and bounded on I.
Exercise 48, page 14
Let ε > 0 and determine η > 0 so that
|G(z)−G(z0)| < ε
whenever z is a point in J for which |z−z0| < η. Now use the continuity of F at the point x0 to determine a δ > 0 so that
|F(x)−F(x0)| < η
whenever x is a point in I for which |x−x0| < δ.
Note that if x is a point in I for which |x−x0| < δ, then z = F(x) is a point in J for which |z−z0| < η. Thus
|G(F(x))−G(F(x0))| = |G(z)−G(z0)| < ε.
Exercise 51, page 15
Too simple for a hint.
Exercise 52, page 15
Another way to think about this is that a function that is a sum of characteristic functions
f(x) =
M
∑
i=1
aiχAi(x)
is a step function if all the Ai are intervals or singleton sets. [Here χE(x), for a set E, is equal to 1 for points x in E and
equal to 0 otherwise.]
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

482
CHAPTER 11. APPENDIX
Let f : [a,b] →R be a step function. Show ﬁrst that there is a partition
a = x0 < x1 < x2 < ··· < xn−1 < xn = b
so that f is constant on each interval (xi−1,xi), i = 1, 2, . . . , n. This will display all possible discontinuities.
Exercise 53, page 16
This is not so hard and the title gives it away. Show ﬁrst that R(x) = 1 if x is rational and is otherwise 0.
Exercise 54, page 16
We can interpret this statement, that the distance function is continuous, geometrically this way: if two points x1 and x2
are close together, then they are at roughly the same distance from the closed set C.
Exercise 55, page 16
This just requires connecting two deﬁnitions: the deﬁnition of continuity at a point and the deﬁnition of sequential limit
at a point.
Let ε > 0 and choose δ > 0 so that | f(x)−f(x0)| < ε if |x−x0| < δ. Now choose N so that |xn −x0| < δ for n > N.
Combining the two we get that | f(xn)−f(x0)| < ε if n > N. By deﬁnition that means that limn→∞f(xn) = f(x0).
That proves one direction. To prove the other direction we can use a contrapositive argument: assume that continuity
fails and then deduce that the sequence property also fails. Suppose that f is not continuous at x0. Then, for some value
of ε there cannot be a δ for which | f(x)−f(x0)| < ε if |x −x0| < δ. Consequently, for every integer n there must be at
least one point xn in the interval so that |x0 −xn| < 1/n and yet | f(x)−f(x0)| > ε.
In other words we have produced a sequence {xn} →x0 for which limn→∞f(xn) = f(x0) fails.
Exercise 56, page 16
Suppose ﬁrst that f is continuous. Let V be open, let x0 ∈f −1(V) and choose α < β so that (α,β) ⊂V and so that
x0 ∈f −1((α,β)). Then α < f(x0) < β. We will ﬁnd a neighborhood U of x0 such that α < f(x) < β for all x ∈U. Let
ε = min(β−f(x0), f(x0)−α).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
483
Since f is continuous at x0, there exists a δ > 0 such that if
x ∈(x0 −δ,x0 +δ),
then
| f(x)−f(x0)| < ε.
Thus
f(x)−f(x0) < β−f(x0),
and so f(x) < β. Similarly,
f(x)−f(x0) > α−f(x0),
and so f(x) > α. Thus the neighborhood U = (x0 −δ,x0 + δ) is a subset of f −1((α,β)) and hence also a subset of
f −1(V). We have shown that each member of f −1(V) has a neighborhood in f −1(V). That is, f −1(V) is open.
To prove the converse, suppose f satisﬁes the condition that for each open interval (α,β) with α < β, the set
f −1((α,β)) is open. Take a point x0. We must show that f is continuous at x0. Let ε > 0, β = f(x0)+ε, α = f(x0)−ε.
Our hypothesis implies that f −1((α,β)) is open.
Thus there is at least open interval, (c,d) say, that is contained in this open set and contains the point x0. Let
δ = min(x0 −c,d −x0).
For |x−x0| < δ we ﬁnd
α < f(x) < β.
Because β = f(x0)+ε and α = f(x0)−ε we must have
| f(x)−f(x0)| < ε.
This shows that f is continuous at x0.
Exercise 58, page 17
In preparation . . .
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

484
CHAPTER 11. APPENDIX
Exercise 59, page 17
Because of Exercise 58 we already know that if ε > 0 then there is δ > 0 so that
ω f([c,d]) < ε
whenever [c,d] is a subinterval of I for which |d −c| < δ. If the points of the subdivision
a = x0 < x1 < x2 < x3 < ··· < xn−1 < xn = b
are chosen with gaps smaller than δ then, certainly, each of
ω f([x0,x1]), ω f([x1,x2]),..., and ω f([xn−1,xn])
is smaller than ε.
Conversely suppose that there is such a subdivision. Let δ be one-half of the minimum of the lengths of the intervals
[x0,x1], [x1,x2], . . . , [xn−1,xn]. Note that if we take any interval [c,d] with length less than δ that interval can meet no
more than two of the intervals above. For example if [c,d] meets both [x0,x1] and [x1,x2], then
ω f([c,d]) ≤ω f([x1,x2])+ω f([x1,x2]) < 2ε.
In fact then any interval [c,d] with length less than δ must have
ω f([c,d]) < 2ε.
It follows that f is uniformly continuous on [a,b].
Is there a similar statement for uniform continuity on open intervals? Yes. Just check that f is a uniformly continuous
function on an open, bounded interval (a,b) if and only if, for every ε > 0, there are points
a = x0 < x1 < x2 < x3 < ··· < xn−1 < xn = b
so that each of
ω f((x0,x1]), ω f([x1,x2]),..., and ω f([xn−1,xn))
is smaller than ε.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
485
Exercise 60, page 18
If f is continuous at a point x0 and ε > 0 there is a δ(x0) > 0 so that
| f(x)−f(x0)| < ε/2
for all |x−x0| ≤δ(x0). Take any two points u and v in the interval [x0 −δ(x0),x0 +δ(x0)] and check that
| f(v)−f(u)| ≤|f(v)−f(x0)|+| f(v)−f(x0)| < ε/2+ε/2 = ε.
It follows that
ω f([x0 −δ(x0),x0 +δ(x0)]) ≤ε.
The other direction is easier since
| f(x)−f(x0)| ≤ω f([x0 −δ(x0),x0 +δ(x0)])
for all |x−x0| ≤δ(x0).
Exercise 61, page 18
This is just a rephrasing of the previous exercise.
Exercise 62, page 18
We use the fact that one-sided limits and sequential limits are equivalent in this sense:
A necessary and sufﬁcient condition in order that
L = lim
x→a+F(x)
should exist is that for all decreasing sequence of points {xn} convergent to a, the sequence { f(xn)} con-
verges to L.
Let us prove the easy direction ﬁrst. Suppose that F(a+) = limx→a+ F(x) exists and let ε > 0. Choose δ(a) > 0 so
that
|F(a+)−F(x)| ≤ε/3
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

486
CHAPTER 11. APPENDIX
for all a < x < a+δ(a). Then, for all c, d ∈(a,a+δ(a),
|F(d)−F(c)| ≤|F(a+)−F(d)|+|F(a+)−F(c)| ≤2ε/3.
It follows that
ωF((a,a+δ(a)) ≤2ε/3 < ε.
In the other direction consider a decreasing sequence of points {xn} convergent to a. Let ε > 0 and choose δ(a) so
that
ωF((a,a+δ(a)) < ε.
Then there is an integer N so that |xn −a| < δ(a) for all n ≥N. Thus
|F(xn)−F(xm)| ≤ωF((a,a+δ)) < ε
for all m, n ≥N. It follows from the Cauchy criterion for sequences that every such sequence {F(xn)} converges. The
limit is evidently f(a+).
Exercise 63, page 18
We use the fact that inﬁnite limits and sequential limits are equivalent in this sense:
A necessary and sufﬁcient condition in order that
L = lim
x→∞F(x)
should exist is that for all sequence of points {xn} divergent to ∞, the sequence {F(xn)} converges to L.
Let us prove the easy direction ﬁrst. Suppose that F(∞) = limx→∞F(x) exists and let ε > 0. Choose T > 0 so that
|F(∞)−F(x)| ≤ε/3
for all T < x. Then, for all c, d ∈(T,∞),
|F(d)−F(c)| ≤|F(∞)−F(d)|+|F(∞)−F(c)| ≤2ε/3.
It follows that
ωF((T,∞)) ≤2ε/3 < ε.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
487
In the other direction consider a sequence of points {xn} divergent to ∞. Let ε > 0 and choose T so that
ωF((T,∞)) < ε.
Then there is an integer N so that xn > T for all n ≥N. Thus
|F(xn)−F(xm)| ≤ωF((T,∞)) < ε
for all m, n ≥N. It follows from the Cauchy criterion for sequences that every such sequence {F(xn)} converges. The
limit is evidently F(∞).
Exercise 64, page 20
This is a direct consequence of Exercise 62. Let ε > 0 and choose δ > 0 so that
ωF((c,d)) < ε
for all subintervals [c,d] of (a,b) for which d −c < δ.
Then, certainly,
ωF((a,a+δ)) < ε and ωF((b,b−δ)) < ε.
From this, Exercise 62 supplies the existence of the two one-sided limits
F(a+) = lim
x→a+F(x) and F(b−) = lim
x→b−F(x).
Exercise 65, page 20
Let ε > 0 and, using Exercise 62, choose positive numbers δ(a) and δ(a) so that
ωF((a,a+δ(a))) < ε and ωF((b−δ(b),b)) < ε/2.
Now choose, for any point ξ ∈(a,b), a positive number and δ(ξ) so that
ωF([ξ−δ(ξ),ξ+δ(ξ)]) < ε.
This just uses the continuity of the function f at the point ξ in the oscillation version of that property that we studied in
Section 1.6.2.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

488
CHAPTER 11. APPENDIX
By the Cousin partitioning argument there must exist points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b
and a partition
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
of the whole interval [a,b] such that
ξi ∈[xi−1,xi] and xi −xi−1 < δ(ξi).
Just observe that this means that each of the following oscillations is smaller than ε:
ωF((a,x1]), ωF([x1,x2]), ωF([x2,x3]),...,ωF([xn−1,b)).
It follows from Exercise 59 that f is uniformly continuous on (a,b). In preparation . . .
Exercise 66, page 20
In one direction this is trivial. If F is deﬁned on (a,b) but can be extended to a uniformly continuous function on [a,b]
then F is already uniformly continuous on (a,b).
The other direction is supplied by the theorem, in fact in the proof of the theorem. That proof supplied points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b
so that each of the following oscillations is smaller than ε:
ωF((a,x1])), ωF([x1,x2]), ωF([x2,x3]), ..., ωF([xn−1,b)).
Now deﬁne G = F on (a,b) and G(a) = F(a+), G(b) = F(b−). Then
ωF((a,x1])) = ωG([a,x1]))
and
ωF([xn−1,b)) = ωG([xn−1,b]).
With this rather subtle change we have now produced points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
489
so that each of the following oscillations is smaller than ε:
ωG([a,x1])), ωG([x1,x2])), ωG([x2,x3])),..., ωG([xn−1,b]).
It follows from Exercise 59 that G is uniformly continuous on [a,b].
Exercise 67, page 20
If F is continuous on (a,b) and [c,d] ⊂(a,b) note that F is continuous on [c,d] and that F(c) = F(c+) and F(d) =
F(d−). Applying the theorem we see that F is uniformly continuous on [c,d].
Exercise 68, page 20
If F is continuous on (a,b) and monotone nondecreasing then we know that either F(a+) = limx→a+ F(x) exists as a
ﬁnite real number or else F(a+) = −∞. Similarly know that either F(b−) = limx→b−F(x) exists as a ﬁnite real number
or else F(b−) = +∞. Thus, by Theorem 1.10 the function is uniformly continuous on (a,b) provided only that the
function is bounded. Conversely, in order for the function F to be uniformly continuous on (a,b), it must be bounded
since all uniformly continuous functions are bounded on bounded intervals.
Exercise 69, page 20
This proof invokes a Bolzano-Weierstrass compactness argument. We use an indirect proof. If F is not uniformly
continuous, then there are sequences {xn} and {yn} so that xn −yn →0 but
|F(xn)−F(yn)| > c
for some positive c. (The veriﬁcation of this step is left out, but you should supply it. This can be obtained merely by
negating the formal statement that f is uniformly continuous on [a,b].)
Now apply the Bolzano-Weierstrass property to obtain a convergent subsequence {xnk}. Write z as the limit of this
new sequence {xnk}. Observe that xnk −ynk →0 since xn −yn →0. Thus {xnk} and the corresponding subsequence {ynk}
of the sequence {yn} both converge to the same limit z, which must be a point in the interval [a,b].
If a < z < b then we get a contradiction from the continuity of f: F(xnk) →F(z) and F(ynk) →F(z). Since |F(xn)−
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

490
CHAPTER 11. APPENDIX
F(yn)| > c for all n, this means from our study of sequence limits that
|F(z)−F(z)| ≥c > 0
and this is impossible.
Now suppose that z = a. Since
F(a+) = lim
x→a+F(x)
exists it also follows that F(xnk) →F(a+) and F(ynk) →F(a+). Again this is impossible. The remaining case, z = b is
similarly handled.
Exercise 70, page 20
Choose open intervals (a,a+δ(a)), (b−δ(b),b) so that
ωF((a,a+δ(a))) < ε/2 and ωF((b−δ(b),b)) < ε/2
At the endpoints a and b this is possible because the one-sided limits exist (i.e., by Exercise 62).
For each point x ∈(a,b) we may choose intervals (x−δ(x),x+δ(x) in such a way that
ωF((x−δ(x)x+δ(x)) < ε/2.
At the points x ∈(a,b) this is possible because of our assumption that F is continuous at all such points.
Pick points s and t with a < s < a+δ(a) and b−δ(b) < t < b. Now apply the Heine-Borel property to this covering
of the closed interval [s,t]. There are now a ﬁnite number of open intervals (xi −δ(xi),xi + δ(xi) with i = 1,2,3,...,k
covering [s,t].
Let δ be half the minimum length of all the intervals
(a,a+δ(a)),(b−δ(b),b),(xi −δ(xi),xi +δ(xi)
(i = 1,2,3,...,k).
Use this to show that ωF([c,d]) < ε if [c,d] ⊂(a,b) and d −c < δ.
Exercise 71, page 20
There are functions that are continuous at every point of (−∞,∞) and yet are not uniformly continuous. Find one.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
491
Exercise 72, page 20
There are functions that are continuous at every point of (0,1) and yet are not uniformly continuous. Find one.
Exercise 73, page 21
Slight of hand. Choose δ. Wait a minute. Our choice of δ depended on x0 so, to make the trick more transparent, call it
δ(x0). Then if d is some other point you will need a different value of δ.
Exercise 74, page 21
If G is continuous at every point of an interval [c,d] then the theorem (Theorem 1.10) applies to show that G is uniformly
continuous on that interval.
Exercise 75, page 21
Just read this from the theorem.
Exercise 76, page 21
Just read this from the theorem.
Exercise 77, page 21
In preparation . . .
Exercise 78, page 23
Let f be a uniformly continuous function on a closed, bounded interval [a,b]. Take any value of ε0 > 0. Then Exercise 59
supplies points
a = x0 < x1 < x2 < x3 < ··· < xn−1 < xn = b
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

492
CHAPTER 11. APPENDIX
so that each of
ω f([), ω f((x1,x2]),...,ω f((xn−1,xn])
is smaller than ε0. In particular, f is bounded on each of these intervals. Consequently f is bounded on all of [a,b].
The same proof could be used if we had started with a uniformly continuous function on an open bounded interval
(a,b). Note that if the interval is unbounded then such a ﬁnite collection of subintervals would not exist.
Exercise 79, page 23
The condition of pointwise continuity at a point x0 gives us an inequality
| f(x)−f(x0)| < ε
that must hold for some interval (x0 −δ,x0 +δ). This immediately provides the inequality
| f(x)| = | f(x)−f(x0)+ f(x0)| ≤|f(x)−f(x0)|+| f(x0)| < ε+| f(x0)|
which provides an upper bound for f in the interval (x0 −δ,x0 +δ).
Exercise 80, page 23
No. It doesn’t follow. For a counterexample, the function f(x) = sin(1/x) is a continuous, bounded function on the
bounded open interval (0,1). This cannot be uniformly continuous because
ω f((0,t)) = 2
for every t > 0. This function appears again in Exercise 106 The graph of F is shown in Figure 11.1 and helps to illustrate
that the continuity cannot be uniform on (0,1).
Later on we will see that if a function f is uniformly continuous on a bounded open interval (a,b) then the one-sided
limits at the endpoints a and b must exist. For the example f(x) = sin(1/x) on the bounded open interval (0,1) we can
check that f(0+) does not exist, which it must if f were to be uniformly continuous on (0,1).
Exercise 81, page 23
We assume here that you have studied sequences and convergence of sequences. If f is not bounded then there must be
a point x1 in the interval for which | f(x1)| > 1. If not then | f(x)| ≤1 and we have found an upper bound for the values
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
493
of the function. Similarly there must be a point x2 in the interval for which | f(x2)| > 2, and a point x3 in the interval for
which | f(x3)| > 3. Continue choosing points and then check that | f(xn)| →∞.
Exercise 84, page 23
The function f(x) = x is uniformly continuous on the unbounded interval (∞,∞) and yet it is not bounded. On the
other hand the function f(x) = sinx is uniformly continuous on the unbounded interval (∞,∞) and it is bounded, since
|sinx| ≤1.
Exercise 85, page 23
Yes and yes. If | f(x)| ≤M and |g(x)| ≤N for all x in an interval I then
| f(x)+g(x)| ≤|f(x)|+|g(x)| ≤M +N
and
| f(x)g(x)| ≤MN.
Exercise 86, page 23
No. On the interval (0,1) the functions f(x) = x and g(x) = x2 are bounded functions that do not assume the value zero.
The quotient function g/ f is bounded but the quotient function f/g is unbounded.
Exercise 87, page 23
If the values of f(t) are bounded then the values of f(g(x)) are bounded since they include only the same values. Thus
there is no need for the extra hypothesis that g is bounded.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

494
CHAPTER 11. APPENDIX
Exercise 88, page 24
Use the mean-value theorem to assist in this. If c < d then
sind −sinc = (d −c)cosξ
for some point ξ between c and d.
Don’t remember the mean-value theorem? Well use these basic facts instead:
sind −sinc = sin[(d −c)/2]cos[(d +c)/2]
and
|sinx| ≤|x|.
Stop reading and try the problem now . . .
If you followed either of these hints then you have arrived at an inequality of the form
|sind −sinc| ≤M|d −c|.
Functions that satisfy this so-called Lipschitz condition are easily shown to be uniformly continuous. For δ you will ﬁnd
that δ = ε/M works.
Exercise 89, page 24
For δ you will ﬁnd that δ = ε/M works.
Exercise 90, page 24
If f is uniformly continuous then, by deﬁnition, for every ε > 0 there is a δ > 0 so that
| f(d)−f(c)| < ε
whenever c, d are points in I for which |d −c| < δ. If there did exist two sequences of points {xn} and {xn} from that
interval for which xn −yn →0 then there would be an integer N so that |xn −yn| < δ for n > N. Consequently
| f(xn)−f(yn)| < ε
for n > N. By that means, by the usual sequence deﬁnitions that f(xn)−f(yn) does indeed converge to zero.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
495
Conversely if f is not uniformly continuous on the interval I then for some value ε0 > 0 and every integer n the
statement that
the inequality
| f(d)−f(c)| < ε0
holds whenever c, d are points in I for which |d −c| < 1/n.
must fail. Thus it is possible to select points {xn} and {xn} from that interval for which |xn −yn| < 1/n but
| f(xn)−f(yn)| ≥ε0.
Consequently we have exhibited two sequences of points {xn} and {xn} from that interval for which xn −yn →0 but
f(xn)−f(yn) does not converge to zero.
Exercise 91, page 24
By Theorem 1.16, F is bounded and so we may suppose that M is the least upper bound for the values of F, i.e.,
M = sup{ f(x) : a ≤x ≤b}.
If there exists x0 such that F(x0) = M, then F achieves a maximum value M. Suppose, then, that F(x) < M for all
x ∈[a,b]. We show this is impossible.
Let g(x) = 1/(M −F(x)). For each x ∈[a,b], F(x) ̸= M; as a consequence, g is uniformly continuous and g(x) > 0
for all x ∈[a,b]. From the deﬁnition of M we see that
inf{M −f(x) : x ∈[a,b]} = 0,
so
sup
½
1
M −f(x) : x ∈[a,b]
¾
= ∞.
This means that g is not bounded on [a,b]. This is impossible because uniformly continuous are bounded on bounded
intervals. A similar proof would show that F has an absolute minimum.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

496
CHAPTER 11. APPENDIX
Exercise 92, page 24
We can also prove Theorem 1.19 using a Bolzano-Weierstrass argument. Let
M = sup{F(x) : a ≤x ≤b}.
That means that for any integer n the smaller number M −1/n cannot be an upper bound for the values of the function
F on this interval.
Consequently we can choose a sequence of points {xn} from [a,b] so that
F(xn) > M −1/n.
Now apply the Bolzano-Weierstrass theorem to ﬁnd a subsequence {xnk} that converges to some point z0 in [a,b].
Use the continuity of F to deduce that
lim
k→∞F(xnk) = F(z0).
Since
M ≥F(xnk) > M −1/nk
it must follow that F(z0) = M. Thus the function F attains its maximum value at z0.
Exercise 93, page 24
How about sin2πx? This example is particularly easy to think about since the minimum value could only occur at an
endpoint and we have excluded both endpoints by working only on the interval (0,1). In fact we should notice that
this feature is general: if f is a uniformly continuous function on the interval (0,1) then there is an extension of f to a
uniformly continuous function on the interval [0,1] and the maximum and minimum values are attained on [0,1] [but not
necessarily on (0,1)].
Exercise 94, page 25
How about 1−sin2πx?
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
497
Exercise 95, page 25
Simplest is f(x) = x.
Exercise 96, page 25
Simplest is f(x) = x.
Exercise 97, page 25
Try f(x) = arctanx.
Exercise 98, page 25
If there is a point f(x0) = c > 0, then there is an interval [−N,N] so that x0 ∈[−N,N] and | f(x)| < c/2 for all x > N and
x < −N. Now since f is uniformly continuous on [−N,N] we may select a maximum point. That maximum will be the
maximum also on (−∞,∞).
If there is no such point x0 then f assumes only values negative or zero. Apply the same argument but to the function
−f. For a suitable example of a function that has an absolute maximum but not an absolute minimum you may take
f(x) = (1+x2)−1.
Exercise 99, page 25
All values of f(x) are assumed in the interval [0, p] and f is uniformly continuous on [0, p]. It would not be correct
to argue that f is uniformly continuous on (−∞,∞) [it is] and “hence” that f must have a maximum and minimum [it
would not follow].
Exercise 100, page 26
This is a deeper theorem than you might imagine and will require a use of one of our more sophisticated arguments. Try
using the Cousin covering argument.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

498
CHAPTER 11. APPENDIX
Let f be continuous at points a and b and at all points in between, and let c ∈R. If for every x ∈[a,b], f(x) ̸= c, then
either f(x) > c for all x ∈[a,b] or f(x) < c for all x ∈[a,b].
Let C denote the collection of closed intervals J such that f(x) < c for all x ∈J or f(x) > c for all x ∈J. We verify
that C forms a Cousin cover of [a,b].
If x ∈[a,b], then | f(x) −c| = ε > 0, so there exists δ > 0 such that | f(t) −f(x)| < ε whenever |t −x| < δ > and
t ∈[a,b]. Thus, if f(x) < c, then f(t) < c for all t ∈[x −δ/2,x + δ/2], while if f(x) > c, then f(t) > c for all t ∈
[x−δ/2,x+δ/2]. By Cousin’s lemma there exists a partition of [a,b], a = x0 < x1 < ··· < xn = b such that for i = 1,...,n,
[xi−1,xi] ∈C.
Suppose now that f(a) < c. The argument is similar if f(a) > c. Since [a,x1] = [x0,x1] ∈C, f(x) < c for all
x ∈[x0,x1]. Analogously, since [x1,x2] ∈C, and f(x1) < c, f(x) < c for x ∈[x1,x2]. Proceeding in this way, we see that
f(x) < c for all x ∈[a,b].
Exercise 101, page 26
We can prove Theorem 1.21 using the Bolzano-Weierstrass property of sequences rather than Cousin’s lemma. Suppose
that the theorem is false and explain, then, why there should exist sequences {xn} and {yn} from [a,b] so that f(xn) > c,
f(yn) < c and |xn −yn| < 1/n.
Exercise 102, page 26
We can prove Theorem 1.21 using the Heine-Borel property. Suppose that the theorem is false and explain, then, why
there should exist at each point x ∈[a,b] an open interval Ix centered at x so that either f(t) > c for all t ∈Ix ∩[a,b] or
else f(t) < c for all t ∈Ix ∩[a,b].
Exercise 103, page 26
We can prove Theorem 1.21 using the following “last point” argument: suppose that f(a) < c < f(b) and let z be the
last point in [a,b] where f(z) stays below c, that is, let
z = sup{x ∈[a,b] : f(t) ≤c for all a ≤t ≤x}.
Show that f(z) = c.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
499
You may take c = 0. Show that if f(z) > 0, then there is an interval [z −δ,z] on which f is positive. Show that if
f(z) < 0, then there is an interval [z,z+δ] on which f is negative. Explain why each of these two cases is impossible.
Exercise 104, page 26
For any such function f the Darboux property implies that the image set is connected. In an earlier exercise we deter-
mined that all connected sets on the real line are intervals.
For the examples we will need three functions F, G, H : (0,1) →R so that the image under F is not open, the image
under G is not closed, and the image under H is not bounded. You can check that F(x) = G(x) = x(1 −x) maps (0,1)
onto (0,1/4], and that H(x) = 1/x maps (0,1) onto (0,∞).
Exercise 105, page 26
As in the preceding exercise we know that the image set is a connected set [by the Darboux property] and hence that it
is an interval. This interval must be bounded since a uniformly continuous function on a closed, bounded interval [a,b]
is bounded. This interval must be then either (A,B) or [A,b) or (A,B] or [A,B]. The possibilities (A,B) and (A,B] are
impossible, for then the function would not have a minimum. The possibilities (A,B) and [A,B) are impossible, for then
the function would not have a maximum.
Exercise 106, page 26
The graph of F, shown in Figure 11.1, will help in thinking about this function.
Let us check that F is continuous everywhere, except at x0 = 0. If we are at a point x0 ̸= 0 then this function is the
composition of two functions G(x) = sinx and H(x) = 1/x, both suitably continuous. So on any interval [s,t] that does
not contain x0 = 0 the function is continuous and continuous functions satisfy the Darboux property.
Let t > 0. On the interval [0,t], F(0) = 0 and F assumes every value between 1 and −1 inﬁnitely often. On the
interval [−t,0], F(0) = 0 and F assumes every value between 1 and −1 inﬁnitely often.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

500
CHAPTER 11. APPENDIX
Figure 11.1: Graph of the function F(x) = sinx−1 on [−π/8,π/8].
Exercise 107, page 26
Consider the function g(x) = f(x)−x which must also be uniformly continuous. Now g(a) = f(a)−a ≥0 and g(b) =
f(b)−b ≤0. By the Darboux property there must be a point where g(c) = 0. At that point f(c)−c = 0.
Exercise 108, page 26
If zn →c then zn = f(zn−1) →f(c). Consequently c = f(c).
Exercise 109, page 26
This is a puzzle. Use the fact that such functions will have maxima and minima in any interval [c,d] ⊂I and that
continuous functions have the Darboux property.
Exercise 110, page 27
This is again a puzzle. Use the fact that such functions will have maxima and minima in any interval [c,d] ⊂I and
that continuous functions have the Darboux property. You shouldn’t have too much trouble ﬁnding an example if I is a
closed, bounded interval. What about if I is open?
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
501
Exercise 111, page 27
For such functions the one-sided limits f(x0+) f(x0−) exist at every point x0 and f(x0−) ≤f(x0+). The function is
discontinuous at x0 if and only if f(x0−) < f(x0+). Show that the Darboux property would not allow f(x0−) < f(x0+)
at any point.
Exercise 112, page 28
In its usual deﬁnition
F′(x) = lim
y→x
F(y)−F(x)
y−x
or, equivalently,
lim
y→x
½F(y)−F(x)
y−x
−F′(x)
¾
= 0.
But limits are deﬁned exactly by ε, δ(x) methods. So that, in fact, this statement about the limit is equivalent to the
statement that, for every ε > 0 there is a δ(x) > 0 so that
¯¯¯¯
F(y)−F(x)
y−x
−F′(x)
¯¯¯¯ ≤ε
whenever 0 < |y−x| < δ. [Note the exclusion of y = x here.] This, in turn, is identical to the statement that
¯¯F(y)−F(x)−F′(x)(y−x)
¯¯ ≤ε|y−x|
whenever 0 < |y−x| < δ. The case y = x which is formally excluded from such statements about limits can be accom-
modated here because the expression is zero for y = x. Consequently, a very small [hardly noticeable] cosmetic change
shows that the limit derivative statement is exactly equivalent to the statement that, for every ε > 0, there is a δ(x) > 0
so that
¯¯F(y)−F(x)−F′(x)(y−x)
¯¯ ≤ε|y−x|
whenever y is a points in I for which |y−x| < δ(x).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

502
CHAPTER 11. APPENDIX
Exercise 113, page 28
As we just proved, if F′(x0) exists and F is deﬁned on an interval I containing that point then, there is a δ(x0) > 0 so that
¯¯F(y)−F(x0)−F′(x0)(y−x)
¯¯ ≤|y−x0|
whenever y is a point in the interval I for which |y−x0| < δ(x0).
That translates quickly to the statement that
|F(y)−F(x0)| ≤(|F′(x0)|+1)|y−x0|
whenever y is a point in the interval I for which |y−x0| < δ(x0).
This gives the clue needed to write up this proof: If ε > 0 then we choose δ1 < δ(x0) so that
δ1 < ε/(|F′(x0)|+1).
Then
|F(y)−F(x0)| ≤(|F′(x0)|+1)|y−x0| < ε
whenever y is a point in the interval I for which |y−x0| < δ1. This is exactly the requirement for continuity at the point
x0.
Exercise 114, page 29
Note that
¯¯F(z)−F(y)−F′(x)(z−y)
¯¯ =
¯¯[F(z)−F(x)]−[F(x)−F(y)]−F′(x)([z−x]−[y−x])
¯¯
≤
¯¯F(z)−F(x)−F′(x)(z−x)
¯¯+
¯¯F(y)−F(x)−F′(x)(y−x)
¯¯.
Thus the usual version of this statement quickly leads to the straddled version. Note that the straddled version includes
the usual one.
The word “straddled” refers to the fact that, instead of estimating [F(y)−F(x)]/[y−x] to obtain F′(x) we can straddle
the point by taking z ≤x ≤y and estimating [F(y) −F(z)]/[y −z], still obtaining F′(x). If we neglect to straddle the
point [it would be unstraddled if y and z were on the same side of x] then we would be talking about a much stronger
notion of derivative.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
503
Exercise 115, page 29
In preparation . . .
Exercise 116, page 29
If F′(x0) > 0 then, using ε = F′(x0)/2, there must be a δ > 0 so that
¯¯F(z)−F(x0)−F′(x0)(z−x0)
¯¯ ≤ε|z−x0|
whenever z is a point in I for which |z−x0| < δ.
Suppose x0 < z < x0 +δ; then it follows from this inequality that
F(z)−F(x0)−F′(x0)(z−x0) ≥−ε(z−x0)
and so
F(z) ≥F(x0)+ε(z−x0)/2 > F(x0).
The argument is similar on the left at x0.
It is easy to use the deﬁnition of locally strictly increasing at a point to show that the derivative is nonnegative. Must
it be positive? For a counterexample simply note that f(x) = x3 is locally strictly increasing at every point but that the
derivative is not positive everywhere but has a zero at x0 = 0.
Exercise 117, page 29
Take any [c,d] ⊂(a,b). We will show that F(d) > F(c) and this will complete the proof that F is strictly increasing on
(a,b).
For each x0 in c,d] there is a δ(x0) > 0 so that
¯¯F(z)−F(x0)−F′(x0)(z−x0)
¯¯ ≤ε|z−x0|
whenever z is a point in I for which |z−x0| < δ(x0).
We apply the Cousin partitioning argument. There must exist at least one partition
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

504
CHAPTER 11. APPENDIX
of the interval [c,d] with the property that each interval [xi−1,xi] has length smaller than δ(ξi). Thus
F(d)−F(c) =
n
∑
i=1
[F(xi −F(xi−1)] > 0
since each of these terms must satisfy
[F(xi −F(xi−1)] = [F(xi −F(ξi)]+[F(ξi)−F(xi−1)] > 0.
Exercise 118, page 31
The strategy, quite simply, is to argue that there is a point inside the interval where a maximum or minimum occurs.
Accordingly the derivative is zero at that point.
First, if f is constant on the interval, then f ′(x) = 0 for all x ∈(a,b), so ξ can be taken to be any point of the interval.
Suppose then that f is not constant. Because f is uniformly continuous on the closed, bounded interval [a,b] , f achieves
a maximum value M and a minimum value m on [a,b].
Because f is not constant, one of the values M or m is different from f(a) and f(b), say M > f(a). Choose
f(ξ) = M. Since M > f(a) = f(b), c ∈(a,b). Check that f ′(c) = 0. If f ′(c) > 0 then, by Exercise 116, the function f
must be locally strictly increasing at x0. But this is impossible if x0 is at a maximum for f. If f ′(c) < 0 then, again by
Exercise 116, the function −f must be locally strictly increasing at x0. But this is impossible if x0 is at a maximum for
f. It follows that f ′(c) = 0.
Exercise 119, page 31
Rolle’s theorem asserts that, under our hypotheses, there is a point at which the tangent to the graph of the function
is horizontal, and therefore has the same slope as the chord determined by the points (a, f(a)) and (b, f(b)). (See
Figure 11.2.)
Exercise 120, page 31
There may, of course, be many such points; Rolle’s theorem just guarantees the existence of at least one such point. You
should be able to construct a function, under these hypotheses, with an entire subinterval where the derivative vanishes.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
505
f
a
c1
c2
b
Figure 11.2: Rolle’s theorem [note that f(a) = f(b)].
Exercise 121, page 31
First check continuity at every point. This function is not differentiable at zero, but Rolle’s theorem requires differentia-
bility only inside the interval, not at the endpoints. Continuity at the point zero is easily checked by using the inequality
| f(x)| = |xsinx−1| ≤|x|. Continuity elsewhere follows from the fact that function f is differentiable (by the usual rules)
and so continuous. Finally, in order to apply Rolle’s theorem, just check that 0 = f(0) = f(1/π).
There are an inﬁnite number of points between 0 and 1/π where the derivative is zero. Rolle’s theorem guarantees
that there is at least one.
Exercise 122, page 31
Yes. Notice that f fails to be differentiable at the endpoints of the interval, but Rolle’s theorem does not demand
differentiability at either endpoint.
Exercise 123, page 31
No. Notice that f fails to be differentiable only at the midpoint of this interval, but Rolle’s theorem demands dif-
ferentiability at all interior points, permitting nondifferentiability only at either endpoint. In this case, even though
f(−1) = f(1), there is no point inside the interval where the derivative vanishes.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

506
CHAPTER 11. APPENDIX
Exercise 124, page 31
In preparation . . .
Exercise 125, page 31
Use Rolle’s theorem to show that if x1 and x2 are distinct solutions of p(x) = 0, then between them is a solution of
p′(x) = 0.
Exercise 126, page 31
In preparation . . .
Exercise 127, page 31
Use Rolle’s theorem twice. See Exercise 129 for another variant on the same theme.
Exercise 128, page 31
Since f is continuous we already know (look it up) that f maps [a,b] to some closed, bounded interval [c,d]. Use Rolle’s
theorem to show that there cannot be two values in [a,b] mapping to the same point.
Exercise 129, page 32
cf. Exercise 127.
Exercise 130, page 32
We prove this theorem by subtracting from f a function whose graph is the straight line determined by the chord in
question and then applying Rolle’s theorem. Let
L(x) = f(a)+ f(b)−f(a)
b−a
(x−a).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
507
We see that L(a) = f(a) and L(b) = f(b). Now let
g(x) = f(x)−L(x).
(11.1)
Then g is continuous on [a,b], differentiable on (a,b) , and satisﬁes the condition g(a) = g(b) = 0.
By Rolle’s theorem, there exists c ∈(a,b) such that g′(c) = 0. Differentiating (11.1), we see that f ′(c) = L′(c). But
L′(c) = f(b)−f(a)
b−a
,
so
f ′(c) = f(b)−f(a)
b−a
,
as was to be proved.
Exercise 131, page 33
The ﬁrst statement is just the mean-value theorem applied to every subinterval. For the second statement, note that an
increasing function f would allow only positive numbers in S. But increasing functions may have zero derivatives (e.g.,
f(x) = x3).
Exercise 132, page 33
If t, measured in hours, starts at time t = 0 and advances to time t = 2 then
s′(τ) = s(2)−s(1)
2
= 100/2
at some point τ in time between starting and ﬁnishing.
Exercise 133, page 33
The mean-value theorem includes Rolle’s theorem as a special case. So our previous example f(x) =
p
|x| which fails
to have a derivative at the point x0 = 0 does not satisfy the hypotheses of the mean-value theorem and the conclusion, as
we noted earlier, fails.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

508
CHAPTER 11. APPENDIX
Exercise 134, page 33
Take any example where the mean-value theorem can be applied and then just change the values of the function at the
endpoints.
Exercise 135, page 33
Apply the mean-value theorem to f on the interval [x,x+a] to obtain a point ξ in [x,x+a] with
f(x+a)−f(x) = a f ′(ξ).
Exercise 136, page 34
Use the mean-value theorem to compute
lim
x→a+
f(x)−f(a)
x−a
.
Exercise 137, page 34
This is just a variant on Exercise 136. Show that under these assumptions f ′ is continuous at x0.
Exercise 138, page 34
Use the mean-value theorem to relate
∞
∑
i=1
(f(i+1)−f(i))
to
∞
∑
i=1
f ′(i).
Note that f is increasing and treat the former series as a telescoping series.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
509
Exercise 139, page 34
The proof of the mean-value theorem was obtained by applying Rolle’s theorem to the function
g(x) = f(x)−f(a)−f(b)−f(a)
b−a
(x−a).
For this mean-value theorem apply Rolle’s theorem twice to a function of the form
h(x) = f(x)−f(a)−f ′(a)(x−a)−α(x−a)2
for an appropriate number α.
Exercise 140, page 34
In preparation . . .
Exercise 141, page 35
Write
f(x+h)+ f(x−h)−2 f(x) =
[ f(x+h)−f(x)]+[f(x−h)−f(x)]
and apply the mean-value theorem to each term.
Exercise 142, page 35
Let
φ(x) = [ f(b)−f(a)]g(x)−[g(b)−g(a)]f(x).
Then φ is continuous on [a,b] and differentiable on (a,b) . Furthermore,
φ(a) = f(b)g(a)−f(a)g(b) = φ(b).
By Rolle’s theorem, there exists ξ ∈(a,b) for which φ′(ξ) = 0. It is clear that this point ξ satisﬁes
[ f(b)−f(a)]g′(ξ) = [g(b)−g(a)]f ′(ξ).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

510
CHAPTER 11. APPENDIX
Exercise 143, page 35
We can interpret the mean-value theorem as applied to curves given parametrically. Suppose f and g are uniformly
continuous on [a,b] and differentiable on (a,b). Consider the curve given parametrically by
x = g(t),
y = f(t)
(t ∈[a,b]).
As t varies over the interval [a,b], the point (x,y) traces out a curve C joining the points (g(a), f(a)) and (g(b), f(b)). If
g(a) ̸= g(b), the slope of the chord determined by these points is
f(b)−f(a)
g(b)−g(a) .
Cauchy’s form of the mean-value theorem asserts that there is a point (x,y) on C at which the tangent is parallel to the
chord in question.
Exercise 144, page 35
In its simplest form, l’Hôpital’s rule states that for functions f and g, if
lim
x→c f(x) = lim
x→cg(x) = 0
and
lim
x→c f ′(x)/g′(x)
exists, then
lim
x→c
f(x)
g(x) = lim
x→c
f ′(x)
g′(x).
You can use Cauchy’s mean-value theorem to prove this simple version. Make sure to state your assumptions to match
up to the situation in the statement of Cauchy’s mean-value theorem.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
511
Exercise 145, page 35
Just expand the determinant.
Exercise 146, page 35
Let φ(x) be
¯¯¯¯¯¯
f(a)
g(a)
h(a)
f(b)
g(b)
h(b)
f(x)
g(x)
h(x)
¯¯¯¯¯¯
and imitate the proof of Theorem 142.
Exercise 147, page 36
By the mean-value theorem
f(c)−f(b)
c−b
= f ′(ξ1) ≥f ′(ξ2) = f(b)−f(a)
b−a
for some points a < ξ1 < b < ξ2 < c. The rest is just elementary algebra.
Note that we should be able to conclude even more if the derivative is strictly increasing since then
f(c)−f(b)
c−b
= f ′(ξ1) > f ′(ξ2) = f(b)−f(a)
b−a
.
Exercise 148, page 36
From Lipman Bers, Classroom Notes: On Avoiding the Mean Value Theorem, Amer. Math. Monthly 74 (1967), no. 5,
583.
It is hard to agree with this eminent mathematician that students should avoid the mean-value theorem, but (perhaps)
for some elementary classes this is reasonable. Here is his proof:
“This is intuitively obvious and easy to prove. Indeed, assume that there is a p, a < p < b, such that the set
S of all x, a < x < p, with f(x) ≥f(p) is not empty. Set q = supS; since f ′(p) > 0 we have a < q < p. If
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

512
CHAPTER 11. APPENDIX
f(q) ≥f(p), then since f ′(q) > 0, there are points of S to the right of q. If f(q) < f(p), then q is not in S
and, by continuity, there are no points of S near and to the left of q. Contradiction.
. . . The “full" mean value theorem, for differentiable but not continuously differentiable functions is a cu-
riosity. It may be discussed together with another curiosity, Darboux’ theorem that every derivative obeys
the intermediate value theorem.”
Exercise 149, page 36
From Howard Levi, Classroom Notes: Integration, Anti-Differentiation and a Converse to the Mean Value Theorem,
Amer. Math. Monthly 74 (1967), no. 5, 585–586.
Exercise 150, page 36
If there are no exceptional points then the usual mean-value theorem does the job. If, say, there is only one point c inside
where f ′(c) does not exist then apply the mean-value theorem on both of the intervals [a,c] and [c,b] to get two points
ξ1 and ξ2 so that
f(c)−f(a)
c−a
= f ′(ξ1)
and
f(b)−f(c)
b−c
= f ′(ξ2).
Then
| f(b)−f(a)| ≤(c−a)|f ′(ξ1)|+(b−c)|f ′(ξ2)| ≤M(b−a)
where for M we just choose whichever is larger, | f ′(ξ1)| or | f ′(ξ1)|. A similar proof will handle more exceptional points.
For a method of proof that does not invoke the mean-value theorem see Israel Halperin, Classroom Notes: A Funda-
mental Theorem of the Calculus, Amer. Math. Monthly 61 (1954), no. 2, 122–123.
Exercise 151, page 37
This simple theorem ﬁrst appears in T. Flett, A mean value theorem, Math. Gazette (1958), 42, 38–39.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
513
We can assume that f ′(a) = f ′(b) = 0 [otherwise work with f(x) −f ′(a)x]. Consider the function g(x) deﬁned to
be [ f(x)−f(a)]/[x−a] for x ̸= a and f ′(a) at x = a. We compute that
g′(x) = −f(x)−f(a)
(x−a))2
+ f ′(x)
x−a = −g(x)
x−a + f ′(x)
x−a.
Evidently to prove the theorem is to prove that g′ has a zero in (a,b). Check that such a zero will solve the problem.
To get the zero of g′ ﬁrst consider whether g(a) = g(b). If so then Rolle’s theorem does the job. If, instead,
g(b) > g(a) then
g′(b) = −g(b)
b−a < 0.
Thus g is locally decreasing at b. There would then have to be at least one point x1 for which g(x1) > g(b) > g(a). The
Darboux property of the continuous function g will supply a point x0 at which g(x0) = g(b). Apply Rolle’s theorem to
ﬁnd that g′ has a zero in (x0,b). Finally, if g(b) < g(a), then an identical argument should produce the same result.
Exercise 152, page 37
Repeat the arguments for Rolle’s theorem with these new hypotheses. Then just take any γ between F′(a) and F′(b) and
write G(x) = F(x)−γx. If F′(a) < γ < F′(b), then G′(a) = F′(a)−γ < 0 and G′(b) = F′(b)−γ > 0. This shows then
that there is a point ξ ∈(a,b) such that G′(ξ) = 0. For this ξ we have
F′(ξ) = G′(ξ)+γ = γ,
completing the proof for the case F′(a) < F′(b). The proof when F′(a) > F′(b) is similar.
Exercise 153, page 37
If F′ is continuous, then it is easy to check that Eα is closed. In the opposite direction suppose that every Eα is closed
and F′ is not continuous. Then show that there must be a number β and a sequence of points {xn} converging to a point
z and yet f ′(xn) ≥β and f ′(z) < β. Apply the Darboux property of the derivative to show that this cannot happen if Eβ
is closed. Deduce that F′ is continuous.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

514
CHAPTER 11. APPENDIX
Exercise 154, page 37
Polynomials have continuous derivatives and only ﬁnitely many points where the value is zero. Let p(x) be a polynomial.
Then p′(x) is also a polynomial. Collect all the points c1, c2, . . . , cp where p′(x) = 0. In between these points, the value
of the derivative is either always positive or always negative otherwise the Darboux property of p′ would be violated.
On those intervals the function is decreasing or increasing.
Exercise 155, page 38
Take any point a < x ≤b and, applying the mean-value theorem on the interval [a,x], we obtain that
|F(x)−F(a)| = F′(ξ)(x−a) = 0(x−a) = 0.
Consequently F(x) = F(a) for all a < x ≤b. Thus F is constant.
Exercise 156, page 38
In Exercise 148 we established (without the mean-value theorem) that a function with a positive derivative is increasing.
Now we assume that F′(x) = 0 everywhere in the interval (a,b). Consequently, for any integer n, the functions
G(x) = F(x)+x/n and H(x) = x/n−F(x) both have a positive derivative and are therefore increasing. In particular, if
x < y, then
H(x) < H(y) and G(x) < G(y)
so that
−(y−x)/n < F(y)−F(x) < (y−x)/n
would be true for all n = 1,2,3,.... This is only possible if F(y) = F(x).
Exercise 157, page 38
We wish to prove that, if F : I →R is deﬁned at each point of an open interval I and F′(x) = 0 for every x ∈I, then F is
a constant function on I. On every closed subinterval [a,b] ⊂I the theorem can be applied. Thus f is a constant on the
whole interval I. If not then we could ﬁnd at least two different points x1 and x2 with f(x1) ̸= f(x2). But then we already
know that f is constant on the interval [x1,x2] (or, rather on the interval [x2,x1] if x2 < x1).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
515
Exercise 158, page 38
Take any points c < d from the interval [a,b] in such a way that (c,d) contains no one of these exceptional points.
Consider the closed, bounded interval [c,d] ⊂[a,b]. An application of the mean-value theorem to this smaller interval
shows that
F(d)−F(c) = F′(ξ)(d −c) = 0
for some point c < ξ < d. Thus F(c) = F(d).
Now take any two points a ≤x1 < x2 ≤b and ﬁnd all the exceptional points between them: say x1 < c1 < c2 < ··· <
cn < x2. On each interval [x1,c1], [c1,c2], . . . , [cn,x2] we have (by what we just proved) that
F(x1) = F(c1], F(c1) = F(c2), ...,F(cn) = F(x2).
Thus F(x1) = F(x2). This is true for any pair of points from the interval [a,b] and so the function is constant.
Exercise 160, page 38
Take any points c and x inside the interval and consider the intervals [x,c] or [c,x]. Apply the theorem to determine that
F must be constant on any such interval. Consequently F(x) = F(c) for all a < x < b.
Exercise 161, page 39
This looks obvious but be a little bit careful with the exceptional set of points x where F′(x) ̸= G′(x).
If F′(x) = f(x) for every a < x < b except for points in the ﬁnite set C1 and G′(x) = f(x) for every a < x < b except
for points in the ﬁnite set C2, then the function H(x) = F(x)−G(x) is uniformly continuous on [a.b] and H′(x) = 0 for
every a < x < b with the possible exception of points in the ﬁnite set C1 ∪C2. By the theorem H is a constant.
Exercise 162, page 39
According to the theorem such a function would have to be discontinuous. Any step function will do here.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

516
CHAPTER 11. APPENDIX
Exercise 163, page 39
Let ε > 0. At every point x0 in the interval (a,b) at which F′(x0) = 0 we can choose a δ(x0) > 0 so that
|F(y)−F(z)| ≤ε|y−z|
for x0 −δ(x0) < z ≤x0 ≤y < x0 +δ(x0). At the remaining points a, b, c1, c2, c3, . . . we choose δ(·) so that:
ω(F,[a,a+δ(a)]) < ε
2,
ω(F,[b−δ(b),b]) < ε
4,
and
ω(F,[c j −δ(cj),c j −δ(cj)]) <
ε
2 j+2
for j = 1,2,3,.... This merely uses the continuity of f at each of these points.
Take any subinterval [c,d] ⊂[a,b]. By the Cousin covering argument there is a partition
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
of the whole interval [c,d] such that
ξi ∈[xi−1,xi] and xi −xi−1 < δ(ξi).
For this partition
|F(d)−F(c)| ≤
n
∑
i=1
|F(xi)−F(xi−1)| ≤ε(d −c)+
∞
∑
j=1
ε
2 j = ε(d −c+1).
This is possible only if |F(d) −F(c)| = 0. Since this applies to any such interval [c,d] ⊂[a,b] the function must be
constant.
Exercise 164, page 39
According to Theorem 1.31 this will be proved if it is possible to write the rational numbers (where F′(x) is not known)
as a sequence. This is well-known. To try it on your own. Start off
1/1,−1/1,1/2,−1/2,2/1,−2/1,3/1,−3/1,1/3,−1/3,...
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
517
and describe a listing process that will ultimately include all rational numbers m/n.
Exercise 165, page 39
Apply Exercise 164 to the function F(x) = G(x)−x2/2. Since F is constant, G(x) = x2/2+C for some constant C.
Exercise 166, page 39
This looks like an immediate consequence of Theorem 1.31, but we need to be slightly careful about the exceptional
sequence of points.
If F′(x) = f(x) for every a < x < b except for points in the a sequence {c1,c2,c3,...} and G′(x) = f(x) for every
a < x < b except for points in the sequence {d1,d2,d3,...}, then the function H(x) = F(x) −G(x) is uniformly con-
tinuous on [a.b] and H′(x) = 0 for every a < x < b with the possible exception of points in the combined sequence
{c1,d1,c2,d2,c3,d3,...}. By Theorem 1.31, the function H is a constant.
Exercise 168, page 40
First show directly from the deﬁnition that the Lipschitz condition will imply a bounded derivative. Then use the mean-
value theorem to get the converse, that is, apply the mean-value theorem to f on the interval [x,y] for any a ≤x < y ≤b.
Exercise 169, page 40
The derivative of f(x) = √x = x1/2 is the function f ′(x) = x1/2/2 which exists but is not bounded on (0,1).
Exercise 170, page 40
One direction is easy. If F is Lipschitz then, for some number M,
| f(x)−f(y)| ≤M|x−y|
for all x, y in the interval. In particular¯¯¯¯
F(x+h)−F(x)
h
¯¯¯¯ ≤
¯¯¯¯
M|(x+h)−x|
h
¯¯¯¯ = M.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

518
CHAPTER 11. APPENDIX
The other direction will take a more sophisticated argument. At each point x0 choose a δ(x0) > 0 so that
¯¯¯¯
F(x0 +h)−F(x)
h
¯¯¯¯ ≤M
whenever x0 +h ∈I and |h| < δ(x0). Note that, then,
¯¯¯¯
F(y)−F(z)
y−z
¯¯¯¯ ≤M
for x0 −δ(x0) < z ≤x0 ≤y < x0 +δ(x0). Take any subinterval [c,d] ⊂[a,b]. By the Cousin partitioning argument there
is a partition
{([xi−1,xi],ξi) : i = 1,2,3,...,n}
of the whole interval [c,d] such that
ξi ∈[xi−1,xi] and xi −xi−1 < δ(ξi).
For this partition
|F(d)−F(c)| ≤
n
∑
i=1
|F(xi)−F(xi−1)| ≤
n
∑
i=1
M|xi −xi−1| = M(d −c).
Thus F is Lipschitz.
Exercise 171, page 40
In preparation . . .
Exercise 172, page 40
In preparation . . .
Exercise 173, page 40
Yes on any interval (a,∞) if a > 0 but not on (0,∞).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
519
Exercise 174, page 41
Yes. This is a simple example of a nondifferentiable Lipschitz function, but note that there is only one point of nondif-
ferentiability.
Exercise 177, page 41
From the inequality
¯¯¯¯
F(y)−F(x)
y−x
¯¯¯¯ ≤M|y−x|
deduce that F′(x) = 0 everywhere.
Exercise 179, page 41
Find an example illustrating that the ﬁrst condition can hold without the second condition holding for any value of
K < 1.
Exercise 180, page 41
Yes if all the functions F1, F2, F3, . . . have the same Lipschitz constant. But, in general, not otherwise.
This is just a simple consequence of the theory of sequence limits and how they behave with inequalities. If we
suppose that x < y and that
−M(y−x) ≤Fn(y)−Fn(x) ≤M(y−x)
for all n = 1,2,3,..., then
−M(y−x) ≤lim
n→∞[Fn(y)−Fn(x)] ≤M(y−x)
must be true.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

520
CHAPTER 11. APPENDIX
Exercise 181, page 44
By the deﬁnition, it is indeed an indeﬁnite integral for F′ except that we require all indeﬁnite integrals to be continuous.
But then we recall that a function is continuous at all points where the derivative exists. So, ﬁnally, yes.
Exercise 182, page 44
No. There may be ﬁnitely many points where f(x) is not deﬁned, and even if f(x) has been assigned a value there may
still be ﬁnitely many points where F′(x) = f(x) fails.
Exercise 183, page 44
Exercise 161 is almost identical except that it is stated for two uniformly continuous functions F and G on closed,
bounded intervals [a,b]. Here (a,b) is open and need not be bounded. But you can apply Exercise 161 to any closed,
bounded subinterval of (a,b).
Exercise 184, page 46
The two functions F(x) = x and G(x) = 1/x are continuous on (0,1) but G is not uniformly continuous. [It is unbounded
and any uniformly continuous function on (0,1) would have to be bounded.] Thus the two functions f(x) = F′(x) = 1
and g(x) = G′(x) = −1/x2 both possess indeﬁnite integrals on the interval (0,1) so that, of the two indeﬁnite integrals
F is uniformly continuous and the other G is not.
Exercise 185, page 46
The mean-value theorem supplies this on any subinterval [c,d] on which F is differentiable; the proof thus requires
handling the ﬁnite exceptional set. Let M be larger than the values of | f(x)| at points where F′(x) = f(x). Fix x < y in
the interval and split the interval at all the points where the derivative F′ might not exist:
a < x < c1 < c2 < ··· < cn < y < b.
The mean-value theorem supplies that
|F(t)−F(s)| ≤M|s−t|
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
521
on any interval [s,t] for which (s,t) misses all the points of the subdivision. But adding these together we ﬁnd that
|F(t)−F(s)| ≤M|s−t|
on any interval [s,t] ⊂[x,y]. But x and y are completely arbitrary so that
|F(t)−F(s)| ≤M|s−t|
on any interval [s,t] ⊂(a,b).
We already know that if a function is Lipschitz on (a,b) then it is uniformly continuous on (a,b).
Exercise 186, page 47
It is true that the derivative of x3/3+1 is indeed x2 at every point x. So, provided you also specify the interval in question
[here (−∞,∞) will do] then the function F(x) = x3/3+1 is one possible indeﬁnite integral of f(x) = x2. But there are
others and the symbol
R x2 dx is intended to represent all of them.
Exercise 187, page 47
As we know
(x+1)2 = x2 +2x+1.
The two functions (x+1)2 and x2 +2x+1 differ by a constant (in this case the constant 1). In situations like this it is far
better to write
Z
(2x+1)dx = (x+1)2 +C1
and
Z
(2x+1)dx = (x2 +2x)+C2
whereC1 andC2 represent arbitrary constants. Then one won’t be using the same letter to represent two different objects.
Exercise 188, page 47
Show that F is an indeﬁnite integral of f(x) = x2 on (0,1) in this stupid sense if and only if there are three numbers, C1,
C2, and C3 with 0 < C1 < 1 such that F(x) = x3/3+C2 on (0,C1) and F(x) = x3/3+C3 on (C1,1).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

522
CHAPTER 11. APPENDIX
Exercise 189, page 48
By a direct computation
Z 1
x dx = log|x|+C
on any open interval I for which 0 ̸∈I. The function F(x) = log|x| is a continuous indeﬁnite integral on such an interval
I. It cannot be extended to a continuous function on [0,1] [say] because it is not uniformly continuous. (This is easy to
see because uniformly continuous functions are bounded.
The fact that f(0) = 1/0 is undeﬁned is entirely irrelevant. In order for a function to have an indeﬁnite integral [in
the calculus sense of this chapter] it is permitted to have ﬁnitely many points where it is undeﬁned. See the next exercise
where f(x) = 1/
p
|x| which is also undeﬁned at x = 0 but does have an indeﬁnite integral.
Exercise 190, page 48
By a direct computation the function F(x) = 2√x for x ≥0 and F(x) = −2√−x for x < 0 has F′(x) = f(x) at every
point with the single exception of x = 0. Check that this function is continuous everywhere. This is immediate at points
where F is differentiable, so it is only at x = 0 that one needs to check continuity.
Once again, the fact that f(0) is undeﬁned plays no role in the discussion since this function is deﬁned everywhere
else.
Exercise 191, page 48
None of them are correct because no interval is speciﬁed. The correct versions would be
Z 1
x dx = logx+C on (0,∞)
or
Z 1
x dx = log(−x)+C on (−∞,0)
or
Z 1
x dx = log|x|+C on (0,∞) or on (0,∞).
You may use subintervals, but we know by now that there are no larger intervals possible.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
523
Exercise 192, page 49
The maximum value of f in each of the intervals [0, 1
4], [ 1
4, 1
2], [ 1
2, 3
4], and [ 3
4,1] is 1/8, 1/4, 9/16, and 1 respectively.
Thus deﬁne F to be x/8 in the ﬁrst interval, 1/32+1/4(x−1/1/4) in the second interval, 1/32+1/16+9/16(x−1/2)
in the third interval, and to be 1/32+1/16+9/64+(x−3/4) in the ﬁnal interval. This should be (if the arithmetic was
correct) a continuous, piecewise linear function whose slope in each segment exceeds the value of the function f.
Exercise 193, page 49
Start at 0 and ﬁrst of all work to the right. On the interval (0,1) the function f has the constant value 1. So deﬁne
F(x) = x on [0,1]. Then on the the interval (1,2) the function f has the constant value 2. So deﬁne F(x) = 1+2(x−1)
on [1,2]. Continue until you see how to describe F in general. This is the same construction we used for upper functions.
Exercise 194, page 51
Let F0 denote the function on [0,1] that has F0(0) = 0 and has constant slope equal to
c01 = sup{ f(t) : 0 < t < 1}.
Subdivide [0,1] into [0, 1
2] and [ 1
2,1] and let F1 denote the continuous, piecewise linear function on [0,1] that has F0(0) = 0
and has constant slope equal to
c11 = sup{ f(t) : 0 < t ≤1
2}
on [0, 1
2] and constant slope equal to
c12 = sup{ f(t) : 1
2 ≤t < 1}
on [0, 1
2]. This construction is continued. For example, at the next stage, Subdivide [0,1] further into [0, 1
4], [ 1
4, 1
2], [ 1
2, 3
4],
and [ 3
4,1]. Let F2 denote the continuous, piecewise linear function on [0,1] that has F0(0) = 0 and has constant slope
equal to
c11 = sup{ f(t) : 0 < t ≤1
4}
on [0, 1
4], constant slope equal to
c12 = sup{ f(t) : 1
4 ≤t ≤1
2}
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

524
CHAPTER 11. APPENDIX
on [ 1
4, 1
2], constant slope equal to
c13 = sup{ f(t) : 1
2 ≤t ≤3
4}
on [ 1
2, 3
4], and constant slope equal to
c14 = sup{ f(t) : 3
4 ≤t < 1}
on [ 3
4,1].
In this way we construct a sequence of such functions {Fn}. Note that each Fn is continuous and nondecreasing.
Moreover a look at the geometry reveals that
Fn(x) ≥Fn+1(x)
for all 0 ≤x ≤1 and all n = 0, 1, 2, . . . . In particular {Fn(x)} is a nonincreasing sequence of nonnegative numbers and
consequently
F(x) = lim
n→∞Fn(x)
exists for all 0 ≤x ≤1. We prove that F′(x) = f(x) at all points x in (0,1) at which the function f is continuous.
Fix a point x in (0,1) at which f is assumed to be continuous and let ε > 0. Choose δ > 0 so that the oscillation3
ω f([x−2δ,x+2δ])
of f on the interval [x−2δ,x+2δ] does not exceed ε. Let h be ﬁxed so that 0 < h < δ. Choose an integer N sufﬁciently
large that
|FN(x)−F(x)| < εh and |FN(x+h)−F(x+h)| < εh.
From the geometry of our construction notice that the inequality
|FN(x+h)−FN(x)−f(x)h| ≤hω f([x−2h,x+2h]),
must hold for large enough N. (Simply observe that the graph of FN will be composed of line segments, each of whose
slopes differ from f(x) by no more than the number ω f([x−2h,x+2h]).)
Putting these inequalities together we ﬁnd that
|F(x+h)−F(x)−f(x)h| ≤
|FN(x+h)−Fn(x)−f(x)h|+|FN(x)−F(x)|+|FN(x+h)−F(x+h)| < 3εh.
3See Exercise 61.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
525
This shows that the right-hand derivative of F at x must be exactly f(x). A similar argument will handle the left-hand
derivative and we have veriﬁed the statement in the theorem about the derivative.
The reader should now check that the function F deﬁned here is Lipschitz on [0,1]. Let M be an upper bound for the
function f. Check, ﬁrst, that
0 ≤Fn(y)−Fn(x) ≤M(y−x)
for all x < y in [0,1]. Deduce that F is in fact Lipschitz on [0,1].
Exercise 195, page 51
If H(t) = G(a+t(b−a)) then, by the chain rule,
H′(t) = G′(a+t(b−a))×(b−a) = f(a+t(b−a))×(b−a).
Substitute x = a+t(b−a) for each 0 ≤t ≤1.
Exercise 196, page 51
If G′(t) = g(t) then d
dt (G(t)+Kt) = g(t)+K = f(t).
Exercise 197, page 51
The assumption that f is continuous on an interval (a,b) means that f must be uniformly continuous on any closed
subinterval [c,d] ⊂(a,b). Such functions are bounded. Applying the theorem gives a continuous function with F′(x) =
f(x) everywhere on that interval. This will construct our indeﬁnite integral on (a,b). Note that F will be Lipschitz on
every subinterval [c,d] ⊂(a,b) but need not be Lipschitz on (a,b), because we have not assumed that f is bounded on
(a,b).
Exercise 198, page 52
You need merely to show that H is continuous on the interval and that H′(x) = r f(x)+sg(x) at all but ﬁnitely many points
in the interval. But both F and G are continuous on that interval and so we need to recall that the sum of continuous
functions is again continuous.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

526
CHAPTER 11. APPENDIX
Finally we know that F′(x) = f(x) for all x in I except for a ﬁnite set C1, and we know that G′(x) = g(x) for all x in
I except for a ﬁnite set C2. It follows, by properties of derivatives, that
H′(x) = rF′(x)+sG′(x) = r f(x)+sg(x)
at all points x in I that are not in the ﬁnite set C1 ∪C2.
Exercise 199, page 52
If F and G both have a derivative at a point x then we know, from the product rule for derivatives, that
d
dx[F(x)G(x)] = F′(x)G(x)+F(x)G′(x)
Thus, let us suppose that F′(x)G(x) has an indeﬁnite integral H(x) on some interval I. Then H is continuous on I and
H′(x) = F′(x)G(x) at all but ﬁnitely many points of I. Notice then that
K(x) = F(x)G(x)−H(x)
satisﬁes (at points where derivatives exist)
K′(x) = F′(x)G(x)+F(x)G′(x)−F′(x)G(x) = F(x)G′(x).
Thus
Z
F(x)G′(x)dx = K(x)+C = F(x)G(x)−H(x)+C = F(x)G(x)−
Z
F′(x)G(x)dx.
Exercise 200, page 53
One memorizes (as a calculus student) the formula
Z
udv = uv−
Z
vdu.
and makes appropriate substitutions. For example to determine
R xcosxdx use u = x, v = cosxdx, determine du = dx
and determine v = sinx [or v = sinx+1 for example]. Then substitute in the memorized formula to obtain
Z
xcosxdx =
Z
udv = uv−
Z
vdu = xsinx−
Z
sinxdx = xsinx+cosx+C.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
527
or [if you had used v = sinx+1 instead]
Z
xcosxdx = x(sinx+1)−
Z
(sinx+1)dx = xsinx+cosx+C.
Exercise 201, page 53
If you need more [you are a masochist] then you can ﬁnd them on the web where we found these. The only reason to
spend much further time is if you are shortly to face a calculus exam where some such computation will be required. If
you are an advanced student it is enough to remember that “integration by parts” is merely the product rule for derivatives
applied to indeﬁnite or deﬁnite integration.
There is one thing to keep in mind as a calculus student preparing for questions that exploit integration by parts. An
integral can be often split up into many different ways using the substitutions of integration by parts: u = f(x), dv =
g′(x)dx, v = g(x) and du = f ′(x)dx. You can do any such problem by trial-and-error and just abandon any unpromising
direction. If you care to think in advance about how best to choose the substitution, choose u = f(x) only for functions
f(x) that you would care to differentiate and choose dv = g′(x)dx only for functions you would care to integrate.
Exercise 202, page 54
In most calculus courses the rule would be applied only in situations where both functions F and G are everywhere
differentiable. For our calculus integral we have been encouraged to permit ﬁnitely many exceptional points and to insist
then that our indeﬁnite integrals are continuous.
That does not work here: let F(x) = |x| and G(x) = x2 sinx−1, G(0) = 0. Then G is differentiable everywhere and
F is continuous with only one point of nondifferentiability. But F(G(x) = |x2 sinx−1| is not differentiable at any point
x = ±1/π, ±1/2π, ±1/3π, . . . . Thus F(G(x) is not an indeﬁnite integral in the calculus sense for F′(G(x)) on any open
interval that contains zero and indeed F′(G(x)) would have inﬁnitely many points where it is undeﬁned. This function
is integrable on any open interval that avoids zero.
This should be considered a limitation of the calculus integral. This is basically an 18th century integral that we are
using for teaching purposes. If we allow inﬁnite exceptional sets [as we do in the later integration chapters] then the
change of variable rule will hold in great generality.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

528
CHAPTER 11. APPENDIX
Exercise 203, page 54
To be precise we should specify an open interval; (−∞,∞) will do. To verify the answer itself, just compute
d
dx
½1
2 sin(x2 +1)
¾
= cos(x2 +1).
To verify the steps of the procedure just notice that the substitution u = x2 +1, du = 2xdx is legitimate on this interval.
Exercise 204, page 54
It would be expected that you have had sufﬁcient experience solving similar problems to realize that integration by parts
or other methods will fail but that a change of variable will succeed. The only choices likely in such a simple integral
would be u = x2 or perhaps v = ex2. The former leads to
Z
xex2 dx = 1
2
Z
eu du = 1
2eu +C = ex2 +C
[u = x2]
since if u = x2 then du = 2xdx; the latter leads to
Z
xex2 dx = 2
Z
v
p
logvdv = ?
[v = ex2]
since if v = ex2 then x2 = logv, x = √logv and dv = 2xex2 dx = 2v√logv.
Note that a wrong choice of substitution may lead to an entirely correct result which does not accord with the
instructors “expectation.” Usually calculus instructors will select examples that are sufﬁciently transparent that the
correct choice of substitution is immediate. Better yet, they might provide the substitution that they require and ask you
to carry it out.
Finally all these computations are valid everywhere so we should state our ﬁnal result on the interval (−∞,∞). Most
calculus instructors, however, would not mark you incorrect if you failed to notice this.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
529
Exercise 205, page 54
Assuming that r ̸= 0 (in which case we are integrating a constant function), use the substitution u = rx+s, du = rdx to
obtain
Z
f(rx+s)dx = 1
r
Z
f(u)du = F(u)+C = F(rs+x)+C.
This is a linear change of variables and is the most common change of variable in numerous situations.
This can be justiﬁed in more detail this way. Suppose that
R f(t)dx = F(t)+C on an open interval I, meaning that F
is continuous and F′(t) = f(t) on I with possibly ﬁnitely many exceptions. Then ﬁnd an open interval J so that rx+s ∈I
for all x ∈J. It follows that F(rx + s) is continuous on J and that d
dxF(rx + s) = f(rx + s) again with possibly ﬁnitely
many exceptions. On J then F(rx+s) is an indeﬁnite integral for f(rx+s).
Exercise 206, page 55
This is an exercise in derivatives. Suppose that f : (a,b) →R has an indeﬁnite integral F on the interval (a,b). Let ξ be
a point of continuity of f. We can suppose that ξ in contained in a subinterval (c,d) ⊂(a,b) inside which F′(x) = f(x)
for all points, except possibly at the point ξ in question.
Let ε > 0. Then, since f is continuous at ξ, there is an interval [ξ−δ(ξ),ξ+δ(ξ)] so that
f(ξ)−ε < f(x) < f(ξ)+ε
on that interval. For any u < ξ < v in this smaller interval
(f(ξ)−ε)(ξ−u) ≤F(ξ)−F(u)
and
(f(ξ)+ε)(v−ξ) ≥F(v)−F(ξ).
This is because the function F is continuous on [u,ξ] and [ξ,v] and has a derivative larger than (f(ξ)−ε) on (u,ξ) and
a derivative smaller than (f(ξ) + ε) on (ξ,v). Together these inequalities prove that, for any u ≤ξ ≤v, u ̸= v on the
interval (ξ−δ(ξ),ξ+δ(ξ)) the inequality
¯¯¯¯
F(v)−F(u)
v−u
−f(ξ)
¯¯¯¯ ≤ε
must be valid. But this says that F′(ξ) = f(ξ).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

530
CHAPTER 11. APPENDIX
Exercise 207, page 57
In fact this is particularly sloppy. The function log(x −8) is deﬁned only for x > 8 while log(x +5) is deﬁned only for
x > −5. Thus an appropriate interval for the expression given here would be (8,∞). But it is also true that
Z
x+3
x2 −3x−40 dx = [11/13]log(|x−8|)+[2/13]log(|x+5|)+C
on any open interval that does not contain either of the points x = 8 or x = −5. For example, on the interval (−5,8), the
following is valid:
Z
x+3
x2 −3x−40 dx = [11/13]log(8−x)+[2/13]log(x+5)+C.
You might even prefer to write
Z
x+3
x2 −3x−40 dx = 1
13 log
©
(8−x)11(x+5)2ª
+C.
Exercise 208, page 62
Find the necessary statements from Chapter 1 from which this can be concluded.
Exercise 209, page 64
Let us just do the inﬁnite integral. If
R ∞
−∞f(x)dx exists then there is an indeﬁnite integral F on (−∞,∞) and both F(∞)
and F(∞) exist. By deﬁnition
Z ∞
a
f(x)dx = F(∞)−F(a),
Z b
−∞f(x)dx = F(b)−F(−∞)
and
Z b
a f(x)dx = F(b)−F(a)
must all exist.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
531
Exercise 210, page 64
Let us do the additivity formula for the inﬁnite integral. If
R ∞
−∞f(x)dx exists then there is an indeﬁnite integral F on
(−∞,∞) and both F(∞) and F(∞) exist. By deﬁnition
Z ∞
−∞f(x)dx = F(∞)−F(−∞) = [F(∞)−F(b)]+[F(b)−F(a)]+[F(a)−F(−∞)] =
Z a
−∞f(x)dx+
Z b
a f(x)dx+
Z ∞
b
f(x)dx.
Any other additivity formula can be proved the same way.
The theorem requires proving another observation. If we know that the integral exists on two abutting intervals then
we must check that it exists on the union. Here is the method. If
Z a
−∞f(x)dx and
Z ∞
a
f(x)dx
both exist then select indeﬁnite integrals F on (−∞,a] and G on [a,∞). Deﬁne H(x) = F(x) for x ≤a and H(x) =
G(x)−G(a)+F(a) for x > a. Then H is continuous and must therefore be an indeﬁnite integral for f on (−∞,∞). We
need to know that the limiting values H(−∞) and H(∞) both exist. But H(−∞) = F(−∞) and H(∞) = G(∞). Thus the
integral
Z ∞
−∞f(x)dx
must exist.
Exercise 211, page 64
We suppose that the two functions f, g are both integrable on a closed, bounded interval [a,b] and that f(x) ≤g(x) for
all x ∈[a,b]. We can If F is an indeﬁnite integral for f on [a,b] and G is an indeﬁnite integral for g on [a,b] then set
H(x) = G(x)−F(x) and notice that
d
dxH(x) = d
dx[G(x)−F(x)] ≥g(x)−f(x) ≥0
except possibly at the ﬁnitely many points where the derivative does not have to agree with the function. But we know
that continuous functions with nonnegative derivatives are nondecreasing; the ﬁnite number of exceptions does not matter
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

532
CHAPTER 11. APPENDIX
for this statement. Thus H(b)−H(a) ≥0 and so [G(b)−G(a)]−[F(b)−F(a)] ≥0. Consequently
Z b
a f(x)dx = [F(b)−F(a)] ≤[G(b)−G(a)] =
Z b
a g(x)dx.
The details are similar for inﬁnite integrals.
Exercise 212, page 64
We know that
Z
x2 dx = x3/3+C
on any interval. So that, in fact, using [for example] the function F(x) = x3/3+1 as an indeﬁnite integral,
Z 2
−1 x2 dx = F(2)−F(−1) = [23/3+1]−[(−1)3/3+1] = 3.
Exercise 213, page 64
We know that
Z dx
x = log|x|+C
on (0,∞) and on (−∞,0).
In particular we do have a continuous indeﬁnite integral on both of the open intervals (−1,0) and (0,1). But this
indeﬁnite integral is not uniformly continuous. The easiest clue to this is that the function log|x| is unbounded on both
intervals (−1,0) and (0,1).
As for integrability on, say the interval [−1,1]. This is even clearer: there is no antiderivative at all, so the function
cannot be integrable by deﬁnition.
As to the fact that f(0) is undeﬁned: an integrable function may be undeﬁned at any ﬁnite number of points. So this
was not an issue and did not need to be discussed.
Finally is this function integrable on the unbounded interval (∞,−1] or on the unbounded interval [1,∞)? No. Simply
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
533
check that neither limit
lim
x→∞logx or
lim
x→−∞log(−x)
exists.
Exercise 214, page 64
We know that the function F(x) = 2√x is uniformly continuous on [0,2] and that
d
dx2√x = 1
√x
for all x > 0. Thus this function is integrable on [0,2] and
Z 2
0
1
√x dx = F(2)−F(0) = 2
√
2.
The fact that f is undeﬁned at an endpoint [or any one point for that matter] is no concern to us.
Some calculus course instructors may object here, insisting that the ritual known as “improper integration” needs to
be invoked. It does not! We have deﬁned the integral in such a way that this procedure is simply part of the deﬁnition.
For courses that start with the Riemann integral this procedure would not be allowed since unbounded functions are not
Riemann integrable. The function f(x) = x−1/2 is unbounded on (0,2) but this causes us no concern since the deﬁnition
is only about antiderivatives.
Finally, is this function integrable on [0,∞)? No. The endpoint 0 is no problem but limx→∞2√x does not exist.
Exercise 215, page 64
The simplest method to handle this is to split the problem at 0. If a < 0 < b then
Z b
a 1/
p
|x|dx =
Z 0
a 1/
p
|x|dx+
Z b
0 1/
p
|x|dx =
Z 0
a 1/
√
−xdx+
Z b
0 1/√xdx
if these two integrals exist. For an indeﬁnite integral of f on (0,∞) use F(x) = 2√x and for an indeﬁnite integral of f
on (−∞,0) use F(x) = −2√−x.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

534
CHAPTER 11. APPENDIX
Thus
Z 0
a 1/
p
|x|dx = F(0)−F(a) = 2√a
and
Z b
0 1/
p
|x|dx = F(b)−F(0) = 2
√
b.
Exercise 216, page 64
In deﬁning an integral on [a,b] as
Z b
a f(x)dx = F(b)−F(a)
we have allowed F′(x) = f(x) (a < x < b) to fail at a ﬁnite number of points, say at c1 < c2 < ··· < cn provided we know
that F is continuous at each of these points. We could merely take the separate integrals
Z c1
a
f(x)dx,
Z c1
c1
f(x)dx,...,
Z b
cn
f(x)dx
and add them together whenever we need to. Thus the integral could be deﬁned with no exceptional set and, for applica-
tions, . . . well add up the pieces that you need.
The calculus integral is only a teaching integral. The modern theory requires a much more general integral and that
integral can be obtained by allowing an inﬁnite exceptional set. Thus the training that you are getting by handling the
ﬁnite exceptional set is really preparing you for the inﬁnite exceptional set. Besides we do get a much better integration
theory with our deﬁnition, a theory that generalizes quite well to the modern theory.
Another thing to keep in mind: when we pass to an inﬁnite exceptional set we maybe unable to “split the interval in
pieces.” Indeed, we will eventually allow all of the rational numbers as exceptional points where the derivative may not
exist.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
535
Exercise 217, page 65
The derivative of F exists at all points in (0,1) except at these corners 1/n, n = 2,3,4,5,.... If a > 0 then the interval
[a,1] contains only ﬁnitely many corners. But the interval (0,1) contains inﬁnitely many corners! Thus F′ undeﬁned at
inﬁnitely many points of [0,1] and F(x) is not differentiable at these points.
It is clear that F is continuous at all points inside, since it is piecewise linear. At the endpoint 0 we have F(0) and
we have to check that |F(x)−F(0)| is small if x is close to zero. This is easy. So F is uniformly continuous on [0,1] and
the identity
Z b
a F′(x)dx = F(b)−F(a)
is true for the calculus integral if a > 0. It fails for a = 1 only because there are too many points where the derivative
fails.
What should we do?
1. Accept that F′ is not integrable and not worry about such functions?
2. Wait for a slightly more advanced course where an inﬁnite set of exceptional points is allowed?
3. Immediately demand that the calculus integral accommodate a sequence of exceptional points, not merely a ﬁnite
set?
We have the resources to do the third of these suggestions. We would have to prove this fact though:
If F, G : [a,b] are uniformly continuous functions, if F′(x) = f(x) for all points in (a,b) except points in
some sequence {cn} and if G′(x) = f(x) for all points in (a,b) except points in some sequence {dn}, then F
and G must differ by a constant.
If we prove that then, immediately, the deﬁnition of the calculus integral can be extended to handle this troublesome
example. This fact is not too hard to prove, but it is nonetheless much harder than the ﬁnite case. Remember the latter
uses only the mean-value theorem to ﬁnd a proof. Accepting sequences of exceptional points will make our simple
calculus course just a little bit tougher.
So we stay with the ﬁnite case for this chapter and then introduce the inﬁnite case in the next. After all, the calculus
integral is just a warm-up integral and is not intended to be the ﬁnal say in integration theory on the real line.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

536
CHAPTER 11. APPENDIX
Exercise 218, page 65
(1). There is no function F′(x) = 1 for all x irrational and F′(x) = 0 if x is rational, on any interval [c,d]. To be an
indeﬁnite integral in the calculus sense on an interval [a,b] there must subintervals where F is differentiable. Why is
there not? Well derivatives have the Darboux property.
(2) There are two many points where f is not deﬁned. Every interval contains inﬁnitely many rationals.
(3) The only possible indeﬁnite integral is F(x) = x + k for some constant. But then F′(x) = f(x) has too many
exceptions: at all the points xn = 1/n, 1 = F′(xn) ̸= f(xn) = cn unless we had insisted that cn = 1 for all but ﬁnitely many
of the {cn}.
Note: The ﬁrst two are Lebesgue integrable, but not Riemann integrable. The third is Lebesgue integrable and might
be Riemann integrable, depending on whether the sequence {cn} is bounded or not. Thus the calculus integral is quite
distinct from these other theories.
Exercise 219, page 65
The function F(x) = xp+1/(p+1) is an antiderivative on (0,∞) if p ̸= 1. If p = 1 then F(x) = logx is an antiderivative
on (0,∞). Thus for your answer you will need to check F(0+), F(1), and F(∞) in all possible cases.
Exercise 220, page 65
Yes. Take an indeﬁnite integral F for f and write
Z ∞
−∞f(x)dx = F(∞)−F(−∞) = F(∞)−F(b)+F(b)−F(a)+F(a)−F(−∞)
=
Z a
∞f(x)dx+
Z b
a f(x)dx+
Z ∞
b
f(x)dx.
For the second formula write
Z ∞
0
f(x)dx = F(∞)−F(0) =
F(∞)−F(N)+[F(N)−F(N −1)]+...[F(2)−F(1)]+[F(1)−F(0)]
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
537
= F(∞)−F(N)+
N
∑
n=1
Z n
n−1 f(x)dx.
Then, since limN→∞[F(∞)−F(N)] = 0, it follows that
Z ∞
0
f(x)dx = lim
N→∞
N
∑
n=1
Z n
n−1 f(x)dx =
∞
∑
n=1
Z n
n−1 f(x)dx.
The third formula is similar.
Exercise 221, page 66
Step functions are bounded in every interval [a,b] and have only a ﬁnite number of steps, so only a ﬁnite number of
discontinuities.
Exercise 222, page 66
Differentiable functions are continuous at every point and consequently uniformly continuous on any closed, bounded
interval.
Exercise 224, page 66
If f : (a,b) →R is bounded we already know that f is integrable and that the statements here must all be valid. If f is
an unbounded function that is continuous at all points of (a,b) then there is a continuous function F on (a,b) for which
F′(x) = f(x) for all points there. In particular, F is uniformly continuous on any interval [c,d] ⊂(a,b) and so serves as
an indeﬁnite integral proving that f is integrable on these subintervals.
In order to claim that f is actually integrable on [a,b] we need to be assured that F can be extended to a uniformly
continuous function on all of [a,b]. But that is precisely what the conditions
lim
t→a+
Z c
t
f(x)dx and
lim
t→b−
Z t
c f(x)dx
allow, since they verify that the limits
lim
t→a+F(t) and
lim
t→b−F(t)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

538
CHAPTER 11. APPENDIX
must both exist. We know that this is both necessary and sufﬁcient in order that F should be extendable to a uniformly
continuous function on all of [a,b].
Exercise 225, page 67
We suppose that f has an indeﬁnite integral F on (a,b). We know that f is integrable on any subinterval [c,d] ⊂(a,b)
but we cannot claim that f is integrable on all of [a,b] until we check uniform continuity of F.
We assume that g is integrable on [a,b] and construct a proof that f is also integrable on [a,b]. Let G be an indeﬁnite
integral for g on the open interval (a,b). We know that G is uniformly continuous because g is integrable.
We check, for a < s < t < b that
¯¯¯¯
Z t
s f(x)dx
¯¯¯¯ ≤
Z t
s |g(x)| dx = G(t)−G(s).
from which we get that
|F(t)−F(s)| ≤G(t)−G(s)
for all a < s < t < c.
It follows from an easy ε, δ argument that the uniform continuity of F follows from the uniform continuity of G.
Consequently f is integrable on [a,b].
For the inﬁnite integral,
R ∞
a f(x)dx the same argument give us the uniform continuity but does not offer the existence
of F(∞). For that we can use Exercise 63. Since G(∞) must exist in order for the integral
R ∞
a g(x)dx to exist, that
Exercise 63 shows us, that for all ε > 0 there should exist a positive number T so that
ωG((T,∞)) < ε.
But we already know that
ωF((T,∞)) ≤ωG((T,∞)) < ε.
A further application of that same exercise shows us that F(∞) does exist.
Exercise 226, page 67
If f is continuous at all points of (a,b) with the exception of points a < c1 < c2 < ··· < cm < b then we can argue on
each interval [a,c1], [c1,c2], . . . , [cm,b]. If f is integrable on each of these subintervals of [a,b] then, by the additive
property, f must be integrable on [a,b] itself.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
539
We know that f has an indeﬁnite integral on (a,c1) because f is continuous at each point of that interval. By
Theorem 3.9 it follows that f is integrable on [a,c1]. The same argument supplies that f is integrable on on each interval
[c1,c2], . . . , [cm,b].
Exercise 227, page 67
The method used in the preceding exercise will work. If f is continuous at all points of (a,∞) with the exception of
points a < c1 < c2 < ··· < cm then we can argue on each interval [a,c1], [c1,c2], . . . , [cm,∞). If f is integrable on each
of these subintervals of [a,∞) then, by the additive property, f must be integrable on [a,∞) itself.
We know that f has an indeﬁnite integral on (a,c1) because f is continuous at each point of that interval. By
Theorem 3.9 it follows that f is integrable on [a,c1]. The same argument supplies that f is integrable on on each interval
[c1,c2], . . . , [cm−1,cm]. For the ﬁnal interval [cm,∞) note that f is continuous at every point and so has an indeﬁnite
integral on (cm,∞). Now invoke Theorem 3.10 to conclude integrability on [cm,∞).
Exercise 228, page 68
Note, ﬁrst, that all of the integrands are continuous on the interval (0,π/2). Using the simple inequality
x/2 < sinx < x
(0 < x < π/2)
we can check that, on the interval (0,π/2),
1
√
2
≤
r
sinx
x
≤1,
so that the ﬁrst integral exists because the integrand is continuous and bounded.
For the next two integrals we observe that
1
√
2x
≤
r
sinx
x2
≤1
√x,
and
1
√
2x
≤
r
sinx
x3
≤1
x.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

540
CHAPTER 11. APPENDIX
Thus, by the comparison test, one integral exists and the other does not. It is only the integral
Z π/2
0
r
sinx
x3 dx
that fails to exist by comparison with the integral
1
√
2
Z π/2
0
1
x dx.
Exercise 229, page 68
The comparison test will handle only the third of these integrals proving that it is integrable. We know that the integrands
are continuous on (0,∞) and so there is an indeﬁnite integral in all cases. The inequality |sinx| ≤1 shows that
¯¯¯¯
sinx
x2
¯¯¯¯ ≤1
x2
and we know that the integral
Z ∞
1
1
x2 dx
converges. That proves, by the comparison test that
Z ∞
1
sinx
x2 dx
converges.
To handle the other two cases we would have to compute limits at ∞to determine convergence. The comparison test
does not help.
Exercise 230, page 68
If a nonnegative function f : (a,b) →R is has a bounded indeﬁnite integral F on (a,b), then that function F is evidently
nondecreasing. We can claim that f is integrable if and only if we can claim that the limits F(a+) and F(b−) exist. For
a nondecreasing function F this is equivalent merely to the observation that F is bounded.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
541
Exercise 231, page 68
In view of the previous exercise we should search for a counterexample that is not nonnegative. Find a bounded function
F : (0,1) that is differentiable but is not uniformly continuous. Try F(x) = sinx−1 and take f = F′.
Exercise 232, page 68
The focus of your discussion would have to be on points where the denominator q(x) has a zero. If [a,b] contains no
points at which q is zero then the integrand is continuous everywhere (even differentiable) at all points of [a,b] so the
function is integrable there.
You will need this distinction. A point x0 is a zero of q(x) if q(x0) = 0. A point x0 is a zero of q(x) of order k
(k = 1,2,3,...) if
q(x) = (x−x0)kh(x)
for some polynomial h(x) that does not have a zero at x0.
Work on an interval [x0,c] that contains only the one zero x0. For example, if x0 is a zero of the ﬁrst order for q,
p(x0) ̸= 0 and the interval contains no other zeros for p and q then there are positive numbers m and M for which
m
x−x0
≤p(x)
q(x) ≤
M
x−x0
on the interval [x0,c]. The comparison test supplies the nonintegrability of the function on this interval.
Do the same at higher order zeros (where you will ﬁnd the opposite conclusion).
Exercise 233, page 68
Compare with Exercise 232. First consider only the case where [a,∞] contains no zeros of either p(x) or q(x). Then the
integral
Z X
a
p(x)
q(x) dx
exists and it is only the limiting behavior as X →∞that needs to be investigated. The key idea is that if
m
x ≤
¯¯¯¯
p(x)
q(x)
¯¯¯¯
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

542
CHAPTER 11. APPENDIX
for some m > 0 and all a ≤x ≤∞then the integral must diverge. Similarly if
M
x2 ≥
¯¯¯¯
p(x)
q(x)
¯¯¯¯
for some M > 0 and all a ≤x ≤∞then the integral must converge.
For a further hint, if you need one, consider the following argument used on the integral
Z ∞
1
1+x
1+x+x2 +x3 dx.
Since
lim
x→∞
¯¯¯¯x2 ×
1+x
1+x+x2 +x3
¯¯¯¯ = 1
it follows that, for all sufﬁciently large values of x,
¯¯¯¯x2 ×
1+x
1+x+x2 +x3
¯¯¯¯ < 2
or
¯¯¯¯
1+x
1+x+x2 +x3
¯¯¯¯ < 2
x2 .
Exercise 234, page 68
In Exercise 220 we established the identity
Z ∞
1
f(x)dx =
∞
∑
n=2
Z n
n−1 f(x)dx,
valid if the function f is integrable on [0,∞). Because f is a nonnegative, decreasing function on [1,∞) we can see that
f(n−1) ≥
Z n
n−1 f(x)dx ≥f(n).
From that we can deduce that the series ∑∞
n=1 f(n) converges.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
543
Conversely suppose the series converges. Let
F(x) =
Z x
1 f(t)dt
which is an indeﬁnite integral for f on (0,∞). The function F is nondecreasing. As before,
f(n−1) ≥F(n)−F(n−1) =
Z n
n−1 f(x)dx ≥f(n).
We can deduce from this that if the series ∑∞
n=1 f(n) converges then the limit
F(∞) = lim
x→∞F(x)
exists. It follows that the integral exists.
Exercise 235, page 68
In Exercise 234 we saw that this would not be possible if the function f is also nondecreasing. That should be the clue
as to where to look for a counterexample.
Exercise 236, page 69
In Exercise 234 we saw that this would not be possible if the function f is also nondecreasing. Again that is a clue for
ﬁnding a counterexample.
Exercise 237, page 69
Uniformly continuous functions are integrable. Here fg is also uniformly continuous.
Exercise 238, page 69
Bounded, continuous functions are integrable. Here fg is also bounded continuous and has discontinuities only at the
points where one of f or g is continuous.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

544
CHAPTER 11. APPENDIX
Exercise 239, page 69
Take f(x) = g(x) =
1
√x. Then f(x)g(x) = 1
x which we know is not integrable on [0,1]. It is the unboundedness of
the functions that causes the difﬁculty. Clearly some unbounded functions are integrable, but “really big” unbounded
functions may not be.
Exercise 240, page 69
If both f and g are continuous functions on [1,∞) then they must be integrable on every bounded interval. So it is just
a delicate matter to arrange for them to be integrable without the product being integrable; this requires attention to the
large values.
In every interval [n,n+1] (n = 1,2,3,...) choose f to be a continuous, nonnegative function arranged so that
Z n+1
n
f(x)dx ≤1/n2
but
Z n+1
n
(f(x))2 dx ≥1/n.
This is just an arithmetic problem in each interval. Then observe that, for N ≤x ≤N +1,
F(x) =
Z x
1 f(t)dt ≤
N
∑
i=1
1
i2
and
G(x) =
Z x
1 (f(t))2 dt ≥
N−1
∑
i=1
1
i .
The functions F and G are continuous, nondecreasing functions for which, evidently, F(∞) exists but G(∞) does not.
Exercise 241, page 69
By the product rule for derivatives
(FG)′ = F′G+FG′
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
545
at all but ﬁnitely many points. Thus, since FG is uniformly continuous, the function FG′ +F′G is integrable.
Exercise 242, page 70
Yes. Just check the two cases.
Exercise 243, page 70
We know this for a < b < c. Make sure to state the assumptions and formulate the thing you want to prove correctly. For
example, if b < a = c does it work?
Exercise 244, page 71
For a function x(t) = t2 compute the integral
R 1
0 x(f)d f. That is perfectly legitimate but will make most mathematicians
nauseous. How about using d as a dummy variable: compute
R 1
0 d2 dd? Or use the Greek letter π as a dummy variable:
what is
R 1
0 sinπdπ?
Most calculus students are mildly amused by this computation:
Z 2
1
d[cabin]
[cabin] = {logcabin}cabin=2
cabin=1 = log2.
Exercise 245, page 72
That is correct but he is being a jerk. More informative is
Z
e2x dx = e2x/2+C,
which is valid on any interval. More serious, though, is that the student didn’t ﬁnd an indeﬁnite integral so would be
obliged to give some argument about the function f(x) = e2x to convince us that it is indeed integrable. An appeal to
continuity would be enough.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

546
CHAPTER 11. APPENDIX
Exercise 246, page 72
That is correct but she is not being a jerk. There is no simple formula for any indeﬁnite integral of ex2 other than deﬁning
it as an integral as she did here (or perhaps an inﬁnite series). Once again the student would be obliged to give some
argument about the function f(x) = ex2 to convince us that it is indeed integrable. An appeal to continuity would be
enough.
Exercise 247, page 73
Probably, but the student using the notation should remember that the computation at the ∞end here is really a limit:
lim
x→∞
·
−2
√x
¸
= 0.
Exercise 248, page 74
Let F(x) = 0 for x ≤0 and let F(x) = x for x > 0. Then F is continuous everywhere and is differentiable everywhere
except at x = 0. Consider
Z 1
−1 F′(x)dx = F(1)−F(−1) = 1
and try to ﬁnd a point ξ where F′(ξ)(1−(−1)) = 1.
Exercise 249, page 74
Let m and M be the minimum and maximum values of the function G. It follows that
m
Z b
a ϕ(t)dt ≤
Z b
a G(t)ϕ(t)dt ≤M
Z b
a ϕ(t)dt
by monotonicity of the integral. Dividing through by
R b
a ϕ(t)dt (which we can assume is not zero), we have that
m ≤
R b
a G(t)ϕ(t)dt
R b
a ϕ(t)dt
≤M.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
547
Since G(t) is continuous, the Darboux property of continuous functions (i.e., the intermediate value theorem) implies
that there exists ξ ∈[a,b] such that
G(x) =
R b
a G(t)ϕ(t)dt
R b
a ϕ(t)dt
which completes the proof.
Exercise 252, page 74
In Exercise 229 we avoided looking closely at this important integral but let us do so now.
We need to consider the indeﬁnite integral
Si(x) =
Z x
0
sint
t
dt
which is known as the sin integral function and plays a role in many investigations. Since the functions x−1 and sinx are
both continuous on (0,∞) there is an indeﬁnite integral on (0,∞). There is no trouble at the left-hand endpoint because
the integrand is bounded. Hence the function Si(x) is deﬁned for all 0 ≤x < ∞.
Our job is simply to show that the limit Si(∞) exists. It is possible using more advanced methods to evaluate the
integral and obtain
Si(∞) =
Z ∞
0
sinx
x
dx = π
2.
To obtain that the limit Si(∞) exists let us apply the mean-value theorem given as Exercise 251. On any interval
[a,b] ⊂(0,∞)
Z b
a x−1 sinxdx = cosa−cosξ
a
+ cosξ−cosb
b
for some ξ. Consequently
|Si(b)−Si(a)| =
¯¯¯¯
Z b
a
sinx
x
dx
¯¯¯¯ ≤2
a + 2
b.
From this we deduce that the oscillation of Si on intervals [T,∞) is small if T is large, i.e., that
ωSi([T,∞]) ≤4
T →0
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

548
CHAPTER 11. APPENDIX
as T →∞. It follows that Si(∞) must exist. This proves that the integral is convergent.
Finally let us show that the function
F(x) =
Z x
0
¯¯¯¯
sint
t
¯¯¯¯ dt
is unbounded. Then we can conclude that the integral diverges and that the Dirichelet integral is convergent but not
absolutely convergent.
To see this take any interval [2nπ,(2n + 1)π] on which sinx is nonnegative. Let us apply the mean-value theorem
given as Exercise 250. This will show that
Z (2n+1)π
2nπ
¯¯¯¯
sint
t
¯¯¯¯ dt ≥
1
2nπ.
It follows that for x greater than (2N +1)π
Z x
0
¯¯¯¯
sint
t
¯¯¯¯ dt ≥
N
∑
n=1
Z (2n+1)π
2nπ
¯¯¯¯
sint
t
¯¯¯¯ dt ≥
N
∑
n=1
1
2nπ.
Consequently F is unbounded.
Exercise 253, page 77
The choice of midpoint
xi +xi−1
2
= ξi
for the Riemann sum gives a sum
= 1
2
n
∑
i=1
(x2
i −x2
i−1) = 1
2
£
b2 −x2
n−1 +x2
n−1 −x2
n−2 +···−a2¤
= (b2 −a2)/2.
To explain why this works you might take the indeﬁnite integral F(x) = x2/2 and check that
F(d)−F(c)
d −c
= c+d
2
so that the mean-value always picks out the midpoint of the interval [c,d] for this very simple function.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
549
Exercise 259, page 78
Just take, ﬁrst, the points ξ∗
i at which we have the exact identity
Z xi
xi−1
f(x)dx−f(ξ∗
i )(xi −xi−1) = 0
Then for any other point ξi,
¯¯¯¯
Z xi
xi−1
f(x)dx−f(ξi)(xi −xi−1)
¯¯¯¯ = | f(ξi)−f(ξ∗)|(xi −xi−1) ≤ω f([xi,xi−1])(xi −xi−1).
The ﬁnal comparison with
n
∑
i=1
ω f([xi,xi−1])(xi −xi−1)
follows from this.
To get a good approximation of the integral by Riemann sums it seems that we might need
n
∑
i=1
ω f([xi,xi−1])(xi −xi−1)
to be small. Observe that the pieces in the sum here can be made small if (a) the function is continuous so that the
oscillations are small, or (b) points where the function is not continuous occur in intervals [xi,xi−1] that are small.
Loosely then we can make these sums small if the function is mostly continuous, i.e., where it is not continuous can be
covered by some small intervals that don’t add up to much. The modern statement of this is “the function needs to be
continuous almost everywhere.”
Exercise 260, page 80
This is the simplest case to prove since we do not have to fuss at the endpoints or at exceptional points where f is
discontinuous.
Let ε > 0 and choose δ > 0 so that
ω f([c,d]) <
ε
(b−a)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

550
CHAPTER 11. APPENDIX
whenever [c,d] is a subinterval of [a,b] for which d −c < δ. Note then that if
{([xi,xi−1],ξi) : i = 1,2,...n}
is a partition of [a,b] with intervals shorter than δ then
n
∑
i=1
ω f([xi,xi−1])(xi −xi−1) <
n
∑
i=1
[ε/(b−a)](xi −xi−1) = ε.
Consequently, by Exercise 259,
¯¯¯¯¯
Z b
a f(x)dx−
n
∑
i=1
f(ξi)(xi −xi−1)
¯¯¯¯¯
≤
n
∑
i=1
¯¯¯¯
Z xi
xi−1
f(x)dx−f(ξi)(xi −xi−1)
¯¯¯¯ < ε.
Exercise 261, page 80
You can still use the error estimate in Exercise 259, but will have to handle the endpoints differently than you did in
Exercise 260.
Exercise 262, page 80
Add one point c of discontinuity of f in (a,b) and prove that case. [Do for c what you did for the endpoints a and b in
Exercise 261.]
Exercise 263, page 80
Once we have selected
{([xi,xi−1],ξi) : i = 1,2,...n},
a partition of [a,b] with intervals shorter than δ we would be free to move the points ξi anywhere within the interval.
Thus write the inequality and hold everything ﬁxed except, for one value of i, let xi−1 ≤ξi ≤xi vary. That can be used
to obtain an upper bound for | f(ξ)| for xi−1 ≤ξ ≤xi.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
551
Exercise 264, page 80
Of course we can more easily use the deﬁnition of the integral and compute that
R 1
0 x2 dx = 1/3−0. This exercise shows
that, under certain simple conditions, not merely can we approximate the value of the integral by Riemann sums, we can
produce a sequence of numbers which converges to the value of the integral. Simply divide the interval at the points 0,
1/n, 2/n, . . . , n −1)/n, and 1. Take ξ = i/n [the right hand endpoint of the interval]. Then the Riemann sum for this
partition is
n
∑
i=1
µ i
n
¶2 1
n = 12 +22 +32 +42 +52 +62 +···+n2
n3
.
As n →∞this must converge to the value of the integral by Theorem 3.17. The student is advised to ﬁnd the needed
formula for
12 +22 +32 +42 +52 +62 +···+N2.
and determine whether the limit is indeed the correct value 1/3.
Exercise 265, page 80
Determine the value of the integral
Z 1
0 x2 dx
in the following way. Let 0 < r < 1 be ﬁxed. Subdivide the interval [0,1] by deﬁning the points x0 = 0, x1 = rn−1,
x2 = rn−2, . . . , xn−1 = rn−(n−1) = r, and xn = rn−(−n) = 1. Choose the points ξi ∈[xi−1,xi] as the right-hand endpoint of
the interval. Then
n
∑
i=1
ξ2
i (xi −xi−1) =
n
∑
i=1
¡
rn−i¢2 (rn−i −rn−i+1).
Note that for every value of n this is a Riemann sum over subintervals whose length is smaller than 1−r.
As r →1−this must converge to the value of the integral by Theorem 3.17. The student is advised to carry out the
evaluation of this limit to determine whether the limit is indeed the correct value 1/3.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

552
CHAPTER 11. APPENDIX
Exercise 267, page 82
The same methods will work for this theorem with a little effort. Obtain, ﬁrst, an inequality of the form
|f(ξi)g(ξi)−f(ξi)g(ξ∗
i )|
≤M (ω( f,[xi,xi−1])+ω(g,[xi,xi−1])).
To obtain this use the simple identity
a1a2 −b1b2 = (a1 −b1)a2 +(a2 −b2)b1
and use for M an upper bound of the sum function | f|+|g| which is evidently bounded, since both f and g are bounded.
Exercise 268, page 83
Obtain, ﬁrst, an inequality of the form
¯¯¯ f1(ξi)f2(ξi)f3(ξi)... fp(ξi)−f1(ξi)f2(ξ(2)
i )f3(ξ(3)
i )... fp(ξ(p)
i
)
¯¯¯
≤M [ω( f1,[xi,xi−1])+ω( f2,[xi,xi−1])+ω( f3,[xi,xi−1])+···+ω( fp,[xi,xi−1])].
To obtain this use the simple identity
a1a2a3 ...ap −b1b2b3 ...bp
= (a1 −b1)a2a3 ...ap +(a2 −b2)b1a3 ...ap +(a3 −b3)b1b2a4 ...ap +...
+(ap −bp)b1b2b3 ...bp−1
and use an appropriate M.
Exercise 269, page 83
First note that the function H(f(x),g(x)) is deﬁned and bounded. To see this just write
|H(f(x),g(x))| ≤M(|f(x))|+|g(x)|)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
553
and remember that both f and g are bounded. It is also true that this function is continuous at every point of (a,b) with
at most ﬁnitely many exceptions. To see this, use the inequality
|H(f(x),g(x))−H(f(x0),g(x0))| ≤M(|f(x)−f(x0)|+|g(x)−g(x0)|)
and the deﬁnition of continuity.
Thus the integral
R b
a F(f(x),g(x))dx exists as a calculus integral and can be approximated by Riemann sums
n
∑
i=1
H (f (ξi),g(ξi))(xi −xi−1).
To complete the proof just make sure that these sums do not differ much from these other similar sums:
n
∑
i=1
H (f (ξi),g(ξ∗
i ))(xi −xi−1).
That will follow from the inequality
|H(f (ξi),g(ξi))−H(f (ξi),g(ξ∗
i ))|
≤M|g(ξi)−g(ξ∗
i )| ≤Mω(g,[xi−1,xi]).
Exercise 270, page 85
Notice, ﬁrst, that
Z b
a f(x)dx =
n
∑
i=1
Z xi
xi−1
f(x)dx.
Thus
¯¯¯¯¯
Z b
a f(x)dx−
n
∑
i=1
f(ξi)(xi −xi−1)
¯¯¯¯¯ =
¯¯¯¯¯
n
∑
i=1
½Z xi
xi−1
f(x)dx−f(ξi)(xi −xi−1)
¾¯¯¯¯¯
≤
n
∑
i=1
¯¯¯¯
Z xi
xi−1
f(x)dx−f(ξi)(xi −xi−1)
¯¯¯¯
merely by the triangle inequality.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

554
CHAPTER 11. APPENDIX
Exercise 271, page 85
This is the simplest case to prove since we do not have to fuss at the endpoints or at exceptional points where F′ may
fail to exist. Simply let ε > 0 and choose at each point x a number δ(x) > 0 sufﬁciently small so that
|F(z)−F(y)−f(x)(z−y)|| < ε(z−y)
b−a
when 0 < z−y < δ(x) and y ≤x ≤z. This is merely the statement F′(x) = f(x) translated into ε, δ language.
Now suppose that we have a partition
{([xi,xi−1],ξi) : i = 1,2,...n}
of the interval [a,b] with each
xi −xi−1 < δ(ξi) and ξi ∈[xi−1,xi].
Then, using our estimate on each of the intervals [xi−1,xi−1],
¯¯¯¯¯
Z b
a f(x)dx−
n
∑
i=1
f(ξi)(xi −xi−1)
¯¯¯¯¯
≤
n
∑
i=1
¯¯¯¯
Z xi
xi−1
f(x)dx−f(ξi)(xi −xi−1)
¯¯¯¯
=
n
∑
i=1
|[F(xi)−F(xi−1)]−f(ξi)(xi −xi−1)| <
ε
b−a
n
∑
i=1
(xi −xi−1) = ε.
Exercise 272, page 85
This is still a simpler case to prove since we do not have to fuss at the endpoints and there is only one exceptional point
to worry about, not a ﬁnite set of such points.
Let ε > 0 and, at each point x ̸= c, choose a number δ(x) > 0 sufﬁciently small so that
|F(z)−F(y)−f(x)(z−y)|| < ε(z−y)
2(b−a)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
555
when 0 < z−y < δ(x) and y ≤x ≤z. This is merely the statement F′(x) = f(x) translated into ε, δ language.
At x = c select a positive number δ(c) > 0 so that
|F(z)−F(y)|+| f(c)|(z−y) < ε/2
when 0 < z−y < δ(x) and y ≤x ≤z. This is possible because F is continuous at c so that |F(z)−F(y)| is small if z and
y are sufﬁciently close to c; the second part is small since | f(c)| is simply a nonnegative number.
Now suppose that we have a partition
{([xi,xi−1],ξi) : i = 1,2,...n}
of the interval [a,b] with each
xi −xi−1 < δ(ξi) and ξi ∈[xi−1,xi].
Then, using our estimate on each of the intervals [xi−1,xi−1],
n
∑
i=1
¯¯¯¯
Z xi
xi−1
f(x)dx−f(ξi)(xi −xi−1)
¯¯¯¯
=
n
∑
i=1
|[F(xi)−F(xi−1)]−f(ξi)(xi −xi−1)| < ε/2+
ε
b−a
n
∑
i=1
|(xi −xi−1)+| = ε.
Note that we have had to add the ε/2 in case it happens that one of the ξi = c. Otherwise we do not need it.
Exercise 273, page 85
Exercise 260 and Exercise 261 illustrate the method. Just add more points, including the endpoints a and b into the
argument.
Let c1, c2, . . . , cM be a ﬁnite list containing the endpoints a and b and each of the points in the interval where
F′(x) = f(x) fails. Let ε > 0 and, at each point x ̸= ci, choose a number δ(x) > 0 sufﬁciently small so that
|F(z)−F(y)−f(x)(z−y)|| < ε(z−y)
2(b−a)
when 0 < z−y < δ(x) and y ≤x ≤z. This is merely the statement F′(x) = f(x) translated into ε, δ language.
At x = c j ( j = 1,2,3,...,M) select a positive number δ(c j) > 0 so that
ω(F,[a,b]∩[c j −δ(cj),cj +δ(cj)])+δ(cj)|f(c)| < ε/2M
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

556
CHAPTER 11. APPENDIX
when 0 < z−y < δ(x) and y ≤x ≤z. Thus just uses the continuity of F.
Now suppose that we have a partition
{([xi,xi−1],ξi) : i = 1,2,...n}
of the interval [a,b] with each
xi −xi−1 < δ(ξi) and ξi ∈[xi−1,xi].
Note, ﬁrst, that if ξi = cj for some i and j (which might occur at most M times), then
|[F(xi)−F(xi−1)]−f(ξi)(xi −xi−1)|
≤ω(F,[a,b]∩[c j −δ(cj),cj +δ(cj)])+δ(cj)|f(c)| < ε/2M.
At any other point ξi ̸= cj
|F(z)−F(y)−f(x)(z−y)|| < ε(z−y)
2(b−a).
Consequently
n
∑
i=1
¯¯¯¯
Z xi
xi−1
f(x)dx−f(ξi)(xi −xi−1)
¯¯¯¯
=
n
∑
i=1
|[F(xi)−F(xi−1)]−f(ξi)(xi −xi−1)| < ε/2+
ε
b−a
n
∑
i=1
|(xi −xi−1)+| = ε.
Exercise 274, page 85
The proof is an easy exercise in derivatives. Use F and G for the indeﬁnite integrals of f and g. Let N0 be the set of points
x in (a,b) where f(x) ≤g(x) might fail. Suppose that F′(x) = f(x) except on a ﬁnite set N1. Suppose that G′(x) = g(x)
except on a ﬁnite set N2.
Then H = G−F has H′(x) = g(x)−f(x) ≥0 except on the ﬁnite set N0 ∪N1 ∪N2. This set is also ﬁnite and, since
F and G are uniformly continuous on the interval, so too is H. We now know that if H is uniformly continuous on [a,b]
and
d
dxH(x) ≥0
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
557
for all but ﬁnitely many points x in (a,b); then H(x) must be nondecreasing on [a,b]. Finally then H(a) ≤H(b) shows
that F(a)−F(b) ≤G(b)−G(a) and hence that
Z b
a f(x)dx ≤
Z b
a g(x)dx.
Exercise 279, page 88
If the formula
d
dxF(G(x)) = F′(G(x))G′(x)
holds everywhere then
Z b
a F′(G(x))G′(x)dx = F(G(b))−F(G(a)).
But we also know that
Z G(b)
G(a) F′(x)dx = F(G(b))−F(G(a)).
Exercise 280, page 88
That does not work here. If F(x) = |x| and G(x) = x2 sinx−1, G(0) = 0, then G is differentiable everywhere and F
is continuous with only one point of nondifferentiability. But F(G(x) = |x2 sinx−1| is not differentiable at any point
x = ±1/π, ±1/2π, ±1/3π, . . . . Thus F(G(x) is not an indeﬁnite integral in the calculus sense for F′(G(x)) on [0,1] and
indeed F′(G(x)) would have inﬁnitely many points where it is undeﬁned. This function is, however, integrable on any
interval that avoids zero since there would then be only ﬁnitely many points at which the continuous function F(G(x))
is not differentiable.
This is a feature of the calculus integral. Other integration theories can handle this function.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

558
CHAPTER 11. APPENDIX
Exercise 283, page 88
If F′ is integrable [calculus sense] on [a,b] then F is continuous there and differentiable at all but ﬁnitely many points of
the interval. Hence the formula
d
dxF(G(x)) = F′(G(x))G′(x)
holds everywhere with at most ﬁnitely many exceptions. Consequently F′(G(x))G′(x) must be integrable and
Z b
a F′(G(x))G′(x)dx = F(G(b))−F(G(a)) =
Z G(b)
G(a) F′(x)dx.
Exercise 284, page 89
The integrand is continuous at each point of (0,π2) so the inequality
¯¯¯¯
cos√x
√x
¯¯¯¯ ≤1
√x
and the comparison test can be used to show that the integral exists.
With F(u) = sinu, F′(u) = cosu, u = √x, and 2du = dx/√x, a change of variables shows that
Z π2
0
cos√x
√x
dx = 2
Z π
0 cosudu = 2sinπ−2sin0.
Integrability also follows from the change of variable formula itself. Take F(u) = sinu and G(x) = √x. Then G′(x) =
1/2√x. The function F(G(x)) is continuous on [0,π2] and is differentiable at every point of the open interval (0,π2)
with a derivative
d
dxF(G(x)) = cos(G(x))×G′(x) = cos√x
2√x .
It follows that the integral must exist and that
Z π2
0
cos√x
2√x dx = F(G(π2))−F(G(0)).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
559
Exercise 285, page 90
The inequalities
−|f(x)| ≤f(x) ≤|f(x)|
hold at every point x at which f is deﬁned. Since these functions are assumed to be integrable on the interval [a,b],
−
Z b
a |f(x)| dx ≤
Z b
a f(x)dx ≤
Z b
a |f(x)| dx
which is exactly what the inequality in the exercise asserts.
Exercise 286, page 90
Observe that
n
∑
i=1
|F(xi)−F(xi−1)| =
n
∑
i=1
¯¯¯¯
Z xk
xk−1
f(x)dx
¯¯¯¯ ≤
n
∑
i=1
Z xk
xk−1
|f(x)| dx =
Z b
a |f(x)| dx
for all choices of points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b.
Exercise 287, page 90
Deﬁne the function F(x) = xcos
¡ π
x
¢
, F(0) = 0 and compute
F′(x) = cos(π/x)+(π/x)sin(π/x),
x ̸= 0.
Thus F is differentiable everywhere except at x = 0 and F is continuous at x = 0. To see the latter note that −|x| ≤
F(x) ≤|x|.
Thus F′ has a calculus integral on every interval. Note that F′(x) is continuous everywhere except at x = 0 and that
it is unbounded on (0,1).
We show that |F′| is not integrable on [0,1]. It is, however, integrable on any subinterval [c,d] for which 0 < c < d ≤1
since F′ and hence |F′| are continuous at every point in such an interval.
Take any integer k and consider the points ak = 2/(2k + 1), bk = 1/k and check that F(ak) = 0 while F(bk) =
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

560
CHAPTER 11. APPENDIX
(−1)k/k. Observe that
0 < ak < bk < ak−1 < bk−1 < ··· < 1
and that
Z bk
ak
|F′(x)|dx ≥
¯¯¯¯
Z bk
ak
F′(x)dx
¯¯¯¯ = |F(bk)−F(ak)| = 1
k.
If |F′| were, in fact, integrable on [0,1] then, summing n of these pieces, we would have
n
∑
k=1
1
k ≤
n
∑
k=1
Z bk
ak
|F′(x)|dx ≤
Z 1
0 |F′(x)|dx.
This is impossible since ∑∞
k=1
1
k = ∞.
Note: In the language introduced later, you may wish to observe that F is not a function of bounded variation on [0,1].
There is a close connection between this concept and absolute integrability.
Exercise 288, page 91
You can use the same argument but with different arithmetic. This is the traditional example that illustrates that the
calculus integral, which integrates all derivatives, is not contained in the Lebesgue integral. Indeﬁnite Lebesgue integrals,
since Lebesgue’s integral is an absolute integration method, must be of bounded variation on any interval. In contrast,
the function
F(x) = x2 sin
µ 1
x2
¶
is everywhere differentiable but fails to have bounded variation on [0,1].
Exercise 289, page 91
Since f is continuous on (a,b) with at most ﬁnitely many exceptions and is bounded it is integrable. But the same is true
for | f|, since it too has the same properties. Hence both f and | f| are integrable.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
561
Exercise 290, page 92
Subdivide at any one point x inside (a,b),
a = x0 < x1 = x < x2 = b.
Then
|F(x)−F(a)|+|F(x)−F(b)| ≤V(F,[a,b]).
Consequently
|F(x)| ≤|F(a)|+|F(b)|+V(F,[a,b])
offers an upper bound for F on [a,b].
Exercise 291, page 92
If F : [a,b] →R is nondecreasing then T(x) = F(x)−F(a). This is because
n
∑
i=1
|F(xi)−F(xi−1)| =
n
∑
i=1
[F(xi)−F(xi−1)] = F(x)−F(a)
for all choices of points
a = x0 < x1 < x2 < ··· < xn−1 < xn = x.
If F : [a,b] →R is nonincreasing then T(x) = F(a) −F(x). Putting these together yields that T(x) = |F(x) −F(a)| in
both cases.
Exercise 292, page 93
Work on the separate subintervals of [−π,π] on which sinx is monotonic. For example, it is nondecreasing on [−π/2,π/2].
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

562
CHAPTER 11. APPENDIX
Exercise 293, page 93
You should be able to show that
n
∑
i=1
|F(xi)−F(xi−1)|
is either 0 (if none of the points chosen was 0) and is 2 (if one of the points chosen was 0). It follows thatV(F,[−1,1]) = 2.
Note that this example illustrates that the computation of the sum
n
∑
i=1
|F(xi)−F(xi−1)|
doesn’t depend merely on making the points close together, but may depend also on which points get chosen. Later on
in Exercise 302 we will see that for continuous functions the sum
n
∑
i=1
|F(xi)−F(xi−1)|
will be very close to the variation value V(F,[a,b]) if we can choose points very close together. For discontinuous
functions, as we see here, we had better consider all points and not miss even one.
Exercise 294, page 93
Simplest to state would be F(x) = 0 if x is an irrational number and F(x) = 1 if x is a rational number. Explain how to
choose points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b
so that the sum
n
∑
i=1
|F(xi)−F(xi−1)| ≥n.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
563
Exercise 295, page 93
Suppose that F : [a,b] →R is Lipschitz with a Lipschitz constant K. Then
n
∑
i=1
|F(xi)−F(xi−1)| ≤
n
∑
i=1
K(xi −xi−1) = K(b−a)
for all choices of points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b.
Thus V(F,[a,b]) ≤K(b−a).
The converse is not true and it is easy to invent a counterexample. Every monotonic function is of bounded variation,
and monotonic functions need not be Lipschitz, nor even continuous.
Exercise 296, page 93
To estimate V(F +G,[a,b]) consider
n
∑
i=1
|[F(xi)+G(xi)]−[F(xi−1)+G(xi−1)]|
for all choices of points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b.
By the triangle inequality,
n
∑
i=1
|[F(xi)+G(xi)]−[F(xi−1)+G(xi−1)]|
≤
n
∑
i=1
|F(xi)−F(xi−1)|+
n
∑
i=1
|G(xi)−G(xi−1)| ≤V(F,[a,b])+V(G,[a,b]).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

564
CHAPTER 11. APPENDIX
Exercise 297, page 93
Use F = −G and then F +G is a constant and so V(F +G,[a,b]) = 0. Thus it is easy to supply an example for which
V(F +G,[a,b]) < V(F,[a,b])+V(G,[a,b]).
For exact conditions on when equality might be possible see F. S. Cater, When total variation is additive, Proceedings of
the American Mathematical Society, Volume 84, No. 4, April 1982.
Exercise 298, page 93
This is a substantial theorem and it is worthwhile making sure to master the methods of proof. Mostly it is just a matter
of using the deﬁnition and working carefully with inequalities.
(2). T is monotonic, nondecreasing on [a,b].
Take a ≤x < y ≤b and consider computing V(F,[a,x]). Take any points
a = x0 < x1 < x2 < ··· < xn−1 < xn = x
Observe that the sum
n
∑
i=1
|F(xi)−F(xi−1)|+|F(y)−F(x)| ≤V(F,[a,y]).
This this would be true for any such choice of points, it follows that
V(F,[a,x])+|F(y)−F(x)| ≤V(F,[a,y]).
Thus T(x) = V(F,[a,x]) ≤V(F,[a,y]) = T(y).
(1). for all a ≤c < d ≤b,
|F(d)−F(c)| ≤V(F,[c,d]) = T(d)−T(c).
The ﬁrst inequality,
|F(d)−F(c)| ≤V(F,[c,d])
follows immediately from the deﬁnition of what V(F,[c,d]) means. The second inequality says this:
V(F,[a,d]) = V(F,[a,c])+V(F,[c,d])
(11.2)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
565
and it is this that we must prove.
To prove (11.2) we show ﬁrst that
V(F,[a,d]) ≥V(F,[a,c])+V(F,[c,d])
(11.3)
Let ε > 0 and choose points
a = x0 < x1 < x2 < ··· < xn−1 < xn = c
so that
n
∑
i=1
|F(xi)−F(xi−1)| > V(F,[a,c])−ε.
Then choose points
c = xn < xn+1 < xn+2 < ··· < xm−1 < xm = d
so that
m
∑
i=n+1
|F(xi)−F(xi−1)| > V(F,[c,d])−ε.
Observe that
m
∑
i=1
|F(xi)−F(xi−1)| ≤V(F,[a,d]).
Putting this together now you can conclude that
V(F,[a,d]) ≥V(F,[a,c])+V(F,[c,d])−2ε.
Since ε is arbitrary the inequality (11.3) follows.
Now we prove that
V(F,[a,d]) ≤V(F,[a,c])+V(F,[c,d])
(11.4)
Choose points
a = x0 < x1 < x2 < ··· < xn−1 < xn = d
so that
n
∑
i=1
|F(xi)−F(xi−1)| > V(F,[a,d])−ε.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

566
CHAPTER 11. APPENDIX
We can insist that among the points selected is the point c itself [since that does not make the sum any smaller]. So let
us claim that xk = c. Then
k
∑
i=1
|F(xi)−F(xi−1)| ≤V(F,[a,c])
and
n
∑
i=k+1
|F(xi)−F(xi−1)| ≤V(F,[c,d]).
Putting this together now you can conclude that
V(F,[a,d])−ε < V(F,[a,c])+V(F,[c,d]).
Since ε is arbitrary the inequality (11.4) follows. Finally, then, the inequalities (11.3) and (11.4) verify (11.2).
(3). If F is continuous at a point then so too is T.
We argue just on the right at the point a to claim that if F is continuous at a then T(a+) = T(a) = 0. The same
argument can be repeated at any point and on either side. The value T(a+) exists since T is monotonic, but it might be
positive. Let ε > 0 and choose δ1 so that
|T(x)−T(a+)| < ε
if a < x < a+δ1. Choose δ2, using the continuity of F at a, so that
|F(x)−F(a)| < ε
if a < x < a+δ2. Now take any a < x < min{δ1,δ2}. Choose points
a = x0 < x1 < x2 < ··· < xn−1 < xn = x
so that
n
∑
i=1
|F(xi)−F(xi−1)| > T(x)−ε.
Observe that
|F(x1)−F(x0)| = |F(x1)−F(a)| < ε
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
567
and that
n
∑
i=2
|F(xi)−F(xi−1)| ≤T(x)−T(x1) ≤T(x)−T(a+)−[T(x1)−T(a+)] < 2ε.
Putting these together we can conclude that
T(x) < 3ε
for all a < x < min{δ1,δ2}. Thus T(a+) = 0.
(4). If F is uniformly continuous on [a,b] then so too is T.
This follows from (3).
(5). If F is continuously differentiable at a point then so too is T and, moveover T ′(x0) = |F′(x0)|.
This statement is not true without the continuity assumption so your proof will have to make use of that assumption.
We will assume that F is continuously differentiable at a and conclude that the derivative of T on the right at a exists and
is equal to |F′(a)|. This means that F is differentiable in some interval containing a and that this derivative is continuous
at a.
Let ε > 0 and choose δ so that
|F′(a)−F′(x)| < ε
if a < x < a+δ. Now choose points
a = x0 < x1 < x2 < ··· < xn−1 < xn = x
so that
T(x) ≥
n
∑
i=1
|F(xi)−F(xi−1)| > T(x)−ε(x−a).
Apply the mean-value theorem on each of the intervals to obtain
n
∑
i=1
|F(xi)−F(xi−1)| =
n
∑
i=1
|F′(ξi)|(xi −xi−1) = |F′(a)|(x−a)±ε(x−a).
We can interpret this to yield that
|T(x)−T(a)−|F′(a)|(x−a)| ≤2ε(x−a)
for all a < x < a+δ. This says precisely that the right-hand derivative of T at a is |F′(a)|.
(6). If F is uniformly continuous on [a,b] and continuously differentiable at all but ﬁnitely many points in (a,b) then F′
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

568
CHAPTER 11. APPENDIX
is absolutely integrable and
F(x)−F(a) =
Z x
a F′(t)dt and T(x) =
Z x
a |F′(t)|dt.
For F′ to be absolutely integrable both F′ and |F′| must be integrable. Certainly F′ is integrable. The reason that |F′|
is integrable is that is continuous at all but ﬁnitely many points in (a,b) and has for an indeﬁnite integral the uniformly
continuous function T. This uses (5).
Exercise 299, page 93
The natural way to do this is to write
F(x) =
µ
V(F,[a,x])+ F(x)
2
¶
−
µ
V(F,[a,x])−F(x)
2
¶
in which case this expression is called the Jordan decomposition. It is then just a matter of checking that the two parts do
in fact express f as the difference of two monotonic, nondecreasing functions. Theorem 3.26 contains all the necessary
information.
Exercise 300, page 93
The methods in Exercise 287 can be repeated here. First establish continuity. The only troublesome point is at x = 0
and, for that, just notice that −|x| ≤F(x) ≤|x| which can be used to show that F is continuous at x = 0.
Then to compute the total variation of take any integer k and consider the points ak = 2/(2k+1), bk = 1/k and check
that F(ak) = 0 while F(bk) = (−1)k/k. Observe that
0 < ak < bk < ak−1 < bk−1 < ··· < 1.
Consequently
n
∑
k=1
|F(bk)−F(ak)| ≤V(F,[0,1]).
But
n
∑
k=1
1
k =
n
∑
k=1
|F(bk)−F(ak)|
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
569
and ∑∞
k=1
1
k = ∞. It follows that V(F,[0,1]) = ∞.
Exercise 301, page 94
See Gerald A. Heuer, The derivative of the total variation function, American Mathematical Monthly, Vol. 78, No. 10
(1971), pp. 1110–1112. For the statement about the variation it is enough to work on [0,1] since the values on [−1,0]
are symmetrical. For the statement about the derivatives, it is enough to work on the right-hand side at 0, since F(−x) =
−F(x). Here is the argument for r = 2 from Heuer’s article. Note that, on each interval [2/(2n+1)π,2/(2n−1)π], the
function F vanishes at the endpoints and has a single extreme point xn where
1/nπ < xn < 2/(2n−1)π.
Thus the variation on this interval is 2|F(xn)|, and
(1/nπ)2 = |F(1/nπ)| < |F(xn)| < x2
n < {2/[(2n−1)π]}2 .
By the integral test for series (page 438)
1/n =
Z ∞
n dx/x2 <
∞
∑
k=n
1/k2 < (π2/2)T(2/[(2n−1)π]) <
∞
∑
k=n
[2/(2k −1)]2
<
Z ∞
(2n−3)/2 dx/x2 = 2/(2n−3).
Then, for 2/[(2n−1)π] ≤x ≤2/[(2n−3)π] (with n ≥3) we have
1/n < (π2/2)T(x) < 2/(2n−5),
and hence
(2n−3)/nπ < (1/x)T(x) < (4n−2)/[(2n−5)π]
It follows that the derivative of T on the right at zero is 2/π. By symmetry the same is true on the left so T ′(0) = 2/π.
Exercise 302, page 94
Exercise 302 shows that continuity would be needed for this result, even if there is only one point of discontinuity.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

570
CHAPTER 11. APPENDIX
Choose ε > 0 so that v+ε < V(F,[a,b]). Select points
a = y0 < y1 < y2 < ··· < yn−1 < yk = b
so that
k
∑
j=1
|F(yj)−F(yj−1)| > v+ε.
(11.5)
Since F is uniformly continuous on [a,b] there is a η > 0 so that
|F(x)−F(x′)| <
ε
2(k +1)
whenever |x−x′| < η.
We are now ready to specify our δ: we choose this smaller than η and also smaller than all the lengths y j −y j−1 for
j = 1,2,3,...,k. Now suppose that we have made a choice of points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b
such that each xi −xi−1 < δ. We shall show that
v <
n
∑
i=1
|F(xi)−F(xi−1)| ≤V(F,[a,b]
(11.6)
and this will prove the statement in the exercise.
We can split this sum up into two parts: if an interval (xi−1,xi) contains any one of the points from the collection
a = y0 < y1 < y2 < ··· < yn−1 < yk = b
that we started with, then we will call that interval a black interval. Note that, by our choice of δ, a black interval can
contain only one of the y j points. In fact, if y j ∈(xi−1,xi) we can make use of the fact that
|F(xi)−F(xi−1)| ≤|F(xi)−F(yj)|+|F(yj)−F(xi−1)| ≤
ε
(k +1).
(11.7)
If (xi−1,xi) contains none of these points we will call it a white interval. The sum in (11.6) is handled by thinking
separately about the white intervals and the black intervals.
Let combine all the xi’s and all the y j’s:
a = z0 < z1 < z2 < ··· < zn−1 < zm = b.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
571
Note that
m
∑
p=1
|F(zp)−F(zp−1)| > v+ε.
(11.8)
This is because the addition of further points always enlarges the sum or leaves it the same.
The inequality (11.6) now follows by comparing it to (11.8). There are extra white intervals perhaps where a new
point has been added, but each of these has been enlarged by adding a single point and the total extra contribution is no
more than ε because of (11.7).
Exercise 304, page 94
If F is locally of bounded variation at every point x ∈R then the collection
β = {([u,v],w) : w ∈[u,v], V(F,[u,v]) < ∞}
is a full cover of the real line. Take any interval [a,b] and choose a partition π of the interval [a,b] so that π ⊂β. Then
V(F,[a,b]) ≤
∑
([u,v],w)∈π
V(F,[u,v]) < ∞.
The converse is immediate.
Exercise 305, page 95
We suppose that f is absolutely integrable on [a,b]. Thus | f| is integrable here. Observe, then, that
n
∑
i=1
|F(xi)−F(xi−1)| =
n
∑
i=1
¯¯¯¯
Z xk
xk−1
f(x)dx
¯¯¯¯ ≤
n
∑
i=1
Z xk
xk−1
|f(x)| dx =
Z b
a |f(x)| dx
for all choices of points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b.
It follows that
V(F,[a,b]) ≤
Z b
a | f(x)|dx.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

572
CHAPTER 11. APPENDIX
Consequently F must be a function of bounded variation and we have established an inequality in one direction for the
identity
V(F,[a,b]) =
Z b
a | f(x)|dx.
Let us prove the opposite direction. Since f and | f| are integrable we may apply the Henstock property (Theo-
rem 3.22) to each of them. Write G for an indeﬁnite integral of | f| and recall that F is an indeﬁnite integral of f.
For every ε > 0 and for each point x in [a,b] there is a δ(x) > 0 so that
n
∑
i=1
|F(xi)−F(xi−1)−f(ξi)(xi −xi−1)| < ε
n
∑
i=1
|Gxi)−G(xi−1)−|f(ξi)|(xi −xi−1)| < ε
whenever {([xi,xi−1],ξi) : i = 1,2,...n} is a partition of [a,b] with each
xi −xi−1 < δ(ξi) and ξi ∈[xi−1,xi].
There must exist one such partition and for that partition
G(b)−G(a) =
n
∑
i=1
G(xi)−G(xi−1) ≤ε+
n
∑
i=1
| f(ξi)|(xi −xi−1)
≤2ε
n
∑
i=1
|Fxi)−F(xi−1) ≤V(F,[a,b]+2ε.
It follows, since ε can be any positive number, that
Z b
a | f(x)|dx = G(b)−G(a) ≤V(F,[a,b]).
This completes the proof.
Exercise 306, page 95
This is a limited theorem but useful to state and fairly easy to prove given what we now know.
We know that F′ is integrable on [a,b]; indeed, it is integrable by deﬁnition even without the assumption about the
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
573
continuity of F′. We also know that, if F′ is absolutely integrable, then F would have to be of bounded variation on
[a,b]. So one direction is clear.
To prove the other direction we suppose that F has bounded variation. Let T be the total variation function of F on
[a,b]. Then, by Theorem 3.26, T is uniformly continuous on [a,b] and T is differentiable at every point at which F is
continuously differentiable, with moreover T ′(x) = |F′(x)| at such points. Wherever F′ is continuous so too is |F′|.
Consequently we have this situation: T : [a,b] →R is a uniformly continuous function that is continuously dif-
ferentiable at every point in a bounded, open interval (a,b) with possibly ﬁnitely many exceptions. Thus T ′ = |F′| is
integrable.
Exercise 307, page 97
The limit function is f(x) = 1/x which is continuous on (0,∞) but certainly not bounded there.
Exercise 308, page 97
Each of the functions is continuous. Notice that for each x ∈(−1,1), limn→∞fn(x) = 0 and yet, for x ≥1, limn→∞fn(x) =
1. This is easy to see, but it is instructive to check the details since we can use them later to see what is going wrong in
this example. At the right-hand side on the interval [1,∞) it is clear that limn→∞fn(x) = 1.
At the other side, on the interval (−1,1) the limit is zero. For if −1 < x0 < 1 and ε > 0, let N ≥logε/log|x0|. Then
|x0|N ≤ε, so for n ≥N
| fn(x0)−0| = |x0|n < |x0|N ≤ε.
Thus
f(x) = lim
n→∞fn(x) =
½ 0
if −1 < x < 1
1
if x ≥1.
The pointwise limit f of the sequence of continuous functions { fn} is discontinuous at x = 1. (Figure 3.1 shows the
graphs of several of the functions in the sequence just on the interval [0,1].)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

574
CHAPTER 11. APPENDIX
Exercise 310, page 97
The sequence of functions fn(x) converges to zero on (−1,1) and to x −1 on [1,∞) . Now f ′
n(x) = xn−1 on (−1,1), so
by the previous exercise (Exercise 308),
lim
n→∞f ′
n(x) =
½ 0
if −1 < x < 1
1
if x ≥1,
while the derivative of the limit function, fails to exist at the point x = 1.. Thus
lim
n→∞
d
dx(fn(x)) ̸= d
dx
³
lim
n→∞fn(x)
´
at x = 1.
Exercise 312, page 99
The concept of uniform convergence would allow this argument. But interchanging two limiting operations cannot be
justiﬁed with pointwise convergence. Just because this argument looks plausible does not mean that we are under no
obligation to use ε, δ type of arguments to try to justify it.
Apparently, though, to verify the continuity of f at x0 we do need to use two limit operations and be assured that the
order of passing to the limits is immaterial.
Exercise 313, page 99
If all the functions fn had the same upper bound this argument would be valid. But each may have a different upper
bound so that the ﬁrst statement should have been
If each fn is bounded on an interval I then there must be, by deﬁnition, a number Mn so that | fn(x)| ≤Mn
for all x in I.
Exercise 314, page 99
In this exercise we illustrate that an interchange of limit operations may not give a correct result.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
575
For each row m, we have limn→∞Smn = 0. Do the same thing holding n ﬁxed and letting m →∞.
Exercise 317, page 100
We have discussed, brieﬂy, the possibility that there is a sequence that contains every rational numbers. This topic
appears in greater detail in Chapter 4.
If f did have a calculus integral there would be a function F such that F′ = f at all but ﬁnitely many points. There
would be at least one interval where f is an exact derivative and yet f does not have the Darboux property since it
assumes only the values 0 and 1 (and no values in between).
Exercise 319, page 101
The statements that are deﬁned by inequalities (e.g., bounded, convex) or by equalities (e.g., constant, linear) will not
lead to an interchange of two limit operations, and you should expect that they are likely true.
Exercise 320, page 101
As the footnote to the exercise explains, this was Luzin’s unfortunate attempt as a young student to understand limits.
The professor began by saying “What you say is nonsense.” He gave him the example of the double sequence m/(m+n)
where the limits as m →∞and n →∞cannot be interchanged and continued by insisting that “permuting two passages
to the limit must not be done.” He concluded with “Give it some thought; you won’t get it immediately.”
As yet another illustration that some properties are not preserved in the limit, compute the length of the curves in
Exercise 320 (Fig. 3.3) and compare with the length of the limiting curve [i.e., the straight line y = x].
Exercise 321, page 101
The purpose of the exercise is to lead to the notion of uniform convergence as a stronger alternative to pointwise conver-
gence.
Fix ε but let the point x0 vary. Observe that, when x0 is relatively small in comparison with ε, the number logx0 is
large in absolute value compared with logε, so relatively small values of n sufﬁce for the inequality |x0|n < ε. On the
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

576
CHAPTER 11. APPENDIX
1
1
Figure 11.3: The sequence {xn} converges inﬁnitely slowly on [0,1]. The functions y = xn are shown with n = 2, 4, 22,
and 100, with x0 = .1, .5, .9, and .99, and with ε = .1.
other hand, when x0 is near 1, logx0 is small in absolute value, so logε/logx0 will be large. In fact,
lim
x0→1−
logε
logx0
= ∞.
(11.9)
The following table illustrates how large n must be before |xn
0| < ε for ε = .1. Note that for ε = .1, there is no single
value of N such that |x0|n < ε for every value of x0 ∈(0,1) and n > N. (Figure 11.3 illustrates this.)
x0
n
.1
2
.5
4
.9
22
.99
230
.999
2,302
.9999
23,025
Some nineteenth-century mathematicians would have described the varying rates of convergence in the example by
saying that “the sequence {xn} converges inﬁnitely slowly on (0,1).” Today we would say that this sequence, which does
converge pointwise, does not converge uniformly. The formulation of the notion of uniform convergence in the next
section is designed precisely to avoid this possibility of inﬁnitely slow convergence.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
577
f
fn
Figure 11.4: Uniform convergence on the whole interval.
Exercise 322, page 102
We observed that the sequence { fn} converges pointwise, but not uniformly, on (0,1). We realized that the difﬁculty
arises from the fact that the convergence near 1 is very “slow.” But for any ﬁxed η with 0 < η < 1, the convergence is
uniform on [0,η].
To see this, observe that for 0 ≤x0 < η, 0 ≤(x0)n < ηn. Let ε > 0. Since limn→∞ηn = 0, there exists N such that if
n ≥N, then 0 < ηn < ε. Thus, if n ≥N, we have
0 ≤xn
0 < ηn < ε,
so the same N that works for x = η, also works for all x ∈[0,η). (See Figure 11.4.)
Exercise 323, page 103
Use the Cauchy criterion for convergence of sequences of real numbers to obtain a candidate for the limit function f.
Note that if { fn} is uniformly Cauchy on the interval I, then for each x ∈I, the sequence of real numbers { fn(x)} is a
Cauchy sequence and hence convergent.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

578
CHAPTER 11. APPENDIX
Exercise 324, page 103
Fix n ≥m and compute
sup
x∈[0,η]
|xn −xm| ≤ηm.
(11.10)
Let ε > 0 and choose an integer N so that ηN < ε. Equivalently we require that N > logε/logη. Then it follows
from (11.10) for all n ≥m ≥N and all x ∈[0,η] that
|xn −xm| ≤ηm < ε.
We conclude, by the Cauchy criterion, that the sequence fn(x) = xn converges uniformly on any interval [0,η], for
0 < η < 1. Here there was no computational advantage over the argument in Example 322. Frequently, though, we do
not know the limit function and must use the Cauchy criterion rather than the deﬁnition.
Exercise 325, page 103
This follows immediately from Theorem 3.31. Just check that the translation from series language to sequence language
works out in all of the details.
Exercise 326, page 103
Our computations could be based on the fact that the sum of this series is known to us; it is (1−x)−1. We could prove
the uniform convergence directly from the deﬁnition. Instead let us use the Cauchy criterion.
Fix n ≥m and compute
sup
x∈[0,η]
¯¯¯¯¯
n
∑
j=m
x j
¯¯¯¯¯ ≤sup
x∈[0,η]
¯¯¯¯
xm
1−x
¯¯¯¯ ≤
ηm
1−η.
(11.11)
Let ε > 0. Since
ηm(1−η)−1 →0
as m →∞we may choose an integer N so that
ηN(1−η)−1 < ε.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
579
Then it follows from (11.11) for all n ≥m ≥N and all x ∈[0,η] that
¯¯xm +xm+1 +···+xn¯¯ ≤
ηm
1−η < ε.
It follows now, by the Cauchy criterion, that the series converges uniformly on any interval [0,η], for 0 < η < 1. Ob-
serve, however, that the series does not converge uniformly on (0,1), though it does converge pointwise there. (See
Exercise 341.)
Exercise 327, page 104
It is not always easy to determine whether a sequence of functions is uniformly convergent. In the settings of series of
functions, this simple test is often useful. This will certainly become one of the most frequently used tools in your study
of uniform convergence.
Let Sn(x) = ∑n
k=0 fk(x). We show that {Sn} is uniformly Cauchy on I. Let ε > 0. For m < n we have
Sn(x)−Sm(x) = fm+1(x)+···+ fn(x),
so
|Sn(x)−Sm(x)| ≤Mm+1 +···+Mn.
Since the series of constants ∑∞
k=0 Mk converges by hypothesis, there exists an integer N such that if n > m ≥N,
Mm+1 +···+Mn < ε.
This implies that for n > m ≥N,
|Sn(x)−Sm(x)| < ε
for all x ∈D. Thus the sequence {Sn} is uniformly convergent on D; that is, the series ∑∞
k=1 fk is uniformly convergent
on I.
Exercise 328, page 104
Then |xk| ≤ak for every k = 0,1,2... and x ∈[−a,a]. Since ∑∞
k=0 ak converges, by the M-test the series ∑∞
k=0 xk converges
uniformly on [−a,a].
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

580
CHAPTER 11. APPENDIX
Exercise 329, page 104
The crudest estimate on the size of the terms in this series is obtained just by using the fact that the sine function never
exceeds 1 in absolute value. Thus
¯¯¯¯
sinkθ
kp
¯¯¯¯ ≤1
kp
for all θ ∈R.
Since the series ∑∞
k=1 1/kp converges for p > 1, we obtain immediately by the M-test that our series converges uniformly
(and absolutely) on the interval (−∞,∞) [or any interval in fact]. for all real θ provided p > 1.
For 0 < p < 1 the series ∑∞
k=1 1/kp diverges and the M-test supplies us with no information in these cases.
We seem to have been particularly successful here, but a closer look also reveals a limitation in the method. The
series is also pointwise convergent for 0 < p ≤1 (use the Dirichlet test) for all values of θ, but it converges nonabsolutely.
The M-test cannot be of any help in this situation since it can address only absolutely convergent series. Thus we have
obtained only a partial answer because of the limitations of the test.
Because of this observation, it is perhaps best to conclude, when using the M-test, that the series tested “converges
absolutely and uniformly” on the set given. This serves, too, to remind us to use a different method for checking uniform
convergence of nonabsolutely convergent series. See the next exercise (Exercise 330).
Exercise 330, page 104
We will use the Cauchy criterion applied to the series to obtain uniform convergence. We may assume that the bk(x) are
nonnegative and decrease to zero. Let ε > 0. We need to estimate the sum
¯¯¯¯¯
n
∑
k=m
ak(x)bk(x)
¯¯¯¯¯
(11.12)
for large n and m and all x ∈I. Since the sequence of functions {bk} converges uniformly to zero on I, we can ﬁnd an
integer N so that for all k ≥N and all x ∈I
0 ≤bk(x) ≤ε
2M.
The key to estimating the sum (11.12), now, is the summation by parts formula. This is just the elementary identity
n
∑
k=m
akbk =
n
∑
k=m
(sk −sk−1)bk
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
581
= sm(bm −bm+1)+sm+1(bm+1 −bm+2)···+sn−1(bn−1 −bn)+snbn.
This provides us with
¯¯¯¯¯
n
∑
k=m
ak(x)bk(x)
¯¯¯¯¯ ≤2M
µ
sup
x∈E
|bm(x)|
¶
< ε
for all n ≥m ≥N and all x ∈I which is exactly the Cauchy criterion for the series and proves the theorem.
Commentary: The M-test is a highly useful tool for checking the uniform convergence of a series. By its nature, though,
it clearly applies only to absolutely convergent series. Abel’s test clearly shines in this regard.
It is worth pointing out that in many applications of this theorem the sequence {bk} can be taken as a sequence of
numbers, in which case the statement and the conditions that need to be checked are simpler. For reference we can state
this as a corollary.
Corollary 11.3 Let {ak} be a sequence of functions on a set E ⊂R. Suppose that
there is a number M so that
¯¯¯¯¯
N
∑
k=1
ak(x)
¯¯¯¯¯ ≤M
for all x ∈E and every integer N. Suppose that the sequence of real numbers {bk}
converges monotonically to zero. Then the series
∞
∑
k=1
bkak
converges uniformly on E.
Exercise 331, page 105
It is possible to prove that this series converges for all θ. Questions about the uniform convergence of this series are
intriguing. In Figure 11.5 we have given a graph of some of the partial sums of the series.
The behavior near θ = 0 is most curious. Apparently, if we can avoid that point (more precisely if we can stay a
small distance away from that point) we should be able to obtain uniform convergence. Theorem 3.34 will provide a
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

582
CHAPTER 11. APPENDIX
Figure 11.5: Graph of ∑n
k=1 (sinkθ)/k on [0,2π] for, clockwise from upper left, n = 1, 4, 7, and 10.
proof. We apply that theorem with bk(θ) = 1/k and ak(θ) = sinkθ. All that is required is to obtain an estimate for the
sums
¯¯¯¯¯
n
∑
k=1
sinkθ
¯¯¯¯¯
for all n and all θ in an appropriate set. Let 0 < η < π/2 and consider making this estimate on the interval [η,2π−η].
From familiar trigonometric identities we can produce the formula
sinθ+sin2θ+sin3θ+sin4θ+···+sinnθ = cosθ/2−cos(2n+1)θ/2
2sinθ/2
and using this we can see that
¯¯¯¯¯
n
∑
k=1
sinkθ
¯¯¯¯¯ ≤
1
sin(η/2).
Now Theorem 3.34 immediately shows that
∞
∑
k=1
sinkθ
k
converges uniformly on [η,2π−η].
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
583
Figure 11.5 illustrates graphically why the convergence cannot be expected to be uniform near to 0. A computation
here is instructive. To check the Cauchy criterion on [0,π] we need to show that the sums
sup
θ∈[0,π]
¯¯¯¯¯
n
∑
k=m
sinkθ
k
¯¯¯¯¯
are small for large m, n. But in fact
sup
θ∈[0,π]
¯¯¯¯¯
2m
∑
k=m
sinkθ
k
¯¯¯¯¯ ≥
2m
∑
k=m
sin(k/2m)
k
≥
2m
∑
k=m
sin1/2
2m
> sin1/2
2
,
obtained by checking the value at points θ = 1/2m. Since this is not arbitrarily small, the series cannot converge
uniformly on [0,π].
Exercise 340, page 106
Use the Cauchy criterion for convergence of sequences of real numbers to obtain a candidate for the limit function f.
Note that if { fn} is uniformly Cauchy on a set D, then for each x ∈D, the sequence of real numbers { fn(x)} is a Cauchy
sequence and hence convergent.
Exercise 358, page 111
Let Gk(x) =
R 1
0 gk(x)dx be the indeﬁnite integrals of the gk. Observe that, for k = 2,3,4,..., the function Gk is continuous
on [0,1], piecewise linear and that it is differentiable everywhere except at the point 1−1
k; it has a right-hand derivative
O there but a left-hand derivative 2−k. That means that the partial sum
Fn(x) =
n
∑
k=2
gk(x)
is also continuous on [0,1], piecewise linear and that it is differentiable everywhere except at all the points 1 −1
k for
k = 2,3,4,....
Both
f(x) =
∞
∑
n=2
gk(x) and F(x) =
∞
∑
n=2
Gk(x)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

584
CHAPTER 11. APPENDIX
converge uniformly on [0,1] and F′(x) = f(x) at every point with the exception of all the points in the sequence
1
2, 2
3, 3
4, 4
5, 5
6,.... That is too many points for F to be an indeﬁnite integral.
Note that the functions in the sequence f1, f2, f3, . . . are continuous with only ﬁnitely many exceptions. But the
number of exceptions increase with n. That is the clue that we are heading to a function that may not be integrable in the
very severe sense of the calculus integral.
Exercise 359, page 111
Let ε > 0 and choose N so that | fn(x)−f(x)| < ε/(b−a) for all n ≥N and all x ∈[a,b]. Then, since f and each function
fn is integrable,
¯¯¯¯
Z b
a f(x)dx−
Z b
a fn(x)dx
¯¯¯¯ ≤
Z b
a |f(x)−fn(x)| dx ≤
Z b
a
ε
b−a dx = ε
for all n ≥N. This proves that
Z b
a f(x)dx = lim
n→∞
Z b
a fn(x)dx.
Note that we had to assume that f was integrable in order to make this argument work.
Exercise 360, page 112
Let g(x) = limn F′
n(x). Since each of the functions F′
n is assumed continuous and the convergence is uniform, the function
g is also continuous on the interval (a,b).
From Theorem 3.35 we infer that
Z x
a g(t)dt = lim
n→∞
Z x
a F′
n(t)dt = lim
n→∞[Fn(x)−Fn(a)] = F(x)−F(a) for all x ∈[a,b].
(11.13)
Thus we obtain
Z x
a g(t)dt = F(x)−F(a)
or
F(x) =
Z x
a g(t)dt +F(a).
It follows from the continuity of g that F is differentiable and that f ′(x) = g(x) for all x ∈(a,b).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
585
Exercise 361, page 112
To justify
1
(1−x)2 =
∞
∑
k=1
kxk−1
we observe ﬁrst that the series
∞
∑
k=0
xk
(3.5) converges pointwise on (−1,1). Next we note (Exercise 342) that the series
∞
∑
k=1
kxk−1
converges pointwise on (−1,1) and uniformly on any closed interval [a,b] ⊂(−1,1). Thus, if x ∈(−1,1) and −1 < a <
x < b < 1, then this series converges uniformly on [a,b]. Now apply Corollary 3.39.
Indeed there was a bit of trouble on the interval (−1,1), but trouble that was easily handled by working on a closed,
bounded subinterval [a,b] inside.
Exercise 362, page 112
Indeed there is a small bit of trouble on the interval (−∞,∞), but trouble that was easily handled by working on a closed,
bounded subinterval [−t,t] inside. The Weierstrass M-test can be used to verify uniform convergence since
¯¯¯¯
xk
k!
¯¯¯¯ ≤tk
k!
for all −t < x < t.
Exercise 366, page 113
The hypotheses of Theorem 3.38 are somewhat more restrictive than necessary for the conclusion to hold and we have
relaxed them here by dropping the continuity assumption. That means, though, that we have to work somewhat harder.
We also need not assume that { fn} converges on all of [a,b]; convergence at a single point sufﬁces. (We cannot, how-
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

586
CHAPTER 11. APPENDIX
ever, replace uniform convergence of the sequence { f ′
n} with pointwise convergence, as Example 310 shows.) Theorem
3.40 applies in a number of cases in which Theorem 3.38 does not.
For the purposes of the proof we can assume that the set of exceptions C is empty. For simply work on subintervals
(c,d) ⊂(a,b) that miss the set C. After obtaining the proof on each subinterval (c,d) the full statement of the theorem
follows by piecing these intervals together.
Let ε > 0. Since the sequence of derivatives converges uniformly on (a,b), there is an integer N1 so that
| f ′
n(x)−f ′
m(x)| < ε
for all n, m ≥N1 and all x ∈(a,b). Also, since the sequence of numbers { fn(x0)} converges, there is an integer N > N1
so that
| fn(x0)−fm(x0)| < ε
for all n, m ≥N. Let us, for any x ∈[a,b], x ̸= x0, apply the mean value theorem to the function fn −fm on the interval
[x0,x] (or on the interval [x,x0] if x < x0). This gives us the existence of some point ξ strictly between x and x0 so that
fn(x)−fm(x)−[ fn(x0)−fm(x0)] = (x−x0)[f ′
n(ξ)−f ′
m(ξ)].
(11.14)
From this we deduce that
| fn(x)−fm(x)| ≤|fn(x0)−fm(x0)|+|(x−x0)(f ′
n(ξ)−f ′
m(ξ)|
< ε(1+(b−a))
for any n, m ≥N. Since this N depends only on ε this assertion is true for all x ∈[a,b] and we have veriﬁed that the
sequence of continuous functions { fn} is uniformly Cauchy on [a,b] and hence converges uniformly to a continuous
function f on the closed, bounded interval [a,b].
We now know that the one point x0 where we assumed convergence is any point. Suppose that a < x0 < b. We show
that f ′(x0) is the limit of the derivatives f ′
n(x0). Again, for any ε > 0, equation (11.14) implies that
| fn(x)−fm(x)−[ fn(x0)−fm(x0)]| ≤|x−x0|ε
(11.15)
for all n,m ≥N and any x ̸= x0 in the interval (a,b). In this inequality let m →∞and, remembering that fm(x) →f(x)
and fm(x0) →f(x0), we obtain
| fn(x)−fn(x0)−[ f(x)−f(x0)]| ≤|x−x0|ε
(11.16)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
587
if n ≥N. Let C be the limit of the sequence of numbers { f ′
n(x0)}. Thus there exists M > N such that
| f ′
M(x0)−C| < ε.
(11.17)
Since the function fM is differentiable at x0, there exists δ > 0 such that if 0 < |x−x0| < δ, then
¯¯¯¯
fM(x)−fM(x0)
x−x0
−f ′
M(x0)
¯¯¯¯ < ε.
(11.18)
From Equation (11.16) and the fact that M > N, we have
¯¯¯¯
fM(x)−fM(x0)
x−x0
−f(x)−f(x0)
x−x0
¯¯¯¯ < ε.
This, together with the inequalities (11.17) and (11.18), shows that
¯¯¯¯
f(x)−f(x0)
x−x0
−C
¯¯¯¯ < 3ε
for 0 < |x−x0| < δ. This proves that f ′(x0) exists and is the number C, which we recall is limn→∞f ′
n(x0).
The ﬁnal statement of the theorem,
lim
n→∞
Z b
a f ′
n(x)dx =
Z b
a f ′(x)dx,
now follows too. We know that f ′ is the exact derivative on (a,b) of a uniformly continuous function f on [a,b] and so
the calculus integral
f(b)−f(a) =
Z b
a f ′(x)dx.
But we also know that
fn(b)−fn(a) =
Z b
a f ′
n(x)dx.
and
lim
n→∞[ fn(b)−fn(a)] = f(b)−f(a).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

588
CHAPTER 11. APPENDIX
Exercise 367, page 113
Let { fk} be a sequence of differentiable functions on an interval [a,b]. Suppose that the series ∑∞
k=0 f ′
k converges uni-
formly on [a,b]. Suppose also that there exists x0 ∈[a,b] such that the series ∑∞
k=0 fk(x0) converges. Then the series
∑∞
k=0 fk(x) converges uniformly on [a,b] to a function F, F is differentiable, and
F′(x) =
∞
∑
k=0
f ′
k(x)
for all a ≤x ≤b.
Exercise 368, page 113
It is not true. We have already seen a counterexample in Exercise 358.
Here is an analysis of the situation: Let Gn(x) =
R x
a gn(t)dt. Theorem 3.40 demands a single ﬁnite setC of exceptional
points where G′
n(x) = gn(x) might fail. In general, however, this set should depend on n. Thus, for each n select a ﬁnite
set Cn so that G′
n(x) = gn(x) is true for all x ∈[a,b]\Cn.
If C = S∞
n=1Cn is ﬁnite then we could conclude that the limit function g is integrable. But C might be inﬁnite.
Exercise 369, page 114
A simple counterexample, showing that we cannot conclude that { fn} converges on I, is fn(x) = n for all n. To see there
must exist a function f such that
f ′ = g = limn→∞f ′
n on I: Fix x0 ∈I, let Fn = fn −fn(x0) and apply Theorem 3.40
to the sequence {Fn} . Thus, the uniform limit of a sequence of derivatives { f ′
n} is a derivative even if the sequence of
primitives { fn} does not converge.
Exercise 370, page 116
If there is a ﬁnite set of points where one of the inequalities fails redeﬁne all the functions to have value zero there. That
cannot change the values of any of the integrals but it makes the inequality valid.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
589
Exercise 371, page 116
Lemma 3.41 is certainly the easier of the two lemmas. For that just notice that, for any integer N, if the inequality
f(x) ≥
N
∑
k=1
gk(x),
holds for all x in (a,b) then, since ∑N
k=1 gk(x) is integrable,
Z b
a f(x)dx ≥
Z b
a
Ã
N
∑
k=1
gk(x)
!
dx =
N
∑
k=1
µZ b
a gk(x)dx
¶
.
But if this inequality in turn is true for all N then
Z b
a f(x)dx ≥
∞
∑
k=1
µZ b
a gk(x)dx
¶
is also true.
Exercise 372, page 116
This lemma requires a bit of bookkeeping and to make this transparent we will use some language and notation. Because
the proof is a bit tricky we will also expand the steps rather more than we usually do.
1. Instead of writing a partition or subpartition out in detail in the form
{([ai,bi],ξi) : i = 1,2,...,n}
we will use the Greek letter4 π to denote a partition, so
π = {([ai,bi],ξi) : i = 1,2,...,n}
saves a lot of writing.
2. For the Riemann sum over a partition π, in place of writing the cumbersome
n
∑
i=1
f(ξi)(bi −ai)
4π is the letter in the Greek alphabet corresponding to “p” so that explains the choice. It shouldn’t interfere with your usual use of this symbol.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

590
CHAPTER 11. APPENDIX
we write merely
∑
([u,v],w)∈π
f(w)(v−u) or ∑
π
f(w)(v−u)
.
3. Instead of saying that a partition satisﬁes the usual condition
π = {([ai,bi],ξi) : i = 1,2,...,n}
with
ξi ∈[ai,bi] and bi −ai < δ(ξi).
we just say π is δ-ﬁne.
This notation will make the arguments transparent and is generally convenient.
Remember that our ﬁrst step in the proof of Lemma 3.42 is to assume that the inequality
f(x) ≤
∞
∑
k=1
gk(x),
is valid at every point of the interval [a,b]. Let ε > 0. Since f itself is assumed to be integrable the interval [a,b], the
integral can be approximated (pointwise, not uniformly) by Riemann sums. Thus we can choose, for each x ∈[a,b], a
δ0(x) > 0 so that
∑
π
f(w)(v−u) ≥
Z b
a f(x)dx−ε
whenever π is a partition of the interval [a,b] that is δ0-ﬁne. This applies Theorem 3.22.
Since g1 is integrable and, again, the integral can be approximated by Riemann sums we can choose, for each
x ∈[a,b], a δ0(x) > δ1(x) > 0 so that
∑
π
g1(w)(v−u) ≤
Z b
a g1(x)dx+ε2−1
whenever π is a partition of the interval [a,b] that is δ1-ﬁne. Since g2 is integrable and (yet again) the integral can be
approximated by Riemann sums we can choose, for each x ∈[a,b], a δ1(x) > δ2(x) > 0 so that
∑
π
g2(w)(v−u) ≤
Z b
a g2(x)dx+ε2−2
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
591
whenever π is a partition of the interval [a,b] that is δ2-ﬁne. Continuing in this way we ﬁnd, for each integer k = 1,2,3,...
a δk−1(x) > δk(x) > 0 so that
∑
π
gk(w)(v−u) ≤
Z b
a gk(x)dx+ε2−k
whenever π is a partition of the interval [a,b] that is δk-ﬁne.
Let t < 1 and choose for each x ∈[a,b] the ﬁrst integer N(x) so that
t f(x) ≤
N(x)
∑
n=1
fn(x).
Let
En = {x ∈[a,b] : N(x) = n}.
We use these sets to carve up the δk and create a new δ(x). Simply set δ(x) = δk(x) whenever x belongs to the corre-
sponding set Ek.
Take any partition π of the interval [a,b] that is δ-ﬁne (i.e., it must be a ﬁne partition relative to this newly constructed
δ.) The existence of such a partition is guaranteed by the Cousin covering argument. Note that this partition is also δ0-ﬁne
since δ(x) < δ0(x) for all x. We work carefully with this partition to get our estimates.
Let N be the largest value of N(w) for the ﬁnite collection of pairs ([u,v],w) ∈π. We need to carve the partition π
into a ﬁnite number of disjoint subsets by writing, for j = 1,2,3,...,N,
πj = {([u,v],w) ∈π : w ∈E j}
and
σ j = πj ∪πj+1 ∪···∪πN.
for integers j = 1,2,3,...,N. Note that σ j is itself a subpartition that is δ j-ﬁne. Putting these together we have
π = π1 ∪π2 ∪···∪πN.
By the way we chose δ0 and since the new δ is smaller than that we know, for this partition π that
Z b
a f(x)dx−ε ≤∑
π
f(w)(v−u)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

592
CHAPTER 11. APPENDIX
so
t
Z b
a f(x)dx−tε ≤∑
π
t f(w)(v−u).
We also will remember that for x ∈Ei,
t f(x) ≤g1(x)+g2(x)+···+gi(x).
Now we are ready for the crucial computations, each step of which is justiﬁed by our observations above:
t
Z b
a f(x)dx−tε ≤
∑
π
t f(w)(v−u) =
N
∑
i=1∑
πi
t f(w)(v−u)
≤
N
∑
i=1∑
πi
(g1(w)+g2(w)+···+gi(w))(v−u)
=
N
∑
j=1
Ã
∑
σ j
g j(w)(v−u)
!
≤
N
∑
j=1
µZ b
a g j(x)dx+ε2−j
¶
≤
∞
∑
j=1
µZ b
a g j(x)dx
¶
+ε.
Since ε is arbitrary, this shows that
t
Z b
a f(x)dx ≤
∞
∑
k=1
µZ b
a gk(x)dx
¶
.
As this is true for all t < 1 the inequality of the lemma must follow too.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
593
Exercise 374, page 116
This follows from these lemmas and the identity
f(x) = f1(x)+
∞
∑
n=1
(fn(x)−fn−1(x)).
Since fn is a nondecreasing sequence of functions, the sequence of functions fn(x)−fn−1(x) is nonnegative. As usual,
ignore the ﬁnite set of exceptional points or assume that all functions are set equal to zero at those points.
Exercise 375, page 116
We use the same technique and the same language as used in the solution of Exercise 372.
Let gn = f −fn and let Gn denote the indeﬁnite integral of the function gn. The sequence of functions {gn} is
nonnegative and monotone decreasing with limn→∞gn(x) = 0 at each x.
Let ε > 0. Choose a sequence of functions {δk} so that
∑
([u,v],w)∈π
|Gk(v)−Gk(u)−gk(w)(v−u)| < ε2−k
whenever π is a partition of the interval [a,b] that is δk-ﬁne. Choose, for each x ∈[a,b], the ﬁrst integer N(x) so that
gk(x) < ε for all k ≥N(x).
Let
En = {x ∈[a,b] : N(x) = n}.
We use these sets to carve up the δk and create a new δ(x). Simply set δ(x) = δk(x) whenever x belongs to the corre-
sponding set Ek.
Take any partition π of the interval [a,b] that is δ-ﬁne (i.e., it must be a ﬁne partition relative to this newly constructed
δ.) The existence of such a partition is guaranteed by the Cousin covering argument.
Let N be the largest value of N(w) for the ﬁnite collection of pairs ([u,v],w) ∈π. We need to carve the partition π
into a ﬁnite number of disjoint subsets by writing
πj = {([u,v],w) ∈π : w ∈E j}
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

594
CHAPTER 11. APPENDIX
for integers j = 1,2,3,...,N. Note that
π = π1 ∪π2 ∪···∪πN
and that these collections are pairwise disjoint.
Now let m be any integer greater than N. We compute
0 ≤
Z b
a gm(x)dx = Gm(b)−Gm(a) =
∑
([u,v],w)∈π
(Gm(v)−Gm(u)) =
N
∑
j=1
Ã
∑
([u,v],w)∈π j
(Gm(v)−Gm(u))
!
≤
N
∑
j=1
Ã
∑
([u,v],w)∈π j
(G j(v)−G j(u))
!
≤
N
∑
j=1
"
∑
([u,v],w)∈π j
g j(w)(v−u)+ε2−j
#
<
N
∑
j=1
"
∑
([u,v],w)∈π j
ε(v−u)+ε2−j
#
< ε(b−a+1).
This shows that
0 ≤
Z b
a gm(x)dx < ε(b−a+1)
for all m ≥N. The identity
Z b
a f(x)dx−lim
n→∞
Z b
a fn(x)dx = lim
n→∞
Z b
a gn(x)dx = 0.
follows.
Exercise 377, page 120
Just apply the theorems. We need, ﬁrst, to determine that the interval of convergence of the integrated series
F(x) =
∞
∑
n=0
xn+1/(n+1) = x+x2/2+x3/3+x4/4+...+.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
595
is [−1,1). Consequently, of the two integrals here, only one exists. Note that
F(0)−F(−1) = −F(−1) = 1−1/2+1/3−1/4−1/5+1/6−...
is a convergent alternating series and provides the value of the integral
Z 0
−1
Ã
∞
∑
n=0
xn
!
dx.
Note that the interval of convergence of the original series is (−1,1) but that is not what we need to know. We needed
very much to know what the interval of convergence of the integrated series was.
Exercise 378, page 120
The formula
1+x+x2 +x3 +x4 +···+ =
1
1−x
(−1 < x < 1)
is just the elementary formula for the sum of a geometric series. Thus we do not need to use series methods to solve the
problem; we just need to integrate the function
f(x) =
1
1−x.
We happen to know that
Z
1
1−x dx = −log(1−x)+C
on (−∞,1) so this integral is easy to work with without resorting to series methods. The integral
Z 0
−1
1
1−x dx = −log(1−0)−(−log(1−(−1)) = log2.
For the ﬁrst exercise you should have found a series that we now know adds up to log2.
Exercise 379, page 120
No, you are wrong. And don’t call me ‘Shirley.’
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

596
CHAPTER 11. APPENDIX
The condition we need concerns the integrated series, not the original series. The integrated series is
F(x) = x+x2/2+x3/3+x4/4+...+
and, while this diverges at x = 1, it converges at x = −1 since
1−1/2+1/3−1/4−1/5+1/6−...
is an alternating harmonic series, known to be convergent by the convergent alternating series test. Theorem 3.46 then
guarantees that the integral exists on [−1,0] and predicts that it might not exist on [0,1].
The mistake here can also be explained by the nature of the calculus integral. Remember that in order for a function
to be integrable on an interval [a,b] it does not have to be deﬁned at the endpoints or even bounded near them. The
careless student is fussing too much about the function being integrated and not paying close enough attention to the
integrated series. We know that F(x) is an antiderivative for f on (−1,1) so the only extra fact that we need for the
integral
R 0
−1 f(x)dx is that F is continuous on [−1,0]. It is.
Exercise 380, page 120
Yes. Inside the interval (−R,R) this formula must be valid.
Exercise 381, page 121
Yes. If we are sure that the closed, bounded interval [a,b] is inside the interval of convergence (i.e., either (−R,R) or
(−R,R] or [−R,R) or [−R,R]) then this formula must be valid.
Exercise 382, page 121
Both the series
f(x) = 1+2x+3x2 +4x3 +...
and the formally integrated series
F(x) = x+x2 +x3 +...
have a radius of convergence 1 and an interval of convergence exactly equal to (−1,1). Theorem 3.46 assures us, only,
that F is an indeﬁnite integral for f on (−1,1).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
597
But
F(x) = x+x2 +x3 +··· =
x
1−x
(−1 < x < 1).
If we deﬁne
G(x) =
x
1−x
(−1 ≤x < 1).
then G is continuous on [−1,0] and G′(x) = F′(x) = f(x) on (−1,1). Consequently
Z 0
−1 f(x)dx = G(0)−G(−1) = 1/2.
We were not able to write
Z 0
−1 f(x)dx = F(0)−F(−1) = −1+1−1+1−1+1−...
because F(−1) is not deﬁned (the series for F diverges at x = −1.
Since G(x) is unbounded near x = 1 there is no hope of ﬁnding an integral for f on [0,1].
Exercise 383, page 121
Here R = 0. Show that
lim
k→∞kkrk = 0
for every r > 0. Conclude that the series must diverge for every x ̸= 0.
Exercise 384, page 121
Do R = 0, R = ∞, and R = 1. Then for any 0 < s < ∞take your power series for R = 1 and make a suitable change,
replacing x by sx.
Exercise 388, page 122
This follows immediately from Exercise 387 without any further computation.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

598
CHAPTER 11. APPENDIX
Exercise 389, page 123
This follows immediately from the inequalities
liminf
k→∞
¯¯¯¯
ak+1
ak
¯¯¯¯ ≤liminf
k→∞
kp
|ak| ≤limsup
k→∞
kp
|ak| ≤limsup
k→∞
¯¯¯¯
ak+1
ak
¯¯¯¯,
which can be established by comparing ratios and roots, together with Exercise 386.
Exercise 390, page 123
Exercise 391, page 123
Exercise 392, page 123
Exercise 393, page 123
Exercise 394, page 124
Exercise 395, page 124
Exercise 400, page 125
If the series converges absolutely at an endpoint ±R of the interval of convergence then
|a0|+|a1|R+|a2|R2 +|a3|R3 +...
converges. For each x in the interval [−R,R],
|ak(x)xk| ≤|ak|Rk.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
599
By the Weierstrass M-test the series converges uniformly on [−R,R].
The conclusion is now that
f(x) = a0 +a1x+a2x2 +a3x3 +...
is a uniformly convergent power series on the interval [−R,R] and so f is continuous. We know that
f ′(x) = a1 +2a2x+3a3x2 +4a4x3 +...
is convergent at least on (−R,R) and that this is indeed the derivative of f there. It follows that f ′ is integrable on [−R,R]
and that f is an indeﬁnite integral on that interval.
Exercise 401, page 125
For the proof we can assume that the series
f(x) = a0 +a1x+a2x2 +a3x3 +...
has a radius of convergence 1 and that the series converges nonabsolutely atx = 1. We can assume that the interval of
convergence is (−1,1]. Any other case can be transformed into this case.
Set
sn = a0 +a1 +a2 +a3 +···+an−1
and note that, by our hypothesis that the power series converges at x = 1, this is a convergent series. The sequence
bk(x) = xk is nonnegative and decreasing on the interval [0,1]. one of the versions of Abel’s theorem (Exercise 330)
applies in exactly this situation and so we can claim that the series
∞
∑
k=0
akbk(x)
converges uniformly on [0,1]. This is what we wanted.
The conclusion is now that
f(x) = a0 +a1x+a2x2 +a3x3 +...
is a uniformly convergent power series on the interval [0,1] and so f is continuous. We know that
f ′(x) = a1 +2a2x+3a3x2 +4a4x3 +...
is convergent at least on (−1,1) and that this is indeed the derivative of f there. It follows that f ′ is integrable on [0,1].
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

600
CHAPTER 11. APPENDIX
We already know that f ′ is integrable on any interval [a,0] for −1 < a < 0. Thus f ′ is integrable on any interval [a,1]
for −1 < a < 0, and thus integrable on any interval [a,b] ⊂(−1,1].
To ﬁnish let us remark on the transformations needed to justify the ﬁrst paragraph. If
f(x) = a0 +a1x+a2x2 +a3x3 +...
converges at x = 1 then
g(x) = a0 −a1x+a2x2 −a3x3 +...
converges at x = −1 and
h(x) = a0 +R−1a1x+R−2a2x2 +R−3a3x3 +...
converges at x = R.
Exercise 403, page 125
Write out the Cauchy criterion for uniform convergence on (−r,r) and deduce that the Cauchy criterion for uniform
convergence on [−r,r] must then also hold.
Exercise 406, page 126
The best that can be concluded is that if there is any series representation for f valid at least in some interval (−r,r) for
r > 0, then
f(x) =
∞
∑
k=0
f (k)(0)
k!
xk
must be that series. But it is possible that there simply is no power series representation of a function, even assuming
that it is f is inﬁnitely often differentiable at x = 0.
Exercise 407, page 129
Each of these steps, carried out, will lead to the conclusion that the area is expressible as an integral. The ﬁrst step is the
assumption that area is additive. The second step assumes that area can be estimated above and below in this way. The
last two steps then follow mathematically from the ﬁrst two.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
601
The loosest version of this argument requires taking the concept for granted and simply assuming that an accumula-
tion argument will work for it. Thus A(x) accumulates all of the area of the region between a and x. Now add on a small
bit more to get A(x + h). The bit more that we have added on is close to f(ξ) × h for some [or any] choice of ξ inside
(x,x+h).
We “conclude” immediately that
R x
a f(t),dt expresses completely the measurement A(x) that we require. You should
be aware here of where you are making an additive assumption and where you are making an assumption of continuity.
Exercise 410, page 130
Well in fact you merely memorized that the area of a circle of radius R is πR2. Then the area of a half-circle (assuming
that it has an area) would be half of that (assuming that areas add up). Notice that by basing area on integration theory
we are on ﬁrmer ground for all such statements.
Exercise 411, page 130
The top half of the circle is the curve y =
√
r2 −x2 and the bottom half is y =
√
r2 −x2 both on the interval −r ≤x ≤r.
Just apply Deﬁnition 3.48 (and hope that you have the skills to determine exactly what the integral is).
Exercise 412, page 130
“The difﬁculty that occurs with this test of integrands is somewhat subtle. If a quantity Q is equal to the
integral of a function f, then every upper sum of f is larger than Q and every lower sum of f is smaller than
Q. On the other hand, even with some applications occurring at the most elementary level, it is not possible
to know a priori that upper and lower sums bound Q. One knows this only after showing in some other
way that the integral of f equals Q. Consider, for example, the area between the graphs of the functions
g(x) = 1 + x2 and h(x) = 2x2 on [0,1]. While for a small ∆x > 0, the maximum of g(x) −h(x) on [0,∆x]
occurs at 0, no rectangle of height 1 and width ∆x contains the region between the graphs over [0,,∆x], so
it is not clear a priori that 1 · ∆x is larger than the area of that region. Of course there are several methods
to justify the integral needed here . . . , but even for this simple example the ‘universal’ method of upper and
lower sums fails, and Bliss’s theorem also fails, as a test for the integrand.”
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

602
CHAPTER 11. APPENDIX
. . . from Peter A. Loeb, A lost theorem of the calculus, The Mathematical Intelligencer, Volume 24, Number
2 (June, 2002).
One can just ignore the difﬁculty and accept Deﬁnition 3.48 as a correct interpretation of area. Or, we could use
Deﬁnition 3.47 and insist that areas can be added and subtracted. In that way
Z 1
0 [g(x)−h(x)]dx =
Z 1
0 g(x)dx−
Z 1
0 h(x)dx
gets around the problem, since both of these areas and integrals allow an interpretation using the method of exhaustion.
Yet again, we could consider, instead, adjusted Riemann sums
n
∑
i=1
[g(ξi)−h(ξ∗
i )](xi −xi−1)
that also approximate the same integral
R 1
0 [g(x)−h(x)]dx. Then, judicious choices of ξi and ξ∗
i can be made to return to
an argument that follows the principles of the method of exhaustion.
Exercise 413, page 131
The geometric series certainly sums to the value 1. Now use the deﬁnition of the integral
R ∞
1 x−2 dx to compute its
value.
Exercise 416, page 135
First note that
max{|p|,|q|} ≤
p
p2 +q2 ≤|p|+|q|
for all real numbers p and q. Consequently, if we make any choice of points
a = t0 < t1 < t2 < ··· < tn−1 < tn = b,
the sum
n
∑
i=1
q
[F(ti)−F(ti−1)]2 +[G(ti)−G(ti−1)]2
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
603
has, as an upper bound,
n
∑
i=1
|F(ti)−F(ti−1)|+|G(ti)−G(ti−1)| ≤V(F,[a,b])+V(G,[a,b]).
Consequently, for the length L of the curve,
L ≤V(F,[a,b])+V(G,[a,b]).
In the other direction
n
∑
i=1
|F(ti)−F(ti−1)| ≤
n
∑
i=1
q
[F(ti)−F(ti−1)]2 +[G(ti)−G(ti−1)]2 ≤L.
Thus V(F,[a,b]) ≤L. The inequality V(G,[a,b]) ≤L is similarly proved.
Exercise 417, page 135
We know that F′(t) and |F′(t)| are integrable on [a,b]. We also know that
V(F,[a,b]) ≤
Z b
a |F′(t)|dt.
Consequently F has bounded variation on [a,b]. Similarly G has bounded variation on [a,b]. It follows from Exercise 416
that the curve is rectiﬁable.
Let ε > 0 and choose points
a = t0 < t1 < t2 < ··· < tn−1 < tn = b
so that
L−ε <
n
∑
i=1
q
[F(ti)−F(ti−1)]2 +[G(ti)−G(ti−1)]2 ≤L.
The sum increases if we add points, so we will add all points at which the derivatives F′(t) or G′(t) do not exist.
In between the points in the subdivision we can use the mean-value theorem to select
ti−1 < τi < ti and ti−1 < τ∗
i < ti
so that
[F(ti)−F(ti−1)] = F′(τi) and [G(ti)−G(ti−1)] = G′(τ∗
i ).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

604
CHAPTER 11. APPENDIX
Consequently
L−ε <
n
∑
i=1
q
[F′(τi)]2 +[G′(τ∗
i )]2 ≤L.
But the sums
n
∑
i=1
q
[F′(τi)]2 +[G′(τ∗
i )]2
are approximating sums for the integral
Z b
a
q
[F′(t)]2 +[G′(t)]2 dt.
Here we are applying Theorem 3.21 since we have selected two points τi and τ∗
i from each interval, rather than one point
as the simplest version of approximating Riemann sums would demand. We easily check that the function
H(p,q) =
p
p2 +q2 ≤|p|+|q|
satisﬁes the hypotheses of that theorem.
Exercise 418, page 135
Use the Darboux property of continuous functions.
Exercise 421, page 136
Translating from the language of curves to the language of functions and their graphs:
The length of the graph would be the least number L so that
n
∑
i=1
[(xi −xi−1)]2 +[f(xi)−f(xi−1)]2 ≤L
for all choices of points
a = x0 < x1 < x2 < ··· < xn−1 < xn = b.
This would be ﬁnite if and only if f has bounded variation on [a,b] and would be smaller than (b−a)+V(F,[a,b]).
A formula for this length, in the case when f is continuously differentiable on (a,b) with a bounded derivative,
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
605
would be
L =
Z b
a
q
1+[ f ′(x)]2 dx.
Exercise 422, page 136
The function is continuously differentiable, Lipschitz and so certainly of bounded variation. Hence the curve
x = t, y = f(t) (0 ≤t ≤2)
is rectiﬁable.
The formula
L =
Z 2
0
r
1+ 1
4(e2x −2+e−2x)dx
is immediate. Calculus students would be expected to have the necessary algebraic skills to continue. “Completing the
square” will lead to an integral that can be done by hand.
Exercise 423, page 140
On the interval [a,b] with no additional points inserted this is exactly the trapezoidal rule. The general formula just uses
the same idea on each subinterval.
Exercise 424, page 140
We can assume that f is twice continuously differentiable on [a,b] and then apply integration by parts [twice] to the
integral
Z b
a (x−a)(b−x)f ′′(x)dx.
One integration by parts will give
Z b
a (x−a)(b−x)f ′′(x)dx =
(x−a)(b−x)f ′(x)
¤x=b
x=a −
Z b
a [a+b−2x] f ′(x)dx
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

606
CHAPTER 11. APPENDIX
and a second integration by parts on this integral will give
[2x−(a+b)])f(x)]x=b
x=a −2
Z b
a f(x)dx = (b−a)(f(a)+ f(b))−2
Z b
a f(x)dx.
Exercise 425, page 140
Again we can assume that f is twice continuously differentiable on [a,b]. Then the preceding exercise supplies
Z b
a f(x)dx−f(a)+ f(b)
2
(b−a) = −1
2
Z b
a (x−a)(b−x)f ′′(x)dx
= −f ′′(ξ)
Z b
a (x−a)(b−x)dx = −f ′′(ξ)(b−a)3
12
,
making sure to apply the appropriate mean-value theorem for the integral above.
Exercise 426, page 140
Again we can assume that f is twice continuously differentiable on [a,b]. Then the preceding exercises supply
Z b
a f(x)dx−f(a)+ f(b)
2
(b−a) = −1
2
Z b
a (x−a)(b−x)f ′′(x)dx.
Now just use the fact that
max
x∈[a,b](x−a)(b−x) = (b−a)2
4
to estimate
Z b
a (x−a)(b−x)|f ′′(x)|dx.
Exercise 427, page 141
The preceding exercises should help.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
607
Exercise 428, page 141
This is from Edward Rozema, Estimating the error in the trapezoidal rule, The American Mathematical Monthly, Vol.
87 (2), (1980), pages 124–128.
The observation just uses the fact that the usual error is exactly equal to
n
∑
k=1
−(b−a)3
12n3
f ′′(ξi).
where here we are required to take appropriate points ξi in each interval
[xi−1,xi] =
·
a+ (i−1)(b−a)
n
,a+ i(b−a)
n
¸
(i = 1,2,3,...,n)
If we rewrite this sum in a more suggestive way the theorem is transparent. Just check that this is exactly the same
sum:
−(b−a)2
12n2
n
∑
k=1
f ′′(ξi)(xi −xi−1.
We recognize the sum as a Riemann sum for the integral
R b
a f ′′(x)dx and that integral can be evaluated as f ′(b)−f ′(a).
[For large enough n the sum is close to the integral; this is all that is intended here.]
Rozema goes on to note that, since we have an explicit (if approximate) error, we may as well use it. Thus an
improved trapezoidal rule is
Z b
a f(x)dx ≈Tn −(b−a)2
12n2
[ f ′(b)−f ′(a)]
and the error estimate when using the improvement can be shown to be
f ′′′′(ξ)(b−a)5
720n4
which is rather better than the error for the original trapezoidal rule.
Exercise 429, page 142
We can see (since the correct value of the integral is provided) that n = 1 or n = 2 is nowhere large enough. A simple
trial-and-error approach might work. Look for a large value of n, compute the trapezoidal rule approximation and see if
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

608
CHAPTER 11. APPENDIX
we are close enough. Apart from being tedious, this isn’t much of a “method.” For one thing we do not expect normally
to be asked such a question when the value is already guaranteed. More importantly, even if we could determine that
n = 50,000 is large enough, how would we know that larger values of n are equally accurate. The trapezoidal rule
eventually converges to the correct value, but it does not (in general) work out that the values get closer and closer to the
correct value.
In the case here the situation is really quite simpler. Since the function f(x) = ex2 is convex [sometimes called
concave up] on the interval [0,1] the trapezoidal rule always overestimates the integral. Each successive application for
larger n will get closer as it will be smaller. So you could solve the problem using trial-and-error in this way.
If you know how to program then this is reasonable. On the web you can also ﬁnd Java Applets that will do the job
for you. For example, at the time of writing, a nice one is here
www.math.ucla.edu/ . . . ronmiech/Java Applets/Riemann/index.html
that allows you to input
{f(x)= exp(x^2)}
and select the number of subdivisions. It is perhaps more instructive to do some experimental play with such applets
than to spend an equal time with published calculus problems.
A more sensible method, which will be useful in more situations, is to use the published error estimate for the
trapezoidal rule to ﬁnd how large n must be so that the error is small enough to guarantee nine decimal place accuracy.
The second derivative of f(x) = ex2 is
f ′′(x) = 2ex2 +4x2ex2.
A simple estimate on the interval [0,1] shows that 2 ≤f ′′(ξ) ≤6e = 16.30969097 for all 0 ≤ξ ≤1.
We know that the use of the trapezoidal rule at the nth stage produces an error
error = −
1
12n2 f ′′(ξ),
where ξ is some number between 0 and 1.
Consequently if we want an error less than 10−9/2 [guaranteeing a nine decimal accuracy] we could require
1
12n2 f ′′(ξ) ≤
1
12n2 (16.30969097) < 10−9/2.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
609
So
n2 > 1
12(16.30969097)(2×109)
or n > 52138 will do the trick. Evidently a trial-and-error approach might have been somewhat lengthy. Notice that this
method, using the crude error estimate for the trapezoidal rule, guarantees that for all n > 52138 the answer provided by
that rule will be correct to a nine decimal accuracy. It does not at all say that we must use n this large. Smaller n will
doubtless sufﬁce too, but we would have to use a different method to ﬁnd them.
What we could do is use a lower estimate on the error. We have
error = −
1
12n2 f ′′(ξ) ≥−
2
12n2 ,
where ξ is some number between 0 and 1. Thus we could look for values of n for which
−
2
12n2 > −10−9
which occurs for n2 < 1
6109, or n < 12909.9. Thus, before the step n = 12,909 there must be an error in the trapezoidal
rule which affects at least the ninth decimal place.
Exercise 430, page 144
To show that
R ∞
0 xne−x dx = n! ﬁrst ﬁnd a recursion formula for
In =
Z ∞
0 xne−x dx (n = 0,1,2,3,...)
by integration by parts. A direct computation shows that I0 = 1 and an integration by parts shows that In = nIn−1. It
follows, by induction, that In = n!.
In fact Maple is entirely capable of ﬁnding the answer to this too. Input the same command:
> int(x^n* exp(-x), x=0..infinity );
memory used=3.8MB, alloc=3.1MB, time=0.38
GAMMA(n + 1)
The Gamma function is deﬁned as Γ(n+1) = n! at integers, but is deﬁned at nonintegers too.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

610
CHAPTER 11. APPENDIX
Exercise 432, page 145
This is called the Cauchy-Schwarz inequality and is the analog for integrals of that same inequality in elementary courses.
It can be proved the same way and does not involve any deep properties of integrals.
Exercise 433, page 145
For example, prove the following:
1. log1 = 0.
2. logx < logy if 0 < x < y.
3. limx→∞logx = ∞and limx→0+ logx = 0.
4. the domain and range are both (0,∞).
5. logxy = logx+logy if 0 < x,y.
6. logx/y = logx−logy if 0 < x,y.
7. logxr = rlogx for x > 0 and r = 1,2,3,....
8. loge = 1 where e = limn→∞(1+1/n)n.
9.
d
dx logx = 1/x for all x > 0.
10. log2 = 0.69... .
11. log(1+x) = −x−x2
2 −x3
3 −x4
4 −... for −1 < x < 1.
Exercise 436, page 148
Take any sequence. It must contain every element of /0 since there is nothing to check.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
611
Exercise 437, page 148
If the ﬁnite set is {c1,c2,c3,...,cm} then the sequence
c1,c2,c3,...,cm,cm,cm,cm,...
contains every element of the set.
Exercise 438, page 148
If the sequence
c1,c2,c3,...,cm,...
contains every element of some set it must certainly contain every element of any subset of that set.
Exercise 439, page 148
The set of natural numbers is already arranged into a list in its natural order. The set of integers (including 0 and the
negative integers) is not usually presented in the form of a list but can easily be so presented, as the following scheme
suggests:
0,1,−1,2,−2,3,−3,4,−4,5,−5,6,−6,7,−7,....
Exercise 440, page 148
The rational numbers can also be listed but this is quite remarkable, for at ﬁrst sight no reasonable way of ordering them
into a sequence seems likely to be possible. The usual order of the rationals in the reals is of little help.
To ﬁnd such a scheme deﬁne the “rank” of a rational number m/n in its lowest terms (with n ≥1) to be |m|+n. Now
begin making a ﬁnite list of all the rational numbers at each rank; list these from smallest to largest. For example, at rank
1 we would have only the rational number 0/1. At rank 2 we would have only the rational numbers −1/1, 1/1. At rank
3 we would have only the rational numbers −2/1, −1/2, 1/2, 2/1. Carry on in this fashion through all the ranks. Now
construct the ﬁnal list by concatenating these shorter lists in order of the ranks:
0/1,−1/1,1/1,−2/1,−1/2,1/2,2/1,....
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

612
CHAPTER 11. APPENDIX
This sequence will include every rational number.
Exercise 441, page 148
If the sequence
c1,c2,c3,...,cm,...
contains every element of a set A and the sequence
d1,d2,d3,...,dm,...
contains every element of a set B, then the combined sequence
c1,d1,c2,d2,c3,d3 ...,cm,dm,...
contains every element of the union A∪B.
By induction, then the union of any ﬁnite number of countable sets is countable. That is not so remarkable in view
of the next exercise.
Exercise 442, page 148
We show that the following property holds for countable sets: If
S1, S2, S3, ...
is a sequence of countable sets of real numbers, then the set S formed by taking all elements that belong to at least one
of the sets Si is also a countable set.
We can consider that the elements of each of the sets Si can be listed, say,
S1 = {x11,x12,x13,x14,...}
S2 = {x21,x22,x23,x24,...}
S3 = {x31,x32,x33,x34,...}
S4 = {x41,x42,x43,x44,...}
and so on. Now try to think of a way of listing all of these items, that is, making one big list that contains them all.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
613
Describe in a systematic way a sequence that starts like this:
x11,x12,x21,x13,x22,x23,x14,x23,x32,x41,...
Exercise 443, page 148
First of all establish that for such a function and at every point a < x ≤b, the one-sided limit F(x−) = limx→x−F(x)
exists and that, at every point a ≤x < b, the one-sided limit F(x+) = limx→x+ F(x) exists. Note that, again because the
function is monotonic, nondecreasing,
F(x−) ≤F(x) ≤F(x+)
at all a < x < b. Consequently F is continuous at a point x if and only if the one-sided limits at that point have the same
value as F(x).
For each integer n let Cn be the set of points x such that F(x+) −F(x−) > 1/n. Because F is nondecreasing, and
because F(b)−F(a) is ﬁnite there can only be ﬁnitely many points in any set Cn. To see this take, if possible, any points
a < c1 < c2 < ··· < cp < b from the set Cn and select points
a = x0 < c1 < x1 < c2 < ··· < xp−1 < cp < xp = b.
Then
F(xi−1) ≤F(ci−) ≤F(ci+) ≤F(xi)
and so
p/n <
p
∑
i=1
[F(ci+)−F(ci−)] ≤
p
∑
i=1
[F(xi)−F(xi))] = F(b)−F(a).
Thus the number of points in Cn cannot be larger than n(F(b)−F(a).
The total set of points of discontinuity includes all the ﬁnite sets Cn together with (possibly) the points a and b. This
set must be countable.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

614
CHAPTER 11. APPENDIX
Exercise 445, page 149
If (a,b) is countable then ﬁnd a function f : (a,b) →(0,1) one-to-one onto and consider the sequence f(sn), where {sn}
is a sequence that is claimed to have all of (a,b) as its range.
The simplest such function is, perhaps, f(t) = (t −a)/(b −a). The same function shows that [a,b] is countable if
and only if [0,1] is countable. But if [0,1] is countable so is its subset (0,1). Indeed, if there exists a countable interval,
then all intervals, open or closed, bounded or unbounded must be countable too.
Exercise 446, page 149
Recall that
1. Every number has a decimal expansion.
2. The decimal expansion is unique except in the case of expansions that terminate in a string of zeros or nines [e.g.,
1/2 = 0.5000000··· = .49999999...], thus if a and b are numbers such that in the nth decimal place one has a 5
(or a 6) and the other does not then either a ̸= b, or perhaps one ends in a string of zeros and the other in a string
of nines.
3. Every string of 5’s and 6’s deﬁnes a real number with that decimal expansion.
We suppose that the theorem is false and that there is a sequence {sn} so that every number in the interval (0,1)
appears at least once in the sequence. We may assume that all of the numbers of the sequence are in the interval (0,1)
[otherwise remove them].
We obtain a contradiction by showing that this cannot be so. We shall use the sequence {sn} to ﬁnd a number c in
the interval (0,1) so that sn ̸= c for all n.
Each of the points s1, s2, s3 . . . in our sequence is a number between 0 and 1 and so can be written as a decimal
fraction. If we write this sequence out in decimal notation it might look like
s1 = 0.x11x12x13x14x15x16 ...
s2 = 0.x21x22x23x24x25x26 ...
s3 = 0.x31x32x33x34x35x36 ...
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
615
etc. Now it is easy to ﬁnd a number that is not in the list. Construct
c = 0.c1c2c3c4c5c6 ...
by choosing ci to be either 5 or 6 whichever is different from xii. This number cannot be equal to any of the listed
numbers s1, s2, s3 . . . since c and si differ in the ith position of their decimal expansions. This gives us our contradiction
and so proves the theorem.
Exercise 447, page 149
Well, you could . . . . But you are missing the point of a proof by contradiction. To prove the theorem, we suppose that
it fails and then obtain a contradiction from that assumption. Here we are supposing that we have succeeded in ﬁnding
a listing of all the numbers from the interval (0,1). We construct a number that is not in the list and conclude that our
assumption [that we have succeeded in ﬁnding a listing] is simply not valid.
Exercise 448, page 149
We suppose that the theorem is false and that there is a sequence {sn} so that every number in the interval (a,b) appears
at least once in the sequence.
We obtain a contradiction by showing that this cannot be so. We shall use the sequence {sn} to ﬁnd a number c in
the interval (a,b) so that sn ̸= c for all n.
Choose a subinterval [c1,d1] ⊂(a,b) that does not contain the ﬁrst element s1 of the sequence. Then choose a
subinterval [c2,d2] ⊂[c1,d1]) that does not contain the second element s2 of the sequence. Continue inductively in this
manner to produce a nested sequence of closed bounded intervals. There is at least one point c that belongs to each of
these intervals and yet that point cannot appear in the sequence {sn}.
Exercise 449, page 149
Find a way of ranking the algebraic numbers in the same way that the rational numbers were ranked in Exercise 440.
Try this for a rank: take the smallest number
n+|an|+|an−1|+···+|a1|+|a0|
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

616
CHAPTER 11. APPENDIX
as the rank of an algebraic number if it satisﬁes the equation
anxn +an−1xn−1 +···+a1x+a0 = 0.
Now verify that there are only ﬁnitely many algebraic numbers at any rank. The union of the set of algebraic numbers at
all the different ranks must then be countable.
Exercise 450, page 149
Every interval must contain inﬁnitely many transcendental numbers otherwise that interval must be countable. The
interval would then be countable itself, since it must then be contained in the union of the set of algebraic numbers
[which is countable] and the set of transcendental numbers [which we imagine is countable]. In fact, then, the set of
transcendental numbers in any interval must be uncountable.
Exercise 451, page 151
Exercise 166 can be used.
Exercise 452, page 151
The derivative of F exists at all points in (0,1) except at these corners 1/n, n = 2,3,4,5,.... If a > 0 then the interval
[a,1] contains only ﬁnitely many corners. But the interval (0,1) contains countably many corners! Thus the calculus
integral in both the ﬁnite set version and in the countable set version will provide
Z b
a F′(x)dx = F(b)−F(a)
for all 0 < a < b ≤1. The claim that
Z b
0 F′(x)dx = F(b)−F(0)
for all 0 < b ≤1 can be made only for the new extended integral.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
617
Exercise 453, page 151
The same proof that worked for the calculus integral will work here. We know that, for any bounded function f on an
interval (a,b), there is a uniformly continuous function on [a,b] whose derivative is f(x) at every point of continuity of
f.
Exercise 455, page 152
Just kidding. But if some instructor has a need for such a text we could rewrite Chapters 2 and 3 without great difﬁculty to
accommodate the more general integral. The discussion of countable sets in Chapter 4 moves to Chapter 1. The deﬁnition
of the indeﬁnite integral in Chapter 2 and the deﬁnite integral in Chapter 3 change to allow countable exceptional sets.
Most things can stay unchanged but one would have to try for better versions of many statements. Since this new
integral is also merely a teaching integral we would need to strike some balance between ﬁnding the best version possible
and simply presenting a workable theory that the students can eventually replace later on with the correct integration
theory on the real line.
Exercise 456, page 152
We will leave the reader to search for an example of such a sequence. The exercise should leave you with the impression
that the countable set version of the calculus integral is sufﬁciently general to integrate just about any example you could
imagine creating. It is not hard to ﬁnd a function that is not integrable by any reasonable method. But if it is possible (as
this exercise demands) to write
f(x) =
∞
∑
k=1
gk(x)
and if
∞
∑
k=1
µZ b
a gk(x)dx
¶
converges then, certainly, f should be integrable. Any method that fails to handle f is inadequate.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

618
CHAPTER 11. APPENDIX
With some work and luck you might consider the series
∞
∑
k=1
ak
p
|x−rk|
where ∑∞
k=1 ak converges and {rk} is an enumeration of the rationals in [0,1]. This is routinely handled by modern
methods of integration but the Riemann integral and these two weak versions of the calculus integral collapse with such
an example.
Exercise 457, page 153
Start with a set N that contains a single element c and show that that set has measure zero according to the deﬁnition.
Let ε > 0 and choose δ(c) = ε/2. Then if a subpartition
{([ci,di],c) : i = 1,2}
is given so that
0 < di −ci < δ(c) (i = 1,2)
then
2
∑
i=1
(di −ci) < ε/2+ε/2 = ε.
Note that we have used only two elements in the subpartition since we cannot have more intervals in a subpartition with
one associated point c.
Now consider a set N = {c1,c2,c3,...,cn} that contains a ﬁnite number of elements. We show that that set has
measure zero according to the deﬁnition. Let ε > 0 and choose δ(ci) = ε/(2n) for each i = 1,2,3,...,n. Use the same
argument but now with a few more items to keep track of.
Exercise 458, page 153
Now consider a countable set N = {c1,c2,c3,...,} that contains an ﬁnite number of elements. We show that that set has
measure zero according to the deﬁnition. Let ε > 0 and choose δ(ck) = ε2−k−1 for each i = 1,2,3,...,n. Use the same
argument as in the preceding exercise but now with a quite a few more items to keep track of.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
619
Suppose that we now have a subpartition
{([ci,di],ξi) : i = 1,2,...,n}
with each ξi = ck ∈N for some k, and so that
0 < di −ci < δ(ξi) (i = 1,2,...,n).
Then to estimate the sum
n
∑
i=1
(di −ci)
just check the possibilities where ([ci,di],ξi) = ([ci,di],ck) for some k. Each of these adds no more than 2ε2−k−1 to the
value of the sum. But
∞
∑
k=1
ε2−k = ε.
Exercise 459, page 153
Prove this by contradiction. If an interval [a,b] does indeed have measure zero then, for any ε > 0, and every point
ξ ∈[a,b] we should be able to ﬁnd a δ(ξ) > 0 with the following property: whenever a subpartition
{([ci,di],ξi) : i = 1,2,...,n}
is given with each ξi ∈[a,b] and so that
0 < di −ci < δ(ξi) (i = 1,2,...,n)
then
n
∑
i=1
(di −ci) < ε.
By the Cousin covering argument there is indeed such a partition
{([ci,di],ξi) : i = 1,2,...,n}
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

620
CHAPTER 11. APPENDIX
with this property that is itself a full partition of the interval [a,b]. For that partition
n
∑
i=1
(di −ci) = b−a.
This is impossible.
Exercise 460, page 153
To easy for a hint.
Exercise 461, page 153
We know that subsets of sets of measure zero have themselves measure zero. Thus if N1 and N2 are the two sets of
measure zero, write
N1 ∪N2 = N1 ∪[N2 \N1].
The sets on the right are disjoint sets of measure zero. So it is enough if we prove the statement, assuming always that
the two sets are disjoint and have measure zero.
Let ε > 0. To every point ξ ∈N1 or ξ ∈N2, there is a δ(ξ) > 0 with the following property: whenever a subpartition
{([ci,di],ξi) : i = 1,2,...,n}
is given with each ξi ∈N1 or else with ξi ∈N2 and so that
0 < di −ci < δ(ξi) (i = 1,2,...,n)
then
n
∑
i=1
(di −ci) < ε/2.
Together that means that whenever a subpartition
{([ci,di],ξi) : i = 1,2,...,n}
is given with each ξi ∈N1 ∪N2 and so that
0 < di −ci < δ(ξi) (i = 1,2,...,n)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
621
then
n
∑
i=1
(di −ci) < ε/2+ε/2 = ε,
since we can easily split the last sum into two parts depending on whether the associated points ξi belong to N1 or belong
to N2.
Exercise 462, page 153
We repeat our argument for the two set case but taking a little extra care. We know that subsets of sets of measure zero
have themselves measure zero. Thus if N1, N2, N3, . . . is a sequence of sets of measure zero, write
N1 ∪N2 ∪N3 ··· = N1 ∪[N2 \N1]∪(N3 \[N1 ∪N2])∪....
The sets on the right are disjoint sets of measure zero. So it is enough if we prove the statement, assuming always that
the sets in the sequence are disjoint and have measure zero.
Let ε > 0. To every point ξ ∈Nk there is a δ(ξ) > 0 with the following property: whenever a subpartition
{([ci,di],ξi) : i = 1,2,...,n}
is given with each ξi ∈Nk and so that
0 < di −ci < δ(ξi) (i = 1,2,...,n)
then
n
∑
i=1
(di −ci) < ε2−k.
Together that means that whenever a subpartition
{([ci,di],ξi) : i = 1,2,...,n}
is given with each ξi ∈N1 ∪N2 ∪N3 ∪... and so that
0 < di −ci < δ(ξi) (i = 1,2,...,n)
then
n
∑
i=1
(di −ci) <
p
∑
k=1
ε2−k < ε,
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

622
CHAPTER 11. APPENDIX
since we can easily split the last sum into ﬁnitely many parts depending on whether the associated points ξi belong to
N1, or N2, or N3, . . . , or Np for some (possibly large) p.
Exercise 463, page 153
Let ε > 0. Since the series ∑∞
k=1(bk −ak) converges there must be an integer N such that
∞
∑
k=N
(bk −ak) < ε
. Note that every point of E is contained in one of the intervals (ak,bk) for k = N, N + 1, N + 2, . . . . For each x ∈E
select the ﬁrst one of these intervals (ak,bk) that contains x. Choose δ(x) < (bk −ak)/2. This deﬁnes δ(x) for all x in E.
Whenever a subpartition
{([ci,di],ξi) : i = 1,2,...,n}
is given with each ξi ∈E and so that
0 < di −ci < δ(ξi) (i = 1,2,...,n)
then note that the interval [ci,di] belongs to one at least of the intervals (ak,bk). Hence the sum
n
∑
i=1
(di −ci)
can be split into a ﬁnite number of subsums each adding up to no more that (bk −ak) for some k = N, N +1, N +2, . . . .
. It follows that
n
∑
i=1
(di −ci) < ε.
Exercise 464, page 155
From each of the four closed intervals that make up the set K2 remove the middle third open interval. This will lead to
K3 =
·
0, 1
27
¸
∪
· 2
27, 3
27
¸
∪....
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
623
There should be eight intervals in all at this stage.
Exercise 466, page 156
First note that G is an open dense set in [0,1]. Write G = S∞
k=1(ak,bk). (The component intervals (ak,bk) of G can be
called the intervals complementary to K in (0,1). Each is a middle third of a component interval of some Kn.) Observe
that no two of these component intervals can have a common endpoint. If, for example, bm = an, then this point would
be an isolated point of K, and K has no isolated points.
Next observe that for each integer k the points ak and bk are points of K. But there are other points of K as well.
In fact, we shall see presently that K is uncountable. These other points are all limit points of the endpoints of the
complementary intervals. The set of endpoints is countable, but the closure of this set is uncountable as we shall see.
Thus, in the sense of cardinality, “most” points of the Cantor set are not endpoints of intervals complementary to K.
Show that the remaining set K = [0,1]\G is closed and nowhere dense in [0,1]. Show that K has no isolated points
and is nonempty. Show that K is a nonempty, nowhere dense perfect subset of [0,1].
Now let
G =
∞
[
n=1
Gn
and let
K = [0,1]\G =
∞
\
n=1
Kn.
Then G is open and the set K (our Cantor set) is closed.
To see that K is nowhere dense, it is enough, since K is closed, to show that K contains no open intervals. Let J be
an open interval in [0,1] and let λ be its length. Choose a natural number n such that 1/3n < λ. By property 5, each
component of Kn has length 1/3n < λ, and by property 2 the components of Kn are pairwise disjoint. Thus Kn cannot
contain J, so neither can K = T∞
1 Kn. We have shown that the closed set K contains no intervals and is therefore nowhere
dense.
It remains to show that K has no isolated points. Let x0 ∈K. We show that x0 is a limit point of K. To do this we
show that for every ε > 0 there exists x1 ∈K such that 0 < |x1 −x0| < ε. Choose n such that 1/3n < ε. There is a
component L of Kn that contains x0. This component is a closed interval of length 1/3n < ε. The set Kn+1 ∩L has two
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

624
CHAPTER 11. APPENDIX
components L0 and L1, each of which contains points of K. The point x0 is in one of the components, say L0. Let x1 be
any point of K ∩L1. Then 0 < |x0 −x1| < ε. This veriﬁes that x0 is a limit point of K. Thus K has no isolated points.
Exercise 467, page 156
Each component interval of the set Gn has length 1/3n; thus the sum of the lengths of these component intervals is
2n−1
3n
= 1
2
µ2
3
¶n
.
It follows that the lengths of all component intervals of G forms a geometric series with sum
∞
∑
n=1
1
2
µ2
3
¶n
= 1.
(This also gives us a clue as to why K cannot contain an interval: After removing from the unit interval a sequence of
pairwise disjoint intervals with length-sum one, no room exists for any intervals in the set K that remains.)
Exercise 468, page 156
Here is a hint that you can use to make into a proof. Let E be the set of all points in the Cantor set that are not endpoints
of a complementary interval. Then the Cantor set is the union of E and a countable set. If E has measure zero, so too
has the Cantor set.
Let ε > 0 and choose N so large that
N
∑
n=1
1
2
µ2
3
¶n
> 1−ε.
i.e., so that
∞
∑
n=N+1
1
2
µ2
3
¶n
< ε.
Here is how to deﬁne a δ(ξ) for every point in the set E. Just make sure that δ(ξ) is small enough that the open interval
(ξ −δ(ξ),ξ,+δ(ξ)) does not contain any of the open intervals complementary to the Cantor set that are counted in the
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
625
sum
N
∑
n=1
1
2
µ2
3
¶n
> 1−ε.
Now check the deﬁnition to see that E satisﬁes the required condition to check that it is a set of measure zero. Using
this δ guarantees that the intervals you will sum do not meet these open intervals that we have decided make up most of
[0,1] (i.e., all but ε).
Exercise 472, page 157
This exercise shows that there is a purely arithmetical construction for the Cantor set. You will need some familiarity
with ternary (base 3) arithmetic here.
Each x ∈[0,1] can be expressed in base 3 as
x = .a1a2a3 ...,
where ai = 0, 1 or 2, i = 1,2,3,... . Certain points have two representations, one ending with a string of zeros, the other
in a string of twos. For example, .1000··· = .0222... both represent the number 1/3 (base ten). Now, if x ∈(1/3,2/3),
a1 = 1, thus each x ∈G1 must have ‘1’ in the ﬁrst position of its ternary expansion. Similarly, if
x ∈G2 =
µ1
9, 2
9
¶
∪
µ7
9, 8
9
¶
,
it must have a 1 in the second position of its ternary expansion (i.e., a2 = 1). In general, each point in Gn must have
an = 1. It follows that every point of G = S∞
1 Gn must have a 1 someplace in its ternary expansion.
Now endpoints of intervals complementary to K have two representations, one of which involves no 1’s. The re-
maining points of K never fall in the middle third of a component of one of the sets Kn, and so have ternary expansions
of the form
x = .a1a2 ...
ai = 0 or 2.
We can therefore describe K arithmetically as the set
{x = .a1a2a3 ... t (base three) : ai = 0thereexists or 2 for each i ∈N}.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

626
CHAPTER 11. APPENDIX
Exercise 473, page 157
In fact, K can be put into 1-1 correspondence with [0,1]: For each
x = .a1a2a3 ... (base 3), ai = 0,2,
in the set K, let there correspond the number
y = .b1b2b3 ... (base 2), bi = ai/2.
This provides a 1-1 correspondence between K (minus endpoints of complementary intervals) and [0,1] (minus the
countable set of numbers with two base 2 representations). By allowing these two countable sets to correspond to each
other, we obtain a 1-1 correspondence between K and [0,1].
Exercise 474, page 157
“When I was a freshman, a graduate student showed me the Cantor set, and remarked that although there
were supposed to be points in the set other than the endpoints, he had never been able to ﬁnd any. I regret to
say that it was several years before I found any for myself.”
Ralph P. Boas, Jr, from Lion Hunting & Other Mathematical Pursuits (1995).
It is clear that there must be many irrational numbers in the Cantor ternary set, since that set is uncountable and the
rationals are countable. Your job is to ﬁnd just one.
Exercise 477, page 158
This is certainly true for some open sets, but not for all open sets. Consider G = (0,1)\C where C is the Cantor ternary
set. The closure of G is all of the interval [0,1] so that G and its closure do not differ by a countable set and contain many
more points than the endpoints as the student falsely claims.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
627
Figure 11.6: The Cantor function.
Exercise 481, page 161
See Donald R. Chalice, "A Characterization of the Cantor Function." Amer. Math. Monthly 98, 255–258, 1991 for a
proof of the more difﬁcult direction here, namely that the only monotone, nondecreasing function on [0,1] that has these
three properties is the Cantor function. Figure 11.6 should be of assistance is seeing that each of the three properties
holds. To verify them use the characterization of the function in the preceding exercise.
Exercise 482, page 162
There is nothing to prove. Write the two deﬁnitions and observe that they are identical.
Exercise 483, page 162
There is immediate. If the deﬁnition holds for the larger set then it holds without change for the smaller set.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

628
CHAPTER 11. APPENDIX
Exercise 484, page 162
Let ε > 0. Then for every x ∈E1 there is a δ1(x) > 0
n
∑
i=1
|F(bi)−F(ai)| < ε/2
whenever a subpartition {([ai,bi],ξi) : i = 1,2,...,n} is chosen for which
ξi ∈E1 ∩[ai,bi] and bi −ai < δ(ξi).
Similarly for every x ∈E2 there is a δ2(x) > 0
n
∑
i=1
|F(bi)−F(ai)| < ε
whenever a subpartition {([ai,bi],ξi) : i = 1,2,...,n} is chosen for which
ξi ∈E2 ∩[ai,bi] and bi −ai < δ(ξi).
Take δ(x) in such a way, that if a point x happens to belong to both sets then δ(x) is the minimum of δ1(x) and δ2(x).
For points that are not in both take δ(x) either δ1(x) or δ2(x).
Whenever a subpartition
{([ai,bi],ξi) : i = 1,2,...,n}
is chosen for which
ξi ∈(E1 ∪E2)∩[ai,bi] and bi −ai < δ(ξi)
the sum
n
∑
i=1
|F(bi)−F(ai)|
splits into two parts, depending on whether the ξi are in the ﬁrst set E1 or the second set E2. It follows that
n
∑
i=1
|F(bi)−F(ai)| < ε/2+ε/2.
We have given all the details here since the next exercise requires the same logic but rather more detail.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
629
Exercise 485, page 162
We can simplify the argument by supposing, without loss of generality, that the sets are disjoint. This can be arranged
by using subsets of the E j so that the union E = S∞
j=1 E j is the same.
Let ε > 0 and let j = 1,2,3,.... Then for every x ∈E j there is a δ j(x) > 0
n
∑
i=1
|F(bi)−F(ai)| < ε2−j
whenever a subpartition {([ai,bi],ξi) : i = 1,2,...,n} is chosen for which
ξi ∈E j ∩[ai,bi] and bi −ai < δ j(ξi).
Simply deﬁne δ(x) = δ j(x) if x ∈E j. Whenever a subpartition
{([ai,bi],ξi) : i = 1,2,...,n}
is chosen for which
ξi ∈E ∩[ai,bi] and bi −ai < δ(ξi)
the sum
n
∑
i=1
|F(bi)−F(ai)|
splits into ﬁnitely many parts, depending on whether the ξi are in the ﬁrst set E1, or the second set E2, or the third set E3,
etc. It follows that
n
∑
i=1
|F(bi)−F(ai)| <
∞
∑
j=1
ε2−j = ε.
Exercise 486, page 163
If f is bounded on N then this is simple. Just use an upper bound, say | f(x)| ≤M for x ∈N and note that
n
∑
i=1
| f(ξi)|(bi −ai) ≤M
n
∑
i=1
(bi −ai).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

630
CHAPTER 11. APPENDIX
If f is not bounded on N write, for every integer j = 1,2,3,...
Nj = {x ∈N : j −1 ≤|f(x)| < j}
and argue on each of these sets. Notice that we have zero variation on each set Nj since f is bounded on each set. The
extension to the union of the sets {Nj} is just a repetition of the details used in the proof of Exercise 485; just replace
the sums
n
∑
i=1
|F(bi)−F(ai)|
by
n
∑
i=1
| f(ξi)|(bi −ai).
Exercise 487, page 163
This is particularly easy since
n
∑
i=1
|F(bi)−F(ai)−f(ξi)(bi −ai)| ≤
n
∑
i=1
|F(bi)−F(ai)|+
n
∑
i=1
| f(ξi)|(bi −ai)|.
Exercise 488, page 163
Select, for every x ∈E, a δ(x) > 0 so that
|F(v)−F(u)−f(x)(v−u)| < ε(v−u)
b−a
for all 0 < v−u < δ(x) for which u ≤x ≤v. Then just check the inequality works since, if
ξi ∈E ∩[ai,bi] and bi −ai < δ(ξi),
then
|F(bi)−F(ai)−f(ξi)(bi −ai)| < ε(bi −ai)
b−a
.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
631
Exercise 489, page 163
The Cantor function is, in fact, constant on each component of the open set complementary to the Cantor set in the
interval [0,1]. From that observation it is clear than the Cantor function has zero variation on each component interval
of G. Then use Exercise 485.
Exercise 490, page 164
Let ε > 0. For every x ∈(a,b) there is a δ(x) > 0 such that
n
∑
i=1
|F(bi)−F(ai)| < ε
whenever a subpartition {([ai,bi],ξi) : i = 1,2,...,n} is chosen for which
ξi ∈(a,b)∩[ai,bi] and bi −ai < δ(ξi).
Consider any interval [c,d] ⊂(a,b). By the Cousin covering lemma there is a partition of the whole interval [c,d],
{([ai,bi],ξi) : i = 1,2,...,n}, for which
ξi ∈[ai,bi] and bi −ai < δ(ξi).
Consequently
|F(d)−F(c)| = |
n
∑
i=1
F(bi)−F(ai)| ≤
n
∑
i=1
|F(bi)−F(ai)| < ε.
This is true for any such interval and all positive ε. This is only possible if F is constant on (a,b).
Exercise 491, page 164
We have already checked that the Cantor function has zero on the set complementary to the Cantor set in [0,1]. This is
because the Cantor function is constant on all of the component intervals. If the Cantor function also had zero variation
on the Cantor set then we could conclude that it has zero variation on the entire interval [0,1]. It would have to be
constant.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

632
CHAPTER 11. APPENDIX
Exercise 493, page 164
Just mimic (and simplify) the proof for Exercise 488.
Exercise 513, page 170
Note that you are required to prove that, if the conditions here hold, then indeed f would have to be integrable and
Z b
a f(x)dx = F(b)−F(a).
Then you must supply a counterexample showing that not all integrable functions would necessarily have this property.
Just review the section material on absolute continuity in Vitali’s sense.
Exercise 514, page 170
If F is differentiable at all points of [a,b] this is certainly a true statement. If we allow exceptional points then the
hypotheses have to be adjusted.
Assume F is uniformly continuous on [a,b] and differentiable at all but a countable set of points. Then this statement
is true.
Assume F is Lipschitz on [a,b] and differentiable at all but a set of points of measure zero. Then this statement is
true. Remarkably enough this is true without assuming any differentiability. Lipschitz functions are always differentiable
at all but a set of points of measure zero. But that observation belongs in Part Two of our text.
There are more conditions that you can assume to guarantee that
Z b
a F′(x)dx = F(b)−F(a).
Exercise 518, page 173
Exercises 486, 487, and 488 contain all the pieces required for a very easy proof. Make sure to write
Z bi
ai
f(x)dx = F(bi)−F(ai)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
633
using the indeﬁnite integral F and to observe that only the ﬁrst inequality of the theorem need be proved, since the
second one follows immediately from the ﬁrst.
Exercise 522, page 175
The proof is an exercise in derivatives taking care to handle the sets of measure zero. Use F and G for the indeﬁnite
integrals of f and g. Let N0 be the set of points x in (a,b) where f(x) ≤g(x) might fail. Suppose that F′(x) = f(x)
except on a set N1 with N1 measure zero and such that F has zero variation on N1. Suppose that G′(x) = g(x) except on
a set N2 with N2 measure zero and such that F has zero variation on N2.
Then H = G −F has H′(x) = g(x) −f(x) ≥except on the set N0 ∪N1 ∪N2. This set is measure zero and, since F
and G are absolutely continuous inside the interval, so too is H.
The proof then rests on the following fact which you should prove:
If H is uniformly continuous on [a,b], absolutely continuous inside the interval, and if
d
dxH(x) ≥0
for all points x in (a,b) except possibly points of a set of measure zero then H(x) must be nondecreasing on
[a,b].
Finally then H(a) ≤H(b) shows that F(a)−F(b) ≤G(b)−G(a) and hence that
Z b
a f(x)dx ≤
Z b
a g(x)dx.
Exercise 523, page 175
Study the proof for Exercise 522 and just use those techniques here.
Exercise 524, page 176
In preparation . . .
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

634
CHAPTER 11. APPENDIX
Exercise 525, page 176
Here is a version that is not particularly ambitious and is easy to prove. It is also sufﬁciently useful for most calculus
classes. Suppose that F and G are uniformly continuous on [a,b] and that each function is differentiable except at a
countable number of points. Then the function F(x)G′(x)+F′(x)G(x) is integrable on [a,b] and
Z b
a
¡
F(x)G′(x)+F′(x)G(x)
¢
dx = F(b)G(b)−F(a)G(b).
In particular F(x)G′(x) is integrable on [a,b] if and only if F′(x)G(x) is integrable on [a,b]. In the event that either is
integrable then the formula
Z b
a F(x)G′(x)dx = F(b)G(b)−F(a)G(b)−
Z b
a F′(x)G(x)dx
must hold.
To prove it, just check that H(x) = F(x)G(x) is uniformly continuous on [a,b] and has a derivative at all but a
countable number of points equal to the function F(x)G′(x)+F′(x)G(x). But you can do better.
Exercise 526, page 177
Here are a number of versions that you might prove. Suppose G is uniformly continuous on [a,b], and that F is uni-
formly continuous on an interval [c,d] that includes every value of G(x) for a ≤x ≤b. Suppose that each function is
differentiable except at a countable number of points. Suppose that, for each a ≤x ≤b the set
G−1(G(x)) = {t ∈[a,b] : G(t) = G(x)}
is at most countable. Then the function F′(G(x))G′(x) is integrable on [a,b] and
Z b
a
¡
F′(G(x))G′(x)
¢
dx = F(G(b))−F(G(a)).
To prove it, just check that H(x) = F((G(x)) is uniformly continuous on [a,b] and has a derivative at all but a
countable number of points equal to the function F′(G(x))G′(x). Again you can do better. Try working with F and G as
Lipschitz functions. Or take F everywhere differentiable and G as Lipschitz.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
635
Exercise 527, page 177
There were an inﬁnite number of points in the interval [0,1] at which we could not claim that
d
dxF(G(x)) = F′(G(x))G′(x).
But that set is countable and countable sets are no trouble to us now. So this function is integrable and the formula is
valid.
Exercise 528, page 178
The proofs in Section 3.7.1 can be repeated with hardly any alterations. This is because both the calculus integral and
the integral of this chapter can be given a pointwise approximation by Riemann sums. Just read through the proof and
observe that the same arguments apply in this setting.
Exercise 530, page 179
The proofs in Section 3.7.1 can be repeated with hardly any alterations. This is because both the calculus integral and
the integral of this chapter can be given a pointwise approximation by Riemann sums.
Exercise 531, page 179
Any constant function F(x) = C will be, by deﬁnition, an indeﬁnite integral for f.
Exercise 532, page 179
Any function F(x) that is an indeﬁnite integral for f will satisfy F(d) −F(c) = 0 for all a ≤c < d ≤b. Thus F is
constant and 0 = F′(x) = f(x) for all x in the interval except possibly at points of a measure zero set.
Exercise 533, page 180
Any function F(x) that is an indeﬁnite integral for f will be monotonic, nondecreasing and satisfy F(b) −F(a) = 0.
Thus F is constant and 0 = F′(x) = f(x) for all x in the interval except possibly at points of a measure zero set.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

636
CHAPTER 11. APPENDIX
Exercise 535, page 191
Take any particular point x in E and check that β(G) is full at that point x. Remember that, since G is open, there is a
positive number δ1 so that (x−δ1,x+δ1) ⊂G. There is also a positive number δ2 so that all pairs ([u,v],x) with x ∈[u,v]
and 0 < v−u < δ2 must belong to β.
Exercise 536, page 191
This is nearly identical to the preceding exercise, Exercise 535.
Exercise 549, page 193
This is a dual of the next exercise, Exercise 550.
Exercise 550, page 193
This is a dual of the preceding exercise, Exercise 549.
Exercise 553, page 193
For each x in E there would have to be at least one interval (x,x+c) or (x−c,x) that does not contain any points of the
sequence.
Exercise 554, page 193
There would have to be at least one point x0 in E at which β is not ﬁne. That would mean that all intervals (x,x+c) and
(x−c,x) contain inﬁnitely many points of the sequence.
Exercise 555, page 193
For each x in E there would have to be at least one interval (x−c,x+c) that does not contain any points of the sequence
other than possibly x itself.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
637
Exercise 556, page 194
There would have to be at least one point x0 in E at which β is not full. That would mean that all intervals (x0,x0 +c) or
else all intervals (x0 −c,x0) contain inﬁnitely many points of the sequence.
Exercise 557, page 194
For each x in E every interval (x,x+c) or else every interval (x−c,x) contains inﬁnitely many points of the sequence.
Exercise 558, page 194
There would have to be at least one point x0 in E at which β is not ﬁne. Thus some interval (x0,x0 + c) or else some
interval (x0 −c,x0) contains no points of the sequence.
Exercise 559, page 194
For each x in E every interval (x,x+c) and also every interval (x−c,x) contains inﬁnitely many points of the sequence.
Exercise 560, page 194
There would have to be at least one point x0 in E at which β is not full. Thus some interval (x0,x0 + c) or else some
interval (x0 −c,x0) contains no points of the sequence.
Exercise 567, page 199
The former represents a sum taken over all elements in the partition π while the latter sum contains only those elements
(if any) ([u,v],w) ∈π for which [u,v] is a subinterval of [c,d]. It is the usual convention to consider that an empty sum
has value zero.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

638
CHAPTER 11. APPENDIX
Exercise 568, page 199
The former represents a sum taken over all elements in the partition π while the latter sum contains only those elements
(if any) ([u,v],w) ∈π for which w belongs to the set E. It is the usual convention to consider that an empty sum has
value zero.
Exercise 573, page 202
It satisﬁes the deﬁnition easily, with G = /0 in fact.
Exercise 574, page 202
If
E = {x1,x2,...xN}
and ε > 0, then the sequence of intervals³
xi −ε
2N ,xi + ε
2N
´
i = 1,2,3,...,N
covers the set E and the sum of all the lengths is ε. The union of these intervals is an open set G that contains E; by the
subadditivity property the Lebesgue measure λ(G) is smaller than ε.
Exercise 575, page 202
If
E = {x1,x2,...}
and ε > 0, then the sequence of intervals ³
xi −
ε
2i+1 ,xi +
ε
2i+1
´
i = 1,2,3,...
covers the set E. Let G be the union of these intervals. Since
∞
∑
k=1
2
³ ε
2k+1
´
= ∑
k=1
ε2−k = ε,
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
639
we conclude (from Lemma 5.8) that λ(G) < ε.
Exercise 576, page 202
Let ε > 0. Choose n so that (2/3)n < ε. Then the nth stage intervals in the construction of the Cantor set give us 2n
closed intervals each of length (1/3)n. This covers the Cantor set with 2n closed intervals of total length (2/3)n, which
is less than ε. If the closed intervals trouble you (the deﬁnition requires open intervals), see Exercise 579 or argue as
follows. Since (2/3)n < ε there is a positive number δ so that
(2/3)n +δ < ε.
Enlarge each of the closed intervals to form a slightly larger open interval, but change the length of each only enough
so that the sum of the lengths of all the 2n closed intervals does not increase by more than δ. The resulting collection of
open intervals also covers the Cantor set, and the sum of the length of these intervals is less than ε. Thus the Cantor set
has measure zero.
Exercise 578, page 203
Since E has measure zero, there is an open set G containing E for which λ(G) < ε. Let {(ak,bk)} denote the component
intervals of G. By the Heine-Borel theorem there is a ﬁnite N so that
{(ak,bk) : k = 1,2,...,N}
covers the set E. Since
N
∑
k=1
(bk −ak) ≤λ(G) < ε.
the proof is complete.
Exercise 621, page 216
Don’t forget to include the statement that F must be deﬁned on an open interval that contains the point x0. You
should verify that it means precisely that F is deﬁned on an open set containing the point x0 and is continuous at
that point.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

640
CHAPTER 11. APPENDIX
Exercise 636, page 222
Use Lemma 5.27.
Exercise 637, page 222
Let C the collection of points in (a,b) at which there is no derivative. This is countable and, since F is continuous, F
has zero variation on C. Now take any measure zero set N ⊂(a,b). We know that F has zero variation on C ∩N and, by
Lemma 5.27, we know that F has zero variation on N \C. It follows that F has zero variation on N.
Exercise 641, page 229
Our main tool, apart from ordinary computations, is the fact that monotonic functions are differentiable almost every-
where. This is proved in Theorem 5.28.
Let us simplify the proof by deciding that Fn(a) = 0 for all n, so that F and all functions Fn are nonnegative. We
know from the Lebesgue differentiation theorem applied to all of these monotonic functions that, except for x in a set of
measure zero, all of the derivatives, F′(x) and F′
n(x) exist. Thus it is only the identity for these values of x that we need
to establish.
Note that
F(x) ≥
m
∑
n=1
Fn(x)
for every integer m so that for almost every x,
F′(x) ≥
m
∑
n=1
F′
n(x)
and, consequently,
F′(x) ≥
∞
∑
n=1
F′
n(x).
(11.19)
To simplify we can assume that
F(b)−
m
∑
n=1
Fn(b) ≤2−m.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
641
If this were not the case then we could put parentheses in the series, group terms together, and relabel so that this would
be the case. Consider the series
G(x) =
∞
∑
n=1
Ã
F(x)−
n
∑
k=1
Fk(x)
!
.
Note that
0 ≤G(x)−
m
∑
n=1
Ã
F(x)−
n
∑
k=1
Fk(x)
!
≤
∞
∑
n=m+1
2−n = 2−m.
Thus we see that G is also the sum of a series of functions.
A repeat of the argument we just gave to establish (11.19) will provide the analogous statement for this series:
0 ≤
∞
∑
n=1
Ã
F′(x)−
n
∑
k=1
F′
k(x)
!
≤G′(x)
(11.20)
The function G has a ﬁnite derivative at almost every point. So in order for the inequality in (11.20) to hold for this series
at a particular value of x the terms must tend to zero. Writing that out we now know that, for almost every x,
lim
n→∞
Ã
F′(x)−
n
∑
k=1
F′
k(x)
!
= 0.
This is exactly the conclusion of the theorem.
Exercise 644, page 239
Make use in your proof of the fact that the intersection of two full covers, is again a full cover.
Exercise 647, page 239
Inﬁnite values are allowed but we would have to avoid ∞+ (−∞) or −∞+ ∞. This is simpler if you ﬁrst check that a
single value f(b) is irrelevant to the computations so that you may assume that f(b) = 0. Then ensure that any partition
π contained in your choice of β of the interval [a,b], [a,c] or [b,c] would have to contain an element (I,b).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

642
CHAPTER 11. APPENDIX
Exercise 649, page 240
Check, ﬁrst, that full covers do in fact contain endpointed partitions (as well as ordinary partitions). Then note that, if a
partition π contains a pair ([u,v],w) for which u < w < v that element can be replaced by the two items ([u,w],w) and
([w,v],w). That does not change the Riemann sums here because, for example,
f(w)[v−u] = f(w)[w−u]+ f(w)[v−w].
Finally check that if β is a full cover there must be a smaller full cover β′ ⊂β so that ([u,v],w) ∈β′ with u < w < v if
and only if both ([u,w],w) and ([w,v],w) are in β′.
Exercise 650, page 241
Use β to ﬁnd estimates for the upper and lower integrals,
Z b
a f(x)dx−
Z b
a f(x)dx < 2ε.
(Later we will show that this condition is, in fact, both necessary and sufﬁcient.
Exercise 657, page 244
Just check that the expression in Theorem 6.9
¯¯¯¯¯ ∑
(I,w)∈π
∑
(I′,w′)∈π′
[ f(w)−f(w′)]λ(I ∩I′)
¯¯¯¯¯ < ε
(11.21)
is smaller than the expression
∑
(I,w)∈π
∑
(I′,w′)∈π′
¯¯ f(w)−f(w′)
¯¯λ(I ∩I′) < ε.
That would prove, using Theorem 6.9 that the integrability of f follows from the McShane criterion.
But it is also true that this expression
¯¯¯¯¯ ∑
(I,w)∈π
∑
(I′,w′)∈π′
[| f(w)|−|f(w′)|]λ(I ∩I′)
¯¯¯¯¯ < ε
(11.22)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
643
is smaller than the expression
∑
(I,w)∈π
∑
(I′,w′)∈π′
¯¯ f(w)−f(w′)
¯¯λ(I ∩I′) < ε.
That would prove, again using Theorem 6.9 that the integrability of | f| follows from the same McShane criterion.
Exercise 661, page 266
Check ﬁrst that you need only prove the case where E ⊂(a,b). Then it is just a matter of looking carefully at the
deﬁnitions of the two concepts.
Exercise 662, page 266
Use the subadditive property of open sets expressed in Lemma 5.8.
Exercise 668, page 282
Let A be the set of all points where f has a ﬁnite derivative. We know that each set of the form
{x : D f(x) > c}
and
{x : Df(x) < c}
is measurable. Thus the set A′ of points at which f does not have a derivative (ﬁnite or inﬁnite) can be expressed as the
union of the family of sets
Apq = {x : D f(x) < p < q < D f(x)}
for rational numbers p and q. It follows that A′ is also measurable. Again the set A′′ of points where f ′(x) = ±∞can be
written as
A′′ =
∞
\
n=1
{x : D f(x) < −n}∪
∞
\
n=1
{x : D f(x) > n}.
Thus this set is measurable. But A = A′ \A′′.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

644
CHAPTER 11. APPENDIX
Exercise 675, page 291
Apply Fatou’s lemma to the non-negative sequence given by g fn.
Exercise 676, page 291
If f denotes the pointwise limit of the sequence, then f is also measurable and dominated by g, hence integrable.
Furthermore,
| f(x)−fn(x)| ≤2g(x)
for all n and
limsup
n→∞
| f(x)−fn(x)| = 0.
By the reverse Fatou lemma,
limsup
n→∞
Z b
a | f(x)−fn(x)|dx ≤
Z b
a limsup
n→∞
| f(x)−fn(x)|dx = 0.
Using linearity and monotonicity of the integral,
¯¯¯¯
Z b
a f(x)dµ−
Z b
a fn(x)dx
¯¯¯¯ =
¯¯¯¯
Z b
a f(x)−fn(x))dx
¯¯¯¯ ≤
Z b
a | f(x)−fn(x)|dx,
and the statement is proved.
Exercise 678, page 297
Let ε > 0 and suppose that F′(x) = f(x) at every point. Deﬁne
β = {(I,x) : |∆F(I)−f(x)λ(I)| < ελ(I)}.
Check that β is a full cover of R and that it satisﬁes (7.16).
Conversely suppose that β has been chosen to be a full cover of R that satisﬁes (7.16). Fix x ∈R and determine
δ > 0 so that whenever (I,x) satisﬁes x ∈I and λ(I) < δ then necessarily (I,x) ∈β. Note that if ([c,d],x) is any pair for
which c ≤x ≤d and d −c < δ then necessarily ([c,d],x) is in β and the set π containing only this one pair is itself also
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
645
a partition of [c,d]. Consequently, using (7.16),
|F(d)−F(c)−f(x)(d −c)| < ε(d −c).
But this veriﬁes that F′(x) = f(x).
Exercise 679, page 298
Suppose that F′(x) = f(x) everywhere. Apply Lemma 678 to ﬁnd a full cover β for which for every compact interval
[a,b] and every partition π ⊂β of [a,b],
∑
(I,x)∈π
|∆F(I)−f(x)λ(I)| < ελ([a,b])/2.
(11.23)
Let π1, π2 ⊂β be partitions of [a,b]. Apply (11.23) to each of them and add to obtain that
¯¯¯¯¯ ∑
(I,z)∈π
f(z)λ(I)−∑
(I′,z′)∈π′
f(z′)λ(I′)
¯¯¯¯¯ < ελ([a,b]).
(11.24)
Now simply rearrange (11.24) to obtain (7.17). Conversely suppose that the statement (7.17) in the theorem holds for ε
and β. This is a stronger statement than the Cauchy second criterion and so f is integrable on every compact interval.
Thus there is a function F that will serve as the indeﬁnite integral for f on any interval. From (7.17) we deduce that
¯¯¯¯¯∆F([a,b])−∑
(I,z)∈π
f(z)λ(I)
¯¯¯¯¯ < 2ελ([a,b])
(11.25)
must be true for any partition π of [a,b] from the cover β.
Fix x ∈R and determine δ > 0 so that whenever (I,x) satisﬁes x ∈I and λ(I) < δ then necessarily (I,x) ∈β. Note
that if ([c,d],x) is any pair for which c ≤x ≤d and d −c < δ then necessarily ([c,d],x) is in β and the set π containing
only this one pair is itself also a partition of [c,d]. Consequently, using (11.25),
|F(d)−F(c)−f(x)(d −c)| < 2ε(d −c).
But this veriﬁes that F′(x) = f(x).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

646
CHAPTER 11. APPENDIX
Exercise 681, page 300
For any covering relation β it is clear that
V(rλ,β[E]) ≤V(fλ,β) ≤V(sλ,β)
and from this one can deduce that
rλ(E) = V ∗(rλ,E) ≤V ∗(fλ,E) ≤V ∗(sλ,E) = sλ(E).
Note that it would also be true that
rλ(E) = V∗(rλ,E) ≤V∗(fλ,E) ≤V ∗(sλ,E) = sλ(E).
Exercise 685, page 301
This exercise asserts that when λ(E) is zero so too is
R
E f(x)dx. This is considered an absolute continuity condition. In
Exercise 693 we consider a different version of absolute continuity asserting that if λ(E) is “small” so too is
R
E f(x)dx.
Let En = {x ∈E : 1/n < f(x)}. Check that
nλ(En) ≤
Z
En
f(x)dx ≤
Z
E f(x)dx = 0.
Thus λ(En) = 0 for each n and so also if E′ = {x ∈E : f(x) ̸= 0} then
λ(E′) ≤
∞
∑
n=1
λ(En) = 0.
Exercise 692, page 302
For illustrative purposes only we begin the proof with the bounded case. Suppose that f(x) < N for all x ∈E. Choose
δ = ε/N and observe that, if λ(G) < δ then the inequalities in the measure estimates of an earlier exercise in this section
provide
Z
E∩G f(x)dx ≤Nλ(G) < ε.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
647
Thus the proof in the bounded case is trivial and does not require that f be measurable.
Exercise 693, page 302
This exercise asserts that when λ(E) is small so too is
R
E f(x)dx. This is considered an absolute continuity condition.
In Exercise 686 we consider a different version of absolute continuity asserting that if λ(E) is zero so too is
R
E f(x)dx.
Note that there are ﬁniteness assumptions in this (stronger) version.
The argument in the preceding exercise suggests how to proceed. Let
An = {x : n−1 ≤f(x) < n}.
From the fact that f is measurable we can deduce that An is measurable. Thus we can select an open set Gn for which
Bn = An \Gn is closed and λ(Gn) < ε2−nn−1. That also requires
Z
E∩An
f(x)dx ≤
Z
E∩Bn
f(x)dx+
Z
E∩An∩Gn
f(x)dx
≤
Z
E∩Bn
f(x)dx+ε2−n.
Note that {Bn} is a disjointed sequence of closed sets whose union B can be handled by the usual additive properties
of measures over such sets. Thus
∞
∑
n=1
Z
E∩An
f(x)dx ≤
∞
∑
n=1
Z
E∩Bn
f(x)dx+ε
=
Z
E∩B f(x)dx+ε ≤
Z
E f(x)dx+ε < ∞.
In particular there must be an integer N sufﬁciently large that
∞
∑
n=N+1
Z
E∩An
f(x)dx < ε/2.
Choose δ = ε/(2N) and let G be any open set for which λ(G) < δ. Since
E ∩G = {x ∈E ∩G : f(x) < N}∪
∞
[
n=N+1
(G∩E ∩An)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

648
CHAPTER 11. APPENDIX
we have
Z
E∩G f(x)dx ≤Nλ(G)+
∞
∑
n=N+1
Z
E∩An
f(x)dx < ε.
Exercise 694, page 303
The proof repeats a number of techniques we have already seen in the proof of Theorem 693.
Each of the sets appearing in the statement of the theorem is measurable, because f is measurable. Select open sets
Gkr so that Brk = Akr \Gkr is closed and so that
λ(Gkr) < ε2−|k|−1r−k.
That also requires
Z
E∩Akr
f(x)dx ≤
Z
E∩Bkr
f(x)dx+
Z
E∩Akr∩Gkr
f(x)dx
≤
Z
E∩Bkr
f(x)dx+ε2−|k|−1.
Note that {Bkr} is a disjointed sequence of closed sets whose union Br can be handled by the usual additive properties
of measures over such sets.
Now we compute:
Z
E f(x)dx ≤
∞
∑
k=−∞
Z
E∩Akr
f(x)dx
≤
∞
∑
k=−∞
Z
E∩Bkr
f(x)dx+ε ≤
∞
∑
k=−∞
rkλ(E ∩Bkr)+ε
≤r
∞
∑
k=−∞
Z
E∩Bkr
f(x)dx+ε = r
Z
E∩Br
f(x)dx+ε ≤r
Z
E f(x)dx+ε.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
649
Exercise 695, page 303
The ﬁrst identity
Z
E f(x)dx = V ∗(fλ,E)
is just our deﬁnition. Thus the intent of the exercise is to prove just that
V ∗(fλ,E) = V∗(fλ,E).
Repeat Exercise 694 and this time deduce the related inequality
V∗(fλ,E) ≤
∞
∑
k=−∞
rkλ(E ∩Akr) ≤rV∗(fλ,E).
Essentially this is accomplished because the Lebesgue measure can be estimated by either full covers or by ﬁne covers
(this is the Vitali covering theorem).
A comparison of the two inequalities shows that V ∗(fλ,E) = V∗(fλ,E).
Exercise 704, page 308
Deﬁne F : R →R by F(0) = F(1/(2n−1)) = 0 and F(1/2n) = 1/n for all n = 1,2,3,.... Extend F to be linear on each
of the intervals contiguous to these points where it has so far been deﬁned. Show that F is absolutely continuous but that
Vitali’s condition does not hold on the interval [0,1].
Exercise 705, page 309
Let E be a null set. Write En = E ∩(−n,n) for any integer n. We show that F has zero variation on En.
Using the δ, ε of the Vitali deﬁnition on the interval [−n,n] cover En with a subsequence of open intervals {(ci,di)}
with total length less than δ. Let β be the collection of all pairs ([u,v],w) for which w ∈En and [u,v] is a subset of one
at least of the open intervals {(ci,di)}. This collection β is a full cover of En.
Let π be any subpartition contained in β. It must be the case, by the way that β has been constructed, that
∑
(([u,v],w)∈π
(v−u) < δ.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

650
CHAPTER 11. APPENDIX
Consequently
∑
(([u,v],w)∈π
|F(v)−F(u)| < ε.
From this it follows that F has zero variation on En. Since E is the union of the sequence of sets {En} it follows too that
F has zero variation on E.
Exercise 706, page 309
Establish that
|F(d)−F(c)| ≤M(d −c)
for some M and all [c,d] ⊂[a,b].
Exercise 708, page 309
Perhaps hard to spot. Note that the condition does not specify that the intervals should be nonoverlapping.
Exercise 712, page 311
Let M be an upper bound for the values of | f(x)| in the interval. Let N be the measure zero set that allows us to say that
f is continuous at every point in [a,b]\N. We will assume that f is constant on (−∞,a] and on [b,∞). This just allows
us to ignore what is happening outside of the interval [a,b].
Let ε > 0 and deﬁne
β1 = {([x,y],z) : ω f([x,y]) < ε/4(b−a).}
Check, using the continuity of f, that β is a full cover of R \ N. Verify that if (I,z) and (I′,z′) both belong to β then,
either I and I′ have no points in common or else | f(z)−f(z′)| < ε/(b−a).
Choose an open set G containing N with λ(G) < ε/(2M). Let β2 be the collection of all pairs ([u,v],w) for which
w ∈N, u ≤w ≤v, and [u,v] ⊂G. It is easy to check that β2 is a full cover of N. Thus β = β1 ∪β2 is a full cover of the
whole real line.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
651
Complete the proof by checking that
∑
(I,x)∈π ∑
(I′,x′)∈π′
¯¯ f(x)−f(x′)
¯¯λ(I ∩I′) < ε
for any pair of partitions π and π′ of [a,b]. This just requires handling the pairs of items (I,x) and (I′,x′) differently
depending on whether both came originally from β1 or one of the pair is in β2. The ﬁrst case we have already done in
the preceding theorem. The second case should present no difﬁculties if the reader will remember the minor point that
¯¯ f(x)−f(x′)
¯¯ ≤2M
in the sum.
Thus f satisﬁes McShane’s criterion on [a,b]. It follows that f is Lebesgue integrable there.
Exercise 713, page 311
Let
En = {x ∈[a,b] : ω f (x) ≥1/n}.
This is a closed set containing only points of discontinuity of f. Indeed S∞
n=1 En is exactly the set of all points of
discontinuity of f.
Fix n and ε > 0. Choose a partition π of [a,b] so that
∑
(I,x)∈π
ω f(I)λ(I) < ε.
Let π′ denote the subset of π containing just the elements ([x,y],z) ∈π for which (x,y) ∩En ̸= /0. Note that each pair
([x,y],z) that belongs to π′ will necessarily require
ω f([x,y]) ≥1/n.
Also the collection of such intervals [x,y] will cover all but ﬁnitely many points of En. Hence we compute that
λ(En) ≤∑
(I,x)∈π′
λ(I) ≤∑
(I,x)∈π′
nω f(I)λ(I) < nε.
This can happen for all ε only if λ(En) = 0 from which it follows that S∞
n=1 En (the set of points of discontinuity of f) is
also of λ-measure zero. This proves (2).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

652
CHAPTER 11. APPENDIX
Exercise 714, page 311
Finally let us assume (2) and show that this implies (1). Let η > 0 and choose M so that | f(x)| < M for all x in [a,b]. Let
Eη = {x ∈[a,b] : ω f (x) ≥η}.
This is a set of measure zero. There must be an open set G containing Eη so that λ(G) < η/(2M). For each point x in
[a,b] that is not in G note that ω f (x) < η. Construct the covering relation
β1 = {(I,x) : x ∈[a,b]\G, x ∈I, and ω f(I) < η}.
This is a full cover of [a,b]\G. Construct the covering relation
β2 = {(I,x) : x ∈G, x ∈I, and I ⊂G}.
Observe that β = β1 ∪β2 is a Cousin cover of [a,b].
Let π be any partition of [a,b] contained in β. Write π′ = π[G] and π′′ = π\π[G]. Then
∑
(I,x)∈π
ω f(I)λ(I) = ∑
(I,x)∈π′
ω f(I)λ(I)+ ∑
(I,x)∈π′′
ω f(I)λ(I)
≤2Mλ(G)+η(b−a) < η(1+b−a).
Since η is an arbitrary positive number we have deduced (1) from (2). In fact we have proved rather more, that the
integral
Z b
a ω f ·dx = 0
where that integral is interpreted as the usual limit of this kind of Riemann sums:
∑
(I,x)∈π
ω f(I)λ(I).
Exercise 715, page 311
We show ﬁrst that a function f on an interval [a,b] that is Riemann integrable [i.e., integrable but using uniformly full
covers must be bounded and a.e. continuous. [This is an historically interesting fact, showing exactly the limitations of
the Riemann integration theory. ]
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
653
Use the oscillation ω f (x) of a function f at a point x. (This value is positive if and only if f is discontinuous at x.)
Check ﬁrst the easy fact that f must be bounded. Fix e > 0 and consider the set N(e) of points x such that the oscillation
of f at x is greater than e; that is, so that
ω f (x) > e.
Any interval (c,d) that contains a point x ∈N(e) will certainly have
ω f([c,d]) ≥e.
Let ε > 0 and use Exercise 655 to ﬁnd
a = x0 < x1 < x2 < ··· < xn−1 < xn = b
such that
n
∑
k=1
ω f([xk−1,xk](xk −xk−1) < εe/2.
Select just those intervals that contain a point from N(e) in their interior. The total length of these intervals cannot exceed
(eε)/(2e) since ω f([xk−1,xk]) ≥e for each interval [xk−1,xk].
This covers the set N(e) by a sequence of intervals [xk−1,xk] of total length less than ε/2, except that possibly we
have missed a point xi that happens to be in N(e). In any case, argue that N(e) has measure zero. But the set of points of
discontinuity of f is the union of the sets N(1), N(1/2), N(1/4), N(1/8), . . . .
Exercise 721, page 316
Take as a full cover β the collection of pairs ([u,v],w) for which w ∈[u,v] but [u,v] never overlaps both of the intervals
[0,1/2] or [1/2,1] unless w = 1/2. Then all partitions π of [a,b] from β can be split neatly at the point 1/2.
Exercise 722, page 316
Take as a full cover β the collection of pairs ([u,v],w) for which w ∈[u,v] but [u,v] never overlaps two of the intervals
[ξi−1,ξi] unless w is one of the points {ξi}. Then all partitions π of [a,b] from β can be split neatly at the points ξi.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

654
CHAPTER 11. APPENDIX
Exercise 723, page 316
Both integrals exist but have different values, which you can check. If you were schooled in the Riemann-Stieltjes
integral then you might recall this example was used to illustrate non-existence of the Riemann-Stieltjes integral. These
differences in the two theories are mostly irrelevant since most applications will assume that one function is continuous
and the other has bounded variation.
Exercise 724, page 317
Warning: If you were schooled in the Riemann-Stieltjes integral before learning this Stieltjes integral you may think not.
Otherwise just check that the existence of the integral (ﬁnitely that is) on [a,b] and [b,c] is equivalent to the existence of
the integral on [a,c].
Exercise 731, page 317
Hint: |dG(x)| is subadditive whereas dG(x) is additive.
Exercise 749, page 340
We can simplify the argument and assume that F is deﬁned on the whole real line. We wish to show that
1. λF(/0) = 0.
2. For any sequence of sets E, E1, E2, E3, . . . for which E ⊂S∞
n=1 En the inequality
λF(E) ≤
∞
∑
n=1
λF(En)
must hold.
This result is often described by the following language that splits the property (2) in two parts:
Subadditivity: λF
Ã ∞
[
n=1
En
!
≤
∞
∑
n=1
λF(En).
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
655
Monotonicity: λF(A) ≤λF(B) if A ⊂B.
The monotonicity is obvious. This allows us to prove the additivity assertion above just in the special case that the
sets {En} are pairwise disjoint so that E = S∞
n=1 En is now a disjoint union. If λF(En) = ∞for any integer n there is
nothing to prove so we may suppose all of these are ﬁnite.
Let ε > 0. For each integer n choose a full cover βn of En so that
sup
π⊂βn
∑
([u,v],w)∈π
|F(v)−F(u)| < λF(En)+ε2−n.
Then write
β =
∞
[
n=1
βn[En].
This is a full cover of E and consequently
λF(E) ≤sup
π⊂β
∑
([u,v],w)∈π
|F(v)−F(u)|.
Take any subpartition π ⊂β and observe that
∑
([u,v],w)∈π
|F(v)−F(u)| ≤
∞
∑
n=1
∑
([u,v],w)∈π[En]
|F(v)−F(u)| ≤
∞
∑
n=1
£
λF(En)+ε2−n¤
.
From this it follows that
λF(E) ≤ε+
∞
∑
n=1
[λF(En)]
and the subadditive property follows.
Exercise 753, page 340
One direction is easy. If β is full cover of (a,b)) and we prune out intervals not inside (a,b) by writing β′ = β((a,b)),
then it is clear that
λF((a,b)) ≤sup
π⊂β′
∑
([u,v],w)∈π
|F(v)−F(u)| ≤V(F,[a,b]).
In the other direction ETC
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

656
CHAPTER 11. APPENDIX
Exercise 754, page 340
Suppose that E ⊂(−L,L) and that |F′(x)| < M for all x ∈E. Then
β =
½
([u,v],w) : (u,v) ⊂(−L,L), |F(v)−F(u)|
v−u
< M
¾
is a full cover of E Thus, for any subpartition π ⊂β,
∑
([u,v],w)∈π
|F(v)−F(u)| ≤2ML.
It follows that λF(E) ≤2ML and so is ﬁnite.
Exercise 756, page 347
Develop the Henstock zero variation criterion for this integral and check that the usual zero derivative procedure will
supply this fact.
Exercise 760, page 357
Note that there is no typo in the ﬁrst inequality: the full variation is needed on the right-hand side. The second inequality,
the easier to check, follows from the fact that the intersection of two full covers is again full. The ﬁrst inequality follows
from the fact that the intersection of two covering relations, one of which is full and the other ﬁne, is again ﬁne.
Exercise 765, page 357
If f ′(x) = 0 for all x ∈E \N show that λ f (E \N) = 0.
Exercise 767, page 357
It is enough to suppose that λf (E) < ∞. Let C = {x ∈E : λ f ({x}) > 0}; this set must include every point at which f
fails to be continuous. Now let Cn = {x ∈E : λ f ({x}) > 1/n}. From measure-properties
λf (Cn) ≤λ f (E) < ∞.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
657
But if Cm contains k points then
λf (Cn) ≥k/n.
It follows that each set Cn is ﬁnite and hence the set C must be countable.
Exercise 768, page 358
Some authors would use the term weakly continuous at a point x0 to mean that there is at least one sequence cn →x0 and
so that |cn −x0| > 0 and
f(cn)−f(x0) →0.
This condition is a little stronger than the deﬁnition in the text. For example the function f(x) = 0 if x ̸= 0 and f(0) = 1
is weakly continuous at 0 in our sense but not in the stronger sense. The property in the exercise is dictated by the
particular deﬁnition that we use for ﬁne covers.
Here is a proof. Since f is weakly continuous at x0 we know, by deﬁnition, that λ⋆
f ({x0}) = 0. For each integer n we
can select a ﬁne cover βn of the set {x0} so that V(∆f,βn) < 1/n. From βn we can select a pair ([cn,dn],x0) for which
dn −cn < 1/n. Note that cn ≤x0 ≤dn and
| f(dn)−f(cn)| ≤V(∆f,βn) < 1/n.
This pair of sequences {cn} and {dn} has all the properties that we need except they need not be monotonic. But there
is a monotonic subsequence of the {cn} so that we can consider that we have selected that subsequence. Take a further
subsequence so that both sequences are monotonic. The new sequences have all the properties that we need.
Exercise 769, page 358
Let
E = {x : liminf
(I,x) =⇒x|∆f(I)| > 0}
and
E = {x : liminf
(I,x) =⇒x|∆f(I)| > 1/n}.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

658
CHAPTER 11. APPENDIX
The set of points where f is not weakly continuous is exactly the set E = S
n En. Note that β = {(I,x) : |∆f(I)| > 1/n}
is a full cover of En and apply the decomposition lemma from Section 5.1.8.
Exercise 771, page 358
Recall that F has ﬁnite variation on (a,b) if there is a number M and a full cover β of (a,b) so that
∑
([u,v],w)∈π
|F(v)−F(u)| ≤M
whenever π is a subpartition, π ⊂β. If F has bounded variation on [a,b] then certainly M = V(F,[a,b]) will work.
In the converse direction we suppose that M and β have been chosen with this property. For every subinterval
[c,d] ⊂[a,b] there is a partition π contained in β for which evidently
|F(d)−F(c)| =
¯¯¯¯¯
∑
([u,v],w)∈π
[F(v)−F(u)]
¯¯¯¯¯ ≤
∑
([u,v],w)∈π
|F(v)−F(u)| ≤M.
Fix some point x0 in (a,b) and then we have the bound |F(x)| ≤M +|F(x0)| for every point x in (a,b).
Now we estimate V(F,[a,b]). Take any choice of points
a = s0 < s1 < ··· < sn−1 < sn = b.
We note that
|F(s1)−F(s0)| ≤|F(a)|+M +|F(x0)|
and that
|F(sn)−F(sn−1)| ≤|F(b)|+M +|F(x0)|.
We may choose a partition π from β so that π contains a partition of each of the remaining intervals [s1,s2], [s2,s3], . . . ,
[sn−2,sn−1]. This provides the inequality
n
∑
i=1
|F(si)−F(si−1)| ≤|F(a)|+M +|F(x0)|+|F(b)|+M +|F(x0)|+M =
|F(a)|+|F(b)|+3M +2|F(x0)|.
This offers us an upper bound for V(F,[a,b]) and we have proved that F has bounded variation on [a,b].
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
659
Exercise 773, page 358
If f is locally recurrent at every point of a set E then
β = {(I,x) : ∆f(I) = 0}
is a ﬁne cover of E. Thus
λ⋆
f (E) ≤V(∆f,β) = 0.
Exercise 774, page 358
Deﬁne
β = {(I,x) : ∆f(I) ≥0}
and notice that this is a full cover of E. Apply the decomposition from Section 5.1.8 for β. There is an increasing
sequence of sets {En} with E = S∞
n=1 En and a sequence of compact intervals {Ikn} covering E so that if x is any point
in En and I is any subinterval of Ikn that contains x then (I,x) belongs to β.
We check that f is nondecreasing on each set Dnk = En ∩Ikn in a certain strong way. For if either x or y belongs to
the set Dnk and [x,y] ⊂Ikn then one of the pairs ([x,y],x) or ([x,y],y) belongs to β which requires that f(x) ≤f(y).
Let c = infDnk and d = supDnk. Suppose that c = d. Then Dnk contains a single point c and λf ({c}) < ∞, i.e.,
λf (Dnk) < ∞. Suppose instead that c < d. Let D′
nk = Dnk ∩(c,d) so that Dnk contains, at most, two points c and d more
than the set D′
nk. Let β′ = β[Dnk] ∩β((c,d)). Then β′ is a full cover of D′
nk. Let π = {{[ci,di],xi)} be any subpartition
contained in β′. We see from the manner in which f increases relative to the set Dnk that
∑
i
| f(di)−f(ci)| ≤2[ f(d)−f(c)].
It follows that
λf (D′
nk) ≤V(∆f,β′) ≤2[ f(d)−f(c)] < ∞.
Consequently,
λf (Dnk) ≤λ f (D′
nk)+λf ({c})+λf ({d}) < ∞
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

660
CHAPTER 11. APPENDIX
too, so that in either case λf (Dnk) is ﬁnite. It follows that λ f is σ-ﬁnite on the set E since that set has been expressed as
a union of a sequence of sets on each of which λf is σ-ﬁnite.
Exercise 775, page 359
Deﬁne three sets E1, E2, and E3. E1 is the set of points at which f is locally nondecreasing. E2 is the set of points at
which −f is locally nondecreasing. E3 is the set of points at which f is locally recurrent. Since f is continuous it has
the Darboux property. From that we see that E1 ∪E2 ∪E3 = R since there are no other possibilities.
But λ⋆
f (E3) = 0 and λf is σ-ﬁnite on E1 and E2 (Exercise 774). It follows that the smaller measure λ⋆
f must be
σ-ﬁnite.
Exercise 776, page 359
Since the hint suggests that we can use Theorem 9.20 let us do so. There must be a sequence of compact sets {En}
covering E and a sequence of continuous functions of bounded variation {gn} so that f is Kolmogorov equivalent to
gn on En. In particular, we know that g′
n(x) exists at almost every point. Therefore the set of points in En at which
f ′(x) = g′
n(x) fails is a set of measure zero, say Nn. It follows that f is differentiable at every point of E with the possible
exception of points in the measure zero set S∞
n=1 Nn.
Exercise 778, page 365
Let
E = {x : D−f(x) < D+ f(x)}
and, for each rational number r, let
Er = {x : D−f(x) < r < D+ f(x)}.
Note that E is the union of the countable collection of sets Er taken over all rationals r. For each x in Er there is a
δ(x) > 0 so that, for all 0 < h < δ(x),
∆f([x−h,x]) < rλ([x−h,x])
and
∆f([x,x+h) > rλ([x,x+h])}
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
661
because of the values of the Dini derivatives.
Let
Ern = {x ∈E : δ(x) > 1/n}
and check that
Er =
∞
[
n=1
Ern.
We claim that, for each n, the set Ern is countable. Indeed there cannot be two points x and y with x < y in Ern closer
together than 1/n. For if so, let h = y−x, note that 0 < h < δ(x) < 1/n and 0 < h < δ(y) < 1/n. That would mean that
∆f([x,y]) < rλ([x,y]) < ∆f([x,y)
which is impossible. Accordingly each Ern is countable and so too also is E. The other set of the theorem can be handled
by an identical proof.
Exercise 781, page 365
Consider ﬁrst the set
A = {x : D−f(x) < D+ f(x)}
and, for each rational number r, let
Ar = {x : D−f(x) < r < D+ f(x)}.
Note that A is the union of the countable collection of sets Ar taken over all rational numbers r.
For each x in Ar we have D−f(x) < r. Thus there is a δ(x) > 0 so that, for all 0 < h < δ(x),
f(x)−f(x−h) < rh.
For each n = 1,2,3,... and each k = 0,±1,±2,... write
Arnk =
·k −1
n
, k
n
¸
∩
½
x ∈Ar : δ(x) > 1
n
¾
.
Notice that
f(x)−f(y) < r(x−y)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

662
CHAPTER 11. APPENDIX
for all x < y with x, y ∈Arnk and check that
Ar =
∞
[
k=−∞
∞
[
n=1
Arnk.
Finally let Ernk denote the closure of the set Arnk. Each set Ernk is compact and we claim that it contains no subinter-
val; in particular then it is a meager subset of R.
Should such a set Ernk contain an interval [a,b] then, by the continuity of f we must conclude that the inequality
stated above would require, for all a < y < x < b, that
f(x)−f(y) ≤r(x−y).
Consequently there would be no points y in (a,b) at which r < D+ f(y). But this is impossible since the set Arnk is dense
in the set Ernk.
Thus we have displayed
Ar ⊂
∞
[
k=−∞
∞
[
n=1
Ernk
as a subset of a union of a sequence of meager subsets of R.
It follows that the set A deﬁned above is also a meager subset of R. In a similar way we can conclude that each of
the sets
{x : D−f(x) > D+ f(x)}
{x : D−f(x) > D+ f(x)}
and
{x : D−f(x) < D+ f(x)}
is a meager subset of R. From this the theorem follows.
Exercise 783, page 366
Suppose that f is not nondecreasing on [a,b]. Then we can choose points a ≤a′ < b′ ≤b with f(b′) < f(a′). Thus
[ f(b′), f(a′)] is a nonempty compact subinterval of [c,d]. Take any y between f(b′) and f(a′). Let
M(y) = sup{x ∈(a′,b′) : f(x) = y}.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
663
Check that f(x) = y and that D+ f(x) ≤0 whenever x = M(y). Thus, y ∈f(D). Consequently f(D) contains (f(b′), f(a′))
and so, also, all compact subintervals contained in this open interval.
Exercise 784, page 366
We break the proof into a number of steps that follow Morse’s original exposition.
Step 1. Suppose that f is strictly decreasing on a compact set E ⊂[a,b]. If E contains no subinterval, then we claim that
f(E) is a compact subset of [c,d] that also contains no interval.
We can deﬁne a strictly decreasing, continuous function g : R →R so that f(x) = g(x) for all x in E by making g
continuous and linear on all the open intervals complementary to E. We know that f(E) = g(E) would be compact.
Suppose, contrary to what we want, that g(E) contains a subinterval J of [c,d]. We consider the inverse function g−1
which maps that subinterval J back into E. Such a function would be continuous and therefore maps J to some interval.
That would require E to contain an interval.
Step 2. Deﬁne, for each integer n = 1,2,3,...,
En = {x ∈[a,b] : f(x+h)−f(x) ≤−h/n whenever 0 ≤h ≤1/n}
Then we will prove that En is a compact subset of [a,b] that contains no interval and that f(En) is a compact subset of
[c,d] that contains no interval.
It is easy to check, using the continuity of f, that En is closed. Thus both En and f(En) must be compact. We
subdivide [a,b] into a ﬁnite collection {Jk} of compact, nonoverlapping subintervals of [a,b], covering all of that interval
and each of length less than 1/n. It is easy to see that f is strictly decreasing on each set Jk ∩En. By our hypotheses
the set A is dense in [a,b] so that no one of these sets Jk ∩En can contain an interval. In particular En itself can contain
no interval. Moreover, by step 1, we conclude that f(Jk ∩En) is a compact set that contains no subintervals of [c,d]. It
follows that f(En) is contained in the ﬁnite union of such sets and so must itself contain no subintervals of [c,d].
Step 3. The set B is a meager subset of [a,b] and the set f(B) is a meager subset of [c,d]. This follows from step 2 since
B is the union of the sequence of sets {En} each of which is a meager subset of [a,b], while f(B) is the union of the
sequence of sets { f(En)}, each of which is a meager subset of [c,d].
Step 4. Suppose now that f is not nondecreasing on [a,b]. Then we can choose points a ≤a′ < b′ ≤b with f(b′) < f(a′).
Thus [ f(b′), f(a′)] is a nonempty compact subinterval of [c,d]. We know from the proof of the preliminary lemma that
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

664
CHAPTER 11. APPENDIX
f maps the set
D = {x ∈[a,b] : D+ f(x) ≤0}
onto a set containing the open interval (f(b′), f(a′)). But we already have established that the set f(B) is a meager
subset of [c,d]. Using the fact that B∪C = D, we conclude that f(B)∪f(C) = f(D) ⊃(f(b′), f(a′)). Thus f(C) must
contain a Thus f(C) must contain a residual subset of the interval [ f(b′), f(a′)].
Exercise 786, page 366
For example, consider the set
E = {x : D+ f(x) < r}
and write, for positive integers m and n,
Emn = {x : f(x+t)−f(x)−rt +t/m ≤0 for all 0 ≤t ≤1/n}.
Since f is continuous, we can check that each set Emn is closed. But
E =
∞
[
n=1
∞
[
m=1
Emn
reveals that E must be Lebesgue measurable.
Exercise 789, page 367
Use the Darboux property of continuous functions. As a more challenging exercise the student may wish to prove this
without the assumption of continuity.
Exercise 791, page 367
This follows immediately from Lemma 9.19 since we know (Exercise 775) that, for every continuous function f, the
measure λ⋆
f must be σ-ﬁnite.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
665
Exercise 793, page 368
Let
β1 = {(I,x) : sλ(I) < |h(I,x))}
and
β2 = {(I,x) : |h(I,x))| < rλ(I)}.
Note that β1 is a ﬁne cover of E and that β2 is a full cover of E. Let β be any full cover of E and note that β1 ∩β is a ﬁne
cover of E and that β2 ∩β is a full cover of E. Thus
V ∗(h,E) ≤V(h,β∩β2) ≤rV(λ,β∩β2) ≤rV(λ,β).
From this it follows that
V ∗(h,E) ≤rλ∗(E).
Similarly
sV∗(λ,E) ≤V(sλ,β∩β1) ≤V(h,β∩β1) ≤V(h,β).
From this it follows that
sλ∗(E) ≤V ∗(h,E).
Exercise 794, page 368
Use the methods already seen for Exercise 793.
Exercise 796, page 368
Write
En = {x ∈E : lip f (z) < n}.
By Lemma 9.16
λf (En ∩[−n,n]) ≤nλ(En ∩[−n,n]) < ∞.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

666
CHAPTER 11. APPENDIX
It follows that f has σ-ﬁnite variation in E. Note then, that if N is a null subset of E,
λf (N) ≤
∞
∑
n=1
λf (En ∩N) ≤nλ(En ∩N) = 0.
This proves the ﬁnal assertion.
Exercise 797, page 372
If S is a null set then Z = S solves the exercise. Otherwise construct such a set by ﬁrst taking a countable dense subset
Z1 of S. [The endpoints of the complementary intervals will sufﬁce, unless S contains an interval. If S does contain an
interval then include all rational numbers in that interval.] Now Z1 is a countable subset of S and so has measure zero.
For each integer n choose an open set Gn containing Z1 with λ(Gn) < 1/n. Finally check that Z = S∩T∞
n=1 Gn is a Gδ-set
and that λ(Z) = λ(Z1) = 0.
Exercise 799, page 382
Take g′ to denote the derivative of g where that exists and 0 otherwise; such a function is measurable and we will be able
to apply Exercise 693.
Observe ﬁrst that if [c,d] is any compact interval then
|∆g([c,d])| ≤
Z
[c,d] |g′(x)|dx.
This follows from the fact that g is continuous so that
|∆g([c,d])| ≤λ(g([c,d]) ≤λ(g([c,d]∩N)+λ(g([c,d]\N) =
λ(g([c,d]∩N) ≤λg([c,d]∩N) =
Z
[c,d] |g′(x)|dx.
Use Theorem 9.7 and Theorem 9.23. Now apply Exercise 693 to obtain, for every ε > 0, a δ > 0 so that if G is an open
set with λ(G) < δ then
Z
G |g′(x)|dx < ε.
In particular, if we are given any sequence of nonoverlapping intervals {[cn,dn]} for which ∑n λ([cn,dn]) < δ then there
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
667
is an open set G covering these intervals for which λ(G) < δ; it follows that
∑
n
|∆g([cn,dn])| ≤∑
n
Z
[cn,dn] |g′(x)|dx ≤
Z
G |g′(x)|dx < ε.
Exercise 800, page 387
Under these hypotheses there is an indeﬁnite integral F of the function f on the open interval (a,b). If F is uniformly
continuous on (a,b) then we know that f is integrable on all of [a,b]. Thus it is enough to establish that when f has
continuous upper and lower integrals on [a,b] it follows that F is uniformly continuous on (a,b).
Exercise 801, page 387
Deﬁne F appropriately, starting with
F(z) =
∑
[ai,bi]⊂[a,z]
Z bi
ai
f(x)dx
for any z ∈E and, for z ∈(aj,b j), set
F(z) = F(aj)+
Z z
a j
f(x)dx.
Obtain V ∗(∆F −fλ,[a,b]) = 0 from V ∗(fλ,E) = 0, V ∗(∆F,E) = 0, and
V ∗(∆F −fλ,[a,b]\E) ≤
∞
∑
i=1
V ∗(∆F −fλ,[ai,bi]).
Exercise 808, page 401
This is “intuitively obvious.” Certainly in dimension one, length is additive, in dimension two area is additive, in
dimension three volume is additive, etc.
Well no. While the truth of the statement is hardly surprising and it is indeed trivial in dimension one, a proof would
still be needed. Not all textbooks might supply such a proof but if you search enough there should be a number of
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

668
CHAPTER 11. APPENDIX
examples. McShane proves this as Lemma 2-1 (p. 255) of his text and includes the following comment:
In higher-dimensional spaces the result is still true, but the proof of that fact is tedious. Some people may
think that this additivity is “intuitively evident” and that it is a waste of time to prove it. But even in the
plane there are far more complicated dissections of an interval into subintervals than simple checkerboard
pattterns. . . . Besides that, who can honestly say that he has any clear-cut “intuitions” about 19-dimensional
space?
E.J. McShane, Uniﬁed Integration, Academic Press (1983).
Exercise 809, page 401
This is the higher dimensional version of the Cousin lemma that was used extensively in the elementary chapters. As
is usual in mathematics the higher dimension version can be proved by a similar method provided one takes the time to
modify the argument as needed. The key tool in dimension one was the nested interval property asserting that a shrinking
sequence of closed bounded intervals converged to a point. The same is true in higher dimensions. Having established
this fact the proof of the Cousin lemma is then straightforward.
If you need to see a formal proof see Theorem 3-1, p. 258 in E. J. McShane, Uniﬁed Integration, Academic Press
(1983). Henstock also takes the trouble to prove this assertion in detail in Theorem 4.1, p. 43 of R. Henstock, Lectures
on the Theory of Integration, World Scientiﬁc (1988).
Exercise 818, page 408
Do not use Theorem 10.8 since that is not the point of the exercises.
Exercise 819, page 409
Do not use Theorem ?? since that is not the point of the exercise. You can use Lemma 10.2.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
669
Exercise 823, page 413
This will require an application of the dominated convergence theorem. For details that can be used to prove this exercise
as well as the preceding two exercises see the proof of Theorem 4–1, pp. 262–264 in E. J. McShane, Uniﬁed Integration,
Academic Press (1983).
Exercise 825, page 414
This is given as Corollary 4–2, pp. 265-266 in E. J. McShane, Uniﬁed Integration, Academic Press (1983).
Exercise 826, page 414
You should be able to verify that
Z 1
−1
µZ 1
−1 f(x,y)dx
¶
dy =
Z 1
−1
µZ 1
−1 f(x,y)dy
¶
dx = 0
while the double integral
Z Z
[−1,1]×[−1,1] f(x,y)dxdy
fails to exist. For the double integral consider ﬁrst the integrals over the squares [n−1,1] × [n−1,1] and [−1,−n−1] ×
[−1,−n−1] for n = 2,3,4,....
Exercise 827, page 415
You should be able to verify that
Z 1
0
µZ 1
−1 f(x,y)dy
¶
dx = 0
but that both
Z 1
−1
µZ 1
0 f(x,y)dx
¶
dy
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

670
CHAPTER 11. APPENDIX
and the double integral
Z Z
[−1,1]×[−1,1] f(x,y)dxdy
fails to exist. For the double integral consider ﬁrst the integrals over the intervals [n−1,1]×[0,1] for n = 2,3,4,....
Exercise 828, page 415
You should be able to verify that
Z 1
0
µZ 1
−1 f(x,y)dy
¶
dx = 1
but that
Z 1
−1
µZ 1
0 f(x,y)dx
¶
dy = −1
while the double integral
Z Z
[0,1]×[0,1] f(x,y)dxdy
fail to exist. For the double integral consider that the function f(x,y) > 4/(27x2) at every point in the set
{(x,y) : n−1 ≤x ≤1, 0 < y < x/2}.
Exercise 829, page 415
Well you can indeed deﬁne anything you want but it needs to be consistent and useful. There are (see Exercise 827)
situations in which only one of the expressions
Z d
c
µZ b
a f(x,y)dx
¶
dy
and
Z b
a
µZ d
c f(x,y)dy
¶
dx
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
671
exists. So which order do we take as our deﬁnition? There are also situations in which both exist (see Exercise 828)
but have different values! This student’s version of an integral would not even, then, allow us to rotate the axes by a
right-angle without changing the integral radically. There are also situations in which both integrals exist and have the
same value but the double integral does not exist in our sense (see Exercise 826) and shouldn’t exist since it leads to
unpleasant conclusions.
Exercise 830, page 418
Take any subdivision of [a,b],
a = x0 < x1 < x2 < ··· < xn−1 < xn = b.
Let
Ei = {x ∈E : xi−1 < f(x) ≤xi}
and recall that
Ln(Ei) = w(xi)−w(xi−1).
Check that
xi−1[w(xi)−w(xi−1)] ≤
Z
Ei
f(x)dx ≤xi[w(xi)−w(xi−1)].
This connects the Riemann sums
n
∑
i=1
xi[w(xi)−w(xi−1)] and
n
∑
i=1
xi[w(xi)−w(xi−1)]
with the integral
Z
{x∈E:a< f(x)≤b} f(x)dx =
n
∑
i=1
Z
Ei
f(x)dx.
Exercise 831, page 418
Remember that, the inﬁnite integral
Z ∞
−∞sdw(s)
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

672
CHAPTER 11. APPENDIX
would be the same as
lim
nto∞
Z n
−n sdw(s).
Thus we need to show that
Z
E f(x)dx = lim
nto∞with
Z
{x∈E:−n<f(x)≤n} f(x)dx
which is a simple measure-theoretic computation.
Exercise 832, page 422
Choose z ∈E but not in E1. Consider the intervals
In = (z−1/n,z+1/n).
If E1 ∩In ̸= /0 for all n then from Exercise 23 we can deduce that z would have to belong to the closed set E1.
Exercise 833, page 422
If n = 1 this is obvious. Use induction on n.
Exercise 834, page 423
Suppose not, i.e., suppose that none of the sets Ek contain a portion of E. Then, using Exercise 833, select a portion
E ∩(a1,b1) so that E ∩(a1,b1) = /0 and pass to a closed subinterval [c1,d1] ⊂(a1,b1) for which E ∩[c1,d1] ̸= /0. Continue
inductively, choosing portions
E ∩(an,bn) ⊂[cn−1,dn−1]
and closed subintervals [cn,dn] ⊂(an,bn) for which E ∩[cn,dn] ̸= /0.
The nested sequence of intervals {[cn,dn]} all must contain a point z of E in common. But this point z cannot belong
to any of the sets Ek which is in contradiction to the hypothesis that E ⊂S∞
k=1 Ek.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

11.2. ANSWERS TO EXERCISES
673
Exercise 835, page 423
To adjust the proof, at the nth stage of the induction select the interval (an,bn) ⊂Gn. The point z you will ﬁnd must
belong to each of the Gn and, consequently, to E. Sets of the form E = T∞
j=1 G j for some sequence {G j} of open sets
are said to be sets of type Gδ.
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

Index
Abel test for uniform convergence, 104, 125, 600
absolute continuity in Vitali’s sense, 167, 181
absolute continuity, 165, 220
absolutely continuous, 356
absolutely continuous function, 165, 220
absolutely continuous function may not have bounded vari-
ation, 165, 220
absolutely convergent integral, 63, 172, 234
absolutely integrable, 90, 240
absolutely integrable function, 95
absolutely integrable function, 295
accumulation point of view, 127
algebraic number, 149
almost everywhere, 206
applications of the integral, 127
approximation by Riemann sums, 173, 234
area, 127
arithmetic Construction of Cantor set, 157
avoiding the mean-value theorem, 36
backwards integral, 70
Baire, René, 422
Baire-Osgood Theorem, 422
Banach, S., 210
Banach, Stephan, 380
Banach-Zarecki Theorem, 380
Beppo Levi Theorem, 365
Bers, Lipman, 511
bijective function, 450
Bliss theorem, 82
Bliss, G. A., 82
Bolzano-Weierstrass argument, 25, 26
Bolzano-Weierstrass compactness argument, 20
Borel family, 275
bounded derived numbers, 40, 517
bounded function, 23
bounded integrable functions, 172
bounded interval, 4
bounded set, 4
bounded variation, 91, 135
boundedness properties of uniformly continuous functions,
22
calculus integral, 60
675
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

676
INDEX
calculus integral is a nonabsolute integral, 91
calculus student notation, 53, 72, 88, 121
Cantor
set, 154, 157
theorem, 149
Cantor dust, 154
Cantor function, 158, 159
Cantor function not absolutely continuous, 166, 222
Cantor set, 157, 159
Cantor set has measure zero, 202
Cantor ternary set, 154
Cantor, G., 149, 159
Carathéodory characterization of measurable set, 286
Carathéodory, Constantin, 288
careless student, 41, 101, 120, 158, 205, 312
Cartesian product, 450
Cauchy
criterion for uniform convergence, 102
Cauchy criteria, 242
Cauchy criterion for series, 103
Cauchy mean-value theorem, 35
Cauchy-Schwarz inequality, 145, 610
change of a function, 161
change of variable, 54, 87, 176, 251
characteristic function, 427
characteristic function of the rationals, 16
characterization of the integral, 388
characterization of the Lebesgue integral, 293
Ciesielski, K., 279
class, see set
classicalrealanalysis.com, 3
closed interval, 4
closed set, 4
collection, see set
complementary intervals of Cantor set, 156
composition
of functions, 429
connected set, 11
constant functions, 38
constant of integration, 43
construction of Cantor function, 159
construction of the integral, 285
contiguous interval, 427
continuity and zero variation, 164
continuous upper and lower integrals, 386
continuous upper/lower integrals, 386
contraposition, 430
convergence
uniform convergence, 102
convergent integral, 63, 172, 234
converges inﬁnitely slowly, 576
converse, 430
converse to the mean-value theorem, 36
countable number of discontinuities, 152
countable set, 148, 149
countable set has measure zero, 153
counterexamples, 97
Cousin covering argument, 20
Cousin covering lemma, 194
Cousin’s lemma, 401
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

INDEX
677
covering relation, 189
curve, 134
curve length, 344
Darboux property, 25
Darboux property of continuous functions, 26
Darboux property of derivative, 37
Darboux property of Dini derivatives, 366
Darboux, J. G., 26, 37
Darboux, Jean-Gaston, 238
De Morgan’s laws, 433
decomposition, 195
deﬁnite integral, 60, 169, 233
deﬁnite vs. indeﬁnite integrals, 72
degenerate interval, 464
Denjoy integral, 310
Denjoy’s program, 309
Denjoy, Arnaud, 309, 310
Denjoy, Arnoud, 350
Denjoy-Perron integral, 84
derivative, 28
Darboux property of, 37
not the limit of derivatives, 97
derivative of the deﬁnite integral, 89, 177
derivative of the indeﬁnite integral, 55
derivative of the integral, 253
derivative of the limit is not the limit of the derivative, 97
derivative of the variation, 94
derivatives and uniform convergence, 111
determined, 240
devil’s staircase, 158
difference of sets, 460
differentiable function is absolutely continuous, 166, 222
differentiable functions are integrable, 66
differentiable implies continuous, 29
differentiation rules, 30
Dini derivative, 360
Dirichelet integral, 75, 548
discontinuities of monotonic functions, 148
discontinuity
of a limit of continuous functions, 97
discontinuous limit of continuous functions, 97
distance
between a point and a set, 16
domain of a function, 435
dummy variable, 71
dx, 71
empty set /0, 435
enumeration, 148
epsilon, delta version of derivative, 28
epsilons, 445
equivalence relation, 435
error estimate for Riemann sums, 79
error estimate for Simpson’s rule, 139
error estimate for trapezoidal rule, 139
exact computation by Riemann sums, 77
existence of indeﬁnite integrals, 48
family, see set
Fatou’s lemma, 289
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

678
INDEX
ﬁne cover, 190
ﬁne null, 209
ﬁne variational measure, 299, 351
ﬁnite derived numbers, 166, 223
ﬁnite variation, 356
ﬁrst mean-value theorem for integrals, 73
ﬁxed point, 26
Flett’s theorem, 37
Flett, T., 512
formula for the length of a curve, 135
Freiling’s criterion, 297
Freiling, Chris, 49
Freiling, Christopher, 297
Fubini differentiation theorem, 228
Fubini theorem, 416
full cover, 190
full null set, 207
full variational measure, 299, 351
function, 11
σ-ﬁnite variation, 356
absolutely continuous, 356
bijective, 450
bounded variation, 91
Cantor function, 159
characteristic function of a set, 427
composition, 429
distance between set and point, 16
domain of, 435
ﬁnite variation, 356
ﬁxed point of, 26
injective, 450
inverse of, 440
Kolmogorov equivalence, 353, 356
Lipschitz, 40
Lipschitz numbers, 363
mutually singular, 356
one-to-one, 450
onto, 450
range of, 454
saltus, 356
singular, 356
smooth, 35
step function, 15
surjective, 450
Vitali property, 356
zero variation, 356
function of Cantor, 158
function with zero variation, 161
growth lemmas, 364
growth of a function, 161
Harnack extension property, 387
Harnack property, 387
Heaviside function, 66
Heaviside’s function, 15
Heine-Borel argument, 21
Heine-Borel property, 26
Hellinger integral, 347
Hellinger, Ernst, 347
Henstock property, 84
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

INDEX
679
Henstock’s criterion, 173, 234
Henstock, Ralph, 84, 173, 234, 350
Henstock-Kurzweil integral, 180
Heuer, Gerald A. , 569
inadequate theory of integration, 184
indeﬁnite integral, 43
indeﬁnite integrals and bounded variation, 95
indicator function, see characteristic function of a set
indirect proof, 437
inequalities, 175
inequality
Cauchy-Schwarz, 610
inequality properties of the integral, 85
inﬁnitely slowly, 576
injective function, 450
integrability on subintervals, 245
integrable, 240
integrable [calculus sense], 60
integrable function, 169, 233, 240
integral, 238
not the limit of the integral, 98
integral inequalities, 64
integral of nonnegative measurable function, 288
integral of simple function, 288
integral of the limit is not the limit of the integrals, 98
integration by parts, 52, 87, 176, 253
integration by substitution, 54, 87, 176
integration of series, 256
interchange of limit operations, 98
intermediate value property, 26
of derivative, 37
intersection of sets , 460
intersection of two closed intervals, 4
intersection of two open intervals, 4
intervals, 3
inverse
of a function, 440
irrational number in the Cantor ternary set, 157
Israel Halperin, 512
iterated integral, 411
Java Applets, 608
Jordan decomposition, 93
Kolmogorov equivalence, 353, 356
Kolmogorov, A. N., 353
Kurweil, Jaroslav, 84
Kurzweil-Henstock integral, 180
L’Hôpital’s rule, 35
law of the mean, 32
least upper bound argument, 24
least upper bound property, 26
Lebesgue characterization of measurable, 286
Lebesgue decomposition theorem, 293
Lebesgue integrable, 181
Lebesgue integral, 181
Lebesgue measure, 264
length of a curve, 134
length of a graph, 134
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

680
INDEX
length of curve, 344
Levi, Beppo, 365
liminf comparison lemma, 368
limit
interchange of limit operations, 98
limitations of the calculus integral, 65, 151
limits of Discontinuous Derivatives, 113
limsup comparison lemma, 368
linear combination, 14, 52
linear combinations, 86, 175
Lipschitz
condition, 40
function, 40
Lipschitz condition, 24
Lipschitz function, 50, 93, 166, 172, 222
Lipschitz function is absolutely continuous, 166, 222
Lipschitz numbers, 363
local conditions for integrability, 382
local integrability, 382
locally bounded function, 23
locally of bounded variation, 94
locally strictly increasing function, 29
logarithm, 145
logarithm function, 100
lower integral, 238
lower Stieltjes integral, 315
Lusin’s conditions, 380
Lusin, N., 350, 380
Luzin, N. N., 575
M-test, 104
manipulations with indeﬁnite integrals, 51
Maple, 57, 143, 144
mapping deﬁnition of continuity, 16
maximum, 24
McShane’s characterization of the Lebesgue integral, 294
McShane’s criterion, 295
McShane, E. J., 668
McShane, Edward J., 295
meager subset, 423
mean-value theorem, 30, 32
second-order, 34, 35
mean-value theorem for integrals, 73
mean-value theorem of Cauchy, 35
measurable function, 280, 407
measurable set, 275, 406
measure zero, 152, 200
measure zero set, 202
method of exhaustion, 128
monotone convergence theorem, 114, 256
Morse, Anthony P., 366
mutually singular, 356
mutually singular functions, 341
nested interval property, 449
no interval has measure zero, 153
nonabsolutely integrable, 240
nonabsolutely integrable function, 298
nondifferentiable, 28
nonmeasurable sets, 278
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

INDEX
681
notation for indeﬁnite integral, 47
null function, 179
numerical methods, 136
one-to-one function, 450
onto function, 450
open interval, 4
open set, 4
ordered
pairs, 450
oscillation, 241
oscillation of a function, 17
Osgood, W., 422
Osgood-Baire Theorem, 422
parametric curve, 134
parametric equations, 134
partial fractions, 57
partition, 75, 188
Pfeffer property, 370
piecewise monotone, 37
pointwise approximation by Riemann sums, 84, 173, 234
pointwise continuous, 13
portions, 422
products of integrable functions, 69
proof
contraposition, 430
converse, 430
indirect, 437
properties of the deﬁnite integral, 85
properties of the integral, 174
properties of the total variation, 92
pruning of a covering relation, 189
quantiﬁer
∃, 453
∀, 453
range of a function, 454
real numbers, 455
rectiﬁable, 135
reduction theorem, 327, 348
relation, 455
equivalence relation, 435
residual subset, 423
review, 1
Riemann criterion, 311
Riemann integrable function, 183
Riemann integral, 183
Riemann sums, 75, 138, 173, 196, 234
Riesz, Frigyes, 181
Rolle’s Theorem, 31
Rozema, Edward , 607
Saks, Stanislaw, 350
saltus, 356
second mean-value theorem for integrals, 74
second mean-value theorem for the calculus integral, 145
second order mean-value theorem, 34
sequence deﬁnition of continuity, 16
sequence of functions uniformly bounded, 107
sequence of functions uniformly Cauchy, 102
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

682
INDEX
sequence of functions uniformly convergent, 102
sequences and series of integrals, 96
sequences of functions of bounded variation, 94
sequences of sets of measure zero, 153
set
Cantor set, 154, 159
Cantor ternary set, 154, 157
Cartesian product, 450
countable, 148, 149
De Morgan’s laws, 433
deﬁnition of, 458
difference of sets, 460
empty set /0, 435
intersection of sets, 460
measure zero, 202
of ordered pairs, 450
of real numbers, 455
of zero content, 205
quantiﬁer, 453
quantiﬁer ∃, 453
quantiﬁer ∀, 453
relation, 455
set-builder notation, 458
subset, 460
union of sets, 460
set of measure zero, 200
set-builder notation, 458
sets of measure zero, 152
simple function, 282
Simpson’s rule, 139
sin integral function, 75, 548
singular, 356
singular function, 343
smooth function, 35
Solovay, R. M., 279
step function, 15
step functions, 49
step functions are integrable, 66
Stieltjes integral, 315, 417
Stieltjes, T. J., 315
straddled version of derivative, 29
subintervals, 87, 176
subpartition, 75, 153, 162, 189
subset, 460
summing inside the integral, 114, 256
surjective function, 450
Szökefalvi-Nagy, Béla, 181
tables of integrals, 58
TBB, 3, 181
ternary representation of Cantor set, 157
theorem
mean-value theorem, 32
of Cantor, 149
theorem of G. A. Bliss, 82
theorem of G. C. Young, 365
theorem of Morse, 366
theorem of W. H. Young, 365
total variation function, 91
transcendental number, 149
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

INDEX
683
trapezoidal rule, 139
trigonometric functions, 12
Trillia Group, 151
unbounded interval, 4
unbounded limit of bounded functions, 97
uniform Approximation by Riemann sums, 79
uniform convergence, 102
Abel’s test, 104, 600
Cauchy criterion, 102
Weierstrass M-test, 104
uniform convergence and derivatives, 111
uniform convergence of continuous functions, 109
uniformly approximating the variation, 94
uniformly bounded family of functions, 107
uniformly Cauchy, 102
uniformly continuous, 13
uniformly full cover, 190
uniformly full null, 209
union of compact intervals, 212
union of sets , 460
unstraddled version of derivative, 29
upper function, 49
upper integral, 238
upper Stieltjes integral, 315
vanishing derivatives, 38
vanishing derivatives with a few exceptions, 38
variation expressed as a Stieltjes integral, 322
variational measures, 299, 351
Vitali continuous, 304
Vitali cover, 190
Vitali covering theorem, 210
Vitali deﬁnition of absolute continuity, 167, 181
Vitali property, 356
Vitali property and differentiability, 372
Vitali property characterized, 376
Vitali’s criterion, 304
Vitali, G., 167, 181, 210, 278
Vitali, Guiseppe, 303
Weierstrass
M-test, 104
why the ﬁnite exceptional set?, 65
Young, Grace Chisolm, 365
Young, William Henry, 365
Zakon, Elias, 44
Zakon, Elias , 151
Zarecki, M. A., 380
Zermelo–Fraenkel set theory, 279
zero content, 205
zero derivatives, 217
zero derivatives imply zero variation, 164
zero measure, 202
zero variation, 161, 215, 356
zero variation criterion, 318
zero variation lemma, 164
ClassicalRealAnalysis.com
B S Thomson
THE CALCULUS INTEGRAL
Beta0.2

