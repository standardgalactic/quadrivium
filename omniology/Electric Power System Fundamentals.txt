
Electric Power System Fundamentals

For a listing of recent titles in the 
Artech House Power Engineering and Power Electronics Library,
turn to the back of this book.

Electric Power System Fundamentals
Salvador Acha Daza
artechhouse.com

Library of Congress Cataloging-in-Publication Data 
A catalog record for this book is available from the U.S. Library of Congress
British Library Cataloguing in Publication Data 
A catalog record for this book is available from the British Library. 
ISBN-13: 978-1-63081-085-6
Cover design by John Gomes
© 2016 Artech House 
685 Canton Street 
Norwood, MA
All rights reserved. Printed and bound in the United States of America. No part of 
this book may be reproduced or utilized in any form or by any means, electronic or 
mechanical, including photocopying, recording, or by any information storage and 
retrieval system, without permission in writing from the publisher.
All terms mentioned in this book that are known to be trademarks or service marks 
have been appropriately capitalized. Artech House cannot attest to the accuracy of this 
information. Use of a term in this book should not be regarded as affecting the validity  
of any trademark or service mark.
10  9  8  7  6  5  4  3  2  1

v
Contents
Acknowledgments	
xi
Preface	
xiii
Chapter 1
Fundamentals of Energy Systems	
1
1.1	
Introduction	
1
1.2	
Work and Energy in Electric Circuits	
4
1.2.1	 Power and Energy in Constant DC Systems	
4
1.2.2	 Power and Energy in AC Circuits	
6
1.2.3	 Instantaneous Power P(T), Real Power P and Reactive Power Q	 11
1.2.4	 Load Convention for Power Flows	
13
1.3	
Three-Phase Voltages, Currents and Power	
18
Appendix 1A Complex Numbers	
23
References	
25
Chapter 2
Network Analysis	
27
2.1	
Introduction	
27
2.2	
Ohm’s Law	
29
2.3	
Circuits with Lumped Elements	
32
2.4	
Kirchhoff’s Current Law	
33
2.5	
Nodal Formulation	
35
2.6	
Kirchhoff Voltage Law (KVL) and the Mesh Method	
38
2.7	
Linear Equations and Gaussian Elimination	
40
2.7.1	 Cramer’s Rule	
42
2.7.2	 Partial Inversion	
42
2.7.3	 Kron’s Network Reduction	
44
2.8	
Matrix Elements for YBUS and ZBUS	
44
2.9	
Norton’s and Thévenin’s Equivalents	
47
2.10	 Large Scale Network Equivalents	
48
2.10.1	 Partitioned Networks and Equivalents	
49
2.11	 Diakoptical Approach	
54
2.12	 Matrix Inversion Lemma	
56
References	
57

vi
Contents
Chapter 3
POWER TRANSFORMER MODELING	
59
3.1	
Introduction	
59
3.2	
Equation’s Decoupling and Symmetrical Components	
59
3.2.1	 Symmetrical Components Transformation	
62
3.2.2	 Decoupling of State Equations	
64
3.3	
Single-Phase Transformer Model	
67
3.3.1	 Per Unit Values	
69
3.4	
Three-Phase Bank Transformer Model	
74
3.4.1	 Three-Phase ΔΔ Bank	
74
3.4.2	 Three-Phase YΔ Bank	
77
3.4.3	 Three-Phase YY Bank	
79
3.5	
Autotransformer Model	
85
3.6	
Three Winding Transformer	
89
3.7	
Three-Phase Transformer	
92
3.8	
Alternate Model for a Single-Phase Transformer	
95
3.9	
Function for the Partial Inversion Algorithm	
97
References	
98
Chapter 4
Transmission Line and Cable Modeling	
99
4.1	
Introduction	
99
4.2	
Series Inductance	
99
4.2.1	 Single Conductor	
100
4.2.2	 Inductance for a Set of Aerial Conductors	
102
4.2.3	 Set of Bundled Conductors	
105
4.2.4	 Ground Wire Inclusion	
107
4.2.5	 Line Transposition	
109
4.2.6	 Sequence Impedances	
111
4.3	
Earth Return	
112
4.4	
Gauss Law and Capacitance	
117
4.4.1	 Potential at Midpoint Between Two Electric Charges	
119
4.4.2	 Conductors Parallel to an Ideal Equipotential Plane	
119
4.4.3	 Capacitance and Shunt Admittance	
120
4.5	
Calculation of Cable Parameters	
122
4.5.1	 Cable Series Impedance	
123
4.5.2	 Cable Shunt Capacitance	
126
4.5.3	 Three-phase Cables	
127
4.5.4	 Three-phase Cables, Pipe Type	
129
4.6	
Geometric Mean Radius	
132
4.7	
Equivalent Height	
133
4.8	
Transmission Lines in Parallel	
135
References	
136

Contents
vii
Chapter 5
Transmission Line Loadability	
137
5.1	
Introduction	
137
5.2	
Approximate Real Power Handling and Losses	
137
5.2.1	 Number of Circuits Required to Transport Electric Power	
139
5.2.2	 Reactive Power Required by the AC Transmission Line	
141
5.3	
V(x) and I(x) Equations for a Long Transmission Line	
141
5.3.1	 The Flat Line Concept	
143
5.3.2	 Surge Impedance, Wave Length and Propagation Velocity	
143
5.3.3	 No-Load Line and General Hyperbolic Form	
144
5.3.4	 Nominal π and Equivalent Circuit	
144
5.3.5	 Long Line Equivalent Circuit	
145
5.4	
ABCD Constants	
146
5.4.1	 ABCD Equivalent for Series Connection	
148
5.4.2	 Nodal Admittance Matrix from ABCD Constants	
148
5.5	
Power Flow Calculations using ABCD Constants	
151
5.6	
Transmission Limits	
154
5.6.1	 Thermal Limit	
154
5.6.2	 Stability’s Angle Limit	
154
5.6.3	 Limit from Voltage Drop	
155
5.7	
Wave Equation and Time Expressions	
156
5.7.1	
Product x LC  and Speed ν	
156
5.7.2	 Functions AV(t − x/ν) and AI(t − x/ν)	
157
5.7.3	 Expressions for AV, BV, AI, BI	
158
5.7.4	 Reflexion Coefficients	
158
5.7.5	 Calculation of Coefficients	
159
5.7.6	 Coefficients for Connection of Various Elements	
164
5.7.7	
Lattice Diagram	
165
5.7.8	 Electric Element Connections at Receiving Terminal	
166
References	
168
Chapter 6
Power Flows	
169
6.1	
Introduction	
169
6.2	
Solution of Nonlinear Equations	
169
6.2.1	 Newton’s Iterative Process	
172
6.3	
Newton’s Method for Power Flow Solutions	
174
6.4	
Power Flow Equations	
175
6.4.1	 Complex Power Transformer and Incremental Power Flows	
175
6.4.2	 Incremental Power Flow for a Transmission Line	
180
6.5	
Newton’s Power Flow Solution	
182
6.6	
Power Flow Approximations	
186
6.7	
DC Network Power Flow Solutions	
193
6.7.1	 Incremental DC Power Flow Equations	
194

viii
Contents
6.8	
Incremental Power Flow and Control Actions	
198
6.9	
Unbalanced Three-Phase Power Flow	
200
References	
205
Chapter 7
Optimal Operation of Power Systems	
207
7.1	
Introduction	
207
7.2	
Nonlinear Optimization	
207
7.3	
Optimal Dispatch with No Losses	
211
7.3.1	 Inequality Constraints	
213
7.4	
Real Power Losses	
216
7.5	
Minimum Losses	
218
7.6	
Optimal Operation, Transmission Losses Included	
222
7.6.1	 Minimum Cost Power Flow Formulation	
225
7.7	
Hydrothermal Power System Coordination	
233
7.7.1	
Objective Function and Constraints	
234
7.8	
Second-Order Derivatives	
242
Reference	
248
Chapter 8
Real and Reactive Power and Frequency Control	
249
8.1	
Introduction	
249
8.2	
Control of Real Power Flows	
250
8.3	
Control of Real Power Flow, Longitudinal Networks	
255
8.4	
Control of Reactive Power Flow	
258
8.5	
Congestion and Minimum Effort Control	
262
8.5.1	 Use of Sensitivity Coefficients	
262
8.5.2	 Optimal Control of Real Power Flow	
265
8.5.3	 Optimal Control for Reactive Power Flow	
268
8.5.4	 Optimal Coordinated Control Efforts	
270
8.6	
Work and Energy	
273
8.6.1	 Kinetic Energy and Electrical Frequency	
276
8.6.2	 Turbine’s Power and System’s Frequency	
277
8.6.3	 Frequency Control by a Primary Loop	
279
8.7	
Incremental Power Model to Include a VSC-STATCOM	
282
8.7.1	 Power Flows in a Complex Transformer and a Transmission 
Line	
283
8.7.2	 Expressions for Incremental Power Flow	
284
8.8	
Voltage Source Converter (VSC) and STATCOM	
287
8.8.1	 Incremental Model for the VSC	
288
8.9	
Extensions to the Model	
290
8.9.1	 Reactive Power and Voltage Control	
290
8.9.2	 DC Load	
292
8.10	 STATCOM Model	
292
8.10.1	 OLTC’s Real and Reactive Power Flows	
292
8.11	 Chapter Summary	
295
References	
295

Contents
ix
Chapter 9
General Fault Studies in Electrical Power Systems	
297
9.1	
Introduction	
297
9.2	
Fault Equation in Phase Coordinates abc	
297
9.3	
Fault Equation in Coordinates 012	
298
9.3.1	 Three-Phase Fault	
300
9.3.2	 Other Types of Shunt Faults	
307
9.4	
Series Faults	
309
9.5	
Useful Circuit Interpretation for Fault Connections	
312
9.5.1	 Single-Phase Fault	
312
9.5.2	 Fault Between Two Phases, No Ground	
314
9.5.3	 Fault Between Two Phases and Ground	
316
9.6	
Alternative Equation for Fault Current Calculation	
317
9.7	
Transient and Subtransient Impedances in Magnetic Circuits	
318
9.7.1	
Transient Response in a Magnetic Circuit	
318
9.7.2	 Subtransient Response	
319
References	
320
Chapter 10
Contingency Analysis	
321
10.1	 Introduction	
321
10.2	 General System Incremental Linear Network	
323
10.3	 Sensitivity Matrix for a Linear Circuit	
327
10.3.1	Sensitivity Matrix for Incremental Control Changes	
328
10.4	 Single Contingency Model	
329
10.4.1	 Thévenin’s Equivalent	
330
10.4.2	Voltage and Reactive Power Under Contingencies	
335
10.5	 Participation Factors from System’s Lines	
340
10.6	 Summary	
342
Chapter 11 
State Estimation in Electrical Power Systems	
343
11.1	 Introduction	
343
11.1.1	 Centralized Data Acquisition System	
344
11.2	 Least Squares, Linear Model	
345
11.2.1	Power System’s Linear State Estimation	
348
11.3	 Maximum Likelihood and Weighted Least Squares	
354
11.3.1	 Bad Data Detection	
357
11.4	 Nonlinear Minimum Squares	
361
11.5	 Thévenin’s Equivalent and Parameter Estimation	
364
11.6	 Phasor Estimation and Related Problems	
366
11.6.1	 Wide Area Measurements	
371
11.7	 Observability	
372
References	
374
About the Author	
375
Index	
377


xi
Acknowledgments
This work would not been possible without the loving and kind support of my 
wife, Eloisa. She made everything possible so that I had the time to undertake this 
effort. I am very grateful for her contribution. From my daughters and son, I only 
had words of encouragement, especially when my spirits were not very high. I thank 
Eloisa, Diana, and Salvador. The little ones—Danny, Ben, and Alex—are a precious 
joy and when we spend time playing together, learning things that capture their 
imagination and interest, we certainly have fun, but in that kind of process, I hope 
to capture some more engineers for the family.
I wish to thank my late mother and father, who always fought hard to give me 
and my brothers an education. To my brothers, Carlos, Enrique, and Jorge, and my 
sister, Rosa— I am thankful that we shared the same starting seed and that eventu-
ally everyone turned out so well. 
I cannot continue without acknowledging the friendship and moral support 
from Francisco Lemus, the late Professor Gabriel Munoz, and Eduardo Sanchez. 
I also thank the professors that influenced my thinking about modeling and math 
applications: Fernando Rodriguez Blanco, Teodoro Avendano, and Leonardo Saenz. 
Last, but not least, I hold in great regard the support from Enrique Marroquin, of 
Hunt Co., and his studies and the deployment of DC-DC interties during the last 
few years.
I am highly in debt for the contribution to my academics to Graduados de 
ESIME, Politecnico Nacional, in Mexico City and to the University of Texas at 
Arlington.


xiii
Preface
Modern electric power systems are sophisticated ensembles of power plants with 
diverse primary energy sources, step-up transformers that connect power plants 
to high-voltage transmission lines, which in turn, make the energy reach long dis-
tances up to main load centers where stepdown transformers reduce the voltage to 
safe values for consumers and equipment. The number of electric elements for a 
particular power utility might be numerous—in the thousands. The challenge to 
model, study, and analyze such a system is an enormous task, and is done with the 
help of numerical algorithms using digital computers.
The operation and control of electrical power systems and the planning of 
future conditions and system expansion are the main concerns of modern power 
systems engineers, not to mention security and reliability of supply. This is a large-
scale problem that must be solved for the steady state condition using appropriate 
models, and is here where power system engineers are required to comprehend the 
basic building blocks used to assemble the power system, namely models for trans-
mission lines and power transformers in various connections. Electrical engineers 
should be proficient in principles and the assumptions about models and its range 
of validity to conduct studies of three phase AC networks under balanced or unbal-
anced conditions or even with today’s requirements of a more pervasive interaction 
between AC and DC networks.
In Chapter 1 of this book, we will stress the fundamental principles used to 
eventually grasp and handle complexity. This will allow us to solve the steady 
state of linear and nonlinear networks. In particular, we are interested in what is 
considered the most basic point of departure (i.e., element’s current and voltage at 
its terminals and currents as nodal balance equations). These allow us to represent 
interconnection between networks and elements. Fundamental equations for electric 
circuits come from Ohm’s law and nodal current or nodal power balances. These 
are the stepping stones used as building blocks. Power and energy, phasors, real and 
reactive power concepts—as well as a brief extension to three-phase circuits—are 
those principles from which some more elaborated schemes will be later studied.
Chapter 2 is used to establish all the tools for network analysis that we will 
need later to study large interconnected networks. Starting with Ohm’s and Kirch-
hoff’s current law, the use of Gaussian elimination, and a particular interpretation 
of this process known as partial inversion, we will show the connection starting 
from primitive networks up to nodal analysis, as well as Norton’s and Thevenin’s 
equivalents and applications. Solutions to large networks and network partition, 
also known as diakoptics, will be put into a unified perspective.

xiv
Preface
In Chapter 3, the physical principle of decoupling is motivated and solved so 
as to have a diagonal matrix that relates state variables and output variables. The 
symmetrical components transformations is of particular significance for power 
engineers. We then move into a detailed study of transformers for analysis purposes, 
starting with a single-phase transformer that can be combined into three-phase 
configurations, giving us the possibility to model various connections as ∆∆, ∆Y, 
YY, and other unbalanced configurations. The calculation of sequence impedances 
can be carried out as outlined in Chapter 3. Autotransformers and three winding 
transformers as well as three-phase transformers are discussed.
Transmission lines and cables are discussed in Chapter 4. The importance of 
series impedance, the Earth return, and capacitive effects are stressed in this chapter. 
Faraday’s and Gauss’ laws turn out to be the founding blocks for these important 
modeling concepts. Earth wires and phase conductors in parallel and neutral con-
necting points are represented properly and its existence included in the model. The 
formulas are adequate for transmission lines and cables that work at low frequen-
cies, close to the 60 Hz frequency of operation for the power system. In case the 
line-cable parameters should need frequency dependent characteristics for other 
type of problems, then different models should be used.
Chapter 5 studies the very important topic of transmission line load-ability, 
where the line-distributed parameters are fundamental in order to attain proper 
values when loading a transmission line. This power system element has various 
interesting properties that need to be assessed, as the line might work with low 
power during light morning hours or under heavy load condition at peak hours. A 
wide range of power required to be shipped might need compensating equipment in 
order to fully use all the capability of the element and not be limited by the voltage 
drop criteria. The distributed nature of the series impedance and shunt capacitive 
susceptance will give a model to characterize the traveling wave phenomena, surge 
impedance and the speed of propagation where tools as the lattice diagrams for 
surge response calculation can be utilized.
In Chapter 6, we derive the real and reactive power flow expressions for a com-
plex transformer and a transmission line. We write the incremental expressions, 
showing that the first and second order derivatives can be obtained in closed form 
from the calculated values of the real and reactive power that flows through the 
element itself. First order derivatives are used to write the solution to fundamental 
network problems, particularly those of the power flows by Newton’s iterative pro-
cess. The second order derivatives are used to solve the nonlinear optimal problem 
for minimum cost of operation, optimal control, or hydro-thermal coordination. 
For the iterative process in the load flow problem or in the optimal formulations, 
we start with reasonable values (flat start or a better estimate) for the state vari-
ables. The number of equations should be consistent and solved for the incremental 
corrections to the state variables at each iteration the state variables approach a 
solution; for a well-posed problem the process, should converge in few iterations. 
Even though Newton’s law is reported to have a good rate of convergence, some 
problems might show slow convergence or no convergence at all, depending on the 
nature of the system, topology, and load level. We derive from incremental power 
flow expressions the decoupled model for power flows that are widely accepted 
by the power industry for networks the comply with assumptions as r/x ratio and 

Preface
xv
nodal angles separations. Chapter 6 also includes the nonlinear formulation used 
to solve an all-DC network; this is presented in a formulation to solve a three-phase 
unbalanced system.
Optimal power system’s operation is discussed in Chapter 7. The nonlinear 
nature of the problem is maintained in the cost function and the equality and inequal-
ity constraints. All functions are incorporated into a Lagrangian and optimal condi-
tions: gradient equal zero are derived. A nonlinear iterative process (Newton’s type) 
is used to solve the gradient equations at the solution point. Minimum operating 
cost, losses included, or the solution to the minimum loss problem can be written 
as a solution at one point in time. An extension is made to include time-dependent 
quantities (such as energy or water to be used in hydro generation in combination 
with thermal and other energy resources The interesting problem of energy coordi-
nation can be solved within the time horizon of interest and considering appropriate 
time increments, according to the problem to be solved.
Control of real and reactive power can be viewed form a static point of view in 
the sense of meeting a balance at every node in the system; dynamics and control 
are not modeled, and we are only interested in the new equilibrium condition, new 
nodal angles, voltages, and new power flows. Chapter 8 approaches this problem 
using linear sensitivity factors for the real power and the reactive power problem to 
coordinate control actions. Undoubtedly, the dynamics for changes and responses 
must be considered. As there are different time constants for response at each prob-
lem (namely real power frequency and voltage controls), we include a frequency 
response model in just one electric area, recognizing that the problem is more com-
plex than the one presented. However, we will have a glimpse of what comes when 
we need to study system’s frequency dynamics. In line with the static response, we 
include an extension of the complex transformer model (introduced previously in 
Chapter 6) to comprise schemes that work as flexible AC devices, namely a VSC and 
STATCOM. These arrangements demonstrate versatile ways to compensate reactive 
power and voltage control and the model discussed can easily be integrated into a 
regular Newton’s power flow program.
Chapter 9 discusses fault studies from a general point of view writing model 
equations (Thevenin’s equivalent) for the network and a set of equations for the 
fault connection. Then, when the fault is ensued, boundary conditions for nodal 
voltages and nodal currents must be met. The resulting equations will solve for the 
current feeding the fault. With this value, we then use the network equivalent to 
calculate the system’s response when the fault is present. The process can be applied 
to both shunt and series faults, giving a natural extension to network equivalents 
and its properties.
Chapter 10 discusses contingency cases, mainly one element out at a time, start-
ing from a base case. The tools are similar to the ones used in Chapter 9, as network 
equivalents also play an important role in the simulation of lines/transformers out of 
service and need to be disconnected from the network to simulate the contingency. 
Outages of generators or load disconnection are nodal changes and through sensi-
tivity factors the impact can be calculated on nodal angles or voltage magnitudes, 
as well as the changes in power flows in the network.
Finally, Chapter 11 focuses on state estimation and presents its conceptual link to 
minimum squares estimation when measurements are available, including different 

xvi
Preface
quality of measurements, and the best statistical state is calculated. These concepts 
are related to network quantities and measurements that can be nodal voltages, nodal 
magnitudes, power injections, or real and reactive power flow through transmis-
sion elements. We stress the need to identify a measurement matrix that relates the 
measured quantity to the state variables, first through linear models and solved by 
the least squares principle, then including nonlinear relations between measure-
ments and state variables. Redundancy as having more measurements than state 
variables to be determined is key in the process, as some measurements might have 
gross errors and a step of goodness of fit must be carried out so that spurious mea-
surements are rejected. State estimation is important for monitoring and controlling 
the modern power system. The process of parameter estimation can be established 
from the principles described in the least squares approach. Natural extensions in 
the estimation process are phasor measurements that go into phasor measurement 
units (PMU), and the concept of wide area measurements that will enhance the 
monitoring, operation, and control of present and future electric power systems.
As the reader can see, the focus is mainly on the steady state of AC and DC 
networks because the knowledge of state variables is important in its own right, to 
completely determine the value of derived variables as currents, real and reactive 
power flows through each element, and losses or the reactive power requirements. 
This book is dedicated to slightly advanced students with a background in basic 
circuits, how to solve a system of linear equations, root finding of nonlinear equa-
tions, and the main principles of electric energy conversion. Senior students will 
benefit from a different approach in building original material, and will learn how 
fundamental concepts can be put to use in order to generalize the study of electric 
power networks. Practicing engineers will find a source of reference to refresh mate-
rial covered in a different order and often through a piecemeal approach, leaving 
sometimes disconnected fundamental concepts from the system’s point of view.
We must recognize that, due to continuously changing conditions in the power 
network from load requirements, generation supply, or contingencies, there will 
be a dynamic behavior in state variables (such as voltage magnitures and nodal 
angles). Consequently, currents and power changes redistribute the energy until all 
unbalances are settled (unless the system goes into an unstable condition). Under a 
dynamic situation, electric elements (such as inductors, capacitors, and the genera-
tor’s inertia) come to interact. Dynamic modeling and solution require a separate 
treatment to incorporate the time energy exchange between the generator’s inertia, its 
controls actions, and the electric network. In general, we will need machine dynam-
ics and controls by differential equations and low frequency exchanges through the 
network, which can be characterized by algebraic equations. Future work can cover 
this aspect building from the foundations put forth this volume.

1
C h a p t e r  1
Fundamentals of Energy Systems
1.1	
Introduction
All human activities rely on some form of energy resource: thermal, mechanical, 
chemical, and, in some countries, nuclear. Accordingly, progress and development 
in a country is measured directly by its energy use in transportation, electricity 
production and agriculture, manufacturing, health services, and banking, as well 
as in recreational chores. Due to the industrial revolution, the last two hundred 
years of human history recounts an exponential growth in energy consumption per 
capita. New developments in technologies and efficient energy use are envisioned 
to continue exploiting fossil fuels, as well as heavily investing in renewable energy 
sources, such as solar (which has its origins within the atomic furnace in our near-
est star, the sun, the main source of energy for our planet).
Huge amounts of energy are required nowadays in the world. We estimate the 
quantity used through the average energy utilized in various regions of the world; 
the numbers are summarized in Figure 1.1. If we add in the growing world popu-
lation, we can estimate the energy required on a global scale for each region some 
years into the near future. Figure 1.2 gives a glimpse of the mixture of energy types 
that were used circa 2000, as new statistics are available the percentages can be 
updated. The energy mix might change for different countries, but this can give 
us a sense about the type of primary energy sources. Table 1.3 shows how actual 
energy requirements are supplied and how they were used by the year 2000, in 
particular in the case of the United States. This proportion is expected to be modi-
fied since renewables, such as solar and wind, are being used more and more even 
as we write this chapter. Active research and development has come to fruition for 
wind harnessing as electric power generation and solar capture is also a promis-
ing proportion of the total world energy requirements in the near future. Other 
sources sometimes experience a halt, as is the case for nuclear after the Japanese 
disaster in Fukushima in March 2011. The portion of fossil fuel for electric energy 
supply—with respect to renewable resources—is high and will be changing in the 
near future when we incorporate larger portions of renewables, coupled with effi-
ciency in usage, reduction in losses, and an “intelligent” use of energy. Other small 
generating plants are emerging in small-scale production. They are connected at 
the distribution level, but in increased proportion, and are known as dispersed 
generation appearing throughout the urban and rural distribution networks. This 
is having a large impact on the generation available in the system and a change in 
the way that traditional systems are planned, operated, controlled, and protected.

2
Fundamentals of Energy Systems
The three main sources of primary energy are oil, gas, and coal (Figure 1.2). 
These fuels experience very high price fluctuations over time, depending on produc-
tion booms and shortages. This translates to uncertainty in both the cost operation 
of an actual energy system and plans for future system operations. Other energy 
resources, such as hydro, geothermal, and wind, are, in a theoretical sense, considered 
costless fuels, but also there is a high degree of uncertainty to their availability due 
to seasonal conditions. When the alternative energy sources are interconnected to 
a thermal system, a coordinated economic study should be done in order to satisfy 
the criteria of system operation at minimum cost, or some other optimal criteria 
that is suitable for operation or for planning. The result is a coordinated energy 
Table 1.1  Yearly Average of Energy Use Per Capita, GJ/yr [1]
Year
North  
America
Europe
Former  
USSR
Rest of  
World
Global
1975
260
120
160
22
60
1980
265
135
175
24
62
1985
250
132
196
26
61
1990
263
135
205
28
63
1995
263
131
140
33
62
2000
272
136
135
35
62
Average
262.2
131.5
168.5
28.0
61.7
Figure 1.1  Average use of energy per capita, GJ/yr.

1.1	
Introduction
3
study where we will need to find the minimum of the cost function subjected to 
physical system’s constraints.
The electricity flow during 2011 in the United States was 40.03 quadrillions 
BTU [1] (quadrillion BTU = 1.05505585 × 1018 joules), and a possible breakdown 
can be as is shown in Table 1.3.
Table 1.2  Energy From Type of Source, in Percentage [1]
Oil
Coal
Natural gas
Nuclear
Large hydro
Other renewables
Biomass
32.6
22.2
21.1
5.7
5.5
2.3
10.6
Figure 1.2  Percentage of energy according to type of source.
Table 1.3  Energy Consumption USA, 2011
Electric Energy by Type of Fuel
Percentage
Fossil fuels (coal, natural gas,  
petroleum, other)
66.13
Nuclear and renewables
33.87
Conventional thermal (Fossil fuels and other like nuclear)
Losses
63.00
Gross generation of electricity
37.00
NOTE: Except for combined cycle schemes where efficiency can go up to 64%
Electric Power by Power Plant
Power plant own use
5.47
Net generated power (into the power 
network)
94.53

4
Fundamentals of Energy Systems
For a final balance, we add unaccounted energy and imports to the net use of 
electricity in the United States (as reported in 2011) through the following numerals:
Transmission and distribution losses	
7.32%
Residential use	 	
34.23%
Commercial use	
31.69%
Industrial applications	
23.45%
Transportation	
0.21%
Direct use	
3.10%
Total	
	
100.00%
The 40.03 quadrillions of BTU account for an average of 121 GJ/yr per capita. 
To this average, we must add the use of gasoline, as well as some other energy forms; 
then we will find the average listed in Figure 1.1 the amount is 262.3 GJ/yr for North 
America. We should keep in mind various figures; one relates efficiency for the con-
version process from raw energy to the electric form. Power plants that work under 
a combined cycle scheme make a better use of the heat within the process, giving a 
higher efficiency for whole energy conversion. Electric power plants require energy 
to service their own motor pumps, fans, lighting, and other services—this might 
amount to 3% to 4%. The amount of losses in transmission and distribution lines 
present opportunities to improve the process, and it might have quite an impact 
in economic and environmental terms, as well as less amounts of required energy 
from the primary sources.
1.2	
Work and Energy in Electric Circuits
We are interested in the energy usage, so let us start with a simple electric circuit 
as a means to ship energy from an electric source to a consumer; some useful pur-
pose will be accomplished with this arrangement. Energy is required in order to 
attain motor rotation and then to move a production chain production, lighting 
loads for illuminating purposes, heating, electric vehicles, and a wide range of 
industrial applications.
1.2.1	 Power and Energy in Constant DC Systems
Even though most generation, transmission, and distribution is done in AC, for a 
straightforward explanation purposes (and in order to better grasp the basic con-
cepts), it is interesting to begin with an ideal DC source with a fixed voltage Vs 
(volts) and a supply current I (amperes), as shown in Figure 1.3. The simple con-
figuration has most of the concepts that we will find in more elaborate AC circuits 
as: a nonlinearity relation when power load is established, multiple solutions, and 
maximum power transfer and voltage stability margin. At any instant of time, we 
have a product of voltage and current, the product is the instantaneous power p 
in watts that the load requires from the source. If this condition lasts for a time Δt 
(seconds), the supplied energy in joules will be determined.

1.2	
Work and Energy in Electric Circuits
5
Power and energy supplied by a constant DC voltage source is:
	
PS = VSI  Watts 	
(1.1)
	
WS = PSΔt  Joules (W-sec)	
(1.2)
Power at the load RL is the power supplied by the source minus transmission 
losses RTI2.
	
PL = VLI = VS −RTI
(
)I = VSI −RTI2  Watts 	
(1.3)
	
PLOSS = RTI2  Watts 	
(1.4)
Energy at the load:
	
WL = PSΔt −PLOSSΔt  Joules 	
(1.5)
Example 1.1
For the circuit in Figure 1.3 with Vs = 120 V, RT = 1 Ω, RL = 19 Ω. Calculate current 
I, the voltage at the receiving end VL, the power supplied by source S, the power 
received by the load, and the power loss in RT. Calculate the energy balance when 
the load RL is fed for a period of Δt = 2 seconds.
Voltage source Vs = 120.0000
RT =    1.0000 Ohms   RL =   19.0000 Ohms
I  =    6.0000 A      VL =  114.0000 V
Ps =  720.0000 W      PL = 684.0000 W     Ploss =  36.0000 W
Ws = 1440.0000 J      WL = 1368.0000 J    Wloss =  72.0000 J
The current I, the load voltage VL, the power PS supplied by the source, power 
at the load PL and power losses PLOSS depend on the load resistance RL. By changing 
the load resistance, we observe a nonlinear characteristic for the variables involved, 
as shown in Figure 1.4. The question about the maximum power transfer from 
the source to the load comes to mind; we will postpone this discussion about this 
important concept, which has important applications for the real power transfer 
problem, to Chapter 6.
Figure 1.3  Simple DC circuit to illustrate electric power and energy concepts.

6
Fundamentals of Energy Systems
1.2.2	 Power and Energy in AC Circuits
For alternating current (AC) circuits, we assume that the voltage and the current 
are perfect sinusoids defined by peak values Vm (volts) and Im (amperes), a unique 
frequency f (Hz), and time t in seconds.
	
v(t) = Vm cos 2pf t + qV
(
)  Volts 	
(1.6)
	
i(t) = Im cos 2pf t + qI
(
)  Amperes 	
(1.7)
A time varying complex number ˆV  can be defined as in (1.8) for a sinusoidal voltage 
and called complexor. The real part of the complexor is the cosine time function (1.6).
	
ˆV = Vmej 2pft+qV
(
)  Volts 	
(1.8)
For voltage v(t) and current i(t):
	
v(t) = real Vmej 2pft+qV
(
)
(
)  Volts 	
(1.9)
Figure 1.4  Plots for current, voltage at load, power by source, and losses.

1.2	
Work and Energy in Electric Circuits
7
	
i(t) = real Imej 2pft+qI
(
)
(
)  Amperes 	
(1.10)
From a voltage complexor, the rms voltage phasor is that part of the complexor 
that does not depend on time t, divided by 
2. The same definition is applied for 
the rms current phasor.
	
!V = Vm
2 ejqV = V ∠qV   Volts 	
(1.11)
	
!I = Im
2 ejqI = I ∠qI   Amperes 	
(1.12)
⎪V⎪	 Magnitude of rms voltage phasor, in volts
⎪I⎪	 Magnitude of rms current phasor, in amperes
Example 1.2
A voltage complexor ˆV  with Vm = 180 volts, θv = 0° = 0 rad, f = 60 Hz is a com-
plex number that rotates counterclockwise; it has a magnitude of 180 volts. For a 
sampling rate of twelve samples per cycle, the rotating complexor and its real and 
imaginary components are shown in Figure 1.5.
	
ˆV = 180ej(2p60t+0) = Vx + jVy = 180cos(2p60t) + j180sin(2p60t) 	 (1.13)
Figure 1.5 shows the 60 Hz complexor for 12 different instants of time for: 
t0 = 0, t1 = 1/720, t2 = 2/720, t3 = 3/720, … in seconds, horizontal Vx, and vertical 
Vy projections versus time, so that a sinusoidal representation is attained.
1.2.2.1	
Phasors
RMS phasor is a tool that is used to solve AC steady state problems for electric 
circuits in single-phase or three-phase configurations. We start our discussion with 
a simple one phase system configuration by the use of Ohm’s law; we relate volt-
age at terminals and current that flows through a resistor R in ohms, an inductor 
L in henries, and a capacitor C in farads. We can extend the concepts into three-
phase configurations, which are used in power system generation, transmission, 
and distribution.
Resistor R (ohms) can be seen as a constant of proportionality between voltage 
(volts) at terminals and current (amperes) that flows through the resistive element; 
the time equation is:
	
v(t) = Ri(t)	
(1.14)

8
Fundamentals of Energy Systems
For a sinusoidal voltage, frequency ω = 2πf in rad/sec, (1.14) is:
	
v(t) = real Vmej wt+qV
(
)
(
) = R real Imej wt+qI
(
)
(
)	
(1.15)
The complexor notation for (1.15) or the phasor notation for Ohm’s Law is as 
follows in (1.16) and (1.17), respectively (Figures 1.6 and 1.7).
	
ˆV = Vmej wt+qV
(
) = RImej wt+qI
(
) = R ˆI 	
(1.16)
	
−R!I + !V = 0	
(1.17)
Figure 1.5  Rotating complexor, Vx, and Vy projections.
Figure 1.6  Voltage and current through resistance R.

1.2	
Work and Energy in Electric Circuits
9
RMS phasors !V  and !I  are defined by (1.11) and (1.12), resistance R is a real 
number then in (1.18) θV − θI = 0, so current i(t) through a resistance is in phase 
with v(t).
	
R =
!V
!I = VmejqV / 2
ImejqI / 2 =
Vm
Imej qV −qI
(
) 	
(1.18)
In a linear magnetic circuit the inductor L is a constant of proportionality 
between flux linkages λ (Wb-turns) and the current (amperes) that flows through 
the inductor. By Faraday’s law the time equation can be written as
	
vL(t) = LdiL(t)
dt
	
(1.19)
Assuming a sinusoidal current through the inductor, iL(t) = Im cos wt + qI
(
) :
	
diL(t)/dt = −wIm sin wt + qI
(
) = wIm cos wt + qI + p/2
(
) 	
(1.20)
We write the voltage equation for the inductor using complexor notation (1.21), 
or using rms phasors as in (1.22). Note that the phasor current !IL  lags by 90° the 
phasor voltage !VL . Ohm’s Law is written as in (1.23) and shown in Figures 1.8 
and 1.9.
	
ˆVL = Vmej wt+qV
(
) = LwImej wt+qI +p /2
(
) 	
(1.21)
	
!VL =
Vm
2ejqV =
LwIm
2ej qI +p /2
(
) = jwL!IL 	
(1.22)
	
−jwL!IL + !VL = 0 	
(1.23)
Figure 1.7  Voltage and current phasors in resistance R.
Figure 1.8  Voltage and current through inductance L.

10
Fundamentals of Energy Systems
A definition is made for the inductive reactance as XL = ωL in ohms.
The capacitor C (shown in Figure 1.10), given a linear electric field, is a con-
stant of proportionality between the amount of electric charge q (coulombs), q = 
CvC, which is accumulated at the device when voltage vC (in volts) is applied at its 
terminals. The time equation is:
	
iC(t) = CdvC(t)
dt
	
(1.24)
Figure 1.10  Voltage and current through capacitance C.
Assuming a sinusoidal voltage applied at capacitor terminals as VC(t) = Vmcos 
(ωt + θy):
	
dvC(t)
dt
= −wVm sin wt + qV
(
) = wVm cos wt + qV + p
2
⎛
⎝⎜
⎞
⎠⎟	
(1.25)
The current through the capacitor in complexor notation (1.26), or in rms pha-
sors as in (1.27), then Ohm’s law is written as in (1.28).
	
ˆIC = Imej wt+qI
(
) = CwVmej wt+qV +p /2
(
) 	
(1.26)
	
!IC =
Im
2ejqI =
CwVm
2ej qV +p /2
(
) = jwC !VC 	
(1.27)
	
−!IC /jwC + !VC = 0 	
(1.28)
In (1.27) and Figure 1.11, we see that the rms phasor voltage !VC  lags by 90° 
the rms phasor current !IC ; or the current leads the voltage by 90°.
Figure 1.9  Phasor model for inductance L, relation between voltage and current.

1.2	
Work and Energy in Electric Circuits
11
Example 1.3
A circuit in Figure 1.12 has a voltage source vs(t) = Vmcos(2πft + θV), f = 60 Hz, 
Rs = 2 ohms, XL = ωL = 12 ohms, 1/ωC = 2 ohms. Solve for current i(t) = Imcos(2πft 
+ θI) using Vm = 180 volts and θV = 0 as a reference. Plot the current and the voltage 
at nodes 1, 2, and 3 as labeled in Figure 1.13.
Even for simple circuit arrangements, it is convenient to use rms phasors in order 
to solve for current and voltages phasors and time signals (as shown in Figure 1.14).
1.2.3	 Instantaneous Power p(t​), Real Power P and Reactive Power Q
For a voltage v(t) and current i(t), in volts and amperes respectively, the product will 
be an instantaneous power p(t) in volts-ampere (VA) that is supplied to a load. A 
detailed analysis of instantaneous power p(t) shows imbedded the concept of real 
Figure 1.11  Phasor representation for capacitance C, relation between voltage and current.
Figure 1.12  Voltages and current through series R, L C circuit.
Figure 1.13  Voltages and current rms phasors through R, L C series circuit.

12
Fundamentals of Energy Systems
Figure 1.14  Nodal voltages at 1, 2 and 3 and current phasors. Sinusoidal current waves (x5).
power P in watts and the reactive power Q in VARs. For sinusoidal voltage and 
current, the rms phasors will be used to calculate P and Q.
	
p(t) = v(t)i(t) = Vm cos(wt)Im cos(wt + q) 	
(1.29)
	
p(t) = Vm
2
Im
2 cos(2wt + q) + cos(q)
[
] 	
(1.30)
	
p(t) = P cos(2wt) + 1
[
] + Qsin(2wt)	
(1.31)
The definition for P and Q are part of (1.30) using cosθ  and sinθ. Equation 
(1.35) shows P and Q as those components of a Fourier series expansion for the 
instantaneous power p(t). P is an average or mean value of p(t) and Q is a peak 
value of a component of p(t) whose mean value is zero; throughout this explanation 
voltage is our angular reference.
	
P = V I cos(q)	
(1.32)
	
Q = −V I sin(q) 	
(1.33)
	
pf = cos(q) 	
(1.34)

1.2	
Work and Energy in Electric Circuits
13
	
p(t) = P + Pcos(2wt) + Qsin(2wt) 	
(1.35)
1.2.4	 Load Convention for Power Flows
It is convenient to work an expression so that our P and Q results are consistent 
with a load convention (see Figure 1.15) as a preferred reference for power flows. 
The voltage phasor is our reference and current might be in phase, lagging, or lead-
ing the voltage. For power flows, a convenient representation is to picture a load 
with required values of real power P and reactive power Q. If P and Q are positive, 
this means that they have the same direction as the current feeding the load, the 
load requires Q due to its inductive nature and current lags the voltage by an angle 
θ. For the load connection, a negative Q goes opposite to the current direction, 
meaning that the load is capacitive and that current leads the voltage by a θ angle. 
A negative sign for P (coming from a current reversal) will mean that instead of a 
load we are dealing with a source.
The cosine of the phase angle ±θ is positive, the displacement power factor (pf), 
which is a term that is part of the expression to calculate the real power P (1.32). Once 
we know that the power factor is lagging (−θ) then in (1.33) Q = −⎪V⎪⎪I⎪sin(−θ) > 0. 
For a leading power factor (+θ), then Q = −⎪V⎪⎪I⎪sin(θ) < 0, which corresponds to 
the load convention just discussed in the last paragraph.
To analyze the voltage and current phasors, we can use the phasor complex plane, 
and to work with power relations, we can use the complex power plane, wherein S, 
P, and Q can be drawn. With the phasor !V  as reference, pf = cos(θV − θI).
In summary, for P and Q using the load convention:
• P: Real power is positive and has the same direction as the current going into 
the load; see Figure 1.16.
• Q: Reactive power is positive, same direction as the current that flows to the 
load, for inductive load (lagging power factor). Reactive power is negative, 
opposite to the current direction for a capacitive load (leading power factor).
As can be deduced from Figure 1.16, the complex power calculation is the prod-
uct of rms phasors: voltage V and the conjugate of current I.
	
S = P + jQ = !V!I∗	
(1.36)
Example 1.4
Calculate for the circuit in Example 1.3, the complex power in VA supplied by 
the source to node 1, the complex power sent from node 2 to 3, and the power at 
Figure 1.15  Load convention as a reference for power flows.

14
Fundamentals of Energy Systems
node 3. Power P in watts, Q in VARs and angle in degrees. The results are shown 
in Figure 1.17.
Complex voltages                  abs        angle
V1    =  127.279     +0.000j    +127.279     +0.00
V2    =  122.384    +24.477j    +124.808    +11.31
V3    =  146.861    +29.372j    +149.769    +11.31
Current                           abs       angle
I12   =    2.448    -12.238j     +12.481    -78.69
Complex power p+jq                abs        angle
S12   =  311.538  +1557.692j   +1588.541    +78.69
S21   =    0.000  -1557.692j   +1557.692    -90.00
S23   =    0.000  +1557.692j   +1557.692    +90.00
S32   =   -0.000  -1869.231j   +1869.231    -90.00
S30   =    0.000  +1869.231j   +1869.231    +90.00
Losses and reactive power
Plosses   =  311.538
Reactive power (>0 to the system)
Qtot      = 1557.692
Figure 1.16  Voltage and current phasors. Power triangles show voltage and lagging and leading 
currents.

1.2	
Work and Energy in Electric Circuits
15
Example 1.5
Using voltage and current phasor values and a displaced angle for the current with 
respect to the voltage, find the voltage, current and instantaneous power. From 
(1.36) plot the instantaneous power p (t) and the two components P + Pcos(2ωt) 
and Qsin(2ωt) that make possible to identify P and Q. Vm = 180 volts, Im = 12.5 
amperes, first for a lagging power factor 0.9 (as shown in Figure 1.18) and then 
for a leading power factor of 0.9. Power results are shown in Figures 1.19–1.21.
Figure 1.17  Voltages and power flows in Watts and VARs.
Figure 1.18  Vm = 180 volts, Im = 12.5 amperes, power factor = 0.9 (lagging), θ = −25.84°.

16
Fundamentals of Energy Systems
Note: for lagging condition θ < 0 and for leading condition θ > 0.
RMS Voltage and current phasors
magnitude angle
V = 127.279 +j 0.000 127.279 0.00
I = 7.955 +j -3.853 8.839 -25.84
Power factor = 0.9000 (lagging)
Real Power = +1012.50 W
Reactive Power = +490.38 VARs
Voltage and current phasors, v(t) and i(t), instantaneous power p(t) and two 
components of the instantaneous power.
For the leading power factor condition:
RMS Voltage and current phasors
                                 magnitude    angle
V    =  127.279 +j   0.000        127.279      0.00 
I    =    7.955 +j  -3.853          8.839    -25.84 
Power factor   = 0.9000 (lagging)
Real Power     = +1012.50  W
Reactive Power =  +490.38  VARs
Voltage and current phasors, v(t) and i(t), instantaneous power p(t) and two 
components of the instantaneous power.
Figures 1.18 and 1.21 show the fundamental concept of power factor, related 
to the angle phase shift for the current i(t) respect to the voltage v(t); this has 
consequences on the value of P and Q. An ideal situation would be to have an 
Figure 1.19  Voltage, current and power flows; lagging power factor.
Figure 1.20  Voltage, current, and power flows; leading power factor.

1.2	
Work and Energy in Electric Circuits
17
in-phase current to voltage, so that reactive power Q would be zero. In order to 
modify the power factor in a lagging or leading situation, current has to be “dis-
placed” to be more closely in phase with the voltage. Such is the nature of reactive 
power compensation.
Example 1.6
The lagging or leading power factor will have an impact on both the nodal voltages 
and the power system losses. To motivate the attention for this kind of relations let 
us use a three node system (Figure 1.22(a)) where all values are normalized so that 
voltage and power are 1 pu (per unit (pu) values are defined later), and analyze the 
consequences of a change in the power factor at node 3. Pay attention to the voltage 
magnitude at node 3 and system losses as a function of the power factor at node 3 
(for printout assume lagging is − and leading is +). We will study in detail this type 
of system behavior in Chapter 6 through the use of load flow studies. Table 1.4 
summarizes the network solution as pf changes from lagging to leading condition.
Note from Figure 1.22(b) that minimum losses are attained when the power 
factor is 1.0, current in phase with the applied voltage at the load point, node 3. 
Losses and nodal voltages change as the power factor has a lagging or leading con-
dition; losses increase under both conditions and node voltage drops from the 1.0 
Figure 1.21  Vm = 180 volts, Im = 12.5 amperes, power factor = 0.9 (leading), θ = 25.84°.

18
Fundamentals of Energy Systems
Table 1.4  Power Factor at Node 3, Reactive Power Q3, Voltage 3, and System Losses
pf
Q3
V3
Losses
−0.850
0.6817
0.9139
0.0268
−0.875
0.6086
0.9232
0.0249
−0.900
0.5328
0.9328
0.0233
−0.925
0.4519
0.9427
0.0219
−0.950
0.3616
0.9535
0.0206
−0.975
0.2507
0.9664
0.0195
1.000
0.0000
0.9943
0.0188
0.975
−0.2507
1.0207
0.0202
0.950
−0.3616
1.0319
0.0214
0.925
−0.4519
1.0409
0.0226
0.900
−0.5328
1.0488
0.0238
0.875
−0.6086
1.0562
0.0251
0.850
−0.6817
1.0631
0.0265
pu value when power factor is lagging. The node voltage increases from the 1.0 pu 
value for the leading power factor values.
1.3	
Three-Phase Voltages, Currents and Power
Power system engineers use AC circuits in three-phase arrangements to carry power 
more efficiently from the generation sites to the demand locations. Load centers are 
usually located far from the generation plants, so in order to have reasonable trans-
mission losses, step up voltage transformers and high voltage transmission lines are 
used. Once at the premises of consumers or very close to their location, step down 
transformers will lower the voltage to distribute energy to individual loads at an 
appropriately safe voltage level.
To have a glimpse of a three-phase circuit arrangement—even though it is a 
simplified scheme—we can visualize it through Figure 1.23; an ideal three-phase 
generator as a voltage source arrangement of a three balanced complexors a, b, and 
c, each one separated by 120 degrees and with the same magnitude. Every single 
voltage source a, b, and c is connected to the low voltage phases abc of the step-up 
transformer and ground. The high voltage side of the transformer feeds current into 
a transmission line, and then at the right side, we reach a step down transformer 
(not shown). From here, we feed the three-phase loads. The circuit needs to be 
solved for all node voltages and currents; the principles that we use are Ohm’s law 
and Kirchhoff’s current law.
	
ˆVa = Vmej 2p60t+0
(
)
ˆVb = Vmej 2p60t−2p /3
(
)
ˆVb = Vmej 2p60t−2p /3
(
)
	
(1.37)

1.3	
Three-Phase Voltages, Currents and Power
19
Figure 1.22  Effect of power factor changes on voltage at node 3 and losses; values in per unit.
Figure 1.23  Voltages, current and power flows for a three-phase circuit.

20
Fundamentals of Energy Systems
We assume the use of RMS phasors as phase voltages at the generator side. An 
ideal step up transformer with tap ⎪t⎪ applies high voltage values to the sending 
end of a transmission line, which, in turn, feeds current to the load at each phase 
at the receiving side. With the main goal of writing current and voltage relations 
in the three-phase circuit, we use voltages from node to reference or nodal voltages 
and currents injected to each node. The voltage drops and currents flowing in the 
windings of the ideal (lossless) transformer, the low voltage side in terms of source 
voltages, as in Figure 1.24, are (1.38). These voltages are transformed by the ratio 
1:⎪t⎪ into voltage values at the high voltage side (1.39). The connection shown 
for the primary side of the transformer (the left-hand side) is known as a delta Δ 
configuration, and the high voltage side is in a Y connection; the turns ratio will 
bust or buck the primary and secondary voltages and currents. The Y Δ connec-
tion will shift voltages and currents from the primary to secondary side. Voltages 
at the receiving end of the line are the voltages at the three-phase node named II, 
including the voltage drop across the transmission impedances when current flows 
at each phase. Equation (1.40) is Ohm’s law for a three-phase element.
The voltage drop vk across elements can be expressed in terms of nodal voltages, 
where nodal voltages are voltages from phase to reference (1.38). Voltages from 
primary side to secondary side in the transformer are affected by the transformer 
ratio, tk as in (1.39). Ohm’s law for the three-phase connection that goes from node 
II to node III is written in (1.40).
	
v1
v3
v5
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
+1 −1
0
0
+1 −1
−1
0
+1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Va
Vb
Vc
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
(I)
	
(1.38)
	
VA
VB
VC
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
(II)
=
v2
v4
v6
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
t1
0
0
0 t2
0
0
0 t3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
v1
v3
v5
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(1.39)
	
−
zaa zab zac
zba zbb zbc
zca
zcb
zcc
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
iA
iB
iC
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
(II,III)
+
VA
VB
VC
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
(II)
−
VA
VB
VC
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
(III)
=
0
0
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	
(1.40)
Kirchhoff’s current law, in Figure 1.23, include current summation at nodes (II) 
and (III), so we get a set of nodal current equations, assuming that the currents going 
into a node are positive. Equations (1.40) and (1.41) are our circuit models where 
U is a 3 × 3 unit matrix. The three-phase model for our circuit combines (1.40) 
and (1.41) into (1.42). Solution to the system of equations means calculating nodal 
voltages and currents that flow through each element. This will allow us to find 
the Norton equivalent for the Nodal admittance matrix [1, 2], and if we continue 
the numerical process through Gaussian elimination along the main diagonal, we 

1.3	
Three-Phase Voltages, Currents and Power
21
will be able to calculate all three-phase nodal voltages and solve for all unknown 
three-phase currents [3–5].
	
+iABC
II,III = IABC
II
−iABC
II,III = iABC
III,II = IABC
III 	
(1.41)
	
−Zabc +U −U
+U
0
0
−U
0
0
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
iABC
II,III
VABC
II
VABC
III
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
0
IABC
II
IABC
III
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(1.42)
Example 1.7
For the three-phase arrangement in Figures 1.23 and 1.24—using voltage in Volts, 
current in amperes, impedance in ohms, and a tap value t = 20/√3—a voltage of 
20 kV is applied at the delta side of the step-up ideal transformer; 400 kV will be 
the voltage at the sending end for the transmission element. With known values for 
ABC voltages at node II and load currents at ABC node III, a network solution is 
attained for (1.42), using Zabc impedance values in ohms for the transmission ele-
ment. In this case, no resistance is considered. Therefore, there will be no power 
losses at the transmission line. Nodal currents are calculated using (1.41) and com-
plex power can be calculated using (1.36).
Figure 1.24  Voltages and currents, ideal no-loss transformer, ΔY connection.

22
Fundamentals of Energy Systems
Voltages Source (Y connection)
Magnitude kV     angle
  +11.55         +0.00
  +11.55       -120.00
  +11.55       +120.00
Voltages low side transformer (DELTA)
Magnitude kV     angle
  +20.00        +30.00
  +20.00        -90.00
  +20.00       +150.00
Voltages high side transformer (Y connection)
Magnitude kV     angle
 +230.94        +30.00
 +230.94        -90.00
 +230.94       +150.00
zabc =
        0 +23.0000i        0 - 2.0000i        0 - 2.0000i
        0 - 2.0000i        0 +23.0000i        0 - 2.0000i
        0 - 2.0000i        0 - 2.0000i        0 +23.0000i
Load current
Magnitude A     angle
   +441.59      +18.69
   +441.59     -101.31
   +441.59     +138.69
Voltages at load node (Y)
Magnitude kV     angle
 +229.03        +27.29
 +229.03        -92.71
 +229.03       +147.29
Phase currents high side transformer (Y)
Magnitude A     angle
   +441.59      +18.69
   +441.59     -101.31
   +441.59     +138.69
Phase currents, low side transformer (DELTA)
Magnitude A     angle
  +5099.02      +18.69
  +5099.02     -101.31
  +5099.02     +138.69
Phase currents, generators phases (Y)
Magnitude A     angle
  +8831.76      -11.31
  +8831.76     -131.31
  +8831.76     +108.69
Power at load
Power MW      MVARs
 +100.00      +15.12

Appendix 1A Complex Numbers
23
 +100.00      +15.13
 +100.00      +15.12
Power into transmission element
Power MW      MVARs
 +100.00      +20.00
 +100.00      +20.00
 +100.00      +20.00
Power from generator
Power MW      MVARs
 +100.00      +20.00
 +100.00      +20.00
 +100.00      +20.00
Power required by the transmission element
Power MW      MVARs
   -0.00       +4.88
   -0.00       +4.88
   +0.00       +4.88
To find current values, from the Δ connection to the phase values at the genera-
tor side (Figure 1.24) we go from the transformer’s currents to the current at each 
phase of the generator.
	
Ia
Ib
Ic
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
I
=
+1
0
−1
−1 +1
0
0
−1 +1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
i1
i3
i5
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(1.43)
Notice the 30° phase shift due to the ΔY connection of the three-phase bank 
transformer [5–7]. Resistance values were assumed to be very small when compared 
to reactance values, and so they were neglected. However, the calculating tool—once 
we establish the sequence of calculations—should easily handle complex numbers 
in its calculations.
Appendix 1A Complex Numbers
For electrical power engineers, the complex number tool is basic and widely used. 
The concept of complexor, as in (1.8), is an example of a complex number; it has 
magnitude and rotates at angular speed ω in rad/sec.
It is a historic matter that, in order to find a number that is the square root of 
−1, the real number line representation has to be extended. Real numbers can be 
associated to points in a horizontal straight line. By a 90° rotation, the real line 
has an orthogonal display; to emphasize the rotation a j symbol is associated, we 
end up with a Cartesian-like plane that has a real and an imaginary axis; the plane 
is called a complex plane (see Figure 1.25). A complex number z has a real x and 
an imaginary y component, and it can therefore be located in the complex plane.

24
Fundamentals of Energy Systems
Example 1.8
Powers of j imaginary unit
	
1 = ej0
j = ejp /2 = cos(p/2) + jsin(p/2)
j2 = ejp /2
(
)
2 = ejp = cos(p) + jsin(p) = −1;
j =
−1
j3 = −j
j4 = 1
The algebra of complex numbers can be illustrated assuming two complex 
numbers, z1 and z2. They can be added, subtracted, multiplied, or divided in a 
rectangular or polar form. Conjugate in Figure 1.26.
	
z1 = x1 + jy1 = z1 ejq1 = z1 ∠q1
z1 =
x1
2 + y1
2
q1 = arctg y1
x1
⎛
⎝⎜
⎞
⎠⎟
z2 = x2 + jy2 = z2 ejq2 = z2 ∠q2
	
(1.44)
Figure 1.25  Complex plane. We visualize 90° successive rotation for number 1.
Figure 1.26  Complex number z and conjugate z∗ in the complex plane.

Appendix 1A Complex Numbers
25
	
z1 + z2 = x1 + x2
(
) + j y1 + y2
(
)
z1 −z2 = x1 −x2
(
) + j y1 −y2
(
)
z1z2 = x1 + jy1
(
) x2 + jy2
(
) = z1 ejq1 z2 ejq2 = z1 z2 ej q1+q2
(
)
z1
z2
=
x1 + jy1
(
)
x2 + jy2
(
)
= z1 ejq1
z2 ejq2 = z1
z2
ej q1−q2
(
)
	
(1.45)
Example 1.9
For two complex numbers, z1 = 4 + 3j and z2 = 3 + 4j find z1 + z2, z1 − z2, z1z2, 
and z1/z2.
Complex numbers                  abs     angle degrees
z1   =    4.000 +j   3.000      5.000     36.87
z2   =    3.000 +j   4.000      5.000     53.13
Algebra of Complex numbers       abs     angle degrees
zsum =    7.000 +j   7.000      9.899     45.00
zdif =    1.000 +j  -1.000      1.414    -45.00
zpro =    0.000 +j  25.000     25.000     90.00
zdiv =    0.960 +j  -0.280      1.000    -16.26
References
[1]	
Shipley, R. B., Introduction to Matrices and Power Systems, New York: John Wiley & 
Sons, Inc., 1976.
[2]	
Brown, H. E., Solution of Large Networks by Matrix Methods, Second Edition, New 
York: Wiley-Interscience, 1985.
[3]	
Glover, J. D, M. S. Sarma, and T. Overbye, Power System Analysis and Design, Fifth Edi-
tion, Stamford, CT: Cengage Learning, 2011.
[4]	
Grainger, J. J., Power System Analysis, New York: McGraw-Hill Science/Engineering, 
1994.
[5]	
J. Arrillaga, and C. P. Arnold, Computer Analysis of Power Systems, Chichester, UK: 
Wiley, 1990.
[6]	
Saadat, H., Power System Analysis, Third Edition, Alexandria, VA: PSA Publishing, 2010.
[7]	
Elgerd, O. I, Electric Energy Systems Theory, New York: McGraw-Hill Science/Engineering/ 
Math, 1982.


27
C h a p t e r  2
Network Analysis
The main purpose in this chapter is to explain various circuit properties and use-
ful algebraic results that can be expanded to study large power networks. We start 
from the algebraic manipulation of a system of linear equations to be solved for the 
unknown values. To model and study an electrical power system, which is an intri-
cate ensemble of equipment of various kinds, a high degree of abstraction is required 
in order to represent the electrical power system as a whole. To conduct this task, 
we start by describing the physical electrical system by the use of a reduced set of 
idealized elements with defined properties between variables through them. That 
is, by Ohm’s law we relate the electric current that flows when a voltage difference 
is applied at its terminals. We write a consistent set of equations for the network, 
using Kirchhoff’s current law at each node, and work out a solution for state vari-
ables, which are those electric quantities known as node voltages that allow us to 
calculate currents and voltage drops on all elements in the network.
The analysis of the system enables us to predict its behavior under a range of 
stimuli with practical applications. From a general network model and its numeri-
cal solution, we derive Norton’s equivalent, which is a numerical model that relates 
nodal voltages to nodal currents (those currents injected or extracted from a node by 
sources/loads) through admittance values or short circuit coefficients. The numerical 
process is conducted by Gaussian elimination or its numerical equivalent, partial 
inversion, in a matrix sense [1–3]. If we continue the partial inversion process, we 
eventually get Thévenin’s equivalent. Thévenin’s circuit relates nodal voltages to 
nodal currents through impedance values known as open circuit coefficients. The 
importance of network equivalents is that a large network can be reduced to a small 
equivalent circuit arrangement without losing the effects of connected elements as 
lines, voltage, or current sources. Using equivalent circuits, we can solve for state 
variables with less effort, given that we are only interested in the small portion of 
the original network. The solution to the equivalent can be fed into the complete 
network equations and the effect of the equivalent’s solution can be reflected on 
the whole network. This approach will be used in fault current calculations and 
contingency analysis.
2.1	
Introduction
A basic electrical power circuit is an interconnection of passive and active ele-
ments. Resistors, inductors, and capacitors are passive elements. Other elements 

28
Network Analysis
are designed to convert energy from the primary thermal of mechanical sources to 
electric DC or AC. These current and voltage sources are active components for 
the power system. Other types of sources with nonlinear characteristics that are 
based on power electronics are also active elements; through switching devices, they 
accomplish the useful handling of electric energy for various industrial and large-
scale power applications. The electric elements may be series or shunt connected, 
forming a delta or a star configuration in the case of three-phase AC systems. In 
more elaborated circuits, the voltage and current sources may be of an independent 
or a controlled type.
For passive elements, the voltage at their terminals with respect to the current 
flowing in the resistor, inductor, or capacitor may be through a linear or nonlinear 
relation, depending on the nature of the element. Furthermore, the response can 
vary linearly with frequency or in a nonlinear fashion. Among various system ele-
ments, the ideal transformer with a real or a complex transformer with tap and 
phase shifting angle is a very useful device in order to represent voltage and current 
raises/drops at key sections of the circuit. Depending on the electrical length (with 
respect to the actual size of equipment), its circuit representation may be required 
to be described by distributed parameters or by lumped parameters—the electrical 
length is dictated by the actual physical dimension of the device and the voltage’s 
frequency at which the device is going to work.
Ohm’s law determines the amount of current that flows through a given element 
(R, L, and C), and it depends on the voltage at terminals for a passive element and 
the properties that oppose the current to flow. Kirchhoff’s voltage and current laws 
govern the interaction between the voltages and currents in all passive and active 
elements within a circuit. We can deduce various voltage-current formulations to 
study electric circuits; it all depends on the way in which we apply the fundamental 
laws. Popular outcomes are the nodal equations and the mesh equations, but other 
formulations are possible. When dealing with how to find the solution of practical 
electric power networks—which normally have a very large number of nodes and 
electric elements—the computational effort may be quite high, even for a digital 
computer. This is one of the reasons why we have to carefully plan all computational 
steps in order to keep the numerical burden well under control. It is fortunate that 
most large physical systems (as in the case of electrical power circuits) are loosely 
interconnected in a structural sense; not all electrical nodes are connected through 
elements (transformers, lines, and cables). This characteristic makes the system’s 
equations sparse and prone to an efficient numerical solution. When we recognize 
that, for high voltage power systems, up to 80% or more of the numerical coef-
ficients in the nodal model have zero values—and that such coefficients should 
neither be stored nor processed—then the nodal model is very compact in storage 
requirements, even for very large power networks. Quite elaborated algorithms 
called sparse techniques will store and process the nonzero essential information. 
The solution of the sparse system of equations is mainly based on carefully thought 
Gaussian elimination and are well-developed; these techniques are surely included 
in all commercial-grade packages that solve electric power networks or for elec-
tronic circuits.

2.2	
Ohm’s Law
29
2.2	
Ohm’s Law
To discuss the essence of Ohm’s law, which is a fundamental concept, let us use an 
ideally controllable DC voltage source that feeds an ideal resistive load; the circuit 
is shown in Figure 2.1(a)). Current i through the load and voltage v across its termi-
nals; we assume that both values can be recorded by an ammeter and a voltmeter, 
respectively. If the voltage applied by the source is increased gradually and the cur-
rent through R is plotted for a range of values (Figure 2.1(b)), the diagram might 
reveal a linear relationship between the applied voltage v and the current response i.
From Figure 2.1(a), a linear relationship is readily established from which the 
slope or gradient is R. The incremental form is in fact Ohm’s law, at any given time 
t it will be true that:
	
−Ri(t) + v(t) = 0 	
(2.1)
The gradient R in ohms is the resistance of the resistive element and acts as 
proportionality constant between the applied voltage and the current as a response. 
In general, the resistance R is connected between nodes k and m, then at any time 
t the equation is (2.2) and the circuit is shown in Figure 2.2:
	
−Rikm(t) + Vk(t) −Vm(t) = 0 	
(2.2)
Figure 2.1  (a) Electric circuit, and (b) voltage-current characteristics for a linear resistor.

30
Network Analysis
Vk and Vm are nodal voltages; R is a linear resistance at time t = tk+1
For a different relation between the applied voltage and the output current (as 
in shown in Figure 2.3), the behavior is not continuously linear. In this case, we 
should apply Ohm’s law in a piece-wise form, as indicated through (2.3).
	
v(t) = R1i(t)
0 ≤v(t) ≤V1
v(t) = R2i(t) V1 ≤v(t) ≤V2
⎧
⎨⎪
⎩⎪
	
(2.3)
For the case of an ideal inductance L in henries, an experiment can be conducted. 
From our background in a physics course on electricity and magnetism, a coil with 
N number of turns shows that the voltage and current i(t) in amperes are related 
through flux linkages λ(t) in Weber-turn. Flux linkages λ relate the magnetic flux 
ϕ (Weber) and the coil’s turns N as:
	
l(t) = Nf(t) = Li(t) 	
(2.4)
By Faraday’s law, the rate of change of flux linkages is the induced voltage v(t) 
in volts at the terminals of the coil, as Δt → 0:
	
v(t) ∝Δl(t)
Δt
→Ldi(t)
dt
	
(2.5)
Figure 2.2  Voltage-current relation in circuit with a linear resistor.
Figure 2.3  Voltage-current characteristics of a piece-wise linear resistor.

2.2	
Ohm’s Law
31
A discrete approximation for (2.5) is applied to the incremental form in (2.6). 
Using the trapezoidal rule of integration, from time tk to tk + 1, as in (2.7) we have 
the discrete model (2.8).
	
v(t)Δt = LΔi(t) 	
(2.6)
	
v(t)dt
k
k+1
∫
=
Ldi(t)
k
k+1
∫
	
(2.7)
	
v tk+1
(
) + v tk
( )
⎡⎣
⎤⎦
Δt
2L
⎛
⎝⎜
⎞
⎠⎟= i tk+1
(
) −i tk
( ) 	
(2.8)
Ohm’s law from (2.8) allows for inductance L to be connected from node k to 
node m and to have a circuit representation in Figure 2.4.
−2L
Δt
⎛
⎝⎜
⎞
⎠⎟ikm tk+1
(
) + Vk tk+1
(
) −Vm tk+1
(
) = −2L
Δt
⎛
⎝⎜
⎞
⎠⎟ikm tk
( ) −v tk
( ) = −ekm tk
( )	
(2.9)
Vk and Vm are nodal voltages, 2L/Δt is an equivalent resistance and ekm is an equiva-
lent voltage source. The voltage source ekm is calculated using voltage and current 
values at the previous time tk.
For a linear capacitor C in farads, the electric charge q(t) coulombs is stored in 
a dielectric between parallel plates. The stored charge is proportional to the poten-
tial difference v(t) in volts applied at capacitor’s terminals. The electric current i(t) 
in amperes that flows is the rate of change of the electric charge dq(t)/dt. We again 
use the trapezoidal rule of integration to the form (2.10). We identify Ohm’s equa-
tion through (2.13) and its equivalent circuit in Figure 2.5.
	
i(t) = dq(t)
dt
= CdvC(t)
dt
	
(2.10)
	
i(t)dt
k
k+1
∫
=
C dvC(t)
k
k+1
∫
	
(2.11)
Figure 2.4  Circuit representation for a linear inductor.

32
Network Analysis
	
i tk+1
(
) + i tk
( )
⎡⎣
⎤⎦
Δt
2C
⎛
⎝⎜
⎞
⎠⎟= vC tk+1
(
) −vC tk
( )	
(2.12)
−imn tk+1
(
) Δt
2C
⎛
⎝⎜
⎞
⎠⎟+ Vm tk+1
(
) −Vn tk+1
(
) = imn tk
( ) Δt
2C
⎛
⎝⎜
⎞
⎠⎟+ vC tk
( ) = emn tk
( ) 	
(2.13)
From previous discussions we conclude that R, L, and C are proportionality con-
stants that relate fundamental circuit variables as voltage v(t) at the element’s ter-
minals and current i(t) flowing through the element.
2.3	
Circuits with Lumped Elements
As a starting point to form a network, we interconnect lumped elements. Let us start 
with two terminal elements: in this case (Figure 2.6), terminals are electrical nodes. 
We write the basic variables of interest: voltage v(t) at terminals and the current i(t) 
that flows through the element. We use Ohm’s law and, once we solve for voltages, 
other variables can be calculated as power flows and losses.
We define the voltage v(t) at any time t across terminals k and m, in terms of 
voltages with respect to reference 0, and call the voltages Vk0 and Vm0 nodal volt-
ages, at any time t.
Figure 2.5  Voltage-current characteristics for a capacitor.
Figure 2.6  voltage-current variables in an electric element.

2.4	
Kirchhoff’s Current Law
33
	
v(t) = Vk0(t) −Vm0(t) 	
(2.14)
Using the load convention presented in Chapter 1, the product v(t)i(t) will be the 
instantaneous power p(t) delivered to the load element.
2.4	
Kirchhoff’s Current Law
In a practical arrangement of lumped elements at any node, the sum of electric 
currents through connected elements should be zero (for example, for a given node 
with currents as shown in Figure 2.7). Using a convention that current out of the 
node is positive, then at any time t, the current summation of −i1(t) + i2(t) − i3(t) 
should be zero.
We identify the nodal current balance equation as a node equation. Let us use 
a resistive circuit with various nodes, elements and current sources (Figure 2.8). 
Table 2.1 has the connectivity information for impedances. As we write the node 
current equation for every node, the information form will be Kirchhoff’s current 
Figure 2.7  Electric currents into an electric node.
Figure 2.8  Circuit configuration and KCL.
Table 2.1  Connectivity Information, Circuit in Figure 2.8
Element
N_out
N_in
Impedance Value
1
3
1
z31
2
1
2
z12
3
1
0
z10
4
2
3
z23
5
3
0
z30

34
Network Analysis
law (KCL) in matrix form (2.15) for the circuit in Figure 2.7. The circuit in Figure 
2.7and (2.16) has a compact notation for KCL in matrix form.
	
−1 +1 +1
0
0
0
−1
0
+1
0
+1
0
0
−1 +1
0
0
−1
0
−1
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
i31
i12
i10
i23
i30
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
=
J1
0
J3
0
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(2.15)
	
Ati = J 	
(2.16)
At	
Node to element connection matrix
i	
vector of currents through each element
J	
vector of nodal current sources, + into a node and − out from the node
For the set of nodal current equations it can be said that:
• Equation for node 0 is redundant.
• Equations express a linear relation for element’s currents.
• KCL is valid for any linear, nonlinear, passive, or active time variant or invari-
ant circuit.
• KCL expresses the conservation of electric charge at every node.
• KCL is not valid for nonlumped (distributed parameters) circuits.
We supplement the node equations with element’s voltage drop between nodes k 
and m (see Figure 2.9 or the currents in Figure 2.10).
A general expression using impedance zkm from Ohm’s law for element con-
nected at node k and node m is:
	
−zkmikm + Vk −Vm = −ekm 	
(2.17)
Figure 2.9  Impedance element connected between nodes k and m.

2.5	
Nodal Formulation
35
We can rewrite Ohm’s Law using the admittance form ykm = 1/zkm.
	
ikm = ykm Vk −Vm
(
) + ykmekm 	
(2.18)
2.5	
Nodal Formulation
The voltage drop vkm across each element can be written in terms of nodal voltages 
Vk and Vm; voltage values are measured from a node with respect to a reference. For 
the circuit in Figure 2.8, we write (2.19) and (2.20) in a compact matrix notation.
	
−1
0
+1
0
+1 −1
0
0
+1
0
0
−1
0
+1 −1
0
0
0
+1 −1
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
V1
V2
V3
V0
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
v31
v12
v10
v23
v30
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
	
(2.19)
	
v = AVbus 	
(2.20)
A	
Element to node connection matrix
v	
vector of voltage through each element km
V	
vector of nodal voltages, from node to reference
To calculate all nodal voltages as state variables, there is a solution procedure known 
as nodal method. First, we write all voltage-current relation (2.17) for each element 
km, then for each node, we write the current balance equation or Kirchhoff’s cur-
rent law; the series voltage source ekm is zero if no source is present at element km. 
Later, this voltage source will be identified as a control, acting in series with the 
element km.
Figure 2.10  Nodal equivalent for element.

36
Network Analysis
For the circuit in Figure 2.8, each element km by (2.17) gives an equation, and 
by KCL the nodal current balances as (2.16) are shown as:
	
−z31
−1
+1
−z12
+1 −1
−z10
+1
−1
−z23
+1 −1
−z30
+1 −1
−1
+1
+1
−1
+1
+1
−1
+1
−1
−1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
i31
i12
i10
i23
i30
V1
V2
V3
V0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
−e31
−e12
−e10
−e23
−e30
J1
0
J3
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	 (2.21)
	
−z A
At
0
⎡
⎣⎢
⎤
⎦⎥
i
Vbus
⎡
⎣⎢
⎤
⎦⎥=
−e
J
⎡
⎣⎢
⎤
⎦⎥	
(2.22)
z	
Diagonal matrix of impedance values. Off diagonal values will be pres-
ent for mutually coupled elements.
From the first row in matrix equation (2.22), current i is
	
i = z−1 AVbus + e
(
) 	
(2.23)
Working a substitution of i into the second row in (2.22) and after some algebra, 
we find the product Atz–1A. This result is known as the Ybus or nodal admittance 
matrix. At the same expression, currents into electric nodes by sources are called 
Ibus or net nodal injected currents.
	
Ati = Atz−1 AVbus + e
(
) = J 	
(2.24)
	
Atz−1AVbus = YbusVbus = J −Atz−1e = Ibus 	
(2.25)
A solution is sought for state variables Vbus, assuming Ybus and Ibuss are known. Once 
Vbus is known, by (2.20) we can calculate voltages v and with (2.23) currents i; v 
= AVbus and i = z–1(v + e). The solution steps just discussed are the nodal method 
used to solve electrical circuits. From (2.23) and (2.25), we can write a matrix array 
called partial matrix inversion [2, 3]. The process starts with (2.22) and through 
algebra we see an exchange of information from the right-hand to the left-hand 
side. The original matrix (2.22) is modified as
	
z−1
z−1A
Atz−1 Atz−1A
⎡
⎣⎢
⎤
⎦⎥
+e
Vbus
⎡
⎣⎢
⎤
⎦⎥=
i
J
⎡
⎣⎢
⎤
⎦⎥	
(2.26)

2.5	
Nodal Formulation
37
Example 2.1
For the circuit shown in Figure 2.8, values of impedances in ohms and current 
sources in amperes are given. Solve for nodal voltages Vbus and the set of currents 
i that flow in every element. Use (2.22) and identify matrices A and Ybus. Solve for 
Vbus using (2.25) and calculate the voltage drop v across elements, determine cur-
rent i that flows in each element.
Circuit data
Nelem =     5   Nnod =     4
Element    Nfrom    Nto    z Value               esource
     1       3       1     0.0000+j  2.0000      0.0000+j  0.0000
     2       1       2     0.0000+j  1.0000      0.0000+j  0.0000
     3       1       0     0.0000+j  5.0000      0.0000+j  0.0000
     4       2       3     0.0000+j  3.0000      0.0000+j  0.0000
     5       3       0     0.0000+j 10.0000      0.0000+j  0.0000
Nodal conditions, Base Case
Node Num          Js                     zshunt
   1       20.0000+j  0.0000
   2        0.0000+j  0.0000
   3       10.0000+j  0.0000
   4        0.0000+j  0.0000
A =
    -1     0     1     0
     1    -1     0     0
     1     0     0    -1
     0     1    -1     0
     0     0     1    -1
Ybus =
   0 - 1.7000i      0 + 1.0000i      0 + 0.5000i      0 + 0.2000i
   0 + 1.0000i      0 - 1.3333i      0 + 0.3333i      0          
   0 + 0.5000i      0 + 0.3333i      0 - 0.9333i      0 + 0.1000i
   0 + 0.2000i      0                0 + 0.1000i      0 - 0.3000i
Vbus =
  1.0e+002 *
   0.0000 + 1.0000i
   0.0000 + 1.0000i
   0.0000 + 1.0000i
   0.0000 - 0.0000i
velem =
  1.0e+002 *
        0          
        0 + 0.0000i
   0.0000 + 1.0000i
        0 - 0.0000i
   0.0000 + 1.0000i
ielem =
        0          
   0.0000          

38
Network Analysis
  20.0000 - 0.0000i
  -0.0000          
  10.0000 - 0.0000i
2.6	
Kirchhoff Voltage Law (KVL) and the Mesh Method
A loop in a circuit is a closed electrical path that initiates and ends at the same node 
after traveling through various circuit elements. For a circuit with lumped elements, 
at any given time, t, the algebraic sum of voltage drop/rise on elements that are on 
a given loop is zero (KCL). An interesting and nontrivial problem is how to find the 
number of independent loops that exist in a given circuit with 𝓁 elements and n nodes.
𝓁	
elements
n	
nodes (including reference)
In a network we need (n − 1) elements to connect all nodes; these elements are usu-
ally called branches. The remaining network elements are links. For a circuit with 
n nodes and e elements: b = n − 1 branches and l = 𝓁 − b = 𝓁 − (n − 1) links.
For an oriented graph, a closed trajectory or loop involves only branches and 
one link at a time. The associated link direction assigns direction to the loop cur-
rent. For the circuit in Figure 2.11. we have:
Number of elements	
𝓁 = 5
Nodes, including reference	 n = 4
Branches	
b = n − 1 = 3
Links	
l = 𝓁 − b = 2 two loops will be formed, as shown 
in Figure 2.11
The elements that are part of a given loop have either a voltage drop (loop current 
coincides with element’s assumed direction) or a voltage rise (loop current opposes 
Figure 2.11  Graph of a circuit in terms of branches and links.

2.6	
Kirchhoff Voltage Law (KVL) and the Mesh Method
39
the assumed element’s direction). By KVL the algebraic sum of voltage, drops will 
be zero within a loop. From Figure 2.11 in matrix form:
	
+1 +1
0
+1
0
−1
0
−1
0
+1
⎡
⎣⎢
⎤
⎦⎥
v31
v12
v10
v23
v30
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
=
0
0
⎡
⎣⎢
⎤
⎦⎥	
(2.27)
With C as a loop-element connection matrix:
	
Ctv = 0 	
(2.28)
For each element km, we use (2.18) and write the current ikm in terms of the 
loop currents:
	
−y31
+1 −1
−y12
+1
−y10
−1
−y23
+1
−y30
+1
+1
+1
+1
−1
−1
+1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
v31
v12
v10
v23
v30
II
III
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
−j31
−j12
−j10
−j23
−j30
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(2.29)
	
−y C
Ct
0
⎡
⎣⎢
⎤
⎦⎥
v
Iloop
⎡
⎣
⎢
⎤
⎦
⎥=
−j
0
⎡
⎣⎢
⎤
⎦⎥	
(2.30)
A solution to the unknown voltages v and loop currents Iloop is obtained by writing 
the first row in matrix (2.30) and then a substitution into the second row of the 
same matrix equation.
	
ZloopIloop = Vloop 	
(2.31)
Where: Zloop = CtzC, z = y–1 and Vloop = −Ctzj
Solving (2.31) for Iloop as state variables in this formulation, assuming Zloop and 
Vloop are known, we then calculate element’s current i, and voltage v as follows:
	
i = CIloop 	
(2.32)
	
v = z(i + j) 	
(2.33)

40
Network Analysis
2.7	
Linear Equations and Gaussian Elimination
A simple set of two linear equations and two unknowns gives useful forms. Solu-
tion to unknown values, here V1 and V2, follow basic algebraic steps and with the 
proper interpretation, the properties of electric circuits emerge as a result.
	
Y11V1 + Y12V2 = I1
Y21V1 + Y22V2 = I2
	
(2.34)
Assuming that coefficient Y11 ≠ 0, algebraically V1 is taken from the first equation 
in (2.34) as V1 = I1/Y11 − Y12V2/Y11 and a substitution into the second equation in 
(2.34) gives:
	
Y22 −Y21Y12
Y11
⎡
⎣⎢
⎤
⎦⎥V2 = I2 −Y21I1
Y11
	
(2.35)
Writing the first row in (2.34) and (2.35), we find a triangular matrix:
	
Y11
Y12
0
Y22 −Y21Y12
Y11
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
V1
V2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
I1
I2 −Y21I1
Y11
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(2.36)
Solution for V2 is a one equation one unknown problem. With V2 known a back 
substitution, allows V1 to be determined.
	
V2 = Y22 −Y21Y11
−1Y12
(
)
−1 I2 −Y21Y11
−1I1
(
)	
(2.37)
	
V1 = Y11
−1 I1 −Y12V2
(
) 	
(2.38)
Gaussian elimination and backward substitution are the two steps of this process. 
From the circuit point of view, once we eliminate node 1; the numerical process gives 
a Norton’s equivalent (see Figure 2.12). It is important to notice that the current 
source INorton depends on current injected into node 1, which is the node that was 
eliminated. From (2.36), the second row has the equivalent Norton’s admittance 
and the Norton’s source.
Figure 2.12  Norton equivalent after node elimination.

2.7	
Linear Equations and Gaussian Elimination
41
	
Y22
eq = Y22 −Y21Y11
−1Y12
INorton = −Y21Y11
−1I1 	
(2.39)
Example 2.2
For the small network and admittances (see Figure 2.13), calculate the equivalent 
circuit when node 1 is eliminated. Write the nodal matrix Ybus and the element-node 
incidence matrix A. For a line element out of a node has a value +1, into a node 
value −1 as values in the A matrix.
	
+5 −4
−4 +6
⎡
⎣⎢
⎤
⎦⎥
V1
V2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
+5
−6
⎡
⎣⎢
⎤
⎦⎥
A =
+1 −1
+1
0
0
+1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(2.40)
With Gaussian elimination on node 1 (see Figure 2.14):
	
+5
−4
0
+6 −16
5
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
V1
V2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
+5
−6 −(−4)(5)
5
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	
(2.41)
From (2.41), V2 is calculated as V2 = (−6 + 4)/(14/5) = −10/14 volts, then with back 
substitution we determine the value of voltage V1 = 5–1[5 − (−4)(−10/14)] = 6/14 
volts. Using (2.20) and (2.23), the voltage v across elements and current i flow are 
v12 = 16/14 V, v10 = 6/14 V, v20 = −10/14 V and i12 = 64/14 A, i10 = 6/14 A, i20 = 
−20/14 A (see Figure 2.15).
Figure 2.13  Circuit to illustrate node elimination procedure.
Figure 2.14  Circuit with node 1 eliminated, Norton’s equivalent.

42
Network Analysis
2.7.1	
Cramer’s Rule
A procedure called Cramer’s is frequently used when solving sets of linear equa-
tions. Cramer’s rule uses determinants, which we can derive from the last step in 
the Gaussian elimination algorithm presented in the previous section. A useful cir-
cuit interpretation out of these algebraic steps is the Thévenin’s equivalent, which 
requires that all nodes in a circuit be eliminated and that a new mathematical 
circuit be built. For this concept, we start with the nodal admittance matrix and 
we create the nodal impedance matrix, Zbus, through Gaussian elimination. From 
expression (2.42):
	
V2 =
I2 −Y21Y11
−1I1
(
)
Y22 −Y21Y11
−1Y12
(
)
V2 =
Y11 I1
Y21 I2
Y11 Y12
Y21 Y22
=
Y11
Δ
⎛
⎝⎜
⎞
⎠⎟I2 −
Y21
Δ
⎛
⎝⎜
⎞
⎠⎟I1
	
(2.42)
In (2.42), we identify the definition of Δ as the system’s determinant. The factor 
Y11/Δ is Thévenin’s impedance open circuit impedance, as seen from node 2. The 
term − (Y21/Δ)I1 is an equivalent voltage source called Thévenin’s source; its value 
depends on I1. I1 is the injected current at node 1 that we eliminated during the 
process. Equation (2.42) can be written as:
	
V2 = ZThI2 + ETh 	
(2.43)
Using data from the last example, the values of determinant Δ, ZTh and ETh are 
shown. The Thévenin’s equivalent circuit is presented in Figure 2.16, Δ = 14, ZTh = 
5/14 Ω, and ETh = 20/14 V.
2.7.2	 Partial Inversion
From the Gaussian elimination process, a different interpretation for the algebraic 
steps can be done using (2.38) and (2.35). In matrix notation:
Figure 2.15  Circuit solution with current values.

2.7	
Linear Equations and Gaussian Elimination
43
	
1
Y11
−Y12
Y11
+Y21
Y11
Y22 −
Y21Y12
Y11
⎛
⎝⎜
⎞
⎠⎟
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
I1
V2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
V1
I2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(2.44)
We observe that, with respect to the original problem, an exchange in variables 
takes place between I1 and V1. The sign symmetry can be restored for the off-
diagonal elements.
	
−1
Y11
−Y12
Y11
−Y21
Y11
Y22 −
Y21Y12
Y11
⎛
⎝⎜
⎞
⎠⎟
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
−I1
V2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
V1
I2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(2.45)
From (2.45) we write the Partial inversion rules for a square matrix (k is a pivot 
element that matches the row/column of variables to be exchanged by the process):
1.	 Pivot k is replaced by −1/Ykk.
2.	 Elements in pivot row k, m ≠ k are replaced by −Ykm/Ykk.
3.	 Elements in pivot column k, m ≠ k are replaced by −Ymk/Ykk.
4.	 Elements outside row and column pivot k will be: Ymn − YmkYkn/Ykk, m ≠ k 
and n ≠ k.
5.	 When solving a set of linear equations the known value Ik is replaced by −Ik.
The partial inversion procedure just described is repeated as many times as pivots 
are required to exchange known values from the right- to the left-hand side of the 
matrix equation. This needed exchange identifies the pivots to be used. Once the 
exchange process is done, the solution is found by a matrix multiplication. For 
dominant matrices (large diagonal elements), it is a common procedure to take 
the diagonal values in the square matrix as pivots, given that we do not run into a 
numerical problem as a division by zero. If we use pivots one by one, using diago-
nal elements of a square matrix, applying the steps given for the partial inversion 
Figure 2.16  Thévenin’s equivalent for circuit in Figure 2.15.

44
Network Analysis
we end up with the negative of the inverse matrix. At every elimination step, new 
calculated values replace the old values; and this procedure can be called matrix 
inversion at the same place.
2.7.3	 Kron’s Network Reduction
In the technical literature, we find Kron’s reduction as a procedure to eliminate 
nodes. We find that Kron’s reduction is a special case of the partial inversion pro-
cess (discussed in previous sections). If I1 is zero, the second row of (2.36) has an 
equivalent admittance as:
	
Y22 −Y21Y12
Y11
⎛
⎝⎜
⎞
⎠⎟V2 = Y22
eqV2 = I2 	
(2.46)
The equivalent admittance Y22
eq  is the result of eliminating node 1. We solve for V2 
and after that we can calculate V1.
	
V1 =
−Y12
Y11
⎛
⎝⎜
⎞
⎠⎟V2 	
(2.47)
2.8	
Matrix Elements for YBUS and ZBUS
Writing in full the Ybus matrix, there is a useful interpretation for its elements [2, 
3]. The same comment applies to the inverse Zbus. To keep a simple explanation, 
let us consider the matrix for a three-node system.
	
Y11 Y12 Y13
Y21 Y22 Y23
Y31 Y32 Y33
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
V1
V2
V3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
I1
I2
I3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(2.48)
If we assume that node voltages V2 and V3 are zero, it means that we connect node 
2 and 3 to reference (imagine this procedure is conducted with the use of ideal cur-
rent meters in a lab environment). If, at the same time, we connect an ideal voltage 
source of one Volt between node 1 and reference, currents will flow into the circuit 
and meters will read the nodal currents in or out of the nodes. The described con-
dition in the matrix model numerically gives the first column of Ybus in terms of 
the ammeter readings.
	
Y11 Y12 Y13
Y21 Y22 Y23
Y31 Y32 Y33
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
1
0
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
I1
I2
I3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
Y11 = I1
Y21 = I2
Y31 = I3
	
(2.49)

2.8	
Matrix Elements for YBUS and ZBUS
45
Results show that measuring will give a direct reading of values of the admittance 
matrix. This short circuit procedure assigns to the Ybus matrix the name of short 
circuit matrix. In Figure 2.17, let us connect buses 2 and 3 to reference through 
ideal current meters and apply a voltage source of 1 V from node 1 to reference. 
The reading of nodal currents will give the value of elements in the first column of 
Ybus. Y11 = +5, Y21 = −4, Y31 = 0 (see Figure 2.18).
To determine the elements of the second column of Ybus, we follow a similar 
process. We connect the voltage source of 1 V to bus 2 and short node 1 and node 
3 to reference by ammeters. Then Y12 = −4, Y22 = +9, Y32 = −3 (see Figure 2.19). We 
apply the same concept for the third column and find that Y13 = 0, Y23 = −3, Y33 = +3.
For the elements of Zbus matrix, let us write the nodal impedance matrix as in 
(2.50). To obtain the first column, we set the node currents I2 and I3 to zero; this 
Figure 2.17  Circuit to illustrate interpretation of the Ybus elements.
Figure 2.18  Reduced circuit for elements on the first column of Ybus.
Figure 2.19  Reduced circuit for elements on second column of Ybus.

46
Network Analysis
means that nodes 2 and 3 will be in an open circuit condition. If unitary current 
is injected from reference into node one, voltages can be measured from each node 
to reference; voltage readings are directly the Zbus elements, as shown in (2.51).
	
Z11 Z12
Z13
Z21 Z22 Z23
Z31 Z32 Z33
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
I1
I2
I3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
V1
V2
V3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(2.50)
	
Z11 Z12
Z13
Z21 Z22 Z23
Z31 Z32 Z33
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
I1 = 1
0
0
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
V1
V2
V3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
Z11
Z21
Z31
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
V1
V2
V3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(2.51)
Currents flow and nodal voltages are measured from node to reference (see Figure 
2.20(b)). Then, Z11 = 3/7, Z21 = 2/7, Z31 = 2/7. For the second column of Zbus, one-
ampere current goes into bus 2; buses 1 and 3 are open, Z12 = 4/14, Z22 = 5/14, 
Z32 = 5/14 (see Figure 2.21).
For the third column of Zbus (see Figure 2.22); current of one A is injected to 
bus 3; buses 1 and 2 are “open,” Z13 = 4/14, Z23 = 5/14, Z33 = 29/42. The complete 
Zbus matrix or open circuit matrix is in (2.52).
Figure 2.20  Circuit to obtain Zbus elements, first column.

2.9	
Norton’s and Thévenin’s Equivalents
47
Figure 2.21  Reduced circuit to obtain elements on second column of Zbus.
Figure 2.22  Reduced circuit to obtain elements in the third column of Zbus.
	
Zbus =
6
14
4
14
4
14
4
14
5
14
5
14
4
14
5
14
29
14
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
Ω 	
(2.52)
2.9	
Norton’s and Thévenin’s Equivalents
Important circuit analysis results are related to the Gaussian elimination, these 
are the Norton’s and Thévenin’s equivalents. Let us start from (2.37) and explain 
Norton’s equivalent (see Figure 2.23):
	
Y22
eqV2 = I2 + INorton 	
(2.53)
Where:
	
Y22
eq = Y22 −Y21Y11
−1Y12 	
(2.54)
	
INorton = −Y21Y11
−1I1	
(2.55)

48
Network Analysis
The INorton equivalent current source will have a value that depends on the injected 
current by sources that at the eliminated nodes; in our particular case node 1.
One-way to explain Thévenin’s equivalent is through the Cramer’s rule concept 
(2.42) and (2.43). We assume that the bus impedance matrix, Zbus, describes the 
passive network. Let us write the equation for voltage V2, and identify Thévenin’s 
impedance and the equivalent voltage source ETh. The equivalent voltage source is 
in terms of Zbus values and source currents injected at the eliminated node; in our 
discussion this was node one.
	
Z11 Z12
Z21 Z22
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
I1
I2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
V1
V2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(2.56)
	
V2 = Z22I2 + Z21I1 = Z22I2 + ETh 	
(2.57)
Where ZTh = Z22 and ETh = Z21I1.
Thévenin’s source ETh has a value that is the result of injected current into node 
1 and the transfer impedance Z21. If the nodal current into node 1 happens to be 
zero, then the Thévenin’s equivalent voltage source will have a zero value.
2.10	 Large Scale Network Equivalents
We will find general and useful results if—instead of writing equations for a two-
node network, which helps to discuss basic ideas—we now think about two electric 
areas: A and B, each with various nodes. For this discussion, we start with the bus 
admittance matrix and apply Gaussian elimination or partial inversion one step 
at a time. In this way, the original Ybus matrix is transformed. In the case that all 
nodes in an electric area A are eliminated, then a network equivalent is constructed 
for area B by (2.59).
	
YAA YAB
YBA YBB
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
VA
VB
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
IA
IB
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(2.58)
Figure 2.23  Norton’s equivalent after node one elimination.

2.10	
Large Scale Network Equivalents
49
	
YAA
YAB
0
YBB −YBAYAA
−1YAB
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
VA
VB
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
IA
IB −YBAYAA
−1IA
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(2.59)
The Norton’s equivalent for area B can be identified writing the second row of 
matrix (2.58).
	
YBB −YBAYAA
−1YAB
(
)VB = IB −YBAYAA
−1IA 	
(2.60)
	
YBB
eqVB = IB + INorton 	
(2.61)
	
YBB
eq = YBB −YBAYAA
−1YAB 	
(2.62)
	
INorton = −YBAYAA
−1IA 	
(2.63)
We can apply partial inversion to exchange values from the right to the left hand side, 
known currents IA with unknowns VA in (2.58). When all required exchanges are 
done with a matrix multiplication, we find the unknown voltages VA and currents 
IB. The product YAB times VB in (2.65) is an equivalent injection of nodal currents 
into nodes in Area A, as a result of voltage sources in area B.
	
−YAA
−1
−YAA
−1YAB
−YBAYAA
−1 YBB −YBAYAA
−1YAB
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
−IA
VB
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
VA
IB
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(2.64)
	
VA = +YAA
−1 IA −YABVB
(
) 	
(2.65)
2.10.1	 Partitioned Networks and Equivalents
The nodal impedance Zbus is a network model that we can use as a network analy-
sis tool, such as the one required to solve large networks through the concept of a 
partitioned network. Assume that in Figure 2.24 we connect a line from node 3 to 
Figure 2.24  Partitioned network configuration.

50
Network Analysis
node 4 through impedance zAB. The line will connect the left side network to the 
network on the right. The nodal impedance model Zbus for the left-side network, 
not including the line impedance zAB is:
	
Z11 Z12
Z13
L
Z21 Z22 Z23
L
Z31
L
Z32
L
Z33
L
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
I1
I2
I3
L
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
V1
V2
V3
L
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(2.66)
Thévenin’s equivalent at node 3 for the left side network is:
	
V3
L = Z31
L I1 + Z32
L I2 + Z33
L I3
L = Z33
L I3
L + ETh,3
L
	
(2.67)
Where ETh,3 at the left is the product of nodal currents at node 1 and 2 with imped-
ance values from the Zbus matrix.
The network at the right includes the impedance zAB. Thévenin’s equivalent at 
node 3 is:
	
Z33
R
Z34
R
Z35
R
Z36
R
Z43
R
Z44 Z45 Z46
Z53
R
Z54 Z55 Z56
Z63
R
Z64 Z65 Z66
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
I3
R
I4
I5
I6
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
=
V3
R
V2
V5
V6
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
	
(2.68)
	
V3
R = Z33
R I3
R + Z34
R I4 + Z35
R I5 + Z36
R I6 = Z33
R I3
R + ETh,3
R
	
(2.69)
Where Eth,3 at the right is the product of nodal currents at nodes 4, 5, and 
6 with impedance values from the Zbus matrix.
At a steady state, generation should match load and losses. We calculate volt-
ages for both the left- hand side and the right side.
	
V0
L =
V1
L
V2
L
V3
L
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
0
and
V0
R =
V3
R
V4
R
V5
R
V6
R
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
0
	
(2.70)
When circuits connect at bus 3, the electric boundary conditions (2.71) and (2.72) 
must be satisfied (see Figure 2.25). We impose the boundary conditions on Thévenin’s 
equations (2.67) and (2.69), we solve for nodal current IR
3 into the right side circuit.
	
V3
R = V3
L 	
(2.71)

2.10	
Large Scale Network Equivalents
51
	
I3
R = −I3
L 	
(2.72)
	
V3
L = Z33
R I3
R + ETh,3
R
= Z33
L I3
L + ETh,3
L
	
(2.73)
	
I3
R = Z33
R + Z33
L
(
)
−1 ETh,3
L
−ETh,3
R
(
) 	
(2.74)
As current IR
3 flows into the right-hand side network, nodal voltages change (see 
Figure 2.26). With a set of voltage corrections are to be added to previous voltage 
values, we find the new voltage value when the two networks are connected (2.76).
	
ΔV3
ΔV4
ΔV5
ΔV6
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
R
=
Z33
R
Z34
R
Z35
R
Z36
R
Z43
R
Z44 Z45 Z46
Z53
R
Z54 Z55 Z56
Z63
R
Z64 Z65 Z66
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
I3
R
0
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
Z33
R
Z43
R
Z53
R
Z63
R
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
I3
R 	
(2.75)
	
V3
R
V4
R
V5
R
V6
R
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
New
=
V3
R
V4
R
V5
R
V6
R
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
0
+
ΔV3
ΔV4
ΔV5
ΔV6
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
R
=
V3
V4
V5
V6
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
0
+
Z33
R
Z43
R
Z53
R
Z63
R
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
I3
R 	
(2.76)
The left-hand side network also experiences voltage changes, current I3
L = −I3
R is 
applied. For the calculation, the information that we need is a column of the left-
hand side Zbus matrix.
	
ΔV1
ΔV2
ΔV3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
L
=
Z11 Z12
Z13
L
Z21 Z22 Z23
L
Z31
L
Z32
L
Z33
L
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
0
0
−I3
R
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
= −
Z13
L
Z23
L
Z33
L
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
I3
R 	
(2.77)
Figure 2.25  Network equivalents from node 3, left and right networks.

52
Network Analysis
	
V1
L
V2
L
V3
L
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
New
=
V1
L
V2
L
V3
L
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
0
+
ΔV1
ΔV2
ΔV3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
L
=
V1
L
V2
L
V3
L
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
0
−
Z13
L
Z23
L
Z33
L
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
I3
R 	
(2.78)
Example 2.3
–Note that Node 7 will coalesce to node 3 with the connected network.
Yleft  =
    20.  - 10.  - 10.  
  - 10.    17.   - 5.   
  - 10.   - 5.    15.  
Zleft  =
    0.575    0.5    0.55  
    0.5      0.5    0.5   
    0.55     0.5    0.6   
Yright  =
    22.5  - 10.        - 2.5        - 10.  
Figure 2.26  Network equivalents form node 3, left side and right side networks.
Table 2.2  Connectivity Resistance Elements (Figure 2.26)
Element
Node from
Node to
Value (Ω)
(1)
2
0
0.5
(2)
2
1
0.1
(3)
1
3
0.1
(4)
2
3
0.2
(5)
6
0
0.8
(6)
6
5
0.3
(7)
4
5
0.1
(8)
6
4
0.4
(9)
4
7
0.1

2.10	
Large Scale Network Equivalents
53
  - 10.     13.333333  - 3.3333333     0.   
   - 2.5   - 3.3333333   7.0833333     0.   
  - 10.      0.          0.           10.  
Zright  =
    1.      0.95      0.8    1.    
    0.95    0.9875    0.8    0.95  
    0.8     0.8       0.8    0.8   
    1.      0.95      0.8    1.1   
V0Left  =
    1.06  
    1.    
    1.04  
V0right  =
    2.9    
    2.925  
    2.4    
    2.9    
Iright  =  - 1.0941176  
DeltaV0Left  =
    0.6017647  
    0.5470588  
    0.6564706  
DeltaV0right  =
  - 1.0941176  
  - 1.0394118  
  - 0.8752941  
  - 1.2035294  
VnLeft  =
    1.6617647  
    1.5470588  
    1.6964706  
Vnright  =
    1.8058824  
    1.8855882  
    1.5247059  
    1.6964706  
Let us solve the nonseparated network to check results. The nodal admittance matrix 
Ybus, the impedance matrix Zbus and nodal voltages are values for the completely 
connected system.
Ybus  =
    20.  - 10.  - 10.    0.      0.           0.         
  - 10.    17.  - 5.     0.      0.           0.         
  - 10.  - 5.     25.  - 10.     0.           0.         
    0.     0.   - 10.    22.5  - 10.        - 2.5        
    0.     0.     0.   - 10.     13.333333  - 3.3333333  
    0.     0.     0.   - 2.5   - 3.3333333    7.0833333  

54
Network Analysis
Zbus  =
0.3970588  0.3382353  0.3558824  0.3235294  0.3073529  0.2588235  
0.3382353  0.3529412  0.3235294  0.2941176  0.2794118  0.2352941  
0.3558824  0.3235294  0.3882353  0.3529412  0.3352941  0.2823529  
0.3235294  0.2941176  0.3529412  0.4117647  0.3911765  0.3294118  
0.3073529  0.2794118  0.3352941  0.3911765  0.4566176  0.3529412  
0.2588235  0.2352941  0.2823529  0.3294118  0.3529412  0.4235294
Vbus  =
    1.6617647  
    1.5470588  
    1.6964706  
    1.8058824  
    1.8855882  
    1.5247059
2.11	 Diakoptical Approach
For a general network, let us start the discussion with a base case and then include 
a modified solution when changes are made through network elements. Changes 
modify nodal voltages and currents for the base case as shown by (2.82).
	
YbusVbus
o
= Ibus
o 	
(2.79)
	
YbusVbus
n
= Ibus
o
−ΔI 	
(2.80)
	
ΔI = At[ΔY]AVbus
n 	
(2.81)
	
Ybus + At[ΔY]A
(
)Vbus
n
= Ibus
o 	
(2.82)
The last expression is useful to calculate the new bus voltages Vbus; at this step, 
we find it useful to introduce the partial inversion lemma. The partial inversion 
process can explain this result, as shown in the Section 2.12. Solution to (2.82) is 
written as (2.83).
	
Vbus
n
= Ybus
−1 −Ybus
−1At [ΔY]−1 + AtYbus
−1A
(
)
−1 AYbus
−1
⎡
⎣⎢
⎤
⎦⎥Ibus
o 	
(2.83)
	
Vbus
n
= Vbus −ZbusAtΔY U + AtZbusAΔY
(
)AVbus 	
(2.84)
Where Zbus = Ybus
−1  and U is a unitary matrix.
Part of (2.80) is a compensating current ΔI, which contains the effect of net-
work changes. To identify the compensating current, starting with (2.84) and 
Vbus = V0
bus, then ΔI is:

2.11	
Diakoptical Approach
55
	
Vbus
n
= Vbus
0
−ZbusAtΔY U + AZbusAtΔY
(
)
−1 AVbus
0 	
(2.85)
	
ΔI = AtΔY U + AZbusAtΔY
(
)
−1 Abus
0
	
(2.86)
Example 2.4
Let us consider, for illustrative purposes, a two-phase network with nodes I, II (see 
Figure 2.27). The change will be to include a transmission element with impedance 
value ZTL between nodes I, II.
The condition before we include the ZTL element, with nodal currents going into 
node I and II; phases a, b respectively, the Ybus matrix for the network is calculated. 
Current values are in amperes, admittances in siemens, and impedances in ohms.
	
Io =
+1
+1
+2
+2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
YTL = ZTL
−1 =
+2 −1
−1 +2
⎡
⎣⎢
⎤
⎦⎥	
(2.87)
• Base case (ZTL not included)
Vbus
o
= Ybus
−1Ibus
o
= ZbusIbus
o
Vbus
o
=
+2 −1
0
0
−1 +2
0
0
0
0
+2 −1
0
0
−1 +2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
−1
+1
+1
+2
+2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
2/3 1/3
0
0
1/3 2/3
0
0
0
0
2/3 1/3
0
0
1/3 2/3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
+1
+1
+2
+2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
+1
+1
+2
+2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
 

(2.88)
• When ZTL is connected between node I and II we use (2.85) with A and ΔY as:
Figure 2.27  Piecewise networks.

56
Network Analysis
	
A =
1 0 −1
0
0 1
0
−1
⎡
⎣⎢
⎤
⎦⎥
At =
+1
0
0
+1
−1
0
0
−1
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
ΔY =
+2 −1
−1 +2
⎡
⎣⎢
⎤
⎦⎥	
(2.89)
	
ZbusΔI = ZbusAtΔY U + AZbusAtΔY
(
)
−1 AVbus
o
=
1/3
0
0
1/3
−1/3
0
0
−1/3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
1 0 −1
0
0 1
0
−1
⎡
⎣⎢
⎤
⎦⎥
1
1
2
2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
−1/3
−1/3
+1/3
+1/3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(2.90)
The updated voltage values are:
	
Vbus
n
= Vbus
0
−ZbusAtΔY U + AZbusAtΔY
(
)
−1 AVbus
0
Vbus
n
=
1
1
2
2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
−
−1/3
−1/3
+1/3
+1/3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
4/3
4/3
5/3
5/3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
Volts
	
(2.91)
• We check the solution given by the partitioned approach, with all elements 
connected into the Ybus,n.
	
Vbus
n
= Ybus
−1Ibus
0
=
+4 −2 −2 +1
−2 +4 +1 −2
−2 +1 +4 −2
+1 −2 −2 +4
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
−1
1
1
2
2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
1.3333
1.3333
1.6667
1.6667
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
Volts 	 (2.92)
2.12	 Matrix Inversion Lemma
The matrix inversion lemma will be discussed using a 2 × 2 impedance matrix, 
assuming that Z11
−1  and Z22
−1  exist.
	
Z11 Z12
Z21 Z22
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(2.93)
With partial inversion using Z22 as pivot on the original matrix:
	
Z11 −Z12Z22
−1Z21 −Z12Z22
−1
−Z22
−1Z21
−Z22
−1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(2.94)

2.12	
Matrix Inversion Lemma
57
We apply the partial inversion step again to result (2.94); now we use the element 
located at 11 as the pivot. The result is the negative of the inverse.
−Z11 −Z12Z22
−1Z21
(
)
−1
+ Z11 −Z12Z22
−1Z21
(
)
−1 Z12Z22
−1
+Z22
−1Z21 Z11 −Z12Z22
−1Z21
(
)
−1 −Z22
−1 −Z22
−1Z21 Z11 −Z12Z22
−1Z21
(
)
−1 Z12Z22
−1
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	(2.95)
If we follow a different order, first pivot (1,1), then (2,2) to conduct the partial 
inversions, and we compare (2.95) to (2.97) for the algebraic result known as the 
inversion matrix lemma.
	
−Z11
−1
−Z11
−1Z12
−Z21Z11
−1 Z22 −Z21Z11
−1Z12
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(2.96)
−Z11
−1 −Z11
−1Z12 Z22 −Z21Z11
−1Z12
(
)
−1 Z21Z11
−1 +Z11
−1Z12 Z22 −Z21Z11
−1Z12
(
)
−1
Z22 −Z21Z11
−1Z12
(
)
−1 Z21Z11
−1
−Z22 −Z21Z11
−1Z12
(
)
−1
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	(2.97)
	
Z22 −Z21 Z11
−1 Z12
(
)
−1 = Z22
−1 +Z22
−1 Z21 Z11 −Z12 Z22
−1 Z21
(
)
−1 Z12 Z22
−1 	
(2.98)
The result has various important applications in network analysis as well as in 
the signal processing area. For network analysis, in-state estimation and recursive 
forecasting and control procedures.
References
[1]	
Stagg, G., and A. El-Abiad, Computer Methods in Power System Analysis, New York: 
McGraw-Hill Inc., 1968.
[2]	
Brown, H. E., Solution of Large Networks by Matrix Methods, New York: John Wiley 
& Sons, 1975.
[3]	
Bruce Shipley, R., Introduction to Matrices and Power Systems, New York: John Wiley 
& Sons, 1976.


59
C h a p t e r  3
Power Transformer Modeling
3.1	
Introduction
To conduct studies for electrical power systems aiming at planning their expansion 
or for control and operation, detailed models for the main system’s components 
must be used. Among the important elements are transformers, transmission lines, 
generators, and electrical loads. To establish models, we start with physical prin-
ciples, material characteristics, intended use of the device and analytic tools as a 
solution to a system of equations, and symmetrical components or other mathemati-
cal transformations that allow us to establish a manageable problem; variables of 
interest are nodal voltages, currents through elements, and real and reactive power 
as well as losses.
A model for each element is derived based on physical laws in order to express 
the induced voltage, voltage drop, and current flows. The main focus of this chapter 
is to characterize a single-phase transformer and then to extend it to three-phase 
bank arrangements. We also review autotransformer voltage current relations, as 
well as three-phase transformers. Mathematical transformations are used to take 
the “abc” phase representation into a modal domain that might give computational 
advantages to solve the problem (i.e., symmetrical components). Once a solution 
in the modal domain is attained, an inverse transformation can return the solution 
to the “abc” quantities.
3.2	
Equation Decoupling and Symmetrical Components
In many instances, a system of equations can be put into a simpler form. This is 
accomplished by decoupling the variables involved. The concept has many interest-
ing applications in steady state analysis and in the dynamic mode for time changing 
systems. To present the decoupling concept let us assume a linear system of equa-
tions (3.1), where A is a square matrix.
	
y = Ax 	
(3.1)
We propose a transformation such that new variables called w and z can be expressed 
as x and y through the transformation T.
	
x = Tw 	
(3.2)

60
Power Transformer Modeling
	
y = Tz 	
(3.3)
A substitution of (3.2) and (3.3) into (3.1) gives a new system of equations. Assum-
ing T is a square matrix and that its inverse T–1 exists.
	
y = Ax = ATw 	
(3.4)
	
z = T −1ATw 	
(3.5)
Our goal is to find the matrix T and its inverse T–1, such that T–1AT is a diagonal 
matrix in (3.5). To illustrate the process, let us use a 2×2 general A matrix such 
that Γ’s in (3.6) are along the diagonal matrix. We write T–1AT = Γ in a slightly 
different form to find the t values.
	
a11 a12
a21 a22
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
t11 t12
t21 t22
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
t11 t12
t21 t22
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Γ11
0
0
Γ22
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(3.6)
From (3.6) we have two systems of equations. These relations allow for the calcu-
lation of values for t11 and t21 and eventually for t12 and t22. Using algebra shows 
us that certain conditions have to be met through a quadratic equation (3.10) for 
both Γ11 and Γ22. In general, (3.9) describes the eigenvalue problem that requires 
a solution for λ, a polynomial form out of det(A − λI) = 0. First column values for 
the transformation matrix T.
	
a11 a12
a21 a22
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
t11
t21
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
= Γ11
t11
t21
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(3.7)
	
a11 −Γ11
a12
a21
a22 −Γ11
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
t11
t21
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
0
0
⎡
⎣⎢
⎤
⎦⎥	
(3.8)
	
a11 −Γ11
a12
0
a22 −Γ11 −a21a12/(a11−Γ11)
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
t11
t21
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
0
0
⎡
⎣⎢
⎤
⎦⎥	
(3.9)
	
Γ11
2 −a11 + a22
(
)Γ11 + a11a22 −a21a12 = 0 	
(3.10)
Example 3.1
Given A =
5 1
2 4
⎡
⎣⎢
⎤
⎦⎥
tr(A) =
akk
k=1
n
∑
= a11 + a22 = 5 + 4 = 9
det(A) = 18
Solving λ2 − 9λ + 18 = 0 or (λ − 6)(λ − 3) = 0, we have two eigenvalues:

3.2	
Equation Decoupling and Symmetrical Components
61
	
l1 = 6
l2 = 3	
Once the eigenvalues are found, the values for the T matrix can be calculated col-
umn-wise. These columns are known as eigenvectors. From (3.9), any value t21 ≠ 0 
will satisfy the equation, and from the first row of (3.9), we find t11. This process 
establishes the relation between components t11 and t21, but does not assign any 
numerical value directly (i.e., t11 = −a12/(a11 − λ1) t21 = −1/(5 − 6) t21 = t21). We can 
choose any convenient values (except zero), depending on the nature of the prob-
lem; a simple value for t21 is 1, then t11 = 1. Following a similar procedure with λ2, 
t12 = −a12 t22/(a11 − λ2) = −t22/(5 − 3) = −t22/2, if we choose a value for t22 = 1 and 
t12 = −1/2.
The eigenvectors for this example are columns with values as follows: elements 
for the first column should be equal, and elements for the second column the values 
are related as t12 = −t22/2.
The transformation matrix T and its inverse T–1 are:
	
T =
1 −1/2
1
1
⎡
⎣⎢
⎤
⎦⎥
T −1 = 2
3
1
+1/2
−1
1
⎡
⎣⎢
⎤
⎦⎥	
(3.11)
If T–1AT is calculated, a diagonal matrix is found, and its elements are the eigen-
values 6 and 3.
The concept can be readily extended and of particular interest is to transform a 
symmetrical matrix Z as in (3.12) into a diagonal form. The eigenvalues are deter-
mined from the characteristic polynomial (3.13).
	
Z =
z
m
m
z
⎡
⎣⎢
⎤
⎦⎥	
(3.12)
	
det
z −l
m
m
z −l
⎡
⎣⎢
⎤
⎦⎥= (z −l)2 −m2 = 0 	
(3.13)
	
l1 = z + m
l2 = z −m 	
(3.14)
The elements for the eigenvectors are determined as follows:
	
t11 =
−m
z −(z + m)t21 = +t21
t12 =
−m
z −(z −m)t22 = −t22 	
(3.15)
First column for T must have equal values and for the second column the summa-
tion of its values should be zero. We can select the t’s values, as real or complex 
numbers and the options are infinite. A constraint is that once T is defined the 
inverse T–1 must exist.

62
Power Transformer Modeling
3.2.1	 Symmetrical Components Transformation
One matrix structure that has special interest in electrical power systems is the one 
related to a 3×3 symmetrical matrix, z value along the main diagonal and m values 
outside. The eigenvalue problem takes the form (3.18). To turn the matrix Z into 
a diagonal matrix, we said that there are an infinite number of transformations. 
One of them is the symmetrical components or 012. Clarke’s transformation αβ0 is 
another one. Some matrix transformations might include complex numbers and some 
only real numbers. The solution to the polynomial equation from det(Z − λI) = 0 
is simplified if we change to an u variable, given as u = (z − λ)/m.
	
det(Z −lI) = det
z −l
m
m
m
z −l
m
m
m
z −l
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥= 0 	
(3.16)
	
z −l
m
⎛
⎝⎜
⎞
⎠⎟
3
−3 z −l
m
⎛
⎝⎜
⎞
⎠⎟+ 2 = 0	
(3.17)
For (3.17) as u3 − 3u + 2 = 0, one root is u = 1, the other solutions will come from 
the polynomial u2 + u − 2 = 0. The eigenvalues in terms of z and m, for the sym-
metrical matrix in (3.16) are λ1 = z + 2m, λ2 = z − m and λ3 = z − m.
The first eigenvector is found when we solve for the first column of the trans-
formation matrix T.
	
z
m m
m
z
m
m m
z
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
t11
t21
t31
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
= l1
t11
t21
t31
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(3.18)
The result for the eigenvector that corresponds to the eigenvalue z + 2m, is t11 = t21 
= t31. The eigenvectors for the eigenvalues: λ2 = λ3 = z − m require that (3.20) and 
(3.21) be satisfied.
	
z −z + m
m
m
m
z −z + m
m
m
m
z −z + m
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
t12
t22
t32
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
0
0
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	
(3.19)
	
t12 + t22 + t32 = 0 	
(3.20)
	
t13 + t23 + t33 = 0 	
(3.21)
In electrical power systems it is common to use the symmetrical components trans-
formation, to decouple variables, where Ts and Ts
–1, using α = ej2π/3, α2 = (e–j2π/3).

3.2	
Equation Decoupling and Symmetrical Components
63
	
TS =
1
1
1
1 a2
a
1
a
a2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
TS
−1 = 1
3
1
1
1
1
a
a2
1 a2
a
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	
(3.22)
It can be seen that the values in the eigenvectors of Ts satisfy the condition for the 
first column; all elements are equal. It also satisfies (3.20)–(3.21) where the column’s 
elements should add up to zero.
Example 3.2
Ohm’s law for a three-phase balanced impedance element has a voltage drop when 
currents flow through the series impedance arrangement.
	
ΔVa
ΔVb
ΔVc
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
z
m m
m
z
m
m m
z
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Ia
Ib
Ic
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(3.23)
Phase currents and voltages drops in reference abc can be changed to the new refer-
ence 012, symmetrical components using TS and TS
–1. By matrix multiplications on 
the series impedance Zabc, we can find the sequence impedances Z012.
	
TS
ΔV0
ΔV1
ΔV2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
z
m m
m
z
m
m m
z
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥TS
I0
I1
I2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(3.24)
ΔV0
ΔV1
ΔV2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
= TS
−1
z
m m
m
z
m
m m
z
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥TS
I0
I1
I2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
z + 2m
0
0
0
z −m
0
0
0
z −m
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
I0
I1
I2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(3.25)
The zero sequence impedance is z + 2m; positive and negative sequence impedances 
are equal to z − m. Because the resulting impedance matrix in (3.25) has values only 
along the diagonal, we can say that the sequence networks are decoupled.
Example 3.3
A different type of transformation can be selected using real numbers only: 0, 1, 
and −1. The values in the eigenvectors are arranged to satisfy constraint of first 
column with the same value and constraint (3.20) and (3.21) for the second and 
third columns of the transformation matrix Txyz.
	
Txyz
−1 = 1
3
+1 +1 +1
+1 −1
0
+1
0
−1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Txyz =
+1 +1 +1
+1 −2 +1
+1 +1 −2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(3.26)

64
Power Transformer Modeling
Example 3.4
For a three-phase impedance matrix, show the transformation of phase impedances 
abc to sequence components using Txyz and T –1
xyz.
z =   1.0000 +10.0000i
m =   0 + 2.0000i
Zabc =
   1.0000 +10.0000i        0 + 2.0000i        0 + 2.0000i
        0 + 2.0000i   1.0000 +10.0000i        0 + 2.0000i
        0 + 2.0000i        0 + 2.0000i   1.0000 +10.0000i
Zxyz =
   1.0000 +14.0000i        0                  0          
        0             1.0000 + 8.0000i        0          
        0                  0             1.0000 + 8.0000i
Example 3.5
For unbalanced currents in the abc domain, find the time xyz components. Phase abc 
currents are: ia(t) = Ima cos(2πft + θa), ib(t) = Imb cos(2πft + θb), ic(t) = Imc cos(2πft + 
θc). The transformation (3.26) will change from the abc domain into the xyz sequence 
domain, use f = 60 Hz and the following unbalanced values for the peak currents. 
Plot currents in the abc domain and then visualize the xyz currents.
	
Ima = 80 2,  Imb = 100 2,  Imc = 100 2 	
For a balanced condition, the transformed currents xyz have two components of 
equal magnitude ix, iy, one with a phase angle of 30° leading and the other a phase 
angle of 30° lagging (see Figure 3.31). For the balanced condition, the current com-
ponent iz has zero value, similar to the zero sequence current in symmetrical compo-
nents. We can appreciate some numerical and speed of calculation advantages when 
using only real numbers in the transformation. Depending on the type of application 
we might be interested in properties and possible advantages for numerical speed 
when we need to detect the type of fault in a faulted power system.
3.2.2	 Decoupling of State Equations
In the previous section, we presented the decoupling principle for a steady state 
condition; now, let us try to expand the concept to dynamic equations. We assume 
a linear dynamic state model (3.27) and a linear transformation by (3.2). The goal 
is to have the product T–1AT in (3.28) as a diagonal matrix. To illustrate the con-
cept, we use a two variable system. The solution will find the modes of oscillation 
for the dynamic system and its damping properties. Solving the differential equa-
tions (3.29) where Bk
(n) are source participation factors requires two constants of 
integration: k1 and k2 whose values can be found using the boundary conditions.
	
dx
dt = Ax + Bu 	
(3.27)

3.2	
Equation Decoupling and Symmetrical Components
65
Figure 3.1  Three-phase unbalanced abc currents and the xyz components.

66
Power Transformer Modeling
	
dw
dt = T −1ATw + T −1Bu 	
(3.28)
	
dw1
dt
dw2
dt
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
Γ11
0
0
Γ22
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
w1
w2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
+
B1
(n)
B2
(n)
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
u 	
(3.29)
Example 3.6
A series RLC circuit (shown in Figure 3.2) has values for R = 4 ohms, L = 2 mH, 
and C = 2 μF show the transformation process starting with circuit equations and 
select as state variables current i and voltage drop at capacitor’s terminals vC. Then 
solve the eigenvalue problem to find the transformation matrix T and T–1.
Using as state variables x1 = i and x2 = vC, the system model and the trans-
formed system are:
	
!x1
!x2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
−R/L −1/L
+1/C
0
⎡
⎣⎢
⎤
⎦⎥
x1
x2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
+
1/L
0
⎡
⎣⎢
⎤
⎦⎥vS 	
(3.30)
	
!w1
!w2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
= T −1
−R/L −1/L
+1/C
0
⎡
⎣⎢
⎤
⎦⎥T
w1
w2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
+ T −1
1/L
0
⎡
⎣⎢
⎤
⎦⎥vS 	
(3.31)
A =
       -2000        -500
      500000           0
tr = -2000
detA = 250000000
lamda1 = -1.0000e+003 +1.5780e+004i
lamda2 = -1.0000e+003 -1.5780e+004i
T =
  -0.0020 + 0.0316i  -0.0020 - 0.0316i
   1.0000             1.0000          
Tinv =
        0 -15.8431i   0.5000 - 0.0317i
Figure 3.2  Series RLC circuit.

3.3	
Single-Phase Transformer Model
67
        0 +15.8431i   0.5000 + 0.0317i
Diagonal_matrix =
  1.0e+004 *
  -0.1000 + 1.5780i        0 - 0.0000i
        0 + 0.0000i  -0.1000 - 1.5780i
B =
   500
     0
Bnew =
  1.0e+003 *
        0 - 7.9216i
        0 + 7.9216i
The decoupled dynamic equation, in terms of w1 and w2 is:
!w1
!w2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
= 104
−0.1 + 1.578i
0
0
−0.1 −1.578i
⎡
⎣⎢
⎤
⎦⎥
w1
w2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
+ 103
−7.9216i
+7.9216i
⎡
⎣⎢
⎤
⎦⎥vS 	
(3.32)
Initial conditions for the w’s variables are calculated as:
	
w1
w2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
(0)
= T −1
x1
x2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
(0)
= T −1
i
vC
⎡
⎣⎢
⎤
⎦⎥
(0)
	
(3.33)
3.3	
Single-Phase Transformer Model
In order to have a general model for a single-phase transformer component in a 
power system, let us first consider a complex changing tap arrangement at the pri-
mary and also in the secondary sides through ideal transformers.
Figure 3.3  Single-phase complex transformer.

68
Power Transformer Modeling
	
vm −v
′
m = im
yAa
= zAaim 	
(3.34)
Voltage relations are vAN = αvm and van = βv′m and for the ideal transformer, the 
complex power relation at both sides as vANi∗
AN = vmi∗
m and v′mi∗
m = vani∗
an. Starting 
with the vAN voltage, substitution of (3.34) as well as current expressions from 
the complex power relation, then the equations for the transformer and the shunt 
impedances are arranged as Ohm’s equation:
	
−zAa a
2 iAN + VA −VN −a
bVa + a
bVn = 0
−ZNiN = VN
−Znin = Vn
	
(3.35)
Writing the nodal currents by KCL and together with the set (3.35) now in matrix 
form, where i’s are element’s currents and I’s are nodal currents.
	
−zAa a
2
0
0
+1 −a
b −1 + a
b
0
−zN
0
0
0
+1
0
0
0
−zn
0
0
0
+1
+1
0
0
0
0
0
0
−a∗
b∗
0
0
0
0
0
0
−1
+1
0
0
0
0
0
+ a∗
b∗
0
+1
0
0
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
iAN
iN
in
VA
Va
VN
Vn
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
0
0
0
IA
Ia
IN
In
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(3.36)
In case both ZN and Zn were zero, both nodes N and n are connected to reference. 
A partial inversion on first row-first column will render the nodal matrix equivalent 
for the single-phase transformer (as seen in Figure 3.4).
	
+yAa
a
2
−yAa
a
2
+yAa
a∗b
+yAa
a
2
−yAa
a∗b
−yAa
a
2
+yAa
a
2
−yAa
a∗b
−yAa
a
2
+yAa
a∗b
+yAa
ab∗
−yAa
ab∗
+yAa
b
2
+yAa
ab∗
−yAa
b
2
+yAa
a
2
−yAa
a
2
+yAa
a∗b
+yAa
a
2
−yAa
a∗b
−yAa
ab∗
+yAa
ab∗
−yAa
b
2
−yAa
ab∗
+yAa
b
2
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
0
VA
Va
VN
Vn
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
=
iAN
IA
Ia
IN
In
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
	
(3.37)

3.3	
Single-Phase Transformer Model
69
When α and β are real numbers, Norton’s equivalent circuit is visualized as in 
Figure 3.5.
3.3.1	 Per Unit Values
The voltages, currents, and power describe how a power circuit works. Various 
voltage levels are used to link efficiently generation, transmission, and loads. To 
this intricacy, it must be added the rating of generators, transformers power rating, 
and the power handling capacity of the transmission line.
To have a manageable network for analysis, we write its equations in a common 
base (voltage, current, power, and impedance) to render what is known as per-unit 
values. With this approach, an easier handling of information can be conducted 
between different voltage levels, as happens in the primary and secondary of a power 
transformer. To apply the per unit values, it is customary to choose two base values 
(usually power and voltage). The derived quantities will then be current, impedance, 
and admittance; these values will depend on the selected power and voltage bases.
Suggested steps to follow for pu base value determination.
1.	 For the entire network a common power base is selected; 100 MVAbase com-
monly used.
Figure 3.4  Equivalent circuit for a single-phase transformer.
Figure 3.5  Equivalent circuit for a single-phase transformer, grounded neutrals.

70
Power Transformer Modeling
2.	 Base voltage kVbase is selected at one side of the voltage transformer; the 
transformer relation is used to find the corresponding base voltage at the 
other side.
3.	 Current base Ibase and impedance base Zbase at each portion of the network 
can be calculated using the power and voltage bases selected at steps 1 and 2.
4.	 With the chosen bases and the derived base quantities, the per unit values are 
calculated as (V in kV)/Vbase in kV, (S in MVA)/Sbase MVA, Z in Ω/Zbase Ω
Example 3.6
For a single-phase transformer (see Figure 3.6), the steps to selecting base quanti-
ties are as follows:
• Select a power base for the entire system (a common value is 100 MVA).
• Select the primary and then the secondary base voltage (kV), considering the 
transformation ratio ⎪t⎪.
• Derive the primary and secondary base currents (kA), then the impedance 
(Ω) and admittance base (S).
	
SB
VB
P
VB
S = 1
t
⎫
⎬⎪
⎭
⎪
Common power and voltage relations 	
(3.38)
IB
P = SB
VB
P
IB
S = SB
VB
S
Primary and secondary current base
ZB
P = VB
P
(
)
2
SB
ZS
P = VS
P
(
)
2
SB
Primary and secondary impedance base
	
(3.39)
Per unit values
Power base = 100 MVAs
Primary Voltage base = 230.94 kV   Secondary Voltage base = 132.79 kV
Primary Current base = 0.4330 kA   Secondary Current base = 0.7531 kA
Primary Z base = 533.3333 Ohms     Secondary Z base = 176.3333 Ohms
Primary Y base = 0.001875 S        Secondary Y base = 0.005671 S
Figure 3.6  Single-phase transformer, voltages, and currents for the primary and secondary.

3.3	
Single-Phase Transformer Model
71
For three-phase arrangements, the per unit values are calculated using three-phase 
power SB,3 (MVA) and the line-to-line voltage kVLL (kV), then ZB (Ω) and IB (kA) are
	
ZB =
kVLL
(
)
2
SB,3
IB =
SB,3
3kVLL
	
(3.40)
Example 3.7
From Figure 3.6, the impedance Zs can be transferred from the right side to the left 
side using voltage relations in an ideal transformer (Figure 3.7, where n = |t|), using 
IP = ⎪t⎪IS, starting with VP.
	
VP = 1
t
′
VS = 1
t ZSIS + VS
(
) 	
(3.41)
	
VP = 1
t
ZS
1
t IP + VS
⎛
⎝⎜
⎞
⎠⎟= ZS
t
2 IP + 1
t VS 	
(3.42)
Example 3.8
In mutually coupled circuits (see Figure 3.8) operating at different voltage levels VP 
and VS, select the same power base for both systems, then the mutual impedance 
base can be deduced, starting with ΔVP = ZPIP + MIS, M is the complex mutual 
impedance, then the per unit ΔVP/V′B will be
	
ΔVP
VB
P
= ZPIP
ZB
PIB
P +
MIS
VB
PVB
S
SB
IB
S
	
(3.43)
	
ΔVP
pu = ZP
puIP
pu +
M
VB
PVB
S
SB
IS
pu 	
(3.44)
Figure 3.7  Single-phase transformer voltage, current, and impedance at the primary side.

72
Power Transformer Modeling
The mutual impedance base, with voltages in kV and power in MVA values, is the 
denominator of M in (3.44).
Mutual impedance in pu
Voltage circuit 1 =   169.00 kV phase-phase
Voltage circuit 2 =   220.00 kV phase-phase
Power Base        =   100.00 MVA-3phase
Z Base circuit 1  =   285.61 Ohms   I Base circuit 1 = 0.341627 kA
Z Base circuit 2  =   484.00 Ohms   I Base circuit 2 = 0.262432 kA
Z Base mutual     =   371.80 Ohms
Z circuit 1  =    10.00 +j  150.00 Ohms     0.035013 +j0.525192 pu
Z circuit 2  =    12.00 +j  350.00 Ohms     0.024793 +j0.723140 pu
Z mutual     =     0.00 +j   20.00 Ohms     0.000000 +j0.053792 pu
Example 3.9
To illustrate an application for the model we have just derived, let us assume a single-
phase complex transformer in an open circuit condition. Node N and n shorted to 
ground. Values in pu for zAa = j0.1, VA = 1, α = 1 ∠ 0 and β = 1 ∠ 0.
The matrix is obtained as in (3.36); known values are identified for the left and 
for the right hand sides. The information is exchanged by partial inversion from the 
right to left side when pivots 1, 2, and 3 are used; if we stop the partial inversion 
numerical process, we can read the Ybus matrix. If we continue to use pivots 5, 6, 
and 7, we will prepare the matrix that is needed to solve the numerical problem. 
Finally, a multiplication of the partial inverted matrix with the vector of known 
values is used to calculate currents and voltages: iAN, iN, in, IA, Va, VN, and Vn.
Ybus Matrix, after partial inversion process for elements, previous to 
solving for nodal conditions:
Ybus =
        0 -10.0000i        0 +10.0000i        0 +10.0000i        0 -10.0000i
        0 +10.0000i        0 -10.0000i        0 -10.0000i        0 +10.0000i
        0 +10.0000i        0 -10.0000i  10.0000 -10.0000i        0 +10.0000i
        0 -10.0000i        0 +10.0000i        0 +10.0000i  10.0000 -10.0000i
Solution
i(   1) = +0.000000  +0.000000i
i(   2) = +0.000000  +0.000000i
i(   3) = +0.000000  +0.000000i
I(   4) = +0.000000  +0.000000i
V(   5) = +1.000000  +0.000000i
V(   6) = +0.000000  +0.000000i
V(   7) = +0.000000  +0.000000i
Figure 3.8  Mutually coupled circuits and pu values.

3.3	
Single-Phase Transformer Model
73
In case of feeding a load of Ia = −0.5 pu and ZN = 0.1 pu, Vn = 0 (is taken to reference).
i(   1) = +0.500000  +0.000000i
i(   2) = +0.500000  +0.000000i
i(   3) = -0.000000  +0.000000i
I(   4) = +0.500000  +0.000000i 
V(   5) = +0.950000  -0.050000i
V(   6) = +0.050000  +0.000000i
V(   7) = -0.000000  +0.000000i
The values of all nodal voltages, voltage drops on every element, and internal cur-
rents are shown in Figure 3.9:
Vbus =
   1.0000          
   0.9500 - 0.0500i
   0.0000 - 0.0000i
  -0.0500          
velem =
   1.0000 + 0.0000i
   1.0000 - 0.0500i
  -0.0500          
  -0.0500          
   1.0000 + 0.0000i
   1.0000 - 0.0500i
iAN =  0.5000
ian =  0.5000
im  =  0.5000
A different form to incorporate shunt elements is to recognize that the current 
through shunt element is iN = yNVN and in = ynVn. The equations for node N and n 
are modified accordingly.
Figure 3.9  Solution for a single-phase transformer, grounded neutrals.

74
Power Transformer Modeling
	
+yNVN −iAN = IN
+ynVn +
a
b
⎛
⎝⎜
⎞
⎠⎟
∗
iAN = In
	
(3.45)
As iN and in are incorporated to the node current balance, we have a reduced matrix 
as compared to the one in (3.36).
	
−zAa a
2 +1 −a
b
−1
+ a
b
+1
0
0
0
0
−a∗
b∗
0
0
0
0
−1
0
0
+yN
0
+ a∗
b∗
0
0
0
+yn
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
iAN
VA
Va
VN
Vn
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
=
0
IA
Ia
IN
In
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
	
(3.46)
Usually IN and In are zero, as no source injects or drains current from these nodes. 
With this model, various cases can be studied: yN =1/zN where yN → ∞ as zN = 0 
(short circuit) and yN = 0 as zN → ∞ (open circuit).
3.4	
Three-Phase Bank Transformer Model
When a three-phase unit is required to handle power transfer from different voltage 
levels, three single-phase units can be connected in Y or in a Δ arrangement. One 
operating advantage can be to have some flexibility when one of the single-phase 
units has a malfunction, so that a short-term unbalanced situation can be tolerated; 
only the failed component needs to be replaced. We start with the single-phase model 
shown in Figure 3.3; the node connection reflects the Y or the Δ configuration for 
the high voltage and the low voltage sides.
3.4.1	 Three-Phase ΔΔ Bank
Assuming relations for voltages and currents in the single-phase units, the element’s 
equation for the connection in Figure 3.10 can be arranged in a three-phase scheme. 
A compact matrix equation is Ohm’s law (3.48).
	
v1
v2
v3
v4
v5
v6
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
z
m
m
z
z
m
m
z
z
m
m
z
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
i1
i2
i3
i4
i5
i6
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(3.47)

3.4	
Three-Phase Bank Transformer Model
75
	
−[Z]i + v = 0 	
(3.48)
In terms of nodal voltages, the voltage drop v for each element is
	
v1
v2
v3
v4
v5
v6
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
+1 −1
0
0
0
0
0
0
0
+1
0
−1
0
+1 −1
0
0
0
0
0
0
0
+1 −1
−1
0
+1
0
0
0
0
0
0
−1
0
+1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
VA
VB
VC
Va
Vb
Vc
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
= AΔΔVbus
ABC,abc 	
(3.49)
Ohm’s equivalent for the three-phase bank is attained using a shorthand notation 
with AΔΔ as the connectivity matrix. Using (3.48) the model is:
	
−[Z]i + AΔΔVbus
ABC,abc = 0 	
(3.50)
Figure 3.10  A three-phase complex transformer, ΔΔ connection.
Figure 3.11  A three-phase complex transformer, node currents.

76
Power Transformer Modeling
From current information at each node, as given in Figure 3.11, we write the 
nodal currents.
	
IA
IB
IC
Ia
Ib
Ic
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
+1
0
0
0
−1
0
−1
0
+1
0
0
0
0
0
−1
0
+1
0
0
+1
0
0
0
−1
0
−1
0
+1
0
0
0
0
0
−1
0
+1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
i1
i2
i3
i4
i5
i6
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(3.51)
	
Ibus = AΔΔ
t i 	
(3.52)
Results (3.50) and (3.52) are combined as a model that relates nodal voltages to 
nodal currents and currents through each winding with partial inversion applied 
to (3.53), exchanging known and unknown values; with y = Z–1 it results as (3.54). 
We find a three-phase model for a transformer bank connected as ΔΔ at the right 
lower portion of the matrix. The model is a Norton’s equivalent, a 6×6 admit-
tance matrix.
	
−Z
AΔΔ
AΔΔ
t
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
i
Vbus
⎡
⎣⎢
⎤
⎦⎥=
0
Ibus
⎡
⎣⎢
⎤
⎦⎥	
(3.53)
	
y
yAΔΔ
−AΔΔ
t y AΔΔ
t yAΔΔ
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
0
Vbus
⎡
⎣⎢
⎤
⎦⎥=
i
Ibus
⎡
⎣⎢
⎤
⎦⎥	
(3.54)
The 6×6 reduced matrix (3.55) can be solved for nodal voltages or currents in the 
abc domain. The problem can include balanced or unbalanced conditions.
	
YABC
YABC,abc
Yabc,ABC
Yabc
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Vbus
ABC
Vbus
abc
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
Ibus
ABC
Ibus
abc
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(3.55)
Using the symmetrical components transformation, we obtain sequence admittances 
from the primary side P and the secondary side S. Matrix Ts is a 3×3 symmetrical 
transformation, as in (3.22). The symmetrical component model is given by (3.57), 
where the nodal admittance matrix, currents, and voltages are in the symmetrical 
components domain. Sequence admittance values can be read from the admit-
tance matrix and, in the case of a symmetrical matrix, a circuit representation can 
be drawn.
	
Ts
0
0 Ts
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
−1
YABC
YABC,abc
Yabc,ABC
Yabc
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Ts
0
0 Ts
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
V012
P
V012
S
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
I012
P
I012
S
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(3.56)

3.4	
Three-Phase Bank Transformer Model
77
	
Y012
P
Y012
PS
Y012
SP
Y012
S
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
V012
P
V012
S
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
I012
P
I012
S
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(3.57)
3.4.2	 Three-Phase YΔ Bank
To calculate voltages v across elements and currents i that flow at every transformer, 
the matrix equation for the connection of three single-phase units (as shown at 
Figure 3.12) use is made of (3.47) and (3.48). Voltage relations are now (3.58) and 
(3.59), and neutral node N is included. From voltage relations, we write the con-
nectivity matrix. Node current equations in matrix form are obtained from Figure 
3.13, and (3.60) and (3.61) are formed.
	
v1
v2
v3
v4
v5
v6
v7
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
+1
0
0
0
0
0
−1
0
0
0
+1 −1
0
0
0
+1
0
0
0
0
−1
0
0
0
0
+1 −1
0
0
0
+1
0
0
0
−1
0
0
0
−1
0
+1
0
0
0
0
0
0
0
+1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
VA
VB
VC
Va
Vb
Vc
VN
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(3.58)
Figure 3.12  A three-phase complex transformer, YΔ connection.

78
Power Transformer Modeling
	
v = AYΔVbus
ABC,abc,N 	
(3.59)
Now the node current relations are used to write the following set for i and Ibus.
	
IA
IB
IC
Ia
Ib
Ic
IN
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
+1
0
0
0
0
0
0
0
0
+1
0
0
0
0
0
0
0
0
+1
0
0
0
+1
0
0
0
−1
0
0
−1
0
+1
0
0
0
0
0
0
−1
0
+1
0
−1
0
−1
0
−1
0
+1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
i1
i2
i3
i4
i5
i6
i7
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(3.60)
	
Ibus = AYΔ
t i 	
(3.61)
With (3.59) including node N into (3.48), the model for this YΔ connection is com-
plete when we include (3.61) to get (3.62).
	
−Z
AYΔ
AYΔ
t
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
i
Vbus
ABC,abc,N
⎡
⎣
⎢
⎤
⎦
⎥=
0
Ibus
⎡
⎣⎢
⎤
⎦⎥	
(3.62)
Using partial inversion on (3.62) and exchanging the current vector i from the left 
with the vector of zeros at the right, Norton’s equivalent is located in the bottom 
right of the matrix in (3.63), including node N.
	
+y
−yAYΔ
−AYΔ
t y AYΔ
t yAYΔ
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
0
Vbus
ABC,abc,N
⎡
⎣
⎢
⎤
⎦
⎥=
i
Ibus
⎡
⎣⎢
⎤
⎦⎥	
(3.63)
If we are only interested in the three-phase terminals ABC and abc, node N must 
be eliminated. Often IN has a zero value, and one step of the partial inversion will 
do the job and compute the Norton’s equivalent (as seen from the three-phase 
nodes on the high and on the low voltage side of the transformer). After node N 
elimination, the Norton’s equivalent—as seen from the nodes ABC and abc of the 
transformer—is (3.65).
Figure 3.13  A three-phase complex transformer, node currents.

3.4	
Three-Phase Bank Transformer Model
79
	
Ybus
ABC,abc
Ybus
ABC,abc,N
Ybus
N,ABC,abc
YNN
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Vbus
ABC,abc
VN
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
Ibus
ABC,abc
0
⎡
⎣
⎢
⎤
⎦
⎥	
(3.64)
	
Ybus
ABC,abc
⎡⎣
⎤⎦
eq
Vbus
ABC,abc
⎡⎣
⎤⎦=
Ibus
ABC,abc
⎡⎣
⎤⎦	
(3.65)
3.4.3	 Three-Phase YY Bank
Connections for both sides of the single-phase transformer are arranged as in Figure 
3.14. Assuming element relations for voltages and currents, then the matrix element 
equations use (3.47) and (3.48).
In matrix notation, voltage v relations allow us to get a connectivity matrix, 
including nodes n and N.
	
v1
v2
v3
v4
v5
v6
v7
v8
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
+1
0
0
0
0
0
−1
0
0
0
0
+1
0
0
0
−1
0
+1
0
0
0
0
−1
0
0
0
0
0
+1
0
0
−1
0
0
+1
0
0
0
−1
0
0
0
0
0
0
+1
0
−1
0
0
0
0
0
0
+1
0
0
0
0
0
0
0
0
+1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
VA
VB
VC
Va
Vb
Vc
VN
Vn
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(3.66)
Figure 3.14  A three-phase complex transformer, YY connection.

80
Power Transformer Modeling
	
v = AYYVbus
ABC,abc,N,n 	
(3.67)
Node current relations in matrix form are obtained from Figure 3.15. Substitution 
of (3.67) into the general Ohm’s equation (3.48)—together with nodal current equa-
tion (3.69)—will give us a model for the YY connection that is described in (3.70).
	
IA
IB
IC
Ia
Ib
Ic
IN
In
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
+1
0
0
0
0
0
0
0
0
0
+1
0
0
0
0
0
0
0
0
0
+1
0
0
0
0
+1
0
0
0
0
0
0
0
0
0
+1
0
0
0
0
0
0
0
0
0
+1
0
0
−1
0
−1
0
−1
0
+1
0
0
−1
0
−1
0
−1
0
+1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
i1
i2
i3
i4
i5
i6
i7
i8
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(3.68)
	
Ibus = AYY
t i 	
(3.69)
	
−Z
AYY
AYY
t
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
i
Vbus
ABC,abc,N,n
⎡
⎣
⎢
⎤
⎦
⎥=
0
Ibus
⎡
⎣⎢
⎤
⎦⎥	
(3.70)
With partial inversion work on (3.70), we get a Norton’s equivalent, which includes 
both neutral nodes N and n. Norton’s equivalent appears at the lower right side of 
the coefficient matrix.
	
+y
−yAYY
−AYY
t y AYY
t yAYY
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
0
Vbus
ABC,abc,N,n
⎡
⎣
⎢
⎤
⎦
⎥=
i
Ibus
⎡
⎣⎢
⎤
⎦⎥	
(3.71)
If we are only interested in three-phase terminals ABC and abc, nodes N and n 
must be eliminated through partial inversion. Most of the time, IN and In are of 
zero value. After the partial inversion, we get the Norton’s equivalent, as seen from 
Figure 3.15  A three-phase complex transformer, node currents.

3.4	
Three-Phase Bank Transformer Model
81
the three-phase nodes on the high side and from the three-phase nodes on the low 
voltage side of the transformer.
	
Ybus
ABC,abc
Ybus
ABC,abc,N,n
Ybus
N,n,ABC,abc
YNN,nn
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Vbus
ABC,abc
VN,n
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
Ibus
ABC,abc
0
⎡
⎣
⎢
⎤
⎦
⎥	
(3.72)
	
Ybus
ABC,abc
⎡⎣
⎤⎦
eq
Vbus
ABC,abc
⎡⎣
⎤⎦=
Ibus
ABC,abc
⎡⎣
⎤⎦	
(3.73)
Example 3.10
Open Δ or V connection with single-phase transformers (see Figure 3.16).
Assuming the following element relation for voltages v and currents i as (3.74), 
then Ohm’s law as expressed by (3.48) is −zi + v = 0.
	
−
z
m
0
0
m
z
0
0
0
0
z
m
0
0
m
z
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
i1
i2
i3
i4
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
+
v1
v2
v3
v4
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
0
0
0
0
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(3.74)
Voltages across elements v and nodal voltages are related as:
	
v1
v2
v3
v4
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
+1 −1
0
0
0
0
0
0
0
+1 −1
0
0
+1 −1
0
0
0
0
0
0
0
+1 −1
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
VA
VB
VC
Va
Vb
Vc
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
v = AVVVbus 	
(3.75)
Figure 3.16  Complex transformer, open Δ or V connection.

82
Power Transformer Modeling
The node current relations in matrix form are obtained from Figure 3.17. In short-
hand notation, we write (3.77).
	
IA
IB
IC
Ia
Ib
Ic
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
+1
0
0
0
−1
0
+1
0
0
0
−1
0
0
+1
0
0
0
−1
0
+1
0
0
0
−1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
i1
i2
i3
i4
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(3.76)
	
Ibus = AVV
t i 	
(3.77)
Equation (3.74), with reference to the reduced transformer connection, and (3.77) 
into (3.48), the model for open Δ or V is:
	
−Z
AVV
AVV
t
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
i
Vbus
ABC,abc
⎡
⎣
⎢
⎤
⎦
⎥=
0
Ibus
⎡
⎣⎢
⎤
⎦⎥	
(3.78)
Using partial inversion, we find the reduced equivalent, as seen from the three phases 
ABC and abc. The symmetrical component transformation on the Ybus equivalent 
matrix can be applied to calculate the sequence admittances, as shown in the fol-
lowing example where y = Z–1.
	
y
−YAVV
−AVV
t Y
AVV
t YAVV
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
0
Vbus
ABC,abc
⎡
⎣
⎢
⎤
⎦
⎥=
i
Ibus
⎡
⎣⎢
⎤
⎦⎥	
(3.79)
Example 3.11
Consider that for single-phase transformers with a very good magnetic coupling 
k ≈ 1.0
	
m =
L1L2 =
L1
N2
N1
⎛
⎝⎜
⎞
⎠⎟
2
L1 = N2
N1
L1
m = N1
N2
L2 	
(3.80)
Figure 3.17  A three-phase complex transformer, node currents.

3.4	
Three-Phase Bank Transformer Model
83
Assuming that R1 << ωL1 and R2 << ωL2, the inverse matrix y
	
y =
z1 m
m z2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
−1
=
1
z1z2 −m2
z2
−m
−m
z1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(3.81)
Using the following notation:
	
z2
z1z2 −m2 = yt 	
(3.82)
	
m
z1z2 −m2 = N1
N2
L2
z1z2 −m2 = N1
N2
yt 	
(3.83)
	
z1
z1z2 −m2 = N1
N2
m
z1z2 −m2 =
N1
N2
⎛
⎝⎜
⎞
⎠⎟
2
yt 	
(3.84)
The result for the nodal admittance matrix from (3.79) is
	
Ybus = AVV
t ZAVV 	
(3.85)
	
Ybus =
+z2
−z2
0
−m
+m
0
−z2 +2z2 −z2 +m −2m
m
0
−z2
+z2
0
+m
−m
−m
+m
0
+z1
−z1
0
+m −2m +m −z1 +2z1 −z1
0
+m
−m
0
−z1
+z1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
1
z1z2 −m2 	
(3.86)
We write the three-phase nodal matrix using (3.80) to (3.84).
Ybus =
+yt
−yt
0
−N1
N2
yt
+ N1
N2
yt
0
−yt
+2yt
−yt
+ N1
N2
yt
−2 N1
N2
yt
N1
N2
yt
0
−yt
+yt
0
+m
−m
−N1
N2
yt
+ N1
N2
yt
0
+ N1
N2
⎛
⎝⎜
⎞
⎠⎟
2
yt
−N1
N2
⎛
⎝⎜
⎞
⎠⎟
2
yt
0
+ N1
N2
yt
−2 N1
N2
yt
+ N1
N2
yt
−N1
N2
⎛
⎝⎜
⎞
⎠⎟
2
yt
+2 N1
N2
⎛
⎝⎜
⎞
⎠⎟
2
yt
−N1
N2
⎛
⎝⎜
⎞
⎠⎟
2
yt
0
+ N1
N2
yt
−N1
N2
yt
0
−N1
N2
⎛
⎝⎜
⎞
⎠⎟
2
yt
+ N1
N2
⎛
⎝⎜
⎞
⎠⎟
2
yt
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(3.87)

84
Power Transformer Modeling
The Ybus matrix in (3.87) can be partitioned into ABC and abc portions, then the 
symmetrical component transformations can be applied. A P-S notation is used for 
primary and secondary sides of the VV transformer connection.
	
Ybus,012
PS
=
T −1YIT
T −1YIIT
T −1YIIIT T −1YIVT
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(3.88)
Results for product matrices in (3.88) follow:
T −1YIT = ytT −1
+1 −1
0
−1 +2 −1
0
−1 +1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
1
1
1
1 a2
a
1
a
a2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥= yt
0
0
0
0
+2
1∠−120°
0 1∠+ 120°
+2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	
(3.89)
T −1YIIT = −N1
N2
ytT −1
+1 −1
0
−1 +2 −1
0
−1 +1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥T = N1
N2
yt
0
0
0
0
−2
1∠+ 60°
0 1∠−60°
−2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	 (3.90)
T −1YIIIT = −N1
N2
ytT −1
+1 −1
0
−1 +2 −1
0
−1 +1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥T = N1
N2
yt
0
0
0
0
−2
1∠+ 60°
0 1∠−60°
−2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	 (3.91)
T −1YIVT =
N1
N2
⎛
⎝⎜
⎞
⎠⎟
2
ytT −1
+1 −1
0
−1 +2 −1
0
−1 +1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥T =
N1
N2
⎛
⎝⎜
⎞
⎠⎟
2
yt
0
0
0
0
+2
1∠−120°
0 1∠+ 120°
−+ 2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	 (3.92)
The nodal matrix written in sequence quantities—as seen from the high voltage 
side P to the low voltage side S—is:
Ybus,012
PS
= yt
0
0
0
0
0
0
0
+2
1∠−120°
0
−2 N1
N2
+ N1
N2
∠+ 60°
0
1∠+ 120°
+2
0
−N1
N2
∠−60°
−2 N1
N2
0
0
0
0
0
0
0
−2 N1
N2
+ N1
N2
∠+ 60° 0
+2 N1
N2
⎛
⎝⎜
⎞
⎠⎟
2
+ N1
N2
⎛
⎝⎜
⎞
⎠⎟
2
∠−120°
0 + N1
N2
∠−60°
−2 N1
N2
0 + N1
N2
⎛
⎝⎜
⎞
⎠⎟
2
∠+ 120°
+2 N1
N2
⎛
⎝⎜
⎞
⎠⎟
2
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
 

(3.93)
The equivalent nodal matrix in sequence quantities is asymmetrical; this means that 
no equivalent circuit can be drawn. Nodal equation (3.94) will solve for unknowns 

3.5	
Autotransformer Model
85
that depend on nodal operating conditions. When all sequence nodal voltages are 
determined, the transformation Ts will take the values back to ABC and abc quan-
tities. Then the phase currents i, power flows, and losses are calculated.
	
Ybus,012
PS
Vbus,012
PS
= Ibus,012 	
(3.94)
	
Vbus
ABC,abc =
T
0
0 T
⎡
⎣⎢
⎤
⎦⎥
Vbus,012
P
Vbus,012
S
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(3.95)
	
i = Z−1AVVVbus
ABC,abc 	
(3.96)
An equivalent three-phase circuit for VV transformer is given by (3.93).
3.5	
Autotransformer Model
An autotransformer is a device with N1 turns in a common winding arrangement 
and N2 turns in what is considered a series winding. The arrangement will be in 
three phases (see Figure 3.18), but in order to obtain an equivalent model, let’s start 
with a single-phase unit (see Figure 3.19).
The voltage relation from high to low voltage can be defined by an overall turn’s 
ratio N. Our goal is to obtain an equivalent as in Figure 3.20.
Figure 3.18  Circuit of a three-phase VV bank transformer.

86
Power Transformer Modeling
	
Va
VA
= N1 + N2
N1
= 1 + N2
N1
= N 	
(3.97)
Two short circuit impedances can be measured in the real autotransformer:
1.	 ZeH impedance at the high voltage side with N1 shorted; A is shorted to N.
2.	 ZeL impedance at the low voltage side with N2 shorted; A is shorted to a.
When A is shorted to N, in Figure 3.20 we have that the Zat impedance will be 
reflected to the high voltage side as
	
ZeH = ZatN2 	
(3.98)
For the second condition, when A is shorted to a, from Figure 3.21 various relations 
are: VA = Va, IA + Ia = IL, VL = Va/N =VA/N and IL as in (3.99).
Figure 3.19  Single-phase autotransformer.
Figure 3.20  Equivalent for an autotransformer.
Figure 3.21  Equivalent for an autotransformer.

3.5	
Autotransformer Model
87
	
IL = VA −VL
Zat
=
VA −Va
N
Zat
= VA
Zat
1 −1
N
⎛
⎝⎜
⎞
⎠⎟	
(3.99)
For an ideal transformer (no losses) VLIL = VaIa and IA=(1 − 1/N)I, then:
ZeL = VA
IA
=
VA
IL 1 −1
N
⎛
⎝⎜
⎞
⎠⎟
=
VA
VA
Zat
1 −1
N
⎛
⎝⎜
⎞
⎠⎟1 −1
N
⎛
⎝⎜
⎞
⎠⎟
=
Zat
1 −1
N
⎛
⎝⎜
⎞
⎠⎟
2 	
(3.100)
	
Zat = ZeL
(N −1)2
N2
	
(3.101)
From (3.99)
	
ZeH = ZeL(N −1)2 = ZatN2 	
(3.102)
Example 3.13
For a two winding transformer rated 30 kVA, voltage ratio 220V to 125V, and 
operating at 60 Hz, obtain an equivalent circuit for the auto-transformer connec-
tion (see Figure 3.23). The A side is the 220V with impedance (0.20+j0.38) Ω, the 
transformer side a works at 125V with impedance (0.04+j0.08) Ω. The transformer 
is going to be used as autotransformer, as shown in Figure 3.22, to feed a load at 
125V and connected at the high voltage side to a 345V source.
The equivalent impedances referred to the high-voltage side (see Figure 3.24) 
or to the low-voltage side, including the transformation ratio are:
	
ZeqH = ZA + Za
N2
N1
⎛
⎝⎜
⎞
⎠⎟
2
ZeqL = Za +
ZA
N2
N1
⎛
⎝⎜
⎞
⎠⎟
2
	
(3.103)
Using (3.97) as Va/VA = (N1 + N2)/N1 = N, the calculation of the impedance for the 
equivalent autotransformer, from (3.102) is:
Figure 3.22  Equivalent for an autotransformer.

88
Power Transformer Modeling
	
Zat = ZeH
N2 = ZeL
(N −1)2
N2
	
(3.104)
Data for one phase transformer
Primary Voltage      Secondary Voltage       Transf. ratio
    220.00               125.00              1.760000
Primary Impedance           Secondary Impedance
ZA =   0.2000+j   0.3800    Za =   0.0400+j   0.0800
Total Transformer Impedance referred to High Voltage side
ZeqH =   0.3239+j   0.6278
Total Transformer Impedance referred to Low Voltage side
ZeqL =   0.1046+j   0.2027
Auto Transformer
Primary Voltage = 345.0000
Secondary Voltage = 125.0000
Equivalent relation N =   2.7600
Equivalent Impedance for auto
Zat =   0.0425+j   0.0824
Figure 3.23  Autotransformer connections.
Figure 3.24  Equivalent values for the autotransformer.

3.6	
Three Winding Transformer
89
3.6	
Three Winding Transformer
A three winding transformer is a magnetic arrangement that has one primary, one 
secondary, and a tertiary winding in the three-phase configuration. It is assumed 
to be a balanced device and infinite shunt impedance. The primary winding is con-
nected to the source side, the secondary winding might feed a transmission line or 
a load, and the tertiary winding can feed a load, but it is more commonly used to 
connect shunt compensating equipment or filter equipment. To include this device 
in a system’s study, an equivalent is derived.
The three impedance values can be obtained by measurements (see Figure 3.25), 
and then all the impedances are referred to the primary side.
ZPS	 impedance measured at the primary winding, with secondary shorted, 
tertiary open.
ZPT	 impedance measured at the primary winding, with secondary open, ter-
tiary shorted.
Z′ST	 impedance measured at the secondary winding, with primary open, ter-
tiary shorted.
	
ZST =
′
ZST
NP
NS
⎛
⎝⎜
⎞
⎠⎟
2
	
(3.105)
In matrix form and solving for equivalent impedances:
	
1 1 0
1 0 1
0 1 1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
ZP
ZS
ZT
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
ZPS
ZPT
ZTS
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(3.106)
Example 3.13
For a three winding transformer, 60 Hz, with voltages primary 169 kV, secondary 
66 kV, and tertiary 33 kV, there are measured values for impedances, all referred 
Figure 3.25  Three winding transformer circuit representation.

90
Power Transformer Modeling
to by the primary winding (see Figure 3.26). The transformer unit has a 30 MVA 
rating. Find the base current and base impedance at each winding. For a reactor of 
j50 ohms/phase connected to the tertiary winding and a load current of 200A and 
0.8 lagging power factor at the secondary, calculate the primary voltage when the 
secondary voltage has a 1.0 pu value and is considered to be the angular reference. 
Results in Figures 3.27 and 3.28 are for a Y-delta transformation.
Measured impedances, Three winding transformer
ZPS =   0.0000 +j  0.1700 pu
ZPT =   0.0000 +j  0.1100 pu
ZST =   0.0000 +j  0.1000 pu
Per unit Equivalent impedances
ZP  =   0.0000 +j  0.0900
ZS  =   0.0000 +j  0.0800
ZT  =   0.0000 +j  0.0200
Base MVA, KV, Currents and Impedances
MVAB =  30.0000     KVP = 169.0000     KVS =  66.0000     KVT =  33.0000
IPB  = 102.4882 A
ISB  = 262.4319 A
ITB  = 524.8639 A
ZPB  = 952.0333 Ohms
ZSB  = 145.2000 Ohms
ZTB  =  36.3000 Ohms
Impedance in tertiary
ZOhmster   =   0.0000 +j 50.0000 Ohms    Zterpu =   0.0000 +j  1.3774 pu
Secondary current (magnitude pu and angle)
Isecondary =   0.7621    -36.87
Currents(magnitude pu and angle)
Itertiary  =   0.7426    -87.31
Iprimary   =   1.3613    -61.74
Figure 3.26  Equivalent circuit for a three winding transformer.

3.6	
Three Winding Transformer
91
Voltages(magnitude pu and angle)
Vprimary   =   1.1495      5.33
Vsecondary =   1.0000      0.00
Vtertiary  =   1.0229      2.69
Delta Equivalent Impedances(pu)
ZPri_Sec   =   0.0000 +j  0.5300
ZPri_Ter   =   0.0000 +j  0.1325
ZSec_Ter   =   0.0000 +j  0.1178
In three winding transformers, the tertiary winding can be used to supply load, to 
connect a reactive compensating device (as in the Example 3.13), or to connect filter 
arrangements for harmonic suppression.
Figure 3.27  Currents and voltage for a three-winding transformer.
Figure 3.28  Delta equivalent of a three winding transformer; impedances in pu.

92
Power Transformer Modeling
3.7	
Three-Phase Transformer
A three-phase transformer is a magnetic arrangement in which all windings are 
located and are magnetically coupled (see Figure 3.29); in this case, the primitive 
matrix that relates voltage at windings and currents is a full matrix. The self and 
the mutual impedances depend on the common magnetic flux that each winding 
shares with all the other windings in the structure. With no loss in generality, let 
us consider a configuration in which three windings will be connected in Y and the 
other three windings will be connected as Δ.
In matrix notation voltage v, relations to nodal voltages allow us to get the 
connectivity matrix.
	
v1
v2
v3
v4
v5
v6
v7
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
+1
0
0
0
0
0
−1
0
+1
0
0
0
0
−1
0
0
+1
0
0
0
−1
0
0
0
+1 −1
0
0
0
0
0
0
+1 −1
0
0
0
0
−1
0
+1
0
0
0
0
0
0
0
+1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
VA
VB
VC
Va
Vb
Vc
VN
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(3.107)
Figure 3.29  Three-phase transformer; core and windings.
Figure 3.30  A three-phase complex transformer, node currents.

3.7	
Three-Phase Transformer
93
	
v = AYYVbus
ABC,abc,N 	
(3.108)
Node current relations in matrix form are obtained from Figure 3.30 and are:
	
IA
IB
IC
Ia
Ib
Ic
IN
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
+1
0
0
0
0
0
0
0
+1
0
0
0
0
0
0
0
+1
0
0
0
0
0
0
0
+1
0
−1
0
0
0
0
−1 +1
0
0
0
0
0
0
−1 +1
0
−1 −1 −1
0
0
0
+1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
i1
i2
i3
i4
i5
i6
i7
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(3.109)
	
Ibus = AYY
t i 	
(3.110)
With (3.108) and (3.110) the model is built using (3.48).
	
−Z
AYY
AYY
t
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
i
Vbus
ABC,abc,N
⎡
⎣
⎢
⎤
⎦
⎥=
0
Ibus
⎡
⎣⎢
⎤
⎦⎥	
(3.111)
With partial inversion on (3.111), we exchange the current vector i with the array of 
0’s in the right hand side. What is left is a Norton’s equivalent that includes node N.
	
+y
−yAYY
−AYY
t y AYY
t yAYY
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
0
Vbus
ABC,abc,N
⎡
⎣
⎢
⎤
⎦
⎥=
i
Ibus
⎡
⎣⎢
⎤
⎦⎥	
(3.112)
If we are only interested in terminal nodes ABC and abc, node N must be eliminated. 
Most times IN has a value of zero. Additional steps of partial inversion will do the 
job and leave us with a Norton’s equivalent, as seen from the three-phase nodes at 
the high and low voltage sides of the transformer.
	
Ybus
ABC,abc
Ybus
ABC,abc,N
Ybus
N,ABC,abc
YNN
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Vbus
ABC,abc
VN
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
Ibus
ABC,abc
0
⎡
⎣
⎢
⎤
⎦
⎥	
(3.113)
	
Ybus
ABC,abc
⎡⎣
⎤⎦
eq
Vbus
ABC,abc
⎡⎣
⎤⎦=
Ibus
ABC,abc
⎡⎣
⎤⎦	
(3.114)
Example 3.14
For a three-phase transformer, the values of primitive impedances are given in the 
array Z. There is mutual coupling between all windings; given the type of arrange-
ment for the core, values are in pu. The connection is YΔ and the connectivity 

94
Power Transformer Modeling
matrix A has this type of information. Calculate Ybus, including neutral node N 
at the Y side of the transformer. Eliminate node N to get the Ybus,ABC,abc and then 
apply symmetrical components transformation to get the sequence admittances.
Z =
  Columns 1 through 4
   0.0100 + 0.1000i        0 + 0.0400i        0 + 0.0400i        0 + 0.0800i
        0 + 0.0400i   0.0100 + 0.1000i        0 + 0.0400i        0 + 0.0400i
        0 + 0.0400i        0 + 0.0400i   0.0100 + 0.1000i        0 + 0.0400i
        0 + 0.0800i        0 + 0.0400i        0 + 0.0400i   0.0100 + 0.1000i
        0 + 0.0400i        0 + 0.0800i        0 + 0.0400i        0 + 0.0400i
        0 + 0.0400i        0 + 0.0400i        0 + 0.0800i        0 + 0.0400i
        0                  0                  0                  0          
  Columns 5 through 7
        0 + 0.0400i        0 + 0.0400i        0          
        0 + 0.0800i        0 + 0.0400i        0          
        0 + 0.0400i        0 + 0.0800i        0          
        0 + 0.0400i        0 + 0.0400i        0          
   0.0100 + 0.1000i        0 + 0.0400i        0          
        0 + 0.0400i   0.0100 + 0.1000i        0          
        0                  0                  0 + 1.0000i
A =
     1     0     0     0     0     0    -1
     0     1     0     0     0     0    -1
     0     0     1     0     0     0    -1
     0     0     0     1    -1     0     0
     0     0     0     0     1    -1     0
     0     0     0    -1     0     1     0
     0     0     0     0     0     0     1
YbusABCabc =
  Columns 1 through 4
   0.0100 + 0.1000i   0.0000 + 0.0400i   0.0000 + 0.0400i        0 + 0.0400i
   0.0000 + 0.0400i   0.0100 + 0.1000i   0.0000 + 0.0400i        0          
   0.0000 + 0.0400i   0.0000 + 0.0400i   0.0100 + 0.1000i        0 - 0.0400i
        0 + 0.0400i        0                  0 - 0.0400i   0.0200 + 0.1200i
        0 - 0.0400i        0 + 0.0400i        0            -0.0100 - 0.0600i
        0                  0 - 0.0400i        0 + 0.0400i  -0.0100 - 0.0600i
  Columns 5 through 6
        0 - 0.0400i        0          
        0 + 0.0400i        0 - 0.0400i
        0                  0 + 0.0400i
  -0.0100 - 0.0600i  -0.0100 - 0.0600i
   0.0200 + 0.1200i  -0.0100 - 0.0600i
  -0.0100 - 0.0600i   0.0200 + 0.1200i
Ybus, symmetrical components =
Columns 1 through 4
   0.0100 + 0.1800i  -0.0000 - 0.0000i  -0.0000 + 0.0000i        0          
   0.0000 + 0.0000i   0.0100 + 0.0600i   0.0000 - 0.0000i        0 - 0.0000i

3.8	
Alternate Model for a Single-Phase Transformer
95
  -0.0000 + 0.0000i   0.0000 + 0.0000i   0.0100 + 0.0600i        0 + 0.0000i
        0             0.0000 - 0.0000i   0.0000 + 0.0000i   0.0000          
        0             0.0346 + 0.0600i   0.0000                  0 + 0.0000i
  -0.0000             0.0000 - 0.0000i  -0.0346 + 0.0600i        0 - 0.0000i
  Columns 5 through 6
   0.0000 + 0.0000i   0.0000 - 0.0000i
  -0.0346 + 0.0600i  -0.0000 - 0.0000i
   0.0000 + 0.0000i   0.0346 + 0.0600i
   0.0000 - 0.0000i   0.0000 + 0.0000i
   0.0300 + 0.1800i   0.0000 - 0.0000i
   0.0000 - 0.0000i   0.0300 + 0.1800i
Sequence networks, Y side to D side
Ybus0 =
   0.0100 + 0.1800i        0          
        0             0.0000          
Ybus1 =
   0.0100 + 0.0600i  -0.0346 + 0.0600i
   0.0346 + 0.0600i   0.0300 + 0.1800i
Ybus2 =
   0.0100 + 0.0600i   0.0346 + 0.0600i
  -0.0346 + 0.0600i   0.0300 + 0.1800i
Once the model is derived it can be used to study three-phase power transformer 
voltages, currents, and power flows in either balanced or unbalanced cases. The 
neutral can be connected to Earth through a neutral impedance, and then studies 
to determine the transformer electric behavior can be conducted. To account for 
losses, a circuit component can be connected and easily added to the Ybus circuit 
just derived.
3.8	
Alternate Model for a Single-Phase Transformer
A different analysis for a single-phase transformer is considered if we start from 
Figure. 3.31.
Figure 3.31  Alternative circuit for a single-phase transformer.

96
Power Transformer Modeling
	
−1
+yAa
a
2
−yAa
a∗b
−yAa
a
2
+yAa
a∗b
+1
0
0
0
0
−a∗
b∗
0
0
0
0
−1
0
0
0
0
+ a∗
b∗
0
0
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
iAN
VA
Va
VN
Vn
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
=
0
IA
Ia
IN
In
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
	
(3.115)
Example 3.13
Assume a single-phase transformer with values in p.u., yAa = −j10, yN = 0.1, yn = 
0.2, VA = 1 ∠ 0°, α = 1 ∠ 10°, β = 1 ∠ −10° to study the no load condition Ia = 0, 
IN = 0, In = 0
Y  =
  - 1.                      - 10.i  - 3.4202014 + 9.3969262i    10.i
    1.                        0       0                         0   
  - 0.9396926 + 0.3420201i    0       0                         0   
  - 1.                        0       0                         0.1 
    0.9396926 - 0.3420201i    0       0                         0   
    3.4202014 - 9.3969262i  
    0                       
    0                       
    0                       
    0.2
pivots  =  1.    3.    4.    5.
V(   1) =  1.00000000 +j 0.00000000
I(   2) = -0.10000000 +j 0.00000000
I(   3) =  0.00000000 +j 0.00000000
I(   4) =  0.00000000 +j 0.00000000
Y  =
  - 9.861D-31 + 5.551D-17i    4.441D-16 - 1.776D-15i  
  - 9.861D-31 + 5.551D-17i    4.441D-16 - 1.776D-15i  
    0.0342020 + 0.0939693i    0.9396926 - 0.3420201i  
  - 9.861D-30 + 5.551D-16i    4.441D-15 - 1.776D-14i  
    0                         0                       
    0.9396926 + 0.3420201i    4.441D-15 - 1.776D-14i    0   
    0.9396926 + 0.3420201i    4.441D-15 - 1.776D-14i    0   
  - 15. - 0.1i                9.3969262 - 3.4202014i  - 5.  
    9.3969262 + 3.4202014i  -10. - 1.776D-13i           0   
  - 5.                        0                       - 5.  
I(   1) =  0.09396926 +j  0.03420201
V(   2) = -0.56030738 +j -0.35202014

3.9	
Function for the Partial Inversion Algorithm
97
V(   3) =  0.93969262 +j  0.34202014
V(   4) = -0.50000000 +j  0.00000000
3.9	
Function for the Partial Inversion Algorithm
function [W]=inverpark(W, k)
// k -- pivot, diagonal element
// n – number of rows
// m – number of columns
// For square matrices: m=n, this will be in most cases
[n, m]=size(W);
pivot=-1/W(k,k);
// Pivot is modified
W(k,k)=pivot;
// Row pivot is modified (except pivot value)
for j9=1:n
    if j9~=k
       W(k,j9)=W(k,j9)*pivot;
    else
    end
end
for i9=1:n    // Changes for elements not in pivot row or pivot column
    if i9~=k
       for j9=1:n
           if j9~=k
             W(i9,j9)=W(i9,j9)+W(i9,k)*W(k,j9);
           else
           end
       end
    else
    end
end
// Changes to elements in pivot column (except pivot)
for i9=1:n
    if i9~=k
       W(i9,k)=W(i9,k)*pivot;
    else
    end
  end
endfunction
function [W]=pivoteo(W, pivotes)
  // Function to conduct partial inversion process
  // pivot number is needed and which are those pivots
  // results are on matrix W
  npiv=length(pivotes);
for k9=1:npiv
  k=pivotes(k9);
  [W]=inverpark(W,k);

98
Power Transformer Modeling
end
endfunction
function y=solucpark(W, x, y, pivotes)
// k -- pivot, on the diagonal of the matrix
// n – number of rows
// m – number of columns
// For square matrices m=n, this is assumed as true 
// npiv – number of pivots (might go from 1 to n)
// x information vector that might have zeroes in pivot and known 
//    values in those that are not pivots
// y is a vector with a known value in the pivots, they might be zero  
//    in those that are no pivots 
// they will be calculated in the solution process
[n,m]=size(W);
npiv=length(pivotes);
// Information Exchange in the pivot, with the NEGATIVE 
// All the known values will stay in the x vector
for j9=1:npiv
    k=pivotes(j9);
    x(k)=-y(k);
end
// By matrix multiplication by the vector of known values we calculate  
//    the unknowns
y=W*x;
endfunction
References
[1]	
Stagg, G., and A. E. El-Abaid, Computer Methods in Power System Analysis, New York: 
McGraw-Hill Inc., 1968.
[2]	
Brown, H. E., Solution of Large Networks by Matrix Methods, New York: John Wiley 
& Sons, 1975.
[3]	
Shipley, R. B., Introduction to Matrices and Power Systems, New York: John Wiley & 
Sons, 1976.
[4]	
Clarke, E., Circuit Analysis of AC Power Systems, Volume I: Symmetrical and Related 
Components, Schenectady, New York: John Wiley & Sons, 1943.
[5]	
Elgerd, O. I., Electric Energy Systems Theory, New York: McGraw-Hill Book Company, 
1971.
[6]	
Chen, M. S., and W. E. Dillon, “Power System Modelling,” Proc. IEEE, Vol. 62, 1974, 
pp. 901–915.

99
C h a p t e r  4
Transmission Line and Cable 
Modeling
4.1	
Introduction
High-voltage transmission lines mainly operating in AC are required in order to 
transport energy from electric power plants scattered over a territory where primary 
energy sources are located in order to reach the consumption places. The principles 
under which this is possible are based on electromagnetic laws and concepts associ-
ated with Ampere’s, Faraday’s, and Gauss’s laws. The value of series impedance that 
a transmission line presents when power has to flow from the sending to the receiv-
ing end is of paramount importance. The shunt admittance is a key component for 
long distance lines operating at high voltage and cables. Several considerations are 
applied to derive a useful transmission line model for a three-phase system and the 
working models to simplify calculations when a balanced condition is met.
4.2	
Series Inductance
In this section, we apply Faraday’s law of induced voltage and Ampere’s law as the 
departing point to characterize, in various steps and with circuit interpretation, the 
electromagnetic phenomena of sending current through a conductor, and as a con-
sequence, electric power from the power plants to load centers, usually at various 
hundreds of kilometers away. The series impedance of transmission lines is pres-
ent at low frequencies (50 Hz or 60 Hz for most AC electric power systems in the 
world). This will be characterized through the procedures that are explained in this 
chapter. Series impedance is composed of resistance RL and reactance XL. To obtain 
the series inductance, we start using Ampere’s law with the following assumptions:
• A straight and cylindrical shape conductor with uniform current distribu-
tion, and
• Earth as a return path for current that flows in a conducting arrangement.
The initial discussion is for a single conductor and its return path. We then gener-
alize the results to include arrangements of multiple conductors in single-phase or 
three-phase arrangements.

100
Transmission Line and Cable Modeling
4.2.1	 Single Conductor
The series inductance for a single conductor transmission line can be derived assum-
ing a single-phase conductor and its return path in parallel but at a great distance. 
In a linear magnetic environment, the magnetic flux linkages λ (webers-turn) and 
inductance L (henrys) at any instant of time t are related to current i (amperes) by
	
L = l
i 	
(4.1)
To relate geometry, magnetic media properties, and circuit representation using 
current i, voltage v, and magnetic flux φ we start with Ampere’s law:
	
H ⋅dl
!∫
= ienclosed 	
(4.2)
!
H 	 Magnetic field intensity, amperes/m
dl	
Vector of differential distance along the circular trajectory, m
i	
current in amperes
The intensity of the magnetic field H (A/m) for the conductor in Figure 4.1 has 
two parts:
Hint for a trajectory internal to the conductor and up to radius x (in this case, 
only a portion of the total current is enclosed; see Figure 4.2), assum-
ing uniform current distribution the proportion of current enclosed has 
a ratio πx2/πR2, and Hext is for a trajectory external to the conductor’s 
radius r(m). In this case, all of the circulating current i (amperes) flows 
within the conductor. Distances r and x are in meters.
Figure 4.2  Magnetic field intensity outside and inside a round conductor. 
Figure 4.1  Conductor carrying current i.

4.2	
Series Inductance
101
	
Hint =
1
2px
px2
pR2 i 	
(4.3)
	
Hext =
1
2pr i 	
(4.4)
We write the magnetic flux density B (Wb/m2) as μH for each component in (4.3) 
and (4.4). In what follows, μ0 = 4π × 10–7 H/m is the magnetic permeability for 
free space and μ = μoμr for any magnetic flux in a magnetic material; μr is the rela-
tive permeability.
	
Bint = momr
x
2pR2 i 	
(4.5)
	
Bext = mo
1
2pr i 	
(4.6)
Flux linkages λ (Wb-turns) to be used in (4.1) are products of the magnetic flux ϕ 
(Wb) multiplied by the number of turns of the coil structure. To find the total flux 
ϕ, we write a differential flux dϕ and integrate it over the area with a length of 1 m 
along the conductor (see Figure 4.3). The equivalent turns N inside the conductor 
are taken as x2/R2, due to the uniform current distribution assumption. The number 
of turns for the trajectory outside the conductor is N = 1. The internal differential 
flux linkages (4.7) are integrated inside the conductor with μr = 1 for nonmagnetic 
materials, such as copper and aluminum. For the external differential flux linkages, 
(4.8) with μ0 is integrated outside of the conductor from the radial distance R up 
to a distance S (in meters).
	
dlint = BintdA = momrNi
2pR2 xdx 	
(4.7)
	
dlext = BextdA = mo
Ni
2p
dr
r 	
(4.8)
Figure 4.3  Round conductor and its external geometry, 1 m length along the conductor.

102
Transmission Line and Cable Modeling
	
lint =
moi
2pR4
x3 dx
0
R
∫
= moi
8p 	
(4.9)
	
lext = mo
i
2p
dr
r
R
S
∫
= moi
2p ln
S
R
⎛
⎝⎜
⎞
⎠⎟	
(4.10)
For the single conductor in Figure 4.1
	
Ltot = lext
i
+ lext
i
= mo
8p + mo
2p ln
S
R
⎛
⎝⎜
⎞
⎠⎟	
(4.11)
	
Ltot = mo
2p
1
4 + ln
S
R
⎛
⎝⎜
⎞
⎠⎟
⎡
⎣⎢
⎤
⎦⎥= mo
2p ln
S
Re−1/4
⎛
⎝⎜
⎞
⎠⎟= mo
2p ln
S
GMR
⎛
⎝⎜
⎞
⎠⎟	
(4.12)
GMR  Equivalent radius of the solid conductor with radius R is  
Re–1/4 = 0.7788 R
4.2.2	 Inductance for a Set of Aerial Conductors
One practical arrangement for a transmission line is a set of parallel conductors 
carrying a net zero current; some conductors will carry current +i in the forward 
direction and other conductors will bring back the current, −i. Consider three 
conductors (see Figure 4.4) in the line transmission array so that the combined net 
flux linkages at a given point (xp,yp) is calculated by superposition according to the 
linear nature of the media where the conductors are located.
Figure 4.4  Set of three parallel conductors; 1 m length.

4.2	
Series Inductance
103
The flux linkages due to i1, i2, and i3 at point p with coordinates (xp, yp). Dis-
tances dpk, xp, yp are in meters, then
	
lp1
lp2
lp3
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
moi1
2p ln
S
dp1
⎛
⎝⎜
⎞
⎠⎟
moi2
2p ln
S
dp2
⎛
⎝⎜
⎞
⎠⎟
moi3
2p ln
S
dp3
⎛
⎝⎜
⎞
⎠⎟
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(4.13)
	
dpk =
xp −xk
(
)
2
+ yp −yk
(
)
2
k = 1,2,3 	
(4.14)
The total flux linkages at point p(xp, yp), λtot,p shows that when i1 + i2 + i3 = 0 the 
flux linkages due to currents i1, i2, and i3 will be:
	
ltot,p = lp1 + lp2 + lp3 = mo
2p
ln
1
dp1
⎛
⎝⎜
⎞
⎠⎟ln
1
dp2
⎛
⎝⎜
⎞
⎠⎟ln
1
dp3
⎛
⎝⎜
⎞
⎠⎟
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
i1
i2
i3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	 (4.15)
Equation (4.15) can be used to calculate the total flux linkages when the point p is 
moved to be coincident with the geometrical center of each conductor, one at a time, 
as point p = 1, 2 and 3. The geometric mean radius (GMR) is the mean geometric 
distance for each conductor; for more detail, please take a look at Section 4.6.
	
ltot,1
ltot,2
ltot,3
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
= mo
2p
ln
1
d11
⎛
⎝⎜
⎞
⎠⎟
ln
1
d12
⎛
⎝⎜
⎞
⎠⎟
ln
1
d13
⎛
⎝⎜
⎞
⎠⎟
ln
1
d21
⎛
⎝⎜
⎞
⎠⎟ln
1
d22
⎛
⎝⎜
⎞
⎠⎟ln
1
d23
⎛
⎝⎜
⎞
⎠⎟
ln
1
d31
⎛
⎝⎜
⎞
⎠⎟ln
1
d32
⎛
⎝⎜
⎞
⎠⎟ln
1
d33
⎛
⎝⎜
⎞
⎠⎟
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
i1
i2
i3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(4.16)
Equation (4.16) allows us to recognize that along the main diagonal d11 = GMR1, 
d22 = GMR2, and d33 = GMR3, and that the flux linkages depend on the geometric 
arrangement of the conductors. The notation ln means natural logarithms that are 
to be taken to each element in the matrix. GMRk must have the same distance units 
as the distance dkj (meters). The coefficient matrix in (4.16) can be called a geometric 
inductance matrix. The next step is to obtain the series reactance matrix. Accord-
ing to Faraday’s law, the induced voltage in phasor form, assuming AC steady state 
operation, is (4.18).

104
Transmission Line and Cable Modeling
	
[L] = mo
2p ln
1/GMR1
1/d12
1/d13
1/d21
1/GMR2
1/d23
1/d31
1/d32
1/GMR2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(4.17)
	
ΔV = jw[L]i 	
(4.18)
When frequency f is 60 Hz and μo = 4π × 10–7 H/m, a factor in Ω/km can be used 
as ωμ0/2π = 0.4 fπ 10–3 = 0.075398.
Example 4.1
Calculate the reactance matrix in Ω/km for a transmission line that has an arrange-
ment with three conductors (see Figure 4.5). Distance values are shown in meters. Fre-
quency f = 60 Hz, reactance in ohms/km. Here, code 0 means a retained conductor, 
−1, is a ground wire that (in this arrangement) is considered to be a return conductor.
Number of conductors =    3   Frequency =   60 Hz
  i         x(i)        y(i)            GMR(i)         code(i)
  1        0.000       8.000         1.000000e-002       0
  2        4.000       8.000         1.000000e-002       0
  3        8.000       8.000         5.000000e-003      -1
Inductance matrix L, henrys/km
  1.0e-005 *
   0.09210340371976  -0.02772588722240  -0.04158883083360
  -0.02772588722240   0.09210340371976  -0.02772588722240
  -0.04158883083360  -0.02772588722240   0.10596634733096
Xinduc, in Ω/km
   0.34722165179594  -0.10452413233457  -0.15678619850186
  -0.10452413233457   0.34722165179594  -0.10452413233457
  -0.15678619850186  -0.10452413233457   0.39948371796323
With a closer look into numerical results, we observe that the reactance matrix is 
not exactly symmetrical. This is due to the geometry at which the conductors are 
Figure 4.5  Set of three parallel conductors; simple transmission line. 

4.2	
Series Inductance
105
located and not forming an equilateral triangle. More will be said in Section 4.2.5 
on how to calculate the total inductance and how to build symmetry in three-phase 
arrangement of transmission line conductors.
4.2.3	 Set of Bundled Conductors
In various situations, two or more conductors make a bundle. In such cases, we might 
be required to calculate the arrangement’s equivalent impedance; the equivalent 
impedance can replace the arrangement with an equivalent conductor. The physical 
constraints that must be met are illustrated in Figure 4.6. To explain the constraint 
that this bundle has, consider that conductors 1 and 3 operate in parallel. There are 
two constraints listed as (4.19): one for the voltage drop along the line and one for 
the total current that the bundled conductors must handle. Let us assume that the 
unreduced series impedance matrix for all three conductors as in (4.20).
	
ΔV3 = ΔV1
′I1 = I1 + I3
	
(4.19)
	
z11 z12
z13
z21 z22 z23
z31 z32 z33
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
I1
I2
I3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
ΔV1
ΔV2
ΔV3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(4.20)
To comply with the first constraint, voltages should be ΔV3 = ΔV1. To comply with 
this condition we subtract the first row components to the third row. The modified 
matrix equation follows.
	
z11
z12
z13
z21
z22
z23
z31 −z11 z32 −z12 z33 −z13
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
I1
I2
I3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
ΔV1
ΔV2
ΔV3 −ΔV1
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
ΔV1
ΔV2
0
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	 (4.21)
Figure 4.6  Set of parallel conductors, 1 and 3 make up a bundle.

106
Transmission Line and Cable Modeling
The current constraint in (4.19) requires that the total current I′1 on the equivalent 
conductor should be I1 + I3. This current expression multiplies elements of the first 
column; in order to keep an unaltered system of equations, we must subtract the 
appropriate term from the third column. One further step is required—a partial 
inversion procedure to interchange current I3 and 0 in (4.22). The matrix is modi-
fied by the partial inversion to be as in (4.23). The equivalent impedance matrix 
for the two remaining conductors is a 2×2 array, which we take out of the upper 
left array in (4.23).
	
z11
z12
z13 −z11
z21
z22
z23 −z21
z31 −z11 z32 −z12 z33 −2z13 + z11
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
I1 + I3
I2
I3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
ΔV1
ΔV2
0
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(4.22)
	
′z11
′z12
′
m13
′z21
′z22
′
m23
′
m31
′
m32
y33
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
′I1
I2
0
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
ΔV1
ΔV2
I3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(4.23)
Example 4.2
An arrangement of conductors is comprised of a single-phase transmission line, three 
main wires, and a return circuit with two conductors, each with its own GMR (see 
Figure 4.7). The equivalent reduced impedance matrix is obtained and then the total 
line impedance in Ω/km is calculated. In our case, a simple code helps us identify 
which conductors form a bundle; zero is assigned for a retained conductor, and 1 
or 2 identifies which main conductor is associated with.
Number of conductors =    5
Frequency =   60
i        x(i)        y(i)          GMR(i)           res(i)        code(i)
 1        0.000      12.192      1.978154e-003     0.000000e+000       0
 2        9.144      12.192      3.956308e-003     0.000000e+000       0
 3        0.000       6.096      1.978154e-003     0.000000e+000       1
 4        0.000       0.000      1.978154e-003     0.000000e+000       1
 5        9.144       6.096      3.956308e-003     0.000000e+000       2
z  =
    0.4694967i  - 0.1668986i  - 0.1363208i  - 0.1885938i  - 0.1807644i  
  - 0.1668986i    0.4172237i  - 0.1807644i  - 0.2054220i  - 0.1363208i  
  - 0.1363208i  - 0.1807644i    0.4694967i  - 0.1363208i  - 0.1668986i  
  - 0.1885938i  - 0.2054220i  - 0.1363208i    0.4694967i  - 0.1807644i  
  - 0.1807644i  - 0.1363208i  - 0.1668986i  - 0.1807644i    0.4172237i  
Zreduc  =
    0.0535995i  - 0.1804456i  
  - 0.1804456i    0.1400643i  

4.2	
Series Inductance
107
The circuit interpretation for the reduced impedance values in ohms/km is given 
in Figure 4.8.
	
zaa zab
zba zbb
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Ia
Ib
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
ΔVa
ΔVb
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(4.24)
The current condition is that Ib = −Ia, so the total impedance is calculated as:
	
ztot = ΔV
Ia
= ΔVa −ΔVb
Ia
=
zaa −zab
(
)Ia −zba −zbb
(
)Ia
Ia
	
(4.25)
	
ztot = (0.0535995i + 0.1804456i)Ia −(−0.1804456i −0.1400643i)Ia
(
)
Ia
	
ztot = 0.554555i  Ω/km 	
4.2.4	 Ground Wire Inclusion
In transmission line models, we start including all of the wires that form the trans-
mission line arrangement. In most studies, we only need the three-phase abc values; 
therefore, its equivalent series impedance should be obtained. If the ground wires 
Figure 4.7  Transmission arrangement and geometry for conductors.
Figure 4.8  Set of parallel conductors, interpretation of the equivalent impedance.

108
Transmission Line and Cable Modeling
do exist, they can be eliminated by imposing boundary conditions in terms of volt-
ages and currents and by the use of the Gaussian elimination (partial inversion) 
process, the reduced model is attained. In Figure 4.9, n is considered a neutral wire, 
grounded at its extremes; let us assume an arrangement of phase conductors abc and 
one ground wire n. Boundary conditions for the ground wire are In ≠ 0, ΔVn = 0.
	
zaa zab zac
zan
zba zbb zbc
zbn
zca
zcb
zcc
zcn
zna znb znc znn
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
Ia
Ib
Ic
In
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
ΔVa
ΔVb
ΔVc
0
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(4.26)
One step of partial inversion in (4.26) will exchange In from the left hand side with 
the zero value for the voltage drop on the right side of the matrix. The result is:
	
′zaa
′zab
′zac
−zan /znn
′zba
′zbb
′zbc
−zbn /znn
′zca
′zcb
′zcc
−zcn /znn
−zna/znn −znb /znn −znc /znn
−1/znn
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
Ia
Ib
Ic
0
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
ΔVa
ΔVb
ΔVc
In
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(4.27)
The primed values are equivalent impedances after the elimination of the ground 
wire; its new values mathematically reflect this step. The reduced equivalent for the 
phase conductors abc is:
	
′zaa
′zab
′zac
′zba
′zbb
′zbc
′zca
′zcb
′zcc
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
Ia
Ib
Ic
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
ΔVa
ΔVb
ΔVc
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(4.28)
If for any reason the neutral current In needs to be calculated, this can be done by 
an expression out of (4.27) once the phase currents are known.
Figure 4.9  Set of conductors abc and a ground wire n.

4.2	
Series Inductance
109
	
In = −zna
znn
⎛
⎝⎜
⎞
⎠⎟Ia −
znb
znn
⎛
⎝⎜
⎞
⎠⎟Ib −
znc
znn
⎛
⎝⎜
⎞
⎠⎟Ic 	
(4.29)
When several ground wires are part of the arrangement, the partial inversion pro-
cedure is repeated as many times as ground wires are present.
Example 4.3
For Example 4.1 calculate the reduced reactance matrix assuming that the rightmost 
conductor is a ground wire.
Reduced Inductance matrix Ohms/km
Xreduc =
   0.34722165179594  -0.10452413233457
  -0.10452413233457   0.34722165179594
4.2.5	 Line Transposition
In practice, power system engineers try to design and operate their transmission 
lines in a balanced condition. To come close to having a balanced condition (from 
the point of view of the geometric distances), some conductor rearrangement is 
practiced. If conditions are favorable, a change in abc arrangement is conducted at 
distances 1/3 and 2/3 of the total length of the transmission line.
The first segment can be labeled as abc sequence, the second as cab, and the 
third as bca (as depicted in Figure. 4.10). Ideal geometrical consideration can be 
put into practice from the sending to the receiving end; then, the line will be nearly 
balanced (perfectly balanced only if conductors are at the corners of an equilateral 
triangle, which hardly happens in a real situation).
The calculation of impedance values start with the first section in order abc, 
followed by a physical arrangement as cab for the second section. The abc order is 
rearranged as the second section by a premultiplication by matrix R2 and a post-
multiplication by the transpose of R2.The original array abc turns to be cab.
R2ZabcR2
t =
0 0 1
1 0 0
0 1 0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
zaa zab zac
zba zbb zbc
zca
zcb
zcc
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
0 1 0
0 0 1
1 0 0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥=
zcc
zca
zcb
zac zaa zab
zbc zba zbb
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(4.30)
A transformation matrix R3 and its transpose will change the original abc arrange-
ment into third section bca in Figure 4.10.
Figure 4.10  Transmission line transposition at every 1/3 of its length.

110
Transmission Line and Cable Modeling
R3ZabcR3
t =
0 1 0
0 0 1
1 0 0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
zaa zab zac
zba zbb zbc
zca
zcb
zcc
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
0 0 1
1 0 0
0 1 0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥=
zbb zbc zba
zcb
zcc
zca
zab zac zaa
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(4.31)
The impedance matrix for the total length of the transposed transmission line will 
be obtained in general as in (4.32), considering section lengths l1, l2, and l3 to make 
the total line length long.
	
Ztot = long l1Zabc + l2R2ZabcR2
t + l3R3ZabcR3
t
(
) 	
(4.32)
Example 4.4
Assuming a reactance matrix in ohms for a three-phase conductors and in each 
section as:
	
Zabc = j
5.1
4
2
4
5.2
3
2
3
5.3
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
Find the total reactance if the transposed arrangement is done at 1/3 of the total length.
Z = j*
    5.1000    4.0000    2.0000
    4.0000    5.2000    3.0000
    2.0000    3.0000    5.3000
R2 =
     0     0     1
     1     0     0
     0     1     0
R3 =
     0     1     0
     0     0     1
     1     0     0
ZT1 = j*
    5.3000    2.0000    3.0000
    2.0000    5.1000    4.0000
    3.0000    4.0000    5.2000
ZT2 = j*
    5.2000    3.0000    4.0000
    3.0000    5.3000    2.0000
    4.0000    2.0000    5.1000
Ztotal = j*
    5.2000    3.0000    3.0000
    3.0000    5.2000    3.0000
    3.0000    3.0000    5.2000

4.2	
Series Inductance
111
4.2.6	 Sequence Impedances
In many instances, after the phase equivalent impedances abc are obtained, one 
more step is required to find the zero, positive, and negative sequence impedances 
for the transmission line. The voltage drop on the abc phases can be transformed 
to the 012 sequence domain. This is done using the symmetrical transformation 
matrix TS and TS
–1 in (3.22).
	
ΔVa
ΔVb
ΔVc
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
′zaa
′zab
′zac
′zba
′zbb
′zbc
′zca
′zcb
′zcc
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
Ia
Ib
Ic
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(4.33)
	
Iabc = TSI012
ΔVabc = TSΔV012
	
(4.34)
	
ΔV0
ΔV1
ΔV2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
= TS
−1
′zaa
′zab
′zac
′zba
′zbb
′zbc
′zca
′zcb
′zcc
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
TS
I0
I1
I2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(4.35)
	
Z012 = TS
−1
′zaa
′zab
′zac
′zba
′zbb
′zbc
′zca
′zcb
′zcc
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
TS 	
(4.36)
The impedance transformation (4.36) from abc to 012 is a step from which the zero, 
positive and negative sequence impedances for a transmission line are determined. 
For the completely transposed line its sequence impedance are decoupled; no mutual 
impedances among sequences. In the case of three-phase lines with double circuit, 
ground wires are eliminated, bundled conductors are reduced to an equivalent 
conductor, and transpositions arrangements are worked out. An equivalent phase 
impedance matrix 6×6 is then obtained.
	
Zabc
eq =
Zabc
I
Zabc
I,II
Zabc
II,I
Zabc
II,II
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(4.37)
To find the sequence values of impedances 012 for this type of transmission line, 
symmetrical component transformation is carried out as shown in (4.38).
	
Z012
eq
=
TS
−1
0
0
TS
−1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Zabc
I
Zabc
I,II
Zabc
II,I
Zabc
II,II
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
TS
0
0
TS
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(4.38)
TS and TS
–1 are the matrix of the symmetrical component transformation and its 
inverse; each one of the matrices in (4.38) are 3×3 matrices. The importance of this 

112
Transmission Line and Cable Modeling
discussion is that all mutual effects among positive and negative sequence imped-
ances are zero, except the mutual effect between the zero sequence for circuit 1 and 
the zero sequence for circuit 2. This mutual value is important when zero sequence 
current flows in one circuit (i.e., due to unbalanced fault, which we will cover in 
Chapter 9, and induces zero sequence voltage in the neighboring circuit.
4.3	
Earth Return
Practical transmission lines are suspended above Earth by insulation arrange-
ments supported by steel or pole structures with a finite height with respect to 
an ideal flat surface; Earth itself might be used as a current return path. Early in 
the last century, Carson, Rudenberg, and other researchers studied this operating 
condition using theoretical considerations and measurements that were conducted 
on existing communication lines [1, 4–6]. As a result, for unbalanced operating 
condition, Earth can be represented by an equivalent conductor with resistance, 
self, and mutual reactance that depends on frequency f in Hz and soil resistivity 
ρ in Ω-m. Various expressions were derived and published in the open literature 
by Rudenberg, Carson, and Clarke [1] as a way to include Earth return correction 
terms to the geometric inductance, which is calculated under the assumptions 
established in (4.17).
The system’s frequency f in Hz and the earth resistivity influence the equivalent 
depth De of the equivalent earth conductor. A value of resistance Rd is also present.
	
De = 658.37
r
f   m 	
(4.39)
	
Rd = p2 × 10−4f = 9.869 × 10−4f   Ω/km 	
(4.40)
Carson’s result for the field equation was obtained as a series expansion, so the first 
term in the series is known as first correction [4, 5]. The series impedance matrix for 
a three-phase arrangement of conductors includes resistance and some correction 
terms to the resistance and the reactance as in (4.41) (see Figure 4.11).
	
zaa zab zac
zba zbb zbc
zca
zcb
zcc
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
raa
0
0
0
rbb
0
0
0
rcc
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
+ Rd
1 1 1
1 1 1
1 1 1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
+j mow
2p Ln
1/GMR1
1/d12
1/d13
1/d21
1/GMR2
1/d23
1/d31
1/d32
1/GMR2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
+
De
1 1 1
1 1 1
1 1 1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
⎧
⎨⎪
⎩⎪
⎫
⎬⎪
⎭⎪
⎧
⎨
⎪
⎩
⎪
⎫
⎬
⎪
⎭
⎪
	
(4.41)
To have a sense of the numerical difference in transmission line impedance calcu-
lation when no return path is included, assuming a perfectly balanced geometric 
configuration, and when we recognize the unbalanced nature of the line due to 

4.3	
Earth Return
113
nonsymmetric geometry in the conductors arrangement, we provide the follow-
ing example.
Example 4.5
For a temperature of 25°C, an arrangement of three copper conductors, 250 MCM, 
and 12 strands are in a horizontal arrangement (see Figure 4.11). The line length is 
65 km, Earth is used as return path, and the transmission line operates at 60 Hz. 
Conductor’s diameter is 0.6 in (0.01524 m), the GMR as listed by the manufacturer 
is 0.01902 ft (0.005792 m), resistance at 25°C is 0.257 Ω/mi (0.159727 Ω/km), 
and current carrying capacity of 540 Amps. Earth resistivity ρ = 100 Ω-m and no 
transposition. Calculate the total series impedance matrix in ohms/km using the 
geometric inductance only.
In a second step, include the first Carson’s correction (4.41) to include Earth 
return, which is required when we have an unbalanced condition; this is the case 
due to the horizontal arrangement of the phase abc conductors.
Number of conductors =    3
Frequency   =   60   Resistivity =  100    long  = 65.0
i         x(i)        y(i)          GMR(i)           res(i)        code(i)
 1        0.000      14.000      5.797296e-003     1.597265e-001       0
 2        3.000      14.000      5.797296e-003     1.597265e-001       0
 3        6.000      14.000      5.797296e-003     1.597265e-001       0
De  = 849.94943
Rd  =   0.059214
Zreduc  =
 0.2189405 + 0.8970903i    0.059214  + 0.4258300i     0.059214  + 0.3735570i
 0.059214  + 0.4258300i    0.2189405 + 0.8970903i     0.059214  + 0.4258300i
 0.059214  + 0.3735570i    0.059214  + 0.4258300i     0.2189405 + 0.8970903i
Example 4.6
Apply the transposition arrangement shown in Figure 4.8 to the conductor’s in 
Example 4.5 at exactly 1/3 of its total length for the second section and at 2/3 for 
Figure 4.11  Transmission line arrangement to calculate series impedance.

114
Transmission Line and Cable Modeling
the third section. Calculate the 012 sequence impedance values for the transmission 
line once the transposition is carried out.
logtransp  = 0.3333333    0.3333333    0.3333333
ZT1 =
  14.2311 +58.3109i   3.8489 +24.2812i   3.8489 +27.6790i
   3.8489 +24.2812i  14.2311 +58.3109i   3.8489 +27.6790i
   3.8489 +27.6790i   3.8489 +27.6790i  14.2311 +58.3109i
ZT2 =
  14.2311 +58.3109i   3.8489 +27.6790i   3.8489 +27.6790i
   3.8489 +27.6790i  14.2311 +58.3109i   3.8489 +24.2812i
   3.8489 +27.6790i   3.8489 +24.2812i  14.2311 +58.3109i
Ztot  =
  14.231135 + 58.310869i    3.84891  + 26.54637i     3.84891  + 26.54637i
   3.84891  + 26.54637i    14.231135 + 58.310869i    3.84891  + 26.54637i
   3.84891  + 26.54637i     3.84891  + 26.54637i    14.231135 + 58.310869i
Z012 =  1.0e+002 *
   0.2193 + 1.1140i  -0.0000 - 0.0000i  -0.0000 - 0.0000i
        0 + 0.0000i   0.1038 + 0.3176i  -0.0000 - 0.0000i
   0.0000 + 0.0000i   0.0000 + 0.0000i   0.1038 + 0.3176i
Carson’s equations were modified by Clarke and gave a more elaborate set of equa-
tions [1, 4]. Later, various authors contributed to the formulas that can be consulted 
in the references [4–6]. Corrections higher than the first order can be included; 
this step is specifically needed when transmission line studies are to be related to 
high-order harmonics in the power system and for frequency response studies of 
the transmission line.
Carson proposed an infinite series solution to the field equations and Clarke 
modified the expressions [1]. The proposed series converges rather quickly for values 
of constant k in transmission lines at 60 Hz or less, for k ≤ 1 when conductors are 
located at coordinates (x, h) in meters as shown in Figure 4.12. The k values are 
calculated depending on the self (own conductor) or mutual (between two conduc-
tors) and are used in (4.45) and (4.46), respectively.
Figure 4.12  Geometric distances of conductors and their images below the Earth plane.

4.3	
Earth Return
115
	
kself = 4pha
2f
r
q = 0 	
(4.42)
	
kmutual = 2pSab
2f
r
q = cos−1 ha + hb
Sab
⎛
⎝⎜
⎞
⎠⎟	
(4.43)
	
Sab =
xb −xa
(
)
2 + ha + hb
(
)
2 	
(4.44)
	
ZP = p
8 −
1
3 2 cosθ + k2
16 cos2q 0.6728 + ln 2
k
⎛
⎝⎜
⎞
⎠⎟
⎛
⎝⎜
⎞
⎠⎟+ k2
16 qsin2q
+
k3
45 2 cos3q −
pk4
1,536 cos4q + …
	
(4.45)
	
ZQ = −0.0386 + 1
2 ln 2
k
⎛
⎝⎜
⎞
⎠⎟+
1
3 2 kcosq −pk2
64 cos2q +
k3
45 2 cos3q
−k4
384 qsin4q −k4
384 cos4q 1.0895 + ln 2
k
⎛
⎝⎜
⎞
⎠⎟
⎛
⎝⎜
⎞
⎠⎟+ …
	 (4.46)
The results (4.45) and (4.46) are to be used in the impedance calculation (4.47) 
and (4.48).
	
Zaa,g = zaa + j2wln 4ha
d
⎛
⎝⎜
⎞
⎠⎟+ 4w ZP + jZQ
(
) 	
(4.47)
	
Zab,g = j2wln Sab
sab
⎛
⎝⎜
⎞
⎠⎟+ 4w ZP + jZQ
(
)	
(4.48)
zaa	
Conductor internal impedance, ohms/km
d	
Conductor diameter, meters
ha, hb	 Height above Earth plane, meters
Sab	
Distance between conductor a and image of conductor b, meters
sab	
Distance between conductor a and conductor b, meters
ω	
Angular frequency, rad/s
f	
System frequency, Hz
Example 4.7
Use ground return correction for impedance calculation of a single circuit 400 kV 
line with two conductors per phase and two ground wires. We use a code to identify 
the role of the conductor: 0 for a retained conductor, −1 for a ground wire, and a 

116
Transmission Line and Cable Modeling
number to make a bundled conductor. A reduced impedance matrix is calculated 
by bundling the phase conductors and eliminating the ground wires. A complete 
transposition is assumed by abc, cab, and bac arrangements. The 012 sequence 
impedance values are calculated.
400 kV line, FINCH ACSR 1113 MCM (54/19), two ground wires
Imax = 1,110 Amperes
This case has horizontal arrangement a-a, b-b, c-c
Length = 1.000000
Transpositions  = 0.000000 1.000000 1.000000
Longnspositions = 0.333333 0.333333 0.333333
Number of conductors =    8
Frequency   =   60
Resistivity =  100
i         x(i)        y(i)          GMR(i)           res(i)        code(i)
 1       -11.52       26.75      1.107440e-003     6.022370e-002       0
 2        -0.23       26.75      1.107440e-003     6.022370e-002       0
 3        11.07       26.75      1.107440e-003     6.022370e-002       0
 4       -11.07       26.75      1.107440e-003     6.022370e-002       1
 5         0.23       26.75      1.107440e-003     6.022370e-002       2
 6        11.52       26.75      1.107440e-003     6.022370e-002       3
 7        -6.96       35.30      6.334000e-004     4.039770e+000      -1
 8         6.96       35.30      6.334000e-004     4.039770e+000      -1
Impedance in Ohms/km
z  =
         Column 1 to 3
   0.1157555 + 1.0258131i    0.0555199 + 0.3299201i    0.0554843 + 0.2776701i  
   0.0555199 + 0.3299201i    0.1157555 + 1.0258131i    0.0555199 + 0.3299201i  
   0.0554843 + 0.2776701i    0.0555199 + 0.3299201i    0.1157555 + 1.0258131i  
   0.0555318 + 0.5728812i    0.0555208 + 0.3329865i    0.0554862 + 0.2791873i  
   0.0555189 + 0.3269735i    0.0555318 + 0.5728812i    0.0555208 + 0.3329865i  
   0.0554824 + 0.2761829i    0.0555189 + 0.3269735i    0.0555318 + 0.5728812i  
   0.0550002 + 0.3420863i    0.0549981 + 0.3333071i    0.0549736 + 0.2876297i  
   0.0549722 + 0.2861057i    0.0549975 + 0.3313648i    0.0550006 + 0.3436850i  
        Column 4 to 6
   0.0555318 + 0.5728812i    0.0555189 + 0.3269735i    0.0554824 + 0.2761829i  
   0.0555208 + 0.3329865i    0.0555318 + 0.5728812i    0.0555189 + 0.3269735i  
   0.0554862 + 0.2791873i    0.0555208 + 0.3329865i    0.0555318 + 0.5728812i  
   0.1157555 + 1.0258131i    0.0555199 + 0.3299201i    0.0554843 + 0.2776701i  
   0.0555199 + 0.3299201i    0.1157555 + 1.0258131i    0.0555199 + 0.3299201i  
   0.0554843 + 0.2776701i    0.0555199 + 0.3299201i    0.1157555 + 1.0258131i  
   0.0550006 + 0.3436850i    0.0549975 + 0.3313648i    0.0549722 + 0.2861057i  
   0.0549736 + 0.2876297i    0.0549981 + 0.3333071i    0.0550002 + 0.3420863i  
         Column 7 to 8
   0.0550002 + 0.3420863i    0.0549722 + 0.2861057i  
   0.0549981 + 0.3333071i    0.0549975 + 0.3313648i  
   0.0549736 + 0.2876297i    0.0550006 + 0.3436850i  
   0.0550006 + 0.3436850i    0.0549736 + 0.2876297i  
   0.0549975 + 0.3313648i    0.0549981 + 0.3333071i  

4.4	
Gauss Law and Capacitance
117
   0.0549722 + 0.2861057i    0.0550002 + 0.3420863i  
   4.0942551 + 1.0691910i    0.0544692 + 0.3153857i  
   0.0544692 + 0.3153857i    4.0942551 + 1.0691910i   
Impedance in Ohms/km
Zreduc  =
   0.1227019 + 0.7703293i    0.0944459 + 0.2997967i    0.0917895 + 0.2488227i  
   0.0944459 + 0.2997967i    0.1269475 + 0.7679215i    0.0944459 + 0.2997967i  
   0.0917895 + 0.2488227i    0.0944459 + 0.2997967i    0.1227019 + 0.7703293i  
ZT1 =
   0.1227 + 0.7703i   0.0918 + 0.2488i   0.0944 + 0.2998i
   0.0918 + 0.2488i   0.1227 + 0.7703i   0.0944 + 0.2998i
   0.0944 + 0.2998i   0.0944 + 0.2998i   0.1269 + 0.7679i
ZT2 =
   0.1269 + 0.7679i   0.0944 + 0.2998i   0.0944 + 0.2998i
   0.0944 + 0.2998i   0.1227 + 0.7703i   0.0918 + 0.2488i
   0.0944 + 0.2998i   0.0918 + 0.2488i   0.1227 + 0.7703i
Ztotal =
   0.1241 + 0.7695i   0.0936 + 0.2828i   0.0936 + 0.2828i
   0.0936 + 0.2828i   0.1241 + 0.7695i   0.0936 + 0.2828i
   0.0936 + 0.2828i   0.0936 + 0.2828i   0.1241 + 0.7695i
Z012 =
   0.3112 + 1.3351i  -0.0000                  0 + 0.0000i
        0 - 0.0000i   0.0306 + 0.4867i   0.0000 - 0.0000i
        0 - 0.0000i   0.0000 - 0.0000i   0.0306 + 0.4867i
As can be seen from results, a complete transposition restores the balanced condition 
and helps to get a decoupled sequence matrix. An extension to the series impedance 
calculation might be to have various three-phase circuits running close to each other 
using the same right of way. Section 4.8 shows the nature of coupling between vari-
ous circuits one 400 kV line and one 230 kV with a double circuit configuration.
4.4	
Gauss Law and Capacitance
At every instant transmission, lines have an electric charge distribution. In a more 
general sense, a transmission line is subject to electromagnetic phenomena when 
used as an electric energy waveguide. In Section 4.2, the magnetic field concept 
was used to characterize the series impedance of the transmission line. Now, an 
electric line charge arrangement is visualized in free space and by the use of Gauss’ 
Law, the potential with respect to a reference is obtained, the potential coefficients 
are determined, and the capacitance values for an arrangement of conductors with 
radius r (meters). Let us start with a single conductor (see Figure 4.13).
	
D ⋅ds
∫∫
= q = rl  C 	
(4.49)

118
Transmission Line and Cable Modeling
	
D =
q
2plr   C/m2 	
(4.50)
	
E = D
e0
=
q
2pe0
1
r   V/m 	
(4.51)
D	
	
Electric displacement field, coulombs/m2
Q	
	
Electric charge, coulombs
ρ	
	
linear charge density, coulombs/m
E	
	
Intensity of electric field, volts/m
ε0 = 8.854187 F/m	 vacuum permittivity
	
Vp = Vp1 + Vp2 =
E1 ⋅dr
r1
sp1
∫
+ V1 +
E2 ⋅dr
r2
sp2
∫
+ V2  V 	
(4.52)
	
Vp =
1
2pe0
−ln
sp1
r1
⎛
⎝⎜
⎞
⎠⎟q1 −ln
sp2
r2
⎛
⎝⎜
⎞
⎠⎟q2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
+ V1 + V2 	
(4.53)
The point p can be located at the surface of conductor 1, with radius r1 (Figure 4.14):
Figure 4.13  Linear density ρ of electric charge, field configuration.
Figure 4.14  Potential at point p due to charges q1 and q2.

4.4	
Gauss Law and Capacitance
119
	
V1 = −
1
2pe0
ln r1
r1
⎛
⎝⎜
⎞
⎠⎟q1 + ln d21
r2
⎛
⎝⎜
⎞
⎠⎟q2
⎡
⎣
⎢
⎤
⎦
⎥+ V1 + V2
V2 =
1
2pe0
ln d21
r2
⎛
⎝⎜
⎞
⎠⎟q2
	
(4.54)
In a similar way for the point p at the surface of conductor 2, radius r2:
	
V2 = −
1
2pe0
ln d12
r1
⎛
⎝⎜
⎞
⎠⎟q1 + ln r2
r2
⎛
⎝⎜
⎞
⎠⎟q2
⎡
⎣
⎢
⎤
⎦
⎥+ V1 + V2
V1 = +
1
2pe0
ln d12
r1
⎛
⎝⎜
⎞
⎠⎟q1
	
(4.55)
Results in (4.54) and (4.55) are in matrix from:
	
V1
V2
⎡
⎣
⎢
⎤
⎦
⎥=
1
2pe0
ln
1
r1
1
d12
1
d21
1
r2
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
q1
q2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(4.56)
One condition that must be satisfied is that the net electric charge q1 + q2 = 0.
4.4.1	 Potential at Midpoint Between Two Electric Charges
When point p is displaced to a point between the two electric charges, as in Figure 
4.15, by (4.53), then using (4.54) and (4.55) with S1p = S2p and r2 = r1:
	
Vp = −
1
2pe0
ln
sp1r2
r1sp2
⎛
⎝⎜
⎞
⎠⎟q1 + V1 + V2 = 0 	
(4.57)
4.4.2	 Conductors Parallel to an Ideal Equipotential Plane
From results in (4.57), the image concept can be used to study the electric charge 
arrangement on overhead conductors, and to have an opposite charge arrangement 
Figure 4.15  If point p is moved to the midpoint between q1 and q2.

120
Transmission Line and Cable Modeling
underneath an ideal plane. For illustrative purposes, consider in Figure 4.16, two 
charges q1 and q2 at height h1 and h2 and corresponding images beneath the ideal 
plane. For the arrangement of conductors and electric charges imposing physical 
conditions: V′1 = −V1, V′2 = −V2, q′1 = −q1 and q′2 = −q2.
	
V1
V2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
1
2pe0
ln
2h1
r1
S12
s12
S21
s21
2h2
r2
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
q1
q2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(4.58)
In a condensed matrix, the expression for (4.58) is:
	
V = [p]q 	
(4.59)
	
[p] =
1
2pe0
ln
2h1
r1
S12
s12
S21
s21
2h2
r2
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(4.60)
4.4.3	 Capacitance and Shunt Admittance
Matrix [p, (5.59)] is known as the matrix of potentials and its inverse is the capaci-
tance matrix [C].
	
q = [C]V 	
(4.61)
	
[C] = [p]−1 	
(4.62)
Figure 4.16  Parallel conductors over an ideal plane, charges q1 and q2, images q′1 and q′2

4.4	
Gauss Law and Capacitance
121
The shunt admittance matrix (siemens/km) for AC operation at a frequency f in Hz is:
	
Ysh = j2pf[C] 	
(4.63)
In summary, the process in (4.56) gives a set of potential coefficients with no con-
sideration to the Earth plane and (4.58) calculates the set of potential coefficients 
by the image method. This last procedure includes the effect of an ideal Earth plane 
as presented in this section.
Example 4.8
For a set of three conductors arranged in three-phase abc (Figure 4.17), with radius 
0.015 m, calculate the potential matrix [p], and the capacitance matrix [C]; do not 
consider the Earth plane. Compare the values obtained if the Earth plane is repre-
sented by the image method. Calculate the abc shunt admittance matrix and apply a 
complete transposition assumption to calculate the sequence 012 shunt admittances.
f = 60
r = 0.0150
x =  0.0       2.5000    5.0000
y = 15.0000   19.3301   15.0000
P =
   66.6667    0.2000    0.2000
    0.2000   66.6667    0.2000
    0.2000    0.2000   66.6667
C =
    0.0253    0.0157    0.0157
    0.0157    0.0253    0.0157
    0.0157    0.0157    0.0253
Figure 4.17  Three conductors abc and distances over an ideal plane.

122
Transmission Line and Cable Modeling
YC =
        0 + 9.5213i        0 + 5.9160i        0 + 5.9160i
        0 + 5.9160i        0 + 9.5213i        0 + 5.9160i
        0 + 5.9160i        0 + 5.9160i        0 + 9.5213i
The results considering images to include Earth plane are:
Pim =
  1.0e+003 *
    2.0000    0.0069    0.0061
    0.0069    2.5774    0.0069
    0.0061    0.0069    2.0000
Cim =
    0.0081   -0.0016   -0.0015
   -0.0016    0.0079   -0.0016
   -0.0015   -0.0016    0.0081
YCim =
        0 + 3.0450i        0 - 0.6082i        0 - 0.5689i
        0 - 0.6082i        0 + 2.9652i        0 - 0.6082i
        0 - 0.5689i        0 - 0.6082i        0 + 3.0450i
YT1 =
        0 + 3.0450i        0 - 0.5689i        0 - 0.6082i
        0 - 0.5689i        0 + 3.0450i        0 - 0.6082i
        0 - 0.6082i        0 - 0.6082i        0 + 2.9652i
YT2 =
        0 + 2.9652i        0 - 0.6082i        0 - 0.6082i
        0 - 0.6082i        0 + 3.0450i        0 - 0.5689i
        0 - 0.6082i        0 - 0.5689i        0 + 3.0450i
Ytotal =
        0 + 3.0184i        0 - 0.5951i        0 - 0.5951i
        0 - 0.5951i        0 + 3.0184i        0 - 0.5951i
        0 - 0.5951i        0 - 0.5951i        0 + 3.0184i
Y012 =
        0 + 1.8282i        0 - 0.0000i   0.0000 + 0.0000i
        0             0.0000 + 3.6135i   0.0000 - 0.0000i
        0 - 0.0000i   0.0000 - 0.0000i  -0.0000 + 3.6135i
4.5	
Calculation of Cable Parameters
Underground cables are an important part in some electric system configurations 
where overhead layouts are prohibited or undesirable (i.e., in metropolitan areas, 
off-shore interconnections, and protected areas). Usually, the distances covered are 
not very long; contrary to the overhead lines and cables. However, electric and mag-
netic characteristics are very important, especially for the shunt capacitive admit-
tance. In general, Carson’s equations can be applied, considering the constitutive 
conductors and insulation arrangements. To obtain the equivalent series impedance 

4.5	
Calculation of Cable Parameters
123
and the shunt admittance, we use the same mathematical procedures as the ones 
already used for the overhead lines. We can eliminate neutral conductors and shield 
arrangements (Figure 4.18) applying electrical conditions and the partial inversion 
process to the set of equations in the model.
4.5.1	 Cable Series Impedance
For a concentric cable (Figure 4.19) used as a neutral:
R	
Radius of concentric neutral strands, meters
sph	
Phase conductor diameter, meters
son	
Diameter over concentric neutrals, meters
sn	
Diameter of neutral strands, meters
GMRph	
Geometric mean radius of phase conductor, meters
GMRn	
Geometric mean radius of neutral strands, meters
rph	
Resistance of phase conductor, Ω/km
rn	
Resistance of neutral strand, Ω/km
k	
Number of neutral strands in the concentric arrangement
A table for conductor’s data has values of GMRph and for the neutral strand; from 
here, an equivalent GMRdn is calculated for a concentric neutral.
	
GMRcn =
GMRnkRk−1
k
R =
son −sn
(
)
2
	
(4.64)
The resistance (ohms/km) in a concentric neutral as:
Figure 4.18  Horizontal underground arrangement, including a neutral conductor.
Figure 4.19  Cross section for a concentric cable.

124
Transmission Line and Cable Modeling
	
rcn = rn
k 	
(4.65)
Let us consider the spacing for concentric neutral and phase conductors as follows:
	
Sij =
R
Concentric neutral conductor to its own phase
Sij Concentric neutral conductor to adjacent conductor
⎧
⎨⎪
⎩⎪
	 (4.66)
The geometric mean distance between a concentric neutral and an adjacent phase 
conductor is calculated using the center-to-center distance between phase conductors.
	
Sij =
Snm
k
−Rk
k
≈Snm  m 	
(4.67)
	
R =
son −sn
(
)
2
= (0.032760 −0.001628)
2
= 0.01556
	
Example 4.9
In Figure 4.18, a three-cable arrangement is horizontal. Cables are 250 MCM AA 
phase conductor, 15 kV, aluminum with 13 strands of #14 annealed copper wires 
to form a 1/3 neutral, R =(son − sn)/2 = (0.032760 − 0.001628)/2 = 0.01556.
R	
radius of concentric neutral strands, meters
sph = 0.0144 m	
phase conductor diameter
son = 0.032760 m	
diameter over concentric neutrals
sn = 0.001628 m	
diameter of neutral strands
GMRph = 0.005212 m	
geometric mean radius of phase conductor
GMRn = 0.0006339 m	 geometric mean radius of neutral strand
rph = 0.2548 Ω/km	
resistance of phase conductor
rn = 9.243 Ω/km	
resistance of neutral strand
k = 13	
number of neutral strands in the concen-
tric arrangement
Figure 4.20  Spacing for a concentric neutral and a phase conductor.

4.5	
Calculation of Cable Parameters
125
The GMR for the concentric neutral is GMRcn = 
(0.0006339)(13) (0.01556)12
13
 = 
0.0148 m. The equivalent resistance of the concentric neutral in ohm/km is rcn = 
rn/k = 9.243/13 = 0.711.
Assuming a geometric configuration as in Figure 4.18: the distances in meters 
are: Sij = R = 0.01556 concentric neutral to its own phase and Sij = 0.20 concentric 
neutral to adjacent concentric neutral (see Figures 4.20 and 4.21). Then the series 
impedance in Ω/km is:
Z =
  Columns 1 through 5 
   0.3140 + 0.9049i  0.0592 + 0.6299i  0.0592 + 0.5776i  0.0592 + 0.8224i  0.0592 + 0.6299i
   0.0592 + 0.6299i  0.3140 + 0.9049i  0.0592 + 0.6299i  0.0592 + 0.6299i  0.0592 + 0.8224i
   0.0592 + 0.5776i  0.0592 + 0.6299i  0.3140 + 0.9049i  0.0592 + 0.5776i  0.0592 + 0.6299i
   0.0592 + 0.8224i  0.0592 + 0.6299i  0.0592 + 0.5776i  0.7702 + 0.8261i  0.0592 + 0.6299i
   0.0592 + 0.6299i  0.0592 + 0.8224i  0.0592 + 0.6299i  0.0592 + 0.6299i  0.7702 + 0.8261i
   0.0592 + 0.5776i  0.0592 + 0.6299i  0.0592 + 0.8224i  0.0592 + 0.5776i  0.0592 + 0.6299i
  Column 6 
   0.0592 + 0.5776i
   0.0592 + 0.6299i
   0.0592 + 0.8224i
   0.0592 + 0.5776i
   0.0592 + 0.6299i
   0.7702 + 0.8261i
The Zabc and Z012 series impedance matrix for the original phase arrangement are 
used to calculate, Ztot assuming a complete transposition at 1/3 and 2/3 of the cable 
length. Finally sequence impedances are calculated. All results in Ω/km.
Zreduc =
   0.5019 + 0.2886i   0.1945 + 0.0155i   0.1720 - 0.0124i
   0.1945 + 0.0155i   0.4952 + 0.2636i   0.1945 + 0.0155i
   0.1720 - 0.0124i   0.1945 + 0.0155i   0.5019 + 0.2886i
Z012ut =
   0.8737 + 0.2927i  -0.0018 - 0.0050i  -0.0034 + 0.0041i
  -0.0034 + 0.0041i   0.3126 + 0.2741i  -0.0147 + 0.0284i
  -0.0018 - 0.0050i   0.0320 - 0.0015i   0.3126 + 0.2741i
Figure 4.21  Horizontal underground arrangement, concentric neutral.

126
Transmission Line and Cable Modeling
Ztot =
   0.4996 + 0.2803i   0.1870 + 0.0062i   0.1870 + 0.0062i
   0.1870 + 0.0062i   0.4996 + 0.2803i   0.1870 + 0.0062i
   0.1870 + 0.0062i   0.1870 + 0.0062i   0.4996 + 0.2803i
Z012 =
   0.8737 + 0.2927i  -0.0000 + 0.0000i  -0.0000 + 0.0000i
  -0.0000 + 0.0000i   0.3126 + 0.2741i  -0.0000 + 0.0000i
   0.0000            -0.0000 - 0.0000i   0.3126 + 0.2741i
For the tape shielded cables in Figure 4.22.
sph	
phase conductor diameter, meters
sod	
outside diameter over jacket, meters
ss	
outside diameter of tape shield, meters
GMRph	
geometric mean radius of phase conductor, meters
GMRn	
geometric mean radius of neutral strand, meters
rsh	
resistance of phase conductor, Ω/km
rn	
resistance of neutral strand, Ω/km
k	
number of neutral strands in the concentric arrangement
4.5.2	 Cable Shunt Capacitance
From Section 4.4 and the geometry shown in Figure 4.23, the capacitance between 
the conductor’s core and its sheath relates the electric charge q and the electric 
potential V to allow the capacitance C calculation and the capacitive susceptance 
Bc, ε0 = 8.854 × 10–12 F/m, BC in (4.69) is in μS/km.
	
q1 =
2pe0
ln
d1p
r1
⎛
⎝⎜
⎞
⎠⎟
V = 0.0556325
ln
d1p
r1
⎛
⎝⎜
⎞
⎠⎟
V 	
(4.68)
	
BC = 2pfC = 0.349549f
ln
ris
roc
⎛
⎝⎜
⎞
⎠⎟
	
(4.69)
Figure 4.22  Cross section for a tape shielded cable.

4.5	
Calculation of Cable Parameters
127
The capacitance in insulation from core to sheath, assuming a known relative per-
mittivity and from sheath to the armor where εcs = εr
csε0.
	
Ccs = 2pe0ecs
r
ln
ris
roc
⎛
⎝⎜
⎞
⎠⎟
= 0.0556325
ln
ris
roc
⎛
⎝⎜
⎞
⎠⎟
ecs
r   mF/km 	
(4.70)
	
Csa = 0.0556325
ln ria
ros
⎛
⎝⎜
⎞
⎠⎟
esa
r   mF/km 	
(4.71)
Relative permittivity εr
cs is a complex number with components that depend on fre-
quency. At low frequencies, as is the case in electric power systems, only the real 
part is significant at a steady state.
4.5.3	 Three-phase Cables
For three-phase cable arrangements using single core cables with screen, the phases 
are laid parallel to each other so that there is no electric coupling between phases. 
A different layout is the pipe type where phases can be arranged as a triangular 
arrangement or cradle configuration (see Figure 4.24).
Figure 4.23  Cross section for a one-phase armored cable.
Table 4.1  Real Part of εr
cs
Material
Real part of relative permittivity
Solid impregnated paper
4.0
Oil filled impregnated paper
3.5
Oil pressure pipe type
3.7
Butyl rubber
4.0
EPR
3.0
XLPE
2.5
Polyethylene PE
2.3
Polyvinyl chloride PVC
8.0

128
Transmission Line and Cable Modeling
The core-to-sheath capacitance is defined by (4.70) and the mutual capacitance 
between phases and the sheath of each phase and the pipe as:
	
Css =
0.0556325
ln
Radius
di
2 + dk
2 −2didk cosqik
⎛
⎝⎜
⎞
⎠⎟
ep
r   mF/km 	
(4.72)
For pipe type cable, in a three-phase cable and cradle arrangement.
Example 4.10
Values for pipe and cable radius: rp = 3.0 and rc = 1.0. Center of coordinates for 
cable k is at (0, 1.0) and dk = rp − rc = 3.0 − 1.0 = 2.0. First, the center coordinates 
for cable i, capacitance sheath-armor and capacitance armor-Earth, as in Table 4.2, 
as θik/2 = arcsin(rc/dk) = arcsin(1.0/2.0) = 30°, θik = 60° (see Figure 4.25).
Figure 4.24  Three-phase cable, pipe type cradle arrangement.
Table 4.2  Center Coordinates for Cable i and Capacitances
di = dk cos p
2 −qik
⎛
⎝⎜
⎞
⎠⎟= 2.0cos p
2 −60.0°
⎛
⎝⎜
⎞
⎠⎟= 1.732
rp −dk sin p
2 −60.0°
⎛
⎝⎜
⎞
⎠⎟= 3.0 −2.0sin p
2 −60.0°
⎛
⎝⎜
⎞
⎠⎟= 2.0
Capacitance 
core-sheath
Ccs = 0.0556325ecs
r
ln
ris
roc
⎛
⎝⎜
⎞
⎠⎟
  mF/km
Bcs = 0.3495493f ecs
r
ln
ris
roc
⎛
⎝⎜
⎞
⎠⎟
  mS/km
Capacitance 
sheath-armor
Csa = 0.0556325esa
r
ln ria
ros
⎛
⎝⎜
⎞
⎠⎟
  mF/km
Bsa = 0.3495493f esa
r
ln ria
ros
⎛
⎝⎜
⎞
⎠⎟
  mS/km
Capacitance 
armor-Earth
Cae = 0.0556325eae
r
ln
roa + tps
ros
⎛
⎝⎜
⎞
⎠⎟
  mF/km
Bae = 0.3495493f eae
r
ln
roa + tps
ros
⎛
⎝⎜
⎞
⎠⎟
  mS/km

4.5	
Calculation of Cable Parameters
129
The three-phase abc shunt admittance matrix for the no-armor case has a 6×6 
structure. The sheath abc currents are zero; using a partial inversion, we find the 
abc equivalent matrix.
	
Yabc
cc
Yabc
c,s
Yabc
s,c
Yabc
ss
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Vabc
c
Vabc
s
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
Iabc
c
Iabc
s
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Iabc
s
= 0 	
(4.73)
	
Yabc
cc
(
)
eq −
−
−
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Vabc
c
0
⎡
⎣
⎢
⎤
⎦
⎥=
Iabc
c
Vabc
s
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	
(4.74)
4.5.4	 Three-phase Cables, Pipe Type
Mutual capacitance in μF/km between sheaths for each phase and the pipe:
	
Css,ik ≈
0.0556325ep
r
ln
rp
di
2 + dk
2 −2didk cosqik
⎛
⎝⎜
⎞
⎠⎟
	
(4.75)
	
Csp,ii ≈
0.0556325ep
r
ln
rp
2 −ri
2
rpri
⎛
⎝⎜
⎞
⎠⎟
	
(4.76)
Self and mutual impedance in ohms/km for underground cables, for the core con-
ductor with Earth return.
	
f roc,ric
(
) = 1.0 −
2ric
2
roc
2 −ric
2 +
4ric
4
roc
2 −ric
2
(
)
2 ln roc
ric
⎛
⎝⎜
⎞
⎠⎟	
(4.77)
Figure 4.25  Susceptance values among core, sheath, and armor (when present).

130
Transmission Line and Cable Modeling
	
Zcc = Rc,ca + p210−4f + j4p10−4f
mc
r
4 f roc,ric
(
) + ln Derc
roc
⎛
⎝⎜
⎞
⎠⎟
⎡
⎣
⎢
⎤
⎦
⎥	
(4.78)
Depth of equivalent Earth-return conductor in meters is Derc = 658.37 r/f and 
μr
c is relative permeability for a core conductor.
For sheath with Earth return, self impedance in ohms/km where μr
s is the rela-
tive permeability of sheath conductor.
	
f ros,ris
(
) = 1.0 −
2ris
2
ros
2 −ris
2 +
4ris
4
ros
2 −ris
2
(
)
2 ln ros
ris
⎛
⎝⎜
⎞
⎠⎟	
(4.79)
	
Zss = Rs,ca + p210−4f + j4p10−4f
ms
r
4 f ros,ris
(
) + ln Derc
ros
⎛
⎝⎜
⎞
⎠⎟
⎡
⎣
⎢
⎤
⎦
⎥	
(4.80)
Self-impedance for armor with Earth return, impedance in ohms/km, and μr
a is the 
relative permeability of armor conductor.
	
f roa,ria
(
) = 1.0 −
2ria
2
roa
2 −ria
2 +
4ria
4
roa
2 −ria
2
(
)
2 ln roa
ria
⎛
⎝⎜
⎞
⎠⎟	
(4.81)
	
Zaa = Ra,ca + p210−4f + j4p10−4f
ma
r
4 f roa,ria
(
) + ln Derc
roa
⎛
⎝⎜
⎞
⎠⎟
⎡
⎣
⎢
⎤
⎦
⎥	
(4.82)
The mutual impedance in ohms/km between core or sheath or armor i and core, 
sheath or armor j including earth return effect, where Sij is the distance between 
centers of cables i and j from different cables i ≠ j
	
Zij = p210−4f + j4p10−4f ln Derc
Sij
⎛
⎝⎜
⎞
⎠⎟	
(4.83)
For the same cable, the distance Sij is the GMD between conductors; core and the 
sheath of cable j as Sjj = (ros + ris)/2.
Example 4.11
For a three-phase cable in a flat arrangement and 275 kV, f = 50 Hz, Earth resistiv-
ity = 20 Ω-m.
Cu Core inner radius, oil duct = 0.0068 m, outer radius = 0.0219 m, μr = 1.0, 
Rac = 0.01665 Ω/km.
Core’s insulation paper with μr = 1.0 and εr = 3.8.

4.5	
Calculation of Cable Parameters
131
Lead sheath inner radius = 0.0379 m, outer radius = 0.0409 m, μr = 1.0, Rac 
= 0.28865 Ω/km.
PVC over-sheath thickness = 0.003 m, μr = 1.0, εr = 3.5.
Capacitance and Shunt admittance for cable arrangements
inner r(m)     core r(m)      relative mu       ac-R (Ohms/km)
0.006800       0.021900       1.000000          0.016655
Core insulation               mu-relative       permittivity
                              1.000000          3.800000
Lead sheath
inner r(m)     outer r(m)     mu-relative       ac-R (Ohms/km)
0.037900       0.040900       1.0000            0.288650
PVC over-sheath
thickness(m)                  mu-relative       ac-R (Ohms/km)
0.003000                      1.0000            3.500000
frequency (Hz) Capacitance (micro-F/km)  Susceptance (micro-S/km)
 50.0000       C_CS = 0.385446          B_CS  = +  121.0915
 50.0000       C_OS = 2.750806          B_COS = +  864.1911
YshuntC =
  1.0e+002 *
  Columns 1 through 4
        0 + 1.2109i        0                  0                  0 - 1.2109i
        0                  0 + 1.2109i        0                  0          
        0                  0                  0 + 1.2109i        0          
        0 - 1.2109i        0                  0                  0 + 9.8528i
        0                  0 - 1.2109i        0                  0          
        0                  0                  0 - 1.2109i        0          
Columns 5 through 6
        0                  0          
        0 - 1.2109i        0          
        0                  0 - 1.2109i
        0                  0          
        0 + 9.8528i        0          
        0                  0 + 9.8528i
Solidly bond cable, Vs = 0
Admittances in micro-S/km
YeqABC =
  1.0e+002 *
        0 + 1.2109i        0                  0          
        0                  0 + 1.2109i        0          
        0                  0                  0 + 1.2109i
           Phase A          Phase B          Phase C
Voltage =   158.77           -79.39           -79.39 kV
        +j   +0.00       +j -137.50       +j +137.50

132
Transmission Line and Cable Modeling
Current =     0.00            16.65           -16.65 A
        +j  +19.23       +j   -9.61       +j   -9.61
Power S =     0.00            -0.00             0.00 MVA/km
        +j   -3.05       +j   -3.05       +j   -3.05
Zseries (Ω/km)=
  Columns 1 through 4
   0.0660 + 0.6323i   0.0493 + 0.5087i   0.0493 + 0.4651i   0.0493 + 0.5799i
   0.0493 + 0.5087i   0.0660 + 0.6323i   0.0493 + 0.5087i   0.0493 + 0.5087i
   0.0493 + 0.4651i   0.0493 + 0.5087i   0.0660 + 0.6323i   0.0493 + 0.4651i
   0.0493 + 0.5799i   0.0493 + 0.5087i   0.0493 + 0.4651i   0.3380 + 0.5814i
   0.0493 + 0.5087i   0.0493 + 0.5799i   0.0493 + 0.5087i   0.0493 + 0.5087i
   0.0493 + 0.4651i   0.0493 + 0.5087i   0.0493 + 0.5799i   0.0493 + 0.4651i
  Columns 5 through 6
   0.0493 + 0.5087i   0.0493 + 0.4651i
   0.0493 + 0.5799i   0.0493 + 0.5087i
   0.0493 + 0.5087i   0.0493 + 0.5799i
   0.0493 + 0.5087i   0.0493 + 0.4651i
   0.3380 + 0.5814i   0.0493 + 0.5087i
   0.0493 + 0.5087i   0.3380 + 0.5814i
No armor
Impedances in Ohms/km
ZeqABC =
   0.1278 + 0.1277i   0.0887 - 0.0011i   0.0719 - 0.0237i
   0.0887 - 0.0011i   0.1186 + 0.1058i   0.0887 - 0.0011i
   0.0719 - 0.0237i   0.0887 - 0.0011i   0.1278 + 0.1277i
Zeq012 =
   0.2910 + 0.1031i  -0.0011 - 0.0023i  -0.0014 + 0.0021i
  -0.0014 + 0.0021i   0.0416 + 0.1290i  -0.0122 + 0.0235i
  -0.0011 - 0.0023i   0.0265 - 0.0012i   0.0416 + 0.1290i
4.6	
Geometric Mean Radius
The concept of geometric mean radius (GMR) can be expanded from the definition 
(4.12) given for a solid conductor. Let us include various strands that carry a given 
amount of current I. The procedure is shown for three (see Figure 4.26) and for 
four (see Figure 4.27) strands arrangement.
Figure 4.26  Cross section for a three-strand conductor.

4.7	
Equivalent Height
133
Three strands:
	
GMR1 = Re−1/4 	
(4.84)
For three conductors, the flux linkage equations as in (4.16). with i1 = i2 = i3 = I/3 
and its GMR as in (4.86).
	
l =
l1 + l2 + l3
(
)
3
= mo
2p
I
9 ln
1
GMR1
(
)
3 2R
(
)
6
⎛
⎝
⎜⎜
⎞
⎠
⎟⎟	
(4.85)
	
RMG =
Re−1/4
(
)
3 2R
(
)
6
9
= R 4e−1/4
(
)
1/3 = 1.46048R 	
(4.86)
Four strands where distances are: d12 = d13 = d24 = d34 = 2R and d14 = d23 = 2 2R . 
Currents are: i1 = i2 = i3 = i4 = I/4 using (4.16) the flux linkages can be written as in 
(4.87) and the equivalent GMR as in (4.88).
	
λ = l1 + l2 + l3 + l4
4
= mo
2p
I
16 ln
1
GMR1
(
)
4 2R
(
)
8 2 2R
(
)
4
⎛
⎝
⎜⎜
⎞
⎠
⎟⎟
	
(4.87)
	
RMG =
Re−1/4
(
)
4 2R
(
)
8 2 2R
(
)
4
16
= R 8 2e−1/4
(
)
1/4 = 1.72289R	 (4.88)
4.7	
Equivalent Height
Calculate an equivalent height of an overhead transmission line that has a catenary 
form (assuming that it can be approximated to a parabola; see Figure 4.28). The 
conductor’s sag between supports are: x = 0, y = ysm, x = d/2, y = yt. Constants for 
(4.89) are: ysm = b, yt = k(d/2)2 + ysm and k = (yt − ysm)/(d/2)2.
	
y = kx2 + b 	
(4.89)
Figure 4.27  Cross section for a four-strand conductor.

134
Transmission Line and Cable Modeling
The parabola equation is:
	
y = yt −ysm
(d/2)2 x2 + ysm 	
(4.90)
The equivalent height yeq times the distance between supports d can be made equal 
to the area enclosed from −d/2 to +d/2 by the parabola (4.90) with sag = yt – ysm.
	
yeq = 1
d
yt −ysm
3(d/2)2 2 d
2
⎛
⎝⎜
⎞
⎠⎟
3
+ ysm = sag
3
+ ysm 	
(4.91)
Figure 4.28  Sag estimation by means of approximation to a parabola.
Figure 4.29  400 kV and 230 kV circuits running in parallel (drawing not to scale).

4.8	
Transmission Lines in Parallel
135
4.8	
Transmission Lines in Parallel
Assume one 400 kV line and one 230 kV with double circuit configuration, each 
arrangement has two shield wires. The 400 kV line has two conductors per phase 
and the 230 kV line has two circuits in a vertical arrangement. Data is given below, 
distances are in meters, and there is no transposition. Results are shown for series 
impedance calculation. Shunt capacitive admittance can be calculated through the 
steps outlined in Section 4.4.2.
Number of conductors =   16
Frequency =   60
resistivity =  100 Ohms-m
  k       x(k)        y(k)        GMR(k)           res(k)          code(k)
  1    -11.5150     26.7500      1.10744e-003     6.02237e-002       0
  2     -0.2250     26.7500      1.10744e-003     6.02237e-002       0
  3     11.0650     26.7500      1.10744e-003     6.02237e-002       0
  4     21.5000     17.6700      9.95680e-004     6.02237e-002       0
  5     21.5000     23.1700      9.95680e-004     6.02237e-002       0
  6     21.5000     28.6700      9.95680e-004     6.02237e-002       0
  7     28.5000     17.6700      9.95680e-004     6.02237e-002       0
  8     28.5000     23.1700      9.95680e-004     6.02237e-002       0
  9     28.5000     28.6700      9.95680e-004     6.02237e-002       0
 10    -11.0650     26.7500      1.10744e-003     6.02237e-002       1
 11      0.2250     26.7500      1.10744e-003     6.02237e-002       2
 12     11.5150     26.7500      1.10744e-003     6.02237e-002       3
 13     -6.9600     35.3000      6.33400e-004     4.03977e+000      -1
 14      6.9600     35.3000      6.33400e-004     4.03977e+000      -1
 15     22.6400     32.9200      6.33400e-004     4.03977e+000      -1
 16     27.3600     32.9200      6.33400e-004     4.03977e+000      -1
Impedance in Ohms/km
Z012 =
Columns 1 through 4
   0.3609 + 1.2570i   0.0111 - 0.0031i  -0.0219 - 0.0060i   0.3331 + 0.6834i
  -0.0219 - 0.0060i   0.0311 + 0.4865i  -0.0297 + 0.0181i   0.0338 - 0.0537i
   0.0111 - 0.0031i   0.0303 + 0.0165i   0.0311 + 0.4865i  -0.0480 - 0.0473i
   0.3331 + 0.6834i  -0.0480 - 0.0473i   0.0338 - 0.0537i   0.4060 + 1.5880i
  -0.0084 - 0.0092i   0.0041 + 0.0037i  -0.0040 + 0.0032i  -0.0264 - 0.0096i
  -0.0044 - 0.0001i   0.0044 + 0.0020i  -0.0029 + 0.0036i   0.0108 + 0.0017i
   0.3267 + 0.6191i  -0.0361 - 0.0345i   0.0221 - 0.0410i   0.3407 + 0.8670i
  -0.0081 - 0.0045i   0.0019 + 0.0013i  -0.0012 + 0.0016i  -0.0187 - 0.0057i
  -0.0033 + 0.0037i   0.0016 + 0.0005i  -0.0007 + 0.0013i   0.0044 + 0.0048i
Columns 5 through 8
  -0.0044 - 0.0001i  -0.0084 - 0.0092i   0.3267 + 0.6191i  -0.0033 + 0.0037i
  -0.0029 + 0.0036i  -0.0040 + 0.0032i   0.0221 - 0.0410i  -0.0007 + 0.0013i
   0.0044 + 0.0020i   0.0041 + 0.0037i  -0.0361 - 0.0345i   0.0016 + 0.0005i
   0.0108 + 0.0017i  -0.0264 - 0.0096i   0.3407 + 0.8670i   0.0044 + 0.0048i
   0.0610 + 0.6668i  -0.0297 + 0.0180i  -0.0194 - 0.0056i   0.0006 + 0.0275i
   0.0301 + 0.0166i   0.0610 + 0.6668i   0.0041 + 0.0054i   0.0166 + 0.0089i
   0.0041 + 0.0054i  -0.0194 - 0.0056i   0.3966 + 1.5955i   0.0111 + 0.0010i

136
Transmission Line and Cable Modeling
   0.0006 + 0.0275i  -0.0162 + 0.0101i  -0.0255 - 0.0097i   0.0609 + 0.6669i
   0.0166 + 0.0089i   0.0006 + 0.0275i   0.0111 + 0.0010i   0.0301 + 0.0167i
Column 9
  -0.0081 - 0.0045i
  -0.0012 + 0.0016i
   0.0019 + 0.0013i
  -0.0187 - 0.0057i
  -0.0162 + 0.0101i
   0.0006 + 0.0275i
  -0.0255 - 0.0097i
  -0.0298 + 0.0180i
   0.0609 + 0.6669i
The code for each conductor helps us in classifying a conductor as a retained versus 
one conductor that is part of a bundle or a conductor that works as a shield wire. 
The reduced sequence 012 impedance matrices have information for the zero, posi-
tive, and negative sequences. Mutual effects between zero sequence impedances 
to neighboring circuits are not negligible, as highlighted in the first column of the 
printout results.
References
[1]	
Clarke, E., Circuit Analysis of AC Power Systems, Volume I: Symmetrical and Related 
Components, New York: John Wiley & Sons, 1943.
[2]	
Elgerd, O. I., Electric Energy Systems Theory, New York: McGraw-Hill Book Company, 
1971.
[3]	
Bruce Shipley, R., Introduction to Matrices and Power Systems, New York: John Wiley 
& Sons, 1976.
[4]	
Sakis Meliopoulos, A. P., Power System Grounding and Transients, New York: Marcel 
Dekker, Inc., 1988.
[5]	
Kersting, W. H., Distribution System Modeling and Analysis, Boca Raton, FL: CRC Press, 
2002.
[6]	
Tleis, N., Power Systems Modelling and Fault Analysis, Burlington, MA: Elsevier, 2008.

137
C h a p t e r  5
Transmission Line Loadability
5.1	
Introduction
To plan and properly operate a large electric power system, planning engineers 
need to know with reasonable accuracy how much power the new transmission 
lines can carry given the changing seasonal demand conditions. Operating engi-
neers in the control center need to monitor how much power various important 
lines are carrying. The load that a transmission line will carry depends on various 
parameter values, as well as weather conditions (i.e., heat, wind, and rain). Load 
ability studies determine how a given transmission line can use its power carrying 
capacities, especially under market rules and conditions. The maximum safe limit 
is to be determined based on the voltage level, conductor current capacity, length 
of the line, and electrical parameters (i.e., series impedance and shunt capacitance 
per unit length), as well as the exiting reactive power compensation. To discuss the 
loadability concept, we assume a balanced transmission line; only positive sequence 
values will be used, and the maximum power and losses incurred can be estimated. 
Various tools can be applied to establish current and power handling capability 
(namely constants written as ABCD or nodal analysis). However, the distributed 
parameters model must be used so that the nature of the transmission line is better 
reflected through this modeling.
5.2	
Approximate Real Power Handling and Losses
In steady state for an AC transmission line, the power transfer on a balanced line 
follows a general model; with Ṽk = ⎪Vk⎪ ∠ θk, Ṽm = ⎪Vm⎪ ∠ θm and ysh/2 = −1/jXC/2 
= jBsh/2 notation as in Figure 5.1.
Figure 5.1  Transmission line model, nodes k and m.

138
Transmission Line Loadability
The complex power flow, from node k to node m, using θkm = θk − θm:
	
skm = !Vk ikm + ik,sh
(
)
∗
= !Vk
!Vk −!Vm
(
)ykm + !Vkysh/2
⎡⎣
⎤⎦
∗
	
(5.1)
From here, we have the real and imaginary parts for the real and reactive power:
	
pkm = Vk
2 gkm −Vk Vm gkm cosqkm −Vk Vm bkm sinqkm 	
(5.2)
	
qkm = −Vk
2 bkm + Bsh/2
(
) −Vk Vm gkm sinqkm + Vk Vm bkm cosqkm 	
(5.3)
Some approximations for high voltage transmission lines are gkm << bkm and bkm ≈ 
−1/xkm, then:
	
pkm ≈sinqkm
Vk Vm
xkm
	
(5.4)
The three-phase power in megawatts can be estimated using phase-to-phase voltage 
magnitudes ⎪Vk⎪, ⎪Vm⎪ and xkm = xl, where x is the inductive series reactance in 
ohms/km and l is the line’s length in km. We use the line’s positive sequence series 
impedance as listed in Table 5.1. Angle θkm, by a stability criteria sets a limit to 30º 
and terminal voltages magnitudes with similar values ⎪V⎪.
	
pkm
max ≈sin p
6
⎛
⎝⎜
⎞
⎠⎟
V
2
xl = V
2
2xl 	
(5.5)
In order to have an estimation about the amount of power losses, we can assume 
that current is in phase with the voltage at the receiving end m; this amounts to 
having unity power factor. This will give an approximate figure that is close enough 
for our evaluation purposes.
Table 5.1  Transmission Line Parameter Values
System voltage, kV
400
750
Mean conductor height, m
15
18
Phase to phase distance, m
12
15
Phase conductors, 954 MCM
2
4
Conductor diameter, m
0.03037
0.03037
Subconductor distance, m
0.46
0.46
r (25°C) ohms/km
0.03048
0.01524
x (50 Hz), ohms/km
0.3330
0.2857
x/r ratio
10.92
18.74

5.2	
Approximate Real Power Handling and Losses
139
	
I =
pkm
3V / 3 = V sinqkm
3xl 	
(5.6)
	
PLoss = 3rlI2 = rl
V sinqkm
xl
⎛
⎝⎜
⎞
⎠⎟
2
	
(5.7)
	
PLoss
pkm
% = 100 sinqkm
(x/r) 	
(5.8)
From numbers on Table 5.2, it can be said that:
• Approximate values can be used as a preliminary guideline. Detailed models 
will give power and losses when variable load conditions and shunt capaci-
tive effects are included; early morning load and the peak demand values are 
usually very different in any electrical system.
• The 750 kV transmission line, over the same distance, can carry up to four 
times (4,900/1,200 ≈ 4.1 or 3,281/800 ≈ 4.1) as much power as the 400 kV line.
• Losses depend on the x/r ratio and angle θkm (phase difference in sending and 
receiving voltages). To calculate line losses, the positive sequence reactance 
and phase resistance are required.
• For a given real power P, the amount of losses on the 750 kV line as compared 
to the 400 kV line, are 2.5/4.57 = 0.547 times.
5.2.1	 Number of Circuits Required to Transport Electric Power
A problem often faced by planning engineers is how to send a given amount of power 
from a generation site to the load center (see Figure 5.2). For a known distance, the 
question is: how many three-phase transmission circuits will be required and at what 
voltage? The planning engineers must also study to see if there are other technolo-
gies, such as DC transmission, that can be technical and economically attractive.
For the following discussion on how to handle 5,000 MW in a distance of 
300 km, it is assumed that options are AC, operating either at 400 kV or 750 kV, 
with nodal angle separation of 30°, which gives a reasonable steady state stability 
margin. With this value under severe contingencies, the power generation plants 
Table 5.2  Maximum Power and Losses in %, θkm = 30° (Data from Table 5.1)
System voltage kV
400
750
r (25°C) ohms/km
0.03048
0.01524
x (50 Hz), ohms/km
0.3330
0.2857
x/r ratio
10.92
18.74
Max P (MW), 𝓁 = 200 km
1,200
4,922
Max P (MW), 𝓁 = 300 km
800
3,281
Losses %
4.57
2.66

140
Transmission Line Loadability
on both sides of the transmission line will remain in synchronous operating condi-
tion. The number of three-phase circuits needed, current per phase, and losses are 
given by the voltage level.
With 400 kV lines:
Number of circuits = 5,000 MW/800 MW = 6.25
Current = (5,000 MW/3)/(400 kV/sqrt(3)) = 7.22 kA
Losses in % = 4.57
Total losses = 228.5 MW
With 750 kV lines:
Number of circuits = 5,000 MW/3,281 MW = 1.52
Current = (5,000 MW/3)/(750 kV/√(3)) = 3.85 kA
Losses in % = 2.66
Total losses = 133 MW
The preliminary answer—using this approximate model—suggests the use of seven 
circuits of 400 kV or two circuits working at 750 kV. An economic evaluation should 
follow this step. A related situation is the right of way; the 400 kV lines needs around 
40m each, and 80m are required for every 750 kV circuit lines. A simple comparison 
with a DC transmission line (not including the converter stations) and considering 
a ±400 kV bipolar scheme, using four conductors carrying 1,000 amperes each; 
then the DC power transfer capacity is 1,600 MW. For a DC bipolar voltage ±500 
kV, the power handling capacity goes up to 2,000 MW.
To handle 5,000 MW for the bipolar ±400 kV, the number of circuits is esti-
mated as 5,000 MW/1,600 MW = 3.12 with a current of (5,000 MW)/(400 kV) = 
15.5 kA. If a bipolar ±500 kV DC is considered, the estimated number of circuits 
are 5,000 MW/2,000 MW = 2.5, and current as (5,000 MW)/(500 kV) = 10.0 kA. 
The numbers point to solving by using four DC circuits working at ±400 kV or 
three DC circuits at ±500 kV. An economic evaluation should follow in which the 
right of way required has a high economic impact on the options. One alternative 
would be to increase the number of conductors per pole (i.e., four conductors per 
pole will handle 4,000A and 2,000 MW). Mechanical stress and structure design 
should follow more detailed studies.
Figure 5.2  Generation site remote from a load center.

5.3	
V(x) and I(x) Equations for a Long Transmission Line
141
5.2.2	 Reactive Power Required by the AC Transmission Line
The approximate real power transfer and the maximum real power were obtained 
by (5.4)–(5.5), and losses were obtained by (5.8). In the case of AC transmission 
lines, reactive power is required to support sending and receiving voltages within 
the 5% limit. Therefore, if we assume 400 kV and 400(0.95) kV. With gkm << bkm 
and bkm ≈ −1/xkm,
	
qkm ≈−V
2 + V
2 cosqkm
(
)bkm = V
2 1 −cosqkm
(
)
xl
	
(5.9)
Example 5.1
For a 200 km, 400 kV line, 50 Hz, in order to supply a three-phase load of 600 MW 
at unity power factor, by (5.9) angle θkm is required. The angle is calculated and then 
the reactive power from sending side qkm is obtained. sin θkm ≈ pkmxl/⎪Vk⎪⎪Vm⎪, 
with value of 0.2628 rad or 15.23°. The reactive power is calculated by (5.9), as qkm 
≈ 4002 (0.95)(1 − cos(15.23°))/(0.333)(200), as 80.2 MVARs. Sending voltage 400 
kV and receiving end at 400 (0.95) kV by the 5% voltage drop limit.
For a maximum power transfer of 1,200 MW, the reactive power required is 
305.7 MVARs, calculated by qkm ≈ 4002 (0.95)(1 − cos(30°))/(0.333)(200).
A series of detailed analysis must be carried out using load flow studies; this 
method of study will be presented in Chapter 6. One thing stands out from the 
approximated values: the transmission line needs reactive power support in order 
to fulfill its duties of real power transfer, in order to keep its operating variables 
within limits, and to include both light and heavy load conditions. More compre-
hensive studies need increased detailed models as the ones presented in Section 5.5.
5.3	
V(x) and I(x) Equations for a Long Transmission Line
As transmission lines of increased length are required, a more detailed model is 
needed to correctly represent the electromagnetic behavior. The model needs to relate 
steady state conditions as voltage phasor V and current phasor I with distance x. 
One common assumption is to start with a balanced transmission line and to write 
Figure 5.3  Incremental distance in a long transmission line, phasor relations.

142
Transmission Line Loadability
the incremental distance Δx relations for the voltage series drop ΔV and the incre-
mental current ΔI through the shunt component; z is the impedance in ohms per 
unit of length and y is the admittance in siemens per unit of length (see Figure 5.3).
	
ΔV = zΔxI
ΔI = yΔxV 	
(5.10)
The incremental voltage and current relations as Δx → 0
	
dV
dx = zI
dI
dx = yV 	
(5.11)
The differential equations in (5.10) are related through their derivatives:
	
d2V
dx2 = z dI
dx = zyV 	
(5.12)
Expression (5.12) has a characteristic polynomial (p2 − zy)V = 0 with two roots, 
which are written as γ = ± zy  = α + jβ. One general solution for phasor voltage 
V has the following form:
	
V(x) = A1e+g x + A2e−g x 	
(5.13)
α	
Attenuation constant, pu/unit of distance
β	
phase shift, radians/unit of distance
To prove that (5.13) is a solution to (5.12), we derive V(x) twice with respect to x, so:
d2V
dx2 = d
dx
dV
dx
⎛
⎝⎜
⎞
⎠⎟= d
dx pA1e+g x −pA2e−g x
(
) = g 2 A1e+g x + A2e−lx
(
) = zyV 	
(5.14)
Now, we focus on using voltage and current conditions at the boundaries as a means 
to find constants A1 and A2. We use boundary values known at terminal (x = 0, 
V(0) = VR). For current I, let us use (5.11) and define the characteristic impedance:
	
Zc =
z
y 	
(5.15)
	
I = 1
z
dV
dx = g
z A1e+g x −g
z A2e−g x =
A1
z/y e+g x −
A2
z/y e−g x 	
(5.16)
A system of equations from (5.13) and (5.16), using the receiving end conditions at 
x = 0, will help us solve for A1 and A2.

5.3	
V(x) and I(x) Equations for a Long Transmission Line
143
	
V(0) = VR = A1 + A2
I(0) = IR = A1
Zc
−A2
Zc
	
(5.17)
	
A1
A2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
VR + ZcIR
2
VR −ZcIR
2
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(5.18)
The solution for voltage V(x) and current I(x) is given by (5.19). The first part of 
these equations is called an incident wave and the second part a reflected wave.
	
V(x)
I(x)
⎡
⎣⎢
⎤
⎦⎥=
VR + ZcIR
2
+VR −ZcIR
2
VR/Zc + IR
2
−VR/Zc −IR
2
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
e+g x
e−g x
⎡
⎣⎢
⎤
⎦⎥	
(5.19)
5.3.1	 The Flat Line Concept
In case that, at the receiving end (where V(x = 0) = VR and I(x = 0) = IR), the imped-
ance load happens to be equal to the characteristic impedance ZC, then by (5.19) 
there will not be reflected wave and VR = ZCIR (see Figure 5.4).
5.3.2	 Surge Impedance, Wave Length and Propagation Velocity
In general, the characteristic impedance Zc is a complex number. For a lossless line 
(r = 0, g = 0) it has a particular real value in ohms and is known as surge impedance.
	
Zc =
L
C 	
(5.20)
The wavelength λ is a distance at which the wave is shifted by 2π radians. As γ = α 
+ jβ in the exponential eγx   =  e(α+jβ)x  = eαxe+jβx the term e+jβx is a phase shift that 
increases as x gets larger. When βx = 2π, we have the distance 2π/β as:
Figure 5.4  Characteristic impedance ZC as load at receiving end.

144
Transmission Line Loadability
	
l = 2p
b 	
(5.21)
The speed of propagation (m/s) relates distance λ and period T at a given frequency 
f in Hz:
	
n = l
T = f l 	
(5.22)
5.3.3	 No-Load Line and General Hyperbolic Form
For an open circuit or no load condition at x = 0, the receiving end has current as 
IR = 0. Therefore, (5.19) will give the voltage value V(x = 0) =VR and current I(x = 0) 
= IR = 0. The incident wave and the reflected wave cancel each other out, giving 
the condition IR = 0.
Writing in (5.19) an arrangement with VR and IR will give hyperbolic expres-
sions for a long transmission line. If we let x = d (the total line distance), we can 
write sending end conditions in terms of the receiving end, as in (5.23).
	
VS
IS
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
cosh(g d)
Zc sinh(g d)
1
Zc
sinh(g d)
cosh(g d)
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
VR
IR
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	
(5.23)
For the no-load case, IR = 0 in (5.23) gives voltage the VS = cosh (γ d)VR. From this 
no-load condition, (5.24) shows the case known as Ferranti effect, which explains 
why we have a higher voltage value at the receiving end; even when the line is work-
ing at an open circuit condition. The value for the sending current IS, under the 
same no-load condition is (5.25).
	
VR =
VS
cosh(g d) 	
(5.24)
	
IS = 1
Zc
sinh(g d)VR = 1
Zc
tanh(g d)VS 	
(5.25)
5.3.4	 Nominal π and Equivalent Circuit
Equivalent circuits for a transmission line relate sending and receiving voltage and 
current VS, IS, VR, IR through various parameters. Total impedance Z (ohms) and 
total admittance Y (siemens) are used in a nominal π circuit for a transmission line 
with distance d units of distance, z ohms/unit of distance, and y S/unit of distance, 
as shown in Figure 5.5.
	
Z = zd
Y = yd 	
(5.26)

5.3	
V(x) and I(x) Equations for a Long Transmission Line
145
Z	
Total line impedance, ohms
Y	
Total line admittance, siemens
z	
impedance per unit of distance, ohms/km
y	
admittance per unit of distance, siemens/km
d	
distance, km
Voltage and current equations for the sending end, as seen in Figure 5.5, are:
	
VS = VR + Z IR +
Y
2VR
⎛
⎝⎜
⎞
⎠⎟=
1 + ZY
2
⎛
⎝⎜
⎞
⎠⎟VR + ZIR 	
(5.27)
	
IS =
Y
2VS
+
Y
2VR
+ IR = Y 1 + ZY
4
⎛
⎝⎜
⎞
⎠⎟VR + 1 + ZY
2
⎛
⎝⎜
⎞
⎠⎟IR 	
(5.28)
	
VS
IS
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
1 + ZY
2
⎛
⎝⎜
⎞
⎠⎟
Z
Y 1 + ZY
4
⎛
⎝⎜
⎞
⎠⎟
1 + ZY
2
⎛
⎝⎜
⎞
⎠⎟
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
VR
IR
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	
(5.29)
5.3.5	 Long Line Equivalent Circuit
For the long-distance transmission line, an equivalent circuit similar to (5.23) can 
be written. If we compare the terms to the hyperbolic form; the equivalent circuit 
for a long transmission line is shown in Figure 5.6:
	
VS
IS
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
1 +
′
Z
′
Y
2
⎛
⎝⎜
⎞
⎠⎟
′
Z
′
Y
1 +
′
Z
′
Y
4
⎛
⎝⎜
⎞
⎠⎟
1 +
′
Z
′
Y
2
⎛
⎝⎜
⎞
⎠⎟
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
VR
IR
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(5.30)
Figure 5.5  Nominal π circuit, total impedance Z and total admittance Y for a transmission line.
Figure 5.6  Equivalent circuit for a long distance transmission line.

146
Transmission Line Loadability
	
′
Z = Zc sinh(g d) = Z sinh(g d)
g d
	
(5.31)
	
′
Y
2 = cosh(g d) −1
′
Z
= cosh(g d) −1
Zc sinh(g d) = Y
2
tanh(g d/2)
g d/2
	
(5.32)
From (5.31) by direct comparison of Z′ and admittance Y′ we identify the correc-
tion factors for the total impedance Z and admittance Y. The long transmission 
line impedance Z′ and admittance Y′/2 are obtained.
5.4	
ABCD Constants
One matrix that relates the sending to the receiving voltage and current is written 
for the two-terminal circuit using nodal voltages and line currents (assuming that 
positive sequence values are known); see Figure 5.7.
	
VS
IS
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
A B
C D
⎡
⎣⎢
⎤
⎦⎥
VR
IR
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(5.33)
In general, the A, B, C, D constants are complex numbers whose values depend on 
the total parameters R, L, C, and G of the transmission line element. A, D have no 
dimensions, B is in ohms, and C in Siemens.
For a passive circuit that is linear and bilateral (see Figure 5.8), with r (Ω/km) 
and ωL (Ω/km), length of 𝓁 (km). R = r𝓁 and X = ωL l, then Z = R +jX. From (5.34) 
and matrix (5.35) A = D = 1, B = Z, and C = 0.
	
VS = ZIS + VR
IS = IR 	
(5.34)
Figure 5.7  Variables in a two-port network.
Figure 5.8  Two-port element for series impedance.

5.4	
ABCD Constants
147
	
VS
IS
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
1 Z
0 1
⎡
⎣⎢
⎤
⎦⎥
VR
IR
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(5.35)
For a nominal π circuit (see Figure 5.9), the ABCD constants of a mid-length trans-
mission line (40–100 km) are as in (5.37). We start with (5.36) and VS is already in 
terms of VR and IR, some algebra is required to get IS in terms of VR and IR. From 
(5.37), we find directly that A = D = 1 + YZ/2, B = Z, and C = Y(1 + YZ/4).
	
IR + Y
2 VR = VS −VR
Z
VS =
1 + YZ
2
⎛
⎝⎜
⎞
⎠⎟VR + ZIR 	
(5.36)
	
VS
IS
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
1 + YZ
2
⎛
⎝⎜
⎞
⎠⎟
Z
Y 1 + YZ
4
⎛
⎝⎜
⎞
⎠⎟
1 + YZ
2
⎛
⎝⎜
⎞
⎠⎟
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
VR
IR
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(5.37)
For a shunt admittance element (see Figure 5.10), the ABCD constants are deduced 
by writing voltages VS = VR, and the current IS = Ysh VR + IR. The constant are A 
= D = 1, B = 0, and C = Ysh.
	
VS
IS
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
1
0
Ysh 1
⎡
⎣⎢
⎤
⎦⎥
VR
IR
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(5.38)
Where A = D = 1, B = 0, and C = Ysh (siemens).
Figure 5.9  ABCD constants for a two-port π network.
Figure 5.10  Shunt admittance and ABCD constants.

148
Transmission Line Loadability
5.4.1	 ABCD Equivalent for Series Connection
For circuits with an ABCD representation that need to be connected in series (see 
Figure 5.11), the boundary voltages and currents are conditions that must be met. 
In this case, voltages VR1 = VS2 and IR1 = IS2. Starting with ABCD expressions 
for each series component, (5.39) and when connected the final result follows: the 
ABCD constants for the series equivalent are obtained by matrix multiplication.
	
VS1
IS1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
A1
B1
C1 D1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
VR1
IR1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
VS2
IS2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
A2
B2
C2 D2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
VR2
IR2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(5.39)
	
VS1
IS1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
A1
B1
C1 D1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
A2
B2
C2 D2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
VR2
IR2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(5.40)
5.4.2	 Nodal Admittance Matrix from ABCD Constants
Starting with ABCD values for a given circuit, algebra will be used to identify the 
nodal admittance values. From (5.33) and recognizing the property that AD − CB 
= 1, IS and IR are written in terms of VS and VR.
	
VS = AVR + BIR
IS = CVR + DIR 	
(5.41)
Current IR from (5.41) is substituted into IS in order to find the elements that go into 
the first row of (5.42). Nodal current is assumed to be positive when it goes into 
a node, then nodal current IR has a negative sign. The nodal admittance matrix is 
obtained as (5.43).
	
+D
B
−1
B
−1
B
+A
B
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
VS
VR
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
IS
IR
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(5.42)
	
Ynodal =
+D
B
−1
B
−1
B
+A
B
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(5.43)
Figure 5.11  Series connection of two ABCD models.

5.4	
ABCD Constants
149
Example 5.2
A 115 kV transmission line has positive sequence parameters, and its operating fre-
quency is 50 Hz. Series reactance x = 0.4178 Ω/km, shunt susceptance bsh = 2.767 
× 10–6 S/km, series resistance r = 0.1463 Ω/km. Assuming that approximations can 
be carried out, estimate the maximum power transfer, given that 30° is set by the 
stability limit. Find the surge impedance loading (SIL) value and estimate power 
losses in percentage all for a length of 140 km. Estimate the reactive power required 
in order to handle the real power.
	
pkm
max ≈V
2
xl sin p
6
⎛
⎝⎜
⎞
⎠⎟= 0.5 V
2
xl 	
(5.44)
	
Zc =
x
bsh 	
(5.45)
	
SIL = kV 2
Zc
	
(5.46)
	
PLoss
pkm
% = 100 sinqkm
x/r
= 50.0
x/r 	
(5.47)
Transmission line loadability
Voltage =    115 kV       length =    140 km
r       =   0.1463   Ohms/km
x       =   0.4178   Ohms/km
bsh     =   2.7670e-006 S/km
MaxP    = 113.0496 MW (30 degrees limit)
SIL     =  34.0342 MW     Pmax   =   3.3216 pu of SIL
Losses  =  17.51 in percentage
q_req   =  30.29 MVARs    q_req  =   0.8900 pu of SIL
Imax    = 392.00 Amp/conductor
Pthermal=  78.0809 MW     Pmax   =   2.2942 pu of SIL
The formulas used to calculate the required values are plotted in Figure 5.12:
	
pkm ≈Vk Vm
xkm
sinqkm ≈V
xl
2
x/bsh
Zc
sinqkm 	
(5.48)
	
pkm
SIL ≈sinqkm
xbshl 	
(5.49)
	
qkm(l) = Vk Vm cos qkm
(
) −Vm
2 cos(bl)
Zc sin(bl)
	
(5.50)

150
Transmission Line Loadability
	
qkm(l)
SIL
=
1
tan(bl) −cos qkm
(
)
sin(bl) 	
(5.51)
For the transmission line with a length of 140 km and a load variation from 0 to 
3.2 pu of SIL within the stability limit, starting with the required power, the angle 
Figure 5.12  Loadability plots for stability limit of 30°.
Figure 5.13  Compensation requirements for a 140 km and 115kV transmission line.

5.5	
Power Flow Calculations using ABCD Constants
151
θkm can be determined by (5.49) and the reactive power in pu of SIL is calculated 
with (5.51). Results in pu of SIL are shown in Figure 5.13. The range of required 
reactive power to maintain a 1.0 pu voltage at terminals is:
qreqmin = -2.57 MVARs and qreqmax = 27.81 MVARs
If the line length is quite large (i.e., 400 km), the real power that can be transmitted 
and the reactive power needed in pu of SIL are much less than for the case of 140 
km line. This is shown in Figure 5.14. Now the reactive power required is:
Qrecmin = -6.82 MVARs and Qrecmax = 4.93 MVARs
5.5	
Power Flow Calculations using ABCD Constants
Real and reactive power can be obtained from terminal relations in the ABCD frame 
of reference. From Figure 5.7 and (5.33), using VR as reference and VS = ⎪VS⎪∠δ, 
VR = ⎪VR⎪∠0° and IR = ⎪IR⎪∠θ, A = ⎪A⎪∠α, B = ⎪B⎪∠β. Complex power for the 
receiving end where VS = AVR + BIR is a circle with center and radius as follows.
	
SR = VRIR
∗= VR ∠0° VS −AVR
B
⎛
⎝⎜
⎞
⎠⎟
∗
	
(5.52)
	
PR = VR VS
B
cos(b −d) −A VR
2
B
cos(b −a) 	
(5.53)
Figure 5.14  Compensation requirements for a 400 km and 115 kV transmission line.

152
Transmission Line Loadability
	
QR = VR VS
B
sin(b −d) −A VR
2
B
sin(b −a)	
(5.54)
	
Center −A VR
2
B
cos(b −a),−A VR
2
B
sin(b −a)
⎛
⎝
⎜⎜
⎞
⎠
⎟⎟	
(5.55)
	
Radius VR VS
B
	
(5.56)
When the receiving voltage has constant magnitude⎪VR⎪, the center is fixed and the 
radius depends on the magnitude of ⎪VS⎪.
Example 5.3
For a three-phase transmission line and given ABCD constants, receiving voltage is 
220 kV and the three-phase load is 40 MW with a lagging 0.9 power factor. Find 
the center of the circle and the per phase current at the receiving end. Calculate the 
sending end voltage, the δ power angle (load angle), and the radius of the receiving 
circle (see Figure 5.15).
Constants ABCD, circles for receiving and sending ends
       A             B(Ohms)           C(S)              D
  9.360000e-001    3.350000e+001   -5.180000e-006    9.360000e-001
Figure 5.15  Circle diagram at the receiving end.

5.5	
Power Flow Calculations using ABCD Constants
153
j+1.600000e-002  j+1.380000e+002  j+9.140000e-004  j+1.600000e-002
Voltage VR   =    220.00 kV   angle =   0.00 degrees
Power factor =     -0.9000    angle = -25.84 degrees
SR =    40.00 +j   19.37 MVA total
CenterR at (  -80.56,  -308.72) MVAs
Current IR   =    116.64 A    angle = -25.84 degrees (A/phase)
Voltage VS   =    225.63 kV   delta angle =   6.53 degrees
RadiusR      =    349.54 MVAs
At the sending terminal, using VS as a reference and the inverse matrix from (5.33), 
then VR = DVS − BIS, multiplying by −1/B and to apply the complex power defini-
tion as load convention, we use the conjugated current.
	
−VS
VR
B
⎛
⎝⎜
⎞
⎠⎟
∗
= −VS
DVS
B
⎛
⎝⎜
⎞
⎠⎟
∗
+ VSIS
∗	
(5.57)
This is the equation of a circle with center and radius as:
	
Center + D VS
2
B
cos(b −Δ),+ D VS
2
B
sin(b −Δ)
⎛
⎝
⎜⎜
⎞
⎠
⎟⎟	
(5.58)
	
Radius VR VS
B
	
(5.59)
For a fixed magnitude ⎪VR⎪, the radius and the center depend on the magnitude ⎪VS⎪.
Example 5.4
Using previous data given in Example 5.3, calculate the circle diagram, the com-
plex power, and the net power at the sending end. Calculate the voltage drop in 
percentage (see Figure 5.16).
Current IS   =    120.8745 A  angle =  35.50 degrees (A/phase)
CenterS at (   84.73,   324.72) MVAs
RadiuS       =    349.54 MVAs
SS =    41.33 +j  -22.88 MVA total
P Losses     =      1.33 MW
Q required   =    -42.25 MVARs (<0 to the system, >0 to the line)
Vdrop  =      2.49 percentage
Circle diagrams are useful when visualizing the range of operation for a transmission 
line, including its long-line representation through the ABCD constants. Inclusion 
of line series compensations and other arrangements can be accomplished easily 
through the properties of two-port networks (as previously discussed in Section 5.4).

154
Transmission Line Loadability
5.6	
Transmission Limits
5.6.1	 Thermal Limit
Depending on the type and geometry of the phase conductors, a maximum cur-
rent is recommended by the manufacturer. The ambient temperature, wind, and 
weather conditions will play an important role in establishing the actual current 
that phase conductors will carry with no detrimental effects on conductor’s prop-
erties. In our case, a simplified calculation is carried out with no inclusion of all 
the factors involved.
	
Smax = 3 V
3 Imax   MVAs 	
(5.60)
V	
magnitude of phase-to-phase voltage, kV
Imax	 kA, maximum recommended current from manufacturer. Temperature, 
wind, and weather data is not included.
5.6.2	 Stability’s Angle Limit
To have a reasonable stability margin, an angle of 30° is used to guard against wide 
power swings during transient oscillations. A maximum power limit can be calcu-
lated for a line with length 𝓁 in km, x in ohms/km, and bsh in S/km.
	
pkm
SIL ≈sinqkm
xbshl 	
(5.61)
Figure 5.16  Circle diagram at the sending end.

5.6	
Transmission Limits
155
5.6.3	 Limit from Voltage Drop
When power is transmitted, a voltage drop is experienced, especially during heavy 
load conditions. The allowed voltage drop of 5% during the planning stage is used 
to determine the maximum power that the line will handle. In an operation setting, 
a maximum voltage drop of 7% for short periods can be permitted. The power 
circle equations can be used to establish the value of the voltage drop (see Figure 
5.17); this preliminary result can be useful before detailed power load flow studies 
are conducted.
Example 5.5
Using the data provided in Example 5.4, calculate the transmission limits, assuming 
one conductor/phase with capacity of 1,000 Amp.
Constants ABCD, Max Power. Receiving Circle
        A             B (Ohms)           C(S)
    0.936000          33.500000         -0.000005
j+  0.016000       j+138.000000      j+  0.000914
ABCD Magnitude and angle (degrees)
    0.936137         142.007922          0.000914
    0.98              76.36             90.32
Transmission limits
Voltage drop 5 percent
VS    =  220.00 kV   VR =  209.52 kV   Radius =    324.60 MVAs
PS    =  172.14 MW   QS =   -3.41 MVAR        172.17 MVAs
PR    =  150.97 MW   QR =  -45.13 MVAR        157.57 MVAs
Losses=   21.17 MW   Q  =   41.72 MVAR (>0 needed by TL)
Figure 5.17  Total power at the receiving end, voltage drop 5%.

156
Transmission Line Loadability
delta =   30.00 degrees
Stability values for delta = 30 degrees
VS    =  220.00 kV   VR =  220.00 kV   Radius =    340.83 MVAs
PS    =  176.53 MW   QS =  -18.31 MVAR        177.48 MVAs
PR    =  154.68 MW   QR =  -62.09 MVAR        166.67 MVAs
Losses=   21.85 MW   Q  =   43.78 MVAR (>0 needed by TL)
Thermal limit
Imax  =   1000 Amp    cond/phase =   1        381.05 MVAs
Results show that the transmission limit is set by the voltage drop criteria of 5%. 
Additional information as reactive compensation required and losses incurred at 
the limiting values is an additional valuable information for the planning design 
and the operation of this transmission line.
5.7	
Wave Equation and Time Expressions
In Section 5.3, phasor equations were used to derive results for the distributed 
parameters of a long transmission line. From (5.12), its Laplace transform is like 
(5.62). To include the time variable t we write the Laplace transformed equations 
for voltage and current. The inverse Laplace Transform will take us back to the 
time domain t. The exponential function at the Laplace domain represents a time 
displacement:1*
	
V(x,s) = AV(s)e−sx LC + BV(s)e+sx LC
	
(5.62)
	
v(x,t) = AV t −x LC
(
) + BV t + x LC
(
) 	
(5.63)
Similar properties are applied for the current expression.
	
i(x,t) = AI t −x LC
(
) + BI t + x LC
(
) 	
(5.64)
The coefficients AV, BV, AI, and BI are to be determined by the values at the bound-
ary, as well as at the sending and receiving end of the transmission line.
5.7.1	
Product x LC  and Speed ν
The product of distance x (meters) times LC  must be in time unit of seconds, so ν 
will be the propagation speed in m/s, inductance L in (H) and capacitance C in (F).
	
t = x LC 	
(5.65)
	
t
x =
LC = 1
n 	
(5.66)
* L f (t −t)
[
] = F(s)e−st

5.7	
Wave Equation and Time Expressions
157
	
n =
1
LC   m/s 	
(5.67)
For a given transmission line, the inductance L is proportional to μ and capacitance 
C is proportional to ε, which means that—at the vacuum—the propagation speed 
is ν ≈ 1/ m0e0  with value of 1/
4p10−7 H/m
(
)(8.854 10−12 F/m)  ≈ 300,000 km/s. 
The values ε/ε0 that can be found for cables approximates a value of 5, which means 
that cables ν = 134,000 km/s.
5.7.2	
Functions AV(t − x/ν) and AI(t − x/ν)
The expression AV(t − x/n) in (5.63) represents a traveling voltage in the positive x 
direction with speed ν. If we assume in Figure 5.18 that AV = f+(u), where u = t − 
x/ν, at time t1 the wave is located at u1, with x1 = ν (t1 − u1). For a different time 
t2, where t2 > t1, the wave is found now at x2 = ν (t2 − u2); and x2 > x1. The wave 
has travelled a distance x2 − x1; the time spent is t2 − t1 and the speed is ν = (x2 − 
x1)/(t2 − t1). A similar conclusion can be reached for AI(t − x/ν); these are traveling 
waves moving forward.
The wave AV(t + x/ν) is a voltage that travels in the negative direction of x. 
The speed is ν and we conclude that AV is a traveling wave. Assume that AV = f–
(u); where u = t + x/ν, then at time t1 the wave is situated at position u1, or x1 = ν 
(u1 − t1). From Figure 5.19, t2 > t1, the wave is located at x2 = ν (u2 − t2). The wave 
has traveled the distance (x2 − x1) using the time (t2 − t1). From these results, we 
Figure 5.18  Traveling waves in the forward direction, positive x.
Figure 5.19  Traveling waves in the backward direction, negative x.

158
Transmission Line Loadability
conclude that the speed is negative as ν = (x2 − x1)/(t2 − t1). The same reasoning can 
be applied to AI(t + x/ν); these are waves moving backward (shown in Figure 5.19).
5.7.3	
Expressions for AV, BV, AI, BI
With a substitution of voltage and current functions at the transmission line differ-
ential equations, we identify the constant term known as the characteristic imped-
ance ZC = L/C  in (5.20). The second derivative of (5.62) with respect to x and 
the first derivative of current I(x, s) must satisfy (5.14) with n = 1/ LC . At the 
left, we substitute the second derivative of voltage, and at the right, the derivative 
of the current, equating right and left side components.
	
d2V(x,s)
dx2
= −sL dI(x,s)
dx
	
(5.68)
s
n
⎛
⎝⎜
⎞
⎠⎟
2
AV(s)e−sx/n +
s
n
⎛
⎝⎜
⎞
⎠⎟
2
BV(s)e+sx/n = −sL −s
n AI(s)e−sx/n + s
ν BI(s)e+sx/n
⎡
⎣⎢
⎤
⎦⎥	
(5.69)
Expressions for the backward waves:
	
BI(s) = −CnBV(s) =
C
LAI(s) = −BV(s)
ZC
	
(5.70)
For the forward waves:
	
AI(s) = CnAV(s) =
C
LAI(s) = AV(s)
ZC
	
(5.71)
Expression for v(t, x) and i(t, x), now with coefficients AV, BV, AI, and BI in (5.70) 
and (5.71), the Inverse Laplace Transform will give us v(x, t) and i(x, t).
	
V(x,s) = Zc AI(s)e−sx/n −BV(s)e+sx/n
⎡⎣
⎤⎦	
(5.72)
	
v(x,t) = Zc aI(t −x/n) −bV(t + x/n)
⎡⎣
⎤⎦	
(5.73)
	
I(x,s) = AI(s)e−sx/n + BI(s)e+sx/n 	
(5.74)
	
i(x,t) = 1
Zc
aV(t −x/n) −bV(t + x/n)
⎡⎣
⎤⎦	
(5.75)
5.7.4	
Reflexion Coefficients
A wave that travels to the receiving end located at a distance x = l (Figure 5.20), which 
represents the total line length; part of the wave is reflected and part is refracted. To 

5.7	
Wave Equation and Time Expressions
159
study what happens as time increases, it is a good idea to calculate the coefficients 
and then express how the incoming wave is split into a wave that is reflected and a 
wave that is kept at the receiving end. The boundary conditions must be satisfied 
for both the current and voltage waves. To determine the reflexion and refraction 
coefficients, let us start with a voltage wave in the Laplace domain, assuming that 
there is an impedance ZR(s) connected at the end of the transmission line.
At x = 𝓁, the voltage expression using previous results in (5.72) and (5.74).
	
V(l,s) = ZR(s)I(l,s) 	
(5.76)
	
AV(s)e−sl /n + BV(s)e+sl /n = ZR(s) 1
ZC
AV(s)e−sl /n −BV(s)e+sl /n
⎡⎣
⎤⎦	
(5.77)
	
BV(s)e+sl /n 1 + ZR(s)
ZC
⎡
⎣⎢
⎤
⎦⎥=
ZR(s)
ZC
−1
⎡
⎣⎢
⎤
⎦⎥AV(s)e−sl /n 	
(5.78)
Reflection coefficient ΓR at the receiving end can be defined as the portion of the 
forward wave that is reflected as a backward wave.
	
ΓR =
ZR(s) −ZC
⎡⎣
⎤⎦
ZR(s) + ZC
⎡⎣
⎤⎦
	
(5.79)
Similar reasoning is applied to finding the reflection coefficient at the sending end.
	
ΓS =
ZS(s) −ZC
⎡⎣
⎤⎦
ZS(s) + ZC
⎡⎣
⎤⎦
	
(5.80)
5.7.5	
Calculation of Coefficients
At a transition point where elements with different characteristic impedances are 
connected, incident waves have a part of it reflected and part refracted. For the 
incident wave, the part that is reflected travels back and the part that is refracted 
continues to travel to the next element. It is interesting to calculate the refracted 
portion as this value travels to the next characteristic impedance down the series 
Figure 5.20  Transmission line, characteristic impedance Z0, and terminal impedance ZR(s).

160
Transmission Line Loadability
of connections, and the overvoltage needs to be estimated so that the insulation 
strength level is selected.
Continuity at boundary conditions requires that for the voltage waves V1 + V2 
= V3 and for currents I2 + I3 = I1 (see Figures 5.21 and 5.22). These relations are 
written in terms of the incoming source voltage V1. A matrix array can be written 
using voltages as and currents through the characteristic impedance.
	
−V2 + V3 = V1 	
(5.81)
	
+ V2
ZA
+ V3
ZB
= V1
ZA 	
(5.82)
	
−1
+1
+1 + ZA
ZB
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
V2
V3
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
1
1
⎡
⎣⎢
⎤
⎦⎥V1 	
(5.83)
Solving for V2 and V3:
	
V2
V3
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
ZB −ZA
ZB + ZA
2ZB
ZB + ZA
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
V1 	
(5.84)
The inverse matrix from (5.83), together with the identity V1 = V1, gives a set of 
coefficients (reflection a and refraction b) for the series arrangement of impedances 
discussed in this section. Traveling currents I1, I2, and I3 are related to traveling 
voltages through characteristic impedances, so the matrix equation (5.86) can finally 
express how the transient voltage V1 will determine currents I1, I2, and I3.
	
V1
V2
V3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
1
ZB −ZA
ZB + ZA
2ZB
ZB + ZA
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
V1 =
1
a
b
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
V1	
(5.85)
Figure 5.21  Boundary conditions at point of connection, characteristic impedances ZA and ZB.

5.7	
Wave Equation and Time Expressions
161
	
I1
I2
I3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
1/ZA
0
0
0
1/ZA
0
0
0
1/ZB
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
V1
V2
V3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(5.86)
	
I1
I2
I3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
1/ZA
0
0
0
1/ZA
0
0
0
1/ZB
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
1
ZB −ZA
ZB + ZA
2ZB
ZB + ZA
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
V1	
(5.87)
Example 5.6
A voltage of V1 = 300 kV is applied at the terminal of the overhead line; a cable is 
connected in series. The values of the characteristic impedances for the transmis-
sion line and the cable are ZA = 400 Ω, and ZB = 50 Ω. The connection diagram 
is shown in Figure 5.21.
Data of Characteristic impedances
Line Characteristic impedance  =   400.00(ohms)
Cable Characteristic impedance =    50.00(ohms)
Reflexion coefficient a =  -0.7778   Refraction coefficient b =   0.2222
Voltage(  1) =      300000.00(volts)  Current(  1) =         750.00(Amp)  
Voltage(  2) =     -233333.33(volts)  Current(  2) =        -583.33(Amp)  
Voltage(  3) =       66666.67(volts)  Current(  3) =        1333.33(Amp)  
Example 5.7
Write the algebraic equations for the incident and the reflected waves at a transition 
point for a series configuration with an overhead line and a cable. Use the diagram 
in Figure 5.23 to write the set of equations that characterize the boundary condi-
tions at the sending end and at the connecting point A for voltages and currents as 
traveling waves.
Figure 5.22  Visual image for traveling voltages and currents, before and after reaching the 
receiving end.

162
Transmission Line Loadability
First, we write the equations for the incident wave, then for the reflected and 
the refracted waves. Follow with those equations for the continuity of voltage and 
current at node A.
	
(1)
−ZAI1 = −V1
(2)
−ZAI2 + V2 = 0
(3)
−ZBI3 + V3 = 0
A
+I1 −I2 −I3 = 0
VA
−V2 + V3 = +V1
	
(5.88)
The equations in matrix form where Ohm’s law for traveling waves is applied, plus 
the transition point continuity conditions for currents and voltages.
	
−ZA
0
0
0
0
0
−ZA
0
+1
0
0
0
−ZB
0
+1
+1
−1
−1
0
0
0
0
0
−1 +1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
I1
I2
I3
V2
V3
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
=
−1
0
0
0
+1
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
V1 	
(5.89)
For an incoming voltage V1 = 300 kV through impedances ZA = 400 ohms and ZB 
= 50 ohms, find the reflection coefficient a and refraction b. Calculate the magni-
tudes of all voltages and currents.
V1 =	
300000
ZA =	
400
ZB =	
50
A =
	
-400	
0	
0	
0	
0
	
0	
-400	
0	
1	
0
	
0	
0	
-50	
0	
1
	
1	
-1	
-1	
0	
0
	
0	
0	
0	
-1	
1
Coefficients
Reflection  a = -0.777778
Figure 5.23  Continuity of voltage and current waves, incident end and at node A.

5.7	
Wave Equation and Time Expressions
163
Refraction  b = 0.222222
Values
Current (  1) =	 +750.00 A
Current (  2) =	 -583.33 A
Current (  3) =	 +1333.33 A
Voltage (  2) =	 -233333.33 V
Voltage (  3) =	 +66666.67 V
Example 5.8
Calculate the reflection and refraction coefficients for a series connection of an 
overhead line ZA = 500 Ω with a resistance R = 550 Ω and a cable section with ZB 
= 50 Ω (see Figure 5.24). Note that R is a concentrated parameter element, and that 
ZA and ZB are characteristic impedances associated with distributed parameters 
elements as L and C for an overhead line and a cable section.
	
(1)
−ZAI1 = −V1
(2)
−ZAI2 + V2 = 0
(3)
−R + ZB
(
)I3 + V3 = 0
A
+I1 −I2 −I3 = 0
VA
−V2 + V3 = +V1
	
(5.90)
	
−ZA
0
0
0
0
0
−ZA
0
+1
0
0
0
−R + ZB
(
)
0
+1
+1
−1
−1
0
0
0
0
0
−1 +1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
I1
I2
I3
V2
V3
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
=
−1
0
0
0
+1
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
V1 	
(5.91)
V1 =  1      ZA =  500    R   =  550     ZB =   50
A =
  -500     0     0     0     0
     0  -500     0     1     0
     0     0  -600     0     1
     1    -1    -1      0     0
Figure 5.24  Continuity of voltage and current waves, incident end and at node A.

164
Transmission Line Loadability
     0     0     0     -1     1
Coefficients
Reflection  a = 0.090909
Refraction  b = 1.090909
Values times V1
Current (  1) = +2.00000e-003 A
Current (  2) = +1.81818e-004 A
Current (  3) = +1.81818e-003 A
Voltage (  2) = +9.09091e-002 V
Voltage (  3) = +1.09091e+000 V
Besides currents and voltages, we might be interested in calculating how much energy 
is associated with each portion of the circuit. Relations that we have in terms of 
incoming voltage V1 and current I1 are: V1 = ZAI1 = 500 I1, IB = I3 = 0.00181818 
V1 = 0.90909 I1, IrA = I2 = 0.000181818 V1 = 0.090909 I1 and VB = V3 − I3R = 
0.090909 V1. From here, the energy in R is RI3
2 = 550(0.090909 I1)2 = 454.5 I1
2 = 
454.5/500 V1I1 = 0.090909 V1I1 and the energy in B is VBIB = I2 = (0.090909 V1) 
0.090909 I1 = 0.08264 V1I1. The reflected energy is V2I2 = (0.090909 V1) 0.090909 
I1 = 0.08264 V1I1.
V1 =  1     ZA =  500     R   =  550     ZB =   50
A =
  -500     0     0     0     0
     0  -500     0     1     0
     0     0  -600     0     1
     1    -1    -1      0     0
     0     0     0     -1     1
Coefficients
Reflection  a = 0.090909
Refraction b = 1.090909
Values times V1
Current (  1) = +2.00000e-003 A
Current (  2) = +1.81818e-004 A
Current (  3) = +1.81818e-003 A
Voltage (  2) = +9.09091e-002 V
Voltage (  3) = +1.09091e+000 V
5.7.6	
Coefficients for Connection of Various Elements
In order to solve for various configurations (see Figure 5.25) there are, as we have 
presented, a few conditions that must be met: 1) incident wave conditions, 2) reflected 
waves, and 3) refracted waves, which in general must satisfy the continuity condi-
tion for currents and voltages.
	
I1A = I2A + I3B + I3C
V1A + V2A = V3B
V1A + V2A = V3C
	
(5.92)

5.7	
Wave Equation and Time Expressions
165
The equation in matrix form, including Ohm’s law for each element:
	
−ZA
0
0
0
0
0
0
0
−ZA
0
0
+1
0
0
0
0
−ZB
0
0
+1
0
0
0
0
−ZC
0
0
+1
+1
−1
−1
−1
0
0
0
0
0
0
0
−1 +1
0
0
0
0
0
−1
0
+1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
I1A
I2A
I3B
I3C
V2A
V3B
V3C
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
−1
0
0
0
0
+1
+1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
V1A 	
(5.93)
5.7.7	
Lattice Diagram
With the information about reflecting and refracting coefficients at the sending 
end and the receiving end a lattice diagram for Figure 5.26 can be constructed to 
show, as time advances, how the transient voltage and the current evolve at either 
side, sending or receiving.
Figure 5.25  Configuration of various elements and its characteristic impedances.
Figure 5.26  Simple arrangement of a transmission line, its characteristic impedance and load Z.

166
Transmission Line Loadability
	
1
as
bs
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
1
Zs −Z1
Zs + Z1
2Zs
Zs + Z1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
1
ar
br
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
1
Z −Z1
Z + Z1
2Z
Z + Z1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(5.94)
The following steps summarize the way in which the lattice diagram is constructed 
(see Figure 5.27):
1.	 Select a vertical scale in ms or in pu, selecting the time to travel as τ = LC
2.	 Choose a horizontal scale to represent the line length x.
3.	 Calculate values for reflection and refraction coefficients at both extremes 
of the transmission line.
5.7.8	
Electric Element Connections at Receiving Terminal
One interesting question is: What is the circuit’s time response for the traveling wave’s 
voltage and current when a unit step voltage is applied at the sending end? What 
is the voltage as time progresses from initial time, up to the final time t seconds? 
What is the transient for various line terminations (see Figure 5.28): open circuit, 
shorted circuit, or an impedance value? In Figure 5.30, the transient equations for 
an inductor at the end of the line are written.
The receiving reflection and refraction coefficients are calculated as in (5.94).
1.	 We need an equivalent, as seen from nodes A and B, looking into the power 
source (see Figure 5.29).
2.	 Connect element L or C in the Laplace domain, and solve for voltage as 
function of time.
Figure 5.27  Lattice diagram, distance x at the horizontal axis, vertical scale τ time travel.

5.7	
Wave Equation and Time Expressions
167
3.	 Calculate the reflected voltage at the remote extreme.
	
vR = vAB = vi + vr 	
(5.95)
	
vAB = vi +
Z1 −Z0
Z1 + Z0
⎛
⎝⎜
⎞
⎠⎟vi =
Z1
Z1 + Z0
2vi 	
(5.96)
	
iR = vAB
Z1
=
2vi
Z1 + Z0
	
(5.97)
5.7.8.1	 Reactor L at the Receiving End
When element L is connected, we use the Laplace domain to find the time solution. 
The reflected voltage at the remote terminal is also calculated.
First, solve for the equivalent circuit in the Laplace domain, then use the inverse 
Laplace transform to find the solution at the time domain.
	
VAB(s) =
2vi /s
Z0 + sL
(
)
sL =
2vi
Z0/L + s
(
)
	
(5.98)
Figure 5.28  Circuit configuration with voltage source, transmission line’s characteristic 
impedance Z0, and impedance ZAB at receiving end.
Figure 5.29  Thévenin’s equivalent circuit.

168
Transmission Line Loadability
	
vAB(t) = 2vie−Z0 /L
(
)t 	
(5.99)
	
vr = vAB(t) −vi(t) = vi 2e−Z0 /L
(
)t −1
(
) 	
(5.100)
For the reflected voltage vr, there is an open circuit at t = 0 for this condition vr = 
vi. As t → ∞, vr → −vi; and it represents a short circuit condition.
References
[1]	
Stevenson, W. D., Elements of Power System Analysis, Second Edition, Tokyo, Japan: 
McGraw-Hill Book Company, 1962.
[2]	
Edited by Edison Electric Institute, EHV Transmission Line Reference Book, 1968.
[3]	
Edited by Electric Power Research Institute, Transmission Line Reference Book: 345 kV 
and Above, Second Edition, 2006.
[4]	
Greenwood, A., Electrical Transients in Power Systems, Second Edition, New York: 
Wiley-Interscience, 1991.
[5]	
Das, J. C., Transients in Electrical Systems, Singapore: McGraw-Hill Education, 2010.
Figure 5.30  Thévenin’s equivalent, impedance, and load connection.

169
C h a p t e r  6
Power Flows
6.1	
Introduction
Power flow studies are a fundamental tool for power system engineers; they solve 
the steady state condition of an electrical network. Assuming an AC system as a 
balanced three-phase network and assuming that the positive sequence parameters 
are available, we establish the network problem with known topology and imped-
ance values, which include transformers, transmission lines, power injections from 
generators, and real and reactive power loads that must be satisfied within nodal 
voltage limits. The crux of this circuit problem is to solve for all nodal voltages for 
every electrical node. With this information and element impedance we calculate 
current, real power, reactive power, and losses. Planning engineers use the load flow 
solution to analyze alternatives and an adequate system expansion; the load flow 
is the cornerstone for power system operation. When solving the nonlinear set of 
equations, the Newton-Raphson iterative method generally shows fast convergence. 
In this chapter, we revise the nature of the convergence process for nonlinear equa-
tions; we discuss in detail the power flow equations and their solutions in a general 
form that encompasses the iterative Newton’s nodal frame of reference.
6.2	
Solution of Nonlinear Equations
Let us begin with a discussion of nonlinear equations and convergence using a simple 
DC power transfer over a transmission element (as shown in Figure 6.1); voltages, 
current, and resistance are in pu values.
Power from node k to node m with current ikm = Vk −Vm
(
)/rkm,  then power 
flows and losses are:
	
pkm = Vkikm = Vk
2 −VkVm
(
)
rkm
	
(6.1)
Figure 6.1  Simple DC transmission model, nodes k and m.

170
Power Flows
	
pmk = −Vmikm = Vm
2 −VmVk
(
)
rkm
	
(6.2)
	
pmk,losses = pkm + pmk = Vk
2 + Vm
2 −2VmVk
(
)
rkm
	
(6.3)
A power-voltage relation, from the system point of view, considering an ideal volt-
age source at node k and m as a load node it is a quadratic equation (6.1). From 
(6.2)voltage Vm can be calculated using −pkm = PL in (6.2) .
	
Vm
2 −VmVk + rkmPL = 0	
(6.4)
The solution to (6.4) shows a multiple solution problem; such is the nature of the 
quadratic equation (Figure 6.2). Using (6.4), the maximum power transfer shows 
that the limiting factor is rkm when Vk is fixed and assumed ideal.
	
dPL
dVm
=
−2Vm + Vk
(
)
rkm
= 0,
Vm = Vk
2 	
(6.5)
	
PL
max = Vk
2
4rkm
	
(6.6)
Figure 6.2  PV curve, multiple solutions to a basic power flow; load model constant power PL.

6.2	
Solution of Nonlinear Equations
171
Figure 6.3  Circuit for PV curve and the nature of load RL.
Figure 6.4  The system’s PV curve for a resistive load, RL = 1.5, 1.1 pu.
Example 6.1
For a value of Vk = 1.0, rkm = 0.1 in pu (Figure 6.3). Plot the solution Vm using (6.4) 
for load values PL from zero to its maximum value. Use the quadratic form Vm = 
Vk ±
Vk
2 −4VmrkmPL
(
)/2 .
Depending on the type of load, we will have various graphical forms on top of 
the PV curve (see Figure 6.2). Let’s consider a resistive type RL; the voltage solu-
tion is the common point for the PV characteristics and the load (see Figure 6.4).
	
PL = Vmikm = Vm
2
RL
	
(6.7)
From (6.7), an expression for constant current load is (see Figure 6.5):
	
PL
Vm
= ikm = constant 	
(6.8)

172
Power Flows
6.2.1	 Newton’s Iterative Process
Nonlinear equations like (6.4) might be present when solving DC real power flow 
problems. An iterative method with good convergence is Newton’s approach. New-
ton’s method is written in incremental form (6.9); this problem is one equation 
one unknown.
	
f Vm
1
(
) = f Vm
0 + ΔVm
(
) = f Vm
0
(
) + df Vm
0
(
)
dVmΔVm
= 0 	
(6.9)
	
ΔVm = −df Vm
0
(
)
dVm
⎛
⎝⎜
⎞
⎠⎟
−1
f Vm
0
(
) 	
(6.10)
Once the correction value ΔVm is calculated, the new Vm value is:
	
Vm
1 = Vm
0 + ΔVm  	
(6.11)
We repeat the iterative process several times and stop when the absolute value for 
f Vm
k
(
) , in the kth iteration, is less than a specified tolerance. If the ΔVm is less than 
a specified tolerance, it can also be used as convergence criteria.
Example 6.2
For Vk = 1.0, rkm = 0.1 in pu. Solve (6.4) for voltage Vm when PL = 0.50, starting 
value V0
m = 1.1. Then start the iterative process with V0
m = 0.1. The nonlinear equa-
tion and its first derivative are f(Vm) = V2
m − Vm + 0.05 = 0 and f′(Vm) = 2Vm − 1.0.
Figure 6.5  The system’s PV curve and constant current load characteristics. 

6.2	
Solution of Nonlinear Equations
173
Newton’s iterative process
Iteration    Voltage      Mismatch
    0        1.10000      1.6000e-001
    1        0.96667      1.7778e-002
    2        0.94762      3.6281e-004
    3        0.94721      1.6424e-007
Newton´s iterative process
Iteration    Voltage      Mismatch
    0        0.10000      4.0000e-002
    1        0.05000      2.5000e-003
    2        0.05278      7.7160e-006
We can glimpse into the nature of convergence by plotting the iterative equation 
(6.12), one set for the left hand side and another for the right side, with values from 
Example 6.2.
	
Vm
1 = Vm
0 + ΔVm = Vm
0 −Vm
0
(
)
2 −Vm
0Vk + rkmPL
2Vm
0 −Vk
= Vm
0
(
)
2 −rkmPL
2Vm
0 −Vk
	
(6.12)
In Figure 6.6, the upper plot shows the solution for what we call normal operating 
voltage. The bottom plot is a low voltage solution, which is not a practical solution 
because it involves very large currents and extremely low voltages.
Figure 6.6  Newton’s convergence characteristics for its iterative process.

174
Power Flows
6.3	
Newton’s Method for Power Flow Solutions
To illustrate the use of Newton’s method in solving two nonlinear equations, let’s 
assume a simple two-node system where the transmission can be modeled by a 
series reactance xkm in pu and the power source has a complex voltage Vk in pu 
(see Figure 6.7).
Equations for the complex power flows, both real and reactive components:
	
pmk + jqmk = Vm imk
∗
= Vm
Vm −Vk
jxmk
⎛
⎝⎜
⎞
⎠⎟
∗
= −PL −jQL 	
(6.13)
	
f1 qm, Vm
(
)
f2 qm, Vm
(
)
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥=
Vk Vm sinqm
xmk
+ PL
Vm
2 −Vk Vm cosqm
(
)
xmk
+ QL
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
=
0
0
⎡
⎣⎢
⎤
⎦⎥	
(6.14)
Newton’s iterative process requires partial derivatives and a starting point θ0
m, ⎪Vm⎪0. 
Partial derivatives for this problem are shown in (6.15).
	
∂f1
∂qm
∂f1
∂Vm
∂f2
∂qm
∂f2
∂Vm
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥qm
0 ,Vm
0
Δqm
Δ Vm
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
= −
f1 qm, Vm
(
)
f2 qm, Vm
(
)
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
qm
0 ,Vm
0
	
(6.15)
	
∂f1
∂qm
∂f1
∂Vm
∂f2
∂qm
∂f2
∂Vm
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
=
Vk Vm cosqm
xmk
Vk sinqm
xmk
Vk Vm sinqm
xmk
2 Vm −Vk cosqm
(
)
xmk
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
	
(6.16)
Example 6.3
Values in pu: xkm = 0.1, Vk = 1.0, PL = 0.5, QL = 0.1. The iterative process converges 
after three iterations with a very small mismatch, then the complex power flow is 
calculated. The iterative process started with θ 0
m = 0, ⎪Vm⎪0 = 1.0.
Figure 6.7  A basic two-node AC system.

6.4	
Power Flow Equations
175
Newton’s iterative process
Iteration    Voltage      Angle, rad    Mismatch
    0        1.00000       0.00000      5.0000e-001
    1        0.99000      -0.05000      1.3372e-002
    2        0.98861      -0.05060      2.0745e-005
    3        0.98860      -0.05060      5.0563e-011
Voltage       Angle, degrees
 0.98860       -2.90
Complex power flows smk = -0.50000 +j-0.10000
6.4	
Power Flow Equations
In Section 6.3.2, we presented an approach to solving a system of equations that 
would comply with both the real and reactive power requirements at a single node. 
After some iterative steps, Newton’s process works using incremental changes to 
find the complex voltage solution for the AC power network. Let’s present the 
power flow and losses equations, assuming a complex transformer, then a trans-
mission line; these are the main power transmission elements that we find in the 
electric network.
6.4.1	 Complex Power Transformer and Incremental Power Flows
Figure 6.8 shows an ideal transformer (no losses) with a complex relation, primary 
and secondary currents, and voltages. For the ideal transformer sprimary = ssecondary, 
which is (6.18), from which current relations are derived as (6.19).
	
!Vk
! ′
Vk
=
1
t ∠t 	
(6.17)
	
!Vkikm
∗
= ! ′
Vk
′ikm
(
)
∗	
(6.18)
	
ikm
∗
′ikm
(
)
∗=
! ′
Vk
!Vk
= t ∠t 	
(6.19)
Figure 6.8  Ideal transformer and complex transformation.

176
Power Flows
The complex power flow from node k to node m is:
	
skm = !Vkikm
∗
= !Vk t ∠t !Vk t ∠t −!Vm
(
)
∗ykm
∗
=
Vk
2 t
2 −Vk Vm t ∠qk −qm + t
(
)
⎡
⎣⎢
⎤
⎦⎥gkm −jbkm
(
)
	
(6.20)
Separating the real and reactive power expressions:
pkm = + Vk
2 t
2 gkm −Vk Vm t gkm cos qk −qm + t
(
) −Vk Vm t bkm sin qk −qm + t
(
)	
(6.21)
qkm = −Vk
2 t
2 bkm −Vk Vm t gkm sin qk −qm + t
(
) + Vk Vm t bkm cos qk −qm + t
(
) 	 (6.22)
Now, the complex power from node m to node k and the real and imaginary com-
ponents are shown.
	
smk = !Vm
′imk
(
)
∗= !Vm −′ikm
(
)
∗
=
Vm
2 −Vm Vk t ∠qm −qk −t
(
)
⎡
⎣
⎤
⎦gkm −jbkm
(
)
	
(6.23)
pmk = + Vm
2 gkm −Vm Vk t gkm cos qm −qk −t
(
) −Vm Vk t bkm sin qm −qk −t
(
) 	
(6.24)
qmk = −Vm
2 bkm −Vm Vk t gkm sin qm −qk −t
(
) + Vm Vk t bkm cos qm −qk −t
(
) 	
(6.25)
We add (6.21) and (6.24) to find the expression for power losses in the complex 
power transformer:
	
pL,km = Vk
2 t
2 gkm + Vm
2 gkm −2 Vk Vm t cos qk −qm + t
(
)gkm 	
(6.26)
In order to reduce transformer losses, looking into (6.26), we observe that two 
control variables might be available: tap magnitude ⎪t⎪ and phase shift angle τ 
(assuming that nodal voltages remain fixed).
Note that the reactive power handled by the transformer is calculated by:
	
qL,km = −Vk
2 t
2 + Vm
2
(
)bkm + 2 Vk Vm t bkm cos qk −qm + t
(
) 	
(6.27)
If qL,km > 0, reactive power is required by the complex transformer; if qL,km < 0 
reactive power is supplied to the system.
6.4.1.1	 Incremental Real Power Flow Δpkm in a Transformer
To study the behavior of real power flow in the steady state condition, the incre-
mental real power expression shows the effect of small changes from every variable 

6.4	
Power Flow Equations
177
that must be adjusted by control action or variables that adjust themselves to com-
ply with network constraints. Let us assume an expression for a complex relation 
transformer. The incremental form for Δpkm depends on small changes for variables 
on pkm as in (6.21). Partial derivatives are shown.
Δpkm = ∂pkm
∂qk
Δqk + ∂pkm
∂qm
Δqm + ∂pkm
∂t Δt + ∂pkm
∂Vk
Vk
Δ Vk
Vk
+ ∂pkm
∂Vm
Vm
Δ Vm
Vm
+ ∂pkm
∂t
t Δ t
t
 

(6.28)
∂pkm
∂qk
= + Vk Vm t
gkm sin qk −qm + t
(
) −bkm cos qk −qm + t
(
)
⎡⎣
⎤⎦= −Vk
2 t
2 bkm −qkm
 

(6.29)
∂pkm
∂qm
= + Vk Vm t −gkm sin qk −qm + t
(
) + bkm cos qk −qm + t
(
)
⎡⎣
⎤⎦= + Vk
2 t
2 bkm + qkm
 

(6.30)
∂pkm
∂t
= + Vk Vm t +gkm sin qk −qm + t
(
) −bkm cos qk −qm + t
(
)
⎡⎣
⎤⎦= −Vk
2 t
2 bkm −qkm  

(6.31)
	
∂pkm
∂Vk
Vk = Vk
2 t
2 gkm + pkm 	
(6.32)
	
∂pkm
∂Vm
Vm = −Vk
2 t
2 gkm + pkm 	
(6.33)
	
∂pkm
∂t
t = + Vk
2 t
2 gkm + pkm 	
(6.34)
6.4.1.2	 Incremental Reactive Power Flow Δqkm in a Transformer
The incremental reactive power flow Δqkm in a complex power transformer depends 
on small increments of the nodal variables and control actions on tap or phase shifter.
Δqkm = ∂qkm
∂qk
Δqk + ∂qkm
∂qm
Δqm + ∂qkm
∂t Δt + ∂qkm
∂Vk
Vk
Δ Vk
Vk
+ ∂qkm
∂Vm
Vm
Δ Vm
Vm
+ ∂qkm
∂t
t Δ t
t
 

(6.35)
The partial derivatives are:
∂qkm
∂qk
= Vk Vm t −gkm cos qk −qm + t
(
) −bkm sin qk −qm + t
(
)
⎡⎣
⎤⎦= −Vk
2 t
2 gkm + pkm
 

(6.36)

178
Power Flows
∂qkm
∂qm
= Vk Vm t +gkm cos qk −qm + t
(
) + bkm sin qk −qm + t
(
)
⎡⎣
⎤⎦= + Vk
2 t
2 gkm −pkm
 

(6.37)
∂qkm
∂t
= Vk Vm t −gkm cos qk −qm + t
(
) −bkm sin qk −qm + t
(
)
⎡⎣
⎤⎦= −Vk
2 t
2 gkm + pkm  

(6.38)
	
∂qkm
∂Vk
Vk = −Vk
2 t
2 bkm + qkm 	
(6.39)
	
∂qkm
∂Vm
Vm = + Vk
2 t
2 bkm + qkm 	
(6.40)
	
∂qkm
∂t
t = −Vk
2 t
2 bkm + qkm 	
(6.41)
6.4.1.3	 Incremental Real Power Flow Δpmk in a Transformer
The real and reactive powers that flow from node m to node k through the com-
plex transformer are different from the ones that flow from node k to node m; 
the complex tap affects how these quantities are calculated. This characteristic 
permeates to the partial derivatives in (6.42) and is not symmetric with partial 
derivatives in (6.28).
Δpmk = ∂pmk
∂qm
Δqm + ∂pmk
∂qk
Δqk + ∂pmk
∂t Δt + ∂pmk
∂Vm
Vm
Δ Vm
Vm
+ ∂pmk
∂Vk
Vk
Δ Vk
Vk
+ ∂pmk
∂t
t Δ t
t
 

(6.42)
∂pmk
∂qm
= + Vm Vk t gkm sin qm −qk −t
(
) −Vm Vk t bkm cos qm −qk −t
(
)
= −Vm
2 bkm −qmk
	
(6.43)
∂pmk
∂qk
= −Vm Vk t gkm sin qm −qk −t
(
) + Vm Vk t bkm cos qm −qk −t
(
)
= + Vm
2 bkm + qmk
	
(6.44)
∂pmk
∂t
= −Vm Vk t gkm sin qm −qk −t
(
) + Vm Vk t bkm cos qm −qk −t
(
)
= + Vm
2 bkm + qmk
	
(6.45)

6.4	
Power Flow Equations
179
	
∂pmk
∂Vm
Vm = + Vm
2 gkm + pmk 	
(6.46)
	
∂pmk
∂Vk
Vk = −Vm
2 gkm + pmk 	
(6.47)
	
∂pmk
∂t
t = −Vm
2 gkm + pmk 	
(6.48)
6.4.1.4	 Incremental Reactive Power Flow Δqmk in a Transformer
The incremental reactive power flow Δqkm:
Δqmk = ∂qmk
∂qm
Δqm + ∂qmk
∂qk
Δqk + ∂qmk
∂t Δt + ∂qmk
∂Vm
Vm
Δ Vm
Vm
+ ∂qmk
∂Vk
Vk
Δ Vk
Vk
+ ∂qmk
∂t
t Δ t
t
 

(6.49)
The partial derivatives:
∂qmk
∂qm
= −Vm Vk t gkm cos qm −qk −t
(
) −Vm Vk t bkm sin qm −qk −t
(
)
= −Vm
2 gkm + pmk
	
(6.50)
∂qmk
∂qk
= + Vm Vk t gkm cos qm −qk −t
(
) + Vm Vk t bkm sin qm −qk −t
(
)
= + Vm
2 gkm −pmk
	
(6.51)
∂qmk
∂t
= + Vm Vk t gkm cos qm −qk −t
(
) + Vm Vk t bkm sin qm −qk −t
(
)
= + Vm
2 gkm −pmk
	
(6.52)
	
∂qmk
∂Vm
Vm = −Vm
2 bkm + qmk 	
(6.53)
	
∂qmk
∂Vk
Vk = + Vm
2 bkm + qmk 	
(6.54)
	
∂qmk
∂t
t = + Vm
2 bkm + qmk 	
(6.55)

180
Power Flows
6.4.2	 Incremental Power Flow for a Transmission Line
For a transmission line (see Figure 6.9), the model has nodal voltages !Vk = Vk ∠θk
, !Vm = Vm ∠θm , series admittance ykm = gkm + jbkm, and charging admittance ysh/2 
= 1/ −jXC/2
(
)  = jBsh/2.
The complex power on the transmission line from k to m using θkm = θk − θm is:
	
skm = !Vk ikm + ik,sh
(
)
∗
	
(6.56)
	
skm = !Vk
!Vk −!Vm
(
)ykm + !Vkysh/2
⎡⎣
⎤⎦
∗
= Vk
2 gkm −Vk Vm gkm cosqkm −Vk Vm bkm sinqkm −j Vk
2 bkm
−j Vk
2 Bsh/2 + j Vk Vm bkm cosqkm −j Vk Vm gkm sinqkm
	 (6.57)
	
pkm = Vk
2 gkm −Vk Vm gkm cosqkm −Vk Vm bkm sinqkm 	
(6.58)
	
qkm = −Vk
2 bkm + Bsh/2
(
) −Vk Vm gkm sinqkm + Vk Vm bkm cosqkm 	 (6.59)
Now, the complex power from m to k using θmk = θm − θk:
	
smk =
!Vm −ikm + im,sh
(
)
∗
	
(6.60)
smk = !Vm −!Vk −!Vm
(
)ykm + !Vmysh/2
⎡⎣
⎤⎦
∗
= Vm
2 gkm −Vm Vk gkm cosqmk −Vm Vk bkm sinqmk
−j Vm
2 bkm −j Vm
2 Bsh/2 + j Vm Vk bkm cosqmkm −j Vk Vk gkm sinqmk
	 (6.61)
	
pmk = Vm
2 gkm −Vm Vk gkm cosqmk −Vm Vk bkm sinqmk 	
(6.62)
	
qmk = −Vm
2 bkm + Bsh/2
(
) −Vm Vk gkm sinqmk + Vm Vk bkm cosqmk 	 (6.63)
Figure 6.9  Transmission line model, positive sequence series impedance, and shunt admittance.

6.4	
Power Flow Equations
181
Transmission losses are calculated by adding (6.58) and (6.62).
	
pL,km = pkm + pmk =
Vk
2 + Vm
2
(
)gkm −2 Vk Vm gkm cosqkm 	
(6.64)
Adding the reactive power (6.59) and (6.63), a positive value (qL,km > 0) means that 
reactive power is required by the transmission element. When (qL,km < 0), the reac-
tive power is supplied by the transmission line into the power system.
	
qL,km = −Vk
2 + Vm
2
(
) bkm + Bsh/2
(
) + 2 Vk Vm bkm cosqkm 	
(6.65)
Note that that pmk (6.62) and qmk (6.63) can be calculated by (6.58) and (6.59) if 
an exchange is made for k as m; this can be carried into the process of its partial 
derivatives so that only the set to calculate quantities from k to m will be written.
6.4.2.1	 Incremental Real Power Flow Δpkm for Transmission Line
For a transmission line the power pkm is as in (6.58), the incremental real power 
km, and its partial derivatives are:
	
Δpkm = ∂pkm
∂qk
Δqk + ∂pkm
∂qm
Δqm + ∂pkm
∂Vk
Vk
Δ Vk
Vk
+ ∂pkm
∂Vm
Vm
Δ Vm
Vm
	
(6.66)
∂pkm
∂qk
= + !Vk !Vm gkm sinqkm −!Vk !Vm bkm cosqkm = −!Vk
2 bkm + Bsh/2
(
) −qkm 	
(6.67)
∂pkm
∂qm
= −!Vk !Vm gkm sinqkm + !Vk !Vm bkm cosqkm = + !Vk
2 bkm + Bsh/2
(
) + qkm 	
(6.68)
	
∂pkm
∂!Vk
!Vk = + !Vk
2 gkm + pkm 	
(6.69)
	
∂pkm
∂!Vm
!Vm = −!Vk
2 gkm + pkm 	
(6.70)
6.4.2.2	 Incremental Reactive Power Flow Δqkm for a Transmission Line
The incremental reactive power flow from k to m and its partial derivatives are:
	
Δqkm = ∂qkm
∂qk
Δqk + ∂qkm
∂qm
Δqm + ∂qkm
∂Vk
Vk
Δ Vk
Vk
+ ∂qkm
∂Vm
Vm
Δ Vm
Vm
	
(6.71)

182
Power Flows
	
∂qkm
∂qk
= −!Vk !Vm gkm cosqkm −!Vk !Vm bkm sinqkm = −!Vk
2 gkm + pkm 	 (6.72)
	
∂qkm
∂qm
= + !Vk !Vm gkm cosqkm + !Vk !Vm bkm sinqkm = + !Vk
2 gkm −pkm 	 (6.73)
	
∂qkm
∂!Vk
!Vk = −!Vk
2 bkm + Bsh/2
(
) + qkm 	
(6.74)
	
∂qkm
∂!Vm
!Vm = + !Vk
2 bkm + Bsh/2
(
) + qkm 	
(6.75)
6.4.2.3	 Incremental Real Power Flow Δpmk for a Transmission Line
The incremental real power flow from m to k as in (6.76) and partial derivatives in 
this equation can be calculated by (6.67) to (6.70) if we reverse k and m.
	
Δpmk = ∂pmk
∂qm
Δqm + ∂pmk
∂qk
Δqk + ∂pmk
∂Vm
Vm
Δ Vm
Vm
+ ∂pmk
∂Vk
Vk
Δ Vk
Vk
	
(6.76)
6.4.2.4	 Incremental Reactive Power Flow Δqmk for a Transmission Line
The incremental reactive power flow Δqmk from m to k and partial derivatives are 
calculated by(6.72) to (6.75) if we interchange k by m.
	
Δqmk = ∂qmk
∂qm
Δqm + ∂qmk
∂θk
Δqk + ∂qmk
∂Vm
Vm
Δ Vm
Vm
+ ∂qmk
∂Vk
Vk
Δ Vk
Vk
	
(6.77)
6.5	
Newton’s Power Flow Solution
To solve a load flow problem that will determine all nodal voltages, we write two 
power balance equations; one for the real power and one for the reactive power at 
each node.
For a given node k:
	
fP,k =
pkm
∀m∈k
∑
−PGk + PDk = 0 	
(6.78)
	
fQ,k =
qkm
∀m∈k
∑
−QGk + QDk = 0	
(6.79)

6.5	
Newton’s Power Flow Solution
183
pkm	
Real power flow from node k to node m
qkm	
Reactive power flow from node k to node m
∀m ∊ k	
Every element m connected to node k
PGk	
Real power by generator into node k
PDk	
Real power by load out of node k
QGk	
Reactive power by generator into node k
QDk	
Reactive power by load out of node k
We seek the node voltage solution for all nodes in the power system so that both 
(6.78) and (6.79) are satisfied as being zero. We write an incremental expression for 
the real and the reactive power mismatches at each node. Newton’s method solves 
the system of equations such that at iteration r, after the correction values are cal-
culated, (6.81) updates nodal voltage angles and node voltages.
	
∂fP,k
∂q
V
∂fP,k
∂V
∂fQ,k
∂q
V
∂fQ,k
∂V
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
(r)
Δq
Δ V
V
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
= −
fP,k
fQ,k
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
(r)
	
(6.80)
	
q
V
⎡
⎣⎢
⎤
⎦⎥
(r+1)
=
q
V
⎡
⎣⎢
⎤
⎦⎥
(r)
+
Δq
Δ V
⎡
⎣⎢
⎤
⎦⎥	
(6.81)
Example 6.4
For an AC simple system (see Figure 6.10), a three-node arrangement writes the 
complete set of equations for the power balance at every node. In this system, there 
are two elements (one transformer and one transmission line).
The real and reactive nodal balances are constraint equations that need to be 
satisfied through the set of nonlinear equations. Newton’s method improves the 
initial values by solving for corrections for nodal angles Δθ and voltage magnitudes 
Δ⎪V⎪/⎪V⎪. The iterative process starts with initial values for unknowns θ1 = θ2 = θ3 
Figure 6.10  Network arrangement to study incremental load flow equations, values in pu.

184
Power Flows
and nodal voltages ⎪V⎪1 = ⎪V⎪2 = ⎪V⎪3. We start with the power mismatch equa-
tions for the real and the reactive power at each node. Then we apply the incremen-
tal form that uses partial derivatives, which were already presented in Section 6.4. 
	
node 1
g1 = p12 −PG1 + PD1 = 0
node 2
g2 = p21 + p23 + PD2 = 0
node 3
g3 = p32 −PG3 + PD3 = 0
node 1
g4 = q12 −QG1 + QD1 = 0
node 2
g5 = q21 + q23 + QD2 = 0
node 3
g6 = q32 −QG3 + QD3 = 0
	
(6.82)
The numerical values for partial derivatives and g’s (mismatch equations) are cal-
culated with the assumed starting nodal values.
 

(6.83)
Prior to conducting the first iteration, one nodal angle is selected as reference; usually, 
θ1 is selected and set to 0 radians. The magnitude of nodal voltages at generation 
buses will be kept constant because no incremental change is allowed, given that the 
reactive power limits of the source are not exceeded. To solve (6.83), the reference 
angle and the constant voltages (at generation nodes) must numerically reflect these 
fixed conditions. After a few iterations, a converged solution for all nodal voltages 
is attained and the power flows in lines and transformers can be calculated. In our 
case for numerical code, node type 0 is the slack node, −1 is a load type PQ, and 
+1 is a PV generation bus. The results are shown in Figure 6.11.
Iterative process Newton, Data
Elements =    2
Nodes     =    3
Table for elements

6.5	
Newton’s Power Flow Solution
185
Elem    N-k    N-m   typeel    tap      tau        yelem            Bsh/2
  1      1      2     -1       1.00     5.00  1.0000 +j-10.0000    +j  0.0000
  2      2      3      1       1.00     0.00  2.0000 +j-15.0000    +j  0.0000
Number of transformers =    1
Table of nodal conditions
Node    type     Voltage       Angle         Pgen       Pload      Qload
   1      0       1.0000       0.0000       0.0000      0.5000     0.0000
   2     -1       1.0000       0.0000       0.0000      0.7500     0.3882
   3      1       1.0000       0.0000       0.6633      0.3000     0.0000
Type of nodes
Generation Nodes  =   2  Load Nodes  =  1
Iteration =    1   maxdev = 7.071320e-002
Iteration =    2   maxdev = 1.030489e-003
Iteration =    3   maxdev = 1.172099e-006
Nodal Report
Node    type   Voltage     Angle      Pgen      Pload      Qgen      Qload
  1      0     1.0000      -0.00      0.8902    0.5000     0.1654    0.0000
  2     -1     0.9805       2.84      0.0000    0.7500     0.0000    0.3882
  3      1     1.0000       4.10      0.6633    0.3000     0.2535    0.0000
Table for elements (duplicated, -1 transformer, +1 transmission line)
Elem   N-k    N-m    typ-el   tap        tau      pkm       qkm
  1     1       2      -1     1.0000     5.00     0.3902    0.1654
  1     2       1      -1     1.0000     5.00    -0.3884   -0.1476
  2     2       3       1     1.0000     0.00    -0.3616   -0.2406
  2     3       2       1     1.0000     0.00     0.3633    0.2535
PLtot =   0.0035 pu    QLtot =   0.0306 pu (>0 required), (<0 to the system)
Figure 6.11  Load flow results for Example 6.4. 

186
Power Flows
6.6	
Power Flow Approximations
The incremental real power flows (6.28) and (6.42) Δpkm, Δpmk and incremental 
reactive power flow (6.35) and (6.49) Δqkm, Δqmk for a complex transformer and 
in (6.66), (6.71), (6.76), and (6.77) for a transmission line that are the departure 
for the approximation. For example, in the case of a transmission line, it can be 
scrutinized closely with particular attention to the relative values observed for the 
partial derivatives. Using reasonable considerations that are observed in high volt-
age power circuits, the parameters are of such values that gkm << bkm, cos (θk − θm 
+ τ) ≅ 1.0, ⎪Vm⎪ ≅ 1.0, ⎪t⎪ ≅ 1.0, and sin (θk − θm + τ) ≅ θk − θm + τ. These are 
considered decoupling assumptions.
These values are placed into the partial derivatives (6.29)–(6.34) and (6.67)–
(6.70) and we have:
	
∂pkm
∂qk
≅−Vk bkm 	
(6.84)
	
∂pkm
∂qm
= + Vk bkm 	
(6.85)
	
∂pkm
∂t
= −Vk bkm 	
(6.86)
	
∂pkm
∂Vk
= −Vk bkm qk −qm + t
(
) 	
(6.87)
	
∂pkm
∂Vm
= −Vk bkm qk −qm + t
(
) 	
(6.88)
	
∂pkm
∂t
= −Vk bkm qk −qm + t
(
) 	
(6.89)
The substitution of approximated values into Δpkm can be written as an Ohm’s 
equivalent (6.91) for the incremental real power flow from node k to node m.
Δpkm = −Vk bkmΔqk + Vk bkmΔqm −Vk bkmΔt −Vk bkm qk −qm + t
(
)Δ Vk
−Vk bkm qk −qm + t
(
)Δ Vm −Vk bkm qk −qm + t
(
)Δ t
	
(6.90)
	
−xkm
Δpkm
Vk
+ Δqk −Δqm = −ΔFp ≈−Δt 	
(6.91)
The incremental Ohm’s equivalent circuit in (6.91) can be drawn (see Figure 6.12).

6.6	
Power Flow Approximations
187
The equivalent series source ΔFp in (6.92) includes changes to incremental values 
in radians for a phase shifter, magnitude changes at sending and receiving nodal 
voltages, and incremental tap change. ΔFp can be approximated to Δτ (in radians). 
We propose to use this model to analyze the effects of control actions by phase 
incremental changes and to study how network flows change and a way to solve 
for a system’s congestion relief.
ΔFp = +Δt + qk −qm + t
(
)
Vk
Δ Vk + qk −qm + t
(
)Δ Vm + qk −qm + t
(
)Δ t 	
(6.92)
For the incremental reactive power flow Δqkm, the approximate expressions for 
partial derivatives take the form:
	
∂qkm
∂qk
= −Vk bkm qk −qm + t
(
) 	
(6.93)
	
∂qkm
∂qm
= + Vk bkm qk −qm + t
(
) 	
(6.94)
	
∂qkm
∂t
= −Vk bkm qk −qm + t
(
) 	
(6.95)
	
∂qkm
∂Vk
= −Vk bkm 	
(6.96)
	
∂qkm
∂Vm
= + Vk bkm 	
(6.97)
	
∂qkm
∂t
= −Vk bkm 	
(6.98)
Figure 6.12  Incremental real power flow equivalent circuit; complex transformer. 

188
Power Flows
Substitution into (6.35) gives an Ohm’s equivalent form for reactive power flow and 
incremental voltages (see Figure 6.13):
	
−xkm
Δqkm
Vk
+ Δ Vk −Δ Vm = −ΔFq 	
(6.99)
ΔFq = qk −qm + t
(
)Δqk −qk −qm + t
(
)Δqm + qk −qm + t
(
)Δt + Δ t 	
(6.100)
Further considerations for ΔFq allow an approximation to Δ⎪t⎪.
For transmission lines the incremental real power Δpkm (6.66) with partial 
derivatives in an approximated form; using −xkm = 1/bkm and ∂pkm/ ∂Vk ≈0 , 
∂pkm/ ∂Vm ≈0  are:
	
∂pkm
∂qk
≈−bkm Vk 	
(6.101)
	
∂pkm
∂qm
≈+bkm Vk 	
(6.102)
	
−xkm
Dpkm
Vk
+ Δqk −Δqm
(
) = 0	
(6.103)
The incremental reactive power Δqkm (6.71) for the transmission line requires the 
partial derivatives that are approximated by ∂qkm/∂θk ≈ 0,∂qkm/∂θm ≈ 0. The Ohm’s 
Law model is now (6.106) and Figure 6.15.
	
∂qkm
∂Vk
≈−2Bsh2 Vk −bkm Vk 	
(6.104)
	
∂qkm
∂Vm
≈+bkm Vk 	
(6.105)
Figure 6.13  Incremental reactive power flow equivalent circuit; complex transformer. 

6.6	
Power Flow Approximations
189
	
Δqkm
Vk
= −(2Bsh2)Δ Vk −bkm Δ Vk −Δ Vm
(
) 	
(6.106)
Example 6.5
As a small test network, let us solve the load flow problem using reasonable approxi-
mations (such as the ones used in what is known as the fast decoupled load flow). The 
first derivatives in the Jacobian matrix reflect the approximations. The unknowns are 
nodal angles θ2, θ3, and θ4 and the voltage magnitude for node 4. The constraints 
to be satisfied are the real and reactive power flows at each element and the nodal 
real and reactive power balances.
	
t ∠t = ta + jtb = 1.05∠5° 	
The incremental real power flow for each element and the nodal real power bal-
ance are written using both (6.91) and the real power incremental balances at each 
node. In matrix form:
Figure 6.14  A Small network to study the decoupled power flow. 
Table 6.1  Data for Small Networks (Figure 6.14)
Element
Node - k
Node - m
ykm
tap
ybsh/2
1
1
2
1.0 − j10
−1
0
2
1
3
1.0 − j10
tα + jtβ
0
3
3
4
1.5 − j15
−1
0
4
2
4
2.0 − j20
−1
0

190
Power Flows
	
−x12
0
0
0
+1 −1
0
0
0
−x13
0
0
+1
0
−1
0
0
0
−x34
0
0
+1
0
−1
0
0
0
−x24
0
0
+1 −1
+1
−1
0
0
0
0
0
0
−1
0
+1
0
0
0
0
0
0
−1
+1
0
0
0
0
0
0
−1
−1
0
0
0
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
Δp12
V1
Δp13
V1
Δp24
V2
Δp34
V3
Δq1
Δq2
Δq3
Δq4
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
−Δt
0
0
0
ΔP1
V1
ΔP2
V2
ΔP3
V3
ΔP4
V4
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(6.107)
The solution to (6.107) requires one node angle as reference; its value is to remain 
fixed. Usually Δτ, the incremental phase shift control is set to zero under the assump-
tion that the phase shifting angle is not changed within this numerical step. For 
the reactive power incremental equivalent using (6.108), we must include all series 
and shunt components. This gives a similar network to the one written for real 
power—nodal angle power flows. Shunt components add to the incremental reac-
tive power contributions which are added into the nodal reactive power balance, 
as seen in (6.109).
	
Δqkm
Vk
= −(2Bsh2)Δ Vk −bkm Δ Vk −Δ Vm
(
) 	
(6.108)
−x12
0
0
0
+1
−1
0
0
0
−x13
0
0
+1
0
−1
0
0
0
−x34
0
0
+1
0
−1
0
0
0
−x24
0
0
+1
−1
+1
−1
0
0
−2Bsh2
12
0
0
0
−1
0
+1
0
0
−2Bsh2
12 −2Bsh2
24
0
0
0
−1
+1
0
0
0
−2Bsh2
34
0
0
−1
−1
0
0
0
0
−2Bsh2
24 −2Bsh2
34
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
Δq12
V1
Δq13
V1
Δq24
V2
Δq34
V3
Δ V1
Δ V2
Δ V3
Δ V4
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
−Δ t
0
0
0
ΔQ1
V1
ΔQ2
V2
ΔQ3
V3
ΔQ4
V4
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
 

(6.109)

6.6	
Power Flow Approximations
191
Given that there is enough reactive power from the reactive sources at that node, 
the nodal voltage magnitudes for the generation nodes must remain fixed; numeri-
cally, we treat the nodal voltage in the same way as the node angle reference. At this 
stage, Δ⎪t⎪ is considered zero because no change for tap position is active. Once the 
set of variables related to element are eliminated in both the incremental real power 
model (6.107) and the incremental reactive power (6.109), we iteratively solve the 
two systems of equations in sequence or under other possible schemes, following 
numerical steps as described by Figure 6.17. A succinct notation for the fast decoupled 
load flow is composed by two set of equations. Results are shown in Figure 6.16.
	
′
B Δq = ΔP
V 	
(6.110)
	
′′
B Δ V = ΔQ
V 	
(6.111)
Figure 6.15  Circuit to include shunt reactive compensation. 
Figure 6.16  Load flow solution diagram for Example 6.5. 

192
Power Flows
Data for an iterative process
Nodes =    4  Element =    4
Element type    From      to       yseries             1/2Ysh (tap)
       1          1        2   1.0000 +j-10.0000     0.9962 +j  0.0872
       0          1        3   1.0000 +j-10.0000     0.0000 +j  0.0000
       0          3        4   1.5000 +j-15.0000     0.0000 +j  0.0000
       0          2        4   2.0000 +j-20.0000     0.0000 +j  0.0000
       1          2        1   1.0000 +j-10.0000     0.9962 +j  0.0872
       0          3        1   1.0000 +j-10.0000     0.0000 +j  0.0000
       0          4        3   1.5000 +j-15.0000     0.0000 +j  0.0000
       0          4        2   2.0000 +j-20.0000     0.0000 +j  0.0000
Call to line flow calculation and Max mismatch
Convergence in P  1.5  Q  1.0 iterations   MaxDQ =3.3251e-006
Node Report
  Node type  Vmag(pu)  Angle(deg)   PG        QG        PL        QL
   1    +0    1.0000     0.00     0.3436    0.0092    0.3000    0.0000
   2    +1    1.0000     2.78     0.4200    0.0408    0.4000    0.0000
   3    +1    1.0000     1.98     0.6400   -0.0144    0.2000    0.0000
   4    -1    0.9985     1.62    -0.0000    0.0000    0.5000    0.0000
Load flow results
Element  Node from Node to         spk
   1         1         2     0.3880 +j -0.0312
   2         1         3    -0.3444 +j  0.0405
   3         3         4     0.0944 +j  0.0142
   4         2         4     0.4065 +j -0.0054
   5         2         1    -0.3865 +j  0.0462
   6         3         1     0.3456 +j -0.0285
   7         4         3    -0.0944 +j -0.0136
   8         4         2    -0.4056 +j  0.0136
Power Losses =   0.0036 pu
Qsystem      =   0.0357 pu (>0 required), (<0 to the system)
In practice, when solving large power networks, the experience reported is that the 
fast-decoupled load flow shows a good type of convergence for systems that have 
reasonable load condition, not very stressed systems, and for high-voltage networks 
where the assumptions for the decoupling principle are satisfied. The fast decoupled 
model in (6.110) and (6.111) where the Jacobian elements have the linear approxi-
mation so B′ and B″ are kept constant from iteration to iteration. Equations (6.110) 
and (6.111) are very useful for network control studies, relating control actions to 
changes in nodal electrical variables and for changes in power flows; we discuss 
such application in Chapter 8.

6.7	
DC Network Power Flow Solutions
193
6.7	
DC Network Power Flow Solutions
Most books that treat power system analysis stress the AC network solution for 
the load flow problem. We now give attention to a ubiquitous form of use of elec-
tric energy, which is the direct current (DC), transmission, and distribution. An 
increasing use of low DC voltage devices at home and office, coupled to its use in 
industrial processes, makes this type of electrical energy nonfluctuating in time, 
no frequency and no reactive power, to reach renewed impetus in its applications. 
Of course, switching on or off DC electric loads ensues transients and this is a 
particular area of study and design that we will not be covering. The basic R, L, 
Figure 6.17  Diagram for the decoupled power flow calculations.

194
Power Flows
and C circuit components are present in the DC networks as part of series or shunt 
connections, but in the steady state, only the resistance R appears in the current’s 
trajectory. The fundamental relations for load flow analysis in DC networks follow 
Figure 6.18. Power expressions from node k to node m and from m to k, recogniz-
ing the current through element km is ikm = Vk + ekm −Vm
(
)/rkm .
	
pkm = Vkikm = Vk
2 + Vkekm −VkVm
(
)
rmk
	
(6.112)
	
pmk = −Vmikm =
−VmVk −Vmekm + Vm
2
(
)
rmk
	
(6.113)
Losses:
	
pmk,losses = pkm + pmk =
Vk
2 + Vm
2 + ekm Vk −Vm
(
) −2VmVk
(
)
rkm
	
(6.114)
6.7.1	
Incremental DC Power Flow Equations
Incremental power Δpkm from node k to m, and its partial derivatives are:
	
Δpkm = ∂pkm
∂Vk
ΔVk + ∂pkm
∂Vm
ΔVm + ∂pkm
∂ekm
Δekm 	
(6.115)
	
∂pkm
∂Vk
=
2Vk + ekm −Vm
(
)
rkm
= Vk
rkm
+ pkm
Vk
	
(6.116)
	
∂pkm
∂Vm
= −Vk
rkm
	
(6.117)
Figure 6.18  DC current transmission element.

6.7	
DC Network Power Flow Solutions
195
	
∂pkm
∂ekm
= + Vk
rkm
	
(6.118)
Substitution of partial derivatives in (6.115) are:
	
Δpkm =
2Vk + ekm −Vm
(
)
rkm
ΔVk −Vk
rkm
ΔVm + Vk
rkm
Δekm 	
(6.119)
	
−rkm
Δpkm
Vk
+ 1 + rkmpkm
Vk
2
⎛
⎝⎜
⎞
⎠⎟ΔVk −ΔVm = −Δekm 	
(6.120)
Incremental power Δpmk from node m to k, and its partial derivatives are:
	
Δpmk = ∂pmk
∂Vm
ΔVm + ∂pmk
∂Vk
ΔVk + ∂pmk
∂ekm
Δekm 	
(6.121)
	
∂pmk
∂Vm
=
−Vk −ekm + 2Vm
(
)
rmk
	
(6.122)
	
∂pmk
∂Vk
= −Vm
rmk
	
(6.123)
	
∂pmk
∂ekm
= −Vm
rmk
	
(6.124)
Substitution of partial derivatives in (6.121):
	
Δpmk =
−Vk −ekm + Vm
(
)
rmk
ΔVm + Vm
rmk
ΔVm −Vm
rmk
ΔVk −Vm
rmk
Δekm 	
(6.125)
	
−rmk
Δpmk
Vm
+ 1 + rmkpmk
Vm
2
⎛
⎝⎜
⎞
⎠⎟ΔVm −ΔVk = +Δekm 	
(6.126)
Example 6.6
To illustrate the general nature of the load flow problem for a DC circuit let us con-
sider three nodes with three elements. V1 = 20 V and assume no control elements, 
as shown in Figure 6.19.

196
Power Flows
The incremental model Δpkm in (6.120) and Δpmk (6.126) is applied to the three 
transmission elements. We have six power flow equations and incorporate the three 
power nodal balances. The system of equations is 9×9, as in (6.127).
−1
0
0
0
0
0
∂p12
∂V1
∂p12
∂V2
0
0
−1
0
0
0
0
∂p13
∂V1
0
∂p13
∂V3
0
0
−1
0
0
0
0
∂p23
∂V2
∂p23
∂V3
0
0
0
−1
0
0
∂p21
∂V1
∂p21
∂V2
0
0
0
0
0
−1
0
∂p31
∂V1
0
∂p31
∂V3
0
0
0
0
0
−1
0
∂p32
∂V2
∂p32
∂V3
+1 +1
0
0
0
0
0
0
0
0
0
+1 +1
0
0
0
0
0
0
0
0
0
+1 +1
0
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
Δp12
Δp13
Δp23
Δp21
Δp31
Δp32
ΔV1
ΔV2
ΔV3
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
= −
∂p12
∂e12
Δe12
∂p13
∂e13
Δe13
∂p23
∂e23
Δe23
∂p21
∂e12
Δe12
∂p31
∂e13
Δe13
∂p32
∂e23
Δe23
−ΔP1
−ΔP2
−ΔP3
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	 (6.127)
The partial derivatives are calculated by (6.116)–(6.118) and (6.122)–(6.124). The 
voltage for nodes with a source will be fixed, and its incremental voltage will be 
zero; we work this condition numerically in the process (the solution is shown in 
Figure 6.20).
Figure 6.19  Small DC current network.

6.7	
DC Network Power Flow Solutions
197
Total nodes =    3    Elements =   3
Element  Node from   Node to      rkm
   1         1          2         4.0000
   2         1          3         2.0000
   3         2          3         1.0000
   4         2          1         4.0000
   5         3          1         2.0000
   6         3          2         1.0000
Node Information
  Node type   Vmag(pu)    PG        PL
   1    +0    20.0000     0.0000    2.0000
   2    -1    20.0000     0.0000    4.0000
   3    -1    20.0000     0.0000    4.0000
Iteration =    0     Maxdev = 4.00000e+000
Iteration =    1     Maxdev = 1.02857e-001
Iteration =    2     Maxdev = 7.96669e-005
Iteration =    3     Maxdev = 5.11591e-011
Convergence in    3 iterations
Node Report
  Node type   Vmag       PG        PL
   1    +0    20.0000    10.2298    2.0000
   2    -1    19.4120     0.0000    4.0000
   3    -1    19.4710     0.0000    4.0000
Load flow results
Element  Node from   Node to      pkm
   1         1          2         2.9401
   2         1          3         5.2897
   3         2          3        -1.1463
   4         2          1        -2.8537
   5         3          1        -5.1498
   6         3          2         1.1498
Power Generation =  10.2298  Power Load =  10.0000  Power Losses =  0.2298
Sensitivity Matrix  =
  -1.0000  -0.0000  -0.4535  -0.4535  -0.3035  -0.3035  -0.0000  -0.4535  -0.3035
  -0.0000  -1.0000  -0.6089  -0.6089  -0.7524  -0.7524  -0.0000  -0.6089  -0.7524
   0.0000   0.0000  -0.4268   0.5732  -0.2857  -0.2857   0.0000   0.5732  -0.2857
  -0.0000  -0.0000   0.4268  -0.5732   0.2857   0.2857  -0.0000   0.4268   0.2857
   0.0000   0.0000   0.5767   0.5767  -0.2874   0.7126   0.0000   0.5767   0.7126
  -0.0000  -0.0000  -0.5767  -0.5767   0.2874  -0.7126  -0.0000  -0.5767   0.2874
   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000
   0.0000   0.0000   0.0907   0.0907   0.0607   0.0607   0.0000   0.0907   0.0607
   0.0000   0.0000   0.0609   0.0609   0.0752   0.0752   0.0000   0.0609   0.0752
For this network, we calculated the sensitivity matrix, whose elements relate column­
wise the effect of controls that might be acting in a given element, which might be 

198
Power Flows
a series voltage source or changes to the nodal injections by a source or from load 
requirements. Control actions will modify the system’s power flows and nodal volt-
ages at the load nodes. Control action effects on system’s elements are of paramount 
importance to quantify and evaluate both control actions and the controllability of 
the power flows and nodal voltages in a power system. We can use this concept to 
analyze the most appropriate control location and to have the most effective action 
for a given network. The sensitivity information can be used to coordinate a mini-
mum effort of existing controls and to solve the congestion problems.
6.8	
Incremental Power Flow and Control Actions
The incremental AC load flow formulation has information about incremental real 
and reactive power flows on each element in the system, as well as incremental 
voltages and nodal angles. In this sense, we can extend the analysis into the line 
power flows control; with an explicit model, we can calculate control actions in a 
given network. We can analyze control devices as taps, phase shifters, and power 
Figure 6.20  Small DC load flow solution. 
Figure 6.21  Three-node system to illustrate incremental power flow concepts.

6.8	
Incremental Power Flow and Control Actions
199
injections of real and reactive power (including load curtailment) in a comprehen-
sive manner. An optimal coordination of various control actions to solve congestion 
problems is a matter to be discussed in Chapter 8.
If we write the incremental real power flow Δpkm and Δpmk from k to m and 
from m to k, we will have terms that require partial derivatives for the Jacobian or 
matrix of first derivatives. The same goes for the incremental reactive power Δqkm 
and Δqmk. To these equations, we must add nodal incremental balances in order to 
have a consistent set of equations, the same number of equations, and unknowns. 
The set of 14 equations in matrix form shows expressions that are carried out by 
control changes on the right-hand side. In a base case load flow solution, usually 
Δτ and Δ⎪t⎪/⎪t⎪ are considered zero, which means no change to these controls.
−1
0
0
0
∂p12
∂q1
∂p12
∂q2
0
0 0 0 0 ∂p12
∂V1
V1
∂p12
∂V2
V2
0
0
−1
0
0
∂p21
∂q1
∂p21
∂q2
0
0 0 0 0 ∂p21
∂V1
V1
∂p21
∂V2
V2
0
0
0
−1
0
0
∂p23
∂q2
∂p23
∂q3
0 0 0 0
0
∂p23
∂V2
V2
∂p23
∂V3
V3
0
0
0
−1
0
∂p32
∂q2
∂p32
∂q3
0 0 0 0
0
∂p32
∂V2
V2
∂p32
∂V3
V3
+1
0
0
0
0
0
0
0 0 0 0
0
0
0
0
+1 +1
0
0
0
0
0 0 0 0
0
0
0
0
0
0
+1
0
0
0
0 0 0 0
0
0
0
b
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
Δp12
Δp21
Δp23
Δp32
Δq1
Δq2
Δq3
Δq12
Δq21
Δq23
Δq32
Δ V1
V1
Δ V2
V2
Δ V3
V3
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
−∂p12
∂t Δt −∂p12
∂t
t Δ t
t
−∂p21
∂t Δt −∂p21
∂t
t Δ t
t
0
0
ΔP1
ΔP2
ΔP3
−∂q12
∂t Δt −∂q12
∂t
t Δ t
t
−∂q21
∂t Δt −∂q12
∂t
t Δ t
t
0
0
ΔQ1
ΔQ2
ΔQ3
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
 

(6.128)
The sub-matrix β in (6.128) has terms that relate voltage changes to reactive 
power flows.

200
Power Flows
b =
0 0 0 0 ∂q12
∂q1
∂q12
∂q2
0
−1
0
0
0
∂q12
∂V1
V1
∂q12
∂V2
V2
0
0 0 0 0 ∂q21
∂q1
∂q21
∂q2
0
0
−1
0
0
∂q21
∂V1
V1
∂q21
∂V2
V2
0
0 0 0 0
0
∂q23
∂q2
∂q23
∂q3
0
0
−1
0
0
∂q23
∂V2
V2
∂q23
∂V3
V3
0 0 0 0
0
∂q32
∂q2
∂q32
∂q3
0
0
0
−1
0
∂q32
∂V2
V2
∂q32
∂V3
V3
0 0 0 0
0
0
0
+1
0
0
0
0
0
0
0 0 0 0
0
0
0
0
+1 +1
0
0
0
0
0 0 0 0
0
0
0
0
0
0
+1
0
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	 (6.129)
A reference angle must be selected and the generating nodes that must keep a constant 
voltage should be identified. The inverse of the complete Jacobian matrix will have 
numerical information about sensitivity factors; these values translate into valuable 
information when solving control-related problems in electric power networks and 
are very helpful when solving congestion problems. The problem will be presented in 
Chapter 8 from an optimal point of view when control coordination can be solved.
6.9	
Unbalanced Three-Phase Power Flow
Most studies are conducted assuming a three-phase balanced system; therefore, 
only the positive sequence impedances are required to conduct load flow studies, 
fault analysis (except at the fault point which might be an unbalanced connection), 
and other studies (such as transient stability). In the more general case unbalanced 
conditions might be at the load, the transmission lines that were not transposed, 
and other situations such as an open conductor. To solve for the unbalanced load 
flow in the three-phase power system, we need an abc matrix formulation. One way 
to set up the problem is through the three-phase nodal admittance matrix Ybus,abc 
in the abc frame of reference.
	
Ybus
abcVbus
abc = Ibus
abc 	
(6.130)
Nodal voltages, complex power, and currents will be in the abc frame of reference; 
Norton’s equivalent for power sources might be used. In order to establish the itera-
tive process, let us use a small three-phase power system (see Figure 6.22): one three-
phase power source, a transformer bank in a ΔY connection, and a transmission 

6.9	
Unbalanced Three-Phase Power Flow
201
Figure 6.22  Three-node system to illustrate incremental power flow concepts. 
Figure 6.23  Thévenin’s equivalent for the synchronous generator.
Figure 6.24  Norton’s equivalent for synchronous generator. 

202
Power Flows
line. Values of impedances and voltages are in pu and the numerical process starts 
assuming an abc flat start, balanced phase-shift from phase a, b, and c.
To build the Ybus,abc matrix, we assume that the generator is represented by its 
Thévenin’s equivalent (see Figure 6.23). We can then calculate Norton’s equivalent 
for each synchronous generator (see Figure 6.24).
Thévenin’s and Norton’s model for the generator is written as:
	
Vbus,g
abc
= Zbus,g
abc Ibus
abc + ETh
abc 	
(6.131)
	
Ybus,g
abc Vbus,g
abc
= Ibus
abc + Jbus,g
abc 	
(6.132)
With the three-phase admittance for the generator for the ΔY transformer and for 
the transmission line, we build the three-phase admittance matrix for the electric 
network. Nodes I, II, and III in Figure 6.22 are three-phase abc nodes.
Ybus,g
abc + Ybus,tr
abc,Δ
−Ybus,tr
abc,ΔY
0
−Ybus,tr
abc,YΔ
Ybus,tr
abc,Y + Ybus,TL
abc
−Ybus,TL
abc
0
−Ybus,TL
abc
Ybus,TL
abc
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
Vbus,I
abc
Vbus,II
abc
Vbus,III
abc
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
Ibus,I
abc + Jbus,g
abc
Ibus,II
abc
Ibus,III
abc
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	 (6.133)
Figure 6.25  Iterative process for three-phase load flows, using Zbus matrix. 

6.9	
Unbalanced Three-Phase Power Flow
203
Example 6.7
To illustrate the general nature of the three-phase load flow (especially for unbal-
anced conditions presented by the system’s elements or from the load), let us apply 
the Zbus iterative method to solve the small network in Figure 6.22. We follow the 
steps in Figure 6.25. All values are in pu.
Unbalanced load power flows, using Zbus,abc matrix
Thevenin impedance matrix for generator, phases abc
0.0000+j  0.1800    0.0000+j -0.0200    0.0000+j -0.0200
0.0000+j -0.0200    0.0000+j  0.1800    0.0000+j -0.0200
0.0000+j -0.0200    0.0000+j -0.0200    0.0000+j  0.1800
Norton equivalent for generator, phases abc
Nodal Admittance matrix                                       Current source
0.0000+j -5.7143    0.0000+j -0.7143    0.0000+j -0.7143   -0.0000+j -5.0000
0.0000+j -0.7143    0.0000+j -5.7143    0.0000+j -0.7143   -4.3301+j  2.5000
0.0000+j -0.7143    0.0000+j -0.7143    0.0000+j -5.7143    4.3301+j  2.5000
Admittance matrix for transformer bank D-Y
Columns 1 through 3
0.0000+j-13.3333    0.0000+j  6.6667    0.0000+j  6.6667
0.0000+j  6.6667    0.0000+j-13.3333    0.0000+j  6.6667
0.0000+j  6.6667    0.0000+j  6.6667    0.0000+j-13.3333
0.0000+j 11.5470    0.0000+j-11.5470    0.0000+j  0.0000
0.0000+j  0.0000    0.0000+j 11.5470    0.0000+j-11.5470
0.0000+j-11.5470    0.0000+j  0.0000    0.0000+j 11.5470
Columns 4 through 6
0.0000+j 11.5470    0.0000+j  0.0000    0.0000+j-11.5470
0.0000+j-11.5470    0.0000+j 11.5470    0.0000+j  0.0000
0.0000+j  0.0000    0.0000+j-11.5470    0.0000+j 11.5470
0.0000+j-20.0000    0.0000+j  0.0000    0.0000+j  0.0000
0.0000+j  0.0000    0.0000+j-20.0000    0.0000+j  0.0000
0.0000+j  0.0000    0.0000+j  0.0000    0.0000+j-20.0000
Transmission line, series impedance model
0.0000+j  0.1667    0.0000+j  0.0667    0.0000+j  0.0667
0.0000+j  0.0667    0.0000+j  0.1667    0.0000+j  0.0667
0.0000+j  0.0667    0.0000+j  0.0667    0.0000+j  0.1667
Zbusabc =
Columns 1 through 6
0 + 0.1800i  0 - 0.0200i  0 - 0.0200i  0 + 0.1155i  0 - 0.0000i  0 - 0.1155i
0 - 0.0200i  0 + 0.1800i  0 - 0.0200i  0 - 0.1155i  0 + 0.1155i  0 + 0.0000i
0 - 0.0200i  0 - 0.0200i  0 + 0.1800i  0 - 0.0000i  0 - 0.1155i  0 + 0.1155i
0 + 0.1155i  0 - 0.1155i  0 + 0.0000i  0 + 0.1833i  0 - 0.0667i  0 - 0.0667i
0 + 0.0000i  0 + 0.1155i  0 - 0.1155i  0 - 0.0667i  0 + 0.1833i  0 - 0.0667i
0 - 0.1155i  0 + 0.0000i  0 + 0.1155i  0 - 0.0667i  0 - 0.0667i  0 + 0.1833i
0 + 0.1155i  0 - 0.1155i  0 + 0.0000i  0 + 0.1833i  0 - 0.0667i  0 - 0.0667i
0 + 0.0000i  0 + 0.1155i  0 - 0.1155i  0 - 0.0667i  0 + 0.1833i  0 - 0.0667i

204
Power Flows
0 - 0.1155i  0 + 0.0000i  0 + 0.1155i  0 - 0.0667i  0 - 0.0667i  0 + 0.1833i
Columns 7 through 9
0 + 0.1155i  0 - 0.0000i  0 - 0.1155i
0 - 0.1155i  0 + 0.1155i  0 + 0.0000i
0 - 0.0000i  0 - 0.1155i  0 + 0.1155i
0 + 0.1833i  0 - 0.0667i  0 - 0.0667i
0 - 0.0667i  0 + 0.1833i  0 - 0.0667i
0 - 0.0667i  0 - 0.0667i  0 + 0.1833i
0 + 0.3500i  0 + 0.0000i  0 + 0.0000i
0 + 0.0000i  0 + 0.3500i  0 + 0.0000i
0 + 0.0000i  0 + 0.0000i  0 + 0.3500i
Nodal initial conditions
Node      Voltage             Load
   1     1.0000+j  0.0000    0.0000+j  0.0000
   2    -0.5000+j -0.8660    0.0000+j  0.0000
   3    -0.5000+j  0.8660    0.0000+j  0.0000
   4     1.0000+j  0.0000    0.0000+j  0.0000
   5    -0.5000+j -0.8660    0.0000+j  0.0000
   6    -0.5000+j  0.8660    0.0000+j  0.0000
   7     1.0000+j  0.0000    0.3000+j  0.1000
   8    -0.5000+j -0.8660    0.2000+j  0.0800
   9    -0.5000+j  0.8660    0.4000+j  0.0000
Iteration   Max V update
   1        7.987551e-002
   2        5.394074e-002
   3        2.976889e-003
   4        1.154804e-003
   5        6.144031e-005
   6        2.359442e-005
   7        1.254336e-006
   8        4.816108e-007
   9        2.560290e-008
Node     Voltage                  Magnitude    angle
   1     0.974690+j -0.074679     0.977547      -4.38
   2    -0.526594+j -0.816807     0.971842    -122.81
   3    -0.448096+j  0.891486     0.997766     116.69
   4     0.868283+j  0.412023     0.961082      25.39
   5    -0.055321+j -0.981417     0.982975     -93.23
   6    -0.808971+j  0.573707     0.991753     144.66
   7     0.876640+j  0.384886     0.957411      23.70
   8    -0.069998+j -0.965933     0.968466     -94.14
   9    -0.778698+j  0.611244     0.989944     141.87
Generator   Voltage E           Voltage R            Current
            1.000000    -0.00   0.977547    -4.38   -0.3734+j  0.1266
            1.000000  -120.00   0.971842  -122.81    0.2461+j  0.1330
            1.000000   120.00   0.997766   116.69    0.1273+j -0.2595
            Power E             Power R

6.9	
Unbalanced Three-Phase Power Flow
205
            0.3734+j  0.1266   -0.3734+j -0.0955
            0.2382+j  0.1466   -0.2382+j -0.1310
            0.2884+j  0.0195   -0.2884+j -0.0028
Transformer Voltage S           Voltage R            Current
            0.977547    -4.38   0.961082    25.39    0.3734+j -0.1266
            0.971842  -122.81   0.982975   -93.23   -0.2461+j -0.1330
            0.997766   116.69   0.991753   144.66   -0.1273+j  0.2595
            Power E             Power R
            0.3734+j  0.0955   -0.2981+j -0.1092
            0.2382+j  0.1310   -0.2017+j -0.0844
            0.2884+j  0.0028   -0.4003+j -0.0195
T Line      Voltage S           Voltage R           Current
            0.961082    25.39   0.957411    23.70    0.3289+j  0.0303
            0.982975   -93.23   0.968466   -94.14   -0.0973+j -0.2000
            0.991753   144.66   0.989944   141.87   -0.3178+j  0.2495
            Power E             Power R
            0.2981+j  0.1092   -0.3000+j -0.1000
            0.2017+j  0.0844   -0.2000+j -0.0800
            0.4003+j  0.0195   -0.4000+j -0.0000
The Zbus iterative process takes several iterations to converge to a voltage solution; 
in this case, nine iterations were needed. The rate of convergence is linear as com-
pared to the quadratic rate of Newton’s method used in the balanced power flows. 
One drawback for the Zbus method is that the impedance matrix is full, and in order 
to solve large power problems, an implicit method should be applied; this requires 
the use of factors on Ybus,abc to synthetically find the inverse Zbus,abc. Sparsity tech-
niques must be used when solving large sets of equations, as is the case of real-world 
power networks and all of their related problems: fault analysis, load power flows, 
contingency analysis, state estimation, and transient stability.
References
[1]	
Stagg, G. W., and A. H. El-Abiad, Computer Methods in Power System Analysis, New 
York: McGraw-Hill Book Company, 1968.
[2]	
Elgerd, O. I., Electric Energy Systems Theory: An Introduction, Second Edition, New 
York: McGraw-Hill Book Company, 1982.
[3]	
Gross, C. A., Power Systems Analysis, New York: John Wiley & Sons, 1979.
[4]	
Grainger, J. D., and W. D. Stevenson, Power System Analysis, New York: McGraw-Hill 
Science/Engineering, 1994.
[5]	
Arrillaga, J., Computer Modelling of Electrical Power Systems, New York: Wiley, 2001.
[6]	
Glover, J. D., S. Sarma, and T. J. Overbye, Power System Analysis and Design, Boston: 
Cengage Learning, 2011.
[7]	
Tinney, W. F., and C. E. Hart, “Power Flow Solution by Newton’s Method,” IEEE Trans., 
Vol. PAS-86, No. 11, November 1967.

206
Power Flows
[8]	
Stott, B., and O. Alsac, “Fast Decoupled Load Flow,” IEEE Trans., Vol. PAS-93, pp. 
859–869, 1974.
[9]	
Sun, D. I., B. Ashley, B. Brewer, A. Huges, and W. F. Tinney, “Optimal Power Flow by 
Newton Approach,” IEEE Trans., Vol. PER-4, Issue 10, 1984.

207
C h a p t e r  7
Optimal Operation of Power Systems
When an electric power system is working in a steady state condition, with all its 
vital indicators: nominal frequency and nodal voltages within a pre-established 
range, that is, voltages close to 1.0 pu, then a coordinated synchronous operation 
with an economic goal in mind can be pursued. To attain this general objective, 
it is important to include the limited transporting nature of transmission links, 
scarce resources as fuels to the thermal plants, available water in the hydro reser-
voirs, and other important energy resources (e.g., nuclear, wind, and geothermal). 
We can establish an appropriate nonlinear frame of reference considering the non-
linear nature of the electric power problem and the constraints listed. Solving an 
optimal constrained problem in an efficient and useful way for operation, control, 
and planning stages for system expansion has been the goal of power engineers for 
more than 50 years. There were many advances during this period, and no doubt 
the nonlinear formulation is the most interesting as it highlights the nature of the 
power problem.
7.1	
Introduction
In this chapter, we present a systematic development, starting with simplified assump-
tions for a lossless network, which gives us the opportunity to focus on the main 
concepts and its physical interpretations. The advantage with this approach is that 
we do not need complicated relations. Once the first step is covered, the task is to 
include all relevant variations in power system operation as transmission losses, 
equality, and inequality constraints. It is important to keep the nonlinear nature of 
the problem, as this allows for a much better characterization of a realistic electri-
cal power system. We focus the cost or objective function on minimization where 
the gradient of the cost function equated to zero will give the necessary condition 
for the optimum. The set of equations that form the gradient is usually nonlinear. 
Therefore, there is the need for an iterative process like Newton’s method. In prac-
tice, the large number of variables and the dimension of the problem restrains the 
proof of the sufficient condition to attain the local optimum. Because it represents 
a huge numerical burden, this condition is not tested in practice.
7.2	
Nonlinear Optimization
To find the best operating point for a set of given condition in a power system, 
we have to select a cost criterion. Minimum operating cost is a sound goal for 

208
Optimal Operation of Power Systems
the optimum of an electric power system; minimum losses or the least amount 
of emissions are also valid cost functions. The starting point is to establish a cost 
function and a proper set of constraints that must be satisfied in order to have a 
feasible solution.
	
minC(x,u)
subject to f (x,u) = 0
	
(7.1)
C	
cost function
x	
state variables
u	
control variables
f(x, u)	
set of equality constraints
A solution to (7.1), assuming continuous functions, starts with differential expres-
sions for the cost function C(x, u) and for the equality constraint f(x, u).
	
dC(x,u) =
∂C
∂x
⎡
⎣⎢
⎤
⎦⎥
t
dx +
∂C
∂u
⎡
⎣⎢
⎤
⎦⎥
t
du
df (x,u) =
∂f
∂x
⎡
⎣⎢
⎤
⎦⎥dx +
∂f
∂u
⎡
⎣⎢
⎤
⎦⎥du = 0 	 (7.2)
From (7.2) we write the differential dx and make a substitution, given that we have 
the same number of equality constraints as state variables x.
	
dx = −∂f
∂x
⎡
⎣⎢
⎤
⎦⎥
−1 ∂f
∂u
⎡
⎣⎢
⎤
⎦⎥du 	
(7.3)
	
dC(x,u) =
∂C
∂x
⎡
⎣⎢
⎤
⎦⎥
t
−∂f
∂x
⎡
⎣⎢
⎤
⎦⎥
−1 ∂f
∂u
⎡
⎣⎢
⎤
⎦⎥du
⎛
⎝⎜
⎞
⎠⎟+
∂C
∂u
⎡
⎣⎢
⎤
⎦⎥
t
du 	
(7.4)
We note that (7.4) is a gradient with respect to u. It is a reduced gradient.
	
∇uC(x,u) = dC(x,u)
du
= −∂C
∂x
⎡
⎣⎢
⎤
⎦⎥
t ∂f
∂x
⎡
⎣⎢
⎤
⎦⎥
−1 ∂f
∂u
⎡
⎣⎢
⎤
⎦⎥+
∂C
∂u
⎡
⎣⎢
⎤
⎦⎥
t
= 0 	
(7.5)
We define the Lagrange multipliers that later can be identified as short-term mar-
ginal costs by:
	
lt = −∂C
∂x
⎡
⎣⎢
⎤
⎦⎥
t ∂f
∂x
⎡
⎣⎢
⎤
⎦⎥
−1
 or  lt ∂f
∂x
⎡
⎣⎢
⎤
⎦⎥= −∂C
∂x
⎡
⎣⎢
⎤
⎦⎥
t
	
(7.6)
From (7.6):
	
lt ∂f
∂u
⎡
⎣⎢
⎤
⎦⎥+
∂C
∂u
⎡
⎣⎢
⎤
⎦⎥
t
= 0 	
(7.7)

7.2	
Nonlinear Optimization
209
The last equation (7.7) and the equality constraint f(x, u) = 0 are components for 
the gradient of a cost function ξ(x, u, λ) or augmented Lagrangian.
	
x(x,u, l) = C(x,u) + ltf (x,u) 	
(7.8)
	
∇x(x,u, l) =
∂x(x,u, l)
∂x
∂x(x,u, l)
∂u
∂x(x,u, l)
∂l
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
=
∂C
∂x
⎡
⎣⎢
⎤
⎦⎥+
∂f
∂x
⎡
⎣⎢
⎤
⎦⎥
t
l
∂C
∂u
⎡
⎣⎢
⎤
⎦⎥+
∂f
∂u
⎡
⎣⎢
⎤
⎦⎥
t
l
f (x,u)
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
0
0
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	
(7.9)
We transformed the original problem into a problem with no constraints; λ vari-
ables are to be determined when we solve the gradient equal zero. The resulting 
system of equations, gradient equal zero, might be nonlinear so an iterative process 
might be required.
Example 7.1
Surface plot for a two variable cost C(x, u) = x2 + 3u2 (see Figure 7.1), equality con-
straint f(x, u) = 4 − x − u = 0.
Figure 7.1  Cost function surface, C(x, u) = x2 + 3u2. 

210
Optimal Operation of Power Systems
% Code to plot a surface
clear
x=-5:0.5:5;
y=x;
[X,Y]=meshgrid(x,y);
C=X.*X+3*Y.*Y;
surf(X,Y,C)
C1=4-X-Y;
surf(X,Y,C1)
Example 7.2
a)	 Write the augmented Lagrangian function for Example 7.1. The cost function 
is C(x, u) = x2 + 3u2 and the equality constraint is f(x, u) = 4 − x − u = 0 (see 
Figure 7.2), then: ξ(x, u, λ) = x2 + 3u2 + λt(4 − x − u).
b)	 Find the gradient for the Lagrangian in a) and write the solution for x, u, and λ.
	
∇x(x,u, l) =
∂x(x,u, l)
∂x
∂x(x,u, l)
∂u
∂x(x,u, l)
∂l
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
=
2x −l
6u −l
4 −x −u
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥=
0
0
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥ Gradient 	
(7.10)
Figure 7.2  Cost function surface and equality constraint, C1 = 4 − x − u. 

7.3	
Optimal Dispatch with No Losses
211
In this case, the gradient is a linear set of equations, the solution for x, u, and λ are 
found when the linear system of equations is solved.
	
2
0
−1
0
6
−1
−1 −1
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
x
u
l
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥=
0
0
−4
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
x
u
l
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥=
3
1
6
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(7.11)
The cost function has a value of C(3, 1) = (3)2 + 3(1)2 = 12.
7.3	
Optimal Dispatch with No Losses
The material presented so far gives us the opportunity to discuss basic concepts and 
a useful interpretation from the basic solution. Assume that n thermal units need 
to be coordinated to supply a total amount of load PD MW. The assumption is that 
all the n units are connected, no limits are enforced, and the cost for the generators 
are nonlinear functions with first and second derivatives with no discontinuities. 
Let us write the cost function (7.12) and equality constraint (7.13).
	
CTotal =
Ck PGk
(
)
k=1
n
∑
  $/h 	
(7.12)
	
PD −
PGk
k=1
n
∑
= 0  MW 	
(7.13)
The augmented Lagrangian is a function that includes the cost functions and the 
equality constraint.
	
x(P, l) =
Ck PGk
(
)
k=1
n
∑
+ l PD −
PGk
k=1
n
∑
⎡
⎣⎢
⎤
⎦⎥	
(7.14)
At the optimum the gradient of (7.14) should equal to zero.
	
∇x(P, l) =
∂x(P, l)
∂PG1
∂x(P, l)
∂PG2
!
∂x(P, l)
∂l
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
∂C1 PG1
(
)
∂PG1
−l
∂C2 PG2
(
)
∂PG2
−l
!
PD −
PGk
k=1
n
∑
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
0
0
!
0
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(7.15)
From (7.15) we readily see that the first component of the gradient gives an equal 
incremental cost solution. From these components, we find system’s lambda units 

212
Optimal Operation of Power Systems
as $/MWh. A common interpretation is that the marginal cost is the cost of the 
next MWh for the system’s demand.
	
l = ∂C1 PG1
(
)
∂PG1
= ∂C2 PG2
(
)
∂PG2
= … = ∂Cn PGn
(
)
∂PGn
	
(7.16)
Example 7.3
For a no-loss system with two units that have quadratic cost function and the equal-
ity constraint representing the balance between load and generation that must be 
satisfied as in (7.13). Let us solve the economic dispatch and then solve for the real 
power flows using a DC approximation for the network (see Figure 7.3).
	
C1 PG1
(
)
C1 PG1
(
)
f PG1,PG2
(
)
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
4 + 2PG1 + 1
2 PG1
2
5 + 3PG1 + 1
2 PG2
2
4 −PG1 −PG2
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
	
(7.17)
The Lagrangian equation and its gradient are:
	
x PG1,PG2, l
(
) = C1 PG1
(
) + C2 PG2
(
) + l PD −PG1 −PG2
⎡⎣
⎤⎦	
(7.18)
	
∇x(PG1,PG2, l) =
∂x PG1,PG2, l
(
)
∂PG1
∂x PG1,PG2, l
(
)
∂PG2
∂x PG1,PG2, l
(
)
∂l
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
∂C1(PG1)
∂PG1
−l
∂C2(PG2)
∂PG2
−l
PD −PG1 −PG2
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
0
0
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	
(7.19)
Figure 7.3  System with three nodes, no losses. 

7.3	
Optimal Dispatch with No Losses
213
The gradient equal zero and the linear system of equations:
	
2 + PG1 −l
3 + PG2 −l
4 −PG1 −PG2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
0
0
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
1
0
−1
0
1
−1
−1 −1
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
PG1
PG2
l
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
−2
−3
−4
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	
(7.20)
Solution is PG1= 2.5 MW, PG2= 1.5 MW, system’s λ = 4.5 $/MWh, and the total 
cost is CTotal = 4 + 2(2.5) + 1/2(2.5)2 + 5 + 3(1.5) + 1/2(1.5)2 = 22.75 $/h.
Once we find the economic dispatch that assigns the level of generation for each 
generator, a DC approximation to load flow solution follows. Through the nodal 
admittance matrix, we relate real power injection and nodal angles in radians. One 
nodal angle is reference—let’s say θ1 zero.
	
+15 −10
−5
+10 +15
−5
−5
−5
+10
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
0
q2
q3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
PG1 −1
1.5 −1
−2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
q2
q3
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
−2
50
−11
50
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
  rad 	
(7.21)
The line flows are p12 = (θ1 − θ2)/x12 = 4/10, p13 = (θ1 − θ3)/x13 = 11/10 and p23 = 
(θ2 − θ3)/x23 = 9/10 (see Figure 7.4).
7.3.1	
Inequality Constraints
This is a proper place to introduce the inequality constraints among various inequali-
ties that must be satisfied. For example, the output of a generator might be limited. 
Equations (7.12) and (7.13) establish the problem, and then we add the inequality; 
for this problem, the total cost in $/h, equality constraint in MW, and the inequal-
ity constraint in MW.
Figure 7.4  Load flow solution for three-node system, no-losses. 

214
Optimal Operation of Power Systems
	
CTotal
f (P)
h(P)
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
Ck PGk
(
)
k=1
n
∑
PD −
PGk = 0
k=1
n
∑
Pk
max −PGk ≤0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(7.22)
We write the augmented Lagrangian, including a Kuhn-Tucker multiplier μ, to aug-
ment the inequality constraint.
	
x(P, l,m) =
Ck PGk
(
)
k=1
n
∑
+ l PD −
PGk
k=1
n
∑
⎡
⎣⎢
⎤
⎦⎥+ m PGk −Pk
max
(
) 	
(7.23)
The necessary condition for an optimal gradient that must be equal to zero, and 
has the solution at the same incremental cost for every generator working within 
limits, and a μ as an adjusted incremental cost for generator k at one of its limits.
Figure 7.5  Cost surface and equality constraint. 

7.3	
Optimal Dispatch with No Losses
215
	
∇x(P, l,m) =
:
∂x(P, l,m)
∂PGk
:
∂x(P, l,m)
∂l
∂x(P, l,m)
∂m
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
:
∂Ck PGk
(
)
∂PGk
−l + m
:
PD −
PGk
k=1
n
∑
PGk −Pk
max
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
0
0
:
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(7.24)
	
l = ∂C1 PG1
(
)
∂PG1
= ∂C2 PG2
(
)
∂PG2
= … = ∂Ck PGk
(
)
∂PGk
+ m 	
(7.25)
Example 7.4
Assume a lossless system with three generators that have lower and upper generat-
ing limits as shown in (7.26). Total load demand is PD = 1,100 MW. Solve for the 
optimal dispatch problem, assuming that the incremental costs and limits are:
	
dC1
dPG1
dC2
dPG2
dC3
dPG3
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
7.92 + 0.003124 PG1
7.85 + 0.00388 PG2
7.97 + 0.00964 PG3
1,100 −PG1 −PG2 −PG3
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
150 ≤PG1 ≤600
100 ≤PG2 ≤400
50 ≤PG3 ≤300
	
(7.26)
• Solution assuming no limit violations:
Economic Dispatch, no losses
Number of dispatchable units =    3  Demand =   1100 MW
Unit     Incremental cost         Limits Min  Max
   1      0.003124    7.920000    150.00      600.00
   2      0.003880    7.850000    100.00      400.00
   3      0.009640    7.970000     50.00      300.00
Solution, Marginal Cost =     9.52 $/MWh
Unit      PG(k)      Violation (Min Max)   Flag     IC(k)
   1      510.58       ------    ------      0       9.52
   2      429.14       ------    400.00      1       9.52
   3      160.28       ------    ------      0       9.52
Total Generation =   1100 MW
New Marginal Cost =     9.58 $/MWh     mu =     0.18 $/MWh

216
Optimal Operation of Power Systems
Unit      PG(k)      Violation (Min Max)   Flag     IC(k)
   1      532.59       ------    ------      0       9.58
   2      400.00       ------    ------      0       9.40
   3      167.41       ------    ------      0       9.58
Total Generation =   1100 MW
7.4	
Real Power Losses
Transmission losses are present in a real power system; losses must be included 
in the real power balance equation. One approach is to derive an equation to cal-
culate power losses PL in the system; the amount of losses depends on the electri-
cal distance that the generator’s power has to travel up to the load nodes. A more 
general approach than a loss formula is required. However, in order to illustrate 
this process, let us minimize the operating cost to include losses with no inequality 
constraints in order to concentrate our attention in the meaning of the solution. 
First, we write the Lagrangian (7.27), where total cost function $/h, the equality 
constraints and losses are in MW: CTotal = 
Ck PGk
(
)
k=1
n
∑
, f(PG) = PD + PL − 
PGk
k=1
n
∑
 
= 0, PL = PL(PG1, PG2, …, PGn). The gradient is a set (7.28) where incremental losses 
∂PL/∂PGk are required.
	
x(P, l) =
Ck PGk
(
)
k=1
n
∑
+ l PD + PL −
PGk
k=1
n
∑
⎛
⎝⎜
⎞
⎠⎟	
(7.27)
	
∇x(P, l) =
:
∂Ck PGk
(
)
∂PGk
+ l
∂PL
∂PGk
−1
⎛
⎝⎜
⎞
⎠⎟
:
PD + PL −
PGk
k=1
n
∑
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
:
0
:
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(7.28)
From (7.28) the solution at the same incremental cost remains valid, and now λ is 
a penalized incremental cost for generator k:
	
l =
∂Ck PGk
(
)
∂PGk
1 −∂PL
∂PGk
⎛
⎝⎜
⎞
⎠⎟
	
(7.29)
Power losses are a nonlinear function. Therefore, the gradient components in (7.28) 
are nonlinear equations. An iterative algorithm as Newton’s type is the proper way 
to solve the nonlinear equation (7.28). Newton’s incremental form is:

7.4	
Real Power Losses
217
:
:
:
.. ∂2Ck PGk
(
)
∂PGk
2
+ l ∂2PL
∂PGk
2
..
l
∂2PL
∂PGk ∂PGm
..
∂PL
∂PGk
−1
:
:
:
..
l
∂2PL
∂PGm ∂PGk
.. ∂2Cm PGm
(
)
∂PGm
2
+ λ ∂2PL
∂PGm
2
..
∂PL
∂PGm
−1
:
:
:
..
∂PL
∂PGk
−1
..
∂PL
∂PGm
−1
..
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
:
ΔPGk
:
ΔPGm
:
Δl
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
= −
:
gk
:
gm
:
gn+1
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
 

(7.30)
Example 7.5
A system with two generators must supply the load PD and losses PL. The loss for-
mula is given as PL = 0.1 P2
G1 − 0.1 PG1PG2 + 0.2 P2
G2 (see Figure 7.6), and we use it to 
solve the optimal dispatch problem, assuming incremental costs for the two genera-
tors as ∂C1/∂PG1 = PG1 + 2, ∂C1/∂PG2 = 0, ∂C2/∂PG1 = 0, and ∂C2/∂PG2 = PG2 + 1.5.
The gradient as in (7.28) is equal to zero; Newton’s method is used to solve the 
nonlinear set of equations from the gradient. The incremental set of equations is 
(7.32).
Figure 7.6  Surface for power losses, Example 7.5. 

218
Optimal Operation of Power Systems
g1
g1
g1
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
∂C1
∂PG1
+ l
∂PL
∂PG1
−1
⎛
⎝⎜
⎞
⎠⎟
∂C2
∂PG2
+ l
∂PL
∂PG2
−1
⎛
⎝⎜
⎞
⎠⎟
PD + PL −PG1 −PG2
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
PG1 + 2 + l 0.2PG1 −0.1PG2 −1
(
)
PG2 + 1.5 + l −0.1PG1 + 0.4PG2 −1
(
)
PD + PL −PG1 −PG2
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
0
0
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
 

(7.31)
1 + 0.2l
−0.1l
0.2PG1 −0.1PG2 −1
−0.1l
1 + 0.4l
−0.1PG1 + 0.4PG2 −1
0.2PG1 −0.1PG2 −1 −0.1PG1 + 0.4PG2 −1
0
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
ΔPG1
ΔPG2
Δl
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
= −
g1
g1
g1
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
 

(7.32)
Starting with values PG1 = PG2 = λ = 0, the iterative process solves the no-loss prob-
lem. We found that the solution i in four iterations within a tight tolerance, solu-
tion shows equal incremental costs when the penalty factor due to the incremental 
losses is included.
Economic Dispatch, including losses
Iteration   PG values and lamda                   Maxdev
   0        0.000000     0.000000     0.000000    2.000000e+000
   1        0.310550     0.810550     2.310550    6.773724e-001
   2        0.557465     0.618537     2.665436    3.601975e-002
   3        0.556278     0.642462     2.682422    1.645744e-004
   4        0.556404     0.642459     2.682578    3.976804e-009
Convergence in   4 iterations
Solution
  PG1          PG2          Pdemand      Plosses       System lamda
  0.556404     0.642459     1.121100     0.077763      2.682578
Incremental Costs for generators
  2.556404     2.142459
Incremental losses
  0.047035     0.201343
Penalty factors
  0.952965     0.798657
Penalized Incremental costs
  2.682578     2.682578
7.5	
Minimum Losses
The cost function for the optimal problem can be other than the cost itself, for 
instance, it might be interesting to solve the minimum loss problem. Let us assume 
n generators, a loss formula PL = fL PG1,PG2,…,PGn
(
)  and a system’s demand PD to 
be satisfied. The Lagrange function is:

7.5	
Minimum Losses
219
	
minx = PL + lL PD + PL −PG1 −PG2… −PGn
(
)	
(7.33)
λL	
Lagrange multiplier, to include the demand equality constraint
The gradient to minimize losses is written:
	
∇x =
∂x
∂PG1
∂x
∂PG2
:
∂x
∂λL
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
∂PL
∂PG1
+ lL
∂PL
∂PG1
−1
⎛
⎝⎜
⎞
⎠⎟
∂PL
∂PG2
+ lL
∂PL
∂PG2
−1
⎛
⎝⎜
⎞
⎠⎟
:
PD + PL −PG1 −PG2… −PGn
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
0
0
:
0
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(7.34)
Equation (7.34) shows that we will find a solution when the penalized incremental 
losses are the same for every participating generator. Note that in this case, the 
Lagrange multiplier λL has no dimensions and its meaning is very different from 
the interpretation given to the Lagrange multiplier in the minimum cost solution.
	
lL =
∂PL
∂PG1
1 −∂PL
∂PG1
⎛
⎝⎜
⎞
⎠⎟
= … =
∂PL
∂PGn
1 −∂PL
∂PGn
⎛
⎝⎜
⎞
⎠⎟
	
(7.35)
Example 7.6
For a two-generator system to supply load PD and losses PL (see Figure 7.7), solve 
the minimum loss problem, given the loss formula. Find the augmented Lagrangian, 
Figure 7.7  A three-node system, the minimum loss solution. 

220
Optimal Operation of Power Systems
the gradient by (7.34), and the operation cost given cost and loss formula C1 PG1
(
)  
= 7.0 PG1 + 0.002 P2
G1, C2 PG2
(
) = 7.0 PG2 + 0.002 P2
G2, and PL = 0.0002 P2
G1 + 
0.00015 P2
G2.
	
minx = PL + lL PD + PL −PG1 −PG2
(
)	
(7.36)
∇x =
∂PL
∂PG1
+ lL
∂PL
∂PG1
−1
⎛
⎝⎜
⎞
⎠⎟
∂PL
∂PG2
+ lL
∂PL
∂PG2
−1
⎛
⎝⎜
⎞
⎠⎟
PD + PL −PG1 −PG2
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
0.0004PG1 + lL 0.0004PG1 −1
(
)
0.0003PG2 + lL 0.0003PG2 −1
(
)
500 + PL −PG1 −PG2
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
0
0
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
 

(7.37)
We propose to solve the nonlinear set by Newton’s iterative procedure.
Gradient and Newton’s incremental form:
	
g1
g2
g3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
0.0004PG1 + lL 0.0004PG1 −1
(
)
0.0003PG2 + lL 0.0003PG2 −1
(
)
500 + PL −PG1 −PG2
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
0
0
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	
(7.38)
0.0004 1 + lL
(
)
0
0.0004PG1 −1
0
0.0003 1 + lL
(
) 0.0003PG2 −1
0.0004PG1 −1
0.0003PG2 −1
0
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
ΔPG1
ΔPG2
ΔlL
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
= −
g1
g1
g1
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(7.39)
Minimum losses
Iteration   PG values and lamda                   Maxdev
   0        0.000000     0.000000     0.000000    5.000000e+002
   1      214.285714   285.714286     0.085714    2.142857e+001
   2      224.330357   299.107143     0.098521    4.708426e-002
   3      224.352525   299.136700     0.098588    2.293329e-007
Convergence in   3 iterations
  PG1          PG2          Pdemand      Plosses     lamda Losses
224.352525   299.136700   500.000000    23.489226    0.098588
Incremental Costs
  7.897410     8.196547
Incremental losses
  0.089741     0.089741
Penalty factors
  0.910259     0.910259

7.5	
Minimum Losses
221
Penalized Incremental Losses
  0.098588     0.098588
Penalized Incremental Costs
  8.676003     9.004632
Cost G1 =    1671.14 $/h    Cost G2 =    2272.92 $/h
Total Operating Cost =    3944.06 $/h
Let us compare the solution to the minimum cost when the load to be supplied is 
500 MW.
∇x =
∂C1
∂PG1
+ l
∂PL
∂PG1
−1
⎛
⎝⎜
⎞
⎠⎟
∂C2
∂PG2
+ l
∂PL
∂PG2
−1
⎛
⎝⎜
⎞
⎠⎟
PD + PL −PG1 −PG2
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
0.004PG1 + 7 + l 0.0004PG1 −1
(
)
0.004PG2 + 7 + l 0.0003PG2 −1
(
)
500 + PL −PG1 −PG2
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
0
0
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(7.40)
0.004 + 0.0004l
0
0.0004PG1 −1
0
0.004 + 0.0003l 0.0003PG2 −1
0.0004PG1 −1
0.0003PG2 −1
0
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
ΔPG1
ΔPG2
Δl
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
= −
g1
g1
g1
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(7.41)
Economic Dispatch, including losses
Iteration   PG values                 lamda       Maxdev
   0        0.000000     0.000000     0.000000    5.000000e+002
   1      250.000000   250.000000     8.000000    2.187500e+001
   2      244.799242   278.708846     8.847283    1.290393e-001
   3      245.504785   278.155131     8.851225    1.455484e-004
   4      245.504734   278.155340     8.851226    7.048584e-012
Convergence in   4 iterations
  PG1          PG2          Pdemand      Plosses     System lamda
245.504734   278.155340   500.000000    23.660074    8.851226
Incremental Costs
  7.982019     8.112621
Incremental losses
  0.098202     0.083447
Penalty factors
  0.901798     0.916553
Penalized Incremental costs
  8.851226     8.851226
Cost G1 =    1839.08 $/h    Cost G2 =    2101.83 $/h
Total Operating Cost =    3940.91 $/h

222
Optimal Operation of Power Systems
The example shows the minimum loss solution versus the minimum operating cost; 
it is worth noting that the minimum losses solution has a slightly higher cost. The 
solution is at the same penalized incremental loss and the same penalized incremental 
cost, respectively. It is a common practice by power system operators to pursue the 
minimum cost solution; this is the goal from the economic point of view.
7.6	
Optimal Operation, Transmission Losses Included
At this point, we are ready to establish a more general formulation for the power 
flow problem. One issue is how to include transmission losses. In Sections 7.4 and 
7.5 we used a loss formula, but in general, no such formula is readily available, 
even though much effort went into establishing a procedure to find the loss formula 
for a given network in the past. Losses at each transmission line are included in 
the nodal power balance, so there is no need to write a system’s loss formula by 
itself unless some specific application requires that information.
To illustrate the concepts of the minimum loss solution, let us use a three-
node system (see Figure 7.8). To concentrate on the solution steps, we assume that 
nodal voltages are held at 1.0 pu, so no voltages and reactive power flows are writ-
ten explicitly.
	
min PL = PG1 + PG3 −PD
s.a.
p12 −PG1 + PD1 = 0
p21 + p23 + PD2 = 0
p32 −PG3 + PD3 = 0
	
(7.42)
The Lagrange function has as unknown variables: PG1, PG3, θ1, θ2, θ3, λ1L, λ2L, 
λ3L. At the solution, the gradient of the augmented Lagragian must be equal to zero, 
and one nodal angle will be reference.
	
minz = PG1 + PG3 −PD + l1L p12 −PG1 + PD1
(
)
+l2L p21 + p23 + PD2
(
) + l3L p32 −PG3 + PD3
(
)
	
(7.43)
Figure 7.8  System to generalize the minimum loss solution, three-node. 

7.6	
Optimal Operation, Transmission Losses Included
223
∇z =
∂ζ
∂PG1
∂ζ
∂PG3
∂z
∂q1
∂z
∂q2
∂z
∂q3
∂z
∂l1L
∂z
∂l2L
∂z
∂l3L
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
g1
g2
g3
g4
g5
g6
g7
g8
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
1 −l1L
1 −l3L
l1L
∂p12
∂q1
+ l2L
∂p21
∂q1
l1L
∂p12
∂q2
+ l2L(∂p21
∂q2
+ ∂p23
∂q2
) + l3L
∂p32
∂q2
l2L
∂p23
∂q3
+ l3L
∂p32
∂q3
p12 −PG1 + PD1
p21 + p23 + PD2
p32 −PG3 + PD3
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
0
0
0
0
0
0
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(7.44)
We write Newton’s iterative method to solve the nonlinear equations from the gra-
dient (7.44).
	
0
0
0
0
0
−1
0
0
0
0
0
0
0
0
0
−1
0
0
∂g3
∂q1
∂g3
∂q2
0
∂g3
∂l1L
∂g3
∂l2L
0
0
0
∂g4
∂q1
∂g4
∂q2
∂g4
∂q3
∂g4
∂l1L
∂g4
∂l2L
∂g4
∂l3L
0
0
0
∂g5
∂q2
∂g5
∂q3
0
∂g5
∂l2L
∂g5
∂l3L
−1
0
∂g6
∂q1
∂g6
∂q2
0
0
0
0
0
0
∂g7
∂q1
∂g7
∂q2
∂g7
∂q3
0
0
0
0
−1
0
∂g8
∂q2
∂g8
∂q3
0
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
ΔPG1
ΔPG3
Δq1
Δq2
Δq3
Δl1L
Δl2L
Δl3L
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
= −
g1
g2
g3
g4
g5
g6
g7
g8
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	 (7.45)
In (7.45) we see that some gradient components already have first partial derivatives, 
and then some second derivatives are required. Section 7.8 lists the set of derivatives 
that are required. The incremental real power flows are for transmission lines and 
transformers with a complex tap changer are basic elements that must be considered. 
For the problem at hand, we list the partial derivatives required in (7.45) as the set 
(7.46). Numerical results will follow in Figure 7.9.

224
Optimal Operation of Power Systems
	
∂g3
∂q1
= l1L
∂2p12
∂q1
2
+ l2L
∂2p21
∂q1
2
∂g3
∂q2
= l1L
∂2p12
∂q2 ∂q1
+ l2L
∂2p21
∂q2 ∂q1
∂g3
∂l1L
= ∂p12
∂q1
∂g3
∂l2L
= ∂p21
∂q1
∂g4
∂q1
= l1L
∂2p12
∂q1 ∂q2
+ l2L
∂2p21
∂q1 ∂q2
∂g4
∂q2
= l1L
∂2p12
∂q2
2
+ l2L(∂2p21
∂q2
2
+ ∂2p23
∂q2
2 ) + l3L
∂2p32
∂q2
2
∂g4
∂q3
= l2L
∂2p23
∂q3 ∂q2
+ l3L
∂2p32
∂q3 ∂q2
∂g4
∂l1L
= ∂p12
∂q2
∂g4
∂l2L
= ∂p21
∂q2
+ ∂p23
∂q2
∂g4
∂l3L
= ∂p32
∂q2
∂g5
∂q2
= l2L
∂2p23
∂q2 ∂q3
+ l3L
∂2p32
∂q2 ∂q3
∂g5
∂q3
= l2L
∂2p23
∂q3
2
+ l3L
∂2p32
∂q3
2
∂g5
∂l2L
= ∂p23
∂q3
∂g5
∂l3L
= ∂p32
∂q3
∂g6
∂q1
= ∂p12
∂q1
∂g6
∂q2
= ∂p12
∂q2
∂g7
∂q1
= ∂p21
∂q1
∂g7
∂q2
= ∂p21
∂q2
+ ∂p23
∂q2
∂g7
∂q3
= ∂p23
∂q3
∂g8
∂q2
= ∂p32
∂q2
∂g8
∂q3
= ∂p32
∂q3
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(7.46)

7.6	
Optimal Operation, Transmission Losses Included
225
Elements =    2
Nodes    =    3
Array of elements (duplicated)
Elem   N_from   N_to   typeel  tap      tau        yelem           Bsh/2
 1      1       2      -1      1.05     0.09   1.0000 +j-10.0000  +j 0.0000
 2      2       3       1      1.00     0.00   2.0000 +j-15.0000  +j 0.0000
 3      2       1      -1      1.05     0.09   1.0000 +j-10.0000  +j 0.0000
 4      3       2       1      1.00     0.00   2.0000 +j-15.0000  +j 0.0000
Node data
Node      type      Voltage       Angle         Pgen       Pload
  1        0        1.0000        0.0000        0.00       0.50
  2       -1        1.0000        0.0000        0.00       0.75
  3        1        1.0000        0.0000        0.00       0.30
Node type Generation =    2    Load =   1
Iteration =      0     Maxdev = 7.216309e-001
Iteration =      1     Maxdev = 3.342385e-003
Iteration =      2     Maxdev = 1.231484e-007
Node summary
Node    type   Voltage    Angle    Pgen     Pload     Qgen     Qload
  1      0     1.0000     -0.00    0.8915   0.5000    0.4966   0.0000
  2     -1     1.0000      3.15    0.0000   0.7500    0.0000   0.4080
  3      1     1.0000      4.54    0.6633   0.3000   -0.0440   0.0000
Load flows (duplicated)
Elem  N_from  N_to   type_el   tap       tau       pkm         qkm
  1      1      2     -1       1.05      5.00      0.3915      0.4966
  1      2      1     -1       1.05      5.00     -0.3879     -0.4607
  2      2      3      1       1.00      0.00     -0.3621      0.0527
  2      3      2      1       1.00      0.00      0.3633     -0.0440
PLtot =   0.0048     QLtot =   0.0447
Lamda values
k =        1     Lamdap =   1.0000
k =        2     Lamdap =   1.0065
k =        3     Lamdap =   1.0000
7.6.1	
Minimum Cost Power Flow Formulation
If a solution to the minimum operating cost is more general than load power flows, 
then we use the formulation for optimum power flow; we must represent all nodal 
Figure 7.9  Three-node system load flows for a minimum loss solution.

226
Optimal Operation of Power Systems
power balances. The Lagrangian for the system in Figure 7.9 will illustrate the steps 
to solving equations for minimum cost in a large power network; the gradient of the 
augmented Lagragian has to be zero at the solution point. We use Newton’s method 
to solve the nonlinear set of equations that come from the gradient.
To generalize the solution process, we partition the incremental matrix W to 
solve (7.48). For Newton’s iterative process, it is convenient to have the following 
groups of variables xP real power generation values, nodal angles and real power 
marginal costs, and xQ reactive power by generators and sources in general. For the 
numerical solution, one nodal angle must be referenced; nodes with constant volt-
age will keep their fixed value as long as the reactive power limits at the connected 
source are within bounds. Results are shown in Figure 7.10.
minz = C1 PG1
(
) + C3 PG3
(
) + 1
2 QG1
2 + QG3
2
(
)
+l1P p12 −PG1 + PD1
(
) + l2P p21 + p23 + PD2
(
) + l3P p32 −PG3 + PD3
(
)
+l1Q q12 −QG1 + QD1
(
) + l2Q q21 + q23 + QD2
(
) + l3Q q32 −QG3 + QD3
(
)
	
(7.47)
∇z =
∂z
∂PG1
∂z
∂PG3
∂z
∂θ1
∂z
∂θ2
∂z
∂θ3
∂z
∂λ1P
∂z
∂λ2P
∂z
∂λ3P
∂z
∂QG1
∂z
∂QG3
∂z
∂V1
V1
∂z
∂V2
V2
∂z
∂V3
V3
∂z
∂l1Q
∂z
∂l2Q
∂z
∂l3Q
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
g1
g2
g3
g4
g5
g6
g7
g8
g9
g10
g11
g12
g13
g14
g15
g16
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
dC1
dPG1
−l1P
dC3
dPG3
−l3P
λ1P
∂p12
∂q1
+ l2P
∂p21
∂q1
+ λ1Q
∂q12
∂q1
+ l2Q
∂q21
∂q1
l1P
∂p12
∂q2
+ l2P
∂p21
∂q2
+ ∂p23
∂q2
⎛
⎝⎜
⎞
⎠⎟+ l3P
∂p32
∂q2
+ λ1Q
∂q12
∂q2
+ l2Q
∂q21
∂q2
+ ∂q23
∂q2
⎛
⎝⎜
⎞
⎠⎟+ l3Q
∂q32
∂q2
l2P
∂p23
∂q3
+ l3P
∂p32
∂q3
+ l2Q
∂q23
∂q3
+ l3Q
∂q32
∂q3
p12 −PG1 + PD1
p21 + p23 + PD2
p32 −PG3 + PD3
QG1 −λ1Q
QG3 −λ3Q
l1P
∂p12
∂V1
+ l2P
∂p21
∂V1
+ λ1Q
∂q12
∂V1
+ l2Q
∂q21
∂V1
⎛
⎝⎜
⎞
⎠⎟V1
l1P
∂p12
∂V2
+ l2P
∂p21
∂V2
+ ∂p23
∂V2
⎛
⎝⎜
⎞
⎠⎟+ l3P
∂p32
∂V2
+ λ1Q
∂q12
∂V2
+ l2Q
∂q21
∂V2
+ ∂q23
∂V2
⎛
⎝⎜
⎞
⎠⎟+ l3Q
∂q32
∂V2
⎛
⎝
⎜
⎞
⎠
⎟V2
l2P
∂p23
∂V3
+ l3P
∂p32
∂V3
+ l2Q
∂q23
∂V3
+ l3Q
∂q32
∂V3
⎛
⎝⎜
⎞
⎠⎟V3
q12 −QG1 + QD1
q21 + q23 + QD2
q32 −QG3 + QD3
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
 

(7.48)

7.6	
Optimal Operation, Transmission Losses Included
227
	
W11 W12
W21 W22
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
ΔxP
ΔxQ
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
= −
gP
gQ
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(7.49)
	
ΔxP =
ΔPG1 ΔPG3 Δq1 Δq2 Δq3 Δl1P Δl2P Δl3P
⎡⎣
⎤⎦
ΔxQ =
ΔQG1 ΔQG3 Δ V1
V1
Δ V2
V2
Δ V3
V3
Δl1Q Δl2Q Δl3Q
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(7.50)
	
gP =
g1 … g8
⎡⎣
⎤⎦
gQ =
g9 … g14
⎡⎣
⎤⎦
	
(7.51)
Elements in submatrix W11 and W22 (assuming that W12 and W21 have small values 
compared to the ones at W11 and W22) will render a decoupled real-reactive approach.
W11 =
d2C1
dPG1
2
0
0
0
0
−1
0
0
0
d2C3
dPG3
2
0
0
0
0
0
−1
0
0
∂g3
∂q1
∂g3
∂q2
0
∂p12
∂q1
∂p21
∂q1
0
0
0
∂g4
∂q1
∂g4
∂q2
∂g4
∂q3
∂p12
∂q2
∂p21
∂q2
+ ∂p23
∂q2
∂p32
∂q2
0
0
0
∂g5
∂q2
∂g5
∂θ3
0
∂p23
∂q3
∂p32
∂q3
−1
0
∂p12
∂q1
∂p12
∂q2
0
0
0
0
0
0
∂p21
∂q1
∂p21
∂q2
+ ∂p23
∂q2
∂p23
∂q3
0
0
0
0
−1
0
∂p32
∂q2
∂p32
∂q3
0
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	 (7.52)

228
Optimal Operation of Power Systems
The required partial derivatives for W11 and W22 are:
	
∂g3
∂q1
= l1P
∂2p12
∂q1
2
+ l2P
∂2p21
∂q1
2
+ l1Q
∂2q12
∂q1
2
+ l2Q
∂2q21
∂q1
2
∂g3
∂q2
= l1P
∂2p12
∂q2 ∂q1
+ l2P
∂2p21
∂q2 ∂q1
+ l1Q
∂2q12
∂q2 ∂q1
+ l2Q
∂2q21
∂q2 ∂q1
∂g4
∂q1
= l1P
∂2p12
∂q1 ∂q2
+ l2P
∂2p21
∂q1 ∂q2
+ l1Q
∂2q12
∂q1 ∂q2
+ l2Q
∂2q21
∂q1 ∂q2
= ∂g3
∂q2
∂g4
∂q2
= l1P
∂2p12
∂q2
2
+ l2P
∂2p21
∂q2
2
+ ∂2p23
∂q2
2
⎛
⎝⎜
⎞
⎠⎟+ l3P
∂2p32
∂q2
2
+ l1Q
∂2q12
∂q2
2
+ l2Q
∂2q21
∂q2
2
+ ∂2q23
∂q2
2
⎛
⎝⎜
⎞
⎠⎟+ l3Q
∂2q32
∂q2
2
∂g4
∂q3
= l2P
∂2p23
∂q3 ∂q2
+ l3P
∂2p32
∂q3 ∂q2
+ l2Q
∂2q23
∂q3 ∂q2
+ l3Q
∂2q32
∂q3 ∂q2
∂g5
∂q2
= l2P
∂2p23
∂q2 ∂q3
+ l3P
∂2p32
∂q2 ∂q3
+ l2Q
∂2q23
∂q2 ∂q3
+ l3Q
∂2q32
∂q2 ∂q3
= ∂g4
∂q3
∂g5
∂q3
= l2P
∂2p23
∂q3
2
+ l3P
∂2p32
∂q3
2
+ l2Q
∂2q23
∂q3
2
+ l3Q
∂2q32
∂q3
2
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥ 

(7.53)
W22 =
1
0
0
0
0
−1
0
0
0
1
0
0
0
0
0
−1
0
0
∂g11
∂V1
V1
∂g11
∂V2
V2
0
∂q12
∂V1
V1
∂q12
∂V1
V1
0
0
0
∂g12
∂V1
V1
∂g12
∂V2
V2
∂g12
∂V3
V3
∂q12
∂V2
V2
∂q21
∂V2
V2 + ∂q23
∂V2
V2
∂q23
∂V2
V2
0
0
0
∂g13
∂V2
V2
∂g13
∂V3
V3
0
∂q32
∂V3
V3
∂q32
∂V3
V3
−1
0
∂q12
∂V1
V1
∂q12
∂V2
V2
0
0
0
0
0
0
∂q21
∂V1
V1
∂q21
∂V2
V2 + ∂q23
∂V2
V2
∂q23
∂V3
V3
0
0
0
0
−1
0
∂q32
∂V2
V2
∂q32
∂V3
V3
0
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
 

(7.54)

7.6	
Optimal Operation, Transmission Losses Included
229
∂g11
∂V1
V1 =
l1P
∂2p12
∂V1
2 + l2P
∂2p21
∂V1
2 + l1Q
∂2q12
∂V1
2 + l2Q
∂2q21
∂V1
2
⎛
⎝
⎜⎜
⎞
⎠
⎟⎟V1
2
∂g11
∂V2
V2 =
l1P
∂2p12
∂V2 ∂V1
+ l2P
∂2p21
∂V2 ∂V1
+ l1Q
∂2q12
∂V2 ∂V1
+ l2Q
∂2q21
∂V2 ∂V1
⎛
⎝⎜
⎞
⎠⎟V1 V2
∂g12
∂V1
V1 =
l1P
∂2p12
∂V1 ∂V2
+ l2P
∂2p21
∂V1 ∂V2
+ l1Q
∂2q12
∂V1 ∂V2
+ l2Q
∂2q21
∂V1 ∂V2
⎛
⎝⎜
⎞
⎠⎟V2 V1
∂g12
∂V2
V2 =
l1P
∂2p12
∂V2
2 + l2P
∂2p21
∂V2
2 + ∂2p23
∂V2
2
⎛
⎝
⎜⎜
⎞
⎠
⎟⎟+ l3P
∂2p32
∂V2
2
⎛
⎝
⎜
⎜
⎞
⎠
⎟
⎟
V2
2 +
l1Q
∂2q12
∂V2
2 + l2Q
∂2q21
∂V2
2 + ∂2q23
∂V2
2
⎛
⎝
⎜⎜
⎞
⎠
⎟⎟+ l3Q
∂2q32
∂V2
2
⎛
⎝
⎜
⎜
⎞
⎠
⎟
⎟
V2
2
∂g12
∂V3
V3 =
l2P
∂2p23
∂V3 ∂V2
+ l3P
∂2p32
∂V3 ∂V2
+ l2Q
∂2q23
∂V3 ∂V2
+ l3Q
∂2q32
∂V3 ∂V2
⎛
⎝⎜
⎞
⎠⎟V2 V3
∂g13
∂V2
V2 =
l2P
∂2p23
∂V2 ∂V3
+ l3P
∂2p32
∂V2 ∂V3
+ l2Q
∂2q23
∂V2 ∂V3
+ l3Q
∂2q32
∂V2 ∂V3
⎛
⎝⎜
⎞
⎠⎟V3 V2
∂g13
∂V3
V3 =
l2P
∂2p23
∂V3
2 + l3P
∂2p32
∂V3
2 + l2Q
∂2q23
∂V3
2 + l3Q
∂2q32
∂V3
2
⎛
⎝
⎜⎜
⎞
⎠
⎟⎟V3
2
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥ 

(7.55)
Results are obtained after we apply the decoupled optimal power flow solu-
tion. Using incremental costs for generator 1 and 3 dC1/dPG1 = 7.5 PG1 + 2 dC3/
dPG3 = 6.0 PG3 + 1 .
To start the iterative process, initial values for PG1, PG3, θ1, θ2, θ3, λ1P, λ2P, λ3P, 
QG1, QG3, V1, V2, V3, λ1Q, λ2Q, λ3Q are x0 = [0.80 0.75 0 0 0 1 1 1 0.0 0.0 1 1 1 1 
1 1], which seem reasonable to start the numerical process. An estimate might be 
obtained for these values if we solve a no-loss problem.
Elements =    2
Nodes    =    3
Elements (duplicated)
Elem  N_from   N_to   type     tap      tau           yelem            Bsh/2
  1     1      2      -1      1.050    0.087    1.0000 +j-10.0000  +j  0.0000
  2     2      3       1      1.000    0.000    2.0000 +j-15.0000  +j  0.0000
  3     2      1      -1      1.050    0.087    1.0000 +j-10.0000  +j  0.0000
  4     3      2       1      1.000    0.000    2.0000 +j-15.0000  +j  0.0000
Node Information
Node   type    Voltage     Angle      Pgen      Pload     Qgen      Qload
  1      0     1.0000      0.0000     0.000     0.500     0.000     0.000
  2     -1     1.0000      0.0000     0.000     0.750     0.000     0.408
  3      1     1.0000      0.0000     0.000     0.300     0.000     0.000
Node Type
Generation =    2  Load =   1
Iteration_P  0.0   Maximum gradient = 7.000000e+000
Iteration_Q  0.0   Maximum gradient = 1.000000e+000

230
Optimal Operation of Power Systems
Iteration_P  0.5   Maximum gradient = 9.668531e-001
Iteration_Q  0.5   Maximum gradient = 1.991190e-002
Iteration_P  1.0   Maximum gradient = 2.079699e-004
Iteration_Q  1.0   Maximum gradient = 1.736139e-006
Convergence at    3 iterations
Node information
Node    type    Voltage     Angle     Pgen       Pload       Qgen       Qload
  1      0     1.0000      0.00      0.6224     0.5000      0.5237     0.0000
  2     -1     0.9995      4.62      0.0000     0.7500      0.0000     0.4080
  3      1     1.0000      7.04      0.9337     0.3000     -0.0631     0.0000
Element information
Elem    Nsal     Nlleg     typeel     tap        tau         pkm        qkm
  1      1        2         -1       1.050      5.002       0.1224     0.5237
  1      2        1         -1       1.050      5.002      -0.1198    -0.4977
  2      2        3          1       1.000      0.000      -0.6302     0.0897
  2      3        2          1       1.000      0.000       0.6337    -0.0631
PLtot =   0.0061     QLtot =   0.0525
Lamda values
k =  1     LamdaP =   6.6681
k =  2     LamdaP =   6.6769
k =  3     LamdaP =   6.6024
k =  1     LamdaQ =   0.5237
k =  2     LamdaQ =   0.1851
k =  3     LamdaQ =  -0.0631
Example 7.7
For a small four-node network (see Figure 7.11), assume that node voltages area 1.0 
pu. Solve the minimum loss problem where control variables are PG1, PG2, PG3, ⎪t⎪ 
and τ. The equality constraints are the real power balances at each node.
Let us write the augmented Lagrangian to minimize the system’s losses and to 
satisfy the real power balance at each node. First, let us solve the problem of keeping 
Figure 7.10  Three node system load flows for a minimum cost solution. 

7.6	
Optimal Operation, Transmission Losses Included
231
constant values for ⎪t⎪ and τ. Voltage and reactive power flows are not included, 
assuming voltages are fixed at 1.0 pu and that there are no problems with the reac-
tive power flows. Results are shown in Figure 7.12.
z = PG1 + PG2 + PG3 −PD + l1L p12 + p13 −PG1 + PD1
(
) + l2L p21 + p24 −PG2 + PD2
(
)
+l3L p31 + p34 −PG3 + PD3
(
) + l4L p42 + p43 + PD4
(
)
	 (7.56)
Elements =    4
Nodes    =    4
Elements (duplicated)
Elem  N_from   N_to   type   tap      tau           yelem           Bsh/2
  1    1       2     -1     1.05     0.09      1.0000 +j-10.0000   +j  0.0000
  2    1       3      1     1.00     0.00      1.0000 +j-10.0000   +j  0.0000
  3    3       4      1     1.00     0.00      1.5000 +j-15.0000   +j  0.0000
  4    2       4      1     1.00     0.00      2.0000 +j-20.0000   +j  0.0000
  5    2       1     -1     1.05     0.09      1.0000 +j-10.0000   +j  0.0000
  6    3       1      1     1.00     0.00      1.0000 +j-10.0000   +j  0.0000
  7    4       3      1     1.00     0.00      1.5000 +j-15.0000   +j  0.0000
  8    4       2      1     1.00     0.00      2.0000 +j-20.0000   +j  0.0000
Figure 7.11  Four-node system load flows for optimal solution. 
Table 7.1  Line Data System on Figure 7.11
Element
N from − k
N to − m
ykm
tap
1
1
2
1.0 − j10
−1
2
1
3
1.0 − j10
tα + jtβ
3
3
4
1.5 − j15
−1
4
2
4
2.0 − j20
−1

232
Optimal Operation of Power Systems
Node Information
Node   type    Voltage     Angle       Pgen      Pload     Qgen      Qload
  1      0     1.0000      0.0000      0.00      0.30      0.00      0.00
  2      1     1.0000      0.0000      0.00      0.40      0.00      0.00
  3      1     1.0000      0.0000      0.00      0.20      0.00      0.00
  4     -1     1.0000      0.0000      0.00      0.50      0.00      0.00
Node Type Generation =    3  Load =   1
Iteration =      0     Maxdev = 1.361140e+000
Iteration =      1     Maxdev = 3.950764e-003
Iteration =      2     Maxdev = 6.617341e-009
Node Information
Node    type   Voltage    Angle    Pgen    Pload    Qgen     Qload      Lamda
 1      0     1.0000     0.00    0.3533   0.3000   0.5327  -0.0000     1.0000
 2      1     1.0000     3.47    0.6369   0.4000  -0.5168   0.0000     1.0000
 3      1     1.0000     1.60    0.4155   0.2000  -0.0174   0.0000     1.0000
 4     -1     1.0000     1.85    0.0000   0.5000   0.0000  -0.0582     1.0029
Power flows
Elem   N_from    N_to    typeel   tap       tau       pkm        qkm
  1      1         2       -1     1.05      5.00      0.3328     0.5007
  2      1         3        1     1.00      0.00     -0.2795     0.0319
  3      3         4        1     1.00      0.00     -0.0648     0.0066
  4      2         4        1     1.00      0.00      0.5665    -0.0486
  5      2         1       -1     1.05      5.00     -0.3295    -0.4683
  6      3         1        1     1.00      0.00      0.2803    -0.0241
  7      4         3        1     1.00      0.00      0.0649    -0.0063
  8      4         2        1     1.00      0.00     -0.5649     0.0646
PLtot =   0.0057   QLtot =   0.0566
The iterative solution for automatic adjustment on ⎪t⎪ follows, keeping constant τ.
Transformers =    1
Node Type
Generation =    3  Load =   1
Iteration =      0     Maxdev = 1.061140e+000
Iteration =      1     Maxdev = 3.166379e-002
Iteration =      2     Maxdev = 3.341148e-005
Iteration =      3     Maxdev = 3.458872e-011
Node Information
Node   type   Voltage   Angle     Pgen      Pload     Qgen     Qload   Lamda
  1     0     1.0000    -0.00     0.3004    0.3000    0.0038   0.0000  1.0000
  2     1     1.0000     3.42     0.6873    0.4000   -0.0131   0.0000  1.0000
  3     1     1.0000     1.58     0.4155    0.2000   -0.0176   0.0000  1.0000
  4    -1     1.0000     1.81     0.0000    0.5000    0.0000  -0.0581  1.0029

7.7	
Hydrothermal Power System Coordination
233
Power flows (from an to)
Elem   N_from    N_to    typeel     tap       tau       pkm        qkm
  1      1         2       -1     0.9996      5.00      0.2757    -0.0276
  2      1         3        1     1.0000      0.00     -0.2753     0.0314
  3      3         4        1     1.0000      0.00     -0.0606     0.0062
  4      2         4        1     1.0000      0.00      0.5622    -0.0483
  5      2         1       -1     0.9996      5.00     -0.2749     0.0352
  6      3         1        1     1.0000      0.00      0.2761    -0.0238
  7      4         3        1     1.0000      0.00      0.0606    -0.0059
  8      4         2        1     1.0000      0.00     -0.5606     0.0640
PLtot =   0.0031   QLtot =   0.0312
Real power losses decrease from 0.0057 to 0.0031 when we compared to the previ-
ous solution where the tap is fixed.
7.7	
Hydrothermal Power System Coordination
One more component to control and operate a power system is to include (besides 
thermal power plants) hydrogeneration, geothermal, wind, or some other generation 
resources that represent energy contribution at those instances where its primary 
energy is available. The volume of water that can be generated with a hydroplant 
might be limited, and we may be required to use it within a given period. The prob-
lem is called hydrothermal coordination, and can solved in the following steps:
• Minimize the total operating cost for the hydrothermal system.
• Write the augmented Lagrangian function. The necessary condition to attain 
the optimum, assuming convexity, is that its gradient should be zero.
Figure 7.12  Four-node system load flows. 

234
Optimal Operation of Power Systems
• In general, the gradient will be a nonlinear set of equations. To solve the 
problem, we apply Newton’s method.
7.7.1	
Objective Function and Constraints
To grasp the details that go into the formulation of the problem, let us use a simple 
two-power plant problem: one thermal and one hydro. The objective is to minimize 
the cost of the fuel used by the thermal plant within the optimization period [0, Tf] 
(see Figures 7.13 and 7.14). An input-output cost function is used for the thermal 
plant, $/h is the input and the output is the net power PT to the network. For the 
hydroplant, we assume that a water volume per hour is the available input and net 
power, and that PH is the output.
The equality constraints include:
• Load to be supplied and power transmission losses for each time period tk.
• An equality constraint that considers the total volume of water available to 
be used by the hydrogenerator within the optimization period [0, Tf].
	
min
C PT
k
(
)tk
k=1
Tf
∑
subject to
 PD
k + PL
k −PH
k −PT
k = 0
q PH
k,hk
(
)tk −b
k=1
Tf
∑
= 0
	
(7.57)
b	
volume available
C PT
k
(
) 	
Cost function for thermal generation plant
Pk
T	
Net power output form thermal plant at time tk
Pk
H	
Net power output from hydroplant at time tk
Figure 7.13  Stepwise demands for period [0, Tf]. 

7.7	
Hydrothermal Power System Coordination
235
Pk
L	
Electrical power losses at time interval tk
Pk
D	
Electrical power demand at time interval tk
tk	
Time interval k
Tf	
Final time for the optimization period
The augmented Lagrangian follows as (7.58). The solution must be the gradient 
equal to zero at each discrete interval partition tk for the study period.
z =
C PT
k
(
)tk + lP
k PD
k + PL
k −PT
k −PH
k
(
)tk
⎡⎣
⎤⎦
k=1
Tf
∑
+ lh
q PH
k,hk
(
)tk −b
k=1
Tf
∑
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(7.58)
	
∇z =
∂z
∂PT
k
∂z
∂PH
k
∂z
∂lP
k
…
∂z
∂lh
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
∂C PT
k
(
)
∂PT
k
tk + λP
k ∂PL
k
∂PT
k −1
⎛
⎝⎜
⎞
⎠⎟tk
lP
k
∂PL
k
∂PH
k −1
⎛
⎝⎜
⎞
⎠⎟tk + lh
∂q PH
k,hk
(
)
∂PH
k
tk
PD
k + PL
k −PT
k −PH
k
(
)tk
...
q PH
k,hk
(
)tk −b
k=1
Tf
∑
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
0
0
0
…
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
	
(7.59)
From the first row in the gradient, we find the short-term marginal cost λk
P at the 
node of the thermal plant, penalized by an incremental loss factor. From the second 
row, λh is the value of water. This expression, combined with the incremental water 
flow, gives an equivalent incremental cost for the hydropower plant.
	
lP
k =
∂C PT
k
(
)
∂PT
k
1 −∂PL
k
∂PT
k
⎛
⎝⎜
⎞
⎠⎟
−1
	
(7.60)
	
lP
k = lh
∂q PH
k,hk
(
)
∂PH
k
1 −∂PL
k
∂PH
k
⎛
⎝⎜
⎞
⎠⎟
−1
	
(7.61)
Figure 7.14  Coordination of two power plants, thermal and hydro. 

236
Optimal Operation of Power Systems
Where
∂PL
k/ ∂PT
k 	
Incremental losses for thermal plant
∂q PH
k,hk
(
)/ ∂PH
k 	
Incremental flow for hydroplant, Mgal/MW
λh	
Value of water, $/Mgal
lh ∂q PH
k,hk
(
)/ ∂PH
k
(
) 	
Equivalent incremental cost for the hydroplant, $/
MW
At each electrical node, the power balance constraint appears as a gradient com-
ponent. The last gradient element from (7.59) represents the total amount of water 
available within the time interval [0, Tf] for the optimization process.
	
q PH
1 ,h1
(
)t1 + q PH
2,h2
(
)t2 + … + q PH
Tf ,h
Tf
(
)tTf −b = 0 	
(7.62)
We use (7.59) and solve for each time interval tk. The solution to (7.62) covers the 
optimization period T, and it is assured through (7.62).
Example 7.8
Given a cost function for a thermal generator, the amount of water q discharged 
through the hydraulic turbine, and an expression for electrical losses, the total oper-
ating cost must be minimized. The load to be supplied is 450 MW during a period 
of 10 hours (see Figure 7.15). Solve and point out the economic interpretation for 
the solution when the total amount of water available is b = 1,000 MPC.
	
C PT
(
) = 2.7PT + 0.003 PT
(
)
2
q PH
(
) = 8.568 + 0.216PH
PL PT ,PH
(
) = 0.4 × 10−4 PT
(
)
2 + 1.43 × 10−4 PH
(
)
2
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(7.63)
Where:
C (PT)	
Thermal plant cost in $/h
q (PH)	
Water discharge, MCF/h
PL (PT, PH)	 Power losses, MW
Figure 7.15  Demand required from the two power plants. 

7.7	
Hydrothermal Power System Coordination
237
The augmented Lagrangian includes the cost function, power balance, and the 
available water volume as equality constraints. The gradient for one time interval 
of t1 = 10 hours is a nonlinear set of equations that are solved by Newton’s itera-
tive process.
	
z = C PT
1
(
)t1 + lP
1 PD
1 + PL
1 −PT
1 −PH
1
(
)t1 + lh q PH
1 ,h1
(
)t1 −b
(
) 	
(7.64)
	
∇z =
∂z
∂PT
1
∂z
∂PH
1
∂z
∂lP
1
∂z
∂lh
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
∂C PT
1
(
)
∂PT
1
t1 + lP
1
∂PL
1
∂PT
1 −1
⎛
⎝⎜
⎞
⎠⎟t1
lP
1
∂PL
1
∂PH
1 −1
⎛
⎝⎜
⎞
⎠⎟t1 + lh
∂q PH
1 ,h1
(
)
∂PH
1
t1
PD
1 + PL
1 −PT
1 −PH
1
(
)t1
q PH
1 ,h1
(
)t1 −b
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
0
0
0
0
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(7.65)
	
dC PT
1
(
)
dPT
1
= 2.7 + 0.006PT
1  $/MWh
∂PL
1
∂PT
1 = 0.8 × 10−4PT
1  pu
∂PL
1
∂PH
1 = 2.86 × 10−4PH
1   pu
∂q PH
1
(
)
∂PH
1
= 0.216  MCF/MW
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(7.66)
Using partial derivatives (7.66), the elements of the gradient are in (7.67). To 
start the iterative process, initial proposed values might be about half the total 
demand. For the Lagrange multipliers, a value of 2 is selected: [PT  PH  λP  λH] = 
[250  250  2  2].
∇z =
g1
g2
g3
g4
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
2.7 + 0.006PT
1
(
)t1 + lP
1 0.8 × 10−4PT
1 −1
(
)t1
lP
1 2.86 × 10−4PH
1 −1
(
)t1 + lh(0.216)t1
450 + 0.4 × 10−4 PT
1
(
)
2 + 1.43 × 10−4 PH
1
(
)
2 −PT
1 −PH
1
(
)t1
8.568 + 0.216PH
1
(
)t1 −1,000
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
0
0
0
0
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
 

(7.67)
The Hessian matrix of second-order partial derivatives has elements that change 
at each iteration:

238
Optimal Operation of Power Systems
0.006 + lP
10.8 × 10−4
(
)t1
0
0.8 × 10−4PT
1 −1
(
)t1
0
0
lP
12.86 × 10−4t1
2.86 × 10−4PH
1 −1
(
)t1 0.216t1
0.8 × 10−4PT
1 −1
(
)t1
2.86 × 10−4PH
1 −1
(
)t1
0
0
0
0.216t1
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
ΔPT
1
ΔPH
1
ΔlP
1
Δlh
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
= −
g1
g2
g3
g4
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
 

(7.68)
Hydro-Thermal Coordination
Total demand 450.00   time period  10.00 hours
Initial values PT = 225.00  PH = 225.00  lamdaP =   2.0000  lamdaH =   2.0000
Converged Solution   Iteration =    3   Maxdev    = 1.494413e-009
Power         52.44 MW thermal plant    423.30 MW hydro plant
Total Power  475.73 MW
Power Losses  25.73 MW
ILossesT       0.0042 pu   ILossesH   0.1211 pu
LamdaP      3.0273 $/MWh   Lamda_h   12.3186 $/MCF (water equivalent cost)
ICostTer    3.0146 $/MWh   Penalty    1.0042 pu   PenalizedCost  3.0273 $/MWh
ICostHyd    2.6608 $/MWh   Penalty    1.1377 pu   PenalizedCost  3.0273 $/MWh
TotCost     1498.27 $   Water Used   1000.00 MCF
The solution shown in Figures 7.16 and 7.17 and units for the calculated results are:
l = ∂C
∂PT
1 = 3.0146 $/MWh
∂PL
1
∂PT
1 = 0.004195 pu
dC
dPT
1 1 −∂PL
1
∂PT
1
⎛
⎝⎜
⎞
⎠⎟
−1
= 3.2073 $/MWh
   
PD
1 = 450 MW
lP
1 = 3.0273 $/MWh
λh = 12.3186 $/MPC
λh
∂q
∂PH
1 = 2.66082 $/MWh
∂PL
1
∂PH
1 = 0.121063 pu
λh
∂q
∂PH
1
1 −∂PL
1
∂PH
1
⎛
⎝⎜
⎞
⎠⎟
−1
= 3.2073 $/MWh
Figure 7.16  Coordinated solution to supply demand by a thermal and a hydro-plant. 

7.7	
Hydrothermal Power System Coordination
239
The numerical solution shows an operating point at the same incremental cost for 
the thermal plant the penalized incremental cost as well as the penalized equivalent 
incremental cost for the hydroplant.
Example 7.9
For a thermal equivalent, the water discharge for the hydraulic plant, losses, and a 
load demand as shown by (7.70), minimize the total operating cost when the amount 
of available water is b = 1,000 MPC.
The problem is similar to Example 7.8. However, we now extend the study time 
to various periods and coordinate for two periods, t1 = 10 hours and t2 = 14 hours 
(see Figure 7.18). The augmented Lagrangian has to include the cost function and 
the power balance equalities for periods one and two. The Lagrangian function 
must include an equality constraint to coordinate the water usage at each period, 
and must also comply with the constraint of total water available.
z = C PT
1
(
)t1 + lP
1 PD
1 + PL
1 −PT
1 −PH
1
(
)t1 + C PT
2
(
)t2 + lP
2 PD
2 + PL
2 −PT
2 −PH
2
(
)t2
+lh q PH
1 ,h1
(
)t1 + q PH
2,h2
(
)t2 −b
⎡⎣
⎤⎦
	
(7.69)
The thermal cost, water discharge function, and losses are:
	
C PT
(
) = 2.7PT + 0.003 PT
(
)
2   $/h
q PH
(
) = 8.568 + 0.216PH   MCF/h
PL PT ,PH
(
) = 0.4 × 10−4 PT
(
)
2 + 1.43 × 10−4 PH
(
)
2   MW
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(7.70)
Figure 7.17  Generation blocks for the hydro and the thermal, demand, and losses. 
Figure 7.18  Load demand for time changing values. 

240
Optimal Operation of Power Systems
The augmented Lagrangian (7.69) includes unknowns for each time periods t1 and 
t2 and one water equation to coordinate the total use of water within the whole 
time period.
	
∇z =
∂z
∂PT
1
∂z
∂PH
1
∂z
∂lP
1
∂z
∂PT
2
∂z
∂PH
2
∂z
∂lP
2
∂z
∂lh
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
∂C PT
1
(
)
∂PT
1
t1 + lP
1
∂PL
1
∂PT
1 −1
⎛
⎝⎜
⎞
⎠⎟t1
lP
1
∂PL
1
∂PH
1 −1
⎛
⎝⎜
⎞
⎠⎟t1 + lh
∂q PH
1 ,h1
(
)
∂PH
1
t1
PD
1 + PL
1 −PT
1 −PH
1
(
)t1
∂C PT
2
(
)
∂PT
2
t2 + lP
2 ∂PL
2
∂PT
2 −1
⎛
⎝⎜
⎞
⎠⎟t2
lP
2
∂PL
2
∂PH
2 −1
⎛
⎝⎜
⎞
⎠⎟t2 + lh
∂q PH
2,h2
(
)
∂PH
2
t2
PD
2 + PL
2 −PT
2 −PH
2
(
)t2
q PH
1 ,h1
(
)t1 + q PH
2,h2
(
)t2 −b
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
0
0
0
0
0
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(7.71)
∇z =
g1
g2
g3
g4
g5
g6
g7
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
2.7 + 0.006PT
1
(
)t1 + lP
1 0.8 × 10−4PT
1 −1
(
)t1
lP
1 2.86 × 10−4PH
1 −1
(
)t1 + lh 0.216
(
)t1
450 + 0.4 × 10−4 PT
1
(
)
2 + 1.43 × 10−4 PH
1
(
)
2 −PT
1 −PH
1
(
)t1
2.7 + 0.006PT
2
(
)t2 + lP
2 0.8 × 10−4PT
2 −1
(
)t2
lP
2 2.86 × 10−4PH
2 −1
(
)t2 + lh 0.216
(
)t2
650 + 0.4 × 10−4 PT
2
(
)
2 + 1.43 × 10−4 PH
2
(
)
2 −PT
2 −PH
2
(
)t2
8.568 + 0.216PH
1
(
)t1 + 8.568 + 0.216PH
2
(
)t2 −1,000
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
0
0
0
0
0
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
 

(7.72)
Initial values to start the iterative process [PT1  PH1  λP1  PT2  PH2  λP2  λH] = 
[225  225  2  325  325  2  2]. The solution is shown in Figure 7.19.
Hydro-Thermal Coordination
Total demand 450.00   time period  10.00 hours
Total demand 650.00   time period  14.00 hours
Initial values PT1 = 225.00  PH1 = 225.00  lamdaP1 = 2.0000
Initial values PT2 = 325.00  PH2 = 325.00  lamdaP2 = 2.0000  lamdaH = 2.0000
Converged Solution   Iterations =    3   Maxdev = 8.535247e-007

7.7	
Hydrothermal Power System Coordination
241
First interval
Power        401.35 MW thermal plant
Power         55.54 MW hydro plant
Total Power  456.88 MW
Power Losses   6.88 MW
ILossesT  0.0321 pu      ILossesH    0.0159 pu
LamdaP    5.2775 $/MWh   Lamda_h    24.0449 $/MCF (water equivalent cost)
ICostTer  5.1081 $/MWh   Penalty F   1.0332 pu   PenalizedCost   5.2775 $/MWh
ICostHyd  5.1937 $/MWh   Penalty F   1.0161 pu   PenalizedCost   5.2775 $/MWh
Second interval
Power        441.91 MW thermal plant
Power        223.02 MW hydro plant
Total Power  664.92 MW
Power Losses  14.92 MW
ILossesT  0.0354 pu      ILossesH    0.0638 pu
LamdaP    5.5475 $/MWh   Lamda_h    24.0449 $/MCF (water equivalent cost)
ICostTer  5.3514 $/MWh   Penalty F   1.0366 pu   PenalizedCost   5.5475 $/MWh
ICostHyd  5.1937 $/MWh   Penalty F   1.0681 pu   PenalizedCost   5.5475 $/MWh
TotCost    40574.54 $   Water Used   1000.00 MCF
Other interesting problems include coordination between thermal plants and mul-
tiple energy resources (i.e., water resources, solar, and wind contribution to the 
energy balance). In some cases, the water volume equation is an equality constraint 
that establishes the amount of energy available instead of volume. Other types of 
power plants with available energy and of course hydroplants that have a cascade 
configuration can be included. The cascaded case means that water is used to gener-
ate more than once the hydronetwork might be quite involved and the water time 
travel between hydroplants could be important and must be included in the model.
Figure 7.19  Hydro and thermal generation to supply demand and losses. 

242
Optimal Operation of Power Systems
Variations in a general coordination problem require quite of bit of details to 
include both equality constraints and inequality constraints. Such material is part 
of a specialized optimal power system study needed in the planning and operating 
areas where we face a complex mix of energy power resources with constant output 
as nuclear and big thermal plants or intermittent contribution as wind and solar.
7.8	
Second-Order Derivatives
The partial second-order derivatives for real and reactive power flows are crucial to 
the proper solution implementation of the optimal power flow as seen in Sections 7.6 
and 7.7. The power flows might be through a complex transformer or in transmis-
sion lines. The partial derivatives are with respect to state variables, nodal angles, 
and voltage magnitudes. For a transformer with complex tap, partial derivatives 
include tap magnitude and the phase-shifting angle.
pkm = + Vk
2 t
2 gkm −Vk Vm t gkm cos qk −qm + t
(
) −Vk Vm t bkm sin qk −qm + t
(
)	 (7.73)
qkm = −Vk
2 t
2 bkm −Vk Vm t gkm sin qk −qm + t
(
) + Vk Vm t bkm cos qk −qm + t
(
) 	 (7.74)
The partial second-order derivatives required for pkm and qkm take advantage of the 
symmetric nature of the following array where 36 expressions are in (7.75). How-
ever, due to the symmetric nature of the results, we will only show 21 expressions.
	
qk
2
qkqm
qkt
qk Vk
qk Vm
qk t
qmqk
qm
2
qmt
qm Vk
qm Vm
qm t
tqk
tqm
t2
t Vk
t Vm
t t
Vk qk
Vk qm
Vk t
Vk
2
Vk Vm
Vk t
Vm qk
Vm qm
Vm t
Vm Vk
Vm
2
Vm t
t qk
t qm
t t
t Vk
t Vm
t
2
	
(7.75)
For a complex transformer, the partial derivatives of real power pkm, starting with 
partial first-order derivatives from (6.29) to (6.34) are
	
∂2pkm
∂qk
2
= −∂qkm
∂qk
= + Vk
2 t
2 gkm −pkm 	
(7.76)
	
∂2pkm
∂qk ∂qm
= + ∂qkm
∂qk
= −Vk
2 t
2 gkm + pkm 	
(7.77)
	
∂2pkm
∂qk ∂t = −∂qkm
∂qk
= + Vk
2 t
2 gkm −pkm 	
(7.78)

7.8	
Second-Order Derivatives
243
	
∂2pkm
∂qk ∂Vk
Vk = −Vk
2 t
2 bkm −qkm 	
(7.79)
	
∂2pkm
∂qk ∂Vm
Vm = −Vk
2 t
2 bkm −qkm 	
(7.80)
	
∂2pkm
∂qk ∂t t = −Vk
2 t
2 bkm −qkm 	
(7.81)
	
∂2pkm
∂qm
2
= + ∂qkm
∂qm
= + Vk
2 t
2 gkm −pkm 	
(7.82)
	
∂2pkm
∂qm ∂t = −∂qkm
∂qm
= −Vk
2 t
2 gkm + pkm 	
(7.83)
	
∂2pkm
∂qm ∂Vk
Vk = + Vk
2 t
2 bkm + qkm 	
(7.84)
	
∂2pkm
∂qm ∂Vm
Vm = + Vk
2 t
2 bkm + qkm 	
(7.85)
	
∂2pkm
∂qm ∂t t = + Vk
2 t
2 bkm + qkm 	
(7.86)
	
∂2pkm
∂t2
= −∂qkm
∂t
= + Vk
2 t
2 gkm −pkm 	
(7.87)
	
∂2pkm
∂t ∂Vk
Vk = −Vk
2 t
2 bkm −qkm 	
(7.88)
	
∂2pkm
∂t ∂Vm
Vm = −Vk
2 t
2 bkm −qkm 	
(7.89)
	
∂2pkm
∂t ∂t t = −Vk
2 t
2 bkm −qkm 	
(7.90)
	
∂2pkm
∂Vk
2 Vk
2 = 2 Vk
2 t
2 gkm 	
(7.91)

244
Optimal Operation of Power Systems
	
∂2pkm
∂Vk ∂Vm
Vm Vk = −Vk
2 t
2 gkm + pkm 	
(7.92)
	
∂2pkm
∂Vk ∂t t Vk = +3Vk
2 t
2 gkm + pkm 	
(7.93)
	
∂2pkm
∂Vm
2 Vm
2 = 0 	
(7.94)
	
∂2pkm
∂Vm ∂t t Vm = −Vk
2 t
2 gkm + pkm 	
(7.95)
	
∂2pkm
∂t
2
t
2 = 2 Vk
2 t
2 gkm 	
(7.96)
For a complex power transformer, the partial derivatives of reactive power qkm 
starting from (6.36) to (6.41) are
	
∂2qkm
∂qk
2
= ∂pkm
∂qk
= −Vk
2 t
2 bkm −qkm 	
(7.97)
	
∂2qkm
∂qk ∂qm
= −∂pkm
∂qk
= + Vk
2 t
2 bkm + qkm 	
(7.98)
	
∂2qkm
∂qk ∂t = ∂pkm
∂qk
= −Vk
2 t
2 bkm −qkm 	
(7.99)
	
∂2qkm
∂qk ∂Vk
Vk = −Vk
2 t
2 gkm + pkm 	
(7.100)
	
∂2qkm
∂qk ∂Vm
Vm = −Vk
2 t
2 gkm + pkm 	
(7.101)
	
∂2qkm
∂qk ∂t t = −Vk
2 t
2 gkm + pkm 	
(7.102)
	
∂2qkm
∂qm
2
= −∂pkm
∂qm
= −Vk
2 t
2 bkm −qkm 	
(7.103)

7.8	
Second-Order Derivatives
245
	
∂2qkm
∂qm ∂t = ∂pkm
∂qm
= + Vk
2 t
2 bkm + qkm 	
(7.104)
	
∂2qkm
∂qm ∂Vk
Vk = + Vk
2 t
2 gkm −pkm 	
(7.105)
	
∂2qkm
∂qm ∂Vm
Vm = + Vk
2 t
2 gkm −pkm 	
(7.106)
	
∂2qkm
∂qm ∂t = 1
t
∂qkm
∂qm
= + Vk
2 t
2 gkm −pkm
t
	
(7.107)
	
∂2qkm
∂t2
= ∂pkm
∂t
= −Vk
2 t
2 bkm −qkm 	
(7.108)
	
∂2qkm
∂t ∂Vk
Vk = −Vk
2 t
2 gkm + pkm 	
(7.109)
	
∂2qkm
∂t ∂Vm
Vm = −Vk
2 t
2 gkm + pkm 	
(7.110)
	
∂2qkm
∂t ∂t t = −Vk
2 t
2 gkm + pkm 	
(7.111)
	
∂2qkm
∂Vk
2 Vk
2 = −2 Vk
2 t
2 bkm 	
(7.112)
	
∂2qkm
∂Vk ∂Vm
Vk Vm = + Vk
2 t
2 bkm + qkm 	
(7.113)
	
∂2qkm
∂Vk t Vk t = −3Vk
2 t
2 bkm + qkm 	
(7.114)
	
∂2qkm
∂Vm
2 Vm
2 = 0 	
(7.115)
	
∂2qkm
∂Vm ∂t Vm t = + Vk
2 t
2 bkm + qkm 	
(7.116)

246
Optimal Operation of Power Systems
	
∂2qkm
∂t
2
t
2 = −2 Vk
2 t
2 bkm 	
(7.117)
For partial derivatives of second-order in a transmission line (see Figure 7.20), the 
real and reactive power flows show that compared with the complex transformer 
equations ⎪t⎪ = 1 and τ = 0. Instead, the charging susceptance Bsh2 must be included 
in the reactive power flow. The reduced array (7.118) shows that by symmetry only 
ten expressions are required.
	
qk
2
qkqm
qk Vk
qk Vm
qmqk
qm
2
qm Vk
qm Vm
Vk qk
Vk qm
Vk
2
Vk Vm
Vm qk
Vm qm
Vm Vk
Vm
2
	
(7.118)
	
pkm = Vk
2 gkm −Vk Vm gkm cosqkm −Vk Vm bkm sinqkm 	
(7.119)
	
qkm = −Vk
2 bkm + Bsh/2
(
) −Vk Vm gkm sinqkm + Vk Vm bkm cosqkm 	 (7.120)
The partial second-order derivatives for real power pkm from (6.67) to (6.70):
	
∂2pkm
∂qk
2
= −∂qkm
∂qk
= + !Vk
2 gkm −pkm 	
(7.121)
	
∂2pkm
∂qk ∂qm
= + ∂qkm
∂qk
= −!Vk
2 gkm + pkm 	
(7.122)
	
∂2pkm
∂qk ∂!Vk
!Vk = −!Vk
2 bkm + Bsh/2
(
) −qkm 	
(7.123)
Figure 7.20  Transmission line π model. 

7.8	
Second-Order Derivatives
247
	
∂2pkm
∂qk ∂!Vm
!Vm = −!Vk
2 bkm + Bsh/2
(
) −qkm 	
(7.124)
∂2pkm
∂qm
2
=
∂
∂qm
+ !Vk
2 bkm + Bsh/2
(
) + qkm
⎡
⎣⎢
⎤
⎦⎥= ∂qkm
∂qm
= + !Vk
2 gkm −pkm 	
(7.125)
	
∂2pkm
∂qm ∂!Vk
!Vk = + !Vk
2 bkm + Bsh/2
(
) + qkm 	
(7.126)
	
∂2pkm
∂qm ∂!Vm
!Vm = + !Vk
2 bkm + Bsh/2
(
) + qkm 	
(7.127)
	
∂2pkm
∂!Vk
2 !Vk
2 = 2 !Vk
2 gkm 	
(7.128)
	
∂2pkm
∂!Vk ∂!Vm
!Vm !Vk = −!Vk
2 gkm + pkm 	
(7.129)
	
∂2pkm
∂!Vm
2 !Vm
2 = 0 	
(7.130)
The partial second-order derivatives for the reactive power qkm from (6.72) to (6.75) 
are:
	
∂2qkm
∂qk
2
=
∂
∂qk
−!Vk
2 gkm + pkm
⎡
⎣⎢
⎤
⎦⎥= ∂pkm
∂qk
= −!Vk
2 bkm + Bsh/2
(
) −qkm 	(7.131)
∂2qkm
∂qk ∂qm
=
∂
∂qk
+ !Vk
2 gkm −pkm
⎡
⎣⎢
⎤
⎦⎥= −∂pkm
∂qk
= + !Vk
2 bkm + Bsh/2
(
) + qkm 	
(7.132)
	
∂2qkm
∂qk ∂!Vk
!Vk = −!Vk
2 gkm + pkm 	
(7.133)
	
∂2qkm
∂qk ∂!Vm
!Vm = −!Vk
2 gkm + pkm 	
(7.134)
∂2qkm
∂qm
2
=
∂
∂qm
+ !Vk
2 gkm −pkm
⎡
⎣⎢
⎤
⎦⎥= −∂pkm
∂qm
= −!Vk
2 bkm + Bsh/2
(
) −qkm 	
(7.135)

248
Optimal Operation of Power Systems
	
∂2qkm
∂qm ∂!Vk
!Vk = + !Vk
2 gkm −pkm 	
(7.136)
	
∂2qkm
∂θm ∂%Vm
%Vm = + %Vk
2 gkm −pkm 	
(7.137)
	
∂2qkm
∂%Vk
2
%Vk
2 = −2 %Vk
2 (bkm + Bsh/2)	
(7.138)
	
∂2qkm
∂%Vk ∂%Vm
%Vk
%Vm = + %Vk
2 (bkm + Bsh/2) +qkm 	
(7.139)
	
∂2qkm
∂%Vm
2
%Vm
2 = 0
	
(7.140)
References
[1]	
El-Hawary, M. E., and G. S. Christensen, Optimal Operation of Electric Power Systems, 
New York: Academic Press, 1979.

249
C h a p t e r  8
Real and Reactive Power and Frequency 
Control
8.1	
Introduction
The electrical power system continually experiences changes in its daily operating 
conditions. A load evolves and is determined by the daily use of electrical energy by 
industries, households, offices, and services. The changing load pattern requires the 
commitment of enough generating units in order to satisfy the required power and 
energy usage. Also, some units must be synchronized in order to have an appropri-
ate operating reserve. The power reserve is determined based on the amount of load 
and the nature of the electric system, and also because generating units need to be 
prepared to respond to situations such as possible outages, faults, and line tripping.
One indication that the system meets the real power requirements at every instant 
is the system’s frequency, deviations from a nominal value, and how steep its change 
gives an indication about the severity of an unmatched power within the system. By 
appropriate and coordinated control actions in the system, the relief of overloaded 
elements is accomplished and the voltage profile is kept within prescribed bounds. 
Control actions are changes in real power injections by generators, phase-shifting 
by transformers, and tap changing and reactive VARs by compensating devices. 
To these now-basic controls, electrical power systems have devices based on power 
electronics that handle energy in a way that its time response is very fast. Flexible 
AC transmission systems (FACTS) will be briefly discussed in Sections 8.7–8.10.
As important as it is to match the system’s load by the appropriate amount of 
generation and its regulating control characteristics, it is equally important to be 
able to control the voltage at every electrical node in the system within prescribed 
limits. The variables that are intrinsically related are nodal voltages and reactive 
power flows, and the problem is posed as one of reactive power requirements and 
the supply of reactive power by different sources, such as generators, line charging 
susceptance, and compensating devices, such as capacitors, reactors, and static VAR 
compensators (SVCs). Reactive power does not carry out useful work. Therefore, the 
reactive power should not travel within the network; it has consequences on power 
losses, transmission overloading, and the deterioration of voltage outside specified 
quality range. An excess of reactive power, related to high-capacitive effects, increases 
the nodal voltages, whereas a lack of reactive power associated with a dominant 
inductive nature in the network degrades the voltage values.

250
Real and Reactive Power and Frequency Control
A clear understanding of the control problems of real power flow and the 
reactive power (voltage) must be established. Appropriate model for transformers, 
transmission lines, synchronous generators, and reactive power compensating equip-
ment is a must for operation and control of any electrical system—especially for 
weak longitudinal power systems. Planning activities require an integral solution to 
this type of control problem so that a comprehensive steady state control solution 
is advisable. This task is required for system’s operation as well, and we can apply 
concepts already discussed in Chapters 6 and 7 in a systematic way.
8.2	
Control of Real Power Flows
We start this section with a model for an ideal (no losses) power transformer with 
complex tap (shown in Figure 8.1). A detailed presentation of incremental equations 
for real power flow in a transformer and a set of approximations were already derived 
in Chapter 6 as (6.99)–(6.107). From the incremental real power flow equation, 
we recognize an Ohm’s equivalent circuit as in (8.1) (see Figure 8.2); the purpose 
of this is to have a circuit model that can be applied to each element in a network. 
With this procedure, we are able to build a straightforward relation between control 
settings and changes, as well as their influence on network variables (nodal angles 
and voltage magnitudes).
In Section 8.5, we will take a more general approach and include a coordinated 
effort of available controls to achieve what we might call minimum control actions.
	
−xkm
Δpkm
Vk
+ Δqk −Δqm = −Δt 	
(8.1)
For the real power flow problem, (8.1) will be applied to each network element 
that has a phase shifter for a transmission line Δτ = 0. To completely solve the net-
work, we must write the algebraic sum of real power at each node. This step gives 
complementary equations that allow us to build a consistent set of equations. The 
set is solved for incremental angles (rad) and incremental real power flows through 
the represented transmission lines and transformers, given the incremental power 
by sources and the incremental phase shifting angle control in transformers. One 
Figure 8.1  Power transformer with complex tap.

8.2	
Control of Real Power Flows
251
node angle is set as reference. The next question is: how can we coordinate the effort 
of various available controls so that a real power congestion problem is solved in 
our network?
Example 8.1
Assuming a network of Figure 8.3 and using data in Table 8.1, write the model for 
each transmission element and complement with one balance equation for each node 
and solve the system of equations. Show the sensitivity matrix.
Equation (8.1) is applied to each transmission element and four nodal power bal-
ances are added.
Figure 8.2  Equivalent circuit for the incremental real power flow, complex transformer. 
Figure 8.3  Network for the real power control.
Table 8.1  Data for Example 8.1 ⎪t⎪∠τ = tα + jtβ = 1.05∠5°
Element
Nsal − k
Nlleg − m
ykm pu
tap
ybsh/2
1
1
2
1.0 − j10
−1
0
2
1
3
1.0 − j10
tα + jtβ
0
3
3
4
1.5 − j15
−1
0
4
2
4
2.0 − j20
−1
0

252
Real and Reactive Power and Frequency Control
	
(1)
−x12
Δp12
V1
+ Δq1 −Δq2 = 0
(2)
−x13
Δp13
V1
+ Δq1 −Δq3 = −Δt
(3)
−x34
Δp34
V3
+ Δq3 −Δq4 = 0
(4)
−x24
Δp24
V2
+ Δq2 −Δq4 = 0
node 1
+Δp12
V1
+ Δp13
V1
= ΔP1
V1
node 2
−Δp12
V1
+ Δp24
V2
= ΔP2
V2
node 3
+Δp34
V2
−Δp13
V1
= ΔP3
V3
node 4
−Δp24
V2
−Δp34
V3
= ΔP4
V4
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(8.2)
The previous equations in matrix form:
	
x12
0
0
0
+1
1
0
0
0
x13
0
0
+
1
0
1
0
0
0
x34
0
0
0
+1
1
0
0
0
x24
0
+1
0
1
+1
+1
0
0
0
0
0
0
1
0
0
+1
0
0
0
0
0
1
+1
0
0
0
0
0
0
0
1
1
0
0
0
0
p12
V1
p13
V1
p34
V2
p24
V3
q1
q2
q3
q4
=
0
t
0
0
P1
V1
P2
V2
P3
V3
P4
V4
	
(8.3)
	
−x A
At
0
⎡
⎣⎢
⎤
⎦⎥
Δp
V
Δq
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥=
−Δt
ΔP
V
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	
(8.4)

8.2	
Control of Real Power Flows
253
x	
Diagonal matrix of element’s reactance
A	
Incidence matrix, information about element’s connectivity 
between nodes
Δp/⎪V⎪	
Vector of incremental power flow in every element
Δτ	
Vector of available phase shifting control in branches
ΔP/⎪V⎪	
Vector of net injection of incremental real power into a node
For the reactance values as read from Table 8.1, the sensitivity matrix is:
-3.1895    3.1895    3.1895   -3.1895    0.0000   -0.6842   -0.3158   -0.5263
 3.1895   -3.1895   -3.1895    3.1895         0   -0.3158   -0.6842   -0.4737
 3.1895   -3.1895   -3.1895    3.1895   -0.0000   -0.3158    0.3158   -0.4737
-3.1895    3.1895    3.1895   -3.1895    0.0000    0.3158   -0.3158   -0.5263
      0         0         0         0    0.0000    0.0000    0.0000    0.0000
-0.6842   -0.3158   -0.3158    0.3158   -0.0000    0.0677    0.0313    0.0521
-0.3158   -0.6842    0.3158   -0.3158    0.0000    0.0313    0.0677    0.0469
-0.5263   -0.4737   -0.4737   -0.5263   -0.0000    0.0521    0.0469    0.0782
For a change in angle control Δτ, it will affect line flows and nodal angles as:
	
p12
V1
p13
V1
p34
V2
p24
V3
q1
q2
q3
q4
=
+3.1895
3.1895
3.1895
+3.1895
0
0.3158
+0.6842
0.4737
(
t)	
(8.5)
The column shows values of sensitivity factors, assuming that we have a phase 
shifting change Δτ in element 2 that connects node 1 to 3. Column 6 of the sensi-
tivity matrix shows factors for a ΔP injection into node two. The sparse nature of 
the coefficient matrix in (8.3) is also shown in the structure in Figure 8.4.
Sensitivity factors, control in element   2
Elem(  1) = +3.189474
Elem(  2) = -3.189474
Elem(  3) = -3.189474
Elem(  4) = +3.189474
node(  1) = +0.000000

254
Real and Reactive Power and Frequency Control
node(  2) = -0.315789
node(  3) = -0.684211
node(  4) = -0.473684
Sensitivity factors, control in node    2
Elem(  1) = -0.684211
Elem(  2) = -0.315789
Elem(  3) = -0.315789
Elem(  4) = +0.315789
node(  1) = +0.000000
node(  2) = +0.067744
node(  3) = +0.031266
node(  4) = +0.052110
For Example 8.1, node one is selected as our angle reference θ1 = 0 radians. The 
matrix inversion for the coefficient array in (8.3) will render column-wise sensitivity 
constants; the sensitivity factors have information about the impact of control actions 
on transmission line real power flows. For example, the second column has the effect 
of an incremental change of the phase shifter, Δτ acting in the second element. For 
this example, we only solve for real power flows. Nodal voltages are assumed to be 
1.0 pu, and we concentrate our attention to the real power flow problem.
A real power system usually has several actions that can be classified as controls. 
These include phase-shifting devices, power injections by generators, and changes in 
Figure 8.4  Sparse nature of the matrix, previous to sensitivity factors calculation.

8.3	
Control of Real Power Flow, Longitudinal Networks
255
load requirements or load shedding schemes, just to mention a few of the controls in 
the real power control problem. Multiple control options are possible and should be 
coordinated so that a given objective can be accomplished, as in the case of network 
congestion relief where moving just one control might not give a complete solution.
8.3	
Control of Real Power Flow, Longitudinal Networks
A longitudinal network is one that is not well developed in terms of loops and electri-
cal support as well as one which does not have a robust HV transmission system. A 
weak network is prone to difficult voltage control problems and is very sensitive to 
reactive power changes. For dynamic real power imbalances, there are oscillations 
that do not damp out rapidly; it is a system with a low damping condition. With 
longitudinal systems, one difficult situation that operating engineers face is how 
to control the real power flow in networks that are not well-meshed and without 
a robust electrical condition. Sensitivity factors, such as the calculated in Section 
8.2 can pave the way to solving this interesting problem; in particular, we need to 
visualize how far into the network a control action can reach, how effective it is, 
and where is more appropriate to locate new control devices so as to develop suc-
cessful control schemes for a particular network.
Example 8.2
In order to discuss details about weak longitudinal networks, let us use the electric 
structure in Figure 8.5—15 nodes and 15 elements. We will take a detailed look 
into the network, the sparse nature of the coefficients matrix as shown in Figure 
8.6, and the sensitivity factors for existing or for planned controls to upgrade net-
work performance.
Sensitivity factors, real power control
Longitudinal network
Nodes =   15    Elements =   15
Element   Node from    Node to          z (pu)
   1          2           3       0.0000 +j   0.1189
   2          3           4       0.0000 +j   0.0568
   3          5           7       0.0000 +j   0.0807
   4          7           8       0.0000 +j   0.0451
   5          4          10       0.0000 +j   0.1316
   6          3           9       0.0000 +j   0.1458
   7         10           9       0.0000 +j   0.0449
   8         12          15       0.0000 +j   0.1699
   9         12          13       0.0000 +j   0.0849
  10          1           2       0.0000 +j   0.0930
  11          3           5       0.0000 +j   0.1885
  12          6           5       0.0000 +j   0.1330
  13         11          10       0.0000 +j   0.0930
  14          9          12       0.0000 +j   0.1885
  15         14          13       0.0000 +j   0.1331

256
Real and Reactive Power and Frequency Control
Figure 8.5  A longitudinal system, 15 nodes and 15 elements.
Figure 8.6  Sparse patterns for the matrix of a longitudinal system, Figure 8.5. 

8.3	
Control of Real Power Flow, Longitudinal Networks
257
For this network, its connectivity and numerical values for reactance, the sensitiv-
ity factors numerically show how a control change will affect power flows or nodal 
angle (radians) for the real power problem. If a transformer located between node 
1 and 2 is able to shift a control angle, then the column of factors shows that flows 
are unaffected; node 1 does not sense a change, all other nodes are affected by coef-
ficient −1 (the nodal value will increase if Δτ12 < 0).
Sensitivity factors, control in element 10 (transformer from node 
1 to 2)
Elem(  1) = +0.000000
Elem(  2) = +0.000000
Elem(  3) = +0.000000
Elem(  4) = +0.000000
Elem(  5) = +0.000000
Elem(  6) = +0.000000
Elem(  7) = +0.000000
Elem(  8) = +0.000000
Elem(  9) = +0.000000
Elem( 10) = +0.000000
Elem( 11) = +0.000000
Elem( 12) = +0.000000
Elem( 13) = +0.000000
Elem( 14) = +0.000000
Elem( 15) = +0.000000
node(  1) = +0.000000
node(  2) = -1.000000
node(  3) = -1.000000
node(  4) = -1.000000
node(  5) = -1.000000
node(  6) = -1.000000
node(  7) = -1.000000
node(  8) = -1.000000
node(  9) = -1.000000
node( 10) = -1.000000
node( 11) = -1.000000
node( 12) = -1.000000
node( 13) = -1.000000
node( 14) = -1.000000
node( 15) = -1.000000
Now for a real power injection ΔP at node 4, which is a node part of a loop, it will 
affect several power flows and nodal angles, except for node 1, which is our reference.
Sensitivity factors, control in node    4 (injection)
Elem(  1) = -1.000000
Elem(  2) = -0.850171
Elem(  3) = +0.000000

258
Real and Reactive Power and Frequency Control
Elem(  4) = +0.000000
Elem(  5) = +0.149829
Elem(  6) = -0.149829
Elem(  7) = +0.149829
Elem(  8) = +0.000000
Elem(  9) = +0.000000
Elem( 10) = -1.000000
Elem( 11) = +0.000000
Elem( 12) = +0.000000
Elem( 13) = +0.000000
Elem( 14) = +0.000000
Elem( 15) = +0.000000
node(  1) = +0.000000
node(  2) = +0.093030
node(  3) = +0.211930
node(  4) = +0.260220
node(  5) = +0.211930
node(  6) = +0.211930
node(  7) = +0.211930
node(  8) = +0.211930
node(  9) = +0.233775
node( 10) = +0.240502
node( 11) = +0.240502
node( 12) = +0.233775
node( 13) = +0.233775
node( 14) = +0.233775
node( 15) = +0.233775
We examine numerical results and find that some control actions might have a zero 
sensitivity factor. This means that those controls cannot modify the power flow in 
those elements. A similar conclusion can be drawn for nodal control actions by means 
of power injections if the sensitivity factors happen to be zero. In order to overcome 
this situation, new transmission lines have to be planned so that loop structures are 
formed and control actions can have a wider reach into more elements; the value of 
the sensitivity factors will show how strong or effective a control action is.
8.4	
Control of Reactive Power Flow
To discuss the reactive power control, we again use the power transformer with 
complex tap, as in Figure 8.1. The approximations used in Chapter 6 for the reac-
tive power flow as (6.107) will give us an incremental reactive power model and an 
Ohm’s representation.
	
−xkm
Δqkm
Vk
+ Δ Vk −Δ Vm = −Δ t 	
(8.6)

8.4	
Control of Reactive Power Flow
259
For a π equivalent representation of a transmission line, the incremental reactive 
power from node k to node m from (6.114) with approximate partial derivatives as 
in (6.50)–(6.55) and −xkm = 1/bkm is:
	
Δqkm
Vk
= −2Bsh2
(
)Δ Vk −bkm Δ Vk −Δ Vm
(
) 	
(8.7)
The incremental reactive power flow (8.7) can be split into a series and a shunt com-
ponent as shown in Figure 8.7. The advantage of this approach is to have a similar 
type of network for the real incremental real power flow and for the incremental 
reactive power flow. For the transmission line series, susceptance and a shunt com-
ponent satisfy the nodal reactive power balance.
Example 8.3
In Figure 8.8, there are two voltage-controlled buses and using (8.6) and (8.7), 
equations for the elements are written. Balance nodal equations for reactive power 
complement the required set to solve for unknowns.
Figure 8.7  Circuit to explain the shunt reactive compensation.
Figure 8.8  Circuit to study the reactive power control.

260
Real and Reactive Power and Frequency Control
	
(1)
−x12
Δq12
V1
+ Δ V1 −Δ V2
(
) = 0
(2) −x13
Δq13
V1
+ Δ V1 −Δ V3
(
) = −Δ t
(3)
−x34
Δq34
V3
+ Δ V3 −Δ V4
(
) = 0
(4)
−x24
Δq24
V2
+ (Δ V2 −Δ V4 ) = 0
1
+Δq12
V1
+ Δq13
V1
= ΔQ1
V1
2
−Δq12
V1
+ Δq24
V2
= ΔQ2
V2
3
+Δq34
V2
−Δq13
V1
= ΔQ3
V3
4
−Δq24
V2
−Δq34
V3
= ΔQ4
V4
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(8.8)
x12
0
0
0
+1
1
0
0
0
x13
0
0
+1
0
1
0
0
0
x34
0
0
0
+1
1
0
0
0
x24
0
+1
0
1
+1
+1
0
0
2Bsh2
12
0
0
0
1
0
0
+1
0
2Bsh2
12
2Bsh2
24
0
0
0
1
+1
0
0
0
2Bsh2
34
0
0
0
1
1
0
0
0
2Bsh2
24
2Bsh2
34
q12 / V1
q13 / V1
q34 / V2
q24 / V3
V1
V2
V3
V4
=
0
t
0
0
Q1 / V1
Q2 / V2
Q3 / V3
Q4 / V4
 

(8.9)
The previous matrix equation in compact form is:
	
−x
A
At
−2Bsh
⎡
⎣
⎢
⎤
⎦
⎥
Δq
V
Δ V
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
−Δ t
ΔQ
V
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(8.10)
x	
diagonal matrix of element’s reactance in the network
A	
incidence matrix that has connectivity information
Δq/⎪V⎪	
vector of incremental reactive power flow in every element in 
the network

8.4	
Control of Reactive Power Flow
261
Δ⎪t⎪	
vector of tap controls available in the branches
ΔQ/⎪V⎪	 vector of net nodal incremental reactive power
2 Bsh	
array of capacitive effect of transmission lines; might include node 
reactive shunt compensation.
Once the inverse matrix in (8.10) is calculated, we will find sensitivity coefficients. 
The coefficients will show the impact of control actions on the incremental reactive 
power flows and nodal voltages. For example, the second column of the inverse 
shows the effect of an incremental change Δ⎪t⎪ for a tap control located in element 
2. In this model, the nodal angles are assumed to have a fixed value from the power 
flow solution, which is solved prior to the change in control actions. In order to 
obtain results considering all PV nodes from the regular load flow problem, we 
assumed that the voltage magnitude has a fixed value. This voltage condition must 
be included in the model before the matrix inversion process.
Sensitivity factors, Voltage-Reactive Power
Nodes =    4    Elements =    4
Element    Nfrom      Nto      Type             z(pu)          bsh2(pu)
   1         1         2        +0       0.00990+j 0.09901     +0.20000
   2         1         3        +1       0.00990+j 0.09901     +0.00000
   3         3         4        +0       0.00660+j 0.06601     +0.20000
   4         2         4        +0       0.00495+j 0.04950     +0.20000
Sensitivity factors for change in control    2
Elem(  1) = +0.000000
Elem(  2) = -5.994970
Elem(  3) = -6.157545
Elem(  4) = +0.000000
node(  1) = +0.000000
node(  2) = -0.000000
node(  3) = -0.406439
node(  4) = -0.000000
Sensitivity factors for change in node    2
Elem(  1) = -0.342373
Elem(  2) = -0.000000
Elem(  3) = -0.000000
Elem(  4) = +0.684746
node(  1) = +0.000000
node(  2) = +0.033898
node(  3) = +0.000000
node(  4) = +0.000000
A close look at results for the incremental reactive power model will give us a bet-
ter understanding of the problem. In Figure 8.8, node 1 and 4 are PV buses; in the 
incremental network (see Figure 8.9), both nodes are shorted to reference and an 
electrically split network is obtained. A tap change in element (2) will affect the 
flow in elements (2) and (3) and the nodal voltage for node 3. A power injection 
change into node 2 will affect nodal voltage 2 and the incremental reactive power 
in elements (1) and (4).

262
Real and Reactive Power and Frequency Control
8.5	
Congestion and Minimum Control Effort
A congestion problem in a given network is related to elements and nodes in the 
system that cannot maintain its operation within preset bounds. For transmis-
sion lines and transformers, this means that they are restricted because of thermal 
limit, stability constraint, or by voltage drop criteria. A congestion problem limits 
the power transfer capability and makes the network inefficient, leading to higher 
operating costs.
For example, to solve a congestion problem in reactive power flows and to 
maintain nodal voltages within limits, there might be several possible actions: 
tap changes in transformers, by shunt-connected elements to take reactive power, 
or by nodal injections. A more sophisticated arrangement will be through FACT 
devices that allow smooth control within their operating limits. FACT devices are 
designed with passive inductance/capacitance arrangements, and are controlled by 
power electronics that shape current and control switching times for conduction or 
blocking status. Some aspects will be discussed in Sections 8.7–8.10.
When one or two controls are available, experienced system operators know 
how to increase/decrease the controls in order to solve a problem. However, when 
there are various controls with possibly conflicting actions, the operators’ actions 
must be coordinated. One approach can be to establish coordination through opti-
mal control (i.e., we can think about minimum control effort). To build the optimal 
model, we require a cost function and linear or nonlinear equality constraints to 
be observed, as well as possible inequality constraints.
8.5.1	 Use of Sensitivity Coefficients
To design useful applications for the sensitivity factors just discussed, let us estab-
lish a base case load flow solution for a set of load and generation conditions in a 
network. Let us first pay attention to the control of real power flow and solve a real 
power congestion problem. In Section 8.5.3, we consider the reactive power flow 
or out of range nodal voltages for a given operating condition.
Figure 8.9  Network for the incremental reactive power control. 

8.5	
Congestion and Minimum Control Effort
263
Example 8.4
For a three-node system (see Figure 8.10), let us first solve for real power flows. 
Using the incremental model for real power flows and sensitivity coefficients, let’s 
find the incremental change required from a phase shifter control Δτ13 to increment 
in 0.1 pu the flow in line 2 – 3 (i.e., Δp23 = +0.1 pu).
The incremental model is (8.11), assuming unitary voltage magnitudes.
	
x12
0
0
+1
1
0
0
x13
0
+1
0
1
0
0
x23
0
+1
1
+1
+1
0
0
0
0
1
0
+1
0
0
0
0
1
1
0
0
0
p12 / V1
p13 / V1
p23 / V2
q1
q2
q3
=
0
13
0
P1 / V1
P2 / V2
P2 / V3
	
(8.11)
DC Load Flows and Sensitivity factors, P-theta
Nodes =    3    Elements =    3
(0 is a transmission line, +1 a phase shifter)
Element    Nfrom      Nto      Type      x(pu)
   1         1         2        +0       0.05000
   2         1         3        +1       0.10000
   3         2         3        +0       0.12500
Node initial conditions (0 slack, +1 PV and -1 PQ node)
Node    Ntype     Voltage      theta(rad)    PG           PL
   1      0       1.00000      +0.00000      0.0000       0.0000
   2     -1       1.00000      +0.00000      0.0000       0.0000
   3     -1       1.00000      +0.00000      0.0000       1.0000
Coefficient matrix
   -0.0500         0         0    1.0000   -1.0000         0
         0   -0.1000         0    1.0000         0   -1.0000
Figure 8.10  Three-node system for real power control. 

264
Real and Reactive Power and Frequency Control
         0         0   -0.1250         0    1.0000   -1.0000
    1.0000    1.0000         0         0         0         0
   -1.0000         0    1.0000         0         0         0
         0   -1.0000   -1.0000         0         0         0
Sensitivity matrix (node 1 as reference)
   -3.6364    3.6364   -3.6364         0   -0.8182   -0.3636
    3.6364   -3.6364    3.6364   -0.0000   -0.1818   -0.6364
   -3.6364    3.6364   -3.6364    0.0000    0.1818   -0.3636
         0         0         0    0.0000    0.0000    0.0000
   -0.8182   -0.1818    0.1818   -0.0000    0.0409    0.0182
   -0.3636   -0.6364   -0.3636   -0.0000    0.0182    0.0636
Node solution
Node    Ntype     Voltage      theta(deg)    PG           PL
   1      0       1.00000      -0.00000      1.0000       0.0000
   2     -1       1.00000      -1.04174      0.0000       0.0000
   3     -1       1.00000      -3.64610      0.0000       1.0000
Line flows
Element    Nfrom      Nto      Type      p(pu)
   1         1         2        +0       0.36364
   2         1         3        +1       0.63636
   3         2         3        +0       0.36364
From the load flow results p23 = 0.36364 pu, and this flow changes by a control 
(phase shifter) in element 2. The second column of the sensitivity matrix has for 
element 3 the following coefficients Δp23 = 3.6364 (−Δτ13), Δτ13 = −Δp23/3.6364 
= −(+0.1)/3.6364 = −0.0275 rad.
The incremental changes on network variables are calculated by multiplying 
the second column of the sensitivity matrix by the phase shift increment we just 
calculated. The new values are obtained when we add the incremental solution to 
the base case results.
Dtau = -0.0275
Node adjusted solution
Node    Ntype     Voltage      theta(deg)    PG           PL
   1      0       1.00000      -0.00000      1.0000       0.0000
   2     -1       1.00000      -1.32822      0.0000       0.0000
   3     -1       1.00000      -4.64877      0.0000       1.0000
Line adjusted flows
Element    Nfrom      Nto      Type      p(pu)
   1         1         2        +0       0.46364
   2         1         3        +1       0.53636
   3         2         3        +0       0.46364
Results show the change in nodal angles (radians) and the new power flow values 
for the lines. The required increase of flow in line 2–3 of 0.1 pu is accomplished by 
the control action.

8.5	
Congestion and Minimum Control Effort
265
8.5.2	 Optimal Control of Real Power Flow
In Section 8.5.1, we worked the real power flow control problems by means of a 
simple example and the use of the sensitivity coefficients; we then found the value 
of the required control. Once the control action is implemented, the new operating 
conditions are calculated. The assumption is that we would find an adjusted solu-
tion close to the base case so that the assumption of a linear model is valid. One 
extension that can be made to the previous problem is to include the nodal power 
injections as additional control actions. Power from generators and loads is an 
additional means of control for the real power in the system.
With values obtained from the sensitivity matrix, we can determine in what 
direction to move the available controls, and by a coordinated action, we can 
determine how much to move each control. Let us focus our effort into establish-
ing a cost function, so that by control actions we can solve a congestion problem. 
To start the discussion, let us use the simple three-node system from Figure 8.11 
modified in generation nodes and load values. Assume that an analysis of the base 
case requires a decrease in power flows as Δp13 = −0.2182 pu and Δp23 = −0.1818 
pu. We use phase shifter Δτ and nodal power injections ΔP2 and ΔP3. From the 
sensitivity matrix, we write two equality constraints to comply with the required 
decrease in power flows:
	
Δp13
Δp23
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
−S22Δt13 + S25ΔP2 + S26ΔP3
−S32Δt13 + S35ΔP2 + S36ΔP3
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
−0.2128
−0.1818
⎡
⎣⎢
⎤
⎦⎥	
(8.12)
To minimize the control effort, we write a cost function with weighted control 
variables ωk, according to the relative importance attached to each control. In our 
case, the equality and inequality constraints are written as follows:
	
min
wkΔtk
2
k∈T∑
+
wkΔPk
2
k∈PG
∑
	
(8.13)
	
subject to
[f = 0]
Δt ≤Δtmax
ΔP ≤ΔPmax
	
(8.14)
Example 8.5 Base Case
DC Load Flows and Optimal factors, P-theta
Nodes =    3    Elements =    3
Element    Nfrom      Nto      Type      x(pu)
   1         1         2        +0       0.05000
   2         1         3        +1       0.10000
   3         2         3        +0       0.12500
Node initial conditions
Node    Ntype     Voltage      theta(rad)    PG           PL
   1     +0       1.00000      +0.00000      0.0000       0.0000
   2     +1       1.00000      +0.00000      1.5000       0.0000
   3     +1       1.00000      +0.00000      0.5000       3.0000

266
Real and Reactive Power and Frequency Control
Node solution
Node    Ntype     Voltage      theta(deg)    PG           PL
   1      0       1.00000      -0.00000      1.0000       0.0000
   2      1       1.00000      +0.91152      1.5000       0.0000
   3      1       1.00000      -7.55263      0.5000       3.0000
Line flows in Base Case
Element    Nfrom      Nto      Type      p(pu)
   1         1         2        +0      -0.31818
   2         1         3        +1       1.31818
   3         2         3        +0       1.18182
Minimize the cost function subject to constraints:
	
min 1
2 w1Δt13
2 + 1
2 w2ΔP2
2 + 1
2 w3ΔP3
2 	
(8.15)
	
−S22Δt13 + S25ΔP2 + S26ΔP3 = Δp13
−S32Δt13 + S35ΔP2 + S36ΔP3 = Δp23
Δt13 ≤0.0085
	
(8.16)
The augmented Lagrangian includes the equality and the inequality constraints 
(8.16), as well as the Lagrange and Kuhn-Tucker multipliers. The problem has six 
variables: phase shifter, two nodal power injections, two Lagrange multipliers, and 
one Khun-Tucker multiplier. The solution is attained when the Lagrange gradient 
is equal to zero.
min z = w1Δt13
2 + w2ΔP2
2 + w3ΔP3
2 + l1 −S22Δt13 + S25ΔP2 + S26ΔP3 −Δp13
(
)
+ l2 −S32Δt13 + S35ΔP2 + S36ΔP3 −Δp23
(
) + m Δτ13 −0.0085
(
)
	(8.17)
Figure 8.11  Three-node system base case.

8.5	
Congestion and Minimum Control Effort
267
	
∂z
∂Δt13
= w1Δt13 −l1S22 −l2S32 + m = 0
∂z
∂Δt13
= w1Δt13 −l1S22 −l2S32 + m = 0
∂z
∂ΔP2
= w2ΔP2 + l1S25 + λ2S35 = 0
∂z
∂ΔP3
= w3ΔP3 + l1S26 + l2S36 = 0
∂z
∂l1
= −S22Δt13 + S25ΔP2 + S26ΔP3 −Δp13 = 0
∂z
∂l2
= −S32Δt13 + S35ΔP2 + S36ΔP3 −Δp23 = 0
∂z
∂m = Δt13 −0.0085 = 0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(8.18)
In this case, the gradient is a system of linear equations, an optimal solution that 
complies with constraints using weights wk = 1.0 ∀k and flows Δp13 = −0.2182 pu, 
Δp23 = −0.1818 pu.
	
w1
0
0
S22
S32 +1
0
w2
0
+S25 +S35
0
0
0
w3
+S26 +S36
0
S22 +S25 +S26
0
0
0
S32 +S35 +S36
0
0
0
+1
0
0
0
0
0
t13
P2
P3
l1
l2
m
=
0
0
0
0.2182
0.1818
+0.0085
	
(8.19)
Hess =
    1.0000         0         0    3.6364   -3.6364    1.0000
         0    1.0000         0   -0.1818    0.1818         0
         0         0    1.0000   -0.6364   -0.3636         0
    3.6364   -0.1818   -0.6364         0         0         0
   -3.6364    0.1818   -0.3636         0         0         0
    1.0000         0         0         0         0         0
The changes on the control variables Δτ = 0.0085 rad, ΔP2 = −0.0299 pu, and ΔP3 
= +0.4 pu affect the base case. We have changes to the transmission line flows, and 
the equality and inequality constraints are satisfied (see Figure 8.12).
	
t13
P2
P3
l1
l2
m
=
+0.0085
0.0299
+0.4000
+0.3402
+0.5047
+0.5895
	
(8.20)

268
Real and Reactive Power and Frequency Control
Node solution, optimal changes
Node    Ntype     Voltage      theta(deg)    PG           PL
   1      0       1.00000      -0.00000      0.6299       0.0000
   2      1       1.00000      +1.34669      1.4701       0.0000
   3      1       1.00000      -5.81542      0.9000       3.0000
Line flows
Element    Nfrom      Nto      Type      p(pu)
   1         1         2        +0      -0.47008
   2         1         3        +1       1.09998
   3         2         3        +0       1.00002
8.5.3	 Optimal Control for Reactive Power Flow
Now, let us turn our attention to the reactive power—nodal voltage control prob-
lem. The assumption is that we have a base case solution that is a converged load 
Figure 8.12  Three-node system with minimum control effort. 
Figure 8.13  Circuit to study reactive power control.

8.5	
Congestion and Minimum Control Effort
269
flow for real and reactive power. Then, when a congestion problem is identified, we 
must solve it. For this problem, the reactive power and nodal voltages will be our 
main concern. We start with the appropriate model for LTC and transmission line 
elements, as in (8.6) and (8.7).
Example 8.6 Base Case
In Figure 8.13, the slack bus voltage is 1.0 pu. There are two PV buses whose volt-
age must also be maintained at 1.0 pu. Nodal generation and load conditions are 
shown in the printout.
4 Node Model
Number of Nodes  =           4
Number of Lines =            3
Number of transformers =     1
Number of shunts =           0
Line Parameters
Line  Node From Node To    Resist       React        ysh/2        Smax
   1      1        2       0.00990      0.09901      0.04000      1.00000
   2      3        4       0.00660      0.06601      0.03000      1.00000
   3      2        4       0.00495      0.04950      0.02500      1.00000
Transformer´s data
Transf Node From Node To   Resist     React     tap       Angle     Smax
   1      1         3      0.00990    0.09901   1.00000   0.00000   1.00000
Nodal Values
Node Type     V      th(rad)  th(degrees)      Sgen              Sload
 1    0    1.0000   0.000000    0.00    0.0000 +j  0.0000  0.6000 +j 0.2000
 2    1    1.0000   0.000000    0.00    0.6000 +j  0.0000  0.8000 +j 0.3000
 3   -1    1.0000   0.000000    0.00    0.0000 +j  0.0000  0.4000 +j 0.1600
 4   -1    1.0000   0.000000    0.00    0.0000 +j  0.0000  1.0000 +j 0.4000
CONVERGENCE IN    3 ITERATIONS
Converged Values for Variables
  Node     V      th(rad) th(degrees
   1   1.000000   0.0000   0.0000
   2   1.000000  -0.0803  -4.6021
   3   0.977823  -0.0805  -4.6111
   4   0.977146  -0.1086  -6.2226
Line power flows in    3 lines
Line  Node from   Node To        p+jq              S       overload
-----------------------------------------------------------------------
   1      1          2     0.8056 +j  -0.0880    0.8104
          2          1    -0.7991 +j   0.0725    0.8024
   2      3          4     0.4046 +j  -0.0534    0.4081
          4          3    -0.4035 +j   0.0074    0.4035
   3      2          4     0.5991 +j   0.3846    0.7120
          4          2    -0.5965 +j  -0.4074    0.7224
-----------------------------------------------------------------------

270
Real and Reactive Power and Frequency Control
Load power flows in    1 transformers
Trans  Node From  Node To        p+jq               S       overload
-----------------------------------------------------------------------
  1      1          3     0.8114 +j   0.1748    0.8300
         3          1    -0.8046 +j  -0.1066    0.8116
S in generators (>0) and Load
Node   type       PG+jQG            Qmin      Qmax          PL+jQL
-----------------------------------------------------------------------
   1    +0   2.2170 +j   0.2868    -5.0000    5.0000   0.6000 +j   0.2000
   2    +1   0.6000 +j   0.7571    -2.0000    2.0000   0.8000 +j   0.3000
   3    -1  -0.0000 +j   0.0000                        0.4000 +j   0.1600
   4    -1   0.0000 +j   0.0000                        1.0000 +j   0.4000
Total Generation
  2.8170 +j  1.0439
Total Load
  2.8000 +j  1.0600
In lines: Losses P and Q (>0 required, <0 supplied)
------------------------------------------------------
  0.0170 +j  -0.0161
8.5.4	 Optimal Coordinated Control Efforts
From the base case in Figure 8.14, we notice that nodal voltages 3 and 4 need to be 
improved. We have various control actions at our disposal: the tap change in ele-
ment (4) and the reactive power injections at nodes 3 and 4. An optimal coordinated 
effort can be established by means of the sensitivity matrix for the tap control and 
nodal injections.
Figure 8.14  Load power flows, base case.

8.5	
Congestion and Minimum Control Effort
271
Sensitivity factors for change in control    4 (tap)
Elem(  1) = -0.000000
Elem(  2) = -4.670612
Elem(  3) = +4.696186
Elem(  4) = -4.638166
node(  1) = +0.000000
node(  2) = -0.000000
node(  3) = -0.540776
node(  4) = -0.232484
Sensitivity factors for change in node    3 (injection)
Elem(  1) = -0.000000
Elem(  2) = +0.462437
Elem(  3) = -0.464969
Elem(  4) = -0.540776
node(  1) = +0.000000
node(  2) = +0.000000
node(  3) = +0.053542
node(  4) = +0.023018
Sensitivity factors for change in node    4 (injection)
Elem(  1) = -0.000000
Elem(  2) = -0.231103
Elem(  3) = -0.773107
Elem(  4) = -0.232484
node(  1) = +0.000000
node(  2) = +0.000000
node(  3) = +0.023018
node(  4) = +0.038273
The optimal coordination of three controls—tap change, reactive power at node 3, 
and into node 4—are solved with the requirement that voltage magnitudes V3 and 
V4 should be as close to 1 pu as possible.
	
min 1
2 w1Δt13
2 + 1
2 w2ΔQ3
2 + 1
2 w3ΔQ4
2 	
(8.21)
Subject to:
	
−S74Δt13 + S77ΔQ3 + S78ΔQ4 = ΔV3
−S84Δt13 + S87ΔQ2 + S88ΔQ3 = ΔV4
Δt13 ≤0.05
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(8.22)
The augmented Lagrangian includes equality and inequality constraints such as 
Lagrange and Kuhn-Tucker multipliers.
min z = 1
2 w1Δt13
2 + 1
2 w2ΔQ3
2 + 1
2 w3ΔQ4
2 + l1 −S74Δt13 + S77ΔQ3 + S78ΔQ4 −ΔV3
(
)
+ l2 −S84Δt13 + S87ΔQ3 + S88ΔQ4 −ΔV4
(
) + m Δt13 −0.05
(
)
	
(8.23)

272
Real and Reactive Power and Frequency Control
Solution when the gradient is equal to zero:
	
∂z
∂Δt13
= w1Δt13 −l1S74 −l2S84 + m = 0
∂z
∂ΔQ3
= w2ΔQ3 + l1S77 + l2S87 = 0
∂z
∂ΔQ4
= w3ΔQ4 + l1S78 + l2S88 = 0
∂z
∂l1
= −S74Δt13 + S77ΔQ3 + S78ΔQ4 −ΔV3 = 0
∂z
∂l2
= −S84Δt13 + S87ΔQ3 + S88ΔQ4 −ΔV4 = 0
∂z
∂m = Δt13 −0.05 = 0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(8.24)
In this case, the gradient is a system of linear equations and the optimal solution 
complies with the required constraints. We use weights wk = 1.0 ∀k and the voltage 
changes ΔV3 = 0.02 pu and ΔV4 = 0.02 pu.
	
w1
0
0
S74
S84 +1
0
w2
0
+S77 +S87
0
0
0
w3
+S78 +S88
0
S74 +S77 +S78
0
0
0
S84
+S87
+S88
0
0
0
+1
0
0
0
0
0
t13
Q3
Q4
l1
l2
m
=
0
0
0
+0.02
+0.02
+0.05
	
(8.25)
The sensitivity coefficients S are taken from the columns of sensitivity matrix: 
fourth for tap control, seventh and eighth for reactive power injection into nodes 
3 and 4, respectively.
The Hessian (8.25) is:
Hess =
    1.0000         0         0    0.5408    0.2325    1.0000
         0    1.0000         0    0.0535    0.0230         0
         0         0    1.0000    0.0230    0.0383         0
    0.5408    0.0535    0.0230         0         0         0
    0.2325    0.0230    0.0383         0         0         0
    1.0000         0         0         0         0         0
Δcont =
    0.0500
   -0.3042
    0.4018
   13.7501
  -18.7681
   -3.1224

8.6	
Work and Energy
273
The required controls are Δt13 = 0.05, ΔQ3 = −0.3042 and ΔQ4 = 0.4018 where (< 
0) is inductive compensation and (> 0) capacitive compensation. Once the control 
settings are adjusted, the new load flow solution is found.
Transformer´s data
Transf Node From  Node To  Resist    React      tap       Angle     Smax
  1      1         3      0.00990   0.09901    1.05000    0.00000   1.00000
Nodal Values
Node  Type     V      th(rad)  th(degrees)      Sgen            Sload
  1    0     1.0000   0.000000    0.00     0.0000 +j 0.0000  0.6000 +j 0.2000
  2    1     1.0000   0.000000    0.00     0.6000 +j 0.0000  0.8000 +j 0.3000
  3   -1     1.0000   0.000000    0.00     0.0000 +j 0.0000  0.4000 +j 0.4642
  4   -1     1.0000   0.000000    0.00     0.0000 +j 0.0000  1.0000 +j-0.0180
New Values for Variables
  Node      V     th(rad) th(degrees)
   1   1.000000   0.0000   0.0000    
   2   1.000000  -0.0767  -4.3971    
   3   0.998697  -0.0755  -4.3253    
   4   0.998263  -0.1048  -6.0029
With control actions, the voltage magnitudes are—for all practical purposes—very 
close to 1 pu. A summary of power at generators, total generation, loads, and losses 
is shown.
-----------------------------------------------------------------------
S in generators (>0) and Load
Node   type       PG+jQG            Qmin      Qmax          PL+jQL
-----------------------------------------------------------------------
   1    +0   2.2173 +j   0.6022    -5.0000    5.0000   0.6000 +j   0.2000
   2    +1   0.6000 +j   0.3277    -2.0000    2.0000   0.8000 +j   0.3000
   3    -1   0.0000 +j   0.0000                        0.4000 +j   0.4642
   4    -1   0.0000 +j   0.0000                        1.0000 +j  -0.0180
Total Generation
  2.8173 +j  0.9300
Total Load
  2.8000 +j  0.9462
------------------------------------------------------
In lines: Losses P and Q (>0 required, <0 supplied)
------------------------------------------------------
  0.0173 +j  -0.016
8.6	
Work and Energy
Even though this book focuses on the steady state for the electrical power system, 
energy, work, and power are foundational concepts; from the physics point of view, 
it is fundamental to understand the concept of energy. Work can be associated with 
a force applied to displace a body of mass M, for a given distance x, with respect 

274
Real and Reactive Power and Frequency Control
to a reference. The units for the quantities involved are: mass (M) in kg, force (F) 
in Newton and displacement (d) in meters. Force and distance can be represented 
as vectors (i.e., physical quantities that have magnitude and direction). We associ-
ate the concept of work to the force Fx that acts along the required displacement x 
(see Figure 8.15).
The vector force F will have two components in a plane: Fx along a horizontal 
reference x and Fy, making a 90° angle (in a counterclockwise direction) with respect 
to the x direction. The vector arrangement is shown in Figure 8.15.
	
F = Fxi + Fyj
d = xi 	
(8.26)
	
F =
Fx
2 + Fy
2 	
(8.27)
	
q = arctg
Fy
Fx
⎛
⎝⎜
⎞
⎠⎟	
(8.28)
i, j, and k	
Unit vectors that point along the x, y, and z reference direction, 
respectively.
Using an interior point product for vectors, the work done by vector force F along the 
vector distance d is calculated using (8.29), units in Newton-meter (N-m), or Jules.
	
W =
!
F ⋅
!
d = F d cosq 	
(8.29)
The amount of incremental work (ΔW) realized in a given time increment of time 
Δt) measured in seconds will render the concept of power, expressed in N-m/s or 
watts (W).
	
p = ΔW
Δt 	
(8.30)
In applications where the instantaneous power p(t) is known, for a given time inter-
val Δt = t1 − t0, the amount of energy is calculated using an integral, which is the 
area underneath the plot p(t) and the time axis t; from t0 to t1:
Figure 8.15  Force and distance, vector arrangement.

8.6	
Work and Energy
275
	
W =
p(t)
t0
t1
∫
dt 	
(8.31)
We find the total energy for a stepwise characteristic of the power p(t) (as depicted 
in Figure 8.16) through a summation of the energy at each interval.
	
W =
p tk
( )
t0
tn−1∑
Δt 	
(8.32)
In the case of a rotational system, assuming a rigid body that rotates in an xy plane 
with respect to an orthogonal z-axis, a vector force F applied at a distance vector r 
will produce a rotating torque, calculated as in (8.33) (see Figure 8.17).
	
t = r × F =
i
j
k
x
y
z
Fx Fy Fz
= yFz −zFy
(
)i −xFz −zFx
(
)j + xFy −yFx
(
)k 	 (8.33)
For rotational devices (as is the case of rotors in electrical generators), the pri-
mary energy source supplies the mechanical torque from a steam turbine or from 
a hydro turbine (in the case of hydroelectric prime mover). The torque in (N-m) 
times the rotating speed ω(rad/s) is the amount of power that the turbine-generator 
set can supply to the electrical power system discounting the power used within 
Figure 8.16  Stepwise characteristic for power p(t) versus time.
Figure 8.17  Rotating torque produced by force F at a distance vector r. 

276
Real and Reactive Power and Frequency Control
the power plant for its auxiliary services. The dynamics of rotating masses in the 
synchronous generator is dictated by the difference between the power supplied by 
the turbine, the electrical power that is delivered to the power system, the inertia, 
and the number of poles that are included in the design.
8.6.1	 Kinetic Energy and Electrical Frequency
The majority of electrical power systems in the world operate with (AC) alternat-
ing voltage sources. Power generators make energy conversion possible by taking 
mechanical energy from high-pressure steam or water flow at hydraulic turbines; 
these two forms comprise the main source of primary energy nowadays. We are 
also now finding alternative energy sources, such as wind, solar, geothermal, 
biogas, and nuclear. This state of affairs is changing rapidly as growing concerns 
about climate change are setting a definite trend in looking for a larger share of 
renewable sources for primary energy before transforming it to electric form. The 
conventional primary energy sources—thermal and hydro—supply mechanical 
torque from steam or hydro turbines to electrical generators, working through a 
rotating shaft on which a rotor with appropriate electrical windings is located. 
The mass of the rotor, shaft, and other masses rotating at a given angular speed 
imply that kinetic energy is involved in the conversion process from mechanical 
to electrical energy coupled with electromechanical principles.
AC voltage, electric frequency, and kinetic energy in the rotor of a generator are 
related. Consider, as a starting point for the discussion, that the system is working 
at a nominal frequency fo; for that instant, it means that the electric power gen-
erated by all of the connected power units match the electrical load required by 
customers and the losses when power flows from generation to the load centers. If 
the generation exceeds the load and transmission losses, the net effect has a change 
in rotating speed. The rate of frequency increase depends on the amount of excess 
in kinetic energy into the rotors of the generators and the rotating mass of all the 
rotating generators that are currently synchronized to the network. The dynamic 
component of the electrical load responds to higher frequency and an increased 
mechanical torque is required because of the increased electrical load. The net effect 
is to attain a generation-load balance at a higher frequency. The power system has 
a target frequency and a scheme of frequency control that takes action to bring the 
frequency back to its rated value; this is done by decreasing the power output at 
all generators that participate in the regulation action in the proper amount. This 
problem is extensive and with various modeling details; now, our purpose is to have 
a succinct presentation about the dynamics and some analytical and simulation 
tools that are required for this problem.
As the kinetic energy explains the relation between all the generators connected 
to the system, the dynamics in a system can start with a generator, inertia I in Kg-m2, 
at a nominal frequency fo in Hz and ω in rad/sec:
	
Wkin = Iw2
2  
Wkin
o
= Iw0
2
2
 	
(8.34)

8.6	
Work and Energy
277
From this expression, a relation of kinetic energy at frequency ω (with respect to 
the nominal rated value at ω0) depends on the frequency square.
	
Wkin
Wkin
o
= w2
w0
2 = f 2
f0
2 	
(8.35)
For an incremental torque ΔT (N-m) or an increment of power ΔP (Watts), the rotor 
of the synchronous machines will experience an acceleration α (rad/sec2). This is 
related to its kinetic energy.
	
ΔT = ΔP
w = Ia = Idw
dt 	
(8.36)
	
ΔP = wIa = wIdw
dt
=
d
dt Iw2
2
⎛
⎝⎜
⎞
⎠⎟
= dWkin
dt
	
(8.37)
Using (8.35) in (8.37):
	
ΔP = d/dt (Wkin
o  f 2 /f0
2)= 2Wkin
o  f/f0
2 df/dt 	
(8.38)
Example 8.7
For a given electrical system [1] its total kinetic energy is 1,500 MJ, at a rated fre-
quency of 60 Hz. What will be the rate of frequency increase for a surplus of 5 
MW? Use (8.36) to find the change in frequency.
	
5 MW = 2(1,500 MJ) (60 Hz)
(60 Hz)2
df
dt
df
dt = (5 MW) (60 Hz)
2(1,500 MJ)
=  0.1 Hz/sec
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(8.39)
8.6.2	 Turbine’s Power and System’s Frequency
As the load system changes, the generators that are equipped to regulate change the 
generated power to try to minimize the power imbalance due to load changes. The 
type of control problem described is a following one; in such cases, the system’s fre-
quency is the variable that gives a measure of power imbalance, and it is the variable 
that must be controlled. To have a viable model, some assumptions are required.
• Initially, a system’s rated frequency is fo, with a balance for generation Po
G 
and demand Po
D, as well as losses Po
L. Kinetic energy for all rotors is Po
kin in 
MW-sec.

278
Real and Reactive Power and Frequency Control
• For a demand increment ΔPD in the system, the electric generators supply an 
incremental power output such that ΔPG = ΔPD.
• For a power imbalance ΔPT − ΔPD, measured as turbine output and the 
required demand increment, a change in frequency is experienced. One ini-
tial assumption is that the change is uniform at every part of the electrical 
area. According to (8.35), the kinetic energy shows a squared dependence 
on frequency.
	
Wkin = Wkin
o f 2
f0
2   MW-sec 	
(8.40)
• Load has a component that responds to frequency. One kind of representation 
is considered through the constant D.
	
D = ∂PD
∂f   MW/Hz 	
(8.41)
The power balance in an electrical area requires that the power increment from the 
turbine ΔPT should be equal to the load increment ΔPD, plus the load frequency 
dependent contribution ∂PD/∂fΔf, plus the power change equal to the rate of change 
in kinetic energy ΔP = dWkin/dt; this last term comes from (8.40).
	
ΔPT = ΔPD + ∂PD
∂f Δf + d
dt Wkin
o f 2
f0
2
⎛
⎝⎜
⎞
⎠⎟  MW 	
(8.42)
Assuming that the new frequency will be f = fo + Δf once high order terms are 
neglected, we come to (8.44).
ΔPT −ΔPD = DΔf + d
dt
Wkin
o
fo + Δf
(
)
2
f0
2
⎛
⎝
⎜⎜
⎞
⎠
⎟⎟
= DΔf + Wkin
o
d
dt 1 + 2Δf
fo
+ Δf 2
f0
2
⎛
⎝⎜
⎞
⎠⎟  MW 	(8.43)
	
ΔPT −ΔPD ≈DΔf + 2Wkin
o
fo
d
dt (Δf)  MW 	
(8.44)
Using the rated nominal power for the generator as base Pr, a pu expression is written:
	
ΔPT −ΔPD ≈DΔf + 2H
fo
d
dt (Δf) p.u. MW 	
(8.45)
H is the inertia constant in seconds; its typical values are in a range from 2 to 8 
seconds. D constant will be as pu MW/Hz.
	
H = Wkin
o
Pr
 sec 	
(8.46)

8.6	
Work and Energy
279
A Laplace transform on (8.45) gives:
	
ΔPT(s) −ΔPD(s) = DΔf (s) + 2H
fo
sΔf (s) 	
(8.47)
The transfer function in (8.48) and a feedback through the power system closes the 
power system response that goes to the turbine control. We can use this model to 
start studying power-frequency dynamics.
	
Δf (s)
ΔPT(s) −ΔPD(s) =
1
D + 2H/fos =
1/D
1 + 2H/ Dfo
(
)s
=
Kp
1 + Tps
(
)
	
(8.48)
8.6.3	 Frequency Control by a Primary Loop
The change in frequency Δf due to a load disturbance ΔPD will require feedback 
(as shown in Figure 8.19), generally done through a droop characteristic, R. The 
droop will regulate the turbine output requirement in order to correct for a drop 
in speed with respect to a reference when the load is increased.
	
ΔPg(s) = ΔPref(s) −Δf (s)
R
	
(8.49)
	
ΔPT(s) = TF(s)ΔPg(s)	
(8.50)
	
Δf (s)
ΔPT(s) −ΔPD(s) =
Kp
1 + Tps 	
(8.51)
Figure 8.18  Frequency change as a function of disturbance from turbine power and load 
change. 
Figure 8.19  Primary loop frequency control.

280
Real and Reactive Power and Frequency Control
Example 8.7
The type of response when a load change is experienced, the following values are 
used in the model: load change ΔPD = +0.01 pu MW at time 1 sec; R = 2.4 Hz/pu 
MW; Kp = 1/D = 120 Hz/pu MW; and Tp = 2H/(Dfo) = 2(5)(120)/60 = 20 sec. Refer-
ence is set to zero change. The time response (see Figure 8.20) shows a steady state 
frequency error; therefore, additional control action is required in order to get the 
system frequency restored to its nominal value.
Estimated time constant (3.5 − 1.0)/5 = 0.5 sec.
In this case, the frequency error after 5 seconds is shown in Figure 8.21. To 
reduce the error in frequency, a secondary control loop with an integral characteristic 
Figure 8.20  Dynamic frequency response for primary loop control, no turbine model is 
included. 

8.6	
Work and Energy
281
is required. This will eventually make the frequency error go to zero (see Figure 
8.21); this part is extended through Example 8.8.
Example 8.9
In order to correct the error frequency seen in Example 8.7, an additional control 
block with an integral function and an appropriate gain KI will bring the frequency 
back to normal. We show the effect of using KI = −0.5 and −0.6 (see Figure 8.22).
A great deal of material needs to be extended in order to cover the nature of 
power-frequency control, such as the tie-line control, areas interchanges, and neigh-
bor assistance characteristics when one area experiences frequency disturbances.
Figure 8.21  Primary loop frequency response, including a turbine model.

282
Real and Reactive Power and Frequency Control
Figure 8.22  Supplementary control loop to bring back frequency deviation to zero. 
8.7	
Incremental Power Model to Include a VSC-STATCOM
AC load flow solutions for power networks include models for all the main compo-
nents: transmission lines, on load tap changer power transformers, and new control 
devices. The new arrangements are usually based on power electronics whose char-
acteristics make very useful and versatile controls fast acting and dependable with 
promising possibilities for the better use of transmission assets and better system 
control. To include various arrangements might pose a problem if new devices need 
to be incorporated into the traditional analysis tools as the power flow studies. In 

8.7	
Incremental Power Model to Include a VSC-STATCOM
283
this section, we develop a versatile model to incorporate new devices based on the 
concept of incremental real and reactive power in conjunction with nodal power 
balance. The resulting system of equations, when solved, includes nodal analysis 
and for the nonlinear case the incremental model is the accepted expression for 
Newton’s iterative process.
8.7.1	
Power Flows in a Complex Transformer and a Transmission Line
The concept of a complex power transformer is useful in representing a device that 
can control both the real and reactive power flows as well as the voltage at terminals; 
an extension to this control problem might be a congestion problem or the voltage 
control at a given node. This functionality can be realized by power electronics [4] 
whose purpose is to render a flexible and diverse control and to be readily available 
within an already stressed power system.
8.7.1.1	 Complex Power Transformer
The circuit in Figure 8.24 allows us to visualize the angle shift and phasor magni-
tudes from primary to secondary in a complex power transformer.
To include winding losses, a series conductance component is added to the ideal 
complex transformer. A shunt branch can be connected, as shown in Figure 8.23.
Figure 8.23  Ideal Complex power transformer and a π circuit.
Figure 8.24  Ideal complex power transformer.

284
Real and Reactive Power and Frequency Control
8.7.1.2	 On Load Tap Changer (OLTC)
In this case, shunt admittances are zero as well as the phase shift angle τ:
	
ysh,k = ysh,m = 0
t = 0
	
(8.52)
8.7.1.3	 Transmission Line
The π representation of a positive sequence circuit will be obtained if we make:
	
ysh,k = ysh,m = ysh2
t = 1, t = 0
	
(8.53)
8.7.2	 Expressions for Incremental Power Flow
The first term of a Taylor’s series expansion for pkm and qkm includes the change of 
the series susceptance bkm.
	
Δpkm = ∂pkm
∂qk
Δqk + ∂pkm
∂qm
Δqm + ∂pkm
∂t Δt + ∂pkm
∂Vk
Vk
Δ Vk
Vk
+ ∂pkm
∂Vm
Vm
Δ Vm
Vm
+ ∂pkm
∂t
t Δ t
t
+ ∂pkm
∂bkm
bkm
Δbkm
bkm
	
(8.54)
	
Δqkm = ∂qkm
∂qk
Δqk + ∂qkm
∂qm
Δqm + ∂qkm
∂t Δt + ∂qkm
∂Vk
Vk
Δ Vk
Vk
+ ∂qkm
∂Vm
Vm
Δ Vm
Vm
+ ∂qkm
∂t
t Δ t
t
+ ∂qkm
∂bkm
bkm
Δbkm
bkm
	
(8.55)
Similar equations can be written for Δpmk and Δqmk. In (8.54) and (8.55), various 
terms can be identified as state variables, like nodal angles and voltage magnitudes, 
but the incremental changes of phase shifting angle τ, tap magnitude, and increase/
decrease of the susceptance bkm are also identified as control variables. Due to trans-
mission losses and the nature of series inductance, there will be a different amount 
of power from m to k; this requires that we write the incremental equations from 
node m to k.
	
Δpmk = ∂pmk
∂qm
Δqm + ∂pmk
∂qk
Δqk + ∂pmk
∂t Δt + ∂pmk
∂Vm
Vm
Δ Vm
Vm
+ ∂pmk
∂Vk
Vk
Δ Vk
Vk
+ ∂pmk
∂t
t Δ t
t
+ ∂pmk
∂bkm
bkm
Δbkm
bkm
	
(8.56)

8.7	
Incremental Power Model to Include a VSC-STATCOM
285
	
Δqmk = ∂qmk
∂qm
Δqm + ∂qmk
∂qk
Δqk + ∂qmk
∂t Δt + ∂qmk
∂Vm
Vm
Δ Vm
Vm
+ ∂qmk
∂Vk
Vk
Δ Vk
Vk
+ ∂qmk
∂t
t Δ t
t
+ ∂qmk
∂bkm
bkm
Δbkm
bkm
	
(8.57)
−1
0
∂pkm
∂qk
∂pkm
∂qm
0
0
∂pkm
∂Vk
Vk
∂pkm
∂Vm
Vm
0
−1 ∂pmk
∂qk
∂pmk
∂qm
0
0
∂pmk
∂Vk
Vk
∂pmk
∂Vm
Vm
+1
0
0
0
0
0
0
0
0
+1
0
0
0
0
0
0
0
0
∂qkm
∂qk
∂qkm
∂qm
−1
0
∂qkm
∂Vk
Vk
∂qkm
∂Vm
Vm
0
0
∂qmk
∂qk
∂qmk
∂qm
0
−1 ∂qmk
∂Vk
Vk
∂qmk
∂Vm
Vm
0
0
0
0
+1
0
0
0
0
0
0
0
0
+1
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
Δpkm
Δpmk
Δqk
Δqm
Δqkm
Δqmk
ΔVk
Vk
ΔVm
Vm
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
−∂pkm
∂t Δt −∂pkm
∂t
t Δ t
t
−∂pkm
∂bkm
bkm
Δbkm
bkm
−∂pmk
∂t Δt −∂pmk
∂t
t Δ t
t
−∂pmk
∂bkm
bkm
Δbkm
bkm
ΔPk
ΔPm
−∂qkm
∂t Δt −∂qkm
∂t
t Δ t
t
−∂qkm
∂bkm
bkm
Δbkm
bkm
−∂qmk
∂t Δt −∂qmk
∂t
t Δ t
t
−∂qmk
∂bkm
bkm
Δbkm
bkm
ΔQk
ΔQm
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥ 

(8.58)
Equations (8.54)–(8.58) represent individual elements, transmission lines, or power 
transformers. The nodal power balance expresses the connectivity in the network. 
These types of incremental relations are the basis for the Newton’s iterative method—
the one that is used to solve the general load flow problem.
8.7.2.1	 Partial Derivatives, Incremental Power Flow
Numerical values for the partial derivatives in (8.58) can be obtained from a given 
set of nodal voltages and the calculated real and reactive power from k to m and 
from m to k. Formulas for partial derivatives were presented in Chapter 6.
8.7.2.2	 Load Flow Solution by Newton’s Method
For an AC power network, a solution for complex nodal voltages is to be deter-
mined, starting with an assumed set of values. With these voltages, the element’s 
power flows are determined, nodal power balances are calculated, and the nodal 
power mismatches are obtained. As the initial voltages might not be the network’s 
solution, the maximum absolute value of the power mismatch would not be smaller 
than a prescribed small tolerance. An iterative process that requires building the 
incremental set (8.58) is used. The coefficient matrix is known as Jacobian; its pat-
tern is highly sparse and there will be a need to use special techniques in order to 
efficiently solve large networks. Usually, in the right hand side of (8.58) we find the 
control variables that are assumed fixed, so we are left with real and reactive power 
mismatches and the need to solve for correction Δθ’s and ΔV/V to the state variables.

286
Real and Reactive Power and Frequency Control
Example 8.10
Solution for a three-node system (see Figure 8.25):
The regular load flow problem is solved by Newton’s method using (8.58) with no 
reactive compensation at node 3, assuming transmission lines only. The solution is 
shown in Figure 8.26.
Data for elements
Nelem =    2  Nnod =    3
Elem    Nsal  Nlleg     r        x             ykm                 ysh
   1     2      1    0.0500    0.1000    4.0000+j -8.0000    0.0000+j  0.0000
   2     2      3    0.0100    0.1000    0.9901+j -9.9010    0.0000+j  0.0000
   3     1      2    0.0500    0.1000    4.0000+j -8.0000    0.0000+j  0.0000
   4     3      2    0.0100    0.1000    0.9901+j -9.9010    0.0000+j  0.0000
Data for nodes
Nodo    tipo     V       angle     PG        QG        PL        QL
   1     0     1.0000    0.0000     0.0000    0.0000    0.0000    0.0000
   2    -1     1.0000    0.0000     0.0000    0.0000    0.2500    0.2000
   3     1     1.1338    0.0000     0.0000    0.0000    0.0200    0.0000
Flows through elements
Elem    Nsal  Nlleg     skm
   1     2      1    0.0000+j  0.0000
   2     2      3   -0.1325+j -1.3248
   3     1      2    0.0000+j  0.0000
   4     3      2    0.1502+j  1.5020
Iteration =    0    max Mismatch = 1.124752e+000
Iteration =    1    max Mismatch = 8.044233e-002
Iteration =    2    max Mismatch = 3.069485e-004
Iteration =    3    max Mismatch = 4.592218e-009
Nodal results
Node    type     Voltage      angle      PG        QG        PL        QL
 1       0      1.0000      -0.0000      0.3016   -0.6328    0.0000    0.0000
 2      -1      1.0500      -3.3742     -0.0000   -0.0000    0.2500    0.2000
 3       1      1.1338      -3.9289      0.0000    0.9525    0.0200    0.0000
Load flow results
Elem    type    Nsal    Nlleg     pkm        qkm
Figure 8.25  Three-node system to illustrate the incremental equations. 

8.8	
Voltage Source Converter (VSC) and STATCOM
287
  1       0      2        1     -0.2771     0.6819
  2       0      2        3      0.0271    -0.8819
  3       0      1        2      0.3016    -0.6328
  4       0      3        2     -0.0200     0.9525
8.8	
Voltage Source Converter (VSC) and STATCOM
An equivalent circuit is used to represent the VSC with a complex power trans-
former a series and a shunt admittance, as in Figure 8.27. The tap magnitude ⎪t⎪ 
will represent the amplitude modulation index m′a. The phase shifting angle τ can 
be adjusted so that the current is in phase with the voltage and no reactive power is 
required; this concept is used to identify this portion of the circuit as of DC type. 
Relations (8.59) are recognized for a two-level, three-phase VSC, and operated in 
the linear range of modulation. En,DC is analogous to a DC voltage with value √2. 
To characterize a STATCOM, a series OLTC transformer is needed and is con-
nected from node n to node k (see Figure 8.27). The following values (8.59) do not 
Figure 8.26  System for load flow studies. 
Figure 8.27  Equivalent circuit for a VSC, DC analogy, and AC circuit with a complex 
transformer.

288
Real and Reactive Power and Frequency Control
consider overmodulation, which with proper handling of harmonics would increase 
the usage of the DC link with no distortion on currents and line to line voltages.
	
t =
′
ma =
3
2ma
     0 < ma < 1     t = f 	
(8.59)
8.8.1	 Incremental Model for the VSC
We present the main components of the VSC.
From Figure 8.28 and prior to the solution process, it is recognized that an ideal 
complex transformer is connected from node 3 to 4. At this point, the result for 
voltage and current in an ideal complex transformer is applied. The conductance 
G0 connected at node 4 requires only real power; the reactive power due to bsh is 
calculated using (8.60).
	
q30 = −V3
2 bsh 	
(8.60)
The solution should be such that the voltage magnitude at node 2 is controlled to a 
fixed value. The unknowns are nodal angles: θ2, θ3, voltage magnitude for V3, and 
the value of bsh; this susceptance element is required to keep the voltage at node 2 
at the requested value. The real and reactive nodal balances are a set of nonlinear 
equations (8.62). When the iterative process converges, the vales for τ = θ3 and ⎪t⎪ 
are calculated by (8.61).
	
!V4 t ∠t =
!V3 ∠q3 	
(8.61)
	
+Δp21 + Δp23 = ΔP2
+Δp32 + Δp34 = +Δp32 = ΔP3  as p34 = cte.
+Δq21 + Δq23 = ΔQ2
+Δq32 + Δq34 + Δq30 = +Δq32 + Δq30 = ΔQ3  as q34 = 0
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(8.62)
Figure 8.28  VSC system configuration.

8.8	
Voltage Source Converter (VSC) and STATCOM
289
The incremental model is a Newton’s algorithm that is used to solve for corrections 
to the state variables: nodal angles, voltage magnitude, and compensating suscep-
tance. The incremental set (8.62) requires partial derivatives for q30 and ΔP’s values. 
The solution starts with initial values for variables θ2, θ3, ⎪V3⎪, and bsh.
	
Δq30 = ∂q30
∂V3
V3
Δ V3
V3
+ ∂q30
∂bsh
Δbsh 	
(8.63)
	
∂q30
∂V3
V3 = −2 V3
2 bsh 	
(8.64)
	
∂q30
∂bsh
= −V3
2 	
(8.65)
After three iterations, the maximum mismatch is 5.46e–009. The voltage at node 
2 is kept at a value of 1.05 pu and the shunt capacitive susceptance required is bsh = 
0.7408 pu. The voltage for node 3 is 1.1338 and the angle is −3.93 degrees; the tap 
value in the complex transformer is 1.1338/1.4142 = 0.8017 and the phase shifting 
angle is −3.93 degrees. Losses of 2% are represented by the shunt conductance at 
node 4. One additional possibility is to include a resistive shunt branch at node 3; 
its value might be determined by an open circuit test for the VSC configuration.
Data for elements
Nelem =    2  Nnod =    3
Elem    Nsal  Nlleg     r        x             ykm                 ysh
   1     2      1    0.0500    0.1000    4.0000+j -8.0000    0.0000+j  0.0000
   2     2      3    0.0100    0.1000    0.9901+j -9.9010    0.0000+j  0.0000
   3     1      2    0.0500    0.1000    4.0000+j -8.0000    0.0000+j  0.0000
   4     3      2    0.0100    0.1000    0.9901+j -9.9010    0.0000+j  0.0000
Data for nodes
Node    type     V       angle     PG        QG        PL        QL
   1     0     1.0000    0.0000     0.0000    0.0000    0.0000    0.0000
   2     1     1.0500    0.0000     0.0000    0.0000    0.2500    0.2000
   3    -1     1.0000    0.0000     0.0000    0.0000    0.0200    0.0000
Data for bshunt
Nodes =    3  bshunt0 =   0.5000
Flows through elements
Elem    Nsal  Nlleg       skm
   1     2      1    0.2100+j  0.4200
   2     2      3    0.0520+j  0.5198
   3     1      2   -0.2000+j -0.4000
   4     3      2   -0.0495+j -0.4950
Iteration =    0    max mismatch = 1.139802e+000
Iteration =    1    max mismatch = 1.307479e-001

290
Real and Reactive Power and Frequency Control
Iteration =    2    max mismatch = 6.236311e-004
Iteration =    3    max mismatch = 5.463104e-009
Nodal results
Node    type    Voltage      angle      PG        QG        PL        QL
  1      0      1.0000      -0.0000      0.3016   -0.6326    0.0000    0.0000
  2      1      1.0500      -3.3738      0.0000    0.0000    0.2500    0.2000
  3     -1      1.1338      -3.9284     -0.0000    0.9523    0.0200    0.0000
Load flow results
Elem    type    Nsal    Nlleg     pkm        qkm
  1       0      2        1     -0.2771     0.6817
  2       0      2        3      0.0271    -0.8817
  3       0      1        2      0.3016    -0.6326
  4       0      3        2     -0.0200     0.9523
Results for the VSC
bshunt =   0.7408 (>0 capacitive)  power q to the node =  -0.9523
maprim =   0.8017 tao =  -3.9284    ma =  0.9257
8.9	
Extensions to the Model
The incremental model can be applied to various practical power net-
work configurations.
8.9.1	
Reactive Power and Voltage Control
Example 8.11
With a variable shunt susceptance at node 3 in the configuration shown in Figure 
8.29, voltage control on node 2 and the real power to be supplied to node 4 as 
0.005 pu, the reactive power flow into the system can be controlled according to 
the operational needs in the power system. Assuming that the voltage for node 2 
should be fixed at 0.95 pu, the iterative process shows convergence at three iterations 
with a mismatch of 9.841e–12. The inductive compensation required is 0.1682 pu, 
Figure 8.29  VSC system configuration for voltage control. 

8.9	
Extensions to the Model
291
and it is noted that the current flowing through the VSC has a low value; internal 
losses are quite small, 0.05%.
Data for elements
Nelem =    2  Nnod =    3
Elem    Nsal  Nlleg     r        x             ykm                 ysh
   1     2      1    0.0500    0.1000    4.0000+j -8.0000    0.0000+j  0.0000
   2     2      3    0.0100    0.1000    0.9901+j -9.9010    0.0000+j  0.0000
   3     1      2    0.0500    0.1000    4.0000+j -8.0000    0.0000+j  0.0000
   4     3      2    0.0100    0.1000    0.9901+j -9.9010    0.0000+j  0.0000
Data for nodes
Node    type     V       angle     PG        QG        PL        QL
   1     0     1.0000    0.0000     0.0000    0.0000    0.0000    0.0000
   2     1     0.9500    0.0000     0.0000    0.0000    0.2500    0.2000
   3    -1     1.0000    0.0000     0.0000    0.0000    0.0005    0.0000
Bshunt Data
Node =    3  bshunt0 =   0.5000
Flows through elements
Elem    Nsal  Nlleg     skm
   1     2      1   -0.1900+j -0.3800
   2     2      3   -0.0470+j -0.4703
   3     1      2    0.2000+j  0.4000
   4     3      2    0.0495+j  0.4950
Iteration =    0  max mismatch = 6.502970e-001
Iteration =    1  max mismatch = 3.886674e-002
Iteration =    2  max mismatch = 1.790303e-005
Iteration =    3  max mismatch = 9.841572e-012
Nodal Results
Node    type    Voltage    angle      PG       QG       PL       QL
 1       0      1.0000    -0.0000   0.2610   0.3698   0.0000   0.0000
 2       1      0.9500    -0.4589   0.0000   0.0000   0.2500   0.2000
 3      -1      0.9343    -0.3673   0.0000   -0.1469  0.0005   0.0000
Flow results
Elem    type    Nsal    Nlleg     pkm        qkm
  1       0      2        1     -0.2507    -0.3493
  2       0      2        3      0.0007     0.1493
  3       0      1        2      0.2610     0.3698
  4       0      3        2     -0.0005    -0.1469
Figure 8.30  VSC system configuration for voltage control. 

292
Real and Reactive Power and Frequency Control
Results for the VSC
bshunt =  -0.1682 (>0 capacitive)  power q into node =   0.1469
maprim =   0.6606 tao =  -0.3673    ma =  0.7628
8.9.2	 DC Load
Example 8.12
It is interesting to extend the case so that DC load is supplied at node 4; this is a 
common situation in a practical configuration. It is like a back-to-back arrangement 
that interconnects two AC power systems with the same or with different frequen-
cies. For a DC load of 0.5318 pu, corresponding G0 = 0.2659 pu. The mismatch is 
3.004e–07 in three iterations.
Iteration =    3  Max mismatch = 3.004665e-007
Nodal results
Node   type   Voltage    angle      PG       QG       PL       QL
 1      0     1.0000    -0.0000    0.8723  -0.8554   0.0000   0.0000
 2      1     1.0500    -7.1120   -0.0000  -0.0000   0.2500   0.2000
 3     -1     1.1613   -10.2532    0.0000   1.3635   0.5318   0.0000
Flow results
Elem    type    Nsal    Nlleg     pkm        qkm
  1       0      2        1     -0.7977     1.0046
  2       0      2        3      0.5477    -1.2046
  3       0      1        2      0.8723    -0.8554
  4       0      3        2     -0.5318     1.3635
Results for the VSC
bshunt =   1.0111 (>0 capacitive)  power q into node =  -1.3635
maprim =   0.8211 tao = -10.2532    ma =  0.9482   G0=  0.2659 pu
8.10	 STATCOM Model
To have a representation for the STATCOM, a load tap changing transformer 
(OLTC) is needed in series to the VSC circuit from Section 8.8.1.
8.10.1	 OLTC’s Real and Reactive Power Flows
Let us assume a balanced configuration so the positive sequence of a transformer 
with a tap changing under load, as shown in Figure 8.31, will be part of the STAT-
COM. Power flow equations and the partial derivatives for the incremental model 
use τ = 0, ysh,k = ysh,m = 0 and ⎪t⎪ within bounds (see Figure 8.30).
Example 8.12
A modified network to represent an STATCOM includes an OLTC, the model uses 
⎪t⎪ =1.1335, constrained to be within bounds 0.8 < ⎪t⎪ < 1.2, series impedance rT 
= 0.01 and xT = 0.10 in pu. The voltage at node 2 will be fixed to 1.05 pu. Conver-
gence shows a mismatch of 4.334e–007 in 3 iterations (see Figure 8.31).

8.10	
STATCOM Model
293
Data for elements
Nelem =    2  Nnod =    3
Elem    Nsal  Nlleg     r        x             ykm                 ysh
   1     2      1    0.0500    0.1000    4.0000+j -8.0000    0.0000+j  0.0000
   2     2      3    0.0100    0.1000    0.9901+j -9.9010    1.1335+j  0.0000
   3     1      2    0.0500    0.1000    4.0000+j -8.0000    0.0000+j  0.0000
   4     3      2    0.0100    0.1000    0.9901+j -9.9010    1.1335+j  0.0000
Data for nods
Node  type    V        angle     PG        QG        PL        QL
  1     0    1.0000   0.0000    0.0000    0.0000    0.0000    0.0000
  2     1    1.0500   0.0000    0.0000    0.0000    0.2500    0.2000
  3    -1    1.0000   0.0000    0.0000    0.0000    0.0249    0.0000
Data for the bshunt
Node =    3  bshunt0 =   0.5000
Flows in elements
Elem    Nsal  Nlleg        skm
   1     2      1    0.2100+j  0.4200
   2     2      3    0.2241+j  2.2410
   3     1      2   -0.2000+j -0.4000
   4     3      2   -0.1883+j -1.8829
Iteration =    0  Max mismatch = 2.861005e+000
Iteration =    1  Max mismatch = 9.628746e-001
Iteration =    2  Max mismatch = 5.902866e-003
Iteration =    3  Max mismatch = 4.334714e-007
Nodal results
Node    type    Voltage     angle      PG        QG        PL        QL
  1      0      1.0000     -0.0000     0.3052   -0.6341    0.0000    0.0000
  2      1      1.0500     -3.3975    -0.0000    0.0000    0.2500    0.2000
  3     -1      1.2642     -3.8498    -0.0000    0.9389    0.0249    0.0000
Load flow results
Elem    type   Nsal    Nlleg     pkm        qkm
  1      0      2        1     -0.2804     0.6837
  2      1      2        3      0.0304    -0.8837
  3      0      1        2      0.3052    -0.6341
  4      1      3        2     -0.0249     0.9389
Figure 8.31  Complex power transformer for OLTC configuration.

294
Real and Reactive Power and Frequency Control
Results for the VSC
bshunt =   0.5874 (>0 capacitive)  power q into node =  -0.9389
maprim =   0.8939 tao =  -3.8498    ma =  1.0322   G0= 0.01245 pu
Next, the STATCOM (see Figure 8.32) is connected at node 9 of a 14-node system 
(see Figure 8.33); it will replace the capacitor compensation for the base case. The 
Figure 8.32  STATCOM configuration for voltage control. 
Figure 8.33  STATCOM voltage control and reactive power injection at node 9. 

8.11	
Chapter Summary
295
STATCOM is connected at node 9. Two additional nodes are required, 15 and 16, 
and the iterative process shows good convergence.
8.11	 Chapter Summary
The material in this chapter covers real power control and reactive power, first 
with a static model, which is valid for small changes around the operating point. 
We introduced modeling and analysis for simple circuit arrangements in order to 
approach step-by-step the problem of optimal control coordination. This can be 
done for real power flows and existing control, as well as for reactive power and 
voltage related control problems. The discussion cannot be complete unless turbine 
response and its controls are included. This is done by working with the reasonable 
assumption that the relation between rotor speed, frequency and real power as sup-
plied by the turbine and the power required by the load in the system. More should 
be said about the control problem, and the models with which we include turbine, 
governor, droop, and other extensions into the realm of interarea assistance during 
disturbances in neighboring areas.
In the last part of this chapter, rotor dynamics were given. It should be noted 
that an error frequency is present. This points to the need of additional feedback 
control to be included so that the system’s frequency error will eventually be reduced 
to zero through an integral control action. We included (without much discussion) 
transfer functions and the SIMULINK® environment; this was done in order to 
have a glimpse about the type of dynamic response and to have an idea about the 
time constant for this kind of processes, VSC and STATCOM models were discussed 
using a complex transformer model.
References
[1]	
Stagg, G., and A. El-Abiad, Computer Methods in Power System Analysis, New York: 
McGraw-Hill, 1968.
[2]	
Brown, H. E., Solution of Large Networks by Matrix Methods, New York: John Wiley 
& Sons, 1975.
[3]	
Shipley, R. B., Introduction to Matrices and Power Systems, New York: John Wiley & 
Sons, 1976.
[4]	
Miller, T. J. E., Reactive Power Control in Electric Systems, New York: John Wiley & 
Sons, 1982.


297
C h a p t e r  9
General Fault Studies in Electrical Power 
Systems
9.1	
Introduction
Fault studies in electrical systems are required to find out the values of the electrical 
currents that flow when undesired circuit connections are present. The estimation 
of the high value currents that flow under fault conditions allows the protection 
engineer to establish the setting for the protective equipment, select circuit breaker 
capabilities, and to make an assessment on how the fault condition affects the whole 
system. Various types of faults might occur; these might include several phases and 
ground. A general fault equation can be very useful, and such equation can treat 
various shunt or series fault connections that make up the undesired electrical 
connection. There are various frames of reference that can be used (i.e., abc phase 
coordinates or symmetrical components, just to name the most frequently used).
9.2	
Fault Equation in Phase Coordinates abc
In order to write the calculation procedure, let us assume that a network equiva-
lent (Thévenin) is available for the left side, as shown in Figure 9.1. For the right 
side, we can draw and write a nodal admittance fault. Shown in Figure 9.1 are the 
boundary conditions for nodal voltages and currents into the system and into the 
fault, (9.1) and (9.2).
When the electric fault is present at the connection point F, the three-phase nodal 
voltages and currents abc must comply with the boundary conditions expressed as:
Figure 9.1  System’s Thévenin equivalent and admittance fault connection YF
abc.

298
General Fault Studies in Electrical Power Systems
	
Vabc = Vabc
F 	
(9.1)
	
Iabc = −Iabc
F 	
(9.2)
Thévenin’s network equivalent and the fault connection equations are:
	
Vabc = Vabc
F
= Eabc
Th + Zabc
Th Iabc 	
(9.3)
	
Yabc
F Vabc
F
= Iabc
F 	
(9.4)
To calculate the fault current, various forms can be obtained; one by substitution 
of (9.3) on the left of (9.4). Recognizing that voltages at ​the boundary are equal, U 
is a unit matrix.
	
 Yabc
F
Eabc
Th −Zabc
Th Iabc
F
(
) = Iabc
F
	
(9.5)
	
Iabc
F
= U + Yabc
F Zabc
Th
(
)
−1Yabc
F Eabc
Th 	
(9.6)
A different expression can be derived if the fault impedance matrix ZF
abc is written.
	
Vabc = Eabc
Th + Zabc
Th Iabc 	
(9.7)
	
Vabc
F
= Zabc
F Iabc
F
	
(9.8)
	
Eabc
Th −Zabc
Th Iabc
F
= Zabc
F Iabc
F 	
(9.9)
	
Iabc
F
= Zabc
F
+ Zabc
Th
(
)
−1 Eabc
Th 	
(9.10)
The fault current is IF
abc by (9.5) or (9.10). We apply the fault current value back to 
the network, into the left in Figure 9.1. With this step, we find out what the nodal 
voltages are when the fault current is engaged.
9.3	
Fault Equation in Coordinates 012
Symmetrical components, or coordinates 012, are widely used by power system 
engineers to represent a three-phase, symmetrically balanced power system. The 
fault circuit itself might impose an unbalanced condition, and we assume that the 
symmetrical component representation for the fault connection is available.
In the 012 symmetrical components reference, Thévenin’s system equivalent 
and the fault circuit equation are:

9.3	
Fault Equation in Coordinates 012
299
	
V012 = E012
Th + Z012
Th I012 	
(9.11)
	
Y012
F V012
F
= I012
F
	
(9.12)
Recognizing that at the electrical boundary V012 = VF
012, then:
	
I012
F
= U + Y012
F Z012
Th
(
)
−1Y012
F E012
Th 	
(9.13)
An alternative is to use the fault impedance matrix in the symmetrical components 
reference ZF
012.
	
I012
F
= Z012
Th + Z012
F
(
)
−1 E012
Th 	
(9.14)
Figure 9.2  System’s Thévenin equivalents and a fault matrix connection YF
012.
Figure 9.3  Three-phase fault connections.

300
General Fault Studies in Electrical Power Systems
9.3.1	
Three-Phase Fault
To illustrate the step in a general solution, let us assume the following three-phase 
fault configuration:
The nodal impedance matrix in the abc reference for this type of fault and its 
symmetrical 012 components are shown as (9.15) and (9.16) (see Figure 9.3).
	
Zabc
F
=
zf + zg
zg
zg
zg
zf + zg
zg
zg
zg
zf + zg
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(9.15)
	
Z012
F
= TS
−1Zabc
F TS =
zf + 3zg
0
0
0
zf
0
0
0
zf
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(9.16)
Where α = 1∠120°, α2 = 1∠240°
	
TS =
1
1
1
1 a2
a
1
a
a2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
TS
−1 = 1
3
1
1
1
1
a
a2
1 a2
a
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	
(9.17)
We use (9.6) to calculate the abc fault current information or (9.10) to find the 012 
fault current.
Example 9.1
Assume a Thévenin’s equivalent for a balanced three-phase system as in Figure 9.2 
and a fault impedance matrix abc as shown in Figure 9.3. Let us find the fault cur-
rent and the abc voltages at the connecting node. Values are in pu.
Iabc
F
= Zabc
Th + Zabc
F
(
)
−1 Eabc
Th =
z
m m
m
z
m
m m
z
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥+
zf + zg
zg
zg
zg
zf + zg
zg
zg
zg
zf + zg
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎛
⎝
⎜
⎜
⎜
⎞
⎠
⎟
⎟
⎟
−1
Ea
Th
Eb
Th
Ec
Th
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	 (9.18)
Thevenin’s Equivalent matrix, abc
Zthabc =
   0.0100 + 0.1000i        0 - 0.0500i        0 - 0.0500i
        0 - 0.0500i   0.0100 + 0.1000i        0 - 0.0500i
        0 - 0.0500i        0 - 0.0500i   0.0100 + 0.1000i
Fault impedances zf = 0.01000+j 0.10000   zg = 0.00000+j 0.01000
ZFabc =
   0.0100 + 0.1100i        0 + 0.0100i        0 + 0.0100i
        0 + 0.0100i   0.0100 + 0.1100i        0 + 0.0100i
        0 + 0.0100i        0 + 0.0100i   0.0100 + 0.1100i

9.3	
Fault Equation in Coordinates 012
301
Thevenin’s Voltage, abc
Voltage Etha = 1.00000     +0.00
Voltage Ethb = 1.00000   -120.00
Voltage Ethc = 1.00000   +120.00
Fault current, abc
Current IFa = 3.98726    -85.43
Current IFb = 3.98726   +154.57
Current IFc = 3.98726    +34.57
Voltage at fault node, abc
Voltage VFa = 0.40071     -1.14
Voltage VFb = 0.40071   -121.14
Voltage VFc = 0.40071   +118.86
Phasors results are shown in Figure 9.4, as are the magnitude and angle for Thévenin’s 
voltages and fault currents. Note that the fault current magnitude is close to 4 pu 
and lags the voltage by an angle close to 90°.
To solve the fault current problems, power system engineers routinely use sym-
metrical components. The information required is the fault impedance or admit-
tance and the system’s sequence impedances, as well as the positive sequence of 
Thévenin’s voltage source.
I012
F
= Z012
Th + Z012
F
(
)
−1 E012
Th =
Z0
Th
0
0
0
Z1
Th
0
0
0
Z2
Th
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
+
Z0
F
0
0
0
Z1
F
0
0
0
Z2
F
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎛
⎝
⎜
⎜
⎜
⎞
⎠
⎟
⎟
⎟
−1
0
E1
Th
0
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(9.19)
	
I012
F
=
I0
F
I1
F
I2
F
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
0
E1
Th
Z1
Th + Z1
F
0
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(9.20)
Figure 9.4  Thévenin’s voltages and fault current in abc reference.

302
General Fault Studies in Electrical Power Systems
A particular case is a solid three-phase fault with Z1
F = 0. In this case (see Figure 9.5):
	
I012
F
=
I0
F
I1
F
I2
F
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
0
E1
Th
Z1
Th
0
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(9.21)
Thevenin’s Equivalent matrix, 012
Zth012 =
   0.0100             0.0000 + 0.0000i   0.0000 - 0.0000i
  -0.0000             0.0100 + 0.1500i   0.0000 + 0.0000i
        0 + 0.0000i   0.0000 - 0.0000i   0.0100 + 0.1500i
Fault impedances zf = 0.01000+j 0.10000   zg = 0.00000+j 0.01000
ZF012 =
   0.0100 + 0.1300i  -0.0000 + 0.0000i  -0.0000 - 0.0000i
  -0.0000 - 0.0000i   0.0100 + 0.1000i   0.0000 + 0.0000i
        0 + 0.0000i   0.0000 - 0.0000i   0.0100 + 0.1000i
Thevenin’s Voltage, 012
Voltage Eth0 = 0.00000     +0.00
Voltage Eth1 = 1.00000     -0.00
Voltage Eth2 = 0.00000    +90.00
Fault current, 012
Current IF0 = 0.00000    -92.38
Current IF1 = 3.98726    -85.43
Current IF2 = 0.00000     +0.46
Voltage at fault node, 012
Voltage VF0 = 0.00000    +15.58
Voltage VF1 = 0.40071     -1.14
Voltage VF2 = 0.00000    +87.14
Figure 9.5  Thévenin’s voltages and fault current, in the 012 references. 

9.3	
Fault Equation in Coordinates 012
303
The values calculated using the sequence domain 012 can be transformed into the 
original abc frame of reference using the inverse transformation. The results are the 
same as the ones obtained if we work directly in the abc phases.
Example 9.2
With values in pu, the calculation of fault currents for a power network is simpli-
fied using the Thévenin’s equivalent, as seen from the faulted node. Let us illustrate 
the procedure for a fault at bus 3 using Figure 9.6. The data shown in Table 9.1.
To study fault currents in a power system, we start with a list of elements and how 
they are connected. Special care is required in order to properly represent trans-
former’s connections; for example, in delta connections there is a infinite impedance 
to the zero sequence current. One artifice that allows us to have the same network 
structure for both the positive and the zero sequence networks is through the inclu-
sion of a fictitious node. Using this auxiliary node, we split both the positive and 
the zero sequence impedances for the transformer. In Figure 9.7, nodes 5 and 6 are 
Figure 9.6  One-line diagrams for a three-phase power network.
Table 9.1  Sequence Data for Elements in Figure 9.6 (values in pu) 
Element
x(+)
x(−)
x(0)
Neutral
Generator 1
0.1512
0.10
0.050
0.30
Generator 2
0.1457
0.09
0.045
0.15
Transformer 1
0.08
0.08
0.08
0.0
Transformer 2
0.15
0.15
0.15
0.0
Motor 1
0.25
0.20
0.07
0.30
Motor 2
0.50
0.42
0.10
∞
T. Line 1
0.17
0.17
0.51
Figure 9.7  Positive sequence connection, impedance values in pu.

304
General Fault Studies in Electrical Power Systems
not actual system nodes; using these auxiliary nodes it helps us to have the same 
number of nodes for the positive, the negative (see Figure 9.8), and the zero sequence 
(see Figure 9.9) networks.
Positive sequence Zbus
Elements =    5    Nodes =    6    Shunts =    6
Element    from      to          z(pu)
     1       1       5      0.0000+j  0.0400
     2       5       2      0.0000+j  0.0400
     3       2       3      0.0000+j  0.1700
     4       3       6      0.0000+j  0.0750
     5       6       4      0.0000+j  0.0750
Shunt    at node        z(pu)
     1       1    0.0000+j  0.1512
     2       1    0.0000+j  0.1457
     3       5       Inf+j  0.0000
     4       6       Inf+j  0.0000
     5       4    0.0000+j  0.5000
     6       4    0.0000+j  0.2500
Z(+) = Columns 1 through 6
0 + 0.0656i  0 + 0.0563i  0 + 0.0367i  0 + 0.0193i  0 + 0.0610i  0 + 0.0280i
0 + 0.0563i  0 + 0.1171i  0 + 0.0762i  0 + 0.0401i  0 + 0.0867i  0 + 0.0581i
0 + 0.0367i  0 + 0.0762i  0 + 0.1602i  0 + 0.0843i  0 + 0.0564i  0 + 0.1223i
0 + 0.0193i  0 + 0.0401i  0 + 0.0843i  0 + 0.1233i  0 + 0.0297i  0 + 0.1038i
0 + 0.0610i  0 + 0.0867i  0 + 0.0564i  0 + 0.0297i  0 + 0.0938i  0 + 0.0431i
0 + 0.0280i  0 + 0.0581i  0 + 0.1223i  0 + 0.1038i  0 + 0.0431i  0 + 0.1505i
To calculate the fault current at node 3 we need information of the Thévenin’s 
equivalent impedance for the network as seen at this node. For generator’s posi-
tive sequence impedance will have a value that depends on the time at which 
the fault current is calculated; for a physical explanation see Section 9.7. For a 
fault calculated within two to four cycles, the subtransient reactance x″ must be 
included. For a fault current calculation at five to eight cycles, we need to consider 
the transient reactance x′, and for longer periods, the synchronous reactance xs. 
Rotating machines might have positive and negative sequence reactance with a 
slightly different value.
Figure 9.8  Negative sequence connections. 

9.3	
Fault Equation in Coordinates 012
305
Negative sequence Zbus
Elements =    5    Nodes =    6    Shunts =    6
Element    from      to          z(pu)
     1       1       5      0.0000+j  0.0400
     2       5       2      0.0000+j  0.0400
     3       2       3      0.0000+j  0.1700
     4       3       6      0.0000+j  0.0750
     5       6       4      0.0000+j  0.0750
Shunt    at node        z(pu)
     1       1    0.0000+j  0.1000
     2       1    0.0000+j  0.0900
     3       5       Inf+j  0.0000
     4       6       Inf+j  0.0000
     5       4    0.0000+j  0.4200
     6       4    0.0000+j  0.2000
Z(-) = Columns 1 through 6
0 + 0.0435i  0 + 0.0370i  0 + 0.0232i  0 + 0.0110i  0 + 0.0403i  0 + 0.0171i
0 + 0.0370i  0 + 0.0995i  0 + 0.0624i  0 + 0.0296i  0 + 0.0683i  0 + 0.0460i
0 + 0.0232i  0 + 0.0624i  0 + 0.1457i  0 + 0.0691i  0 + 0.0428i  0 + 0.1074i
0 + 0.0110i  0 + 0.0296i  0 + 0.0691i  0 + 0.1040i  0 + 0.0203i  0 + 0.0866i
0 + 0.0403i  0 + 0.0683i  0 + 0.0428i  0 + 0.0203i  0 + 0.0743i  0 + 0.0316i
0 + 0.0171i  0 + 0.0460i  0 + 0.1074i  0 + 0.0866i  0 + 0.0316i  0 + 0.1345i
Zero sequence Zbus
Elements =    5    Nodes =    6    Shunts =    6
Element    from      to          z(pu)
     1       1       5         Inf+j  0.0000
     2       5       2      0.0000+j  0.0400
     3       2       3      0.0000+j  0.5100
     4       3       6      0.0000+j  0.0750
     5       6       4         Inf+j  0.0000
Shunt    at node        z(pu)
     1       1    0.0000+j  0.9500
     2       1    0.0000+j  0.4950
     3       5    0.0000+j  0.0400
     4       6    0.0000+j  0.0750
     5       4       Inf+j  0.1000
     6       4    0.0000+j  0.9700
Figure 9.9  Zero sequence network. 

306
General Fault Studies in Electrical Power Systems
Z(zero) = Columns 1 through 6
0 + 0.3254i  0            0            0            0            0
0            0 + 0.0714i  0 + 0.0162i  0            0 + 0.0357i  0 + 0.0081i
0            0 + 0.0162i  0 + 0.1196i  0            0 + 0.0081i  0 + 0.0598i
0            0            0            0 + 0.9700i  0            0
0            0 + 0.0357i  0 + 0.0081i  0            0 + 0.0378i  0 + 0.0041i
0            0 + 0.0081i  0 + 0.0598i  0            0 + 0.0041i  0 + 0.0674i
Consider a three-phase fault at node 3 with fault impedance abc as in (9.15); in 
case of an open connection, the impedance will be infinite or with zero admittance 
value. Usually, load currents are small when compared to the larger fault currents; 
therefore, load currents are neglected. Let us use the following pu values to calcu-
late a three-phase fault where Zf = j0.0, Zg = j0.05, Z3
Th0 = j0.1196, Z3
Th+ = j0.1602 
and Z3
Th– = j0.1457.
Thevenin’s Equivalent matrix, 012
ZTh012 =
        0 + 0.1196i        0                  0          
        0                  0 + 0.1602i        0          
        0                  0                  0 + 0.1457i
Fault impedances zf =   0.0000+ j  0.0000   zg =   0.0000+ j  0.0500
ZF012 =
   0.0000 + 0.1500i  -0.0000            -0.0000 - 0.0000i
  -0.0000 - 0.0000i   0.0000 - 0.0000i   0.0000 - 0.0000i
  -0.0000 - 0.0000i   0.0000 - 0.0000i   0.0000 - 0.0000i
Thevenin’s voltage source, 012
Voltage ETh0 =   0.0000       0.00
Voltage ETh1 =   1.0000       0.00
Voltage ETh2 =   0.0000       0.00
Fault current, 012
Current IF0  =   0.0000    -180.00
Current IF1  =   6.2422     -90.00
Current IF2  =   0.0000     -39.70
Voltage at faulted node, 012
Voltage VF0  =   0.0000      90.00
Voltage VF1  =   0.0000     -90.00
Voltage VF2  =   0.0000    -129.70
Thevenin’s voltage source, abc
Voltage ETha =   1.0000       0.00
Voltage EThb =   1.0000    -120.00
Voltage EThc =   1.0000     120.00
Fault current, abc
Current IFa  =   6.2422     -90.00
Current IFb  =   6.2422     150.00
Current IFc  =   6.2422      30.00

9.3	
Fault Equation in Coordinates 012
307
Voltage at faulted node, abc
Current VFa  =   0.0000      90.00
Current VFb  =   0.0000      90.00
Current VFc  =   0.0000      90.00
A well-known result for three-phase faults gives previous results in the frame of 
reference 012.
	
I012
F
=
I0
F
I1
F
I2
F
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
0
1∠0°
j0.1602
0
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
0
6.2422∠−90°
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	
(9.22)
Once the fault current is calculated, a negative value of the fault current is injected 
into node 3 in the original network for each sequence (in this case, zero and nega-
tive currents are zero). The effect from this current injection is a change in nodal 
voltages; these changes added to the voltage values before the fault condition will 
give the new voltage values when the fault is present.
Magnitude of Nodal voltages with fault present, node 3
Vnew =
    0.7711
    0.5244
    0.0000
    0.4737
    0.6478
    0.2369
9.3.2	 Other Types of Shunt Faults
Sections 9.2 and 9.3.1 discussed the general but basic formulation in abc and 012 
sequence frame of reference as a particular case for the three-phase fault. Other fault 
configurations might include two lines and Earth or single-phase. In general, unbal-
anced faults might not include Earth, as is the case of a fault between two phases 
with no connection to ground. Equations (9.13) and (9.6) can solve the problem; 
the advantage of (9.13) is that in some fault connections the 012 admittances are 
not directly obtained, but the fault admittance in reference abc can be written and 
then transformed into the domain 012 so that the formula can be applied.
Example 9.3
Write the fault admittance matrix 012 for Figure 9.10. For this fault connection, 
find the fault current at node 3 in Example 9.2. Use the following per unit values: 
zf = 0.0 + 0.1j; zg = 0.05j.
First, we write the fault admittance matrix abc. We then calculate the 012 matrix; 
the result has a nondiagonal form, which implies that the sequence networks are 
interconnected due to the fault.

308
General Fault Studies in Electrical Power Systems
	
I012
F
= U + Y012
F Z012
Th
(
)
−1Y012
F E012
Th 	
(9.23)
YFabcn =
0 -10.0000i      0                0          0 +10.0000i
0                0 -10.0000i      0          0 +10.0000i
0                0                0          0          
0 +10.0000i      0 +10.0000i      0          0 -40.0000i
YFabc =
        0 - 7.5000i        0 + 2.5000i        0          
        0 + 2.5000i        0 - 7.5000i        0          
        0                  0                  0          
Thevenin’s Equivalent matrix, 012
ZTh012 =
        0 + 0.1196i        0                  0          
        0                  0 + 0.1602i        0          
        0                  0                  0 + 0.1457i
Fault impedances zf =   0.0000+ j  0.1000   zg =   0.0000+ j  0.0500
YF012 =
  -0.0000 - 3.3333i  -1.4434 - 0.8333i   1.4434 - 0.8333i
   1.4434 - 0.8333i   0.0000 - 5.8333i  -3.6084 - 2.0833i
  -1.4434 - 0.8333i   3.6084 - 2.0833i  -0.0000 - 5.8333i
Thevenin’s voltage source, 012
Voltage ETh0 =   0.0000       0.00
Voltage ETh1 =   1.0000       0.00
Figure 9.10  Unbalanced fault connections.

9.4	
Series Faults
309
Voltage ETh2 =   0.0000       0.00
Fault current, 012
Current IF0  =   0.9792    -150.00
Current IF1  =   2.4523     -90.00
Current IF2  =   1.4730     -30.00
Voltage at faulted node, 012
Voltage VF0  =   0.1171     120.00
Voltage VF1  =   0.6071      -0.00
Voltage VF2  =   0.2146    -120.00
Thevenin’s voltage source, abc
Voltage ETha =   1.0000       0.00
Voltage EThb =   1.0000    -120.00
Voltage EThc =   1.0000     120.00
Fault current, abc
Current IFa  =   3.7032     -83.37
Current IFb  =   3.7032     143.37
Current IFc  =   0.0000     126.87
Voltage at faulted node, abc
Current VFa  =   0.4493     -10.83
Current VFb  =   0.4493    -109.17
Current VFc  =   0.9389     120.00
9.4	
Series Faults
Sections 9.2 and 9.3 have used the general and basic formulation in either the abc 
or the 012 frame of reference for shunt type of faults. Those faults are connected 
to the ground, but there are some variations in electrical connections during a 
fault wherein the ground is not involved; this other type of fault is a series connec-
tion where the matrix can be written in admittance or impedance form. To have a 
Figure 9.11  Series fault connections in the reference frame abc.

310
General Fault Studies in Electrical Power Systems
general discussion, let us start with Thévenin’s equivalent circuits to the left and to 
the right of a series configuration, as shown in Figure 9.11. Assume that the fault 
matrix is written in admittance form in coordinates abc.
The boundary conditions that must be met for voltages at the fault and fault 
currents; Thévenin equivalents for the left and the right hand side allow us to write 
the model.
	
Vabc
A
= Vabc
F,A    and    Vabc
B
= Vabc
F,B
Iabc
A
= −Iabc
F,A
Iabc
B
= −Iabc
F,B 	
(9.24)
	
Yabc
F
Vabc
F,A −Vabc
F,B
(
) = Iabc
F,A
Yabc
F
Vabc
F,B −Vabc
F,A
(
) = Iabc
F,B 	
(9.25)
Here, superscripts A and B are for the system at the left and the system to the right, 
respectively. The superscript F, A and F, B relate to the fault condition for the system 
to the left and for the system to the right, respectively. Our aim is to calculate the 
fault current that flows into each system when the fault admittance is connected.
	
Vabc
A
= Eabc
Th,A + Zabc
Th,AIabc
A
= Eabc
Th,A −Zabc
Th,AIabc
F,A 	
(9.26)
	
Vabc
B
= Eabc
Th,B + Zabc
Th,BIabc
B
= Eabc
Th,B −Zabc
Th,BIabc
F,B 	
(9.27)
From (9.24)
	
Yabc
F
−Yabc
F
−Yabc
F
Yabc
F
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Vabc
F,A
Vabc
F,B
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
Iabc
F,A
Iabc
F,B
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(9.28)
	
Yabc
F
−Yabc
F
−Yabc
F
Yabc
F
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Eabc
Th,A
Eabc
Th,B
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
−
Zabc
Th,A
0
0
Zabc
Th,B
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Iabc
F,A
Iabc
F,B
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
⎛
⎝
⎜⎜
⎞
⎠
⎟⎟=
Iabc
F,A
Iabc
F,B
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	 (9.29)
Iabc
F,A
Iabc
F,B
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
U
0
0 U
⎡
⎣⎢
⎤
⎦⎥+
Yabc
F
−Yabc
F
−Yabc
F
Yabc
F
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Zabc
Th,A
0
0
Zabc
Th,B
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
⎛
⎝
⎜⎜
⎞
⎠
⎟⎟
−1
Yabc
F
−Yabc
F
−Yabc
F
Yabc
F
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Eabc
Th,A
Eabc
Th,B
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥ 

(9.30)
In matrix notation, we find a solution similar to (9.9), but now as applied to the 
series fault connection. The 012-fault equation can be deduced from the abc domain 
with a similar structure; only the notation abc is changed to 012.

9.4	
Series Faults
311
Example 9.4
For the connection given in Figure 9.12, let us use Thévenin equivalents A and B 
and the fault admittance matrix in symmetrical components 012. Find the currents 
that flow when the fault series admittance matrix is inserted (see Figure 9.13).
Thevenin’s Equivalent matrix, 012
ZTh012A =
        0 + 0.3000i        0                  0          
        0                  0 + 0.1000i        0          
        0                  0                  0 + 0.1000i
ZTh012B =
        0 + 0.1500i        0                  0          
        0                  0 + 0.0500i        0          
        0                  0                  0 + 0.0500i
Fault impedances zf =   0.0000+ j  0.1000   zm =   0.0000+ j  0.0100
YF012 =
  -0.0000 - 8.3333i        0 - 0.0000i   0.0000 + 0.0000i
   0.0000 - 0.0000i   0.0000 -11.1111i  -0.0000 - 0.0000i
  -0.0000             0.0000 - 0.0000i   0.0000 -11.1111i
Thevenin’s voltage source A, 012
Voltage ETh0 =   0.0000       0.00
Voltage ETh1 =   1.0000       0.00
Voltage ETh2 =   0.0000       0.00
Thevenin’s voltage source B, 012
Voltage ETh0 =   0.0000       0.00
Voltage ETh1 =   0.9000       0.00
Voltage ETh2 =   0.0000       0.00
Fault current, 012
Current IF0A  =   0.0000     -90.00
Current IF1A  =   0.4167     -90.00
Figure 9.12  Series fault connections frame of reference 012.

312
General Fault Studies in Electrical Power Systems
Current IF2A  =   0.0000     -56.31
Current IF0B  =   0.0000      90.00
Current IF1B  =   0.4167      90.00
Current IF2B  =   0.0000     123.69
IabcA, abc
Current IFa  =   0.4167     -90.00
Current IFb  =   0.4167     150.00
Current IFc  =   0.4167      30.00
IabcB, abc
Current IFa  =   0.4167      90.00
Current IFb  =   0.4167     -30.00
Current IFc  =   0.4167    -150.00
9.5	
Useful Circuit Interpretation for Fault Connections
So far, we have presented and used formulas that are general procedures for fault 
calculations They work well for fault currents and voltage values calculations when 
shunt or series faults are present. Sometimes, a circuit interpretation for a particular 
fault condition helps the engineer to understand and visualize applications of how 
to solve and identify problems; such procedure follows.
9.5.1	
Single-Phase Fault
In a three-phase balanced network when an unexpected connection of phase a to 
the ground (as shown in Figure 9.14), we find that the three sequence currents are 
equal; this condition comes from (9.31). The sequence circuits 012 should be con-
nected in series so that the currents are equal.
	
I0
I1
I2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
= TS
−1
Ia
Ib
Ic
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
= 1
3
1
1
1
1
a
a2
1 a2
a
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Ia
0
0
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
= 1
3
Ia
Ia
Ia
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(9.31)
Figure 9.13  Sequence Phasors, voltages, and fault currents. 

9.5	
Useful Circuit Interpretation for Fault Connections
313
The voltage Va at the fault is given as follows:
	
Va
Vb
Vc
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
1
1
1
1 a2
a
1
a
a2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
V0
V1
V2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
V0 + V1 + V2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(9.32)
	
Va = V0 + V1 + V2 = IazF = 3I1zF 	
(9.33)
A circuit interpretation for (9.33) is shown in Figure 9.15, where I1 =1/3 Ia from 
(9.31). The positive sequence fault current I1 is calculated in the series configura-
tion, as in (9.34).
	
I1 =
ETh
Z1
Th + Z2
Th + Z0
Th + 3zF
	
(9.34)
Figure 9.14  One-phase to ground fault connection, abc reference.
Figure 9.15  Sequence circuits connection for a single-phase fault.

314
General Fault Studies in Electrical Power Systems
Once I1 is calculated, I2 = I0 = I1 so the phase currents abc and voltages are calcu-
lated by (9.26).
	
Ia
Ib
Ic
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
1
1
1
1 a2
a
1
a
a2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
I0
I1
I2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
I0 + I1 + I2
0
0
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
3I1
0
0
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(9.35)
	
V0
V1
V2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
0
ETh
0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥−
Z0
Th
0
0
0
Z1
Th
0
0
0
Z2
Th
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
I0
I1
I2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(9.36)
	
Va
Vb
Vc
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
1
1
1
1 a2
a
1
a
a2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
V0
V1
V2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(9.37)
9.5.2	 Fault Between Two Phases, No Ground
For a three-phase balanced network with an unintended connection of two phases: 
b and c and no connection to the ground (as shown in Figure 9.16) imposes the fol-
lowing boundary conditions.
	
Ia = 0    Ib = −Ic    Vb −Vc = IbzF 	
(9.38)
Zero sequence current is zero. The positive and negative sequence currents are 
related through:
	
I0
I1
I2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
= TS
−1
Ia
Ib
Ic
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
= 1
3
1
1
1
1
a
a2
1 a2
a
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
0
Ib
−Ib
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
= 1
3
0
a −a2
−a −a2
(
)
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
Ib 	
(9.39)
Figure 9.16  Two phases fault, no ground connection in the abc domain. 

9.5	
Useful Circuit Interpretation for Fault Connections
315
	
I1 = 1
3 a −a2
(
)Ib = −I2 	
(9.40)
Phase voltages and sequence quantities are:
	
Va
Vb
Vc
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
1
1
1
1 a2
a
1
a
a2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
V0
V1
V2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(9.41)
	
Vb = V0 + a2V1 + aV2
Vc = V0 + aV1 + a2V2
	
(9.42)
	
Vb −Vc = a2 −a
(
)V1 + α −α 2
(
)V2 = a2 −a
(
) V1 −V2
(
) = zFIb 	
(9.43)
	
V1 −V2
(
) =
zFIb
a2 −a
(
)
=
zF3I1
−a2 −a
(
)
2 = zFI1	
(9.44)
	
V1 = V2 + zFI1	
(9.45)
Using (9.45), an equivalent circuit is drawn; it relates a connection of the positive 
and the negative sequence networks for this type of fault (see Figure 9.17).
The fault current calculation can be done from the circuit connection, sequence 
currents 012 and sequence voltages are determined. Those values are then trans-
formed to the abc domain in order to find the line current flowing during the fault.
Figure 9.17  Fault on two phases, no ground connection in the abc domain. 

316
General Fault Studies in Electrical Power Systems
	
I1 =
ETh
Z1
Th + Z2
Th + zF
	
(9.46)
9.5.3	 Fault Between Two Phases and Ground
For a three-phase balanced network a connection of two phases: b, c, and ground as 
shown in Figure 9.18 has the following boundary conditions in phase voltages. For 
currents: zero sequence is zero, (9.47) give the positive and negative sequence values.
	
Vb = zFIb + zg Ib + Ic
(
)
Vc = zFIc + zg Ib + Ic
(
)
	
(9.47)
	
Ia
Ib
Ic
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
= TS
I0
I1
I2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
1
1
1
1 a2
a
1
a
a2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
I0
I1
I2
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(9.48)
	
Ia = 0 = I0 + I1 + I2
Ib = I0 + a2I1 + aI2
Ic = I0 + aI1 + a2I2
	
(9.49)
Voltage and current relations (see Figure 9.19):
	
Ib −Ic = a2 −a
(
) I1 −I2
(
)
Vb −Vc = zF Ib −Ic
(
) = a2 −a
(
) V1 −V2
(
) = zF a2 −a
(
) I1 −I2
(
)
V1 −V2
(
) = zF I1 −I2
(
)
	
(9.50)
Figure 9.18  Unbalanced fault connection.

9.6	
Alternative Equation for Fault Current Calculation
317
Ib + Ic = 2I0 + a2 −a
(
) I1 + I2
(
) = 2I0 −I1 + I2
(
)
Vb + Vc = zF + 2zg
(
) Ib + Ic
(
) = zF + 2zg
(
) 2I0 −I1 + I2
(
)
⎡⎣
⎤⎦= 3I0 zF + 2zg
(
)
	 (9.51)
	
Vb + Vc = 2V0 −V1 + V2
(
) = 3I0 zF + 2zg
(
) 	
(9.52)
	
2V0 −V1 −V1 + zFI1 −zFI2 = 3I0 zF + 2zg
(
)
2V0 −2V1 + zFI1 −zF(−I0 −I1) = 3I0 zF + 2zg
(
)
2V0 −2V1 + 2zFI1 −2zFI0 −6I0zg = 0
	
(9.53)
	
V0 −I0 zF + 3zg
(
) = V1 −zFI1 = V2 −zFI2 	
(9.54)
Equations (9.49) and (9.54) require that the sequence networks should be in parallel.
9.6	
Alternative Equation for Fault Current Calculation
Some useful1 matrix results from (9.4) and (9.10) are:
	
I012
F
= Z012
F
+ Z012
Th
(
)
−1 E012
Th 	
(9.55)
	
I012
F
= U + Y012
F Z012
Th
(
)
−1Y012
F E012
Th 	
(9.56)
1 .  Lemma (AB)–1 = B–1A–1 
With U as the unity matrix, (AB)–1(AB) = U. We then multiply by the right with B–1 and then by 
A–1
Figure 9.19  Sequence network connections, two phases and ground. 

318
General Fault Studies in Electrical Power Systems
Then
	
Z012
F
+ Z012
Th
(
)
−1 = Z012
F
Y012
F Z012
F
+ Y012
F Z012
Th
(
)
(
)
−1
= Z012
F
U + Y012
F Z012
Th
(
)
(
)
−1 = U + Y012
F Z012
Th
(
)
−1Y012
F
	
(9.57)
9.7	
Transient and Subtransient Impedances in Magnetic Circuits
When a sudden change in operating conditions happens to magnetically coupled cir-
cuits, the immediate response from circuit currents is to maintain the magnetic flux 
values; this is the principle of constant flux linkages. This type of response is a tran-
sient that lasts accordingly to the time constants for the magnetic circuits involved.
9.7.1	
Transient Response in a Magnetic Circuit
The flux linkages for magnetic coupled circuits (see Figure 9.20):
	
Ld
3
2Mf
3
2Mf
Lff
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
Δid
Δif
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
Δld
Δlf = 0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(9.58)
Using the partial inversion in (9.58) to exchange the zero into the left-hand side, we 
get (9.59). The flux linkage to current relation is a reduced transient inductance; 
(9.59). Such is the nature of the transient response in coupled circuits: in a synchro-
nous machine it is the field winding and the phase windings interacting in the d-axis 
of the synchronous machine.
	
Ld −3
2
Mf
2
Lff
−
3
2Mf
Lff
−
3
2Mf
Lff
−1
Lff
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
Δid
0
⎡
⎣⎢
⎤
⎦⎥=
Δld
Δif
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(9.59)
Figure 9.20  Magnetic coupled circuits, d-axis. 

9.7	
Transient and Subtransient Impedances in Magnetic Circuits
319
	
Δld =
Ld −3
2
Mf
2
Lff
⎛
⎝⎜
⎞
⎠⎟Δid 	
(9.60)
9.7.2	
Subtransient Response
As seen in Figure 9.21, the flux linkages along the d-axis will tend to be constant 
in the field circuit, the direct axis, and in the damper circuit kd. A similar effect 
holds true for the coupled circuit in the q-axis, the quadrature winding, and the 
damper kq. After partial inversion steps to exchange the zero values from the right 
hand side in (9.61) to the left-hand side, we have a reduced coefficient that will be 
the subtransient inductance in the d-axis. In the q-axis, we will have a transient.
	
Ld
3
2Mf
3
2MD
3
2Mf
Lff
Mr
3
2MD
Mr
LD
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
Δid
Δif
Δikd
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
Δld
Δlf = 0
Δlkd = 0
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(9.61)
	
Δld =
Ld −
3
2Mf
3
2MD
⎡
⎣
⎢
⎤
⎦
⎥
Lff
Mr
Mr
LD
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
−1
3
2Mf
3
2MD
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎛
⎝
⎜
⎜
⎜⎜
⎞
⎠
⎟
⎟
⎟⎟
Δid 	
(9.62)
	
Δld =
′′
Ld Δid 	
(9.63)
From the results outlined, we observe the following relation for the subtransient 
reactance, transient, and synchronous reactance values.
Figure 9.21  Magnetic coupled circuits, d-axis and q-axis.

320
General Fault Studies in Electrical Power Systems
	
′′
Ld 〈
′
Ld 〈Ld 	
(9.64)
The transient phenomena will always be present in a synchronous machine due to the 
field winding and the magnetic coupling with the d-axis equivalent stator windings. 
The subtransient behavior is due to the existence of the damper circuit beside the 
field winding in the d-axis. The time constants of the field and the damper wind-
ings are very different, considering the high resistance value in the short-circuited 
damper winding.
Typically, the subtransient phenomena dies out in about three to four cycles, and 
the transient will last for about eight to ten cycles. This reasoning justifies the use 
of subtransient reactance for fault current determination up to four cycles and the 
transient reactance in the range of eight cycles in the Thévenin’s equivalent circuit 
of the synchronous generators.
References
[1]	
Stevenson, W. D., Elements of Power System Analysis, Second Edition, New York: 
McGraw-Hill Book Company, 1962.
[2]	
Stagg, G. W., and A. H. El-Abiad, Computer Methods in Power System Analysis, Tokyo, 
Japan: McGraw-Hill Book Company, 1968.
[3]	
Elgerd, O. I., Electric Energy Systems Theory: An Introduction, Second Edition, New 
York: McGraw-Hill Book Company, 1982.
[4]	
Gross, C. A., Power Systems Analysis, New York: John Wiley & Sons 1979.

321
C h a p t e r  1 0
Contingency Analysis
10.1	 Introduction
Electrical power systems are designed years in advanced by engineering planning 
departments, considering load growth and energy requirements, using load fore-
casting and other relevant socioeconomic information, and projecting the infor-
mation by forecasting tools various years into the future. Available energy sources 
such as oil fuels, hydropower, nuclear, wind, solar, and other renewables will be 
considered as power plants of the appropriate technology that will be chosen with 
optimal criteria in mind and to be considered in the planning scenarios. The avail-
able technology also plays a role in selecting AC or DC transmission, voltage level 
of operation, and transmission capacity. Together with technical and economical 
requirements, they will be compared and the right projects will be selected for sys-
tem reinforcements and expansion.
The shipment of large amounts of energy from the power generating sites to 
the load centers requires high capacity transmission lines and transformers to step 
up to voltage transmission levels, and at the receiving end, step down the voltages 
so that energy can reach effectively from the source site to load locations. The time 
into the future is classified broadly as short, medium, and long-term; these are 
measured conveniently in years. Short term might be up to 5 years, medium from 
5 to 10 years, and long-term could be anywhere from 10 to 30 years in advance. 
These ranges are practically defined by the time it takes to develop different type 
of projects; for example, a large hydro project might take about 10 years for envi-
ronmental and land flood assessment, dam construction, machinery installation, 
and substation-transmission line building and commissioning. For a new combined 
cycle power plant, it may take 3 to 4 years, and transmission line projects ranging 
from 3 to 6 years are standard.
Planning usually assumes a three-phase balanced AC system. It is considered 
that the impedance sequence parameters are available for generators, transformers, 
and transmission lines, that network configuration and load values are known; with 
this information, we solve the base case load flow. Planning studies are assessment 
tasks used to establish the efficiency, security, and reliability of the existing and the 
future power system. Steady state, transient, and dynamic responses are evaluated 
among other required technical assessments.
Efficiency studies relate to what type, what size, and how many generating units 
need to be selected, and what are the most appropriate technologies and primary 
energy resources available (i.e., gas, coal, fossil fuels, nuclear, hydro, wind, solar). 
Heat rate curves, water usage, and the energy available from wind and solar would 

322
Contingency Analysis
be needed in order to solve the energy coordination usage. An optimal formulation 
solves the problem written for each stage in the planning horizon.
Reliability of a power system relates to studies aimed at estimating if the system 
will be able to supply its load; this is also known as adequacy, given that generators 
might trip and might not be available to supply power to the system. Together with 
transmission lines being unavailable due to faults, the uncertainty needs to be put 
into a proper model to process the rate of failure of generators transformers and 
transmission lines. The result at each study period is the expected value to supply 
the required load. Statistics and information about the generator’s and transformer’s 
availability, as well as the line rate of failure, are a key piece of information to build 
an appropriate probabilistic model.
Security assessment is a study of how well a system’s voltages, frequency, and 
lines without overloads are maintained in the system, at steady state, and during 
contingencies. Contingencies are caused by faults in the system and line or genera-
tor’s tripping. The question to be answered is: as generators and transmission lines 
trip, is the system robust and able to maintain synchronism between all connected 
generators? The loss of elements comprises the contingency studies.
Contingency analysis is a study that poses the question: what happens to the 
system’s variables (voltages and power flows) when a generator or a power plant 
trips? What are the changes to the system’s variables when a transmission or a trans-
former trips due to an electrical fault or as a consequence of switching phenomena? 
How would a system’s topology changes affect neighboring transmission elements? 
How can we be prepared for power overloads or high/low voltage related problems? 
What happens in the case of multiple contingency situations? Results are evaluated 
first assuming that a new steady state is reached from the base case to the postcon-
tingency situation; in this case, the transient process in how electric energy is going 
to be reassigned following a process with damped oscillations is not considered.
In a short time horizon, as in operation planning and close to real time, for fast 
network solutions and network analysis, some approximations similar to the ones 
derived for the fast decupled load flow might be introduced. Central to network 
studies of this kind of applications establish a steady state converged solution or 
base case, and multiple practical applications are derived for the operation or for 
the planning process from this condition.
One requirement in conducting a contingency analysis is to have a fast calculation 
of adjusted values for the system’s state variables: new values for node voltages and 
nodal angles, as well as the new power flows. Network models are derived accord-
ing to the required application and can range from DC analogous approximations 
to full AC Newton’s formulation, especially in those cases that are critical in terms 
of large nodal angle separation (heavy load or large changes in the system), or volt-
age problems with reduced margin to the voltage collapse point.
A more complete steady state formulation could be a solution by optimal power 
flows and control for some selected cases. The fast study of contingency analysis 
might show results that need extended analysis through various dynamic. In order 
to study generators and swing response to include inertia, generating units regula-
tion characteristics or to include complete transient stability studies. If nondecay-
ing oscillations are detected in the dynamic studies, this could lead into dynamic 

10.2	
General System Incremental Linear Network
323
response analysis so that control settings, control modeling, and control tuning 
can be evaluated.
10.2	 General System Incremental Linear Network
To establish fast studies, linear models can be devised and used. At this point, we 
can make reference to models developed in Chapter 6 to conduct real power flow 
approximation, as (6.91) that is written here as (10.1) for completeness.
	
−xkm
Δpkm
Vk
+ Δqk −Δqm = −Δt 	
(10.1)
xkm	
Series reactance of element from node k to node m
Δpkm	 Incremental real power flow from node k to node m
Δθk	
Incremental nodal angle node k
Δθm	
Incremental nodal angle node m
⎪Vk⎪	 Nodal voltage magnitude at node k
Δτ	
Incremental phase shifting angle, control at element km
From (10.1) the incremental equivalent circuit is shown in Figure 10.1.
Expression (10.1) will be used for each element in our network. To complete the 
set of equations, an analogue to KCL is written for the incremental nodal power bal-
ance. By constructing a general incremental-hybrid equation for all elements and the 
set of nodal power balances by KCL, it will give a primitive circuit type of equation.
	
−X A
At
0
⎡
⎣⎢
⎤
⎦⎥
Δp
V
Δq
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥=
−Δt
ΔP
V
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	
(10.2)
Where
X	
Diagonal matrix of element’s reactance
Δθ	
Incremental nodal angles
Δp/V	 Incremental power through elements
Figure 10.1  Linearized model for incremental real power flow. 

324
Contingency Analysis
ΔP/V	 Incremental nodal power injection
By partial inversion over all of the elements, gives a reduced equivalent matrix as 
seen from the system’s nodes. The numerical step renders a susceptance matrix 
Bbus, which is Norton’s equivalent matrix (10.3). The right hand side will have the 
incremental changes to real power flows through transmission elements and the 
nodal incremental power injections.
	
B
BA
AtB AtBA
⎡
⎣⎢
⎤
⎦⎥
Δt
Δq
⎡
⎣⎢
⎤
⎦⎥=
Δp
V
ΔP
V
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(10.3)
Where
B = X–1	
Diagonal matrix when there are no mutual couplings
Bbus = AtBA	
Nodal susceptance matrix
From the second row of the matrix equation (10.3), we write:
	
BbusΔq = ΔP
V −AtBΔt 	
(10.4)
In this case, the incremental nodal angles Δθ in (10.4) are the state variables. Pro-
vided that one node angle is taken as reference and solving by partial inversion or 
matrix inversion algorithms, we calculate Δθ.
	
Δq = Xbus
ΔP
V −AtBΔt
⎛
⎝⎜
⎞
⎠⎟	
(10.5)
Where
Xbus = Bbus
−1
Once the vector Δθ is calculated, the element’s incremental power Δp/V is found 
through the first row in the matrix equation (10.3).
	
Δp
V = B AΔq + Δt
(
) 	
(10.6)
The steps for a network’s solution are:
• From network connectivity information, write the A matrix, which is an 
element-node connection matrix. Form the diagonal matrix X.
A(km, Nsal) = +1	
element km out from node Nsal
A(km, Nlleg) = −1	 element km to node Nlleg
• From the information of nodal injections by current sources, jkm.
Ibus (Nlleg) = Ibus (Nlleg) + jkm	
source km injects current into node Nlleg

10.2	
General System Incremental Linear Network
325
Ibus (Nsal) = Ibus (Nsal) − jkm	
source km extracts current from node Nsal
• Calculate Bbus = AtBA and the vector of powers −AtBΔτ.
• Find Xbus and solve Δθ = Xbus(ΔP/V − AtBΔτ).
• Calculate Δp/V = B(AΔθ + Δτ).
• Nodal angle difference at each element terminals by AΔθ.
The described calculations can be conducted using sparse techniques, especially 
as matrices A, X, and Bbus will be highly sparse. The nodal reactance matrix Xbus 
(which is the inverse of Bbus) is calculated by columns, as in many cases, the appli-
cation requires only a few elements of the inverse matrix.
Example 10.1
Consider a network and solve for θbus, and the real power flows pkm. Assume node 
voltage magnitudes as 1.0 pu, complex tap values as 1.0∠0. The parameters are 
shown in Table 10.1. This will give the base case from which several concepts will 
be derived. Using reactance values only, follow steps from a) to f) listed in the previ-
ous algorithm and solve for unknown nodal angles θ2, θ3, and θ4. The constraints 
to be satisfied are the nodal power balances for real power.
⎪t⎪∠τ = tα + jtβ = 1.0∠0°
Base case solution
Real power flows, Base Case
Figure 10.2  Circuit to study real power flows only.
Table 10.1  Connectivity and Parameter Values from Figure 10.2
Element
N sal − k
N lleg − m
xkm
tap
ybsh/2
1
1
2
0.099
-1
0
2
1
3
0.099
1+j0
0
3
3
4
0.066
-1
0
4
2
4
0.0495
-1
0

326
Contingency Analysis
Nelem =      4   Nnod =      4   Nref =      1
Element     Nfrom    Nto     x Value      esource
     1        1        2      0.0990      0.0000
     2        1        3      0.0990      0.0000
     3        3        4      0.0660      0.0000
     4        2        4      0.0495      0.0000
Nodal conditions, Base Case
Node Num   Type Nod  Nodal angle     PGen         Pload
   1         +0        0.00         0.0000       0.6000
   2         +1        0.00         0.4200       0.8000
   3         +1        0.00         0.6400       0.4000
   4         -1        0.00         0.0000       1.0000
Slack type 0, Gen type 1, Load type -1
A =
     1    -1     0     0
     1     0    -1     0
     0     0     1    -1
     0     1     0    -1
Ybus =
   20.2000  -10.1000  -10.1000         0
  -10.1000   30.3000         0  -20.2000
  -10.1000         0   25.2500  -15.1500
         0  -20.2000  -15.1500   35.3500
Xbus =
    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0677    0.0313    0.0521
    0.0000    0.0313    0.0677    0.0469
    0.0000    0.0521    0.0469    0.0782
Real power flows, Base Case
Element     Nfrom    Nto     p Value
     1        1        2      0.7105
     2        1        3      0.4295
     3        3        4      0.6695
     4        2        4      0.3305
Nodal solution, Base Case
Node Num   Type Nod  Nod_angle deg     PGen         Pload
   1         +0       -0.0000         1.7400       0.6000
   2         +1       -4.0307         0.4200       0.8000
   3         +1       -2.4363         0.6400       0.4000
   4         -1       -4.9682         0.0000       1.0000
Note that the row and column for the reference node are zero in the bus reac-
tance matrix.

10.3	
Sensitivity Matrix for a Linear Circuit
327
10.3	 Sensitivity Matrix for a Linear Circuit
The algorithm described in Section 10.2 takes advantage of a natural partition 
of information for elements and for the network’s nodes; this is used to solve the 
problem. An interesting alternate interpretation is useful if a whole partial inversion 
process is conducted on (10.3), provided that one node is referenced. The results 
show that the inverse matrix is a sensitivity matrix that relates by means of the 
coefficients changes of the control variables over the dependent variables. For this 
formulation, the dependent variables are the increment to nodal angles and the 
increments on power flows through elements.
	
Δp
V
Δq
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥=
Sbr,t
Sbr,ΔP
Sbus,t
Sbus,ΔP
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
−Δt
ΔP
V
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥	
(10.7)
Control variables	
Δτ and ΔP/V
Dependent variables	Δp/V and Δθ
Example 10.2
Consider the linear network from Example 10.1. Write the general circuit form as 
given by (10.3). Solve for real power flows Δpkm and Δθbus. Show the hybrid matrix 
(here called W) and its inverse W1 (sensitivity matrix).
Real power flows, Base Case
Nelem =      4   Nnod =      4   Nref =      1
Element     Nfrom    Nto     x Value      esource
     1        1        2      0.0990      0.0000
     2        1        3      0.0990      0.0000
     3        3        4      0.0660      0.0000
     4        2        4      0.0495      0.0000
Nodal conditions, Base Case
Node Num   Type Nod  Nodal angle     PGen         Pload
   1         +0        0.00         0.0000       0.6000
   2         +1        0.00         0.4200       0.8000
   3         +1        0.00         0.6400       0.4000
   4         -1        0.00         0.0000       1.0000
Slack type 0, Gen type 1, Load type -1
W =
  -0.0990        0        0        0   1.0000  -1.0000        0        0
        0  -0.0990        0        0   1.0000        0  -1.0000        0
        0        0  -0.0660        0        0        0   1.0000  -1.0000
        0        0        0  -0.0495        0   1.0000        0  -1.0000
   1.0000   1.0000        0        0        0        0        0        0
  -1.0000        0        0   1.0000        0        0        0        0
        0  -1.0000   1.0000        0        0        0        0        0
        0        0  -1.0000  -1.0000        0        0        0        0

328
Contingency Analysis
Sensitivity matrix
W1 =
  -3.1895   3.1895   3.1895  -3.1895        0  -0.6842  -0.3158  -0.5263
   3.1895  -3.1895  -3.1895   3.1895        0  -0.3158  -0.6842  -0.4737
   3.1895  -3.1895  -3.1895   3.1895        0  -0.3158   0.3158  -0.4737
  -3.1895   3.1895   3.1895  -3.1895        0   0.3158  -0.3158  -0.5263
        0        0        0        0   0.0000   0.0000   0.0000   0.0000
  -0.6842  -0.3158  -0.3158   0.3158   0.0000   0.0677   0.0313   0.0521
  -0.3158  -0.6842   0.3158  -0.3158   0.0000   0.0313   0.0677   0.0469
  -0.5263  -0.4737  -0.4737  -0.5263   0.0000   0.0521   0.0469   0.0782
Real power flows, Base Case
Element     Nfrom    Nto     p Value
     1        1        2      0.7105
     2        1        3      0.4295
     3        3        4      0.6695
     4        2        4      0.3305
Nodal solution, Base Case
Node Num   Type Nod  Nod_angle deg     PGen         Pload
   1         +0       -0.0000         1.7400       0.6000
   2         +1       -4.0307         0.4200       0.8000
   3         +1       -2.4363         0.6400       0.4000
   4         -1       -4.9682         0.0000       1.0000
10.3.1	 Sensitivity Matrix for Incremental Control Changes
The inverse matrix W1 shown in Example 10.2 is a sensitivity matrix as (10.7). 
From a control point of view, when phase shifters Δτ are available, changes can 
be studied to calculate their influence and effects. The effects can be quantified by 
looking into the column of the inverse matrix W1 that corresponds to the element 
where the phase shifter is located. Similarly, the same can be said about control 
changes by nodal injections ΔP/V; the coefficients in the column of the inverse matrix 
W1 will show how much the power flows, and nodal angles will change given the 
new condition of a nodal injection ΔP/V. First, let us assume that a phase shifter is 
located at element 1-3. An incremental change Δτ13 = 0.05 radians (2.86°), will cause 
changes to power flows and nodal angles. Calculation follows the use of the second 
column of W1. Results include the angle difference through transmission elements; 
this will allow a look into the steady state stability margin, which, according to 
engineering practice for high voltage transmission lines, should not go above 30°.
Dt =    0.0500
Real power flows, control change Dt13 = 0.05 rad
Element     Nfrom    Nto     p Value      Angle qkm
     1        1        2      0.5511         3.13
     2        1        3      0.5889         0.48
     3        3        4      0.8289         3.13
     4        2        4      0.1711         0.49
Nodal solution, control change Dt13 = 0.05 rad
Node Num   Type Nod  Nod_angle deg     PGen         Pload

10.4	
Single Contingency Model
329
   1         +0       -0.0000         1.7400       0.6000
   2         +1       -3.1260         0.4200       0.8000
   3         +1       -0.4762         0.6400       0.4000
   4         -1       -3.6112         0.0000       1.0000
For a change of nodal injection, we will assume an increase in the load at node 4 
by 0.5 pu. Show the new values for power flows and nodal angles. The calculated 
values are changes to the base case from Example 10.2. The nodal angle differences 
on a transmission element are shown again to keep track of the stability margin.
Real power flows, control change DP/V =0.5 pu (load)
Element     Nfrom    Nto     p Value      Angle qkm
     1        1        2      0.9737         5.52
     2        1        3      0.6663         3.78
     3        3        4      0.9063         3.43
     4        2        4      0.5937         1.68
Nodal solution, control change DP/V =0.5 pu (load)
Node Num   Type Nod  Nod_angle deg     PGen         Pload
   1         +0       -0.0000         2.2400       0.6000
   2         +1       -5.5236         0.4200       0.8000
   3         +1       -3.7799         0.6400       0.4000
   4         -1       -7.2075         0.0000       1.5000
This model will solve for control actions and their effects on power flows and nodal 
angles with reference to values from the base case. An interesting extension can be 
addressed when a transmission element line or transformer is tripped due to a fault 
clearing procedure, and we need the new values of power flows and nodal angles. 
The new values for power flows will show if any transmission element is overloaded. 
This is discussed in Section 10.4.
10.4	 Single Contingency Model
We are interested in the new operating state after a transmission line or a transformer 
is suddenly disconnected from the network due to a fault and after the protective 
scheme has performed its duties. The attention is focused on the new steady state 
and no dynamic is modeled for the transition period. In control centers for electric 
systems, extensive evaluation of network conditions, power flows through each ele-
ment, and nodal values for the network are analyzed; this is done for every credible 
contingency. Fast results are required in an operational environment; operators in 
the control room need to know ahead of time that if certain contingencies occur, 
the system’s vulnerabilities, and how to make appropriate remedial preparations. 
Calculation speed can be accomplished by linear network approximations, as the 
ones presented in Section 10.3 for real power flow and nodal angles. A refinement 
must be worked out because the element on outage will not be part of the system. 
Let us work the concept through Thévenin’s equivalent.

330
Contingency Analysis
10.4.1	 Thévenin’s Equivalent
We now recall how the Thévenin’s equivalent, as seen from two nodes to which 
the tripped element is connected, can be defined and how the node voltages make 
the Thévenin’s voltage sources. Connecting the negative series admittance of the 
original element to the Thévenin’s nodes will help us find the currents that flow to 
the newly connected admittance. As in the fault analysis presented in Chapter 9, we 
inject the currents back into the network equivalent to calculate the nodal angles 
changes, once we have the value of the current through the new admittance. All of 
this is a result of connecting the negative value of the admittance between nodes k 
and m. We work the steps to solve this problem using voltage and current notation; 
the results can then be applied in an analogous form to a particular incremental 
real power flow or to the incremental reactive power problem. Therefore, we use 
the analogy of current to power flow and voltage to the nodal angle.
For the outage of an element ykm connected between nodes k and m, as shown in 
Figure 10.3, let us use Thévenin’s equivalent from the network’s impedance matrix 
that already includes ykm. Then connect, from node k to node m, the admittance 
−ykm. When the new negative admittance is connected, the boundary conditions 
of nodal voltages and nodal currents must be met. The net effect should be that 
no admittance is connected from k to m. As a result, this will represent the outage 
of element from node k to node m. By solving the set of equations, we determine 
currents Ik and Im. The negative of these currents needs to be injected back into 
node k and m, respectively. By completing this step, we find changes to the system’s 
nodal voltages. With updated nodal voltages, the current that flows through each 
network element can be found.
The equations presented so far are similar to the ones used in the general fault 
analysis in Chapter 9; only that in this case we upgrade our notation and the electri-
cal conditions for the contingency case. We start with Thévenin’s equation looking 
from nodes k and m into the network as (10.8), then we write the nodal voltage 
equation (10.9) for the portion of the admittances to be connected at nodes k and m; 
this will give us the nodal admittance matrix for connecting the admittance −ykm. 
Boundary conditions for voltages and currents are written in (10.10).
Figure 10.3  Equivalent circuit to study outage admittance ykm.

10.4	
Single Contingency Model
331
	
Vk
Vm
⎡
⎣
⎢
⎤
⎦
⎥=
Ek
Em
⎡
⎣
⎢
⎤
⎦
⎥+
Zkk
Zkm
Zmk Zmm
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Ik
Im
⎡
⎣
⎢
⎤
⎦
⎥	
(10.8)
	
−ykm
ykm
ymk
−ymm
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Vk
Vm
⎡
⎣
⎢
⎤
⎦
⎥=
Ik
F
Im
F
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(10.9)
	
Ik
Im
⎡
⎣
⎢
⎤
⎦
⎥= −
Ik
F
Im
F
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Vk
Vm
⎡
⎣
⎢
⎤
⎦
⎥=
Vk
F
Vm
F
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(10.10)
Where:
Ek	
Thévenin’s voltage, node k
Em	 Thévenin’s voltage, node m
Ik	
Nodal current k
Im	
Nodal current m
Vk	
Nodal voltage k
Vm	 Nodal voltage m
VF
k	 Nodal voltage k new connection
VF
m	 Nodal voltage m new connection
IF
k	
Nodal current into node k new connection
IF
m	
Nodal current into node m new connection
Substitution of (10.8) into (10.9) gives us the explicit equation to calculate nodal 
currents into the newly added admittance element −ykm.
	
−ykm
ykm
ymk
−ymm
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Ek
Em
⎡
⎣
⎢
⎤
⎦
⎥−
Zkk
Zkm
Zmk Zmm
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Ik
F
Im
F
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
⎛
⎝
⎜
⎞
⎠
⎟=
Ik
F
Im
F
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(10.11)
Ik
F
Im
F
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
1 0
0 1
⎡
⎣⎢
⎤
⎦⎥+
−ykm
ykm
ymk
−ymm
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Zkk
Zkm
Zmk Zmm
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
⎛
⎝
⎜
⎞
⎠
⎟
−1
−ykm
ykm
ymk
−ymm
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Ek
Em
⎡
⎣
⎢
⎤
⎦
⎥	 (10.12)
Once nodal currents are determined, these currents are injected into the correspond-
ing nodes k and m in the system of equations (10.13). Assuming that this is the 
only change of nodal injections, the incremental changes to all nodal voltages are 
calculated, with only two currents considered as Ik and Im. In this case, (10.14) will 
only require column k and column m in order to calculate the incremental changes 
ΔV to nodal voltages.
	
[ΔV] =
Sbus,ΔI
⎡⎣
⎤⎦[ΔI] 	
(10.13)

332
Contingency Analysis
	
ΔV1
ΔV2
!
ΔVn
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
S1,k
S1,m
!
!
Sn,k Sn,m
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
!
ΔIk
!
ΔIm
!
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
	
(10.14)
The new nodal voltages are calculated adding ΔV to the voltages V0 from the base 
case solution.
	
V new = V0 + ΔV 	
(10.15)
The currents that now flow through elements are updated by (10.16) with a value 
of zero for the admittance of element km in [z]–1. Voltage source e might be zero if 
there is no series voltage source in elements.
	
inew = [z]−1 AtV new −e
(
)	
(10.16)
Example 10.3
For the network in Example 10.1, there is a line connecting node 3 to node 4. 
Consider that this line trips, and that we are interested in the new power flows 
and nodal angles under this contingency. Use the results in this section, using 
Thévenin’s equivalent with an analogy of current as real power and voltages as 
nodal angles. Update the base case solution for the contingency with steps described 
by (10.9)–(10.16).
ZTh =
    0.0677    0.0469
    0.0469    0.0782
y34 =  -15.1500
ETh =
   -0.0425
   -0.0867
IFalla =
   -3.1800
    3.1800
Real power flows, Contingency Case
Element     Nfrom    Nto     p Value      Angle θkm
     1        1        2      1.3800         7.83
     2        1        3     -0.2400        -1.36
     3        3        4      0.0000        12.03
     4        2        4      1.0000         2.84

10.4	
Single Contingency Model
333
Nodal solution, Contingency Case
Node Num   Type Nod  Nod_angle deg     PGen         Pload
   1         +0       -0.0000         1.7400       0.6000
   2         +1       -7.8285         0.4200       0.8000
   3         +1        1.3615         0.6400       0.4000
   4         -1      -10.6650         0.0000       1.0000
Nodal angles and power flows in elements are updated to reflect the loss of the 
transmission element km. The calculation of angle differences between nodes to 
which an element is connected can be used as an indication of the stability margin 
for that element. The angle difference changes as load through the element increases; 
this can be the result of the outage of the transmission element km. Not having con-
nected this km line causes the power flows to be redirected and the nodal angles 
will adjust to the new power flows condition.
Example 10.4
For a network with structure, as seen in Figure 10.2, consider the outage of one 
line at a time; this is the (N − 1) criteria used in power systems security evaluation. 
Show the nodal angle difference across each transmission line at the output results. 
The line with the outage condition shows an angle difference, but it has no meaning 
because the line is in a tripped condition.
Real power flows, Base Case
Nelem =      4   Nnod =      4   Nref =      1
Element     Nfrom    Nto     x Value      esource
     1        1        2      0.0990      0.0000
     2        1        3      0.0990      0.0000
     3        3        4      0.0660      0.0000
     4        2        4      0.0495      0.0000
Nodal conditions, Base Case
Node Num   Type Nod  Nodal angle     PGen         Pload
   1         +0        0.00         0.0000       0.9000
   2         +1        0.00         0.4200       1.2000
   3         +1        0.00         0.6400       0.6000
   4         -1        0.00         0.0000       1.5000
Slack type 0, Gen type 1, Load type -1
Xbus =
    0.0000    0.0000    0.0000    0.0000
    0.0000    0.0677    0.0313    0.0521
    0.0000    0.0313    0.0677    0.0469
    0.0000    0.0521    0.0469    0.0782
Base case solution
Line    Nsal    Nlleg       pkm     Diff_angle
   1      1       2        1.3105      7.4344
   2      1       3        0.9295      5.2728
   3      3       4        0.9695      3.6665
   4      2       4        0.5305      1.5048

334
Contingency Analysis
Node       angle         PG             PL
   1      -0.00         3.1400         0.9000
   2      -7.43         0.4200         1.2000
   3      -5.27         0.6400         0.6000
   4      -8.94         0.0000         1.5000
Solution for contingency, line   1 out, k =    1 m =    2
Line    Nsal    Nlleg       pkm     Diff_angle
   1      1       2       -0.0000     23.5423
   2      1       3        2.2400     12.7072
   3      3       4        2.2800      8.6227
   4      2       4       -0.7800     -2.2124
Node       angle         PG             PL
   1      -0.00         3.1400         0.9000
   2     -23.54         0.4200         1.2000
   3     -12.71         0.6400         0.6000
   4     -21.33         0.0000         1.5000
Solution for contingency, line   2 out, k =    1 m =    3
Line    Nsal    Nlleg       pkm     Diff_angle
   1      1       2        2.2400     12.7072
   2      1       3       -0.0000     16.6971
   3      3       4        0.0400      0.1513
   4      2       4        1.4600      4.1412
Node       angle         PG             PL
   1      -0.00         3.1400         0.9000
   2     -12.71         0.4200         1.2000
   3     -16.70         0.6400         0.6000
   4     -16.85         0.0000         1.5000
Solution for contingency, line   3 out, k =    3 m =    4
Line    Nsal    Nlleg       pkm     Diff_angle
   1      1       2        2.2800     12.9341
   2      1       3       -0.0400     -0.2269
   3      3       4       -0.0000     17.4156
   4      2       4        1.5000      4.2546
Node       angle         PG             PL
   1      -0.00         3.1400         0.9000
   2     -12.93         0.4200         1.2000
   3       0.23         0.6400         0.6000
   4     -17.19         0.0000         1.5000
Solution for contingency, line   4 out, k =    2 m =    4
Line    Nsal    Nlleg       pkm     Diff_angle
   1      1       2        0.7800      4.4248
   2      1       3        1.4600      8.2824

10.4	
Single Contingency Model
335
   3      3       4        1.5000      5.6728
   4      2       4       -0.0000      9.5304
Node       angle         PG             PL
   1      -0.00         3.1400         0.9000
   2      -4.42         0.4200         1.2000
   3      -8.28         0.6400         0.6000
   4     -13.96         0.0000         1.5000
Results show that nodal angles change to new values; the power flows are adjusted 
to comply with the power condition imposed by the contingency. Angles increase 
across both the transmission lines and its power flows. For this small system, the 
(N − 1) condition (one line out at a time) does not lead the system into difficulties 
in terms of large nodal angles (close to 30°). From the security point of view, the 
system is secure under the criteria (N − 1). We have already mentioned that the 
line outage will cause a power oscillatory problem; we therefore assume that it is 
a well-damped phenomena, so in a reasonable time (few seconds) we will reach a 
new steady state that will be the one calculated through the contingency analysis.
10.4.2	Voltage and Reactive Power Under Contingencies
As the real power model used in Section 6.6, in Chapter 6, we had an incremental 
reactive power model for transmission elements connected from node k to node m. 
Reasonable approximations were made for high voltage systems. According to Figure 
10.4, we will write two equations: incremental series flows (10.17) and nodal bal-
ances of reactive power for node k and for node m (10.18) and (10.19), respectively.
The circuit model for the transmission line includes the line-charging suscep-
tance. It might also include shunt reactive power-compensating devices. For the 
transmission line, no tap is available so Δ⎪t⎪ = 0. For each element km, (10.17) is 
applied and nodal balance equations for node k and for node m as in (10.18).
	
−xkm
Δqkm
Vk
+ Δ Vk −Δ Vm = −Δ t 	
(10.17)
Figure 10.4  Incremental circuit to model voltages and reactive power flow through element 
km.

336
Contingency Analysis
	
ΔQk
Vk
= Δqkm
Vk
−
2Bsh2
(
)Δ Vk
(
) 	
(10.18)
	
ΔQm
Vm
= −Δqkm
Vm
−
2Bsh2
(
)Δ Vm
(
)	
(10.19)
xkm	
Series reactance of element from node k to node m
Δqkm	
Incremental reactive power flow from node k to node m
Δ⎪Vk⎪	
Incremental nodal voltage, node k
Δ⎪Vm⎪	
Incremental nodal voltage, node m
⎪Vk⎪, ⎪Vm⎪	 Nodal voltage magnitude at node k and at node m
Δ⎪t⎪	
Incremental tap, control at element km
Bsh2	
Susceptance in π equivalent for element km
Example 10.4
For a four-node system, write the incremental model for voltages and reactive 
power flows. We use (10.17) for elements and (10.18)–(10.19) for nodal reactive 
power balances.
(1)
−x12
Δq12
V1
+ Δ V1 −Δ V2 = −Δ t
(2)
−x13
Δq13
V1
+ Δ V1 −Δ V3 = 0
(3)
−x34
Δq34
V3
+ Δ V3 −Δ V4 = 0
(4)
−x24
Δq24
V2
+ Δ V2 −Δ V4 = 0
Node 1
+ Δq12
V1
−2Bsh212Δ V1
(
) + Δq13
V1
−2Bsh213Δ V1
(
) = ΔQG1
V1
−ΔQD1
V1
Node 2 −Δq12
V1
−2Bsh212Δ V2
(
) + Δq24
V2
−2Bsh224Δ V2
(
) = ΔQG2
V2
−ΔQD2
V2
Node 3
−Δq13
V1
−2Bsh213Δ V3
(
) + Δq34
V3
−2Bsh234Δ V3
(
) = ΔQG3
V3
−ΔQD3
V3
Node 4 −Δq24
V2
−2Bsh224Δ V4
(
) −Δq34
V3
−2Bsh234Δ V4
(
) = ΔQG4
V4
−ΔQD4
V4
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(10.20)

10.4	
Single Contingency Model
337
For the circuit in Figure 10.5, the hybrid matrix expression is shown by (10.21); 
note that line from node 1 to node 3 does not have a shunt capacitive connection.
−x12
0
0
0
+1
−1
0
0
0
−x13
0
0
+1
0
−1
0
0
0
−x34
0
0
0
+1
−1
0
0
0
−x24
0
+1
0
−1
+1
+1
0
0
−2Bsh2
12
0
0
0
−1
0
0
+1
0
−2 Bsh2
12 + Bsh2
24
(
)
0
0
0
−1
+1
0
0
0
−2Bsh2
34
0
0
0
−1
−1
0
0
0
−2 Bsh2
24 + Bsh2
34
(
)
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
Δq12
V1
Δq13
V1
Δq34
V3
Δq24
V2
Δ V1
Δ V2
Δ V3
Δ V4
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
=
−Δ t
0
0
0
ΔQ1
V1
ΔQ2
V2
ΔQ3
V3
ΔQ4
V4
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
 

(10.21)
Assuming that a transmission line trips, this will cause changes to nodal voltages 
and reactive power flows through elements; it is required to calculate the changes. 
We use the electric current analogy in Figure 10.6; we use voltages and currents.
Nodal equations are used as (10.8) and (10.10). Equation (10.22) represents 
the nodal matrix for the connecting element, including its shunt susceptances (see 
Figure 10.6).
	
−ykm + 2Bsh2
ykm
ymk
−ymm + 2Bsh2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Vk
Vm
⎡
⎣
⎢
⎤
⎦
⎥=
Ik
F
Im
F
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(10.22)
Now, the nodal currents into the connecting admittances (10.22) are represented 
in (10.23).
Figure 10.5  Incremental circuit to model voltages and reactive power flow.

338
Contingency Analysis
Ik
F
Im
F
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
1 0
0 1
⎡
⎣⎢
⎤
⎦⎥+
−ykm + 2Bsh2
ykm
ymk
−ymm + 2Bsh2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Zkk
Zkm
Zmk Zmm
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
⎛
⎝
⎜
⎞
⎠
⎟
−1
−ykm
ykm
ymk
−ymm
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
Ek
Em
⎡
⎣
⎢
⎤
⎦
⎥
 

(10.23)
Currents calculated from (10.23) are injected back into the network at node k and 
m. Incremental nodal voltages ΔV by (10.13)–(10.14) will update the nodal voltages 
from the base case V0 as in (10.15).
	
ΔIk = −Ik
F
ΔIm = −Im
F 	
(10.24)
Currents flowing through elements are updated by (10.16) (which is repeated below). 
It should be noted that the series admittance for element ykm is zero; this is consid-
ered before inverting the diagonal matrix [z]–1.
	
inew = [z]−1 AtV new −e
(
)	
(10.16)
Example 10.5
For the circuit in Figure 10.2, the base case is a load flow solution only for the reac-
tive power. A fast decoupled load flows converges in two iterations for the B′ part 
and two iterations for the B″ part of the problem. All values in pu.
• Show the sensitivity matrix for the reactive power incremental model.
• For the reactive power model, solve for changes in reactive power flows and 
nodal voltages after the line connected from node 3 to node 4 is tripped. Use 
as starting point the base case solution.
Figure 10.6  Incremental current model to solve for nodal voltages and reactive power flows.

10.4	
Single Contingency Model
339
Data for the small network in Figure 10.5 is listed below. The solution appears in 
Figure 10.7.
Number of nodes =    4    Number of elements =    4
Element   Nsal   Nlleg     r           x           bsh2
   1       1       2      0.0000      0.2000      0.0400
   2       1       3      0.0000      0.3000      0.0600
   3       3       4      0.0000      0.2500      0.0200
   4       2       4      0.0000      0.2000      0.0300
Node   Ntype  Voltage     Angle      PG         QG         PL         QL
 1      0     1.00000     0.0000     0.0000     0.0000     0.0000     0.0000
 2      1     1.00000     0.0000     0.0000     0.0000     0.0000     0.1000
 3      1     1.00000     0.0000     0.0000     0.0000     0.0000     0.1000
 4     -1     1.00000     0.0000     0.0000     0.0000     0.0000     0.3000
IterationP =  0.0    MaxDP = 0.000000e+000
IterationQ =  0.0    MaxDQ = 3.500000e-001
IterationP =  2.0    MaxDP = 0.000000e+000
IterationQ =  2.0    MaxDQ = 6.647207e-007
Load flows in elements
Element   Nsal   Nlleg      p           q
   1       1       2      0.0000      0.0400
           2       1      0.0000      0.0400
   2       1       3      0.0000      0.0600
           3       1      0.0000      0.0600
   3       3       4      0.0000      0.1794
           4       3      0.0000     -0.1353
   4       2       4      0.0000      0.2292
           4       2      0.0000     -0.1647
Nodal Solution
Node   Ntype  Voltage     Angle     PG         QG         PL         QL
 1      0     1.00000     0.00     0.0000     0.1000     0.0000     0.0000
Figure 10.7  Circuit solution, only voltages and reactive power flows. 

340
Contingency Analysis
 2      1     1.00000     0.00     0.0000     0.3692     0.0000     0.1000
 3      1     1.00000     0.00     0.0000     0.3394     0.0000     0.1000
 4     -1     0.96016     0.00     0.0000     0.0000     0.0000     0.3000
Total Generation PG =   0.0000     QG =   0.8085
Total Load       PL =   0.0000     QL =   0.5000
Losses           P  =   0.0000     Q  =   0.3085 (>0 TL requirement)
The sensitivity matrix for the reactive power incremental model is listed as W1
W1 =
 -5.0000   0.0000   0.0000   -0.0000   0.0000   -0.0000   0.0000   -0.0000
  0.0000  -3.3333  -0.0000    0.0000   0.0000    0.0000  -0.0000   -0.0000
  0.0000  -0.0000  -2.2022    2.2472  -0.0000   -0.0000   0.0000   -0.4494
 -0.0000   0.0000   2.2472   -2.1910   0.0000    0.0000  -0.0000   -0.5618
  0.0000   0.0000  -0.0000    0.0000   0.0000    0.0000   0.0000    0.0000
 -0.0000   0.0000  -0.0000    0.0000   0.0000    0.0000   0.0000    0.0000
  0.0000  -0.0000   0.0000   -0.0000   0.0000    0.0000   0.0000    0.0000
 -0.0000  -0.0000  -0.4494   -0.5618   0.0000    0.0000   0.0000    0.1124
Notice that various rows and columns are zero, due to the fact that nodes 1, 2, 
and 3 are voltage-controlled nodes and their voltage value remains constant (incre-
ments are zero).
Results for a single contingency: line 3–4 out.
Solution to single contingency
line on outage    3,   4
Thevenin and Fault equivalent
        ZTh                    YF              ETh          IF
  0.0000   0.0000       -3.9600   4.0000      1.0000      -0.2795
  0.0000   0.1124        4.0000  -3.9600      0.9602       0.3563
Updated
  Flows      Voltages        Exact values(from load flow solution) 
  0.0400     1.0000          0.0400       1.0000
  0.0600     1.0000          0.0600       1.0000
  0.0000     1.0000          0.0000       1.0000
  0.4294     0.9201          0.3784       0.9302
10.5	 Participation Factors from System’s Lines
Consider a connected line that is carrying a flow pkm from node k to node m. If that 
line is no longer in service, the amount of power it was carrying will be taken by 
the remaining lines in the system, assuming that no changes are made to system’s 
load and generation. For system security analysis, it is of great importance to know 
the amount that each remaining line will take and if the new amount of power will 
get near any transmission limit.

10.5	
Participation Factors from System’s Lines
341
To calculate the amount of power to be shared, let us use Figure 10.8. The 
transmission line from node k to m, carrying power Δpkm, is assumed to be tripped 
and the amount of power ΔPk = Δpkm will be injected into node k and ΔPm = −Δpkm 
into node m. The numerical response of the network to this condition will provide 
changes to line flows and nodal angles. We calculate the normalized power flow 
changes with respect to ΔPk; we will find the power sharing factor when line km is 
not connected because of its contingency.
	
Δprs
ΔPk
	
(10.25)
Example 10.6
For the circuit in Figure 10.2, the base case is a load flow solution solving for real 
power only. Line (1) from node 1 to node 2 has a power flow of 1.3105. A contin-
gency occurs and the line is tripped; the solution is given by the steps developed 
in Section 10.4. Now one step further is to normalize the incremental changes in 
power flows by the power injected into node k. All values are in pu.
Base case solution
Line    Nsal    Nlleg       pkm     Diff_angle
   1      1       2        1.3105      7.4344
   2      1       3        0.9295      5.2728
   3      3       4        0.9695      3.6665
   4      2       4        0.5305      1.5048
Node       angle         PG             PL
   1      -0.00         3.1400         0.9000
   2      -7.43         0.4200         1.2000
   3      -5.27         0.6400         0.6000
   4      -8.94         0.0000         1.5000
Incremental solution =
   -0.0000
    1.3105
    1.3105
   -1.3105
         0
   -0.2811
   -0.1298
   -0.2163
Solution for Line Outage FACTOR, line   1 out, k =    1 m =    2
Line    Nsal    Nlleg       pk/DP
   1      1       2       -0.0000
   2      1       3        1.0000
   3      3       4        1.0000
   4      2       4       -1.0000
xtotal =

342
Contingency Analysis
         0
    2.2400
    2.2800
   -0.7800
   -0.0000
   -0.4109
   -0.2218
   -0.3723
10.6	 Summary
Contingency analysis is a very important task that must be conducted mainly in the 
control centers in order to assess the security of the electric power system. In order 
to conduct this task, fast calculating tools are required to evaluate what happens 
to the system’s variables when a generator trips and important generation is lost, as 
well as to find out what would likely occur if a transmission line is disconnected due 
to an overload condition, a fault, or erroneous action of a tripping device. Linear 
models are mainly used to provide the fastest solution possible and to get a broad 
picture of what to expect with respect to real power flows and nodal angles. A lin-
ear model that relays in material from Chapters 6 and 9 is used in the realm P − θ 
with an analogy through voltage current modeling; a similar analogy is applied to 
the reactive power—voltage model.
For large power networks as they exist today, with many nodes and transmis-
sion elements, the efficient handling of network connectivity information must be 
done through sparse techniques. Sparsity techniques work only on nonzero values 
from the models used through ingenious programming of Gaussian elimination to 
solve the system of equations. We did not delve into those techniques, but rather 
concentrated our attention on the basics and principles in order to have a solid 
foundation to tackle more advanced problems and applications.
Figure 10.8  Circuit solution only real power flows, line 1 to 2 tripped.

343
C h a p t e r  1 1 
State Estimation in Electrical Power 
Systems
11.1	 Introduction
Electrical power systems are an ensemble of multiple components: generating units 
in power plants, power transformers, transmission lines, and a wide variety of loads 
to be supplied. Operating and planning conditions must be able to handle uncertain 
conditions and random events, such as units that trip, overloading of transformers, 
transmission line outages, and random components as part of the electrical load. 
In the operating environment, power engineers need to know as close as possible, 
and in reliable form, the true nature of the state variables for the power system. 
For the electric network, the state variables are node voltage magnitudes and nodal 
angles. Once the complex voltages for all nodes in the system are known, all derived 
quantities (i.e., power flows and losses, quality indices) can be calculated, assum-
ing that transmission lines and transformers impedances (admittances) values are 
known. The calculated values are needed by personnel in the control center so that 
the monitoring and the wellbeing of the system can be assessed. If some deteriora-
tion ensues, control actions will follow. Some control actions depend on automatic 
equipment, their set points, and control laws implemented. For some slow-developing 
phenomena, human intervention might be required; full awareness of how condi-
tions evolve in the power system is required.
The ideal assumptions under which the power system is planned include com-
ponents and a load-power generation balance that can drastically differ during real 
time operation due to switching actions or automatic protection schemes. Modern 
control centers rely on measured quantities: real and reactive power, voltage mag-
nitudes, currents, and circuit breakers status. This information is collected periodi-
cally at remote terminal units (RTU) and sent through communication channels to 
feed fast digital processing computers located at the control center. Raw informa-
tion includes meter and transmission errors that are collected and assumed to be 
synchronously taken. Filtered information that blocks high-frequency noise and 
nonfundamental 60 Hz components is fed into digital processing algorithms that 
use redundant information so that, statistically, the best state estimation can be 
obtained. Redundancy is a key concept in applying statistical properties to the esti-
mated quantities that are based on the nature of the measuring error component. 
A statistical test over the measured quantities can be applied to accept or reject a 
measurement that is suspected to be spurious.

344
State Estimation in Electrical Power Systems
This chapter presents probability models and assumptions regarding the mea-
surements of a power system’s quantities, the quality of measuring devices, and an 
optimal procedure that works with redundant information to find the best estimate 
for state variables and derived quantities that can be attained.
11.1.1	 Centralized Data Acquisition System
The evolution of monitoring and control of modern power systems is rooted in black-
out events in the last fifty years. In the late 1960s, digital computers, hardware for 
measuring electric variables at substations, and communication media converged and 
were used to implement applications to monitor and control the power systems with 
the main objective of avoiding blackouts. One main assumption is that the electri-
cal system is in a quasi-steady state, and that voltage magnitudes, real and reactive 
power flows, as well as the system’s frequency, were almost constant. Therefore, 
data gathering into a central processing computer at a control center from RTUs, 
as shown in Figure 11.1, was considered to be simultaneously taken from various 
substations in the system. Processed measurements and breaker status information 
were used with transmission lines and transformer parameters to obtain a best 
estimate for the state of the system. Voltage magnitudes, nodal angles, and other 
results for AC system quantities, such as real and reactive power flows, are derived, 
and the system health can be monitored from the state estimation.
Figure 11.1 shows the main components of data gathering by means of RTUs. A 
scan of information is periodically collected by the control center from all the RTUs 
that are strategically deployed on the power system. Various digital applications 
are part of the package of application in the control center central processing units 
(CPUs); for our explanation only the state estimation is depicted. The development 
of power systems continued to grow in complexity and wide interconnections were 
Figure 11.1  Power system, measurements in RTU, and control center.

11.2	
Least Squares, Linear Model
345
implemented in the last thirty years. The control centers and their monitoring tools 
were not capable and not fast enough to prevent blackouts in North America, Japan, 
Europe, and other regions in the last 10 years. New developments in technology, 
computing processing power, and communications through fiber optics opened new 
concepts, such as phasor measurement units (PMUs) with the capacity to synchro-
nize into a very accurate time the measurements and to conduct the processing at a 
faster rate than compared to the old RTU’s equipment. We will visit the basic ideas 
behind the concept.
11.2	 Least Squares, Linear Model
One way to approach the problem is based on the assumption that the measurement 
error ε follows a Normal probability distribution with expected value μ = 0 and 
with variance σ2. This is a reasonable assumption, as the presence of several ran-
dom variables in the process will tend to add and to behave as a Normal probability 
distribution N (μ, σ2). Assuming a continuous random variable ε, the Normal prob-
ability distribution (μ = 0, σ2 = 1) has a bell-shaped form, as shown in Figure 11.2
	
PDF(e) =
1
s 2p e
−e−m
(
)
2
2s2 	
(11.1)
The area under the PDF(ε) is the probability of variable a ≤ ε < b.
	
p(a ≤e ≤b) =
PDF(e) de
a
b
∫
	
(11.2)
Figure 11.2  Normal probability distribution N (μ = 0, σ2 = 1).

346
State Estimation in Electrical Power Systems
Figure 11.3  Scatter diagram for measured values and a linear model assumption.
To start, let us assume that in a scatter diagram for measured values ym at x values 
resemble a linear shape. Then the model suggested is y = a1x + a0, where a set of n 
measurements gives the linear equation:
	
yk
meas = a1xk + a0 + ek
y1
meas
y2
meas
!
yn
meas
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
=
x1 1
x2 1
!
!
xn 1
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
a1
a0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
+
e1
e 2
!
e n
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
	
(11.3)
The so-called measurement error εk for each measured value is identified in Figure 
11.3.
yk
meas	 Measured value for yk
yk
th	
yk from model
The summation of squared errors (SS) after the linear model is substituted gives a 
way to estimate coefficients a1 and a0. A sound criterion is to minimize the sum-
mation of the squared errors; optimal values for a1 and a0 are derived from the 
gradient of the SS values.
	
SS =
ek
2
k=1
m
∑
=
yk
meas −a1xk −a0
(
)
2
k=1
m
∑
	
(11.4)

11.2	
Least Squares, Linear Model
347
	
∇SS =
∂SS
∂a1
∂SS
∂a0
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
0
0
⎡
⎣⎢
⎤
⎦⎥	
(11.5)
	
∂SS
∂a1
∂SS
∂a0
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
2
yk
meas −a1xk −a0
(
)
k=1
m
∑
(−xk)
2
yk
meas −a1xk −a0
(
)
k=1
m
∑
(−1)
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
	
(11.6)
Expressions in (11.6) can be arranged. To illustrate this concept, let us consider 
that four different measurements are available; when transpose matrix properties 
are applied we get (11.10) as the least squares solution.
y1
meas −a1x1 −ao
(
) y2
meas −a1x2 −ao
(
) y3
meas −a1x3 −ao
(
) y4
meas −a1x4 −ao
(
)
⎡⎣
⎤⎦
1
x
1
2
x
1
3
x
1
4
x
1
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
0 0
⎡⎣
⎤⎦
 

(11.7)
	
1
x
2
x
3
x
4
x
1
1
1
1
⎡
⎣⎢
⎤
⎦⎥
y1
meas
y2
meas
y3
meas
y4
meas
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
−
1
x
1
2
x
1
3
x
1
4
x
1
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
a1
ao
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
⎧
⎨
⎪
⎪
⎩
⎪
⎪
⎫
⎬
⎪
⎪
⎭
⎪
⎪
=
0
0
⎡
⎣⎢
⎤
⎦⎥	
(11.8)
	
AtA
a1
a0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
= Atymeas 	
(11.9)
	
a1
a0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
= AtA
(
)
−1
t
A ymeas 	
(11.10)
A matrix whose elements are determined by the selected model; in our case, a lin-
ear form.
	
yk
meas −yk
theory = yk
meas −a1xk −a0 = yk
meas −
xk 1
⎡⎣
⎤⎦
a1
a0
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(11.11)

348
State Estimation in Electrical Power Systems
Example 11.1
Assume a set of measured y’s and the corresponding x values. Form the A matrix 
and A1 = (AtA)–1 that is the covariance matrix.
A =
    1.0000    1.0000
    1.8000    1.0000
    2.0000    1.0000
    3.0000    1.0000
A1 =
    0.4926   -0.9606
   -0.9606    2.1232
xsol =
    0.8547
    0.5084
The linear model whose parameters were obtained by solving the least squares cri-
teria and the set of errors or residuals are shown. The mean residual value and its 
variance are calculated for y = a1x + a0 = 0.8547x + 0.5084.
epsilon (residuals) =
   -0.3631
    0.9532
   -0.4177
   -0.1724
e-mean =  8.3267e-016
e-var =   0.4149
11.2.1	 Power System’s Linear State Estimation
To directly apply the linear model presented by (11.10), we can use an all-real power 
network. The procedure requires a given network structure where topology is already 
determined (i.e., no network topology analysis is conducted); network topology 
would require breaker status information. As a first step, we solve an ideal condi-
tion assuming no errors in the information and we get a base case solution. For the 
second step, we identify the linear model when line power flows are the available 
measured quantities and the information set is redundant; there are more measure-
ments than parameters to be estimated. The third step includes measurements of 
Table 11.1  Data Measurements for 
Example 11.1
xi
yi
1.0
1.0
1.8
3.0
2.0
1.8
3.0
2.9

11.2	
Least Squares, Linear Model
349
real power injections, which might be the case when load information or power 
generation is available.
Example 11.2
Let us apply the least squares criteria to find an estimate of the state for a real 
power-only network. First, let us solve the base case using a power flow solution, and 
then we use line real power flow measurements that include errors (see Figure 11.4). 
Finally, we will consider expanding the initial set of line measurements to include 
nodal power injections coming from generators or loads as shown in Figure 11.5.
Use the power flow equation for each element (11.12) and the nodal power bal-
ance for all the nodes, considering the net power injection as the difference gener-
ated power minus load required: PGK − PLK.
	
−xkmpkm + qk −qm = 0 	
(11.12)
For the base case as a load flow solution, it requires lines/transformers connectivity, 
reactance values, and nodal power conditions. For this case, voltage magnitude is 
assumed 1.0 pu for all nodes, and the state variables are the nodal voltage angles.
Real power flows, base case
Line data   Nsal    Nlleg     x(pu)
   1         1       2       0.1000
   2         2       3       0.2000
   3         5       3       0.1000
   4         4       5       0.1500
   5         4       1       0.1500
Initial Nodal conditions
Node       angle     PG(pu)      PL(pu)
   1       0.0000    0.0000      0.5000
   2       0.0000    1.5000      0.0000
   3       0.0000    0.0000      1.0000
   4       0.0000    0.0000      0.8000
   5       0.0000    0.0000      0.0000
Figure 11.4  Small real power network, flow measurements shown.

350
State Estimation in Electrical Power Systems
Line flows solution, Base case
Line        Nsal    Nlleg    flow(pu)
   1         1       2      -0.8857
   2         2       3      +0.6143
   3         5       3      +0.3857
   4         4       5      -0.4143
   5         4       1      -0.3857
Nodal solution, Base case
Node    angle(deg)   PG(pu)      PL(pu)
   1      -0.2456    0.0000      0.5000
   2      +4.8292    1.5000      0.0000
   3      -2.2100    0.0000      1.0000
   4      -3.5605    0.0000      0.8000
   5      -0.0000    0.8000      0.0000
Now, we write the set of measurements flows shown in Figure 11.4 in terms of 
unknown nodal angles for each real power flow measured as follows:
	
−x12p12 + q1 −q2 = 0
−x21p21 + q2 −q1 = 0
−x41p41 + q4 −q1 = 0
−x54p54 + q5 −q4 = 0
−x32p32 + q3 −q2 = 0
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
	
(11.13)
In matrix form, the information allows to us to visualize the A matrix, which we 
call the measurement matrix as in (11.10). In compact matrix notation, (11.16) 
shows the information and matrix operations to find matrix A.
−x12
0
0
0
0
0
−x21
0
0
0
0
0
−x41
0
0
0
0
0
−x54
0
0
0
0
0
−x32
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
p12
p21
p41
p54
p32
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
meas
+
+1 −1
0
0
0
−1 +1
0
0
0
−1
0
0
+1
0
0
0
0
−1 +1
0
−1 +1
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
q1
q2
q3
q4
q5
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
=
0
0
0
0
0
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
 

(11.14)
	
−[X]pmeas + [M][q] = [0]	
(11.15)
	
pmeas = [X]−1[M][q] = [A][q] 	
(11.16)
[X]	
Diagonal matrix of elements reactance values, according to power 
flow measurement
[M]	
Matrix with node connectivity information of the measured element
pmeas	 Set of measured line power flows

11.2	
Least Squares, Linear Model
351
A	
Matrix for the set of measurements in terms of state variables
θ	
State variables for the electrical circuit
	
[A] = [X]−1[M]	
(11.17)
The solution by least squares is reached once a reference angle is assigned for the 
slack bus.
	
[q] = AtA
(
)
−1
t
A pmeas 	
(11.18)
With the estimated values for nodal angles θ, the residuals ε are calculated.
	
e = pmeas −[A][q] = pmeas −pcalc 	
(11.19)
Real power flows, measurements
Line data   Nsal    Nlleg     x(pu)      pmeasured
   1         1       2       0.1000      -0.9000
   2         2       1       0.1000      +0.8500
   3         4       1       0.1500      -0.4000
   4         5       4       0.1500      +0.4000
   5         3       2       0.2000      -0.6100
Nodal angle estimation, slack is node    5
Node     angle(deg)
   1     +0.0000
   2     +5.0134
   3     -1.9767
   4     -3.4377
   5     +0.0000
Estimation of network Line flows
Line        Nsal    Nlleg     estimated flow
   1         1       2       -0.8750
   2         2       3       +0.6100
   3         5       3       +0.3450
   4         4       5       -0.4000
   5         4       1       -0.4000
Nodal net power estimation, slack is node    5
Node     Pnet(pu)
   1     -0.4750
   2     +1.4850
   3     -0.9550
   4     -0.8000
   5     +0.7450
Flows calculation and residuals
Line        Nsal    Nlleg   pmeasured    pcalc        residuals
   1         1       2      -0.9000      -0.8750      -0.0250
   2         2       1      +0.8500      +0.8750      -0.0250

352
State Estimation in Electrical Power Systems
   3         4       1      -0.4000      -0.4000      -0.0000
   4         5       4      +0.4000      +0.4000      +0.0000
   5         3       2      -0.6100      -0.6100      +0.0000
Matrix A in (11.17) must include equations that relate every available measurement 
to the state variables. Now let us extend the basic model considering that, in Figure 
11.4, some nodal power injections are measured; this is depicted in Figure 11.5. 
The measured nodal powers must also be expressed in terms of the state variables 
of our problem (i.e., nodal angles). To relate nodal power measurements and state 
variables, we use elements from the nodal susceptance matrix to be multiplied by 
the state variables. The original A matrix in (11.14) will be expanded to include 
information about the nodal measurements. From Figure 11.5, the nodal measured 
power P is expressed as:
	
−PL1
−PL3
−PL4
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
B11q1 + B12q2 + B14q4
B32q2 + B33q3 + B35q5
B41q1 + B44q4 + B45q5
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(11.20)
	
−PL1
−PL3
−PL4
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
B11 B12
0
B14
0
0
B32 B33
0
B35
B41
0
0
B44 B45
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
q1
q2
q3
q4
q5
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
	
(11.21)
	
pmeas
Pmeas
⎡
⎣
⎢
⎤
⎦
⎥=
A
B
⎡
⎣⎢
⎤
⎦⎥[q] =
Amod
⎡⎣
⎤⎦[q]	
(11.22)
Figure 11.5  Small real power-only network, line flows, and nodal measurements are shown.

11.2	
Least Squares, Linear Model
353
Submatrix B in (11.22) is a part of the nodal susceptance matrix for the network, 
and it is that portion that relates net measured nodal power to nodal angles. The 
submatrix B is appended to the initial A matrix to form the new measurement 
matrix Amod. The least squares solution is used now to solve for the state variables.
	
[q] = Amod
t
Amod
(
)
−1 Amod
t
pmeas
Pmeas
⎡
⎣
⎢
⎤
⎦
⎥	
(11.23)
Net nodal power measurements
Node     Pnet_measured
   1     -0.4800
   3     -1.0800
   4     -0.7900
Nodal angle estimation, slack is node    5
Node     angle(deg)
   1     -0.1930
   2     +4.7868
   3     -2.4971
   4     -3.5102
   5     -0.0000
Estimation of network Line flows
Line        Nsal    Nlleg     estimated flow
   1         1       2       -0.8691
   2         2       3       +0.6356
   3         5       3       +0.4358
   4         4       5       -0.4084
   5         4       1       -0.3860
Nodal net power estimation, slack is node    5
Node     Pnet(pu)
   1     -0.4832
   2     +1.5048
   3     -1.0715
   4     -0.7944
   5     +0.8442
Flows estimation and residuals
Line        Nsal    Nlleg  pmeasured    pcalc        residuals
   1         1       2     -0.9000      -0.8691      -0.0309
   2         2       1     +0.8500      +0.8691      -0.0191
   3         4       1     -0.4000      -0.3860      -0.0140
   4         5       4     +0.4000      +0.4084      -0.0084
   5         3       2     -0.6100      -0.6356      +0.0256
Nodal power estimation and residuals
Node     Pmeasured     Pcalculated    residuals
   1     -0.4800       -0.4832        +0.0032
   3     -1.0800       -1.0715        -0.0085
   4     -0.7900       -0.7944        +0.0044

354
State Estimation in Electrical Power Systems
11.3	 Maximum Likelihood and Weighted Least Squares
To approach the idea of parameter estimation using a set of measurements that are 
taken from various devices with different quality and performance in their output, 
let us assume that a random variable x with a Normal probability density function 
(11.1) has two samples x1 and x2.
	
PDF x1
( ) =
1
s1 2p e
−x1−m
(
)
2
2s1
2
	
(11.24)
	
PDF x2
(
) =
1
s2 2p e
−x2−m
(
)
2
2s2
2
	
(11.25)
The estimation of μ will be a value that maximizes the probability of getting the 
sample values x1 and x2. The joint probability density is:
	
x = PDF x1
( )PDF x2
(
) =
1
s1 2p e
−x1−m
(
)
2
2s1
2
1
s2 2p e
−x2−m
(
)
2
2s2
2
	
(11.26)
	
x =
1
s1s2
2p
(
)
2 e
−x1−m
(
)
2
2s1
2
−x2−m
(
)
2
2s2
2
	
(11.27)
To maximize the function ξ, it is convenient to transform the exponential (11.27), 
and then find the solution for the gradient equal to zero.
	
Lnx(m) = −Lns1s2
2p
(
)
2 −x1 −m
(
)
2
2s1
2
−x2 −m
(
)
2
2s2
2
	
(11.28)
	
d
dm (Lnx) =
x1 −m
(
)
s1
2
−x2 −m
(
)
s2
2
= 0 	
(11.29)
	
1
s1
2 + 1
s2
2
⎛
⎝⎜
⎞
⎠⎟m = x1
s1
2 + x2
s2
2 	
(11.30)
In matrix form, (11.30) can be written in general terms for A, the observation matrix 
and a weight matrix R. This interpretation will be very useful in cases where more 
measurements are available.
	
1 1
⎡⎣
⎤⎦
1
s1
2
0
0
1
s2
2
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
1
1
⎡
⎣⎢
⎤
⎦⎥m =
1 1
⎡⎣
⎤⎦
1
s1
2
0
0
1
s2
2
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
x1
x2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(11.31)

11.3	
Maximum Likelihood and Weighted Least Squares
355
	
A =
1
1
⎡
⎣⎢
⎤
⎦⎥
R =
1
s1
2
0
0
1
s2
2
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(11.32)
It is readily recognized that (11.31) has the general form of minimum weighted 
squares with the solution as (11.34). This result can be generalized in order to solve 
the state estimation problem for power networks that have measuring devices of 
various qualities and whose individual measurement variances σ2
k are known.
	
AtRAm = AtRxmeas 	
(11.33)
	
m = AtRA
(
)
−1 AtRxmeas 	
(11.34)
Example 11.3
A simple case (see Figure 11.6) will illustrate the derivation of the A, measurement 
matrix and of the weight matrix R, when various measuring devices of different 
quality are used. Assume that three power-measuring devices are used with its 
variance values as listed.
Three measurements for the real power flow p12 are:
	
p12
m,1 = 1.95 s1
2 = 1.5
p12
m,2 = 2.01 s2
2 = 0.5
p12
m,3 = 1.92 s3
2 = 0.8
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(11.35)
The model for power flow measurement in terms of state variables and then matri-
ces A and R can be deduced.
	
x12p12
m,k = q1 −q2 	
(11.36)
	
x12
0
0
0
x12
0
0
0
x12
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
p12
m,1
p12
m,2
p12
m,3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
1 −1
1 −1
1 −1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
q1
q2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(11.37)
Figure 11.6  Flow measurements with different quality devices. 

356
State Estimation in Electrical Power Systems
	
p12
m,1
p12
m,2
p12
m,3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
=
x12
0
0
0
x12
0
0
0
x12
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
−1
1 −1
1 −1
1 −1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
q1
q2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
	
(11.38)
	
A =
x12
0
0
0
x12
0
0
0
x12
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
−1
1 −1
1 −1
1 −1
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
R =
1
s1
2
0
0
0
1
s2
2
0
0
0
1
s3
2
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
⎥
	
(11.39)
The state estimation procedure to find θ1 and θ2 (one nodal angle is reference) using 
(11.34):
	
AtRA
q1
q2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
= AtR
p12
m,1
p12
m,2
p12
m,3
⎡
⎣
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
	
(11.40)
Real power flows, base case
Line data   Nsal    Nlleg    x(pu)
   1         1       2       0.1000
Initial Nodal conditions
Node       angle     PG(pu)      PL(pu)
   1       0.0000    0.0000      0.0000
   2       0.0000    0.0000      2.0000
Line flows solution, Base case
Line        Nsal    Nlleg   flow(pu)
   1         1       2      +2.0000
Nodal solution, Base case
Node    angle(deg)  PG(pu)      PL(pu)
   1     -0.0000    2.0000      0.0000
   2    -11.4592    0.0000      2.0000
Real power flows, measurements
Line data   Nsal    Nlleg    x(pu)       pmeasured    sigma^2
   1         1       2       0.1000      +1.9500      +0.0010
   2         1       2       0.1000      +2.0100      +0.0010
   3         1       2       0.1000      +1.9200      +0.0010
Nodal angle estimation, slack is node    1
Node     angle(deg)
   1     +0.0000
   2    -11.2300

11.3	
Maximum Likelihood and Weighted Least Squares
357
Estimation of network Line flows
Line        Nsal    Nlleg     estimated flow
   1         1       2       +1.9600
Nodal net power estimation, slack is node    1
Node     Pnet(pu)
   1     +1.9600
   2     -1.9600
Flows calculation and residuals
Line        Nsal    Nlleg  pmeasured    pestim       residuals
   1         1       2     +1.9500      +1.9600      -0.0100
   2         1       2     +2.0100      +1.9600      +0.0500
   3         1       2     +1.9200      +1.9600      -0.0400
11.3.1	 Bad Data Detection
Residues are the result of the difference between measured quantities and the cal-
culated value for the same quantity once the state variables are estimated. We have 
stressed the need of redundancy, which is the concept of having more measurements 
than the number of state variables to be determined. This concept makes statistical 
sense when the question of bad data needs to be addressed and resolved. We will 
briefly present the statistical properties that help us to identify, through a hypothesis 
test, whether a measurement or a set of measurements must be rejected because of 
reasonable doubt about belonging to the statistical process and should therefore be 
considered as bad measurements.
For a DC type of network with n total nodes, p power line flows, n nodal volt-
ages, and n nodal power injections, the maximum possible redundancy will be the 
index obtained from the ratio of available measurements to the number of state 
variables; in this case, n nodal voltages are the state variables.
	
RedundancyDC = 2p + Vn + Pn
net
n −1
	
(11.41)
p	
Number of power line flows, from node k to node m
Vn	
Number of node voltage magnitudes, n nodes
Pn
net	 Net power injected at n nodes
n	
Total nodes in the network
For AC networks, the state estimation has several measurements that might include: 
real and reactive power flow in transmission elements (sending and receiving end), 
real and reactive power injections into a node, and nodal voltage magnitudes. Con-
sider a network with np real power flow, nq reactive power flows, n nodes (includ-
ing voltage magnitude, net real power, and net reactive power) and then the total 
number of measurements that might be available with respect to the number of 
nodal voltages and angles as state variables, where one nodal angle is a reference:

358
State Estimation in Electrical Power Systems
	
RedundancyAC = 2np + 2nq + 3n
2n −1
	
(11.42)
The redundancy index is an indication of how the number of measurements relate 
to the number of state variables, but does not addresses the problem of observ-
ability on the network; observability is a property of being able to determine all 
state variables from the set of redundant measurements, which requires them to be 
set strategically given the network topology. A close problem to the observability 
question is how to appropriately locate meters throughout the network and deploy 
them in such a way that no portions of the network are left out (unobservable) at 
the estimation process.
In general, the residue εk is normalized with respect to the standard deviation, 
as in (11.43). The difference between the measured quantity and the predicted value 
by the theoretical model is divided by the standard deviation of the meter; this 
quantity is tied to the meter’s quality.
	
ek = yk
meas −yk
th
sk
	
(11.43)
Assuming that most variables yk are to be measured from the power system and 
follow a Normal probability distribution, the summation of squared normalized 
errors follows a Chi-square χ2
df probability distribution that is characterized by its 
degrees of freedom df (see Figure 11.7).
	
f (x) = Kdf x(df −2)/2e−x/2 	
(11.44)
	
Kdf =
1
2df /2 Γ df
2
⎛
⎝⎜
⎞
⎠⎟	
(11.45)
Where
Kdf	 Constant that depends on the degrees of freedom, df
Γ(df/2)	
Gamma function
To identify which measurements have gross errors, the χ2
df Chi-square distribution 
provides the basis for a hypothesis test. Recognizing that the area under the prob-
ability distribution is 1.0, we would like to find a value of x(α) = c such that the 
calculated value of χ2
df,α has a high probability to yield a reliable state estimation.
	
cdf ,a
2
≤c 	
(11.46)
If the calculated value is less than c in (11.46), we can accept the hypothesis that all 
measurements are within the range of its reasonable variability and accept that the 
set of measurements is a good batch. We can then conclude that the data is useful for 
the estimation process. On the contrary, if the Chi-squared value calculated is larger 

11.3	
Maximum Likelihood and Weighted Least Squares
359
than c, then identification and discarding process for the high value of normalized 
residual should be conducted. In summary, the bad data identification steps are:
1.	 The measurement batch is used for the estimation process through a linear 
or a nonlinear model, depending on the relation for measured quantity and 
state variables.
2.	 Using the estimation results, normalized residuals are used in (11.47).
	
cdf
2 =
yk
meas −yk
th
(
)
2
sk
2
k∑
	
(11.47)
3.	 A probability value of significance α is selected to conduct the hypothesis 
test, which is to accept or reject the set of measurements. Values for α of 
0.95 or 0.99 are commonly used. From tables, such as the short Table 11.2 
for illustrative purposes, depending on α and the degrees of freedom df, the 
c value in (11.46) is identified.
4.	 If the calculated value (11.47) is less than the value c from the Table 11.2, 
then the measurements are accepted as appropriate. If the calculated value 
Figure 11.7  Chi-square probability distribution, χ2
df with df degrees of freedom.
Table 11.2  Values for c in (11.46) Chi-square distribution with df (degrees of freedom) α.
Chi-square χ2
df,α
α = 0.95
α = 0.99
df = 3
7.815
11.35
df = 4
9.49
13.28

360
State Estimation in Electrical Power Systems
(11.47) is larger than c, then some measurement are candidates to be rejected. 
When redundancy is high, discarding some bad measurements would pose 
no problem to the process. If the data to be discarded affects the redundancy 
index, then an average of observed values might replace the bad data; some 
other reasonable criteria can be used to replace the bad data.
When some data is discarded, a new estimation process is conducted using the 
reduced set of measurements. Next, the calculation of Chi-squared for Example 
11.3 shows a Chi-squared = 4.2.
Flows calculation and residuals
Line        Nsal    Nlleg  pmeasured    pestim       residuals
   1         1       2     +1.9500      +1.9600      -0.0100
   2         1       2     +2.0100      +1.9600      +0.0500
   3         1       2     +1.9200      +1.9600      -0.0400
Chi2 = 4.2000
The calculated value is compared to the value in Table 11.2 with number of degrees 
of freedom df = 2 and α = 0.95: χ2
3–1,0.95 = 5.99. The calculated value of 4.2 suggests 
that the measurements are within reasonable error and no data needs to be discarded.
Example 11.4
Consider in Example 11.3 that one measurement fails to reflect a proper value. Con-
sider that the second measurement is given as 1.0. Calculation for the Chi-squared 
value is 583.3, suggesting the existence of bad data.
Real power flows, measurements
Line data   Nsal    Nlleg    x(pu)       pmeasured    sigma^2
   1         1       2       0.1000      +1.9500      +0.0010
   2         1       2       0.1000      +1.0000      +0.0010
   3         1       2       0.1000      +1.9200      +0.0010
Nodal angle estimation, slack is node    1
Node     angle(deg)
   1     +0.0000
   2     -9.3010
Estimation of network Line flows
Line        Nsal    Nlleg     estimated flow
   1         1       2       +1.6233
Nodal net power estimation, slack is node    1
Node     Pnet(pu)
   1     +1.6233
   2     -1.6233
Flows calculation and residuals
Line        Nsal    Nlleg  pmeasured    pestim       residuals
   1         1       2     +1.9500      +1.6233      +0.3267
   2         1       2     +1.0000      +1.6233      -0.6233
   3         1       2     +1.9200      +1.6233      +0.2967
Chi2 =  583.2667

11.4	
Nonlinear Minimum Squares
361
To identify suspicious data with high errors, we use the value of the normalized 
residual (11.43). The value of the second residual points into this measurement as 
a candidate to be analyzed.
Normalized residuals squared
   1     +106.7111
   2     +388.5444
   3     +88.0111
11.4	 Nonlinear Minimum Squares
When the measured variables, such as the real and reactive power flows in an electric 
network, are related by nonlinear relations to the state variables (i.e., for transmission 
elements from node k to node m), we recall that the real and the reactive power are:
	
pkm = Vk
2 gkm −Vk Vm gkm cosqkm −Vk Vm bkm sinqkm 	
(11.48)
	
qkm = −Vk
2 bkm + Bsh/2
(
) −Vk Vm gkm sinqkm + Vk Vm bkm cosqkm 	 (11.49)
Where
Vk = Vk ∠qk 	
Nodal voltage for sending end, node k
Vm = Vm ∠qm 	
Nodal voltage for receiving end, node m
ykm = gkm − jbkm	
Series admittance for the transmission element
Bsh/2	
Capacitive susceptance for the transmission element
If gkm and Bsh/2 are zero, the real and reactive power flow equations from node k 
to node m are simplified, but still remain nonlinear expressions in nodal voltage 
magnitudes and nodal angles, which are identified as state variables.
	
pkm = −Vk Vm bkm sinqkm 	
(11.50)
	
qkm = −Vk
2 bkm + Vk Vm bkm cosqkm 	
(11.51)
The residue εp for real power in a line is (11.52), where pkm = f Vk , Vm ,qk,qm
(
) is 
given by (11.50) and its incremental form as (11.53).
	
ep = pkm
meas −pkm 	
(11.52)
	
Δf = ∂f
∂qk
Δqk +
∂f
∂qm Δqm + ∂f
∂Vk
Vk
Δ Vk
Vk
+
∂f
∂Vm
Vm
Δ Vm
Vm
	
(11.53)

362
State Estimation in Electrical Power Systems
Partial derivatives in (11.53) were presented in Chapter 6, and they will be part 
of the linearized matrix A that is needed to solve the nonlinear AC least square 
estimation problem. The nonlinear estimation is conducted through an iterative 
process and starts with reasonable values for the state variables; an update is then 
obtained. In this process, we also calculate the new values for the partial deriva-
tives. The calculated increments are used to update the values of the state variables.
Example 11.5
We solve a nonlinear state estimation case.
Parameter values and measurements are listed. They include power flows, nodal 
power injection, and nodal voltages. The information about the quality of each 
measured quantity goes into the R matrix. When the iterative process converges, a 
final result shows the state estimation and residuals with respect to the measured 
values. An index is calculated so that a test with the Chi-square distribution can be 
conducted. In this case, five measurements are proposed in order to estimate three 
state variables: two voltage magnitudes and one nodal angle.
General network information and load flow, base case
Number of elements =    1  Number of nodes =    2
Element  Nfrom   Nto             z               bsh/2
   1       1      2      0.0100  +j  0.1000      0.0000
Shunt elements =    1
Element  Node     zshunt
   1       2     0.0000  +j  2.5000
Node data information
Node   type    Voltage   angle(rad)   PG        QG        PL        QL
   1     0     1.0500    +0.0000      0.0000    0.0000    0.0000    0.0000
   2    -1     1.0000    +0.0000      0.0000    0.0000    0.5000    0.2000
Load flow convergence
Iteration =    0   Dmax = 4.504950e-001
Iteration =    1   Dmax = 1.057711e-002
Iteration =    2   Dmax = 1.518130e-005
Iteration =    3   Dmax = 3.037523e-011
Figure 11.8  Power flows, nodal voltages, and nodal power measurements with devices of 
different quality.

11.4	
Nonlinear Minimum Squares
363
Line    Nsal    Nlleg     pkm        qkm
   1      1        2     +0.5061    +0.6490
   1      2        1     -0.5000    -0.5875
Shunt    Nsal     pkm        qkm
   1      2      +0.0000    +0.3875
Node     Voltage    angle(rad)    PG        QG         PL         QL
   1     1.0500     -0.0000      +0.5061    +0.6490    +0.0000    +0.0000
   2     0.9843     -2.4470      +0.0000    +0.0000    +0.5000    +0.2000
Power summary
SGtot =  +0.5061   j +0.6490
SLtot =  +0.5000   j +0.2000
SLoss =  +0.0061   j +0.4490 (Q>0 required by reactive elements)
State Estimation Measurements from network variables
Number of line flows =    2
Element  Nfrom   Nto         z            bsh/2    meas   (1=p,0=q)   s^2
   1       1      2   0.0100 +j  0.1000   0.0000   0.5000     1     2.00e-003
   2       1      2   0.0100 +j  0.1000   0.0000   0.6000     0     4.00e-003
Nodal powers =    1
Injection  Node    meas     (1=P,0=Q)   s^2
   1       2      -0.2100       0     1.00e-003
Nodal voltage =    2
Measur   Node      meas        s^2
   1       1       1.0400    1.00e-003
   2       2       0.9900    1.00e-003
Initial values for state variables
Node     Vmag      angle(rad)
   1     1.0000    0.0000
   2     1.0000    0.0000
Iteration =    1  Maxdesv = 4.738539e-002
Iteration =    2  Maxdesv = 4.430767e-003
Iteration =    3  Maxdesv = 7.984505e-006
Final values for state variables
Node     Vmag      angle(rad)    degrees
   1     1.0437   -0.0000       -0.0000
   2     0.9775   -0.0415       -2.3805
   k     measurement   residue
   1    +0.5000       +0.0021
   2    +0.6000       -0.0414
   3    -0.2100       -0.0120
   4    +1.0400       -0.0037
   5    +0.9900       +0.0116
Index for chi^2-test =   0.7239   degrees of freedom =    2

364
State Estimation in Electrical Power Systems
With results shown for the index Chi-square as 0.7239, 2 degrees of freedom and 
selecting α we should check if the measurements pass the hypothesis test of not 
having bad measurements.
11.5	 Thévenin’s Equivalent and Parameter Estimation
An interesting problem is related to parameter estimation. Let us pose a problem 
about the need of a Thévenin’s equivalent as seen from a given network node. 
Assume that the voltage, current, and power are measured at node 2 in Figure 11.9.
To build the model, let us write the equation with voltages and power. From 
the model, we can deduce the measurement expression.
	
f V2
(
) = V2
2 −V1V2 + rThP2 = 0 	
(11.54)
	
+EThV2 −rThP2 = V2
2 	
(11.55)
With paired values of measurements V2 and P2 (assumed to be simultaneous), we 
write the measurement equation in the form (11.3). A least squares solution will find 
the best estimates for Eth and rTh. The A matrix is identified in (11.56) as (11.58).
	
V2
(1)
(
)
2
V2
(2)
(
)
2
!
V2
(n)
(
)
2
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
=
V2
(1)
−P2
(1)
V2
(2) −P2
(2)
!
!
V2
(n) −P2
(n)
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
ETh
rTh
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
+
e1
e2
!
en
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(11.56)
	
ETh
rTh
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
= AtA
(
)
−1
t
A
V2
meas
(
)
2
⎡
⎣⎢
⎤
⎦⎥	
(11.57)
	
A =
V2
(1)
−P2
(1)
V2
(2) −P2
(2)
!
!
V2
(n) −P2
(n)
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(11.58)
Figure 11.9  Simple network to estimate parameters in a network model.

11.5	
Thévenin’s Equivalent and Parameter Estimation
365
Once the estimated values of Thévenin’s equivalent are done, we estimate the maxi-
mum power that can be transferred by the line and ask what the voltage collapse 
margin is.
	
P2
max = ETh
2
4rTh
	
(11.59)
Example 11.6
Assume an equivalent network (as in Figure 11.9) whose voltage ETh and equivalent 
resistance rTh change due to network topology variations as rTh = 0.05, 0.10, 0.15 
and ETh = 1.0. We collect various pairs of measurements at node 2 as voltage and 
power. With (11.57), the Thévenin’s equivalent is estimated and then we find the 
margin to voltage collapse.
   k      rTh         Pmax
   1      0.0500      5.0000
   2      0.1000      2.5000
   3      0.1500      1.6667
With the use of four pairs of measurements available at a given time, find an estimate 
for components ETh and rTh of the Thévenin’s equivalent. Calculate the limit for power 
transfer and the so-called power margin for each of the measured power values.
Data from measurements
   k      Voltage     Power P
   1      0.9762      0.4639
   2      0.8545      2.4860
   3      0.9259      1.3718
   4      0.8122      3.0500
Figure 11.10  PV curves for circuit in Figure 11.9, ETh = 1.0.

366
State Estimation in Electrical Power Systems
Estimation
ETh =   1.0000    rTh =   0.0500    Pmax =   4.9996
   k      Voltage     Power        Residual          Pmargin
   1      0.9762      0.4639       -7.5322e-006      4.5357
   2      0.8545      2.4860       -1.2247e-006      2.5136
   3      0.9259      1.3718       +1.3160e-005      3.6278
   4      0.8122      3.0500       -5.1933e-006      1.9496
The procedure to estimate the Thévenin equivalent continues as sets of new mea-
surements arrive at the processing facility. To monitor the estimation process, it is 
advisable to implement a performance index so that changes in the equivalent can 
be detected. The changes can be the result of lines switching or power generators 
being in or out of service. These changes have a more pronounced effect in weak 
systems, where it is highly recommended to implement the scheme described as a 
regular control function. The procedure is quasistatic and assumes that the set of 
measurements belong to a homogeneous operating condition.
11.6	 Phasor Estimation and Related Problems
An important and relevant application is the one related to rms phasor estimation 
(i.e., magnitude and angle of a phasor with respect to a reference). This application 
is sure to gain more attention as its use becomes more widespread in the electric 
system’s monitoring and control. In a given bus of a three-phase balanced system, 
operating in steady state, a system’s frequency might be considered constant at the 
nominal value of 60 Hz. Voltage measurement is done through power transform-
ers where the high voltage value is reduced to a standard value of 69.9 V and the 
high current measurement is reduced to 5 A by a current transformer, using the 
appropriate transformer ratios. Analog signals are filtered in order to block high 
frequency signals and noise in general; ideally, the sampled values are from a pure 
60 Hz sinusoidal signal except for a fault current condition where an aperiodic (DC) 
component might be present.
From the filtered 60 Hz signals for voltage and current, sampling is conducted 
at a convenient rate (i.e., twelve samples per cycle or a faster rate). With the sampled 
values vk and ik at time tk, the magnitudes ⎪Vk⎪, ⎪Ik⎪, and angles θkV, θkI are esti-
mated using the 12 samples available or a reduced window where three or more 
samples can be used. This depends on the properties that we want from the window 
of observation. Example 11.7 and Figure 11.10 show uniform sampling for an rms 
phasor, magnitude 120/ 3  V, and a phase angle of 45°.
Example 11.7
Uniform 12 sampled values (see Figure 11.11) for a voltage signal v(t) = 97.98 cos 
(2πft + π/4) V.
Time samples of voltage, V
Sample    time(s)       voltage(V)

11.6	
Phasor Estimation and Related Problems
367
   1      0.000000       69.2820
   2      0.001389       25.3590
   3      0.002778      -25.3590
   4      0.004167      -69.2820
   5      0.005556      -94.6410
   6      0.006944      -94.6410
   7      0.008333      -69.2820
   8      0.009722      -25.3590
   9      0.011111       25.3590
  10      0.012500       69.2820
  11      0.013889       94.6410
  12      0.015278       94.6410
The task of monitoring and evaluating of the electrical system’s health can be 
organized with an adequate set of phasor measurement units (PMUs) at various 
electrical nodes. A complete wide-area measurement network can be designed using 
synchro phasors with adequate resolution and synchronized in time. This system’s 
information will help monitor and closely control a modern power system in real 
time. The techniques used to estimate the actual value of phasors are related to the 
least square fitting applications, some take advantage of the Fourier’s formulation 
or Kalman’s filter recurrent calculations, especially as applied to sampling at appro-
priate rate. Ingenious and straightforward forms are also available. We do not delve 
into variations, just some examples to capture the flavor of the applications into the 
measurements with the aim of monitoring or for power system’s protection, which 
is an interesting world in itself.
Example 11.8
Assume that a sampling point in a balanced three-phase network has a Thévenin 
equivalent and a three-phase fault is ensued along a transmission line (see Figure 11.12). 
Figure 11.11  RMS phasor voltage, 12 samples per cycle. Vrms = 69.28 V, ϕ = 45°. 

368
State Estimation in Electrical Power Systems
Figure 11.12  Three-phase balanced fault for an AC network equivalent. 
Figure 11.13  Simulink diagram for a three-phase fault. Source voltage V1 at the switch SW and 
fault current. The sampling rate is twelve samples per cycle. 
Figure 11.14  Voltage at source at V1, sampling of voltage at SW and fault current; twelve 
samples per cycle. 

11.6	
Phasor Estimation and Related Problems
369
Consider that load current—previous to the fault condition—is negligible and simu-
late the fault by closing switch SW when the voltage source is crossing at zero.
The case in Example 11.8 shows an ideal situation without noise components; 
only the DC current offset is present, use is made of simulation by Figure 11.13 
and results in Figure 11.14. To estimate the voltage phasor, let us use four samples 
according to one of many variations that can be used. With 12 samples/cycle Δt = 
1/(12 f) = 1/720 seconds, considering a constant frequency of 60 Hz. For a cosine 
voltage with angle ϕV, at every sample time tk, (11.61) shows elements to form the 
measurement matrix A in order to apply the squared minimum estimation.
	
V(t) = Vm cos wt + fV
(
)	
(11.60)
Vk = Vm cos wtk
(
)cosfV −sin wtk
(
)sinfV
(
) = cos wtk
(
)Va −sin wtk
(
)Vb 	
(11.61)
With four samples, we estimate components Va and Vb, and then the magnitude 
Vm and angle ϕV.
	
Vk
Vk+1
Vk+2
Vk+3
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
=
coswtk
−sinwtk
coswtk+1
−sinwtk+1
coswtk+2 −sinwtk+2
coswtk+3 −sinwtk+3
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
Va
Vb
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
+
ek
ek+1
ek+2
ek+3
⎡
⎣
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
	
(11.62)
	
Va = Vm cosfV
Vb = Vm sinfV 	
(11.63)
	
Vm =
Va
2 + Vb
2
fV = tan−1 Vb
Va
⎛
⎝⎜
⎞
⎠⎟	
(11.64)
The rms voltage phasor is estimated by:
	
V = Vm
2 ∠fV 	
(11.65)
RMS Phasor estimation
frequency   Samples/cycle   Sampling time(s)    Sampling (degrees)
   60            12            1.3889e-003           30.00
Sample    Voltage, V
   1    +0.0000e+000
   2    +2.0400e+005
   3    +3.5334e+005
   4    +4.0800e+005
   5    +3.5334e+005
   6    +2.0400e+005

370
State Estimation in Electrical Power Systems
   7    +2.3115e-010
   8    -2.0400e+005
   9    -3.5334e+005
  10    -4.0800e+005
  11    -3.5334e+005
  12    -2.0400e+005
A matrix                     measurements, V
  1.000000     -0.000000     +0.0000e+000
  0.866025     -0.500000     +2.0400e+005
  0.500000     -0.866025     +3.5334e+005
  0.000000     -1.000000     +4.0800e+005
Va = -1.4552e-011    Vb = -4.0800e+005
Vm = +4.0800e+005    Vrms = +2.8850e+005   angle =  +90.00
Example 11.9
For Example 11.7, we notice that the fault current might have a DC or asymmetri-
cal component (in this case, the rms phasor for the current might not be directly 
estimated). One possible solution is to first estimate R and LL components for the 
circuit; this can be an opportunity to extend our minimum square estimation process.
First, let us write the differential equation that describes the voltage and current 
in the time domain. Then, by discrete integration using the trapezoidal rule from 
sample values for voltage and current at times tk and tk+1, we have a sampled form 
that can be used to estimate the unknowns R and LL.
	
v1(t) = Ri(t) + LL
di
dt 	
(11.66)
	
v1(t)
tk
tk+1
∫
dt = R
i(t)
tk
tk+1
∫
dt + LL
di
tk
tk+1
∫
	
(11.67)
	
v1 tk
( ) + v1 tk+1
(
)
⎡⎣
⎤⎦
Δt
2 = R i tk
( ) + i tk+1
(
)
⎡⎣
⎤⎦
Δt
2 + LL i tk+1
(
) −i tk
( )
⎡⎣
⎤⎦	 (11.68)
Using three samples, the model from (11.68) is:
i tk
( ) + i tk+1
(
)
⎡⎣
⎤⎦
Δt
2
i tk+1
(
) −i tk
( )
⎡⎣
⎤⎦
i tk+1
(
) + i tk+2
(
)
⎡⎣
⎤⎦
Δt
2
i tk+2
(
) −i tk+1
(
)
⎡⎣
⎤⎦
i tk+2
(
) + i tk+3
(
)
⎡⎣
⎤⎦
Δt
2
i tk+3
(
) −i tk+2
(
)
⎡⎣
⎤⎦
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
R
LL
⎡
⎣⎢
⎤
⎦⎥=
v1 tk
( ) + v1 tk+1
(
)
⎡⎣
⎤⎦
Δt
2
v1 tk+1
(
) + v1 tk+2
(
)
⎡⎣
⎤⎦
Δt
2
v1 tk+2
(
) + v1 tk+3
(
)
⎡⎣
⎤⎦
Δt
2
⎡
⎣
⎢
⎢
⎢
⎢
⎢
⎢
⎤
⎦
⎥
⎥
⎥
⎥
⎥
⎥
	 (11.69)
R and LL estimation
Nsamples =        5

11.6	
Phasor Estimation and Related Problems
371
Samples    Current          Voltage
   1      0.0000e+000      0.0000e+000
   2      1.0041e+003      1.5930e+005
   3      3.7088e+003      2.7724e+005
   4      7.3328e+003      3.2216e+005
   5      1.0850e+004      2.8200e+005
R =   3.0049 Ohms     LL =   0.1085 H
The estimated values for R and LL compare well to the true values for the resis-
tance of R = 3 ohms and inductance LL = 111.2 H. With the estimated values, the 
nonperiodic component in the current can be removed and the rms phasor current 
estimated. In some applications, like in protective relaying, the parameter estima-
tion for R and LL will allow distance estimation to the fault location so that it can 
be situated within an expected distance with a tolerance; the tolerance is a result of 
various uncertainties imbedded within the measurements and the sampling. Errors 
in measurements come mainly from current transformers (CTs), the fault impedance 
and possible interference as noise.
11.6.1	 Wide Area Measurements
Phasor estimation and its applications is a fertile and rapidly evolving field. It is 
aimed at closely monitoring the quality of electrical processes that a power system 
is experiencing and a set of indicators to evaluate what can be considered the sys-
tem’s health. Voltage and reactive power flows, frequency, power flows, oscillations, 
and damping characteristics are several of the main variables to monitor to ensure 
secure system’s operation.
Figure 11.15  Wide area measurements, PMUs, LPCs, and SDCs. 

372
State Estimation in Electrical Power Systems
Voltage magnitude monitoring and estimation of the power margin were just 
touched upon in this chapter; frequency deviation from the rated system’s frequency 
is also a concern when phasor estimation is conducted. These problems can be tack-
led by what is now known as wide area measurement (WAM) (see Figure 11.15), 
which is a carefully designed system of data gathering by PMUs, local phasor con-
centrators (LPCs) that gather selected information from PMUs, and the system data 
concentrators (SDCs).
Applications for power system’s security need to evaluate its performance under 
a frequency changing condition (see Figure 11.16). The question of how a change 
in frequency affects the phase of phasors or the calculation of symmetrical compo-
nents must by included in the estimation process. Frequency measurement is also 
an issue, as well as the question of how unbalanced the system condition is. Tran-
sient phenomena related to electromechanical oscillations, the transient response 
of current and potential transformers, and the filter response when used for signal 
conditioning are some of the interesting concepts that are being studied right now 
for monitoring and control in electrical power systems.
11.7	 Observability
One interesting problem is that of analyzing how much redundancy is needed for a 
good estimation process. This has technical and economic implications. We would 
like to have a good level of redundancy, observability at the best cost. A related 
issue is what set of values should be measured? What is a set that allows us to have 
observability over the state variables in the system? This situation is important in 
bad data detection and we must be able to discard measurements that statistically 
Figure 11.16  Phasor in a changing frequency condition. 
Figure 11.17  Flow measurement and measurement equation. 

11.7	
Observability
373
are unreliable or are suspected of not belonging to the set of measurements that 
allow the best estimation for the state condition of the power system.
Example 11.10
Let us follow what happens when we have just one measurement for power flow 
p12 and we like to estimate the state variable θ2 (see Figure 11.17). The real power 
model is used and the A measurement matrix is written.
	
−p12x12 + q1 −q2 = 0 	
(11.70)
	
1 −1
⎡⎣
⎤⎦
q1
q2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
=
−x12
⎡⎣
⎤⎦p12
⎡⎣
⎤⎦
A =
1 −1
⎡⎣
⎤⎦	
(11.71)
To solve for minimum squares:
	
q1
q2
⎡
⎣
⎢
⎢
⎤
⎦
⎥
⎥
= AtA
(
)
−1 At −x12
⎡⎣
⎤⎦p12
⎡⎣
⎤⎦	
(11.72)
We can take a closer look into the matrix AtA.
	
AtA
(
) =
+1
−1
⎡
⎣⎢
⎤
⎦⎥
+1 −1
⎡⎣
⎤⎦=
+1 −1
−1 +1
⎡
⎣⎢
⎤
⎦⎥	
(11.73)
In (11.73), we have a singular matrix that cannot be inverted, and we must solve 
for the state variables. We can say that the state variables cannot be estimated. If 
we take one node as reference, the process can continue, but with only one mea-
surement to determine one state variable, results are adjusted to meet the measured 
value. We can appreciate that we really need more measurements to conduct a good 
estimation process.
Real power flows, base case
Line data   Nsal    Nlleg     x(pu)
   1         1       2       0.1000
Initial Nodal conditions
Node       angle     PG(pu)      PL(pu)
   1       0.0000    0.0000      0.5000
   2       0.0000    0.0000      1.0000
Line flows solution, Base case
Line        Nsal    Nlleg   flow(pu)
   1         1       2      +1.0000
Nodal solution, Base case
Node    angle(deg)  PG(pu)      PL(pu)
   1     -0.0000    1.5000      0.5000
   2     -5.7296    0.0000      1.0000

374
State Estimation in Electrical Power Systems
Real power flows, measurements
Line data   Nsal    Nlleg     x(pu)      pmeasured
   1         1       2       0.1000      +0.9500
ans =
    0.0000    0.0000
    0.0000    0.0100
Nodal angle estimation, slack is node    1
Node     angle(deg)
   1     +0.0000
   2     -5.4431
Estimation of network Line flows
Line        Nsal    Nlleg     estimated flow
   1         1       2       +0.9500
Nodal net power estimation, slack is node    1
Node     Pnet(pu)
   1     +0.9500
   2     -0.9500
Flows calculation and residuals
Line        Nsal    Nlleg  pmeasured    pestim       residuals
   1         1       2     +0.9500      +0.9500      +0.0000
References
[1]	
Stevenson, W. D., Elements of Power System Analysis, Second Edition, New York: 
McGraw-Hill Book Company, 1962.
[2]	
Stagg, G., and A. E. El-Abaid, Computer Methods in Power System Analysis, Tokyo, 
Japan: McGraw-Hill Book Company, 1968.
[3]	
Elgerd, O. I., Electric Energy Systems Theory: An Introduction, Second Edition, New 
York: McGraw-Hill Book Company, 1982.
[4]	
Wood, A. J., B. F. Wollenberg, and G. B. Sheble, Power Generation, Operation and Con-
trol, Hoboken, NJ: IEEE Wiley 2014.
[5]	
Phadke, A. G., and J. S. Thorp, Synchronized Phasor Measurements and their Applica-
tions, New York: Springer, 2008

375
About the Author
Dr. Acha holds a Ph.D. in power systems from the University of Texas at Arlington. 
He spent a postdoctoral year at the Energy System Research Center, University of 
Texas at Arlington, and also holds an M.Sc. in power engineering from Seccion de 
Graduados ESIME-IPN, México City.
His main interests are modeling and analysis of AC-DC electric power systems, 
network planning, power system operation security and reliability, monitoring, and 
control in the context of wide area measurements and protection measures for large 
electrical power systems. He is a promoter of HVDC ties between countries and 
electric regions as a means to fully take advantage of energy exchanges for economic 
and system reliability reasons.
Dr. Acha has been involved for several years in specialized training for utility 
engineers in Mexico and Central and South America; he firmly believes in training 
to advance utility personnel into a deeper and wider understanding of the funda-
mental principles that govern the action of electrical power systems.
Dr. Acha has experience in power system operation and has worked at the 
National Control Center for a large utility in Mexico. He has been involved with 
various Mexican universities, directing and conducting applied research in the 
planning and operation of electric utilities. He taught undergraduate and gradu-
ate courses in the EE power curricula for several years and has published several 
research papers in the areas of interest.


377
Index
A
ABCD constants, 146–51
equivalent for series connection, 148
nodal admittance matrix from, 148–51
power flow calculations with, 151–54
series connection of two models, 148
shunt admittance and, 147
for two-port network, 147
Admittance matrix
fault, 307, 311
nodal, 35, 53, 83, 200
shunt, 121
three-phase, 202
Asymmetrical component, 370
Autotransformer
connections, 88
defined, 85
equivalent for, 86, 87
equivalent values for, 88
single-phase, 86
See also Transformer models
Axial conductors, 102–5
B
Backward substitution, 40
Backward waves, 157, 158
Bad data detection, 357–61
Bad measurements, 357, 360
Balanced complexors, 18
Base case load flow, 321
Best state estimation, 343
Branches, 38
Bundled conductors, 105–7, 136
C
Cables
calculation of parameters, 122
cross section, 123
horizontal underground arrangement, 125
one-phase armored, 127
series impedance, 123–26
series impedance matrix, 125–26
shunt capacitance, 126–27
spacing for neutral and phase conductor, 
124
tape shielded, 126
three-phase, 127–32
See also Transmission lines
Capacitance
Gauss’ law and, 117–22
mutual, 129
phasor representation for, 11
shunt, 126–27
three-phase cables, 128
Capacitance matrix, 120
Capacitors
defined, 10
electric charge storage, 31
phasor model for, 10
voltage and current through, 9
voltage-current characteristics, 32
Carson’s equations, 112, 113, 114, 122
Characteristic impedances
boundary conditions at point of connection, 
160
configuration of elements and, 165
defined, 158
element transition point, 159
Charges, potential at midpoint between, 119
Chi-square probability distribution, 358, 359
Circle diagrams
at receiving end, 152
at sending in, 154
use of, 153
Circuits
AC, power and energy in, 6–11
AC, voltage and current in, 6
branches and links, 38

378
Index
Circuits (Cont.)
DC, 4–6
with lumped elements, 32–33
magnetic, 318–20
mathematical, 42
number required to transport electric 
power, 139–40
series RLC, 66
Thévenin’s equivalent, 42, 43
work and energy in, 4–18
See also Equivalent circuits
Clarke’s transformation, 62
Compensating current, 54
Complex numbers, 23–25
Complexors
balanced, 18
cosine time function, 6
defined, 6
rotating, 8
Complex plane
defined, 23
illustrated, 24
Complex power, 200
Complex transformers
with complex tap, 250
ideal, 283
incremental reactive power flow in, 179–80
incremental real power flow in, 176–79
for OLTC configuration, 293
overview, xvi
power flows in, 283
Conductors
axial, 102–5
bundled, 105–7, 136
four-strand, 133
geometric distances of, 114
parallel, 102, 104, 105, 107
parallel, over ideal plane, 120
parallel to ideal equipotential plane, 119
retained, 136
round, 101
single, 100–102
three-strand, 132
transmission arrangement and geometry, 
107
Congestion
minimum control effort and, 262
problem, 262
Constant flux linkages, 318
Contingencies
cause of, 322
reactive power under, 335–40
voltage under, 335–40
Contingency analysis
defined, 322
general system incremental linear network, 
323–27
introduction to, 321–23
participation factors, 340–42
sensitivity matrix, 327–29
single contingency model, 329–40
summary, 342
Control actions, 198–200
Cost
equal incremental solution, 212
incremental, 214, 216, 218, 239
marginal, 212
real power marginal, 226
short-term marginal, 208, 235
thermal, 239
See also Minimum operating cost
Cost criterion, 207
Cost function
establishing, 208
in minimum control effort, 265
optimal problem, 218
surface and equality constraint, 210, 214
surface illustration, 209
value, 211
Cramer’s rule, 42
Currents
AC circuits, 6
compensating, 54
continuity of, 162, 163
nodal, 21, 36
three-phase unbalanced, 65
through resistance, 8
traveling, 160, 161
D
DC circuits, 4–6
DC current transmission element, 194
DC load, 292
DC network power flow solutions
incremental power flow equations, 194–98
overview, 193–94
Decoupled optimal power flow solution, 229
Decoupled power flow calculation, 193
Decoupled sequence matrix, 117
Decoupling
defined, 59
of state equations, 64–67

Index
379
∆∆ connection
current information, 76
illustrated, 75
partial inversion, 76
symmetrical components transformation, 76
three-phase bank, 74–77
E
Earth return, 112–17
Eigenvalue problem, 60
Eigenvalues, 61
Eigenvectors, 61
Electrical length, 28
Energy
in AC circuits, 6–11
average use per capita, 2
consumption, USA, 3
in electric circuits, 4–18
kinetic, 276–77
main sources of, 2
systems, 1–18
total, 275
by type of source, 3
work and, 273–82
Equal incremental costs
penalty factor and, 218
solution, 211–12, 218
Equality constraint
cost function surface and, 210, 214
hydrothermal coordination, 234–35
Equivalent circuits
incremental reactive power flow, 188
incremental real power flow, 186–87, 251
long transmission lines, 144–46
outage admittance, 330
single-phase transformer model, 69
Thévenin’s, 167
three windings transformer, 90
voltage source converter (VSC), 287
Equivalent depth, 112
Equivalent height, 133–34
Equivalent incremental cost, 239
Equivalent resistance, 31
Error frequency, 295
F
Faraday’s law, 30, 99
Fast decoupled load flow, 189, 191, 322, 338
Fault admittance matrix, 307, 311
Fault connections
circuit interpretation for, 312–17
matrix, 299
negative sequence, 304
one-phase to ground, 313
series, 309, 311
three-phase, 299
unbalanced, 308, 316
Fault currents, 312
Fault equation
in coordinates 012, 298
in phase coordinates abc, 297–98
Thévenin’s equivalent and, 298
Faults
contingencies and, 322
current calculation, 317–18
introduction to, 297
series, 309–12
shunt, 307–9
single-phase, 312–14
studies of, 297–320
three-phase, 300–307, 368
between two phases, no ground, 314–16
between two phases and ground, 316–17
Fictitious node, 303
Flexible AC transmission system (FACTS), 249
Flow measurements, 355, 372
Flux linkages, 103
Force
defined, 274
distance and, 273–74
rotating torque, 275
vector, 274
Forward waves, 157, 158
Four-node system load flows, 231
G
Gaussian elimination, xv, 27, 41
large scale network equivalents, 48
linear equations and, 40–44
Gauss’ law, 117–22
Geometric inductance, 112
Geometric inductance matrix, 103
Geometric mean radius (GMR), 103, 132–33
Ground wires
boundary conditions for, 108
inclusion, 107–9
partial inversion, 109
H
Hessian matrix, 237
Hydrothermal coordination
cascaded case, 241

380
Index
Hydrothermal coordination (Cont.)
defined, 233
demand requirement, 236
equality constraint, 234–35
generation blocks, 239
generation to supply demand and losses, 
241
illustrated, 235
incremental costs, 235–36
incremental water flow, 235
load demand for time changing values,  
239
objective function and constraints, 234–42
of power system, 233–342
solution, 238
steps, 233–34
variations, 242
I
Image method, 121
Impedance
mutual, 129, 130
from Ohm’s law, 34
self, 130
sequence, 111–12
series, 113
surge, 143–44
three windings transformer, 89
transformation, 111
Impedance matrix
reduced, 116
series, 112
transposed transmission line, 110
values, 53
Implicit method, 205
Incremental costs
equal, 218
equivalent, 239
hydrothermal coordination, 235–36
optimal gradient, 214
penalized, 216
Incremental DC power flow equations, 
194–98
Incremental power, 194–95
Incremental power flows
complex power transformer, 175–80
control actions and, 198–200
expressions for, 284–87
partial derivatives, 285
three-node system, 201
three-node system illustration, 198
transmission lines, 180–82
Incremental power model, 282–87
DC load, 292
extensions to, 290–92
reactive power and voltage control, 290–92
Incremental reactive power flows
equivalent circuit, 188
linearized model, 323
model, 258
with partial derivatives, 187, 188
series and shunt components, 259
in transformer, 179–80
transmission line, 181–82
Incremental real power flows
equivalent circuit, 187, 251
with partial derivatives, 188
in transformer, 176–79
transmission line, 181, 182
Incremental torque, 277
Incremental water flow, 235
Inductance
geometric, 112
Ohm’s law and, 31
reduced transient, 318
series, 99–112
subtransient, 319
Inductive compensation, 290–91
Inductors
circuit representation, 31
defined, 9
Inequality constraints, 213–16
Inertia constant, 278
Instantaneous power, 11–13, 274
Inverse Laplace transform, 157, 158
J
Jacobian matrix, 199, 200
Jules, 274
K
Kinetic energy, 276–77
Kirchhoff’s current law (KCL), 27, 33–35
circuit configuration and, 33
in circuit solution, 18
current summation, 20
in matrix form, 34
Kirchhoff’s voltage law (KVL), 38–39
Kron’s reduction, 44
Kuhn-Tucker multiplier, 214, 271

Index
381
L
Lagging power factor, 16
Lagrange function, 218–19, 222
Lagrange multipliers, 208, 219, 237
Lagrangian equation and gradients, 212
Laplace transform, 279
Laplace transformed equations, 156
Lattice diagrams, 165–66
Leading power factor, 16
Least squares
criteria, applying, 349
principle, xviii
solution, 353
weighted, 354–61
Linear circuits, 327–29
Linear equations, 40–44
Linear models
for fast studies, 323
for incremental real power flow, 323
least squares, 345–53
sparse techniques, 325
steps for network solution, 324–25
Linear state estimation, 348–53
Line transposition, 109–10
Links, 38
Load center, generation site remote from,  
140
Load convention
for power flows, 13–18
using, 33
Load flows
AC solutions, 282
base case, 321
equations, 183
fast decoupled, 189, 191, 322, 338
four-node system, 231
incremental AC formulation, 198
for minimum loss solution, 225, 230
problem, 182
results, 185
small DC solution, 198
solution by Newton’s method, 285–87
solution diagram, 191
three-phase, 202, 203
Load intervention, 153
Local phasor concentrators (LPCs), 372
Longitudinal networks
defined, 255
real power flow control, 255–58
sparse patterns for matrix, 256
Long transmission lines
equivalent circuit, 145–46
flat line concept, 143
incremental distance in, 141
no-load line, 144
nominal π and equivalent circuit, 144–45
propagation velocity, 143–44
surge impedance, 143–44
V(x) and I(x) equations in, 141–46
wave length, 143–44
See also Transmission lines
Loop-element connection matrix, 39
Losses
hydro and thermal generation, 241
minimum, 218–22
no, optimal dispatch with, 211–16
penalized incremental, 219
real power, 216–18, 233
transmission, 222–23
Lumped elements, circuits with, 32–33
M
Magnetic circuits
illustrated, 318, 319
subtransient response, 319–20
transient response, 318–19
Marginal cost, 212
Mathematical circuits, 42
Matrix inversion
defined, 44
lemma, 56–57
Matrix of potentials, 120
Matrix transformation, 62–64
Measurement error, 346
Measurement matrix, xviii, 351, 372
Measurements
bad, 357, 360
in estimation process, 373–74
flow, 355, 372
good batch, 358
nodal power, 362
in RTU, 344
voltage, 366
wide area, 371–72
Mesh equations, 28
Minimum control effort
congestion and, 262–73
cost function, 265
defined, 262
optimal coordinated control, 270–73

382
Index
Minimum control effort (Cont.)
reactive power flow control, 268–70
real power flow control, 250, 265–68
sensitivity coefficients, 262–64
three-node system, 266, 268
Minimum effort, 198
Minimum losses, 218–22
Minimum operating cost
power flow formulation, 225–33
power systems, 207–8
three-node system load flows for, 225, 230
Minimum squares estimation, xviii
Minimum weighted squares, 355
Mutual capacitance, 129
Mutual impedance, 129, 130
N
Negative sequence connections, 304
Network analysis
circuits with lumped elements, 32–33
diakoptical approach, 54–56
introduction to, 27–29
Kirchhoff’s current law (KCL), 33–35
Kirchhoff’s voltage law (KVL), 38–39
large scale network equivalents, 48–54
linear equations and Gaussian elimination, 
40–44
matrix inversion lemma, 56–57
nodal formulation, 35–38
Norton’s and Thévenin’s equivalents, 47–48
Ohm’s law, 29–32
YBUS and ZBUS matrix elements, 44–47
Network equivalents
illustrated, 51, 52
large scale, 48–54
partitioned, 49–54
See also Norton’s equivalent; 
Thévenin’s equivalent
Newton-Raphson iterative method, 169
Newton’s incremental form, 216–17
Newton’s iterative process, 172–73, 220, 226, 
237
Newton’s power flow solution, 174–75, 182–
85, 285–87
Nodal admittance matrix, 53, 83, 200
from ABCD constants, 148–51
defined, 36
Nodal current equations, 34
Nodal currents, 21, 36
Nodal equations, 28
Nodal formulation, 35–38
Nodal method, 35, 36
Nodal voltages, 12, 200, 331
Node currents
three-phase complex transformer, 75, 78, 80
three phase transformer, 92, 93
Node elimination
circuit illustration, 41
Norton’s equivalent after, 40
Node equation, 33
Node voltages, 27
Nonlinear equations
DC real power flow problems and, 172
low voltage solution, 173
Newton’s iterative process, 172–73
solution of, 169–73
Nonlinear minimum squares, 361–64
Normal probability distribution, 345, 354, 
358
Norton’s equivalent, 47–48
after node elimination, 40
after node one elimination, 48
defined, 27
for synchronous generator, 201
O
Observability, 358, 372–74
Observation matrix, 354
Ohm’s law, 20, 28, 29–32
admittance form, 35
compact matrix equation, 74–75
inductance and, 31
model, 188
One-phase to ground fault connection, 313
on load tap changer (OLTC), 284
complex power transformer, 293
real and reactive power flows, 292–95
Open circuit coefficients, 27
Open conductor, 200
Optimal control coordination, 295
Optimal coordinated control efforts, 270–73
defined, 270
load flow solution, 273
sensitivity coefficients, 271
tap chance, 271
voltage magnitudes, 273
Optimal operation of power systems, 207–48
hydrothermal coordination, 233–42
introduction to, 207
minimum losses, 218–22

Index
383
minimum operating cost, 207–8
nonlinear optimization, 207–11
optimal dispatch with no losses, 211–16
real power losses, 216–18
second-order derivatives, 242–48
transmission losses included, 222–33
Optimal reactive power flow control, 268–70
Optimal real power flow control, 265–68
Organization, this book, xv–xviii
Outage admittance, 330
P
Parallel conductors
bundle, 105
interpretation of equivalent impedance, 107
over ideal plane, 120
set of three, 102, 104
Parameter estimation
simple network for, 364
Thévenin’s equivalent and, 364–66
Partial derivatives
calculation, 196
incremental power, 194–95
incremental power flows, 285
reactive power, 244
of second-order, 246–48
Partial inversion, xv, 27, 42–44
algorithm, 97–98
bundled conductors, 106
ground wire inclusion, 109
large scale network equivalents, 48
lemma, 54
procedure, 43–44
rules, 43
single-phase transformer model, 68, 72
three-phase ∆∆ bank, 76
three-phase Y∆ bank, 78
Partial matrix inversion, 36, 72
Participation factors, 340–42
Partitioned networks, 49–54
Passive elements, 28
Phase shifters, 187, 328
Phasor measurement units (PMUs), 345, 367
Phasors, 7–11
capacitance representation, 11
in changing frequency condition, 372
estimation, 366–72
inductance representation, 10
in resistance, 9
voltage and current, 9, 14
Piecewise networks, 55
Power
in AC circuits, 6–11
complex, 200
in DC circuits, 4–6
incremental, 194–95
instantaneous, 11–13, 274
mismatches, 285
nominal, 278
reactive, 12–13, 141, 151, 244, 246–48, 
335–40
real, 12–13, 151
for three-phase circuit, 18–23
time versus, 275
triangles, 14
turbine’s, 277–79
Power balance, 278
Power factor
effect on voltage, 19
lagging, 16
leading, 16
table, 18
Power flow calculations
with ABCD constants, 151–54
circle diagram, 152, 153, 154
decoupled, 193
Power flow equations, 175–82
Power flows, 169–205
approximations, 186–93
in complex transformer, 283
DC network solutions, 193–98
incremental, 175–82
introduction to, 169
lagging power factor, 16
leading power factor, 16
load, base case, 270
load convention for, 13–18
minimum cost formulation, 225–33
Newton’s solution, 174–75, 182
PV curve, 170
real, control of, 250–58
solution of nonlinear equations, 169–73
for three-phase circuit, 19
in transmission line, 284
unbalanced three-phase, 200–205
Power margin, 365, 371
Power mismatch equation, 184
Power systems
fault studies, 297–320
health, 371

384
Index
Power systems (Cont.)
hydrothermal coordination, 233–42
linear state estimation, 348–53
measurements in RTU, and control center, 
344
minimum losses, 218–22
minimum operating cost, 207–8
nonlinear optimization, 207–11
optimal dispatch with no losses, 211–16
optimal operation, transmission losses 
included, 222–33
optimal operation of, 207–48
rate of failure, 322
real power losses, 216–18
reliability, 322
second-order derivatives, 242–48
security, 372
state estimation in, 343–74
wellbeing, 343
Power-voltage relation, 170
Primary loop control
dynamic frequency response, 280
frequency, 279–82
frequency response, 281
illustrated, 279
supplementary control loop, 282
Proportionality constants, 32
PV curve
characteristics, 172
circuit for, 171
multiple solutions to power flow, 170
for resistive load, 171
R
Rate of failure, 322
Reactance, in series inductance, 99
Reactance matrix, 104
Reactive power, 12–13
compensation, 17
under contingencies, 335–40
incremental power model and, 290–92
obtaining from terminal relations, 151
partial derivatives, 244
partial second-order derivatives, 246–48
transmission line requirement, 141
Reactive power flow
circuit solution, 339
incremental circuit to model, 335, 337
incremental current model, 338
sensitivity matrix, 340
Reactive power flow control, 258–62
base case, 269
circuit to study, 259, 268
matrix equation, 260–61
minimum control effort, 268–70
network for, 262
optimal, 268–70
tap change, 261
three-node system, 268
voltage condition, 261
Reactive VARs, 249
Real power, 12–13
flows, 325
losses, 216–18, 233
marginal costs, 226
obtaining from terminal relations, 151
Real power flow control, 250–55
base case, 265–66
incremental model, 263–64
longitudinal networks, 255–58
minimum actions, 250
minimum control effort, 265–68
network for, 251
optimal, 265–68
options, 255
sensitivity factors, 253
sparse nature of the matrix, 253, 254
three-node system, 263
three-node system base case, 266
Reduced gradient, 208
Reduced transient inductance, 318
Redundancy, 343
Reference angle, 200
Reflection coefficients, 159, 163, 166
Reflexion coefficients, 158–59
Refraction coefficients, 159, 163, 166
Regular control function, 366
Remote terminal units (RTUs), 343, 344
Resistance
connectivity elements, 52
defined, 7, 29
equivalent, 31
in series inductance, 99
voltage and current phasors through, 9
voltage and current through, 8
Resistors
voltage-current characteristics, 29, 30
voltage-current relation, 30
Retained conductors, 136
Right of ways, 140

Index
385
RMS phasor, 7, 9, 367, 369–70
Rotating speed, 276
Rotating torque, 275
Rotor speed, 295
Round conductor, 101
S
Sag estimation, 134
Scatter diagrams, 346
Second-order derivatives, 242–48
Self impedance, 130
Sensitivity coefficients, 262–64, 265, 271
Sensitivity matrix
defined, 272, 327
for incremental control changes, 328–29
for linear circuit, 327–29
reactive power incremental model, 340
Sequence impedances, 111–12
Series fault connections, 309, 311
Series impedance
cables, 123–26
transmission line arrangement for 
calculation, 113
two-port element in, 146
Series inductance, 99–112
axial conductors, 102–5
bundled conductors, 105–7
ground wire inclusion, 107–9
line transposition, 109–10
reactance, 99
resistance, 99
sequence impedances, 111–12
single conductor, 100–102
Series RLC circuit, 66
Shielded wires, 135
Short-term marginal costs, 208, 235
Shunt admittance, 147
Shunt admittance matrix, 121
Shunt capacitance, 126–27
Shunt faults, 307–9
Shunt reactive compensation, 259
Shunt susceptances, 337
SIMULINK® environment, 295
Single contingency model
overview, 329
Thévenin’s equivalent, 330–35
See also Contingency analysis
Single-phase fault, 312–14
Single-phase transformer model, 67–74
alternative circuit, 95–97
base quantities selection steps, 70
equivalent circuit, 69
equivalent circuit, grounded neutrals,  
69
illustrated, 67
mutually coupled circuits and pu values,  
72
partial inversion, 68, 72
per unit values, 69–74
pu base value determination, 69–70
solution for, 73
voltage, current, and impedance, 71
voltage relations, 68
voltages and currents, 70
Sinusoidal voltage, 6, 8, 10
Slack bus, 351
Source participation factors, 64
Sparse techniques, 325, 342
Squared errors, 346
Stability margin, 333
Stability’s angle limit, 154
STATCOM
characterization, 287
configuration for voltage control, 294
model, 292–95
modified network, 292
voltage control and reactive power injection, 
294
State estimation
best, 343
centralized data acquisition system,  
344–45
defined, 344
introduction to, 343–45
least squares, linear model, 345–53
nonlinear minimum squares, 361–64
observability, 358, 372–74
parameter estimation, 364–66
phasor estimation, 366–72
weighted least squares, 354–61
Static VAR compensators (SVCs), 249
Steady state stability margin, 328
Subtransient inductance, 319
Subtransient response, 319–20
Surge impedance, 143–44
Symmetrical components transformation, 
62–64
sequence impedances, 111
three-phase ∆∆ bank, 76
System data concentrators (SDCs), 372

386
Index
T
Tape shielded cable, 126
Taylor’s series expansion, 284
Thermal cost, 239
Thermal limit, 154
Thévenin’s equivalent, 47–48, 168
in 012 references, 302
in abc reference, 301
circuit, 42, 43, 167
defined, 48
fault connection equations and, 298
fault matrix connection and, 299
parameter estimation and, 364–66
single contingency model, 330–35
for synchronous generator, 201
three-phase fault, 300
voltage source, 48
Three-phase balanced network, 314, 366
Three-phase bank transformer
model, 74–85
node currents, 75, 78, 80
overview, 74
three-phase ∆∆ bank, 74–77
three-phase Y∆ bank, 77–79
three-phase YY bank, 79–85
See also Transformer models
Three-phase cables
capacitances, 128
center coordinates, 128
mutual capacitance, 129
phases, 127
pipe type, 129–32
pipe type cradle arrangement, 128
self impedance, 130
susceptance values, 129
See also Cables
Three-phase circuit, 18–23
Three-phase fault, 300–307
for AC network equivalent, 368
connections, 299
fictitious node, 303
impedance abc, 306
one-line diagrams, 303
results, 307
Simulink diagram, 368
Thévenin’s equivalent, 300
Three phase transformer
defined, 92
example, 93–95
node currents, 92, 93
See also Transformer models
Three-phase unbalanced currents, 65
Three windings transformer
circuit representation, 89
core and windings, 92
currents and voltage for, 91
defined, 89
delta equivalent, 91
equivalent circuit, 90
impedances, 89
tertiary winding, 91
See also Transformer models
Time constants, 318
Torque
incremental, 277
rotating, 275
Total energy, 275
Transfer functions, 295
Transformation matrix, 61, 63
Transformer models
autotransformer, 85–88
decoupling of state equations, 64–67
introduction to, 59
single-phase, 67–74
symmetrical components transformation, 
62–64
three-phase, 92–95
three-phase bank, 85
three windings transformer, 89–92
Transient response, 318–19
Transmission limits
stability’s angle limit, 154
thermal limit, 154
from voltage drop, 155–56
Transmission line loadability
ABCD constants, 146–51
approximate real power handling and 
losses, 137–41
compensation requirements, 150, 151
introduction to, 137
plots for stability limit, 150
power flow calculations, 151–54
transmission limits, 154–56
V(x) and I(x) equations in, 141–46
wave equation and time expressions, 
156–68
Transmission line modeling
cable parameters, 122–32
Earth return, 112–17
equivalent height, 133–34

Index
387
Gauss’ law and capacitance, 117–22
geometric mean radius (GMR), 132–33
illustrated, 137
introduction to, 99
lines in parallel, 135
series inductance, 99–112
Transmission lines
axial conductors, 102–5
bundled conductors, 105–7
high voltage, approximations, 138
incremental power flows for, 180–82
incremental reactive power flow for, 181–82
incremental real power flow for, 181, 182
long, 141–46
number of circuits required, 139–40
in parallel, 135–36
parameter values, 138
power flows in, 284
reactive power requirement, 141
round conductor, 101
sag estimation, 134
single conductor, 100–102
transposition, 109–10
Transmission losses
minimum cost power flow formulation, 
225–33
nodal power balance, 222
optimal operation, 222–33
overview, 222–25
Transposed transmission lines, 109–10
Traveling currents, 160, 161
Traveling voltages, 157, 161
Traveling waves
backward, 157, 158
defined, 157
forward, 157, 158
Tripped condition, 329, 333
Trips, line, 332, 337
Turbine’s power, 277–79
U
Unbalanced fault connections, 308, 316
Unbalanced three-phase power flow, 200–205
incremental concepts, 201
iterative process, 202
V
Vector force, 274
Voltage and current
AC circuits, 6
lagging power factor, 16
Laplace transformed equations, 156
leading power factor, 16
phasors, 14
phasors in resistance, 9
single-phase transformer model, 70
for three-phase circuit, 19
through inductance, 9
through resistance, 8
through series R, L C circuit, 11
Voltage collapse margin, 365
Voltage control
STATCOM, 294
voltage source converter (VSC), 290, 291
Voltage drop
limit from, 155–56
in terms of nodal voltages, 35
total power at receiving end and, 155
Voltages
under contingencies, 335–40
continuity of, 162, 163
measurement, 366
nodal, 12, 200, 331
node, 27
phase, 315
reflected, 167
sinusoidal, 6, 8, 10
traveling, 157, 161
Voltage source converter (VSC)
equivalent circuit for, 287
incremental model for, 288–90
system configuration, 288
system configuration for voltage control, 
290, 291
W
Weak systems, 366
Weighted least squares, 354–61
Weight matrix, 354
Wide area measurements, 371–72
Work
energy and, 273–82
force and distance, 273–74
Y
YBUS matrix, 56–57
Y∆ connection, 77–79
YY connection
illustrated, 79
nodal admittance matrix, 83

388
Index
YY connection (Cont.)
nodal matrix in sequence quantities, 84
node current relations, 82
product matrices, 84
three-phase bank, 79–85
voltage across elements, 81
Z
ZBUS matrix, 44–47
Zero sequence current, 314
Zero sequence network, 305

