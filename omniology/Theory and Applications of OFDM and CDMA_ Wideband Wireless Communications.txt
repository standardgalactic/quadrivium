        
www.allitebooks.com

Theory and Applications of
OFDM and CDMA
www.allitebooks.com

www.allitebooks.com

Theory and Applications of
OFDM and CDMA
Wideband Wireless Communications
Henrik Schulze
and
Christian L¨uders
Both of
Fachhochschule S¨udwestfalen
Meschede, Germany
www.allitebooks.com

Copyright 2005
John Wiley & Sons Ltd, The Atrium, Southern Gate, Chichester,
West Sussex PO19 8SQ, England
Telephone (+44) 1243 779777
Email (for orders and customer service enquiries): cs-books@wiley.co.uk
Visit our Home Page on www.wiley.com
All Rights Reserved. No part of this publication may be reproduced, stored in a retrieval system or transmitted
in any form or by any means, electronic, mechanical, photocopying, recording, scanning or otherwise, except
under the terms of the Copyright, Designs and Patents Act 1988 or under the terms of a licence issued by the
Copyright Licensing Agency Ltd, 90 Tottenham Court Road, London W1T 4LP, UK, without the permission in
writing of the Publisher. Requests to the Publisher should be addressed to the Permissions Department, John
Wiley & Sons Ltd, The Atrium, Southern Gate, Chichester, West Sussex PO19 8SQ, England, or emailed to
permreq@wiley.co.uk, or faxed to (+44) 1243 770620.
Designations used by companies to distinguish their products are often claimed as trademarks. All brand names
and product names used in this book are trade names, service marks, trademarks or registered trademarks of
their respective owners. The Publisher is not associated with any product or vendor mentioned in this book.
This publication is designed to provide accurate and authoritative information in regard to the subject matter
covered. It is sold on the understanding that the Publisher is not engaged in rendering professional services. If
professional advice or other expert assistance is required, the services of a competent professional should be
sought.
Other Wiley Editorial Ofﬁces
John Wiley & Sons Inc., 111 River Street, Hoboken, NJ 07030, USA
Jossey-Bass, 989 Market Street, San Francisco, CA 94103-1741, USA
Wiley-VCH Verlag GmbH, Boschstr. 12, D-69469 Weinheim, Germany
John Wiley & Sons Australia Ltd, 42 McDougall Street, Milton, Queensland 4064, Australia
John Wiley & Sons (Asia) Pte Ltd, 2 Clementi Loop #02-01, Jin Xing Distripark, Singapore 129809
John Wiley & Sons Canada Ltd, 22 Worcester Road, Etobicoke, Ontario, Canada M9W 1L1
Wiley also publishes its books in a variety of electronic formats. Some content that appears
in print may not be available in electronic books.
British Library Cataloguing in Publication Data
A catalogue record for this book is available from the British Library
ISBN-13 978-0-470-85069-5 (HB)
ISBN-10 0-470-85069-8 (HB)
Typeset in 10/12pt Times by Laserwords Private Limited, Chennai, India.
Printed and bound in Great Britain by Antony Rowe Ltd, Chippenham, Wiltshire.
This book is printed on acid-free paper responsibly manufactured from sustainable forestry
in which at least two trees are planted for each one used for paper production.
www.allitebooks.com

Contents
Preface
ix
1
Basics of Digital Communications
1
1.1
Orthogonal Signals and Vectors . . . . . . . . . . . . . . . . . . . . . . . .
1
1.1.1
The Fourier base signals . . . . . . . . . . . . . . . . . . . . . . . .
1
1.1.2
The signal space . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5
1.1.3
Transmitters and detectors . . . . . . . . . . . . . . . . . . . . . . .
7
1.1.4
Walsh functions and orthonormal transmit bases . . . . . . . . . . .
12
1.1.5
Nonorthogonal bases . . . . . . . . . . . . . . . . . . . . . . . . . .
17
1.2
Baseband and Passband Transmission . . . . . . . . . . . . . . . . . . . . .
18
1.2.1
Quadrature modulator
. . . . . . . . . . . . . . . . . . . . . . . . .
20
1.2.2
Quadrature demodulator . . . . . . . . . . . . . . . . . . . . . . . .
22
1.3
The AWGN Channel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
23
1.3.1
Mathematical wideband AWGN . . . . . . . . . . . . . . . . . . . .
25
1.3.2
Complex baseband AWGN
. . . . . . . . . . . . . . . . . . . . . .
25
1.3.3
The discrete AWGN channel
. . . . . . . . . . . . . . . . . . . . .
29
1.4
Detection of Signals in Noise
. . . . . . . . . . . . . . . . . . . . . . . . .
30
1.4.1
Sufﬁcient statistics . . . . . . . . . . . . . . . . . . . . . . . . . . .
30
1.4.2
Maximum likelihood sequence estimation
. . . . . . . . . . . . . .
32
1.4.3
Pairwise error probabilities
. . . . . . . . . . . . . . . . . . . . . .
34
1.5
Linear Modulation Schemes . . . . . . . . . . . . . . . . . . . . . . . . . .
38
1.5.1
Signal-to-noise ratio and power efﬁciency
. . . . . . . . . . . . . .
38
1.5.2
ASK and QAM
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
40
1.5.3
PSK . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
43
1.5.4
DPSK . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
44
1.6
Bibliographical Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
46
1.7
Problems
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
47
2
Mobile Radio Channels
51
2.1
Multipath Propagation
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
51
2.2
Characterization of Fading Channels . . . . . . . . . . . . . . . . . . . . . .
54
2.2.1
Time variance and Doppler spread
. . . . . . . . . . . . . . . . . .
54
2.2.2
Frequency selectivity and delay spread . . . . . . . . . . . . . . . .
60
2.2.3
Time- and frequency-variant channels . . . . . . . . . . . . . . . . .
62
2.2.4
Time-variant random systems: the WSSUS model . . . . . . . . . .
63
www.allitebooks.com

vi
CONTENTS
2.2.5
Rayleigh and Ricean channels . . . . . . . . . . . . . . . . . . . . .
66
2.3
Channel Simulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
67
2.4
Digital Transmission over Fading Channels
. . . . . . . . . . . . . . . . .
72
2.4.1
The MLSE receiver for frequency nonselective and slowly fading
channels . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
72
2.4.2
Real-valued discrete-time fading channels
. . . . . . . . . . . . . .
74
2.4.3
Pairwise error probabilities for fading channels
. . . . . . . . . . .
76
2.4.4
Diversity for fading channels
. . . . . . . . . . . . . . . . . . . . .
78
2.4.5
The MRC receiver . . . . . . . . . . . . . . . . . . . . . . . . . . .
80
2.4.6
Error probabilities for fading channels with diversity
. . . . . . . .
82
2.4.7
Transmit antenna diversity . . . . . . . . . . . . . . . . . . . . . . .
86
2.5
Bibliographical Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
90
2.6
Problems
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
91
3
Channel Coding
93
3.1
General Principles
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
93
3.1.1
The concept of channel coding
. . . . . . . . . . . . . . . . . . . .
93
3.1.2
Error probabilities
. . . . . . . . . . . . . . . . . . . . . . . . . . .
97
3.1.3
Some simple linear binary block codes . . . . . . . . . . . . . . . . 100
3.1.4
Concatenated coding . . . . . . . . . . . . . . . . . . . . . . . . . . 103
3.1.5
Log-likelihood ratios and the MAP receiver
. . . . . . . . . . . . . 105
3.2
Convolutional Codes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114
3.2.1
General structure and encoder . . . . . . . . . . . . . . . . . . . . . 114
3.2.2
MLSE for convolutional codes: the Viterbi algorithm . . . . . . . . 121
3.2.3
The soft-output Viterbi algorithm (SOVA)
. . . . . . . . . . . . . . 124
3.2.4
MAP decoding for convolutional codes: the BCJR algorithm . . . . 125
3.2.5
Parallel concatenated convolutional codes and turbo decoding
. . . 128
3.3
Reed–Solomon Codes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131
3.3.1
Basic properties
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 131
3.3.2
Galois ﬁeld arithmetics
. . . . . . . . . . . . . . . . . . . . . . . . 133
3.3.3
Construction of Reed–Solomon codes
. . . . . . . . . . . . . . . . 135
3.3.4
Decoding of Reed–Solomon codes . . . . . . . . . . . . . . . . . . 140
3.4
Bibliographical Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142
3.5
Problems
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143
4
OFDM
145
4.1
General Principles
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145
4.1.1
The concept of multicarrier transmission . . . . . . . . . . . . . . . 145
4.1.2
OFDM as multicarrier transmission
. . . . . . . . . . . . . . . . . 149
4.1.3
Implementation by FFT . . . . . . . . . . . . . . . . . . . . . . . . 153
4.1.4
OFDM with guard interval . . . . . . . . . . . . . . . . . . . . . . . 154
4.2
Implementation and Signal Processing Aspects for OFDM . . . . . . . . . . 160
4.2.1
Spectral shaping for OFDM systems
. . . . . . . . . . . . . . . . . 160
4.2.2
Sensitivity of OFDM signals against nonlinearities . . . . . . . . . . 166
4.3
Synchronization and Channel Estimation Aspects for OFDM Systems
. . . 175
4.3.1
Time and frequency synchronization for OFDM systems
. . . . . . 175
4.3.2
OFDM with pilot symbols for channel estimation . . . . . . . . . . 181
www.allitebooks.com

CONTENTS
vii
4.3.3
The Wiener estimator
. . . . . . . . . . . . . . . . . . . . . . . . . 183
4.3.4
Wiener ﬁltering for OFDM
. . . . . . . . . . . . . . . . . . . . . . 186
4.4
Interleaving and Channel Diversity for OFDM Systems . . . . . . . . . . . 192
4.4.1
Requirements of the mobile radio channel . . . . . . . . . . . . . . 192
4.4.2
Time and frequency interleavers
. . . . . . . . . . . . . . . . . . . 194
4.4.3
The diversity spectrum of a wideband multicarrier channel . . . . . 199
4.5
Modulation and Channel Coding for OFDM Systems
. . . . . . . . . . . . 208
4.5.1
OFDM systems with convolutional coding and QPSK
. . . . . . . 208
4.5.2
OFDM systems with convolutional coding and M2-QAM
. . . . . 213
4.5.3
Convolutionally coded QAM with real channel estimation and
imperfect interleaving
. . . . . . . . . . . . . . . . . . . . . . . . . 227
4.5.4
Antenna diversity for convolutionally coded QAM multicarrier
systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 235
4.6
OFDM System Examples
. . . . . . . . . . . . . . . . . . . . . . . . . . . 242
4.6.1
The DAB system . . . . . . . . . . . . . . . . . . . . . . . . . . . . 242
4.6.2
The DVB-T system
. . . . . . . . . . . . . . . . . . . . . . . . . . 251
4.6.3
WLAN systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 258
4.7
Bibliographical Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 261
4.8
Problems
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 263
5
CDMA
265
5.1
General Principles of CDMA
. . . . . . . . . . . . . . . . . . . . . . . . . 265
5.1.1
The concept of spreading
. . . . . . . . . . . . . . . . . . . . . . . 265
5.1.2
Cellular mobile radio networks . . . . . . . . . . . . . . . . . . . . 269
5.1.3
Spreading codes and their properties
. . . . . . . . . . . . . . . . . 277
5.1.4
Methods for handling interference in CDMA mobile radio networks 284
5.2
CDMA Transmission Channel Models . . . . . . . . . . . . . . . . . . . . . 304
5.2.1
Representation of CDMA signals . . . . . . . . . . . . . . . . . . . 304
5.2.2
The discrete channel model for synchronous transmission in a
frequency-ﬂat channel . . . . . . . . . . . . . . . . . . . . . . . . . 307
5.2.3
The discrete channel model for synchronous wideband MC-CDMA
transmission
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 310
5.2.4
The discrete channel model for asynchronous wideband CDMA
transmission
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 312
5.3
Receiver Structures for Synchronous Transmission . . . . . . . . . . . . . . 315
5.3.1
The single-user matched ﬁlter receiver . . . . . . . . . . . . . . . . 316
5.3.2
Optimal receiver structures
. . . . . . . . . . . . . . . . . . . . . . 321
5.3.3
Suboptimal linear receiver structures . . . . . . . . . . . . . . . . . 328
5.3.4
Suboptimal nonlinear receiver structures . . . . . . . . . . . . . . . 339
5.4
Receiver Structures for MC-CDMA and Asynchronous Wideband CDMA
Transmission
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 342
5.4.1
The RAKE receiver
. . . . . . . . . . . . . . . . . . . . . . . . . . 342
5.4.2
Optimal receiver structures
. . . . . . . . . . . . . . . . . . . . . . 347
5.5
Examples for CDMA Systems . . . . . . . . . . . . . . . . . . . . . . . . . 352
5.5.1
Wireless LANs according to IEEE 802.11 . . . . . . . . . . . . . . 352
5.5.2
Global Positioning System . . . . . . . . . . . . . . . . . . . . . . . 355
www.allitebooks.com

viii
CONTENTS
5.5.3
Overview of mobile communication systems . . . . . . . . . . . . . 357
5.5.4
Wideband CDMA
. . . . . . . . . . . . . . . . . . . . . . . . . . . 362
5.5.5
Time Division CDMA . . . . . . . . . . . . . . . . . . . . . . . . . 375
5.5.6
cdmaOne . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 380
5.5.7
cdma2000 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 386
5.6
Bibliographical Notes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 392
5.7
Problems
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 394
Bibliography
397
Index
403
www.allitebooks.com

Preface
Wireless communication has become increasingly important not only for professional appli-
cations but also for many ﬁelds in our daily routine and in consumer electronics. In 1990,
a mobile telephone was still quite expensive, whereas today most teenagers have one, and
they use it not only for calls but also for data transmission. More and more computers use
wireless local area networks (WLANs), and audio and television broadcasting has become
digital.
Many of the above-mentioned communication systems make use of one of two sophis-
ticated techniques that are known as orthogonal frequency division multiplexing (OFDM)
and code division multiple access (CDMA).
The ﬁrst, OFDM, is a digital multicarrier transmission technique that distributes the
digitally encoded symbols over several subcarrier frequencies in order to reduce the symbol
clock rate to achieve robustness against long echoes in a multipath radio channel. Even
though the spectra of the individual subcarriers overlap, the information can be completely
recovered without any interference from other subcarriers. This may be surprising, but
from a mathematical point of view, this is a consequence of the orthogonality of the base
functions of the Fourier series.
The second, CDMA, is a multiple access scheme where several users share the same
physical medium, that is, the same frequency band at the same time. In an ideal case,
the signals of the individual users are orthogonal and the information can be recovered
without interference from other users. Even though this is only approximately the case, the
concept of orthogonality is quite important to understand why CDMA works. It is due to
the fact that pseudorandom sequences are approximately orthogonal to each other or, in
other words, they show good correlation properties. CDMA is based on spread spectrum,
that is, the spectral band is spread by multiplying the signal with such a pseudorandom
sequence. One advantage of the enhancement of the bandwidth is that the receiver can take
beneﬁt from the multipath properties of the mobile radio channel.
OFDM transmission is used in several digital audio and video broadcasting systems.
The pioneer was the European DAB (Digital Audio Broadcasting) system. At the time when
the project started in 1987, hardly any communication engineers had heard about OFDM.
One author (Henrik Schulze) remembers well that many practical engineers were very sus-
picious of these rather abstract and theoretical underlying ideas of OFDM. However, only
a few years later, the DAB system became the leading example for the development of the
digital terrestrial video broadcasting system, DVB-T. Here, in contrast to DAB, coherent
higher-level modulation schemes together with a sophisticated and powerful channel esti-
mation technique are utilized in a multipath-fading channel. High-speed WLAN systems
like IEEE 802.11a and IEEE 802.11g use OFDM together with very similar channel coding
www.allitebooks.com

x
PREFACE
and modulation. The European standard HIPERLAN/2 (High Performance Local Area Net-
work, Type 2) has the same OFDM parameters as these IEEE systems and differs only in
a few options concerning channel coding and modulation. Recently, a broadcasting system
called DRM (Digital Radio Mondiale) has been developed to replace the antiquated analog
AM radio transmission in the frequency bands below 30 MHz. DRM uses OFDM together
with a sophisticated multilevel coding technique.
The idea of spread spectrum systems goes back to military applications, which arose
during World War II, and were the main ﬁeld for spread spectrum techniques in the follow-
ing decades. Within these applications, the main beneﬁts of spreading are to hide a signal,
to protect it against eavesdropping and to achieve a high robustness against intended in-
terference, that is, to be able to separate the useful signal from the strong interfering one.
Furthermore, correlating to a spreading sequence may be used within radar systems to obtain
reliable and precise values of propagation delay for deriving the position of an object.
A system where different (nearly orthogonal) spreading sequences are used to sepa-
rate the signals transmitted from different sources is the Global Positioning System (GPS)
developed in about 1970. Hence, GPS is the ﬁrst important system where code division
multiple access (CDMA) is applied. Within the last 10 years, CDMA has emerged as the
most important multiple access technique for mobile communications. The ﬁrst concept
for a CDMA mobile communication system was developed by Qualcomm Incorporated
in approx 1988. This system proposal was subsequently reﬁned and released as the so-
called IS-95 standard in North America. In the meantime, the system has been rebranded
as cdmaOne, and there are more than 100 millions of cdmaOne subscribers in more than
40 countries. Furthermore, cdmaOne has been the starting point for cdma2000, a third-
generation mobile communication system offering data rates of up to some Mbit/s. Another
very important third-generation system using CDMA is the Universal Mobile Telecommu-
nications System (UMTS); UMTS is based on system proposals developed within a number
of European research projects. Hence, CDMA is the dominating multiple access technique
for third generation mobile communication systems.
This book has both theoretical and practical aspects. It is intended to provide the reader
with a deeper understanding of the concepts of OFDM and CDMA. Thus, the theoretical
basics are analyzed and presented in some detail. Both of the concepts are widely applied
in practice. Therefore, a considerable part of the book is devoted to system design and
implementation aspects and to the presentation of existing communication systems.
The book is organized as follows. In Chapter 1, we give a brief overview of the basic
principles of digital communications and introduce our notation. We represent signals as
vectors, which often leads to a straightforward geometrical visualization of many seemingly
abstract mathematical facts. The concept of orthogonality between signal vectors is a key
to the understanding of OFDM and CDMA, and the Euclidean distance between signal
vectors is an important concept to analyze the performance of a digital transmission system.
Wireless communication systems often have to cope with severe multipath fading in a
mobile radio channel. Chapter 2 treats these aspects. First, the physical situation of multipath
propagation is analyzed and statistical models of the mobile radio channel are presented.
Then, the problems of digital transmission over these channels are discussed and the basic
principles of Chapter 1 are extended for those channels. Digital wireless communication
over fading channels is hardly possible without using some kind of error protection or
channel coding. Chapter 3 gives a brief overview of the most important channel coding

PREFACE
xi
techniques that are used in the above-mentioned communication systems. Convolutional
codes are typically used in these systems, and many of the systems have very closely
related (or even identical) channel coding options. Thus, the major part of Chapter 3 is
dedicated to convolutional codes as they are applied in these systems. A short presentation
of Reed–Solomon Codes is also included because they are used as outer codes in the DVB-
T system, together with inner convolutional codes. Chapter 4 is devoted to OFDM. First,
the underlying ideas and the basic principles are explained by using the basic principles
presented in Chapter 1. Then implementation aspects are discussed as well as channel
estimation and synchronization aspects that are relevant for the above-mentioned systems.
All these systems are designed for mobile radio channels and use channel coding. Therefore,
we give a comprehensive discussion of system design aspects and how to ﬁt all these
things together in an optimal way for a given channel. Last but not least, the transmission
schemes for DAB, DVB-T and WLAN systems are presented and discussed. Chapter 5
is devoted to CDMA, focusing on its main application area – mobile communications.
This application area requires not only sophisticated digital transmission techniques and
receiver structures but also some additional methods as, for example, a soft handover, a
fast and exact power control mechanism as well as some special planning techniques to
achieve an acceptable radio network performance. Therefore, the ﬁrst section of Chapter 5
discusses these methods and some general principles of CDMA and mobile radio networks.
CDMA receivers may be simple or quite sophisticated, thereby making use of knowledge
about other users. These theoretically involved topics are treated in the following three
subsections. As examples of CDMA applications we discuss the most important systems
already mentioned, namely, GPS, cdmaOne (IS-95), cdma2000 and UMTS with its two
transmission modes called Wideband CDMA and Time Division CDMA. Furthermore,
Wireless LAN systems conforming to the standard IEEE 802.11 are also included in this
section as some transmission modes of these systems are based on spreading.
This book is supported by a companion website on which lecturers and instructors
can ﬁnd electronic versions of the ﬁgures contained within the book, a solutions manual
to the problems at the end of each chapter and also chapter summaries. Please go to
ftp://ftp.wiley.co.uk/pub/books/schulze


1
Basics of Digital Communications
1.1
Orthogonal Signals and Vectors
The concept of orthogonal signals is essential for the understanding of OFDM (orthogonal
frequency division multiplexing) and CDMA (code division multiple access) systems. In
the normal sense, it may look like a miracle that one can separately demodulate overlapping
carriers (for OFDM) or detect a signal among other signals that share the same frequency
band (for CDMA). The concept of orthogonality unveils this miracle. To understand these
concepts, it is very helpful to interpret signals as vectors. Like vectors, signals can be
added, multiplied by a scalar, and they can be expanded into a base. In fact, signals ﬁt into
the mathematical structure of a vector space. This concept may look a little bit abstract.
However, vectors can be visualized by geometrical objects, and many conclusions can
be drawn by simple geometrical arguments without lengthy formal derivations. So it is
worthwhile to become familiar with this point of view.
1.1.1
The Fourier base signals
To visualize signals as vectors, we start with the familiar example of a Fourier series. For
reasons that will become obvious later, we do not deal with a periodic signal, but cut
off outside the time interval of one period of length T . This means that we consider a
well-behaved (e.g. integrable) real signal x(t) inside the time interval 0 ≤t ≤T and set
x(t) = 0 outside. Inside the interval, the signal can be written as a Fourier series
x(t) = a0
2 +
∞

k=1
ak cos

2π k
T t

−
∞

k=1
bk sin

2π k
T t

.
(1.1)
The Fourier coefﬁcients ak and bk are given by
ak = 2
T
 T
0
cos

2π k
T t

x(t) dt
(1.2)
Theory and Applications of OFDM and CDMA
Henrik Schulze and Christian L¨uders
2005 John Wiley & Sons, Ltd

2
BASICS OF DIGITAL COMMUNICATIONS
and
bk = −2
T
 T
0
sin

2π k
T t

x(t) dt.
(1.3)
These coefﬁcients are the amplitudes of the cosine and (negative) sine waves at the respec-
tive frequencies fk = k/T . The cosine and (negative) sine waves are interpreted as a base
for the (well-behaved) signals inside the time interval of length T . Every such signal can
be expanded into that base according to Equation (1.1) inside that interval. The underlying
mathematical structure of the Fourier series is similar to the expansion of an N-dimensional
vector x ∈RN into a base {vi}N
i=1 according to
x =
N

i=1
αivi.
(1.4)
The base {vi}N
i=1 is called orthonormal if two different vectors are orthogonal (perpendi-
cular) to each other and if they are normalized to length one, that is,
vi · vk = δik,
where δik is the Kronecker Delta (δik = 1 for i = k and δik = 0 otherwise) and the dot
denotes the usual scalar product
x · y =
N

i=1
xiyi = xT y
for real N-dimensional vectors. In that case, the coefﬁcients αi are given by
αi = vi · x.
For an orthonormal base, the coefﬁcients αi can thus be interpreted as the projections of
the vector x onto the base vectors, as depicted in Figure 1.1 for N = 2. Thus, αi can be
interpreted as the amplitude of x in the direction of vi.




v1
v2
α1
α2
x
Figure 1.1 A signal vector in two dimensions.

BASICS OF DIGITAL COMMUNICATIONS
3
The Fourier expansion (1.1) is of the same type as the expansion (1.4), except that the
sum is inﬁnite. For a better comparison, we may write
x(t) =
∞

i=0
αivi(t)
with the normalized base signal vectors vi(t) deﬁned by
v0(t) =

1
T 
 t
T −1
2

and
v2k(t) =

2
T cos

2π k
T t


 t
T −1
2

for even i > 0 and
v2k+1(t) = −

2
T sin

2π k
T t


 t
T −1
2

for odd i with coefﬁcients given by
αi =
 ∞
−∞
vi(t)x(t) dt,
that is,
α2k =

T /2ak
and
α2k+1 =

T /2bk.
Here we have introduced the notation (x) for the rectangular function, which takes the
value one between x = −1/2 and x = 1/2 and zero outside. Thus, (x −1/2) is the
rectangle between x = 0 and x = 1. The base of signals vi(t) fulﬁlls the orthonormality
condition
 ∞
−∞
vi(t)vk(t) dt = δik.
(1.5)
We will see in the following text that this just means that the Fourier base forms a set of
orthogonal signals. With this interpretation, Equation (1.5) says that the base signals for
different frequencies are orthogonal and, for the same frequency fk = k/T , the sine and
cosine waves are orthogonal.
We note that the orthonormality condition and the formula for αi are very similar to
the case of ﬁnite-dimensional vectors. One just has to replace sums by integrals. A similar
geometrical interpretation is also possible; one has to regard signals as vectors, that is,
identify vi(t) with vi and x(t) with x. The interpretation of αi as a projection on vi is
obvious. For only two dimensions, we have x(t) = α1v1(t) + α2v2(t) , and the signals can
be adequately described by Figure 1.1. In this special case, where v1(t) is a cosine signal
and v2(t) is a (negative) sine signal, the ﬁgure depicts nothing else but the familiar phasor
diagram. However, this is just a special case of a very general concept that applies to many
other scenarios in communications.

4
BASICS OF DIGITAL COMMUNICATIONS
Before we further discuss this concept for signals by introducing a scalar product for
signals, we continue with the complex Fourier transform. This is because complex signals
are a common tool in communications engineering.
Consider a well-behaved complex signal s(t) inside the time interval [0, T ] that vanishes
outside that interval. The complex Fourier series for that signal can be written as
s(t) =
∞

k=−∞
αkvk(t)
(1.6)
with the (normalized) complex Fourier base functions
vk(t) =

1
T exp

j2π k
T t


 t
T −1
2

.
(1.7)
The base functions are orthonormal in the sense that
 ∞
−∞
v∗
i (t)vk(t) dt = δik.
(1.8)
holds. The Fourier coefﬁcient αk will be obtained from the signal by the Fourier analyzer.
This is a detection device that performs the operation
αk =
 ∞
−∞
v∗
i (t)s(t) dt.
(1.9)
This coefﬁcient is the complex amplitude (i.e. amplitude and phase) of the wave at frequency
fk. It can be interpreted as the component of the signal vector s(t) in the direction of the
base signal vector vk(t), that is, we interpret frequency components as vector components
or vector coordinates.
Example 1 (OFDM Transmission) Given a ﬁnite set of complex numbers sk that carry
digitally encoded information to be transmitted, we may use the complex Fourier series for
this purpose and transmit the signal
s(t) =
K

k=0
skvk(t).
(1.10)
The transmitter performs a Fourier synthesis. In an ideal transmission channel with perfect
synchronization and no disturbances, the transmit symbols sk can be completely recovered at
the receiver by the Fourier analyzer that plays the role of the detector. One may send K new
complex symbols during every time slot of length T by performing the Fourier synthesis for
that time slot. At the receiver, the Fourier analysis is done for every time slot. This method
is called orthogonal frequency division multiplexing (OFDM). This name is due to the fact
that the transmit signals form an orthogonal base belonging to different frequencies fk.
We will see in the following text that other – even more familiar – transmission setups use
orthogonal bases.

BASICS OF DIGITAL COMMUNICATIONS
5
1.1.2
The signal space
A few mathematical concepts are needed to extend the concept of orthogonal signals to
other applications and to represent the underlying structure more clearly. We consider (real
or complex) signals of ﬁnite energy, that is, signals s(t) with the property
 ∞
−∞
|s(t)|2 dt < ∞.
(1.11)
The assumption that our signals should have ﬁnite energy is physically reasonable and leads
to desired mathematical properties. We note that this set of signals has the property of a
vector space, because ﬁnite-energy signals can be added or multiplied by a scalar, resulting
in a ﬁnite-energy signal. For this vector space, a scalar product is given by the following:
Deﬁnition 1.1.1 (Scalar product of signals) In the vector space of signals with ﬁnite en-
ergy, the scalar product of two signals s(t) and r(t) is deﬁned as
⟨s, r⟩=
 ∞
−∞
s∗(t)r(t) dt.
(1.12)
Two signals are called orthogonal if their scalar product equals zero. The Euclidean norm
of the signal is deﬁned by ∥s∥= √⟨s, s⟩, and ∥s∥2 = ⟨s, s⟩is the signal energy. ∥s −r∥2 is
called the squared Euclidean distance between s(t) and r(t).
We add the following remarks:
• This scalar product has a structure similar to the scalar product of vectors s =
(s1, . . . , sK)T and r = (r1, . . . , rK)T in a K-dimensional complex vector space given
by
s†r =
K

k=1
s∗
krk,
where the dagger (†) means conjugate transpose. Comparing this expression with the
deﬁnition of the scalar product for continuous signals, we see that the sum has to be
replaced by the integral.
• It is a common use of notation in communications engineering to write a function with
an argument for the function, that is, to write s(t) for a signal (which is a function
of the time) instead of s, which would be the mathematically correct notation. In
most cases, we will use the engineer’s notation, but we write, for example, ⟨s, r⟩and
not ⟨s(t), r(t)⟩, because this quantity does not depend on t. However, sometimes we
write s instead of s(t) when it makes the notation simpler.
• In mathematics, the vector space of square integrable functions (i.e. ﬁnite-energy
signals) with the scalar product as deﬁned above is called the Hilbert space L2(R).
It is interesting to note that the Hilbert space of ﬁnite-energy signals is the same as
the Hilbert space of wave functions in quantum mechanics. For the reader who is
interested in details, we refer to standard text books in mathematical physics (see e.g.
(Reed and Simon 1980)).

6
BASICS OF DIGITAL COMMUNICATIONS
Without proof, we refer to some mathematical facts about that space of signals with ﬁnite
energy (see e.g. (Reed and Simon 1980)).
• Each signal s(t) of ﬁnite energy can be expanded into an orthonormal base, that is,
it can be written as
s(t) =
∞

k=1
αkvk(t)
(1.13)
with properly chosen orthonormal base signals vk(t). The coefﬁcients can be obtained
from the signal as
αk = ⟨vk, s⟩.
(1.14)
The coefﬁcient αk can be interpreted as the component of the signal vector s in the
direction of the base vector vk.
• For any two ﬁnite energy signals s(t) and r(t), the Schwarz inequality
|⟨s, r⟩| ≤∥s∥∥r∥
holds. Equality holds if and only if s(t) is proportional to r(t).
• The Fourier transform is well deﬁned for ﬁnite-energy signals. Now, let s(t) and r(t)
be two signals of ﬁnite energy, and S(f ) and R(f ) denote their Fourier transforms.
Then,
⟨s, r⟩= ⟨S, R⟩
holds. This fact is called Plancherel theorem or Rayleigh theorem in the mathematical
literature (Bracewell 2000). The above equality is often called Parseval’s equation.
As an important special case, we note that the signal energy can be expressed either
in the time or in the frequency domain as
E =
 ∞
−∞
|s(t)|2 dt =
 ∞
−∞
|S(f )|2 df.
Thus, |S(f )|2 df is the energy in an inﬁnitesimal frequency interval of width df ,
and |S(f )|2 can be interpreted as the spectral density of the signal energy.
In communications, we often deal with subspaces of the vector space of ﬁnite-energy
signals. The signals of ﬁnite duration form such a subspace. An appropriate base of that
subspace is the Fourier base. The Fourier series is then just a special case of Equation
(1.13) and the Fourier coefﬁcients are given by Equation (1.14). Another subspace is the
space of strictly band-limited signals of ﬁnite energy. From the sampling theorem we know
that each such signal s(t) that is concentrated inside the frequency interval between −B/2
and B/2 can be written as a series
s(t) =
∞

k=−∞
s(k/B)sinc (Bt −k)
(1.15)
with sinc (x) = sin (πx)/(πx).
We deﬁne a base as follows:

BASICS OF DIGITAL COMMUNICATIONS
7
Deﬁnition 1.1.2 (Normalized sinc base) The orthonormal sinc base for the bandwidth B/2
is given by the signals
ψk(t) =
√
B sinc (Bt −k) .
(1.16)
We note that
√
B ψ0(t) is the impulse response of an ideal low-pass ﬁlter of bandwidth
B/2, so that the sinc base consists of delayed and normalized versions of that impulse
response. From the sampling theorem, we conclude that these ψk(t) are a base of the
subspace of strictly band-limited functions. By looking at them in the frequency domain,
we easily see that they are orthonormal. From standard Fourier transform relations, we see
that the Fourier transform k(f ) of ψk(t) is given by
k(f ) =
1
√
B
 (f/B) e−j2πkf/B.
Thus, k(f ) is just a Fourier base function for signals concentrated inside the frequency
interval between −B/2 and B/2. This base is known to be orthogonal. Thus, we rewrite
the statement of the sampling theorem as the expansion
s(t) =
∞

k=−∞
skψk(t)
into the orthonormal base ψk(t). From the sampling theorem, we know that
sk =
1
√
B
s(k/B)
holds. The Fourier transform of this signal is given by
S(f ) =
∞

k=−∞
skk(f ).
This is just a Fourier series for the spectral function that is concentrated inside the frequency
interval between −B/2 and B/2. The coefﬁcients are given by
sk = ⟨ψk, s⟩= ⟨k, S⟩.
This relates the coefﬁcients of a Fourier expansion of a signal S(f ) in the frequency domain
to the samples of the corresponding signal s(t) in the time domain. As we have seen from
this discussion, the Fourier base and the sinc base are related to each other by interchanging
the role of time and frequency.
1.1.3
Transmitters and detectors
Any linear digital transmission setup can be characterized as follows: As in the OFDM
Example 1, for each transmission system we have to deal with a synthesis of a signal (at
the transmitter site) and the analysis of a signal (at the receiver site). Given a ﬁnite set
{sk}K
k=1 of coefﬁcients that carry the information to be transmitted, we choose a base gk(t)
to transmit the information by the signal
s(t) =
K

k=1
skgk(t).
(1.17)
www.allitebooks.com

8
BASICS OF DIGITAL COMMUNICATIONS
Deﬁnition 1.1.3 (Transmit base, pulses and symbols) In the above sum, each signal gk(t)
is called a transmit pulse, the set of signals {gk(t)}K
k=1 is called the transmit base, and sk
is called a transmit symbol. The vector s = (s1, . . . , sK)T is called the transmit symbol
vector.
Note that in the terminology of vectors, the transmit symbols sk are the coordinates of the
signal vector s(t) corresponding to the base gk(t).
If the transmit base is orthonormal, then, for an ideal transmission channel, the infor-
mation symbols sk can be recovered completely as the projections onto the base. These
scalar products
sk = ⟨gk, s⟩=
 ∞
−∞
g∗
k(t)s(t) dt
(1.18)
can also be written as
sk =
 ∞
−∞
g∗
k(τ −t)s(τ) dτ

t=0
=
	
g∗
k(−t) ∗s(t)

t=0 .
(1.19)
This means that the detection of the information sk transmitted by gk(t) is the output of the
ﬁlter with impulse response g∗
k(−t) sampled at t = 0. This ﬁlter is usually called matched
ﬁlter, because it is matched to the transmit pulse g(t).
Deﬁnition 1.1.4 (Detector and matched ﬁlter) Given a transmit pulse g(t), the corres-
ponding matched ﬁlter is the ﬁlter with the impulse response g∗(−t). The detector Dg for
g(t) is deﬁned by the matched ﬁlter output sampled at t = 0, that is, by the detector output
Dg[r] given by
Dg[r] =
 ∞
−∞
g∗(t)r(t) dt
(1.20)
for any receive signal r(t). If two transmit pulses g1(t) and g2(t) are orthogonal, then the
corresponding detectors are called orthogonal.
Thus, a detector extracts a (real or complex) number. This number carries the informa-
tion. The detector may be visualized as depicted in Figure 1.2.
The matched ﬁlter has an interesting property: if a transmit pulse is corrupted by white
(not necessarily Gaussian) noise, then the matched ﬁlter is the one that maximizes the
signal-to-noise ratio (SNR) for t = 0 at the receiver end (see Problem 6).
We add the following remarks:
• For a ﬁnite-energy receive signal r(t), Dg[r] = ⟨g, r⟩holds. However, we usually
have additive noise components in the signal at the receiver, which are typically not
of ﬁnite energy, so that the scalar product is not deﬁned.


r(t)
Dg
Dg[r]
Figure 1.2 Detector.

BASICS OF DIGITAL COMMUNICATIONS
9




r(t)
g(t)
Dg
Dr
Dg[r]
Dr[g]
Figure 1.3 Input and detector pulses.
• The detector Dg[r] compares two signals: in principle, it answers the question ‘How
much of r(t) looks like g(t)?’. The role of receive signal and the pulse can be
interchanged according to
Dg[r] = D∗
r [g],
as Figure 1.3 depicts.
• The Fourier analyzer given by Equation (1.9) is a set of orthogonal detectors. The
sinc base is another set of orthogonal detectors.
• For an orthonormal base, the energy of the transmit signal equals the energy of the
vector of transmit symbols, that is,
E =
 ∞
−∞
|s(t)|2 dt =
K

k=1
|sk|2,
or more compactly written as E = ∥s∥2 = ∥s∥2 . For the proof, we refer to Problem 1.
The following example shows that the familiar Nyquist pulse shaping can be understood
as an orthogonality condition.
Example 2 (The Nyquist Base) Consider a transmission pulse g(t) with the property
 ∞
−∞
g∗(t)g(t −kTS) dt = δ[k]
(1.21)
for a certain time interval TS, that is, the pulse g(t) and its versions time-shifted by kTS build
an orthonormal base. This property also means that the pulse shape h(t) = g∗(−t) ∗g(t) is
a so-called Nyquist pulse that satisﬁes the ﬁrst Nyquist criterion h(kTS) = δ[k] and allows a
transmission that is free of intersymbol interference (ISI). For the Fourier transforms G(f )
and H(f ) of g(t) and h(t), the relation H(f ) = |G(f )|2 holds. Therefore, g(t) is often
called a sqrt-Nyquist pulse. If we deﬁne gk(t) = g(t −kTS) as the pulse transmitted at time
kTS, the condition (1.21) is equivalent to
⟨gi, gk⟩= δik.
(1.22)

10
BASICS OF DIGITAL COMMUNICATIONS
We then call the base formed by the signals gk(t) a (sqrt-) Nyquist base. Equation (1.22)
means that if the pulse is transmitted at time kTS, the detector for the pulse transmitted at
time iTS has output zero unless i = k. Thus, the pulses do not interfere with each other.
We note that in practice the pulse g(t) is the impulse response of the transmit ﬁlter, that
is, the pulse-shaping ﬁlter that will be excited by the transmit symbols sk. The corresponding
matched ﬁlter g∗(−t) is the receive ﬁlter. Its output will be sampled once in every symbol
clock TS to recover the symbols sk. The impulse response of the whole transmission chain
h(t) = g∗(−t) ∗g(t) must be a Nyquist pulse to ensure symbol recovery without intersymbol
interference.
The Nyquist criterion
h(kTS) = δ[k]
in the time domain can be equivalently written in the frequency domain as
∞

k=−∞
H

f −k
TS

= TS,
where H(f ) is the Fourier transform of h(t). Familiar Nyquist pulses like raised cosine
(RC) pulses are usually derived from this criterion in the frequency domain (see e.g. (Proakis
2001)). In the following text, we shall show a simple method to construct Nyquist pulses
in the time domain.
Obviously, every pulse of the shape
h(t) = u(t) · sinc (t/TS)
satisﬁes the Nyquist criterion in the time domain. u(t) should be a function that improves
the decay of the pulse. In the frequency domain, this is equivalent to
H(f ) = TS U(f ) ∗ (f TS) ,
where U(f ) is the Fourier transform of u(t). The convolution with U(f ) smoothens the
sharp ﬂank of the rectangle. Writing out the convolution integral leads to
H(f ) = TS

V

f +
1
2TS

−V

f −
1
2TS

with
V (f ) =
 f
−∞
U(x) dx.
V (f ) is a function that describes the ﬂank of the ﬁlter given by H(f ).
One possible choice for U(f ) is
U(f ) = π
2α TS cos
π
α f TS


 1
α f TS

,
0 ≤α ≤1
with a constant α between that we call the rolloff factor. The corresponding time domain
function obviously given by
u(t) = π
4

sinc

α t
TS
+ 1
2

+ sinc

α t
TS
−1
2

,

BASICS OF DIGITAL COMMUNICATIONS
11
which equals the expression
u(t) = cos (παt/TS)
1 −(2αt/TS)2 .
The ﬁlter ﬂank is obtained by integration as
V (f ) =



0
:
f TS ≤−α/2
1
2

1 + sin
π
α f TS

:
−α/2 ≤f TS ≤α/2
1
:
f TS ≥α/2.
(1.23)
The shape of the ﬁlter is then given by the familiar expression
H(f ) =



TS
:
2|f |TS ≤1 −α
TS
2

1 −sin
π
α

|f |TS −1
2

:
1 −α ≤2|f |TS ≤1 + α
0
:
2|f |TS ≥1 + α.
(1.24)
The corresponding pulse is
h(t) = sinc (t/TS) · cos (παt/TS)
1 −(2αt/TS)2 .
(1.25)
Other Nyquist pulses than these so-called raised cosine (RC) pulses are possible. A
Gaussian
u(t) = exp

−(βt/TS)2
guarantees an exponential decay in both the time and the frequency domain. β is a shaping
parameter similar to the rolloff factor α. The Fourier transform U(f ) of u(t) is given by
U(f ) =

πT 2
S /β2 exp

−(πTSf/β)2
,
and the ﬁlter ﬂank is
V (f ) = 1
2

1 + erf
π
β TSf

.
The ﬁlter curve is then given by
H(f ) = 1
2TS

erf
π
β

TSf + 1
2

−erf
π
β

TSf −1
2

.
(1.26)
The RC pulse and the Gaussian Nyquist pulse
h(t) = sinc (t/TS) · exp

−(βt/TS)2
(1.27)
have a very similar shape if we relate α and β in such a way that their ﬂanks V (f ) have
the same ﬁrst derivative at f = 0. This is the case for
β = 2α
π .

12
BASICS OF DIGITAL COMMUNICATIONS
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
fTS
H(f )
Figure 1.4 RC and Gaussian Nyquist ﬁlter shape for α = 0.2.
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
–20
–18
–16
–14
–12
–10
–8
–6
–4
–2
0
fTS
10 log H(f )
Figure 1.5 RC and Gaussian Nyquist ﬁlter shape for α = 0.2 (decibel scale).

BASICS OF DIGITAL COMMUNICATIONS
13
–5
–4
–3
–2
–1
0
1
2
3
4
5
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
t/TS
h(t)
Figure 1.6 RC and Gaussian Nyquist pulse shape for α = 0.2.
For this case and α = 0.2, both ﬁlter shapes are depicted in Figure 1.4, and with a
logarithmic scale, in Figure 1.5. The Gaussian shaping is slightly broader at the outer
ﬂanks, but the difference is very small even on the logarithmic scale. Figure 1.6 shows the
corresponding pulses. The Gaussian pulse has slightly smaller amplitudes, but the difference
is very small. Of course, both curves differ signiﬁcantly in their asymptotic behavior (which
can be seen on a logarithmic scale), but this is in a region where pulses are practically
zero.
1.1.4
Walsh functions and orthonormal transmit bases
In this subsection, we introduce the Walsh functions that play an important role in CDMA
signaling. We regard them as an example to discuss an orthonormal base that can be
interpreted as a base of signals or as a base in an Euclidean space.
The M × M Walsh–Hadamard (WH) matrices HM, where M is a power of two, are
deﬁned by H1 = 1 and the recursive relation
HM =
 HM/2
HM/2
HM/2
−HM/2

.
For example, the matrix H4 is given by
H4 =


1
1
1
1
1
−1
1
−1
1
1
−1
−1
1
−1
−1
1

.

14
BASICS OF DIGITAL COMMUNICATIONS
The column vectors of the WH matrix are pairwise orthogonal but not normalized to one.
We may divide them by their length
√
M to obtain the normalized WH vectors gk related
to HM by
√
M HM = G =
	
g1, . . . , gM

.
(1.28)
The column vectors are orthonormal, that is,
gi · gk = δik.
For a given value of M, the Walsh functions gk(t), k = 1, . . . , M are functions deﬁned on
a time interval t ∈[0, TS] that are piecewise constant on time sub-intervals (called chips) of
duration Tc = TS/M. The sign of the function on the ith time sub-interval (i = 1, . . . , M)
is given by the ith component hik of the kth column vector in the WH matrix HM. The
absolute value is normalized to 1/√TS to obtain an orthonormal signal base, that is,
⟨gi, gk⟩= δik.
Outside the interval t ∈[0, TS], the Walsh functions vanish. For M = 8, the Walsh functions
are depicted in Figure 1.7.
We can write the normalized Walsh functions as
gk(t) =
M

i=1
gikci(t),
(1.29)
where gik = hik/
√
M, and the chip pulse ci(t) is deﬁned by ci(t) = 1/√Tc in the ith chip
interval and zero outside. Obviously
⟨ci, ck⟩= δik
holds, that is, the chip pulses are orthonormal. Given the transmit base {gk(t)}M
k=1, we may
transmit information carried by the symbols {sk}M
k=1 by using the signal
s(t) =
M

k=1
skgk(t).
(1.30)
Instead of {gk(t)}M
k=1, we can use the equivalent discrete base {gk}M
k=1 and transmit the
vector
s =
M

k=1
skgk.
(1.31)
This representation allows the geometrical interpretation of the transmit signal as a vector
s in an M-dimensional Euclidean space. The transmit symbols sk are the components of
the vector s in the orthonormal Walsh–Hadamard base {gk}M
k=1, which is a rotated version
of the canonical Euclidean base e1 = (1, 0, 0, . . . , 0)T , e2 = (0, 1, 0, . . . , 0)T , . . . , eM =
(0, . . . , 0, 1)T with the rotation given by the matrix G. Equation (1.29) is the coordinate
transform corresponding to the base transform from the base of chip pulses to the base of
normalized Walsh functions. Thus, the chip pulse base can be identiﬁed with the canonical
Euclidean base. For an ideal channel, the components sk of the vector s can be completely

BASICS OF DIGITAL COMMUNICATIONS
15












TS
t
t
t
t
t
t
t
t
Tc
g1(t)
g2(t)
g3(t)
g4(t)
g5(t)
g6(t)
g7(t)
g8(t)
Figure 1.7 Walsh functions for M = 8.
recovered by projecting the receive vector on the base vectors gk. For M = 2, the situation
is depicted in Figure 1.8.
The orthogonality of the base can be interpreted as the existence of M independent
channels without cross talk as illustrated in Figure 1.9 for M = 2. The orthogonal detectors
Dgi correspond to the projections on the base vectors. If the symbols {sk}M
k=1 are part of the
same data stream, M symbols are transmitted in parallel via M channels during the time
interval TS. Orthogonality means absence of ISI between these channels. Another possibility
is to use the M channels to transmit M independent data streams, each of them with the
rate of one symbol transmitted during the time interval TS . In that case, the orthogonality
is used for multiplexing or multiple access, as it is the situation in CDMA (code division
multiple access). Each Walsh function corresponds to another code that may be allocated to

16
BASICS OF DIGITAL COMMUNICATIONS
s
g1
s1
s2
g2
Figure 1.8 The orthonormal Walsh–Hadamard base.






DEMUX
MUX
s1, s2
s1, s2
Dg1
s1g1
s2g2
s1
s2
Dg2
TX/
Figure 1.9 Orthogonal channels.
a certain user in a mobile radio scenario. The downlink of the Qualcomm CDMA system
IS-95 (now called cdmaOne, see Subsection 5.5.6) is an example for such a setup (see the
discussion in Chapter 5).
Walsh functions may also be used for orthogonal signaling. In that case the term Walsh
modulation is often used. This transmission scheme is very robust against noise, but it leads
to a signiﬁcant spreading of the bandwidth. For CDMA systems, both properties together
are desirable. This modulation scheme is used in the uplink of the Qualcomm system IS-95.
In a setup with orthogonal Walsh modulation, only one base pulse gk(t) will be transmitted
during the time period TS. One can transmit log2(M) bits during TS by selecting one of
the M base pulses. The transmit signal during this time period is simply given by
s(t) =

ES gk(t)

BASICS OF DIGITAL COMMUNICATIONS
17
or
s =

ES gk,
where √ES is the energy of the signal in the time period of length TS.
We note that all the properties discussed in this subsection hold not only for the
piecewise constant chip pulse but also for any set of chip pulses ci(t) that satisﬁes the
orthonormality condition ⟨ci, ck⟩= δik, and the base signal given by Equation (1.30) holds.
One may, for example, choose any Nyquist base for the pulses ci(t) with smoother pulse
shape than the rectangular pulses in order to get better spectral properties. It is also possible
to use the Fourier base pulse for ci(t) in Equation (1.30), resulting in multicarrier (MC-)
CDMA. Then, a chip may be interpreted as a frequency pulse rather than a time pulse.
1.1.5
Nonorthogonal bases
Orthonormal transmit bases have desirable properties for simple detection. However, some-
times it is necessary to deal with nonorthogonal bases. This may be the case when a
transmission channel corrupts the orthogonality. For example, the channel may introduce
ISI, so the ISI-free Nyquist base used for transmission will be convolved by the channel
impulse response resulting in nonorthogonal base vectors. In such a case, the channel must
be regarded as a part of the transmit setup.
Now, let the pulses bk(t) be such a base of nonorthogonal, but linearly independent,
transmit pulses and let xk, k = 1, . . . , K be the ﬁnite set of transmit symbols. The trans-
mitted signal is then given by
s(t) =
K

k=1
xkbk(t).
(1.32)
There exists an orthonormal base {ψk}K
k=1 for the ﬁnite-dimensional vector space spanned
by the transmit pulses bk(t), which can be obtained using the Gram–Schmidt algorithm.
The two bases are related by the base transform
bk(t) =
K

i=1
bikψi(t)
(1.33)
with bik = ⟨ψi, bk⟩. We take the scalar product of Equation (1.32) with the vector ψi(t)
and obtain
si =
K

k=1
xkbik,
where we have deﬁned si = ⟨ψi, s⟩. This is a coordinate transform of the coordinates xk of
the signal corresponding to the nonorthogonal base bk(t) to the coordinates sk corresponding
to the orthonormal base ψk(t) by writing
s(t) =
K

k=1
skψk(t).
Deﬁning x = (x1, . . . , xk)T and s = (s1, . . . , sk)T , the coordinate transform can be written
in the more compact matrix notation as
s = Bx
www.allitebooks.com

18
BASICS OF DIGITAL COMMUNICATIONS
with the matrix B of entries bik. Because this coordinate transform is invertible, the transmit
symbols xk can be recovered from the sk by x = B−1s. Thus, in a channel without noise, the
receiver may use the detector outputs corresponding to the orthonormal base and transform
them by using the inverse matrix. However, in a noisy channel, this inversion is not optimal
for the detection, because it causes noise enhancement.
For a receive signal r(t), the detector outputs in the nonorthogonal base
yk = Dbk[r] =
 ∞
−∞
b∗
k(t)r(t) dt
are related to the detector outputs
rk = Dψk[r] =
 ∞
−∞
ψ∗
k (t)r(t) dt
in the orthogonal base by
yk =
K

i=1
b∗
ikri
or, in matrix notation, by
y = B†r.
Because this transform is invertible, the detector outputs rk can be recovered from the yk
by r =

B†−1 y.
1.2
Baseband and Passband Transmission
It is convenient to describe a digitally modulated passband signal by a so-called complex
equivalent low-pass or complex baseband signal. Let ˜s(t) be a strictly band-limited1 pass-
band signal of bandwidth B centered around a carrier frequency f0. We have chosen the
sign ˜ for the signal ˜s(t) to indicate a wave for the RF signal. It is possible to completely
describe ˜s(t) by its equivalent low-pass signal s(t) of bandwidth B/2. Both signals are
related by
˜s(t) =
√
2 ℜ{s(t)ej2πf0t}.
(1.34)
This one-to-one correspondence between both signals ˜s(t) and s(t) is easy to visualize
if we look at them in the frequency domain. Writing ˜S(f ) and S(f ) for their respective
Fourier transforms, Equation (1.34) is equivalent to
˜S(f ) =
1
√
2

S (f −f0) + S∗(−f −f0)

.
This is because, in Equation (1.34), multiplication with the exponential corresponds to a
frequency shift by f0, and taking the real part corresponds (up to a factor of 2) to adding
1We note that strictly band-limited signals do not exist in reality. This is due to the fact that a strictly band-
limited signal cannot be time limited, which should be the case for signals in reality. However, it is mathematically
convenient to make this assumption, always keeping in mind that this is only an approximation and the accuracy
of this model has to be discussed for any practical case.

BASICS OF DIGITAL COMMUNICATIONS
19


















	
	












f
0
0
f
|S(f )|2
f0
(a)
(b)
| ˜S(f )|2
−f0
B
B
B
Figure 1.10 Equivalence of (a) passband and (b) complex baseband representation of the
same signal.
the negative spectral component (see Problem 2). Figure 1.10 shows the energy spectral
densities | ˜S(f )|2 and |S(f )|2 for both signals. We have chosen a normalization such that
the total energy of both signals is the same, that is,
 ∞
−∞
|s(t)|2 dt =
 ∞
−∞
|˜s(t)|2 dt
and
 ∞
−∞
|S(f )|2 df =
 ∞
−∞
| ˜S(f )|2 df.
It is obvious from the ﬁgure that both signals ˜S(f ) and S(f ) are only located at different
frequencies, but they carry the same information. The signal S(f ) can be obtained from
˜S(f ) by a frequency shift by −f0 followed by an ideal low-pass ﬁlter of bandwidth B/2,
and a scaling by the factor
√
2. Denoting the low-pass ﬁlter impulse response by 	(t), this
operation can be written in the time domain as
s(t) = 	(t) ∗
√
2 exp (−j2πf0t) ˜s(t)

.
(1.35)
We note that the upconversion from s(t) to ˜s(t) as described by Equation (1.34) doubles
the bandwidth of the two components (real and imaginary part) of the baseband signal,

20
BASICS OF DIGITAL COMMUNICATIONS
resulting in one signal of bandwidth B instead of two (real) signals of bandwidth B/2. We
write s(t) = x(t) + jy(t) and call the real part, x(t), the I- (inphase) and the imaginary
part y(t) the Q- (quadrature) component. Both components together are called quadrature
components. Equation (1.34) can then be written as
˜s(t) =
√
2 x(t) cos (2πf0t) −
√
2 y(t) sin (2πf0t) ,
(1.36)
which is the superposition of the cosine-modulated I-component and the (negative) sine-
modulated Q-component. It is an important fact that the passband of width B is shared by
two separable channels: one is the cosine and the other is the sine channel. We shall see
that the I-component modulated by the cosine is orthogonal to the Q-component modulated
by the sine. Thus, they behave like two different channels (without cross talk) that can be
individually used for transmission. We will further see that both the I-modulation and the
Q-modulation leave scalar products invariant. To make the following treatment simpler, we
ﬁrst introduce a formal shorthand notation for the quadrature modulator and demodulator.
1.2.1
Quadrature modulator
First we deﬁne the quadrature modulator as given by Equation (1.36), but separately for
both components.
Deﬁnition 1.2.1 (I- and Q-modulator) Let x(t) and y(t) be some arbitrary real signals.
Let 	(t) denote the impulse response of an ideal low-pass ﬁlter of bandwidth B/2. Let
f0 > B/2. We then deﬁne the modulated signals ˜x(t) and ˜y(t) as
˜x(t) =
√
2 cos (2πf0t) [	(t) ∗x(t)]
(1.37)
and
˜y(t) = −
√
2 sin (2πf0t)
	
	(t) ∗y(t)

.
(1.38)
We write ˜x(t) = I{x(t)} and ˜y(t) = Q{y(t)} or, shorthand, ˜x = Ix and ˜y = Qy and call the
time-variant systems given by I and Q the I-modulator and the Q-modulator, respectively.
The time-variant system that converts the pair of signals x(t) and y(t) to the passband signal
˜s = Ix + Qy is called quadrature modulator.
In a practical setup, the signals x(t) and y(t) are already low-pass signals, and thus the
convolution with 	(t) at the input is obsolete. For mathematical convenience, we prefer to
deﬁne this time-variant system for arbitrary (not only low-pass) signals as inputs.
The following theorem states the orthogonality of the outputs of the I- and Q-modulator
and that both modulators leave scalar products invariant for band-limited signals.
Theorem 1.2.2 Let x(t) and y(t) be arbitrary real signals of ﬁnite energy and let ˜x(t) =
I{x(t)} and ˜y(t) = Q{y(t)}. Then,
⟨˜x, ˜y⟩= 0.
(1.39)
Furthermore, let ˜u(t) = I{u(t)} and ˜v(t) = Q{v(t)} be two other signals of ﬁnite energy. If
x, y, u, v are real low-pass signals strictly band-limited to B/2, then
⟨˜u, ˜x⟩= ⟨u, x⟩, ⟨˜v, ˜y⟩= ⟨v, y⟩
(1.40)
holds. As a special case, we observe that both I- and Q-modulator leave the signal energy
unchanged, that is, ∥x∥2 = ∥˜x∥2 and ∥y∥2 = ∥˜y∥2.

BASICS OF DIGITAL COMMUNICATIONS
21





˜x(t)
x(t)
D
D[x]
I-MOD
˜D[˜x]
˜D
=
Figure 1.11 Equivalence of baseband and passband detection.
The proof of the theorem is left to Problem 3. Equation (1.39) states that the sine and the
cosine channels are orthogonal. In particular, it means that a detector for a Q-modulated sine
wave detects zero if only an I-modulated cosine wave has been transmitted and vice versa.
For strictly band-limited baseband signals, Equation (1.40) states the following equivalence
between baseband and passband transmission: we consider the detector for the baseband
pulse u(t) and denote it shorthand by D = Du. For the passband detector corresponding
to the I-modulated pulse ˜u(t) = I{u(t)}, we write shorthand ˜D = D˜u. Then, as depicted in
Figure 1.11, the baseband detector output for the baseband signal x(t) is the same as the
passband detector output for the I-modulated signal ˜x(t) = I{x(t)}:
˜D[˜x] = D[x].
The same holds for the Q-modulation.
Now let s(t) = x(t) + jy(t) and z(t) = u(t) + jv(t) be strictly band-limited complex
low-pass signals. The corresponding passband signals can be written as ˜s = Ix + Qy and
˜z = Iu + Qv. Their scalar product is
⟨˜z, ˜s⟩= ⟨Iu, Ix⟩+ ⟨Qv, Qy⟩+ ⟨Iu, Qy⟩+ ⟨Qv, Ix⟩.
As a consequence of the above theorem, the last two terms vanish and the ﬁrst two can be
converted, resulting in
⟨˜z, ˜s⟩= ⟨u, x⟩+ ⟨v, y⟩.
We compare this expression with the scalar product of the two complex baseband signals
⟨z, s⟩= ⟨u, x⟩+ ⟨v, y⟩+ j(⟨u, y⟩−⟨v, x⟩)
and ﬁnd the relation
⟨˜z, ˜s⟩= ℜ{⟨z, s⟩}.
(1.41)
We note that there is a similar relation between the scalar products of vectors in the complex
N-dimensional vector space CN and in the real 2N-dimensional space R2N. Let s = x + jy
and z = u + jv be vectors in CN and deﬁne the real vectors
˜s =
 x
y

, ˜z =
 u
v

.

22
BASICS OF DIGITAL COMMUNICATIONS
Then,
˜z · ˜s = u · x + v · y
and
z†s = u · x + v · y + j(u · y −v · x)
and thus,
˜z · ˜s = ℜ{z†s}
(1.42)
hold.
1.2.2
Quadrature demodulator
Consider again the detector D = Du and the detector ˜D = D˜u for an I-modulated pulse
˜u(t) = I{u(t)}. The detector output to an input signal ˜s(t) is given by ˜D[˜s]. We may ask
for a time-variant system I D called I-demodulator that maps ˜s(t) to a low-pass signal
x(t) = I D {˜s(t)} which is deﬁned by the property
D[x] = ˜D[˜s],
(see Figure 1.12). Using simple integral manipulations, one can derive the explicit form of
the I- (and similarly for the Q-) demodulator from this condition (see Problem 4). It turns
out that I D and QD are just given by the real and imaginary part of the Equation (1.35).
We summarize the result in the following deﬁnition and theorem.
Deﬁnition 1.2.3 (I- and Q-demodulator) Let ˜s(t) be a real signal. Let 	(t) denote the
impulse response of an ideal low-pass ﬁlter of bandwidth B/2. Let f0 > B/2. We deﬁne the
demodulated signals x(t) and y(t) as
x(t) = 	(t) ∗
√
2 cos (2πf0t) ˜s(t)

(1.43)
and
y(t) = −	(t) ∗
√
2 sin (2πf0t) ˜s(t)

(1.44)





x(t)
D
D[x]
˜D
=
˜s(t)
˜D[˜s]
I-DEMOD
Figure 1.12 Characterization of the I-demodulator.

BASICS OF DIGITAL COMMUNICATIONS
23
and write x(t) = I D{˜s(t)} and y(t) = QD{˜s(t)} or, using shorthand, x = I D ˜s and y =
QD ˜s. We call the time-variant systems given by I D and QD the I-demodulator and the Q-
demodulator, respectively. The time-variant system given by I D + jQD that converts ˜s to
the complex signal
s(t) = 	(t) ∗
√
2 exp (−j2πf0t) ˜s(t)

(1.45)
is called quadrature demodulator.
Theorem 1.2.4 For real signals of ﬁnite energy, the I- and Q-demodulator have the follow-
ing properties:
⟨Iu, ˜s⟩=

u, I D˜s

,
⟨Qv, ˜s⟩=

v, QD˜s

,
(1.46)
QDIx = 0,
I DQy = 0.
Conversely, Equation (1.46) uniquely determines the I- and Q-demodulation given by the
above deﬁnition. Furthermore, let x(t) and y(t) be real signals of ﬁnite energy that are
strictly band-limited to B/2. Then,
I DIx = x,
QDQy = y
holds. Thus, for band-limited signals, the I- (Q-)demodulator inverts the I- (Q-)modulator.
We may also write Equation (1.46) in the detector notation as
D˜u[˜s] = Du[I D ˜s],
D˜v[˜s] = Dv[QD ˜s]
(1.47)
with ˜u(t) = I{u(t)} and ˜v(t) = Q{v(t)}. Without going into mathematical details, we
note that if the detection pulses u(t) and v(t) are sufﬁciently well behaved, these
equations – written as integrals – still make sense if the input signal is no longer of ﬁ-
nite energy. This is the case, for example, for a sine wave, for a Dirac impulse, or for white
noise, which is the topic of the next section.
1.3
The AWGN Channel
In reality, transmission is always corrupted by noise. The usual mathematical model is the
AWGN (Additive White Gaussian Noise) channel. It is a very good model for the physical
reality as long as the thermal noise at the receiver is the only source of disturbance. Nev-
ertheless, because of its simplicity, it is often used to model man-made noise or multiuser
interference. The AWGN channel model can be characterized as follows:
• The noise w(t) is an additive random disturbance of the useful signal s(t), that is,
the receive signal is given by
r(t) = s(t) + w(t).
• The noise is white, that is, it has a constant power spectral density (psd). The one-
sided psd is usually denoted by N0, so N0/2 is the two-sided psd, and BN0 is the noise
inside the (noise) bandwidth B, see part (a) of Figure 1.13. For thermal resistor noise,
N0 = kT0, where k is the Boltzmann constant and T0 is the absolute temperature. The

24
BASICS OF DIGITAL COMMUNICATIONS














f
0
0
f
f0
(a)
(b)
−f0
Pw(f )
Pn(f )
N0
N0/2
B
B
B
Figure 1.13
Equivalence of (a) wideband and (b) complex baseband AWGN for band-
limited detection.
unit of N0 is [W/Hz], which is the same as the unit [J] for the energy. Usually, N0 is
written as dBm/Hz. For T0 = 290 K, N0 ≈−174 dBm/Hz. However, this is only the
ideal physical limit for an ideal receiver. In practice, some decibels according to the
so-called noise ﬁgure have to be added. Typically, N0 will be a value slightly above
−170 dBm/Hz.
• The noise is a stationary and zero mean Gaussian random process. This means that
the output of every (linear) noise measurement is a zero mean Gaussian random
variable that does not depend on the time instant when the measurement is done.
One must keep in mind that the AWGN model is a mathematical ﬁction, because it implies
that the total power (i.e. the psd integrated over all frequencies) is inﬁnite. Thus, a time
sample of the white noise has inﬁnite average power, which is certainly not a physically
reasonable property. It is known from statistical physics that the thermal noise density
decreases exponentially at (very!) high frequencies. But to understand the physical situation
in communications engineering it is better to keep in mind that every receiver limits the
bandwidth as well as every physical noise measurement. So it makes sense to think of the
noise process to be white, but it cannot be sampled directly without an input device. Each
input device ﬁlters the noise and leads to a ﬁnite power.

BASICS OF DIGITAL COMMUNICATIONS
25
1.3.1
Mathematical wideband AWGN
The mathematical AWGN random process w(t) can be characterized as a zero mean Gaus-
sian process with the autocorrelation function
E{w(t1)w(t2)} = N0
2 δ(t1 −t2).
(1.48)
We see that for t1 = t2, this expression is not well deﬁned, because δ(t) is not well deﬁned
for t = 0. As for the δ-impulse, we must understand white noise as a generalized function
that cannot be sampled directly, but it can be measured by a proper set of linear detectors.
These linear detectors are the sampled outputs of linear ﬁlters. Thus, formally we can write
the output of the detector for the (real) signal φ(t) of such a white noise measurement as
Dφ[w] = [φ(−t) ∗w(t)]t=0 or
Dφ[w] =
 ∞
−∞
φ(t)w(t) dt,
(1.49)
that is, φ(−t) is the impulse response of the measuring device. In the mathematical litera-
ture, φ(t) is called a test function (Reed and Simon 1980). Note that the integral in Equation
(1.49) formally looks like the scalar product ⟨φ, w⟩. Keeping in mind that the scalar product
is well deﬁned only for ﬁnite-energy signals, we have avoided such a notation. We can now
characterize the white noise by the statistical properties of the outputs of linear detectors.
Deﬁnition 1.3.1 (White Gaussian Noise) White Gaussian noise w(t) is a random signal,
characterized by the following properties: the output of a (ﬁnite-energy) linear detector
Dφ[w] is a Gaussian random variable with zero mean. Any two detector outputs Dφ1[w]
and Dφ2[w] are jointly Gaussian with cross-correlation
E

Dφ1[w]Dφ2[w]

= N0
2 ⟨φ1, φ2⟩.
(1.50)
Since Gaussian random variables are completely characterized by their second-order
properties (Papoulis 1991), all the statistical properties of w(t) are ﬁxed by this deﬁnition.
Using the integral representation (1.49), it is easy to show that the characterization by
detector outputs (1.50) is equivalent to (1.48) (see Problem 5).
Note that the AWGN outputs of orthogonal detectors are uncorrelated and thus, as
Gaussian random variables, even statistically independent. In many transmission setups as
discussed in the above examples, the transmission base and therefore the corresponding
detectors are orthogonal. Thus, for an orthonormal transmission base, the detector outputs
are both ISI-free and independent. Orthogonality thus means complete separability, which
will lead us to the concept of sufﬁcient statistics (see Subsection 1.4.1).
1.3.2
Complex baseband AWGN
Up to now, we have only considered wideband white Gaussian noise. The question now is
what happens at the receiver when this additive disturbance of the useful signal is converted
(together with the signal) to the complex baseband.

26
BASICS OF DIGITAL COMMUNICATIONS
Consider a baseband detector for the real low-pass signal φ(t) and the detector that
corresponds to the I-modulated version for the signal, ˜φ = Iφ. We know from Equation
(1.47) that the output of the detector for ˜φ for any signal r is the same as the output of φ
for the I-demodulated version I Dr of that signal. This same property also holds for white
noise, that is, D ˜φ[w] = Dφ[I Dw] . Similarly, for the Q-demodulated noise, we have the
property D ˜ψ[w] = Dψ[QDw] with ˜ψ = Qψ. Using this fact, together with the deﬁnition
of AWGN and Theorem 1.2.2, we get the following Proposition.
Proposition 1.3.2 Let w(t) be additive white Gaussian noise and its I- and Q-demodulated
versions be denoted by I Dw and QDw. Let φ1 and φ2 be two strictly band-limited low-pass
detectors. Then, the following properties hold:
E

Dφ1[I Dw]Dφ2[I Dw]

= N0
2 ⟨φ1, φ2⟩
(1.51)
E

Dφ1[QDw]Dφ2[QDw]

= N0
2 ⟨φ1, φ2⟩
(1.52)
E

Dφ1[I Dw]Dφ2[QDw]

= 0.
(1.53)
The last equation means that the I- and the Q-demodulator produce statistically inde-
pendent outputs2. Since both demodulators include a low-pass ﬁlter, both I Dw and QDw
are well-behaved random processes having ﬁnite average power BN0/2. The samples (with
sampling frequency B) of the low-pass white noise are given by the outputs of the detec-
tor corresponding to 	(t), the impulse response of the ideal low-pass ﬁlter of bandwidth
B/2. Thus, the low-pass white noise can be characterized by its detector outputs and by its
samples as well.
We now deﬁne the complex baseband noise process n(t) as the IQ-demodulated white
noise
n = (I D + jQD)w.
(1.54)
From the above proposition, we conclude
E{Dφ1[n] D∗
φ2[n]} = N0 ⟨φ1, φ2⟩
(1.55)
and
E{Dφ1[n] Dφ2[n]} = 0.
(1.56)
Complex random variables are characterized by these two types of covariances. Here the
second one, the so-called pseudocovariance, has vanished. Gaussian processes with this
property are called proper Gaussian. Nonproper Gaussian random variables have undesired
properties for describing communication systems (Neeser and Massey 1993). The autocor-
relation properties of n(t) can simply be obtained by setting φ1(t) = 	t1(t) = 	(t −t1)
and φ2(t) = 	t2(t) = 	(t −t2), where 	(t) is the impulse response of the ideal low-
pass ﬁlter of bandwidth B/2. Using

	t1, 	t2

= 	(t1 −t2) we easily derive the following
properties
E{n(t1) n∗(t2)} = N0	(t1 −t2)
(1.57)
2Equivalently, we may say that the I- and the Q-component of the noise are statistically independent.

BASICS OF DIGITAL COMMUNICATIONS
27
and
E{n(t1) n(t2)} = 0.
(1.58)
n(t) has similar properties as w(t). It is white, but restricted to a bandwidth B, and the
constant psd is N0 instead of N0/2. This can be understood because n(t) is complex and
the total power is the sum of the powers of the real and the imaginary part. Passband and
complex baseband white noise psd is depicted in Figure 1.13.
Instead of dealing with complex white Gaussian noise with psd N0 band-limited to B/2,
many authors regard it as convenient to perform the limit B →∞, so that Equation (1.57)
turns into
E{n(t1) n∗(t2)} = N0δ(t1 −t2),
that is, n(t) becomes complex inﬁnite-bandwidth white noise with one- sided psd N0 (see
e.g. (Kammeyer 2004; Proakis 2001)). This is reasonable if we think of downconverting
with a low-pass ﬁlter of bandwidth much larger than the signal bandwidth. We wish to point
out that the limit B →∞, that is, the wideband complex white noise does not reﬂect the
physical reality but is only a mathematically convenient model. The equivalence between
passband and baseband is only true for band-limited signals, especially B/2 < f0 must
hold.
Proposition 1.3.3 (Baseband stochastic processes) Consider a (real-valued) stochastic
process ˜z(t) that inﬂuences the useful signal in the air. We want to characterize the IQ-
demodulator output
z(t) = 	(t) ∗
√
2 exp (−j2πf0t) ˜z(t)

by its second-order properties, that is, an autocorrelation function. Here 	(t) = B sinc (Bt)
is the impulse response of the ideal low-pass ﬁlter of bandwidth B/2. We may think of white
noise w(t) as such a process, but also of an RF carrier that is broadened by the Doppler
effect in a mobile radio environment (see Chapter 2). The following treatment is very general.
We only assume that the random RF signal ˜z(t) has zero mean and it is wide-sense stationary
(WSS), which means that the autocorrelation function
˜R(τ) = E {˜z(t + τ)˜z(t)}
of the process does not depend on t. We want to show that
E

z(t + τ)z∗(t)

= 	(τ) ∗

2 exp (−j2πf0τ) ˜R(τ)

(1.59)
and
E {z(t + τ)z(t)} = 0.
(1.60)
Obviously, for the special case of AWGN, this property is just given by the two Equations
(1.57, 1.58) above.
www.allitebooks.com

28
BASICS OF DIGITAL COMMUNICATIONS
To prove Equation (1.59), we apply the convolution in the deﬁnition of z(t)
E

z(t + τ)z∗(t)

= 2 E
  ∞
−∞
dt1	(t + τ −t1)e−j2πf0t1 ˜z(t1)
 ∞
−∞
dt2	(t −t2)ej2πf0t2 ˜z(t2)
!
= 2 E
  ∞
−∞
dt1
 ∞
−∞
dt2	(t + τ −t1)	(t −t2)e−j2πf0(t1−t2) ˜R(t1 −t2)
!
= 2 E
  ∞
−∞
dt1
 ∞
−∞
dt2
 ∞
−∞
df 	(t + τ −t1)	(t −t2)ej2π(f −f0)(t1−t2) ˜S(f )
!
,
where we have expressed ˜R(τ) by means of its Fourier transform, that is, the power spectral
density ˜S(f ) of the process. We have used the simpler notation
"
dx
"
dyf (x, y) instead of
" "
f (x, y) dy

dx. Substituting the time integration variables according to t′
1 = t + τ −t1
and t′
2 = t −t2 and noting that t1 −t2 = τ −t′
1 + t′
2, we get the expression
2 E
  ∞
−∞
df ˜S(f )
 ∞
−∞
dt′
1	(t′
1)ej2π(f −f0)(τ−t′
1)
 ∞
−∞
dt′
2	(t′
2)e+j2π(f −f0)t′
2
!
= 2 E
  ∞
−∞
df ej2π(f −f0)τ ˜S(f ) 
f −f0
B
!
= 2 E
  ∞
−∞
df ej2πf τ ˜S(f + f0) 
f
B
!
,
which completes the proof. We note that
S(f ) = 2 ˜S(f + f0) 
f
B

,
the power spectral density of the process in the complex baseband, is the Fourier transform
of the complex baseband autocorrelation function
R(τ) = 	(τ) ∗

2 exp (−j2πf0τ) ˜R(τ)

.
The proof of Equation (1.60) is similar. Applying again the convolution in the deﬁnition
of z(t) leads to
E {z(t + τ)z(t)}
= 2 E
  ∞
−∞
dt1	(t + τ −t1)e−j2πf0t1 ˜z(t1)
 ∞
−∞
dt2	(t −t2)e−j2πf0t2 ˜z(t2)
!
= 2 E
  ∞
−∞
dt1
 ∞
−∞
dt2	(t + τ −t1)	(t −t2)e−j2πf0(t1+t2) ˜R(t1 −t2)
!
= 2 E
  ∞
−∞
dt1
 ∞
−∞
dt2
 ∞
−∞
df 	(t + τ −t1)	(t −t2)e−j2πf0(t1+t2)ej2πf (t1−t2) ˜S(f )
!
.

BASICS OF DIGITAL COMMUNICATIONS
29
We now substitute the time integration variables according to t′
1 = t + τ −t1 and t′
2 = t −t2
and get the expression
2 E
  ∞
−∞
df ˜S(f )
 ∞
−∞
dt′
1	(t′
1)ej2π(f −f0)(t+τ−t′
1)
 ∞
−∞
dt′
2	(t′
2)e−j2π(f +f0)(t′
2−t)
!
= 2 E
  ∞
−∞
df ˜S(f ) ej2π(f −f0)(t+τ) 
f −f0
B

ej2π(f +f0)t 
f + f0
B
!
.
We note that

f −f0
B


f + f0
B

= 0,
which completes the proof.
1.3.3
The discrete AWGN channel
Consider a complex baseband signal s(t) band limited to B/2 to be transmitted at the carrier
frequency f0. The corresponding passband transmit signal ˜s(t) given by Equation (1.34) is
corrupted by AWGN, resulting in the receive signal
˜r(t) = ˜s(t) + w(t).
The IQ-demodulated complex baseband receive signal is then given by
r(t) = s(t) + n(t),
(1.61)
where n(t) is complex baseband AWGN as introduced in the preceding subsection. Let
{gk(t)}K
k=1 be an orthogonal transmit base, for example, a Nyquist base, and
s(t) =
K

k=1
skgk(t).
(1.62)
Let nk = Dgk[n] be the detector outputs of the noise for the detector gk(t). The detector
outputs at the receiver rk = Dgk[r] are then given by
rk = sk + nk.
(1.63)
We conclude from Equations (1.55) and (1.56) that nk is discrete complex AWGN charac-
terized by
E{ni n∗
k} = N0δik
(1.64)
and
E{ni nk} = 0.
(1.65)
For nk = xk + j yk, these two equations are equivalent to
E{xi xk} = N0
2 δik,
(1.66)
E{yi yk} = N0
2 δik,
(1.67)

30
BASICS OF DIGITAL COMMUNICATIONS
and
E{xi yk} = 0.
(1.68)
The random variables xk have the joint pdf
p(x1, . . . , xK) =
1
√
2πσ 2K exp

−1
2σ 2

x2
1 + · · · + x2
K

for σ 2 = N0/2. The random variables yk have the same pdf. Deﬁning the vectors
x = (x1, . . . , xK)T , y = (y1, . . . , yK)T
results in
p(x) =
1
√
2πσ 2K exp

−1
2σ 2 ∥x∥2

,
p(y) =
1
√
2πσ 2K exp

−1
2σ 2 ∥y∥2

.
The joint pdf for the xk, yk is the product of both. We deﬁne the complex noise vector
n = (n1, . . . , nK)T ,
and write, with p(n) = p(x, y) = p(x)p(y),
p(n) =
1
√
2πσ 22K exp

−1
2σ 2 ∥n∥2

.
Using the vector notation s = (s1, . . . , sK)T and r = (r1, . . . , rK)T for the transmit symbols
and the detector outputs, we write the discrete AWGN transmission channel (1.63) as
r = s + n.
(1.69)
If the symbols sk are real numbers, one can depict this as a transmission mission of a vector
in the K-dimensional real Euclidean space with the canonical base e1 = (1, 0, 0, . . . , 0)T ,
e2 = (0, 1, 0, . . . , 0)T , . . . . For complex sk, one may think of a 2K-dimensional real Eu-
clidean space, because it has the same distance structure as a K-dimensional complex
space.
We have assumed that the transmit base is orthonormal. This is not a fundamental
restriction, because one can always perform a base transform to an orthonormal base. In
that case, the symbols si are related to the original transmit symbols xk by a transform
s = Bx, where B is the matrix that describes the coordinate transform.
1.4
Detection of Signals in Noise
1.4.1
Sufﬁcient statistics
For the sake of simplicity, consider the model of Equations (1.63) and (1.69) for only
three real dimensions as illustrated in Figure 1.14. Assume that two real symbols s1, s2

BASICS OF DIGITAL COMMUNICATIONS
31
Dimension 3
Dimensions 1 and 2
r
s
n
(r1, r2)
r3
Figure 1.14 The noise in dimension 3 is irrelevant for the decision.
chosen from a ﬁnite alphabet are transmitted, while nothing is transmitted (s3 = 0) in the
third dimension. At the receiver, the detector outputs r1, r2, r3 for three real dimensions
are available. We can assume that the signal and the noise are statistically independent.
We know that the Gaussian noise samples n1, n2, n3, as outputs of orthogonal detectors,
are statistically independent. It follows that the detector outputs r1, r2, r3 are statistically
independent. We argue that only the receiver outputs for those dimensions where a symbol
has been transmitted are relevant for the decision and the others can be ignored because
they are statistically independent, too. In our example, this means that we can ignore the
receiver output r3. Thus, we expect that
P (s1, s2|r1, r2, r3) = P (s1, s2|r1, r2)
(1.70)
holds, that is, the probability that s1, s2 was transmitted conditioned by the observation of
r1, r2, r3 is the same as conditioned by the observation of only r1, r2. We now show that this
equation follows from the independence of the detector outputs. From Bayes rule (Feller
1970), we get
P (s1, s2|r1, r2, r3) = p(s1, s2, r1, r2, r3)
p(r1, r2, r3)
,
(1.71)
where p(a, b, . . .) denotes the joint pdf for the random variable a, b, . . . . Since r3 is
statistically independent from the other random variables s1, s2, r1, r2, it follows that
P (s1, s2|r1, r2, r3) = p(s1, s2, r1, r2)p(r3)
p(r1, r2)p(r3)
.
(1.72)
From
P (s1, s2|r1, r2) = p(s1, s2, r1, r2)
p(r1, r2)
,
(1.73)
we obtain the desired property given by Equation (1.70). Note that, even though this property
is seemingly intuitively obvious, we have made use of the fact that the noise is Gaussian.
White noise outputs of orthogonal detectors are uncorrelated, but the Gaussian property
ensures that they are statistically independent, so that their pdfs can be factorized.

32
BASICS OF DIGITAL COMMUNICATIONS
The above argument can obviously be generalized to more dimensions. We only need
to detect in those dimensions where the signal has been transmitted. The corresponding
detector outputs are then called a set of sufﬁcient statistics. For a more detailed discussion,
see (Benedetto and Biglieri 1999; Blahut 1990; Wozencraft and Jacobs 1965).
1.4.2
Maximum likelihood sequence estimation
Again we consider the discrete-time model of Equations (1.63) and (1.69) and assume a
ﬁnite alphabet for the transmit symbols sk , so that there is a ﬁnite set of possible transmit
vectors s. Given a receive vector r, we ask for the most probable transmit vector ˆs, that is,
the one for which the conditional probability P (s|r) that s was transmitted given that r has
been received becomes maximal. The estimate of the symbol is
ˆs = arg max
s
P (s|r).
(1.74)
From Bayes law, we have
P (s|r)p(r) = p(r|s)P (s),
(1.75)
where p(r) is the pdf for the receive vector r, p(r|s) is the pdf for the receive vector r
given a ﬁxed transmit vector s, and P (s) is the a priori probability for s. We assume that
all transmit sequences have equal a priori probability. Then, from
p(r|s) ∝exp

−1
2σ 2 ∥r −s∥2

,
(1.76)
we conclude that
ˆs = arg min
s
∥r −s∥2 .
(1.77)
Thus, the most likely transmit vector minimizes the squared Euclidean distance. From
∥r −s∥2 = ∥r∥2 + ∥s∥2 −2ℜ

s†r

,
we obtain the alternative condition
ˆs = arg max
s

ℜ

s†r

−1
2 ∥s∥2

.
(1.78)
The ﬁrst (scalar product) term can be interpreted as a cross correlation between the transmit
and the receive signal. The second term is half the signal energy. Thus, the most likely
transmit signal is the one that maximizes the cross correlation with the receive signal,
thereby taking into account a correction term for the energy. If all transmit signals have
the same energy, this term can be ignored.
The receiver technique described above, which ﬁnds the most likely transmit vector, is
called maximum likelihood sequence estimation (MLSE). It is of fundamental importance
in communication theory, and we will often need it in the following chapters.
A continuous analog to Equation (1.78) can be established. We recall that the continuous
transmit signal s(t) and the components sk of the discrete transmit signal vector s are related
by
s(t) =
K

k=1
skgk(t),

BASICS OF DIGITAL COMMUNICATIONS
33
and the continuous receive signal r(t) and the components rk of the discrete transmit signal
vector r are related by
rk = Dgk[r] =
 ∞
−∞
g∗
k(t)r(t) dt.
From these relations, we easily conclude that
s†r =
 ∞
−∞
s∗(t)r(t) dt
holds. Equation (1.78) is then equivalent to
ˆs = arg max
s

ℜ{Ds[r]} −1
2 ∥s∥2

(1.79)
for ﬁnding the maximum likelihood (ML) transmit signal ˆs(t). In the ﬁrst term of this
expression,
Ds[r] =
 ∞
−∞
s∗(t)r(t) dt
means that the detector outputs (= sampled MF outputs) for all possible transmit signals
s(t) must be taken. For all these signals, half of their energy
∥s∥2 =
 ∞
−∞
|s(t)|2 dt
must be subtracted from the real part of the detector output to obtain the likelihood of each
signal.
Example 3 (Walsh Demodulator) Consider a transmission with four possible transmit
vectors s1, s2, s3 and s4 given by the columns of the matrix
[s1, s2, s3, s4] =


1
1
1
1
1
−1
1
−1
1
1
−1
−1
1
−1
−1
1

,
each being transmitted with the same probability. This is just orthogonal Walsh modulation
for M = 4. We ask for the most probable transmit vector ˆs on the condition that the vector r =
(1.5, −0.8, 1.1, −0.2)T has been received. Since all transmit vectors have equal energy,
the most probable transmit vector is the one that maximizes the scalar product with r. We
calculated the scalar products as
s1 · r = 2.0,
s2 · r = 3.2,
s3 · r = 0.4,
s4 · r = 1.4.
We conclude that s2 has most probably been transmitted.

34
BASICS OF DIGITAL COMMUNICATIONS
1.4.3
Pairwise error probabilities
Consider again a discrete AWGN channel as given by Equation (1.69). We write
r = s + nc,
where nc is the complex AWGN vector. For the geometrical interpretation of the following
derivation of error probabilities, it is convenient to deal with real vectors instead of complex
ones. By deﬁning
y =
 ℜ{r}
ℑ{r}

,
x =
 ℜ{s}
ℑ{s}

,
and
n =
 ℜ{nc}
ℑ{nc}

,
we can investigate the equivalent discrete real AWGN channel
y = x + n.
(1.80)
Consider the case that x has been transmitted, but the receiver decides for another symbol
ˆx. The probability for this event (excluding all other possibilities) is called the pairwise
error probability (PEP) P (x →ˆx). Deﬁne the decision variable
X = ∥y −x∥2 −∥y −ˆx∥2
as the difference of squared Euclidean distances. If X > 0, the receiver will take an erro-
neous decision for ˆx. Then, using simple vector algebra (see Problem 7), we obtain
X = 2

y −x + ˆx
2

(ˆx −x)

.
The geometrical interpretation is depicted in Figure 1.15. The decision variable is (up
to a factor) the projection of the difference between the receive vector y and the center
point 1
2(x + ˆx) between the two possible transmit vectors on the line between them. The
decision threshold is a plane perpendicular to that line. Deﬁne d = 1
2(ˆx −x) as the difference
vector between ˆx and the center point, that is, d = ∥d∥is the distance of the two possible
transmit signals from the threshold. Writing y = x + n and using x = 1
2(x + ˆx) −d, the
scaled decision variable ˜X =
1
4d X can be written as
˜X = (−d + n) · d
d .
It can easily be shown that
n = n · d
d ,
the projection of the noise onto the relevant dimension, is a Gaussian random variable
with zero mean and variance σ 2 = N0/2 (see Problem 8). Since ˜X = −d + n, the error
probability is given by
P ( ˜X) > 0) = P (n > d).

BASICS OF DIGITAL COMMUNICATIONS
35
ˆx
x
n
d
Decision threshold
n
y
˜X
Figure 1.15 Decision threshold.
This equals
P (n > d) = Q
 d
σ

,
(1.81)
where the Gaussian probability integral is deﬁned by
Q(x) =
1
√
2π
 ∞
x
e−1
2 ξ2 dξ
The Q-function deﬁned above can be expressed by the complementary Gaussian error
function erfc(x) = 1 −erf(x), where erf(x) is the Gaussian error function, as
Q (x) = 1
2erfc
 x
√
2

.
(1.82)
The pairwise error probability can then be expressed by
P (x →ˆx) = 1
2erfc
#$
1
4N0
∥x −ˆx∥2
%
.
(1.83)
Since the norms of complex vectors and the equivalent real vectors are identical, we can
also write
P (s →ˆs) = 1
2erfc
#$
1
4N0
∥s −ˆs∥2
%
.
(1.84)
For the continuous signal,
s(t) =
K

k=1
skgk(t),
(1.85)

36
BASICS OF DIGITAL COMMUNICATIONS
this is equivalent to
P (s(t) →ˆs(t)) = 1
2erfc
#$
1
4N0
 ∞
−∞
|s(t) −ˆs(t)|2 dt
%
.
(1.86)
It has been pointed out by Simon and Divsalar (Simon and Divsalar 1998) that, for
many applications, the following polar representation of the complementary Gaussian error
function provides a simpler treatment of many problems, especially for fading channels.
Proposition 1.4.1 (Polar representation of the Gaussian erfc function)
1
2erfc(x) = 1
π
 π/2
0
exp

−x2
sin2 θ

dθ.
(1.87)
Proof. The idea of the proof is to view the one-dimensional problem of pairwise error
probability as two-dimensional and introduce polar coordinates. AWGN is a Gaussian ran-
dom variable with mean zero and variance σ 2 = 1. The probability that the random variable
exceeds a positive real value, x, is given by the Gaussian probability integral
Q(x) =
 ∞
x
1
√
2π
exp

−1
2ξ 2

dξ.
(1.88)
This probability does not change if noise of the same variance is introduced in the second
dimension. The error threshold is now a straight line parallel to the axis of the second
dimension, and the probability is given by
Q(x) =
 ∞
x
 ∞
−∞
1
2π exp

−1
2(ξ 2 + η2)

dη

dξ.
(1.89)
This integral can be written in polar coordinates (r, φ) as
Q(x) =
 π/2
−π/2
 ∞
x/ cos φ
r
2π exp

−1
2r2

dr

dφ.
(1.90)
The integral over r can immediately be solved to give
Q(x) =
 π/2
−π/2
1
2π exp

−1
2
x2
cos2 φ

dφ.
(1.91)
A simple symmetry argument now leads to the desired form of 1
2erfc(x) = Q(
√
2x).
An upper bound of the erfc function can easily be obtained from this expression by
upper bounding the integrand by its maximum value,
1
2erfc(x) ≤1
2e−x2.
(1.92)
Example 4 (PEP for Antipodal Modulation) Consider the case of only two possible
transmit signals s1(t) and s2(t) given by
s1,2(t) = ±

ES g(t),

BASICS OF DIGITAL COMMUNICATIONS
37
where g(t) is a pulse normalized to ∥g∥2 = 1, and ES is the energy of the transmitted
signal. To obtain the PEP, according to Equation (1.86), we calculate the squared Euclidean
distance
∥s1 −s2∥2 =
 ∞
−∞
|s1(t) −s2(t)|2 dt
between two possible transmit signals s1(t) and s2(t) and obtain
∥s1 −s2∥2 =
&&&

Es g −

−

Es g
&&&
2
= 4ES.
The PEP is then given by Equation (1.86) as
P (s1(t) →s2(t)) = 1
2erfc
#$
ES
N0
%
.
One can transmit one bit by selecting one of the two possible signals. Therefore, the energy
per bit is given by Eb = ES leading to the PEP
P (s1(t) →s2(t)) = 1
2erfc
#$
Eb
N0
%
.
Example 5 (PEP for Orthogonal Modulation) Consider an orthonormal transmit base
gk(t), k = 1, . . . , M. We may think of the Walsh base or the Fourier base as an example,
but any other choice is possible. Assume that one of the M possible signals
sk(t) =

ES gk(t)
is transmitted, where ES is again the signal energy. In case of the Walsh base, this is just
Walsh modulation. In case of the Fourier base, this is just (orthogonal) FSK (frequency shift
keying). To obtain the PEP, we have to calculate the squared Euclidean distance
∥si −sk∥2 =
 ∞
−∞
|si(t) −sk(t)|2 dt
between two possible transmit signals si(t) and sk(t) with i ̸= k. Because the base is or-
thonormal, we obtain
∥si −sk∥2 = ES ∥gi −gk∥2 = 2ES.
The PEP is then given by
P (si(t) →sk(t)) = 1
2erfc
#$
ES
2N0
%
.
One can transmit log2(M) bits by selecting one of M possible signals. Therefore, the energy
per bit is given by Eb = ES/ log2(M), leading to the PEP
P (si(t) →sk(t)) = 1
2erfc
#$
log2(M) Eb
2N0
%
.
www.allitebooks.com

38
BASICS OF DIGITAL COMMUNICATIONS
Concerning the PEP, we see that for M = 2, orthogonal modulation is inferior compared
to antipodal modulation, but it is superior if more than two bits per signal are transmitted.
The price for that robustness of high-level orthogonal modulation is that the number of the
required signal dimensions and thus the required bandwidth increases exponentially with the
number of bits.
1.5
Linear Modulation Schemes
Consider some digital information that is given by a ﬁnite bit sequence. To transmit this
information over a physical channel by a passband signal ˜s(t) = ℜ

s(t)ej2πf0t
, we need
a mapping rule between the set of bit sequences and the set of possible signals. We call
such a mapping rule a digital modulation scheme. A linear digital modulation scheme is
characterized by the complex baseband signal
s(t) =
K

k=1
skgk(t),
where the information is carried by the complex transmit symbols sk. The modulation
scheme is called linear, because this is a linear mapping from the vector s = (s1, . . . , sK)T
of transmit symbols to the continuous transmit signal s(t). In the following subsections, we
will brieﬂy discuss the most popular signal constellations for the modulation symbols sk that
are used to transmit information by choosing one of M possible points of that constellation.
We assume that M is a power of two, so each complex symbol sk carries log2(M) bits of the
information. Although it is possible to combine several symbols to a higher-dimensional
constellation, the following discussion is restricted to the case where each symbol sk is
modulated separately by a tuple of m = log2(M) bits. The rule how this is done is called
the symbol mapping and the corresponding device is called the symbol mapper. In this
section, we always deal with orthonormal base pulses gk(t). Then, as discussed in the
preceding sections, we can restrict ourselves to a discrete-time transmission setup where
the complex modulation symbols
sk = xk + jyk
are corrupted by complex discrete-time white Gaussian noise nk.
1.5.1
Signal-to-noise ratio and power efﬁciency
Since we have assumed orthonormal transmit pulses gk(t), the corresponding detector out-
puts are given by
rk = sk + nk,
where nk is discrete complex AWGN. We note that, because the pulses are normalized
according to
 ∞
−∞
g∗
i (t)gk(t) dt = δik,
the detector changes the dimension of the signal; the squared continuous signals have the
dimension of a power, but the squared discrete detector output signals have the dimension
of an energy.

BASICS OF DIGITAL COMMUNICATIONS
39
The average signal energy is given by
E = E
  ∞
−∞
|s(t)|2 dt
!
= E
' K

k=1
|sk|2
(
= K E

|sk|2
,
where we have assumed that all the K symbols sk have identical statistical properties. The
energy per symbol ES = E/K is given by
ES = E

|sk|2
.
The energy of the detector output of the noise is
EN = E

|nk|2
= N0,
so the signal-to-noise ratio, SNR, deﬁned as the ratio between the signal energy and the
relevant noise, results in
SNR = ES
N0
.
When thinking of practical receivers, it may be confusing that a detector changes the
dimension of the signal, because we have interpreted it as a matched ﬁlter together with
a sampling device. To avoid this confusion, we may introduce a proper constant. For
signaling with the Nyquist base, gk(t) = g(t −kTS), one symbol sk is transmitted in each
time interval of length TS. We then deﬁne the matched ﬁlter by its impulse response
h(t) =
1
√TS
g∗(−t)
so that the matched ﬁlter output h(t) ∗r(t) has the same dimension as the input signal r(t).
The samples of the matched ﬁlter output are given by
1
√TS
rk =
1
√TS
sk +
1
√TS
nk.
Then, the power of the sampled useful signal is given by
PS = E
'))))
1
√TS
sk
))))
2(
= ES
TS
,
and the noise power is
PN = E
'))))
1
√TS
nk
))))
2(
= N0
TS
.
Thus, the SNR may equivalently be deﬁned as
SNR = PS
PN
,
which is the more natural deﬁnition for practical measurements.
The SNR is a physical quantity that can easily be measured, but it does not say any-
thing about the power efﬁciency. To evaluate the power efﬁciency, one must know the

40
BASICS OF DIGITAL COMMUNICATIONS
average energy Eb per useful bit at the receiver that is needed for a reliable recovery of
the information. If log2(M) useful bits are transmitted by each symbol sk, the relation
ES = log2(M) Eb
holds, which relates both quantities by
SNR = log2(M) Eb
N0
.
We note the important fact that Eb = PS/Rb is just the average signal power PS needed
per useful bit rate Rb. Therefore, a modulation that needs less Eb/N0 to achieve a reliable
transmission is more power efﬁcient .
In the following sections, we discuss the most popular symbol mappings and their
properties.
1.5.2
ASK and QAM
For M-ASK (amplitude-shift keying), a tuple of m = log2(M) bits will be mapped only
on the real part xk of sk, while the imaginary part yk will be set to zero. The M points
will be placed equidistant and symmetrically about zero. Denoting the distance between
two points by 2d, the signal constellation for 2-ASK is given by xl ∈{±d}, for 4-ASK by
xl ∈{±d, ±3d} and for 8-ASK by xl ∈{±d, ±3d, ±5d, ±7d} . We consider Gray mapping,
that is, two neighboring points differ only in one bit. In Figure 1.16, the M-ASK signal
constellations are depicted for M = 2, 4, 8.
Assuming the same a priori probability for each signal point, we easily calculate the
symbol energies as ES = E

|sk|2
= d2, 5d2, 21d2 for these constellations, leading to the
respective energies per bit Eb = ES/ log2(M) = d2, 2.5d2, 7d2.
Adjacent points have the distance 2d, so the distance to the corresponding decision
threshold is given by d. If a certain point of the constellation is transmitted, the probability
that an error occurs because the discrete noise with variance σ 2 = N0/2 (per real dimension)
exceeds the distance to the decision threshold with distance d is given by
Perr = Q
 d
σ

= 1
2 erfc


$
d2
N0

,
(1.93)
0
1
00
01
11
10
010
011
001
000
0 +d
–7d
–5d
–3d
–d
+3d +5d +7d
111
101
100
110
Figure 1.16 M-ASK Constellation for M = 2, 4, 8.

BASICS OF DIGITAL COMMUNICATIONS
41
see Equation (1.81). For the two outer points of the constellation, this is just the probability
that a symbol error occurs. In contrast, for M > 2, each inner point has two neighbors,
leading to a symbol error probability of 2Perr for these points. Averaging over the symbol
error probabilities for all points of each constellation, we get the symbol error probabilities
P 2−ASK
S
= Q
 d
σ

,
P 4−ASK
S
= 3
2 Q
 d
σ

,
P 8−ASK
S
= 7
4 Q
 d
σ

.
For Gray mapping, we can make the approximation that each symbol error leads only to
one bit error. Thus, we readily obtain the bit error probabilities expressed by the bit energy
for M = 2, 4, 8 as
P 2−ASK
b
= 1
2 erfc
#$
Eb
N0
%
,
and
P 4−ASK
b
≈3
8 erfc
#$
2
5
Eb
N0
%
,
(1.94)
P 8−ASK
b
≈7
24 erfc
#$
1
7
Eb
N0
%
.
For ASK constellations, only the I-component, corresponding to the cosine wave, will
be modulated, while the sine wave will not be present in the passband signal. Since, in
general, every passband signal of a certain bandwidth may have both components, 50% of
the bandwidth resources remain unused. A simple way to use these resources is to apply
the same ASK modulation for the Q-component too. We thus have complex modulation
symbols sk = xk + jyk, where both xk and yk are taken from an M-ASK constellation. The
result is a square constellation of M2 signal points in the complex plane, as depicted in
Figure 1.17 for M2 = 64. We call this an M2-QAM (quadrature amplitude modulation).
The bit error performance of M2-QAM as a function of Eb/N0 is the same as for M-ASK,
that is,
P 4−QAM
b
= 1
2 erfc
#$
Eb
N0
%
,
P 16−QAM
b
≈3
8 erfc
#$
2
5
Eb
N0
%
(1.95)
and
P 64−QAM
b
≈7
24 erfc
#$
1
7
Eb
N0
%
.
This is because the I- and the Q-component can be regarded as completely independent
channels that do not inﬂuence each other. Thus, M2-QAM can be regarded as M-ASK
multiplexed to the orthogonal I- and Q-channel. Note that the bit error rates are not identical
if they are plotted as a function of the signal-to-noise ratio. The bit error probabilities of
Equations (1.95) are depicted in Figure 1.18. For high values of Eb/N0, 16-QAM shows

42
BASICS OF DIGITAL COMMUNICATIONS
Q
I
Figure 1.17 The 64-QAM constellation.
0
5
10
15
20
10–6
10–5
10–4
10–3
10–2
10–1
100
Eb/N0 [dB]
Pb
4-QAM
16-QAM
64-QAM
Figure 1.18 Bit error probabilities for 4-QAM, 16-QAM, and 64-QAM.

BASICS OF DIGITAL COMMUNICATIONS
43
a performance loss of 10 lg(2.5) ≈4 dB compared to 4-QAM, while 64-QAM shows a
performance loss of 10 lg(7) ≈8.5 dB. This is the price that has to be paid for transmitting
twice, respectively three times the data rate in the same bandwidth.
We ﬁnally note that nonsquare QAM constellations are also possible like, for example,
8-QAM, 32-QAM and 128-QAM, but we will not discuss these constellations in this text.
1.5.3
PSK
For M-PSK (phase-shift keying), the modulation symbols sk can be written as
sk =

ES ejφk,
that is, all the information is contained in the M possible phase values φk of the symbol.
Two adjacent points of the constellation have the phase difference 2π/M. It is a matter of
convenience whether φ = 0 is a point of the constellation or not. For 2-PSK – often called
BPSK (binary PSK) – the phase may take the two values φk ∈{0, π} and thus 2-PSK is
just the same as 2-ASK. For 4-PSK – often called QPSK (quaternary PSK) – the phase
may take the four values φk ∈

± π
4 , ± 3π
4

and thus 4-PSK is just the same as 4-QAM.
The constellation for 8-PSK with Gray mapping, as an example, is depicted in Figure 1.19.
The approximate error probabilities for M-PSK with Gray mapping can be easily ob-
tained. Let the distance between two adjacent points be 2d. From elementary geometrical
consideration, we get
d =

ES sin
 π
M

.
For M > 2, each constellation point has two nearest neighbors. All the other signal points
corresponding to symbol errors lie beyond the two corresponding decision thresholds. By
000
001
010
110
111
100
I
Q
2d
101
011
Figure 1.19 Signal constellation for 8-PSK.

44
BASICS OF DIGITAL COMMUNICATIONS
a simple union-bound argument, we ﬁnd that the symbol error probability can be tightly
upper bounded by
PS ≤2Q
 d
σ

= erfc
#$
sin2  π
M
 ES
N0
%
.
By assuming that only one bit error occurs for each symbol error and taking into account
the relation ES = log2(M) Eb, we get the approximate expression
Pb ≈
1
log2(M)erfc
#$
log2(M) sin2  π
M
 Eb
N0
%
(1.96)
for the bit error probability. The bit error probabilities of Equation (1.96) are de-
picted in Figure 1.20. For high values of Eb/N0, 8-PSK shows a performance loss of
10 lg(3 sin2(π/8)) ≈3.6 dB compared to 4-PSK, while 16-PSK shows a performance loss
of 10 lg(4 sin2(π/16)) ≈8.2 dB. Thus, higher-level PSK modulation leads to a considerable
loss in power efﬁciency compared to higher-level QAM at the same spectral efﬁciency.
1.5.4
DPSK
For DPSK (differential PSK), the phase difference between two adjacent transmit symbols
carries the information, not the phase of the transmit symbol itself. This means that for a
sequence of transmit symbols
sk =

ES ejφk,
0
5
10
15
20
10–6
10–5
10–4
10–3
10–2
10–1
100
Eb/N0 [dB]
Pb
4-PSK
8-PSK
16-PSK
Figure 1.20 Bit error probabilities for 4-PSK, 8-PSK and 16-PSK.

BASICS OF DIGITAL COMMUNICATIONS
45
the information is carried by
φk = φk −φk−1,
and
zk = ejφk
is a symbol taken from an M-PSK constellation with energy one. The transmit symbols are
then given by the recursion
sk = zk · sk−1
with a start symbol s0 that may have some arbitrary reference phase φ0. We may set this
phase equal to zero and write
s0 =

ES.
Because of this phase reference symbol, the transmit signal
s(t) =
K

k=0
skgk(t)
carries K + 1 transmit symbols sk, but only K useful PSK symbols zk. Typically, the phase
reference symbol will be transmitted at the beginning of a frame, and the frame length is
large enough so that the loss in data rate due to the reference symbol can be neglected.
Again it is a matter of convenience whether the PSK constellation for zk contains
the phase (difference) φk = 0 or not. For the most popular QPSK constellation, φk ∈

± π
4 , ± 3π
4

or
zk ∈
 1
√
2
(±1 ± j)
!
.
Obviously, this leads to eight possible values of the transmit symbol sk, corresponding to
the absolute phase values
φk ∈
 
0, ±π
4 , ±π
2 , ±3π
4 , π
!
,
see Figure 1.21, where the possible transitions are marked by arrows.
For even values of k,
φk ∈
.
0, ±π
2 , π
/
and for odd values of k,
φk ∈
 
±π
4 , ±3π
4
!
.
We thus have two different constellations for sk, which are phase shifted by π/4. This
modulation scheme is therefore called π/4-DQPSK.
Differential PSK is often used because it does not require an absolute phase reference.
In practice, the channel introduces an unknown phase θ, that is, the receive signal is
rk = ejθsk + nk.
In a coherent PSK receiver, the phase must be estimated and back- rotated. A differential
receiver compares the phase of two adjacent symbols by calculating
uk = rkr∗
k−1 = sks∗
k−1 + ejθskn∗
k−1 + nke−jθs∗
k−1 + nkn∗
k−1.

46
BASICS OF DIGITAL COMMUNICATIONS
I
Q
Figure 1.21 Transmit symbols for π
4 -DQPSK.
In the noise-free case, uk/√ES = zk represents original PSK symbols that carry the infor-
mation. However, we see from the above equation that we have additional noise terms that
do not occur for coherent signaling and that degrade the performance. The performance
analysis of DPSK is more complicated than for coherent PSK (see e.g. (Proakis 2001)). We
will later refer to the results when we need them for the applications.
1.6
Bibliographical Notes
This chapter is intended to give a brief overview of the basics that are needed in the follow-
ing chapters and to introduce some concepts and notations. A more detailed introduction
into digital communication and detection theory can be found in many text books (see e.g.
(Benedetto and Biglieri 1999; Blahut 1990; Kammeyer 2004; Lee and Messerschmidt 1994;
Proakis 2001; Van Trees 1967; Wozencraft and Jacobs 1965)). We assume that the reader
is familiar with Fourier theory and has some basic knowledge of probability and stochastic
processes. We will not deﬁne these concepts further; one may refer to standard text books
(see e.g. (Bracewell 2000; Feller 1970; Papoulis 1991)).
We have emphasized the vector space properties of signals. This allows a geometrical
interpretation that makes the solution of many detection problems intuitively obvious. The
interpretation of signals as vectors is not new. We refer to the excellent classical text books
(Van Trees 1967; Wozencraft and Jacobs 1965).
We have emphasized the concept of a detector as an integral operation that performs a
measurement. A Fourier analyzer is such a device that may be interpreted as a set of detec-
tors, one for each frequency. The integral operation is given by a scalar product if the signal

BASICS OF DIGITAL COMMUNICATIONS
47
is well behaved (i.e. of ﬁnite energy). If not, the signal has to be understood as a generalized
function (which is called distribution or functional in mathematical literature (Reed and
Simon 1980)), and the detection is the action of this signal on a well-behaved test function.
It is interesting to note that this is the same situation as in quantum theory, where such a test
function is interpreted as a detection device for the quantum state of a physical system. In
this context it is worth noting that δ(t), the most important generalized function in commu-
nication theory, has been introduced by one of the quantum theory pioneers, P.A.M. Dirac.
1.7
Problems
1. Let {gk(t)}K
k=1 be an orthonormal transmit base and
s = (s1, . . . , sK)T
and
x = (x1, . . . , xK)T
two transmit symbol vectors. Let
s(t) =
K

k=1
skgk(t)
and
x(t) =
K

k=1
xkgk(t).
Show that
⟨s, x⟩= s†x.
2. Let S(f ) denote the Fourier transform of the signal s(t) and deﬁne
˜s(t) =
√
2 ℜ{s(t)ej2πf0t}.
Show that the Fourier transform of that signal is given by
˜S(f ) =
1
√
2

S (f −f0) + S∗(−f −f0)

.
3. Let x(t) and y(t) be ﬁnite-energy low-pass signals strictly band- limited to B/2
and let f0 > B/2. Show that the two signals
˜x(t) =
√
2 cos (2πf0t) x(t)
and
˜y(t) = −
√
2 sin (2πf0t) y(t)
www.allitebooks.com

48
BASICS OF DIGITAL COMMUNICATIONS
are orthogonal. Let u(t) and v(t) be two other ﬁnite-energy signals strictly band-
limited to B/2 and deﬁne
˜u(t) =
√
2 cos (2πf0t) u(t)
and
˜v(t) = −
√
2 sin (2πf0t) v(t).
Show that
⟨˜u, ˜x⟩= ⟨u, x⟩
and
⟨˜v, ˜y⟩= ⟨v, y⟩
hold. Hint: Transform all the signals into the frequency domain and use Parseval’s
equation.
4. Show that, from the deﬁnition of the time-variant linear systems I and Q, the
deﬁnitions (given in Subsection 1.2.2) of the time-variant linear systems I D and
QD are uniquely determined by
⟨˜u, Iv⟩=

I D ˜u, v

and
⟨˜u, Qv⟩=

QD ˜u, v

for any (real-valued) ﬁnite-energy signal ˜u(t) and v(t). Mathematically speaking,
this means that I D and QD are deﬁned as the adjoints of the linear operators I
and Q. For the theory of linear operators, see for example (Reed and Simon 1980).
5. Show that the deﬁnitions
E {w(t1)w(t2)} = N0
2 δ(t1 −t2)
and
E

Dφ1[w]Dφ2[w]

= N0
2 ⟨φ1, φ2⟩
are equivalent conditions for the whiteness of the (real-valued) noise w(t).
6. Let g(t) be a transmit pulse and n(t) complex baseband white (not necessarily
Gaussian) noise. Let
Dh[r] =
 ∞
−∞
h∗(t)r(t) dt
be a detector for a (ﬁnite-energy) pulse h(t) and r(t) = g(t) + n(t) be the transmit
pulse corrupted by the noise. Show that the signal-to-noise ratio after the detector
deﬁned by
SNR =
|Dh[g]|2
E
|Dh[n]|2
becomes maximal if h(t) is chosen to be proportional to g(t).

BASICS OF DIGITAL COMMUNICATIONS
49
7. Show the equality
∥y −x∥2 −∥y −ˆx∥2 = 2

y −x + ˆx
2

(ˆx −x)

.
8. Let n = (n1, . . . , nK)T be a K-dimensional real-valued AWGN with variance σ 2 =
N0/2 in each dimension and u = (u1, . . . , uK)T be a vector of length |u| = 1 in
the K-dimensional Euclidean space. Show that n = n · u is a Gaussian random
variable with mean zero and variance σ 2 = N0/2.
9. We consider a digital data transmission from the Moon to the Earth. Assume that
the digital modulation scheme (e.g. QPSK) requires Eb/N0 = 10 dB at the receiver
for a sufﬁciently low bit error rate of, for example, BER = 10−5. For free-space
propagation, the power at the receiver is given by
Pr = GtGr
λ2
(4πR)2 Pt.
We assume Gt = Gr = 10 dB for the antenna gains at the receiver and the trans-
mitter, respectively, and λ = 40 cm for the wavelength. The distance of the moon
is approximately given by R = 400 000 km. The receiver noise (including a noise
ﬁgure of 4 dB) is given by N0 = −170 dBm/Hz. How much transmit power is
necessary for a bit rate of Rb = 1 bit/s?


2
Mobile Radio Channels
2.1
Multipath Propagation
Mobile radio reception is severely affected by multipath propagation; the electromagnetic
wave is scattered, diffracted and reﬂected, and reaches the antenna via various ways as an
incoherent superposition of many signals with different delay times that are caused by the
different path lengths of these signals. This leads to an interference pattern that depends on
the frequency and the location or – for a mobile receiver – the time. The mobile receiver
moves through an interference pattern that may change within milliseconds and that varies
over the transmission bandwidth. One says that the mobile radio channel is characterized
by time variance and frequency selectivity.
The time variance is determined by the relative speed v between receiver and transmitter
and the wavelength λ = c/f0, where f0 is the transmit frequency and c is the velocity of
light. The relevant physical quantity is the maximum Doppler frequency shift given by
νmax = v
c f0 ≈
1
1080
f0
MHz
v
km/h Hz.
Table 2.1 shows some practically relevant ﬁgures for νmax for speeds from a slowly moving
person (2.4 km/h) to a high-speed train or car (192 km/h).
For an angle α between the direction of the received signal and the direction of motion,
the Doppler shift ν is given by
ν = νmax cos α.
Consider a carrier wave transmitted at frequency f0. Typically, the received signal is a
superposition of many scattered and reﬂected signals from different directions resulting
in a spatial interference pattern. For a vehicle moving through this interference pattern,
the received signal amplitude ﬂuctuates in time, which is called fading. In the frequency
domain, we see a superposition of many Doppler shifts corresponding to different di-
rections resulting in a Doppler spectrum instead of a sharp spectral line located at f0.
Figure 2.1 shows an example of the amplitude ﬂuctuations of the received time signal for
νmax = 50 Hz, corresponding for example, to a transmit signal at 900 MHz for a vehicle
Theory and Applications of OFDM and CDMA
Henrik Schulze and Christian L¨uders
2005 John Wiley & Sons, Ltd

52
MOBILE RADIO CHANNELS
Table 2.1
Doppler frequencies
Radio
Doppler frequency for a speed of
frequency
v = 2.4 km/h
v = 48 km/h
v = 120 km/h
v = 192 km/h
f0 = 225 MHz
0.5 Hz
10 Hz
25 Hz
40 Hz
f0 = 900 MHz
2.0 Hz
40 Hz
100 Hz
160 Hz
f0 = 2025 MHz
4.5 Hz
90 Hz
225 Hz
360 Hz
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
–40
–35
–30
–25
–20
–15
–10
–5
0
5
10
Time [s]
Level [dB]
Figure 2.1 Time variance (selectivity) of the fading amplitude for 50 Hz maximum Doppler
frequency.
speed v = 60 km/h. The ﬁgure shows deep amplitude fades up to −40 dB. If a car stands
still at the corresponding location (e.g. at a trafﬁc light), the reception breaks down. If the
car moves half a wavelength, it may get out of the deep fade.
The superposition of Doppler-shifted carrier waves leads to a ﬂuctuation of the carrier
amplitude and phase. This means that the received signal is amplitude and phase modulated
by the channel.
Figure 2.2 shows the trace of the phasor in the complex plane for the same channel
parameters as above. For digital phase modulation, these rapid phase ﬂuctuations cause
severe problems if the carrier phase changes too much during the time TS that is needed to
transmit one digitally modulated symbol. The amplitude and the phase ﬂuctuate randomly.
The typical frequency of the variation is of the order of νmax corresponding to a timescale
of the variations given by
tcorr = ν−1
max,

MOBILE RADIO CHANNELS
53
–2.5
–2
–1.5
–1
–0.5
0
0.5
1
1.5
2
2.5
–2
–1.5
–1
–0.5
0
0.5
1
1.5
I-component
Q-component
Figure 2.2 Time variance (selectivity) shown above as a curve in the complex plane.
which we call the correlation time. Digital transmission with symbol period TS is only
possible if the channel remains nearly constant during that period, which requires TS ≪tcorr
or, equivalently, the condition
νmaxTS ≪1
must hold.
The frequency selectivity of the channel is determined by the different delay times of
the signals. They can be calculated as the ratio between the traveling distances and the
velocity of light. 1 µs delay time difference corresponds to 300 m of path difference. A
few microseconds are typical for cellular mobile radio. For a broadcasting system for a
large area, echoes up to 100 µs are possible in a hilly or mountainous region. In a so-called
single frequency network (see Section 4.6), the system must cope with even longer echoes.
Longer echoes correspond to more fades within the transmission bandwidth. Figure 2.3
shows an example for a received signal level as a function of the frequency (relative to the
center frequency) at a ﬁxed location in a situation with delay time differences of the signals
corresponding to a few kilometers. In the time domain, intersymbol interference disturbs the
transmission if the delay time differences are not much smaller than the symbol duration
TS. A data rate of 200 kbit/s leads to TS = 10 µs for the QPSK modulation. This is of
the same order as the echoes for such a scenario. This means that digital transmission of
that data rate is not possible without using more sophisticated methods such as equalizers,
spread spectrum techniques, or multicarrier modulation. We deﬁne a correlation frequency
fcorr = τ −1,
where τ is the square root of the variance of the power distribution of the echoes, which we
call the delay spread. fcorr is often called coherence (or coherency) bandwidth because the

54
MOBILE RADIO CHANNELS
–250
–200
–150
–100
–50
0
50
100
150
200
250
–40
–35
–30
–25
–20
–15
–10
–5
0
5
10
Relative frequency f – f0 [kHz]
Level [dB]
Figure 2.3
Frequency selectivity (variance) of the fading amplitude for a broadcasting
channel with long echoes.
channel can be regarded as frequency-nonselective within a bandwidth B with B ≪fcorr.
If B is in the order of T −1
s
as it is the case for signaling with the Nyquist base, this is
equivalent to the condition
τ ≪TS
that intersymbol interference can be neglected.
2.2
Characterization of Fading Channels
2.2.1
Time variance and Doppler spread
Consider a modulated carrier wave
˜s(t) =
√
2 ℜ

s(t)ej2πf0t
(2.1)
at frequency f0 that is modulated by a complex baseband signal s(t). For a moving receiver
with velocity v and an incoming wave with an angle of incidence α relative to the direction
of motion, the carrier frequency will be shifted by the Doppler frequency given by
ν = νmax cos α.
(2.2)
The same Doppler shift occurs for a ﬁxed receiver and a transmitter moving with velocity
v. Because the angle α from the left-hand side causes the same Doppler shift as the angle

MOBILE RADIO CHANNELS
55
−α from the right-hand side, we identify both cases and let the angle run from 0 to π. The
Doppler-shifted receive signal is given by
˜r(t) =
√
2 ℜ

aejθej2πνts(t)ej2πf0t
,
(2.3)
where a is an attenuation factor and θ the phase of the carrier wave at the receiver. Here,
we have made some reasonable assumptions that simplify the treatment:
• The angle α is constant during the time of consideration. This is true if the distance
between transmitter and receiver is sufﬁciently large and we can assume that many
bits are transmitted during a very small change of the angle. This is in contrast to the
case of the acoustic Doppler shift of an ambulance car, where the angle runs from 0
to π during the observation time and the listener hears a tone decreasing in frequency
from f0 + vmax to f0 −vmax.
• The signal is of sufﬁciently small bandwidth so that the Doppler shift can be assumed
to be the same for all spectral components.
Furthermore, we have only taken into account that the delay of the RF signal results in a
phase delay, ignoring the group delay of the complex baseband signal s(t). We will study
the effect of such a delay in the following subsection. Here, we assume that these delays
are so small that they can be ignored. Typically, the received signal is the superposition
of several signals, scattered from different obstacles, with attenuation factors ak, carrier
phases θk and Doppler shifts νk = νmax cos αk, resulting in
˜r(t) =
√
2
N

k=1
ℜ

akejθkej2πνkts(t)ej2πf0t
.
(2.4)
The complex baseband transmit and receive signals s(t) and r(t) are thus related by
r(t) = c(t)s(t),
(2.5)
where
c(t) =
N

k=1
akejθkej2πνkt
(2.6)
is the time-variant complex fading amplitude of the channel. Typically, this complex fading
amplitude looks as shown in Figures 2.1 and 2.2. In the special case of two-path channels
(N = 2), the fading amplitude shows a more regular behavior. In this case, the time-variant
power gain |c(t)|2 of the channel can be calculated as
|c(t)|2 = a2
1 + a2
2 + 2a1a2 cos (2π (ν1 −ν2) t + θ1 −θ2) .
Figure 2.4 shows |c(t)|2 for a1 = 0.75 and a2 =
√
7/4. The average power is normal-
ized to one, the maximum power is (a1 + a2)2 ≈1.99, the minimum power is (a1 −a2)2 ≈
0.008, resulting in level ﬂuctuations of about 24 dB. The fading amplitude is periodic
with period |v1 −v2|−1. Such a two-path channel can occur in reality, for instance, in
the special situation where the received signal is a superposition of a direct signal and

56
MOBILE RADIO CHANNELS
0
0.01
0.02
0.03
0.04
0.05
–30
–25
–20
–15
–10
–5
0
5
t [s]
|c(t)|2 [dB]
Figure 2.4 Time variance of a two-path channel.
a strong reﬂection. If, for example, ν1 = νmax and ν2 = −νmax, that is, one signal from
the front and one from the back, then the period is (2νmax)−1. Since νmax = v/λ, the
spatial separation of two power maxima (or minima) is λ/2. This interference pattern is
well known in physics as a standing wave. In the example, we have chosen ν1 = 100 Hz
and ν2 = −100 Hz, which corresponds to 120 km/h at 900 MHz. For that frequency,
λ/2 ≈16.7 cm.
It is a usual assumption to think of a general complex fading amplitude c(t) given by
Equation (2.6) as a stationary random signal. This is a convenient assumption, but one
should keep in mind that this introduces a simpliﬁed mathematical model for the physical
reality. We therefore add the following remarks:
• The real physical c(t) is deterministic because ak, νk, and θk are deterministic. But
at least the phases θk are completely unknown. It is reasonable and a common prac-
tice in communications engineering to model unknown phases as random variables.
Philosophically speaking, statistics is not due to the randomness of nature, but to
our lack of knowledge. This is also a common practice in physics, for example, in
statistical thermodynamics (Landau and Lifshitz 1958).
• Strictly speaking, stationarity cannot be true because the environment changes. This
slow change of the channel is called long-term fading, in contrast to the short-term
fading considered here. Long-term fading is of primary interest for network planning
(see Subsection 5.1.2), but for the performance analysis of communication systems
we have to focus on the short-term fading, thereby assuming that the environment

MOBILE RADIO CHANNELS
57
is constant during the time period that is necessary to measure, for example, the bit
error rate.
• Because mathematical modeling of physical reality is a coarse procedure, we regard
it as splitting hairs to distinguish between wide-sense stationary (WSS) and strict-
sense stationary (SSS) stochastic processes. For SSS processes, time-shift invariance
is given for all statistical properties, while for WSS this is only true up to the second-
order properties (covariances). For a theoretical analysis, for example, to identify bit
error probabilities with bit error rates, we need to assume even some ergodic prop-
erties (which is a stronger assumption than SSS) that are mathematically necessary
but physically not given.
The random process c(t) given by Equation (2.6) has a discrete power spectral density
(psd) Sc(ν) as shown in Figure 2.5(a) for N = 5. We call Sc(ν) the Doppler spectrum.
However, in most real situations, the received signal is a continuous rather than a discrete
superposition of Doppler-shifted signals, resulting in a continuous psd Sc(ν) as shown in
Figure 2.5(b).
As a result of Equation (2.2), each Doppler frequency corresponds to an angle α ∈[0, π].
Therefore, the Doppler spectrum is related to the angular power density Sangle(α) by
−Sc(ν) dν = Sangle(α) dα.
The negative sign is due to the fact that, because the cosine is a decreasing function over
the relevant interval, a positive inﬁnitesimal dα corresponds to a negative inﬁnitesimal dν.
By Equation (2.2), we get
dν = −νmax sin α dα = −νmax
$
1 −ν2
ν2max
dα
resulting in
Sc(ν)

ν2max −ν2 = Sangle

arccos
 ν
νmax

, −νmax < ν < νmax.
(a)
(b)
ν
ν
Figure 2.5 Example of a discrete (a) and continuous (b) Doppler spectrum.
www.allitebooks.com

58
MOBILE RADIO CHANNELS
A simple model – and also a kind of worst case – is the isotropic angular power distribution
Sangle(α) = π−1. In that case, we obtain the power spectral density
Sc(ν) =
1
πνmax

1 −
ν2
ν2max
(2.7)
for −νmax < ν < νmax and zero outside that interval. This spectral shape is sometimes
called the isotropic or Jakes Doppler spectrum (Jakes 1975). Figure 2.6 shows this (nor-
malized) Doppler spectrum νmaxSc(ν). Note the singularities at the edges that have their
origin in geometry.
We assumed that c(t) is the complex baseband signal corresponding to a (wide-sense)
stationary stochastic process, which is the carrier wave affected by the Doppler spread. The
autocorrelation function (ACF) of such a process is given by
Rc(t) = E

c(t1 + t)c∗(t1)

(see Proposition 1.3.3). The power spectrum is the Fourier transform of the ACF, that is,
Sc(ν) =
 ∞
−∞
e−j2πνtRc(t) dt.
For the Jakes spectrum, the ACF given by
Rc(t) = J0 (2πνmaxt) ,
(2.8)
where J0 (x) is the Bessel function of the ﬁrst kind of order 0.
–2
–1.5
–1
–0.5
0
0.5
1
1.5
2
0
0.5
1
1.5
2
2.5
Normalized Doppler frequency n/nmax
Power spectral density (linear)
Figure 2.6 The Jakes Doppler spectrum corresponding to the isotropic power distribution.

MOBILE RADIO CHANNELS
59
Because of the coarse modeling of reality, relevant quantities like error probabilities
should not strongly depend on the shape of the Doppler spectrum, and in fact, they do not
for all known examples. We will illustrate this by the following consideration. As discussed
above, digital transmission is only possible if the channel does not vary too fast relative to
the symbol duration, which can be expressed by the condition νmaxTS ≪1 over relevant
times (of the order TS). The correlation time tcorr = ν−1
max must be large enough so that the
channel samples are highly correlated. These correlations are characterized by the ACF
Rc(t). Thus, only Rc(t) for small values |t| ≪tcorr is relevant for the performance and we
may approximate Rc(t) by a Taylor series. We note that
dn
dtn Rc(t)
))))
t=0
= (2πj)nµn {Sc(ν)} ,
where
µn {Sc(ν)} =
 ∞
−∞
νnSc(ν) dν
is the nth moment of the power spectral density. Rc(t) can thus be expanded into the Taylor
series
Rc(t) =
∞

n=0
1
n!(2πj)nµn {Sc(ν)} tn.
Note that µ0 {Sc(ν)} = 1 due to energy normalization and µ1 {Sc(ν)} = 0 can always be
achieved by a frequency shift. Since µn {Sc(ν)} ≤(2νmax)n, the absolute value of the nth
term in the Taylor series is bounded by
1
n!|4πνmaxt|n,
which is very small for |t| ≪tcorr = ν−1
max. We thus approximate Rc(t) by the lowest non-
trivial order of the Taylor series
Rc(t) ≈1 −1
2(2π)2µ2 {Sc(ν)} t2.
Thus, one should expect that only the second moment of the Doppler spectrum – rather
than the exact shape – is relevant for the performance of the system. We will see later in
Subsection 2.4.6 that the bit error rate of differential QPSK (DQPSK) in a time-variant
fading channel depends on the time variance through Rc(TS).
Thus, it is therefore not important to use the real shape of the Doppler spectrum. We
may use, for example, the Jakes spectrum as a coarse reﬂection of reality. We note that
the second moment typically becomes smaller if the angles of receive signals are not
isotropically distributed.
Furthermore, we should always keep in mind that the assumed stationarity (or wide-
sense stationarity) is, strictly speaking, not true. We can only say that c(t) cannot be
distinguished from a stationary process when observed over a relatively short time of, say,
a few seconds. This makes it reasonable to treat it like a stationary process, because this is
mathematically convenient.

60
MOBILE RADIO CHANNELS
Finally, we state that for the Jakes spectrum the second moment can easily be calcu-
lated as
µ2 {Sc(ν)} = ν2
max
2
(see Problem 2).
The inverse of the variance
ν =

µ2 {Sc(ν)}
also appears to be a reasonable choice for the deﬁnition of the correlation time tcorr. How-
ever, vmax is easy to obtain from the carrier frequency and the vehicle speed and is therefore
a better choice for the practice. For typical shapes as the Jakes spectrum, both quantities
are of the same order.
2.2.2
Frequency selectivity and delay spread
Consider again a transmit signal as given by Equation (2.1). We now assume that both
transmitter and receiver are at rest (or the time variance is so slow that it can be neglected
for the time period under consideration) and we can ignore any Doppler shifts. But, unlike
in the above treatment, we do not ignore the delays τk = lk/c of the complex baseband
signal s(t) →s(t −τk) for the different propagation paths of length lk. Instead of Equation
(2.4), we now get for the received signal
˜r(t) =
√
2
N

k=1
ℜ

akejθk s(t −τk)ej2πf0t
.
(2.9)
The delays of the carrier are already included in the phases θk. The complex baseband
transmit and receive signals s(t) and r(t) are related by
r(t) = h(t) ∗s(t),
(2.10)
where
h(t) =
N

k=1
akejθkδ(t −τk)
(2.11)
is the impulse response of the channel. The corresponding channel transfer function is
given by
H(f ) =
N

k=1
akejθke−j2πf τk.
(2.12)
We note the strong similarity to Equation (2.6). Typically, the frequency response looks as
shown in Figure 2.3. In the special case of two-path channels (N = 2), the transfer function
shows a more regular behavior. In this case, the power gain |H(f )|2 of the channel can be
calculated as
|H(f )|2 = a2
1 + a2
2 + 2a1a2 cos (2πf (τ1 −τ2) + θ2 −θ1) .
The picture is similar to the one depicted in Figure 2.4, where time is replaced by frequency.
The transfer function is periodic with period |τ1 −τ2|−1.

MOBILE RADIO CHANNELS
61
(a)
(b)
τ
τ
Figure 2.7 Example of a discrete (a) and continuous (b) delay power spectrum.
With the same arguments as for the treatment of the time-variant fading amplitude c(t),
we may regard H(f ) as a random transfer function, or – more formally – as a stochastic
process in a frequency variable. Frequency-shift invariance (corresponding to stationarity
for the time variable) can only be an approximation. The same remarks about modeling the
reality as made in the preceding subsection apply here. Since the variable for this process
is a frequency, there is a power density distribution as a function of a time variable τ that
can be identiﬁed as the delay time. Figure 2.7(a) illustrates such a delay power spectrum
SH(τ) corresponding to the process given by the Equations (2.11) and (2.12). However, in
most real situations, the received signal is a continuous rather than a discrete superposition
of delayed signal components, resulting in a continuous delay power spectrum SH(τ) as
shown in Figure 2.7(b). Note that the delay power spectrum reﬂects the distribution of path
length. We identify the delay spread as
τ =

µ2 {SH(τ)} −µ2
1 {SH(τ)}.
Here, in contrast to the Doppler spectrum, we do not set the ﬁrst moment to zero because
this would lead to negative delay times τ. However, with similar arguments as for the
Doppler spectrum, we expect that typically the performance of a communication system in
a frequency selective fading channel will not depend on the shape of SH(τ), but only on
the second moment.
One popular model for SH(τ) is an exponential distribution
SH(τ) = 1
τm
e−τ/τm
for τ > 0 and zero elsewhere. The mean value τm of this distribution equals the delay
spread τ. The exponential power delay spectrum reﬂects the idea that the power of the
paths decreases strongly with their delay. This is of course a very rough model, but it can
be reﬁned by adding components due to signiﬁcant distant reﬂectors.
We have assumed frequency-shift invariance (which is similar to what is called wide-
sense stationarity for the time variable). The (frequency) ACF is given by
RH(f ) = E

H(f1 + f )H ∗(f1)

.

62
MOBILE RADIO CHANNELS
The delay power spectrum is the inverse Fourier transform of the ACF, that is,
SH(τ) =
 ∞
−∞
ej2πf τRH(f ) df.
For the exponential delay power spectrum, the ACF given by
RH(f ) =
1
1 + j2πf τm
.
2.2.3
Time- and frequency-variant channels
We now consider a channel that is both time and frequency selective. We combine the
effects of the Equations (2.4) and (2.9) and obtain a receive signal given by
˜r(t) =
√
2
N

k=1
ℜ

akejθkej2πνkts(t −τk)ej2πf0t
.
(2.13)
The complex baseband transmit and receive signals s(t) and r(t) are related by
r(t) =
 ∞
−∞
h(τ, t)s(t −τ) dτ,
(2.14)
where
h(τ, t) =
N

k=1
akejθkej2πνktδ(t −τk)
(2.15)
is the time-variant impulse response of the channel. Note that Equation (2.14) contains
Equations (2.5) and (2.10) as special cases by setting either h(τ, t) = c(t)δ(τ) or h(τ, t) =
h(τ). We note that h(τ, t) is the channel response of an impulse with travel time τ received
at time t, that is, transmitted at time t −τ.
The time-variant channel transfer function will now be deﬁned as the Fourier transform
in the delay variable τ of the time-variant impulse response
H(f, t) =
 ∞
−∞
e−j2πf τh(τ, t) dτ
which equals
H(f, t) =
N

k=1
akejθkej2πνkte−j2πf τk
in our special case. The receive signal r(t) is related to the Fourier transform S(f ) of the
transmit signal s(t) by
r(t) =
 ∞
−∞
e−j2πf τH(f, t)S(f ) dτ.
The power density with respect to Doppler and delay is now given by a common power
density function S(τ, ν) called scattering function with the properties
Sc(ν) =
 ∞
−∞
S(τ, ν) dτ

MOBILE RADIO CHANNELS
63
and
SH(τ) =
 ∞
−∞
S(τ, ν) dν.
Since the Doppler frequency is related to the angle of the incoming wave by ν = νmax cos α,
and the delay is related to the echo path length l by τ = l/c, the scattering function reﬂects
the geometrical distribution of the scatterers and their corresponding power contributions.
Like the Doppler and the delay power spectrum, the scattering function is typically a
continuous rather than a discrete superposition of Doppler-shifted and delayed components.
The ACF of the two-dimensional random process is deﬁned by
R(f, t) = E

H(f1 + f, t1 + t)H ∗(f1, t1)

.
It is related to the scattering function by a two-dimensional Fourier (back) transform
S(τ, ν) =
 ∞
−∞
df
 ∞
−∞
dt ej2πf τe−j2πνtR(f, t).
Here, we have used the simpler notation
"
dx
"
dyf (x, y) instead of
" "
f (x, y) dy

dx.
We note that
R(0, t) = Rc(t)
and
R(f, 0) = RH(f )
hold.
Up to now, the treatment was mainly heuristic, which seems to be adequate for a channel
that can only be modeled roughly. However, formally we have to deal with time-variant
random systems. In the following section, we characterize such systems and give more
formal deﬁnitions. However, these are formal mathematical concepts and their relation to
reality must be argued as done above.
2.2.4
Time-variant random systems: the WSSUS model
Consider a linear, but typically not time-invariant system. The output r(t) for an input s(t)
of such a system can formally be written as
r(t) =
 ∞
−∞
k(t, t′)s(t′) dt′,
(2.16)
where k(t, t′) is the so-called integral kernel of the system. This means that the output at
time t is a continuous superposition of the input signal taken at time instants t′ multiplied
by a weight factor k(t, t′). We add the following remarks:
• For (ﬁnite-dimensional) vectors, every linear mapping is given by a matrix multipli-
cation. Equation (2.16) is just a natural generalization of a matrix multiplication to
the continuous case.
• In the case in which the kernel depends only on the difference argument t −t′, that
is k(t, t′) = ˜k(t −t′), the system is time invariant, and Equation (2.16) reduces to a
convolution.

64
MOBILE RADIO CHANNELS
• Equation (2.16) is a formal notation. The integral kernel k(t, t′) may contain sin-
gularities, for example, terms like δ-functions. But this is not really a problem in
practice.
We now substitute the integration variable by τ = t −t′, which can be interpreted as the
delay between the input time t′ and the output time t, resulting in
r(t) =
 ∞
−∞
k(t, t −τ)s(t −τ) dτ.
Furthermore, we deﬁne the time-variant impulse response as
h(τ, t) = k(t, t −τ)
and obtain
r(t) =
 ∞
−∞
h(τ, t)s(t −τ) dτ.
The time-variant channel transfer function is deﬁned as the Fourier transform in the delay
variable τ of the time-variant impulse response
H(f, t) =
 ∞
−∞
e−j2πf τh(τ, t) dτ.
The receive signal r(t) is related to the Fourier transform S(f ) of the transmit signal s(t) by
r(t) =
 ∞
−∞
ej2πf τH(f, t)S(f )τ,
where H(f, t) is the time-variant transfer function of the channel.
We now assume that the time-variant transfer function H(f, t) is a two-dimensional
random process, and, without losing generality, that the mean value is zero1. We further
assume that the two-dimensional autocorrelation is time- and frequency-shift invariant,
that is,
E

H(f1 + f, t1 + t)H ∗(f1, t1)

= E

H(f2 + f, t2 + t)H ∗(f2, t2)

.
(2.17)
Such a process is called a wide-sense stationary uncorrelated scattering (WSSUS) process.
Wide-sense stationarity means time-shift invariance only up to second-order statistical ex-
pectation values. This is weaker than SSS, where all statistical expectation values must be
time-shift invariant. Frequency-shift invariance up to the second order is named uncorre-
lated scattering for reasons that will become obvious soon. The two-dimensional ACF of
the two-dimensional random process is deﬁned by
R(f, t) = E

H(f1 + f, t1 + t)H ∗(f1, t1)

(2.18)
and the scattering function by the two-dimensional (2-D) Fourier (back) transform
S(τ, ν) =
 ∞
−∞
df
 ∞
−∞
dt ej2πf τe−j2πνtR(f, t).
(2.19)
1If the mean value does not equal zero, we may consider the stochastic process of the difference to the mean
value.

MOBILE RADIO CHANNELS
65
Because H(f, t) is the complex baseband process for a WSSUS process, we have the
property
E {H(f1 + f, t1 + t)H(f1, t1)} = 0,
which is the generalization of the result of Proposition 1.3.3. to two-dimensional stochastic
processes.
We deﬁne the 2-D Fourier transform of the time-variant transfer function as
G(τ, ν) =
 ∞
−∞
df
 ∞
−∞
dt ej2πf τe−j2πνtH(f, t).
(2.20)
The inverse is given by
H(f, t) =
 ∞
−∞
dτ
 ∞
−∞
dν e−j2πf τej2πνtG(τ, ν).
(2.21)
The term uncorrelated scattering stems from the following.
Proposition 2.2.1 (Uncorrelated scattering) The condition (2.17) is equivalent to the con-
dition
E

G(τ1, ν1)G∗(τ2, ν2)

= δ(τ1 −τ2)δ(ν1 −ν2)S(τ1, ν2)
with S(τ, ν) deﬁned by Equations (2.19) and (2.18).
Proof. From Equations (2.20) and (2.18), we conclude that the left-hand side equals
the fourfold integral
 ∞
−∞
df1 dt1 df2 dt2 ej2πf1τ1e−j2πν1t1e−j2πf2τ2ej2πν2t2 · E

H(f1, t1)H ∗(f2, t2)

=
 ∞
−∞
df1
 ∞
−∞
dt1
 ∞
−∞
df2
 ∞
−∞
dt2 ej2π(f1τ1−f2τ2)e−j2π(ν1t1−ν2t2)R(f1 −f2, t1 −t2).
We change the order of integration and substitute f = f1 −f2 for f1 and t = t1 −t2 for
t1 to obtain
 ∞
−∞
df2
 ∞
−∞
dt2
 ∞
−∞
df
 ∞
−∞
dt ej2π(f +f2)τ1e−j2πν1(t+t2)e−j2πf2τ2ej2πν2t2R(f, t)
=
 ∞
−∞
df2ej2πf2(τ1−τ2)
 ∞
−∞
dt2e−j2π(ν1−ν2)t2
 ∞
−∞
df
 ∞
−∞
dt ej2πf τ1e−j2πν1tR(f, t).
The ﬁrst integral equals δ(τ1 −τ2), the second equals δ(ν1 −ν2) and the third (twofold)
integral equals S(τ1, ν2).
We add the following remarks:
• This is a generalization of a known property for WSS processes to two dimensions:
The Fourier transform X(f ) of a WSS process x(t) has the property that its values
X(f1) and X(f2) for different frequencies f1 and f2 are uncorrelated (see e.g. (Pa-
poulis 1991)). The proposition says that the values of G(τ, ν) for different Doppler
frequencies and for different delays are uncorrelated.
• We must note that in a real transmission setup, uncorrelated scattering will no
longer be given because any receive ﬁlter will introduce a correlation between delays
τ1 and τ2.

66
MOBILE RADIO CHANNELS
2.2.5
Rayleigh and Ricean channels
To apply the WSSUS model to concrete problems in digital communications (e.g. to calcu-
late or simulate bit error rates), the statistics of the two-dimensional fading process H(f, t)
has to be speciﬁed. In many typical situations without line of sight (LOS), the received
signal is a superposition of many scattered components. Owing to the central limit theorem
(Feller 1970; Papoulis 1991; van Kampen 1981), it is reasonable in this case to model
H(f, t) by a Gaussian process with zero mean. If a LOS component is present, this can
be taken into account simply by adding a constant mean value. A WSSUS process that
is Gaussian is sometimes called a GWSSUS process. We note that a wide-sense stationary
Gaussian process is already a strict-sense stationary (see e.g. (Feller 1970; Papoulis 1991)).
Gaussian processes are completely characterized by their properties up to second order, that
is, the mean and the autocorrelation (one can take this as a deﬁnition of a Gaussian process).
For a GWSSUS process with zero mean, every sample H(f1, t1) for ﬁxed frequency and
time is a complex Gaussian random variable that we write as
H(f1, t1) = X + jY.
From the property
E {H(f1 + f, t1 + t)H(f1, t1)} = 0
we conclude that X and Y are uncorrelated and have the same variance (see Problem 1).
Because these random variables are Gaussian, they are even statistically independent, iden-
tically distributed real Gaussian random variables . We normalize the average power gain
of the channel to one so that
E

X2
= E

Y 2
= 1
2.
The probability density functions of X and Y are then given by
pX(x) =
1
√π e−x2, pY (y) =
1
√π e−y2.
We introduce polar coordinates X = A cos 	, Y = A sin 	 to calculate the joint pdf
pA,	(a, φ) of amplitude and phase. From the condition
pA,	(a, φ) da dφ = pX(x)pY (y) dx dy
and dx dy = a da dφ, we obtain
pA,	(a, φ) = 1
2π 2ae−a2.
Thus, pA,	(a, φ) = pA(a)p	(φ) with
p	(φ) = 1
2π
and
pA(a) = 2ae−a2.
(2.22)

MOBILE RADIO CHANNELS
67
This probability density function for the amplitude is called Rayleigh distribution. We
therefore call this mean-zero GWSSUS channel a Rayleigh fading channel. It is interesting
to ask for the pdf ppower(γ ) of the power A2. From the condition
ppower(γ ) dγ = pA(a) da
we easily obtain
ppower(γ ) = e−γ ,
that is, the power is exponentially distributed for a Rayleigh fading channel. The probability
P(A2 < γ ) that the power falls below a certain value γ is given by
P(A2 < γ ) =
 γ
0
e−x dx = 1 −e−γ = γ −1
2γ 2 + · · · .
For small values of γ , the approximation P(A2 < γ ) ≈γ is allowed. We can now easily
conclude that, in a Rayleigh fading channel, the probability for a deep fade of −20 dB
(relative to the mean power) is approximately 1%, the probability for a deep fade below
−30 dB is approximately 0.1% and so on.
For a LOS channel, we assume a GWSSUS channel with a constant mean value, that
is, the Doppler shift of the LOS is assumed to be zero. This can always be achieved by a
proper choice of the carrier frequency f0, that is, each Doppler shift is deﬁned as the shift
relative to the LOS. The probability density function for the amplitude is now a Gaussian
distribution with nonzero mean. It can be shown to be (Proakis 2001)
pA(a) = 2a (1 + K) e
−

K+a2(1+K)

· I0

2a

K (1 + K)

,
where I0 (x) is the modiﬁed Bessel function of the ﬁrst kind and order zero. This pdf is called
the Rice distribution and the GWSSUS channel is called a Ricean channel. The parameter
K called Rice factor is the power ratio between the LOS component and the scattering
components. The special case K = 0 corresponds to the absence of a LOS and leads to a
Rayleigh channel. The special case K →∞corresponds to the absence of scattering and
leads to an AWGN channel. Figure 2.8 shows the Ricean pdf for different values of K. For
large K, it approaches a δ function. The pdf for the power can be obtained as
ppower(γ ) = (1 + K) e−(K+γ (1+K)) · I0

2

γ K (1 + K)

.
The probability P(A2 < γ ) that the power falls below a certain value γ must be calculated
by numerical integration. Figure 2.9 shows this quantity for different values of K.
2.3
Channel Simulation
To evaluate the performance of a digital communication system in a mobile radio channel
by means of computer simulations, we need a simulation method that can be implemented
in a computer program and that reﬂects the relevant statistical properties of the channels
discussed above. In this section, we introduce a practical simulation method that is quite
simple to implement and has been adopted by many authors because of its computational
efﬁciency.

68
MOBILE RADIO CHANNELS
0
0.5
1
1.5
2
2.5
3
0
0.5
1
1.5
2
2.5
3
3.5
Probability density
Amplitude
K = 0
K = 32
K = 16
K = 8
K = 4
K = 2
K = 1
Figure 2.8 The Ricean pdf for K = 0 (Rayleigh), and K = 1, 2, 4, 8, 16, 32.
–30
–25
–20
–15
–10
–5
0
5
10
10–3
10–2
10–1
100
Probability (power < g)
g [dB]
K = 0
K = 1
K = 2
K = 4
K = 8
K = 32
K = 16
Figure 2.9
The probability P(A2 < γ ) that the power below a certain value γ for the
Ricean channel with K = 0 (Rayleigh), and K = 1, 2, 4, 8, 16, 32.

MOBILE RADIO CHANNELS
69
The main idea of this simulation model is to reverse the line of thought that leads
to the statistical Gaussian WSSUS model to reﬂect the physical reality. The central limit
theorem gives the justiﬁcation to apply the mathematical model of a Gaussian process
for a physical signal that is the superposition of many unknown, that is, (pseudo-) ran-
dom components. On the other hand, owing to the central limit theorem, a superposition
of sufﬁciently many independent random signal components should be a good approxi-
mation for a Gaussian process and should thus be a good model for computer simula-
tions. The remaining task is to ﬁnd out what statistical properties of the components are
needed to achieve the appropriate statistical properties of the composed process. For a zero
mean GWSSUS channel, we make the following ansatz for the process of the simulation
model
HN(f, t) =
1
√
N
N

k=1
ejθkej2πνkte−j2πf τk,
(2.23)
where θk, νk, τk are random variables that are statistically independent and identically dis-
tributed for different values of k. To be more speciﬁc, the random phase θk is assumed to
be independent of νk and τk and it is uniformly distributed over the unit circle. The random
variables νk and τk have a joint pdf p(τ, ν) that needs to be adjusted to the statistical
properties of the mathematical GWSSUS channel, which is completely characterized by
the autocorrelation R(f, t) or, alternatively, by the scattering function S(τ, ν). The factor
1/
√
N in Equation (2.23) has been introduced to normalize the average power to one. Note
that we did not introduce different amplitudes for the different fading paths. It turns out that
this is not necessary. Because of the central limit theorem, in the limit N →∞, HN(f, t)
approaches a Gaussian process. The following theorem states that HN(f, t) is WSSUS for
any ﬁnite value of N.
Theorem 2.3.1 For any value of N,
E

HN(f1 + f, t1 + t)H ∗
N(f1, t1)

= E

HN(f2 + f, t2 + t)H ∗
N(f2, t2)

is independent of f1 and t1 and
E

HN(f1 + f, t1 + t)H ∗
N(f1, t1)

=
 ∞
−∞
dτ
 ∞
−∞
dν e−j2πf τej2πνtp(τ, ν)
holds. Furthermore
E {HN(f, t)} = 0.
Proof. We insert Equation (2.23) into the left-hand side of the above equation and
obtain the expression
1
N
N

k=1
N

l=1
E

ej(θk−θl)ej2π(νk(t1+t)−νlt1)e−j2π((f1+f )τk−f1τl)
= 1
N
N

k=1
N

l=1
E

ej(θk−θl)
E

ej2π(νk(t1+t)−νlt1)e−j2π((f1+f )τk−f1τl)
.

70
MOBILE RADIO CHANNELS
The last equality holds because θk is independent of all other random variables. For k ̸= l,
E

ej(θk−θl)
= E

ejθk
E

ejθl
= 0. Therefore, all terms with k ̸= l in the double sum
vanish and we obtain the single sum
1
N
N

k=1
E

ej2πνkte−j2πf τk
,
which is obviously independent of f1 and t1. Because the random variables νk and τk
have the same statistics for all values of k with joint pdf p(τ, ν), we eventually obtain for
the sum
E

ej2πνkte−j2πf τk
=
 ∞
−∞
dτ
 ∞
−∞
dν e−j2πf τej2πνtp(τ, ν).
The second property follows from E

ejθl
= 0.
The theorem states that HN(f, t) is a WSSUS process with an ACF
Rmodel(f, t) = E

HN(f1 + f, t1 + t)H ∗
N(f1, t1)

and a scattering function given by
Smodel(τ, ν) =
 ∞
−∞
df
 ∞
−∞
dt ej2πf τe−j2πνtRmodel(f, t).
The inverse relation is
Rmodel(f, t) =
 ∞
−∞
dτ
 ∞
−∞
dν e−j2πf τej2πνtSmodel(τ, ν).
Comparing this equation with the statement
Rmodel(f, t) =
 ∞
−∞
dτ
 ∞
−∞
dν e−j2πf τej2πνtp(τ, ν)
of the theorem, we ﬁnd that
Smodel(τ, ν) = p(τ, ν).
We thus have found that for the model channel, the scattering function can be interpreted
as a probability density function of the delays and Doppler frequencies.
We add the following remarks:
• The statement of the theorem and the interpretation is true for any N, even for N = 1.
However, the model is a reasonable approximation only if N is sufﬁciently large.
• For ﬁnite values of N, the model process is not ergodic.
• The model process is Gaussian only in the limit N →∞. Thus, it only approximates
the GWSSUS process, and it does so in a similar manner, as the GWSSUS process
is only a model of the physical reality.

MOBILE RADIO CHANNELS
71
• For bit error simulations, it is not necessary to choose N extremely large. For small
amplitudes, only a moderately large number of superposed random variables already
approximates a Gaussian distribution quite well. Bit errors in a Rayleigh fading
channel occur mainly during deep fades, that is, at small channel amplitudes. For
many practical simulations, N = 100 has proven to be a good choice.
Channel simulations will be done in the time domain. The fading channel model is then
given by the receive signal
r(t) =
1
√
N
N

k=1
eiθk ei2πνkt s(t −τk) + n(t),
(2.24)
where s(t) is the transmit signal and n(t) is AWGN. The random variables νk and τk will
be generated by a random number generator matched to the scattering function. Approxi-
mations are allowed. As discussed above, the exact structure of the scattering function is
not important, and it can be expected that the model is quite good if the second moments
agree.
An additional direct component to simulate Ricean fading can easily be included into
the model by writing
r(t) =
K
1 + K · s(t) +
1
1 + K
1
√
N
N

k=1
eiθk ei2πνkt s(t −τk) + n(t)
(2.25)
for a direct component with Doppler shift zero. K is the Rice factor.
The tapped delay line model
Another kind of model, which is widely used for simulations of mobile communication
systems, is called the tapped delay line model. This model may be interpreted as a superpo-
sition of a certain number M of discrete fading paths (taps) corresponding to propagation
delay values τm, m = 1, 2, . . . , M. To ﬁx such a model, the Doppler spectrum of each tap,
the delay values (relative to the ﬁrst tap) and the corresponding mean relative amplitudes
or power values of each tap have to be speciﬁed. The channel according to such a model
may be generated using Equation (2.23) by inserting the ﬁxed delay values τm of the taps
instead of choosing random delay values. The number of summands corresponding to one
tap has to be selected proportional to the relative amplitude of that tap.
Some important tapped delay line models used for Global System for Mobile Com-
munication (GSM) and Universal Mobile Telecommunication System (UMTS) simulations
are illustrated in Figure 2.10: the GSM models for a typical urban (TU) and a hilly ter-
rain (HT) as well as the International Telecommunication Union (ITU) channel models for
the so-called vehicular (V) and indoor-to-outdoor-pedestrian (IOP) environment. For each
environment, two channel models have been speciﬁed by the ITU (see e.g. (ETSI TR 101
112 1998)) – one with a low delay spread (channel A) and one with a higher delay spread
(channel B). For the evaluation of the system proposals of UMTS, mainly the low delay
spread models (channel A) have been used.

72
MOBILE RADIO CHANNELS
ITU IOP-A, ∆t = 0.063 µs
ITU IOP-B, ∆t = 0.40 µs
GSM HT, ∆t = 4 µs
0
5
10
15
20
25
t [µs]
GSM TU, ∆t = 1.1 µs
0
1
2
3
4
5
t [µs]
ITU V-A, ∆t = 0.37 µs
0
1
2
3
4
5
1
2
3
4
5
t [µs]
0
1
2
3
4
5
t [µs]
0
t [µs]
ITU V-B, ∆t = 4 µs
0
5
10
15
20
25
t [µs]
0
−5
−10
−15
−20
−25
Relative average power [dB]
0
−5
−10
−15
−20
−25
Relative average power [dB]
0
−5
−10
−15
−20
−25
Relative average power [dB]
0
−5
−10
−15
−20
−25
Relative average power [dB]
0
−5
−10
−15
−20
−25
Relative average power [dB]
0
−5
−10
−15
−20
−25
Relative average power [dB]
Figure 2.10 Tapped delay line models for GSM, UMTS simulations.
2.4
Digital Transmission over Fading Channels
2.4.1
The MLSE receiver for frequency nonselective and slowly
fading channels
Consider a time variant, but frequency nonselective fading channel as discussed in Sub-
section 2.2.1 with a complex baseband receive signal given by
r(t) = c(t)s(t) + n(t),
where c(t) is the complex fading amplitude of the channel, n(t) is complex baseband
AWGN and the transmit signal s(t) is given by
s(t) =
K

k=1
skgk(t)
with an orthonormal transmit base gk(t) and transmit symbols sk. The assumption that the
fading is frequency nonselective – resulting only in a multiplicative fading amplitude – is
justiﬁed if the symbol duration TS is much longer than the delay spread τ of the channel.
The fading channel transforms the transmit base to a new base with pulses given by hk(t) =

MOBILE RADIO CHANNELS
73
c(t)gk(t) that must be taken as detector pulses at the receiver. In general, these pulses are
not orthogonal and the treatment becomes more involved. However, it can be simpliﬁed for
the important special case that the fading amplitude varies slowly compared to the duration
of the pulse gk(t) (which is typically of the order TS) and can thus be treated as a constant ck
for the transmission of sk. This means that the pulse gk(t) is concentrated in time compared
to the variation of the channel so that the approximation hk(t) = c(t)gk(t) ≈ckgk(t) can
be made and
 ∞
−∞
g∗
i (t)c(t)gk(t) dt ≈
 ∞
−∞
g∗
i (t)ckgk(t) dt = ckδik
holds. Because the channel only changes the transmit base vectors by a multiplicative factor,
the outputs rk of the detectors for the base gk(t) are a set of sufﬁcient statistics and the
treatment is similar to the one described in Section 1.4 with sk replaced by cksk, resulting
in discrete-time channel model with receive symbols given by
rk = cksk + nk, k = 1, . . . , K.
(2.26)
We can write this in vector notation as
r = Cs + n,
(2.27)
where C = diag(c1, . . . , cK) is the diagonal matrix of the complex fading amplitudes.
We note that the discrete channel model also applies to frequency selective channels
as long as the channel is frequency-ﬂat for one transmission pulse. Such a situation may
occur if the transmit pulses gk(t) are located at different frequencies, for example, for
multicarrier transmission (OFDM), frequency hopping or frequency diversity, when the
same information is repeated at another frequency. Let Gk(f ) be the Fourier transform of
gk(t). The fading channel transforms the transmit base to a new base with pulses given by
hk(t) =
 ∞
−∞
ej2πf tH(f, t)Gk(f ) df
that have to be taken as detector pulses at the receiver. We ﬁrst assume that Gk(f ) is con-
centrated at the frequency fk so that H(f, t) can be replaced by H(fk, t) under the integral.
Then, we can write hk(t) ≈H(fk, t)gk(t). We then assume that gk(t) is concentrated at
the frequency tk so that H(fk, t) ≈H(fk, tk) during the pulse duration. We can then write
hk(t) ≈ckgk(t)
with ck = H(fk, tk).
Given a receive vector r, we now ask for the maximum likelihood transmit vector ˆs. If
we assume that the complex fading amplitudes are known at the receiver, we can apply the
analysis of Subsection 1.4.2, only replacing the vector s by Cs. Modifying Equation (1.77)
in this way, we obtain the most likely transmit vector ˆs as
ˆs = arg min
s
∥r −Cs∥2 ,
(2.28)
where
∥r −Cs∥2 =
K

k=1
|ck|2 )))c−1
k rk −sk
)))
2
.
(2.29)

74
MOBILE RADIO CHANNELS
This equation allows an interesting interpretation of the optimum receiver. First, the receive
symbols rk are multiplied by the inverse of the complex channel coefﬁcient ck = akejϕk.
This means that, by multiplying with c−1
k , the channel phase shift ϕk is back rotated, and
the receive symbol is divided by the channel amplitude ak to adjust the symbols to their
original size. We may regard this as an equalizer. Each properly equalized receive symbol
will be compared with the possible transmit symbol sk by means of the squared Euclidean
distance. These individual decision variables for each index k must be summed up with
weighting factors given by |ck|2, the squared channel amplitude. Without these weighting
factors, the receiver would inﬂate the noise for the very unreliable receive symbols. If a
deep fade occurs at the index k, the channel transmit power |ck|2 may be much less than
the power of the noise. The receive symbol rk is nearly absolutely unreliable and provides
us with nearly no useful information about the most likely transmit vector ˆs. It would thus
be much better to ignore that very noisy receive symbol instead of amplifying it and using
it like the more reliable ones. The factor |ck|2 just takes care of the weighting with the
individual reliabilities.
As in Subsection 1.4.2, we may use another form of the maximum likelihood condition.
Replacing the vector s by Cs in Equation (1.78), we obtain
ˆs = arg max
s

ℜ

s†C†r

−1
2 ∥Cs∥2

.
(2.30)
There is one difference to the AWGN case: in the ﬁrst term, before cross-correlating with
all possible transmit vectors s, the receive vector r will ﬁrst be processed by multiplication
with the matrix C†. This operation performs a back rotation of the channel phase shift ϕk
for each receive symbol rk and a weighting with the channel amplitude ak. The resulting
vector
C†r =


c∗
1r1
...
c∗
KrK

.
must be cross-correlated with all possible transmit vectors. The second term takes the
different energies of the transmit vectors Cs into account, including the multiplicative
fading channel. If all transmit symbols sk have the same constant energy ES = |sk|2 as it
is the case for PSK signaling,
∥Cs∥2 =
K

k=1
|ck|2 |sk|2 = ES
K

k=1
|ck|2
is the same for all transmit vectors s and can therefore be ignored for the decision.
2.4.2
Real-valued discrete-time fading channels
Even though complex notation is a common and familiar tool in communication theory,
there are some items where it is more convenient to work with real-valued quantities.
If Euclidean distances between vectors have to be considered – as it is the case in the
derivation of estimators and in the evaluation of error probabilities – things often become
simpler if one recalls that a K-dimensional complex vector space has equivalent distances

MOBILE RADIO CHANNELS
75
as a 2K-dimensional real vector space. We have already made use of this fact in Subsection
1.4.3, where pairwise error probabilities for the AWGN channel were derived. For a discrete
fading channel, things become slightly more involved because of the multiplication of the
complex transmit symbols sk by the complex fading coefﬁcients ck. In the corresponding
two-dimensional real vector space, this corresponds to a multiplication by a rotation matrix
together with an attenuation factor. Surely, one prefers the simpler complex multiplication
by ck = akejϕk, where ak and ϕk are the amplitude and the phase of the channel coefﬁcient.
At the receiver, the phase will be back rotated by means of a complex multiplication with
ejϕk corresponding to multiplication by the inverse rotation matrix in the real vector space.
Obviously, no information is lost by this back rotation, and we still have a set of sufﬁcient
statistics. We may thus work with a discrete channel model that includes the back rotation
and where the fading channel is described by a multiplicative real fading amplitude.
To proceed as described above, we rewrite Equation (2.27) as
r = Cs + nc.
Here C is the diagonal matrix of complex fading amplitudes ck = akejϕk and nc is complex
AWGN. We may write
C = DA
with
A = diag(a1, . . . , aK)
is the diagonal matrix of real fading amplitudes and
D = diag(ejϕ1, . . . , ejϕK)
is the diagonal matrix of phase rotations. We note that D is a unitary matrix, that is,
D−1 = D†. The discrete channel can be written as
r = DAs + nc.
We apply the back rotation of the phase and get
D†r = As + nc.
Note that a phase rotation does not change the statistical properties of the Gaussian white
noise, so that we can write nc instead of D†nc. We now decompose the complex vectors
into their real and imaginary parts as
s = x1 + jx2,
D†r = y1 + jy2
and
nc = n1 + jn2.
Then the complex discrete channel can be written as two real channels in K dimensions
given by
y1 = Ax1 + n1

76
MOBILE RADIO CHANNELS
and
y2 = Ax2 + n2
corresponding to the inphase and the quadrature component, respectively. Depending on
the situation, one may consider each K-dimensional component separately, as in the case
of square QAM constellations and then drop the index. Or one may multiplex both together
to a 2K-dimensional vector, as in the case of PSK constellations. One must keep in mind
that each multiplicative fading amplitude occurs twice because of the two components. In
any case, we may write
y = Ax + n
(2.31)
for the channel with an appropriately redeﬁned matrix A. We ﬁnally mention that Equation
(2.30) has its equivalent in this real model as
ˆx = arg max
x

x · Ay −1
2 ∥As∥2

.
2.4.3
Pairwise error probabilities for fading channels
In this subsection, we consider the case that the fading amplitude is even constant during
the whole transmission of a complete transmit vector, that is, the channel of Equation (2.31)
reduces to
y = ax + n
with a constant real fading amplitude a. A special case is, of course, a symbol by symbol
transmission where only one symbol is be considered. If that symbol is real, the vector x
reduces to a scalar. If the symbol is complex, x is a two-dimensional vector.
Let the amplitude a be a random variable with pdf p(a). For a ﬁxed amplitude value a,
we can apply the results of Subsection 1.4.3 with x replaced by ax. Then Equation (1.83)
leads to the conditioned pairwise error probability
P (x →ˆx|a) = Q
ad
σ

= 1
2erfc


$
a2
4N0
∥x −ˆx∥2


with σ 2 = N0/2 and
d = 1
2 ∥x −ˆx∥.
The overall pairwise error probability
P (x →ˆx) =
 ∞
0
P (x →ˆx|a)p(a) da
is obtained by averaging over the fading amplitude a.
We ﬁrst consider the Rayleigh fading channel and insert the integral expression for
Q(x) to obtain
P (x →ˆx) =
 ∞
0
da 2ae−a2
1

2πσ 2/d2
 ∞
a
dte−d2t2
2σ2 .

MOBILE RADIO CHANNELS
77
We change the order of integration resulting in
P (x →ˆx) =
1

2πσ 2/d2
 ∞
0
dt e−d2t2
2σ2
 t
0
da 2ae−a2.
The second integral is 1 −e−t2 so that
P (x →ˆx) =
1

2πσ 2/d2
 ∞
0

e−d2t2
2σ2 −e−d2+2σ2
2σ2
t2
dt,
which can be solved resulting in
P (x →ˆx) = 1
2

1 −
$
d2/2σ 2
1 + d2/2σ 2


or
P (x →ˆx) = 1
2

1 −
0
1
1
2
1
4N0 ∥x −ˆx∥2
1 +
1
4N0 ∥x −ˆx∥2

.
For BPSK and QPSK transmission, each bit error corresponds to an error for one real
symbol x, that is, Pb = P (x →ˆx) with ˆx = −x and
1
4N0
∥x −ˆx∥2 = Eb
N0
holds. Thus,
Pb = 1
2

1 −
0
1
1
2
Eb
N0
1 + Eb
N0

.
To discuss the asymptotic behavior for large Eb/N0 of this expression, we observe that
√
1 + x ≈1 + x/2 for small values of x = N0/Eb and ﬁnd the approximation
Pb ≈1
2
1
1 + 2 Eb
N0
≈

4Eb
N0
−1
for large SNRs. For other modulation schemes than BPSK or QPSK,
P (x →ˆx) ≈1
2
1
1 +
1
2N0 ∥x −ˆx∥2 ≈
 1
N0
∥x −ˆx∥2
−1
holds. There is always the proportionality
1
4N0
∥x −ˆx∥2 ∝SNR ∝Eb
N0
.
As a consequence, the error probabilities always decrease asymptotically as SNR−1 or
(Eb/N0)−1.

78
MOBILE RADIO CHANNELS
2.4.4
Diversity for fading channels
In a Rayleigh fading channel, the error probabilities Perror decrease asymptotically as slow
as Perror ∝SNR−1. To lower Perror by a factor of 10, the signal power must be increased
by a factor of 10. This is related to the fact that, for an average receive signal power γm,
the probability P

A2 < γ

that the signal power A2 falls below a value γ is given by
P

A2 < γ

= 1 −e−γ
γm
which decreases as
P

A2 < γ

≈γ
γm
∝SNR−1
for high SNRs.
The errors occur during the deep fades, and thus the error probability is proportional to
the probability of deep fades. A simple remedy against this is twofold (or L-fold) diversity
reception: if two (or L) replicas of the same information reach the transmitter via two
(or L) channels with statistically independent fading amplitudes, the probability that the
whole received information is affected by a deep fade will be (asymptotically) decrease as
SNR−2 (or SNR−L). The same power law will then be expected for the probability of error.
L is referred to as the diversity degree or the number of diversity branches. The following
diversity techniques are commonly used:
• Receive antenna diversity can be implemented by using two (or L) receive antennas
that are sufﬁciently separated in space. To guarantee statistical independence, the
antenna separation x should be much larger than the wavelength λ. For a mobile
receiver, x ≈λ/2 is often regarded as sufﬁcient (without guarantee). For the base
station receiver, this is certainly not sufﬁcient.
• Transmit antenna diversity techniques were developed only a few years ago. Since
then, these methods have evolved in a widespread area of research. We will discuss
the basic concept later in a separate subsection.
• Time diversity reception can be implemented by transmitting the same information
at two (or L) sufﬁciently separated time slots. To guarantee statistical independence,
the time difference t should be much larger than the correlation time tcorr = ν−1
max.
• Frequency diversity reception can be implemented by transmitting the same in-
formation at two (or L) sufﬁciently separated frequencies. To guarantee statistical
independence, the frequency separation f should be much larger than fcorr = τ −1,
that is, the correlation frequency (coherency bandwidth) of the channel.
It is obvious that L-fold time or frequency diversity increases the bandwidth requirement
for a given data rate by a factor of L. Antenna diversity does not increase the required
bandwidth, but increases the hardware expense. Furthermore, it increases the required space,
which is a critical item for mobile reception.
The replicas of the information that have been received via several and (hopefully)
statistical independent fading channels can be combined by different methods:
• Selection diversity combining simply takes the strongest of the L signals and ignores
the rest. This method is quite crude, but it is easy to implement. It needs a selector,
but only one receiver is required.

MOBILE RADIO CHANNELS
79
• Equal gain combining (EGC) needs L receivers. The receiver outputs are summed
as they are (i.e. with equal gain), thereby ignoring the different reliabilities of the L
signals.
• Maximum ratio combining (MRC) also needs L receivers. But in contrast to EGC,
the receiver outputs are properly weighted by the fading amplitudes, which must be
known at the receiver. The MRC is just a special case of the maximum likelihood
receiver that has been derived in Subsection 2.4.1. The name maximum ratio stems
from the fact that the maximum likelihood condition always minimizes the noise
(i.e. maximizes the signal-to-noise ratio) (see Problem 3).
Let Eb be the total energy per data bit available at the receiver and let ES = E{|si|2} be
the average energy per complex transmit symbol si. We assume M-ary modulation, so each
symbol carries log2(M) data bits. We normalize the average power gain of the channel to
one, that is, E

A2
= 1. Thus, for L-fold diversity, the energy ES is available L times at the
receiver. Therefore, the total energy per data bit Eb and the symbol energy are related by
LES = log2(M)Eb.
(2.32)
As discussed in Section 1.5, for linear modulations schemes SNR = ES/N0 holds, that is,
SNR = log2(M)
L
Eb
N0
.
(2.33)
Because the diversity degree L is a multiplicative factor between SNR and Eb/N0, it is very
important to distinguish between both quantities when speaking about diversity gain. A fair
comparison of the power efﬁciency must be based on how much energy per bit, Eb, is
necessary at the receiver to achieve a reliable reception. If the power has a ﬁxed value and
we transmit the same signal via L diversity branches, for example, L different frequencies,
each of them must reduce the power by a factor of L to be compared with a system without
diversity. This is also true for receive antenna diversity: L receive antennas have L times
the area of one antenna. But this is an antenna gain, not a diversity gain. We must therefore
compare, for example, a setup with L antenna dishes of 1 m2 with a setup with one dish of
L m2. We state that there is no diversity gain in an AWGN channel. Consider for example,
BPSK with transmit symbols xk = ±√ES. For L-fold diversity, there are only two possible
transmit sequences. The pairwise error probability then equals the bit error probability
Pb = P (x →ˆx) = 1
2erfc
#$
1
4N0
∥x −ˆx∥2
%
.
With x = −ˆx and ∥x∥2 = LES we obtain
Pb = 1
2erfc
√
L · SNR

for Pb as a function of the SNR but
Pb = 1
2erfc
#$
Eb
N0
%
for Pb as a function of Eb/N0. Thus, for time or frequency diversity, we have wasted
bandwidth by a factor of L without any gain in power efﬁciency.

80
MOBILE RADIO CHANNELS
2.4.5
The MRC receiver
We will now analyze the MRC receiver in some more detail. For L-fold diversity, L
replicas of the same information reach the transmitter via L statistically independent fading
amplitudes. In the simplest case, this information consists only of one complex PSK or
QAM symbol, but in general, it may be any sequence of symbols, for example, of chips in
the case of orthogonal modulation with Walsh vectors. The general case is already included
in the treatment of Subsection 2.4.1. Here we will discuss the special case of repeating only
one symbol in more detail.
Consider a single complex PSK or QAM symbol s ≡s1 and repeat it L times over
different channels. The diversity receive vector can be described by Equation (2.26) by
setting s1 = · · · = sL with K replaced by L. The maximum likelihood transmit symbol ˆs
is given by Equations (2.28) and (2.29), which simpliﬁes to
ˆs = arg min
s
L

i=1
|ci|2 )))c−1
i ri −s
)))
2
,
that is, the receive symbols ri are equalized, and next the squared Euclidean distances to
the transmit symbol are summed up with the weights given by the powers of the fading
amplitudes.
We may write Equation (2.27) in a simpler form as
r = sc + nc,
(2.34)
with the channel vector c given by
c = (c1, . . . , cL)T
and complex AWGN nc. The vector c deﬁnes a (complex) one-dimensional transmission
base, and sufﬁcient statistics is given by calculating the scalar product c†r at the receiver.
The complex number c†r is the output of the maximum ratio combiner, which, for each
receive symbol ri back rotates the phase ϕi, weights each with the individual channel
amplitude ai = |ci|, and forms the sum of all these L signals.
Here we note that EGC cannot be optimal because at the receiver, the scalar prod-
uct

e−jϕ1, . . . , e−jϕL
r is calculated, and this is not a set of sufﬁcient statistics because

ejϕ1, . . . , ejϕLT does not span the transmit space.
Minimizing the squared Euclidean distance yields
ˆs = arg min
s
∥r −sc∥2
or
ˆs = arg max
s

ℜ

s∗c†r

−1
2|s|2 ∥c∥2

,
(2.35)
which is a special case of Equation (2.30).
The block diagram for the MRC receiver is depicted in Figure 2.11. First, the combiner
calculates the quantity
v = c†r =
L

k=1
c∗
krk =
L

k=1
ake−jϕkrk,

MOBILE RADIO CHANNELS
81
Energy
term
3
. . .
. . .
. . .
. . .
. . .
+
−
−
+
c∗
1
r1
rL
c∗
L
max
arg
ℜ{s∗v}
v
for all s
Figure 2.11 Block diagram for the MRC diversity receiver.
that is, it back rotates the phase for each receive symbol rk and then sums them up (combines
them) with a weight given by the channel amplitude ak = |ck|. The ﬁrst term in Equation
(2.35) is the correlation between the MRC output v = c†r and the possible transmit symbols
s. For general signal constellations, second (energy) term in Equation (2.35) has to be
subtracted from the combiner output before the ﬁnal decision. For PSK signaling, it is
independent of s and can thus be ignored. For BPSK, the bit decision is given by the sign
of ℜ{v}. For QPSK, the two bit decisions are obtained from the signs of ℜ{v} and ℑ{v}.
For the theoretical analysis, it is convenient to consider the transmission channel in-
cluding the combiner. We deﬁne the composed real fading amplitude
a =
0
1
1
2
L

i=1
a2
i
and normalize the combiner output by
u = a−1c†r.
We multiply Equation (2.34) by a−1c† and obtain the one-dimensional scalar transmission
model
u = as + nc,
where nc = a−1c†nc can easily be proven to be one-dimensional discrete complex AWGN
with variance σ 2 = N0. A two-dimensional equivalent real-valued vector model
y = ax + n,
(2.36)
can be obtained by deﬁning real transmit and receive vectors
x =
 ℜ{s}
ℑ{s}

,
y =
 ℜ{u}
ℑ{u}

.
Here, n is two-dimensional real AWGN. Minimizing the squared Euclidean distance in the
real vector space yields
ˆx = arg min
s
∥y −ax∥2

82
MOBILE RADIO CHANNELS
or
ˆx = arg max
x

ay · x −1
2|a2 ∥x∥2

.
(2.37)
The ﬁrst term is the correlation (scalar product) of the combiner output ay and the trans-
mit symbol vector x, and the second is the energy term. For PSK signaling, this term is
independent of x and can thus be ignored. In that case, the maximum likelihood transmit
symbol vector x is the one with the smallest angle to the MRC output. For QPSK with
Gray mapping, the two dimensions of x are independently modulated, and thus the signs
of the components of y lead directly to bit decisions.
2.4.6
Error probabilities for fading channels with diversity
Consider again the frequency nonselective, slowly fading channel with the receive vector
r = Cs + n
as discussed in Subsection 2.4.1. Assume that the diagonal matrix of complex fading ampli-
tudes C = diag (c1, . . . , cK) is ﬁxed and known at the receiver. We ask for the conditional
pairwise error probability P (s →ˆs|C) that the receiver erroneously decides for ˆs instead
of s for that given channel. Since P (s →ˆs|C) = P (Cs →Cˆs), we can apply the results of
Subsection 1.4.3 by replacing s with Cs and ˆs with Cˆs and get
P (s →ˆs|C) = 1
2erfc
#$
1
4N0
∥Cs −Cˆs∥2
%
.
Let s = (s1, . . . , sK) and ˆs = (ˆs1, . . . , ˆsK) differ exactly in L ≤K positions. Without losing
generality we assume that these are the ﬁrst ones. This leads to the expression
P (s →ˆs|C) = 1
2erfc


0
1
1
2 1
4N0
L

i=1
|ci|2 |si −ˆsi|2

.
The pairwise error probability is the average EC {·} over all fading amplitudes, that is,
P (s →ˆs) = EC



1
2erfc


0
1
1
2 1
4N0
L

i=1
|ci|2 |si −ˆsi|2




.
(2.38)
For the following treatment, we use the polar representation
1
2erfc(x) = 1
π
 π/2
0
exp

−x2
sin2 θ

dθ
of the complementary error integral (see Subsection 1.4.3) and obtain the expression
P (s →ˆs) = 1
π
 π/2
0
EC
'
exp
#
−
1
4N0 sin2 θ
L

i=1
|ci|2 |si −ˆsi|2
%(
dθ.
(2.39)

MOBILE RADIO CHANNELS
83
This method proposed by Simon and Alouini (2000); Simon and Divsalar (1998) is very
ﬂexible because the expectation of the exponential is just the moment generating function
of the pdf of the power, which is usually known. The remaining ﬁnite integral over θ is
easy to calculate by simple numerical methods. Let us assume that the fading amplitudes
are statistically independent. Then the exponential factorizes as
EC
'
exp
#
−
1
4N0 sin2 θ
L

i=1
|ci|2 |si −ˆsi|2
%(
=
L
7
i=1
Eai
'
exp
#
−a2
i |si −ˆsi|2
4N0 sin2 θ
%(
,
where Eai {·} is the expectation over the fading amplitude ai = |ci|. We note that with this
expression, it will not cause additional problems if the L fading amplitudes have different
average powers or even have different types of probability distribution. If they are identically
distributed, the expression further simpliﬁes to
EC
'
exp
#
−
1
4N0 sin2 θ
L

i=1
|ci|2 |si −ˆsi|2
%(
=
L
7
i=1
Ea
'
exp
#
−
a22
i
N0 sin2 θ
%(
,
where i = 1
2 |si −ˆsi| and Ea {·} is the expectation over the fading amplitude a = ai. For
Rayleigh fading, the moment generating function of the squared amplitude can easily be
calculated as
Ea
.
e−xa2/
=
 ∞
0
2ae−a2e−xa2 da
resulting in
Ea
.
e−xa2/
=
1
1 + x .
With this expression, Equation (2.39) now simpliﬁes to
P (s →ˆs) = 1
π
 π/2
0
L
7
i=1
1
1 +
2
i
N0 sin2 θ
dθ.
(2.40)
We note that an upper bound can easily be obtained by upper bounding the integrand by
its maximum at θ = π/2, leading to
P (s →ˆs) ≤1
2
L
7
i=1
1
1 +
2
i
N0
.
(2.41)
Obviously, this quantity decreases asymptotically as SNR−L. We note that bounds of this
type – but without the factor 1/2 in front – are commonly obtained by Chernoff bound
techniques (Jamali and Le-Ngoc 1994). A method described by Viterbi (Viterbi 1995)
improved those bounds by a factor of two and yields (2.41).
A similar bound that is tighter for high SNRs but worse for low SNRs can be obtained
by using the inequality
1
1 +
1
sin2 θ
2
i
N0
≤sin2 θ
#
2
i
N0
%−1

84
MOBILE RADIO CHANNELS
to upper bound the integrand. The integral can then be solved resulting in the asymptotically
tight upper bound
P (s →ˆs) ≤1
2
1
4L
 2L
L
 L
7
i=1
N0
2
i
,
(2.42)
which again shows that the error probability decreases with the power L of the inverse
SNR for L-fold repetition diversity.
Consider BPSK as an example. Here, 2
i = ES for all values of i and, by Equation
(2.32) with M = 2,
ES = 1
LEb
holds. Thus, by Equation (2.40), the expression for the bit error rate Pb = P (s →ˆs) be-
comes
Pb = 1
π
 π/2
0


1
1 + 1
L
Eb
N0 sin2 θ


L
dθ
(2.43)
which may be upper bounded by
P (s →ˆs) ≤1
2
#
1
1 + 1
L
Eb
N0
%L
.
It is interesting to note that we can see from Equation (2.43) that in the limit that the
diversity degrees approach inﬁnity, we reach the performance of an AWGN channel. Using
the formula
lim
n→∞

1 + 1
nx
n
= ex
we obtain
lim
L→∞
1
π
 π/2
0


1
1 + 1
L
Eb
N0 sin2 θ


L
dθ = 1
π
 π/2
0
exp

−
Eb
N0 sin2 θ

dθ.
By the polar representation of the error integral, the r.h.s. equals
Pb = 1
2erfc
#$
Eb
N0
%
,
which is the BER for BPSK in the AWGN channel. Figure 2.12 shows these curves for
L = 1, 2, 4, 8, 16, 32, 64 compared to the AWGN limit.
For Ricean fading with Rice factor K, the characteristic function can be calculated as
well, resulting in the expression for the error probability
P (s →ˆs) = 1
π
 π/2
0
L
7
i=1
RK
#
2
i
N0 sin2 θ
%
dθ
(2.44)
with the abbreviation
RK (x) =
1 + K
1 + K + x exp

−
Kx
1 + K + x

(see (Benedetto and Biglieri 1999; Jamali and Le-Ngoc 1994)).

MOBILE RADIO CHANNELS
85
0
2
4
6
8
10
12
14
16
18
20
10–5
10–4
10–3
10–2
10–1
100
Eb/N0 [dB]
BER
AWGN limit
L = 1
L = 2
L =  4
L = 8 
L = 16
L = 32
L = 64
Figure 2.12
Error rates for BPSK with L-fold diversity for different values of L in a
Rayleigh fading channel.
Some alternative expressions for error probabilities with diversity reception
The above method that utilizes the polar representation of the complementary Gaussian
error integral is quite ﬂexible because the fading coefﬁcients may or may not have equal
power. We will see later that it is also suited very well to investigate error probabilities
for codes QAM. One drawback of this method is that it does not apply to differential
modulation.
For the sake of completeness, we will now present some formulas that are valid for
differential and coherent BPSK (M = 2) and QPSK (M = 4). These formulas can be found
in (Hagenauer 1982; Hagenauer et al. 1990; Proakis 2001). We deﬁne the SNR
γS = ES/N0 = log2(M)Eb/N0.
For coherent modulation, we deﬁne a parameter
ξ =




γs
1+γs :
M = 2

γs
2+γs :
M = 4
.
Note that
ξ =
$
Eb/N0
1 + Eb/N0

86
MOBILE RADIO CHANNELS
for both cases. For differential modulation, we deﬁne
ξ =



γsR1
1+γs :
M = 2
γsR1

2(1+γs)2−γ 2s R2
1
:
M = 4 ,
where
R1 = Rc(TS)
is the value of the time autocorrelation Rc(t) of the channel, taken at the symbol duration
t = TS. For the Jakes Doppler spectrum, we obtain from Equation (2.8)
Rc(TS) = J0 (2πνmaxTS) ,
which is obviously a function of the product νmaxTS. As discussed in Subsection 2.2.1, for
νmaxTS ≪1, we can approximate Rc(TS) by the second order of the Taylor series as
Rc(TS) ≈1 −(πνmaxTS)2 .
The bit error probabilities PL for L-fold diversity can then be expressed by either of the
three following equivalent expressions:
PL = 1
2
8
1 −ξ
L−1

k=0
 2k
k
 1 −ξ 2
4
k9
PL =
1 −ξ
2
L L−1

k=0
 L −1 + k
k
 1 + ξ
2
k
PL =
1 −ξ
2
2L−1 L−1

k=0
 2L −1
k
 1 + ξ
1 −ξ
k
We note that – as expected – these expressions are identical for coherent BPSK and QPSK
if they are written as functions of Eb/N0. DBPSK (differential BPSK) and DQPSK are
numerically very close together.
2.4.7
Transmit antenna diversity
In many wireless communications scenarios, the practical boundary conditions at the trans-
mitter and at the receiver are asymmetric. Consider as an example the situation of mobile
radio. The mobile unit must be as small as possible and it is practically not feasible to
apply receive antenna diversity and mount two antennas with a distance larger than half the
wavelength. At the base station site, this is obviously not a problem. Transmit antenna di-
versity is thus very desirable because multiple antennas at the base station can then be used
for the uplink and for the downlink as well. However, if one transmits signals from two
or more antennas via the same physical medium, the signals will interfere and the receiver
will be faced with the difﬁcult task of disentangling the information from the superposition
of signals. It is apparent that this cannot be done without loss in any case. Only a few years

MOBILE RADIO CHANNELS
87
ago, Alamouti (Alamouti 1998) found a quite simple setup for two antennas for which it
is possible to disentangle the information without loss. The scheme can even be proven
to be in some sense equivalent to a setup with two receive antennas. For the geometrical
interpretation of this fact and the situation for more than two antennas, we refer to the
discussion in (Schulze 2003a).
The Alamouti scheme
This scheme uses two transmit antennas to transmit a pair of two complex symbols (s1, s2)
during two time slots. We assume that for both antennas the channel can be described by
the discrete-time fading model with complex fading coefﬁcients c1 and c2, respectively. We
assume that the time variance of the channel is slow enough so that we can assume that
these coefﬁcients do not change from one time slot to the other.
The pair of complex transmit symbols (s1, s2) is then processed in the following way:
at time slot 1, the symbol s1 is transmitted from antenna 1 and s2 is transmitted from
antenna 2. The received signal (without noise) at time slot 1 is then given by c1s1 + c2s2.
At time slot 2, the symbol s∗
2 is transmitted from antenna 1 and −s∗
1 is transmitted from
antenna 2. The received signal at time slot 2 is then given by −c2s∗
1 + c1s∗
2. It is convenient
for the analysis to take the complex conjugate of the received symbol in the second time
slot before any other further processing at the receiver. We can therefore say that, at time
slot 2, s1 and s2 have been transmitted over channel branches with fading coefﬁcients −c∗
2
and c∗
1, respectively. The received symbols with additive white Gaussian noise at time slots
1 and 2 are given by
r1 = c1s1 + c2s2 + nc1
and
r2 = −c∗
2s1 + c∗
1s2 + nc2,
respectively, where nc1 and nc2 are the independent complex Gaussian noise components
with variance σ 2 = N0/2 in each real dimension. We can write this in vector notation as
r = Cs + nc
(2.45)
with the vectors s = (s1, s2)T , r = (r1, r2)T , n = (n1, n2)T and the channel matrix
C =

c1
c2
−c∗
2
c∗
1

.
(2.46)
We observe that the channel matrix has the property
C†C = CC† =
|c1|2 + |c2|2
I2,
(2.47)
where I2 is the 2 × 2 identity matrix. Equation (2.47) means that the channel matrix can
be written as
C =

|c1|2 + |c2|2 U,
where U is a unitary matrix, that is, a matrix with the property U†U = UU† = I2. Unitary
matrices (like orthogonal matrices for real vector spaces) are invertible matrices that leave

88
MOBILE RADIO CHANNELS
Euclidean distances invariant (see e.g. (Horn and Johnson 1985)). They can be visualized
as rotations (possibly combined with a reﬂection) in an Euclidean space. This means that
the transmission channel given by Equation (2.45) can be separated into three parts:
1. A rotation of the vector s in two complex (= four real) dimensions.
2. An attenuation by the composed fading amplitude

|c1|2 + |c2|2.
3. An AWGN channel.
Keeping in mind that multiplicative fading is just a phase rotation together with an at-
tenuation by a real fading amplitude, we can now interpret this transmission according to
Equation (2.45) with a matrix given by Equation (2.46) as a generalization of the familiar
multiplicative fading from one to two complex dimensions, or, if this is easier to visualize,
from two to four real dimensions. The two-dimensional rotation by the channel phase is
replaced by a four-dimensional rotation, and the (real-valued) channel fading amplitude has
to be replaced by the composed fading amplitude
a =

|c1|2 + |c2|2.
This geometrical view shows that the receiver must back rotate the receive signal r, and
then estimate the transmit vector s in the familiar way as known for the AWGN channel,
thereby taking into account the amplitude factor a.
For the formal derivation of the diversity combiner, we proceed as in Subsection 2.4.1.
The channel given by Equation (2.45) looks formally the same as the channel considered
there, only the matrix C has a different structure. The maximum likelihood transmit vector
ˆs is the one that minimizes the squared Euclidean distance, that is,
ˆs = arg min
s
∥r −Cs∥2 .
Equivalently, we may write
ˆs = arg max
s

ℜ

s†C†r

−1
2 ∥Cs∥2

.
Using Equation (2.47), we can evaluate the energy term and obtain the expression
ˆs = arg max
s

ℜ

s†C†r

−1
2
|c1|2 + |c2|2 ∥s∥2

.
We note that the energy term can be discarded if all signal vectors s have the same energy.
This is obviously the case if the (two-dimensional) symbols si have always equal energy
as for PSK signaling, but this is not necessary. It remains true if the symbol energy differs,
but all vectors of a four-dimensional signal constellation lie on a four-dimensional sphere.
The diversity combiner processes the receive vector r to the vector
C†r =
 c∗
1r1 −c2r2
c∗
2r1 + c1r2


MOBILE RADIO CHANNELS
89
and correlates it with all possible transmit vectors, thereby – if necessary – taking into
account their different energies. We note that for QPSK with Gray mapping, the signs of
the real and imaginary parts of C†r provide us directly with the bit decisions.
The strong formal similarity to two-antenna receive antenna diversity becomes evident
in the equivalent real-valued model. We multiply Equation (2.45) by the back-rotation
matrix U† = |c|−1C† and obtain
U†r = as + nc,
where we made use of the fact that U†nc has the same statistical properties as nc. We deﬁne
the four-dimensional real transmit and receive vectors
x =
 ℜ{s}
ℑ{s}

,
y =
 ℜ

U†r

ℑ

U†r


and obtain the real-valued time-discrete vector model
y = ax + n,
(2.48)
where n is four-dimensional real AWGN. This is formally the same as the real-valued model
for the MRC combiner given by Equation (2.36). The only difference is the extension from
two to four dimensions. As for the MRC combiner, minimizing the squared Euclidean
distance in the real vector space yields
ˆx = arg min
s
∥y −ax∥2
or
ˆx = arg max
x

ay · x −1
2|a2 ∥x∥2

.
The ﬁrst term is the correlation (scalar product) of the combiner output ay and the trans-
mit symbol vector x, and the second is the energy term. For PSK signaling, this term is
independent of x and can thus be ignored. In that case, the maximum likelihood transmit
symbol vector x is the one with the smallest angle to the MRC output. For QPSK with
Gray mapping, the two dimensions of x are independently modulated, and thus the signs
of the components of y lead directly to bit decisions.
The conditional pairwise error probability given a ﬁxed channel matrix C will be ob-
tained similar to that of conventional diversity discussed in Subsection 2.4.6 as
P (s →ˆs|C) = 1
2erfc
#$
1
4N0
∥Cs −Cˆs∥2
%
.
In Subsection 2.4.6, the matrix C is diagonal, but here it has the property given by Equations
(2.47). Thus the squared Euclidean distance can be simpliﬁed according to ∥Cs −Cˆs∥2 =
|c1|2 + |c2|2 ∥s −ˆs∥2 and we ﬁnd the expression for the pairwise error probability
P (s →ˆs) = EC



1
2erfc


$
∥s −ˆs∥2
4N0
|c1|2 + |c2|2




,
where EC means averaging over the channel. This equation is a special case of Equation
(2.38), and it can be analyzed using the same methods.

90
MOBILE RADIO CHANNELS
Now let Eb be the total energy per data bit available at the receiver and ES the energy
per complex transmit symbol s1 or s2. We assume M-ary modulation, so each of them carries
log2(M) data bits. Both symbols are assumed to be of equal (average) energy, which means
that ES = E{|s1|2} = E{|s2|2} = E{∥s∥2 /2}. We normalize the average power gain for each
antenna channel coefﬁcient to one, that is, E

|c1|2
= E

|c2|2
= 1. Then, for each time
slot, the total energy 2ES is transmitted at both antennas together and the same (average)
energy is available at each of the receive antenna. Therefore, the total energy available at
the receiving site for that time slot is
2ES = log2(M)Eb.
For only one transmit antenna, SNR = ES/N0 is the SNR at the receive antenna for linear
modulation. For two transmit antennas, we have SNR = 2ES/N0. For uncoded BPSK or
QPSK transmission, the value of each data bit affects only one real dimension. The event
of an erroneous bit decision corresponds to the squared Euclidean distance
∥s −ˆs∥2 = 4ES/ log2(M) = 2Eb,
which means that both BPSK (M = 2) and QPSK (M = 4) have the bit error probability
Pb = EC
'
1
2erfc
#$
Eb
2N0
|c1|2 + |c2|2
%(
as a function of Eb/N0. This is exactly the same as for twofold receive antenna diversity,
which is a special case of the results in Subsection 2.4.6 and we can apply the formulas
given there for independent Rayleigh or Ricean fading.
We note that Alamouti’s twofold transmit antenna diversity has the same performance
as the twofold receive antenna diversity only if we write Pb as a function of Eb/N0 because
SNR = log2 M · Eb/N0 holds for the ﬁrst case and SNR = 1
2 log2 M · Eb/N0 holds for the
latter.
2.5
Bibliographical Notes
The classical textbook about mobile radio channels is (Jakes 1975). However, fading chan-
nels are treated in many modern textbooks about digital communication techniques (see
e.g. (Benedetto and Biglieri 1999; Kammeyer 2004; Proakis 2001)). We also recommend
the introductory chapter of (Jamali and Le-Ngoc 1994).
The system theory of WSSUS processes goes back to the classical paper of (Bello
1963). The practical simulation method described in this chapter has been developed by
one of the authors (Schulze 1988) and has later been reﬁned and extended by Hoeher
(1992). We would like to point out that the line of thought for this model was mainly
inspired by the way physicists looked at statistical mechanics (see e.g. (Hill 1956; Lan-
dau and Lifshitz 1958)). All measurements are time averages, while the statistical theory
deals with statistical (so-called ensemble) averages. This replacement (the so-called ergodic
hypothesis) is mathematically nontrivial, but is usually heuristically justiﬁed. Systems in
statistical physics that are too complex to be studied analytically are often investigated by
the so-called Monte-Carlo Simulations. The initial conditions (locations and velocities) of

MOBILE RADIO CHANNELS
91
the particles (e.g. molecules) are generated as (pseudo) random variables by a computer,
and the dynamics of the system has to be calculated, for example, by the numerical solu-
tion of differential equations. From these solutions, time averages of physical quantities are
calculated. For a mobile radio system, we generate phases, Doppler shifts and delay (as
initial conditions of the system) and calculate the system dynamics from these quantities.
Finally, time averages, for example, for the bit error rate are calculated.
2.6
Problems
1. Let z(t) = x(t) + jy(t) be a stochastic process with the property
E {z(t + τ)z(t)} = 0.
Show the properties
E {x(t + τ)x(t)} = E {y(t + τ)y(t)}
and
E {x(t + τ)y(t)} = −E {y(t + τ)x(t)} .
2. Show that for the Jakes Doppler spectrum Sc(ν), the second moment is given by
µ2 {Sc(ν)} = ν2
max
2 .
3. An L-branch diversity channel is given by the receive signal vector
r = sc + n,
with the channel vector c given by
c = (c1, . . . , cL)T ,
where s is the transmit symbol and n is L-dimensional (not necessarily Gaussian)
complex white noise. A linear combiner is given by the operation u = v†r with
a given vector v. Show that the SNR for the combiner output is maximized for
v = c.


3
Channel Coding
3.1
General Principles
3.1.1
The concept of channel coding
Channel coding is a common strategy to make digital transmission more reliable, or, equiv-
alently, to achieve the same required reliability for a given data rate at a lower power level
at the receiver. This gain in power efﬁciency is called coding gain. For mobile communica-
tion systems, channel coding is often indispensable. As discussed in the preceding chapter,
the bit error rate in a Rayleigh fading channel decreases as Pb ∼(Eb/N0)−1, which would
require an unacceptable high transmit power to achieve a sufﬁciently low bit error rate. We
have seen that one possible solution is diversity. We will see in the following sections that
channel coding can achieve the same gain as diversity with less redundancy.
This chapter gives a brief but self-contained overview over the channel coding tech-
niques that are commonly applied in OFDM and CDMA systems. For a more detailed
discussion, we refer to standard text books cited in the Bibliographical Notes.
Figure 3.1 shows the classical channel coding setup for a digital transmission system.
The channel encoder adds redundancy to digital data bi from a data source. For simplicity,
we will often speak of data bits bi and channel encoder output bits ci, keeping in mind that
other data symbol alphabets than binary ones are possible and the same discussion applies
to that case. We brieﬂy review some basic concepts and deﬁnitions.
• The output of the encoder is called a code word. The set of all possible code words is
the code. The encoder itself is a mapping rule from the set of possible data words into
the code. We remark that a code (which is a set) may have many different encoders
(i.e. different mappings with that same set as the image).
• Block codes: If the channel encoder always takes a data block b = (b1, . . . , bK)T
of a certain length K and encodes it to a code word c = (c1, . . . , cN)T of a certain
length N, we speak of an (N, K) block code. For other codes than block codes,
for example, convolutional codes, it is often convenient to work with code words of
ﬁnite length, but it is not necessary, and the length is not determined by the code.
Theory and Applications of OFDM and CDMA
Henrik Schulze and Christian L¨uders
2005 John Wiley & Sons, Ltd

94
CHANNEL CODING






Channel
encoder
Channel
decoder
s(t)
r(t)
bi
ˆbi
ci
Demodu-
lator
Modulator
ˆci
Interface ??
Data
source
Data
sink
Transmit
channel
Figure 3.1 Block diagram for a digital transmission setup with channel coding.
• If the encoder maps b = (b1, . . . , bK)T to the code word c = (c1, . . . , cN)T , the ratio
Rc = K/N is called the code rate.
• If two code words differ in d positions, then d is called the Hamming distance between
the two code words. The minimum Hamming distance between any two code words
is called the Hamming distance of the code and is usually denoted by dH. For an
(N, K) block code, we write the triple (N, K, dH) to characterize the code.
• If the vector sum of any two code words is always a code word, the code is called
linear.
• The Hamming distance of a linear code equals the minimum number of nonzero
elements in a code word, which is called the weight of the code. A code can correct
up to t errors if 2t + 1 ≤dH holds.
• An encoder is called systematic if the data symbols are a subset of the code word. Ob-
viously, it is convenient but not necessary that these systematic (i.e. data) bits (or sym-
bols) are positioned at the beginning of the code word. In that case the encoder maps
b = (b1, . . . , bK)T to the code word c = (c1, . . . , cN)T and bi = ci for i = 1, . . . , K.
The nonsystematic symbols of the code word are called parity check (PC) symbols.
The channel decoder outputs ci are the inputs of the modulator. Depending on these data,
the modulator transmits one out of a set of possible signals s(t). For binary codes, there
are 2K code words and thus there are 2K possible signals s(t). For a linear modulation

CHANNEL CODING
95
scheme, such a signal can be written as
s(t) =
L

i=1
sigi(t)
with an orthonormal transmit base {gi(t)}L
i=1. Each possible signal can then uniquely be
characterized by the corresponding transmit symbol vector s = (s1, . . . , sL)T . Generally,
there is a one-to-one correspondence between the code word vectors c = (c1, . . . , cN)T
and the transmit symbol vector s = (s1, . . . , sL)T . Because each code word c is uniquely
determined by the corresponding data word b, the mapping b →c is uniquely deﬁned and
one may regard the channel encoder and the modulator as one single device that corresponds
to the mapping b →s. This natural, but modern concept is called coded modulation and it
has the advantage that it is quite natural to look for a joint optimization of channel coding
and modulation (see e.g. (Biglieri et al. 1991; Jamali and Le-Ngoc 1994; Ungerboeck
1982)).
The more traditional concept as depicted in Figure 3.1 keeps both parts separated, and
the modulator is one of the classical concatenation schemes discussed in Section 1.4. We
may have a simple M-ary PSK or QAM symbol mapping for the si. Then, a subset of
m = log2(M) bits of one code word will be mapped on each symbol si. Or, alternatively,
m = log2(M) bits taken from m different code words will be mapped on each symbol si.
The latter turns out to be a better choice for fading channels to avoid two bits of the same
code word being affected by the same fading amplitude. We note that for M-ary signal
constellations and a code rate Rc, only Rc log2(M) useful bits are transmitted per complex
symbol si. Thus, the energy Eb per useful bit is related to the average symbol energy
ES = E

|sk|2
by the equation
ES = Rc log2(M) · Eb.
(3.1)
Following Figure 3.1, the modulated signal is corrupted by the noisy transmission
channel. Thus, some of the demodulator output bits ˆci will be erroneously decided from the
received signal r(t). The channel decoder then uses the redundancy of the code to correct
the errors and delivers (hopefully) correct data ˆbi identical to the source data bi.
The crucial point of this traditional conception of correcting bit errors is the interface
between CoDec (Coder/Decoder) and the MoDem (Modulator/Demodulator). We have seen
that there is no fundamental reason to distinguish between these blocks at the transmitter.
And, as we know from the detection theory as discussed in Section 1.3, the MLSE will ﬁnd
the most probable transmit vector ˆs that corresponds uniquely to a data vector ˆb. The only
reason to separate demodulator and decoder is a practical one: often, especially for long
block codes, the MLSE requires quite an exhaustive search that cannot be implemented.
But there are often algebraic decoding techniques for such codes that require binary inputs1.
There may be good reasons to proceed this way but one should always keep in mind that
any hard bit decision before the decoder causes loss of information. For convolutional
codes, the MLSE can be easily implemented by the Viterbi decoder (see the following
text). Hard decisions would cause a needless loss of approximately 2 dB in performance
for convolutional codes.
The following example shows how the same transmission setup can be interpreted
according to different points of view.
1Or, for nonbinary codes, discrete valued inputs are taken from some other ﬁnite signal alphabet.

96
CHANNEL CODING
Example 6 (Walsh–Hadamard codes) Consider an encoder map b →c for a linear
(8, 3, 4) block code given by


0
1
0
1
0
1
0
1
0
0
1
1
0
0
1
1
0
0
0
0
1
1
1
1

→


0
0
0
0
0
0
0
0
0
1
0
1
0
1
0
1
0
0
1
1
0
0
1
1
0
1
1
0
0
1
1
0
0
0
0
0
1
1
1
1
0
1
0
1
1
0
1
0
0
0
1
1
1
1
0
0
0
1
1
0
1
0
0
1


,
where the eight possible data words b are the columns of the left matrix, and the corre-
sponding code words c are the columns of the right matrix. One can easily verify that this
code is linear (see Proposition 3.1.1) and that the Hamming distance is given by dH = 4.
Thus, it can correct one bit error. We now use a BPSK modulator with the symbol mapping
ci →si = (−1)ci. The composed mapping b →s is then given by


0
1
0
1
0
1
0
1
0
0
1
1
0
0
1
1
0
0
0
0
1
1
1
1

→


1
1
1
1
1
1
1
1
1
−1
1
−1
1
−1
1
−1
1
1
−1
−1
1
1
−1
−1
1
−1
−1
1
1
−1
−1
1
1
1
1
1
−1
−1
−1
−1
1
−1
1
−1
−1
1
−1
1
1
1
−1
−1
−1
−1
1
1
1
−1
−1
1
−1
1
1
−1


.
The resulting matrix is the Hadamard matrix for M = 8, and it is obvious that this scheme
is nothing but orthogonal Walsh modulation as discussed in Subsection 1.1.4. The columns
of the matrix just represent the signs of the Walsh functions of Figure 1.7. These codes cor-
responding to Hadamard matrices are called Walsh–Hadamard (WH) codes. The example
here is the WH(8, 3, 4) code.
We now consider as an example detector outputs given by the receive vector r =
(1.5, 1.2, 0.9, 0.4, 0.8,-0.2, 1.2, −0.3)T . The hard decision BPSK demodulator produces
the output ˆc = (0, 0, 0, 0, 0, 1, 0, 1)T . This vector differs in two positions from the
ﬁrst and in two positions from the second code word. Thus, (at least) two errors have
occurred that cannot be corrected. However, the MLSE for orthogonal Walsh modula-
tion calculates the eight scalar products r · s that are the elements of the row vector
(5.4, 3.2, 1.2, 1.2, −0.6, 2.6, 1.6, 0.2) and decides in favor of the ﬁrst vector of the
Hadamard matrix with the maximal scalar product r · s = 5.4.
This example shows that there is often an ambiguity in what we call channel coding
and what we call modulation. For example, we may regard any linear modulation scheme
as a code. The symbol mapper is an encoder that produces real or complex outputs. Here,
we prefer real symbols, that is, we identify the complex plane with the two-dimensional
(real) space. An M-PSK or M-QAM symbol is a code word of length N = 2 with M code
words labeled by K = log2 M data bit. This is a (N, K) block code. The alphabet of the

CHANNEL CODING
97
coded symbols is a ﬁnite set of real numbers. For 8-PSK, for example, this is given by
{0, ± 1
2
√
2, ±1}.
A code word is given by a vector
x = (x1, . . . , xN)T
of real-valued modulation symbols. To interpret the orthogonal Walsh modulation of Sub-
section 1.1.4 as channel coding, we set N = M, and the vectors x are the columns of the
M × M Hadamard matrix. The transmit signal is given by
s(t) =
M

m=1
xmgm(t).
Note that now the base pulses gm(t) of this linear modulation correspond to what has been
called chip pulses in that subsection.
As discussed in Subsection 2.4.1, we may consider the real-valued fading channel with
AWGN disturbance given by
yi = aixi + ni
with real-valued receive symbols yi, fading amplitudes ai, transmit symbols xi and noise
samples ni with variance σ 2 = N0/2 in each dimension. Using vector notation, we may
write
y = Ax + n.
The MLSE receiver calculates the most probable transmit vector x from the receive vector
y. Because the input of the MLSE, that is, the components yi of the receive vector, are
real numbers, the MLSE is called a soft decision receiver, in contrast to a hard decision
receiver, where (hard) bit decisions are taken from the yi and these bits are passed to the
decoder (see Figure 3.1). However, the output of the MLSE receiver is the bit sequence that
labels the most likely transmit vector. Thus, the MLSE is a hard output receiver. Receivers
with soft output (i.e. with reliability information about the decisions) are desirable for
concatenated coding schemes as described in Subsection 3.1.4. A receiver with soft inputs
and soft outputs is called a SISO(soft-in, soft-out) receiver.
3.1.2
Error probabilities
In this subsection, we discuss error rates for binary codes with antipodal signaling, that is,
BPSK. The same formulas apply for QPSK, which can be separated into antipodal signaling
for both the in-phase and quadrature component.
Error probabilities for the MLSE receiver and the AWGN channel
For the MLSE receiver, general expressions for the pairwise error probabilities in the
AWGN channel were derived in Subsection 1.4.3. The probability that the receiver erro-
neously decides for the transmit vector s instead of the transmitted vector ˆs is given by
Equation (1.84), that is, the expression
P (s →ˆs) = 1
2erfc
#$
1
4N0
∥s −ˆs∥2
%
.

98
CHANNEL CODING
For BPSK transmission, we have s = (s1, . . . , sL)T with si = ±√ES, where ES is the
symbol energy. We assume a binary code with rate Rc and Hamming distance dH. Assume
that s corresponds to a code word c and the receiver decides for a code word ˆc corresponding
to the signal vector ˆs, and the code words c and ˆc have the Hamming distance d. Then,
∥s −ˆs∥2 = 4dES.
For each transmitted symbol, only Rc useful bits are transmitted. Thus, ES = RcEb, and the
error event probability Pd for an erroneous decision corresponding to a Hamming distance
d is given by
Pd = 1
2erfc
#$
dRc
Eb
N0
%
.
(3.2)
For high values of Eb/N0, the total error probability is dominated by the most probable
error event corresponding to d = dH. Asymptotically, the number of such events (that leads
to a factor in front of the complementary error function) can be ignored and we may say
that we obtain an asymptotic coding gain of
Ga = 10 log10(dHRc) dB
compared to uncoded BPSK. We note that the expression (3.2) for Pd – written as a function
of Eb/N0 – also holds for QPSK with Gray mapping and the coding gain is also the
same. For higher level modulation schemes, the analysis is more complicated because the
Euclidean distances between the symbols are different.
Error probabilities for the MLSE receiver and the Rayleigh fading channel
We assume a discrete-time fading channel with receive symbols given by
ri = aisi + ni, i = 1, . . . , N
with discrete AWGN ni and real fading amplitudes ai, that is, the phase has already been
back rotated. We consider BPSK transmission with si = ±√ES and a binary code of rate
Rc and Hamming distance dH. Assume that s corresponds to a code word c of length N
and the receiver decides for a code word ˆc corresponding to the signal vector ˆs, and the
code words c and ˆc have the Hamming distance d. We ask for the probability Pd that the
code word c has been transmitted and the receiver erroneously decides for another code
word ˆc. To keep the notation simple, we assume a renumbering of the indices in such a
way that the different positions are those with i = 1, . . . , d and write s = (s1, . . . , sd)T
for the symbol vector corresponding to the ﬁrst d positions of c and ˆs = (ˆs1, . . . , ˆsd)T for
the symbol vector corresponding to the ﬁrst d positions of ˆc. The last N −d symbols are
irrelevant for the decision. This is just the same as the problem of d-fold diversity that was
treated in Subsection 2.4.6. We can apply Equation (2.38) with |si −ˆsi|2 = 4ES and obtain
the expression
Pd = Eai



1
2erfc


0
1
1
2ES
N0
d

i=1
|ai|2




,
(3.3)

CHANNEL CODING
99
where Eai {·} is the average over all fading amplitudes. For a Rayleigh channel with identi-
cally distributed and independent fading amplitudes of average power one, the average can
be easily performed as shown in Subsection 2.4.5 resulting in
Pd = 1
π
 π/2
0


1
1 + Rc
Eb
N0 sin2 θ


d
dθ,
(3.4)
where we have used ES = RcEb. As an alternative to this polar representation expression,
the formulas given at the end of Subsection 2.4.6 can be applied. We thus have seen that
the Hamming distance can be interpreted as diversity that is provided by the code. Using
Equation (2.42), Pd can be tightly upper bounded by
Pd ≤1
2
1
4L
 2d
d
 
Rc
Eb
N0
−d
.
Thus, for a code with Hamming distance dH, the error rates asymptotically decay as
SNR−dH in an independently fading Rayleigh channel. These expressions for Pd – written
as a function of Eb/N0 – also hold for QPSK if the two bits corresponding to a QPSK
symbol si belong to different code words. Otherwise, two bits of the same code word will
be affected by the same fading amplitude, which would result in a loss of diversity.
Residual bit error rates for hard decision decoding of block codes
We consider an (N, K, dH) binary block code with hard decision error correction capability
of t bit errors. For an odd Hamming distance dH, we have dH = 2t + 1, and for even dH,
we have dH = 2t + 2. Let p be the channel bit error probability and assume that i ≥t + 1
channel bit errors occurs inside the code word. The probability for a certain error pattern
with i bit errors is given by
pi(1 −p)N−i.
There are
N
i

such possible patterns for a code word of length N. Thus, the block error
probability, that is, the probability for a wrong decoding decision for the code word is
given by
PBlock =
N

i=t+1
N
i

pi(1 −p)N−i.
(3.5)
Often, one is interested not only in the block error probability, but in the bit error
probability. If the error correction capability is t, the decoder may change at most t bits
inside the code word when trying to correct the error. If i > t errors have occurred, this
will result in a wrong decision and the decoder will erroneously change at most t additional
bits, resulting in at most i + t errors. Thus, if we consider only error events corresponding
to exactly i errors (i > t), the bit error probability for such an event is bounded by
t + i
N
N
i

pi(1 −p)N−i.
Keeping in mind that not more than N errors may occur, the bound can be slightly improved
if we replace t + i in the numerator by min(t + i, N). Summing up over all possible

100
CHANNEL CODING
numbers of errors, we get the bound for the bit error probability
Pb ≤
N

i=t+1
min(t + i, N)
N
N
i

pi(1 −p)N−i.
(3.6)
Although it is more popular to talk about bit error probabilities rather than block error
probabilities, one should keep in mind that the block error probability is often more relevant
for an application than the bit error probability. For the application, the average time
between two error events is often the most relevant ﬁgure. In case of a decoding error, at
least dH bit errors occur at the same time. The error event corresponding to dH errors is
the most probable one, and it is dominant if the channel is not too bad. Looking only at
Pb without knowledge of the code may give rise to wrong interpretations. A residual bit
error rate of Pb = 10−6 for a rate of 10 kbit/s does not mean that in average one bit error
occurs every 100 seconds, but approximately dH errors occur every 100 dH seconds. For
large values of dH, this makes a great difference for the application.
3.1.3
Some simple linear binary block codes
In this subsection, we will present some facts about linear binary block codes and give
some examples. We will not go into further details and refer to the text books about
channel coding cited in the Bibliographical Notes.
Let C be a linear binary (N, K) block code. We write all the M = 2K code words of
length N as binary columns cm ∈C, m = 1, . . . , M and join them together to a matrix
C = [c1, . . . , cM].
There are M bit tuples of length K. We write them as column vectors bm, m = 1, . . . , M
with the LSB (Least Signiﬁcant Bit) in the upper position. We join them together to a
binary tuple matrix
B = [b1, . . . , bM].
For M = 8, for example, this matrix is given by
B =


0
1
0
1
0
1
0
1
0
0
1
1
0
0
1
1
0
0
0
0
1
1
1
1

.
We write B for the set of all these binary vectors. The encoder can then be written as a
linear mapping
G : B →C, bm →cm = Gbm
between the vector spaces B and C. G is called the generator matrix. Using matrix notation,
we may also write
C = GB.
From linear algebra we know that G is given by an N × K matrix, with K columns given
by the images of the K canonical base vectors, that is, those vectors in B with only one 1
and all other entries equal to 0. From the structure of B, we see that these are the vectors
cm with m = 2k + 1, k = 0, 1, . . . , K −1, that is,
G = [c2, c3, c5, c9, . . . , cM/2+1].

CHANNEL CODING
101
The dual code C⊥is just the orthogonal complement of C in the N-dimensional vector
space over the binary numbers. Its (N −K) × N generator matrix H is related to G by
HT G = 0.
Because HT c = 0 for each c ∈C, H is called the parity check matrix of the code C.
Repetition (RP) codes
A very naive idea for coding is a simple repetition of the bits. An RP(N, 1, N) code has
dH = N and Rc = 1/N and, thus, the coding gain is zero. Obviously, RP coding is just
another word for diversity, and, in a fading channel, it has a diversity gain if the fading
amplitudes of the received coded symbols are sufﬁciently independent. The generator matrix
of this code is the all-one column vector of length N.
Single parity check (SPC) codes
The matrix of code words C for the SPC(K + 1, K, 2) code is obtained from the binary
tuple matrix B by appending one row in such a way that the (modulo 2) sum over each
column equals zero, that is, all code words must have even parity. For the SPC(4, 3, 2)
code, for example, we have
C =


0
1
0
1
0
1
0
1
0
0
1
1
0
0
1
1
0
0
0
0
1
1
1
1
0
1
1
0
1
0
0
1


and
G =


1
0
0
0
1
0
0
0
1
1
1
1

.
An SPC(K + 1, K, 2) code has Hamming distance dH = 2 and rate Rc = K/(K + 1). The
most popular application for SPC (single parity check) codes is error detection by checking
the parity. Obviously, the detection is not very reliable because only one error can be
detected, not two. It is generally believed that SPC codes can only detect errors, but cannot
correct them. This is only the case for hard decision. When using an MLSE receiver, SPC
codes have an asymptotic coding gain of
Ga = 10 log10
2K
K + 1 dB,
which approximately approaches a 3 dB gain for high values of N.
Walsh–Hadamard (WH) codes
As already discussed in the example in the last subsection, Walsh–Hadamard codes will be
obtained from the Hadamard matrices by replacing each +1 by a 0 and −1 by a 1. The code
words of the WH(M, log2 M, M/2) code of length M = 2K and Hamming distance M/2

102
CHANNEL CODING
are the columns of the resulting M × M matrix. Transmitting these code words with BPSK
modulation brings us back to orthogonal signaling with Walsh functions. The asymptotic
coding gain
Ga = 10 log10
K
2 dB
has already been obtained in Subsection 1.4.3, where the pairwise error probabilities of
orthogonal modulation has been derived.
Proposition 3.1.1 The WH codes are linear codes.
Proof. The proof is by induction over K, where M = 2K. The statement is trivially
true for K = 0, that is, M = 1. We will show that if it is true for any M/2, it is true
for M. Let C = [c1, . . . , cM] be the M × M matrix obtained from the M × M Hadamard
matrix as described above. The column vectors are the code words. Then, by construction
of the Hadamard matrices, the code words cm are exactly those vectors that have either the
structure
cm =
 c′
c′

for m ∈{1, . . . , M/2}
or
cm =

c′
c′ ⊕1

for m ∈{M/2 + 1, . . . , M},
where c′ is a code word of the WH(M/2, log2 M −1, M/4) code, which, by assumption,
has already been proven to be a linear code. From the above decomposition it can easily
be seen that the sum of any such vectors has again this structure and thus is a code word
of WH(M, log2 M, M/2).
From the recursive construction of the Hadamard matrices, we observe that the column
cM/2+1 equals the last row of B (the MSB (Most Signiﬁcant Bit) row), the column cM/4+1
equals the second last row of B, and so on. Thus, we ﬁnd that for the WH code, the
interesting property
G = BT
holds, and the matrix of code words is given by
C = BT B.
Since B has the canonical base as column numbers m = 2k + 1, k = 0, 1, . . . , K −1, the
generator matrix G provides a systematic encoder with the systematic bit number k + 1 at
the position m = 2k + 1, k = 0, 1, . . . , K −1 in the code word. For M = 8, for example,
the three systematic bit can be found in the positions 2, 3 and 5 of the code word.
Simplex (SPL) codes
An SPL(M −1, log2 M, M/2) is obtained by omitting the ﬁrst bit of every WH
(M, log2 M, M/2) code word. This can be done without any loss in performance because
this bit is always zero. Because of the higher code rate, the performance is even better,

CHANNEL CODING
103
especially for small values of M. For M = 8, the matrix of code words is given by
C =


0
1
0
1
0
1
0
1
0
0
1
1
0
0
1
1
0
1
1
0
0
1
1
0
0
0
0
0
1
1
1
1
0
1
0
1
1
0
1
0
0
0
1
1
1
1
0
0
0
1
1
0
1
0
0
1


,
and the generator matrix is
G =


1
0
0
0
1
0
1
1
0
0
0
1
1
0
1
0
1
1
1
1
1


.
Hamming codes
Hamming codes are the dual codes of simplex codes. A (2K −1, 2K −1 −K, 3) Hamming
code can correct one error. Hamming codes are simple and weak codes, but they are popular
to explain the concepts of algebraic coding. We do not discuss them further because they
are exhaustively treated in most text books.
3.1.4
Concatenated coding
If an application requires very low bit error rates, concatenated coding is often the most
efﬁcient method to reach this goal. In such a setup, two codes are combined to a stronger
overall concatenated code (see Figure 3.2). At the transmitter, the source data will ﬁrst
be encoded by the outer code. The code words of this code will then serve as the input
data for the inner code2. Between the two encoders, the order of the symbols inside the
stream of code words may be changed by a device that is called interleaver. Interleaver
structures will be discussed later in Subsection 4.4.2. The code words of the inner code
are transmitted over the channel and then decoded by the inner decoder. The inner decoder
has to be matched to the channel. At its output, the error rate will be low, but the errors
are not uniformly distributed. The inner decoder will typically produce error bursts, that
is, connected sequences of unreliable symbols between long sequences of reliable symbols.
For block codes, a burst error corresponds to an erroneously decided code word. For
convolutional codes, an error burst corresponds to the sequence of states in the trellis,
where the correct path and the maximum likelihood path are different (see Subsection
3.2.2). The deinterleaver inverts the interleaver. The interleaving scheme breaks up the
error bursts and has to be matched to the error correction capabilities of the outer code, that
is, to its Hamming distance and code word length. For a properly designed concatenated
coding scheme, the output of the outer decoder will be nearly error free. Thus, one can
2The naming inner and outer code stems from the fact that the inner code is closer to the channel than the
outer code.

104
CHANNEL CODING








Outer
encoder
encoder
Inner
Inter
leaver
Channel
Inner
decoder
Outer
Deinter-
leaver
decoder
Figure 3.2 Block diagram for a concatenated coding setup.
visualize the inner decoder as a device that is suited for coarsely cleaning up the errors that
are produced by a severely corrupted transmission channel. The outer decoder will then
clean up the residual errors left by the outer decoder.
We note that in some cases the inner decoder may pass soft decision values rather
than hard decision bits to the outer decoder. This is, for example, an important item for a
concatenated coding scheme with two convolutional codes. Turbo codes are a setup of two
parallel concatenated codes (see Subsection 3.2.5). The classical concatenation described
above is sometimes called serial concatenation to distinguish from such setups. For serially
concatenated convolutional codes, we refer to (Benedetto and Biglieri 1999).
If we regard QAM or PSK modulation as (nonbinary) coding schemes (see the discus-
sion at the end of Subsection 3.1.1), QAM or PSK with additional (convolutional) coding
is a concatenated coding scheme. The outer QAM or PSK decoder will typically pass soft
bits to the outer (convolutional) decoder. The optimal soft bits are the LLRs (log-likelihood
ratios) calculated by the MAP receiver (see Subsection 3.1.5).
Probably the most popular concatenated coding scheme is an inner convolutional code
with an outer Reed–Solomon (RS) code. Both types of codes are discussed in the following
sections. Convolutional codes with soft decision decoding are well suited for channels that
are severely corrupted by a high noise level and/or by multipath fading. MLSE can be
easily implemented by the Viterbi decoder. However, because of their typically quite low
Hamming distance, the BER curves show a poor decay. Thus, a high SNR is needed if very
low BERs are required. The convolutional decoder produces bursts of erroneously decided
bits. RS codes can be designed as strong codes with high Hamming distances. They are
based on byte arithmetics rather than bit arithmetics, that is, they correct byte errors rather
than bit errors. The decoder works with hard decision input bytes. The favorable input for
the decoder is a data stream with bit errors that are grouped together into bytes, but the
byte error structure should not be bursty. Thus, a convolutional decoder together with a
byte interleaving produces the favorite input for the RS decoder.
Deep space communication was one of the ﬁrst applications of such a scheme with
a convolutional code and an RS code (see (McEliece and Swanson 2001)). Because of
the power limitation, the physical channel is a very noisy AWGN channel that makes

CHANNEL CODING
105
convolutional codes the best choice. If, for example, data compressed pictures have to
be transmitted, the bit error rate has to be very low. Therefore an outer RS will give a
considerable gain (see (McEliece and Swanson 2001)). For this application, the outer codes
give an additional coding gain of 2.5 dB at BER = 10−6 or a gain in data rate of 78%.
Another concatenated coding scheme with a convolutional code and an RS code is
applied in the DVB-T system, which will be described in Subsection 4.6.2. DVB-T is
an OFDM system with QAM modulation. Because QAM with convolutional coding can
already be interpreted as code concatenation, we have a twofold concatenation in this
system. The outer RS code has been chosen because the goal has been to reach the extremely
low residual bit error rate 10−11 in the video data stream. This cannot be reached with
convolutional codes at a reasonable effort, especially in a fading channel.
We note that in a concatenated decoding setup as depicted in Figure 3.2, the decod-
ing will be done stepwise and the two decoders are separate devices. This is in general
suboptimal compared to a MLSE or MAP receiver for the complete concatenated code.
Improvements can be obtained if the decoders can help each other by means of iterative
decoding. Turbo codes may be the most famous application (see Subsection 3.2.5). The idea
of iterative decoding had been applied earlier in deep space communications (Hagenauer
et al. 2001). Another application is multistage coding, which is implemented in the OFDM
system DRM (Digital Radio Mondiale). The iterative decoding of a convolutionally coded
QAM system with OFDM will be discussed in Subsection 4.5.2.
3.1.5
Log-likelihood ratios and the MAP receiver
Until now, we have discussed only the maximum likelihood sequence estimator at the
receiver. For a channel with additive white Gaussian noise, and a given receive signal
vector r, this receiver estimates the most probable transmit signal vector ˆs out of a ﬁnite
set of possible transmit vectors. This most probable transmit vector is the one for which
the squared Euclidean distance ∥r −ˆs∥2 is minimized, or, for transmit vectors of equal
energy, the correlation given by ℜ{r · ˆs} is maximized. The MLSE estimates transmit
vectors (sequences), not bits. Since there is a one-to-one correspondence to the bit sequences
b, we get an estimate for each bit. Thus, MLSE does not provide us directly with an estimate
for the most probable value of a bit. Both may sometimes be different 3 (see Problem 2).
In this subsection, we introduce a receiver that gives an estimate for the bit together
with a reliability information of the decision. It does not need the assumption of Gaussian
statistics, and is able to provide a reliability measure for each decision, even for single bit
decisions. Furthermore, we can incorporate a priori probabilities of the bits. This is of high
value for any kind of iterative decoding algorithms, as applied in the turbo decoding and
multistage decoding. The basic tool is the log-likelihood ratio, which is deﬁned by
Deﬁnition 3.1.2 (Log-likelihood ratio) Let P (A) be the probability of an event A. Then
the LLR of this event is deﬁned as
L(A) = log
P (A)
1 −P (A).
(3.7)
We add the following remarks.
3Even though in practice, for reasonably high SNRs, both will be the same with extremely high probability.

106
CHANNEL CODING
• The LLR is the ratio between the probability that something is true and that it is not
true, viewed on a logarithmic scale. This is extremely useful if the probabilities are
very high or very small. This is quite similar to the familiar decibel calculus for signal
power levels. Even though the logarithm in Equation (3.7) is usually understood
as a natural logarithm, one can in principle also use 10 log10 there and then, for
example, regard the probability P (A) = 0.999 as an LLR of approximately 30 dB or
the probability P (A) = 0.001 as an LLR of approximately −30 dB.
• One easily ﬁnds that the probability can be expressed by the LLR as
P (A) =
e
1
2 L(A)
e
1
2 L(A) + e−1
2 L(A) .
(3.8)
• The LLR of the complementary event ¯A is given by
L( ¯A) = −L(A).
Soft bits
We often deal with the probability that a random bit takes the value 0 or 1. We will therefore
derive some simple properties of the corresponding random LLRs. To do this, it is very
convenient to replace bits by signs, that is, write +1 for the bit value 0 and −1 for the bit
value 1. This can be interpreted as antipodal (BPSK) signaling with energy 1 given by the
mapping
s = (−1)b = 1 −2b
between the bit b and the sign (BPSK symbol) s. In the following text, we will speak of bits
and their corresponding signs synonymously. To avoid confusion, we will (at this place)
carefully distinguish, in our notation, between random variables (written as capital letters)
and their values. That is, we deal with a random variable S, which is a random sign that
takes values s ∈{+1, −1}. The LLR for the event S = s is then given by
L(S = s) = log P (S = s)
P (S = −s).
From L(S = s) = −L(S = −s), we easily see that L(S = s) = sL(S = +1). If no confu-
sion may arise, we simply write
L = L(S = +1)
(3.9)
We call this the L-value of the random bit S. We note that
L(S = s) = sL.
(3.10)
The L-value of a random bit S (written as a sign) has a very natural interpretation as
a soft bit. The sign of L says which of the two possible events S = +1 or S = −1 is
more probable, that is, the sign gives a hard bit decision. The absolute value of L is
a logarithmic measure for the reliability of this decision. For those who like to express
everything in decibels, we can write 10 log10 for the logarithm in the deﬁnition of the LLR.
Then, for example, an LLR value of +30 dB means that the random bit equals zero with

CHANNEL CODING
107
a probability 0.999 (approximately), and an LLR value of −30 dB means that the random
bit equals one with a probability 0.999 (approximately).
Using Equation (3.8), the probability for the random bit can be expressed by the LLR
as
P (S = s) =
e
1
2 sL
e
1
2 L + e−1
2 L .
(3.11)
We note that
P (S = s) = C e
1
2 sL,
where the constant C =

e
1
2 L + e−1
2 L−1
does not depend on the value of s. Using the
deﬁnition of the LLR, we ﬁnd
L(S = s) = log

P (S = s)
√P (S = −s)P (S = s)
2
and
P (S = s) =

P (S = +1)P (S = −1) e
1
2 sL,
(3.12)
which is an alternative representation with the constant C expressed by the probabilities.
Sequences of random signs
Now consider a vector S = (S1, . . . , SK)T of statistically independent random signs. Then,
the probability for the event that S takes a certain value s = (s1, . . . , sK)T factorizes into
the probabilities of the single signs, that is,
P (S = s) =
K
7
i=1
P (Si = si).
Using Equation (3.12), we may write this as
P (S = s) =
K
7
i=1

P (Si = +1)P (Si = −1) e
1
2 siLi,
where Li = log(P (Si = +1)/P (Si = −1)). This takes the more compact form
P (S = s) = C exp
#
1
2
K

i=1
siLi
%
= C exp
1
2s · L

,
where we have deﬁned a log-likelihood vector L = (L1, . . . , LK). The constant C is now
given by
C =
K
7
i=1

P (Si = +1)P (Si = −1).
We see that as in the case of the MLSE estimator for the AWGN channel, we ﬁnd the most
probable sequence (which is here directly a bit sequence) by maximizing a correlation that
is given by the scalar product s · L. Here we have derived the general case, and the LLR
expressions must be evaluated for any special statistics.

108
CHANNEL CODING
Products of random signs
Consider a random sign S. The expectation value of S is given by
E {S} = (+1) · Pr(S = +1) + (−1) · Pr(S = −1).
Using Equation (3.11), we easily obtain
E {S} = tanh
1
2L

,
where again we have used the shorthand notation L = L(S = +1). Now let S1 and S2 be two
independent random signs and deﬁne S = S1 · S2 and write L1, L2, L for the corresponding
LLRs for the positive sign. From
E {S} = E {S1} E {S2} ,
we conclude
tanh
1
2L

= tanh
1
2L1

tanh
1
2L2

or
L = 2 artanh

tanh
1
2L1

tanh
1
2L2

.
(3.13)
Using the relations
2 artanh (x) = log 1 + x
1 −x
and
tanh(x) = ex −1
ex + 1,
one can show that this equals
L = log 1 + eL1eL2
eL1 + eL2 .
This can be approximated as
L ≈sign (L1) sign (L2) min (|L1| , |L2|)
(see Problem 3). We can interpret this expression as follows: multiplication of random signs
corresponds to the modulo 2 addition of the corresponding random bits. Thus, the modulo
2 addition of two random bits can (approximately) be realized as follows: the hard decision
value of the result is obtained as modulo 2 addition of the hard decision values of the two
bits. Its reliability given by |L| equals the reliability of the least reliable of the two bits,
similar to the saying that a chain is as strong as its weakest link. This becomes especially
obvious if we generalize the approximation to the modulo 2 addition of more than two
random bits and write
L ≈
K
7
i=1
sign (Li) · min (|L1| , . . . , |LK|) .
(3.14)

CHANNEL CODING
109
LLRs for BPSK and additive white Gaussian noise
Until now, no assumption has been made about the special statistics. It is instructive to
exploit the concept of LLRs for the special case of antipodal transmission in an additive
white Gaussian noise channel. In the context of channel coding, it is often convenient to
deal with quantities that have no physical dimension. We rewrite BPSK transmission in an
AWGN channel as
yi = xi + ni,
where xi ∈{±1} and ni is real and normalized discrete AWGN with variance
σ 2 = N0
2Eb
.
The transmit symbols xi and the receive symbols yi are regarded as random variables4.
According to Bayes’ law, the probability P (xi|yi) that xi has been transmitted under the
condition that yi has been received is given by
P (xi|yi) = p(yi|xi)P (xi)
p(yi)
.
Here P (xi) is the a priori probability that xi was transmitted, p(yi) is the probability
density for the receive symbol yi and p(yi|xi) is the probability density for the receive
symbol yi under the condition that xi was transmitted. This is just the Gaussian probability
density with mean xi and variance σ 2, that is,
p(yi|xi = ±1) =
1
√
2πσ 2 exp

−1
2σ 2 |yi ∓1|2

.
We write
Li = log P (xi = +1|yi)
P (xi = −1|yi)
and get
Li = log
exp

−1
2σ 2 |yi −1|2
P (xi = +1)
exp

−1
2σ 2 |yi + 1|2
P (xi = −1)
,
which can eventually be written as
Li = Lc
i + La
i ,
(3.15)
where
Lc
i = log p(yi|xi = +1)
P (yi|xi = −1) = 2
σ 2 yi
is the channel LLR obtained from the symbol transmitted over the channel, and
La
i = log P (xi = +1)
P (xi = −1)
(3.16)
is the a priori LLR corresponding to the a priori probability of the bit.
4Here we fall back into the lax usage of notation that is common in engineering not to distinguish between
random variables and their values.

110
CHANNEL CODING
For a multiplicative fading channel given by
yi = aixi + ni,
where ai is a real fading amplitude, one easily sees that the channel LLR turns out to be
Lc
i = 2
σ 2 aiyi,
(3.17)
that is, the receive symbol must be weighted by the fading amplitude. We note that a one
bit hard BPSK decision will be based on the sign of
Li = 2
σ 2

aiyi + σ 2
2 La
i

.
A positive sign corresponds to a 0, a negative to 1. The second term corresponds to a shift
of the decision threshold that is proportional to the a priori LLR and to the noise.
The conditional probability for the BPSK symbol xi under the condition that yi was
received is given by
P (xi|yi) =

P (xi = +1|yi)P (xi = −1|yi) e
1
2 xiLi.
For uncoded transmission, the transmit symbols are statistically independent, and thus the
conditional probability P (x|y) for the whole BPSK vector x = (x1, . . . , xK)T given that y
was received factorizes to
P (x|y) =
K
7
i=1
P (xi|yi) =
K
7
i=1

P (xi = +1|yi)P (xi = −1|yi) e
1
2 xiLi.
General signal constellation and coded transmission
We consider a set C of M = 2K real transmit signal vectors x = (x1, . . . , xN)T labeled by
bit tuples of length K written as binary vectors b = (b1, . . . , bK)T . We write B for the set
of these tuples. As discussed at the end of Subsection 3.1.1, the mapping
X : B →C,
b →x
can be interpreted as a joint channel encoder and symbol mapper. When using LLR values,
it is convenient to replace a binary vector b by its equivalent sign vector u = (u1, . . . , uK)T
deﬁned by uk = (−1)bk. The set of these vectors will be denoted by U.
First, we ask for the conditional probability P (x|y) for a transmitted signal vector x
given that the vector y has been received. According to Bayes’ law, we have
P (x|y) = p(y|x)P (x)
p(y)
.
Here, P (x) is the a priori probability that x was transmitted, p(y) is the probability density
function for the receive symbol vector y and p(y|x) is the probability density function for
the receive symbol y under the condition that x has been transmitted. We have fallen back
into the loose notation for random variables, that is, we use x for the random variable and

CHANNEL CODING
111
for the value of the random variable as well. We may replace P (x) by P (b), which is the
a priori probability for the bit tuple b that corresponds to x or by the a priori probability
P (u) of the sign vector u. Assuming that the a priori probabilities of the bits are statistically
independent and that p(y|x) factorizes as well because of statistical independence, we may
write
P (x|y) =
1
p(y)
N
7
i=1
p(yi|xi)
K
7
k=1
p(uk).
To ﬁnd the most probable transmit vector for a general signal constellation, this expression
must be maximized.
For the special case of a binary code with antipodal signaling with xi ∈{±1}, we deﬁne
Lc
i = log p(yi|xi = +1)
P (yi|xi = −1),
La
k = log P (uk = +1)
P (uk = −1).
It is convenient to deﬁne channel and a priori LLR vectors as Lc = (Lc
1, . . . , Lc
K) and
La = (La
1, . . . , La
N). The channel LLR vector can be written as
Lc = 2
σ 2 Ay
with the diagonal matrix of fading amplitudes A = diag(a1, . . . , aK). The conditional prob-
ability that a certain sequence has been transmitted is then given by
P (x|y) = C exp
 1
σ 2 µ (x)

(3.18)
with a constant C that does not depend on the transmitted sequence and a metric deﬁned
by
µ(x) = σ 2
2

x · Lc + u · La
.
(3.19)
To ﬁnd the most probable sequence x, this correlation metric µ(x) has to be maximized. We
have chosen this normalization, because in the case of BPSK without a priori information,
Equation (3.17) yields µ(x) = Ay · x, which does not depend on σ.
For the special case of a systematic code, the vector x consists of a systematic part
xs = u and a parity check part xp. In that case, the correlation metric becomes
µ(x) = xs ·

La + Lc
s

+ xp · Lc
p.
(3.20)
Thus, the channel LLR can be split up to a part Lc
s corresponding to the systematic symbol
vector and a part Lc
p corresponding to the parity check symbol vector. The a priori LLR
will be added to the channel LLR for the systematic part.
For an arbitrary signal constellation and a (real-valued) discrete fading channel with
AWGN of variance σ 2, we have
P (x|y) = C1 exp
 1
2σ 2 ∥y −Ax∥2

· exp
1
2u · La

,
which can be written as
P (x|y) = C2 exp
 1
σ 2

x · Ay −1
2 ∥Ax∥2

· exp
1
2u · La

,

112
CHANNEL CODING
with properly deﬁned constant C1 and C2. This can be written as Equation (3.18) with the
metric expression of Equation (3.19) replaced by
µ(x) = σ 2
2

x · Lc + u · La
−1
2 ∥Ax∥2 ,
(3.21)
that is, an energy term must be taken into account.
The bitwise MAP receiver
We now want to analyze decisions about single bits instead of whole sequences. We ask
for the probability P (bk = 0|y) that the kth bit bk in the tuple b has the value zero under
the condition that the vector y was received. The corresponding LLR is given by
L(bk = 0|y) = log P (bk = 0|y)
P (bk = 1|y).
We write B(0)
k
for the set of those vectors b ∈B for which bk = 0 and B(1)
k
for the set of
those for which bk = 1. Then,
P (bk = 0|y) =

b∈B(0)
k
P (b|y)
and
P (bk = 1|y) =

b∈B(1)
k
P (b|y)
hold and the LLR can be written as
L(bk = 0|y) = log
#3
b∈B(0)
k P (b|y)
3
b∈B(1)
k P (b|y)
%
.
(3.22)
Applying Bayes’ law for P (b|y), we get
L(bk = 0|y) = log
#3
b∈B(0)
k p(y|b)P (b)
3
b∈B(1)
k p(y|b)P (b)
%
,
(3.23)
where P (b) is the a priori probability of vector b, and p(y|b) is the conditional probability
density for the receive vector y given that the signal vector x corresponding to b was
transmitted. If L(bk = 0|y) > 0, the receiver decides for bk = 0 and otherwise for bk = 1.
Furthermore, this receiver provides information about the reliability of the decision, which
is given by the absolute value of L(bk = 0|y). We call such a receiver a (bitwise) maximum
a posteriori probability (MAP) receiver. As we have already seen above, we may write
p(y|b)P (b) = C exp
 1
σ 2 µ (x)

(3.24)
with a metric µ(x) that depends on the code and the signal constellation. The constant C
is the same in numerator and denominator.

CHANNEL CODING
113
The SISO decoder for systematic codes
For the special case of a binary systematic code, the metric µ(x) is given by Equation
(3.20). We insert that expression into Equation (3.23) and get the LLR expression
L(bk = 0|y) = log


3
b∈B(0)
k exp
 1
2

xs ·

La + Lc
s

+ xp · Lc
p

3
b∈B(1)
k exp
 1
2

xs ·

La + Lcs

+ xp · Lcp



(3.25)
for the MAP receiver. Here, the sum has to be understood in such a way that, for each
binary vector b, there are uniquely determined corresponding vectors xs and xp. We may
now split up this equation into three terms that have an intuitively obvious interpretation.
To do this, we keep the index k ﬁxed and split up the exponents in the numerator and the
denominator as
xs ·

La + Lc
s

+ xp · Lc
p = xsk(La
k + Lc
sk) +

i̸=k
xsi(La
i + Lc
si) + xp · Lc
p.
In the numerator, the ﬁrst term is constantly +(La
k + Lc
sk), and in the denominator, it is
constantly −(La
k + Lc
sk). We can thus extract this term from the sum. Lk = L(bk = 0|y) in
Equation (3.25) can then be written as
Lk = La
k + Lc
sk + Le
k
(3.26)
with the extrinsic LLR deﬁned by
Le
k = log


3
b∈B(0)
k exp

1
2
3
i̸=k xsi(La
i + Lc
si) + xp · Lc
p

3
b∈B(1)
k exp

1
2
3
i̸=k xsi(La
i + Lc
si) + xp · Lcp


.
Comparing this with Equation (3.15) for uncoded transmission, we see that this extrinsic
LLR corresponds to the additional information gain due to channel coding. It depends on
all other received symbols – systematic symbols and parity check symbols – except the one
corresponding to bk. This LLR adds to the LLRs La
k and Lc
sk that already occur in case of
uncoded transmission.
We now write Equation (3.26) in vector notation as
L = La + Lc + Le
and interpret the MAP as a SISO receiver that has soft LLR vectors as input and output
as depicted in Figure 3.3. The input vectors of the SISO are La and Lc, where Lc consists
of the two parts Lc
s and Lc
p. The systematic MAP of Equation (3.25) has the two inputs
La + Lc
s and Lc
p. The output vector is L. The extrinsic LLR vector Le of that vector is
obtained from the output L by
Le = L −La −Lc
s.
The SISO may be regarded as a device that calculates extrinsic LLR information due to
the code. The total LLR is the sum of this extrinsic LLR and the (a priori and channel)
LLR information already available before decoding.

114
CHANNEL CODING
MAP
La
Lc
s
Lc
p
L
+
−
Le
Figure 3.3 The soft-input/soft-output (SISO) decoder.
The maxlog MAP approximation
The expression (3.23) for the MAP receiver contains transcendental functions and thus it
may sometimes be too costly to implement. The maxlog MAP approximation is often used
in practice because it is quite accurate if the SNR is not extremely low. In that case, the
sums in the numerator and denominator are dominated by their respective largest term and
Equation (3.23) can be approximated by
L(bk = 0|y) ≈max
b∈B(0)
k
log (p(y|b)P (b)) −max
b∈B(1)
k
log (p(y|b)P (b)) .
(3.27)
We note that the hard bit decisions obtained by this maxlog MAP receiver are al-
ways identical to those obtained from the MLSE receiver because the latter searches
for maxb∈B log (p(y|b)P (b)) and decides for the corresponding sequence b = ˆb and thus
L(bk = 0|y) has always the same sign as the sign obtained from the MLSE.
If we insert Equation (3.24) for the argument of the logarithm, we can write this as
L(bk = 0|y) ≈1
σ 2
#
max
b∈B(0)
k
µ (x) −max
b∈B(1)
k
µ (x)
%
.
For a binary code with antipodal signaling, the metric is given by
µ(x) = Ay · x + σ 2
2 Lau.
If no a priori information is available, both the input LLR Lc =
1
σ 2 Ay · x and the output
LLR L are linear in the SNR value σ −2. This linear scale factor can be omitted without
any loss and is only needed for the calculation of absolute probabilities. This is in contrast
to the exact MAP, where the output is a nonlinear function in the SNR and even the hard
decision value may depend on its value.
3.2
Convolutional Codes
3.2.1
General structure and encoder
In contrast to block codes, convolutional codes do not have a deﬁned block structure. A
continuously ﬂowing data stream will be encoded into a continuously ﬂowing code word.

CHANNEL CODING
115












Coded bits
Data bits
Figure 3.4 Block diagram for a simple convolutional encoder.
Even though it is reasonable for practical and theoretical reasons to work with ﬁnite sets
of data and coded bits, the length of a code word is given by other requirements than
the structure of the code. Convolutional encoders are linear and time-invariant systems
given by the convolution of a binary data stream with generator sequences. They can be
implemented by shift registers. Figure 3.4 shows a simple example of such an encoder with
rate Rc = 1/2 and memory m = 2.
Given an input bit stream {bi}∞
i=0, a convolutional encoder of code rate Rc = 1/n
produces n parallel data streams {cν,i}∞
i=0, ν = 1, . . . , n that may be multiplexed to one
serial code word before transmission. It can be written as
cν,i =
m

k=0
gν,kbi−k,
where we have set bi = 0 f¨ur i < 0. The sum has to be understood as modulo 2 sum. Here,
gν,k, (ν = 1, . . . , n; k = 0, . . . , m) are the generators that can also be written as generator
polynomials
gν(D) =
m

k=0
gν,kDk,
where D is a formal variable that can be interpreted as delay. In the example of Figure 3.4,
we have
g1(D) = 1 + D2 ≡(101) ≡5oct,
g2(D) = 1 + D + D2 ≡(111) ≡7oct,
where we have introduced the binary vector notation and the octal notation for the gener-
ators.
It is often convenient to work with formal power series instead of sequences. This
is similar to the formalism in signal processing, where we may switch to the frequency
domain to replace convolutions by multiplications. We deﬁne the power series
b(D) =
∞

k=0
bkDk
for the data word and
cν(D) =
∞

k=0
cνkDk, ν = 1, . . . , n

116
CHANNEL CODING
for the code word. Then the encoder can be described by
cν(D) = b(D)gν(D)
(3.28)
or, in vector notation, as
c(D) = b(D)g(D),
(3.29)
that is,


c1(D)
...
cn(D)

= b(D)


g1(D)
...
gn(D)

.
Convolutional codes are linear codes. Thus, the Hamming distance of the code is the
minimum weight. This is called the free distance and will be denoted by dfree.
Trellis diagrams
For any time instant i, one can characterize the encoding step by the actual state s =
(s1, . . . , sm), that is, the content of the shift register (s1 is the most recent bit that has been
shifted into the register) and the actual input bit bi. This uniquely deﬁnes the next state
s′ = (bi, s1, . . . , sm−1) and the encoded output bits c1i, c2i, . . . , cni. For the code given by
Figure 3.4, there are four possible states (s1s2) ∈{(00), (10), (01), (11)} and eight possible
transitions from one stage to the following, as depicted in Figure 3.5. For each transition,
there is an input bit bi and a pair of output bits (c1i, c2i) denoted by bi/c1ic2i at each
transition line in the ﬁgure. Now consider a certain number of such transitions. They can




































	
	
	
	
	
	
	
	
	
	
		

s1s2 at time i
00
10
01
11
00
10
01
11
0/00
1/11
1/10
1/01
0/10
0/11
0/01
1/00
s1s2 at time i + 1
bi/c1ic2i
Figure 3.5 State transitions for the (1 + D2, 1 + D + D2) convolutional code.

CHANNEL CODING
117
Figure 3.6 Trellis diagram for the (1 + D2, 1 + D + D2) convolutional code.
be depicted by successively appending such transitions as shown in Figure 3.6. This is
called a trellis diagram. Given a deﬁned initial state of the shift register (usually the all-
zero state), each code word is characterized by sequence of certain transitions. We call this
a path in the trellis. In Figure 3.6, the path corresponding to the data word 1000 0111
0100 and the code word 11 01 11 00 00 11 10 01 10 00 01 11 is depicted by bold lines
for the transitions in the trellis. In this example, the last m = 2 bits are zero and, as a
consequence, the ﬁnal state in the trellis is the all-zero state. It is common practice to start
and to stop with the all-zero state because it helps the decoder. This can easily be achieved
by appending m zeros – the so-called tail bits – to the useful bit stream.
State diagrams
One can also characterize the encoder by states and inputs and their corresponding transi-
tions as depicted in part (a) of Figure 3.7
for the code under consideration. This is known
as a Mealy automat. To evaluate the free distance of a code, it is convenient to cut open the
automat diagram as depicted in part (b) of Figure 3.7. Each path (code word) that starts in
the all-zero state and comes back to that state can be visualized by a sequence of states that
starts at the all-zero state on the left and ends at the all-zero state on the right. We look at
the coded bits in the labeling bi/c1ic2i and count the bits that have the value one. This is
just the Hamming distance between the code word corresponding to that sequence and the
all-zero code word. From the diagram, one can easily obtain the smallest distance dfree to
the all-zero code word. For the code of our example, the minimum distance corresponds to
the sequence of transitions 00 →10 →01 →00 and turns out to be dfree = 5. The alter-
native sequence 00 →10 →11 →01 →00 has the distance d = 6. All other sequences
include loops that produce higher distances.
From the state diagram, we may also ﬁnd the so-called error coefﬁcient cd. These error
coefﬁcients are multiplicative coefﬁcients that relate the probability Pd of an error event
of distance d to the corresponding bit error probability. To obtain cd, we have to count
all the nonzero data bits of all error paths of distance d to the all-zero code word. Using
P (A1 ∪A2) ≤P (A1) + P (A2), we obtain the union bound
Pb ≤
∞

d=dfree
cdPd
for the bit error probability. The coefﬁcients cd for most relevant codes can be found in
text books. The error event probability Pd, for example, for antipodal signaling is given

118
CHANNEL CODING
00
10
01
11
1/11
0/01
1/00
0/11
1/10
0/10
1/01
0/00
(a)
(b)
00
00
10
01
1/01
11
1/11
0/01
1/00
0/11
0/10
1/10
Figure 3.7
State diagram (Mealy automat) for the (1 + D2, 1 + D + D2) convolutional
code.
by Equation (3.2) for the AWGN channel and by Equation (3.4) for the Rayleigh fading
channel.
Catastrophic codes
The state diagram also enables us to ﬁnd a class of encoders called catastrophic encoders
that must be excluded because they have the undesirable property of error propagation: if
there is a closed loop in the state diagram where all the coded bits c1ic2i are equal to zero, but
at least one data bit bi equals one, then there exists a path of inﬁnite length with an inﬁnite
number of ones in the data, but with only a ﬁnite number of ones in the code word. As a

CHANNEL CODING
119









Coded bits
Data bits
Figure 3.8 Example of a catastrophic convolutional encoder.
consequence, a ﬁnite number of channel bit errors may lead to an inﬁnite number of errors
in the data, which is certainly a very undesirable property. An example for a catastrophic
encoder is the one characterized by the generators (3, 6)oct = (1 + D, D + D2), which is
depicted in Figure 3.8. Once in the state 11, the all-one input sequence will be encoded to
the all-zero code word.
Punctured convolutional codes
Up to now, we have only considered convolutional codes of rate Rc = 1/n. There are two
possibilities to obtain Rc = k/n codes. The classical one is to use k parallel shift registers
and combine their outputs. This, however, makes the implementation more complicated.
A simpler and more ﬂexible method called puncturing is usually preferred in practical
communication systems. We explain it by means of the example of an Rc = 1/2 code that
can be punctured to obtain an Rc = 2/3 code. The encoder produces two parallel encoded
data streams {c1,i}∞
i=0 and {c2,i}∞
i=0. The ﬁrst data stream will be left unchanged. From the
other data stream every second bit will be discarded, that is, only the bits with even time
index i will be multiplexed to the serial code word and then transmitted. Instead of the
original code word
 c10
c20
c11
c21
c12
c22
c13
c23
c14
. . . 
the punctured code word
 c10
c20
c11
⃝
c12
c22
c13
⃝
c14
. . . 
will be transmitted. Here we have indicated the punctured bits by ⃝. At the receiver,
the puncturing positions must be known. A soft decision (e.g. MLSE) receiver has metric
values µνi as inputs that correspond to the encoded bits cνi. The absolute value of µνi is an
indicator for the reliability of the bit. Punctured bits can be regarded as bits with reliability
zero. Thus, the receiver has to add dummy receive bits at the punctured positions of the
code word and assign them the metric values µνi = 0.
Recursive systematic convolutional encoders
Recursive systematic convolutional (RSC) encoders have become popular in the context
of parallel concatenated codes and turbo decoding (see below). For every nonsystematic
convolutional (NSC) Rc = 1/n encoder, one can ﬁnd an equivalent RSC encoder that

120
CHANNEL CODING









(a)
(b)
Figure 3.9 Inversion circuit for the generator polynomial 1 + D2.
produces the same code (i.e. the same set of code words) with a different relation between
the data word and the code word. It can be constructed in such a way that the ﬁrst of the
n parallel encoded bit stream of the code word is systematic, that is, it is identical to the
data word.
As an example, we consider the Rc = 1/2 convolutional code of Figure 3.4 that can be
written in compact power series notation as
 c1(D)
c2(D)

= b(D)

1 + D2
1 + D + D2

.
The upper branch corresponding to the generator polynomial g1(D) = 1 + D2 of the shift
register circuit depicted in part (a) of Figure 3.9 deﬁnes a one-to-one map from the set
of all data words to itself. One can easily check that the inverse is given by the recursive
shift register circuit depicted in part (b) of Figure 3.9. This can be described by the formal
power series
g−1
1 (D) =

1 + D2−1 = 1 + D2 + D4 + D6 + · · ·
This power series description of feedback shift registers is formally the same as the descrip-
tion of linear systems in digital signal processing5, where the delay is usually denoted by
e−jω instead of D. The shift register circuits of Figure 3.9 invert each other. Thus, g−1
1 (D)
is a one-to-one mapping between bit sequences. As a consequence, combining the convolu-
tional encoder with that recursive shift register circuit as depicted in part (a) of Figure 3.10
leads to the same set of code words. This circuit is equivalent to the one depicted in part
(b) of Figure 3.10. This RSC encoder with generator polynomials (5, 7)oct can formally
be written as
 c1(D)
c2(D)

= ˜b(D)
8
1
1+D+D2
1+D2
9
,
where the bit sequences are related by ˜b(D) = (1 + D2) b(D).
For a general Rc = 1/n convolutional code, we have the NSC encoder given by the
generator polynomial vector
g(D) =


g1(D)
...
gn(D)

.
5In signal processing, we have an interpretation of ω as a (normalized) frequency, which has no meaning for
convolutional codes. Furthermore, here all additions are modulo 2. However, all formal power series operations
are the same.

CHANNEL CODING
121




























(a)
(b)
Figure 3.10 Recursive convolutional encoder.
The equivalent RSC encoder is given by the generator vector
˜g(D) =


1
g2(D)/g1(D)
...
gn(D)/g1(D)

.
The bits sequence b(D) encoded by g(D) results in the same code word as the bit sequence
˜b(D) = g1(D)b(D) encoded by ˜g(D) = g−1
1 (D)g(D), that is,
c(D) = b(D)g(D) = ˜b(D)˜g(D).
An MLSE decoder will ﬁnd the most likely code word that is uniquely related to a data
word corresponding to an NSC encoder and another data word corresponding to an RSC
encoder. As a consequence, one may use the same decoder for both and then relate the
sequences as described above. But note that this is true only for a decoder that makes
decisions about sequences. This is not true for a decoder that makes bitwise decisions like
the MAP decoder.
3.2.2
MLSE for convolutional codes: the Viterbi algorithm
Let us consider a convolutional code with memory m and a ﬁnite sequence of K input data
bits {bk}K
k=1. We denote the coded bits as ci. We assume that the corresponding trellis starts
and ends in the all-zero state. In our notation, the tail bits are included in {bk}K
k=1, that is,
there are only K −m bits that really carry information.

122
CHANNEL CODING
Although the following discussion is not restricted to that case, we ﬁrst consider the
concrete case of antipodal (BPSK) signaling, that is, transmit symbols xi = (−1)ci ∈{±1}
written as a vector x and a real discrete AWGN channel given by
y = x + n,
where y is the vector of receive symbols and n is the real AWGN vector with components
ni of variance
σ 2 = E

n2
i

= N0
2ES
.
Here, we have normalized the noise by the symbol energy ES. We know from the discussion
in Subsection 1.3.2 that, given a ﬁxed receive vector y, the most probable transmit sequence
x for this case is the one that maximizes the correlation metric given by the scalar product
µ(x) = y · x.
(3.30)
For an Rc = 1/n convolutional code, the code word consists of nK encoded bits, and the
metric can be written as a sum
µ(x) =
K

k=1
µk
(3.31)
of metric increments
µk = yk · xk
corresponding to the K time steps k = 1, . . . , K of the trellis. Here xk is the vector of the
n symbols xi that correspond to encoded bits for the time step number k where the bit bk
is encoded, and yk is the vector of the corresponding receive vector.
The task now is to ﬁnd the vector x that maximizes the metric given by Equation
(3.31), thereby exploiting the special trellis structure of a convolutional code. We note that
the following treatment is quite general and it is by no means restricted to the special
case of the AWGN metric given by Equation (3.30). For instance, any metric that is given
by expressions like Equations (3.19–3.21) can be written as Equation (3.31). Thus, a
priori information about the bits also can be included in a straightforward manner by the
expressions presented in Subsection 3.1.5, see also (Hagenauer 1995).
For a reasonable sequence length K, it is not possible to ﬁnd the vector x by exhaustive
search because this would require a computational effort that is proportional to 2K. But,
owing to the trellis structure of convolutional codes, this is not necessary. We consider two
code words x and ˆx with corresponding paths merging at a certain time step k in a common
state sk (see Figure 3.11). Assume that for both paths the accumulated metrics, that is, the
sum of all metric increments up to that time step
k =
k

i=1
µi
for x and
ˆk =
k

i=1
ˆµi

CHANNEL CODING
123





	
	
	
	
	
	
	
		
sk
sk−1
ˆx
x
sk+1
Figure 3.11 Transition where the paths x and ˆx merge.
for ˆx have been calculated. Because the two paths merge at time step k and will be identical
for the whole future,
µ(ˆx) −µ(x) = ˆk −k
holds and we can already make a decision between both paths. Assume µ(ˆx) −µ(x) > 0.
Then, ˆx is more likely than x, and we can discard x from any further considerations. This
fact allows us to sort out unlikely paths before the ﬁnal decision and thus an effort that is
exponentially growing with the time can be avoided.
The algorithm that does this is the Viterbi algorithm and it works as follows: starting
from the initial state, the metric increments µk for all transitions between all the state sk−1
and sk are calculated recursively and added up to the time accumulated metrics k−1. Then,
for the two transitions with the same new state sk, the values of k−1 + µk are compared.
The larger value will serve as the new accumulated metric k = k−1 + µk, and the other
one will be discarded. Furthermore, a pointer will be stored, which points from sk to the
preceding state corresponding to the larger metric value. Thus, going from the left to the
right in the trellis diagram, for each time instant k and for all possible states, the algorithm
executes the following steps:
1. Calculate the metric increments µk for all the 2 · 2m transitions between all the 2m
states sk−1 and all the 2m states sk and add them to the to the 2m accumulated metric
values k−1 corresponding to the states sk−1.
2. For all states sk compare the values of k−1 + µk for the two transitions ending at
sk and select the one that is the maximum and then set k = k−1 + µk, which is
the accumulated metric of that state.
3. Place a pointer to the state sk−1 that is the most likely preceding state for that
transition.
Then, when all these calculations and assignments have been done, we start at the end of
the trellis and trace back the pointers that indicate the most likely preceding states. This
procedure ﬁnally leads us to the most likely path in the trellis.

124
CHANNEL CODING
3.2.3
The soft-output Viterbi algorithm (SOVA)
The soft-output Viterbi algorithm (SOVA) is a relatively simple modiﬁcation of the Viterbi
algorithm that allows to obtain an additional soft reliability information for the hard decision
bits provided by the MLSE.
By construction, the Viterbi algorithm is a sequence estimator, not a bit estimator. Thus,
it does not provide reliability information about the bits corresponding to the sequence.
However, it can provide us with information about the reliability of the decision between
two sequences. Let x and ˆx be two possible transmit sequences. Then, according to Equation
(3.18), the conditional probability that this sequence has been transmitted given that y has
been received is
P (x|y) = C exp
 1
σ 2 µ(x)

for x and
P (ˆx|y) = C exp
 1
σ 2 µ(ˆx)

for ˆx. Now assume that ˆx is the maximum likelihood sequence obtained by the Viterbi
algorithm. If one could be sure that one of the two sequences x or ˆx is the correct one (and
not any other one), then Pr(ˆx|y) = 1 −Pr(x|y) and the LLR for a correct decision would
be given by
L(ˆx) = log P (ˆx|y)
P (x|y) = 1
σ 2 (µ(ˆx) −µ(x)) ,
(3.32)
that is, the metric difference is a measure for the reliability of the decision between the two
sequences. We note that this LLR is conditioned by the event that one of both paths is the
correct one.
We now consider a data bit ˆbk at a certain position in the bit stream corresponding to the
ML sequence ˆx estimated by the Viterbi Algorithm6. The goal now is to gain information
about the reliability of this bit by looking at the reliability of the decisions between ˆx and
other sequences x(β) whose paths merge with the ML path at some state sk. Any decision
in favor of ˆx instead of the alternative sequence x(β) with a bit b(β)
k
is only relevant for that
bit decision if b(β)
k
̸= bk. Thus, we can restrict our consideration to the relevant sequences
x(β). Each of the relevant alternative paths labeled by the index β is the source of a possible
erroneous decision in favor of ˆbk instead of b(β)
k . We deﬁne a random error bit e(β)
k
that
takes the value e(β)
k
= 1 for an erroneous decision in favor of ˆbk instead of b(β)
k
and e(β)
k
= 0
otherwise. We write L(β)
k
= L

e(β)
k
= 0

for the L-values of the error bits. By construction,
it is given by
L(β)
k
= 1
σ 2

µ(ˆx) −µ(xβ)

.
Note that L(β)
k
> 0 holds because bk belongs to the maximum likelihood path that is per
deﬁnitionem more likely than any other.
It is important to note that all the corresponding probabilities are conditional probabili-
ties because in any case it is assumed that one of the two sequences ˆx or x(β) is the correct
6The same arguments apply if we consider a symbol ˆxi of the transmit sequence.

CHANNEL CODING
125
one. Furthermore, we only consider paths that merge directly with the ML path. Therefore,
all paths that are discarded after comparing them with another path than the ML path are
not considered. It is possible (but not very likely in most cases) that the correct path is
among these discarded paths. This rare event has been excluded in our approximation. We
further assume that the random error bits e(β)
k
are statistically independent. All the random
error bits e(β)
k
together result in an error bit ek that is assumed to be given by the modulo
2 sum
ek =

relevant β
⊕e(β)
k .
We further write Lk = L (ek = 0) for the L-value of the resulting error bit. Using Equation
(3.14), the L-value for this resulting error bit is approximately given by
Lk ≈
min
relevant β

L(β)
k

=
min
relevant β
 1
σ 2

µ(ˆx) −µ(x(β))

,
where we have used Equation (3.32). It is intuitively simple to understand that this is a
reasonable reliability information about the bit bk. We consider all the sequence decisions
that are relevant for the decision of this bit. Then, according to the intuitively obvious
rule that a chain is as strong as its weakest link, we assign the smallest of those sequence
reliabilities as the bit reliability.
Now, in the Viterbi algorithm, the reliability information about the merging paths have
to be stored for each state in addition to the accumulated metric and the pointer to the most
likely preceding state. Then the reliability of the bits of the ML path will be calculated.
First, they will all be initialized with +∞, that is, practically speaking, with a very large
number. Then, for each relevant decision between two paths, this value will be updated, that
is, the old reliability will be replaced by the reliability of the path decision if the latter is
smaller. To do this, every path corresponding to any sequence x(β) that has been discarded
in favor of the ML sequence ˆx has to be traced back to a point where both paths merge.
We ﬁnally note that the reliability information can be assigned to the transmit symbols
xi ∈{±1} (i.e. the signs corresponding to the bits of the code word) as well as to the data
bit itself.
3.2.4
MAP decoding for convolutional codes: the BCJR algorithm
To obtain LLR information about bits rather than about sequences, the bitwise MAP re-
ceiver of Equation (3.23) has to be applied instead of a MLSE. This equation cannot be
applied directly because it would require an exhaustive search through all code words. For
a convolutional code, the exhaustive search for the MLSE can be avoided in the Viterbi
algorithm by making use of the trellis structure. For the MAP receiver, the exhaustive
search can be avoided in the BCJR (Bahl, Cocke, Jelinek, Raviv) algorithm (Bahl et al.
1974). In contrast to the SOVA, it provides us with the exact LLR value for a bit, not just
an approximate one. The price for this exact information is the higher complexity. The
BCJR algorithm has been known for a long time, but it became very popular not before its
widespread application in turbo decoding.
We consider a vector of data bits b = (b1, . . . , bK)T encoded to a code word c and
transmitted with symbols xk. Given a receive symbol sequence y = (y1, . . . , yN)T , we

126
CHANNEL CODING












	
	
	
	
		
	
	
	
	
	
	
sk
sk−1
y+
k
y−
k
yk
Figure 3.12 Transition.
want to calculate the LLR for a data bit bk given as
L(bk = 0|y) = log
3
b∈B(0)
k P (b|y)
3
b∈B(1)
k P (b|y).
(3.33)
Here, B(0)
k
is the set of those vectors b ∈B for which bk = 0 and B(1)
k
is the set of those for
which bk = 1. We assume that the bit bk is encoded during the transition between the states
sk−1 and sk of a trellis. For each time instant k, there are 2m such transitions corresponding
to bk = 0 and 2m transitions corresponding to bk = 1. Each probability term P (b|y) in the
numerator or denominator of Equation (3.33) can be written as the conditional probability
P (sksk−1|y) for the transition between two states sk−1 and sk. Since the denominator in
P (sksk−1|y) = p(y, sksk−1)
p(y)
cancels out in Equation (3.33), we can consider the joint probability density function
p(y, sksk−1) instead of the conditional probability P (sksk−1|y). We now decompose the
receive symbol vector into three parts: we write y−
k for those receive symbols correspond-
ing to time instants earlier than the transition between the states sk−1 and sk. We write yk for
those receives symbols corresponding to time instants at the transition between the states
sk−1 and sk. And we write y+
k for those receive symbols corresponding to time instants
later than the transition between the states sk−1 and sk. Thus, the receive vector may be
written as
y =


y−
k
yk
y+
k


(see Figure 3.12), and the probability density may be written as
p(y, sksk−1) = p(y+
k yky−
k sksk−1).
If no confusion arises, we dispense with the commas between vectors. Using the deﬁnition
of conditional probability, we modify the right-hand side and get
p(y, sksk−1) = p(y+
k |yky−
k sksk−1)p(yky−
k sksk−1),

CHANNEL CODING
127
and, in another step,
p(y, sksk−1) = p(y+
k |yky−
k sksk−1)p(yksk|y−
k sk−1)p(y−
k sk−1).
We now make the assumptions
p(y+
k |yky−
k sksk−1) = p(y+
k |sk)
and
p(yksk|y−
k sk−1) = p(yksk|sk−1),
which are quite similar to the properties of a Markov chain. The ﬁrst equation means that
we assume that the random variable y+
k corresponding to the receive symbols after state sk
depends on that state, but is independent of the earlier state sk−1 and any earlier receive
symbols corresponding to y and y−
k . The second equation means that we assume that the
random variable yk corresponding to the receive symbols for the transition from the state
sk−1 to sk does not depend on earlier receive symbols corresponding to y−
k . For a given
ﬁxed receive sequence y, we deﬁne
αk−1(sk−1) = p(y−
k sk−1),
βk(sk) = p(y+
k |sk),
γk(sk|sk−1) = p(yksk|sk−1)
(3.34)
and write
p(y, sksk−1) = βk(sk)γk(sk|sk−1)αk−1(sk−1).
The probability densities γk(sk|sk−1) for the transition from the state sk−1 to sk can be
obtained from the metric value µk calculated from yk. As shown in Section 3.1.5, for
the AWGN channel with normalized noise variance σ 2 and bipolar transmission, we have
simply
γk(sk|sk−1) = C exp
 1
σ 2 xk · yk

· Pr(xk),
where xk is the transmit symbol and P (xk) is the a priori probability corresponding to that
transition. The αk and βk values have to be calculated using recursive relations. We state
the following proposition.
Proposition 3.2.1 (Forward-backward recursions) For αk, βk, γk as deﬁned by Equation
(3.34), the following two recursive relations
αk(sk) =

sk−1
γk(sk|sk−1)αk−1(sk−1)
(3.35)
and
βk−1(sk−1) =

sk
βk(sk)γk(sk|sk−1)
(3.36)
hold.
Proof. Forward recursion:
αk(sk) = p(y−
k+1sk) = p(yky−
k sk)
= 3
sk−1 p(yky−
k sksk−1)
= 3
sk−1 p(yksk|y−
k sk−1)p(y−
k sk−1)
Using the Markov property p(yksk|y−
k sk−1) = p(yksk|sk−1), we obtain Equation (3.35).

128
CHANNEL CODING
Backward recursion:
βk−1(sk−1) = p(y+
k−1|sk−1) = p(y+
k yk|sk−1) = p(y+
k yksk−1)/ Pr(sk−1)
= 3
sk p(y+
k yksksk−1)/ Pr(sk−1)
= 3
sk p(y+
k |yksksk−1)p(yksksk−1)/ Pr(sk−1).
Using p(yksksk−1)/ Pr(sk−1) = p(yksk|sk−1) and the Markov property p(y+
k |yksksk−1) =
p(y+
k |sk), we obtain Equation (3.36).
The BCJR algorithm now proceeds as follows: initialize the initial and the ﬁnal state
of the trellis as α0 = 1 and βK = 1 and calculate the αk values according to the forward
recursion of Equation (3.35) from the left to the right in the trellis and then calculate the
βk according to the backward recursion Equation (3.36) from the right to the left in the
trellis. Then the LLRs for each transition can be calculated as
L(bk = 0|y) = log
3
b∈B(0)
k p(y, sksk−1)
3
b∈B(1)
k p(y, sksk−1)
that is,
L(bk = 0|y) = log
3
b∈B(0)
k αk−1(sk−1)γk(sk|sk−1)βk(sk)
3
b∈B(1)
k αk−1(sk−1)γk(sk|sk−1)βk(sk).
In this notation, we understand the sum over all b ∈B(0)
k
as the sum over all transitions
from sk−1 to sk with bk = 0 and sum over all b ∈B(1)
k
as the sum over all transitions from
sk−1 to sk with bk = 1.
3.2.5
Parallel concatenated convolutional codes and turbo decoding
During the last decade, great success has been achieved in closely approaching the theoret-
ical limit of channel coding. The codes that have been used for that are often called turbo
codes. More precisely, one should carefully distinguish between the code and the decod-
ing method. The ﬁrst turbo code was a parallel concatenated convolutional code (PCCC).
Parallel concatenation can be done with block codes as well. Also serial concatenation is
possible. The novel decoding method that has been applied to all theses codes deserves
the name turbo decoder because there is an iterative exchange of extrinsic and a priori
information between the decoders of the component codes.
To explain the method, we consider the classical scheme with a parallel concatenation
of two RSC codes of rate Rc = 1/2 as depicted in Figure 3.13. The data bit stream is
encoded in parallel by two RSC encoders (that may be identical). The common systematic
part xs of both codes will be transmitted only once. Thus, the output code word consists
of three parallel vectors: the systematic symbol vector xs and the two nonsystematic PC
symbol vectors xp1 and xp2. The input for the second RSC parity check encoder (RSC-PC2)
is interleaved by a pseudo-random permutation  before encoding. The resulting Rc = 1/3
code word may be punctured in the nonsystematic symbols to achieve higher code rates.
Lower code rates can be achieved by additional RSC-PCs, together with interleavers. This
setup may be regarded as well as a parallel concatenation of the ﬁrst RSC code of rate
Rc = 1/2 with an Rc = 1 recursive nonsystematic code that produces xp2. However, here

CHANNEL CODING
129
RSC−PC1
RSC−PC2

xs
xp1
xp2
Figure 3.13 PCCC encoder.
Time index
xp2
xp1
xs
Figure 3.14 PCCC code word.
we prefer the point of view of two equal rate RSC codes with a common systematic symbol
stream.
The code word consisting of three parallel symbol streams can be visualized as depicted
in Figure 3.14. The vector xp1 can be regarded as a horizontal parity check, the vector xp2
as a vertical parity check. The time index is the third dimension. At the decoder, the
corresponding receive vectors are denoted by ys, yp1 and yp2. With a diagonal matrix of
fading amplitudes A, the channel LLRs are
Lc
s = 2
σ 2 Ays,
Lc
p1 = 2
σ 2 Ayp1,
Lc
p2 = 2
σ 2 Ayp2,
where σ −2 is the channel SNR. We write Lc
1 =

Lc
s, Lc
p1

and Lc
2 =

Lc
s, Lc
p2

for the
respective channel LLRs. In the decoding process, independent extrinsic information Le
1
and Le
2 about the systematic part can be obtained from the horizontal and from the vertical
decoding, respectively. Thus, the horizontal extrinsic information can be used as a priori
information for vertical decoding and vice versa.
The turbo decoder setup is depicted in Figure 3.15. It consists of two SISO decoders,
SISO1 and SISO2, for the decoding of RSC1 and RSC2, as depicted in Figure 3.3. To

130
CHANNEL CODING
2
σ 2yp2
2
σ 2ys
2
σ 2yp1
SISO1
SISO2
Lc
1
Lc
2
Le
1
La
1
Le
2
La
2
L1
L2
Decision
Decision
Figure 3.15 Turbo decoder.
simplify the ﬁgure, the necessary de–interleaver −1 at the input for Lc
s and La
2 and the
interleaver  at the output for Le
2 and L2 of RSC2 are included inside the SISO2. The
MAP decoder for convolutional codes will be implemented by the BCJR algorithm. In the
iterative decoding process, the extrinsic output of one SISO decoder serves as the a priori
input for the other. At all decoding steps, the channel LLR values are available at both
SISOs. In the ﬁrst decoding step, only the channel information, but no a priori LLR value is
available at SISO1. Then SISO1 calculates the extrinsic LLR value Le
1 from the horizontal
decoding. This serves as the a priori input LLR value La
2 for SISO2. The extrinsic output
Le
2 then serves as the a priori input for SISO1 in the second iteration. These iterative steps
will be repeated until a break, and then a ﬁnal decision can be obtained from the SISO
total LLR output value L2 (or L1).
We note that the a priori input is not really an independent information at the second
iteration step or later. This is because all the information of the code has already been
used to obtain it. However, the dependencies are small enough so that the information can
be successfully used to improve the reliability of the decision by further iterations. On the
other hand, it is essential that there will be no feedback of LLR information from the output
to the input. Such a feedback would be accumulated at the inputs and ﬁnally dominate the
decision. Therefore, the extrinsic LLR must be used, where the SISO inputs have been
subtracted from the LLR.
We add the following remarks:
• In the ideal case, the SISO is implemented by a BCJR MAP receiver. In practice,
the maxlog MAP approximation may be used, which results only in a small loss in
performance. This loss is due to the fact that the reliability of the very unreliable
symbols is slightly overestimated. The SOVA may also be used, but the performance
loss is higher.

CHANNEL CODING
131
• The exact MAP needs the knowledge of the SNR value σ −2, which is normally not
available. Thus, a rough estimate must be used. Using the maxlog MAP or SOVA,
the SNR is not needed. This is due to the fact that in the ﬁrst decoding step no a
priori LLR is used, and, as a consequence, the SNR appears only as a common linear
scale factor in all further calculated LLR outputs.
3.3
Reed–Solomon Codes
Reed–Solomon (RS) codes may be regarded as the most important block codes because of
their extremely high relevance for many practical applications. These include deep space
communications, digital storage media and, last but not least, the digital video broadcasting
system (DVB). However, these most useful codes are based on quite sophisticated theoreti-
cal concepts that seem to be much closer to mathematics than to electrical engineering. The
theory of RS codes can be found in many text books (Blahut 1983; Bossert 1999; Clark
and Cain 1988; Lin and Costello 1983; Wicker 1995). In this section about RS codes,
we restrict ourselves to some important facts that are necessary to understand the coding
scheme of the DVB-T system discussed in Subsection 4.6.2. We will ﬁrst discuss the basic
properties of RS codes as far as they are important for the practical application. Then, we
will give a short introduction to the theoretical background. For a deeper understanding of
that background, we refer to the text books cited above.
3.3.1
Basic properties
Reed–Solomon codes are based on byte arithmetics7 rather than on bit arithmetics. Thus, RS
codes correct byte errors instead of bit errors. As a consequence, RS codes are favorable for
channels with bursts of bit errors as long as these bursts do not affect too many subsequent
bytes. This can be avoided by a proper interleaving scheme. Such bursty channels occur
in digital recording. As another example, for a concatenated coding scheme with an inner
convolutional code, the Viterbi decoder produces burst errors. An inner convolutional code
concatenated with an outer RS code is therefore a favorable setup. It is used in deep space
communications and for DVB-T.
Let N = 2m −1 with an integer number m. For the practically most important RS codes,
we have m = 8 and N = 255. In that case, the symbols of the code word are bytes. For
simplicity, in the following text, we will therefore speak of bytes for those symbols. For an
RS(N, K, D) code, K data bytes are encoded to a code word of N bytes. The Hamming
distance is given by D = N −K + 1 bytes. For odd values of D, the code can correct up to
t byte errors with D = 2t + 1. For even values of D, the code can correct up to t byte errors
with D = 2t + 2. RS codes are linear codes. For a linear code, any nonsystematic encoder
can be transformed into a linear encoder by a linear transform. Figure 3.16 shows the
structure of a systematic RS code word with an odd Hamming distance and an even number
N −K = D −1 = 2t of redundancy bytes called parity check (PC) bytes. In that example,
the parity check bytes are placed at the end of the code word. Other choices are possible.
RS codes based on byte arithmetics have always the code word length N = 28 −1 = 255.
7RS codes can be constructed for more general arithmetic structures, but only those based on byte arithmetics
are of practical relevance.

132
CHANNEL CODING
2t PC bytes
K data bytes
Figure 3.16 A systematic RS code word.
Table 3.1
Some
RS
code parameters
RS(255, 253, 3)
t = 1
RS(255, 251, 5)
t = 2
RS(255, 249, 7)
t = 3
. . .
RS(255, 239, 17)
t = 8
. . .
16 PC bytes
188 data bytes
41 zero bytes
Figure 3.17 A shortened RS code word.
They can be constructed for any value of D ≤N. Table 3.1 shows some examples for odd
values of D.
Shortened RS codes
In practice, the ﬁxed code word length N = 255 is an undesirable restriction. One can
get more ﬂexibility by using a simple trick. For an RS(N, K, D) code with N = 255, we
want to encode only K1 < K data byte and set the ﬁrst K −K1 bytes of the data word to
zero. We then encode the K bytes (including the zeros) with the RS(N, K, D) systematic
encoder to obtain a code word of length N whose ﬁrst K −K1 code words are equal to
zero. These bytes contain no information and need not to be transmitted. By this method
we have obtained a shortened RS(N1, K1, D) code word with N1 = N −(K −K1). Figure
3.17 shows the code word of a shortened RS(204, 188, 17) code obtained from an RS(255,
239, 17) code. Before decoding, at the receiver, the K −K1 zero bytes must be appended
at the beginning of the code word and a RS(255, 239, 17) decoder will be used. This
shortened RS code is used as the outer code for the DVB-T system.
Decoding failure
It may happen that the decoder detects errors that cannot be corrected. In the case of
decoding failure, an error ﬂag can be set to indicate that the data are in error. The application
may then take beneﬁt from this information.

CHANNEL CODING
133
Erasure decoding
If it is known that some received bytes are very unreliable (e.g. from an inner decoder that
provides such reliability information), the decoder can make use of this fact in the decoding
procedure. These bytes are called erasures.
3.3.2
Galois ﬁeld arithmetics
Reed–Solomon codes are based on the arithmetics of ﬁnite ﬁelds that are usually called
Galois ﬁelds. The mathematical concept of a ﬁeld stands for a system of numbers, where
addition and multiplication and the corresponding inverses are deﬁned and which is com-
mutative. The existence of an (multiplicative) inverse is crucial: for any ﬁeld element a,
there must exist a ﬁeld element a−1 with the property a−1a = 1. The rational numbers and
the real numbers with their familiar arithmetics are ﬁelds. The integer numbers are not,
because the (multiplicative) inverse of an integer is not an integer (except for the one).
A Galois ﬁeld GF(q) is a ﬁeld with a ﬁnite number q of elements. One can very
easily construct a Galois ﬁeld GF(q) with q = p, where p is a prime number. The GF(p)
arithmetics is then given by taking the remainder modulo p. For example, GF(7) with the
elements 0, 1, 2, 3, 4, 5, 6 is deﬁned by the addition table
+
1
2
3
4
5
6
1
2
3
4
5
6
0
2
3
4
5
6
0
1
3
4
5
6
0
1
2
4
5
6
0
1
2
3
5
6
0
1
2
3
4
6
0
1
2
3
4
5
and the multiplication table
1
2
3
4
5
6
2
4
6
1
3
5
3
6
2
5
1
4
4
1
5
2
6
3
5
3
1
6
4
2
6
5
4
3
2
1
Note that every ﬁeld element must occur exactly once in each column or row of the
multiplication table to ensure the existence of a multiplicative inverse.
A Galois ﬁeld has at least one primitive element α with the property that any nonzero
ﬁeld element can be uniquely written as a power of α. By using the multiplication table of
GF(7), we easily see that α = 5 is such a primitive element and the nonzero ﬁeld elements
can be written as powers of α in the following way
α0 = 1, α1 = 5, α2 = 4, α3 = 6, α4 = 2, α5 = 3.
We note that since α6 = α0 = 1, negative powers of α like α−2 = α4 are deﬁned as well.
We can easily visualize the multiplicative structure of GF(7) as depicted in Figure 3.18.
Each nonzero element is represented by the edge of a hexagon or the corresponding angle.
α0 has the angle zero, α1 has the angle π/3, α2 has the angle 2π/3, and so on. Obviously,

134
CHANNEL CODING
α0 = 1
α1 = 5
α2 = 4
α3 = 6
α4 = 2
α5 = 3
GF(7)
Figure 3.18 GF(7).
the multiplication of ﬁeld elements is represented by the addition of the corresponding
angles. This is the same multiplicative group structure as if we would identify α with the
complex phasor exp(j2π/N) with N = q −1. This structure leads directly to a very natural
deﬁnition of the discrete Fourier transform (DFT) for Galois ﬁelds (see below).
The primitive of GF(q) element has the property αN = 1 and thus αiN = 1 for i =
0, 1, . . . , N −1. It follows that each element αi of GF(q) is a root of the polynomial
xN −1, and we may write
xN −1 =
N−1
7
i=0

x −αi
.
Similarly,
xN −1 =
N−1
7
i=0

x −α−i
holds.
The prime number Galois ﬁelds GF(p) are of some tutorial value. Of practical relevance
are the extension ﬁelds GF(2m), where m is a positive integer. We state that a Galois ﬁeld
GF(q) exists for every q = pm, where p is prime8. Almost all practically relevant RS
codes are based on GF(28) because the ﬁeld element can be represented as bytes. We will
use the smaller ﬁeld GF(23) to explain the arithmetics of the extension ﬁelds.
The elements of an extension ﬁeld GF(pm) can be represented as polynomials of degree
m −1 over GF(p). Without going into mathematical details, we state that the primitive
element α is deﬁned as the root of a primitive polynomial. The arithmetic is then modulo
that polynomial. Note that addition and subtraction is the same in GF(2m).
We explain the arithmetic for the example GF(23). The primitive polynomial is given
by p(x) = x3 + x + 1. The primitive element α is the root of that polynomial, that is, we
can set
α3 + α + 1 ≡0.
We then write down all powers of alpha and reduce them to modulo α3 + α + 1. For
example, we may identify α3 ≡α + 1. Each element is thus given by a polynomial of
8For a proof, we refer to the text books mentioned above.

CHANNEL CODING
135
Table 3.2
Representation
of
GF(23)
dec
bin
poly
αi
0
000
0
∗
1
001
1
α0
2
010
α
α1
3
011
α + 1
α3
4
100
α2
α2
5
101
α2 + 1
α6
6
110
α2 + α
α4
7
111
α2 + α + 1
α5
degree 2 over the dual number system GF(2) and can therefore be represented by a bit
triple or a decimal number. Table 3.2 shows the equivalent representations of the elements
of GF(23). We note that for a Galois ﬁeld GF(2m), the decimal representation of the
primitive element is always given by the number 2.
The addition is simply deﬁned as the addition of polynomials, which is equivalent
to the vector addition of the bit tuples. Multiplication is deﬁned as the multiplication of
polynomials and reduction modulo α3 + α + 1. The addition table is then given by
+
1
2
3
4
5
6
7
1
0
3
2
5
4
7
6
2
3
0
1
6
7
4
5
3
2
1
0
7
6
5
4
4
5
6
7
0
1
2
3
5
4
7
6
1
0
3
2
6
7
4
5
2
3
0
1
7
6
5
4
3
2
1
0
and the multiplication table by
1
2
3
4
5
6
7
2
4
6
3
1
7
5
3
6
5
7
4
1
2
4
3
7
6
2
5
1
5
1
4
2
7
3
6
6
7
1
5
3
2
4
7
5
2
1
6
4
3
We can visualize the multiplicative structure of GF(8) as depicted in Figure 3.19. This
will lead us directly to the discrete Fourier transform that will be deﬁned in the following
subsection.
3.3.3
Construction of Reed–Solomon codes
From the communications engineering point of view, the most natural way to introduce
Reed–Solomon codes is via the DFT and general properties of polynomials.

136
CHANNEL CODING
α0 = 1
GF(8)
α1 = 2
α2 = 4
α3 = 3
α4 = 6
α5 = 7
α6 = 8
Figure 3.19 GF(8).
The discrete Fourier transforms for Galois ﬁelds
Let
A = (A0, A1, . . . , AN−1)T
be a vector of length N = q −1 with elements Ai ∈GF(q). We deﬁne the vector
a = (a0, a1, . . . , aN−1)T
of the DFT by the operation
aj =
N−1

i=0
Aiαij.
We note that the Fourier transform can be described by the multiplication of the vector A
by the DFT matrix
F =


1
1
1
· · ·
1
1
α
α2
· · ·
αN−1
1
α2
α4
· · ·
α2N−2
...
...
...
...
...
1
αN−1
α2N−2
· · ·
α(N−1)(N−1)


.
As mentioned above, the primitive element α of GF(q) has the same multiplicative
properties as exp(j2π/N) with N = q −1. Thus, this is the natural deﬁnition of the DFT
for Galois ﬁelds. We say that A is the frequency domain vector and a is the time domain
vector. The inverse discrete Fourier transform (IDFT) in GF(2m) is given by
Ai =
N−1

j=0
ajα−ij.

CHANNEL CODING
137
The proof is the same as for complex numbers, but we must use the fact that
N−1

j=0
α0 = 1
in GF(2m). For other Galois ﬁelds, a normalization factor would occur for the inverse
transform.
Any vector can be represented by a formal polynomial. For the frequency domain vector,
we may write this formal polynomial as
A(x) = A0 + A1x + · · · + AN−1xN−1.
We note that x is only a dummy variable. We add two polynomials A(x) and B(x) by adding
their coefﬁcients. If we multiply two polynomials A(x) and B(x) and take the remainder
modulo xN −1, the result is the polynomial that corresponds to the cyclic convolution of
the vectors A and B. We write
A(x)B(x) ≡A ∗B(x)
mod(xN −1).
The DFT can now simply be deﬁned by
aj = A(αj),
that is, the ith component aj of the time domain vector a can be obtained by evaluating the
frequency domain polynomial A(x) for x = αj. We write the polynomial corresponding to
the time domain vector a as
a(y) = a0 + a1y + · · · + aN−1yN−1.
Here, y is again a formal variable9. The IDFT is then given by
Ai = a(α−i).
As for the usual DFT, cyclic convolution in the time domain corresponds to elementwise
multiplication in the frequency domain and vice versa. We may write this as
A ∗B ←→a ◦b
A ◦B ←→a ∗b
in GF(2m). Here we have written a ◦b and A ◦B for the Hadamard product, that is, the
componentwise multiplication of vectors. We may deﬁne it formally as
A ◦B(x) = A0B0 + A1B1x + · · · + AN−1BN−1xN−1.
9We may call it x as well.

138
CHANNEL CODING
Frequency domain encoding
We are now ready to deﬁne Reed–Solomon in the frequency domain. As an example, we
start with the construction of the RS(7, 5, 3) code over GF(8). We want to encode K = 5
useful data symbols Ai, i = 0, 1, 2, 3, 4 to a code word of length N = 7. The polynomial
A(x) = A0 + A1x + A2x2 + A3x3 + A4x4
of degree 4 cannot have more than four zeros. Thus, aj = A(αj) cannot be zero for more
than four values of j. Then the time domain vector
a = (a0, a1, a2, a3, a4, a5, a6)T
has at least three nonzero components, that is, the weight of the vector is at least 3. The
vector a is the RS code word. The Hamming distance of that code is then given by (at
least) D = 3. Figure 3.20 shows this frequency domain encoding. The useful data are given
by the data word (2, 7, 4, 3, 6) in decimal notation, where each symbol represents a bit
triple according to Table 3.2. The code word in the frequency domain is given by
A = (2, 7, 4, 3, 6, 0, 0)T .
Redundancy has been introduced by setting two frequencies equal to zero. This guarantees
a minimum weight of three for the time domain code word, which is given by
a = (4, 6, 5, 1, 2, 3, 5)T .
0
1
2
3
4
5
6
0
2
4
6
i
Ai
RS code word (frequency domain)
0
1
2
3
4
5
6
0
2
4
6
j
aj
RS code word (time domain)
Figure 3.20 The RS(7, 5, 3) code word in the frequency domain.

CHANNEL CODING
139
A general RS(N, K, D) code over GF(q) with N = q −1 can be constructed in the
following way. We consider polynomials
A(x) = A0 + A1x + · · · + AK−1xK−1
with K useful data symbols, that is, the last N −K components Ai of the frequency domain
vector A will be set equal to zero. We perform a DFT of length N. Since A(x) has at most
K −1 zeros, aj = A(αj) can have at most K −1 zeros. In other words, there are at least
D = N −K + 1 nonzero components in the time domain code word
a = (a0, a1, . . . , aN−1)T .
Encoder and parity check
The encoder can be described by the matrix operation


a0
a1
a2
...
aN−1


=


1
1
1
· · ·
1
1
α
α2
· · ·
αK−1
1
α2
α4
· · ·
α2K−2
...
...
...
...
...
1
αN−1
α2N−2
· · ·
α(K−1)(N−1)




A0
A1
A2
...
AK−1


,
that is, the generator matrix is the matrix of the ﬁrst K columns of the DFT matrix. The
condition that the last N −K components Ai of the frequency domain vector A are equal
to zero can be written as


1
α−K
α−2K
· · ·
α−(N−1)K
1
α−(K+1)
α−2(K+1)
· · ·
α−(N−1)(K+1)
...
...
...
...
...
1
α−(N−1)
α−2(N−1)
· · ·
α−(N−1)(N−K−1)




a0
a1
a2
...
aN−1


= 0,
that is, the parity check matrix is the matrix of the last N −K rows of the IDFT matrix.
The condition Ai = a(α−i) = 0 for i = K, . . . , N −1 means that the polynomial a(x)
has zeros for x = α−K,. . . ,α−(N−1). We may thus factorize a(x) as
a(x) = q(x)
N−1
7
i=K

x −α−i
with some quotient polynomial q(x). We deﬁne the generator polynomial
g(x) =
N−1
7
i=K

x −α−i
.
The code (i.e. the set of code words) can thus equivalently be deﬁned as those polynomials
a(x) that can be written as a(x) = q(x)g(x).
We deﬁne the parity check polynomial
h(x) =
K−1
7
i=0

x −α−i
.

140
CHANNEL CODING
Obviously,
g(x)h(x) ≡0
mod(xN −1)
and the code words a(x) must fulﬁll the parity check condition
a(x)h(x) ≡0
mod(xN −1).
3.3.4
Decoding of Reed–Solomon codes
Consider an RS(N, K, D) code with odd Hamming distance D = 2t + 1. We assume that
a code word a has been transmitted, but another vector r = (r0, . . . , rN−1)T with elements
rj ∈GF(q) has been received. We write
r = a + e,
where e = (e0, . . . , eN−1)T with elements ej ∈GF(q) has is the error vector. We write
E = (E1, . . . , EN−1)T for the error in the frequency domain and E(x) for the corresponding
polynomial. We multiply the above equation by the parity check matrix. The result is the
syndrome vector


S1
S2
S3
...
S2t


=


1
α−K
α−2K
· · ·
α−(N−1)K
1
α−(K+1)
α−2(K+1)
· · ·
α−(N−1)(K+1)
...
...
...
...
...
1
α−(N−1)
α−2(N−1)
· · ·
α−(N−1)(N−K−1)




e0
e1
e2
...
eN−1


.
If the syndrome is not equal to zero, then an error has occurred. We note that the syndrome
is the vector of the last N −K = 2t components of E, that is, S1 = EK, S2 = EK+1,
S2t = EN−1. The task now is to calculate the error vector from the syndrome.
Error locations
First, we must ﬁnd the error positions, that is, the set of indices
σ = {j| ej = E(αj) ̸= 0}
corresponding to the nonzero elements of the error vector. The complement of σ is given
by
ρ = {j| ej = E(αj) = 0}.
We deﬁne the error location polynomial
C(x) =
7
j∈σ
(x −αj)
and the polynomial of error-free positions
D(x) =
7
j∈ρ
(x −αj).
By construction,
C(x)D(x) ≡0
mod(xN −1)

CHANNEL CODING
141
holds. Since ρ corresponds to the zeros of E(x), it can be factorized as E(x) = T (x)D(x)
with some polynomial T (x). It follows that
C(x)E(x) ≡0
mod(xN −1).
Assume that exactly t errors have occurred. The zeros of C(x) are then given by αjl, l =
1, . . . , t. We write
Xl = α−jl
for their inverses. The error positions are given by
jl = −logα Xl.
We now renormalize the error location polynomial in such a way that the ﬁrst coefﬁcient
equals one, that is, we deﬁne
(x) =
t7
l=1
(1 −α−jlx) =
t7
l=1
(1 −Xlx) = 0 + 1x + 2x2 + · · · + txt
with 0 = 1. Obviously, C(x) and (x) have the same zeros and
(x)E(x) ≡0
mod(xN −1)
holds, which means  ∗E = 0 for the cyclic convolution of the vectors. We may write this
componentwise as

i+j=k (mod N)
Eij = 0
∀k ∈{0, 1, 2, . . . , N −1}.
We write down the last t of these N linear equations and obtain
S1t+
S2t−1+
. . .
+St1
+St0
=
0
S2t+
S3t−1+
. . .
+St+11
+St+20
=
0
...
...
...
...
...
...
...
Stt+
St+1t−1+
. . .
+S2t−11
+S2t0
=
0
.
From 0 = 1, we obtain


S1
S2
S3
· · ·
St
S2
S3
S5
· · ·
St+1
S3
S4
S5
· · ·
St+2
...
...
...
...
...
St
St+1
St+2
· · ·
S2t−1




t
t−1
t−2
...
1


= −


St+1
St+2
St+3
...
S2t


.
This system of linear equations can be solved by matrix inversion. If less than t errors have
occurred, the matrix will be singular. In that case, the polynomial (x) will be of degree
t −1 or less. Thus, we delete the ﬁrst row and ﬁrst column of the matrix and proceed this
way until the remaining matrix is nonsingular. If the last equation S2t−11 = −S2t is still
singular (i.e. S2t−1 = 0, but the syndrome is not equal to zero), then a decoding failure has
occurred.

142
CHANNEL CODING
Once the coefﬁcients of polynomial (x) have been found, we have to ﬁnd the zeros
X−1
l
of the polynomial. This will be simply done by evaluating the polynomial for all the
N nonzero elements of GF(q). This procedure is called Chien search. If less zeros than
the degree of (x) or multiple zeros are found, then a decoding failure has occurred.
Error values
We are now ready to determine the values of the nonzero components of e. For simplicity,
we consider the case that t errors have occurred. The treatment of less errors is similar. In
the sum
Ei =
N−1

j=0
α−ijej
only those coefﬁcients with j ∈σ occur, that is,
Ei =
t
l=1
α−ijlejl =
t
l=1
Xi
lejl.
The syndrome coefﬁcients S1 = EK, S2 = EK+1, S2t = EN−1 are known. We thus have 2t
equations with t unknowns. We take only the ﬁrst t of them, which leads to the system of
linear equations given by


S1
S2
S3
...
St


=


XK
1
XK
2
XK
3
· · ·
XK
l
XK+1
1
XK+1
2
XK+1
3
· · ·
XK+1
l
XK+2
1
XK+2
2
XK+2
3
· · ·
XK+2
l
...
...
...
...
...
XK+t−1
1
XK+t−1
2
XK+t−1
3
· · ·
XK+t−1
l




ej1
ej2
ej3...
ejt


.
The Vandermonde matrix is nonsingular and can thus be inverted, which provides us with
the error vector e. The corrected code word will then be obtained as a = r −e.
3.4
Bibliographical Notes
For a more detailed treatment of channel coding, we refer to the text books (Blahut 1983;
Bossert 1999; Clark and Cain 1988; Lin and Costello 1983; Wicker 1995). A delightful in-
troduction into the conceptional ideas of channel coding can be found in the paper (Massey
1984). For a conceptional understanding of concatenated coding, we refer to the classical
paper (Forney 1966). For a conceptional understanding of convolutional codes, we refer to
(Forney 1970). It is interesting to note that this paper already described RSC encoders before
they fell into oblivion for more than 30 years until turbo codes were discovered. The Viterbi
algorithm, which is the MLSE for convolutional codes, has been developed by Viterbi
(1967), even though the author did not point out that it is really the optimum MLSE receiver
(note the word asymptotically optimum in the title of that paper). The conceptual under-
standing of the Viterbi algorithm as a MLSE receiver has been established by Forney (1973).
Punctured convolutional codes can be found in classical text books (see e.g. (Clark and Cain

CHANNEL CODING
143
1988)). For their application, see (Hagenauer 1988). The concept of log-likelihood ratios
is well established in probability theory. However, their usefulness for channel coding and
their intuitively amazing visualization has been established in great parts by Hagenauer and
coworkers (Hagenauer 1988, 1995; Hagenauer and Hoeher 1989; Hagenauer et al. 1996). It
is interesting to note that the concept of soft-output decoding introduced as BCJR algorithm
(Bahl et al. 1974) is nearly as old as the Viterbi algorithm, but seemingly it was too early
for an application at that time. A much more popular soft-output decoder was established
25 years later (Hagenauer and Hoeher 1989) as the SOVA. The ﬁrst turbo code simulations
were done with the SOVA, but the BCJR algorithm turned out to be more efﬁcient for that
application. Turbo codes were introduced a decade ago (Berrou et al. 1993), a great step to
their conceptional understanding is the paper (Hagenauer et al. 1996). RS codes have been
developed by Reed and Solomon (1960). They are treated extensively in the text books cited
above. Trellis coded modulation goes back to (Ungerboeck 1982). It is treated in the text
books cited above (see also (Biglieri et al. 1991)). An interesting overview about their appli-
cations can be found in (Wicker and Bhargava 2001). Very enlightening and recommendable
overviews about the application of channel coding for deep space communication can be
found in (Massey 1992) and (McEliece and Swanson 2001). A concatenated coding scheme
with an inner convolutional code and an outer RS code has been standardized for deep space
communications (CCSDS 1987). Improvements for the corresponding decoder by using
iterative decoding with reliability information are described in (Hagenauer et al. 2001).
3.5
Problems
1. Prove the identity
log

ex + ey
= max (x, y) + log

1 + e−|x−y|
.
2. Consider a transmission setup with four possible signals given by the columns of
the matrix
X =


1
1
−1
−1
1
−1
1
−1
1
−1
−1
1

,
which is an SPC(3, 2, 2) code with BPSK modulation. Find an example for which
the ML receiver takes a different decision for the ﬁrst bit than the MAP receiver.
3. Let f (x, y) be a function of two real variables x and y deﬁned by
f (x, y) = log
1 + exey
ex + ey

.
Show that
f (x, y) ≈sign(x)sign(y) · min(|x| , |y|)
if either |x| ≪|y| or |x| ≫|y|.


4
OFDM
4.1
General Principles
4.1.1
The concept of multicarrier transmission
Let us consider a digital transmission scheme with linear carrier modulation (e.g. M-PSK
or M-QAM) and a symbol duration denoted by TS. Let B be the occupied bandwidth.
Typically, B is of the order of T −1
S , for example, B = (1 + α)T −1
S
for raised-cosine pulses
with rolloff factor α. For a transmission channel with a delay spread τm, a reception free
of intersymbol interference (ISI) is only possible if the condition
τm ≪TS
is fulﬁlled. As a consequence, the possible bit rate Rb = log2(M)T −1
S
for a given single
carrier modulation scheme is limited by the delay spread of the channel.
The simple idea of multicarrier transmission to overcome this limitation is to split the
data stream into K substreams of lower data rate and to transmit these data substreams
on adjacent subcarriers, as depicted in Figure 4.1 for K = 8. This can be regarded as a
transmission parallel in the frequency domain, and it does not affect the total bandwidth
that is needed. Each subcarrier has a bandwidth B/K, while the symbol duration TS is
increased by a factor of K, which allows for a K times higher data rate for a given delay
spread. The factor K, however, cannot be increased arbitrarily, because too long symbol
durations make the transmission too sensitive against the time incoherence of the channel
that is related to the maximum Doppler frequency νmax (see the discussion in Section 2.2).
There, we state that the condition
νmaxTS ≪1
must be fulﬁlled. Both conditions can only be valid simultaneously if the coherency factor
κ = νmaxτm fulﬁlls the condition κ ≪1. For a given and sufﬁciently small factor κ, one
should expect that there exists a symbol duration TS that satisﬁes both requirements together
to give the best possible transmission conditions for that channel. We may then choose this
optimal symbol duration that is matched to the channel and parallelize the given data stream
in an appropriate way.
Theory and Applications of OFDM and CDMA
Henrik Schulze and Christian L¨uders
2005 John Wiley & Sons, Ltd

146
OFDM
Time
Frequency
Frequency
Time
Serial symbol duration
Parallel symbol duration
Figure 4.1 The multicarrier concept.
There are two possible ways to look at (and to implement) this idea of multicarrier
transmission. Both are equivalent with respect to their transmission properties. Even though
mathematically closely related, they differ slightly from the conceptual point of view. The
ﬁrst one emphasizes the multicarrier concept by having K individual carriers that are
modulated independently. This concept is the favorite textbook point of view. The second

OFDM
147
one is based on a ﬁlter bank of K adjacent bandpass ﬁlters that are excited by a parallel data
stream, leading to a transmission parallel in frequency. This concept is usually implemented
in practical systems.
The ﬁrst concept keeps the subcarrier frequency ﬁxed and considers the modulation in
time direction for each subcarrier. The second one keeps a time slot of length TS ﬁxed and
considers modulation in frequency direction for each time slot.
In the ﬁrst setup, the data stream is split up into K parallel substreams, and each one
is modulated on its own subcarrier at frequency fk in the complex baseband, described
by the complex harmonic wave exp(j2πfkt). We denote the complex (e.g. PSK or QAM)
modulation symbols by skl, where k is the frequency index and l is the time index. With a
baseband transmission pulse g(t), this setup can be visualized by Figure 4.2: The parallel
data stream excites replicas of the same pulse-shaping ﬁlter g(t), and the ﬁltered signals
are modulated on the different carriers and summed up before transmission. The complex
baseband signal is then given by the expression
s(t) =

k
ej2πfkt 
l
sklg(t −lTS),
(4.1)
where TS is the parallel symbol duration. To keep the notation ﬂexible, we do not specify the
domain of the summation indices. If it is convenient, the time index l may run from zero or
minus inﬁnity to inﬁnity. Since every real transmission starts and stops at some time instant,
it is more realistic to let l run from 0 to L −1, where L is an integer. The frequency index
may only run over a limited domain of, say, K different frequencies. From the mathematical
point of view, we may choose k = 0, 1, . . . , K −1. The engineer, however, would prefer
to have f0 in the middle, corresponding to DC in the complex baseband and to the center
frequency fc in the passband, with negative k for the lower sideband and positive k for the
upper sideband. For reasons of symmetry, we may then choose the number of carriers to
S/P
Σ
. . .
. . .
g(t)
g(t)
g(t)
ej2πfk−1t
ej2πfk+1t
ej2πfkt
skl
s(t)
sk−1,l
sk+1,l
skl
Figure 4.2 Block diagram for multicarrier transmission: Version 1.

148
OFDM
be K + 1, where K is an even integer, and let k = 0, ±1, ±2, . . ., ±K/2. The passband
signal is then given by
˜s(t) = ℜ
.√
2 ej2πfcts(t)
/
= ℜ
'
√
2

k
ej2π(fc+fk)t 
l
sklg(t −lTS)
(
.
For reasons due to implementation, in practical systems, the DC component will sometimes
be left empty, that is, only the subcarriers at k = ±1, ±2, . . ., ±K/2 are used.
In the second setup, we start with a base transmit pulse g(t). We obtain frequency-shifted
replicas of this pulse as
gk(t) = ej2πfktg(t),
that is, if g(t) = g0(t) is located at the frequency f = 0, then gk(t) is located at f = fk.
In contrast to the ﬁrst scheme, for each time instant l, the set of K (or K + 1) modulation
symbols is transmitted by using different pulse shapes gk(t): the parallel data stream excites
a ﬁlter bank of K (or K + 1) different bandpass ﬁlters. The ﬁlter outputs are then summed
up before transmission. This setup is depicted in Figure 4.3. The transmit signal in the
complex baseband representation is given by
s(t) =

l

k
sklgk(t −lTS).
For the domain of the summation indices k and l, the same remarks apply as for the
discussion of the ﬁrst setup. We deﬁne
gkl(t) = gk(t −lTS) = ej2πfk(t−lTS)g(t −lTS)
to get the compact expression
s(t) =

kl
sklgkl(t).
(4.2)
S/P
. . .
. . .
Σ
skl
sk−1,l
sk+1,l
gk−1(t)
gk(t)
gk+1(t)
s(t)
skl
Figure 4.3 Block diagram for multicarrier transmission: Version 2.

OFDM
149
It is obvious that we come back to the ﬁrst setup if we replace the modulation symbols skl
by skle−j2πfklTS in Equation (4.1). Such a time-frequency-dependent phase rotation does
not change the performance, so both methods can be regarded as equivalent. However,
the second – the ﬁlter bank – point of view is closer to implementation, especially for the
case of OFDM, where the ﬁlter bank is just an FFT, as it will be later. In the following
discussion, we will refer to the second point of view.
4.1.2
OFDM as multicarrier transmission
So far, nothing has been said about the shape of the base transmission pulse g(t). In
Chapter 1, we have seen that it is very convenient to have an orthogonal transmit base. It
therefore seems to be quite natural to choose the gkl(t) of Equation (4.2) in such a way
that they are orthogonal in time and frequency, that is, we require
⟨gkl, gk′l′⟩= δkk′δll′.
(4.3)
Nonorthogonal bases (e.g. Gaussian) are possible and may have interesting properties, see
for example, (Kammeyer et al. 1992). We will restrict ourselves on pulses with the property
(4.3). As discussed in depth in Chapter 1, orthogonality ensures that the modulation symbol
can be recovered from the transmit signal without ISI, that is, the detector Dkl for gkl(t)
has just the modulation symbol skl as its output:
Dkl[s] = ⟨gkl, s⟩= skl.
In principle, there are two obvious approaches to satisfy the orthogonality condition for
multicarrier transmission. We recall that two pulses are always orthogonal if they do not
overlap either in time or in frequency domain, and that a pulse cannot be strictly band
limited and time limited. Thus, we must decide on one of these two options.
The ﬁrst approach is seemingly the most straightforward one to implement the idea
of multicarrier modulation. We choose band-limited pulses that are orthogonal in time. In
Subsection 1.1.2, we deﬁned time-orthogonal Nyquist bases. The most important examples
for a strictly band-limited Nyquist base are the (square root) raised-cosine pulses. The
bandwidth B is related to the rolloff factor α by BTS = 1 + α. Let g(t) be such a pulse
that is concentrated in the frequency domain around f = 0, so that we may write g(t) =
g0(t), that is, this is the pulse corresponding to the frequency index k = 0. The pulses
g0l(t) = g0(t −lTS) with l ∈{0, ±1, ±2, . . . .} are a Nyquist base, that is, they satisfy the
orthogonality condition
⟨g0l, g0l′⟩= δll′
in the time domain. With
fk = k 1 + α
TS
,
we deﬁne
gk(t) = ej2πfktg0(t)
and
gkl(t) = gk(t −lTS).
Since these pulses are strictly separated in frequency for different k, it is obvious that the
condition (4.3) is fulﬁlled. This multicarrier modulation setup is depicted in Figure 4.4

150
OFDM
































f
f
(a)
(b)
B =
1
TS
B = 1+α
TS
Figure 4.4 Multicarrier spectrum.
for α = 0.5 and α = 0. In this ﬁgure, we have replaced the raised-cosine spectrum by a
trapezoidal one, which also corresponds to a Nyquist base. The case α = 0 corresponding
to an ideal rectangular spectral shape and sinc shaping in time domain and is spectrally
most efﬁcient, but not possible to be implemented in practice.
The second approach is to choose time-limited pulses that are orthogonal in frequency.
In the example in Subsection 1.1.3, we have already seen that the time-limited complex
exponentials of the Fourier series are such a base of time-limited orthogonal pulses. These
are just the base pulses for OFDM transmission. However, there are more choices for
time-limited orthogonal base pulses. We recall that the Nyquist base discussed in Sub-
section 1.1.3 fulﬁlls just the condition that one base pulse and its periodically time-shifted
replicas are orthogonal. Since the time and the frequency domain are mathematically equiv-
alent, we may state the same orthogonality condition in the frequency domain. Doing this,
we obtain strictly time-limited pulses gkl(t) that are orthogonal in frequency by the fol-
lowing construction: choose g(t) to be a pulse that is strictly limited to the time interval1
[−TS/2, TS/2] of duration TS in such a way that |g(t)|2 has a raised-cosine shape with
rolloff factor α. Let G(f ) be the pulse in the frequency domain. We deﬁne
fk = k 1 + α
TS
1If this is more convenient, we may use the interval [0, TS] as well.

OFDM
151
and the frequency-shifted pulse
gk(t) = ej2πfktg(t)
written in the frequency domain as
Gk(f ) = G(f −fk).
From the discussion of the Nyquist pulses (with time and frequency domain interchanged),
it follows immediately that
⟨Gk, Gk′⟩= ⟨gk, gk′⟩= δkk′.
We deﬁne
gkl(t) = gk(t −lTS).
Using the fact that these pulses are strictly separated in time for different l, it can easily be
veriﬁed that the condition (4.3) is fulﬁlled. This multicarrier modulation setup is depicted
in Figure 4.5 for α = 0. This corresponds to the Fourier bases discussed above. Note that
there is always a spectral overlap of subcarriers, but the carriers can be separated due to
their orthogonality.
In contrast to the method discussed earlier, α = 0 is possible to be implemented with a
reasonable accuracy in practical systems. Even though every orthogonal multicarrier pulse
transmission as discussed above deserves to be called OFDM (orthogonal frequency division
10
11
12
13
14
15
16
17
18
19
20
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
1.2
fT
Figure 4.5 Orthogonal overlapping spectral shapes for OFDM.

152
OFDM
multiplexing), it is indeed this case with α = 0 which is the (narrow-sense) OFDM, because
it is usually implemented. In that case, g(t) is just a rectangle over an interval of length TS,
which we choose as [0, TS] for convenience. Then fk = k/TS, and the frequency-shifted
pulses are just the Fourier base functions
gk(t) =

1
T exp

j2π k
T t


 t
T −1
2

(4.4)
over the Fourier period of length T = TS. OFDM transmission is therefore just a Fourier
synthesis for every time interval, where the information is contained in the Fourier co-
efﬁcients skl. For a receive signal r(t), the detector outputs Dk[r] = Dgk[r] at frequency
number k for l = 0 are just the results of the Fourier analysis given by
Dk[r] = ⟨gk, r⟩=

1
T
 T
0
exp

−j2π k
T t

r(t) dt,
(4.5)
which exactly recovers sk0 for the ideal transmission channel with r(t) = s(t). For any
general l, Dkl[r] = ⟨gkl, r⟩is the Fourier analyzer output for the frequency number k at the
time interval shifted by lTS. We note that for this narrow-sense OFDM the two concepts
of Figures 4.2 and 4.3 are equivalent because fk = 1/T = 1/TS holds. This property will
be lost when a guard interval is introduced (see Subsection 4.1.4).
The power density spectrum of an OFDM signal for K + 1 = 97 subcarriers is depicted
in Figure 4.6. On the linear scale, it looks very similar to a rectangular spectrum. However,
the linear scale is indeed a very ﬂattering presentation of the OFDM spectrum. Note that
–80
–60
–40
–20
0
20
40
60
80
0
0.2
(a)
(b)
0.4
0.6
0.8
1
Normalized frequency fT
Power spectrum (linear)
–80
–60
–40
–20
0
20
40
60
80
–50
–40
–30
–20
–10
0
10
Normalized frequency fT
Power spectrum [dB]
Figure 4.6 The power density spectrum of an OFDM signal on a linear scale (a) and on a
logarithmic scale (b).

OFDM
153
because of the rectangular pulse shape, at every subcarrier frequency fk = k/T , the spectral
shape is given by a sinc function. This can be seen very well at the edges of the spectrum.
These edge effects are indeed a severe item and much care must be taken for them in
practice. One usually reduces them by applying some ﬁltering or smoothing (see Subsection
4.2.1). The relative size (compared to the bandwidth) of the edge effect region becomes
smaller as the number of carriers K (or K + 1) increases. Therefore, the bandwidth needed
to transmit K complex symbols in a time slot of length T grows linearly as B ≈K/T + C
with some constant C that is due to the edge effects. Thus, ideal narrow-sense OFDM in
the limit K →∞has the same spectral efﬁciency as the ideal sinc pulse shaping in time
domain.
4.1.3
Implementation by FFT
The narrow-sense OFDM with the Fourier base is very simple to implement. If we consider
one time interval (e.g. that for l = 0), the transmit signal is given by
s(t) =
1
√
T
K/2

k=−K/2
sk exp

j2π k
T t


 t
T −1
2

.
This means that, for each time interval of length T , OFDM is just a Fourier synthesis for
that period. The perfectly synchronized receiver just performs a Fourier analysis to recover
the data symbols sk from the signal:
sk = ⟨gk, s⟩=
1
√
T
 T
0
exp

−j2π k
T t

s(t) dt.
A Fourier analysis is preferably implemented by means of a fast Fourier transform (FFT),
a synthesis by the inverse fast Fourier transform (IFFT), leading to a setup as depicted in
Figure 4.7. The stream of digitally modulated symbols skl is divided into blocks of length
K (or K + 1), discretely Fourier transformed by the IFFT, digital–analog converted and
then transmitted. The FFT length NFFT must be chosen to be signiﬁcantly larger than K
to ensure that the edge effects are neglectible at half the sampling frequency and to ensure
that the shape of the reconstruction ﬁlter of the DAC (digital-to-analog converter) does not
affect the signiﬁcant part of the spectrum. Furthermore, the alias spectra must be suppressed.
To give a concrete example, in the European DAB (Digital Audio Broadcasting) and in
the DVB-T (Digital Video Broadcasting-Terrestrial) system (EN300401 2001a; EN300744
2001b; Hoeg and Lauterbach 2003), an FFT with NFFT = 2048 is used (among other FFT
modes), and the number of modulated carriers is of the order K ≈1500 and K ≈1700,
respectively. The NFFT −K remaining spectral coefﬁcients outside the transmission band
are set to zero. At the receiver, the baseband signal will be analog-to-digital converted.
Then, for each block of NFFT samples, an FFT of that length is performed, and the K
useful coefﬁcients will be extracted from the NFFT spectral coefﬁcients.
This picture is very suggestive from a practical point of view and one feels easily
inclined to believe that it should work, because every block on the transmit site has its
corresponding inverse on the receive site, so all the data should be perfectly recovered if
every block works perfectly. Without explaining anything about orthogonality, the picture
is also suited to convince a practical engineer that the concept of OFDM should work.

154
OFDM








IFFT
FFT
DAC
ADC
s(t)
r(t)
rkl
skl
channel
Analog
Figure 4.7 OFDM implementation by FFT.
However, the concept of orthogonality is only hidden in this picture under the cover of
Fourier transform theory.
One should keep in mind that, for principal reasons, the block diagram of Figure 4.7 can
never perfectly reﬂect the setup given by the theory. This is because the ideal OFDM signal
is not strictly band limited due to the sinc shapes in the spectrum, while an analog signal
can only be perfectly represented by its samples if it is strictly band limited. However, the
problem of aliasing is a familiar one that occurs in many communications systems. For
OFDM transmission, special care must be taken because of the poor spectral decay (see
Subsection 4.2.1).
4.1.4
OFDM with guard interval
So far, we have always assumed perfect synchronization between transmitter and receiver.
In a frequency-selective multipath fading channel, synchronization mismatches are typically
of signiﬁcant order, because every echo component of the signal is a poorly synchronized
signal. As a consequence, the base pulses of the original OFDM signal and the delayed
version of the signal are no longer orthogonal. This leads to severe intersymbol interfer-
ence (ISI) in time and frequency as well because the detector output Dkl[sτ] = ⟨gkl, sτ⟩at
frequency number k and time slot l of the delayed signal sτ(t) = s(t −τ) with 0 < τ < T
has ISI contributions from pulses at all subcarrier frequencies at time slot l and l −1. This
property, which is a consequence of the loss of orthogonality due to the overlap of spec-
tral components, would seemingly disqualify narrow-sense ODFM as a useful technique
in a multipath channel. There is, however, a simple trick that modiﬁes the transmit signal
in such a way that the orthogonality is preserved in a certain manner in the presence of
multipath signal components.
The idea is to introduce a guard interval (sometimes called cyclic preﬁx). By doing
this, the symbol will be cyclically extended from the original harmonic wave of the Fourier
period T by a guard interval of length  to become a harmonic of the same frequency and
phase, but of duration TS = T + . As depicted in Figure 4.8, this means that we copy a
piece of length  from the end of the symbol and paste it in front of the signal. To express

OFDM
155
    

    

t
t
T
TS
t = 0
Figure 4.8 Introducing a guard interval.
this more formally, we replace the base pulse gk(t) as given by Equation (4.4) by a new
base pulse deﬁned by
g′
k(t) =
$
1
TS
exp

j2π k
T t


t + 
TS
−1
2

.
(4.6)
Note that the complex exponential remains exactly the same. The frequency is still fk =
k/T , and the phase is the same. Only the interval where the pulse does not vanish has been
extended from t ∈[0, T ) to t ∈[−, T ). For convenience, we have chosen the factor in
front in such a way that the energy of the pulse remains normalized to one. The transmit
signal is then given by
s(t) =

kl
sklg′
kl(t)
(4.7)
with
g′
kl(t) = g′
k(t −lTS).
(4.8)
We ﬁrst note that these transmit pulses g′
kl(t) by themselves are not pairwise orthogonal to
each others. However, at the receiver, we work with a set of orthonormal detector pulses
given by
gkl(t) = gk(t −lTS),
where the gk(t) are still the Fourier base functions for the interval of length T as deﬁned
in Equation (4.4). This means that the Fourier analysis at the receiver works with the same
analysis window of length T , but it will be performed once during the time period TS
instead of once during the time period T . As depicted in Figure 4.9, there is now a gap (or
relaxation time) of length  between two adjacent analysis windows. We will see in the
following text that it is just this gap together with the cyclically extended transmit pulse
that allows a synchronization mismatch (and therefore, also echoes) of maximal duration

156
OFDM
Fourier
window
analysis
t
(b)
(a)
t
T
TS
Figure 4.9 OFDM with guard interval: (a) Transmit pulses (b) Detector pulses.
τ = , corresponding to a shift to the right of the signal in part (a) of Figure 4.9. The
output of the detector for gkl(t), given that the pulse g′
k′l′(t) has been transmitted, is

gkl, g′
k′l′

=
$
T
TS
δkk′δll′.
This means that the transmit base pulses gkl(t) and the detector base pulses g′
k′l′(t) are
orthogonal unless both the time and the frequency index are identical. Note that if they
are identical the output does not take the value 1 but the smaller value √T /TS. This can
be understood as a waste of energy by transmitting a part of the symbol (i.e. the guard
interval) that is not used for detection.
Now let g′
kl,τ(t) = g′
kl(t −τ) with 0 < τ <  denote a base pulse delayed by τ. By
writing down the corresponding integral, we easily see that

gkl, g′
k′l′,τ

=
$
T
TS
e−j2πfkτ δkk′δll′.
(4.9)
This means that – as long τ <  holds – the orthogonality between the transmit and detect
pulses for different indices is still preserved, and the detector output for the same index
is only affected by a frequency-dependent phase factor. Now, let s(t) be an OFDM signal
given by Equation (4.7) and let r(t) = s(t −τ) with 0 < τ <  be the receive signal,
which is just a delayed version of that signal. From the above equation and Equation (4.7),
we obtain
⟨gkl, r⟩=
$
T
TS
e−j2πfkτ skl,
that is, the transmit symbol skl is recovered without ISI, but only rotated by the phase factor.
This phase factor cancels out for differential demodulation. For coherent demodulation, it
must be determined by the channel estimation.

OFDM
157
c2e−j2πfkτ2
c1e−j2πfkτ1
Hk = c1e−j2πfkτ1 + c2e−j2πfkτ2
Figure 4.10 Signal plus echo.
If the received signal is the superposition of two delayed versions of the transmitted
signal, that is, given by r(t) = c1s(t −τ1) + c2s(t −τ2) with some complex constants c1
and c2, then skl will again be recovered without ISI if their delays do not exceed the guard
interval. But they will be affected by a complex multiplicative factor Hk = c1e−j2πfkτ1 +
c2e−j2πfkτ2, which is the superposition of the phasors corresponding to the two echo paths
(see Figure 4.10). The detector output is then given by
Dkl[r] = ⟨gkl, r⟩=
$
T
TS
Hk skl.
For a superposition of N such echo paths, we obtain the same expression with Hk given
by
Hk =
N

n=1
cne−j2πfkτn.
We now assume a time-variant channel given by a time-variant impulse response h(τ, t).
We assume that h(τ, t) = 0 for τ < 0 and for τ > . The corresponding time-variant
transfer function H(f, t) is then given by
H(f, t) =
 
0
e−j2πf τh(τ, t) dτ.
The receive signal without noise is given by
r(t) =
 
0
h(τ, t)s(t −τ) dτ.
We further assume that the channel is slowly time-variant so that it can be approximated to
be time independent during the time slot number l, that is, H(f, t) ≈Hl(f ) and h(τ, t) ≈
hl(τ) with
Hl(f ) =
 
0
e−j2πf τhl(τ) dτ
during the OFDM symbol number l of length TS. We now calculate the detector output for
a base pulse transmitted over that channel, which is formally given by
Dkl[hl′ ∗g′
k′l′] =

gkl, hl′ ∗g′
k′l′

.

158
OFDM
This is the twofold integral
Dkl[hl ∗g′
k′l′] =
 T
0
dt g∗
kl(t)
 
0
dτ hl′(τ)g′
k′l′(t −τ)
with the ﬁrst integral corresponding to the scalar product and the second one corresponding
to the convolution. We change the order of integration and obtain
Dkl[hl ∗g′
k′l′] =
 
0
dτ hl′(τ)
 T
0
dt g∗
kl(t)g′
k′l′(t −τ).
The second integral is just ⟨gkl, g′
k′l′,τ⟩. From Equation (4.9) we get
Dkl[hl ∗g′
k′l′] =
 
0
dτ hl′(τ)
$
T
TS
e−j2πfkτ δkk′δll′
that is,
Dkl[hl ∗g′
k′l′] =
$
T
TS
Hl(fk) δkk′δll′.
The detector output at time l and frequency k for the noise-free receive signal r(t) is then
given by
⟨gkl, r⟩=
$
T
TS
Hl(fk) skl.
(4.10)
We deﬁne rkl = ⟨gkl, r⟩and ckl = Hl(fk). Then, the OFDM transmission with guard interval
in a noisy slowly fading channel can be described by the discrete channel model
rkl =
$
T
TS
cklskl + nkl,
(4.11)
where nkl is discrete complex AWGN with variance σ 2 = E

|nkl|2
= N0. This is just
the same as the discrete-time multiplicative fading channel that has been analyzed in
Section 2.4, but with an additional second index for the frequency. The fading ampli-
tude ckl is typically modeled as Rayleigh or Ricean fading. We assume a channel transfer
power normalized to one, that is, E

|ckl|2
= 1. Note the factor √T /TS, which means that
there is an energy loss in performance because a part of the signal available at the receiver
is not evaluated. All Euclidean distance in the expressions for error probabilities will be
lowered by that factor, that is,
1
2 erfc
#$
1
N0

kl
|ckl|2 |skl −ˆskl|2
%
must be replaced by
1
2 erfc
#$
1
N0
T
TS

kl
|ckl|2 |skl −ˆskl|2
%

OFDM
159
and thus all performance curves as functions of Eb/N0 or ES/N0 have to be shifted by
10 log10 (T /TS) decibels to the right. For the typical value T /TS = 0.8, this loss is approx-
imately 1 dB. Because the base pulses g′
kl(t) are normalized according to
&&g′
kl
&&2 = 1, we
still have ES = E

|skl|2
, and the SNR,
SNR =
E
 )))

T
TS sklckl
)))
2!
E
|nkl|2
at the receiver is given by
SNR = T
TS
· ES
N0
= T
TS
· Rc log2(M)Eb
N0
(4.12)
for a modulation with log2(M) bits per complex symbol and a code rate of Rc. This means
that the performance curves as a function of the SNR will be left unchanged by the guard
interval.
We summarize and add the following remarks:
• The time period of length T in Figure 4.9 that is used for the Fourier analysis at
the detector will be called the Fourier analysis window. The spacing between two
adjacent subcarriers is given by f = fk −fk−1 = T −1.
• TS = T +  is the symbol period for each subcarrier. Thus, for each ﬁxed index k,
the symbol rate of the transmit symbols skl is given by T −1
S .
• In contrast to OFDM without guard interval, the two concepts of Figures 4.2 and 4.3
are not equivalent because fk = 1/T ̸= 1/TS. The FFT implementation of OFDM
corresponds to that of Figure 4.3. To switch to the concept of Figure 4.2, we must
multiply each modulation symbol skl by e−j2πklT/TS. As there is no advantage in
doing that, it is not implemented in any real system.
• The part of the signal transmitted during each time period TS is called an OFDM
symbol2. Each OFDM symbol corresponds to a number of K transmit symbols skl.
Thus, the total symbol rate is given by RS = K T −1
S . Ignoring any other overhead
(e.g. for synchronization), the useful bit rate is Rb = K · Rc log2(M)T −1
S , where we
have assumed that M-PSK or M-QAM with code rate Rc is used for modulation and
channel coding.
• The FFT length N is typically (but not necessarily) given by the smallest power
of two that satisﬁes K < N. For example, the so-called 2k mode of the DVB-T
system has K + 1 = 1705, so N = 2048 is the smallest possible FFT length (which
explains the name of the mode). However, one could also use an (I)FFT with N =
4096 for the Fourier analysis or synthesis. Such an oversampling may be useful for
several purposes (see Subsection 4.2.1). Note that the FFT length is an implementation
parameter for transmitter and receiver and it is not relevant for the description of the
OFDM signal in the air.
2Here we have adopted the terminology used in the speciﬁcation of the European DAB system.

160
OFDM
4.2
Implementation and Signal Processing
Aspects for OFDM
4.2.1
Spectral shaping for OFDM systems
In this subsection, we will discuss the implementation aspects that are related to the
spectral properties of OFDM. We consider an OFDM system with subcarriers at fre-
quency positions in the complex baseband given by fk = k/T with frequency index k ∈
{0, ±1, ±2, . . ., ±K/2}. As already discussed in Subsection 4.1.2, the subcarrier pulses in
the frequency domain are shaped like sinc functions that superpose to a seemingly rectan-
gular spectrum located between −K/T and +K/T . However, as depicted in Figure 4.6,
there is a severe out-of-band radiation outside this main lobe of the OFDM spectrum caused
by the poor decay of the sinc function. That ﬁgure shows the spectrum of an OFDM signal
without guard interval. The guard interval slightly modiﬁes the spectral shape by intro-
ducing ripples into the main lobe and reducing the ripples in the side lobe. However, the
statements about the poor decay remain valid. Figure 4.11 shows such an OFDM spectrum
with K = 96. Here and in the following discussion, the guard interval length  = T /4 has
been chosen.
The number of subcarriers has a great inﬂuence on the decrease of the sidelobes.
For a given main lobe bandwidth B = K/T , the spectrum of each individual subcar-
rier – including its side lobes – becomes narrower with increasing K. As a consequence,
–80
–60
–40
–20
0
20
40
60
80
0
0.5
(a)
(b)
1
1.5
Normalized frequency fT
Power spectrum (linear)
–80
–60
–40
–20
0
20
40
60
80
–50
–40
–30
–20
–10
0
10
Normalized frequency fT
Power spectrum [dB]
Figure 4.11
The power density spectrum of an OFDM signal with guard interval on a
linear scale (a) and on a logarithmic scale (b).

OFDM
161
–40
–20
0
20
40
–50
–40
–30
–20
–10
0
10
Normalized frequency fT
Power spectrum [dB]
K = 48
–100
0
100
–50
–40
–30
–20
–10
0
10
Normalized frequency fT
Power spectrum [dB]
K = 192
–200
0
200
–50
–40
–30
–20
–10
0
10
Normalized frequency fT
Power spectrum [dB]
K = 384
–1000
0
1000
–50
–40
–30
–20
–10
0
10
Normalized frequency fT
Power spectrum [dB]
K = 1536
Figure 4.12 The power density spectra of an OFDM for K = 48, 96, 384, 1536.
the side lobes of the complete OFDM spectrum show a steeper decay and the spec-
trum comes closer to a rectangular shape. Figure 4.12 shows the OFDM spectra for K =
48, 192, 384, 1536. But, even for a high number of K, the decay may still not be sufﬁcient
to fulﬁll the network planning requirements. These are especially strict for broadcasting
systems, where side lobe reduction in the order of −70 dB are mandatory. In that case,
appropriate steps must be taken to reduce the out-of-band radiation.
We note that the spectra shown in the ﬁgures correspond to continuous OFDM signals3.
Digital-to-analog conversion
In practice, discrete-time OFDM signals will be generated by an inverse discrete (fast)
Fourier transform and then processed by a digital-to-analog converter (DAC). It is well
known from signal processing theory that a discrete-time signal has a periodic spectrum
from which the analog signal has to be reconstructed at the DAC by a low-pass ﬁlter
(LPF) that suppresses these aliasing spectra beyond half the sampling frequency fs/2.
Figure 4.13(a) shows the periodic spectrum of a discrete OFDM signal with K = 96 and
an FFT length N = 128, which is the lowest possible value for that number of subcarriers.
The LPF must be ﬂat inside the main lobe (i.e. for |f | ≤48/T ) and the side lobe must
decay steeply enough so that the alias spectra at |f | ≥80/T will be suppressed. This
analog ﬁlter is always a complexity item. It is a common practice to use oversampling
3The spectra shown above are computer simulations and not measurements of a continuous OFDM signal.
However, the signal becomes quasi-continuous if the sampling rate is chosen to be high enough.

162
OFDM
0
50
100
150
200
250
300
350
400
450
500
–50
–40
–30
–20
(a)
(b)
–10
0
10
Normalized frequency fT
Power spectrum (linear)
0
50
100
150
200
250
300
350
400
450
500
–50
–40
–30
–20
–10
0
10
Normalized frequency fT
Power spectrum (linear)
LPF
LPF
Figure 4.13 The periodic power density spectra of a discrete OFDM signal for K = 96
and FFT length N = 128 (a) and FFT length N = 512 (b).
to move complexity from the analog to the digital part of the system. Oversampling can
be implemented by using a higher FFT length and padding zeros at the unused carrier
positions4. Figure 4.13(b) shows the discrete spectrum for the same OFDM parameters
with fourfold oversampling, that is, N = 4 · 128 = 512 and fs/2 = 256/T . Now the main
lobe of the next alias spectrum starts at |f | = 464/T and the requirements to the steepness
of the LPF can be signiﬁcantly reduced.
We ﬁnally note that since the signal is not strictly band limited, any ﬁltering will always
hurt the useful signal in some way because the sidelobes are a part of the signal, even though
not the most signiﬁcant.
Reduction of the out-of-band radiation
For a practical system, network planning aspects require a certain spectral mask that must
not be exceeded by the implementation. Typically, this spectrum mask deﬁned by the spec-
iﬁcation tells the maximal allowed out-of-band radiation at a given frequency. Figure 4.14
shows an example of such a spectrum mask similar to the one that is used for a wire-
less LAN system. The frequency is normalized with respect to the main lobe bandwidth
B = K/T , that is, the main lobe is located between the normalized frequencies −0.5 and
+0.5. We note that such a spectrum mask for a wireless LAN system is relatively loose
compared, for example, to those for terrestrial broadcast systems like DAB and DVB-T.
4Alternatively, one may use the smallest possible FFT together with a commercially available oversampling
circuit. This will be the typical implementation in a real system.

OFDM
163
0
0.5
1
–0.5
–1
Normalized frequency
–40 dB
–28 dB
–20 dB
0 dB
Figure 4.14
Example for the spectrum mask of an OFDM system as a function of the
normalized bandwidth f/B.
To fulﬁll the requirements of a spectrum mask, it is often necessary to reduce the
sidelobes. This can be implemented by – preferably digital – ﬁltering.
As an example, we use a digital Butterworth ﬁlter to reduce the sidelobes of an OFDM
signal with K = 96 and N = 512 (fourfold oversampling). To avoid signiﬁcant attenuation
or group delay distortion inside the main lobe, we choose a 3 dB ﬁlter bandwidth f3 dB =
64/T . For this ﬁlter bandwidth, the amplitude is approximately ﬂat and the phase is nearly
linear within the main lobe. Figure 4.15 shows the OFDM spectrum ﬁltered by a digital
Butterworth ﬁlter of 5th and 10th order. As an example, let us assume that the spacing
between two such OFDM signals inside a frequency band is 128/T , that is, the lowest
possible sampling frequency. Then, the main lobe of the next OFDM signal would begin
at (±) 80/T . The out-of-band radiation at this frequency is reduced from −30 to −41 dB
for the 5th order ﬁlter and to −52 dB for the 10th order ﬁlter.
One must keep in mind that any ﬁltering will inﬂuence the signal. The rectangular pulse
shape of each OFDM subcarrier will be smoothened and broadened by the convolution with
the ﬁlter impulse response. The guard interval usually absorbs the resulting ISI, but this
reduces the capability of the system to cope with physical echoes. Thus, the effective length
of the guard interval will be reduced. Figure 4.16 shows the respective impulse responses of
both ﬁlters that we have used. We recall that for N = 512, the guard interval is N/4 = 128
samples long. The ﬁlter impulse responses reduce the effective guard interval length by
10–20%.
Instead of low-pass ﬁltering, one may also form the spectral shape by smoothing the
shape of the rectangular subcarrier pulse. This can be done as described in the following
text. We ﬁrst cyclically extend the OFDM symbol at the end by δ to obtain a harmonic
wave of symbol length TS + δ. We then choose a smoothing window that is equal to one
for − + δ < t < T and decreases smoothly to zero outside that interval (see Figure 4.17).
The (cyclically extended) OFDM signal will then be multiplied by this window. The signal
remains unchanged within − + δ < t < T , that is, the effective guard interval will be

164
OFDM
–80
–60
–40
–20
0
20
40
60
80
–80
–70
–60
–50
–40
–30
–20
–10
0
10
Normalized frequency fT
Power spectrum [dB]
5th
10th
Figure 4.15 OFDM spectrum ﬁltered by a digital Butterworth ﬁlter of 5th and 10th order.
0
5
10
15
20
25
30
35
40
–0.1
0
0.1
(a)
(b)
0.2
0.3
Sample number
Amplitude
0
5
10
15
20
25
30
35
40
–0.2
–0.1
0
0.1
0.2
0.3
Sample number
Amplitude
Figure 4.16 Impulse response of the digital Butterworth ﬁlter of 5th (a) and 10th (b) order.

OFDM
165
0
T T + δ
t
−
Figure 4.17 Smoothing window for the OFDM symbol.
–80
–60
–40
–20
0
20
40
60
80
–80
–70
–60
–50
–40
–30
–20
–10
0
10
Normalized frequency fT
Power spectrum [dB]
d = 0
d = ∆/16
d = ∆/8
d = ∆/4
Figure 4.18 OFDM spectrum for a smoothened subcarrier pulse shape.
reduced by δ. We choose a raised-cosine pulse shape (Schmidt 2001). For the digital
implementation, the ﬂanks are just the increasing and decreasing ﬂanks of a discrete Hanning
window. Figure 4.18 shows the OFDM spectra for δ = 0, /16, /8, /4. The out-of-
band power reduction is similar to that of digital ﬁltering.
We ﬁnally show the efﬁciency of the windowing method for an OFDM signal with a
high number of carriers. Figure 4.19 shows the OFDM spectra for K = 1536 and δ = 0,
/16, /8, /4. We note a very steep decay for the out-of-band radiation. Even a small
reduction of the guard interval is enough to fulﬁll the requirements of a broadcasting
system5. Similar results can be achieved by digital ﬁltering. However, this would require
higher-order ﬁlters with more computational complexity and a smaller 3 dB bandwidth.
Thus, the method of pulse shape smoothing seems to be the better choice.
5The DAB system with K = 1536 requires a −71 dB attenuation at f T = 970 for the most critical cases.

166
OFDM
–1500
–1000
–500
0
500
1000
1500
–80
–70
–60
–50
–40
–30
–20
–10
0
10
Normalized frequency fT
Power spectrum [dB]
d = 0
d = ∆/16
d = ∆/8
d = ∆/4
Figure 4.19 OFDM spectrum for a smoothened subcarrier pulse shape (K = 1536).
4.2.2
Sensitivity of OFDM signals against nonlinearities
As we have already seen, OFDM signals in the frequency domain look very similar to band-
limited white noise. The same is true in the time domain. Figure 4.20 shows the inphase
component I (t) = ℜ{s(t)}, the quadrature component Q(t) = ℑ{s(t)} and the amplitude
|s(t)| of an OFDM signal with subcarriers at frequency positions in the complex baseband
given by fk = k/T with k ∈{0, ±1, ±2, . . . , ±K/2} and K = 96 and the guard interval
length  = T /4. We will further use these OFDM parameters in the following discussion.
Because the inphase and the quadrature component the OFDM are superpositions of
many sinoids with random phases, one can argue from the central limit theorem that both
are Gaussian random processes. A normplot is an appropriate method to test whether
the samples of a signal follow Gaussian statistics. To do this, one has to plot the (mea-
sured) probability that a sample is smaller than a certain value as a function of that value.
The probability values are then scaled in such a way that a Gaussian normal distribution
corresponds to a straight line. Figure 4.21 shows such a normplot for the OFDM signal
under consideration. We note that the measurements ﬁt quite well to the straight line that
corresponds to the Gaussian normal distribution. However, there are deviations for high
amplitudes. This is due to the fact that the number of subcarriers is not very high (K = 96)
and the maximum amplitude of their superposition cannot exceed a certain value. For an
increasing number of subcarriers, the measurements follow closely the straight line. For
a lower value of K, the agreement becomes poorer. The crest factor Cs = Ps,max/Ps,av is
deﬁned as the ratio (usually given in decibels) between the maximum signal power Ps,max
and the average signal power Ps,av. With K →∞, the amplitude of an OFDM signal is

OFDM
167
0
0.5
1
1.5
2
2.5
3
3.5
4
–2
0
(a)
(b)
(c)
2
t/TS
0
0.5
1
1.5
2
2.5
3
3.5
4
t/TS
0
0.5
1
1.5
2
2.5
3
3.5
4
t/TS
I(t)
 –2
0
2
Q(t)
0
1
2
3
Amplitude
Figure 4.20 The inphase component I (t) (a), the quadrature component Q(t) (b) and the
amplitude (c) of an OFDM signal of average power one.
–3
–2.5
–2
–1.5
–1
–0.5
0
0.5
1
1.5
2
0.001
0.003
0.01
0.02
0.05
0.10
0.25
0.50
0.75
0.90
0.95
0.98
0.99
0.997
0.999
Samples of I(t)
Probability
Figure 4.21 Normal probability plot for the inphase component I (t) of an OFDM signal.

168
OFDM
0
0.5
1
1.5
2
2.5
3
3.5
4
0
5000
10,000
15,000
Amplitude
Number of samples
Figure 4.22 Histogram for the amplitude of an OFDM signal.
a Gaussian random variable and the crest factor becomes inﬁnity. Even for a ﬁnite (high)
number of subcarriers, the crest factor is so high that it does not make sense to use it
to characterize the signal. This is because the probability of extremely high-power values
decreases exponentially with increasing power.
As discussed in detail in Chapter 3, a normal distribution for the I and Q component
of a signal leads to a Rayleigh distribution for the signal amplitude. Figure 4.22 shows the
histogram for the amplitude of the OFDM signal under consideration.
We now consider an OFDM complex baseband signal
s(t) = a(t)ejϕ(t)
with amplitude a(t) and phase ϕ(t) that passes a nonlinear ampliﬁer with power saturation
as depicted in Figure 4.23. For low values of the input power, the output power grows
approximately linear. For intermediate values, the output power falls below that linear
growth and it runs into a saturation as the input power grows higher. In addition to that
smooth nonlinear ampliﬁer, we consider a clipping ampliﬁer. This ampliﬁer is linear as long
as the input power is smaller than a certain value Pin,max corresponding to the maximum
output power Pout,max. If the input exceeds Pin,max, the output will be clipped to Pout,max.
As depicted in Figure 4.23, for any nonlinear ampliﬁer with power saturation, there is a
uniquely deﬁned clipping ampliﬁer with the same linear growth for small input amplitudes
and the same saturation (maximum output). For an input signal with average power Ps,av,
the input backoff IBO = Pin,max/Ps,av is deﬁned as the ratio (usually given in decibels)
between the power Pin,max and the average signal power Ps,av.
The nonlinear ampliﬁer output in the complex baseband model is given by
r(t) = F (a(t)) ej(ϕ(t)+	(a(t)))

OFDM
169
IBO
Input power
Output power
Clipping
amplifier
Nonlinear amplifier
Signal power
Maximum output
Figure 4.23 Characteristic curves for nonlinear ampliﬁers with power saturation.
(see (Benedetto and Biglieri 1999)). The real-valued function F(x) is the characteristic
curve for the amplitude distortion, and the real-valued function 	 (x) describes the phase
distortion caused by the nonlinear ampliﬁer.
To see how nonlinearities inﬂuence an OFDM signal, we consider a very simple char-
acteristic curve F(x) that is approximately linear for small values of x and runs into a
saturation for x →∞. Such a behavior can be modeled by the characteristic curve (nor-
malized to Pin,max = Pout,max = 1) given by the function
Fexp(x) = 1 −e−x.
For x →∞, the curve runs exponentially into the saturation Fexp(x) →1. For small values
of x, we can expand into the Taylor series
Fexp(x) = x −1
2!x2 + 1
3!x3 −1
4!x4 ± · · ·
and observe a linear growth for small values of x. The clipping ampliﬁer is given by the
characteristic curve
Fclip(x) = min (x, 1) ,
which is linear for x < 1 and equal to 1 for higher values of x. For simplicity, we do not
consider phase distortions.
In Figure 4.24, we see an OFDM time signal and the corresponding ampliﬁer output
for the smooth nonlinear ampliﬁer corresponding to Fexp(x) and for the clipping ampliﬁer
corresponding to Fclip(x) for an IBO of 6 dB. The average OFDM signal power is normal-
ized to one. Thus, an IBO of 6 dB means that all amplitudes with a(t) > 2 are clipped in
part (c) of that ﬁgure.
The nonlinearity severely inﬂuences the spectral characteristics of an OFDM signal. As
can be seen from the Taylor series for Fexp(x), mixing products of second, third and higher
order occur for every subcarrier and for every pair of subcarriers. These mixing products

170
OFDM
0
0.5
1
1.5
2
2.5
3
3.5
4
0
1
(a)
(b)
(c)
2
3
t/TS
0
0.5
1
1.5
2
2.5
3
3.5
4
t/TS
0
0.5
1
1.5
2
2.5
3
3.5
4
t/TS
Amplitude
0
1
2
3
Amplitude
0
1
2
3
Amplitude
Figure 4.24 Amplitude of an OFDM signal (a) after a smooth nonlinear (b) and a clipping
(c) ampliﬁer with IBO = 6 dB.
corrupt the signal inside the main lobe and they will cause out-of-band radiation. This must
not be confused with the out-of-band radiation discussed in the preceding subsection, which
is caused by the rectangular pulse shape. To distinguish between these two things, we use
the spectral smoothing by a raised-cosine window as described in the preceding subsection.
We choose δ = /4 to achieve a very fast decay of the side lobes. Figure 4.25 shows the
OFDM signal corrupted by the ampliﬁer corresponding to Fexp(x) for an IBO of 3 dB, 9 dB
and 15 dB. As expected, there is a severe out-of-band radiation, and a very high IBO is
necessary to reduce this radiation. Note that we have renormalized all the ampliﬁer output
signals to the same average power in order to draw all the curves in the same picture.
Figure 4.26 shows the OFDM signal corrupted by the ampliﬁer corresponding to Fclip(x)
for an IBO of 3 dB, 6 dB and 9 dB. We observe that, compared to the other ampliﬁer, we
need much less IBO to reduce the out-of-band radiation.
Inside the main lobe, the useful signal is corrupted by the mixing products between
all subcarriers. Simulations of the bit error rate would be necessary to evaluate the per-
formance degradations for a given OFDM system and a given ampliﬁer for the concrete
modulation and coding scheme. For a given modulation scheme, the disturbances caused
by the nonlinearities can be visualized by the constellation diagram in the signal space.
Figure 4.27 shows the constellation of a 16-QAM signal for both ampliﬁers and the IBO
values as given above. For the IBO of 3 dB, the QAM signal is severely distorted for
both ampliﬁers. For the clipping ampliﬁer, the distortion soon becomes smaller as the IBO
increases. For the other ampliﬁer, much more IBO is necessary to reduce the disturbance.
This is what we may expect by looking at the spectra.

OFDM
171
–80
–60
–40
–20
0
20
40
60
80
–50
–40
–30
–20
–10
0
10
Normalized frequency fT
Power spectrum [dB]
IBO = 3 dB
IBO = 9 dB
Linear
IBO = 15 dB
Figure 4.25 Spectrum of an OFDM signal with a (smooth exponential) nonlinear ampliﬁer.
–80
–60
–40
–20
0
20
40
60
80
–50
–40
–30
–20
–10
0
10
Normalized frequency f T
Power spectrum [dB]
IBO = 3 dB
IBO = 6 dB
IBO = 9 dB
Linear
Figure 4.26 Spectrum of an OFDM signal with a (clipping) nonlinear ampliﬁer.

172
OFDM
–4
–2
0
2
4
–4
–2
0
2
4
I
(a)
(b)
–4
–2
0
2
4
I
–4
–2
0
2
4
I
–4
–2
0
2
4
I
–4
–2
0
2
4
I
–4
–2
0
2
4
I
Q
–4
–2
0
2
4
Q
–4
–2
0
2
4
Q
–4
–2
0
2
4
Q
IBO = 3 dB, amp = exp
–4
–2
0
2
4
Q
IBO = 9 dB, amp = exp
–4
–2
0
2
4
Q
IBO = 15 dB, amp = exp
IBO = 3 dB, amp = clip
IBO = 6 dB, amp = clip
IBO = 9 dB, amp = clip
Figure 4.27 The 16-QAM constellation diagram of an OFDM signal with a smooth expo-
nential (a) and a clipping (b) nonlinear ampliﬁer.
Figure 4.27 gives the impression that the QAM symbols are corrupted by an additive
noise-like signal. The spectra of Figures 4.25 and 4.26 agree with the picture of an additive
noise ﬂoor that corrupts the signal. At least for the smooth ampliﬁer with a character-
istic curve Fexp(x) given by a Taylor series, one can heuristically argue as follows. The
quadratic, cubic and higher-order terms cause mixing products of the subcarriers that inter-
fere additively with the useful signal. Each subcarrier is affected by many mixing produces
of other subcarriers. Thus, there is an additive disturbance that is the sum of many random
variables. By using the central limit theorem, we can argue that this additive disturbance is
a Gaussian random variable for the inphase and the quadrature component of the 16-QAM
constellation diagram. Figure 4.28 shows the normplots of the error signal (samples of the
real and imaginary parts) for the smooth exponential ampliﬁer for the three IBO values.
The samples ﬁt well to the straight line, which conﬁrms the heuristic argument given
above. We have also investigated the spectral properties of this interfering signal and found
that it shows a white spectrum. Thus, the interference can be modeled as AWGN and can
be analyzed by known methods (see Problem 2).
Figure 4.29 shows the normplots of the error signal for the clipping ampliﬁer. Only for
3 dB, the statistics error signal seems to follow a normal distribution. For higher values of
the IBO, there are severe deviations.
One can argue that the performance degradations caused by the interference can be
neglected if the signal-to-interference ratio (SIR) is signiﬁcantly higher than the signal-to-
noise ratio (SNR). We have calculated the SIR for several values of the IBO. The results
are depicted in Figure 4.30 . We ﬁnd a rapid growth of the SIR as a function of the
IBO for the clipping ampliﬁer. For an IBO above approximately 6 dB, the SIR can be

OFDM
173
–0.4
–0.2
0
0.2
0.001
0.003
0.01
0.02
0.05
0.10
0.25
0.50
0.75
0.90
0.95
0.98
0.99
0.997
0.999
0.001
0.003
0.01
0.02
0.05
0.10
0.25
0.50
0.75
0.90
0.95
0.98
0.99
0.997
0.999
0.001
0.003
0.01
0.02
0.05
0.10
0.25
0.50
0.75
0.90
0.95
0.98
0.99
0.997
0.999
Interferer samples
Probability
IBO = 3 dB, SIR = 19 dB, 
 amp = exp
–0.2
0
0.2
Interferer samples
IBO = 9 dB, SIR = 24.1 dB, 
 amp = exp
–0.1
0
0.1
Interferer samples
IBO = 15 dB, SIR = 29.7 dB, 
amp = exp
Figure 4.28 Normal probability plot of the 16-QAM error signal for a smooth exponential
nonlinear ampliﬁer.
–0.2
0
0.2
0.001
0.003
0.01
0.02
0.05
0.10
0.25
0.50
0.75
0.90
0.95
0.98
0.99
0.997
0.999
0.001
0.003
0.01
0.02
0.05
0.10
0.25
0.50
0.75
0.90
0.95
0.98
0.99
0.997
0.999
0.001
0.003
0.01
0.02
0.05
0.10
0.25
0.50
0.75
0.90
0.95
0.98
0.99
0.997
0.999
Interferer samples
Probability
IBO = 3 dB, SIR = 19.5 dB,
amp = clip
–0.1
0
0.1
Interferer samples
IBO = 6 dB, SIR = 30.1 dB,
amp = clip
0.02
0
0.02
Interferer samples
IBO = 9 dB, SIR = 52.3 dB,
amp = clip
Figure 4.29 Normal probability plot of the 16-QAM error signal for a clipping ampliﬁer.

174
OFDM
0
5
10
15
20
25
30
35
40
10
15
20
25
30
35
40
45
50
55
60
IBO [dB]
SIR [dB]
exp
clip
Figure 4.30 The SIR for the 16-QAM symbol for OFDM signal with a smooth exponential
and a clipping nonlinear ampliﬁer.
practically neglected. For the smooth exponential ampliﬁer, the SIR increases very slowly
as an approximately linear function at IBO values above 10 dB. One must increase the IBO
by a factor of 10 for an SIR increase approximately by a factor of 10.
We summarize and add the following remarks:
• OFDM systems are much more sensitive against nonlinearities than single carrier
systems. The nonlinearities of a power ampliﬁer degrade the BER (bit error rate)
performance and inﬂate the out-of-band radiation. The performance degradations will
typically be the less severe problem because most communication systems work at an
SNR well below 20 dB, while the SIR will typically be beyond that value. However,
a high IBO value may be necessary to fulﬁll the requirements of a given spectral
mask. As a consequence, the power ampliﬁer will then work with a poor efﬁciency.
In certain cases, it may be necessary to reduce the out-band radiation by using a ﬁlter
after the power ampliﬁer.
• There are several methods to reduce the crest factor of an OFDM signal by modifying
the signal in a certain way (see (Schmidt 2001) and references therein). However,
these methods are typically incompatible to existing standards and cannot be applied
in those OFDM systems.
• Preferably one should separate the problem of nonlinearities and the OFDM signal
processing. This can be done by a predistortion of the signal before ampliﬁcation.

OFDM
175
Analog and digital implementations are possible. After OFDM was chosen as
the transmission scheme for several communication standards, there has been a
considerable progress in this ﬁeld (see (Banelli and Baruffa 2001; D’Andrea et al.
1996) and references therein).
4.3
Synchronization and Channel Estimation Aspects
for OFDM Systems
4.3.1
Time and frequency synchronization for OFDM systems
There are some special aspects that make synchronization for OFDM systems very different
from that for single carrier systems. OFDM splits up the data stream into a high number
of subcarriers. Each of them has a low data rate and a long symbol duration TS. This
is the original intention for using multicarrier modulation, as it makes the system more
robust against echoes. Consequently, the system also becomes more robust against time
synchronization errors that can also be absorbed by the guard interval of length  = TS −T .
A typical choice is  = TS/5 = T /4 which allows a big symbol timing uncertainty of 20%
in case of no physical echoes. In practice, there will appear a superposition of timing
uncertainty and physical echoes.
On the other hand, because the subcarrier spacing T −1 is typically much smaller than the
total bandwidth, frequency synchronization becomes more difﬁcult. Consider, for example,
an OFDM system working at the center frequency fc = 1500 MHz with T = 500 ms. The
ratio between carrier spacing and center frequency is then given by (fcT )−1 = 1.33 · 10−9,
which is a very high demand for the accuracy of the downconversion to the complex
baseband.
Once the correct Fourier analysis window is found by an appropriate time synchroniza-
tion mechanism and the downconversion is carried out with sufﬁcient accuracy, the OFDM
demodulator (implemented by the FFT) produces the noisy receive symbols given by the
discrete channel
rkl =
$
T
TS
cklskl + nkl
(see Subsection 4.1.4). The amplitudes and phases of the channel coefﬁcients ckl are still
unknown. The knowledge of the channel is not required for systems with differential de-
modulation. For coherent demodulation, the channel estimation is a different task that
has to be done after time and frequency synchronization. In this subsection, we focus
our attention on time and frequency synchronization and follow (in parts) the discussion
presented by Schmidt (2001). Channel estimation will be discussed in the subsequent sub-
sections.
When speaking of frequency synchronization items for OFDM, there often appears
some misunderstanding because for single carrier PSK systems there is a joint frequency
and phase synchronization that can be realized, for example, by a squaring loop or a Costas
loop (see e.g. (Proakis 2001)). As mentioned above, frequency synchronization and phase
estimation are quite different tasks for OFDM systems.

176
OFDM
Time synchronization
An obvious way to obtain time synchronization is to introduce a kind of time stamp into the
seemingly irregular and noise-like OFDM time signal. The EU147 DAB system – which
can be regarded as the pioneer OFDM system – uses quite a simple method that even
allows for traditional analog techniques to be used for a coarse time synchronization. At
the beginning of each transmission frame, the signal will be set to zero for the duration of
(approximately) one OFDM symbol. This null symbol can be detected by a classical analog
envelope detector (which may also be digitally realized) and tells the receiver where the
frame and where the ﬁrst OFDM symbol begin.
A more sophisticated time stamp can be introduced by periodically repeating a certain
known OFDM reference symbol of known content. The subcarriers should be modulated
with known complex symbols of equal amplitude to have a white frequency spectrum and
a δ-type cyclic time autocorrelation function. Thus, as long as the echoes do not exceed
the length of the guard interval, the channel impulse response can be measured by cross
correlating the received and the transmitted reference symbol.
In the DAB system, the ﬁrst OFDM symbol after the null symbol is such a reference
symbol. It has the normal OFDM symbol duration TS and is called the TFPR (time-
frequency-phase reference) symbol. It is also used for frequency synchronization (see the
following text) and it provides the phase references for the beginning of the differential
demodulation. We note that the channel estimate provided by the TFPR symbol is only
needed for the positioning of the Fourier analysis window, not for coherent demodulation.
In the wireless LAN systems IEEE 802.11a and HIPERLAN/2, a reference OFDM
symbol of length 2TS is used for time synchronization and for the estimation of the channel
coefﬁcients ckl that are needed for coherent demodulation. The OFDM subcarriers are
modulated with known data. The signal of length T resulting from the Fourier synthesis
will then be cyclically extended to twice the length of the other OFDM symbols.
Another smart method to ﬁnd the time synchronization without any time stamp is based
on the guard interval. We note that an OFDM signal with guard interval has a regular
structure because the cyclically extended part of the signal occurs twice in every OFDM
symbol of duration TS – this means that the OFDM signal s(t) given has the property
s(t) = s(t + T )
for lTS − < t < lTS (l integer), that is, the beginning and the end of each OFDM symbol
are identical (see Figure 4.31). We may thus correlate s(t) with s(t + T ) by using a sliding
    

    

    

    

lTS −
t
lTS
lTS + T
(l + 1)TS
= (l + 1)TS −
Figure 4.31 Identical parts of the OFDM symbol.

OFDM
177
correlation analysis window of length , that is, we calculate the correlator output signal
y(t) = −1
 t
t−
ℜ

s(τ)s∗(τ + T )

dτ.
This correlator output can be considered as a sliding average given by the convolution
y(t) = h(t) ∗x(t).
Here,
h(t) = −1
 t
 −1
2

is the (normalized) rectangle between t = 0 and t = , and
x(t) = ℜ

s(τ)s∗(τ + T )

is the function to be averaged. The signal y(t) has peaks at t = lTS, that is, at the beginning
of the analysis window for each symbol, (see Figure 4.32(a)). Because of the statistical
nature of the OFDM signal, the correlator output is not strictly periodic, but it shows some
ﬂuctuations. But it is not necessary to place the analysis window for every OFDM symbol.
Only the relative position is relevant and it must be updated from time to time. Thus, we
may average over several OFDM symbols to obtain a more regular symbol synchronization
signal (see Figure 4.32(b)). This averaging also reduces the impairments due to noise. In a
mobile radio environment, the signal in Figure 4.32 is smeared out because of the impulse
response of the channel. It is a nontrivial task to ﬁnd the optimal position of the Fourier
analysis window. This may be aided by using the results of the channel estimation.
0
(a)
(b)
2
4
6
8
10
12
14
16
18
20
−0.5
0
0.5
1
1.5
t/TS
Correlator output
−0.2
−0.1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
−0.5
0
0.5
1
1.5
t/TS
Averaged correlator output
Figure 4.32 The correlator output y(t) (a) and the average of it over 20 OFDM symbols (b).

178
OFDM
Frequency synchronization
Because the spacing T −1 between adjacent subcarriers is typically very small, accurate
frequency synchronization is an important item for OFDM systems. Such a high accu-
racy can usually not be provided by the local oscillator itself. Standard frequency-tracking
mechanisms can be applied if measurements of the frequency deviation δf are available.
First, we want to discuss what happens to an OFDM system if there is a residual
frequency offset δf that has not been corrected. There are two effects:
1. The orthogonality between transmit and receive pulses will be corrupted.
2. There is a time-variant phase rotation of the receive symbols.
The latter effect occurs for any digital transmission system, but the ﬁrst is a special OFDM
item that can be understood as follows. Using the notation introduced in Subsection 4.1.4,
we write
s(t) =

kl
sklg′
kl(t)
for the transmitted OFDM signal that is modulated, for example, with complex QAM
symbols skl. Here, k and l are the time and frequency indices, respectively. We assume
a noise-free channel with a time variance that describes the frequency shift. The receive
signal is then given by
r(t) = ej2πδf ts(t).
To study the ﬁrst effect, we consider only the ﬁrst OFDM symbol and drop the correspond-
ing time index l = 0. The detector for the subcarrier at frequency fk = k/T is given by
the Fourier analysis operation
Dk[r] = ⟨gk, r⟩=
 ∞
−∞
g∗
k(t)r(t) dt =

1
T
 T
0
e−j2πfkt r(t) dt.
Because of the orthogonality

gk, g′
k′

=
$
T
TS
δkk′
between the transmit and receive base pulses, the Fourier analysis detector recovers the
undisturbed QAM symbols from the original transmit symbol, that is,
Dk[s] = sk.
The frequency offset, however, corrupts the orthogonality, leading to the detector output
Dk[r] =
$
T
TS

m
γkm(δf ) sm
with
γkm(δf ) =
 ∞
−∞
g∗
k(t)gm(t)ej2πδf t dt.

OFDM
179
Typically, for small frequency offsets with δ = δf · T ≪1, the term with k = m dominates
the sum, but all the other terms contribute and cause intersymbol interference that must be
regarded as an additive disturbance to the QAM symbol.
We now consider an OFDM signal with running time index l = 0, 1, 2, . . .. The fre-
quency shift that is given by the multiplication with exp (j2πδf t) means that the QAM
symbols skl are rotated by a phase angle 2πδf · TS between the OFDM symbols with time
indices l and l + 1. Figure 4.33 shows a 16-QAM constellation affected by that rotation
and the additive disturbance. The OFDM parameters are the same as above, and a small
frequency offset given by δ = δf · T = 0.01 is chosen.
In the discrete channel model, the phase rotation can be regarded as the time variance
of the channel, that is, the channel coefﬁcient shows the proportionality
ckl ∝ej2πδf TSl.
In a coherent system with channel estimation, this time variance can be measured and the
QAM constellation will be back rotated. Part (a) of Figure 4.34 shows the back-rotated
16-QAM constellation for δ = 0.01, δ = 0.02 and δ = 0.05. The additive disturbances look
similar to Gaussian noise. Indeed, a statistical analysis with a normplot ﬁts well to a
Gaussian normal distribution (see part (b) of Figure 4.34. One can therefore argue that the
frequency is accurate enough if the SIR of the residual additive disturbance (after frequency
tracking) is signiﬁcantly below the SNR where the system is supposed to work. The latter
can be obtained from the BER performance curves of the channel coding and modulation
scheme.
−5
−4
−3
−2
−1
0
1
2
3
4
5
−4
−3
−2
−1
0
1
2
3
4
I
Q
Figure 4.33 16-QAM for OFDM with frequency offset given by δ = δf · T = 0.01.

180
OFDM
−4
−2
0
2
4
−4
−2
0
2
4
I
Q
δ = 0.01 , SIR = 32.7 dB
 0.05
0
0.05
0.001
0.003
0.01
0.02
0.05
0.10
0.25
0.50
0.75
0.90
0.95
0.98
0.99
0.997
0.999
Interferer samples
Probability
−4
−2
0
2
4
−4
−2
0
2
4
I
Q
δ = 0.02 , SIR = 27.5 dB
−0.1
−0.05
0
0.05
0.001
0.003
0.01
0.02
0.05
0.10
0.25
0.50
0.75
0.90
0.95
0.98
0.99
0.997
0.999
Interferer samples
−4
−2
0
2
4
−4
−2
0
2
4
I
Q
δ = 0.05 , SIR = 20.8 dB
−0.2
−0.1
0
0.1
0.001
0.003
0.01
0.02
0.05
0.10
0.25
0.50
0.75
0.90
0.95
0.98
0.99
0.997
0.999
Interferer samples
Figure 4.34 16-QAM for OFDM with frequency offset given by δ = δf · T = 0.01.
As pointed out above, an estimate for δf can be obtained from the estimated channel
coefﬁcients ˆckl. This can be done by frequency demodulation and averaging. The frequency
demodulation can be implemented as follows. We note that for any complex time signal
z(t) = a(t)ejϕ(t)
with amplitude a(t) and phase ϕ(t), the time derivative of the phase can be calculated as
(see Problem 3)
˙ϕ(t) = ℑ
 ˙z(t)
z(t)
!
,
where the dot denotes the time derivative. The instantaneous frequency modulation (FM)
is then given by
fM(t) = 1
2π ˙ϕ(t) = 1
2π ℑ
 ˙z(t)
z(t)
!
.
For a discrete-time signal z[n] = z(nts) that has been obtained by sampling z(t) with the
sampling frequency fs = t−1
s , the time discrete FM is
fM[n] =
1
2πts
ℑ
 z[n] −z[n −1]
z[n]
!
.
For an OFDM system with channel estimation as discussed in the next subsection, a noisy
estimate ˆckl of the channel coefﬁcient ckl is obtained for every OFDM symbol of duration
TS at a frequency position k. The estimated instantaneous frequency deviation for time
index l is then
<
δf kl =
1
2πTS
ℑ
 ˆckl −ˆck l−1
ˆckl
!
.

OFDM
181
This noisy instantaneous estimate of the frequency deviation has to be averaged over a
sufﬁciently large number of OFDM symbols and over the frequency index k. This average
<
δf may then be used to obtain a frequency-shift-corrected receive signal
ˆr(t) = e−j2π <
δf tr(t).
In a typical mobile radio channel with Doppler spread, the time variance of the channel
will introduce an additional frequency modulation. The averaging of the FM will place the
Doppler spectrum in such a way that its ﬁrst moment vanishes. In the WSSUS model, the
Doppler spectrum is the same for every subcarrier frequency. Thus, an accurate estimate for
the frequency offset and for the Doppler spectrum can be obtained from the measurements
at a certain number of subcarrier positions (at least one). It is a common method applied
in the DVB-T system and the wireless LAN systems IEEE 802.11a and HIPERLAN/2 to
use certain subcarriers as continuous pilots. These subcarriers that are boosted by a certain
factor and carry known data will be used for frequency synchronization and estimation of
the Doppler bandwidth νmax. The latter will be needed for the channel estimation by Wiener
ﬁltering, as discussed in the next subsection. The Doppler spectrum can be estimated from
the continuous pilots (after frequency-shift correction) by standard power spectral density
estimation methods.
Wireless LAN systems require a very fast frequency synchronization at the beginning
of every burst. For this purpose, a special OFDM symbol at the beginning of the burst
has been deﬁned. In this OFDM symbol, only 12 subcarriers are modulated to serve as a
frequency reference.
An accurate frequency synchronization is also necessary for OFDM systems with dif-
ferential demodulation. The EU147 DAB system uses DQPSK. The ﬁrst symbol in every
frame (after the null symbol) serves as the phase reference for the differential modulation
and as a reference for time and frequency synchronization. The complex symbols are built
from CAZAC (constant amplitude zero autocorrelation) sequences. They allow a frequency
offset estimation by correlating in frequency direction.
4.3.2
OFDM with pilot symbols for channel estimation
Coherent demodulation requires the knowledge of the channel, that is, of the coefﬁcients ckl
in the discrete-time model for OFDM transmission in a fading channel. The two-dimensional
structure of the OFDM signal makes a two-dimensional pilot grid especially attractive for
channel measurement and estimation. An example of such a grid is depicted in Figure 4.35.
These pilots are usually called scattered pilots to distinguish them from the continuous pilots
discussed in the preceding subsection.
At certain positions in time and frequency, the modulation symbols skl will be replaced
by known pilot symbols. At these positions, the channel can be measured. Figure 4.35
shows a rectangular grid with pilot symbols at every third frequency and every fourth time
slot. The pilot density is thus 1/12, that is, 1/12 of the whole capacity is used for channel
estimation. This lowers not only the data rate, but also the available energy Eb per bit.
Both must be taken into account in the evaluation of the spectral and the power efﬁciency
of such a system.
The density of the grid has to be matched to the incoherency of the channel, that is, to
the time-frequency ﬂuctuations described by the scattering function. To illustrate this by a

182
OFDM
Time
Frequency
4TS
3f
Figure 4.35 Example of a rectangular pilot grid.
numerical example, we consider the grid of Figure 4.35 for an OFDM system with carrier
spacing f = 1/T = 1 kHz and symbol duration TS = 1250 µs. At every third frequency,
the channel will be measured once in the time 4TS = 5 ms, that is, the unknown signal
(the time-variant channel) is sampled at the sampling frequency of 200 Hz. For a noise-free
channel, we can conclude from the sampling theorem that the signal can be recovered from
the samples if the maximum Doppler frequency νmax fulﬁlls the condition
νmax < 100 Hz.
More generally, for a pilot spacing of 4TS, the condition
νmaxTS < 1/8
must be fulﬁlled.
In frequency direction, the sample spacing is 3 kHz. From the (frequency domain)
sampling theorem, we conclude that the delay power spectrum must be inside an interval
of the length of 333 µs. Since the guard interval already has the length 250 µs, this condition
is automatically fulﬁlled if we can assume that all the echoes lie within the guard interval.
We can now start the interpolation (according to the sampling theorem) either in time
or in frequency direction and then calculate the interpolated values for the other direction.
Simpler interpolations are possible and may be used in practice for a very coherent channel,
for example, linear interpolation or piecewise constant approximation. However, for a really
time-variant and frequency-selective channel, these methods are not adequate. For a noisy
channel, even the interpolation given by the sampling theorem is not the best choice because
the noise is not taken into account. The optimum linear estimator will be derived in the
next subsection.
In some systems, the pilot symbols are boosted, that is, they are transmitted with a
higher energy than the modulation symbols. In that case, a rectangular grid as shown in

OFDM
183
Time
Frequency
4TS
3f
Figure 4.36 Example of a diagonal pilot grid.
Figure 4.35 would cause a higher average power for every fourth OFDM symbol, which is
not desirable for reasons of transmitter implementation. In that case, a diagonal grid will
be chosen. Figure 4.36 shows such a diagonal grid as it is used for the DVB-T system.
4.3.3
The Wiener estimator
Consider a complex discrete stochastic process with samples yl that have to be estimated.
For our application, we think of the complex fading amplitudes of a discrete channel model.
Recall that in Section 4.1.4 we derived a discrete channel model for OFDM that could be
written as
rkl =
$
T
TS
cklskl + nkl.
Here, ckl is the complex fading amplitude of the time-frequency discrete channel model with
frequency index k and time index l. This is a stochastic process in two dimensions. We may
keep either the time index or the frequency index ﬁxed and consider only one dimension. For
the treatment of the two-dimensional stochastic process, we may rearrange the numbering
similar to a parallel–serial conversion so that one can work with only one index. This
makes the formalism more clear. The samples yl of the process under consideration must
be estimated from measurements xm that are samples of another stochastic process. For our
application, these processes are closely related: the xm are the noisy channel measurements
at the pilot positions. We look for a linear estimator, that is, we assume that the estimates
ˆyl of the process yl can be written as
ˆyl =

m
blmxm
(4.13)

184
OFDM
with properly chosen estimator coefﬁcients blm. The sum can be ﬁnite or inﬁnite. To simplify
the formalism, we assume that only a ﬁnite number of L samples yl must be estimated
from a ﬁnite number M of measurements xm. We may then write the linear estimator as
ˆy = Bx
(4.14)
with the vectors ˆy = ( ˆy1, . . . , ˆyL)T and x = (x1, . . . , xM)T and the estimator matrix
B =


b11
b12
· · ·
b1M
b21
b22
· · ·
b2M
...
...
...
...
bL1
bL2
· · ·
bLM

.
Let el = yl −ˆyl be the error of the estimate for the sample number l. The ansatz of the
Wiener estimator is to minimize the mean square error (MMSE) for each sample, that is,
E

|el|2
= min .
The orthogonality principle (or projection theorem) of probability theory (Papoulis 1991;
Therrien 1992) says that this is equivalent to the orthogonality condition
E

elx∗
m

= 0.
(4.15)
This orthogonality principle becomes intuitively clear and it can easily be visualized by
means of the vector space structure of random variables. Then E

elx∗
m

is the scalar product
of the random variables (vectors) el and xm, and E{|el|2} = E{|yl −ˆyl|2} is the squared
distance between the vectors yl and ˆyl. Equation (4.13) says that ˆyl lies in the plane that is
spanned by the random variables (vectors) x1, . . . , xl. Then, as depicted in Figure 4.37, this
distance (length of the error vector) becomes minimal if ˆyl is just the orthogonal projection
of yl on that plane. In that case, el = yl −ˆyl is orthogonal to every vector xm, that is,
Equation (4.15) holds.
It is convenient to write Equation (4.15) in vector notation as
E

e · x†
= 0,
el
yl
ˆyl
Figure 4.37 Illustration of the orthogonality principle.

OFDM
185
that is, the L × M cross-correlation matrix between the error vector e = (e1, . . . , eM)T and
the vector of measurements x = (x1, . . . , xM)T vanishes. Writing e = y −ˆy, we obtain
E

(y −ˆy) · x†
= 0,
and, employing Equation (4.14)
E

y · x†
= E

Bx · x†
.
This Wiener–Hopf equation can be written as
Ryx = BRxx,
(4.16)
where
Rxx = E

x · x†
(4.17)
denotes the autocorrelation matrix of x and
Ryx = E

y · x†
(4.18)
the cross-correlation matrix between y and x. The Wiener–Hopf equation can be solved by
matrix inversion, that is,
B = RyxR−1
xx .
Estimation error
The estimation error of a linear predictor can be derived as follows. We deﬁne a mean
square error (MSE) matrix E by
E = E

e · e†
= E

(y −ˆy) · (y −ˆy)†
.
The diagonal elements E

|el|2
of that matrix are the MSE for the estimates. For the linear
estimator of Equation (4.14), we get
E = E

(y −Bx) · (y −Bx)†
and
E = E

y · y† −Bx · y† −y · (Bx)† + Bx · (Bx)†
.
With Equations (4.17) and (4.18) we get
E = Ryy −BR†
yx −

Ryx −BRxx

B†.
This is the general expression for any linear estimator B. If B is the solution of the
Wiener–Hopf equation, the expression in parentheses vanishes and we get the MMSE
error matrix
E = Ryy −BR†
yx.

186
OFDM
4.3.4
Wiener ﬁltering for OFDM
For our application, the stochastic process corresponds to the complex fading amplitudes
at certain times and frequencies, that is,
yi = H(fi, ti),
where H(f, t) is the time-variant channel transfer function, see Section 4.1.4. If only chan-
nel estimation in time direction is required (at a given frequency), all the values of fi are
identical. If only channel estimation in frequency direction is required (at a given time),
all the values of ti are identical. But, in general, we have to deal with an arbitrary set of
points in the time-frequency plane. The measurements will be taken at some pilot positions
given by

fim, tim
M
m=1. The measurements xm are noisy channel samples, that is,
xm = H

fim, tim

+ ni,
where ni is complex AWGN with variance σ 2 = ES/N0 and ES is the energy of the pilot
symbols. As discussed in detail in Chapter 2, we assume the WSSUS model for H(f, t)
with two-dimensional autocorrelation function
E

H(f, t)H ∗(f ′, t′)

= R(f −f ′, t −t′).
We assume that the noise and the fading are statistically independent. Then the matrix
elements of Rxx are given by
(Rxx)km = R

fik −fim, tik −tim

+ δkmσ 2,
(4.19)
and the matrix elements of Ryx are

Ryx

lm = R

fl −fim, tl −tim

.
(4.20)
Channel estimation in time direction
Consider a ﬁxed carrier of an OFDM signal. In that case, all the frequency samples are equal
to the subcarrier frequency fk and we only have to deal with samples of the multiplicative
fading process c(t) = H(fk, t) for that frequency. This wide-sense stationary process has
the autocorrelation function
R(0, t) = Rc(t),
which is given as the inverse Fourier transform of the Doppler spectrum. For the Jakes
spectrum, it is given by
Rc(t) = J0 (2πνmaxt) .
For a rectangular Doppler spectrum between −νmax and νmax, it is given by
Rc(t) = sinc (2νmaxt) .
For some applications, the Gaussian Doppler spectrum
Sc(ν) =
1

2πσ 2
D
exp

−1
2σ 2
D
ν2


OFDM
187
of width σD is an appropriate model. It has the autocorrelation function
Rc(t) = exp

−1
2 (2πσDt)2

.
The autocorrelation matrix Rxx is given by the elements
(Rxx)km = Rc

tik −tim

+ δkmσ 2.
The matrix elements of the cross correlation Ryx are given by

Ryx

lm = R

tl −tim

.
To give a concrete example, we assume that every fourth symbol in time direction is a
pilot symbol, as it is the case for DVB-T for certain subcarrier frequencies. The channel
at the positions in between and at the pilot positions itself must be estimated from the
channel measurements taken at these pilot positions. In practice, only a ﬁnite number of
measurements can be used. We illustrate the channel estimation for the case that channel
measurements are taken at the ﬁve positions t = −8TS, −4TS, 0, +4TS, +8TS for the esti-
mation at the four positions t = 0, TS, 2TS, 3TS. This corresponds to the grid as depicted in
Figure 4.35 or Figure 4.36 at a frequency where pilots are located. Note that measurements
are taken at ﬁve adjacent pilot positions to estimate the channel at four adjacent time slots.
One of them is the pilot position in the middle and the other three are those between this
pilot and the next one. Obviously, this is a noncausal estimator, that is, a delay has to be
taken into account. The measurements are given by the random vector
x =
 c (−8TS)
c (−4TS)
c (0)
c (4TS)
c (8TS) T + n,
where n is a vector of ﬁve AWGN samples, each with variance σ 2. The random vector to
be estimated is given by
y =
 c (0)
c (TS)
c (2TS)
c (3TS) T ,
and the autocorrelation matrix is given by
Rxx =


Rc (0) + σ 2
Rc (4TS)
Rc (8TS)
Rc (12TS)
Rc (16TS)
Rc (−4TS)
Rc (0) + σ 2
Rc (4TS)
Rc (8TS)
Rc (12TS)
Rc (−8TS)
Rc (−4TS)
Rc (0) + σ 2
Rc (4TS)
Rc (8TS)
Rc (−12TS)
Rc (−8TS)
Rc (−4TS)
Rc (0) + σ 2
Rc (4TS)
Rc (−16TS)
Rc (−12TS)
Rc (−8TS)
Rc (−4TS)
Rc (0) + σ 2


.
We note that the additive SNR term σ 2 on the diagonal ensures that the matrix is nonsingu-
lar. We will see in Subsection 4.4.3 that the eigenvalues of this matrix for σ 2 = 0 represent
the diversity branches of the equivalent independent fading channel. It may happen (and
is often the case in practice) that the channel does not have the full diversity degree. This
corresponds to a singular matrix. To ensure that Rxx can be inverted, one should always
set σ 2 > 0. In practice, a very rough estimate of the noise is sufﬁcient. For example, one
can iteratively improve the noise estimate by comparing the measured channel values at

188
OFDM
the pilot position with their estimates. One starts that procedure with some reasonable SNR
value, where the system will typically work.
The cross-correlation matrix is given by
Ryx =


Rc (8TS)
Rc (4TS)
Rc (0)
Rc (−4TS)
Rc (−8TS)
Rc (9TS)
Rc (5TS)
Rc (TS)
Rc (−3TS)
Rc (−7TS)
Rc (10TS)
Rc (6TS)
Rc (2TS)
Rc (−2TS)
Rc (−6TS)
Rc (11TS)
Rc (7TS)
Rc (3TS)
Rc (−TS)
Rc (−5TS)

.
The estimator matrix
B = RyxR−1
xx
has the shape
B =


b11
b12
b13
b14
b15
b21
b22
b23
b24
b25
b31
b32
b33
b34
b35
b41
b42
b43
b44
b45

.
Now, denote the noisy channels measurements by the vector
x =
 ˜c (−8TS)
˜c (−4TS)
˜c (0)
˜c (4TS)
˜c (8TS)
T
and the estimates by the vector
ˆy =
 ˆc (0)
ˆc (TS)
ˆc (2TS)
ˆc (3TS)
T .
Then, the estimator is given by


ˆc (0)
ˆc (TS)
ˆc (2TS)
ˆc (3TS)

=


b11
b12
b13
b14
b15
b21
b22
b23
b24
b25
b31
b32
b33
b34
b35
b41
b42
b43
b44
b45




˜c (−8TS)
˜c (−4TS)
˜c (0)
˜c (4TS)
˜c (8TS)


.
Since the random process c(t) is wide-sense stationary and the pilot positions are periodic
with period 4TS, any time shift of the whole setup by 4iTS, i = 1, 2, 3, . . . result in the
same estimator, that is,


ˆc (4iTS)
ˆc ((4i + 1) TS)
ˆc ((4i + 2) TS)
ˆc ((4i + 3) TS)

=


b11
b12
b13
b14
b15
b21
b22
b23
b24
b25
b31
b32
b33
b34
b35
b41
b42
b43
b44
b45




˜c (4 (i −2) TS)
˜c (4 (i −1) TS)
˜c (4iTS)
˜c (4 (i + 1) TS)
˜c (4 (i + 2) TS)


.
The estimate can now be interpreted as the convolution of the measurements with the
left–right ﬂipped columns of the estimator matrix. To see this, we deﬁne the four discrete-
time signals
ˆcl [i] = ˆc ((4i + l) TS) , l = 0, 1, 2, 3
for the estimates and the discrete-time signal
˜c [m] = ˜c (4mTS)

OFDM
189
for the measurements. We deﬁne four impulse responses bl[m], l = 0, 1, 2, 3 of the esti-
mator by rewriting the estimator matrix as
B =


b0 [2]
b0 [1]
b0 [0]
b0 [−1]
b0 [−2]
b1 [2]
b1 [1]
b1 [0]
b1 [−1]
b1 [−2]
b2 [2]
b2 [1]
b2 [0]
b2 [−1]
b2 [−2]
b3 [2]
b3 [1]
b3 [0]
b3 [−1]
b3 [−2]

.
The estimator can now be written as the noncausal ﬁltering
ˆcl [i] =
2

m=−2
bl[m]˜c [i −m]
of the measurements.
To keep the treatment more easy, we have chosen a small ﬁlter with a ﬁxed number
of ﬁve taps. The generalization to more taps is straightforward. In practice, a ﬁgure in the
order of 20 taps is a reasonable choice.
Channel estimation in frequency direction
We now consider the time slot of a ﬁxed OFDM symbol. In that case, all the time sam-
ples are equal and we only have to deal with frequency samples of the transfer function.
This uncorrelated scattering (i.e. frequency-shift invariant) process H(f ) has the frequency
autocorrelation function
R(f, 0) = RH(f ),
which is given as the Fourier transform of the delay power spectrum. For the exponential
delay power spectrum, we have
RH(f ) =
1
1 + j2πf τm
.
For a rectangular delay power spectrum between 0 and τmax, it is given by
RH(f ) = e−jπf τmax · sinc (f τmax) .
The autocorrelation matrix Rxx has the elements
(Rxx)km = RH

fik −fim

+ δkmσ 2,
and the cross-correlation matrix Ryx has the elements

Ryx

lm = RH

fl −fim

.
Again, we consider a concrete example that is inspired by the pilot structure of DVB-T.
We assume that every third symbol in frequency direction is a pilot symbol. The channel at
the positions in between and at the pilot positions itself must be estimated from the channel
measurements taken at these pilot positions. We assume that channel measurements are
taken at the ﬁve positions f = −6f, −3f, 0, +3f, +6f for the estimation at the
four positions f = 0, f, 2f, 3f. Here f = 1/T is the OFDM carrier spacing, and

190
OFDM
f = 0 corresponds to the center frequency. The measurements are given by the random
vector
x =
H (−6f )
H (−2f )
H (0)
H (2f )
H (6f )T + n,
where n is a vector of ﬁve AWGN samples with variance σ 2. The random vector to be
estimated is
y =
H (0)
H (f )
H (2f )
T .
For the autocorrelation matrix, we have
Rxx =


RH (0) + σ 2
RH (3f )
RH (6f )
RH (9f )
RH (12f )
RH (−3f )
RH (0) + σ 2
RH (3f )
RH (6f )
RH (9f )
RH (−6f )
RH (−3f )
RH (0) + σ 2
RH (3f )
RH (6f )
RH (−9f )
RH (−6f )
RH (−3f )
RH (0) + σ 2
RH (3f )
RH (−12f )
RH (−9f )
RH (−6f )
RH (−3f )
RH (0) + σ 2


,
and the cross-correlation matrix is given by
Ryx =


RH (6f )
RH (3f )
RH (0)
RH (−3f )
RH (−6f )
RH (7f )
RH (4f )
RH (f )
RH (−2f )
RH (−5f )
RH (8f )
RH (5f )
RH (2f )
RH (−f )
RH (−4f )

.
The estimator matrix
B = RyxR−1
xx
has the shape
B =


b11
b12
b13
b14
b15
b21
b22
b23
b24
b25
b31
b32
b33
b34
b35

.
Now, denote the noisy channel measurements by the vector
x =
 ˜H (−6f )
˜H (−3f )
˜H (0)
˜H (3f )
˜H (6f )
T
and the estimates by the vector
ˆy =
 ˆH (0)
ˆH (f )
ˆH (2f )
T .
Then, the estimator is given by


ˆH (0)
ˆH (f )
ˆH (2f )

=


b11
b12
b13
b14
b15
b21
b22
b23
b24
b25
b31
b32
b33
b34
b35




˜H (−6f )
˜H (−3f )
˜H (0)
˜H (3f )
˜H (6f )


.
Since the random process H(f ) is uncorrelated scattering (i.e. wide-sense stationary in
frequency direction) and the pilot positions are periodic with period 3f, any frequency
shift by 3i/T, i = 0, ±1, ±2, . . . of the whole setup will result into the same estimator.

OFDM
191
Then, we can use the same arguments as for the estimation in time direction to show that
the estimate can be interpreted as the convolution of the measurements with the left–right
ﬂipped columns of the estimator matrix. We deﬁne the three (frequency-) discrete signals
ˆHl [i] = ˆH ((3i + l) f ) , l = 0, 1, 2
for the estimates and the discrete signal
˜H [m] = ˜H (3mTS)
for the measurements. We deﬁne three impulse responses bl[m], (l = 0, 1, 2) of the esti-
mator by rewriting the estimator matrix as
B =


b0 [2]
b0 [1]
b0 [0]
b0 [−1]
b0 [−2]
b1 [2]
b1 [1]
b1 [0]
b1 [−1]
b1 [−2]
b2 [2]
b2 [1]
b2 [0]
b2 [−1]
b2 [−2]

.
The estimator can now be written as the noncausal ﬁltering
ˆHl [i] =
2

m=−2
bl[m] ˜H [i −m]
of the measurements.
Even though this ﬁltering in the frequency domain is formally the same as ﬁltering
in the time domain, there is an essential difference in practice. One can easily think of
an inﬁnite time duration of the transmission, but the frequency domain is always hard
limited by the signal bandwidth, corresponding to a ﬁnite number of OFDM subcarriers.
This number may be quite small (approximately 50 for WLAN systems or approximately
200 for DRM) or large (more than 6000 for the 8K mode for DVB-T). In any case, there
will be edge effects. At both edges, there are some measurements not available because
there are no pilots outside the band. If one ignores these terms in the sum, it will severely
degrade the performance. This is especially severe for a low number of carriers. For WLAN
systems and a ﬁlter of approximately length 10, the channel estimation would be correct
for only approximately 40 subcarriers. Especially for higher-level QAM modulation, this
results in an unacceptable error, even for a high number of subcarriers. To cope with this,
the estimator must be modiﬁed at the edges. It is not a convolution there, but a matrix
estimator that makes use of, for example, the 20 closest available pilots.
In contrast to time domain estimation, the estimation in frequency domain is always
a problem with a ﬁnite number of measurements and a ﬁnite number of estimates. It is
therefore worth considering the use of the full matrix estimator to solve this problem. This
needs more processor power, but it provides us with the optimal MMSE estimate for the
given number of measurements that are available.
In that case, the matrix elements of Rxx are calculated for all pairs of pilot positions
fik, fim as
(Rxx)km = RH

fik −fim

+ δkmσ 2
and the matrix elements of Ryx as

Ryx

lm = RH

fl −fim

,

192
OFDM
where the fl are the positions of the estimates. The estimator matrix
B = RyxR−1
xx
then has as much columns as there are pilot positions and as many rows as there are estimate
positions.
Channel estimation in time and frequency direction
In most situations, a channel estimation has to be performed both in time and frequency
direction. In that case, the full autocorrelation matrix according to Equation (4.19) and
the cross correlation according to Equation (4.20) must be calculated. The pilot positions

fik, tik

are arbitrary. Typically, they are positioned on some grid. Figure 4.35 shows such
a rectangular grid corresponding to the above examples for time and frequency.
The pilot positions are numbered in some order. In most typical channel models, the
scattering function and thus the two-dimensional autocorrelation function factorizes to
R(f, t) = RH(f )Rc(t).
From this, the estimator matrix B can be calculated. The estimation is time- and frequency-
shift invariant because of the WSSUS property. As a consequence, the estimation can be
written as a two-dimensional convolution. Of course, the edges of the frequency have to
be taken into account as discussed above.
Instead of that rather involved 2-D ﬁltering one can perform a suboptimal 1-D × 1-D
ﬁltering without losing signiﬁcantly in performance (Hoeher 1991; Hoeher et al. 1997).
One may ﬁrst perform a 1-D channel estimation, for example, in frequency direction (with
the method described above) at those time slots where the pilots are located. After that,
at these time slots, there is a channel estimate available for every frequency. Now a 1-D
channel estimation in time direction can be performed and an estimate for all time-frequency
positions is available. One can also ﬁrst do a 1-D channel estimation in time direction and
then in frequency direction. The order can be shown to be arbitrary due to linearity of the
estimation and due to the fact that the rectangular constellation is the Cartesian product of
two one-dimensional ones.
We ﬁnally note that in practical systems as DVB-T and DRM a diagonal grid has been
chosen rather than a rectangular one. The procedure is similar, but the order of channel
estimation is no longer arbitrary.
4.4
Interleaving and Channel Diversity
for OFDM Systems
4.4.1
Requirements of the mobile radio channel
As already discussed in Chapter 3, channel coding is one important method to introduce
diversity into the mobile radio transmission. To achieve the full diversity gain of the code,
the transmitted bits must be affected by independent fading. Independent or uncorrelated
fading amplitudes6 can only be realized by a physical separation of the parts of the signal
corresponding to the different bits. Bits that are closely related by the code should not be
6Here we do not distinguish between uncorrelated and independent, keeping in mind that we will later focus
on the case where both are the same.

OFDM
193
0
1
1
0
1
0
1
0
0
1 1
0
1
1 0 0 0
Frequency
(a) Signal in the air
Time
(b) Coded bitstream           0
TS
1/T
Figure 4.38
Time and frequency interleaving for OFDM with symbol duration TS and
Fourier analysis window T .
transmitted at closely related locations of the channel. For a block code, bits are closely
related by the code if they are part of the same code word. For a convolutional code,
they are closely related unless there are many constraint lengths between them. For a
moving receiver (or transmitter), the separation of closely related bits can be realized in
the physical dimension of time. This separation is called time interleaving. Obviously, one
must wait some time until all closely related bits are received and can be decoded. Thus,
time interleaving introduces a decoding delay.
For multicarrier transmission, there is an obvious additional way to realize a physical
separation in frequency direction. This is called frequency interleaving. Thus, as depicted in
Figure 4.38, multicarrier transmission provides us with two degrees of freedom to separate
the information in the physical transmission channel: time and frequency. The physical
reasons that cause decorrelation in time and in frequency direction are independent, so that
multicarrier transmission with time and frequency interleaving is a very powerful technique
for mobile radio transmission systems.
The decorrelation in time has its origin in the time variance of the channel due to the
Doppler spread that is caused by multipath reception for a moving vehicle. It can equiv-
alently be interpreted as caused by the motion of a vehicle through a spatial interference
pattern. The spatial correlation length is xcorr = λ, where λ = c/f0 is the wavelength, c is
the velocity of light and f0 is the radio frequency. The corresponding correlation time is
tcorr = xcorr/v = ν−1
max, where v is the vehicle speed and
νmax = v
c f0

194
OFDM
is the maximum Doppler frequency. The correlation time is then given by
tcorr =
c
f0v ≈1080 MHz
f0
km/h
v
seconds.
The time separation of closely related bits should be signiﬁcantly larger that this correlation
time. We give a numerical example.
Example 7 (Time interleaving for DAB) The European DAB system has been intro-
duced in many regions in Europe and in Canada. It uses Band III (174–240 MHz) and
L-band (1452–1492 MHz) frequencies. In many European regions, the TV channel 12
(223–230 MHz) has been allocated for DAB. For f0 = 225 MHz and v = 100 km/h, the
above formula yields a correlation time tcorr = 48 ms. We will later see that the DAB time
interleaver separates two adjacent encoded bits by exactly 24 ms, that is, twice the cor-
relation time. Thus, for Band III transmission and typical vehicle speeds, time interleaving
alone does, by far, not guarantee a sufﬁcient statistical independence of the fading amplitude
of closely related bits. In the DAB system – as in many other communication systems – a
trade-off has to be made between the requirements of channel coding (leading to a huge in-
terleaver) and the restrictions of decoding delay given by the application. For multicarrier
systems as DAB, the frequency interleaving is an appropriate method to come out of this
dilemma.
The decorrelation in frequency direction has its origin in the frequency selectivity of the
channel due to the different travel times caused by the multipath reception. The frequency
correlation length fcorr – or coherence bandwidth – as introduced in Chapter 2 is given by
fcorr = τ −1
m , where τm is the delay spread of the channel. An electromagnetic wave travels
300 m in 1 µs. Thus, in an environment with path differences of a few hundred meters,
the system bandwidth should be signiﬁcantly greater than 1 MHz to achieve an efﬁcient
frequency interleaving.
4.4.2
Time and frequency interleavers
Interleaving can be implemented by different techniques. A block interleaver always takes
a block of K coded symbols7 of the data stream and changes the order of symbols within
this block. After this permutation, the symbols are sent to the channel. At the receiver, the
permutation is inverted. A convolutional interleaver – similar to a convolutional code – has
no block-oriented structure and acts on the ﬂowing symbol stream. Frequency interleavers
are typically block interleavers as there is a block structure involved by the number of
subcarriers. Convolutional interleavers are often regarded as the best choice for the time
interleaver as they have desirable properties concerning decoding delay.
Block interleavers
The simplest way to implement a block interleaver is to apply a pseudorandom permutation
to each block of K encoded symbols. Owing to the random nature of the interleaver, this,
by construction, does not guarantee any minimum separation of symbols on the channel.
7This can be encoded bits or bytes (for RS codes) or even complex modulation symbols.

OFDM
195
However, any randomly chosen permutation can easily be analyzed numerically and its
performance for a given transmission system can be evaluated by simulations.
A matrix block interleaver offers a more constructive approach. We take a block of
K = N · B symbols and write them row-wise into an N × B matrix. Then we read them
out column-wise and send them to the channel. Take, as an example, N = 12, B = 4, and
K = 48. We write the 48 symbols a0, a1, a2, . . . , a48 row-wise into a 12 × 4 matrix as
r ↓


a0
a1
a2
a3
a4
a5
a6
a7
a8
a9
a10
a11
a12
a13
a14
a15
...
...
...
...
a44
a45
a46
a47
w
→


and read them out column-wise. The bit stream on the channel is then given by
(a0, a4, a8, a12, a16, a20, a24, . . . , a44 a1, a5, . . . , a39, a43, a47).
At the receiver, the deinterleaver writes column-wise into the same matrix and reads out
row-wise.
Let us call each matrix row a subblock. Assume that the symbols of each subblock are
closely related, but symbols of different subblocks are unrelated because each subblock is
a code word. We may think, for example, of a WH(4, 2, 2) code and write each code word
of length B = 4 into a row. Then, on the channel, any two bits of the same code word
are separated on the channel by at least N = 12 symbol positions. To extend this example
further, we think of OFDM transmission with K = 48 subcarriers with carrier spacing T −1.
We choose BPSK modulation and map the symbols in the above order on these carriers.
Then each two bits of the same code word are separated in the frequency dimension by
12/T 8. Thus, for two symbols of the same subblock, this matrix block interleaver guarantees
a separation in frequency by N · T −1 when used as frequency interleaver for OFDM, or in
time by N · TS when used as a time interleaver. The deinterleaver at the receiver simply
writes column-wise into the matrix and reads out row-wise. The matrix at the (de) interleaver
can be implemented by a RAM.
Let us summarize. We call each matrix column a frame. A frame is a sequence of N
adjacent symbols on the channel. The N × B matrix block interleaver with frame length
N and subblock length B has the following properties:
1. All symbols of one subblock of length B are transmitted in different frames.
2. If one frame of length N is completely corrupted by an error burst, this will only
affect one symbol in each subblock of length B.
3. The overall decoding delay (interleaver plus deinterleaver together) is 2BN symbol
clocks.
8For QPSK transmission, half of the code words are mapped on the inphase and the other half on the quadrature
component. We may thus simply double the matrix in horizontal direction. The left part will then be mapped on
the inphase, the right on the quadrature component.

196
OFDM
We note that, by construction, such a matrix block interleaver guarantees a certain physical
separation. However, the very regular structure of this interleaver may sometimes lead to
unwanted properties.
Convolutional interleavers
It is possible to construct a convolutional interleaver with the same two ﬁrst properties
as above but only half the decoding delay of the corresponding block interleaver. Because
decoding delay is a critical item for most communication systems, convolutional interleavers
are often preferred in practical systems.
We consider a serial symbol stream a0, a1, a2, . . .. With this symbol stream we do a
serial-to-parallel (S/P) conversion that results in a stream of subblocks of B parallel symbols.
Let i = 0, 1, 2, . . . , B −1 denote the position of each symbol of a subblock. Then the sym-
bol with position i in a subblock is delayed by i · M parallel symbol clocks, where M is a
certain integer number that must be chosen to adjust the interleaver properties. After that de-
lay, the parallel symbol stream will be P/S converted and then transmitted (see Figure 4.39).
For a better understanding of the properties of the convolutional interleaver, we may
think that M subblocks of length B are grouped together to a data frame of length N = B ·
M. The interleaver output will be grouped into transmission frames of the same structure,
but, by the action of the interleaver, the symbols are transmitted in different frames. Since
the serial symbol clock and the parallel symbol clock are related by the factor B, the symbol
with position i in each subblock will be delayed by i · N serial symbol clocks, that is, by
i frames, thereby retaining the relative position within a frame.
The deinterleaver at the receiver has the same structure as the interleaver, but the
symbol with position i = 0, 1, 2, . . . , B −1 in a subblock will be delayed by (B −i −1) ·
M parallel symbol clocks (see Figure 4.40).
It is evident from both ﬁgures that the deinterleaver inverts the operation of the inter-
leaver, thereby introducing an overall decoding delay of (B −1) · N symbol clocks, that
is, B −1 frames.
The action of an (N, B) convolutional interleaver can be visualized as shown in
Figure 4.41 for N = 12 and B = 4. As depicted in part (a) of the ﬁgure, we arrange
S/P
an
cn
(B −1)M
· · ·
2 · M
M
No delay
P/S
Figure 4.39 Block diagram for the convolutional interleaver.

OFDM
197
S/P
cn
dn
No delay
M
· · ·
(B −2) · M
(B −1) · M
P/S
Figure 4.40 Block diagram for the convolutional deinterleaver.
Subblock
Transmission frame
Data frame
Figure 4.41 The action of a convolutional interleaver.
the sequence of frames as the columns of a matrix. If we read out this matrix column-wise,
adjacent positions in the same row will be read out with a time difference of one frame
duration, that is, N symbol clocks. We may thus realize the actions of the interleaver by
shifting the row of position number i in the subblock to the right by i horizontal positions
(see part (b) of the ﬁgure). Obviously, the B bits within the same subblock will be shifted

198
OFDM
to B different columns that correspond to different transmission frames when we read out
the matrix. We summarize the properties of a (N, B) convolutional interleaver.
1. All symbols of one subblock of length B are transmitted in different frames.
2. If one transmission frame of length N is completely corrupted by an error burst, this
affects only one symbol in each subblock of length B in the data frame.
3. If one subblock of length B inside a transmission frame of length N is completely
corrupted by an error burst, this will only affect one symbol in a data frame of
length N.
4. The overall decoding delay (interleaver plus deinterleaver together) is (B −1) · N
symbol clocks.
The ﬁrst two properties are clear from the above discussion. They are identical to the
ﬁrst two properties of the N × B matrix block interleaver. The third property has no such
correspondence. It is clear from the ﬁgure and it can be understood from the fact that one
can interchange the interleaver and the deinterleaver without altering the properties. Using
this argument, the third property immediately follows from the ﬁrst one.
Figures 4.39 and 4.40 correspond to a shift register implementation of the delays.
However, Figure 4.41 suggests a matrix representation realized by a RAM. This will be
favorable for implementation.
To do so, we need a matrix with N rows. For a moment, we allow the matrix to have an
inﬁnite number of columns. The interleaver can then be implemented by diagonal writing
for each subblock. For N = 12, B = 4, M = 3, we write the matrix


a0
a12
a24
a36
·
a1
a13
a25
·
·
a2
a14
·
·
·
a3
a4
a16
a28
a40
·
a5
a17
a29
·
·
a6
a18
·
·
·
a7
a8
a20
a32
a44
·
a9
a21
a33
·
·
a10
a22
·
·
·
a11
))))))))))))))))))))))))
a48
a60
a72
· · ·
a37
a49
a61
· · ·
a26
a38
a50
· · ·
a15
a27
a39
· · ·
a52
a64
a76
· · ·
a41
a53
a65
· · ·
a30
a42
a54
· · ·
a19
a31
a43
· · ·
a56
a68
a80
· · ·
a45
a57
a69
· · ·
a34
a46
a58
· · ·
a23
a35
a47
· · ·


and then read it out column-wise. At the receiver, the deinterleaver has the same structure,
but the write and read operations are interchanged. The matrix will be initialized with
dummy symbols. Because of the diagonal writing, there will be some dummy symbols left
at the beginning of the matrix. A real RAM is not a matrix with an inﬁnite number of
rows, but this is not necessary. At positions where the data are read out, new data can be
written. It is easy to see that a matrix with B columns is sufﬁcient. The RAM can then be
addressed cyclically. All data in the right part of the matrix above can be written into the
left part as the symbols there have already been read out.

OFDM
199
4.4.3
The diversity spectrum of a wideband multicarrier channel
In this subsection, we address the question how much interleaving is necessary to have
enough statistical independence for the channel code to work. We further present a method
to analyze the correlations of a wideband channel with interleaving. In particular, we discuss
the question how much bandwidth is needed to allow the channel code to exploit its diversity
degree that is given by the Hamming distance dH (or free distance dfree).
To start with a simple example, we ﬁrst consider a transmission channel given by
four frequencies f1, f2, f3, f4 that are sufﬁciently separated so that their Rayleigh fading
amplitudes can be regarded as independent. We encode a bit stream by a repetition code
of rate Rc = 1/4 with Hamming distance dH = 4 and transmit each of the four bits in
a code word on another frequency, where we may use, for example, BPSK modulation.
Of course, this is nothing else but simple frequency diversity, but we regard it as RP(4,
1, 4) coding with frequency interleaving and multicarrier transmission. The pairwise error
probability (PEP) that the code word (0000) is transmitted but the receiver decides for
(1111), decreases asymptotically as
Perr ∼
Eb
N0
−L
(4.21)
with L = dH = 4. We now consider the same transmission setup with the Walsh–Hadamard
code of length 4, rate Rc = 1/2 and Hamming distance dH = 2. The decay of the PEP for
each error event is given by the power law of Equation (4.21) with L = dH = 2. We may
say that the channel has a diversity degree of four – because of the four independently
fading subcarriers – and the two codes have diversity degrees (i.e. Hamming distance dH)
four and two, respectively. We are interested in the question whether a fading channel
provides enough diversity so that the code can exploit its full diversity, that is, Equation
(4.21) holds with L = dH. It is obvious that the channel diversity must not be smaller
than dH. However, equality of both diversity degrees typically does not guarantee that the
diversity of the code can be fully exploited, as it can easily be seen by the example of the
WH(4, 2, 2) code whose code words are given by the rows of the matrix


0
0
0
0
0
1
0
1
0
0
1
1
0
1
1
0

.
If we use only the frequencies f1, f2 and transmit the bits numbers 1 and 3 on f1 and
the bits numbers 2 and 4 on f2, we have different power laws for different error events.
Let (0000) be the transmitted code word. The power law for probability that the receiver
decides for (0101) is given by Equation (4.21) with L = 1, because the two bits in which
the code words differ are transmitted on the same frequency. This is not the case for the
other two error events corresponding to the code words (0011) and (0110) for which the
power law with L = 2 holds.
An obviously sufﬁcient condition for a (block) code to exploit its full diversity is to
transmit each bit of a code word at another frequency, for example, if the diversity degree of
the channel is at least the length of the code. The condition is not necessary. One can easily
see that three frequencies would be sufﬁcient for the WH(4, 2, 2) code. For a convolutional

200
OFDM
code, a detailed analysis is more difﬁcult because the number of possible error events is
inﬁnite and their length is growing to inﬁnity. However, one should intuitively expect that
the diversity degree of the code will be exploited if the diversity degree of the channel
signiﬁcantly exceeds the free distance dfree.
We add the following remarks:
• The two example codes we have chosen are quite weak so they will not be used in
practice. Indeed, they have no coding gain in an AWGN channel because dHRc = 1
in either case.
• A transmission channel that splits up into a given number of K independently fading
channels (K = 4 in the above example) is called a block fading channel. It is of
practical relevance, for example, for frequency hopping systems, where K different
frequencies are used subsequently during different time slots. The question, what
number of K must be chosen to allow the code to exploit its diversity is of great
practical relevance. For the simple convolutional code with memory 2, the most
probable error event corresponds to the code word (111011000. . . ). We conclude
that we should hop at least between six different frequencies for that code.
Up to now, we have considered independently fading (sub) carrier frequencies. In practice,
the fading of adjacent subcarriers in a multicarrier system is highly correlated. Take as an
example an OFDM system with the (typical) ratio T / = 4 between the Fourier analysis
window and the guard interval. Since  must be chosen to be larger than the maximum
path delay, the delay spread τm should be signiﬁcantly smaller than . We take as an
example τm = /5, which is already quite a frequency-selective channel. We then have T =
20 τm. For this ﬁgure, the frequency correlation length (or coherency bandwidth) fcorr = τ −1
m
exceeds the frequency separation T −1 of the subcarriers by a factor of 20, which means
that up to 20 neighboring subcarriers are highly correlated. The number of subcarriers
in an OFDM system must therefore signiﬁcantly exceed this number to guarantee some
decorrelation that is necessary to exploit the frequency diversity in a channel coded and
frequency-interleaved OFDM system. Only in that case we may legitimately call this a
wideband system from the physical system point of view. A proper code design needs
some information on the diversity that can be provided by the channel. In a real multicarrier
system, there are always signiﬁcant correlations. It is therefore desirable to ﬁnd a quantity
to characterize the diversity of a correlated fading channel.
In the following discussion, we will present a method to characterize the diversity of a
wideband channel with correlated fading. We consider a set of channel samples
ci = H(fi, ti), i = 1, . . . , K
in the time-frequency plane. We assume a WSSUS Rayleigh process with average power
E
|ci|2
= 1. Thus, the channel samples ci are zero mean complex Gaussian random vari-
ables that can be completely characterized by their autocorrelation properties. Writing the
channel samples as a channel vector c = (c1, . . . , cK)T , the autocorrelation matrix is
R = E

cc†
with elements Rik = E

cic∗
k

given by
Rik = R(fi −fk, ti −tk),

OFDM
201
where R(f, t) is the two-dimensional autocorrelation function of the GWSSUS process
H(f, t). Since R(f, t) = R∗(−f, −t), the matrix R is Hermitian. From matrix theory, we
know that every Hermitian matrix can be transformed to a diagonal matrix: there exists a
unitary matrix U (i.e. U−1 = U†) such that
URU† = D,
where D = diag(λ1, . . . , λK) is the diagonal matrix of the eigenvalues of R. We may write
this as
E

Uc(Uc)†
= D
and set
b = Uc.
This is a vector of mean zero Gaussian random variables with the diagonal autocorrelation
matrix D, that is, the coefﬁcients of b = (b1, . . . , bK)T are uncorrelated
E

bib∗
k

= λiδik
and, because they are Gaussian, even independent. We may regard this unitarily transformed
channel vector as the equivalent independently fading channel. To explain this name, we
consider as a simple example the multicarrier BPSK modulation with a K-fold repetition
code, that is, the same BPSK symbol s ∈

±√ES

will be transmitted at K different
positions in the time-frequency plane. This is again simple frequency diversity combined
with time diversity, but with correlated fading amplitudes. We recall from subsection 2.4.6
that the conditional PEP is given by
P (s →˜s|c) = 1
2erfc


0
1
1
2ES
N0
K

i=1
|ci|2

.
Because the matrix U is unitary, it leaves the vector norm invariant, that is,
∥b∥2 = ∥Uc∥2 = ∥c∥2
or
K

i=1
|bi|2 =
K

i=1
|ci|2 .
This means that the transfer power of the equivalent channel is the same. P (s →˜s|c) can
then be expressed as
P (s →˜s|c) = P (s →˜s|U−1b) = 1
2erfc


0
1
1
2ES
N0
K

i=1
|bi|2

.
Since the transformed fading amplitudes bi are independent, we can apply the same method
as in Subsection 2.4.6 to perform the average for
P (s →˜s) = E

P (s →˜s|U−1b)


202
OFDM
and eventually obtain the expression
P (s →˜s) = 1
π
 π/2
0
L
7
i=1
1
1 +
λi
sin2 θ
ES
N0
dθ.
Using Eb = KES, we obtain the tight Chernoff-like bound
P (s →˜s) ≤1
2
K
7
i=1
1
1 + λi
K
Eb
N0
.
(4.22)
For independent fading, we have λi = 1 for all values of i and we obtain the power law
of Equation (4.21) with L = K. For correlated fading they are different, but because of
E
' K

i=1
|bi|2
(
= E
' K

i=1
|ci|2
(
,
their sum
K

i=1
λi = K
is always the same. Even though – in case that λi ̸= 0 for all i – Equation (4.22) will
asymptotically approach the power law of Equation (4.21) with L = K for large Eb/N0,
many of the eigenvalues may be very small so that they will not contribute signiﬁcantly
to the product for relevant values of Eb/N0. Only those eigenvalues λi of signiﬁcant size
contribute, but there is no natural threshold. The diversity that can be achieved by the chan-
nel is thus characterized by the whole eigenvalue spectrum {λi}K
i=1 of the autocorrelation
matrix of the fading. We thus call it the diversity branch spectrum of the channel.
For the following numerical example, we restrict ourselves to the frequency direction
and assume an exponential delay power spectrum
SD(τ) = 1
τm
e−τ/τmϵ(τ),
where τm is the mean delay and ϵ(τ) is the Heaviside function. The corresponding frequency
autocorrelation function is given by
Rf (f ) =
1
1 + j2πf τm
.
Figure 4.42 shows the ﬁrst 16 eigenvalues for K = 64 and different values of the
bandwidth B. We deﬁne a normalized bandwidth X = Bτm. We have assumed that the
BPSK symbols are equally frequency spaced over the bandwidth. We see that for a small
bandwidth (e.g. X = 1 corresponding to 1 MHz for τ = 1 µs), the equivalent independent
fading channel has only a low number of diversity branches of signiﬁcant power. We found
that the diversity branch spectrum as shown in Figure 4.42 is nearly independent of K if
K is signiﬁcantly greater than X. It is therefore a very useful quantity to characterize the
diversity that can be provided by the channel. A look at the eigenvalues gives a ﬁrst glimpse
at how many diversity branches of the equivalent independent fading channel contribute

OFDM
203
0
5
10
15
0
0.1
0.2
0.3
0.4
0.5
X = 1
L = 64
Number i
li/L
li/L
li/L
li/L
0
5
10
15
0
0.1
0.2
0.3
0.4
0.5
X = 2
L = 64
Number i
0
5
10
15
0
0.1
0.2
0.3
0.4
0.5
X = 4
L = 64
Number i
0
5
10
15
0
0.1
0.2
0.3
0.4
0.5
X = 8
L = 64
Number i
Figure 4.42 Diversity branches of the equivalent independent fading channel and normal-
ized bandwidth X = Bτm = 1, 2, 4, 8.
signiﬁcantly to the transmission. It ﬁnds its reﬂection in the performance curves. Figure 4.43
shows the pairwise (=bit) error probability for K = 32 and X = Bτm = 0.5, 1, 2, 4, 8, 16.
The high diversity degree of the repetition code (K = 32) can show a high diversity gain
if the equivalent channel has enough independent diversity branches of signiﬁcant power.
This is the case for X = 16, but not for X = 1 or X = 2. For low X, a lower repetition
rate K would have been sufﬁcient.
Figure 4.44 shows the bit error probability for K = 10 and the same values of X. For
low X, the curves of Figure 4.43 and 4.44 are nearly identical. For higher X, the curves of
Figure 4.44 run into a saturation that is given by the performance curve of the independent
Rayleigh fading. For X = 8, this limit is practically achieved. There is still a gap of nearly
2 dB in the AWGN limit at the bit error rate of 10−4.
For BPSK and any linear code, the probability for an error event corresponding to a
Hamming distance d is given by
Pd = 1
π
 π/2
0
d7
i=1
1
1 +
λi
sin2 θ
ES
N0
dθ,
(4.23)
which can be upper bounded by
Pd ≤1
2
d7
i=1
1
1 + λi
ES
N0
.

204
OFDM
0
2
4
6
8
10
12
14
16
18
20
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
Eb/N0 [dB]
BER
AWGN limit
X = 0.5 
X = 2 X = 1 
X = 4 
X = 8 
X = 16 
Figure 4.43 Bit error probabilities for 32-fold repetition diversity with X = 0.5, 1, 2, 4,
8, 16.
0
2
4
6
8
10
12
14
16
18
20
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
Eb/N0 [dB]
BER
AWGN limit
X = 0.5 
X = 1 
X = 2 
X = 16 X = 4 
Figure 4.44 Bit error probabilities for 10-fold repetition diversity with X = 0.5, 1, 2, 4,
8, 16.

OFDM
205
For the region of reasonable ES/N0, those factors with λi ≪1 do not contribute signiﬁ-
cantly to the product. Thus, it is not possible to obtain tight union bounds like
Pd ≤
∞

d=dfree
cdPd
because Pd does not decrease as (ES/N0)−d if d is greater than the diversity degree of the
channel, that is, the number of signiﬁcant eigenvalues λi. The cd values grow with d and
thus the union bound will typically diverge.
However, the diversity branch spectrum may serve as a good indicator of whether the
time-frequency interleaving for a coded OFDM system is sufﬁcient. Consider for example a
system with a convolutional code9 with free distance dfree = 10 like the popular NASA code
(133, 171)oct. The probability for the most likely error event is given by Equation (4.23)
with d = dfree = 10. This probability will decrease as (ES/N0)−10 only if the 10 eigen-
values λi, i = 1, . . . , 10 are of signiﬁcant size. Let us consider an OFDM system with
a pseudorandom time-frequency interleaver over the time Tframe of one frame and over a
bandwidth B. We consider a GWSSUS model scattering function given by
S(τ, ν) = SDelay(τ)SDoppler(ν)
as a product of a delay power spectrum SDelay(τ) and a Doppler spectrum SDoppler(ν). As
a consequence, the time-frequency autocorrelation function also factorizes into
R(f, t) = Rf (f )Rt(t).
We assume an exponential power delay spectrum with delay time constant τm that has a
frequency autocorrelation function
Rf (f ) =
1
1 + j2πf τm
and an isotropic Doppler spectrum (Jakes spectrum) with a maximum Doppler frequency
νmax that has a time autocorrelation function given by
Rt(t) = J0 (2πνmaxt) .
The correlation lengths in frequency and time are given by fcorr = τ −1
m
and tcorr = ν−1
max,
respectively.
The dfree = 10 time-frequency positions (ti, fi) of the BPSK symbols corresponding to
the most likely error event are spread randomly over the time Tframe and the bandwidth B.
Thus, the diversity branch spectrum is a random vector. To eliminate this randomness, we
average over an ensemble of 100 such vectors, which turns out to be enough for a stable
result. To justify this procedure, we recall that error probabilities are averaged quantities.
Figure 4.45 shows the diversity branch spectrum {λi}10
i=1for frequency interleaving only
(i.e. Tframe/tcorr = 0) and values B/fcorr = 1, 2, 4, 8, 16, 32 for the normalized bandwidth.
It can be seen that even for B/fcorr = 32, the full diversity is not reached because the size
9Similar considerations apply for linear block codes.

206
OFDM
0
5
10
15
20
0
2
4
6
li
li
li
li
li
li
Tframe/tcorr = 0
B/fcorr = 1
L = 10
i
0
5
10
15
20
0
1
2
3
4
5
Tframe/tcorr = 0
B/fcorr = 2
L = 10
i
0
5
10
15
20
0
1
2
3
4
Tframe/tcorr = 0
B/fcorr = 4
L = 10
i
0
5
10
15
20
0
1
2
3
Tframe/tcorr = 0
B/fcorr = 8
L = 10
i
0
5
10
15
20
0
0.5
1
1.5
2
Tframe/tcorr = 0
B/fcorr = 16
L = 10
i
0
5
10
15
20
0
0.5
1
1.5
2
Tframe/tcorr = 0
B/fcorr = 32
L = 10
i
Figure 4.45 Diversity branch spectrum for d = 10 and frequency interleaving only.
of normalized eigenvalues is very different and the greatest values dominate the product. As
shown in Figure 4.46, the same is true if only time interleaving is applied. The ﬁgure shows
the spectra for time interleaving over a normalized length of Tframe/tcorr = 1, 2, 4, 8, 16, 32.
Note that, due to the different autocorrelation in time and frequency domain, both diversity
branch spectra show a different shape. Figure 4.47 shows the diversity branch spectrum
for combined frequency-time interleaving. It can be seen that both mechanisms help each
other, and for a wideband system with long time interleaving, all eigenvalues contribute to
the product. However, the interleaving can be considered to be ideal only if all eigenvalues
are of nearly the same size. As shown in Figure 4.48, a huge time-frequency interleaver is
necessary to achieve this.
We may say that an OFDM system is a wideband system if the system bandwidth B
is large enough compared to fcorr so that the frequency interleaver works properly. For a
well-designed OFDM system, the guard interval length  must be matched to the maximum
echo length. Assume, for example, a channel with τm = /5 and a guard interval of length
 = T /4. Using B = K/T , where K is the number of carriers and T is the Fourier analysis
window length, we obtain the relation
K = 20Bτm.
With a look at the ﬁgures we may speak of a wideband system, for example, for B/fcorr =
Bτm = 32, which leads to K = 640. There may of course occur ﬂat fading channels with
τm ≪, where the frequency interleaving fails to work. But we may conclude that an
OFDM system may be called a wideband system relative to the channel parameters only

OFDM
207
0
5
10
15
20
0
2
4
6
8
li
Tframe/tcorr = 1
B/fcorr = 0
L = 10
i
0
5
10
15
20
0
2
4
6
li
Tframe/tcorr = 2
B/fcorr= 0
L = 10
i
0
5
10
15
20
0
1
2
3
4
5
li
Tframe/tcorr = 4
B/fcorr = 0
L = 10
i
0
5
10
15
20
0
1
2
3
4
li
Tframe/tcorr = 8
B/fcorr = 0
L = 10
i
0
5
10
15
20
0
1
2
3
li
Tframe/tcorr = 16
B/fcorr = 0
L = 10
i
0
5
10
15
20
0
1
2
3
li
Tframe/tcorr = 32
B/fcorr = 0
L = 10
i
Figure 4.46 Diversity branch spectrum for d = 10 and time interleaving only.
0
5
10
15
20
0
0.5
1
1.5
2
li
Tframe/tcorr = 4
B/fcorr = 4
L = 10
i
0
5
10
15
20
0
0.5
1
1.5
2
li
Tframe/tcorr = 4
B/fcorr = 8
L = 10
i
0
5
10
15
20
0
0.5
1
1.5
2
li
Tframe/tcorr = 8
B/fcorr = 4
L = 10
i
0
5
10
15
20
0
0.5
1
1.5
2
li
Tframe/tcorr = 8
B/fcorr = 8
L = 10
i
0
5
10
15
20
0
0.5
1
1.5
2
li
Tframe/tcorr = 16
B/fcorr = 4
L = 10
i
0
5
10
15
20
0
0.5
1
1.5
2
li
Tframe/tcorr = 16
B/fcorr = 8
L = 10
i
Figure 4.47
Diversity branch spectrum for d = 10 for moderate time-frequency
interleaving.

208
OFDM
0
5
10
15
20
0
1
2
3
li
Tframe/tcorr = 0
B/fcorr = 10
L = 10
i
0
5
10
15
20
0
1
2
3
4
li
Tframe/tcorr= 10
B/fcorr= 0
L = 10
i
0
5
10
15
20
0
0.5
1
1.5
2
li
Tframe/tcorr= 8
B/fcorr= 6
L = 10
i
0
5
10
15
20
0
0.5
1
1.5
2
li
Tframe/tcorr= 6
B/fcorr= 8
L = 10
i
0
5
10
15
20
0
1
2
3
li
Tframe/tcorr= 3
B/fcorr = 4
L = 10
i
0
5
10
15
20
0
1
2
3
li
Tframe/tcorr= 0
B/fcorr= 5
L = 10
i
Figure 4.48
Diversity branch spectrum for d = 10 and small and huge time-frequency
interleavers.
if at least several hundred subcarriers are used. This is the case for the digital audio and
video broadcasting systems DAB and DVB-T. It is not the case for the WLAN systems
IEEE 802.11a and HIPERLAN/2 with only 48 carriers.
Time interleaving alone is often not able to provide the system with sufﬁcient diversity.
A certain vehicle speed can, typically, not be guaranteed in practice. For the DAB system
working at 225 MHz, a vehicle speed of 48 km/h leads to a Doppler frequency that is
as low as 10 Hz. For such a Doppler frequency, sufﬁcient time interleaving alone would
lead to a delay of several seconds, which is not tolerable in practice. It is an attractive
feature of OFDM that the time and frequency mechanisms together may often lead to a
good interleaving. However, there will always be situations where the correlations of the
channel must be taken into account.
4.5
Modulation and Channel Coding for OFDM Systems
4.5.1
OFDM systems with convolutional coding and QPSK
In this subsection, we present theoretical performance curves for OFDM systems with
QPSK modulation, both with differential and coherent demodulation. These curves are of
great relevance for the performance analysis of existing practical systems. Fortunately, most
practical OFDM systems use essentially the same convolutional code, at least for the inner
code. And most of these systems use QPSK modulation, at least as one of several possible

OFDM
209
options. DAB always uses differential QPSK, and DVB-T as well as the WLAN systems
(IEEE 802.11a and HIPERLAN/2) use QAM, where QPSK is a special case. These WLAN
systems also have the option to use BPSK. The performance curves for coherent BPSK
are the same as those for QPSK when plotted as a function of Eb/N0. When plotted as a
function of SNR, there is a gap of 3.01 dB between the BPSK and the QPSK curves. The
performance of higher-level QAM will be discussed in a subsequent subsection.
The channel coding of all the above-mentioned systems is based on the so-called NASA
planetary standard, the rate 1/2, memory 6 convolutional code with generator polynomials
(133, 171)oct, that is,
g(D) =
 1 + D2 + D3 + D5 + D6
1 + D + D2 + D3 + D6

.
This code can be punctured to get higher code rates. For the DAB system, lower code rates
are needed, for example, to protect the most sensitive bits in the audio frame, and two
additional generator polynomials are introduced. The generator polynomials of this code
Rc = 1/4 are given by (133, 171, 145, 133)oct, that is,
g(D) =


1 + D2 + D3 + D5 + D6
1 + D + D2 + D3 + D6
1 + D + D4 + D6
1 + D2 + D3 + D5 + D6

.
This encoder is depicted in Figure 4.49. The shift register is drawn twice to make it easier
to survey the picture. For DVB-T and the wireless LAN systems, only the part of the code
corresponding to the upper shift register is used.



























.























Figure 4.49 The DAB convolutional encoder.

210
OFDM
The bit error rates for a convolutional code can be upper bounded by the union bound
Pd ≤
∞

d=dfree
cdPd.
(4.24)
Here, Pd is the PEP for d-fold diversity as given by the expressions in Subsection 2.4.6. The
coefﬁcient cd is the error coefﬁcient corresponding to all the error events with Hamming
distance d. We note that cd depends only on the code, while Pd depends only on the
modulation scheme and the channel. The union bound given in Equation (4.24) is valid for
any channel. For an AWGN channel, the error event probability is simply given by
Pd = 1
2erfc
#$
d ES
N0
%
,
where ES = |s|2 is the energy of the PSK symbol s. For the independently fading Rayleigh
channel, the expressions for the error event probabilities Pd were discussed in Subsection
2.4.6. All the curves asymptotically decay as
Pd ∼
ES
N0
−d
.
The union bound is also valid for the correlated fading channel, but it does not tightly
bound the bit error rate. It may even diverge. This is because the degree of the channel
diversity is limited and the pairwise error probabilities for diversity run into a saturation
for d →∞, while the coefﬁcients cd grow monotonically.
The cd values can be obtained by the analysis of the state diagram of the code. In
Hagenauer’s paper about RCPC (rate compatible punctured convolutional) codes (Hage-
nauer 1988), these values have been tabulated for punctured codes of rate Rc = 8/N with
N ∈{9, 10, 11, . . . , 24}. These punctured codes have been implemented in the DAB sys-
tem. In the other systems, some different code rates are used. However, their performance
can be estimated from the closest code rates of that paper. We now discuss the performance
of these codes for (D)QPSK in a Rayleigh fading channel.
First we consider DQPSK and an ideally interleaved Rayleigh fading channel with the
isotropic Doppler spectrum of maximum Doppler frequency νmax. The Pd values depend on
the product νmaxTS. High values of this product cause a loss of coherency between adjacent
symbols, which degrades the performance of differential modulation. We ﬁrst consider the
ideal case νmaxTS = 0. In practice, this is of course a contradiction to the assumption of
ideal interleaving. But we may think of a very huge (time and frequency) interleaver and
the limit of very low vehicle speed. Figure 4.50 shows the union bounds of the performance
curves in that case for several code rates. We have plotted the bit error probabilities as a
function of the SNR, not as a function of Eb/N0. The latter is better suited to compare
the power efﬁciencies, but for practical planning aspects the SNR is the relevant physical
quantity. Both are related by
SNR = T
TS
Rc log2(M)Eb
N0

OFDM
211
0
2
4
6
8
10
12
14
16
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
Union bound for Pb
8/32
8/24
8/20
8/16
8/14
8/12
8/11
8/10
Uncoded
Figure 4.50
Union Bounds for the bit error probability for DQPSK and νmaxTS = 0 for
Rc = 8/10, 8/11, 8/12, 8/14, 8/16, 8/20, 8/24, 8/32.
with M = 4 for (D)QPSK. Another reason to plot the different performance curves together
as a function of the SNR is that different parts of the data stream may be protected by
different code rates as it is the case for the DAB system discussed in Subsection 4.6.1.
Here, all parts of the signal are affected by the same SNR. For example, the curves of
Figure 4.50 are the basis for the design of the unequal error protection (UEP) scheme of
the DAB audio frame, where the most important header bits are better protected than the
audio scale factors that are better protected than the audio samples. For more details, see
(Hoeg and Lauterbach 2003; Hoeher et al. 1991). The curves show that there is a high degree
of ﬂexibility to choose the appropriate error protection level for different applications. Note
that there are still intermediate code rates in between that have been omitted in order not
to overload the picture. Figure 4.51 shows the union bounds for the performance curves
for the same codes, but with a higher Doppler frequency corresponding to νmaxTS = 0.02.
For the DAB system (Transmission Mode I) with TS ≈1250 µs working at 225 MHz, this
corresponds to a moderate vehicle speed of approximately 80 km/h. One can see that the
curves become less steep, and ﬂatten out. This effect is greater for the weak codes, and
it is nearly neglectible for the strong codes. In any case, this degradation is still small.
Figure 4.52 shows the union bounds for the performance curves for the same codes, but
with a higher Doppler frequency corresponding to νmaxTS = 0.05. For the DAB system
(Transmission Mode I) with TS ≈1250 µs working at 225 MHz, this corresponds to a
high vehicle speed of approximately 190 km/h. The curves ﬂatten out signiﬁcantly; the
loss is approximately 1.5 dB at Pb = 10−4 for Rc = 8/16, and it is more than 3 dB for
Rc = 8/12.

212
OFDM
0
2
4
6
8
10
12
14
16
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
Union bound for Pb
8/32
8/24
8/20
8/16
8/14
8/12
8/11
8/10
Uncoded
Figure 4.51 Union Bounds for the bit error probability for DQPSK and νmaxTS = 0.02 for
Rc = 8/10, 8/11, 8/12, 8/14, 8/16, 8/20, 8/24, 8/32.
0
2
4
6
8
10
12
14
16
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
Union bound for Pb
8/32
8/24
8/20
8/16
8/14
8/12
8/11
8/10
Uncoded
Figure 4.52 Union Bounds for the bit error probability for DQPSK and νmaxTS = 0.05 for
Rc = 8/10, 8/11, 8/12, 8/14, 8/16, 8/20, 8/24, 8/32.

OFDM
213
0
2
4
6
8
10
12
14
16
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
Union bound for Pb
8/32
8/24
8/20
8/16
8/14
8/12
8/11
8/10
Uncoded
Figure 4.53 Union Bounds for the bit error probability for QPSK and Rc = 8/10, 8/11,
8/12, 8/14, 8/16, 8/20, 8/24, 8/32.
As long as the interleaving is sufﬁcient, all these curves ﬁt quite well to computer
simulations. We will show some DQPSK performance curves for simulations of the DAB
system in a subsequent section. One must keep in mind that high Doppler frequencies
also effect the orthogonality of the subcarriers, which will cause additional degradations.
However, this effect turns out to be signiﬁcantly smaller than the DQPSK coherency loss
for each single subcarrier.
Figure 4.53 shows the union bounds of the performance curves for QPSK and the same
code rates. QPSK is not affected directly by the Doppler spread. However, the loss of
orthogonality will also degrade QPSK. In practice, the most signiﬁcant loss due to high
Doppler frequencies turns out to be due to degradations in the channel estimation. In fact,
it was generally believed for many years that for this reason, in practice, coherent QPSK is
not really superior to differential QPSK, because this channel estimation loss approximately
compensates the gain. In a subsequent section, we will discuss this item and we will show
that this is not true.
4.5.2
OFDM systems with convolutional coding and M2-QAM
In this subsection, we analyze the performance of OFDM systems with M2-QAM modu-
lation, as it is used for DVB-T as well as the WLAN systems IEEE 802.11a and HIPER-
LAN/2. The channel coding of these systems is based on the same coding scheme as
discussed in the preceding subsection.

214
OFDM
Applications with higher data rate than audio broadcasting motivated system designers
to consider higher-level QAM modulation schemes for OFDM systems. Examples are
the terrestrial digital video broadcasting system DVB-T and the wireless LAN standards
IEEE 802.11a and HIPERLAN/2. Coding and modulation are closely connected in such
systems and they must be carefully ﬁtted together. For the above-mentioned systems, an
approach has been chosen, which uses standard convolutional coding and QAM modula-
tion with conventional Gray mapping and a bit interleaver in between. Such an approach
is called bit interleaved coded modulation (BICM) in the literature, and these systems are
probably the ﬁrst applications of BICM. There are two arguments for using BICM rather
than trellis-coded modulation with Ungerb¨ock codes and set partitioning:
1. The implementation aspect: it is possible to use standard components for the Viterbi
decoder.
2. The performance aspect: for the performance in a fading channel, the Hamming
distance is more important than the Euclidean distance. A high Hamming distance
can be achieved by choosing sufﬁciently strong codes.
The system model
Because only those are applied in the above-mentioned systems, we restrict ourselves to
square M2-QAM constellations that are Cartesian products of two M-ASK constellations
for the I (inphase) and the Q (quadrature) component. We regard it as convenient to
interpret a QAM symbol as a two-dimensional real symbol instead of a one-dimensional
complex symbol. Each ASK symbol is labeled by m = log2 M bits. The block diagram for
the transmitter is shown in Figure 4.54.
The useful data bit stream ai will be encoded by a convolutional encoder with code
rate Rc to produce an encoded bit stream bi. Between the encoder and the symbol mapper,
bit interleaving will be applied to avoid closely neighboring bits in the code word to be
mapped onto the same QAM symbol. For the theoretical analysis, this bit interleaver will be
modeled as a pseudorandom permutation π of the time index together with a pseudorandom
serial–parallel (S/P) conversion for the symbol mapping of m parallel bits of one ASK
symbol. Both are assumed to be statistically independent. This block is given by a random
index map π : i →(k, l) that chooses for each time index i of the encoded bit bi a new
time position with index l and a labeling position k ∈{0, . . . , m −1} for the Gray labeling
(k = 0 means LSB, k = m −1 means MSB). For each time index l, the m bits
c(k)
l
= bi = bπ−1(k,l), k = 0, 1, . . . , m −1





Convol.
encoder
Bit
interl.
OFDM
ai
bi
si
s(t)
mapper
Symbol
c(k)
l
Figure 4.54 Transmitter block diagram for an OFDM system with convolutional coding
and QAM.

OFDM
215
−5
−4
−3
−2
−1
0
1
2
3
4
5
−4
−3
−2
−1−
0
1
2
3
4
c1
(0) c1
(1) c2
(0) c2
(1)
0  0  0  0
1  0  0  0
0  1  0  0
1  1  0  0
0  0  1  0
1  0  1  0
0  1  1  0
1  1  1  0
0  0  0  1
1  0  0  1
0  1  0  1
1  1  0  1
0  0  1  1
1  0  1  1
0  1  1  1
1  1  1  1
x1/d
x2/d
Figure 4.55 16-QAM with Gray mapping.
determine which ASK symbol will be transmitted. Let xl denote the sequence of ASK
symbols. Then x1, x3, x5, . . . is the sequence of inphase symbols and x2, x4, x6, . . . is the
sequence of the quadrature component symbols. Each ASK symbol can take the values
xl ∈C := {±δ, ±3δ, . . ., ±(M −1)δ}
of the signal constellation C. Here, we introduce a distance unit δ that is related to the symbol
energy. The symbol mapper X maps m = log2 M bits c(0)
l , c(1)
l , . . . , c(m−1)
l
on a real symbol
xl. Two subsequent M-ASK symbols x2i−1 and x2i are composed to a M2-QAM symbol
si = x2i−1 + jx2i. Figure 4.55 shows a 16−QAM conﬁguration with this mapping. Note
that we write c(0)
l c(1)
l
and thus the LSB is in the leftmost position. The QAM symbols
will be processed by the OFDM unit, which will typically include a symbol interleaving in
frequency direction, as it is the case for the above-mentioned systems. Finally, the OFDM
signal s(t) will be transmitted over the channel.
The receiver
At the receiver, the signal will ﬁrst be processed by the OFDM unit to produce output
symbols ri = y2i−1 + jy2i. We thereby assume perfect back rotation of the phase so that
we can work with the discrete real channel model as given by
yl = alxl + nl
or, in vector notation, by
y = Ax + n.

216
OFDM
Here, the sequence of ASK symbols xl is written as a vector x = (x1, x2, x3, . . .)T . y is the
vector of received symbols and n is the real AWGN vector with variance σ 2 = N0/2 in each
component. The fading is described by the diagonal matrix A = diag(a1, a2, a3, . . .)T of
(real) fading amplitudes. The fading amplitudes are normalized to average power one. We
assume independent Ricean fading amplitudes. We denote the energy per (two-dimensional)
QAM symbol by ES and the energy per data bit by Eb. The relation between both is given by
ES = Rc log2(M2)Eb.
One can easily show that ES = 2δ2, 10δ2, 42δ2, . . . for 4-QAM, 16-QAM, 64-QAM, . . . ,
and so on. For OFDM with guard interval  = TS −T , the relation to the RF SNR is given
by
SNR = T
TS
ES
N0
.
From the real receive symbols yl, soft metric values must be calculated by the metric
computation unit (MCU) to obtain soft metric values µi as the input for the Viterbi decoder.
For each received symbol yl, the MCU generates the metric values ν(k)
l
, that is, the soft
decision values of the bits c(k)
l
corresponding to labeling positions k ∈{0, 1, . . . , m −1}.
The soft metric values ν(k)
l
are deinterleaved by the inverse permutation π−1 : (k, l) →
i = π−1(k, l) . The deinterleaved metric values are then given by
µi = µπ−1(k,l) = ν(k)
l
.
The decoder DEC is a Viterbi decoder that decides for the bit sequence b = (b1, b2, . . .)
that maximizes
µ(b) =

i
µi(−1)bi.
Metric calculation
There are several possibilities to obtain m = log2 M metric values ν(k)
l
(i.e. soft decision
variables) from the receive symbol yl. Such a metric value must be positive if the bit value
c(k)
l
= 0 is more likely, and negative if otherwise. Its absolute value should be a measure
for the reliability of the bit value. Obviously, the LLR value L(c(k)
l
= 0|yl) would be the
best choice, and it can easily be obtained from the LLR formalism. However, we will
ﬁrst construct a suboptimal simple threshold metric (TR) in a geometrical illustrative way
without using this formalism.
We note that for Gray mapping, the MSB c(m−1)
l
just indicates the sign of the symbol.
Thus, even though the amplitudes are different and therefore it is not exactly the same case
as bipolar signaling (2-ASK or BPSK), it seems to be an appropriate choice to obtain a
soft decision variable in the same way and take yl directly as the metric value for the MSB
in the AWGN channel. For the fading channel, we set ν(m−1)
l
= alyl, that is, the bipolar
receive value has to be weighted by the channel amplitude to form a decision variable. For
the next less signiﬁcant bit c(m−2)
l
, there is a threshold at xl = + M
2 δ if c(m−1)
l
= 0 and at
xl = −M
2 δ if c(m−1)
l
= 1 (see Figure 4.56) for 4-ASK10 with al = 1. Thus, if we discard
10Note again that we write c(0)
l c(1)
l
and thus the LSB is in the leftmost position.

OFDM
217







−3
−2
−1
0
+1
+2
+3
00
10
11
01
LSB threshold
MSB threshold
LSB threshold
yl
ν(0)
l
ν(1)
l
Figure 4.56 Threshold metric calculation for 4-ASK.
the information of the MSB by taking the absolute value, we again have the situation of
bipolar signaling with a threshold shifted by M
2 δ for the AWGN channel and shifted by
al M
2 δ for the fading channel. Thus, for the bit k = m −2 we take |yl| −al M
2 δ instead of
yl for the MSB. Thus, we use the metric ν(m−2)
l
= al|yl| −a2
l
M
2 δ. We proceed in the same
way for the next bits until the LSB and obtain the metric values by the recursion
ν(m−1−κ)
l
= |ν(m−κ)
l
| −a2
l
M
2κ δ
(4.25)
with ν(m−1)
l
= alyl.
In this construction, we have used decision thresholds that depend on the fading ampli-
tude al since the size of signal constellation is attenuated by this factor. From the engineering
point of view, it seems to be natural to compensate this by means of an equalizer that divides
by the amplitude and then computes the decision variables as in the case of a channel with-
out fading. However, this equalizer will inﬂate the noise because the noise samples of very
unreliable receive symbols with small al will be ampliﬁed more than others and will corrupt
the decision through an inappropriately high magnitude. One easily sees that a2
l is the appro-
priate weight factor for the decision variables: one must multiply by al to rescind the noise
inﬂation done by the equalizer and then multiply again by al, which is the appropriate weight
factor for antipodal decisions in a fading channel. The setup is depicted in Figure 4.57.
First, the received symbols are equalized. The equalized receive symbols ηl = a−1
l
yl
are then used to calculate the decision variables θ(k)
l
given by θ(m−1)
l
and
θ(m−1−κ)
l
= |θ(m−κ)
l
| −M
2κ δ
(4.26)
for an AWGN channel. These AWGN metric values are then weighted to build the appro-
priate fading channel metric values
ν(k)
l
= a2
l θ(k)
l
.
One can easily see that these values for ν(k)
l
are the same as those calculated by
Equation (4.25).

218
OFDM








yl
AWGN
MCU
ηl
a2
l
a−1
l
ν(k)
l
θ(k)
l
×
×
Equalizer
factor
Weighting
Figure 4.57 Metric computation for QAM by using an equalizer.
−4
−3
−2
−1
0
1
2
3
4
−4
−2
(a)
(b)
0
2
4
yl /d
LLR
−4
−3
−2
−1
0
1
2
3
4
−10
−5
0
5
10
yl /d
LLR
Threshold
Maxlog
Optimum
SNR = 6 dB 
Figure 4.58
Comparison of metric expression for 4-ASK at SNR = 6 dB: LSB (a) and
MSB (b).
This intuitively convincing threshold receiver has not been derived from general princi-
ples. It is suboptimum, but, as we shall see, the performance loss compared to the optimum
is not severe. Given a receive symbol yl, the optimum receiver is the one that calculates
the LLR of a certain bit and uses it as the optimum metric for µi = ν(k)
l
to be fed into the
Viterbi decoder. This LLR is given by (see Subsection 3.1.4)
L

c(k)
l
= 0 |yl

= log
#
Pr(c(k)
l
= 0|yl)
Pr(c(k)
l
= 1|yl)
%
.

OFDM
219
The probability Pr(c(k)
l
= c|yl) that the transmitted bit at label k has the value c under the
condition that yl has been received may depend on hard or soft decision values from other
bits c(k′)
l
, k′ ̸= k that are known from the preceding decoding steps. This means that the
constellation points xl may have different a priori probabilities Pr(xl). Let C(k)
0
and C(k)
1
be
the subset of the constellation corresponding to c(k)
l
= 0 and c(k)
l
= 1, respectively, and
p(yl|alxl) =
1
√πN0
exp

−1
N0
|yl −alxl|2

(4.27)
the probability density for yl under the condition that xl was transmitted over a channel
with (ideally known) fading amplitude al. The LLR is then given by
L

c(k)
l
= 0 |yl

= log
#3
xl∈C(k)
0 p(yl|alxl)P (xl)
3
xl∈C(k)
1 p(yl|alxl)P (xl)
%
.
(4.28)
In practice, the maxlog approximation
L

c(k)
l
= 0 |yl

≈max
xl∈C(k)
0
log(p(yl|alxl)P (xl)) −max
xl∈C(k)
1
log(p(yl|alxl)P (xl)).
(4.29)
can be used. If no a priori information is available, Pr(xl) = 1/M for all xl. For this
case – which corresponds to the ﬁrst decoding step – the metric values obtained from the
three different methods (TR, LLR, maxlog) are depicted in Figure 4.58 for M = 4 and
SNR = 6 dB. The maxlog approximation is very close to the optimum and becomes practi-
cally the same for higher SNR values. For the LSB, the maxlog and TR curves are identical.
For the MSB, the TR metrics underestimates the reliability for the most reliable values of
yl.
If – in the next decoding step – hard decision values for the other bits are fed back, we
must set P (xl) = 1/2 for exactly one point in the subset of the constellation corresponding
to c(k)
l
= 0 and for exactly one point in the subset of the constellation corresponding to
c(k)
l
= 1. For all other points, we have Pr(xl) = 0. The LLR is then given by
L

c(k)
l
= 0 |yl

= 2
N0
al(x0
l −x1
l )
#
yl −al
x0
l + x1
l
2
%
.
(4.30)
The distance |x0
l −x1
l |, however, is time varying because the values of the other bits change
for different l. This time-varying distance behaves just like another fading amplitude. The
knowledge of this quantity (if available) occurs in the metric as a multiplicative weighting
factor and improves the performance, just like the knowledge of the channel state informa-
tion for fading channels. Soft outputs of the decoder can be incorporated into the LLR in
a straightforward manner. We will not investigate this further since hard feedback already
gives very good results.
Error probabilities
There is hardly a chance to obtain analytical expressions for error probabilities by using
the rather complicated metric expressions given by Equations (4.28) and (4.29). For the

220
OFDM
threshold metric, the task is easier and we will subsequently see (for the case of 16-QAM)
how error event probabilities can be calculated at least for the AWGN channel.
However, for iterative decoding, error event probabilities for the optimum metric can be
derived by available methods if we assume that all the metric calculations in the second it-
eration step are based on correctly fed back bits from the ﬁrst iteration. In that case, we have
to analyze the metric expression given by Equation (4.30), which is just a decision variable
between two constellation points, but with a multiplicative random variable all with
l = 1
2
))x0
l −x1
l
)) .
If no iterative decoding is applied, one can use union-bound techniques to upper bound
the error event probability by the sum of all pairwise error probabilities that correspond to
the same bit error sequence. This overestimates the error probability, but the overestimate
can be reduced by an expurgated union bound. One can show (Caire et al. 1998) that only
the nearest constellation corresponding to the erroneous bit needs to be taken into account.
For the MSB of the 4-ASK constellation, for example, and the correct transmit symbol
xl = 3δ (MSB = 0), only the nearest neighbor xl = −δ corresponding to the wrong MSB
(MSB = 1) needs to be taken into account, while the event corresponding to xl = −3δ can
be omitted in the sum.
For both the ideal iterative decoding (ID) and the expurgated union-bound (EX) ap-
proach, the pairwise error probabilities P ID/EX
d
corresponding to an error event of Hamming
distance d can be obtained from Equation (2.44). To apply that equation, we must average
over the random variables l. We assume that the l are independent, identically dis-
tributed random variables with respective expectation values EID/EX

{·} for the ID and the
EX case. For ID and EX, the random variable  has its speciﬁc statistics. We obtain the
expression
P ID/EX
d
= 1
π
 π/2
0
EID/EX

 
RK
 1
N0
·
2
sin2 θ
!d
dθ.
(4.31)
We ﬁrst illustrate our result for the example M = 4 (16-QAM) where xl ∈{±δ, ±3δ}.
The bit under consideration is either the MSB b(1)
l
or the LSB b(0)
l , both with the same
probability 1/2. Consider an MSB of value 0. Then xl = +3δ for b(0)
l
= 0 and xl = +δ for
b(0)
l
= 1. For the ID case (b(0)
l
known), the erroneous symbols are ˆxl = −3δ for b(0)
l
= 0
and ˆxl = −δ for b(0)
l
= 1, respectively, corresponding to  = 3δ and  = δ, both with
equal probability. For the EX case, we need to consider only the nearest erroneous symbol,
which is ˆxl = −δ in any case, leading to  = 2δ and  = δ, both with equal probability.
If the bit under consideration is the LSB,  = δ for ID and EX and any value of the MSB.
It follows that  = δ with probability 3/4 (ID and EX) and  = 3δ (ID) or  = 2δ (EX)
with probability 1/4. We thus have
EID

 
RK
2
α2
!
= 3
4RK
 δ2
α2

+ 1
4RK
9δ2
α2

(4.32)
for the ID case and
EEX

 
RK
2
α2
!
= 3
4RK
 δ2
α2

+ 1
4RK
4δ2
α2

(4.33)

OFDM
221
for the EX case. Here we use the abbreviation
α2 := N0 sin2 θ.
Utilizing these expressions, Equation (4.31) can now be easily evaluated numerically.
We now show that, for the AWGN channel, a closed-form expression can be found. For
K →∞, we insert
R∞= exp(−γ )
into Equations (4.32) and (4.33) and expand the dth powers of these expressions using
binomial coefﬁcients, and insert into Equation (4.31). Using again the polar form of the
Gaussian probability integral, we ﬁnally get the formulas
P ID,AWGN
d
=
1
4
d
d

e=0
d
e

3d−e · 1
2 erfc


$
(d + 8e) · δ2
N0


(4.34)
and
P EX,AWGN
d
=
1
4
d
d

e=0
d
e

3d−e · 1
2 erfc


$
(d + 3e) · δ2
N0

.
(4.35)
We note that these expressions can also be obtained without the polar form of the Gaussian
probability integral. We only need some probabilistic analysis. To do so, we consider an
error event where the two code words differ in d positions with time indices l = 1, . . . , d.
The squared Euclidean distance is then given by
4
d

l=1
2
l .
For the ID case, l is a random variable that takes the value i = δ with probability 3/4
and i = 3δ with probability 1/4. We calculate
Pd = El



1
2 erfc


0
1
1
2 1
N0
d

l=1
2
l




,
(4.36)
where El means averaging over all random variables l. To perform the average, we
count all the possible events. Assume the event that a ﬁxed sequence of e symbols with
l = 3δ and d −e symbols with l = δ has been transmitted so that the squared Euclidean
distance equals
d

l=1
2
l = 4(d + 8e)δ2.
(4.37)
There are
d
e

such sequences, and each occurs with probability
 1
4
e  3
4
d−e. Averaging over
all possible sequences, we get Equation (4.34). For the EX case, the same method leads to
Equation (4.35).
Using arguments of the same type, we are now able to derive expression for Pd for the
soft threshold receiver in the AWGN channel for decoding without additional information

222
OFDM
about the other bit(s). Consider an error event where the two code words differ in d
positions. For l = 1, . . . , d, let ξl be the difference of transmit symbol xl to the decision
threshold. For simplicity and without loss of generality, we assume ξl ≥0 for all l. ξl is a
random variable that takes the value ξl = δ with probability 3/4 and the value ξl = 3δ with
probability 1/4. Let ηl be the difference of the receive symbol yl to the decision threshold,
that is, ηl = ξl + nl, where nl is the real AWGN with variance N0/2. Given a ﬁxed transmit
vector, an error occurs if the random variable
Y =
d

l=1
ηl
(4.38)
becomes negative. Assume the event that a ﬁxed sequence of e symbols with ξl = 3δ and
d −e symbols with ξl = δ was transmitted. For such a ﬁxed sequence, Y is a Gaussian
random variable with mean value
µY = e3δ + (d −e)δ = (d + 2e)δ
(4.39)
and variance
σ 2
Y = d N0
2 .
(4.40)
The probability that this random variable becomes negative is given by
P (Y < 0) = 1
2 erfc


$
(d + 2e)2
d
· δ2
N0

.
(4.41)
Averaging over all the
d
e

sequences with their respective probabilities
 1
4
e  3
4
d−e leads
to
P TR,AWGN
d
=
1
4
d
d

e=0
d
e

3d−e · 1
2 erfc


$
(d + 2e)2
d
· δ2
N0

.
(4.42)
Comparing Equations (4.34), (4.35), and (4.42), it follows from
d + 8e ≥(d + 2e)2/d ≥d + 3e
(4.43)
that
P ID,AWGN
d
≤P TR,AWGN
d
≤P EX,AWGN
d
.
(4.44)
We note that the reason the ID receiver is superior compared to TR receiver is because it
makes use of the known value of l as a weighting factor.
We have used these three formulas for Pd in the AWGN channel to obtain union bounds
of the type
Pb ≤
∞

d=dfree
cdPd
(4.45)
for the bit error rate Pb of RCPC coded transmission with the rate 1/3 memory and 6
mother code (133, 171, 145)oct and the error coefﬁcients tabulated by Hagenauer (1988).
Figure 4.59 shows the BER curves for the three bounds and code rates Rc = 8/24, 8/16,

OFDM
223
0
2
4
6
8
10
12
14
16
18
20
10
−8
10
−7
10
−6
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
BER
Rc=8/8
Rc=8/10
Rc=8/12
Rc=8/16
Rc=8/24
16- QAM
AWGN
ID
EX
TR
Figure 4.59
Bit error rates (union bounds) for 16-QAM for different code rates in the
AWGN channel.
8/12, 8/10, and for uncoded transmission. We observe that the three bounds lie very close
together at relevant BER values for code rate 8/16 and higher.
For fading channels, the integral can be evaluated numerically. Figure 4.60 shows the
BER curves in a Rayleigh fading channel for the ID and EX bounds and the same code rates
as above. We note that for this channel, the gap between both curves becomes larger, indi-
cating that iterative decoding may give some noticeable gain in performance. Figure 4.61
shows the same curves for a Ricean channel with Rice factor K = 6 dB. Figure 4.62
shows the ID and EX curves for 64 QAM and the Rayleigh fading channel for code rates
Rc = 8/24, 8/16, 8/12, 8/10. The gap between the ID and EX curves becomes larger than
for 16-QAM. This can be understood from the fact that in a larger constellation, more useful
information can be gained from the successful decoding of the other bits.
The question arises if the ID curves for iteration with ideal knowledge of the other
bits reﬂect a real situation where there can be bit errors that may inﬂuence further iteration
steps. One must also ask how many iterations are necessary. We have carried out numer-
ical simulations for several code rates and several values of M2. Figure 4.63 shows as an
example a simulation for 64-QAM and code rate Rc = 1/2 in comparison with the theoret-
ical ID and EX curves. We have simulated the ﬁrst decoding step without iteration (stars),
and then one additional iterative decoding step using only the decoded hard decision values
for the information from the other bits (circles). A third curve shows the iterative decoding
with ideal knowledge of the other bits (squares). The ﬁrst curve is tightly bounded by the
theoretical EX curve, but there is still an observable gap of about 0.3 dB at Pb = 10−4.
The third curve is extremely tightly bounded by the theoretical ID curve at relevant BERs
(much less than 0.1 dB below Pb = 10−3). The effective gain due to iterative decoding is

224
OFDM
0
2
4
6
8
10
12
14
16
18
20
10
−8
10
−7
10
−6
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
BER
Rc= 8/10
Rc = 8/12
Rc = 8/16
Rc = 8/24
16- QAM
Rayleigh
ID
EX
Figure 4.60
Bit error rates (union bounds) for 16-QAM for different code rates in the
Rayleigh fading channel.
0
2
4
6
8
10
12
14
16
18
20
10
−8
10
−7
10
−6
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
BER
Rc = 8/10
Rc = 8/12
Rc = 8/16
Rc = 8/24
16- QAM
Rice (K = 6 dB)
ID
EX
Figure 4.61
Bit error rates (union bounds) for 16-QAM for different code rates in the
Ricean fading channel (Rice factor K = 6 dB).

OFDM
225
10
12
14
16
18
20
22
24
26
28
30
10
−8
10
−7
10
−6
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
BER
Rc = 8/10
Rc= 8/12
Rc= 8/16
Rc= 8/24
64 QAM
Rayleigh
ID
EX
Figure 4.62
Bit error rates (union bounds) for 64-QAM for different code rates in the
Rayleigh fading channel.
12
13
14
15
16
17
18
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
BER
64-QAM, Rc = 1/2
Rayleigh
No iteration (sim.) 
One iteration (sim.)
Ideal (sim.)
ID bound            
EX bound            
Figure 4.63 Comparison of the theoretical bounds with simulation results for 64-QAM and
Rc = 1/2 and the Rayleigh fading channel.

226
OFDM
0
5
10
15
20
25
30
10
0
10
1
SNR [dB]
Bits per symbol
4-QAM
16-QAM  
64-QAM  
256-QAM
Figure 4.64 SNR needed for BER = 10−5 for different spectral efﬁciencies (bits per sym-
bol) in the AWGN channel.
about 0.5 dB at Pb = 10−4, which seems to be worth enough to carry out this one iteration.
Our most important simulation result is that the second curve with one hard decision iter-
ation lies between these curves at relevant BERs. We conclude that indeed the theoretical
ID curves may serve as a guidance for practical system design for the lowest complexity
iterative decoding with only one hard decision step. For our simulations, we have used
the maxlog approximation of the optimum metric given by Equation (4.29). We have also
simulated the soft threshold receiver (TR) metric that leads to a very slight degradation in
the performance.
We have evaluated the ID bounds for code rates 8/24, 8/23, . . . , 8/9, and for uncoded
transmission to get a diagram of the spectral efﬁciency (in bits per QAM symbol) as a
function of the SNR that is needed for a certain BER. Figure 4.64 shows this diagram
for the AWGN channel and a required Pb = 10−5 and M2 = 4, 16, 64, 256. We note that
the lower-level modulation scheme performs better than the higher-level scheme at almost
all spectral efﬁciencies. At 2 bits per symbol, there is a gain of approximately 2.5 dB for
the rate 1/2 coded 16-QAM compared to the uncoded 4-QAM. But this gain is quite poor
compared to even the simplest TCM schemes. This is not surprising, since BICM does not
maximize the squared Euclidean distance that is needed to get an optimized transmission
scheme for the AWGN channel.
Things become different for the Rayleigh fading channel. Figure 4.65 shows this di-
agram for the Rayleigh channel and a required Pb = 10−4 and M2 = 4, 16, 64, 256. We
observe that 16-QAM performs always better than 4-QAM at the spectral efﬁciencies under
consideration. For 1.33 bits per symbol, the lowest spectral efﬁciency for 16-QAM that can
be achieved with our code family (Rc = 8/24), there is still a gain of approximately 1.6 dB

OFDM
227
0
5
10
15
20
25
30
10
0
10
1
SNR [dB]
Bits per symbol
4-QAM
16-QAM  
64-QAM  
256-QAM
1.33 bits per symbol 
1.6 bits per symbol 
3.2 bits per symbol 
Figure 4.65 SNR needed for BER = 10−4 for different spectral efﬁciencies (bits per sym-
bol) in the Rayleigh fading channel.
compared to 4-QAM with Rc = 8/12. Even without iterative decoding, using the EX bound,
we see from Figure 4.42 that 16-QAM is still at least 1 dB better than 4-QAM. At 1.6 bits
per symbol, that is, 16-QAM with Rc = 8/20 and 4-QAM with Rc = 8/10, the gain of
3.7 dB is even more signiﬁcant. We conclude that it is always favorable to use 16-QAM
instead of 4-QAM for spectral efﬁciencies above 1 bit per symbol. As a rule of thumb we
can state that one should avoid weak codes like Rc = 8/10. It is better to use a higher-level
modulation scheme instead. For example, at 3.2 bits per symbol, 64-QAM with Rc = 8/15
performs 2 dB better than 16-QAM with Rc = 8/10. Even 64-QAM with Rc = 8/16 per-
forms more than 0.5 dB better than 16-QAM with Rc = 8/11 at a slightly better spectral
efﬁciency. We note that 256-QAM has no advantage for less than 5 bits per symbol.
4.5.3
Convolutionally coded QAM with real channel estimation
and imperfect interleaving
Up to now, we have only considered the theoretical performance for the case of ideal
interleaving. For coherent demodulation, we have further assumed perfect knowledge of
the channel, that is, ideal channel estimation. Powerful interleaving requires a sufﬁcient
decorrelation of symbols, that is, an incoherent channel. On the other hand, for coherent
demodulation, the channel must be coherent enough so that the channel estimation with
pilot symbols can work. For differential demodulation, it must be slow enough to allow
the comparison of two subsequent phases. In this section, we concentrate on coherent
demodulation. Differential demodulation will be discussed in a subsequent subsection in
the light of the DAB system.

228
OFDM
OFDM, coding and modulation parameters
We consider an OFDM system with coded QAM and real channel estimation with a Wiener
ﬁlter to see how much is lost due to the frequency and time incoherence of the channel.
Coding and interleaving are included to see the degradations due to the coherency of the
channel. Instead of using the ﬁxed parameters of a speciﬁed system, we consider a scalable
model system deﬁned by the ratios between symbol length, echo length and correlation
time of the channel so that the physical parameter TS of the simulated system is matched
to different applications.
We investigate a standard OFDM transmission system with guard interval . Let T
be the useful symbol duration and TS = T +  the total length of the OFDM symbol. We
concentrate on the popular choice  = T /4, which is used in most existing OFDM system.
For coherent demodulation, we need to insert pilot symbols. The number of carriers K
is chosen to be an integer multiple of 3. For channel estimation, we use a rectangular
grid of pilots as depicted in Figure 4.35. For certain OFDM symbols, pilots are inserted
at every third carrier, that is, at number k = 0, 3, 6, . . . , K −1. A pilot at k = K is added
so that the band is bounded by pilots on both sides. The time distance between two pilots
on the same frequency is given by 4TS, so the pilot density is 1/12 like in DVB-T. All
pilots are boosted to twice the power of the information symbols for which 64-QAM
modulation with conventional gray mapping has been applied. We use the convolutional
code with generators (133, 171)oct (optionally punctured to have higher rates) as described
in Subsection 3.2.1. We use a symbol interleaver in frequency and time direction that
permutes pseudorandomly the QAM symbols of K carriers and L OFDM symbols. Thus,
the interleaving is over a bandwidth B = K/T and a time frame of length TF = LTS. We
use only one big pseudorandom interleaver for both time and frequency together. This is
very natural because OFDM is a 2-D transmission scheme. As discussed in the preceding
subsection, a bit interleaver between the different bit streams of the QAM symbols is also
necessary. This can be rather small compared to the symbol interleaver.
For simplicity, we do not consider iterative decoding. The additional gains due to
iterative decoding have been discussed in Subsection 4.5.2.
Channel parameters
We assume a Rayleigh fading channel with an isotropic (Jakes) Doppler spectrum with
maximum Doppler frequency νmax and exponential delay power spectrum with time constant
τm as discussed in Subsection 4.4.3. The correlation length in time and frequency is deﬁned
by tcorr = ν−1
max and fcorr = τ −1
m , respectively. The guard interval  must be chosen large
enough to guarantee τmax <  for all relevant conditions. For channel estimation for a
given time slot in frequency direction, the Sampling Theorem requires a minimum pilot
distance of 4/T because  = T /4 is the maximum possible delay. Since we have chosen
a distance of 3/T , we have an oversampling factor 4/3. The pilot distance in frequency
direction is 4TS. The maximum Doppler frequency is then limited by the Sampling Theorem
to νmaxTS < 1/8.
For coded transmission in a fading channel, interleaving is indispensable. How much
interleaving is necessary? In Subsection 4.4.3, we discussed the diversity spectrum of the
channel as an indicator to ﬁnd a rule of thumb to answer this question. We have seen that
with interleaving in one (time or frequency) direction only, the interleaving length must

OFDM
229
signiﬁcantly exceed the correlation length, that is, TF ≫tcorr or B ≫fcorr respectively. As a
rule of thumb, we found that a factor of 32 was a reasonable ﬁgure. We have further shown
that the condition B ≫fcorr of a wideband system (wideband relative to the coherency
bandwidth) can only be fulﬁlled for a great number of subcarriers (several hundreds).
Channel estimation
The theoretical background and practical details of channel estimation for OFDM systems
were discussed in Section 4.2. Here we apply the 1-D × 1-D channel estimator, that is, ﬁrst
an 1-D channel estimation will be done in frequency direction and then in time direction (or
vice versa). For 64-QAM – in contrast to QPSK – the edge effects discussed in Section 4.2
are a critical issue. This is due to the fact that the system works at a much higher SNR
level, and residual noise in the channel estimation can severely corrupt the performance.
We propose to use the optimal matrix estimator in frequency direction, that is, we use the
information of all pilots available for the channel estimation of every carrier. We do not
assume that the delay power spectrum is known and design the Wiener estimator for the
case that the echoes are uniformly distributed inside the guard interval. In time direction,
however, there are no edges and the estimator is given by a convolution. Since the Doppler
spectrum can be measured by continual pilots, we assume that νmax is known to the receiver.
The (noncausal) ﬁlter in time direction has chosen to have 16 taps.
Simulation results
Figure 4.66 shows the simulated BER for a wideband OFDM system with K = 1536 and
L = 80 with 16-QAM and Rc = 1/2 in a fast and frequency-selective Rayleigh fading
channel with time variance given by νmaxTS = 0.05 and frequency selectivity given by
τm = /5. Comparing the curves with ideal and real channel estimation (CE) we observe
a loss that is less than 1 dB. We note that this channel is already so fast that it causes a
much more severe performance loss for DQPSK (see Figure 4.52). From this fact, we may
conclude that coherent demodulation is more robust against the time incoherency of the
channel, even if spectrally more efﬁcient higher-level modulation schemes are applied. We
note that the time interleaver with TF = 4tcorr is quite small, but the frequency interleaver
with B = 76.8fcorr guarantees a sufﬁcient interleaving.
We now consider a channel with half the time variance and a small delay spread corre-
sponding to B = 2fcorr. . Such a situation may occur in a typical urban situation. Figure 4.67
shows the simulation for that channel with all other parameters being left unchanged. Even
though the code cannot fully exploit its diversity for that channel (see Subsection 4.4.3), the
degradations for the ideal CE curve are quite small. With real CE the performance becomes
even better because the channel estimator takes proﬁt from the higher coherency of the
channel. However, the insufﬁcient interleaving severely inﬂuences the error structure. To
show this, we have plotted the error rates of the individual frames. Comparing Figures 4.68
and 4.69, we see that the error rates (real CE) in one frame for the ﬁrst channel vary at least
by a factor of 2, but for the second one there is a variation by a factor of 100. Depending
on the application, this may lead to severe performance losses. This will be the case for a
concatenated coding system with an outer block code, as it is applied in the DVB-T system.
We have seen that a channel with νmaxTS = 0.05 does not cause severe problems to
the channel estimation. However, this is more than a factor of 2 below the threshold 1.25

230
OFDM
0
5
10
15
20
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
BER
nmaxTS= 0.05 tm/∆= 0.2
B/fcorr=76.8
TF/tcorr= 4
K = 1536, L = 80
OFDM with 16-QAM and Rc = 0.5
CE ideal
CE real
Figure 4.66
Simulation of a wideband OFDM system with 16-QAM for a fast and
frequency-selective channel.
0
5
10
15
20
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
BER
nmaxTS = 0.025 tm/∆= 0.00521  B/fcorr= 2 TF/t corr = 2
K = 1536, L = 80
OFDM with 16-QAM and Rc= 0.5
CE ideal
CE real
Figure 4.67 Simulation of a wideband OFDM system with 16-QAM for a moderately fast
and frequency nonselective channel.

OFDM
231
0
5
10
15
20
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
BER
nmaxTS = 0.05 tm/∆ = 0.2 B/fcorr = 76.8 TF/tcorr= 4
K = 1536, L = 80
OFDM with 16-QAM and Rc= 0.5
CE ideal
CE real
Figure 4.68 The BERs for Figure 4.66 for the individual frames.
0
5
10
15
20
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
BER
νmaxTS= 0.025 tm/∆ = 0.00521  B/fcorr= 2 TF/tcorr= 2
K = 1536, L = 80
OFDM with 16-QAM and Rc= 0.5
CE ideal
CE real
Figure 4.69 The BERs for Figure 4.67 for the individual frames.

232
OFDM
0
5
10
15
20
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
BER
nmaxTS = 0.1 τm/∆ = 0.2
B/fcorr= 76.8 TF /tcorr= 8
K = 1536, L = 80
OFDM with 16- QAM and Rc = 0.5
CE ideal
CE real
Figure 4.70 Simulation of a wideband OFDM system with 16-QAM for a very fast and
frequency-selective channel.
given by the Sampling Theorem. We may now ask how fast the channel can be before the
channel estimation fails to work. Figure 4.70 shows a simulation for νmaxTS = 0.1 with
all other parameters being the same as in Figure 4.66. Now the degradation relative to the
ideal CE that is due to time incoherency increases from one to approximately 2 dB which
seems to be tolerable.
We now consider 64-QAM. Figure 4.71 shows a 64-QAM simulation with all other
parameters being the same as in Figure 4.66. We observe that the difference between ideal
and real CE is not much more than 1 dB. We conclude that 64-QAM can be used in this
quite fast channel, where DQPSK already suffers severely from time incoherency.
However, it is not surprising that 64-QAM is less robust than 16-QAM. Figure 4.72
shows a 64-QAM simulation with νmaxTS = 0.07 with all other parameters being the same
as in Figure 4.66. The degradations due to time incoherency are now between 3 and 4 dB.
The ideal CE curves of these two 64-QAM simulation of an OFDM system with fast fading
are the same as the 64-QAM curve of Figure 4.63 for an ideal Rayleigh channel. This means
that the loss of orthogonality due to fast fading is practically not relevant.
We ﬁnally look at an OFDM system with a relatively low number of carriers, which is
therefore not a wideband system compared to the coherency bandwidth of the channel. We
choose K = 48 (the same number as for the WLAN systems) L = 80 and νmaxTS = 0.01.
With B = 0.5fcorr and TF = 0.8tcorr, the interleaving is rather poor. Figures 4.73 and 4.74
show the performance curves. Figure 4.73 shows that there is a loss of about 3 dB due to
poor interleaving. More important is the extreme variation of the BER in the individual
frames, as depicted in the second ﬁgure.

OFDM
233
0
5
10
15
20
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
BER
νmaxTS=0.05
τm/∆=0.2    B/fcorr=76.8   TF/tcorr=4
K = 1536, L = 80
OFDM with 64- QAM and Rc=0.5
CE ideal
CE real
Figure 4.71
Simulation of a wideband OFDM system with 64-QAM for a fast and
frequency-selective channel.
0
5
10
15
20
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
BER
nmaxTS = 0.075 tm/∆ = 0.2 B/fcorr= 76.8 TF/tcorr= 6
K = 1536, L = 80
OFDM with 64- QAM and Rc = 0.5
CE ideal
CE real
Figure 4.72 Simulation of a wideband OFDM system with 64-QAM for a very fast and
frequency-selective channel.

234
OFDM
0
5
10
15
20
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
BER
nmaxTS = 0.01 tm/∆ = 0.0417 B/fcorr = 0.5 TF/tcorr = 0.8
K = 48, L = 80
OFDM with 16- QAM and Rc= 0.5
CE ideal
CE real
Figure 4.73 Simulation of narrowband OFDM for a slow and ﬂat channel.
0
5
10
15
20
10
−4
10
−3
10
−2
10
−1
10
0
SNR [dB]
BER
nmaxTS = 0.01 tm/∆= 0.0417 B/fcorr= 0.5 TF/tcorr = 0.8
K = 48, L = 80
OFDM with 16- QAM and Rc = 0.5
Figure 4.74 Simulation of narrowband OFDM for a slow and ﬂat channel.

OFDM
235
Power efﬁciencies
To compare power efﬁciencies, we look at the BERs at a given Eb/N0 instead of the SNR.
As discussed in Subsection 4.1.4, for an OFDM system with analysis window T and total
symbol length TS , code rate Rc and M2-QAM, both are related by
SNR = T
TS
ES
N0
= T
TS
Rc log2(M2)Eb
N0
.
In this formula, the loss of useful energy due to the pilot symbols has not yet been taken into
account. For pilots with the same energy ES (without boosting), only 11 of 12 transmitted
symbols carry useful information, that is, ES = 11
12Rc log2(M2)Eb. If the pilots are boosted
by a factor of two, we transmit the energy 13 ES of 13 symbols, but only 11 of them are
useful, that is, ES = 11
13Rc log2(M2)Eb, which leads to
SNR = T
TS
ES
N0
= 11
13
T
TS
Rc log2(M2)Eb
N0
.
From this equation, we conclude that the SNR curves11 for Rc = 1/2 have to be shifted by
• 1.69 dB for 4-QAM
• −1.31 dB for 16-QAM
• −3.08 dB for 64-QAM
From Figure 4.66, we conclude that a BER of 10−4 can be reached at Eb/N0 ≈10.5 dB for
ideal CE and at Eb/N0 ≈11.5 dB for real CE. We want to compare this with the DQPSK
curves and Rc = 1/2 curves that are presented in Subsection 4.4.1. Because of the guard
interval, the SNR curves depicted there must be shifted by 1 dB to the right to obtain the
curves for Eb/N0. From Figure 4.50, we conclude that Eb/N0 ≈11.5 dB is needed for
a BER of 10−4 for ideal channel coherency between two adjacent symbols. This is 1 dB
worse than 16-QAM with ideal CE. From Figure 4.52, we see that for a fast fading channel
with νmaxTS = 0.05, we need Eb/N0 ≈13.5 dB to reach that error rate. This is 2 dB worse
than 16-QAM with real CE under the same condition. Thus, 16-QAM performs signiﬁcantly
better than DQPSK at nearly12 twice the spectral efﬁciency.
4.5.4
Antenna diversity for convolutionally coded QAM multicarrier
systems
As we have seen in the preceding subsection, the performance of a coded multicarrier
system can suffer severely from nonsufﬁcient interleaving, which means that the code
cannot exploit its diversity as the diversity degree of the channel is too small. A remedy is
the use of antenna diversity in addition to the existing channel coding. This can be done
at the receiver or, for example, by using the Alamouti scheme, at the transmitter. We will
investigate the question of how diversity can improve the performance of a convolutionally
coded multicarrier QAM system as described in the preceding subsections.
11We note that this SNR in the abscissae of the ﬁgures must be understood as the SNR for the QAM symbols
(after the OFDM demodulator), which is the relevant quantity for the BER performance. As a consequence of the
boosting, the SNR on the analog physical channel is higher by a factor of 13/12. ES is the energy of one useful
transmit symbol including the guard interval.
12The spectral efﬁciency is slightly below two bits per complex symbol because of the pilots.

236
OFDM
Receive antenna diversity
We ﬁrst consider receive antenna diversity. As discussed in Subsection 2.4.5, the vector
r = (r1, . . . , rL)T of receive symbols rl at the L different antennas can be written as
r = sc + n,
where s is the QAM symbol and the channel vector c with Ricean fading coefﬁcients cl
given by
c = (c1, . . . , cL)T
and n is L-dimensional complex AWGN with variance σ 2 = N0 in each (complex) di-
mension. As discussed in that subsection, the maximum ratio combiner (MRC) acts on the
receive vector by calculating the complex scalar product
c†r = |c|2 s + c†n.
By using a sufﬁcient statistics argument, we have seen that this MRC output provides
us with the full information that is necessary for an optimal symbol decision on s. It
can be shown (Problem 4) that c†n is the one-dimensional complex AWGN with variance
σ 2 = |c|2 N0. It is therefore convenient to renormalize that equation and divide it by
a =

a2
1 + · · · + a2
L,
(4.46)
where al = |cl| is the absolute value of the lth fading coefﬁcient. This leads to the equation
a−1c†r = as + a−1c†n.
We deﬁne
u = a−1c†r
as the normalized MRC output and write
u = as + n.
(4.47)
Now, n is the one-dimensional complex AWGN with variance σ 2 = N0. This receiver
is depicted in part (a) of Figure 4.75. This equivalent fading channel model as depicted
in part (b) of that ﬁgure is convenient because now we have only one composed real-
fading coefﬁcient amplitude a given by Equation (4.46) corresponding to the power sum of
the individual diversity branches. For square QAM constellations, it is convenient to split
up the real and imaginary parts of Equation (4.47) and work with a real-valued channel
model. Now u is the input of a metric computation unit as described in Subsection 4.5.2.
For convolutionally coded QAM and an error event of Hamming distance d, we may now
apply the formalism introduced in that subsection to a channel described by Equation (4.49).
We then note that a is already a composed fading amplitude of L diversity branches. As a
consequence, we must replace d by dL in the formulas for the error probabilities derived
in that subsection.

OFDM
237
r1
r2
a−1 =

|c1|2 + |c2|2−1
c∗
1
c∗
2
(a)
(b)
a
s
n
u
u
Figure 4.75 Equivalent diversity channel model.
Transmit antenna diversity
We now consider Alamouti’s twofold transmit antenna diversity. As shown in Subsec-
tion 2.4.7, the receive symbol vector r = (r1, r2)T for the symbols r1 and r2 received at
the two time slots can be written as
r = Cs + n.
s = (s1, s2)T is a pair of complex (QAM) symbols, n is complex two-dimensional AWGN
with σ 2 = N0 in each (complex) dimension. The fading channel is described by the matrix
C =

c1
c2
−c∗
2
c∗
1

.
The fading coefﬁcients c1 and c2 correspond to the two transmit antennas. As discussed in
that subsection, the Alamouti diversity combiner acts on the receive vector by calculating
C†r =
|c1|2 + |c2|2
s + C†n.

238
OFDM
This is due to the property
C†C =
|c1|2 + |c2|2
I2.
Again, we argue that the combiner output provides us with the full information that is
necessary for an optimal symbol decision on s. This is evident because C just acts as a
rotation on the signal vector, together with a real multiplicative factor. We may also ﬁnd a
sufﬁcient statistics argument: the two rows of C are an orthogonal transmit base (not yet
normalized) and thus the components of C†r are (up to a factor) the components of r in the
direction of those base vectors. It can be shown (Problem 5) that C†n is two-dimensional
complex AWGN with variance σ 2 =
|c1|2 + |c2|2
N0 in each dimension. It is therefore
convenient to renormalize that equation and divide it by
a =

a2
1 + a2
2,
(4.48)
where al = |cl| is the absolute value of the lth fading coefﬁcient. This leads to the equation
a−1C†r = as + a−1C†n.
We deﬁne
u = a−1C†r
as the normalized combiner output and write
u = as + n.
(4.49)
Now n is the two-dimensional complex AWGN with variance σ 2 = N0 in each dimension.
We may split up this vector equation into two scalar equations
u1 = as1 + n1
and
u2 = as2 + n2.
Obviously, each of the two QAM symbols s1 and s2 is affected by the same transmission
channel given by Equation (4.47), where we have to set L = 2 in Equation (4.46). Thus,
both setups are equivalent.
In the two preceding subsections, we have discussed convolutionally coded QAM trans-
mission. The transmission channel for each QAM symbol was also of the form given by
Equation (4.47), but with a fading amplitude a with Rayleigh or Ricean statistics. Here, a
is a composed fading amplitude given by Equation (4.48), where each of both components
has such a statistics. Let us assume that the fading amplitudes a1 and a2 are identical inde-
pendent random variables. Then, since the performance depends on the sum of all squared
fading amplitudes, we conclude that twofold antenna diversity just doubles the diversity
degree for each error event. Thus, we then have to replace Pd by P2d in the union bound
and write
Pb ≤
∞

d=dfree
cdP2d.
We note that at the Viterbi decoder input, the combiner output has to be weighted with the
composed fading amplitude.

OFDM
239
The transmission scheme
Our goal is to combine Alamouti’s transmit diversity scheme with OFDM and convolu-
tionally coded QAM. The transmit diversity will be implemented in time direction on each
subcarrier for a pair of subsequent OFDM symbols. Let sl[k] = skl denote the complex
QAM symbols with time index l = 1, 2. For each frequency index k, the symbols will be
multiplexed to the two transmit antennas TX1 and TX2 according to Table 4.1. In prin-
ciple, the OFDM signal generation by IFFT will then have to be done for both antennas
and for the two time slots, that is, four IFFTs of length N have to be performed. However,
because of well-known Fourier transform relations, only two transforms are necessary. Let
us write xl[n] for the time domain signal (i.e. the IFFT) corresponding to the frequency
domain signal values sl[k]. Then the transmit diversity multiplexer in the time domain
can be written as shown in Table 4.2. Thus, only two IFFTs must be performed during
two time slots and the Alamouti transmit diversity scheme combined with OFDM does
not require additional IFFT computation complexity. After multiplexing, the guard interval
has to be inserted to the four signals of Table 4.2. After digital-to-analog conversion, the
signals of the two branches will be sent to the respective antennas. The complete system
setup is shown in Figure 4.76. The data bits will be encoded by a standard convolutional
encoder of constraint length 7 with generators (133, 171)oct. Optionally, higher code rates
can be obtained by puncturing. The coded bit stream is interleaved by a block interleaver
that performs a random interleaving over log2(M)I bits, corresponding to I complex QAM
symbols and I/K OFDM symbols, where K is the number of OFDM subcarriers. The block
of interleaved bits are mapped on the M−QAM symbols with conventional Gray mapping.
Table 4.1
Transmit diversity multiplexer in
the frequency domain
Antenna
TX1
TX2
Time slot l = 1
s1[k]
s2[k]
Time slot l = 2
s∗
2[k]
−s∗
1[k]
Table 4.2
Transmit diversity multiplexer in
the time domain
Antenna
TX1
TX2
Time slot l = 1
x1[n]
x2[n]
Time slot l = 2
x∗
2[N −n]
−x∗
1[N −n]
encoder
Convol.
leaver
Inter-
QAM
mapper
IFFT
Antenna
MUX
TX1
TX2
Figure 4.76 System setup block diagram.

240
OFDM
The complex QAM symbols will be processed blockwise by an IFFT device of FFT length
N (N ≥K), resulting into a stream of complex time domain samples that are grouped into
vectors xi[n], n = 0, 1, . . . , N −1 of length N, each corresponding to one OFDM symbol
numbered by i. These vectors are grouped into pairs, and each pair is processed by the
transmit diversity multiplexer according to Table 4.2. After this antenna multiplexing, the
guard interval will be inserted separately to the resulting OFDM symbols for the respective
antennas.
We note that if we switch off TX2, except for the complex conjugate in the second sym-
bol, our setup is just a standard transmission setup like it is used in the standards of DVB-T,
HIPERLAN/2 and DRM (with some modiﬁcations concerning the QAM modulation).
Channel simulations
We denote the OFDM symbol duration by TS = T + , where T is the useful OFDM
symbol duration, and  = T /4 is the guard interval. We simulate a time and frequency-
selective Rayleigh fading channel with an isotropic Doppler spectrum with maximum shift
±νmax and an exponential delay power spectrum characterized by the delay spread τm.
The time variance of the channel is characterized by νmaxTS, the frequency variance by
τmB, where B = K/T is the transmission bandwidth. For a ﬁxed ratio τm/, and because
T = 4, the number of carriers K can directly be regarded as a measure for the frequency
selectivity.
Fast fading corresponding to high values of νmaxTS may cause degradations because the
complex channel amplitudes vary too much over two time slots. On the other hand, slow
(small νmaxTS) and ﬂat (small K) fading may cause insufﬁcient interleaving.
In our simulations, we always assume ideal channel estimation. We consider a channel
with moderate (but not extremely small) delay spread compared to the guard interval with
τm = 0.2 = TS/20.
First, we assume a moderately fast fading channel with νmaxTS = 0.01 for which coded
QAM systems are known to work well (see above).
Figure 4.77 shows the BER as a function of Eb/N0 for such a channel and 16-QAM
transmission with code rate Rc = 1/2 and a huge time and frequency interleaving over the
bandwidth of K = 768 carriers and the time of I/K = 360 OFDM symbols. The curves ﬁt
well to the union bounds for the ideally interleaved Rayleigh channel. Here, we have used
the expurgated union bounds as described in Subsection 4.5.2. The gain due to antenna
diversity lies between 1 and 2 dB in the region of interest, which is much smaller than in
the uncoded case (see Figure 2.12).
Figure 4.78 shows the performance curve for the same channel with a small relative
bandwidth (K = 48) and no time interleaving. This system, which can be compared with
a HIPERLAN/2 system, shows severe degradations of 5.5 dB at BER = 10−4 because of
insufﬁcient interleaving if no diversity has been applied. We conclude that such a low
number of carriers means that the OFDM system is a narrowband system compared to
the channel. Figure 4.78 shows that only one additional transmit antenna can compensate
approximately 4 dB of that narrowband loss. If we increase the bandwidth by a factor of
16 to K = 768, similar simulations show that the interleaving only in frequency direction
means only a loss of 0.8 dB for one TX antenna and 0.4 dB for 2 TX antennas. We may
call this a wideband system. However, smaller values of τm will cause severe degradations
and antenna diversity would be very helpful in such situations.

OFDM
241
0
2
4
6
8
10
12
14
16
18
20
10
−4
10
−3
10
−2
10
−1
10
0
Eb/N0 [dB]
BER
nmaxTS = 0.01, tm/TS = 0.04
K = 768, I/K = 360
Tx- diversity
No diversity
Union bounds
Figure 4.77 Bit error rates for the coded system with and without diversity for νmaxTS =
0.01 and τm/ = 0.2 (huge interleaver).
0
2
4
6
8
10
12
14
16
18
20
10
−4
10
−3
10
−2
10
−1
10
0
Eb/N0 [dB]
BER
nmaxTS = 0.01, tm/TS = 0.04
K = 48, I/K = 1
Tx- diversity
No diversity
Union bounds
Figure 4.78 Bit error rates for the coded system with and without diversity for νmaxTS =
0.01 and τm/ = 0.2 (small interleaver).

242
OFDM
0
2
4
6
8
10
12
14
16
18
20
10
−4
10
−3
10
−2
10
−1
10
0
Eb/N0 [dB]
BER
nmaxTS = 0.05, tm/TS= 0.04
K = 768, I/K = 360
Tx- diversity
No diversity
Union bounds
Figure 4.79 Bit error rates for the coded system with and without diversity for νmaxTS =
0.05 and τm/ = 0.2 (huge interleaver).
Figure 4.79 shows a simulations with the same parameters as in Figure 4.77, but with
a fast fading channel with νmaxTS = 0.05. In that case, the time variance of the channel
causes a coherency loss between the two symbols, which is so severe that the diversity
system performs worse than the one antenna system. This sensitivity to time variance must
be carefully considered by designing a transmit diversity system.
We ﬁnally recall that (except the sensitivity to time variance) a two transmit antenna
diversity system is equivalent to a two receive antenna diversity system if the performance
curves are drawn as functions of Eb/N0. This means that Figures 4.77 and 4.78 are also
valid for a two receive antenna system.
4.6
OFDM System Examples
4.6.1
The DAB system
The European DAB system (EN300401 2001a) uses OFDM with differential QPSK mod-
ulation together with punctured convolutional codes as described in the preceding section.
As already discussed in detail, the OFDM parameters must be carefully adjusted to the
requirements of the channel. A long symbol length TS with a long guard interval 
makes the system robust against long echoes, but sensitive against high Doppler fre-
quencies. To achieve a certain ﬂexibility in service planning, four different transmission
modes have been deﬁned (see Table 4.3). In this table, a time unit ts = f −1
s
=
1
2048 ms

OFDM
243
Table 4.3
The OFDM parameters for the four DAB transmission modes
Mode
K
T −1
TS

Max. frequency
TM I
1536
1 kHz
2552 ts ≈1.246 ms
504 ts ≈246 µs
≈375 MHz
TM IV
768
2 kHz
1276 ts ≈623 µs
252 ts ≈123 µs
≈750 MHz
TM II
384
4 kHz
638 ts ≈312 µs
126 ts ≈62 µs
≈1500 MHz
TM III
192
8 kHz
319 ts ≈156 µs
63 ts ≈31 µs
≈3000 MHz
has been introduced. The frequency fs = 2048 kHz is the sampling frequency if the
smallest possible (power of two) FFT length will be used for each transmission mode.
Thus, the integer numbers in the third and fourth column correspond to the number of
samples.
Transmission mode I with the very long guard interval of nearly 250 µs has been
designed for large-area coverage, where long echoes are possible. It is suited for single
frequency networks (Hoeg and Lauterbach 2003) with long artiﬁcial echoes; 200 µs cor-
respond to a distance of 60 km, which is a typical distance between transmitters. If all
transmitters of the same coverage area are exactly synchronized and send exactly the same
OFDM signal, no signal of relevant level and delay longer than the guard interval should be
received. Since the OFDM symbol length TS is very long, transmission mode I is sensitive
against rapid phase ﬂuctuations and should only be used in the VHF region.
Transmission mode II can cope with echoes that are typical for most topographical
situations. However, in mountainous regions, problems may occur. This mode is suited for
VHF/UHF transmission as well as for transmission in the L-band at 1.5 GHz.
Transmission mode III has been designed for satellite transmission. It may be suited
also for terrestrial coverage, if no long echoes are to be expected.
The parameters of TM IV lie just between mode I and II. It was included later in the
speciﬁcation to take into account the special conditions of the broadcasting situation in
Canada. It will be used there even at 1.5 GHz. This is possible for limited vehicle speed
and a direct line of sight, so that a Ricean channel (instead of a Rayleigh channel) can be
assumed.
The transmission modes have different numbers of subcarriers within the same band-
width of approximately 1.5 MHz, and thus different carrier spacings and symbol lengths.
The maximum transmit frequency in the last column of the table corresponds to the
Doppler frequency that leads to νmaxTS = 0.05 for a vehicle speed of 120 km/h. As we
have seen in Subsection 4.5.1, in a Rayleigh fading channel this value already leads to a
signiﬁcant performance degradation for DQPSK modulation and should therefore not be
exceeded.
The OFDM signal has K modulated subcarriers at frequencies fk = k/T , with subcar-
rier index k ∈{±1, ±2, ±3, . . ., ±K/2}. The center subcarrier corresponding to the DC
component in the complex baseband signal is not modulated for reasons of receiver im-
plementation. For all transmission modes, the spacing between the highest and the lowest
subcarrier is exactly fK/2 −f−K/2 = 1536 kHz. For transmission mode I, the Fourier anal-
ysis window is T = 1 ms. The carrier spacing is T −1 = 1 kHz. The minimum FFT length
for transmission mode I that is a power of two is NFFT = 2048, that is, the smallest power
of two that is larger than the number of subcarriers K = 1536. The total OFDM symbol

244
OFDM
length is given by TS = 2552 ts ≈1.246 ms. The guard interval length is  = 504 ts ≈246
ms. Thus, we have the ratio T /TS ≈0.8. This means that loss in spectral power and spec-
tral efﬁciency due to the guard interval is approximately 20%. The OFDM parameters for
transmission modes IV, II, III (in that order13) can be derived from those of transmis-
sion mode I by successively halving all time periods and the FFT length and doubling all
frequencies.
Transmission frames
For each transmission mode, a transmission frame is deﬁned on the physical signal level as
a periodically repeating set of OFDM symbols. It fulﬁlls certain tasks for the data stream.
It is an important feature of the DAB system (and in contrast to the DVB system) that the
time periods on the physical level and on the logical (data) level are matched together. The
period TF of the transmission frame is either the same as the audio frame length of 24 ms or
an integer multiple of it. As a consequence, the audio data stream does not need its own syn-
chronization. This ensures a better synchronization stability especially for mobile reception.
The structure for TM II is the simplest and will thus be described ﬁrst. The frame length
is 24 ms. The ﬁrst two OFDM symbols of the transmission frame build up the synchroniza-
tion channel (SC). The next three OFDM symbols carry the data of the fast information
channel (FIC) that contains information about the multiplex structure and transmitted pro-
grammes. The next 72 OFDM symbols carry the data of the main service channel (MSC).
The MSC carries useful information, such as audio data or other services. Figure 4.80
shows the transmission frame structure. This ﬁgure is also valid for TMs I and IV, but the
respective frame lengths are different.
All the OFDM symbols in a transmission frame of TM II have the same duration
TS = 638 ts ≈312 µs, except the ﬁrst one. This so-called null symbol of length TNull =
664 ts ≈324 µs is to be used for rough time synchronization. The signal is set to zero (or
nearly to zero) during this time to indicate the beginning of a frame on the physical layer.
The second OFDM symbol of the SC is called the TFPR (Time-Frequency-Phase Reference)
symbol. The complex Fourier coefﬁcients sk of that OFDM symbol have been chosen in a
sophisticated way so that it serves as a frequency reference as well as for echo estimation
for the ﬁne tuning of the time synchronization to ﬁnd the position of the Fourier analysis
window. Furthermore, it is the start phase for the differential phase modulation. Each of the
following OFDM symbols carries 384 DQPSK symbols corresponding to 768 bits (including


MSC 1
MSC 2
MSC 3
FIC 1
FIC 2
FIC 3
TFPR
Null
MSC 72
MSC 71
96 ms (TM I) or 48 ms (TM IV) or 24 ms (TM II)
Figure 4.80 The DAB transmission frame.
13This seemingly strange order is due to the fact that TM IV, which lies between I and II, has been introduced
subsequently.

OFDM
245
redundancy for error protection, see the following text). The three OFDM symbols of the
FIC carry 2304 bits. Since they are highly protected with a rate Rc = 1/3 code, only 768
data bits remain. The FIC data of each transmission frame can be decoded immediately
without reference to the data of other transmission frames, because this most important
information must not be delayed. The 72 OFDM symbols of the MSC carry 55,296 bits,
including error protection. This corresponds to a (gross) data rate of 2.304 Mbit/s. The
data capacity of 55,296 bits in each 24 ms time period is divided into 864 capacity units
(CUs) of 64 bits. In the MSC, several audio programmes and other useful data services are
multiplexed together. Since each of them has its own error protection, it is not possible to
deﬁne a ﬁxed net data rate of the DAB system.
The transmission frames of TMs IV and I, respectively, have exactly the same structure.
Since the OFDM symbols are longer by a factor of two or four, respectively, the transmis-
sion frame length is 48 or 96 ms. The number of bits in the FIC and MSC increases by the
same factor, but the data rate is always the same.
For TM III, the frame duration is TF = 24 ms. Eight OFDM symbols carry the FIC,
and 144 OFDM symbols carry the MSC. The data rate of the FIC is higher by a factor of
4/3 compared to the other modes. The MSC always has the same data rate.
For all four transmission modes, the MSC transports 864 CUs in 24 ms. There is a
data frame of 864 CUs = 55,296 bits common for all transmission modes, which is called
the common interleaved frame (CIF). For TMs II and III, there is exactly one CIF inside
the transmission frame. For TM I, there are four CIFs inside one transmission frame of
96 ms. Each of them occupies 18 subsequent OFDM symbols of the MSC. The ﬁrst is
located in the ﬁrst 18 symbols, and so on. For TM IV, there are two CIFs inside one
transmission frame of 48 ms. Each of them occupies 36 subsequent OFDM symbols of the
MSC.
Channel coding
The DAB system allows great ﬂexibility in the choice of the proper error protection for
different applications and for different physical transmission channels. Using RCPC codes
introduced by (Hagenauer, 1988), it is possible to use codes of different redundancy without
the necessity for different decoders. One has a family of RCPC codes originated by a
convolutional code of low rate that is called the mother code. The daughter codes will be
generated by omitting speciﬁc redundancy bits. This procedure is called puncturing. The
receiver must know which bits have been punctured. Only one Viterbi decoder for the
mother code is necessary.
The RCPC code family is the one that we have already discussed in detail in Subsec-
tion 4.5.1. It is based on the rate Rc = 1/4 code deﬁned by the generators (133, 171, 145,
133) in octal notation. For RCPC codes, it is possible to switch the code rate even inside
the same data stream. Thus, RCPC codes offer the possibility of unequal error protection
(UEP) of a data stream: some bits in the data stream may require a very low BER, others
may be less sensitive against errors. Using RCPC codes, it is possible to save capacity
and add just as much redundancy as necessary. UEP is especially useful for audio data.
Figure 4.81 illustrates the idea by an example of a 192 kbit/s audio data stream. The inverse
code rate R−1
c
is drawn as a function of the bit index inside the frame. Thus, the area inside
the rectangles corresponds to the number of encoded bits. It is quite obvious from the pic-
ture that it is very efﬁcient to use UEP because the group of bits with the weakest code is

246
OFDM
Bit index
1/Code rate
Subband samples
Scale factors 
code rate 
8/18
code rate 8/14
code rate 8/24
Header
CRC, PAD
code rate 8/19
Figure 4.81 Example for an error protection proﬁle for the audio data rate 192 kbit/s.
by far the biggest one. The ﬁrst bits inside a frame are the header, the bit allocation (BAL)
table, and the scale factor select information (SCFSI). An error in this group would make
the whole frame useless. Thus, it is necessary to use a strong (low-rate) code here. The
next group consists (mainly) of scale factors. Errors will cause annoying sounds (so-called
birdies), but these can be concealed up to a certain point on the audio level if they are
detected by a proper mechanism. The third group is the least sensitive one. It consists of
subband samples. Subband sample errors cause a kind of gurgling sound. Often this will not
even be noticed in a noisy car environment. A last group consists of programme-associated
data (PAD) and the cyclic redundancy check (CRC) for error detection in the scale fac-
tors (of the following frame). This group requires approximately the same protection as
the second one. The distribution of the redundancy over the audio frame deﬁnes such an
error protection proﬁle. For DAB audio transmission, 64 different protection proﬁles have
been speciﬁed (ETS 300 401) that correspond to different audio data rates from 32 kbit/s
and 384 kbit/s and allow 5 different protection levels from PL1 (the strongest) to PL5 (the
weakest) corresponding to ﬁve average code rates. Each of them requires (approximately)
the same SNR for distortion-free audio reception. Table 4.4 gives the detailed deﬁnition
of the protection proﬁle corresponding to Figure 4.81. The last column shows the number
of encoded bits. Note that for each frame, the trellis will be closed by tail bits. These are
Table 4.4
Example for an error protection proﬁle proﬁle
(PL3) for the audio data rate 192 kbit/s
Audio data bits
Code rate
Encoded bits
Group 1
352
Rc = 8/24
1056
Group 2
768
Rc = 8/18
1758
Group 3
3392
Rc = 8/14
5936
Group 4
96
Rc = 8/19
228
Tail bits
6
Rc = 8/16
12

OFDM
247
always six zero bits that are encoded by Rc = 1/2. In this example, the total number of
encoded bits per frame is 8960. This corresponds to 140 capacity units of 64 bits (see the
following table).
For data transmission, eight different protection levels with equal error protection (EEP)
have been speciﬁed with code rates Rc = 1/4, Rc = 3/8, Rc = 4/9, Rc = 1/2, Rc = 4/7,
Rc = 3/4, and Rc = 4/5. The code rates 3/8 and 3/4 are constructed by a composition of
two adjacent RCPC code rates. The EEP protection proﬁles allow ﬁxed data rates that are
integer multiples of 8 kbit/s or 32 kbit/s.
The paper (Hoeher et al. 1991) gives some insight into how the channel coding for
DAB audio has been developed. It reﬂects the state of the research work on this topic a
few months before the parameters were ﬁxed.
We ﬁnally note that the UEP protection proﬁles for audio have been designed in such a
way that one has a kind of graceful degradation. This means that if the reception becomes
worse, the listener ﬁrst hears the gurgling sound from the sample errors before the reception
is lost. These errors can be noticed at a BER slightly above 10−4 with headphones in a
silent environment. In the noisy environment of a car, up to 10−3 may be occasionally
tolerated.
Multiplexing
All the UEP and EEP channel coding proﬁles are based on a frame structure of 24 ms. These
frames are called logical frames. They are synchronized with the transmission frames, and,
for audio data subchannels, with the audio frames. At the beginning of one logical frame,
the coding starts with the shift registers in the all-zero state. At the end, the shift register will
be forced back to the all-zero state by appending six additional bits (tail bits) to the useful
data for the traceback of the Viterbi decoder. After encoding, such a 24 ms logical frame
builds up a punctured code word. It always contains an integer multiple of 64 bits, which
is an integer number of CUs. Whenever necessary, some additional puncturing is done to
achieve this. A data stream of subsequent logical frames that is coded independently of
other data streams is called a subchannel. For example, an audio data stream of 192 kbit/s is
such a possible subchannel. A PAD data stream is always only a part of a subchannel. After
the channel encoder, each subchannel will be time-interleaved independently as described
in the next subsection. After time interleaving, all subchannels are multiplexed together
into the MSC (see Figure 4.82 for an example). There is an elementary 24 ms time period
in the MSC that is called a common interleaved frame (CIF). For TM II and TM III, each
transmission frame carries one CIF. For TM I and TM IV, each transmission frame carries
four or two subsequent CIFs, respectively.
The multiplex conﬁguration of the DAB system is extremely ﬂexible. For each subchan-
nel, the appropriate source data rate and the error protection can be individually chosen.
The total capacity of 864 will be shared by all these subchannels. Table 4.5 shows an
example (taken from reality) of how the capacity may be shared by different subchannels
(which are loosely called programmes in that table).
Time interleaving
For DAB, time and frequency interleaving has been implemented. To spread the coded bits
over a wider time span, time interleaving is applied for each subchannel. It is based on the

248
OFDM
Audio
encoder 1
Channel
encoder 1
interleaver
Time
Audio
Channel
encoder 2
encoder 2
Time
interleaver
Subch 1
Subch 2
Time
interleaver
Subch n
Channel
encoder n
encoder
Data
Multiplexer
MSC
Figure 4.82 Example for an error protection proﬁle for the audio data rate 192 kbit/s.
Table 4.5
Example for multiplex conﬁguration
Programme
Content
Bit rate
Capacity
Protection
Audio 1
Pop music
160 kbit/s
116 CU
PL3
Audio 2
Classical music
192 kbit/s
140 CU
PL3
Audio 3
Classical music
224 kbit/s
168 CU
PL3
Audio 4
Trafﬁc info
80 kbit/s
58 CU
PL3
Data 1
Visual service
72 kbit/s
54 CU
PL3
Audio 5
Information
192 kbit/s
116 CU
PL4
Audio 6
Information
128 kbit/s
96 CU
PL3
Audio 7
Pop music
160 kbit/s
116 CU
PL3
Sum
864 CU
convolutional interleaver as explained in Subsection 4.4.2. With the notation introduced in
that subsection, B = 16 has been chosen and N is the number of coded bits of one logical
frame. First, the code word (i.e. the bits of one logical frame) will be split up into small
groups of 16 bits. The bits with number 0 to 15 of each group will be permuted according
to the bit reverse law (i.e. 0 →0, 1 →8, 2 →4, 3 →12, . . . , 14 →7, 15 →15). Then,
in each 16 bit group, bit number 0 will be transmitted without delay, bit number 1 will be
transmitted with a delay of N serial bit periods TS, that is, by the duration of one logical
frame of TL = NTS =24 ms. Bit number 2 will be transmitted with a delay of 2TL = 2 · 24
ms, and so on, until bit number 15 will be transmitted with a delay of 15TL = 15 · 24 ms.
At the receiver side, the deinterleaver works as follows. In each group, bit number 0 will
be delayed by 15TL = 15 · 24 ms, bit number 1 will be delayed by 14TL = 14 · 24 ms,
. . . , bit number 14 will be delayed by TL = 24 ms and bit number 15 will not be delayed.
Afterwards, the bit reverse permutation will be inverted. The deinterleaver restores the bit
stream in the proper order, but the whole interleaving and deinterleaving procedure results

OFDM
249
in an overall decoding delay of 15TL = 15 · 24 ms = 360 ms. This is a price that has to
be paid for a better distribution of errors. A burst error on the physical channel will be
broken up by the deinterleaver, because a long burst of adjacent (unreliable) bits before the
deinterleaver will be broken up so that two bits of a burst have a distance of at least 16
after the deinterleaver and before the decoder.
The time interleaving is deﬁned individually for each subchannel. This has been done
because the receiver usually will decode only one subchannel and should therefore not
process any data that belong to other subchannels. At the transmitter, it is more convenient
to process all the subchannels together. The DAB system has been designed in such a way
that both are possible. It is an important fact that the size of the capacity unit of 64 bits is
an integer multiple of the period of B = 16 bits. As a consequence, each subchannel has a
logical frame size N that is an integer multiple of B = 16 bits. Thus, we may interchange
the order of time interleaving and multiplexing in Figure 4.82 and get the same bit stream
for the MSC.
The time interleaving will only be applied to the data of the MSC. The FIC has to be
decoded without delay and will therefore only be frequency interleaved.
Frequency interleaving and modulation
Because the fading amplitudes of adjacent OFDM subcarriers are highly correlated, the
modulated complex symbols will be frequency interleaved. This will be done with the
QPSK symbols before the differential modulation. We explain it by an example for TM II
with K = 384 subcarriers: A block of 2K = 768 encoded and time-interleaved bits have to
be mapped onto the 384 complex modulation symbols for one OFDM symbol of duration
TS. The ﬁrst 384 bits will be mapped to the real parts of the 384 QPSK symbols, the
last 384 bits will be mapped to the imaginary parts. To write it down formally, the bits
pi,l (i = 0, 1, . . . , 2K −1) of the block corresponding to the OFDM symbol with time
index l will be mapped onto the QPSK symbols qi,l (i = 0, 1, . . . , K −1) according to the
rule
qi,l =
1
√
2
	
1 −2pi,l

+ j

1 −2pi+K,l

, i = 0, 1, . . . , K −1.
The frequency interleaver is simply a renumbering of the QPSK symbols according to
a ﬁxed pseudorandom permutation. The QPSK symbols after renumbering are denoted by
xk,l (k = ±1, ±2, ±3, . . ., ±K/2). Then the frequency-interleaved QPSK symbols will be
differentially modulated according to the law
sk,l = sk,l−1 · xk,l.
The complex numbers sk,l are the Fourier coefﬁcients of the OFDM with time index l in
the frame.
Performance considerations
Sufﬁcient interleaving is indispensable for a coded system in a mobile radio channel. Error
bursts during deep fades will cause the Viterbi decoder to fail. As already discussed in
detail, OFDM is very well suited for coded transmission over fading channels because
it allows time and frequency interleaving. Both interleaving mechanisms work together.

250
OFDM
An efﬁcient interleaving requires some incoherency of the channel to achieve uncorrelated
or weakly correlated errors at the input of the Viterbi decoder. This is in contrast to the
requirement of the demodulation. A fast channel makes the time interleaving more efﬁcient,
but causes degradations because of fast phase ﬂuctuations. As discussed in the example at
the end of Subsection 4.4.1, the beneﬁt of time interleaving is very small for Doppler
frequencies below 40 Hz. On the other hand, this is already the upper limit for the DQPSK
demodulation for TM I. For even lower Doppler frequencies corresponding to moderate
or low car speeds and VHF transmission, the time interleaving does not help very much.
In this case, the performance can be saved by an efﬁcient frequency interleaving. Long
echoes ensure efﬁcient frequency interleaving. As a consequence, SFNs (single frequency
networks) support the frequency interleaving mechanism. If, on the other hand, the channel
is slowly and frequency-ﬂat fading, severe degradations may occur even for a seemingly
sufﬁcient reception power level.
To compare with the theoretical DQPSK bit error rates discussed in Subsection 4.4.1,
we performed several simulations of the DAB system. For the delay power spectrum DAB
HT2 that was deﬁned during the evaluation process is based on real channel measurements.
It is the superposition of three exponential delay power spectra delayed by τ1 = 0 µs, τ2 =
20 µs, τ3 = 40 µs with normalized powers P1 = 0.2, P2 = 0.6, P3 = 0.2 and respective
delay spreads τm1 = 1 µs, τm2 = 5 µs, τm3 = 2 µs. The overall delay spread is τm ≈14 µs.
Figure 4.83 shows BER simulations for the DAB transmission mode II system with a
256 kbit/s data stream with EEP compared with the DQPSK union bounds. The maximum
Doppler frequency for the isotropic spectrum is 64 Hz, which leads to νmaxTS = 0.02. Time
0
5
10
15
20
10
− 4
10
−3
10
−2
10
−1
10
0
←Rc = 8/10
64 Hz
←Rc = 8/12
64 Hz
←Rc = 8/16
64 Hz
←Rc= 8/32
64 Hz
SNR [dB]
BER
Figure 4.83
Simulated BER for the DAB system for νmaxTS = 0.02 and Rc = 8/10,
8/12, 8/16, 8/32 and a frequency-selective channel.

OFDM
251
0
5
10
15
20
10
−4
10
−3
10
−2
10
−1
10
0
←Rc = 8/10
10 Hz
←Rc = 8/12
10 Hz
←Rc = 8/16
10 Hz
←Rc = 8/32
10 Hz
SNR [dB]
BER
Figure 4.84
Simulated BER for the DAB system for νmaxTS = 0.003 and Rc =
8/10, 8/12, 8/16, 8/32 and a frequency-ﬂat channel.
interleaving alone cannot be sufﬁcient because closely related bits are only separated by
24 ms. To separate them, the Doppler frequency would have to exceed, signiﬁcantly, 40 Hz,
which would lead to unacceptable high values of νmaxTS. The simulated curves ﬁt quite well
with the theoretical curves, which indicates that both interleaving mechanisms together lead
to a sufﬁcient separation of the bits on the physical channel. The weakest protection proﬁle
shows some degradations. This can be understood by the fact that the DAB EEP proﬁles
have exactly those fractional code rates including the coded tail bits. The tail bits are coded
by Rc = 1/2. The corresponding 12 coded bits are saved by using the next weakest code
for the last 96 bits in the data stream, which leads to a poorer performance there. It can be
veriﬁed by computer simulations that this effect becomes smaller for higher data rates and
more severe for lower data rates.
Figure 4.84 shows BER simulations for the DAB transmission mode II system with a
256 kbit/s data stream with EEP compared with the DQPSK union bounds. The maximum
Doppler frequency for the isotropic spectrum is 10 Hz, which leads to νmaxTS = 0.003.
For a radio frequency of 230 MHz, this corresponds to a vehicle speed of 48 km/h. The
delay power spectrum is the GSM typical urban spectrum, which is of exponential type
with τm = 1 µs. Neither time interleaving nor frequency interleaving is sufﬁcient for this
channel. Signiﬁcant degradations compared to the other channel can be observed.
4.6.2
The DVB-T system
The European Digital Video Broadcasting (DVB) system splits up into three different
transmission systems14 corresponding to three different physical channels: a cable system
14Further extensions are currently being deﬁned. We do not discuss them here.

252
OFDM
(DVB-C), a satellite system (DVB-S) and a terrestrial system (DVB-T). Because the re-
quirements of the three channels are very different, different coding and modulation schemes
have been implemented. Common to all three systems is an (outer) Reed–Solomon (RS)
code to achieve the extremely low bit error rates that are required for the video data stream
and that cannot be reached efﬁciently by convolutional coding alone. For the DVB-C stan-
dard, an AWGN channel with very high SNR can be assumed so that the Reed–Solomon
code alone is sufﬁcient. Both DVB-S and DVB-T need an inner convolutional code. This
is necessary for the ﬁrst one because of the severe power limitation of the satellite channel.
For the second one, the terrestrial channel is typically a fading channel for which convolu-
tional codes are usually the best choice because they can take beneﬁt from the channel state
information. All three systems use QAM modulation. For DVB-S, only 4-QAM (= QPSK)
is used for reasons of power efﬁciency. Both other systems have higher-level QAM as
possible options. DVB-C and DVB-S use conventional single carrier modulation. DVB-T
uses OFDM to cope with long echoes and to allow SFN coverage. We concentrate on the
discussion of the terrestrial system.
The physical channel is similar to that of the DAB system. We may have runtime
differences of the signal of several ten microseconds, which are due to echoes caused
by the topographical situation. For both systems, SFNs are a requirement at least as one
possible option. One signiﬁcant difference in the requirements is that the DAB system has
been especially designed for mobile reception. For the DVB-T system, portable – but not
mobile – reception was required when the system parameters were chosen.
DVB-T is intended to replace existing analog television signals in the same channels.
Depending on the country and the frequency band (VHF or UHF band), there exist TV chan-
nels of 6 MHz, 7 MHz and 8 MHz nominal bandwidth. The DVB-T system can match the
signal bandwidth to these three cases. Similar to the DAB system, transmission modes have
been speciﬁed to deal with different scenarios. For each of the three different bandwidth
options, there exist two such parameter sets. They are called 8k mode and 2k mode, corre-
sponding to the smallest possible (power of two) FFT length 8192 and 2048, respectively.
The OFDM symbol length of the 8k mode is similar to that of the DAB transmission mode I
and thus intended for SFN coverage. Because of the long symbol duration, it is more sensi-
tive against high Doppler frequencies. The OFDM symbol length of the 2k mode is similar
to that of the DAB transmission mode II. It is suited for typical terrestrial broadcasting sit-
uations, but not for SFNs. It may thus preferably be used for local coverage. Let us denote
again the OFDM Fourier analysis window by T , the total symbol length by TS and the guard
interval by . In contrast to the DAB system, there exist several options for the length
of the guard interval:  = T /4,  = T /8,  = T /16 and  = T /32. Table 4.6 shows the
OFDM symbol parameters for the 8k mode and Table 4.7 for the 2k mode, both with the
Table 4.6
OFDM Parameters for the DVB-T 8k mode and  = T /4
Channel
ts
T
TS

Max. frequency
8192 ts
10, 240 ts
2024 ts
8 MHz
7/64 µs
896 µs
1120 µs
224 µs
≈800 MHz
7 MHz
1/8 µs
1024 µs
1280 µs
256 µs
≈700 MHz
6 MHz
7/48 µs
≈1195 µs
≈1493 µs
≈299 µs
≈600 MHz

OFDM
253
Table 4.7
OFDM Parameters for the DVB-T 2k mode and  = T /4
Channel
ts
T
TS

Max. frequency
2048 ts
2560 ts
512 ts
8 MHz
7/64 µs
224 µs
280 µs
56 µs
≈3200 MHz
7 MHz
1/8 µs
256 µs
320 µs
64 µs
≈2800 MHz
6 MHz
7/48 µs
≈299 µs
≈373 µs
≈75 µs
≈2400 MHz
guard interval length  = T /4. All time periods are deﬁned as a multiple of the sampling
period ts = f −1
s
that is different for the three different TV channel bandwidths. For each
mode, the three bandwidths can be obtained by a simple scaling of that sampling frequency.
The number of carriers is given by K + 1 = 6817 for the 8k mode and by K + 1 = 1705
for the 2k mode. The spacing fK/2 −f−K/2 between the highest and the lowest subcarrier
is approximately given by 7607 kHz for the 8 MHz channel, 6656 kHz for the 7 MHz
channel and by 5705 kHz for the 6 MHz channel.
The frequency in the last column is the optimistic upper limit for the maximum
frequency that can be used for a vehicle speed of 120 km/h if a very powerful channel es-
timation with Wiener ﬁltering has been implemented and if an appropriately strong channel
coding and modulation scheme has been chosen. The pilot grid for DVB-T is the diagonal
one of Figure 4.36. The parameters of the 7 MHz system correspond approximately to the
numerical example given in Subsection 4.3.2. For the 8k mode, according to that example,
the channel will be sampled with a sampling frequency of approximately 200 Hz. Owing
to the sampling theorem, the limit for the Doppler frequency is then given by 100 Hz. This
corresponds to 900 MHz radio frequency for a vehicle speed of 120 km/h. In practice, one
should be well below the limit given by the sampling theorem. For a good channel estima-
tion, 700 MHz should be possible. This value corresponds to approximately 78 Hz Doppler
frequency or νmaxTS = 0.1. As we have seen in Subsection 4.5.3, this value can be tolerated,
for example, for 16-QAM and code rate Rc = 1/2, but not for higher spectral efﬁciencies.
For 64-QAM and code rate Rc = 1/2, the maximum frequency should be 25% lower.
Because the DAB transmission modes I and II have similar symbol length as the 8k
and 2k modes of DVB-T, a direct comparison of the sensitivity against high Doppler
frequencies are possible. We conclude that the DVB-T system allows approximately twice
the carrier frequency (or vehicle speed) compared to the DAB system. From the discussion
in Subsection 4.5.3, we further conclude that at the highest possible value for the DAB
system, the DVB-T system with 16-QAM has a similar performance as the DAB system
at approximately twice the spectral efﬁciency. In both cases, Rc = 1/2 has been assumed.
Baseline transmission system
The baseline DVB-T transmission system is depicted in Figure 4.85. Packets of 188 bytes
length will ﬁrst be encoded to code words of length 204 by the outer RS(204, 188, 17)
code. This code has Hamming distance 17 and can thus correct up to eight byte errors. This
shortened RS code has been obtained from a RS(255, 239, 17) code by setting the ﬁrst 51
systematic bytes to zero and not transmitting them. The code words are interleaved by a
convolutional byte interleaver as described in Subsection 4.4.2 with parameters B = 12 and
M = 17. Thus, N = BM = 204 is just the block length of one code word. The interleaver

254
OFDM
RS
encoder
Convol.
encoder
Bit
interl.
Byte
interl.
mapper
QAM
Symbol
interl.
OFDM
Figure 4.85 Simpliﬁed block diagram for the DVB-T signal generation.
works in such a way that the byte number zero (i.e. the ﬁrst one) in a block stays at the
same position and in the same block. The byte number one is delayed by the block length
N, that is, it will be transmitted in the next block at the same position within the block. The
byte number two is delayed by 2N, that is, two blocks, and so forth until byte number 12,
which stays inside the block at the same position and the whole procedure, will continue
that way. This outer byte interleaver is necessary because at the receiver the inner decoder
produces error bursts. These error bursts must be distributed over several code words
because more than 8 bytes in one code word cannot be corrected. Following the discussion
in Subsection 4.4.2 we observe that an error burst of 12 bytes (= 96 bits) length after the
inner decoder will result in only one corresponding byte error inside one code word. The RS
code can correct up to eight byte errors, that is, the error bursts may be eight times longer.
The bit stream of the byte interleaved code words will be encoded by an inner encoder
for the standard (133, 171)oct convolutional code and then modulated as discussed in
Subsections 4.5.1 and 4.5.2. With optional puncturing, the code rates Rc = 1/2, Rc = 2/3,
Rc = 3/4, Rc = 5/6 and Rc = 7/8 are possible. The output bit stream of the convolutional
encoder will be interleaved by a (small) pseudorandom permutation and mapped on complex
QAM symbols by a symbol mapper. Thus, exactly the concept of bit-interleaved coded
modulation has been implemented in the DVB-T system. The options 4-QAM, 16-QAM
and 64-QAM are possible. The QAM symbols are OFDM modulated. Each OFDM symbol
carries 6048 QAM symbols in the 8k mode and 1512 QAM symbols in the 2k mode,
respectively. The other complex symbols serve as pilot symbols for channel estimation. In
addition to the diagonal grid of scattered pilot of Figure 4.36, there are continuous pilots that
serve as references for frequency synchronization. All pilots are boosted by a factor of 4/3
in the amplitude compared to the QAM symbols. Table 4.8 shows the possible coding and
modulation options and the corresponding data rates for  = T /4 and the 8 MHz system.
To exploit the channel diversity in frequency direction, for each OFDM symbol, the
QAM symbols are frequency interleaved by a pseudorandom permutation of length 6048
or 1512, respectively. In contrast to the DAB system, no time interleaving is applied. This
is due to the fact that originally no mobile reception was intended.
A set of 68 OFDM symbols are grouped together to a transmission frame, and four
such frames build a hyperframe. There are some signiﬁcant differences to the DAB system.
First, there is no correspondence between certain parts of the data stream and certain OFDM
symbols in the frame. DAB allows different code rates for different parts of the signal. This
is not possible for DVB-T. The information that is necessary to identify the overall code
rate and the guard interval length are transmitted on special TPS (transmission parameter
signaling) carriers.
Channel coding aspects
The DVB-T channel coding scheme consists of an inner convolutional code and an outer
Reed–Solomon code. The outer symbol interleaver is a frequency interleaver that has the

OFDM
255
Table 4.8
Transmission options and data rates for DVB-T for guard in-
terval length  = T /4
Modulation
Code rate
Bits per symbol
Rb
Useful Rb
QPSK
Rc = 1/2
1
5.4 Mbit/s
4.98 Mbit/s
QPSK
Rc = 2/3
1.33
7.2 Mbit/s
6.64 Mbit/s
QPSK
Rc = 3/4
1.5
8.1 Mbit/s
7.46 Mbit/s
QPSK
Rc = 5/6
1.67
9.0 Mbit/s
8.29 Mbit/s
QPSK
Rc = 7/8
1.75
9.45 Mbit/s
8.71 Mbit/s
16-QAM
Rc = 1/2
2
10.8 Mbit/s
9.95 Mbit/s
16-QAM
Rc = 2/3
2.67
14.4 Mbit/s
13.27 Mbit/s
16-QAM
Rc = 3/4
3
16.2 Mbit/s
14.93 Mbit/s
16-QAM
Rc = 5/6
3.33
18.0 Mbit/s
16.59 Mbit/s
16-QAM
Rc = 7/8
3.5
18.9 Mbit/s
17.42 Mbit/s
64-QAM
Rc = 1/2
3
16.2 Mbit/s
14.93 Mbit/s
64-QAM
Rc = 2/3
4
21.6 Mbit/s
19.91 Mbit/s
64-QAM
Rc = 3/4
4.5
24.3 Mbit/s
22.39 Mbit/s
64-QAM
Rc = 5/6
5
27.0 Mbit/s
24.88 Mbit/s
64-QAM
Rc = 7/8
5.25
28.4 Mbit/s
26.13 Mbit/s
purpose to break up the correlations of the channel and provide the inner code with the
diversity that can be obtained from the frequency selectivity of the channel. No similar
mechanism is intended to take advantage from time variance of the channel. The bit inter-
leaved coded modulation needs a (small) bit interleaver between the convolutional encoder
and the symbol mapper. This is necessary in order to avoid closely related bits of the code
word being affected by the same noise sample. Of course, it would have been possible
to use a bigger bit interleaver for both purposes together. The outer byte interleaver has
the purpose to break up long error bursts resulting from erroneous convolutional decoding.
The combination of a convolutional inner code together with an outer RS code with an
interleaver in between is a very powerful combination. The RS code is very efﬁcient for
burst error decoding as long as the bursts are not too long. It takes advantage from the
fact that more than one bit error is inside one erroneous byte. Let P be the byte error
probability and Pb the bit error probability after the Viterbi decoder. We note that the worst
case of only one average bit error in one erroneous byte corresponds to P = 8Pb, two bit
errors correspond to P = 4Pb and four bit errors correspond to P = 2Pb. The assumption
of ideal interleaving means that the byte errors are uniformly distributed. The block error
probability analysis of Subsection 3.1.2 can be generalized to the case that we deal with
bits rather than with bytes. The probability for the block code word error probability is
then given by
PBlock =
N

i=t+1
N
i

P i(1 −P )N−i.
In these equations, N = 204 is the length of the code word, and t = 8 is the error correction
capability. To obtain the residual bit error probability, we can argue as we did in Subsec-
tion 3.1.2. We take into account that, for a given bit inside a byte, 128 of 255 possible byte

256
OFDM
10
−4
10
−3
10
−2
10
−1
10
−12
10
−10
10
−8
10
−6
10
−4
10
−2
10
0
PBlock
Pb
Residual error rate
Pres
Figure 4.86 Block error rate and residual bit error rate for the RS code.
errors would lead to a bit error. The residual bit error rate is then upper bounded by
Pres ≤128
255
N

i=t+1
min (t + i, N)
N
N
i

P i(1 −P )N−i,
For the worst case P = 8Pb, these curves are plotted in Figure 4.86. If ideal interleaving can
be assumed for all interleaving mechanisms, the curve for PBlock in conjunction with the bit
error curves for the convolutionally coded QAM can be used to conclude from the channel
SNR to the error event frequency for the video signal. We discuss the line of thought on the
basis of Figure 4.87. First, the QAM symbols are deinterleaved in frequency direction by the
symbol interleaver. From the QAM symbols, the MCU calculated the metric expressions
(i.e. soft bits) as described in Subsection 4.2.1. These soft bit values are deinterleaved
before they are passed to the Viterbi decoder. The Viterbi decoder produces burst errors,
that is, there are more or less long sequences inside the bit stream of unreliable bits. For
the following RS decoder, it is favorable that the bit errors are grouped close together in
the same bytes, but long sequences of byte errors must be avoided. The purpose of the byte
interleaver is to break up such long sequences.
To give a concrete numerical example, we start with Pb = 2 · 10−4 for the required
BER after the Viterbi decoder. This is a requirement that can be found in many papers
because it is stated by the DVB-T developers that this would guarantee a virtual error-
free channel after the RS decoder. From the theoretical analysis of convolutionally coded
QAM, we know what SNR is needed to achieve this BER. As an example, for 64-QAM
and Rc = 1/2 in an ideally interleaved Rayleigh fading channel, we infer from Figure 4.63

OFDM
257





Symbol
QAM
MCU
Soft bit
Viterbi
decoder
Byte
RS
decoder
SNR = 18 dB
deinterl.
deinterl.
deinterl.
PBlock = 10−10
Pb = 2 · 10−4
Figure 4.87 The DVB-Decoder.
an SNR between 16 dB and 17 dB. If we take into account some loss that is due to channel
estimation, we may regard 18 dB as a reasonable ﬁgure. From Figure 4.86, we infer a block
error rate PBlock = 10−10 after RS decoding. To interpret this, we assume as an example
a low video data rate of approximately 3 Mbit/s. Recall that one block has 188 useful
bytes corresponding to 1504 useful bits. This means that approximately 2000 blocks are
transmitted per second. For PBlock = 10−10, the average time between two error events is
5 · 106 seconds, which corresponds to 58 days. For a high video data rate of 30 Mbit/s,
this reduces to six days, which can still be regarded as virtually error-free reception. We
note that not every error event will lead to perceptible errors in the picture. Furthermore, a
powerful RS decoder is able to detect a large amount of uncorrectable code words and will
send a ﬂag to an error concealment mechanism. Thus, the time between perceptible picture
errors may be much larger.
For the DVB-T system, the concept of a virtually error-free channel has been introduced
as a reception with the residual bit error rate of Pres = 10−11. For uniformly distributed bit
errors, this corresponds to approximately one bit error per hour for 30 Mbit/s. However,
this ﬁgure is misleading because the RS decoder does not produce uniformly distributed
bit errors, but block errors with many bit errors inside. The most probable error event
corresponds to code words at the Hamming distance, that is, typically there are 17 wrong
bytes or 68 wrong bits in average. This means that a burst of typically 68 bit errors
occur every 68 hours (≈3 days) and not one single bit error per hour15. However, because
the BER curves for the concatenated coding system are very steep, a weakening of these
requirements for the virtual error-free channel would only result in a small SNR gain. Much
more important is the fact that the curves are based on the assumption of ideal interleaving.
Mobile reception
Even though mobile reception was originally not required, this item has become more
and more important for the practical application. Is the DVB-T system suited for mobile
reception? Taking into account the results of the preceding sections, we can make the
following statements:
1. The modulation scheme of DVB-T with coherent modulation together with the chan-
nel estimation concept is very well suited for fading channels if the interleaving can
15The factor of 2 between these three days and the six days of the preceding analysis has its origin that the
DVB-T ﬁgures are bases on the error rates for the unshortened RS(255, 239, 17) code, for which Pb = 2 · 10−4
leads to Pres = 10−11. In Figure 4.86, we ﬁnd Pres ≈5 · 10−12 for the same Pb.

258
OFDM
be assumed to be sufﬁcient. The coherent QAM is by far superior in robustness and
spectral efﬁciency compared to the differential demodulation as applied by DAB.
However, only a very restricted number of the combinations of Table 4.8 are suited
for mobile reception. Only the lowest possible code rates can be recommended. For
low data rates, Rc = 1/3 also should have been included.
2. Since the number of subcarriers is very large, the DVB-T system can be considered
as a wideband system if the channel is not too ﬂat. Unfortunately, time interleaving
has not been included. For frequency-ﬂat channels with insufﬁcient interleaving, burst
errors will corrupt the whole concatenated coding scheme. However, receive antenna
diversity may help in such situations.
3. In a mobile radio channel, the concept of a virtually error-free channel does not
make sense because the conditions may change severely during a short period of
time that is much less than one hour. In mobile reception practice, there will always
be situations where the system approaches its limits. The system design must take
this into account. In contrast to the DAB system, nothing has been done for this case.
There is no unequal error protection or graceful degradation or error detection in the
scale factors. This may result in annoying perturbations of the audio quality.
4.6.3
WLAN systems
OFDM with a guard interval is applied within two systems for wireless communications
between computers in a local area network. The corresponding standards for these Wireless
Local Area Networks (WLAN) are called:
• the HIPERLAN/2 standard released by the European Telecommunications Standards
Institute (ETSI) in 2000;
• the IEEE 802.11a and IEEE 802.11g standard released by the Institute of Electrical
and Electronics Engineers (IEEE) in 1999 and in 2003, respectively.
While HIPERLAN/2 and IEEE 802.11a operate in the 5 GHz band, IEEE 802.11g uses a
frequency band at about 2.4 GHz, which is also occupied by other systems like Bluetooth
and another variant of the IEEE 802.11 standard, namely, the IEEE 802.11b variant using
the spread spectrum and code keying techniques as the basic transmission scheme (see
Subsection 5.5.1). The OFDM parameters as well as the main modulation and channel
coding parameters of IEEE 802.11a and IEEE 802.11g are absolutely identical. There are
only some differences with respect to the header and the preamble of the physical data
bursts since the coexistence of IEEE 802.11b and 802.11g mode within one frequency
band requires special means. In the following text, we focus on the IEEE 802.11a variant,
nevertheless the considerations may be transferred directly to the IEEE 802.11g variant.
Also, the parameters of the physical layer of IEEE 802.11a and HIPERLAN/2 have been
harmonized to a high degree by the corresponding standardization groups. However, there
are some fundamental differences concerning the format of a physical burst and especially
concerning the multiple access technique. While HIPERLAN/2 uses a time division multiple
access (TDMA) scheme with a ﬁxed TDMA frame length of 2 ms and a centralized resource
allocation, the multiple access within all IEEE 802.11 modes is based on carrier sense

OFDM
259
Table 4.9
The OFDM Parameters
for HIPERLAN/2 and IEEE 802.11a
K
T
TS

52
3.2 µs
4 µs
0.8 µs
multiple access (CSMA). CSMA is a decentralized multiple access scheme known from
wired LANs (IEEE 802.3: Ethernet) which does not use a ﬁxed time slot structure, but data
packets of a variable length.
Modulation and coding parameters
Let us again denote the OFDM Fourier analysis window length by T , the total symbol
length by TS, the guard interval length by  and the number of carriers by K. Table 4.9
shows the values of these parameters. The K = 52 subcarrier frequency positions are given
by fk = k/T with k ∈{±1, ±2, . . ., ±K/2}, that is, similar to the DAB system, the center
subcarrier position is left empty. The four subcarriers with index k ∈{±7, ±21} are used
as continuous pilots for frequency synchronization. The spacing between the highest and
the lowest subcarrier is given by fK/2 −f−K/2 =16.25 MHz. The guard interval length
 = 0.8 µs is able to absorb path length differences up to 240 m. For an environment with
shorter echoes,  = 0.4 µs is a possible option. In that case, all possible data rates can be
increased by 11%.
For both systems, BPSK, QPSK, 16-QAM and 64-QAM are possible modulation
schemes. For channel coding, the same (133, 171)oct convolutional code is used as in
the systems described above. To achieve higher code rates, puncturing will be applied.
For HIPERLAN/2, the possible code rates are Rc = 1/2, Rc = 9/16, and Rc = 3/4. For
IEEE 802.11a, the possible code rates are Rc = 1/2, Rc = 2/3, and Rc = 3/4. Table 4.10
shows the possible coding and modulation options for both systems. Note that the only
difference between both systems is that 24 Mbit/s and 48 Mbit/s are only used in the IEEE
802.11a system, while 27 Mbit/s is used only in the HIPERLAN/2 system.
Performance considerations
Since the systems have not been designed for mobile reception, only frequency interleaving
has been applied, together with a small bit interleaver. The system can be considered as a
BICM system as discussed in Subsection 4.5.2. However, in contrast to the DVB-T system,
we do not have a real wideband system relative to the coherence bandwidth of the channel.
As a consequence, the performance curves derived there cannot be applied directly because
frequency interleaving alone cannot allow for sufﬁcient decorrelation for such a low number
of subcarriers. However, the results of ideal interleaving may serve as a hint for the system
evaluation and may allow a comparison of the combinations of code rate and modulation
scheme.
First we note that – as discussed in detail before – BPSK always has (for the AWGN
and a multiplicative fading channel) the same power efﬁciency as QPSK. This means that,
for both schemes, we need the same energy Eb per bit which is just the power per bit rate.
BPSK transmission allows only half the bit rate compared to QPSK, and thus the power can

260
OFDM
Table 4.10
Transmission options for HIPERLAN/2 and IEEE 802.11a
Rb
Modulation
Code rate
Bits per symbol
6 Mbit/s
BPSK
Rc = 1/2
0.5
9 Mbit/s
BPSK
Rc = 3/4
0.75
12 Mbit/s
QPSK
Rc = 1/2
1
18 Mbit/s
QPSK
Rc = 3/4
1.5
24 Mbit/s
16-QAM
Rc = 1/2
2
IEEE only
27 Mbit/s
16-QAM
Rc = 9/16
2.25
HIPERLAN only
36 Mbit/s
16-QAM
Rc = 3/4
3
48 Mbit/s
64-QAM
Rc = 2/3
4
IEEE only
54 Mbit/s
64-QAM
Rc = 3/4
4.5
be reduced by a factor of 2 corresponding to a 3 dB lower SNR. Looking at Figure 4.65, we
observe that this corresponds to an SNR reduction from 6 dB to 3 dB at a bit error rate of
10−4 for Rc = 1/2 and the ideally interleaved Rayleigh channel. From that ﬁgure, we also
conclude that the increase of the code rate from Rc = 1/2 to Rc = 3/4 will require at least
5 dB more SNR. Thus, the 12 Mbit/s (QPSK, Rc = 1/2) mode will require less SNR than
the 9 Mbit/s mode (BPSK, Rc = 3/4). Thus, in a Rayleigh fading channel, the 9 Mbit/s
mode is obsolete. We further conclude from that ﬁgure and the corresponding discussion in
Subsection 4.5.2 that at approximately 1.5 bits per symbol, 16-QAM with a low code rate
would be a much better choice than 4-QAM (QPSK). Thus, in a Rayleigh fading channel,
16-QAM would be a better candidate for the 18 Mbit/s mode. For 36 Mbit/s, 64-QAM
with Rc = 1/2 performs better than the parameter combination (16-QAM, Rc = 3/4) that
has been chosen for the wireless LAN systems. We note that these statements apply for a
Rayleigh fading channel. But this is of course the worst case.
We note that the BER is not really the adequate measure for the performance of a data
communication system. Since errors can be tolerated in such a system (in contrast to an
audio broadcasting system), an error detection scheme is necessary. In the systems under
consideration, a CRC (cyclic redundancy check) has been implemented. If an error occurs
in a packet of 432 bits, the packet will be retransmitted. Therefore, the packet error rate
(PER) rate is more adequate than the BER. Since the available data rate will be lowered
by the PER, the resulting effective data rate as a function of the SNR is the adequate
performance measure for which the modulation and coding schemes have to be compared.
For each burst of Nsym OFDM symbols, the shift register of the convolutional code will
be reset to the zero state by adding tail bits (see Subsection 3.2.1). To retain the exact ratio
of the code rate, a technique similar to that in the DAB system has been introduced (see
Subsection 4.6.1).
Physical burst (frame) structure
As mentioned above, HIPERLAN/2 and IEEE 802.11a use different burst formats and mul-
tiple access schemes. Hence, with respect to these topics the systems have to be discussed
separately. We start with HIPERLAN/2.
HIPERLAN/2 is a TDMA system. Uplink and downlink share different time slots at the
same frequency. A physical TDMA burst has the length of exactly 2 ms, which corresponds

OFDM
261
to the duration of 500 OFDM symbols. A physical burst starts with a preamble that is used
for synchronization. After that, a variable number Nsym of OFDM symbol form the so-called
payload. There are ﬁve different bursts with different preamble length:
1. The Broadcast burst: Preamble of length 16 µs. The payload consists of Nsym = 496
OFDM symbols.
2. The Downlink burst: Preamble of length 8 µs. The payload consists of Nsym = 498
OFDM symbols.
3. Uplink burst with short preamble: Preamble of length 12 µs. The payload consists of
Nsym = 497 OFDM symbols.
4. Uplink burst with long preamble: Preamble of length 16 µs. The payload consists of
Nsym = 496 OFDM symbols.
5. Direct link burst: Preamble of length 16 µs. The payload consists of Nsym = 496
OFDM symbols.
The last 8 µs of the preamble is common to all bursts and serves as a reference for
the channel estimation that is necessary for the coherent demodulation. It consists of
an OFDM reference symbol of length 2TS = 8 µs, which is BPSK modulated with a
known pseudorandom sequence of length 52 that is modulated on the subcarriers with
index k ∈{±1, ±2, . . . , ±K/2}. The resulting OFDM symbol (without guard interval) of
length T is cyclically extended to the length 2TS by a guard interval of length T + 2.
Equivalently, one can say that the OFDM symbol of length T will be repeated and the
resulting symbol of length 2T is cyclically extended (into the past) by a guard interval
of length 2 to absorb the echoes. In the ﬁrst part of the preamble, only 12 carriers are
modulated, leading to shorter OFDM symbols. This part is used for coarse synchronization
and as a reference for the automatic gain control (AGC).
A physical frame of the IEEE 802.11a system has a variable length and may carry some
thousands of bytes. The header provides information on the length of the frame and on the
modulation and channel coding scheme applied to the payload part. The header consisting
of 24 bits is transmitted using the 6 Mbit/s mode, that is, it is transmitted as one OFDM
symbol. The preamble in front of the physical frame has a length of 16 µs, where two
different types of training sequences are transmitted as within the HIPERLAN/2 system.
Error detection at the physical layer is only applied for the header using one parity bit;
error detection of the payload is performed by higher layers using a CRC of 4 bytes.
4.7
Bibliographical Notes
The idea of multicarrier transmission goes back to the 1960s (Chang 1966; Chang and Gibby
1968; Saltzberg 1967). The original idea was indeed a physical realization of the concept of
Figure 4.2 by using a large number of oscillators. The idea to simplify the implementation
by using Fourier transform techniques goes back to (Weinstein and Ebert 1971) and was
further developed by Hirosaki (1981). For a long time, however, the implementation of
multicarrier transmission by digital circuits for high-speed data communication was still

262
OFDM
out of question. Thus, these fundamental ideas were widely unknown not only for practical
engineers but even for the scientiﬁc community. It was pointed out by Cimini (1985) that
OFDM with guard interval is especially suited for the mobile radio channel. This paper
seems to be an inspiration for people at the French telecommunication and broadcasting
research institute, CCETT, to propose OFDM as a digital broadcasting transmission system
for mobile receivers (Alard and Lassalle 1987). It was the merit of these engineers to
recognize that the time of OFDM had come and its realization by digital circuits had become
a distinct possibility. In the European Digital Audio Broadcasting project, this system
proposal became a very serious candidate and, at the end of the project, an OFDM system
was standardized in 1993 (see (EN300401 2001a) for a recent update of the standard). An
exhaustive treatment of the DAB system that is also very helpful for the practical engineer
can be found in (Hoeg and Lauterbach 2003). A comprehensive overview about multicarrier
modulation and its history can be found in (Bingham 1990) and in (Gitlin et al. 1993).
The DAB system can be regarded as the OFDM pioneer system. One of the authors
(Henrik Schulze) became involved in the DAB project in 1987 (at Bosch Company in
Hildesheim) and came in touch with OFDM through an internal project paper that was a
draft version of (Alard and Lassalle 1987). At that time, very few people understood that
concept and thus OFDM was regarded as a wonder cure against everything by its supporters,
and it was regarded as pure fantasy by its antagonists. Even though it is mathematically
evident that OFDM should work in principle, it soon became obvious that indeed some
practical implementation problems are more severe than for traditional systems. These
topics are discussed in Sections 4.2 and 4.3. That treatment was partly inspired by the
Ph.D. thesis of (Schmidt 2001), which provides an interesting overview of several OFDM
aspects. Another problem for the DAB system design was the proper choice of the guard
interval because, as pointed out by Schulze (1988), echoes longer than the guard interval
lead to severe degradations. Extensive measurements of the mobile radio broadcasting
channel were done by the German PTT in cooperation with the Bosch Company and lead
to the choice of the OFDM parameters for the four DAB transmission modes.
Differential QPSK modulation together with convolutional coding was chosen for DAB.
At that time, no appropriate channel estimation technique for OFDM was available, and
DQPSK was the favorite choice because it was widely believed to be the most robust
modulation scheme in a mobile radio channel. About one year after the decisions were made
about the system parameters, it was shown by Hoeher (1991) that a coherent modulation
scheme with a suitable channel estimation using Wiener ﬁltering outperformes DQPSK.
For an introduction to Wiener ﬁltering, we refer to (Haykin 1996). These ideas became
part of the DVB-T system concept (EN300744 2001b). One should keep in mind that
the preparatory work for that system had already been done inside the DAB project. For
example, the proper choice of the OFDM symbol length could be taken over from DAB.
The 8k Mode of DVB-T corresponds to DAB Transmission Mode I, and the 2k Mode of
DVB-T corresponds to DAB Transmission Mode II. The outer channel coding is also very
similar.
DVB-T was originally not intended for mobile reception. There is no unequal error
protection adjusted to the audio data stream, and there is no time interleaving. The channel
estimation is very robust, and DVB-T can cope with higher Doppler bandwidths than DAB.
Higher car velocities become a problem because DVB-T will typically be located at higher
frequencies than DAB.

OFDM
263
In 1997, two working groups were established separately by the IEEE and ETSI to
develop standards for Wireless LANs exceeding the data rate of former versions signiﬁ-
cantly. To achieve this goal, OFDM has been introduced as the basis for the transmission
techniques. Intensive discussion between these two groups led to widely harmonized pa-
rameters for OFDM, modulation and channel coding. The corresponding IEEE 802.11a
standard (IEEE 802.11a 1999) and HIPERLAN/2 standard (EN101475 2001) were released
in 1999 and 2000, respectively.
The channel coding schemes of all the OFDM systems discussed in Section 4.6 are very
closely related. They are essentially based on the same convolutional code of constraint
length 7. Section 4.5 is devoted to the channel coding and modulation for OFDM systems.
It partly follows the discussion presented in (Schulze 2003b,c). The concept of the diversity
degree of a multicarrier system presented in Section 4.4 follows the discussion in (Schulze
2001).
4.8
Problems
1. Let g(t) be a pulse that is time limited to the symbol duration TS = (1 + α)T with
the property
T |g(t)|2 =



1
:
2|t|/T ≤1 −α
1
2

1 −sin
π
α

|t|/T −1
2

:
1 −α ≤2|t|T ≤1 + α
0
:
2|t|/T ≥1 + α
.
In this equation, T is a time constant and the rolloff factor α has the property
0 ≤α ≤1. We deﬁne
gk(t) = exp

j2π k
T t

g(t).
Show that
⟨gk, gl⟩= δkl
holds.
2. Consider OFDM without guard interval and a smooth nonlinear ampliﬁer as dis-
cussed in Subsection 4.2.2. Assume that the self interference caused by the nonlin-
earity may be modeled by a Gaussian random variable. We require that the maximal
allowed performance degradation measured in Eb/N0 is 1 dB. How much SIR is
necessary (relative to Eb/N0) for BPSK, QPSK, 16-QAM and 64-QAM? How
much is necessary if a guard interval of length  = T /4 is introduced? How much
is necessary if a convolutional code of rate Rc = 1/2 is introduced?
3. Consider a complex signal
s(t) = a(t)ejϕ(t)

264
OFDM
with amplitude a(t) and phase ϕ(t). Show that the time derivative of the phase is
given by
˙ϕ(t) = ℑ
 ˙s(t)
s(t)
!
.
4. Let n = (n1, . . . , nL)T be L-dimensional complex AWGN with variance σ 2 = N0
in each dimension and u = (u1, . . . , uL)T be a vector of length |u| = 1 in the
L-dimensional complex space. Show that n = u†n is a complex Gaussian random
variable with mean zero and variance σ 2 = N0.
5. Let n = (n1, . . . , nL)T be L-dimensional complex AWGN with variance σ 2 = N0
in each dimension and U be a unitary L × L matrix. Show that n = U†n is also
L-dimensional complex AWGN with variance σ 2 = N0 in each dimension.

5
CDMA
5.1
General Principles of CDMA
Code division multiple access (CDMA) is a multiple access technique where different users
share the same physical medium, that is, the same frequency band, at the same time. The
main ingredient of CDMA is the spread spectrum technique, which uses high rate signature
pulses to enhance the signal bandwidth far beyond what is necessary for a given data rate.
The concept of spreading is explained in more detail in Subsection 5.1.1.
In a CDMA system, the different users can be identiﬁed and, hopefully, separated at the
receiver by means of their characteristic individual signature pulses (sometimes called the
signature waveforms), that is, by their individual codes. Subsection 5.1.3 brieﬂy discusses
the main types of codes and some of their essential properties.
Nowadays, the most prominent applications of CDMA are mobile communication
systems like cdmaOne (IS-95), UMTS or cdma2000, which are explained in detail in
Section 5.5. To apply CDMA in a mobile radio environment, speciﬁc additional methods
are required to be implemented in all these systems. Methods such as power control and
soft handover have to be applied to control the interference by other users and to be able
to separate the users by their respective codes. Basics of mobile radio networks are pre-
sented in Subsection 5.1.2, and methods of controlling the interference are discussed in
Subsection 5.1.4.
5.1.1
The concept of spreading
Spread spectrum means enhancing the signal bandwidth far beyond what is necessary for a
given data rate and thereby reducing the power spectral density (PSD) of the useful signal
so that it may even sink below the noise level. One can imagine that this is a desirable
property for military communications because it helps to hide the signal and it makes the
signal more robust against intended interference (jamming). Spreading is achieved – loosely
speaking – by a multiplication of the data symbols by a spreading sequence of pseudoran-
dom signs. These sequences are called pseudonoise (PN) sequences or code signals. We
Theory and Applications of OFDM and CDMA
Henrik Schulze and Christian L¨uders
2005 John Wiley & Sons, Ltd

266
CDMA





t
Tc
TS
gk(t)
Figure 5.1 Signature pulse with N = 8 rectangular chips.
illustrate the method by an example; more details on codes for spreading can be found in
Subsection 5.1.3.
Consider a rectangular transmit pulse
g(t) =
1
√TS

 t
TS
−1
2

of length TS. We divide the pulse into N subrectangles, referred to as chips, of length
Tc = TS/N and change the sign of the subrectangles according to the sign of the pseudoran-
dom spreading sequence. Figure 5.1 shows the resulting transmit pulse gk(t) of user number
k for N = 8. Here, the spreading sequence for user k is given by (+, −, +, +, −, +, −, −).
When it is convenient (e.g. for the performance analysis) the sign factors shall be appropri-
ately normalized. We note that in practice smooth pulse shapes (e.g. raised cosine pulses)
will be used rather than rectangular ones.
The increase of the signaling clock by a factor N from T −1
S
to T −1
c
leads to an increase
of bandwidth by a factor of TS/Tc (see Figure 5.2). For this reason, N = TS/Tc is called
the spreading factor or, more precisely, the spreading factor of the signature pulse. This
spreading is due to multiplication by the code sequence. While within the speciﬁcation
documents for CDMA mobile communication systems the spreading factor is often denoted
by SF, formulas are kept simpler by using the symbol N. Hence, we use both notations.
Later we may have different spreading mechanisms that work together, especially in
the context of channel coding. Therefore, we reserve the notion of the effective spreading
factor. As discussed in detail in Chapter 3, it is often not uniquely deﬁned where channel
coding ends and where modulation starts and thus it may be ambiguous to speak of a
bit rate after channel coding. We regard it as convenient to deﬁne the effective spreading
factor by
SF eff = Rchip
Rb
,
(5.1)
where Rb is the useful bit rate and Rchip = 1/Tc the chip rate. Obviously, this spreading
factor is approximately the inverse of the spectral efﬁciency for a single user.
The objective of spreading is – loosely speaking – a waste of bandwidth for the single
user to achieve more robustness against multiple access interference (MAI). It would thus be
a contradiction to this objective to use bandwidth-efﬁcient higher-level modulation schemes.
Any modulation scheme that is more efﬁcient than BPSK would reduce the spreading
factor. Therefore, BPSK and QPSK are used as the basic modulation schemes in most

CDMA
267
PSD
T −1
S
T −1
c
f
Figure 5.2 Power spectral density (PSD) for DS-CDMA.
practical communication systems. Nevertheless, higher-order modulation techniques like
8-PSK and 16-QAM also are applied as additional transmission options to offer a high-
speed packet transfer at good propagation conditions. Furthermore, we point out the special
role of channel coding. Channel coding usually means that a higher power efﬁciency has
to be paid by a lower spectral efﬁciency. Thus, channel coding can be interpreted as an
additional spreading mechanism. In the extreme case, all the spreading can be done by
channel coding, and the PN sequences serve only for user separation (see e.g. (Frenger
et al. 2000)). Keeping this in mind, we can interpret the conventional spreading by a PN-
sequence as a repetition code combined with the repeated transmit symbols multiplied by
a pseudorandom sign. The symbol will be repeated N times at a clock rate increased by
the factor N = TS/Tc and scrambled by a random sign. Equivalently, this is time delay
diversity. Because of the time dispersion of the channel, we may get a multipath diversity
gain. The appropriate diversity combiner is the RAKE receiver, which is sketched here and
will be discussed in more detail in Subsection 5.4.1.
The name RAKE receiver originates from the fact that there are some similarities to
a garden rake. As illustrated in Figure 5.3, the receiver consists of a certain number of
correlators (called RAKE ﬁngers) correlating the received signal to the used code signal.
One of the correlators (the so-called search ﬁnger) has the task to determine the propagation
delay values τi (i = 1, 2, . . .) of the most relevant propagation paths. These values are used
within the other correlators (ﬁngers) to adjust the exact timing for the respective multipath
components. By this method, the multipath components can be detected separately (if
the codes have a good autocorrelation property); subsequently, they can be combined by a
maximum ratio combiner. It should be noted that multipath components can only be resolved

268
CDMA
t1
t2
t3
t4
Propagation
delays ti
t1
t3
t4
t2
Data
symbols
Spread
signal
Modulated
chips
d
RF
Code c
c(t – t1)
Maximum ratio
combining
RF
COR ct1
COR ct2
COR ct3
LPF
Search
finger
τ1
t2
t3
Low
pass
filter
Correlator COR
Transmitter
Propagation channel
Receiver
Figure 5.3 Illustration of the RAKE receiver.
if their delay difference is higher than about a quarter of the chip duration Tc. Furthermore,
the number of RAKE ﬁngers is usually restricted to 4–6 (including the search ﬁnger).
The cdma2000 speciﬁcation requires, for example, that there are at least four processing
elements (including the search ﬁnger).
It must be emphasized that spreading by itself does not provide any performance gain
in the AWGN channel1. As shown in Figure 5.2, for a single user, spreading means nothing
but choosing a spectrally rather inefﬁcient waveform that smears the spectral power over
an SF times higher bandwidth. Thus, for the same signal power, the SNR decreases by a
factor of SF. The necessary power per bit rate, which equals the energy per bit, Eb, does not
depend on the pulse shape. We therefore avoid the popular but misleading word processing
gain for the factor SF. Originally, for a single user, it is nothing but a waste of bandwidth.
Example 8 (Processing Gain) We compare BPSK transmission employing a given pulse
shape with a spread spectrum transmission that uses this pulse as a chip pulse and the
spectrum will be spread by this factor of SF. Consider, for example, BPSK transmission with
a Nyquist base and roll-off factor 1, which occupies a bandwidth of 200 kHz to transmit a
bit rate of Rb = 100 kbit/s. For BPSK in an AWGN channel, we need Eb/N0 = 9.6 dB to
achieve a bit error rate of 10−5. For BPSK and the Nyquist base, we have SNR = Eb/N0 (see
Subsection 1.5.1). We now compare this system with a spread spectrum system of the same
data rate, a spreading factor of SF = 100, and the same roll-off factor for the chip pulse. As
we have seen in Chapter 1, the performance of a linear modulation scheme does not depend
on the pulse shape. Thus, we still need Eb/N0 = 9.6 dB to achieve a bit error rate of 10−5,
that is, the power that is needed to transmit a given bit rate of Rb = 100 kbit/s is the same.
However, the bandwidth has now been increased by a factor of SF and the signal occupies
1In a fading channel, a diversity gain can be achieved.

CDMA
269
20 MHz. Because the same signal power is spread over this higher bandwidth, the signal is
now completely below the noise and we have SNR = −10.4 dB. This ﬁctitious mystery that
a signal below the noise level can be completely recovered has its simple explanation in the
fact that we have just wasted bandwidth by using a spectrally inefﬁcient pulse shape, which
does not inﬂuence the power efﬁciency. Thus, the processing gain is just a virtual gain.
The reason for using spreading is not this virtual processing gain. A real gain of spread-
ing concerning the range of data transmission can be achieved in a frequency-selective
fading environment. The increased bandwidth of a spread signal provides us with an in-
creased frequency diversity as compared to a narrowband FDMA system (see the discussion
in Subsection 4.4.3). Such a frequency diversity can only be exploited if the signaling band-
width signiﬁcantly exceeds the correlation frequency (i.e. the coherency bandwidth) of the
channel. In that case, we speak of a wideband CDMA system (Milstein 2000)2. However,
as discussed in Chapter 4, such diversity can also be achieved by increasing the carrier
bandwidth by multiplexing different users to a frequency carrier using a time division mul-
tiplex scheme. Comparing the spread spectrum and the TDMA technique at the same signal
bandwidth, at the same data rate and mean transmission power (energy per transmitted bit),
roughly the same performance will result since the receive Eb/N0 is the same. Nevertheless,
having in mind the discussion on electromagnetic compatibility of mobile phones, spread-
ing may have an advantage since it uses a continuous transmission while transmission in
time multiplex systems is pulsed. For this reason, sometimes the peak transmission power
of systems is limited by regulatory bodies. Obviously, at equal peak transmit power the
performance of spread spectrum systems is higher than that of TDMA systems.
5.1.2
Cellular mobile radio networks
Network architecture
The frequency spectrum assigned to a mobile radio network usually is separated into several
frequency carriers which themselves may further be divided by a time or code multiplex
scheme into a set of radio channels. Since in mobile radio networks there are many millions
of subscribers but only some hundreds of radio channels, the coverage area is divided into
cells and the same frequency carriers are reused in many cells. This is the principle of
cellular radio networks.
As shown in Figure 5.4, radio coverage within a cell is accomplished by a base station
(BS). Each BS may serve many mobile stations (MS). The transmission direction from the
BS to the MS is called the downlink (DL) or forward link, the direction from the MS to
the BS is called the uplink (UL) or reverse link. A group of base stations is connected via
leased lines or microwave equipment to a network element, which is called base station
controller (BSC, e.g. in GSM) or radio network controller (RNC, e.g. in UMTS). The
connection between two subscribers is established by the mobile switching center (MSC).
2We note that the deﬁnition of wideband is the same as that introduced in Chapter 4 for OFDM. Furthermore,
it should not be confused with one transmission mode of UMTS, which is also often called Wideband CDMA.
Its transmission bandwidth of about 5 MHz may be viewed as wide in some urban environments, but not in any
indoor environment.

270
CDMA
UL
DL
BS
BS
BS
MS
MS
MS
MS
MS
MS
MS
BSC /
RNC
BSC /
RNC
MSC
Figure 5.4 Architecture of a cellular mobile radio network.
Handover
When an MS moves from one cell to another, a handover occurs. One distinguishes be-
tween hard and soft handover. For a hard handover, as it is performed, for example, in
GSM networks, the MS releases the old channel before connecting to the new BS via the
new channel; hence, there is a short interruption of the connection. For a soft handover,
which usually is performed in CDMA systems, an MS at the cell border may have sev-
eral connections to the corresponding base stations at the same time so that there is a
smooth transition between the cells without any interruption. To manage the soft handover
between cells belonging to different RNCs, additional interconnections between the RNCs
are required (in contrast to GSM).
In many cases, the handover decision is based upon the received signal level. A handover
where at every moment the MS is served by the BS from which the maximum signal level
is received is called an ideal power budget handover. Owing to fading effects, such an
ideal power budget criterion would cause very frequent forward and backward handovers
between different cells. For an architecture managing soft handover, there is no problem for
switching the connection between the different base stations immediately (on a millisecond
timescale); the signals to and from different base stations may even be combined. Because
of the short interruption phases and signaling effort, frequent hard handovers should be
avoided. This is usually achieved by introducing an averaging of the signal level and
a hysteresis margin, that is, a hard handover is only performed when the averaged signal
level of a neighboring cell exceeds one of the current serving cells by this hysteresis margin
of a few decibels.
Antennas and radio propagation
Concerning the cell layout one may distinguish between omni cells and sector cells. An
omni cell is served by one BS in the middle of the cell using an omni directional antenna,

CDMA
271
Antenna
diagrams
Omni cell
3 sector cells per site
BS
Figure 5.5 Sectorization of an omni cell into three sector cells using directional antennas
with a half power beam width of 65◦.
that is, an antenna with an isotropic characteristic in horizontal direction. Sectorization as
illustrated in Figure 5.5 is usually accomplished by dividing an omni cell into three cells
by directional antennas with a horizontal half power beam width of about 60◦–120◦.
The model for the radio propagation loss – which is usually written in a decibel nota-
tion – L = LD + LL + LS consists of three parts:
• the short-term fading LS caused by multipath propagation;
• the long-term fading LL caused by shadowing due to buildings or other obstacles;
• the deterministic path loss LD mainly depending on the distance r between MS
and BS.
Short-term fading was explained in detail in Chapter 2. Hence, this subsection focuses on
the discussion of the other parts of the propagation model.
Most of the well-accepted models for the deterministic propagation loss LD (e.g. free-
space propagation, Okumura–Hata model, Walﬁsh–Ikegami model, Xia–Bertoni model)
are described in decibel notation by an equation of the form (ETSI TR 101 112 1998;
Parsons 2000):
LD = A + B · log10 r [km].
(5.2)
The propagation parameters A and B mainly depend on the frequency f , the MS
and BS antenna installation heights and on the heights, distances and orientations of the
surrounding obstacles (buildings). For free-space propagation and, for example, f = 2 GHz,
one has A = 98.4 dB and B = 20; these parameter values can be derived from the free-
space formula of Problem 1.9 by converting it into a decibel notation and by using the
relation λ = c/f between wavelength and frequency as well as the correct units. For line-
of-sight conditions, propagation in pedestrian areas and street canyons may be modeled by
free-space propagation up to a certain distance (of some hundreds of meters) which is called
the break point distance. Afterwards, the propagation loss increases more strongly according
to a parameter of B = 40. In non-line-of-sight conditions, an additional diffraction loss at
street corners is taken into account. The considerations below focus on scenarios where the

272
CDMA
BS antennas are installed near or above the mean rooftop level of the buildings. For such
scenarios, typical values for A and B in urban environments are:
• A = 110 . . . 130 dB, B = 30 . . . 40 for f = 1 GHz,
• A = 120 . . . 140 dB, B = 30 . . . 40 for f = 2 GHz.
Obviously, these simple but nevertheless very useful deterministic models can only describe
the mean path loss as a function of the distance without reﬂecting all details of the buildings.
Because of shadowing by buildings the calculated loss will deviate from the mean value
measured in a speciﬁc area of some square meters. This deviation is usually modeled by a
Gaussian distributed random variable with a standard deviation σ that typically lies in the
region of σ = 4 . . . 10 dB. The correlation of the long-term fading values at positions with
a distance d decreases approximately exponentially with d and a decay constant of some
tens of meters (the typical scale of obstacles).
Figure 5.6 shows a typical diagram of the received level as a function of the distance r
taking into account all three parts of the propagation model. It can be seen that the received
level varies in a region of about 70 dB.
Quality of service, coverage and handover gain
The objective of network planning is to guarantee a certain quality of service. The quality of
service is usually quantiﬁed by setting an upper limit to the bit error rate BER, for example,
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
−120
−110
−100
−90
−80
−70
−60
−50
Distance r [km]
Signal level S [dBm]
Figure 5.6 Example for the received signal level as a function of the distance between MS
and BS.

CDMA
273
BER < 10−3 for speech services. Owing to uncertainties of radio propagation this BER
threshold may be exceeded in some parts of the network. Therefore, a coverage probability
cp of typically 90–98% is introduced, that is, the BER condition has to be fulﬁlled in,
for example, cp = 95% of the network area. Since the BER depends on the Eb/N0 or
the SNR, the network planner has to guarantee that the SNR is above the corresponding
threshold for cp = 95% of the network area. The SNR threshold is usually derived taking
into account a kind of margin against short-term fading. Considering, for example, a BPSK
in a Rayleigh fading channel with twofold diversity (L = 2), one obtains from Figure 2.11
and Equation 2.33 a threshold of about SNR = 11 dB.
Hence, while planning the network, one usually considers only the deterministic part of
the propagation model and the random long-term fading explicitly whereas the short-term
fading is included in the SNR threshold. The received level value resulting only from the
deterministic and the long-term fading part is called the local mean value.
The procedure discussed above is illustrated by the following example that by the way
also shows the effect of the long-term fading and the effect of the handover mechanism on
the network performance. Assuming a noise level of N = −111 dBm and an SNR threshold
of 11 dB, a signal level of S = −100 dBm is required to guarantee a sufﬁcient quality of
service. Figure 5.7 shows the probability functions of the signal level for three different
scenarios. The diagram was obtained by Monte–Carlo simulations using A = 140, B = 40
and σ = 8 dB as propagation parameters. The dotted line shows the probability function
of the signal level in a cell without any fading. The probability p(S ≤−100 dBm) – the
so-called outage probability op – is 0, that is, the coverage probability is 100%. Including
long-term fading in an isolated cell (i.e. neglecting neighbor cells), the received level is
better in some regions and is worse in other region than without long-term fading. This
is reﬂected by the dashed curve crossing the dotted one. Because of long-term fading the
−110
−105
−100
−95
−90
−85
−80
10
−2
10
−1
10
0
X [dBm]
p(S ≤X)
No fading
Isolated cell
with long
term fading
Network of cells with
long term fading and
ideal power budget HO
Loss due
to fading
Handover gain
1
2
1
2
Smin = –100 dBm
Outage probability 5%
Figure 5.7 Probability functions of the received signal level S for different scenarios.

274
CDMA
outage probability increases to an unacceptable value of about 0.2, that is, one has cp = 0.8.
To achieve the required coverage of cp = 0.95, one has to decrease the cell radius or the
value for the needed signal level by about 8.5 dB. However, coverage also gets better due
to macrodiversity when considering a network of several cells: if the signal level with
respect to one BS breaks down due to long-term fading, a handover to a BS with a better
signal level may be possible. While antenna diversity only gives microdiversity against
short-term fading, handover between base stations at different sites offers macrodiversity
against long-term fading (and even against short-term fading if the handover is executed fast
enough as in the case of a soft handover). For producing the solid line probability function
of Figure 5.7, an ideal power budget handover has been used selecting the BS with the
best local mean signal level. Looking at cp = 0.95, that is, op = 0.05, a gain of about 7 dB
is obtained by the handover method. This gain is called handover gain or macrodiversity
gain. When using a kind of maximum ratio combining of the macrodiversity paths, the gain
is higher than for the pure selection combining used in Figure 5.7. A lower handover gain
is achieved by a hard handover where a hysteresis margin is necessary since in this case
the MS is not connected to the best BS at each time.
Homogeneous hexagonal networks and frequency reuse
In a widely used model for simulating and comparing mobile networks, base stations are
placed on a regular hexagonal grid. Assuming omnidirectional BS antennas and a radio
propagation loss depending only on the distance between BS and MS, the cell area served
by a BS has the form of a regular hexagon.
For these hexagonal networks, various very symmetrical frequency reuse patterns exist;
some examples are illustrated in Figure 5.8: The total number of carriers N is divided
into a number of disjoint sets, and this number is called the cluster size K. One of these
frequency sets is allocated to each cell and each set is reused at each Kth cell. Cells using
the same frequency set are called cochannel cells. In Figure 5.8, cells using the frequency
set 1 are highlighted by a gray shading for K = 3 and K = 7. In a cluster of size K = 1,
neighboring cells use the same frequencies. Owing to the hexagonal symmetry there are
six cochannel cells at the reuse distance D causing the highest interference to each cell.
The interference caused by cochannel cells is called intercell interference Ir in contrast to
intracell interference Ia caused by connections within the same cell. Intercell interference
occurs in every mobile radio network with a frequency reuse, whereas intracell interference
is avoided in pure FDMA and TDMA systems by using a sufﬁcient carrier separation and
guard periods. Even for systems using frequency hopping, intracell interference is avoided
by selecting noncolliding hopping sequences within one cell. However, in CDMA systems
where many connections share the same frequency carrier at the same time, intracell inter-
ference has to be considered since the different connections cannot be separated perfectly
by their codes. In this subsection, the discussion focuses on intercell interference whereas
the effects of intracell interference are explained in Subsection 5.1.4.
Obviously, with decreasing cluster size K the number of frequencies per cell and
therefore the cell capacity increases. On the other hand, the mutual interference between
cochannel cells also increases. Hence, the art of network planning is to ﬁnd the smallest
cluster size K so that the connection quality is above a required level. The main indicator
for the connection quality in the case of interference is the signal-to-interference ratio SIR,
that is, the ratio between the (useful) signal power S and the interference power I (which

CDMA
275
1
6
7
5
2
4
3
1
6
7
5
2
4
3
1
6
7
5
2
4
3
1
6
7
5
2
4
3
1
6
7
5
2
4
3
1
6
7
5
2
4
3
1
6
7
5
2
4
3
2
3
1
2
3
1
2
3
1
2
3
1
2
3
1
2
3
1
2
3
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
Cluster 7
Cluster 3
Cluster 1
D
Reuse distance
Figure 5.8 Frequency reuse in homogeneous hexagonal networks.
is only intercell interference in this subsection). Figure 5.9 shows examples of the SIR
probability functions for K = 1, 3 and 9 and networks of omnicells as solid lines. Similar
results for sectorized networks are also included in the ﬁgure and will be commented later.
The probability functions were obtained by Monte-Carlo simulations using the following
assumptions:
• Mobile stations are spread randomly over the network.
• For each pair of MS and BS, the received level is calculated using B = 40 and
σ = 8 dB as propagation parameter (the parameter A has no effect on the SIR since
it cancels while taking the difference of the signal and interference level).
• Having calculated the received level with respect to each BS, an MS is assigned
to the BS with the highest level that is taken as the carrier level for that connec-
tion. Subsequently, the interference level is calculated by summing up the interfering
powers of all connections using the same frequency.
Figure 5.9 shows that for a transmission scheme, which needs an SIR of 10 dB, a sufﬁcient
coverage probability of cp = 0.97 (op = 0.03) can be achieved using K = 9. A cluster
1 requires very robust transmission techniques – as for example, spreading – working at
negative SIR values.
The network performance can be improved signiﬁcantly by sectorization. Starting, for
example – as shown in Figure 5.10 – with an omnicellular cluster of K = 1, one can sepa-
rate the frequency set 1 into 3 disjoint subsets (denoted as 1a, 1b, 1c) and allocate them to

276
CDMA
−10
−5
0
5
10
15
20
10
−2
10
−1
10
0
X [dBm]
p(SIR ≤X)
omni
sector (65°)
sector (90°)
K = 9 
K = 3
K = 1
K = 1 × 1
K = 1 × 3
K = 3 × 3
Figure 5.9 Probability functions of the SIR for different cluster sizes.
1
1
1
1
1
1
1
Cluster 1
(omni)
1a
1c
1b
1a
1c
1b
1a
1c
1b
1a
1c
1b
1a
1c
1b
1a
1c
1b
1a
1c
1b
1
1
1
1
1
1
1
1
1
Cluster 1 × 3
(sector)
Sectorization
Cluster 1 × 1
(sector)
Figure 5.10 Cluster sizes for sectorized networks.
the three different sectors. This cluster is denoted as K = 1 × 3. The number of channels per
base station site is the same as for omnicells of K = 1, but from the point of view of interfer-
ence it is very similar to the omnicellular cluster K = 3: the SIR is only 1 dB or 2 dB worse
than that of the omnicellular structure depending on the horizontal half power beam width
of the antennas (65◦for the dashed lines, 90◦for the dotted lines). The other possibility for
performing sectorization that is often used in CDMA networks is to allocate the complete

CDMA
277
frequency set to each sector; this is denoted as cluster K = 1 × 1. The number of channels
is three times as high as for a cluster K = 1, whereas the SIR distributions are very similar.
Hence, one can conclude that by applying sectorization a gain of three times the number
of channels per base station sites can be achieved at the expense of a moderate loss in SIR
of about 1 or 2 dB.
5.1.3
Spreading codes and their properties
In this subsection, various types of codes are discussed presenting and summarizing the
basic facts about spreading codes and their properties as far as they are needed for the
following sections. More details as well as proofs for some propositions can be found, for
example, in (Gibson 1999; Hanzo et al. 2003; Proakis 2001; Viterbi 1995).
Since spreading codes have different advantages and disadvantages, the appropriate type
of code has to be selected for the relevant situation or application. The main criterion for
selecting a set of codes is based upon the autocorrelation and cross-correlation functions
of these codes. The autocorrelation function, deﬁned as the scalar product of the code sig-
nals with code signal shifted by a delay τ, should be zero – at least approximately – for
τ ̸= 0. Such a good autocorrelation property is especially required in radar or positioning
systems where the autocorrelation process is used for an exact determination of the prop-
agation delay; but it is also very useful in mobile communication systems for separating
the different propagation paths and hence avoiding intersymbol interference. For CDMA
systems, different code signals c and c’ are used to distinguish different connections. The
mutual interference between the connections is proportional to the scalar product of c and
c’. Hence, for these applications of spreading one is tempted to require orthogonality of
codes. However, orthogonality alone does not sufﬁce for scenarios where the code signals
are not transmitted synchronously or where a high delay spread due to multipath propaga-
tion occurs. In that case also the scalar product between c and c’ shifted by the delay τ, that
is, the cross-correlation function of c and c’ has to be minimized. Each of the known types
of codes fulﬁlls one requirement to a higher and the other to a lower degree. Therefore,
the codes giving the best compromise for the respective applications have to be selected.
Another method is to apply several spreading steps and use different types of codes for
the separate steps.
Orthogonal variable spreading fact or codes
The orthogonal variable spreading factor codes (OVSF codes) look like the Walsh functions
discussed in Section 1.1.4.
However, they are arranged and numbered in a different way, that is, according to a
tree structure, which is illustrated in Figure 5.11.
For each spreading factor SF = 1, 2, 4, . . . , which is a power of 2, there are N = SF
orthogonal codes obtained by the recursion relations:
c2SF,2m = [cSF,m, cSF,m], m = 0, 1, . . . , SF −1.
(5.3)
c2SF,2m+1 = [cSF,m, −cSF,m], m = 0, 1, . . . , SF −1.
(5.4)
The symbol [c, c] denotes the composition of codes. The orthogonality of these codes for
a ﬁxed spreading factor SF follows immediately from the deﬁning equations. The notation

278
CDMA
c1,0 = [+1]
c2,0 = [+1, +1]
c2,1 = [+1, –1]
c4,0 = [+1, +1, +1, +1]
c4,1 = [+1, +1, – 1, – 1]
c4,2 = [+1, – 1, +1, – 1]
c4,3 = [+1, – 1, – 1, +1]
SF = 1
SF = 2
SF = 4
Figure 5.11 Tree structure for the orthogonal variable spreading factor (OVSF) codes.
c1,0
c2,0
c2,1
c4,0
c4,1
c4,2
c4,3
c8,9
c8,1
c8,2
c8,3
c8,4
c8,5
c8,6
c8,7
Assigned
code
Codes not allowed to be
assigned to other connections
Figure 5.12 Illustration of code allocation rules for different data rates.
variable spreading factor results from the fact that they are applied in CDMA communica-
tion systems offering different data rates. For these systems, the chip rate and chip duration
is kept ﬁxed. Hence, different symbol rates can be realized by varying the spreading factor:
TS = SF · Tc. Establishing connections with different data rates, some rules for selecting
the corresponding codes have to be observed for maintaining the orthogonality: if a cer-
tain code cSF,m is already used for one connection, neither this code nor a code that is a
descendant or an ancestor of this code is allowed to be used for another connection since
these codes are not orthogonal to the already allocated one.
This rule is illustrated in Figure 5.12: if, for example, code c4,1 is in use, another
connection with a different data rate is not allowed to use the encircled codes, but all other
codes. If, for example, the second connection has twice the data rate of the ﬁrst one, it has to
select the code c2,1. Within the period of one data bit of connection 1, connection 2 transmits
two data bits. The chip sequence corresponding to these data bits is either proportional to
c4,2 or c4,3 and hence orthogonal to the one for connection 1. To summarize the discussion
above: the OVSF codes can be applied to realize connections with different data rates by
varying the spreading factor. Orthogonality is preserved exactly even between connections
of different rates if some rules for code selection are observed.

CDMA
279
This property makes OVSF codes very attractive for modern communication systems as,
for example, UMTS. However, some disadvantages of these codes should also be mentioned
which limit their application. First of all, OVSF codes have a poor autocorrelation property,
which is obvious by looking, for example, at the codes cSF,0. Furthermore, the orthogonality
gets lost when there is no perfect synchronization, that is, there are high values for the cross
correlation.
Pseudonoise sequences
Codes with a good autocorrelation property can be generated by linear feedback shift
registers.
An example of a register of length m = 5 is shown in Figure 5.13. In each step, the
content of the register is shifted one place to the right and it is also fed back to the left-
most place by weighting the content by the coefﬁcients an and summing up all results. The
weights may take the value “0” and “1” and addition has to be performed as modulo-2
sum. Considering a register of length m, it possesses 2m different states. The state where
all places are set to “0” is not very exciting since it reproduces itself in each step. Starting
with another rather than this trivial state, the register produces a sequence of “0” and “1”
as an output whose period cannot exceed M = 2m −1. A generated sequence, which has
exactly this maximum possible length M, is called maximal length sequence or – shortly
m-sequence. The m-sequence of the example in Figure 5.13 has a length of M = 31. It
has been generated using the values of the weights given in the brackets. Comments on
the run length values are given below. The m-sequences are often referred as pseudonoise
(PN) sequences since they have similar properties as random numbers generated by tossing
a coin M times. Some of these properties are as follows:
• An m-sequence contains 1
2(M + 1) ones and 1
2(M + 1) −1 zeros, that is, for large
M one has nearly the same number of ones and zeros.
• Deﬁning a run as a maximal subsequence of consecutive identical numbers, one has
1 run of ones of length m, 1 run of zeros of length m −1, and 2m−r−2 runs of zeros
and 2m−r−2, r = 1, 2, . . . , m −2 runs of ones, each of length r.
1 1 1 1 1 0 0 1 1 0
1 0 0
1 0 0 0 0 1 0
1 0 1 1 1 0 1 1 0 0 0
5
2
2
1
1
2
1
4
1
1 1 1
3
1
2
3
X5
X1
X2
X3
X4
a5 = 1
a4
(0)
a3
(1)
a2
(0)
a1
(0)
a0 = 1
+
+
+
+
Run of
length:
First bit
Last bit of the
first period
Figure 5.13 Example for an m-sequence generated by a linear feed back shift register of
ﬁve stages.

280
CDMA
The most interesting property from the point of view of spread spectrum applications
concerns the autocorrelation function. Deﬁning the code sequence c corresponding to an
m-sequence by mapping each “0” to “+1” and each “1” to “−1”, the periodic discrete
normalized autocorrelation function is given by:
φ(ν) = 1
M
M−1

µ=0
cµ+ν · cµ
In an analogous way one can deﬁne the periodic discrete normalized cross-correlation
function between two periodic codes ci and cj as
φi,j(ν) = 1
M
M−1

µ=0
ci,µ+ν · cj,µ
It can be shown that the autocorrelation function of m-sequences is only two-valued:
φ(0) = 1 and φ(ν) = −1
M , ν ̸= 0. Hence, a code given by an m-sequence has – for large
M – nearly an ideal autocorrelation function like a sequence of independent Bernoulli
random numbers. It should be noted that deﬁning a continuous autocorrelation function
instead of a discrete one by using integrals instead of sums, this continuous function is
obtained from the discrete one by linear interpolation. Proofs of these and some more prop-
erties of m-sequences can be found in (Gibson 1999; Hanzo et al. 2003; Viterbi 1995).
These proofs are based on the relation between a linear feedback shift register with coef-
ﬁcients an(n = 0, 1, . . . , m) and its corresponding generating polynomial, which is given
by P (X) = amXm + am−1Xm−1 + · · · a1X + a0. This relationship also allows the classi-
ﬁcation of those registers that generate m-sequences: A linear feedback shift register of
length m produces an m-sequence if and only if the corresponding generating polynomial
of degree m is primitive. A polynomial of degree m is called primitive if it is irreducible,
that is, if it cannot be factored, and if is a factor of xM + 1, M = 2m −1.
The examples are as follows:
• The
polynomial
generating
the
m-sequence
of
Figure 5.13
given
by
P (X) = X5 + X3 + 1 is a primitive one.
• The simplest examples for primitive polynomials are the following two polynomials
of degree 3:
P1(X) = X3 + X2 + 1, P2(X) = X3 + X1 + 1.
They are irreducible since they cannot be divided either by X or by 1 + X. Further-
more, they fulﬁll the relation
(1 + X) · (X3 + X2 + 1) · (X3 + X1 + 1) = X7 + 1,
hence they are primitive.
As mentioned above, m-sequences have a nearly optimal autocorrelation property. Unfortu-
nately, there is some weakness concerning the cross correlation, whose peak values decrease

CDMA
281
quite slowly with increasing sequence length M. The peak value of the undesired elements
in the cross- and autocorrelation functions is deﬁned by
φmax = max(φi,j(ν)| (i = j and ν ̸= 0) or (i ̸= j and all ν)).
Though for a given M a subset of m-sequences with pairwise low cross correlation may
be selected, this set is quite small. Therefore, other methods are used to derive codes with
low cross correlation from the m-sequences.
Gold codes
A set of Gold codes of length M can be obtained by combining speciﬁc pairs of m-sequences
c, c′ which are called preferred m-sequences. This set of Gold codes  is given by c, c′
and the modulo-2 sums of c and all M different cyclically shifted versions of c′, hence
it contains M + 2 elements. Another way to number the Gold codes generated by c, and
c′ is:
 = {c0, c1, c2, . . . , cM, cM+1}
c0 = c, cM+1 = c′, cµ = c + c′(µ), µ = 1, 2, . . . , M,
where the sum has to be understood as a modulo-2 sum and c′(µ) is the m-sequence given
by the binary representation of µ as the initial setting for the generating shift register. This
process is illustrated in Figure 5.14 for the shift registers corresponding to the primitive
polynomials of degree 3 mentioned above. The resulting nine Gold codes have a length of
M = 7.
Concerning the decrease of auto- and cross-correlation functions Gold proofed the fol-
lowing proposition: the cross-correlation functions of Gold sequences take only the three
values −1/M, −t(M), t(M) −2, where t(M) decreases as 2/
√
M for large even M and
as √2/M for large odd M = 2m −1. To summarize, for large M the peak values of the
1
1
1
1
0
+
+
1
0
1
+
+
1
0 0 0,
0 0 1,...,
1 1 1
8 initial settings
+
c0 = 1 1 1 0 0 1 0
0
c1 = 1 1 0 1 1 1 1
0
c2 = 1 0 1 0 1 0 1
0
c3 = 1 0 0 1 0 0 0
0
c4 = 0 1 1 1 1 0 0
0
c5 = 0 1 0 0 0 0 1
0
c6 = 0 0 1 1 0 1 1
0
c7 = 0 0 0 0 1 1 0
0
c8 = 1 1 1 0 1 0 0
Figure 5.14 Example for a generation of Gold codes.

282
CDMA
cross-correlation functions of Gold codes are much smaller than for the m-sequences, but
at the expense of higher (but also decreasing) values of the autocorrelation functions. The
combined codes in the set of Gold codes are no m-sequences.
Furthermore, it should be mentioned that the ﬁrst eight Gold codes have even an optimal
cross correlation, that is, the cross-correlation functions take only the value −1/M = −1/7.
Hence, padding a “0” to each of these eight codes, one gets eight codes of length eight,
which are exactly orthogonal. These orthogonal codes may be used as roots for code trees
produced in the same way as the one for the OVSF codes discussed above. Compared to
the Walsh codes, the orthogonal Gold codes have a better autocorrelation property.
Kasami codes
The most important property of Kasami codes is that the peak values of the cross-correlation
functions are even smaller than for the Gold codes: φmax decreases as 1/
√
M for large M.
The Kasami codes are also derived from m-sequences. The degree m of the corresponding
polynomial has to be even: m = 2k. In that case, the length M = 2m −1 can be factorized:
M = (2k −1) · (2k + 1), k = m/2. Starting from an m-sequence c0, the corresponding dec-
imated sequence cd is obtained by taking every dth chip from c0 – where d = 2k + 1 for
a Kasami code generation – and repeating these 2k −1 chips 2k + 1 times. The resulting
code sequence cd has the same length as c0 but a period of 2k −1. The set of Kasami codes
is constructed in a similar way as the set of Gold codes by taking c0 and the modulo-2 sum
of c0 and all 2k −1 cyclically shifted versions of cd.
Comparing Gold and Kasami codes of code length M, the peak value of cross correlation
is lower for Kasami codes, whereas the cross-correlation functions of Gold codes take the
lowest possible value −1/M more often. Furthermore, there are more Gold than Kasami
codes.
Figure 5.15 summarizes the essential facts concerning the number of codes and the peak
values of their cross-correlation functions for m-sequences, Gold and Kasami codes.
Barker codes
Another type of codes used in spread spectrum systems without CDMA, that is, without
the need for separating different users, is given by the so-called Barker codes. These are
characterized by minimizing certain kinds of reduced autocorrelation functions deﬁned by
φr(ν) =
M−1−ν

µ=0
cµ+ν · cµ, 0 ≤ν < M
φr(ν) =
M−1

µ=−ν
cµ+ν · cµ, −M < ν < 0.
A code c consisting of +1 and −1 of length M is called a Barker code if and only if
|φr(ν)| ≤1 for all ν with 0 < |ν| < M.
Correlating a Barker sequence b of odd length M with a concatenated Barker sequence
of the form [σ1 · b, σ2 · b, . . .], σi = −1, +1, which occurs when spreading a sequence of
data bits, the out-of-phase values of the discrete autocorrelation function take the values
1/M and −1/M, that is, the smallest possible values.

CDMA
283
3
4
5
6
7
8
9
10
11
12
13
10
0
10
1
10
2
10
3
Polynomial degree m
Number of codes
m-sequences
Gold codes
Kasami codes
3
4
5
6
7
8
9
10
11
12
13
10
−2
10
−1
10
0
Polynomial degree m
Peak cross correlation
m-sequences
Gold codes
Kasami codes
Figure 5.15 Comparison of m-sequences, Gold and Kasami codes.
c2
c3
c4
c5
c7
c11
c13
c2
1
c2
2
c4
1
c4
2
Figure 5.16 Barker codes.
Up to transformations of the type cµ →−cµ, cµ →(−1)µ · cµ, cµ →−cM−µ there
exist only the Barker codes shown in Figure 5.16. A Barker code of length M = 11 is
used in Wireless LANs according to the standard IEEE 802.11 as will be explained in
Subsection 5.5.1.

284
CDMA
Usage of codes
The codes discussed above are used in different systems in different ways:
• For modulation, which may be called code keying, the different data symbols of one
connection are mapped onto different codes of short length as the Walsh codes. This
kind of modulation is used in the uplink of the cdmaOne (IS-95) mobile communica-
tions standard and has been discussed in Subsection 1.1.4 as Walsh modulation. It is
also applied using complex-valued versions of the Walsh codes within Wireless LANs
according to the IEEE 802.11b standard, which will be explained in Subsection 5.5.1.
• As a direct sequence spread spectrum method, all data symbols of one connection
(or at least of one data packet) are spread using the same code; different codes are
allocated to different connections. In this case the code length is either chosen equal to
the period length of a data symbol or much longer. As an example for the ﬁrst case, the
spreading factors of the OVSF codes in UMTS are selected in exactly the way that the
corresponding code length matches the period of the data symbols of the connection.
In contrast, the precision code of the Global Positioning System (GPS) has a duration
of nearly nine month partitioned into 37 one-week segments. This is of course longer
than a data symbol. Also in mobile communication systems like UMTS or IS-95, quite
long codes are applied. However, for UMTS the respective Gold codes corresponding
to polynomials of degree m = 25 are truncated to the length of a physical data frame
(10 ms corresponding to 38,400 chips). In this case, the correlation functions of the
truncated code instead of the complete Gold codes have to be considered.
In CDMA mobile communication systems spreading is often performed in two steps: In a
ﬁrst step, each symbol of a connection is multiplied by a Walsh or OVSF code allocated to
the respective connections. Different connections generated by one and the same source use
orthogonal codes. The source may be a BS having connections to many MSs or an MS hav-
ing several parallel connections (e.g. one connection for speech and another one for internet
browsing). Since the signals are transmitted synchronously by one source, the corresponding
codes are expected to keep their orthogonality – at least to a high degree – in environments
with a low delay spread. Hence, the Walsh and OVSF codes are applied as channelization
codes to separate several signals transmitted by one source. Signals transmitted by different
sources cannot be assumed to be synchronized. Therefore, Walsh and OVSF codes are not
the appropriate ones to separate these signals. Hence, in a second step the signals of differ-
ent sources are multiplied by long m-sequences or Gold codes. These scrambling codes are
allocated in a way to distinguish the signals of different sources – at least locally. Different
MSs use different codes; a scrambling code allocated to one cell is not reused in a neighbor
cell, but may be allocated to another cell within the network far away. This code allocation
method is illustrated and explained in some more detail in Subsection 5.5.4.
5.1.4
Methods for handling interference in CDMA mobile
radio networks
As discussed in the previous subsection, orthogonality of codes gets lost – at least to some
degree – in mobile radio networks, since for the uplink direction one has no perfectly

CDMA
285
synchronized transmitters (the different mobile stations) and in both directions one has
multipath propagation with a certain delay spread. Hence, without any additional measure
a high level of intracell interference will occur, thereby reducing the performance of the
respective CDMA mobile radio systems signiﬁcantly. Therefore, methods for managing and
reducing interference have to be applied, which are as follows:
• power control (PC)
• soft handover (SHO)
• interference cancellation (IC) and other multiuser detection receiver techniques
• smart antenna techniques (SAT).
Power control
A method that is absolutely necessary to achieve sufﬁcient performance in UL direction
is transmission power control. As demonstrated in Figure 5.6, the uplink received level
from MSs at different positions varies in a range of about 50 dB or more. Without PC the
result will be a probability function of the local mean UL SIR as shown by the solid line in
Figure 5.17, where a cluster K = 1 and 10 active connections per carrier are assumed. A
signiﬁcant part of the connections experiences an SIR of −30 dB or less. This results from
the so-called near–far problem: the transmitted signal by an MS near the BS will highly
−40
−35
−30
−25
−20
−15
−10
−5
0
5
10
10
−2
10
−1
10
0
X [dBm]
p(SIR ≤X)
no PC
PC
Figure 5.17 Probability function of the uplink SIR with and without power control.

286
CDMA
dominate the signals of all other mobile stations far away from the BS. Hence, spreading
factors higher than 1000 will be necessary to be able to separate the 10 connections. This
will of course be a giant waste of bandwidth.
The situation gets much better applying PC in uplink direction as shown by the dashed
curve in Figure 5.17: the probability distribution of the SIR with PC is very narrow, nearly
all connections have an SIR better than −14 dB. It should be noted that for Figure 5.17 only
the local mean value of the SIR has been considered. However, there is also a signiﬁcant
variation of the signal level due to short-term fading (depending on the ratio between signal
and coherence bandwidth). Hence, PC has to be able to react also on short-term fading and
therefore has to be very fast. For example, a vehicular mounted MS moving at a speed
of v = 90 km/h = 25 m/s crosses a distance of 25 mm in 1 ms, which is a signiﬁcant part
of the wavelength of 15 cm at a frequency of 2 GHz. This rough estimation shows that
PC actions have to be taken at a rate of about one per millisecond. For UMTS the power
control rate is 1500 Hz, for IS-95 and cdma2000 it is 800 Hz.
Having estimated the power control rate, the next question is how to organize power
control. Concerning the control loop, one distinguishes
• open-loop power control and
• closed-loop power control.
These concepts are illustrated in Figure 5.18 for power control in UL direction. Neverthe-
less, the concepts may be transferred directly to the DL by interchanging the roles of MS
and BS. For the UL open loop, the MS adjusts its own transmit power on the basis of the
received DL signal, whereas in a closed loop the BS measures the received signal strength
and transmits a power control command to the MS. In consequence, the MS adjusts its
transmit power on the basis of the received UL signal. The advantage of the open-loop
MS
BS
Received
DL signal
MS
BS
Received
UL signal
Adjust UL
TXPWR
PC
CMD
Adjust UL
TXPWR
Open loop
Closed loop
CMD: command
TXPWR: transmit power
Figure 5.18 Open- and closed-loop power control.

CDMA
287
concept is that no control channel for PC commands in the reverse direction is needed and
that a PC action may be taken immediately without signaling delay. The essential disad-
vantage is that the reception conditions may be very different in UL and DL direction due
to mainly two reasons:
• Short-term fading differs since it depends on frequency and changes rapidly with time.
Within systems using frequency division duplex, UL and DL are usually separated
by 20–200 MHz, while in time division duplex systems they are separated by a time
period of some milliseconds.
• Interference differs in UL and DL direction.
In general, an open loop is applied to set the initial power at a call setup, thereafter a fast
closed-loop power control is used.
Though in DL direction the near–far problem does not exist and therefore DL PC
is not as necessary as UL PC, it is worthwhile to implement DL PC for the following
reason: though intracell interference is constant in DL direction, intercell interference varies
for different MSs, since they have different distances with respect to the disturbing base
stations. DL PC can equalize the SIR where I is the sum of inter- and intracell interference.
However, as long as intracell interference signiﬁcantly contributes to the total interference,
the DL SIR without PC varies in a relatively small range of less than 10 dB. Hence, the
potential for DL PC is much smaller than for UL PC.
In systems like IS-95 and UMTS, power control is accomplished by setting a target
SIRtar for the required SIR. This is illustrated in Figure 5.19. If the SIR measured on
SIR >
SIRtar
TXPWR =
TXPWR + STEP
TXPWR =
TXPWR – STEP
Next
transmission
Increase
SIRtar
Decrease
SIRtar
Long-term quality
better than required
Yes
No
Yes
No
Outer loop
Inner loop
Figure 5.19 Illustration of outer and inner-loop power control.

288
CDMA
a millisecond scale is above SIRtar, the transmit power level TXPWR is decreased by a
certain STEP, otherwise TXPWR is increased by STEP. The parameter STEP may be set
by the operator to, for example, 0.5, 1, 2 or 3 dB. However, it should be noted that the
appropriate target for the SIR depends on different parameters as the considered service,
the velocity of the MS and the multipath proﬁle. Hence, the SIR target also has to be set
adaptively using a second control loop, the so-called outer loop. While the inner loop reacts
on the measured SIR on a millisecond scale, the outer loop reacts on longer scales using
averaged values of, for example, the following quantities as an input:
• the block error rate;
• the estimated bit error rate before channel decoding;
• soft output information of the channel decoder.
Having roughly explained the usefulness as well as some variants of PC, the performance
and the gain achieved by fast UL PC is now quantiﬁed in some more detail using an
example with the following assumptions:
• An UMTS-like closed-loop P C algorithm with STEP = 1 dB and SNRtar = SIRtar =
0 dB is investigated.
• The signal S is only disturbed by a constant noise level N, interference I is neglected.
• The local mean signal level is assumed to be constant, the signal level only varies due
to short-term fading which has been generated using the ITU channel models for the
vehicular and indoor-to-outdoor-pedestrian environment described in Section 2.3. Re-
solvable propagation paths are combined within the BS RAKE receiver. Furthermore,
a twofold antenna diversity is used to reduce the effect of fading.
The results of applying UL PC in such situations for a pedestrian (v = 1 m/s) and a vehicular
(v = 10 m/s) subscriber are illustrated in Figure 5.20. Part (a) shows the short-term fading
level, the (relative) transmit power level TXPWR as well as the resulting SNR as a function
of time. For the pedestrian, PC is able to equalize the fading nearly completely: the deviation
of received SNR from SNRtar is less than 1 dB, which can be seen in part (c) of Figure 5.20.
The deviation would be even smaller, if a smaller STEP had been selected. Also for the
vehicular subscriber moving at moderate velocity, PC is able to follow the fast fading in
general. However, there are situations where power control is to slow: About 10% of the
SNR values deviate more than 1 dB from SNRtar, even a deviation of 3 and 4 dB occurs.
For a higher velocity the deviation becomes even larger. In UMTS or IS-95 networks power
control is not able to follow the fast fading for a velocity above approximately 50 km/h.
However, at high velocities interleaving becomes more efﬁcient instead.
Figure 5.20(b) shows the distribution of the values of TXPWR. It should be noted that
the mean transmit power for the pedestrian is about 2 dB higher than for the case of no PC,
whereas the mean SNR is the same. This increase of the mean transmit power due to fast
power control results in an increased interference to other connections. For the vehicular
subscriber, this interference increase is lower (about 1 dB), partly because of the higher
multipath diversity reducing the fading in the vehicular environment and partly because PC
cannot follow fast fading to the same degree as for the pedestrian.

CDMA
289
3
3.5
4
−10
0
10
(a)
(b)
(c)
Time [s]
Level [dB]
Pedestrian (v = 1 m/s)
−10
−5
0
5
10
0
0.1
0.2
Relative transmit level [dB]
Probability [0..1]
−5 −4 −3 −2 −1 0 1 2 3 4 5
0
0.2
0.4
SNR [dB]
Probability [0..1]
1.1
1.15
1.2
−10
0
10
Time [s]
Level [dB]
Vehicular (v = 10 m/s)
−10
−5
0
5
10
0
0.1
0.2
Relative transmit level [dB]
Probability [0..1]
−5 −4 −3 −2 −1 0 1 2 3 4 5
0
0.2
0.4
SNR [dB]
Probability [0..1]
SNR, no PC 
TXPWR
SNR, PC 
TXPWR
SNR, no PC 
SNR, PC 
Figure 5.20 Illustration of the dynamics of fast UL PC and its effect to fading compensation.
Hence, while a slow power control algorithm removes the near–far problem and reduces
the local mean intercell interference, a fast power control algorithm additionally may cancel
the effect of the fast fading to a certain degree depending on the velocity of the MS. This
results in a gain with respect to the required Eb/N0 since the channel to be considered
is approximately a pure Gaussian instead of a fading one. Simulation results reported in
(Holma and Toskala 2001) show that for a pedestrian UMTS subscriber in a low delay
spread environment the Eb/N0 requirement for a speech-like service can be reduced by
fast power control from 11.3 dB to 5.5 dB. On the other hand, an interference rise of about
2 dB is caused, reducing the effective gain from about 6 dB to about 4 dB. For a vehicular
subscriber with a velocity of about 50 km/h and above, there is no additional gain by fast
power control; however, interleaving becomes efﬁcient reducing the effect of fast fading.
Summing up the discussion for PC, one obtains the following main results:
• UL PC removes the near–far problem caused by intracell interference and leads to
a signiﬁcantly improved probability distribution of the local mean SIR as illustrated
in the example of Figure 5.17.
• Compensating the near–far effect by PC reduces not only the intracell, but also the
intercell interference: an MS at a reduced power causes less interference in other
cells. This effect is included in Figure 5.17.

290
CDMA
• Fast UL PC can cancel fast fading nearly completely for pedestrian subscribers.
Depending on the environment, this results in a gain of some decibels with respect
to the required Eb/N0 since the channel to be considered is approximately a pure
Gaussian instead of a fading one.
• At higher velocities, fast fading may not be cancelled. However, interleaving becomes
efﬁcient instead so that nearly the same Eb/N0 requirement is achieved as for a
pedestrian subscriber.
• The signaling effort for fast power control depends on the fading rate. Within the
present mobile communication systems it is about 1–2 kbit/s.
• DL PC reduces the intercell interference. Its potential is lower than that of UL PC.
In present TDMA-based systems like GSM, power control is implemented as slow PC
with a control rate of about 1 Hz. By this method, an improvement for the local mean
SIR can also be achieved. In principle, it would be possible to speed up power control.
However, due to the TDMA nature, data and power control commands for one connection
are not transmitted continuously, but only within the allocated time slot. Hence, (closed-
loop) power control in TDMA systems is slower than in CDMA systems. The ratio mainly
depends on the duration of a TDMA frame.
More details on power control in CDMA mobile radio systems can be found, for
example, in (Holma and Toskala 2001; Viterbi 1995).
Frequency allocation and capacity estimation
In the following text, some simpliﬁed capacity estimations are presented to work out the
optimum cluster size for CDMA networks and to discuss the beneﬁts of these networks
with respect to capacity. The estimations are based upon the following assumptions:
• The interference power I = Ia + Ir composed of intracell interference Ia and intercell
interference Ir is much larger than the noise power N so that N can be neglected.
• Interference affects the bit error rate in the same way as white noise, that is, the signal-
to-interference ratio S/I is related to the Eb/N0 by Eb/N0 = SF eff · S/I, where SF eff
is the effective spreading factor.
• The number of active connections n is the same in each cell. All connections use the
same effective spreading factor.
• An ideal UL PC is applied so that all connections within a cell are received at the BS
with the same signal power S. Consequently, the relative intracell interference power
is given by Ia/S = α · (n −1). The factor α, which ranges between 0 and 1, is called
orthogonality factor. For ideal orthogonal codes or if intracell interference could be
cancelled completely by special receiver techniques, α would be 0. However, without
these techniques α = 1 is a more realistic assumption for the UL.
• UL intercell interference is generated by a large number of independent sources,
the MSs. Hence, it is reasonable to model the relative intercell interference power

CDMA
291
Ir/S as a Gaussian random variable with a mean value n · q and standard deviation
of √n · σI, where q and σI are the mean value and the standard deviation of the
interference distribution for one interferer per cell. These quantities mainly depend
on the propagation parameters, the cluster size K and the used antenna conﬁguration;
examples are given below.
Composing all these assumptions, one obtains in a ﬁrst step for the median SIR:
SIRm =
1
α · (n −1) + q · n ≥Eb/N0
SF eff
.
(5.5)
Hence, considering only median values, the maximum number of active connections
per cell nm is given by
nm =

SF eff
(Eb/N0) + α

·
1
(α + q).
(5.6)
However, these results for the median values are too optimistic. An operator usually
has to guarantee a coverage probability of, for example, cp = 0.95. Hence, in this case one
has to consider the 95%-percentile of the relative interference:
(I/S)95 = α · (n −1) + n · q + √n · σI · γ95,
(5.7)
where γ95 = 1.65 is the 95%-percentile of the normalized Gaussian distribution. Requiring
that the corresponding SIR shall be greater than or equal to the Eb/N0 divided by the
effective spreading factor, one obtains after some elementary algebraic manipulation for
the maximum number of connections per cell (at 95% coverage probability):
n95 = nm + 2b2 −2b ·

nm + b2,
b = σI · γ95
2(α + q).
(5.8)
Using Equation 5.6 and Equation 5.8, the effect of spreading and CDMA on radio
network capacity can be discussed. For this reason, sectorized networks with 65◦half
power beam width antennas and cluster sizes K = 1 × 1 and K = 1 × 3 are considered
as examples. Assuming a propagation parameter of B = 40 dB per decade and a stan-
dard deviation of the long-term fading of σ = 8 dB, the following values for the intercell
interference parameters are derived by Monte-Carlo simulations:
• for K = 1 × 1 one has q = 0.79 and σI = 0.5,
• for K = 1 × 3 one has q = 0.15 and σI = 0.19.
Decreasing B, that is, the decay of the signal level as a function of the distance, increases
the intercell interference and therefore q and σI. For a cluster 1 or 1 × 1, the intracell
interference (given by α) and mean intercell interference (given by q) per connection are
of the same order of magnitude.
Equation 5.6 and Equation 5.8 are illustrated in Figure 5.21 using the values above
and Eb/N0 = 6 dB as input values. Though the spreading factor in Figure 5.21 is varied,
the Eb/N0 is kept at a constant value, to highlight additional effects of spreading beside
frequency diversity. The number of active connections per cell n has been normalized by the
effective spreading factor SF eff and the cluster size K to get a comparison of the network

292
CDMA
0
20
40
60
80
100
120
140
160
180
200
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
SFeff
n / (K ⋅SFeff )
K = 1 x 1, a = 0
K = 1 x 1, a = 1
K = 1 x 3, a = 1
Figure 5.21
Network capacity per bandwidth as a function of the spreading factor for
different interference scenarios.
capacity per totally allocated frequency spectrum; the total required spectrum is proportional
to both quantities. Results corresponding to the median coverage are marked by the symbol
“*”, whereas the results corresponding to the 95%-percentiles are not marked. Considering
ﬁrst the cluster K = 1 × 1 and the overidealized case of no intracell interference (solid line
in Figure 5.21), the median value of the allowed number of connections nm is proportional
to SF eff, that is, there is no gain of spreading with respect to the relative capacity as long as
frequency diversity is neglected. However, when considering the 95% coverage probability,
a gain is achieved due to the large number of users; this gain is called interference averaging
or interference diversity. For high spreading factors, the value for the 95% coverage tends
toward the median values, that is, a CDMA network operator may perform network planning
based on nearly the mean values, whereas a TDMA operator has to consider the worst case
scenarios. To highlight the effect of interference averaging, the results from Monte-Carlo
simulations for small spreading factors and therefore small numbers of n are included in
Figure 5.21 and they are marked by the symbol “o”.
Taking into account intracell interference with α = 1 (dashed lines), there is still some
interference diversity gain. Since intracell interference has a strong impact on network
performance, one gets a capacity loss for CDMA networks in this case (which however,
may be compensated or even turned into a gain when considering frequency diversity as
well). In the example of Figure 5.21, the capacity is reduced by about a factor of 2.1 since
the ratio of total interference and intercell interference ((α + q)/q) is approximately 2.1.
This example shows also the potential for methods like interference cancellation, even if
only intracell interference may be cancelled.

CDMA
293
Reducing the intercell interference by increasing the cluster size to K = 1 × 3, increases
the SIR by about 2 dB for the considered example, but at the cost of requiring the three-
fold bandwidth which is of course a bad deal. Hence, as long as there is a strong impact
of intracell interference, the cluster K = 1 × 1 is the optimal one from the point of view
of network performance. For higher cluster sizes, the additional bandwidth costs are not
compensated by the gain due to intercell interference reduction. However, if intracell inter-
ference can be reduced signiﬁcantly (α below 0.1), higher cluster sizes may become more
efﬁcient depending on many parameters as, for example, the propagation parameters.
Until now only the UL capacity has been discussed. Though similar consequences can be
drawn for the DL, there are some differences; since the signals for the different connections
within one cell are transmitted synchronously, orthogonality of codes may be preserved at
the receiving end, at least in environments with a low delay spread. Hence, the intracell
interference for the DL is expected to be signiﬁcantly lower than for the UL. In (Holma
and Toskala 2001) orthogonality factors of α = 0.4 and α = 0.1 are reported for UMTS
(chip duration: 260 ns) in a vehicular environment with a delay spread of 370 ns and in a
pedestrian environment with a delay spread of about 50 ns, respectively. Hence, for the DL
the potential of interference cancellation methods is expected to be lower than for the UL.
Intercell interference in DL direction is generated by the base stations, that is, by
much less sources than for the UL. Hence, the interference averaging effect discussed for
the UL reduces to zero. Nevertheless, also in DL direction one proﬁts from interference
averaging since the interference generated by one BS or even by one connection at a BS
may vary – mainly for the following three reasons:
• Because of DL PC, different connections at one BS result in different values for the
interference power.
• For speech services, discontinuous transmission (DTX) may be applied, that is, in
phases of no speech activity the transmission for the respective connection is switched
off reducing the corresponding interference power to zero.
• For inhomogeneous load conditions, the interference power generated by neighboring
base stations may differ.
It should be mentioned that interference averaging with respect to the two last mentioned
effects (which may also be present in UL direction) results in a higher gain than the one
mentioned when discussing Figure 5.21 for the UL.
Because of the interference averaging effect and since the number of codes per cell
in general puts no restriction to the number of connections per cell, CDMA networks are
usually planned by the so-called soft capacity planning strategy, which is explained in the
following text, in contrast to a hard capacity planning strategy.
• For a hard capacity planning, in general, a high value of the cluster size is used so
that even if all installed channels are busy, the SIR stays above the required value
(with a probability of e.g. 95%). The capacity of a cell is limited by the number of
installed channels and that limit is a hard one, that is, if all channels are busy a new
request is blocked.

294
CDMA
• For a soft capacity planning, a much smaller cluster size (e.g. K = 1) is used. Hav-
ing a smaller cluster size, more channels per cell exist. This means that in this
case the capacity limit is not given by the maximum number of channels per cell,
but by an upper limit on the total interference power. Therefore, powerful and re-
liable methods for controlling the interference within the network are required to
reduce the risk that a small increase of interference causes a signiﬁcant performance
degradation for many connections; these methods are called load and admission
controls.
Furthermore, the interference experienced by different connections should be ap-
proximately the same and hence interference averaging is required. The soft ca-
pacity planning strategy is therefore usually applied in CDMA mobile radio net-
work. But since recent years, more and more GSM networks using frequency hop-
ping are also planned according to this strategy (see e.g. (Rehfuess and Ivanov
1999)).
The main advantage of the soft capacity planning strategy is that only the mean interference
has to be controlled, that is, there may be a very high load in one cell as long as the load
within other cells, and therefore the interference caused by these cells, is low. Hence, a
network planned by this strategy is able to react automatically on inhomogeneous and
time-dependent load conditions.
Another consequence that may be drawn from Equation 5.6 and Equation 5.8 is related
to the effect of channel coding in CDMA networks. Because of these equations the num-
ber of active connections per cell is approximately proportional to the ratio between the
effective spreading factor SF eff and the Eb/N0 (assuming a high bandwidth and spreading
factor). Keeping the bandwidth at a constant value and introducing channel coding reduces
the effective spreading factor. On the other hand, there is a coding gain (reduced Eb/N0
requirements) turning the loss of the spreading factor into a gain for the number of active
connections. This means that in a CDMA network the coding gain can be directly and
continuously turned into a capacity gain. Though a TDMA network using the hard capacity
planning strategy also proﬁts from channel coding, it is more difﬁcult to implement the
corresponding capacity gain by reducing the cluster size and reworking the frequency plan.
Furthermore, the reduction of cluster size can only be performed in discrete steps, which
may be too high for a given coding gain.
As argued in the preceding text, a cluster 1 or 1 × 1 using the same frequency car-
riers in neighboring cells is in general the most efﬁcient frequency allocation scheme in
CDMA mobile radio networks, at least when cells within the same hierarchical level are
considered. However, in regions of very high load as pedestrian area, railway stations or
shopping malls, additional small sized cells called microcells may be implanted into an
existing network of macrocells. While the high-power macrocells accomplish the overall
coverage, the low power microcells are installed to serve most of the trafﬁc, that is, cell
selection between these two hierarchical levels is not primarily based upon the signal level,
but on load conditions. Since these two types of cells are operating at unbalanced power
levels, interference caused, for example, by the macrocells to the microcells cannot be
controlled by the same methods (power control, soft handover) as the interference within
the macrocell layer. Therefore, the cells in different levels of this hierarchical cell structure
should use disjoint frequency carriers.

CDMA
295
The discussion on frequency allocation and capacity is summarized as follows:
• The gain of CDMA networks with respect to capacity is not achieved by spread-
ing itself, but by interference averaging. Especially, for a strongly varying and
inhomogeneous network load, a high gain can be achieved. With respect to capacity
there is no other beneﬁt of spreading except for frequency diversity.
• Intracell interference strongly degrades the network performance, especially in UL
direction. However, methods like interference cancellation are expected to reduce
intracell interference and therefore enhance capacity signiﬁcantly. The effect of in-
tracell interference is expected to be lower in DL direction where orthogonality of
codes is preserved to a certain degree.
• Owing to the strong impact of intracell interference, a cluster 1 × 1 leads to the
highest capacity values. Using a cluster 1 × 1, the high effort for frequency planning
can be avoided.
• The soft capacity planning strategy related to the cluster 1 × 1 frequency allocation
and the interference averaging effect of CDMA allows an adaption of the network
capacity to time-varying and inhomogeneous load conditions. Furthermore, a channel
coding gain can be directly and continuously transferred into a capacity gain.
• Soft capacity planning is not only applicable in CDMA networks, but also in TDMA
networks using frequency hopping.
• In a hierarchical cell structure, the different layers should use disjoint frequency
carriers.
Soft handover
As argued earlier, CDMA mobile radio networks should be operated in general by using
a cluster 1 or a cluster 1 × 1, that is, allocating the same frequencies in neighboring cells.
However, this fact results in a high degree of intercell interference. Even a single MS near
the cell border may disturb in UL direction all connections in a neighbor cell to a high
degree if no special measure is taken. To illustrate this, consider an MS near the border
of two cells called cell 0 and cell 1. The MS is assumed to be currently served and power
controlled by cell 0, that is, the corresponding BS 0 is the one with the highest received level
for that MS (higher than for e.g. BS 1) and the signal level is adjusted to the target level
by PC. However, due to fading, the level with respect to BS 1 may temporarily become
much larger than the target level within some milliseconds, that is, the interference by that
MS may exceed the signal level of all other connections in cell 1 signiﬁcantly. To avoid
this undesired situation, a soft handover is required, that is, the MS has to be served and
power controlled not only by BS 0 but also by BS 1 (and eventually further base stations
receiving nearly the same signal level from the MS as BS 0 and BS 1).
In UL direction, soft handover is implemented usually in one of the two following
ways:
• The signals processed by the RAKE receivers of all involved base stations are com-
bined by maximum ratio combining.

296
CDMA
• Each involved BS performs the channel decoding for the received signal and adds
a frame reliable indicator to each decoded frame. The frames are transferred to the
radio network controller which selects the most reliable one.
Obviously, the ﬁrst method which is called softer handover in UMTS gives the highest
performance; however, the highest data rate also is required to transfer all received signals
to the combining element. Therefore, it is applied (e.g. in UMTS) only for base stations
that are installed at the same site, that is, for a soft handover between sector cells served
from the same site. A UL soft handover between base stations at different sites is usually
managed by the second method, that is, by a selection combining of data frames that have
a length of some tenth of milliseconds.
In DL direction, soft handover is performed by transmitting the same data to the MS
from several base stations. Since a cluster 1 is used, each of the corresponding signals is
sent on the same frequency and is spread by the codes of the respective cells. Furthermore,
the transmitted signals are roughly synchronized (to an order of about some microseconds).
Hence, from the point of view of the receiving MS, the different signals can be handled in
nearly the same way as multipath components of one signal, that is, they can be combined
by the RAKE receiver. The only modiﬁcation is that correlation within the RAKE ﬁngers
has to be performed using the different codes corresponding to the involved base stations.
Furthermore, it should be observed that the number of RAKE ﬁngers in an MS is limited.
Having explained the general principles of soft handover, some comments on the gain
that can be achieved by this method should be added:
The soft handover gain comprises
• a microdiversity gain against short-term fading
• and a macrodiversity gain against long-term fading.
Considering the macrodiversity gain, it is obviously proﬁtable to switch the connection as
fast as possible to the BS with the highest local mean received level. Also in the case of a
hard handover the general strategy is usually to switch to the BS guaranteeing the best level.
However, as mentioned in Subsection 5.1.3, in this case one aims to avoid many forward
and backward handovers between different cells by basing the decision on an averaged
level and by introducing a hysteresis margin of some decibels. This means that as long as
the averaged receive level of the neighbor cell does not exceed the averaged level of the old
cell by, for example, 4 dB, no hard handover is performed for the respective MS. Hence,
for a hard handover there may be phases of some seconds where the MS is not served
by the BS with the best local mean signal level, that is, where the performance is lower
than for a soft handover. The performance difference between hard and soft handover with
respect to macrodiversity depends on the averaging length and hysteresis margin, which on
their part have to be selected on the basis of the MS velocity, the standard deviation and
correlation length of the long-term fading and the tolerable rate of handovers. Though it
is very difﬁcult to quantify the macrodiversity gain exactly, some results from (Graf et al.
1997) are quoted to give an idea of the order of magnitude; for typical scenarios, the SIR
at 95% coverage is improved by about 1–2 dB.
How much additional microdiversity gain can be achieved by soft handover depends on
to what extent short-term fading has already been combatted by other means like antenna

CDMA
297
diversity and multipath combining within the RAKE receiver. A signiﬁcant microdiversity
gain by soft handover is only expected if the difference between the local mean signal levels
of the involved signals is low. Furthermore, for the DL direction it should be observed that
the number of RAKE ﬁngers in an MS is limited to, for example, four. This means that
if one or two of these ﬁngers are needed for soft handover connections to additional base
stations, multipath diversity combining is reduced. Hence, it depends on the multipath
proﬁle and the difference of the local mean values of the signal levels, whether a multipath
or a soft handover combining is preferable. Since the gain of soft handover depends on
many parameters, it requires thorough investigations to derive reliable and exact values.
Nevertheless, a very simpliﬁed model is presented to give an idea of the order of magnitude
of the gain. Concerning short-term fading the following assumptions are made leading to
results of Figure 5.22:
• The RAKE receiver in the MS and BS is able to combine four propagation paths.
• The ITU channel model A for a vehicular environment (see Section 2.3) is taken as
the multipath proﬁle. The four fading paths have the relative mean power levels of
0, −1, −9 and −10 dB.
• Antenna diversity is implemented as a maximum ratio combining within the BS for
the UL, but no antenna diversity is used in DL direction.
−8
−6
−4
−2
0
2
4
10
−1
10
0
X [dB]
p(S ≤X)
DL
UL
6
3 
0 
0
no SHO
UL
no SHO
DL
Figure 5.22 Illustration of the microdiversity gain by soft handover.

298
CDMA
• A soft handover between two base stations is considered. It is modeled as a selection
combining of the short-term fading values in the UL assuming the same local mean
received signal level for both base stations (i.e. the optimum case).
• In DL direction, a maximum ratio combining of the signals transmitted by the two
base stations is assumed, where the restriction that only four paths can be combined
is observed. The difference of the local mean levels of both signals has been set to
0, 3 and 6 dB.
In Figure 5.22, the corresponding probability functions of the signal levels with and
without soft handover are compared; the case of no soft handover is represented by the
bold curves for the UL and DL, the difference (in decibels) of the local mean receive level
between the strongest and the other connection is indicated by the numbers in the diagram.
It should be noted that the received level is shown relative to the local mean level of the
strongest BS. If the local mean levels with respect to both base stations are the same, the
soft handover gain is about 2 dB for the UL and about 4–5 dB for the DL. If the level
difference is 6 dB, the DL gain reduces to about 1.5 dB. For the DL, it should be observed
that the gain is achieved by using twice the transmission power, that is, the original power
is transmitted by both base stations. Hence, from the point of view of power efﬁciency, the
DL soft handover curves have to be shifted by 3 dB to the left. Though BS transmission
power itself is not the most critical parameter, twice the transmission power also means that
the high DL gain for one connection can only be achieved at the expense of an increased
interference level for other connections.
For this reason and other reasons to be discussed below, a BS should only be involved
in a soft handover, if it contributes signiﬁcantly to the totally received power. To check
this condition, various algorithms are speciﬁed within the different CDMA systems. For
example, in UMTS, a BS is included in the active set of base stations for a soft handover,
only if its averaged received level exceeds RXLEV0 −HSHO, where RXLEV0 is the strongest
averaged received level and HSHO is a hysteresis parameter. Looking at Figure 5.22, a
hysteresis of about HSHO = 4–5 dB seems to be reasonable.
Besides the increased transmission and interference power, there are two other aspects
of soft handover causing additional effort:
• additional transmitter and receiver hardware within each BS;
• additional transmission lines between the base stations and the combining network
elements.
Also for limiting these costs, the number of base stations involved in a soft handover
should be kept small. To illustrate this soft handover effort, Figure 5.23 shows the fraction
of connections involved in a soft (or softer) handover and the mean number of active
base stations per connection as a function of the hysteresis HSHO. The results have been
obtained by Monte-Carlo simulations for a sectorized network using B = 30, B = 40 and
σ = 8 dB as propagation parameters. Though one connection in soft handover mode may
use even more than two base stations, the maximum number of used base stations has been
restricted to four. For HSHO = 5 dB, about 40–50% of the connections are involved in a
soft handover and each connection uses on average about 1.6–1.9 base stations.

CDMA
299
2
3
4
5
6
7
8
9
10
0
0.5
1
1.5
2
2.5
HSHO [dB]
B = 40 dB
B = 30 dB
Fraction of 
connections
in SHO mode 
Mean number of BSs
per connections
Figure 5.23 Soft handover probabilities as a function of the hysteresis margin.
Finally, it should be noted that a soft handover cannot be applied between cells using
different frequency carriers, for example, between the different layers of a hierarchical cell
structure. In these cases, a hard handover is required. While for a hard handover in TDMA
systems the MS can perform neighbor cell measurements in time slots not used for data
transmission or reception, a hard handover in a CDMA system requires some additional
effort for the MS; to be able to perform neighbor cell measurement, the MS has to be
equipped with an additional measurement receiver or a slotted transmission mode has to be
used. Slotted mode means that the data to be transmitted are compressed, for example, by
reducing the spreading factor or the channel coding rate for some period to obtain some time
for neighbor cell measurements. Obviously, during the slotted mode phases the connection
quality is reduced.
The summary of the discussion on soft handover is as follows:
• Soft handover is required in CDMA networks using a cluster 1 to control the intercell
interference caused by MSs near the cell border.
• On the other hand, using a cluster 1 and CDMA, soft handover can be implemented
in quite a simple way, for example, in DL direction it can be implemented using the
RAKE receiver within the MS.
• Compared to a hard handover, a gain of several decibels (depending on many pa-
rameters) is achieved for the UL as well as for the DL.
• The gain is achieved at the expense of additional costs for transmission lines and BS
transmitter and receiver hardware.

300
CDMA
• Soft handover is not only restricted to CDMA systems, but may also be applied
in other systems, where the MS is able to combine different propagation paths, for
example, by using an equalizer.
• Switching between cells with different frequency carriers, for example, in a hierarchi-
cal cell structure, a hard handover has to be used requiring additional effort compared
to a hard handover in TDMA systems.
More details on soft handover can be found, for example, in (Holma and Toskala 2001;
Viterbi 1995).
The potential of multiuser detection and interference cancellation
The idea behind multiuser detection is to detect and to demodulate not only the useful
signal, but also the interfering signals – at least some of the strongest ones. Having de-
tected the dominant interferers, their undesired contribution may be removed from the total
received signal using some sophisticated algorithms to obtain a less interfered signal. Since,
for applying this method, the signals of multiple users have to be detected, the correspond-
ing receiver structure is called a multiuser detector receiver. Some important multiuser
detectors and their application areas are discussed in detail in Section 5.3 and Section 5.4.
In this subsection, only some qualitative arguments concerning the potential of interference
cancellation are presented.
First of all, it should be noted that for efﬁciently cancelling the interference caused
by other connections the corresponding code signals have to be known and a connection
individual channel estimation has to be performed.
As discussed above, the intracell and intercell interference power in UL direction is
nearly the same for typical propagation parameters and a cluster 1 (or 1 × 1) network lay-
out. Hence, cancelling the intracell interference reduces the overall interference by about
a factor 2, which results in a doubling of network capacity. Since the BS knows all the
codes allocated to the active MSs in its cell, one prerequisite for performing a multiuser
detection is given. Furthermore, as explained in Section 5.5, connection-speciﬁc pilot sym-
bols accomplishing channel estimation are included within the UL physical channels of
modern CDMA systems like UMTS or cdma2000. Nevertheless, multiuser detection is a
hard challenge since there may be a large number of intracell interferers and all of these
contribute with nearly the same interference power due to power control, that is, there is
no dominant one.
The gain that can be achieved by cancelling the intracell interference in DL direction
depends on the environment where it is applied. As discussed above, in a low delay spread
environment the orthogonality of codes is preserved to a high degree. Hence, in this case
the contribution of intracell interference to the total interference power may be only about
10% or less, that is, the potential for intracell interference cancelling is low. However,
environments with a higher delay spread and higher degree of DL intracell interference also
exist. From the implementation point of view, it should be noted that the receiving MS needs
some information on the allocated codes within the cell, which has to be signaled by the BS
in DL direction. Since the data rates of the connections and therefore the code allocation
may change very rapidly, a high overhead would be required to transfer this information.
Using the tree structure of the OVSF codes, some proposals have been developed to reduce
this overhead (see e.g. (Bing et al. 2000)).

CDMA
301
A further gain can be achieved if not only the intracell interference, but also the intercell
interference is cancelled. However, this would further increase the receiver complexity.
Furthermore, information concerning the code allocation has to exchanged between cells.
Combining CDMA and TDMA
Combining CDMA with TDMA means that each radio carrier is divided into a certain
number of time slots and each of these time slots is further subdivided into a number of
code channels. Hence, the physical channel assigned to a connection is characterized by its
time slot and code number. It should be noted that this method leads to another arrangement
of physical channel, but not to an increase of the total number. For example, instead of
having 256 orthogonal code channels per carrier in a pure CDMA systems, these channels
may be rearranged into 16 time slots each separated into 16 code channels.
Though there is no difference with respect to the number of channels, there are mainly
three beneﬁts of combining CDMA and TDMA:
• Connections on different time slots do not interfere. Hence, intracell interference
is only generated by connections using the same time slot, that is, the number of
intracell interferers decreases. As a consequence, the effort for jointly detecting the
interfering signals and cancelling the interference may be signiﬁcantly reduced.
• Dynamic channel allocation can be applied in a cell with one frequency carrier, that is,
a connection affected by strong interference may be handed over to a less interfered
time slot.
• Because of the time slot structure, a TDD transmission mode can be implemented.
Time division duplex (TDD) means that UL and DL use the same frequency carrier
but different time slots. The TDD mode allows a ﬂexible division of transmission
capacity between UL and DL. Especially, if the network load is generated mainly
by highly asymmetric services like internet browsing, it is recommendable to assign
more time slots for the DL than for the UL.
Note that the TDD mode has also a drawback, at least when using nonsynchronized base
stations. Since there is no frequency separation between UL and DL, there may be situations
of severe interference between two base stations or between two MSs using adjacent carriers.
For FDD systems, this interference can be neglected because of the large frequency duplex
separation between UL and DL.
The method of combining CDMA and TDMA is applied within the TDD transmission
mode of UMTS (see Subsection 5.5.5), where a frequency carrier is divided into 15 time
slots. Within the TDD mode, a so-called joint detection algorithm is foreseen and may be
implemented with moderated effort. This method allows the joint detection of all signals
using one time slot and thereby reduces the intracell interference (see e.g. (Baier et al.
2000; Bing et al. 2000)).
Smart antenna techniques
Antenna systems that are able to automatically adapt their beam pattern or antenna char-
acteristics to the reception conditions are usually denoted as adaptive, intelligent or smart
antennas; throughout this section the name smart antennas is used.

302
CDMA
Beam forming is accomplished by an array of antenna elements affected by individual
complex weight factors or phase shifts. In general, these systems are applied at the BS, but
not at the MS side. Forming narrow beams, one may proﬁt in three different ways:
• The delay spread is reduced.
• The cell area may be increased due to an increase of the antenna gain.
• The SIR is improved since less interference is received in UL direction and less
interference is spread in DL direction.
With respect to the topic of this subsection, the third item is the most important one:
applying smart antenna techniques reduces the intracell as well as the intercell interference
and thereby enhances the capacity. In a certain sense, smart antennas may be seen as a
special approach for interference cancellation.
As to the implementation of smart antenna techniques one may distinguish the following
methods illustrated in Figure 5.24:
• switched beams
• full adaptive beams
The switched beams approach may be seen as an enhancement of sectorization discussed in
Subsection 5.1.2. Each cell – an omnicell or a sector cell – is divided into a certain number
of subsectors with angular width of typically 5–30◦. Hence, the antenna diagrams point
to several ﬁxed directions. An MS moving within such a cell is switched from beam to
beam in a similar manner as for a soft or softer handover. However, it should be noted
Switched beams
Sender/
Empfänger
Transmitter /
receiver
Channel 1
Selection (UL) /
splitting (DL)
Channel 2
Channel 3
MS0
MS0
TX
w1
RX
TX
w2
RX
TX
wN
RX
Base band signal processing
Beam forming
MSI
Full adaptive beams
Figure 5.24 Smart antenna techniques.

CDMA
303
that the subsectors are usually not handled as proper cells – they do not carry their own
identiﬁcation – but as parts of the corresponding cell. Hence, the soft handover is managed
internally by the BS and the MS is not aware of this.
Forming an antenna diagram electronically in a full adaptive way, the beam may follow
a moving MS to be served continuously. In this case, the BS equipment has to form
the diagram for each MS individually. This technique promises to reduce interference
not only by using narrow beams, but also by fading out the signal received from speciﬁc
directions, namely, the directions of the strongest interferers. Since the signal and especially
the interference level in UL and DL direction may differ signiﬁcantly, it is questionable
whether the additional gain of the full adaptive approach can be really achieved.
Considering the switched beams approach, measurements reported, for example, in (Mo-
gensen et al. 1999) show the following: if the BS antenna is mounted above the rooftop
level, by far the most signal energy is received within an angular interval of about 10–20◦
(depending on the antenna installation height) around the geometrical direction of the corre-
sponding MS. Hence, dividing a cell into subsectors of about this angular width, either the
best beam signal may be selected or the signals received via two beams may be combined
in UL direction. In DL direction, the signal is transmitted using the same beams as selected
for the UL.
To give a rough estimation of the potential of smart antenna techniques, one may say
that reducing the beam width of the used antennas by a factor 2, reduces the interference
power by a factor 2 and thereby increases the capacity by the same factor. More thorough
investigations for applying smart antenna techniques for UMTS presented in (Monogioudis
et al. 2004) conﬁrm this argument. Using a base station site with six instead of three sectors
increased the capacity by nearly 100%; applying even more sophisticated techniques, gain
values of more than 200% were presented.
Comparing smart antennas with antenna diversity techniques, smart antennas require
signals with a low angular spread and a coherent reception at all antenna elements, whereas
antenna diversity techniques have their beneﬁts in environments with a high angular spread
resulting in uncorrelated fading values at the different antenna positions.
Because of the high potential of smart antennas, prerequisites for these techniques (as
e.g. beam individual pilot channels) are foreseen in all modern CDMA systems.
More details on smart antenna techniques can be found, for example, in (Haardt and
Alexiou 2004; Holma and Toskala 2001; Hottinen et al. 2004; Mogensen et al. 1999;
Monogioudis et al. 2004).
Summary on interference handling in CDMA networks
In the following text, the discussion concerning the methods for handling interference in
CDMA mobile radio networks is summarized.
A variety of proﬁtable methods for achieving a performance gain and for simplifying
network planning can be implemented within CDMA systems in a very natural way, namely,
• fast power control,
• soft handover,
• a cluster 1 network and
• soft capacity planning.

304
CDMA
Fast UL
power control
Smart
antennas
Interference
cancellation
Combination
TDMA/CDMA
Intracell
interference
Fast
fading
Near–far
problem
Fast DL
power control
Cluster 1
Soft
handover
High intercell
interference
Fast
fading
Slow
fading
Requires
Reduces
Reduces
Requires
Requires
Reduces
Reduces
Requires and enables
Requires
Soft
capacity
Enables
C D MA
Causes
Reduce
Reduces
complexity
Requires for efficiency
Reduces
Options:
reduces
Requires
Causes
Nonorthogonality
of codes
Figure 5.25 Overview: Interference handling in CDMA networks.
On the one hand, these methods may be viewed as a big advantage of CDMA networks,
and on the other hand, it should be noted that these methods are required for CDMA
mobile radio networks in any case to give an acceptable network performance. As shown
in Figure 5.25, they are a direct or indirect consequence of intracell interference, that is,
a consequence of the nonorthogonality of codes caused by nonsynchronized transmitters
(mobile stations) and by multipath propagation.
While intercell interference and a widely varying received signal level due to the
near–far effect and due to long and short-term fading have to be taken into account in any
mobile radio network planning process, intracell interference represents a special challenge
for CDMA networks.
The mentioned methods remove the undesired effects of intracell interference to an
acceptable part and lead to some additional and signiﬁcant beneﬁts. Other methods like
interference cancellation or smart antenna techniques are an option for CDMA systems for
further increasing the network performance.
However, it should also be mentioned that all these methods require some additional
effort in terms of signaling load, system complexity and hardware effort. Furthermore,
their application is not restricted to only CDMA networks. To a certain degree, they may
be – and in fact are – applied also in TDMA-based networks.
5.2
CDMA Transmission Channel Models
5.2.1
Representation of CDMA signals
For the theoretical analysis of the receiver structures and the performance of CDMA
transmission, we need to introduce a suitable notation to describe the signals. As in the

CDMA
305
preceding chapters, we shall represent signals as vectors and look at them from a geometric
point of view wherever this is possible.
In contrast to the signals investigated in the preceding chapters, we now have to deal
with several users that share the same physical channel, that is, the same frequency band
at the same time slot. We thus will have to introduce an additional index that numbers the
user, and we have to deal with a signal in the air that is the superposition of the signals
corresponding to the different users. The K users that share the same physical channel
can be identiﬁed (and hopefully be separated at the receiver) because they use different
complex baseband transmit pulses, gk(t) (k = 1, . . . , K), that are called signature pulses or
signature waveforms. We normalize the pulses according to
∥gk∥2 =
 ∞
−∞
|gk(t)|2 dt = 1,
but, in general, we cannot assume that the signature pulses are orthogonal. We thus have a
nonzero correlation coefﬁcient
ρik = ⟨gi, gk⟩=
 ∞
−∞
g∗
i (t)gk(t) dt
between the signature pulses of two users indexed by i and k.
The special case where the signature pulses are orthogonal (i.e. where ρik = δik holds)
seems to be desirable, but, as discussed above, there are often reasons given, which make
nonorthogonal signature pulses a better choice. In Subsection 1.1.4, we discussed the or-
thogonal Walsh functions of length M as an example for a set of K = M orthogonal
signature pulses.
In that subsection, we have already introduced the notion of a chip. As done for the
Walsh functions, we write any set of (in general, nonorthogonal) signature pulses as a
superposition
gk(t) =
N

i=1
γikψi(t)
(5.9)
of chip pulses ψi(t). The chip pulses themselves are assumed to be an orthonormal base,
that is, we assume that
⟨ψi, ψk⟩=
 ∞
∞
ψ∗
i (t)ψk(t) dt = δik
holds. The coordinates
γik = ⟨ψi, gk⟩
of the user number k in Equation (5.9) may be grouped together to form the signature
vector
gk =


γ1k
...
γNk


of user number k. The signature vector characterizes the user. As mentioned above, PN
sequences are often used as signature vectors. However, as we have seen for the example

306
CDMA
of the orthogonal Walsh functions, other choices are possible too. Typically, in DS-CDMA
systems, the spreading sequence has a constant amplitude. For real valued sequences, due
to the normalization of the signature pulses, we have
γik = ± 1
√
N
.
However, complex γik are possible as well. All the K signature vectors together are grouped
to form a signature matrix
G =


γ11
· · ·
γ1K
...
...
...
γN1
· · ·
γNK

.
For DS-CDMA, the chip pulses are a Nyquist base as deﬁned in Subsection 1.1.3, that is,
ψi(t) = ψ(t −iTc)
is the delayed version of a pulse ψ(t) for which the convolved pulse ψ∗(−t) ∗ψ(t) sat-
isﬁes the well-known Nyquist condition for the chip period (or chip duration) Tc. The
symbol period is given by TS = NTc. As we have discussed in that subsection, the Nyquist
condition is just a special case of orthogonality. Figure 5.1 shows the situation for N = 8
and for the rectangular chip pulse
ψ(t) =
1
√Tc

 t
Tc
−1
2

.
For multicarrier (MC-) CDMA, the chip pulses are the base pulses of a multicarrier
transmission scheme as discussed in Section 4.1. For a given time slot (i.e. one OFDM
symbol in the terminology introduced there), the chip pulses are the frequency-shifted
version of one base pulse ψ(t) with Fourier transform (f ). In the frequency domain, the
chip pulses are given by
i(f ) = (f −fi).
The chip pulses in the time domain are then given by
ψi(t) = ej2πfitψ(t).
The subcarrier frequencies fi are normally assumed to be equally spaced. OFDM with
guard interval is the most important multicarrier scheme. As discussed in Subsection 4.1.4,
the symbols of length TS = T +  consist of a Fourier analysis window of length T and
a guard interval of length  (see Figure 4.8). The subcarrier frequencies are given by
fi = i
T .
We adopt the formalism from that subsection and deﬁne chip pulses by
ψi(t) =
1
√
T
exp (j2πfit) 
 t
T −1
2


CDMA
307
and the chip pulses with guard interval by
ψ′
i(t) =
1
√TS
exp (j2πfit) 
t + 
TS
−1
2

.
The transmitter uses pulses with guard interval, whereas the receiver uses pulses without
guard interval (see Figure 4.9). We have the orthogonality condition

ψi, ψ′
k

=
$
T
TS
δik,
that is, there is an energy loss given by T /TS, which is caused by the guard interval. For
MC-CDMA (multicarrier CDMA) with OFDM and guard interval, we may write
g′
k(t) =
N

i=1
γikψ′
i(t)
(5.10)
instead of Equation (5.9). However, to keep the notation uniﬁed and simple, we will keep
in mind the guard interval but we will not take it into account in the notation.
5.2.2
The discrete channel model for synchronous transmission
in a frequency-ﬂat channel
Until now, we only discuss K users that share one time slot. This is sufﬁcient if we can
assume ideal synchronous transmission for all users and we can neglect the time dispersion
of the channel, that is, the channel can be assumed to be frequency ﬂat over the signaling
bandwidth. This is of course a very ideal situation, but it is the simplest to analyze and
illustrates the basic properties of the most important receiver structures. We further assume
that the channel is approximately constant during the transmission of the signature pulses
during one time slot.
We note that we must exclude wideband DS-CDMA because, by deﬁnition, the corre-
sponding channel is time dispersive. For the same reason, we must also exclude wideband
MC-CDMA because the channel is frequency selective and different subcarriers are affected
by different fading amplitudes.
With the assumptions made above, we may work with a channel model in which the
receive signal is given by
r(t) =
K

k=1
ckskgk(t) + n(t).
(5.11)
Each user is affected by its own transmit channel represented by ck as the complex fading
amplitude corresponding to the channel of user number k. As done in the preceding chapters,
the complex transmit symbols are denoted by sk and n(t) is the complex baseband AWGN
with PSD N0. For BPSK modulation, which is utilized in many CDMA systems, we have
sk = ±√Eb, where Eb is the energy per bit.
To recover all available information at the receiver end, a base of detectors is necessary
to guarantee sufﬁcient statistics (see Subsection 1.4.1). Applying these results, we note that
the transmit space, that is, vector space spanned by the transmit base {gk(t)}K
k=1, must be

308
CDMA
a subspace of the receive space, that is, the vector space spanned by the detector pulses.
Obviously, the transmit base itself is a possible detector base. In that case, the detector
outputs are sampled outputs of matched ﬁlters or correlators and we may speak of a matched
ﬁlter base receiver. However, in general, the transmit base is not orthogonal. Sometimes
it is convenient to choose an orthogonal base of detector pulses. In that case, we speak of
the orthogonal detector base receiver.
A discrete model for the matched ﬁlter base
We ﬁrst discuss the matched ﬁlter base, which uses the (nonorthogonal) transmit base
{gk(t)}K
k=1 as detectors. The detector output for the kth user is given by
vk = Dgk[r] =
 ∞
−∞
g∗
k(t)r(t) dt.
We may write
vi =
K

k=1
ckskρik + mi,
where
mi = Dgi[n] =
 ∞
−∞
g∗
i (t)n(t) dt
is correlated Gaussian noise with covariance given by
E

mim∗
k

= N0ρik.
We may rewrite the discrete transmission channel in vector notation as
v = RCs + m,
(5.12)
where
R =


ρ11
· · ·
ρ1K
...
...
...
ρK1
· · ·
ρKK


is the correlation matrix of the signature vectors, and C = diag (c1, . . . , cK) is the channel
matrix. m = (m1, . . . , mN)T represents the vector of noise samples.
The problem in using the discrete matched ﬁlter model for the theoretical performance
analysis is that we have to deal with correlated noise m and thus the results obtained for
AWGN cannot be applied. The same problem occurs in the analysis of equalizer structures
where the channel matched ﬁlter introduces correlations into the noise. The solution in
equalizer theory is the whitening matched ﬁlter that decorrelates the noise. The same meth-
ods may be applied here. In our model, noise whitening means that we have to multiply
Equation (5.12) by an appropriate matrix so that the noise becomes white. However, this
can be avoided by using an orthogonal detection base for the theoretical analysis, no matter
what kind of base will be used in practice.

CDMA
309
A discrete model for the orthogonal detector base
As a base of orthogonal detectors we may use the chip base {ψi(t)}N
i=1. This is a very natural
base, and it is close to implementation. Because of Equation (5.9), the matched ﬁlter base
outputs can be obtained from the chip base outputs as described below. Other orthogonal
bases than the chip base are possible. For instance, the sinc base with an appropriate
sampling frequency is a possible choice for band-limited signals. Alternatively, one can
always obtain an orthogonal base by applying the Gram–Schmidt algorithm to the base
of signature pulses gk(t). If we have chosen an appropriate orthogonal detector base with
sufﬁcient statistics, we can express everything else in terms of this base. We thus emphasize
that the concept of an orthogonal detector base is a very useful tool for the theoretical
analysis even if another base may be implemented in practice.
We assume an orthogonal base of detector pulses {ψi(t)}N
i=1 that provides a set of
sufﬁcient statistics. To avoid the introduction of new symbols, we use the same notation as
for the chip base. The following treatment, however, applies to any orthonormal base. The
set of sufﬁcient statistics for the receive signal r(t) is given by the detector outputs
ri = Di[r] =
 ∞
−∞
ψ∗
i (t)r(t) dt
for all i = 1, . . . , N. Using Equations (5.9) and (5.11), we may write
ri =
K

k=1
ckskγik + ni
with
γik = Di[gk] = ⟨ψi, gk⟩=
 ∞
−∞
ψ∗
i (t)gk(t) dt
and
ni = Di[n] =
 ∞
−∞
ψ∗
i (t)n(t) dt.
We now rewrite the discrete transmission channel in vector notation as
r = GCs + n =
K

k=1
ckskgk + n,
(5.13)
where G = (g1, . . . , gK) is the matrix of signature vectors, C = diag(c1, . . . , cK) is the di-
agonal matrix of complex fading amplitudes and s = (s1, . . . , sK)T and n = (n1, . . . , nN)T
are the vectors of transmit symbols and noise samples, respectively.
We note that the matched ﬁlter detector outputs vk = Dgk[r] can easily be expressed by
the orthogonal detector outputs ri = Di[r]. By using
gk(t) =
N

i=1
γikψi(t)
(5.14)
with γik = ⟨ψi, gk⟩, we ﬁnd that
Dgk[r] =
N

i=1
γ ∗
ikDi[r]

310
CDMA
and thus
vk = g†
kr
or, in matrix notation,
v = G†r.
(5.15)
Similarly, we obtain
m = G†n.
(5.16)
Furthermore, we insert Equation (5.14) into
ρik = ⟨gi, gk⟩
and obtain
ρik =
N

i=1
γ ∗
jiγjk
or, in matrix notation,
R = G†G.
(5.17)
Equation (5.12) can be obtained from Equation (5.13) by multiplication with G† from the
left. Thus, there is a straightforward connection between the matched ﬁlter base and the
orthogonal detector representation.
In case we take the chip base as {ψi(t)}N
i=1, the above vector-algebraic treatment is
also of practical use. The above equations say that, for the matched ﬁlter receiver, we do
not need to implement a (analog) matched ﬁlter for each signature pulse. We only need
an (analog) ﬁlter that is matched to the chip pulse ψ(t) and sample it with the chip clock
period Tc to obtain the values for ri = Di[r]. We may then obtain the K matched ﬁlter
detector outputs vk = Dgk[r] by digital signal processing according to Equation (5.15).
For the theoretical analysis of the receivers, we may choose any orthonormal base
{ψi(t)}N
i=1 of sufﬁcient statistics. Especially, it may be convenient to choose the base in
such a way that
ψ1(t) = g1(t)
holds. For the geometrical visualization for two users, we then have a simple picture in the
two-dimensional plane (see the following text).
5.2.3
The discrete channel model for synchronous wideband
MC-CDMA transmission
In the preceding subsection, we assumed synchronous transmission and that the channel
is the same for every chip. This is not the case for wideband CDMA (WCDMA). For
wideband MC-CDMA, we may derive a synchronous channel model that is very similar to
the one derived in the preceding subsection. We note that user synchronization even in the
uplink is not such a severe problem for MC-CDMA. The time dispersion of the channel
is typically relatively small compared to the symbol duration TS. For OFDM, it will be
absorbed by the guard interval. The synchronization inaccuracy is allowed to be in the
order of the time dispersion of the channel, which typically is in the order of microseconds.
Thus, the synchronization requirements are not more severe than for GSM. We assume that

CDMA
311
the synchronization inaccuracy and the time dispersion are small (or absorbed by the guard
interval) so that we can write the received signal affected by multiplicative fading as
r(t) =
N

i=1
K

k=1
cikγikskψi(t) + n(t).
(5.18)
The complex fading amplitude for user k at frequency index i is given by cik. The orthogonal
base {ψi(t)}N
i=1 is the chip base, that is, the base corresponding to the subcarrier pulses.
As mentioned above, for simplicity, we do not take into account the guard interval in the
notation. In that case, we will have to use

ψ′
i(t)
N
i=1 at the transmitter and {ψi(t)}N
i=1 at the
receiver. The outputs corresponding to the orthogonal detector base {ψi(t)}N
i=1 are given
by the discrete transmission channel
ri =
K

k=1
cikγiksk + ni,
where ni is the complex discrete AWGN. For OFDM, ri is just the Fourier coefﬁcient at
frequency number i that has been obtained by the FFT analysis. We deﬁne the matrix
H =


γ11c11
· · ·
γ1Kc1K
...
...
...
γN1cN1
· · ·
γNKcNK

,
which is formally the Hadamard product (i.e. elementwise product)
H = G ◦C
between the signature matrix G and the matrix C of fading amplitudes.
We now rewrite the discrete transmission channel in vector notation as
r = Hs + n,
(5.19)
where s = (s1, . . . , sK)T and n = (n1, . . . , nN)T are the vectors of transmit symbols and
noise samples, respectively. This has formally the same structure as the vector channel
given by Equation (5.13) with the signature matrix G replaced by H and the matrix C of
fading amplitudes formally replaced by the identity matrix I. We note that in this vector
channel model, the fading amplitudes are now already included in the matrix H. The receiver
structures for this channel model can thus be derived quite like those that are derived for
the synchronous CDMA vector channel in the next section. The main difference is that the
column vectors gk of the matrix
G =
	
g1, . . . , gK

are normalized to length 1, while the column vectors hk of the matrix
H = [h1, . . . , hK]
are not.

312
CDMA
5.2.4
The discrete channel model for asynchronous wideband
CDMA transmission
We now consider the general case of K asynchronous users with signals to be transmitted
over K independent time-dispersive (i.e. frequency-selective) fading channels. This covers
the case of wideband DS-CDMA. For simplicity, we still ignore the time variance of the
channel. Let ck(τ) be the (time-invariant) impulse response of the channel for user number
k and gk(t) his signature waveform.
hk(t) = ck(t) ∗gk(t)
is then the signature waveform for user number k as it is seen at the receiver in a noise-
free and MAI-free channel. Note that the asynchronism is covered by the different channel
impulse responses. Let sk be the transmit symbol for user number k. For time slot zero, the
transmit signal is then given by
K

k=1
skhk(t),
where sk is the transmit symbol for user number k. Let l be the time index for the continuous
data stream, that is, user number k transmits the symbol skl by
sklgk(t −lTS)
at time slot number l. The noisy signal at the receiver is given by
r(t) =
K

k=1
L−1

l=0
sklhk(t −lTS) + n(t).
(5.20)
Here L is the number of time slots to be transmitted, for example, during one frame. It is not
really a restriction to assume that L is ﬁnite because, even in the absence of a frame struc-
ture, any transmission will start and stop at some time instant. We note that Equation (5.20)
stands for a very general setup with several asynchronous users transmitting over a time-
dispersive channel. We also note that two special cases are covered by this model:
1. Synchronous
nondispersive
transmission
as
discussed
above.
In
that
case,
hk(t) = ckgk(t) holds, and the only term in the second sum that needs to be considered
is that for l = 0 and we have to sum only over the user index k, that is,
r(t) =
K

k=1
skhk(t) + n(t),
(5.21)
which is the same as Equation (5.11).
2. Single-user transmission over a time-dispersive channel. In this case, the only term
in the ﬁrst sum is that for k = 1 and we may drop the index k. The pulse shape
of the whole channel (without noise) is h(t) = c(t) ∗g(t), where c(t) is the im-
pulse response of the channel and g(t) is the transmit pulse shape. We may assume
that g∗(−t) ∗g(t) fulﬁlls the Nyquist condition but this is not necessary, especially

CDMA
313
because the Nyquist condition is violated when the channel impulse response is
included. We write hl(t) = h(t −lTS) and get the channel model
r(t) =
L−1

l=0
slhl(t) + n(t).
(5.22)
Receivers for such a transmission setup are known as equalizers. Equalizer structures
are treated exhaustively in the literature (see e.g. (Benedetto and Biglieri 1999; Kam-
meyer 2004; Proakis 2001)). There are optimal equalizers like the MLSE receiver,
suboptimal linear equalizers like the zero-forcing equalizer (ZFE) and the minimum
mean square error (MMSE) equalizer, and suboptimal nonlinear equalizers like the
decision feedback equalizer (DFE).
We note that Equation (5.21) and (5.22) are formally the same. The only difference is the
interpretation of the index, which is a user index in the ﬁrst case and a time index in the
second case. Thus, it will not be surprising that the well-known equalizer structures ﬁnd
their correspondence in the theory of multiuser detection.
To avoid summation over two indices (which makes the treatment quite cumbersome),
we introduce the multiindex j = (k, l). We may as well regard j as a one-dimensional
index that we obtain by writing the double-indexed quantities skl and hk(t −lTS) in a
matrix and read them out column-wise. Then j ∈{1, 2, . . . , KL} will be the index of the
vector obtained that way, that is, write
j = lK + k
and
sj = skl,
hj = hk(t −lTS).
We may now rewrite Equation (5.20) as
r(t) =
J

j=1
sjhj(t) + n(t)
(5.23)
with
J = KL.
We may introduce a discrete model by utilizing detector outputs of sufﬁcient statistics for
that signal. Again, we may alternatively use a matched ﬁlter base or an orthonormal base.
As shown above, the detector outputs for the matched ﬁlter base can be obtained from
those of an orthonormal base. We thus start with the orthonormal base.
Let
{φi(t)}N
i=1
be an orthonormal base for the vector space spanned by the nonorthogonal base of the
pulses hj(t). We note that, because of the time dispersion of the channel, this vector space
will in general be larger than the vector space spanned by the vectors gk(t −lTS). For a
complex baseband signal with a band-limited spectrum between −B/2 and B/2, we may
choose the sinc base
φi(t) = B sinc (Bt −i)

314
CDMA
as deﬁned in Subsection 1.1.2. We deﬁne the detector outputs of the orthogonal base as
ri = Dφi[r]
and obtain
ri =
J

j=1
hijsj + nj,
where
hij = ⟨φi, hj⟩
deﬁnes the coordinate matrix H of the pulse vectors hj(t) corresponding to the base
{φi(t)}N
i=1. We may write this in compact matrix notation as
r = Hs + n.
(5.24)
Obviously, this is formally the same structure as obtained for the synchronous MC-CDMA
model in the preceding subsection, but the interpretation is different. However, this formal
similarity simpliﬁes the derivation of receiver structures.
The representation in the matched ﬁlter base will be obtained as the output correspond-
ing to the detector base

hj(t)
J
j=1of the signal r(t) in Equation (5.23). Note that hj(t)
corresponds to the column vector hj in the matrix
H = [h1, . . . , hJ] .
Thus, in the discrete model, this detection by hj(t) corresponds to multiplying Equation
(5.24) by h† from the left, that is, the detector output corresponding to hj(t) is given by
vj = h†
jr. Thus, the vector of matched ﬁlter outputs v = (v1, . . . , vJ)T is given by
v = Rs + m,
where
R = H†H
is the autocorrelation matrix with components
(R)ij =

hi, hj

= h†
i hj,
and m is the complex colored Gaussian noise with autocorrelation matrix given by
E

mm†
= N0R.
The autocorrelation matrix has the following block structure:
R =


R[0]
R†[1]
R†[2]
· · ·
R[1]
R[0]
R†[1]
R†[2]
· · ·
R[2]
R[1]
R[0]
R†[1]
R†[2]
· · ·
...
R[2]
R[1]
R[0]
R†[1]
...
...
R[2]
R[1]
R[0]
...
...
...
...
...


,
(5.25)

CDMA
315
with K × K submatrices R[l] = R†[−l] that have elements ρik[l] = (R[l])ik given by
ρik[l] =

h∗
i (t −lTS)hk(t) dt.
We have seen that the receiver structures for all the three models can be treated using
the same formalism. The channel is always given by a matrix multiplication applied to the
vector s of the transmit symbols. However, the interpretation of that matrix GC or H or
R is quite different. Therefore, we prefer to split up the analysis of the receiver structures
for the different models. First, because it is the simplest, we analyze the receiver structures
for the synchronous model. For the other models, the derivation of receiver structures is
formally the same, even though the interpretation is different.
5.3
Receiver Structures for Synchronous Transmission
The simplest receiver for CDMA systems is one that is matched to the user under con-
sideration, regarding the other users as additive noise-like interference. This is called a
single-user matched ﬁlter (SUMF) receiver. It has no other detectors except for that single
user. This is the traditional CDMA receiver. The common argument why one can proceed
this way is that the spreading sequences have good correlation properties. As a conse-
quence, the signal of all other users can be regarded as approximately orthogonal to the
signal under consideration and may thus be ignored. The residual interference term that is
due to nonorthogonality is assumed to be small. If the number of the other users is high
enough, due to the central limit theorem, this interference has Gaussian statistics and may
be treated as Gaussian noise.
It is evident that the SUMF receiver cannot be optimal. Because the signals are not
exactly orthogonal, any information about other users may improve the performance. More-
over, severe problems occur in the uplink if the receive power of the (distant) user under
consideration is signiﬁcantly below the power of another (nearby) user. This is known as
the near–far problem that we discussed in Subsection 5.1.4.
In contrast to the SUMF receiver, a multiuser detection (MUD) receiver has detectors
for (some or all) other users. It takes into account information about their signature wave-
forms and about the corresponding fading coefﬁcients. In the preceding chapters, several
general receiver structures have been derived for optimal bit decisions (the bitwise MAP
receiver, see Subsection 3.1.5) and for optimal decisions about sequences (the MLSE re-
ceiver, see Subsection 1.4.2 and Subsection 2.4.1). These results can be applied to CDMA
systems. However, the optimal receiver structures are often too complex to be applied in
practice. Therefore, suboptimal (linear) MUD receivers as the decorrelating receiver and
the minimum mean square error (MMSE) receiver are of high practical relevance.
In the following subsections, we will discuss and compare these various CDMA receiver
structures. To make the ideas more clear, we start with the synchronous channel model.
Moreover, we will explain the ideas in the example with a two-user scenario. This is
because it is possible to visualize this case by using vectors in a two-dimensional plane,
which makes the understanding much easier. The mathematical generalization to more users
is then often straightforward.

316
CDMA
5.3.1
The single-user matched ﬁlter receiver
We consider K users in a fading channel and a receiver that is matched to one user, that is,
we treat the optimum receiver for a single user. The receiver is matched to the signature
waveform (transmit pulse) g1(t) of this user number one and makes use of the corresponding
complex fading amplitude c1. The transmit pulses gk(t) and fading amplitudes ck of the
other users (k > 1) are unknown to the receiver. The receive signal in the synchronous
channel model is given by Equation (5.11). We split up the receive signal into three terms
r(t) = c1s1g1(t) +
K

k=2
ckskgk(t) + n(t),
where the ﬁrst term represents the desired signal component, the second one comprises
K −1 interfering users, and the third one describes AWGN.
The SUMF detector output for user number one,
r1 = Dg1[r] =
 ∞
−∞
g∗
1(t)r(t) dt,
is given by
r1 = c1s1 +
K

k=2
ckskρ1k + n1
(5.26)
with ρ1k = ⟨g1, gk⟩. The sum in this expression is the multiple access interference (MAI)
caused by the other users. The noise term
n1 = Dg1[n] =
 ∞
−∞
g∗
1(t)n(t) dt
is a complex Gaussian random variable with zero mean and variance
E
|n1|2
= N0.
For the geometric visualization, it is helpful to look at the situation in a ﬁnite-dimensional
vector space and use the discrete channel model given by Equation (5.13). We choose the
corresponding orthonormal base {ψi(t)}N
i=1 in such a way that ψ1(t) = g1(t) to get the
notation consistent with the above formulas. We rewrite Equation (5.13) as
r = c1s1g1 +
K

k=2
ckskgk + n.
We note that we get back to Equation (5.26) if we multiply this from the left by g†
1. We
further note that
g1 =


1
0
...
0

.

CDMA
317
00
11
01
10
g1
g2
Threshold 2
Threshold 1
r
r1
Figure 5.26 Two-user BPSK SUMF receiver for equal fading amplitudes and ρ12 = 0.6.
One can visualize the scenario in the two-dimensional plane for K = 2 and N = 2, real
positive fading amplitudes and BPSK transmission. Figure 5.26 shows the situation for
g1 =
 1
0

, g2 = 1
5
 3
4

corresponding to ρ12 = 0.6 and equal fading amplitudes c1 = c2 = 1. The four possible
transmit signal vectors are given by
s00 = +g1 + g2,
s01 = +g1 −g2,
s10 = −g1 + g2,
and
s11 = −g1 −g2.
Here sb1b2 is the transmit signal if user 1 transmits the bit b1 and user 2 transmits the
bit b2. For simplicity, we have assumed ES = 1 in this constellation example. The ﬁgure
looks like a skew QPSK constellation with the square replaced by a parallelogram. The
two-dimensional receive vector is given by
r = s1g1 + s2g2 + n,
where n is the two-dimensional real AWGN. The SUMF output is given by the scalar
product
r1 = g1 · r
and can be interpreted as the orthogonal projection of the vector r on the vector g1. The
receiver makes a decision based on the sign of that projection, that is, there is a decision

318
CDMA
threshold for user 1 which is orthogonal to g1 that separates the left and the right half plane.
The decision threshold for user 2 is also drawn in the ﬁgure.
To illustrate the near–far problem, we consider the same signature vectors g1 and g2,
but we assume that the fading amplitudes are given by c1 = 1 and c2 = 2. The receive
vector is now given by
r = s1g1 + 2s2g2 + n.
This situation is depicted in Figure 5.27. It is obvious from this ﬁgure that the bit value of
user 2 completely dominates the bit decision for user 1. Only if both bits have the same
value, the SUMF for user 1 will make a correct decision in a noise-free channel. Thus,
for equal probable bits in the noise-free channel, the bit error rate will equal the constant
value 1/2.
From this ﬁgure, one easily concludes that correct SUMF decisions for user 1 are only
possible if the projection of c2g2 on g1 is smaller than the length of c1g1. Here, we have
assumed that everything is real. For the general case we note that the BPSK decision for
user 1 is based on the sign of
ℜ

c∗
1r1

= ℜ
|c1|2 s1 + c∗
1c2ρ12s2 + c∗
1n1

.
From this equation, we conclude that correct SUMF decisions for user 1 are only possible if
))ℜ

c∗
1c2ρ12
)) < |c1|2
(5.27)
r
r1
00
10
01
11
Threshold 1
c2g2
c1g1
Threshold 2
Figure 5.27 Two-user BPSK SUMF receiver for unequal fading amplitudes and ρ12 = 0.6.

CDMA
319
holds. For the general case of K users, we have the condition
K

k=2
))ℜ

c∗
1ckρ1k
)) < |c1|2 .
(5.28)
Gaussian channel performance
We consider again two users and BPSK transmission. We assume that the condition of
Equation (5.27) for possible correct SUMF receiver decisions is fulﬁlled. We assume ﬁxed
fading amplitudes so that we have an AWGN channel. From the geometrical constellation of
Figure 5.26, we easily conclude how the bit error probability for user 1 can be obtained. We
have to calculate the probability that user 1 has transmitted the bit b1 = 0 but the receiver
decides for b1 = 1. In Figure 5.26, this is the case if one of the constellation points in the
right half plane is transmitted but the receive signal is in the left half plane. We denote
the distance of the point corresponding to the bit pair 00 to the threshold by 0 and the
distance corresponding to 01 by 1. Assuming that both points are equal probables, the bit
error probability for user 1 is then given by
Pb = 1
2

Q
0
σ

+ Q
1
σ

with σ 2 = N0/2. A simple upper bound is given by
Pb ≤Q

σ

(5.29)
with  = min(0, 1). Using geometrical arguments one can easily check that distances
are given by
0,1 =

Eb

|c1| ±
1
|c1|ℜ

c∗
1c2ρ12

(see Problem 1). Thus we have
 =

Eb

|c1| −
1
|c1|
))ℜ

c∗
1c2ρ12
))

and
Pb ≤1
2erfc


$
|c1| −
1
|c1|
))ℜ

c∗
1c2ρ12
))
2 Eb
N0

.
(5.30)
For the general case with K users, Equation (5.29) holds with
 =

Eb
#
|c1| −
1
|c1|
K

k=2
))ℜ

c∗
1ckρ1k
))
%
,
that is,
Pb ≤1
2erfc


0
1
1
1
2
#
|c1| −
1
|c1|
K

k=2
))ℜ

c∗
1ckρ1k
))
%2
Eb
N0

.
(5.31)

320
CDMA
Rayleigh channel performance
We consider a SUMF receiver and K users in a Rayleigh fading channel with BPSK
transmission. The complex baseband receive signal is given by
r(t) =
K

k=1
ckskgk(t) + n(t).
In that equation, sk = ±√Eb denotes the BPSK symbols, and n(t) is the complex baseband
AWGN with power density N0. In a Rayleigh fading channel, the fading amplitudes ck are
complex Gaussian random variables with variances
E
|ck|2
= α2
k
and statistically independent real and imaginary parts (see Subsection 2.2.5). The power
transfer of the user under consideration is normalized to α2
1 = 1, and the fading of different
users is assumed to be independent. The SUMF detector output according to Equation
(5.26) is given by
r1 = c1s1 +
K

k=2
ckskρ1k + n1.
The ﬁrst term corresponds to the useful signal, the second term is the multiple access
interference (MAI). Because each ck is a Gaussian random variable, the MAI term has
Gaussian statistics, and it can be treated as an additional noise term. We therefore expect that
the bit error rates are the same as in a Rayleigh fading channel, but with a noise enhancement
that is caused by MAI. In the following discussion, we will formally substantiate this
heuristic argument.
An independent multiplicative random sign does not change the statistics of a Gaus-
sian random variable. Thus, each of the K −1 MUI terms ckskρ1k (k > 1) is a complex
mean zero Gaussian random variable with variance σ 2
k = α2
k |ρ1k|2 Eb. We may thus rewrite
Equation (5.26) as
r1 = c1s1 + nc,
(5.32)
where nc is the complex one-dimensional AWGN with variance
σ 2 = N0 + Eb
K

k=2
α2
k |ρ1k|2 .
Equation (5.32) describes BPSK in a Rayleigh fading channel with enhanced noise. The bit
error rate has been derived in Subsection 2.4.3. In that subsection, we have obtained the
formula
Pb = 1
2

1 −
0
1
1
2
Eb
N0
1 + Eb
N0


for the bit error rate. We replace N0 by σ 2 and get the expression
Pb = 1
2
8
1 −
$
Eb
Eb + N0 + Eb
3K
k=2 α2
k |ρ1k|2
9
.

CDMA
321
Obviously, the MAI disturbs the signal like an additional Gaussian noise source. Thus, the
system performance will be severely degraded unless the MAI variance σ 2 is signiﬁcantly
below Eb. An interferer close to the receiver will thus severely disturb the reception of a
distant user, which is known as the near–far problem.
We ﬁnally note that the above treatment can also cover the case of asynchronous trans-
mission because the synchronous model may be regarded as a worst case. For rectangular
transmission pulses, this can easily be proven (see Problem 2). Heuristically, one should
expect the same behavior also for other pulse shapes.
5.3.2
Optimal receiver structures
In this subsection, we study receiver structures that are optimal in a certain sense. The
maximum likelihood sequence estimation (MLSE) receiver is jointly optimum for estimating
the most probable sequence of transmit symbol estimation for all users together. The
bitwise maximum a posteriori (MAP) receiver is optimum for estimating the most probable
individual bit transmitted by one user, thereby taking into account the available information
about all other users. Both types of receivers have already been derived and discussed in
some detail in preceding chapters (Chapters 1, 2, and 3). Here, we have only another
interpretation for the same formalism. As discussed in these chapters, both receivers may
lead to different bit decisions. However, this is a very rare event except when Eb/N0 is
extremely small.
Let us consider the discrete-time model for the synchronous channel corresponding to a
base {ψi(t)}N
i=1 of orthonormal detectors. The vector r = (r1, . . . , rN)T of detector outputs
is given by
r = GCs + n.
(5.33)
Here, G = (g1, . . . , gK) is the matrix of signature vectors, C = diag(c1, . . . , cK) is the di-
agonal matrix of complex fading amplitudes and s = (s1, . . . , sK)T and n = (n1, . . . , nN)T
are the vectors of transmit symbols and noise samples, respectively.
The maximum likelihood receiver
The MLSE receiver for a discrete-time fading channel has already been discussed in detail
in Subsection 2.4.1. Comparing Equations (2.27) and (5.33), we note that the only formal
difference is that we formally have to replace Cs in
r = Cs + n
by GCs. The interpretation, however, is different. In Subsection 2.4.1, we treated a single
user, and we wanted to estimate the sequence of transmit symbols for all K time slots.
Here we have K users, and we want to estimate the sequence of transmit symbols for all
users corresponding to one time slot. Keeping this in mind, we may now adopt the results
of that subsection and ﬁnd that the most likely vector of transmit symbols is given by
ˆs = arg min
s
∥r −GCs∥2
(5.34)
(see Equation (2.28)). Instead of Equation (2.30), we now have
ˆs = arg max
s

ℜ

s†C†G†r

−1
2 ∥GCs∥2

.
(5.35)

322
CDMA
Using Equations (5.15) and (5.17), we may write this as
ˆs = arg max
s

ℜ

s†C†v

−1
2s†Ks

,
(5.36)
where we have deﬁned
K = C†RC.
We note that the ﬁrst term in Equation (5.36) is a cross correlation. C†v is the matched
ﬁlter output vector v with the components vi back rotated in phase and weighted with the
fading channel amplitude. This has to be correlated with all possible transmit sequences s.
Again, we can visualize the scenario in the two-dimensional plane for K = 2, real
positive fading amplitudes and BPSK transmission. Figure 5.28 shows the situation for
g1 =
 1
0

, g2 = 1
5
 3
4

and equal fading amplitudes c1 = c2 = 1. The receiver decides for the transmit vector
sb1b2 ∈

±c1
√Eb g1 ± c2
√Eb g2

, which has the smallest distance to the receive vector r.
This condition divides the two-dimensional plane into four regions corresponding to four
possible decisions for the two-user bit pair (b1b2). The regions are separated by pieces of
straight lines that have equal distances to two closest possible transmit vectors. Comparing
Figure 5.28 with Figure 5.26, we observe that there are large regions where the decisions
00
11
01
10
g1
g2
Region 1
Region 2
Region 3
Region 4
Figure 5.28 Two-user BPSK MLSE receiver for equal fading amplitudes.

CDMA
323
for user 1 differ. For example, the receive vector
r = 1
5
 1
4

,
the SUMF receiver will decide for b1 = 0, but the MLSE receiver will decide for the
transmit vector s10 and thus for b1 = 1.
To illustrate the resistance of the MLSE receiver against the near–far problem, we
consider the same signature vectors g1 and g2, but we assume that the fading amplitudes
are given by c1 = 1 and c2 = 2. The receive vector is now given by
r = s1g1 + 2s2g2 + n.
This situation is depicted in Figure 5.29. It is obvious from the ﬁgure that correct decisions
will be made for user 1 as long as the noise does not exceed the distance to the decision
threshold, which is the piecewise linear curve that separates the union of Region 1 and
Region 4 from the union of Region 2 and Region 3.
Now, we evaluate the error probability for user 1. Assume that user 1 transmits b1 = 0,
that is, one of the transmit vectors s00 or s01. An error occurs if the receive vector r lies in
00
10
01
11
c1g1
c2g2
Region 1
Region 2
Region 3
Region 4
Figure 5.29 Two-user BPSK MLSE receiver for unequal fading amplitudes.

324
CDMA
Region 2 or Region 3. First of all, we calculate the four distances between s0b2 and s1b2 as
∥s00 −s10∥2 = 4Eb |c1|2 ,
∥s00 −s11∥2 = 4Eb
|c1|2 + |c2|2 + 2ℜ

c∗
1c2ρ12

,
∥s01 −s10∥2 = 4Eb
|c1|2 + |c2|2 −2ℜ

c∗
1c2ρ12

,
∥s01 −s11∥2 = 4Eb |c1|2 .
For our analysis, we assume that
∥s00 −s11∥2 > ∥s01 −s10∥2 ,
that is,
ℜ

c∗
1c2ρ12

> 0.
This is consistent with the situation in Figure 5.28 and Figure 5.29. Otherwise, the treatment
is similar. For ρ12 = 0, the SUMF is already optimal.
We recall that the pairwise error probabilities are given by
P

sb1b2 →sˆb1 ˆb2

= Q
 1
2σ
&&&sb1b2 −sˆb1 ˆb2
&&&

.
We now assume that s00 is the transmit signal. Because Region 2 and Region 3 are com-
pletely contained in the half plane left from the decision threshold between s00 and s10, the
error probability is upper bounded by the pairwise error probability P (s00 →s10). We then
assume that s01 is the transmit signal. The probability that r lies in Region 2 or Region 3
can be upper bounded by P (s01 →s11) + P (s01 →s10). The bit error probability is then
bounded by
Pb ≤1
2P (s00 →s10) + 1
2 (P (s01 →s11) + P (s01 →s10)) .
Using P (s00 →s10) = P (s01 →s11), we get
Pb ≤Q
 1
2σ ∥s00 −s10∥

+ 1
2Q
 1
2σ ∥s01 −s10∥

.
We may express this as
Pb ≤1
2erfc
#$
|c1|2 Eb
N0
%
+ 1
4erfc
#$
|c1|2 + |c2|2 −2ℜ

c∗
1c2ρ12
 Eb
N0
%
.
(5.37)
For
ℜ

c∗
1c2ρ12

< 0,
the derivation is similar and we get another sign under the square root for the second term.
Thus, both cases are covered by
Pb ≤1
2erfc
#$
|c1|2 Eb
N0
%
+ 1
4erfc
#$
|c1|2 + |c2|2 −
))2ℜ

c∗
1c2ρ12
)) Eb
N0
%
.
(5.38)

CDMA
325
To illustrate the performance gain of the MLSE receiver compared to the SUMF re-
ceiver, we have evaluated this expression for
g1 =
 1
0

, g2 = 1
5
 3
4

and equal fading amplitudes c1 = c2 = 1, that is, the situation of Figure 5.28. Figure 5.30
shows the bit error rate for the MLSE receiver according to the above formulas compared
with the bit error rate for the MLSE receiver according to Equation (5.30) and ideal (single-
user) BPSK. The SUMF receiver shows a severe degradation compared to the ideal BPSK
(approximately 8 dB at 10−5), while the MLSE receiver shows only a loss of approximately
1 dB. For the same signature vectors and c2 = 2c1, the performance curves are depicted
in Figure 5.31. Surprisingly, the higher interference power of user 2 leads to a better
performance for user 1 which even approaches the BPSK curve. This can be explained by
the fact that for a joint detection receiver, user 2 must not be regarded as an interferer. In fact,
user 2 helps user 1 by increasing the relevant distances. To explain this, we note that the ﬁrst
term in Equation (5.37) corresponding to the distances ∥s00 −s10∥and ∥s01 −s11∥equals
the BPSK performance curve. The second term corresponds to the distance ∥s01 −s10∥.
Looking at Figure 5.29, we observe that the distance ∥s01 −s10∥now is smaller than the
other distances and thus the second term can be neglected for high values of Eb/N0. This
is in contrast to the situation in Figure 5.28 where that term dominates the performance
curve.
0
2
4
6
8
10
12
14
16
18
10
−4
10
−3
10
−2
10
−1
10
0
Eb/N0 [dB]
Pb
SUMF
MLSE
SU BPSK
Figure 5.30
The performance of the MLSE receiver compared with the SUMF receiver
and ideal single-user (SU) BPSK for equal real fading amplitudes and ρ12 = 0.6.

326
CDMA
0
2
4
6
8
10
12
14
16
18
10
−4
10
−3
10
−2
10
−1
10
0
Eb/N0 [dB]
Pb
MLSE
BPSK
Figure 5.31
The performance of the MLSE receiver compared with ideal (single-user)
BPSK for unequal real fading amplitudes and ρ12 = 0.6.
The bitwise MAP receiver
The bitwise MAP receiver is derived and discussed in Subsection 3.1.5. Given a receive
vector r, it provides us with the log-likelihood ratio (LLR) L(bk = 0|r) of one individual
bit in the transmit sequence. As discussed in that subsection, the sign of L(bk = 0|r) gives
the hard bit decision (bk = 0 for positive LLR, bk = 1 otherwise). The absolute value
is a measure for the reliability. Consider the bit b1 corresponding to user 1. We do not
necessarily need to assume BPSK, so other bits of user 1 can be transmitted during the
same time slot. Let us denote the set of all transmit symbol vectors s with b1 = 0 by S0
and the set of all transmit symbol vectors s with b1 = 1 by S1. If all vectors s have equal a
priori probability, the LLR value for b1 can be obtained by the method of that subsection as
L(b1 = 0|r) = log


3
s∈S0 exp

−1
2σ 2 ∥r −GCs∥2
3
s∈S1 exp

−1
2σ 2 ∥r −GCs∥2

.
(5.39)
In this expression, σ 2 = N0/2 is the noise variance per real dimension. The expression for
the LLR can equivalently be written as
L(b1 = 0|r) = log


3
s∈S0 exp

1
σ 2

ℜ

s†C†v

−1
2s†Ks

3
s∈S1 exp

1
σ 2

ℜ

s†C†v

−1
2s†Ks


.
(5.40)

CDMA
327
For K = 2 and BPSK transmission, this expression can be evaluated further. We have
K =

|c1|2
c∗
1c2ρ12
c1c∗
2ρ21
|c2|2

,
and thus
s†Ks =

Eb
|c1|2 + |c2|2
+ 2s1s2ℜ

c∗
1c2ρ12

.
Furthermore,
s†C†v = s1c∗
1v1 + s2c∗
2v2.
We insert this into the exponential expressions in Equation (5.40) and get
L(b1 = 0|r) = log


e
1
σ2 ℜ{c∗
1v1} cosh

1
σ 2 ℜ

c∗
2v2 −c∗
1c2ρ12

e−1
σ2 ℜ{c∗
1v1} cosh

1
σ 2 ℜ

c∗
2v2 + c∗
1c2ρ12


,
and, ﬁnally,
L(b1 = 0|r) = 2
σ 2 ℜ

c∗
1v1

+ log


cosh

1
σ 2 ℜ

c∗
2v2 −c∗
1c2ρ12

cosh

1
σ 2 ℜ

c∗
2v2 + c∗
1c2ρ12


.
Figure 5.32 depicts this quantity as a contour plot for the curves of equal LLR with the
parameters of Figure 5.28 and Eb/N0 = 6 dB. The bold curve corresponds to LLR = 0 and
has to be interpreted as the smooth threshold that separates the union of Regions 1 and 4
−2
−1.5
−1
−0.5
0
0.5
1
1.5
2
−1.5
−1
−0.5
0
0.5
1
1.5
r1
r2
00
10
01
11
Figure 5.32 Smooth threshold for the MAP receiver (Eb/N0 = 6 dB).

328
CDMA
from the union of Regions 2 and 3. For high values of Eb/N0, it comes closer and closer
to the piecewise linear MLSE threshold depicted in Figure 5.28.
We note that for sufﬁciently high values of Eb/N0, the maxlog MAP becomes a very
good approximation (see Subsection 3.5.1). We then have the approximate expression for
the LLR
L(bk = 0|r) ≈
1
2σ 2

min
s∈S1
∥r −GCs∥2 −min
s∈S0
∥r −GCs∥2

.
This approximate expression leads to the same hard decisions as the MLSE receiver. How-
ever, it provides us with reliability information that can be used by an outer decoder.
5.3.3
Suboptimal linear receiver structures
The complexity of the optimal receivers discussed above grows exponentially with the
number of users. In this subsection, we will discuss suboptimal linear receiver structures
with a complexity that grows only linearly with the number of users.
The decorrelating receiver
As discussed above, the SUMF receiver suffers from the near–far problem. In the presence
of strong interferers, the receiver may produce erroneous bit decisions even in a noise-free
channel.
We now derive a linear receiver that always perfectly recovers the information in the
absence of noise. In that case, the synchronous discrete model receive signal is given by
r =
K

k=1
ckskgk.
Here gk is the signature vector for user number k, and sk and ck are the corresponding
transmit symbol and complex fading amplitude, respectively. We deﬁne
uk = cksk
and write
r =
K

k=1
ukgk.
In that equation, the values uk can be interpreted as the coordinates of the vector r cor-
responding to the base of the signature vectors gk. We recall that the coordinates of any
vector that lies in the hyperplane spanned by that base are uniquely deﬁned. Therefore, if
n is a noise vector that lies in the hyperplane spanned by the base of signature vectors gk,
the coordinates xk of the vector
r =
K

k=1
ukgk + n
are uniquely deﬁned by
r =
K

k=1
xkgk.

CDMA
329
g2
f2
f1
x1
00
10
01
r
g1
x2
Figure 5.33 Two-user decorrelating receiver.
These coordinates xk will serve as estimates for the coordinates uk of the transmit signal.
For the moment, we have assumed that the vector r lies in the hyperplane spanned by the
base of signature vectors gk. We will later see that we can remove this restriction.
The calculation of the coordinates is standard linear algebra. Before doing this, how-
ever, we want to illustrate the geometrical structure for the case of two users, real fading
amplitudes and BPSK transmission. This situation is depicted in Figure 5.33. The receive
vector is a vector sum
r = x1g1 + x2g2,
which can geometrically be visualized by the diagonal of the parallelogram spanned by
the vectors x1g1 and x2g2. The coordinates x1 and x2 can be interpreted as the lengths
of the edges of the parallelogram (note that ∥g1∥= ∥g2∥= 1). They can geometrically be
obtained as the skew projections (Eldar 2002) on the base: x1 is the projection of r on g1
along the direction of g2, and x2 is the projection of r on g2 along the direction of g1. To
express the skew projections by orthogonal projections by means of scalar products, we

330
CDMA
introduce vectors f1 and f2 in the plane with the property
fi · gk = δik, i, k ∈{1, 2} ,
that is, f1⊥g2 and f2⊥g1. Now r and x1g1 have the same projection on the direction of f1,
and r and x2g2 have the same projection on the direction of f2. The ﬁrst fact means that
|f1|−1 f1 · r = |f1|−1 f1 · (x1g1),
which leads to
x1 = f1 · r.
Similarly, we obtain
x2 = f2 · r.
We now generalize to the case that r does not lie in the plane spanned by g1 and g2 or,
equivalently, by f1 and f2. The vector r can then be uniquely decomposed according to
r = r♦+ r⊥,
where r♦lies in the plane and r⊥is orthogonal to that plane. Thus, fk · r⊥= 0 and
xk = fk · r = fk · r♦
are the correct expressions for the coordinates of the orthogonal projection r♦of r onto the
plane.
We formalize the above treatment for K users. Let V = span(g1, . . . , gK) be the vector
space (hyperplane) spanned by the base of signature vectors {gk}K
k=1. There exists a uniquely
deﬁned base {fk}K
k=1 called the reciprocal base with the property
f†
i gk = δik, i, k ∈{1, . . . , K} .
As depicted in Figure 5.34, we decompose again
r = r♦+ r⊥,
where r♦lies in V and r⊥is orthogonal to V, that is,
f†
i r⊥= 0,
r
r⊥
V
r♦
Figure 5.34 The orthogonality condition.

CDMA
331
or
F†r⊥= 0
with
F = [f1, . . . , fK] .
The orthogonal component r⊥of the receive vector is not relevant to the decision. With
r♦=
K

k=1
xkgk = Gx
and x = (x1, . . . , xK)T , we have
F† (r −Gx) = 0.
From the orthogonality
F†G = I
between the two bases, we obtain
x = F†r.
(5.41)
There are standard methods to calculate the reciprocal base. Here, however, we will show
how to derive the coordinate vector by the orthogonality condition which again gives some
insight into the geometrical structure.
We look for a vector x that minimizes the quadratic distance (i.e. the mean square error)
between the receive vector r and V, that is,
x = arg min
u ∥r −Gu∥2 .
(5.42)
This is equivalent to the orthogonality condition
g†
k(Gx −r) = 0
that must hold for all vectors gk (see Figure 5.34) with Gx = r♦. In matrix notation, we
can write this as
G†(Gx −r) = 0
or
G†Gx = G†r.
If the signature matrix G has maximal rank, we may invert G†G and eventually ﬁnd the
desired solution
x =

G†G
−1 G†r.
(5.43)
The matrix
G−=

G†G
−1 G†
is called the Moore–Penrose pseudoinverse of the matrix G. Since x = G−r = F†r, we
have shown that
G−= F†.

332
CDMA
We note that the same formula can easily be obtained in the discrete matched ﬁlter model
v = RCs + m
with v = G†r. In the noise-free channel, x = Cs holds and we simply obtain x by applying
R−1, that is,
x = R−1v,
which is equivalent to Equation (5.43). Thus, the decorrelating receiver just extends the
method of simple matrix inversion to the noisy channel.
An estimate for the transmit signal vector s can be obtained by channel inversion as
ˆs = C−1x = C−1R−1v.
For user number k, we get the estimate
ˆsk = c−1
k

R−1v

k ,
(5.44)
where the index k indicates the kth element of the vector. Thus, we need only to know
the signature waveforms of all the other users. It is not necessary to know their fading
amplitudes.
The discrete transmission model including the decorrelation receiver is given by
x = Cs + ˜m
with ˜m = R−1m. The autocorrelation matrix of the noise vector ˜m = (m1, . . . , mK)T is
given by
E

˜m ˜m†
= N0R−1.
For user number k, we thus have the transmission model
xk = cksk + ˜mk
with noise variance given by
E
.
| ˜mk|2/
= N0

R−1
kk ,
where (R)kk denotes the kth diagonal element of the matrix R−1. For BPSK transmission,
the BER performance of user k for ﬁxed channel amplitudes is then given by
P (k)
b
= 1
2erfc
#$
|ck|2

R−1
kk
Eb
N0
%
.
We now evaluate this BER performance in an alternative way that gives some insight
into the geometrical structure. We recall that the receiver calculates the coordinates of
the relevant part r♦of the receive vector r with respect to the signature base vectors gk.
Without losing generality, we consider user number 1. An error occurs if the ﬁrst coordinate
of the transmit vector corresponding to the base vector g1 has a positive sign, but the ﬁrst
coordinate of the receive vector has a negative sign (or vice versa). We can visualize the

CDMA
333
Transmit vector
threshold
Decision
g1


g2
Figure 5.35 Distance to the decision threshold for the decorrelator for c1 = c2 = 1.
geometrical situation as follows. The K −1-dimensional hyperplane spanned by g2, . . . , gK
divides the K-dimensional hyperplane given by the vector space V = span(g1, . . . , gK) into
two half planes. An error occurs if the (relevant) receive vector r♦lies in the other half
plane of V than the transmit vector. For K = 2 and c1 = c2 = 1, the situation is depicted
in Figure 5.35 We may thus regard the K −1-dimensional hyperplane span(g2, . . . , gK) as
a decision threshold. Let  be the distance between the transmit vector and this threshold.
The bit error probability for user 1 is then given by
Pb = Q

σ

.
We note that the coordinates of all users are independent and uniquely deﬁned, and the
decision about the transmit symbol s1 of user 1 does not depend on the values of the other
transmit symbols s2, . . . , sK. For the performance analysis, we may thus set s2 = · · · =
sK = 0. This means that the distance of the transmit vector to the threshold is the same as
the distance of c1g1 to the threshold (see Figure 5.35). It is evident from the ﬁgure and the
Pythagorean theorem that
2 = |c1|2 
Eb

1 −
&&Pg1
&&2
,
where the vector Pg1 is the orthogonal projection of the base vector g1 onto the threshold.
For two dimensions, we know from elementary vector geometry that
Pg1 = (g†
2g1)g2 = ρ12g2.

334
CDMA
In that case, the projector P is given by the matrix
P = g2g†
2.
For the general case of more dimensions, we calculate  by using the orthogonality prin-
ciple. The formalism is similar to the derivation of the decorrelating receiver. We deﬁne
G1 = [g2, . . . , gK].
Let k be the vector of coordinates that minimizes the distance between g1 and the threshold,
that is,
k = arg min
u ∥g1 −G1u∥2 .
From the orthogonality condition
G†
1 (g1 −G1k) = 0,
we obtain
k = (G†
1G1)−1G†
1g1.
We thus have
2 = |c1|2 
Eb ∥g1 −G1k∥2 = |c1|2 
Eb
&&&g1 −G1(G†
1G1)−1G†
1g1
&&&
2
.
We note that
(G†
1G1)−1G†
1 = G−
1
is the pseudoinverse of G1 and
P = G1G−
1
is the orthogonal projector onto the hyperplane span(g2, . . . , gK). An orthogonal projector
P is a matrix with the following properties: it is Hermitian, that is,
P = P†
and has the property
P2 = P.
Since ∥g1∥2 = 1, we readily get the expression
2 = |c1|2 
Eb

1 −g†
1Pg1

or, equivalently,
2 = |c1|2 
Eb

1 −
&&Pg1
&&2
,
which is just the Pythagorean Theorem. The bit error rate is then given by
Pb = 1
2erfc
#$
|c1|2 
1 −
&&Pg1
&&2 Eb
N0
%
.
(5.45)

CDMA
335
As a secondary result, we have thus seen that
1

R−1
11
=

1 −
&&Pg1
&&2
.
The quantity
&&Pg1
&&2 = (G†
1g1)†(G†
1G1)−1(G†
1g1)
has the following structure. The matrix
R1 = G†
1G1
is just the autocorrelation matrix R with the ﬁrst row and the ﬁrst column deleted. The
vector
v1 = G†
1g1,
is just the column of the K −1 detector outputs of g1 for all other detectors g2, . . . , gK.
From Equation (5.45), we see that the performance compared to ideal single-user BPSK
is degraded by the channel attenuation |c1|2 and the geometrical factor

1 −
&&Pg1
&&2
. For
Rayleigh fading, we simply average over the fading amplitude c1 as shown in Subsec-
tion 2.4.3 to get
Pb = 1
2

1 −
0
1
1
1
2

1 −
&&Pg1
&&2
Eb
N0
1 +

1 −
&&Pg1
&&2
Eb
N0

.
(5.46)
We now evaluate the expression (5.45) with
&&Pg1
&&2 = |ρ12|2 for the two-user performance
in the AWGN channel and compare it with the SUMF receiver. We set the fading amplitude
c1 = 1. Figure 5.36 shows the bit error curves for both receivers for equal fading amplitudes
c1 = c2 = 1 and different values of the correlation coefﬁcient ρ12. We see that for these
relatively high correlation coefﬁcients, the decorrelator performs several decibels better
than the SUMF receiver. The difference becomes smaller for small correlations, but the
decorrelator is always better. In fact, one can show that for real-valued coefﬁcients c1, c2 and
ρ12, the decorrelator is better than the SUMF receiver (see Problem 3). For complex values
of the fading amplitudes, it may occasionally happen that
))ℜ

c∗
1c2ρ12
)) in Equation (5.30)
becomes smaller than |c1ρ12|2 in Equation (5.45) because of favorable channel phases.
Comparing the performance of the decorrelator for ρ12 = 0.6 with MLSE curve for the
same ρ12 in Figure 5.30, we note that the loss is always less than 1 dB. Figure 5.37 shows
the bit error curves for both receivers for a ﬁxed correlation coefﬁcient ρ12 = 0.6 and
the different values of the fading amplitudes. For small interferer amplitudes |c2| ≪|c1|,
the performance curves of the SUMF receiver approach the limit of the ideal single-user
(SU) BPSK curve. However, for this relatively high correlation coefﬁcient, the degradation
becomes severe if the interferer power is of the same order (or even higher) as that of the
user under consideration. The curve for the decorrelator does not depend on the amplitude
of the interferer. It has a ﬁxed degradation (caused by the geometry) of approximately 2 dB
compared to the ideal BPSK. Therefore, for very low values of the interferer amplitude,
the SUMF receiver performs better.

336
CDMA
0
2
4
6
8
10
12
14
16
18
10
−4
10
−3
10
−2
10
−1
10
0
Eb/N0 [dB]
Pb
SU BPSK 
 4/5
 4/5
 1/2
 1/2
 3/5
Figure 5.36 Bit error curves for the SUMF receiver (−o−) and the decorrelator (−+ −)
for equal fading amplitudes c1 = c2 = 1 and ρ12 = 1/2, 3/5, 4/5.
0
2
4
6
8
10
12
14
16
18
10
−4
10
−3
10
−2
10
−1
10
0
Eb/N0 [dB]
Pb
SU BPSK 
1.5
1.0
0.5
0.1
Figure 5.37 Bit error curves for the SUMF receiver (−o−) and the decorrelator (−+ −)
for ρ12 = 3/5 and fading amplitudes c1 = 1 and c2 = 0.1, 0.5, 1, 1.5.

CDMA
337
The MMSE receiver
If an estimate for the SNR is available, a linear receiver that is better than the decorrelator
can be obtained from the minimum mean square error (MMSE) condition. We consider the
orthonormal base discrete channel model
r = GCs + n
We look for a linear estimate ˆs = (ˆs1, . . . , ˆsK)T for s = (s1, . . . , sK)T that minimizes the
mean square error
E
|ˆsk −sk|2
for all k. A linear estimator is given by
ˆsi =
K

k=1
bikrk
or, in matrix notation, by
ˆs = Br
with (B)ik = bik. The method to ﬁnd the matrix B is quite similar to the derivation of the
Wiener estimator in Subsection 4.3.3. We apply the orthogonality theorem of probability
theory that says that the MMSE condition is equivalent to the orthogonality condition
E

(ˆsi −si) r∗
k

= 0.
In matrix notation, this can be written as
E

(ˆs −s) r†
= 0.
We insert the linear estimator for ˆs and get
BE

rr†
= E

sr†
.
Using the fact that the signal and the noise are uncorrelated and that the symbols are
independently modulated, the left hand side can be evaluated as
E

rr†
= GCE

ss†
(GC)† + E

nn†
= ESGC (GC)† + N0I.
For the right-hand side, we get
E

sr†
= ES (GC)† .
We thus have
B

ESGC (GC)† + N0I

= ES (GC)†
or
B = (GC)†

GC (GC)† + N0
ES
I
−1
.
We note that for a matrix A the relation
A† 
AA† + tI
−1 =

A†A + tI
−1 A†
(5.47)

338
CDMA
holds for any real number t (if the inverses mentioned above exist) (see Problem 4). We
can thus write
B =

(GC)† GC + N0
ES
I
−1
(GC)† .
Using elementary matrix operations, we can write this as
B = C−1

G†G + N0
ES

CC†−1−1
G†.
We thus have
ˆs = C−1

G†G + N0
ES

CC†−1−1
G†r.
(5.48)
We note that in the limit N0 →0 this approaches the decorrelating receiver. For very noisy
channels it approaches the SUMF receiver.
The treatment is similar for the discrete matched ﬁlter model
v = RCs + m.
We look for a linear estimator
ˆs = Av.
The orthogonality principle in matrix notation reads as
E

(ˆs −s) v†
= 0.
We insert the linear estimator for ˆs and get
AE

vv†
= E

sv†
.
The left-hand side can be evaluated as
E

vv†
= RCE

ss†
(RC)† + E

mm†
= ESRCC†R† + N0R.
For the right-hand side, we get
E

sv†
We thus have
A

ESRCC†R + N0R

= ESC†R,
where we have used the fact that R is Hermitian. We assume that the matrices R and C
are regular, and multiply from the right-hand side by R−1 
C†−1 C−1 and obtain
A

ESR + N0

CC†−1
= ESC−1
and, ﬁnally,
A = ESC−1 
ESR + N0

C†C
−1−1
.
The estimate for the transmit vector is then given by
ˆs = C−1

R + N0
ES

CC†−1−1
v.
(5.49)

CDMA
339
5.3.4
Suboptimal nonlinear receiver structures
In this subsection, we present the method of successive interference cancellation (SIC) (see
e.g. (Frenger et al. 1999)). There are two variations of that theme. The serial SIC should
be preferred if the different users have very different power levels as is the case in the
absence of power control. We see that, in this case, the SUMF receiver may totally fail
for the users with low signal level. The parallel SIC is the better choice if the different
users have approximately the same power levels as it is the case in the presence of power
control. For this method, it is necessary that the SUMF receiver gives correct results at
least for a signiﬁcant part of the users.
Serial successive interference cancellation
The idea is simple: if the reception is corrupted by strong interferers with known signature
pulses and known fading amplitudes, one can combat the near–far problem by adjusting
the decision threshold to the situation.
We illustrate the idea for the case of two users with the same parameters as in Figure 5.27
and Figure 5.29. In those ﬁgures, the fading amplitudes are c1 = 1 and c2 = 2, and the
transmit symbol energy has been normalized to ES = 1. The signature vectors are given by
g1 =
 1
0

, g2 = 1
5
 3
4

.
The situation is depicted in Figure 5.38. In the beginning, we do not have any knowledge
about the BPSK transmit symbols s1 and s2. The receive vector is given by
r = s1g1 + 2s2g2 + n,
where n is the two-dimensional AWGN. Because the signal of user 2 is stronger than that
of user 1, the SUMF receiver will work quite well for that user by utilizing Threshold 2 in
Figure 5.38 to provide us with a reliable estimate
ˆs2 = sign (g2 · r)
of symbol s2. If s2 has been correctly decided as ˆs2 = +1, we may now decide whether
s00 = +g1 + 2g2
or
s10 = −g1 + 2g2
has been transmitted. These two cases corresponding to Region 1 and Region 2 in
Figure 5.38 are separated by Threshold 1a which is a straight half line with the same
distance between s00 and s10. The half line ends at Threshold 2. For ˆs2 = −1, we have to
decide whether
s01 = +g1 −2g2
or
s11 = −g1 −2g2

340
CDMA
Threshold 2
00
10
01
11
c1g1
c2g2
Region 1
Region 2
Region 3
Region 4
Figure 5.38 Two-user BPSK SIC receiver for unequal fading amplitudes.
corresponding to Region 3 and Region 4, respectively. These regions are separated by
Threshold 1b. Formally, the decision on s1 is given by
ˆs1 = sign (g1 · (r −2ˆs2g2)) .
If s2 has been correctly decided, this corresponds to the maximum likelihood decision for
s1. However, the estimate ˆs2 may be wrong. Comparing Figure 5.29 and Figure 5.38, we
note that there are two stripe-like shaped regions where the decisions on s2 differ. However,
there are only two small triangular regions where this affects the decision ˆs1. Therefore, s1
may be correctly decided even if the decision on s2 is erroneous. This correct decision ˆs1
now provides us with a better estimate for s2, which is given by
ˆs2 = sign (g2 · (r −ˆs1g1)) .
Thus, this successive interference cancellation also improves the decisions for the stronger
signal.
We now formalize the procedure and generalize to K users. For simplicity, we restrict
ourselves to BPSK. The generalization on QPSK is straightforward. The receive signal is

CDMA
341
then given by
r =
K

k=1
ckskgk + n.
Without losing generality, we assume that the signals are ordered according to their receive
powers, that is,
|c1|2 ≤|c2|2 . . . ≤|cK|2 .
We start with the estimate for the strongest signal and get
ˆsK = sign

c∗
Kg†
Kr

.
We now make decisions for the other K −1 symbols sK−1, sK−2, . . . , s1 according to the
descending signal strength order as
ˆsk = sign
#
c∗
kg†
k
#
r −
K

i=k+1
ci ˆsigi
%%
.
After this ﬁrst iteration, estimates ˆs1, . . . , ˆsK for all K symbols are available. We may now
start a second iteration. We replace the old estimate ˆsK with the new one
ˆs(new)
K
= sign
#
c∗
kg†
k
#
r −
K−1

i=1
ci ˆsigi
%%
,
thereby using the information available about all other symbol decisions obtained in the ﬁrst
iteration. We now make decisions for the other K −1 signals according to the descending
signal strength order as
ˆs(new)
k
= sign
#
c∗
kg†
k
#
r −
k−1

i=1
ci ˆsigi −
K

i=k+1
ci ˆs(new)
i
gi
%%
.
Note that the estimates ˆsi, i < k of the last iteration are used together with the already
available new estimates ˆs(new)
i
, i > k. When all estimates are calculated in descending
order, we may start a third iteration, and so forth.
The method described above is called serial SIC because the estimates are obtained
serially in an order given by the signal strengths. It is especially useful if there are signiﬁcant
differences in the signal strengths. This is the case in the absence of power control. In case
of an efﬁcient power control, all signal powers are of the same order, and there is no reason
for one of these signals to be privileged. In that case, we should apply the parallel SIC
receiver.
Parallel successive interference cancellation
In a parallel SIC receiver, all iterations are performed in parallel. Again, we consider BPSK
transmission and the discrete channel model
r =
K

k=1
ckskgk + n.

342
CDMA
In the ﬁrst iteration, the SUMF receiver outputs for all users are calculated in parallel to
obtain the estimates
ˆsk = sign

c∗
kg†
kr

for k = 1, . . . , K. After this ﬁrst iteration, estimates ˆs1, . . . , ˆsK for all K symbols are
available. We may now start a second iteration. We replace the old estimate ˆsk by the
new one
ˆs(new)
k
= sign

c∗
kg†
k

r −
K

i̸=k
ci ˆsigi



.
Again, this is done in parallel. The iteration can be repeated several times. At all times, a
new estimate ˆs(new)
k
will be obtained from the estimates ˆsi, i ̸= k for all other users from
the last iteration step.
It is obvious that this method needs a reliable ﬁrst SUMF estimate for most users. It
will fail if most users have a power level far below the level of one or more high-power
level users.
5.4
Receiver Structures for MC-CDMA and
Asynchronous Wideband CDMA Transmission
5.4.1
The RAKE receiver
As already pointed out at the beginning of this chapter, spreading by itself does not improve
the power efﬁciency (i.e. the BER performance as a function of Eb/N0) in a Gaussian
channel. It only uses a spectrally inefﬁcient pulse shape that spreads the same power
over a wider transmission band. However, in a fading environment, the receiver may take
advantage from this higher transmission bandwidth. As we have seen in Subsection 4.4.3,
a wideband channel has an inherent diversity degree that is signiﬁcantly greater than 1 if
the transmission bandwidth B signiﬁcantly exceeds the correlation bandwidth fcorr. Since
B ≈1/Tc, this means that the delay spread τ must signiﬁcantly exceed the chip duration
Tc. The interpretation is that the signal arrives at the receiver via several uncorrelated or
only weekly correlated transmission paths corresponding to different delays. We may thus
speak of path diversity of the channel. In the heuristic discussion in Subsection 5.1.1, we
introduced the RAKE receiver as a device that can exploit this diversity. In the following
discussion, we shall derive this receiver structure as a special case of the maximum ratio
combiner if the following model assumptions are made:
• The signal arrives at the receiver via L discrete transmission paths with delays τl, l =
1, . . . , L.
• We may consider the signal of one time slot separately. Intersymbol interference
may be neglected due to orthogonality or may be regarded as an additional noise-like
disturbance. MAI is treated similarly.
• We neglect the time variance of the channel during the time slot under consideration.

CDMA
343
For reasons of receiver implementation, we will assume at a later stage that each τl is an
integer multiple of the chip duration Tc. We should keep in mind that the assumption of
L discrete transmission paths is a very rough reﬂection of a real physical channel impulse
response and that there is some arbitrariness in the model as to how these delays are chosen.
We now assume that user number k with the signature pulse gk(t) transmits a BPSK
symbol sk ∈

±√Eb

. The transmit pulse is normalized to
∥g∥2 =
 ∞
−∞
|g(t)|2 dt = 1.
Because we only look at this one user number k, we may drop the index k and write sg(t)
instead of skgk(t). The signal will be transmitted over a multipath channel with complex
fading amplitudes cl corresponding to the delays τl. The receive signal is then given by
r(t) =
L

l=1
clsg(t −τl) + n(t),
where n(t) is the complex AWGN. We may write this as
r(t) = sh(t) + n(t),
where
h(t) =
L

l=1
clg(t −τl)
is the convolution of the transmit pulse with the impulse response of the multipath channel
and can be interpreted as a composed transmit pulse that includes the multipath channel.
We may interpret h(t) as a one-dimensional transmit base. Sufﬁcient statistics is trivially
given by the detector output
v = Dh[r] =
 ∞
−∞
h∗(t)r(t) dt
(5.50)
corresponding to h(t). This can be written as
v =
L

l=1
c∗
l
 ∞
−∞
g∗(t −τl)r(t) dt =
L

l=1
c∗
l Dl[r],
(5.51)
where
Dl[r] =
 ∞
−∞
g∗(t −τl)r(t) dt
is the detector for the delayed signature pulse g(t −τl). Thus, the receiver multiplies the
detector outputs for all the delayed pulses by the complex conjugate channel amplitudes c∗
l
and sums them up (combines them) (see Figure 5.39).
The combiner output is given by
v = ∥h∥2 s + m,
(5.52)

344
CDMA
where
m = Dh[n]
is a complex zero mean Gaussian random variable with variance σ 2 = ∥h∥2 N0. The most
probable transmit symbol ˆs is obtained as
ˆs = arg min
s
))v −∥h∥2 s
))2 .
For BPSK, this is simply the sign3 decision
ˆs = sign (ℜ{v}) .
For QPSK, we have
ˆs = sign (ℜ{v}) + jsign (ℑ{v}) .
This so-called RAKE receiver is depicted in Figure 5.39 for BPSK. We note that the RAKE
receiver is nothing but a special case of the MRC receiver discussed in Subsection 2.4.5.
The L diversity branches corresponding to the detector outputs for the L paths are combined
by Equation (5.51) in the same way as, for instance, the detector outputs obtained from
different antennas.
We note that
Dl[r] = g∗(−t) ∗r(t)
))
t=τl
is just the output of one ﬁlter (i.e. a correlator) matched to the signature pulse and sampled
at the times t = τ1, . . . , τL. Thus, we do not have to implement a bank of L correlators as
depicted in Figure 5.3. We only need one correlator (matched ﬁlter) to store the matched
ﬁlter outputs and combine them with the appropriate multiplicative factors. If the delays τl
are integer multiples of the chip duration Tc, we may implement the RAKE receiver by a
ﬁlter matched to the chip pulse followed by a digital FIR (ﬁnite impulse response) ﬁlter
structure.
3
c∗
1
c∗
L
D1
DL
r(t)
. . .
. . .
sign
ℜ
ˆs
v
Figure 5.39 Block diagram for the BPSK RAKE receiver.
3Up to a factor that can be ignored for that decision.

CDMA
345
Performance of the RAKE receiver
To evaluate the performance of the RAKE receiver, we divide Equation (5.52) by ∥h∥to
obtain the normalized combiner output u = v ∥h∥−1 as
u = ∥h∥s + n,
where the noise term n is a complex mean zero Gaussian random variable with variance
σ 2 = N0. We assume independent Rayleigh fading for the different transmission paths.
Then the coefﬁcients cl are independent complex Gaussian random variables with mean
zero. The respective transfer powers of the paths are given by the variances
E
|cl|2
= α2
l .
To ensure that the energy per bit at the receiver end is given by Eb, we must normalize the
signal components with respect to the fading coefﬁcients such that
α2
1 + · · · + α2
L = 1.
To ﬁnd an expression for the BER performance we assume pairwise orthogonality between
the delayed versions of the signature pulse, that is, we assume
 ∞
−∞
g∗(t −τi)g(t −τl) dt = δil.
This assumption is not more severe than the other orthogonality assumptions above. How-
ever, we must keep in mind that our treatment is based on approximations. We may now
write
∥h∥2 =
L

l=1
|cl|2
and deﬁne the composed fading amplitude
a =
0
1
1
2
L

l=1
|cl|2 = ∥h∥2 ,
so the combiner output is then given by
u = as + n.
(5.53)
We thus have familiar BPSK (or QPSK) with a composed fading amplitude with power
equal to the sum of the transmit powers of the different transmission paths. This is the
same situation as for the MRC receiver for conventional diversity as discussed in Sub-
section 2.4.5. We may thus refer to the detailed analysis given in Subsection 2.4.6. For
BPSK (or QPSK) transmission, Equation (2.38) simpliﬁes to the expression for the bit
error probability
Pb = Ec1,...,cL



1
2erfc


0
1
1
2
L

i=1
|ci|2 Eb
N0




,

346
CDMA
where Ec1,...,cL {·} means averaging over the fading amplitudes. The same derivation as
presented in that subsection now results in the integral expression
Pb = 1
π
 π/2
0
L
7
i=1
1
1 +
α2
i
sin2 θ
Eb
N0
dθ,
which can easily be evaluated by numerical methods.
We ﬁnally note that the well-known formulas for L-fold diversity cited at the end of
subsection 2.4.6 cannot be applied here because the transmit powers of the different paths
typically are (in general) different. A formula for diversity with different powers can be
found in (Proakis 2001). However, that formula can only be applied if no pair of diversity
branches has the same power. The formula presented above is more ﬂexible because it can
be applied in any case.
The RAKE receiver and MAI
In the above derivation, we treated the RAKE receiver as a SUMF receiver with a matched
ﬁlter h∗(−t) that includes the impulse response of the channel. The RAKE receiver is
the optimal receiver under the assumptions made at the beginning of the subsection. Even
for one user only, there is the approximation that the signal for only one time slot and
its delayed versions have to be taken into account. Intersymbol interference (ISI) from
neighboring signals has been ignored. This may be justiﬁed by good correlation properties
of the sequence.
For the RAKE receiver as a SUMF receiver, we may regard the MAI due to other
users as a noise-like interference with Gaussian statistics. As already discussed for the
synchronous case, this can be justiﬁed for the case of Rayleigh fading. The near–far problem
is still present. If there is a fast power control mechanism that is able to follow the time
variance of the channel, we do not have Rayleigh fading any more and the situation comes
closer to a Gaussian channel.
Even though the RAKE receiver is essentially a detector matched to one user (including
its signature waveform and the corresponding channel impulse response), we may think of
multiuser detection for K users by using K RAKE receivers matched to all these users
(including their signature waveforms and their respective channels impulse responses). If
we restrict this treatment again to the signal for only one time slot and its delayed versions,
we may write the receive signal as
r(t) =
K

k=1
skhk(t) + n(t),
where sk is the transmit symbol of user number k and h(t) is the signature waveform
convolved with the channel impulse response for user number k. The RAKE combiner
output for user number i is then given by
vi =
K

k=1
ρiksk + mi

CDMA
347
with ρik = ⟨hi, hk⟩and detector outputs mi corresponding to the noise or, in vector notation,
v = Rs + m
with (R)ik = ρik. This is just like the synchronous matched ﬁlter model, and we may thus
apply any of the MUD receivers discussed in the preceding, e.g. successive interference
cancellation. Optimality will never be achieved as other time slots are ignored, but some
improvements are possible. This may help to reduce the effect of the near–far problem,
but the problem is not resolved because the other time slots of the unwanted strong signal
are not taken into account. This may severely inﬂuence the detector output for the wanted
week signal. An optimal receiver must take all the time slots into account. We discuss such
a receiver in the following subsection.
5.4.2
Optimal receiver structures
In this subsection, we study optimal receiver structures. The maximum likelihood sequence
estimation (MLSE) for jointly optimum decisions and the bitwise maximum a posteriori
(MAP) receiver for estimating the most probable individual bit transmitted by one user
have already been discussed in some detail. The formalism can directly be applied to a
channel that is formally described by
r = Hs + n.
This channel model applies to synchronous wideband MC-CDMA and asynchronous wide-
band DS-CDMA as well. However, the interpretation of matrix H is different and both
cases have to be discussed separately.
The optimal receiver for asynchronous DS-CDMA
We recall that the above compact notation for the discrete transmission model includes
two degrees of freedom (or dimensions), and all quantities are labeled by two indices.
One is the user index k that already occurs in the synchronous model. The other one is
the time index l. Thus, the complexity of an exhaustive search for a maximum likelihood
receiver would grow exponentially in the number of users K and with the frame duration
L. Fortunately, one can usually assume that the time dispersion of the channel is ﬁnite.
For single user transmission over a channel with ﬁnite time dispersion, an MLSE receiver
can be implemented by using the Viterbi algorithm (see e.g. (Benedetto and Biglieri 1999;
Kammeyer 2004; Proakis 2001)). This receiver type is sometimes called Viterbi equalizer.
We may generalize that receiver structure for multiuser detection. Here, we note that the
general case of different time-dispersive channels for different users already includes any
case of asynchronous transmission.
The maximum likelihood receiver has to ﬁnd the most probable transmit sequence ˆs
that is given by
ˆs = arg min
s
∥r −Hs∥2
or, equivalently,
ˆs = arg max
s

ℜ

s†H†r

−1
2 ∥Hs∥2

.

348
CDMA
We deﬁne
v = H†r
and write
ˆs = arg max
s

ℜ

s†v

−1
2s†Rs

with the autocorrelation matrix deﬁned by
R = H†H.
Let us ﬁrst consider the single-user case in a time-dispersive channel, that is, we rederive
the well-known MLSE equalizer structure for that channel. The autocorrelation matrix R
has elements given by
(R)lm =

h∗(t −lTS)h(t −mTS) dt,
that only depend on the difference l −m so (R)lm = ρ[l −m] with4
ρ[l] =

h∗(t −lTS)h(t) dt.
The task now is to maximize the metric given by
µ(s) =

l
ℜ
'
s∗
l
#
vl −1
2

m
ρ[l −m]sm
%(
.
We assume that the time-dispersive channel has ﬁnite memory M, hence ρ[m] = 0 for
m > M. The metric can now be written as
µ(s) =

l
µl
with
µl = ℜ
'
s∗
l
#
vl −1
2
M

m=−M
ρ[m]sl−m
%(
,
where
M

m=−M
ρ[m]sl−m
is a convolution and can be interpreted as a digital ﬁnite impulse response (FIR) ﬁlter
described by a shift register5. Assuming BPSK transmission, the shift register has 22M
states characterized by
(sl−M+1, sl−M+2, . . . , sl+M),
and the MLSE receiver can easily be implemented by the Viterbi algorithm in the same
way as for convolutional codes as described in Subsection 3.2.2, but with the metric deﬁned
above.
4We write ρ instead of ρ11 for a single user.
5We ignore that the ﬁlter is noncausal. This can easily be removed by a time shift.

CDMA
349
The complexity of the trellis can be further reduced by noting that the matrix R is
Hermitian. Consider the simplest case M = 1. The autocorrelation matrix is then given by
R =


ρ[0]
ρ∗[1]
0
0
0
ρ[1]
ρ[0]
ρ∗[1]
0
0
0
ρ[1]
ρ[0]
ρ∗[1]
0
0
0
ρ[1]
ρ[0]
ρ∗[1]
...
0
0
0
ρ[1]
ρ[0]
...
...
...
...


.
For BPSK with si = ±√Eb, we obtain6
s†Rs = EbLρ[0] + 2ℜ{ρ[1]} (s1s2 + s2s3 + s3s4 + · · · ) .
Omitting the ﬁrst term that is not relevant for the decision, we obtain
µ(s) = ℜ
'
l
(slvl −slsl+1ρ[1])
(
,
and, with an appropriate renumbering,
µl = ℜ{sl−1 (vl−1 −slρ[1])} .
Thus, the trellis diagram has two states labeled by the signs of sl−1. The actual input bit
is sl.
For M = 2, the autocorrelation matrix has the following structure:
R =


ρ[0]
ρ∗[1]
ρ∗[2]
0
0
0
0
ρ[1]
ρ[0]
ρ∗[1]
ρ∗[2]
0
0
0
ρ[2]
ρ[1]
ρ[0]
ρ∗[1]
ρ∗[2]
0
0
0
ρ[2]
ρ[1]
ρ[0]
ρ∗[1]
ρ∗[2]
0
0
0
ρ[2]
ρ[1]
ρ[0]
ρ∗[1]
ρ∗[2]
...
...
...
...
...


,
and the metric increment is given by
µl = ℜ{sl−2 (vl−2 −sl−1ρ[1] −slρ[2])} .
Thus, we have a trellis diagram with four states labeled by the signs of (sl−1, sl−2). The
actual input bit is sl.
For general values of M, we readily ﬁnd the expression
µl = ℜ
'
sl−M
#
vl−M −
M

m=1
sl−M+mρ[m]
%(
,
which is described by a trellis diagram with 2M states.
6Here and in the following text, we start with the index l = 1.

350
CDMA
Since
vl = h†
l r =

h∗(t −lTS)r(t) dt
is already the combiner output of the RAKE receiver for time slot l, this single-user MLSE
receiver is a generalization of the former because it takes intersymbol interference into
account. The RAKE receiver by itself detects only one symbol. However, for a single user
this intersymbol interference will not be severe if sequences with good correlation properties
are chosen. Problems will occur because of intersymbol interference by a stronger user.
For K asynchronous users, the autocorrelation matrix is given by the general expression
(5.25). As for the single-user case, for a channel with ﬁnite memory, the matrix elements
will be zero outside the inner subdiagonals. We may then proceed in a similar fashion as
for the single-user case and calculate s†Rs to obtain metric expressions corresponding to
that case. In contrast to the single-user case the subdiagonals do not consist of identical
elements, and thus the metric increment calculation will be different from time-step to
time-step, but it will be repeated after K time-steps. For K = 2, there will be two different
expressions for the metric calculation, one for even and one for odd time indices.
We shall now evaluate the metric expression for K = 2 and ﬁnite memory such that
R[l] = 0 for l > 1. Thus we have to consider only the submatrices R[0] and R[1] with
R[0] =
 ρ11[0]
ρ12[0]
ρ∗
12[0]
ρ22[0]

,
and
R[1] =
 ρ11[1]
ρ12[1]
0
ρ22[1]

,
that is, we have assumed for simplicity that ρ21[1] = 0. This is the case if the time dispersion
is small. We note that for the asynchronous case without time dispersion, the diagonal
elements of R[1] vanish.
We now write the matrix R as
R =


ρ11[0]
ρ12[0]
ρ∗
11[1]
0
0
0
0
ρ∗
12[0]
ρ22[0]
ρ∗
12[1]
ρ∗
22[1]
0
0
0
ρ11[1]
ρ12[1]
ρ11[0]
ρ12[0]
ρ∗
11[1]
0
0
0
ρ22[1]
ρ∗
12[0]
ρ22[0]
ρ∗
12[1]
ρ∗
22[1]
0
0
0
ρ11[1]
ρ12[1]
ρ11[0]
ρ12[0]
ρ∗
11[1]
...
...
...
...
...


.
This matrix shows some similarities to the matrix for the single-user case and channel
memory M = 2. There is the main diagonal and two nonvanishing subdiagonals both in
the upper and the lower triangle. Thus, we will also have a trellis with four states. However,
the elements of the diagonals are different for even and for odd row indices. For BPSK
with si = ±√Eb, we evaluate the energy term as
s†Rs = EbL (ρ11[0] + ρ22[0])
+2ℜ{ρ12[0]} (s1s2 + s3s4 + · · · ) + 2ℜ{ρ11[1]} (s1s3 + s3s5 + · · · )
+2ℜ{ρ12[1]} (s2s3 + s4s5 + · · · ) + 2ℜ{ρ22[1]} (s2s4 + s4s6 + · · · )

CDMA
351
Ignoring the ﬁrst term that is not relevant for the decision, the metric increment expressions
are
µl = ℜ{sl−2 (vl−2 −sl−1ρ12[0] −slρ11[1])}
for odd values of l and
µl = ℜ{sl−2 (vl−2 −sl−1ρ12[1] −slρ22[1])}
for even values of l.
The expressions for the metric increments for more users and more channel memory
can be derived in a similar manner. Given these metric increment expressions, the MLSE
receiver can be implemented by means of the Viterbi algorithm (see Subsection 3.2.2).
Alternatively, the bitwise MAP receiver can be implemented by the BCJR algorithm (see
Subsection 3.2.4). The ﬁrst receiver makes joint optimal decisions, and the second one
makes individually optimal bit decisions. The decisions may be different, but typically this
is a very rare event. The MAP algorithm is computationally more complex, but it provides
reliability information that may be used by an outer decoder. Alternatively, the suboptimal
SOVA (see Subsection 3.2.3) may be used to obtain such reliability information.
We note that, since the complexity of both optimal receivers grows exponentially with
the number of users, it can only be applied if K is not too large. However, one may think
of a receiver that utilizes only the most signiﬁcant entries in the matrix R, which will
then be an intermediate solution between the SUMF receiver (implemented by a RAKE
receiver) and the optimal receiver. The most signiﬁcant matrix entries (outside the main
diagonal) correspond to the strongest interferers. Since the main task of multiuser detection
is to mitigate the near–far problem, such a strategy will certainly improve the performance
signiﬁcantly.
The optimal receiver for synchronous wideband MC-CDMA
For synchronous MC-CDMA, the discrete transmission model is formally the same as above
and thus the maximum likelihood estimate is formally the same, that is, it is given by
ˆs = arg min
s
∥r −Hs∥2 ,
or, equivalently, by
ˆs = arg max
s

ℜ

s†v

−1
2s†Rs

,
with
v = H†r
and
R = H†H.
However, the interpretation is different. Since H = C ◦G, the column vector hk of H is
the signature vector of user k with random signs in frequency direction multiplied with the
fading amplitudes for that user at the respective subcarrier frequencies. The component
vk = h†
kr

352
CDMA
of v is the detector output corresponding to that composed pulse shape. It acts as a back
rotation of the channel phase and the PN sequence and weights with the fading amplitude.
In contrast to the DS-CDMA time-dispersive channel, there is no trellis structure in-
volved here. Hence, the MLSE must be implemented by exhaustive search. Thus, the
complexity grows exponentially with the number of users and with the length of the spread-
ing sequence. Therefore, the MLSE receiver seems to be too complex for implementation
in most cases. The same holds for the bitwise MAP receiver.
5.5
Examples for CDMA Systems
As mentioned in Section 5.1, the origin of spread spectrum is in the ﬁeld of military appli-
cations and radar systems. Today, there are also some specialized markets for CDMA as
wireless microphones. However, in this section we focus on the main commercial applica-
tions as wireless local area networks, satellite navigation and mobile radio networks.
5.5.1
Wireless LANs according to IEEE 802.11
In 1997, the Institute of Electrical and Electronics Engineers (IEEE) released the standard
IEEE 802.11 for wireless local area network (WLAN) applications. Systems according to
this standard offer a wireless access to existing local area computer networks via the so-
called access points as well as direct wireless interconnections within a small group of
computers.
Within the standard, three transmission modes are speciﬁed:
• an infrared (IR) mode,
• a frequency hopping (FH) mode,
• a direct sequence spread spectrum (DSSS) mode.
However, only products using the DSSS mode have been established on the market. The
DSSS mode is operating in the ISM frequency band 2400–2485 MHz. ISM means that
this band is free for unlicensed wireless systems for industrial, medical and scientiﬁc ap-
plications. Hence, it is not exclusively reserved for IEEE 802.11. Another prominent and
important system operating in the same band is Bluetooth. Therefore, the spread spectrum
technique is used within IEEE 802.11 to lower the power spectral density to reduce the
interference to other systems and as a kind of antijamming method with respect to inter-
ference experienced from other systems with a smaller bandwidth. Bluetooth, for example,
is using frequency hopping instead. It should be noted that IEEE 802.11 is not a CDMA
system; separation of different connections and radio resource allocation is managed by a
carrier sense multiple access (CSMA) scheme, which is known for wired Ethernet (IEEE
802.3) networks and which is adapted to the special needs of wireless networks.
Within the DSSS mode, two transmission schemes are deﬁned working at data rates
of 1 Mbit/s and 2 Mbit/s. Spreading within IEEE 802.11 is performed using an 11-chip
Barker code word at a chip rate of 11 Mchip/s. Spreading and modulation is illustrated in
Figure 5.40: for the data rate of 1 Mbit/s the bits are modulated by a DBPSK changing the

CDMA
353
DBPSK
1 Mbit/s
Barker code
11 Mchip/s
DQPSK
2 Mbit/s
Carrier frequencies: fn = (2407 + n ·5) MHz,
n = 1, 2, ..., 14
cos 2p
(
 fnt)
11-chip Barker code
Barker code
11 Mchip/s
I/Q
modulator
Figure 5.40 Spreading and modulation for IEEE 802.11.
phase by either 0 or π from bit to bit. For the data rate of 2 Mbit/s a DQPSK with symbols
consisting of dibits is used; the phase is changed by a multiple of π/2 from dibit to dibit.
No details of the pulse shaping of the signal, but a spectrum mask is speciﬁed within
IEEE 802.11, as illustrated in Figure 5.41. Within the ISM band, 14 carrier frequencies with
a separation of 5 MHz are deﬁned. However, in some countries or regions of the world,
only a subset of them is allowed to be used. Furthermore, it should be noted that a carrier
separation of 5 MHz is too low when operating, for example, two access points in one area.
To reduce the adjacent channel interference to an acceptable level, the carriers used in the
nearby access points should have a distance of at least 25 MHz. Hence, effectively there
are only three to four carriers for IEEE 802.11, which are nearly disjoint with respect to
the adjacent channel interference.
In 1999, the IEEE 802.11b standard (see (IEEE 802.11b 1999)) was released as an
addition to the original standard specifying two new transmission modes with higher data
rate, namely, 5.5 Mbit/s and 11 Mbit/s. These transmission modes are based on a code
keying method named complementary code keying. The used 64 codes may be interpreted
as complex-valued variants of the Walsh–Hadamard codes or OVSF codes discussed in
Subsections 1.1.4 and 5.1.3, respectively. Each code consists of eight complex chips. The

354
CDMA
−30
−20
−10
0
10
20
30
−50
−40
−30
−20
−10
0
Relative frequency [MHz]
Power spectral density [dB]
Carrier with spectrum mask 
Adjacent
carrier
Figure 5.41 Spectrum of an IEEE 802.11b carrier.
chip rate has been chosen to be 11 Mchip/s as for the original transmission modes in
order to preserve the spectral properties of a carrier. For the data rate of 11 Mbit/s, the
mapping of data symbols to codes is performed in the following manner: a data symbol
consists of eight bits that are grouped into four dibits (d0, d1, d2, d3). Using the last three
dibits, one of the 64 8-chip codes is generated according to the tree structure shown in
Figure 5.42; dibit d1 affects each odd chip, d2 each odd pair of chips and d3 the ﬁrst four
chips (the odd quads of chips). The overall phase of the code is ﬁxed dibit d0 according to
a DQPSK.
For the data rate of 5.5 Mbit/s, a symbol consists of two dibits (d0, d1), where the role
of d0 is the same as before, that is, ﬁxing the overall phase of the code. Dibit d1 selects
one out of four 8-chip codes which form a subset of the 64 codes shown in Figure 5.42.
The four codes in the subset are pairwise orthogonal.
Modulation for the additional IEEE 802.11b transmission modes is illustrated in
Figure 5.43. A so-called cover code ﬂipping the fourth and seventh chip is applied to
optimize the autocorrelation properties and to minimize DC offsets in the codes.
Systems according to IEEE 802.11b use link adaption, that is, one out of the four
transmission schemes discussed above is selected automatically based on the measured
link quality. It should be mentioned that to handle transmission errors of data packets, an
Automatic Repeat reQuest (ARQ) scheme, not a forward error correction, is applied.
Further types of IEEE 802.11 – the types IEEE 802.11a and IEEE 802.11g mentioned
in Subsection 4.6.3 – use OFDM to handle data rates of up to 54 Mbit/s.
More details on the IEEE 802.11 standard can be found, for example, in (O’Hara and
Petrick 1999).

CDMA
355
cs1 = [ js1 ·c0, c0]
cs1 , s2 , s3 =
[ js3 · cs1, s2, cs1, s2]
cs1, 0 = [ +1 · cs1, cs1]
cs1, 1 = [ +j ·cs1, cs1]
cs1, 2 = [ –1 · cs1, cs1]
cs1, 3 = [– j ·cs1, cs1]
00
01
10
11
cs1, s2 = [ js2 ·cs1, cs1]
cs1 = [ js1 ·c0, c0]
c0 = [1]
c0 = [1]
dk = 00
→sk = 0
dk = 01
→sk = 1
dk = 10
→sk = 2
dk = 11
→sk = 3
Figure 5.42 Generation of complementary codes.
11 Mchip/s
Select code
and its
overall phase
8 complex
chips
11 Mbit/s
1.375 Msymb/s
8 bits per symbol
5.5 Mbit/s
1.375 Msymb/s
4 bits per symbol
or
Cover code
Cover code
11 Mchip/s
I/Q
modulator
Figure 5.43 Modulation and spreading for IEEE 802.11b.
5.5.2
Global Positioning System
The core of the Global Positioning System (GPS) is the space segment consisting of
24 operational satellites surrounding the earth on six different orbits (i.e. four satellites
per orbit) at a distance of about 20,000 km. Each satellite is equipped with a very pre-
cise atomic clock generating the fundamental frequency f0 = 10.23 MHz from which

356
CDMA
all other frequencies as the carrier frequencies, the chip rates and the data bit rates are
derived. The development of GPS was initiated by the US Department of Defense for
military applications, but later was opened to civil applications. Correspondingly, GPS
offers two kinds of services: a precise positioning service (PPS) – primarily for military
and other authorized applications – and a less precise standard positioning service (SPS)
for everyone.
Positioning is based on the principle of trilateration: measuring the propagation delay
of the signals transmitted by three satellites, the corresponding distances can be calculated
using values of the velocity of electromagnetic waves in free space and in the ionosphere
and atmosphere. Knowing the position of the satellites, the position of the GPS receiver is
obtained as the intersection of the spheres with the derived radii around the three satellites.
Since the time when the satellite transmits the signal cannot be determined exactly by the
receiver, only relative propagation delays can be measured. Therefore, an exact positioning
requires the reception of the signals of at least four satellites.
Satellite signals are transmitted on two frequency bands, namely, on the so-called L1
band with a carrier frequency of f1 = 154 · f0 = 1575.42 MHz and on the L2 band with
a carrier frequency of f2 = 120 · f0 = 1227.60 MHz. For the SPS only the ﬁrst carrier is
needed, whereas the PPS requires both carriers, since reception on both carriers allows
estimation and elimination of the effect of the ionospheric refraction which is an essential
source for errors.
Spreading and CDMA is performed in GPS by two types of codes:
1. The coarse/acquisition or clear/access codes (C/A codes) with a chip rate of
rC/A = f0/10 = 1.023 Mchip/s.
2. The precision or protected code (P code) with a chip of rP = f0 = 10.23 Mchip/s.
The C/A codes are Gold codes generated by two 10-stage shift registers as illustrated in
Figure 5.44. Hence, the codes have a period of 1023 chips corresponding to a duration
of 1 ms. The chip length is about 1 µs, so that the time of arrival may be measured by
code correlation with an accuracy of about some tenth of microsecond corresponding to
a position accuracy of about 100 m. A higher resolution can be achieved by tracking not
only the code, but also the phase of the carrier. Using the two 10-stage shift registers,
1023 different Gold codes can be generated by adding shifted versions of the m-sequence
of the second register to the (unshifted) m-sequence of the ﬁrst register as explained in
Subsection 5.1.3. In GPS, only a part of these Gold codes are used which are identiﬁed
by a so-called PRN number (pseudorandom noise sequence number). Shifted versions of
the second m-sequence are obtained by extracting the register content at two variable
stages S1 and S2 and by combining the corresponding two outputs. Examples for the re-
lation between the PRN number, the output stages and the corresponding shift are given
in the table at the bottom of Figure 5.44. A unique C/A code is assigned to each satel-
lite. The used code spreads the proper navigation message transmitted by the respective
satellite.
The navigation message contains, for example, the system time, the orbit data of the
satellite, the satellite status and its signal reliability as well as data for correcting propagation
delay measurements. A satellite transmits a navigation message every 30 seconds at a bit
rate of 50 kbit/s. Hence, within one bit period a C/A code is repeated 20 times. Since each

CDMA
357
C/A code
S1
S2
PRN =
1: S1 = 2, S2 = 6
→shift
5
PRN =
2: S1 = 3, S2 = 7
→shift
6
...
PRN = 32: S1 = 3, S2 = 8
→shift 862
Output
selection
for register 2
Register 1
Register 2
Figure 5.44 Generation of the C/A codes using two 10-stage shift registers.
satellite uses its individual code, the satellite signals can be separated and a parallel decoding
of the corresponding navigation messages can be accomplished. A GPS receiver has to be
able to manage at least four parallel code channels. However, 12-channel receivers are also
available. Though the process of receiving messages from several satellites via different
code channels has some similarities to a soft handover, there is an essential difference:
for a soft handover the same data are transmitted by the involved base stations, while the
satellites transmit different navigation messages.
The second type of code, the P code, is used on the L1 and the L2 carriers mainly
for military applications. The very long P code of a length of about 2.4 · 1014 chips (about
266 days) is generated at a rate of rP = f0 = 10.23 Mchip/s, that is, at a rate that is 10
times the rate of the C/A code and therefore results in better time resolution. The P code may
be encrypted by a so-called secret W code to form the Y code which can only be decoded
by authorized users. The P or Y code is separated into 37 unique one-week segments. Each
satellite uses a satellite-speciﬁc segment that is restarted at the beginning of every GPS
week (Saturday midnight).
The overall spreading modulation process is illustrated in Figure 5.45. More details on
GPS can be found, for example, in (Hofmann-Wellenhof et al. 2001).
5.5.3
Overview of mobile communication systems
Before discussing some CDMA mobile communication systems in more detail, a general
overview is presented to explain the evolution of the most important standards.

358
CDMA
P (Y) code
C/A code
Data
bits
cos(
f1t)
sin(2p
2p
2p
f1t)
f0/10
f0
cos(
f2t)
–3 dB
– 6 dB
120 · f0
f1 = 154 · f0
f0 = 10.23 MHz
W code
f0/20
P code
f0
f1 = 154 · f0
Oscillator
Y code
Figure 5.45 Spreading and modulation for GPS.
Mobile communication systems are usually classiﬁed into a certain number of generations
as illustrated in Figure 5.46. The ﬁrst generation (1G) comprised of several incompatible
systems using analog transmission techniques for mainly speech services. In general, a roam-
ing between different countries was not possible. To overcome these as well as security
and capacity problems, standardization bodies in Europe, America and Japan developed the
following standards for public mobile communication networks:
• Global System for Mobile Communications (GSM, Europe)
• Digital American Mobile Phone System (DAMPS) or Interim Standard 136 (IS-136,
USA)
• Interim Standard 95 (IS-95), nowadays called cdmaOne (USA)
• Personal Digital Cellular (PDC, Japan).

CDMA
359
TD-CDMA
TD-SCDMA
DS:
WCDMA
MC:
cdma2000
FT:
DECT+
SC:
UWC-136
DS : direct sequence
FDD : frequency division duplex
FT : frequency time
TD : time division
MC : multi carrier
TDD : time division duplex
SC : single carrier
GSM
IS-136 /
D AMPS
PDC
IS-95 /
cdmaOne
IS-95 B
GPRS/
HSCSD
GSM-
EDGE
DECT
DECT/
DPRS
UMTS
TDD
3G:
IMT-2000
family
2.5G
evolution
of 2G
Several analog systems
2G
1G
Beyond 3G / 4G
Figure 5.46 Overview of mobile communication systems.
The ﬁrst releases of these standards were published between 1989 and 1994. Since then,
several hundred networks according to these standards were established all over the world
serving more than 1.3 billion subscribers (June 2004) as illustrated by Figure 5.477. During
the same time, standards for cordless telecommunications as the Digital Enhanced Cordless
Telecommunications (DECT) or the Personal Handy-phone System (PHS) evolved. The
main common features of these systems of the second generation (2G) are
• a digital transmission technique
• an enhanced network capacity
• speech and data services with data rates of about 10 kbit/s
• security mechanisms
• international roaming capabilities.
Between 1995 and 1998, the main focus for new releases of these standards was on creating
new data services allowing higher rates and a packet switched mode. The increase of the
data rate was accomplished by allocating several channels for one connection and by using
7The data of the Figure have been extracted from the internet pages of the GSM Association
(www.gsmworld.com) and of the CDMA Development Group (www.cdg.org) where the interested reader may
ﬁnd the recent statistics.

360
CDMA
0
200
400
600
800
1000
1200
Other
GSM
PDC
IS-136/D AMPS
IS-95/cdmaOne
cdma2000
WCDMA
Subscriber [millions]
2nd generation
3rd generation
TDMA
CDMA
Figure 5.47 Subscriber statistics (June 2004).
ﬂexible coding schemes as well as sophisticated ARQ schemes. For example, the GSM
standard was enhanced by two types of bearer services called High-speed Circuit Switched
Data (HSCSD) and General Packet Radio Service (GPRS) that offer data rates of up to
160 kbit/s (see e.g. (Steele et al. 2001)). Using higher-order modulation schemes as deﬁned
in the EDGE mode (Enhanced Data rates for GSM Evolution) of GSM, even data rates of
up to 500 kbit/s can be achieved. 2G systems with these increased data rate capabilities
are called systems of generation 2+ or generation 2.5, indicating that they represent an
evolutionary step from 2G to 3G systems.
For systems of the third generation (3G), the International Telecommunications Union
(ITU) set the following main requirements:
• capabilities for offering mixed services with various quality of service requirements;
• an enhanced network capacity with an efﬁcient usage of the frequency spectrum;
• data rates of up to 2 Mbit/s.
It should be noted that the data rate of 2 Mbit/s has to be achieved only in indoor en-
vironments; for pedestrian environments (city centers) and for a wide area coverage at a
high velocity of the mobile station data rates of 384 kbit/s and 144 kbit/s are required,
respectively (see e.g. (ETSI TR 101 112 1998)).
These requirements initiated a system selection process which proceeded in several
steps: in a ﬁrst step, different proposals (partly based on funded research projects) were
submitted to the standardization bodies of the respective regions where a preselection was
performed. These preselected proposals were further submitted to the ITU. After a har-
monization phase, a multimode concept was deﬁned selecting basically ﬁve transmission
modes that formed the IMT-2000 family of systems. IMT-2000 means International Mobile
Telecommunications in frequency bands at about 2000 MHz. Figure 5.48 shows the fre-
quency bands allocated to IMT-2000 by the ITU and their present usage in different regions
of the world. It should be noted that in the meantime further frequency bands have been

CDMA
361
GSM1800 DL
DECT
UMTS FDD
PHS
UL
DL
UMTS TDD
Satellite
Satellite
UMTS FDD UL
UMTS FDD UL
ITU
Europe
Japan
USA
PCS UL
PCS DL
1800
1900
2000
2100
2200
Frequency [MHz]
Bands for
IMT-2000
Figure 5.48 Frequency allocation for IMT-2000.
identiﬁed by the ITU for systems of the IMT-2000 family. The systems of the IMT-2000
family are listed on the top of Figure 5.46.
The Universal Mobile Telecommunication System (UMTS) originally has been proposed
by the European Telecommunications Standards Institute (ETSI). However, since countries
outside Europe also decided to introduce UMTS-like networks, the 3rd Generation Part-
nership Project (3GPP) was created in 1999 to harmonize the standardization activities.
Beside the ETSI, standardization organizations from the United States, Japan, Korea and
China are involved in the 3GPP. Within this speciﬁcation group, the radio access technol-
ogy is referred to as UTRA (Universal Terrestrial Radio Access). For UTRA two different
transmission modes have been speciﬁed: a frequency division duplex (FDD) mode using
pure CDMA and a time division duplex (TDD) mode using a combination of CDMA and
TDMA as the multiple access scheme. The FDD mode is based on a proposal originally
called the Wideband CDMA (WCDMA), whereas the TDD mode is based on the so-called
TD-CDMA proposal. Within the TDD mode a second submode has been speciﬁed, which
was submitted to the ITU by the Chinese standardization organization CWTS as Time
Division Synchronous CDMA (TD-SCDMA). While the WCDMA and TD-CDMA-based
modes use a chip rate of 3.84 Mchip/s and a carrier separation of about 5 MHz, the chip
rate for the TD-SCDMA mode is 1.28 Mchip/s at a carrier separation of about 1.6 MHz.
In the ﬁrst phase, UMTS networks are operated mainly in the FDD mode. UMTS networks
are and will be established in Europe and other countries with GSM as the 2G technology
as well as in Japan. Though the multiple access scheme and many details of the trans-
mission techniques of UMTS differ signiﬁcantly from those of GSM, some frame periods

362
CDMA
were adapted to facilitate a handover between UMTS and GSM networks. Furthermore,
some packet switching schemes and concepts for the core network were harmonized. In
this sense, UMTS may be viewed as a kind of evolution of GSM. More details concerning
UMTS can be found in Subsections 5.5.4 and 5.5.5.
In the United States, the preconditions for 3G mobile radio networks are more com-
plicated: 2G networks according to the three standards, GSM, IS-95 and IS-136 have been
established. Furthermore, these networks are operated for a main part in the frequency bands
that were originally allocated to IMT-2000 by the ITU. For this reason, concepts for a con-
tinuous reforming of the already used frequency bands have been considered within the 3G
standardization process. One evolutionary path starts from the IS-136 and the GSM/EDGE
technology to create the UWC-136 standard (UWC: Universal Wireless Communications)
using TDMA as the multiple access scheme. The starting point for the CDMA evolution
path to 3G is cdmaOne (IS-95) using a chip rate of 1.2288 Mchip/s and a carrier spacing of
1.25 MHz. For the corresponding IMT-2000 member cdma2000, a variety of transmission
modes is speciﬁed, which is based on these parameters. Some transmission modes use the
same chip rate (and carrier spacing) as cdmaOne, but different spreading factors and channel
coding schemes. For especially high rate services, the threefold chip rate (and carrier sepa-
ration) may be used in the UL. For the DL, a multicarrier concept has been deﬁned allowing
the transmission on three (or in future versions even more) parallel cdmaOne carriers. Fur-
ther details on cdmaOne and cdma2000 can be found in Subsections 5.5.6 and 5.5.7, respec-
tively. Standardization of cdma2000 is performed in a second 3GPP group called 3GPP2,
which is formed by standardization bodies from the United States, Korea, China and Japan.
To complete the discussion on the IMT-2000 family, it should be mentioned that an
evolution of the DECT standard also has been included as a member. However, DECT is
not intended to be used for a wide area coverage, but for indoor coverage where it offers
the required data rate of 2 Mbit/s.
Looking once more at Figure 5.46 and Figure 5.47, one observes that TDMA is by far
the dominating multiple access technology in 2G while for 3G networks CDMA plays the
dominant role. CDMA is used in 3G in three different modes:
• the classical direct sequence mode for UTRA FDD;
• a combination of TDMA and CDMA for UTRA TDD;
• as CDMA with an integrated multicarrier concept for cdma2000.
Within the IMT-2000 family, these modes are therefore denoted as DS-CDMA, TDD-
CDMA and MC-CDMA. Since the evolutionary path from cdmaOne to cdma2000 was
signiﬁcantly smoother than the one from GSM to UMTS, in 2004 more subscribers could
be found in cdma2000 than in UMTS networks.
More details on the standardization process for 3G mobile communication systems can
be found, for example, in (Holma and Toskala 2001; Konh¨auser et al. 2000; Steele et al.
2001).
5.5.4
Wideband CDMA
Within this subsection, an overview of the physical layer of the Wideband CDMA system,
which is speciﬁed as the UTRA FDD mode, is given. More details can be found, for

CDMA
363
example, in (Holma and Toskala 2001) or within the standardization documents quoted in
the following text.
Frequency allocation
As illustrated in Figure 5.48, the frequency bands 1920–1980 MHz (UL) and 2110–2170
MHz (DL) are allocated to the UTRA FDD mode based on WCDMA. Hence, totally there
are 12 frequency blocks of 5 MHz each for the UL and the DL. Since, in general, there are
several operators per network, typically only 1–3 duplex blocks are available per network.
For example, in Germany each operator has two duplex blocks. Within each block one
duplex carrier can be realized; hence, the standard carrier spacing is 5 MHz. However, the
standard allows some ﬁne-tuning by adjusting the carrier separation in steps of 0.2 MHz (see
e.g. (3GPP TS 25.104 2004; 3GPP TS 25.101 2004)). For example, an operator may choose
a more narrow carrier spacing of 4.4 MHz between his own carriers and therefore a wider
spacing with respect to carriers of other operators, as it is easier to control the interference
from adjacent carriers within the same network than that from foreign networks.
For a network rollout, the operators start in general with one duplex carrier per cell,
that is, the same frequency carrier is reused in each cell so that a soft handover is possible
within the complete network. To enhance the capacity, the operator can allocate a second
carrier to cells in regions with high load or he can build up a hierarchical network allocating
the second carrier to the additional microcells in hot spots. A typical frequency allocation
pattern is illustrated in Figure 5.49.
f1
f1
f1
f2
f1
f1
f1
f1
f2
f1
f2
f2
f2
f2
f2
f1
Macro cells:
- basic coverage
Frequency f1:
- basic coverage
Frequency f2:
- capacity enhancement
Micro cells:
- coverage in
hot spots
Figure 5.49 Typical UTRA FDD frequency plan using two carriers.

364
CDMA
BSC
BSA
BSB
MS1
s‘A
cα
s1
cn
MS2
MS3
MS4
s2
cm
s2
cm
s3
ck
s1
cl
Soft handover
Channelization
code c
Data symbol
rate rs
Scrambling
code s
- OVSF codes
with SF = rchip/ rs
- Separate connections
of one source
Chip rate
rchip = 3.84 Mchip/s
3.84 Mchip/s
- Gold codes
- To separate
different sources
s‘A
cβ
s‘B
cβ
s‘B
cγ
s‘C
cγ
s1
cn
Figure 5.50 The principle of spreading and code allocation within UTRA FDD.
Code allocation
Before explaining some more details on spreading and modulation within UTRA FDD, the
general principles on code allocation are sketched (see e.g. (3GPP TS 25.213 2004)).
UTRA FDD uses a ﬁxed chip rate of rchip = 3.84 Mchip/s; spreading is performed in
two steps as shown in Figure 5.50. The OVSF codes described in Subsection 5.1.3 are used
as channelization codes, that is, to separate different connections transmitted by one and
the same source. The source may be one BS having connections to many MSs or one MS
having several parallel connections; for example, the MS transmits user data and control
data on different code channels or it may use two or more code channels to enhance the data
rate. OVSF codes are allocated according to the rules mentioned in Subsection 5.1.3, where
the code length or spreading factor is chosen to match the length of one data symbol to be
spread. Hence, a rate matching of data symbols has to be performed (e.g. by puncturing
or symbol repetition) so that the relation rs = (3.84 Mchip/s)/SF for the symbol rate rs
can be fulﬁlled. In UTRA FDD, the following spreading factors and symbol rates can be
applied:
• UL: SF = 2m, rs = 2−m · 3840 ksym/s m = 2, 3, . . . , 8;
• DL: SF = 2m, rs = 2−m · 3840 ksym/s m = 2, 3, . . . , 9.
Since OVSF codes can only separate signals transmitted synchronously by one source,
a second spreading step is introduced to separate different sources. In the UL direction,

CDMA
365
essentially segments of Gold codes generated by shift registers corresponding to the fol-
lowing polynomials of degree 25 are used:
• PUL,1(X) = X25 + X3 + 1;
• PUL,2(X) = X25 + X3 + X2 + X + 1.
Segments of the corresponding m-sequences are combined to give a complex-valued se-
quence, which is subsequently truncated to the basic physical frame length of 10 ms, that
is, to 38,400 chips. The resulting sequences are called long scrambling sequences.
Alternatively, short scrambling sequences consisting of 256 chips may be allocated in
UL direction. These complex-valued sequences, which are derived from quaternary codes,
are speciﬁed to be used only in connection with interference cancellation to reduce its
algorithmic complexity (see e.g. (Bing et al. 2000)).
In both cases, there are many millions of UL scrambling codes.
Scrambling in DL direction is also performed using Gold codes, where the degree of
the generator polynomials is 18 as in this case:
• PDL,1(X) = X18 + X7 + 1;
• PDL,2(X) = X18 + X10 + X7 + X5 + 1.
Also for the DL two segments of each Gold code are combined to give a complex-valued
sequence, which is subsequently truncated to the basic physical frame length of 10 ms, that
is, to 38,400 chips. Not all, but only a part of these sequences consisting of 213 = 8192 codes
is used for DL scrambling. These 8192 = 64 · 8 · 16 codes are divided into 64 scrambling
code groups each consisting of eight scrambling code sets. Hence, totally there are 512
scrambling code sets which comprise 16 codes as illustrated in Figure 5.51. The ﬁrst code
in each set is called the primary scrambling code (PSC), the other ones the secondary
scrambling codes (associated with the respective PSCs). To each cell one and only one
scrambling code set is allocated in a way that avoids the usage of the same set in neighboring
cells, that is, code sets are planned with a high reuse distance. The grouping of sets is
psc1
ssc1,1
ssc1,2
...
ssc1,14
ssc1,15
psc2
ssc2,1
ssc2,2
...
ssc2,14
ssc2,15
psc8
ssc8,1
ssc8,2
...
ssc8,14
ssc8,15
psc512
ssc512,1
ssc512,2
...
ssc512,14
ssc512,15
psc505
ssc505,1
ssc505,2
...
ssc505,14
ssc505,15
Scrambling code group 1
Scrambling code group 64
psc: primary scrambling code
ssc: secondary scrambling code
Scrambling sets
One scrambling set per cell
Figure 5.51 Division of scrambling sequences into different groups and sets.

366
CDMA
important for cell selection, which will be explained in the following text. In a standard
conﬁguration, only the primary scrambling code is used within a cell; in any case it has to
be allocated to control channels that are broadcasted within the complete cell. One or more
secondary scrambling codes may be used in situations where the interference is low, for
example, when smart antennas are applied. In this case, the number of connections allowed
by the interference conditions may exceed the number of available OVSF codes within one
tree. Additional OVSF trees in one cell can be generated using the secondary scrambling
codes as a kind of root. Obviously, there is no orthogonality between different trees.
A peculiarity has to be observed for a soft handover: in UL direction, of course, only
one channelization and one scrambling code is used, which is known and adjusted in the
RAKE receivers of all involved base stations. However, in DL direction the involved base
stations use the same channelization code indeed, but different scrambling codes, namely,
their speciﬁc primary or secondary scrambling codes. Hence, the RAKE ﬁngers of the MS
in soft handover mode have to be fed with these different scrambling codes. Furthermore,
UTRA requires no synchronization of the base station transmission. Though the RAKE
receiver is able to handle moderate delays with respect to the different propagation paths,
at least a synchronization up to a level of some data symbols is necessary. On the other
hand, to keep the orthogonality of the channelization codes, the transmission is only allowed
to be shifted in steps of the maximum code length. Since OVSF codes of SF = 512 are
expected to be used very rarely, the step size for shifting the transmission in soft handover
mode has been set to 256 chips and some exemptions have been speciﬁed for connections
operating at an SF = 512.
Data transmission, channel coding and multiplexing
UTRA has been designed to allow a large variety of services with very different quality
requirements. Furthermore, besides the proper user data, a lot of system control data have
to be transmitted in an efﬁcient way. Therefore, various channel types and coding and
multiplexing schemes adapted to the individual needs have been deﬁned (see e.g. (3GPP
TS 25.211 2004)). From the point of view of communication layers, one distinguishes
transport channels and physical channels. Transport channels are characterized by the way
the data are transmitted, whereas the physical channels are characterized mainly by the
spreading scheme and the physical information they carry. Within the transport channels,
one distinguishes, for example,
• channels that carry broadcast data as system information (e.g. network and cell
identity);
• channels that are used as common control channels for establishing a connection
(paging, random access, channel allocation);
• dedicated channels that are allocated for an individual connection;
• shared common channels that are used for packet transmission modes using special
medium access and collision resolution schemes.
On the physical layer many different tasks have to be fulﬁlled, for example,
• transmission of pilot symbols for channel estimation;

CDMA
367
• dedicated transmission of user data or higher-layer control data;
• dedicated transmission of physical layer control data (e.g. power control commands,
individual pilot symbols);
• synchronization;
• shared transmission of packet data;
• providing capabilities for broadcast transmission and paging;
• providing capabilities for random access.
Totally, more than 10 types of physical channels have been deﬁned partly using very special
spreading schemes. In this section, we focus on the main channels.
First, the dedicated transmission of user and control data is considered, which is per-
formed via the dedicated channel (DCH) as the transport channel and via the dedicated
physical data or control channel (DPDCH or DPCCH) as the underlying physical channel.
It should be emphasized that data from different applications may be multiplexed on one
DPDCH. On the other hand, one higher-layer connection may use more than one DPDCH
to increase the data rate.
As a ﬁrst step in the multiplexing and channel coding chain, CRC bits may be attached to
the higher-layer data frames where block codes with 24, 16, 12 and 8 CRC bits are deﬁned.
Subsequently, convolutional coding or turbo coding is applied. Convolutional coders of rate
1/2 and 1/3 and constraint length 9 are used. Turbo coding of rate 1/3 is accomplished
by a parallel concatenated convolutional code (compare Subsection 3.2.5) with two 8-state
constituent encoders and internal interleaver (see e.g. (3GPP TS 25.212 2004)).
Having adapted the data volume to the size of radio frames, an interleaving over 20, 40
or 80 ms frames depending on the delay constraints of the respective services is performed.
Before multiplexing various connections to one physical channel, a rate matching mecha-
nism taking into account the different quality of service requirements is necessary, since all
symbols are transmitted at the same power. Rate matching is performed by three methods:
• code puncturing (DL and UL)
• repetition of symbols (DL and UL)
• discontinuous transmission (only DL).
Subsequently, the matched and multiplexed data are mapped to one or more DPDCHs using
a segmentation into and a second interleaving over the basic radio frames of 10 ms. The
data structure for the dedicated channel on a radio frame is illustrated in Figure 5.52. There
is a remarkable difference between UL and DL: while in DL direction user data and physical
control data are time multiplexed using the same channelization code, in UL direction these
data are separated by using different channelization codes. The reason for this is explained
later. Each radio frame is subdivided into 15 slots, which are not used for time multiplexing
of several connections but to achieve a high transmission rate of 1500 Hz for the physical
control data (see e.g. (3GPP TS 25.211 2004)). These control data consist of
• transmission power control (TPC) bits indicating whether the transmission power
shall be increased or decreased for the next slot;

368
CDMA
Slot: 2560 chips, 2560 / SF bits
SF = 2m (m = 2, 3, ..., 8)
0
1
2
3
4
5
6
7
8
9
10 11 12 13 14
TFCI
TPC
Pilot
Data 1
Data 2
DL: time multiplexing of user and control data
Slot
Radio frame: 10 ms
0
1
2
3
4
5
6
7
8
9
10 11 12 13 14
Data
TFCI
TPC
Pilot
FBI
2560 chips = 10 bits
SF = 256
Slot
Radio frame: 10 ms
FBI:
feed back information
TFCI: transport format combination indicator
TPC:
transmission power control
Slot: 2560 chips, 2560 / SF symbols
SF = 2m (m = 2, 3, ..., 9)
UL: code multiplexing of user and control data
Figure 5.52 Data structure of a UTRA FDD radio frame.
• pilot symbols for an individual channel estimation;
• feedback information (FBI) that allows a closed-loop transmit diversity scheme (ad-
ditionally deﬁned besides the open-loop scheme explained in Subsection 2.4.7);

CDMA
369
• a transport format combination indicator (TFCI), which provides information for the
receiver on the used rate matching and multiplexing scheme.
It should be noted that in DL direction there are also common pilot channels (CPICH). The
primary common pilot channel (P-CPICH) is transmitted within the whole cell
• to support phase tracking and channel estimation for dedicated channels;
• to serve as a phase reference and to allow channel estimation for common channels
not carrying individual pilot symbols;
• to serve as a beacon for neighbor cell measurements (handover).
In addition, secondary common pilot channels may be allocated if the cell is divided into
several subsectors using switched beams techniques, that is, different secondary common
pilot channels are assigned to different subsectors. Scrambling of the common pilot channels
is performed by using the primary and secondary scrambling sequences, respectively. The
channel-speciﬁc DL pilot symbols are needed when full adaptive smart antenna techniques
are applied resulting in individual propagation channels for the different connections.
Spreading and modulation of dedicated channels
Spreading and modulation for UTRA FDD is speciﬁed in (3GPP TS 25.213 2004). As
mentioned above, there are some differences between data transmission in UL and DL
directions, not only with respect to multiplexing of user and control data, but also with
respect to spreading and modulation.
The main reason for this is that in UL direction a nearly equal transmission power is
desirable to avoid disturbing pulsed transmissions with audio frequencies and to relax the
requirements on the linearity of the MS power ampliﬁer. This is accomplished within two
steps as shown in Figure 5.53: Multiplexing user and physical control data on different
codes in a ﬁrst step guarantees that there is at least a continuous transmission of control
data even in phases where no user data have to be transmitted, for example, in phases of no
speech activity. In a second step, the control data are phase shifted by 90◦(multiplication
by j) and added to the user data stream; the sum is then multiplied by a complex-valued
scrambling code. By this method, control and user data symbols are distributed to both the
I- and the Q-branch of the subsequent I/Q modulator (chip modulation). Since the complex-
valued scrambling code is constructed in such a way that there is at most a phase change
of +90◦or −90◦between consecutive chips, zero transitions are largely avoided except for
a symbol change. Finally, some notes on UL spreading and modulation for the dedicated
channel are listed as follows:
• The data channels and the control channels may use different power weights.
• For the control data, the spreading factor SF = 256 and the channelization code c256,0
are used.
• The spreading factor of the DPDCH may change from frame to frame between 4 and
256. However, the channelization codes shall be taken from a ﬁxed branch of the
code tree disjoint from the 0-branch occupied by the control channel.

370
CDMA
cSF, k
DPDCH1
bd
c256, 0
DPCCH
bc
sn
Additional dedicated
physical channels
Additional dedicated
physical channels
Power
weighting
Complex-valued
scrambling code
j
User data
Control data
Chip
modulation
Channelization
code
cSF, k‘
DPDCHm
bd
cSF, k‘‘
DPDCHm+2
bd
Figure 5.53 Spreading of user and control data for the UL.
• Up to ﬁve additional DPDCHs may be allocated to one connection to increase the
data rate if all other methods for an enhancement are exhausted; these channels are
mapped to I- and Q-branch in an alternating way. In this case, only the spreading
factor SF = 4 is allowed with the channelization codes c4,1, c4,2, c4,3.
• In a recent version of UTRA FDD, also an additional control channel corresponding
to high-speed packet data channels can be transmitted.
• For pulse shaping a root-raised cosine ﬁlter with a roll-off factor of 0.22 is used (see
e.g. (3GPP TS 25.104 2004; 3GPP TS 25.101 2004)).
In DL direction, in general, many channels are transmitted by the BS. Hence, even if
discontinuous transmission is applied, transmission power is expected to vary only smoothly
due to averaging effects. Furthermore, using an extra channelization code for the control
channel of each connection would set too many constraints to code allocation. Hence, in
DL direction a different spreading and modulation strategy illustrated in Figure 5.54 is
chosen. The ﬁrst step is a modulation mapping: for a standard dedicated channel (DCH),
pairs of subsequent data bits are mapped to the I- and Q-branch according to a QPSK;

CDMA
371
cSF1, k1
sn
j
g1
Downlink physical channel 1
Modulation
mapping
g2
Downlink physical channel 2
gp
P-SCH
gS
S-SCH
Synchronization
channels
Chip
modulation
Power
weighting
Channelization
Scrambling
Figure 5.54 Downlink spreading for UTRA FDD.
for a high-speed packet data channel, quadruples of bits and a mapping according to 16-
QAM may be used. The I- and Q-branch is then spread by the same channelization code.
Afterwards, the signal is scrambled with a cell-speciﬁc complex-valued scrambling code.
Chip modulation is performed in the same way as for the UL.
• Each channel transmitted by the BS can be weighted with an individual power value.
• Some channelization codes are reserved for special channels as c256,0 for the common
pilot channel and c256,1 for the common control physical channel (system information,
paging, channel assignment). All other channelization codes can be allocated in a
ﬂexible way.
• Since a coordination of many connections is required for the DL, the spreading factor
cannot not changed on a frame-by-frame basis as in UL direction, but at a lower rate.
• The channels needed for synchronization of the MSs and for cell search are handled
in a special way.
Cell search and synchronization
The ﬁrst task an MS has to perform after it has been switched on is to search for an
appropriate cell to camp on. As a precondition the MS has to synchronize to the frame and
slot period of the respective BS and it has to ﬁnd out the allocated scrambling code to be
able to decode the system information sent via the broadcast channel. Since it is very time
consuming to test and correlate to hundreds of scrambling codes, the cell search is divided

372
CDMA
P
Primary synchronization code word (uniquely specified within UTRA-FDD)
n
nth of 16 different secondary synchronization code words (n = 1, 2, ..., 15, 16)
P
P
P
P
P
P
P
P
P
P
P
P
P
P
P
1
1
2
8
9
10
15
8
10
16
2
7
15
7
16
Radio frame (10 ms, 15 slots)
Transmission
in each slot
BCH data
18 bits (2560 – 256) chips
Spreading factor SF = 256
Primary scramblingcode of the cell
PSC
word
256 chips
Slot
Other common control data
(2560 – 256) chips
8th SSC
word
256 chips
Figure 5.55 Code words for synchronization and cell search.
into several steps to speed it up. Furthermore, it should be noted that the transmissions of
base stations at different sites are not synchronized in general. For this reason, two types
of synchronization code words consisting of 256 chips have been deﬁned as illustrated in
Figure 5.55:
• The primary synchronization code word (PSCW) is a code word with good aperiodic
correlation properties, which is uniquely deﬁned for UTRA FDD (see e.g. (3GPP TS
25.213 2004)). It is classiﬁed as a generalized hierarchical Golay code. The PSCW
is transmitted in each slot without scrambling in front of the broadcast channel data.
• The 16 secondary synchronization code words (SSCW) are derived from Walsh–
Hadamard sequences (see e.g. (3GPP TS 25.213 2004)). These SSCWs are transmitted
without scrambling in each slot in front of the forward access channel data in a
characteristic order (the forward access channel is used to assign a speciﬁc code
at a connection setup). 64 disjoint sequences, each consisting of 15 SSCWs, are
deﬁned and are in one-to-one correspondence with the 64 primary scrambling code
groups deﬁned above. The respective sequence of SSCWs is repeated in each frame
(consisting of 15 slots) of the cell.
As a ﬁrst step within the cell search procedure (see e.g. (3GPP TS 25.214 2004)), the
MS detects the PSCWs and synchronizes to the slot period of the cell with the strongest
received signal. Subsequently, the sequence of SSCWs is detected. Since the sequences are
constructed in a way that also a cyclic shift of one sequence is disjointed from a cyclic

CDMA
373
shift of any other sequence, the mobile can derive both the start of the frame within the
cell and the PSC group the cell belongs to. Hence, the MS has to correlate only to the eight
primary scrambling codes of that group to ﬁnd out the scrambling code allocated to that
cell. Subsequently, the system information can be descrambled and decoded.
Random access
To setup a connection, the MS has to request for transmission resources, especially for a
scrambling code to be allocated to the UL of that connection. The procedure for establishing
the ﬁrst contact with the network has to handle the following challenges:
• Because of the propagation delay the MS is not completely synchronized to the BS
in UL direction, that is, a data packet received from the MS may not exactly match
the frame or slot period of the BS.
• Since the MSs try to access the network in an uncoordinated way (random access),
channel requests may collide and a collision resolution strategy has to be deﬁned.
• Before a successful random access no speciﬁc code is allocated to the MS. Further-
more, a random access signal interferes with other already established connections in
the cell. Hence, its signal power has to be on the one hand high enough to be detected,
but on the other hand low enough to restrict the interference to other connections.
• Since in a CDMA network frequencies are reused generally in neighboring cells, care
has to be taken that the random access signal is only interpreted by the appropriate
BS.
While the ﬁrst two challenges also exist in TDMA networks, the last two are CDMA-
speciﬁc ones. The UTRA FDD solution uses the following ingredients (see e.g. (3GPP TS
25.214 2004)):
The random access message is split into a preamble and a proper message part con-
taining information on the requested resources. The preamble – carrying no higher-layer
information – consists of 4096 chips called the preamble signature sequence. Totally there
are 16 signature sequences obtained by repeating Walsh–Hadamard codes of length 16;
the repetition factor is 256. For signature scrambling, a subset of the long scrambling se-
quences speciﬁed for the UL is used. Since a one-to-one correspondence between signature
scrambling sequences and DL primary scrambling sequences has been ﬁxed, the destina-
tion (cell) of a preamble can be derived. Preambles are only allowed to be transmitted
in certain periods given by the BS; such a random access period consists of two slots
(2 · 2560 chips). For the ﬁrst time, the MS transmits the preamble with a randomly selected
signature sequence at a low power value, which is derived by an open-loop power control
procedure based on the received common pilot channel signal and other parameters. If
no acquisition indication from the BS is received within a certain time interval, the MS
repeats the preamble transmission with a power increased by a certain step. Otherwise,
the acquisition indication (echoing the preamble signature) is interpreted by the MS as a
kind of acknowledgment that the BS has decoded the preamble and is ready to receive the
proper random access message part. Transmitting the message, only speciﬁc channelization
codes and scrambling sequences are allowed to enable the BS to despread the message.

374
CDMA
The channelization code may only be selected from a branch related to the signature of the
preamble; a correspondence between signatures and branches of the code tree is deﬁned in
the standard. The scrambling sequence is derived from the same long sequence as applied
for the preamble. However, another segment of this sequence is used.
Obviously, there is a limitation on the maximum number of retransmissions of the
preamble as well as on the maximum allowed transmission power. If one of these limits is
reached, the access procedure is aborted.
Power control
Within UTRA FDD a fast closed-loop power control with a rate 1500 Hz is speciﬁed for
the UL as well as for the DL (see e.g. (3GPP TS 25.214 2004)). On the basis of the
measurements of the SIR, a certain SIR target (set by a slow outer loop mechanism) is
tried to be achieved. Depending on whether the received SIR within a slot is lower or
higher than the target, the transmitter is commanded (using the PCI bits in the next slot)
to increase or decrease its transmit power by a certain PC step. The effective PC step per
slot may be 0.5, 1.0 or 2.0 dB and is set by higher-layer information ﬁelds.
For the call setup phase (random access) and the transmission of short packets, an open-
loop PC has been deﬁned. Furthermore, special rules are speciﬁed for the slotted mode and
the soft handover. For a soft handover, different PC commands may be transmitted by the
involved base stations and the MS has to resolve this situation.
Obviously, fast PC is not allowed on common channels like, for example, the common
pilot channel or the broadcast channel.
Handover
Within UTRA FDD, two main types of handover are speciﬁed:
• a soft handover between cells using the same frequency carriers;
• a hard handover between cells using different frequency carriers.
For a hard handover, one further has to distinguish between a hard handover within UTRA
FDD, for example, in a hierarchical cell structure, and a hard handover between cells of
different systems, for example, between UTRA FDD and GSM or UTRA TDD cells.
As mentioned in Subsection 5.1.4, for a soft handover one has to ﬁnd a compromise
between its gain and its effort by restricting the so-called active set, that is, the set of cells
involved in a handover for a certain connection. In UTRA FDD, the number of cells in
the active set can be limited. Furthermore, a new cell is only included in the set of active
cells if the corresponding averaged received signal level is not far below the best averaged
level. The meaning of not far below is ﬁxed by a hysteresis margin. Level measurements
are performed using the primary pilot channels of the respective cells.
A soft handover in DL direction results in an increased interference level for other
connections if power is transmitted from all base stations in the active set. To reduce the
interference, a method called site selection transmit diversity power control is foreseen
in UTRA FDD as an option: the MS measures the signal levels with respect to all pri-
mary pilot channels of the active set. The cell with the best level is indicated to all base
stations of the active set by “misusing” the FBI ﬁeld of the dedicated physical control

CDMA
375
channel. Having received this information, the transmission of the dedicated channel is
switched off by all cells of the active set except for the strongest one. Obviously, this
feature can only be active if no closed-loop transmission diversity requiring the FBI is
used.
While a soft handover can be managed using the multiple ﬁngers of the MS RAKE
receiver, additional means are required for a hard handover between different frequency
carriers. To perform measurements, either an additional measurement receiver is needed or
the so-called slotted or compressed mode has to be applied. In this mode, data transmission
is compressed to shorter intervals to gain some time for measurements on carrier frequencies
different from the present one. Compression can be achieved by
• a reduction of the data rate by higher layers,
• transmitting the data at twice the original rate using half the spreading factor and
• increasing the puncturing.
By these methods, several idle slots per frame can be produced.
5.5.5
Time Division CDMA
A part of the spectrum allocated to IMT-2000 by the ITU consists of unpaired frequency
bands and is therefore not suited for operation within the FDD mode. For this reason,
also a TDD mode for UTRA has been speciﬁed. The TDD mode has been derived from a
system proposal called TD-CDMA that combines time division and code division multiple
access. The original idea behind this proposal submitted to the ETSI was to reduce the
number of intracell interferers by dividing a frequency carrier into several disjoint time
slots and thereby having only a few code channels per time slot. Since there are only
a few interfering connections within a cell, these can be jointly detected and separated
with a moderate calculation complexity. Since the speciﬁc joint detection (JD) algorithm
was an essential ingredient of the system proposal, it also was called JD-CDMA. Having
selected TD-CDMA as a TDD mode for IMT-2000, it has been harmonized to WCDMA,
for example, the chip rate has been chosen to be the same (3.84 Mchip/s). There are many
further similarities which are mentioned below.
Besides the ETSI contribution TD-CDMA, another proposal called TD-SCDMA (Time
Division Synchronous CDMA) using a lower chip rate has been submitted to the ITU by the
Chinese standardization organization. After a harmonization phase, this proposal has been
included in the UTRA TDD standard as a second option with a chip rate of 1.28 Mchip/s.
Besides this lower chip rate, a slightly different TDMA frame structure has been deﬁned
including periods for special physical channels to accomplish a fast random access and a
synchronization for the UL transmissions.
However, except for the different chip rate, channel coding, spreading and modulation
are very similar in both submodes. Therefore, the following discussion focuses on the
transmission mode with 3.84 Mchip/s.
Within this subsection, an overview of the physical layer of the UTRA TDD mode is
given. More details can be found, for example, in (Baier et al. 2000; Holma and Toskala
2001; Steele et al. 2001) or within the standardization documents quoted in the following
text.

376
CDMA
Frequency allocation
The spectrum allocated to IMT-2000 contains 11 unpaired blocks of 5 MHz, namely, in
the bands 1880–1920 MHz and 2010–2025 MHz (see e.g. (3GPP TS 25.102 2004; 3GPP
TS 25.105 2004)). A part of them is foreseen for licensed operation in public networks,
another part for unlicensed operation in private networks.
In Germany, for example, (nearly) each UTRA operator has acquired one TDD carrier
besides his two FDD duplex carriers. Hence, he may use this additional TDD carrier for
capacity enhancement, especially in regions with a highly asymmetric data trafﬁc demand.
The division of a carrier into UL and DL time slots can be adapted to the corresponding
capacity requirements.
However, as mentioned in Subsection 5.1.4, a synchronization of nearby TDD base
stations is needed to avoid very critical interference situations. Within the network of one
operator, synchronization may be accomplished via the radio network controller (RNC)
using some special protocols deﬁned for the TDD mode. However, synchronization of base
stations of different operators or of base stations for unlicensed operation is not achievable.
Therefore, at least for these situations a dynamic channel selection feature (see e.g. (Bing
et al. 2000; Holma and Toskala 2001)) similar to the one speciﬁed for DECT is needed.
Code allocation
As for the FDD mode, code allocation is performed in two steps using OVSF channelization
codes and cell-speciﬁc scrambling sequences (see e.g. (3GPP TS 25.223 2004)). OVSF
codes are selected according to the code tree of Subsection 5.1.3. 128 scrambling sequences
consisting of 16 complex-valued chips are deﬁned by code tables. The sequences are divided
into 32 groups and are allocated to cells in a way that nearby cells use a scrambling sequence
from different groups. Hence, scrambling codes are much shorter than for the FDD mode.
Furthermore, there are much less scrambling sequences that allow only a separation of
different cells, but not a separation of different connections. Hence, in UL direction the
OVSF codes together with the joint detection mechanism also have to be used to distinguish
different connections. In UL direction, OVSF codes with spreading factors SF = 1, 2, 4, 8,
16 are applied observing the allocation rules mentioned in Subsection 5.1.3. In DL, only the
spreading factors SF = 16 (standard case) and SF = 1 (high data rates) are used. However,
multiple (orthogonal) code channels with SF = 16 can be allocated to one connection in
order to achieve higher data rates.
Data transmission, channel coding and multiplexing
Similar types of transport and physical channels as for the FDD mode are deﬁned for the
TDD mode. The main difference is that there is no common pilot channel since channel
estimation is performed using training sequences that are included within the data bursts.
As to multiplexing and channel coding, the same principles and methods as for the FDD
mode are applied (see e.g. (3GPP TS 25.221 2004; 3GPP TS 25.222 2004)).
Also the length of the basic physical frame has been ﬁxed to the same value, namely,
10 ms. A frame is divided into 15 time slots, which are used to separate connections, that
is, for the time division multiple access scheme. Connections using the same time slots can
be further separated by different codes as explained below. As illustrated in Figure 5.56

CDMA
377
Time slot: 2560 chips
SF = 1, 2, 4, 8, 16
0
1
2
3
4
5
6
7
8
9
10 11 12 13 14
0
1
2
3
4
5
6
7
8
9
10 11 12 13 14
0
1
2
3
4
5
6
7
8
9
10 11 12 13 14
0
1
2
3
4
5
6
7
8
9
10 11 12 13 14
8 : 7
1 switching point
8 : 7
7 switching points
14 : 1
1 switching points
2 : 1
5 switching points
DL
UL
0
1
2
3
4
5
6
7
8
9
10 11 12 13 14
Data
Data
GP
Midamble
TFCI (and TPC) bits
Guard
period
DL & UL
TDMA frame: 10 ms
Figure 5.56 Variable time duplex division scheme and data structure for UTRA TDD.
time slots can be divided into UL and DL slots in a very ﬂexible way using even multiple
switching points between UL and DL.
Within one time slot of length 2560 chips, data are transmitted as so-called bursts. A
burst consists of three parts:
• a guard period of a length of 96 or 192 chips where transmission is switched off to
separate connections using different time slots;
• a midamble or training sequence of 256 or 512 chips for channel estimation;
• a data part including user data and physical layer control data as the transport format
combination indicator (TFCI) or the transmit power control bits.
The longer guard period of 192 chips is used in UL direction for a random access or
a handover access to a new base station, that is, before the MS transmission is exactly
synchronized to the respective BS.
Within UTRA TDD, 128 long (512 chips) and 128 short (256 chips) training sequences
have been deﬁned, which are in one-to-one correspondence with the scrambling sequences,

378
CDMA
that is, the short and long training sequences corresponding to the cell-speciﬁc scrambling
code is allocated to the respective cells. MSs within one cell transmitting on the same time
slot use cyclically shifted versions of the respective long or short training sequences. A
cyclic correlator allows a joint channel estimation of all UL connections on a time slot and
this is the ﬁrst step for the joint detection algorithm (see e.g. (Baier et al. 2000; Bing et al.
2000)). Obviously, the shift has to be greater than the maximum propagation delay value
expected within the operational environment. In an environment with a low delay spread,
up to 16 MSs may transmit on the same time slot using the long training sequence. In DL
direction, the identical training sequence (without any shift) may be used for all connections
on a time slot in a cell. However, if smart antenna techniques are applied, beam individual
training sequences have to be assigned.
Spreading and modulation of dedicated channels
While in the FDD mode slightly different spreading and modulation schemes are applied for
the UL and the DL, the TDD mode uses essentially the FDD DL scheme in both directions
(see e.g. (3GPP TS 25.223 2004)), that is, data bits are grouped into pairs (or quadruples) and
are mapped according to a QPSK (or a 16-QAM for high-speed packet data transmission) to
the I- and Q-branch of a modulator, where they are ﬁrst multiplied by a (real) OVSF code
as a channelization code and afterwards by a complex multiplier depending on the selected
channelization code. Subsequently, scrambling with a cell-speciﬁc code is performed. The
resulting chip sequence is modulated in the same way as for the FDD mode.
Cell search and synchronization
Cell search is based upon the same code words that are also used in the FDD mode, namely,
the unique system-speciﬁc primary and 16 secondary synchronization code words (see e.g.
(3GPP TS 25.223 2004; 3GPP TS 25.224 2004)). However, owing to the TDMA nature of
the TDD mode they are applied in a slightly different way.
• They are not transmitted within each slot, but only within one or two slots of a frame
which we call the synchronization channel (SCH) time slots. Note that the code words
have a length of 256 chips, whereas the length of a time slot corresponds to 2560
chips.
• A certain time offset between the start of the time slot and the start of the code words
is used, which is related to the code group of the respective cells. Since cells in a
public TDD network should be synchronized to avoid critical BS–BS or MS–MS
interference situations, an SCH in one cell may mask the SCH in a neighboring cell
if both channels are transmitted completely synchronously. To reduce this effect, the
time offset is introduced.
• Parallel to the primary synchronization code word, not only one but three out of the
16 secondary synchronization code words are transmitted. Each of these three code
words is multiplied by a complex-valued data symbol. Detecting the code words and
the corresponding data symbols, the scrambling code group of the cell, the time off-
set, the slot number of the SCH and the slot number of the broadcast control channel
carrying further system information can be derived.

CDMA
379
In a ﬁrst step, the MS detects the strongest cell and its timing using, for example, a matched
ﬁlter that is matched to the primary synchronization code word. On the basis of this timing
information, the received signal is correlated to the SSCWs. By this process, the scrambling
code group of the cell and some further information mentioned above can be derived. In a
next step, the MS is able to descramble the broadcast channel correlating the signal to the
four scrambling codes of the known code group.
Random access
At least one time slot has to be allocated in UL direction for the random access procedure
(see e.g. (3GPP TS 25.224 2004)). In contrast to the UTRA FDD mode, no preamble but
only the proper random access message is sent. The message is spread by OVSF codes of
spreading factor SF = 8 or SF = 16; which OVSF codes are allowed is broadcasted by
the BS. Furthermore, there is a one-to-one correspondence between the used channelization
code and the cyclic shift of the training sequence. For transmitting a random access message,
the MS selects an allowed OVSF code and a related midamble shift value randomly. The
message is transmitted at a power level derived by an open-loop process without timing
advance. The message does not arrive at the BS at the beginning of the random access
time slot, but with a certain propagation delay that can be measured by the BS. Having
received and decoded the message, the BS allocates a dedicated channel. Furthermore, the
MS may be commanded to adjust its transmission timing in steps of four chips (about 1 µs)
to synchronize the UL transmission for allowing shorter guard periods.
Power control
As mentioned in Subsection 5.1.4, a CDMA system affected by a high degree of intracell
interference requires a fast and exact UL power control. Since in a TDD system there is no
continuous transmission in UL and DL direction, the high-power control rate of 1500 Hz of
the FDD mode cannot be preserved in the TDD mode. In an adverse conﬁguration, the rate
may reduce to 100 Hz (one PC action per TDMA frame) with a high delay between the
measurement and the corresponding power control command. To circumvent this problem,
the joint detection mechanism is foreseen, which allows a separation of different code
channels even if there is no perfect fast UL PC. On the other hand, since UL and DL use
the same carrier frequency and there is a control delay anyway, an open-loop PC can be
applied in UL direction (see e.g. (3GPP TS 25.224 2004)). Therefore, the MS measures
the received signal level from the broadcast channel, which is transmitted at a constant
known power one or two times a physical frame. From these values, the path loss can
be derived. Knowing also the UL interference level (whose value is broadcasted by the
BS), the MS is able to adjust its transmit power to approximately achieve a target SIR.
In DL direction, open-loop PC cannot be applied since there is no unique UL reference
transmitter. Therefore, a closed-loop PC analogous to the one for the FDD mode (but with
a lower rate) is used.
Handover
Within UTRA TDD, handover is managed as a hard handover, that is, the active set consists
of only one cell. However, due to the TDMA structure, the MS is able to perform neighbor

380
CDMA
cell measurements without requiring an additional measurement receiver or a compressed
mode – at least for low and medium rate services where only a part of the time slot is
needed for data transmission and reception. Hence, though no soft handover is applied and
no signals are combined, the hard handover can be performed very fast on the basis of
continuous measurements by the MS.
5.5.6
cdmaOne
The ﬁrst cellular mobile communication system based on CDMA technology was designed
by a single company, Qualcomm Incorporated. This system has been further developed to
become the Interim Standard number 95 (IS-95) in 1994 in the United States. Networks
according to this standard are operated mainly within two frequency bands: in the so-called
US cellular band at about 850 MHz and in the so-called PCS (personal communication
system) band at about 1900 MHz. In 1997, IS-95 was rebranded as cdmaOne. It should be
noted that there are some (small) differences of the cdmaOne versions for the cellular and
the PCS band.
Within this subsection, an overview of the physical layer of the cdmaOne system is
given. More details can be found, for example, in (Steele et al. 2001) or within the stan-
dardization documents (J-STD-007 1999; TIA/EIA-95 1993).
Frequency allocation
As mentioned above two bands are used by cdmaOne in North America:
• the cellular band at about 824–849 MHz in UL and 869–894 MHz in DL direction8;
• the PCS band at about 1850–1910 MHz in UL and 1930–1990 MHz in DL direction.
These bands are divided into subbands and have to be shared by several operators so
that each operator may assign about 10 duplex carriers to his network. The typical carrier
spacing is 1.25 MHz.
Hence, the number of carriers per operator is in general signiﬁcantly higher than in
UMTS networks discussed above. Therefore, a cdmaOne operator may install several carri-
ers per cell or may even use a cluster size higher than K = 1. Furthermore, there are enough
carriers for implementing hierarchical cell structures. It should be mentioned, that – though
a cluster with K > 1 reduces the overall interference – a soft handover cannot be performed
between cells using different frequencies.
A main architectural difference compared to UMTS is that in cdmaOne networks the
base station controllers (BSC) are not interconnected. Hence, a soft handover is only pos-
sible between base stations belonging to the same controller, but not between base stations
belonging to different controllers. Hence, at the border between two BSC areas different
frequency carriers have to be allocated to avoid a strong mutual interference that cannot be
managed by a soft handover.
8To be consistent with the other sections and subsections, the notation downlink (DL) and uplink (UL) is used
throughout this and the next subsection though the standardization documents for cdmaOne and cdma2000 use
the notation forward link and reverse link instead.

CDMA
381
Code allocation
Within cdmaOne, three different types of codes are used:
• Walsh–Hadamard codes of ﬁxed length 64 as channelization codes for the DL and
as a basis for a Walsh modulation in UL direction;
• long PN sequences (m-sequences) corresponding to a 42-stage shift register to sepa-
rate different UL connections and to cipher the data stream in UL and DL direction;
• a pair of PN sequences corresponding to two 15-stage shift registers to provide a
cell-speciﬁc scrambling.
The chip rate for all these codes is rchip = 1.2288 Mchip/s.
In contrast to UMTS, no variable spreading factors are used. Therefore, instead of using
the OVSF codes, Walsh–Hadamard codes of ﬁxed length 64 are applied in cdmaOne as
channelization codes for the DL. In the UL, they have a completely different role: they
serve as a basis for 64-ary orthogonal Walsh modulation of the data symbols.
In UL direction, the signals transmitted by different MS are separated by long PN
sequences generated by a 42-stage shift register. The register is initialized by the so-called
channel mask which includes a kind of channel identiﬁcation number and a permuted
version of the equipment registration number of the respective MS (in case of a trafﬁc
channel). Additionally, this PN sequence may be viewed as a kind of ciphering stream
providing protection against eavesdropping. For this reason, the long PN sequences are
also applied in DL direction.
A cell-speciﬁc scrambling is achieved on the basis of a pair of sequences generated by
two 15-stage shift registers. One sequence is applied to the I-branch, the other to Q-branch
of a QPSK modulator; hence we call them sI and sQ. The two corresponding m-sequences
have a length of 215 −1 chips. An additional zero is added to the unique maximum run of
zeros to obtain a sequence length of 215 = 64 · 512. Observing that the chip rate may be
written as rchip = 215 · 75/2 Mchip/s, 75 periods of these sequences match exactly to 2 s.
This is not an accident but related to the fact that cdmaOne base stations are synchro-
nized to GPS timing. Using synchronized base stations facilitates the cell search and soft
handover procedure compared to UMTS which needs no synchronization. On the other
hand, the cdmaOne base stations have to be able to receive the signals from the GPS
satellites, which might be difﬁcult in street canyons or within buildings. On the basis of
synchronization a cell-speciﬁc scrambling is accomplished by using shifted versions of the
sequences sI and sQ. The shift has been deﬁned in multiples of 64 chips, which corre-
sponds to approximately 80 µs. Hence, by this method 512 different scrambling sequences
are derived, which are allocated to cells in a way that nearby cells use different sequences.
We recall that in UTRA FDD also 512 primary scrambling sequences have been deﬁned.
However, in addition, each primary sequence has 15 associated secondary sequences to
support smart antenna techniques.
Data transmission, channel coding and multiplexing
Within cdmaOne the following types of channels have been deﬁned:

382
CDMA
• A pilot channel for channel estimation and coherent detection in DL direction and
serving as a beacon for neighbor cell measurements.
• A synchronization channel transmitting, for example, the system time and the cell-
speciﬁc offset (shift) of the scrambling codes sI and sQ in DL direction.
• A paging channel transmitting paging messages as well as system information and
channel assignment messages in DL direction.
• A (random) access channel used by the MSs in UL direction for transmitting channel
request messages at a call initiation.
• Trafﬁc channels for user data transmission with different data rates.
Explaining the channel coding and multiplexing, we focus on the trafﬁc channel; channel
coding for the paging channels is quite similar. The other channels, their format and their
role will be discussed in the following text.
A trafﬁc channel carries user data as well as signaling data. Signaling and user data –
even from different services as speech and FAX – may be multiplexed on one physical
trafﬁc channel by using different parts of a data frame.
The cdmaOne standard offers two rate sets for the trafﬁc channels. As shown in
Figure 5.57 the corresponding data rates are some multiples of 1.2 kbit/s and 1.8 kbit/s,
respectively. The maximum data rate is 9.6 kbit/s in set 1 and 14.4 kbit/s in set 2.
In DL direction, a convolutional code of constraint length 9 and of rate Rc = 1/2 is
applied, which is punctured for the channels of the rate set 2. Subsequently, a bit repetition
is performed in a way that a rate of 19.2 kbit/s is achieved for all trafﬁc channels. To
equalize the transmitted energy per bit Eb for all channels of a rate set, the transmission
power will be reduced proportional to the repetition rate. Interleaving is performed over a
block of 384 bits corresponding to the basic physical frame length of 20 ms. As illustrated
at the bottom of Figure 5.57 each frame is divided into 16 power control groups (similar to
the 15 slots of an UMTS frame). In each power control group, a power control (PC) symbol
is transmitted replacing two coded data bits. The PC symbols indicate whether the MS shall
increase or decrease its transmit power. They are transmitted without power reduction at
quasirandom positions. The position in one group is derived from the long PN sequence
segment used in the preceding group.
In UL direction, convolutional codes of constraint length 9 and of rate 1/2 and 1/3 are
applied to the channels of the rate set 1 and 2, respectively. Subsequently, a bit repetition
is performed in a way that a rate of 28.8 ksym/s is achieved for all trafﬁc channels. The
symbols are interleaved over the frame length of 20 ms. Subsequently, a Walsh modulation
is performed mapping a group of six symbols to a Walsh–Hadamard code of length 64,
which results in a chip rate of 307 kchip/s. To compensate the bit repetition, not a continuous
power reduction is used as in the UL, but transmission is switched off completely for certain
parts of the frame. This means that only eight, four or two power control groups per frame
may be ﬁlled with data bits to be transmitted. The corresponding groups are selected in a
quasirandom way. The interleaving is adapted to this mechanism.

CDMA
383
2–n · 9.6 kbit/s
Convolutional
coder (rate ½)
Bit repetition
(2n – 1) times
Code
puncturing
Convolutional
coder (rate ½)
2–n · 14.4 kbit/s
19.2 kbit/s
2–n · 19.2 kbit/s
Traffic channel data rates
n = 0, 1, 2, 3
Block
interleaving
2–n · 9.6 kbit/s
Convolutional
coder (rate
)
Bit repetition
(2n – 1) times
Convolutional
coder (rate ½)
2–n · 14.4 kbit/s
2–n · 28.8 ksym/s
Traffic channel data rates
n = 0, 1, 2, 3
Block
interleaving
Walsh−Hadamard
modulation
1 3
28.8 ksym/s
28.8 · 64 / 6 kchip/s
= 307.2 kchip/s
Power level
reduction by
n · 3 dB
Multiplexing
of PC bits
Frame (20 ms) – 16 power control groups
Power control group (1.25 ms)
19.2 kbit/s
Random group
selection
Downlink DL
Uplink UL
Figure 5.57 Channel coding, rate matching and frame structure for cdmaOne.
Spreading and modulation
In UL direction, the trafﬁc channel data are ﬁrst spread by the MS-speciﬁc long PN se-
quence, which is generated at a chip rate of 1.2288 Mchip/s as shown in Figure 5.58. The
resulting chip sequence is transferred to both the I- and the Q-branch of a quadrature modu-
lator where it is scrambled in a unique system-speciﬁc way using the scrambling sequences
sI and sQ without any offset. Furthermore, the Q-branch is delayed by half the chip du-
ration Tc/2 to avoid the amplitude of the carrier signal passing through zero during phase
changes. Pulse shaping is speciﬁed by a spectrum mask. It should be noted that no pilot
symbols are transmitted, so that incoherent detection is used in UL direction.
Figure 5.59 illustrates that the channels in DL direction are separated by Walsh codes
of length 64 as channelization codes. The constant bit sequence of the pilot channel is
multiplied by the (constant) Walsh code W0 and is subsequently spread by the cell-speciﬁc

384
CDMA
sI
sQ
System-specific
scrambling
1.2288 Mchip/s
Traffic
channel
Long PN
generator
Traffic
channel
mask
307.2 kchip/s
1.2288 Mchip/s
Separation of
mobile stations
Tc/2
Delay
Figure 5.58 UL spreading and modulation for cdmaOne.
shifted version of the scrambling sequences sI and sQ in a quadrature modulator, that is,
effectively, only the cell-speciﬁc scrambling sequences are modulated. The synchronization
channel uses the Walsh code W32. Furthermore, there may be up to seven paging channels.
The remaining Walsh codes can be used by the trafﬁc channels. Hence, the number of
trafﬁc channels per cell is restricted to about 60 depending on the respective conﬁgurations.
However, as discussed in Subsection 5.1.4, the number of active connections is usually not
limited by the number of codes, but by the interference within the network. Before being
multiplied by a Walsh code, the trafﬁc channel data stream is scrambled using the long PN
sequence not to spread but to encrypt the data. The PN sequence is generated at a rate of
1.2288 Mchip/s. However, only each 64th chip is taken to match the data rate of 19.2 kbit/s,
that is, the sequence is decimated. Cell-speciﬁc scrambling is performed by using shifted
versions of sI and sQ in the two branches of a quadrature modulator. All channels are
individually power weighted, combined and modulated in the same way as for the UL. On
the basis of the pilot channel, a coherent detection is possible in DL direction. However,
in cdmaOne there is only one common pilot channel in contrast to UTRA FDD where
secondary and individual pilot channels allow an antenna beam–speciﬁc phase tracking
and channel estimation.
Cell search and synchronization
In contrast to UTRA FDD where a cell may be characterized by one of 512 different primary
scrambling sequences, only two scrambling sequences are used in cdmaOne. Different cells
can be distinguished by different offsets of these sequences sI and sQ. For an offset 0, the
start of each 75th period of the sequence matches exactly with the start of an even (GPS)
second. An MS is able to lock to a cell by using a correlator fed by these codes and by
varying the offset. The strongest peak of the correlator output is related to the cell best

CDMA
385
Wn
Traffic
channel n
Long PN
generator
sI
sQ
Traffic
channel
mask
gn
Channelization
(Walsh−Hadamard)
j
Cell-specific
scrambling
Power
weighting
19.2 kbit/s
1.2288 Mchip/s
Traffic channel Wp+1
Paging channel W1
Synchronization channel W32
Pilot channel W0
Paging channel Wp
Traffic channel W
Traffic channel W
n
n
Figure 5.59 DL spreading and modulation for cdmaOne.
suited to camp on. The corresponding offset (assigned to all DL channels of that cell) can
be used in the next step to descramble and decode the synchronization channel that carries
information on the system and network identiﬁcation, the system time, the absolute offset
value and the state of the long PN code generator. Especially, the last information is needed
to decode the paging channel to obtain further system information.
Random access
An access message, which may have a length of several physical frames, is coded, spread
and modulated in a way analogous to the trafﬁc channel data. The proper message is
preceded by several preamble frames consisting of logical zeros, which serve as a kind of
training sequence. The channel mask for the long code generator contains the cell-speciﬁc
pilot channel offset, a BS identiﬁcation number and an identiﬁcation number of the used

386
CDMA
access subchannel. Hence, the BS is able to separate access attempts generated in its own
cell area from attempts generated in neighboring cells.
To keep interference caused by access attempts (which may have a duration of more
than 100 ms) at a low level, a mechanism similar to the one described for UTRA FDD is
used: the ﬁrst access probe is sent at a relatively low transmission power derived from a
signal strength measurement on the DL pilot channel. If no acknowledgment is received,
the message is sent again with a power level increased by a certain step. This procedure is
repeated until the maximum allowed power level is reached.
Power control
As mentioned in the preceding section, a power control symbol is inserted in DL direction
in each power control group indicating whether the corresponding MS has to increase or
decrease its transmit power level by 1 dB. Hence, in UL direction a fast closed-loop power
control at a rate of 800 Hz is implemented on the basis of SIR measurements by the BS.
Furthermore, there is an open outer loop controlling the fast inner loop.
In DL direction, there are no power control symbols per group. However, the MS may
command the BS to increase or decrease the power level by inserting the corresponding
information into a data frame. Hence, the maximum rate for DL closed-loop power control
is 50 Hz. DL power control is based on measurements of the frame erasure rate.
At the initiation of a call, an open-loop power control is used.
Handover
A handover decision is mainly based on signal strength measurements performed by the
MS on the pilot channels of the serving as well as of the neighboring cells.
The preferred handover type in cdmaOne is the soft handover which can be applied
between cells using the same frequencies. In DL direction, it is managed by combining the
signals transmitted by the involved base stations within the RAKE receiver of the MS. In
UL direction, a selection on a frame basis is performed if the involved base stations are
located at different sites. A softer handover is implemented between collocated sector cells
by a maximum ratio combining of the received signals. With respect to their role in a soft
handover procedure, neighboring cells are separated into candidate, active and remaining
sets. To be a member of the candidate set, the received strength of the pilot channel of
that cell has to be above a certain level. A cell of the candidate set becomes a member of
the active set if the corresponding pilot signal strength exceeds that of another cell in the
active set by a certain margin.
A hard handover is required between cells at the border of a BSC area, in a hierarchical
cell structure or between cells of different systems (e.g. between cdmaOne and DAMPS). In
this case, the BS commands the MS to switch to the new frequency in the new cell. The BS
may require some assistance in the form of measurement reports for the candidate cells. To
perform these measurements, the MS needs an additional measurement receiver or it loses
a data frame during the measurements. No compressed mode is speciﬁed for cdmaOne.
5.5.7
cdma2000
As explained in Subsection 5.5.3, cdma2000 is a direct evolution of cdmaOne fulﬁll-
ing the ITU requirements for 3G mobile communication systems. To offer data rates

CDMA
387
of some Mbit/s and mixed heterogeneous services with very different quality require-
ments, a variety of coding, modulation and spreading schemes has been deﬁned while
preserving some fundamental methods and parameters of cdmaOne to guarantee a back-
ward compatibility.
Within this subsection, an overview of the physical layer of the cdma2000 system is
given. More details can be found, for example, in (Etemad 2004; Steele et al. 2001) or
within the standardization documents (3GPP2 C.S0002 2004).
Frequency allocation
Networks according to the cdma2000 standard are and will be operated partly in bands
that are currently allocated to cdmaOne networks. To allow a simple refarming9 of these
frequency bands, the chip rate and nominal carrier separation for cdma2000 have been
deﬁned as multiples of 1.2288 Mchip/s and 1.25 MHz, respectively. As mentioned in Sub-
section 5.5.3, cdma2000 is denoted as the multicarrier CDMA mode of the IMT-2000
family. This notation is related to the fact that a DL data stream may be multiplexed not
only on one, but also on 3, 6, 9 or even 12 cdmaOne carriers. The multicarrier concept of
cdma2000 should be clearly distinguished from what is usually understood as multicarrier
CDMA within scientiﬁc publications (see e.g. (Hanzo et al. 2003)). In a proper multicarrier
CDMA system, spreading sequences are applied in frequency domain and the chips are
mapped to individual OFDM subcarriers. Within cdma2000 no OFDM is applied and the
multiple DL carriers use the same spreading sequences.
For the current ﬁrst version of cdma2000, only the single and threefold carrier variant
have been speciﬁed, which are called the 1X and 3X mode, respectively. It should be noted
that the multicarrier mode is only applied in DL direction, whereas the wideband mode in
UL direction is based on a direct sequence spreading using a multiple of 1.2288 Mchip/s
as the chip rate. This is illustrated in Figure 5.60.
UL (1X)
UL (3X)
DL (3X)
DL (1X)
Frequency
Multicarrier
Direct sequence
3.6864 Mchip/s
1.2288 Mchip/s
Single carrier
Frequency
Figure 5.60 Transmission modes for cdma2000.
9Refarming of frequency bands means that frequency carriers of that band originally used by one system are
continuously transferred to a newer mobile communication system.

388
CDMA
Code allocation
Spreading within cdma2000 essentially is based on the same type of codes as used in
cdmaOne, namely,
• Walsh–Hadamard codes;
• long PN sequences (m-sequences) corresponding to a 42-stage shift register to sepa-
rate different MSs and to cipher the data stream in UL and DL direction;
• a pair of PN sequences corresponding to two 15-stage shift registers to provide a
cell-speciﬁc scrambling.
However, some modiﬁcations are introduced to offer more ﬂexibility with respect to the
data rate and the chip rate.
In contrast to cdmaOne, the Walsh codes are not of ﬁxed but of variable length similar
to the OVSF codes of UMTS to offer a variety of data rates. Furthermore, in UL direction
they are not only used for Walsh modulation but also to separate different physical channels
transmitted by one MS.
To accomplish a spreading in UL direction at the threefold chip rate, the long PN code
generator has been modiﬁed as shown in Figure 5.61. Furthermore, at this chip rate the pair
(sQ, sI) of PN sequences is generated in another way by using two disjoint segments each
of length 3 · 215 of one m-sequence which is derived from one 20-stage shift register. Using
the threefold length at the threefold chip rate means that 75 periods of these sequences have
exactly a length of 2 s as in the case of cdmaOne.
Hence, base stations in cdma2000 networks are also synchronized to GPS timing in
order to distinguish cells by a PN sequence offset and to accomplish an easy cell search
and soft handover mechanism.
Data transmission, channel coding and multiplexing
All of the channels deﬁned for cdmaOne are also found in cdma2000. For the basic channel
conﬁguration they are used with the same transport format, spreading and modulation
scheme as in cdmaOne to offer backward compatibility. However, some additional channels
Long code
generator 1
1.2288 Mchip/s
MUX
Tc1
Tc1
Tc1
1.2288 Mchip/s
Long code
generator 3
3.6864 Mchip/s
Delay by
one chip
Figure 5.61 Long code generator for the threefold chip rate in cdma2000.

CDMA
389
and transport formats have been speciﬁed to improve the link performance, to offer efﬁcient
packet switched modes and to increase the data rate.
For example, UL data transmission is accompanied by a pilot channel (similar to
WCDMA) to allow a coherent detection. Furthermore, power control indicator bits may
be multiplexed at a rate of 800 Hz to the UL pilot channel to accomplish a fast closed-loop
DL power control. In DL direction, several pilot channels per cell may be allocated, which
can be individually assigned to different beams in a smart antenna solution.
To increase the data rate, several trafﬁc channels may be assigned to one connection.
For a connection, one and only one so-called fundamental channel (FCH) is needed. This
fundamental channel can be identiﬁed with a trafﬁc channel deﬁned for cdmaOne. Hence,
it offers low data rates of up to 14.4 kbit/s. A data rate enhancement is achieved by addi-
tionally assigning one or more so-called supplemental channels (SCH) to the connection.
For these supplemental channels, a variety of transport formats (channel coding and punc-
turing schemes, interleaving length, spreading and modulation schemes) has been speciﬁed
to allow a multiplexing of services with very different quality and bandwidth requirements.
The maximum data rate on one supplemental channel is 307.2 kbit/s for the 1X mode and
1036.8 Mbit/s for the 3X mode. Special packet channel may achieve even higher data rates
of about 2–3 Mbit/s.
Within cdma2000, the following channel coding methods are deﬁned:
• block codes (Reed–Solomon codes in DL direction, mapping to Walsh codes in UL
direction);
• convolutional codes of constraint length 9 and of coding rates 1/2, 1/3, 1/4, 1/6;
• turbo codes of coding rate 1/2, 1/3, 1/4 and 1/5.
The coded bits may be punctured using a certain number of puncturing schemes. Interleaving
is performed over frames of length 5, 10, 20, 40 or 80 ms in contrast to cdmaOne where
only 20 ms frames are used.
Spreading and modulation
Different spreading and modulation schemes are deﬁned for cdma2000. Using the basic
channel conﬁguration, spreading and modulation are performed in the same way as for
cdmaOne. However, some enhancements are introduced to achieve higher data rates.
In DL direction, different channels are separated using Walsh codes of variable spreading
factors SF (length) as shown in Figure 5.62. It should be noted that instead of duplicating
the data symbols to the I- and Q-branch as for the basic conﬁguration, symbols are mapped
to the I- and Q-branch according to a QPSK; for packet data channels even a mapping
according to an 8-PSK or 16-QAM may be used. Cell-speciﬁc scrambling is performed in
the same way as for cdmaOne using the pair (sI, sQ) of PN sequences with a certain offset.
For the multicarrier mode (3X) the data symbols are cyclically demultiplexed to three
symbol streams corresponding to the three carriers as shown in Figure 5.63. Spreading of
the data symbols of one transport channel is performed by using the same Walsh code and
spreading sequence on each carrier. The three carrier signals may be transmitted via separated
antennas to achieve an additional diversity gain. A pilot channel is assigned to each carrier.
In UL direction, spreading for the basic channel conﬁguration is performed in the same
way as for cdmaOne. For an enhanced channel conﬁguration spreading is similar to UTRA

390
CDMA
Traffic
channel n
19.2 kbit/s
Traffic
channel
Long PN
generator 1
& decimation
Traffic
channel
mask
I/Q
map
Wn
64
Real-valued
Walsh code Wn
SF
(channelization)
Basic configuration
(traffic channel)
Enhanced configuration
(traffic channel)
1.2288 Mchip/s
Complex-valued
PN sequence with
cell-specific offset
sC = sI + jsQ
Long PN
generator 1
& decimation
Traffic
channel
mask
1.2288 Mchip/s
Complex-valued
PN sequence with
cell-specific offset
sC = sI + jsQ
Figure 5.62 Downlink spreading for the single carrier mode.
Traffic
channel
Long PN
generator 3
& decimation
Traffic
channel
mask
I/Q
map
1.2288 Mchip/s
DE-
MUX
sC
Wn
SF
f1
f2
f3
Figure 5.63 Downlink spreading and multiplexing for the multicarrier mode.

CDMA
391
Pilot channel
Dedicated
control channel
Supplemental
channel 2
Fundamental
channel
Supplemental
channel 1
Other channels
Other channels
W0
64
W8
16
Wn
N
W6
8/ W2
4
W4
16
W2
4/ W1
2
Wn‘
N‘
I/Q
modulator
Channelization
(Walsh codes)
Power
weighting
Complex scrambling codes
- separation of mobiles
s‘c
j
Traffic channel mask
→long PN generator
Delay
Decimator
W1
2
sI
sQ
Figure 5.64 Uplink spreading for cdma2000.
FDD as explained in Subsection 5.5.4: One MS may transmit on several channels sepa-
rated by different Walsh codes or by the two branches of the I/Q modulator as shown in
Figure 5.64. There is at least one fundamental (trafﬁc) channel of low data rate and a pilot
channel offering coherent detection in UL direction. The pilot channel also contains power
control bits for a fast closed-loop DL power control, that is, the pilot channel is very similar
to the dedicated physical control channel of the UTRA FDD mode. Additionally, one or
two supplemental channels for a data rate increase or a dedicated control channel or other
channels (packet data) may be assigned. These channels are separated by orthogonal Walsh
codes of ﬁxed length. To adapt the input data symbol rate to the chip rate, the corresponding
Walsh code may have to be repeated during one data symbol. Source (MS)-speciﬁc scram-
bling is performed using a complex-valued scrambling sequence, which is derived from the
long code generator and the pair (sI, sQ) of PN sequences. The complex-valued sequence is
constructed in such a way that there is a continuous transmission with, on average, the same
power on the I- and Q-branch even if no trafﬁc data have to be transmitted. Furthermore, it
has been selected to avoid transitions through zero during phase changes as far as possible.
Cell search and synchronization
Cell search and synchronization is performed in the same way as in a cdmaOne network
based on the pair (sI, sQ) of PN sequences with their cell-speciﬁc offset and on the fact
that base stations in a cdma2000 network are also synchronized to GPS timing.
Random access
In addition, the basic random access procedure is very similar to the one for cdmaOne.

392
CDMA
Power control
The main enhancement of cdma2000 compared to cdmaOne concerning power control is
that a fast closed-loop DL power control mechanism at a rate of 800 Hz has been speciﬁed.
Handover
Soft and hard handover are performed in a way very similar to cdmaOne. For supporting
a hard handover, a kind of compressed mode has been deﬁned: the MS increases the
transmission power within some time slots before suspending the data transmission to
switch to another frequency for neighbor cell measurements.
5.6
Bibliographical Notes
The idea of spreading the signal spectrum is quite old. It was originally intended to hide
the signal and thus it was very interesting for military applications. Some basic ideas even
date back to the Second World War. The ﬁrst important system that was available for civil
applications (besides the military ones, and only with intentionally reduced performance)
was the global positioning system GPS (see (Fazel and Kaiser 2003)). The idea to use
spread spectrum techniques for multiple access is also not so new, but it became a serious
candidate for mobile radio systems only when A. Viterbi and his Qualcomm Company
promoted these ideas that resulted in the IS-95 standard ((J-STD-007 1999; Steele et al.
2001; TIA/EIA-95 1993)) with a high effort both in the ﬁeld of scientiﬁc discussion and
commercial marketing. During the 1990s many researchers started to work on this ﬁeld,
and more sophisticated receiver structures like multiuser detection were developed. For a
detailed discussion of these techniques, we refer to (Verdu 1998). Besides efﬁcient receiver
structures, further methods for handling the interference in CDMA mobile radio networks
are required to obtain an acceptable network performance. Methods like fast power control,
soft handover, a cluster 1 soft capacity planning, and so on, are discussed in detail in
(Holma and Toskala 2001; Steele et al. 2001; Viterbi 1995).
During the selection and standardization process for third generation mobile communica-
tion systems (which is reported in detail in (Holma and Toskala 2001)), CDMA was established
as the dominating multiple access technology: systems like cdma2000 and UMTS with the two
transmission modes Wideband CDMA and Time Division CDMA became global standards.
While the physical layer speciﬁcations for cdma2000 can be found in one large document
((3GPP2 C.S0002 2004)), the corresponding speciﬁcations for UMTS released by the 3rd
Generation Partnership Project Group are separated into many documents. Some essential
speciﬁcation documents are quoted as 3GPP TS 25.xxx within Subsection 5.5.4 and Subsec-
tion 5.5.5 while discussing the corresponding topics. A detailed description of these systems
can also be found in (Etemad 2004; Holma and Toskala 2001; Steele et al. 2001).
Multicarrier CDMA, which combines CDMA techniques with OFDM, seems to be a
promising candidate for future mobile radio systems. For a detailed discussion, we refer to
(Fazel and Kaiser 2003; Hanzo et al. 2003).
The main parameters of the 2G and 3G CDMA mobile communication systems are
listed in Table 5.1. Hence, this table serves as summary of the Subsections 5.5.4 to 5.5.7
where these systems are discussed in detail.

CDMA
393
Table 5.1
Comparison of CDMA mobile communication systems
UTRA FDD
UTRA TDD
IS-95/cdmaOne
cdma2000
Chip rate
[Mchip/s]
3.84
3.84 (and 1.28)
1.2288
1.2288 and 3.6864
Duplex
FDD
TDD
FDD
FDD
Synchronization
of BSs
Not required
Recommended, not
required
via GPS
via GPS
Convolutional
codes of rate
1/2, 1/3
1/2, 1/3
1/2, 1/3
1/2, 1/3, 1/4, 1/6
Constraint length
9
9
9
9
Turbo codes of
rate
1/3
1/3
–
1/2, 1/3, 1/4, 1/5
Channelization
codes DL
(separation of
MSs)
OVSF codes
SF = 4, . . . , 512
OVSF, SF = 1, 16
code pooling
Walsh codes
SF = 64
Walsh codes of
length 2, 4, 8,
. . . , 256
Channelization
codes UL
(separation of
connections)
OVSF codes
SF = 4, . . . , 256
OVSF codes, SF =
1, 2, 4, 8, 16
–
Walsh codes of
length 2, 4, 8,
. . . , 64
Scrambling codes
DL
(separation of
cells)
Gold code
segments: 38,400
chips, 16 codes
per cell
128 sequences
deﬁned by code
tables, 4
sequences per
cell
512 shifted versions
of one PN
sequence, 1 code
per cell
512 shifted versions
of one PN
sequence, 1 code
per cell
Scrambling codes
UL
(separation of
MSs)
Gold codes
segments opt.:
short codes (256
chips)
128 sequences
deﬁned by tables,
4 sequences per
cell
Long PN sequences
Long PN sequences
Realization of
variable data
rates
Variable spreading
& transport
formats
As UTRA FDD,
time slot
aggregation
Bit repetition
Variable spreading
& transport
formats
DL pilot
Several common
pilots, connection
individual pilots
Midambles per
burst
One pilot per cell
Several common
pilots
UL pilot
Connection
individual pilots
Midambles per
burst
–
Connection
individual pilots
Max. UL PC rate
1500 Hz
100, 200 Hz, open
loop
800 Hz
800 Hz
Max. DL PC rate
1500 Hz
100–750 Hz
50 Hz
800 Hz
Soft handover
Yes
No
Yes
Yes
Interfrequency
HO support
By compressed
mode
TDMA
Additional receiver
Compressed mode

394
CDMA
5.7
Problems
1. Show that
0,1 =

Eb

|c1| ±
1
|c1|ℜ

c∗
1c2ρ12

holds (see Figure 5.26).
2. For rectangular transmit pulses, show that the performance for synchronous trans-
mission treated in Subsection 5.2.1 is the worst case compared to asynchronous
transmission.
3. Show that for two users with real-valued ρ12 and real-valued coefﬁcients c1 = c2,
the decorrelator is better than the SUMF receiver.
4. Show that
A† 
AA† + tI
−1 =

A†A + tI
−1 A†
(5.54)
holds for any real number t (if the inverses above exist).
5. Convert the free-space loss formula of Problem 1.9 into a decibel notation and
show that one obtains a formula of the form of Equation (5.2). Show that for
f = 2 GHz the parameters A and B take the values A = 98.4 dB and B = 20.
6. Consider Equation (5.2) with propagation parameters A = 130 dB and B = 35. Let
us assume that the receiver sensitivity of the MS and the BS is improved by 3 dB
or 6 dB (e.g. by channel coding or antenna diversity). Consequently, the cell radius
may be increased. Calculate the factor for the increase of the radius. What does it
mean for the number of required cells?
7. Consider the UTRA FDD mode and two services with user data rates of 80 kbit/s
and 320 kbit/s which are protected by a convolutional code of rate 1/3. Let us
assume that both services are transmitted at the same power and require the same
Eb/N0, namely, Eb/N0 = 6 dB.
(a) Which spreading factors SF are required for the UL, and which ones for
the DL?
(b) Which are the effective spreading factors?
(c) Furthermore, consider the propagation conditions of Problem 6. By which
factor does the maximum range (radius) of both services differ?
(d) Assume that an OVSF code cSF,3 is allocated to the 80 kbit/s service in
DL direction. Which OVSF codes are allowed for the other service?
(e) Calculate (separately for each service) the maximum number of allowed
active connections per cell (median values) in UL direction using a cluster
1 × 1 with a mean relative intercell interference of q = 0.8 and orthogo-
nality factors of α = 1 and α = 0.1. What would be the gain of an intracell
interference cancellation reducing α from 1 to 0.1?

CDMA
395
(f) Repeat the calculation for the maximum number of active connection for a
cluster 1 × 3 assuming a mean relative intercell interference of q = 0.15.
(g) Compare the network capacity per required bandwidth for both clusters.
8. Consider a ﬁctitious CDMA system in a frequency band at 10 GHz and a moving
MS at a speed of v = 20 m/s. Is a power control rate of 1 kHz sufﬁcient to follow
fast fading? What order of magnitude of the interleaving depth (in milliseconds)
would be required for an efﬁcient interleaving?
9. Consider the long PN sequences of cdmaOne. How many different PN sequences
may be generated by the corresponding shift register? What is the period length
(in seconds) of these sequences?
10. Consider the UTRA TDD mode with the 2:1 separation between DL and UL as
shown in Figure 5.56.
(a) What is the maximum rate for a closed-loop DL power control?
(b) What is the maximum allowed distance between MS and BS at the random
access using the guard period of 192 chips?
(c) What is the number of available code channels of SF = 16 in UL direction?
11. Consider a service of data rate 230.4 kbit/s within cdma2000, which is transmitted
via a supplemental channel in UL and DL direction. The data are protected by a
convolutional code of rate 1/4. Code puncturing is applied for the 1X mode, but
not for the 3X mode.
(a) For the UL 1X mode Walsh codes of length 2 are used. Which code rate
is required after puncturing?
(b) Which Walsh code length is required for the 1X mode in DL direction
(using the same puncturing as in the UL)?
(c) Which Walsh code length is required for the 3X mode in UL and DL
direction?


Bibliography
3GPP TS 25.104 Base Station (BS) Radio Transmission and Reception (FDD), 3rd Generation Part-
nership Project (3GPP).
3GPP TS 25.101 User Equipment (UE) Radio Transmission and Reception (FDD), 3rd Generation
Partnership Project (3GPP).
3GPP TS 25.102 User Equipment (UE) Radio Transmission and Reception (TDD), 3rd Generation
Partnership Project (3GPP).
3GPP TS 25.105 Base Station (BS) Radio Transmission and Reception (TDD), 3rd Generation Part-
nership Project (3GPP).
3GPP TS 25.211 Physical Channels and Mapping of Transport Channels onto Physical Channels
(FDD), 3rd Generation Partnership Project (3GPP).
3GPP TS 25.212 Multiplexing and Channel Coding (FDD), 3rd Generation Partnership Project
(3GPP).
3GPP TS 25.213 Spreading and Modulation (FDD), 3rd Generation Partnership Project (3GPP).
3GPP TS 25.214 Physical Layer Procedures (FDD), 3rd Generation Partnership Project (3GPP).
3GPP TS 25.221 Physical Channels and Mapping of Transport Channels onto Physical Channels
(TDD), 3rd Generation Partnership Project (3GPP).
3GPP TS 25.222 Multiplexing and Channel Coding (TDD), 3rd Generation Partnership Project (3GPP).
3GPP TS 25.223 Spreading and Modulation (TDD), 3rd Generation Partnership Project (3GPP).
3GPP TS 25.224 Physical Layer Procedures (TDD), 3rd Generation Partnership Project (3GPP).
3GPP2 C.S0002 Physical Layer Standard for cdma2000 Spread Spectrum Systems, 3rd Generation
Partnership Project 2 (3GPP2).
Alamouti SM 1998 A simple transmit diversity technique for wireless communications. IEEE J.
Select. Areas Commun. 16, 1451–1458.
Alard M and Lassalle R 1987 Principles of modulation and channel coding for digital broadcasting
for mobile receivers. EBU Techn. Review 224, 47–68.
Bahl LR, Cocke J, Jelinek F and Raviv J 1974 Optimal decoding of linear codes for minimizing
symbol error rate. IEEE Trans. Inf. Theory 20, 284–287.
Baier PW, Bing T and Klein A 2000 TD-CDMA. In Third Generation Mobile Communication Systems
(eds. Prasad R, Mohr W and Konh¨auser W), pp. 25–72. Artech House Publishers.
Banelli P and Baruffa G 2001 Mixed BB-IF predistortion of OFDM signals in nonlinear channels.
IEEE Trans. Broadcast. 47, 137–146.
Bello PA 1963 Characterization of randomly time-variant linear channels. IEEE Trans. Commun. 11,
360–393.
Benedetto S and Biglieri E 1999 Principles of Digital Transmission. With Wireless Applications,
Kluwer Academic / Plenum Publishers, New York.
Theory and Applications of OFDM and CDMA
Henrik Schulze and Christian L¨uders
2005 John Wiley & Sons, Ltd

398
BIBLIOGRAPHY
Berrou C, Glavieux A and Thitimajshima P 1993 Near Shannon limit error correcting coding and
decoding. In Proc. IEEE International Conference on Communications 1993, 1064–1070. Geneva,
Switzerland.
Biglieri E, Divsalar D, McLane PJ and Simon MK 1991 Introduction to Trellis-Coded Modulation
with Applications, Macmillan, New York.
Bing T, Dahlhaus D, Latva-aho M and Nasshan M 2000 Advanced receiver algorithms. In Third
Generation Mobile Communication Systems (eds. Prasad R, Mohr W, and Konh¨auser W), pp.
91–132. Artech House Publishers.
Bingham JAC 1990 Multicarrier modulation for data transmission: An idea whose time has come.
IEEE Communications Magazine 28, 5–14.
Blahut RE 1983 Theory and Practice of Error Control Codes, Addison-Wesley, Reading, Mas-
sachusetts.
Blahut RE 1990 Digital Transmission of Information, Addison-Wessley.
Bossert M 1999 Channel Coding for Telecommunications, Wiley.
Bracewell RN 2000 The Fourier Transform and its Applications, McGraw-Hill.
Caire G, Taricco G and Biglieri E. 1998 Bit-interleaved coded modulation. IEEE Trans. Inf. Theory
44, 927–946.
CCSDS 1987 Recommendations for Space Data System Standard: Telemetry Channel Coding, Blue
Book Issue 2 CCSDS 101.0-B2. Consultative Committee for Space Data Systems.
Chang RW 1966 Synthesis of band-limited orthogonal signals for multi-channel data transmission.
Bell Labs Tech. J. 45, 1775–1796.
Chang RW and Gibby RA 1968 A theoretical study of performance of an orthogonal multiplexing
data transmission scheme. IEEE Trans. Commun. 16, 529–340.
Cimini LJ 1985 Analysis and simulation of a digital mobile radio channel using orthogonal frequency
division multiplexing. IEEE Trans. Commun. 33, 665–675.
Clark GC and Cain JB 1988 Error-Correction Coding for Digital Communications, Plenum, New
York.
D’Andrea AN, Lottici V and Reggianini R 1996 RF power ampliﬁer linearization through amplitude
and phase predistortion. IEEE Trans. Commun. 44, 1477–1484.
Eldar Y 2002 On geometric properties of the decorrelator. IEEE Comm. Lett. 6, 16–18.
EN101475 2001 Broadband Radio Access Networks (BRAN); HIPERLAN type 2; Physical (PHY)
Layer, ETSI, Sophia-Antipolis.
EN300401 2001a Radio Broadcasting Systems: Digital Audio Broadcasting (DAB) to Mobile, Portable
and Fixed Receivers, ETSI, Sophia-Antipolis.
EN300744 2001b Digital Broadcasting Systems for Television, Sound and Data Services; Fram-
ing Structure, Channel Coding and Modulation for Digital Terrestrial Television, ETSI, Sophia-
Antipolis.
Etemad K 2004 cdma2000 Evolution, Wiley.
ETSI TR 101 112 1998 Universal Mobile Telecommunications Systems (UMTS); Selection Procedures
for the Choice of Radio Transmission Technologies of the UMTS, European Telecommunications
Standards Institute (ETSI).
Fazel K and Kaiser K 2003 Multi-Carrier and Spread Spectrum Systems, Wiley.
Feller W 1970 An Introduction to Probability Theory and its Applications, 3rd edn. revised printing
Wiley.
Forney GD 1966 Concatenated Codes, MIT Press, Cambridge, Massachusetts.
Forney GD 1970 Convolutional codes I: algebraic structure. IEEE Trans. Inf. Theory 16, 720–738.
Forney GD 1973 The Viterbi algorithm. Proc. IEEE 61, 268–278.

BIBLIOGRAPHY
399
Frenger PK, Orten P and Ottoson T 1999 Code-spread CDMA with interference cancelation. IEEE
J. Select. Areas Commun. 17, 2090–2095.
Frenger PK, Orten P and Ottoson T 2000 Code-spread CDMA using maximum free distance low-rate
convolutional codes. IEEE Trans. Commun. 48, 135–144.
Gibson JD (ed.) 1999 The Mobile Communications Handbook, 2nd edn. CRC and IEEE Press.
Gitlin RD, Hayes JF and Weinstein SB 1993 Data Communication Principles, Plenum.
Graf F, Fischer P, Humburg E and L¨uders C 1997 Technical potential and economic efﬁciency
of macro diversity in GSM mobile radio networks. In Proceedings of the 2nd European Mobile
Communications Conference (EPMCC ’97), pp. 127–134. VDE Verlag.
Haardt M and Alexiou A 2004 Smart antenna technologies for future wireless systems: trends and
challenges. IEEE Commun. Mag. 42, 90–97.
Hagenauer J 1982 Fehlerkorrektur und diversity in Fading-Kan¨alen. Archiv f¨ur elektronische ¨Ubertra-
gungstechnik (AE ¨U) 36, 337–344.
Hagenauer J 1988 Rate compatible punctured convolutional codes (RCPC codes) and their applica-
tions. IEEE Trans. Commun. 36, 389–400.
Hagenauer J 1995 Source-controlled channel coding. IEEE Trans. Commun. 43, 2449–2457.
Hagenauer J and Hoeher 1989 A Viterbi algorithm with soft-decision outputs and its applications. In
Proc. GLOBECOM 1989 47.1.1–47.1.7, Dallas, Texas.
Hagenauer J, Offer E and Papke L 1996 Iterative decoding of block and convolutional codes. IEEE
Trans. Inf. Theory 42, 429–445.
Hagenauer J and Offer E 2001 Matching Viterbi decoders and Reed–Solomon decoders in a con-
catenated system. In: (Wicker and Bhargava 2001) Reed-Solomon Codes and Their Applications.
Wiley.
Hagenauer J, Seshadri N and Sundberg CEW 1990 The performance of rate-compatible punctured
convolutional codes for mobile radio. IEEE Trans. Commun. 38, 966–980.
Hanzo L, M¨unster M, Choi BJ and Keller T 2003 OFDM and MC-CDMA for Broadband Multi-User
Communications, WLANs and Broadcasting, Wiley and IEEE Press.
Haykin S 1996 Adaptive Filter Theory, 3rd ed. Prentice-Hall.
Hill TL 1956 Statistical Mechanics, McGraw-Hill.
Hirosaki B 1981 An orthogonally multiplexed QAM system using the discrete Fourier transform.
IEEE Trans. Commun. 29, 982–989.
Hoeg W and Lauterbach T 2003 Digital Audio Broadcasting. Principles and Applications of Digital
Radio, 2nd edn. Wiley.
Hoeher P 1991 TCM on frequency-selective land-mobile fading channels. Proc. 5th Tirrenia Interna-
tional Workshop on Digital Communication, Tirrenia
Hoeher P 1992 A statistical discrete-time model for the WSSUS multipath channel. IEEE Trans. Veh.
Technol. 41, 461–468
Hoeher P, Hagenauer J, Offer E, Rapp C and Schulze H 1991 Performance of an RCPC-Coded
OFDM-based Digital Audio Broadcasting (DAB) system. Proc. IEEE Globecom 1991 1, pp. 40–46.
Hoeher P, Kaiser S and Robertson P 1997 Two-dimensional pilot-symbol-aided channel estimation
by Wiener ﬁltering. IEEE International Conference on Acoustics, Speech, and Signal Processing
ICASSP-97, Munich (Germany) 3, pp. 1845–1848
Hofmann-Wellenhof B, Lichtenegger H and Collins J 2001 GPS: Theory and Practice, Springer.
Holma H and Toskala A (eds.) 2001 WCDMA for UMTS, Revised edn. Wiley.
Horn RA and Johnson CR 1985 Matrix Analysis, Cambridge University Press.
Hottinen A, Turkkonen O and Wichman R 2004 Multi-antenna Transceiver Techniques for 3G and
Beyond, Wiley.

400
BIBLIOGRAPHY
IEEE Standard 802.11a Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY)
speciﬁcations: High Speed Physical Layer in the 5 GHz Band Institute of Electrical and Electronics
Engineers (IEEE).
IEEE Standard 802.11b Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY)
speciﬁcations: Higher-Speed Physical Layer Extension in the 2.4 GHz Band Institute of Electrical
and Electronics Engineers (IEEE).
Jakes WC 1975 Microwave Mobile Communications, Wiley.
Jamali SH and Le-Ngoc T 1994 Coded-Modulation Techniques for Fading Channels, Kluwer.
J-STD-007 PCS 1900 - Air Interface Speciﬁcation (ANSI/J-STD-007) Telecommunications Industry
Association Standards and Engineering Publications.
Kammeyer KD 2004 Nachrichten¨ubertragung, 3rd edn. Teubner Verlag, Stuttgart, Germany.
Kammeyer KD, Tuisel U, Schulze H and Bochmann H 1992 Digital multicarrier transmission of
audio signals over mobile radio channels. Eur. Trans. Telecomm. 3, 243–254.
Konh¨auser W, Mohr W and Prasad R 2000 Introduction. In Third Generation Mobile Communication
Systems (eds. Prasad R, Mohr W and Konh¨auser W), pp. 11–24. Artech House Publishers.
Landau LD, Lifshitz EM 1958 Statistical Physics, Vol. 5 of Course of Theoretical Physics, Addi-
son–Wesley.
Lee AL and Messerschmidt DG 1994 Digital Communication, 2nd edn. Kluwer.
Lin S and Costello DJ 1983 Error Control Coding. Fundamentals and Applications, Prentice-Hall.
Massey JL 1984 The how and why of channel coding. In Proceedings of the 1984 Zurich Seminar
on Digital Communications. Zurich (Switzerland), 67–73.
Massey JL 1992 Deep space communications and coding: a marriage made in heaven. In Lecture
Notes in Control and Information Sciences, 182, Springer–Verlag.
McEliece RJ and Swanson L 2001 Reed–Solomon codes and the exploration of the solar system. In:
(Wicker and Bhargava 2001) Reed-Solomon Codes and Their Applications. Wiley.
Milstein LB 2000 Wideband code division multiple access. IEEE J. Select. Areas Commun. 18,
1344–1364.
Mogensen PE, Espensen P, Pedersen KI and Zetterberg P et al 1999 Antenna arrays and space division
multiple access. In GSM - Evolution Towards 3rd Generation Systems (eds. Zvonar Z, Jung P and
Kammerlander K), pp. 117–152. Kluwer Academic Publishers.
Monogioudis P, Conner K, Das D, Gollamudi S, Lee JAC, Moustakas AL, Nagaraj S, Rao AM, Soni
RA and Yuan Y et al 2004 Intelligent antenna solutions for UMTS: Algorithms and simulation
results. IEEE Commun. Mag. 42, pp. 28–38.
Neeser FD and Massey JL 1993 Proper complex random processes with applications to information
theory. IEEE Trans. Inf. Theory 39, 1293–1302.
O’Hara B and Petrick A 1999 IEEE 802.11 Handbook: A Designer’s Companion,IEEE Press.
Papoulis A 1991 Probability, Random Variable, and Stochastic Processes, McGraw-Hill.
Parsons JD 2000 The Mobile Radio Propagation Channel, Wiley.
Proakis JR 2001 Digital Communications, 4th edn. McGraw-Hill.
Reed IS, Solomon G 1960 Polynomial codes over certain ﬁnite ﬁelds. J. SIAM 8, 300–304.
Reed M and Simon B 1980 Methods of Modern Mathematical Physics I: Functional Analysis,Revised
and enlarged edition Academic Press.
Rehfuess U and Ivanov K 1999 Comparing frequency planning against 1x3 and 1x1 reuse in real
frequency hopping networks. In Proceedings of the 49th IEEE Vehicular Technical Conference,
IEEE Press.
Saltzberg BR 1967 Performance of an efﬁcient parallel data transmission system. IEEE Trans. Com-
mun. Tech. 15 805–811.

BIBLIOGRAPHY
401
Schmidt H 2001 OFDM f¨ur die drahtlose Daten¨ubertragung Innerhalb von Geb¨auden, Ph. D. Thesis,
University Bremen (Germany).
Schulze H 1988 Stochastische Methoden und digitale Simulation von Mobilfunkkan¨alen. Klein-
heubacher Berichte 32, 473–483.
Schulze H 2001 The performance of multicarrier CDMA for the correlated Rayleigh fading channel.
Int. J. Electron. Commun. (AE ¨U) 55, 88–94.
Schulze H 2003a Geometrical properties of orthogonal space-time codes. IEEE Comm. Lett. 7, 64–66.
Schulze H 2003b System design for bit interleaved coded QAM with iterative decoding in a Rician
fading channel. European Trans. Telecomm. 14, 119–129.
Schulze H 2003c Performance analysis of concatenated space-time coding with two transmit antennas.
IEEE Trans. Wireless Comm. 2, 669–679.
Simon MK and Alouini MS 2000 Digital Communications over Fading Channels, Wiley.
Simon MK and Divsalar D 1998 Some new twists to problems involving the Gaussian probability
integral. IEEE Trans. Commun. 46, 200–210.
Steele R, Lee CC and Gould P 2001 GSM, cdmaOne and 3G, Wiley.
Therrien CW 1992 Discrete Random Signals and Statistical Signal Processing, Prentice-Hall.
TIA/EIA-95 1993 Mobile Station - Base Station Compatibility Standard for Spread Spectrum Cellular
Systems. (ANSI/TIA/EIA-95), Telecommunications Industry Association Standards and Engineering
Publications.
TS101475 2001 Broadband Radio Access Networks (BRAN); HIPERLAN Type 2; Physical (PHY)
layer, ETSI, Sophia-Antipolis.
Ungerboeck 1982 Channel codes with multilevel/multiphase signals. IEEE Trans. Inf. Theory 28,
55–67.
van Kampen NG 1981 Stochastic Processes in Physic and Chemistry, North-Holland.
Van Trees HL 1967 Detection, Estimation, and Modulation Theory I, Wiley.
Verdu S 1998 Multiuser Detection, Cambridge University Press.
Viterbi AJ 1967 Error bounds for convolutional codes and an asymptotically optimum decoding
algorithm. IEEE Trans. Inf. Theory 13, 260–269.
Viterbi AJ 1995 CDMA. Principles of Spread Spectrum Communications, Addison-Wesley.
Weinstein SB and Ebert PM 1971 Data transmission by frequency-division multiplexing using the
discrete Fourier transform. IEEE Trans. Commun. 19, 628–634.
Wicker SB 1995 Error Control Systems for Digital Communication and Storage, Prentice-Hall.
Wicker SB and Bhargava VK 2001 Reed–Solomon Codes and Their Applications, Wiley.
Wozencraft JM and Jacobs IM 1965 Principles of Communication Engineering, Wiley.


Index
ES/N0, 40, 159
Eb/N0, 40, 159
1X mode, 389
3GPP, 361
3X mode, 389
3rd Generation Partnership Project, 361
Active set, 298, 374, 386
Adaptive antennas, 301
Alamouti scheme, 87, 235
Antenna diversity, 235
Antipodal modulation, 36
ASK, 40
Autocorrelation function, 58
Autocorrelation matrix, 200
AWGN, 25
Barker code, 282, 352
Base station, 269
Base station controller, 269
Baseband, 18
BCJR algorithm, 125
Bessel function, 58
BICM, 214
Block code, 93
Block interleaver, 194
BPSK, 209
BS, 269
C/A code, 356
Capacity, 290, 295
CDMA, 1, 265
cdma2000, 386
cdmaOne, 380
Cell search, 371, 378, 384, 391
Channel coding, 93, 245
Theory and Applications of OFDM and CDMA
Henrik Schulze and Christian L¨uders
2005 John Wiley & Sons, Ltd
Channel coding for CDMA, 294
Channel diversity, 192
Channel estimation, 181, 227
Channel estimation
in frequency direction, 189
in time and frequency direction,
192
in time direction, 186
Channel simulation, 67
Chip, 305
Chip
duration, 306
period, 306
pulse, 305
Closed-loop power control, 286, 374,
379
Closed-loop transmit diversity, 368
Cluster size, 274, 290
Coarse/acquisition code, 356
Code allocation, 364, 376, 381
Code rate, 94
Code tree, 277, 282
Code word, 93
Coherence bandwidth, 53, 194
Complementary code keying, 353
Complex baseband, 18
Complex baseband stochastic processes,
27
Compressed mode, 375, 392
Concatenated coding, 103
Convolutional code, 114, 209, 367, 382,
389
Convolutional interleaver, 196
Correlation coefﬁcient, 305
Correlation frequency, 53

404
INDEX
Correlation matrix, 308
Correlation time, 53
Coverage probability, 273
Cyclic preﬁx, 154
DAB, 176, 208, 209, 242
DAMPS, 358
DCH, 367
Decision threshold, 34
Decoding delay, 193, 195, 198
Decorrelating receiver, 328
Dedicated channel, 367
Dedicated physical control channel, 367
Dedicated physical data channel, 367
Delay power spectrum, 61
Delay spread, 53, 60
Detector, 7, 8
Digital American Mobile Phone System,
358
Discontinuous transmission, 293
Discrete AWGN channel, 29
Discrete fading channel, 73, 74
Diversity, 78
Diversity branch spectrum, 202
Diversity degree
of the channel, 199
Diversity spectrum, 199
DL, 269
Doppler frequency, 51
Doppler spectrum, 57
Downlink, 269
DPCCH, 367
DPDCH, 367
DPSK, 44
DQPSK, 250
DS-CDMA, 306, 362
DTX, 293
DVB, 208, 209, 251
DVB-C, 252
DVB-S, 252
DVB-T, 183, 213, 252
Dynamic channel allocation,
301
Effective spreading factor, 266
Energy
per symbol ES, 39
per useful bit Eb, 40
Equivalent independently fading
channel, 201
Estimation error, 185
ETSI, 361
Euclidean distance, 5
Euclidean norm, 5
European Telecommunications Standards
Institute, 361
Extrinsic LLR, 113
Fading, 51
Fading amplitude, 72
FDD, 361
FFT, 153
Forward link, 269
Forward-backward recursions, 127
Fourier base, 1
Fourier coefﬁcients, 1
Frequency allocation, 290, 295, 363,
376, 380, 387
Frequency division duplex, 361
Frequency hopping, 352
Frequency interleaving, 249
Frequency selectivity, 51, 60
Fundamental channel, 389
Galois ﬁeld, 133
Gaussian Nyquist pulse, 11
Gaussian random variable, 25
Generator, 115
Generator
polynomial, 115, 280
Global Positioning System, 355
Global System for Mobile
Communications, 358
Gold codes, 281, 365
GPP2, 362
GPS, 355, 381, 388
GSM, 358
Guard period, 377
Hadamard matrices, 13
Hamming codes, 103
Hamming distance, 94, 199
Handover, 270, 374, 379, 386
Handover gain, 272, 274, 296

INDEX
405
Handover hysteresis, 296, 298
Hard capacity planning, 293
Hard handover, 270, 374, 379, 386
Hierarchical cell structure, 294
Hierarchical networks, 363
Hilbert space, 5
IEEE 802.11, 352, 354
IMT-2000, 360
Inner-loop power control, 288
Institute of Electrical and Electronics
Engineers, 352
Integral kernel, 63
Intelligent antennas, 301
Intercell interference, 274
Interference, 285, 290
Interference averaging, 292
Interference cancellation, 339, 365
Interference diversity, 292
Interleaver, 194
Interleaving, 192, 227
International Mobile
Telecommunications, 360
International Telecommunications
Union, 360
Intersymbol interference, 9, 54
Intracell interference, 274
IS-136, 358
IS-95, 358, 380
ISI, 154, 346
Isotropic Doppler spectrum, 58
ITU, 360
Jakes Doppler spectrum, 58
JD-CDMA, 375
Joint detection, 301, 375, 378
Kasami codes, 282
Linear CDMA receivers, 328
Linear code, 94
Linear modulation schemes, 38
LLR, 218
Local mean, 273
Log-likelihood ratio (LLR),
105
Long-term fading, 271
m-sequences, 279, 365
Macrodiversity, 274, 296
MAI, 316, 320, 321, 346
MAP receiver, 112, 321, 326
Matched ﬁlter, 8
Matched ﬁlter base, 308
Matrix block interleaver, 195
Maximum likelihood, 32
Maximum ratio combining (MRC),
79
maxlog, 219
maxlog MAP, 114
MC-CDMA, 306, 362
Metric, 216
Microdiversity, 296
Midamble, 377
Minimum mean square error, 337
MLSE, 32, 121
MLSE
for fading channels, 72–74
MLSE receiver, 321–323, 325, 326,
347
MMSE receiver, 337
Mobile radio channel, 51
Mobile reception
of DVB-T, 257
Mobile station, 269
Mobile switching center, 269
Modulation schemes, 38
Monte-Carlo Simulations, 90
MRC, 80, 344
MS, 269
MUD receiver, 315
Multicarrier CDMA, 387, 389
Multicarrier transmission, 145, 149
Multipath diversity, 267, 297
Multipath propagation, 51
Multiple access interference, 316
Multiplexing, 247
Multiuser detection, 315
Near–far problem, 285, 315, 321
Network capacity, 292
Noise, 25
Normplot, 166
NSC encoder, 119
Null symbol, 176

406
INDEX
Nyquist
base, 9
criterion, 10
pulse, 9
OFDM, 1, 145
OFDM
and nonlinearities, 166
symbol, 159
OFDM with convolutional coding, 208,
213
OFDM with QAM, 213
OFDM with QPSK, 208
Omni cell, 270
Open-loop power control, 286, 374, 379
Orthogonal detector base, 309
Orthogonal modulation, 37
Orthogonal signals, 1, 5
Orthogonal variable spreading factor
codes, 277
Orthogonality factor, 290
Orthogonality principle, 184
Orthonormal base, 2
Orthonormal transmit bases, 13
Out-of-band radiation, 162
Outer-loop power control, 288
OVSF codes, 277, 364, 376
P code, 356
Paging channel, 382
Pairwise error probabilities, 34
Pairwise error probabilities
for diversity, 82
for fading channels, 76
Parity check, 94
Parseval’s equation, 6
Passband, 18
PC, 285
Pilot channel, 369, 382, 383, 389
Pilot grid, 182, 183
Pilot symbols, 181, 368
PN, 279
Power budget handover, 270
Power control, 285, 374, 379, 386, 392
Power density spectrum, 152, 160, 161
Power efﬁciency, 38, 40, 44
Precision code, 356
Primary scrambling code, 365
Primary synchronization code word,
372, 378, 392
Primitive element, 133
Processing gain, 268
Projection theorem, 184
Propagation loss, 271
Pseudoinverse, 331
Pseudonoise sequences, 279
QAM, 40, 209, 213, 227, 252
QPSK, 208
Quadrature
components, 20
demodulator, 22
modulator, 20
Radio network controller, 269
Raised cosine pulses, 11
RAKE receiver, 267, 342, 346
Random access, 373, 379, 385
Random access preamble, 373, 385
Rate matching, 367
Receive antenna diversity, 236
Receive space, 308
Reed–Solomon code, 254
Reed–Solomon codes, 131
Repetition codes, 101
Representation of CDMA signals, 304
Reverse link, 269
Rice factor, 67
Ricean channel, 67
Rolloff factor, 10
Root-raised cosine ﬁlter, 370
RSC encoder, 119
Sampling Theorem, 228, 232
Sampling theorem, 6
Scalar product, 2
Scalar product
of signals, 5
Scattering function, 62
Schwarz inequality, 6
Secondary scrambling code, 365
Secondary synchronization code word,
372, 378
Sector cell, 270

INDEX
407
Sectorization, 271, 275, 302
Shift register, 279
Signal energy, 9
Signal space, 5
Signals of ﬁnite energy, 5
Signature pulses, 305
Signature vector, 305
Signature waveforms, 305
Simplex codes, 102
sinc base, 7
Single parity check codes, 101
Single-user matched ﬁlter (SUMF)
receiver, 315, 316
SISO decoder, 113
Slotted mode, 299, 375
Smart antennas, 301, 369
Smoothing window, 165
SNR, 39, 40, 159
Soft capacity planning, 293
Soft handover, 270, 295, 374, 379, 386
Softer handover, 296
SOVA, 124
Spectrum mask, 162
Spread spectrum, 265
Spreading, 265
Spreading factor, 266, 364, 376, 381,
389
Spreading sequence, 265
SSS processes, 57
State diagram, 117
Successive interference cancellation, 339
Sufﬁcient statistics, 30
SUMF receiver, 315, 316
Supplemental channel, 389
Switched beams, 302
Synchronization, 175, 371, 378, 381,
384, 391
Synchronization channel, 382
Synchronous transmission, 315
Synchronous transmission of CDMA,
307
Systematic code, 94
TD-CDMA, 361, 375
TD-SCDMA, 361, 375
TDD, 301, 361
TDD mode, 375
TDD-CDMA, 362
Threshold metric, 216
Time division CDMA, 375
Time division duplex, 301, 361
Time interleaving, 193, 247
Time interleaving
for DAB, 194
Time variance, 51, 54
Time-variant impulse response, 64
Time-variant transfer function, 64
Trafﬁc channel, 382
Training sequence, 377
Transmission frame, 244
Transmit
base, 8
pulse, 8
symbol, 8
Transmit antenna diversity, 86, 237
Transmit space, 307
Transmitter, 7
Transport format combination indicator,
369
Trellis, 116
Turbo code, 389
Turbo coding, 367
UL, 269
UMTS, 361
Universal Mobile Telecommunication
System, 361
Universal Terrestrial Radio Access, 361
Uplink, 269
UTRA, 361
UTRA FDD, 363
UTRA TDD, 375
UWC-136, 362
Viterbi algorithm, 121
Viterbi equalizer, 347
Walsh
functions, 13
modulation, 37, 382
Walsh–Hadamard
codes, 96, 388
Walsh–Hadamard codes, 381
Walsh–Hadamard matrices, 13

408
INDEX
Walsh–Hadamard
codes, 101
WCDMA, 361
White Gaussian noise, 25
Whitening matched ﬁlter, 308
Wideband CDMA, 342, 361, 362
Wideband multicarrier channel, 199
Wiener estimator, 183
Wiener ﬁltering, 186
Wiener–Hopf equation, 185
Wireless LAN, 352
WLAN, 208, 209, 213
WSS processes, 57
WSSUS model, 63, 186

