Real analysis for graduate
students:
measure and integration
theory
Richard F. Bass

ii
c⃝Copyright 2011 Richard F. Bass
All rights reserved.
ISBN-13: 978-1466391574
ISBN-10: 146639157X

iii
To the memory of my parents
Jay and Betty Bass

iv

Contents
Preface
ix
1
Preliminaries
1
1.1
Notation and terminology . . . . . . . . . . . . . . .1
1.2
Some undergraduate mathematics
. . . . . . . . . .2
2
Families of sets
7
2.1
Algebras and σ-algebras . . . . . . . . . . . . . . . .7
2.2
The monotone class theorem
. . . . . . . . . . . . .10
2.3
Exercises
. . . . . . . . . . . . . . . . . . . . . . . .11
3
Measures
13
3.1
Deﬁnitions and examples . . . . . . . . . . . . . . . .13
3.2
Exercises
. . . . . . . . . . . . . . . . . . . . . . . .16
4
Construction of measures
19
4.1
Outer measures . . . . . . . . . . . . . . . . . . . . .20
4.2
Lebesgue-Stieltjes measures . . . . . . . . . . . . . .24
4.3
Examples and related results
. . . . . . . . . . . . .27
4.4
Nonmeasurable sets
. . . . . . . . . . . . . . . . . .30
4.5
The Carath´eodory extension theorem . . . . . . . . .31
4.6
Exercises
. . . . . . . . . . . . . . . . . . . . . . . .34
v

vi
CONTENTS
5
Measurable functions
37
5.1
Measurability . . . . . . . . . . . . . . . . . . . . . .37
5.2
Approximation of functions . . . . . . . . . . . . . .41
5.3
Lusin’s theorem . . . . . . . . . . . . . . . . . . . . .41
5.4
Exercises
. . . . . . . . . . . . . . . . . . . . . . . .44
6
The Lebesgue integral
47
6.1
Deﬁnitions . . . . . . . . . . . . . . . . . . . . . . . .47
6.2
Exercises
. . . . . . . . . . . . . . . . . . . . . . . .49
7
Limit theorems
51
7.1
Monotone convergence theorem . . . . . . . . . . . .51
7.2
Linearity of the integral . . . . . . . . . . . . . . . .52
7.3
Fatou’s lemma
. . . . . . . . . . . . . . . . . . . . .54
7.4
Dominated convergence theorem
. . . . . . . . . . .55
7.5
Exercises
. . . . . . . . . . . . . . . . . . . . . . . .56
8
Properties of Lebesgue integrals
63
8.1
Criteria for a function to be zero a.e. . . . . . . . . .63
8.2
An approximation result . . . . . . . . . . . . . . . .65
8.3
Exercises
. . . . . . . . . . . . . . . . . . . . . . . .66
9
Riemann integrals
69
9.1
Comparison with the Lebesgue integral . . . . . . . .69
9.2
Exercises
. . . . . . . . . . . . . . . . . . . . . . . .71
10 Types of convergence
75
10.1 Deﬁnitions and examples . . . . . . . . . . . . . . . .75
10.2 Exercises
. . . . . . . . . . . . . . . . . . . . . . . .78
11 Product measures
81

CONTENTS
vii
11.1 Product σ-algebras . . . . . . . . . . . . . . . . . . .81
11.2 The Fubini theorem
. . . . . . . . . . . . . . . . . .85
11.3 Examples . . . . . . . . . . . . . . . . . . . . . . . .87
11.4 Exercises
. . . . . . . . . . . . . . . . . . . . . . . .88
12 Signed measures
93
12.1 Positive and negative sets . . . . . . . . . . . . . . .93
12.2 Hahn decomposition theorem . . . . . . . . . . . . .95
12.3 Jordan decomposition theorem
. . . . . . . . . . . .97
12.4 Exercises
. . . . . . . . . . . . . . . . . . . . . . . .97
13 The Radon-Nikodym theorem
99
13.1 Absolute continuity . . . . . . . . . . . . . . . . . . .99
13.2 The main theorem . . . . . . . . . . . . . . . . . . .100
13.3 Lebesgue decomposition theorem . . . . . . . . . . .103
13.4 Exercises
. . . . . . . . . . . . . . . . . . . . . . . .104
14 Diﬀerentiation
107
14.1 Maximal functions . . . . . . . . . . . . . . . . . . .108
14.2 Antiderivatives . . . . . . . . . . . . . . . . . . . . .112
14.3 Bounded variation
. . . . . . . . . . . . . . . . . . .113
14.4 Absolutely continuous functions . . . . . . . . . . . .118
14.5 Approach 2 – diﬀerentiability . . . . . . . . . . . . .120
14.6 Approach 2 – antiderivatives
. . . . . . . . . . . . .124
14.7 Approach 2 – absolute continuity . . . . . . . . . . .126
14.8 Exercises
. . . . . . . . . . . . . . . . . . . . . . . .127
15 Lp spaces
131
15.1 Norms . . . . . . . . . . . . . . . . . . . . . . . . . .131
15.2 Completeness . . . . . . . . . . . . . . . . . . . . . .134

viii
CONTENTS
15.3 Convolutions
. . . . . . . . . . . . . . . . . . . . . .136
15.4 Bounded linear functionals . . . . . . . . . . . . . . .137
15.5 Exercises
. . . . . . . . . . . . . . . . . . . . . . . .141
16 Fourier transforms
147
16.1 Basic properties . . . . . . . . . . . . . . . . . . . . .147
16.2 The inversion theorem . . . . . . . . . . . . . . . . .150
16.3 The Plancherel theorem . . . . . . . . . . . . . . . .154
16.4 Exercises
. . . . . . . . . . . . . . . . . . . . . . . .155
17 Riesz representation
157
17.1 Partitions of unity
. . . . . . . . . . . . . . . . . . .158
17.2 The representation theorem . . . . . . . . . . . . . .159
17.3 Regularity . . . . . . . . . . . . . . . . . . . . . . . .163
17.4 Exercises
. . . . . . . . . . . . . . . . . . . . . . . .164
18 Banach spaces
167
18.1 Deﬁnitions . . . . . . . . . . . . . . . . . . . . . . . .167
18.2 The Hahn-Banach theorem
. . . . . . . . . . . . . .168
18.3 Baire’s theorem and consequences
. . . . . . . . . .171
18.4 Exercises
. . . . . . . . . . . . . . . . . . . . . . . .174
19 Hilbert spaces
177
19.1 Inner products
. . . . . . . . . . . . . . . . . . . . .177
19.2 Subspaces . . . . . . . . . . . . . . . . . . . . . . . .180
19.3 Orthonormal sets . . . . . . . . . . . . . . . . . . . .182
19.4 Fourier series . . . . . . . . . . . . . . . . . . . . . .185
19.5 Exercises
. . . . . . . . . . . . . . . . . . . . . . . .187

Preface
Nearly every Ph.D. student in mathematics needs to pass a pre-
liminary or qualifying examination in real analysis. The purpose
of this book is to teach the material necessary to pass such an
examination.
I had three main goals in writing this text:
(1) present a very clear exposition;
(2) provide a large collection of useful exercises;
(3) make the text aﬀordable.
Let me discuss each of these in more detail.
(1) There are a large number of real analysis texts already in
existence. Why write another? In my opinion, none of the exist-
ing texts are ideally suited to the beginning graduate student who
needs to pass a “prelim” or “qual.” They are either too hard, too
advanced, too encyclopedic, omit too many important topics, or
take a nonstandard approach to some of the basic theorems.
Students who are starting their graduate mathematics educa-
tion are often still developing their mathematical sophistication and
ﬁnd that the more details that are provided, the better (within rea-
son). I have tried to make the writing as clear as possible and to
provide the details. For the sake of clarity, I present the theorems
and results as they will be tested, not in the absolutely most general
abstract context. On the other hand, a look at the index will show
that no topics that might appear on a preliminary or qualifying
examination are omitted.
All the proofs are “plain vanilla.”
I avoid any clever tricks,
sneaky proofs, unusual approaches, and the like.
These are the
proofs and methods that most experts grew up on.
ix

x
PREFACE
(2) There are over 220 exercises. I tried to make them inter-
esting and useful and to avoid problems that are overly technical.
Many are routine, many are of moderate diﬃculty, but some are
quite challenging. A substantial number are taken from prelimi-
nary examinations given in the past at universities with which I
have been associated.
I thought long and hard as to whether to provide hints to the
exercises. When I teach the real analysis course, I give hints to the
harder questions. But some instructors will want a more challeng-
ing course than I give and some a less challenging one. I leave it
to the individual instructor to decide how many hints to give.
(3) I have on my bookshelf several books that I bought in the
early 1970’s that have the prices stamped in them: $10-$12. These
very same books now sell for $100-$200. The cost of living has
gone up in the last 40 years, but only by a factor of 5 or 6, not
a factor of 10. Why do publishers make textbooks so expensive?
This is particularly troublesome when one considers that nowadays
authors do their own typesetting and frequently their own page
layout.
My aim was to make the soft cover version of this text cost less
than $20 and to provide a version in .pdf format for free. To do
that, I am self-publishing the text.
At this point I should tell you a little bit about the subject
matter of real analysis. For an interval contained in the real line or
a nice region in the plane, the length of the interval or the area of
the region give an idea of the size. We want to extend the notion of
size to as large a class of sets as possible. Doing this for subsets of
the real line gives rise to Lebesgue measure. Chapters 2–4 discuss
classes of sets, the deﬁnition of measures, and the construction of
measures, of which one example is Lebesgue measure on the line.
(Chapter 1 is a summary of the notation that is used and the
background material that is required.)
Once we have measures, we proceed to the Lebesgue integral.
We talk about measurable functions, deﬁne the Lebesgue integral,
prove the monotone and dominated convergence theorems, look at
some simple properties of the Lebesgue integral, compare it to the
Riemann integral, and discuss some of the various ways a sequence
of functions can converge. This material is the subject of Chapters
5–10.

xi
Closely tied with measures and integration are the subjects of
product measures, signed measures, the Radon-Nikodym theorem,
the diﬀerentiation of functions on the line, and Lp spaces. These
are covered in Chapters 11–15.
Many courses in real analysis stop at this point. Others also in-
clude some or all of the following topics: the Fourier transform, the
Riesz representation theorem, Banach spaces, and Hilbert spaces.
We present these in Chapters 16–19.
The prerequisites to this text are a solid background in un-
dergraduate mathematics. An acquaintance with metric spaces is
assumed, but no other topology. A summary of what you need to
know is in Chapter 1. All the necessary background material can
be learned from many sources; one good place is the book [3].
At some universities preliminary or qualifying examinations in
real analysis are combined with those in undergraduate analysis or
topology or complex analysis. If that is the case at your university,
you will have to supplement this text with texts in those subjects.
Further reading is always useful. I have found the books [1], [2],
and [4] helpful.
I would like to thank A. Baldenko, I. Ben-Ari, K. Bharath, K.
Burdzy, D. Ferrone, E. Gin´e, M. Gordina, E. Hsu, G. Lawler, L.
Lu, K. Marinelli, J. Pitman, M. Poehlitz, H. Ren, L. Rogers, and
A. Teplyaev for some very useful suggestions.
If you have comments, suggestions, corrections, etc., I would be
glad to hear from you: r.bass@uconn.edu. I cannot, however,
provide hints or solutions to the exercises.
Good luck with your exam!

xii
PREFACE

Chapter 1
Preliminaries
In this short chapter we summarize some of the notation and ter-
minology we will use and recall a few deﬁnitions and results from
undergraduate mathematics.
1.1
Notation and terminology
We use Ac, read “A complement,” for the set of points not in A.
To avoid some of the paradoxes of set theory, we assume all our
sets are subsets of some given set X, and to be precise, deﬁne
Ac = {x ∈X : x /∈A}.
We write
A −B = A ∩Bc
(it is common to also see A \ B) and
A∆B = (A −B) ∪(B −A).
The set A∆B is called the symmetric diﬀerence of A and B and
is the set of points that are in one of the sets but not the other.
If I is some index set, a collection of subsets {Aα}α∈I is disjoint if
Aα ∩Aβ = ∅whenever α ̸= β.
We write Ai ↑if A1 ⊂A2 ⊂· · · and write Ai ↑A if in addition
A = ∪∞
i=1Ai. Similarly Ai ↓means A1 ⊃A2 ⊃· · · and Ai ↓A
means that in addition A = ∩∞
i=1Ai.
1

2
CHAPTER 1. PRELIMINARIES
We use Q to denote the set of rational numbers, R the set of
real numbers, and C the set of complex numbers. We use
x ∨y = max(x, y)
and
x ∧y = min(x, y).
We can write a real number x in terms of its positive and negative
parts: x = x+ −x−, where
x+ = x ∨0
and
x−= (−x) ∨0.
If z is a complex number, then z is the complex conjugate of z.
If f is a function whose domain is the reals or a subset of the
reals, then limy→x+ f(y) and limy→x−f(y) are the right and left
hand limits of f at x, resp.
We say a function f : R →R is increasing if x < y im-
plies f(x) ≤f(y) and f is strictly increasing if x < y implies
f(x) < f(y). (Some authors use “nondecreasing” for the former
and “increasing” for the latter.) We deﬁne decreasing and strictly
decreasing similarly. A function is monotone if f is either increas-
ing or decreasing.
Given a sequence {an} of real numbers,
lim sup
n→∞an = inf
n sup
m≥n
am,
lim inf
n→∞an = sup
n
inf
m≥n am.
For example, if
an =
(
1,
n even;
−1/n,
n odd,
then lim supn→∞an = 1 and lim infn→∞an = 0. The sequence
{an} has a limit if and only if lim supn→∞an = lim infn→∞an and
both are ﬁnite. We use analogous deﬁnitions when we take a limit
along the real numbers. For example,
lim sup
y→x
f(y) = inf
δ>0
sup
|y−x|<δ
f(y).
1.2
Some undergraduate mathematics
We recall some deﬁnitions and facts from undergraduate topology,
algebra, and analysis. The proofs and more details can be found
in many places. A good source is [3].

1.2. SOME UNDERGRADUATE MATHEMATICS
3
A set X is a metric space if there exists a metric d : X ×X →R
such that
(1) d(x, y) = d(y, x) for all x, y ∈X;
(2) d(x, y) ≥0 for all x, y ∈X and d(x, y) = 0 if and only if x = y;
(3) d(x, z) ≤d(x, y) + d(y, z) for all x, y, z ∈X.
Condition (3) is called the triangle inequality.
Given a metric space X, let
B(x, r) = {y ∈X : d(x, y) < r}
be the open ball of radius r centered at x. If A ⊂X, the interior
of A, denoted Ao, is the set of x such that there exists rx > 0 with
B(x, rx) ⊂A. The closure of A, denoted A, is the set of x ∈X
such that every open ball centered at x contains at least one point
of A. A set A is open if A = Ao, closed if A = A. If f : X →R,
the
support of f is the closure of the set {x : f(x) ̸= 0}. f is
continuous at a point x if given ε > 0, there exists δ > 0 such
that |f(x) −f(y)| < ε whenever d(x, y) < δ. f is continuous if
it is continuous at every point of its domain.
One property of
continuous functions is that f −1(F) is closed and f −1(G) is open
if f is continuous, F is closed, and G is open.
A sequence {xn} ⊂X converges to a point x ∈X if for each
ε > 0 there exists N such that d(xn, x) < x whenever n ≥N. A
sequence is a Cauchy sequence if for each ε > 0 there exists N such
that d(xm, xn) < ε whenever m, n ≥N. If every Cauchy sequence
in X converges to a point in X, we say X is complete.
An open cover of a subset K of X is a collection {Gα}α∈I of
open sets such that K ⊂∪α∈IGα. The index set I can be ﬁnite
or inﬁnite.
A set K is compact of every open cover contains a
ﬁnite subcover, i.e., there exists G1, . . . , Gn ∈{Gα}α∈I such that
K ⊂∪n
i=1Gi.
We have the following two facts about compact sets.
Proposition 1.1 If K is compact, F ⊂K, and F is closed, then
F is compact.
Proposition 1.2 If K is compact and f is continuous on K, then
there exist x1 and x2 such that f(x1) = infx∈K f(x) and f(x2) =
supx∈K f(x). In other words, f takes on its maximum and mini-
mum values.

4
CHAPTER 1. PRELIMINARIES
Remark 1.3 If x ̸= y, let r = d(x, y) and note that d(x, r/2) and
d(y, r/2) are disjoint open sets containing x and y, resp. Therefore
metric spaces are also what are called Hausdorﬀspaces.
Let F be either R or C. X is a vector space or linear space if
there exist two operations, addition (+) and scalar multiplication,
such that
(1) x + y = y + x for all x, y ∈X;
(2) (x + y) + z = x + (y + z) for all x, y, z ∈X;
(3) there exists an element 0 ∈X such that 0 + x = x for all
x ∈X;
(4) for each x in X there exists an element −x ∈X such that
x + (−x) = 0;
(5) c(x + y) = cx + cy for all x, y ∈X, c ∈F;
(6) (c + d)x = cx + dx for all x ∈X, c, d ∈F;
(7) c(dx) = (cd)x for all x ∈X, c, d ∈F;
(8) 1x = x for all x ∈X.
We use the usual notation, e.g., x −y = x + (−y).
X is a normed linear space if there exists a map x →∥x∥such
that
(1) ∥x∥≥0 for all x ∈X and ∥x∥= 0 if and only if x = 0;
(2) ∥cx∥= |c| ∥x∥for all c ∈F and x ∈X;
(3) ∥x + y∥≤∥x∥+ ∥y∥for all x, y ∈X.
Given a normed linear space X, we can make X into a metric
space by setting d(x, y) = ∥x −y∥.
A set X has an equivalence relationship “∼” if
(1) x ∼x for all x ∈X;
(2) if x ∼y, then y ∼x;
(3) if x ∼y and y ∼z, then x ∼z.
Given an equivalence relationship, X can be written as the
union of disjoint equivalence classes.
x and y are in the same
equivalence class if and only if x ∼y. For an example, let X = R
and say x ∼y if x −y is a rational number.
A set X has a partial order “≤” if
(1) x ≤x for all x ∈X;
(2) if x ≤y and y ≤x, then x = y.
Note that given x, y ∈X, it is not necessarily true that x ≤y
or y ≤x. For an example, let Y be a set, let X be the collection
of all subsets of Y , and say A ≤B if A, B ∈X and A ⊂B.

1.2. SOME UNDERGRADUATE MATHEMATICS
5
We need the following three facts about the real line.
Proposition 1.4 Suppose K ⊂R, K is closed, and K is contained
in a ﬁnite interval. Then K is compact.
Proposition 1.5 Suppose G ⊂R is open. Then G can be written
as the countable union of disjoint open intervals.
Proposition 1.6 Suppose f : R →R is an increasing function.
Then both limy→x+ f(y) and limy→x−f(y) exist for every x. More-
over the set of x where f is not continuous is countable.
For an application of Hilbert space techniques to Fourier series,
which is the last section of Chapter 19, we will use the Stone-
Weierstrass theorem.
The particular version we will use is the
following.
Theorem 1.7 Let X be a compact metric space and let A be a
collection of continuous complex-valued functions on X with the
following properties:
(1) If f, g ∈A and c ∈C, then f + g, fg, and cf are in A;
(2) If f ∈A, then f ∈A, where f is the complex conjugate of f;
(3) If x ∈X, there exists f ∈A such that f(x) ̸= 0;
(4) If x, y ∈X with x ̸= y, there exists f ∈A such that f(x) ̸=
f(y). Then the closure of A with respect to the supremum norm is
the collection of continuous complex-valued functions on X.
The conclusion can be rephrased as saying that given f contin-
uous on X and ε > 0, there exists g ∈A such that
sup
x∈X
|f(x) −g(x)| < ε.
When (3) holds, A is said to vanish at no point of X. When (4)
holds, A is said to separate points. In (3) and (4), the function f
depends on x and on x and y, resp.
For a proof of Theorem 1.7 see [1] or [3].

6
CHAPTER 1. PRELIMINARIES

Chapter 2
Families of sets
2.1
Algebras and σ-algebras
When we turn to constructing measures in Chapter 4, we will see
that we cannot in general deﬁne the measure of an arbitrary set.
We will have to restrict the class of sets we consider. The class of
sets that we will want to use are σ-algebras (read “sigma algebras”).
Let X be a set.
Deﬁnition 2.1 An algebra is a collection A of subsets of X such
that
(1) ∅∈A and X ∈A;
(2) if A ∈A, then Ac ∈A;
(3) if A1, . . . , An ∈A, then ∪n
i=1Ai and ∩n
i=1Ai are in A.
A is a σ-algebra if in addition
(4) whenever A1, A2, . . . are in A, then ∪∞
i=1Ai and ∩∞
i=1Ai are in
A.
In (4) we allow countable unions and intersections only; we do
not allow uncountable unions and intersections. Since ∩∞
i=1Ai =
(∪∞
i=1Ac
i)c, the requirement that ∩∞
i=1Ai be in A is redundant.
The pair (X, A) is called a measurable space. A set A is measurable
if A ∈A.
7

8
CHAPTER 2. FAMILIES OF SETS
Example 2.2 Let X = R, the set of real numbers, and let A be
the collection of all subsets of R. Then A is a σ-algebra.
Example 2.3 Let X = R and let
A = {A ⊂R : A is countable or Ac is countable}.
Verifying parts (1) and (2) of the deﬁnition is easy.
Suppose
A1, A2, . . . are each in A. If each of the Ai are countable, then
∪iAi is countable, and so is in A. If Ac
i0 is countable for some i0,
then
(∪Ai)c = ∩iAc
i ⊂Ac
i0
is countable, and again ∪iAi is in A. Since ∩Ai = (∪iAc
i)c, then
the countable intersection of sets in A is again in A.
Example 2.4 Let X = [0, 1] and let A = {∅, X, [0, 1
2], ( 1
2, 1]}.
Then A is a σ-algebra.
Example 2.5 Let X = {1, 2, 3} and let A = {X, ∅, {1}, {2, 3}}.
Then A is a σ-algebra.
Example 2.6 Let X = [0, 1], and let B1, . . . , B8 be subsets of X
which are pairwise disjoint and whose union is all of X. Let A be
the collection of all ﬁnite unions of the Bi’s as well as the empty
set. (Thus A consists of 28 elements.) Then A is a σ-algebra.
Lemma 2.7 If Aα is a σ-algebra for each α in some index set I,
then ∩α∈IAα is a σ-algebra.
Proof. This follows immediately from the deﬁnition.
If we have a collection C of subsets of X, deﬁne
σ(C) = ∩{Aα : Aα is a σ-algebra, C ⊂A},
the intersection of all σ-algebras containing C. Since there is at
least one σ-algebra containing C, namely, the one consisting of all
subsets of X, we are never taking the intersection over an empty
class of σ-algebras. In view of Lemma 2.7, C is a σ-algebra. We
call σ(C) the σ-algebra generated by the collection C, or say that

2.1. ALGEBRAS AND σ-ALGEBRAS
9
C generates the σ-algebra σ(C). It is clear that if C1 ⊂C2, then
σ(C1) ⊂σ(C2). Since σ(C) is a σ-algebra, then σ(σ(C)) = σ(C).
If X has some additional structure, say, it is a metric space,
then we can talk about open sets. If G is the collection of open
subsets of X, then we call σ(G) the Borel σ-algebra on X, and this
is often denoted B. Elements of B are called Borel sets and are
said to be Borel measurable.
We will see later that when X is the
real line, B is not equal to the collection of all subsets of X.
We end this section with the following proposition.
Proposition 2.8 If X = R, then the Borel σ-algebra B is gener-
ated by each of the following collection of sets:
(1)
C1 = {(a, b) : a, b ∈R};
(2)
C2 = {[a, b] : a, b ∈R};
(3)
C3 = {(a, b] : a, b ∈R};
(4)
C4 = {(a, ∞) : a ∈R}.
Proof.
(1) Let G be the collection of open sets. By deﬁnition,
σ(G) is the Borel σ-algebra.
Since every element of C1 is open,
then C1 ⊂G, and consequently σ(C1) ⊂σ(G) = B.
To get the reverse inclusion, if G is open, it is the countable
union of open intervals by Proposition 1.5. Every ﬁnite open in-
terval is in C1. Since (a, ∞) = ∪∞
n=1(a, a + n), then (a, ∞) ∈σ(C1)
if a ∈R and similarly (−∞, a) ∈σ(C1) if a ∈R.
Hence if
G is open, then G ∈σ(C1).
This says G ⊂σ(C1), and then
B = σ(G) ⊂σ(σ(C1)) = σ(C1).
(2) If [a, b] ∈C2, then [a, b] = ∩∞
n=1(a −1
n, b + 1
n) ∈σ(G).
Therefore C2 ⊂σ(G), and hence σ(C2) ⊂σ(σ(G)) = σ(G) = B.
If (a, b) ∈C1, choose n0 ≥2/(b −a) and note
(a, b) = ∪∞
n=n0
h
a + 1
n, b −1
n
i
∈σ(C2).
Therefore C1 ⊂σ(C2), from which it follows that B = σ(C1) ⊂
σ(σ(C2)) = σ(C2).
(3) Using (a, b] = ∩∞
n=1(a, b + 1
n), we see that C3 ⊂σ(C1), and
as above we conclude that σ(C3) ⊂σ(C1) = B.
Using (a, b) =
∪∞
n=n0(a, b −1
n], provided n0 is taken large enough, C1 ⊂σ(C3),
and as above we argue that B = σ(C1) ⊂σ(C3).

10
CHAPTER 2. FAMILIES OF SETS
(4) Because (a, b] = (a, ∞) −(b, ∞), then C1 ⊂σ(C4). Since
(a, ∞) = ∪∞
n=1(a, a + n], then C4 ⊂σ(C3). As above, this is enough
to imply that σ(C4) = B.
2.2
The monotone class theorem
This section will be used in Chapter 11.
Deﬁnition 2.9 A monotone class is a collection of subsets M of
X such that
(1) if Ai ↑A and each Ai ∈M, then A ∈M;
(2) if Ai ↓A and each Ai ∈M, then A ∈M.
The intersection of monotone classes is a monotone class, and
the intersection of all monotone classes containing a given collection
of sets is the smallest monotone class containing that collection.
The next theorem, the monotone class theorem, is rather tech-
nical, but very useful.
Theorem 2.10 Suppose A0 is an algebra, A is the smallest σ-
algebra containing A0, and M is the smallest monotone class con-
taining A0. Then M = A.
Proof. A σ-algebra is clearly a monotone class, so M ⊂A. We
must show A ⊂M.
Let N1 = {A ∈M : Ac ∈M}. Note N1 is contained in M and
contains A0. If Ai ↑A and each Ai ∈N1, then each Ac
i ∈M and
Ac
i ↓Ac. Since M is a monotone class, Ac ∈M, and so A ∈N1.
Similarly, if Ai ↓A and each Ai ∈N1, then A ∈N1. Therefore N1
is a monotone class. Hence N1 = M, and we conclude M is closed
under the operation of taking complements.
Let N2 = {A ∈M : A ∩B ∈M for all B ∈A0}.
Note
the following: N2 is contained in M and N2 contains A0 because
A0 is an algebra. If Ai ↑A, each Ai ∈N2, and B ∈A0, then
A∩B = ∪∞
i=1(Ai∩B). Because M is a monotone class, A∩B ∈M,
which implies A ∈N2. We use a similar argument when Ai ↓A.

2.3. EXERCISES
11
Therefore N2 is a monotone class, and we conclude N2 = M. In
other words, if B ∈A0 and A ∈M, then A ∩B ∈M.
Let N3 = {A ∈M : A ∩B ∈M for all B ∈M}.
As in
the preceding paragraph, N3 is a monotone class contained in M.
By the last sentence of the preceding paragraph, N3 contains A0.
Hence N3 = M.
We thus have that M is a monotone class closed under the
operations of taking complements and taking intersections. This
shows M is a σ-algebra, and so A ⊂M.
2.3
Exercises
Exercise 2.1 Find an example of a set X and a monotone class
M consisting of subsets of X such that ∅∈M, X ∈M, but M is
not a σ-algebra.
Exercise 2.2 Find an example of a set X and two σ-algebras A1
and A2, each consisting of subsets of X, such that A1 ∪A2 is not
a σ-algebra.
Exercise 2.3 Suppose A1 ⊂A2 ⊂· · · are σ-algebras consisting
of subsets of a set X. Is ∪∞
i=1Ai necessarily a σ-algebra? If not,
give a counterexample.
Exercise 2.4 Suppose M1 ⊂M2 ⊂· · · are monotone classes.
Let M = ∪∞
n=1Mn. Suppose Aj ↑A and each Aj ∈M. Is A
necessarily in M? If not, give a counterexample.
Exercise 2.5 Let (Y, A) be a measurable space and let f map
X onto Y , but do not assume that f is one-to-one. Deﬁne B =
{f −1(A) : A ∈A}. Prove that B is a σ-algebra of subsets of X.
Exercise 2.6 Suppose A is a σ-algebra with the property that
whenever A ∈A, there exist B, C ∈A with B ∩C = ∅, B ∪C = A,
and neither B nor C is empty. Prove that A is uncountable.
Exercise 2.7 Suppose F is a collection of real-valued functions on
X such that the constant functions are in F and f + g, fg, and cf

12
CHAPTER 2. FAMILIES OF SETS
are in F whenever f, g ∈F and c ∈R. Suppose f ∈F whenever
fn →f and each fn ∈F. Deﬁne the function
χA(x) =
(
1,
x ∈A;
0,
x /∈A.
Prove that A = {A ⊂X : χA ∈F} is a σ-algebra.
Exercise 2.8 Does there exist a σ-algebra which has countably
many elements, but not ﬁnitely many?

Chapter 3
Measures
In this chapter we give the deﬁnition of a measure, some examples,
and some of the simplest properties of measures.
Constructing
measures is often quite diﬃcult and we defer the construction of
the most important one, Lebesgue measure, until Chapter 4
3.1
Deﬁnitions and examples
Deﬁnition 3.1 Let X be a set and A a σ-algebra consisting of
subsets of X. A measure on (X, A) is a function µ : A →[0, ∞]
such that
(1)
µ(∅) = 0;
(2) if Ai ∈A, i = 1, 2, . . ., are pairwise disjoint, then
µ(∪∞
i=1Ai) =
∞
X
i=1
µ(Ai).
Saying the Ai are pairwise disjoint means that Ai ∩Aj = ∅if i ̸= j.
Deﬁnition 3.1(2) is known as countable additivity. We say a set
function is ﬁnitely additive if µ(∪n
i=1Ai) = Pn
i=1 µ(Ai) whenever
A1, . . . , An are in A and are pairwise disjoint.
The triple (X, A, µ) is called a measure space.
13

14
CHAPTER 3. MEASURES
Example 3.2 Let X be any set, A the collection of all subsets of
X, and µ(A) the number of elements in A. µ is called counting
measure.
Example 3.3 Let X = R, A the collection of all subsets of R,
x1, x2, . . . ∈R, and a1, a2, . . . ≥0. Set
µ(A) =
X
{i:xi∈A}
ai.
Counting measure is a particular case of this is if xi = i and all the
ai = 1.
Example 3.4 Let δx(A) = 1 if x ∈A and 0 otherwise.
This
measure is called point mass at x.
Proposition 3.5 The following hold:
(1) If A, B ∈A with A ⊂B, then µ(A) ≤µ(B).
(2) If Ai ∈A and A = ∪∞
i=1Ai, then µ(A) ≤P∞
i=1 µ(Ai).
(3) Suppose Ai ∈A and Ai ↑A. Then µ(A) = limn→∞µ(An).
(4) Suppose Ai ∈A and Ai ↓A. If µ(A1) < ∞, then we have
µ(A) = limn→∞µ(An).
Proof. (1) Let A1 = A, A2 = B −A, and A3 = A4 = · · · = ∅.
Now use part (2) of the deﬁnition of measure to write
µ(B) = µ(A) + µ(B −A) + 0 + 0 + · · · ≥µ(A).
(2) Let B1 = A1, B2 = A2 −A1, B3 = A3 −(A1 ∪A2), B4 =
A4 −(A1 ∪A2 ∪A3), and in general Bi = Ai −(∪i−1
j=1Aj). The Bi
are pairwise disjoint, Bi ⊂Ai for each i, and ∪∞
i=1Bi = ∪∞
i=1Ai.
Hence
µ(A) = µ(∪∞
i=1Bi) =
∞
X
i=1
µ(Bi) ≤
∞
X
i=1
µ(Ai).
(3) Deﬁne the Bi as in (2). Since ∪n
i=1Bi = ∪n
i=1Ai, then
µ(A) = µ(∪∞
i=1Ai) = µ(∪∞
i=1Bi) =
∞
X
i=1
µ(Bi)
= lim
n→∞
n
X
i=1
µ(Bi) = lim
n→∞µ(∪n
i=1Bi) = lim
n→∞µ(∪n
i=1Ai).

3.1. DEFINITIONS AND EXAMPLES
15
(4) Apply (3) to the sets A1 −Ai, i = 1, 2, . . .. The sets A1 −Ai
increase to A1 −A, and so
µ(A1) −µ(A) = µ(A1 −A) = lim
n→∞µ(A1 −An)
= lim
n→∞[µ(A1) −µ(An)].
Now subtract µ(A1) from both sides and then multiply both sides
by −1.
Example 3.6 To see that µ(A1) < ∞is necessary in Proposition
3.5, let X be the positive integers, µ counting measure, and Ai =
{i, i + 1, . . .}.
Then the Ai decrease, µ(Ai) = ∞for all i, but
µ(∩iAi) = µ(∅) = 0.
Deﬁnition 3.7 A measure µ is a ﬁnite measure if µ(X) < ∞. A
measure µ is σ-ﬁnite if there exist sets Ei ∈A for i = 1, 2, . . . such
that µ(Ei) < ∞for each i and X = ∪∞
i=1Ei. If µ is a ﬁnite measure,
then (X, A, µ) is called a ﬁnite measure space, and similarly, if µ
is a σ-ﬁnite measure, then (X, A, µ) is called a σ-ﬁnite measure
space.
If we let Fn = ∪n
i=1Ei, then µ(Fn) < ∞for each n and Fn ↑X.
Therefore there is no loss of generality in supposing the sets Ei in
Deﬁnition 3.7 are increasing.
Let (X, A, µ) be a measure space. A subset A ⊂X is a null set
if there exists a set B ∈A with A ⊂B and µ(B) = 0. We do not
require A to be in A. If A contains all the null sets, then (X, A, µ)
is said to be a complete measure space. The completion of A is the
smallest σ-algebra A containing A such that (X, A, µ) is complete.
Sometimes one just says that A is complete or that µ is complete
when (X, A, µ) is complete.
A probability or probability measure is a measure µ such that
µ(X) = 1.
In this case we usually write (Ω, F, P) instead of
(X, A, µ), and F is called a σ-ﬁeld, which is the same thing as
a σ-algebra.

16
CHAPTER 3. MEASURES
3.2
Exercises
Exercise 3.1 Suppose (X, A) is a measurable space and µ is a
non-negative set function that is ﬁnitely additive and such that
µ(∅) = 0. Suppose that whenever Ai is an increasing sequence of
sets in A, then µ(∪iAi) = limi→∞µ(Ai). Show that µ is a measure.
Exercise 3.2 Let X be an uncountable set and let A be the collec-
tion of subsets A of X such that either A or Ac is countable. Deﬁne
µ(A) = 0 if A is countable and µ(A) = 1 if A is uncountable. Prove
that µ is a measure.
Exercise 3.3 Suppose (X, A, µ) is a measure space and A, B ∈A.
Prove that
µ(A) + µ(B) = µ(A ∪B) + µ(A ∩B).
Exercise 3.4 3. Prove that if µ1, µ2, . . . are measures on a mea-
surable space and a1, a2, . . . ∈[0, ∞), then P∞
n=1 anµn is also a
measure.
Exercise 3.5 3. Prove that if (X, A, µ) is a measure space, B ∈A,
and we deﬁne ν(A) = µ(A ∩B) for A ∈A, then ν is a measure.
Exercise 3.6 Suppose µ1, µ2, . . . are measures on a measurable
space (X, A) and µn(A) ↑for each A ∈A. Deﬁne
µ(A) = lim
n→∞µn(A).
Is µ necessarily a measure? If not, give a counterexample. What
if µn(A) ↓for each A ∈A and µ1(X) < ∞?
Exercise 3.7 Let (X, A, µ) be a measure space, let N be the col-
lection of null sets with respect to A, and let B = σ(A ∪N). Show
that (X, B, µ) is complete and is the completion of (X, A, µ).
Exercise 3.8 Suppose X is the set of real numbers, B is the Borel
σ-algebra, and m and n are two measures on (X, B) such that
m((a, b)) = n((a, b)) whenever a < b. Prove that m(A) = n(A)
whenever A ∈B.

3.2. EXERCISES
17
Exercise 3.9 Suppose (X, A) is a measurable space and C is an
arbitrary subset of A.
Suppose m and n are two σ-ﬁnite mea-
sures on (X, A) such that m(A) = n(A) for all A ∈C. Is it true
that m(A) = n(A) for all A ∈σ(C)? What if m and n are ﬁnite
measures?

18
CHAPTER 3. MEASURES

Chapter 4
Construction of
measures
Our goal in this chapter is give a method for constructing measures.
This is a complicated procedure, and involves the concept of outer
measure, which we introduce in Section 4.1.
Our most important example will be one-dimensional Lebesgue
measure, which we consider in Section 4.2.
Further results and
some examples related to Lebesgue measure are given in Section
4.3.
One cannot deﬁne the Lebesgue measure of every subset of the
reals. This is shown in Section 4.4.
The methods used to construct measures via outer measures
have other applications besides the construction of Lebesgue mea-
sure. The Carath´eodory extension theorem is a tool developed in
Section 4.5 that can be used in constructing measures.
Let us present some of the ideas used in the construction of
Lebesgue measure on the line. We want the measure m of an open
interval to be the length of the interval. Since every open subset
of the reals is the countable union of disjoint open intervals (see
Proposition 1.5), if G = ∪∞
i=1(ai, bi), where the intervals (ai, bi) are
pairwise disjoint, we must have
m(G) =
∞
X
i=1
(bi −ai).
19

20
CHAPTER 4. CONSTRUCTION OF MEASURES
We then set
m(E) = inf{m(G) : G open, A ⊂G}
for arbitrary subsets E ⊂R.
The diﬃculty is that m is not a
measure on the σ-algebra consisting of all subsets of the reals; this
is proved in Section 4.4. We resolve this by considering a strictly
smaller σ-algebra. This is the essential idea behind the construction
of Lebesgue measure, but it is technically simpler to work with
intervals of the form (a, b] rather than open intervals.
4.1
Outer measures
We begin with the notion of outer measure.
Deﬁnition 4.1 Let X be a set. An outer measure is a function
µ∗deﬁned on the collection of all subsets of X satisfying
(1) µ∗(∅) = 0;
(2) if A ⊂B, then µ∗(A) ≤µ∗(B);
(3) µ∗(∪∞
i=1Ai) ≤P∞
i=1 µ∗(Ai) whenever A1, A2, . . . are subsets of
X.
A set N is a null set with respect to µ∗if µ∗(N) = 0.
A common way to generate outer measures is as follows.
Proposition 4.2 Suppose C is a collection of subsets of X such
that ∅and X are both in C. Suppose ℓ: C →[0, ∞] with ℓ(∅) = 0.
Deﬁne
µ∗(E) = inf
n ∞
X
i=1
ℓ(Ai) : Ai ∈C for each i and E ⊂∪∞
i=1Ai
o
.
(4.1)
Then µ∗is an outer measure.
Proof. (1) and (2) of the deﬁnition of outer measure are obvious.
To prove (3), let A1, A2, . . . be subsets of X and let ε > 0. For
each i there exist Ci1, Ci2, . . . ∈C such that Ai ⊂∪∞
j=1Cij and

4.1. OUTER MEASURES
21
P
j ℓ(Cij) ≤µ∗(Ai) + ε/2i. Then ∪∞
i=1Ai ⊂∪i ∪j Cij and
µ∗(∪∞
i=1Ai) ≤
X
i,j
ℓ(Cij) =
X
i
 X
j
ℓ(Cij)

≤
∞
X
i=1
µ∗(Ai) +
∞
X
i=1
ε/2i
=
∞
X
i=1
µ∗(Ai) + ε.
Since ε is arbitrary, µ∗(∪∞
i=1Ai) ≤P∞
i=1 µ∗(Ai).
Example 4.3 Let X = R and let C be the collection of intervals
of the form (a, b], that is, intervals that are open on the left and
closed on the right. Let ℓ(I) = b −a if I = (a, b]. Deﬁne µ∗by
(4.1). Proposition 4.2 shows that µ∗is an outer measure, but we
will see in Section 4.4 that µ∗is not a measure on the collection
of all subsets of R. We will also see, however, that if we restrict
µ∗to a σ-algebra L which is strictly smaller than the collection of
all subsets of R, then µ∗will be a measure on L. That measure is
what is known as Lebesgue measure. The σ-algebra L is called the
Lebesgue σ-algebra.
Example 4.4 Let X = R and let C be the collection of intervals
of the form (a, b] as in the previous example.
Let α : R →R
be an increasing right continuous function on R.
Thus α(x) =
limy→x+ α(y) for each x and α(x) ≤α(y) if x < y. Let ℓ(I) =
α(b) −α(a) if I = (a, b]. Again deﬁne µ∗by (4.1). Again Propo-
sition 4.2 shows that µ∗is an outer measure. Restricting µ∗to
a smaller σ-algebra gives us what is known as Lebesgue-Stieltjes
measure corresponding to α. The special case where α(x) = x for
all x is Lebesgue measure.
In general we need to restrict µ∗to a strictly smaller σ-algebra
than the collection of all subsets of R, but not always. For example,
if α(x) = 0 for x < 0 and 1 for x ≥1, then the corresponding
Lebesgue-Stieltjes measure is point mass at 0 (deﬁned in Example
3.4), and the corresponding σ-algebra is the collection of all subsets
of R.

22
CHAPTER 4. CONSTRUCTION OF MEASURES
Deﬁnition 4.5 Let µ∗be an outer measure.
A set A ⊂X is
µ∗-measurable if
µ∗(E) = µ∗(E ∩A) + µ∗(E ∩Ac)
(4.2)
for all E ⊂X.
Theorem 4.6 If µ∗is an outer measure on X, then the collection
A of µ∗-measurable sets is a σ-algebra. If µ is the restriction of µ∗
to A, then µ is a measure. Moreover, A contains all the null sets.
This is sometimes known as Carath´eodory’s theorem, but do not
confuse this with the Carath´eodory extension theorem in Section
4.5.
Proof. By Deﬁnition 4.1,
µ∗(E) ≤µ∗(E ∩A) + µ∗(E ∩Ac)
for all E ⊂X. Thus to check (4.2) it is enough to show
µ∗(E) ≥µ∗(E ∩A) + µ∗(E ∩Ac).
This will be trivial in the case µ∗(E) = ∞.
Step 1. First we show A is an algebra. If A ∈A, then Ac ∈A by
symmetry and the deﬁnition of A. Suppose A, B ∈A and E ⊂X.
Then
µ∗(E) = µ∗(E ∩A) + µ∗(E ∩Ac)
= [µ∗(E ∩A ∩B) + µ∗(E ∩A ∩Bc)]
+ [µ∗(E ∩Ac ∩B) + µ∗(E ∩Ac ∩Bc)].
The second equality follows from the deﬁnition of A with E ﬁrst
replaced by E∩A and then by E∩Ac. The ﬁrst three summands on
the right of the second equals sign have a sum greater than or equal
to µ∗(E ∩(A ∪B)) because A ∪B ⊂(A ∩B) ∪(A ∩Bc) ∪(Ac ∩B).
Since Ac ∩Bc = (A ∪B)c, then
µ∗(E) ≥µ∗(E ∩(A ∪B)) + µ∗(E ∩(A ∪B)c),
which shows A ∪B ∈A. Therefore A is an algebra.

4.1. OUTER MEASURES
23
Step 2. Next we show A is a σ-algebra. Let Ai be pairwise disjoint
sets in A, let Bn = ∪n
i=1Ai, and B = ∪∞
i=1Ai. If E ⊂X,
µ∗(E ∩Bn) = µ∗(E ∩Bn ∩An) + µ∗(E ∩Bn ∩Ac
n)
= µ∗(E ∩An) + µ∗(E ∩Bn−1).
Similarly, µ∗(E ∩Bn−1) = µ∗(E ∩An−1) + µ∗(E ∩Bn−2), and
continuing, we obtain
µ∗(E ∩Bn) ≥
n
X
i=1
µ∗(E ∩Ai).
Since Bn ∈A, then
µ∗(E) = µ∗(E ∩Bn) + µ∗(E ∩Bc
n) ≥
n
X
i=1
µ∗(E ∩Ai) + µ∗(E ∩Bc).
Let n →∞. Recalling that µ∗is an outer measure,
µ∗(E) ≥
∞
X
i=1
µ∗(E ∩Ai) + µ∗(E ∩Bc)
(4.3)
≥µ∗(∪∞
i=1(E ∩Ai)) + µ∗(E ∩Bc)
= µ∗(E ∩B) + µ∗(E ∩Bc)
≥µ∗(E).
This shows B ∈A.
Now if C1, C2, . . . are sets in A, let A1 = C1, A2 = C2 −A1,
A3 = C3 −(A1 ∪A2), and in general Ai = Ci −(∪i−1
j=1Aj). Since
each Ci ∈A and A is an algebra, then Ai = Ci ∩Cc
i−1 ∈A. The
Ai are pairwise disjoint, so from the previous paragraph,
∪∞
i=1Ci = ∪∞
i=1Ai ∈A.
Also, ∩∞
i=1Ci = (∪∞
i=1Cc
i )c ∈A, and therefore A is a σ-algebra.
Step 3. We now show µ∗restricted to A is a measure. The only way
(4.3) can hold is if all the inequalities there are actually equalities,
and in particular,
µ∗(E) =
∞
X
i=1
µ∗(E ∩Ai) + µ∗(E ∩Bc).

24
CHAPTER 4. CONSTRUCTION OF MEASURES
Taking E = B, we obtain
µ∗(B) =
∞
X
i=1
µ∗(Ai),
or µ∗is countably additive on A.
Step 4. Finally, if µ∗(A) = 0 and E ⊂X, then
µ∗(E ∩A) + µ∗(E ∩Ac) = µ∗(E ∩Ac) ≤µ∗(E),
which shows A contains all the null sets.
4.2
Lebesgue-Stieltjes measures
Let X = R and let C be the collection of intervals of the form (a, b],
that is, intervals that are open on the left and closed on the right.
Let α(x) be an increasing right continuous function. This means
that α(x) ≤α(y) if x < y and limz→x+ α(z) = α(x) for all x. We
do not require α to be strictly increasing. Deﬁne
ℓ((a, b]) = α(b) −α(a).
Deﬁne
m∗(E) = inf
n ∞
X
i=1
ℓ(Ai) : Ai ∈C for each i and E ⊂∪∞
i=1Ai
o
.
(In this book we usually use m instead of µ when we are talking
about Lebesgue-Stieltjes measures.) We use Proposition 4.2 to tell
us that m∗is an outer measure. We then use Theorem 4.6 to show
that m∗is a measure on the collection of m∗-measurable sets. Note
that if K and L are adjacent intervals, that is, if K = (a, b] and
L = (b, c], then K ∪L = (a, c] and
ℓ(K) + ℓ(L) = [α(b) −α(a)] + [α(c) −α(b)]
(4.4)
= α(c) −α(a) = ℓ(K ∪L)
by the deﬁnition of ℓ.
The next step in the construction of Lebesgue-Stieltjes measure
corresponding to α is the following.

4.2. LEBESGUE-STIELTJES MEASURES
25
Proposition 4.7 Every set in the Borel σ-algebra on R is m∗-
measurable.
Proof. Since the collection of m∗-measurable sets is a σ-algebra,
it suﬃces to show that every interval J of the form (c, d] is m∗-
measurable. Let E be any set with m∗(E) < ∞; we need to show
m∗(E) ≥m∗(E ∩J) + m∗(E ∩Jc).
(4.5)
Choose I1, I2, . . ., each of the form (ai, bi], such that E ⊂∪iIi and
m∗(E) ≥
X
i
[α(bi) −α(ai)] −ε.
Since E ⊂∪iIi, we have
m∗(E ∩J) ≤
X
i
m∗(Ii ∩J)
and
m∗(E ∩Jc) ≤
X
i
m∗(Ii ∩Jc).
Adding we have
m∗(E ∩J) + m∗(E ∩Jc) ≤
X
i
[m∗(Ii ∩J) + m∗(Ii ∩Jc)].
Now Ii ∩J is an interval that is open on the left and closed on the
right, and Ii ∩Jc is the union of zero, one, or two such intervals,
depending on the relative locations of Ii and J. Using (4.4) either
zero, one, or two times, we see that
m∗(Ii ∩J) + m∗(Ii ∩Jc) = m∗(Ii).
Thus
m∗(E ∩J) + m∗(E ∩Jc) ≤
X
i
m∗(Ii) ≤m∗(E) + ε.
Since ε is arbitrary, this proves (4.5).
After all this work, it would be upsetting if the measure of a
half-open interval (e, f] were not what it is supposed to be. For-
tunately, everything is ﬁne, due to Proposition 4.9. First we need
the following lemma.

26
CHAPTER 4. CONSTRUCTION OF MEASURES
Lemma 4.8 Let Jk = (ak, bk), k = 1, . . . , n, be a ﬁnite collection
of ﬁnite open intervals covering a ﬁnite closed interval [C, D]. Then
n
X
k=1
[α(bk) −α(ak)] ≥α(D) −α(C).
(4.6)
Proof. Since {Jk} is a cover of [C, D], there exists at least one
interval, say, Jk1, such that C ∈Jk1. If Jk1 covers [C, D], we stop.
Otherwise, bk1 ≤D, and there must be at least one interval, say,
Jk2, such that bk1 ∈Jk2. If [C, D] ⊂Jk1 ∪Jk2, we stop. If not, then
bk1 < bk2 ≤D, and there must be at least one interval, say, Jk3 that
contains bk2. At each stage we choose Jkj so that bkj−1 ∈Jkj. We
continue until we have covered [C, D] with intervals Jk1, . . . , Jkm.
Since {Jk} is a ﬁnite cover, we will stop for some m ≤n.
By our construction we have
ak1 ≤C < bk1,
akm < D < bkm,
and for 2 ≤j ≤m,
akj < bkj−1 < bkj.
Then
α(D) −α(C) ≤α(bkm) −α(ak1)
= [α(bkm) −α(bkm−1)] + [α(bkm−1) −α(bkm−2)] + · · ·
+ [α(bk2) −α(bk1)] + [α(bk1) −α(ak1)]
≤[α(bkm) −α(akm)] + [α(bkm−1) −α(akm−1)] + · · ·
+ [α(bk2) −α(ak2)] + [α(bk1) −α(ak1)].
Since {Jk1, . . . , Jkm} ⊂{J1, . . . , Jn}, this proves (4.6).
Proposition 4.9 If e and f are ﬁnite and I = (e, f], then m∗(I) =
ℓ(I).
Proof. First we show m∗(I) ≤ℓ(I). This is easy. Let A1 = I and
A2 = A3 = · · · = ∅. Then I ⊂∪∞
i=1Ai, hence
m∗(I) ≤
∞
X
i=1
ℓ(Ai) = ℓ(A1) = ℓ(I).

4.3. EXAMPLES AND RELATED RESULTS
27
For the other direction, suppose I ⊂∪∞
i=1Ai, where Ai = (ci, di].
Let ε > 0 and choose C ∈(e, f) such that α(C) −α(e) < ε/2.
This is possible by the right continuity of α.
Let D = f.
For
each i, choose d′
i > di such that α(d′
i) −α(di) < ε/2i+1 and let
Bi = (ci, d′
i).
Then [C, D] is compact and {Bi} is an open cover for [C, D].
Use compactness to choose a ﬁnite subcover {J1, . . . , Jn} of {Bi}.
We now apply Lemma 4.8. We conclude that
ℓ(I) ≤α(D)−α(C)+ε/2 ≤
n
X
k=1
(α(d′
k)−α(ck))+ε/2 ≤
∞
X
i=1
ℓ(Ai)+ε.
Taking the inﬁmum over all countable collections {Ai} that
cover I, we obtain
ℓ(I) ≤m∗(I) + ε.
Since ε is arbitrary, ℓ(I) ≤m∗(I).
We now drop the asterisks from m∗and call m Lebesgue-Stieltjes
measure. In the special case where α(x) = x, m is Lebesgue mea-
sure. In the special case of Lebesgue measure, the collection of m∗-
measurable sets is called the Lebesgue σ-algebra. A set is Lebesgue
measurable if it is in the Lebesgue σ-algebra.
Given a measure µ on R such that µ(K) < ∞whenever K is
compact, deﬁne α(x) = µ((0, x]) if x ≥0 and α(x) = −µ((x, 0]) if
x < 0. Then α is increasing, right continuous, and Exercise 4.1 asks
you to show that µ is Lebesgue-Stieltjes measure corresponding to
α.
4.3
Examples and related results
Example 4.10 Let m be Lebesgue measure. If x ∈R, then {x}
is a closed set and hence is Borel measurable. Moreover
m({x}) = lim
n→∞m((x −(1/n), x]) = lim
n→∞[x −(x −(1/n))] = 0.
We then conclude
m([a, b]) = m((a, b]) + m({a}) = b −a + 0 = b −a

28
CHAPTER 4. CONSTRUCTION OF MEASURES
and
m((a, b)) = m((a, b]) −m({b}) = b −a −0 = b −a.
Since σ-algebras are closed under the operation of countable
unions, then countable sets are Borel measurable.
Adding 0 to
itself countably many times is still 0, so the Lebesgue measure of
a countable set is 0.
However there are uncountable sets which have Lebesgue mea-
sure 0. See the next example.
Example 4.11 Recall from undergraduate analysis that the Can-
tor set is constructed as follows. Let F0 be the interval [0, 1]. We
let F1 be what remains if we remove the middle third, that is,
F1 = F0 −( 1
3, 2
3).
F1 consists of two intervals of length 1
3 each. We remove the middle
third of each of these two intervals and let
F2 = F1 −[( 1
9, 2
9) ∪( 7
9, 8
9)].
We continue removing middle thirds, and the Cantor set F is ∩nFn.
Recall that the Cantor set is closed, uncountable, and every point
is a limit point. Moreover, it contains no intervals.
The measure of F1 is 2( 1
3), the measure of F2 is 4( 1
9), and the
measure of Fn is ( 2
3)n. Since the Cantor set C is the intersection
of all these sets, the Lebesgue measure of C is 0.
Suppose we deﬁne f0 to be 1
2 on the interval ( 1
3, 2
3), to be 1
4 on
the interval ( 1
9, 2
9), to be 3
4 on the interval ( 7
9, 8
9), and so on. Deﬁne
f(x) = inf{f0(y) : y ≥x} for x < 1. Deﬁne f(1) = 1. Notice
f = f0 on the complement of the Cantor set.
f is increasing,
so it has only jump discontinuities; see Proposition 1.6. But if it
has a jump continuity, there is a rational of the form k/2n with
k ≤2n that is not in the range of f. On the other hand, by the
construction, each of the values {k/2n : n ≥0, k ≤2n} is taken by
f0 for some point in the complement of C, and so is taken by f.
The only way this can happen is if f is continuous. This function
f is called the Cantor-Lebesgue function or sometimes simply the
Cantor function. We will use it in examples later on. For now, we
note that it a function that increases only on the Cantor set, which
is a set of Lebesgue measure 0, yet f is continuous.

4.3. EXAMPLES AND RELATED RESULTS
29
Example 4.12 Let q1, q2, . . . be an enumeration of the rationals,
let ε > 0, and let Ii be the interval (qi −ε/2i, qi + ε/2i). Then the
measure of Ii is ε/2i−1, so the measure of ∪iIi is at most 2ε. (It is
not equal to that because there is a lot of overlap.) Therefore the
measure of A = [0, 1] −∪iIi is larger than 1 −2ε. But A contains
no rational numbers.
Example 4.13 Let us follow the construction of the Cantor set,
with this diﬀerence. Instead of removing the middle third at the
ﬁrst stage, remove the middle fourth, i.e., remove ( 3
8, 5
8). On each
of the two intervals that remain, remove the middle sixteenths. On
each of the four intervals that remain, remove the middle interval
of length
1
64, and so on. The total that we removed is
1
4 + 2( 1
16) + 4( 1
64) + · · · = 1
2.
The set that remains contains no intervals, is closed, every point
is a limit point, is uncountable, and has measure 1/2. Such a set
is called a generalized Cantor set. Of course, other choices than 1
4,
1
16, etc. are possible.
Let A ⊂[0, 1] be a Borel measurable set. We will show that
A is “almost equal” to the countable intersection of open sets and
“almost equal” to the countable union of closed sets. (A similar
argument to what follows is possible for subsets of R that have
inﬁnite measure; see Exercise 4.2.)
Proposition 4.14 Suppose A ⊂[0, 1] is a Borel measurable set.
Let m be Lebesgue measure.
(1) Given ε > 0, there exists an open set G so that m(G−A) < ε
and A ⊂G.
(2) Given ε > 0, there exists a closed set F so that m(A−F) < ε
and F ⊂A.
(3) There exists a set H which contains A that is the countable
intersection of a decreasing sequence of open sets and m(H −A) =
0.
(4) There exists a set F which is contained in A that is the
countable union of an increasing sequence of closed sets which is
contained in A and m(A −F) = 0.

30
CHAPTER 4. CONSTRUCTION OF MEASURES
Proof. (1) There exists a set of the form E = ∪∞
j=1(aj, bj] such
that A ⊂E and m(E −A) < ε/2. Let G = ∪∞
j=1(aj, bj + ε2−j−1).
Then G is open and contains A and
m(G −E) <
∞
X
j=1
ε2−j−1 = ε/2.
Therefore
m(G −A) ≤m(G −E) + m(E −A) < ε.
(2) Find an open set G such that A′ ⊂G and m(G −A′) < ε,
where A′ = [0, 1]−A. Let F = [0, 1]−G. Then F is closed, F ⊂A,
and m(A −F) ≤m(G −A′) < ε.
(3) By (1), for each i, there is an open set Gi that contains A
and such that m(Gi −A) < 2−i. Then Hi = ∩i
j=1Gj will contain
A, is open, and since it is contained in Gi, then m(Hi −A) < 2−i.
Let H = ∩∞
i=1Hi. H need not be open, but it is the intersection of
countably many open sets. The set H is a Borel set, contains A,
and m(H −A) ≤m(Hi −A) < 2−i for each i, hence m(H −A) = 0.
(4) If A′ = [0, 1] −A, apply (3) to A′ to ﬁnd a set H containing
A′ that is the countable intersection of a decreasing sequence of
open sets and such that m(H −A′) = 0. Let J = [0, 1] −H. It is
left to the reader to verify that J has the desired properties.
The countable intersections of open sets are sometimes called
Gδ sets; the G is for geoﬀnet, the German word for “open” and
the δ for Durchschnitt, the German word for “intersection.” The
countable unions of closed sets are called Fσ sets, the F coming
from ferm´e, the French word for “closed,” and the σ coming from
Summe, the German word for “union.”
Therefore, when trying to understand Lebesgue measure, we
can look at Gδ or Fσ sets, which are not so bad, and at null sets,
which can be quite bad but don’t have positive measure.
4.4
Nonmeasurable sets
Theorem 4.15 Let m∗be deﬁned by (4.1), where C is the collec-
tion of intervals that are open on the left and closed on the right

4.5. THE CARATH´EODORY EXTENSION THEOREM
31
and ℓ((a, b]) = b −a. m∗is not a measure on the collection of all
subsets of R.
Proof. Suppose m∗is a measure. Deﬁne x ∼y if x−y is rational.
It is easy to see that this is an equivalence relationship on [0, 1].
For each equivalence class, pick an element out of that class (we
need to use the axiom of choice to do this). Call the collection of
such points A. Given a set B, deﬁne B +x = {y+x : y ∈B}. Note
that ℓ((a + q, b + q]) = b −a = ℓ((a, b]) for each a, b, and q, and so
by the deﬁnition of m∗, we have m∗(A + q) = m∗(A) for each set
A and each q. Moreover, the sets A + q are disjoint for diﬀerent
rationals q.
Now
[0, 1] ⊂∪q∈[−1,1]∩Q(A + q),
where the sum is only over rational q, so
1 ≤
X
q∈[−1,1],q∈Q
m∗(A + q),
and therefore m∗(A) > 0. But
∪q∈[−1,1]∩Q(A + q) ⊂[−1, 2],
where again the sum is only over rational q, so if m∗is a measure,
then
3 ≥
X
q∈[0,1],q∈Q
m∗(A + q),
which implies m∗(A) = 0, a contradiction.
4.5
The Carath´eodory extension theo-
rem
We prove the Carath´eodory extension theorem in this section. This
theorem abstracts some of the techniques used above to give a tool
for constructing measures in a variety of contexts.
Let A0 be an algebra but not necessarily a σ-algebra. Saying
ℓis a measure on A0 means the following: (1) of Deﬁnition 3.1

32
CHAPTER 4. CONSTRUCTION OF MEASURES
holds and if A1, A2, . . . are pairwise disjoint elements of A0 and
also ∪∞
i=1Ai ∈A0, then ℓ(∪∞
i=1Ai) = P∞
i=1 ℓ(Ai). Sometimes one
calls a measure on an algebra a premeasure. Recall σ(A0) is the
σ-algebra generated by A0.
Theorem 4.16 Suppose A0 is an algebra and ℓ: A0 →[0, ∞] is
a measure on A0. Deﬁne
µ∗(E) = inf
n ∞
X
i=1
ℓ(Ai) : each Ai ∈A0, E ⊂∪∞
i=1Ai
o
for E ⊂X. Then
(1)
µ∗is an outer measure;
(2)
µ∗(A) = ℓ(A) if A ∈A0;
(3)
every set in A0 is µ∗-measurable;
(4)
if ℓis σ-ﬁnite, then there is a unique extension to σ(A0).
Proof. (1) is Proposition 4.2. We turn to (2). Suppose E ∈A0.
We know µ∗(E) ≤ℓ(E) since we can take A1 = E and A2, A3, . . .
empty in the deﬁnition of µ∗. If E ⊂∪∞
i=1Ai with Ai ∈A0, let
Bn = E ∩(An −(∪n−1
i=1 Ai)). Then the Bn are pairwise disjoint,
they are each in A0, and their union is E. Therefore
ℓ(E) =
∞
X
i=1
ℓ(Bi) ≤
∞
X
i=1
ℓ(Ai).
Taking the inﬁmum over all such sequences A1, A2, . . . shows that
ℓ(E) ≤µ∗(E).
Next we look at (3). Suppose A ∈A0. Let ε > 0 and let E ⊂
X. Pick B1, B2, . . . ∈A0 such that E ⊂∪∞
i=1Bi and P
i ℓ(Bi) ≤
µ∗(E) + ε. Then
µ∗(E) + ε ≥
∞
X
i=1
ℓ(Bi) =
∞
X
i=1
ℓ(Bi ∩A) +
∞
X
i=1
ℓ(Bi ∩Ac)
≥µ∗(E ∩A) + µ∗(E ∩Ac).
Since ε is arbitrary, µ∗(E) ≥µ∗(E ∩A) + µ∗(E ∩Ac). Thus A is
µ∗-measurable.
Finally, we look at (4).
Suppose we have two extensions to
σ(A0), the smallest σ-algebra containing A0. One is µ∗and let the

4.5. THE CARATH´EODORY EXTENSION THEOREM
33
other extension be called ν. We will show that if E is in σ(A0),
then µ∗(E) = ν(E).
Let us ﬁrst assume that µ∗is a ﬁnite measure. The µ∗-measur-
able sets form a σ-algebra containing A0. Because E ∈A0, E must
be µ∗-measurable and
µ∗(E) = inf
n ∞
X
i=1
ℓ(Ai) : E ⊂∪∞
i=1Ai, each Ai ∈A0
o
.
But ℓ= ν on A0, so P
i ℓ(Ai) = P
i ν(Ai). Therefore if E ⊂∪∞
i=1Ai
with each Ai ∈A0, then
ν(E) ≤
X
i
ν(Ai) =
X
i
ℓ(Ai),
which implies
ν(E) ≤µ∗(E).
(4.7)
Since we do not know that ν is constructed via an outer measure,
we must use a diﬀerent argument to get the reverse inequality. Let
ε > 0 and choose Ai ∈A0 such that µ∗(E) + ε ≥P
i ℓ(Ai) and
E ⊂∪iAi. Let A = ∪∞
i=1Ai and Bk = ∪k
i=1Ai. Observe
µ∗(E) + ε ≥
X
i
ℓ(Ai) =
X
i
µ∗(Ai) ≥µ∗(∪iAi) = µ∗(A),
hence µ∗(A −E) ≤ε. We have
µ∗(A) = lim
k→∞µ∗(Bk) = lim
k→∞ν(Bk) = ν(A).
Then
µ∗(E) ≤µ∗(A) = ν(A) = ν(E) + ν(A −E)
≤ν(E) + µ∗(A −E) ≤ν(E) + ε,
using (4.7) in the next to last inequality. Since ε is arbitrary, this
completes the proof when ℓis ﬁnite.
It remains to consider the case when ℓis σ-ﬁnite. Write X =
∪iKi, where Ki ↑X and ℓ(Ki) < ∞for each i. By the preceding
paragraph we have uniqueness for the measure ℓi deﬁned by ℓi(A) =
ℓ(A ∩Ki). If µ and ν are two extensions of ℓand A ∈σ(A0), then
µ(A) = lim
i→∞µ(A ∩Ki) = lim
i→∞ℓi(A) = lim
i→∞ν(A ∩Ki) = ν(A),
which proves µ = ν.

34
CHAPTER 4. CONSTRUCTION OF MEASURES
4.6
Exercises
Exercise 4.1 Let µ be a measure on the Borel σ-algebra of R such
that µ(K) < ∞whenever K is compact, deﬁne α(x) = µ((0, x])
if x ≥0 and α(x) = −µ((x, 0]) if x < 0.
Show that µ is the
Lebesgue-Stieltjes measure corresponding to α.
Exercise 4.2 Let m be Lebesgue measure and A a Lebesgue mea-
surable subset of R with m(A) < ∞. Let ε > 0. Show there exist
G open and F closed such that F ⊂A ⊂G and m(G −F) < ε.
Exercise 4.3 If (X, A, µ) is a measure space, deﬁne
µ∗(A) = inf{µ(B) : A ⊂B, B ∈A}
for all subsets A of X. Show that µ∗is an outer measure. Show
that each set in A is µ∗-measurable and µ∗agrees with the measure
µ on A.
Exercise 4.4 Let m be Lebesgue-Stieltjes measure corresponding
to a right continuous increasing function α. Show that for each x,
m({x}) = α(x) −lim
y→x−α(y).
Exercise 4.5 Suppose m is Lebesgue measure. Deﬁne x + A =
{x + y : y ∈A} and cA = {cy : y ∈A}. Show that for all Lebesgue
measurable sets A we have m(x+A) = m(A) and m(cA) = |c|m(A).
Exercise 4.6 Let m be Lebesgue measure. Suppose for each n,
An is a Lebesgue measurable subset of [0, 1]. Let B consist of those
points x that are in inﬁnitely many of the An.
(1) Show B is Lebesgue measurable.
(2) If m(An) > δ > 0 for each n, show m(B) ≥δ.
(3) If P∞
n=1 m(An) < ∞, prove that m(B) = 0.
(4) Give an example where P∞
n=1 m(An) = ∞, but m(B) = 0.
Exercise 4.7 Suppose ε ∈(0, 1) and m is Lebesgue measure. Find
a measurable set E ⊂[0, 1] such that the closure of E is [0, 1] and
m(E) = ε.

4.6. EXERCISES
35
Exercise 4.8 If X is a metric space, B is the Borel σ-algebra, and
µ is a measure on (X, B), then the support of µ is the smallest
closed set F such that µ(F c) = 0. Show that if F is a closed subset
of [0, 1], then there exists a ﬁnite measure on [0, 1] whose support
is F.
Exercise 4.9 Let m be Lebesgue measure. Find an example of
Lebesgue measurable subsets A1, A2, . . . of [0, 1] such that m(An) >
0 for each n, m(An∆Am) > 0 if n ̸= m, and m(An ∩Am) =
m(An)m(Am) if n ̸= m.
Exercise 4.10 Let ε ∈(0, 1), let m be Lebesgue measure, and
suppose A is a Borel measurable subset of R. Prove that if
m(A ∩I) ≤(1 −ε)m(I)
for every interval I, then m(A) = 0.
Exercise 4.11 Suppose m is Lebesgue measure and A is a Borel
measurable subset of R with m(A) > 0. Prove that if
B = {x −y : x, y ∈A},
then B contains a nonempty open interval centered at the origin.
Exercise 4.12 Let m be Lebesgue measure. Construct a Borel
subset A of R such that 0 < m(A ∩I) < m(I) for every open
interval I.
Exercise 4.13 Let N be the nonmeasurable set deﬁned in Section
4.4.
Prove that if A ⊂N and A is Lebesgue measurable, then
m(A) = 0.
Exercise 4.14 Let m be Lebesgue measure. Prove that if A is a
Lebesgue measurable subset of R and m(A) > 0, then there is a
subset of A that is nonmeasurable.
Exercise 4.15 Let X be a set and A a collection of subsets of X
that form an algebra of sets. Suppose ℓis a measure on A such
that ℓ(X) < ∞. Deﬁne µ∗using ℓas in (4.1). Prove that a set A
is µ∗-measurable if and only if
µ∗(A) = ℓ(X) −µ∗(Ac).

36
CHAPTER 4. CONSTRUCTION OF MEASURES
Exercise 4.16 Suppose µ∗is an outer measure. Show that if An ↑
A, then µ∗(An) ↑µ∗(A). Given an example to show that even if
µ∗is ﬁnite, An ↓A does not necessarily imply µ∗(An) ↓µ∗(A).
Exercise 4.17 Suppose A is a Lebesgue measurable subset of R
and
B = ∪x∈A[x −1, x + 1].
Prove that B is Lebesgue measurable.

Chapter 5
Measurable functions
We are now ready to move from sets to functions.
5.1
Measurability
Suppose we have a measurable space (X, A).
Deﬁnition 5.1 A function f : X →R is measurable or A measur-
able if {x : f(x) > a} ∈A for all a ∈R. A complex-valued function
is measurable if both its real and complex parts are measurable.
Example 5.2 Suppose f is real-valued and identically constant.
Then the set {x : f(x) > a} is either empty or all of X, so f is
measurable.
Example 5.3 Suppose f(x) = 1 if x ∈A and 0 otherwise. Then
the set {x : f(x) > a} is either ∅, A, or X. Hence f is measurable
if and only if A is in A.
Example 5.4 Suppose X is the real line with the Borel σ-algebra
and f(x) = x. Then {x : f(x) > a} = (a, ∞), and so f is measur-
able.
Proposition 5.5 Suppose f is real-valued. The following condi-
tions are equivalent.
37

38
CHAPTER 5. MEASURABLE FUNCTIONS
(1) {x : f(x) > a} ∈A for all a ∈R;
(2) {x : f(x) ≤a} ∈A for all a ∈R;
(3) {x : f(x) < a} ∈A for all a ∈R;
(4) {x : f(x) ≥a} ∈A for all a ∈R.
Proof. The equivalence of (1) and (2) and of (3) and (4) follow
from taking complements, e.g., {x : f(x) ≤a} = {x : f(x) > a}c.
If f is measurable, then
{x : f(x) ≥a} = ∩∞
n=1{x : f(x) > a −1/n}
shows that (4) holds if (1) does. If (4) holds, then (1) holds by
using the equality
{x : f(x) > a} = ∪∞
n=1{x : f(x) ≥a + 1/n}.
This completes the proof.
Proposition 5.6 If X is a metric space, A contains all the open
sets, and f : X →R is continuous, then f is measurable.
Proof. Note that {x : f(x) > a} = f −1((a, ∞)) is open, and hence
in A.
Proposition 5.7 Let c ∈R. If f and g are measurable real-valued
functions, then so are f +g, −f, cf, fg, max(f, g), and min(f, g).
Proof. If f(x) + g(x) < a, then f(x) < a −g(x), and there exists
a rational r such that f(x) < r < a −g(x). Hence
{x : f(x) + g(x) < a} = ∪r∈Q({x : f(x) < r} ∩{x : g(x) < a −r}).
This proves f + g is measurable.
Since {x : −f(x) > a} = {x : f(x) < −a}, then −f is measur-
able using Proposition 5.5.
If c > 0, then {x : cf(x) > a} = {x : f(x) > a/c} shows cf is
measurable. When c = 0, cf is measurable by Example 5.2. When

5.1. MEASURABILITY
39
c < 0, write cf = −(|c|f), which is measurable by what we have
already proved.
f 2 is measurable since for a < 0, {x : f(x) > a} = X, while for
a ≥0,
{x : f(x)2 > a) = {x : f(x) > √a} ∪{x : f(x) < −√a}.
The measurability of fg follows since
fg = 1
2[(f + g)2 −f 2 −g2].
The equality
{x : max(f(x), g(x)) > a} = {x : f(x) > a} ∪{x : g(x) > a}
shows max(f, g) is measurable, and the result for min(f, g) follows
from min(f, g) = −max(−f, −g).
Proposition 5.8 If fi is a measurable real-valued function for
each i, then so are supi fi, infi fi, lim supi→∞fi, and lim infi→∞fi.
Proof.
The result will follow for lim sup and lim inf once we
have the result for the sup and inf by using the deﬁnitions since
lim supi fi = infj supi≥j fj and similarly for the lim inf. We have
{x : supi fi > a} = ∩∞
i=1{x : fi(x) > a}, so supi fi is measurable,
and the proof for inf fi is similar.
Deﬁnition 5.9 We say f = g almost everywhere, written f = g
a.e., if {x : f(x) ̸= g(x)} has measure zero.
Similarly, we say
fi →f a.e. if the set of x where fi(x) does not converge to f(x)
has measure zero.
If X is a metric space, B is the Borel σ-algebra, and f : X →R
is measurable with respect to B, we say f is Borel measurable. If
f : R →R is measurable with respect to the Lebesgue σ-algebra,
we say f is Lebesgue measurable.
We saw in Proposition 5.6 that all continuous functions are
Borel measurable. The same is true for increasing functions on the
real line.

40
CHAPTER 5. MEASURABLE FUNCTIONS
Proposition 5.10 If f : R →R is monotone, then f is Borel
measurable.
Proof. Let us suppose f is increasing, for otherwise we look at
−f. Given a ∈R, let x0 = sup{y : f(y) ≤a}. If f(x0) ≤a, then
{x : f(x) > a} = (x0, ∞). If f(x0) > a, then {x : f(x) > a} =
[x0, ∞). In either case {x : f(x) > a} is a Borel set.
Proposition 5.11 Let (X, A) be a measurable space and let f :
X →R be a A measurable function. If A is in the Borel σ-algebra
on R, then f −1(A) ∈A.
Proof.
Let B be the Borel σ-algebra on R and C = {A ∈B :
f −1(A) ∈A}. If A1, A2, . . . ∈C, then since
f −1(∪iAi) = ∪if −1(Ai) ∈A,
we have that C is closed under countable unions. Similarly C is
closed under countable intersections and complements, so C is a
σ-algebra. Since f is measurable, C contains (a, ∞) for every real
a, hence C contains the σ-algebra generated by these intervals, that
is, C contains B.
Example 5.12 Let us construct a set that is Lebesgue measur-
able, but not Borel measurable. Recall the Lebesgue measurable
sets were constructed in Chapter 4 and include the completion of
the Borel σ-algebra.
Let f be the Cantor-Lebesgue function of Example 4.11 and
deﬁne
F(x) = inf{y : f(y) ≥x}.
Although F is not continuous, observe that F is strictly increasing
(hence one-to-one) and maps [0, 1] into C, the Cantor set. Since F
is increasing, F −1 maps Borel measurable sets to Borel measurable
sets.
Let m be Lebesgue measure and let A be the non-measurable
set we constructed in Proposition 4.15.
Let B = F(A).
Since
F(A) ⊂C and m(C) = 0, then F(A) is a null set, hence is Lebesgue
measurable. On the other hand, F(A) is not Borel measurable, be-
cause if it were, then A = F −1(F(A)) would be Borel measurable,
a contradiction.

5.2. APPROXIMATION OF FUNCTIONS
41
5.2
Approximation of functions
Deﬁnition 5.13 Let (X, A) be a measurable space. If E ∈A,
deﬁne the characteristic function of E by
χE(x) =
(
1
x ∈E;
0
x /∈E.
A simple function s is a function of the form
s(x) =
n
X
i=1
aiχEi(x)
for real numbers ai and measurable sets Ei.
Proposition 5.14 Suppose f is a non-negative and measurable
function. Then there exists a sequence of non-negative measurable
simple functions increasing to f.
Proof. Let
Eni = {x : (i −1)/2n ≤f(x) < i/2n}
and
Fn = {x : f(x) ≥n}
for n = 1, 2, . . . and i = 1, 2, . . . , n2n. Then deﬁne
sn =
n2n
X
i=1
i −1
2n χEni + nχFn.
In words, fn(x) = n if f(x) ≥n. If f(x) is between (i −1)/2n
and i/2n for i/2n ≤n, we let fn(x) = (i −1)/2n.
It is easy to see that sn has the desired properties.
5.3
Lusin’s theorem
The following theorem is known as Lusin’s theorem.
It is very
pretty but usually other methods are better for solving problems.

42
CHAPTER 5. MEASURABLE FUNCTIONS
Example 5.16 will illustrate why this is a less useful theorem than
at ﬁrst glance.
We use m for Lebesgue measure. Recall that the support of a
function f is the closure of the set {x : f(x) ̸= 0}.
Theorem 5.15 Suppose f : [0, 1] →R is Borel measurable, m is
Lebesgue measure, and ε > 0. There exists a closed set F ⊂[0, 1]
such that m([0, 1] −F) < ε and the restriction of f to F is a
continuous function on F.
This theorem can be loosely interpreted as saying every measurable
function is “almost continuous.”
Proof.
First let us suppose that f = χA, where A is a Borel
measurable subset of [0, 1].
By Proposition 4.14 we can ﬁnd E
closed and G open such that E ⊂A ⊂G and m(G −A) < ε/2
and m(A −E) < ε/2. Let δ = inf{|x −y| : x ∈E, y ∈Gc}. Since
E ⊂A ⊂[0, 1], E is compact and δ > 0. Letting
g(x) =

1 −d(x, E)
δ
+
,
where y+ = max(y, 0) and d(x, E) = inf{|x −y| : y ∈E}, we
see that g is continuous, takes values in [0, 1], is equal to 1 on
E, and equal to 0 on Gc.
Take F = (E ∪Gc) ∩[0, 1].
Then
m([0, 1] −F) ≤m(G −E) < ε, and f = g on F.
Next suppose f = PM
i=1 aiχAi is simple, where each Ai is a
measurable subset of [0, 1] and each ai ≥0. Choose Fi closed such
that m([0, 1] −Fi) < ε/M and χAi restricted to Fi is continuous.
If we let F = ∩M
i=1Fi, then F is closed, m([0, 1] −F) < ε, and f
restricted to F is continuous.
Now suppose f is non-negative, bounded by K, and has support
in [0, 1]. Let
Ain = {x : (i −1)/2n ≤f(x) < i/2n}.
Then
fn(x) =
K2n+1
X
i=1
i
2n χAin(x)
are simple functions increasing to f. Note that
hn(x) = fn+1(x) −fn(x)

5.3. LUSIN’S THEOREM
43
is also a simple function and is bounded by 2−n. Choose F0 closed
such that m([0, 1]−F0) < ε/2 and f0 restricted to F0 is continuous.
For n ≥1, choose Fn closed such that m([0, 1] −Fn) < ε/2n+1 and
hn restricted to Fn is continuous. Let F = ∩∞
n=0Fn. Then F, being
the intersection of closed sets, will be closed, and m([0, 1] −F) ≤
P∞
n=0 m([0, 1]−Fn) < ε. On the set F, we have f0(x)+P∞
n=1 hn(x)
converges uniformly to f(x) because each hn is bounded by 2−n.
The uniform limit of continuous functions is continuous, hence f is
continuous on F.
If f ≥0, let BK = {x : f(x) ≤K}. Since f is everywhere ﬁnite,
BK ↑[0, 1] as K →∞, hence m(BK) > 1 −ε/3 if K is suﬃciently
large. Choose D ⊂BK such that D is closed and m(BK−D) < ε/3.
Now choose E ⊂[0, 1] closed such that f · χD restricted to E is
continuous and m([0, 1] −E) < ε/3. Then F = D ∩E is closed,
m([0, 1] −F) < ε, and f restricted to F is continuous.
Finally, for arbitrary measurable f write f = f + −f −and ﬁnd
F + and F −closed such that m([0, 1]−F +) < ε/2, m([0, 1]−F −) <
ε/2, and f + restricted to F + is continuous and similarly for f −.
Then F = F + ∩F −is the desired set.
Example 5.16 Suppose f = χB, where B consists of the irra-
tionals in [0, 1]. f is Borel measurable because [0, 1] −B is count-
able, hence the union of countably many points, and thus the union
of countably many closed sets. Every point of [0, 1] is a point of
discontinuity of f because for any x ∈[0, 1], there are both ratio-
nals and irrationals in every neighborhood of x, hence f takes the
values 0 and 1 in every neighborhood of x.
Recall Example 4.12. f restricted to the set A there is identi-
cally one, hence f restricted to A is a continuous function. A is
closed because it is equal to the interval [0, 1] minus the union of
open intervals.
This does not contradict Lusin’s theorem. No claim is made
that the function f is continuous at most points of [0, 1]. What is
asserted is that there is a closed set F with large measure so that
f restricted to F is continuous when viewed as a function from F
to R.

44
CHAPTER 5. MEASURABLE FUNCTIONS
5.4
Exercises
Exercise 5.1 Suppose (X, A) is a measurable space, f is a real-
valued functions, and {x : f(x) > r} ∈A for each rational number
r. Prove that f is measurable.
Exercise 5.2 Let f : (0, 1) →R be such that for every x ∈(0, 1)
there exist r > 0 and a Borel measurable function g, both depend-
ing on x, such that f and g agree on B(x, r). Prove that f is Borel
measurable.
Exercise 5.3 Suppose fn are measurable functions. Prove that
A = {x : lim
n→∞fn(x) exists}
is a measurable set.
Exercise 5.4 If f : R →R is Lebesgue measurable, prove that
there exists a Borel measurable function g such that f = g a.e.
Exercise 5.5 Give an example of a collection of measurable non-
negative functions {fα}α∈A such that if g is deﬁned by g(x) =
supα∈A fα(x), then g is ﬁnite for all x but g is nonmeasurable. (A
is allowed to be uncountable.)
Exercise 5.6 Suppose f : X →R is Lebesgue measurable and
g : R →R is continuous. Prove that g ◦f is Lebesgue measurable.
Is this true if g is Borel measurable instead of continuous? Is this
true if g is Lebesgue measurable instead of continuous?
Exercise 5.7 Suppose f : R →R is Borel measurable. Deﬁne A
to be the smallest σ-algebra containing the sets {x : f(x) > a} for
every a ∈R. Suppose g : R →R is measurable with respect to
A, which means that {x : g(x) > a} ∈A for every a ∈R. Prove
that there exists a Borel measurable function h : R →R such that
g = h ◦f.
Exercise 5.8 One can show that there exist discontinuous real-
valued functions f such that
f(x + y) = f(x) + f(y)
(5.1)

5.4. EXERCISES
45
for all x, y ∈R. (The construction uses Zorn’s lemma, which is
equivalent to the axiom of choice.) Prove that if f satisﬁes (5.1)
and in addition f is Lebesgue measurable, then f is continuous.

46
CHAPTER 5. MEASURABLE FUNCTIONS

Chapter 6
The Lebesgue integral
In this chapter we deﬁne the Lebesgue integral. We only give the
deﬁnition here and consider the properties of the Lebesgue integral
in later chapters.
6.1
Deﬁnitions
Deﬁnition 6.1 Let (X, A, µ) be a measure space. If
s =
n
X
i=1
aiχEi
is a non-negative measurable simple function, deﬁne the Lebesgue
integral of s to be
Z
s dµ =
n
X
i=1
aiµ(Ei).
(6.1)
Here, if ai = 0 and µ(Ei) = ∞, we use the convention that
aiµ(Ei) = 0. If f ≥0 is a measurable function, deﬁne
Z
f dµ = sup
nZ
s dµ : 0 ≤s ≤f, s simple
o
.
(6.2)
Let f be measurable and let f + = max(f, 0) and f −= max(−f, 0).
Provided
R
f + dµ and
R
f −dµ are not both inﬁnite, deﬁne
Z
f dµ =
Z
f + dµ −
Z
f −dµ.
(6.3)
47

48
CHAPTER 6. THE LEBESGUE INTEGRAL
Finally, if f = u + iv is complex-valued and
R
(|u| + |v|) dµ is ﬁnite,
deﬁne
Z
f dµ =
Z
u dµ + i
Z
v dµ.
(6.4)
A few remarks are in order.
A function s might be written
as a simple function in more than one way.
For example s =
χA∪B = χA + χB if A and B are disjoint. It is not hard to check
that the deﬁnition of
R
s dµ is unaﬀected by how s is written. If
s = Pm
i=1 aiχAi = Pn
j=1 bjχBj, then we need to show
m
X
i=1
aiµ(Ai) =
n
X
j=1
bjµ(Bj).
(6.5)
We leave the proof of this to the reader as Exercise 6.1.
Secondly, if s is a simple function, one has to think a moment
to verify that the deﬁnition of
R
s dµ by means of (6.1) agrees with
its deﬁnition by means of (6.2).
Deﬁnition 6.2 If f is measurable and
R
|f| dµ < ∞, we say f is
integrable.
The proof of the next proposition follows from the deﬁnitions.
Proposition 6.3 (1) If f is a real-valued measurable function with
a ≤f(x) ≤b for all x and µ(X) < ∞, then aµ(X) ≤
R
f dµ ≤
bµ(X);
(2) If f and g are measurable, real-valued, and integrable and
f(x) ≤g(x) for all x, then
R
f dµ ≤
R
g dµ.
(3) If f is integrable, then
R
cf dµ = c
R
f dµ for all complex c.
(4) If µ(A) = 0 and f is integrable, then
R
fχA dµ = 0.
The integral
R
fχA dµ is often written
R
A f dµ.
Other nota-
tion for the integral is to omit the µ and write
R
f if it is clear
which measure is being used, to write
R
f(x) µ(dx), or to write
R
f(x) dµ(x).
When we are integrating a function f with respect to Lebesgue
measure m, it is usual to write
R
f(x) dx for
R
f(x) m(dx) and to

6.2. EXERCISES
49
deﬁne
Z b
a
f(x) dx =
Z
[a,b]
f(x) m(dx).
Proposition 6.4 If f is integrable,

Z
f
 ≤
Z
|f|.
Proof. For the real case, this is easy. f ≤|f|, so
R
f ≤
R
|f|. Also
−f ≤|f|, so −
R
f ≤
R
|f|. Now combine these two facts.
For the complex case,
R
f is a complex number. If it is 0, the
inequality is trivial. If it is not, then
R
f = reiθ for some r and θ.
Then

Z
f
 = r = e−iθ
Z
f =
Z
e−iθf.
From the deﬁnition of
R
f when f is complex, we have Re (
R
f) =
R
Re (f). Since |
R
f| is real, we have

Z
f
 = Re
 Z
e−iθf

=
Z
Re (e−iθf) ≤
Z
|f|.
We do not yet know that
R
(f + g) =
R
f +
R
g. We will see this
in Theorem 7.4.
6.2
Exercises
Exercise 6.1 Verify (6.5).
Exercise 6.2 Suppose f is non-negative and measurable and µ is
σ-ﬁnite. Show there exist simple functions sn increasing to f at
each point such that µ({x : sn(x) ̸= 0}) < ∞for each n.
Exercise 6.3 Let f be a non-negative measurable function. Prove
that
lim
n→∞
Z
(f ∧n) →
Z
f.

50
CHAPTER 6. THE LEBESGUE INTEGRAL
Exercise 6.4 Let (X, A, µ) be a measure space and suppose µ is
σ-ﬁnite. Suppose f is integrable. Prove that given ε there exists δ
such that
Z
A
|f(x)| µ(dx) < ε
whenever µ(A) < δ.
Exercise 6.5 Suppose µ(X) < ∞and fn is a sequence of bounded
real-valued measurable functions that converge to f uniformly.
Prove that
Z
fn dµ →
Z
f dµ.
This is sometimes called the bounded convergence theorem.
Exercise 6.6 If fn is a sequence of non-negative integrable func-
tions such that fn(x) decreases to f(x) for every x, prove that
R
fn dµ →
R
f dµ.
Exercise 6.7 Let (X, A, µ) be a measure space and suppose f is a
non-negative, measurable function that is ﬁnite at each point of X,
but not necessarily integrable. Prove that there exists a continuous
increasing function g : [0, ∞) →[0, ∞) such that limx→∞g(x) = ∞
and g ◦f is integrable.

Chapter 7
Limit theorems
The main reason the Lebesgue integral is so much easier to work
with than the Riemann integral is that it behaves nicely when
taking limits. In this chapter we prove the monotone convergence
theorem, Fatou’s lemma, and the dominated convergence theorem.
We also prove that the Lebesgue integral is linear.
7.1
Monotone convergence theorem
One of the most important results concerning Lebesgue integration
is the monotone convergence theorem.
Theorem 7.1 Suppose fn is a sequence of non-negative measur-
able functions with f1(x) ≤f2(x) ≤· · · for all x and with
lim
n→∞fn(x) = f(x)
for all x. Then
R
fn dµ →
R
f dµ.
Proof. By Proposition 6.3(2),
R
fn is an increasing sequence of
real numbers. Let L be the limit. Since fn ≤f for all n, then
L ≤
R
f. We must show L ≥
R
f.
Let s = Pm
i=1 aiχEi be any non-negative simple function less
than or equal to f and let c ∈(0, 1). Let An = {x : fn(x) ≥cs(x)}.
51

52
CHAPTER 7. LIMIT THEOREMS
Since fn(x) increases to f(x) for each x and c < 1, then An ↑X.
For each n,
Z
fn ≥
Z
An
fn ≥c
Z
An
sn
= c
Z
An
m
X
i=1
aiχEi
= c
m
X
i=1
aiµ(Ei ∩An).
If we let n →∞, by Proposition 3.5(3) the right hand side con-
verges to
c
m
X
i=1
aiµ(Ei) = c
Z
s.
Therefore L ≥c
R
s. Since c is arbitrary in the interval (0, 1), then
L ≥
R
s. Taking the supremum over all simple s ≤f, we obtain
L ≥
R
f.
Example 7.2 Let X = [0, ∞) and fn(x) = −1/n for all x. Then
R
fn = −∞, but fn ↑f where f = 0 and
R
f = 0. The reason the
monotone convergence theorem does not apply here is that the fn
are not non-negative.
Example 7.3 Suppose fn = nχ(0,1/n). Then fn ≥0, fn →0 for
each x, but
R
fn = 1 does not converge to
R
0 = 0. The reason the
monotone convergence theorem does not apply here is that the fn
do not increase to f for each x.
7.2
Linearity of the integral
Once we have the monotone convergence theorem, we can prove
that the Lebesgue integral is linear.
Theorem 7.4 If f and g are non-negative and measurable or if f
and g are integrable, then
Z
(f + g) dµ =
Z
f dµ +
Z
g dµ.

7.2. LINEARITY OF THE INTEGRAL
53
Proof. First suppose f and g are non-negative and simple, say,
f = Pm
i=1 aiχAi and g = Pn
j=1 bjχBj. Without loss of generality
we may assume that A1, . . . , Am are pairwise disjoint and that
B1, . . . , Bn are pairwise disjoint.
Since ai = 0 and bj = 0 are
permissible, we may also assume ∪m
i=1Ai = X = ∪n
j=1Bj. Then
f + g =
m
X
i=1
n
X
j=1
(ai + bj)χAi∩Bj,
and we have
Z
(f + g) =
m
X
i=1
n
X
j=1
(ai + bj)µ(Ai ∩Bj)
=
m
X
i=1
n
X
j=1
aiµ(Ai ∩Bj) +
m
X
i=1
n
X
j=1
bjµ(Ai ∩Bj)
=
m
X
i=1
aiµ(Ai) +
n
X
j=1
bjµ(Bj)
=
Z
f +
Z
g.
Thus the theorem holds in this case.
Next suppose f and g are non-negative. Take sn simple and
increasing to f and tn simple and increasing to g. Then sn + tn
are simple functions increasing to f + g, so the result follows from
the monotone convergence theorem and
Z
(f + g) = lim
n→∞
Z
(sn + tn) = lim
n→∞
Z
sn + lim
n→∞tn =
Z
f +
Z
g.
Suppose now that f and g are real-valued and integrable but
take both positive and negative values. Since
Z
|f + g| ≤
Z
(|f| + |g|) =
Z
|f| +
Z
|g| < ∞,
then f + g is integrable. Write
(f + g)+ −(f + g)−= f + g = f + −f −+ g+ −g−,
so that
(f + g)+ + f −+ g−= f + + g+ + (f + g)−.

54
CHAPTER 7. LIMIT THEOREMS
Using the result for non-negative functions,
Z
(f + g)+ +
Z
f −+
Z
g−=
Z
f + +
Z
g+ +
Z
(f + g)−.
Rearranging,
Z
(f + g) =
Z
(f + g)+ −
Z
(f + g)−
=
Z
f + −
Z
f −+
Z
g+ −
Z
g−
=
Z
f +
Z
g.
If f and g are complex-valued, apply the above to the real and
imaginary parts.
Proposition 7.5 Suppose fn are non-negative measurable func-
tions. Then
Z
∞
X
n=1
fn =
∞
X
n=1
Z
fn.
Proof. Let FN = PN
n=1 fn. Since 0 ≤Fn(x) ↑P∞
n=1 fn(x), we
can write
Z
∞
X
n=1
fn =
Z
lim
N→∞
N
X
n=1
fn
=
Z
lim
N→∞FN = lim
N→∞
Z
FN
(7.1)
= lim
N→∞
N
X
n=1
Z
fn =
∞
X
n=1
Z
fn,
using the monotone convergence theorem and the linearity of the
integral.
7.3
Fatou’s lemma
The next theorem is known as Fatou’s lemma.

7.4. DOMINATED CONVERGENCE THEOREM
55
Theorem 7.6 Suppose the fn are non-negative and measurable.
Then
Z
lim inf
n→∞fn ≤lim inf
n→∞
Z
fn.
Proof.
Let gn = infi≥n fi.
Then the gn are non-negative and
gn increases to lim infn fn.
Clearly gn ≤fi for each i ≥n, so
R
gn ≤
R
fi. Therefore
Z
gn ≤inf
i≥n
Z
fi.
(7.2)
If we take the limit in (7.2) as n →∞, on the left hand side we
obtain
R
lim infn fn by the monotone convergence theorem, while
on the right hand side we obtain lim infn
R
fn.
A typical use of Fatou’s lemma is the following. Suppose we
have fn →f and supn
R
|fn| ≤K < ∞. Then |fn| →|f|, and by
Fatou’s lemma,
R
|f| ≤K.
7.4
Dominated convergence theorem
Another very important theorem is the dominated convergence the-
orem.
Theorem 7.7 Suppose that fn are measurable real-valued func-
tions and fn(x) →f(x) for each x. Suppose there exists a non-
negative integrable function g such that |fn(x)| ≤g(x) for all x.
Then
lim
n→∞
Z
fn dµ →
Z
f dµ.
Proof. Since fn + g ≥0, by Fatou’s lemma,
Z
f +
Z
g =
Z
(f + g) ≤lim inf
n→∞
Z
(fn + g) = lim inf
n→∞fn +
Z
g.
Since g is integrable,
Z
f ≤lim inf
n→∞
Z
fn.
(7.3)

56
CHAPTER 7. LIMIT THEOREMS
Similarly, g −fn ≥0, so
Z
g−
Z
f =
Z
(g−f) ≤lim inf
n→∞
Z
(g−fn) =
Z
g+lim inf
n→∞
Z
(−fn),
and hence
−
Z
f ≤lim inf
n→∞
Z
(−fn) = −lim sup
n→∞
Z
fn.
Therefore
Z
f ≥lim sup
n→∞
Z
fn,
which with (7.3) proves the theorem.
Exercise 7.1 asks you to prove a version of the dominated con-
vergence theorem for complex-valued functions.
Example 7.3 is an example where the limit of the integrals is not
the integral of the limit because there is no dominating function g.
If in the monotone convergence theorem or dominated conver-
gence theorem we have only fn(x) →f(x) almost everywhere, the
conclusion still holds. For example, if the fn are measurable, non-
negative, and fn ↑f a.e., let A = {x : fn(x) →f(x)}.
Then
fnχA(x) ↑fχA(x) for each x. Since Ac has measure 0, we see from
Proposition 6.3(4) and the monotone convergence theorem that
lim
n
Z
fn = lim
n
Z
fnχA =
Z
fχA =
Z
f.
7.5
Exercises
Exercise 7.1 State and prove a version of the dominated conver-
gence theorem for complex-valued functions.
Exercise 7.2 The following generalized dominated convergence
theorem is often useful. Suppose fn, gn, f, and g are integrable,
fn →f a.e., gn →g a.e., |fn| ≤gn for each n, and
R
gn →
R
g.
Prove that
R
fn →
R
f.
Exercise 7.3 Give an example of a sequence of non-negative func-
tions fn tending to 0 pointwise such that
R
fn →0, but there is no
integrable function g such that fn ≤g for all n.

7.5. EXERCISES
57
Exercise 7.4 Suppose (X, A, µ) is a measure space, each fn is
integrable and non-negative, fn →f a.e., and
R
fn →
R
f. Prove
that for each A ∈A
Z
A
fn dµ →
Z
A
f dµ.
Exercise 7.5 Suppose fn and f are integrable, fn →f a.e., and
R
|fn| →
R
|f|. Prove that
Z
|fn −f| →0.
Exercise 7.6 Suppose f : R →R is integrable, a ∈R, and we
deﬁne
F(x) =
Z x
a
f(y) dy.
Show that F is a continuous function.
Exercise 7.7 Let fn be a sequence of non-negative Lebesgue mea-
surable functions on R. Is it necessarily true that
lim sup
n→∞
Z
fn dx ≤
Z
lim sup
n→∞fn dx?
If not, give a counterexample.
Exercise 7.8 Find the limit
lim
n→∞
Z n
0

1 + x
n
−n
log(2 + cos(x/n)) dx
and justify your reasoning.
Exercise 7.9 Find the limit
lim
n→∞
Z n
0

1 −x
n
n
log(2 + cos(x/n)) dx
and justify your reasoning.
Exercise 7.10 Prove that the limit exists and ﬁnd its value:
lim
n→∞
Z 1
0
1 + nx2
(1 + x2)n log(2 + cos(x/n)) dx.

58
CHAPTER 7. LIMIT THEOREMS
Exercise 7.11 Prove the limit exists and determine its value:
lim
n→∞
Z ∞
0
ne−nx sin(1/x) dx.
Exercise 7.12 Let g : R →R be integrable and let f : R →R be
bounded, measurable, and continuous at 1. Prove that
lim
n→∞
Z n
−n
f

1 + x
n2

g(x) dx
exists and determine its value.
Exercise 7.13 Suppose µ(X) < ∞, fn converges to f uniformly,
and each fn is integrable. Prove that f is integrable and
R
fn →
R
f. Is the condition µ(X) < ∞necessary?
Exercise 7.14 Prove that
∞
X
k=1
1
(p + k)2 = −
Z 1
0
xp
1 −x log x dx
for p > 0.
Exercise 7.15 Let {fn} be a sequence of real-valued functions on
[0, 1] that is uniformly bounded.
(1) Show that if A is a Borel subset of [0, 1], then there exists a
subsequence nj such that
R
A fnj(x) dx converges.
(2) Show that if {Ai} is a countable collection of Borel subsets of
[0, 1], then there exists a subsequence nj such that
R
Ai fnj(x) dx
converges for each i.
(3) Show that there exists a subsequence nj such that
R
A fnj(x) dx
converges for each Borel subset A of [0, 1].
Exercise 7.16 Let (X, A, µ) be a measure space.
A family of
measurable functions {fn} is uniformly integrable if given ε there
exists M such that
Z
{x:|fn(x)|>M}
|fn(x)| dµ < ε
for each n. The sequence is uniformly absolutely continuous if given
ε there exists δ such that

Z
A
fn dµ
 < ε

7.5. EXERCISES
59
for each n if µ(A) < δ.
Suppose µ is a ﬁnite measure. Prove that {fn} is uniformly
integrable if and only if supn
R
|fn| dµ < ∞and {fn} is uniformly
absolutely continuous.
Exercise 7.17 The following is known as the Vitali convergence
theorem. Suppose µ is a ﬁnite measure, fn →f a.e., and {fn} is
uniformly integrable. Prove that
R
fn →
R
f.
Exercise 7.18 Suppose µ is a ﬁnite measure, fn →f a.e., each
fn is integrable, f is integrable, and
R
fn →
R
f. Prove that {fn}
is uniformly integrable.
Exercise 7.19 Suppose µ is a ﬁnite measure and for some ε > 0
sup
n
Z
|fn|1+ε dµ < ∞.
Prove that {fn} is uniformly integrable.
Exercise 7.20 Suppose fn is a uniformly integrable sequence of
functions deﬁned on [0, 1]. Prove that there is a subsequence nj
such that
R 1
0 fnjg dx converges whenever g is a real-valued bounded
measurable function.
Exercise 7.21 Suppose µn is a sequence of measures on (X, A)
such that µn(X) = 1 for all n and µn(A) converges as n →∞for
each A ∈A. Call the limit µ(A).
(1) Prove that µ is a measure.
(2) Prove that
R
f dµn →
R
f dµ whenever f is bounded and mea-
surable.
(3) Prove that
Z
f dµ ≤lim inf
n→∞
Z
f dµn
whenever f is non-negative and measurable.
Exercise 7.22 Let (X, A, µ) be a measure space and let f be non-
negative and integrable. Deﬁne ν on A by
ν(A) =
Z
A
f dµ.

60
CHAPTER 7. LIMIT THEOREMS
(1) Prove that ν is a measure.
(2) Prove that if g is integrable with respect to ν, then fg is inte-
grable with respect to µ and
Z
g dν =
Z
fg dµ.
Exercise 7.23 Suppose µ and ν are positive measures on the Borel
σ-algebra on [0, 1] such that
R
f dµ =
R
f dν whenever f is real-
valued and continuous on [0, 1]. Prove that µ = ν.
Exercise 7.24 Let B be the Borel σ-algebra on [0, 1]. Let µn be a
sequence of ﬁnite measures on ([0, 1], B) and let µ be another ﬁnite
measure on ([0, 1], B). Suppose µn([0, 1]) →µ([0, 1]). Prove that
the following are equivalent:
(1)
R
f dµn →
R
f dµ whenever f is a continuous real-valued func-
tion on [0, 1];
(2) lim supn→∞µn(F) ≤µ(F) for all closed subsets F of [0, 1];
(3) lim infn→∞µn(G) ≥µ(G) for all open subsets G of [0, 1];
(4) limn→∞µn(A) = µ(A) whenever A is a Borel subset of [0, 1]
such that µ(∂A) = 0, where ∂A = A −Ao is the boundary of A;
(5) limn→∞µn([0, x]) = µ([0, x]) for every x such that µ({x}) = 0.
Exercise 7.25 Let B be the Borel σ-algebra on [0, 1]. Suppose
µn are ﬁnite measures on ([0, 1], B) such that
R
f dµn →
R 1
0 f dx
whenever f is a real-valued continuous function on [0, 1]. Suppose
that g is a bounded measurable function such that the set of dis-
continuities of g has measure 0. Prove that
Z
g dµn →
Z 1
0
g dx.
Exercise 7.26 Let B be the Borel σ-algebra on [0, 1]. Let µn be a
sequence of ﬁnite measures on ([0, 1], B) with supn µn([0, 1]) < ∞.
Deﬁne αn(x) = µn([0, x]).
(1) If r is a rational in [0, 1], prove that there exists a subsequence
{nj} such that αnj(r) converges.
(2) Prove that there exists a subsequence {nj} such that αn(r)
converges for every rational in [0, 1].
(3) Let α(r) = limn→∞αn(r) for r rational and deﬁne
α(x) =
lim
r→x,r>x,r∈Q α(r).

7.5. EXERCISES
61
This means, since clearly α(r) ≤α(s) if r < s, that
α(x) = inf{α(r) : r > x, r ∈Q}.
Let µ be the Lebesgue-Stieltjes measure associated with α. Prove
that
Z
f dµn →
Z
f dµ
whenever f is a continuous real-valued function on [0, 1].

62
CHAPTER 7. LIMIT THEOREMS

Chapter 8
Properties of Lebesgue
integrals
We present some propositions which imply that a function is zero
a.e. and we give an approximation result.
8.1
Criteria for a function to be zero a.e.
The following two propositions are very useful.
Proposition 8.1 Suppose f is real-valued and measurable and for
every measurable set A we have
R
A f dµ = 0. Then f = 0 almost
everywhere.
Proof. Let A = {x : f(x) > ε}. Then
0 =
Z
A
f ≥
Z
A
ε = εµ(A)
since fχA ≥εχA. Hence µ(A) = 0. We use this argument for
ε = 1/n and n = 1, 2, . . . to conclude
µ{x : f(x) > 0} = µ(∪∞
n=1{x : f(x) > 1/n})
≤
∞
X
n=1
µ({x : f(x) > 1/n}) = 0.
63

64 CHAPTER 8. PROPERTIES OF LEBESGUE INTEGRALS
Similarly µ{x : f(x) < 0} = 0.
Proposition 8.2 Suppose f is measurable and non-negative and
R
f dµ = 0. Then f = 0 almost everywhere.
Proof. If f is not equal to 0 almost everywhere, there exists an n
such that µ(An) > 0 where An = {x : f(x) > 1/n}. But since f is
non-negative,
0 =
Z
f ≥
Z
An
f ≥1
nµ(An),
a contradiction.
As a corollary to Proposition 8.1 we have the following.
Corollary 8.3 Let m be Lebesgue measure and a ∈R. Suppose
f : R →R is integrable and
R x
a f(y) dy = 0 for all x. Then f = 0
a.e.
Proof. For any interval [c, d],
Z d
c
f =
Z d
a
f −
Z c
a
f = 0.
By linearity, if G is the ﬁnite union of disjoint intervals, then
R
G f =
0. By dominated convergence and Proposition 1.5,
R
G f = 0 for any
open set G. Again by dominated convergence, if Gn are open sets
decreasing to H, then
R
H f = limn
R
Gn f = 0.
If E is any Borel measurable set, Proposition 4.14 tells us that
there exists a sequence Gn of open sets that decrease to a set H
where H diﬀers from E by a null set. Then
Z
E
f =
Z
fχE =
Z
fχH =
Z
H
f = 0.
This with Proposition 8.1 implies f is zero a.e.

8.2. AN APPROXIMATION RESULT
65
8.2
An approximation result
We give a result on approximating a function on R by continuous
functions.
Theorem 8.4 Suppose f is a Borel measurable real-valued inte-
grable function on R. Let ε > 0. Then there exists a continuous
function g with compact support such that
Z
|f −g| < ε.
Proof. If we write f = f + −f −, it is enough to ﬁnd continuous
functions g1 and g2 with compact support such that
R
|f + −g1| <
ε/2 and
R
|f −−g2| < ε/2 and to let g = g1 −g2. Hence we may
assume f ≥0.
By monotone convergence
R
f · χ[−n,n] increases to
R
f, so by
taking n large enough, the diﬀerence of the integrals will be less
than ε/2. If we ﬁnd g continuous with compact support such that
R
|f · χ[−n,n] −g| < ε/2, then
R
|f −g| < ε. Therefore we may in
addition assume that f is 0 outside some bounded interval.
Suppose f = χA, where A is a bounded Borel measurable set.
We can choose G open and F closed such that F ⊂A ⊂G and
m(G −F) < ε by Proposition 4.14. Without loss of generality, we
may assume G is also a bounded set. Since F is compact, there is
a minimum distance between F and Gc, say, δ. Let
g(x) =

1 −dist (x, F)
δ
+
.
Then g is continuous, 0 ≤g ≤1, g is 1 on F, g is 0 on Gc, and g
has compact support. We have
|g −χA| ≤χG −χF ,
so
Z
|g −χA| ≤
Z
(χG −χF ) = m(G −F) < ε.
Thus our result holds for characteristic functions of bounded sets.
If f = Pp
i=1 aiχAi, where each Ai is contained in a bounded
interval and each ai > 0, and we ﬁnd gi continuous with compact

66 CHAPTER 8. PROPERTIES OF LEBESGUE INTEGRALS
support such that
R
|χAi −gi| < ε/aip, then g = Pp
i=1 aigi will
be the desired function. Thus our theorem holds for non-negative
simple functions with compact support.
If f is non-negative and has compact support, we can ﬁnd simple
functions sm supported in a bounded interval increasing to f whose
integrals increase to
R
f. Let sm be a simple function such that
sm ≤f and
R
sm ≥
R
f −ε/2.
We choose continuous g with
compact support such that
R
|sm −g| < ε/2 using the preceding
paragraphs, and then
R
|f −g| < ε.
The method of proof, where one proves a result for characteristic
functions, then simple functions, then non-negative functions, and
then ﬁnally integrable functions, is very common.
8.3
Exercises
Exercise 8.1 This exercise gives a change of variables formula in
two simple cases. Show that if f is an integrable function on the
reals and a is a nonzero real number, then
Z
R
f(x + a) dx =
Z
R
f(x) dx
and
Z
R
f(ax) dx = a−1
Z
R
f(x) dx.
Exercise 8.2 Let (X, A, µ) be a σ-ﬁnite measure space. Suppose
f is non-negative and integrable. Prove that if ε > 0, there exists
A ∈A such that µ(A) < ∞and
ε +
Z
A
f dµ >
Z
f dµ.
Exercise 8.3 Suppose A is a Borel measurable subset of [0, 1], m
is Lebesgue measure, and ε ∈(0, 1).
Prove that there exists a
continuous function f : [0, 1] →R such that 0 ≤f ≤1 and
m({x : f(x) ̸= χA(x)}) < ε.

8.3. EXERCISES
67
Exercise 8.4 Suppose f is a non-negative integrable function on
a measure space (X, A, µ). Prove that
lim
t→∞tµ({x : f(x) ≥t}) = 0.
Exercise 8.5 Find a non-negative function f on [0, 1] such that
lim
t→∞tm({x : f(x) ≥t}) = 0
but f is not integrable, where m is Lebesgue measure.
Exercise 8.6 Suppose µ is a ﬁnite measure. Prove that a measur-
able non-negative function f is integrable if and only if
∞
X
n=1
µ({x : f(x) ≥n}) < ∞.
Exercise 8.7 Let µ be a measure, not necessarily σ-ﬁnite, and
suppose f is real-valued and integrable with respect to µ. Prove
that A = {x : f(x) ̸= 0} has σ-ﬁnite measure, that is, there exists
Fn ↑A such that µ(Fn) < ∞for each n.
Exercise 8.8 Recall that a function f : R →R is convex if
f(λx + (1 −λ)y) ≤λf(x) + (1 −λ)f(y)
whenever x < y ∈R and λ ∈[0, 1].
(1) Prove that if f is convex and x ∈R, there exists a real number
c such that f(y) ≥f(x) + c(y −x) for all y ∈R. Graphically, this
says that the graph of f lies above the line with slope c that passes
through the point (x, f(x)).
(2) Let (X, A, µ) be a measure space, suppose µ(X) = 1, and let
f : R →R be convex. Let g : X →R be integrable. Prove Jensen’s
inequality:
f
 Z
g dµ

≤
Z
X
f ◦g dµ.
Exercise 8.9 Suppose f is a real-valued function on R such that
f
 Z 1
0
g(x) dx

≤
Z 1
0
f(g(x)) dx
whenever g is bounded and measurable. Prove that f is convex.

68 CHAPTER 8. PROPERTIES OF LEBESGUE INTEGRALS
Exercise 8.10 Suppose g : [0, 1] →R is bounded and measurable
and
Z 1
0
f(x)g(x) dx = 0
whenever f is continuous and
R 1
0 f(x) dx = 0. Prove that g is equal
to a constant a.e.

Chapter 9
Riemann integrals
We compare the Lebesgue integral and the Riemann integral. We
show that the Riemann integral of a function exists if and only if
the set of discontinuities of the function have Lebesgue measure
zero, and in that case the Riemann integral and Lebesgue integral
agree.
9.1
Comparison with the Lebesgue in-
tegral
We only consider bounded measurable functions from [a, b] into R.
If we are looking at the Lebesgue integral, we write
R
f, while, tem-
porarily, if we are looking at the Riemann integral, we write R(f).
Recall that the Riemann integral on [a, b] is deﬁned as follows: if
P = {x0, x1, . . . , xn} with x0 = a and xn = b is a partition of [a, b],
let
U(P, f) =
n
X
i=1
[
sup
xi−1≤x≤xi
f(x)] (xi −xi−1)
and
L(P, f) =
n
X
i=1
[
inf
xi−1≤x≤xi f(x)] (xi −xi−1).
Set
R(f) = inf{U(P, f) : P is a partition}
69

70
CHAPTER 9. RIEMANN INTEGRALS
and
R(f) = sup{L(P, f) : P is a partition}.
The Riemann integral exists if R(f) = R(f), and the common value
is the Riemann integral, which we denote R(f).
Theorem 9.1 A bounded Borel measurable real-valued function f
on [a, b] is Riemann integrable if and only if the set of points at
which f is discontinuous has Lebesgue measure 0, and in that case,
the Riemann integral is equal in value to the Lebesgue integral.
Proof. Step 1. First we show that if f is Riemann integrable, then
f is continuous a.e. and R(f) =
R
f. If P is a partition, deﬁne
TP (x) =
n
X
i=1
[
sup
xi−1≤y≤xi
f(y)]χ[xi−1,xi)(x),
and
SP (x) =
n
X
i=1
[
inf
xi−1≤y≤xi f(y)]χ[xi−1,xi)(x).
We observe that
R
TP = U(P, f) and
R
SP = L(P, f).
If f is Riemann integrable, there exists a sequence of parti-
tions Qi such that U(Qi, f) ↓R(f) and a sequence Q′
i such that
L(Q′
i, f) ↑R(f). It is not hard to check that adding points to a par-
tition increases L and decreases U, so if we let Pi = ∪j≤i(Qj ∪Q′
j),
then Pi is an increasing sequence of partitions, U(Pi, f) ↓R(f) and
L(Pi, f) ↑R(f). We see also that TPi(x) decreases at each point,
say, to T(x), and SPi(x) increases at each point, say, to S(x). Also
T(x) ≥f(x) ≥S(x). By dominated convergence (recall that f is
bounded)
Z
(T −S) = lim
i→∞
Z
(TPi −SPi) = lim
i→∞(U(Pi, f) −L(Pi, f)) = 0.
We conclude T = S = f a.e.
If x is not in the null set where
T(x) ̸= S(x) nor in ∪iPi, which is countable and hence of Lebesgue
measure 0, then TPi(x) ↓f(x) and SPi(x) ↑f(x). We claim that
f is continuous at such x. To prove the claim, given ε, choose i
large enough so that TPi(x) −SPi(x) < ε and then choose δ small
enough so that (x −δ, x + δ) is contained in the subinterval of Pi
that contains x. Finally, since
R(f) = lim
i→∞U(Pi, f) = lim
i→∞
Z
TPi =
Z
f

9.2. EXERCISES
71
by the dominated convergence theorem, we see that the Riemann
integral and Lebesgue integral agree.
Step 2. Now suppose that f is continuous a.e. Let ε > 0. Let Pi
be the partition where we divide [a, b] into 2i equal parts. If x is
not in the null set where f is discontinuous, nor in ∪∞
i=1Pi, then
TPi(x) ↓f(x) and SPi(x) ↑f(x). By dominated convergence,
U(Pi, f) =
Z
TPi →
Z
f
and
L(Pi, f) =
Z
SPi →
Z
f.
This does it.
Example 9.2 Let [a, b] = [0, 1] and f = χA, where A is the set of
irrational numbers in [0, 1]. If x ∈[0, 1], every neighborhood of x
contains both rational and irrational points, so f is continuous at
no point of [0, 1]. Therefore f is not Riemann integrable.
Example 9.3 Deﬁne f(x) on [0, 1] to be 0 if x is irrational and to
be 1/q if x is rational and equals p/q when in reduced form. f is
discontinuous at every rational. If x is irrational and ε > 0, there
are only ﬁnitely many rationals r for which f(r) ≥ε, so taking
δ less than the distance from x to any of this ﬁnite collection of
rationals shows that |f(y) −f(x)| < ε if |y −x| < δ. Hence f is
continuous at x. Therefore the set of discontinuities is a countable
set, hence of measure 0, hence f is Riemann integrable.
9.2
Exercises
Exercise 9.1 Find a measurable function f : [0, 1] →R such that
R(f) ̸=
R 1
0 f(x) dx and R(f) ̸=
R 1
0 f(x) dx.
Exercise 9.2 Find a function f : (0, 1] →R that is continuous,
is not Lebesgue integrable, but where the improper Riemann inte-
gral exists. Thus we want f such that
R 1
0 |f(x)| m(dx) = ∞but
lima→0+ R(fχ[a,1]) exists.

72
CHAPTER 9. RIEMANN INTEGRALS
Exercise 9.3 Suppose f : [0, 1] →R is integrable, f is bounded
on (a, 1] for each a > 0, and the improper Riemann integral
lim
a→0+ R(fχ(a,1])
exists. Show that the limit is equal to
R 1
0 f(x) dx.
Exercise 9.4 Divide [a, b] into 2n equal subintervals and pick a
point xi out of each subinterval. Let µn be the measure deﬁned by
µn(dx) = 2−n
2n
X
i=1
δxi(dx),
where δy is point mass at y. Note that if f is a bounded measurable
real-valued function on [a, b], then
Z b
a
f(x) µn(dx) =
2n
X
i=1
f(xi)2−n
(9.1)
is a Riemann sum approximation to R(f).
(1) Prove that µn([0, x]) →m([0, x]) for every x ∈[0, 1]. Conclude
by Exercise 7.24 that
R
f dµn →
R 1
0 f dx whenever f is continuous.
(2) Use Exercise 7.25 to see that if f is a bounded and measurable
function on [a, b] whose set of discontinuities has measure 0, then
the Riemann sum approximation of f given in (9.1) converges to
the Lebesgue integral of f. This provides an alternative proof of
Step 2 of Theorem 9.1.
Exercise 9.5 Let f be a bounded, real-valued, and measurable
function. Prove that if
f = lim
δ→0
sup
|y−x|<δ,a≤y≤b
f(y),
then f = T a.e., where we use the notation of Theorem 9.1. Con-
clude f is Lebesgue measurable.
Exercise 9.6 Deﬁne f = limδ→0 inf|y−x|<δ,a≤y≤b f(y) and let f
be deﬁned as in Exercise 9.5.
(1) Suppose that the set of discontinuities of a bounded real-valued

9.2. EXERCISES
73
measurable function f has positive Lebesgue measure. Prove that
there exists ε > 0 such that if
Aε = {x ∈[a, b] : f(x) −f(x) > ε},
then m(Aε) > 0.
(2) Prove that U(P, f) −L(P, f) > εm(Aε) for every partition P
on [a, b], using the notation of Theorem 9.1. Conclude that f is
not Riemann integrable. This provides another proof of Step 1 of
Theorem 9.1.
Exercise 9.7 A real-valued function on a metric space is lower
semicontinuous if {x : f(x) > a} is open whenever a ∈R and
upper semicontinuous if {x : f(x) < a} is open whenever a ∈R.
(1) Prove that if fn is a sequence of real-valued continuous functions
increasing to f, then f is lower semicontinuous.
(2) Find a bounded lower semicontinuous function f : [0, 1] →R
such that f is continuous everywhere except at x = 1/2.
(3) Find a bounded lower semicontinuous real-valued function f
deﬁned on [0, 1] such that the set of discontinuities of f is equal to
the set of rationals in [0, 1].
(4) Find a bounded lower semicontinuous function f : [0, 1] →R
such that the set of discontinuities of f has positive measure.
(5) Does there exist a bounded lower semicontinuous function f :
[0, 1] →R such that f is discontinuous a.e.?
Exercise 9.8 Find a sequence fn of continuous functions mapping
[0, 1] into [0, 1] such that the fn increase to a bounded function f
which is not Riemann integrable. Such an example shows there
is no monotone convergence theorem or dominated convergence
theorem for Riemann integrals.
Exercise 9.9 Let M > 0 and let B be the σ-algebra on [−M, M]2
generated by the collection of sets of the form [a, b] × [c, d] with
−M ≤a ≤b ≤M and −M ≤c ≤d ≤M. Suppose µ is a measure
on ([−M, M]2, B) such that
µ([a, b] × [c, d]) = (b −a)(d −c).
(We will construct such a measure µ in Chapter 11.) Prove that
if f is continuous with support in [−M, M]2, then the Lebesgue
integral of f with respect to µ is equal to the double (Riemann)
integral of f and the two multiple (Riemann) integrals of f.

74
CHAPTER 9. RIEMANN INTEGRALS

Chapter 10
Types of convergence
There are various ways in which a sequence of functions fn can
converge, and we compare some of them.
10.1
Deﬁnitions and examples
Deﬁnition 10.1 If µ is a measure, we say a sequence of mea-
surable functions fn converges almost everywhere to f and write
fn →f a.e. if there is a set of measure 0 such that for x not in
this set we have fn(x) →f(x).
We say fn converges in measure to f if for each ε > 0
µ({x : |fn(x) −f(x)| > ε}) →0
as n →∞.
Let 1 ≤p < ∞. We say fn converges in Lp to f if
Z
|fn −f|p dµ →0
as n →∞.
Proposition 10.2 Suppose µ is a ﬁnite measure.
(1) If fn →f, a.e., then fn converges to f in measure.
(2) If fn →f in measure, there is a subsequence nj such that
fnj →f, a.e.
75

76
CHAPTER 10. TYPES OF CONVERGENCE
Proof. Let ε > 0 and suppose fn →f a.e. If
An = {x : |fn(x) −f(x)| > ε},
then χAn →0 a.e., and by dominated convergence,
µ(An) =
Z
χAn(x) µ(dx) →0.
This proves (1).
To prove (2), suppose fn →f in measure, let n1 = 1, and
choose nj > nj−1 by induction so that
µ({x : |fnj(x) −f(x)| > 1/j}) ≤2−j.
Let Aj = {x : |fnj(x) −f(x)| > 1/j}. Then µ(Aj) ≤2−j, and if
we set
A = ∩∞
k=1 ∪∞
j=k Aj,
then by Proposition 3.5
µ(A) = lim
k→∞µ(∪∞
j=kAj) ≤lim
k→∞
∞
X
j=k
µ(Aj) ≤lim
k→∞2−k+1 = 0.
Therefore A has measure 0. If x /∈A, then x /∈∪∞
j=kAj for some
k, and so |fnj(x) −f(x)| ≤1/j for j ≥k. This implies fnj →f on
Ac.
Example 10.3 Part (1) of the above proposition is not true if
µ(X) = ∞. To see this, let X = R and let fn = χ(n,n+1). We have
fn →0 a.e., but fn does not converge in measure.
The next proposition compares convergence in Lp to conver-
gence in measure. Before we prove this, we prove an easy prelimi-
nary result known as Chebyshev’s inequality.
Lemma 10.4 If 1 ≤p < ∞, then
µ({x : |f(x)| ≥a}) ≤
R
|f|p
ap
.

10.1. DEFINITIONS AND EXAMPLES
77
Proof. Let A = {x : |f(x)| ≥a}. Since χA ≤|f|pχA/ap, we have
µ(A) ≤
Z
A
|f|p
ap dµ ≤1
ap
Z
|f|p dµ.
This is what we wanted.
Proposition 10.5 If fn converges to f in Lp, then it converges in
measure.
Proof. If ε > 0, by Chebyshev’s inequality
µ({x : |fn(x) −f(x)| > ε}) = µ({x : |fn(x) −f(x)|p > εp})
≤
R
|fn −f|p
εp
→0
as required.
Example 10.6 Let fn = n2χ(0,1/n) on [0, 1] with Lebesgue mea-
sure. This gives an example where fn converges to 0 a.e. and in
measure, but does not converge in Lp for any p ≥1.
Example 10.7 We give an example where fn →f in measure and
in Lp, but not almost everywhere. Let S = {eiθ : 0 ≤θ < 2π} be
the unit circle in the complex plane and deﬁne
µ(A) = m({θ ∈[0, 2π) : eiθ ∈A})
to be arc length measure on S, where m is Lebesgue measure on
[0, 2π).
Let X = S and let fn(x) = χFn(x), where
Fn =
n
eiθ :
n
X
j=1
1
j ≤θ ≤
n+1
X
j=1
1
j
o
.
Let f(eiθ) = 0 for all θ.
Then µ(Fn) ≤1/(n + 1) →0, so fn →f in measure. Also,
since fn is either 1 or 0,
Z
|fn −f|p dµ =
Z
χFn dµ = µ(Fn) →0.

78
CHAPTER 10. TYPES OF CONVERGENCE
But because P∞
j=1 1/j = ∞, each point of S is in inﬁnitely many
Fn, and each point of S is in S −Fn for inﬁnitely many n, so fn
does not converge to f at any point.
The Fn are arcs whose length tends to 0, but such that ∪n≥mFn
contains S for each m.
The following is known as Egorov’s theorem.
Theorem 10.8 Suppose µ is a ﬁnite measure, ε > 0, and fn →f
a.e. Then there exists a measurable set A such that µ(A) < ε and
fn →f uniformly on Ac.
This type of convergence is sometimes known as almost uniform
convergence. Egorov’s theorem is not as useful for solving problems
as one might expect, and students have a tendency to try to use it
when other methods work much better.
Proof. Let
Ank = ∪∞
m=n{x : |fm(x) −f(x)| > 1/k}.
For ﬁxed k, Ank decreases as n increases. The intersection ∩nAnk
has measure 0 because for almost every x, |fm(x) −f(x)| ≤1/k if
m is suﬃciently large. Therefore µ(Ank) →0 as n →∞. We can
thus ﬁnd an integer nk such that µ(Ankk) < ε2−k. Let
A = ∪∞
k=1Ankk.
Hence µ(A) < ε. If x /∈A, then x /∈Ankk, and so |fn(x) −f(x)| ≤
1/k if n ≥nk. Thus fn →f uniformly on Ac.
10.2
Exercises
Exercise 10.1 Suppose that fn is a sequence that is Cauchy in
measure. This means that given ε and a > 0, there exists N such
that if m, n ≥N, then
µ({x : |fn(x) −fm(x)| > a}) < ε.
Prove that fn converges in measure.

10.2. EXERCISES
79
Exercise 10.2 Suppose µ(X) < ∞. Deﬁne
d(f, g) =
Z
|f −g|
1 + |f −g| dµ.
Prove that d is a metric on the space of measurable functions,
except for the fact that d(f, g) = 0 only implies that f = g a.e.,
not necessarily everywhere. Prove that fn →f in measure if and
only if d(fn, f) →0.
Exercise 10.3 Prove that if fn →f in measure and each fn is
non-negative, then
Z
f ≤lim inf
n→∞
Z
fn.
Exercise 10.4 Prove that if An is measurable and µ(An) < ∞
for each n and χAn converges to f in measure, then there exists a
measurable set A such that f = χA a.e.
Exercise 10.5 Suppose for each ε there exists a measurable set F
such that µ(F c) < ε and fn converges to f uniformly on F. Prove
that fn converges to f a.e.
Exercise 10.6 Suppose that fn and f are measurable functions
such that for each ε > 0 we have
∞
X
n=1
µ({x : |fn(x) −f(x)| > ε}) < ∞.
Prove that fn →f a.e.
Exercise 10.7 Let fn be a sequence of measurable functions and
deﬁne
gn(x) = sup
m≥n
|fm(x) −fn(x)|.
Prove that if gn converges in measure to 0, then fn converges a.e.
Exercise 10.8 If (X, A, µ) is a measure space and fn is a sequence
of real-valued measurable functions such that
R
fng dµ converges
to 0 for every integrable g, is it necessarily true that fn converges
to 0 in measure? If not, give a counterexample.

80
CHAPTER 10. TYPES OF CONVERGENCE

Chapter 11
Product measures
We have deﬁned Lebesgue measure on the line. Now we give a
method for constructing measures on the plane, in n-dimensional
Euclidean spaces, and many other product spaces. The main theo-
rem, the Fubini theorem, which allows one to interchange the order
of integration, is one of the most important theorems in real anal-
ysis.
11.1
Product σ-algebras
Suppose (X, A, µ) and (Y, B, ν) are two measure spaces and suppose
also that µ and ν are σ-ﬁnite measures. A measurable rectangle is
a set of the form A × B, where A ∈A and B ∈B.
Let C0 be the collection of ﬁnite unions of disjoint measurable
rectangles. Thus every element of C0 is of the form ∪n
i=1(Ai × Bi),
where Ai ∈A, Bi ∈B, and if i ̸= j, then (Ai ×Bi)∩(Aj ×Bj) = ∅.
Since (A × B)c = (A × Bc) ∪(Ac × Y ) and the intersection of two
measurable rectangles is a measurable rectangle, it is easy to check
that C0 is an algebra of sets. We deﬁne the product σ-algebra
A × B = σ(C0).
If E ∈A × B, we deﬁne the x-section of E by
sx(E) = {y ∈Y : (x, y) ∈E}
81

82
CHAPTER 11. PRODUCT MEASURES
and similarly deﬁne the y-section:
ty(E) = {x : (x, y) ∈E}.
Given a function f : X ×Y →R that is A×B measurable, for each
x and y we deﬁne Sxf : Y →R and Tyf : X →R by
Sxf(y) = f(x, y),
Tyf(x) = f(x, y).
Lemma 11.1 (1) If E ∈A × B, then sx(E) ∈B for each x and
ty(E) ∈A for each y.
(2) If f is A × B measurable, then Sxf is B measurable for each x
and Tyf is A measurable for each y.
Proof.
(1) Let C be the collection of sets in A × B for which
sx(E) ∈B for each x. We will show that C is a σ-algebra containing
the measurable rectangles, and hence is all of A × B.
If E = A × B, then sx(E) is equal to B if x ∈A and equal to
∅if x /∈A. Hence sx(E) ∈B for each x when E is a measurable
rectangle.
If E ∈C, then y ∈sx(Ec) if and only if (x, y) ∈Ec, which
happens if and only if y /∈sx(E). Therefore sx(Ec) = (sx(E))c, and
C is closed under the operation of taking complements. Similarly,
it is easy to see that sx(∪∞
i=1Ei) = ∪∞
i=1sx(Ei), and so C is closed
under the operation of countable unions.
Therefore C is a σ-algebra containing the measurable rectangles,
and hence is equal to A × B. The argument for ty(E) is the same.
(2) Fix x.
If f = χE for E ∈A × B, note that Sxf(y) =
χsx(E)(y), which is B measurable. By linearity, Sxf is B measurable
when f is a simple function.
If f is non-negative, take A × B
measurable simple functions rn increasing to f, and since Sxrn ↑
Sxf, then Sxf is B measurable. Writing f = f + −f −and using
linearity again shows that Sxf is B measurable. The argument for
Tyf is the same.
Let E ∈A × B and let
h(x) = ν(sx(E)),
k(y) = µ(ty(E)).

11.1. PRODUCT σ-ALGEBRAS
83
Proposition 11.2 (1) h is A measurable and k is B measurable.
(2) We have
Z
h(x) µ(dx) =
Z
k(y) ν(dy).
(11.1)
Since χsx(E)(y) = SxχE(y) for all x and y, (11.1) could be
written as
Z h Z
SxχE(y) ν(dy)
i
µ(dx) =
Z h Z
TyχE(x) µ(dx)
i
ν(dy).
We will usually write this as
Z Z
χE(x, y) ν(dy) µ(dx) =
Z Z
χE(x, y) µ(dx) ν(dy).
Proof. First suppose µ and ν are ﬁnite measures. Let C be the
collection of sets in A×B for which (1) and (2) hold. We will prove
that C contains C0 and is a monotone class. This will prove that C
is the smallest σ-algebra containing C0 and hence is equal to A×B.
If E = A × B, with A ∈A and B ∈B, then h(x) = χA(x)ν(B),
which is A measurable, and
R
h(x) µ(dx) = µ(A)ν(B). Similarly,
k(y) = µ(A)χB(y) is B measurable and
R
k(y) ν(dy) = µ(A)ν(B).
Therefore (1) and (2) hold for measurable rectangles.
If E = ∪n
i=1Ei, where each Ei is a measurable rectangle and the
Ei are disjoint, then sx(E) = ∪n
i=1sx(Ei), and since the sx(Ei) are
disjoint, then
h(x) = ν(sx(E)) = ν(∪n
i=1sx(Ei)) =
n
X
i=1
ν(sx(Ei)).
This shows that h is A measurable, since it is the sum of A mea-
surable functions. Similarly k(y) is B measurable. If we let hi(x) =
ν(sx(Ei)) and deﬁne ki(y) similarly, then
Z
hi(x) µ(dx) =
Z
ki(y) ν(dy)
by the preceding paragraph, and then (2) holds for E by linearity.
Therefore C contains C0.
Suppose En ↑E and each En ∈C. If we let hn(x) = ν(sx(En))
and let kn(y) = µ(tn(En)), then hn ↑h and kn ↑k. Therefore h is

84
CHAPTER 11. PRODUCT MEASURES
A measurable and k is B measurable. We have (11.1) holding when
h and k are replaced by hn and kn, resp. We let n →∞and use
the monotone convergence theorem to see that (11.1) holds with h
and k.
If En ↓E with each En ∈C, almost the same argument shows
that h and k are measurable with respect to A and B, and that
(11.1) holds. The only diﬀerence is that we use the dominated con-
vergence theorem in place of the monotone convergence theorem.
This is where we need µ and ν to be ﬁnite measures.
We have shown C is a monotone class containing C0. By the
monotone class theorem (Theorem 2.10), C is equal to σ(C0), which
is A × B.
Finally suppose µ and ν are σ-ﬁnite. Then there exist Fi ↑X
and Gi ↑Y such that each Fi is A measurable and has ﬁnite µ
measure and each Gi is B measurable and has ﬁnite ν measure.
Let µi(A) = µ(A ∩Fi) for each A ∈A and νi(A) = ν(A ∩Gi) for
each B ∈B. Let hi(x) = νi(sx(E)) = ν(sx(E) ∩Gi) and similarly
deﬁne ki(y). By what we have proved above, hi is A measurable,
ki is B measurable, and (11.1) holds if we replace h and k by hi and
ki, resp. Now hi ↑h and ki ↑k, which proves the measurability of
h and k. Applying the monotone convergence theorem proves that
(11.1) holds with h and k.
We now deﬁne µ × ν by
µ × ν(E) =
Z
h(x) µ(dx) =
Z
k(y) ν(dy).
(11.2)
Clearly µ × ν(∅) = 0. If E1, . . . , En are disjoint and in A × B and
E = ∪n
i=1Ei, then we saw in the proof of Proposition 11.2 that
ν(sx(E)) = Pn
i=1 ν(sx(Ei)). We conclude that
µ × ν(E) =
Z
ν(sx(E)) µ(dx) =
n
X
i=1
Z
ν(sx(Ei)) µ(dx)
=
n
X
i=1
µ × ν(Ei),
or µ×ν is ﬁnitely additive. If En ↑E with each En ∈A×B and we
let hn(x) = ν(sx(En)), then hn ↑h, and by monotone convergence,
µ × ν(En) ↑µ × ν(E). Therefore µ × ν is a measure.

11.2. THE FUBINI THEOREM
85
Note that if E = A × B is a measurable rectangle, then h(x) =
χA(x)ν(B) and so
µ × ν(A × B) = µ(A)ν(B),
which is what it should be.
11.2
The Fubini theorem
The main result of this chapter is the Fubini theorem, which allows
one to interchange the order of integration.
This is sometimes
called the Fubini-Tonelli theorem.
Theorem 11.3 Suppose f : X ×Y →R is measurable with respect
to A × B. If either
(a) f is non-negative, or
(b)
R
|f(x, y)| d(µ × ν)(x, y) < ∞,
then
(1) for each x, the function y 7→f(x, y) is measurable with respect
to B;
(2) for each y, the function x 7→f(x, y) is measurable with respect
to A;
(3) the function g(x) =
R
f(x, y) ν(dy) is measurable with respect
to A;
(4) the function h(y) =
R
f(x, y) µ(dx) is measurable with respect
to B;
(5) we have
Z
f(x, y) d(µ × ν)(x, y) =
Z h Z
f(x, y) dµ(x)
i
dν(y)
(11.3)
=
Z h Z
f(x, y) dν(y)
i
µ(dx).
The last integral in (11.3) should be interpreted as
Z h Z
Sxf(y) ν(dy)
i
µ(dx)
and similarly for the second integral in (11.3). Since no confusion
results, most often the brackets are omitted in (11.3).
Proof. If f is the characteristic function of a set in A × B, then
(1)–(5) are merely a restatement of Lemma 11.1 and Proposition

86
CHAPTER 11. PRODUCT MEASURES
11.2. By linearity, (1)–(5) hold if f is a simple function. Since the
increasing limit of measurable functions is measurable, then writing
a non-negative function as the increasing limit of simple functions
and using the monotone convergence theorem, we see that (1)–(5)
hold when f is non-negative. In the case where
R
|f| d(µ×ν) < ∞,
writing f = f + −f −and using linearity proves (1)–(5) for this
case, too.
Observe that if we know
Z Z
|f(x, y)| µ(dx) ν(dy) < ∞,
then since |f(x, y)| is non-negative the Fubini theorem tells us that
Z
|f(x, y)| d(µ × ν) =
Z Z
|f(x, y)| µ(dx) ν(dy) < ∞
We can then apply the Fubini theorem again to conclude
Z
f(x, y) d(µ × ν) =
Z Z
f(x, y) dµ dν =
Z Z
f(x, y) dν dµ.
Thus in the hypotheses of the Fubini theorem, we could as well
assume
R R
|f(x, y)| dµ dν < ∞or
R R
|f(x, y)| dν dµ < ∞.
When f is measurable with respect to A×B, we sometimes say
that f is jointly measurable.
Even when (X, A, µ) and (Y, B, ν) are complete, it will not be
the case in general that (X × Y, A × B, µ × ν) is complete. For
example, let (X, A, µ) = (Y, B, ν) be Lebesgue measure on [0, 1]
with the Lebesgue σ-algebra. Let A be a non-measurable set in
[0, 1] and let E = A × {1/2}. Then E is not a measurable set with
respect to A×B, or else A = t1/2(E) would be in A by Lemma 11.1.
On the other hand, E ⊂[0, 1]×{1/2}, which has zero measure with
respect to µ × ν, so E is a null set.
One can take the completion of (X × Y, A × B, µ × ν) without
great diﬃculty. See [4] for details.
There is no diﬃculty extending the Fubini theorem to the prod-
uct of n measures. If we have µ1, . . . , µn all equal to m, Lebesgue
measure on R with the Lebesgue σ-algebra L, then the completion
of (Rn, L × · · · × L, m × · · · × m) is called n-dimensional Lebesgue
measure.
For a general change of variables theorem, see [1].

11.3. EXAMPLES
87
11.3
Examples
We give two examples to show that the hypotheses of the Fubini
theorem are necessary.
Example 11.4 Let X = Y
= [0, 1] and µ and ν both being
Lebesgue measure. Let gi be continuous functions with support
in (1/(i + 1), 1/i) such that
R 1
0 gi(x) dx = 1, i = 1, 2, . . .. Let
f(x, y) =
∞
X
i=1
[gi(x) −gi+1(x)]gi(y).
For each point (x, y) at most two terms in the sum are nonzero, so
the sum is actually a ﬁnite one. If we ﬁrst integrate with respect
to y, we get
Z 1
0
f(x, y) dy =
∞
X
i=1
[gi(x) −gi+1(x)].
This is a telescoping series, and sums to g1(x). Therefore
Z 1
0
Z 1
0
f(x, y) dy dx =
Z 1
0
g1(x) dx = 1.
On the other hand, integrating ﬁrst with respect to x gives 0, so
Z 1
0
Z 1
0
f(x, y) dx dy = 0.
This doesn’t contradict the Fubini theorem because
Z 1
0
Z 1
0
|f(x, y)| dx dy = ∞.
Example 11.5 For this example, you have to take on faith a bit of
set theory. There exists a set X together with a partial order “≤”
such that X is uncountable but for any y ∈X, the set {x ∈X :
x ≤y} is countable. An example is to let X be the set of countable
ordinals. Deﬁne µ on X by µ(A) = 0 if A is countable and 1 if
A is uncountable. The σ-algebra is the collection of subsets A of
X such that either A or Ac is countable. Deﬁne f on X × X by
f(x, y) = 1 if x ≤y and zero otherwise. Then
R R
f(x, y) dy dx = 1
but
R R
f(x, y) dx dy = 0. The reason there is no contradiction is
that f is not measurable with respect to the product σ-algebra.

88
CHAPTER 11. PRODUCT MEASURES
11.4
Exercises
Exercise 11.1 State and prove a version of the Fubini theorem
for complex-valued functions.
Exercise 11.2 Let (X, A) and (Y, B) be two measurable spaces
and let f ≥0 be measurable with respect to A × B. Let g(x) =
supy∈Y f(x, y) and suppose g(x) < ∞for each x. Is g necessarily
measurable with respect to A? If not, ﬁnd a counterexample.
Exercise 11.3 Prove the equality
Z ∞
−∞
|f(x)| dx =
Z ∞
0
m({x : |f(x)| ≥t}) dt,
where m is Lebesgue measure.
Exercise 11.4 Let A be a Lebesgue measurable subset of [0, 1]2
with m2(A) = 1, where m2 is two-dimensional Lebesgue measure.
Show that for almost every x ∈[0, 1] (with respect to one di-
mensional Lebesgue measure) the set sx(A) has one-dimensional
Lebesgue measure one.
Exercise 11.5 Let f : [0, 1]2 →R be such that for every x ∈[0, 1]
the function y →f(x, y) is Lebesgue measurable on [0, 1] and for
every y ∈[0, 1] the function x →f(x, y) is continuous on [0, 1].
Prove that f is measurable with respect to the the completion of
the product σ-algebra L × L on [0, 1]2. Here L is the Lebesgue
σ-algebra on [0, 1].
Exercise 11.6 Suppose f is real-valued and integrable with re-
spect to two-dimensional Lebesgue measure on [0, 1]2 and
Z a
0
Z b
0
f(x, y) dy dx = 0
for all a ∈[0, 1] and b ∈[0, 1]. Prove that f = 0 a.e.
Exercise 11.7 Prove that
Z 1
0
Z 1
0
x2 −y2
(x2 + y2)2 log(4 + sin x) dy dx
=
Z 1
0
Z 1
0
x2 −y2
(x2 + y2)2 log(4 + sin x) dx dy.

11.4. EXERCISES
89
Exercise 11.8 Let X = Y = [0, 1] and let B be the Borel σ-
algebra. Let m be Lebesgue measure and µ counting measure on
[0, 1].
(1) If D = {(x, y) : x = y}, show that D is measurable with respect
to B × B.
(2) Show that
Z
X
Z
Y
χD(x, y) µ(dy) m(dx) ̸=
Z
Y
Z
X
χD(x, y) m(dx) µ(dy).
Why does this not contradict the Fubini theorem?
Exercise 11.9 Let X = Y = R and let B be the Borel σ-algebra.
Deﬁne
f(x, y) =





1,
x ≥0 and x ≤y < x + 1;
−1,
x ≥0 and x + 1 ≤y < x + 2;
0,
otherwise.
Show that
Z Z
f(x, y) dy dx ̸=
Z Z
f(x, y) dx dy.
Why does this not contradict the Fubini theorem?
Exercise 11.10 Find a real-valued function f that is integrable
on [0, 1]2 such that
Z a
0
Z 1
0
f(x, y) dy dx = 0,
Z 1
0
Z b
0
f(x, y) dy dx = 0
for every a, b ∈[0, 1], but f is not zero almost everywhere with
respect to 2-dimensional Lebesgue measure.
Exercise 11.11 Let µ be a ﬁnite measure on R and let α(x) =
µ((−∞, x]). Show
Z
[α(x + c) −α(x)] dx = cµ(R).
Exercise 11.12 Use
1
x =
Z ∞
0
e−xy dy

90
CHAPTER 11. PRODUCT MEASURES
and the Fubini theorem to calculate
Z b
0
Z ∞
0
e−xy sin x dy dx
two diﬀerent ways. Then prove that
lim
b→∞
Z b
0
sin x
x
dx = π
2 .
Recall that
Z
eau sin u du = eau(a sin u −cos u)
1 + a2
+ C.
Exercise 11.13 Let X = {1, 2, . . .} and let µ be counting measure
on X. Deﬁne f : X × X →R by
f(x, y) =





1,
x = y;
−1,
x = y + 1;
0,
otherwise.
Show that
Z
X
Z
X
f(x, y) µ(dx) µ(dy) ̸=
Z
X
Z
X
f(x, y) µ(dy) µ(dx).
Why is this not a contradiction to the Fubini theorem?
Exercise 11.14 Let {an} and {rn} be two sequences of real num-
bers such that P∞
n=1 |an| < ∞. Prove that
∞
X
n=1
an
p
|x −rn|
converges absolutely for almost every x ∈R.
Exercise 11.15 Let (X, A, µ) and (Y, B, ν) be measure spaces.
Prove that if λ is a measure on A × B such that
λ(A × B) = µ(A)ν(B)
whenever A ∈A and B ∈B, then λ = µ × ν on A × B.

11.4. EXERCISES
91
Exercise 11.16 Let S be the unit circle {eiθ : 0 ≤θ < 2π} and
deﬁne a measure µ on S by µ(A) = m({θ : eiθ ∈A}), where m is
Lebesgue measure on [0, 2π). Let m2 be two-dimensional Brownian
motion. Show that if A is a Borel subset of S and R > 0, then
m2({reiθ : 0 < r < R, eiθ ∈A}) = µ(A)R2/2.
Exercise 11.17 Use Exercise 11.16 to prove that if f is a continu-
ous real-valued function with support in the ball B(0, R) = {(x, y) :
x2 + y2 < R2}, then
Z Z
B(0,R)
f(x, y) dy dx =
Z 2π
0
Z R
0
f(r cos θ, r sin θ) r dr dθ.
Exercise 11.18 Prove that
Z ∞
0
e−x2/2 dx =
p
π/2
by ﬁlling in the missing steps and making rigorous the following.
If I =
R ∞
0
e−x2/2 dx, then
I2 =
Z ∞
0
Z ∞
0
e−(x2+y2)/2 dy dx =
Z π/2
0
Z ∞
0
e−r2/2r dr dθ = π/2.
Exercise 11.19 If M = (Mij)n
i,j=1 is a n × n matrix and x =
(x1, . . . , xn) ∈Rn, deﬁne Mx to be the element of Rn whose ith
coordinate is Pn
j=1 Mijxj. (This is just the usual matrix multipli-
cation of a n×n matrix and a n×1 matrix.) If A is a Borel subset
of Rn, let M(A) = {Mx : x ∈A}.
(1) If c ∈R and
Mij =





c,
i = j = 1;
1,
i = j ̸= 1;
0,
i ̸= j;
show
mn(M(A)) = |c|mn(A) = | det M|mn(A),
where we use mn for n-dimensional Lebesgue measure. (Multipli-
cation by M multiplies the ﬁrst coordinate by c.)
(2) If 1 ≤k ≤n and
Mij =









1,
i = 1 and j = k;
1,
j = 1 and i = k;
1,
i = j and neither equals k;
0,
otherwise;

92
CHAPTER 11. PRODUCT MEASURES
show
mn(M(A)) = mn(A) = | det M|mn(A).
(Multiplication by M interchanges the ith and kth coordinates.)
(3) If c ∈R and
Mij =





1,
i = j;
c,
i = 1, j = 2;
0,
otherwise,
show
mn(M(A)) = mn(A) = | det M|mn(A).
(Multiplication by M replaces x1 by x1 + cx2.)
(4) Since every n × n matrix can be written as the product of ma-
trices each of which has the form given in (1), (2), or (3), conclude
that if M is any n × n matrix, then
mn(M(A)) = | det M|mn(A).
(5) If M is an orthogonal matrix, so that M times its transpose
is the identity, show mn(M(A)) = mn(A). (Multiplication by an
orthogonal matrix is a rotation of Rn.)

Chapter 12
Signed measures
Signed measures have the countable additivity property of mea-
sures, but are allowed to take negative as well as positive val-
ues. We will see shortly that an example of a signed measure is
ν(A) =
R
A f dµ, where f is integrable and takes both positive and
negative values.
12.1
Positive and negative sets
Deﬁnition 12.1 Let A be a σ-algebra.
A signed measure is a
function µ : A →(−∞, ∞] such that µ(∅) = 0 and µ(∪∞
i=1Ai) =
P∞
i=1 µ(Ai) whenever the Ai are pairwise disjoint and all the Ai
are in A.
When we want to emphasize that a measure is deﬁned as in
Deﬁnition 3.1 and only takes non-negative values, we refer to it as
a positive measure.
Deﬁnition 12.2 Let µ be a signed measure. A set A ∈A is called
a positive set for µ if µ(B) ≥0 whenever B ⊂A and B ∈A. We
say A ∈A is a negative set if µ(B) ≤0 whenever B ⊂A and
B ∈A. A null set A is one where µ(B) = 0 whenever B ⊂A and
B ∈A.
93

94
CHAPTER 12. SIGNED MEASURES
Note that if µ is a signed measure, then
µ(∪∞
i=1Ai) = lim
n→∞µ(∪n
i=1Ai).
The proof is the same as in the case of positive measures.
Example 12.3 Suppose m is Lebesgue measure and
µ(A) =
Z
A
f dm
for some integrable f.
If we let P = {x : f(x) ≥0}, then P
is easily seen to be a positive set, and if N = {x : f(x) < 0},
then N is a negative set. The Hahn decomposition which we give
below is a decomposition of our space (in this case R) into the
positive and negative sets P and N. This decomposition is unique,
except that C = {x : f(x) = 0} could be included in N instead
of P, or apportioned partially to P and partially to N.
Note,
however, that C is a null set. The Jordan decomposition below is
a decomposition of µ into µ+ and µ−, where µ+(A) =
R
A f + dm
and µ−(A) =
R
A f −dm.
Proposition 12.4 Let µ be a signed measure which takes values
in (−∞, ∞]. Let E be measurable with µ(E) < 0. Then there exists
a measurable subset F of E that is a negative set with µ(F) < 0.
Proof. If E is a negative set, we are done. If not, there exists a
measurable subset with positive measure. Let n1 be the smallest
positive integer such that there exists E1 ⊂E with µ(E1) ≥1/n1.
We then deﬁne pairwise disjoint measurable sets E2, E3, . . . by in-
duction as follows. Let k ≥2 and suppose E1, . . . , Ek−1 are pair-
wise disjoint measurable sets with µ(Ei) > 0 for i = 1, . . . , k −1.
If Fk = E −(E1 ∪· · · ∪Ek−1) is a negative set, then
µ(Fk) = µ(E) −
k−1
X
i=1
µ(Ei) ≤µ(E) < 0
and Fk is the desired set F. If Fk is not a negative set, let nk be
the smallest positive integer such that there exists Ek ⊂Fk with
Ek measurable and µ(Ek) ≥1/nk.

12.2. HAHN DECOMPOSITION THEOREM
95
We stop the construction if there exists k such that Fk is a
negative set with µ(Fk) < 0.
If not, we continue and let F =
∩kFk = E −(∪kEk). Since 0 > µ(E) > −∞and µ(Ek) ≥0, then
µ(E) = µ(F) +
∞
X
k=1
µ(Ek).
Then µ(F) ≤µ(E) < 0, so the sum converges.
It remains to show that F is a negative set. Suppose G ⊂F is
measurable with µ(G) > 0. Then µ(G) ≥1/N for some N. But
this contradicts the construction, since for some k, nk > N, and
we would have chosen the set G instead of the set Ek at stage k.
Therefore F must be a negative set.
12.2
Hahn decomposition theorem
Recall that we write A∆B for (A −B) ∪(B −A). The following is
known as the Hahn decomposition.
Theorem 12.5 (1) Let µ be a signed measure taking values in
(−∞, ∞]. There exist disjoint measurable sets E and F in A whose
union is X and such that E is a negative set and F is a positive
set.
(2) If E′ and F ′ are another such pair, then E∆E′ = F∆F ′ is
a null set with respect to µ.
(3) If µ is not a positive measure, then µ(E) < 0. If −µ is not
a positive measure, then µ(F) > 0.
Proof.
(1) Let L = inf{µ(A) : A is a negative set}.
Choose
negative sets An such that µ(An) →L. Let E = ∪∞
n=1An. Let
Bn = An −(B1 ∪· · ·∪Bn−1) for each n. Since An is a negative set,
so is each Bn. Also, the Bn are disjoint and ∪nBn = ∪nAn = E.
If C ⊂E, then
µ(C) = lim
n→∞µ(C ∩(∪n
i=1Bi)) = lim
n→∞
n
X
i=1
µ(C ∩Bi) ≤0.
Thus E is a negative set.

96
CHAPTER 12. SIGNED MEASURES
Since E is a negative set,
µ(E) = µ(An) + µ(E −An) ≤µ(An).
Letting n →∞, we obtain µ(E) = L.
Let F = Ec. If F were not a positive set, there would exist
B ⊂F with µ(B) < 0. By Proposition 12.4 there exists a negative
set C contained in B with µ(C) < 0. But then E ∪C would be a
negative set with µ(E ∪C) < µ(E) = L, a contradiction.
(2) To prove uniqueness, if E′, F ′ are another such pair of sets
and A ⊂E −E′ ⊂E, then µ(A) ≤0. But A ⊂E −E′ = F ′ −F ⊂
F ′, so µ(A) ≥0. Therefore µ(A) = 0. The same argument works if
A ⊂E′ −E, and any subset of E∆E′ can be written as the union
of A1 and A2, where A1 ⊂E −E′ and A2 ⊂E′ −E.
(3) Suppose µ is not a positive measure but µ(E) = 0. If A ∈A,
then
µ(A) = µ(A ∩E) + µ(A ∩F) ≥µ(E) + µ(A ∩F) ≥0,
which says that µ must be a positive measure, a contradiction. A
similar argument applies for −µ and F.
Let us say two measures µ and ν are mutually singular if there
exist two disjoint sets E and F in A whose union is X with µ(E) =
ν(F) = 0. This is often written µ ⊥ν.
Example 12.6 If µ is Lebesgue measure restricted to [0, 1/2], that
is, µ(A) = m(A ∩[0, 1/2]), and ν is Lebesgue measure restricted to
[1/2, 1], then µ and ν are mutually singular. We let E = [0, 1/2] and
F = (1/2, 1]. This example works because the Lebesgue measure
of {1/2} is 0.
Example 12.7 A more interesting example is the following. Let f
be the Cantor-Lebesgue function where we deﬁne f(x) = 1 if x ≥1
and f(x) = 0 if x ≤0 and let ν be the Lebesgue-Stieltjes measure
associated with f. Let µ be Lebesgue measure. Then µ ⊥ν. To
see this, we let E = C, where C is the Cantor set, and F = Cc. We
already know that m(E) = 0 and we need to show ν(F) = 0. To do
that, we need to show ν(I) = 0 for every open interval contained
in F. This will follow if we show ν(J) = 0 for every interval of the
form J = (a, b] contained in F. But f is constant on every such
interval, so f(b) = f(a), and therefore ν(J) = f(b) −f(a) = 0.

12.3. JORDAN DECOMPOSITION THEOREM
97
12.3
Jordan decomposition theorem
The following is known as the Jordan decomposition theorem.
Theorem 12.8 If µ is a signed measure on a measurable space
(X, A), there exist positive measures µ+ and µ−such that µ =
µ+−µ−and µ+ and µ−are mutually singular. This decomposition
is unique.
Proof.
Let E and F be negative and positive sets, resp., for µ
so that X = E ∪F and E ∩F = ∅.
Let µ+(A) = µ(A ∩F),
µ−(A) = −µ(A ∩E). This gives the desired decomposition.
If µ = ν+ −ν−is another such decomposition with ν+, ν−
mutually singular, let E′ be a set such that ν+(E′) = 0 and
ν−((E′)c) = 0. Set F ′ = (E′)c. Hence X = E′∪F ′ and E′∩F ′ = ∅.
If A ⊂F ′, then ν−(A) ≤ν−(F ′) = 0, and so
µ(A) = ν+(A) −ν−(A) = ν+(A) ≥0,
and consequently F ′ is a positive set for µ. Similarly, E′ is a nega-
tive set for µ. Thus E′, F ′ gives another Hahn decomposition of X.
By the uniqueness part of the Hahn decomposition theorem, F∆F ′
is a null set with respect to µ. Since ν+(E′) = 0 and ν−(F ′) = 0,
if A ∈A, then
ν+(A) = ν+(A ∩F ′) = ν+(A ∩F ′) −ν−(A ∩F ′)
= µ(A ∩F ′) = µ(A ∩F) = µ+(A),
and similarly ν−= µ−.
The measure
|µ| = µ+ + µ−
(12.1)
is called the total variation measure of µ.
12.4
Exercises
Exercise 12.1 Suppose µ is a signed measure. Prove that A is a
null set with respect to µ if and only if |µ|(A) = 0.

98
CHAPTER 12. SIGNED MEASURES
Exercise 12.2 Let µ be a signed measure. Deﬁne
Z
f dµ =
Z
f dµ+ −
Z
f dµ−.
Prove that

Z
f dµ
 ≤
Z
|f| d|µ|.
Exercise 12.3 Let µ be a signed measure on (X, A). Prove that
|µ(A)| = sup
n
Z
A
f dµ
 : f ≤1
o
.
Exercise 12.4 Let µ be a positive measure and ν a signed mea-
sure. Prove that ν ≪µ if and only if ν+ ≪µ and ν−≪µ.
Exercise 12.5 Let (X, A) be a measurable space. Suppose λ =
µ −ν, where µ and ν are ﬁnite positive measures.
Prove that
µ(A) ≥λ+(A) and ν(A) ≥λ−(A) for every A ∈A.
Exercise 12.6 Let (X, A) be a measurable space. Prove that if µ
and ν are ﬁnite signed measures, then |µ + ν|(A) ≤|µ(A)| + |ν(A)|
for every A ∈A.
Exercise 12.7 Suppose that µ is a signed measure on (X, A).
Prove that if A ∈A, then
µ+(A) = sup{µ(B) : B ∈A, B ⊂A}
and
µ−(A) = −inf{µ(B) : B ∈A, B ⊂A}.
Exercise 12.8 Suppose that µ is a signed measure on (X, A).
Prove that if A ∈A, then
|µ|(A) = sup
n
n
X
j=1
|µ(Bj)| : each Bj ∈A,
the Bj are disjoint, ∪n
j=1Bj = A
o
.

Chapter 13
The Radon-Nikodym
theorem
Suppose f is non-negative and integrable with respect to µ. If we
deﬁne ν by
ν(A) =
Z
A
f dµ,
(13.1)
then ν is a measure.
The only part that needs thought is the
countable additivity. If An are disjoint measurable sets, we have
ν(∪nAn) =
Z
∪nAn
f dµ =
∞
X
n=1
Z
An
f dµ =
∞
X
n=1
ν(An)
by using Proposition 7.5. Moreover, ν(A) is zero whenever µ(A)
is.
In this chapter we consider the converse. If we are given two
measures µ and ν, when does there exist f such that (13.1) holds?
The Radon-Nikodym theorem answers this question.
13.1
Absolute continuity
Deﬁnition 13.1 A measure ν is said to be absolutely continuous
with respect to a measure µ if ν(A) = 0 whenever µ(A) = 0. We
write ν ≪µ.
99

100
CHAPTER 13. THE RADON-NIKODYM THEOREM
Proposition 13.2 Let ν be a ﬁnite measure. Then ν is absolutely
continuous with respect to µ if and only if for all ε there exists δ
such that µ(A) < δ implies ν(A) < ε.
Proof.
Suppose for each ε, there exists δ such that µ(A) < δ
implies ν(A) < ε. If µ(A) = 0, then ν(A) < ε for all ε, hence
ν(A) = 0, and thus ν ≪µ.
Suppose now that ν ≪µ. If there exists an ε for which no
corresponding δ exists, then there exists Ek such that µ(Ek) < 2−k
but ν(Ek) ≥ε. Let F = ∩∞
n=1 ∪∞
k=n Ek. Then
µ(F) = lim
n→∞µ(∪∞
k=nEk) ≤lim
n→∞
∞
X
k=n
2−k = 0,
but
ν(F) = lim
n→∞ν(∪∞
k=nEk) ≥ε;
This contradicts the absolute continuity.
13.2
The main theorem
Lemma 13.3 Let µ and ν be ﬁnite positive measures on a mea-
surable space (X, A). Either µ ⊥ν or else there exists ε > 0 and
G ∈A such that µ(G) > 0 and G is a positive set for ν −εµ.
Proof. Consider the Hahn decomposition for ν −1
nµ. Thus there
exists a negative set En and a positive set Fn for this measure,
En and Fn are disjoint, and their union is X. Let F = ∪nFn and
E = ∩nEn. Note Ec = ∪nEc
n = ∪nFn = F.
For each n, E ⊂En, so
ν(E) ≤ν(En) ≤1
nµ(En) ≤1
nµ(X).
Since ν is a positive measure, this implies ν(E) = 0.
One possibility is that µ(Ec) = 0, in which case µ ⊥ν. The
other possibility is that µ(Ec) > 0. In this case, µ(Fn) > 0 for
some n. Let ε = 1/n and G = Fn. Then from the deﬁnition of Fn,
G is a positive set for ν −εµ.

13.2. THE MAIN THEOREM
101
We now are ready for the Radon-Nikodym theorem.
Theorem 13.4 Suppose µ is a σ-ﬁnite positive measure on a mea-
surable space (X, A) and ν is a ﬁnite positive measure on (X, A)
such that ν is absolutely continuous with respect to µ. Then there
exists a µ-integrable non-negative function f which is measurable
with respect to A such that
ν(A) =
Z
A
f dµ
for all A ∈A. Moreover, if g is another such function, then f = g
almost everywhere with respect to µ.
The function f is called the Radon-Nikodym derivative of ν with
respect to µ or sometimes the density of ν with respect to µ, and
is written f = dν/dµ. Sometimes one writes
dν = f dµ.
The idea of the proof is to look at the set of f such that
R
A f dµ ≤ν(A) for each A ∈A, and then to choose the one such
that
R
X f dµ is largest.
Proof. Step 1. Let us ﬁrst prove the uniqueness assertion. For
every set A we have
Z
A
(f −g) dµ = ν(A) −ν(A) = 0.
By Proposition 8.1 we have f −g = 0 a.e. with respect to µ.
Step 2. Let us assume µ is a ﬁnite measure for now. In this step
we deﬁne the function f. Deﬁne
F =
n
g measurable : g ≥0,
Z
A
g dµ ≤ν(A) for all A ∈A
o
.
F is not empty because 0 ∈F. Let L = sup{
R
g dµ : g ∈F},
and let gn be a sequence in F such that
R
gn dµ →L. Let hn =
max(g1, . . . , gn).
We claim that if g1 and g2 are in F, then h2 = max(g1, g2) is

102
CHAPTER 13. THE RADON-NIKODYM THEOREM
also in F. To see this, let B = {x : g1(x) ≥g2(x)}, and write
Z
A
h2 dµ =
Z
A∩B
h2 dµ +
Z
A∩Bc h2 dµ
=
Z
A∩B
g1 dµ +
Z
A∩Bc g2 dµ
≤ν(A ∩B) + ν(A ∩Bc)
= ν(A).
Therefore h2 ∈F.
By an induction argument, hn is in F.
The hn increase, say to f. By monotone convergence,
R
f dµ =
L and
Z
A
f dµ ≤ν(A)
(13.2)
for all A.
Step 3. Next we prove that f is the desired function. Deﬁne a
measure λ by
λ(A) = ν(A) −
Z
A
f dµ.
λ is a positive measure since f ∈F.
Suppose λ is not mutually singular to µ. By Lemma 13.3, there
exists ε > 0 and G such that G is measurable, µ(G) > 0, and G is
a positive set for λ −εµ. For any A ∈A,
ν(A) −
Z
A
f dµ = λ(A) ≥λ(A ∩G) ≥εµ(A ∩G) =
Z
A
εχG dµ,
or
ν(A) ≥
Z
A
(f + εχG) dµ.
Hence f + εχG ∈F. But
Z
X
(f + εχG) dµ = L + εµ(G) > L,
a contradiction to the deﬁnition of L.
Therefore λ ⊥µ.
Then there must exist H ∈A such that
µ(H) = 0 and λ(Hc) = 0. Since ν ≪µ, then ν(H) = 0, and hence
λ(H) = ν(H) −
Z
H
f dµ = 0.

13.3. LEBESGUE DECOMPOSITION THEOREM
103
This implies λ = 0, or ν(A) =
R
A f dµ for all A.
Step 4. We now suppose µ is σ-ﬁnite. There exist Fi ↑X such
that µ(Fi) < ∞for each i. Let µi be the restriction of µ to Fi,
that is, µi(A) = µ(A ∩Fi). Deﬁne νi, the restriction of ν to Fi,
similarly. If µi(A) = 0, then µ(A ∩Fi) = 0, hence ν(A ∩Fi) = 0,
and thus νi(A) = 0. Therefore νi ≪µi. If fi is the function such
that dνi = fi dµi, the argument of Step 1 shows that fi = fj on Fi
if i ≤j. Deﬁne f by f(x) = fi(x) if x ∈Fi. Then for each A ∈A,
ν(A ∩Fi) = νi(A) =
Z
A
fi dµi =
Z
A∩Fi
f dµ.
Letting i →∞shows that f is the desired function.
13.3
Lebesgue decomposition theorem
The proof of the Lebesgue decomposition theorem is almost the
same.
Theorem 13.5 Suppose µ and ν are two ﬁnite positive measures.
There exist positive measures λ, ρ such that ν = λ+ρ, ρ is absolutely
continuous with respect to µ, and λ and µ are mutually singular.
Proof.
Deﬁne F and L and construct f as in the proof of the
Radon-Nikodym theorem. Let ρ(A) =
R
A f dµ and let λ = ν −ρ.
Our construction shows that
Z
A
f dµ ≤ν(A),
so λ(A) ≥0 for all A. We have ρ + λ = ν. We need to show µ and
λ are mutually singular.
If not, by Lemma 13.3, there exists ε > 0 and F ∈A such that
µ(F) > 0 and F is a positive set for λ −εµ. We get a contradic-
tion exactly as in the proof of the Radon-Nikodym theorem. We
conclude that λ ⊥µ.

104
CHAPTER 13. THE RADON-NIKODYM THEOREM
13.4
Exercises
Exercise 13.1 This exercise asks you to prove the Radon-Niko-
dym theorem for signed measures.
Let (X, A) be a measurable
space. Suppose ν is a signed measure, µ is a ﬁnite positive measure,
and ν(A) = 0 whenever µ(A) = 0 and A ∈A. Show there exists
an integrable real-valued function f such that ν(A) =
R
A f dµ for
all A ∈A.
Exercise 13.2 We deﬁne a complex measure µ on a measurable
space (X, A) to be a map from A to C such that µ(∅) = 0 and
µ(∪∞
i=1Ai) = P∞
i=1 µ(Ai) whenever the Ai are in A and are pair-
wise disjoint. Formulate and prove a Radon-Nikodym theorem for
complex measures.
Exercise 13.3 Let (X, A) be a measurable space and let µ and ν
be two ﬁnite measures. We say µ and ν are equivalent measures if
µ ≪ν and ν ≪µ. Show that µ and ν are equivalent if and only
if there exists a measurable function f that is strictly positive a.e.
with respect to µ such that dν = f dµ.
Exercise 13.4 Suppose µ and ν are two ﬁnite measures such that
ν is absolutely continuous with respect to µ. Let ρ = µ + ν. Note
that µ(A) ≤ρ(A) and ν(A) ≤ρ(A) for each measurable A. In
particular, µ ≪ρ and ν ≪ρ.
Prove that if f = dµ/dρ and
g = dν/dρ, then g is strictly positive for almost every x with respect
to µ, f + g = 1, and dν = (f/g) dµ.
Exercise 13.5 If µ is a signed measure on (X, A) and |µ| is the
total variation measure, prove that there exists a real-valued func-
tion f that is measurable with respect to A such that |f| = 1 a.e.
with respect to µ and dµ = f d|µ|.
Exercise 13.6 Suppose ν ≪µ and ρ ≪ν. Prove that ρ ≪µ and
dρ
dµ = dρ
dν · dν
dµ.
Exercise 13.7 Suppose λn is a sequence of positive measures on
a measurable space (X, A) with supn λn(X) < ∞and µ is another
ﬁnite positive measure on (X, A).
Suppose λn = fn dµ + νn is

13.4. EXERCISES
105
the Lebesgue decomposition of λn; in particular, νn ⊥µ. If λ =
P∞
n=1 λn, show that
λ =
 ∞
X
n=1
fn

dµ +
∞
X
n=1
νn
is the Lebesgue decomposition of λ.
Exercise 13.8 Let (X, F, µ) be a measure space, and suppose E
is a sub-σ-algebra of F, that is, E is itself a σ-algebra and E ⊂F.
Suppose f is a non-negative integrable function that is measurable
with respect to F. Deﬁne ν(A) =
R
A f dµ for A ∈E and let µ be
the restriction of µ to E.
(1) Prove that ν ≪µ.
(2) Since ν and µ are measures on E, then g = dν/dµ is measurable
with respect to E. Prove that
Z
A
g dµ =
Z
A
f dµ
(13.3)
whenever A ∈E. g is called the conditional expectation of f with
respect to E and we write g = E [f | E]. If f is integrable and
real-valued but not necessarily non-negative, we deﬁne
E [f | E] = E [f + | E] −E [f −| E].
(3) Show that f = g if and only if f is measurable with respect to
E.
(4) Prove that if h is E measurable and
R
A h dµ =
R
A f dµ for all
A ∈E, then h = g a.e. with respect to µ.
Exercise 13.9 Suppose (X, A, µ) is a measure space and f is in-
tegrable and measurable with respect to A. Suppose in addition
that B1, B2, . . . , Bn is a ﬁnite sequence of disjoint elements of A
whose union is X and that each Bj has positive µ measure. Let
C = σ(B1, . . . , Bn). Prove that
E [f | C] =
n
X
j=1
R
Bj f dµ
µ(Bj) χBj.
Exercise 13.10 Suppose that (X, F, µ) is a measure space, E is a
sub-σ-algebra of F, and D is a sub-σ-algebra of E. Suppose f is

106
CHAPTER 13. THE RADON-NIKODYM THEOREM
integrable, real-valued, and measurable with respect to F. Prove
that
E [ E [f | E] | D] = E [f | D]
and
E [ E [f | D] | E] = E [f | D].
Exercise 13.11 Suppose that (X, F, µ) is a measure space and
E is a sub-σ-algebra of F. Suppose that f and fg are integrable
real-valued functions, where f is measurable with respect to F and
g is measurable with respect to E. Prove that
E [fg | E] = gE [f | E].

Chapter 14
Diﬀerentiation
In this chapter we want to look at when a function from R to R is
diﬀerentiable and when the fundamental theorem of calculus holds.
Brieﬂy, our results are the following.
(1) The derivative of
R x
a f(y) dy is equal to f a.e. if f is integrable
(Theorem 14.5);
(2) Functions of bounded variation, in particular monotone func-
tions, are diﬀerentiable (Theorem 14.8);
(3)
R b
a f ′(y) dy = f(b)−f(a) if f is absolutely continuous (Theorem
14.14).
Our approach uses what are known as maximal functions and
uses the Radon-Nikodym theorem and the Lebesgue decomposition
theorem. However, some students and instructors prefer a more
elementary proof of the results on diﬀerentiation. In Sections 14.5,
14.6, and 14.7 we give an alternative approach that avoids the
use of the Radon-Nikodym theorem and Lebesgue decomposition
theorem.
The deﬁnition of derivative is the same as in elementary calcu-
lus. A function f is diﬀerentiable at x if
lim
h→0
f(x + h) −f(x)
h
exists, and the limit is called the derivative of f at x and is denoted
f ′(x). If f : [a, b] →R, we say f is diﬀerentiable on [a, b] if the
107

108
CHAPTER 14. DIFFERENTIATION
derivative exists for each x ∈(a, b) and both
lim
h→0+
f(a + h) −f(a)
h
and
lim
h→0−
f(b + h) −f(b)
h
exist.
14.1
Maximal functions
In this section we consider real-valued functions on Rn. Let B(x, r)
be the open ball with center x and radius r.
The following is an example of what is known as a covering
lemma. We use m for Lebesgue measure on Rn throughout this
section.
Proposition 14.1 Suppose E ⊂Rn is covered by a collection of
balls {Bα} of bounded diameter. There exists a disjoint sequence
B1, B2, . . . of elements of {Bα} such that
m(E) ≤5n X
k
m(Bk).
Proof. Let d(Bα) be the diameter of Bα. Choose B1 such that
d(B1) ≥1
2 sup
α d(Bα).
Once B1, . . . , Bk are chosen, choose Bk+1 disjoint from B1, . . . , Bk
such that
d(Bk+1) ≥1
2 sup{d(Bα) : Bα is disjoint from B1, . . . , Bk}.
The procedure might terminate after a ﬁnite number of steps or it
might not.
If P
k m(Bk) = ∞, we have our result. Suppose P
k m(Bk) <
∞. Let B∗
k be a ball with the same center as Bk but 5 times the
radius. We claim E ⊂∪kB∗
k. Once we have this,
m(E) ≤m(∪kB∗
k) ≤
X
k
m(B∗
k) = 5n X
k
m(Bk).

14.1. MAXIMAL FUNCTIONS
109
To show E ⊂∪kB∗
k, it suﬃces to show each Bα ⊂∪kB∗
k, since
{Bα} is a cover of E. Fix α. If Bα is one of the Bk, we are done.
If P
k m(Bk) < ∞, then d(Bk) →0.
Let k be the smallest
integer such that d(Bk+1) <
1
2d(Bα). Bα must intersect one of
B1, . . . , Bk, or else we would have chosen it instead of Bk+1. There-
fore Bα intersects Bj0 for some j0 ≤k. We know 1
2d(Bα) ≤d(Bj0),
and some simple geometry shows that Bα ⊂B∗
j0. In fact, let xj0
be the center of Bj0 and y a point in Bα ∩Bj0. If x ∈Bα, then
|x −xj0| ≤|x −y| + |y −xj0| < d(Bα) + d(Bj0)/2 ≤5
2d(Bj0),
or x ∈B∗
j0. Therefore Bα ⊂Bj0, and the proof is complete.
We say f is locally integrable if
R
K |f(x)| dx is ﬁnite whenever
K is compact. If f is locally integrable, deﬁne
Mf(x) = sup
r>0
1
m(B(x, r))
Z
B(x,r)
|f(y)| dy.
Note that without the supremum, we are looking at the average of
|f| over B(x, r). The function Mf is called the maximal function
of f.
We now prove a weak 1-1 inequality, due to Hardy and Little-
wood. It is so named because M does not map integrable functions
into integrable functions, but comes close in a certain sense to doing
so.
Theorem 14.2 If f is integrable, then for all β > 0
m({x : Mf(x) > β}) ≤5n
β
Z
|f(x)| dx.
Proof. Fix β and let Eβ = {x : Mf(x) > β}. If x ∈Eβ, then there
exists a ball Bx centered at x such that
R
Bx |f(x)| dx > βm(Bx)
by the deﬁnition of Mf(x). Then
m(Bx) ≤
R
|f|
β
,
so {Bx} is a cover of Eβ by balls of bounded diameter. Extract
a disjoint sequence B1, B2, . . . such that 5n P
k m(Bk) ≥m(Eβ).
Then
m(Eβ) ≤5n X
k
m(Bk) ≤5n
β
X
k
Z
Bk
|f|

110
CHAPTER 14. DIFFERENTIATION
= 5n
β
Z
∪kBk
|f| ≤5n
β
Z
|f|,
as desired.
If we look at the function f(x) = χB, where B is the unit ball,
note that Mf(x) is approximately a constant times |x|−n for x
large, so Mf is not integrable. Hence M does not map the class of
integrable functions into the class of integrable functions.
Theorem 14.3 Let
fr(x) =
1
m(B(x, r))
Z
B(x,r)
f(y) dy.
(14.1)
If f is locally integrable, then fr(x) →f(x) a.e. as r →0.
Proof.
It suﬃces to prove that for each N, fr(x) →f(x) for
almost every x ∈B(0, N). Let N > 0. We may suppose without
loss of generality that f is 0 outside of B(0, 2N), and thus we may
suppose f is integrable.
Fix β > 0. Let ε > 0. Using Theorem 8.4, take g continuous
with compact support such that
R
|f −g| dm < ε. If gr is deﬁned
analogously to fr using (14.1),
|gr(x) −g(x)| =

1
m(B(x, r))
Z
B(x,r)
[g(y) −g(x)] dy

(14.2)
≤
1
m(B(x, r))
Z
B(x,r)
|g(y) −g(x)| dy →0
as r →0 by the continuity of g. We have
lim sup
r→0
|fr(x) −f(x)| ≤lim sup
r→0
|fr(x) −gr(x)|
+ lim sup
r→0
|gr(x) −g(x)|
+ |g(x) −f(x)|.
The second term on the right is 0 by (14.2). We now use Theorem
14.2 and Lemma 10.4 to write
m({x : lim sup
r→0
|fr(x) −f(x)| > β})

14.1. MAXIMAL FUNCTIONS
111
≤m({x : lim sup
r→0
|fr(x) −gr(x)| > β/2})
+ m({x : |f(x) −g(x)| > β/2})
≤m({x : M(f −g)(x) > β/2}) +
R
|f −g|
β/2
≤2(5n + 1)
β
Z
|f −g|
< 2(5n + 1)ε
β
,
where we use the deﬁnition of the maximal function to see that
|fr(x) −gr(x)| ≤M(f −g)(x)
for all r. This is true for every ε, so
m({x : lim sup
r→0
|fr(x) −gr(x)| > β}) = 0.
We apply this with β = 1/j for each positive integer j, and we
conclude
m({x : lim sup
r→0
|fr(x) −f(x)| > 0})
≤∪∞
j=1m({x : lim sup
r→0
|fr(x) −f(x)| > 1/j}) = 0.
This is the result we seek.
We can get a stronger statement:
Theorem 14.4 For almost every x
1
m(B(x, r))
Z
B(x,r)
|f(y) −f(x)| dy →0
as r →0.
Proof. For each rational c there exists a set Nc of measure 0 such
that
1
m(B(x, r))
Z
B(x,r)
|f(y) −c| dy →|f(x) −c|

112
CHAPTER 14. DIFFERENTIATION
for x /∈Nc; we see this by applying Theorem 14.3 to the function
|f(x) −c|. Let N = ∪c∈QNc and suppose x /∈N. Let ε > 0 and
choose c rational such that |f(x) −c| < ε. Then
1
m(B(x, r))
Z
B(x,r)
|f(y) −f(x)| dy
≤
1
m(B(x, r))
Z
B(x,r)
|f(y) −c| dy
+
1
m(B(x, r))
Z
B(x,r)
|f(x) −c| dy
=
1
m(B(x, r))
Z
B(x,r)
|f(y) −c| dy + |f(x) −c|
and hence
lim sup
r→0
1
m(B(x, r))
Z
B(x,r)
|f(y) −f(x)| dy ≤2|f(x) −c| < 2ε.
Since ε is arbitrary, our result follows.
If we apply the above to the function f = χE, then for almost
all x ∈E
1
m(B(x, r)
Z
B(x,r)
χE →1,
or
m(E ∩B(x, r))
m(B(x, r))
→1,
and similarly, for almost all x /∈E, the ratio tends to 0. The points
where the ratio tends to 1 are called points of density for E.
14.2
Antiderivatives
For the remainder of the chapter we consider real-valued functions
on the real line R. We can use the results on maximal functions
to show that the derivative of the antiderivative of an integrable
function is the function itself. A ball B(x, h) in R is merely the
interval (x−h, x+h). We use m for Lebesgue measure throughout.
Deﬁne the indeﬁnite integral or antiderivative of an integrable
function f by
F(x) =
Z x
a
f(t) dt.

14.3. BOUNDED VARIATION
113
Recall by Exercise 7.6 that F is continuous.
Theorem 14.5 Suppose f : R →R is integrable and a ∈R. De-
ﬁne
F(x) =
Z x
a
f(y) dy.
Then F is diﬀerentiable almost everywhere and F ′(x) = f(x) a.e.
Proof. If h > 0, we have
F(x + h) −F(x) =
Z x+h
x
f(y) dy,
so
F(x + h) −F(x)
h
−f(x)
 = 1
h

Z x+h
x
(f(y) −f(x)) dy

≤2
1
m(B(x, h))
Z x+h
x−h
|f(y) −f(x)| dy.
By Theorem 14.4, the right hand side goes to 0 as h →0 for almost
every x, and we conclude the right hand derivative of F exists and
equals f for almost every x. The left hand derivative is handled
similarly.
14.3
Bounded variation
In this section we show that functions of bounded variation are
diﬀerentiable almost everywhere. We start with right continuous
increasing functions.
Lemma 14.6 Suppose H : R →R is increasing, right continuous,
and constant for x ≥1 and x ≤0. Let λ be the Lebesgue-Stieltjes
measure deﬁned using the function H and suppose λ and m are
mutually singular. Then
lim
r→0
λ(B(x, r))
m(B(x, r)) = 0
for almost every x.

114
CHAPTER 14. DIFFERENTIATION
Proof. This is clear if x < 0 or x > 1. Since λ ⊥m, there exist
measurable sets E and F such that λ(F) = 0, m(E) = 0, and
F = Ec. Let ε > 0.
Step 1. The ﬁrst step of the proof is to ﬁnd a bounded open set
G such that F ⊂G and λ(G) < ε. By the deﬁnition of Lebesgue-
Stieltjes measure, there exist ai < bi such that F ⊂∪∞
i=1(ai, bi]
and
∞
X
i=1
[H(bi) −H(ai)] < ε/2.
Since H is right continuous, for each i there exists b′
i > bi such that
H(b′
i) −H(bi) < ε/2i+1.
If G′ = ∪∞
i=1(ai, b′
i), then G′ is open, G′ contains F, and
λ(G′) ≤
∞
X
i=1
λ((ai, b′
i)) ≤
∞
X
i=1
λ((ai, b′
i]) =
∞
X
i=1
[H(b′
i) −H(ai)] < ε.
Since H is constant on (−∞, 0] and [1, ∞), we can take G to be
the set G = G′ ∩(−1, 2).
Step 2. If β > 0, let
Aβ =
n
x ∈F ∩[0, 1] : lim sup
r→0
λ((x, r))
m(B(x, r)) > β
o
.
The second step is to show that m(Aβ) = 0.
If x ∈Aβ, then
x ∈F ⊂G, and there exists an open ball Bx centered at x and
contained in G such that λ(Bx)/m(Bx) > β. Use Proposition 14.1
to ﬁnd a disjoint subsequence B1, B2, . . . such that
m(Aβ) ≤5
∞
X
i=1
m(Bi).
Then
m(Aβ) ≤5
∞
X
i=1
m(Bi) ≤5
β
∞
X
i=1
λ(Bi) ≤5
β λ(G) ≤5
β ε.
Since ε is arbitrary, and our construction of G did not depend on
β, then m(Aβ) = 0.
Since m(A1/k) = 0 for each k, then
m({x ∈F ∩[0, 1] : lim sup
r→0
λ(B(x, r))/m(B(x, r)) > 0}) = 0.

14.3. BOUNDED VARIATION
115
Since m(E) = 0, this completes the proof.
Proposition 14.7 Let F : R →R be an increasing and right con-
tinuous function. Then F ′ exists a.e. Moreover, F ′ is locally inte-
grable and for every a < b,
R b
a F ′(x) dx ≤F(b) −F(a).
Proof. We will show F is diﬀerentiable a.e. on [0, 1]. Once we have
that, the same argument can be used to show that F is diﬀeren-
tiable a.e. on [−N, N] for each N, and that proves that F is diﬀer-
entiable a.e. on R. If we redeﬁne F so that F(x) = limy→0+ F(y)
if x ≤0 and F(x) = F(1) if x > 1, then F is still right continuous
and increasing, and we have not aﬀected the diﬀerentiability of F
on [0, 1] except possibly at the points 0 and 1.
Let ν be the Lebesgue-Stieltjes measure deﬁned in terms of F.
By the Lebesgue decomposition theorem, we can write ν = λ + ρ,
where λ ⊥m and ρ ≪m. Note
ρ([0, 1]) ≤ν([0, 1]) = F(1) −F(0).
By the Radon-Nikodym theorem there exists a non-negative inte-
grable function f such that ρ(A) =
R
A f dm for each measurable
A.
Let
H(x) = λ((0, x]) = ν((0, x])−ρ((0, x]) = F(x)−F(0)−
Z x
0
f(y) dy.
By Exercise 7.6, the function x →
R x
0 f(y) dy is continuous, so
H is right continuous, increasing, and λ is the Lebesgue-Stieltjes
measure deﬁned in terms of H. By Lemma 14.6,
lim sup
h→0+
H(x + h) −H(x)
h
≤lim sup
h→0+
H(x + h) −H(x −h)
h
= lim sup
h→0+
λ((x −h, x + h])
h
≤4 lim sup
h→0+
λ(B(x, 2h))
4h
= 0
for almost every x. The same is true for the left hand derivative,
so H′ exists and equals 0 for almost every x. We saw by Theo-
rem 14.5 that the function x →
R x
0 f(y) dy is diﬀerentiable almost
everywhere, and we conclude that F is diﬀerentiable a.e.

116
CHAPTER 14. DIFFERENTIATION
We have shown that F ′ = f a.e. If a < b,
Z b
a
F ′(x) dx =
Z b
a
f(x) dx = ρ((a, b]) ≤ν((a, b]) = F(b) −F(a).
This completes the proof.
Here is the main theorem on the diﬀerentiation of increasing
functions.
Theorem 14.8 If F : R →R is increasing, then F ′ exists a.e.
and
Z b
a
F ′(x) dx ≤F(b) −F(a)
(14.3)
whenever a < b.
Proof. Let G(x) = limy→x+ F(y). Since F is increasing, there are
at most countably many values of x where F is not continuous, so
F(x) = G(x) a.e. Since G is increasing and right continuous, G is
diﬀerentiable a.e. by Proposition 14.7. We will show that if x is a
point where G is diﬀerentiable and at the same time F(x) = G(x),
then F ′(x) exists and is equal to G′(x).
Let x be such a point, let L = G′(x) and let ε > 0. Because F
and G are increasing, for any h > 0 there exists a point xh strictly
between x + h and x + (1 + ε)h where F and G agree, and so
F(x + h) ≤F(xh) = G(xh) ≤G(x + (1 + ε)h).
Then
lim sup
h→0+
F(x + h) −F(x)
h
≤lim sup
h→0+
G(x + (1 + ε)h) −G(x)
h
= (1 + ε) lim sup
h→0+
G(x + (1 + ε)h) −G(x)
(1 + ε)h
= (1 + ε)L.
Similarly, lim infh→0+[F(x + h) −F(x)]/h ≥(1 −ε)L. Since ε
is arbitrary, the right hand derivative of F exists at x and is equal
to L. That the left hand derivative equals L is proved similarly.

14.3. BOUNDED VARIATION
117
Since F ′ = G′ a.e., then F ′ is locally integrable. If a < b, take
an ↓a and bn ↑b such that F and G agree on an and bn. Then
using Proposition 14.7,
F(b) −F(a) ≥F(bn) −F(an)
= G(bn) −G(an) ≥
Z bn
an
G′(x) dx
=
Z bn
an
F ′(x) dx.
Now let n →∞and use the monotone convergence theorem.
Remark 14.9 Note that if F is the Cantor-Lebesgue function,
then F ′(x) = 0 a.e., in fact at every point of Cc, where C is the
Cantor set. Thus
1 = F(1) −F(0) > 0 =
Z 1
0
F ′(x) dx,
and we do not in general have equality in (14.3).
A real-valued function f is of bounded variation on [a, b] if
sup
n
k
X
i=1
|f(xi) −f(xi−1)|
o
is ﬁnite, where the supremum is over all partitions a = x0 < x1 <
· · · < xk = b of [a, b].
Lemma 14.10 If f is of bounded variation on [a, b], then f can be
written as f = f1 −f2, the diﬀerence of two increasing functions
on [a, b].
Proof. Deﬁne
f1(y) = sup
n k
X
i=1
[f(xi) −f(xi−1)]+o
and
f2(y) = sup
n k
X
i=1
[f(xi) −f(xi−1)]−o
,

118
CHAPTER 14. DIFFERENTIATION
where the supremum is over all partitions a = x0 < x1 < · · · <
xk = y for y ∈[a, b]. f1 and f2 are measurable since they are both
increasing. Since
k
X
i=1
[f(xi) −f(xi−1)]+ =
k
X
i=1
[f(xi) −f(xi−1)]−+ f(y) −f(a),
taking the supremum over all partitions of [a, y] yields
f1(y) = f2(y) + f(y) −f(a).
Clearly f1 and f2 are increasing in y, and the result follows by
solving for f(y).
Using this lemma and Theorem 14.8, we see that functions of
bounded variation are diﬀerentiable a.e. Note that the converse
is not true: the function sin(1/x) deﬁned on (0, 1] is diﬀerentiable
everywhere, but is not of bounded variation.
Remark 14.11 If we write a function f of bounded variation as
the diﬀerence of two increasing functions f1 and f2, then the quan-
tity (f1(b) + f2(b)) −(f1(a) + f2(a)) is called the total variation
of f on the interval [a, b]. We make the observation that if f is of
bounded variation on the interval [a, b] and on the interval [b, c],
then it is of bounded variation on the interval [a, c].
14.4
Absolutely continuous functions
A real-valued function f is absolutely continuous on [a, b] if given ε
there exists δ such that Pk
i=1 |f(bi)−f(ai)| < ε whenever {(ai, bi)}
is a ﬁnite collection of disjoint intervals with Pk
i=1 |bi −ai| < δ.
It is easy to see that absolutely continuous functions are con-
tinuous and that the Cantor-Lebesgue function is not absolutely
continuous.
Lemma 14.12 If f is absolutely continuous, then it is of bounded
variation.
Proof. By the deﬁnition of absolutely continuous function with
ε = 1, there exists δ such that Pk
i=1 |f(bi) −f(ai)| < 1 whenever

14.4. ABSOLUTELY CONTINUOUS FUNCTIONS
119
Pk
i=1(bi−ai) ≤δ and the (ai, bi) are disjoint open intervals. Hence
the total variation of f on [a + jδ, a + (j + 1)δ] is less than or equal
to 1. Using Remark 14.11, we see the total variation of f on [a, b]
is ﬁnite.
Lemma 14.13 Suppose f is of bounded variation and we decom-
pose f as f = f1 −f2, where f1 and f2 are increasing functions. If
f is absolutely continuous, then so are f1 and f2.
Proof.
Given ε there exists δ such that Pk
i=1 |f(bi) −f(ai)| <
ε whenever Pk
i=1(bi −ai) ≤δ and the (ai, bi) are disjoint open
intervals. Partitioning each interval (ai, bi) into subintervals with
ai = si0 < si1 < · · · < siJi = bi, then
k
X
i=1
Ji−1
X
j=0
(si,j+1 −sij) =
k
X
i=1
(bi −ai) ≤δ.
Hence
k
X
i=1
Ji−1
X
j=0
|f(si,j+1) −f(sij)| ≤ε.
Taking the supremum over all such partitions,
k
X
i=1
|(f1 + f2)(bi) −(f1 + f2)(ai)| ≤ε,
and our conclusion follows.
Here is the main theorem on absolutely continuous functions.
Theorem 14.14 If F is absolutely continuous, then F ′ exists a.e.,
and
Z b
a
F ′(x) dx = F(b) −F(a).
Proof. By Lemma 14.13 it suﬃces to suppose F is increasing and
absolutely continuous. Let ν be the Lebesgue-Stieltjes measure de-
ﬁned in terms of F. Since F is continuous, F(d)−F(c) = ν((c, d)).

120
CHAPTER 14. DIFFERENTIATION
Taking a limit as k →∞, we see that given ε there exists δ such
that P∞
i=1 |F(bi) −F(ai)| ≤ε whenever {(ai, bi)} is a collection of
disjoint intervals with P∞
i=1(bi −ai) < δ. Since any open set G can
be written as the union of disjoint intervals {(ai, bi)}, this can be
rephrased as saying, given ε there exists δ such that
ν(G) =
∞
X
i=1
ν((ai, bi)) =
∞
X
i=1
(F(bi) −F(ai)) ≤ε
whenever G is open and m(G) < δ. If m(A) < δ and A is Borel
measurable, then there exists an open set G containing A such that
m(G) < δ, and then ν(A) ≤ν(G) ≤ε. We conclude that ν ≪m.
Hence there exists a non-negative integrable function f such
that
ν(A) =
Z
A
f dm
for all Borel measurable sets A. In particular, for each x ∈[a, b],
F(x) −F(a) = ν((a, x)) =
Z x
a
f(y) dy.
By Theorem 14.5, F ′ exists and is equal to f a.e. Setting x = b we
obtain
F(b) −F(a) =
Z b
a
F ′(y) dy
as desired.
14.5
Approach 2 – diﬀerentiability
In this and the following two sections we give an alternative ap-
proach to Theorems 14.5, 14.8, and 14.14 that avoids the use of
the Radon-Nikodym theorem, and instead proceeds via a covering
lemma due to Vitali.
Let m be Lebesgue measure. Let E ⊂R be a measurable set
and let G be a collection of intervals. We say G is a Vitali cover of
E if for each x ∈E and each ε > 0 there exists an interval G ∈G
containing x whose length is less than ε.
The following is known as the Vitali covering lemma, and is a
reﬁnement of Proposition 14.1.

14.5. APPROACH 2 – DIFFERENTIABILITY
121
Lemma 14.15 Suppose E has ﬁnite measure and let G be a Vitali
cover of E. Given ε > 0 there exists a ﬁnite subcollection of disjoint
intervals I1, . . . , In ∈G such that m(E −∪n
i=1In) < ε.
Proof. We may replace each interval in G by a closed one, since
the set of endpoints of a ﬁnite subcollection will have measure 0.
Let G be an open set of ﬁnite measure containing E. Since G is
a Vitali cover, we may suppose without loss of generality that each
set of G is contained in G. Let
a0 = sup{m(I) : I ∈G}.
Let I1 be any element of G with m(I1) ≥a0/2. Let
a1 = sup{m(I) : I ∈G, I disjoint from I1},
and choose I2 ∈G disjoint from I1 such that m(I2) ≥a1/2. Con-
tinue in this way, choosing In+1 disjoint from I1, . . . , In and in G
with length at least one half as large as any other such interval in
G that is disjoint from I1, . . . , In.
If the process stops at some ﬁnite stage, we are done. If not, we
generate a sequence of disjoint intervals I1, I2, . . . Since they are
disjoint and all contained in G, then P∞
i=1 m(Ii) ≤m(G) < ∞.
Therefore there exists N such that P∞
i=N+1 m(Ii) < ε/5.
Let R = E −∪N
i=1Ii. We claim m(R) < ε. Let I∗
n be the interval
with the same center as In but ﬁve times the length. Let x ∈R.
Since we supposed each interval in G was to be modiﬁed so as to
include its endpoints, then ∪n
i=1Ii is closed.
Hence there exists
an interval I ∈G containing x with I disjoint from I1, . . . , IN.
Since P
n m(In) < ∞, then P
n an ≤2 P
n m(In) < ∞, and an →
0. Hence I must either be one of the In for some n > N or at
least intersect it, for otherwise we would have chosen I at some
stage. Let n be the smallest integer such that I intersects In; note
n > N. We have m(I) ≤an−1 ≤2m(In). Since x is in I and I
intersects In, the distance from x to the midpoint of In is at most
m(I) + m(In)/2 ≤(5/2)m(In). Therefore x ∈I∗
n.
Thus we have R ⊂∪∞
i=N+1I∗
i , so
m(R) ≤
∞
X
i=N+1
m(I∗
i ) = 5
∞
X
i=N+1
m(Ii) < ε.

122
CHAPTER 14. DIFFERENTIATION
This completes the proof.
Given a real-valued function f, we deﬁne the derivates of f at
x by
D+f(x) = lim sup
h→0+
f(x + h) −f(x)
h
,
D−f(x) = lim sup
h→0−
f(x + h) −f(x)
h
,
D+f(x) = lim inf
h→0+
f(x + h) −f(x)
h
,
D−f(x) = lim inf
h→0−
f(x + h) −f(x)
h
.
If all the derivates are equal, then f is diﬀerentiable at x and f ′(x)
is the common value.
Theorem 14.16 Suppose f is increasing on [a, b]. Then f is dif-
ferentiable almost everywhere, f ′ is integrable, and
Z b
a
f ′(x) dx ≤f(b) −f(a).
(14.4)
Proof.
We will show that the set where any two derivates are
unequal has measure zero. Let us consider the set
E = {x : D+f(x) > D−f(x)},
the other sets being similar. Let
Euv = {x : D+f(x) > v > u > D−f(x)}.
If we show m(Euv) = 0, then observing that E ⊂∪u<v,u,v∈QEuv
will show that m(E) = 0.
Let s = m(Euv), let ε > 0, and choose an open set G such
that Euv ⊂G and m(G) < s + ε. For each x ∈Euv there exists
an arbitrarily small interval [x −h, x] contained in G such that
f(x) −f(x −h) < uh.
Use Lemma 14.15 to choose I1, . . . , IN
which are disjoint and whose interiors cover a subset A of Euv of
measure greater than s −ε. Write In = [xn −hn, xn]. Thus
A = Euv ∩(∩N
n=1(xn −hn, xn)).

14.5. APPROACH 2 – DIFFERENTIABILITY
123
Taking a sum,
N
X
n=1
[f(xn) −f(xn −hn)] < u
n
X
n=1
hn < um(G) < u(s + ε).
Each point y in the subset A is the left endpoint of an arbitrarily
small interval (y, y + k) that is contained in some In and for which
f(y + k) −f(y) > vk. Using Lemma 14.15 again, we pick out a
ﬁnite collection J1, . . . , JM whose union contains a subset of A of
measure larger than s −2ε. Summing over these intervals yields
M
X
i=1
[f(yi + ki) −f(yi)] > v
M
X
i=1
ki > v(s −2ε).
Each interval Ji is contained in some interval In, and if we sum
over those i for which Ji ⊂In we ﬁnd
X
{i:Ji⊂In}
[f(yi + ki) −f(yi)] ≤f(xn) −f(xn −hn),
since f is increasing. Thus
N
X
n=1
[f(xn) −f(xn −hn)] ≥
M
X
i=1
[f(yi + ki) −f(yi)],
and so u(s + ε) > v(s −2ε). This is true for each ε, so us ≥vs.
Since v > u, this implies s = 0.
We prove similarly that D+f = D+f a.e. and D−f = D−f a.e.
and conclude that
g(x) = lim
h→0
f(x + h) −f(x)
h
is deﬁned almost everywhere and that f is diﬀerentiable wherever
g is ﬁnite.
Deﬁne f(x) = f(b) if x ≥b. Let
gn(x) = n[f(x + 1/n) −f(x)].
Then gn(x) →g(x) for almost all x, and so g is measurable. Since
f is increasing, gn ≥0. By Fatou’s lemma and the fact that f is

124
CHAPTER 14. DIFFERENTIATION
increasing,
Z b
a
g ≤lim inf
n
Z b
a
gn
= lim inf
n
n
Z b
a
[f(x + 1/n) −f(x)]
= lim inf
n
h
n
Z b+1/n
b
f −n
Z a+1/n
a
f
i
= lim inf
n
h
f(b) −n
Z a+1/n
a
f
i
≤f(b) −f(a).
We used a change of variables in the second equality. This shows
that g is integrable and hence ﬁnite almost everywhere.
We refer the reader to Lemma 14.10 to see that a function of
bounded variation is diﬀerentiable almost everywhere.
14.6
Approach 2 – antiderivatives
Continuing the alternative approach, we look at when the deriva-
tive of
F(x) =
Z x
a
f(t) dt
(14.5)
is equal to f(x) a.e.
Theorem 14.17 If f is integrable and F is deﬁned by (14.5), then
F ′(x) = f(x) for almost every x.
Proof. By writing f = f + −f −, it suﬃces to consider the case
where f is non-negative. In this case F is increasing, and so F ′
exists a.e. By Exercise 7.6 we know F is continuous.
Suppose for the moment that f is bounded by K. Then
F(x + 1/n) −F(x)
1/n
 =
n
Z x+1/n
x
f(t) dt


14.6. APPROACH 2 – ANTIDERIVATIVES
125
is also bounded by K. By dominated convergence,
Z c
a
F ′(x) dx = lim
n n
Z c
a
[F(x + 1/n) −F(x)] dx
= lim
n
h
n
Z c+1/n
c
F(x) dx −n
Z a+c
a
F(x) dx
i
= F(c) −F(a) =
Z c
a
f(x) dx.
We used a change of variables for the second equality and the fact
that F is continuous for the third equality. Therefore
Z c
a
[F ′(x) −f(x)] dx = 0
for all c, which implies F ′ = f a.e. by Corollary 8.3.
We continue to assume f is non-negative but now allow f to be
unbounded. Since f −(f ∧K) ≥0, then
GK(x) =
Z x
a
[f −(f ∧K)] dx
is increasing, and hence has a derivative almost everywhere. More-
over,
G′
K(x) = lim
n→∞
GK(x + 1/n) −GK(x)
1/n
≥0
at points x where G′ exists since G is increasing. By the preceding
paragraph, we know the derivative of
HK(x) =
Z x
a
(f ∧K) dx
is equal to f ∧K almost everywhere. Therefore
F ′(x) = G′
K(x) + H′
K(x) ≥(f ∧K)(x),
a.e.
Since K is arbitrary, F ′ ≥f a.e., and so
Z b
a
F ′ ≥
Z b
a
f = F(b) −F(a).
Combining with (14.4) we conclude that
R b
a [F ′ −f] = 0. Since
F ′ −f ≥0 a.e., this tells us that F ′ = f a.e.

126
CHAPTER 14. DIFFERENTIATION
14.7
Approach 2 – absolute continuity
Finally, we continue the alternative approach to look at when
R b
a F ′(y) dy = F(b) −F(a).
We refer the reader to Lemma 14.12 for the proof that if f is
absolutely continuous, then it is of bounded variation.
Lemma 14.18 If f is absolutely continuous on [a, b] and f ′(x) = 0
a.e., then f is constant.
The Cantor-Lebesgue function is an example to show that we
need the absolute continuity.
Proof.
Let c ∈[a, b], let E = {x ∈[a, c] : f ′(x) = 0}, and let
ε > 0.
Choose δ such that PK
i=1 |f(bi) −f(ai)| < ε whenever
PK
i=1 |bi −ai| ≤δ and the (ai, bi) are disjoint intervals. For each
point x ∈E∩[a, c) there exist arbitrarily small intervals [x, x+h] ⊂
[a, c] such that |f(x + h) −f(x)| < εh. By Lemma 14.15 we can
ﬁnd a ﬁnite disjoint collection of such intervals that cover all of
E except for a set of measure less than δ. We label the intervals
[ai, bi] so that ai < bi ≤ai+1. Except for a set of measure less
than δ, E is covered by ∪i(ai, bi). This implies that ∪i(bi, ai+1)
has measure less than δ, or P
i |ai+1 −bi| ≤δ. By our choice of δ
and the deﬁnition of absolute continuity,
X
i
|f(ai+1) −f(bi)| < ε.
On the other hand, by our choice of the intervals (ai, bi),
X
i
|f(bi) −f(ai)| < ε
X
i
(bi −ai) ≤ε(c −a).
Adding these two inequalities together,
|f(c) −f(a)| =

X
i
[f(ai+1) −f(bi)] +
X
i
[f(bi) −f(ai)]

≤ε + ε(c −a).
Since ε is arbitrary, then f(c) = f(a), which implies that f is
constant.

14.8. EXERCISES
127
Theorem 14.19 If F is absolutely continuous, then
F(b) −F(a) =
Z b
a
F ′(y) dy.
Proof. Suppose F is absolutely continuous on [a, b]. Then F is of
bounded variation, so F = F1 −F2 where F1 and F2 are increasing,
and F ′ exists a.e. Since |F ′(x)| ≤F ′
1(x) + F ′
2(x), then
Z
|F ′(x)| dx ≤(F1(b) + F2(b)) −(F1(a) −F2(a)),
and hence F ′ is integrable. If
G(x) =
Z x
a
F ′(t) dt,
then G is absolutely continuous by Exercise 14.2, and hence F −G
is absolutely continuous. Then (F −G)′ = F ′ −G′ = F ′ −F ′ = 0
a.e., using Theorem 14.17 for the second equality. By Lemma 14.18,
F −G is constant, and thus F(x) −G(x) = F(a) −G(a).
We
conclude
F(x) =
Z x
a
F ′(t) dt + F(a).
If we set x = b, we get our result.
14.8
Exercises
Exercise 14.1 (1) Show that if f and g are absolutely continuous
on an interval [a, b], then the product fg is also.
(2) Prove the integration by parts formula:
fb)g(b) −f(a)g(a) =
Z b
a
f(x)g′(x) dx +
Z b
a
f ′(x)g(x) dx.
Exercise 14.2 If f is integrable and real-valued, a ∈R, and
F(x) =
Z x
a
f(y) dy,
prove that F is of bounded variation and is absolutely continuous.

128
CHAPTER 14. DIFFERENTIATION
Exercise 14.3 Suppose that f is a real-valued continuous function
on [0, 1] and that ε > 0.
Prove that there exists a continuous
function g such that g′(x) exists and equals 0 for a.e. x and
sup
x∈[0,1]
|f(x) −g(x)| < ε.
Exercise 14.4 Suppose f is a real-valued continuous function on
[0, 1] and f is absolutely continuous on (a, 1] for every a ∈(0, 1). Is
f necessarily absolutely continuous on [0, 1]? If f is also of bounded
variation on [0, 1], is f absolutely continuous on [0, 1]? If not, give
counterexamples.
Exercise 14.5 A real-valued function f is Lipschitz with constant
M if
|f(x) −f(y)| ≤M|x −y|
for all x, y ∈R. Prove that f is Lipschitz with constant M if and
only if f is absolutely continuous and |f ′| ≤M a.e.
Exercise 14.6 Suppose Fn is a sequence of increasing non-nega-
tive right continuous functions on [0, 1] such that supn Fn(1) < ∞.
Let F = P∞
n=1 Fn. Prove that
F ′(x) =
∞
X
n=1
F ′
n(x)
for almost every x.
Exercise 14.7 Suppose f is absolutely continuous on [0, 1] and
for A ⊂[0, 1] we let f(A) = {f(x) : x ∈A}. Prove that if A has
Lebesgue measure 0, then f(A) has Lebesgue measure 0.
Exercise 14.8 If f is real-valued and diﬀerentiable at each point
of [0, 1], is f necessarily absolutely continuous on [0, 1]? If not, ﬁnd
a counterexample.
Exercise 14.9 Find an increasing function f such that f ′ = 0 a.e.
but f is not constant on any open interval.
Exercise 14.10 If f : [a, b] →R is continuous, let M(y) be the
number of points x in [a, b] such that f(x) = y. M(y) may be
ﬁnite or inﬁnite. Prove that M is Borel measurable and
R
M(y) dy
equals the total variation of f on [a, b].

14.8. EXERCISES
129
Exercise 14.11 Let α ∈(0, 1). Find a Borel subset E of [−1, 1]
such that
lim
r→0+
m(E ∩[−r, r])
2r
= α.
Exercise 14.12 Suppose f is a real-valued continuous function
on [a, b] and the derivate D+f is non-negative on [a, b]. Prove that
f(b) ≥f(a). What if instead we have that D+f is non-negative on
[a, b]?
Exercise 14.13 Let
f(x) =
Z ∞
−∞
e−xy2
1 + y2 dy.
(1) Find the derivative of f.
(2) Find an ordinary diﬀerential equation that f solves. Find the
solution to this ordinary diﬀerential equation to determine an ex-
plicit value for f(x).
Exercise 14.14 Let (X, A, µ) be a measure space and let f be a
real-valued integrable function. Deﬁne
g(x) =
Z
|f(y) −x| µ(dy)
for x ∈R.
(1) Prove that g is absolutely continuous.
(2) Prove that limx→∞g(x) = ∞and limx→−∞g(x) = ∞.
(3) Find g′(x) and prove that g(x0) = infx∈R g(x) if and only if
µ({y : f(y) > x0}) = µ({y : f(y) < x0}).
Exercise 14.15 Suppose A ⊂[0, 1] has Lebesgue measure zero.
Find an increasing function f : [0, 1] →R that is absolutely con-
tinuous, but
lim
h→0
f(x + h) −f(x)
h
= ∞
for each x ∈A.
Exercise 14.16 Suppose that µ is a measure on the Borel σ-
algebra on [0, 1] and for every f that is real-valued and continuously
diﬀerentiable we have

Z
f ′(x) µ(dx)
 ≤
 Z 1
0
f(x)2 dx
1/2
.

130
CHAPTER 14. DIFFERENTIATION
(1) Show that µ is absolutely continuous with respect to Lebesgue
measure on [0, 1].
(2) If g is the Radon-Nikodym derivative of µ with respect to
Lebesgue measure, prove that there exists a constant c > 0 such
that
|g(x) −g(y)| ≤c|x −y|1/2,
x, y ∈[0, 1].
Exercise 14.17 Let p > 1 and f, g ∈Lp(R). Deﬁne
H(t) =
Z ∞
−∞
|f(x) + tg(x)|p dx
for t ∈R. Prove that H is a diﬀerentiable function and ﬁnd its
derivative.

Chapter 15
Lp spaces
We introduce some spaces of functions, called the Lp spaces. We
deﬁne the Lp norm of a function, prove completeness of the norm,
discuss convolutions, and consider the bounded linear functionals
on Lp. We assume throughout this chapter that the measure µ is
σ-ﬁnite.
15.1
Norms
Let (X, A, µ) be a σ-ﬁnite measure space. For 1 ≤p < ∞, deﬁne
the Lp norm of f by
∥f∥p =
 Z
|f(x)|p dµ
1/p
.
(15.1)
For p = ∞, deﬁne the L∞norm of f by
∥f∥∞= inf{M : µ({x : |f(x)| ≥M}) = 0}.
(15.2)
Thus the L∞norm of a function f is the smallest number M such
that |f| ≤M a.e.
For 1 ≤p ≤∞the space Lp is the set {f : ∥f∥p < ∞}. One
can also write Lp(X) or Lp(µ) if one wants to emphasize the space
or the measure. It is clear that ∥f∥p = 0 if and only if f = 0 a.e.
If 1 < p < ∞, we deﬁne q by
1
p + 1
q = 1
131

132
CHAPTER 15. LP SPACES
and call q the conjugate exponent of p.
Basic to the study of Lp spaces is H¨older’s inequality. Note that
when p = q = 2, this is the Cauchy-Schwarz inequality.
Proposition 15.1 (H¨older’s inequality) If 1 < p, q < ∞and
p−1 + q−1 = 1, then
Z
|fg| dµ ≤∥f∥p∥g∥q.
This also holds if p = ∞and q = 1.
Proof. If M = ∥f∥∞, then |f| ≤M a.e. and
R
fg ≤M
R
|g|. The
case p = ∞and q = 1 follows.
Now let us assume 1 < p, q < ∞. If ∥f∥p = 0, then f = 0 a.e.
and
R
|fg| = 0, so the result is clear if ∥f∥p = 0 and similarly if
∥g∥q = 0. Let F(x) = |f(x)|/∥f∥p and G(x) = |g(x)|/∥g∥q. Note
∥F∥p = 1 and ∥G∥q = 1, and it suﬃces to show that
R
FG dµ ≤1.
The second derivative of the function ex is again ex, which is
everywhere positive. Any function whose second derivative is ev-
erywhere non-negative is convex, so if 0 ≤λ ≤1, we have
eλa+(1−λ)b ≤λea + (1 −λ)eb
(15.3)
for every pair of reals a ≤b. If F(x), G(x) ̸= 0, let a = p log F(x),
b = q log G(x), λ = 1/p, and 1 −λ = 1/q. We then obtain from
(15.3) that
F(x)G(x) ≤F(x)p
p
+ G(x)q
q
.
Clearly this inequality also holds if F(x) = 0 or G(x) = 0. Inte-
grating,
Z
FG dµ ≤∥F∥p
p
p
+ ∥G∥q
q
q
= 1
p + 1
q = 1.
This completes the proof.
One application of H¨older’s inequality is to prove Minkowski’s
inequality, which is simply the triangle inequality for Lp.
We ﬁrst need the following lemma:

15.1. NORMS
133
Lemma 15.2 If a, b ≥0 and 1 ≤p < ∞, then
(a + b)p ≤2p−1ap + 2p−1bp.
Proof. The case a = 0 is obvious, so we assume a > 0. Dividing
both sides by ap, letting x = b/a, and setting
f(x) = 2p−1 + 2p−1xp −(1 + x)p,
the inequality we want to prove is equivalent to showing f(x) ≥0
for x ≥0. Note f(0) > 0, f(1) = 0, limx→∞f(x) = ∞, and the
only solution to f ′(x) = 0 on (0, ∞) is x = 1. We conclude that f
takes its minimum at x = 1 and hence f(x) ≥0 for x ≥0.
Proposition 15.3 (Minkowski’s inequality) If 1 ≤p ≤∞, then
∥f + g∥p ≤∥f∥p + ∥g∥p.
Proof. Since |(f + g)(x)| ≤|f(x)| + |g(x)|, integrating gives the
case when p = 1. The case p = ∞is also easy. Now let us suppose
1 < p < ∞. If ∥f∥p or ∥g∥p is inﬁnite, the result is obvious, so
we may assume both are ﬁnite. The inequality Lemma 15.2 with
a = |f(x)| and b = |g(x)| yields, after an integration,
Z
|(f + g)(x)|p dµ ≤2p−1
Z
|f(x)|p dµ + 2p−1
Z
|g(x)|p dµ.
We therefore have ∥f+g∥p < ∞. Clearly we may assume ∥f+g∥p >
0.
Now write
|f + g|p ≤|f| |f + g|p−1 + |g| |f + g|p−1
and apply H¨older’s inequality with q = (1 −1
p)−1. We obtain
Z
|f +g|p ≤∥f∥p
 Z
|f +g|(p−1)q1/q
+∥g∥p
 Z
|f +g|(p−1)q1/q
.
Since p−1 + q−1 = 1, then (p −1)q = p, so we have
∥f + g∥p
p ≤

∥f∥p + ∥g∥p

∥f + g∥p/q
p
.

134
CHAPTER 15. LP SPACES
Dividing both sides by ∥f+g∥p/q
p
and using the fact that p−(p/q) =
1 gives us our result.
Recall the deﬁnition of normed linear space from Chapter 1.
We would like to say that by virtue of Minkowski’s inequality, Lp
is a normed linear space. This is not quite right. The Lp norm of a
function satisﬁes all the properties of a norm except that ∥f∥p = 0
does not imply that f is the zero function, only that f = 0 a.e.
The procedure we follow to circumvent this is to say two functions
are equivalent if they diﬀer on a set of measure 0.
This is an
equivalence relation for functions. We then deﬁne the space Lp to
be the set of equivalence classes with respect to this equivalence
relation, and deﬁne ∥f∥p to be the Lp norm of any function in the
same equivalence class as f. We then have that ∥· ∥p is a norm on
Lp. We henceforth keep this interpretation in the back of our minds
when we talk about a function being in Lp; the understanding is
that we identify functions that are equal a.e.
Recall Deﬁnition 10.1: fn converges to f in Lp if ∥fn −f∥p →0
as n →∞. In terms of Lp norms, this is equivalent to ∥fn−f∥p
p →0
as n →∞.
Related to the deﬁnition of L∞is the following terminology.
Given a real-valued measurable function f, the essential supremum
and essential inﬁmum are deﬁned by
ess sup f = inf{M : µ({x : f(x) > M}) = 0}
and
ess inf f = sup{m : µ({x : f(x) < m}) = 0}.
15.2
Completeness
We show that the space Lp viewed as a metric space is complete.
Theorem 15.4 If 1 ≤p ≤∞, then Lp is complete.
Proof. We will do only the case p < ∞and leave the case p = ∞
as Exercise 15.1.
Step 1. Suppose fn is a Cauchy sequence in Lp. Our ﬁrst step is
to ﬁnd a certain subsequence. Given ε = 2−(j+1), there exists nj

15.2. COMPLETENESS
135
such that if n, m ≥nj, then ∥fn −fm∥p ≤2−(j+1). Without loss
of generality we may assume nj ≥nj−1 for each j.
Step 2. Set n0 = 0 and deﬁne f0 to be identically 0. Our candidate
for the limit function will be P
j[fnj −fnj−1]. In this step we show
absolute convergence of this series. If
Aj = {x : |fnj(x) −fnj−1(x)| > 2−j/2},
then from Lemma 10.4, µ(Aj) ≤2−jp/2. We have
µ(∩∞
j=1 ∪∞
m=j Am) = lim
j→∞µ(∪∞
m=jAm) ≤lim
j→∞
∞
X
m=j
µ(Am) = 0.
Thus, except for a set of measure 0, for each x there exists a j
(depending on x) such that x /∈∪∞
m=jAm. Hence for each x (except
for those in the null set) there is a j0 (depending on x) such that
if j ≥j0, then |fnj(x) −fnj−1(x)| ≤2−j.
Set
gj(x) =
j
X
m=1
|fnm(x) −fnm−1(x)|.
gj(x) increases in j for each x. The limit is ﬁnite for almost every
x because for almost every x, |fnm(x) −fnm−1(x)| ≤2−m for m
large (how large depends on x).
Step 3. We deﬁne our function f. Set
f(x) =
∞
X
m=1
[fnm(x) −fnm−1(x)].
We showed in Step 2 that this series is absolutely convergent for
almost every x, so f is well deﬁned for a.e. x. Set f(x) = 0 for any
x where absolute convergence does not hold. We have
f(x) = lim
K→∞
K
X
m=1
[fnm(x) −fnm−1(x)] = lim
K→∞fnK(x)
since we have a telescoping series. By Fatou’s lemma,
∥f −fnj∥p
p =
Z
|f −fnj|p ≤lim inf
K→∞
Z
|fnK −fnj|p
= lim inf
K→∞∥fnK −fnj∥p
p ≤2(−j+1)p.

136
CHAPTER 15. LP SPACES
Step 4. We have thus shown that ∥f −fnj∥p →0 as j →∞. It is
standard that a Cauchy sequence with a convergent subsequence
itself converges. Here is the proof in our case. Given ε > 0, there
exists N such that ∥fn −fm∥p < ε if m, n ≥N. In particular,
∥fnj −fm∥p < ε if j is large enough. By Fatou’s lemma,
∥f −fm∥p
p ≤lim inf
j→∞∥fnj −fm∥p
p ≤εp
if m ≥N. This shows that fm converges to f in Lp norm.
Next we show:
Proposition 15.5 The set of continuous functions with compact
support is dense in Lp(R).
Proof. Suppose f ∈Lp. We have
R
|f −fχ[−n,n]|p →0 as n →∞
by dominated convergence, the dominating function being |f|p.
Hence it suﬃces to approximate functions in Lp that have compact
support. By writing f = f + −f −we may suppose f ≥0. Consider
simple functions sm increasing to f; then we have
R
|f −sm|p →0
by dominated convergence, so it suﬃces to approximate simple
functions with compact support. By linearity, it suﬃces to approx-
imate characteristic functions with compact support. Given E, a
Borel measurable set contained in a bounded interval, and ε > 0,
we showed in Proposition 8.4 that there exists g continuous with
compact support and with values in [0, 1] such that
R
|g −χE| < ε.
Since |g −χE| ≤1, then
R
|g −χE|p ≤
R
|g −χE| < ε. This com-
pletes the proof.
The same proof shows the following corollary.
Corollary 15.6 The set of continuous functions on [a, b] are dense
in the space L2([a, b]) with respect to L2([a, b]) norm.
15.3
Convolutions
The convolution of two measurable functions f and g is deﬁned by
f ∗g(x) =
Z
f(x −y)g(y) dy,

15.4. BOUNDED LINEAR FUNCTIONALS
137
provided the integral exists. By a change of variables, this is the
same as
R
f(y)g(x −y) dy, so f ∗g = g ∗f.
Proposition 15.7 If f, g ∈L1, then f ∗g is in L1 and
∥f ∗g∥1 ≤∥f∥1∥g∥1.
(15.4)
Proof. We have
Z
|f ∗g(x)| dx ≤
Z Z
|f(x −y)| |g(y)| dy dx.
(15.5)
Since the integrand on the right is non-negative, we can apply the
Fubini theorem to see that the right hand side is equal to
Z Z
|f(x −y)| dx |g(y)| dy =
Z Z
|f(x)| dx |g(y)| dy
(15.6)
= ∥f∥1∥g∥1.
The ﬁrst equality here follows by a change of variables (see Exercise
8.1).
This together with (15.5) proves (15.4).
From (15.4) we
conclude that f ∗g is ﬁnite a.e.
15.4
Bounded linear functionals
A linear functional on Lp is a map H from Lp to R satisfying
H(f + g) = H(f) + H(g),
H(af) = aH(f)
whenever f, g ∈Lp and a ∈R. (One can also have complex-valued
linear functionals, but we do not consider them in this section. See,
however, Exercise 15.28.) H is a bounded linear functional if
∥H∥= sup{|Hf| : ∥f∥p ≤1}
(15.7)
is ﬁnite. The dual space of Lp is the collection of all bounded linear
functionals with norm given by (15.7). Our goal in this section is
to identify the dual of Lp.
We deﬁne the signum function or sign function by
sgn (x) =





−1,
x < 0;
0,
x = 0;
1,
x > 0.

138
CHAPTER 15. LP SPACES
Note x sgn (x) = |x|.
The following is very useful.
Theorem 15.8 For 1 < p < ∞and p−1 + q−1 = 1,
∥f∥p = sup
nZ
fg dµ : ∥g∥q ≤1
o
.
(15.8)
When p = 1, (15.8) holds if we take q = ∞, and if p = ∞, (15.8)
holds if we take q = 1.
Proof.
The right hand side of (15.8) is less than the left hand
side by H¨older’s inequality. Thus we need only show that the right
hand side is greater than the left hand side.
Case 1: p = 1. Take g(x) = sgn f(x). Then g is bounded by 1 and
fg = |f|. This takes care of the case p = 1.
Case 2: p = ∞. If ∥f∥∞= 0, the result is trivial, so suppose
∥f∥∞> 0. Since µ is σ-ﬁnite, there exist sets Fn increasing up to
X such that µ(Fn) < ∞for each n. If M = ∥f∥∞, let a be any
ﬁnite real less than M. By the deﬁnition of L∞norm, the measure
of An = {x ∈Fn : |f(x)| > a} must be positive if n is suﬃciently
large. Let
gn(x) = sgn f(x)χAn(x)
µ(An)
.
Then the L1 norm of gn is 1 and
R
fgn =
R
An |f|/µ(An) ≥a. Since
a is arbitrary, the supremum on the right hand side of (15.8) must
be M.
Case 3: 1 < p < ∞.
We may suppose ∥f∥p > 0.
Let Fn be
measurable sets of ﬁnite measure increasing to X, qn a sequence of
non-negative simple functions increasing to f +, rn a sequence of
non-negative simple functions increasing to f −, and
sn(x) = (qn(x) −rn(x))χFn(x).
Then sn(x) →f(x) for each x, |sn(x)| increases to |f(x)| for each
x, each sn is a simple function, and ∥sn∥p < ∞for each n. Then
∥sn∥p →∥f∥p by monotone convergence, whether or not ∥f∥p is
ﬁnite. For n suﬃciently large, ∥sn∥p > 0.
Let
gn(x) = (sgn f(x))|sn(x)|p−1
∥sn∥p/q
p
.

15.4. BOUNDED LINEAR FUNCTIONALS
139
gn is again a simple function. Since (p −1)q = p, then
∥gn∥q = (
R
|sn|(p−1)q)1/q
∥sn∥p/q
p
= ∥sn∥p/q
p
∥sn∥p/q
p
= 1.
On the other hand, since |f| ≥|sn|,
Z
fgn =
R
|f| |sn|p−1
∥sn∥p/q
p
≥
R
|sn|p
∥sn∥p/q
p
= ∥sn∥p−(p/q)
p
.
Since p −(p/q) = 1, then
R
fgn ≥∥sn∥p, which tends to ∥f∥p.
This proves the right hand side of (15.8) is at least as large as the
left hand side.
The proof of Theorem 15.8 also establishes
Corollary 15.9 For 1 < p < ∞and p−1 + q−1 = 1,
∥f∥p = sup
n Z
fg : ∥g∥q ≤1, g simple
o
.
Proposition 15.10 Suppose 1 < p < ∞, p−1 + q−1 = 1, and
g ∈Lq. If we deﬁne H(f) =
R
fg for f ∈Lp, then H is a bounded
linear functional on Lp and ∥H∥= ∥g∥q.
Proof.
The linearity is obvious.
That ∥H∥≤∥g∥q follows by
H¨older’s inequality. Using Theorem 15.8 and writing
∥H∥=
sup
∥f∥p≤1
|H(f)| =
sup
∥f∥p≤1

Z
fg
 ≥
sup
∥f∥p≤1
Z
fg = ∥g∥q
completes the proof.
Theorem 15.11 Suppose 1 < p < ∞, p−1 + q−1 = 1, and H is
a real-valued bounded linear functional on Lp. Then there exists
g ∈Lq such that H(f) =
R
fg and ∥g∥q = ∥H∥.
This theorem together with Proposition 15.10 allows us to iden-
tify the dual space of Lp with Lq.

140
CHAPTER 15. LP SPACES
Proof. Suppose we are given a bounded linear functional H on
Lp. First suppose µ(X) < ∞. Deﬁne ν(A) = H(χA). We will
show that ν is a measure, that ν ≪µ and that g = dν/dµ is the
function we seek.
If A and B are disjoint, then
ν(A ∪B) = H(χA∪B) = H(χA + χB)
= H(χA) + H(χB) = ν(A) + ν(B).
To show ν is countably additive, it suﬃces to show that if An ↑A,
then ν(An) →ν(A), and then use Exercise 3.1. But if An ↑A,
then χAn →χA in Lp, and so ν(An) = H(χAn) →H(χA) = ν(A);
we use here the fact that µ(X) < ∞. We conclude that ν is a
countably additive signed measure. Moreover, if µ(A) = 0, then
χA = 0 a.e., hence ν(A) = H(χA) = 0. Using Exercise 13.1, which
is the Radon-Nikodym theorem for signed measures, we see there
exists a real-valued integrable function g such that ν(A) =
R
A g for
all sets A.
If s = P
i aiχAi is a simple function, by linearity we have
H(s) =
X
i
aiH(χAi) =
X
i
aiν(Ai) =
X
i
ai
Z
gχAi =
Z
gs.
(15.9)
By Corollary 15.9 and (15.9),
∥g∥q = sup
nZ
gs : ∥s∥p ≤1, s simple
o
= sup{H(s) : ∥s∥p ≤1, s simple} ≤∥H∥.
If sn are simple functions tending to f in Lp (see Exercise 15.2),
then H(sn) →H(f), while by H¨older’s inequality

Z
sng −
Z
fg
 =

Z
(sn −f)g
 ≤∥sn −f∥p∥g∥q →0,
so
R
sng →
R
fg. We thus have H(f) =
R
fg for all f ∈Lp, and
∥g∥q ≤∥H∥. By H¨older’s inequality, ∥H∥≤∥g∥q.
In the case where µ is σ-ﬁnite, but not necessarily ﬁnite, let
Fn ↑X so that µ(Fn) < ∞for each n. Deﬁne functionals Hn by
Hn(f) = H(fχFn). Clearly each Hn is a bounded linear functional
on Lp. Applying the above argument, we see there exist gn such
that Hn(f) =
R
fgn and ∥gn∥q = ∥Hn∥≤∥H∥. It is easy to see

15.5. EXERCISES
141
that gn is 0 if x /∈Fn. Moreover, by the uniqueness part of the
Radon-Nikodym theorem, if n > m, then gn = gm on Fm. Deﬁne
g by setting g(x) = gn(x) if x ∈Fn. Then g is well deﬁned. By
Fatou’s lemma, g is in Lq with a norm bounded by ∥H∥. Note
fχFn →f in Lp by dominated convergence. Since H is a bounded
linear functional on Lp, we have Hn(f) = H(fχFn) →H(f). On
the other hand
Hn(f) =
Z
Fn
fgn =
Z
Fn
fg →
Z
fg
by dominated convergence. Thus H(f) =
R
fg. Again by H¨older’s
inequality ∥H∥≤∥g∥q.
15.5
Exercises
Exercise 15.1 Show that L∞is complete.
Exercise 15.2 Prove that the collection of simple functions is
dense in Lp.
Exercise 15.3 Prove the equality
Z
|f(x)|p dx =
Z ∞
0
ptp−1 m({x : |f(x)| ≥t}) dt
for p ≥1.
Exercise 15.4 Consider the measure space ([0, 1], B, m), where B
is the Borel σ-algebra and m is Lebesgue measure, and suppose f
is a measurable function. Prove that ∥f∥p →∥f∥∞as p →∞.
Exercise 15.5 When does equality hold in H¨older’s inequality?
When does equality hold in the Minkowski inequality?
Exercise 15.6 Give an example to show that Lp ̸⊂Lq in general
if 1 < p < q < ∞. Give an example to show that Lq ̸⊂Lp in
general if 1 < p < q < ∞.

142
CHAPTER 15. LP SPACES
Exercise 15.7 Deﬁne
gn(x) = nχ[0,n−3](x).
(1) Show that if f ∈L2([0, 1]), then
Z 1
0
f(x)gn(x) dx →0
as n →∞.
(2) Show that there exists f ∈L1([0, 1]) such that
R 1
0 f(x)gn(x) dx
̸→0.
Exercise 15.8 Suppose µ is a ﬁnite measure on the Borel subsets
of R such that
f(x) =
Z
R
f(x + t) µ(dt),
a.e.,
whenever f is real-valued, bounded, and integrable. Prove that
µ({0}) = 1.
Exercise 15.9 Suppose µ is a measure with µ(X) = 1 and f ∈Lr
for some r > 0, where we deﬁne Lr for r < 1 exactly as in (15.1).
Prove that
lim
p→0 ∥f∥p = exp
 Z
log |f| dµ

,
where we use the convention that exp(−∞) = 0.
Exercise 15.10 Suppose 1 < p < ∞and q is the conjugate expo-
nent to p. Suppose fn →f a.e. and supn ∥fn∥p < ∞. Prove that
if g ∈Lq, then
lim
n→∞
Z
fng =
Z
fg.
Does this extend to the case where p = 1 and q = ∞? If not, give
a counterexample.
Exercise 15.11 If f ∈L1(R) and g ∈Lp(R) for some p ∈[1, ∞),
prove that
∥f ∗g∥p ≤∥f∥1∥g∥p.
Exercise 15.12 Suppose p ∈(1, ∞) and q is its conjugate expo-
nent. Prove that if f ∈Lp(R) and g ∈Lq(R), then f∗g is uniformly
continuous and f ∗g(x) →0 as x →∞and as x →−∞.

15.5. EXERCISES
143
Exercise 15.13 Show that if f and g are continuous with compact
support, then f ∗g is continuous with compact support.
Exercise 15.14 Suppose f ∈L∞(R), fh(x) = f(x + h), and
lim
h→0 ∥fh −f∥∞= 0.
Prove that there exists a uniformly continuous function g on R such
that f = g a.e.
Exercise 15.15 Let p ∈[1, ∞). Prove that f ∈Lp(µ) if and only
if
∞
X
n=1
(2n)pµ({x : |f(x)| > 2n}) < ∞.
Exercise 15.16 Suppose µ(X) = 1 and f and g are non-negative
functions such that fg ≥1 a.e. Prove that
 Z
f dµ
 Z
g dµ

≥1.
Exercise 15.17 Suppose f : [1, ∞) →R, f(1) = 0, f ′ exists and is
continuous and bounded, and f ′ ∈L2([1, ∞)). Let g(x) = f(x)/x.
Show g ∈L2([1, ∞)).
Exercise 15.18 Find an example of a measurable f : [1, ∞) →R
such that f(1) = 0, f ′ exists and is continuous and bounded, f ′ ∈
L1([1, ∞)), but the function g(x) = f(x)/x is not in L1.
Exercise 15.19 Prove the generalized Minkowski inequality: If
(X, A, µ) and (Y, B, ν) are measure spaces, f is measurable with
respect to A × B, and 1 < p < ∞, then
 Z
X
 Z
Y
|f(x, y)| ν(dy)
p
µ(dx)
1/p
≤
Z
Y
 Z
X
|f(x, y)|p µ(dx)
1/p
ν(dy).
Does this extend to the cases where p = 1 or p = ∞? If not, give
counterexamples.
If Y = {1, 2}, ν(dy) = δ1(dy)+δ2(dy), where δ1 and δ2 are point
masses at 1 and 2, resp. and we let g1(x) = f(x, 1), g2(x) = f(x, 2),
we recover the usual Minkowski inequality, Proposition 15.3.

144
CHAPTER 15. LP SPACES
Exercise 15.20 Let α ∈(0, 1) and K(x) = |x|−α for x ∈R. Note
that K is not in Lp for any p ≥1. Prove that if f is non-negative,
real-valued, and integrable on R and
g(x) =
Z
f(x −t)K(t) dt,
then g is ﬁnite a.e.
Exercise 15.21 Suppose p > 1 and q is its conjugate exponent,
f is an absolutely continuous function on [0, 1] with f ′ ∈Lp, and
f(0) = 0. Prove that if g ∈Lq, then
Z 1
0
|fg| dx ≤
1
p
1/p
∥f ′∥p∥g∥q.
Exercise 15.22 Suppose f : R →R is in Lp for some p > 1 and
also in L1. Prove there exist constants c > 0 and α ∈(0, 1) such
that
Z
A
|f(x)| dx ≤cm(A)α
for every Borel measurable set A ⊂R, where m is Lebesgue mea-
sure.
Exercise 15.23 Suppose f : R →R is integrable and there exist
constants c > 0 and α ∈(0, 1) such that
Z
A
|f(x)| dx ≤cm(A)α
for every Borel measurable set A ⊂R, where m is Lebesgue mea-
sure. Prove there exists p > 1 such that f ∈Lp.
Exercise 15.24 Suppose 1 < p < ∞, f : (0, ∞) →R, and f ∈Lp
with respect to Lebesgue measure. Deﬁne
g(x) = 1
x
Z x
0
f(y) dy.
Prove that
∥g∥p ≤
p
p −1∥f∥p.
This is known as Hardy’s inequality.

15.5. EXERCISES
145
Exercise 15.25 Suppose (X, A, µ) is a measure space and suppose
K : X × X →R is measurable with respect to A × A. Suppose
there exists M < ∞such that
Z
X
|K(x, y)| µ(dy) ≤M
for each x and
Z
X
|K(x, y)| µ(dx) ≤M
for each y. If f is measurable and real-valued, deﬁne
Tf(x) =
Z
X
K(x, y)f(y) µ(dy)
if the integral exists.
(1) Show that ∥Tf∥1 ≤M∥f∥1.
(2) If 1 < p < ∞, show that ∥Tf∥p ≤M∥f∥p.
Exercise 15.26 Suppose A and B are two Borel measurable sub-
sets of R with ﬁnite strictly positive Lebesgue measure. Show that
χA∗χB is a continuous non-negative function that is not identically
equal to 0.
Exercise 15.27 Suppose A and B are two Borel measurable sub-
sets of R with strictly positive Lebesgue measure. Show that
C = {x + y : x ∈A, y ∈B}
contains a non-empty open interval.
Exercise 15.28 Suppose 1 < p < ∞and q is the conjugate ex-
ponent of p.
Prove that if H is a bounded complex-valued lin-
ear functional on Lp, then there exists a complex-valued measur-
able function g ∈Lq such that H(f) =
R
fg for all f ∈Lp and
∥H∥= ∥g∥q.

146
CHAPTER 15. LP SPACES

Chapter 16
Fourier transforms
Fourier transforms give a representation of a function in terms of
frequencies. There is a great deal known about them and their
applications. We give an introduction here.
16.1
Basic properties
If f is a complex-valued function and f ∈L1(Rn), deﬁne the
Fourier transform bf to be the function with domain Rn and range
C given by
bf(u) =
Z
Rn eiu·xf(x) dx,
u ∈Rn.
(16.1)
We are using u · x for the standard inner product in Rn. Various
books have slightly diﬀerent deﬁnitions. Some put a negative sign
and/or 2π before the iu · x, some have a (2π)−1 or a (2π)−1/2 in
front of the integral. The basic theory is the same in any case.
Some basic properties of the Fourier transform are given by
Proposition 16.1 Suppose f and g are in L1. Then
(1) bf is bounded and continuous;
(2) \
(f + g)(u) = bf(u) + bg(u);
(3) d
(af)(u) = a bf(u) if a ∈C;
(4) if a ∈Rn and fa(x) = f(x + a), then bfa(u) = e−iu·a bf(u);
147

148
CHAPTER 16. FOURIER TRANSFORMS
(5) if a ∈Rn and ga(x) = eia·xg(x), then bga(u) = bf(u + a);
(6) if a is a nonzero real number and ha(x) = f(ax), then bha(u) =
a−n bf(u/a).
Proof. (1) bf is bounded because f ∈L1 and |eiu·x| = 1. We have
bf(u + h) −bf(u) =
Z 
ei(u+h)·x −eiu·x
f(x) dx.
Then
| bf(u + h) −bf(u)| ≤
Z eiu·x ·
eih·x −1
 |f(x)| dx.
The integrand is bounded by 2|f(x)|, which is integrable, and
eih·x −1 →0 as h →0. Thus the continuity follows by domi-
nated convergence.
(2) and (3) are easy by a change of variables. (4) holds because
bfa(u) =
Z
eiu·xf(x + a) dx =
Z
eiu·(x−a)f(x) dx = e−iu·a bf(u)
by a change of variables. For (5),
bga(u) =
Z
eiu·xeia·xf(x) dx =
Z
ei(u+a)·xf(x) dx = bf(u + a).
Finally for (6), by a change of variables,
bha(u) =
Z
eiu·xf(ax) dx = a−n
Z
eiu·(y/a)f(y) dy
= a−n
Z
ei(u/a)·yf(y) dy = a−n bf(u/a),
as required.
One reason for the usefulness of Fourier transforms is that they
relate derivatives and multiplication.
Proposition 16.2 Suppose f ∈L1 and xjf(x) ∈L1, where xj is
the jth coordinate of x. Then
∂bf
∂uj
(u) = i
Z
eiu·xxjf(x) dx.

16.1. BASIC PROPERTIES
149
Proof. Let ej be the unit vector in the jth direction. Then
bf(u + hej) −bf(u)
h
= 1
h
Z 
ei(u+hej)·x −eiu·x
f(x) dx
=
Z
eiu·xeihxj −1
h

f(x) dx.
Since
 1
h

eihxj −1
 ≤|xj|
and xjf(x) ∈L1, the right hand side converges to
R
eiu·xixjf(x) dx
by dominated convergence. Therefore the left hand side converges.
Of course, the limit of the left hand side is ∂bf/∂uj.
Proposition 16.3 Suppose f : R →R is integrable, f is absolutely
continuous, and f ′ is integrable. Then the Fourier transform of f ′
is −iu bf(u).
The higher dimensional version of this is left as Exercise 16.4.
Proof. Since f ′ is integrable,
|f(y) −f(x)| ≤
Z y
x
|f ′(z)| dz →0
as x, y →∞by dominated convergence. This implies that f(yn) is
a Cauchy sequence whenever yn →∞, and we conclude that f(y)
converges as y →∞. Since f is integrable, the only possible value
for the limit is 0. The same is true for the limit as y →−∞.
By integration by parts (use Exercise 14.1 and a limit argu-
ment),
bf ′(u) =
Z ∞
−∞
eiuxf ′(x) dx = −
Z ∞
−∞
iueiuxf(x) dx
= −iu bf(u),
as desired.
Recall the deﬁnition of convolution given in Section 15.3. Recall
also (15.6), which says that
Z Z
|f(x −y)| |g(y)| dx dy = ∥f∥1∥g∥1.
(16.2)

150
CHAPTER 16. FOURIER TRANSFORMS
Proposition 16.4 If f, g ∈L1, then the Fourier transform of f ∗g
is bf(u)bg(u).
Proof. We have
[
f ∗g(u) =
Z
eiu·x
Z
f(x −y)g(y) dy dx
=
Z Z
eiu·(x−y)f(x −y) eiu·yg(y) dx dy
=
Z
bf(u)eiu·yg(y) dy = bf(u)bg(u).
We applied the Fubini theorem in the second equality; this is valid
because as we see from (16.2), the absolute value of the integrand
is integrable. We used a change of variables to obtain the third
equality.
16.2
The inversion theorem
We want to give a formula for recovering f from bf. First we need
to calculate the Fourier transform of a particular function.
Proposition 16.5 (1) Suppose f1 : R →R is deﬁned by
f1(x) =
1
√
2π e−x2/2.
Then bf1(u) = e−u2/2.
(2) Suppose fn : Rn →R is given by
fn(x) =
1
(2π)n/2 e−|x|2/2.
Then bfn(u) = e−|u|2/2.
Proof. (1) may also be proved using contour integration, but let’s
give a (mostly) real variable proof. Let g(u) =
R
eiuxe−x2/2 dx.
Diﬀerentiate with respect to u. We may diﬀerentiate under the in-
tegral sign because (ei(u+h)x −eiux)/h is bounded in absolute value

16.2. THE INVERSION THEOREM
151
by |x| and |x|e−x2/2 is integrable; therefore dominated convergence
applies. We then obtain
g′(u) = i
Z
eiuxxe−x2/2 dx.
By integration by parts (see Exercise 14.1) this is equal to
−u
Z
eiuxe−x2/2 dx = −ug(u).
Solving the diﬀerential equation g′(u) = −ug(u), we have
[log g(u)]′ = g′(u)
g(u) = −u,
so log g(u) = −u2/2 + c1, and then
g(u) = c2e−u2/2.
(16.3)
By Exercise 11.18, g(0) =
R
e−x2/2 dx =
√
2π, so c2 =
√
2π. Sub-
stituting this value of c2 in (16.3) and dividing both sides by
√
2π
proves (1).
For (2), since fn(x) = f1(x1) · · · f1(xn) if x = (x1, . . . , xn), then
bfn(u) =
Z
· · ·
Z
ei P
j ujxjf1(x1) · · · f1(xn) dx1 · · · dxn
= bf1(u1) · · · bf1(un) = e−|u|2/2.
This completes the proof.
One more preliminary is needed before proving the inversion
theorem.
Proposition 16.6 Suppose ϕ is in L1 and
R
ϕ(x) dx = 1.
Let
ϕδ(x) = δ−nϕ(x/δ).
(1) If g is continuous with compact support, then g∗ϕδ converges
to g pointwise as δ →0.
(2) If g is continuous with compact support, then g∗ϕδ converges
to g in L1 as δ →0.
(3) If f ∈L1, then ∥f ∗ϕδ −f∥1 →0 as δ →0.

152
CHAPTER 16. FOURIER TRANSFORMS
Proof. (1) We have by a change of variables (Exercise 8.1) that
R
ϕδ(y) dy = 1. Then
|g ∗ϕδ(x) −g(x)| =

Z
(g(x −y) −g(x)) ϕδ(y) dy

=

Z
(g(x −δy) −g(x)) ϕ(y) dy

≤
Z
|g(x −δy) −g(x)| |ϕ(y)| dy.
Since g is continuous with compact support and hence bounded
and ϕ is integrable, the right hand side goes to zero by dominated
convergence, the dominating function being 2∥g∥∞ϕ.
(2) We now use the Fubini theorem to write
Z
|g ∗ϕδ(x) −g(x)| dx =
Z 
Z
(g(x −y) −g(x)) ϕδ(y) dy
 dx
=
Z 
Z
(g(x −δy) −g(x)) ϕ(y) dy
 dx
≤
Z Z
|g(x −δy) −g(x)| |ϕ(y)| dy dx
=
Z Z
|g(x −δy) −g(x)| dx |ϕ(y)| dy.
Let
Gδ(y) =
Z
|g(x −δy) −g(x)| dx.
By dominated convergence, for each y, Gδ(y) tends to 0 as δ →
0, since g is continuous with compact support.
Moreover Gδ is
bounded in absolute value by 2∥g∥1. Using dominated convergence
again and the fact that ϕ is integrable, we see that
R
Gδ(y) |ϕ(y)| dy
tends to 0 as δ →0.
(3) Let ε > 0. Let g be a continuous function with compact
support so that ∥f −g∥1 < ε. Let h = f −g. A change of variables
shows that ∥ϕδ∥1 = ∥ϕ∥1. Observe
∥f ∗ϕδ −f∥1 ≤∥g ∗ϕδ −g∥1 + ∥h ∗ϕδ −h∥1.
Also
∥h∗ϕδ −h∥1 ≤∥h∥1 +∥h∗ϕδ∥1 ≤∥h∥1 +∥h∥1∥ϕδ∥1 < ε(1+∥ϕ∥1).

16.2. THE INVERSION THEOREM
153
Therefore, using (2),
lim sup
δ→0
∥f ∗ϕδ −f∥1 ≤lim sup
δ→0
∥h ∗ϕδ −h∥1 ≤ε(1 + ∥ϕ∥1).
Since ε is arbitrary, we have our conclusion.
Now we are ready to give the inversion formula. The proof seems
longer than one might expect it to be, but there is no avoiding the
introduction of the function Ha or some similar function.
Theorem 16.7 Suppose f and bf are both in L1. Then
f(y) =
1
(2π)n
Z
e−iu·y bf(u) du,
a.e.
Proof. If g(x) = a−nk(x/a), then the Fourier transform of g is
bk(au). Hence the Fourier transform of
1
an
1
(2π)n/2 e−x2/2a2
is e−a2u2/2. If we let
Ha(x) =
1
(2π)n e−|x|2/2a2,
we have
bHa(u) = (2π)−n/2ane−a2|u|2/2.
We write
Z
bf(u)e−iu·yHa(u) du =
Z Z
eiu·xf(x)e−iu·yHa(u) dx du
=
Z Z
eiu·(x−y)Ha(u) du f(x) dx
=
Z
bHa(x −y)f(x) dx.
(16.4)
We can interchange the order of integration because
Z Z
|f(x)| |Ha(u)| dx du < ∞

154
CHAPTER 16. FOURIER TRANSFORMS
and |eiu·x| = 1. The left hand side of the ﬁrst line of (16.4) con-
verges to (2π)−n R bf(u)e−iu·y dy as a →∞by dominated conver-
gence since Ha(u) →(2π)−n and bf ∈L1. The last line of (16.4) is
equal to
Z
bHa(y −x)f(x) dx = f ∗bHa(y),
(16.5)
using that bHa is symmetric. But by Proposition 16.6, setting δ =
a−1, we see that f ∗bHa converges to f in L1 as a →∞.
16.3
The Plancherel theorem
The last topic that we consider is the Plancherel theorem.
Theorem 16.8 Suppose f is continuous with compact support.
Then bf ∈L2 and
∥f∥2 = (2π)−n/2∥bf∥2.
(16.6)
Proof. First note that if we combine (16.4) and (16.5), take y = 0,
and use the symmetry of bHa, we obtain
Z
bf(u)Ha(u) du = f ∗bHa(0).
(16.7)
Let g(x) = f(−x), where a denotes the complex conjugate of a.
Since ab = ab,
bg(u) =
Z
eiu·xf(−x) dx =
Z
e−iu·xf(−x) dx
=
Z
eiu·xf(x) dx = bf(u).
The third equality follows by a change of variables. By (16.7) with
f replaced by f ∗g,
Z
[
f ∗g(u)Ha(u) du = f ∗g ∗bHa(0).
(16.8)
Since [
f ∗g(u) = bf(u)bg(u) = | bf(u)|2, the left hand side of (16.8)
converges by monotone convergence to (2π)−n R
| bf(u)|2 du as a →

16.4. EXERCISES
155
∞. Since f and g are continuous with compact support, then by
Exercise 15.13, f ∗g is also, and so the right hand side of (16.8)
converges to f ∗g(0) =
R
f(y)g(−y) dy =
R
|f(y)|2 dy by Proposi-
tion 16.6(2).
Remark 16.9 We can use Theorem 16.8 to deﬁne bf when f ∈L2
so that (16.6) will continue to hold. The set of continuous functions
with compact support is dense in L2 by Proposition 15.5. Given a
function f in L2, choose a sequence {fm} of continuous functions
with compact support such that fm →f in L2. Then ∥fm−fn∥2 →
0 as m, n →∞. By (16.6), { bfm} is a Cauchy sequence in L2, and
therefore converges to a function in L2, which we call bf.
Let us check that the limit does not depend on the choice of
the sequence. If {f ′
m} is another sequence of continuous functions
with compact support converging to f in L2, then {fm −f ′
m} is a
sequence of continuous functions with compact support converging
to 0 in L2. By (16.6), bfm −bf ′
m converges to 0 in L2, and therefore
c
f ′m has the same limit as bfm. Thus bf is deﬁned uniquely up to
almost everywhere equivalence. By passing to the limit in L2 on
both sides of (16.6), we see that (16.6) holds for f ∈L2.
16.4
Exercises
Exercise 16.1 Find the Fourier transform of χ[a,b] and in partic-
ular, ﬁnd the Fourier transform of χ[−n,n].
Exercise 16.2 Find a real-valued function f ∈L1 such that bf /∈
L1.
Exercise 16.3 Show that if f ∈L1 and f is everywhere strictly
positive, then | bf(y)| < bf(0) for y ̸= 0.
Exercise 16.4 If f is integrable, real-valued, and all the partial
derivatives fj = ∂f/∂xj are integrable, prove that the Fourier
transform of fj is given by bfj(u) = −iuj bf(u).

156
CHAPTER 16. FOURIER TRANSFORMS
Exercise 16.5 Let S be the class of real-valued functions f on R
such that for every k ≥0 and m ≥0, |x|m|f (k)(x)| →0 as |x| →∞,
where f (k) is the kth derivative of f when k ≥1 and f (0) = f. The
collection S is called the Schwartz class. Prove that if f ∈S, then
bf ∈S.
Exercise 16.6 The Fourier transform of a ﬁnite signed measure µ
on Rn is deﬁned by
bµ(u) =
Z
eiu·x µ(dx).
Prove that if µ and ν are two ﬁnite signed measures on Rn (with
respect to the completion of L × L, where L is the Lebesgue σ-
algebra on R) such that bµ(u) = bν(u) for all u ∈Rn, then µ = ν.
Exercise 16.7 If f is real-valued and continuously diﬀerentiable
on R, prove that
 Z
|f|2 dx
2
≤4
 Z
|xf(x)|2 dx
  Z
|f ′|2 dx

.
Exercise 16.8 Prove Heisenberg’s inequality (which is very useful
in quantum mechanics): there exists c > 0 such that if a, b ∈R
and f is in L2, then
 Z
(x−a)2|f(x)|2 dx
  Z
(u−b)2| bf(u)|2 du

≥c
 Z
|f(x)|2 dx
2
.
Find the best constant c.

Chapter 17
Riesz representation
In Chapter 4 we constructed measures on R. In this chapter we
will discuss how to construct measures on more general topological
spaces X.
If X is a topological space, let B be the Borel σ-algebra and
suppose µ is a σ-ﬁnite measure on (X, B). Throughout this chap-
ter we will restrict our attention to real-valued functions. If f is
continuous on X, let us deﬁne
L(f) =
Z
X
f dµ.
Clearly L is linear, and if f ≥0, then L(f) ≥0. The main topic
of this chapter is to prove a converse, the Riesz representation
theorem.
We need more hypotheses on X than just that it is a topological
space.
For simplicity, throughout this chapter we suppose X is
a compact metric space. In fact, with almost no changes in the
proof, we could let X be a compact Hausdorﬀspace, and with only
relatively minor changes, we could even let X be a locally compact
Hausdorﬀmetric space. See Remark 17.1. But here we stick to
compact metric spaces.
We let C(X) be the collection of continuous functions from X
to R.
Recall that the support of a function f is the closure of
{x : f(x) ̸= 0}. We write supp (f) for the support of f. If G is an
157

158
CHAPTER 17. RIESZ REPRESENTATION
open subset of X, we deﬁne FG by
FG = {f ∈C(X) : 0 ≤f ≤1, supp (f) ⊂G}.
Observe that if f ∈FG, then 0 ≤f ≤χG, but the converse
does not hold.
For example, if X = [−2, 2], G = (−1, 1), and
f(x) = (1 −x2)+, then 0 ≤f ≤χG, but the support of f, which is
[−1, 1], is not contained in G.
17.1
Partitions of unity
The reason we take our set X to be a metric space is that if K ⊂
G ⊂X, where K is compact and G is open, then there exists
f ∈FG such that f is 1 on K. If we let
f(x) =

1 −d(x, K)
δ/2
+
,
where d(x, K) = inf{d(x, y) : y ∈K} is the distance from x to K
and δ = inf{d(x, y) : x ∈K, y ∈Gc}, then this f will do the job.
Remark 17.1 If X is a compact Hausdorﬀspace instead of a com-
pact metric one, we can still ﬁnd such an f, that is, f ∈FG with
f ≥χK when K ⊂G, K is compact, and G is open. Urysohn’s
lemma is the result from topology that guarantees such an f ex-
ists. (A Hausdorﬀspace X is one where if x, y ∈X, x ̸= y, there
exist disjoint open sets Gx and Gy with x ∈Gx and y ∈Gy. An
example of a compact Hausdorﬀspace that is not a metric space
and cannot be made into a metric space is [0, 1]R with the product
topology.) See [1] for details.
We will need the following proposition.
Proposition 17.2 Suppose K is compact and K ⊂G1 ∪· · · ∪Gn,
where the Gi are open sets. There exist gi ∈FGi for i = 1, 2, . . . , n
such that Pn
i=1 gi(x) = 1 if x ∈K.
The collection {gi} is called a partition of unity on K, subordi-
nate to the cover {Gi}.
Proof. Let x ∈K. Then x will be in at least one Gi. Single points
are always compact, so there exists hx ∈FGi such that hx(x) = 1.

17.2. THE REPRESENTATION THEOREM
159
Let Nx = {y : hx(y) > 0}. Since hx is continuous, then Nx is open,
x ∈Nx, and Nx ⊂Gi.
The collection {Nx} is an open cover for the compact set K, so
there exists a ﬁnite subcover {Nx1, . . . , Nxm}. For each i, let
Fi = ∪{Nxj : Nxj ⊂Gi}.
Each Fi is closed, and since X is compact, Fi is compact. We have
Fi ⊂Gi. Let us choose fi ∈FGi such that fi is 1 on Fi.
Now deﬁne
g1 = f1,
g2 = (1 −f1)f2,
· · ·
gn = (1 −f1)(1 −f2) · · · (1 −fn−1)fn.
Clearly gi ∈FGi. Note g1 + g2 = 1 −(1 −f1)(1 −f2), and an
induction argument shows that
g1 + · · · + gn = 1 −(1 −f1)(1 −f2) · · · (1 −fn).
If x ∈K, then x ∈Nxj for some j, so x ∈Fi for some i. Then
fi(x) = 1, which implies Pn
k=1 gk(x) = 1.
17.2
The representation theorem
Let L be a linear functional mapping C(X) to R. Thus L(f + g) =
L(f) + L(g) and L(af) = aL(f) if f, g ∈C(X) and a ∈R. L is a
positive linear functional if L(f) ≥0 whenever f ≥0 on X.
Here is the Riesz representation theorem.
B is the Borel σ-
algebra on X, that is, the smallest σ-algebra that contains all the
open subsets of X.
Theorem 17.3 Let X be a compact metric space and L a positive
linear functional on C(X). Then there exists a measure µ on (X, B)
such that
L(f) =
Z
f(y) µ(dy),
f ∈C(X).
(17.1)

160
CHAPTER 17. RIESZ REPRESENTATION
We often write Lf for L(f). Since X is compact, taking f identi-
cally equal to 1 in (17.1) shows that µ is a ﬁnite measure.
Proof. If G is open, let
ℓ(G) = sup{Lf : f ∈FG}
and for E ⊂X, let
µ∗(E) = inf{ℓ(G) : E ⊂G, G open}.
Step 1 of the proof will be to show µ∗is an outer measure. Step
2 is to show that every open set is µ∗-measurable. Step 3 is to
apply Theorem 4.6 to obtain a measure µ. Step 4 establishes some
regularity of µ and Step 5 shows that (17.1) holds.
Step 1. We show µ∗is an outer measure. The only function in F∅
is the zero function, so ℓ(∅) = 0, and therefore µ∗(∅) = 0. Clearly
µ∗(A) ≤µ∗(B) if A ⊂B.
To show the countable subadditivity of µ∗, ﬁrst let G1, G2, . . .
be open sets. For any open set H we see that µ∗(H) = ℓ(H). Let
G = ∪iGi and let f be any element of FG. Let K be the support of
f. Then K is compact, {Gi} is an open cover for K, and therefore
there exists n such that K ⊂∪n
i=1Gi. Let {gi} be a partition of
unity for K subordinate to {Gi}n
i=1. Since K is the support of f,
we have f = Pn
i=1 fgi. Since gi ∈FGi and f is bounded by 1, then
fgi ∈FGi. Therefore
Lf =
n
X
i=1
L(fgi) ≤
n
X
i=1
µ∗(Gi) ≤
∞
X
i=1
µ∗(Gi).
Taking the supremum over f ∈FG,
µ∗(G) = ℓ(G) ≤
∞
X
i=1
µ∗(Gi).
If A1, A2, . . . are subsets of X, let ε > 0, and choose Gi open
such that ℓ(Gi) ≤µ∗(Gi) + ε2−i. Then
µ∗(∪∞
i=1Ai) ≤µ∗(∪∞
i=1Gi) ≤
∞
X
i=1
µ∗(Gi) ≤
∞
X
i=1
µ∗(Ai) + ε.
Since ε is arbitrary, countable subadditivity is proved, and we con-
clude that µ∗is an outer measure.

17.2. THE REPRESENTATION THEOREM
161
Step 2. We show that every open set is µ∗-measurable. Suppose G
is open and E ⊂X. It suﬃces to show
µ∗(E) ≥µ∗(E ∩G) + µ∗(E ∩Gc),
(17.2)
since the opposite inequality is true by the countable subadditivity
of µ∗.
First suppose E is open. Choose f ∈FE∩G such that
L(f) > ℓ(E ∩G) −ε/2.
Let K be the support of f.
Since Kc is open, we can choose
g ∈FE∩Kc such that L(g) > ℓ(E ∩Kc) −ε/2. Then f + g ∈FE,
and
ℓ(E) ≥L(f + g) = Lf + Lg ≥ℓ(E ∩G) + ℓ(E ∩Kc) −ε
= µ∗(E ∩G) + µ∗(E ∩Kc) −ε
≥µ∗(E ∩G) + µ∗(E ∩Gc) −ε.
Since ε is arbitrary, (17.2) holds when E is open.
If E ⊂X is not necessarily open, let ε > 0 and choose H open
such that E ⊂H and ℓ(H) ≤µ∗(E) + ε. Then
µ∗(E) + ε ≥ℓ(H) = µ∗(H) ≥µ∗(H ∩G) + µ∗(H ∩Gc)
≥µ∗(E ∩G) + µ∗(E ∩Gc).
Since ε is arbitrary, (17.2) holds.
Step 3.
Let B be the Borel σ-algebra on X.
By Theorem 4.6,
the restriction of µ∗to B, which we call µ, is a measure on B. In
particular, if G is open, µ(G) = µ∗(G) = ℓ(G).
Step 4. In this step we show that if K is compact, f ∈C(X), and
f ≥χK, then L(f) ≥µ(K). Let ε > 0 and deﬁne
G = {x : f(x) > 1 −ε},
which is open. If g ∈FG, then g ≤χG ≤f/(1−ε), so (1−ε)−1f −
g ≥0. Because L is a positive linear functional, L((1−ε)−1f −g) ≥
0, which leads to Lg ≤Lf/(1 −ε). This is true for all g ∈FG,
hence
µ(K) ≤µ(G) ≤
Lf
1 −ε.
Since ε is arbitrary, µ(K) ≤Lf.

162
CHAPTER 17. RIESZ REPRESENTATION
Step 5. We now establish (17.1). By writing f = f + −f −and
using the linearity of L, to show (17.1) for continuous functions
we may suppose f ≥0. Since X is compact, then f is bounded,
and multiplying by a constant and using linearity, we may suppose
0 ≤f ≤1.
Let n ≥1 and let Ki = {x : f(x) ≥i/n}. Since f is continuous,
each Ki is a closed set, hence compact. K0 is all of X. Deﬁne
fi(x) =





0,
x ∈Kc
i−1;
f(x) −i−1
n ,
x ∈Ki−1 −Ki;
1
n,
x ∈Ki.
Note f = Pn
i=1 fi and χKi ≤nfi ≤χKi−1. Therefore
µ(Ki)
n
≤
Z
fi dµ ≤µ(Ki−1)
n
,
and so
1
n
n
X
i=1
µ(Ki) ≤
Z
f dµ ≤1
n
n−1
X
i=0
µ(Ki).
(17.3)
Let ε > 0 and let G be an open set containing Ki−1 such that
µ(G) < µ(Ki−1) + ε. Then nfi ∈FG, so
L(nfi) ≤µ(G) ≤µ(Ki−1) + ε.
Since ε is arbitrary, L(fi) ≤µ(Ki−1)/n.
By Step 4, L(nfi) ≥
µ(Ki), and hence
1
n
n
X
i=1
µ(Ki) ≤L(f) ≤1
n
n−1
X
i=0
µ(Ki).
(17.4)
Comparing (17.3) and (17.4) we see that
L(f) −
Z
f dµ
 ≤µ(K0) −µ(Kn)
n
≤µ(X)
n
.
Since, as we saw above, µ(X) = L(1) < ∞and n is arbitrary, then
(17.1) is established.
Example 17.4 If f is continuous on [a, b], let L(f) be the Rie-
mann integral of f on the interval [a, b]. Then L is a positive linear
functional on C([a, b]). In this case, the measure whose existence is
given by the Riesz representation theorem is Lebesgue measure.

17.3. REGULARITY
163
Remark 17.5 Let X be a metric space, not necessarily compact.
A continuous function f vanishes at inﬁnity if given ε > 0 there
exists a compact set K such that |f(x)| < ε if x /∈K. C0(X) is
the usual notation for the set of continuous functions vanishing at
inﬁnity. There is a version of the Riesz representation theorem for
C0(X). See [1] for details.
17.3
Regularity
We establish the following regularity property of measures on com-
pact metric spaces.
Proposition 17.6 Suppose X is a compact measure space, B is
the Borel σ-algebra, and µ is a ﬁnite measure on the measurable
space (X, B). If E ∈B and ε > 0, there exists K ⊂E ⊂G such
that K is compact, G is open, µ(G −E) < ε, and µ(E −K) < ε.
(K and G depend on ε as well as on E.)
Proof. Let us say that a subset E ∈B is approximable if given ε >
0 there exists K ⊂E ⊂G with K compact, G open, µ(G−E) < ε,
and µ(E−F) < ε. Let H be the collection of approximable subsets.
We will show H contains all the compact sets and H is a σ-algebra,
which will prove that H = B, and thus establish the proposition.
If K is compact, let Gn = {x : d(x, K) < 1/n}. Then the Gn are
open sets decreasing to K, and if n is large enough, µ(Gn−K) < ε.
Thus every compact set is in H.
If E is in H and ε > 0, then choose K ⊂E ⊂G with K compact,
G open, µ(E−K) < ε, and µ(G−E) < ε. Then Gc ⊂Ec ⊂Kc, Gc
is closed, hence compact, Kc is open, µ(Kc −Ec) = µ(E −K) < ε,
and µ(Ec −Gc) = µ(G −E) < ε. Therefore H is closed under the
operation of taking complements.
Suppose E1, E2, . . . ∈H. For each i choose Ki compact and Gi
open such that Ki ⊂Ei ⊂Gi, µ(Gi−Ei) < ε2−i, and µ(Ei−Ki) <
ε2−(i+1). Then ∪∞
i=1Gi is open, contains ∪∞
i=1Ei, and
µ(∪iGi −∪iEi) ≤
∞
X
i=1
µ(Gi −Ei) < ε.

164
CHAPTER 17. RIESZ REPRESENTATION
We see that ∪∞
i=1Ki is contained in ∪∞
i=1Ei and similarly,
µ(∪∞
i=1Ei −∪∞
i=1Ki) ≤
∞
X
i=1
µ(Ei −Ki) < ε/2.
Since ∪n
i=1Ki increases to ∪∞
i=1Ki, we can choose n large so that
µ(∪∞
i=n+1Ki) < ε/2.
Then ∪n
i=1Ki, being the ﬁnite union of compact sets, is compact,
is contained in ∪∞
i=1Ei, and
µ(∪∞
i=1Ei −∪n
i=1Ki) < ε.
This proves that ∪iEi is in H.
Since H is closed under the operations of taking complements
and countable unions and ∩iEi = (∪iEc
i )c, then H is also closed
under the operation of taking countable intersections. Therefore H
is a σ-algebra.
A measure is called regular if
µ(E) = inf{µ(G) : G open, E ⊂G}
and
µ(E) = sup{µ(K) : K compact, K ⊂E}
for all measurable E. An immediate consequence of what we just
proved is that ﬁnite measures on (X, B) are regular when X is a
compact metric space.
17.4
Exercises
Exercise 17.1 Suppose F is a closed subset of [0, 1] and we deﬁne
L(f) =
Z 1
0
fχF dx
for real-valued continuous functions f on [0, 1]. Prove that if µ is
the measure whose existence is given by the Riesz representation
theorem, then µ(A) = m(A ∩F), where m is Lebesgue measure.

17.4. EXERCISES
165
Exercise 17.2 Suppose X is a compact metric space and µ is a
ﬁnite regular measure on (X, B), where B is the Borel σ-algebra.
Prove that if f is a real-valued measurable function and ε > 0,
there exists a closed set F such that µ(F c) < ε and the restriction
of f to F is a continuous function on F.
Exercise 17.3 Let C1([0, 1]) be the set of functions whose deriva-
tive exists and is continuous on [0, 1]. Suppose L is a linear func-
tional on C1([0, 1]) such that
|L(f)| ≤c1∥f ′∥+ c2∥f∥
for all f ∈C1([0, 1]), where c1 and c2 are positive constants and the
norm is the supremum norm. Show there exists a signed measure
µ on the Borel subsets of [0, 1] and a constant K such that
L(f) =
Z
f ′ dµ + Kf(0),
f ∈C1([0, 1]).
Exercise 17.4 Suppose X and Y are compact metric spaces and
F : X →Y is a continuous map from X onto Y . If ν is a ﬁnite
measure on the Borel sets of Y , prove that there exists a measure
µ on the Borel sets of X such that
Z
Y
f dν =
Z
X
f ◦F dµ
for all f that are continuous on Y .
Exercise 17.5 Let X be a compact metric space.
Prove that
C(X) has a countable dense subset.
Exercise 17.6 Let X be a compact metric space and let B be the
Borel σ-algebra on X. Let µn be a sequence of ﬁnite measures
on (X, B) and let µ be another ﬁnite measure on (X, B). Suppose
µn(X) →µ(X). Prove that the following are equivalent:
(1)
R
f dµn →
R
f dµ whenever f is a continuous real-valued func-
tion on X;
(2) lim supn→∞µn(F) ≤µ(F) for all closed subsets F of X;
(3) lim infn→∞µn(G) ≥µ(G) for all open subsets G of X;
(4) limn→∞µn(A) = µ(A) whenever A is a Borel subset of X such
that µ(∂A) = 0, where ∂A = A −Ao is the boundary of A.

166
CHAPTER 17. RIESZ REPRESENTATION
Exercise 17.7 Let X be a compact metric space and let B be the
Borel σ-algebra on X. Let µn be a sequence of ﬁnite measures on
(X, B) and suppose supn µn(X) < ∞.
(1) Prove that if f ∈C(X), there is a subsequence {nj} such that
R
f dµnj converges.
(2) Let A be a countable dense subset of C(X). Prove that there
is a subsequence {nj} such that
R
f dµnj converges for all f ∈A.
(3) With {nj} as in (2), prove that
R
f dµnj converges for all f ∈
C(X).
(4) Let L(f) = limnj→∞
R
f dµnj. Prove that L(f) is a positive
linear functional on C(X). Conclude that there exists a measure
µ such that
Z
f dµnj →
Z
f dµ
for all f ∈C(X).

Chapter 18
Banach spaces
Banach spaces are normed linear spaces that are complete.
We
will give the deﬁnitions, discuss the existence of bounded linear
functionals, prove the Baire category theorem, and derive some
consequences such as the uniform boundedness theorem and the
open mapping theorem.
18.1
Deﬁnitions
The deﬁnition of normed linear space X over a ﬁeld of scalars F,
where F is either the real numbers or the complex numbers, was
given in Chapter 1. Recall that a normed linear space is a metric
space if we use the metric d(x, y) = ∥x −y∥.
Deﬁnition 18.1 We deﬁne a Banach space to be a normed lin-
ear space that is complete, that is, where every Cauchy sequence
converges.
A linear map is a map L from a normed linear space X to a
normed linear space Y satisfying L(x + y) = L(x) + L(y) for all
x, y ∈X and L(αx) = αL(x) for all x ∈X and α ∈F. We will
sometimes write Lx for L(x). Since L(0) = L(0+0) = L(0)+L(0),
then L(0) = 0.
167

168
CHAPTER 18. BANACH SPACES
Deﬁnition 18.2 A linear map f from X to R is a real linear func-
tional, a linear map from X to C a complex linear functional. f is
a bounded linear functional if
∥f∥= sup{|f(x)| : x ∈X, ∥x∥≤1} < ∞.
Proposition 18.3 The following are equivalent.
(1) The linear functional f is bounded.
(2) The linear functional f is continuous.
(3) The linear functional f is continuous at 0.
Proof. |f(x) −f(y)| = |f(x −y)| ≤∥f∥|x −y|, so (1) implies (2).
That (2) implies (3) is obvious. To show (3) implies (1), if f is not
bounded, there exists a sequence xn ∈X such that ∥xn∥= 1 for
each n, but |f(xn)| →∞. If we let yn = xn/|f(xn)|, then yn →0
but |f(xn)| = 1 ̸→0, contradicting (3).
18.2
The Hahn-Banach theorem
We want to prove that there are plenty of linear functionals, but
ﬁrst we need Zorn’s lemma, which is equivalent to the axiom of
choice.
If we have a set Y with a partial order “≤,” a linear ordered
subset X ⊂Y is one such that if x, y ∈X, then either x ≤y
or y ≤x (or both) holds. A linearly ordered subset X ⊂Y has
an upper bound if there exists an element z of Y (but it is not
necessary that z ∈X) such that x ≤z for all x ∈X. An element
z of Y is maximal if z ≤y for y ∈Y implies y = z.
Here is Zorn’s lemma.
Lemma 18.4 If Y is a partially ordered set and every linearly
ordered subset of Y has an upper bound, then Y has a maximal
element.
Now we give the Hahn-Banach theorem for real linear function-
als.

18.2. THE HAHN-BANACH THEOREM
169
Theorem 18.5 If M is a subspace of a normed linear space X and
f is a bounded real linear functional on M, then f can be extended
to a bounded linear functional F on X such that ∥F∥= ∥f∥.
Saying that F is an extension of f means that the domain of F
contains the domain of f and F(x) = f(x) if x is in the domain of
f.
Proof.
If ∥f∥= 0, then we take F to be identically 0, so we
may assume that ∥f∦= 0, and then by multiplying by a constant,
that ∥f∥= 1. We ﬁrst show that we can extend f by at least one
dimension.
Choose x0 ∈X −M and let M1 be the vector space spanned
by M and x0. Thus M1 consists of all vectors of the form x + λx0,
where x ∈X and λ is real.
We have for all x, y ∈M
f(x) −f(y) = f(x −y) ≤∥x −y∥≤∥x −x0∥+ ∥y −x0∥.
Hence
f(x) −∥x −x0∥≤f(y) + ∥y −x0∥
for all x, y ∈M. Choose α ∈R such that
f(x) −∥x −x0∥≤α ≤f(y) + ∥y −x0∥
for all x, y ∈M. Deﬁne f1(x + λx0) = f(x) + λα. This is clearly
an extension of f to M1.
We need to verify that the norm of f1 is less than or equal to
1. Let x ∈M and λ ∈R. By our choice of α, f(x) −∥x −x0∥≤α,
or f(x) −α ≤∥x −x0∥, and α ≤f(x) + ∥x −x0∥, or f(x) −α ≥
−∥x −x0∥. Thus
|f(x) −α| ≤∥x −x0∥.
Replacing x by −x/λ and multiplying by |λ|, we get
|λ| | −f(x)/λ −α| ≤|λ| ∥−x/λ −x0∥,
or
|f1(x + λx0)| = |f(x) + λα| ≤∥x + λx0∥,
which is what we wanted to prove.
We now establish the existence of an extension of f to all of X.
Let F be the collection of all linear extensions F of f satisfying

170
CHAPTER 18. BANACH SPACES
∥F∥≤1. This collection is partially ordered by inclusion. That is,
if f1 is an extension of f to a subspace M1 and f2 is an extension of
f to a subspace M2, we say f1 ≤f2 if M1 ⊂M2. Since the union of
any increasing family of subspaces of X is again a subspace, then
the union of a linearly ordered subfamily of F lies in F. By Zorn’s
lemma, F has a maximal element, say, F1. By the construction
of the preceding two paragraphs, if the domain of F1 is not all of
X, we can ﬁnd an extension, which would be a contradiction to F1
being maximal. Therefore F1 is the desired extension.
To get a version for complex valued linear functionals is quite
easy. Note that if f(x) = u(x) + iv(x), then the real part of f,
namely, u = Re f, is a real valued linear functional. Also, u(ix) =
Re f(ix) = Re if(x) = −v(x), so that v(x) = −u(ix), and hence
f(x) = u(x) −iu(ix).
Theorem 18.6 If M is a subspace of a normed linear space X
and f is a bounded complex linear functional on M, then f can be
extended to a bounded linear functional F on X such that F = f.
Proof.
Assume without loss of generality that ∥f∥= 1.
Let
u = Re f. Note |u(x)| ≤|f(x)| ≤∥x∥. Now use the version of the
Hahn-Banach theorem for real linear functionals to ﬁnd a linear
functional U that is an extension of u to X such that ∥U∥≤1. Let
F(x) = U(x) −iU(ix).
It only remains to show that the norm of F is at most 1. Fix
x, and write F(x) = reiθ. Then
|F(x)| = r = e−iθF(x) = F(e−iθx).
Since this quantity is real and non-negative,
|F(x)| = U(eiθx) ≤∥U∥∥e−iθx∥≤∥x∥.
This holds for all x, so ∥F∥≤1.
As an application of the Hahn-Banach theorem, given a sub-
space M and an element x0 not in M, we can deﬁne f(x + λx0) =
λx0 for x ∈M, and then extend this linear functional to all of X.
Then f will be 0 on M but nonzero at x0.
Another application is to ﬁx x0 ̸= 0, let f(λx0) = λ∥x0∥, and
then extend f to all of X. Thus there exists a linear functional f
such that f(x0) = ∥x0∥and ∥f∥= 1.

18.3. BAIRE’S THEOREM AND CONSEQUENCES
171
18.3
Baire’s theorem and consequences
We turn now to the Baire category theorem and some of its con-
sequences. Recall that if A is a set, we use A for the closure of A
and Ao for the interior of A. A set A is dense in X if A = X and
A is nowhere dense if (A)o = ∅.
The Baire category theorem is the following. Completeness of
the metric space is crucial to the proof.
Theorem 18.7 Let X be a complete metric space.
(1) If Gn are open sets dense in X, then ∩nGn is dense in X.
(2) X cannot be written as the countable union of nowhere dense
sets.
Proof. We ﬁrst show that (1) implies (2). Suppose we can write
X as a countable union of nowhere dense sets, that is, X = ∪nEn
where (En)o = ∅. We let Fn = En, which is a closed set, and then
F o
n = ∅and X = ∪nFn. Let Gn = F c
n, which is open. Since F o
n = ∅,
then Gn = X. Starting with X = ∪nFn and taking complements,
we see that ∅= ∩nGn, a contradiction to (1).
We must prove (1). Suppose G1, G2, . . . are open and dense in
X. Let H be any nonempty open set in X. We need to show there
exists a point in H ∩(∩nGn). We will construct a certain Cauchy
sequence {xn} and the limit point, x, will be the point we seek.
Let B(z, r) = {y ∈X : d(z, y) < r}, where d is the metric. Since
G1 is dense in X, H ∩G1 is nonempty and open, and we can ﬁnd x1
and r1 such that B(x1, r1) ⊂H ∩G1 and 0 < r1 < 1. Suppose we
have chosen xn−1 and rn−1 for some n ≥2. Since Gn is dense, then
Gn ∩B(xn−1, rn−1) is open and nonempty, so there exists xn and
rn such that B(xn, rn) ⊂Gn ∩B(xn−1, rn−1) and 0 < rn < 2−n.
We continue and get a sequence xn in X. If m, n > N, then xm
and xm both lie on B(xN, rN), and so d(xm, xn) < 2rN < 2−N+1.
Therefore xn is a Cauchy sequence, and since X is complete, xn
converges to a point x ∈X.
It remains to show that x ∈H ∩(∩nGn).
Since xn lies in
B(xN, rN) if n > N, then x lies in each B(xN, rN), and hence in
each GN. Therefore x ∈∩nGn. Also,
x ∈B(xn, rn) ⊂B(xn−1, rn−1) ⊂· · · ⊂B(x1, r1) ⊂H.

172
CHAPTER 18. BANACH SPACES
Thus we have found a point x in H ∩(∩nGn).
A set A ⊂X is called meager or of the ﬁrst category
if it is
the countable union of nowhere dense sets; otherwise it is of the
second category.
An important application of the Baire category theorem is the
Banach-Steinhaus theorem, also called the uniform boundedness
theorem.
Theorem 18.8 Suppose X is a Banach space and Y is a normed
linear space. Let A be an index set and let {Lα : α ∈A} be a
collection of bounded linear maps from X into Y .
Then either
there exists a M < ∞such that ∥Lα∥≤M for all α ∈A or else
supα ∥Lαx∥= ∞for some x.
Proof.
Let ℓ(x) = supα∈A ∥Lαx∥.
Let Gn = {x : ℓ(x) > n}.
We argue that Gn is open. The map x →∥Lαx∥is a continuous
function for each α since Lα is a bounded linear functional. This
implies that for each α, the set {x : ∥Lαx∥> n} is open. Since
x ∈Gn if and only if for some α ∈A we have ∥Lαx∥> n, we
conclude Gn is the union of open sets, hence is open.
Suppose there exists N such that GN is not dense in X. Then
there exists x0 and r such that B(x0, r) ∩GN = ∅.
This can
be rephrased as saying that if ∥x −x0∥≤r, then ∥Lα(x)∥≤N
for all α ∈A.
If ∥y∥≤r, we have y = (x0 + y) −x0.
Then
∥(x0 + y) −x0∥= ∥y∥≤r, and hence ∥Lα(x0 + y)∥≤N for all α.
Also, of course, ∥x0 −x0∥= 0 ≤r, and thus ∥Lα(x0)∥≤N for all
α. We conclude that if ∥y∥≤r and α ∈A,
∥Lαy∥= ∥Lα((x0 + y) −x0)∥≤∥Lα(x0 + y)∥+ ∥Lαx0∥≤2N.
Consequently, supα ∥Lα∥≤M with M = 2N/r.
The other possibility, by the Baire category theorem, is that
every Gn is dense in X, and in this case ∩nGn is dense in X. But
ℓ(x) = ∞for every x ∈∩nGn.
The following theorem is called the open mapping theorem. It is
important that L be onto. A mapping L : X →Y is open if L(U)
is open in Y whenever U is open in X. For a measurable set A, we
let L(A) = {Lx : x ∈A}.

18.3. BAIRE’S THEOREM AND CONSEQUENCES
173
Theorem 18.9 Let X and Y be Banach spaces. A bounded linear
map L from X onto Y is open.
Proof. We need to show that if B(x, r) ⊂X, then L(B(x, r)) con-
tains a ball in Y . We will show L(B(0, r)) contains a ball centered
at 0 in Y . Then using the linearity of L, L(B(x, r)) will contain
a ball centered at Lx in Y . By linearity, to show that L(B(0, r))
contains a ball centered at 0, it suﬃces to show that L(B(0, 1))
contains a ball centered at 0 in Y .
Step 1.
We show that there exists r such that B(0, r2−n) ⊂
L(B(0, 2−n)) for each n. Since L is onto, Y = ∪∞
n=1L(B(0, n)).
The Baire category theorem tells us that at least one of the sets
L(B(0, n)) cannot be nowhere dense. Since L is linear, L(B(0, 1))
cannot be nowhere dense.
Thus there exist y0 and r such that
B(y0, 4r) ⊂L(B(0, 1)).
Pick y1 ∈L(B(0, 1)) such that ∥y1 −y0∥< 2r and let z1 ∈
B(0, 1) be such that y1 = Lz1.
Then B(y1, 2r) ⊂B(y0, 4r) ⊂
L(B(0, 1)). Thus if ∥y∥< 2r, then y + y1 ∈B(y1, 2r), and so
y = −Lz1 + (y + y1) ∈L(−z1 + B(0, 1)).
Since z1 ∈B(0, 1), then −z1 + B(0, 1) ⊂B(0, 2), hence
y ∈L(−z1 + B(0, 1)) ⊂L(B(0, 2)).
By the linearity of L, if ∥y∥< r, then y ∈L(B(0, 1)). It follows
by linearity that if ∥y∥< r2−n, then y ∈L(B(0, 2−n)). This can
be rephrased as saying that if ∥y∥< r2−n and ε > 0, then there
exists x such that ∥x∥< 2−n and ∥y −Lx∥< ε.
Step 2. Suppose ∥y∥< r/2. We will construct a sequence {xj} by
induction such that y = L(P∞
j=1 xj). By Step 1 with ε = r/4, we
can ﬁnd x1 ∈B(0, 1/2) such that ∥y −Lx1∥< r/4. Suppose we
have chosen x1, . . . , xn−1 such that
y −
n−1
X
j=1
Lxj
 < r2−n.
Let ε = r2−(n+1). By Step 1, we can ﬁnd xn such that ∥xn∥< 2−n
and
y −
n
X
j=1
Lxj
 =

 y −
n−1
X
j=1
Lxj

−Lxn
 < r2−(n+1).

174
CHAPTER 18. BANACH SPACES
We continue by induction to construct the sequence {xj}.
Let
wn = Pn
j=1 xj. Since ∥xj∥< 2−j, then wn is a Cauchy sequence.
Since X is complete, wn converges, say, to x.
But then ∥x∥<
P∞
j=1 2−j = 1, and since L is continuous, y = Lx.
That is, if
y ∈B(0, r/2), then y ∈L(B(0, 1)).
18.4
Exercises
Exercise 18.1 Find a measure space (X, A, µ), a subspace Y of
L1(µ), and a bounded linear functional f on Y with norm 1 such
that f has two distinct extensions to L1(µ) and each of the exten-
sions has norm equal to 1.
Exercise 18.2 Show that Lp([0, 1]) is separable, that is, there is a
countable dense subset, if 1 ≤p < ∞. Show that L∞([0, 1]) is not
separable.
Exercise 18.3 For k ≥1 and functions f : [0, 1] →R that are k
times diﬀerentiable, deﬁne
∥f∥Ck = ∥f∥∞+ ∥f ′∥∞+ · · · + ∥f (k)∥∞,
where f (k) is the kth derivative of f. Let Ck([0, 1]) be the collection
of k times diﬀerentiable functions f with ∥f∥Ck < ∞. Is Ck(0, 1])
complete with respect to the norm ∥· ∥Ck?
Exercise 18.4 Let α ∈(0, 1).
For f a real-valued continuous
function on [0, 1] deﬁne
∥f∥Cα = sup
x∈[0,1]
|f(x)| +
sup
x,y∈[0,1],x̸=y
|f(x) −f(y)|
|x −y|α
.
Let Cα([0, 1]) be the set of functions f with ∥f∥Cα < ∞.
Is
Cα([0, 1]) complete with respect to the norm ∥· ∥Cα?
Exercise 18.5 For positive integers n let
An =
n
f ∈L1([0, 1]) :
Z 1
0
|f(x)|2 dx ≤n
o
.
Show that each An is a closed subset of L1([0, 1]) with empty inte-
rior.

18.4. EXERCISES
175
Exercise 18.6 Suppose L is a linear functional on a normed linear
space X. Prove that L is a bounded linear functional if and only
if the set {x ∈X : L(x) = 0} is closed.
Exercise 18.7 A set A in a normed linear space is convex if
λx + (1 −λ)y ∈A
whenever x, y ∈A and λ ∈[0, 1].
(1) Prove that if A is convex, then the closure of A is convex.
(2) Prove that the open unit ball in a normed linear space is convex.
(The open unit ball is the set of x such that ∥x∥< 1.)
Exercise 18.8 The unit ball in a normed linear space X is strictly
convex
if ∥λx + (1 −λ)y∥< 1 whenever ∥f∥= ∥g∥= 1, f ̸= g,
and λ ∈(0, 1).
(1) Let (X, A, µ) be a measure space. Prove that the unit ball in
Lp(µ) is strictly convex.
(2) Prove that the unit balls in L1(µ), L∞(µ), and C(X) are not
strictly convex provided X consists of more than one point.
Exercise 18.9 Let fn be a sequence of continuous functions on R
that converge at every point. Prove there exist an interval and a
number M such that supn |fn| is bounded by M on that interval.
Exercise 18.10 Suppose ∥· ∥1 and ∥· ∥2 are two norms such that
∥x∥1 ≤∥x∥2 for all x in a vector space X, and suppose X is
complete with respect to both norms. Prove that there exists a
positive constant c such that
∥x∥2 ≤c∥x∥1
for all x ∈X.
Exercise 18.11 Suppose X and Y are Banach spaces.
(1) Let X × Y be the set of ordered pairs (x, y) with
(x1 + x2, y1 + y2) = (x1, y1) + (x2, y2)
for each x1, x2 ∈X and y1, y2 ∈Y and c(x, y) = (cx, cy) if x ∈R.
Deﬁne ∥(x, y)∥= ∥x∥+ ∥y∥. Prove that X × Y is a Banach space.
(2) Let L be a linear map from X into Y such that if xn →x in

176
CHAPTER 18. BANACH SPACES
X and Lxn →y in Y , then y = Lx. Such a map is called a closed
map. Let G be the graph of L, deﬁned by G = {(x, y) : y = Lx}.
Prove that G is a closed subset of X × Y , hence is complete.
(3) Prove that the function (x, Lx) →x is continuous, one-one,
linear, and maps G onto X.
(4) Prove the closed graph theorem, which says that if L is a linear
map from one Banach space to another that is a closed map, then
L is a continuous map.
Exercise 18.12 Let X = C1([0, 1]) (deﬁned in Exercise 18.3) and
Y = C([0, 1]). Deﬁne D : X →Y by Df = f ′. Show that D is a
closed map but not a bounded one.
Exercise 18.13 Let A be the set of real-valued continuous func-
tions on [0, 1] such that
Z 1/2
0
f(x) dx −
Z 1
1/2
f(x) dx = 1.
Prove that A is a closed convex subset of C([0, 1]), but there does
not exist f ∈A such that
∥f∥= inf
g∈A ∥g∥.
Exercise 18.14 Let An be the subset of the real-valued continu-
ous functions on [0, 1] given by
An = {f : there exists x ∈[0, 1] such that
|f(x) −f(y)| ≤n|x −y| for all y ∈[0, 1]}.
(1) Prove that An is nowhere dense in C([0, 1]).
(2) Prove that there exist functions f in C([0, 1]) which are nowhere
diﬀerentiable on [0, 1], that is, f ′(x) does not exist at any point of
[0, 1].

Chapter 19
Hilbert spaces
Hilbert spaces are complete normed linear spaces that have an inner
product. This added structure allows one to talk about orthonor-
mal sets. We will give the deﬁnitions and basic properties. As an
application we brieﬂy discuss Fourier series.
19.1
Inner products
Recall that if a is a complex number, then a represents the complex
conjugate. When a is real, a is just a itself.
Deﬁnition 19.1 Let H be a vector space where the set of scalars
F is either the real numbers or the complex numbers. H is an
inner product space if there is a map ⟨·, ·⟩from H × H to F such
that
(1) ⟨y, x⟩= ⟨x, y⟩for all x, y ∈H;
(2) ⟨x + y, z⟩= ⟨x, z⟩+ ⟨y, z⟩for all x, y, z ∈H;
(3) ⟨αx, y⟩= α⟨x, y⟩, for x, y ∈H and α ∈F;
(4) ⟨x, x⟩≥0 for all x ∈H;
(5) ⟨x, x⟩= 0 if and only if x = 0.
We deﬁne ∥x∥= ⟨x, x⟩1/2, so that ⟨x, x⟩= ∥x∥2.
From the
deﬁnitions it follows easily that ⟨0, y⟩= 0 and ⟨x, αy⟩= α⟨x, y⟩.
The following is the Cauchy-Schwarz inequality. The proof is
the same as the one usually taught in undergraduate linear algebra
177

178
CHAPTER 19. HILBERT SPACES
classes, except for some complications due to the fact that we allow
the set of scalars to be the complex numbers.
Theorem 19.2 For all x, y ∈H, we have
|⟨x, y⟩| ≤∥x∥∥y∥.
Proof. Let A = ∥x∥2, B = |⟨x, y⟩|, and C = ∥y∥2. If C = 0, then
y = 0, hence ⟨x, y⟩= 0, and the inequality holds. If B = 0, the
inequality is obvious. Therefore we will suppose that C > 0 and
B ̸= 0.
If ⟨x, y⟩= Reiθ, let α = eiθ, and then |α| = 1 and α⟨y, x⟩=
|⟨x, y⟩| = B.
Since B is real, we have that α⟨x, y⟩also equals
|⟨x, y⟩|.
We have for real r
0 ≤∥x −rαy∥2
= ⟨x −rαy, x −rαy⟩
= ⟨x, x⟩−rα⟨y, x⟩−rα⟨x, y⟩+ r2⟨y, y⟩
= ∥x∥2 −2r|⟨x, y⟩| + r2∥y∥2.
Therefore
A −2Br + Cr2 ≥0
for all real numbers r. Since we are supposing that C > 0, we may
take r = B/C, and we obtain B2 ≤AC. Taking square roots of
both sides gives the inequality we wanted.
From the Cauchy-Schwarz inequality we get the triangle in-
equality:
Proposition 19.3 For all x, y ∈H we have
∥x + y∥≤∥x∥+ ∥y∥.
Proof. We write
∥x + y∥2 = ⟨x + y, x + y⟩= ⟨x, x⟩+ ⟨x, y⟩+ ⟨y, x⟩+ ⟨y, y⟩
≤∥x∥2 + 2∥x∥∥y∥+ ∥y∥2 = (∥x∥+ ∥y∥)2,

19.1. INNER PRODUCTS
179
as desired.
The triangle inequality implies
∥x −z∥≤∥x −y∥+ ∥y −z∥.
Therefore ∥· ∥is a norm on H, and so if we deﬁne the distance
between x and y by ∥x −y∥, we have a metric space.
Deﬁnition 19.4 A Hilbert space H is an inner product space that
is complete with respect to the metric d(x, y) = ∥x −y∥.
Example 19.5 Let µ be a positive measure on a set X, let H =
L2(µ), and deﬁne
⟨f, g⟩=
Z
fg dµ.
This is easily seen to be a Hilbert space. To show the completeness
we use Theorem 15.4.
If we let µ be counting measure on the natural numbers, we
get what is known as the space ℓ2. An element of ℓ2 is a sequence
a = (a1, a2, . . .) such that P∞
n=1 |an|2 < ∞and if b = (b1, b2, . . .),
then
⟨a, b⟩=
∞
X
n=1
anbn.
We get another common Hilbert space, n-dimensional Euclidean
space, by letting µ be counting measure on {1, 2, . . . , n}.
Proposition 19.6 Let y ∈H be ﬁxed. Then the functions x →
⟨x, y⟩and x →∥x∥are continuous.
Proof. By the Cauchy-Schwarz inequality,
|⟨x, y⟩−⟨x′, y⟩| = |⟨x −x′, y⟩| ≤∥x −x′∥∥y∥,
which proves that the function x →⟨x, y⟩is continuous. By the
triangle inequality, ∥x∥≤∥x −x′∥+ ∥x′∥, or
∥x∥−∥x′∥≤∥x −x′∥.
The same holds with x and x′ reversed, so
| ∥x∥−∥x′∥| ≤∥x −x′∥,
and thus the function x →∥x∥is continuous.

180
CHAPTER 19. HILBERT SPACES
19.2
Subspaces
Deﬁnition 19.7 A subset M of a vector space is a subspace if
M is itself a vector space with respect to the same operations of
addition and scalar multiplication. A closed subspace is a subspace
that is closed relative to the metric given by ⟨·, ·⟩.
For an example of a subspace that is not closed, consider ℓ2
and let M be the collection of sequences for which all but ﬁnitely
many elements are zero.
M is clearly a subspace.
Let xn =
(1, 1
2, . . . , 1
n, 0, 0, . . .) and x = (1, 1
2, 1
3, . . .). Then each xn ∈M,
x /∈M, and we conclude M is not closed because
∥xn −x∥2 =
∞
X
j=n+1
1
j2 →0
as n →∞.
A set E ⊂H is convex if λx+(1−λx) ∈E whenever 0 ≤λ ≤1
and x, y ∈E.
Proposition 19.8 Each nonempty closed convex subset E of H
has a unique element of smallest norm.
Proof. Let δ = inf{∥x∥: x ∈E}. Since ∥x + y∥2 = ⟨x + y, x + y⟩
and similarly for ∥x −y∥2, ∥x∥2, and ∥y∥2, a simple calculation
shows that
∥x + y∥2 + ∥x −y∥2 = 2∥x∥2 + ∥y∥2.
Dividing by 4, if x, y ∈E, then
1
4∥x −y∥2 = 1
2∥x∥2 + 1
2∥y∥2 −
x + y
2

2
.
Since E is convex, if x, y ∈E, then (x + y)/2 ∈E, and we have
∥x −y∥2 ≤2∥x∥2 + 2∥y∥2 −4δ2.
(19.1)
Choose yn ∈E such that ∥yn∥→δ. Applying (19.1) with x
replaced by yn and y replaced by ym, we see that
∥yn −ym∥2 ≤2∥yn∥2 + 2∥ym∥2 −4δ2,

19.2. SUBSPACES
181
and the right hand side tends to 0 as m and n tend to inﬁnity.
Hence yn is a Cauchy sequence, and since H is complete, it con-
verges to some y ∈H. Since yn ∈E and E is closed, y ∈E. Since
the norm is a continuous function, ∥y∥= lim ∥yn∥= δ.
If y′ is another point with ∥y′∥= δ, then by (19.1) with x
replaced by y′ we have ∥y −y′∥= 0, and hence y = y′.
We say x ⊥y, or x is orthogonal to y, if ⟨x, y⟩= 0. Let x⊥,
read “x perp,” be the set of all y in X that are orthogonal to x. If
M is a subspace, let M ⊥be the set of all y that are orthogonal to
all points in M. It is clear from the linearity of the inner product
that x⊥is a subspace of H. The subspace x⊥is closed because
it is the same as the set f −1({0}), where f(x) = ⟨x, y⟩, which is
continuous by Proposition 19.6. Also, it is easy to see that M ⊥is
a subspace, and since
M ⊥= ∩x∈Mx⊥,
M ⊥is closed. We make the observation that if z ∈M ∩M ⊥, then
∥z∥2 = ⟨z, z⟩= 0,
so z = 0.
The following is sometimes called the Riesz representation theo-
rem, although usually that name is reserved for Theorem 17.3. To
motivate the theorem, consider the case where H is n-dimensional
Euclidean space.
Elements of Rn can be identiﬁed with n × 1
matrices and linear maps from Rn to Rm can be represented by
multiplication on the left by a m×n matrix A. For bounded linear
functionals on H, m = 1, so A is 1 × n, and the y of the next
theorem is the vector associated with the transpose of A.
Theorem 19.9 If L is a bounded linear functional on H, then
there exists a unique y ∈H such that Lx = ⟨x, y⟩.
Proof.
The uniqueness is easy.
If Lx = ⟨x, y⟩= ⟨x, y′⟩, then
⟨x, y −y′⟩= 0 for all x, and in particular, when x = y −y′.
We now prove existence. If Lx = 0 for all x, we take y = 0.
Otherwise, let M = {x : Lx = 0}, take z ̸= 0 in M ⊥, and let
y = αz where α = Lz/⟨z, z⟩. Notice y ∈M ⊥,
Ly =
Lz
⟨z, z⟩Lz = |Lz|2/⟨z, z⟩= ⟨y, y⟩,

182
CHAPTER 19. HILBERT SPACES
and y ̸= 0.
If x ∈H and
w = x −
Lx
⟨y, y⟩y,
then Lw = 0, so w ∈M, and hence ⟨w, y⟩= 0. Then
⟨x, y⟩= ⟨x −w, y⟩= Lx
as desired.
19.3
Orthonormal sets
A subset {uα}α∈A of H is orthonormal if ∥uα∥= 1 for all α and
⟨uα, uβ⟩= 0 whenever α, β ∈A and α ̸= β.
The Gram-Schmidt procedure from linear algebra also works in
inﬁnitely many dimensions. Suppose {xn}∞
n=1 is a linearly inde-
pendent sequence, i.e., no ﬁnite linear combination of the xn is 0.
Let u1 = x1/∥x1∥and deﬁne inductively
vN = xN −
n−1
X
i=1
⟨xN, ui⟩ui,
uN = vN/∥vN∥.
We have ⟨vN, ui⟩= 0 if i < N, so u1, . . . , uN are orthonormal.
Proposition 19.10 If {uα}α∈A is an orthonormal set, then for
each x ∈H,
X
α∈A
|⟨x, uα⟩|2 ≤∥x∥2.
(19.2)
This is called Bessel’s inequality. This inequality implies that
only ﬁnitely many of the summands on the left hand side of (19.2)
can be larger than 1/n for each n, hence only countably many of
the summands can be nonzero.
Proof. Let F be a ﬁnite subset of A. Let
y =
X
α∈F
⟨x, uα⟩uα.

19.3. ORTHONORMAL SETS
183
Then
0 ≤∥x −y∥2 = ∥x∥2 −⟨x, y⟩−⟨y, x⟩+ ∥y∥2.
Now
⟨y, x⟩=
D X
α∈F
⟨x, uα⟩uα, x
E
=
X
α∈F
⟨x, uα⟩⟨uα, x⟩=
X
α∈F
|⟨x, uα⟩|2.
Since this is real, then ⟨x, y⟩= ⟨y, x⟩. Also
∥y∥2 = ⟨y, y⟩=
D X
α∈F
⟨x, uα⟩uα,
X
β∈F
⟨x, uβ⟩uβ
E
=
X
α,β∈F
⟨x, uα⟩⟨x, uβ⟩⟨uα, uβ⟩
=
X
α∈F
|⟨x, uα⟩|2,
where we used the fact that {uα} is an orthonormal set and so
⟨uα, uβ⟩equals 0 if α ̸= β and equals 1 if α = β. Therefore
0 ≤∥y −x∥2 = ∥x∥2 −
X
α∈F
|⟨x, uα⟩|2.
Rearranging,
X
α∈F
|⟨x, uα⟩|2 ≤∥x∥2
when F is a ﬁnite subset of A. If N is an integer larger than n∥x∥2,
it is not possible that |⟨x, uα⟩|2 > 1/n for more than N of the α.
Hence |⟨x, uα⟩|2 ̸= 0 for only countably many α. Label those α’s
as α1, α2, . . .. Then
X
α∈A
|⟨x, uα⟩|2 =
∞
X
j=1
|⟨x, uαj⟩|2 = lim
J→∞
J
X
j=1
|⟨x, uαj⟩|2 ≤∥x∥2,
which is what we wanted.
Proposition 19.11 Suppose {uα}α∈A is orthonormal. Then the
following are equivalent.
(1) If ⟨x, uα⟩= 0 for each α ∈A, then x = 0.
(2) ∥x∥2 = P
α∈A |⟨x, uα⟩|2 for all x.
(3) For each x ∈H, x = P
α∈A ⟨x, uα⟩uα.

184
CHAPTER 19. HILBERT SPACES
We make a few remarks. When (1) holds, we say the orthonor-
mal set is complete. (2) is called Parseval’s identity. In (3) the
convergence is with respect to the norm of H and implies that only
countably many of the terms on the right hand side are nonzero.
Proof.
First we show (1) implies (3). Let x ∈H. By Bessel’s
inequality and the remarks following the statement of Proposition
19.10 there can be at most countably many α such that |⟨x, uα⟩|2 ̸=
0. Let α1, α2, . . . be an enumeration of those α. By Bessel’s in-
equality, the series P
i |⟨x, uαi⟩|2 converges. Using that {uα} is an
orthonormal set,

n
X
j=m
⟨x, uαj⟩uαj

2
=
n
X
j,k=m
⟨x, uαj⟩⟨x, uαk⟩⟨uαj, uαk⟩
=
n
X
j=m
|⟨x, uαj⟩|2 →0
as m, n →∞. Thus Pn
j=1 ⟨x, uαj⟩uαj is a Cauchy sequence, and
hence converges. Let z = P∞
j=1 ⟨x, uαj⟩uαj. Then ⟨z −x, uαj⟩= 0
for each αj. By (1), this implies z −x = 0.
We see that (3) implies (2) because
∥x∥2 −
n
X
j=1
|⟨x, uαj⟩|2 =
x −
n
X
j=1
⟨x, uαj⟩uαj

2
→0.
That (2) implies (1) is clear.
Example 19.12 Take H = ℓ2 = {x = (x1, x2, . . .) : P |xi|2 < ∞}
with ⟨x, y⟩= P
i xiyi. Then {ei} is a complete orthonormal sys-
tem, where ei = (0, 0, . . . , 0, 1, 0, . . .), i.e., the only nonzero coordi-
nate of ei is the ith one.
A collection of elements {eα} is a basis for H if the set of ﬁnite
linear combinations of the eα is dense in H.
Proposition 19.13 Every Hilbert space has an orthonormal basis.
This means that (3) in Proposition 19.11 holds.

19.4. FOURIER SERIES
185
Proof. If B = {uα} is orthonormal, but not a basis, let V be the
closure of the linear span of B, that is, the closure with respect to
the norm in H of the set of ﬁnite linear combinations of elements
of B. Choose x ∈V ⊥, and if we let B′ = B ∪{x/∥x∥}, then B′ is
a basis that is strictly bigger than B.
It is easy to see that the union of an increasing sequence of
orthonormal sets is an orthonormal set, and so there is a maximal
one by Zorn’s lemma. By the preceding paragraph, this maximal
orthonormal set must be a basis, for otherwise we could ﬁnd a
larger basis.
19.4
Fourier series
An interesting application of Hilbert space techniques is to Fourier
series, or equivalently, to trigonometric series.
For our Hilbert
space we take H = L2([0, 2π)) and let
un =
1
√
2π einx
for n an integer. (n can be negative.) Recall that
⟨f, g⟩=
Z 2π
0
f(x)g(x) dx
and ∥f∥2 =
R 2π
0
|f(x)|2 dx.
It is easy to see that {un} is an orthonormal set:
Z 2π
0
einxe−imx dx =
Z 2π
0
ei(n−m)x dx = 0
if n ̸= m and equals 2π if n = m.
Let F be the set of ﬁnite linear combinations of the un. We
want to show that F is a dense subset of L2([0, 2π)). The ﬁrst step
is to show that the closure of F with respect to the supremum norm
is equal to the set of continuous functions f on [0, 2π) with f(0) =
f(2π).
We will accomplish this by using the Stone-Weierstrass
theorem, Theorem 1.7.
We identify the set of continuous functions on [0, ∞) that take
the same value at 0 and 2π with the continuous functions on the

186
CHAPTER 19. HILBERT SPACES
circle. To do this, let S = {eiθ : 0 ≤θ < 2π} be the unit circle in C.
If f is continuous on [0, 2π) with f(0) = f(2π), deﬁne ef : S →C
by ef(eiθ) = f(θ). Note eun(eiθ) = einθ.
Let eF be the set of ﬁnite linear combinations of the eun. S is a
compact metric space. Since the complex conjugate of eun is eu−n,
then eF is closed under the operation of taking complex conjugates.
Since eun·eum = eun+m, it follows that F is closed under the operation
of multiplication. That it is closed under scalar multiplication and
addition is obvious. eu0 is identically equal to 1, so eF vanishes at
no point. If θ1, θ2 ∈S and θ1 ̸= θ2, then θ1 −θ2 is not an integer
multiple of 2π, so
eu1(θ1)
eu1(θ2) = ei(θ1−θ2) ̸= 1,
or eu1(θ1) ̸= eu1(θ2). Therefore F separates points. By the Stone-
Weierstrass theorem (Theorem 1.7), the closure of F with respect
to the supremum norm is equal to the set of continuous complex-
valued functions on S.
If f ∈L2([0, 2π)), then
Z
|f −fχ[1/m,2π−1/m]|2 →0
by dominated convergence as m →∞. By Corollary 15.6 any func-
tion in L2([1/m, 2π −1/m]) can be approximated in L2 by contin-
uous functions which have support in the interval [1/m, 2π −1/m].
By what we showed above, a continuous function with support in
[1/m, 2π −1/m] can be approximated uniformly on [0, 2π) by el-
ements of F. Finally, if g is continuous on [0, 2π) and gm →g
uniformly on [0, 2π), then gm →g in L2([0, 2π)) by dominated
convergence. Putting all this together proves that F is dense in
L2([0, 2π)).
It remains to show the completeness of the un. If f is orthogonal
to each un, then it is orthogonal to every ﬁnite linear combination,
that is, to every element of F. Since F is dense in L2([0, 2π)), we
can ﬁnd fn ∈F tending to f in L2. Then
∥f∥2 = |⟨f, f⟩| ≤|⟨f −fn, f⟩| + |⟨fn, f⟩|.
The second term on the right of the inequality sign is 0. The ﬁrst
term on the right of the inequality sign is bounded by ∥f −fn∥∥f∥

19.5. EXERCISES
187
by the Cauchy-Schwarz inequality, and this tends to 0 as n →
∞. Therefore ∥f∥2 = 0, or f = 0, hence the {un} are complete.
Therefore {un} is a complete orthonormal system.
Given f in L2([0, 2π)), write
cn = ⟨f, un⟩=
Z 2π
0
fun dx =
1
√
2π
Z 2π
0
f(x)e−inx dx,
the Fourier coeﬃcients of f. Parseval’s identity says that
∥f∥2 =
X
n
|cn|2.
For any f in L2 we also have
X
|n|≤N
cnun →f
as N →∞in the sense that
f −
X
|n|≤N
cnun

2 →0
as N →∞.
Using einx = cos nx + i sin nx, we have
∞
X
n=−∞
cneinx = A0 +
∞
X
n=1
Bn cos nx +
∞
X
n=1
Cn sin nx,
where A0 = c0, Bn = cn + c−n, and Cn = i(cn −c−n). Conversely,
using cos nx = (einx + e−inx)/2 and sin nx = (einx −e−inx)/2i,
A0 +
∞
X
n=1
Bn cos nx +
∞
X
n=1
Cn sin nx =
∞
X
n=−∞
cneinx
if we let c0 = A0, cn = Bn/2 + Cn/2i for n > 0 and cn = Bn/2 −
Cn/2i for n < 0. Thus results involving the un can be transferred
to results for series of sines and cosines and vice versa.
19.5
Exercises
Exercise 19.1 For f, g ∈L2([0, 1]), let ⟨f, g⟩=
R 1
0 f(x)g(x) dx.
Let H = C([0, 1]) be the functions that are continuous on [0, 1]. Is
H a Hilbert space with respect to the norm deﬁned in terms of the
inner product ⟨·, ·⟩? Justify your answer.

188
CHAPTER 19. HILBERT SPACES
Exercise 19.2 Suppose H is a Hilbert space with a countable ba-
sis. Suppose ∥xn∥→∥x∥as n →∞and ⟨xn, y⟩→⟨x, y⟩as n →∞
for every y ∈H. Prove that ∥xn −x∥→0 as n →∞.
Exercise 19.3 Prove that if M is a closed subset of a Hilbert space
H, then (M ⊥)⊥= M. Is this necessarily true if M is not closed?
If not, give a counterexample.
Exercise 19.4 Prove that if H is inﬁnite-dimensional, that is, it
has no ﬁnite basis, then the closed unit ball in H is not compact.
Exercise 19.5 Suppose an is a sequence of real numbers such that
∞
X
n=1
anbn < ∞
whenever P∞
n=1 b2
n < ∞. Prove that P∞
n=1 a2
n < ∞.
Exercise 19.6 We say xn →x weakly if ⟨xn, y⟩→⟨x, y⟩for every
y in H. Prove that if xn is a sequence in H with supn ∥xn∥≤1,
then there is a subsequence {nj} and an element x of H with
∥x∥≤1 such that xnj converges to x weakly.
Exercise 19.7 If A is a measurable subset of [0, 2π], prove that
lim
n→∞
Z
A
einx dx = 0.
This is known as the Riemann-Lebesgue lemma.
Exercise 19.8 The purpose of Exercise 13.4 was to show that in
proving the Radon-Nikodym theorem, we can assume that ν(A) ≤
µ(A) for all measurable A. Assume for the current problem that
this is the case and that µ and ν are ﬁnite measures. We use this
to give an alternative proof of the Radon-Nikodym theorem.
For f real-valued and in L2 with respect to µ, deﬁne L(f) =
R
f dν.
(1) Show that L is a bounded linear functional on L2(µ).
(2) Conclude by Theorem 19.9 that there exists a real-valued mea-
surable function g in L2(µ) such that L(f) =
R
fg dµ for all f ∈
L2(µ). Prove that dν = g dµ.

19.5. EXERCISES
189
Exercise 19.9 Suppose f is a continuous real-valued function on
R such that f(x + 1) = f(x) for every x. Let γ be an irrational
number. Prove that
lim
n→∞
1
n
n
X
j=1
f(jγ) =
Z 1
0
f(x) dx.
Exercise 19.10 If M is a closed subspace of a Hilbert space, let
x + M = {x + y : y ∈M}.
(1) Prove that x + M is a closed convex subset of H.
(2) Let Qx be the point of x+M of smallest norm and Px = x−Qx.
P is called the projection of x onto M. Prove that P and Q are
mappings of H into M and M ⊥, respectively.
(3) Prove that P and Q are linear mappings.
(4) Prove that if x ∈M, then Px = x and Qx = 0.
(5) Prove that if x ∈M ⊥, then Px = 0 and Qx = x.
(6) Prove that
∥x∥2 = ∥Px∥2 + ∥Qx∥2.

190
CHAPTER 19. HILBERT SPACES

Bibliography
[1]G.B. Folland.
Real Analysis: Modern Techniques and their
Applications, 2nd ed. Wiley, New York, 1999.
[2]H. Royden. Real Analysis, 3rd ed. Macmillan, New York, 1988.
[3]W. Rudin.
Principles of Mathematical Analysis, 3rd ed.
McGraw-Hill, New York, 1976.
[4]W. Rudin.
Real and Complex Analysis, 3rd ed. McGraw-Hill,
New York, 1987.
191

Index
Ac, 1
A −B, 1
A∆B, 1
Ai ↑, 1
Ai ↓, 1
Ao, 3
A, 3
B(x, r), 3
C, 2
Ck([0, 1]), 174
Cα([0, 1]), 174
C(X), 157
Lp, 131
Q, 2
R, 2
x ∨y, 2
x ∧y, 2
x+, 2
x−, 2
z, 2
σ(C), 8
absolutely continuous
function, 118
measures, 99
algebra, 7
almost everywhere, 39
antiderivative, 112
Baire category theorem, 171
Banach space, 167
Banach-Steinhaus theorem, 172
basis, 184
Bessel’s inequality, 182
Borel σ-algebra, 9
Borel measurable, 9
Borel sets, 9
bounded convergence
theorem, 50
bounded variation, 117
Cantor function, 28
Cantor set, 28
generalized, 29
Carath´eodory extension
theorem, 31
Carath´eodory’s theorem, 22
Cauchy sequence, 3
Cauchy-Schwarz inequality, 177
characteristic function, 41
Chebyshev’s inequality, 76
closed, 3
closed graph theorem, 176
closed map, 176
closure, 3
complete
measure space, 15
metric space, 3
orthonormal set, 184
completion, 15
conditional expectation, 105
conjugate exponent, 132
convergence
almost everywhere, 75
almost uniform, 78
in Lp, 75
192

INDEX
193
in measure, 75
convex
function, 67, 180
set, 175
strictly, 175
convolution, 136
countable additivity, 13
counting measure, 14
covering lemma, 108
decreasing, 2
strictly, 2
density, 101
derivates, 122
derivative, 107
diﬀerentiable, 107
dominated convergence
theorem, 55
Egorov’s theorem, 78
equivalence relationship, 4
equivalent measures, 104
essential inﬁmum, 134
essential supremum, 134
Fatou’s lemma, 54
ﬁnitely additive, 13
ﬁrst category, 172
Fourier series, 185
Fubini theorem, 85
Fubini-Tonelli theorem, 85
generates the σ-algebra, 9
graph, 176
Hahn decomposition, 95
Hahn-Banach theorem, 168
Hardy’s inequality, 144
Heisenberg’s inequality, 156
Hilbert space, 179
increasing, 2
strictly, 2
indeﬁnite integral, 112
inner product space, 177
integrable, 48
integration by parts, 127
interior, 3
Jensen’s inequality, 67
jointly measurable, 86
Jordan decomposition theorem,
97
Lebesgue decomposition
theorem, 103
Lebesgue measurable, 27
Lebesgue measure, 21, 27
n-dimensional, 86
Lebesgue σ-algebra, 21, 27
Lebesgue-Stieltjes measure, 21,
27
liminf, 2
limsup, 2
linear functional, 137
bounded, 137, 168
complex, 168
positive, 159
real, 168
linear map, 167
linear space, 4
Lipschitz, 128
locally integrable, 109
lower semicontinuous, 73
maximal function, 109
meager, 172
measurable, 7
measurable rectangle, 81
measurable space, 7
measure, 13
complex, 104
ﬁnite, 15
regular, 164
signed, 93
measure space, 13

194
INDEX
metric space, 3
Minkowski inequality
generalized, 143
monotone, 2
monotone class, 10
monotone class theorem, 10
monotone convergence theorem,
51
µ∗-measurable, 22
mutually singular, 96
negative set, 93
normed linear space, 4
nowhere diﬀerentiable, 176
null set, 15, 20, 93
open, 3
open ball, 3
open mapping, 172
open mapping theorem, 172
orthogonal, 181
orthonormal, 182
outer measure, 20
pairwise disjoint, 13
Parseval’s identity, 184
partial order, 4
Plancherel theorem, 154
point mass, 14
points of density, 112
positive measure, 93
positive set, 93
premeasure, 32
probability, 15
product σ-algebra, 81
projection, 189
Radon-Nikodym
theorem, 101, 188
Radon-Nikodym derivative, 101
Riemann-Lebesgue lemma, 188
Riesz representation
theorem, 159, 181
Schwartz class, 156
second category, 172
section, 81
separable, 174
separate points, 5
σ-algebra, 7
generated by a collection, 8
σ-ﬁeld, 15
σ-ﬁnite, 15
sign function, 137
signed measure, 93
signum function, 137
simple function, 41
Stone-Weierstrass theorem, 5
strictly convex, 175
subspace, 180
closed, 180
support, 3
measure, 35
symmetric diﬀerence, 1
total variation
of a function, 118
total variation measure, 97
trigonometric series, 185
uniform boundedness
theorem, 172
uniformly absolutely
continuous, 58
uniformly integrable, 58
upper semicontinuous, 73
vanish at no point, 5
vanishes at inﬁnity, 163
vector space, 4
Vitali convergence theorem, 59
Vitali cover, 120
Vitali covering lemma, 120
weak 1-1 inequality, 109
weak convergence, 188
Zorn’s lemma, 168

