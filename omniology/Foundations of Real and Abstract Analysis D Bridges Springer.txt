Foundations of Real and
Abstract Analysis
Douglas S. Bridges
Springer





Dedicated to the memory of my parents:
Douglas McDonald Bridges and Allison Hogg

Sweet Analytics, ‚Äôtis thou hast ravished me.
Faustus (Marlowe)
The stone which the builders refused is become the head stone
of the corner.
Psalm cxviii, 22.
...from so simple a beginning endless forms most beautiful and
most wonderful have been, and are being, evolved.
The origin of species (Darwin)

Preface
The core of this book, Chapters 3 through 5, presents a course on metric,
normed, and Hilbert spaces at the senior/graduate level. The motivation for
each of these chapters is the generalisation of a particular attribute of the
Euclidean space Rn: in Chapter 3, that attribute is distance; in Chapter 4,
length; and in Chapter 5, inner product. In addition to the standard topics
that, arguably, should form part of the armoury of any graduate student
in mathematics, physics, mathematical economics, theoretical statistics,...,
this part of the book contains many results and exercises that are seldom
found in texts on analysis at this level. Examples of the latter are Wong‚Äôs
Theorem (3.3.12) showing that the Lebesgue covering property is equivalent
to the uniform continuity property, and Motzkin‚Äôs result (5.2.2) that a
nonempty closed subset of Euclidean space has the unique closest point
property if and only if it is convex.
The sad reality today is that, perceiving them as one of the harder parts
of their mathematical studies, students contrive to avoid analysis courses at
almost any cost, in particular that of their own educational and technical
deprivation. Many universities have at times capitulated to the negative
demand of students for analysis courses and have seriously watered down
their expectations of students in that area. As a result, mathematics ma-
jors are graduating, sometimes with high honours, with little exposure to
anything but a rudimentary course or two on real and complex analysis,
often without even an introduction to the Lebesgue integral.
For that reason, and also in order to provide a reference for material
that is used in later chapters, I chose to begin this book with a long
chapter providing a fast‚Äìpaced course of real analysis, covering conver-

x
Preface
gence of sequences and series, continuity, diÔ¨Äerentiability, and (Riemann
and Riemann‚ÄìStieltjes) integration. The inclusion of that chapter means
that the prerequisite for the book is reduced to the usual undergraduate
sequence of courses on calculus. (One‚Äìvariable calculus would suÔ¨Éce, in
theory, but a lack of exposure to more advanced calculus courses would in-
dicate a lack of the mathematical maturity that is the hidden prerequisite
for most senior/graduate courses.)
Chapter 2 is designed to show that the subject of diÔ¨Äerentiation does
not end with the material taught in calculus courses, and to introduce the
Lebesgue integral. Starting with the Vitali Covering Theorem, the chap-
ter develops a theory of diÔ¨Äerentiation almost everywhere that underpins a
beautiful approach to the Lebesgue integral due to F. Riesz [39]. One minor
disadvantage of Riesz‚Äôs approach is that, in order to handle multivariate
integrals, it requires the theory of set‚Äìvalued derivatives, a topic suÔ¨Éciently
involved and far from my intended route through elementary analysis that
I chose to omit it altogether. The only place where this might be regarded
as a serious omission is at the end of the chapter on Hilbert space, where
I require classical vector integration to investigate the existence of weak
solutions to the Dirichlet Problem in three‚Äìdimensional Euclidean space;
since that investigation is only outlined, it seemed justiÔ¨Åable to rely only
on the reader‚Äôs presumed acquaintance with elementary vector calculus.
Certainly, one‚Äìdimensional integration is all that is needed for a sound in-
troduction to the Lp spaces of functional analysis, which appear in Chapter
4.
Chapters 1 and 2 form Part I (Real Analysis) of the book; Part II (Ab-
stract Analysis) comprises the remaining chapters and the appendices. I
have already summarised the material covered in Chapters 3 through 5.
Chapter 6, the Ô¨Ånal one, introduces functional analysis, starting with the
Hahn‚ÄìBanach Theorem and the consequent separation theorems. As well
as the common elementary applications of the Hahn‚ÄìBanach Theorem, I
have included some deeper ones in duality theory. The chapter ends with
the Baire Category Theorem, the Open Mapping Theorem, and their con-
sequences. Here most of the applications are standard, although one or two
unusual ones are included as exercises.
The book has a preliminary section dealing with background material
needed in the main text, and three appendices. The Ô¨Årst appendix de-
scribes Bishop‚Äôs construction of the real number line and the subsequent
development of its basic algebraic and order properties; the second deals
brieÔ¨Çy with axioms of choice and Zorn‚Äôs Lemma; and the third shows how
some of the material in the chapters‚Äîin particular, Minkowski‚Äôs Separation
Theorem‚Äîcan be used in the theory of Pareto optimality and competitive
equilibria in mathematical economics. Part of my motivation in writing
Appendix C was to indicate that ‚Äúmathematical economics‚Äù is a far deeper
subject than is suggested by the undergraduate texts on calculus and linear
algebra that are published under that title.

Preface
xi
I have tried, wherever possible, to present proofs so that they translate
mutatis mutandis into their counterparts in a more abstract setting, such
as that of a metric space (for results in Chapter 1) or a topological space
(for results in Chapter 3). On the other hand, some results Ô¨Årst appear
as exercises in one context before reappearing as theorems in another: one
example of this is the Uniform Continuity Theorem, which Ô¨Årst appears as1
Exercise (1.4.8: 8) in the context of a compact interval of R, and which is
proved later, as Corollary (3.3.13), in the more general setting of a compact
metric space. I hope that this procedure of double exposure will enable
students to grasp the material more Ô¨Årmly.
The text covers just over 300 pages, but the book is, in a sense, much
larger, since it contains nearly 750 exercises, which can be classiÔ¨Åed into at
least the following, not necessarily exclusive, types:
‚Ä¢ applications and extensions of the main propositions and theorems;
‚Ä¢ results that Ô¨Åll in gaps in proofs or that prepare for proofs later in
the book;
‚Ä¢ pointers towards new branches of the subject;
‚Ä¢ deep and diÔ¨Écult challenges for the very best students.
The instructor will have a wide choice of exercises to set the students as
assignments or test questions. Whichever ones are set, as with the learning
of any branch of mathematics it is essential that the student attempt as
many exercises as the constraints of time, energy, and ability permit.
It is important for the instructor/student to realise that many of the
exercises‚Äîespecially in Chapters 1 and 2‚Äîdeal with results, sometimes
major ones, that are needed later in the book. Such an exercise may not
clearly identify itself when it Ô¨Årst appears; if it is not attempted then, it
will provide revision and reinforcement of that material when the student
needs to tackle it later. It would have been unreasonable of me to have
included major results as exercises without some guidelines for the solution
of the nonroutine ones; in fact, a signiÔ¨Åcant proportion of the exercises of
all types come with some such guideline, even if only a hint.
Although Chapters 3 through 6 make numerous references to Chapters 1
and 2, I have tried to make it easy for the reader to tackle the later chapters
without ploughing through the Ô¨Årst two. In this way the book can be used
as a text for a semester course on metric, normed, and Hilbert spaces. (If
1A reference of the form Proposition (a.b.c) is to Proposition c in Section b of
Chapter a; one to Exercise (a.b.c: d) is to the dth exercise in the set of exercises
with reference number (a.b.c); and one to (B3) is to the 3rd result in Appendix
B. Within each section, displays that require reference indicators are numbered
in sequence: (1), (2), . . . . The counter for this numbering is reset at the start of
a new section.

xii
Preface
Chapter 2 is not covered, the instructor may need to omit material that
depends on familiarity with the Lebesgue integral‚Äîin particular Section 4
of Chapter 4.) Chapter 6 could be included to round oÔ¨Äan introductory
course on functional analysis.
Chapter 1 could be used on its own as a second course on real analysis
(following the typical advanced calculus course that introduces formal no-
tions of convergence and continuity); it could also be used as a Ô¨Årst course
for senior students who have not previously encountered rigorous analysis.
Chapters 1 and 2 together would make a good course on real variables, in
preparation for either the material in Chapters 3 through 5 or a course on
measure theory. The whole book could be used for a sequence of courses
starting with real analysis and culminating in an introduction to functional
analysis.
I have drawn on the resource provided by many excellent existing texts
cited in the bibliography, as well as some original papers (notably [39], in
which Riesz introduced the development of the Lebesgue integral used in
Chapter 2). My Ô¨Årst drafts were prepared using the T 3 ScientiÔ¨Åc Word
Processing System; the Ô¨Ånal version was produced by converting the drafts
to TEX and then using ScientiÔ¨Åc Word. Both T 3 and ScientiÔ¨Åc Word are
products of TCI Software Research, Inc.
I am grateful to the following people who have helped me in the
preparation of this book:
‚Äî Patrick Er, who Ô¨Årst suggested that I oÔ¨Äer a course in analysis for
economists, which mutated into the regular analysis course from
which the book eventually emerged;
‚Äî the students in my analysis classes from 1990 to 1996, who suÔ¨Äered
various slowly improving drafts;
‚Äî Cris Calude, Nick Dudley Ward, Mark Schroder, Alfred Seeger, Doru
Stefanescu, and Wang Yuchuan, who read and commented on parts
of the book;
‚Äî the wonderfully patient and cooperative staÔ¨Äat Springer‚ÄìVerlag;
‚Äî my wife and children, for their patience (in more than one sense).
It is right and proper for me here to acknowledge my unspoken debt of
gratitude to my parents. This book really began 35 years ago, when, with
their somewhat mystiÔ¨Åed support and encouragement, I was beginning my
love aÔ¨Äair with mathematics and in particular with analysis. It is sad that
they did not live to see its completion.
Douglas Bridges
28 January 1997

Contents
Preface
ix
Introduction
1
I
Real Analysis
9
1
Analysis on the Real Line
11
1.1
The Real Number Line . . . . . . . . . . . . . . . . . . . . .
11
1.2
Sequences and Series . . . . . . . . . . . . . . . . . . . . . .
20
1.3
Open and Closed Subsets of the Line . . . . . . . . . . . . .
35
1.4
Limits and Continuity . . . . . . . . . . . . . . . . . . . . .
41
1.5
Calculus . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
53
2
DiÔ¨Äerentiation and the Lebesgue Integral
79
2.1
Outer Measure and Vitali‚Äôs Covering Theorem
. . . . . . .
79
2.2
The Lebesgue Integral as an Antiderivative
. . . . . . . . .
93
2.3
Measurable Sets and Functions . . . . . . . . . . . . . . . .
110
II
Abstract Analysis
123
3
Analysis in Metric Spaces
125
3.1
Metric and Topological Spaces
. . . . . . . . . . . . . . . .
125
3.2
Continuity, Convergence, and Completeness . . . . . . . . .
135

xiv
Contents
3.3
Compactness
. . . . . . . . . . . . . . . . . . . . . . . . . .
146
3.4
Connectedness
. . . . . . . . . . . . . . . . . . . . . . . . .
158
3.5
Product Metric Spaces . . . . . . . . . . . . . . . . . . . . .
165
4
Analysis in Normed Linear Spaces
173
4.1
Normed Linear Spaces . . . . . . . . . . . . . . . . . . . . .
174
4.2
Linear Mappings and Hyperplanes
. . . . . . . . . . . . . .
182
4.3
Finite‚ÄìDimensional Normed Spaces . . . . . . . . . . . . . .
189
4.4
The Lp Spaces
. . . . . . . . . . . . . . . . . . . . . . . . .
194
4.5
Function Spaces . . . . . . . . . . . . . . . . . . . . . . . . .
204
4.6
The Theorems of Weierstrass and Stone . . . . . . . . . . .
212
4.7
Fixed Points and DiÔ¨Äerential Equations
. . . . . . . . . . .
219
5
Hilbert Spaces
233
5.1
Inner Products . . . . . . . . . . . . . . . . . . . . . . . . .
233
5.2
Orthogonality and Projections
. . . . . . . . . . . . . . . .
237
5.3
The Dual of a Hilbert Space . . . . . . . . . . . . . . . . . .
252
6
An Introduction to Functional Analysis
259
6.1
The Hahn‚ÄìBanach Theorem . . . . . . . . . . . . . . . . . .
259
6.2
Separation Theorems . . . . . . . . . . . . . . . . . . . . . .
275
6.3
Baire‚Äôs Theorem and Beyond . . . . . . . . . . . . . . . . .
279
A What Is a Real Number?
291
B Axioms of Choice and Zorn‚Äôs Lemma
299
C Pareto Optimality
303
References
311
Index
317

Introduction
We may our ends by our beginnings know.
of prudence (Sir John Denham)
What we now call analysis grew out of the calculus of Newton and Leib-
niz, was developed throughout the eighteenth century (notably by Eu-
ler), and slowly became logically sound (rigorous) through the work of
Gauss, Cauchy, Riemann, Weierstrass, Lebesgue, and many others in the
nineteenth and early twentieth centuries.
Roughly, analysis may be characterised as the study of limiting pro-
cesses within mathematics. These processes traditionally include the con-
vergence of inÔ¨Ånite sequences and series, continuity, diÔ¨Äerentiation, and
integration, on the real number line R ; but in the last 100 years analysis
has moved far from the one‚Äì or Ô¨Ånite‚Äìdimensional setting, to the extent
that it now deals largely with limiting processes in inÔ¨Ånite‚Äìdimensional
spaces equipped with structures that produce meaningful abstractions of
such notions as limit and continuous. Far from being merely the fantasti-
cal delight of mathematicians, these inÔ¨Ånite‚Äìdimensional abstractions have
served both to clarify phenomena whose true nature is often obscured by the
peculiar structure of R, and to provide foundations for quantum physics,
equilibrium economics, numerical approximation‚Äîindeed, a host of areas of
pure and applied mathematics. So important is analysis that it is no exag-
geration to describe as seriously deÔ¨Åcient any honours graduate in physics,
mathematics, or theoretical economics who has not had good exposure to
at least the fundamentals of metric, normed, and Hilbert space theory, if

2
Introduction
not the next step, in which metric notions all but disappear in the further
abstraction of topological spaces.
Like many students of mathematics, even very good ones, you may Ô¨Ånd
it hard to see the point of analysis, in which intuition often seems sacri-
Ô¨Åced to the demon of rigour. Is our intuition‚Äîalgebraic, arithmetic, and
geometric‚Äînot a suÔ¨Éciently good guide to mathematical reality in most
cases? Alas, it is not, as is illustrated by considering the diÔ¨Äerentiability of
functions. (We are assuming here that you are familiar with the derivative
from elementary calculus courses.)
When you Ô¨Årst met the derivative, you probably thought that any contin-
uous (real‚Äìvalued) function‚Äîthat is, loosely, one with an unbroken graph‚Äî
on an interval of R has a derivative at all points of its domain; in other
words, its graph has a tangent everywhere. Once you came across simple
examples, like the absolute value function x ‚Üí|x| , of functions whose
graphs are unbroken but have no tangent at some point, it would have
been natural to conjecture that if the graph were unbroken, then it had a
tangent at all but a Ô¨Ånite number of points. If you were really smart, you
might even have produced an example of a continuous function, made up
of lots of spikes, which was not diÔ¨Äerentiable at any of a sequence of points.
This is about as far as intuition can go. But, as Weierstrass showed in the
last century, and as you are invited to demonstrate in Exercise (1.5.1: 2),
there exist continuous functions on R whose derivative does not exist any-
where. Even this is not the end of the story: in a technical sense discussed
in Chapter 6, most continuous functions on R are nowhere diÔ¨Äerentiable!
Here, then, is a dramatic failure of our intuition. We could give examples of
many others, all of which highlight the need for the sort of careful analysis
that is the subject of this book.
Of course, analysis is not primarily concerned with pathological exam-
ples such as Weierstrass‚Äôs one of a continuous, nowhere diÔ¨Äerentiable func-
tion. Its main aim is to build up a body of concepts, theorems, and proofs
that describe a large part of the mathematical world (roughly, the contin-
uous part) and are well suited to the mathematical demands of physicists,
economists, statisticians, and others. The central chapters of this book,
Chapters 3 through 5, give you an introduction to some of the fundamental
concepts and results of modern analysis. The earlier chapters serve either as
a background reference for the later ones or, if you have not studied much
real analysis before, as a rapid introduction to that topic, in preparation
for the rest of the book. The Ô¨Ånal chapter introduces some of the main
themes of functional analysis, the study of continuous linear mappings on
inÔ¨Ånite‚Äìdimensional spaces.
Having understood Chapters 3 through 6, you should be in a position to
appreciate such other jewels of modern analysis as
‚Ä¢ abstract measure spaces, integration, and probability theory;

Introduction
3
‚Ä¢ approximation theory, in which complicated types of functions are
approximated by more tractable ones such as polynomials of Ô¨Åxed
maximum degree;
‚Ä¢ spectral theory of linear operators on a Hilbert space, generalising
the theory of eigenvalues and eigenvectors of matrices;
‚Ä¢ analysis of one and several complex variables;
‚Ä¢ duality theory in topological vector spaces;
‚Ä¢ Haar measure and duality on locally compact groups, and the
associated abstract generalisation of the Fourier transform;
‚Ä¢ C‚àó‚Äì and von Neumann algebras of operators on a Hilbert space,
providing rigorous foundations for quantum mechanics;
‚Ä¢ the theory of partial diÔ¨Äerential equations and the related potential
problems of classical physics;
‚Ä¢ the calculus of variations and optimisation theory.
These, however, are the subjects of other books. The time has come to
begin this one by outlining the background material needed in the main
chapters.
Throughout this book, we assume familiarity with the fundamentals of
informal set theory, as found in [20]. We use the following notation for sets
of numbers.
The set of natural numbers:
N
=
{0, 1, 2, . . .}.
The set of positive integers:
N+
=
{1, 2, 3, . . .} .
The set of integers:
Z
=
{0, ‚àí1, 1, ‚àí2, 2, . . .}.
The set of rational numbers:
Q
=

¬± m
n : m, n ‚ààN, n Ã∏= 0

.
For the purposes of this preliminary section only, we accept as given the
algebraic and order properties of the set R of real numbers, even though
these are not introduced formally until Chapter 1.
When the rule and domain describing a function f : A ‚ÜíB are known
or clearly understood, we may denote f by
x ‚Üíf(x).
Note that we use the arrow ‚Üías in ‚Äúthe function f : A ‚ÜíB ‚Äù, and the
barred arrow ‚Üías in ‚Äúthe function x ‚Üíx3 on R‚Äù.
We regard two functions with the same rule but diÔ¨Äerent domains as
diÔ¨Äerent functions. In fact, we deÔ¨Åne two functions f and g to be equal if
and only if

4
Introduction
‚Ä¢ they have the same domain and
‚Ä¢ f(x) = g(x) for each x in that domain.
Thus the function x ‚Üíx2 with domain N is not the same as the function
x ‚Üíx2 with domain R. When considering a rule that deÔ¨Ånes a function,
we usually take the domain of the function as the set of all objects x (or
at least all x of the type we wish to consider) to which the rule can be
applied. For example, if we are working in the context of R, we consider
the domain of the function x ‚Üí1/(x ‚àí1) to be the set consisting of all
real numbers other than 1.
We sometimes give explicit deÔ¨Ånitions of functions by cases. For example,
f(x) =
Ô£±
Ô£≤
Ô£≥
0
if x is rational
1
if x is irrational
deÔ¨Ånes a function f : R ‚Üí{0, 1}.
A sequence is just a special kind of function: namely, one of the form
n ‚Üíxn with domain N+; xn is then called the nth term of the sequence.
We denote by (xn)‚àû
n=1, or (x1, x2, . . .), or even just (xn), the sequence whose
nth term is xn. (Of course, n is a dummy variable here; so, for example,
(xk) is the same sequence as (xn).) If all the terms of (xn) belong to a set
X, we refer to (xn) as a sequence in X. We also apply the word ‚Äúsequence‚Äù,
and notations such as (xn)‚àû
n=ŒΩ, to a mapping n ‚Üíxn whose domain has
the form {n ‚ààZ : n ‚â•ŒΩ} for some integer ŒΩ.
A subsequence of (xn) is a sequence of the form
(xnk)‚àû
k=1 = (xn1, xn2, xn3, . . .),
where n1 < n2 < n3 < ¬∑ ¬∑ ¬∑ . More generally, if f is a one‚Äìone mapping of N+
into itself, we write (xf(n))‚àû
n=1, or even just (xf(n)), to denote the sequence
whose nth term is xf(n). This enables us, in Section 2 of Chapter 1, to
make sense of an expression like ‚àû
n=1 xf(n), denoting a rearrangement of
the inÔ¨Ånite series ‚àû
n=1 xn.
By a Ô¨Ånite sequence we mean an ordered n‚Äìtuple (x1, . . . , xn), where n
is any positive integer.
A nonempty set X is said to be countable, or to have countably many
elements, if it is the range of a sequence. Note that a nonempty Ô¨Ånite set
is countable according to this deÔ¨Ånition. An inÔ¨Ånite countable set is said
to be countably inÔ¨Ånite. We regard the empty set as being both Ô¨Ånite and
countable. A set that is not countable is said to be uncountable, and to
have uncountably many elements.
Let f, g be mappings from subsets of a set X into a set Y, where Y
is equipped with a binary operation 3. We introduce the corresponding

Introduction
5
pointwise operation 3 on f and g by setting
(f3g)(x) = f(x)3g(x)
whenever f(x) and g(x) are both deÔ¨Åned. Thus, taking Y = R, we see that
the (pointwise) sum of f and g is given by
(f + g)(x) = f(x) + g(x)
if f(x) and g(x) are both deÔ¨Åned; and that the (pointwise) quotient of f
and g is given by
(f/g)(x) = f(x)/g(x)
if f(x) and g(x) are deÔ¨Åned and g(x) Ã∏= 0. If X = N+, so that f = (xn)
and g = (yn) are sequences, then we also speak of termwise operations; for
example, the termwise product of f and g is the sequence (xnyn)‚àû
n=1.
Pointwise operations extend in the obvious ways to Ô¨Ånitely many func-
tions. In the case of a sequence (fn)‚àû
n=1 of functions with values in a normed
space (see Chapter 4), once we have introduced the notion of a series in a
normed space, we interpret ‚àû
n=1 fn in the obvious way.
By a family of elements of a set X we mean a mapping Œª ‚ÜíxŒª of a set
L, called the index set for the family, into X. We also denote such a family
by (xŒª)Œª‚ààL. A family with index set N+ is, of course, a sequence. By a
subfamily of a family (xŒª)Œª‚ààL we mean a family (xŒª)Œª‚ààJ where J ‚äÇL.
If (SŒª)Œª‚ààL is a family of sets, we write

Œª‚ààL
SŒª =

x : ‚àÉŒª ‚ààL

x ‚ààSŒª
	
,

Œª‚ààL
SŒª =

x : ‚àÄŒª ‚ààL

x ‚ààSŒª
	
,
and we call 
Œª‚ààL SŒª and 
Œª‚ààL SŒª, respectively, the union and the
intersection of the family (SŒª)Œª‚ààL.
We need some information about order relations on a set. (For fuller
information about orders in general see Chapter 1 of [9].)
A binary relation R on a set X is said to be
‚Ä¢ reÔ¨Çexive if
‚àÄa ‚ààX (aRa);
‚Ä¢ irreÔ¨Çexive if
‚àÄa ‚ààX (not(aRa)) ;
‚Ä¢ symmetric if
‚àÄa, b ‚ààX (aRb ‚áíbRa);

6
Introduction
‚Ä¢ asymmetric if
‚àÄa, b ‚ààX (aRb ‚áínot(bRa));
‚Ä¢ antisymmetric if
‚àÄa, b ‚ààX ((aRb and bRa) ‚áía = b);
‚Ä¢ transitive if
‚àÄa, b, c ‚ààX ((aRa and bRc) ‚áíaRc);
‚Ä¢ total if
‚àÄa, b ‚ààX (aRb or bRa).
We use ‚âΩto represent a reÔ¨Çexive relation, and ‚âªto represent an irreÔ¨Çex-
ive one. The notation a ‚âºb (respectively, a ‚â∫b) is equivalent to b ‚âΩa
(respectively, b ‚âªa). When dealing with the usual order relations on the
real line R, we use the standard symbols ‚â•, >, ‚â§, < instead of ‚âΩ, ‚âª, ‚âº, ‚â∫,
respectively.
A binary relation R on a set X is said to be
‚Ä¢ a preorder if it is reÔ¨Çexive and transitive;
‚Ä¢ an equivalence relation if it is a symmetric preorder (in which case X
is partitioned into disjoint equivalence classes, each equivalence class
consisting of elements that are related under R, and the set of these
equivalence classes, written X/R, is called the quotient set for R);
‚Ä¢ a partial order if it is an antisymmetric preorder;
‚Ä¢ a total order if it is a total partial order;
‚Ä¢ a strict partial order if it is asymmetric and transitive‚Äîor, equiva-
lently, if it is irreÔ¨Çexive and transitive.
If R is a partial order on X, we call the pair (X, R) ‚Äîor, when there is
no risk of confusion, just the set X itself‚Äîa partially ordered set.
With each preorder ‚âΩon X we associate a strict partial order ‚âªand an
equivalence relation ‚àºon X, deÔ¨Åned as follows.
x ‚âªy
if and only if
x ‚âΩy and not(y ‚âΩx);
x ‚àºy
if and only if
x ‚âΩy and y ‚âΩx.
If ‚âΩis a total order, we have the Law of Trichotomy:
‚àÄx, y, z ‚ààX (x ‚âªy or x = y or x ‚â∫y) .

Introduction
7
Let S be a nonempty subset of a partially ordered set (X, ‚âΩ). An element
B ‚ààX is called an upper bound, or majorant, of S (relative to ‚âΩ) if B ‚âΩx
for all x ‚ààS. If there exist upper bounds of S, then we say that S is bounded
above, or majorised. An element B ‚ààX is called a least upper bound, or
supremum, of S if the following two conditions are satisÔ¨Åed.
‚Äî B is an upper bound of S;
‚Äî if B‚Ä≤ is an upper bound of S, then B‚Ä≤ ‚âΩB.
Note that S has at most one supremum: for if B, B‚Ä≤ are suprema of S, then
B‚Ä≤ ‚âΩB ‚âΩB‚Ä≤ and so B‚Ä≤ = B, by the antisymmetry of ‚âΩ. If the supremum
of S exists, we denote it by sup S. We also denote it by
sup
1‚â§i‚â§n
xi, max S,
max
1‚â§i‚â§n xi,
or x1 ‚à®x2 ‚à®¬∑ ¬∑ ¬∑ ‚à®xn
if S = {x1, . . . , xn} is a Ô¨Ånite set, and by
sup
n‚â•1
xn or
‚àû

n=1
xn
if S = {x1, x2, . . .} is a countable set; we use similar notations without fur-
ther comment. An upper bound of S that belongs to S is called a maximum
element of S, and is then a least upper bound of S. The maximum element,
if it exists, of S is also called the largest, or greatest, element of S.
An element b ‚ààX is called a lower bound, or minorant, of S (relative to
‚âΩ) if x ‚âΩb for all x ‚ààS. If there exist lower bounds of S, then we say that
S is bounded below, or minorised. An element b ‚ààX is called a greatest
lower bound, or inÔ¨Åmum, of S if the following two conditions are satisÔ¨Åed.
‚Äî b is a lower bound of S;
‚Äî if b‚Ä≤ is a lower bound of S, then b ‚âΩb‚Ä≤.
S has at most one inÔ¨Åmum, which we denote by inf S. When describing
inÔ¨Åma, we also use such notations as
inf
1‚â§i‚â§n xi, min S,
min
1‚â§i‚â§n xi, or x1 ‚àßx2 ‚àß¬∑ ¬∑ ¬∑ ‚àßxn
if S = {x1, . . . , xn} is a Ô¨Ånite set, and
inf
n‚â•1 xn or
‚àû

n=1
xn
if S = {x1, x2, . . .} is a countable set. A lower bound of S that belongs to
S is called a minimum element of S, and is a greatest lower bound of S.

8
Introduction
The minimum element, if it exists, of S is also called the smallest, or least,
element of S.
The usual partial order ‚â•on R gives rise to important operations on
functions. If f, g are real‚Äìvalued functions, we write f ‚â•g (or g ‚â§f) to
indicate that f(x) ‚â•g(x) for all x common to the domains of f and g.
Regarding ‚à®and ‚àßas binary operations on R, we deÔ¨Åne the corresponding
functions f ‚à®g and f ‚àßg as special cases of the notion f3g previously
introduced. By extension of these ideas, if (fn)‚àû
n=1 is a sequence of real‚Äì
valued functions, then the functions ‚àû
n=1 fn and ‚àû
n=1 fn are deÔ¨Åned by
 ‚àû

n=1
fn

(x) =
‚àû

n=1
fn(x),
 ‚àû

n=1
fn

(x) =
‚àû

n=1
fn(x),
whenever the right‚Äìhand sides of these equations make sense.
Now let f be a mapping of a set X into the partially ordered set (R, ‚â•).
We say that f is bounded above on X if
f(X) = {f(x) : x ‚ààX}
is bounded above as a subset of Y. We call sup f(X), if it exists, the supre-
mum of f on X, and we denote it by sup f, supx‚ààX f(x), or, in the case
where X is a Ô¨Ånite set, max f. We also use obvious variations on these nota-
tions, such as supn‚â•1 f(n) when X = N+. We adopt analogous deÔ¨Ånitions
and notations for bounded below on X, inÔ¨Åmum of f, inf f, and min f.
Finally, let f be a mapping of a partially ordered set (X, ‚âΩ) into the
partially ordered set (R, ‚â•). We say that f is
‚Äî increasing if f(x) ‚â•f(x‚Ä≤) whenever x ‚âΩx‚Ä≤;
‚Äî strictly increasing if f(x) > f(x‚Ä≤) whenever x ‚âªx‚Ä≤;
‚Äî decreasing if f(x) ‚â§f(x‚Ä≤) whenever x ‚âΩx‚Ä≤; and
‚Äî strictly decreasing if f(x) < f(x‚Ä≤) whenever x ‚âªx‚Ä≤.
Note that we use ‚Äúincreasing‚Äù and ‚Äústrictly increasing‚Äù where some authors
would use ‚Äúnondecreasing‚Äù and ‚Äúincreasing‚Äù, respectively.

Part I
Real Analysis

1
Analysis on the Real Line
...I will a round unvarnish‚Äôd tale deliver...
othello, Act 1, Scene 3
In this chapter we provide a self‚Äìcontained development of analysis on the real
number line. We begin with an axiomatic presentation of R, from which we de-
velop the elementary properties of exponential and logarithmic functions. We
then discuss the convergence of sequences and series, paying particular atten-
tion to applications of the completeness of R. Section 3 introduces open and
closed sets, and lays the groundwork for later abstraction in the context of a
metric space. Section 4 deals with limits and continuity of real‚Äìvalued functions;
the Heine‚ÄìBorel‚ÄìLebesgue and Bolzano‚ÄìWeierstrass theorems prepare us for the
general, and extremely useful, notion of compactness, which is discussed in Chap-
ter 3. The Ô¨Ånal section deals with the diÔ¨Äerential and integral calculus, a subject
that is reviewed from a more advanced standpoint in Chapter 2.
1.1
The Real Number Line
Although it is possible to construct the real number line R from N using
elementary properties of sets and functions, in order to take us quickly
to the heart of real analysis we relegate such a construction to Appendix
A and instead present a set of axioms suÔ¨Écient to characterise R. These
axioms fall into three categories: the Ô¨Årst introduces the algebra of real
numbers; the remaining two are concerned with the ordering on R.

12
1. Analysis on the Real Line
Axiom R1.
R is a Ô¨Åeld‚Äîthat is, there exist
a binary operation (x, y) ‚Üíx + y of addition on R,
a binary operation (x, y) ‚Üíxy of multiplication1 on R,
distinguished elements 0 (zero) and 1 (one) of R, with 0 Ã∏= 1,
a unary operation x ‚Üí‚àíx (negation) on R, and
a unary operation x ‚Üíx‚àí1 of reciprocation, or inversion, on R\ {0}
such that for all x, y, z ‚ààR,
x + y = y + x,
(x + y) + z = x + (y + z) ,
0 + x = x,
x + (‚àíx) = 0,
xy = yx,
(xy) z = x (yz) ,
x(y + z) = xy + xz,
1x = x, and
xx‚àí1 = 1 if x Ã∏= 0.
Of course, we also denote x‚àí1 by 1
x or 1/x.
Axioms R2.
R is endowed with a total partial order ‚â•(greater than
or equal to), and hence an associated strict partial order > (greater than),
such that
‚Ä¢ if x ‚â•y, then x + z ‚â•y + z, and
‚Ä¢ if x ‚â•0 and y ‚â•0, then xy ‚â•0.
Axiom R3.
The least‚Äìupper‚Äìbound principle: if a nonempty subset S of
R is bounded above relative to the relation ‚â•, then it has a (unique) least
upper bound.
The elements of R are called real numbers. We say that a real number
x is
‚Ä¢ positive if x > 0,
‚Ä¢ negative if ‚àíx > 0, and
1For clarity, we sometimes write x ¬∑ y or x √ó y for the product xy.

1.1 The Real Number Line
13
‚Ä¢ nonnegative if x ‚â•0.
We denote the set of positive real numbers by R+, and the set of
nonnegative real numbers by R0+.
Many of the fundamental arithmetic and order properties of R are imme-
diate consequences of results in the elementary theories of Ô¨Åelds and partial
orders, respectively. A number of these, illustrating the interplay between
the algebra and the ordering on R, are given in the next set of exercises.2
(1.1.1) Exercises
Prove each of the following statements, where x, y, xi, yi (1 ‚â§i ‚â§n) are
real numbers.
.1
If xi ‚â•yi for each i, then n
i=1 xi ‚â•n
i=1 yi. If also xk > yk for
some k, then n
i=1 xi > n
i=1 yi.
.2
x ‚â•y if and only if x + z ‚â•y + z for all z ‚ààR ; this remains true
with each instance of ‚â•replaced by one of > .
.3
If xi ‚â•0 for each i and n
i=1 xi = 0, then x1 = x2 = ¬∑ ¬∑ ¬∑ = xn = 0.
.4
The following are equivalent: x ‚â•y, x ‚àíy ‚â•0, ‚àíy ‚â•‚àíx, 0 ‚â•y ‚àíx;
these equivalences also hold with ‚â•replaced everywhere by > .
.5
If x ‚â•y and z ‚â•0, then xz ‚â•yz.
.6
If x > 0 and y > 0, then xy > 0; if x > 0 and 0 > y, then 0 > xy; if
0 > x and 0 > y, then xy > 0; and these results hold with > replaced
everywhere by ‚â•.
.7
x2 ‚â•0, and x2 = 0 if and only if x = 0.
.8
If x > 0, then x‚àí1 > 0; and if x < 0, then x‚àí1 < 0.
.9
x ‚â•y if and only if xz ‚â•yz for all z > 0.
.10 x > y > 0 if and only if y‚àí1 > x‚àí1 > 0.
.11 max{x, y} ‚â•0 if and only if x ‚â•0 or y ‚â•0; max {x, y} > 0 if and
only if x > 0 or y > 0.
.12 min{x, y} ‚â•0 if and only if x ‚â•0 and y ‚â•0; min{x, y} > 0 if and
only if x > 0 and y > 0.
2If you are comfortable with the elementary Ô¨Åeld and order properties of R,
then you can safely omit Exercises (1.1.1) and (1.1.2).

14
1. Analysis on the Real Line
.13 The mapping
n ‚Üín1 =
Ô£±
Ô£¥
Ô£¥
Ô£≤
Ô£¥
Ô£¥
Ô£≥
0
if n = 0
1 + 1 + ¬∑ ¬∑ ¬∑ + 1



n terms
if n ‚â•1
from N into R is one‚Äìone and preserves order, addition, and
multiplication.
We use this mapping to identify N with the subset {n1 : n ‚ààN} of
R. In turn, we then identify a negative integer n with ‚àí(‚àín) 1, and
a rational number m/n with the real number mn‚àí1. We make these
identiÔ¨Åcations without further comment.
.14 If S is a nonempty majorised set of integers, then m = sup S is an
integer. (Assume the contrary and obtain integers n, n‚Ä≤ such that
m ‚àí1 < n < n‚Ä≤ < m.)
.15 There exists n ‚ààZ such that n ‚àí1 ‚â§x < n. (If x ‚â•0, apply the
least‚Äìupper‚Äìbound principle to S = {k ‚ààZ : k ‚â§x} .)
.16 If x > 0 and y ‚â•0, then there exists n ‚ààN+ such that nx > y.
(Consider {k ‚ààN : kx ‚â§y} .)
This important property is sometimes introduced as an axiom, the
Axiom of Archimedes.
.17 x > 0 if and only if there exists a positive integer n > x‚àí1.
.18 x ‚â•0 if and only if x ‚â•‚àí1/n for all positive integers n.
.19 Q is order dense in R ‚Äîthat is, if x < y, then there exists q ‚ààQ such
that x < q < y. (Reduce to the case y > 0. Choose in turn integers
n > 1/(y ‚àíx) and k ‚â•ny, and let m be the least integer such that
y ‚â§m/n. Show that x < (m ‚àí1)/n < y.)
.20 If S and T are nonempty majorised sets of positive numbers, then
sup {st : s ‚ààS, t ‚ààT} = sup S √ó sup T.
.21 The following are equivalent conditions on nonempty subsets X and
Y of R.
(i) x ‚â§y for all x ‚ààX and y ‚ààY.
(ii) There exists œÑ ‚ààR such that x ‚â§œÑ ‚â§y for all x ‚ààX and y ‚ààY.

1.1 The Real Number Line
15
Each real number x has a corresponding absolute value, deÔ¨Åned as
|x| = max {x, ‚àíx} .
(1.1.2) Exercises
Prove each of the following statements about real numbers x, y, Œµ.
.1
|x| ‚â•0, and |x| = 0 if and only if x = 0.
.2
|x| ‚â§Œµ if and only if ‚àíŒµ ‚â§x ‚â§Œµ.
.3
|x| < Œµ if and only if ‚àíŒµ < x < Œµ.
.4
x = 0 if and only if either |x| ‚â§Œµ for each Œµ > 0 or else |x| < Œµ for
each Œµ > 0.
.5
|x + y| ‚â§|x| + |y| (triangle inequality).
.6
|x ‚àíy| ‚â•||x| ‚àí|y|| .
.7
|xy| = |x| |y| .
So far we have not indicated how useful the least‚Äìupper‚Äìbound principle
is. In fact, it is not only useful, but essential: the Ô¨Åeld Q of rational numbers,
with its usual ordering >, satisÔ¨Åes all the properties listed in axioms R1
and R2, so we need something more to distinguish R from Q. Moreover,
without the least‚Äìupper‚Äìbound principle or some property equivalent to it,
we cannot even prove that a positive real number has a square root.
We now sketch how the least‚Äìupper‚Äìbound principle enables us to deÔ¨Åne
ar for any a > 0 and any r ‚ààR. When n is an integer, an is deÔ¨Åned as in
elementary algebra. So our Ô¨Årst real task is to deÔ¨Åne am/n when m and n
are nonzero integers; this we do by setting
am/n = sup {x ‚ààR : xn < am} .
(1)
Of course, we are using the least‚Äìupper‚Äìbound principle here, so we must
ensure that the set on the right‚Äìhand side of (1) is both nonempty and
bounded above. To prove that it is nonempty, we use the Axiom of
Archime‚Äì des (Exercise (1.1.1: 16)) to Ô¨Ånd a positive integer k such that
kam > 1; then knam ‚â•kam > 1, so (1/k)n < am. On the other hand, as
(1 + am)n ‚â•1 + nam > am
if n ‚â•1, and

1
1+am
n
‚â•1 ‚àínam > am
if n ‚â§‚àí1,
the set in question is bounded above (by 1 + am in the Ô¨Årst case, and by
1/ (1 + am) in the second). Hence am/n exists.
Our Ô¨Årst result enables us to prove some basic properties of am/n.

16
1. Analysis on the Real Line
(1.1.3) Lemma.
Let a > 0 and s be real numbers, and m, n positive
integers such that sn < am. Then there exists t ‚ààR such that s < t and
tn < am.
Proof.
Using Exercise (1.1.1: 16), choose a positive integer N such that
0 < N ‚àí1 < min

1, 2‚àín (1 + |s|)‚àín (am ‚àísn)

.
Writing t = s + N ‚àí1 and using the binomial theorem, we have
tn =
n

k=0
n
k

sn‚àíkN ‚àík
‚â§sn +
n

k=1
n
k

|s|n‚àík N ‚àí1
< sn + N ‚àí1
n

k=0
n
k

(1 + |s|)n‚àík
< sn + (1 + |s|)n N ‚àí1
n

k=0
n
k

= sn + 2n (1 + |s|)n N ‚àí1
< am,
as we required.
2
Taking s = 0 in this lemma, we see that am/n > 0. The lemma also
enables us to prove that

am/nn
= am.
(2)
For if

am/n	n < am, then, by Lemma (1.1.3), there exists t > am/n such
that tn < am, which contradicts the deÔ¨Ånition of am/n; on the other hand,
that same deÔ¨Ånition ensures that

am/n	n ‚â§am and hence that (2) holds.
Using (2) and methods familiar from elementary algebra courses, we can
now prove the usual laws of indices,
aras = ar+s,
(ar)s = ars,
when the indices r, s are rational.
We next extend the deÔ¨Ånition of ar to cover all r ‚ààR. To begin with,
we consider the case a > 1, when we deÔ¨Åne
ar = sup {aq : q ‚ààQ, q < r} .
(3)

1.1 The Real Number Line
17
It is left as an exercise to show that the set on the right‚Äìhand side of (3)
is nonempty and bounded above, and that if r is rational, this deÔ¨Ånition
gives ar the same value as the one given by our earlier deÔ¨Ånition. We can
now prove the laws of indices for arbitrary r, s ‚ààR. Taking the Ô¨Årst law
as an illustration, we observe that if u, v are rational numbers with u < r
and v < s, then u + v < r + s, so
auav = au+v ‚â§ar+s.
By Exercise (1.1.1: 20),
aras = sup {au : u ‚ààQ, u < r} √ó sup {av : v ‚ààQ, v < s}
= sup {auav : u, v ‚ààQ, u < r, v < s}
‚â§ar+s.
On the other hand, if q ‚ààQ and q < r+s, then we choose rational numbers
u, v with u < r, v < s, and q = u + v : to do so, we use Exercise (1.1.1: 19)
to Ô¨Ånd u ‚ààQ with q ‚àís < u < r and we then set v = q ‚àíu. We have
aq = au+v = auav ‚â§aras.
Hence
ar+s = sup {aq : q ‚ààQ, q < r + s} ‚â§aras,
and therefore aras = ar+s.
It remains to deÔ¨Åne
ar =
Ô£±
Ô£≤
Ô£≥

a‚àí1	‚àír
if 0 < a < 1
1
if a = 1
and to verify‚Äîroutinely‚Äîthat the laws of indices hold in these cases also.
(1.1.4) Exercises
.1
Let a > 1 and let r ‚ààR. Prove that {aq : q ‚ààQ, q < r} is nonempty
and bounded above. Prove also that if r = m/n for integers m, n with
n Ã∏= 0, then deÔ¨Ånitions (1) and (3) give the same value for ar.
.2
Prove that if 0 < a Ã∏= 1 and ax = 1, then x = 0. (Consider Ô¨Årst the
case where a > 1, and note that if q ‚ààQ and aq ‚â§1, then q ‚â§0.)
.3
Let a > 0 and x > y. Prove that if a > 1, then ax > ay; and that if
a < 1, then ax < ay.
.4
Prove that if a > 0, then for each x > 0 there exists a unique y ‚ààR
such that ay = x. (First take a > 1 and x > 1. Write a = 1 + t and,
by expanding (1 + t)n, compute n ‚ààN+ such that an > x. Then
consider {q ‚ààQ : aq ‚â§x}.)

18
1. Analysis on the Real Line
.5
Let f be a strictly increasing mapping of R onto R+ such that f(0) =
1 and f(x+y) = f(x)f(y). Prove that f(x) = ax, where a = f(1) > 1.
(First prove that f(q) = aq for all rational q.)
If a > 0, Exercise (1.1.4: 4) allows us to deÔ¨Åne loga, the logarithmic
function with base a, as follows. For each x > 0,
y = loga x
if and only if
ay = x.
This function has domain R+ and maps R+ onto R. From the laws of
indices we easily deduce the laws of logarithms:
loga xy = loga x + loga y,
loga(xr) = r loga x,
logb x = logb a √ó loga x, where b > 0.
Anticipating the theory of convergence of series from the next section,
we introduce the number
e =
‚àû

n=0
1
n!
and call loge the natural logarithmic function on R+. It is customary to
denote loge by either log or ln .
(1.1.5) Exercises
.1
Prove the laws of logarithms.
.2
Prove that if a > 1, then the function loga is strictly increasing; and
that if 0 < a < 1, then loga is strictly decreasing.
.3
Let a > 1, and let f be an increasing mapping of R+ into R such
that f(a) = 1 and f(xy) = f(x) + f(y). Prove that f(x) = loga x.
For convenience, we collect here the deÔ¨Ånitions of the various types of
interval in R.
The open intervals are the sets of the following forms, where a, b are real
numbers with a < b :
(a, b) = {x ‚ààR : a < x < b} ,
(a, ‚àû) = {x ‚ààR : a < x} ,
(‚àí‚àû, b) = {x ‚ààR : x < b} ,
(‚àí‚àû, ‚àû) = R.

1.1 The Real Number Line
19
The closed intervals are the sets of the following forms, where a, b are real
numbers with a ‚â§b :
[a, b] = {x ‚ààR : a ‚â§x ‚â§b} ,
[a, ‚àû) = {x ‚ààR : a ‚â§x} ,
(‚àí‚àû, b] = {x ‚ààR : x ‚â§b} .
By convention, R is regarded as both an open interval and a closed interval.
The remaining types of interval are:
half open on the left:
(a, b]
=
{x ‚ààR : a < x ‚â§b} ,
half open on the right:
[a, b)
=
{x ‚ààR : a ‚â§x < b} .
Intervals of the form [a, b], (a, b), [a, b), or (a, b], where a, b ‚ààR, are said
to be Ô¨Ånite or bounded, and to have left endpoint a, right endpoint b, and
length b ‚àía. Intervals of the remaining types are called inÔ¨Ånite and are
said to have length ‚àû. The length of any interval I is denoted by |I| . A
bounded closed interval in R is also called a compact interval.
Finally, we deÔ¨Åne the complex numbers to be the elements of the set
C = R √ó R, with the usual equality and with algebraic operations of
addition and multiplication deÔ¨Åned, respectively, by the equations
(x, y) + (x‚Ä≤, y‚Ä≤) = (x + x‚Ä≤, y + y‚Ä≤),
(x, y) √ó (x‚Ä≤, y‚Ä≤) = (xx‚Ä≤ ‚àíyy‚Ä≤, xy‚Ä≤ + x‚Ä≤y).
Then x ‚Üí(x, 0) is a one‚Äìone mapping of R onto the set C √ó {0} and is
used to identify R with that subset of C. With this identiÔ¨Åcation, we have
i2 = ‚àí1, where i is the complex number (0, 1); so the complex number
(x, y) can be identiÔ¨Åed with the expression x + iy. The real numbers x and
y are then called the real and imaginary parts of z = (x, y), respectively,
and we write
x = Re(x, y),
y = Im(x, y).
The conjugate of z is
z‚àó= (x, ‚àíy) = x ‚àíiy,
and the modulus of z is
|z| =

x2 + y2.
In the remainder of this book we assume the basic properties of the real
and complex numbers such as those found in the foregoing exercises.

20
1. Analysis on the Real Line
1.2
Sequences and Series
Although often relegated to a minor role in courses on real analysis, the
theory of convergence of sequences and series in R provides both a model
for more abstract convergence theories such as those in our later chapters,
and many important examples.
It is convenient to introduce here two useful expressions about properties
of positive integers. Let P(m, n) be a property applicable to pairs (m, n) of
positive integers. If there exists N such that P(m, n) holds for all m, n ‚â•N,
then we say that P(m, n) holds for all suÔ¨Éciently large m and n. We
interpret similarly the statement P(n) holds for all suÔ¨Éciently large n,
where P(n) is a property applicable to positive integers n. On the other
hand, if for each positive integer i there exists a positive integer j > i such
that P(j) holds, then we say that P(n) holds for inÔ¨Ånitely many values of
n.
We say that a sequence3 (an) of real numbers converges to a real number
a, called the limit of (an), if for each Œµ > 0 there exists a positive integer
N, depending on Œµ, such that |a ‚àían| ‚â§Œµ whenever n ‚â•N. Thus (an)
converges to a if and only if for each Œµ > 0 we have |a ‚àían| ‚â§Œµ for all
suÔ¨Éciently large n. In that case we write
lim
n‚Üí‚àûan = a
or
an ‚Üía as n ‚Üí‚àû,
and we also say that an tends to a as n ‚Üí‚àû.
On the other hand, we say that (an) diverges to ‚àû, and we write
an ‚Üí‚àûas n ‚Üí‚àû,
if for each K > 0 we have an > K for all suÔ¨Éciently large n. If for each
K > 0 we have an < ‚àíK for all suÔ¨Éciently large n, then we say that (an)
diverges to ‚àí‚àû, and we write
an ‚Üí‚àí‚àûas n ‚Üí‚àû.
(1.2.1) Exercises
.1
Prove that if (an) converges to both a and a‚Ä≤, then a = a‚Ä≤. (Show
that |a ‚àía‚Ä≤| < Œµ for each Œµ > 0. This exercise justiÔ¨Åes the use of the
deÔ¨Ånite article in the phrase ‚Äúthe limit of (an) ‚Äù.)
3We can extend the deÔ¨Ånitions of convergence and divergence of sequences in
the obvious ways to cover families of the form (an)n‚â•ŒΩ, where ŒΩ ‚ààZ; all that
matters is that an be deÔ¨Åned for all suÔ¨Éciently large positive integers n. This
observation makes sense of the last part of Proposition (1.2.2), where we discuss
the limit of a quotient of two sequences.

1.2 Sequences and Series
21
.2
Let c > 0. Prove that (an) converges to a if and only if for each
Œµ > 0 there exists a positive integer N, depending on Œµ, such that
|a ‚àían| ‚â§c Œµ for all n ‚â•N.
.3
Prove that if a sequence (an) converges to a limit, then it is bounded,
in the sense that there exists c > 0 such that |an| ‚â§c for all n.
.4
Let r ‚ààR, and let (an) be a convergent sequence in R such that
limn‚Üí‚àûan > r. Prove that an > r for all suÔ¨Éciently large n.
.5
Let r ‚ààR, and let (an) be a convergent sequence in R such that
an ‚â•r for all suÔ¨Éciently large n. Prove that limn‚Üí‚àûan ‚â•r.
.6
Prove that if (an) diverges to inÔ¨Ånity and (bn) converges to a limit
b ‚ààR, then the sequence (an + bn) diverges to inÔ¨Ånity.
The process of taking limits of sequences preserves the basic operations
of arithmetic.
(1.2.2) Proposition.
Let (an) and (bn) be sequences of real numbers
converging to limits a and b, respectively. Then as n ‚Üí‚àû,
an + bn ‚Üía + b,
an ‚àíbn ‚Üía ‚àíb,
anbn ‚Üíab,
max {an, bn} ‚Üímax {a, b} ,
min {an, bn} ‚Üímin {a, b} , and
|an| ‚Üí|a| .
If also b Ã∏= 0, then bn Ã∏= 0 for all suÔ¨Éciently large n, and an/bn ‚Üía/b as
n ‚Üí‚àû.
Proof.
We prove only the last statement, leaving the other cases to
Exercise (1.2.3: 1).
Assume that b Ã∏= 0. Then, by Exercise (1.2.1: 4), there exists N0 such that
|bn| > 1
2 |b| , and therefore an/bn is deÔ¨Åned, for all n ‚â•N0. Given Œµ > 0,
choose N ‚â•N0 such that |an ‚àía| < Œµ and |bn ‚àíb| < Œµ for all n ‚â•N. For
all such n we have
    
an
bn
‚àía
b
    = |ban ‚àíabn|
|bn| |b|
‚â§|b(an ‚àía) + a(b ‚àíbn)|
1
2 |b|2
‚â§2 |b|‚àí2 (|b| |an ‚àía| + |a| |b ‚àíbn|)
‚â§2 |b|‚àí2 (|a| + |b|) Œµ.

22
1. Analysis on the Real Line
The result now follows from Exercise (1.2.1: 2).
2
(1.2.3) Exercises
.1
Prove the remaining parts of Proposition (1.2.2).
.2
Prove that if k ‚â•2 and ŒΩ ‚â•1 are integers, then

1 + 1
k
	k‚àí1 > 3
2 and

1 + 1
k
	ŒΩ(k‚àí1) > ŒΩ.
Hence prove that if 0 ‚â§|r| < 1, then rn ‚Üí0 as n ‚Üí‚àû. (Given
Œµ > 0, Ô¨Årst choose ŒΩ such that 1/ŒΩ < Œµ. Then choose k such that
|r|‚àí1 > 1 + k‚àí1.)
.3
Prove that if r > 1, then rn ‚Üí‚àûas n ‚Üí‚àû.
.4
Prove that if a > 1, then loga n ‚Üí‚àûas n ‚Üí‚àû.
.5
Prove that if r
= limn‚Üí‚àûan, then r
= limk‚Üí‚àûank for any
subsequence (ank)‚àû
k=1 of (an).
.6
Let (an) be a sequence of real numbers such that the subsequences
(a2n)‚àû
n=1 and (a2n+1)‚àû
n=1 both converge to the limit l. Prove that (an)
converges to l.
.7
Let (an) be a sequence in R. Prove that if the three subsequences
(a2n), (a2n+1), and (a3n) are convergent, then so is (an).
.8
Give an example of a sequence (an) of real numbers with the following
properties.
(i) (an) is not convergent;
(ii) for each k ‚â•2 the subsequence (akn)‚àû
n=1 is convergent.
(Split your deÔ¨Ånition of an into two cases‚Äîone when n is prime, the
other when n is composite.)
When we apply notions such as bounded above, supremum, and inÔ¨Åmum
to a sequence (sn) of real numbers, we are really applying them to the set
{sn : n ‚â•1} of terms of the sequence. Thus the supremum (respectively,
inÔ¨Åmum) of a majorised (respectively, minorised) sequence (sn) is denoted
by supn‚â•1 sn, or just sup sn (respectively, infn‚â•1 sn, or just inf sn).
The next result, known as the monotone sequence principle, is a powerful
tool for proving the existence of limits.
(1.2.4) Proposition.
An increasing majorised sequence of real numbers
converges to its least upper bound; a decreasing minorised sequence of real
numbers converges to its greatest lower bound.

1.2 Sequences and Series
23
Proof.
Let (sn) be an increasing majorised sequence of real numbers, and
s its least upper bound. For each Œµ > 0, since s ‚àíŒµ is not an upper bound
of (sn), there exists N such that sN > s ‚àíŒµ. But (sn) is both increasing
and bounded above by s; so for all n ‚â•N we have s ‚àíŒµ < sn ‚â§s and
therefore |s ‚àísn| < Œµ. Since Œµ > 0 is arbitrary, it follows that sn ‚Üís as
n ‚Üí‚àû.
The case of a decreasing minorised sequence is left as an exercise.
2
(1.2.5) Exercises
.1
Prove the second part of the last proposition in two ways.
.2
Prove that an increasing sequence of nonnegative real numbers
diverges to inÔ¨Ånity if and only if it is not bounded above.
.3
Let a > 1 and x > 0. Prove that there exists an integer m such
that am ‚â§x < am+1. (First take x ‚â•1, and consider the sequence
(an)‚àû
n=0.)
.4
Discuss the convergence of the sequence (an) deÔ¨Åned by an+1 =
‚àöran, where a1 and r are positive numbers.
.5
Prove that if 0 < a and k ‚ààN, then limn‚Üí‚àû
n+k‚àöa = 1. (First
consider the case where k = 0 and 0 < a < 1. Apply the monotone
sequence principle to show that the sequence ( n‚àöa)‚àû
n=1 converges to
a limit l. By considering the subsequence ( 2n‚àöa) , show that
‚àö
l = l.)
.6
Prove that if (an) is a sequence of positive numbers such that
l = lim
n‚Üí‚àû
an+1
an
exists, then limn‚Üí‚àû
n‚àöan = l. By considering the sequence
1, a, ab, a2b, a2b2, a3b2, a3b3, . . . ,
where a, b are distinct positive numbers, show that the converse is
false.
.7
Prove that if n
‚â•
2, then (n + 1)n
‚â§
nn+1. Use this to
show that l = limn‚Üí‚àû
n‚àön exists. By considering the subsequence
 2n‚àö
2n
	‚àû
n=1 , prove that l = 1. Hence show that if a > 1, then
limn‚Üí‚àû

n‚àí1 loga n
	
= 0.
.8
Prove that the sequence

1 + n‚àí1	n	‚àû
n=1 is convergent. (An interest-
ing proof of this result, based on the well‚Äìknown inequality involving
arithmetic and geometric means, is found in [32].)

24
1. Analysis on the Real Line
.9
Let (an) be a sequence of real numbers. If (an) is bounded above,
then its upper limit, or limit superior, is deÔ¨Åned to be
lim sup an = inf
n‚â•1 sup{an, an+1, an+2, . . .}
if the inÔ¨Åmum on the right exists. Prove that a real number s equals
lim sup an if and only if for each Œµ > 0,
‚Äî an < s + Œµ for all suÔ¨Éciently large n, and
‚Äî an > s ‚àíŒµ for inÔ¨Ånitely many values of n.
Prove also that
lim sup an = lim
n‚Üí‚àûsup{an, an+1, an+2, . . .}.
.10 If (an) is bounded below, then its lower limit, or limit inferior, is
deÔ¨Åned to be
lim inf an = sup
n‚â•1
inf{an, an+1, an+2, . . .}
if the supremum on the right exists. Establish necessary and suÔ¨Écient
conditions for a real number l to equal lim inf an.
.11 Prove that an ‚Üía ‚ààR as n ‚Üí‚àûif and only if
lim inf an = a = lim sup an.
A sequence (Sn)‚àû
n=1 of subsets of R is said to be nested, or descending,
if S1 ‚äÉS2 ‚äÉS3 ‚äÉ¬∑ ¬∑ ¬∑ . We make good use of the following nested intervals
principle.
(1.2.6) Proposition.
The intersection of a nested sequence of closed
intervals in R is nonempty.
Proof.
Let ([an, bn]) be a nested sequence of closed intervals in R. Then
a1 ‚â§an ‚â§an+1 ‚â§bn+1 ‚â§bn ‚â§b1
(1)
for each n. By Proposition (1.2.4), (an) converges to its least upper bound
a, and (bn) converges to its greatest lower bound b. It follows from the
inequalities (1) and Exercise (1.2.1: 5) that a ‚â§b. So for each n, an ‚â§a ‚â§
b ‚â§bn and therefore a ‚àà[an, bn].
2
The following elementary lemma leads to simple proofs of several
important results in analysis.
(1.2.7) Lemma.
If (an) is a sequence of real numbers, then at least one
of the following holds.

1.2 Sequences and Series
25
(i) (an) has a constant subsequence;
(ii) (an) has a strictly increasing subsequence;
(iii) (an) has a strictly decreasing subsequence.
Proof.
Suppose that (an) contains no constant subsequence, and con-
sider the set
S =

n ‚ààN+ : ‚àÄk ‚â•n (an ‚â•ak)

.
If S is bounded, then there exists N such that
‚àÄn ‚â•N ‚àÉk > n (ak > an) ,
and a simple inductive construction produces positive integers N ‚â§n1 <
n2 < ¬∑ ¬∑ ¬∑ such that ank+1 > ank for each k. If, on the other hand, S is
unbounded, then we can compute n1 < n2 < ¬∑ ¬∑ ¬∑ such that ank ‚â•ank+1 for
each k. In that case, since (ank)‚àû
k=1 contains no constant subsequence, for
each k there exists j > k such that ank > anj ; it is now straightforward to
construct a strictly decreasing subsequence of (ank).
2
(1.2.8) Corollary.
A bounded sequence of real numbers has a convergent
subsequence.
Proof.
This follows from Lemma (1.2.7) and the monotone sequence
principle.
2
A sequence (an) of real numbers is called a Cauchy sequence if for each
Œµ > 0 there exists a positive integer N, depending on Œµ, such that |am‚àían| ‚â§
Œµ for all m, n ‚â•N.
(1.2.9) Exercises
.1
Prove that a convergent sequence of real numbers is a Cauchy
sequence.
.2
Prove that a Cauchy sequence is bounded.
.3
Prove that if a Cauchy sequence (an) has a subsequence that
converges to a limit a ‚ààR, then (an) converges to a.
.4
Let (an) be a bounded sequence each of whose convergent subse-
quences converges to the same limit. Prove that (an) converges to
that limit. (cf. Exercises (1.2.3: 6 and 7). By Corollary (1.2.8), there
is a subsequence (ank) that converges to a limit l. Suppose that (an)
does not converge to l, and derive a contradiction.)

26
1. Analysis on the Real Line
One of the most important results in convergence theory says that not
only does a Cauchy sequence of real numbers appear to converge, in that
its terms get closer and closer to each other as their indices increase, but
it actually does converge.
A subset S of R is said to be complete if each Cauchy sequence in S
converges to a limit that belongs to S.
(1.2.10) Theorem.
R is complete.
Proof.
Let (an) be a Cauchy sequence in R. Then (an) is bounded,
by Exercise (1.2.9: 2). It follows from Corollary (1.2.8) that (an) has a
convergent subsequence; so (an) converges, by Exercise (1.2.9: 3). 2
(1.2.11) Exercises
.1
Find an alternative proof of the completeness of R. (Given a Cauchy
sequence (an) in R, consider lim inf an.)
.2
Show that if, in the system of axioms for R, the least‚Äìupper‚Äì
bound principle is replaced by the Axiom of Archimedes (Exercise
(1.1.1: 16)), then the nested intervals principle is equivalent to the
completeness of R. Can you spot where you have used the Axiom of
Archimedes?
.3
Under the conditions of the preceding exercise, show that the least‚Äì
upper‚Äìbound principle follows from the completeness of R. (Assum-
ing that R is complete, consider a nonempty majorised subset S of
R. Choose s1 ‚ààS and b1 ‚ààB, where B is the set of upper bounds
of S. Construct a sequence (sn) in S and a sequence (bn) in B such
that
sn ‚â§sn+1 ‚â§bn+1 ‚â§bn
and
0 ‚â§bn+1 ‚àísn+1 ‚â§1
2(bn ‚àísn).
Prove that 0 ‚â§bn ‚àíbm ‚â§2‚àín+2(b1 ‚àís1) whenever m ‚â•n, that (sn)
and (bn) converge to the same limit b, and that b = sup S.)
.4
Prove Cantor‚Äôs Theorem: if (an) is a sequence of real numbers, then
in any closed interval of R with positive length there exists a real
number x such that x Ã∏= an for each n. (For each x ‚ààR and each
nonempty S ‚äÇR, deÔ¨Åne the distance from x to S to be the real
number
œÅ(x, S) = inf{|x ‚àís| : s ‚ààS}.
First prove the following lemma. If I = [a, b] is a closed interval
with positive length, and J1, J2, J3 are the left, middle, and right
closed thirds of I, then for each real number x either œÅ(x, J1) > 0

1.2 Sequences and Series
27
or œÅ(x, J3) > 0. Use this lemma to construct an appropriate nested
sequence of closed intervals.
This argument is a reÔ¨Åned version of the ‚Äúdiagonal argument‚Äù Ô¨Årst
used by Cantor. An interesting analysis of Cantor‚Äôs proof, and of the
misinterpretation of that proof over the years, is found in [19].)
.5
Prove that R\Q is order dense in R.
The study of inÔ¨Ånite series, a major part of analysis in the eighteenth
and nineteenth centuries (see [27]), still provides interesting illustrations of
the completeness of R.
Let (an)‚àû
n=1 be a sequence of real numbers. The real number
sk =
k

n=1
an
is called the kth partial sum of the series ‚àû
n=1 an. Formally, we deÔ¨Åne
the series ‚àû
n=1 an with nth term an to be the sequence (s1, s2, ...) of its
partial sums. The sum of that series is the limit s of the sequence (sn), if
that limit exists, in which case we say that the series is convergent, or that
it converges to s, and we write
‚àû

n=1
an = s.
We use analogous notations and deÔ¨Ånitions for the series associated with
a family (an)‚àû
n=ŒΩ of real numbers indexed by {n ‚ààZ : n ‚â•ŒΩ} , where ŒΩ is
an integer, and for the series ‚àû
n=‚àí‚àûan associated with a family (an)n‚ààZ
indexed by Z. We commonly write  an for the series ‚àû
n=ŒΩ an, when it
is clear that the indexing of the terms of the series starts with ŒΩ.
The completeness of R is used in the justiÔ¨Åcation of various tests for the
convergence of inÔ¨Ånite series. These tests are useful because they enable us
to prove certain series convergent without Ô¨Ånding explicit values for their
sums. For example, a number of convergence tests easily show that the
series ‚àû
n=1 n‚àí2 is convergent; but it is considerably harder to show that
the sum of this series is actually œÄ2/6 (Exercise (5.2.12: 7); see also [31]).
We begin with the comparison test.
(1.2.12) Proposition.
If ‚àû
n=1 bn is a convergent series of nonnegative
terms, and if 0 ‚â§an ‚â§bn for each n, then ‚àû
n=1 an converges.
Proof.
Let b be the sum of the series ‚àû
n=1 bn. Then for each N we have
N

n=1
an ‚â§
N+1

n=1
an ‚â§
N+1

n=1
bn ‚â§b,

28
1. Analysis on the Real Line
so the partial sums of ‚àû
n=1 an form an increasing majorised sequence. It
follows from the monotone sequence principle that ‚àû
n=1 an converges.
2
(1.2.13) Proposition.
If (an) is a decreasing sequence of positive num-
bers converging to 0, then the alternating series ‚àû
n=1(‚àí1)n+1an converges
(Leibniz‚Äôs alternating series test).
Proof.
For each k let
sk =
k

n=1
(‚àí1)n+1an.
Then
s2k+2 ‚àís2k = a2k+1 ‚àía2k+2 ‚â•0
and
a1 ‚àís2k = (a2 ‚àía3) + ... + (a2k‚àí2 ‚àía2k‚àí1) + a2k ‚â•0.
So the sequence (s2k)‚àû
k=1 is increasing and bounded above; whence, by the
monotone sequence principle, it converges to its least upper bound s. Now,
|s ‚àís2m+1| = |s ‚àís2m ‚àía2m+1| ‚â§|s ‚àís2m| + a2m+1.
Also, both |s ‚àís2m| and a2m+1 converge to 0 as m ‚Üí‚àû. It follows that if
Œµ > 0, then |s ‚àís2m| < Œµ and |s ‚àís2m+1| < Œµ for all suÔ¨Éciently large m.
Hence ‚àû
n=1(‚àí1)n+1an converges to s, by Exercise (1.2.3: 6).
2
(1.2.14) Exercises
.1
Prove that if the series  an converges, then limn‚Üí‚àûan = 0. By
considering ‚àû
n=1 1/‚àön, or otherwise, show that the converse is false.
.2
Prove the comparison test using the completeness of R, instead of
the least‚Äìupper‚Äìbound principle.
.3
A series of nonnegative terms is said to diverge if the corresponding
sequence (sn) of partial sums diverges to inÔ¨Ånity. Prove the limit
comparison test: If (an) and (bn) are sequences of positive numbers
such that
lim
n‚Üí‚àû
an
bn
= l > 0,
then either  an and  bn both converge or else they both diverge.
.4
Prove that if |r| < 1, then the geometric series ‚àû
n=0 rn converges
and has sum 1/ (1 ‚àír) . What happens to the series if |r| > 1?
.5
Let b ‚â•2 be an integer, and x ‚àà[0, 1]. Show that there exists a
sequence (an) of integers such that

1.2 Sequences and Series
29
(i) 0 ‚â§an < b for each n, and
(ii) x = ‚àû
n=1 anb‚àín.
Show that this sequence (an) is uniquely determined by x unless there
exist k, n ‚ààN such that x = kb‚àín, in which case there are exactly
two such sequences.
Conversely, show that if (an) is a sequence of integers satisfying
(i), then ‚àû
n=1 anb‚àín converges to a sum x in [0, 1]. (The series
‚àû
n=1 anb‚àín is called the b‚Äìary expansion of x, or the expansion of x
relative to the base b. If b = 2, the series is the binary expansion of
x, and if b = 10, it is the decimal expansion.)
.6
Prove that
(i) ‚àû
n=1 1/np is divergent if p ‚â§1;
(ii) ‚àû
n=1(‚àí1)n/n is convergent.
(For (i), Ô¨Årst prove the divergence of ‚àû
n=1 1/n by considering the
partial sums 2N
n=1 1/n for N = 1, 2, . . . .)
.7
Prove that the series
1
9 + 1
19 + 1
29 + ¬∑ ¬∑ ¬∑ + 1
89 + 1
90 + 1
91 + ¬∑ ¬∑ ¬∑ + 1
99 +
1
109 +
1
119 + ¬∑ ¬∑ ¬∑ ,
where each term contains the digit 9, diverges; and that the series
1 + 1
2 + 1
3 + ¬∑ ¬∑ ¬∑ + 1
8 + 1
10 + ¬∑ ¬∑ ¬∑ + 1
18 + 1
20 + ¬∑ ¬∑ ¬∑ ,
where no term contains the digit 9, converges. (Thus the divergent
series ‚àû
n=1 1/n can be turned into a convergent one by weeding out
all the terms that contain the digit 9. For a discussion of this and
related matters, see [3].)
.8
Prove that if p ‚â•2, then the series ‚àû
n=1 1/np is convergent.
.9
Prove d‚ÄôAlembert‚Äôs ratio test: let  an be a series of positive terms
such that
l = lim
n‚Üí‚àû
an+1
an
exists; then  an converges if l < 1, and diverges if l > 1. (In the
Ô¨Årst case, choose r ‚àà(l, 1) and N such that 0 < an+1 < ran for all
n ‚â•N.)
Give examples where l = 1 and (i)  an converges, (ii)  an diverges.

30
1. Analysis on the Real Line
.10 Prove that ‚àû
n=0 1/n! converges and has sum < 3. Show also that
n

k=0
1
k! ‚àí
3
2n <

1 + 1
n
	n <
n

k=0
1
k!
for all n ‚â•3, and hence prove that limn‚Üí‚àû

1 + n‚àí1	n = ‚àû
n=0 1/n!.
.11 Prove Cauchy‚Äôs root test: let  an be a series of positive terms, and
l = lim sup
n‚àöan;
then  an converges if l < 1, and diverges if l > 1.
.12 Discuss the convergence of the series
1
2 + 1
3 + 1
22 + 1
32 + 1
23 + 1
33 + ¬∑ ¬∑ ¬∑ .
What does this series and Exercise (1.2.5: 6) tell you about the relative
strengths of the ratio test and the root test?
.13 Let (an) be a decreasing sequence of nonnegative real numbers, and
for each N let
sN =
N

n=1
an, tN =
N

n=1
2na2n.
Show that
(i) if m ‚â§2N, then sm ‚â§tN, and
(ii) if m ‚â•2N, then sm ‚â•1
2tN.
Hence prove that ‚àû
n=1 an converges if and only if ‚àû
n=1 2na2n
converges.
.14 Use the preceding exercise to show that ‚àû
n=1 1/np converges if and
only if p > 1 (cf. Exercises (1.2.14: 6 and 8)).
.15 Let (an)‚àû
n=0 and (bn)‚àû
n=0 be sequences of real numbers, and for each
N write SN = N
n=0 an. Show that if k > j, then
k

n=j
anbn =
k‚àí1

n=j
Sn(bn ‚àíbn+1) + Skbk ‚àíSj‚àí1bj.
Now suppose that
(i) there exists M > 0 such that |Sn| ‚â§M for all n,
(ii) bn ‚â•bn+1 for each n, and

1.2 Sequences and Series
31
(iii) limn‚Üí‚àûbn = 0.
Prove that if k > j, then
   
k
n=j anbn
   < 2Mbj, and hence that
‚àû
n=0 anbn converges. Use this result to give another proof of
Leibniz‚Äôs alternating series test.
A series  an of real numbers is said to be absolutely convergent if  |an|
is convergent.
(1.2.15) Proposition.
An absolutely convergent series is convergent.
Proof.
Let  an be absolutely convergent. Since the partial sums of
 |an| form a Cauchy sequence, for each Œµ > 0 there exists N such that
     
k

n=1
|an| ‚àí
j

n=1
|an|
     =
k

n=j
|an| < Œµ
whenever k > j ‚â•N. For such j and k we have
     
k

n=1
an ‚àí
j

n=1
an
     =
      
k

n=j
an
      
‚â§
k

n=j
|an| < Œµ.
Thus the partial sums of  an form a Cauchy sequence; whence  an is
convergent, by the completeness of R.
2
The case p = 1 of Example (1.2.14: 6) shows that the converse of
Proposition (1.2.15) is false.
By a power series we mean a series of the form ‚àû
n=0 anxn, where the
coeÔ¨Écients an ‚ààR. Such a series always converges for x = 0, but it may
converge for nonzero values of x. Its radius of convergence is deÔ¨Åned to be
sup
!
r ‚â•0 :
‚àû

n=0
anxn converges whenever |x| ‚â§r
"
if this supremum exists, and ‚àûotherwise; and its interval of convergence
is the largest interval I such that the power series converges for all x ‚ààI.
It is an immediate consequence of Exercise (1.2.16: 10) that every power
series has both a radius and an interval of convergence.
(1.2.16) Exercises
.1
Find an alternative proof of Proposition (1.2.15).
.2
Prove that the series ‚àû
n=1 nrn converges absolutely if ‚àí1 < r < 1.

32
1. Analysis on the Real Line
.3
Let  an,  bn be convergent series of nonnegative terms, with sums
a, b, respectively, and let
un = a1bn + a2bn‚àí1 + ¬∑ ¬∑ ¬∑ + an‚àí1b2 + anb1.
Prove that
N

n=1
un ‚â§
 N

n=1
an
  N

n=1
bn

‚â§
N

n=1
u2n
and hence that  un converges to the sum ab (Cauchy‚Äôs theorem on
the multiplication of series). Extend this result to the case where the
terms an may not be nonnegative but  an is absolutely convergent.
(Writing
b
=
‚àû

n=1
bn,
Œ≤k
=
b ‚àí
k
n=1
bn,
show that
N

n=1
un = b
N

n=1
an +
N

k=0
akŒ≤N‚àík,
and hence that N
k=0 akŒ≤N‚àík ‚Üí0 as N ‚Üí‚àû.)
.4
Show that
‚àû
n=1 (‚àí1)n #‚àön + 1 converges, but that the product (as
in the preceding exercise) of this series with itself does not converge.
.5
Prove that the exponential series
exp(x) =
‚àû

n=0
xn
n!
converges absolutely for all x ‚ààR. Then prove that
exp(x + y) = exp(x) exp(y).
.6
Prove that exp(x) = ex, where e = exp(1). (Use Exercise (1.1.4: 5).)
Show that
0 < e ‚àí
N

n=0
1
n! <
3
(N + 1)!
for each N, and hence calculate e with an error at most 10‚àí6.
.7
Prove that e is irrational. (Suppose that e
=
p/q, where p
and q are positive integers. Choose N > max {q, 3} , show that
N! ‚àû
n=N+1 1/n! is an integer, and use the inequality from the
preceding exercise to deduce a contradiction.)

1.2 Sequences and Series
33
.8
Show that
ex = lim
n‚Üí‚àû

1 + x
n
n
for each x ‚ààR. (First take x > 0. Expand sn = (1 + x/n)n using the
binomial theorem, and use the monotone sequence principle.)
.9
For each n deÔ¨Åne
Œ≥n = 1 + 1
2 + 1
3 + ¬∑ ¬∑ ¬∑ + 1
n ‚àílog n
Show that
e <

1 + 1
n
	n+1 < e1+n‚àí1
for each n, and hence that the sequence (Œ≥n) is decreasing and
bounded below. It follows from the monotone sequence principle that
Euler‚Äôs constant
Œ≥ = lim
n‚Üí‚àûŒ≥n
exists. Show that
N

n=1
(‚àí1)n+1
n
= Œ≥2N ‚àíŒ≥N + log 2
and hence that
N

n=1
(‚àí1)n+1
n
= log 2.
(cf. Exercise (1.2.14: 6).)
.10 Let r > 0. Prove that if ‚àû
n=0 anxn converges for x = r, then it
converges absolutely whenever |x| < r; and that if this power series
diverges for x = r, then it diverges whenever |x| > r. (For the Ô¨Årst
part, show that there exists M > 0 such that |anxn| ‚â§M |x/r|n for
all n.)
.11 Find the radius of convergence and the interval of convergence for
‚àû
n=0 xn.
.12 Find the radius of convergence and the interval of convergence for
‚àû
n=0(‚àí1)nxn/n.
.13 Suppose that an Ã∏= 0 for all n, and that
lim
n‚Üí‚àû
    
an+1
an
    = l.
Show that if l = 0, then ‚àû
n=0 anxn converges for all x ‚ààR; and that
if l Ã∏= 0, then the series has radius of convergence 1/l.

34
1. Analysis on the Real Line
.14 Let (an)‚àû
n=0 be a bounded sequence of real numbers, and let
l = lim sup
n
|an|.
Show that if l = 0, then ‚àû
n=0 anxn converges for all x ‚ààR; and that
if l Ã∏= 0, then the series has radius of convergence 1/l.
.15 Prove that if ( n
|an|)‚àû
n=0 is an unbounded sequence, then the power
series ‚àû
n=0 anxn only converges for x = 0.
.16 Prove that the power series
‚àû

n=0
anxn,
‚àû

n=1
nanxn‚àí1, and
‚àû

n=0
an
n + 1xn+1
have the same radius of convergence. Need they have the same interval
of convergence?
By a rearrangement of an inÔ¨Ånite series ‚àû
n=1 an we mean a series of
the form ‚àû
n=1 af(n) where f is a permutation of N+ (that is, a one‚Äìone
mapping of N+ onto itself). A theorem Ô¨Årst proved by Riemann shows
that if  an is a convergent, but not absolutely convergent, series of real
numbers, then for each real number s there exists a rearrangement of  an
that converges to s. The second exercise in the next set leads you through
a proof of this remarkable result.
(1.2.17) Exercises
.1
Prove that if  an is absolutely convergent, with sum s, then any
rearrangement of  an converges to s. (Given a permutation f of N+
and a positive number Œµ, choose N such that ‚àû
n=N+1 |an| < Œµ. Then
choose M ‚â•N such that {1, 2, . . . , N} ‚äÇ{f(1), f(2), . . . , f(M)} .
Show that
  m
n=1 af(n) ‚àís
  < 2Œµ for all m ‚â•M.)
.2
Let ‚àû
n=1 an be an inÔ¨Ånite series of real numbers that converges but is
not absolutely convergent. For each n deÔ¨Åne a+
n = max {an, 0} , a‚àí
n =
min {an, 0} . Prove that the partial sums of the series ‚àû
n=1 a+
n and
‚àû
n=1 a‚àí
n form increasing unbounded sequences. Now let s be any real
number. Let n0 and m0 both equal 0, and let n1 be the least positive
integer such that
a+
1 + a+
2 + ¬∑ ¬∑ ¬∑ + a+
n1 > s.
Show how to construct strictly increasing sequences (nk)‚àû
k=0 and
(mk)‚àû
k=0 of positive integers such that for each N ‚â•0,
N‚àí1

k=0

a+
nk+1 + ¬∑ ¬∑ ¬∑ + a+
nk+1

+

a‚àí
mk+1 + ¬∑ ¬∑ ¬∑ + a‚àí
mk+1

< s

1.3 Open and Closed Subsets of the Line
35
and
N‚àí1
k=0

a+
nk+1 + ¬∑ ¬∑ ¬∑ + a+
nk+1

+

a‚àí
mk+1 + ¬∑ ¬∑ ¬∑ + a‚àí
mk+1

+

a+
nN+1 + ¬∑ ¬∑ ¬∑ + a+
nN+1

> s.
Hence obtain a rearrangement of ‚àû
n=1 an that converges to s.
.3
Let s be the sum of the series ‚àû
n=1(‚àí1)n‚àí1/n. Show that the series
1 ‚àí1
2 ‚àí1
4 + 1
3 ‚àí1
6 ‚àí1
8 + 1
5 ‚àí1
10 ‚àí1
12 + ¬∑ ¬∑ ¬∑
converges to 1
2 log 2.
1.3
Open and Closed Subsets of the Line
In this section we introduce the fundamental topological notions of ‚Äúopen
set‚Äù and ‚Äúclosed set‚Äù in R, notions that readily generalise in later, more
abstract contexts.
A subset A of R is said to be open (in R) if to each x ‚ààA there
corresponds r > 0 such that the open interval (x ‚àír, x + r) is contained in
A ‚Äîor, equivalently, such that y ‚ààA whenever |x ‚àíy| < r.
(1.3.1) Exercises
.1
Prove that R itself, the empty set ‚àÖ, and all open intervals are open
subsets of R.
.2
Give an example of a sequence of open subsets of R whose intersection
is not open.
The Ô¨Årst result in this section describes the two fundamental properties
of open sets.
(1.3.2) Proposition.
The union of any family of open sets is open. The
intersection of any Ô¨Ånite family of open sets is open.
Proof.
Let (Ai)i‚ààI be any family of open sets. If x belongs to the union
U of this family, then x ‚ààAi for some i. As Ai is open, there exists r > 0
such that
(x ‚àír, x + r) ‚äÇAi ‚äÇU.
Hence U is open.

36
1. Analysis on the Real Line
Now let A1, . . . , An be Ô¨Ånitely many open sets, and consider any x in
their intersection. For each i, since x ‚ààAi and Ai is open, there exists
ri > 0 such that y ‚ààAi whenever |x ‚àíy| < ri. Let
r = min{r1, . . . , rn} > 0.
If |x ‚àíy| < r, then y ‚ààAi for each i, so y ‚ààn
i=1 Ai. Hence n
i=1 Ai is
open.
2
In view of Exercise (1.3.1: 2), we cannot drop the word ‚ÄúÔ¨Ånite‚Äù from the
hypothesis of the second part of Proposition (1.3.2).
Our next aim is to characterise open sets in R; to achieve this, we Ô¨Årst
characterise intervals.
A nonempty subset S of R is said to have the intermediate value property
if (a, b) ‚äÇS whenever a ‚ààS, b ‚ààS, and a < b. Of course, as we show in
Section 4, this notion is connected with the Intermediate Value Theorem
of elementary calculus.
(1.3.3) Proposition.
A subset S of R has the intermediate value
property if and only if it is an interval.
Proof.
It is clear that every interval in R has the intermediate value
property. Conversely, suppose that S ‚äÇR has that property. Assume, to
begin with, that S is bounded, and let a be its inÔ¨Åmum and b its supremum.
Note that x /‚ààS if either x < a or x > b. If a and b both belong to S, then
by the intermediate value property, so does every point of [a, b]; whence
S = [a, b]. If a ‚ààS and b /‚ààS, consider any x such that a ‚â§x < b. By
the deÔ¨Ånition of ‚Äúsupremum‚Äù, there exists s ‚ààS such that a ‚â§x < s; the
intermediate value property now ensures that x ‚ààS; whence S = [a, b).
Similarly, if a /‚ààS and b ‚ààS, then S = (a, b]. The remaining cases are left
as exercises.
2
(1.3.4) Exercises
.1
Prove that a nonempty open subset of R with the intermediate value
property is an open interval.
.2
Complete the proof of Proposition (1.3.3) in the remaining cases.
.3
Let I, J be open intervals with nonempty intersection. Prove that
I ‚à™J and I ‚à©J are open intervals.
(1.3.5) Lemma.
A nonempty family of pairwise‚Äìdisjoint open intervals
of R is countable.
Proof.
Let F be a nonempty family of pairwise‚Äìdisjoint open intervals
in R, and note that, by Exercise (1.1.1: 19), each of these intervals contains

1.3 Open and Closed Subsets of the Line
37
a rational number. The Axiom of Choice (see Appendix B) ensures that
there is a function f : F ‚ÜíQ such that f(I) ‚ààI for each I ‚ààF. Since the
sets in F are pairwise disjoint, f is one‚Äìone and so has an inverse function
g mapping f(F) onto F. As Q is countable and f(F) ‚äÇQ, there exists a
mapping h of N+ onto f(F); the composite function g ‚ó¶h then maps N+
onto F, which is therefore countable.
2
(1.3.6) Proposition.
A nonempty subset of R is open if and only if it
is the union of a sequence of pairwise‚Äìdisjoint open intervals.
Proof.
It follows from Proposition (1.3.2) and Exercise (1.3.1: 1) that the
union of any family of open intervals is an open set. Conversely, given a
nonempty open subset S of R, deÔ¨Åne a binary relation ‚àºon S by setting
x ‚àºy if and only if there exists an open interval I ‚äÇS such that x, y ‚àà
I. Then ‚àºis an equivalence relation: it is straightforward to prove the
reÔ¨Çexivity and symmetry of ‚àº, and its transitivity follows from Exercise
(1.3.4: 3). Clearly, the equivalence class Àôx of x under ‚àºis a union of open
intervals and is therefore an open set. Consider points y, z ‚ààÀôx and a real
number t with y < t < z. Choosing open intervals Iy, Iz ‚äÇS such that
x, y ‚ààIy and x, z ‚ààIz, we see from Exercise (1.3.4: 3) that Iy ‚à™Iz is an
open interval; so t ‚àà(y, z) ‚äÇIy ‚à™Iz, and therefore either x, t ‚ààIy ‚äÇS or
else x, t ‚ààIz ‚äÇS. Hence Àôx has the intermediate value property. It follows
from Exercise (1.3.4: 1) that Àôx is an open interval. Since any two distinct
equivalence classes under ‚àºare disjoint, we now see that
S =

x‚ààS
Àôx
is a union of pairwise‚Äìdisjoint open intervals. Reference to Lemma (1.3.5)
completes the proof.
2
A real number x is an interior point of a set S ‚äÇR if there exists r > 0
such that (x ‚àír, x + r) ‚äÇS. The set of all interior points of S is called the
interior of S, and is written S‚ó¶. By a neighbourhood of x we mean a set
containing x in its interior.
(1.3.7) Exercises
.1
Let S be a nonempty open subset of R, and for each x ‚ààS consider
the sets
Ux = {t ‚ààR : (x, t) ‚äÇS} ,
Lx = {s ‚ààR : (s, x) ‚äÇS} .
Let a = inf Lx, b = sup Ux, and Ix = (a, b), where a = ‚àí‚àûif Lx
is not bounded below, and b = ‚àûif Ux is not bounded above. Give
another proof of Proposition (1.3.6) by showing that (Ix)x‚ààS is a
family of disjoint open intervals whose union is S.

38
1. Analysis on the Real Line
.2
Prove that the interior of an open, closed, or half open interval with
endpoints a and b, where a < b, is the open interval (a, b).
.3
Show that (S‚ó¶)‚ó¶= S‚ó¶.
.4
Prove that S‚ó¶is the largest open set contained in S ‚Äîin other words,
that
(i) S‚ó¶is open and S‚ó¶‚äÇS;
(ii) if A is open and A ‚äÇS, then A ‚äÇS‚ó¶.
.5
Prove that S is open if and only if S ‚äÇS‚ó¶.
.6
Prove that S‚ó¶is the union of the open sets contained in S.
.7
Prove that
(i) if S ‚äÇT, then S‚ó¶‚äÇT ‚ó¶;
(ii) (S ‚à©T)‚ó¶= S‚ó¶‚à©T ‚ó¶.
.8
Prove that U is a neighbourhood of x ‚ààR if and only if there is an
open set A such that x ‚ààA ‚äÇU.
Let x be a real number, and S a subset of R. We call x a cluster point
of S if each neighbourhood of x has a nonempty intersection with S; or,
equivalently, if for each Œµ > 0 there exists y ‚ààS such that |x ‚àíy| < Œµ. The
closure of S (in R) is the set of all cluster points of S, and is denoted by
S or S‚àí. S is said to be closed if S = S.
(1.3.8) Exercises
.1
Is Q closed in R? Is it open in R?
.2
Show that the closure of any interval with endpoints a and b, where
a < b, is the closed interval [a, b].
.3
Show that

S
	
= S.
.4
Prove that S is the smallest closed set containing S ‚Äîin other words,
that
(i) S is closed and S ‚äÇS;
(ii) if A is closed and S ‚äÇA, then S ‚äÇA.
.5
Prove that S is closed if and only if S ‚äÇS.
.6
Prove that S is the intersection of the closed sets containing S.

1.3 Open and Closed Subsets of the Line
39
.7
Prove the following.
(i) If S ‚äÇT, then S ‚äÇT;
(ii) S ‚à™T = S ‚à™T.
.8
Prove that
(i) the complement of S‚ó¶is the closure of R\S;
(ii) the complement of S is the interior of R\S.
.9
The boundary, or frontier, of a set S ‚äÇR is the intersection of the
closures of S and R\S. Describe the boundary of each of the following
sets: R, ‚àÖ, (a, b] (where a < b), Q.
.10 Prove that a belongs to the boundary of S\{a} if and only if a ‚àà
S\{a}.
.11 Let C be the Cantor set‚Äîthat is, the subset of [0, 1] consisting of all
numbers that have a ternary (base 3) expansion ‚àû
n=1 an3‚àín with
an ‚àà{0, 2} for each n. Prove that
(i) if a, b are two numbers in C that diÔ¨Äer in their mth ternary
places, then |a ‚àíb| ‚â•3‚àím;
(ii) C is a closed subset of R;
(iii) C has an empty interior.
What is the boundary of C?
(1.3.9) Proposition.
S is closed if and only if R\S is open.
Proof.
Suppose that S is closed, and consider any x ‚ààR\S. Since S = S,
x is not a cluster point of S; so there exists a neighbourhood U of x that
is disjoint from S. By Exercise (1.3.7: 8), there is an open set A such that
x ‚ààA ‚äÇU. Then A ‚à©S = ‚àÖ, so A ‚äÇR\S; whence, by Exercise (1.3.7: 8),
R\S is a neighbourhood of x, and therefore x ‚àà(R\S)‚ó¶. Since x is any
element of R\S, we conclude that R\S is open.
Conversely, suppose that R\S is open. Then by Exercise (1.3.7: 8), R\S
is a neighbourhood of each of its points. Since R\S is disjoint from S, it
follows that no point of R\S is in the closure of S. Thus if x ‚ààS, then
x /‚ààR\S and so x ‚ààS. Hence S ‚äÇS, and therefore, by Exercise (1.3.8: 5),
S is closed.
2
(1.3.10) Proposition.
The intersection of a family of closed sets is
closed. The union of a Ô¨Ånite family of closed sets is closed.

40
1. Analysis on the Real Line
Proof.
Let (Ci)i‚ààI be any family of closed sets, and for each i let Ai be
the complement of Ci. Then

i‚ààI
Ci = R\(

i‚ààI
Ai).
Since, by Proposition (1.3.9), each Ai is open, Proposition (1.3.2) shows
that 
i‚ààI Ai is open; whence, again by Proposition (1.3.9), its complement
is closed. This completes the Ô¨Årst part of the proof; the second is left as an
exercise.
2
(1.3.11) Exercises
.1
Complete the proof of Proposition (1.3.10).
.2
Give an example of a sequence of closed sets whose union is not
closed.
Which subsets of R are both open and closed? Before answering this
question, we prove a simple lemma.
(1.3.12) Lemma.
If T is a nonempty open subset of R that is bounded
above (respectively, below), then sup T /‚ààT (respectively, inf T /‚ààT).
Proof.
Consider, for example, the case where T is bounded above. Sup-
pose that M = sup T belongs to T. Since T is open, (M ‚àír, M + r) ‚äÇT
for some r > 0. Hence M + 1
2r ‚ààT, which is absurd as M + 1
2r > sup T.
Hence, in fact, M /‚ààT.
2
(1.3.13) Proposition.
R and ‚àÖare the only subsets of R that are both
open and closed in R.
Proof.
Exercise (1.3.1: 1) and Proposition (1.3.9) show that R and ‚àÖare
both open and closed in R. Let S be a nonempty set that is both open and
closed, and note that, by Proposition (1.3.9), R\S is also both open and
closed. Suppose R\S is nonempty. Choosing a ‚ààS and b ‚ààR\S, we have
either a < b or a > b. Without loss of generality we take the former case,
so that
T = {x ‚ààR\S : x > a}
is nonempty and bounded below. By Proposition (1.3.2), T is also open,
being the intersection of the open sets (a, ‚àû) and R\S. Let m = inf T.
Since S is open, there exists r > 0 such that (a ‚àír, a + r) ‚äÇS; whence
m ‚â•a + r > a. Since, by Lemma (1.3.12), m /‚ààT, it follows that m /‚ààR\S
and therefore that m ‚ààS. But S is open, so there exists Œµ > 0 such that
(m ‚àíŒµ, m + Œµ) ‚äÇS; this is impossible, since the deÔ¨Ånition of ‚ÄúinÔ¨Åmum‚Äù
ensures that there exists t ‚ààR\S such that t < m + Œµ. This contradiction
shows that R\S is empty; whence S = R.
2

1.4 Limits and Continuity
41
1.4
Limits and Continuity
Let I be an interval in R, a a point of the closure of I, and f a real‚Äìvalued
function whose domain includes I but not necessarily a. A real number l is
called the limit of f(x) as x tends to a in I, or the limit of f at a (relative
to I), if to each Œµ > 0 there corresponds Œ¥ > 0 such that |f(x) ‚àíl| < Œµ
whenever x ‚ààI and 0 < |x ‚àía| < Œ¥. We then write
f(x) ‚Üíl as x ‚Üía, x ‚ààI
or
lim
x‚Üía, x‚ààI f(x) = l
and we say that f(x) tends to l as x tends to a through values in I.
The following are the most important cases of this deÔ¨Ånition.
‚Ä¢ a ‚ààI‚ó¶: in this case we use the simpler notations
f(x) ‚Üíl as x ‚Üía
and
lim
x‚Üía f(x) = l.
‚Ä¢ I = (c, a) for some c < a (where c could be ‚àí‚àû): in this case we call l
the left‚Äìhand limit of f as x tends to a; we say that f(x) tends to l as
x tends to a from the left (or from below); and we use the notations
f(x) ‚Üíl as x ‚Üía‚àí
and
f(a‚àí) = lim
x‚Üía‚àíf(x) = l.
‚Ä¢ I = (a, b) for some b > a (where b could be ‚àû): in this case we call
l the right‚Äìhand limit of f as x tends to a; we say that f(x) tends
to l as x tends to a from the right (or from above); and we use the
notations
f(x) ‚Üíl as x ‚Üía+
and
f(a+) = lim
x‚Üía+ f(x) = l.
We stress that although, in our deÔ¨Ånition of ‚Äúlimit‚Äù, f(x) is deÔ¨Åned for
all x in I that are distinct from but suÔ¨Éciently close to a, f(a) need not
be deÔ¨Åned. For example, in elementary calculus courses we learn that
lim
x‚Üí0
sin x
x
= 1

42
1. Analysis on the Real Line
even though (sin x) /x is not deÔ¨Åned at x = 0.
(1.4.1) Proposition.
If limx‚Üía, x‚ààI f(x) = l and limx‚Üía, x‚ààI f(x) = l‚Ä≤,
then l = l‚Ä≤.
Proof.
Given Œµ > 0, choose Œ¥f, Œ¥g > 0 such that
‚Äî if x ‚ààI and 0 < |x ‚àía| < Œ¥f, then |f(x) ‚àíl| < Œµ/2, and
‚Äî if x ‚ààI and 0 < |x ‚àía| < Œ¥g, then |f(x) ‚àíl‚Ä≤| < Œµ/2.
Setting Œ¥ = min {Œ¥f, Œ¥g} , consider any x ‚ààI such that 0 < |x ‚àía| < Œ¥. We
have
|l ‚àíl‚Ä≤| ‚â§|f(x) ‚àíl| + |f(x) ‚àíl‚Ä≤| < Œµ
2 + Œµ
2 = Œµ.
Since Œµ > 0 is arbitrary, it follows from Exercise (1.1.2: 4) that l = l‚Ä≤.
2
(1.4.2) Proposition.
If limx‚Üía, x‚ààI f(x) = l and limx‚Üía, x‚ààI g(x) = m,
then as x ‚Üía through values in I,
f(x) + g(x) ‚Üíl + m,
f(x) ‚àíg(x) ‚Üíl ‚àím,
f(x)g(x) ‚Üílm,
max {f(x), g(x)} ‚Üímax{l, m},
min {f(x), g(x)} ‚Üímin{l, m},
|f(x)| ‚Üí|l| .
If also m Ã∏= 0, then
lim
x‚Üía, x‚ààI
f(x)
g(x) = l
m.
Proof.
See Exercise (1.4.3: 3).
2
(1.4.3) Exercises
.1
DeÔ¨Åne precisely what it means to say that f(x) does not converge to
any limit as x tends to a through values in I. In other words, give the
formal negation of the deÔ¨Ånition of ‚Äúconvergent‚Äù.
.2
Let the function f be deÔ¨Åned in an interval whose interior con-
tains a. Prove that limx‚Üía f(x) = l if and only if limx‚Üía+ f(x) and
limx‚Üía‚àíf(x) exist and equal l.
.3
Prove Proposition (1.4.2).
.4
Use the deÔ¨Ånition of ‚Äúlimit‚Äù to prove that limx‚Üía, x‚ààR p(x) = p(a)
for any polynomial function p and any a ‚ààR.

1.4 Limits and Continuity
43
.5
Let p, q be polynomial functions, and a a real number such that q(a) Ã∏=
0. Prove that
lim
x‚Üía, x‚ààR
p(x)
q(x) = p(a)
q(a).
.6
Prove that limx‚Üía, x‚ààI f(x) = l if and only if for each sequence (an)
of elements of I that converges to a, the sequence (f(an)) converges
to l. (For ‚Äúonly if‚Äù, use a proof by contradiction.)
.7
Suppose that limx‚Üía, x‚ààI f(x) > r. Prove that there exists Œ¥ > 0 such
that if x ‚ààI and 0 < |x ‚àía| < Œ¥, then f(x) > r.
.8
Let f be a real‚Äìvalued function whose domain includes an interval
of the form (s, ‚àû), and let l ‚ààR. We say that f(x) tends to l as
x tends to ‚àûif to each Œµ > 0 there corresponds K > 0 such that
|f(x) ‚àíl| < Œµ whenever x > K; we then write
f(x) ‚Üíl as x ‚Üí‚àû
or
lim
x‚Üí‚àûf(x) = l.
Convince yourself that analogues of Propositions (1.4.1) and (1.4.2)
hold for limits as x tends to ‚àû.
DeÔ¨Åne the notion f(x) tends to l as x tends to ‚àí‚àû, written
f(x) ‚Üíl as x ‚Üí‚àí‚àû
or
lim
x‚Üí‚àí‚àûf(x) = l,
and convince yourself that analogues of Propositions (1.4.1) and
(1.4.2) hold for this notion also.
.9
Formulate deÔ¨Ånitions of the following notions, where I is an interval.
(i) f(x) ‚Üí‚àûas x ‚Üía through values in I.
(ii) f(x) ‚Üí‚àí‚àûas x ‚Üía through values in I.
(iii) f(x) ‚Üí‚àûas x ‚Üí‚àû.
(iv) f(x) ‚Üí‚àûas x ‚Üí‚àí‚àû.
(v) f(x) ‚Üí‚àí‚àûas x ‚Üí‚àû.
(vi) f(x) ‚Üí‚àí‚àûas x ‚Üí‚àí‚àû.
.10 Prove that if a > 1, then ax ‚Üí0 as x ‚Üí‚àí‚àû, and ax ‚Üí‚àûas
x ‚Üí‚àû. What happens to ax as x ‚Üí¬±‚àûwhen 0 < a < 1? (Note
Exercise (1.2.3: 3).)

44
1. Analysis on the Real Line
.11 Prove that if a > 1, then loga x ‚Üí0 as x ‚Üí‚àí‚àû, and loga x ‚Üí‚àûas
x ‚Üí‚àû. What happens to loga x as x ‚Üí¬±‚àûif 0 < a < 1?
.12 Let f be a real‚Äìvalued function, and, where appropriate, deÔ¨Åne
limx‚ÜíŒæ sup f(x)
=
infr>0 sup {f(x) : 0 < |x ‚àíŒæ| < r} ,
limx‚ÜíŒæ+ sup f(x)
=
infr>0 sup {f(x) : 0 < x ‚àíŒæ < r} ,
limx‚ÜíŒæ‚àísup f(x)
=
infr>0 sup {f(x) : 0 < Œæ ‚àíx < r} .
For example, in order that limx‚ÜíŒæ‚àísup f(x) be deÔ¨Åned, it is necessary
that f be deÔ¨Åned and bounded4 on some interval of the form (Œæ‚àír, Œæ),
where r > 0. Prove the following.
(a) limx‚ÜíŒæ sup f(x) ‚â§M if and only if for each Œµ > 0 there exists
Œ¥ > 0 such that f(x) < M + Œµ whenever 0 < |x ‚àíŒæ| < Œ¥.
(b) limx‚ÜíŒæ sup f(x) ‚â•M if and only if for each pair of positive
numbers Œµ, Œ¥ there exists x such that 0 < |x ‚àíŒæ| < Œ¥ and f(x) >
M ‚àíŒµ.
Formulate appropriate deÔ¨Ånitions of the quantities limx‚ÜíŒæ inf f(x),
limx‚ÜíŒæ+ inf f(x), and limx‚ÜíŒæ‚àíinf f(x). Prove that
(c) limx‚ÜíŒæ inf f(x) ‚â§limx‚ÜíŒæ sup f(x), and these two numbers are
equal if and only if l = limx‚ÜíŒæ f(x) exists, in which case the
numbers equal l.
An important special case of the notion of a limit occurs when the
function f is deÔ¨Åned at the point a that we are approaching.
A function f deÔ¨Åned in some neighbourhood of a is said to be continuous
at a if f(x) ‚Üíf(a) as x ‚Üía; in other words, if for each Œµ > 0 there exists
Œ¥ > 0 such that |f(x) ‚àíf(a)| < Œµ whenever |x ‚àía| < Œ¥. We also say that
f is
‚Ä¢ continuous on the left at a if f is deÔ¨Åned on the interval (a‚àír, a] for
some r > 0 and
f(a‚àí) = lim
x‚Üía‚àíf(x) = f(a);
‚Ä¢ continuous on the right at a if f is deÔ¨Åned on the interval [a, a + r)
for some r > 0 and
f(a+) = lim
x‚Üía+ f(x) = f(a);
4By allowing the lim sup quantities to take the values ¬±‚àû, in a sense that is
made precise in Section 3.1, we can remove the restriction that f be bounded
near Œæ.

1.4 Limits and Continuity
45
‚Ä¢ continuous on the interval I if limx‚Üít, x‚ààI f(x) = f(t) for each t ‚ààI.
Note that the last deÔ¨Ånition takes care of the one‚Äìsided continuity of f at
those endpoints of I, if any, that belong to I.
If f is deÔ¨Åned in a neighbourhood of a but is not continuous at a, we say
that f has a discontinuity, or is discontinuous, at a.
(1.4.4) Proposition.
Let the real‚Äìvalued functions f and g be continu-
ous at a. Then f +g, f ‚àíg, fg, max {f, g} , min {f, g} , and |f| are contin-
uous at a. If also g(x) Ã∏= 0 for all x in some neighbourhood of a, then f/g
is continuous at a.
Proof.
This is a simple consequence of Proposition (1.4.2).
2
(1.4.5) Exercises
.1
Let f be deÔ¨Åned on a neighbourhood of a. Prove that f is continuous
at a if and only if it is continuous on both the left and the right at a.
.2
Give the details of the proof of Proposition (1.4.4). Extend this result
to deal with continuity on an interval I.
.3
Prove that a polynomial function is continuous on R.
.4
Let p, q be polynomial functions, and a a real number such that q(a) Ã∏=
0. Prove that the rational function p/q is continuous at a.
.5
Let f be continuous at a, and let g be continuous at f(a). Prove that
the composite function g ‚ó¶f is continuous at a.
.6
Prove that f is continuous at the point a ‚ààR if and only if f is
sequentially continuous at a, in the sense that f(an) ‚Üíf(a) whenever
(an) is a sequence of points of the domain of f that converges to a.
.7
Let f be deÔ¨Åned in an interval (a ‚àír, a + r) where r > 0. The
oscillation of f at a is
œâ(f, a) = lim
Œ¥‚Üí0 sup {f(x) ‚àíf(y) : x, y ‚àà(a ‚àíŒ¥, a + Œ¥)} .
Prove that f is continuous at a if and only if œâ(f, a) = 0.
.8
Let f be an increasing function on [a, b]. Prove that f(Œæ‚àí) exists for
each Œæ ‚àà(a, b], and that f(Œæ+) exists for each Œæ ‚àà[a, b). By considering
the sets

x ‚àà(a, b) :
  f(x+) ‚àíf(x‚àí)
  > 1
n

,
with n a positive integer, prove that the set of points of [a, b] at which
f has a discontinuity is either empty or countable.

46
1. Analysis on the Real Line
.9
Let q0, q1, . . . be a one‚Äìone enumeration of Q ‚à©[0, 1], and for each
x ‚àà[0, 1] deÔ¨Åne
T(x) = {n ‚ààN : qn ‚â§x} .
DeÔ¨Åne a mapping f : [0, 1] ‚ÜíR by
f(x) =
Ô£±
Ô£≤
Ô£≥
0
if x = 0

n‚ààT (x) 2‚àín
if 0 < x ‚â§1.
Prove that
(i) f is strictly increasing,
(ii) f is continuous at each irrational point of [0, 1], and
(iii) f is discontinuous at each rational point of [0, 1].
.10 Let (fn)‚àû
n=1 be a sequence of functions on an interval I, and suppose
that there exists a convergent series ‚àû
n=1 Mn of nonnegative terms
such that |fn(x)| ‚â§Mn for each x ‚ààI and each n. Prove that for
each Œµ > 0 there exists N such that 0 ‚â§k
n=j+1 |fn(x)| < Œµ whenever
k > j ‚â•N and x ‚ààI. Hence prove that f(x) = ‚àû
n=1 fn(x) deÔ¨Ånes
a function on I (Weierstrass‚Äôs M‚Äìtest). Prove also that if each fn is
continuous on I, then so is f.
.11 Give two proofs that exp is a continuous function on R.
.12 Prove that if a > 0, then the function x ‚Üíax is continuous on R.
(Note that ax = exp(x log a).)
.13 Prove that if a > 0, then the function x ‚Üíloga x is continuous on R.
(First take the case a > 1. Given x > 0 and Œµ > 0, choose a positive
integer n > 1/Œµ, and then Œ¥ ‚àà(0, x) such that (x + Œ¥) /x < a1/n and
(x ‚àíŒ¥) /x > a‚àí1/n.)
.14 Prove that the functions sin and cos, deÔ¨Åned by
sin x
=
‚àû

n=0
(‚àí1)nx2n+1
(2n + 1)! ,
cos x
=
‚àû

n=0
(‚àí1)nx2n
(2n)!
are (well deÔ¨Åned and) continuous on R.
.15 Let I be the interval of convergence of the power series f(x) =
‚àû
n=0 anxn. Prove that f is continuous on I.
.16 Prove that if ‚àû
n=0 an is a convergent series, then

1.4 Limits and Continuity
47
(i) ‚àû
n=0 anxn converges for all x ‚àà(‚àí1, 1), and
(ii) for each Œµ > 0 there exists Œ¥ ‚àà(0, 1) such that if 1 ‚àíœÉ < x < 1,
then
     
‚àû

n=0
an ‚àí
‚àû

n=0
anxn
     < Œµ.
Thus limx‚Üí1‚àí‚àû
n=0 anxn = ‚àû
n=0 an (Abel‚Äôs Limit Theorem). (For
(ii), note that
     
‚àû

n=0
an ‚àí
‚àû

n=0
anxn
     ‚â§
     
N

n=0
an(1 ‚àíxn)
     
+
     
‚àû

n=N+1
an
     +
     
‚àû

n=N+1
anxn
     
for each N. Use Exercise (1.2.14: 15) to handle the last term on the
right.)
.17 Let ‚àû
n=0 an, ‚àû
n=0 bn be convergent series with sums a, b, respec-
tively, and let
un = a1bn + a2bn‚àí1 + ¬∑ ¬∑ ¬∑ + an‚àí1b2 + anb1.
Prove that if ‚àû
n=0 un converges, then its sum is ab. (For ‚àí1 < x ‚â§1
set f(x) = ‚àû
n=0 anxn and g(x) = ‚àû
n=0 bnxn. Then use Exercises
(1.2.16: 10), (1.2.16: 3), and (1.4.5: 16).)
This is the full form of Cauchy‚Äôs theorem on the multiplication of
series, and should be compared with Exercise (1.2.16: 3).
Deeper results about continuity‚Äîindeed, many results in real‚Äìvariable
theory‚Äîdepend on two fundamental properties of the real line, described
in our next two theorems.
By a cover of a subset S of R we mean a family U of subsets of R such
that S ‚äÇ U; we then say that S is covered by U and that U covers S. If
also each U ‚ààU is an open subset of R, we refer to U as an open cover of
S (in R). By a subcover of a cover U of S we mean a family F ‚äÇU that
covers S; if also F is a Ô¨Ånite family, then it is called a Ô¨Ånite subcover of U.
Although there exist shorter proofs of the next theorem (see the next set
of exercises), the one we present is adapted to prove a more general result
(Theorem (3.3.9)) in Chapter 3.
(1.4.6) The Heine‚ÄìBorel‚ÄìLebesgue Theorem.
Every open cover of
a compact interval I in R contains a Ô¨Ånite subcover of I.

48
1. Analysis on the Real Line
Proof.
Suppose there exists an open cover U of I that contains no Ô¨Ånite
subcover of I. Either the closed right half of I or the closed left half (or
both) cannot be covered by a Ô¨Ånite subfamily of U: otherwise each half, and
therefore I itself, would be covered by a Ô¨Ånite subfamily. Let I1 be a closed
half of I that is not covered by a Ô¨Ånite subfamily of U. In turn, at least
one closed half, say I2, of I1 cannot be covered by a Ô¨Ånite subfamily of U.
Carrying on in this way, we construct a nested sequence I ‚äÉI1 ‚äÉI2 ‚äÉ¬∑ ¬∑ ¬∑
of closed subintervals of I such that for each n,
(a) |In| = 2‚àín |I| and
(b) no Ô¨Ånite subfamily of U covers In.
By the nested intervals principle (1.2.6), there exists a point Œæ ‚àà‚àû
n=1 In.
Clearly Œæ ‚ààI, so there exists U ‚ààU such that Œæ ‚ààU. Since U is open, there
exists r > 0 such that if |x ‚àíŒæ| < r, then x ‚ààU. Using (a), we can Ô¨Ånd N
such that if x ‚ààIN, then |x ‚àíŒæ| < r and therefore x ‚ààU; thus IN ‚äÇU.
This contradicts (b).
2
A real number a is called a limit point of a subset S of R if each neigh-
bourhood of a intersects S\{a}; or, equivalently, if for each Œµ > 0 there
exists x ‚ààS with 0 < |x ‚àía| < Œµ. By a limit point of a sequence (an) we
mean a limit point of the set {a1, a2, . . .} of terms of the sequence.
A nonempty subset A of R is said to have the Bolzano‚ÄìWeierstrass
property if each inÔ¨Ånite subset S of A has a limit point belonging to A.
(1.4.7) The Bolzano‚ÄìWeierstrass Theorem.
Every compact interval
in R has the Bolzano‚ÄìWeierstrass property.
Proof.
Let I be a compact interval, and S an inÔ¨Ånite subset of I. By
Corollary (1.2.8), any inÔ¨Ånite sequence of distinct points of S contains a
convergent subsequence; the limit of that subsequence is a limit point of S
in the closed set I.
2
(1.4.8) Exercises
.1
Let X be a subset of R with the Bolzano‚ÄìWeierstrass property, and
let (xn) be a sequence of points in X. Show that there exists a
subsequence of (xn) that converges to a limit in X. (Note Lemma
(1.2.7).)
.2
Fill in the details of the following alternative proof of the Heine‚Äì
Borel‚ÄìLebesgue Theorem. Let U be an open cover of the compact
interval I = [a, b], and deÔ¨Åne
A = {x ‚ààI : [a, x] is covered by Ô¨Ånitely many elements of U} .
Then A is nonempty (it contains a) and is bounded above; let Œæ =
sup A. Suppose that Œæ Ã∏= b, and derive a contradiction.

1.4 Limits and Continuity
49
.3
Fill in the details of the following alternative proof of the Bolzano‚Äì
Weierstrass Theorem. Suppose the theorem is false; so there exist a
compact interval I and an inÔ¨Ånite subset S of I such that no limit
point of S belongs to I. Construct a nested sequence I ‚äÉI1 ‚äÉI2 ‚äÉ¬∑ ¬∑ ¬∑
of closed subintervals of I such that for each n,
(a) |In| = 2‚àín |I|,
(b) S ‚à©In is an inÔ¨Ånite set, and
(c) S ‚à©In has no limit points in In.
Let Œæ ‚àà‚àû
n=1 In, and show that Œæ is a limit point of S. (This is
one of the commonest proofs of the Bolzano‚ÄìWeierstrass Theorem in
textbooks.)
.4
Here is a sketch of yet another proof of the Bolzano‚ÄìWeierstrass The-
orem for you to complete. Let I be a compact interval, and S an
inÔ¨Ånite subset of I; then the supremum of the set
A = {x ‚ààI : S ‚à©(‚àí‚àû, x) is Ô¨Ånite or empty}
is a limit point of S in I.
.5
Let S be a subset of R with the Bolzano‚ÄìWeierstrass property. Prove
that S is closed and bounded. (For boundedness, use a proof by
contradiction.)
.6
Show that the Bolzano‚ÄìWeierstrass Theorem can be proved as a con-
sequence of the Heine‚ÄìBorel‚ÄìLebesgue Theorem. (Let I be a compact
interval in R, assume the Heine‚ÄìBorel‚ÄìLebesgue Theorem (1.4.6),
and suppose that there exists an inÔ¨Ånite subset S of I that has no
limit point in I. First show that for each s ‚ààS there exists rs > 0
such that S ‚à©(s ‚àírs, s + rs) = {s}.)
.7
Let f be a real‚Äìvalued function deÔ¨Åned on an interval I. We say that f
is uniformly continuous on I if to each Œµ > 0 there corresponds Œ¥ > 0
such that |f(x) ‚àíf(x‚Ä≤)| < Œµ whenever x, x‚Ä≤ ‚ààI and |x ‚àíx‚Ä≤| < Œ¥.
Show that a uniformly continuous function is continuous. Give an
example of I and f such that f is continuous, but not uniformly
continuous, on I.
.8
Use the Heine‚ÄìBorel‚ÄìLebesgue Theorem to prove the Uniform Con-
tinuity Theorem: a continuous real‚Äìvalued function f on a compact
interval I ‚äÇR is uniformly continuous. (For each Œµ > 0 and each
x ‚ààI, choose Œ¥x > 0 such that if x‚Ä≤ ‚ààI and |x ‚àíx‚Ä≤| < 2Œ¥x, then
|f(x) ‚àíf(x‚Ä≤)| < Œµ/2. The intervals (x ‚àíŒ¥x, x + Œ¥x) form an open
cover of I.)

50
1. Analysis on the Real Line
.9
Prove the Uniform Continuity Theorem (see the previous exercise) us-
ing the Bolzano‚ÄìWeierstrass Theorem. (If f : I ‚ÜíR is not uniformly
continuous, then there exists Œ± > 0 with the following property: for
each n ‚ààN+ there exist xn, yn ‚ààI such that |xn ‚àíyn| < 1/n and
|f(xn) ‚àíf(yn)| ‚â•Œ±.)
The proof of the following result about boundedness of real‚Äìvalued
functions illustrates well the application of the Heine‚ÄìBorel‚ÄìLebesgue
Theorem.
(1.4.9) Theorem.
A continuous real‚Äìvalued function f on a compact
interval I is bounded; moreover, f attains its bounds in the sense that
there exist points Œæ, Œ∑ of I such that f(Œæ) = inf f and f(Œ∑) = sup f.
Proof.
For each x ‚ààI choose Œ¥x > 0 such that if x‚Ä≤ ‚ààI and |x ‚àíx‚Ä≤| < Œ¥x,
then |f(x) ‚àíf(x‚Ä≤)| < 1. The intervals (x ‚àíŒ¥x, x + Œ¥x), where x ‚ààI, form
an open cover of I. By Theorem (1.4.6), there exist Ô¨Ånitely many points
x1, . . . , xN of I such that
I ‚äÇ
N

k=1
(xk ‚àíŒ¥xk, xk + Œ¥xk) .
Let
c = 1 + max {|f(x1)| , . . . , |f(xN)|} ,
and consider any point x ‚ààI. Choosing k such that x ‚àà(xk ‚àíŒ¥xk, xk +Œ¥xk),
we have
|f(x)| ‚â§|f(x) ‚àíf(xk)| + |f(xk)|
< 1 + |f(xk)|
‚â§c,
so f is bounded on I.
Now write
m = inf f,
M = sup f.
Suppose that f(x) Ã∏= M, and therefore f(x) < M, for all x ‚ààI. Then
x ‚Üí1/(M ‚àíf(x)) is a continuous mapping of I into R+, by Proposition
(1.4.4), and so, by the Ô¨Årst part of this proof, has a supremum G > 0. For
each x ‚ààI we then have M ‚àíf(x) ‚â•1/G and therefore f(x) ‚â§M ‚àí1/G.
This contradicts our choice of M as the supremum of f.
2
(1.4.10) Exercises
.1
Prove both parts of Theorem (1.4.9) using the Bolzano‚ÄìWeierstrass
Theorem and contradiction arguments.

1.4 Limits and Continuity
51
.2
Let f be a continuous function on R such that f(x) ‚Üí‚àûas x ‚Üí¬±‚àû.
Prove that there exists Œæ ‚ààR such that f(x) ‚â•f(Œæ) for all x ‚ààR.
.3
Let f be a continuous function on R such that f(x) ‚Üí0 as x ‚Üí¬±‚àû.
Prove that f is both bounded and uniformly continuous.
(1.4.11) The Intermediate Value Theorem.
If f is a continuous
real‚Äìvalued function on an interval I, then f(I) has the intermediate value
property (page 36).
Proof.
Let a, b be points of I, and y a real number such that f(a) < y <
f(b); without loss of generality assume that a < b. Then
S = {x ‚àà[a, b] : f(x) < y}
is nonempty (it contains a) and bounded above by b, so Œæ = sup S exists.
Note that Œæ < b and that (Œæ, b] ‚äÇI. We show that f(Œæ) = y. To this
end, suppose Ô¨Årst that f(Œæ) < y. Then, by Exercise (1.4.3: 7), there exists
Œ¥ ‚àà(0, b‚àíŒæ) such that if x ‚ààI and |x ‚àíŒæ| < Œ¥, then f(x) < y; in particular,
f(x) < y for all x ‚àà(Œæ, Œæ + Œ¥), which contradicts the deÔ¨Ånition of Œæ as the
supremum of S. Thus f(Œæ) ‚â•y.
Now suppose that f(Œæ) > y; then Œæ > a. By another application of
Exercise (1.4.3: 7), there exists Œ¥‚Ä≤ ‚àà(0, Œæ ‚àía) such that if Œæ ‚àíŒ¥‚Ä≤ < x < Œæ,
then f(x) > y. This is impossible, since, by the deÔ¨Ånition of ‚Äúsupremum‚Äù,
there exist points x of (a, Œæ) arbitrarily close to Œæ with f(x) < y. Hence
f(Œæ) ‚â§y, and therefore f(Œæ) = y.
2
(1.4.12) Corollary.
Let f be a continuous real‚Äìvalued function on a
compact interval I, and let m = inf f, M = sup f. Then f(I) = [m, M].
Proof.
Use Theorems (1.4.9) and (1.4.11).
2
(1.4.13) Exercises
.1
Fill in the details of the following common proof of the Interme-
diate Value Theorem. Let f(a) < y < f(b), write a0 = a, b0 =
b, c0 = 1
2(a0 + b0), and assume without loss of generality that a < b.
If f(c0) = y, there is nothing to prove and we stop our construc-
tion. Otherwise, by repeated interval‚Äìhalving, we construct points
a0, b0, c0, a1, b1, c1, . . . such that
‚Äî either f(cn) = 0 for some n and the construction stops,
‚Äî or else the construction proceeds ad inÔ¨Ånitum, an ‚â§an+1 ‚â§
bn+1 ‚â§bn, f(an) < y, f(bn) > y, cn = 1
2(an + bn), and
0 < bn ‚àían =
 1
2
	n (b ‚àía).

52
1. Analysis on the Real Line
Choosing x ‚àà‚àû
n=1[an, bn], we now show that f(x) = 0.
.2
Use the Intermediate Value Theorem to prove that if b > 0 and n is
an odd positive integer, then b has an nth root‚Äîthat is, there exists
r ‚ààR such that rn = b. (Of course, this result also follows from our
deÔ¨Ånition of ax in Section 1; but it is instructive to see how it can be
derived by other means, such as the Intermediate Value Theorem.)
.3
Show that any polynomial equation
xn + an‚àí1xn‚àí1 + ¬∑ ¬∑ ¬∑ + a1x + a0 = 0
of odd degree n, with coeÔ¨Écients ak ‚ààR, has at least one real
solution.
.4
What can you say about a function f that is continuous on [0, 1] and
assumes only rational values?
.5
Let f, g be continuous functions on [0, 1] such that f(x) ‚àà[0, 1] for all
x, g(0) = 0, and g(1) = 1. Show that f(x) = g(x) for some x ‚àà[0, 1].
.6
Prove that there is no continuous function f : R ‚ÜíR that assumes
each real value exactly twice.
.7
Let f be continuous and one‚Äìone on an interval I; then f(I) is an
interval, by Corollary (1.4.12). Prove that
(i) either f is strictly increasing on I or else f is strictly decreasing
on I;
(ii) if a ‚ààI‚ó¶, then f(a) ‚ààf(I)‚ó¶;
(iii) f ‚àí1 is continuous on f(I).
(For (iii), show that f is sequentially continuous at each point of
f(I). You will need Corollary (1.2.8), Exercise (1.4.5: 6), and Exercise
(1.2.9: 4).)
Although the Intermediate Value Theorem has many applications, espe-
cially in the solution of equations, none of its proofs provides an algorithm
for constructing the point x with f(x) = y. This claim may come as a
surprise: for is not the interval‚Äìhalving proof in Exercise (1.4.13: 1) algo-
rithmic? Alas, it is not: for, as any good computer scientist knows, there
is no algorithm that enables us to decide, for given real numbers y and z,
whether y = z or y Ã∏= z. (For further discussion of these matters, see the
Prolog of [5], and pages 65‚Äì66 of [8].)

1.5 Calculus
53
1.5
Calculus
In this section we cover the fundamentals of the diÔ¨Äerential and integral
calculus of functions of one real variable. We do so rapidly, leaving many
details to the exercises, on the assumption that you will have seen much of
the material in elementary calculus courses.
Let I be an interval in R, x0 a point of I, and f a real‚Äìvalued function
whose domain includes I. We say that f is
‚Ä¢ diÔ¨Äerentiable on the left at x0 if its left-hand derivative at x0,
f ‚Ä≤(x‚àí
0 ) = lim
x‚Üíx‚àí
0
f(x) ‚àíf(x0)
x ‚àíx0
= lim
h‚Üí0‚àí
f(x0 + h) ‚àíf(x0)
h
,
exists;
‚Ä¢ diÔ¨Äerentiable on the right at x0 if its right-hand derivative at x0,
f ‚Ä≤(x+
0 ) = lim
x‚Üíx+
0
f(x) ‚àíf(x0)
x ‚àíx0
= lim
h‚Üí0+
f(x0 + h) ‚àíf(x0)
h
,
exists;
‚Ä¢ diÔ¨Äerentiable at x0 if x0 is an interior point of I and the derivative of
f at x0,
f ‚Ä≤(x0) = lim
x‚Üíx0
f(x) ‚àíf(x0)
x ‚àíx0
= lim
h‚Üí0
f(x0 + h) ‚àíf(x0)
h
,
exists.
It follows from Exercise (1.4.3: 2) that f is diÔ¨Äerentiable at an interior point
x0 of its domain if and only if f ‚Ä≤(x‚àí
0 ) and f ‚Ä≤(x+
0 ) exist and are equal, in
which case their common value is f ‚Ä≤(x0).
We say that f is diÔ¨Äerentiable on the interval I if it is
‚Äî diÔ¨Äerentiable at each interior point of I,
‚Äî diÔ¨Äerentiable on the right at the left endpoint of I if that point belongs
to I, and
‚Äî diÔ¨Äerentiable on the left at the right endpoint of I if that point belongs
to I.
Higher‚Äìorder derivatives of f are deÔ¨Åned inductively, as follows.
f (0) = f,
f (1) = f ‚Ä≤,
f (2) = f ‚Ä≤‚Ä≤ = (f ‚Ä≤)‚Ä≤,
f (3) = f ‚Ä≤‚Ä≤‚Ä≤ = (f ‚Ä≤‚Ä≤)‚Ä≤,
f (n+1) = (f (n))‚Ä≤
(n ‚â•3).

54
1. Analysis on the Real Line
If the nth derivative f (n)(x) exists, then f is said to be n‚Äìtimes dif-
ferentiable at x; if f (n)(x) exists for each positive integer n, then f is
said to be inÔ¨Ånitely diÔ¨Äerentiable at x. DeÔ¨Ånitions of notions such as nth
right‚Äìhand derivative, n‚Äìtimes diÔ¨Äerentiable on an interval, and inÔ¨Ånitely
diÔ¨Äerentiable on an interval are formulated analogously.
(1.5.1) Exercises
.1
Prove that if f is diÔ¨Äerentiable at x0, then it is continuous at x0. Give
an example of a function f : R ‚ÜíR such that f ‚Ä≤(0‚àí) and f ‚Ä≤(0+)
both exist but f is not continuous at 0.
.2
For each x ‚ààR write
œÅ(x, Z) = inf {|x ‚àín| : n ‚ààZ}
and
f(x) =
‚àû

n=0
œÅ(10nx, Z)
10n
.
Prove that f is continuous, but nowhere diÔ¨Äerentiable, on R. (For
continuity use Exercise (1.4.5: 10). To show that f is not diÔ¨Äeren-
tiable at x, it is enough to take 0 ‚â§x < 1. Let 0.d1d2 . . . be a deci-
mal expansion of x, the terminating expansion if there is one. DeÔ¨Åne
hk to be ‚àí10‚àík if ak = 4 or 9, and 10‚àík otherwise, and consider
h‚àí1
k
(f(x + hk) ‚àíf(x)) .)
This example is due to van der Waerden [54]. Weierstrass, in a lecture
to the Berlin Academy in 1872, gave the Ô¨Årst example of a continuous,
nowhere diÔ¨Äerentiable function: namely,
f(x) =
‚àû

n=1
an cos(bnœÄx),
where 0 < a < 1, b is an odd positive integer, and ab > 1 + 3œÄ/2; for
a discussion of a special case of Weierstrass‚Äôs example, see [28], pages
38‚Äì41.
.3
Prove that if f is diÔ¨Äerentiable at x, then
f ‚Ä≤(x) =
lim
h,k‚Üí0+
f(x + h) ‚àíf(x ‚àík)
h + k
.
Give an example of a function f where limh‚Üí0 ((f(h) ‚àíf(‚àíh)) /2h)
exists but f is not diÔ¨Äerentiable at 0.
.4
Let f(x) = xn, where n is an integer. Using the deÔ¨Ånition of
‚ÄúdiÔ¨Äerentiable‚Äù, prove that f ‚Ä≤(x) = nxn‚àí1 for all x ‚ààR.

1.5 Calculus
55
.5
Let f and g be diÔ¨Äerentiable at a. Prove that f +g, f ‚àíg, cf (c ‚ààR),
and fg are diÔ¨Äerentiable at a, and that
(f + g)‚Ä≤(a) = f ‚Ä≤(a) + g‚Ä≤(a),
(f ‚àíg)‚Ä≤(a) = f ‚Ä≤(a) ‚àíg‚Ä≤(a),
(cf)‚Ä≤ (a) = cf ‚Ä≤(a),
(fg)‚Ä≤(a) = f(a)g‚Ä≤(a) + f ‚Ä≤(a)g(a).
.6
Under the conditions of the last exercise, suppose also that g(a) Ã∏= 0.
Give two proofs that f/g is diÔ¨Äerentiable at a, and that
f
g
‚Ä≤
(a) = f ‚Ä≤(a)g(a) ‚àíf(a)g‚Ä≤(a)
g(a)2
.
.7
Using the exponential series, prove that exp‚Ä≤(0) = 1. Hence prove
that exp‚Ä≤(x) = exp(x) for all x ‚ààR.
Our next proposition, the Chain Rule, is possibly the most troublesome
result of elementary calculus.
(1.5.2) Proposition.
If f is diÔ¨Äerentiable at a, and g is diÔ¨Äerentiable
at f(a), then g ‚ó¶f is diÔ¨Äerentiable at a, and
(g ‚ó¶f)‚Ä≤ (a) = g‚Ä≤ (f(a)) ¬∑ f ‚Ä≤(a).
Proof.
Setting b = f(a), deÔ¨Åne
h(u) =
Ô£±
Ô£¥
Ô£≤
Ô£¥
Ô£≥
g(u) ‚àíg(b)
u ‚àíb
if u Ã∏= b
g‚Ä≤(b)
if u = b.
For all x Ã∏= a in some neighbourhood of a we have
g(f(x)) ‚àíg(f(a))
x ‚àía
= (h ‚ó¶f) (x) ¬∑ f(x) ‚àíf(a)
x ‚àía
.
(1)
(Note that in verifying this identity, we must consider the possibility that
f(x) = f(a).) Since g is diÔ¨Äerentiable at b, h is continuous at b. Moreover,
f is diÔ¨Äerentiable, and therefore (by Exercise (1.5.1: 1)) continuous, at a;
so h ‚ó¶f is continuous at a, by Exercise (1.4.5: 5). Hence
lim
x‚Üía

(h ‚ó¶f) (x) ¬∑ f(x) ‚àíf(a)
x ‚àía

= lim
x‚Üía (h ‚ó¶f) (x) ¬∑ lim
x‚Üía
f(x) ‚àíf(a)
x ‚àía
= (h ‚ó¶f) (a) ¬∑ f ‚Ä≤(a)
= g‚Ä≤(b)f ‚Ä≤(a).

56
1. Analysis on the Real Line
The result now follows immediately from (1).
2
(1.5.3) Proposition.
Let I be an open interval, f a one‚Äìone continuous
function on I, and a ‚ààI, such that f ‚Ä≤(a) exists and is nonzero. Then the
inverse function f ‚àí1 is diÔ¨Äerentiable at f(a), and

f ‚àí1	‚Ä≤ (f(a)) =
1
f ‚Ä≤(a).
Proof.
Note that J = f(I) is an interval, by Theorem (1.4.11) and
Proposition (1.3.3); moreover, by Exercise (1.4.13: 7), f(a) is an interior
point of J and f ‚àí1 is continuous on J. Let (yn) be any sequence in J\{f(a)}
that converges to f(a), and write xn = f ‚àí1(yn); then xn Ã∏= a and
lim
n‚Üí‚àûf ‚àí1(xn) = f ‚àí1(f(a)) = a.
Since f is one‚Äìone, it follows that
f(xn) ‚àíf(a)
xn ‚àía
Ã∏= 0;
whence
lim
n‚Üí‚àû
f ‚àí1(yn) ‚àíf ‚àí1(f(a))
yn ‚àíf(a)
= lim
n‚Üí‚àû
xn ‚àía
f(xn) ‚àíf(a) =
1
f ‚Ä≤(a).
The desired conclusion now follows from Exercise (1.4.3: 6).
2
(1.5.4) Exercises
.1
Prove that log‚Ä≤(x) = 1/x for each x > 0.
.2
Let f(x) = xr, where r ‚ààR. Prove that f ‚Ä≤(x) = rxr‚àí1. (Note that
xr = exp(r log x).)
.3
Let f be a strictly increasing function on an interval I, and let a be
a point of I such that f ‚Ä≤(a+) exists and is nonzero. Prove that the
inverse function f ‚àí1 is diÔ¨Äerentiable on the right at f(a), and that

f ‚àí1	‚Ä≤ 
f(a)+	
=
1
f ‚Ä≤(a+).
.4
Let f be continuous on the compact interval I = [a, b] and diÔ¨Äer-
entiable on (a, b). Prove that if Œæ ‚àà(a, b) and f(Œæ) = inf f, then
f ‚Ä≤(Œæ) = 0. Hence prove that if f(a) = f(b), then there exists Œæ ‚àà(a, b)
such that f ‚Ä≤(Œæ) = 0 (Rolle‚Äôs Theorem).

1.5 Calculus
57
.5
Let f be continuous on the compact interval [a, b] and n‚Äìtimes diÔ¨Äer-
entiable on (a, b). Suppose that there exist n + 1 distinct points x of
(a, b) at which f(x) = 0. Show that f (n)(x) = 0 for some x ‚àà(a, b).
.6
Use Rolle‚Äôs Theorem to prove the Mean Value Theorem: if f is con-
tinuous on the compact interval [a, b] and diÔ¨Äerentiable on (a, b), then
there exists Œæ ‚àà(a, b) such that f(b) ‚àíf(a) = f ‚Ä≤(Œæ)(b ‚àía).
.7
Let f be diÔ¨Äerentiable on an interval I. Prove that
(i) if f ‚Ä≤(x) ‚â•0 for all x ‚ààI, then f is increasing on I;
(ii) if f ‚Ä≤(x) > 0 for all x ‚ààI, then f is strictly increasing on I;
(iii) if f ‚Ä≤(x) = 0 for all x ‚ààI, then f is constant on I.
.8
Let f be diÔ¨Äerentiable on an interval I, with f ‚Ä≤(x) Ã∏= 0 for all x ‚ààI.
Prove that f is one‚Äìone, and that either f ‚Ä≤(x) ‚â•0 for all x ‚ààI or
else f ‚Ä≤(x) ‚â§0 for all x ‚ààI.
.9
Prove that if f is diÔ¨Äerentiable on an interval I, then the range of f ‚Ä≤
has the intermediate value property on I. (Let f ‚Ä≤(x1) < y < f ‚Ä≤(x2),
consider g(x) = f(x) ‚àíyx, and use the preceding exercise.)
.10 Prove Cauchy‚Äôs Mean Value Theorem: if f, g are continuous on [a, b]
and diÔ¨Äerentiable on (a, b), then there exists Œæ ‚àà(a, b) such that
(f(b) ‚àíf(a)) g‚Ä≤(Œæ) = (g(b) ‚àíg(a)) f ‚Ä≤(Œæ).
(Consider the function x ‚Üí(f(b) ‚àíf(a)) g(x) ‚àí(g(b) ‚àíg(a)) f(x).)
.11 Let f, g be continuous on [a, b] and diÔ¨Äerentiable on (a, b), let x0 ‚àà
[a, b], and suppose that
(i) g‚Ä≤(x) Ã∏= 0 for all x Ã∏= x0,
(ii) f(x0) = g(x0) = 0,
(iii) l = lim
x‚Üíx0 (f ‚Ä≤(x) /g‚Ä≤(x)) exists.
Prove that limx‚Üíx0 (f(x) /g(x)) = l. (l‚ÄôHÀÜopital‚Äôs Rule. Use the pre-
ceding exercise to show that if (xn) is any sequence in [a, b] \ {x0}
that converges to x0, then f(xn)/g(xn) ‚Üíl as n ‚Üí‚àû.)
.12 Let g be twice diÔ¨Äerentiable at 0, with g(0) = g‚Ä≤(0) = 0. Find f ‚Ä≤(0),
where f is deÔ¨Åned by
f(x) =
Ô£±
Ô£¥
Ô£≤
Ô£¥
Ô£≥
g(x)
x
if x Ã∏= 0,
0
if x = 0.

58
1. Analysis on the Real Line
The following generalisation of the Mean Value Theorem is one of the
most useful results of the diÔ¨Äerential calculus. Unfortunately, it seems
to have no completely transparent, natural proof; all the proofs in the
literature use some trick or other to obtain the desired conclusion.
(1.5.5) Taylor‚Äôs Theorem.
Let f be (N +1)‚Äìtimes diÔ¨Äerentiable on an
interval I, and let a ‚ààI. Then for each x ‚ààI there exists Œæ between a and
x such that
f(x) =
N

n=0
f (n)(a)
n!
(x ‚àía)n + f (N+1)(Œæ)
N!
(x ‚àíŒæ)N(x ‚àía).
Proof.
Fixing x ‚ààI, without loss of generality we take a < x. Consider
the function g : [a, x] ‚ÜíR deÔ¨Åned by
g(t) = f(x) ‚àí
N

n=0
f (n)(t)
n!
(x ‚àít)n.
Using Exercises (1.5.1: 4 and 5), we have
g‚Ä≤(t) = ‚àíf ‚Ä≤(t) ‚àí
N

n=1
f (n+1)(t)
n!
(x ‚àít)n ‚àíf (n)(t)
(n ‚àí1)! (x ‚àít)n‚àí1

= ‚àíf (N+1)(t)
N!
(x ‚àít)N.
Applying the Mean Value Theorem (Exercise (1.5.4: 6)), we obtain Œæ ‚àà
(a, x) such that
‚àíf (N+1)(Œæ)
N!
(x ‚àíŒæ)N = g‚Ä≤(Œæ) = g(x) ‚àíg(a)
x ‚àía
.
Then, as g(x) = 0,
g(a) = f (N+1)(Œæ)
N!
(x ‚àíŒæ)N(x ‚àía),
which is equivalent to the desired result.
2
The expression
N

n=0
f (n)(a)
n!
(x ‚àía)n
is called the Taylor polynomial of degree n at a, and
f(x) ‚àí
N

n=0
f (n)(a)
n!
(x ‚àía)n

1.5 Calculus
59
is called the remainder term of order n in Taylor‚Äôs Theorem. The theorem,
as stated, has the remainder term in the Cauchy form:
f (N+1)(Œæ)
N!
(x ‚àíŒæ)N(x ‚àía).
The next corollary gives us an alternative form‚Äîthe Lagrange form‚Äîof
the remainder.
(1.5.6) Corollary.
Under the hypotheses of Taylor‚Äôs Theorem, for each
x ‚ààI there exists t between a and x such that
f(x) =
N

n=0
f (n)(a)
n!
(x ‚àía)n + f (N+1)(t)
(N + 1)! (x ‚àía)N+1.
Proof.
Again we take a < x and use a trick. With g the function in-
troduced in the preceding proof of Taylor‚Äôs Theorem, we apply Cauchy‚Äôs
Mean Value Theorem (Exercise (1.5.4: 10)) to g and t ‚Üí(x ‚àít)N+1. Since
g(x) = 0, this yields t ‚àà(a, x) such that
g(a)
(x ‚àía)N+1 =
f (N+1)(t)
N!
(x ‚àít)N
(N + 1)(x ‚àít)N .
Hence
g(a) = f (N+1)(t)
(N + 1)! (x ‚àía)N+1,
from which the required conclusion follows.
2
(1.5.7) Proposition.
Let I be the interval of convergence of the power
series ‚àû
n=0 anxn, and let f(x) be the sum of the series on I. Then f is
diÔ¨Äerentiable, and f ‚Ä≤(x) = ‚àû
n=1 nanxn‚àí1, at each interior point of I.
Proof.
We Ô¨Årst recall from Exercise (1.2.16: 16) that the power series
‚àû
n=0 anxn and ‚àû
n=1 nanxn‚àí1 have the same radius of convergence R.
Given x ‚ààI‚ó¶, let
r = 1
2(|x| + R).
Then ‚àû
n=1 nanrn‚àí1 converges absolutely, by Exercise (1.2.16: 10). Given
Œµ > 0, choose N such that ‚àû
n=N+1 n |an| rn‚àí1 < Œµ. If h Ã∏= 0 and |x + h| <
r, then, using the Mean Value Theorem, for each n ‚â•N + 1 we obtain Œ∏n
between 0 and h such that
(x + h)n ‚àíxn
h
= n(x + Œ∏n)n‚àí1.

60
1. Analysis on the Real Line
Hence
     
‚àû

n=N+1
an
(x + h)n ‚àíxn
h
‚àínxn‚àí1
     
‚â§
‚àû

n=N+1
|an|
    
(x + h)n ‚àíxn
h
‚àínxn‚àí1
    
‚â§
‚àû

n=N+1
n |an|
  (x + Œ∏n)n‚àí1 ‚àíxn‚àí1  
‚â§
‚àû

n=N+1
n |an|

|x + Œ∏n|n‚àí1 + |x|n‚àí1
‚â§2
‚àû

n=N+1
n |an| rn‚àí1
< 2Œµ.
It follows that
     
f(x + h) ‚àíf(x)
h
‚àí
‚àû

n=1
nanxn‚àí1
     
‚â§
     
N

n=1
an
(x + h)n ‚àíxn
h
‚àínxn‚àí1
     
+
     
‚àû

n=N+1
an
(x + h)n ‚àíxn
h
‚àínxn‚àí1
     
<
N

n=1
|an|
    
(x + h)n ‚àíxn
h
‚àínxn‚àí1
    + 2Œµ.
Now, there exists Œ¥ > 0 such that if 0 < |h| < Œ¥, then |x + h| < r and
    
(x + h)n ‚àíxn
h
‚àínxn‚àí1
    <

1 +
N

n=1
|an|
‚àí1
Œµ
(1 ‚â§n ‚â§N).
For such h we then have
     
f(x + h) ‚àíf(x)
h
‚àí
‚àû

n=1
nanxn‚àí1
     < 3Œµ.
Since Œµ > 0 is arbitrary, the result follows.
2

1.5 Calculus
61
(1.5.8) Exercises
.1
Let f be inÔ¨Ånitely diÔ¨Äerentiable on an interval I, and suppose that
there exists M > 0 such that
  f (n)(x)
  ‚â§M for all suÔ¨Éciently large
n and all x ‚ààI. Given a ‚ààI, prove that the Taylor expansion, or
Taylor series, of f about a,
‚àû

n=0
f (n)(a)
n!
(x ‚àía)n,
converges to f(x) for each x ‚ààI.
.2
Find the Taylor expansion of exp(‚àíx2) about 0. For what values of
x does this expansion converge to exp(‚àíx2)?
.3
Prove that f(x) = exp(x) deÔ¨Ånes the unique diÔ¨Äerentiable function
such that f(0) = 1 and f ‚Ä≤(x) = f(x) for all x ‚ààR.
.4
Let R > 0, and let ‚àû
n=0 anxn, ‚àû
n=0 bnxn be power series whose
intervals of convergence include (‚àíR, R). Suppose that ‚àû
n=0 anxn =
‚àû
n=0 bnxn for all x ‚àà(‚àíR, R). Show that an = bn for all n.
.5
Prove that sin‚Ä≤ x = cos x and that cos‚Ä≤ x = ‚àísin x for each x ‚ààR.
(See Exercise (1.4.5: 14) for the deÔ¨Ånition of sin and cos .)
.6
Prove the trigonometric addition formulae:
cos(a + b)
=
cos a cos b ‚àísin a sin b,
sin(a + b)
=
sin a cos b + cos a sin b.
(DeÔ¨Åne
F(x) = (cos(x + b) ‚àícos x cos b + sin x sin b)2
+ (sin(x + b) ‚àísin x cos b ‚àícos x sin b)2
and consider F ‚Ä≤(x).)
.7
Prove that cos is a strictly decreasing function in the interval [0, 2],
and that there is a unique p such that p/2 ‚àà[0, 2] and cos (p/2) = 0.
Using the addition formulae from the preceding exercise, prove also
that cos(x + 2p) = cos x and sin(x + 2p) = sin x for all x ‚ààR. (Of
course, the number p is more usually denoted by œÄ.)
.8
Derive the binomial series
(1 + x)Œ± =
‚àû

n=0
Œ±
n

xn

62
1. Analysis on the Real Line
for ‚àí1 < x < 1, where
Œ±
0
	
= 1 and for n ‚â•1,
Œ±
n

= Œ±(Œ± ‚àí1)(Œ± ‚àí2) ¬∑ ¬∑ ¬∑ (Œ± ‚àín + 1)
n!
.
(First show that the series in question does converge for |x| < 1. Then
apply Taylor‚Äôs Theorem with the Lagrange form of the remainder
when 0 ‚â§x < 1, and with the Cauchy form when ‚àí1 < x < 0.)
.9
Let p ‚â•2, 1/p + 1/q = 1, and 0 < c < 1. Prove that
(1 + c)q + (1 ‚àíc)q ‚àí2 (1 + cp)q‚àí1 ‚â•0.
(Use the binomial series.)
.10 Let x, y ‚ààR, and let p, q be positive numbers with 1/p + 1/q = 1.
Use the preceding exercise to prove that
|x + y|q + |x ‚àíy|q ‚â§2 (|x|p + |y|p)q‚àí1
if 1 < p ‚â§2, and that
|x + y|q + |x ‚àíy|q ‚â•2 (|x|p + |y|p)q‚àí1
if p ‚â•2.
Although the Riemann integral is taught in elementary calculus courses,
for the best part of a century, following the development of a more sophis-
ticated integral by Lebesgue and others, it has had little practical value.
Indeed, Dieudonn¬¥e, in characteristically forthright mood ([13], page 142),
claims that the Riemann integral ‚Äúhas at best the importance of a mildly
interesting exercise in the general theory of measure and integration. Only
the stubborn conservatism of academic tradition could freeze it into a reg-
ular part of the curriculum, long after it had outlived its historical im-
portance.‚Äù We believe, nevertheless, that it is worth presenting a rigorous
development of the Riemann integral for both historical and paedagogical
reasons; but we skip lightly over this material, leaving much of it to the
exercises. We discuss the Lebesgue integral in Chapter 2.
By a partition of a compact interval I = [a, b] we mean a Ô¨Ånite sequence
P = (x0, x1, . . . , xn) of points of I such that
a = x0 ‚â§x1 ‚â§¬∑ ¬∑ ¬∑ ‚â§xn = b.
The real number
max {xi+1 ‚àíxi : 0 ‚â§i ‚â§n ‚àí1}
is called the mesh of the partition. Loosely, we identify P with the set
{x0, . . . , xn}. A partition Q is called a reÔ¨Ånement of P if P ‚äÇQ.

1.5 Calculus
63
Now let f : I ‚ÜíR a bounded function, and for 0 ‚â§i ‚â§n ‚àí1 deÔ¨Åne
mi(f) = inf {f(x) : xi ‚â§x ‚â§xi+1} ,
Mi(f) = sup {f(x) : xi ‚â§x ‚â§xi+1} .
The real numbers
L(f, P) =
n‚àí1

i=0
mi(f) (xi+1 ‚àíxi) ,
U(f, P) =
n‚àí1

i=0
Mi(f) (xi+1 ‚àíxi)
are called the lower sum and upper sum, respectively, for f and P. Since
(b ‚àía) inf f ‚â§L(f, P) ‚â§U(f, P) ‚â§(b ‚àía) sup f,
the lower integral of f,
$ b
a
f = sup {L(f, P) : P is a partition of [a, b]} ,
and the upper integral of f,
$ b
a
f = inf {U(f, P) : P is a partition of [a, b]} ,
exist.
(1.5.9) Lemma.
Let f : [a, b] ‚ÜíR be bounded, and let P, Q be partitions
of [a, b]. Then L(f, P) ‚â§U(f, Q).
Proof.
Take P = (x0, . . . , xn), and Ô¨Årst consider the case where Q =
P ‚à™{Œæ} for some point Œæ /‚ààP. Choose k such that xk < Œæ < xk+1, and
write
Œ± = inf {f(x) : xk ‚â§x ‚â§Œæ} ,
Œ≤ = inf {f(x) : Œæ ‚â§x ‚â§xk+1} .
Then mk(f) = min {Œ±, b} , so
L(f, P) =
n‚àí1

i=0,
iÃ∏=k
mi(f) (xi+1 ‚àíxi) + mk(f)(xk+1 ‚àíxk)
=
n‚àí1

i=0,
iÃ∏=k
mi(f) (xi+1 ‚àíxi) + mk(f)(Œæ ‚àíxk) + mk(f)(xk+1 ‚àíŒæ)

64
1. Analysis on the Real Line
‚â§
n‚àí1

i=0,
iÃ∏=k
mi(f) (xi+1 ‚àíxi) + Œ±(Œæ ‚àíxk) + Œ≤(xk+1 ‚àíŒæ)
= L(f, Q).
Next, if Q is a reÔ¨Ånement of P, then Q = P ‚à™{Œæ1, . . . , Œæm} for some distinct
points Œæk /‚ààP, so
L(f, P) ‚â§L(f, P ‚à™{Œæ1})
‚â§L(f, P ‚à™{Œæ1, Œæ2})
‚â§¬∑ ¬∑ ¬∑
‚â§L(f, Q).
Similar arguments show that U(f, Q) ‚â§U(f, P) when Q is a reÔ¨Ånement of
P.
Now consider any two partitions P, Q of [a, b]. Since P ‚à™Q is a reÔ¨Ånement
of both P and Q, we have
L(f, P) ‚â§L(f, P ‚à™Q) ‚â§U(f, P ‚à™Q) ‚â§U(f, Q).
2
It follows from this lemma that, as we might have anticipated,
$ b
a
f ‚â§
$ b
a
f.
We say that f is Riemann integrable over I if its lower and upper integrals
coincide, in which case we deÔ¨Åne the Riemann integral of f over I to be
$ b
a
f =
$ b
a
f =
$ b
a
f.
We also deÔ¨Åne
$ a
b
f = ‚àí
$ b
a
f
when f is Riemann integrable over [a, b] .
(1.5.10) Exercises
.1
Let f : [a, b] ‚ÜíR be bounded. Prove that f is Riemann integrable
if and only if for each Œµ > 0 there exists a partition P of [a, b] such
that U(f, P) ‚àíL(f, P) < Œµ.
.2
Let f(x) = x2 on [0, 1], and for each positive integer n let Pn be
the partition of [0, 1] consisting of the points i/n (0 ‚â§i ‚â§n). By
considering L(f, Pn) and U(f, Pn), show that f is Riemann integrable
and that
% 1
0 f = 1 /3.

1.5 Calculus
65
.3
Prove that for any n ‚ààN the function x ‚Üíxn is Riemann integrable
over [a, b]. (Use the Ô¨Årst exercise in this set.)
.4
Prove that an increasing bounded function f : [a, b] ‚ÜíR is Riemann
integrable.
.5
Prove that a continuous function f : [a, b] ‚ÜíR is Riemann integrable.
(Use the Uniform Continuity Theorem (Exercise (1.4.8: 8)).)
.6
DeÔ¨Åne f : [0, 1] ‚ÜíR by
f(x) =
Ô£±
Ô£≤
Ô£≥
1
if x is rational
0
if x is irrational.
Prove that f is not Riemann integrable.
.7
DeÔ¨Åne f : [0, 1] ‚ÜíR by
f(x) =
Ô£±
Ô£≤
Ô£≥
0
if x = 0 or x is irrational
1
q
if x = p
q for relatively prime positive integers p, q.
Given Œµ > 0, let t0 = 0; let t1, . . . , tm‚àí1 be, in increasing order, the
points of (0, 1) that have the form p/q where p, q are relatively prime
positive integers with 0 < q < 2/Œµ; and let tm = 1. Taking x0 = 0,
construct inductively a partition P = (x0, x1, . . . , x2m+1) of [0, 1] such
that
x2k < tk < x2k+1 < 1
2(tk + tk+1),
x2k+1 ‚àíx2k <
Œµ
2(m + 1),
and x2m+1 = 1. Show that if x2k‚àí1 ‚â§x ‚â§x2k, then f(x) < Œµ/2; that
U(f, P) < Œµ; and hence that f is Riemann integrable.
.8
Prove that the composition of two Riemann integrable functions need
not be Riemann integrable. (Note the preceding two exercises.)
Since, by Exercise (1.5.10: 3), f(x) = x deÔ¨Ånes a Riemann integrable
function over [a, b], the next result generalises Exercise (1.5.10: 5). It should
also be compared with Exercise (1.5.10: 8).
(1.5.11) Proposition.
Let f : [a, b] ‚ÜíJ be Riemann integrable, where
J is a compact interval, and let g : J ‚ÜíR be continuous. Then g ‚ó¶f is
Riemann integrable.
Proof.
Let
K = sup {g(y) : y ‚ààJ} ,

66
1. Analysis on the Real Line
which exists by Theorem (1.4.9), and write I = [a, b] . According to the
Uniform Continuity Theorem (Exercise (1.4.8: 8)), for each Œµ > 0 there
exists Œ¥ such that
0 < Œ¥ <
Œµ
b ‚àía + 2K
and such that
|g(x) ‚àíg(y)| <
Œµ
b ‚àía + 2K
whenever x, y ‚ààJ and |x ‚àíy| < Œ¥. Choose a partition P = (x0, . . . , xn) of
I such that
U(f, P) ‚àíL(f, P) < Œ¥2
(this is possible in view of Exercise (1.5.10: 1)), and write P = S ‚à™T, where
S = {i : Mi(f) ‚àími(f) < Œ¥} ,
T = {i : Mi(f) ‚àími(f) ‚â•Œ¥} .
If i ‚ààS and x, x‚Ä≤ ‚àà[xi, xi+1] , then |f(x) ‚àíf(x‚Ä≤)| < Œ¥ and so
|g ‚ó¶f(x) ‚àíg ‚ó¶f(x‚Ä≤)| <
Œµ
b ‚àía + 2K .
Hence
Mi(g ‚ó¶f) ‚àími(g ‚ó¶f) ‚â§
Œµ
b ‚àía + 2K ,
and therefore

i‚ààS
(Mi(g ‚ó¶f) ‚àími(g ‚ó¶f)) (xi+1 ‚àíxi) ‚â§
Œµ
b ‚àía + 2K
n‚àí1

i=0
(xi+1 ‚àíxi)
=
Œµ(b ‚àía)
b ‚àía + 2K .
On the other hand,

i‚ààT
(xi+1 ‚àíxi) ‚â§Œ¥‚àí1 
i‚ààT
(Mi(f) ‚àími(f)) (xi+1 ‚àíxi)
‚â§Œ¥‚àí1 (U(f, P) ‚àíL(f, P))
< Œ¥,
so

i‚ààT
(Mi(g ‚ó¶f) ‚àími(g ‚ó¶f)) (xi+1 ‚àíxi) ‚â§2K

i‚ààT
(xi+1 ‚àíxi)
< 2KŒ¥
<
2KŒµ
b ‚àía + 2K .

1.5 Calculus
67
It now follows that
U( g ‚ó¶f, P) ‚àíL( g ‚ó¶f, P )
=

i‚ààS
(Mi(g ‚ó¶f) ‚àími(g ‚ó¶f)) (xi+1 ‚àíxi)
+

i‚ààT
(Mi(g ‚ó¶f) ‚àími(g ‚ó¶f)) (xi+1 ‚àíxi)
<
Œµ(b ‚àía)
b ‚àía + 2K +
2KŒµ
b ‚àía + 2K = Œµ.
Reference to Exercise (1.5.10: 1) completes the proof.
2
Let f : [a, b] ‚ÜíR be a bounded function, and P = (x0, . . . , xn) a
partition of [a, b]. Any expression of the form
n‚àí1

i=0
f(Œæi)(xi+1 ‚àíxi),
where Œæi ‚àà[xi, xi+1] for each i, is called a Riemann sum for f (relative to
P).
If f is Riemann integrable, geometric arguments like those presented in
elementary calculus courses lead us to believe that if the partition P has
small mesh, then the corresponding Riemann sums will closely approximate
% b
a f. This expectation is fulÔ¨Ålled in the Ô¨Årst of the next set of exercises.
(1.5.12) Exercises
.1
Prove that a bounded function f : [a, b] ‚ÜíR is Riemann integrable if
and only if there exists a real number Œõ with the following property.
For each Œµ > 0 there exists Œ¥ > 0 such that |Œ£ ‚àíŒõ| < Œµ whenever
‚Äî P is a partition of [a, b] with mesh less than Œ¥, and
‚Äî Œ£ is a Riemann sum for f relative to P.
Prove that, in that case, Œõ =
% b
a f.
.2
Let f, g be Riemann integrable functions on [a, b], and let Œª ‚ààR.
Prove that f + g and Œªf are Riemann integrable, and that
$ b
a
(f + g)
=
$ b
a
f +
$ b
a
g,
$ b
a
(Œªf)
=
Œª
$ b
a
f.
(Use the preceding exercise.)

68
1. Analysis on the Real Line
.3
Let f : [a, b] ‚ÜíR be bounded, and a ‚â§c ‚â§b. Prove that f is
Riemann integrable over [a, b] if and only if it is Riemann integrable
over both [a, c] and [c, b], in which case
$ b
a
f =
$ c
a
f +
$ b
c
f.
.4
Let f : [a, b] ‚ÜíR be Riemann integrable. Prove that f + = f ‚à®0,
f ‚àí= (‚àíf) ‚à®0, and |f| are Riemann integrable, and that
   
% b
a f
   ‚â§
% b
a |f| . Prove also that if |f(x)| ‚â§M for all x ‚àà[a, b], then
    
$ y
x
f
    ‚â§M |x ‚àíy|
for all x, y ‚àà[a, b].
.5
Let f and g be Riemann integrable functions on [a, b]. Give two proofs
that the product function fg is Riemann integrable over [a, b]. (For
one proof, Ô¨Årst take f ‚â•0 and use Exercise (1.5.10: 1). For a second
proof, note that fg = 1
4

(f + g)2 ‚àí(f ‚àíg)2	
.)
.6
Let f be a nonvanishing Riemann integrable function on the compact
interval I = [a, b], and suppose that 1/f is bounded on I. Show that
1/f is Riemann integrable over I.
.7
Prove that if f : [a, b] ‚ÜíR is continuous and nonnegative, and
% b
a f = 0, then f(x) = 0 for all x ‚àà[a, b].
What makes the calculation of integrals feasible is the connection be-
tween integration and diÔ¨Äerentiation. There are various expressions of this
connection, each of which may lay claim to the historic title of Fundamental
Theorem of Calculus. Here is one strong version of that theorem.
(1.5.13) Theorem.
If F is diÔ¨Äerentiable on [a, b], and F ‚Ä≤ is Riemann
integrable over [a, b], then
$ b
a
F ‚Ä≤ = F(b) ‚àíF(a).
Proof.
Let P = (x0, . . . , xn) be any partition of [a, b]. By the Mean Value
Theorem, for each i there exists Œæi ‚àà(xi, xi+1) such that
F(xi+1) ‚àíF(xi) = F ‚Ä≤(Œæi)(xi+1 ‚àíxi).

1.5 Calculus
69
Hence
n‚àí1

i=0
F ‚Ä≤(Œæi)(xi+1 ‚àíxi) =
n‚àí1

i=0
(F(xi+1) ‚àíF(xi)) = F(b) ‚àíF(a).
Since P is any partition of [a, b], the result now follows from Exercise
(1.5.12: 1).
2
Let F, f be two mappings of [a, b] into R. We say that F is a primitive,
or antiderivative, of f on [a, b] if F ‚Ä≤(x) = f(x) for all x ‚àà[a, b]. In view of
the Fundamental Theorem of Calculus (1.5.13), there is an obvious strat-
egy for calculating the Riemann integral of a function f : [a, b] ‚ÜíR: Ô¨Årst
Ô¨Ånd a primitive F of f, and then compute F(b) ‚àíF(a). Of course, as any
student of calculus quickly learns, Ô¨Ånding primitives of Riemann integrable
functions is often a (literally) tricky business; moreover, the class of Rie-
mann integrable functions f for which there exist primitives expressible in
terms of elementary functions is relatively small [41]. So the Fundamental
Theorem of Calculus has severe practical limitations, which have led to the
development of highly accurate, fast methods of numerical integration (see,
for example, [26]).
(1.5.14) Exercises
.1
Let f be Riemann integrable over I = [a, b], and deÔ¨Åne
F(x) =
$ x
a
f
(a ‚â§x ‚â§b).
Prove that F is continuous on I. Prove also that if x0 ‚ààI and
lim
x‚Üíx0, x‚ààI f(x) = f(x0),
then
lim
x‚Üíx0, x‚ààI
F(x) ‚àíF(x0)
x ‚àíx0
= f(x0).
In particular, we obtain a result which is also sometimes called the
Fundamental Theorem of Calculus: if f is continuous on [a, b], then
F is diÔ¨Äerentiable on [a, b], F ‚Ä≤(x) = f(x) for all x ‚àà(a, b), F ‚Ä≤(a+) =
f(a), and F ‚Ä≤(b‚àí) = f(b).
.2
Let the power series f(x) = ‚àû
n=0 anxn have radius of convergence
R (which could be ‚àû). Prove that for each x ‚àà(‚àíR, R),
$ x
0
f =
‚àû

n=0
an
n + 1xn+1.

70
1. Analysis on the Real Line
.3
By considering
(1 + x)(1 ‚àíx + x2 ‚àíx3 + ¬∑ ¬∑ ¬∑ + (‚àí1)nxn),
show that
1
1 + x =
‚àû

n=0
(‚àí1)nxn
(‚àí1 < x < 1).
Hence Ô¨Ånd power series expansions for log(1‚àíx) and (1‚àíx)‚àí1 log(1‚àí
x) on (‚àí1, 1). Then show that the identity
1
2 (log(1 ‚àíx))2 = 1
2x2 + 1
3

1 + 1
2
	
x3 + 1
4

1 + 1
2 + 1
3
	
x4 + ¬∑ ¬∑ ¬∑
is valid for each x ‚àà(‚àí1, 1].
.4
In this exercise you will prove that œÄ2, and therefore œÄ itself, is
irrational. Given a positive integer n, deÔ¨Åne
œÜ(x) = 1
n!xn(1 ‚àíx)n.
Prove that
(i) œÜ(k)(0) = 0 for k < n or k > 2n;
(ii) œÜ(k)(0) and œÜ(k)(1) are integers for all k ‚ààN.
Suppose that œÄ2 = p/q for some positive integers p, q, and deÔ¨Åne
F = qn
n

k=0
(‚àí1)2n‚àíkœÄ2(n‚àík)œÜ(2k).
Show that F(0) and F(1) are integers, and that
F ‚Ä≤‚Ä≤(x) + œÄ2F(x) = œÄ2pnœÜ(x).
Setting
G(x) = F ‚Ä≤(x) sin œÄx ‚àíœÄF(x) cos œÄx,
show that
G‚Ä≤(x) = œÄ2pnœÜ(x) sin œÄx,
and hence that
œÄ
$ 1
0
pnœÜ(x) sin œÄx dx
is an integer. Finally, show that
0 < œÄ
$ 1
0
pnœÜ(x) sin œÄx dx < œÄpn
n!
for all positive integers n, and derive a contradiction.

1.5 Calculus
71
We end this chapter by sketching the development of a generalisation of
the Riemann integral. To do so we must Ô¨Årst introduce another important
class of functions on intervals.
In the rest of the section, unless we say otherwise, I = [a, b] is a compact
interval, and f a mapping of I into R. For all x, y ‚ààI with x ‚â§y we deÔ¨Åne
the variation of f over [x, y] to be
Tf(x, y) = sup
!n‚àí1

i=0
|f(xi+1) ‚àíf(xi)| : x = x0 ‚â§x1 ‚â§¬∑ ¬∑ ¬∑ ‚â§xn = y
"
if this quantity exists as a real number; we then say that f has bounded
variation on [x, y].
(1.5.15) Exercises
.1
Let f have bounded variation on I. Prove that
(i) f is bounded on I,
(ii) Tf(a, b) = Tf(a, x) + Tf(x, b) for all x ‚ààI, and
(iii) Tf(a, ¬∑) is an increasing function on I.
.2
Prove that f has bounded variation on I if and only if there exist
increasing functions g, h on I such that f = g ‚àíh. (For ‚Äúonly if‚Äù note
part (iii) of the preceding exercise.)
.3
Let f, g be functions of bounded variation on I. Prove that f + g,
Œªf (where Œª ‚ààR), and fg are of bounded variation, and that if
inf {|f(x)| : x ‚ààI} > 0, then 1/f is of bounded variation.
.4
DeÔ¨Åne f : [0, 1] ‚ÜíR by
f(x) =
Ô£±
Ô£≤
Ô£≥
x2 sin 1
x2
if 0 < x ‚â§1
0
if x = 0.
Prove that f is diÔ¨Äerentiable at each point of [0, 1] but does not have
bounded variation on [0, 1].
.5
Let f : I ‚ÜíR have bounded variation. Prove that the one-sided
limits f(x‚àí) and f(x+) exist at each point of (a, b), as do f(a+) and
f(b‚àí), and that the set of points of I at which f is discontinuous is
either empty or countable. (See Exercise (1.4.5: 8).)
.6
Let (fn) be a sequence of functions of bounded variation on I such
that f(x) = limn‚Üí‚àûfn(x) exists for each x ‚ààI. Prove that Tf(a, b) ‚â§

72
1. Analysis on the Real Line
lim inf Tfn(a, b). (First show that for any partition (x0, x1, . . . , xn) of
I and any positive integer k,
n‚àí1

i=0
|f(xi+1) ‚àíf(xi)| ‚â§Tfk(a, b) +
n‚àí1

i=0
|f(xi+1) ‚àífk(xi+1)|
+
n‚àí1

i=0
|f(xi) ‚àífk(xi)| .
Given Œµ > 0, then choose k appropriately.)
Now let Œ± : I ‚ÜíR be a function with bounded variation on I, P =
(x0, x1, . . . , xn) a partition of I, and f : I ‚ÜíR a bounded function. Any
expression of the form
n‚àí1

i=0
f(Œæi) (Œ±(xi+1) ‚àíŒ±(xi)) ,
where Œæi ‚àà[xi, xi+1] for each i, is called a Riemann‚ÄìStieltjes sum for f
(relative to P and Œ±). We say that f is Riemann‚ÄìStieltjes integrable (over
I with respect to Œ±) if there exists a real number Œõ with the following
property. For each Œµ > 0 there exists Œ¥ > 0 such that |Œ£ ‚àíŒõ| < Œµ whenever
‚Äî P is a partition of I with mesh less than Œ¥ and
‚Äî Œ£ is a Riemann‚ÄìStieltjes sum for f relative to P.
In that case, Œõ‚Äîthe Riemann‚ÄìStieltjes integral of f with respect to Œ± ‚Äîis
the unique real number with this property, and is usually written
$ b
a
f(x) dŒ±(x).
Exercise (1.5.12: 1) shows that the Riemann integral is just the special
case of the Riemann‚ÄìStieltjes integral in which Œ±(x) = x.
(1.5.16) Exercises
In these exercises, Œ± has bounded variation on I, and f, g are bounded
real‚Äìvalued functions on I.
.1
Why, in the foregoing deÔ¨Ånitions, do we require the function Œ± to be
of bounded variation?

1.5 Calculus
73
.2
Let Œ± be an increasing function on I = [a, b]. Given a partition P =
(x0, x1, . . . , xn) of I, we call the real numbers
L(f, P, Œ±) =
n‚àí1

i=0
mi(f) (Œ±(xi+1) ‚àíŒ±(xi)) ,
U(f, P, Œ±) =
n‚àí1

i=0
Mi(f) (Œ±(xi+1) ‚àíŒ±(xi)) ,
respectively, the lower sum and the upper sum for f relative to P
and Œ±. Prove that the lower integral
$ b
a
f(x) dŒ±(x) = sup {L(f, P, Œ±) : P is a partition of I}
and the upper integral
$ b
a
f(x) dŒ±(x) = inf {U(f, P, Œ±) : P is a partition of I}
of f with respect to Œ± exist. Prove also that f is Riemann‚ÄìStieltjes
integrable with respect to Œ± if and only if
$ b
a
f(x) dŒ±(x) =
$ b
a
f(x) dŒ±(x),
in which case their common value is
% b
a f(x) dŒ±(x).
.3
Prove that if f is continuous, then it is Riemann‚ÄìStieltjes integrable
with respect to Œ±, and
     
$ b
a
f(x) dŒ±(x)
     ‚â§
$ b
a
|f(x)| dTŒ±(a, x) ‚â§MTŒ±(a, b),
where TŒ±(a, x) is the variation of Œ± on the interval [a, x], and M =
sup {|f(x)| : a ‚â§x ‚â§b} . (Note that TŒ±(a, ¬∑) has bounded variation,
by Exercises (1.5.15: 1 and 2).)
.4
Prove that if f, g are Riemann‚ÄìStieltjes integrable with respect to Œ±,
then so are f + g, f ‚àíg, and Œªf (where Œª ‚ààR); in which case,
$ b
a
(f(x) + g(x)) dŒ±(x)
=
$ b
a
f(x) dŒ±(x) +
$ b
a
g(x) dŒ±(x),
$ b
a
(f(x) ‚àíg(x)) dŒ±(x)
=
$ b
a
f(x) dŒ±(x) ‚àí
$ b
a
g(x) dŒ±(x),
and
$ b
a
Œªf(x) dŒ±(x) = Œª
$ b
a
f(x) dŒ±(x).

74
1. Analysis on the Real Line
.5
Let a ‚â§c ‚â§b. Prove that f is Riemann‚ÄìStieltjes integrable over [a, b]
(with respect to Œ±) if and only if it is Riemann‚ÄìStieltjes integrable
over both [a, c] and [c, b]; in which case,
$ b
a
f(x) dŒ±(x) =
$ c
a
f(x) dŒ±(x) +
$ b
c
f(x) dŒ±(x).
.6
Prove that if Œ± has a continuous derivative on I, then the Riemann‚Äì
Stieltjes integral
% b
a f(x) dŒ±(x) exists and equals the Riemann integral
% b
a fŒ±‚Ä≤.
.7
Let Œ±, Œ≤ be of bounded variation on I, and suppose that f is
Riemann‚ÄìStieltjes integrable with respect to both Œ± and Œ≤. Prove
that f is Riemann‚ÄìStieltjes integrable with respect to Œ± + Œ≤, and
that
$ b
a
f(x) d(Œ± + Œ≤)(x) =
$ b
a
f(x) dŒ±(x) +
$ b
a
f(x) dŒ≤(x).
Prove also that for each Œª ‚ààR, f is Riemann‚ÄìStieltjes integrable
with respect to ŒªŒ±, and
$ b
a
f(x) d(ŒªŒ±)(x) = Œª
$ b
a
f(x) dŒ±(x).
The next lemma enables us to discuss the continuity of the function
Tf(a, ¬∑).
(1.5.17) Lemma.
Let f have bounded variation on I. Then for each
positive integer n there exists a function gn : I ‚ÜíR such that
(i) |f(x+) ‚àíf(x)| = |gn(x+) ‚àígn(x)| whenever a ‚â§x < b,
(ii) |f(x) ‚àíf(x‚àí)| = |gn(x) ‚àígn(x‚àí)| whenever a < x ‚â§b,
(iii) Tf(a, ¬∑) ‚àígn is an increasing function, and
(iv) 0 ‚â§Tf(a, x) ‚àígn(x) < 1/n for all x ‚ààI.
Moreover, f and gn are continuous at precisely the same points of I.
Proof.
We may assume that a < b. Referring to Exercise (1.5.15: 5),
choose points a = x0 < x1 < ¬∑ ¬∑ ¬∑ < xm‚àí1 < xm = b such that f is
continuous at xi (1 ‚â§i ‚â§m ‚àí1), and
m‚àí1

i=0
|f(xi+1) ‚àíf(xi)| > Tf(a, b) ‚àí1
n.

1.5 Calculus
75
Setting gn(a) = 0, construct the function gn on the intervals [xi, xi+1]
inductively, as follows. Assume that gn(x) has been deÔ¨Åned for a ‚â§x ‚â§xi,
where i < m, and consider x with xi < x ‚â§xi+1. If f(xi+1) ‚àíf(xi) ‚â•0,
set
gn(x) = f(x) + gn(xi) ‚àíf(xi);
if f(xi+1) ‚àíf(xi) < 0, set
gn(x) = ‚àíf(x) + gn(xi) + f(xi).
This completes the inductive construction.
If xi ‚â§x < x‚Ä≤ ‚â§xi+1, then (see Exercise (1.5.15: 1))
Tf(a, x‚Ä≤) ‚àíTf(a, x) = Tf(x, x‚Ä≤)
‚â•|f(x‚Ä≤) ‚àíf(x)|
= |gn(x‚Ä≤) ‚àígn(x)|
‚â•gn(x‚Ä≤) ‚àígn(x).
Thus if xi‚àí1 ‚â§x < xi < ¬∑ ¬∑ ¬∑ < xj < x‚Ä≤ ‚â§xj+1, then
Tf(a, x‚Ä≤) ‚àíTf(a, x) = Tf(a, x‚Ä≤) ‚àíTf(a, xj)
+
j‚àí1

k=i
(Tf(a, xk+1) ‚àíTf(a, xk))
+Tf(a, xi) ‚àíTf(a, x)
‚â•gn(x‚Ä≤) ‚àígn(xj) +
j‚àí1

k=i
(gn(xk+1) ‚àígn(xk))
+gn(xi) ‚àígn(x)
= gn(x‚Ä≤) ‚àígn(x).
It follows that Tf(a, ¬∑) ‚àígn is an increasing function. For all x ‚àà[a, b] we
now have
0 = Tf(a, a) ‚àígn(a)
‚â§Tf(a, x) ‚àígn(x)
‚â§Tf(a, b) ‚àígn(b)
= Tf(a, b) ‚àí
n‚àí1

i=0
(gn(xi+1) ‚àígn(xi))
= Tf(a, b) ‚àí
n‚àí1

i=0
|f(xi+1) ‚àíf(xi)|
< 1
n.

76
1. Analysis on the Real Line
Finally, properties (i) and (ii) hold, since on each interval [xi, xi+1] either
gn ‚àíf or gn + f is constant; the last part of the statement of the lemma
follows immediately.
2
(1.5.18) Proposition.
Let f have bounded variation on I. Then
Tf(a, x+) ‚àíTf(a, x) =
  f(x+) ‚àíf(x)
  
if a ‚â§x < b, and
Tf(a, x) ‚àíTf(a, x‚àí) =
  f(x) ‚àíf(x‚àí)
  
if a < x ‚â§b. Hence f and Tf(a, ¬∑) are continuous at precisely the same
points of I.
Proof.
For each positive integer n choose gn as in the preceding lemma.
For a ‚â§x < x‚Ä≤ < b we have
|Tf(a, x‚Ä≤) ‚àíTf(a, x) ‚àígn(x‚Ä≤) + gn(x)|
‚â§|Tf(a, x‚Ä≤) ‚àígn(x‚Ä≤)| + |Tf(a, x) ‚àígn(x)|
< 2
n.
Letting x‚Ä≤ approach x, we see that
  Tf(a, x+) ‚àíTf(a, x) ‚àígn(x+) + gn(x)
  ‚â§2
n.
Now noting that
gn(x+) ‚àígn(x) =
  f(x+) ‚àíf(x)
  ,
we obtain
Tf(a, x+) ‚àíTf(a, x) = lim
n‚Üí‚àû

gn(x+) ‚àígn(x)
	
=
  f(x+) ‚àíf(x)
  .
The rest of the proof is left as an exercise.
2
The preceding proposition enables us to prove a result that is used later
(in Theorem (6.1.18)) to establish the uniqueness of the representation of
certain continuous linear functions.
(1.5.19) Proposition.
Let Œ± be a function of bounded variation on I =
[a, b], and let D be the set consisting of a, b, and all points of (a, b) at which
Œ± is discontinuous. Then
% b
a f(x) dŒ±(x) = 0 for each continuous function
f : I ‚ÜíR if and only if Œ±(x) = Œ±(a) for all x ‚ààI\D.
Proof.
Note that D is countable, by Exercise (1.5.15: 5). Suppose Ô¨Årst
that
% b
a f(x) dŒ±(x) = 0 for each continuous f on I, and consider any point

1.5 Calculus
77
Œæ ‚ààI\D. There exist arbitrarily small positive numbers t ‚ààI\D such that
Œæ < b ‚àít. For such t let f be the continuous function that equals 1 on the
interval [a, Œæ], equals 0 on [Œæ + t, b], and is linear on [Œæ, Œæ + t]. Referring to
Exercises (1.5.16: 5 and 3), we obtain the estimate
0 =
$ b
a
f(x) dŒ±(x)
=
$ Œæ
a
f(x) dŒ±(x) +
$ Œæ+t
Œæ
f(x) dŒ±(x) +
$ b
Œæ+t
f(x) dŒ±(x)
‚â§Œ±(Œæ) ‚àíŒ±(a) + TŒ± (Œæ, Œæ + t) + 0.
Letting t tend to 0 and using Proposition (1.5.18), we see that Œ±(Œæ) = Œ±(a).
Now suppose, conversely, that Œ±(x) = Œ±(a) for all x ‚ààI\D, and let f
be any continuous real‚Äìvalued function on I. Given Œµ > 0, choose Œ¥ > 0
as in the deÔ¨Ånition of
% b
a f(x) dŒ±(x). In view of Exercise (1.5.15: 5), we can
choose a partition P, with mesh less than Œ¥, consisting of a, b, and points
of I\D. For any Riemann‚ÄìStieltjes sum Œ£ for f corresponding to P and Œ±,
we then have Œ£ = 0 and therefore
     
$ b
a
f(x) dŒ±(x)
     =
     Œ£ ‚àí
$ b
a
f(x) dŒ±(x)
     < Œµ.
Since Œµ > 0 is arbitrary, it follows that
% b
a f(x) dŒ±(x) = 0.
2
(1.5.20) Exercises
.1
Complete the proof of Proposition (1.5.18).
.2
Let Œ± be of bounded variation on I = [a, b]. Prove that
% b
a f(x) dŒ±(x) =
0 for each continuous f : I ‚ÜíR if and only if Œ±(x) = Œ±(a) for all x
in a dense subset of I that includes b.
We bring our treatment of the Riemann and Riemann‚ÄìStieltjes integrals
to an end here. In the next chapter we develop a type of integral, based
on a generalisation of the integral as an antiderivative, that is much more
powerful than the Riemann integral, and for which it is possible to construct
(although we do not do so) a related generalisation analogous to that of
Riemann‚ÄìStieltjes.
For more on Riemann and Riemann‚ÄìStieltjes integration see [17], [42],
or [50].

2
DiÔ¨Äerentiation and the Lebesgue
Integral
More matter with less art.
hamlet, Act 2, Scene 2
In the Ô¨Årst section of this chapter we show how the ideas of Chapter 1 can
be applied in a theory of the length of a subset of R; this leads to the Vitali
Covering Theorem, a result with many interesting applications in the theory of
diÔ¨Äerentiation and integration. Building on that material, in the next two sections
we describe F. Riesz‚Äôs development of Lebesgue integration as the inverse process
to diÔ¨Äerentiation ‚Äúalmost everywhere‚Äù.
2.1
Outer Measure and Vitali‚Äôs Covering Theorem
Can we assign to a subset A of R a measure of its length? We have already
done this when A is a bounded interval; but what about a more general
set A? The answer lies in measure theory, a subject that was pioneered by
Lebesgue, Borel, and others at the beginning of this century and which has
proved of immense importance in analysis, probability theory, and many
other areas of mathematics.
The outer measure of A is the quantity
¬µ‚àó(A)
=
inf
‚àû
n=1 |In| : (In)‚àû
n=1 is a cover of A
by bounded open intervals} ,

80
2. DiÔ¨Äerentiation and the Lebesgue Integral
which we take as ‚àûif the set on the right‚Äìhand side is unbounded.1 If
¬µ‚àó(A) ‚ààR, we say that A has Ô¨Ånite outer measure. Note that since, for
any sequence (In) of bounded open intervals that covers A, the terms of the
series ‚àû
n=1 |In| are all positive, the (possibly inÔ¨Ånite) sum of the series does
not depend on the order of those terms; this is an immediate consequence
of Exercise (1.2.17: 1).
If A has outer measure zero, then we say that A is a set of measure zero,
or that A has measure zero. Thus A has measure zero if and only if for
each Œµ > 0 there exists a sequence (In)‚àû
n=1 of bounded open intervals such
that A ‚äÇ‚àû
n=1 In and ‚àû
n=1 |In| < Œµ.
(2.1.1) Exercises
.1
Show that for each A ‚äÇR, ¬µ‚àó(A) is the inÔ¨Åmum of ‚àû
n=1 |In|
taken over all covers of A by sequences (In)‚àû
n=1 of bounded, but not
necessarily open, intervals.
.2
Prove that if a subset A of R has Ô¨Ånite outer measure, then for each
Œµ > 0 there exists a sequence (In) of disjoint bounded open intervals
such that A ‚äÇ‚àû
n=1 In and ‚àû
n=1 |In| < ¬µ‚àó(A) + Œµ. (Use Proposition
(1.3.6).)
.3
Show that ¬µ‚àó(‚àÖ) = 0, and that if A ‚äÇB, then ¬µ‚àó(A) ‚â§¬µ‚àó(B).
.4
Prove that for each a ‚ààR, ¬µ‚àó({a}) = 0.
.5
Let A be a subset of R, and E ‚äÇA a set of measure zero. Show that
¬µ‚àó(A\E) = ¬µ‚àó(A).
.6
Let A be a subset of a compact interval I. Prove that ¬µ‚àó(A) +
¬µ‚àó(I\A) ‚â•|I| . (It follows from results towards the end of Section 3 of
this chapter that, perhaps surprisingly, we cannot replace inequality
by equality in this result.)
.7
Let (An) be a sequence of subsets of R. Show that
¬µ‚àó
 ‚àû

n=1
An

‚â§
‚àû

n=1
¬µ‚àó(An),
where the right‚Äìhand side is taken as ‚àûif either any of its terms is ‚àû
or the series diverges. (If one of the sets An has inÔ¨Ånite outer measure,
then the inequality is trivial. If each An has Ô¨Ånite outer measure, then
for each positive integer n and each Œµ > 0 there exists a sequence
1In Section 1 of Chapter 3 we give a precise meaning to this use of ‚àûas an
‚Äúextended real number‚Äù.

2.1 Outer Measure and Vitali‚Äôs Covering Theorem
81
(In,k)‚àû
k=1 of bounded open intervals such that An ‚äÇ‚àû
k=1 In,k and
‚àû
k=1 |In,k| < ¬µ‚àó(An) + 2‚àínŒµ.)
Prove that if also the sets An are pairwise‚Äìdisjoint, then
¬µ‚àó
 ‚àû

n=1
An

=
‚àû

n=1
¬µ‚àó(An).
.8
Give two proofs that a countable subset of R has measure zero. Hence
prove that R is uncountable.
.9
Give two proofs that the union of a sequence of sets of measure zero
has measure zero.
.10 Prove that a subset A of R has Ô¨Ånite outer measure if and only if
l = limn‚Üí‚àû¬µ‚àó(A ‚à©[‚àín, n]) exists, in which case ¬µ‚àó(A) = l.
.11 Prove that ¬µ‚àóis translation invariant‚Äîthat is, ¬µ‚àó(A + t) = ¬µ‚àó(A)
for each A ‚äÇR and each t ‚ààR, where A + t = {x + t : x ‚ààA}.
(2.1.2) Proposition.
The outer measure of any interval in R equals the
length of the interval.
Proof.
Consider, to begin with, a bounded closed interval [a, b]. For each
Œµ > 0 we have [a, b] ‚äÇ(a ‚àíŒµ, b + Œµ) and therefore
¬µ‚àó([a, b]) ‚â§|(a ‚àíŒµ, b + Œµ)| = b ‚àía + 2Œµ.
Since Œµ > 0 is arbitrary, we conclude that ¬µ‚àó([a, b]) ‚â§b ‚àía. To prove the
reverse inequality, let (In) be any sequence of bounded open intervals that
covers [a, b]. Applying the Heine‚ÄìBorel‚ÄìLebesgue Theorem (1.4.6), and re‚Äì
indexing the terms In (which we can do without loss of generality), we may
assume that for some N,
[a, b] ‚äÇI1 ‚à™I2 ‚à™¬∑ ¬∑ ¬∑ ‚à™IN.
There exists an interval Ik1, where 1 ‚â§k1 ‚â§N, that contains a; let this
interval be (a1, b1). Either b < b1, in which case we stop the procedure, or
else b1 ‚â§b. In the latter case, b1 ‚àà[a, b]\(a1, b1); so there exists an interval
Ik2, where 1 ‚â§k2 ‚â§N and k2 Ã∏= k1, that contains b1; call this interval
(a2, b2). Repeating this argument, we obtain intervals (a1, b1), (a2, b2), . . .
in the collection {I1, . . . , IN} such that for each i, ai < bi‚àí1 < bi. This
procedure must terminate with the construction of (aj, bj) for some j ‚â§N.
Then b ‚àà(aj, bj), so
N

n=1
|In| ‚â•
j

i=1
(bi ‚àíai)

82
2. DiÔ¨Äerentiation and the Lebesgue Integral
= bj ‚àí(aj ‚àíbj‚àí1) ‚àí(aj‚àí1 ‚àíbj‚àí2)
‚àí¬∑ ¬∑ ¬∑ ‚àí(a2 ‚àíb1) ‚àía1
> bj ‚àía1.
It follows that ‚àû
n=1 |In| > b‚àía and therefore, since (In) was any sequence
of bounded open intervals covering [a, b], that ¬µ‚àó([a, b]) ‚â•b ‚àía. Coupled
with the reverse inequality already established, this proves that ¬µ‚àó([a, b]) =
b ‚àía.
The proof for other types of interval is left as the next exercise.
2
(2.1.3) Exercises
.1
Complete the proof of Proposition (2.1.2) in the remaining cases.
.2
Let {I1, . . . , IN} be a Ô¨Ånite set of bounded open intervals covering
Q ‚à©[0, 1]. Prove that N
n=1 |In| ‚â•1. (Given Œµ > 0, extend each In, if
necessary, to ensure that it has rational endpoints and that the total
length of the intervals is increased by at most Œµ. Then argue as in the
proof of Proposition (2.1.2).)
.3
Let X be a subset of R with Ô¨Ånite outer measure. Prove that for each
Œµ > 0 there exists an open set A ‚äÉX with Ô¨Ånite outer measure, such
that ¬µ‚àó(A) < ¬µ‚àó(X) + Œµ. (Use Exercise (2.1.1: 2).) Show that if X is
also bounded, then we can choose A to be bounded.
Let X be a subset of R, and V a family of nondegenerate intervals‚Äîthat
is, intervals each having positive length. We say that V is a Vitali covering
of X if for each Œµ > 0 and each x ‚ààX there exists I ‚ààV such that x ‚ààI
and |I| < Œµ.
(2.1.4) The Vitali Covering Theorem.
Let V be a Vitali covering of
a set X ‚äÇR with Ô¨Ånite outer measure. Then for each Œµ > 0 there exists a
Ô¨Ånite set {I1, . . . , IN} of pairwise‚Äìdisjoint intervals in V such that
¬µ‚àó

X\
N

n=1
In

< Œµ.
We postpone the proof of this very useful theorem until we have dealt
with some auxiliary exercises.
(2.1.5) Exercises
.1
Let V be a Vitali covering of a subset X of R, x a point of X, and
A an open subset of R containing X. Show that for each Œµ > 0 there
exists I ‚ààV such that x ‚ààI, I ‚äÇA, and |I| < Œµ.

2.1 Outer Measure and Vitali‚Äôs Covering Theorem
83
.2
Let I1, . . . , IN be Ô¨Ånitely many closed intervals belonging to a Vitali
covering V,of a subset X of R with Ô¨Ånite outer measure, and let x ‚àà
X\ N
n=1 In. Show that for each Œµ > 0 there exists I ‚ààV such that
x ‚ààI, |I| < Œµ, and I is disjoint from N
n=1 In.
Proof of the Vitali Covering Theorem.
If necessary replacing the
intervals in I by their closures, we may assume that V consists of closed
intervals. Referring to Exercise (2.1.3: 3), choose an open set A ‚äÉX with
Ô¨Ånite outer measure. In view of Exercise (2.1.5: 1), we may assume without
loss of generality that
I ‚äÇA for each I ‚ààV.
(1)
Choosing any interval I1 in the covering V, we construct pairwise‚Äìdisjoint
intervals I1, I2, . . . in V inductively as follows. Assume that we have con-
structed I1, . . . , In in V. If X ‚äÇn
k=1 Ik, then ¬µ‚àó(X\ n
k=1 Ik) = 0 and
we stop the construction. If X is not contained in n
k=1 Ik, then Exercise
(2.1.5: 2) shows that the set
Sn=
!
|I| : I ‚ààV, I ‚à©
n

k=1
Ik = ‚àÖ
"
is nonempty. Since, by (1), Sn is bounded above by ¬µ‚àó(A), it follows that
sn = sup Sn
exists; moreover, as each I ‚ààV is nondegenerate, sn > 0. To complete our
inductive construction, we now choose In+1 ‚ààV such that In+1 ‚à©n
k=1 Ik =
‚àÖand |In+1| > 1
2sn.
We may assume that this construction leads to an inÔ¨Ånite sequence
(In)‚àû
n=1 of pairwise‚Äìdisjoint elements of V. Since the partial sums of the
series ‚àû
n=1 |In| are bounded by ¬µ‚àó(A), the monotone sequence principle
(Proposition (1.2.4)) ensures that the series converges. Given Œµ > 0, we can
therefore Ô¨Ånd N such that
‚àû

n=N+1
|In| < Œµ
5.
For each n > N let xn be the midpoint of In, and let Jn be the closed
interval with midpoint xn and length 5 |In| . It suÔ¨Éces to prove that
X\
N

n=1
In ‚äÇ
‚àû

n=N+1
Jn.
(2)

84
2. DiÔ¨Äerentiation and the Lebesgue Integral
For then
¬µ‚àó

X\
N

n=1
In

‚â§
‚àû

n=N+1
|Jn| = 5
‚àû

n=N+1
|In| < Œµ.
To prove (2), consider any x ‚ààX\ N
n=1 In. By Exercise (2.1.5: 2), there
exists I ‚ààV such that x ‚ààI and I ‚à©N
n=1 In = ‚àÖ. We claim that I ‚à©Im
is nonempty for some m > N. If this were not the case, then for each m
we would have I ‚à©m
n=1 In = ‚àÖand therefore |I| ‚â§sm < 2 |Im+1| ; since
limm‚Üí‚àû|Im| = 0 (by Exercise (1.2.14: 1)), it would follow that |I| = 0,
which is absurd as V contains only nondegenerate intervals. Thus
ŒΩ = min{m > N : I ‚à©Im Ã∏= ‚àÖ}
is well deÔ¨Åned, I ‚à©ŒΩ‚àí1
n=1 In = ‚àÖ, and therefore |I| ‚â§sŒΩ‚àí1 < 2 |IŒΩ| . Since
x ‚ààI and I ‚à©IŒΩ Ã∏= ‚àÖ, we see that
|x ‚àíxŒΩ| ‚â§|I| + 1
2 |IŒΩ| < 2 |IŒΩ| + 1
2 |IŒΩ| = 5
2 |IŒΩ| .
Hence x ‚ààJŒΩ. This establishes (2) and completes the proof.
2
In the remainder of this section we apply the Vitali Covering Theorem
in the proofs of some fundamental results in the theory of diÔ¨Äerentiation
and integration.
Let I be an interval in R. We say that a mapping f : I ‚ÜíR is ab-
solutely continuous if for each Œµ > 0 there exists Œ¥ > 0 such that if
([ak, bk])n
k=1is a Ô¨Ånite family of nonoverlapping2 compact subintervals of
I such that n
k=1 (bk ‚àíak) < Œ¥, then n
k=1 |f(bk) ‚àíf(ak)| < Œµ.
(2.1.6) Exercises
.1
Prove that an absolutely continuous function on I is both uniformly
continuous and bounded.
.2
Let f, g be absolutely continuous functions on I. Prove that the func-
tions f+g, f‚àíg, Œªf (where Œª ‚ààR), and fg are absolutely continuous,
and that if inf {|f(x)| : x ‚ààI} > 0, then 1/f is absolutely continuous.
.3
Prove that if f is diÔ¨Äerentiable, with bounded derivative, on an
interval I, then f is absolutely continuous.
.4
Let f be absolutely continuous on a compact interval I = [a, b]. Prove
that f has bounded variation in I, that the variation function Tf(a, ¬∑)
is absolutely continuous on I, and that f is the diÔ¨Äerence of two abso-
lutely continuous, increasing functions on I. (See Exercises (1.5.15: 1
and 2).)
2Two intervals in R are nonoverlapping if their intersection is either empty
or contains only endpoints of the intervals.

2.1 Outer Measure and Vitali‚Äôs Covering Theorem
85
Let S be a subset of R, and P(x) a statement about real numbers x. If
there exists a set E of measure zero such that P(x) holds for all x in S\E,
then we say that P(x) holds almost everywhere on S, or, more loosely, that
P holds almost everywhere on S; in the case S = R we say simply that
P(x), or P, holds almost everywhere.
A simple corollary of the Mean Value Theorem (Exercise (1.5.4: 6)), one
that suÔ¨Éces for many applications, states that if f is continuous on [a, b]
and |f ‚Ä≤(x)| ‚â§M for all x ‚àà(a, b), then |f(b) ‚àíf(a)| ‚â§M(b ‚àía). Our Ô¨Årst
application of the Vitali Covering Theorem generalises this corollary, and
can be regarded an extension of the Mean Value Theorem itself.
(2.1.7) Proposition.
Let f be an absolutely continuous mapping of
a compact interval I = [a, b] into R, and F a diÔ¨Äerentiable increasing
mapping of I into R such that |f ‚Ä≤(x)| ‚â§F ‚Ä≤(x) almost everywhere on I.
Then
|f(b) ‚àíf(a)| ‚â§F(b) ‚àíF(a).
(3)
Proof.
Let E ‚äÇI be a set of measure zero such that |f ‚Ä≤(x)| ‚â§F ‚Ä≤(x) for
each x ‚ààX = I\E. We may assume without loss of generality that a, b ‚ààE.
Given Œµ > 0, choose Œ¥ > 0 as in the deÔ¨Ånition of absolute continuity. For
each x ‚ààX there exist arbitrarily small r > 0 such that [x, x + r] ‚äÇ(a, b),
|f(x + r) ‚àíf(x) ‚àíf ‚Ä≤(x)r| < Œµr,
|F(x + r) ‚àíF(x) ‚àíF ‚Ä≤(x)r| < Œµr,
and therefore
|f(x + r) ‚àíf(x)| ‚â§|f ‚Ä≤(x)| r + Œµr
‚â§F ‚Ä≤(x)r + Œµr
‚â§F(x + r) ‚àíF(x) + 2Œµr.
The sets of the form [x, x + r] , for such r > 0, form a Vitali covering of
X. By the Vitali Covering Theorem, there exists a Ô¨Ånite, pairwise‚Äìdisjoint
collection ([xk, xk + rk])N
k=1 of sets of this type such that
¬µ‚àó

X\
N

k=1
[xk, xk + rk]

< Œ¥.
We may assume that xk + rk < xk+1 for 1 ‚â§k ‚â§N ‚àí1. Thus
x1 ‚àía +
N‚àí1

k=1
(xk+1 ‚àíxk ‚àírk) + b ‚àíxN ‚àírN < Œ¥,

86
2. DiÔ¨Äerentiation and the Lebesgue Integral
and therefore
|f(x1) ‚àíf(a)| +
N‚àí1

k=1
|f(xk+1) ‚àíf(xk + rk)| + |f(b) ‚àíf(xN + rN)| < Œµ.
It follows that
|f(b) ‚àíf(a)| ‚â§|f(x1) ‚àíf(a)| +
N‚àí1

k=1
|f(xk+1) ‚àíf(xk + rk)|
+ |f(b) ‚àíf(xN + rN)| +
N

k=1
|f(xk + rk) ‚àíf(xk)|
< Œµ +
N

k=1
(F(xk + rk) ‚àíF(xk) + 2Œµrk)
< Œµ + F(x1) ‚àíF(a) +
N‚àí1

k=1
(F(xk+1) ‚àíF(xk + rk))
+
N

k=1
(F(xk + rk) ‚àíF(xk) + 2Œµrk)
+ (F(b) ‚àíF(xN + rN))
= Œµ + F(b) ‚àíF(a) + 2Œµ
N

k=1
rk
< F(b) ‚àíF(a) + Œµ(1 + 2b ‚àí2a).
Since Œµ > 0 is arbitrary, we conclude that (3) holds.
2
(2.1.8) Exercises
.1
Let f be absolutely continuous on I = [a, b] , and suppose that for
some constant M, |f ‚Ä≤| ‚â§M almost everywhere on I. Prove that
|f(b) ‚àíf(a)| ‚â§M(b ‚àía).
.2
Let f : [a, b] ‚ÜíR be an absolutely continuous function such that
f ‚Ä≤(x) = 0 almost everywhere on I = [a, b] . Give two proofs that f is
a constant function. (For one proof use the Vitali Covering Theorem.)
.3
Let f, F be continuous on I = [a, b], and suppose there exists a count-
able subset D of I such that |f ‚Ä≤(x)| ‚â§F ‚Ä≤(x) for all x ‚ààI\D. Show
that |f(b) ‚àíf(a)| ‚â§F(b) ‚àíF(a). (We may assume that D is count-
ably inÔ¨Ånite. Let d1, d2, . . . be a one‚Äìone mapping of N+ onto D.
Given Œµ > 0, let X be the set of all points x ‚ààI such that
|f(Œæ) ‚àíf(a)| ‚â§F(Œæ) ‚àíF(a) + Œµ
Ô£´
Ô£≠Œæ ‚àía +

{n:dn<Œæ}
2‚àín
Ô£∂
Ô£∏

2.1 Outer Measure and Vitali‚Äôs Covering Theorem
87
for all Œæ ‚àà[a, x), and let s = sup X. Assume that s < b, and derive a
contradiction.)
.4
Let f be continuous on I = [a, b] , and suppose there exists a count-
able subset D of I such that f ‚Ä≤(x) = 0 for all x ‚ààI\D. Prove that f
is constant on I.
.5
Let C be the Cantor set (see Exercise (1.3.8: 11)). Show that [0, 1]\C
is a countable union of nonoverlapping open intervals (Jn)‚àû
n=1 whose
lengths sum to 1, and that C has measure zero.
For each x = ‚àû
n=1 an3‚àín ‚ààC deÔ¨Åne F(x)= ‚àû
n=1 an2‚àín‚àí1. Show
that
(i) if x has two ternary expansions, then they produce the same
value for F(x), so that F is a function on C;
(ii) F is a strictly increasing, continuous mapping of C onto [0, 1] ;
(iii) C is uncountable; and
(iv) F extends to an increasing continuous mapping that is con-
stant on each Jn, equals 0 throughout (‚àí‚àû, 0], and equals 1
throughout [1, ‚àû).
Prove that for each Œ¥ > 0 there exist Ô¨Ånitely many points
a1 < 0 < b1 < a2 < ¬∑ ¬∑ ¬∑ < bN‚àí1 < aN < 1 < bN
of [‚àí1, 2] such that C ‚äÇN
n=1 [an, bn] ,
N

n=1
(F(bn) ‚àíF(an)) = 1,
and N
n=1 (bn ‚àían) < Œ¥. (Thus F is increasing and continuous, but
not absolutely continuous, on [‚àí1, 2] .)
Finally, show that F ‚Ä≤(x) = 0 for all x ‚àà[0, 1]\C, but F(1) > F(0).
The last two exercises deserve further comment. Consider a continu-
ous function F on [0, 1] whose derivative exists and vanishes throughout
[0, 1]\E. If E is countable, then Exercise (2.1.8: 4) shows that F is con-
stant. On the other hand, Exercise (2.1.8: 5) shows that if E is uncountable
and of measure zero, then F need not be constant; but if, in that case, F
is absolutely continuous, then it follows from Exercise (2.1.8: 2) that it is
constant.

88
2. DiÔ¨Äerentiation and the Lebesgue Integral
Although the derivative of a function f may not exist at a point x ‚ààR,
one or more of the following quantities‚Äîthe Dini derivates of f at x‚Äîmay:
D+f(x) = lim
h‚Üí0+ sup f(x + h) ‚àíf(x)
h
,
D+f(x) = lim
h‚Üí0+ inf f(x + h) ‚àíf(x)
h
,
D‚àíf(x) = lim
h‚Üí0‚àísup f(x + h) ‚àíf(x)
h
,
D‚àíf(x) = lim
h‚Üí0‚àíinf f(x + h) ‚àíf(x)
h
.
We consider D+f(x) to be undeÔ¨Åned if
‚Äî either there is no h > 0 such that f is deÔ¨Åned throughout the interval
[x, x + h]
‚Äî or else (f(x + h) ‚àíf(x)) /hremains unbounded as h ‚Üí0+.
Similar comments apply to the other derivates of f.
(2.1.9) Exercises
.1
Prove that D+f(x) ‚â•D+f(x) and D‚àíf(x) ‚â•D‚àíf(x) whenever the
quantities concerned make sense.
.2
Prove that f is diÔ¨Äerentiable on the right (respectively, left) at x if
and only if D+f(x) = D+f(x) (respectively, D‚àíf(x) = D‚àíf(x)).
.3
Let f be a mapping of R into R, and deÔ¨Åne g(x) = ‚àíf(‚àíx). Prove
that for each x ‚ààR, D+g(x) = D‚àíf(‚àíx) and D‚àíg(x) = D+f(‚àíx).
.4
Let f : [a, b] ‚ÜíR be continuous, and suppose that one of the four
derivates of f is nonnegative throughout (a, b). Prove that f is an
increasing function on [a, b]. (Show that x ‚Üíf(x) + Œµx is increasing
for each Œµ > 0.)
.5
Consider a function f : [a, b] ‚ÜíR, and real numbers r, s with r > s.
DeÔ¨Åne
E =

x ‚àà(a, b) : D+f(x) > r > s > D‚àíf(x)

.
Let X be an open set such that E ‚äÇX and ¬µ‚àó(X) < ¬µ‚àó(E) + Œµ (see
Exercise (2.1.3: 3)). Prove that the intervals of the form (x ‚àíh, x)
such that x ‚ààE, h > 0, [x ‚àíh, x] ‚äÇX, and f(x) ‚àíf(x ‚àíh) < sh
form a Vitali covering of E. Hence prove that for each Œµ > 0 there
exist Ô¨Ånitely many points x1, . . . , xm of E, and Ô¨Ånitely many positive

2.1 Outer Measure and Vitali‚Äôs Covering Theorem
89
numbers h1, . . . , hm, such that the intervals Ji = (xi ‚àíhi, xi) (1 ‚â§
i ‚â§m) form a pairwise‚Äìdisjoint collection,
¬µ‚àó
 m

i=1
Ji

> ¬µ‚àó(E) ‚àíŒµ
and
m

i=1
(f(xi) ‚àíf(xi ‚àíhi)) < s (¬µ‚àó(E) + Œµ) .
Again applying the Vitali Covering Theorem, prove that there ex-
ist Ô¨Ånitely many points y1, . . . , yn of E ‚à©m
i=1 Ji, and Ô¨Ånitely many
positive numbers h‚Ä≤
1, . . . , h‚Ä≤
n, such that
yk + h‚Ä≤
k < yk+1 (1 ‚â§k ‚â§n ‚àí1) ,
for each k there exists i such that (yk, yk + h‚Ä≤
k) ‚äÇJi, and
n

k=1
(f(yk + h‚Ä≤
k) ‚àíf(yk)) > r (¬µ‚àó(E) ‚àí2Œµ) .
Our next theorem shows, in particular, that the diÔ¨Äerentiability of the
function F can be dropped from the hypotheses of Proposition (2.1.7).
(2.1.10) Theorem.
An increasing function f : R ‚ÜíR is diÔ¨Äerentiable
almost everywhere.
Proof.
It suÔ¨Éces to show that the sets
S =

x ‚ààR : D+f(x) is undeÔ¨Åned

,
T =

x ‚ààR : D+f(x) > D‚àíf(x)

have measure zero. For, applying this and Exercise (2.1.9: 3) to the increas-
ing function x ‚Üí‚àíf(‚àíx), we then see that D‚àíf(x) ‚â§D+f(x) almost
everywhere; whence, by Exercises (2.1.9: 1) and (2.1.1: 9),
D+f(x) ‚â§D‚àíf(x) ‚â§D‚àíf(x) ‚â§D+f(x) ‚â§D+f(x) ‚ààR
almost everywhere. (Note that as f is increasing, D+f(x) and D‚àíf(x) are
everywhere deÔ¨Åned and nonnegative.) Thus the four Dini derivates of f are
equal almost everywhere. Reference to Exercise (2.1.9: 2) then completes
the proof.
Leaving S to the next set of exercises, we now show that T has measure
zero. Since T is the union of a countable family of sets of the form
E =

x ‚àà(a, b) : D+f(x) > r > s > D‚àíf(x)

,
where a < b and r, s are rational numbers with r > s, it is enough to
prove that such a set E has measure zero. We Ô¨Årst use Exercise (2.1.9: 5)
to obtain

90
2. DiÔ¨Äerentiation and the Lebesgue Integral
(i) Ô¨Ånitely many points x1, . . . , xm of (a, b) , and Ô¨Ånitely many positive
numbers h1, . . . , hm, such that the intervals Ji = (xi ‚àíhi, xi) (1 ‚â§
i ‚â§m) form a pairwise‚Äìdisjoint collection,
¬µ‚àó
 m

i=1
Ji

> ¬µ‚àó(E) ‚àíŒµ,
and
m

i=1
(f(xi) ‚àíf(xi ‚àíhi)) < s (¬µ‚àó(E) + Œµ) ;
(ii) Ô¨Ånitely many points y1, . . . , yn of E ‚à©m
i=1 Ji, and Ô¨Ånitely many
positive numbers h‚Ä≤
1, . . . , h‚Ä≤
n, such that
yk + h‚Ä≤
k < yk+1
(1 ‚â§k ‚â§n ‚àí1) ,
(4)
for each k there exists i with (yk, yk + h‚Ä≤
k) ‚äÇJi, and
n

k=1
(f(yk + h‚Ä≤
k) ‚àíf(yk)) > r (¬µ‚àó(E) ‚àí2Œµ) .
For each i with 1 ‚â§i ‚â§m let
Si = {k : (yk, yk + h‚Ä≤
k) ‚äÇJi} .
Since f is increasing, it follows from (4) that

k‚ààSi
(f(yk + h‚Ä≤
k) ‚àíf(yk)) ‚â§f(xi) ‚àíf(xi ‚àíhi).
Thus, as the intervals Ji are disjoint,
m

i=1
(f(xi) ‚àíf(xi ‚àíhi)) ‚â•
n

k=1
(f(yk + h‚Ä≤
k) ‚àíf(yk)) ,
so that
s (¬µ‚àó(E) + Œµ) > r (¬µ‚àó(E) ‚àí2Œµ) .
Since Œµ > 0 is arbitrary, it follows that s¬µ‚àó(E) ‚â•r¬µ‚àó(E). But r > s, so we
must have ¬µ‚àó(E) = 0.
2
We make good use of the following consequence of Theorem (2.1.10).
(2.1.11) Fubini‚Äôs Series Theorem.
Let (Fn) be a sequence of increas-
ing continuous functions on R such that F(x) = ‚àû
n=1 Fn(x) converges
for all x ‚ààR. Then almost everywhere, F is diÔ¨Äerentiable, ‚àû
n=1 F ‚Ä≤
n(x)
converges, and F ‚Ä≤(x) = ‚àû
n=1 F ‚Ä≤
n(x).

2.1 Outer Measure and Vitali‚Äôs Covering Theorem
91
Proof.
Fix real numbers a, b with a < b. It suÔ¨Éces to prove that
F ‚Ä≤(x) = ‚àû
n=1 F ‚Ä≤
n(x) almost everywhere on I = [a, b]: for then we can apply
the result to the intervals [‚àín, n] as n increases through N+. If necessary
replacing Fn by Fn ‚àíFn(a), we may assume that Fn(a) = 0. Write
sn(x) = F1(x) + ¬∑ ¬∑ ¬∑ + Fn(x)
(x ‚ààI)
and note that F ‚àísn = ‚àû
k=n+1 Fk is increasing and nonnegative. By
Theorem (2.1.10), sn is diÔ¨Äerentiable on I\An for some set An of measure
zero; likewise, F (which is clearly increasing) is diÔ¨Äerentiable on I\A0 for
some set A0 of measure zero. Then
A =
‚àû

n=0
An
has measure zero, by Exercise (2.1.1: 9). Since both F ‚àísn+1 and sn+1 ‚àísn
are increasing functions, for each x ‚ààI\A we have
s‚Ä≤
n(x) ‚â§s‚Ä≤
n+1(x) ‚â§F ‚Ä≤(x).
(5)
It follows from the monotone sequence principle that ‚àû
n=1 F ‚Ä≤
n(x) converges
to a sum ‚â§F ‚Ä≤(x).
Now choose an increasing sequence (nk)‚àû
k=1 of positive integers such that
for each k,
0 ‚â§F(b) ‚àísnk(b) ‚â§2‚àík.
Since F ‚àísnk is an increasing function, for each x ‚ààI we obtain the
inequalities
0 ‚â§F(x) ‚àísnk(x) ‚â§2‚àík.
Hence ‚àû
k=1 (F(x) ‚àísnk(x)) converges, by comparison with ‚àû
k=1 2‚àík.
Applying the Ô¨Årst part of the proof with Fk replaced by F ‚àísnk, we now
see that, almost everywhere on I, ‚àû
k=1

F ‚Ä≤(x) ‚àís‚Ä≤
nk(x)
	
converges and
therefore
lim
k‚Üí‚àû

F ‚Ä≤(x) ‚àís‚Ä≤
nk(x)
	
= 0.
It follows from (5) that
F ‚Ä≤(x) = lim
n‚Üí‚àûsn(x) =
‚àû

n=1
F ‚Ä≤
n(x)
almost everywhere on I.
2
(2.1.12) Exercises
.1
Let f be an increasing function on [a, b], and for each positive integer
n deÔ¨Åne
Sn =

x ‚àà(a, b) : D+f(x) > n

.

92
2. DiÔ¨Äerentiation and the Lebesgue Integral
Prove that
¬µ‚àó(I\Sn) < n‚àí1 (f(b) ‚àíf(a))
and hence that the set of those x ‚àà(a, b) at which D+f(x) is
undeÔ¨Åned has measure zero. (Use the Vitali Covering Theorem to
show that there exist Ô¨Ånitely many points x1, x2, . . . , xm of (a, b),
and positive numbers h1, h2, . . . , hm, such that xk + hk < xk+1 and
f(xk + hk) ‚àíf(xk) > nhk.)
.2
Let E be a bounded subset of R that has measure zero, and let a be
a lower bound for E. For each positive integer n choose a bounded
open set An ‚äÉE such that ¬µ‚àó(An) < 2‚àín (this is possible by Exercise
(2.1.3: 3)), and deÔ¨Åne
fn(x) =
Ô£±
Ô£≤
Ô£≥
0
if x < a
¬µ‚àó(An ‚à©[a, x])
if x ‚â•a.
Show that
(i) f = ‚àû
n=1 fn is an increasing continuous function on R;
(ii) D+f(x) is undeÔ¨Åned for each x ‚ààE.
.3
Prove that if f has bounded variation on [a, b], then it is diÔ¨Äerentiable
almost everywhere on [a, b]. (The converse is not true: see Exercise
(1.5.15: 4).)
.4
Let f have bounded variation on [a, b]. Prove that T ‚Ä≤
f(a, x) = |f ‚Ä≤(x)|
almost everywhere on [a, b]. (Using Lemma (1.5.17), construct a se-
quence (gn) of functions on I such that for each n, Tf(a, ¬∑) ‚àígn is
increasing, 0 ‚â§Tf(a, ¬∑)‚àígn ‚â§2‚àín, and g‚Ä≤
n = ¬±f ‚Ä≤ almost everywhere.
Then use Fubini‚Äôs Series Theorem.)
.5
Prove that if a bounded function f is continuous almost everywhere
on a compact interval I, then it is Riemann integrable. (Let M be a
bound for |f| on I, let E ‚äÇI = [a, b] be a set of measure zero such
that f is continuous on X = I\E, and let Œµ > 0. We may assume
that a, b ‚ààE. For each x ‚ààX there exist arbitrarily small r > 0 such
that [x, x + r] ‚äÇI and
|f(x‚Ä≤) ‚àíf(x‚Ä≤‚Ä≤)| <
Œµ
2(b ‚àía)
(x ‚â§x‚Ä≤ ‚â§x‚Ä≤‚Ä≤ ‚â§x + r).
The sets [x, x + r] of this type form a Vitali cover of X. With the
aid of the Vitali Covering Theorem, construct a partition P of I such
that U(P, f) ‚àíL(P, f) < Œµ.)

2.2 The Lebesgue Integral as an Antiderivative
93
.6
Prove the converse of the last exercise‚Äînamely, if a bounded function
f : [a, b] ‚ÜíR is Riemann integrable, then it is continuous almost
everywhere on [a, b]. (For each positive integer n deÔ¨Åne
An =

x ‚àà[a, b] : œâ(f, x) > 1
n

,
where œâ(f, x) is the oscillation of f at x; see Exercise (1.4.5: 7). Given
Œµ > 0, choose a partition P of [a, b] such that U(f, P) ‚àíL(f, P) <
Œµ/2n. Use this to construct a Ô¨Ånite set of intervals that cover An and
have total length less than Œµ.)
Re‚Äìexamine Exercise (1.5.10: 6) in the light of this result.
2.2
The Lebesgue Integral as an Antiderivative
In this section we show how Theorem (2.1.10) and Fubini‚Äôs Series Theorem
(2.1.11) can be used to introduce the Lebesgue integral, a very powerful
extension of the Riemann integral, as an antiderivative. Our approach3 is
based on a little‚Äìknown development by F. Riesz [39].
Let f be a nonnegative real‚Äìvalued function deÔ¨Åned almost everywhere
on R. A function F : R ‚ÜíR is called a Lebesgue primitive of f if it is
increasing, bounded below, and satisÔ¨Åes F ‚Ä≤ = f almost everywhere.
In order to discuss Lebesgue primitives, we Ô¨Årst consider the set Pf
of functions F : R ‚ÜíR that are increasing, bounded below, and satisfy
F ‚Ä≤ ‚â•f almost everywhere. Note that for such a function,
F(‚àí‚àû) =
lim
x‚Üí‚àí‚àûF(x)
exists: indeed, the sequence (F(‚àín))‚àû
n=1, which is decreasing and bounded
below, converges to a limit which is easily shown to be F(‚àí‚àû).
(2.2.1) Proposition.
If Pf is nonempty, then there exists an element
F‚àó‚ààPf, called an extremal element of Pf, such that
F‚àó(Œ∑) ‚àíF‚àó(Œæ) ‚â§F(Œ∑) ‚àíF(Œæ)
(1)
whenever Œæ < Œ∑ and F ‚ààPf.
Proof.
First note that the set
P0
f = {F ‚ààPf : F(‚àí‚àû) = 0}
3It is worth comparing this with the development of the Cauchy integral in
[13].

94
2. DiÔ¨Äerentiation and the Lebesgue Integral
is nonempty: for if F
‚ààPf, then F ‚àíF(‚àí‚àû) ‚ààP0
f. It is now a
straightforward exercise to show that
F‚àó(x) = inf

F(x) : F ‚ààP0
f

deÔ¨Ånes an increasing function F‚àó: R ‚ÜíR0+ with F‚àó(‚àí‚àû) = 0. Given
Œµ > 0 and real numbers Œæ, Œ∑ with Œæ < Œ∑, choose F1 ‚ààP0
f such that F1(Œæ) <
F‚àó(Œæ) + Œµ, and consider any element F of Pf. The function F2 deÔ¨Åned by
F2(x) =
Ô£±
Ô£≤
Ô£≥
F1(x)
if x ‚â§Œæ
F(x) + F1(Œæ) ‚àíF(Œæ)
if Œæ ‚â§x
belongs to P0
f, so
F‚àó(Œ∑) ‚â§F2(Œ∑)
= F(Œ∑) + F1(Œæ) ‚àíF(Œæ)
< F(Œ∑) + F‚àó(Œæ) + Œµ ‚àíF(Œæ),
and therefore
F‚àó(Œ∑) ‚àíF‚àó(Œæ) < F(Œ∑) ‚àíF(Œæ) + Œµ.
Since Œµ > 0 is arbitrary, inequality (1) follows.
Now let N be a positive integer, and choose a sequence (Fn) in P0
f such
that for each n,
0 ‚â§Fn(N) ‚àíF‚àó(N) ‚â§2‚àín.
For each x ‚àà[‚àíN, N] we have
F‚àó(N) ‚àíF‚àó(x) ‚â§Fn(N) ‚àíFn(x)
and therefore
0 ‚â§Fn(x) ‚àíF‚àó(x) ‚â§Fn(N) ‚àíF‚àó(N) ‚â§2‚àín.
Hence the series ‚àû
n=1 (Fn ‚àíF‚àó) of increasing functions converges at each
point of [‚àíN, N] , by comparison with ‚àû
n=1 2‚àín. Fubini‚Äôs Series Theorem
(2.1.11) now shows that ‚àû
n=1 (F ‚Ä≤
n ‚àíF ‚Ä≤
‚àó) converges almost everywhere on
[‚àíN, N]. Hence F ‚Ä≤
n ‚àíF ‚Ä≤
‚àó‚Üí0, and therefore F ‚Ä≤
‚àó‚â•f, almost everywhere on
[‚àíN, N]. Since the union of a sequence of sets of measure zero has measure
zero, it follows that F ‚Ä≤
‚àó‚â•f almost everywhere on R.
2
(2.2.2) Corollary.
Under the conditions of Proposition (2.2.1), F1 is an
extremal element of Pf if and only if F‚àó‚àíF1 is constant on R.
Proof.
If F1 is an extremal element of Pf, and Œæ ‚â§Œ∑, then
F‚àó(Œ∑) ‚àíF‚àó(Œæ) ‚â§F1(Œ∑) ‚àíF1(Œæ) ‚â§F‚àó(Œ∑) ‚àíF‚àó(Œæ)

2.2 The Lebesgue Integral as an Antiderivative
95
and therefore
F‚àó(Œ∑) ‚àíF‚àó(Œæ) = F1(Œ∑) ‚àíF1(Œæ).
It follows that
F1(x) ‚àíF‚àó(x) = F1(‚àí‚àû) ‚àíF‚àó(‚àí‚àû)
for all x ‚ààR. The converse is trivial.
2
(2.2.3) Corollary.
Under the conditions of Proposition (2.2.1), if f has
a Lebesgue primitive, then F‚àóis also a Lebesgue primitive.
Proof.
Let F be a Lebesgue primitive of f. Then F
‚ààPf, so by
Proposition (2.2.1),
F‚àó(Œ∑) ‚àíF‚àó(Œæ) ‚â§F(Œ∑) ‚àíF(Œæ)
(Œæ ‚â§Œ∑).
Since a Ô¨Ånite union of sets of measure zero has measure zero, it follows
from this inequality and Theorem (2.1.10) that
f ‚â§F ‚Ä≤
‚àó‚â§F ‚Ä≤ = f
almost everywhere. Hence F ‚Ä≤
‚àó= f almost everywhere, and F‚àóis a Lebesgue
primitive of f.
2
We say that a nonnegative function f deÔ¨Åned almost everywhere on R is
Lebesgue integrable (or simply integrable) if there is a bounded Lebesgue
primitive of f. In that case we deÔ¨Åne the Lebesgue integral (or simply the
integral) of f to be
$
f = F‚àó(‚àû) ‚àíF‚àó(‚àí‚àû),
where F‚àóis an extremal element of Pf and
F‚àó(‚àû) = lim
x‚Üí‚àûF‚àó(x).
(The existence of F‚àó(‚àû) is left as an exercise.) Corollary (2.2.2) shows that
the value of the integral of f does not depend on the choice of extremal
element F‚àóin Pf. Note that
$
f = sup
x<y (F‚àó(y) ‚àíF‚àó(x)) .
We often write
$
f =
$
f(x) dx =
$
f(t) dt = ¬∑ ¬∑ ¬∑ ,
as in elementary calculus courses.
(2.2.4) Exercises

96
2. DiÔ¨Äerentiation and the Lebesgue Integral
.1
In the notation of the proof of Proposition (2.2.1), prove that F‚àóis
an increasing function and that F‚àó(‚àí‚àû) = 0.
.2
Prove that if some element of Pf is bounded above and F‚àóis an
extremal element of Pf, then F‚àóis bounded above and F‚àó(‚àû) exists.
.3
Let f be an integrable nonnegative function, and F a Lebesgue primi-
tive of f. Prove that if F is absolutely continuous on each compact in-
terval, then it is an extremal element of Pf. (Use Proposition (2.1.7).)
Is every bounded Lebesgue primitive of f an extremal element of
Pf?
.4
Show that if f ‚â•0 is Lebesgue integrable, then
$
f = inf
*
sup
x<y (F(y) ‚àíF(x)) : F ‚ààPf
+
.
.5
Let f(x) equal a nonnegative constant c in a bounded interval I, and
0 outside I. Show that f is Lebesgue integrable, with
%
f = c |I| .
.6
Let f be an integrable nonnegative function. Prove that
%
f = 0 if
and only if f = 0 almost everywhere.
.7
Let f be an integrable nonnegative function such that
%
f > 0. Prove
that f(x) > 0 on some set with positive outer measure. (Suppose that
for all positive integers m and n,
Em,n =

x ‚àà[‚àím, m] : f(x) > 1
n

has measure zero, and use the preceding exercise to obtain a
contradiction.)
.8
Let f and g be integrable nonnegative functions such that f ‚â•g
almost everywhere, and let F, G be extremal elements of Pf, Pg,
respectively. Prove that
(i) F ‚àíG ‚ààPf‚àíg, and
(ii) f ‚àíg is integrable.
(For (ii) note that F ‚Ä≤ ‚â•g almost everywhere.)
.9
Let f be an integrable nonnegative function, and F a Lebesgue prim-
itive of f. Show that if F ‚Ä≤(Œæ) = f(Œæ) and sn ‚â§Œæ ‚â§sn + 2‚àín for each
n, then
lim
n‚Üí‚àû2‚àín
$ sn+2‚àín
sn
f = f(Œæ).
(Note Exercise (1.5.1: 3).)

2.2 The Lebesgue Integral as an Antiderivative
97
(2.2.5) Lemma.
Let Œ¶, Œ®, and Œ¶‚àíŒ® be increasing functions on R such
that Œ¶ is an extremal element of PŒ¶‚Ä≤ and Œ® is bounded. Then Œ® is an
extremal element of PŒ®‚Ä≤.
Proof.
Note that Œ¶‚Ä≤ and Œ®‚Ä≤ are deÔ¨Åned almost everywhere, by Proposi-
tion (2.1.10). Hence Œ® ‚ààPŒ®‚Ä≤. By Proposition (2.2.1), PŒ®‚Ä≤ has an extremal
element Œ®‚àó. The function
Œò = Œ¶ ‚àíŒ® + Œ®‚àó
is increasing, bounded below, and has derivative equal to Œ¶‚Ä≤ almost ev-
erywhere; so it belongs to PŒ¶‚Ä≤. Since Œ¶ is an extremal element of PŒ¶‚Ä≤, it
follows that Œ®‚àó‚àíŒ® = Œò ‚àíŒ¶ is an increasing function. But by our choice
of Œ®‚àó, Œ® ‚àíŒ®‚àóis an increasing function. It follows that Œ® ‚àíŒ®‚àóis constant;
whence, by Corollary (2.2.2), Œ® is an extremal element of PŒ®‚Ä≤.
2
(2.2.6) Proposition.
If f, g are integrable nonnegative functions deÔ¨Åned
almost everywhere, and Œª ‚â•0, then f + g and Œªf are integrable,
$
(f + g) =
$
f +
$
g,
(2)
and
$
Œªf = Œª
$
f.
Proof.
Let F‚àó, G‚àóbe extremal elements of Pf, Pg, respectively. Then
F‚àó+ G‚àóis a bounded Lebesgue primitive of f + g, which is therefore inte-
grable; but there is no guarantee that F‚àó+ G‚àóis an extremal element of
Pf+g, so we have to work harder to establish the identity (2). To this end,
let H‚àóbe an extremal element of Pf+g. Then F‚àó+G‚àó‚àíH‚àóis an increasing
function. On the other hand, H‚àóis increasing, and H‚Ä≤
‚àó= f + g ‚â•g almost
everywhere; so by our choice of G‚àó, H‚àó‚àíG‚àóis increasing. Applying Lemma
(2.2.5) with Œ¶ = H‚àóand Œ® = H‚àó‚àíG‚àó, we see that H‚àó‚àíG‚àóis an extremal
element of Pf; whence, by Corollary (2.2.2), H‚àó‚àíG‚àó‚àíF‚àóhas a constant
value c. It follows that
$
(f + g) = H‚àó(‚àû) ‚àíH‚àó(‚àí‚àû)
= (G‚àó(‚àû) + F‚àó(‚àû) + c) ‚àí(G‚àó(‚àí‚àû) + F‚àó(‚àí‚àû) + c)
= (F‚àó(‚àû) ‚àíF‚àó(‚àí‚àû)) + (G‚àó(‚àû) ‚àíG‚àó(‚àí‚àû))
=
$
f +
$
g.
It is left as an exercise to deal with Œªf.
2
(2.2.7) Proposition.
If (fn) is a sequence of integrable nonnegative
functions deÔ¨Åned almost everywhere, then f = inf fn is integrable.

98
2. DiÔ¨Äerentiation and the Lebesgue Integral
Proof.
For each n choose an extremal element F‚àón of Pfn, and note that,
by Corollary (2.2.3), F‚àón is a Lebesgue primitive of fn. Then F‚àón ‚ààPf, so
Pf is nonempty. By Proposition (2.2.1), there exists an extremal element
F‚àóof Pf, and F‚àón‚àíF‚àóis increasing; so (F‚àón ‚àíF‚àó)‚Ä≤ ‚â•0 almost everywhere.
Hence, almost everywhere,
fn = F ‚Ä≤
‚àón ‚â•F ‚Ä≤
‚àó‚â•f,
so
f = inf fn ‚â•F ‚Ä≤
‚àó‚â•f,
and therefore F ‚Ä≤
‚àó= f. Moreover, by Exercise (2.2.4: 2), F‚àón, and therefore
F‚àó, is bounded; so f is integrable.
2
(2.2.8) Corollary.
If f, g are integrable nonnegative functions, then so
are f ‚à®g and f ‚àßg.
Proof.
The integrability of f ‚àßg is a special case of Proposition (2.2.7);
that of f ‚à®g then follows from the identity
f ‚à®g = f + g ‚àíf ‚àßg,
Proposition (2.2.6), and Exercise (2.2.4: 8).
2
We now extend the Lebesgue integral to functions of variable sign. We say
that a real‚Äìvalued function f deÔ¨Åned almost everywhere on R is (Lebesgue)
integrable if there exist integrable nonnegative functions f1, f2 such that
f = f1 ‚àíf2; we then deÔ¨Åne the (Lebesgue) integral of f to be
$
f =
$
f1 ‚àí
$
f2.
(2.2.9) Exercises
.1
Prove that the foregoing is a good deÔ¨Ånition‚Äîin other words, that if
f1, f2, f3, f4 are integrable nonnegative functions such that f1 ‚àíf2 =
f3‚àíf4, then
%
f1‚àí
%
f2 =
%
f3‚àí
%
f4. Prove also that if a nonnegative
function f has a bounded Lebesgue primitive, then it is integrable in
the new sense, and its integrals in the old and new senses coincide.
.2
Show that f is integrable if and only if f + = f ‚à®0 and f ‚àí= (‚àíf)‚à®0
are integrable, in which case
%
f =
%
f + ‚àí
%
f ‚àí. (Choose integrable
nonnegative functions f1, f2 such that f = f1 ‚àíf2, and note that
f + = f1 ‚àíf1 ‚àßf2.)
.3
Prove that if f, g are integrable and Œª ‚ààR, then f + g and Œªf are
integrable,
%
(f + g) =
%
f +
%
g, and
%
Œªf = Œª
%
f. (For the last part
you will Ô¨Årst need to complete the proof of Proposition (2.2.6).)

2.2 The Lebesgue Integral as an Antiderivative
99
.4
Prove that if f, g are integrable functions such that f ‚â•g almost
everywhere, then
%
f ‚â•
%
g.
.5
Prove that if f is integrable, then so is |f| , and
  %
f
  ‚â§
%
|f| .
.6
Show that if f and g are integrable, then so are f ‚à®g and f ‚àßg.
(Reduce to the case where f and g are nonnegative.)
.7
Let (fn)‚àû
n=0 be a sequence of integrable functions. Prove that
(i) if fn ‚â•f0 almost everywhere, then infn‚â•1 fn is integrable;
(ii) if fn ‚â§f0 almost everywhere, then supn‚â•1 fn is integrable.
.8
Let f be a step function‚Äîthat is, a function, deÔ¨Åned almost
everywhere on R, for which there exist points
a = x1 < x2 < ¬∑ ¬∑ ¬∑ < xn = b
and real numbers c1, . . . , cn‚àí1 such that
f(x) =
Ô£±
Ô£≤
Ô£≥
ci
if xi < x < xi+1
0
if x < a or x > b.
Give two proofs that f is integrable and that
$
f =
n‚àí1

i=1
ci(xi+1 ‚àíxi).
.9
Let f be integrable, t a real number, and g(x) = f(x+t). Prove that g
is integrable, with
%
g =
%
f. (Translation invariance of the Lebesgue
integral. First consider the case where f is nonnegative. Let F‚àóbe an
extremal element of Pf, and deÔ¨Åne G‚àó(x) = F‚àó(x + t); prove that G‚àó
is a bounded Lebesgue primitive of g, and that
%
g ‚â§
%
f.)
Let A be a subset of R. The characteristic function of A is the mapping
œáA : R ‚ÜíR deÔ¨Åned by
œáA(x) =
Ô£±
Ô£≤
Ô£≥
1
if x ‚ààA
0
if x /‚ààA.
A function f deÔ¨Åned almost everywhere is said to be integrable over A if
fœáA is integrable, in which case we deÔ¨Åne
$
A
f =
$
fœáA.

100
2. DiÔ¨Äerentiation and the Lebesgue Integral
If A is a compact interval [a, b] , we write
% b
a f for
%
A f. If A is a closed
inÔ¨Ånite interval, we use the natural analogous notations; for example, if
A = [a, ‚àû), we write
% ‚àû
a f for
%
A f.
(2.2.10) Proposition.
If f is an integrable function, then f is integrable
over any interval. Moreover, if f is nonnegative and F‚àóis an extremal
element of Pf, then
$ b
a
f = F‚àó(b) ‚àíF‚àó(a)
whenever a ‚â§b.
Proof.
We only discuss the case where f is nonnegative and the interval
is of the form I = [a, b] with a ‚â§b. Accordingly, we deÔ¨Åne
F(x) =
Ô£±
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£≤
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£≥
F‚àó(a)
if x < a
F‚àó(x)
if a ‚â§x ‚â§b
F‚àó(b)
if x > b.
Then F is a Lebesgue primitive of fœáI and so belongs to PfœáI. We show
that F is an extremal element of PfœáI. Let G ‚ààPfœáI, and for each pair of
real numbers Œ±, Œ≤ with Œ± < Œ≤ deÔ¨Åne
HŒ±,Œ≤(x) =
Ô£±
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£≤
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£≥
F‚àó(x) + G(Œ±) ‚àíF‚àó(Œ±)
if x < Œ±,
G(x)
if Œ± ‚â§x ‚â§Œ≤,
F‚àó(x) + G(Œ≤) ‚àíF‚àó(Œ≤)
if x > Œ≤.
Note that if a ‚â§Œ± < Œ≤ ‚â§b, then HŒ±,Œ≤ ‚ààPf. Consider real numbers Œæ, Œ∑
with Œæ < Œ∑. If Œ∑ < a or Œæ > b, then F(Œ∑) = F(Œæ) and so
F(Œ∑) ‚àíF(Œæ) ‚â§G(Œ∑) ‚àíG(Œæ)
(3)
holds trivially. If a ‚â§Œæ < Œ∑ ‚â§b, then
F(Œ∑) ‚àíF(Œæ) = F‚àó(Œ∑) ‚àíF‚àó(Œæ)
‚â§HŒæ,Œ∑(Œ∑) ‚àíHŒæ,Œ∑(Œæ)
= G(Œ∑) ‚àíG(Œæ).
If Œæ < a and Œ∑ > b, then, as Ha,b ‚ààPf and G is increasing,
F(Œ∑) ‚àíF(Œæ) = F‚àó(b) ‚àíF‚àó(a)
‚â§Ha,b(b) ‚àíHa,b(a)
= G(b) ‚àíG(a)
‚â§G(Œ∑) ‚àíG(Œæ).

2.2 The Lebesgue Integral as an Antiderivative
101
Hence (3) holds in all possible cases, so F is an extremal element of PfœáI.
Since F is bounded by F‚àó, f is integrable over I and
$ b
a
f = F(‚àû) ‚àíF(‚àí‚àû) = F‚àó(b) ‚àíF‚àó(a).
2
(2.2.11) Exercises
.1
Let f be an integrable nonnegative function, and F‚àóan extremal
element of Pf. Prove that for each x ‚ààR, f is integrable over (‚àí‚àû, x]
and
$ x
‚àí‚àû
f = F‚àó(x) ‚àíF‚àó(‚àí‚àû).
.2
Complete the proof of Proposition (2.2.10) in the remaining cases.
.3
Let f be a nonnegative integrable function such that
% x
‚àí‚àûf = 0 for
each x ‚ààR. Prove that f = 0 almost everywhere.
.4
Find expressions for œáA‚à©B, œáA‚à™B, and œáA\B in terms of œáA and œáB.
Prove that if f is integrable over both A and B, then it is integrable
over A ‚à©B, A ‚à™B, and A\B. Prove also that
(i) if A and B are disjoint, then
%
A‚à™B f =
%
A f +
%
B f;
(ii) if B ‚äÇA, then
%
A\B f =
%
A f ‚àí
%
B f.
.5
Let f be a nonnegative integrable function, [a, b] a compact interval,
and m a real number such that f(x) ‚â•m for each x ‚àà(a, b) . Give two
proofs that
% b
a f ‚â•m(b ‚àía). (For one proof use Proposition (2.1.7).)
.6
Let f be a nonnegative integrable function, F a bounded Lebesgue
primitive of f, and [a, b] a compact interval. Must we have
% b
a f =
F(b) ‚àíF(a)?
The power of the Lebesgue integral only appears when we consider the
interplay between the operations of integration and of taking limits. There
now follows a string of results and exercises that deal with this topic.
A sequence (fn)‚àû
n=1 of real-valued functions deÔ¨Åned almost everywhere
is said to be increasing (respectively, decreasing) if f1 ‚â§f2 ‚â§¬∑ ¬∑ ¬∑
(respectively, f1 ‚â•f2 ‚â•¬∑ ¬∑ ¬∑) almost everywhere.
(2.2.12) Beppo Levi‚Äôs Theorem.
Let (fn) be an increasing sequence
of integrable functions such that the corresponding sequence of integrals
is bounded above. Then (fn) converges almost everywhere to an integrable
function f, and
%
f = limn‚Üí‚àû
%
fn.

102
2. DiÔ¨Äerentiation and the Lebesgue Integral
Proof.
Replacing fn by fn ‚àíf1 if necessary, we may assume that fn ‚â•0.
Choose M > 0 such that
%
fn ‚â§M for each n. By Exercise (2.2.11: 1) and
Corollary (2.2.2),
Fn(x) =
$ x
‚àí‚àû
fn
deÔ¨Ånes an extremal element Fn of Pfn. Since
fnœá(‚àí‚àû,x] ‚â§fn+1œá(‚àí‚àû,x] ‚â§fn+1,
it follows from Exercise (2.2.9: 4) that (Fn(x))‚àû
n=1 is an increasing sequence
that is bounded above by M and therefore converges to a limit F(x) ‚â§
M. Since each Fn is an increasing function, so is F; whence, by Theorem
(2.1.10), F is diÔ¨Äerentiable almost everywhere.
If m > n, then F ‚Ä≤
m = fm ‚â•fn almost everywhere, so Fm ‚ààPfn. Thus if
x < y, then
Fn(y) ‚àíFn(x) ‚â§Fm(y) ‚àíFm(x);
letting m ‚Üí‚àû, we obtain
Fn(y) ‚àíFn(x) ‚â§F(y) ‚àíF(x).
It follows that F ‚Ä≤ ‚â•F ‚Ä≤
n = fn almost everywhere, which ensures that, almost
everywhere, the increasing sequence (fn) converges to a limit f satisfying
f = sup fn ‚â§F ‚Ä≤.
Since F ‚Ä≤ is integrable (F is a bounded Lebesgue primitive of F ‚Ä≤), it follows
from Exercise (2.2.9: 7) that f is integrable. Finally, by Exercises (2.2.4: 4)
and (2.2.9: 4),
F(‚àû) ‚àíF(‚àí‚àû) ‚â•
$
F ‚Ä≤ ‚â•
$
f ‚â•
$
fn
= Fn(‚àû) ‚àíFn(‚àí‚àû)
‚ÜíF(‚àû) ‚àíF(‚àí‚àû) as n ‚Üí‚àû,
so
$
f = F(‚àû) ‚àíF(‚àí‚àû) = lim
n‚Üí‚àû
$
fn.
2
(2.2.13) Exercises
.1
Let Œ± ‚ààR, and deÔ¨Åne
f(x) =
Ô£±
Ô£≤
Ô£≥
xŒ±
if x > 0
0
if x ‚â§0.
Prove that f is integrable over [1, ‚àû) if and only if Œ± < 1, and that
f is integrable over [0, 1) if and only if Œ± > 1. Calculate
%
f in each
case.

2.2 The Lebesgue Integral as an Antiderivative
103
.2
DeÔ¨Åne f(x) = e‚àíŒ±x, where Œ± is a positive constant. Prove that f is
integrable, and calculate
%
f.
.3
Let f be an integrable function, and I a bounded interval. Use Beppo
Levi‚Äôs Theorem to prove that f is integrable over I. (Consider the
sequence (f ‚àßgn)‚àû
n=1, where gn(x) = n if x ‚ààI, and gn(x) = 0
otherwise.) Extend this result to an unbounded interval I. (First take
f ‚â•0. Consider the sequence (fn), where fn(x) = f(x) if x ‚ààI ‚à©
[‚àín, n] , and fn(x) = 0 otherwise.)
.4
Prove Lebesgue‚Äôs Series Theorem: if ‚àû
n=1 fn is a series of integrable
functions such that the series ‚àû
n=1
%
|fn| converges, then ‚àû
n=1 fn
converges almost everywhere to an integrable function, and
$
‚àû

n=1
fn =
‚àû

n=1
$
fn.
(Consider the partial sums of the series ‚àû
n=1 f +
n and ‚àû
n=1 f ‚àí
n .)
.5
Use the preceding exercise to give another proof that if f is a non-
negative integrable function satisfying
%
f = 0, then f = 0 almost
everywhere (See also Exercises (2.2.11: 3) and (2.2.4: 6).)
.6
Let (An) be a sequence of subsets of R, and f a function that is
integrable over each An, such that ‚àû
n=1
%
An |f| converges. Prove
that
(i) f is integrable over A = ‚àû
n=1 An, and
%
A |f| ‚â§‚àû
n=1
%
An |f| ;
(ii) if also the sets An are pairwise‚Äìdisjoint, then
%
A f = ‚àû
n=1
%
An f.
.7
Let f be an integrable function, and Œµ > 0. Show that there exists
a bounded interval I such that
%
R\I |f| < Œµ. (Consider |f| œán, where
œán is the characteristic function of [‚àín, n] .)
.8
Prove that the series ‚àû
n=1 e‚àín2x converges for each x > 0. DeÔ¨Åne
f(x) =
Ô£±
Ô£≤
Ô£≥
‚àû
n=1 e‚àín2x
if x > 0
0
if x ‚â§0.
Prove that f is integrable, and that
%
f = ‚àû
n=1 1/n2.
.9
Let (fn) be a sequence of integrable functions such that 0 ‚â§f1 ‚â§
f2 ‚â§¬∑ ¬∑ ¬∑ almost everywhere. Show that limn‚Üí‚àû
%
fn = 0 if and only if
limn‚Üí‚àûfn(x) = 0 almost everywhere. (For ‚Äúonly if‚Äù choose a subse-
quence (fnk)‚àû
k=1 such that
%
fnk ‚â§2‚àík for each k, and use Lebesgue‚Äôs
Series Theorem.)

104
2. DiÔ¨Äerentiation and the Lebesgue Integral
.10 Let (fn) be a sequence of step functions such that 0 ‚â§fn+1 ‚â§fn
almost everywhere and limn‚Üí‚àû
%
fn = 0. Without using any of the
foregoing theorems or exercises about the convergence of integrals,
prove that limn‚Üí‚àûfn(x) = 0 almost everywhere.4 (Use the Vitali
Covering Theorem.)
.11 Prove Fatou‚Äôs Lemma: if (fn) is a sequence of nonnegative integrable
functions that converges almost everywhere to a function f, and if
the sequence
%
fn
	‚àû
n=1 is bounded above, then f is integrable and
$
f ‚â§lim inf
$
fn.
(Apply Beppo Levi‚Äôs Theorem to the functions gn = infk‚â•n fk.)
.12 Let f be deÔ¨Åned almost everywhere, and suppose that for each Œµ > 0
there exist integrable functions g, h such that g ‚â§f ‚â§h almost
everywhere and
%
(h ‚àíg) < Œµ. Prove that f is integrable. (For each
n choose integrable functions gn, hn such that gn ‚â§f ‚â§hn almost
everywhere and
%
(hn ‚àígn) < 2‚àín.)
.13 Prove that if E is a set of measure zero, then there exists a non-
negative integrable function f such that
%
f = 0 and f(x) = 1 for
all x ‚ààE. (For each positive integer n choose a sequence (In,k)‚àû
k=1
of pairwise‚Äìdisjoint bounded open intervals such that E ‚äÇAn =
‚àû
k=1 In,k and ‚àû
k=1 |In,k| < 1/n. Let f be the characteristic function
of ‚àû
n=1 An.)
Let f, g be functions deÔ¨Åned almost everywhere. We say that g dominates
f if |f| ‚â§g almost everywhere.
(2.2.14) Lebesgue‚Äôs Dominated Convergence Theorem.
Let (fn)
be a sequence of integrable functions that converges almost everywhere to
a function f, and suppose that there exists an integrable function g that
dominates each fn. Then f is integrable, and
%
f = limn‚Üí‚àû
%
fn.
Proof.
The functions
gn = sup
k‚â•n
fk
are integrable, by Exercise (2.2.9: 7), and form a decreasing sequence con-
verging to f almost everywhere. Noting that
%
(‚àígn) ‚â§
%
g, we now apply
4This is the basic result in another approach to Lebesgue integration on R,
which starts by deÔ¨Åning the integral of a step function and then considers the
convergence of a sequence (fn) of step functions when the corresponding sequence
of integrals is bounded above; see [40].

2.2 The Lebesgue Integral as an Antiderivative
105
Beppo Levi‚Äôs theorem to the sequence (‚àígn) to show that f is integrable
and that
%
gn ‚Üí
%
f. Replacing fn by ‚àífn in this argument, we see that
%
hn ‚Üí
%
f, where
hn = inf
k‚â•n fk.
Finally, hn ‚â§fn ‚â§gn, so
$
hn ‚â§
$
fn ‚â§
$
gn,
and therefore
%
fn ‚Üí
%
f.
2
(2.2.15) Exercises
.1
Prove that if f is an integrable function, then
%
(f ‚àßn) ‚Üí
%
f as
n ‚Üí‚àû.
.2
Let f be an integrable function, and for each n deÔ¨Åne fn = (f ‚àßn) ‚à®
‚àín. Prove that
%
|f ‚àífn| ‚Üí0 as n ‚Üí‚àû.
.3
Give two proofs that if f is an integrable function, then
% 
|f| ‚àßn‚àí1	
‚Üí0 as n ‚Üí‚àû.
.4
Give an example of a sequence (fn) of integrable functions such that
limn‚Üí‚àûfn = 0 almost everywhere, limn‚Üí‚àû
%
fn = 0, and there is no
integrable function that dominates each fn.
.5
Let (fn) be a sequence of integrable functions converging almost ev-
erywhere to a function f, and let g be an integrable function that
dominates f. Show that f is integrable, and that
%
f = limn‚Üí‚àû
%
fn.
(Consider the functions (fn ‚àßg) ‚à®‚àíg.)
With the help of Lebesgue‚Äôs Dominated Convergence Theorem we can
prove the converse of Exercise (2.2.4: 3), and thereby, for a nonnegative in-
tegrable function f, complete the characterisation of the extremal elements
of Pf among the Lebesgue primitives of f.
(2.2.16) Proposition.
If f is a nonnegative integrable function, then
each extremal element of Pf is absolutely continuous on each compact
interval.
Proof.
Let I = [a, b] be a compact interval. Given an extremal element F
of Pf, consider Ô¨Årst the case where f is bounded above almost everywhere
by some constant M > 0. The function x ‚ÜíMx is increasing and has
derivative M ‚â•f almost everywhere. It follows from Proposition (2.2.1)

106
2. DiÔ¨Äerentiation and the Lebesgue Integral
that F(Œ∑) ‚àíF(Œæ) ‚â§M(Œ∑ ‚àíŒæ) whenever Œæ ‚â§Œ∑. So if ([ak, bk])n
k=1 is a Ô¨Ånite
sequence of nonoverlapping subintervals of I, then
n

k=1
|F(bk) ‚àíF(ak)| ‚â§M
n

k=1
(bk ‚àíak),
from which the absolute continuity of F readily follows.
In the general case we deÔ¨Åne
fn = (f ‚àßn) ‚à®‚àín
for each positive integer n. Given Œµ > 0, we see from Exercise (2.2.15: 2) that
there exists N such that
%
|f ‚àífN| < Œµ. Choose an extremal element FN
of PfN . If ([ak, bk])n
k=1 is a Ô¨Ånite sequence of nonoverlapping subintervals
of I, then by Proposition (2.2.10),
n

k=1
|F(bk) ‚àíF(ak)| =
n

k=1
     
$ bk
ak
f
     
‚â§
n

k=1
     
$ bk
ak
fN
     +
n

k=1
$ bk
ak
|f ‚àífN|
‚â§
n

k=1
|FN(bk) ‚àíFN(ak)| +
$ b
a
|f ‚àífN|
<
n

k=1
|FN(bk) ‚àíFN(ak)| + Œµ.
Since, by the Ô¨Årst part of the proof, FN is absolutely continuous, it follows
that F is absolutely continuous.
2
(2.2.17) Exercises
.1
Let f be an integrable function, and F the function deÔ¨Åned by
F(x) =
$ x
‚àí‚àû
f.
Prove that F is absolutely continuous on each compact interval.
.2
Prove that if G : R ‚ÜíR is absolutely continuous on each com-
pact interval, then there exists an integrable function g such that
G‚Ä≤ = g almost everywhere. (Note that for a ‚â§x, G(x) = TG(a, x) ‚àí
(TG(a, x) ‚àíG(x)) .)
.3
Let f be a nonnegative continuous function on a compact interval
I = [a, b] , and extend f to R by setting f(x) = 0 for all x outside I.

2.2 The Lebesgue Integral as an Antiderivative
107
Prove that f is integrable over [a, b], and that
% b
a f = ,
% b
a f, where -%
denotes the Riemann integral. (Let
F(x) =
Ô£±
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£≤
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£≥
0
if x ‚â§a
,
% x
a f
if a ‚â§x ‚â§b
,
% b
a f
if x > b,
and show that F is absolutely continuous.)
Two fundamental techniques of calculus are changing the variable in an
integral, and integration by parts. We now deal with the former, the latter
being left to the next set of exercises.
(2.2.18) Proposition.
Let g be an absolutely continuous, increasing
function on I = [Œ±, Œ≤] , a = g(Œ±), b = g(Œ≤), and f an integrable function
on [a, b]. Then (f ‚ó¶g)g‚Ä≤ is integrable, and
$ b
a
f =
$ Œ≤
Œ±
(f ‚ó¶g)g‚Ä≤.
Proof.
We may take f = g = 0 outside [a, b]. By considering f + and
f ‚àíseparately, we reduce to the case where f is nonnegative. Moreover,
we may assume that f is bounded: for if we have proved the proposition
in the bounded case, we obtain the desired result in the general case for
nonnegative f by considering f ‚àßn, letting n ‚Üí‚àû, and using Beppo Levi‚Äôs
Theorem.
Note that, by Corollary (1.4.12), g maps [Œ±, Œ≤] onto [a, b] . Choose M
such that 0 ‚â§f ‚â§M, and let F be an extremal element of Pf. Then the
function
G = F ‚ó¶g
is increasing. Since t ‚ÜíMt belongs to Pf, if Œ± ‚â§Œæ < Œ∑ ‚â§Œ≤, then
G(Œ∑) ‚àíG(Œæ) = F(g(Œ∑)) ‚àíF(g(Œæ)) ‚â§Mg(Œ∑) ‚àíMg(Œæ);
(4)
so the function Mg ‚àíG is increasing. Since, by Exercise (2.2.4: 3), Mg is
an extremal element of PMg‚Ä≤, we can apply Lemma (2.2.5) with Œ¶ = Mg
and Œ® = G, to show that G is an extremal element of PG‚Ä≤; whence
$ b
a
f = F(b) ‚àíF(a) = G(Œ≤) ‚àíG(Œ±) =
$ Œ≤
Œ±
G‚Ä≤.
It therefore remains to prove that
G‚Ä≤(t) = f(g(t))g‚Ä≤(t)
(5)

108
2. DiÔ¨Äerentiation and the Lebesgue Integral
almost everywhere in I.
Consider the set of those t ‚àà(Œ±, Œ≤) for which (5) fails to hold. This may
be split into Ô¨Åve subsets, as follows:
‚Ä¢ the set A1 of measure zero on which G‚Ä≤(t) does not exist;
‚Ä¢ the set A2 of measure zero on which g‚Ä≤(t) does not exist (see Exercises
(2.1.6: 4) and (2.1.12: 3));
‚Ä¢ the set A3 of measure zero on which F ‚Ä≤(g(t)) does not exist;
‚Ä¢ the set A4 of measure zero on which f(g(t)) does not exist;
‚Ä¢ the set B of those t ‚ààI\ 4
k=1 Ak such that F ‚Ä≤(g(t)) Ã∏= f(g(t)).
To complete the proof for bounded nonnegative f, we show that B has
measure zero. If t ‚ààB and g‚Ä≤(t) = 0, then it follows from (4) that
|G‚Ä≤(t)| ‚â§lim
h‚Üí0
|Mg(t + h) ‚àíMg(t)|
|h|
= Mg‚Ä≤(t) = 0,
so (5) holds. Let
C = {t ‚ààB : g‚Ä≤(t) exists and is nonzero, and F ‚Ä≤(g(t)) Ã∏= f(g(t))} .
Since F is a Lebesgue primitive of f, g(C) has measure zero; we must show
that C itself has measure zero. To this end, for all positive integers m, n
let Cm,n be the set of those t ‚ààC such that if Œ± < t1 ‚â§t ‚â§t2 < Œ≤ and
g(t2) ‚àíg(t1) ‚â§1/m, then
g(t2) ‚àíg(t1) ‚â•t2 ‚àít1
n
.
Then (Exercise (2.2.19: 1)) C = ‚àû
m,n=1 Cm,n, so we need only prove that
for Ô¨Åxed m and n, Cm,n has measure zero. Since Cm,n ‚äÇC, g(Cm,n) has
measure zero; so for each Œµ > 0 there exists a sequence ([ak, bk])‚àû
k=1 of
compact subintervals of (a, b) such that
(i) bk ‚àíak < 1/m for each k,
(ii) g(Cm,n) ‚äÇ‚àû
k=1 [ak, bk] , and
(iii) ‚àû
k=1(bk ‚àíak) < Œµ/n.
Clearly, we may assume that g(Cm,n) ‚à©(ak, bk) is nonempty for each k.
Since g is continuous and increasing, it follows from the Intermediate Value
Theorem that each [ak, bk] is the image under g of a compact subinterval
[Œ±k, Œ≤k] of [Œ±, Œ≤] . For each k choose t ‚ààCm,n with Œ±k ‚â§t ‚â§Œ≤k. Since
g(Œ≤k) ‚àíg(Œ±k) = bk ‚àíak < 1
m,

2.2 The Lebesgue Integral as an Antiderivative
109
the deÔ¨Ånition of Cm,n ensures that
bk ‚àíak ‚â•Œ≤k ‚àíŒ±k
n
.
Thus the intervals [Œ±k, Œ≤k] cover Cm,n and have total length
‚àû

k=1
(Œ≤k ‚àíŒ±k) ‚â§
‚àû

k=1
n(bk ‚àíak) < Œµ.
Since Œµ is arbitrary, it follows that Cm,n has measure zero.
2
(2.2.19) Exercises
.1
In the notation of the proof of Proposition (2.2.18), show that C =
‚àû
m,n=1 Cm,n.
.2
This exercise deals with integration by parts. Let f, g be integrable
functions, and I = [a, b] a compact interval. For a ‚â§x ‚â§b deÔ¨Åne
F(x) =
$ x
a
f,
G(x) =
$ x
a
g.
Prove that the functions Fg and fG, extended to equal 0 outside I,
are integrable over I and that
$ b
a
Fg +
$ b
a
fG = F(b)G(b) ‚àíF(a)G(a).
The Ô¨Ånal set of exercises in this section explores further the relation
between Riemann and Lebesgue integration. For this purpose, we again
denote the Riemann integral by -%
.
(2.2.20) Exercises
.1
Let the bounded function f be Riemann integrable over the compact
interval I = [a, b] . Show that for each Œµ > 0 there exist step functions
g, h that vanish outside I, such that g ‚â§f ‚â§h,
$
g ‚â§
,
$ b
a
f ‚â§
$
h,
and
%
(h ‚àíg) ‚â§Œµ. Then use Exercise (2.2.13: 12) to deduce that f
is Lebesgue integrable over I and that the Lebesgue and Riemann
integrals of f over I are equal.

110
2. DiÔ¨Äerentiation and the Lebesgue Integral
.2
DeÔ¨Åne f : [0, 1] ‚ÜíR by
f(x) =
Ô£±
Ô£≤
Ô£≥
1
if x is irrational
0
if x is rational.
Show that f, which we have already shown is not Riemann integrable
(Exercise (1.5.10: 6)), is Lebesgue integrable over [0, 1], with
% 1
0 f = 1.
.3
Let f be a bounded nonnegative function on R that is Riemann
integrable over each compact interval, such that the inÔ¨Ånite Riemann
integral J = limn‚Üí‚àû.
% n
‚àínf exists. Prove that f is Lebesgue integrable
and that its Lebesgue integral equals J. Need this conclusion hold if
f is allowed to take negative values?
.4
Let (fn) be an increasing sequence of Riemann integrable functions
over a compact interval [a, b] , such that f(x) = limn‚Üí‚àûfn(x) deÔ¨Ånes
a Riemann integrable function over [a, b]. Prove that
,
$ b
a
f = lim
n‚Üí‚àû
,
$ b
a
fn.
2.3
Measurable Sets and Functions
A function f deÔ¨Åned almost everywhere on R is said to be measurable if it
is the limit almost everywhere of a sequence of integrable functions. Clearly,
an integrable function is measurable.
(2.3.1) Proposition.
If a measurable function is dominated by an
integrable function, then it is integrable.
Proof.
Let g be an integrable function dominating a measurable function
f, and choose a sequence (fn) of integrable functions converging to f almost
everywhere. For each n deÔ¨Åne
gn = (fn ‚àßg) ‚à®‚àíg.
Then gn is integrable, by Exercise (2.2.9: 6), and is dominated by g; also,
lim
n‚Üí‚àûgn = (f ‚àßg) ‚à®‚àíg = f
almost everywhere. It follows from Lebesgue‚Äôs Dominated Convergence
Theorem (2.2.14) that f is integrable.
2
(2.3.2) Corollary.
A measurable function f is integrable if and only if
|f| is integrable.

2.3 Measurable Sets and Functions
111
Proof.
If |f| is integrable, then, as it dominates f, we see from Propo-
sition (2.3.1) that f is integrable. For the converse we refer to Exercise
(2.2.9: 5).
2
(2.3.3) Exercises
.1
Prove that if f is a measurable function and I is an interval, then
fœáI is measurable.
.2
Prove that a continuous function f : R ‚ÜíR is measurable.
.3
Let f, g be measurable functions. Prove that f + g, f ‚àíg, f ‚à®g, and
f ‚àßg are measurable.
.4
Let (fn) be a sequence of measurable functions that converges almost
everywhere to a function f. Prove that f is measurable. (For each k
deÔ¨Åne the step function gk by
gk(x) =
Ô£±
Ô£≤
Ô£≥
k
if ‚àík ‚â§x ‚â§k
0
otherwise.
First prove that (f ‚àßgk) ‚à®‚àígk is integrable.)
.5
Let f be a measurable function, and p a positive number. Prove that
|f|p is measurable.
.6
Give an example of a measurable function f which is not integrable
even though f 2 is.
.7
Give two proofs that the product of two measurable functions is
measurable. (For one proof use Exercises (2.3.3: 3 and 5).)
.8
Let the measurable function f be nonzero almost everywhere. Prove
that 1/f is measurable. (First consider the case where f ‚â•c almost
everywhere for some positive constant c. For general f ‚â•0 consider
fn = 1
#
f + n‚àí1	
.)
.9
Let f be a measurable function, and œï : R ‚ÜíR a continuous func-
tion. Prove that œï‚ó¶f is measurable. (Reduce to the case where f van-
ishes outside a compact interval [a, b] . Then use Exercise (2.2.4: 9) to
construct a sequence (fn) of step functions that vanish outside [a, b]
and converge almost everywhere to f.)
.10 Let ‚àí2 < Œ± < ‚àí1, and deÔ¨Åne
f(x) =
Ô£±
Ô£≤
Ô£≥
xŒ± sin x
if x > 0
0
if x ‚â§0.
Prove that f is integrable over (0, ‚àû).

112
2. DiÔ¨Äerentiation and the Lebesgue Integral
.11 DeÔ¨Åne
f(x) =
Ô£±
Ô£¥
Ô£≤
Ô£¥
Ô£≥
sin x
x
if x > 0
0
if x ‚â§0.
Prove that f is measurable but not integrable. (For the second part
suppose that f is integrable, so |f| is integrable. Use the inequality
$
|f| ‚â•
N

n=1
$ 2nœÄ+œÄ/3
2nœÄ
f
(N ‚ààN+)
to derive a contradiction.)
.12 Let Œ± > 0, and deÔ¨Åne
f(x) =
Ô£±
Ô£≤
Ô£≥
e‚àíxxŒ±‚àí1
if x > 0
0
if x ‚â§0.
Prove that f is integrable. (Consider the functions fœá(‚àí‚àû,1] and
fœá(1,‚àû) separately.)
.13 Give two proofs of the Riemann‚ÄìLebesgue Lemma: if f is an integrable
function, then the functions x ‚Üíf(x) sin nx and x ‚Üíf(x) cos nx are
integrable, and
lim
n‚Üí‚àû
$
f(x) sin nx dx = 0,
lim
n‚Üí‚àû
$
f(x) cos nx dx = 0.
(One proof proceeds like this. First reduce to the case where f ‚â•0
and f vanishes outside a compact interval I = [‚àíNœÄ, NœÄ] for some
positive integer N. Let F be an extremal element of Pf, and carry
out integration by parts on
% NœÄ
‚àíNœÄ F ‚Ä≤(x) sin nx dx.)
.14 Let œï, œà, Œ∏ be nonnegative bounded integrable functions on I = [0, c]
such that
Œ∏(x) ‚â§œï(x) +
$ x
0
œà(t)Œ∏(t) dt
(x ‚ààI).
Prove that
Œ∏(x) ‚â§œï(x) +
$ x
0
œï(t)œà(t) exp
$ x
t
œà(s) ds

dt
(x ‚ààI).
(DeÔ¨Åne
Œ≥(x)
=
$ x
0
œà(t)Œ∏(t) dt,
Œª(x)
=
Œ≥(x) exp

‚àí
$ x
0
œà(t) dt

.

2.3 Measurable Sets and Functions
113
Show that
Œª‚Ä≤(x) ‚â§œï(x)œà(x) exp

‚àí
$ x
0
œà(t) dt

almost everywhere on I, and then use Proposition (2.1.7).)
A subset A of R is called a measurable set (respectively, integrable set) if
œáA is a measurable (respectively, integrable) function. A measurable subset
of an integrable set is integrable, by Proposition (2.3.1).
If A ‚äÇR is integrable, we deÔ¨Åne its (Lebesgue) measure to be ¬µ(A) =
%
œáA.
(2.3.4) Exercises
.1
Let A, B be measurable sets. Prove that A ‚à™B, A ‚à©B, and A\B are
measurable.
.2
Let (An) be a sequence of pairwise‚Äìdisjoint measurable sets. Prove
that
(i) ‚àû
n=1 An is measurable;
(ii) if ‚àû
n=1 ¬µ(An) is convergent, then ‚àû
n=1 An is integrable, and
¬µ (‚àû
n=1 An) = ‚àû
n=1 ¬µ(An).
.3
Prove that any interval in R is measurable.
.4
Let B be the smallest collection of subsets of R that satisÔ¨Åes the
following properties.
‚Äî Any open subset of R is in B.
‚Äî If A ‚ààB, then R\A ‚ààB.
‚Äî The union of a sequence of elements of B belongs to B.
The elements of B are called Borel sets. Prove that any Borel set is
measurable.
If 3 is a binary relation on R and f, g are functions deÔ¨Åned almost
everywhere on R, we deÔ¨Åne
[[f 3 g]] = {x ‚ààR : f(x) 3 g(x)} .
So, for example,
[[f > g]] = {x ‚ààR : f(x) > g(x)} .
We also use analogous notations such as
[[a ‚â§f < b]] = {x ‚ààR : a ‚â§f(x) < b} .

114
2. DiÔ¨Äerentiation and the Lebesgue Integral
Just as the measurability of a set is related to that of a corresponding
(characteristic) function, so the measurability of a function is related to
that of certain associated sets.
(2.3.5) Proposition.
Let f be a real‚Äìvalued function deÔ¨Åned almost ev-
erywhere. Then f is measurable if and only if [[f > r]] is measurable for
each r ‚ààR.
Proof.
Suppose that f is measurable, let r ‚ààR, and for each positive
integer n deÔ¨Åne
fn =
(f ‚àír)+
1
n + (f ‚àír)+ .
Since the functions t ‚Üít+ and
t ‚Üí
t
1
n + t
are continuous on R and R0+, respectively, we see from Exercises (2.3.3: 2
and 9) that fn is measurable. But limn‚Üí‚àûfn = œá[[f > r]] almost everywhere,
so [[f > r]] is measurable, by Exercise (2.3.3: 4).
Now assume, conversely, that [[f > r]] is measurable for each r ‚ààR.
Given a positive integer n, choose real numbers
. . . , r‚àí2, r‚àí1, r0, r1, r2, . . .
such that 0 < rk+1 ‚àírk < 2‚àín for each k. Then
[[rk‚àí1 < f ‚â§rk]] = [[f > rk‚àí1]]\[[f > rk]]
is measurable, by Exercise (2.3.4: 1); let œák denote its characteristic
function. The function
fn =
‚àû

k=‚àí‚àû
rk‚àí1œák
is measurable: for it is the limit almost everywhere of the sequence of
partial sums of the series on the right‚Äìhand side, and Exercises (2.3.3: 3
and 4) apply. To each x in the domain of f there corresponds a unique k
such that rk‚àí1 ‚â§f(x) < rk; then
0 ‚â§f(x) ‚àífk(x) < rk ‚àírk‚àí1 < 2‚àík.
Hence the sequence (fn) converges almost everywhere to f, which is
therefore measurable, again by Exercise (2.3.3: 4).
2
The exercises in the next set extend the ideas used in the proof of Propo-
sition (2.3.5). In particular, when taken together with the subsequent dis-
cussion of measurability in the sense of Carath¬¥eodory (a concept deÔ¨Åned

2.3 Measurable Sets and Functions
115
shortly), the second and third exercises link our approach to integration
with the one originally used by Lebesgue; see [40], pages 94‚Äì96.
(2.3.6) Exercises
.1
Let f be a function deÔ¨Åned almost everywhere on R. Prove that the
following conditions are equivalent.
(i) f is measurable.
(ii) [[f ‚â•r]] is measurable for each r.
(iii) [[f ‚â§r]] is measurable for each r.
(iv) [[f < r]] is measurable for each r.
(v) [[r ‚â§f < R]] is measurable whenever r < R.
.2
In the notation of the second part of the proof of Proposition
(2.3.5), prove that if f is nonnegative and integrable, then each fn is
integrable and limn‚Üí‚àû
%
fn =
%
f.
.3
Let f be a nonnegative measurable function vanishing outside the
interval [a, b]. For the purpose of this exercise, we call a sequence
(rn)‚àû
n=0 of real numbers admissible if r0 = 0 and there exists Œ¥ >
0 such that rn+1 ‚àírn < Œ¥ for all n; and we say that the series
‚àû
n=1 rn¬µ(En) corresponds to the admissible sequence, where En,
whose characteristic function we denote by œán, is the measurable set
[[rn‚àí1 ‚â§f < rn]]. Suppose that this series converges. Let (r‚Ä≤
n)‚àû
n=0
be any admissible sequence for f, and let œá‚Ä≤
n be the characteristic
function of E‚Ä≤
n = [[r‚Ä≤
n‚àí1 ‚â§f < r‚Ä≤
n]]. Prove that
(i) the series ‚àû
n=1 r‚Ä≤
n‚àí1œá‚Ä≤
n and ‚àû
n=1 rnœán converge almost every-
where to integrable functions,
(ii) ‚àû
n=1 r‚Ä≤
n‚àí1œá‚Ä≤
n ‚â§f ‚â§‚àû
n=1 rnœán almost everywhere,
(iii) the series ‚àû
n=1 r‚Ä≤
n‚àí1¬µ(E‚Ä≤
n) and ‚àû
n=1 rn¬µ(En) converge, and
(iv) ‚àû
n=1 r‚Ä≤
n‚àí1¬µ(E‚Ä≤
n) ‚â§‚àû
n=1 rn¬µ(En).
Hence prove that if ‚àû
n=1 rn¬µ(En) converges for at least one admis-
sible sequence (rn), then f is integrable, and
%
f is both the inÔ¨Åmum
of the set
! ‚àû

n=1
rn¬µ(En) : (rn) is admissible, ‚àÄn (En = [[rn‚àí1 ‚â§f < rn]])
"
and the supremum of the set
! ‚àû

n=1
rn‚àí1¬µ(En) : (rn) is admissible, ‚àÄn (En = [[rn‚àí1 ‚â§f < rn]])
"
.

116
2. DiÔ¨Äerentiation and the Lebesgue Integral
.4
By a simple function we mean a Ô¨Ånite sum of functions of the form cœá,
where c ‚ààR and œá is the characteristic function of an integrable set.
Let f be a nonnegative integrable function. Show that there exists a
sequence (fn) of simple functions such that
(i) 0 ‚â§fn ‚â§f for each n,
(ii) f = ‚àû
n=1 fn almost everywhere, and
(iii)
%
f = ‚àû
n=1
%
fn.
(First reduce to the case where f is nonnegative and vanishes outside
a compact interval. Then use the preceding exercise to construct fk
inductively such that
% 
f ‚àík
n=1 fn

< 2‚àík.)
This exercise relates our development to axiomatic measure theory,
which is based on primitive notions of a ‚Äúmeasurable subset‚Äù of a set
X and the ‚Äúmeasure‚Äù of such a set, and in which the integral is often
built up in the following way. First, deÔ¨Åne a function f : X ‚ÜíR
to be measurable if [[f < Œ±]] is a measurable set for each Œ± ‚ààR.
Next, deÔ¨Åne the integral of a simple function N
n=1 cnœáAn, where
the measurable sets An are pairwise‚Äìdisjoint, to be N
n=1 cn¬µ(An).
If f is a nonnegative measurable function, then deÔ¨Åne its integral to
be the supremum of the integrals of simple functions s which satisfy
0 ‚â§s ‚â§f on the complement of a set whose measure is 0. For this
approach to integration see, for example, [43] or [44].
There is another deÔ¨Ånition of measurability for sets, due to Carath¬¥eodory:
we call a set A ‚äÇR C‚Äìmeasurable if
¬µ‚àó(A ‚à©I) + ¬µ‚àó(I\A) = |I|
for each compact interval I. We prove two lemmas that enable us to show
that this notion of measurability is equivalent to our original one.
(2.3.7) Lemma.
Let f be an integrable function. Then there exists a se-
quence (fn) of step functions converging almost everywhere to f. Moreover,
if f vanishes outside a compact interval I, then
(i) fn can be chosen to vanish outside I; and
(ii) if, in addition, f is the characteristic function of an integrable set,
then fn can be taken as the characteristic function of a Ô¨Ånite union
of subintervals of I.
Proof.
Since f = limn‚Üí‚àûfœá[‚àín,n], it suÔ¨Éces to consider the case where
f vanishes outside a compact interval I = [a, b]. For each n let
a = xn,0 < xn,1 < ¬∑ ¬∑ ¬∑ < xn,2n = b

2.3 Measurable Sets and Functions
117
be a partition of [a, b] into 2‚àín subintervals of equal length. DeÔ¨Åne a step
function fn by setting
fn(x) =
Ô£±
Ô£¥
Ô£¥
Ô£≤
Ô£¥
Ô£¥
Ô£≥
2‚àín
$ xn,j+1
xn,j
f
if xn,j < x < xn,j+1
0
otherwise,
and let
E =
‚àû

n=1
{xn,j : 0 ‚â§j ‚â§2n} ‚à™{x ‚ààR : f(x) is undeÔ¨Åned} .
Then E has measure zero, and, by Exercise (2.2.4: 9), limn‚Üí‚àûfn(x) = f(x)
for all x in E. This completes the proof of (i).
Now suppose that f is the characteristic function of an integrable set
A ‚äÇI, and, using the Ô¨Årst part of the proof, construct a sequence (œÜn) of
step functions that vanish outside I and converge almost everywhere to f.
DeÔ¨Åne
fn =
Ô£±
Ô£≤
Ô£≥
1
if œÜn(x) > 1
2
0
otherwise.
Then fn is the characteristic function of a Ô¨Ånite union of subintervals of I,
and f = limn‚Üí‚àûfn almost everywhere.
2
(2.3.8) Lemma.
Let A be an integrable subset of a compact interval I.
Then there exists a decreasing sequence (œán) of integrable functions con-
verging almost everywhere to œáA, such that each œán is the characteristic
function of a countable union of pairwise‚Äìdisjoint bounded open intervals.
Proof.
Using Lemma (2.3.7), choose a sequence (fn) of step functions
that vanish outside I and converge almost everywhere to œáA, such that
each fn is the characteristic function of a Ô¨Ånite union Sn of pairwise‚Äìdisjoint
bounded open intervals. Then œáA is also the limit, almost everywhere, of
the decreasing sequence (gn), where
gn = sup
k‚â•n
fk.
Also, gn is the characteristic function of ‚àû
k=n Sk, which is a countable
union of bounded open subintervals of I. We now build up a sequence
(Tk)‚àû
k=n of Ô¨Ånite collections of pairwise‚Äìdisjoint bounded open intervals, as
follows: taking Tn = Sn, suppose we have constructed TN for some N ‚â•n,
and form TN+1 by adjoining to TN all the intervals of the form J\ N
k=n Tk
with J ‚ààSN+1. Let œán be the characteristic function of ‚àû
k=n Tk, which is a
countable union of pairwise‚Äìdisjoint bounded open intervals. Then œán = gn
almost everywhere, so œán converges to œáA almost everywhere.
2

118
2. DiÔ¨Äerentiation and the Lebesgue Integral
(2.3.9) Proposition.
Let A be a subset of R. Then
(i) A is measurable if and only if it is C‚Äìmeasurable;
(ii) A is integrable if and only if it is measurable and has Ô¨Ånite outer
measure, in which case ¬µ‚àó(A) = ¬µ(A).
Proof.
Assume, to begin with, that A is C‚Äìmeasurable. Given a compact
interval I = [a, b] and Œµ > 0, choose sequences (In) and (Jn) of bounded
open intervals such that
A ‚à©I ‚äÇ
‚àû

n=1
In,
I\A ‚äÇ
‚àû

n=1
Jn,
‚àû

n=1
|In| < ¬µ‚àó(A ‚à©I) + Œµ/2,
‚àû

n=1
|Jn| < ¬µ‚àó(I\A) + Œµ/2.
By Lebesgue‚Äôs Series Theorem (Exercise (2.2.13: 4)), the functions
g = œáI ‚àí
‚àû

n=1
œáJn,
h =
‚àû

n=1
œáIn
are deÔ¨Åned almost everywhere and integrable,
$
g = b ‚àía ‚àí
‚àû

n=1
|Jn| ,
and
$
h =
‚àû

n=1
|In| .
So
$
(h ‚àíg) < ¬µ‚àó(A ‚à©I) + ¬µ‚àó(I\A) ‚àí(b ‚àía) + Œµ = Œµ.
Since
g ‚â§œáA‚à©I ‚â§h

2.3 Measurable Sets and Functions
119
almost everywhere and Œµ > 0 is arbitrary, we see from Exercise (2.2.13: 12)
that œáA‚à©I is integrable. Moreover,
$
œáA‚à©I ‚â•
$
g
‚â•b ‚àía ‚àí¬µ‚àó(I\A) ‚àíŒµ
2
= ¬µ‚àó(A ‚à©I) ‚àíŒµ
2
and
$
œáA‚à©I ‚â§
$
h ‚â§¬µ‚àó(A ‚à©I) + Œµ
2.
Again as Œµ > 0 is arbitrary, we see that
%
œáA‚à©I = ¬µ‚àó(A ‚à©I).
Since œáA is the limit of the sequence

œáA‚à©[‚àín,n]
	‚àû
n=1, it follows that A is
measurable in our original sense. If also ¬µ‚àó(A) is Ô¨Ånite, then
lim
n‚Üí‚àû¬µ‚àó(A ‚à©[‚àín, n]) = ¬µ‚àó(A),
by Exercise (2.1.1: 10); so, applying Beppo Levi‚Äôs Theorem (2.2.12), we
conclude that A is integrable, with ¬µ(A) = ¬µ‚àó(A). On the other hand, if
A is integrable, then Lebesgue‚Äôs Dominated Convergence Theorem (2.2.14)
shows that
lim
n‚Üí‚àû¬µ‚àó(A ‚à©[‚àín, n]) =
$
œáA.
It then follows from Exercise (2.1.1: 10) that ¬µ‚àó(A) = ¬µ(A).
It remains to prove that measurability implies C‚Äìmeasurability. Accord-
ingly, let A be measurable in our original sense, and again let I = [a, b]
be any compact interval. Using Lemma (2.3.8), construct a decreasing se-
quence (œán) of integrable functions converging almost everywhere to œáA‚à©I,
such that each œán is the characteristic function of the union of a sequence
(In,k)‚àû
k=1 of pairwise‚Äìdisjoint bounded open intervals. Then ‚àû
k=1 In,k in-
cludes (A ‚à©I)\E, where E is a (possibly empty) set of measure zero;
so
¬µ‚àó(A ‚à©I) ‚â§
‚àû

k=1
|In,k| =
$
œán,
the last equality being a consequence of Beppo Levi‚Äôs Theorem (2.2.12).
By Lebesgue‚Äôs Dominated Convergence Theorem, we now have
¬µ(A ‚à©I) = lim
n‚Üí‚àû
$
œán ‚â•¬µ‚àó(A ‚à©I).
Similarly,
b ‚àía ‚àí¬µ(A ‚à©I) = ¬µ(I\A) ‚â•¬µ‚àó(I\A),
so
¬µ‚àó(A ‚à©I) + ¬µ‚àó(I\A) ‚â§b ‚àía.

120
2. DiÔ¨Äerentiation and the Lebesgue Integral
But Exercise (2.1.1: 6) shows that ¬µ‚àó(A ‚à©I) + ¬µ‚àó(I\A) ‚â•b ‚àía; so
¬µ‚àó(A ‚à©I) + ¬µ‚àó(I\A) = b ‚àía,
and therefore A is measurable.
2
(2.3.10) Exercise
Let I be a compact interval, and f an integrable function that van-
ishes outside I. Prove that there exists a sequence (fn) of continuous
functions, each vanishing outside I, such that
%
|f ‚àífn| ‚Üí0. (Re-
duce to the case where f is bounded. Then use Lemma (2.3.7) to
reduce to the case where f is a step function.)
Are all subsets of R measurable? No: the Axiom of Choice (Appendix B)
ensures that nonmeasurable sets exist.5 To show this, following Zermelo,
we deÔ¨Åne an equivalence relation ‚àºon [0, 1) by
x ‚àºy if and only if x ‚àíy ‚ààQ.
Let Àôx denote the equivalence class of x under this relation. By the Axiom
of Choice, there exists a function œÜ on the set of these equivalence classes
such that
œÜ ( Àôx) ‚ààÀôx
(x ‚àà[0, 1)).
Let
E = {œÜ( Àôx) : x ‚àà[0, 1)} .
Now let r1, r2, . . . be a one‚Äìone enumeration of Q ‚à©[0, 1), and for each n
deÔ¨Åne
An = E ‚à©[0, rn),
Bn = E ‚à©[rn, 1),
E0
n = {x ‚àà[0, 1) : x + rn ‚àí1 ‚ààAn} ,
E1
n = {x ‚àà[0, 1) : x + rn ‚ààBn} ,
En = E0
n ‚à™E1
n.
We show that if rn < rm, then the sets Em, En are disjoint. To this end,
Ô¨Årst note that
Ek = {x ‚àà[0, 1) : x + rk ‚àí‚åäx + rk‚åã‚ààE} ,
5Solovay [48] has shown that there is a model of Zermelo-Fraenkel set theory,
without the Axiom of Choice, in which every subset of R is Lebesgue measurable.

2.3 Measurable Sets and Functions
121
where ‚åäx‚åãdenotes the integer part of the real number x. Suppose that
x ‚ààEm ‚à©En, so that
ym = x + rm ‚àí‚åäx + rm‚åã‚ààE
and
yn = x + rn ‚àí‚åäx + rn‚åã‚ààE.
Then
ym ‚àíyn = rm ‚àírn + integer
is a rational number. Since E contains exactly one element from each equiv-
alence class under ‚àº, we must have ym = yn; so rm‚àírn is an integer, which
is impossible as 0 ‚â§rn < rm < 1. Hence, in fact, Em ‚à©En is empty.
Now suppose that E is measurable; then An, Bn are measurable and have
Ô¨Ånite measure. Since E0
n and E1
n are translates of An and Bn, respectively, it
follows from Exercise (2.2.9: 9) that En is measurable, with ¬µ(En) = ¬µ(E).
But ‚àû
n=1 En = [0, 1), so by Exercise (2.3.4: 2), ‚àû
n=1 ¬µ(En) = 1. This is
absurd, since an inÔ¨Ånite series with all terms equal cannot converge unless
all its terms are 0. Hence E is not measurable.
For more on nonmeasurable sets, see Chapter 5 of [33].
(2.3.11) Exercises
.1
Let E be a nonmeasurable subset of R, and A a subset of E that is
measurable. Prove that ¬µ‚àó(A) = 0.
.2
Give an example of a nonmeasurable function f such that |f| is
integrable.
At Ô¨Årst sight it might appear that our approach to the Lebesgue integral
cannot be generalised to multiple integrals. However, in the context of Rn
it is relatively straightforward to develop notions of outer measure, set of
measure zero, and Dini derivates (of a special, set‚Äìbased kind), and it is not
too hard to prove a version of the Vitali Covering Theorem and hence of
Fubini‚Äôs Series Theorem ([46], Chapter 4). With these at hand, as Riesz has
pointed out,6 it is indeed possible to develop the Lebesgue integral in Rn by
6Il ne s‚Äôagira, dans le pr¬¥esent M¬¥emoire, que les fonctions d‚Äôune seule variable
et il pourrait paraÀÜƒ±tre, `a premi`ere vue, comme si notre m¬¥ethode ¬¥etait fa¬∏conn¬¥ee
enti`erement sur ce cas particulier. Dans cet ordre d‚Äôid¬¥ees, il convient d‚Äôobserver
que l‚Äôon aurait pu baser les consid¬¥erations, au lieu de la d¬¥eriv¬¥ee au sens ordinaire,
sur l‚Äôid¬¥ee moins exigeante de d¬¥eriv¬¥ee par rapport `a un r¬¥eseau, comme s‚Äôen sert M.
de la Vall¬¥ee Poussin pour l‚Äô¬¥etude de la d¬¥erivation des fonctions d‚Äôensemble [53].
Non seulement que la d¬¥emonstration de l‚Äôexistence presque partout de cette sorte
de d¬¥eriv¬¥ee d‚Äôune fonction monotone est presque imm¬¥ediate, mais en outre on
ne rencontre aucune nouvelle diÔ¨Écult¬¥e quand on veut passer au cas de plusieurs
variables et les consid¬¥erations concernant l‚Äôint¬¥egrale s‚Äô¬¥etendent `a ce cas g¬¥en¬¥eral
avec des modiÔ¨Åcations ¬¥evidentes. ([39], pages 192‚Äì193)

122
2. DiÔ¨Äerentiation and the Lebesgue Integral
methods akin to those we have used for one‚Äìdimensional integration. But
as there are more illuminating approaches to integration on Rn, especially
once a general theory of measures has been developed (see [44] or [43]), we
do not discuss the theory of multivariate integrals in this book.

Part II
Abstract Analysis

3
Analysis in Metric Spaces
...an excellent play; well digested in the scenes,
set down with as much modesty as cunning.
hamlet, Act 2, Scene 2
In Section 1 we abstract many of the ideas from Chapter 1 to the context of a
metric space, a set in which we can measure the distance between two points. In
Section 2 we discuss limits and continuity in that context. Section 3 deals with
compactness, which, as a substitute for Ô¨Åniteness, is perhaps the single most
useful concept in analysis. The next section covers connectedness and lifts the
Intermediate Value Theorem into its proper context. Finally, in Section 5, we
study the product of a family of metric spaces, thereby enabling us to deal with
analysis in Rn and Cn.
3.1
Metric and Topological Spaces
The notion of a metric space generalises the properties of R that are asso-
ciated with the distance given by the function (x, y) ‚Üí|x ‚àíy|. A further
generalisation, which we touch on at the end of this section, is a topological
space, in which, since there may be no analogue of distance, the concept of
open set plays a primary role.
A metric, or distance function, on a set X is a mapping œÅ of X √ó X into
R such that the following properties hold for all x, y, z in X.
M1
œÅ(x, y) ‚â•0.

126
3. Analysis in Metric Spaces
M2
œÅ(x, y) = 0 if and only if x = y.
M3
œÅ(x, y) = œÅ(y, x).
M4
œÅ(x, y) ‚â§œÅ(x, z) + œÅ(z, y) (triangle inequality).
A metric space is a pair (X, œÅ) consisting of a set X and a metric œÅ on X;
when the identity of the metric is clear from the context, we simply refer
to X itself as a metric space. We use the letter œÅ to denote the metric on
any metric space, except where it might be confusing to do so.
The standard example of a metric space is, of course, the real line R
taken with the metric (x, y) ‚Üí|x ‚àíy|. More generally, if S is a subset of
R, then the restriction of this metric to a function on S √ó S is a metric
on S. Unless we say otherwise, whenever we consider S ‚äÇR as a metric
space, we assume that it carries this canonical metric.
(3.1.1) Exercises
.1
Let x1, . . . , xn be elements of a metric space X. Prove the generalised
triangle inequality:
œÅ(x1, xn) ‚â§œÅ(x1, x2) + œÅ(x2, x3) + ¬∑ ¬∑ ¬∑ + œÅ(xn‚àí1, xn).
.2
Let X be a set. Prove that the mapping œÅ : X √ó X ‚ÜíR, deÔ¨Åned by
œÅ(x, y) =
Ô£±
Ô£≤
Ô£≥
0
if x = y
1
if x Ã∏= y
is a metric on X.
This metric is called the discrete metric, and X, taken with the
discrete metric, is called a discrete space.
.3
Prove that each of the following mappings from Rn √ó Rn to R is a
metric on Rn.
(i) (x, y) ‚Üín
i=1 |xi ‚àíyi|
(taxicab metric).
(ii) (x, y) ‚Üímax{|xi ‚àíyi| : 1 ‚â§i ‚â§n}.
Here, and in the next two exercises, x = (x1, . . . , xn) and y =
(y1, . . . , yn).
.4
Prove the Cauchy‚ÄìSchwarz inequality,
n

i=1
xiyi ‚â§
 n

i=1
x2
i
1/2  n

i=1
y2
i
1/2
.
Hence prove Minkowski‚Äôs inequality,
 n

i=1
(xi ‚àíyi)2
1/2
‚â§
 n

i=1
x2
i
1/2
+
 n

i=1
y2
i
1/2
.

3.1 Metric and Topological Spaces
127
.5
Show that the mapping
(x, y) ‚Üí
/
0
0
1
n

i=1
(xi ‚àíyi)2
is a metric on Rn. (Note the preceding exercise.)
This metric is known as the Euclidean metric, and Rn, taken with the
Euclidean metric, is known as Euclidean n‚Äìspace or n‚Äìdimensional
Euclidean space.
.6
Let p be a prime number. For each positive integer n deÔ¨Åne vp(n) to
be the exponent of p in the prime factorisation of n. For each rational
number r = ¬±m/n, where m, n are positive integers, deÔ¨Åne
vp (r) = vp(m) ‚àívp(n).
Show that this deÔ¨Ånition does not depend on the particular represen-
tation of r as a quotient of integers, and that if r‚Ä≤ is also rational,
then
vp(rr‚Ä≤) = vp(r) + vp(r‚Ä≤).
Finally, show that
œÅ(x, y) =
Ô£±
Ô£≤
Ô£≥
p‚àívp(x‚àíy)
if x Ã∏= y
0
if x = y
deÔ¨Ånes a metric œÅ ‚Äîwhich we call the p‚Äìadic metric ‚Äîon Q, such
that
œÅ(x, z) ‚â§max {œÅ(x, y), œÅ(y, z)} .
On any set X a metric œÅ that satisÔ¨Åes this last property is called an
ultrametric, and (X, œÅ) is called an ultrametric space; clearly, X is
then a metric space.
.7
Let X be a nonempty set, and denote by B(X, R) the set of all
bounded mappings of X into R. Show that
œÅ(f, g) = sup {|f(x) ‚àíg(x)| : x ‚ààX}
deÔ¨Ånes a metric on B(X, R).
From now on, when we refer to B(X, R) as a metric space, it is
understood that the metric is the one deÔ¨Åned in this exercise.
.8
A pseudometric on a set X is a mapping œÅ : X √ó X ‚ÜíR that
satisÔ¨Åes M1, M3, M4 and the following weakening of M2: if x = y,

128
3. Analysis in Metric Spaces
then œÅ(x, y) = 0. The pair (X, œÅ), or, loosely, X itself, is then called
a pseudometric space. Prove that in that case,
x ‚àºy if and only if œÅ(x, y) = 0
deÔ¨Ånes an equivalence relation on X, and that
œÅ (x, y) = œÅ(x, y)
deÔ¨Ånes a metric œÅ on the quotient set X/ ‚àº, where x is the
corresponding equivalence class of x.
In practice, we often identify X/ ‚àºwith X, and thereby turn X into
a metric space, by calling two elements x, y of X equal if œÅ(x, y) = 0
or, equivalently, if x = y.
.9
Prove that
œÅ(f, g) =
,
$ b
a
|f ‚àíg|
deÔ¨Ånes a metric on the set of continuous real‚Äìvalued mappings on the
compact interval [a, b] , where ,
% b
a denotes the Riemann integral.
.10 Prove that
œÅ(f, g) =
$
|f ‚àíg|
deÔ¨Ånes a pseudometric on the set of Lebesgue integrable functions on
R.
The corresponding metric space (see Exercise (3.1.1: 8)) is denoted by
L1(R). We see from Exercise (2.2.4: 6) that two elements of L1(R) are
equal if and only if, as functions, they are equal almost everywhere.
Let X and Y be metric spaces. A bijection f of X onto Y is called an
isometry if
œÅ(f(x), f(y)) = œÅ(x, y)
for all x, y in X, in which case the inverse mapping f ‚àí1 is an isometry of
Y onto X, and the spaces X and Y are said to be isometric (under f).
Two isometric spaces can be regarded as indistinguishable for all practical
purposes that involve only distance.
Now let X be a metric space, and Y a set in one‚Äìone correspondence
with X. With any bijection f of X onto Y there is associated a natural
metric œÅY on Y, deÔ¨Åned by setting
œÅY (f(x), f(y)) = œÅ(x, y).
We say that the metric œÅ has been transported from X to Y by f. The
mapping f is then an isometry from (X, œÅ) onto (Y, œÅY ).

3.1 Metric and Topological Spaces
129
An important example of the transport of a metric occurs in connection
with the real line R, and enables us, in Section 3.2, to discuss the conver-
gence of sequences in a metric space as a special case of the convergence of
functions. The mapping f deÔ¨Åned on R by
f(x) =
x
1 + |x|
(x ‚ààR)
is an order‚Äìpreserving bijection of R onto the open interval (‚àí1, 1), with
inverse mapping g deÔ¨Åned by
g(y) =
y
1 ‚àí|y|
(|y| < 1).
Let ¬ØR be obtained from R by adjoining two new elements ‚àí‚àûand ‚àû,
called the points at inÔ¨Ånity. (Note that ‚àí‚àûand ‚àûare not real numbers,
and that the real numbers are often referred to as the Ô¨Ånite elements of
¬ØR.) Extend f to a bijection of ¬ØR onto [‚àí1, 1] by setting
f(‚àí‚àû) = ‚àí1 and f(‚àû) = 1.
Then g extends to a bijection of [‚àí1, 1] onto ¬ØR, such that the extended
mapping g is the inverse of the extended mapping f. Now transport (by g)
the standard metric (s, t) ‚Üí|s ‚àít| from [‚àí1, 1] to ¬ØR; that is, deÔ¨Åne
œÅ¬ØR(x, y) = |f(x) ‚àíf(y)|
(x, y ‚àà¬ØR).
Taken with the metric œÅ¬ØR, the set ¬ØR becomes a metric space, called the
extended real line. Note that œÅ¬ØR, restricted to R, is diÔ¨Äerent from the
standard metric (x, y) ‚Üí|x ‚àíy| on R.
We introduce the order relations >, ‚â•on ¬ØR (and hence the opposite
relations <, ‚â§) by setting
x > y if and only if f(x) > f(y),
x ‚â•y if and only if f(x) ‚â•f(y).
On R these relations coincide with the respective standard inequality
relations.
(3.1.2) Exercises
.1
Prove that the function œÅ¬ØR is a metric on ¬ØR.
.2
Show that the relations > and ‚â•on ¬ØR have the properties that you
would expect. In particular, prove that
(i) ‚àí‚àû< x < ‚àûfor all x ‚ààR;

130
3. Analysis in Metric Spaces
(ii) a nonempty subset S of R is bounded, and has a supremum and
inÔ¨Åmum, relative to the order ‚â•on ¬ØR (where sup S and inf S
may equal ‚àûor ‚àí‚àû);
(iii) when restricted to R, the order relations > and ‚â•on ¬ØR coincide
with the standard order relations > and ‚â•.
Let (X, œÅ) be a metric space, a ‚ààX, and r > 0. We deÔ¨Åne the open ball
with centre a and radius r to be
B(a, r) = {x ‚ààX : œÅ(a, x) < r},
and the closed ball with center a and radius r to be
B(a, r) = {x ‚ààX : œÅ(a, x) ‚â§r}.
For example, the open and closed balls with centre a and radius r in R are
the intervals (a ‚àír, a + r) and [a ‚àír, a + r], respectively; and the open ball
with centre ‚àûand radius r ‚àà(0, 1) in ¬ØR is

r‚àí1 ‚àí1, ‚àû
	
‚à™{‚àû} .
In order to deÔ¨Åne the notions of open set, interior point, interior of a
set, neighbourhood, cluster point, closure, and closed set for a metric space
X, in the corresponding deÔ¨Ånition for subsets of R we replace
‚Äî the open interval (x ‚àír, x + r) by its analogue, the open ball B(x, r)
in X, and
‚Äî the inequality |x ‚àíy| < r by the inequality œÅ(x, y) < r.
For example, a subset A of X is said to be open (in X) if for each x ‚ààA
there exists r > 0 such that B(x, r) ‚äÇA.
Propositions (1.3.2), (1.3.9), and (1.3.10), and the applicable parts of
Exercises (1.3.7) and (1.3.8), carry over unchanged into the context of a
metric space. When we mention those results in future, it is assumed that
we are referring to their metric space versions.
(3.1.3) Exercises
.1
Prove that X itself, the empty set ‚àÖ‚äÇX, and the open balls in X are
open sets; and that X, ‚àÖ, and the closed balls in X are closed sets.
.2
Give proofs of the metric space analogues of Proposition (1.3.2),
Exercises (1.3.7: 3‚Äì8), and Exercises (1.3.8: 3‚Äì8).
.3
Prove that a subset of X is closed if and only if X\S is open (cf.
Proposition (1.3.9)).
.4
Prove that the intersection of a family of closed sets is closed, and
that the union of a Ô¨Ånite family of closed sets is closed (cf. Proposition
(1.3.10)).

3.1 Metric and Topological Spaces
131
.5
Suppose that œÅ is an ultrametric on X (see Exercise (3.1.1: 6)). Prove
the following statements.
(i) If œÅ(x, y) Ã∏= œÅ(y, z), then œÅ(x, z) = max {œÅ(x, y), œÅ(y, z)} .
(ii) If y ‚ààB(x, r), then B(y, r) = B(x, r).
(iii) Every open ball in X is a closed set.
(iv) If two open balls in X have a nonempty intersection, then one
of them is a subset of the other.
Is every closed ball in X an open set? Does (iv) hold with ‚Äúopen ball‚Äù
replaced by ‚Äúball‚Äù?
.6
Two metrics on a set are said to be equivalent if they give rise to the
same class of open sets. Prove that the Euclidean metric is equivalent
to each of the metrics in Exercise (3.1.1: 3).
.7
Prove that ‚àûis a cluster point of R, considered as a subset of the
metric space ¬ØR.
If S is a subset of a metric space X, then the restriction to S √ó S of the
metric œÅ on X is a metric‚Äîalso denoted by œÅ ‚Äîon S, and is said to be
induced on S by œÅ. The set S, taken with that induced metric, is called a
(metric) subspace of X.
(3.1.4) Exercise
Prove that if x ‚ààS and r > 0, then S ‚à©B(x, r) is the open ball,
and S ‚à©B(x, r) is the closed ball, with centre x and radius r in the
subspace S.
(3.1.5) Proposition.
Let S be a subspace of the metric space (X, œÅ), and
A a subset of S. Then A is open in S if and only if A = S ‚à©E for some
open set E in X; and A is closed in S if and only if A = S ‚à©E for some
closed set E in X
Proof.
We prove only the part dealing with open sets, since the other
part then follows by considering complements. Accordingly, suppose that
A = S ‚à©E for some open set E in X, and let x ‚ààA. Choosing r > 0 such
that B(x, r) ‚äÇE, we see that
x ‚ààS ‚à©B(x, r) ‚äÇS ‚à©E.
Since, by Exercise (3.1.4), S ‚à©B(x, r) is the open ball with centre x and
radius r in S, it follows that x is an interior point of S ‚à©E in the subspace
S. Hence A = S ‚à©E is open in S.

132
3. Analysis in Metric Spaces
Conversely, suppose that A is open in S. Then, by Exercise (3.1.4), for
each x ‚ààA there exists rx > 0 such that S ‚à©B(x, rx) ‚äÇA. So
A =

x‚ààA
(S ‚à©B(x, rx)) = S ‚à©

x‚ààA
B(x, rx),
where the set 
x‚ààA B(x, rx) is open in X, by (the metric space analogue
of) Proposition (1.3.2).
2
(3.1.6) Exercises
In each of these exercises S is a subspace of (X, œÅ).
.1
Complete the proof of Proposition (3.1.5).
.2
Prove that the following conditions are equivalent.
(i) Every subset of S that is open in S is open in X.
(ii) S is open in X.
.3
Prove that the following conditions are equivalent.
(i) Every subset of S that is closed in S is closed in X.
(ii) S is closed in X.
.4
Let x ‚ààS and U ‚äÇS. Show that U is a neighbourhood of x in S if
and only if U = S ‚à©V for some neighbourhood V of x in X.
.5
Let x ‚ààS. Show that the following conditions are equivalent.
(i) Every neighbourhood of x in S is a neighbourhood of x in X.
(ii) S is a neighbourhood of x in X.
Let A and B be subsets of X. We say that A is
‚Ä¢ dense with respect to B if B ‚äÇA, and
‚Ä¢ dense in X, or everywhere dense, if A = X.
The space X is called separable if it contains a countable dense subset.
For example, Q and R\Q are dense in R, by Exercises (1.1.1: 19) and
(1.2.11: 5). Thus R is separable, as Q is countable.
(3.1.7) Proposition.
If A is dense with respect to B, and B is dense
with respect to C, then A is dense with respect to C.
Proof.
We have B ‚äÇA and C ‚äÇB. By Exercises (1.3.8: 7 and 3),
B ‚äÇ(A) = A; whence C ‚äÇA.
2
(3.1.8) Exercises
.1
Show that A is dense in X if and only if each nonempty open set in
X contains a point of A.

3.1 Metric and Topological Spaces
133
.2
Prove that (‚àí‚àû, ‚àí1) ‚à™(‚àí1, 1) ‚à™(1, ‚àû) is dense in R.
.3
Prove that a nonempty subspace S of a separable metric space X
is separable. (Let (xn) be a dense sequence in X. For each positive
integer m consider the set {n : œÅ(xn, S) < 1/m} .)
.4
Prove that the union of a countable family of separable subspaces of
X is separable. What about the union of an uncountable family of
separable subspaces?
.5
A point x of a metric space is said to be isolated if there exists r > 0
such that B(x, r) = {x} . Prove that the set of isolated points of a
separable metric space is either empty or countable.
.6
Prove that a nonempty family of pairwise‚Äìdisjoint, nonempty open
subsets of a separable metric space is countable. (Use the preceding
exercise.)
If S is a nonempty subset of X and x ‚ààX, then we deÔ¨Åne the distance
from x to S to be the real number
œÅ(x, S) = inf{œÅ(x, s) : s ‚ààS}.
More generally, if T is also a nonempty subset of X, then we deÔ¨Åne
œÅ(S, T) = inf {œÅ(s, t) : s ‚ààS, t ‚ààT} .
(3.1.9) Proposition.
If S is a nonempty subset of X, and x, y are two
points of X, then
|œÅ(x, S) ‚àíœÅ(y, S)| ‚â§œÅ(x, y).
Proof.
For each s ‚ààS we have
œÅ(x, S) ‚â§œÅ(x, s) ‚â§œÅ(x, y) + œÅ(y, s).
It follows that
œÅ(x, S) ‚â§œÅ(x, y) + inf{œÅ(y, s) : s ‚ààS} = œÅ(x, y) + œÅ(y, S)
and therefore that
œÅ(x, S) ‚àíœÅ(y, S) ‚â§œÅ(x, y).
Similarly,
œÅ(y, S) ‚àíœÅ(x, S) ‚â§œÅ(x, y).
The result follows immediately.
2
The diameter of a nonempty subset S of a metric space X is deÔ¨Åned as
diam(S) = sup{œÅ(x, y) : x ‚ààS, y ‚ààS}

134
3. Analysis in Metric Spaces
and is either a nonnegative real number or ‚àû. Clearly, if S ‚äÇT, then
diam(S) ‚â§diam(T); and diam(S) = 0 if and only if S contains exactly one
point.
A subset S of X is said to be bounded if its diameter is Ô¨Ånite‚Äîthat is, if
diam(S) ‚ààR.
(3.1.10) Exercises
.1
For nonempty subsets S, T of X, prove that œÅ(S, S) = 0 and œÅ(S, T) =
œÅ(T, S).
.2
Is it true that if S, T are closed subsets of R such that œÅ(S, T) = 0,
then S ‚à©T is nonempty?
.3
Prove that a nonempty subset S of X is closed if and only if œÅ(x, S) >
0 for each x ‚ààX\S.
.4
Let X be an ultrametric space, and B, B‚Ä≤ distinct open balls of ra-
dius r in X both of which are contained in a closed ball of radius r.
Compute œÅ(B, B‚Ä≤). (Note Exercise (3.1.3: 5).)
.5
Is it true that
diam(B(x, r)) = diam(B(x, r)) = 2r
for any metric space X, x ‚ààX, and r > 0?
.6
Prove that
(i) the union of two bounded subsets of a metric space is bounded;
(ii) the union of Ô¨Ånitely many bounded subsets of a metric space is
bounded.
Is the union of an inÔ¨Ånite family of bounded subsets necessarily
bounded?
Although the notion of a metric space is suÔ¨Éciently strong to underpin
a large amount of analysis, the following more general notion is needed in
more advanced work.1
A topological space (X, œÑ) consists of a set X and a family œÑ of subsets
of X satisfying the following conditions.
TO1
X ‚ààœÑ and ‚àÖ‚ààœÑ.
TO2
If Ai ‚ààœÑ for each i ‚ààI, then 
i‚ààI Ai ‚ààœÑ.
1As we do not use the notion of a topology, other than a metric one, in the
remainder of this book, this part of the section can be skipped without penalty.

3.2 Continuity, Convergence, and Completeness
135
TO3
If A1 ‚ààœÑ and A2 ‚ààœÑ, then A1 ‚à©A2 ‚ààœÑ.
œÑ is called the topology of the space, and the elements of œÑ the open sets
of that topology. When the topology œÑ is clear from the context, we speak
loosely of X as a topological space and of the elements of œÑ as open sets in
X.
A metric space (X, œÅ) is associated with a topological space (X, œÑ) in
the obvious way: the open sets of œÑ are precisely those subsets of X that
are open relative to the metric œÅ. In such a case we say that the metric œÅ
deÔ¨Ånes the topology œÑ, and we identify the metric space (X, œÅ) with the
associated topological space (X, œÑ).
A topological space (X, œÑ) is said to be metrisable if there is a metric œÅ
on X that deÔ¨Ånes the topology œÑ. Not every topological space is metris-
able. For example, if X = {0, 1} is given the topology œÑ consisting of ‚àÖand
X itself, then every neighbourhood of 0 intersects every neighbourhood of
1; if œÑ were metrisable, then the distinct points 0, 1 of X would have dis-
joint neighbourhoods‚Äînamely, B(0, 1
2) and B(1, 1
2). For characterisations
of metrisable topological spaces see [25].
Let S be a subset of a topological space X, and x ‚ààX. We say that x is
an interior point of S if there is an open set A such that x ‚ààA ‚äÇS; and
we deÔ¨Åne the interior of S to be the set of all interior points of S. By a
neighbourhood of x we mean a set U ‚äÇX containing x in its interior. On
the other hand, x is called a cluster point of S if each neighbourhood of
x has a nonempty intersection with S; and we deÔ¨Åne the closure of S (in
X) to be the set ¬ØS of all cluster points of S. A subset C of X is said to be
closed (in X) if it equals its closure.
Propositions (1.3.2), (1.3.9), and (1.3.10), and the applicable parts of
Exercises (1.3.7) and (1.3.8), all hold in the context of a topological space.
(3.1.11) Exercises
.1
Prove that the standard metric on R, and the metric induced on R
as a subset of the extended real line ¬ØR, give rise to the same topology
on R.
.2
Prove the statement immediately preceding this set of exercises.
3.2
Continuity, Convergence, and Completeness
In contrast to our approach to limits in Chapter 1, in the context of a metric
space we Ô¨Årst introduce the notion of continuity. The following deÔ¨Ånition is
intended to capture formally the idea that f(x) is close to f(a) whenever
x is close to a.
Let X, Y be metric spaces, and f a mapping of X into Y . We say that
f is

136
3. Analysis in Metric Spaces
‚Ä¢ continuous at the point a ‚ààX if for each Œµ > 0 there exists Œ¥ > 0
such that œÅ(f(a),f(x)) < Œµ whenever x ‚ààX and œÅ(a, x) < Œ¥ ;
‚Ä¢ continuous on X, or simply continuous, if it is continuous at each
point of X.
If f is not continuous at a ‚ààX, we say that f has a discontinuity at a, or
that f is discontinuous at a.
(3.2.1) Exercises
.1
Prove that the identity mapping iX : X ‚ÜíX, deÔ¨Åned on the metric
space X by iX(x) = x, is continuous.
.2
Prove that any constant mapping between metric spaces is continu-
ous.
.3
A mapping f : X ‚ÜíY between metric spaces is said to be contractive
if œÅ(f(x), f(y)) < œÅ(x, y) whenever x, y are distinct points of X. Prove
that a contractive mapping is continuous.
.4
Let X be a metric space, a ‚ààX, and f, g two functions from X into
R that are continuous at a. Prove that the functions f + g, f ‚àíg,
max{f, g}, min {f, g} , |f| , and fg are continuous at a. Prove also
that if g(a) Ã∏= 0, then f/g is deÔ¨Åned in a neighbourhood of a and is
continuous at a.
.5
Let Y be a closed subset of a metric space X, and f : Y ‚ÜíR a
bounded continuous mapping. Prove that
x ‚Üíinf {f(y)œÅ(x, y) : y ‚ààY }
is continuous on X\Y. (Note Exercise (3.1.10: 3).)
.6
Let h be a mapping of R0+ into itself such that
(i) h(t) = 0 if and only if t = 0,
(ii) h(s + t) ‚â§h(s) + h(t) for all s, t.
Let œÅ be a metric on a set X. Prove that d = h ‚ó¶œÅ is a metric on X,
and that if h is continuous at 0, then d is equivalent to œÅ (see Exercise
(3.1.3: 6)). Prove, conversely, that if X contains a point that is not
isolated relative to œÅ (see Exercise (3.1.8: 5), and if œÅ and h ‚ó¶œÅ are
equivalent metrics, then h is continuous at 0.
Taking h(t) = min {t, 1} in the Ô¨Årst part of this exercise, we obtain a
bounded metric equivalent to the given metric on X.

3.2 Continuity, Convergence, and Completeness
137
(3.2.2) Proposition.
The following are equivalent conditions on a
mapping f : X ‚ÜíY, where X, Y are metric spaces.
(i) f is continuous.
(ii) For each open set A ‚äÇY, f ‚àí1(A) is open in X.
(iii) For each closed set A ‚äÇY, f ‚àí1(A) is closed in X.
Proof.
Suppose that f is continuous, let A ‚äÇY be an open set, and
consider any a in f ‚àí1(A). Since f(a) ‚ààA and A is open, there exists Œµ > 0
such that B(f(a), Œµ) ‚äÇA. Choose Œ¥ > 0 such that if œÅ(a, x) < Œ¥, then
œÅ(f(a), f(x)) < Œµ and therefore f(x) ‚ààA. Then B(a, Œ¥) ‚äÇf ‚àí1(A). Hence
f ‚àí1(A) is open in X, and therefore (i) implies (ii).
Since a set is open if and only if its complement is closed, it readily
follows that (ii) is equivalent to (iii). Finally, assume (ii), let a ‚ààX and
Œµ > 0, and set A = B(f(a), Œµ) ‚äÇY . Then A is open in Y , so f ‚àí1(A) is open
in X. Since a ‚ààf ‚àí1(A), there exists Œ¥ > 0 such that B(a, Œ¥) ‚äÇf ‚àí1(A); so
if œÅ(a, x) < Œ¥, then f(x) ‚ààA and therefore œÅ(f(a), f(x)) < Œµ. Hence f is
continuous at a. Since a ‚ààX is arbitrary, f is continuous on X. Thus (ii)
implies (i).
2
The preceding result says that a mapping between metric spaces is con-
tinuous if and only if the inverse image of each open set is open. But the
image of an open set under a continuous mapping need not be open: the
continuous function x ‚Üí0 maps each nonempty open subset of R onto
the closed set {0} . Likewise, although the inverse image of a closed set
under a continuous mapping is closed, the image of a closed set need not
be: the mapping (x, y) ‚Üíx on the Euclidean space R2 takes the hyperbola
{(x, y) : xy = 1} , a closed set, onto the open set R\ {0} .
(3.2.3) Proposition.
Let X, Y, Z be metric spaces. If f : X ‚ÜíY is
continuous at a ‚ààX, and g : Y ‚ÜíZ is continuous at f(a), then the
composite mapping g ‚ó¶f : X ‚ÜíZ is continuous at a. If f is continuous on
X and g is continuous on Y , then g ‚ó¶f is continuous on X.
Proof.
Suppose that f is continuous at a and that g is continuous at
b = f(a). Let Œµ > 0. The continuity of g at b ensures that there exists Œ¥‚Ä≤ > 0
such that if œÅ(b, y) < Œ¥‚Ä≤, then œÅ(g(b), g(y)) < Œµ. In turn, as f is continuous
at a, there exists Œ¥ > 0 such that if œÅ(a, x) < Œ¥, then œÅ(f(a), f(x)) < Œ¥‚Ä≤. So
if œÅ(a, x) < Œ¥, then œÅ(b, f(x)) < Œ¥‚Ä≤ and therefore œÅ(g(b), g(f(x))) < Œµ ; that
is,
œÅ (g ‚ó¶f(a), g ‚ó¶f(x)) < Œµ.
Hence g ‚ó¶f is continuous at a.
The second conclusion of the proposition follows immediately from the
Ô¨Årst.
2

138
3. Analysis in Metric Spaces
Let S be a subset of a metric space X, and a a limit point of S ‚Äîthat
is, a point of the closure of S\ {a} . Let f be a mapping of S\ {a} into a
metric space Y , and l a point of Y. We say that f(x) has a limit l as x
tends to a in S if the mapping F : S ‚à™{a} ‚ÜíY deÔ¨Åned by
F(x) =
Ô£±
Ô£≤
Ô£≥
f(x)
if x ‚ààS\ {a}
l
if x = a
is continuous at a relative to the subspace S ‚à™{a} of X. We then also use
such expressions as l is a limit of the mapping f at a with respect to S, or
f(x) converges to l as x tends to a in S, or f(x) tends to l as x ‚ààS tends
to a. In that case we write
l =
lim
x‚Üía, x‚ààS f(x)
or
f(x) ‚Üíl as x ‚Üía, x ‚ààS,
Note that in this deÔ¨Ånition it is not required either that a ‚ààS or that f(x)
be deÔ¨Åned at x = a.
In the special case where S = X we often write limx‚Üía f(x), rather than
limx‚Üía, x‚ààX f(x).
(3.2.4) Exercises
.1
Prove that the following condition is both necessary and suÔ¨Écient
for l ‚ààY to be a limit of f(x) as x ‚ààS tends to a: for each Œµ > 0
there exists Œ¥ > 0 such that if x ‚ààS and 0 < œÅ(a, x) < Œ¥, then
œÅ(l, f(x)) < Œµ.
.2
Prove that a mapping f has at most one limit at a ‚àà(S\{a}) with
respect to the subset S of X. (Thus we are safe in referring to ‚Äúthe‚Äù
limit of f at a.)
.3
Let a ‚ààX be a limit point of X. Prove that f : X ‚ÜíY is continuous
at a if and only if f(a) = limx‚Üía, x‚ààX f(x).
.4
Show that if l = limx‚Üía, x‚ààS f(x), then for each subset A of S such
that a ‚ààA\{a}, l is the limit of f at a with respect to A.
.5
Show that if l = limx‚Üía, x‚ààX f(x) and the mapping g : Y ‚ÜíZ is
continuous at l, then g(l) = limx‚Üía, x‚ààX g(f(x)).
.6
Prove that if l = limx‚Üía, x‚ààS f(x), then l ‚ààf(S).

3.2 Continuity, Convergence, and Completeness
139
Using the metric on the extended real line ¬ØR introduced in Section 1 of
this chapter, we can handle the convergence of sequences in a metric space
X as a special case of the convergence of functions. To this end, recall that
a sequence (xn)‚àû
n=1 in X is really a mapping n ‚Üíxn of N+ into X, and
note that ‚àûis a limit point of N+ in ¬ØR (see Exercise (3.1.3: 7)). If the
mapping n ‚Üíxn has a limit l at the point ‚àû‚àà¬ØR with respect to N+, we
call l the limit of the sequence (xn), we say that the sequence (xn) converges
to l as n tends to ‚àû, and we write
l = lim
n‚Üí‚àûxn
or
xn ‚Üíl as n ‚Üí‚àû.
The next proposition shows, in particular, that on R our current notion
of convergence of sequences coincides with the one introduced in Section
1.2.
(3.2.5) Proposition.
In order that l = limn‚Üí‚àûxn, it is necessary and
suÔ¨Écient that for each Œµ > 0 there exist a positive integer N such that
œÅ(l, xn) < Œµ whenever n ‚â•N.
Proof.
By Exercise (3.2.4: 1), in order that a = limn‚Üí‚àûxn, it is necessary
and suÔ¨Écient that for each Œµ > 0 there exist Œ¥ > 0 such that if n ‚ààN+
and 0 < œÅ¬ØR(‚àû, n) < Œ¥, then œÅ(a, xn) < Œµ. But
œÅ¬ØR(‚àû, n) = (n + 1)‚àí1 > 0 ,
so œÅ¬ØR(‚àû, n) < Œ¥ if and only if n ‚â•N, where N is the smallest positive
integer > Œ¥‚àí1 ‚àí1. The desired conclusion now follows.
2
In view of Proposition (3.2.5), we can easily adapt to the context of a
metric space many of the elementary results about limits of sequences that
were proved in the context of R in Chapter 1. We frequently do this without
further comment.
(3.2.6) Proposition.
Let S be a subset of the metric space X, and a ‚àà
X. In order that a ‚ààS, it is necessary and suÔ¨Écient that a be the limit of
a sequence of points of S.
Proof.
To prove the necessity of the stated condition, assume that a ‚ààS.
Then for each positive integer n there exists a point xn in S ‚à©B(a, n‚àí1).
Since œÅ(xn, a) < 1/N whenever n ‚â•N, the sequence (xn) converges to a.
The suÔ¨Éciency part of the proposition is left as an exercise.
2
(3.2.7) Proposition.
Let (xn) be a sequence in X, and a ‚ààX. In order
that there exist a subsequence of (xn) converging to a, it is necessary and

140
3. Analysis in Metric Spaces
suÔ¨Écient that for each neighbourhood U of a, xn ‚ààU for inÔ¨Ånitely many
values of n.
Proof.
The condition is clearly necessary. Conversely, if it is satisÔ¨Åed,
then we can construct, inductively, a strictly increasing sequence (nk)
of positive integers such that xnk ‚ààB(a, k‚àí1) for each k. Since xnj ‚àà
B(a, k‚àí1) whenever j ‚â•k, the subsequence (xnk) of (xn) converges to the
limit a.
2
(3.2.8) Exercises
.1
Prove the suÔ¨Éciency of the condition in Proposition (3.2.6).
.2
Prove that the subset A is dense in the metric space X if and only
if for each x ‚ààX there exists a sequence (xn) of points of A that
converges to X.
.3
Let A be a dense subset of X, and let f, g be continuous functions
from X into a metric space Y such that f(x) = g(x) for all x in A.
Prove that f(x) = g(x) for all x in X.
.4
Let f be a mapping between metric spaces X and Y, and let a ‚àà
X. Prove that f is continuous at a if and only if it is sequentially
continuous at a, in the sense that f(xn) ‚Üíf(a) whenever (xn) is a
sequence in X that converges to a.
.5
Let X be a separable metric space, and f a mapping of X into R.
For each pair of rational numbers q, q‚Ä≤ let Xq,q‚Ä≤ be the set of t ‚ààX
such that limx‚Üít, x‚ààX f(x) exists and
f(t) ‚â§q < q‚Ä≤ ‚â§
lim
x‚Üít, x‚ààX f(x).
Show that Xq,q‚Ä≤ is either empty or countable. (Use Exercise (3.1.8: 5).)
Hence prove that the set of points t ‚ààX such that limx‚Üít, x‚ààX f(x)
exists and does not equal f(t) is empty or countable.
A sequence (xn) in a metric space X is called a Cauchy sequence if
for each Œµ > 0 there exists a positive integer N such that œÅ(xm, xn) < Œµ
whenever m, n ‚â•N. Any convergent sequence is a Cauchy sequence: for if
(xn) converges to a limit l, then, given Œµ > 0 and choosing N such that
œÅ(xn, l) < Œµ/2 for all n ‚â•N, we use the triangle inequality to show that
œÅ(xm, xn) < Œµ whenever m, n ‚â•N.
We say that X is complete if each Cauchy sequence in X has a limit in
X. We have already seen that R is complete (Theorem (1.2.10)).
(3.2.9) Proposition.
A complete subspace of a metric space is closed.
A closed subspace of a complete metric space is complete.

3.2 Continuity, Convergence, and Completeness
141
Proof.
Let S be a subspace of the metric space X. If x ‚ààS, then by
Proposition (3.2.6), there exists a sequence (xn) in S that converges to x.
Being convergent, (xn) is a Cauchy sequence in S. So if S is complete, then
(xn) converges to a limit s in S. By Exercise (3.2.4: 2), we then have x = s,
so x ‚ààS. Hence S = S ‚Äîthat is, S is closed in X.
Conversely, suppose that X is complete and S is closed in X. If (xn) is a
Cauchy sequence in S, then it converges to a limit x in X. By Proposition
(3.2.6), x ‚ààS = S. Hence S is complete.
2
(3.2.10) Exercises
.1
Prove that a sequence (xn) in an ultrametric space is a Cauchy se-
quence if and only if limn‚Üí‚àûœÅ(xn, xn+1) = 0. Give an example to
show that this is not the case in a general metric space.
.2
Show that a Cauchy sequence (xn) in X is bounded, in the sense that
{xn : n ‚â•1} is a bounded subset of X.
.3
Prove that if a Cauchy sequence (xn) has a subsequence that
converges to a limit a, then xn ‚Üía as n ‚Üí‚àû.
.4
Prove that the interval I = (0, 1] is not complete with respect to
the metric œÅ induced by the usual metric on R. DeÔ¨Åne a mapping
œÅ‚Ä≤ : I √ó I ‚ÜíR by
œÅ‚Ä≤(x, y) =
   1
x ‚àí1
y
   .
Show that œÅ‚Ä≤ is a metric on I, that œÅ and œÅ‚Ä≤ are equivalent metrics on
I, and that (I, œÅ‚Ä≤) is complete.
.5
Let A and B be complete subsets of a metric space. Give at least two
proofs that A ‚à™B and A ‚à©B are complete.
.6
Suppose that œÅ(S, T) > 0 for any two disjoint closed subsets S, T of X.
Prove that X is complete. (Suppose there exists a Cauchy sequence
(xn) that does not converge to a limit in X. First reduce to the case
where xm Ã∏= xn whenever m Ã∏= n. Then consider the sets {x2n : n ‚â•1}
and {x2n‚àí1 : n ‚â•1} .)
.7
Prove that if X is a nonempty set, then the metric space B(X, R)
is complete. (See Exercise (3.1.1: 7). Given a Cauchy sequence (fn)
in B(X, R) and a positive number Œµ, Ô¨Årst show that for each x ‚ààX,
(fn(x))‚àû
n=1 is a Cauchy sequence in R and therefore converges to a
limit f(x) ‚ààR. Then prove that the function f so deÔ¨Åned is bounded,
and that (fn) converges to f in the metric on B(X, R).)
.8
Let X be a metric space, a ‚ààX, and for all x, y ‚ààX deÔ¨Åne
œÜx(y) = œÅ(x, y)

142
3. Analysis in Metric Spaces
and
Y = {œÜa + f : f ‚ààB(X, R)} .
Prove that
(i) œÜx ‚ààY,
(ii) the equation
d(F, G) = sup {|F(x) ‚àíG(x)| : x ‚ààX}
deÔ¨Ånes a metric on Y,
(iii) x ‚ÜíœÜx is an isometric mapping of X into Y, and
(iv) the closure -
X of {œÜx : x ‚ààX} in Y is a complete metric space.
We call the metric space ( -
X, d) the completion of X. More generally,
we say that a complete metric space X‚Ä≤ is a completion of X if there is
an isometry of X onto a dense subspace of X‚Ä≤; but as two completions
of the same metric space X are isometric (why?), we commonly refer
to any completion of X as ‚Äúthe‚Äù completion of X.
We now arrive at the notion of uniform continuity, a natural strength-
ening of continuity that, as we show in Theorem (3.3.12), turns out to be
equivalent to continuity for certain very important spaces.
We say that a mapping f : X ‚ÜíY between metric spaces is uniformly
continuous if for each Œµ > 0 there exists Œ¥ > 0 such that œÅ(f(x), f(y)) < Œµ
whenever x, y ‚ààX and œÅ(x, y) < Œ¥.
(3.2.11) Exercises
.1
Prove that a uniformly continuous mapping is continuous. Give an
example of a continuous mapping on (0, 1] that is not uniformly
continuous.
.2
Let f, g be uniformly continuous mappings of X into R. Show that
f +g, f ‚àíg, and fg are uniformly continuous on X. Show that if also
infx‚ààX |f(x)| > 0, then 1/f is uniformly continuous on X.
.3
Let f : X ‚ÜíY and g : Y ‚ÜíZ be uniformly continuous mappings
between metric spaces. Show that g ‚ó¶f is uniformly continuous on X.
.4
Let S be a nonempty subset of X. Show that the mapping x ‚ÜíœÅ(x, S)
is uniformly continuous on X.
.5
Let (an) be a sequence in X. Prove that the function
x ‚Üíinf
n‚â•1 œÅ(x, an)
is uniformly continuous on X.

3.2 Continuity, Convergence, and Completeness
143
.6
Let Œ± be a positive number. A mapping f between metric spaces X
and Y is said to satisfy a Lipschitz condition of order Œ±, or to be
Lipschitz of order Œ±, if
œÅ (f(x), f(y)) ‚â§(œÅ(x, y))Œ±
(x, y ‚ààX).
Prove that such a mapping is uniformly continuous.
.7
Prove that a mapping f between metric spaces X, Y is uniformly
continuous if and only if œÅ(f(S), f(T)) = 0 whenever S, T ‚äÇX and
œÅ(S, T) = 0.
.8
Prove that if X is not complete, then there exists a uniformly
continuous mapping of X into R+ with inÔ¨Åmum 0. (See Exercise
(3.2.10: 8).)
.9
Prove that if X is not complete, then there exists an unbounded
continuous mapping of X into R.
.10 Suppose that every continuous mapping of X into R is uniformly
continuous. Prove that X is complete. (Assume that X is a dense
subset of its completion -
X, as deÔ¨Åned in Exercise (3.2.10: 8), and
that there exists a Cauchy sequence of elements of X converging to
x‚àû‚àà-
X\X. Consider the function x ‚Üí1/œÅ(x, x‚àû) on X.)
(3.2.12) Proposition.
Let D be a dense subset of a metric space X, and
f a uniformly continuous mapping of D into a complete metric space Y .
Then there exists a unique continuous mapping F of X into Y such that
F(x) = f(x) for all x in D; moreover, F is uniformly continuous on X.
Proof.
For each Œµ > 0 there exists Œ¥ > 0 such that œÅ(f(x), f(x‚Ä≤)) < Œµ
whenever œÅ(x, x‚Ä≤) < Œ¥. Given x in X, let (xn) be a sequence in D converg-
ing to x. Since for each Œµ > 0 there exists N such that œÅ(xm, xn) < Œ¥, and
therefore œÅ(f(xm), f(xn)) < Œµ, whenever m, n ‚â•N, we see that (f(xn)) is
a Cauchy sequence in Y . As the latter space is complete, (f(xn)) con-
verges to a limit Œæ in Y . Moreover, if (x‚Ä≤
n) is another sequence in D
converging to x, then limn‚Üí‚àûf(x‚Ä≤
n) = Œæ: for, replacing (xn) by the se-
quence (x1, x‚Ä≤
1, x2, x‚Ä≤
2, . . .) in the foregoing argument, we can show that
(f(x1), f(x‚Ä≤
1), f(x2), f(x‚Ä≤
2), . . .) is a Cauchy sequence; since the subsequence
(f(xn)) converges to Œæ, we conclude from Exercise (3.2.10: 3) that the se-
quence (f(x1), f(x‚Ä≤
1), f(x2), f(x‚Ä≤
2), . . .), and hence the subsequence (f(x‚Ä≤
n)),
converges to Œæ. Thus
F(x) = Œæ = lim
n‚Üí‚àûf(xn)
is an unambiguous deÔ¨Ånition of a function F from X into Y . If x ‚ààD, then
(x, x, . . .) is a sequence in D converging to x, so F(x) = f(x).

144
3. Analysis in Metric Spaces
To prove that F is uniformly continuous, consider x, x‚Ä≤ in X such that
œÅ(x, x‚Ä≤) < Œ¥, and let (xn) and (x‚Ä≤
n) be sequences in D converging to x and
x‚Ä≤, respectively. Then (f(xn)) and (f(x‚Ä≤
n)) converge to F(x) and F(x‚Ä≤),
respectively. So for all suÔ¨Éciently large n we have œÅ(F(x), f(xn)) < Œµ,
œÅ(F(x‚Ä≤), f(x‚Ä≤
n)) < Œµ, and œÅ(xn, x‚Ä≤
n) < Œ¥; whence œÅ(f(xn), f(x‚Ä≤
n)) < Œµ, and
therefore, by the triangle inequality, œÅ(F(x), F(x‚Ä≤)) < 3Œµ. Thus F is uni-
formly continuous on X. Finally, the uniqueness of F is an immediate
consequence of Exercise (3.2.8: 3).
2
The foregoing result enables us to extend uniformly continuous functions
from dense subsets to the whole space. We close this section with a famous
theorem that enables us to extend continuous real‚Äìvalued functions from
closed subspaces to the whole space.
(3.2.13) The Tietze Extension Theorem.
Let X be a metric space,
Y a closed subspace of X, and f a bounded continuous mapping of Y into
R. Then there exists a bounded continuous mapping F : X ‚ÜíR such that
(i) F(y) = f(y) for all y ‚ààY,
(ii) infx‚ààX F(x) = infy‚ààY f(y), and
(iii) supx‚ààX F(x) = supy‚ààY f(y).
Proof.
We may assume that f is not constant. Let h be an increasing
function of the form x ‚Üíax + b mapping the interval [inf f, sup f] onto
[1, 2]; replacing f by h‚ó¶f, if necessary, we reduce to the case where inf f = 1
and sup f = 2. Since Y is closed, œÅ(x, Y ) > 0 for all x ‚ààX\Y (Exercise
(3.1.10: 3)), and so
F(x) =
Ô£±
Ô£¥
Ô£¥
Ô£≤
Ô£¥
Ô£¥
Ô£≥
f(x)
if x ‚ààY
infy‚ààY f(y)œÅ(x, y)
œÅ(x, Y )
if x ‚ààX\Y
deÔ¨Ånes a function F : X ‚ÜíR that coincides with f on Y . To prove that F
satisÔ¨Åes (ii) and (iii), we need only show that 1 ‚â§F(x) ‚â§2 for all x ‚ààX\Y.
For such x and all y ‚ààY we have
F(x) ‚â§2œÅ(x, y)
œÅ(x, Y ) .
So, given Œµ > 0 and choosing y ‚ààY such that
œÅ(x, y) ‚â§

1 + Œµ
2

œÅ(x, Y ),

3.2 Continuity, Convergence, and Completeness
145
we obtain F(x) ‚â§2 + Œµ. On the other hand, choosing y‚Ä≤ ‚ààY such that
1 ‚â§œÅ(x, y‚Ä≤)
œÅ(x, Y ) ‚â§f(y‚Ä≤)œÅ(x, y‚Ä≤)
œÅ(x, Y )
< F(x) + Œµ,
we see that F(x) > 1‚àíŒµ. As Œµ > 0 is arbitrary, it follows that 1 ‚â§F(x) ‚â§2.
Since f is continuous on Y ‚ó¶, so is F. Also, the function x ‚ÜíœÅ(x, Y )
is uniformly continuous on X\Y, by Exercise (3.2.11: 4); so, by Exercises
(3.2.1: 5 and 4), F is continuous on X\Y. It therefore remains to prove the
continuity of F at any Œæ ‚ààY ‚à©X\Y . Given Œµ > 0, choose r > 0 such that
if y ‚ààY and œÅ(Œæ, y) < r, then |f(Œæ) ‚àíf(y)| < Œµ. It suÔ¨Éces to prove that if
x ‚ààX\Y and œÅ(x, Œæ) < r/4, then
F(Œæ) ‚àíŒµ ‚â§F(x) ‚â§F(Œæ) + Œµ.
(1)
To this end, observe that for each y ‚ààY \B(Œæ, r),
œÅ(x, y) ‚â•œÅ(Œæ, y) ‚àíœÅ(x, Œæ) > 3r
4 > 2œÅ(x, Œæ) ‚â•œÅ (x, Y ‚à©B(Œæ, r)) ,
so
f(y)œÅ(x, y) > 3r
4 > f(Œæ)œÅ(x, Œæ) ‚â•
inf
Œ∑‚ààY ‚à©B(Œæ,r) f(Œ∑)œÅ(x, Œ∑).
It follows that
œÅ(x, Y ) = œÅ (x, Y ‚à©B(Œæ, r))
(2)
and that
inf
y‚ààY f(y)œÅ(x, y) =
inf
y‚ààY ‚à©B(Œæ,r) f(y)œÅ(x, y).
(3)
For each y ‚ààY ‚à©B(Œæ, r) we have
f(Œæ) ‚àíŒµ < f(y) < f(Œæ) + Œµ
and therefore
(f(Œæ) ‚àíŒµ) œÅ(x, Y ) ‚â§f(y)œÅ(x, y) ‚â§(f(Œæ) + Œµ) œÅ(x, y).
Hence
(f(Œæ) ‚àíŒµ) œÅ(x, Y ) ‚â§
inf
y‚ààY ‚à©B(Œæ,r) f(y)œÅ(x, y) ‚â§(f(Œæ) + Œµ) œÅ(x, Y ‚à©B(Œæ, r)),
and so, by (2) and (3),
(f(Œæ) ‚àíŒµ) œÅ(x, Y ) ‚â§inf
y‚ààY f(y)œÅ(x, y) ‚â§(f(Œæ) + Œµ) œÅ(x, Y ).
Dividing through by œÅ(x, Y ), we obtain the desired inequalities (1).
2
The mapping F in Theorem (3.2.13) is called a continuous extension of
f to X.

146
3. Analysis in Metric Spaces
(3.2.14) Exercises
.1
Give two proofs of Urysohn‚Äôs Lemma: if S, T are nonempty disjoint
closed subspaces of a metric space X, then there exists a continuous
mapping f : X ‚Üí[0, 1] such that f(S) = {0} and f(T) = {1} . (For
one proof, note that œÅ(x, S) + œÅ(x, T) > 0 for all x ‚ààX.)
.2
Let Y be a closed subspace of a metric space X, and f a continuous
mapping of Y into R. Prove that there exists a continuous extension
F : X ‚ÜíR of f. (First apply Theorem (3.2.13) to g ‚ó¶f for some
suitable function g.)
.3
Suppose that for each pair S, T of nonempty disjoint closed subsets
of X there exists a uniformly continuous mapping f : X ‚Üí[0, 1] such
that f(S) = {0} and f(T) = {1} . Prove that X is complete.
.4
Show that the following are equivalent conditions on X.
(i) Every continuous function f : X ‚ÜíR is uniformly continuous.
(ii) œÅ(S, T) > 0 for all nonempty disjoint closed subsets S, T of X.
(To prove that (ii) implies (i), suppose that f : X ‚ÜíR is continuous
but not uniformly continuous. Then there exist sequences (xn), (yn)
in X and a positive number Œ± such that limn‚Üí‚àûœÅ(xn, yn) = 0 and
|f(xn) ‚àíf(yn)| ‚â•Œ± for all n. Consider the sets S = {xn : n ‚â•1} and
T = {yn : n ‚â•1} .)
3.3
Compactness
In the context of a metric space, the various notions associated with the
word compactness represent diÔ¨Äerent generalisations of, and approxima-
tions to, Ô¨Åniteness.
Let S be a subset of a metric space (X, œÅ). By a cover of S we mean a
family U of subsets of X such that S ‚äÇ U; we then say that S is covered
by U, and that U covers S. If also each U ‚ààU is an open subset of X, we
refer to U as an open cover of S. On the other hand, if U is a Ô¨Ånite set, we
call it a Ô¨Ånite cover of S. By a subcover of U we mean a subfamily F of U
that covers S.
A metric space X is called compact, or a compact space, if every open
cover of X contains a Ô¨Ånite subcover. By a compact set in a metric space
X we mean a subset of X that is compact when considered as a metric
subspace of X.
Note that we can apply our deÔ¨Ånition of compactness to a topological
space X, even if the topology of X is not metrisable.

3.3 Compactness
147
The Heine‚ÄìBorel‚ÄìLebesgue Theorem (1.4.6) shows that a bounded closed
interval in R is compact.
(3.3.1) Proposition.
A compact subset of a metric space is separable
and bounded.
Proof.
Let S be a compact subset of a metric space X. We may assume
that S is nonempty. For each positive integer n the family (B(s, n‚àí1))s‚ààS
of open balls is an open cover of S, so there exists a Ô¨Ånite subset Fn of S
such that S is covered by the balls B(s, n‚àí1) with s ‚ààFn. It follows that
the countable set ‚àû
n=1 Fn is dense in S, which is therefore separable.
Now Ô¨Åx s1 ‚ààF1, and deÔ¨Åne the nonnegative number
R = max{œÅ(s, s1) : s ‚ààF1}.
For each x ‚ààS choose s ‚ààF1 such that œÅ(x, s) < 1; then
œÅ(x, s1) ‚â§œÅ(x, s) + œÅ(s, s1) < 1 + R.
Hence S is bounded.
2
(3.3.2) Proposition.
A compact set in a metric space is closed.
Proof.
Let S be a compact subset of a metric space X. We may assume
that X\S is nonempty. If a ‚ààX\S, then for each s ‚ààS,
0 < rs = œÅ(a, s).
The open balls B(s, 1
2rs), with s ‚ààS, form an open cover of S, so there
exists a Ô¨Ånite subset F of S such that S is covered by the balls B(s, 1
2rs)
with s ‚ààF. DeÔ¨Åne the positive number
r = min{rs : s ‚ààF}.
For each x ‚ààS choose s ‚ààF such that x ‚ààB(s, 1
2rs); then
œÅ(a, x) ‚â•œÅ(a, s) ‚àíœÅ(x, s)
‚â•rs ‚àí1
2rs
‚â•1
2r.
It follows that B(a, 1
2r) ‚äÇX\S and therefore that a is an interior point
of X\S. Since a is any point of X\S, we conclude that X\S is open and
therefore that S is closed.
2
(3.3.3) Proposition.
A compact metric space is complete.

148
3. Analysis in Metric Spaces
Proof.
Let X be a compact metric space, and -
X its completion (Exercise
(3.2.10: 8)). By Proposition (3.3.2), X is a closed subspace of -
X. Since -
X
is complete, it follows from Proposition (3.2.9) that X is complete.
2
(3.3.4) Proposition.
A closed subset of a compact metric space is
compact.
Proof.
Let S be a closed subset of a compact metric space X, and let U
be an open cover of S. By Proposition (3.1.5), for each U ‚ààU there exists
an open set VU in X such that U = S ‚à©VU. Then X\S and the sets VU,
with U ‚ààU, form an open cover of X. Since X is compact, there exist
Ô¨Ånitely many sets U1, . . . , Un in U such that
{X\S} ‚à™{VU1, . . . , VUn}
is an open cover of X. Clearly, {U1, . . . , Un} covers S and so is a Ô¨Ånite
subcover of U; whence S is compact.
2
(3.3.5) Exercises
.1
Find an alternative proof of Proposition (3.3.2).
.2
Find an alternative proof of Proposition (3.3.3). (Suppose that X is
compact but not complete, and let (xn) be a Cauchy sequence in X
that does not converge and therefore has no convergent subsequence.
Then for each x ‚ààX there exist rx > 0 and Nx ‚ààN+ such that
œÅ(xn, x) > rx for all n ‚â•Nx. Cover X by Ô¨Ånitely many of the balls
B(x, 1
2rx).)
.3
Prove that a subset of the Euclidean space Rn is compact if and only
if it is bounded and closed.
.4
A family F of subsets of a set X is said to have the Ô¨Ånite intersection
property if every Ô¨Ånite subfamily of F has a nonempty intersection.
Prove that a metric space X is compact if and only if every family
of closed subsets of X with the Ô¨Ånite intersection property has a
nonempty intersection.
.5
Let K be a compact subset of an open set U ‚äÇX. Prove that there
exists r > 0 such that if œÅ(x, K) ‚â§r, then x ‚ààU.
.6
Prove that any open cover of a separable metric space has a countable
subcover. (This is a special case of Lindel¬®of‚Äôs Theorem; see page 72
of [47].)
(3.3.6) Proposition.
If f is a continuous mapping of a compact metric
space X into a metric space Y , then f(X) is a compact set.

3.3 Compactness
149
Proof.
Let U be an open cover of f(X). By Proposition (3.2.2), the family

f ‚àí1(U)
	
U‚ààU is an open cover of X. Since X is compact, there is a Ô¨Ånite
set F ‚äÇU such that

f ‚àí1(U)
	
U‚ààF is an open cover of X. Then F is an
open cover of f(X), which is therefore compact.
2
(3.3.7) Exercises
.1
Prove that a continuous mapping f of a compact metric space X into
R is bounded. Prove also that f attains its bounds, in the sense that
there exist points a, b in X such that f(a) = inf f and f(b) = sup f.
.2
Prove that a continuous mapping of a compact space X into R+ has
a positive inÔ¨Åmum.
.3
Prove that if f is a continuous one‚Äìone mapping of a compact metric
space X onto a metric space Y , then the inverse mapping f ‚àí1 : Y ‚Üí
X is continuous. (Use Proposition (3.2.2).)
.4
A mapping f of a set X into itself is called a self‚Äìmap of X. By
a Ô¨Åxed point of such a mapping we mean a point x ‚ààX such that
f(x) = x. Let f be a contractive self‚Äìmap of a compact metric space
X (see Exercise (3.2.1: 3)). Prove that the mapping x ‚ÜíœÅ(x,f(x)) of
X into R is continuous. Applying Exercise (3.3.7: 1) to this mapping,
deduce that f has a Ô¨Åxed point (Edelstein‚Äôs Theorem). Prove that
there is no other Ô¨Åxed point of f.
There are other properties of a metric space X that capture the idea of
approximate Ô¨Åniteness and are intimately related to compactness. We say
that X is
‚Ä¢ sequentially compact if every sequence in X has a convergent
subsequence;
‚Ä¢ totally bounded, or precompact, if for each Œµ > 0 there exists a Ô¨Ånite
cover of X by subsets of diameter < Œµ.
Sequential compactness, like compactness, is a topological concept, whereas
total boundedness is a metric notion. An analogue of sequential compact-
ness can be deÔ¨Åned for a general topological space; see under ‚ÄúÔ¨Ålters‚Äù in [7]
or [47]. For a nonmetric analogue of total boundedness we need the context
of a uniform space, which is also discussed in [7] and [47].
The total boundedness of a metric space X can be expressed diÔ¨Äerently.
By an Œµ‚Äìapproximation to X we mean a subset S of X such that œÅ(x, S) < Œµ
for each x ‚ààX. It is easy to show that X is totally bounded if and only
if for each Œµ > 0 it contains a Ô¨Ånite Œµ‚Äìapproximation. Note that since the
empty set is regarded as Ô¨Ånite, it is also totally bounded.

150
3. Analysis in Metric Spaces
Corollary (1.2.8) shows that a bounded closed subset of R is sequentially
compact.
(3.3.8) Exercises
.1
Prove that a bounded interval in R is totally bounded.
.2
Prove that a subset of a totally bounded metric space is totally
bounded.
.3
Prove that if a metric space is either sequentially compact or totally
bounded, then it is bounded.
.4
Show that a totally bounded metric space is separable.
.5
Let f be a uniformly continuous mapping of a totally bounded metric
space into a metric space. Prove that the range of f is totally bounded.
.6
Let X be a metric space that is not totally bounded. Prove that
there exist a sequence (xn) in X and a positive number Œ± such that
œÅ(xm, xn) ‚â•Œ± whenever m Ã∏= n.
.7
Let f be a function of bounded variation on a compact interval I ‚äÇR.
Prove that f(I) is totally bounded. (Use the preceding exercise.)
.8
Let X be a metric space that is not totally bounded, and choose
(xn) and Œ± as in Exercise (3.3.8: 6). For each n construct a uniformly
continuous function œÜn : X ‚Üí[0, 1] such that (i) œÜn(xn) = 1 and (ii)
œÜn(x) = 0 if œÅ(x, xn) ‚â•Œ±/3. Given any sequence (cn) of real numbers,
show that f = ‚àû
n=1 cnœÜn is a well‚ÄìdeÔ¨Åned continuous function on
X, and that if (cn) is bounded, then f is uniformly continuous on X.
.9
Let (X, œÅ) be a separable metric space. Show that there exists on X
a metric d equivalent to œÅ, such that (X, d) is totally bounded. (Let
(xn) be a dense sequence in X, and use Exercise (3.2.1: 6) to reduce
to the case where œÅ < 1. DeÔ¨Åne
d(x, y) =
‚àû

n=1
2‚àín |œÅ(x, xn) ‚àíœÅ(y, xn)|
for all x, y ‚ààX.)
We now arrive at a fundamental theorem linking compactness, sequential
compactness, and total boundedness.
(3.3.9) Theorem.
The following are equivalent conditions on a metric
space (X, œÅ).

3.3 Compactness
151
(i) X is compact.
(ii) X is sequentially compact.
(iii) X is totally bounded and complete.
Proof.
First, let X be a compact metric space, and (xn) a sequence in
X. For each n let Fn be the closure of {xn, xn+1, xn+2, . . .} in X. It is
easy to show that (Fn)‚àû
n=1 has the Ô¨Ånite intersection property. By Exercise
(3.3.5: 4), ‚àû
n=1 Fn contains a point a. Consider any neighbourhood U of a.
For each n, since a ‚ààFn, there exists m ‚â•n such that xm ‚ààU. It follows
that U contains xk for inÔ¨Ånitely many values of k; whence, by Proposition
(3.2.7), there exists a subsequence of (xn) converging to a. Thus (i) implies
(ii).
Next, let X satisfy (ii). Then any Cauchy sequence in X has a conver-
gent subsequence and so converges to a limit in X, by Exercise (3.2.10: 3);
whence X is complete. Suppose that X is not totally bounded. Then, by
Exercise (3.3.8: 6), there exist a sequence (xn) in X and a positive number
Œ± such that œÅ(xm, xn) ‚â•Œ± whenever m Ã∏= n. Clearly, (xn) has no Cauchy
subsequences and therefore no convergent subsequences. This contradicts
our assumption (ii); so, in fact, X is totally bounded. Thus (ii) implies (iii).
It remains to prove that (iii) implies (i). Accordingly, let X be totally
bounded and complete, and suppose that there exists an open cover U of
X that contains no Ô¨Ånite subcover. With B0 = X, we construct a sequence
(Bn)‚àû
n=1 of closed balls in X such that for each n ‚â•1,
(a) Bn has radius 2‚àín,
(b) Bn has a nonempty intersection with Bn‚àí1, and
(c) no Ô¨Ånite subfamily of U is a cover of Bn‚àí1.
Having constructed B0, . . . , Bn‚àí1 with the applicable properties, let (Vj)m
j=1
be a Ô¨Ånite cover of Bn‚àí1 by balls in Bn‚àí1 of radius 2‚àín. (Note that Bn‚àí1
is totally bounded, by Exercise (3.3.8: 2).) Amongst the sets Vj there exists
at least one‚Äîcall it Bn‚Äîthat is not covered by Ô¨Ånitely many of the sets in
U: otherwise each of the Ô¨Ånitely many sets Vj, and therefore Bn‚àí1, would
be covered by Ô¨Ånitely many elements of U, thereby contradicting (c). This
completes the inductive construction of Bn.
For each n ‚â•1 let xn be the centre of Bn. Since Bn ‚à©Bn‚àí1 is nonempty,
it follows from the triangle inequality that for n ‚â•2,
œÅ(xn, xn‚àí1) ‚â§2‚àín + 2‚àín+1 < 2‚àín+2.
So if j > i ‚â•N ‚â•1, then
œÅ(xi, xj) ‚â§
j

k=i+1
œÅ(xk, xk‚àí1)

152
3. Analysis in Metric Spaces
<
j

k=i+1
2‚àík+2
< 2‚àíi+1
‚àû

k=0
2‚àík = 2‚àíi+2 ‚â§2‚àíN+2.
Hence (xn) is a Cauchy sequence in X and so, as X is complete, converges
to a limit x‚àûin X. Now pick U ‚ààU such that x‚àû‚ààU. Since U is open,
there exists r > 0 such that B(x‚àû, r) ‚äÇU. Choosing N > 1 such that
œÅ(x‚àû, xN) < r/2 and 2‚àíN < r/2, we see that for each x ‚ààBN,
œÅ(x, x‚àû) ‚â§œÅ(x, xN) + œÅ(x‚àû, xN) < 2‚àíN + r/2 < r,
so x ‚ààB(x‚àû, r). Hence BN ‚äÇB(x‚àû, r) ‚äÇU, which contradicts (c). It
follows that our initial assumption about the open cover U is false; whence
X is compact, and therefore (iii) implies (i).
2
The proof that (iii) implies (i) in Theorem (3.3.9) is a generalisation of
the argument we used to prove the Heine‚ÄìBorel‚ÄìLebesgue Theorem (1.4.6).
(3.3.10) Exercises
.1
Use sequential compactness arguments to show that a compact subset
of a metric space is both bounded and closed.
.2
Show that if X is compact, then there exist points a, b of X such that
œÅ(a, b) = diam(X).
.3
Let A, B be nonempty disjoint subsets of a metric space X with A
closed and B compact. Give two proofs that œÅ(A, B) > 0.
.4
Let (Sn) be a descending sequence of compact sets in a metric space
X (so S1 ‚äÉS2 ‚äÉ¬∑ ¬∑ ¬∑). Prove, in at least two diÔ¨Äerent ways, that if
Sn Ã∏= ‚àÖfor all n, then ‚àû
n=1 Sn Ã∏= ‚àÖ.
.5
Let X be a compact space in which each point x is isolated (see
Exercise (3.1.8: 5)). Give at least two proofs that X is Ô¨Ånite.
.6
Prove that if every continuous mapping of X into R is bounded, then
X is compact. (First suppose that X is not totally bounded, and use
Exercise (3.3.8: 8) to construct an unbounded continuous mapping of
X into R. Then use Exercise (3.2.11: 9).)
Is this true if ‚Äúcontinuous‚Äù is replaced by ‚Äúuniformly continuous‚Äù in
the hypothesis?
.7
Prove that if every uniformly continuous mapping of X into R+ has
a positive inÔ¨Åmum, then X is compact. (cf. Exercise (3.3.7: 2). Use
Exercises (3.3.8: 8), (3.2.11: 5), and (3.2.11: 8).)

3.3 Compactness
153
.8
Let (X, œÅ) be a metric space, and suppose that X is complete with
respect to every metric equivalent to œÅ (see Exercise (3.1.3: 6)). Prove
that X is compact. (Suppose that X is not totally bounded. By Exer-
cise (3.3.8: 6), there exist a sequence (xn) in X and a positive number
Œ± such that œÅ(xm, xn) ‚â•Œ± whenever m Ã∏= n. Show that
d(x, y) = min
*
œÅ(x, y),
inf
m,n‚â•1

œÅ(x, xm) +
  1
m ‚àí1
n
  Œ± + œÅ(y, xn)
+
deÔ¨Ånes a metric equivalent to œÅ with respect to which X is not
complete.)
.9
Prove that the following are equivalent conditions on a metric space
(X, œÅ).
(i) If d is a metric equivalent to œÅ, and S, T are disjoint closed
subsets of (X, d), then d(S, T) > 0.
(ii) X is compact.
(Use Exercises (3.3.10: 3), (3.2.10: 6), and (3.3.10: 8); also, note the
guide to the solution of Exercise (3.3.5: 2).)
The following property of a metric space X is known as the Lebesgue
covering property.
For each open cover U of X there exists r > 0 such that any
open ball of radius r in X is contained in some U ‚ààU.
The positive number r associated with the open cover U in this way is
called a Lebesgue number for U.
(3.3.11) Proposition.
A compact metric space has the Lebesgue cover-
ing property.
Proof.
Let X be a compact metric space, and U an open cover of X. For
each x ‚ààX choose rx > 0 such that B(x, 2rx) ‚äÇU for some U ‚ààU. The
balls B(x, rx), with x ‚ààX, form an open cover of X, from which we can
extract a Ô¨Ånite subcover, say
{B(xi, rxi) : 1 ‚â§i ‚â§n} .
Then
0 < r = min {rx1, . . . , rxn} .
Given x ‚ààX, choose i such that x ‚ààB(xi, rxi). Then for each y ‚ààB(x, r)
we have
œÅ(y, xi) ‚â§œÅ(x, y) + œÅ(x, xi) < r + rxi ‚â§2rxi.

154
3. Analysis in Metric Spaces
So
B(x, r) ‚äÇB(xi, 2rxi) ‚äÇU
for some U ‚ààU.
2
The implications (i) ‚áí(ii) ‚áí(iii) of the Ô¨Årst part of the next result‚Äîa
general version of the Uniform Continuity Theorem for metric spaces‚Äîare
well known, in contrast to the implication (iii) ‚áí(i), which is due to Wong
[55].
(3.3.12) Theorem.
The following are equivalent conditions on a metric
space X.
(i) X has the Lebesgue covering property.
(ii) Every continuous mapping of X into a metric space is uniformly
continuous.
(iii) Every continuous mapping of X into R is uniformly continuous.
Proof.
Assuming (i), let f be a continuous mapping of X into a metric
space, and let Œµ > 0. For each t ‚ààX there exists Œ¥t > 0 such that if
œÅ(x, t) < Œ¥t, then œÅ(f(x), f(t)) < Œµ/2. It follows from the triangle inequality
that if x and y belong to B(t, Œ¥t), then œÅ(f(x), f(y)) < Œµ. Let Œ¥ > 0 be a
Lebesgue number for the open cover (B(t, Œ¥t))t‚ààX of X. If x and y are
points of X such that œÅ(x, y) < Œ¥, then both x and y belong to B(x, Œ¥),
which is a subset of B(t, Œ¥t) for some t; so œÅ(f(x), f(y)) < Œµ. Thus f is
uniformly continuous, and therefore (i) implies (ii).
It is trivial that (ii) implies (iii). To complete the proof, suppose that X
does not have the Lebesgue covering property; so there exists an open cover
U of X for which there is no Lebesgue number. For each positive integer
n we can therefore construct xn ‚ààX such that B(xn, n‚àí1)\U is nonempty
for each U ‚ààU. Then there exists yn ‚ààB(xn, n‚àí1)\ {xn} : for otherwise
we would have
B(xn, n‚àí1) = {xn} ‚äÇU
for some U ‚ààU. We show that
neither (xn) nor (yn) has a convergent subsequence.
(1)
Indeed, if (xn) had a subsequence that converged to a limit Œæ ‚ààX, then,
choosing U ‚ààU such that Œæ ‚ààU, we would have B(xn, n‚àí1) ‚äÇU for
some n, a contradiction. On the other hand, if (ynk)‚àû
k=1 were a convergent
subsequence of (yn), then the subsequence (xnk) of (xn) would converge to
the same limit, which contradicts what we have just proved.

3.3 Compactness
155
Setting n1 = 1, suppose we have constructed n1 < n2 < ¬∑ ¬∑ ¬∑ < nk such
that the sets
Sk = {xn1, . . . , xnk} ,
Tk = {yn1, . . . , ynk}
are disjoint. There exists nk+1 > nk such that xnk+1 /‚ààSk and ynk+1 /‚ààTk:
otherwise we would have either xj ‚ààSk for inÔ¨Ånitely many j or else yj ‚ààTk
for inÔ¨Ånitely many j; since Sk and Tk are Ô¨Ånite, this would imply that either
(xn) or (yn) had a convergent subsequence, thereby contradicting (1). Thus
we have inductively constructed a strictly increasing sequence (nk)‚àû
k=1 of
positive integers such that the sets
S = {xnk : k ‚â•1} ,
T = {ynk : k ‚â•1}
are disjoint. These sets are both closed in X: for example, any point of
S\S would be the limit of some subsequence of (xn), which contradicts
(1). Applying Urysohn‚Äôs Lemma (Exercise (3.2.14: 1)), we now construct a
continuous function f : X ‚Üí[0, 1] such that f(S) = {0} and f(T) = {1} .
Since œÅ(xnk, ynk) < 1/nk but |f(xnk) ‚àíf(ynk)| = 1, the function f is not
uniformly continuous. Hence (iii) implies (i).
2
(3.3.13) Corollary‚ÄîThe Uniform Continuity Theorem.
Every
continuous mapping of a compact metric space into a metric space is
uniformly continuous.
Proof.
This follows from the preceding two results.
2
The converse of Corollary (3.3.13) is not true, since every function from
the discrete metric space N to R is uniformly continuous but N, being un-
bounded, is not compact. However, there is an interesting partial converse
to Corollary (3.3.13), which we discuss in Section 4.
(3.3.14) Exercises
.1
Use a sequential compactness argument to prove that a compact
metric space has the Lebesgue covering property.
.2
Give an example of a totally bounded metric space for which the
Lebesgue covering property does not hold.
.3
Prove that X has the Lebesgue covering property if and only if for
each nonempty closed set S ‚äÇX and each open set U containing S,
there exists r > 0 such that the r‚Äìenlargement of S,
B(S, r) = {x ‚ààX : œÅ(x, S) < r} ,

156
3. Analysis in Metric Spaces
is contained in U. (For ‚Äúonly if‚Äù, consider the open cover {X\S, U}
of X. For ‚Äúif‚Äù, suppose that X does not have the Lebesgue cov-
ering property and, as in the second part of the proof of Theo-
rem (3.3.12), construct disjoint nonempty closed subsets S, T of X
such that œÅ(S, T) = 0; then show that there exists r > 0 such that
B(S, r) ‚äÇX\T.)
.4
Prove that a metric space with the Lebesgue covering property is
complete. Need it be totally bounded?
.5
Let X have the Lebesgue covering property, and let Y be a closed
subset of X. Give two proofs that Y has the Lebesgue covering prop-
erty. (For one proof, use the Tietze Extension Theorem; for another,
work directly with an open cover of Y.)
.6
Prove the Uniform Continuity Theorem using sequential compactness
without the Lebesgue covering property.
.7
Let X be a metric space, and h a mapping of X into a compact
metric space Y. Suppose that f ‚ó¶h is uniformly continuous for each
continuous (and therefore uniformly continuous) mapping f : Y ‚ÜíR.
Give at least two proofs that h is uniformly continuous.
The notion of compactness can be generalised in a number of ways. The
one we deal with is typical of topology, in that it replaces a global property
(one that holds for the whole space) by a local one (one that holds in some
neighbourhood of any given point).
A metric space X is said to be locally compact, or a locally compact
space, if each point in X has a compact neighbourhood in X. For example,
although (in view of Proposition (3.3.1)) R is not compact, it is locally
compact: if x ‚ààR, then [x ‚àí1, x + 1] is a compact neighbourhood of x in
R. Of course, a compact metric space is locally compact.
(3.3.15) Proposition.
Let X be a locally compact space, and S a subset
of X. If either S is open or S is closed, then S is locally compact.
Proof.
Let a ‚ààS, and choose a compact neighbourhood K of a in X. If
S is open, then
a ‚àà(K ‚à©S)‚ó¶= K‚ó¶‚à©S‚ó¶,
so there exists r > 0 such that B(a, r) ‚äÇK and B(a, r) ‚äÇS. As B(a, r) is
closed in X, it is closed in K (by Proposition (3.1.5)) and therefore compact
(by Proposition (3.3.4)). Hence a has a compact neighbourhood in S, and
so S is locally compact.
Now suppose that S is closed in X. Since K is a neighbourhood of a in
X, K ‚à©S is a neighbourhood of a in S (Exercise (3.1.6: 4)). Also, K ‚à©S is

3.3 Compactness
157
closed in K, by Proposition (3.1.5), and therefore compact, by Proposition
(3.3.4). Hence S is locally compact.
2
(3.3.16) Exercises
.1
Let S and T be locally compact subspaces of a locally compact metric
space X. Prove that S ‚à©T is locally compact. Need S ‚à™T be locally
compact?
.2
Is every locally compact space complete?
.3
Let X be a metric space in which every bounded set is contained in
a compact set. Prove that X is locally compact and separable.
.4
Let X be locally compact, and K a compact subset of X. Prove that
for some r > 0 the closure of the r‚Äìenlargement of K is compact.
(See Exercise (3.3.14: 3).)
.5
Let X be a separable locally compact metric space. Show that there
exists a sequence (Vn) of open subsets of X, each of which has compact
closure, with the property that for each x ‚ààX and each neighbour-
hood U of x there exists n such that x ‚ààVn ‚äÇU. Hence prove that
there exists a sequence (Un) of open subsets of X with the following
properties.
(i) Un is compact;
(ii) Un ‚äÇUn+1;
(iii) X = ‚àû
n=1 Un.
(Set U1 = V1 and Un+1 = Vn+1 ‚à™B(Un, r), where, using Exercise
(3.3.16: 4), r > 0 is chosen to make the closure of B(Un, r) compact.)
.6
Let X be a separable locally compact metric space that is not com-
pact, and let (Un) be as in the preceding exercise. Use Urysohn‚Äôs
Lemma (Exercise (3.2.14: 1)) to show that there exists a continuous
function f : X ‚ÜíR such that f(x) ‚â§n for all x ‚ààUn, and f(x) ‚â•n
for all x ‚ààX\Un. Then show that
d(x, y) = œÅ(x, y) + |f(x) ‚àíf(y)|
deÔ¨Ånes a metric d equivalent to œÅ, and that in the space (X, d) any
bounded set is contained in a compact set.

158
3. Analysis in Metric Spaces
3.4
Connectedness
In analysis there are many situations where progress is made by restrict-
ing attention to parts of a metric space that cannot be split into smaller,
separated parts. Our next deÔ¨Ånition captures this imprecise idea formally.
A metric space is said to be connected, or a connected space, if it can
not be expressed as a union of two disjoint nonempty open subsets. So
if X is connected, and if S, T are nonempty open subsets of X such that
S ‚à™T = X, then S ‚à©T Ã∏= ‚àÖ. A subspace that is connected is called a
connected set in the metric space. Clearly, the empty subset of any metric
space is connected.
(3.4.1) Proposition.
The following are equivalent conditions on a
metric space X.
(i) X is connected.
(ii) X is not a union of two disjoint nonempty closed subsets.
(iv) The only subsets of X that are both open and closed in X are X and
the empty subset.
Proof.
The straightforward proof is left as the next exercise.
2
(3.4.2) Exercises
.1
Prove Proposition (3.4.1).
.2
Prove that a metric space X is connected if and only if there is no
continuous mapping of X onto {0, 1} .
We showed in Proposition (1.3.13) that the only subsets of R that are
both open and closed are R and ‚àÖ. It follows from Proposition (3.4.1) that
R is connected. In fact, we can say more.
(3.4.3) Proposition.
A nonempty subset of R is connected if and only
if it is an interval.
Proof.
Let S be a nonempty subset of R, and suppose Ô¨Årst that S is
connected. Let a, b be points of S with a ‚â§b, and consider any x such that
a ‚â§x ‚â§b. If x /‚ààS, then S is the union of the disjoint subsets S ‚à©(‚àí‚àû, x)
and S ‚à©(x, ‚àû), each of which is open in S, by Proposition (3.1.5). This
contradicts the assumption that S is connected. So x ‚ààS, and therefore S
has the intermediate value property. Hence, by Proposition (1.3.3), S is an
interval.
Now let S be an interval in R, and suppose that S is not connected.
Then there exist nonempty open subsets A, B of the subspace S such that

3.4 Connectedness
159
S = A ‚à™B and A ‚à©B = ‚àÖ. We may assume that there exist a ‚ààA and
b ‚ààB such that a < b. Let x be the supremum of the nonempty bounded
set A ‚à©[a, b), and suppose that x ‚ààA. Then a ‚â§x < b, as b /‚ààA. Since A
is open in S, there exists r > 0 such that S ‚à©[x, x + r] ‚äÇA ‚à©[a, b). Being
an interval, S has the intermediate value property (Proposition (1.3.3)), so
[a, b] ‚äÇS, and therefore [x, x + r] ‚äÇS. Hence x + r ‚ààA ‚à©[a, b), which
contradicts the deÔ¨Ånition of x. Thus, in fact, x /‚ààA. A similar argument
shows that x /‚ààB, which is absurd since, as we have already observed,
[a, b] ‚äÇS. This contradiction shows that S is connected.
2
(3.4.4) Exercise
Let S, T be nonempty closed subsets of a metric space X such that
S ‚à™T and S ‚à©T are connected. Prove that S and T are connected.
Give an example to show that the conclusion no longer holds if we
remove the hypothesis that S and T are closed.
We now prove some general results about connected spaces.
(3.4.5) Proposition.
I f S, T are subsets of a metric space X such that
S is connected and S ‚äÇT ‚äÇS, then T is connected. In particular, S is
connected.
Proof.
Suppose that A, B are nonempty open sets in the subspace T such
that T = A ‚à™B and A ‚à©B = ‚àÖ. As S is dense in T, both S ‚à©A and S ‚à©B
are nonempty. They are clearly disjoint, and, by Proposition (3.1.5), they
are open in S. Since S = (S ‚à©A) ‚à™(S ‚à©B), we have contradicted the fact
that S is connected.
2
(3.4.6) Proposition.
If F is a family of connected sets in a metric space
X such that  F is nonempty, then  F is connected.
Proof.
Let S =  F and a ‚àà F. Suppose that S = A ‚à™B, where
A, B are nonempty disjoint open sets in S. Consider, for example, the case
where a ‚ààA. Choose F ‚ààF such that B ‚à©F is nonempty, and note that
a ‚ààA ‚à©F. Then A ‚à©F and B ‚à©F are open in F (by Proposition (3.1.5)),
have union F, are disjoint, and are nonempty. This contradicts the fact
that F is connected.
2
(3.4.7) Exercises
.1
Let S, T be connected subsets of a metric space X such that S ‚à©T
is nonempty. Prove that S ‚à™T is connected.
.2
Let (Sn) be a sequence of connected subsets of a metric space X such
that Sn ‚à©Sn+1 is nonempty for each n. Prove that  Sn is connected.

160
3. Analysis in Metric Spaces
.3
A metric space X is said to be chain connected if for each pair a, b
of points of X, and each Œµ > 0, there exist Ô¨Ånitely many points
a = x0, x1, . . . , xn = b such that œÅ(xi, xi+1) < Œµ for i = 0, . . . , n ‚àí1.
Prove that a compact, chain connected metric space is connected.
.4
If X is a metric space, then it follows from Proposition (3.4.6) that
for each x ‚ààX,
Cx =

{S ‚äÇX : S is connected and x ‚ààS}
is connected. Cx is called the connected component of x in X. Prove
the following statements.
(i) Cx is closed in X.
(ii) Cx is the largest connected subset of X that contains x.
(iii) If y ‚ààCx, then Cy = Cx.
(iv) If y /‚ààCx, then Cy ‚à©Cx = ‚àÖ.
.5
A subset S of a metric space X is said to be totally disconnected if
for each x ‚ààX the connected component of x in S is {x}. Prove that
(i) every countable subset of R is totally disconnected;
(ii) the irrational numbers form a totally disconnected set in R.
.6
A metric space X is said to be locally connected if for each x ‚ààX and
each neighbourhood U of X there exists a connected neighbourhood
V of x with V ‚äÇU. Prove that X is locally connected if and only if
the following property holds: for each open subset S of X, and each
x ‚ààS, the connected component of x in the subspace S is an open
subset of X.
.7
Use Proposition (3.4.3) and the previous exercise to give another
proof of Proposition (1.3.6).
.8
Let X be a connected space, and S a nonempty subset of X such that
X\S is also nonempty. Show that the boundary of S is nonempty.
(Suppose the contrary.)
(3.4.8) Proposition.
The range of a continuous mapping from a
connected metric space into a metric space is connected.
Proof.
Let X be a connected space, and f a continuous mapping of
X into a metric space Y . Suppose that f(X) = S ‚à™T, where S, T are
nonempty disjoint open sets in the subspace f(X) of Y . By Proposition

3.4 Connectedness
161
(3.2.2), the nonempty disjoint sets f ‚àí1(S) and f ‚àí1(T) are open in X.
Since
X = f ‚àí1 (f(X)) = f ‚àí1(S ‚à™T) = f ‚àí1(S) ‚à™f ‚àí1(T),
it follows that X is not connected, a contradiction.
2
A very important consequence of Proposition (3.4.8) is the following
generalised Intermediate Value Theorem.
(3.4.9) Theorem.
Let f be a continuous mapping of a connected metric
space X into R, and a, b points of f(X) such that a < b. Then for each
y ‚àà(a, b) there exists x ‚ààX such that f(x) = y.
Proof.
By Propositions (3.4.8) and (3.4.3), f(X) is an interval. The result
follows immediately.
2
(3.4.10) Exercises
.1
Let X be an unbounded connected metric space. Prove that for each
x ‚ààX and each r > 0 there exists y ‚ààX such that œÅ(x, y) = r.
.2
Let S be a connected subset of the Euclidean space Rn. Prove that
for each r > 0 the set
{x ‚ààRn : œÅ(x, S) ‚â§r}
is also connected.
.3
Let X be a compact metric space, and suppose that the closure of
any open ball B(a, r) in X is the closed ball B(a, r). Show that any
open or closed ball in X is connected. (Suppose that B(a, r) = S ‚à™T,
where S, T are nonempty, disjoint, and closed in the subspace B(a, r).
Without loss of generality take a in A. Show that
C = {x ‚ààX\S : œÅ(a, x) ‚â•œÅ(a, T)}
is compact, and hence that there exists t0 ‚ààT such that œÅ(a, t0) =
œÅ(a, T) > 0. Then consider B(a, œÅ(a, T)).)
Show by an example that we cannot remove the compactness of X
from the hypotheses of this result.
We now prove the partial converse to Corollary (3.3.13) that was
postponed from Section 3.
(3.4.11) Proposition.
Let X be a connected metric space such that ev-
ery continuous function from X to R is uniformly continuous. Then X is
compact.

162
3. Analysis in Metric Spaces
Proof.
Suppose that X is not totally bounded. By Exercise (3.3.8: 6),
there exist a sequence (xn) in X and a positive number Œ± such that
œÅ(xm, xn) ‚â•Œ± whenever m Ã∏= n. Using Exercise (3.3.8: 8), we can con-
struct, for each k, a uniformly continuous function œÜk : X ‚Üí[0, 1] such
that œÜk(xk) = 1, œÜk(x) = 0 if œÅ(x, xk) ‚â•Œ±/3, and f = ‚àû
n=1 nœÜn is a
well‚ÄìdeÔ¨Åned continuous function on X; to be precise, we set
œÜk(x) = max

0, 1 ‚àí3Œ±‚àí1œÅ(x, xk)

.
Our hypotheses ensure that f is uniformly continuous. Now, X is con-
nected, the mapping x ‚ÜíœÅ(x, xn) is continuous on X, œÅ(xn, xn) = 0, and
œÅ(xn+1, xn) ‚â•Œ±. It follows from Theorem (3.4.9) that there exists x ‚ààX
such that œÅ(x, xn) = Œ±/3n. Then
f(xn) ‚àíf(x) = n ‚àí(n ‚àí1) = 1.
Since n > 1 is arbitrary, f is not uniformly continuous. This contradiction
shows that X is totally bounded.
Now suppose that X is not complete; so there exists a Cauchy sequence
(xn) in X that does not converge to a limit in X. Without loss of generality
we may assume that X is a dense subset of its completion ( -
X, œÅ). So (xn)
converges to a limit x‚àû‚àà-
X\X. The function x ‚ÜíœÅ(x, x‚àû) is (uniformly)
continuous and positive‚Äìvalued on X, so
f(x) =
1
œÅ(x, x‚àû)
deÔ¨Ånes a continuous mapping f : X ‚ÜíR+. By our hypotheses, f is uni-
formly continuous on X, so there exists Œ¥ > 0 such that if x, y ‚ààX and
œÅ(x, y) < Œ¥, then |f(x) ‚àíf(y)| < 1. Choose N such that œÅ(xm, xn) < Œ¥ for
all n ‚â•N. Since œÅ(xN, x‚àû) > 0, there exist positive integers k, m such that
m > N and
œÅ(xm, x‚àû) <
1
k + 1 < 1
k < œÅ(xN, x‚àû).
Then œÅ(xm, xN) < Œ¥ but
f(xm) ‚àíf(xN) > (k + 1) ‚àík = 1,
contrary to our choice of Œ¥. Hence, in fact, X is complete and therefore, by
Theorem (3.3.9), compact.
2
There is another type of connectedness of importance in analysis and
topology, one that generalises the informal idea that a subset X of the
Euclidean plane is in one piece if any two points of X can be joined by
a path that lies wholly in X. (In spite of this correct claim about the
importance of this type of connectedness, we do not actually use it later in
the book; so you can ignore the rest of this section with impunity.)

3.4 Connectedness
163
Let X be a metric space. A continuous mapping f : [0, 1] ‚ÜíX such that
f(0) = a and f(1) = b is called a path in X with endpoints a and b, or a
path in X from a to b ; the path f is also said to join a to b. We say that X
is path connected, or a path connected space, if for each pair a, b of points
of X there is a path in X from a to b. By a path connected subset of X we
mean a subset of X that is path connected as a subspace of X.
A subset S of Rn is said to be convex if tx + (1 ‚àít)y ‚ààS whenever
x, y ‚ààS and 0 ‚â§t ‚â§1. A convex subset S of Rn is path connected: for if
a, b ‚ààS, then
f(t) = (1 ‚àít)a + tb
(0 ‚â§t ‚â§1)
deÔ¨Ånes a path in S from a to b. In particular, an interval in R is path
connected.
(3.4.12) Proposition.
A path connected space is connected.
Proof.
Let X be a path connected space; we may assume that X is
nonempty. Let a ‚ààX, and for each x ‚ààX let fx be a path in X joining a to
x; for convenience, let I = [0, 1]. Then fx(I) is connected, by Propositions
(3.4.3) and (3.4.8), and a ‚ààfx(I). Hence, by Proposition (3.4.6), X =

x‚ààX fx(I) is connected.
2
Propositions (3.4.3) and (3.4.12) show that path connectedness and con-
nectedness are equivalent properties of a nonempty subset S of R, and hold
precisely when S is an interval. In R2, however, there are subsets that are
connected but not path connected; see Exercise (3.4.16: 1). Our next result
is therefore substantial.
(3.4.13) Proposition.
A connected open subset of Rn is path connected.
In order to prove Proposition (3.4.13) we need some simple consequences
of the following Glueing Lemma.
(3.4.14) Lemma.
Let X, Y be metric spaces, and let A, B be closed sub-
sets of X whose union is X. Let f : A ‚ÜíY and g : B ‚ÜíY be continuous
functions such that f(x) = g(x) for all x ‚ààA ‚à©B. Then the function
h : X ‚ÜíY deÔ¨Åned by
h(x) =
Ô£±
Ô£≤
Ô£≥
f(x)
if x ‚ààA
g(x)
if x ‚ààB
is continuous.
Proof.
Let C be a closed subset of Y . Then, by Proposition (3.2.2),
f ‚àí1(C) is closed in the subspace A of X,and hence, by Exercise (3.1.6: 3),
in X. Similarly, g‚àí1(C) is closed in X. Hence
h‚àí1(C) = f ‚àí1(C) ‚à™g‚àí1(C)

164
3. Analysis in Metric Spaces
is closed in X. It follows from Proposition (3.2.2) that h is continuous.
2
Now consider two paths f, g in a metric space X such that f(1) = g(0).
We deÔ¨Åne the product of the paths f and g to be the path gf, where
gf(t) =
Ô£±
Ô£≤
Ô£≥
f(2t)
if 0 ‚â§t ‚â§1
2
g(2t ‚àí1)
if 1
2 ‚â§t ‚â§1.
It follows from Proposition (3.4.14) that gf is a path in X joining f(0) to
g(1).
The product gf of two paths must not be confused with the composite
g ‚ó¶f of two mappings. Indeed, unless f is a path in [0, 1], the composite of
the paths f and g is undeÔ¨Åned.
(3.4.15) Exercise
We deÔ¨Åne the path component of a point x in a metric space X to be
Px = {y ‚ààX : there exists a path in X from x to y}.
Prove that Px is the union of the path connected subsets of X that
contain x, and that it is the largest path connected subset of X
containing x. Prove also that if x, y ‚ààX, then either Px = Py or
Px ‚à©Py = ‚àÖ.
Proof of Proposition (3.4.13).
Let U be a connected open subset of
Rn. For each x in U let Ux be the path component of x in U; we Ô¨Årst show
that Ux is open in U. Given y in Ux, choose a path f in U joining x to y;
choose also r > 0 such that B(y, r) ‚äÇU. Since B(y, r) is convex, for each
z ‚ààB(y, r) there exists a path g in B(y, r) joining y to z; then gf is a path
in U joining x to z. Hence B(y, r) ‚äÇUx, ,and therefore Ux is open in U.
Now suppose that U is not path connected. Then there exist distinct
points of U that cannot be joined by a path in U. Let a be one of these
points. By the foregoing, Ua is nonempty and open in U, as is
V =

{Ux : x ‚ààU\Ua}.
Moreover, U = Ua ‚à™V . Since U is connected, Ua ‚à©V is nonempty, so
there exists b ‚ààU\Ua such that Ua ‚à©Ub Ã∏= ‚àÖ. Exercise (3.4.15) shows that
Ua = Ub; whence b ‚ààUa, a contradiction. Thus U is path connected.
2
(3.4.16) Exercises
.1
Let
A
=

(0, y) ‚ààR2 : ‚àí1 ‚â§y ‚â§1

,
B
=

(x, y) ‚ààR2 : 0 < x ‚â§1, y = sin œÄ
x

,

3.5 Product Metric Spaces
165
and X = A‚à™B. Prove that any connected subset of X that intersects
both A and B has diameter greater than 2. Then prove that X is not
path connected. (Suppose there exists a path f : [0, 1] ‚ÜíX with
f(0) ‚ààA and f(1) ‚ààB. Let
œÑ = sup {t ‚àà[0, 1] : f ([0, t]) ‚äÇA} ,
and show that there exists œÑ ‚Ä≤ > œÑ such that f(œÑ ‚Ä≤) ‚ààB and the
diameter of f ([œÑ, œÑ ‚Ä≤]) is less than 1.)
.2
Let F be a family of path connected subsets of a metric space X such
that  F Ã∏= ‚àÖ. Prove that  F is path connected.
.3
Let (Sn)‚àû
n=1 be a sequence of path connected subsets of a metric space
X such that for each n ‚â•1,
Sn ‚à©
n‚àí1

i=1
Si Ã∏= ‚àÖ.
Prove that ‚àû
n=1 Sn is path connected.
3.5
Product Metric Spaces
Let (X1, œÅ1) and (X2, œÅ2) be nonempty2 metric spaces, and X their Carte-
sian product X1 √ó X2. Throughout this section we use such notations as
x = (x1, x2), x‚Ä≤ = (x‚Ä≤
1, x‚Ä≤
2), and a = (a1, a2) for points of X; we write
Bk(ak, r) (respectively, Bk(ak, r)) for the open (respectively, closed) ball
in Xk with centre ak and radius r.
It is a simple exercise to show that the mapping œÅ : X √ó X ‚ÜíR deÔ¨Åned
by
œÅ(x, y) = max{œÅ1(x1, y1), œÅ2(x2, y2)}
is a metric‚Äîcalled the product metric‚Äîon X; taken with this metric, X
is called the product of the metric spaces X1 and X2. We assume that X
carries this metric in the remainder of this section.
There are at least two other natural metrics on the set X: namely, the
metrics œÅ‚Ä≤ and œÅ‚Ä≤‚Ä≤ deÔ¨Åned by
œÅ‚Ä≤(x, y) =

œÅ1(x1, y1)2 + œÅ2(x2, y2)2
and
œÅ‚Ä≤‚Ä≤(x, y) = œÅ1(x1, y1) + œÅ2(x2, y2).
2The requirement that X1 and X2 be nonempty enables us to avoid some
minor complications.

166
3. Analysis in Metric Spaces
Since
œÅ(x, y) ‚â§œÅ‚Ä≤(x, y) ‚â§œÅ‚Ä≤‚Ä≤(x, y) ‚â§2œÅ(x, y),
the identity mapping iX (see Exercise (3.2.1: 1)) is uniformly continuous
when its domain and range are given any of the metrics œÅ, œÅ‚Ä≤, œÅ‚Ä≤‚Ä≤. Hence,
in particular, each of these three metrics gives rise to the same topology
(family of open sets) on X; that is, the metrics are equivalent (see Exercise
(3.1.3: 6)).
(3.5.1) Lemma.
The open ball with centre a and radius r in the product
space X is B1(a1, r)√óB2(a2, r), and the closed ball with centre a and radius
r in X is B1(a1, r) √ó B2(a2, r).
Proof.
For example, we have
œÅ(a, x) < r
‚áî
max{œÅ1(a1, x1), œÅ2(a2, x2)} < r
‚áî
œÅ1(a1, x1) < r and œÅ2(a2, x2) < r,
so B(a, r) = B1(a1, r) √ó B2(a2, r).
2
(3.5.2) Proposition.
If A1 is open in X1, and A2 is open in X2, then
A1 √ó A2 is open in X.
Proof.
Let
a ‚ààA = A1 √ó A2.
Then a1 ‚ààA1 and a2 ‚ààA2; so there exist r1, r2 > 0 such that B1(a1, r1) ‚äÇ
A1 and B2(a2, r2) ‚äÇA2. Let r = min{r1, r2}; then by Lemma (3.5.1),
B(a, r) ‚äÇB1(a1, r1) √ó B2(a2, r2) ‚äÇA.
Hence a ‚ààA‚ó¶, and so A is open in X.
2
(3.5.3) Corollary.
If Uk is a neighbourhood of xk in Xk, then U1 √ó U2
is a neighbourhood of x in X.
Proof.
Choose an open set Ak in Xk such that xk ‚ààAk ‚äÇUk. Then
(x1, x2) ‚ààA1 √ó A2 ‚äÇU1 √ó U2,
where, by the previous proposition, A1 √ó A2 is an open subset of X.
2
The mapping prk : X ‚ÜíXk deÔ¨Åned by
prk(x1, x2) = xk
is called the projection of X onto Xk.

3.5 Product Metric Spaces
167
(3.5.4) Proposition.
If A is an open set in X, then prk(A) is open in
the space Xk.
Proof.
Consider any x1 ‚ààX1. Either
A(x1) = {x2 ‚ààX2 : (x1, x2) ‚ààA}
is empty and therefore open, or else there exists x2 ‚ààA(x1). In the latter
case, since A is open, we can choose r > 0 such that B(x, r) ‚äÇA, where
x = (x1, x2). If x‚Ä≤
2 ‚ààX2 and œÅ2(x2, x‚Ä≤
2) < r, then
œÅ(x, (x1, x‚Ä≤
2)) = œÅ2(x2, x‚Ä≤
2) < r,
so (x1, x‚Ä≤
2) ‚ààA. Hence A(x1) is open in this case also. Since
pr2(A) =

x1‚ààX1
A(x1),
a union of open sets, it follows that pr2(A) is open in X2. A similar
argument shows that pr1(A) is open in X1.
2
Note that the projections of a closed subset of X need not be closed; see
the remarks following the proof of Proposition (3.2.2) on page 137.
(3.5.5) Proposition.
If A1 ‚äÇX1 and A2 ‚äÇX2, then
A1 √ó A2 = A1 √ó A2.
Proof.
Let a ‚ààA1 √ó A2. Then for each Œµ > 0 there exist x1 ‚ààA1 and
x2 ‚ààA2 such that œÅ1(a1, x1) < Œµ and œÅ2(a2, x2) < Œµ; whence œÅ(a, x) < Œµ,
where
x = (x1, x2) ‚ààA1 √ó A2.
Thus A1 √ó A2 ‚äÇA1 √ó A2.
On the other hand, if a /‚ààA1 √ó A2, then either a1 /‚ààA1 or a2 /‚ààA2.
Taking, for example, the Ô¨Årst alternative, we see from Exercise (3.1.3: 3)
and Corollary (3.5.3) that the set (X1\A1) √ó X2, which is clearly disjoint
from A1 √ó A2, is a neighbourhood of a; thus a /‚ààA1 √ó A2. Hence
X\

A1 √ó A2
	
‚äÇX\A1 √ó A2,
so A1 √ó A2 ‚äÇA1 √ó A2, and therefore A1 √ó A2 = A1 √ó A2.
2
(3.5.6) Corollary.
A1 √ó A2 is closed in X if and only if Ak is closed
in Xk for each k.
Proof.
This follows immediately from the last proposition.
2

168
3. Analysis in Metric Spaces
A mapping f from a set E into X = X1 √ó X2 can be identiÔ¨Åed with the
ordered pair (pr1 ‚ó¶f, pr2 ‚ó¶f); where there is no risk of confusion, we write
fk for the mapping prk ‚ó¶f of E into Xk, so that f = (f1, f2).
(3.5.7) Proposition.
Let f be a mapping of a metric space (E, d) into
X. Then f is continuous at a ‚ààE if and only if both f1 and f2 are
continuous at a.
Proof.
Suppose that for each k, fk is continuous at ak. Given Œµ > 0,
choose Œ¥k > 0 such that if d(a, x) < Œ¥k, then œÅk(fk(a), fk(x)) < Œµ. If
d(a, x) < min {Œ¥1, Œ¥2} , then
œÅ(f(a), f(x)) = max {œÅ1(f1(a), f1(x)), œÅ2(f2(a), f2(x))} < Œµ.
Thus f is continuous at a.
To prove the converse, Ô¨Årst note that, trivially, prk is continuous on X;
so if f is continuous at a, then so is prk ‚ó¶f, by Proposition (3.2.3).
2
(3.5.8) Proposition.
Let f be a mapping of a metric space E into X.
Then f is uniformly continuous if and only if both f1 and f2 are uniformly
continuous.
Proof.
This is left as an exercise.
2
(3.5.9) Exercises
.1
Prove that if a mapping f of X into a metric space Y is continuous
at (a, b), then the mappings x1 ‚Üíf(x1, b) and x2 ‚Üíf(a, x2) are
continuous at a and b, respectively.
.2
Prove Proposition (3.5.8).
.3
Let E be a metric space, A ‚äÇE, and a ‚ààA\{a}. Prove that a
mapping f : E ‚ÜíX has a limit at a with respect to A if and only if
both b1 = limt‚Üía, t‚ààA f1(t) and b2 = limt‚Üía, t‚ààA f2(t) exist, in which
case limt‚Üía, t‚ààA f(t) = (b1, b2).
.4
Prove that a sequence (xn) in X converges to a limit in X if and
only if both Œæ1 = limn‚Üí‚àûpr1(xn) and Œæ2 = limn‚Üí‚àûpr2(xn) exist, in
which case limn‚Üí‚àûxn = (Œæ1, Œæ2).
.5
Prove that a sequence (xn) in X is a Cauchy sequence if and only
if (pr1(xn)) is a Cauchy sequence in X1 and (pr2(xn)) is a Cauchy
sequence in X2.

3.5 Product Metric Spaces
169
.6
For i = 1, 2 let Xi, Yi be metric spaces, and fi a mapping of Xi into
Yi. Prove that the mapping
(x1, x2) ‚Üí(f1(x1), f2(x2))
of X1 √ó X2 into Y1 √ó Y2 is continuous if and only if both f1 and f2
are continuous.
We have now reached the main result of this section.
(3.5.10) Proposition.
Let T be any one of the following types of metric
space: complete, totally bounded, compact. Then the product X = X1 √ó X2
of two nonempty metric spaces X1 and X2 is of type T if and only if both
X1 and X2 are of type T.
Proof.
Leaving the necessity of the stated conditions as an exercise, we
prove their suÔ¨Éciency. To this end, assume that X1 and X2 are com-
plete, and consider a Cauchy sequence (xn) in X. By Exercise (3.5.9: 5),
(prk(xn))‚àû
n=1 is a Cauchy sequence in Xk; since Xk is complete,
Œæk = lim
n‚Üí‚àûprk(xn)
exists. Reference to Exercise (3.5.9: 4) shows that (xn) converges to the
point (Œæ1, Œæ2) of X. Hence X is complete.
It is easy to see that if Œµ > 0 and Fk is a Ô¨Ånite Œµ‚Äìapproximation to Xk,
then F1 √óF2 is a Ô¨Ånite Œµ‚Äìapproximation to X. It follows that if X1 and X2
are totally bounded, so is X.
The Ô¨Årst two parts of the proof, and Theorem (3.3.9), show that if X1
and X2 are compact, then so is X.
2
(3.5.11) Exercises
.1
Prove that the product of two discrete metric spaces is discrete.
.2
In the notation of Proposition (3.5.10), prove that if X is of type T,
then so are X1 and X2.
.3
Prove that X is separable if and only if both X1 and X2 are separable.
.4
Prove that X is locally compact if and only if both X1 and X2 are
locally compact.
.5
Prove that X is connected (respectively, path connected) if and only
if both X1 and X2 are connected (respectively, path connected).
.6
Prove that a subset of the product space R2 or C2 is compact if and
only if it is closed and bounded.

170
3. Analysis in Metric Spaces
.7
Prove that the Euclidean spaces R2 and C2 are complete.
.8
Show that in the product space R2 the set
X = ({0} √ó [0, 1]) ‚à™([0, 1] √ó {0})
is compact, that every ball in X is connected, but that the closure
of an open ball in X need not be the corresponding closed ball (cf.
Exercise (3.4.10: 3)).
We deÔ¨Åne the product of a Ô¨Ånite family (X1, œÅ1), . . . , (Xn, œÅn) of metric
spaces to be the metric space (X, œÅ), where
X = X1 √ó ¬∑ ¬∑ ¬∑ √ó Xn
and
œÅ ((x1, . . . , xn), (y1, . . . , yn)) = max{œÅi(xi, yi) : i = 1, . . . , n}.
The results proved so far in this section extend in the obvious ways to
a product of more than two, but Ô¨Ånitely many, metric spaces. The Ô¨Ånal
set of exercises in this chapter shows how we can handle the product of a
sequence of metric spaces.
(3.5.12) Exercises
.1
Let ((Xn, œÅn))‚àû
n=1 be a sequence of nonempty metric spaces such that
diam(Xn) ‚â§1 for each n. Let X be the set of all sequences (xn)‚àû
n=1
such that xn ‚ààXn for each n, and deÔ¨Åne a mapping œÅ : X √ó X ‚ÜíR
by
œÅ ((xn), (yn)) =
‚àû

n=1
2‚àínœÅn(xn, yn).
Prove that œÅ is a metric on X.
The metric space (X, œÅ) is called the product of the sequence (Xn) of
metric spaces and is usually denoted by 2‚àû
n=1 Xn.
The next four exercises use the notation of Exercise (3.5.12: 1).
.2
Let x = (xn)‚àû
n=1 be a point of X. Prove that U ‚äÇX is a neighbour-
hood of x in X if and only if for some positive integer m and some
r > 0, U contains a set of the form
Um(x, r) = {(yn)‚àû
n=1 ‚ààX : œÅi(xi, yi) ‚â§r for 1 ‚â§i ‚â§m} .
.3
For each n let An be a subset of Xn. Prove that the closure of
2‚àû
n=1 An in X is 2‚àû
n=1 An.

3.5 Product Metric Spaces
171
.4
For each k let xk = (xk,n)‚àû
n=1 be a point of X. Prove that the sequence
(xk)‚àû
k=1 converges in X to a limit a = (an)‚àû
n=1 if and only if for each n
the sequence (xk,n)‚àû
k=1 converges to an in Xn. Prove also that (xk)‚àû
k=1
is a Cauchy sequence in X if and only if for each n the sequence
(xk,n)‚àû
k=1 is a Cauchy sequence in Xn.
.5
With T as in Proposition (3.5.10), prove that X is of type T if and
only if Xn is of type T for each n.
.6
Let (Xn)‚àû
n=1 be a sequence of discrete metric spaces, each having
positive diameter ‚â§1. Prove that the product space 2‚àû
n=1 Xn is not
discrete.

4
Analysis in Normed Linear Spaces
...I could be bounded in a nutshell, and
count myself a king of inÔ¨Ånite space...
hamlet, Act 2, Scene 2
Many signiÔ¨Åcant applications of analysis are the fruit of cross‚Äìfertilisation be-
tween metric structure and algebraic structure. In this chapter we discuss such
a cross‚Äìbreed: a normed (linear) space. Section 1 introduces these objects and
deals with their elementary analytic and geometric properties. In Section 2 we
discuss linear mappings between normed spaces, paying particular attention to
bounded linear functionals‚Äîcontinuous linear mappings into R and C. Although
many of the most important normed spaces of analysis are inÔ¨Ånite‚Äìdimensional,
Ô¨Ånite‚Äìdimensional ones remain signiÔ¨Åcant in many ways; they are dealt with in
Section 3. The next two sections deal with two fundamental classes of inÔ¨Ånite‚Äì
dimensional complete normed spaces: the Lp integration spaces and the space
C(X) of continuous functions from a compact metric space X into R. They also
characterise the associated bounded linear functionals. Two of the most impor-
tant results about C(X) ‚ÄîAscoli‚Äôs Theorem and the Stone‚ÄìWeierstrass Theo-
rem (a far‚Äìreaching generalisation of the classical Weierstrass Approximation
Theorem)‚Äîare proved in Sections 5 and 6. Both of these theorems reappear in
the Ô¨Ånal section of the chapter, where they are applied to the concrete classical
problem of solving ordinary diÔ¨Äerential equations.

174
4. Analysis in Normed Linear Spaces
4.1
Normed Linear Spaces
Metric spaces oÔ¨Äer one context within which the analytic and topological
properties of R can be generalised, but they do not provide a natural frame-
work for a generalisation of the algebraic properties of R. A framework of
the latter sort is made available by the notion of a normed linear space.
Let F stand for either R or C, and let X be a linear space (vector space)
over F. A norm on X is a mapping x ‚Üí‚à•x‚à•of X into R such that the
following properties hold for all x, y ‚ààX and Œª ‚ààF.
N1
‚à•x‚à•‚â•0.
N2
‚à•x‚à•= 0 if and only if x = 0.
N3
‚à•Œªx‚à•= |Œª| ‚à•x‚à•.
N4
‚à•x + y‚à•‚â§‚à•x‚à•+ ‚à•y‚à•
(triangle inequality).
A normed linear space, or normed space, over F is a pair (X, ‚à•¬∑‚à•) consisting
of a linear space X over F and a norm ‚à•¬∑‚à•on X; by abuse of language, we
refer to the linear space X itself as a normed space if it is clear from the
context which norm is under consideration. We say that the normed space
X is real or complex, depending on whether F is R or C. A vector with
norm 1 is called a unit vector.
The simplest example of a norm is, of course, the mapping x ‚Üí|x| on
F.
If X is a normed space, then the mapping (x, y) ‚Üí‚à•x ‚àíy‚à•of X √óX into
R is a metric on X (Exercise (4.1.1: 1)), and is said to be associated with
the norm on X. When we consider X as a metric space, it is understood
that we are referring to the metric associated with the given norm on X.
By the unit ball of X we mean the closed ball with centre 0 and radius 1,
B(0, 1) = {x ‚ààX : ‚à•x‚à•‚â§1} ,
relative to the metric associated with the norm on X.
(4.1.1) Exercises
.1
Prove that œÅ(x, y) = ‚à•x ‚àíy‚à•deÔ¨Ånes a metric on a normed space X,
such that
œÅ(x + z, y + z) = œÅ(x, y),
œÅ(Œªx, Œªy) = |Œª| œÅ(x, y)
for all x, y, z ‚ààX and Œª ‚ààF.

4.1 Normed Linear Spaces
175
.2
Show that
| ‚à•x‚à•‚àí‚à•y‚à•| ‚â§‚à•x ‚àíy‚à•
for all vectors x, y in a normed space X. Hence prove that if a sequence
(xn) converges to a limit x in X, then ‚à•x‚à•= limn‚Üí‚àû‚à•xn‚à•.
.3
Prove that
‚à•x‚à•= inf

|t|‚àí1 : t ‚ààF, t Ã∏= 0, ‚à•tx‚à•‚â§1

for each element x of a normed space X.
.4
Prove that for each positive integer n the mappings
(x1, . . . , xn) ‚Üímax {|x1| , . . . , |xn|} ,
(x1, . . . , xn) ‚Üí
3
x2
1 + ¬∑ ¬∑ ¬∑ + x2n,
(x1, . . . , xn) ‚Üí|x1| + ¬∑ ¬∑ ¬∑ + |xn|
are norms on Fn. In the case F = R the second of these norms is
called the Euclidean norm on Rn, and the associated metric is the
Euclidean metric (see Exercise (3.1.1: 5)).
.5
Let X be a nonempty set, and denote by B(X, F) the set of all
bounded mappings of X into F, taken with the pointwise operations
of addition and multiplication‚Äìby‚Äìscalars:
(f + g) (x) = f(x) + g(x),
(Œªf) (x) = Œªf(x).
The supremum norm, or sup norm, on B(X, F) is deÔ¨Åned by
‚à•f‚à•= sup {|f(x)| : x ‚ààX} .
Verify that the sup norm is a norm on B(X, F).
.6
Prove that ‚à•f‚à•1 =
%
|f| deÔ¨Ånes a norm on the set L1(R) of all
Lebesgue integrable functions (deÔ¨Åned almost everywhere) on R,
where two such functions are taken as equal if and only if they are
equal almost everywhere.
.7
Let X1, X2 be normed spaces over F, and recall that the standard
operations of addition and multiplication‚Äìby‚Äìscalars on the product
vector space X = X1 √ó X2 are given by
(x1, x2) + (x‚Ä≤
1, x‚Ä≤
2) = (x1 + x‚Ä≤
1, x2 + x‚Ä≤
2) ,
Œª (x1, x2) = (Œªx1, Œªx2) .

176
4. Analysis in Normed Linear Spaces
Verify that the mapping (x1, x2) ‚Üímax {‚à•x1‚à•, ‚à•x2‚à•} is a norm on
X, and that the metric associated with this norm is the product
metric on X (considered as the product of the metric spaces X1 and
X2).
Taken with this norm, which we call the product norm, X is known as
the product of the normed spaces X1 and X2. The product norm and
the product space for a Ô¨Ånite number of normed spaces are deÔ¨Åned
analogously.
(4.1.2) Proposition.
Let X be a normed space over F. Then
(i) the mapping (x, y) ‚Üíx + y is uniformly continuous on X √ó X;
(ii) for each Œª ‚ààF the mapping x ‚ÜíŒªx is uniformly continuous on X;
(iii) for each x ‚ààX the mapping Œª ‚ÜíŒªx is uniformly continuous on F;
(iv) the mapping (Œª, x) ‚ÜíŒªx is continuous on F √ó X.
Proof.
The uniform continuity of the Ô¨Årst three mappings follows from
the relations
‚à•(x + y) ‚àí(x‚Ä≤ + y‚Ä≤)‚à•‚â§‚à•x ‚àíx‚Ä≤‚à•+ ‚à•y ‚àíy‚Ä≤‚à•,
‚à•Œªx ‚àíŒªy‚à•= |Œª| ‚à•x ‚àíy‚à•,
‚à•Œªx ‚àíŒª‚Ä≤x‚à•= |Œª ‚àíŒª‚Ä≤| ‚à•x‚à•.
On the other hand, the relations
‚à•Œªx ‚àíŒª0x0‚à•= ‚à•Œª0(x ‚àíx0) + (Œª ‚àíŒª0)x0 + (Œª ‚àíŒª0)(x ‚àíx0)‚à•
‚â§|Œª0| ‚à•x ‚àíx0‚à•+ |Œª ‚àíŒª0| ‚à•x0‚à•+ |Œª ‚àíŒª0| ‚à•x ‚àíx0‚à•
easily lead to the continuity of (Œª, x) ‚ÜíŒªx at (Œª0, x0).
2
If X is a normed space and S is a linear subset of X, then the restriction
to S of the norm on X is a norm on S; taken with this norm, S is called a
normed linear subspace, or simply a subspace, of the normed space X.
(4.1.3) Proposition.
If S is a subspace of a normed space X, then the
closure of S in X is a subspace of X.
Proof.
Let f be the mapping (x, y) ‚Üíx + y of X √ó X into X. As S is a
subspace, f maps S √ó S into S, so
S √ó S ‚äÇf ‚àí1(S) ‚äÇf ‚àí1(S),

4.1 Normed Linear Spaces
177
and therefore S √ó S is a subset of the closure of f ‚àí1(S). Since, by Propo-
sition (4.1.2), f is continuous on X √ó X, it follows from Proposition
(3.2.2) that f ‚àí1(S) is a closed subset of X; whence S √ó S ‚äÇf ‚àí1(S). But
S √ó S = S√óS, by Proposition (3.5.5); so if x ‚ààS and y ‚ààS, then x+y ‚ààS.
A similar argument, using the continuity of the mapping (Œª, x) ‚ÜíŒªx, shows
that if Œª ‚ààF and x ‚ààS, then Œªx ‚ààS.
2
(4.1.4) Lemma.
If S is a closed subspace of a normed space X, and
a ‚ààX, then
a + S = {a + x : x ‚ààS}
is closed in X.
Proof.
Let f be the mapping z ‚Üíz ‚àía of X into itself. Since f is the
composition of the mappings z ‚Üí(z, ‚àía) and (x, y) ‚Üíx + y, it follows
from Exercise (3.5.9: 1), Proposition (4.1.2), and Proposition (3.2.3) that f
is continuous on X. But a + S = f ‚àí1(S); so, by Proposition (3.2.2), a + S
is closed in X.
2
(4.1.5) Exercises
.1
Explain why, in Proposition (4.1.2), the mapping (Œª, x) ‚ÜíŒªx is not
uniformly continuous on F √ó X.
.2
Complete the proof of Proposition (4.1.3).
.3
Let ( -
X, œÅ) be a metric space, and X a normed space such that
(i) œÅ(x, y) = ‚à•x ‚àíy‚à•for all x, y ‚ààX;
(ii) X is dense in -
X.
Show that the operations of addition and multiplication-by‚Äìscalars
can be extended uniquely to make -
X a normed space with associated
metric the given metric œÅ. (Use Propositions (4.1.2) and (3.2.12).)
.4
Let A and B be nonempty subsets of a normed space X, and deÔ¨Åne
A + B = {x + y : x ‚ààA, y ‚ààB} .
Prove that
(i) if A is open, then A + B is open;
(ii) if A is compact and B is closed, then A + B is closed.
Need A + B be closed when A and B are closed?

178
4. Analysis in Normed Linear Spaces
.5
Recall that a subset C of a linear space is said to be convex if tx +
(1 ‚àít)y ‚ààC whenever x, y ‚ààC and 0 ‚â§t ‚â§1. Prove that the closure
of a convex subset of a normed space is convex.
.6
Let C be a nonempty closed convex subset of a normed space X, x0 a
point of X\C, and r a positive number such that C‚à©B(x0, r) is empty.
Prove that C +B(0, r) is open and convex, and that x0 /‚ààC +B(0, r).
.7
Let C be a nonempty convex subset of Rn, and x0 a point of C\C.
Prove that each open ball with centre x0 intersects the complement
of C. (First consider the case where C has a nonempty interior.) Does
the conclusion hold if we drop the hypothesis that C is convex?
In a tribute to one of the founders of functional analysis, the Polish
mathematician Stefan Banach (1892‚Äì1945), a complete normed linear space
is called a Banach space. Among examples of Banach spaces are
‚Ä¢ Euclidean n‚Äìspace Rn (Exercise (4.1.1: 4));
‚Ä¢ B(X, F) where X is a nonempty set and the norm is the sup norm
(Exercise (4.1.1: 5));
‚Ä¢ certain spaces of continuous or integrable functions that we consider
in later sections of this chapter.
(4.1.6) Exercises
.1
Let c0 be the real vector space (with termwise algebraic operations)
consisting of all inÔ¨Ånite sequences x = (xn)‚àû
n=1 in R that converge to
0. For each x ‚ààc0 write
‚à•x‚à•= sup
n‚â•1
|xn|.
Prove that this deÔ¨Ånes a norm on c0 with respect to which c0 is
a separable Banach space. (For the second part, consider a Cauchy
sequence (xk)‚àû
k=1 in c0, where for each k, xk = (xk,n)‚àû
n=1. Show that
for each n, (xk,n)‚àû
k=1 is a Cauchy sequence in R. Denoting its limit by
Œæn, show that (Œæn)‚àû
n=1 belongs to c0 and is the limit of the sequence
(xk)‚àû
k=1 in the space c0.)
.2
Let l1 denote the space of all sequences of real numbers such that
the corresponding series is absolutely convergent, and for each x =
(xn)‚àû
n=1 ‚ààl1 write
‚à•x‚à•1 =
‚àû

n=1
|xn| .
Prove that this deÔ¨Ånes a norm on l1 with respect to which l1 is a
separable Banach space.

4.1 Normed Linear Spaces
179
.3
Let l‚àûdenote the space of all bounded sequences of real numbers,
and for each x = (xn)‚àû
n=1 ‚ààl‚àûwrite
‚à•x‚à•‚àû= sup
n‚â•1
|xn| .
Prove that this deÔ¨Ånes a norm on l‚àûwith respect to which l‚àûis a
Banach space.
.4
Prove that if X is a nonempty set, then B(X, F), taken with the
supremum norm, is a Banach space.
We now sketch how any normed space X can be embedded as a dense
subspace of a Banach space. DeÔ¨Åning
œÜx(y) = ‚à•x ‚àíy‚à•
(x, y ‚ààX),
Y = {œÜ0 + f : f ‚ààB(X, R)} ,
d(F, G) = sup {|F(x) ‚àíG(x)| : x ‚ààX}
(F, G ‚ààY ),
we recall from Exercise (3.2.10: 8) that (Y, d) is a complete metric space,
that x ‚ÜíœÜx is an isometric mapping of X onto a subset Z of Y, and that
the closure -
X of Z is a complete subspace of Y. We transport the algebraic
structure from X to Z by deÔ¨Åning
œÜx + œÜy = œÜx+y,
ŒªœÜx = œÜŒªx
for all x, y ‚ààX and Œª ‚ààF. Then
‚à•œÜx‚à•= d(œÜx, œÜ0) = ‚à•x‚à•
deÔ¨Ånes a norm on Z whose associated metric is the one induced by d.
Using Exercise (4.1.5: 3), we can extend the operations of addition and
multiplication‚Äìby‚Äìscalars uniquely from X (identiÔ¨Åed with its image under
the mapping x ‚ÜíœÜx) to -
X, thereby making -
X a Banach space in which
there is a dense linear subspace isometric and algebraically isomorphic to
X.
In practice, we normally forget about the mapping x ‚ÜíœÜx and regard
X simply as a dense subspace of -
X, which we call the completion of the
normed space X.
(4.1.7) Exercise
Fill in the details of the proof that the foregoing constructions provide
-
X with the structure of a Banach space and that x ‚ÜíœÜx is a norm‚Äì
preserving algebraic isomorphism of X with a dense subspace of -
X.

180
4. Analysis in Normed Linear Spaces
Banach spaces form the natural abstract context for the notion of con-
vergence of series. Given a sequence (xn) of elements of a normed space X,
we deÔ¨Åne the corresponding series ‚àû
n=1 xn to be the sequence (sn), where
sn = n
k=1 xk is the nth partial sum of the series. The series ‚àû
n=1 xn is
said to be
‚Ä¢ convergent if the sequence (sn) converges to a limit s in X, called the
sum of the series,
‚Ä¢ absolutely convergent if the series ‚àû
n=1 ‚à•xn‚à•is convergent in R,
‚Ä¢ unconditionally convergent if ‚àû
n=1 xf(n) converges for each permu-
tation f of N+.
In the Ô¨Årst case we write ‚àû
n=1 xn = s.
(4.1.8) Exercises
.1
Prove that a series ‚àû
n=1 xn in a Banach space X converges if and
only if for each Œµ > 0 there exists a positive integer N such that
‚à•j
n=i+1 xn‚à•< Œµ whenever j > i ‚â•N.
.2
Prove that an absolutely convergent series in a Banach space is
unconditionally convergent. (See Exercise (1.2.17: 1).)
.3
Let X be a normed linear space, and suppose that each absolutely
convergent series in X is convergent. Prove that X is a Banach space.
(Given a Cauchy sequence (xn) in X, choose n1 < n2 < ¬∑ ¬∑ ¬∑ such
that ‚à•xi ‚àíxj‚à•< 2‚àík for all i, j ‚â•nk. Then consider the series
‚àû
k=1

xnk+1 ‚àíxnk
	
.)
.4
In the Banach space c0 of Exercise (4.1.6: 1), for each positive integer
n let xn be the element with nth term 1/n and all other terms 0.
Prove that the series ‚àû
n=1 xn is unconditionally convergent but not
absolutely convergent.
Exercises (1.2.17: 1 and 2) show that a series in R is unconditionally
convergent if and only if it is absolutely convergent. Exercise (4.1.8: 4)
shows that this need not be true if R is replaced by an inÔ¨Ånite‚Äìdimensional
Banach space. In fact, if every unconditionally convergent series in a Banach
space X is absolutely convergent, then X is Ô¨Ånite‚Äìdimensional; this is the
Dvoretsky‚ÄìRogers Theorem (see [12], Chapter VI).
Let X be a normed space over F, and S a linear subspace of X. Then
x ‚àºy if and only if x ‚àíy ‚ààS

4.1 Normed Linear Spaces
181
deÔ¨Ånes an equivalence relation on X. The set of equivalence classes under
this relation is written X/S and is called the quotient space of X by S. The
canonical map œï of X onto X/S is deÔ¨Åned by
œï(x) = {x + s : s ‚ààS} ,
and maps each element of X to its equivalence class under ‚àº. We deÔ¨Åne
operations of addition and multiplication‚Äìby‚Äìscalars on X/S by
œï(x) + œï(y) = œï(x + y),
œï(Œªx) = Œªœï(x).
These deÔ¨Ånitions are sound: for if x ‚àºx‚Ä≤ and y ‚àºy‚Ä≤, then x + y ‚àºx‚Ä≤ + y‚Ä≤
and Œªx ‚àºŒªx‚Ä≤. If S is a closed linear subspace of X, then
‚à•œï(x)‚à•= œÅ (x, S) = inf {‚à•x ‚àís‚à•: s ‚ààS}
deÔ¨Ånes a norm, called the quotient norm, on X/S. In that case we assume
that X/S is equipped with the foregoing algebraic operations and with the
quotient norm.
(4.1.9) Exercises
.1
Verify the claims made without proof in the preceding paragraph.
.2
Prove that if S is closed in X, then the canonical map œï : X ‚ÜíX/S
is uniformly continuous on S.
(4.1.10) Proposition.
If S is a closed linear subspace of a Banach space
X, then the quotient space X/S is a Banach space.
Proof.
Let œï be the canonical map of X onto X/S, and consider a se-
quence (xn) in X such that (œï(xn)) is a Cauchy sequence in X/S. Choose
a strictly increasing sequence (nk)‚àû
k=1 of positive integers such that
44œï(xnk+1) ‚àíœï(xnk)
44 < 2‚àík
(k ‚â•1).
Setting s1 = 0, we construct inductively a sequence (sk) in S such that for
each k,
44(xnk+1 ‚àísk+1) ‚àí(xnk ‚àísk)
44 < 2‚àík.
(1)
Indeed, having constructed elements s1, . . . , sk of S with the applicable
properties, we have
inf
44xnk+1 ‚àí(xnk ‚àísk) ‚àís
44 : s ‚ààS

= inf
44xnk+1 ‚àíxnk ‚àís
44 : s ‚ààS

=
44œï(xnk+1 ‚àíxnk)
44
=
44œï(xnk+1) ‚àíœï(xnk)
44 < 2‚àík,

182
4. Analysis in Normed Linear Spaces
so there exists sk+1 ‚ààS such that (1) holds.
We now see from (1) that (xnk ‚àísk)‚àû
k=1 is a Cauchy sequence in the
Banach space X; whence it converges to a limit z in X. By Exercise
(4.1.9: 2),
œï(xnk) = œï(xnk) ‚àíœï(sk) = œï(xnk ‚àísk) ‚Üíœï(z) as k ‚Üí‚àû.
Thus the Cauchy sequence (œï(xn)) has a convergent subsequence. It follows
from Exercise (3.2.10: 3) that (œï(xn)) itself converges in X\S.
2
4.2
Linear Mappings and Hyperplanes
In the context of normed spaces, the important mappings are not just
continuous but also preserve the algebraic structure.
Recall that a mapping u between vector spaces X, Y is linear if
u(x + y) = u(x) + u(y)
and
u(Œªx) = Œªu(x)
whenever x, y ‚ààX and Œª ‚ààF. If Y = F, then u is called a linear functional
on X. Examples of linear mappings are
‚Ä¢ the mapping x ‚ÜíAx on Fn, where A is an n‚Äìby‚Äìn matrix over F;
‚Ä¢ the Lebesgue integral, regarded as a mapping of L1(R) into R (see
Exercise (4.1.1: 6));
‚Ä¢ the mapping (xn)‚àû
n=1 ‚Üíx1 of c0 into R (see Exercise (4.1.6: 1));
‚Ä¢ the canonical mapping of a normed space X onto the quotient space
X/S, where S is a closed subspace of X;
‚Ä¢ the mapping x ‚ÜíœÜx of a normed space onto a dense subspace of its
completion (see page 179).
Here is the fundamental result about the continuity of linear mappings
between normed spaces.
(4.2.1) Theorem.
The following are equivalent conditions on a linear
mapping of a normed space X into a normed space Y.
(i) u is continuous at 0.
(ii) u is continuous on X.
(iii) u is uniformly continuous on X.

4.2 Linear Mappings and Hyperplanes
183
(iv) u is bounded on the unit ball of X.
(v) u is bounded on each bounded subset of X.
(vi) There exists a positive number c, called a bound for u, such that
‚à•u(x)‚à•‚â§c ‚à•x‚à•for all x ‚ààX.
Proof.
Suppose that u is continuous at 0. Then there exists r > 0 such
that
‚à•u(x)‚à•= ‚à•u(x) ‚àíu(0)‚à•‚â§1
whenever ‚à•x‚à•‚â§r. For each nonzero t ‚ààF with ‚à•tx‚à•‚â§1 we have ‚à•rtx‚à•‚â§r
and therefore
‚à•u(x)‚à•= r‚àí1 |t|‚àí1 ‚à•u(rtx)‚à•‚â§r‚àí1 |t|‚àí1 .
It follows from Exercise (4.1.1: 3) that ‚à•u(x)‚à•‚â§r‚àí1 ‚à•x‚à•for all x ‚ààX.
Hence (i) implies (vi).
It is clear that (vi) ‚áí(v) ‚áí(iv). Next, suppose that there exists c > 0
such that ‚à•u(x)‚à•‚â§c whenever ‚à•x‚à•‚â§1. Since
‚à•u(x)‚à•= ‚à•x‚à•
444u

‚à•x‚à•‚àí1 x
444 ‚â§c ‚à•x‚à•
(x Ã∏= 0)
and u(0) = 0, we see that (vi) holds, with c a bound for u. We now have
‚à•u(x ‚àíy)‚à•‚â§c ‚à•x ‚àíy‚à•
(x, y ‚ààX) ,
from which it follows that u is uniformly continuous on X. Thus (iv) ‚áí
(vi) ‚áí(iii).
Finally, it is obvious that (iii) ‚áí(ii) ‚áí(i).
2
In view of property (v) of Proposition (4.2.1), we commonly refer to a
continuous linear mapping between normed spaces X, Y as a bounded linear
mapping on X. We deÔ¨Åne the norm of such a mapping by
‚à•u‚à•= sup {‚à•u(x)‚à•: x ‚ààX, ‚à•x‚à•‚â§1} .
(1)
The argument used to prove that (iv) ‚áí(vi) in the last proof shows that
‚à•u(x)‚à•‚â§‚à•u‚à•‚à•x‚à•
(x ‚ààX).
In Exercise (4.2.2: 11) you will prove that equation (1) deÔ¨Ånes a norm on
the linear space L(X, Y ) of all bounded linear mappings u : X ‚ÜíY, and
that if Y is a Banach space, then so is L(X, Y ). The Banach space L(X, F),
consisting of all bounded linear functionals from X into its ground Ô¨Åeld F,
is called the dual space, or simply the dual, of X, and is denoted by X‚àó. The
interplay between a Banach space and its dual is one of the most signiÔ¨Åcant

184
4. Analysis in Normed Linear Spaces
themes of functional analysis, so we spend some time later in this chapter
and in Chapter 6 identifying the duals of certain important Banach spaces.
Two norms ‚à•¬∑‚à•, ‚à•¬∑‚à•‚Ä≤ on a vector space X are said to be equivalent if
both the identity mapping from (X, ‚à•¬∑‚à•) onto (X, ‚à•¬∑‚à•‚Ä≤) and its inverse are
continuous; since those mappings are linear, it follows from Proposition
(4.2.1) that ‚à•¬∑‚à•and ‚à•¬∑‚à•‚Ä≤ are equivalent norms on X if and only if there
exist positive constants a, b such that a ‚à•x‚à•‚â§‚à•x‚à•‚Ä≤ ‚â§b ‚à•x‚à•for all x ‚ààX.
(4.2.2) Exercises
.1
Prove that a linear mapping u : X ‚ÜíY between normed spaces is
bounded if and only if there exists c > 0 such that ‚à•u(x)‚à•‚â§c for all
x ‚ààX with ‚à•x‚à•= 1, and that we then have
‚à•u‚à•= sup {‚à•u(x)‚à•: x ‚ààX, ‚à•x‚à•= 1} .
.2
Let u be a bounded linear mapping on a normed space X. Prove that
‚à•u‚à•= inf {c ‚â•0 : ‚à•u(x)‚à•‚â§c ‚à•x‚à•for all x ‚ààX} .
.3
Show that any two of the three norms on Rn introduced in Exercise
(4.1.1: 4) are equivalent.
.4
Let ‚à•¬∑‚à•, ‚à•¬∑‚à•‚Ä≤ be equivalent norms on a linear space X. Prove that if
X is complete with respect to ‚à•¬∑‚à•, then it is complete with respect
to ‚à•¬∑‚à•‚Ä≤ .
.5
Let X1, . . . , Xn be normed spaces, X = X1 √ó ¬∑ ¬∑ ¬∑ √ó Xn, and Y a
normed space. Let u be a multilinear mapping of X into Y ‚Äîthat is,
a mapping linear in each of its n variables. Prove that u is continuous
if and only if there exists a constant c > 0 (which we call a bound for
u) such that
‚à•u(x1, . . . , xn)‚à•‚â§c ‚à•x1‚à•‚à•x2‚à•¬∑ ¬∑ ¬∑ ‚à•xn‚à•
for all (x1, . . . , xn) ‚ààX.
.6
Let X, Y be normed spaces, and u : X ‚ÜíY a linear mapping such
that for each sequence (xn) in X converging to 0, the sequence (u(xn))
is bounded in Y . Prove that u is continuous. (Let (xn) be a sequence
converging to 0 in X, reduce to the case where ‚à•xn‚à•< 1/n2 for each
n, and then consider the sequence (nxn).)
.7
Prove that a linear mapping u : X ‚ÜíY between normed spaces is
bounded if and only if for each Cauchy sequence (xn) in X, (u(xn))
is a Cauchy sequence in Y.

4.2 Linear Mappings and Hyperplanes
185
.8
Let u be a continuous linear mapping of a normed space X into a
Banach space Y , and let ‚àû
n=1 xn be an absolutely convergent series
in X. Prove that the series ‚àû
n=1 u(xn) converges absolutely in Y.
.9
Recalling the Banach space l1 of Exercise (4.1.6: 2), for each n let en
be the element of l1 with nth term 1 and all other terms 0. Show
that to each bounded sequence (xn) in a Banach space X there cor-
responds a unique bounded linear mapping u : l1 ‚ÜíX such that
u(en) = xn for each n.
Now let X be a separable Banach space, and (xn) a dense sequence in
the unit ball B of X. DeÔ¨Åne the bounded linear mapping u : l1 ‚ÜíX
as previously. Prove that u maps l1 onto X. (Given x ‚ààB, construct
inductively n1 < n2 < ¬∑ ¬∑ ¬∑ such that
444444
2k‚àí1(x ‚àíxn1) ‚àí
k

j=2
2k‚àíjxnj
444444
< 2‚àík
for each k.)
Thus every separable Banach space is the range of a bounded linear
mapping on l1. For further results of this type see [12].
.10 Let D be a dense linear subspace of a normed space X, and u a
bounded linear mapping from D into a normed space Y. Prove that
u extends to a bounded linear mapping, with the same norm, from
X into Y. (First use Proposition (3.2.12).)
.11 Prove that if X, Y are normed spaces, then
‚à•u‚à•= sup{‚à•u(x)‚à•: x ‚ààX, ‚à•x‚à•‚â§1}
deÔ¨Ånes a norm on L(X, Y ), and that if Y is complete, then L(X, Y )
is a Banach space with respect to this norm. (To establish the com-
pleteness, let (un) be a Cauchy sequence in L(X, Y ), and show
that
u(x) = lim
n‚Üí‚àûun(x)
deÔ¨Ånes an element u of L(X, Y ) such that ‚à•u ‚àíun‚à•‚Üí0 as n ‚Üí‚àû.)
.12 Let c0 be the Banach space of Exercise (4.1.6: 1). For each positive
integer n let en be the sequence whose nth term is 1 and which has
all other terms equal to 0. Let u be a bounded linear functional on c0.
Prove that the series ‚àû
n=1 u(en) is absolutely convergent, and that
the norm of u is ‚àû
n=1 |u(en)|. Conversely, prove that if ‚àû
n=1 tn is an
absolutely convergent series of real numbers, then there is a unique
bounded linear functional u on c0 such that u(en) = tn for each n.
Describe u(x), where x = (xn)‚àû
n=1 ‚ààc0.

186
4. Analysis in Normed Linear Spaces
This example shows that the dual space c‚àó
0 can be identiÔ¨Åed with the
Banach space l1 of Exercise (4.1.6: 2).
.13 Prove that l‚àó
1 can be identiÔ¨Åed with the Banach space l‚àûof Exercise
(4.1.6: 3).
.14 Prove the Uniform Boundedness Theorem: let (Ti)i‚ààI be a family
of bounded linear mappings from a Banach space X into a normed
space Y, such that {‚à•Tix‚à•: i ‚ààI} is bounded for each x ‚ààX; then
{‚à•Ti‚à•: i ‚ààI} is bounded. (Suppose the contrary. Then construct
sequences (xn)‚àû
n=1 in X and (in)‚àû
n=1 in I such that for each n,
‚à•xn‚à•= 4‚àín,
‚à•Tinxn‚à•> 2
3 ‚à•Tin‚à•‚à•xn‚à•,
and
‚à•Tin‚à•> 3 √ó 4n

n + sup
i‚ààI
{‚à•Ti (x1 + ¬∑ ¬∑ ¬∑ + xn‚àí1)‚à•}

.
Taking x = ‚àû
n=1 xn, deduce the contradiction that ‚à•Tinx‚à•> n for
each n.
This proof was published in [22]. A less elementary, but more stan-
dard, approach to the Uniform Boundedness Theorem is based on
Baire‚Äôs Theorem (6.3.1) and is discussed in Chapter 6.)
.15 A normed space X is said to be uniformly convex if it has the following
property: for each Œµ > 0 there exists Œ¥ ‚àà(0, 1) such that ‚à•x ‚àíy‚à•< Œµ
whenever ‚à•x‚à•‚â§1, ‚à•y‚à•‚â§1, and
44 1
2 (x + y)
44 > 1 ‚àíŒ¥. Prove that if u
is a bounded linear functional on a uniformly convex Banach space
X, then there exists a unit vector x ‚ààX such that |u(x)| = ‚à•u‚à•.
Recall that the kernel, or null space, of a linear mapping u : X ‚ÜíY
between vector spaces is the subspace
ker(u) = u‚àí1(0) = {x ‚ààX : u(x) = 0}
of X. We say that u is nonzero if ker(u) Ã∏= X‚Äîthat is, if there exists x ‚ààX
such that u(x) Ã∏= 0; otherwise, u is said to be zero.
(4.2.3) Proposition.
A linear functional on a normed space X is
continuous if and only if its kernel is closed in X.
Proof.
Let u be a linear functional on X, and S = ker(u). As {0} is a
closed subset of X, Proposition (3.2.2) shows that if u is continuous, then
S is closed in X. Suppose, conversely, that S is closed in X. Since the zero

4.2 Linear Mappings and Hyperplanes
187
linear functional is certainly continuous, we may assume that there exists
a ‚ààX such that u(a) = 1. Then 0 /‚ààa + S. On the other hand, by Lemma
(4.1.4), a + S is closed in X, so its complement is open. Hence there exists
r > 0 such that x /‚ààa + S whenever ‚à•x‚à•‚â§r. Suppose that ‚à•x‚à•‚â§r and
|u(x)| > 1, and let y = u(x)‚àí1x. Then ‚à•y‚à•‚â§r, so y /‚ààa + S. On the other
hand,
u(y ‚àía) = u(x)‚àí1u(x) ‚àí1 = 0,
so y ‚àía ‚ààS, and therefore
y = a + (y ‚àía) ‚ààa + S.
This contradiction shows that |u(x)| ‚â§1 whenever ‚à•x‚à•‚â§r. It follows from
Proposition (4.2.1) that u is continuous.
2
As we show in a moment, nonzero linear functionals on a normed space
X are associated with certain subspaces of X which we now deÔ¨Åne.
A subspace H of a vector space X is called a hyperplane if
‚Äî X\H is nonempty, and
‚Äî for each a ‚ààX\H and each x ‚ààX there exists a unique pair (t, y) ‚àà
F √ó H such that x = ta + y.
This expression of the element x is called its representation relative to the
pair (H, a) consisting of the hyperplane H and the element a of X\H.
(4.2.4) Proposition.
The kernel of a nonzero linear functional on a
normed space X is a hyperplane in X. Conversely, if H is a hyperplane
in X and a /‚ààH, then there exists a unique linear functional u on X such
that ker(u) = H and u(a) = 1.
Proof.
First let u be a nonzero linear functional on X. If a /‚ààker(u) and
x ‚ààX, then, using the linearity of u, we easily verify that x = ta + y,
with t ‚ààF and y ‚ààker(u), if and only if t = u(x)/u(a). Hence ker(u) is a
hyperplane.
Conversely, let H be a hyperplane in X, and let a /‚ààH. For each x ‚ààX
there exists a unique pair (t, y) in F√óH such that x = ta + y. Setting
u(x) = t and f(x) = y, we deÔ¨Åne functions u : X ‚ÜíF and f : X ‚ÜíH. If
also x‚Ä≤ ‚ààX, then
x + x‚Ä≤ = (u(x) + u(x‚Ä≤)) a + f(x) + f(x‚Ä≤),
where u(x)+u(x‚Ä≤) ‚ààF and (as H is a linear subset of X) f(x)+f(x‚Ä≤) ‚ààH;
the uniqueness of the representation of a given element of X relative to
(H, a) ensures that u(x+x‚Ä≤) = u(x)+u(x‚Ä≤). Similar uniqueness arguments
show that u(Œªx) = Œªu(x) whenever Œª ‚ààF and x ‚ààX, and that u(a) = 1. In

188
4. Analysis in Normed Linear Spaces
particular, it follows that u is a linear functional on X. Moreover, u(x) = 0
if and only if x = f(x) ‚ààH; so ker(u) = H. It remains to prove that u
is the unique linear functional on X which takes the value 1 at a and has
kernel H. But if v is another such linear functional on X, then for each
x ‚ààX we have
v(x) = v (u(x)a + f(x))
= u(x)v(a) + v(f(x))
= u(x) 1 + 0
= u(x).
2
(4.2.5) Exercises
.1
Let H be a hyperplane in a normed space X, a ‚ààX\H, and Œ± ‚ààR.
Prove that there exists a unique linear functional u on X such that
a + H = {x ‚ààX : u(x) = Œ±} .
.2
Let u be a nonzero bounded linear functional on a normed space X,
and H = ker(u). Show that œÅ(x, H) = ‚à•u‚à•‚àí1 |u(x)| for each x ‚ààX.
.3
A translated hyperplane1 in a normed space X is a subset of the
form v + H where H is a hyperplane in X and v ‚ààX. Prove that
a translated hyperplane is closed if and only if its complement has a
nonempty interior.
.4
Let K be a subset of a normed space X, and u a linear functional on
X. For each Œ± ‚ààR the translated hyperplane
HŒ± = {x ‚ààX : u(x) = Œ±}
is called a hyperplane of support for K if
‚Äî there exists x0 ‚ààK such that u(x0) = Œ±, and
‚Äî either u(x) ‚â•Œ± for all x ‚ààK or u(x) ‚â§Œ± for all x ‚ààK.
Prove that if K is compact and is not contained in any HŒ±, then for
exactly two real numbers Œ±, HŒ± is a hyperplane of support for K.
(Consider the set

t ‚ààR : u‚àí1(t) ‚à©K Ã∏= ‚àÖ

.)
1Some authors use the term ‚Äúhyperplane‚Äù for a translated hyperplane.

4.3 Finite‚ÄìDimensional Normed Spaces
189
4.3
Finite‚ÄìDimensional Normed Spaces
Before studying some of the more important inÔ¨Ånite‚Äìdimensional spaces
in analysis, we devote a section to the major analytic properties of Ô¨Ånite‚Äì
dimensional spaces. We begin by showing that for any positive integer n,
any normed space of dimension n over F can be identiÔ¨Åed with the product
space Fn.
(4.3.1) Proposition.
If X is an n‚Äìdimensional normed space with basis
{e1, . . . , en}, then
(Œæ1, . . . , Œæn) ‚Üí
n

i=1
Œæiei
is a one‚Äìone bounded linear mapping of the product space Fn onto X with
a bounded linear inverse.
Proof.
Let f denote the mapping in question. It is easy to verify that f
is one‚Äìone and maps Fn onto X, and that both f and f ‚àí1 are linear. Let
c = max
1‚â§i‚â§n ‚à•ei‚à•.
The inequalities
44444
n

i=1
Œæiei
44444 ‚â§
n

i=1
|Œæi| ‚à•ei‚à•‚â§c
n

i=1
|Œæi| ‚â§nc max
1‚â§i‚â§n |Œæi|
show that f is bounded and therefore continuous. Let
S =
*
(Œæ1, . . . , Œæn) ‚ààFn : max
1‚â§i‚â§n |Œæi| = 1
+
.
Then S is closed (Exercise (4.3.2: 1)) and bounded, and is therefore compact
(see Exercise (3.5.11: 6)). Now, the mapping Œæ ‚Üí‚à•f(Œæ)‚à•is continuous and
(as {e1, . . . , en} is a basis) maps S into R+; so, by Exercise (3.3.7: 2),
0 < r = inf {‚à•f(Œæ)‚à•: Œæ ‚ààS} .
If Œæ is any nonzero element of Fn, then, setting Œ∑ = ‚à•Œæ‚à•‚àí1 Œæ, we have Œ∑ ‚ààS
and therefore
r ‚â§‚à•f(Œ∑)‚à•= ‚à•Œæ‚à•‚àí1 ‚à•f(Œæ)‚à•.
Hence ‚à•Œæ‚à•‚â§r‚àí1 ‚à•f(Œæ)‚à•. Since this holds trivially when Œæ = 0, we see that
r‚àí1 is a bound for the linear mapping f ‚àí1.
2
(4.3.2) Exercises
.1
Prove that the set S in the preceding proof is closed.

190
4. Analysis in Normed Linear Spaces
.2
Show that if X is n‚Äìdimensional with basis {e1, . . . , en}, then the
mapping
n

i=1
Œæiei ‚Üímax
1‚â§i‚â§n |Œæi|
is a norm on X, and that X is complete with respect to this norm.
.3
Find an alternative proof that the mapping f ‚àí1 in the proof of
Proposition (4.3.1) is continuous.
.4
Prove that any linear mapping from a Ô¨Ånite‚Äìdimensional normed
space into a normed space is bounded. Hence prove that any two
norms on a given Ô¨Ånite‚Äìdimensional linear space are equivalent.
(4.3.3) Proposition.
A Ô¨Ånite‚Äìdimensional normed space is complete.
Proof.
Let X be a Ô¨Ånite‚Äìdimensional normed space. We may assume that
X Ã∏= {0}, so that X has a basis {e1, . . . ,en}. Let f be the mapping in Propo-
sition (4.3.1), and let (xn) be a Cauchy sequence in X. Then

f ‚àí1(xn)
	
is
a Cauchy sequence in Fn and therefore (see Exercise (3.5.11: 7)), converges
to a limit y ‚ààFn. Since f is continuous, (xn) converges to f(y) ‚ààX.
2
(4.3.4) Corollary.
A Ô¨Ånite‚Äìdimensional subspace of a normed space X
is closed in X.
Proof.
This is an immediate consequence of Propositions (4.3.3) and
(3.2.9).
2
Our next result is surprisingly useful. We use it to simplify the proof of
Theorem (4.3.6).
(4.3.5) Riesz‚Äôs Lemma.
Let S be a closed subspace with a nonempty
complement in a normed space X, and let 0 < Œ∏ < 1. Then there exists a
unit vector x ‚ààX such that ‚à•x ‚àíy‚à•> Œ∏ for each y ‚ààS.
Proof.
Fix x0 ‚ààX\S. By Exercise (3.1.10: 3),
0 < r = œÅ(x0, S) < Œ∏‚àí1r.
Choosing s0 ‚ààS such that
r ‚â§‚à•x0 ‚àís0‚à•< Œ∏‚àí1r,
let
x = ‚à•x0 ‚àís0‚à•‚àí1 (x0 ‚àís0).

4.3 Finite‚ÄìDimensional Normed Spaces
191
Then ‚à•x‚à•= 1. Also, for each s ‚ààS,
s0 + ‚à•x0 ‚àís0‚à•s ‚ààS,
so
‚à•x0 ‚àís0‚à•‚à•x ‚àís‚à•= ‚à•x0 ‚àí(s0 + ‚à•x0 ‚àís0‚à•s)‚à•‚â•œÅ(x0, S) = r,
and therefore
‚à•x ‚àís‚à•‚â•
r
‚à•x0 ‚àís0‚à•> Œ∏.
2
It follows from Riesz‚Äôs Lemma that in an inÔ¨Ånite‚Äìdimensional normed
space X, if 0 < Œ∏ < 1, then there exists a sequence (xn) of unit vectors such
that ‚à•xm ‚àíxn‚à•> Œ∏ whenever m Ã∏= n (see Exercise (4.3.7: 4)). This result
can be improved in various ways. For example, in Chapter 6 we prove that
in any inÔ¨Ånite‚Äìdimensional normed space there exists a sequence (xn) of
unit vectors such that ‚à•xm ‚àíxn‚à•> 1 whenever m Ã∏= n. A much deeper
result, due to Elton and Odell, says that if X is an inÔ¨Ånite‚Äìdimensional
normed space, then there exist Œµ > 0 and a sequence (xn) of unit vectors
in X such that ‚à•xm ‚àíxn‚à•‚â•1 + Œµ whenever m Ã∏= n; see Chapter XIV of
[12].
We now use Riesz‚Äôs Lemma to provide a topological characterisation of
Ô¨Ånite‚Äìdimensional normed spaces.
(4.3.6) Theorem.
A normed space is Ô¨Ånite‚Äìdimensional if and only if
its unit ball is totally bounded, in which case that ball is compact.
Proof.
For simplicity, we take the case F = R. Let X be a normed space,
and B its (closed) unit ball; we may assume that X Ã∏= {0}. Suppose that
X is Ô¨Ånite‚Äìdimensional with basis {e1, . . . , en}, and let u be the one‚Äìone
linear mapping n
i=1 Œæiei ‚Üí(Œæ1, . . . , Œæn) of X onto the product metric
space Rn. By Propositions (4.3.1) and (4.2.1), there exists R > 0 such that
if ‚à•n
i=1 Œæiei‚à•‚â§1, then
‚à•(Œæ1, . . . , Œæn)‚à•= max
1‚â§i‚â§n |Œæi| ‚â§R.
(1)
By the Heine‚ÄìBorel‚ÄìLebesgue Theorem (1.4.6) and Proposition (3.5.10),
[‚àíR,R]n is a compact subset of Rn; it follows from Propositions (4.3.1)
and (3.3.6) that u‚àí1([‚àíR,R]n) is a compact subset of X. Since B is closed
and, by (1), a subset of u‚àí1([‚àíR,R]n), we see from Proposition (3.3.4) that
B is compact.
Assume, conversely, that B is totally bounded. Construct a Ô¨Ånite
1
2‚Äì
approximation F to B, let S be the Ô¨Ånite‚Äìdimensional subspace of X gen-
erated by F, and suppose that X Ã∏= S. Then, by Riesz‚Äôs Lemma (4.3.5),

192
4. Analysis in Normed Linear Spaces
there exists a unit vector x ‚ààX such that ‚à•x ‚àís‚à•> 1
2 for all s ‚ààS; but
this is absurd, as ‚à•x ‚àís‚à•< 1
2 for some s ‚ààF. Hence, in fact, X = S.
2
(4.3.7) Exercises
.1
Show that if a normed space X contains a totally bounded ball, then
every closed ball in X is compact.
.2
Prove that a normed space X is Ô¨Ånite‚Äìdimensional if and only if
{x ‚ààX : ‚à•x‚à•= 1} is compact.
.3
Prove that a normed space is locally compact if and only if it is
Ô¨Ånite‚Äìdimensional.
.4
Let X be an inÔ¨Ånite‚Äìdimensional normed space. Use Riesz‚Äôs Lemma
to construct, inductively, a sequence (xn) of unit vectors in X such
that for each n,
(i) x1, . . . , xn are linearly independent, and
(ii) œÅ(xn+1, Xn) ‚â•1
2, where Xn = span {x1, . . . , xn} .
Hence prove that the unit ball of X is not compact.
This provides us with another proof that if the unit ball of a normed
space is compact, then the space is Ô¨Ånite‚Äìdimensional.
.5
Let X be a metric space, x ‚ààX, and S a nonempty subset of X.
A point b ‚ààS is called a best approximation, or a closest point,
to x in S if œÅ(x, b) = œÅ(x, S). Prove the Fundamental Theorem of
Approximation Theory: if X is a Ô¨Ånite‚Äìdimensional subspace of a
normed space X, then each point of X has a best approximation in
X. (See [10], [38], or [52] for further information about approximation
theory, a major branch of analysis with many important practical
applications.)
.6
Prove that any hyperplane in a Ô¨Ånite‚Äìdimensional normed space is
closed.
Now let X be the subspace of c0 consisting of all sequences (xn)‚àû
n=1
of real numbers such that xn = 0 for all suÔ¨Éciently large n. Show
that
f((xn)‚àû
n=1) =
‚àû

n=1
nxn
deÔ¨Ånes a linear functional f : X ‚ÜíR whose kernel is not closed in
X.

4.3 Finite‚ÄìDimensional Normed Spaces
193
.7
Let S be a nonempty closed subset of RN, and K, B closed balls in
RN such that (i) B ‚äÇK and (ii) K intersects S in a single point Œ∂
on the boundary of K. If B does not intersect the boundary of K, let
Œæ be the centre of B; otherwise, B must intersect the boundary of K
in a single point, which we denote by Œæ. For each positive integer n
let
Kn = 1
n(Œæ ‚àíŒ∂) + K.
Prove that for all suÔ¨Éciently large n we have B ‚äÇKn and Kn ‚à©S =
‚àÖ. Hence prove that there exists a ball K‚Ä≤ that is concentric with
K, has radius greater than that of K, and is disjoint from S. (For
the Ô¨Årst part, begin by showing that there exists a positive integer
ŒΩ such that B ‚äÇKn for all n ‚â•ŒΩ. Then suppose that for each
n ‚â•ŒΩ there exists sn ‚ààKn ‚à©S. Show that there exists a subsequence
(snk)‚àû
k=1 converging to Œ∂, and hence Ô¨Ånd k such that snk ‚ààK ‚à©S, a
contradiction.)
A sequence in a normed linear space X is said to be total if it generates a
dense linear subspace of X‚Äîthat is, if the linear space consisting of all Ô¨Ånite
linear combinations of terms of the sequence is dense in X. In that case X
is separable. To see this, let (an) be a total sequence in X, and let S be the
set of all Ô¨Ånite linear combinations r1a1 + ¬∑ ¬∑ ¬∑ + rnan with each coeÔ¨Écient
rk rational. (By a rational complex number we mean a complex number
whose real and imaginary parts are rational.) If Œª1, . . . , Œªn are in F, then
there exist rational elements r1, . . . , rn of F such that n
k=1 |Œªk ‚àírk| ‚à•ak‚à•
is arbitrarily small; since
44444
n

k=1
Œªkak ‚àí
n

k=1
rkak
44444 ‚â§
n

k=1
|Œªk ‚àírk| ‚à•ak‚à•
and (an) is total, it follows that S is dense in X; but S is countable.
We have the following converse.
(4.3.8) Proposition.
If X is an inÔ¨Ånite‚Äìdimensional separable normed
space, then it has a total sequence of linearly independent vectors.
Proof.
Let (an) be a dense sequence in X, and assume without loss
of generality that a1 Ã∏= 0. We construct inductively a strictly increasing
sequence 1 = n1 < n2 < ¬∑ ¬∑ ¬∑ of positive integers such that for each k,
(i) the vectors an1, . . . , ank are linearly independent, and
(ii) for 1 ‚â§m ‚â§nk, am is a linear combination of an1, . . . , ank.
Indeed, if an1, . . . , ank have been constructed with properties (i) and (ii), we
take nk+1 to be the smallest integer m > nk such that am does not belong

194
4. Analysis in Normed Linear Spaces
to the subspace Xk of X generated by {an1, . . . , ank}. (If no such integer
exists, then, being closed by Proposition (4.3.4), Xk contains the closure
of the subspace of X generated by the dense sequence (an), so X = Xk
is Ô¨Ånite‚Äìdimensional‚Äîa contradiction.) It now follows from (ii) that the
sequence (ank)‚àû
k=1 is total in X.
2
(4.3.9) Exercises
.1
Prove that the Banach spaces c0 and l1 are separable.
.2
Show that the Banach space l‚àûis not separable. (Consider the set
of elements of l‚àûwhose terms belong to {0, 1} .)
4.4
The Lp Spaces
In this section we introduce certain inÔ¨Ånite‚Äìdimensional Banach spaces of
integrable functions that appear very frequently in many areas of pure and
applied mathematics. For convenience, we call real numbers p, q conjugate
exponents if p > 1, q > 1, and 1/p + 1/q = 1.
We begin our discussion with an elementary lemma.
(4.4.1) Lemma.
If x, y are positive numbers and 0 < Œ± < 1, then
xŒ±y1‚àíŒ± ‚â§Œ±x + (1 ‚àíŒ±)y.
Proof.
Taking u = x/y, consider
f(u) = uŒ± ‚àíŒ±u ‚àí1 + Œ±.
We have f ‚Ä≤(u) = Œ±(uŒ±‚àí1 ‚àí1), which is positive if 0 < u < 1 and negative
if u > 1. Since f(1) = 0, it follows from Exercise (1.5.4: 7) that f(u) ‚â§0
for all u > 0. This immediately leads to the desired inequality.
2
(4.4.2) Proposition.
Let p, q be conjugate exponents, and f, g measur-
able functions on R such that |f|p and |g|q are integrable. Then fg is
integrable, and H¬®older‚Äôs inequality
    
$
fg
    ‚â§
$
|f|p
1/p $
|g|q
1/q
(1)
holds.
Proof.
We Ô¨Årst note that if
%
|f|p = 0, then |f|p = 0 almost everywhere;
so f = 0, and therefore fg = 0, almost everywhere. Then fg is integrable,
%
fg = 0, and (1) holds trivially, as it does also in the case where
%
|g|q = 0.

4.4 The Lp Spaces
195
Thus we may assume that
%
|f|p > 0 and
%
|g|q > 0. We then have, almost
everywhere,
|fg|
%
|f|p	1/p %
|g|q	1/q =
 |f|p
%
|f|p
1/p  |g|q
%
|g|q
1/q
‚â§
|f|p
p
%
|f|p +
|g|q
q
%
|g|q
(where the last step uses Lemma (4.4.1)), so
|fg| ‚â§
$
|f|p
1/p $
|g|q
1/q 
|f|p
p
%
|f|p +
|g|q
q
%
|g|q

.
(2)
Now, fg is measurable and the right‚Äìhand side of (2) is integrable. Hence,
by Proposition (2.3.1), fg is integrable and
    
$
fg
    ‚â§
$
|fg| ‚â§
$
|f|p
1/p $
|g|q
1/q 1
p + 1
q

,
from which (1) follows.
2
(4.4.3) Proposition.
Let p ‚â•1, and let f, g be measurable functions on
R such that |f|p and |g|p are integrable. Then |f + g|p is integrable, and
Minkowski‚Äôs inequality
$
|f + g|p
1/p
‚â§
$
|f|p
1/p
+
$
|g|p
1/p
holds.
Proof.
Clearly, we may assume that p > 1. Now, |f + g|p is measurable,
by Exercise (2.3.3: 5). Since
|f + g|p ‚â§(2 max {|f| , |g|})p ‚â§2p (|f|p + |g|p)
and the last function is integrable, it follows from Proposition (2.3.1) that
|f + g|p is integrable. The functions |f| and |f + g|p‚àí1 are measurable, by
Exercise (2.3.3: 5), and

|f + g|p‚àí1q
= |f + g|p ‚ààL1(R).
Thus, by Proposition (4.4.2), |f + g|p‚àí1 |f| is integrable and
$
|f + g|p‚àí1 |f| ‚â§
$
|f + g|p
1‚àíp‚àí1 $
|f|p
1/p
.

196
4. Analysis in Normed Linear Spaces
Similarly, |f + g|p‚àí1 |g| is integrable and
$
|f + g|p‚àí1 |g| ‚â§
$
|f + g|p
1‚àíp‚àí1 $
|g|p
1/p
.
It follows that
$
|f + g|p =
$
|f + g|p‚àí1 |f + g|
‚â§
$
|f + g|p‚àí1 |f| +
$
|f + g|p‚àí1 |g|
‚â§
$
|f + g|p
1‚àíp‚àí1 $
|f|p
1/p
+
$
|g|p
1/p
,
from which we easily obtain Minkowski‚Äôs inequality.
2
(4.4.4) Exercises
.1
Prove H¬®older‚Äôs inequality
     
N

n=1
xnyn
     ‚â§
 N

n=1
|xn|p
1/p  N

n=1
|yn|q
1/q
and Minkowski‚Äôs inequality
 N

n=1
|xn + yn|p
1/p
‚â§
 N

n=1
|xn|p
1/p
+
 N

n=1
|yn|p
1/p
for Ô¨Ånite sequences x1, . . . , xN and y1, . . . , yN of real numbers.
.2
A sequence (xn) of real numbers is called p‚Äìpower summable if the
series ‚àû
n=1 |xn|p converges. Prove that if (xn) is p‚Äìpower summable
and (yn) is q‚Äìpower summable, where p, q are conjugate exponents,
then
(i) ‚àû
n=1 xnyn is absolutely convergent, and
(ii) H¬®older‚Äôs inequality holds in the form
     
‚àû

n=1
xnyn
     ‚â§
 ‚àû

n=1
|xn|p
1/p  ‚àû

n=1
|yn|q
1/q
.
Prove also that if (xn) and (yn) are both p‚Äìpower summable, then so
is (xn + yn) , and Minkowski‚Äôs inequality
 ‚àû

n=1
|xn + yn|p
1/p
‚â§
 ‚àû

n=1
|xn|p
1/p
+
 ‚àû

n=1
|yn|p
1/p
holds.

4.4 The Lp Spaces
197
.3
Let p ‚â•1, and let lp denote the set of all p‚Äìpower summable se-
quences, taken with termwise addition and multiplication‚Äìby‚Äìscalars.
Prove that
‚à•(xn)‚àû
n=1‚à•p =
 ‚àû

n=1
|xn|p
1/p
deÔ¨Ånes a norm on lp. (We deÔ¨Åne the normed space lp(C) of p‚Äìpower
summable sequences of complex numbers in the obvious analogous
way.)
Let X be a measurable subset of R, and p ‚â•1. We deÔ¨Åne Lp(X) to be
the set of all functions f, deÔ¨Åned almost everywhere on R, such that f is
measurable, f vanishes almost everywhere on R\X, and |f|p is integrable.
Taken with the pointwise operations of addition and multiplication‚Äìby‚Äì
scalars, Lp(X) becomes a linear space. If we follow the usual practice of
identifying two measurable functions that are equal almost everywhere,
then
‚à•f‚à•p =
$
|f|p
1/p
is a norm, called the Lp‚Äìnorm, on Lp(X). (We met the normed space L1(R)
in Exercise (4.1.1: 6).)
When X = [a, b] is a compact interval, we write Lp[a, b] rather than
Lp ([a, b]) .
(4.4.5) Exercises
In these exercises, X is a measurable subset of R.
.1
Let X be integrable and 1 ‚â§r < s. Prove the following.
(i) Ls(X) ‚äÇLr(X). (Note that if f ‚ààLs(X), then |f|r ‚ààLs/r(X).)
(ii) The linear mapping f ‚Üíf of Ls(X) into Lr(X) is bounded and
has norm ‚â§¬µ(X)r‚àí1‚àís‚àí1.
.2
Let 1 ‚â§r ‚â§t ‚â§s < ‚àû, r Ã∏= s,
Œ± = t‚àí1 ‚àís‚àí1
r‚àí1 ‚àís‚àí1 ,
Œ≤ = r‚àí1 ‚àít‚àí1
r‚àí1 ‚àís‚àí1 .
and f ‚ààLr(X) ‚à©Ls(X). Prove that f ‚ààLt(X) and
‚à•f‚à•t ‚â§‚à•f‚à•Œ±
r ‚à•f‚à•Œ≤
s .
(Consider |f|Œ±t |f|Œ≤t .)

198
4. Analysis in Normed Linear Spaces
.3
Prove that the step functions that vanish outside X form a dense
subspace of Lp(X) for p ‚â•1. (First consider the case where X is a
compact interval.)
.4
Let p, q be conjugate exponents, and let f, g ‚ààLp(X). Prove that if
1 < p < 2, then
2

‚à•f‚à•p
p + ‚à•g‚à•p
p
q‚àí1
‚â•‚à•f + g‚à•q
p + ‚à•f ‚àíg‚à•q
p
and
‚à•f + g‚à•p
p + ‚à•f ‚àíg‚à•p
p ‚â•2

‚à•f‚à•q
p + ‚à•g‚à•q
p
p‚àí1
,
and that the reverse inequalities hold if p ‚â•2. (Clarkson‚Äôs inequalities.
Use Exercise (1.5.8: 10).)
.5
Use the preceding exercise to prove that if p > 1, then Lp(X) is
uniformly convex. (See Exercise (4.2.2: 15).)
(4.4.6) The Riesz‚ÄìFischer Theorem.
Lp(X) is a Banach space for all
p ‚â•1. More precisely, if (fn) is a Cauchy sequence in Lp(X), then there
exist f ‚ààLp(X) and a subsequence (fnk)‚àû
k=1 of (fn) such that
(i) limn‚Üí‚àû‚à•f ‚àífn‚à•p = 0, and
(ii) fnk ‚Üíf almost everywhere on X as k ‚Üí‚àû.
Proof.
We illustrate the proof with the case X = R and p > 1. Given a
Cauchy sequence (fn) in Lp(R), choose a subsequence (fnk)‚àû
k=1 such that
‚à•fm ‚àífn‚à•p ‚â§2‚àík
(m, n ‚â•nk).
Then
44fnk+1 ‚àífnk
44
p ‚â§2‚àík.
Writing q = p/(p‚àí1), we see from Proposition (4.4.2) that for each positive
integer N,
  fnk+1 ‚àífnk
  is integrable over [‚àíN, N], and
$   fnk+1 ‚àífnk
  œá[‚àíN,N] ‚â§
44fnk+1 ‚àífnk
44
p
$
œá[‚àíN,N]
1/q
‚â§2‚àík(2N)1/q,
so the series
‚àû

k=1
$   fnk+1 ‚àífnk
  œá[‚àíN,N]

4.4 The Lp Spaces
199
converges. It follows from Lebesgue‚Äôs Series Theorem (Exercise (2.2.13: 4))
that there exists a set EN of measure zero such that the series
‚àû

k=1
  fnk+1(x) ‚àífnk(x)
  œá[‚àíN,N](x)
converges for all x ‚ààR\EN, and the function ‚àû
k=1
  fnk+1 ‚àífnk
  œá[‚àíN,N]
is integrable. Then
E =
‚àû

N=1
EN
is a set of measure zero, and
f(x) = lim
k‚Üí‚àûfnk(x) = fn1(x) +
‚àû

k=1

fnk+1(x) ‚àífnk(x)
	
exists for all x ‚ààR\E. The function f so deÔ¨Åned is measurable, by Exercise
(2.3.3: 4). Since
‚à•fnk‚à•p ‚â§‚à•fn1‚à•p + ‚à•fnk ‚àífn1‚à•p ‚â§‚à•fn1‚à•p + 1
2
for all k, we see from Fatou‚Äôs Lemma (Exercise (2.2.13: 11)) that |f|p is
integrable and hence that f ‚ààLp(R). Moreover, if n ‚â•ni, then by applying
Fatou‚Äôs Lemma to the sequence (|fnk ‚àífn|)‚àû
k=i we see that
‚à•f ‚àífn‚à•p = lim
k‚Üí‚àû‚à•fnk ‚àífn‚à•p ‚â§2‚àíi.
Hence limn‚Üí‚àû‚à•f ‚àífn‚à•p = 0.
2
(4.4.7) Exercises
.1
Prove the Riesz‚ÄìFischer Theorem for a general measurable set X ‚äÇ
R. Prove it also in the case p = 1.
.2
Prove that the space lp is complete for p ‚â•1.
In order to establish an elegant characterisation of bounded linear func-
tionals on Lp(X), we Ô¨Årst discuss those functions whose derivatives almost
everywhere belong to Lq(R).
(4.4.8) Lemma.
Let I = [a, b] be a compact interval, q > 1, and G a
real‚Äìvalued function deÔ¨Åned almost everywhere on R and vanishing outside
I. Then the following conditions are equivalent.
(i) There exists g ‚ààLq(R) such that G‚Ä≤(x) = g(x) almost everywhere.

200
4. Analysis in Normed Linear Spaces
(ii) There exists M > 0 such that
n‚àí1

k=1
|G(xk+1) ‚àíG(xk)|q
(xk+1 ‚àíxk)q‚àí1
‚â§M
whenever the points xk ‚ààI and x1 < x2 < ¬∑ ¬∑ ¬∑ < xn.
In that case, the smallest such M is
%
|g|q .
Proof.
Writing p = q/(q ‚àí1), suppose that (i) holds, and let a ‚â§x1 <
x2 < ¬∑ ¬∑ ¬∑ < xn ‚â§b. Applying Proposition (4.4.2) to the functions œáI and
œáIg, we have
|G(xk+1) ‚àíG(xk)| =
    
$ xk+1
xk
g
    
‚â§
$ xk+1
xk
œáI
1/p $ xk+1
xk
|g|q
1/q
= (xk+1 ‚àíxk)1/p
$ xk+1
xk
|g|q
1/q
.
Hence
|G(xk+1) ‚àíG(xk)|q ‚â§(xk+1 ‚àíxk)q‚àí1
$ xk+1
xk
|g|q ,
and therefore
n‚àí1

k=1
|G(xk+1) ‚àíG(xk)|q
(xk+1 ‚àíxk)q‚àí1
‚â§
n

k=1
$ xk+1
xk
|g|q ‚â§
$
|g|q .
Thus (ii) holds, and the smallest M for which (ii) holds is at most
%
|g|q .
Now suppose that (ii) holds, and let ((ak, bk))N
k=1 be a Ô¨Ånite sequence
of nonoverlapping open subintervals of I. Applying Exercise (4.4.4: 1), we
obtain
N

k=1
|G(bk) ‚àíG(ak)| =
N

k=1
|G(bk) ‚àíG(ak)|
(bk ‚àíak)1/p

(bk ‚àíak)1/p
‚â§
 N

k=1
|G(bk) ‚àíG(ak)|q
(bk ‚àíak)q‚àí1
1/q  N

k=1
(bk ‚àíak)
1/p
‚â§M
 N

k=1
(bk ‚àíak)
1/p
.
Hence G is absolutely continuous. It follows from Exercise (2.2.17: 2) that
there exists an integrable function g such that G‚Ä≤(x) = g(x) almost
everywhere.

4.4 The Lp Spaces
201
For each positive integer n let
xn,k = a + k
2n (b ‚àía)
(0 ‚â§k ‚â§2n)
and deÔ¨Åne a step function gn by setting
gn(x) =
Ô£±
Ô£¥
Ô£¥
Ô£≤
Ô£¥
Ô£¥
Ô£≥
G(xn,k+1) ‚àíG(xn,k)
xn,k+1 ‚àíxn,k
if xn,k < x < xn,k+1
0
otherwise.
Then g(x) = limn‚Üí‚àûgn(x) almost everywhere‚Äîto be precise, on the
complement of the union of
{xn,k : n ‚â•1, 0 ‚â§k ‚â§2n}
and the set of measure zero on which G‚Ä≤ = g . Also,
$
|gn|q =
2n

k=0
|G(xn,k+1) ‚àíG(xn,k)|q
(xn,k+1 ‚àíxn,k)q‚àí1
‚â§M.
Applying Fatou‚Äôs Lemma, we now see that |g|q is integrable and
%
|g|q ‚â§M.
Hence (ii) implies (i). Referring to the last sentence of the Ô¨Årst part of the
proof, we also see that
%
|g|q is the smallest M for which (ii) holds.
2
(4.4.9) Lemma.
Let u be a bounded linear functional on Lp[a, b], and
deÔ¨Åne
G(x) =
Ô£±
Ô£¥
Ô£≤
Ô£¥
Ô£≥
u

œá[a,x]

if a ‚â§x ‚â§b
0
otherwise.
Let a ‚â§x1 < x2 < ¬∑ ¬∑ ¬∑ < xn ‚â§b, and let f = n‚àí1
k=1 ckœá[xk,xk+1]. Then
u(f) =
n‚àí1

k=1
ck (G(xk+1) ‚àíG(xk)) .
Moreover, if there exists g ‚ààLq[a, b] such that G‚Ä≤ = g almost everywhere,
then u(f) =
%
fg.
Proof.
We have
u(f) =
n‚àí1

k=1
cku(œá[xk,xk+1])
=
n‚àí1

k=1
ck

u

œá[a,xk+1] ‚àíœá[a,xk]

=
n‚àí1

k=1
ck (G(xk+1) ‚àíG(xk)) .

202
4. Analysis in Normed Linear Spaces
Now suppose that G‚Ä≤ = g almost everywhere for some g ‚ààLq[a, b]. Then
u(f) =
n‚àí1

k=1
ck
$ xk+1
xk
g =
n‚àí1

k=1
$ xk+1
xk
ckg =
$
fg.
2
We now show that if p, q are conjugate exponents, then the dual space
L‚àó
p can be identiÔ¨Åed with Lq.
(4.4.10) Theorem.
Let p, q be conjugate exponents. Then for each g ‚àà
Lq(X),
ug(f) =
$
fg
deÔ¨Ånes a bounded linear functional on Lp(X) with norm equal to ‚à•g‚à•q .
Conversely, to each bounded linear functional u on Lp(X) there corresponds
a unique g ‚ààLq(X) such that u = ug.
Proof.
If g ‚ààLq(X), then by Lemma (4.4.2), ug is well deÔ¨Åned on Lp(X).
It is trivial that ug is linear, and H¬®older‚Äôs inequality shows that ‚à•g‚à•q is a
bound for ug. On the other hand, taking
f =

g+	q/p ‚àí

g‚àí	q/p ,
we see that f ‚ààLp(X) and
ug(f) =
$
fg =
$
|g|1+qp‚àí1
=
$
|g|q
= ‚à•g‚à•q
$
|g|q
1‚àíq‚àí1
= ‚à•g‚à•q
$
|f|p
1/p
= ‚à•g‚à•q ‚à•f‚à•p .
Hence ‚à•ug‚à•= ‚à•g‚à•q .
Now consider any bounded linear functional u on Lp(X). To begin with,
take the case where X is a compact interval [a, b]. If u = ug for some
g ‚ààLq(X), then u

œá[a,x]

=
% x
a g for each x ‚ààX. This suggests that we
deÔ¨Åne
G(x) =
Ô£±
Ô£¥
Ô£≤
Ô£¥
Ô£≥
u

œá[a,x]

if x ‚ààX
0
if x ‚ààR\X
and try to show that G‚Ä≤ ‚ààLq(X) and that u(f) =
%
fG‚Ä≤ for all f ‚ààLp(X).
To this end, let a ‚â§x1 < x2 < ¬∑ ¬∑ ¬∑ < xn ‚â§b. Let œÜ be the step function

4.4 The Lp Spaces
203
that vanishes outside [x1, xn] and at each xi, and that takes the constant
value
ck = |G(xk+1) ‚àíG(xk)|q‚àí1 sgn (G(xk+1) ‚àíG(xk))
(xk+1 ‚àíxk)q‚àí1
on (xk, xk+1) , where
sgn (x) =
Ô£±
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£≤
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£≥
1
if x > 0
0
if x = 0
‚àí1
if x < 0.
Then, by Lemma (4.4.9),
n‚àí1

k=1
|G(xk+1) ‚àíG(xk)|q
(xk+1 ‚àíxk)q‚àí1
= u(œÜ)
‚â§‚à•u‚à•‚à•œÜ‚à•p
= ‚à•u‚à•
n‚àí1

k=1
|ck|p (xk+1 ‚àíxk)
1/p
= ‚à•u‚à•
n‚àí1

k=1
|G(xk+1) ‚àíG(xk)|q
(xk+1 ‚àíxk)q‚àí1
1/p
,
and therefore
n‚àí1

k=1
|G(xk+1) ‚àíG(xk)|q
(xk+1 ‚àíxk)q‚àí1
‚â§‚à•u‚à•q .
Thus, by Lemma (4.4.8), there exists g ‚ààLq(X) such that G‚Ä≤ = g almost
everywhere and ‚à•g‚à•q ‚â§‚à•u‚à•. It follows from Lemma (4.4.9) that u(f) =
%
fg for each step function f that vanishes outside X. The set of such step
functions is dense in the space Lp(X), by Exercise (4.4.5: 3); moreover, the
linear functionals u and f ‚Üí
%
fg are bounded, and therefore uniformly
continuous, on Lp(X). Referring to Proposition (3.2.12), we conclude that
u = ug.
It remains to remove the restriction that X be a compact interval and
to prove the uniqueness of g for a given u. This is left as an exercise.
2
(4.4.11) Exercises
.1
Complete the proof of Theorem (4.4.10) by removing the restriction
that X be a compact interval, and by proving the uniqueness of the
function g for a given u.

204
4. Analysis in Normed Linear Spaces
.2
A measurable function f on R is said to be essentially bounded if
there exists M > 0 such that |f(x)| ‚â§M almost everywhere. Prove
that
‚à•f‚à•‚àû= inf {M > 0 : |f(x)| ‚â§M almost everywhere}
deÔ¨Ånes a norm on the vector space L‚àûof all essentially bounded
functions under pointwise operations, and that L‚àûis a Banach space
with respect to this norm (where, as usual, we identify measurable
functions that are equal almost everywhere).
The real number ‚à•f‚à•‚àûis called the essential supremum of the
element f of L‚àû.
.3
Let K be a compact subset of R, and f : K ‚ÜíR a continuous
function. Extend f to R by setting f(x) = 0 if x ‚ààR\K. Prove that
f ‚ààL‚àûand that ‚à•f‚à•‚àû= supx‚ààK |f(x)| .
.4
Prove that if f ‚ààL1 and g ‚ààL‚àû, then fg ‚ààL1 and H¬®older‚Äôs
inequality holds in the form
‚à•fg‚à•1 ‚â§‚à•f‚à•1 ‚à•g‚à•‚àû.
.5
Prove that for each g ‚ààL‚àû,
ug(f) =
$
fg
deÔ¨Ånes a bounded linear functional on L1 with norm equal to ‚à•g‚à•‚àû,
and that every bounded linear functional on L1 has the form ug for
a unique corresponding g ‚ààL‚àû.
.6
Let 0 < p < 1, and let Lp consist of all measurable functions f on
R such that |f|p is integrable. Show that when we identify functions
that are equal almost everywhere,
œÅp(f, g) =
$
|f ‚àíg|p
deÔ¨Ånes a metric on Lp, and that (Lp, œÅp) is a complete metric space.
Show also that the only continuous linear mapping from Lp (with
pointwise operations) to R is the zero mapping.
4.5
Function Spaces
Among the most important examples of Banach spaces are certain subsets
of the space B(X, Y ) of bounded functions from a nonempty set X into a
Banach space Y , where the norm on B(X, Y ) is the sup norm
‚à•f‚à•= sup{‚à•f(x)‚à•: x ‚ààX}.

4.5 Function Spaces
205
Note that when X is a compact interval [a, b], we usually write B[a, b] rather
than B([a, b]); we use similar notations without further comment in related
situations.
A special case of the next result has appeared already (Exercise
(4.1.6: 4)).
(4.5.1) Proposition.
If Y is a Banach space, then B(X, Y ) is a Banach
space.
Proof.
Let (fn) be a Cauchy sequence in B(X, Y ), and Œµ > 0. There
exists N such that ‚à•fm ‚àífn‚à•< Œµ for all m, n ‚â•N. For each x ‚ààX we
have
‚à•fm(x) ‚àífn(x)‚à•‚â§‚à•fm ‚àífn‚à•< Œµ
whenever m, n ‚â•N; so (fn(x))‚àû
n=1 is a Cauchy sequence in Y . Since Y is
complete,
f(x) = lim
n‚Üí‚àûfn(x)
exists; also, for all m ‚â•N,
‚à•fm(x) ‚àíf(x)‚à•= lim
n‚Üí‚àû‚à•fm(x) ‚àífn(x)‚à•‚â§Œµ.
(1)
Hence
‚à•f(x)‚à•‚â§‚à•fN(x)‚à•+ ‚à•fN(x) ‚àíf(x)‚à•‚â§‚à•fN‚à•+ Œµ.
Since x ‚ààX is arbitrary, we see that f ‚ààB(X, Y ). Also, it follows from (1)
that ‚à•fm ‚àíf‚à•‚â§Œµ for all m ‚â•N. Since Œµ > 0 is arbitrary, (fn) converges
to f in B(X, Y ). Hence B(X, Y ) is complete.
2
(4.5.2) Exercises
.1
Let Y be a Ô¨Ånite‚Äìdimensional Banach space, and {e1, . . . , en} a basis
of Y. Prove that each f ‚ààB(X, Y ) can be written uniquely in the
form x ‚Üín
k=1 fk(x)ek with each fk ‚ààB(X, F). Prove also that for
each k, f ‚Üífk is a bounded linear mapping of B(X, Y ) into B(X, F).
.2
Prove that the mapping f ‚Üísupt‚ààX f(x) of B(X, R) into R is
continuous.
.3
Let Y be a Banach space, and ‚àû
n=1 fn a series in B(X, Y ). Let
‚àû
n=1 cn be a convergent series of nonnegative real numbers such that
‚à•fn‚à•‚â§cn for each n. Show that ‚àû
n=1 fn converges in the Banach
space B(X, Y ).
.4
Let I = [a, b] be a compact interval, and BV(I) the linear space of
all real‚Äìvalued functions of bounded variation on I, with pointwise
operations. Show that
‚à•f‚à•bv = |f(a)| + Tf(a, b)

206
4. Analysis in Normed Linear Spaces
deÔ¨Ånes a norm on BV(I), and that BV(I) is complete with respect to
this norm. (For the second part recall Exercise (1.5.15: 6).)
Let f, f1, f2, . . . be mappings of a nonempty set X into a metric space
(Y, œÅ). We say that the sequence (fn)
‚Ä¢ converges simply to f on X if for each x ‚ààX the sequence (fn(x))
converges to f(x) in Y ;
‚Ä¢ converges uniformly to f on X if
sup
x‚ààX
œÅ(fn(x), f(x)) ‚Üí0 as n ‚Üí‚àû.
Clearly, uniform convergence implies simple convergence; but, as the next
exercise shows, the converse is false.
(4.5.3) Exercises
.1
Give an example of a sequence (fn) of continuous mappings from
[0, 1] into [0, 1] that converges to 0 simply, but not uniformly, on [0, 1].
(Consider a spike of height 1 travelling along the x‚Äìaxis towards 0.)
.2
Let Y be a normed space. Prove that a sequence (fn) in B(X, Y )
converges to a limit f in the normed space B(X, Y ) if and only if
(fn) converges uniformly to f on X.
.3
Let X be a compact metric space, and (fn), (gn) strictly increasing
sequences of real‚Äìvalued functions on X that converge simply to the
same bounded function f : X ‚ÜíR. Show that for each m there exists
n such that fm < gn (that is, fm(x) < gn(x) for all x ‚ààX). Show
also that we cannot omit ‚Äúcompact‚Äù from the hypotheses.
Now let (X, œÅ) be a metric space, and Y a normed space. The set of all
continuous mappings of X into Y is denoted by C(X, Y ) or CY (X), and
the set of all bounded continuous mappings of X into Y by C‚àû(X, Y ) or
C‚àû
Y (X); so
C‚àû(X, Y ) = B(X, Y ) ‚à©C(X, Y ).
If X is compact, then C‚àû(X, Y ) = C(X, Y ), by Exercise (3.3.7: 1). In gen-
eral, C‚àû(X, Y ) is a linear subspace of B(X, Y ); we consider it as a normed
space, taken with the sup norm.
We usually write C‚àû(X) and C(X), respectively, instead of C‚àû(X, R)
and C(X, R).
(4.5.4) Proposition.
If X is a metric space and Y a Banach space, then
C‚àû(X, Y ) is a closed, and therefore complete, subspace of B(X, Y ).

4.5 Function Spaces
207
Proof.
Let (fn) be a sequence of elements of C(X, Y ) converging to a
limit f in B(X, Y ). For each Œµ > 0 there exists N such that ‚à•f ‚àífn‚à•‚â§Œµ/3
whenever n ‚â•N. Given x0 in X, construct a neighbourhood U of x0 such
that if x ‚ààU, then ‚à•fN(x) ‚àífN(x0)‚à•‚â§Œµ/3. For each x ‚ààU we then have
‚à•f(x) ‚àíf(x0)‚à•‚â§‚à•f(x) ‚àífN(x)‚à•+ ‚à•fN(x) ‚àífN(x0)‚à•
+ ‚à•fN(x0) ‚àíf(x0)‚à•
‚â§‚à•f ‚àífN‚à•+ Œµ
3 + ‚à•fN ‚àíf‚à•
= Œµ.
Since Œµ > 0 and x0 ‚ààX are arbitrary, it follows that f is continuous on X.
Thus C‚àû(X, Y ) is closed in B(X, Y ); whence, by Propositions (4.5.1) and
(3.2.9), C‚àû(X, Y ) is complete.
2
Proposition (4.5.4) shows that a uniform limit of bounded continuous
functions is continuous. Taken with Exercise (4.5.3: 1), this observation
highlights the signiÔ¨Åcance of the next theorem.
(4.5.5) Dini‚Äôs Theorem.
Let X be a compact metric space, and (fn) an
increasing sequence in C(X) that converges simply to a continuous function
f. Then (fn) converges to f uniformly.
Proof.
Let Œµ > 0. For each x ‚ààX there exists Nx such that if n ‚â•Nx,
then 0 ‚â§f(x)‚àífn(x) ‚â§Œµ/3. Since f and fNx are continuous, there exists an
open neighbourhood Ux of x such that if x‚Ä≤ ‚ààUx, then |f(x) ‚àíf(x‚Ä≤)| ‚â§Œµ/3
and |fNx(x) ‚àífNx(x‚Ä≤)| ‚â§Œµ/3; whence
0 ‚â§f(x‚Ä≤) ‚àífNx(x‚Ä≤)
‚â§|f(x) ‚àíf(x‚Ä≤)| + f(x) ‚àífNx(x) + |fNx(x) ‚àífNx(x‚Ä≤)|
‚â§Œµ
3 + Œµ
3 + Œµ
3
= Œµ.
Since X is compact, there are Ô¨Ånitely many points x1, . . . , xŒΩ of X such
that the neighbourhoods Uxi cover X. Setting
nŒµ = max{Nxi : 1 ‚â§i ‚â§ŒΩ},
consider n ‚â•nŒµ. Given x ‚ààX, choose i such that x ‚ààUxi; then
0 ‚â§f(x) ‚àífn(x) ‚â§f(x) ‚àífnŒµ(x) ‚â§f(x) ‚àífNxi(x) ‚â§Œµ.
Since Œµ > 0 and x ‚ààX are arbitrary, we conclude that (fn) converges to f
uniformly.
2
(4.5.6) Exercises

208
4. Analysis in Normed Linear Spaces
.1
Show that ‚Äúincreasing‚Äù can be replaced by ‚Äúdecreasing‚Äù in Dini‚Äôs
Theorem.
.2
Give an alternative proof of Dini‚Äôs Theorem using the sequential
compactness of X.
.3
Let X be a metric space, Y a Banach space, and D a dense subset of
X. Let (fn) be a sequence of bounded continuous mappings of X into
Y such that the restrictions of the functions fn to D form a uniformly
convergent sequence. Prove that (fn) is uniformly convergent on X.
.4
Let X be a metric space, and Y a normed space. Prove that the
mapping (x, f) ‚Üíf(x) is continuous on X √ó C‚àû(X, Y ) .
.5
Let I be a compact interval in R, and (fn) a sequence of increasing
real functions on I that converges simply in I to a continuous function
f. Prove that f is increasing and that (fn) converges to f uniformly
on I.
.6
Let a, b be real numbers with b > 0, and let X be the set of all
continuous mappings f : [0, b] ‚ÜíR such that f(0) = a. Prove that
X is complete with respect to the sup norm.
.7
Let I be a compact interval in R, x0 ‚ààI, and Œ± > 0. Show that
‚à•f‚à•‚Ä≤ = sup

e‚àíŒ±|x‚àíx0| |f(x)| : x ‚ààI

deÔ¨Ånes a norm on C(I), and that C(I) is complete with respect to this
norm.
.8
In the notation of Exercise (4.5.2: 4) prove that if a sequence (fn)
converges to a limit f with respect to the norm ‚à•¬∑‚à•bv on BV(I), then
it converges to f with respect to the sup norm on B(I).
With I = [0, 1] Ô¨Ånd a sequence in BV(I) ‚à©C(I) that
(i) converges to a limit f ‚ààC(I) with respect to the sup norm, and
(ii) is not a Cauchy sequence with respect to ‚à•¬∑‚à•bv .
(Note Exercise (1.5.15: 4).)
Let X be a metric space, Y a normed space, and F a subset of B(X, Y ).
We say that F is
‚Ä¢ equicontinuous at a ‚ààX if for each Œµ > 0 there exists Œ¥ > 0 such that
‚à•f(x) ‚àíf(a)‚à•< Œµ whenever f ‚ààF and œÅ(x, a) < Œ¥,
‚Ä¢ equicontinuous (on X) if it is equicontinuous at each point of X;

4.5 Function Spaces
209
‚Ä¢ uniformly equicontinuous if for each Œµ > 0 there exists Œ¥ > 0 such that
‚à•f(x) ‚àíf(y)‚à•< Œµ whenever f ‚ààF, x ‚ààX, y ‚ààX, and œÅ(x, y) < Œ¥.
Clearly, uniform equicontinuity implies equicontinuity, and if F is equicon-
tinuous at a, then each f ‚ààF is continuous at a.
(4.5.7) Exercises
In these exercises, X, Y, and F are as in the Ô¨Årst sentence of the last
paragraph.
.1
Suppose that there exist constants c > 0 and Œª ‚â•1 such that
‚à•f(x) ‚àíf(y)‚à•‚â§c œÅ(x, y)Œª
for all f
‚àà
F and all x, y
‚àà
X. Show that F is uniformly
equicontinuous.
.2
Let Œ± > 0, and let F be the set of all mappings f : [0, 1] ‚ÜíR such
that f ‚Ä≤ exists, is continuous, and has sup norm at most Œ±. Show that
F is uniformly equicontinuous.
.3
Show that {xn : n ‚ààN} is not equicontinuous at 1.
.4
Let (fn) be an equicontinuous sequence of real‚Äìvalued functions on
X. Prove that the sequence
(f1 ‚à®f2 ‚à®¬∑ ¬∑ ¬∑ ‚à®fn)‚àû
n=1
is also equicontinuous.
.5
For each Œª ‚ààL let FŒª ‚äÇB(X, Y ) be equicontinuous at a. Prove
that if L is a Ô¨Ånite set, then 
Œª‚ààL FŒª is equicontinuous at a. Give an
example where L is an inÔ¨Ånite set and 
Œª‚ààL FŒª is not equicontinuous
at a.
.6
Let (fn) be a sequence of functions in B(X, Y ) that converges simply
to a function f and is equicontinuous at a ‚ààX. Prove that f is
continuous at a. Hence prove that the closure of an equicontinuous
set in C‚àû(X, Y ) is equicontinuous.
.7
Prove that if X is compact and F ‚äÇC(X, Y ) is equicontinuous, then
F is uniformly equicontinuous.
.8
Suppose that X is compact, and let (fn) be a convergent sequence
in C(X, Y ). Prove that (fn) is uniformly equicontinuous. (Let f =
limn‚Üí‚àûfn. Given Œµ > 0, choose N such that ‚à•f ‚àífn‚à•< Œµ for all
n ‚â•N. First Ô¨Ånd Œ¥1 > 0 such that ‚à•fn(x) ‚àífn(y)‚à•< 3Œµ whenever
œÅ(x, y) < Œ¥1 and n ‚â•N.)

210
4. Analysis in Normed Linear Spaces
.9
Suppose that X is compact, and that (fn) is an equicontinuous se-
quence in C (X, Y ) that converges simply to a function f : X ‚ÜíY.
Then f is continuous on X, by Exercise (4.5.7: 6). Show that (fn)
converges uniformly to f. (Given Œµ > 0, use Exercise (4.5.7: 7) to ob-
tain Œ¥ as in the deÔ¨Ånition of ‚Äúuniformly equicontinuous‚Äù. Then cover
X by Ô¨Ånitely many balls of the form B(x, Œ¥).)
.10 Let (fn) be a sequence of continuous real‚Äìvalued mappings on a
compact interval I.
(i) Prove that if (fn) is a Cauchy sequence in C(I), then it is a
Cauchy sequence in L2(I).
(ii) Prove that if (fn) is both equicontinuous and a Cauchy sequence
relative to the L2‚Äìnorm, then (fn) converges in C(I).
(For (ii) Ô¨Åx t0 ‚ààI and Œµ > 0. Choose Œ¥ > 0 such that if t ‚ààI
and |t ‚àít0| < Œ¥, then |fn(t) ‚àífn(t0)| < Œµ for all n. Let œá be the
characteristic function of I ‚à©[t0 ‚àíŒ¥, t0 + Œ¥], and show that
$
œá(t) |fm(t0) ‚àífn(t0)|2 dt < cŒ¥Œµ2
for some constant c > 0 and all suÔ¨Éciently large m and n. Deduce
that (fn(t0)) is a Cauchy sequence in I.)
Show that the equicontinuity hypothesis cannot be dropped in (ii).
If X is compact and Y is a Banach space, then we have a powerful
characterisation of totally bounded subsets of C(X, Y ).
(4.5.8) Ascoli‚Äôs Theorem.2
Let X be a compact metric space, Y a
normed space, and F a subset of C(X, Y ). Then F is totally bounded if and
only if
(i) F is equicontinuous and
(ii) for each x ‚ààX,
Fx = {f(x) : f ‚ààF}
is a totally bounded subset of Y.
Proof.
Assume Ô¨Årst that F is totally bounded, and let Œµ > 0. Construct a
Ô¨Ånite Œµ‚Äìapproximation {f1, . . . , fN} to F. Then for each f in F there exists
i such that ‚à•f ‚àífi‚à•‚â§Œµ. So for each x ‚ààX we have ‚à•f(x) ‚àífi(x)‚à•‚â§Œµ,
from which it follows that {f1(x), . . . , fN(x)} is an Œµ‚Äìapproximation to Fx.
2This is also known as the Ascoli‚ÄìArzel`a Theorem.

4.5 Function Spaces
211
Hence Fx is totally bounded. On the other hand, choose Œ¥ > 0 such that if
œÅ(x, y) < Œ¥, then ‚à•fk(x) ‚àífk(y)‚à•‚â§Œµ for each k. With f and fi as in the
foregoing, we have
‚à•f(x) ‚àíf(y)‚à•‚â§‚à•f(x) ‚àífi(x)‚à•+ ‚à•fi(x) ‚àífi(y)‚à•
+ ‚à•fi(y) ‚àíf(y)‚à•
‚â§Œµ + Œµ + Œµ
= Œµ.
Hence F is equicontinuous.
Now assume, conversely, that conditions (i) and (ii) hold, and let Œµ be
any positive number. For each x ‚ààX choose an open neighbourhood Ux
of x such that ‚à•f(y) ‚àíf(x)‚à•< Œµ for each f ‚ààF and each y ‚ààUx. Since
X is compact, it can be covered by a Ô¨Ånite family {Ux1, . . . ,Uxm} of such
neighbourhoods. Now, the sets Fxi (1 ‚â§i ‚â§m) are totally bounded, as
is therefore their union K. Let {Œæ1, . . . , Œæn} be a Ô¨Ånite Œµ‚Äìapproximation to
K. On the other hand, let Œ¶ be the Ô¨Ånite set of all mappings of {1, . . . , m}
into {1, . . . , n}, and for each œï ‚ààŒ¶ let
Sœï =

f ‚ààF :
44f(xi) ‚àíŒæœï(i)
44 ‚â§Œµ (1 ‚â§i ‚â§m)

.
Then for each f ‚ààF there exists œï ‚ààŒ¶ such that f ‚ààSœï. Since there
are only Ô¨Ånitely many of the sets Sœï (some of which may be empty), to
complete the proof that F is totally bounded it suÔ¨Éces to prove that the
diameter of each Sœï is at most 4Œµ. To this end, consider any œï ‚ààŒ¶ and
any two elements f, g of Sœï. Given x ‚ààX, choose i such that x ‚ààUxi.
Then ‚à•f(x) ‚àíf(xi)‚à•‚â§Œµ and ‚à•g(x) ‚àíg(xi)‚à•‚â§Œµ. But
44f(xi) ‚àíŒæœï(i)
44 ‚â§Œµ
and
44g(xi) ‚àíŒæœï(i)
44 ‚â§Œµ; two applications of the triangle inequality show,
in turn, that ‚à•f(xi) ‚àíg(xi)‚à•‚â§2Œµ and ‚à•f(x) ‚àíg(x)‚à•‚â§4Œµ. Since x ‚ààX is
arbitrary, it follows that ‚à•f ‚àíg‚à•‚â§4Œµ; whence diam(Sœï) ‚â§4Œµ.
2
(4.5.9) Exercises
.1
Let X be compact, and let (fn) be a bounded equicontinuous se-
quence of mappings of X into Y. Prove that there exists a subsequence
(fnk)‚àû
k=1 such that (fnk(x))‚àû
k=1 converges for each x ‚ààX. (Let (xn)
be a dense sequence in X. Setting f0,n = fn, construct sequences
(fi,n)‚àû
n=1 (i = 0, 1, . . .) such that for all i and n,
(i) (fi+1, n) is a subsequence of (fi,n) and
(ii) (fi,n(xi))‚àû
n=1 converges in Y.
Then show that (fn,n(x)) converges in Y for each x ‚ààX.)
Use this result to give another proof of the ‚Äúif‚Äù part of Ascoli‚Äôs
Theorem.

212
4. Analysis in Normed Linear Spaces
.2
Let c0, c1 > 0, and let S consist of all diÔ¨Äerentiable functions f :
[0, 1] ‚ÜíR such that ‚à•f‚à•‚â§c0 and ‚à•f ‚Ä≤‚à•‚â§c1. Prove that S is a
compact subset of C[0, 1].
.3
For each positive integer n and each x ‚â•0 let
fn(x) = sin

x + 4n2œÄ2.
Prove that
(i) (fn) is equicontinuous on R0+;
(ii) (fn) converges simply to 0 on R0+;
(iii) (fn) is not totally bounded in C‚àû(R0+).
(For the last part, show that if (fn) were totally bounded, then it
would converge to 0 uniformly on R0+.)
4.6
The Theorems of Weierstrass and Stone
In this section we follow a path from the famous, and widely applicable,
approximation theorem of Weierstrass to its remarkable generalisation by
Stone.
(4.6.1) The Weierstrass Approximation Theorem.
If I is a com-
pact interval in R, then the set of polynomial functions on I is dense in
C(I).
Thus for each f ‚ààC(I) and each Œµ > 0 there exists a polynomial function
p on I such that
‚à•f ‚àíp‚à•= sup {|f(x) ‚àíp(x)| : x ‚ààI} < Œµ.
In other words, each element of C(I) can be uniformly approximated, to
any degree of accuracy, by polynomial functions.
We derive the Weierstrass Approximation Theorem as a simple conse-
quence of a more general theorem about linear operators on C(I).
By a positive linear operator on C(X), where X is any metric space, we
mean a linear mapping L : C(X) ‚ÜíC(X) such that Lf ‚â•0 whenever
f ‚â•0.
In the remainder of this section we let pk denote the monomial function
x ‚Üíxk on R.
(4.6.2) Korovkin‚Äôs Theorem.
Let I be a compact interval in R, and
(Ln) a sequence of positive linear operators on C(I) such that
lim
n‚Üí‚àûLnpk = pk
(k = 0, 1, 2).

4.6 The Theorems of Weierstrass and Stone
213
Then Lnf ‚Üíf for all f ‚ààC(I).
Proof.
For each t in I let gt be the element of C(I) deÔ¨Åned by
gt(x) = (t ‚àíx)2 = t2p0(x) ‚àí2tp1(x) + p2(x).
The linearity of Ln implies that
Lngt = t2Lnp0 ‚àí2tLnp1 + Lnp2 ;
whence
0 ‚â§(Lngt) (t)
= t2 ((Lnp0) (t) ‚àí1) ‚àí2t ((Lnp1) (t) ‚àít) +

(Lnp2) (t) ‚àít2	
‚â§t2 ‚à•Lnp0 ‚àíp0‚à•+ |2t| ‚à•Lnp1 ‚àíp1‚à•+ ‚à•Lnp2 ‚àíp2‚à•.
Since t2 and |2t| are bounded on I, our hypotheses ensure that (Lngt) (t) ‚Üí
0 uniformly on I as n ‚Üí‚àû. We use this observation shortly.
Given f ‚ààC(I) and Œµ > 0, and noting the Uniform Continuity Theorem
(Corollary (3.3.13)), choose Œ¥ > 0 such that if x, y ‚ààI and |x ‚àíy| < Œ¥,
then |f(x) ‚àíf(y)| < Œµ. Fix t in I, and consider any x ‚ààI. If |t ‚àíx| ‚â•Œ¥,
then
|f(t) ‚àíf(x)| ‚â§2 ‚à•f‚à•‚â§2 ‚à•f‚à•(t ‚àíx)2
Œ¥2
= 2
Œ¥2 ‚à•f‚à•gt(x).
It follows from this and our choice of Œ¥ that
|f(t) ‚àíf(x)| ‚â§2
Œ¥2 ‚à•f‚à•gt(x) + Œµ
for all x in I. Hence
‚àíŒµp0 ‚àí2
Œ¥2 ‚à•f‚à•gt ‚â§f(t)p0 ‚àíf ‚â§Œµp0 + 2
Œ¥2 ‚à•f‚à•gt.
Since Ln is linear and positive, we have
‚àíŒµLnp0 ‚àí2
Œ¥2 ‚à•f‚à•Lngt ‚â§f(t) Lnp0 ‚àíLnf ‚â§ŒµLnp0 + 2
Œ¥2 ‚à•f‚à•Lngt.
Hence
|f(t)(Lnp0)(t) ‚àí(Lnf)(t)| ‚â§Œµ ‚à•Lnp0‚à•+ 2
Œ¥2 ‚à•f‚à•(Lngt)(t).
Thus
|f(t) ‚àí(Lnf)(t)|
‚â§|f(t) ‚àíf(t) (Lnp0)(t)| + |f(t) (Lnp0)(t) ‚àí(Lnf)(t)|
‚â§|f(t)| |1 ‚àí(Lnp0)(t)| + Œµ ‚à•Lnp0‚à•+ 2
Œ¥2 ‚à•f‚à•(Lngt)(t)
‚â§‚à•f‚à•‚à•p0 ‚àíLnp0‚à•+ Œµ (‚à•p0‚à•+ ‚à•p0 ‚àíLnp0‚à•) + 2
Œ¥2 ‚à•f‚à•(Lngt)(t).

214
4. Analysis in Normed Linear Spaces
It now follows from our hypotheses, and the observation in the Ô¨Årst
paragraph of the proof, that ‚à•f ‚àíLnf‚à•‚Üí0 as n ‚Üí‚àû.
2
Proof of the Weierstrass Approximation Theorem.
Without loss
of generality, take I = [0, 1]. For each f ‚ààC(I) and each positive integer n
deÔ¨Åne the corresponding Bernstein polynomial Bnf by
(Bnf) (x) =
n

k=0
n
k

xk(1 ‚àíx)n‚àíkf(k/n).
Then Bn is a positive linear operator on C(I). Routine calculations (with
reference to the binomial theorem) show that Bnp0 = p0, that Bnp1 = p1,
and that
(Bnp2) (x) = n ‚àí1
n
x2 + 1
nx ‚Üíx2 as n ‚Üí‚àû.
It follows from Korovkin‚Äôs theorem that limn‚Üí‚àû‚à•f ‚àíBnf‚à•= 0 for each
f ‚ààC(I).
2
(4.6.3) Exercises
.1
Show that there is no loss of generality in our taking I = [0, 1] in the
proof of the Weierstrass Approximation Theorem.
.2
Prove that Bnp0 = p0, that Bnp1 = p1, and that
(Bnp2) (x) = n ‚àí1
n
x2 + 1
nx ‚Üíx2 as n ‚Üí‚àû.
.3
Let f(x) = x3. Calculate Bn(f), and hence prove that Bn(f) ‚Üíf as
n ‚Üí‚àû.
.4
Prove that if p is a polynomial function of degree at most k on [0, 1],
then so is Bn(p) for each n. (Use induction on k.)
.5
Prove that there is only one positive linear operator L on C[0, 1] such
that L(f) = f for all quadratic polynomial functions. (Use Korovkin‚Äôs
Theorem.)
.6
Suppose that f and f ‚Ä≤ belong to C(I), where I is a compact interval.
Prove that for each Œµ > 0 there exists a polynomial function p such
that ‚à•f ‚àíp‚à•< Œµ and ‚à•f ‚Ä≤ ‚àíp‚Ä≤‚à•< Œµ. (Reduce to the case I = [0, 1].
First Ô¨Ånd a polynomial q such that ‚à•f ‚Ä≤ ‚àíq‚à•< Œµ.)
.7
Let I be a compact interval contained in (0, 1). For each f ‚ààC(I)
and each n ‚ààN deÔ¨Åne Qnf on I by
(Qnf) (x) =
n

k=0
5n
k

f(k/n)
6
xk(1 ‚àíx)n‚àík,

4.6 The Theorems of Weierstrass and Stone
215
where ‚åät‚åãdenotes the integer part of t. Prove that ‚à•Bnf ‚àíQnf‚à•‚Üí0
and hence that, on I, f is the uniform limit of a sequence of
polynomials with integer coeÔ¨Écients.
.8
A function f : R ‚ÜíC is said to be periodic if
Œ± = min {œÑ > 0 : ‚àÄt ‚ààR (f(t + œÑ) = f(t))}
exists and is positive, in which case Œ± is called the period of f and f
is also said to be Œ±‚Äìperiodic.
Prove Korovkin‚Äôs Theorem for 2œÄ‚Äìperiodic functions: let I = [‚àíœÄ, œÄ],
let
P(I) = {f ‚ààC(I) : f(‚àíœÄ) = f(œÄ)} ,
and let (Ln) be a sequence of positive linear operators on P(I) such
that Lnf ‚Üíf uniformly as n ‚Üí‚àûfor f = 1, cos, and sin; then
Lnf ‚Üíf uniformly for all f ‚ààP(I). (Write z = cos x and apply
Theorem (4.6.2).)
.9
Although this exercise mentions Fourier series, it does not require any
knowledge of Fourier analysis. Let I = [‚àíœÄ, œÄ]. For each f ‚ààP(I) the
kth partial sum of the Fourier series of f is
(Skf) (x) = a0
2 +
k

n=1
(an cos nx + bn sin nx) ,
where for n ‚â•1,
an = 1
œÄ
$ œÄ
‚àíœÄ
f (t) cos t dt,
bn = 1
œÄ
$ œÄ
‚àíœÄ
f (t) sin t dt.
The nth Ces`aro mean of the Fourier series of f is
Gnf = 1
n
n‚àí1

k=0
Skf.
Prove that
(Gnf) (x) =
1
2nœÄ
$ œÄ
‚àíœÄ
f(t + x)
sin 1
2nt
sin 1
2t
2
dt,
and hence that Gn is a positive linear operator on P(I). Then prove
that for each f ‚ààP(I), (Gnf) converges to f uniformly on I. (Use
the preceding exercise.)

216
4. Analysis in Normed Linear Spaces
The following result, which was proved by M¬®untz in 1914, is an interesting
generalisation of the Weierstrass Approximation Theorem.
Let (Œªn)‚àû
n=1 be a sequence in [1, ‚àû) that diverges to ‚àû. Then
span

1, xŒª1, xŒª2, . . .

is dense in C[0, 1] if and only if the series
‚àû
n=1 1/Œªn diverges to ‚àû.
An elementary proof of M¬®untz‚Äôs Theorem can be found on pages 193‚Äì198
of [10]. Here is a very recent generalisation of M¬®untz‚Äôs Theorem, due to P.
Borwein and T. Erd¬¥elyi [6].
Let (Œªn)‚àû
n=1 be a sequence of distinct positive real numbers.
Then span

1, xŒª1, xŒª2, . . .

is dense in C[0, 1] if and only if
‚àû
n=1 Œªn
#
Œª2
n + 1
	
diverges to ‚àû.
A diÔ¨Äerent, more abstract, generalisation of Theorem (4.6.1) was given
by Stone in 1937. In this generalisation we let X be a compact metric
space; we consider C(X) as an algebra, with the pointwise operations of
addition, multiplication, and multiplication‚Äìby‚Äìscalars; and we are inter-
ested in dense subalgebras of C(X). The property introduced in the next
deÔ¨Ånition plays a key role in the proof of the Stone‚ÄìWeierstrass theorem.
We say that a set A of real‚Äìvalued functions on a metric space X sepa-
rates the points of X if for each pair x, y of distinct points of X there exists
f ‚ààA such that f(x) Ã∏= f(y).
(4.6.4) The Stone‚ÄìWeierstrass Theorem.
Let X be a compact metric
space, and A a subalgebra of C(X) that contains the constant functions and
separates the points of X. Then A is dense in the Banach space C(X).
The next two lemmas lead us to the proof of this theorem.
(4.6.5) Lemma.
Under the hypotheses of Theorem (4.6.4), if œï, œà ‚ààA,
then œï ‚àßœà and œï ‚à®œà belong to the closure of A in C(X).
Proof.
Given f ‚ààA and Œµ > 0, Ô¨Årst apply the Weierstrass Approximation
Theorem (4.6.1) to construct a polynomial function p such that
| |t| ‚àíp(t)| < Œµ
(0 ‚â§t ‚â§‚à•f‚à•).
Then
| |f(x)| ‚àíp ‚ó¶f(x)| < Œµ
(x ‚ààX).
Since Œµ is arbitrary, we see that |f| ‚ààA. The desired conclusion now follows
by taking f = |œï ‚àíœà| and noting the identities
œï ‚àßœà = 1
2 (œï + œà ‚àí|œï ‚àíœà|) ,
œï ‚à®œà = 1
2 (œï + œà + |œï ‚àíœà|) .
2

4.6 The Theorems of Weierstrass and Stone
217
(4.6.6) Lemma.
Under the hypotheses of Theorem (4.6.4), for each pair
x, y of distinct points of X and each pair a, b of real numbers, there exists
g ‚ààA such that g(x) = a and g(y) = b.
Proof.
Since A separates the points of X, there exists h ‚ààA such that
h(x) Ã∏= h(y). DeÔ¨Åne
g(t) = a + (b ‚àía) h(t) ‚àíh(x)
h(y) ‚àíh(x).
Since A contains the constant functions and is an algebra, g ‚ààA . Clearly,
g(x) = a and g(y) = b.
2
Proof of the Stone‚ÄìWeierstrass Theorem.
Given f ‚ààC(X) and
Œµ > 0, we need only show that there exists h ‚ààA such that ‚à•f ‚àíh‚à•< Œµ.
To this end, for each g in A deÔ¨Åne
U(g) = {x ‚ààX : g(x) < f(x) + Œµ} ,
L(g) = {x ‚ààX : g(x) > f(x) ‚àíŒµ} ,
and note that, as g is continuous, U(g) and L(g) are open sets. It follows
from Lemma (4.6.6) that for each t ‚ààX the sets U(g), with g ‚ààA and
g(t) = f(t), form an open cover of X. Since X is compact, we can extract
a Ô¨Ånite subcover {U(g1), . . . , U(gn)} of X. DeÔ¨Åne
ht = g1 ‚àßg2 ‚àß¬∑ ¬∑ ¬∑ ‚àßgn.
Then ht ‚ààA, by Lemma (4.6.5); ht(x) < f(x) + Œµ for each x ‚ààX; and
ht(t) = f(t), so t ‚ààL(ht). Thus (L(ht))t‚ààX is an open cover of X, from
which we can extract a Ô¨Ånite subcover, say {L(ht1), . . . , L(htm)} . Then the
function
h = ht1 ‚à®ht2 ‚à®¬∑ ¬∑ ¬∑ ‚à®htm
belongs to A, by Lemma (4.6.5); also,
f(x) ‚àíŒµ < h(x) < f(x) + Œµ
for each x ‚ààX, so ‚à•f ‚àíh‚à•< Œµ.
2
It is simple to verify that the Weierstrass Approximation Theorem is
the special case of the Stone‚ÄìWeierstrass Theorem in which the algebra A
consists of all polynomial functions on the compact interval I. Since the
polynomial functions on I with rational coeÔ¨Écients form a countable dense
set in this algebra A, we see that C(I) is a separable metric space; this is a
special case of the following more general corollary of the Stone‚ÄìWeierstrass
Theorem.

218
4. Analysis in Normed Linear Spaces
(4.6.7) Corollary.
If X is a compact metric space, then the Banach
space C(X) is separable.
Proof.
Let (xn) be a dense sequence in X, and for each positive integer
k write
fn,k(t) = œÅ(t, X\B(xn, k‚àí1)).
The set S of all functions of the form
f Œ±1
n1,k1f Œ±2
n2,k2 ¬∑ ¬∑ ¬∑ f Œ±i
ni,ki,
with each Œ±k a nonnegative integer, is countable. Hence the subspace A of
C(X) generated by S is separable (see the paragraph immediately preceding
Proposition (4.3.8)). So to complete the proof we need only show that A is
dense in C(X). Since A is a subalgebra of C(X), if S separates the points
of X we can invoke the Stone‚ÄìWeierstrass Theorem. But for each pair x, y
of distinct points of X we can choose n, k such that x ‚ààB(xn, k‚àí1) and
y ‚ààX\B(xn, k‚àí1). We then have fn,k(x) Ã∏= 0 (as X\B(xn, k‚àí1) is closed)
and fn,k(y) = 0.
2
(4.6.8) Exercises
.1
Let f be a strictly increasing continuous function on I = [0, 1]. Prove
that the subalgebra of C(I) generated by {1, f} is dense in C(I).
.2
Let X be a compact metric space containing at least two points, and
let A be the subalgebra of C(X) generated by the family
(t ‚ÜíœÅ(t, x))x‚ààX .
Prove that A is dense in C(X).
.3
DeÔ¨Åne a sequence (un) of polynomial functions on R inductively, as
follows.
u1(t)
=
0,
un+1(t)
=
un(t) + 1
2

t ‚àíun(t)2	
.
Prove that un maps [0, 1] into [0, 1], and that the sequence (un(t))‚àû
n=1
converges uniformly to
‚àö
t on [0, 1]. Hence prove that if A is a
subalgebra of C[0, 1] and f ‚ààA, then |f| ‚ààA.
This proof can be used to eliminate the reference to the Weierstrass
Approximation Theorem from the proof of the Stone‚ÄìWeierstrass
Theorem, thereby making the former a genuine corollary of the latter.
.4
Let I be a compact interval in R, and f a continuous mapping of
the rectangle I √ó I into R. Prove that for each Œµ > 0 there exists a
polynomial
p(x, y) =
n

j,k=0
aj,kxjyk

4.7 Fixed Points and DiÔ¨Äerential Equations
219
such that
sup
x,y‚ààI
|f(x, y) ‚àíp(x, y)| < Œµ.
.5
Prove the Complex Stone‚ÄìWeierstrass Theorem: let X be a compact
metric space, and A a subalgebra of C(X,C) that contains the con-
stant functions, separates the points of X, and is closed under com-
plex conjugation (so that f ‚àó‚ààA whenever f ‚ààA, where f ‚àó(x) =
f(x)‚àó); then A is dense in C(X, C).
Can we remove the hypothesis that A is closed under complex
conjugation?
.6
Use the Stone‚ÄìWeierstrass Theorem to prove that each 2œÄ‚Äìperiodic
continuous function f : R ‚ÜíC is a uniform limit of a sequence of
trigonometric polynomials of the form
t ‚Üí
N

n=‚àíN
(an sin nt + bn cos nt) ,
where the coeÔ¨Écients an, bn belong to C (cf. Exercise (4.6.3: 9). Let
S be the set of 2œÄ-periodic elements of C‚àû(R, C). First note that
F(eit) = f(t)
deÔ¨Ånes an isometric isomorphism of S with C(T, C), where
T = {z ‚ààC : |z| = 1}
is the unit circle in the complex plane.)
.7
Let I be a compact interval, and p ‚â•1. Prove that the Banach space
Lp(I) is separable. Prove also that Lp(R) is separable. (First use
Exercise (2.3.10) to prove that C(I) is dense in Lp(I).)
4.7
Fixed Points and DiÔ¨Äerential Equations
In this Ô¨Ånal section of the chapter we show how various ideas that have
appeared in the earlier sections are used to establish the existence of a so-
lution œï of the Ô¨Årst‚Äìorder ordinary diÔ¨Äerential equation œï‚Ä≤(x) = f(x, œï(x))
on a compact interval. In order to do this, we Ô¨Årst introduce a fundamental
Ô¨Åxed‚Äìpoint theorem.
Let X and Y be metric spaces, and f a mapping of X into Y . We say
that f satisÔ¨Åes a Lipschitz condition, or is a Lipschitz mapping, if there
exists a constant c > 0 such that œÅ(f(x), f(y)) ‚â§c œÅ(x, y) for all x, y in X;
c is then called a Lipschitz constant for f, and f is said to be Lipschitz

220
4. Analysis in Normed Linear Spaces
of order c. In the special case where 0 < c < 1, f is called a contraction
mapping of X into Y.
A Lipschitz map is uniformly continuous (Exercise (3.2.11: 6)).
A mapping of a metric space X into itself is called a self‚Äìmap. By a Ô¨Åxed
point of a self‚Äìmap f : X ‚ÜíX we mean a point Œæ ‚ààX such that f(Œæ) = Œæ.
(4.7.1)
Exercises
.1
Let
p(x, y) =
n

j,k=0
aj,kxjyk
be a polynomial function of two variables x, y. Prove that p satisÔ¨Åes
a Lipschitz condition on any bounded subset of R2.
.2
Let f be a mapping of a metric space X into itself, and deÔ¨Åne the
iterates of f inductively: for each x ‚ààX,
f n(x) =
Ô£±
Ô£≤
Ô£≥
x
if n = 0
f(f n‚àí1(x))
if n ‚ààN+.
Prove that if, for some positive integer N, f N has a unique Ô¨Åxed point
Œæ, then Œæ is a Ô¨Åxed point of f, and f has no other Ô¨Åxed point.
Fixed points play an important role in many applications of mathemat-
ics, including the solution of diÔ¨Äerential equations and the existence of
economic equilibria [51]. Many of these applications depend on our next
result, Banach‚Äôs Contraction Mapping Theorem.
(4.7.2) Theorem.
A contraction mapping of a nonempty complete
metric space into itself has a unique Ô¨Åxed point.
Proof.
Let X be a nonempty complete metric space, f a contraction
mapping of X into itself, and c ‚àà(0, 1) a Lipschitz constant for f. Choose x0
in X, and deÔ¨Åne a sequence (xn)‚àû
n=1 inductively by setting xn = f(xn‚àí1).
For each k ‚â•1 we have
œÅ(xk, xk+1) = œÅ(f(xk‚àí1), f(xk))
‚â§c œÅ(xk‚àí1, xk)
‚â§¬∑ ¬∑ ¬∑
‚â§ckœÅ(x0, x1).

4.7 Fixed Points and DiÔ¨Äerential Equations
221
So if m > n ‚â•1, then
œÅ(xn, xm) ‚â§
m‚àí1

k=n
œÅ(xk, xk+1)
‚â§
m‚àí1

k=n
ckœÅ(x0, x1)
‚â§œÅ(x0, x1)
‚àû

k=n
ck
= œÅ(x0, x1) cn
1 ‚àíc ‚Üí0 as n ‚Üí‚àû.
Hence (xn) is a Cauchy sequence in the complete space X. Let Œæ be its
limit in X; then
Œæ = lim
n‚Üí‚àûxn = lim
n‚Üí‚àûf(xn‚àí1) = f(Œæ).
Thus Œæ is a Ô¨Åxed point of f.
Now suppose that Œ∑ is a Ô¨Åxed point of f distinct from Œæ. Then
œÅ(Œæ, Œ∑) = œÅ(f(Œæ), f(Œ∑)) ‚â§c œÅ(Œæ, Œ∑) < œÅ(Œæ, Œ∑),
which is absurd. Hence Œæ is the unique Ô¨Åxed point of f in X.
2
Recall that a self‚Äìmap f of a metric space X is said to be contractive
if œÅ(f(x), f(y)) < œÅ(x, y) for all distinct x, y in X; and that, according to
Edelstein‚Äôs Theorem (Exercise (3.3.7: 4)), a contractive self‚Äìmap of a com-
pact metric space has a unique Ô¨Åxed point. The next exercise shows that we
can neither remove the compactness hypothesis from Edelstein‚Äôs Theorem
nor replace the word ‚Äúcontraction‚Äù by ‚Äúcontractive‚Äù in the hypotheses of
Banach‚Äôs Contraction Mapping Theorem.
(4.7.3) Exercises
.1
Let B be the unit ball in the Banach space c0, and for each positive
integer n let en be the element of c0 whose nth term is 1 and all of
whose other terms are 0. Show that there is a unique linear mapping
u : c0 ‚Üíc0 such that
u(en) =

1 ‚àí1
2n

en+1
for each n. Then show that
v(x) = 1
2 (1 + ‚à•x‚à•) e1 + u(x)
deÔ¨Ånes a contractive map of B into itself such that v(x) Ã∏= x for each
x ‚ààB. (For the last part note that 2n
k=1

1 ‚àí2‚àík	
‚â•1‚àín
k=1 2‚àík.)

222
4. Analysis in Normed Linear Spaces
.2
Let X, Y be Banach spaces over F, U the open ball in X with centre
0 and radius a, and V the open ball in Y with centre 0 and radius b.
Let 0 ‚â§c < 1, and let œï : U √ó V ‚ÜíY be a continuous mapping such
that for all x ‚ààU,
(i) ‚à•œï(x, y1) ‚àíœï(x, y2)‚à•‚â§c ‚à•y1 ‚àíy2‚à•for all y1, y2 ‚ààV , and
(ii) ‚à•œï(x, 0)‚à•< b (1 ‚àíc) .
Show that there exists a unique mapping f : U ‚ÜíV such that
f(x) = œï(x, f(x)) for all x ‚ààU, and that f is continuous on U. (For
each x ‚ààU deÔ¨Åne
f0(x)
=
0,
fn+1(x)
=
œï(x, fn(x)).
Show that fn is a continuous mapping of U into V, that the series
‚àû
n=1 (fn ‚àífn‚àí1) converges absolutely in the Banach space B(U, F),
and that its sum is the required function f.)
.3
Let Y be a Banach space, y0 ‚ààY, V = B(y0, b) ‚äÇY, and 0 ‚â§c < 1.
Let v be a mapping of V into Y such that
(i) ‚à•v(y1) ‚àív(y2)‚à•‚â§c ‚à•y1 ‚àíy2‚à•for all y1, y2 ‚ààV, and
(ii) ‚à•v(y0) ‚àíy0‚à•< b(1 ‚àíc).
Prove that v has a unique Ô¨Åxed point in V.
.4
Let X be a metric space such that each continuous self‚Äìmap of a
closed subset of S has a Ô¨Åxed point. Prove that X is complete. (Sup-
pose the contrary, and choose a Cauchy sequence (xn) in X that does
not converge in X. Assuming, without loss of generality, that xi Ã∏= xj
whenever i Ã∏= j, for each x ‚ààX let
Œ±x = inf {œÅ(x, xn) : x Ã∏= xn} .
Show that Œ±x > 0. Next, let 0 < r < 1, set œÉ(0) = 0, and deÔ¨Åne œÉ(n)
inductively such that œÉ(n) > œÉ(n ‚àí1) and
œÅ(xi, xj) ‚â§rŒ±xœÉ(n‚àí1)
(i, j ‚â•œÉ(n)).
Let S =

xœÉ(n) : n ‚â•1

and f(xœÉ(n)) = xœÉ(n+1).)
.5
Let a, b be real numbers with 0 < b < 1, and let X be the set of all
continuous mappings f : [0, b] ‚ÜíR such that f(0) = a (so, according
to Exercise (4.5.6: 6), X is a Banach space relative to the sup norm).
DeÔ¨Åne a mapping T on X by
(Tf)(t) = a +
$ t
0
|f(x)| dx
(0 ‚â§t ‚â§b).

4.7 Fixed Points and DiÔ¨Äerential Equations
223
Prove that T is a contraction mapping of X into itself, and hence
that there exists a unique f ‚ààX that is diÔ¨Äerentiable and satisÔ¨Åes
f ‚Ä≤ = |f| on the interval (0, b).
A function œï is said to be continuously diÔ¨Äerentiable on an interval I of
R if œï‚Ä≤ exists and is continuous on I.
We now use Theorem (4.7.2) to prove the Ô¨Årst of two theorems about the
existence of solutions of ordinary diÔ¨Äerential equations, thereby generalising
the work of Exercise (4.7.3: 5).
(4.7.4) Picard‚Äôs Theorem.
Let K be the rectangle

(x, y) ‚ààR2 : |x ‚àíx0| ‚â§a, |y ‚àíy0| ‚â§b

where a, b > 0. Let f : K ‚ÜíR be a continuous mapping such that there
exists c > 0 with
|f(x, y1) ‚àíf(x, y2)| ‚â§c |y1 ‚àíy2|
for all applicable x, y1, y2 (in other words, f satisÔ¨Åes a Lipschitz condition
in its second variable). Let
M =
sup
(x,y)‚ààK
|f(x, y)|
and
h =
Ô£±
Ô£≤
Ô£≥
min

a, b
M

if M > 0
a
if M = 0.
Then there exists a unique continuously diÔ¨Äerentiable mapping œï on the
interval I = [x0 ‚àíh, x0 + h], such that
œï(x0) = y0
and
œï‚Ä≤(x) = f(x, œï(x)) for all x ‚ààI.
Proof.
In view of the version of the Fundamental Theorem of Calculus
in Exercise (1.5.14: 1), it suÔ¨Éces to Ô¨Ånd a continuous mapping œï : I ‚ÜíR
satisfying
œï(x) = y0 +
$ x
x0
f(t, œï(t)) dt
(1)
for all x ‚ààI. Let V denote the closed ball with centre y ‚Üíy0 and radius b
in the Banach space (C(I), ‚à•¬∑‚à•) , where ‚à•¬∑‚à•denotes the sup norm. If y ‚ààV,
then for all t ‚ààI we have |y(t) ‚àíy0| ‚â§b and therefore (t, y(t)) ‚ààK; so
Fy(x) = y0 +
$ x
x0
f(t, y(t)) dt

224
4. Analysis in Normed Linear Spaces
deÔ¨Ånes a mapping Fy : I ‚ÜíR. We see from Exercise (1.5.12: 4) that Fy
satisÔ¨Åes the Lipschitz condition
|Fy(x) ‚àíFy(x‚Ä≤)| =
    
$ x
x‚Ä≤ f(t, y(t)) dt
    ‚â§M |x ‚àíx‚Ä≤|
and is therefore uniformly continuous on I. Moreover,
|Fy(x) ‚àíy0| ‚â§M |x ‚àíx0| ‚â§Mh ‚â§b
for all x ‚ààI, so y ‚ÜíFy maps V into V.
We now endow C(I) not with its usual norm, but with the norm deÔ¨Åned
by
‚à•f‚à•‚Ä≤ = sup

e‚àí2c|x‚àíx0| |f(x)| : x ‚ààI

.
Recall from Exercise (4.5.6: 7) that C(I), and hence V, is complete with
respect to the metric œÅ‚Ä≤ associated with this norm. We prove that y ‚ÜíFy
is a contraction mapping on (V, œÅ‚Ä≤) . To this end, consider y1, y2 ‚ààV and
x ‚ààI. Taking, for example, the case where x ‚â•x0, we have
|Fy1(x) ‚àíFy2(x)| ‚â§
$ x
x0
|f(t, y1(t)) ‚àíf(t, y2(t))| dt
‚â§c
$ x
x0
|y1(t) ‚àíy2(t)| dt
‚â§c ‚à•y1 ‚àíy2‚à•‚Ä≤
$ x
x0
e2c|t‚àíx0| dt
< 1
2e2c|x‚àíx0| ‚à•y1 ‚àíy2‚à•‚Ä≤ ,
since
$ x
x0
e2c(t‚àíx0) dt = 1
2c

e2c(x‚àíx0) ‚àí1

.
It follows that
‚à•Fy1 ‚àíFy2‚à•‚Ä≤ < 1
2 ‚à•y1 ‚àíy2‚à•‚Ä≤
(y1, y2 ‚ààC(I)).
Applying Banach‚Äôs Contraction Mapping Theorem (4.7.2), we now obtain
a unique element œï of V satisfying equation (1).
2
A restricted version of Picard‚Äôs Theorem can be proved by applying the
Contraction Mapping Theorem to a certain complete subset of C(I), taken
with the usual sup norm; this produces a positive number Œ¥, which may be
smaller than h, and a solution of the diÔ¨Äerential equation on the interval
[x0 ‚àíŒ¥, x0 + Œ¥]. (See Chapter X of [13].) With a bit more work, it can
then be shown that that solution extends to I (Exercise (4.7.5: 4)). The

4.7 Fixed Points and DiÔ¨Äerential Equations
225
introduction of the norm ‚à•¬∑‚à•‚Ä≤ ‚Äîa device due to Bielicki [4]‚Äîboth simpliÔ¨Åes
the proof and provides, at a stroke, the solution over the whole interval
I. (Note that when f is only known to be deÔ¨Åned on K, I is the largest
interval on which it makes sense to talk about a solution of the diÔ¨Äerential
equation y‚Ä≤ = f(x, y).)
By examining closely the proofs of Theorems (4.7.2) and (4.7.4), we
obtain the following iteration scheme for a sequence (yn) of functions
converging to a solution of the diÔ¨Äerential equation in the preceding
theorem.
y0(x)
=
y0,
yn(x)
=
y0 +
$ x
x0
f(t, yn‚àí1(t)) dt
(n ‚â•1).
This scheme can be used in practice, although there are better methods of
Ô¨Ånding solutions of Ô¨Årst‚Äìorder diÔ¨Äerential equations of special types.
(4.7.5) Exercises
.1
Apply the foregoing iteration scheme to solve the diÔ¨Äerential equation
y‚Ä≤ = y on R with initial condition y (0) = 3.
.2
Let
K =

(x, y) ‚ààR2 : |x| ‚â§a, |y| ‚â§b

,
where a, b are positive constants. Let f be a continuous mapping of
K into R such that f(x, y) < 0 if xy > 0, and f(x, y) > 0 if xy < 0.
Prove that x ‚Üí0 is the unique solution of the diÔ¨Äerential equation
y‚Ä≤ = f(x, y) deÔ¨Åned in a neighbourhood of 0 and such that y(0) = 0.
(Assume the contrary, and consider, in a compact interval containing
0, the points where a solution attains its maximum or minimum.)
.3
DeÔ¨Åne f : R2 ‚ÜíR by
f(x, y) =
Ô£±
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£≤
Ô£¥
Ô£¥
Ô£¥
Ô£¥
Ô£≥
‚àí2x
if y ‚â•x2
‚àí2y
x
if |y| < x2
2x
if y ‚â§‚àíx2.
DeÔ¨Åne a sequence of functions by setting y0(x) = x2 and
yn+1(x) =
$ x
0
f(t, yn(t)) dt.
Show that for each x Ã∏= 0 the sequence (yn(x))‚àû
n=0 is not convergent.
Comment on this, in the light of Exercise (4.7.5: 2) and the paragraph
immediately preceding this set of exercises.

226
4. Analysis in Normed Linear Spaces
.4
Let x0, y0, I, and K be as in Theorem (4.7.4), and let f : K ‚ÜíR be a
continuous function with the following property: for each (Œæ, Œ∑) ‚ààK‚ó¶
there exist Œ¥ > 0 and a unique continuously diÔ¨Äerentiable function
y : [Œæ ‚àíŒ¥, Œæ + Œ¥] ‚ÜíR such that y(Œæ) = Œ∑ and y‚Ä≤(x) = f(x, y(x))
whenever |x ‚àíŒæ| ‚â§Œ¥. Show that there exists a unique continuously
diÔ¨Äerentiable function œï : I ‚ÜíR such that œï(x0) = y0 and œï‚Ä≤(x) =
f(x, œï(x)) for all x ‚ààI. (Let S be the set of all positive numbers
Œ¥ ‚â§h with the property that there exists a continuously diÔ¨Äerentiable
function y : [x0 ‚àíŒ¥, x0 + Œ¥] ‚ÜíR such that y(x0) = y0 and y‚Ä≤(x) =
f(x, y(x)) whenever |x ‚àíx0| ‚â§Œ¥. Let œÉ = sup S, suppose that œÉ < h,
and derive a contradiction.)
.5
Let I be the closed interval [a, b] in R, and
A =

(x, y) ‚ààR2 : a ‚â§x ‚â§y ‚â§b

.
Let the function k : I √ó I ‚ÜíR be continuous on A and vanish
everywhere on (I √ó I)\A, and for each f ‚ààC(I) deÔ¨Åne Tf : I ‚ÜíR
by
Tf(t) =
$ t
a
k(s, t)f(s) ds
(t ‚ààI).
Show that for all suÔ¨Éciently large n, T n is a contraction mapping of
C(I) into itself, and hence that the integral equation
f(t) = g(t) +
$ t
a
k(s, t)f(s) ds,
has a unique solution f in C(I) for each given g ‚ààC(I). (For the
contraction mapping part, show that
|T nf(x) ‚àíT ng(x)| ‚â§M n
n! (x ‚àía)n ‚à•f ‚àíg‚à•
for all x ‚ààI and f, g ‚ààC(I).)
.6
Taking I = [0, 1], use the preceding exercise to Ô¨Ånd the solution of
the integral equation
f(t) = g(t) + c
$ t
0
(t ‚àís)3f(s) ds
(t ‚ààI),
where c is a positive constant and g ‚ààC(I).
.7
Let c > 0, let f be a continuous real‚Äìvalued mapping that satisÔ¨Åes
the condition
|f(x, y1) ‚àíf(x, y2)| ‚â§c |y1 ‚àíy2|

4.7 Fixed Points and DiÔ¨Äerential Equations
227
on the strip [a, b] √ó R in R2, and let (x0, y0) be any point of that
strip. Prove that the diÔ¨Äerential equation y‚Ä≤ = f(x, y) has a unique
solution y : [a, b] ‚ÜíR such that y(x0) = y0. (For each x ‚àà[a, b]
deÔ¨Åne y0(x) = y0 and
yn+1(x) = y0 +
$ x
x0
f(t, yn(t)) dt.
Let
M = |y0| + max {|y1(x)| : a ‚â§x ‚â§b} .
Show that the series
y0 +
‚àû

n=1
(yn(x) ‚àíyn‚àí1(x))
converges uniformly on [a, b] to a sum y(x), by comparison with the
series
M +
‚àû

n=1
cn‚àí1M (b ‚àía)n‚àí1
(n ‚àí1)! .
Then show that y is the desired unique solution.)
.8
Let K be the compact set
{(x, y) ‚ààR √ó Rn : |x ‚àíx0| ‚â§a, ‚à•y ‚àíy0‚à•‚â§b} ,
where a, b > 0. Let f = (f1, . . . , fn) be a continuous mapping of K
into Rn such that there exists c > 0 with
|f(x, y1) ‚àíf(x, y2)| ‚â§c ‚à•y1 ‚àíy2‚à•
for all applicable x, y1, y2. Let
M =
sup
(x,y)‚ààK
‚à•f(x, y)‚à•
and
h =
Ô£±
Ô£≤
Ô£≥
min

a, b
M

if M > 0
a
if M = 0.
Prove that there exists a unique mapping œï = (œï1, . . . , œïn) of the
interval I = [x0 ‚àíh, x0 + h] into Rn, such that
(i) œï(x0) = y0, and
(ii) for each k the component mapping œïk is continuously diÔ¨Äeren-
tiable and satisÔ¨Åes œï‚Ä≤
k(x) = fk(x, œï(x)) on I.

228
4. Analysis in Normed Linear Spaces
.9
Let p, q, and r be continuous real‚Äìvalued functions on the interval
[a, b] , let x0 ‚àà[a, b] , and let y0, y‚Ä≤
0 be real numbers. Use the preceding
exercise to prove that there exists a unique function y : [a, b] ‚ÜíR
satisfying the diÔ¨Äerential equation
y‚Ä≤‚Ä≤ + p(x)y‚Ä≤ + q(x) = r(x)
on [a, b], with initial conditions y(x0) = y0 and y‚Ä≤(x0) = y‚Ä≤
0.
Although Picard‚Äôs Theorem enables us to solve, both in principle and in
practice, a large class of diÔ¨Äerential equations, there are simple examples of
diÔ¨Äerential equations to which it does not apply and yet for which solutions
can easily be found. One such example is the equation y‚Ä≤ = y1/3 with initial
condition y(0) = 0: this equation has two solutions‚Äînamely, y = 0 and
y = (2x/3)3/2 ‚Äîbut the function (x, y) ‚Üíy1/3 does not satisfy a Lipschitz
condition at (0, 0). The Ô¨Ånal theorem of this chapter covers cases such as
this, and provides us with a good application of Ascoli‚Äôs Theorem and the
Stone‚ÄìWeierstrass Theorem.
(4.7.6) Peano‚Äôs Theorem.
Let K be the rectangle

(x, y) ‚ààR2 : |x ‚àíx0| ‚â§a, |y ‚àíy0| ‚â§b

,
where a, b > 0. Let f : K ‚ÜíR be a continuous mapping,
M =
sup
(x,y)‚ààK
|f(x, y)|
and
h =
Ô£±
Ô£≤
Ô£≥
min

a, b
M

if M > 0
a
if M = 0.
Then there exists a continuously diÔ¨Äerentiable mapping œï on the interval
I = [x0 ‚àíh, x0 + h], such that
œï(x0) = y0
and
œï‚Ä≤(x) = f(x, œï(x)) for all x ‚ààI.
Proof.
Using Exercise (4.6.8: 4), construct a sequence (pn) of polynomial
functions of two variables such that ‚à•f ‚àípn‚à•‚â§2‚àín for each n, where ‚à•¬∑‚à•
denotes the sup norm on C(K). We may assume that |pn| ‚â§2M for each n.
By Exercise (4.7.1: 1), Picard‚Äôs Theorem, and the Fundamental Theorem
of Calculus, the integral equation
y(x) = y0 +
$ x
x0
pn(t, y(t)) dt

4.7 Fixed Points and DiÔ¨Äerential Equations
229
has a unique solution œïn on the interval I. Exercise (1.5.12: 4) shows that
for all x1, x2 ‚ààI,
|œïn(x2) ‚àíœïn(x1)| ‚â§
    
$ x2
x1
pn(t, œïn(t)) dt
    ‚â§2M |x2 ‚àíx1| .
It follows that (œïn) is an equicontinuous sequence in C(I). Also, for each
x ‚ààI,
|œïn(x)| ‚â§|y0| +
    
$ x
x0
pn(t, œïn(t)) dt
    ‚â§|y0| + 2M |I| ;
so (œïn) is a bounded sequence in C(I). Applying Ascoli‚Äôs Theorem (4.5.8),
and, if necessary, passing to a subsequence of (œïn), we may now assume
that (œïn) converges uniformly on I to an element œï of C(I). Since f is
uniformly continuous on K, for each Œµ > 0 there exists t > 0 such that if
(xi, yi) ‚ààK and
max {|x1 ‚àíx2| , |y1 ‚àíy2|} < t,
then
|f(x1, y1) ‚àíf(x2, y2)| < Œµ.
Choose N such that for all n ‚â•N,
‚à•œï ‚àíœïn‚à•< min {t, Œµ}
and 2‚àín < Œµ. Consider any x ‚ààI and any n ‚â•N. Note that for each t ‚ààI,
(t, œï(t)) belongs to the closed set K and
|f(t, œï(t)) ‚àíf(t, œïn(t))| < Œµ.
We now have
    
$ x
x0
f(t, œï(t)) dt ‚àí
$ x
x0
f(t, œïn(t)) dt
    ‚â§Œµ |x ‚àíx0| < |I| Œµ
and therefore
    œï(x) ‚àíy0 ‚àí
$ x
x0
f(t, œï(t)) dt
    ‚â§|œï(x) ‚àíœïn(x)|
+
    œïn(x) ‚àíy0 ‚àí
$ x
x0
pn(t, œïn(t)) dt
    
+
    
$ x
x0
(pn(t, œïn(t)) ‚àíf(t, œïn(t))) dt
    
+
    
$ x
x0
(f(t, œïn(t)) ‚àíf(t, œï(t))) dt
    
< Œµ + 0 + |I| ‚à•f ‚àípn‚à•+ |I| Œµ
= (1 + 2 |I|) Œµ.

230
4. Analysis in Normed Linear Spaces
Since Œµ > 0 is arbitrary, we conclude that
œï(x) = y0 +
$ x
x0
f(t, œï(t)) dt
(x ‚ààI).
A Ô¨Ånal application of the Fundamental Theorem of Calculus (see Exer-
cise (1.5.14: 1)) shows that œï is continuously diÔ¨Äerentiable and satisÔ¨Åes the
desired conditions.
2
There are two fundamental diÔ¨Äerences between Picard‚Äôs Theorem and
Peano‚Äôs:
‚Ä¢ in the former the solution is unique, whereas in the latter it need not
be;
‚Ä¢ the proof of Picard‚Äôs Theorem embodies an algorithm for com-
puting the solution, but Peano‚Äôs Theorem uses the highly noncon-
structive property of sequential compactness and is an intrinsically
nonalgorithmic theorem.
By an Œµ‚Äìapproximate solution to the diÔ¨Äerential equation
y‚Ä≤ = f(x, y),
y(x0) = y0
(2)
in an interval J containing x0 we mean a mapping y : J ‚ÜíR with the
following properties.
‚Äî There exists a partition (x1, x2, . . . , xn) of J such that y is continu-
ously diÔ¨Äerentiable on each of the intervals [xi, xi+1] ;
‚Äî |y‚Ä≤(x) ‚àíf(x, y(x))| ‚â§Œµ for all x ‚ààn‚àí1
i=1 (xi, xi+1) ;
‚Äî y(x0) = y0.
(4.7.7) Exercises
.1
Under the hypotheses of Theorem (4.7.6), but without invoking that
theorem, show that for each Œµ > 0 there exists an Œµ-approximate
solution of (2). (Choose Œ¥ > 0 such that |f(x1, y1) ‚àíf(x2, y2)| ‚â§Œµ
whenever (xi, yi) ‚ààK and ‚à•(x1, y1) ‚àí(x2, y2)‚à•‚â§Œ¥. Take points x0 <
x1 < ¬∑ ¬∑ ¬∑ < xn = x0 + h such that xi+1 ‚àíxi ‚â§min {Œ¥, Œ¥/M} , and
construct an Œµ‚Äìapproximate solution of (2) on [x0, x0 + h] that is
linear on each of the intervals [xi, xi+1] ; then deal with the interval
[x0 ‚àíh, x0]. This technique is known as the Cauchy‚ÄìEuler method.)
.2
Under the hypotheses of Theorem (4.7.6), let (Œµn) be a sequence of
positive numbers converging to 0, and for each n let œïn be an Œµn‚Äì
approximate solution of the diÔ¨Äerential equation (2) on I. Suppose
that (œïn) converges uniformly to a continuous function œï on I. Prove
that

4.7 Fixed Points and DiÔ¨Äerential Equations
231
(i) (t, œï(t)) ‚ààK for each t ‚ààI ;
(ii)
% x
x0 f(t, œïn(t)) dt ‚Üí
% x
x0 f(t, œï(t)) dt uniformly on I as n ‚Üí‚àû;
(iii) œï is a solution of the diÔ¨Äerential equation (2) on I.
.3
Use the preceding two exercises to give an alternative proof of Peano‚Äôs
Theorem.
.4
Let I, K, f, M, and c be as in the hypotheses of Picard‚Äôs Theorem. Let
Œµ1, Œµ2 > 0, and let œïi be an Œµi‚Äìapproximate solution to the diÔ¨Äerential
equation on I. Show that
|œï1(x) ‚àíœï2(x)| ‚â§|œï1(x0) ‚àíœï2(x0)| ec|x‚àíx0| + (Œµ1 + Œµ2) ec|x‚àíx0| ‚àí1
c
for each x ‚ààI. (Use Exercise (2.3.3: 14).) Hence Ô¨Ånd an alternative
proof of Picard‚Äôs Theorem.

5
Hilbert Spaces
When shall we three meet again...?
Macbeth, Act 1, Scene 1
This chapter explores the elementary theory of Hilbert spaces. In Section 1 we
introduce the notion of an inner product, with its associated norm, on a linear
space, and prove some fundamental inequalities. The next section deals with
orthogonality, projections, and orthonormal bases in a Hilbert space, and with
their use in approximation theory. In Section 3 we derive Riesz‚Äôs characterisation
of the bounded linear functionals on a Hilbert space, and show how this can
be applied both in the theory of operators and to prove the existence of weak
solutions of the Dirichlet Problem.
5.1
Inner Products
So far we have shown how to abstract the notions of distance and length
from Euclidean space to the abstract contexts of a metric space and a
normed space, respectively. In this chapter we show how to abstract the no-
tion of the inner product in Rn to the context of a linear space. The result-
ing combination of distance, length, and inner product provides the space
with an extremely rich structure that turns out to have many signiÔ¨Åcant
applications in pure and applied mathematics. In particular‚Äîalthough we
are not able to explore that subject in this book‚Äîcertain linear self‚Äìmaps
of such a space are the mathematical analogues of quantum‚Äìmechanical
operations.

234
5. Hilbert Spaces
By an inner product on a linear space X over F we mean a mapping
(x, y) ‚Üí‚ü®x, y‚ü©of X √ó X into F such that the following hold for all x, y, z
in X and all Œª, ¬µ in F.
IP1
‚ü®x, y‚ü©= ‚ü®y, x‚ü©‚àó.
IP2
‚ü®Œªx + ¬µy, z‚ü©= Œª‚ü®x, z‚ü©+ ¬µ‚ü®y, z‚ü©.
IP3
‚ü®x, x‚ü©‚â•0, and ‚ü®x, x‚ü©= 0 if and only if x = 0.
The element ‚ü®x, y‚ü©of F is then called the inner product of the vectors x
and y. Note that by IP2, the inner product is linear in the Ô¨Årst variable;
and that by IP2 and IP1, it is conjugate linear in the second‚Äîthat is,
‚ü®x, Œªy + ¬µz‚ü©= Œª‚àó‚ü®x, y‚ü©+ ¬µ‚àó‚ü®x, z‚ü©.
We deÔ¨Åne an inner product space, or a prehilbert space, to be a pair
(X, ‚ü®¬∑, ¬∑‚ü©) consisting of a linear space X over F and an inner product ‚ü®¬∑, ¬∑‚ü©
on X. When there is no confusion over the inner product, we refer to X
itself as an inner product space. By a subspace of an inner product space
X we mean a linear subset S of X, taken with the inner product induced
on S by that on X; thus the inner product on S is the restriction to S √ó S
of the inner product on X.
The simplest example of an inner product space is the Euclidean space
Fn, with the inner product of vectors x = (x1, . . . , xn) and y = (y1, . . . , yn)
deÔ¨Åned by
‚ü®x, y‚ü©=
n

k=1
xky‚àó
k.
For another example consider the linear space l2(C) of square‚Äìsummable
sequences in C, introduced in Exercise (4.4.4: 3), where the inner product
of two elements x = (xk) and y = (yk) is deÔ¨Åned as
‚ü®x, y‚ü©=
‚àû

k=1
xky‚àó
k.
This can be regarded as a generalisation of the Ô¨Årst example, since the one‚Äì
one mapping (x1, . . . , xn) ‚Üí(x1, . . . , xn, 0, 0, . . .) of Cn into l2(C) preserves
the value of the inner product.
Before discussing a third example, in Exercise (5.1.1: 2), let us agree to
call a complex‚Äìvalued function f on a subset X of R integrable if its real
and imaginary parts are integrable over X, in which case we deÔ¨Åne
$
X
f =
$
X
Re(f) + i
$
X
Im(f).
The complex integration spaces Lp(X, C) are then deÔ¨Åned in the obvious
way, and we use Lp(X, F) to denote either Lp(I) or Lp(X, C), depending
on whether F = R or F = C.

5.1 Inner Products
235
(5.1.1) Exercises
.1
Prove that the equation ‚ü®x, y‚ü©= ‚àû
n=1 xny‚àó
n does deÔ¨Åne an inner
product on l2(C). (You must Ô¨Årst prove that the series ‚àû
n=1 xny‚àó
n is
convergent when (xn) and (yn) are elements of l2(C).)
.2
By a weight function on a compact interval I = [a, b] we mean a
nonnegative continuous function w on I such that if f ‚ààC(I) and
%
I w(t)f(t) dt = 0, then f = 0. Prove that
‚ü®f, g‚ü©=
$ b
a
w(t)f(t)g(t)‚àódt
deÔ¨Ånes an inner product on L2(I, F) (where, as always, we iden-
tify two elements of L2(I, F) that are equal almost everywhere). We
denote the corresponding inner product space by L2,w(I, F).
(5.1.2) Proposition.
Let X be an inner product space. Then
‚à•x‚à•= ‚ü®x, x‚ü©1/2
deÔ¨Ånes a norm on X. Moreover, the inner product and this norm satisfy
the Cauchy‚ÄìSchwarz inequality
|‚ü®x, y‚ü©| ‚â§‚à•x‚à•‚à•y‚à•
and Minkowski‚Äôs inequality
‚ü®x + y, x + y‚ü©1/2 ‚â§‚ü®x, x‚ü©1/2 + ‚ü®y, y‚ü©1/2 .
Proof.
We Ô¨Årst prove the two inequalities. For any x, y ‚ààX and any
Œª ‚ààF we have, by IP1 through IP3,
0 ‚â§‚ü®x + Œªy, x + Œªy‚ü©= ‚ü®x, x‚ü©+ ‚ü®x, Œªy‚ü©+ ‚ü®Œªy, x‚ü©+ ‚ü®Œªy, Œªy‚ü©,
so
‚à•x‚à•2 + Œª‚àó‚ü®x, y‚ü©+ Œª ‚ü®x, y‚ü©‚àó+ ŒªŒª‚àó‚à•y‚à•2 ‚â•0,
(1)
with equality if and only if x + Œªy = 0. If ‚à•y‚à•Ã∏= 0, the Cauchy‚ÄìSchwarz
inequality is obtained by taking Œª = ‚àí‚ü®x, y‚ü©/ ‚à•y‚à•2; if ‚à•x‚à•Ã∏= 0, the equality
is obtained by taking Œª = ‚àí‚ü®x, y‚ü©/ ‚à•x‚à•2 ; if ‚à•x‚à•= ‚à•y‚à•= 0, then IP3 shows
that x = 0 = y and hence that ‚ü®x, y‚ü©= 0, so the Cauchy‚ÄìSchwarz inequality
holds trivially.
Taking Œª = 1 in (1) and using the Cauchy‚ÄìSchwarz inequality, we obtain
‚ü®x + y, x + y‚ü©= ‚ü®x, x‚ü©+ 2 Re ‚ü®x, y‚ü©+ ‚ü®y, y‚ü©
‚â§‚ü®x, x‚ü©+ 2 |‚ü®x, y‚ü©| + ‚ü®y, y‚ü©
‚â§‚ü®x, x‚ü©+ 2 ‚à•x‚à•‚à•y‚à•+ ‚ü®y, y‚ü©
=

‚ü®x, x‚ü©1/2 + ‚ü®y, y‚ü©1/22
,

236
5. Hilbert Spaces
which immediately yields Minkowski‚Äôs inequality. It is now a simple ex-
ercise, involving this inequality and the deÔ¨Åning properties of an inner
product, to show that x ‚Üí‚ü®x, x‚ü©1/2 is a norm on X.
2
When we refer to the norm or the metric structure on an inner product
space X, we always have in mind the norm, and the corresponding metric
structure, associated with the inner product as in Proposition (5.1.2).
(5.1.3) Exercises
.1
Complete the details of the proof that if ‚ü®¬∑, ¬∑‚ü©is an inner product on
a linear space X, then ‚à•x‚à•= ‚ü®x, x‚ü©1/2 deÔ¨Ånes a norm on X.
.2
Prove that an inner product on a linear space X is continuous, and
that it is uniformly continuous on bounded sets, with respect to the
corresponding product norm on X √ó X.
.3
Prove the parallelogram law for vectors x, y in an inner product space:
‚à•x + y‚à•2 + ‚à•x ‚àíy‚à•2 = 2 ‚à•x‚à•2 + 2 ‚à•y‚à•2 .
Interpreting a norm as a length, we see that this law generalises the
plane geometry theorem that the sum of the squares of the diagonals
of a parallelogram equals the sum of the squares of its sides.
.4
Use the parallelogram law to show that a Hilbert space is uniformly
convex (see Exercise (4.2.2: 15)).
.5
Let X be a normed space whose norm satisÔ¨Åes the parallelogram law
(see the exercise before last). Show that if F = R, then
‚ü®x, y‚ü©= 1
4

‚à•x + y‚à•2 ‚àí‚à•x ‚àíy‚à•2
deÔ¨Ånes an inner product on X such that ‚à•x‚à•= ‚ü®x, x‚ü©1/2 for each
x ‚ààX. Then show that if F = C, there is a unique inner product on
X related to the norm in this way.
.6
Prove that there is no inner product on C[0, 1] such that ‚ü®f, f‚ü©1/2 =
‚à•f‚à•(the supremum norm). (Show that the supremum norm does not
obey the parallelogram law.)
.7
Prove that the inner product space L2,w(I, F), introduced in Exer-
cise (5.1.1: 2), is complete. Prove also that C(I, F) is not a complete
subspace of this inner product space.

5.2 Orthogonality and Projections
237
An inner product space that is complete with respect to its norm is
called a Hilbert space. For example, the Euclidean space Fn is a Hilbert
space, as is l2(C). On the other hand, if w is a nonnegative weight function
on a compact interval I, then Exercise (5.1.3: 7) shows that L2,w(I, F) is
complete, but C(I, F) is not complete, with respect to the inner product
‚ü®f, g‚ü©=
$
I
w(t)f(t)g(t)‚àódt.
(5.1.4) Exercises
.1
Let X be an inner product space, X0 a closed linear subspace of X,
and œï the canonical mapping of X onto the quotient space X/X0.
Prove that
‚ü®œï(x), œï(y)‚ü©= ‚ü®x, y‚ü©
unambiguously deÔ¨Ånes an inner product on X/X0, and that the
corresponding norm is the quotient norm on X/X0.
.2
Show that each inner product space X can be embedded as a dense
subset of a Hilbert space H. (Extend the inner product by continuity
to the completion of X, as deÔ¨Åned on page 179.) H is then known as
the (Hilbert space) completion of X.
.3
Prove that any two completions H and H‚Ä≤ of an inner product space
X are isomorphic, in the sense that there exists a one‚Äìone linear
mapping u of H onto H‚Ä≤ such that ‚ü®u(x), u(y)‚ü©= ‚ü®x, y‚ü©for all x, y ‚àà
H.
.4
Let I be a compact interval. Show that L2(I, F) is the completion of
the Hilbert space C(I, F) with respect to the inner product ‚ü®f, g‚ü©=
%
I f(t)g(t)‚àódt.
5.2
Orthogonality and Projections
Two elements x, y of an inner product space X are said to be orthogonal if
‚ü®x, y‚ü©= 0, in which case we write x ‚ä•y. In view of IP1, the relation ‚ä•is
symmetric: x ‚ä•y if and only if y ‚ä•x. A vector x is said to be orthogonal
to the subset S of X if x ‚ä•s for each s ‚ààS; we then write x ‚ä•S. The
set of all vectors orthogonal to S is called the orthogonal complement of S,
and is written S‚ä•(pronounced ‚ÄúS perp‚Äù). It follows from IP2 that S‚ä•is a
(linear) subspace of X; and from IP3 that S ‚à©S‚ä•is nonempty if and only
if 0 ‚ààS, in which case S ‚à©S‚ä•= {0}. Moreover, S‚ä•is orthogonal to S,
in the sense that every element of S‚ä•is orthogonal to S: for, by Exercise
(5.1.3: 2), if (sn) is a sequence of elements of S converging to s ‚ààS, then
for each x ‚ààS‚ä•,
‚ü®x, s‚ü©= lim
n‚Üí‚àû‚ü®x, sn‚ü©= 0.

238
5. Hilbert Spaces
For each x ‚ààX, {x}‚ä•is the kernel of the continuous linear functional
z ‚Üí‚ü®z, x‚ü©on X, and so, by Proposition (4.2.3), is a closed subspace of X.
Hence for each subset S of X,
S‚ä•=

s‚ààS
{s}‚ä•
is closed in X.
If x and y are orthogonal vectors, then, expanding ‚ü®x + y, x + y‚ü©, we
obtain Pythagoras‚Äôs Theorem:
‚à•x + y‚à•2 = ‚à•x‚à•2 + ‚à•y‚à•2 .
(5.2.1) Proposition.
Let S be a nonempty complete convex subset of an
inner product space X, and let a ‚ààX. Then there exists a unique vector s
in S such that ‚à•a ‚àís‚à•= œÅ(a, S).
Proof.
Let d = œÅ(a, S), and choose a sequence (sn) in S such that
œÅ(a, sn) ‚Üíd. Using the parallelogram law (Exercise (5.1.3: 3)) and the
convexity of S, for all m and n we compute
‚à•sm ‚àísn‚à•2 = ‚à•sm ‚àía ‚àí(sn ‚àía)‚à•2
= 2 ‚à•sm ‚àía‚à•2 + 2 ‚à•sn ‚àía‚à•2 ‚àí‚à•sm ‚àía + (sn ‚àía)‚à•2
= 2 ‚à•sm ‚àía‚à•2 + 2 ‚à•sn ‚àía‚à•2 ‚àí4
44 1
2(sm + sn) ‚àía
442
‚â§2 ‚à•sm ‚àía‚à•2 + 2 ‚à•sn ‚àía‚à•2 ‚àí4d2
= 2

‚à•sm ‚àía‚à•2 ‚àíd2
+ 2

‚à•sn ‚àía‚à•2 ‚àíd2
‚Üí0 as m, n ‚Üí‚àû.
Hence (sn) is a Cauchy sequence. Since S is complete, (sn) converges to a
limit s in S; then
‚à•a ‚àís‚à•= lim
n‚Üí‚àû‚à•a ‚àísn‚à•= œÅ(a, S).
On the other hand, if s‚Ä≤ ‚ààS and ‚à•a ‚àís‚Ä≤‚à•= œÅ(a, S), then a computation
similar to the one used at the start of the proof shows that
‚à•s ‚àís‚Ä≤‚à•2 = 2 ‚à•s ‚àía‚à•2 + 2 ‚à•s‚Ä≤ ‚àía‚à•2 ‚àí4
44 1
2(s + s‚Ä≤) ‚àía
442
= 4

d2 ‚àí
44 1
2(s + s‚Ä≤) ‚àía
442
‚â§0,
so that s = s‚Ä≤.
2

5.2 Orthogonality and Projections
239
It is worth digressing here to prove a converse of the foregoing result.
(5.2.2) Proposition.
Let S be a nonempty closed subset of the Euclidean
space RN such that each point of RN has a unique closest point in S. Then
S is convex.
Proof.
Supposing that S is not convex, we can Ô¨Ånd a, b ‚ààS and Œª ‚àà(0, 1)
such that
z = Œªa + (1 ‚àíŒª) b /‚ààS.
Since X\S is open, there exists r > 0 such that B(z, r) ‚à©S = ‚àÖ. Let F
be the set of all closed balls B such that B(z, r) ‚äÇB and S ‚à©B‚ó¶= ‚àÖ;
then B(z, r) ‚ààF. The radii of the balls belonging to F are bounded above,
since any ball containing B and having suÔ¨Éciently large radius will meet
S. Let r‚àûbe the supremum of the radii of the members of F, and let
(B(xn, rn))‚àû
n=1 be a sequence of elements of F such that rn ‚Üír‚àû. Then
xn ‚ààB(z, r‚àû) for each n. Since B(z, r‚àû) is compact (Theorem (4.3.6)) and
therefore sequentially compact (Theorem (3.3.9)), we may assume without
loss of generality that (xn) converges to a limit x‚àû. Let K = B(x‚àû, r‚àû);
we prove that K ‚ààF.
First we consider any x ‚ààB(z, r) and any Œµ > 0. Choosing m such that
‚à•xm ‚àíx‚àû‚à•< Œµ, and noting that B(z, r) ‚äÇB(xm, rm), we have
‚à•x ‚àíx‚àû‚à•‚â§‚à•x ‚àíxm‚à•+ ‚à•xm ‚àíx‚àû‚à•
< rm + Œµ
‚â§r‚àû+ Œµ.
Since Œµ is arbitrary, we conclude that ‚à•x ‚àíx‚àû‚à•‚â§r‚àû; whence B(z, r) ‚äÇK.
On the other hand, supposing that there exists s ‚ààS ‚à©B(x‚àû, r‚àû), choose
Œ¥ > 0 such that ‚à•s ‚àíx‚àû‚à•< r‚àû‚àíŒ¥, and then n such that 0 ‚â§r‚àû‚àírn < Œ¥/2
and ‚à•xn ‚àíx‚àû‚à•< Œ¥/2. We have
‚à•s ‚àíxn‚à•‚â§‚à•s ‚àíx‚àû‚à•+ ‚à•x‚àû‚àíxn‚à•
< r‚àû‚àíŒ¥ + Œ¥
2
= r‚àû‚àíŒ¥
2
< rn,
so s ‚ààS‚à©B(xn, rn). This is absurd, as B(xn, rn) ‚ààF; hence S‚à©B(x‚àû, r‚àû)
is empty, and therefore K ‚ààF.
Now, the centre x‚àûof K has a unique closest point p in S. This point
cannot belong to K‚ó¶, as K ‚ààF; nor can it lie outside K, as r‚àûis the supre-
mum of the radii of the balls in F. Therefore p must lie on the boundary
of K. The unique closest point property of S ensures that the boundary of
K intersects S in the single point p. It now follows from Exercise (4.3.7: 7)
that there exists a ball K‚Ä≤ that is concentric with K, has radius greater

240
5. Hilbert Spaces
than r‚àû, and is disjoint from S. This ball must contain B(z, r) and so be-
longs to F. Since this contradicts our choice of r‚àû, we conclude that S is,
in fact, convex.
2
(5.2.3) Exercises
.1
Give an example of a norm ‚à•¬∑‚à•‚Ä≤ on R2, a closed convex subset S of
R2, and a point x ‚ààR2 such that x has inÔ¨Ånitely many closest points
in S relative to ‚à•¬∑‚à•‚Ä≤ .
.2
Let S be the subset of c0 consisting of all elements (xn) such that
‚àû
n=1 2‚àínxn = 0. Show that S is a closed subspace of c0 and that
no point of c0\S has a closest point in S. (Given a = (an) ‚ààc0\S,
set Œ± = ‚àû
n=1 2‚àínan and show that œÅ(a, S) ‚â§|Œ±| . Let x = (xn) ‚ààS,
suppose that ‚à•a ‚àíx‚à•‚â§|Œ±| , and obtain a contradiction.)
.3
Let S be a closed convex set in a uniformly convex Banach space
X. (See Exercise (4.2.2: 15).) Show that to each point a of X there
corresponds a unique closest point in S. (To prove existence, reduce
to the case where a = 0 and œÅ(0, S) = 1. Then choose a sequence (sn)
in S such that ‚à•sn‚à•‚Üí1, and show that

‚à•sn‚à•‚àí1 sn

is a Cauchy
sequence in X.)
.4
Give two proofs that c0 is not uniformly convex.
.5
Let S be a bounded closed subset of RN with the property that to
each x ‚ààRN there corresponds a unique farthest point of S‚Äîthat is,
a point s0 of S such that
‚à•x ‚àís0‚à•= sup {‚à•x ‚àís‚à•: s ‚ààS} .
Show that S consists of a single point. (First show that S is bounded.
Then choose r > 0 such that S ‚äÇB(0, r/2), and consider the family
F of all closed balls B such that S ‚äÇB ‚äÇB(0, r). Show that F
contains a ball with minimum radius, and then show that that radius
is 0.)
Proposition (5.2.2) was Ô¨Årst proved by Motzkin in 1935, and the result
in Exercise (5.2.3: 5) by Motzkin, Straus, and Valentine in 1953.
We now turn from our digression to the subject of projections. In the
special case of Proposition (5.2.1) where S is a complete subspace of X, the
unique point of S closest to a given vector x ‚ààX is called the projection
of the vector x on S, and the mapping that carries each vector in X to its
projection on S is called the projection of X on S. For example,
‚Ä¢ the projection of X on X is the identity operator I : X ‚ÜíX deÔ¨Åned
by Ix = x;

5.2 Orthogonality and Projections
241
‚Ä¢ projections on Ô¨Ånite‚Äìdimensional subspaces of X are always deÔ¨Åned,
since Ô¨Ånite‚Äìdimensional normed spaces are complete, by Proposition
(4.3.3);
‚Ä¢ the projection of a Hilbert space on any closed subspace is deÔ¨Åned,
in view of Proposition (3.2.9).
The next result enables us to show that projections are bounded linear
mappings.
(5.2.4) Proposition.
Let S be a complete subspace of an inner product
space X, and P the projection of X on S. Then for each x ‚ààX, Px is the
unique vector s ‚ààS such that x ‚àís is orthogonal to S.
Proof.
Given x in X, let d = œÅ(x, S). For all y in S and Œª in F, we have
Px ‚àíŒªy ‚ààS, so that
‚ü®x ‚àíPx + Œªy, x ‚àíPx + Œªy‚ü©‚â•d 2 = ‚ü®x ‚àíPx, x ‚àíPx‚ü©,
and therefore
|Œª|2 ‚à•y‚à•2 + 2 Re (Œª‚àó‚ü®x ‚àíPx, y‚ü©) ‚â•0.
Suppose that Re ‚ü®x ‚àíPx, y‚ü©Ã∏= 0; then by the Cauchy‚ÄìSchwarz inequality,
y Ã∏= 0. Taking
Œª = ‚àí‚ü®x ‚àíPx, y‚ü©
‚à•y‚à•2
,
we obtain the contradiction
|Œª|2 ‚à•y‚à•2 + 2 Re (Œª‚àó‚ü®x ‚àíPx, y‚ü©) < 0.
Thus Re ‚ü®x ‚àíPx, y‚ü©= 0. Likewise, Im ‚ü®x ‚àíPx, y‚ü©= 0, so ‚ü®x ‚àíPx, y‚ü©= 0.
If, conversely, s is any vector in S such that x ‚àís is orthogonal to S,
then s ‚àíPx is in S, and so
‚ü®s ‚àíPx, s ‚àíPx‚ü©= ‚ü®x ‚àíPx, s ‚àíPx‚ü©‚àí‚ü®x ‚àís, s ‚àíPx‚ü©= 0;
whence s = Px, by IP3.
2
(5.2.5) Exercises
.1
Prove that if S is a complete subspace of an inner product space X,
then (S‚ä•)‚ä•= S.
.2
Let P be the projection of a Hilbert space H onto a complete subspace
S. Use Proposition (5.2.4) to show that P is a linear mapping, and
that
‚ü®Px, Py‚ü©= ‚ü®Px, y‚ü©= ‚ü®x, Py‚ü©
for all x, y ‚ààH. Show also that ‚à•Px‚à•‚â§‚à•x‚à•for all x ‚ààH, and that
if S Ã∏= {0} , then ‚à•P‚à•= 1.

242
5. Hilbert Spaces
.3
In the notation of the preceding exercise prove that each vector x ‚ààH
has a unique representation in the form x = y + z with y ‚ààS and
z ‚ä•S, and that I ‚àíP is the projection of H on S‚ä•.
.4
To each vector a in an inner product space X there corresponds a
linear functional ua deÔ¨Åned on X by
ua (x) = ‚ü®x, a‚ü©.
Prove that ua is bounded and has norm ‚à•a‚à•; and that if a Ã∏= 0, then
z = ‚à•a‚à•‚àí2 a is in ker (ua)‚ä•, ua (z) = 1, and a = ‚à•z‚à•‚àí2 z.
.5
Let f be a nonzero linear functional on the Euclidean space Rn.
Prove that there exists a nonzero vector p orthogonal to the hyper-
plane ker(f), such that f(x) = ‚ü®x, p‚ü©for each x ‚ààRn. (Choose
a ‚ààRn\ ker(f) such that f(a) = 1. Let b be the foot of the per-
pendicular from a to ker(f), and let p = Œª(a ‚àíb) for an appropriate
value of Œª. Note that each x ‚ààRn can be written uniquely in the
form x = f(x)a + y with y ‚ààker(f).)
A family (ei)i‚ààI of elements of an inner product space X is said to
be orthogonal if ‚ü®ei, ej‚ü©= 0 whenever i, j are distinct indices in I. If, in
addition, ‚à•ei‚à•= 1 for each i, then (ei) is called an orthonormal family; in
that case we call ‚ü®x, ei‚ü©the corresponding ith coordinate of the element x
of X.
For example, in the space L2 ([‚àíœÄ, œÄ], C) , taken with the inner product
‚ü®f, g‚ü©= 1
2œÄ
$ œÄ
‚àíœÄ
f(t)g(t)‚àódt,
the functions en (n = 0, ¬±1, ¬±2, . . .) form an orthonormal sequence, where
en(t) = eint.
The corresponding nth coordinate of f ‚ààL2 ([‚àíœÄ, œÄ], C) is
1
2œÄ
$ œÄ
‚àíœÄ
f(t)e‚àíint dt,
which is better known as the nth Fourier coeÔ¨Écient of f.

5.2 Orthogonality and Projections
243
(5.2.6) Exercise
Verify the mathematical claims made in the last paragraph.
If (ei)i‚ààI is an orthonormal family in an inner product space X, then for
any Ô¨Ånite index set J ‚äÇI the vectors ej (j ‚ààJ) are linearly independent:
for if 
j‚ààJ Œªjej = 0, where each Œªj ‚ààF, then for each i ‚ààJ,
0 =
7
j‚ààJ
Œªjej, ei
8
=

j‚ààJ
Œªj ‚ü®ej, ei‚ü©= Œªi.
Thus the vectors ej (j ‚ààJ) form a basis for a Ô¨Ånite‚Äìdimensional subspace
of X.
(5.2.7) Lemma.
Let (en)N
n=1 be a Ô¨Ånite orthonormal family in an inner
product space X. Then for each x ‚ààX,
44444x ‚àí
N

n=1
‚ü®x, en‚ü©en
44444
2
= ‚à•x‚à•2 ‚àí
N

n=1
|‚ü®x, en‚ü©|2 ,
44444
N

n=1
‚ü®x, en‚ü©en
44444
2
=
N

n=1
|‚ü®x, en‚ü©|2 ‚â§‚à•x‚à•2 ,
and x ‚àíN
n=1 ‚ü®x, en‚ü©en is orthogonal to each ek.
Proof.
For each n write Œªn = ‚ü®x, en‚ü©. Then
44444
N

n=1
‚ü®x, en‚ü©en
44444
2
=
7 N

m=1
Œªmem,
N

n=1
Œªnen
8
=
N

m,n=1
ŒªmŒª‚àó
n ‚ü®em, en‚ü©=
N

n=1
|Œªn|2 .
So
0 ‚â§
44444x ‚àí
N

n=1
Œªnen
44444
2
= ‚à•x‚à•2 ‚àí
7
x,
N

n=1
Œªnen
8
‚àí
7 N

n=1
Œªnen, x
8
+
44444
N

n=1
Œªnen
44444
2
= ‚à•x‚à•2 ‚àí
N

n=1
Œª‚àó
n ‚ü®x, en‚ü©‚àí
N

n=1
Œªn ‚ü®x, en‚ü©‚àó+
N

n=1
|Œªn|2

244
5. Hilbert Spaces
= ‚à•x‚à•2 ‚àí2
N

n=1
|Œªn|2 +
N

n=1
|Œªn|2
= ‚à•x‚à•2 ‚àí
N

n=1
|Œªn|2 .
The Ô¨Årst two of the desired conclusions now follow. On the other hand,
7
x ‚àí
N

n=1
Œªnen, ek
8
= ‚ü®x, ek‚ü©‚àí
N

n=1
Œªn ‚ü®en, ek‚ü©= ‚ü®x, ek‚ü©‚àíŒªk = 0.
2
(5.2.8) Proposition.
If (ei)i‚ààI is an orthonormal family in an inner
product space X, then for each x ‚ààX,
Ix = {i ‚ààI : ‚ü®x, ei‚ü©Ã∏= 0}
is either empty or countable.
Proof.
Lemma (5.2.7) shows that for each Ô¨Ånite subset J of I we have

i‚ààJ
|‚ü®x, ei‚ü©|2 ‚â§‚à•x‚à•2 .
Hence the set
Ix,n =

i ‚ààI : |‚ü®x, ei‚ü©|2 > n‚àí1 ‚à•x‚à•2
has at most n ‚àí1 elements. Since Ix = ‚àû
n=1 Ix,n, we conclude that if Ix is
nonempty, then it is countable.
2
When (ei)i‚ààI is an orthonormal family in an inner product space X,
Proposition (5.2.8) enables us to make sense of certain summations, such
as 
i‚ààI |‚ü®x, ei‚ü©|2 , over possibly uncountable index sets. If Ix is empty, we
deÔ¨Åne 
i‚ààI |‚ü®x, ei‚ü©|2 = 0. If Ix is nonempty, it is either Ô¨Ånite or countably
inÔ¨Ånite; taking, for example, the latter case (the former is even easier to
handle), we deÔ¨Åne

i‚ààI
|‚ü®x, ei‚ü©|2 =
‚àû

n=1
|‚ü®x, fn‚ü©|2 ,
(1)
where f1, f2, . . . is a one‚Äìone enumeration of Ix. Note that the series on the
right‚Äìhand side converges, since its terms are nonnegative and (by Lemma
(5.2.7)) its partial sums are bounded by ‚à•x‚à•2 ; it follows from Exercise
(1.2.17: 1) that the value of the expression on the left‚Äìhand side of (1)

5.2 Orthogonality and Projections
245
is independent of our choice of the one‚Äìone enumeration f1, f2, . . . of Ix.
Moreover, we have Bessel‚Äôs inequality

i‚ààI
|‚ü®x, ei‚ü©|2 ‚â§‚à•x‚à•2 .
In turn, when X is a Hilbert space, we can give meaning to another
important type of series. Writing
sk =
k

n=1
‚ü®x, fn‚ü©fn
and using Lemma (5.2.7), we see that if k > j, then
‚à•sj ‚àísk‚à•2 =
444444
k

n=j+1
‚ü®x, fn‚ü©fn
444444
2
=
k

n=j+1
|‚ü®x, fn‚ü©|2 .
Since ‚àû
n=1 |‚ü®x, fn‚ü©|2 converges, (sn) is a Cauchy sequence in X; so, as X is
complete, ‚àû
n=1 ‚ü®x, fn‚ü©fn converges to a sum s ‚ààX. Likewise, if f ‚Ä≤
1, f ‚Ä≤
2, . . .
is another one‚Äìone enumeration of Ix, then ‚àû
n=1 ‚ü®x, f ‚Ä≤
n‚ü©f ‚Ä≤
n converges to a
sum s‚Ä≤ ‚ààX. We show that s = s‚Ä≤. Given Œµ > 0, we choose N such that if
k ‚â•N, then
‚à•s ‚àísk‚à•< Œµ, ‚à•s‚Ä≤ ‚àís‚Ä≤
k‚à•< Œµ, and
‚àû

n=k+1
|‚ü®x, fn‚ü©|2 < Œµ2,
where
s‚Ä≤
k =
k

n=1
‚ü®x, f ‚Ä≤
n‚ü©f ‚Ä≤
n.
Taking
m = max {k : f ‚Ä≤
k = fn for some n ‚â§N} ,
we see that m ‚â•N and
‚à•s‚Ä≤
m ‚àísN‚à•2 ‚â§
‚àû

n=N+1
|‚ü®x, fn‚ü©|2 < Œµ2.
Hence
‚à•s ‚àís‚Ä≤‚à•‚â§‚à•s ‚àísN‚à•+ ‚à•sN ‚àís‚Ä≤
m‚à•+ ‚à•s‚Ä≤
m ‚àís‚Ä≤‚à•< 3Œµ.
Since Œµ is arbitrary, it follows that s = s‚Ä≤. Hence the value of

i‚ààI
‚ü®x, ei‚ü©ei =
‚àû

n=1
‚ü®x, fn‚ü©fn
is independent of the choice of the one‚Äìone enumeration f1, f2, . . . of Ix.

246
5. Hilbert Spaces
(5.2.9) Exercise
Let (ei)i‚ààI be an orthonormal family in a Hilbert space H, and x, y
elements of H such that Ix is countably inÔ¨Ånite. Show that the value
of the expression

i‚ààI
‚ü®x, ei‚ü©‚ü®ei, y‚ü©=
‚àû

n=1
‚ü®x, fn‚ü©‚ü®fn, y‚ü©
is independent of the one‚Äìone enumeration f1, f2, . . . of Ix. Show also
that if f ‚Ä≤
1, f ‚Ä≤
2, . . . is a (possibly Ô¨Ånite) one‚Äìone enumeration of Iy, then

i‚ààI
‚ü®x, ei‚ü©‚ü®ei, y‚ü©=
‚àû

n=1
‚ü®x, f ‚Ä≤
n‚ü©‚ü®f ‚Ä≤
n, y‚ü©.
(5.2.10) Proposition.
Let (ei)i‚ààI be an orthonormal family in a Hilbert
space H, let S be the closure in H of the subspace of H generated by (ei),
and let P be the projection of H on S. Then for all x, y in H,
Px =

i‚ààI
‚ü®x, ei‚ü©ei,
‚à•Px‚à•2 =

i‚ààI
|‚ü®x, ei‚ü©|2 ,
‚à•x ‚àíPx‚à•2 = ‚à•x‚à•2 ‚àí

i‚ààI
|‚ü®x, ei‚ü©|2 ,
‚ü®Px, Py‚ü©=

i‚ààI
‚ü®x, ei‚ü©‚ü®ei, y‚ü©.
Proof.
Consider, for example, the case where Ix is countably inÔ¨Ånite. Let
f1, f2, . . . be a one‚Äìone enumeration of Ix. Lemma (5.2.7) shows that
44444x ‚àí
N

n=1
‚ü®x, fn‚ü©fn
44444
2
= ‚à•x‚à•2 ‚àí
N

n=1
|‚ü®x, fn‚ü©|2 ,
44444
N

n=1
‚ü®x, fn‚ü©fn
44444
2
=
N

n=1
|‚ü®x, fn‚ü©|2 ,
and x ‚àíN
n=1 ‚ü®x, fn‚ü©fn is orthogonal to f1, . . . , fN. Letting N ‚Üí‚àû, we
see that
44444x ‚àí

i‚ààI
‚ü®x, ei‚ü©ei
44444
2
= ‚à•x‚à•2 ‚àí

i‚ààI
|‚ü®x, ei‚ü©|2 ,
44444

i‚ààI
‚ü®x, ei‚ü©ei
44444
2
=

i‚ààI
|‚ü®x, ei‚ü©|2 ,

5.2 Orthogonality and Projections
247
and z = x ‚àí
i‚ààI ‚ü®x, ei‚ü©ei is orthogonal to each fn. For each i ‚ààI either
ei = fn for some n, and therefore z ‚ä•ei, or else i /‚ààIx; in the latter case,
using the continuity of the inner product, we have
‚ü®z, ei‚ü©= ‚ü®x, ei‚ü©‚àí
7 ‚àû

n=1
‚ü®x, fn‚ü©fn, ei
8
= 0 ‚àí
‚àû

n=1
‚ü®‚ü®x, fn‚ü©fn, ei‚ü©
= ‚àí
‚àû

n=1
‚ü®x, fn‚ü©‚ü®fn, ei‚ü©
= 0,
as ei is orthogonal to each fn. It now follows that z is orthogonal to each
vector in S, and hence, by Proposition (5.2.4), that Px = 
i‚ààI ‚ü®x, ei‚ü©ei.
Using Exercise (5.2.5: 2), the continuity of the inner product, and
Exercise (5.2.9), we now obtain
‚ü®Px, Py‚ü©= ‚ü®Px, y‚ü©
=
7 ‚àû

n=1
‚ü®x, fn‚ü©fn, y
8
=
‚àû

n=1
‚ü®x, fn‚ü©‚ü®fn, y‚ü©
=

i‚ààI
‚ü®x, ei‚ü©‚ü®ei, y‚ü©.
2
By an orthonormal basis of a Hilbert space H we mean an orthonormal
family that generates a dense linear subspace of H. The following is a more
or less immediate consequence of Proposition (5.2.10).
(5.2.11) Proposition.
The following are equivalent conditions on an
orthonormal family (ei)i‚ààI in a Hilbert space H.
(i) (ei) is an orthonormal basis of H.
(ii) x = 
i‚ààI ‚ü®x, ei‚ü©ei for each x ‚ààH.
(iii) 
i‚ààI |‚ü®x, ei‚ü©|2 = ‚à•x‚à•2 for each x ‚ààH.
(iv) ‚ü®x, y‚ü©= 
i‚ààI ‚ü®x, ei‚ü©‚ü®ei, y‚ü©for all x, y ‚ààH.

248
5. Hilbert Spaces
The identity in condition (iv) of this proposition is known as Parseval‚Äôs
identity.
(5.2.12) Exercises
.1
Prove Proposition (5.2.11).
.2
Use Zorn‚Äôs Lemma (Appendix B) to prove that every nonzero Hilbert
space has an orthonormal basis.
.3
Let (ei)i‚ààI be an orthonormal basis in a separable Hilbert space H.
By considering the balls B(ei, 1/
‚àö
2), or otherwise, show that I is a
countable set.
.4
Let H be an inÔ¨Ånite‚Äìdimensional inner product space, and (en)‚àû
n=1 an
inÔ¨Ånite orthonormal sequence of vectors in H. By considering (en),
and without invoking either Theorem (4.3.6) or Exercise (4.3.7: 4),
prove that the unit ball of H is not sequentially compact.
.5
Let (en)‚àû
n=1 be an orthonormal basis of a separable Hilbert space H,
and (an)‚àû
n=1 an element of l2(C). Show that there exists a unique
element a of H such that ‚ü®a, en‚ü©= an for each n. (Show that the
partial sums of the series ‚àû
n=1 anen form a Cauchy sequence.)
.6
Prove that the functions
t ‚Üíen(t) =
1
‚àö
2œÄ eint
(n ‚ààZ)
form an orthonormal basis of L2 ([‚àíœÄ, œÄ], C) . (Noting Exercise
(5.2.6), show that the linear space S generated by {en : n ‚ààZ} is
dense in L2 ([‚àíœÄ, œÄ], C) . To do this, Ô¨Årst consider f ‚ààC([‚àíœÄ, œÄ], C).
Construct a continuous function g on R, with period 2œÄ, such
that ‚à•f ‚àíg‚à•2 is arbitrarily small. Then use Exercise (4.6.8: 6) to
approximate g, and therefore f, by an element of S.)
It follows from this exercise and Proposition (5.2.11) that for each
f ‚ààL2 ([‚àíœÄ, œÄ], C) the corresponding Fourier expansion
x ‚Üí
‚àû

n=‚àí‚àû
-f(n)einx
converges to f in the L2 norm, where
-f(n) = 1
2œÄ
$ œÄ
‚àíœÄ
f(t)e‚àíint dt.
In this case Parseval‚Äôs identity takes the form
$ œÄ
‚àíœÄ
|f(x)|2 dx = 1
2œÄ
‚àû

n=‚àí‚àû
   -f(n)
   
2
.

5.2 Orthogonality and Projections
249
.7
Take f(x) = x in the preceding exercise and apply Parseval‚Äôs identity,
to show that ‚àû
n=1 n‚àí2 = œÄ2/6.
.8
Show that ‚àû
n=1 n‚àí4 = œÄ4/90. (Consider f(x) = 1
2

x2 ‚àíœÄ2	
.)
Although Zorn‚Äôs Lemma guarantees the existence of an orthonormal ba-
sis in any Hilbert space (Exercise (5.2.12: 2)), it does not enable us to
construct orthonormal bases. The following Gram‚ÄìSchmidt orthonormali-
sation process enables us to construct orthonormal bases when the Hilbert
space H is separable.
Using Proposition (4.3.8), Ô¨Årst construct a (possibly Ô¨Ånite) total sequence
(a1, a2, . . .) of linearly independent vectors in H. For each n let Hn be the
n‚Äìdimensional subspace of H spanned by {a1, . . . , an}; since this subspace
is complete (by Proposition (4.3.3)), the projection Pn of H onto it is
deÔ¨Åned. Suppose we have found orthogonal vectors b1, . . . , bn generating
Hn. If H = Hn, stop the construction. Otherwise, an+1 /‚ààHn ; so by
Proposition (5.2.4),
bn+1 = an+1 ‚àíPnan+1
is orthogonal to Hn, and therefore
‚ü®bn+1, bk‚ü©= 0
(1 ‚â§k ‚â§n).
Elementary linear algebra shows that {b1, . . . , bn+1} is a basis of Hn+1.
This completes the inductive construction of a (possibly Ô¨Ånite) orthogonal
sequence (b1, b2, . . .) in H such that for each n, {b1, . . . ,bn} is a basis of
Hn. Setting en = ‚à•bn‚à•‚àí1 bn and noting that 
n Hn is dense in H, we see
that (en) is an orthonormal basis of H.
The Gram‚ÄìSchmidt orthonormalisation process has a very important
application in approximation theory, which we now describe.
Let w be a nonnegative continuous weight function on a compact interval
I = [a, b]. DeÔ¨Åne the inner product
‚ü®f, g‚ü©w =
$ b
a
w(t)f(t)g(t) dt
on L2(I), and the corresponding weighted least squares norm by
‚à•f‚à•2,w =
$ b
a
w(t)f(t)2 dt
1/2
.
Given an element f of L2(I) and a natural number N, we have the
approximation problem:

250
5. Hilbert Spaces
Find the polynomial function p of degree at most N that
minimises the value of
‚à•f ‚àíp‚à•2
2,w =
$ b
a
w(t) (f(t) ‚àíp(t))2 dt.
This polynomial is called the least squares approximation to f of degree at
most N.
Now, the set PN of polynomials of degree ‚â§N is a Ô¨Ånite‚Äìdimensional
subspace of C(I); so the projection PN of C(I) on PN exists, and the unique
least squares approximation to f of degree at most N is given by pN = PNf.
To compute the coeÔ¨Écients of pN, we can use elementary multivariate
calculus to calculate the values of Œª0, . . . , ŒªN that minimise
$ b
a
w(t)

f(t) ‚àí
N

n=0
Œªntn
2
dt;
see [29]. However, this procedure is computationally ineÔ¨Écient if we are
looking for least squares approximations to several functions in C(I). In that
case a better procedure is to apply the Gram‚ÄìSchmidt process to the total
sequence consisting of the monomials 1, t, t2, . . ., to compute orthonormal
polynomials q0, q1, . . . , where qn(t) has degree n and {q0, . . . , qn} is a basis
for Pn; then
PNf =
N

n=0
‚ü®f, qn‚ü©w qn,
by Proposition (5.2.10). One advantage of this method is that, having found
the least squares approximation pn to f of degree at most n, in order to
Ô¨Ånd the least squares approximation of degree at most n+1 we simply add
to pn the single term ‚ü®f, qn+1‚ü©w qn+1.
(5.2.13) Exercises
.1
In the notation of the preceding paragraphs, take I = [‚àí1, 1] and
w(t) = 1, and compute q0, q1, and q2. Hence Ô¨Ånd the quadratic least
squares approximation to ex in C[‚àí1, 1].
.2
Let w be a nonnegative continuous weight function on I = [a, b], let
f ‚ààC(I), and for each n let pn denote the least squares approximation
to f of degree at most n. Prove that
lim
n‚Üí‚àû‚à•f ‚àípn‚à•2,w = 0.
.3
In the notation of the last exercise, let (qn) be a sequence of polyno-
mial functions that is orthogonal relative to ‚ü®¬∑, ¬∑‚ü©w , such that qn has

5.2 Orthogonality and Projections
251
degree n. Prove that each polynomial p of degree n can be written
uniquely as a linear combination of q0, . . . , qn, and Ô¨Ånd the coeÔ¨Écient
of qk in this linear combination.
.4
Continuing Exercise (5.2.13: 3), prove that qn(t) has n distinct real
zeroes, and that those zeroes lie in the open interval (a, b). (Let
p(t) = (t ‚àít1) ¬∑ ¬∑ ¬∑ (t ‚àítm),
where t1, . . . , tm are the zeroes of qn(t) in (a, b) at which qn(t) changes
sign. Assume that m < n, show that
% b
a w(t)p(t)qn(t) dt Ã∏= 0, and
deduce a contradiction.)
.5
Continuing Exercise (5.2.13: 4), write
qn(t) = Antn + Bntn‚àí1 + . . . ,
cn = ‚ü®qn, qn‚ü©w ,
Œ±n = An+1
An
,
Œ≤n = Œ±n
Bn+1
An+1
‚àíBn
An

,
and, for n ‚â•1,
Œ≥n = An+1An‚àí1
A2n
¬∑
‚ü®qn, qn‚ü©w
‚ü®qn‚àí1, qn‚àí1‚ü©w
.
Prove the triple recursion formula:
qn+1(t) = (Œ±nt + Œ≤n)qn(t) ‚àíŒ≥nqn‚àí1(t).
(Consider p(t) = qn+1(t) ‚àíŒ±ntqn(t).)
.6
Let I = [a, b], let w ‚ààC(I), and let p be a polynomial function. Prove
the equivalence of the following conditions.
(i)
% b
a w(t)p(t)q(t) dt = 0 for all polynomial functions q of degree at
most n.
(ii) There exists an (n + 1)-times diÔ¨Äerentiable function u on I such
that
w(x)p(x) = u(n+1)(x)
(x ‚ààI)
and
u(k)(a+) = u(k)(b‚àí) = 0
(k = 0, 1, . . . , n).

252
5. Hilbert Spaces
.7
Let I = [‚àí1, 1], let Œ±, Œ≤ ‚àà(‚àí1, ‚àû) , and let
w(x) = (1 ‚àíx)Œ± (1 + x)Œ≤
(x ‚ààI).
For each n ‚ààN deÔ¨Åne the Jacobi polynomial of degree n by
Rodrigues‚Äôs formula:
œÜn(x) = (1 ‚àíx)‚àíŒ± (1 + x)‚àíŒ≤ dn
dxn

(1 ‚àíx)Œ±+n (1 + x)Œ≤+n
(where, of course, dn/dxn denotes the nth derivative). Use the pre-
ceding exercise to prove that (œÜn)‚àû
n=0 is an orthogonal sequence in
L2,w(I, C).
.8
In the special case Œ± = Œ≤ = 0 of the last exercise, the Jacobi poly-
nomial œÜn is known as a Legendre polynomial and is usually denoted
by Pn. Prove that the Legendre polynomials satisfy the recurrence
relation
Pn+1(x) = (4n + 2)xPn(x) ‚àí4n2Pn‚àí1(x)
on [‚àí1, 1]. Use this and Exercise (5.2.13: 1) to Ô¨Ånd P3(x) and P4(x).
(To establish the recurrence relation, write each term in the form
dn‚àí1
dxn‚àí1

x2 ‚àí1
	n‚àí1 q(x)

,
where q(x) is a quadratic polynomial.)
5.3
The Dual of a Hilbert Space
We saw in Exercise (5.2.5: 4) that for each vector a in an inner product
space X the mapping x ‚Üí‚ü®x, a‚ü©is a bounded linear functional on X. We
now show that the dual of a Hilbert space consists precisely of bounded
linear functionals of this form (cf. Exercise (5.2.5: 5)).
(5.3.1) The Riesz Representation Theorem.
If u is a bounded linear
functional on a Hilbert space H, then there exists a unique vector a ‚ààH
such that u(x) = ‚ü®x, a‚ü©for each x ‚ààH. In that case ‚à•u‚à•= ‚à•a‚à•.
Proof.
We Ô¨Årst dispose of the uniqueness1 of a: indeed, if
‚ü®x, a‚ü©= u(x) = ‚ü®x, a‚Ä≤‚ü©
(x ‚ààH) ,
1This uniqueness argument applies to a linear functional of the form x ‚Üí‚ü®x, a‚ü©
on an inner product space.

5.3 The Dual of a Hilbert Space
253
then, taking x = a ‚àía‚Ä≤, we obtain
‚à•a ‚àía‚Ä≤‚à•2 = ‚ü®a ‚àía‚Ä≤, a ‚àía‚Ä≤‚ü©= 0,
so a = a‚Ä≤.
To establish the existence of a, we may assume that u Ã∏= 0. As u is linear
and continuous, ker (u) is a closed subspace of H (Proposition (4.2.3)). Let
P be the projection of H on ker (u), and choose y ‚ààH such that u(y) Ã∏= 0.
Setting
z = u(y)‚àí1 (y ‚àíPy) ,
we see that z ‚ààker (u)‚ä•, by Proposition (5.2.4), and that
u(z) = u(y)‚àí1 (u(y) ‚àíu(Py)) = 1.
So for each x in H we have
x ‚àíu(x)z ‚ààker(u)
and therefore
0 = ‚ü®x ‚àíu(x)z, z‚ü©= ‚ü®x, z‚ü©‚àíu(x) ‚ü®z, z‚ü©= ‚ü®x, z‚ü©‚àíu(x) ‚à•z‚à•2 .
Thus u(x) = ‚ü®x, a‚ü©, where a = ‚à•z‚à•‚àí2 z. The Cauchy‚ÄìSchwarz inequality
shows that |u(x)| ‚â§‚à•a‚à•‚à•x‚à•. Since also
   u

‚à•a‚à•‚àí1 a
   = ‚à•a‚à•, we see that
‚à•u‚à•= ‚à•a‚à•.
2
(5.3.2) Exercises
.1
Find an alternative proof of the existence part of the Riesz Represen-
tation Theorem (5.3.1) for a separable Hilbert space H. (Let (en)‚àû
n=1
be an orthonormal basis of H, and u a bounded linear functional
on H. Show that ‚àû
n=1 u(en)‚àóen converges to the desired element
a ‚ààH.)
.2
Use the Riesz Representation Theorem to give another solution to
Exercise (5.2.12: 5). (In the notation of that exercise, show that
u(x) = ‚àû
n=1 a‚àó
n ‚ü®x, en‚ü©deÔ¨Ånes a bounded linear functional on H.)
.3
By the second dual of a normed space X we mean the dual space
X‚àó‚àó= (X‚àó)‚àóof X‚àó. We say that X is reÔ¨Çexive if for each u ‚ààX‚àó‚àó
there exists xu ‚ààX such that u(f) = f(xu) for each f ‚ààX‚àó. Prove
that any Hilbert space is reÔ¨Çexive.
By an operator on a normed space X we mean a bounded linear mapping
from X into itself; the set of operators on X is written L(X). (Strictly
speaking, we have here deÔ¨Åned a bounded operator; since we do not consider

254
5. Hilbert Spaces
unbounded operators in this book, it is convenient for us to use the term
‚Äúoperator‚Äù to mean ‚Äúbounded operator‚Äù.)
It is common practice to denote the composition of operators by juxta-
position; thus if S, T are operators on X, then T ‚ó¶S is usually written TS;
moreover, we write T 2 for TT, T 3 for T(TT), and so on.
For a Ô¨Årst application of the Riesz Representation Theorem, let T be
an operator on a Hilbert space H, and for each a ‚ààX consider the linear
functional x ‚Üí‚ü®Tx, a‚ü©on H. The inequality
|‚ü®Tx, a‚ü©| ‚â§‚à•Tx‚à•‚à•a‚à•‚â§‚à•T‚à•‚à•a‚à•‚à•x‚à•
shows that this functional is bounded and has norm at most ‚à•T‚à•‚à•a‚à•. By
the Riesz Representation Theorem, there exists a unique vector T ‚àóa such
that
‚ü®Tx, a‚ü©= ‚ü®x, T ‚àóa‚ü©
(x ‚ààH) ;
moreover,
‚à•T ‚àóa‚à•‚â§‚à•T‚à•‚à•a‚à•.
(1)
The mapping T ‚àó: H ‚ÜíH so deÔ¨Åned is called the adjoint of T, and is an
operator on H. To justify this last claim, consider a, b in H and Œª, ¬µ in F.
Since
‚ü®Tx, Œªa + ¬µb‚ü©= Œª‚àó‚ü®Tx, a‚ü©+ ¬µ‚àó‚ü®Tx, b‚ü©
= Œª‚àó‚ü®x, T ‚àóa‚ü©+ ¬µ‚àó‚ü®x, T ‚àób‚ü©
= ‚ü®x, ŒªT ‚àóa + ¬µT ‚àób‚ü©
for all x ‚ààH, we see that
T ‚àó(Œªa + ¬µb) = ŒªT ‚àóa + ¬µT ‚àób.
So T ‚àóis linear. Inequality (1) shows that T ‚àóis bounded and has norm at
most ‚à•T‚à•. Since
‚ü®T ‚àóx, y‚ü©= ‚ü®y, T ‚àóx‚ü©‚àó= ‚ü®Ty, x‚ü©‚àó= ‚ü®x, Ty‚ü©,
the uniqueness of the adjoint of T ‚àóshows that (T ‚àó)‚àó= T. So ‚à•T‚à•=
‚à•(T ‚àó)‚àó‚à•‚â§‚à•T ‚àó‚à•and therefore ‚à•T ‚àó‚à•= ‚à•T‚à•.
An operator T on H is said to be
‚Ä¢ selfadjoint, or Hermitian, if T ‚àó= T;
‚Ä¢ normal if T ‚àóT = TT ‚àó.
Selfadjoint and normal operators have particularly amenable properties and
are among the most important objects in Hilbert space theory. (See [24],
[44], and other books that deal with such topics as spectral theory.)
(5.3.3) Exercises
In all the exercises of this set except the Ô¨Årst, H is a complex Hilbert space,
S and T are operators on H, and ran(T) denotes the range of T.

5.3 The Dual of a Hilbert Space
255
.1
Let (e1, e2, . . . , en) be an orthonormal basis of the Euclidean Hilbert
space Fn, and T an operator on Fn. Show that
Tx =
n

j,k=1
‚ü®x, ej‚ü©‚ü®Tej, ek‚ü©ek,
and hence that T can be associated with the n‚Äìby‚Äìn matrix whose
(j, k)th entry is ‚ü®Tej, ek‚ü©. With what matrix is T ‚àóassociated in this
way?
.2
By a bounded conjugate‚Äìbilinear functional on H we mean a mapping
u : H √ó H ‚ÜíC that is linear in the Ô¨Årst variable, conjugate linear
in the second, and bounded, in the sense that there exists c > 0 such
that |u(x, y)| ‚â§c ‚à•x‚à•‚à•y‚à•for all x, y ‚ààH. The least such c is the
number written
‚à•u‚à•= sup {|u(x, y)| : x, y ‚ààH, ‚à•x‚à•‚â§1, ‚à•y‚à•‚â§1} .
Show that the mapping u : H √ó H ‚ÜíC deÔ¨Åned by
u(x, y) = ‚ü®Tx, y‚ü©
(2)
is a bounded conjugate‚Äìlinear functional on H such that ‚à•u‚à•= ‚à•T‚à•.
Show also that each bounded conjugate‚Äìlinear functional u on H is
related to a unique corresponding operator T as in equation (2). (For
the second part, show that for each x ‚ààH the mapping y ‚Üíu(x, y)‚àó
is a bounded linear functional on H.)
.3
Verify the polarisation identity:
4 ‚ü®Tx, y‚ü©
=
‚ü®T(x + y), x + y‚ü©‚àí‚ü®T(x ‚àíy), x ‚àíy‚ü©
+i ‚ü®T(x + iy), x + iy‚ü©‚àíi ‚ü®T(x ‚àíiy), x ‚àíiy‚ü©.
Show that if ‚ü®Sx, x‚ü©= ‚ü®Tx, x‚ü©for all x ‚ààH, then S = T.
Give an example of a nonzero operator T on the real Hilbert space
R2 such that ‚ü®Tx, x‚ü©= 0 for all x ‚ààR2.
.4
Let Œª, ¬µ be complex numbers. Show that (ŒªS + ¬µT)‚àó= Œª‚àóS‚àó+ ¬µ‚àóT ‚àó
and (ST)‚àó= T ‚àóS‚àó.
.5
Prove that T ‚àóT and TT ‚àóare selfadjoint.
.6
Prove each of the following statements.
(i) ker(T ‚àó) = ran(T)‚ä•
(ii) ran(T ‚àó) = ker(T)‚ä•.
(iii) ker(T) = ker(T ‚àóT).

256
5. Hilbert Spaces
(iv) ran(TT ‚àó) is dense in ran(T).
.7
Show that
(i) T is selfadjoint if and only if ‚ü®Tx, x‚ü©‚ààR for all x ‚ààH.
(ii) T is normal if and only if ‚à•Tx‚à•= ‚à•T ‚àóx‚à•for each x ‚ààH.
(For part (i), consider ‚ü®Tx, x‚ü©‚àí‚ü®T ‚àóx, x‚ü©, and note Exercise (5.3.3: 3).)
.8
Prove that T is a projection if and only if T ‚àóT = T, in which case
T is idempotent‚Äîthat is, T 2 = T. (For ‚Äúif‚Äù, show Ô¨Årst that T is
selfadjoint, and then that (x ‚àíTx) ‚ä•Ty for all x, y ‚ààH.)
We close this chapter by sketching how the techniques of Hilbert space
theory can be applied to prove the existence of a type of solution for one
of the fundamental problems of potential theory. (For more information on
this topic, see, for example, pages 117‚Äì122 of [23].)
For the rest of this chapter only, we follow the usual notational conven-
tions of applied mathematicians. Thus we denote three‚Äìdimensional vectors
by boldface letters, the element of volume in R3 by dV, the element of sur-
face area by dS, the unit outward normal to a surface by n, and the inner
product of two vectors u, v in R3 by u ¬∑ v. We assume familiarity with
calculus in R3, including the elementary vector analysis of the gradient
operator ‚àáand the divergence operator div, deÔ¨Åned, respectively, by
‚àáf =
‚àÇf
‚àÇx, ‚àÇf
‚àÇy , ‚àÇf
‚àÇz

for a real‚Äìvalued function f, and
div u =
‚àÇux
‚àÇx , ‚àÇuy
‚àÇy , ‚àÇuz
‚àÇz

for a vector u = (ux, uy, uz). We also assume the fundamentals of the
theory of L2(‚Ñ¶) when ‚Ñ¶is a Lebesgue measurable subset of R3.
Let ‚Ñ¶be a bounded open set in R3 for which Gauss‚Äôs Divergence
Theorem holds:
$
‚Ñ¶
div u dV =
$
‚àÇ‚Ñ¶
u ¬∑ n dS,
where ‚àÇ‚Ñ¶is the boundary surface of ‚Ñ¶and u : ‚Ñ¶‚ÜíR3 is continuously
diÔ¨Äerentiable on ‚Ñ¶. It follows that Green‚Äôs Theorem holds in the form
$
‚Ñ¶

u ‚àá2v ‚àív ‚àá2u
	
dV =
$
‚àÇ‚Ñ¶

u ‚àÇv
‚àÇn ‚àív ‚àÇu
‚àÇn

dS,

5.3 The Dual of a Hilbert Space
257
where u, v are twice continuously diÔ¨Äerentiable mappings of ‚Ñ¶into R, ‚àÇ/‚àÇn
denotes diÔ¨Äerentiation along the outward normal to ‚àÇ‚Ñ¶, and ‚àá2 is the
Laplacian operator,
‚àá2 = ‚àÇ2
‚àÇx2 + ‚àÇ2
‚àÇy2 + ‚àÇ2
‚àÇz2 .
We assume the following result, embodying Poincar¬¥e‚Äôs inequality.
There exists a constant c > 0 such that if v : ‚Ñ¶‚ÜíR is
diÔ¨Äerentiable on ‚Ñ¶and vanishes on the boundary of ‚Ñ¶, then
$
‚Ñ¶
v2 dV
1/2
‚â§c
$
‚Ñ¶
‚à•‚àáv‚à•2 dV
1/2
.
For a proof of this inequality under reasonable conditions on ‚Ñ¶we refer to
[37], Chapter 5, Theorem 1.
Given a bounded continuous function f : ‚Ñ¶‚ÜíR, we consider the
corresponding Dirichlet Problem:
Find a function u : ‚Ñ¶‚ÜíR that is twice diÔ¨Äerentiable on ‚Ñ¶,
satisÔ¨Åes ‚àá2u = f on ‚Ñ¶, and vanishes on the boundary of ‚Ñ¶.
Suppose we have found a solution u of this Dirichlet Problem. Let v : ‚Ñ¶‚Üí
R be twice diÔ¨Äerentiable and have compact support in ‚Ñ¶‚Äîthat is, v = 0
outside some compact subset of ‚Ñ¶. Then it follows from Green‚Äôs Theorem
that
$
‚Ñ¶
u ‚àá2v dV =
$
‚Ñ¶
vf dV,
(3)
since both u and v vanish on ‚àÇ‚Ñ¶.
Now, it may not be possible to solve the Dirichlet Problem on ‚Ñ¶; but, as
we now show, we can Ô¨Ånd a function u on ‚Ñ¶that behaves appropriately on
‚àÇ‚Ñ¶and that satisÔ¨Åes (3) for all v : ‚Ñ¶‚ÜíR that are twice diÔ¨Äerentiable and
have compact support in ‚Ñ¶. More advanced theory of partial diÔ¨Äerential
equations then provides conditions on ‚Ñ¶under which this so‚Äìcalled weak
solution u of the Dirichlet Problem can be identiÔ¨Åed with a solution of the
standard type.
Let C1
0(‚Ñ¶) be the space of functions u : ‚Ñ¶‚ÜíR that have compact
support in ‚Ñ¶and are diÔ¨Äerentiable on ‚Ñ¶; and let C1(‚Ñ¶) be the space of
functions u : ‚Ñ¶‚ÜíR such that u is diÔ¨Äerentiable on ‚Ñ¶and ‚àáu extends to a
continuous function on ‚Ñ¶. Let 9C1(‚Ñ¶) be the space consisting of all elements
of C1(‚Ñ¶) that vanish on ‚àÇ‚Ñ¶, H1
0(‚Ñ¶) the completion of 9C1(‚Ñ¶) with respect
to the inner product deÔ¨Åned by
‚ü®u, v‚ü©=
$
‚Ñ¶
‚àáu ¬∑ ‚àáv dV,

258
5. Hilbert Spaces
and ‚à•¬∑‚à•H the corresponding norm on H1
0(‚Ñ¶). It is not hard to show that
C1
0(‚Ñ¶) is dense in H1
0(‚Ñ¶) with respect to this norm, and that H1
0(‚Ñ¶) can be
identiÔ¨Åed with a certain set of Lebesgue integrable real‚Äìvalued functions u
on ‚Ñ¶.
Now deÔ¨Åne a linear functional œïf on 9C1(‚Ñ¶) by
œïf(v) =
$
‚Ñ¶
vf dV.
Applying the Cauchy‚ÄìSchwarz inequality in the Hilbert space L2(‚Ñ¶), we
obtain
|œïf(v)| ‚â§
$
‚Ñ¶
v2 dV
1/2 $
‚Ñ¶
f 2 dV
1/2
.
Hence, by Poincar¬¥e‚Äôs inequality,
|œïf(v)| ‚â§c
$
‚Ñ¶
f 2 dV
1/2 $
‚Ñ¶
‚à•‚àáv‚à•2 dV
1/2
= c
$
‚Ñ¶
f 2 dV
1/2
‚à•v‚à•H ,
where the constant c is independent of v. Thus the linear functional œïf is
bounded. It therefore extends by continuity to a bounded linear functional
œïf on H1
0(‚Ñ¶); see Exercise (4.2.2: 10). Thus, by the Riesz Representation
Theorem (5.3.1), there exists a unique element u of H1
0(‚Ñ¶) such that
œïf(v) = ‚àí‚ü®v, u‚ü©

v ‚ààH1
0(‚Ñ¶)
	
.
For each v that has compact support in ‚Ñ¶and is twice diÔ¨Äerentiable on ‚Ñ¶,
we now use the elementary vector identity
div (u‚àáv) = ‚àáu ¬∑ ‚àáv + u ‚àá2v
and Gauss‚Äôs Divergence Theorem to show that
$
‚Ñ¶
u ‚àá2v dV = ‚àí‚ü®v, u‚ü©+
$
‚Ñ¶
div (u‚àáv) dV
= œïf(v) +
$
‚àÇ‚Ñ¶
u‚àáv ¬∑ n dS
=
$
‚Ñ¶
vf dV.
(Recall that v = 0 on the boundary of ‚Ñ¶). This completes the proof that u
is the weak solution that we wanted.

6
An Introduction to Functional
Analysis
...a wonderful piece of work; which not to have been
blessed withal would have discredited your travel.
Antony and Cleopatra, Act 1, Scene 2
In this chapter we Ô¨Årst discuss the Hahn‚ÄìBanach Theorem, the most famous case
of which provides conditions under which a bounded linear functional on a sub-
space of a normed space X can be extended, with preservation of its norm, to a
bounded linear functional on the whole of X. We then present several applica-
tions of this theorem, some of which illustrate the interplay between a normed
space and its dual. In Section 2 we use the Hahn‚ÄìBanach Theorem to obtain re-
sults about the separation of convex sets by hyperplanes. The last section of the
chapter introduces the Baire Category Theorem, and includes some of its many
applications in classical and functional analysis.
6.1
The Hahn‚ÄìBanach Theorem
Let X be a linear space over F. If F = C, then by a complex‚Äìlinear
functional on X we mean a mapping f : X ‚ÜíC such that
f(x + y) = f(x) + f(y)
and
f(Œªx) = Œªf(x)

260
6. An Introduction to Functional Analysis
for all x, y ‚ààX and all Œª ‚ààC. If f maps X into R and satisÔ¨Åes these
equations for all real numbers Œª, then f is called a real‚Äìlinear functional
on X.
According to our Ô¨Årst lemma, real‚Äìlinear functionals can be characterised
as the real parts of associated complex‚Äìlinear functionals.
(6.1.1) Lemma.
Let X be a complex normed linear space. If f is a
complex‚Äìlinear functional on X and u is the real part of f, then u is a
real‚Äìlinear functional on X and
f(x) = u(x) ‚àíiu(ix)
(x ‚ààX).
(1)
If u is a real‚Äìlinear functional on X and f is deÔ¨Åned by equation (1), then
f is a complex‚Äìlinear functional on X. Moreover, if f and u are related
as in equation (1) and either f or u is bounded, then both functionals are
bounded and ‚à•f‚à•= ‚à•u‚à•.
Proof.
If f is a complex‚Äìlinear functional on X and u = Re (f), then it
is easy to show that u is real‚Äìlinear; moreover, equation (1) follows from
the fact that z = Re (z) ‚àíi Re(iz) for any complex number z. On the other
hand, if u is a real‚Äìlinear functional on X, and f is deÔ¨Åned as in (1), then
it is clear that f(x + y) = f(x) + f(y), and that f(Œªx) = Œªf(x) for all real
Œª. Also,
f(ix) = u(ix) ‚àíiu(i2x)
= u(ix) ‚àíiu(‚àíx)
= u(ix) + iu(x)
= if(x),
from which it follows that f is complex‚Äìlinear.
If f is bounded, then as |u(x)| ‚â§|f(x)| for all x ‚ààX, u is bounded
and ‚à•u‚à•‚â§‚à•f‚à•. For each x ‚ààX there exists Œª ‚ààC such that |Œª| = 1 and
f(Œªx) = Œªf(x) = |f(x)|; then f(Œªx) ‚ààR, so
|f(x)| = f(Œªx)
= Re (f(Œªx))
= u(Œªx)
‚â§‚à•u‚à•‚à•Œªx‚à•= ‚à•u‚à•‚à•x‚à•.
Hence ‚à•f‚à•‚â§‚à•u‚à•, and therefore ‚à•f‚à•= ‚à•u‚à•. Finally, if u is bounded, then
for all x ‚ààX with ‚à•x‚à•‚â§1 we have
|f(x)| ‚â§|u(x)| + |u(ix)|
‚â§‚à•u‚à•(‚à•x‚à•+ ‚à•ix‚à•)
‚â§2 ‚à•u‚à•,
so f is bounded. By the foregoing, ‚à•f‚à•= ‚à•u‚à•.
2

6.1 The Hahn‚ÄìBanach Theorem
261
Let X be a vector space over F, and p a mapping of X into R. We say
that p is
‚Ä¢ subadditive if p(x + y) ‚â§p(x) + p(y) for all x, y ‚ààX;
‚Ä¢ positively homogeneous if p(Œªx) = Œªp(x) for all x ‚ààX and Œª ‚â•0;
‚Ä¢ a sublinear functional if it is subadditive and positively homogeneous;
‚Ä¢ a seminorm if it is nonnegative and subadditive, and if p(Œªx) =
|Œª| p(x) for all x ‚ààX and Œª ‚ààF.
For example, if c ‚â•0, then p(x) = c ‚à•x‚à•deÔ¨Ånes a sublinear functional on
X.
Now let X0 be a subspace of X, f0 a linear functional on X0, and f a
linear functional on X. We say that f extends f0 to X, or that f is an
extension of f0 to X, if f(x) = f0(x) for all x ‚ààX0. If also f is bounded
and ‚à•f‚à•= ‚à•f0‚à•, we say that f is a norm‚Äìpreserving extension of f0 to X.
We now prove a preliminary version of the extension theorem for linear
functionals.
(6.1.2) Proposition.
Let X be a real normed space, X0 a subspace of
X, x1 a point of X\X0, and X1 the subspace of X spanned by X0 ‚à™{x1}.
Let p be a sublinear functional on X, and f0 a linear functional on X0 such
that f0(x) ‚â§p(x) for all x ‚ààX0. Then there exists a linear functional f
that extends f0 to X1 and satisÔ¨Åes f(x) ‚â§p(x) for all x ‚ààX1.
Proof.
Since x1 /‚ààX0, each element of X1 can be written uniquely in
the form x + Œªx1 with x ‚ààX0 and Œª ‚ààR. Let œÑ be any real number, and
provisionally deÔ¨Åne
f(x + Œªx1) = f0(x) + ŒªœÑ.
It is easily shown that f is a linear extension of f0 to X1; hence it remains
to choose œÑ so that
f0(x) + ŒªœÑ ‚â§p(x + Œªx1)
(x ‚ààX0, Œª ‚ààR\ {0}) .
(2)
To this end, replacing x by Œªx, using the positive homogeneity of p, and
then dividing both sides of (2) by |Œª| , we observe that (2) is equivalent to
the two conditions
f0(x) + œÑ
‚â§
p(x + x1)
if x ‚ààX0 and Œª > 0,
‚àíf0(x) ‚àíœÑ
‚â§
p(‚àíx ‚àíx1)
if x ‚ààX0 and Œª < 0.
In turn, these two conditions can be gathered together in one:
‚àíp(‚àíx‚Ä≤ ‚àíx1) ‚àíf0(x‚Ä≤) ‚â§œÑ ‚â§p(x + x1) ‚àíf0(x)
(x, x‚Ä≤ ‚ààX0).

262
6. An Introduction to Functional Analysis
But for all x, x‚Ä≤ ‚ààX0 we have
f0(x) ‚àíf0(x‚Ä≤) = f0(x ‚àíx‚Ä≤)
‚â§p(x ‚àíx‚Ä≤)
= p(x + x1 ‚àíx‚Ä≤ ‚àíx1)
‚â§p(x + x1) + p(‚àíx‚Ä≤ ‚àíx1)
and therefore
‚àíp(‚àíx‚Ä≤ ‚àíx1) ‚àíf0(x‚Ä≤) ‚â§p(x + x1) ‚àíf0(x).
Thus in order to satisfy (2), and thereby complete the proof, we need only
invoke Exercise (1.1.1: 21).
2
This brings us to the Hahn‚ÄìBanach Theorem.
(6.1.3) Theorem.
Let X0 be a subspace of a real normed space X, p
a sublinear functional on X, and f0 a linear functional on X0 such that
f0(x) ‚â§p(x) for all x in X0. Then there exists a linear functional f that
extends f0 to X and satisÔ¨Åes f(x) ‚â§p(x) for all x ‚ààX.
Proof.
Let F denote the set of all linear functionals f that are deÔ¨Åned
on subspaces of X containing X0 and that have the following properties.
(i) f = f0 on X0 and
(ii) f(x) ‚â§p(x) for all x in the domain of f.
DeÔ¨Åne the binary relation ‚âºon F by inclusion:
f ‚âºg if and only if f ‚äÇg.
Then ‚âºis a partial order on F. Let C be a chain in F (that is, a nonempty
totally ordered subset of F), and deÔ¨Åne
G =

g‚ààC
g = {(x, y) : ‚àÉg ‚ààC (y = g(x))} .
If (x, y1) ‚ààG and (x, y2) ‚ààG, then there exist g1, g2 ‚ààC such that (x, y1) ‚àà
g1 and (x, y2) ‚ààg2. Since C is a chain, either g1 ‚äÇg2 or else, as we may
assume, g2 ‚äÇg1; then (x, y2) ‚ààg1 and therefore, as g1 is a function,
y2 = y1. It follows that G is a function on X; and that if x is in the domain
of some g ‚ààC, then x is in the domain of G, G(x) = g(x), and therefore
G(x) ‚â§p(x). It is easy to show that the domain of G contains X0, and
that G = f0 on X0. To complete the proof that G ‚ààF, we must show
that G is linear on X. To this end, given x, x‚Ä≤ in the domain of G, choose
g, g‚Ä≤ ‚ààC such that (x, G(x)) ‚ààg and (x‚Ä≤, G(x‚Ä≤)) ‚ààg‚Ä≤. As C is a chain, we

6.1 The Hahn‚ÄìBanach Theorem
263
may assume that g‚Ä≤ ‚äÇg, so that (x‚Ä≤, G(x‚Ä≤)) ‚ààg; as g is linear, it follows
that x + x‚Ä≤ is in the domain of g and therefore in the domain of G, and
that
G(x + x‚Ä≤) = g(x + x‚Ä≤)
= g(x) + g(x‚Ä≤)
= G(x) + G(x‚Ä≤).
Similarly, for each Œª ‚ààR, G(Œªx) = ŒªG(x). Hence G ‚ààF. It is trivial to
verify that G is an upper bound of C in F.
We can now apply Zorn‚Äôs Lemma (see Appendix B) to produce a maximal
element f of F. It only remains to show that f is deÔ¨Åned throughout X.
But if f is not deÔ¨Åned at some point x0 of X, then, using Proposition
(6.1.2), we can Ô¨Ånd an element g of F such that f ‚âºg and g is deÔ¨Åned at
x0. Since f is maximal in F, it follows that f = g, a contradiction.
2
The name ‚ÄúHahn‚ÄìBanach Theorem‚Äù is often applied to the following
corollary.
(6.1.4) Corollary.
Let X0 be a subspace of a normed space X, and f0
a bounded linear functional on X0. Then there exists a norm‚Äìpreserving
extension of f0 to X.
Proof.
First consider the case where f0 is a real‚Äìlinear functional on X0.
Applying Theorem (6.1.3) with p(x) = ‚à•f0‚à•‚à•x‚à•, we obtain a real‚Äìlinear
functional f that extends f0 to X and satisÔ¨Åes f(x) ‚â§‚à•f0‚à•‚à•x‚à•for all
x ‚ààX. Replacing x by ‚àíx in this last inequality, we see that
|f(x)| = max {f(x), ‚àíf(x)} ‚â§‚à•f0‚à•‚à•x‚à•
for all x ‚ààX; whence f is bounded, and ‚à•f‚à•‚â§‚à•f0‚à•. But f extends f0, so
‚à•f‚à•‚â•‚à•f0‚à•and therefore ‚à•f‚à•= ‚à•f0‚à•.
When f is a complex‚Äìlinear functional, we apply the foregoing argument
to construct a norm‚Äìpreserving extension u of the real‚Äìlinear functional
Re(f0) to X. Lemma (6.1.1) then shows us that
f(x) = u(x) ‚àíiu(ix)
deÔ¨Ånes a norm‚Äìpreserving extension of f0 to X.
2
(6.1.5) Exercises
.1
Prove the complex Hahn‚ÄìBanach Theorem: let X0 be a subspace of
a complex normed space X, p a seminorm on X, and f0 a linear
functional on X0 such that |f0(x)| ‚â§p(x) for all x ‚ààX0; then there
exists a linear functional f that extends f0 to X and satisÔ¨Åes |f(x)| ‚â§
p(x) for all x ‚ààX. (First apply the Hahn‚ÄìBanach Theorem to the
real‚Äìlinear functional Re(f0).)

264
6. An Introduction to Functional Analysis
.2
Let X be a separable normed space. Prove Theorem (6.1.3) without
using Zorn‚Äôs Lemma. (Let (xn) be a dense sequence in X, and p a
sublinear functional on X. Starting with a given linear functional f0
on a subspace X0 of X, extend f0 inductively to the subspace Xn of
X spanned by Xn‚àí1 ‚à™{xn} , such that the linear extension fn to Xn
satisÔ¨Åes fn(x) ‚â§p(x) for all x ‚ààXn. Then consider f = ‚àû
n=0 fn.)
The Hahn‚ÄìBanach Theorem‚Äîespecially in the form of Corollary (6.1.4)‚Äî
has many interesting applications. We begin with some of the simpler
ones.
(6.1.6) Proposition.
Let S be a closed subspace of a normed space X,
and let x0 ‚ààX\S. Then there exists a bounded linear functional f on X
such that
(i) f(x0) = 1 and
(ii) f(x) = 0 for all x ‚ààS.
Proof.
Let X0 be the subspace of X spanned by S ‚à™{x0}, and deÔ¨Åne
f0(x + Œªx0) = Œª
(x ‚ààS, Œª ‚ààF).
(This is a good deÔ¨Ånition: for, as x0 /‚ààS, the representation of a given
element of X0 in the form x+Œªx0, with x ‚ààS and Œª ‚ààF, is unique.) Then
f0 is a linear functional on X0, f0(x) = 0 if x ‚ààS, and f0(x0) = 1. Now,
as S is closed, we see from Exercise (3.1.10: 3) that œÅ(x0, S) > 0. So for all
x in S and all nonzero Œª ‚ààF,
‚à•x + Œªx0‚à•= |Œª|
44Œª‚àí1x + x0
44 ‚â•|Œª| œÅ(x0, S).
Hence
|f(x + Œªx0)| = |Œª| ‚â§œÅ(x0, S)‚àí1 ‚à•x + Œªx0‚à•,
and therefore f0 has the bound œÅ(x0, S)‚àí1. Applying Corollary (6.1.4) to
f0, we obtain the desired linear functional f on X.
2
(6.1.7) Proposition.
If x0 is a nonzero element of a normed space X,
then there exists a bounded linear functional f on X such that f(x0) = ‚à•x0‚à•
and ‚à•f‚à•= 1.
Proof.
Let X0 be the subspace of X generated by {x0}, deÔ¨Åne a linear
functional f0 on X0 by f0(Œªx0) = Œª ‚à•x0‚à•, and apply Corollary (6.1.4) to
f0.
2
(6.1.8) Corollary.
For each x in a normed space X,
‚à•x‚à•= sup {|f(x)| : f ‚ààX‚àó, ‚à•f‚à•= 1} .

6.1 The Hahn‚ÄìBanach Theorem
265
Proof.
If x = 0, the conclusion is trivial. If x Ã∏= 0, then for all f ‚ààX‚àó
with ‚à•f‚à•= 1 we have
|f(x)| ‚â§‚à•f‚à•‚à•x‚à•= ‚à•x‚à•.
Since, by Proposition (6.1.7), there exists f ‚ààX‚àósuch that ‚à•f‚à•= 1 and
f(x) = ‚à•x‚à•, the result follows.
2
The remaining results and exercises in this section illustrate the interac-
tion between a normed space X and its dual X‚àó, one of the most fascinat-
ing and beautiful aspects of modern analysis, in which the Hahn‚ÄìBanach
Theorem plays a fundamental part.
(6.1.9) Exercises
.1
Show that if X is a Ô¨Ånite‚Äìdimensional Banach space, then X‚àóis
Ô¨Ånite‚Äìdimensional and dim(X‚àó) = dim(X). (Reduce to the case
where X is n‚Äìdimensional Euclidean space.)
.2
Let S be a closed subspace of a Banach space X, and deÔ¨Åne
S‚ä•= {f ‚ààX‚àó: f(x) = 0 for all x ‚ààS} .
Prove that S‚ä•is a closed linear subspace of X‚àó. Show that the fol-
lowing procedure yields a well‚ÄìdeÔ¨Åned mapping T of S‚àóinto X‚àó/S‚ä•:
given f in S‚àó, choose a norm‚Äìpreserving extension F of f to X, and
set Tf equal to the element of X‚àó/S‚ä•that contains F. Prove that T
is a norm‚Äìpreserving linear isomorphism of S‚àóonto X‚àó/S‚ä•. Hence
prove that for each F ‚ààX‚àó,
sup {|F(x)| : x ‚ààS, ‚à•x‚à•‚â§1} = inf

‚à•F ‚àíf‚à•: f ‚ààS‚ä•
.
.3
Let S be a closed linear subspace of a Banach space X, let œï be
the canonical map of X onto X/S, and for each f in (X/S)‚àódeÔ¨Åne
Tf = f‚ó¶œï. Prove that T is an isometric linear isomorphism of (X/S)‚àó
onto S‚ä•. Hence prove that for each x ‚ààX,
inf {‚à•x ‚àís‚à•: s ‚ààS} = sup

|f(x)| : f ‚ààS‚ä•, ‚à•f‚à•‚â§1

.
.4
Let x1, . . . , xn be elements of a real normed space X, and c1, . . . , cn
real numbers. Prove the equivalence of the following conditions.
(i) There exists f ‚ààX‚àówith ‚à•f‚à•= 1 and f(xi) = ci for each i.
(ii) |Œª1c1 + ¬∑ ¬∑ ¬∑ + Œªncn| ‚â§‚à•Œª1x1 + ¬∑ ¬∑ ¬∑ + Œªnxn‚à•.

266
6. An Introduction to Functional Analysis
.5
Let X be a normed space, and deÔ¨Åne
-x(f) = f(x)
(x ‚ààX, f ‚ààX‚àó).
Prove that
(i) the mapping x ‚Üí-x is a linear isometry of X into its second dual
X‚àó‚àó;
(ii) X is reÔ¨Çexive (see Exercise (5.3.2: 3)) if and only if this mapping
has range X‚àó‚àó;
(iii) if X is reÔ¨Çexive, then it is a Banach space.
.6
Prove that if X is an inÔ¨Ånite‚Äìdimensional normed space, then X‚àó
is inÔ¨Ånite‚Äìdimensional. (cf. Exercise (6.1.9: 1). Suppose that X‚àóis
Ô¨Ånite‚Äìdimensional, and consider the mapping x ‚Üí-x deÔ¨Åned in the
preceding exercise.)
.7
Let X be a Banach space. Prove that
(i) if X‚àóis separable, then so is X;
(ii) if X is separable and reÔ¨Çexive, then X‚àóis separable.
(For (i), let {f1, f2, . . .} be dense in X‚àó, and for each n choose a unit
vector xn such that |fn(xn)| ‚â•1
2 ‚à•xn‚à•. Let Y be the closure of the
subspace generated by {x1, x2, . . .} , suppose that Y Ã∏= X, and use
Proposition (6.1.6) to deduce a contradiction.)
.8
Prove that a closed subspace Y of a reÔ¨Çexive Banach space X is
reÔ¨Çexive. (For each f ‚ààX‚àólet fY denote the restriction of f to Y.
Given u ‚ààY ‚àó‚àó, choose Œæ ‚ààX such that u(fY ) = f(Œæ) for all f ‚ààX‚àó.
Then use Propositions (6.1.6) and (6.1.4).)
.9
We saw in Exercise (4.4.11: 5) that the space L‚àû, introduced in
Exercise (4.4.11: 2), can be identiÔ¨Åed with the dual space of L1 =
L1(R). In this exercise we show that L1 can be identiÔ¨Åed with a
subset of the dual of L‚àûbut is not the whole of that dual.
Prove that for each g ‚ààL1,
ug(f) =
$
fg
deÔ¨Ånes an element of the dual of L‚àû. Let X0 be the set of all con-
tinuous functions f : R ‚ÜíR that vanish outside some compact set,
and deÔ¨Åne a bounded linear functional u0 on X0 by u0(f) = f(0).

6.1 The Hahn‚ÄìBanach Theorem
267
Using Corollary (6.1.4), construct a norm‚Äìpreserving extension u of
u0 to L‚àû. By considering u(fn), where
fn(x) =
Ô£±
Ô£≤
Ô£≥
(1 ‚àí|x|)n
if |x| ‚â§1
0
if |x| > 1,
show that there is no element g of L1 such that u = ug.
It follows from this exercise that, in contrast to Lp for 1 < p < ‚àû
(see Theorem (4.4.10)), L1 is not reÔ¨Çexive.
The next three lemmas, together with our work on the Hahn‚ÄìBanach
Theorem, enable us to produce a substantial strengthening of the following
consequence of Riesz‚Äôs Lemma (4.3.5): in an inÔ¨Ånite‚Äìdimensional normed
space, if 0 < Œ∏ < 1, then there exists a sequence (xn) of unit vectors such
that ‚à•xm ‚àíxn‚à•> Œ∏ whenever m Ã∏= n.
(6.1.10) Lemma.
If f, f1, . . . , fn are linear functionals on a linear space
X over F such that ker(f) ‚äÉn
i=1 ker(fi), then f, f1, . . . , fn are linearly
dependent.
Proof.
We may assume that none of the functions under consideration
is identically zero. We proceed by induction on n. In the case n = 1, choose
a ‚ààX such that f1(a) = 1. Then for each x ‚ààX,
(x ‚àíf1(x)a) ‚ààker(f1),
so
0 = f(x ‚àíf1(x)a) = f(x) ‚àíf(a)f1(x).
Hence f = f(a)f1, and therefore f and f1 are linearly dependent.
Now suppose that the lemma holds for n = k, and consider the case
n = k + 1. Let g be the restriction of f to ker(fk+1), and for i = 1, . . . , k
let gi be the restriction of fi to ker(fk+1). Then ker(g) ‚äÉk
i=1 ker(gi), so
g = k
i=1 Œªigi for some elements Œªi of F, by our induction hypothesis.
Thus f ‚àík
i=1 Œªifi vanishes on ker(fk+1). By the case n = 1 that we
have already proved, f ‚àík
i=1 Œªifi and fk+1 are linearly dependent; so
f, f1, . . . , fk+1 are linearly dependent and the induction is complete.
2
(6.1.11) Lemma.
Let X be an inÔ¨Ånite‚Äìdimensional normed space, and
f1, . . . , fn elements of X‚àó. Then n
i=1 ker(fi) Ã∏= {0} .
Proof.
First assume that the fi are linearly independent. By Exercise
(6.1.9: 6), there exists an element f of X‚àósuch that f, f1, . . . , fn are linearly
independent. Lemma (6.1.10) now shows that n
i=1 ker(fi) is not contained
in ker(f), from which the desired conclusion follows immediately.

268
6. An Introduction to Functional Analysis
Now consider the case where the fi are linearly dependent. Without
loss of generality, we may assume that for some m ‚â§n, {f1, . . . , fm} is
a basis for the linear space generated by all the fi. By the Ô¨Årst part of
the proof, there exists a nonzero element Œæ in m
i=1 ker(fi); clearly, Œæ ‚àà
n
i=1 ker(fi).
2
(6.1.12) Lemma.
Let X be an inÔ¨Ånite‚Äìdimensional normed space, and
f1, . . . , fn linearly independent elements of X‚àó. Then there exist nonzero
elements Œæ, Œ∑ of X such that fi(Œ∑) < 0 = fi(Œæ) for each i.
Proof.
The existence of Œæ follows from Lemma (6.1.11). On the other
hand, Lemma (6.1.10) shows that for each i there exists xi ‚ààX such that
fi(xi) = 1 and fj(xi) = 0 when j Ã∏= i. Setting Œ∑ = ‚àín
i=1 xi, we see that
fi(Œ∑) = ‚àí1 for each i.
2
(6.1.13) Proposition.
If X is an inÔ¨Ånite-dimensional normed space,
then there exists a sequence (xn) of unit vectors in X such that ‚à•xm ‚àíxn‚à•
> 1 whenever m Ã∏= n.
Proof.
We construct the required vectors inductively as follows. Choos-
ing a unit vector x1 ‚ààX, apply Proposition (6.1.7) to obtain f1 ‚ààX‚àó
such that ‚à•f1‚à•= 1 = f1(x1). Now suppose that we have constructed unit
vectors x1, . . . , xn in X, and linearly independent unit vectors f1, . . . , fn in
X‚àó, such that fi(xi) = 1 = ‚à•fi‚à•for each i. By Lemma (6.1.12), there exist
nonzero elements Œæ, Œ∑ of X such that fi(Œ∑) < 0 = fi(Œæ) for each i. Choose
c > 0 such that ‚à•Œ∑‚à•< ‚à•Œ∑ + cŒæ‚à•. Setting
xn+1 = ‚à•Œ∑ + cŒæ‚à•‚àí1 (Œ∑ + cŒæ) ,
note that fi(xn+1) < 0 for 1 ‚â§i ‚â§n. Now use Proposition (6.1.7) to obtain
an element fn+1 of X‚àósuch that ‚à•fn+1‚à•= 1 = fn+1(xn+1). Suppose that
fn+1 = n
i=1 Œªifi for some elements Œªi of F. Then
‚à•Œ∑ + cŒæ‚à•= fn+1(Œ∑ + cŒæ)
=
     
n

i=1
Œªifi(Œ∑ + cŒæ)
     
=
     
n

i=1
Œªifi(Œ∑)
     
= |fn+1(Œ∑)|
‚â§‚à•Œ∑‚à•
< ‚à•Œ∑ + cŒæ‚à•,
a contradiction. Hence the linear functionals f1, . . . , fn, fn+1 are linearly
independent. Moreover, if 1 ‚â§i ‚â§n, then
‚à•xn+1 ‚àíxi‚à•‚â•|fi(xn+1 ‚àíxi)| = |fi(xn+1) ‚àífi(xi)| > 1,

6.1 The Hahn‚ÄìBanach Theorem
269
since fi(xi)
=
1 and fi(xn+1)
<
0. This completes our inductive
construction.
2
A sequence (xn) in a Banach space X is called a Schauder basis if for each
x ‚ààX there exists a unique sequence (Œªn) in F such that x = ‚àû
n=1 Œªnxn.
In that case, X is separable, and the mapping x ‚Üí(Œªn)‚àû
n=1 can be used to
identify X with a sequence space.
The notion of a Schauder basis generalises that of a basis in a Ô¨Ånite‚Äì
dimensional space. In the spaces c0 and lp (1 ‚â§p < ‚àû) let en be the
vector with nth term equal to 1 and all other terms 0; then {e1, e2, . . .} is
a Schauder basis. Schauder bases for other separable Banach spaces, such
as C[0, 1], are not so easy to construct, and EnÔ¨Ço [15] has shown that there
exist separable Banach subspaces of c0 that do not have a Schauder basis.
We can, however, prove the following theorem.
(6.1.14) Theorem.
Every inÔ¨Ånite‚Äìdimensional Banach space contains
an inÔ¨Ånite‚Äìdimensional closed subspace with a Schauder basis.
The next two lemmas make this possible.
(6.1.15) Lemma.
Let (xn) be a total sequence of nonzero elements of a
Banach space X, and c a positive number such that if Œª1, . . . , Œªn belong to
F, and m < n, then
44444
m

i=1
Œªixi
44444 ‚â§c
44444
n

i=1
Œªixi
44444 .
(3)
Then (xi) is a Schauder basis for X.
Proof.
Consider any sequence (Œªn) in F such that ‚àû
i=1 Œªixi converges
in X. If n > k, then
|Œªk| = ‚à•xk‚à•‚àí1 ‚à•Œªkxk‚à•
‚â§c ‚à•xk‚à•‚àí1
44444
n

i=k
Œªixi
44444 .
Letting n ‚Üí‚àû, we see that
|Œªk| ‚â§c ‚à•xk‚à•‚àí1
44444
‚àû

i=k
Œªixi
44444 .
A simple induction argument now enables us to prove that if ‚àû
i=1 Œªixi =
0, then Œªi = 0 for each i. Thus a given element of X has at most one
representation in the form ‚àû
i=1 Œªixi with each Œªi in F. It remains to show
that such a representation exists.

270
6. An Introduction to Functional Analysis
Let X‚àûbe the subspace of X generated by {x1, x2, . . .} , and for each n
let Xn be the subspace generated by {x1, . . . , xn}. DeÔ¨Åne a (clearly linear)
mapping Pn of X‚àûonto Xn by
Pn
 ‚àû

i=1
Œªixi

=
n

i=1
Œªixi.
It follows from (3) that c is a bound for Pn on X‚àû. But X‚àûis dense in
X, so, by Exercise (4.2.2: 10), Pn extends to a bounded linear mapping Pn
on X with bound c. By Corollary (6.1.4), the mapping ‚àû
i=1 Œªixi ‚ÜíŒªn
extends to a bounded linear functional fn on X such that
fn(x)xn = Pn(x) ‚àíPn‚àí1(x),
where, for convenience, we set P0(x) = 0.
We prove that x = ‚àû
n=1 fn(x)xn for each x ‚ààX. To this end, let Œµ > 0
and, using the fact that the sequence (xn) is total, choose Œª1, . . . , ŒªN in F
such that
44444x ‚àí
N

n=1
Œªnxn
44444 < Œµ.
For each k ‚â•N we have
‚à•x ‚àíPk(x)‚à•‚â§
44444x ‚àí
N

n=1
Œªnxn
44444 +
44444
N

n=1
Œªnxn ‚àíPk(x)
44444
< Œµ +
44444Pk
 N

n=1
Œªnxn ‚àíx
44444
‚â§Œµ + ‚à•Pk‚à•
44444
N

n=1
Œªnxn ‚àíx
44444
‚â§Œµ + ‚à•Pk‚à•Œµ
‚â§(1 + c)Œµ.
Hence
x = lim
k‚Üí‚àûPkx = lim
k‚Üí‚àû
k

n=1
fn(x)xn =
‚àû

n=1
fn(x)xn.
2
(6.1.16) S. Mazur‚Äôs Lemma.
Let Y be a Ô¨Ånite‚Äìdimensional subspace
of an inÔ¨Ånite‚Äìdimensional Banach space X. Then for each Œµ > 0 there
exists a unit vector Œæ ‚ààX such that
‚à•y‚à•‚â§(1 + Œµ) ‚à•y + ŒªŒæ‚à•
(4)
for all y ‚ààY and Œª ‚ààF.

6.1 The Hahn‚ÄìBanach Theorem
271
Proof.
Without loss of generality we may take Œµ < 1. Let {y1, . . . , yn}
be an Œµ/2‚Äìapproximation to the set
S = {y ‚ààY : ‚à•y‚à•= 1}
(which is compact, by Exercise (4.3.7: 2)). Using Proposition (6.1.7), for
i = 1, . . . , n construct fi ‚ààX‚àówith norm 1 such that fi(yi) = 1. By
Lemma (6.1.11), there exists a unit vector Œæ ‚ààn
i=1 ker(fi). Consider any
vector y ‚ààY and any Œª ‚ààF. If y = 0, then (4) is trivial. If y Ã∏= 0, then we
may assume that ‚à•y‚à•= 1: otherwise, we just consider ‚à•y‚à•‚àí1 y. Choosing i
such that ‚à•y ‚àíyi‚à•< Œµ/2, we have
‚à•y + ŒªŒæ‚à•‚â•‚à•yi + ŒªŒæ‚à•‚àí‚à•y ‚àíyi‚à•
‚â•fi(yi + ŒªŒæ) ‚àíŒµ
2
= 1 ‚àíŒµ
2
>
1
1 + Œµ,
since Œµ < 1. Hence (4) obtains.
2
Proof of Theorem (6.1.14).
Let X be an inÔ¨Ånite‚Äìdimensional Banach
space, and Œµ > 0. Choose positive numbers Œµn such that
ln (1 + Œµn) < 2‚àín‚àí2 ln (1 + Œµ)
for each n. Then
‚àû
:
n=1
(1 + Œµn) = lim
N‚Üí‚àû
N
:
n=1
(1 + Œµn) ‚â§
‚àö
1 + Œµ < 1 + Œµ.
Let x1 be a unit vector in X. By Mazur‚Äôs Lemma, there exists a unit vector
x2 ‚ààX such that
‚à•y‚à•‚â§(1 + Œµ1) ‚à•y + Œªx2‚à•
for all y in the subspace generated by x1 and for all Œª ‚ààF. By the same
lemma, there exists a unit vector x3 ‚ààX such that
‚à•y‚à•‚â§(1 + Œµ2) ‚à•y + Œªx3‚à•
for all y in the subspace generated by {x1, x2} and for all Œª ‚ààF. Carrying
on in this way, we construct an inÔ¨Ånite sequence (xn) of unit vectors in X
such that
‚à•y‚à•‚â§(1 + Œµn) ‚à•y + Œªxn+1‚à•
for all y in the subspace generated by {x1, . . . , xn} and for all Œª ‚ààF. It
follows that if Œª1, . . . , Œªn ‚ààF and m < n, then
44444
m

i=1
Œªixi
44444 ‚â§(1 + Œµm)
44444
m

i=1
Œªixi + Œªm+1xm+1
44444

272
6. An Introduction to Functional Analysis
‚â§(1 + Œµm)(1 + Œµm+1)
44444
m+1

i=1
Œªixi + Œªm+2xm+2
44444
‚â§¬∑ ¬∑ ¬∑
‚â§(1 + Œµm)(1 + Œµm+1) ¬∑ ¬∑ ¬∑ (1 + Œµn‚àí1)
44444
n

i=1
Œªixi
44444
‚â§(1 + Œµ)
44444
n

i=1
Œªixi
44444 .
Hence, by Lemma (6.1.15), (xn)‚àû
n=1 is a Schauder basis of the closure of
the subspace of X that it generates. 2
For our last application of the Hahn‚ÄìBanach Theorem in this section,
we show that if I is a compact interval, then the dual space C(I)‚àócan be
isometrically embedded in the Banach space

BV(I), ‚à•¬∑‚à•bv
	
of functions of
bounded variation on I (introduced in Exercise (4.5.2: 4)). To this end, for
convenience we say that a bounded function f : I ‚ÜíR is representable if
there exists an increasing sequence (fn) of elements of C(I) that converges
simply to f. We denote by R(I) the subspace of B(I) consisting of all
bounded real‚Äìvalued functions on I that can be written as the diÔ¨Äerence
of two representable functions. Note that C(I) ‚äÇR(I).
(6.1.17) Exercises
1.
Prove that if J
is a compact subinterval of I, then ‚àíœáJ
is
representable.
.2
Let f ‚ààC(I), where I = [a, b], let P = (x0, . . . , xn) be a partition of
I, and for each k (0 ‚â§k ‚â§n ‚àí1) let Œæk be any point of [xk, xk+1].
DeÔ¨Åne œà ‚ààB(I) by
œà =
n‚àí1

k=0
f(Œæk)

œá[a,xk+1] ‚àíœá[a,xk]

.
Show that ‚à•f ‚àíœà‚à•‚Üí0 as the mesh of P tends to 0.
(6.1.18) Theorem.
Let I = [a, b] be a compact interval. Then for each
real‚Äìvalued function Œ± of bounded variation on I,
uŒ± =
$ b
a
f(x) dŒ±(x)
deÔ¨Ånes a bounded linear functional, with norm TŒ±(a, b), on the Banach
space C(I). Moreover, each bounded linear functional on C(I) is of the form

6.1 The Hahn‚ÄìBanach Theorem
273
uŒ±, where Œ± is a function of bounded variation on I that is unique up to
an additive constant.
Proof.
Throughout this proof, P = (x0, x1, . . . , xn) is a partition of I,
and for each i, Œæi is any point of the interval [xi, xi+1]. Consider Ô¨Årst a real‚Äì
valued function Œ± of bounded variation on I. The linearity of uŒ± follows
from Exercise (1.5.16: 4). For each f ‚ààC(I) we have the following inequality
for Riemann‚ÄìStieltjes sums:
     
n‚àí1

i=0
f(Œæi)(Œ±(xi+1) ‚àíŒ±(xi))
     ‚â§‚à•f‚à•
n‚àí1

i=0
|Œ±(xi+1) ‚àíŒ±(xi)|
‚â§‚à•f‚à•TŒ±(a, b).
In the limit as the mesh of the partition tends to 0 we obtain the inequality
|uŒ±(f)| ‚â§‚à•f‚à•TŒ±(a, b),
which shows that the linear functional uŒ± has bound TŒ±(a, b).
Now consider any bounded linear functional u on C(I). By Corollary
(6.1.4), there exists a norm‚Äìpreserving extension u‚ôØof u to R(I). Referring
to Exercise (6.1.17: 1), deÔ¨Åne a function Œ± : I ‚ÜíR by
Œ±(x) = u‚ôØ(œá[a,x])
(x ‚ààI) .
To show that Œ± is of bounded variation on I, let P be as in the foregoing,
and for each k (0 ‚â§k ‚â§n ‚àí1) let
œÉk = sgn (Œ±(xk+1) ‚àíŒ±(xk)) .
Then
œÜ =
n‚àí1

k=0
œÉk

œá[a,xk+1] ‚àíœá[a,xk]

‚ààR(I),
‚à•œÜ‚à•‚â§1, and
n‚àí1

k=0
|Œ±(xk+1) ‚àíŒ±(xk)| = u‚ôØ(œÜ) ‚â§
44u‚ôØ44 = ‚à•u‚à•.
Hence Œ± is of bounded variation on I, and
TŒ±(a, b) ‚â§‚à•u‚à•.
(5)
If, now, f is any element of C(I), consider the function
œà =
n‚àí1

k=0
f(Œæk)

œá[a,xk+1] ‚àíœá[a,xk]

,

274
6. An Introduction to Functional Analysis
which, again by Exercise (6.1.17: 1), belongs to R(I). We have
     u(f) ‚àí
n‚àí1

k=0
f(Œæk) (Œ±(xk+1) ‚àíŒ±(xk))
     =
  u‚ôØ(f) ‚àíu‚ôØ(œà)
  
‚â§‚à•u‚à•‚à•f ‚àíœà‚à•.
Letting the mesh of the partition P tend to 0, we see from Exercise
(6.1.17: 2) that ‚à•f ‚àíœà‚à•‚Üí0; also,
n‚àí1

k=0
f(Œæk) (Œ±(xk+1) ‚àíŒ±(xk)) ‚Üí
$ b
a
f(x) dŒ±(x).
Hence u(f) = uŒ±(f). Moreover, from (5) and the Ô¨Årst part of the proof,
‚à•u‚à•= TŒ±(a, b).
Finally, the uniqueness, up to an additive constant, of the function Œ±
corresponding to the given bounded linear functional u on C(I) follows
from Proposition (1.5.19).
2
The full power of the Hahn‚ÄìBanach Theorem is not needed to prove
Theorem (6.1.18): for, as is shown on pages 106‚Äì110 of [40], it is possible
to construct an extension of u to R(I) by elementary means.
We say that a function f : I ‚ÜíR of bounded variation on I = [a, b]
is normalised if f(a) = 0. It is easy to show that the normalised elements
form a closed, and therefore complete, linear subspace of the Banach space

BV(I), ‚à•¬∑‚à•bv
	
.
(6.1.19) Corollary.
Under the hypotheses of Theorem (6.1.18), C(I)‚àóis
isometrically isomorphic to the Banach space of normalised functions of
bounded variation on I.
(6.1.20) Exercises
.1
Let I = [a, b] be a compact interval. Prove that the normalised el-
ements of BV(I) form a Banach space relative to the norm ‚à•¬∑‚à•bv .
Then prove Corollary (6.1.19).
.2
Compute the norm of the bounded linear functional u deÔ¨Åned on
C[‚àí1, 1] by
u(f) =
‚àû

n=1
(‚àí1)n
n2
f(1/n).
.3
Let X be a compact metric space, and u a linear functional on C(X)
that is positive, in the sense that u(f) ‚â•0 for all nonnegative f ‚àà
C(X). Prove that u is bounded and has norm equal to u(1), where 1
is the constant function x ‚Üí1 on X.

6.2 Separation Theorems
275
.4
Let u be a bounded linear functional on C(X), where X is a com-
pact metric space. Prove that there exist positive linear function-
als v, w on C(X) such that u = v ‚àíw. (For f ‚â•0 in C(X) let
v(f) = sup {u(g) : g ‚ààC(X), 0 ‚â§g ‚â§f} .)
6.2
Separation Theorems
In this section we use the Hahn‚ÄìBanach Theorem to establish a number
of geometric results about the separation of convex sets by a hyperplane.
These results have many applications, including some signiÔ¨Åcant ones in
mathematical economics (see Appendix C).
If A is a subset of a vector space, and t ‚ààF, we deÔ¨Åne
tA = {tx : x ‚ààA} .
(6.2.1) Lemma.
Let X be a normed space, and A a convex subset of X
containing 0 in its interior. Then the Minkowski functional p : X ‚ÜíR,
deÔ¨Åned by
p(x) = inf {t > 0 : x ‚ààtA} ,
is a sublinear functional on X. If p(x) < 1, then x ‚ààA; and if A is open,
then
A = {x ‚ààX : p(x) < 1} .
Proof.
Choose r > 0 such that B(0, r) ‚äÇA. If x Ã∏= 0, then
x ‚àà2 ‚à•x‚à•
r
B(0, r) ‚äÇ2 ‚à•x‚à•
r
A.
It follows that p is deÔ¨Åned throughout X. Let Œ±, Œ≤ be positive numbers
such that x ‚ààŒ±A and y ‚ààŒ≤A; then
x + y = (Œ± + Œ≤)

Œ±
Œ± + Œ≤ Œ±‚àí1x +
Œ≤
Œ± + Œ≤ Œ≤‚àí1y

,
where, by convexity,
Œ±
Œ± + Œ≤ Œ±‚àí1x +
Œ≤
Œ± + Œ≤ Œ≤‚àí1y ‚ààA.
So x + y ‚àà(Œ± + Œ≤)A. It now follows that p(x + y) ‚â§p(x) + p(y). On the
other hand, if Œª > 0, then for all positive t we have
Œªx ‚ààtA ‚áîx ‚àà

Œª‚àí1t
	
A
and therefore
t ‚â•p(Œªx) ‚áîŒª‚àí1t ‚â•p(x),

276
6. An Introduction to Functional Analysis
so p(Œªx) = Œªp(x). This last equation also holds when Œª = 0, since p(0) = 0.
Thus p is a sublinear functional on X.
If p(x) < 1, then there exists t ‚àà(0, 1) such that t‚àí1x ‚ààA; by the
convexity of A, x = (1 ‚àít)0 + t(t‚àí1x) belongs to A.
Finally, suppose that A is open, and consider any x ‚ààA. Since p(0) = 0,
to prove that p(x) < 1 we may assume that x Ã∏= 0. Choose s > 0 such that
B (x, s ‚à•x‚à•) ‚äÇA; then (1 + s)x ‚ààA, so p(x) ‚â§(1 + s)‚àí1 < 1.
2
(6.2.2) Lemma.
Let A be a nonempty open convex subset of a normed
space X, and x0 a point of X\A. Then there exists a bounded real‚Äìlinear
functional f on X such that f(x) < f(x0) for all x in A.
Proof.
By translation, we may assume that 0 ‚ààA; so, by Lemma (6.2.1),
p(x) = inf

t > 0 : t‚àí1x ‚ààA

deÔ¨Ånes a sublinear functional on X, and p(x) < 1 if and only if x ‚ààA.
Hence p(x0) ‚â•1. Let X0 be the real linear subspace of X generated by
{x0}, and deÔ¨Åne a bounded real‚Äìlinear functional f0 on X0 by
f0(Œªx0) = Œª
(Œª ‚ààR).
If Œª ‚â•0, then
f0(Œªx0) = Œª ‚â§Œªp(x0) = p(Œªx0);
if Œª < 0, then
f0(Œªx0) = Œª < 0 ‚â§p(Œªx0).
Thus f0(x) ‚â§p(x) for all x ‚ààX0. By the Hahn‚ÄìBanach Theorem (6.1.3),
there exists a real‚Äìlinear functional f on X such that
‚Ä¢ f(x) = f0(x) for all x ‚ààX0, and
‚Ä¢ f(x) ‚â§p(x) for all x ‚ààX.
For all x ‚ààA,
f(x) ‚â§p(x) < 1 = f(x0).
It follows that the nonempty open set A is contained in the complement
of the translated hyperplane x0 + ker(f); whence, by Exercise (4.2.5: 3)
and Lemma (4.1.4), the hyperplane ker(f) is closed in X. It follows from
Proposition (4.2.3) that f is bounded.
2
(6.2.3) Proposition.
Let C be a nonempty closed convex subset of a
normed space X, and x0 a point of X\C. Then there exist a bounded real‚Äì
linear functional f on X, and a real number Œ±, such that f(x) < Œ± < f(x0)
for all x ‚ààC.

6.2 Separation Theorems
277
Proof.
Choose r > 0 such that B(x0, r) ‚à©C = ‚àÖ. By Exercise (4.1.5: 6),
A = {x + y : x ‚ààC, y ‚ààB(0, r)}
is open and convex; also, x0 /‚ààA. By Lemma (6.2.2), there exists a bounded
real‚Äìlinear functional f on X such that f(x) < f(x0) for all x in A. Since f
is not identically 0, f(b) > 0 for some b ‚ààB(0, r). Taking Œ± = f(x0)‚àíf(b),
we see that for all x ‚ààC,
f(x) = f(x + b) ‚àíf(b) < Œ± < f(x0).
2
(6.2.4) Exercises
.1
Let A be a compact convex subset of a real normed space X, and
B a closed convex subset of X. Prove that there exist f ‚ààX‚àóand
Œ±, Œ≤ ‚ààR such that f(x) ‚â§Œ± < Œ≤ ‚â§f(y) for all x ‚ààA and y ‚ààB.
.2
Prove Helly‚Äôs Theorem: let F be a Ô¨Ånite family of convex subsets of
Rn with the property that the intersection of any n + 1 sets in F is
nonempty; then  F is nonempty. (First use induction on the number
of sets in F; then use induction on the dimension n.)
.3
Let K be a convex subset of a normed space X, and S ‚äÇK. We say
that S is an extreme subset of K if, for any distinct points x, y of K
such that 1
2(x + y) ‚ààS, we have x ‚ààS and y ‚ààS. If also S contains
only one element, then that element is called an extreme point of K.
Prove that the intersection of any family of extreme subsets of K is
either empty or an extreme subset.
Now suppose that K is also compact, and let E be the family of all
extreme subsets of K, partially ordered by inclusion. Prove that E has
a minimal element S0. (Use the Ô¨Ånite intersection property and Zorn‚Äôs
Lemma.) Then prove that S0 consists of a single point. (Suppose that
S0 contains two distinct points Œæ, Œ∑. Choose f ‚ààX‚àósuch that f(Œæ) <
f(Œ∑), and let Œ± = supx‚ààK f(x). Show that S1 = {x ‚ààS0 : f(x) = Œ±}
is an extreme subset of K such that S0\S1 Ã∏= ‚àÖ.)
Finally, prove that K has at least one extreme point.
.4
By the convex hull of a subset K of a normed space we mean the set
of all elements of the form N
n=1 Œªixi, where the xi are elements of K
and the Œªi are nonnegative real numbers such that N
i=1 Œªi = 1. Prove
the Krein‚ÄìMilman Theorem: a compact convex subset of a normed
space X is the closure of the convex hull of the set of its extreme
points. (Let C be the convex hull of the set of extreme points of the
compact convex set, let x0 ‚ààX\C, and apply Proposition (6.2.3).)

278
6. An Introduction to Functional Analysis
When X = Rn, there is a weak extension of Proposition (6.2.3) to the
case where C need not be closed.
(6.2.5) Proposition.
Let C be a nonempty convex subset of the Eu-
clidean space Rn, and x0 a point of Rn\C. Then there exists a bounded
real‚Äìlinear functional f on Rn such that f(x) ‚â§f(x0) for all x ‚ààC.
Proof.
Since C is nonempty, closed, and convex, Proposition (6.2.3) al-
lows us to assume that x0 ‚ààC\C. Then, by Exercise (4.1.5: 7), each open
ball with centre x0 contains some point of the complement of C. Choose a
sequence (xk) in Rn that converges to x0, such that xk /‚ààC for each k. By
Proposition (6.2.3) and Theorem (5.3.1), for each k there exist pk ‚ààRn
and Œ±k ‚ààR such that
‚Ä¢ ‚ü®x, pk‚ü©< Œ±k for all x ‚ààC, and
‚Ä¢ ‚ü®xk, pk‚ü©= Œ±k.
Replacing pk by ‚à•pk‚à•‚àí1 pk, we may assume that ‚à•pk‚à•= 1 for each k.
Since the unit ball of Rn is compact (Theorem (4.3.6)), we may pass to
a subsequence and assume that (pk) converges to a limit p in Rn; then
‚à•p‚à•= 1. Also, as
|Œ±k| ‚â§‚à•pk‚à•‚à•xk‚à•= ‚à•xk‚à•
and the sequence (‚à•xk‚à•) , being convergent, is bounded, (Œ±k) is a bounded
sequence in R. Passing to another subsequence, we may further assume
that (Œ±k) converges to a limit Œ± in R. By continuity, for all x ‚ààC we have
‚ü®x, p‚ü©‚â§Œ± = ‚ü®x0, p‚ü©.
It remains to take f(x) = ‚ü®x, p‚ü©.
2
Let H be a hyperplane in the normed space X, and a an element of X\H.
By Propositions (4.2.4) and (6.1.1), for each Œ± ‚ààR there exists a unique
real‚Äìlinear functional f on X such that
a + H = {x ‚ààX : f(x) = Œ±} .
We say that the translated hyperplane a + H separates the nonempty sub-
sets A and B of X if f(x) ‚â§Œ± for all x ‚ààA, and f(x) ‚â•Œ± for all
x ‚ààB.
(6.2.6) Minkowski‚Äôs Separation Theorem.
Let A and B be dis-
joint nonempty convex subsets of Rn. Then there exists a closed translated
hyperplane that separates A and B.
Proof.
The nonempty set
C = B ‚àíA = {x ‚àíy : x ‚ààB, y ‚ààA}

6.3 Baire‚Äôs Theorem and Beyond
279
is convex, and 0 /‚ààC. By Proposition (6.2.5), there exists a bounded real‚Äì
linear functional f on Rn such that f(z) ‚â•f(0) = 0 for all z ‚ààC. Hence
f(x) ‚â•f(y) for all x ‚ààA and y ‚ààB, and we need only apply Exer-
cise (1.1.1: 21) to obtain the required real number Œ±. The corresponding
hyperplane f ‚àí1 ({Œ±}) then separates A and B.
2
(6.2.7) Exercise
Let A, B be disjoint nonempty convex subsets of a normed space
X such that A is compact and B is closed. Prove that there exist a
bounded real‚Äìlinear functional f on X, and a real number Œ±, such that
f(x) > Œ± for all x ‚ààA, and f(x) < Œ± for all x ‚ààB. (Reduce to the
case where A = {0}, note Exercise (4.1.5: 6), and apply Proposition
(6.2.3).)
6.3
Baire‚Äôs Theorem and Beyond
In this section we prove one of the most useful theorems about complete
metric spaces, Baire‚Äôs Theorem, and then study several of its many interest-
ing consequences. Among these are the existence of uncountably many con-
tinuous, nowhere diÔ¨Äerentiable functions on [0, 1], and the Open Mapping
Theorem for bounded linear mappings between Banach spaces.
(6.3.1) Baire‚Äôs Theorem.
The intersection of a sequence of dense open
sets in a complete metric space is dense.
Proof.
Let X be a complete metric space, (Un) a sequence of dense open
subsets of X, and
U =
‚àû

n=1
Un.
We need only prove that for x0 ‚ààX and r0 > 0, the set U ‚à©B(x0, r0)
is nonempty. To this end, since U1 is dense in X, we can Ô¨Ånd x1 in
U1 ‚à©B(x0, r0). Moreover, since both U1 and B(x0, r0) are open, so is their
intersection; whence there exists r1 such that 0 < r1 < 1 and
B(x1, r1) ‚äÇU1 ‚à©B(x0, r0).
Since U2 is dense in X, we can now Ô¨Ånd x2 in U2 ‚à©B(x1, r1); but U2 ‚à©
B(x1, r1) is open, so there exists r2 such that 0 < r2 < 1/2 and
B(x2, r2) ‚äÇU2 ‚à©B(x1, r1).
Carrying on in this way, we construct a sequence (xn) of points of X, and a
sequence (rn) of positive numbers, such that for each n ‚â•1, 0 < rn < 1/n
and
B(xn, rn) ‚äÇUn ‚à©B(xn‚àí1, rn‚àí1).

280
6. An Introduction to Functional Analysis
By induction, if m ‚â•n, then xm ‚ààB(xn, rn); whence
œÅ(xm, xn) < rn < 1
n
(m ‚â•n).
(1)
Thus (xn) is a Cauchy sequence in X. Since X is complete, (xn) con-
verges to a limit x‚àûin X. Letting m tend to ‚àûin inequality (1), we have
œÅ(x‚àû, xn) ‚â§rn, and therefore x‚àû‚ààB(xn, rn), for each n. Taking n = 0,
we see that x‚àû‚ààB(x0, r0); taking n ‚â•1, we see that x‚àû‚ààUn. 2
The alternative name Baire Category Theorem for Theorem (6.3.1)
originates from the following deÔ¨Ånitions (due to Baire).
A subset S of a metric space X is said to be
‚Ä¢ nowhere dense in X if the interior of S is empty;
‚Ä¢ of the Ô¨Årst category if it is a countable union of nowhere dense subsets;
‚Ä¢ of the second category if it is not of the Ô¨Årst category.
Baire‚Äôs Theorem is equivalent to the statement a nonempty complete metric
space is of the second category.
(6.3.2) Exercises
.1
Prove the last statement; more precisely, prove that if a nonempty
complete metric space is the union of a sequence of closed sets, then
at least one of those closed sets has a nonempty interior.
.2
Prove the extended version of Cantor‚Äôs theorem on the uncountability
of R (Exercise (1.2.11: 4)): if (xn) is a sequence of real numbers, then
{x ‚ààR : ‚àÄn (x Ã∏= xn)} is dense in R.
.3
Prove that a nonempty complete metric space without isolated points
is uncountable.
We now show how Baire‚Äôs Theorem can be used to prove the existence
of continuous functions on I = [0, 1] that are nowhere diÔ¨Äerentiable on I.
For each positive integer n let En be the set of all f ‚ààC(I) with the
property:
there exists t ‚àà
;
0, 1 ‚àín‚àí1<
such that |f(t + h) ‚àíf(t)| ‚â§nh
whenever 0 < h < 1 ‚àít.
Note that ‚àû
n=1 En contains any f ‚ààC(I) such that for some t ‚àà[0, 1) the
right‚Äìhand derivative of f at t,
f ‚Ä≤(t+) =
lim
h‚Üí0,h>0
f(t + h) ‚àíf(t)
h
,

6.3 Baire‚Äôs Theorem and Beyond
281
exists. To see this, consider such f and t. Choose a positive integer n1 such
that t ‚àà
;
0, 1 ‚àín‚àí1
1
<
and |f ‚Ä≤(t+)| < n1. Next choose h0 > 0 such that if
0 < h < h0, then |f(t + h) ‚àíf(t)| ‚â§n1h. If h0 = 1 ‚àít, set n = n1. If
h0 < 1 ‚àít, then for h0 ‚â§h < 1 ‚àít we have
|f(t + h) ‚àíf(t)| ‚â§2 ‚à•f‚à•
h0
h,
where ‚à•¬∑‚à•denotes the sup norm on C(I); so, taking n = max {n1, n2} ,
where the positive integer n2 > 2 ‚à•f‚à•/h0, we have f ‚ààEn.
We prove that C(I)\En is dense and open in I. To this end, Ô¨Årst let
(fk)‚àû
k=1 be a sequence in En that converges to a limit f in C(I). Then there
exists a sequence (tk) in
;
0, 1 ‚àín‚àí1<
such that
|fk(tk + h) ‚àífk(tk)| ‚â§nh
whenever k ‚â•1 and 0 < h < 1 ‚àítk. Since
;
0, 1 ‚àín‚àí1<
is sequentially
compact, we may assume without loss of generality that (tk) converges to
a limit t ‚àà
;
0, 1 ‚àín‚àí1<
. If 0 < h < 1 ‚àít, then for all suÔ¨Éciently large k we
have 0 < h < 1 ‚àítk and therefore
|f(t + h) ‚àíf(t)| ‚â§|f(t + h) ‚àíf(tk + h)| + |f(tk + h) ‚àífk(tk + h)|
+ |fk(tk + h) ‚àífk(tk)| + |fk(tk) ‚àíf(tk)|
+ |f(tk) ‚àíf(t)|
‚â§|f(t + h) ‚àíf(tk + h)| + ‚à•f ‚àífk‚à•+ nh
+ ‚à•f ‚àífk‚à•+ |f(tk) ‚àíf(t)| .
Letting k ‚Üí‚àûand using the continuity of f, we obtain
|f(t + h) ‚àíf(t)| ‚â§nh.
Hence f ‚ààEn, and therefore En is closed in C(I). Thus C(I)\En is open
in C(I).
Given f ‚ààC(I) and Œµ > 0, we now use the Weierstrass Approximation
Theorem (4.6.1) to construct a polynomial function p such that ‚à•f ‚àíp‚à•<
Œµ/2. Choosing a positive integer
N > Œµ‚àí1 (n + ‚à•p‚Ä≤‚à•) ,
deÔ¨Åne a continuous function q : [0, 1] ‚ÜíR such that for 0 ‚â§k ‚â§N ‚àí1,
q
 k
N

= 0,
q
k + 1
2
N

= Œµ/2,

282
6. An Introduction to Functional Analysis
and q is linear on each of the intervals
= k
N , k + 1
2
N
>
,
=k + 1
2
N
, k + 1
N
>
.
Let g = p + q ‚ààC(I). For each t ‚àà[0, 1) we have
  g‚Ä≤(t+)
  ‚â•
  q‚Ä≤(t+)
  ‚àí|p‚Ä≤(t)| ‚â•NŒµ ‚àí‚à•p‚Ä≤‚à•> n,
so g /‚ààEn. Since
‚à•f ‚àíg‚à•‚â§‚à•f ‚àíp‚à•+ ‚à•q‚à•< Œµ,
we conclude that C(I)\En is dense in C(I).
Now let Fn be the set of all f ‚ààC(I) with the property:
there exists t ‚àà
;
n‚àí1, 1
<
such that |f(t + h) ‚àíf(t)| ‚â§nh
whenever 0 < h < t.
Arguments similar to those just used show that C(I)\Fn is dense and open
in C(I), and that it contains any f ‚ààC(I) such that for some t ‚àà(0, 1] the
left‚Äìhand derivative of f at t,
f ‚Ä≤(t‚àí) =
lim
h‚Üí0,h<0
f(t + h) ‚àíf(t)
h
,
exists. Let
S =
‚àû

n=1
En ‚à™
‚àû

n=1
Fn.
Since C(I) is complete (Proposition (4.5.4)), we see from Baire‚Äôs Theorem
that
C(I)\S =
‚àû

n=1
(C(I)\En) ‚à©
‚àû

n=1
(C(I)\Fn)
is dense in C(I). Clearly, C(I)\S consists of continuous, nowhere diÔ¨Äeren-
tiable functions on I.
(6.3.3) Exercises
.1
Prove that [0, 1] cannot be written as the union of a sequence of
pairwise‚Äìdisjoint closed sets. (Suppose that there exists a sequence
(Fn) of pairwise‚Äìdisjoint closed sets whose union is [0, 1] . Show that
the union of the boundaries of the sets Fn is closed and has an empty
interior.)
.2
Let X be a Banach space, and C a closed convex subset of X that is
absorbing‚Äîthat is, for each x ‚ààX there exists t > 0 such that tx ‚ààC.
Prove that 0 does not belong to the closure of X\C. (Suppose the
contrary, and show that for each positive integer n the complement
of nC is dense and open in X.)

6.3 Baire‚Äôs Theorem and Beyond
283
.3
Prove that if a Banach space is generated by a compact set, then it
is Ô¨Ånite‚Äìdimensional.
.4
Let X be a complete metric space, and (fi)i‚ààI a family of continuous
mappings of X into R. Suppose that for each x ‚ààX there exists
Mx > 0 such that |fi(x)| ‚â§Mx for all i ‚ààI. Prove that there exist
a nonempty open set E ‚äÇX and a positive integer N such that
|fi(x)| ‚â§N for all i ‚ààI and all x ‚ààE. (Let
Cn,i
=
{x ‚ààX : |fi(x)| ‚â§n} ,
Cn
=

i‚ààI Cn,i,
and use Baire‚Äôs Theorem.)
A mapping f between metric spaces X and Y is called an open mapping
if f(S) is an open subset of Y whenever S is an open subset of X.
(6.3.4) Exercise
Prove that a linear mapping T between normed spaces X, Y is open
if and only if there exists r > 0 such that B(0, r) ‚äÇT(B(0, 1)).
We now aim to apply Baire‚Äôs Theorem to prove the following fundamental
result on linear mappings between Banach spaces.
(6.3.5) The Open Mapping Theorem.
A bounded linear mapping of
a Banach space onto a Banach space is open.
The next lemma prepares us for the proof of this theorem.
(6.3.6) Lemma.
Let T be a linear mapping of a Banach space X into a
normed space Y . Then T is open if and only if there exists r > 0 such that
B (0, r) ‚äÇT

B (0, 1)
	
.
Proof.
Suppose that such a real number r exists. In view of the pre-
ceding exercise, it suÔ¨Éces to prove that B(0, r/2) ‚äÇT(B(0, 1)). Given
y ‚ààB(0, r/2), since 2y ‚ààB(0, r), we can Ô¨Ånd an element x1 of the unit
ball of X such that
‚à•2y ‚àíTx1‚à•< r
2.
So 22y ‚àí2Tx1 ‚ààB(0, r), and therefore there exists x2 in the unit ball of
X such that
4422y ‚àí2Tx1 ‚àíTx2
44 < r
2.
Carrying on in this way, we construct a sequence (xn) of elements of the
unit ball of X such that
442Ny ‚àí2N‚àí1Tx1 ‚àí2N‚àí2Tx2 ‚àí¬∑ ¬∑ ¬∑ ‚àíTxN
44 < r
2

284
6. An Introduction to Functional Analysis
for each N. Thus
44444y ‚àí
N

n=1
2‚àínTxn
44444 < 2‚àíN‚àí1r,
and therefore the series ‚àû
n=1 2‚àínTxn converges to y. Since
k

n=j
2‚àín ‚à•xn‚à•‚â§
k

n=j
2‚àín
whenever k > j, we see from Exercise (4.1.8: 2) that ‚àû
n=1 2‚àínxn converges
to an element x in the unit ball of X. The boundedness of T now ensures
that
Tx =
‚àû

n=1
2‚àínTxn = y.
Hence B(0, r/2) ‚äÇT(B(0, 1)), and therefore T is open.
The converse is trivial.
2
Proof of the Open Mapping Theorem.
Let T be a bounded linear
mapping of a Banach space X onto a Banach space Y. Then
Y = T(X) =
‚àû

n=1
T(B (0, n)),
where each of the sets T

B (0, n)
	
is closed in Y . By Exercise (6.3.2: 1),
there exists a positive integer N such that T(B (0, N)) has a nonempty
interior; so there exist y1 ‚ààY and R > 0 such that
B(y1, R) ‚äÇT(B (0, N)).
Setting z = N ‚àí1y1 and r = N ‚àí1R, we easily see that
B(z, r) ‚äÇT(B (0, 1)).
So if y ‚ààY and ‚à•y‚à•< r, then
z ¬± y ‚ààT(B (0, 1))
and therefore
y = 1
2 ((z + y) ‚àí(z ‚àíy)) ‚ààT(B (0, 1)).
Hence
B(0, r) ‚äÇT(B (0, 1)),
and therefore, by Lemma (6.3.6), T is open.
2

6.3 Baire‚Äôs Theorem and Beyond
285
The Open Mapping Theorem is one of a number of closely interrelated
results.
(6.3.7) Banach‚Äôs Inverse Mapping Theorem.
A one‚Äìone bounded
linear mapping of a Banach space onto a Banach space has a bounded
linear inverse.
Proof.
Let T be a one‚Äìone bounded linear mapping of a Banach space X
onto a Banach space Y . It is routine to prove that T ‚àí1 is a linear mapping
from Y onto X. By the Open Mapping Theorem (6.3.5), if U is an open
subset of X, then
(T ‚àí1)‚àí1(U) = T(U)
is open in Y ; so T ‚àí1 is continuous, by Proposition (3.2.2), and is therefore
a bounded linear mapping, by Proposition (4.2.1).
2
By the graph of a mapping f : X ‚ÜíY we mean the subset
G(f) = {(x, f(x)) : x ‚ààX}
of X √ó Y . (The graph of f is really the same as the function f itself,
regarded as a set of ordered pairs.)
(6.3.8) The Closed Graph Theorem.
A linear mapping of a Banach
space X into a Banach space Y is bounded if and only if its graph is a
closed subset of X √ó Y.
Proof.
Let T be a linear mapping of X into Y . It is a simple exercise to
show that if T is bounded, then its graph is a closed subset of X √ó Y .
Suppose, conversely, that G(T) is closed in X √óY. Since X √óY , a product
of complete metric spaces, is complete (by Proposition (3.5.10)), we see
from Proposition (3.2.9) that G (T), which is clearly a subspace of X √ó Y,
is a Banach space. DeÔ¨Åne a mapping H of G(T) onto X by
H(x, Tx) = x
(x ‚ààX).
It is straightforward to show that H is one‚Äìone and linear. Also,
‚à•H(x, Tx)‚à•‚â§‚à•x‚à•+ ‚à•Tx‚à•
‚â§2 max {‚à•x‚à•, ‚à•Tx‚à•}
= 2 ‚à•(x, Tx)‚à•,
so H is bounded. It follows from Banach‚Äôs Inverse Mapping Theorem (6.3.7)
that H‚àí1 is a bounded linear mapping of X onto G(T); but
‚à•Tx‚à•‚â§‚à•(x, Tx)‚à•=
44H‚àí1x
44 ‚â§
44H‚àí144 ‚à•x‚à•

286
6. An Introduction to Functional Analysis
for all x ‚ààX, and so T is bounded.
2
We met the following result‚Äîthe Uniform Boundedness Theorem‚Äîin
Exercise (4.2.2: 14), where you were asked to Ô¨Åll in the details of a relatively
little known elementary proof. We now place the Uniform Boundedness
Theorem in its normal context, with its standard proof.
(6.3.9) Theorem.
Let (Ti)i‚ààI be a family of bounded linear mappings
from a Banach space X into a Banach space Y , such that {‚à•Tix‚à•: i ‚ààI}
is bounded for each x ‚ààX. Then {‚à•Ti‚à•: i ‚ààI} is bounded.
Proof.
Our hypotheses ensure that for each x ‚ààX,
ux(i) = Tix
(i ‚ààI)
deÔ¨Ånes an element ux of B(I, Y ). Clearly, the mapping x ‚Üíux of X into
B(I, Y ) is linear. We prove that its graph is closed in X √ó B(I, Y ). Indeed,
if (xn) is a sequence converging to a limit x‚àûin X, such that the sequence
(uxn) converges to a limit f in B(I, Y ), then for each i ‚ààI we have
‚à•f(i) ‚àíux‚àû(i)‚à•‚â§‚à•f(i) ‚àíuxn(i)‚à•+ ‚à•uxn(i) ‚àíux‚àû(i)‚à•
‚â§‚à•f ‚àíuxn‚à•+ ‚à•Ti(xn ‚àíx‚àû)‚à•
‚â§‚à•f ‚àíuxn‚à•+ ‚à•Ti‚à•‚à•xn ‚àíx‚àû‚à•
‚Üí0 as n ‚Üí‚àû.
Hence f = ux‚àû, and so the linear mapping x ‚Üíux has a closed graph. By
Proposition (4.5.1) and the Closed Graph Theorem (6.3.8), this mapping
is bounded. Let
c = sup {‚à•ux‚à•: x ‚ààX, ‚à•x‚à•‚â§1} .
Then for all i ‚ààI and all x in the unit ball of X,
‚à•Tix‚à•= ‚à•ux(i)‚à•‚â§‚à•ux‚à•‚â§c.
2
(6.3.10) Exercises
.1
Prove that if T is an open bounded linear mapping of a Banach space
X into a normed space Y , then the range of T is complete.
.2
Let X be a separable real Banach space with a Schauder basis (xn),
and let S be the linear space consisting of all sequences (Œªn)‚àû
n=1 of
real numbers such that the series ‚àû
n=1 Œªnxn converges in X. Show
that
‚à•(Œªn)‚àû
n=1‚à•= sup
N‚â•1
44444
N

n=1
Œªnxn
44444

6.3 Baire‚Äôs Theorem and Beyond
287
deÔ¨Ånes a norm on S. Prove that S is a Banach space with respect to
this norm. Then show that the mapping
(Œªn)‚àû
n=1 ‚Üí
‚àû

n=1
Œªnxn
is a bounded linear isomorphism of S onto X with a continuous
inverse. Deduce that for each positive integer N the coordinate
functional ‚àû
n=1 Œªnxn ‚ÜíŒªN belongs to the dual space X‚àó.
.3
Use an argument like that of Exercise (6.3.3: 4) to give another proof
of the Uniform Boundedness Theorem.
.4
Let X, Y be Banach spaces, and suppose that for all distinct y, y‚Ä≤ in
Y there exists a bounded linear functional f on Y such that f(y) Ã∏=
f(y‚Ä≤). Let T : X ‚ÜíY be a linear mapping such that if (xn) is a
sequence in X converging to 0, then (f ‚ó¶T) (xn) converges to 0 for
each bounded linear functional f on Y . Prove that T is bounded.
(Use the Closed Graph Theorem.)
.5
Let (Tn) be a sequence of bounded linear mappings of a Banach space
X into a Banach space Y, such that the sequence (Tnx) converges in
Y for each x ‚ààX. Prove that
Tx = lim
n‚Üí‚àûTnx
deÔ¨Ånes a bounded linear mapping T : X ‚ÜíY. (Use the Uniform
Boundedness Theorem.)
.6
Let S, T be mappings of a Hilbert space H into itself such that
‚ü®Sx, y‚ü©= ‚ü®x, Ty‚ü©for all x, y ‚ààH. Prove that S and T are linear
mappings. Then give two proofs that both S and T are bounded.
(For one proof use the Closed Graph Theorem.)
.7
Let A, B be disjoint subspaces of a Banach space X such that each
element x of X can be written uniquely in the form
x = PAx + PBx
with PAx ‚ààA and PBx ‚ààB. Prove that the oblique projection map-
pings PA : X ‚ÜíA and PB : X ‚ÜíB so deÔ¨Åned are linear, and that
they are bounded if and only if A and B are closed in X.
.8
Prove Landau‚Äôs Theorem: if (an) is a sequence of complex num-
bers such that ‚àû
n=1 anxn converges for each (xn) ‚ààl2(C), then
(an) ‚ààl2(C). (For each x = (xn) ‚ààl2(C) and each k, deÔ¨Åne
sk(x) = k
n=1 anxn. Apply the Uniform Boundedness Theorem to
the sequence (sk)‚àû
k=1 of linear functionals on l2(C), to show that the
partial sums of ‚àû
n=1 |an|2 are bounded.)

288
6. An Introduction to Functional Analysis
.9
Let w be a weight function on the compact interval I = [a, b]. For
each positive integer n let (xn,0, xn,1, . . . , xn,n) be a partition of I,
and deÔ¨Åne a linear functional Ln on C(I) by
Lnf =
n

k=0
cn,kf(xn,k),
where each cn,k ‚ààR. Prove Polya‚Äôs Theorem on approximate quadra-
ture: in order that limn‚Üí‚àûLnf =
% b
a f(x)w(x) dx for all f ‚ààC(I), it
is necessary and suÔ¨Écient that supn‚â•1
n
k=0 |cn,k| < ‚àû.
.10 Let T be an operator on a Hilbert space. Prove that ran(T) is closed
if and only if ran(T ‚àó) is closed. (Suppose that ran(T) is closed, note
Exercise (5.3.3: 6), and show that ran(T ‚àóT) is closed. To do so, let
T ‚àóTxn ‚ÜíŒæ, and use the Uniform Boundedness Theorem to show
that the linear functional Tx ‚Üí‚ü®x, Œæ‚ü©is bounded on the Hilbert
space ran(T).)
Perhaps the standard illustration of the Uniform Boundedness Theorem
in action is the proof that there exists a 2œÄ‚Äìperiodic continuous function
f : R ‚ÜíC whose Fourier series does not converge at 0.
Let S denote the subspace of C‚àû(R, C) consisting of all 2œÄ‚Äìperiodic
continuous mappings of R into C. Recall that the Fourier series, or Fourier
expansion, of f ‚ààS at x is deÔ¨Åned to be
s(f, x) =
‚àû

n=‚àí‚àû
-f(n)einx,
where the Fourier coeÔ¨Écients are given by
-f(n) = 1
2œÄ
$ œÄ
‚àíœÄ
f(t)e‚àíint dt
(n ‚ààZ).
For each positive integer N let
sN(f, x) =
N

n=‚àíN
-f(n)einx.
Then
sN(f, x) = 1
2œÄ
$ œÄ
‚àíœÄ
f(t)DN(x ‚àít) dt = 1
2œÄ
$ œÄ
‚àíœÄ
f(‚àít)DN(t) dt,
where the Dirichlet kernel DN is deÔ¨Åned by
DN(t) =
N

n=‚àíN
eint.

6.3 Baire‚Äôs Theorem and Beyond
289
DeÔ¨Åne a linear mapping uN : S‚ÜíR by
uN(f) = sN(f, 0).
Then
|uN(f)| ‚â§1
2œÄ ‚à•f‚à•
$ œÄ
‚àíœÄ
|DN(t)| dt,
where ‚à•f‚à•is the sup norm of f. Thus uN is bounded, and
‚à•uN‚à•‚â§1
2œÄ
$ œÄ
‚àíœÄ
|DN(t)| dt.
(2)
On the other hand, there exists a sequence (fn) of elements of S such that
‚Ä¢ ‚àí1 ‚â§fn ‚â§1 for each n, and
‚Ä¢ fn(t) ‚Üísgn (DN(t)) for each t ‚ààR;
see Exercise (6.3.11: 2). Using Lebesgue‚Äôs Dominated Convergence Theorem
(2.2.14), we now obtain
uN(fn) = 1
2œÄ
$ œÄ
‚àíœÄ
fn (‚àít) DN (t) dt ‚Üí1
2œÄ
$ œÄ
‚àíœÄ
sgn (DN(‚àít) ) DN (t) dt
as n ‚Üí‚àû. But
DN(t) = sin

N + 1
2
	
t
sin
 t
2
	
= DN(‚àít),
so
lim
n‚Üí‚àûuN(fn) = 1
2œÄ
$ œÄ
‚àíœÄ
|DN (t)| dt,
and therefore, in view of (2),
‚à•uN‚à•= 1
2œÄ
$ œÄ
‚àíœÄ
|DN(t)| dt.
Next, noting that |sin (t/2)| ‚â§t/2 for all t > 0, we have
‚à•uN‚à•= 1
2œÄ
$ œÄ
‚àíœÄ
|DN (t)| dt
= 1
œÄ
$ œÄ
0
     
sin

N + 1
2
	
t
sin
 t
2
	
     dt
‚â•2
œÄ
$ œÄ
0
1
t
  sin

N + 1
2
	
t
  dt
= 2
œÄ
$ (N+ 1
2)œÄ
0
1
t |sin t| dt

290
6. An Introduction to Functional Analysis
> 2
œÄ
N

n=1
1
nœÄ
$ nœÄ
(n‚àí1)œÄ
|sin t| dt
= 4
œÄ2
N

n=1
1
n
and therefore ‚à•uN‚à•‚Üí‚àûas N ‚Üí‚àû. By the Uniform Boundedness The-
orem (6.3.9), there exists f ‚ààS such that the set {|uN(f)| : N ‚â•1} is
unbounded. Hence the Fourier series of f cannot converge at 0.
(6.3.11) Exercises
.1
Prove that
N

n=‚àíN
eint = sin

N + 1
2
	
t
sin
 t
2
	
for each natural number N.
.2
Prove that, in the notation of the preceding paragraphs, there exists
a sequence (fn) of elements of S such that ‚àí1 ‚â§fn ‚â§1 for each n,
and such that fn(t) ‚Üísgn (DN(t)) for each t ‚ààR.
.3
In view of the Riemann‚ÄìLebesgue Lemma (Exercise (2.3.3: 13)),
Tf =

-f(n)
‚àû
n=1
deÔ¨Ånes a mapping T : L1[‚àíœÄ, œÄ] ‚Üíc0. Prove that T is one‚Äìone but
not onto c0. (Show that there exists Œ± > 0 such that ‚à•T(Dn)‚à•‚â•
Œ± ‚à•Dn‚à•1 for each n.)

Appendix A
What Is a Real Number?
In this appendix we sketch Bishop‚Äôs adaptation of Cauchy‚Äôs construction
of the set R, based on the idea that a real number is an object that can
be approximated arbitrarily closely by rational numbers.
Passing over the standard construction of the set Z of integers, we deÔ¨Åne
a rational number to be an ordered pair (m, n) of integers, usually written
m/n or m
n , such that n Ã∏= 0. Two rational numbers m/n and m‚Ä≤/n‚Ä≤ are said
to be equal, and we write m/n = m‚Ä≤/n‚Ä≤, if mn‚Ä≤ and m‚Ä≤n are equal integers;
this relation of equality is an equivalence relation.
We should really deÔ¨Åne a rational number to be an equivalence class of
ordered pairs of integers relative to the equivalence relation of equality that
we have just introduced. In that case two rational numbers (equivalence
classes) would be equal if and only if they were one and the same. However,
it more closely reÔ¨Çects common practice if we follow the approach in which
rational numbers are given by the integer pairs themselves, and equality of
rational numbers is a deÔ¨Åned notion (given by a certain condition on the
integer pairs) rather than the logical one of identity.1 We follow a similar
approach to the equality of real numbers in due course. In every case we
use without further mention the standard symbol = to denote equality.
1For example, from childhood we are led to consider the rational numbers
1
2, 2
4, and 3
6 as equal, not as representatives of some equivalence class. For another
example, we consider the numbers 1, 0 ¬∑ 999 ¬∑ ¬∑ ¬∑ , and 5
5 to be equal although they
are not logically identical (they are presented to us in diÔ¨Äerent ways).

292
Appendix A. What Is a Real Number?
We omit the details of the familiar algebraic operations and the order
relations >, ‚â•on the set Q of rational numbers. We identify the integer n
with the rational number n/1.
By a real number we mean a sequence x = (xn)‚àû
n=1 of rational numbers
that is regular in the sense that
|xm ‚àíxn| ‚â§1
m + 1
n
(m, n ‚ààN+).
The term xn is called the nth rational approximation to the real number
x. The set of real numbers is, of course, denoted by R.
We identify a rational number r with the real number (r, r, r, ...) ; with
that identiÔ¨Åcation, Q, N, and Z become subsets of R.
To specify completely the set R of real numbers, we must equip it with
an appropriate notion of equality. Two real numbers x = (xn) and y = (yn)
are said to be equal if
|xn ‚àíyn| ‚â§2
n
(n ‚ààN+).
Note that this notion of equality is an equivalence relation: it is clearly
reÔ¨Çexive and symmetric; its transitivity is a simple consequence of the
following result.
(A.1) Lemma.
Two real numbers x = (xn) and y = (yn) are equal if
and only if for each positive integer k there exists a positive integer Nk such
that |xn ‚àíyn| ‚â§1/k whenever n ‚â•Nk.
Proof.
If x = y, then for each k we need only take Nk = 2k. Conversely,
suppose that for each k there exists Nk with the stated property, and
consider any positive integers n and k. Setting m = k + Nk, we have
|xn ‚àíyn| ‚â§|xn ‚àíxm| + |xm ‚àíym| + |ym ‚àíyn|
‚â§
 1
n + 1
m
	
+ 1
k +
 1
n + 1
m
	
< 2
n + 3
k.
Since this holds for all positive integers k, we see that |xn ‚àíyn| ‚â§2/n. But
n is arbitrary, so x = y.
2
(A.2) Exercises
.1
Complete the proof that equality of real numbers is an equivalence
relation.
.2
Let k be any positive integer. Show that the operation which assigns
to each real number (xn)‚àû
n=1 its kth rational approximation xk does
not preserve equality.

Appendix A. What Is a Real Number?
293
.3
Prove that two real numbers x = (xn) and y = (yn) are equal if and
only if for each c > 0 and each positive integer k there exists Nk such
that |xn ‚àíyn| ‚â§c/k for all n ‚â•Nk.
To introduce the algebraic operations on R we need a special bound for
the terms of a regular sequence x = (xn) of rational numbers. We deÔ¨Åne
the canonical bound Kx of x to be the least positive integer greater than
|x1| + 2. It is easy to show that |xn| < Kx for all n.
The arithmetic operations on real numbers x = (xn) and y = (yn) are
deÔ¨Åned in terms of the rational approximations to those numbers as follows.
(x + y)n = x2n + y2n,
(x ‚àíy)n = x2n ‚àíy2n,
(xy)n = x2Œ∫ny2Œ∫n, where Œ∫ = max{Kx, Ky},
max{x, y}n = max{xn, yn},
min{x, y}n = min{xn, yn},
|x|n = |xn| .
Here, for example, (x + y)n denotes the nth rational approximation to the
real number x+y, and max{xn, yn} is the maximum, computed in the usual
way, of the rational numbers xn and yn. Of course, we must verify that the
foregoing deÔ¨Ånitions yield real numbers; we illustrate this veriÔ¨Åcation with
the case of the product xy. Writing zn = x2Œ∫ny2Œ∫n, so that xy = (zn), for
all positive integers m and n we have
|zm ‚àízn| = |x2Œ∫m(y2Œ∫m ‚àíy2Œ∫n) + y2Œ∫n(x2Œ∫m ‚àíx2Œ∫n)|
‚â§|x2Œ∫m| |y2Œ∫m ‚àíy2Œ∫n| + |y2Œ∫n| |x2Œ∫m ‚àíx2Œ∫n|
‚â§Œ∫

1
2Œ∫m +
1
2Œ∫n
	
+ Œ∫

1
2Œ∫m +
1
2Œ∫n
	
= 1
m + 1
n.
Thus xy is a regular sequence of rational numbers‚Äîthat is, a real number.
In the rest of this appendix, x = (xn), y = (yn), and z = (zn) are real
numbers.
(A.3) Exercises
.1
Prove that |xn| < Kx for each n.
.2
Prove that x + y, x ‚àíy, max{x, y}, min{x, y}, and |x| are real
numbers.
.3
Let x‚Ä≤ and y‚Ä≤ be real numbers such that x = x‚Ä≤ and y = y‚Ä≤. Prove
that x + y = x‚Ä≤ + y‚Ä≤ and xy = x‚Ä≤y‚Ä≤.
Thus the operations of addition and multiplication arise from func-
tions on the Cartesian product R √ó R when the relation of equality

294
Appendix A. What Is a Real Number?
on that set is deÔ¨Åned in the natural way: (x, y) = (x‚Ä≤, y‚Ä≤) if and only
if x = x‚Ä≤ and y = y‚Ä≤.
.4
Sums, diÔ¨Äerences, products, maxima, and minima of Ô¨Ånitely many
real numbers are deÔ¨Åned inductively: for example, we deÔ¨Åne
max{x1, . . . , xn+1} = max{max{x1, . . . , xn}, xn+1}.
Show that if œÉ is a permutation of {1, . . . , n}, then
max{xœÉ(1), . . . , xœÉ(n)} = max{x1, . . . , xn}.
.5
Prove each of the following identities.
(i) x + y = y + x
(ii) x + (y + z) = (x + y) + z
(iii) xy = yx
(iv) 0 + x = x + 0 = x
(v) 1x = x1 = x.
(These should serve to convince you that addition and multiplica-
tion, as deÔ¨Åned previously, have the properties that we expect from
elementary school.)
.6
Prove that for each m the mth rational approximation to 1/n ‚àí
|x ‚àíxn| is 1/n ‚àí|x4m ‚àíxn| .
The real number x = (xn) is said to be positive if there exists n such
that xn > 1/n. We deÔ¨Åne x > y to mean that x ‚àíy is positive; thus x > 0
if and only if x is positive. On the other hand, we say that x is
‚Ä¢ negative if ‚àíx is positive, and
‚Ä¢ nonnegative if xn ‚â•‚àí1/n for all n.
We write x ‚â•y to denote that x ‚àíy is nonnegative, and we deÔ¨Åne x < y
and x ‚â§y to have the usual meanings relative to the relations >, ‚â•.
(A.4) Exercise
Prove that if x > 0, then x ‚â•0.
(A.5) Proposition.
A real number x = (xn) is positive if and only if
there exists a positive integer N such that xm ‚â•1/N for all m ‚â•N. On
the other hand, x is nonnegative if and only if for each positive integer k
there exists a positive integer Nk such that xm ‚â•‚àí1/k for all m ‚â•Nk.

Appendix A. What Is a Real Number?
295
Proof.
If x is positive, then xn > 1/n for some n. Choosing the positive
integer N so that 2/N ‚â§xn ‚àí1/n, for each m ‚â•N we have
xm ‚â•xn ‚àí|xm ‚àíxn|
‚â•xn ‚àí1
m ‚àí1
n
‚â•xn ‚àí1
N ‚àí1
n
> 1
N .
So the required property holds. If, conversely, that property holds, then
xN+1 > 1/(N + 1), so x > 0.
The proof of the second part of the proposition is left as an exercise.
2
(A.6) Exercises
.1
Prove the second part of the preceding proposition.
.2
Prove that if x = x‚Ä≤, y = y‚Ä≤, and x > y (respectively, x ‚â•y), then
x‚Ä≤ > y‚Ä≤ (respectively, x‚Ä≤ ‚â•y‚Ä≤).
.3
Prove the Axiom of Archimedes: if x > 0 and y ‚â•0, then there exists
n ‚ààN+ such that nx > y.
.4
Prove that on Q the relations > and ‚â•, deÔ¨Åned as for real num-
bers, coincide with the standard elementary order relations between
rational numbers.
.5
Prove the triangle inequality for real numbers: |x + y| ‚â§|x| + |y| .
It is left as a relatively straightforward exercise to prove most of the
elementary properties of the partial orders >, ‚â•on R. However, we need
to tie up a few loose ends, the Ô¨Årst of which concerns the order density of
Q in R and requires a simple lemma.
(A.7) Lemma.
|x ‚àíxn| ‚â§1/n for each n.
Proof.
Fix the positive integer n. By Exercise (A.3: 6), for each m the
mth rational approximation to 1/n ‚àí|x ‚àíxn| is
1
n ‚àí|x4m ‚àíxn| ‚â•1
n ‚àí( 1
4m + 1
n) = ‚àí1
4m > ‚àí1
m.
Hence 1/n ‚àí|x ‚àíxn| ‚â•0, and therefore |x ‚àíxn| ‚â§1/n.
2
(A.8) Proposition.
Q is order dense in R ‚Äîthat is, for all x and y in
R with x < y, there exists r ‚ààQ such that x < r < y.
Proof.
Since
0 < y ‚àíx = (y2n ‚àíx2n)‚àû
n=1 ,

296
Appendix A. What Is a Real Number?
there exists N such that y2N ‚àíx2N > 1/N. Writing
r = 1
2 (x2N + y2N)
and using Lemma (A.7), we have
r ‚àíx ‚â•r ‚àíx2N ‚àí|x2N ‚àíx|
‚â•1
2 (y2N ‚àíx2N) ‚àí
1
2N > 0,
and similarly y ‚àír > 0. Hence x < r < y.
2
Here is a good application of Proposition (A.8).
(A.9) Proposition.
If x + y > 0, then either x > 0 or y > 0.
Proof.
Let x + y > 0. By Proposition (A.8), there exists a rational
number Œ± such that 0 < Œ± < x + y. Using Exercise (A.6: 3), choose a
positive integer n > 4/Œ±. Let r = xn and s = yn. Then r and s are
rational; also, by Lemma (A.7), |x ‚àír| < Œ±/4 and |y ‚àís| < Œ±/4. Using the
triangle inequality, we now see that
r + s ‚â•(x + y) ‚àí(|x ‚àír| + |y ‚àís|)
> Œ± ‚àí
 Œ±
4 + Œ±
4
	
= Œ±
2 .
Since r and s are rational numbers, either r > Œ±/4 or s > Œ±/4. In the Ô¨Årst
case, x ‚â•r ‚àí|x ‚àír| > 0 ; in the second, y > 0.
2
For each nonzero real number x the reciprocal, or inverse, of x is the real
number 1
x (also written 1/x or x‚àí1) deÔ¨Åned as follows. Choose a positive
integer N such that |xn| ‚â•1/N for all n ‚â•N, and set
 1
x

n
=
Ô£±
Ô£≤
Ô£≥
1/xN 3
if n < N
1/xnN 2
if n ‚â•N.
The last set of exercises in this appendix shows that this is a good deÔ¨Ånition
of 1/x.
(A.10) Exercises
.1
Let x be a nonzero real number, and 1/x the reciprocal of x as just
deÔ¨Åned. Prove that 1/x is a real number, and that it is the unique
real number t such that xt = 1.

Appendix A. What Is a Real Number?
297
.2
Let x be a nonzero real number, and let N be as in the deÔ¨Ånition of
1/x. Let M be a positive integer such that |xn| ‚â•1/M for all n ‚â•M,
and deÔ¨Åne a real number y = (yn) by
yn =
Ô£±
Ô£≤
Ô£≥
1/xM 3
if n < M
1/xnM 2
if n ‚â•M.
Give two proofs that y = 1/x.
.3
Prove that the operation that assigns 1/x to the nonzero real number
x is a function (respects equality) and maps the set of nonzero real
numbers onto itself.

Appendix B
Axioms of Choice and Zorn‚Äôs
Lemma
In the early years of this century it was recognised that the following princi-
ple, the Axiom of Choice, was necessary for the proofs of several important
theorems in mathematics.
AC
If F is a nonempty family of pairwise‚Äìdisjoint nonempty sets, then
there exists a set that intersects each member of F in exactly one
element.
In particular, Zermelo used this axiom explicitly in his proof that every set
S can be well‚Äìordered‚Äîthat is, there is a total partial order ‚â•on S with
respect to which every nonempty subset of X has a least element [57]. It
was shown by G¬®odel [18] in 1939 that the Axiom of Choice is consistent
with the axioms of Zermelo‚ÄìFraenkel set theory (ZF), in the sense that
the axiom can be added to ZF without leading to a contradiction, and
by Cohen [11] in 1963 that the negation of the Axiom of Choice is also
consistent with ZF. Thus the Axiom of Choice is independent of ZF: it can
be neither proved nor disproved without adding some extra principles to
ZF.
The Axiom of Choice is commonly used in an equivalent form (the one
we used in the proof of Lemma (1.3.5)):
AC‚Ä≤ If A and B are nonempty sets, S ‚äÇA √ó B, and for each x ‚ààA
there exists y ‚ààB such that (x, y) ‚ààS, then there exists a function
f : A ‚ÜíB ‚Äîcalled a choice function for S ‚Äîsuch that (x, f(x)) ‚ààS
for each x ‚ààA.

300
Appendix B. Axioms of Choice and Zorn‚Äôs Lemma
To prove the equivalence of these two forms of the Axiom of Choice, Ô¨Årst
assume that the original version AC of the axiom holds, and consider
nonempty sets A, B and a subset S of A √ó B such that for each x ‚ààA
there exists y ‚ààB with (x, y) ‚ààS. For each x ‚ààA let
Fx = {x} √ó {y ‚ààB : (x, y) ‚ààS} .
Then F = (Fx)x‚ààA is a nonempty family of pairwise‚Äìdisjoint sets, so, by
AC, there exists a set C that has exactly one element in common with each
Fx. We now deÔ¨Åne the required choice function f : A ‚ÜíB by setting
(x, f(x)) = the unique element of C ‚à©Fx
for each x ‚ààA.
Now assume that the alternative form AC‚Ä≤ of the Axiom of Choice holds,
and consider a nonempty family F of pairwise‚Äìdisjoint nonempty sets.
Taking
A = F,
B =

X‚ààF
X,
S = {(X, x) : X ‚ààF, x ‚ààX}
in AC‚Ä≤, we obtain a function
f : F ‚Üí

X‚ààF
X
such that f(X) ‚ààX for each X ‚ààF. The range of f is then a set that has
exactly one element in common with each member of F.
There are two other choice principles that are widely used in analysis.
The Ô¨Årst of these, the Principle of Countable Choice, is the case A = N of
AC‚Ä≤. The second is the Principle of Dependent Choice:
If a ‚ààA, S ‚äÇA √ó A, and for each x ‚ààA there exists y ‚ààA
such that (x, y) ‚ààS, then there exists a sequence (an)‚àû
n=1 in A
such that a1 = a and (an, an+1) ‚ààS for each n.
It is a good exercise to show that the Axiom of Choice entails the Principle
of Dependent Choice, and that the Principle of Dependent Choice entails
the Principle of Countable Choice. Since the last two principles can be
derived as consequences of the axioms of ZF, they are deÔ¨Ånitely weaker
than the Axiom of Choice.
There are many principles that are equivalent to the Axiom of Choice.
One of those, Zorn‚Äôs Lemma, is needed for our proof of the Hahn‚ÄìBanach
Theorem in Chapter 6.
A nonempty subset C of a partially ordered set (A, ‚âΩ) is called a chain
if for all x, y ‚ààC either x ‚âΩy or y ‚âΩx. Zorn‚Äôs Lemma states that

Appendix B. Axioms of Choice and Zorn‚Äôs Lemma
301
If every chain in a partially ordered set A has an upper bound
in A, then A has a maximal element.
For a fuller discussion of axioms of choice, Zorn‚Äôs Lemma, and related
matters, see the article by Jech on pages 345‚Äì370 of [2].

Appendix C
Pareto Optimality
In this appendix we show how some of the results and ideas in our main
chapters can be applied within theoretical economics.
We assume that there are a Ô¨Ånite number m of consumers and a Ô¨Ånite
number n of producers. Consumer i has a consumption set Xi ‚äÇRN, where
a consumption bundle xi = (xi1, . . . , xiN ) ‚ààXi is interpreted as follows:
xik is the quantity of the kth commodity (a good or a service) taken by
consumer i when he chooses the consumption bundle xi. Producer j has
a production set Yj ‚äÇRN, where the kth entry in the production vector
yj = (yj1, . . . , yjN ) ‚ààYj is interpreted as the amount of the kth commodity
produced by producer j under her adopted production schedule. Other
important sets in this context are the aggregate consumption set
X = X1 + ¬∑ ¬∑ ¬∑ + Xm
and the aggregate production set
Y = Y1 + ¬∑ ¬∑ ¬∑ + Yn.
A price vector is simply an element p of RN; the kth component pk of
p is the price of one unit of the kth commodity. Thus the total cost to
consumer i of the consumption bundle xi is ‚ü®p, xi‚ü©, where ‚ü®¬∑, ¬∑‚ü©denotes the
usual inner product on RN; and the proÔ¨Åt to producer j of the production
vector yj is ‚ü®p, yj‚ü©.
We assume that the preferences of consumer i are represented by a re-
Ô¨Çexive, transitive total partial order ‚âΩi on Xi, called the preference relation
of consumer i. The corresponding relations ‚âªi of strict preference, and ‚àºi

304
Appendix C. Pareto Optimality
of preference‚ÄìindiÔ¨Äerence, are deÔ¨Åned on Xi as follows.
x ‚âªi y
if and only if
x ‚âΩi y and not (y ‚âΩi x) ;
x ‚àºi y
if and only if
x ‚âΩi y and y ‚âΩi x.
Routine arguments show that ‚âªi and ‚àºi are transitive; that x ‚âªi x is
contradictory; that if either x ‚âªi y or x ‚àºi y, then x ‚âΩi y; and that if
either x ‚âªi y ‚âΩi z or x ‚âΩi y ‚âªi z, then x ‚âªi z. The informal meaning of
x ‚âΩi y is that consumer i Ô¨Ånds x at least as attractive as y; x ‚âªi y means
that he strictly prefers x to y; and x ‚àºi y signiÔ¨Åes that he does not mind
which of x or y he obtains.
It is convenient to introduce consumer i‚Äôs upper contour set at x,
[x, ‚Üí) = {Œæ ‚ààXi : Œæ ‚âΩi x} ,
and his strict upper contour set at x,
(x, ‚Üí) = {Œæ ‚ààXi : Œæ ‚âªi x} .
The preference relation ‚âªi is said to be locally nonsatiated at xi ‚ààXi if for
each Œµ > 0, B(xi, Œµ) ‚à©(xi, ‚Üí) is nonempty‚Äîthat is, there exists x‚Ä≤
i ‚ààXi
such that ‚à•xi ‚àíx‚Ä≤
i‚à•< Œµ and x‚Ä≤
i ‚âªi xi.
By a chosen point for consumer i under the price vector p we mean a
point Œæi ‚ààXi such that for all xi ‚ààXi,
‚ü®p, Œæi‚ü©‚â•‚ü®p, xi‚ü©‚áíŒæi ‚âΩi xi
or, equivalently,
xi ‚âªi Œæi ‚áí‚ü®p, xi‚ü©> ‚ü®p, Œæi‚ü©.
(C.1) Lemma.
If Œæi ‚ààXi is a chosen point for consumer i under the
price vector p, and xi ‚àºŒæi is a point of Xi at which ‚âªi is locally nonsatiated,
then ‚ü®p, xi‚ü©‚â•‚ü®p, Œæi‚ü©.
Proof.
Suppose that ‚ü®p, xi‚ü©< ‚ü®p, Œæi‚ü©. By the continuity of the mapping
x ‚Üí‚ü®p, x‚ü©on RN, there exists r > 0 such that if x‚Ä≤
i ‚ààXi and ‚à•x‚Ä≤
i‚àíxi‚à•< r,
then ‚ü®p, x‚Ä≤
i‚ü©< ‚ü®p, Œæi‚ü©. As ‚âΩi is locally nonsatiated at xi, there exists x‚Ä≤
i ‚ààXi
such that x‚Ä≤
i ‚âªi xi and ‚à•x‚Ä≤
i ‚àíxi‚à•< r. Then ‚ü®p, Œæi‚ü©> ‚ü®p, x‚Ä≤
i‚ü©; so Œæi ‚âΩi x‚Ä≤
i, as
Œæi is a chosen point. But we also have x‚Ä≤
i ‚âªi xi ‚àºi Œæi and therefore x‚Ä≤
i ‚âªi Œæi,
a contradiction.
2
We now assume that consumer i has an initial endowment of com-
modities, represented by the vector ¬Øxi = (¬Øxi1, . . . , ¬ØxiN ). The total initial
endowment of all consumers is then
¬Øx = ¬Øx1 + ¬∑ ¬∑ ¬∑ + ¬Øxm ‚ààX.

Appendix C. Pareto Optimality
305
We say that an element (y1, . . . , yn) of Y1 √ó ¬∑ ¬∑ ¬∑ √ó Yn is an admissible array
of production vectors; and that an element (x1, . . . , xm) of X1 √ó¬∑ ¬∑ ¬∑√óXm is
a feasible array of consumption bundles if there exists an admissible array
(y1, . . . , yn) of production vectors such that
m

i=1
xi =
n

j=1
yj + ¬Øx.
Intuitively, a feasible array is one that can be obtained by a distribution of
the total initial endowment and the total of the production vectors under
some production schedule.
An array (Œæ1, . . . , Œæm) ‚ààX1 √ó¬∑ ¬∑ ¬∑√óXm of consumption bundles is said to
be Pareto optimal, or a Pareto optimum, if it is feasible and if the following
condition holds.
PO
If (x1, . . . , xm) is a feasible array such that xi ‚âªi Œæi for some i, then
there exists k such that Œæk ‚âªk xk.
Equivalently, the array is Pareto optimal if there is no feasible array (x1, . . . ,
xm) such that xi ‚âΩi Œæi for all i, and such that xi ‚âªi Œæi for at least one i.
By a competitive equilibrium we mean a triple consisting of a price vector
p, an array (Œæ1, . . . , Œæm) of consumption bundles, and an admissible array
(Œ∑1, . . . , Œ∑n) of production vectors, satisfying the following conditions.
CE1 For 1 ‚â§i ‚â§m, Œæi is a chosen point for consumer i under the price
vector p.
CE2 For 1 ‚â§j ‚â§n, if yj ‚ààYj, then ‚ü®p, Œ∑j‚ü©‚â•‚ü®p, yj‚ü©.
CE3 m
i=1 Œæi = n
j=1 Œ∑j + ¬Øx.
Condition CE1 expresses consumer satisfaction; CE2, proÔ¨Åt maximisation;
and CE3, feasibility.
(C.2) Proposition.
Assume that each ‚âΩi is locally nonsatiated, and let
(p, (Œæ1, . . . , Œæm), (Œ∑1, . . . , Œ∑n))
be a competitive equilibrium. Then (Œæ1, . . . , Œæm) is a Pareto optimum.
Proof.
Condition CE3 ensures that (Œæ1, . . . ,Œæm) is a feasible array of
consumption bundles. Suppose that (Œæ1, . . . , Œæm) is not a Pareto optimum.
Then there exist an array (x1, . . . , xm) of consumption bundles and an
admissible array (y1, . . . , yn) of production vectors such that
m

i=1
xi =
n

j=1
yj + ¬Øx,
(1)

306
Appendix C. Pareto Optimality
xi ‚âΩi Œæi for all i, and xk ‚âªk Œæk for some k. By CE1, if xi ‚âªi Œæi, then
‚ü®p, xi‚ü©> ‚ü®p, Œæi‚ü©; in particular, ‚ü®p, xk‚ü©> ‚ü®p, Œæk‚ü©. If Œæi ‚âΩi xi, then xi ‚àºi Œæi
and so, by Lemma (C.1), ‚ü®p, xi‚ü©‚â•‚ü®p, Œæi‚ü©. Thus
m

i=1
‚ü®p, xi‚ü©>
m

i=1
‚ü®p, Œæi‚ü©
=
n

j=1
‚ü®p, Œ∑j‚ü©+ ‚ü®p, ¬Øx‚ü©
(by CE3)
‚â•
n

j=1
‚ü®p, yj‚ü©+ ‚ü®p, ¬Øx‚ü©
(by CE2).
Hence
7
p,
Ô£´
Ô£≠
m

i=1
xi ‚àí
n

j=1
yj ‚àí¬Øx
Ô£∂
Ô£∏
8
> 0,
and therefore, by the Cauchy‚ÄìSchwarz inequality in RN,
m

i=1
xi Ã∏=
n

j=1
yj + ¬Øx.
This contradicts (1).
2
Our next aim is to establish a partial converse of Proposition (C.2), pro-
viding conditions under which a Pareto optimum gives rise to a competitive
equilibrium. We Ô¨Årst introduce some more deÔ¨Ånitions.
The preference relation ‚âΩi on Xi is said to be convex if
‚Ä¢ Xi is convex,
‚Ä¢ x ‚âªi x‚Ä≤ ‚áítx + (1 ‚àít)x‚Ä≤ ‚âªi x‚Ä≤ whenever 0 < t < 1, and
‚Ä¢ x ‚àºi x‚Ä≤ ‚áítx + (1 ‚àít)x‚Ä≤ ‚âΩi x‚Ä≤ whenever 0 < t < 1.
In that case the sets [x, ‚Üí) and (x, ‚Üí) are convex.
We say that consumer i is nonsatiated at Œæi ‚ààXi if there exists x ‚ààXi
such that x ‚âªi Œæi ; otherwise, we say that he is satiated at Œæi.
(C.3) Proposition.
Let (Œæ1, . . . , Œæm) be a Pareto optimum such that for
at least one value of i, consumer i is nonsatiated at Œæi, and let (Œ∑1, . . . , Œ∑n)
be an admissible array of production vectors. Suppose that ‚âΩi is convex for
each i, and that the aggregate production set Y is convex. Then there exists
a nonzero price vector p such that
(i) for each i, if xi ‚ààXi and xi ‚âΩi Œæi, then ‚ü®p, xi‚ü©‚â•‚ü®p, Œæi‚ü©;

Appendix C. Pareto Optimality
307
(ii) for each j, if yj ‚ààYj, then ‚ü®p, Œ∑j‚ü©‚â•‚ü®p, yj‚ü©.
Proof.
We may assume that consumer 1 is nonsatiated at Œæ1. Choose an
admissible array (Œ∑1, . . . , Œ∑n) of production vectors such that
Œæ =
m

i=1
Œæi =
n

j=1
Œ∑j + ¬Øx.
Let A be the algebraic sum of the sets (Œæ1, ‚Üí) and m
i=2[Œæi, ‚Üí),
A =
! N

i=1
xi ‚ààRN : x1 ‚âª1 Œæ1 and ‚àÄi ‚â•2 (xi ‚âΩi Œæi)
"
,
and let
B =

x ‚ààRN : ‚àÉy ‚ààY (x = y + ¬Øx)

.
Clearly, B is convex; by our convexity hypotheses, A is convex. If A ‚à©B
is nonempty, then there exist x1 ‚âª1 Œæ1, xi ‚âΩi Œæi (2 ‚â§i ‚â§m), and yj ‚àà
Yj (1 ‚â§j ‚â§n), such that
m

i=1
xi =
n

j=1
yj + ¬Øx.
This contradicts the hypothesis that (Œæ1, . . . , Œæm) is a Pareto optimum.
Hence A and B are disjoint subsets of RN. Since these sets are clearly
nonempty, it follows from Minkowski‚Äôs Separation Theorem (6.2.6) and the
Riesz Representation Theorem (5.3.1) that there exist a nonzero vector
p ‚ààRN and a real number Œ± such that ‚ü®p, x‚ü©‚â•Œ± for all x ‚ààA, and
‚ü®p, x‚ü©‚â§Œ± for all x ‚ààB. Since Œæ ‚ààB, we have ‚ü®p, Œæ‚ü©‚â§Œ±. We now show
that ‚ü®p, Œæ‚ü©= Œ±.
To this end, consider m
i=1 xi,with x1 ‚âª1 Œæ1 and xi ‚âΩi Œæi (2 ‚â§i ‚â§m).
For 0 < t < 1 deÔ¨Åne
zi(t) = txi + (1 ‚àít)Œæi
(1 ‚â§i ‚â§m)
and
z(t) =
m

i=1
zi(t).
Since ‚âΩi is convex for each i,
z1(t) ‚àà(Œæ1, ‚Üí) ,
zi(t) ‚àà[Œæi, ‚Üí)
(2 ‚â§i ‚â§m) ;
whence z(t) ‚ààA and therefore ‚ü®p, z(t)‚ü©‚â•Œ±. Letting t ‚Üí0 and using the
continuity of the mapping x ‚Üí‚ü®p, x‚ü©on RN, we see that ‚ü®p, Œæ‚ü©‚â•Œ± and
therefore that ‚ü®p, Œæ‚ü©= Œ±, as we wanted to show.

308
Appendix C. Pareto Optimality
It now follows that ‚ü®p, x‚ü©‚â•‚ü®p, Œæ‚ü©for all x ‚ààA, and that ‚ü®p, x‚ü©‚â§‚ü®p, Œæ‚ü©
for all x ‚ààB. Thus if (y1, . . . , yn) is an admissible array of production
vectors, then
7
p,
n

j=1
yj + ¬Øx
8
‚â§‚ü®p, Œæ‚ü©=
7
p,
n

j=1
Œ∑j + ¬Øx
8
and therefore
n

j=1
‚ü®p, yj‚ü©‚â§
n

j=1
‚ü®p, Œ∑j‚ü©.
Given j ‚àà{1, . . . , n}, and taking yj ‚ààYj and yk = Œ∑k for all k Ã∏= j (1 ‚â§
k ‚â§n), we now obtain ‚ü®p, Œ∑j‚ü©‚â•‚ü®p, yj‚ü©. This completes the proof of (ii).
A similar argument, using the fact that ‚ü®p, x‚ü©‚â•‚ü®p, Œæ‚ü©for all x ‚ààA,
shows that
‚ü®p, x1‚ü©‚â•‚ü®p, Œæ1‚ü©for all x1 ‚àà(Œæ1, ‚Üí)
(2)
and that ‚ü®p, xi‚ü©‚â•‚ü®p, Œæi‚ü©for all xi ‚àà[Œæi, ‚Üí) (2 ‚â§i ‚â§m). To complete the
proof of (i), we show that if x1 ‚àº1 Œæ1, then ‚ü®p, x1‚ü©‚â•‚ü®p, Œæ1‚ü©. To this end, we
recall that consumer 1 is nonsatiated at Œæ1, so there exists x‚Ä≤
1 ‚ààX1 with
x‚Ä≤
1 ‚âª1 Œæ1 ‚àº1 x1.
It follows from this and the convexity of ‚âΩ1 that for each t ‚àà(0, 1),
x‚Ä≤
1(t) = tx‚Ä≤
1 + (1 ‚àít)x1 ‚âª1 Œæ1;
whence ‚ü®p, x‚Ä≤
1(t)‚ü©‚â•‚ü®p, Œæ1‚ü©, by (2). The continuity of the function x ‚Üí‚ü®p, x‚ü©
on RN now ensures that ‚ü®p, x1‚ü©‚â•‚ü®p, Œæ1‚ü©, as we required. This completes
the proof of (i).
2
(C.4) Corollary.
Under the hypotheses of Proposition (C.3), suppose
also that the following conditions hold.
(i) For each price vector p and each i (1 ‚â§i ‚â§m), there exists Œæ‚Ä≤
i ‚ààXi
such that ‚ü®p, Œæ‚Ä≤
i‚ü©< ‚ü®p, Œæi‚ü©(cheaper point condition).
(ii) For each i (1 ‚â§i ‚â§m), (Œæi, ‚Üí) is open in Xi.
Then (p, (Œæ1, . . . , Œæm), (Œ∑1, . . . , Œ∑n)) is a competitive equilibrium.
Proof.
In view of Proposition (C.3), we need only prove that CE1 holds.
To this end, let xi ‚âªi Œæi, and choose Œæ‚Ä≤
i ‚ààXi as in hypothesis (i). Then, by
Proposition (C.3), Œæi ‚âªi Œæ‚Ä≤
i. For each t ‚àà(0, 1) deÔ¨Åne
xi(t) = tŒæ‚Ä≤
i + (1 ‚àít)xi.

Appendix C. Pareto Optimality
309
As (Œæi, ‚Üí) is open in Xi, we can choose t ‚àà(0, 1) so small that xi(t) ‚âªi Œæi.
Then, by Proposition (C.3),
t ‚ü®p, Œæ‚Ä≤
i‚ü©+ (1 ‚àít) ‚ü®p, xi‚ü©= ‚ü®p, xi(t)‚ü©
‚â•‚ü®p, Œæi‚ü©
= t ‚ü®p, Œæi‚ü©+ (1 ‚àít) ‚ü®p, Œæi‚ü©
> t ‚ü®p, Œæ‚Ä≤
i‚ü©+ (1 ‚àít) ‚ü®p, Œæi‚ü©.
Hence
(1 ‚àít) ‚ü®p, xi‚ü©> (1 ‚àít) ‚ü®p, Œæi‚ü©
and therefore ‚ü®p, xi‚ü©> ‚ü®p, Œæi‚ü©. Thus Œæi is a chosen point.
2
The cheaper point assumption cannot be omitted from the hypotheses
of Corollary (C.4); see pages 198‚Äì201 of [51].

References
The following list contains both works that were consulted during the
writing of this book and suggestions for further reading.
University libraries usually have lots of older books, such as [36], dealing
with classical real analysis at the level of Chapter 1; a good modern refer-
ence for this material is [16]. Excellent references for the abstract theory
of measure and integration, following on from the material in Chapter 2,
are [21], [44], and [43]. (Note, incidentally, the advocacy of a Riemann‚Äìlike
integral by some authors [1].) Dieudonn¬¥e‚Äôs book [13], the Ô¨Årst of a series
in which he covers a large part of modern analysis, is outstanding and was
a source of much inspiration in my writing of Chapters 3 through 5. An
excellent text for a general course on functional analysis is [45]. This could
be followed by, or taken in conjunction with, material from the two volumes
by Kadison and Ringrose [24] on operator algebra theory, currently one of
the most active and important branches of analysis. Two other excellent
books, each of which overlaps our book in some areas but goes beyond it in
others, are [34], which includes such topics as spectral theory and abstract
integration, and [14], which extends measure theory into a rigorous devel-
opment of probability. More specialised books expanding material covered
in Chapter 6 are the one by Oxtoby [33] on the interplay between Baire
category and measure, and Diestel‚Äôs absorbing text [12] on sequences and
series in Banach spaces.
A wonderful book, written in a more discursive style than most others
at this level, is the classic by Riesz and Nag¬¥y [40]; although more old‚Äì
fashioned in its approach (it was Ô¨Årst published in 1955), it is a source of
much valuable material on Lebesgue integration and the theory of operators

312
References
on Hilbert space. A relatively unusual approach to analysis, in which all
concepts and proofs must be fully constructive, is followed in [5]; see also
Chapter 4 of [8].
For general applications of functional analysis see Zeidler‚Äôs two volumes
[56]. Applications of analysis in mathematical economics can be found in
[9], [30], and [51].
[1] R. G. Bartle: Return to the Riemann integral, Amer. Math. Monthly 103
(1996), 625‚Äì632.
[2] J. Barwise: Handbook of Mathematical Logic, North‚ÄìHolland, Amsterdam,
1977.
[3] G. H. Behforooz: Thinning out the harmonic series, Math. Mag. 68(4), 289‚Äì
293, 1985.
[4] A. Bielicki: Une remarque sur la m¬¥ethode de Banach‚ÄìCacciopoli‚ÄìTikhonov,
Bull. Acad. Polon. Sci. IV (1956), 261‚Äì268.
[5] E.A. Bishop and D.S. Bridges: Constructive Analysis, Grundlehren der
math. Wissenschaften 279, Springer‚ÄìVerlag, Berlin‚ÄìHeidelberg‚ÄìNew York,
1985.
[6] P. Borwein and T. Erd¬¥elyi: The full M¬®untz theorem in C[0, 1] and L1[0, 1],
J. London Math. Soc. (2), 54 (1996), 102‚Äì110.
[7] N. Bourbaki: El¬¥ements de Math¬¥ematique, Livre III: Topologie G¬¥en¬¥erale,
Hermann, Paris, 1958.
[8] D.S. Bridges: Computability: A Mathematical Sketchbook, Graduate Texts
in Mathematics 146, Springer‚ÄìVerlag, Berlin‚ÄìHeidelberg‚ÄìNew York, 1994.
[9] D.S. and G.B. Mehta: Representations of Preference Orderings, Lecture
Notes in Economics and Mathematical Systems 422, Springer‚ÄìVerlag,
Berlin‚ÄìHeidelberg‚ÄìNew York, 1995.
[10] E.W. Cheney: Introduction to Approximation Theory, McGraw‚ÄìHill, New
York, 1966.
[11] P.J. Cohen: Set Theory and the Continuum Hypothesis, W.A. Benjamin,
Inc., New York, 1966.
[12] J. Diestel: Sequences and Series in Banach Spaces, Graduate Texts in
Mathematics 92, Springer‚ÄìVerlag, Berlin‚ÄìHeidelberg‚ÄìNew York, 1984.
[13] J. Dieudonn¬¥e: Foundations of Modern Analysis, Academic Press, New York,
1960.
[14] R.M. Dudley, Real Analysis and Probability, Chapman & Hall, New York,
1989.
[15] P. EnÔ¨Ço: A counterexample to the approximation property in Banach spaces,
Acta Math. 130 (1973), 309‚Äì317.

References
313
[16] E. Gaughan: Introduction to Analysis (4th Edn), Brooks/Cole, PaciÔ¨Åc
Grove, CA, 1993.
[17] R.P. Gillespie: Integration, Oliver & Boyd, Edinburgh, 1959.
[18] K. G¬®odel: The Consistency of the Axiom of Choice and the Generalized Con-
tinuum Hypothesis with the Axioms of Set Theory, Annals of Mathematics
Studies, Vol. 3, Princeton University Press, Princeton, NJ, 1940.
[19] R. Gray: Georg Cantor and transcendental numbers, Amer. Math. Monthly
101 (1994), 819‚Äì832.
[20] P.R. Halmos: Naive Set Theory, van Nostrand, Princeton, NJ, 1960;
reprinted as Undergraduate Texts in Mathematics, Springer‚ÄìVerlag, Berlin‚Äì
Heidelberg‚ÄìNew York, 1974.
[21] P.R. Halmos: Measure Theory, van Nostrand, Princeton, NJ, 1950; reprinted
as Graduate Texts in Mathematics 18, Springer‚ÄìVerlag, Berlin‚ÄìHeidelberg‚Äì
New York, 1975.
[22] J. Hennefeld: A nontopological proof of the uniform boundedness theorem,
Amer. Math. Monthly 87 (1980), 217.
[23] F. John: Partial DiÔ¨Äerential Equations (4th Edn), Applied Mathematical
Sciences 1, Springer‚ÄìVerlag, Berlin‚ÄìHeidelberg‚ÄìNew York, 1982.
[24] R.V. Kadison and J.R. Ringrose: Fundamentals of the Theory of Operator
Algebras, Academic Press, New York, 1983 (Vol. 1) and 1986 (Vol. 2).
[25] J.L. Kelley: General Topology, van Nostrand, Princeton, NJ, 1955; reprinted
as Graduate Texts in Mathematics 27, Springer‚ÄìVerlag, Berlin‚ÄìHeidelberg‚Äì
New York, 1975.
[26] D. Kincaid and E.W. Cheney: Numerical Analysis (2nd Edn), Brooks/Cole
Publishing Co., PaciÔ¨Åc Grove, CA, 1996.
[27] M. Kline: Mathematical Thought from Ancient to Modern Times, Oxford
University Press, Oxford, 1972.
[28] T.W. K¬®orner: Fourier Analysis, Cambridge University Press, Cambridge,
1988.
[29] J. Marsden and A. Tromba: Vector Calculus (3rd Edn), W.H. Freeman &
Co., New York, 1988.
[30] A. Mas‚ÄìColell, M.D. Whinston, J.R. Green: Microeconomic Theory, Oxford
University Press, Oxford, 1995.
[31] Y. Matsuoka: An elementary proof of the formula ‚àû
k=1 1/k2 = œÄ2/6, Amer.
Math. Monthly 68 (1961), 485‚Äì487.
[32] N.S. Mendelsohn: An application of a famous inequality, Amer. Math.
Monthly 58 (1951), 563.
[33] J.C. Oxtoby: Measure and Category, Graduate Texts in Mathematics 2,
Springer‚ÄìVerlag, Berlin‚ÄìHeidelberg‚ÄìNew York, 1971.

314
References
[34] G.K. Pedersen: Analysis Now, Graduate Texts in Mathematics 118, Springer‚Äì
Verlag, Berlin‚ÄìHeidelberg‚ÄìNew York, 1991.
[35] W.E. PfaÔ¨Äenberger: A converse to a completeness theorem, Amer. Math.
Monthly 87 (1980), 216.
[36] E.G. Phillips: A Course of Analysis (2nd Edn), Cambridge Univ. Press,
Cambridge, 1939.
[37] J. Rauch: Partial DiÔ¨Äerential
Equations, Graduate Texts in Mathematics
128, Springer‚ÄìVerlag, Berlin‚ÄìHeidelberg‚ÄìNew York, 1991.
[38] J.R. Rice: The Approximation of Functions
(Vol. 1), Addison‚ÄìWesley,
Reading, MA, 1964.
[39] F. Riesz: Sur l‚Äôint¬¥egrale de Lebesgue comme l‚Äôop¬¥eration inverse de la
d¬¥erivation, Ann. Scuola Norm. Sup. Pisa (2) 5, 191‚Äì212 (1936).
[40] F. Riesz and B. Sz‚ÄìNagy: Functional Analysis, Frederic Ungar Publishing
Co., New York, 1955. Republished by Dover Publications Inc., New York,
1990.
[41] J. Ritt: Integration in Finite Terms, Columbia University Press, New York,
1948.
[42] W.W. Rogosinski: Volume and Integral, Oliver & Boyd, Edinburgh, 1962.
[43] H. Royden: Real Analysis (3rd Edn), Macmillan, New York, 1988.
[44] W. Rudin: Real and Complex Analysis, McGraw‚ÄìHill, New York, 1970.
[45] W. Rudin: Functional Analysis (2nd Edn), McGraw‚ÄìHill, New York, 1991.
[46] S. Saks: Theory of the Integral (2nd Edn), Dover Publishing, Inc., New York,
1964.
[47] H. Schubert: Topology (S. Moran, transl.), Macdonald Technical & ScientiÔ¨Åc,
London, 1968.
[48] R.M. Solovay: A model of set theory in which every set of reals is Lebesgue
measurable, Ann. Math. (Ser. 2) 92, 1‚Äì56 (1970).
[49] M. Spivak: Calculus, W.A. Benjamin, London, 1967.
[50] B. Sz‚ÄìNagy: Introduction to Real Functions and Orthogonal Expansions,
Oxford University Press, New York, 1965.
[51] A. Takayama: Mathematical Economics, The Dryden Press, Hinsdale IL.,
1974.
[52] J.A. Todd: Introduction to the Constructive Theory of Functions, Birkh¬®auser
Verlag, Basel, 1963.
[53] C. de la Vall¬¥ee Poussin: Int¬¥egrales de Lebesgue, fonctions d‚Äôensemble, classes
de Baire, Gauthier‚ÄìVillars, Paris, 1916.

References
315
[54] B.L. van der Waerden: Ein einfaches Beispiel einer nichtdiÔ¨Äerenzierbaren
stetigen Funktion, Math. Zeitschr. 32, 474‚Äì475, 1930.
[55] Y.M. Wong: The Lebesgue covering property and uniform continuity, Bull.
London Math. Soc. 4, 184‚Äì186, 1972.
[56] E. Zeidler: Applied Functional Analysis (2 Vols), Applied Mathematical
Sciences 108‚Äì109, Springer‚ÄìVerlag, Berlin‚ÄìHeidelberg‚ÄìNew York,1995.
[57] E. Zermelo: Beweis, dass jede Menge wohlgeordnet werden kann, Math.
Annalen 59 (1904) 514‚Äì516.

Index
Absolute convergence, 31
absolute value, 15
absolutely continuous, 84
absolutely convergent, 180
absorbing, 282
adjoint, 254
admissible array, 305
aggregate consumption set, 303
aggregate production set, 303
almost everywhere, 85
Œ±‚Äìperiodic, 215
alternating series test, 28
antiderivative, 69
antisymmetric, 6
approximate solution, 230
approximation theory, 192
Ascoli‚Äôs Theorem, 210
associated metric, 174
asymmetric, 6
attains bounds, 149
Axiom of Archimedes, 14, 295
Axiom of Choice, 299
Baire‚Äôs Theorem, 279
Banach space, 178
Beppo Levi‚Äôs Theorem, 101
Bernstein polynomial, 214
Bessel‚Äôs inequality, 245
best approximation, 192
binary expansion, 29
binomial series, 61
Bolzano‚ÄìWeierstrass property, 48
Bolzano‚ÄìWeierstrass Theorem, 48
Borel set, 113
bound, 184
boundary, 39
bounded above, 7
bounded below, 7
bounded function, 8
bounded linear map, 183
bounded operator, 254
bounded sequence, 21, 141
bounded set, 134
bounded variation, 71
BV(I), 205
B(X, Y ), 204
C-measurable, 116
canonical bound, 293
canonical map, 181
Cantor set, 39
Cantor‚Äôs Theorem, 26
Cauchy sequence, 25, 140
Cauchy-Euler method, 230

318
Index
Cauchy-Schwarz inequality, 235
Cauchy‚ÄìSchwarz, 126
centre, 130
Ces`aro mean, 215
chain, 300
chain connected, 160
Chain Rule, 55
change of variable, 107
characteristic function, 99
chosen point, 304
C‚àû(X, Y ), 206
Clarkson‚Äôs inequalities, 198
closed ball, 130
Closed Graph Theorem, 285
closed set, 38, 130, 135
closest point, 192, 239
closure, 38, 130
cluster point, 38, 130, 135
compact, 146
comparison test, 27
competitive equilibrium, 305
complete, 26, 140
completion, 142, 179
complex numbers, 19
conjugate, 19
conjugate bilinear, 255
conjugate exponents, 194
conjugate linear, 234
connected, 158
connected component, 160
consumer, 303
consumption bundle, 303
consumption set, 303
continuous, 44, 136
continuous on an interval, 45
continuous on the left, 44
continuous on the right, 44
continuously diÔ¨Äerentiable, 223
contraction mapping, 220
Contraction Mapping Theorem, 220
contractive, 136
converge simply, 206
converge uniformly, 206
convergent mapping, 138
convergent sequence, 20, 139
convergent series, 27, 180
convex, 163, 178
convex hull, 277
coordinate, 242
coordinate functional, 287
countable, 4
countable choice, 300
countably inÔ¨Ånite, 4
cover, 47, 146
C(X, Y ), 206
Decreasing, 8, 101
dense, 132
dependent choice, 300
derivative, 53
derivative, higher, 54
derivative, left, 53
derivative, right, 53
diameter, 133
diÔ¨Äerentiable, 53
diÔ¨Äerentiable on an interval, 53
diÔ¨Äerentiable, inÔ¨Ånitely, 54
diÔ¨Äerentiable n‚Äìtimes, 54
Dini derivates, 88
Dini‚Äôs Theorem, 207
Dirichlet kernel, 288
Dirichlet Problem, 257
discontinuity, 45, 136
discrete metric, 126
distance to a set, 133
divergence, 256
divergent series, 28
diverges, 20
Dominated Convergence Theorem,
104
dominates, 104
dual, 183
Edelstein‚Äôs Theorem, 149
endpoint, 19, 163
enlargement, 155
Œµ-approximation, 149
equal, 291, 292
equicontinuous, 208
equivalence class, 6
equivalence relation, 6
equivalent metrics, 131
equivalent norms, 184
essential supremum, 204
essentially bounded, 204
Euclidean metric, 127
Euclidean norm, 175
Euclidean space, 127

Index
319
Euler‚Äôs constant, 33
exp, 32
exponential series, 32
extended real line, 129
extension, continuous, 145
extremal element, 93
extreme point, 277
extreme subset, 277
Family, 5
farthest point, 240
Fatou‚Äôs Lemma, 104
feasible array, 305
Ô¨Ånite intersection property, 148
Ô¨Ånite real number, 129
Ô¨Årst category, 280
Ô¨Åxed point, 149, 220
Fourier coeÔ¨Écient, 242, 288
Fourier expansion, 248
Fourier series, 215, 288
frontier, 39
Fubini‚Äôs Series Theorem, 90
function, 3
Fundamental Theorem of Calculus,
68, 69
Gauss‚Äôs Divergence Theorem, 256
geometric series, 28
Glueing Lemma, 163
gradient, 256
Gram‚ÄìSchmidt, 249
graph, 285
greatest element, 7
greatest lower bound, 7
Green‚Äôs Theorem, 256
Hahn‚ÄìBanach Theorem, 262
Hahn‚ÄìBanach Theorem, complex,
263
Heine‚ÄìBorel‚ÄìLebesgue Theorem, 47
Helly‚Äôs Theorem, 277
Hermitian, 254
Hilbert space, 237
H¬®older‚Äôs inequality, 194, 196, 204
hyperplane, 187
hyperplane of support, 188
hyperplane, translated, 188
Idempotent, 256
identity mapping, 136
identity operator, 240
imaginary part, 19
increasing, 8, 101
index set, 5
induced metric, 131
inÔ¨Åmum, 7
inÔ¨Åmum of a function, 8
inÔ¨Ånitely many, 20
inner product, 234
inner product space, 234
integers, 3
integrable, 95, 98, 234
integrable over a set, 99
integrable set, 113
integral, 95, 98
integration by parts, 109
integration space, 197
interior, 37, 130, 135
intermediate value property, 36
Intermediate Value Theorem, 51,
161
interval of convergence, 31
interval, bounded, 19
interval, closed, 19
interval, compact, 19
interval, Ô¨Ånite, 19
interval, half open, 19
interval, inÔ¨Ånite, 19
interval, length of, 19
interval, open, 18
Inverse Mapping Theorem, 285
irreÔ¨Çexive, 5
isolated, 133
isometric, 128
isometry, 128
iterates, 220
Jacobi polynomial, 252
Kernel, 186
Korovkin‚Äôs Theorem, 212, 215
Krein-Milman Theorem, 277
L‚ÄôHÀÜopital‚Äôs Rule, 57
Landau‚Äôs Theorem, 287
Laplacian operator, 257
largest element, 7
laws of indices, 16

320
Index
laws of logarithms, 18
least element, 8
least squares approximation, 250
least upper bound, 7
least‚Äìupper-bound principle, 12
Lebesgue covering property, 153
Lebesgue integrable, 95
Lebesgue integral, 95, 98
Lebesgue measure, 113
Lebesgue number, 153
Lebesgue primitive, 93
Lebesgue‚Äôs Series Theorem, 103
left hand derivative, 282
Legendre polynomial, 252
lim inf, 24
lim sup, 24
limit as x tends to inÔ¨Ånity, 43
limit comparison test, 28
limit inferior, 24
limit of a function, 41
limit of a mapping, 138
limit of a sequence, 20, 139
limit point, 48, 138
limit superior, 24
limit, left‚Äìhand, 41
limit, right‚Äìhand, 41
Lindel¬®of‚Äôs Theorem, 148
linear functional, 182
linear functional, complex‚Äì, 259
linear functional, extension of, 261
linear functional, real‚Äì, 260
linear map, 182
L‚àû, 204
Lipschitz condition, 143, 219
Lipschitz constant, 219
locally compact, 156
locally connected, 160
locally nonsatiated, 304
logarithmic function, 18
lower bound, 7
lower integral, 63, 73
lower limit, 24
lower sum, 63, 73
Lp(X), 197
Lp‚Äìnorm, 197
Majorant, 7
majorised, 7
maximum element, 7
Mazur‚Äôs Lemma, 270
Mean Value Theorem, 57
Mean Value Theorem, Cauchy‚Äôs, 57
measurable, 110
measurable set, 113
measure, 113
measure zero, 80
mesh, 62
metric, 125
metric space, 126
metrisable, 135
minimum element, 7
Minkowski functional, 275
Minkowski‚Äôs inequality, 126, 195,
196, 235
Minkowski‚Äôs Separation Theorem,
278
minorant, 7
minorised, 7
modulus, 19
monotone sequence principle, 22
M¬®untz, 216
multilinear map, 184
multiplication of series, 32
Natural logarithmic function, 18
natural numbers, 3
negative, 12, 294
neighbourhood, 37, 130, 135
nested intervals, 24
nonnegative, 13, 294
nonoverlapping, 84
nonsatiated, 306
nonzero linear map, 186
norm, 174
norm of a linear map, 183
norm, weighted least squares, 249
norm-preserving, 261
normal operator, 254
normed space, 174
nowhere dense, 280
nowhere diÔ¨Äerentiable, 2, 282
null space, 186
Oblique projection, 287
open ball, 130
open mapping, 283
Open Mapping Theorem, 283
open set, 35, 130, 135

Index
321
operator, 253
order dense, 14, 295
orthogonal, 237
orthogonal complement, 237
orthogonal family, 242
orthonormal, 242
orthonormal basis, 247
oscillation, 45
outer measure, 79
outer measure, Ô¨Ånite, 80
P-adic metric, 127
p-power summable, 196
parallelogram law, 236
Pareto optimum, 305
Parseval‚Äôs identity, 248
partial order, 6
partial sum, 27, 180
partially ordered set, 6
partition, 62
path, 163
path component, 164
path connected, 163
Peano‚Äôs Theorem, 228
period, 215
periodic, 215
Picard‚Äôs Theorem, 223
points at inÔ¨Ånity, 129
pointwise, 4
polarisation identity, 255
Polya‚Äôs Theorem, 288
positive, 12, 294
positive integers, 3
positive linear operator, 212
positively homogeneous, 261
power series, 31
precompact, 149
preference relation, 303
preference relation, convex, 306
preference-indiÔ¨Äerence, 304
prehilbert space, 234
preorder, 6
price vector, 303
primitive, 69
producer, 303
product metric, 165
product norm, 176
product normed space, 176
product of paths, 164
product, of metric spaces, 165, 170
production set, 303
production vector, 303
projection, 166, 240
pseudometric, 127
Pythagoras‚Äôs Theorem, 238
Quotient norm, 181
quotient space, 181
Radius, 130
radius of convergence, 31
ratio test, 29
rational approximation, 292
rational complex number, 193
rational number, 291
rational numbers, 3
real line, extended, 129
real number, 12, 292
real number line, 11
real part, 19
rearrangement, 34
reciprocal, 296
reÔ¨Ånement, 62
reÔ¨Çexive, 253, 266
reÔ¨Çexive, 5
regular, 292
remainder term, Cauchy form, 59
remainder term, Lagrange form, 59
representable, 272
representation, 187
Riemann integrable, 64
Riemann integral, 64
Riemann sum, 67
Riemann-Lebesgue Lemma, 112
Riemann‚ÄìStieljtes integrable, 72
Riemann‚ÄìStieltjes integral, 72
Riemann‚ÄìStieltjes sum, 72
Riesz Representation Theorem, 252
Riesz‚Äôs Lemma, 190
Riesz‚ÄìFischer Theorem, 198
right hand derivative, 280
Rodrigues‚Äô formula, 252
Rolle‚Äôs Theorem, 56
root test, 30
Satiated, 306
Schauder basis, 269
second category, 280

322
Index
second dual, 253
self‚Äìmap, 149, 220
selfadjoint, 254
seminorm, 261
separable, 132
separates, 278
sequence, 4
sequentially compact, 149
sequentially continuous, 45, 140
series, 27, 180
simple function, 116
smallest element, 8
step function, 99
Stone‚ÄìWeierstrass Theorem, 216,
219
strict partial order, 6
strict preference, 303
strictly decreasing, 8
strictly increasing, 8
subadditive, 261
subcover, 47, 146
subfamily, 5
sublinear, 261
subsequence, 4
subspace, 131, 176
subspace of a prehilbert space, 234
suÔ¨Éciently large, 20
sum, 180
sup norm, 175, 204
supremum, 7
supremum norm, 175
supremum of a function, 8
symmetric, 5
Taxicab metric, 126
Taylor expansion, 61
Taylor polynomial, 58
Taylor series, 61
Taylor‚Äôs Theorem, 58
term, 4, 27
termwise, 5
Tietze Extension Theorem, 144
topological space, 134
topology, 135
total, 193
total order, 6
totally bounded, 149
totally disconnected, 160
transitive, 6
translation invariant, 81, 99
transported, 128
triangle inequality, 15, 126, 174
triple recursion formula, 251
Ultrametric, 127
unconditionally convergent, 180
uncountable, 4
Uniform Boundedness Theorem,
186, 286
Uniform Continuity Theorem, 49,
154
uniformly approximated, 212
uniformly continuous, 49, 142
uniformly convex, 186
uniformly equicontinuous, 209
unit ball, 174
unit vector, 174
upper bound, 7
upper contour set, 304
upper integral, 63, 73
upper limit, 24
upper sum, 63, 73
Urysohn‚Äôs Lemma, 146
Variation, 71
Vitali covering, 82
Vitali Covering Theorem, 82
Weak solution, 257
Weierstrass Approximation
Theorem, 212
Weierstrass‚Äôs M‚Äìtest, 46
weight function, 235
Zermelo, 299
Zorn‚Äôs Lemma, 300



