Foundations of Real and
Abstract Analysis
Douglas S. Bridges
Springer





Dedicated to the memory of my parents:
Douglas McDonald Bridges and Allison Hogg

Sweet Analytics, ’tis thou hast ravished me.
Faustus (Marlowe)
The stone which the builders refused is become the head stone
of the corner.
Psalm cxviii, 22.
...from so simple a beginning endless forms most beautiful and
most wonderful have been, and are being, evolved.
The origin of species (Darwin)

Preface
The core of this book, Chapters 3 through 5, presents a course on metric,
normed, and Hilbert spaces at the senior/graduate level. The motivation for
each of these chapters is the generalisation of a particular attribute of the
Euclidean space Rn: in Chapter 3, that attribute is distance; in Chapter 4,
length; and in Chapter 5, inner product. In addition to the standard topics
that, arguably, should form part of the armoury of any graduate student
in mathematics, physics, mathematical economics, theoretical statistics,...,
this part of the book contains many results and exercises that are seldom
found in texts on analysis at this level. Examples of the latter are Wong’s
Theorem (3.3.12) showing that the Lebesgue covering property is equivalent
to the uniform continuity property, and Motzkin’s result (5.2.2) that a
nonempty closed subset of Euclidean space has the unique closest point
property if and only if it is convex.
The sad reality today is that, perceiving them as one of the harder parts
of their mathematical studies, students contrive to avoid analysis courses at
almost any cost, in particular that of their own educational and technical
deprivation. Many universities have at times capitulated to the negative
demand of students for analysis courses and have seriously watered down
their expectations of students in that area. As a result, mathematics ma-
jors are graduating, sometimes with high honours, with little exposure to
anything but a rudimentary course or two on real and complex analysis,
often without even an introduction to the Lebesgue integral.
For that reason, and also in order to provide a reference for material
that is used in later chapters, I chose to begin this book with a long
chapter providing a fast–paced course of real analysis, covering conver-

x
Preface
gence of sequences and series, continuity, diﬀerentiability, and (Riemann
and Riemann–Stieltjes) integration. The inclusion of that chapter means
that the prerequisite for the book is reduced to the usual undergraduate
sequence of courses on calculus. (One–variable calculus would suﬃce, in
theory, but a lack of exposure to more advanced calculus courses would in-
dicate a lack of the mathematical maturity that is the hidden prerequisite
for most senior/graduate courses.)
Chapter 2 is designed to show that the subject of diﬀerentiation does
not end with the material taught in calculus courses, and to introduce the
Lebesgue integral. Starting with the Vitali Covering Theorem, the chap-
ter develops a theory of diﬀerentiation almost everywhere that underpins a
beautiful approach to the Lebesgue integral due to F. Riesz [39]. One minor
disadvantage of Riesz’s approach is that, in order to handle multivariate
integrals, it requires the theory of set–valued derivatives, a topic suﬃciently
involved and far from my intended route through elementary analysis that
I chose to omit it altogether. The only place where this might be regarded
as a serious omission is at the end of the chapter on Hilbert space, where
I require classical vector integration to investigate the existence of weak
solutions to the Dirichlet Problem in three–dimensional Euclidean space;
since that investigation is only outlined, it seemed justiﬁable to rely only
on the reader’s presumed acquaintance with elementary vector calculus.
Certainly, one–dimensional integration is all that is needed for a sound in-
troduction to the Lp spaces of functional analysis, which appear in Chapter
4.
Chapters 1 and 2 form Part I (Real Analysis) of the book; Part II (Ab-
stract Analysis) comprises the remaining chapters and the appendices. I
have already summarised the material covered in Chapters 3 through 5.
Chapter 6, the ﬁnal one, introduces functional analysis, starting with the
Hahn–Banach Theorem and the consequent separation theorems. As well
as the common elementary applications of the Hahn–Banach Theorem, I
have included some deeper ones in duality theory. The chapter ends with
the Baire Category Theorem, the Open Mapping Theorem, and their con-
sequences. Here most of the applications are standard, although one or two
unusual ones are included as exercises.
The book has a preliminary section dealing with background material
needed in the main text, and three appendices. The ﬁrst appendix de-
scribes Bishop’s construction of the real number line and the subsequent
development of its basic algebraic and order properties; the second deals
brieﬂy with axioms of choice and Zorn’s Lemma; and the third shows how
some of the material in the chapters—in particular, Minkowski’s Separation
Theorem—can be used in the theory of Pareto optimality and competitive
equilibria in mathematical economics. Part of my motivation in writing
Appendix C was to indicate that “mathematical economics” is a far deeper
subject than is suggested by the undergraduate texts on calculus and linear
algebra that are published under that title.

Preface
xi
I have tried, wherever possible, to present proofs so that they translate
mutatis mutandis into their counterparts in a more abstract setting, such
as that of a metric space (for results in Chapter 1) or a topological space
(for results in Chapter 3). On the other hand, some results ﬁrst appear
as exercises in one context before reappearing as theorems in another: one
example of this is the Uniform Continuity Theorem, which ﬁrst appears as1
Exercise (1.4.8: 8) in the context of a compact interval of R, and which is
proved later, as Corollary (3.3.13), in the more general setting of a compact
metric space. I hope that this procedure of double exposure will enable
students to grasp the material more ﬁrmly.
The text covers just over 300 pages, but the book is, in a sense, much
larger, since it contains nearly 750 exercises, which can be classiﬁed into at
least the following, not necessarily exclusive, types:
• applications and extensions of the main propositions and theorems;
• results that ﬁll in gaps in proofs or that prepare for proofs later in
the book;
• pointers towards new branches of the subject;
• deep and diﬃcult challenges for the very best students.
The instructor will have a wide choice of exercises to set the students as
assignments or test questions. Whichever ones are set, as with the learning
of any branch of mathematics it is essential that the student attempt as
many exercises as the constraints of time, energy, and ability permit.
It is important for the instructor/student to realise that many of the
exercises—especially in Chapters 1 and 2—deal with results, sometimes
major ones, that are needed later in the book. Such an exercise may not
clearly identify itself when it ﬁrst appears; if it is not attempted then, it
will provide revision and reinforcement of that material when the student
needs to tackle it later. It would have been unreasonable of me to have
included major results as exercises without some guidelines for the solution
of the nonroutine ones; in fact, a signiﬁcant proportion of the exercises of
all types come with some such guideline, even if only a hint.
Although Chapters 3 through 6 make numerous references to Chapters 1
and 2, I have tried to make it easy for the reader to tackle the later chapters
without ploughing through the ﬁrst two. In this way the book can be used
as a text for a semester course on metric, normed, and Hilbert spaces. (If
1A reference of the form Proposition (a.b.c) is to Proposition c in Section b of
Chapter a; one to Exercise (a.b.c: d) is to the dth exercise in the set of exercises
with reference number (a.b.c); and one to (B3) is to the 3rd result in Appendix
B. Within each section, displays that require reference indicators are numbered
in sequence: (1), (2), . . . . The counter for this numbering is reset at the start of
a new section.

xii
Preface
Chapter 2 is not covered, the instructor may need to omit material that
depends on familiarity with the Lebesgue integral—in particular Section 4
of Chapter 4.) Chapter 6 could be included to round oﬀan introductory
course on functional analysis.
Chapter 1 could be used on its own as a second course on real analysis
(following the typical advanced calculus course that introduces formal no-
tions of convergence and continuity); it could also be used as a ﬁrst course
for senior students who have not previously encountered rigorous analysis.
Chapters 1 and 2 together would make a good course on real variables, in
preparation for either the material in Chapters 3 through 5 or a course on
measure theory. The whole book could be used for a sequence of courses
starting with real analysis and culminating in an introduction to functional
analysis.
I have drawn on the resource provided by many excellent existing texts
cited in the bibliography, as well as some original papers (notably [39], in
which Riesz introduced the development of the Lebesgue integral used in
Chapter 2). My ﬁrst drafts were prepared using the T 3 Scientiﬁc Word
Processing System; the ﬁnal version was produced by converting the drafts
to TEX and then using Scientiﬁc Word. Both T 3 and Scientiﬁc Word are
products of TCI Software Research, Inc.
I am grateful to the following people who have helped me in the
preparation of this book:
— Patrick Er, who ﬁrst suggested that I oﬀer a course in analysis for
economists, which mutated into the regular analysis course from
which the book eventually emerged;
— the students in my analysis classes from 1990 to 1996, who suﬀered
various slowly improving drafts;
— Cris Calude, Nick Dudley Ward, Mark Schroder, Alfred Seeger, Doru
Stefanescu, and Wang Yuchuan, who read and commented on parts
of the book;
— the wonderfully patient and cooperative staﬀat Springer–Verlag;
— my wife and children, for their patience (in more than one sense).
It is right and proper for me here to acknowledge my unspoken debt of
gratitude to my parents. This book really began 35 years ago, when, with
their somewhat mystiﬁed support and encouragement, I was beginning my
love aﬀair with mathematics and in particular with analysis. It is sad that
they did not live to see its completion.
Douglas Bridges
28 January 1997

Contents
Preface
ix
Introduction
1
I
Real Analysis
9
1
Analysis on the Real Line
11
1.1
The Real Number Line . . . . . . . . . . . . . . . . . . . . .
11
1.2
Sequences and Series . . . . . . . . . . . . . . . . . . . . . .
20
1.3
Open and Closed Subsets of the Line . . . . . . . . . . . . .
35
1.4
Limits and Continuity . . . . . . . . . . . . . . . . . . . . .
41
1.5
Calculus . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
53
2
Diﬀerentiation and the Lebesgue Integral
79
2.1
Outer Measure and Vitali’s Covering Theorem
. . . . . . .
79
2.2
The Lebesgue Integral as an Antiderivative
. . . . . . . . .
93
2.3
Measurable Sets and Functions . . . . . . . . . . . . . . . .
110
II
Abstract Analysis
123
3
Analysis in Metric Spaces
125
3.1
Metric and Topological Spaces
. . . . . . . . . . . . . . . .
125
3.2
Continuity, Convergence, and Completeness . . . . . . . . .
135

xiv
Contents
3.3
Compactness
. . . . . . . . . . . . . . . . . . . . . . . . . .
146
3.4
Connectedness
. . . . . . . . . . . . . . . . . . . . . . . . .
158
3.5
Product Metric Spaces . . . . . . . . . . . . . . . . . . . . .
165
4
Analysis in Normed Linear Spaces
173
4.1
Normed Linear Spaces . . . . . . . . . . . . . . . . . . . . .
174
4.2
Linear Mappings and Hyperplanes
. . . . . . . . . . . . . .
182
4.3
Finite–Dimensional Normed Spaces . . . . . . . . . . . . . .
189
4.4
The Lp Spaces
. . . . . . . . . . . . . . . . . . . . . . . . .
194
4.5
Function Spaces . . . . . . . . . . . . . . . . . . . . . . . . .
204
4.6
The Theorems of Weierstrass and Stone . . . . . . . . . . .
212
4.7
Fixed Points and Diﬀerential Equations
. . . . . . . . . . .
219
5
Hilbert Spaces
233
5.1
Inner Products . . . . . . . . . . . . . . . . . . . . . . . . .
233
5.2
Orthogonality and Projections
. . . . . . . . . . . . . . . .
237
5.3
The Dual of a Hilbert Space . . . . . . . . . . . . . . . . . .
252
6
An Introduction to Functional Analysis
259
6.1
The Hahn–Banach Theorem . . . . . . . . . . . . . . . . . .
259
6.2
Separation Theorems . . . . . . . . . . . . . . . . . . . . . .
275
6.3
Baire’s Theorem and Beyond . . . . . . . . . . . . . . . . .
279
A What Is a Real Number?
291
B Axioms of Choice and Zorn’s Lemma
299
C Pareto Optimality
303
References
311
Index
317

Introduction
We may our ends by our beginnings know.
of prudence (Sir John Denham)
What we now call analysis grew out of the calculus of Newton and Leib-
niz, was developed throughout the eighteenth century (notably by Eu-
ler), and slowly became logically sound (rigorous) through the work of
Gauss, Cauchy, Riemann, Weierstrass, Lebesgue, and many others in the
nineteenth and early twentieth centuries.
Roughly, analysis may be characterised as the study of limiting pro-
cesses within mathematics. These processes traditionally include the con-
vergence of inﬁnite sequences and series, continuity, diﬀerentiation, and
integration, on the real number line R ; but in the last 100 years analysis
has moved far from the one– or ﬁnite–dimensional setting, to the extent
that it now deals largely with limiting processes in inﬁnite–dimensional
spaces equipped with structures that produce meaningful abstractions of
such notions as limit and continuous. Far from being merely the fantasti-
cal delight of mathematicians, these inﬁnite–dimensional abstractions have
served both to clarify phenomena whose true nature is often obscured by the
peculiar structure of R, and to provide foundations for quantum physics,
equilibrium economics, numerical approximation—indeed, a host of areas of
pure and applied mathematics. So important is analysis that it is no exag-
geration to describe as seriously deﬁcient any honours graduate in physics,
mathematics, or theoretical economics who has not had good exposure to
at least the fundamentals of metric, normed, and Hilbert space theory, if

2
Introduction
not the next step, in which metric notions all but disappear in the further
abstraction of topological spaces.
Like many students of mathematics, even very good ones, you may ﬁnd
it hard to see the point of analysis, in which intuition often seems sacri-
ﬁced to the demon of rigour. Is our intuition—algebraic, arithmetic, and
geometric—not a suﬃciently good guide to mathematical reality in most
cases? Alas, it is not, as is illustrated by considering the diﬀerentiability of
functions. (We are assuming here that you are familiar with the derivative
from elementary calculus courses.)
When you ﬁrst met the derivative, you probably thought that any contin-
uous (real–valued) function—that is, loosely, one with an unbroken graph—
on an interval of R has a derivative at all points of its domain; in other
words, its graph has a tangent everywhere. Once you came across simple
examples, like the absolute value function x →|x| , of functions whose
graphs are unbroken but have no tangent at some point, it would have
been natural to conjecture that if the graph were unbroken, then it had a
tangent at all but a ﬁnite number of points. If you were really smart, you
might even have produced an example of a continuous function, made up
of lots of spikes, which was not diﬀerentiable at any of a sequence of points.
This is about as far as intuition can go. But, as Weierstrass showed in the
last century, and as you are invited to demonstrate in Exercise (1.5.1: 2),
there exist continuous functions on R whose derivative does not exist any-
where. Even this is not the end of the story: in a technical sense discussed
in Chapter 6, most continuous functions on R are nowhere diﬀerentiable!
Here, then, is a dramatic failure of our intuition. We could give examples of
many others, all of which highlight the need for the sort of careful analysis
that is the subject of this book.
Of course, analysis is not primarily concerned with pathological exam-
ples such as Weierstrass’s one of a continuous, nowhere diﬀerentiable func-
tion. Its main aim is to build up a body of concepts, theorems, and proofs
that describe a large part of the mathematical world (roughly, the contin-
uous part) and are well suited to the mathematical demands of physicists,
economists, statisticians, and others. The central chapters of this book,
Chapters 3 through 5, give you an introduction to some of the fundamental
concepts and results of modern analysis. The earlier chapters serve either as
a background reference for the later ones or, if you have not studied much
real analysis before, as a rapid introduction to that topic, in preparation
for the rest of the book. The ﬁnal chapter introduces some of the main
themes of functional analysis, the study of continuous linear mappings on
inﬁnite–dimensional spaces.
Having understood Chapters 3 through 6, you should be in a position to
appreciate such other jewels of modern analysis as
• abstract measure spaces, integration, and probability theory;

Introduction
3
• approximation theory, in which complicated types of functions are
approximated by more tractable ones such as polynomials of ﬁxed
maximum degree;
• spectral theory of linear operators on a Hilbert space, generalising
the theory of eigenvalues and eigenvectors of matrices;
• analysis of one and several complex variables;
• duality theory in topological vector spaces;
• Haar measure and duality on locally compact groups, and the
associated abstract generalisation of the Fourier transform;
• C∗– and von Neumann algebras of operators on a Hilbert space,
providing rigorous foundations for quantum mechanics;
• the theory of partial diﬀerential equations and the related potential
problems of classical physics;
• the calculus of variations and optimisation theory.
These, however, are the subjects of other books. The time has come to
begin this one by outlining the background material needed in the main
chapters.
Throughout this book, we assume familiarity with the fundamentals of
informal set theory, as found in [20]. We use the following notation for sets
of numbers.
The set of natural numbers:
N
=
{0, 1, 2, . . .}.
The set of positive integers:
N+
=
{1, 2, 3, . . .} .
The set of integers:
Z
=
{0, −1, 1, −2, 2, . . .}.
The set of rational numbers:
Q
=

± m
n : m, n ∈N, n ̸= 0

.
For the purposes of this preliminary section only, we accept as given the
algebraic and order properties of the set R of real numbers, even though
these are not introduced formally until Chapter 1.
When the rule and domain describing a function f : A →B are known
or clearly understood, we may denote f by
x →f(x).
Note that we use the arrow →as in “the function f : A →B ”, and the
barred arrow →as in “the function x →x3 on R”.
We regard two functions with the same rule but diﬀerent domains as
diﬀerent functions. In fact, we deﬁne two functions f and g to be equal if
and only if

4
Introduction
• they have the same domain and
• f(x) = g(x) for each x in that domain.
Thus the function x →x2 with domain N is not the same as the function
x →x2 with domain R. When considering a rule that deﬁnes a function,
we usually take the domain of the function as the set of all objects x (or
at least all x of the type we wish to consider) to which the rule can be
applied. For example, if we are working in the context of R, we consider
the domain of the function x →1/(x −1) to be the set consisting of all
real numbers other than 1.
We sometimes give explicit deﬁnitions of functions by cases. For example,
f(x) =



0
if x is rational
1
if x is irrational
deﬁnes a function f : R →{0, 1}.
A sequence is just a special kind of function: namely, one of the form
n →xn with domain N+; xn is then called the nth term of the sequence.
We denote by (xn)∞
n=1, or (x1, x2, . . .), or even just (xn), the sequence whose
nth term is xn. (Of course, n is a dummy variable here; so, for example,
(xk) is the same sequence as (xn).) If all the terms of (xn) belong to a set
X, we refer to (xn) as a sequence in X. We also apply the word “sequence”,
and notations such as (xn)∞
n=ν, to a mapping n →xn whose domain has
the form {n ∈Z : n ≥ν} for some integer ν.
A subsequence of (xn) is a sequence of the form
(xnk)∞
k=1 = (xn1, xn2, xn3, . . .),
where n1 < n2 < n3 < · · · . More generally, if f is a one–one mapping of N+
into itself, we write (xf(n))∞
n=1, or even just (xf(n)), to denote the sequence
whose nth term is xf(n). This enables us, in Section 2 of Chapter 1, to
make sense of an expression like ∞
n=1 xf(n), denoting a rearrangement of
the inﬁnite series ∞
n=1 xn.
By a ﬁnite sequence we mean an ordered n–tuple (x1, . . . , xn), where n
is any positive integer.
A nonempty set X is said to be countable, or to have countably many
elements, if it is the range of a sequence. Note that a nonempty ﬁnite set
is countable according to this deﬁnition. An inﬁnite countable set is said
to be countably inﬁnite. We regard the empty set as being both ﬁnite and
countable. A set that is not countable is said to be uncountable, and to
have uncountably many elements.
Let f, g be mappings from subsets of a set X into a set Y, where Y
is equipped with a binary operation 3. We introduce the corresponding

Introduction
5
pointwise operation 3 on f and g by setting
(f3g)(x) = f(x)3g(x)
whenever f(x) and g(x) are both deﬁned. Thus, taking Y = R, we see that
the (pointwise) sum of f and g is given by
(f + g)(x) = f(x) + g(x)
if f(x) and g(x) are both deﬁned; and that the (pointwise) quotient of f
and g is given by
(f/g)(x) = f(x)/g(x)
if f(x) and g(x) are deﬁned and g(x) ̸= 0. If X = N+, so that f = (xn)
and g = (yn) are sequences, then we also speak of termwise operations; for
example, the termwise product of f and g is the sequence (xnyn)∞
n=1.
Pointwise operations extend in the obvious ways to ﬁnitely many func-
tions. In the case of a sequence (fn)∞
n=1 of functions with values in a normed
space (see Chapter 4), once we have introduced the notion of a series in a
normed space, we interpret ∞
n=1 fn in the obvious way.
By a family of elements of a set X we mean a mapping λ →xλ of a set
L, called the index set for the family, into X. We also denote such a family
by (xλ)λ∈L. A family with index set N+ is, of course, a sequence. By a
subfamily of a family (xλ)λ∈L we mean a family (xλ)λ∈J where J ⊂L.
If (Sλ)λ∈L is a family of sets, we write

λ∈L
Sλ =

x : ∃λ ∈L

x ∈Sλ
	
,

λ∈L
Sλ =

x : ∀λ ∈L

x ∈Sλ
	
,
and we call 
λ∈L Sλ and 
λ∈L Sλ, respectively, the union and the
intersection of the family (Sλ)λ∈L.
We need some information about order relations on a set. (For fuller
information about orders in general see Chapter 1 of [9].)
A binary relation R on a set X is said to be
• reﬂexive if
∀a ∈X (aRa);
• irreﬂexive if
∀a ∈X (not(aRa)) ;
• symmetric if
∀a, b ∈X (aRb ⇒bRa);

6
Introduction
• asymmetric if
∀a, b ∈X (aRb ⇒not(bRa));
• antisymmetric if
∀a, b ∈X ((aRb and bRa) ⇒a = b);
• transitive if
∀a, b, c ∈X ((aRa and bRc) ⇒aRc);
• total if
∀a, b ∈X (aRb or bRa).
We use ≽to represent a reﬂexive relation, and ≻to represent an irreﬂex-
ive one. The notation a ≼b (respectively, a ≺b) is equivalent to b ≽a
(respectively, b ≻a). When dealing with the usual order relations on the
real line R, we use the standard symbols ≥, >, ≤, < instead of ≽, ≻, ≼, ≺,
respectively.
A binary relation R on a set X is said to be
• a preorder if it is reﬂexive and transitive;
• an equivalence relation if it is a symmetric preorder (in which case X
is partitioned into disjoint equivalence classes, each equivalence class
consisting of elements that are related under R, and the set of these
equivalence classes, written X/R, is called the quotient set for R);
• a partial order if it is an antisymmetric preorder;
• a total order if it is a total partial order;
• a strict partial order if it is asymmetric and transitive—or, equiva-
lently, if it is irreﬂexive and transitive.
If R is a partial order on X, we call the pair (X, R) —or, when there is
no risk of confusion, just the set X itself—a partially ordered set.
With each preorder ≽on X we associate a strict partial order ≻and an
equivalence relation ∼on X, deﬁned as follows.
x ≻y
if and only if
x ≽y and not(y ≽x);
x ∼y
if and only if
x ≽y and y ≽x.
If ≽is a total order, we have the Law of Trichotomy:
∀x, y, z ∈X (x ≻y or x = y or x ≺y) .

Introduction
7
Let S be a nonempty subset of a partially ordered set (X, ≽). An element
B ∈X is called an upper bound, or majorant, of S (relative to ≽) if B ≽x
for all x ∈S. If there exist upper bounds of S, then we say that S is bounded
above, or majorised. An element B ∈X is called a least upper bound, or
supremum, of S if the following two conditions are satisﬁed.
— B is an upper bound of S;
— if B′ is an upper bound of S, then B′ ≽B.
Note that S has at most one supremum: for if B, B′ are suprema of S, then
B′ ≽B ≽B′ and so B′ = B, by the antisymmetry of ≽. If the supremum
of S exists, we denote it by sup S. We also denote it by
sup
1≤i≤n
xi, max S,
max
1≤i≤n xi,
or x1 ∨x2 ∨· · · ∨xn
if S = {x1, . . . , xn} is a ﬁnite set, and by
sup
n≥1
xn or
∞

n=1
xn
if S = {x1, x2, . . .} is a countable set; we use similar notations without fur-
ther comment. An upper bound of S that belongs to S is called a maximum
element of S, and is then a least upper bound of S. The maximum element,
if it exists, of S is also called the largest, or greatest, element of S.
An element b ∈X is called a lower bound, or minorant, of S (relative to
≽) if x ≽b for all x ∈S. If there exist lower bounds of S, then we say that
S is bounded below, or minorised. An element b ∈X is called a greatest
lower bound, or inﬁmum, of S if the following two conditions are satisﬁed.
— b is a lower bound of S;
— if b′ is a lower bound of S, then b ≽b′.
S has at most one inﬁmum, which we denote by inf S. When describing
inﬁma, we also use such notations as
inf
1≤i≤n xi, min S,
min
1≤i≤n xi, or x1 ∧x2 ∧· · · ∧xn
if S = {x1, . . . , xn} is a ﬁnite set, and
inf
n≥1 xn or
∞

n=1
xn
if S = {x1, x2, . . .} is a countable set. A lower bound of S that belongs to
S is called a minimum element of S, and is a greatest lower bound of S.

8
Introduction
The minimum element, if it exists, of S is also called the smallest, or least,
element of S.
The usual partial order ≥on R gives rise to important operations on
functions. If f, g are real–valued functions, we write f ≥g (or g ≤f) to
indicate that f(x) ≥g(x) for all x common to the domains of f and g.
Regarding ∨and ∧as binary operations on R, we deﬁne the corresponding
functions f ∨g and f ∧g as special cases of the notion f3g previously
introduced. By extension of these ideas, if (fn)∞
n=1 is a sequence of real–
valued functions, then the functions ∞
n=1 fn and ∞
n=1 fn are deﬁned by
 ∞

n=1
fn

(x) =
∞

n=1
fn(x),
 ∞

n=1
fn

(x) =
∞

n=1
fn(x),
whenever the right–hand sides of these equations make sense.
Now let f be a mapping of a set X into the partially ordered set (R, ≥).
We say that f is bounded above on X if
f(X) = {f(x) : x ∈X}
is bounded above as a subset of Y. We call sup f(X), if it exists, the supre-
mum of f on X, and we denote it by sup f, supx∈X f(x), or, in the case
where X is a ﬁnite set, max f. We also use obvious variations on these nota-
tions, such as supn≥1 f(n) when X = N+. We adopt analogous deﬁnitions
and notations for bounded below on X, inﬁmum of f, inf f, and min f.
Finally, let f be a mapping of a partially ordered set (X, ≽) into the
partially ordered set (R, ≥). We say that f is
— increasing if f(x) ≥f(x′) whenever x ≽x′;
— strictly increasing if f(x) > f(x′) whenever x ≻x′;
— decreasing if f(x) ≤f(x′) whenever x ≽x′; and
— strictly decreasing if f(x) < f(x′) whenever x ≻x′.
Note that we use “increasing” and “strictly increasing” where some authors
would use “nondecreasing” and “increasing”, respectively.

Part I
Real Analysis

1
Analysis on the Real Line
...I will a round unvarnish’d tale deliver...
othello, Act 1, Scene 3
In this chapter we provide a self–contained development of analysis on the real
number line. We begin with an axiomatic presentation of R, from which we de-
velop the elementary properties of exponential and logarithmic functions. We
then discuss the convergence of sequences and series, paying particular atten-
tion to applications of the completeness of R. Section 3 introduces open and
closed sets, and lays the groundwork for later abstraction in the context of a
metric space. Section 4 deals with limits and continuity of real–valued functions;
the Heine–Borel–Lebesgue and Bolzano–Weierstrass theorems prepare us for the
general, and extremely useful, notion of compactness, which is discussed in Chap-
ter 3. The ﬁnal section deals with the diﬀerential and integral calculus, a subject
that is reviewed from a more advanced standpoint in Chapter 2.
1.1
The Real Number Line
Although it is possible to construct the real number line R from N using
elementary properties of sets and functions, in order to take us quickly
to the heart of real analysis we relegate such a construction to Appendix
A and instead present a set of axioms suﬃcient to characterise R. These
axioms fall into three categories: the ﬁrst introduces the algebra of real
numbers; the remaining two are concerned with the ordering on R.

12
1. Analysis on the Real Line
Axiom R1.
R is a ﬁeld—that is, there exist
a binary operation (x, y) →x + y of addition on R,
a binary operation (x, y) →xy of multiplication1 on R,
distinguished elements 0 (zero) and 1 (one) of R, with 0 ̸= 1,
a unary operation x →−x (negation) on R, and
a unary operation x →x−1 of reciprocation, or inversion, on R\ {0}
such that for all x, y, z ∈R,
x + y = y + x,
(x + y) + z = x + (y + z) ,
0 + x = x,
x + (−x) = 0,
xy = yx,
(xy) z = x (yz) ,
x(y + z) = xy + xz,
1x = x, and
xx−1 = 1 if x ̸= 0.
Of course, we also denote x−1 by 1
x or 1/x.
Axioms R2.
R is endowed with a total partial order ≥(greater than
or equal to), and hence an associated strict partial order > (greater than),
such that
• if x ≥y, then x + z ≥y + z, and
• if x ≥0 and y ≥0, then xy ≥0.
Axiom R3.
The least–upper–bound principle: if a nonempty subset S of
R is bounded above relative to the relation ≥, then it has a (unique) least
upper bound.
The elements of R are called real numbers. We say that a real number
x is
• positive if x > 0,
• negative if −x > 0, and
1For clarity, we sometimes write x · y or x × y for the product xy.

1.1 The Real Number Line
13
• nonnegative if x ≥0.
We denote the set of positive real numbers by R+, and the set of
nonnegative real numbers by R0+.
Many of the fundamental arithmetic and order properties of R are imme-
diate consequences of results in the elementary theories of ﬁelds and partial
orders, respectively. A number of these, illustrating the interplay between
the algebra and the ordering on R, are given in the next set of exercises.2
(1.1.1) Exercises
Prove each of the following statements, where x, y, xi, yi (1 ≤i ≤n) are
real numbers.
.1
If xi ≥yi for each i, then n
i=1 xi ≥n
i=1 yi. If also xk > yk for
some k, then n
i=1 xi > n
i=1 yi.
.2
x ≥y if and only if x + z ≥y + z for all z ∈R ; this remains true
with each instance of ≥replaced by one of > .
.3
If xi ≥0 for each i and n
i=1 xi = 0, then x1 = x2 = · · · = xn = 0.
.4
The following are equivalent: x ≥y, x −y ≥0, −y ≥−x, 0 ≥y −x;
these equivalences also hold with ≥replaced everywhere by > .
.5
If x ≥y and z ≥0, then xz ≥yz.
.6
If x > 0 and y > 0, then xy > 0; if x > 0 and 0 > y, then 0 > xy; if
0 > x and 0 > y, then xy > 0; and these results hold with > replaced
everywhere by ≥.
.7
x2 ≥0, and x2 = 0 if and only if x = 0.
.8
If x > 0, then x−1 > 0; and if x < 0, then x−1 < 0.
.9
x ≥y if and only if xz ≥yz for all z > 0.
.10 x > y > 0 if and only if y−1 > x−1 > 0.
.11 max{x, y} ≥0 if and only if x ≥0 or y ≥0; max {x, y} > 0 if and
only if x > 0 or y > 0.
.12 min{x, y} ≥0 if and only if x ≥0 and y ≥0; min{x, y} > 0 if and
only if x > 0 and y > 0.
2If you are comfortable with the elementary ﬁeld and order properties of R,
then you can safely omit Exercises (1.1.1) and (1.1.2).

14
1. Analysis on the Real Line
.13 The mapping
n →n1 =







0
if n = 0
1 + 1 + · · · + 1



n terms
if n ≥1
from N into R is one–one and preserves order, addition, and
multiplication.
We use this mapping to identify N with the subset {n1 : n ∈N} of
R. In turn, we then identify a negative integer n with −(−n) 1, and
a rational number m/n with the real number mn−1. We make these
identiﬁcations without further comment.
.14 If S is a nonempty majorised set of integers, then m = sup S is an
integer. (Assume the contrary and obtain integers n, n′ such that
m −1 < n < n′ < m.)
.15 There exists n ∈Z such that n −1 ≤x < n. (If x ≥0, apply the
least–upper–bound principle to S = {k ∈Z : k ≤x} .)
.16 If x > 0 and y ≥0, then there exists n ∈N+ such that nx > y.
(Consider {k ∈N : kx ≤y} .)
This important property is sometimes introduced as an axiom, the
Axiom of Archimedes.
.17 x > 0 if and only if there exists a positive integer n > x−1.
.18 x ≥0 if and only if x ≥−1/n for all positive integers n.
.19 Q is order dense in R —that is, if x < y, then there exists q ∈Q such
that x < q < y. (Reduce to the case y > 0. Choose in turn integers
n > 1/(y −x) and k ≥ny, and let m be the least integer such that
y ≤m/n. Show that x < (m −1)/n < y.)
.20 If S and T are nonempty majorised sets of positive numbers, then
sup {st : s ∈S, t ∈T} = sup S × sup T.
.21 The following are equivalent conditions on nonempty subsets X and
Y of R.
(i) x ≤y for all x ∈X and y ∈Y.
(ii) There exists τ ∈R such that x ≤τ ≤y for all x ∈X and y ∈Y.

1.1 The Real Number Line
15
Each real number x has a corresponding absolute value, deﬁned as
|x| = max {x, −x} .
(1.1.2) Exercises
Prove each of the following statements about real numbers x, y, ε.
.1
|x| ≥0, and |x| = 0 if and only if x = 0.
.2
|x| ≤ε if and only if −ε ≤x ≤ε.
.3
|x| < ε if and only if −ε < x < ε.
.4
x = 0 if and only if either |x| ≤ε for each ε > 0 or else |x| < ε for
each ε > 0.
.5
|x + y| ≤|x| + |y| (triangle inequality).
.6
|x −y| ≥||x| −|y|| .
.7
|xy| = |x| |y| .
So far we have not indicated how useful the least–upper–bound principle
is. In fact, it is not only useful, but essential: the ﬁeld Q of rational numbers,
with its usual ordering >, satisﬁes all the properties listed in axioms R1
and R2, so we need something more to distinguish R from Q. Moreover,
without the least–upper–bound principle or some property equivalent to it,
we cannot even prove that a positive real number has a square root.
We now sketch how the least–upper–bound principle enables us to deﬁne
ar for any a > 0 and any r ∈R. When n is an integer, an is deﬁned as in
elementary algebra. So our ﬁrst real task is to deﬁne am/n when m and n
are nonzero integers; this we do by setting
am/n = sup {x ∈R : xn < am} .
(1)
Of course, we are using the least–upper–bound principle here, so we must
ensure that the set on the right–hand side of (1) is both nonempty and
bounded above. To prove that it is nonempty, we use the Axiom of
Archime– des (Exercise (1.1.1: 16)) to ﬁnd a positive integer k such that
kam > 1; then knam ≥kam > 1, so (1/k)n < am. On the other hand, as
(1 + am)n ≥1 + nam > am
if n ≥1, and

1
1+am
n
≥1 −nam > am
if n ≤−1,
the set in question is bounded above (by 1 + am in the ﬁrst case, and by
1/ (1 + am) in the second). Hence am/n exists.
Our ﬁrst result enables us to prove some basic properties of am/n.

16
1. Analysis on the Real Line
(1.1.3) Lemma.
Let a > 0 and s be real numbers, and m, n positive
integers such that sn < am. Then there exists t ∈R such that s < t and
tn < am.
Proof.
Using Exercise (1.1.1: 16), choose a positive integer N such that
0 < N −1 < min

1, 2−n (1 + |s|)−n (am −sn)

.
Writing t = s + N −1 and using the binomial theorem, we have
tn =
n

k=0
n
k

sn−kN −k
≤sn +
n

k=1
n
k

|s|n−k N −1
< sn + N −1
n

k=0
n
k

(1 + |s|)n−k
< sn + (1 + |s|)n N −1
n

k=0
n
k

= sn + 2n (1 + |s|)n N −1
< am,
as we required.
2
Taking s = 0 in this lemma, we see that am/n > 0. The lemma also
enables us to prove that

am/nn
= am.
(2)
For if

am/n	n < am, then, by Lemma (1.1.3), there exists t > am/n such
that tn < am, which contradicts the deﬁnition of am/n; on the other hand,
that same deﬁnition ensures that

am/n	n ≤am and hence that (2) holds.
Using (2) and methods familiar from elementary algebra courses, we can
now prove the usual laws of indices,
aras = ar+s,
(ar)s = ars,
when the indices r, s are rational.
We next extend the deﬁnition of ar to cover all r ∈R. To begin with,
we consider the case a > 1, when we deﬁne
ar = sup {aq : q ∈Q, q < r} .
(3)

1.1 The Real Number Line
17
It is left as an exercise to show that the set on the right–hand side of (3)
is nonempty and bounded above, and that if r is rational, this deﬁnition
gives ar the same value as the one given by our earlier deﬁnition. We can
now prove the laws of indices for arbitrary r, s ∈R. Taking the ﬁrst law
as an illustration, we observe that if u, v are rational numbers with u < r
and v < s, then u + v < r + s, so
auav = au+v ≤ar+s.
By Exercise (1.1.1: 20),
aras = sup {au : u ∈Q, u < r} × sup {av : v ∈Q, v < s}
= sup {auav : u, v ∈Q, u < r, v < s}
≤ar+s.
On the other hand, if q ∈Q and q < r+s, then we choose rational numbers
u, v with u < r, v < s, and q = u + v : to do so, we use Exercise (1.1.1: 19)
to ﬁnd u ∈Q with q −s < u < r and we then set v = q −u. We have
aq = au+v = auav ≤aras.
Hence
ar+s = sup {aq : q ∈Q, q < r + s} ≤aras,
and therefore aras = ar+s.
It remains to deﬁne
ar =




a−1	−r
if 0 < a < 1
1
if a = 1
and to verify—routinely—that the laws of indices hold in these cases also.
(1.1.4) Exercises
.1
Let a > 1 and let r ∈R. Prove that {aq : q ∈Q, q < r} is nonempty
and bounded above. Prove also that if r = m/n for integers m, n with
n ̸= 0, then deﬁnitions (1) and (3) give the same value for ar.
.2
Prove that if 0 < a ̸= 1 and ax = 1, then x = 0. (Consider ﬁrst the
case where a > 1, and note that if q ∈Q and aq ≤1, then q ≤0.)
.3
Let a > 0 and x > y. Prove that if a > 1, then ax > ay; and that if
a < 1, then ax < ay.
.4
Prove that if a > 0, then for each x > 0 there exists a unique y ∈R
such that ay = x. (First take a > 1 and x > 1. Write a = 1 + t and,
by expanding (1 + t)n, compute n ∈N+ such that an > x. Then
consider {q ∈Q : aq ≤x}.)

18
1. Analysis on the Real Line
.5
Let f be a strictly increasing mapping of R onto R+ such that f(0) =
1 and f(x+y) = f(x)f(y). Prove that f(x) = ax, where a = f(1) > 1.
(First prove that f(q) = aq for all rational q.)
If a > 0, Exercise (1.1.4: 4) allows us to deﬁne loga, the logarithmic
function with base a, as follows. For each x > 0,
y = loga x
if and only if
ay = x.
This function has domain R+ and maps R+ onto R. From the laws of
indices we easily deduce the laws of logarithms:
loga xy = loga x + loga y,
loga(xr) = r loga x,
logb x = logb a × loga x, where b > 0.
Anticipating the theory of convergence of series from the next section,
we introduce the number
e =
∞

n=0
1
n!
and call loge the natural logarithmic function on R+. It is customary to
denote loge by either log or ln .
(1.1.5) Exercises
.1
Prove the laws of logarithms.
.2
Prove that if a > 1, then the function loga is strictly increasing; and
that if 0 < a < 1, then loga is strictly decreasing.
.3
Let a > 1, and let f be an increasing mapping of R+ into R such
that f(a) = 1 and f(xy) = f(x) + f(y). Prove that f(x) = loga x.
For convenience, we collect here the deﬁnitions of the various types of
interval in R.
The open intervals are the sets of the following forms, where a, b are real
numbers with a < b :
(a, b) = {x ∈R : a < x < b} ,
(a, ∞) = {x ∈R : a < x} ,
(−∞, b) = {x ∈R : x < b} ,
(−∞, ∞) = R.

1.1 The Real Number Line
19
The closed intervals are the sets of the following forms, where a, b are real
numbers with a ≤b :
[a, b] = {x ∈R : a ≤x ≤b} ,
[a, ∞) = {x ∈R : a ≤x} ,
(−∞, b] = {x ∈R : x ≤b} .
By convention, R is regarded as both an open interval and a closed interval.
The remaining types of interval are:
half open on the left:
(a, b]
=
{x ∈R : a < x ≤b} ,
half open on the right:
[a, b)
=
{x ∈R : a ≤x < b} .
Intervals of the form [a, b], (a, b), [a, b), or (a, b], where a, b ∈R, are said
to be ﬁnite or bounded, and to have left endpoint a, right endpoint b, and
length b −a. Intervals of the remaining types are called inﬁnite and are
said to have length ∞. The length of any interval I is denoted by |I| . A
bounded closed interval in R is also called a compact interval.
Finally, we deﬁne the complex numbers to be the elements of the set
C = R × R, with the usual equality and with algebraic operations of
addition and multiplication deﬁned, respectively, by the equations
(x, y) + (x′, y′) = (x + x′, y + y′),
(x, y) × (x′, y′) = (xx′ −yy′, xy′ + x′y).
Then x →(x, 0) is a one–one mapping of R onto the set C × {0} and is
used to identify R with that subset of C. With this identiﬁcation, we have
i2 = −1, where i is the complex number (0, 1); so the complex number
(x, y) can be identiﬁed with the expression x + iy. The real numbers x and
y are then called the real and imaginary parts of z = (x, y), respectively,
and we write
x = Re(x, y),
y = Im(x, y).
The conjugate of z is
z∗= (x, −y) = x −iy,
and the modulus of z is
|z| =

x2 + y2.
In the remainder of this book we assume the basic properties of the real
and complex numbers such as those found in the foregoing exercises.

20
1. Analysis on the Real Line
1.2
Sequences and Series
Although often relegated to a minor role in courses on real analysis, the
theory of convergence of sequences and series in R provides both a model
for more abstract convergence theories such as those in our later chapters,
and many important examples.
It is convenient to introduce here two useful expressions about properties
of positive integers. Let P(m, n) be a property applicable to pairs (m, n) of
positive integers. If there exists N such that P(m, n) holds for all m, n ≥N,
then we say that P(m, n) holds for all suﬃciently large m and n. We
interpret similarly the statement P(n) holds for all suﬃciently large n,
where P(n) is a property applicable to positive integers n. On the other
hand, if for each positive integer i there exists a positive integer j > i such
that P(j) holds, then we say that P(n) holds for inﬁnitely many values of
n.
We say that a sequence3 (an) of real numbers converges to a real number
a, called the limit of (an), if for each ε > 0 there exists a positive integer
N, depending on ε, such that |a −an| ≤ε whenever n ≥N. Thus (an)
converges to a if and only if for each ε > 0 we have |a −an| ≤ε for all
suﬃciently large n. In that case we write
lim
n→∞an = a
or
an →a as n →∞,
and we also say that an tends to a as n →∞.
On the other hand, we say that (an) diverges to ∞, and we write
an →∞as n →∞,
if for each K > 0 we have an > K for all suﬃciently large n. If for each
K > 0 we have an < −K for all suﬃciently large n, then we say that (an)
diverges to −∞, and we write
an →−∞as n →∞.
(1.2.1) Exercises
.1
Prove that if (an) converges to both a and a′, then a = a′. (Show
that |a −a′| < ε for each ε > 0. This exercise justiﬁes the use of the
deﬁnite article in the phrase “the limit of (an) ”.)
3We can extend the deﬁnitions of convergence and divergence of sequences in
the obvious ways to cover families of the form (an)n≥ν, where ν ∈Z; all that
matters is that an be deﬁned for all suﬃciently large positive integers n. This
observation makes sense of the last part of Proposition (1.2.2), where we discuss
the limit of a quotient of two sequences.

1.2 Sequences and Series
21
.2
Let c > 0. Prove that (an) converges to a if and only if for each
ε > 0 there exists a positive integer N, depending on ε, such that
|a −an| ≤c ε for all n ≥N.
.3
Prove that if a sequence (an) converges to a limit, then it is bounded,
in the sense that there exists c > 0 such that |an| ≤c for all n.
.4
Let r ∈R, and let (an) be a convergent sequence in R such that
limn→∞an > r. Prove that an > r for all suﬃciently large n.
.5
Let r ∈R, and let (an) be a convergent sequence in R such that
an ≥r for all suﬃciently large n. Prove that limn→∞an ≥r.
.6
Prove that if (an) diverges to inﬁnity and (bn) converges to a limit
b ∈R, then the sequence (an + bn) diverges to inﬁnity.
The process of taking limits of sequences preserves the basic operations
of arithmetic.
(1.2.2) Proposition.
Let (an) and (bn) be sequences of real numbers
converging to limits a and b, respectively. Then as n →∞,
an + bn →a + b,
an −bn →a −b,
anbn →ab,
max {an, bn} →max {a, b} ,
min {an, bn} →min {a, b} , and
|an| →|a| .
If also b ̸= 0, then bn ̸= 0 for all suﬃciently large n, and an/bn →a/b as
n →∞.
Proof.
We prove only the last statement, leaving the other cases to
Exercise (1.2.3: 1).
Assume that b ̸= 0. Then, by Exercise (1.2.1: 4), there exists N0 such that
|bn| > 1
2 |b| , and therefore an/bn is deﬁned, for all n ≥N0. Given ε > 0,
choose N ≥N0 such that |an −a| < ε and |bn −b| < ε for all n ≥N. For
all such n we have
    
an
bn
−a
b
    = |ban −abn|
|bn| |b|
≤|b(an −a) + a(b −bn)|
1
2 |b|2
≤2 |b|−2 (|b| |an −a| + |a| |b −bn|)
≤2 |b|−2 (|a| + |b|) ε.

22
1. Analysis on the Real Line
The result now follows from Exercise (1.2.1: 2).
2
(1.2.3) Exercises
.1
Prove the remaining parts of Proposition (1.2.2).
.2
Prove that if k ≥2 and ν ≥1 are integers, then

1 + 1
k
	k−1 > 3
2 and

1 + 1
k
	ν(k−1) > ν.
Hence prove that if 0 ≤|r| < 1, then rn →0 as n →∞. (Given
ε > 0, ﬁrst choose ν such that 1/ν < ε. Then choose k such that
|r|−1 > 1 + k−1.)
.3
Prove that if r > 1, then rn →∞as n →∞.
.4
Prove that if a > 1, then loga n →∞as n →∞.
.5
Prove that if r
= limn→∞an, then r
= limk→∞ank for any
subsequence (ank)∞
k=1 of (an).
.6
Let (an) be a sequence of real numbers such that the subsequences
(a2n)∞
n=1 and (a2n+1)∞
n=1 both converge to the limit l. Prove that (an)
converges to l.
.7
Let (an) be a sequence in R. Prove that if the three subsequences
(a2n), (a2n+1), and (a3n) are convergent, then so is (an).
.8
Give an example of a sequence (an) of real numbers with the following
properties.
(i) (an) is not convergent;
(ii) for each k ≥2 the subsequence (akn)∞
n=1 is convergent.
(Split your deﬁnition of an into two cases—one when n is prime, the
other when n is composite.)
When we apply notions such as bounded above, supremum, and inﬁmum
to a sequence (sn) of real numbers, we are really applying them to the set
{sn : n ≥1} of terms of the sequence. Thus the supremum (respectively,
inﬁmum) of a majorised (respectively, minorised) sequence (sn) is denoted
by supn≥1 sn, or just sup sn (respectively, infn≥1 sn, or just inf sn).
The next result, known as the monotone sequence principle, is a powerful
tool for proving the existence of limits.
(1.2.4) Proposition.
An increasing majorised sequence of real numbers
converges to its least upper bound; a decreasing minorised sequence of real
numbers converges to its greatest lower bound.

1.2 Sequences and Series
23
Proof.
Let (sn) be an increasing majorised sequence of real numbers, and
s its least upper bound. For each ε > 0, since s −ε is not an upper bound
of (sn), there exists N such that sN > s −ε. But (sn) is both increasing
and bounded above by s; so for all n ≥N we have s −ε < sn ≤s and
therefore |s −sn| < ε. Since ε > 0 is arbitrary, it follows that sn →s as
n →∞.
The case of a decreasing minorised sequence is left as an exercise.
2
(1.2.5) Exercises
.1
Prove the second part of the last proposition in two ways.
.2
Prove that an increasing sequence of nonnegative real numbers
diverges to inﬁnity if and only if it is not bounded above.
.3
Let a > 1 and x > 0. Prove that there exists an integer m such
that am ≤x < am+1. (First take x ≥1, and consider the sequence
(an)∞
n=0.)
.4
Discuss the convergence of the sequence (an) deﬁned by an+1 =
√ran, where a1 and r are positive numbers.
.5
Prove that if 0 < a and k ∈N, then limn→∞
n+k√a = 1. (First
consider the case where k = 0 and 0 < a < 1. Apply the monotone
sequence principle to show that the sequence ( n√a)∞
n=1 converges to
a limit l. By considering the subsequence ( 2n√a) , show that
√
l = l.)
.6
Prove that if (an) is a sequence of positive numbers such that
l = lim
n→∞
an+1
an
exists, then limn→∞
n√an = l. By considering the sequence
1, a, ab, a2b, a2b2, a3b2, a3b3, . . . ,
where a, b are distinct positive numbers, show that the converse is
false.
.7
Prove that if n
≥
2, then (n + 1)n
≤
nn+1. Use this to
show that l = limn→∞
n√n exists. By considering the subsequence
 2n√
2n
	∞
n=1 , prove that l = 1. Hence show that if a > 1, then
limn→∞

n−1 loga n
	
= 0.
.8
Prove that the sequence

1 + n−1	n	∞
n=1 is convergent. (An interest-
ing proof of this result, based on the well–known inequality involving
arithmetic and geometric means, is found in [32].)

24
1. Analysis on the Real Line
.9
Let (an) be a sequence of real numbers. If (an) is bounded above,
then its upper limit, or limit superior, is deﬁned to be
lim sup an = inf
n≥1 sup{an, an+1, an+2, . . .}
if the inﬁmum on the right exists. Prove that a real number s equals
lim sup an if and only if for each ε > 0,
— an < s + ε for all suﬃciently large n, and
— an > s −ε for inﬁnitely many values of n.
Prove also that
lim sup an = lim
n→∞sup{an, an+1, an+2, . . .}.
.10 If (an) is bounded below, then its lower limit, or limit inferior, is
deﬁned to be
lim inf an = sup
n≥1
inf{an, an+1, an+2, . . .}
if the supremum on the right exists. Establish necessary and suﬃcient
conditions for a real number l to equal lim inf an.
.11 Prove that an →a ∈R as n →∞if and only if
lim inf an = a = lim sup an.
A sequence (Sn)∞
n=1 of subsets of R is said to be nested, or descending,
if S1 ⊃S2 ⊃S3 ⊃· · · . We make good use of the following nested intervals
principle.
(1.2.6) Proposition.
The intersection of a nested sequence of closed
intervals in R is nonempty.
Proof.
Let ([an, bn]) be a nested sequence of closed intervals in R. Then
a1 ≤an ≤an+1 ≤bn+1 ≤bn ≤b1
(1)
for each n. By Proposition (1.2.4), (an) converges to its least upper bound
a, and (bn) converges to its greatest lower bound b. It follows from the
inequalities (1) and Exercise (1.2.1: 5) that a ≤b. So for each n, an ≤a ≤
b ≤bn and therefore a ∈[an, bn].
2
The following elementary lemma leads to simple proofs of several
important results in analysis.
(1.2.7) Lemma.
If (an) is a sequence of real numbers, then at least one
of the following holds.

1.2 Sequences and Series
25
(i) (an) has a constant subsequence;
(ii) (an) has a strictly increasing subsequence;
(iii) (an) has a strictly decreasing subsequence.
Proof.
Suppose that (an) contains no constant subsequence, and con-
sider the set
S =

n ∈N+ : ∀k ≥n (an ≥ak)

.
If S is bounded, then there exists N such that
∀n ≥N ∃k > n (ak > an) ,
and a simple inductive construction produces positive integers N ≤n1 <
n2 < · · · such that ank+1 > ank for each k. If, on the other hand, S is
unbounded, then we can compute n1 < n2 < · · · such that ank ≥ank+1 for
each k. In that case, since (ank)∞
k=1 contains no constant subsequence, for
each k there exists j > k such that ank > anj ; it is now straightforward to
construct a strictly decreasing subsequence of (ank).
2
(1.2.8) Corollary.
A bounded sequence of real numbers has a convergent
subsequence.
Proof.
This follows from Lemma (1.2.7) and the monotone sequence
principle.
2
A sequence (an) of real numbers is called a Cauchy sequence if for each
ε > 0 there exists a positive integer N, depending on ε, such that |am−an| ≤
ε for all m, n ≥N.
(1.2.9) Exercises
.1
Prove that a convergent sequence of real numbers is a Cauchy
sequence.
.2
Prove that a Cauchy sequence is bounded.
.3
Prove that if a Cauchy sequence (an) has a subsequence that
converges to a limit a ∈R, then (an) converges to a.
.4
Let (an) be a bounded sequence each of whose convergent subse-
quences converges to the same limit. Prove that (an) converges to
that limit. (cf. Exercises (1.2.3: 6 and 7). By Corollary (1.2.8), there
is a subsequence (ank) that converges to a limit l. Suppose that (an)
does not converge to l, and derive a contradiction.)

26
1. Analysis on the Real Line
One of the most important results in convergence theory says that not
only does a Cauchy sequence of real numbers appear to converge, in that
its terms get closer and closer to each other as their indices increase, but
it actually does converge.
A subset S of R is said to be complete if each Cauchy sequence in S
converges to a limit that belongs to S.
(1.2.10) Theorem.
R is complete.
Proof.
Let (an) be a Cauchy sequence in R. Then (an) is bounded,
by Exercise (1.2.9: 2). It follows from Corollary (1.2.8) that (an) has a
convergent subsequence; so (an) converges, by Exercise (1.2.9: 3). 2
(1.2.11) Exercises
.1
Find an alternative proof of the completeness of R. (Given a Cauchy
sequence (an) in R, consider lim inf an.)
.2
Show that if, in the system of axioms for R, the least–upper–
bound principle is replaced by the Axiom of Archimedes (Exercise
(1.1.1: 16)), then the nested intervals principle is equivalent to the
completeness of R. Can you spot where you have used the Axiom of
Archimedes?
.3
Under the conditions of the preceding exercise, show that the least–
upper–bound principle follows from the completeness of R. (Assum-
ing that R is complete, consider a nonempty majorised subset S of
R. Choose s1 ∈S and b1 ∈B, where B is the set of upper bounds
of S. Construct a sequence (sn) in S and a sequence (bn) in B such
that
sn ≤sn+1 ≤bn+1 ≤bn
and
0 ≤bn+1 −sn+1 ≤1
2(bn −sn).
Prove that 0 ≤bn −bm ≤2−n+2(b1 −s1) whenever m ≥n, that (sn)
and (bn) converge to the same limit b, and that b = sup S.)
.4
Prove Cantor’s Theorem: if (an) is a sequence of real numbers, then
in any closed interval of R with positive length there exists a real
number x such that x ̸= an for each n. (For each x ∈R and each
nonempty S ⊂R, deﬁne the distance from x to S to be the real
number
ρ(x, S) = inf{|x −s| : s ∈S}.
First prove the following lemma. If I = [a, b] is a closed interval
with positive length, and J1, J2, J3 are the left, middle, and right
closed thirds of I, then for each real number x either ρ(x, J1) > 0

1.2 Sequences and Series
27
or ρ(x, J3) > 0. Use this lemma to construct an appropriate nested
sequence of closed intervals.
This argument is a reﬁned version of the “diagonal argument” ﬁrst
used by Cantor. An interesting analysis of Cantor’s proof, and of the
misinterpretation of that proof over the years, is found in [19].)
.5
Prove that R\Q is order dense in R.
The study of inﬁnite series, a major part of analysis in the eighteenth
and nineteenth centuries (see [27]), still provides interesting illustrations of
the completeness of R.
Let (an)∞
n=1 be a sequence of real numbers. The real number
sk =
k

n=1
an
is called the kth partial sum of the series ∞
n=1 an. Formally, we deﬁne
the series ∞
n=1 an with nth term an to be the sequence (s1, s2, ...) of its
partial sums. The sum of that series is the limit s of the sequence (sn), if
that limit exists, in which case we say that the series is convergent, or that
it converges to s, and we write
∞

n=1
an = s.
We use analogous notations and deﬁnitions for the series associated with
a family (an)∞
n=ν of real numbers indexed by {n ∈Z : n ≥ν} , where ν is
an integer, and for the series ∞
n=−∞an associated with a family (an)n∈Z
indexed by Z. We commonly write  an for the series ∞
n=ν an, when it
is clear that the indexing of the terms of the series starts with ν.
The completeness of R is used in the justiﬁcation of various tests for the
convergence of inﬁnite series. These tests are useful because they enable us
to prove certain series convergent without ﬁnding explicit values for their
sums. For example, a number of convergence tests easily show that the
series ∞
n=1 n−2 is convergent; but it is considerably harder to show that
the sum of this series is actually π2/6 (Exercise (5.2.12: 7); see also [31]).
We begin with the comparison test.
(1.2.12) Proposition.
If ∞
n=1 bn is a convergent series of nonnegative
terms, and if 0 ≤an ≤bn for each n, then ∞
n=1 an converges.
Proof.
Let b be the sum of the series ∞
n=1 bn. Then for each N we have
N

n=1
an ≤
N+1

n=1
an ≤
N+1

n=1
bn ≤b,

28
1. Analysis on the Real Line
so the partial sums of ∞
n=1 an form an increasing majorised sequence. It
follows from the monotone sequence principle that ∞
n=1 an converges.
2
(1.2.13) Proposition.
If (an) is a decreasing sequence of positive num-
bers converging to 0, then the alternating series ∞
n=1(−1)n+1an converges
(Leibniz’s alternating series test).
Proof.
For each k let
sk =
k

n=1
(−1)n+1an.
Then
s2k+2 −s2k = a2k+1 −a2k+2 ≥0
and
a1 −s2k = (a2 −a3) + ... + (a2k−2 −a2k−1) + a2k ≥0.
So the sequence (s2k)∞
k=1 is increasing and bounded above; whence, by the
monotone sequence principle, it converges to its least upper bound s. Now,
|s −s2m+1| = |s −s2m −a2m+1| ≤|s −s2m| + a2m+1.
Also, both |s −s2m| and a2m+1 converge to 0 as m →∞. It follows that if
ε > 0, then |s −s2m| < ε and |s −s2m+1| < ε for all suﬃciently large m.
Hence ∞
n=1(−1)n+1an converges to s, by Exercise (1.2.3: 6).
2
(1.2.14) Exercises
.1
Prove that if the series  an converges, then limn→∞an = 0. By
considering ∞
n=1 1/√n, or otherwise, show that the converse is false.
.2
Prove the comparison test using the completeness of R, instead of
the least–upper–bound principle.
.3
A series of nonnegative terms is said to diverge if the corresponding
sequence (sn) of partial sums diverges to inﬁnity. Prove the limit
comparison test: If (an) and (bn) are sequences of positive numbers
such that
lim
n→∞
an
bn
= l > 0,
then either  an and  bn both converge or else they both diverge.
.4
Prove that if |r| < 1, then the geometric series ∞
n=0 rn converges
and has sum 1/ (1 −r) . What happens to the series if |r| > 1?
.5
Let b ≥2 be an integer, and x ∈[0, 1]. Show that there exists a
sequence (an) of integers such that

1.2 Sequences and Series
29
(i) 0 ≤an < b for each n, and
(ii) x = ∞
n=1 anb−n.
Show that this sequence (an) is uniquely determined by x unless there
exist k, n ∈N such that x = kb−n, in which case there are exactly
two such sequences.
Conversely, show that if (an) is a sequence of integers satisfying
(i), then ∞
n=1 anb−n converges to a sum x in [0, 1]. (The series
∞
n=1 anb−n is called the b–ary expansion of x, or the expansion of x
relative to the base b. If b = 2, the series is the binary expansion of
x, and if b = 10, it is the decimal expansion.)
.6
Prove that
(i) ∞
n=1 1/np is divergent if p ≤1;
(ii) ∞
n=1(−1)n/n is convergent.
(For (i), ﬁrst prove the divergence of ∞
n=1 1/n by considering the
partial sums 2N
n=1 1/n for N = 1, 2, . . . .)
.7
Prove that the series
1
9 + 1
19 + 1
29 + · · · + 1
89 + 1
90 + 1
91 + · · · + 1
99 +
1
109 +
1
119 + · · · ,
where each term contains the digit 9, diverges; and that the series
1 + 1
2 + 1
3 + · · · + 1
8 + 1
10 + · · · + 1
18 + 1
20 + · · · ,
where no term contains the digit 9, converges. (Thus the divergent
series ∞
n=1 1/n can be turned into a convergent one by weeding out
all the terms that contain the digit 9. For a discussion of this and
related matters, see [3].)
.8
Prove that if p ≥2, then the series ∞
n=1 1/np is convergent.
.9
Prove d’Alembert’s ratio test: let  an be a series of positive terms
such that
l = lim
n→∞
an+1
an
exists; then  an converges if l < 1, and diverges if l > 1. (In the
ﬁrst case, choose r ∈(l, 1) and N such that 0 < an+1 < ran for all
n ≥N.)
Give examples where l = 1 and (i)  an converges, (ii)  an diverges.

30
1. Analysis on the Real Line
.10 Prove that ∞
n=0 1/n! converges and has sum < 3. Show also that
n

k=0
1
k! −
3
2n <

1 + 1
n
	n <
n

k=0
1
k!
for all n ≥3, and hence prove that limn→∞

1 + n−1	n = ∞
n=0 1/n!.
.11 Prove Cauchy’s root test: let  an be a series of positive terms, and
l = lim sup
n√an;
then  an converges if l < 1, and diverges if l > 1.
.12 Discuss the convergence of the series
1
2 + 1
3 + 1
22 + 1
32 + 1
23 + 1
33 + · · · .
What does this series and Exercise (1.2.5: 6) tell you about the relative
strengths of the ratio test and the root test?
.13 Let (an) be a decreasing sequence of nonnegative real numbers, and
for each N let
sN =
N

n=1
an, tN =
N

n=1
2na2n.
Show that
(i) if m ≤2N, then sm ≤tN, and
(ii) if m ≥2N, then sm ≥1
2tN.
Hence prove that ∞
n=1 an converges if and only if ∞
n=1 2na2n
converges.
.14 Use the preceding exercise to show that ∞
n=1 1/np converges if and
only if p > 1 (cf. Exercises (1.2.14: 6 and 8)).
.15 Let (an)∞
n=0 and (bn)∞
n=0 be sequences of real numbers, and for each
N write SN = N
n=0 an. Show that if k > j, then
k

n=j
anbn =
k−1

n=j
Sn(bn −bn+1) + Skbk −Sj−1bj.
Now suppose that
(i) there exists M > 0 such that |Sn| ≤M for all n,
(ii) bn ≥bn+1 for each n, and

1.2 Sequences and Series
31
(iii) limn→∞bn = 0.
Prove that if k > j, then
   
k
n=j anbn
   < 2Mbj, and hence that
∞
n=0 anbn converges. Use this result to give another proof of
Leibniz’s alternating series test.
A series  an of real numbers is said to be absolutely convergent if  |an|
is convergent.
(1.2.15) Proposition.
An absolutely convergent series is convergent.
Proof.
Let  an be absolutely convergent. Since the partial sums of
 |an| form a Cauchy sequence, for each ε > 0 there exists N such that
     
k

n=1
|an| −
j

n=1
|an|
     =
k

n=j
|an| < ε
whenever k > j ≥N. For such j and k we have
     
k

n=1
an −
j

n=1
an
     =
      
k

n=j
an
      
≤
k

n=j
|an| < ε.
Thus the partial sums of  an form a Cauchy sequence; whence  an is
convergent, by the completeness of R.
2
The case p = 1 of Example (1.2.14: 6) shows that the converse of
Proposition (1.2.15) is false.
By a power series we mean a series of the form ∞
n=0 anxn, where the
coeﬃcients an ∈R. Such a series always converges for x = 0, but it may
converge for nonzero values of x. Its radius of convergence is deﬁned to be
sup
!
r ≥0 :
∞

n=0
anxn converges whenever |x| ≤r
"
if this supremum exists, and ∞otherwise; and its interval of convergence
is the largest interval I such that the power series converges for all x ∈I.
It is an immediate consequence of Exercise (1.2.16: 10) that every power
series has both a radius and an interval of convergence.
(1.2.16) Exercises
.1
Find an alternative proof of Proposition (1.2.15).
.2
Prove that the series ∞
n=1 nrn converges absolutely if −1 < r < 1.

32
1. Analysis on the Real Line
.3
Let  an,  bn be convergent series of nonnegative terms, with sums
a, b, respectively, and let
un = a1bn + a2bn−1 + · · · + an−1b2 + anb1.
Prove that
N

n=1
un ≤
 N

n=1
an
  N

n=1
bn

≤
N

n=1
u2n
and hence that  un converges to the sum ab (Cauchy’s theorem on
the multiplication of series). Extend this result to the case where the
terms an may not be nonnegative but  an is absolutely convergent.
(Writing
b
=
∞

n=1
bn,
βk
=
b −
k
n=1
bn,
show that
N

n=1
un = b
N

n=1
an +
N

k=0
akβN−k,
and hence that N
k=0 akβN−k →0 as N →∞.)
.4
Show that
∞
n=1 (−1)n #√n + 1 converges, but that the product (as
in the preceding exercise) of this series with itself does not converge.
.5
Prove that the exponential series
exp(x) =
∞

n=0
xn
n!
converges absolutely for all x ∈R. Then prove that
exp(x + y) = exp(x) exp(y).
.6
Prove that exp(x) = ex, where e = exp(1). (Use Exercise (1.1.4: 5).)
Show that
0 < e −
N

n=0
1
n! <
3
(N + 1)!
for each N, and hence calculate e with an error at most 10−6.
.7
Prove that e is irrational. (Suppose that e
=
p/q, where p
and q are positive integers. Choose N > max {q, 3} , show that
N! ∞
n=N+1 1/n! is an integer, and use the inequality from the
preceding exercise to deduce a contradiction.)

1.2 Sequences and Series
33
.8
Show that
ex = lim
n→∞

1 + x
n
n
for each x ∈R. (First take x > 0. Expand sn = (1 + x/n)n using the
binomial theorem, and use the monotone sequence principle.)
.9
For each n deﬁne
γn = 1 + 1
2 + 1
3 + · · · + 1
n −log n
Show that
e <

1 + 1
n
	n+1 < e1+n−1
for each n, and hence that the sequence (γn) is decreasing and
bounded below. It follows from the monotone sequence principle that
Euler’s constant
γ = lim
n→∞γn
exists. Show that
N

n=1
(−1)n+1
n
= γ2N −γN + log 2
and hence that
N

n=1
(−1)n+1
n
= log 2.
(cf. Exercise (1.2.14: 6).)
.10 Let r > 0. Prove that if ∞
n=0 anxn converges for x = r, then it
converges absolutely whenever |x| < r; and that if this power series
diverges for x = r, then it diverges whenever |x| > r. (For the ﬁrst
part, show that there exists M > 0 such that |anxn| ≤M |x/r|n for
all n.)
.11 Find the radius of convergence and the interval of convergence for
∞
n=0 xn.
.12 Find the radius of convergence and the interval of convergence for
∞
n=0(−1)nxn/n.
.13 Suppose that an ̸= 0 for all n, and that
lim
n→∞
    
an+1
an
    = l.
Show that if l = 0, then ∞
n=0 anxn converges for all x ∈R; and that
if l ̸= 0, then the series has radius of convergence 1/l.

34
1. Analysis on the Real Line
.14 Let (an)∞
n=0 be a bounded sequence of real numbers, and let
l = lim sup
n
|an|.
Show that if l = 0, then ∞
n=0 anxn converges for all x ∈R; and that
if l ̸= 0, then the series has radius of convergence 1/l.
.15 Prove that if ( n
|an|)∞
n=0 is an unbounded sequence, then the power
series ∞
n=0 anxn only converges for x = 0.
.16 Prove that the power series
∞

n=0
anxn,
∞

n=1
nanxn−1, and
∞

n=0
an
n + 1xn+1
have the same radius of convergence. Need they have the same interval
of convergence?
By a rearrangement of an inﬁnite series ∞
n=1 an we mean a series of
the form ∞
n=1 af(n) where f is a permutation of N+ (that is, a one–one
mapping of N+ onto itself). A theorem ﬁrst proved by Riemann shows
that if  an is a convergent, but not absolutely convergent, series of real
numbers, then for each real number s there exists a rearrangement of  an
that converges to s. The second exercise in the next set leads you through
a proof of this remarkable result.
(1.2.17) Exercises
.1
Prove that if  an is absolutely convergent, with sum s, then any
rearrangement of  an converges to s. (Given a permutation f of N+
and a positive number ε, choose N such that ∞
n=N+1 |an| < ε. Then
choose M ≥N such that {1, 2, . . . , N} ⊂{f(1), f(2), . . . , f(M)} .
Show that
  m
n=1 af(n) −s
  < 2ε for all m ≥M.)
.2
Let ∞
n=1 an be an inﬁnite series of real numbers that converges but is
not absolutely convergent. For each n deﬁne a+
n = max {an, 0} , a−
n =
min {an, 0} . Prove that the partial sums of the series ∞
n=1 a+
n and
∞
n=1 a−
n form increasing unbounded sequences. Now let s be any real
number. Let n0 and m0 both equal 0, and let n1 be the least positive
integer such that
a+
1 + a+
2 + · · · + a+
n1 > s.
Show how to construct strictly increasing sequences (nk)∞
k=0 and
(mk)∞
k=0 of positive integers such that for each N ≥0,
N−1

k=0

a+
nk+1 + · · · + a+
nk+1

+

a−
mk+1 + · · · + a−
mk+1

< s

1.3 Open and Closed Subsets of the Line
35
and
N−1
k=0

a+
nk+1 + · · · + a+
nk+1

+

a−
mk+1 + · · · + a−
mk+1

+

a+
nN+1 + · · · + a+
nN+1

> s.
Hence obtain a rearrangement of ∞
n=1 an that converges to s.
.3
Let s be the sum of the series ∞
n=1(−1)n−1/n. Show that the series
1 −1
2 −1
4 + 1
3 −1
6 −1
8 + 1
5 −1
10 −1
12 + · · ·
converges to 1
2 log 2.
1.3
Open and Closed Subsets of the Line
In this section we introduce the fundamental topological notions of “open
set” and “closed set” in R, notions that readily generalise in later, more
abstract contexts.
A subset A of R is said to be open (in R) if to each x ∈A there
corresponds r > 0 such that the open interval (x −r, x + r) is contained in
A —or, equivalently, such that y ∈A whenever |x −y| < r.
(1.3.1) Exercises
.1
Prove that R itself, the empty set ∅, and all open intervals are open
subsets of R.
.2
Give an example of a sequence of open subsets of R whose intersection
is not open.
The ﬁrst result in this section describes the two fundamental properties
of open sets.
(1.3.2) Proposition.
The union of any family of open sets is open. The
intersection of any ﬁnite family of open sets is open.
Proof.
Let (Ai)i∈I be any family of open sets. If x belongs to the union
U of this family, then x ∈Ai for some i. As Ai is open, there exists r > 0
such that
(x −r, x + r) ⊂Ai ⊂U.
Hence U is open.

36
1. Analysis on the Real Line
Now let A1, . . . , An be ﬁnitely many open sets, and consider any x in
their intersection. For each i, since x ∈Ai and Ai is open, there exists
ri > 0 such that y ∈Ai whenever |x −y| < ri. Let
r = min{r1, . . . , rn} > 0.
If |x −y| < r, then y ∈Ai for each i, so y ∈n
i=1 Ai. Hence n
i=1 Ai is
open.
2
In view of Exercise (1.3.1: 2), we cannot drop the word “ﬁnite” from the
hypothesis of the second part of Proposition (1.3.2).
Our next aim is to characterise open sets in R; to achieve this, we ﬁrst
characterise intervals.
A nonempty subset S of R is said to have the intermediate value property
if (a, b) ⊂S whenever a ∈S, b ∈S, and a < b. Of course, as we show in
Section 4, this notion is connected with the Intermediate Value Theorem
of elementary calculus.
(1.3.3) Proposition.
A subset S of R has the intermediate value
property if and only if it is an interval.
Proof.
It is clear that every interval in R has the intermediate value
property. Conversely, suppose that S ⊂R has that property. Assume, to
begin with, that S is bounded, and let a be its inﬁmum and b its supremum.
Note that x /∈S if either x < a or x > b. If a and b both belong to S, then
by the intermediate value property, so does every point of [a, b]; whence
S = [a, b]. If a ∈S and b /∈S, consider any x such that a ≤x < b. By
the deﬁnition of “supremum”, there exists s ∈S such that a ≤x < s; the
intermediate value property now ensures that x ∈S; whence S = [a, b).
Similarly, if a /∈S and b ∈S, then S = (a, b]. The remaining cases are left
as exercises.
2
(1.3.4) Exercises
.1
Prove that a nonempty open subset of R with the intermediate value
property is an open interval.
.2
Complete the proof of Proposition (1.3.3) in the remaining cases.
.3
Let I, J be open intervals with nonempty intersection. Prove that
I ∪J and I ∩J are open intervals.
(1.3.5) Lemma.
A nonempty family of pairwise–disjoint open intervals
of R is countable.
Proof.
Let F be a nonempty family of pairwise–disjoint open intervals
in R, and note that, by Exercise (1.1.1: 19), each of these intervals contains

1.3 Open and Closed Subsets of the Line
37
a rational number. The Axiom of Choice (see Appendix B) ensures that
there is a function f : F →Q such that f(I) ∈I for each I ∈F. Since the
sets in F are pairwise disjoint, f is one–one and so has an inverse function
g mapping f(F) onto F. As Q is countable and f(F) ⊂Q, there exists a
mapping h of N+ onto f(F); the composite function g ◦h then maps N+
onto F, which is therefore countable.
2
(1.3.6) Proposition.
A nonempty subset of R is open if and only if it
is the union of a sequence of pairwise–disjoint open intervals.
Proof.
It follows from Proposition (1.3.2) and Exercise (1.3.1: 1) that the
union of any family of open intervals is an open set. Conversely, given a
nonempty open subset S of R, deﬁne a binary relation ∼on S by setting
x ∼y if and only if there exists an open interval I ⊂S such that x, y ∈
I. Then ∼is an equivalence relation: it is straightforward to prove the
reﬂexivity and symmetry of ∼, and its transitivity follows from Exercise
(1.3.4: 3). Clearly, the equivalence class ˙x of x under ∼is a union of open
intervals and is therefore an open set. Consider points y, z ∈˙x and a real
number t with y < t < z. Choosing open intervals Iy, Iz ⊂S such that
x, y ∈Iy and x, z ∈Iz, we see from Exercise (1.3.4: 3) that Iy ∪Iz is an
open interval; so t ∈(y, z) ⊂Iy ∪Iz, and therefore either x, t ∈Iy ⊂S or
else x, t ∈Iz ⊂S. Hence ˙x has the intermediate value property. It follows
from Exercise (1.3.4: 1) that ˙x is an open interval. Since any two distinct
equivalence classes under ∼are disjoint, we now see that
S =

x∈S
˙x
is a union of pairwise–disjoint open intervals. Reference to Lemma (1.3.5)
completes the proof.
2
A real number x is an interior point of a set S ⊂R if there exists r > 0
such that (x −r, x + r) ⊂S. The set of all interior points of S is called the
interior of S, and is written S◦. By a neighbourhood of x we mean a set
containing x in its interior.
(1.3.7) Exercises
.1
Let S be a nonempty open subset of R, and for each x ∈S consider
the sets
Ux = {t ∈R : (x, t) ⊂S} ,
Lx = {s ∈R : (s, x) ⊂S} .
Let a = inf Lx, b = sup Ux, and Ix = (a, b), where a = −∞if Lx
is not bounded below, and b = ∞if Ux is not bounded above. Give
another proof of Proposition (1.3.6) by showing that (Ix)x∈S is a
family of disjoint open intervals whose union is S.

38
1. Analysis on the Real Line
.2
Prove that the interior of an open, closed, or half open interval with
endpoints a and b, where a < b, is the open interval (a, b).
.3
Show that (S◦)◦= S◦.
.4
Prove that S◦is the largest open set contained in S —in other words,
that
(i) S◦is open and S◦⊂S;
(ii) if A is open and A ⊂S, then A ⊂S◦.
.5
Prove that S is open if and only if S ⊂S◦.
.6
Prove that S◦is the union of the open sets contained in S.
.7
Prove that
(i) if S ⊂T, then S◦⊂T ◦;
(ii) (S ∩T)◦= S◦∩T ◦.
.8
Prove that U is a neighbourhood of x ∈R if and only if there is an
open set A such that x ∈A ⊂U.
Let x be a real number, and S a subset of R. We call x a cluster point
of S if each neighbourhood of x has a nonempty intersection with S; or,
equivalently, if for each ε > 0 there exists y ∈S such that |x −y| < ε. The
closure of S (in R) is the set of all cluster points of S, and is denoted by
S or S−. S is said to be closed if S = S.
(1.3.8) Exercises
.1
Is Q closed in R? Is it open in R?
.2
Show that the closure of any interval with endpoints a and b, where
a < b, is the closed interval [a, b].
.3
Show that

S
	
= S.
.4
Prove that S is the smallest closed set containing S —in other words,
that
(i) S is closed and S ⊂S;
(ii) if A is closed and S ⊂A, then S ⊂A.
.5
Prove that S is closed if and only if S ⊂S.
.6
Prove that S is the intersection of the closed sets containing S.

1.3 Open and Closed Subsets of the Line
39
.7
Prove the following.
(i) If S ⊂T, then S ⊂T;
(ii) S ∪T = S ∪T.
.8
Prove that
(i) the complement of S◦is the closure of R\S;
(ii) the complement of S is the interior of R\S.
.9
The boundary, or frontier, of a set S ⊂R is the intersection of the
closures of S and R\S. Describe the boundary of each of the following
sets: R, ∅, (a, b] (where a < b), Q.
.10 Prove that a belongs to the boundary of S\{a} if and only if a ∈
S\{a}.
.11 Let C be the Cantor set—that is, the subset of [0, 1] consisting of all
numbers that have a ternary (base 3) expansion ∞
n=1 an3−n with
an ∈{0, 2} for each n. Prove that
(i) if a, b are two numbers in C that diﬀer in their mth ternary
places, then |a −b| ≥3−m;
(ii) C is a closed subset of R;
(iii) C has an empty interior.
What is the boundary of C?
(1.3.9) Proposition.
S is closed if and only if R\S is open.
Proof.
Suppose that S is closed, and consider any x ∈R\S. Since S = S,
x is not a cluster point of S; so there exists a neighbourhood U of x that
is disjoint from S. By Exercise (1.3.7: 8), there is an open set A such that
x ∈A ⊂U. Then A ∩S = ∅, so A ⊂R\S; whence, by Exercise (1.3.7: 8),
R\S is a neighbourhood of x, and therefore x ∈(R\S)◦. Since x is any
element of R\S, we conclude that R\S is open.
Conversely, suppose that R\S is open. Then by Exercise (1.3.7: 8), R\S
is a neighbourhood of each of its points. Since R\S is disjoint from S, it
follows that no point of R\S is in the closure of S. Thus if x ∈S, then
x /∈R\S and so x ∈S. Hence S ⊂S, and therefore, by Exercise (1.3.8: 5),
S is closed.
2
(1.3.10) Proposition.
The intersection of a family of closed sets is
closed. The union of a ﬁnite family of closed sets is closed.

40
1. Analysis on the Real Line
Proof.
Let (Ci)i∈I be any family of closed sets, and for each i let Ai be
the complement of Ci. Then

i∈I
Ci = R\(

i∈I
Ai).
Since, by Proposition (1.3.9), each Ai is open, Proposition (1.3.2) shows
that 
i∈I Ai is open; whence, again by Proposition (1.3.9), its complement
is closed. This completes the ﬁrst part of the proof; the second is left as an
exercise.
2
(1.3.11) Exercises
.1
Complete the proof of Proposition (1.3.10).
.2
Give an example of a sequence of closed sets whose union is not
closed.
Which subsets of R are both open and closed? Before answering this
question, we prove a simple lemma.
(1.3.12) Lemma.
If T is a nonempty open subset of R that is bounded
above (respectively, below), then sup T /∈T (respectively, inf T /∈T).
Proof.
Consider, for example, the case where T is bounded above. Sup-
pose that M = sup T belongs to T. Since T is open, (M −r, M + r) ⊂T
for some r > 0. Hence M + 1
2r ∈T, which is absurd as M + 1
2r > sup T.
Hence, in fact, M /∈T.
2
(1.3.13) Proposition.
R and ∅are the only subsets of R that are both
open and closed in R.
Proof.
Exercise (1.3.1: 1) and Proposition (1.3.9) show that R and ∅are
both open and closed in R. Let S be a nonempty set that is both open and
closed, and note that, by Proposition (1.3.9), R\S is also both open and
closed. Suppose R\S is nonempty. Choosing a ∈S and b ∈R\S, we have
either a < b or a > b. Without loss of generality we take the former case,
so that
T = {x ∈R\S : x > a}
is nonempty and bounded below. By Proposition (1.3.2), T is also open,
being the intersection of the open sets (a, ∞) and R\S. Let m = inf T.
Since S is open, there exists r > 0 such that (a −r, a + r) ⊂S; whence
m ≥a + r > a. Since, by Lemma (1.3.12), m /∈T, it follows that m /∈R\S
and therefore that m ∈S. But S is open, so there exists ε > 0 such that
(m −ε, m + ε) ⊂S; this is impossible, since the deﬁnition of “inﬁmum”
ensures that there exists t ∈R\S such that t < m + ε. This contradiction
shows that R\S is empty; whence S = R.
2

1.4 Limits and Continuity
41
1.4
Limits and Continuity
Let I be an interval in R, a a point of the closure of I, and f a real–valued
function whose domain includes I but not necessarily a. A real number l is
called the limit of f(x) as x tends to a in I, or the limit of f at a (relative
to I), if to each ε > 0 there corresponds δ > 0 such that |f(x) −l| < ε
whenever x ∈I and 0 < |x −a| < δ. We then write
f(x) →l as x →a, x ∈I
or
lim
x→a, x∈I f(x) = l
and we say that f(x) tends to l as x tends to a through values in I.
The following are the most important cases of this deﬁnition.
• a ∈I◦: in this case we use the simpler notations
f(x) →l as x →a
and
lim
x→a f(x) = l.
• I = (c, a) for some c < a (where c could be −∞): in this case we call l
the left–hand limit of f as x tends to a; we say that f(x) tends to l as
x tends to a from the left (or from below); and we use the notations
f(x) →l as x →a−
and
f(a−) = lim
x→a−f(x) = l.
• I = (a, b) for some b > a (where b could be ∞): in this case we call
l the right–hand limit of f as x tends to a; we say that f(x) tends
to l as x tends to a from the right (or from above); and we use the
notations
f(x) →l as x →a+
and
f(a+) = lim
x→a+ f(x) = l.
We stress that although, in our deﬁnition of “limit”, f(x) is deﬁned for
all x in I that are distinct from but suﬃciently close to a, f(a) need not
be deﬁned. For example, in elementary calculus courses we learn that
lim
x→0
sin x
x
= 1

42
1. Analysis on the Real Line
even though (sin x) /x is not deﬁned at x = 0.
(1.4.1) Proposition.
If limx→a, x∈I f(x) = l and limx→a, x∈I f(x) = l′,
then l = l′.
Proof.
Given ε > 0, choose δf, δg > 0 such that
— if x ∈I and 0 < |x −a| < δf, then |f(x) −l| < ε/2, and
— if x ∈I and 0 < |x −a| < δg, then |f(x) −l′| < ε/2.
Setting δ = min {δf, δg} , consider any x ∈I such that 0 < |x −a| < δ. We
have
|l −l′| ≤|f(x) −l| + |f(x) −l′| < ε
2 + ε
2 = ε.
Since ε > 0 is arbitrary, it follows from Exercise (1.1.2: 4) that l = l′.
2
(1.4.2) Proposition.
If limx→a, x∈I f(x) = l and limx→a, x∈I g(x) = m,
then as x →a through values in I,
f(x) + g(x) →l + m,
f(x) −g(x) →l −m,
f(x)g(x) →lm,
max {f(x), g(x)} →max{l, m},
min {f(x), g(x)} →min{l, m},
|f(x)| →|l| .
If also m ̸= 0, then
lim
x→a, x∈I
f(x)
g(x) = l
m.
Proof.
See Exercise (1.4.3: 3).
2
(1.4.3) Exercises
.1
Deﬁne precisely what it means to say that f(x) does not converge to
any limit as x tends to a through values in I. In other words, give the
formal negation of the deﬁnition of “convergent”.
.2
Let the function f be deﬁned in an interval whose interior con-
tains a. Prove that limx→a f(x) = l if and only if limx→a+ f(x) and
limx→a−f(x) exist and equal l.
.3
Prove Proposition (1.4.2).
.4
Use the deﬁnition of “limit” to prove that limx→a, x∈R p(x) = p(a)
for any polynomial function p and any a ∈R.

1.4 Limits and Continuity
43
.5
Let p, q be polynomial functions, and a a real number such that q(a) ̸=
0. Prove that
lim
x→a, x∈R
p(x)
q(x) = p(a)
q(a).
.6
Prove that limx→a, x∈I f(x) = l if and only if for each sequence (an)
of elements of I that converges to a, the sequence (f(an)) converges
to l. (For “only if”, use a proof by contradiction.)
.7
Suppose that limx→a, x∈I f(x) > r. Prove that there exists δ > 0 such
that if x ∈I and 0 < |x −a| < δ, then f(x) > r.
.8
Let f be a real–valued function whose domain includes an interval
of the form (s, ∞), and let l ∈R. We say that f(x) tends to l as
x tends to ∞if to each ε > 0 there corresponds K > 0 such that
|f(x) −l| < ε whenever x > K; we then write
f(x) →l as x →∞
or
lim
x→∞f(x) = l.
Convince yourself that analogues of Propositions (1.4.1) and (1.4.2)
hold for limits as x tends to ∞.
Deﬁne the notion f(x) tends to l as x tends to −∞, written
f(x) →l as x →−∞
or
lim
x→−∞f(x) = l,
and convince yourself that analogues of Propositions (1.4.1) and
(1.4.2) hold for this notion also.
.9
Formulate deﬁnitions of the following notions, where I is an interval.
(i) f(x) →∞as x →a through values in I.
(ii) f(x) →−∞as x →a through values in I.
(iii) f(x) →∞as x →∞.
(iv) f(x) →∞as x →−∞.
(v) f(x) →−∞as x →∞.
(vi) f(x) →−∞as x →−∞.
.10 Prove that if a > 1, then ax →0 as x →−∞, and ax →∞as
x →∞. What happens to ax as x →±∞when 0 < a < 1? (Note
Exercise (1.2.3: 3).)

44
1. Analysis on the Real Line
.11 Prove that if a > 1, then loga x →0 as x →−∞, and loga x →∞as
x →∞. What happens to loga x as x →±∞if 0 < a < 1?
.12 Let f be a real–valued function, and, where appropriate, deﬁne
limx→ξ sup f(x)
=
infr>0 sup {f(x) : 0 < |x −ξ| < r} ,
limx→ξ+ sup f(x)
=
infr>0 sup {f(x) : 0 < x −ξ < r} ,
limx→ξ−sup f(x)
=
infr>0 sup {f(x) : 0 < ξ −x < r} .
For example, in order that limx→ξ−sup f(x) be deﬁned, it is necessary
that f be deﬁned and bounded4 on some interval of the form (ξ−r, ξ),
where r > 0. Prove the following.
(a) limx→ξ sup f(x) ≤M if and only if for each ε > 0 there exists
δ > 0 such that f(x) < M + ε whenever 0 < |x −ξ| < δ.
(b) limx→ξ sup f(x) ≥M if and only if for each pair of positive
numbers ε, δ there exists x such that 0 < |x −ξ| < δ and f(x) >
M −ε.
Formulate appropriate deﬁnitions of the quantities limx→ξ inf f(x),
limx→ξ+ inf f(x), and limx→ξ−inf f(x). Prove that
(c) limx→ξ inf f(x) ≤limx→ξ sup f(x), and these two numbers are
equal if and only if l = limx→ξ f(x) exists, in which case the
numbers equal l.
An important special case of the notion of a limit occurs when the
function f is deﬁned at the point a that we are approaching.
A function f deﬁned in some neighbourhood of a is said to be continuous
at a if f(x) →f(a) as x →a; in other words, if for each ε > 0 there exists
δ > 0 such that |f(x) −f(a)| < ε whenever |x −a| < δ. We also say that
f is
• continuous on the left at a if f is deﬁned on the interval (a−r, a] for
some r > 0 and
f(a−) = lim
x→a−f(x) = f(a);
• continuous on the right at a if f is deﬁned on the interval [a, a + r)
for some r > 0 and
f(a+) = lim
x→a+ f(x) = f(a);
4By allowing the lim sup quantities to take the values ±∞, in a sense that is
made precise in Section 3.1, we can remove the restriction that f be bounded
near ξ.

1.4 Limits and Continuity
45
• continuous on the interval I if limx→t, x∈I f(x) = f(t) for each t ∈I.
Note that the last deﬁnition takes care of the one–sided continuity of f at
those endpoints of I, if any, that belong to I.
If f is deﬁned in a neighbourhood of a but is not continuous at a, we say
that f has a discontinuity, or is discontinuous, at a.
(1.4.4) Proposition.
Let the real–valued functions f and g be continu-
ous at a. Then f +g, f −g, fg, max {f, g} , min {f, g} , and |f| are contin-
uous at a. If also g(x) ̸= 0 for all x in some neighbourhood of a, then f/g
is continuous at a.
Proof.
This is a simple consequence of Proposition (1.4.2).
2
(1.4.5) Exercises
.1
Let f be deﬁned on a neighbourhood of a. Prove that f is continuous
at a if and only if it is continuous on both the left and the right at a.
.2
Give the details of the proof of Proposition (1.4.4). Extend this result
to deal with continuity on an interval I.
.3
Prove that a polynomial function is continuous on R.
.4
Let p, q be polynomial functions, and a a real number such that q(a) ̸=
0. Prove that the rational function p/q is continuous at a.
.5
Let f be continuous at a, and let g be continuous at f(a). Prove that
the composite function g ◦f is continuous at a.
.6
Prove that f is continuous at the point a ∈R if and only if f is
sequentially continuous at a, in the sense that f(an) →f(a) whenever
(an) is a sequence of points of the domain of f that converges to a.
.7
Let f be deﬁned in an interval (a −r, a + r) where r > 0. The
oscillation of f at a is
ω(f, a) = lim
δ→0 sup {f(x) −f(y) : x, y ∈(a −δ, a + δ)} .
Prove that f is continuous at a if and only if ω(f, a) = 0.
.8
Let f be an increasing function on [a, b]. Prove that f(ξ−) exists for
each ξ ∈(a, b], and that f(ξ+) exists for each ξ ∈[a, b). By considering
the sets

x ∈(a, b) :
  f(x+) −f(x−)
  > 1
n

,
with n a positive integer, prove that the set of points of [a, b] at which
f has a discontinuity is either empty or countable.

46
1. Analysis on the Real Line
.9
Let q0, q1, . . . be a one–one enumeration of Q ∩[0, 1], and for each
x ∈[0, 1] deﬁne
T(x) = {n ∈N : qn ≤x} .
Deﬁne a mapping f : [0, 1] →R by
f(x) =



0
if x = 0

n∈T (x) 2−n
if 0 < x ≤1.
Prove that
(i) f is strictly increasing,
(ii) f is continuous at each irrational point of [0, 1], and
(iii) f is discontinuous at each rational point of [0, 1].
.10 Let (fn)∞
n=1 be a sequence of functions on an interval I, and suppose
that there exists a convergent series ∞
n=1 Mn of nonnegative terms
such that |fn(x)| ≤Mn for each x ∈I and each n. Prove that for
each ε > 0 there exists N such that 0 ≤k
n=j+1 |fn(x)| < ε whenever
k > j ≥N and x ∈I. Hence prove that f(x) = ∞
n=1 fn(x) deﬁnes
a function on I (Weierstrass’s M–test). Prove also that if each fn is
continuous on I, then so is f.
.11 Give two proofs that exp is a continuous function on R.
.12 Prove that if a > 0, then the function x →ax is continuous on R.
(Note that ax = exp(x log a).)
.13 Prove that if a > 0, then the function x →loga x is continuous on R.
(First take the case a > 1. Given x > 0 and ε > 0, choose a positive
integer n > 1/ε, and then δ ∈(0, x) such that (x + δ) /x < a1/n and
(x −δ) /x > a−1/n.)
.14 Prove that the functions sin and cos, deﬁned by
sin x
=
∞

n=0
(−1)nx2n+1
(2n + 1)! ,
cos x
=
∞

n=0
(−1)nx2n
(2n)!
are (well deﬁned and) continuous on R.
.15 Let I be the interval of convergence of the power series f(x) =
∞
n=0 anxn. Prove that f is continuous on I.
.16 Prove that if ∞
n=0 an is a convergent series, then

1.4 Limits and Continuity
47
(i) ∞
n=0 anxn converges for all x ∈(−1, 1), and
(ii) for each ε > 0 there exists δ ∈(0, 1) such that if 1 −σ < x < 1,
then
     
∞

n=0
an −
∞

n=0
anxn
     < ε.
Thus limx→1−∞
n=0 anxn = ∞
n=0 an (Abel’s Limit Theorem). (For
(ii), note that
     
∞

n=0
an −
∞

n=0
anxn
     ≤
     
N

n=0
an(1 −xn)
     
+
     
∞

n=N+1
an
     +
     
∞

n=N+1
anxn
     
for each N. Use Exercise (1.2.14: 15) to handle the last term on the
right.)
.17 Let ∞
n=0 an, ∞
n=0 bn be convergent series with sums a, b, respec-
tively, and let
un = a1bn + a2bn−1 + · · · + an−1b2 + anb1.
Prove that if ∞
n=0 un converges, then its sum is ab. (For −1 < x ≤1
set f(x) = ∞
n=0 anxn and g(x) = ∞
n=0 bnxn. Then use Exercises
(1.2.16: 10), (1.2.16: 3), and (1.4.5: 16).)
This is the full form of Cauchy’s theorem on the multiplication of
series, and should be compared with Exercise (1.2.16: 3).
Deeper results about continuity—indeed, many results in real–variable
theory—depend on two fundamental properties of the real line, described
in our next two theorems.
By a cover of a subset S of R we mean a family U of subsets of R such
that S ⊂ U; we then say that S is covered by U and that U covers S. If
also each U ∈U is an open subset of R, we refer to U as an open cover of
S (in R). By a subcover of a cover U of S we mean a family F ⊂U that
covers S; if also F is a ﬁnite family, then it is called a ﬁnite subcover of U.
Although there exist shorter proofs of the next theorem (see the next set
of exercises), the one we present is adapted to prove a more general result
(Theorem (3.3.9)) in Chapter 3.
(1.4.6) The Heine–Borel–Lebesgue Theorem.
Every open cover of
a compact interval I in R contains a ﬁnite subcover of I.

48
1. Analysis on the Real Line
Proof.
Suppose there exists an open cover U of I that contains no ﬁnite
subcover of I. Either the closed right half of I or the closed left half (or
both) cannot be covered by a ﬁnite subfamily of U: otherwise each half, and
therefore I itself, would be covered by a ﬁnite subfamily. Let I1 be a closed
half of I that is not covered by a ﬁnite subfamily of U. In turn, at least
one closed half, say I2, of I1 cannot be covered by a ﬁnite subfamily of U.
Carrying on in this way, we construct a nested sequence I ⊃I1 ⊃I2 ⊃· · ·
of closed subintervals of I such that for each n,
(a) |In| = 2−n |I| and
(b) no ﬁnite subfamily of U covers In.
By the nested intervals principle (1.2.6), there exists a point ξ ∈∞
n=1 In.
Clearly ξ ∈I, so there exists U ∈U such that ξ ∈U. Since U is open, there
exists r > 0 such that if |x −ξ| < r, then x ∈U. Using (a), we can ﬁnd N
such that if x ∈IN, then |x −ξ| < r and therefore x ∈U; thus IN ⊂U.
This contradicts (b).
2
A real number a is called a limit point of a subset S of R if each neigh-
bourhood of a intersects S\{a}; or, equivalently, if for each ε > 0 there
exists x ∈S with 0 < |x −a| < ε. By a limit point of a sequence (an) we
mean a limit point of the set {a1, a2, . . .} of terms of the sequence.
A nonempty subset A of R is said to have the Bolzano–Weierstrass
property if each inﬁnite subset S of A has a limit point belonging to A.
(1.4.7) The Bolzano–Weierstrass Theorem.
Every compact interval
in R has the Bolzano–Weierstrass property.
Proof.
Let I be a compact interval, and S an inﬁnite subset of I. By
Corollary (1.2.8), any inﬁnite sequence of distinct points of S contains a
convergent subsequence; the limit of that subsequence is a limit point of S
in the closed set I.
2
(1.4.8) Exercises
.1
Let X be a subset of R with the Bolzano–Weierstrass property, and
let (xn) be a sequence of points in X. Show that there exists a
subsequence of (xn) that converges to a limit in X. (Note Lemma
(1.2.7).)
.2
Fill in the details of the following alternative proof of the Heine–
Borel–Lebesgue Theorem. Let U be an open cover of the compact
interval I = [a, b], and deﬁne
A = {x ∈I : [a, x] is covered by ﬁnitely many elements of U} .
Then A is nonempty (it contains a) and is bounded above; let ξ =
sup A. Suppose that ξ ̸= b, and derive a contradiction.

1.4 Limits and Continuity
49
.3
Fill in the details of the following alternative proof of the Bolzano–
Weierstrass Theorem. Suppose the theorem is false; so there exist a
compact interval I and an inﬁnite subset S of I such that no limit
point of S belongs to I. Construct a nested sequence I ⊃I1 ⊃I2 ⊃· · ·
of closed subintervals of I such that for each n,
(a) |In| = 2−n |I|,
(b) S ∩In is an inﬁnite set, and
(c) S ∩In has no limit points in In.
Let ξ ∈∞
n=1 In, and show that ξ is a limit point of S. (This is
one of the commonest proofs of the Bolzano–Weierstrass Theorem in
textbooks.)
.4
Here is a sketch of yet another proof of the Bolzano–Weierstrass The-
orem for you to complete. Let I be a compact interval, and S an
inﬁnite subset of I; then the supremum of the set
A = {x ∈I : S ∩(−∞, x) is ﬁnite or empty}
is a limit point of S in I.
.5
Let S be a subset of R with the Bolzano–Weierstrass property. Prove
that S is closed and bounded. (For boundedness, use a proof by
contradiction.)
.6
Show that the Bolzano–Weierstrass Theorem can be proved as a con-
sequence of the Heine–Borel–Lebesgue Theorem. (Let I be a compact
interval in R, assume the Heine–Borel–Lebesgue Theorem (1.4.6),
and suppose that there exists an inﬁnite subset S of I that has no
limit point in I. First show that for each s ∈S there exists rs > 0
such that S ∩(s −rs, s + rs) = {s}.)
.7
Let f be a real–valued function deﬁned on an interval I. We say that f
is uniformly continuous on I if to each ε > 0 there corresponds δ > 0
such that |f(x) −f(x′)| < ε whenever x, x′ ∈I and |x −x′| < δ.
Show that a uniformly continuous function is continuous. Give an
example of I and f such that f is continuous, but not uniformly
continuous, on I.
.8
Use the Heine–Borel–Lebesgue Theorem to prove the Uniform Con-
tinuity Theorem: a continuous real–valued function f on a compact
interval I ⊂R is uniformly continuous. (For each ε > 0 and each
x ∈I, choose δx > 0 such that if x′ ∈I and |x −x′| < 2δx, then
|f(x) −f(x′)| < ε/2. The intervals (x −δx, x + δx) form an open
cover of I.)

50
1. Analysis on the Real Line
.9
Prove the Uniform Continuity Theorem (see the previous exercise) us-
ing the Bolzano–Weierstrass Theorem. (If f : I →R is not uniformly
continuous, then there exists α > 0 with the following property: for
each n ∈N+ there exist xn, yn ∈I such that |xn −yn| < 1/n and
|f(xn) −f(yn)| ≥α.)
The proof of the following result about boundedness of real–valued
functions illustrates well the application of the Heine–Borel–Lebesgue
Theorem.
(1.4.9) Theorem.
A continuous real–valued function f on a compact
interval I is bounded; moreover, f attains its bounds in the sense that
there exist points ξ, η of I such that f(ξ) = inf f and f(η) = sup f.
Proof.
For each x ∈I choose δx > 0 such that if x′ ∈I and |x −x′| < δx,
then |f(x) −f(x′)| < 1. The intervals (x −δx, x + δx), where x ∈I, form
an open cover of I. By Theorem (1.4.6), there exist ﬁnitely many points
x1, . . . , xN of I such that
I ⊂
N

k=1
(xk −δxk, xk + δxk) .
Let
c = 1 + max {|f(x1)| , . . . , |f(xN)|} ,
and consider any point x ∈I. Choosing k such that x ∈(xk −δxk, xk +δxk),
we have
|f(x)| ≤|f(x) −f(xk)| + |f(xk)|
< 1 + |f(xk)|
≤c,
so f is bounded on I.
Now write
m = inf f,
M = sup f.
Suppose that f(x) ̸= M, and therefore f(x) < M, for all x ∈I. Then
x →1/(M −f(x)) is a continuous mapping of I into R+, by Proposition
(1.4.4), and so, by the ﬁrst part of this proof, has a supremum G > 0. For
each x ∈I we then have M −f(x) ≥1/G and therefore f(x) ≤M −1/G.
This contradicts our choice of M as the supremum of f.
2
(1.4.10) Exercises
.1
Prove both parts of Theorem (1.4.9) using the Bolzano–Weierstrass
Theorem and contradiction arguments.

1.4 Limits and Continuity
51
.2
Let f be a continuous function on R such that f(x) →∞as x →±∞.
Prove that there exists ξ ∈R such that f(x) ≥f(ξ) for all x ∈R.
.3
Let f be a continuous function on R such that f(x) →0 as x →±∞.
Prove that f is both bounded and uniformly continuous.
(1.4.11) The Intermediate Value Theorem.
If f is a continuous
real–valued function on an interval I, then f(I) has the intermediate value
property (page 36).
Proof.
Let a, b be points of I, and y a real number such that f(a) < y <
f(b); without loss of generality assume that a < b. Then
S = {x ∈[a, b] : f(x) < y}
is nonempty (it contains a) and bounded above by b, so ξ = sup S exists.
Note that ξ < b and that (ξ, b] ⊂I. We show that f(ξ) = y. To this
end, suppose ﬁrst that f(ξ) < y. Then, by Exercise (1.4.3: 7), there exists
δ ∈(0, b−ξ) such that if x ∈I and |x −ξ| < δ, then f(x) < y; in particular,
f(x) < y for all x ∈(ξ, ξ + δ), which contradicts the deﬁnition of ξ as the
supremum of S. Thus f(ξ) ≥y.
Now suppose that f(ξ) > y; then ξ > a. By another application of
Exercise (1.4.3: 7), there exists δ′ ∈(0, ξ −a) such that if ξ −δ′ < x < ξ,
then f(x) > y. This is impossible, since, by the deﬁnition of “supremum”,
there exist points x of (a, ξ) arbitrarily close to ξ with f(x) < y. Hence
f(ξ) ≤y, and therefore f(ξ) = y.
2
(1.4.12) Corollary.
Let f be a continuous real–valued function on a
compact interval I, and let m = inf f, M = sup f. Then f(I) = [m, M].
Proof.
Use Theorems (1.4.9) and (1.4.11).
2
(1.4.13) Exercises
.1
Fill in the details of the following common proof of the Interme-
diate Value Theorem. Let f(a) < y < f(b), write a0 = a, b0 =
b, c0 = 1
2(a0 + b0), and assume without loss of generality that a < b.
If f(c0) = y, there is nothing to prove and we stop our construc-
tion. Otherwise, by repeated interval–halving, we construct points
a0, b0, c0, a1, b1, c1, . . . such that
— either f(cn) = 0 for some n and the construction stops,
— or else the construction proceeds ad inﬁnitum, an ≤an+1 ≤
bn+1 ≤bn, f(an) < y, f(bn) > y, cn = 1
2(an + bn), and
0 < bn −an =
 1
2
	n (b −a).

52
1. Analysis on the Real Line
Choosing x ∈∞
n=1[an, bn], we now show that f(x) = 0.
.2
Use the Intermediate Value Theorem to prove that if b > 0 and n is
an odd positive integer, then b has an nth root—that is, there exists
r ∈R such that rn = b. (Of course, this result also follows from our
deﬁnition of ax in Section 1; but it is instructive to see how it can be
derived by other means, such as the Intermediate Value Theorem.)
.3
Show that any polynomial equation
xn + an−1xn−1 + · · · + a1x + a0 = 0
of odd degree n, with coeﬃcients ak ∈R, has at least one real
solution.
.4
What can you say about a function f that is continuous on [0, 1] and
assumes only rational values?
.5
Let f, g be continuous functions on [0, 1] such that f(x) ∈[0, 1] for all
x, g(0) = 0, and g(1) = 1. Show that f(x) = g(x) for some x ∈[0, 1].
.6
Prove that there is no continuous function f : R →R that assumes
each real value exactly twice.
.7
Let f be continuous and one–one on an interval I; then f(I) is an
interval, by Corollary (1.4.12). Prove that
(i) either f is strictly increasing on I or else f is strictly decreasing
on I;
(ii) if a ∈I◦, then f(a) ∈f(I)◦;
(iii) f −1 is continuous on f(I).
(For (iii), show that f is sequentially continuous at each point of
f(I). You will need Corollary (1.2.8), Exercise (1.4.5: 6), and Exercise
(1.2.9: 4).)
Although the Intermediate Value Theorem has many applications, espe-
cially in the solution of equations, none of its proofs provides an algorithm
for constructing the point x with f(x) = y. This claim may come as a
surprise: for is not the interval–halving proof in Exercise (1.4.13: 1) algo-
rithmic? Alas, it is not: for, as any good computer scientist knows, there
is no algorithm that enables us to decide, for given real numbers y and z,
whether y = z or y ̸= z. (For further discussion of these matters, see the
Prolog of [5], and pages 65–66 of [8].)

1.5 Calculus
53
1.5
Calculus
In this section we cover the fundamentals of the diﬀerential and integral
calculus of functions of one real variable. We do so rapidly, leaving many
details to the exercises, on the assumption that you will have seen much of
the material in elementary calculus courses.
Let I be an interval in R, x0 a point of I, and f a real–valued function
whose domain includes I. We say that f is
• diﬀerentiable on the left at x0 if its left-hand derivative at x0,
f ′(x−
0 ) = lim
x→x−
0
f(x) −f(x0)
x −x0
= lim
h→0−
f(x0 + h) −f(x0)
h
,
exists;
• diﬀerentiable on the right at x0 if its right-hand derivative at x0,
f ′(x+
0 ) = lim
x→x+
0
f(x) −f(x0)
x −x0
= lim
h→0+
f(x0 + h) −f(x0)
h
,
exists;
• diﬀerentiable at x0 if x0 is an interior point of I and the derivative of
f at x0,
f ′(x0) = lim
x→x0
f(x) −f(x0)
x −x0
= lim
h→0
f(x0 + h) −f(x0)
h
,
exists.
It follows from Exercise (1.4.3: 2) that f is diﬀerentiable at an interior point
x0 of its domain if and only if f ′(x−
0 ) and f ′(x+
0 ) exist and are equal, in
which case their common value is f ′(x0).
We say that f is diﬀerentiable on the interval I if it is
— diﬀerentiable at each interior point of I,
— diﬀerentiable on the right at the left endpoint of I if that point belongs
to I, and
— diﬀerentiable on the left at the right endpoint of I if that point belongs
to I.
Higher–order derivatives of f are deﬁned inductively, as follows.
f (0) = f,
f (1) = f ′,
f (2) = f ′′ = (f ′)′,
f (3) = f ′′′ = (f ′′)′,
f (n+1) = (f (n))′
(n ≥3).

54
1. Analysis on the Real Line
If the nth derivative f (n)(x) exists, then f is said to be n–times dif-
ferentiable at x; if f (n)(x) exists for each positive integer n, then f is
said to be inﬁnitely diﬀerentiable at x. Deﬁnitions of notions such as nth
right–hand derivative, n–times diﬀerentiable on an interval, and inﬁnitely
diﬀerentiable on an interval are formulated analogously.
(1.5.1) Exercises
.1
Prove that if f is diﬀerentiable at x0, then it is continuous at x0. Give
an example of a function f : R →R such that f ′(0−) and f ′(0+)
both exist but f is not continuous at 0.
.2
For each x ∈R write
ρ(x, Z) = inf {|x −n| : n ∈Z}
and
f(x) =
∞

n=0
ρ(10nx, Z)
10n
.
Prove that f is continuous, but nowhere diﬀerentiable, on R. (For
continuity use Exercise (1.4.5: 10). To show that f is not diﬀeren-
tiable at x, it is enough to take 0 ≤x < 1. Let 0.d1d2 . . . be a deci-
mal expansion of x, the terminating expansion if there is one. Deﬁne
hk to be −10−k if ak = 4 or 9, and 10−k otherwise, and consider
h−1
k
(f(x + hk) −f(x)) .)
This example is due to van der Waerden [54]. Weierstrass, in a lecture
to the Berlin Academy in 1872, gave the ﬁrst example of a continuous,
nowhere diﬀerentiable function: namely,
f(x) =
∞

n=1
an cos(bnπx),
where 0 < a < 1, b is an odd positive integer, and ab > 1 + 3π/2; for
a discussion of a special case of Weierstrass’s example, see [28], pages
38–41.
.3
Prove that if f is diﬀerentiable at x, then
f ′(x) =
lim
h,k→0+
f(x + h) −f(x −k)
h + k
.
Give an example of a function f where limh→0 ((f(h) −f(−h)) /2h)
exists but f is not diﬀerentiable at 0.
.4
Let f(x) = xn, where n is an integer. Using the deﬁnition of
“diﬀerentiable”, prove that f ′(x) = nxn−1 for all x ∈R.

1.5 Calculus
55
.5
Let f and g be diﬀerentiable at a. Prove that f +g, f −g, cf (c ∈R),
and fg are diﬀerentiable at a, and that
(f + g)′(a) = f ′(a) + g′(a),
(f −g)′(a) = f ′(a) −g′(a),
(cf)′ (a) = cf ′(a),
(fg)′(a) = f(a)g′(a) + f ′(a)g(a).
.6
Under the conditions of the last exercise, suppose also that g(a) ̸= 0.
Give two proofs that f/g is diﬀerentiable at a, and that
f
g
′
(a) = f ′(a)g(a) −f(a)g′(a)
g(a)2
.
.7
Using the exponential series, prove that exp′(0) = 1. Hence prove
that exp′(x) = exp(x) for all x ∈R.
Our next proposition, the Chain Rule, is possibly the most troublesome
result of elementary calculus.
(1.5.2) Proposition.
If f is diﬀerentiable at a, and g is diﬀerentiable
at f(a), then g ◦f is diﬀerentiable at a, and
(g ◦f)′ (a) = g′ (f(a)) · f ′(a).
Proof.
Setting b = f(a), deﬁne
h(u) =





g(u) −g(b)
u −b
if u ̸= b
g′(b)
if u = b.
For all x ̸= a in some neighbourhood of a we have
g(f(x)) −g(f(a))
x −a
= (h ◦f) (x) · f(x) −f(a)
x −a
.
(1)
(Note that in verifying this identity, we must consider the possibility that
f(x) = f(a).) Since g is diﬀerentiable at b, h is continuous at b. Moreover,
f is diﬀerentiable, and therefore (by Exercise (1.5.1: 1)) continuous, at a;
so h ◦f is continuous at a, by Exercise (1.4.5: 5). Hence
lim
x→a

(h ◦f) (x) · f(x) −f(a)
x −a

= lim
x→a (h ◦f) (x) · lim
x→a
f(x) −f(a)
x −a
= (h ◦f) (a) · f ′(a)
= g′(b)f ′(a).

56
1. Analysis on the Real Line
The result now follows immediately from (1).
2
(1.5.3) Proposition.
Let I be an open interval, f a one–one continuous
function on I, and a ∈I, such that f ′(a) exists and is nonzero. Then the
inverse function f −1 is diﬀerentiable at f(a), and

f −1	′ (f(a)) =
1
f ′(a).
Proof.
Note that J = f(I) is an interval, by Theorem (1.4.11) and
Proposition (1.3.3); moreover, by Exercise (1.4.13: 7), f(a) is an interior
point of J and f −1 is continuous on J. Let (yn) be any sequence in J\{f(a)}
that converges to f(a), and write xn = f −1(yn); then xn ̸= a and
lim
n→∞f −1(xn) = f −1(f(a)) = a.
Since f is one–one, it follows that
f(xn) −f(a)
xn −a
̸= 0;
whence
lim
n→∞
f −1(yn) −f −1(f(a))
yn −f(a)
= lim
n→∞
xn −a
f(xn) −f(a) =
1
f ′(a).
The desired conclusion now follows from Exercise (1.4.3: 6).
2
(1.5.4) Exercises
.1
Prove that log′(x) = 1/x for each x > 0.
.2
Let f(x) = xr, where r ∈R. Prove that f ′(x) = rxr−1. (Note that
xr = exp(r log x).)
.3
Let f be a strictly increasing function on an interval I, and let a be
a point of I such that f ′(a+) exists and is nonzero. Prove that the
inverse function f −1 is diﬀerentiable on the right at f(a), and that

f −1	′ 
f(a)+	
=
1
f ′(a+).
.4
Let f be continuous on the compact interval I = [a, b] and diﬀer-
entiable on (a, b). Prove that if ξ ∈(a, b) and f(ξ) = inf f, then
f ′(ξ) = 0. Hence prove that if f(a) = f(b), then there exists ξ ∈(a, b)
such that f ′(ξ) = 0 (Rolle’s Theorem).

1.5 Calculus
57
.5
Let f be continuous on the compact interval [a, b] and n–times diﬀer-
entiable on (a, b). Suppose that there exist n + 1 distinct points x of
(a, b) at which f(x) = 0. Show that f (n)(x) = 0 for some x ∈(a, b).
.6
Use Rolle’s Theorem to prove the Mean Value Theorem: if f is con-
tinuous on the compact interval [a, b] and diﬀerentiable on (a, b), then
there exists ξ ∈(a, b) such that f(b) −f(a) = f ′(ξ)(b −a).
.7
Let f be diﬀerentiable on an interval I. Prove that
(i) if f ′(x) ≥0 for all x ∈I, then f is increasing on I;
(ii) if f ′(x) > 0 for all x ∈I, then f is strictly increasing on I;
(iii) if f ′(x) = 0 for all x ∈I, then f is constant on I.
.8
Let f be diﬀerentiable on an interval I, with f ′(x) ̸= 0 for all x ∈I.
Prove that f is one–one, and that either f ′(x) ≥0 for all x ∈I or
else f ′(x) ≤0 for all x ∈I.
.9
Prove that if f is diﬀerentiable on an interval I, then the range of f ′
has the intermediate value property on I. (Let f ′(x1) < y < f ′(x2),
consider g(x) = f(x) −yx, and use the preceding exercise.)
.10 Prove Cauchy’s Mean Value Theorem: if f, g are continuous on [a, b]
and diﬀerentiable on (a, b), then there exists ξ ∈(a, b) such that
(f(b) −f(a)) g′(ξ) = (g(b) −g(a)) f ′(ξ).
(Consider the function x →(f(b) −f(a)) g(x) −(g(b) −g(a)) f(x).)
.11 Let f, g be continuous on [a, b] and diﬀerentiable on (a, b), let x0 ∈
[a, b], and suppose that
(i) g′(x) ̸= 0 for all x ̸= x0,
(ii) f(x0) = g(x0) = 0,
(iii) l = lim
x→x0 (f ′(x) /g′(x)) exists.
Prove that limx→x0 (f(x) /g(x)) = l. (l’Hˆopital’s Rule. Use the pre-
ceding exercise to show that if (xn) is any sequence in [a, b] \ {x0}
that converges to x0, then f(xn)/g(xn) →l as n →∞.)
.12 Let g be twice diﬀerentiable at 0, with g(0) = g′(0) = 0. Find f ′(0),
where f is deﬁned by
f(x) =





g(x)
x
if x ̸= 0,
0
if x = 0.

58
1. Analysis on the Real Line
The following generalisation of the Mean Value Theorem is one of the
most useful results of the diﬀerential calculus. Unfortunately, it seems
to have no completely transparent, natural proof; all the proofs in the
literature use some trick or other to obtain the desired conclusion.
(1.5.5) Taylor’s Theorem.
Let f be (N +1)–times diﬀerentiable on an
interval I, and let a ∈I. Then for each x ∈I there exists ξ between a and
x such that
f(x) =
N

n=0
f (n)(a)
n!
(x −a)n + f (N+1)(ξ)
N!
(x −ξ)N(x −a).
Proof.
Fixing x ∈I, without loss of generality we take a < x. Consider
the function g : [a, x] →R deﬁned by
g(t) = f(x) −
N

n=0
f (n)(t)
n!
(x −t)n.
Using Exercises (1.5.1: 4 and 5), we have
g′(t) = −f ′(t) −
N

n=1
f (n+1)(t)
n!
(x −t)n −f (n)(t)
(n −1)! (x −t)n−1

= −f (N+1)(t)
N!
(x −t)N.
Applying the Mean Value Theorem (Exercise (1.5.4: 6)), we obtain ξ ∈
(a, x) such that
−f (N+1)(ξ)
N!
(x −ξ)N = g′(ξ) = g(x) −g(a)
x −a
.
Then, as g(x) = 0,
g(a) = f (N+1)(ξ)
N!
(x −ξ)N(x −a),
which is equivalent to the desired result.
2
The expression
N

n=0
f (n)(a)
n!
(x −a)n
is called the Taylor polynomial of degree n at a, and
f(x) −
N

n=0
f (n)(a)
n!
(x −a)n

1.5 Calculus
59
is called the remainder term of order n in Taylor’s Theorem. The theorem,
as stated, has the remainder term in the Cauchy form:
f (N+1)(ξ)
N!
(x −ξ)N(x −a).
The next corollary gives us an alternative form—the Lagrange form—of
the remainder.
(1.5.6) Corollary.
Under the hypotheses of Taylor’s Theorem, for each
x ∈I there exists t between a and x such that
f(x) =
N

n=0
f (n)(a)
n!
(x −a)n + f (N+1)(t)
(N + 1)! (x −a)N+1.
Proof.
Again we take a < x and use a trick. With g the function in-
troduced in the preceding proof of Taylor’s Theorem, we apply Cauchy’s
Mean Value Theorem (Exercise (1.5.4: 10)) to g and t →(x −t)N+1. Since
g(x) = 0, this yields t ∈(a, x) such that
g(a)
(x −a)N+1 =
f (N+1)(t)
N!
(x −t)N
(N + 1)(x −t)N .
Hence
g(a) = f (N+1)(t)
(N + 1)! (x −a)N+1,
from which the required conclusion follows.
2
(1.5.7) Proposition.
Let I be the interval of convergence of the power
series ∞
n=0 anxn, and let f(x) be the sum of the series on I. Then f is
diﬀerentiable, and f ′(x) = ∞
n=1 nanxn−1, at each interior point of I.
Proof.
We ﬁrst recall from Exercise (1.2.16: 16) that the power series
∞
n=0 anxn and ∞
n=1 nanxn−1 have the same radius of convergence R.
Given x ∈I◦, let
r = 1
2(|x| + R).
Then ∞
n=1 nanrn−1 converges absolutely, by Exercise (1.2.16: 10). Given
ε > 0, choose N such that ∞
n=N+1 n |an| rn−1 < ε. If h ̸= 0 and |x + h| <
r, then, using the Mean Value Theorem, for each n ≥N + 1 we obtain θn
between 0 and h such that
(x + h)n −xn
h
= n(x + θn)n−1.

60
1. Analysis on the Real Line
Hence
     
∞

n=N+1
an
(x + h)n −xn
h
−nxn−1
     
≤
∞

n=N+1
|an|
    
(x + h)n −xn
h
−nxn−1
    
≤
∞

n=N+1
n |an|
  (x + θn)n−1 −xn−1  
≤
∞

n=N+1
n |an|

|x + θn|n−1 + |x|n−1
≤2
∞

n=N+1
n |an| rn−1
< 2ε.
It follows that
     
f(x + h) −f(x)
h
−
∞

n=1
nanxn−1
     
≤
     
N

n=1
an
(x + h)n −xn
h
−nxn−1
     
+
     
∞

n=N+1
an
(x + h)n −xn
h
−nxn−1
     
<
N

n=1
|an|
    
(x + h)n −xn
h
−nxn−1
    + 2ε.
Now, there exists δ > 0 such that if 0 < |h| < δ, then |x + h| < r and
    
(x + h)n −xn
h
−nxn−1
    <

1 +
N

n=1
|an|
−1
ε
(1 ≤n ≤N).
For such h we then have
     
f(x + h) −f(x)
h
−
∞

n=1
nanxn−1
     < 3ε.
Since ε > 0 is arbitrary, the result follows.
2

1.5 Calculus
61
(1.5.8) Exercises
.1
Let f be inﬁnitely diﬀerentiable on an interval I, and suppose that
there exists M > 0 such that
  f (n)(x)
  ≤M for all suﬃciently large
n and all x ∈I. Given a ∈I, prove that the Taylor expansion, or
Taylor series, of f about a,
∞

n=0
f (n)(a)
n!
(x −a)n,
converges to f(x) for each x ∈I.
.2
Find the Taylor expansion of exp(−x2) about 0. For what values of
x does this expansion converge to exp(−x2)?
.3
Prove that f(x) = exp(x) deﬁnes the unique diﬀerentiable function
such that f(0) = 1 and f ′(x) = f(x) for all x ∈R.
.4
Let R > 0, and let ∞
n=0 anxn, ∞
n=0 bnxn be power series whose
intervals of convergence include (−R, R). Suppose that ∞
n=0 anxn =
∞
n=0 bnxn for all x ∈(−R, R). Show that an = bn for all n.
.5
Prove that sin′ x = cos x and that cos′ x = −sin x for each x ∈R.
(See Exercise (1.4.5: 14) for the deﬁnition of sin and cos .)
.6
Prove the trigonometric addition formulae:
cos(a + b)
=
cos a cos b −sin a sin b,
sin(a + b)
=
sin a cos b + cos a sin b.
(Deﬁne
F(x) = (cos(x + b) −cos x cos b + sin x sin b)2
+ (sin(x + b) −sin x cos b −cos x sin b)2
and consider F ′(x).)
.7
Prove that cos is a strictly decreasing function in the interval [0, 2],
and that there is a unique p such that p/2 ∈[0, 2] and cos (p/2) = 0.
Using the addition formulae from the preceding exercise, prove also
that cos(x + 2p) = cos x and sin(x + 2p) = sin x for all x ∈R. (Of
course, the number p is more usually denoted by π.)
.8
Derive the binomial series
(1 + x)α =
∞

n=0
α
n

xn

62
1. Analysis on the Real Line
for −1 < x < 1, where
α
0
	
= 1 and for n ≥1,
α
n

= α(α −1)(α −2) · · · (α −n + 1)
n!
.
(First show that the series in question does converge for |x| < 1. Then
apply Taylor’s Theorem with the Lagrange form of the remainder
when 0 ≤x < 1, and with the Cauchy form when −1 < x < 0.)
.9
Let p ≥2, 1/p + 1/q = 1, and 0 < c < 1. Prove that
(1 + c)q + (1 −c)q −2 (1 + cp)q−1 ≥0.
(Use the binomial series.)
.10 Let x, y ∈R, and let p, q be positive numbers with 1/p + 1/q = 1.
Use the preceding exercise to prove that
|x + y|q + |x −y|q ≤2 (|x|p + |y|p)q−1
if 1 < p ≤2, and that
|x + y|q + |x −y|q ≥2 (|x|p + |y|p)q−1
if p ≥2.
Although the Riemann integral is taught in elementary calculus courses,
for the best part of a century, following the development of a more sophis-
ticated integral by Lebesgue and others, it has had little practical value.
Indeed, Dieudonn´e, in characteristically forthright mood ([13], page 142),
claims that the Riemann integral “has at best the importance of a mildly
interesting exercise in the general theory of measure and integration. Only
the stubborn conservatism of academic tradition could freeze it into a reg-
ular part of the curriculum, long after it had outlived its historical im-
portance.” We believe, nevertheless, that it is worth presenting a rigorous
development of the Riemann integral for both historical and paedagogical
reasons; but we skip lightly over this material, leaving much of it to the
exercises. We discuss the Lebesgue integral in Chapter 2.
By a partition of a compact interval I = [a, b] we mean a ﬁnite sequence
P = (x0, x1, . . . , xn) of points of I such that
a = x0 ≤x1 ≤· · · ≤xn = b.
The real number
max {xi+1 −xi : 0 ≤i ≤n −1}
is called the mesh of the partition. Loosely, we identify P with the set
{x0, . . . , xn}. A partition Q is called a reﬁnement of P if P ⊂Q.

1.5 Calculus
63
Now let f : I →R a bounded function, and for 0 ≤i ≤n −1 deﬁne
mi(f) = inf {f(x) : xi ≤x ≤xi+1} ,
Mi(f) = sup {f(x) : xi ≤x ≤xi+1} .
The real numbers
L(f, P) =
n−1

i=0
mi(f) (xi+1 −xi) ,
U(f, P) =
n−1

i=0
Mi(f) (xi+1 −xi)
are called the lower sum and upper sum, respectively, for f and P. Since
(b −a) inf f ≤L(f, P) ≤U(f, P) ≤(b −a) sup f,
the lower integral of f,
$ b
a
f = sup {L(f, P) : P is a partition of [a, b]} ,
and the upper integral of f,
$ b
a
f = inf {U(f, P) : P is a partition of [a, b]} ,
exist.
(1.5.9) Lemma.
Let f : [a, b] →R be bounded, and let P, Q be partitions
of [a, b]. Then L(f, P) ≤U(f, Q).
Proof.
Take P = (x0, . . . , xn), and ﬁrst consider the case where Q =
P ∪{ξ} for some point ξ /∈P. Choose k such that xk < ξ < xk+1, and
write
α = inf {f(x) : xk ≤x ≤ξ} ,
β = inf {f(x) : ξ ≤x ≤xk+1} .
Then mk(f) = min {α, b} , so
L(f, P) =
n−1

i=0,
i̸=k
mi(f) (xi+1 −xi) + mk(f)(xk+1 −xk)
=
n−1

i=0,
i̸=k
mi(f) (xi+1 −xi) + mk(f)(ξ −xk) + mk(f)(xk+1 −ξ)

64
1. Analysis on the Real Line
≤
n−1

i=0,
i̸=k
mi(f) (xi+1 −xi) + α(ξ −xk) + β(xk+1 −ξ)
= L(f, Q).
Next, if Q is a reﬁnement of P, then Q = P ∪{ξ1, . . . , ξm} for some distinct
points ξk /∈P, so
L(f, P) ≤L(f, P ∪{ξ1})
≤L(f, P ∪{ξ1, ξ2})
≤· · ·
≤L(f, Q).
Similar arguments show that U(f, Q) ≤U(f, P) when Q is a reﬁnement of
P.
Now consider any two partitions P, Q of [a, b]. Since P ∪Q is a reﬁnement
of both P and Q, we have
L(f, P) ≤L(f, P ∪Q) ≤U(f, P ∪Q) ≤U(f, Q).
2
It follows from this lemma that, as we might have anticipated,
$ b
a
f ≤
$ b
a
f.
We say that f is Riemann integrable over I if its lower and upper integrals
coincide, in which case we deﬁne the Riemann integral of f over I to be
$ b
a
f =
$ b
a
f =
$ b
a
f.
We also deﬁne
$ a
b
f = −
$ b
a
f
when f is Riemann integrable over [a, b] .
(1.5.10) Exercises
.1
Let f : [a, b] →R be bounded. Prove that f is Riemann integrable
if and only if for each ε > 0 there exists a partition P of [a, b] such
that U(f, P) −L(f, P) < ε.
.2
Let f(x) = x2 on [0, 1], and for each positive integer n let Pn be
the partition of [0, 1] consisting of the points i/n (0 ≤i ≤n). By
considering L(f, Pn) and U(f, Pn), show that f is Riemann integrable
and that
% 1
0 f = 1 /3.

1.5 Calculus
65
.3
Prove that for any n ∈N the function x →xn is Riemann integrable
over [a, b]. (Use the ﬁrst exercise in this set.)
.4
Prove that an increasing bounded function f : [a, b] →R is Riemann
integrable.
.5
Prove that a continuous function f : [a, b] →R is Riemann integrable.
(Use the Uniform Continuity Theorem (Exercise (1.4.8: 8)).)
.6
Deﬁne f : [0, 1] →R by
f(x) =



1
if x is rational
0
if x is irrational.
Prove that f is not Riemann integrable.
.7
Deﬁne f : [0, 1] →R by
f(x) =



0
if x = 0 or x is irrational
1
q
if x = p
q for relatively prime positive integers p, q.
Given ε > 0, let t0 = 0; let t1, . . . , tm−1 be, in increasing order, the
points of (0, 1) that have the form p/q where p, q are relatively prime
positive integers with 0 < q < 2/ε; and let tm = 1. Taking x0 = 0,
construct inductively a partition P = (x0, x1, . . . , x2m+1) of [0, 1] such
that
x2k < tk < x2k+1 < 1
2(tk + tk+1),
x2k+1 −x2k <
ε
2(m + 1),
and x2m+1 = 1. Show that if x2k−1 ≤x ≤x2k, then f(x) < ε/2; that
U(f, P) < ε; and hence that f is Riemann integrable.
.8
Prove that the composition of two Riemann integrable functions need
not be Riemann integrable. (Note the preceding two exercises.)
Since, by Exercise (1.5.10: 3), f(x) = x deﬁnes a Riemann integrable
function over [a, b], the next result generalises Exercise (1.5.10: 5). It should
also be compared with Exercise (1.5.10: 8).
(1.5.11) Proposition.
Let f : [a, b] →J be Riemann integrable, where
J is a compact interval, and let g : J →R be continuous. Then g ◦f is
Riemann integrable.
Proof.
Let
K = sup {g(y) : y ∈J} ,

66
1. Analysis on the Real Line
which exists by Theorem (1.4.9), and write I = [a, b] . According to the
Uniform Continuity Theorem (Exercise (1.4.8: 8)), for each ε > 0 there
exists δ such that
0 < δ <
ε
b −a + 2K
and such that
|g(x) −g(y)| <
ε
b −a + 2K
whenever x, y ∈J and |x −y| < δ. Choose a partition P = (x0, . . . , xn) of
I such that
U(f, P) −L(f, P) < δ2
(this is possible in view of Exercise (1.5.10: 1)), and write P = S ∪T, where
S = {i : Mi(f) −mi(f) < δ} ,
T = {i : Mi(f) −mi(f) ≥δ} .
If i ∈S and x, x′ ∈[xi, xi+1] , then |f(x) −f(x′)| < δ and so
|g ◦f(x) −g ◦f(x′)| <
ε
b −a + 2K .
Hence
Mi(g ◦f) −mi(g ◦f) ≤
ε
b −a + 2K ,
and therefore

i∈S
(Mi(g ◦f) −mi(g ◦f)) (xi+1 −xi) ≤
ε
b −a + 2K
n−1

i=0
(xi+1 −xi)
=
ε(b −a)
b −a + 2K .
On the other hand,

i∈T
(xi+1 −xi) ≤δ−1 
i∈T
(Mi(f) −mi(f)) (xi+1 −xi)
≤δ−1 (U(f, P) −L(f, P))
< δ,
so

i∈T
(Mi(g ◦f) −mi(g ◦f)) (xi+1 −xi) ≤2K

i∈T
(xi+1 −xi)
< 2Kδ
<
2Kε
b −a + 2K .

1.5 Calculus
67
It now follows that
U( g ◦f, P) −L( g ◦f, P )
=

i∈S
(Mi(g ◦f) −mi(g ◦f)) (xi+1 −xi)
+

i∈T
(Mi(g ◦f) −mi(g ◦f)) (xi+1 −xi)
<
ε(b −a)
b −a + 2K +
2Kε
b −a + 2K = ε.
Reference to Exercise (1.5.10: 1) completes the proof.
2
Let f : [a, b] →R be a bounded function, and P = (x0, . . . , xn) a
partition of [a, b]. Any expression of the form
n−1

i=0
f(ξi)(xi+1 −xi),
where ξi ∈[xi, xi+1] for each i, is called a Riemann sum for f (relative to
P).
If f is Riemann integrable, geometric arguments like those presented in
elementary calculus courses lead us to believe that if the partition P has
small mesh, then the corresponding Riemann sums will closely approximate
% b
a f. This expectation is fulﬁlled in the ﬁrst of the next set of exercises.
(1.5.12) Exercises
.1
Prove that a bounded function f : [a, b] →R is Riemann integrable if
and only if there exists a real number Λ with the following property.
For each ε > 0 there exists δ > 0 such that |Σ −Λ| < ε whenever
— P is a partition of [a, b] with mesh less than δ, and
— Σ is a Riemann sum for f relative to P.
Prove that, in that case, Λ =
% b
a f.
.2
Let f, g be Riemann integrable functions on [a, b], and let λ ∈R.
Prove that f + g and λf are Riemann integrable, and that
$ b
a
(f + g)
=
$ b
a
f +
$ b
a
g,
$ b
a
(λf)
=
λ
$ b
a
f.
(Use the preceding exercise.)

68
1. Analysis on the Real Line
.3
Let f : [a, b] →R be bounded, and a ≤c ≤b. Prove that f is
Riemann integrable over [a, b] if and only if it is Riemann integrable
over both [a, c] and [c, b], in which case
$ b
a
f =
$ c
a
f +
$ b
c
f.
.4
Let f : [a, b] →R be Riemann integrable. Prove that f + = f ∨0,
f −= (−f) ∨0, and |f| are Riemann integrable, and that
   
% b
a f
   ≤
% b
a |f| . Prove also that if |f(x)| ≤M for all x ∈[a, b], then
    
$ y
x
f
    ≤M |x −y|
for all x, y ∈[a, b].
.5
Let f and g be Riemann integrable functions on [a, b]. Give two proofs
that the product function fg is Riemann integrable over [a, b]. (For
one proof, ﬁrst take f ≥0 and use Exercise (1.5.10: 1). For a second
proof, note that fg = 1
4

(f + g)2 −(f −g)2	
.)
.6
Let f be a nonvanishing Riemann integrable function on the compact
interval I = [a, b], and suppose that 1/f is bounded on I. Show that
1/f is Riemann integrable over I.
.7
Prove that if f : [a, b] →R is continuous and nonnegative, and
% b
a f = 0, then f(x) = 0 for all x ∈[a, b].
What makes the calculation of integrals feasible is the connection be-
tween integration and diﬀerentiation. There are various expressions of this
connection, each of which may lay claim to the historic title of Fundamental
Theorem of Calculus. Here is one strong version of that theorem.
(1.5.13) Theorem.
If F is diﬀerentiable on [a, b], and F ′ is Riemann
integrable over [a, b], then
$ b
a
F ′ = F(b) −F(a).
Proof.
Let P = (x0, . . . , xn) be any partition of [a, b]. By the Mean Value
Theorem, for each i there exists ξi ∈(xi, xi+1) such that
F(xi+1) −F(xi) = F ′(ξi)(xi+1 −xi).

1.5 Calculus
69
Hence
n−1

i=0
F ′(ξi)(xi+1 −xi) =
n−1

i=0
(F(xi+1) −F(xi)) = F(b) −F(a).
Since P is any partition of [a, b], the result now follows from Exercise
(1.5.12: 1).
2
Let F, f be two mappings of [a, b] into R. We say that F is a primitive,
or antiderivative, of f on [a, b] if F ′(x) = f(x) for all x ∈[a, b]. In view of
the Fundamental Theorem of Calculus (1.5.13), there is an obvious strat-
egy for calculating the Riemann integral of a function f : [a, b] →R: ﬁrst
ﬁnd a primitive F of f, and then compute F(b) −F(a). Of course, as any
student of calculus quickly learns, ﬁnding primitives of Riemann integrable
functions is often a (literally) tricky business; moreover, the class of Rie-
mann integrable functions f for which there exist primitives expressible in
terms of elementary functions is relatively small [41]. So the Fundamental
Theorem of Calculus has severe practical limitations, which have led to the
development of highly accurate, fast methods of numerical integration (see,
for example, [26]).
(1.5.14) Exercises
.1
Let f be Riemann integrable over I = [a, b], and deﬁne
F(x) =
$ x
a
f
(a ≤x ≤b).
Prove that F is continuous on I. Prove also that if x0 ∈I and
lim
x→x0, x∈I f(x) = f(x0),
then
lim
x→x0, x∈I
F(x) −F(x0)
x −x0
= f(x0).
In particular, we obtain a result which is also sometimes called the
Fundamental Theorem of Calculus: if f is continuous on [a, b], then
F is diﬀerentiable on [a, b], F ′(x) = f(x) for all x ∈(a, b), F ′(a+) =
f(a), and F ′(b−) = f(b).
.2
Let the power series f(x) = ∞
n=0 anxn have radius of convergence
R (which could be ∞). Prove that for each x ∈(−R, R),
$ x
0
f =
∞

n=0
an
n + 1xn+1.

70
1. Analysis on the Real Line
.3
By considering
(1 + x)(1 −x + x2 −x3 + · · · + (−1)nxn),
show that
1
1 + x =
∞

n=0
(−1)nxn
(−1 < x < 1).
Hence ﬁnd power series expansions for log(1−x) and (1−x)−1 log(1−
x) on (−1, 1). Then show that the identity
1
2 (log(1 −x))2 = 1
2x2 + 1
3

1 + 1
2
	
x3 + 1
4

1 + 1
2 + 1
3
	
x4 + · · ·
is valid for each x ∈(−1, 1].
.4
In this exercise you will prove that π2, and therefore π itself, is
irrational. Given a positive integer n, deﬁne
φ(x) = 1
n!xn(1 −x)n.
Prove that
(i) φ(k)(0) = 0 for k < n or k > 2n;
(ii) φ(k)(0) and φ(k)(1) are integers for all k ∈N.
Suppose that π2 = p/q for some positive integers p, q, and deﬁne
F = qn
n

k=0
(−1)2n−kπ2(n−k)φ(2k).
Show that F(0) and F(1) are integers, and that
F ′′(x) + π2F(x) = π2pnφ(x).
Setting
G(x) = F ′(x) sin πx −πF(x) cos πx,
show that
G′(x) = π2pnφ(x) sin πx,
and hence that
π
$ 1
0
pnφ(x) sin πx dx
is an integer. Finally, show that
0 < π
$ 1
0
pnφ(x) sin πx dx < πpn
n!
for all positive integers n, and derive a contradiction.

1.5 Calculus
71
We end this chapter by sketching the development of a generalisation of
the Riemann integral. To do so we must ﬁrst introduce another important
class of functions on intervals.
In the rest of the section, unless we say otherwise, I = [a, b] is a compact
interval, and f a mapping of I into R. For all x, y ∈I with x ≤y we deﬁne
the variation of f over [x, y] to be
Tf(x, y) = sup
!n−1

i=0
|f(xi+1) −f(xi)| : x = x0 ≤x1 ≤· · · ≤xn = y
"
if this quantity exists as a real number; we then say that f has bounded
variation on [x, y].
(1.5.15) Exercises
.1
Let f have bounded variation on I. Prove that
(i) f is bounded on I,
(ii) Tf(a, b) = Tf(a, x) + Tf(x, b) for all x ∈I, and
(iii) Tf(a, ·) is an increasing function on I.
.2
Prove that f has bounded variation on I if and only if there exist
increasing functions g, h on I such that f = g −h. (For “only if” note
part (iii) of the preceding exercise.)
.3
Let f, g be functions of bounded variation on I. Prove that f + g,
λf (where λ ∈R), and fg are of bounded variation, and that if
inf {|f(x)| : x ∈I} > 0, then 1/f is of bounded variation.
.4
Deﬁne f : [0, 1] →R by
f(x) =



x2 sin 1
x2
if 0 < x ≤1
0
if x = 0.
Prove that f is diﬀerentiable at each point of [0, 1] but does not have
bounded variation on [0, 1].
.5
Let f : I →R have bounded variation. Prove that the one-sided
limits f(x−) and f(x+) exist at each point of (a, b), as do f(a+) and
f(b−), and that the set of points of I at which f is discontinuous is
either empty or countable. (See Exercise (1.4.5: 8).)
.6
Let (fn) be a sequence of functions of bounded variation on I such
that f(x) = limn→∞fn(x) exists for each x ∈I. Prove that Tf(a, b) ≤

72
1. Analysis on the Real Line
lim inf Tfn(a, b). (First show that for any partition (x0, x1, . . . , xn) of
I and any positive integer k,
n−1

i=0
|f(xi+1) −f(xi)| ≤Tfk(a, b) +
n−1

i=0
|f(xi+1) −fk(xi+1)|
+
n−1

i=0
|f(xi) −fk(xi)| .
Given ε > 0, then choose k appropriately.)
Now let α : I →R be a function with bounded variation on I, P =
(x0, x1, . . . , xn) a partition of I, and f : I →R a bounded function. Any
expression of the form
n−1

i=0
f(ξi) (α(xi+1) −α(xi)) ,
where ξi ∈[xi, xi+1] for each i, is called a Riemann–Stieltjes sum for f
(relative to P and α). We say that f is Riemann–Stieltjes integrable (over
I with respect to α) if there exists a real number Λ with the following
property. For each ε > 0 there exists δ > 0 such that |Σ −Λ| < ε whenever
— P is a partition of I with mesh less than δ and
— Σ is a Riemann–Stieltjes sum for f relative to P.
In that case, Λ—the Riemann–Stieltjes integral of f with respect to α —is
the unique real number with this property, and is usually written
$ b
a
f(x) dα(x).
Exercise (1.5.12: 1) shows that the Riemann integral is just the special
case of the Riemann–Stieltjes integral in which α(x) = x.
(1.5.16) Exercises
In these exercises, α has bounded variation on I, and f, g are bounded
real–valued functions on I.
.1
Why, in the foregoing deﬁnitions, do we require the function α to be
of bounded variation?

1.5 Calculus
73
.2
Let α be an increasing function on I = [a, b]. Given a partition P =
(x0, x1, . . . , xn) of I, we call the real numbers
L(f, P, α) =
n−1

i=0
mi(f) (α(xi+1) −α(xi)) ,
U(f, P, α) =
n−1

i=0
Mi(f) (α(xi+1) −α(xi)) ,
respectively, the lower sum and the upper sum for f relative to P
and α. Prove that the lower integral
$ b
a
f(x) dα(x) = sup {L(f, P, α) : P is a partition of I}
and the upper integral
$ b
a
f(x) dα(x) = inf {U(f, P, α) : P is a partition of I}
of f with respect to α exist. Prove also that f is Riemann–Stieltjes
integrable with respect to α if and only if
$ b
a
f(x) dα(x) =
$ b
a
f(x) dα(x),
in which case their common value is
% b
a f(x) dα(x).
.3
Prove that if f is continuous, then it is Riemann–Stieltjes integrable
with respect to α, and
     
$ b
a
f(x) dα(x)
     ≤
$ b
a
|f(x)| dTα(a, x) ≤MTα(a, b),
where Tα(a, x) is the variation of α on the interval [a, x], and M =
sup {|f(x)| : a ≤x ≤b} . (Note that Tα(a, ·) has bounded variation,
by Exercises (1.5.15: 1 and 2).)
.4
Prove that if f, g are Riemann–Stieltjes integrable with respect to α,
then so are f + g, f −g, and λf (where λ ∈R); in which case,
$ b
a
(f(x) + g(x)) dα(x)
=
$ b
a
f(x) dα(x) +
$ b
a
g(x) dα(x),
$ b
a
(f(x) −g(x)) dα(x)
=
$ b
a
f(x) dα(x) −
$ b
a
g(x) dα(x),
and
$ b
a
λf(x) dα(x) = λ
$ b
a
f(x) dα(x).

74
1. Analysis on the Real Line
.5
Let a ≤c ≤b. Prove that f is Riemann–Stieltjes integrable over [a, b]
(with respect to α) if and only if it is Riemann–Stieltjes integrable
over both [a, c] and [c, b]; in which case,
$ b
a
f(x) dα(x) =
$ c
a
f(x) dα(x) +
$ b
c
f(x) dα(x).
.6
Prove that if α has a continuous derivative on I, then the Riemann–
Stieltjes integral
% b
a f(x) dα(x) exists and equals the Riemann integral
% b
a fα′.
.7
Let α, β be of bounded variation on I, and suppose that f is
Riemann–Stieltjes integrable with respect to both α and β. Prove
that f is Riemann–Stieltjes integrable with respect to α + β, and
that
$ b
a
f(x) d(α + β)(x) =
$ b
a
f(x) dα(x) +
$ b
a
f(x) dβ(x).
Prove also that for each λ ∈R, f is Riemann–Stieltjes integrable
with respect to λα, and
$ b
a
f(x) d(λα)(x) = λ
$ b
a
f(x) dα(x).
The next lemma enables us to discuss the continuity of the function
Tf(a, ·).
(1.5.17) Lemma.
Let f have bounded variation on I. Then for each
positive integer n there exists a function gn : I →R such that
(i) |f(x+) −f(x)| = |gn(x+) −gn(x)| whenever a ≤x < b,
(ii) |f(x) −f(x−)| = |gn(x) −gn(x−)| whenever a < x ≤b,
(iii) Tf(a, ·) −gn is an increasing function, and
(iv) 0 ≤Tf(a, x) −gn(x) < 1/n for all x ∈I.
Moreover, f and gn are continuous at precisely the same points of I.
Proof.
We may assume that a < b. Referring to Exercise (1.5.15: 5),
choose points a = x0 < x1 < · · · < xm−1 < xm = b such that f is
continuous at xi (1 ≤i ≤m −1), and
m−1

i=0
|f(xi+1) −f(xi)| > Tf(a, b) −1
n.

1.5 Calculus
75
Setting gn(a) = 0, construct the function gn on the intervals [xi, xi+1]
inductively, as follows. Assume that gn(x) has been deﬁned for a ≤x ≤xi,
where i < m, and consider x with xi < x ≤xi+1. If f(xi+1) −f(xi) ≥0,
set
gn(x) = f(x) + gn(xi) −f(xi);
if f(xi+1) −f(xi) < 0, set
gn(x) = −f(x) + gn(xi) + f(xi).
This completes the inductive construction.
If xi ≤x < x′ ≤xi+1, then (see Exercise (1.5.15: 1))
Tf(a, x′) −Tf(a, x) = Tf(x, x′)
≥|f(x′) −f(x)|
= |gn(x′) −gn(x)|
≥gn(x′) −gn(x).
Thus if xi−1 ≤x < xi < · · · < xj < x′ ≤xj+1, then
Tf(a, x′) −Tf(a, x) = Tf(a, x′) −Tf(a, xj)
+
j−1

k=i
(Tf(a, xk+1) −Tf(a, xk))
+Tf(a, xi) −Tf(a, x)
≥gn(x′) −gn(xj) +
j−1

k=i
(gn(xk+1) −gn(xk))
+gn(xi) −gn(x)
= gn(x′) −gn(x).
It follows that Tf(a, ·) −gn is an increasing function. For all x ∈[a, b] we
now have
0 = Tf(a, a) −gn(a)
≤Tf(a, x) −gn(x)
≤Tf(a, b) −gn(b)
= Tf(a, b) −
n−1

i=0
(gn(xi+1) −gn(xi))
= Tf(a, b) −
n−1

i=0
|f(xi+1) −f(xi)|
< 1
n.

76
1. Analysis on the Real Line
Finally, properties (i) and (ii) hold, since on each interval [xi, xi+1] either
gn −f or gn + f is constant; the last part of the statement of the lemma
follows immediately.
2
(1.5.18) Proposition.
Let f have bounded variation on I. Then
Tf(a, x+) −Tf(a, x) =
  f(x+) −f(x)
  
if a ≤x < b, and
Tf(a, x) −Tf(a, x−) =
  f(x) −f(x−)
  
if a < x ≤b. Hence f and Tf(a, ·) are continuous at precisely the same
points of I.
Proof.
For each positive integer n choose gn as in the preceding lemma.
For a ≤x < x′ < b we have
|Tf(a, x′) −Tf(a, x) −gn(x′) + gn(x)|
≤|Tf(a, x′) −gn(x′)| + |Tf(a, x) −gn(x)|
< 2
n.
Letting x′ approach x, we see that
  Tf(a, x+) −Tf(a, x) −gn(x+) + gn(x)
  ≤2
n.
Now noting that
gn(x+) −gn(x) =
  f(x+) −f(x)
  ,
we obtain
Tf(a, x+) −Tf(a, x) = lim
n→∞

gn(x+) −gn(x)
	
=
  f(x+) −f(x)
  .
The rest of the proof is left as an exercise.
2
The preceding proposition enables us to prove a result that is used later
(in Theorem (6.1.18)) to establish the uniqueness of the representation of
certain continuous linear functions.
(1.5.19) Proposition.
Let α be a function of bounded variation on I =
[a, b], and let D be the set consisting of a, b, and all points of (a, b) at which
α is discontinuous. Then
% b
a f(x) dα(x) = 0 for each continuous function
f : I →R if and only if α(x) = α(a) for all x ∈I\D.
Proof.
Note that D is countable, by Exercise (1.5.15: 5). Suppose ﬁrst
that
% b
a f(x) dα(x) = 0 for each continuous f on I, and consider any point

1.5 Calculus
77
ξ ∈I\D. There exist arbitrarily small positive numbers t ∈I\D such that
ξ < b −t. For such t let f be the continuous function that equals 1 on the
interval [a, ξ], equals 0 on [ξ + t, b], and is linear on [ξ, ξ + t]. Referring to
Exercises (1.5.16: 5 and 3), we obtain the estimate
0 =
$ b
a
f(x) dα(x)
=
$ ξ
a
f(x) dα(x) +
$ ξ+t
ξ
f(x) dα(x) +
$ b
ξ+t
f(x) dα(x)
≤α(ξ) −α(a) + Tα (ξ, ξ + t) + 0.
Letting t tend to 0 and using Proposition (1.5.18), we see that α(ξ) = α(a).
Now suppose, conversely, that α(x) = α(a) for all x ∈I\D, and let f
be any continuous real–valued function on I. Given ε > 0, choose δ > 0
as in the deﬁnition of
% b
a f(x) dα(x). In view of Exercise (1.5.15: 5), we can
choose a partition P, with mesh less than δ, consisting of a, b, and points
of I\D. For any Riemann–Stieltjes sum Σ for f corresponding to P and α,
we then have Σ = 0 and therefore
     
$ b
a
f(x) dα(x)
     =
     Σ −
$ b
a
f(x) dα(x)
     < ε.
Since ε > 0 is arbitrary, it follows that
% b
a f(x) dα(x) = 0.
2
(1.5.20) Exercises
.1
Complete the proof of Proposition (1.5.18).
.2
Let α be of bounded variation on I = [a, b]. Prove that
% b
a f(x) dα(x) =
0 for each continuous f : I →R if and only if α(x) = α(a) for all x
in a dense subset of I that includes b.
We bring our treatment of the Riemann and Riemann–Stieltjes integrals
to an end here. In the next chapter we develop a type of integral, based
on a generalisation of the integral as an antiderivative, that is much more
powerful than the Riemann integral, and for which it is possible to construct
(although we do not do so) a related generalisation analogous to that of
Riemann–Stieltjes.
For more on Riemann and Riemann–Stieltjes integration see [17], [42],
or [50].

2
Diﬀerentiation and the Lebesgue
Integral
More matter with less art.
hamlet, Act 2, Scene 2
In the ﬁrst section of this chapter we show how the ideas of Chapter 1 can
be applied in a theory of the length of a subset of R; this leads to the Vitali
Covering Theorem, a result with many interesting applications in the theory of
diﬀerentiation and integration. Building on that material, in the next two sections
we describe F. Riesz’s development of Lebesgue integration as the inverse process
to diﬀerentiation “almost everywhere”.
2.1
Outer Measure and Vitali’s Covering Theorem
Can we assign to a subset A of R a measure of its length? We have already
done this when A is a bounded interval; but what about a more general
set A? The answer lies in measure theory, a subject that was pioneered by
Lebesgue, Borel, and others at the beginning of this century and which has
proved of immense importance in analysis, probability theory, and many
other areas of mathematics.
The outer measure of A is the quantity
µ∗(A)
=
inf
∞
n=1 |In| : (In)∞
n=1 is a cover of A
by bounded open intervals} ,

80
2. Diﬀerentiation and the Lebesgue Integral
which we take as ∞if the set on the right–hand side is unbounded.1 If
µ∗(A) ∈R, we say that A has ﬁnite outer measure. Note that since, for
any sequence (In) of bounded open intervals that covers A, the terms of the
series ∞
n=1 |In| are all positive, the (possibly inﬁnite) sum of the series does
not depend on the order of those terms; this is an immediate consequence
of Exercise (1.2.17: 1).
If A has outer measure zero, then we say that A is a set of measure zero,
or that A has measure zero. Thus A has measure zero if and only if for
each ε > 0 there exists a sequence (In)∞
n=1 of bounded open intervals such
that A ⊂∞
n=1 In and ∞
n=1 |In| < ε.
(2.1.1) Exercises
.1
Show that for each A ⊂R, µ∗(A) is the inﬁmum of ∞
n=1 |In|
taken over all covers of A by sequences (In)∞
n=1 of bounded, but not
necessarily open, intervals.
.2
Prove that if a subset A of R has ﬁnite outer measure, then for each
ε > 0 there exists a sequence (In) of disjoint bounded open intervals
such that A ⊂∞
n=1 In and ∞
n=1 |In| < µ∗(A) + ε. (Use Proposition
(1.3.6).)
.3
Show that µ∗(∅) = 0, and that if A ⊂B, then µ∗(A) ≤µ∗(B).
.4
Prove that for each a ∈R, µ∗({a}) = 0.
.5
Let A be a subset of R, and E ⊂A a set of measure zero. Show that
µ∗(A\E) = µ∗(A).
.6
Let A be a subset of a compact interval I. Prove that µ∗(A) +
µ∗(I\A) ≥|I| . (It follows from results towards the end of Section 3 of
this chapter that, perhaps surprisingly, we cannot replace inequality
by equality in this result.)
.7
Let (An) be a sequence of subsets of R. Show that
µ∗
 ∞

n=1
An

≤
∞

n=1
µ∗(An),
where the right–hand side is taken as ∞if either any of its terms is ∞
or the series diverges. (If one of the sets An has inﬁnite outer measure,
then the inequality is trivial. If each An has ﬁnite outer measure, then
for each positive integer n and each ε > 0 there exists a sequence
1In Section 1 of Chapter 3 we give a precise meaning to this use of ∞as an
“extended real number”.

2.1 Outer Measure and Vitali’s Covering Theorem
81
(In,k)∞
k=1 of bounded open intervals such that An ⊂∞
k=1 In,k and
∞
k=1 |In,k| < µ∗(An) + 2−nε.)
Prove that if also the sets An are pairwise–disjoint, then
µ∗
 ∞

n=1
An

=
∞

n=1
µ∗(An).
.8
Give two proofs that a countable subset of R has measure zero. Hence
prove that R is uncountable.
.9
Give two proofs that the union of a sequence of sets of measure zero
has measure zero.
.10 Prove that a subset A of R has ﬁnite outer measure if and only if
l = limn→∞µ∗(A ∩[−n, n]) exists, in which case µ∗(A) = l.
.11 Prove that µ∗is translation invariant—that is, µ∗(A + t) = µ∗(A)
for each A ⊂R and each t ∈R, where A + t = {x + t : x ∈A}.
(2.1.2) Proposition.
The outer measure of any interval in R equals the
length of the interval.
Proof.
Consider, to begin with, a bounded closed interval [a, b]. For each
ε > 0 we have [a, b] ⊂(a −ε, b + ε) and therefore
µ∗([a, b]) ≤|(a −ε, b + ε)| = b −a + 2ε.
Since ε > 0 is arbitrary, we conclude that µ∗([a, b]) ≤b −a. To prove the
reverse inequality, let (In) be any sequence of bounded open intervals that
covers [a, b]. Applying the Heine–Borel–Lebesgue Theorem (1.4.6), and re–
indexing the terms In (which we can do without loss of generality), we may
assume that for some N,
[a, b] ⊂I1 ∪I2 ∪· · · ∪IN.
There exists an interval Ik1, where 1 ≤k1 ≤N, that contains a; let this
interval be (a1, b1). Either b < b1, in which case we stop the procedure, or
else b1 ≤b. In the latter case, b1 ∈[a, b]\(a1, b1); so there exists an interval
Ik2, where 1 ≤k2 ≤N and k2 ̸= k1, that contains b1; call this interval
(a2, b2). Repeating this argument, we obtain intervals (a1, b1), (a2, b2), . . .
in the collection {I1, . . . , IN} such that for each i, ai < bi−1 < bi. This
procedure must terminate with the construction of (aj, bj) for some j ≤N.
Then b ∈(aj, bj), so
N

n=1
|In| ≥
j

i=1
(bi −ai)

82
2. Diﬀerentiation and the Lebesgue Integral
= bj −(aj −bj−1) −(aj−1 −bj−2)
−· · · −(a2 −b1) −a1
> bj −a1.
It follows that ∞
n=1 |In| > b−a and therefore, since (In) was any sequence
of bounded open intervals covering [a, b], that µ∗([a, b]) ≥b −a. Coupled
with the reverse inequality already established, this proves that µ∗([a, b]) =
b −a.
The proof for other types of interval is left as the next exercise.
2
(2.1.3) Exercises
.1
Complete the proof of Proposition (2.1.2) in the remaining cases.
.2
Let {I1, . . . , IN} be a ﬁnite set of bounded open intervals covering
Q ∩[0, 1]. Prove that N
n=1 |In| ≥1. (Given ε > 0, extend each In, if
necessary, to ensure that it has rational endpoints and that the total
length of the intervals is increased by at most ε. Then argue as in the
proof of Proposition (2.1.2).)
.3
Let X be a subset of R with ﬁnite outer measure. Prove that for each
ε > 0 there exists an open set A ⊃X with ﬁnite outer measure, such
that µ∗(A) < µ∗(X) + ε. (Use Exercise (2.1.1: 2).) Show that if X is
also bounded, then we can choose A to be bounded.
Let X be a subset of R, and V a family of nondegenerate intervals—that
is, intervals each having positive length. We say that V is a Vitali covering
of X if for each ε > 0 and each x ∈X there exists I ∈V such that x ∈I
and |I| < ε.
(2.1.4) The Vitali Covering Theorem.
Let V be a Vitali covering of
a set X ⊂R with ﬁnite outer measure. Then for each ε > 0 there exists a
ﬁnite set {I1, . . . , IN} of pairwise–disjoint intervals in V such that
µ∗

X\
N

n=1
In

< ε.
We postpone the proof of this very useful theorem until we have dealt
with some auxiliary exercises.
(2.1.5) Exercises
.1
Let V be a Vitali covering of a subset X of R, x a point of X, and
A an open subset of R containing X. Show that for each ε > 0 there
exists I ∈V such that x ∈I, I ⊂A, and |I| < ε.

2.1 Outer Measure and Vitali’s Covering Theorem
83
.2
Let I1, . . . , IN be ﬁnitely many closed intervals belonging to a Vitali
covering V,of a subset X of R with ﬁnite outer measure, and let x ∈
X\ N
n=1 In. Show that for each ε > 0 there exists I ∈V such that
x ∈I, |I| < ε, and I is disjoint from N
n=1 In.
Proof of the Vitali Covering Theorem.
If necessary replacing the
intervals in I by their closures, we may assume that V consists of closed
intervals. Referring to Exercise (2.1.3: 3), choose an open set A ⊃X with
ﬁnite outer measure. In view of Exercise (2.1.5: 1), we may assume without
loss of generality that
I ⊂A for each I ∈V.
(1)
Choosing any interval I1 in the covering V, we construct pairwise–disjoint
intervals I1, I2, . . . in V inductively as follows. Assume that we have con-
structed I1, . . . , In in V. If X ⊂n
k=1 Ik, then µ∗(X\ n
k=1 Ik) = 0 and
we stop the construction. If X is not contained in n
k=1 Ik, then Exercise
(2.1.5: 2) shows that the set
Sn=
!
|I| : I ∈V, I ∩
n

k=1
Ik = ∅
"
is nonempty. Since, by (1), Sn is bounded above by µ∗(A), it follows that
sn = sup Sn
exists; moreover, as each I ∈V is nondegenerate, sn > 0. To complete our
inductive construction, we now choose In+1 ∈V such that In+1 ∩n
k=1 Ik =
∅and |In+1| > 1
2sn.
We may assume that this construction leads to an inﬁnite sequence
(In)∞
n=1 of pairwise–disjoint elements of V. Since the partial sums of the
series ∞
n=1 |In| are bounded by µ∗(A), the monotone sequence principle
(Proposition (1.2.4)) ensures that the series converges. Given ε > 0, we can
therefore ﬁnd N such that
∞

n=N+1
|In| < ε
5.
For each n > N let xn be the midpoint of In, and let Jn be the closed
interval with midpoint xn and length 5 |In| . It suﬃces to prove that
X\
N

n=1
In ⊂
∞

n=N+1
Jn.
(2)

84
2. Diﬀerentiation and the Lebesgue Integral
For then
µ∗

X\
N

n=1
In

≤
∞

n=N+1
|Jn| = 5
∞

n=N+1
|In| < ε.
To prove (2), consider any x ∈X\ N
n=1 In. By Exercise (2.1.5: 2), there
exists I ∈V such that x ∈I and I ∩N
n=1 In = ∅. We claim that I ∩Im
is nonempty for some m > N. If this were not the case, then for each m
we would have I ∩m
n=1 In = ∅and therefore |I| ≤sm < 2 |Im+1| ; since
limm→∞|Im| = 0 (by Exercise (1.2.14: 1)), it would follow that |I| = 0,
which is absurd as V contains only nondegenerate intervals. Thus
ν = min{m > N : I ∩Im ̸= ∅}
is well deﬁned, I ∩ν−1
n=1 In = ∅, and therefore |I| ≤sν−1 < 2 |Iν| . Since
x ∈I and I ∩Iν ̸= ∅, we see that
|x −xν| ≤|I| + 1
2 |Iν| < 2 |Iν| + 1
2 |Iν| = 5
2 |Iν| .
Hence x ∈Jν. This establishes (2) and completes the proof.
2
In the remainder of this section we apply the Vitali Covering Theorem
in the proofs of some fundamental results in the theory of diﬀerentiation
and integration.
Let I be an interval in R. We say that a mapping f : I →R is ab-
solutely continuous if for each ε > 0 there exists δ > 0 such that if
([ak, bk])n
k=1is a ﬁnite family of nonoverlapping2 compact subintervals of
I such that n
k=1 (bk −ak) < δ, then n
k=1 |f(bk) −f(ak)| < ε.
(2.1.6) Exercises
.1
Prove that an absolutely continuous function on I is both uniformly
continuous and bounded.
.2
Let f, g be absolutely continuous functions on I. Prove that the func-
tions f+g, f−g, λf (where λ ∈R), and fg are absolutely continuous,
and that if inf {|f(x)| : x ∈I} > 0, then 1/f is absolutely continuous.
.3
Prove that if f is diﬀerentiable, with bounded derivative, on an
interval I, then f is absolutely continuous.
.4
Let f be absolutely continuous on a compact interval I = [a, b]. Prove
that f has bounded variation in I, that the variation function Tf(a, ·)
is absolutely continuous on I, and that f is the diﬀerence of two abso-
lutely continuous, increasing functions on I. (See Exercises (1.5.15: 1
and 2).)
2Two intervals in R are nonoverlapping if their intersection is either empty
or contains only endpoints of the intervals.

2.1 Outer Measure and Vitali’s Covering Theorem
85
Let S be a subset of R, and P(x) a statement about real numbers x. If
there exists a set E of measure zero such that P(x) holds for all x in S\E,
then we say that P(x) holds almost everywhere on S, or, more loosely, that
P holds almost everywhere on S; in the case S = R we say simply that
P(x), or P, holds almost everywhere.
A simple corollary of the Mean Value Theorem (Exercise (1.5.4: 6)), one
that suﬃces for many applications, states that if f is continuous on [a, b]
and |f ′(x)| ≤M for all x ∈(a, b), then |f(b) −f(a)| ≤M(b −a). Our ﬁrst
application of the Vitali Covering Theorem generalises this corollary, and
can be regarded an extension of the Mean Value Theorem itself.
(2.1.7) Proposition.
Let f be an absolutely continuous mapping of
a compact interval I = [a, b] into R, and F a diﬀerentiable increasing
mapping of I into R such that |f ′(x)| ≤F ′(x) almost everywhere on I.
Then
|f(b) −f(a)| ≤F(b) −F(a).
(3)
Proof.
Let E ⊂I be a set of measure zero such that |f ′(x)| ≤F ′(x) for
each x ∈X = I\E. We may assume without loss of generality that a, b ∈E.
Given ε > 0, choose δ > 0 as in the deﬁnition of absolute continuity. For
each x ∈X there exist arbitrarily small r > 0 such that [x, x + r] ⊂(a, b),
|f(x + r) −f(x) −f ′(x)r| < εr,
|F(x + r) −F(x) −F ′(x)r| < εr,
and therefore
|f(x + r) −f(x)| ≤|f ′(x)| r + εr
≤F ′(x)r + εr
≤F(x + r) −F(x) + 2εr.
The sets of the form [x, x + r] , for such r > 0, form a Vitali covering of
X. By the Vitali Covering Theorem, there exists a ﬁnite, pairwise–disjoint
collection ([xk, xk + rk])N
k=1 of sets of this type such that
µ∗

X\
N

k=1
[xk, xk + rk]

< δ.
We may assume that xk + rk < xk+1 for 1 ≤k ≤N −1. Thus
x1 −a +
N−1

k=1
(xk+1 −xk −rk) + b −xN −rN < δ,

86
2. Diﬀerentiation and the Lebesgue Integral
and therefore
|f(x1) −f(a)| +
N−1

k=1
|f(xk+1) −f(xk + rk)| + |f(b) −f(xN + rN)| < ε.
It follows that
|f(b) −f(a)| ≤|f(x1) −f(a)| +
N−1

k=1
|f(xk+1) −f(xk + rk)|
+ |f(b) −f(xN + rN)| +
N

k=1
|f(xk + rk) −f(xk)|
< ε +
N

k=1
(F(xk + rk) −F(xk) + 2εrk)
< ε + F(x1) −F(a) +
N−1

k=1
(F(xk+1) −F(xk + rk))
+
N

k=1
(F(xk + rk) −F(xk) + 2εrk)
+ (F(b) −F(xN + rN))
= ε + F(b) −F(a) + 2ε
N

k=1
rk
< F(b) −F(a) + ε(1 + 2b −2a).
Since ε > 0 is arbitrary, we conclude that (3) holds.
2
(2.1.8) Exercises
.1
Let f be absolutely continuous on I = [a, b] , and suppose that for
some constant M, |f ′| ≤M almost everywhere on I. Prove that
|f(b) −f(a)| ≤M(b −a).
.2
Let f : [a, b] →R be an absolutely continuous function such that
f ′(x) = 0 almost everywhere on I = [a, b] . Give two proofs that f is
a constant function. (For one proof use the Vitali Covering Theorem.)
.3
Let f, F be continuous on I = [a, b], and suppose there exists a count-
able subset D of I such that |f ′(x)| ≤F ′(x) for all x ∈I\D. Show
that |f(b) −f(a)| ≤F(b) −F(a). (We may assume that D is count-
ably inﬁnite. Let d1, d2, . . . be a one–one mapping of N+ onto D.
Given ε > 0, let X be the set of all points x ∈I such that
|f(ξ) −f(a)| ≤F(ξ) −F(a) + ε

ξ −a +

{n:dn<ξ}
2−n



2.1 Outer Measure and Vitali’s Covering Theorem
87
for all ξ ∈[a, x), and let s = sup X. Assume that s < b, and derive a
contradiction.)
.4
Let f be continuous on I = [a, b] , and suppose there exists a count-
able subset D of I such that f ′(x) = 0 for all x ∈I\D. Prove that f
is constant on I.
.5
Let C be the Cantor set (see Exercise (1.3.8: 11)). Show that [0, 1]\C
is a countable union of nonoverlapping open intervals (Jn)∞
n=1 whose
lengths sum to 1, and that C has measure zero.
For each x = ∞
n=1 an3−n ∈C deﬁne F(x)= ∞
n=1 an2−n−1. Show
that
(i) if x has two ternary expansions, then they produce the same
value for F(x), so that F is a function on C;
(ii) F is a strictly increasing, continuous mapping of C onto [0, 1] ;
(iii) C is uncountable; and
(iv) F extends to an increasing continuous mapping that is con-
stant on each Jn, equals 0 throughout (−∞, 0], and equals 1
throughout [1, ∞).
Prove that for each δ > 0 there exist ﬁnitely many points
a1 < 0 < b1 < a2 < · · · < bN−1 < aN < 1 < bN
of [−1, 2] such that C ⊂N
n=1 [an, bn] ,
N

n=1
(F(bn) −F(an)) = 1,
and N
n=1 (bn −an) < δ. (Thus F is increasing and continuous, but
not absolutely continuous, on [−1, 2] .)
Finally, show that F ′(x) = 0 for all x ∈[0, 1]\C, but F(1) > F(0).
The last two exercises deserve further comment. Consider a continu-
ous function F on [0, 1] whose derivative exists and vanishes throughout
[0, 1]\E. If E is countable, then Exercise (2.1.8: 4) shows that F is con-
stant. On the other hand, Exercise (2.1.8: 5) shows that if E is uncountable
and of measure zero, then F need not be constant; but if, in that case, F
is absolutely continuous, then it follows from Exercise (2.1.8: 2) that it is
constant.

88
2. Diﬀerentiation and the Lebesgue Integral
Although the derivative of a function f may not exist at a point x ∈R,
one or more of the following quantities—the Dini derivates of f at x—may:
D+f(x) = lim
h→0+ sup f(x + h) −f(x)
h
,
D+f(x) = lim
h→0+ inf f(x + h) −f(x)
h
,
D−f(x) = lim
h→0−sup f(x + h) −f(x)
h
,
D−f(x) = lim
h→0−inf f(x + h) −f(x)
h
.
We consider D+f(x) to be undeﬁned if
— either there is no h > 0 such that f is deﬁned throughout the interval
[x, x + h]
— or else (f(x + h) −f(x)) /hremains unbounded as h →0+.
Similar comments apply to the other derivates of f.
(2.1.9) Exercises
.1
Prove that D+f(x) ≥D+f(x) and D−f(x) ≥D−f(x) whenever the
quantities concerned make sense.
.2
Prove that f is diﬀerentiable on the right (respectively, left) at x if
and only if D+f(x) = D+f(x) (respectively, D−f(x) = D−f(x)).
.3
Let f be a mapping of R into R, and deﬁne g(x) = −f(−x). Prove
that for each x ∈R, D+g(x) = D−f(−x) and D−g(x) = D+f(−x).
.4
Let f : [a, b] →R be continuous, and suppose that one of the four
derivates of f is nonnegative throughout (a, b). Prove that f is an
increasing function on [a, b]. (Show that x →f(x) + εx is increasing
for each ε > 0.)
.5
Consider a function f : [a, b] →R, and real numbers r, s with r > s.
Deﬁne
E =

x ∈(a, b) : D+f(x) > r > s > D−f(x)

.
Let X be an open set such that E ⊂X and µ∗(X) < µ∗(E) + ε (see
Exercise (2.1.3: 3)). Prove that the intervals of the form (x −h, x)
such that x ∈E, h > 0, [x −h, x] ⊂X, and f(x) −f(x −h) < sh
form a Vitali covering of E. Hence prove that for each ε > 0 there
exist ﬁnitely many points x1, . . . , xm of E, and ﬁnitely many positive

2.1 Outer Measure and Vitali’s Covering Theorem
89
numbers h1, . . . , hm, such that the intervals Ji = (xi −hi, xi) (1 ≤
i ≤m) form a pairwise–disjoint collection,
µ∗
 m

i=1
Ji

> µ∗(E) −ε
and
m

i=1
(f(xi) −f(xi −hi)) < s (µ∗(E) + ε) .
Again applying the Vitali Covering Theorem, prove that there ex-
ist ﬁnitely many points y1, . . . , yn of E ∩m
i=1 Ji, and ﬁnitely many
positive numbers h′
1, . . . , h′
n, such that
yk + h′
k < yk+1 (1 ≤k ≤n −1) ,
for each k there exists i such that (yk, yk + h′
k) ⊂Ji, and
n

k=1
(f(yk + h′
k) −f(yk)) > r (µ∗(E) −2ε) .
Our next theorem shows, in particular, that the diﬀerentiability of the
function F can be dropped from the hypotheses of Proposition (2.1.7).
(2.1.10) Theorem.
An increasing function f : R →R is diﬀerentiable
almost everywhere.
Proof.
It suﬃces to show that the sets
S =

x ∈R : D+f(x) is undeﬁned

,
T =

x ∈R : D+f(x) > D−f(x)

have measure zero. For, applying this and Exercise (2.1.9: 3) to the increas-
ing function x →−f(−x), we then see that D−f(x) ≤D+f(x) almost
everywhere; whence, by Exercises (2.1.9: 1) and (2.1.1: 9),
D+f(x) ≤D−f(x) ≤D−f(x) ≤D+f(x) ≤D+f(x) ∈R
almost everywhere. (Note that as f is increasing, D+f(x) and D−f(x) are
everywhere deﬁned and nonnegative.) Thus the four Dini derivates of f are
equal almost everywhere. Reference to Exercise (2.1.9: 2) then completes
the proof.
Leaving S to the next set of exercises, we now show that T has measure
zero. Since T is the union of a countable family of sets of the form
E =

x ∈(a, b) : D+f(x) > r > s > D−f(x)

,
where a < b and r, s are rational numbers with r > s, it is enough to
prove that such a set E has measure zero. We ﬁrst use Exercise (2.1.9: 5)
to obtain

90
2. Diﬀerentiation and the Lebesgue Integral
(i) ﬁnitely many points x1, . . . , xm of (a, b) , and ﬁnitely many positive
numbers h1, . . . , hm, such that the intervals Ji = (xi −hi, xi) (1 ≤
i ≤m) form a pairwise–disjoint collection,
µ∗
 m

i=1
Ji

> µ∗(E) −ε,
and
m

i=1
(f(xi) −f(xi −hi)) < s (µ∗(E) + ε) ;
(ii) ﬁnitely many points y1, . . . , yn of E ∩m
i=1 Ji, and ﬁnitely many
positive numbers h′
1, . . . , h′
n, such that
yk + h′
k < yk+1
(1 ≤k ≤n −1) ,
(4)
for each k there exists i with (yk, yk + h′
k) ⊂Ji, and
n

k=1
(f(yk + h′
k) −f(yk)) > r (µ∗(E) −2ε) .
For each i with 1 ≤i ≤m let
Si = {k : (yk, yk + h′
k) ⊂Ji} .
Since f is increasing, it follows from (4) that

k∈Si
(f(yk + h′
k) −f(yk)) ≤f(xi) −f(xi −hi).
Thus, as the intervals Ji are disjoint,
m

i=1
(f(xi) −f(xi −hi)) ≥
n

k=1
(f(yk + h′
k) −f(yk)) ,
so that
s (µ∗(E) + ε) > r (µ∗(E) −2ε) .
Since ε > 0 is arbitrary, it follows that sµ∗(E) ≥rµ∗(E). But r > s, so we
must have µ∗(E) = 0.
2
We make good use of the following consequence of Theorem (2.1.10).
(2.1.11) Fubini’s Series Theorem.
Let (Fn) be a sequence of increas-
ing continuous functions on R such that F(x) = ∞
n=1 Fn(x) converges
for all x ∈R. Then almost everywhere, F is diﬀerentiable, ∞
n=1 F ′
n(x)
converges, and F ′(x) = ∞
n=1 F ′
n(x).

2.1 Outer Measure and Vitali’s Covering Theorem
91
Proof.
Fix real numbers a, b with a < b. It suﬃces to prove that
F ′(x) = ∞
n=1 F ′
n(x) almost everywhere on I = [a, b]: for then we can apply
the result to the intervals [−n, n] as n increases through N+. If necessary
replacing Fn by Fn −Fn(a), we may assume that Fn(a) = 0. Write
sn(x) = F1(x) + · · · + Fn(x)
(x ∈I)
and note that F −sn = ∞
k=n+1 Fk is increasing and nonnegative. By
Theorem (2.1.10), sn is diﬀerentiable on I\An for some set An of measure
zero; likewise, F (which is clearly increasing) is diﬀerentiable on I\A0 for
some set A0 of measure zero. Then
A =
∞

n=0
An
has measure zero, by Exercise (2.1.1: 9). Since both F −sn+1 and sn+1 −sn
are increasing functions, for each x ∈I\A we have
s′
n(x) ≤s′
n+1(x) ≤F ′(x).
(5)
It follows from the monotone sequence principle that ∞
n=1 F ′
n(x) converges
to a sum ≤F ′(x).
Now choose an increasing sequence (nk)∞
k=1 of positive integers such that
for each k,
0 ≤F(b) −snk(b) ≤2−k.
Since F −snk is an increasing function, for each x ∈I we obtain the
inequalities
0 ≤F(x) −snk(x) ≤2−k.
Hence ∞
k=1 (F(x) −snk(x)) converges, by comparison with ∞
k=1 2−k.
Applying the ﬁrst part of the proof with Fk replaced by F −snk, we now
see that, almost everywhere on I, ∞
k=1

F ′(x) −s′
nk(x)
	
converges and
therefore
lim
k→∞

F ′(x) −s′
nk(x)
	
= 0.
It follows from (5) that
F ′(x) = lim
n→∞sn(x) =
∞

n=1
F ′
n(x)
almost everywhere on I.
2
(2.1.12) Exercises
.1
Let f be an increasing function on [a, b], and for each positive integer
n deﬁne
Sn =

x ∈(a, b) : D+f(x) > n

.

92
2. Diﬀerentiation and the Lebesgue Integral
Prove that
µ∗(I\Sn) < n−1 (f(b) −f(a))
and hence that the set of those x ∈(a, b) at which D+f(x) is
undeﬁned has measure zero. (Use the Vitali Covering Theorem to
show that there exist ﬁnitely many points x1, x2, . . . , xm of (a, b),
and positive numbers h1, h2, . . . , hm, such that xk + hk < xk+1 and
f(xk + hk) −f(xk) > nhk.)
.2
Let E be a bounded subset of R that has measure zero, and let a be
a lower bound for E. For each positive integer n choose a bounded
open set An ⊃E such that µ∗(An) < 2−n (this is possible by Exercise
(2.1.3: 3)), and deﬁne
fn(x) =



0
if x < a
µ∗(An ∩[a, x])
if x ≥a.
Show that
(i) f = ∞
n=1 fn is an increasing continuous function on R;
(ii) D+f(x) is undeﬁned for each x ∈E.
.3
Prove that if f has bounded variation on [a, b], then it is diﬀerentiable
almost everywhere on [a, b]. (The converse is not true: see Exercise
(1.5.15: 4).)
.4
Let f have bounded variation on [a, b]. Prove that T ′
f(a, x) = |f ′(x)|
almost everywhere on [a, b]. (Using Lemma (1.5.17), construct a se-
quence (gn) of functions on I such that for each n, Tf(a, ·) −gn is
increasing, 0 ≤Tf(a, ·)−gn ≤2−n, and g′
n = ±f ′ almost everywhere.
Then use Fubini’s Series Theorem.)
.5
Prove that if a bounded function f is continuous almost everywhere
on a compact interval I, then it is Riemann integrable. (Let M be a
bound for |f| on I, let E ⊂I = [a, b] be a set of measure zero such
that f is continuous on X = I\E, and let ε > 0. We may assume
that a, b ∈E. For each x ∈X there exist arbitrarily small r > 0 such
that [x, x + r] ⊂I and
|f(x′) −f(x′′)| <
ε
2(b −a)
(x ≤x′ ≤x′′ ≤x + r).
The sets [x, x + r] of this type form a Vitali cover of X. With the
aid of the Vitali Covering Theorem, construct a partition P of I such
that U(P, f) −L(P, f) < ε.)

2.2 The Lebesgue Integral as an Antiderivative
93
.6
Prove the converse of the last exercise—namely, if a bounded function
f : [a, b] →R is Riemann integrable, then it is continuous almost
everywhere on [a, b]. (For each positive integer n deﬁne
An =

x ∈[a, b] : ω(f, x) > 1
n

,
where ω(f, x) is the oscillation of f at x; see Exercise (1.4.5: 7). Given
ε > 0, choose a partition P of [a, b] such that U(f, P) −L(f, P) <
ε/2n. Use this to construct a ﬁnite set of intervals that cover An and
have total length less than ε.)
Re–examine Exercise (1.5.10: 6) in the light of this result.
2.2
The Lebesgue Integral as an Antiderivative
In this section we show how Theorem (2.1.10) and Fubini’s Series Theorem
(2.1.11) can be used to introduce the Lebesgue integral, a very powerful
extension of the Riemann integral, as an antiderivative. Our approach3 is
based on a little–known development by F. Riesz [39].
Let f be a nonnegative real–valued function deﬁned almost everywhere
on R. A function F : R →R is called a Lebesgue primitive of f if it is
increasing, bounded below, and satisﬁes F ′ = f almost everywhere.
In order to discuss Lebesgue primitives, we ﬁrst consider the set Pf
of functions F : R →R that are increasing, bounded below, and satisfy
F ′ ≥f almost everywhere. Note that for such a function,
F(−∞) =
lim
x→−∞F(x)
exists: indeed, the sequence (F(−n))∞
n=1, which is decreasing and bounded
below, converges to a limit which is easily shown to be F(−∞).
(2.2.1) Proposition.
If Pf is nonempty, then there exists an element
F∗∈Pf, called an extremal element of Pf, such that
F∗(η) −F∗(ξ) ≤F(η) −F(ξ)
(1)
whenever ξ < η and F ∈Pf.
Proof.
First note that the set
P0
f = {F ∈Pf : F(−∞) = 0}
3It is worth comparing this with the development of the Cauchy integral in
[13].

94
2. Diﬀerentiation and the Lebesgue Integral
is nonempty: for if F
∈Pf, then F −F(−∞) ∈P0
f. It is now a
straightforward exercise to show that
F∗(x) = inf

F(x) : F ∈P0
f

deﬁnes an increasing function F∗: R →R0+ with F∗(−∞) = 0. Given
ε > 0 and real numbers ξ, η with ξ < η, choose F1 ∈P0
f such that F1(ξ) <
F∗(ξ) + ε, and consider any element F of Pf. The function F2 deﬁned by
F2(x) =



F1(x)
if x ≤ξ
F(x) + F1(ξ) −F(ξ)
if ξ ≤x
belongs to P0
f, so
F∗(η) ≤F2(η)
= F(η) + F1(ξ) −F(ξ)
< F(η) + F∗(ξ) + ε −F(ξ),
and therefore
F∗(η) −F∗(ξ) < F(η) −F(ξ) + ε.
Since ε > 0 is arbitrary, inequality (1) follows.
Now let N be a positive integer, and choose a sequence (Fn) in P0
f such
that for each n,
0 ≤Fn(N) −F∗(N) ≤2−n.
For each x ∈[−N, N] we have
F∗(N) −F∗(x) ≤Fn(N) −Fn(x)
and therefore
0 ≤Fn(x) −F∗(x) ≤Fn(N) −F∗(N) ≤2−n.
Hence the series ∞
n=1 (Fn −F∗) of increasing functions converges at each
point of [−N, N] , by comparison with ∞
n=1 2−n. Fubini’s Series Theorem
(2.1.11) now shows that ∞
n=1 (F ′
n −F ′
∗) converges almost everywhere on
[−N, N]. Hence F ′
n −F ′
∗→0, and therefore F ′
∗≥f, almost everywhere on
[−N, N]. Since the union of a sequence of sets of measure zero has measure
zero, it follows that F ′
∗≥f almost everywhere on R.
2
(2.2.2) Corollary.
Under the conditions of Proposition (2.2.1), F1 is an
extremal element of Pf if and only if F∗−F1 is constant on R.
Proof.
If F1 is an extremal element of Pf, and ξ ≤η, then
F∗(η) −F∗(ξ) ≤F1(η) −F1(ξ) ≤F∗(η) −F∗(ξ)

2.2 The Lebesgue Integral as an Antiderivative
95
and therefore
F∗(η) −F∗(ξ) = F1(η) −F1(ξ).
It follows that
F1(x) −F∗(x) = F1(−∞) −F∗(−∞)
for all x ∈R. The converse is trivial.
2
(2.2.3) Corollary.
Under the conditions of Proposition (2.2.1), if f has
a Lebesgue primitive, then F∗is also a Lebesgue primitive.
Proof.
Let F be a Lebesgue primitive of f. Then F
∈Pf, so by
Proposition (2.2.1),
F∗(η) −F∗(ξ) ≤F(η) −F(ξ)
(ξ ≤η).
Since a ﬁnite union of sets of measure zero has measure zero, it follows
from this inequality and Theorem (2.1.10) that
f ≤F ′
∗≤F ′ = f
almost everywhere. Hence F ′
∗= f almost everywhere, and F∗is a Lebesgue
primitive of f.
2
We say that a nonnegative function f deﬁned almost everywhere on R is
Lebesgue integrable (or simply integrable) if there is a bounded Lebesgue
primitive of f. In that case we deﬁne the Lebesgue integral (or simply the
integral) of f to be
$
f = F∗(∞) −F∗(−∞),
where F∗is an extremal element of Pf and
F∗(∞) = lim
x→∞F∗(x).
(The existence of F∗(∞) is left as an exercise.) Corollary (2.2.2) shows that
the value of the integral of f does not depend on the choice of extremal
element F∗in Pf. Note that
$
f = sup
x<y (F∗(y) −F∗(x)) .
We often write
$
f =
$
f(x) dx =
$
f(t) dt = · · · ,
as in elementary calculus courses.
(2.2.4) Exercises

96
2. Diﬀerentiation and the Lebesgue Integral
.1
In the notation of the proof of Proposition (2.2.1), prove that F∗is
an increasing function and that F∗(−∞) = 0.
.2
Prove that if some element of Pf is bounded above and F∗is an
extremal element of Pf, then F∗is bounded above and F∗(∞) exists.
.3
Let f be an integrable nonnegative function, and F a Lebesgue primi-
tive of f. Prove that if F is absolutely continuous on each compact in-
terval, then it is an extremal element of Pf. (Use Proposition (2.1.7).)
Is every bounded Lebesgue primitive of f an extremal element of
Pf?
.4
Show that if f ≥0 is Lebesgue integrable, then
$
f = inf
*
sup
x<y (F(y) −F(x)) : F ∈Pf
+
.
.5
Let f(x) equal a nonnegative constant c in a bounded interval I, and
0 outside I. Show that f is Lebesgue integrable, with
%
f = c |I| .
.6
Let f be an integrable nonnegative function. Prove that
%
f = 0 if
and only if f = 0 almost everywhere.
.7
Let f be an integrable nonnegative function such that
%
f > 0. Prove
that f(x) > 0 on some set with positive outer measure. (Suppose that
for all positive integers m and n,
Em,n =

x ∈[−m, m] : f(x) > 1
n

has measure zero, and use the preceding exercise to obtain a
contradiction.)
.8
Let f and g be integrable nonnegative functions such that f ≥g
almost everywhere, and let F, G be extremal elements of Pf, Pg,
respectively. Prove that
(i) F −G ∈Pf−g, and
(ii) f −g is integrable.
(For (ii) note that F ′ ≥g almost everywhere.)
.9
Let f be an integrable nonnegative function, and F a Lebesgue prim-
itive of f. Show that if F ′(ξ) = f(ξ) and sn ≤ξ ≤sn + 2−n for each
n, then
lim
n→∞2−n
$ sn+2−n
sn
f = f(ξ).
(Note Exercise (1.5.1: 3).)

2.2 The Lebesgue Integral as an Antiderivative
97
(2.2.5) Lemma.
Let Φ, Ψ, and Φ−Ψ be increasing functions on R such
that Φ is an extremal element of PΦ′ and Ψ is bounded. Then Ψ is an
extremal element of PΨ′.
Proof.
Note that Φ′ and Ψ′ are deﬁned almost everywhere, by Proposi-
tion (2.1.10). Hence Ψ ∈PΨ′. By Proposition (2.2.1), PΨ′ has an extremal
element Ψ∗. The function
Θ = Φ −Ψ + Ψ∗
is increasing, bounded below, and has derivative equal to Φ′ almost ev-
erywhere; so it belongs to PΦ′. Since Φ is an extremal element of PΦ′, it
follows that Ψ∗−Ψ = Θ −Φ is an increasing function. But by our choice
of Ψ∗, Ψ −Ψ∗is an increasing function. It follows that Ψ −Ψ∗is constant;
whence, by Corollary (2.2.2), Ψ is an extremal element of PΨ′.
2
(2.2.6) Proposition.
If f, g are integrable nonnegative functions deﬁned
almost everywhere, and λ ≥0, then f + g and λf are integrable,
$
(f + g) =
$
f +
$
g,
(2)
and
$
λf = λ
$
f.
Proof.
Let F∗, G∗be extremal elements of Pf, Pg, respectively. Then
F∗+ G∗is a bounded Lebesgue primitive of f + g, which is therefore inte-
grable; but there is no guarantee that F∗+ G∗is an extremal element of
Pf+g, so we have to work harder to establish the identity (2). To this end,
let H∗be an extremal element of Pf+g. Then F∗+G∗−H∗is an increasing
function. On the other hand, H∗is increasing, and H′
∗= f + g ≥g almost
everywhere; so by our choice of G∗, H∗−G∗is increasing. Applying Lemma
(2.2.5) with Φ = H∗and Ψ = H∗−G∗, we see that H∗−G∗is an extremal
element of Pf; whence, by Corollary (2.2.2), H∗−G∗−F∗has a constant
value c. It follows that
$
(f + g) = H∗(∞) −H∗(−∞)
= (G∗(∞) + F∗(∞) + c) −(G∗(−∞) + F∗(−∞) + c)
= (F∗(∞) −F∗(−∞)) + (G∗(∞) −G∗(−∞))
=
$
f +
$
g.
It is left as an exercise to deal with λf.
2
(2.2.7) Proposition.
If (fn) is a sequence of integrable nonnegative
functions deﬁned almost everywhere, then f = inf fn is integrable.

98
2. Diﬀerentiation and the Lebesgue Integral
Proof.
For each n choose an extremal element F∗n of Pfn, and note that,
by Corollary (2.2.3), F∗n is a Lebesgue primitive of fn. Then F∗n ∈Pf, so
Pf is nonempty. By Proposition (2.2.1), there exists an extremal element
F∗of Pf, and F∗n−F∗is increasing; so (F∗n −F∗)′ ≥0 almost everywhere.
Hence, almost everywhere,
fn = F ′
∗n ≥F ′
∗≥f,
so
f = inf fn ≥F ′
∗≥f,
and therefore F ′
∗= f. Moreover, by Exercise (2.2.4: 2), F∗n, and therefore
F∗, is bounded; so f is integrable.
2
(2.2.8) Corollary.
If f, g are integrable nonnegative functions, then so
are f ∨g and f ∧g.
Proof.
The integrability of f ∧g is a special case of Proposition (2.2.7);
that of f ∨g then follows from the identity
f ∨g = f + g −f ∧g,
Proposition (2.2.6), and Exercise (2.2.4: 8).
2
We now extend the Lebesgue integral to functions of variable sign. We say
that a real–valued function f deﬁned almost everywhere on R is (Lebesgue)
integrable if there exist integrable nonnegative functions f1, f2 such that
f = f1 −f2; we then deﬁne the (Lebesgue) integral of f to be
$
f =
$
f1 −
$
f2.
(2.2.9) Exercises
.1
Prove that the foregoing is a good deﬁnition—in other words, that if
f1, f2, f3, f4 are integrable nonnegative functions such that f1 −f2 =
f3−f4, then
%
f1−
%
f2 =
%
f3−
%
f4. Prove also that if a nonnegative
function f has a bounded Lebesgue primitive, then it is integrable in
the new sense, and its integrals in the old and new senses coincide.
.2
Show that f is integrable if and only if f + = f ∨0 and f −= (−f)∨0
are integrable, in which case
%
f =
%
f + −
%
f −. (Choose integrable
nonnegative functions f1, f2 such that f = f1 −f2, and note that
f + = f1 −f1 ∧f2.)
.3
Prove that if f, g are integrable and λ ∈R, then f + g and λf are
integrable,
%
(f + g) =
%
f +
%
g, and
%
λf = λ
%
f. (For the last part
you will ﬁrst need to complete the proof of Proposition (2.2.6).)

2.2 The Lebesgue Integral as an Antiderivative
99
.4
Prove that if f, g are integrable functions such that f ≥g almost
everywhere, then
%
f ≥
%
g.
.5
Prove that if f is integrable, then so is |f| , and
  %
f
  ≤
%
|f| .
.6
Show that if f and g are integrable, then so are f ∨g and f ∧g.
(Reduce to the case where f and g are nonnegative.)
.7
Let (fn)∞
n=0 be a sequence of integrable functions. Prove that
(i) if fn ≥f0 almost everywhere, then infn≥1 fn is integrable;
(ii) if fn ≤f0 almost everywhere, then supn≥1 fn is integrable.
.8
Let f be a step function—that is, a function, deﬁned almost
everywhere on R, for which there exist points
a = x1 < x2 < · · · < xn = b
and real numbers c1, . . . , cn−1 such that
f(x) =



ci
if xi < x < xi+1
0
if x < a or x > b.
Give two proofs that f is integrable and that
$
f =
n−1

i=1
ci(xi+1 −xi).
.9
Let f be integrable, t a real number, and g(x) = f(x+t). Prove that g
is integrable, with
%
g =
%
f. (Translation invariance of the Lebesgue
integral. First consider the case where f is nonnegative. Let F∗be an
extremal element of Pf, and deﬁne G∗(x) = F∗(x + t); prove that G∗
is a bounded Lebesgue primitive of g, and that
%
g ≤
%
f.)
Let A be a subset of R. The characteristic function of A is the mapping
χA : R →R deﬁned by
χA(x) =



1
if x ∈A
0
if x /∈A.
A function f deﬁned almost everywhere is said to be integrable over A if
fχA is integrable, in which case we deﬁne
$
A
f =
$
fχA.

100
2. Diﬀerentiation and the Lebesgue Integral
If A is a compact interval [a, b] , we write
% b
a f for
%
A f. If A is a closed
inﬁnite interval, we use the natural analogous notations; for example, if
A = [a, ∞), we write
% ∞
a f for
%
A f.
(2.2.10) Proposition.
If f is an integrable function, then f is integrable
over any interval. Moreover, if f is nonnegative and F∗is an extremal
element of Pf, then
$ b
a
f = F∗(b) −F∗(a)
whenever a ≤b.
Proof.
We only discuss the case where f is nonnegative and the interval
is of the form I = [a, b] with a ≤b. Accordingly, we deﬁne
F(x) =











F∗(a)
if x < a
F∗(x)
if a ≤x ≤b
F∗(b)
if x > b.
Then F is a Lebesgue primitive of fχI and so belongs to PfχI. We show
that F is an extremal element of PfχI. Let G ∈PfχI, and for each pair of
real numbers α, β with α < β deﬁne
Hα,β(x) =











F∗(x) + G(α) −F∗(α)
if x < α,
G(x)
if α ≤x ≤β,
F∗(x) + G(β) −F∗(β)
if x > β.
Note that if a ≤α < β ≤b, then Hα,β ∈Pf. Consider real numbers ξ, η
with ξ < η. If η < a or ξ > b, then F(η) = F(ξ) and so
F(η) −F(ξ) ≤G(η) −G(ξ)
(3)
holds trivially. If a ≤ξ < η ≤b, then
F(η) −F(ξ) = F∗(η) −F∗(ξ)
≤Hξ,η(η) −Hξ,η(ξ)
= G(η) −G(ξ).
If ξ < a and η > b, then, as Ha,b ∈Pf and G is increasing,
F(η) −F(ξ) = F∗(b) −F∗(a)
≤Ha,b(b) −Ha,b(a)
= G(b) −G(a)
≤G(η) −G(ξ).

2.2 The Lebesgue Integral as an Antiderivative
101
Hence (3) holds in all possible cases, so F is an extremal element of PfχI.
Since F is bounded by F∗, f is integrable over I and
$ b
a
f = F(∞) −F(−∞) = F∗(b) −F∗(a).
2
(2.2.11) Exercises
.1
Let f be an integrable nonnegative function, and F∗an extremal
element of Pf. Prove that for each x ∈R, f is integrable over (−∞, x]
and
$ x
−∞
f = F∗(x) −F∗(−∞).
.2
Complete the proof of Proposition (2.2.10) in the remaining cases.
.3
Let f be a nonnegative integrable function such that
% x
−∞f = 0 for
each x ∈R. Prove that f = 0 almost everywhere.
.4
Find expressions for χA∩B, χA∪B, and χA\B in terms of χA and χB.
Prove that if f is integrable over both A and B, then it is integrable
over A ∩B, A ∪B, and A\B. Prove also that
(i) if A and B are disjoint, then
%
A∪B f =
%
A f +
%
B f;
(ii) if B ⊂A, then
%
A\B f =
%
A f −
%
B f.
.5
Let f be a nonnegative integrable function, [a, b] a compact interval,
and m a real number such that f(x) ≥m for each x ∈(a, b) . Give two
proofs that
% b
a f ≥m(b −a). (For one proof use Proposition (2.1.7).)
.6
Let f be a nonnegative integrable function, F a bounded Lebesgue
primitive of f, and [a, b] a compact interval. Must we have
% b
a f =
F(b) −F(a)?
The power of the Lebesgue integral only appears when we consider the
interplay between the operations of integration and of taking limits. There
now follows a string of results and exercises that deal with this topic.
A sequence (fn)∞
n=1 of real-valued functions deﬁned almost everywhere
is said to be increasing (respectively, decreasing) if f1 ≤f2 ≤· · ·
(respectively, f1 ≥f2 ≥· · ·) almost everywhere.
(2.2.12) Beppo Levi’s Theorem.
Let (fn) be an increasing sequence
of integrable functions such that the corresponding sequence of integrals
is bounded above. Then (fn) converges almost everywhere to an integrable
function f, and
%
f = limn→∞
%
fn.

102
2. Diﬀerentiation and the Lebesgue Integral
Proof.
Replacing fn by fn −f1 if necessary, we may assume that fn ≥0.
Choose M > 0 such that
%
fn ≤M for each n. By Exercise (2.2.11: 1) and
Corollary (2.2.2),
Fn(x) =
$ x
−∞
fn
deﬁnes an extremal element Fn of Pfn. Since
fnχ(−∞,x] ≤fn+1χ(−∞,x] ≤fn+1,
it follows from Exercise (2.2.9: 4) that (Fn(x))∞
n=1 is an increasing sequence
that is bounded above by M and therefore converges to a limit F(x) ≤
M. Since each Fn is an increasing function, so is F; whence, by Theorem
(2.1.10), F is diﬀerentiable almost everywhere.
If m > n, then F ′
m = fm ≥fn almost everywhere, so Fm ∈Pfn. Thus if
x < y, then
Fn(y) −Fn(x) ≤Fm(y) −Fm(x);
letting m →∞, we obtain
Fn(y) −Fn(x) ≤F(y) −F(x).
It follows that F ′ ≥F ′
n = fn almost everywhere, which ensures that, almost
everywhere, the increasing sequence (fn) converges to a limit f satisfying
f = sup fn ≤F ′.
Since F ′ is integrable (F is a bounded Lebesgue primitive of F ′), it follows
from Exercise (2.2.9: 7) that f is integrable. Finally, by Exercises (2.2.4: 4)
and (2.2.9: 4),
F(∞) −F(−∞) ≥
$
F ′ ≥
$
f ≥
$
fn
= Fn(∞) −Fn(−∞)
→F(∞) −F(−∞) as n →∞,
so
$
f = F(∞) −F(−∞) = lim
n→∞
$
fn.
2
(2.2.13) Exercises
.1
Let α ∈R, and deﬁne
f(x) =



xα
if x > 0
0
if x ≤0.
Prove that f is integrable over [1, ∞) if and only if α < 1, and that
f is integrable over [0, 1) if and only if α > 1. Calculate
%
f in each
case.

2.2 The Lebesgue Integral as an Antiderivative
103
.2
Deﬁne f(x) = e−αx, where α is a positive constant. Prove that f is
integrable, and calculate
%
f.
.3
Let f be an integrable function, and I a bounded interval. Use Beppo
Levi’s Theorem to prove that f is integrable over I. (Consider the
sequence (f ∧gn)∞
n=1, where gn(x) = n if x ∈I, and gn(x) = 0
otherwise.) Extend this result to an unbounded interval I. (First take
f ≥0. Consider the sequence (fn), where fn(x) = f(x) if x ∈I ∩
[−n, n] , and fn(x) = 0 otherwise.)
.4
Prove Lebesgue’s Series Theorem: if ∞
n=1 fn is a series of integrable
functions such that the series ∞
n=1
%
|fn| converges, then ∞
n=1 fn
converges almost everywhere to an integrable function, and
$
∞

n=1
fn =
∞

n=1
$
fn.
(Consider the partial sums of the series ∞
n=1 f +
n and ∞
n=1 f −
n .)
.5
Use the preceding exercise to give another proof that if f is a non-
negative integrable function satisfying
%
f = 0, then f = 0 almost
everywhere (See also Exercises (2.2.11: 3) and (2.2.4: 6).)
.6
Let (An) be a sequence of subsets of R, and f a function that is
integrable over each An, such that ∞
n=1
%
An |f| converges. Prove
that
(i) f is integrable over A = ∞
n=1 An, and
%
A |f| ≤∞
n=1
%
An |f| ;
(ii) if also the sets An are pairwise–disjoint, then
%
A f = ∞
n=1
%
An f.
.7
Let f be an integrable function, and ε > 0. Show that there exists
a bounded interval I such that
%
R\I |f| < ε. (Consider |f| χn, where
χn is the characteristic function of [−n, n] .)
.8
Prove that the series ∞
n=1 e−n2x converges for each x > 0. Deﬁne
f(x) =



∞
n=1 e−n2x
if x > 0
0
if x ≤0.
Prove that f is integrable, and that
%
f = ∞
n=1 1/n2.
.9
Let (fn) be a sequence of integrable functions such that 0 ≤f1 ≤
f2 ≤· · · almost everywhere. Show that limn→∞
%
fn = 0 if and only if
limn→∞fn(x) = 0 almost everywhere. (For “only if” choose a subse-
quence (fnk)∞
k=1 such that
%
fnk ≤2−k for each k, and use Lebesgue’s
Series Theorem.)

104
2. Diﬀerentiation and the Lebesgue Integral
.10 Let (fn) be a sequence of step functions such that 0 ≤fn+1 ≤fn
almost everywhere and limn→∞
%
fn = 0. Without using any of the
foregoing theorems or exercises about the convergence of integrals,
prove that limn→∞fn(x) = 0 almost everywhere.4 (Use the Vitali
Covering Theorem.)
.11 Prove Fatou’s Lemma: if (fn) is a sequence of nonnegative integrable
functions that converges almost everywhere to a function f, and if
the sequence
%
fn
	∞
n=1 is bounded above, then f is integrable and
$
f ≤lim inf
$
fn.
(Apply Beppo Levi’s Theorem to the functions gn = infk≥n fk.)
.12 Let f be deﬁned almost everywhere, and suppose that for each ε > 0
there exist integrable functions g, h such that g ≤f ≤h almost
everywhere and
%
(h −g) < ε. Prove that f is integrable. (For each
n choose integrable functions gn, hn such that gn ≤f ≤hn almost
everywhere and
%
(hn −gn) < 2−n.)
.13 Prove that if E is a set of measure zero, then there exists a non-
negative integrable function f such that
%
f = 0 and f(x) = 1 for
all x ∈E. (For each positive integer n choose a sequence (In,k)∞
k=1
of pairwise–disjoint bounded open intervals such that E ⊂An =
∞
k=1 In,k and ∞
k=1 |In,k| < 1/n. Let f be the characteristic function
of ∞
n=1 An.)
Let f, g be functions deﬁned almost everywhere. We say that g dominates
f if |f| ≤g almost everywhere.
(2.2.14) Lebesgue’s Dominated Convergence Theorem.
Let (fn)
be a sequence of integrable functions that converges almost everywhere to
a function f, and suppose that there exists an integrable function g that
dominates each fn. Then f is integrable, and
%
f = limn→∞
%
fn.
Proof.
The functions
gn = sup
k≥n
fk
are integrable, by Exercise (2.2.9: 7), and form a decreasing sequence con-
verging to f almost everywhere. Noting that
%
(−gn) ≤
%
g, we now apply
4This is the basic result in another approach to Lebesgue integration on R,
which starts by deﬁning the integral of a step function and then considers the
convergence of a sequence (fn) of step functions when the corresponding sequence
of integrals is bounded above; see [40].

2.2 The Lebesgue Integral as an Antiderivative
105
Beppo Levi’s theorem to the sequence (−gn) to show that f is integrable
and that
%
gn →
%
f. Replacing fn by −fn in this argument, we see that
%
hn →
%
f, where
hn = inf
k≥n fk.
Finally, hn ≤fn ≤gn, so
$
hn ≤
$
fn ≤
$
gn,
and therefore
%
fn →
%
f.
2
(2.2.15) Exercises
.1
Prove that if f is an integrable function, then
%
(f ∧n) →
%
f as
n →∞.
.2
Let f be an integrable function, and for each n deﬁne fn = (f ∧n) ∨
−n. Prove that
%
|f −fn| →0 as n →∞.
.3
Give two proofs that if f is an integrable function, then
% 
|f| ∧n−1	
→0 as n →∞.
.4
Give an example of a sequence (fn) of integrable functions such that
limn→∞fn = 0 almost everywhere, limn→∞
%
fn = 0, and there is no
integrable function that dominates each fn.
.5
Let (fn) be a sequence of integrable functions converging almost ev-
erywhere to a function f, and let g be an integrable function that
dominates f. Show that f is integrable, and that
%
f = limn→∞
%
fn.
(Consider the functions (fn ∧g) ∨−g.)
With the help of Lebesgue’s Dominated Convergence Theorem we can
prove the converse of Exercise (2.2.4: 3), and thereby, for a nonnegative in-
tegrable function f, complete the characterisation of the extremal elements
of Pf among the Lebesgue primitives of f.
(2.2.16) Proposition.
If f is a nonnegative integrable function, then
each extremal element of Pf is absolutely continuous on each compact
interval.
Proof.
Let I = [a, b] be a compact interval. Given an extremal element F
of Pf, consider ﬁrst the case where f is bounded above almost everywhere
by some constant M > 0. The function x →Mx is increasing and has
derivative M ≥f almost everywhere. It follows from Proposition (2.2.1)

106
2. Diﬀerentiation and the Lebesgue Integral
that F(η) −F(ξ) ≤M(η −ξ) whenever ξ ≤η. So if ([ak, bk])n
k=1 is a ﬁnite
sequence of nonoverlapping subintervals of I, then
n

k=1
|F(bk) −F(ak)| ≤M
n

k=1
(bk −ak),
from which the absolute continuity of F readily follows.
In the general case we deﬁne
fn = (f ∧n) ∨−n
for each positive integer n. Given ε > 0, we see from Exercise (2.2.15: 2) that
there exists N such that
%
|f −fN| < ε. Choose an extremal element FN
of PfN . If ([ak, bk])n
k=1 is a ﬁnite sequence of nonoverlapping subintervals
of I, then by Proposition (2.2.10),
n

k=1
|F(bk) −F(ak)| =
n

k=1
     
$ bk
ak
f
     
≤
n

k=1
     
$ bk
ak
fN
     +
n

k=1
$ bk
ak
|f −fN|
≤
n

k=1
|FN(bk) −FN(ak)| +
$ b
a
|f −fN|
<
n

k=1
|FN(bk) −FN(ak)| + ε.
Since, by the ﬁrst part of the proof, FN is absolutely continuous, it follows
that F is absolutely continuous.
2
(2.2.17) Exercises
.1
Let f be an integrable function, and F the function deﬁned by
F(x) =
$ x
−∞
f.
Prove that F is absolutely continuous on each compact interval.
.2
Prove that if G : R →R is absolutely continuous on each com-
pact interval, then there exists an integrable function g such that
G′ = g almost everywhere. (Note that for a ≤x, G(x) = TG(a, x) −
(TG(a, x) −G(x)) .)
.3
Let f be a nonnegative continuous function on a compact interval
I = [a, b] , and extend f to R by setting f(x) = 0 for all x outside I.

2.2 The Lebesgue Integral as an Antiderivative
107
Prove that f is integrable over [a, b], and that
% b
a f = ,
% b
a f, where -%
denotes the Riemann integral. (Let
F(x) =













0
if x ≤a
,
% x
a f
if a ≤x ≤b
,
% b
a f
if x > b,
and show that F is absolutely continuous.)
Two fundamental techniques of calculus are changing the variable in an
integral, and integration by parts. We now deal with the former, the latter
being left to the next set of exercises.
(2.2.18) Proposition.
Let g be an absolutely continuous, increasing
function on I = [α, β] , a = g(α), b = g(β), and f an integrable function
on [a, b]. Then (f ◦g)g′ is integrable, and
$ b
a
f =
$ β
α
(f ◦g)g′.
Proof.
We may take f = g = 0 outside [a, b]. By considering f + and
f −separately, we reduce to the case where f is nonnegative. Moreover,
we may assume that f is bounded: for if we have proved the proposition
in the bounded case, we obtain the desired result in the general case for
nonnegative f by considering f ∧n, letting n →∞, and using Beppo Levi’s
Theorem.
Note that, by Corollary (1.4.12), g maps [α, β] onto [a, b] . Choose M
such that 0 ≤f ≤M, and let F be an extremal element of Pf. Then the
function
G = F ◦g
is increasing. Since t →Mt belongs to Pf, if α ≤ξ < η ≤β, then
G(η) −G(ξ) = F(g(η)) −F(g(ξ)) ≤Mg(η) −Mg(ξ);
(4)
so the function Mg −G is increasing. Since, by Exercise (2.2.4: 3), Mg is
an extremal element of PMg′, we can apply Lemma (2.2.5) with Φ = Mg
and Ψ = G, to show that G is an extremal element of PG′; whence
$ b
a
f = F(b) −F(a) = G(β) −G(α) =
$ β
α
G′.
It therefore remains to prove that
G′(t) = f(g(t))g′(t)
(5)

108
2. Diﬀerentiation and the Lebesgue Integral
almost everywhere in I.
Consider the set of those t ∈(α, β) for which (5) fails to hold. This may
be split into ﬁve subsets, as follows:
• the set A1 of measure zero on which G′(t) does not exist;
• the set A2 of measure zero on which g′(t) does not exist (see Exercises
(2.1.6: 4) and (2.1.12: 3));
• the set A3 of measure zero on which F ′(g(t)) does not exist;
• the set A4 of measure zero on which f(g(t)) does not exist;
• the set B of those t ∈I\ 4
k=1 Ak such that F ′(g(t)) ̸= f(g(t)).
To complete the proof for bounded nonnegative f, we show that B has
measure zero. If t ∈B and g′(t) = 0, then it follows from (4) that
|G′(t)| ≤lim
h→0
|Mg(t + h) −Mg(t)|
|h|
= Mg′(t) = 0,
so (5) holds. Let
C = {t ∈B : g′(t) exists and is nonzero, and F ′(g(t)) ̸= f(g(t))} .
Since F is a Lebesgue primitive of f, g(C) has measure zero; we must show
that C itself has measure zero. To this end, for all positive integers m, n
let Cm,n be the set of those t ∈C such that if α < t1 ≤t ≤t2 < β and
g(t2) −g(t1) ≤1/m, then
g(t2) −g(t1) ≥t2 −t1
n
.
Then (Exercise (2.2.19: 1)) C = ∞
m,n=1 Cm,n, so we need only prove that
for ﬁxed m and n, Cm,n has measure zero. Since Cm,n ⊂C, g(Cm,n) has
measure zero; so for each ε > 0 there exists a sequence ([ak, bk])∞
k=1 of
compact subintervals of (a, b) such that
(i) bk −ak < 1/m for each k,
(ii) g(Cm,n) ⊂∞
k=1 [ak, bk] , and
(iii) ∞
k=1(bk −ak) < ε/n.
Clearly, we may assume that g(Cm,n) ∩(ak, bk) is nonempty for each k.
Since g is continuous and increasing, it follows from the Intermediate Value
Theorem that each [ak, bk] is the image under g of a compact subinterval
[αk, βk] of [α, β] . For each k choose t ∈Cm,n with αk ≤t ≤βk. Since
g(βk) −g(αk) = bk −ak < 1
m,

2.2 The Lebesgue Integral as an Antiderivative
109
the deﬁnition of Cm,n ensures that
bk −ak ≥βk −αk
n
.
Thus the intervals [αk, βk] cover Cm,n and have total length
∞

k=1
(βk −αk) ≤
∞

k=1
n(bk −ak) < ε.
Since ε is arbitrary, it follows that Cm,n has measure zero.
2
(2.2.19) Exercises
.1
In the notation of the proof of Proposition (2.2.18), show that C =
∞
m,n=1 Cm,n.
.2
This exercise deals with integration by parts. Let f, g be integrable
functions, and I = [a, b] a compact interval. For a ≤x ≤b deﬁne
F(x) =
$ x
a
f,
G(x) =
$ x
a
g.
Prove that the functions Fg and fG, extended to equal 0 outside I,
are integrable over I and that
$ b
a
Fg +
$ b
a
fG = F(b)G(b) −F(a)G(a).
The ﬁnal set of exercises in this section explores further the relation
between Riemann and Lebesgue integration. For this purpose, we again
denote the Riemann integral by -%
.
(2.2.20) Exercises
.1
Let the bounded function f be Riemann integrable over the compact
interval I = [a, b] . Show that for each ε > 0 there exist step functions
g, h that vanish outside I, such that g ≤f ≤h,
$
g ≤
,
$ b
a
f ≤
$
h,
and
%
(h −g) ≤ε. Then use Exercise (2.2.13: 12) to deduce that f
is Lebesgue integrable over I and that the Lebesgue and Riemann
integrals of f over I are equal.

110
2. Diﬀerentiation and the Lebesgue Integral
.2
Deﬁne f : [0, 1] →R by
f(x) =



1
if x is irrational
0
if x is rational.
Show that f, which we have already shown is not Riemann integrable
(Exercise (1.5.10: 6)), is Lebesgue integrable over [0, 1], with
% 1
0 f = 1.
.3
Let f be a bounded nonnegative function on R that is Riemann
integrable over each compact interval, such that the inﬁnite Riemann
integral J = limn→∞.
% n
−nf exists. Prove that f is Lebesgue integrable
and that its Lebesgue integral equals J. Need this conclusion hold if
f is allowed to take negative values?
.4
Let (fn) be an increasing sequence of Riemann integrable functions
over a compact interval [a, b] , such that f(x) = limn→∞fn(x) deﬁnes
a Riemann integrable function over [a, b]. Prove that
,
$ b
a
f = lim
n→∞
,
$ b
a
fn.
2.3
Measurable Sets and Functions
A function f deﬁned almost everywhere on R is said to be measurable if it
is the limit almost everywhere of a sequence of integrable functions. Clearly,
an integrable function is measurable.
(2.3.1) Proposition.
If a measurable function is dominated by an
integrable function, then it is integrable.
Proof.
Let g be an integrable function dominating a measurable function
f, and choose a sequence (fn) of integrable functions converging to f almost
everywhere. For each n deﬁne
gn = (fn ∧g) ∨−g.
Then gn is integrable, by Exercise (2.2.9: 6), and is dominated by g; also,
lim
n→∞gn = (f ∧g) ∨−g = f
almost everywhere. It follows from Lebesgue’s Dominated Convergence
Theorem (2.2.14) that f is integrable.
2
(2.3.2) Corollary.
A measurable function f is integrable if and only if
|f| is integrable.

2.3 Measurable Sets and Functions
111
Proof.
If |f| is integrable, then, as it dominates f, we see from Propo-
sition (2.3.1) that f is integrable. For the converse we refer to Exercise
(2.2.9: 5).
2
(2.3.3) Exercises
.1
Prove that if f is a measurable function and I is an interval, then
fχI is measurable.
.2
Prove that a continuous function f : R →R is measurable.
.3
Let f, g be measurable functions. Prove that f + g, f −g, f ∨g, and
f ∧g are measurable.
.4
Let (fn) be a sequence of measurable functions that converges almost
everywhere to a function f. Prove that f is measurable. (For each k
deﬁne the step function gk by
gk(x) =



k
if −k ≤x ≤k
0
otherwise.
First prove that (f ∧gk) ∨−gk is integrable.)
.5
Let f be a measurable function, and p a positive number. Prove that
|f|p is measurable.
.6
Give an example of a measurable function f which is not integrable
even though f 2 is.
.7
Give two proofs that the product of two measurable functions is
measurable. (For one proof use Exercises (2.3.3: 3 and 5).)
.8
Let the measurable function f be nonzero almost everywhere. Prove
that 1/f is measurable. (First consider the case where f ≥c almost
everywhere for some positive constant c. For general f ≥0 consider
fn = 1
#
f + n−1	
.)
.9
Let f be a measurable function, and ϕ : R →R a continuous func-
tion. Prove that ϕ◦f is measurable. (Reduce to the case where f van-
ishes outside a compact interval [a, b] . Then use Exercise (2.2.4: 9) to
construct a sequence (fn) of step functions that vanish outside [a, b]
and converge almost everywhere to f.)
.10 Let −2 < α < −1, and deﬁne
f(x) =



xα sin x
if x > 0
0
if x ≤0.
Prove that f is integrable over (0, ∞).

112
2. Diﬀerentiation and the Lebesgue Integral
.11 Deﬁne
f(x) =





sin x
x
if x > 0
0
if x ≤0.
Prove that f is measurable but not integrable. (For the second part
suppose that f is integrable, so |f| is integrable. Use the inequality
$
|f| ≥
N

n=1
$ 2nπ+π/3
2nπ
f
(N ∈N+)
to derive a contradiction.)
.12 Let α > 0, and deﬁne
f(x) =



e−xxα−1
if x > 0
0
if x ≤0.
Prove that f is integrable. (Consider the functions fχ(−∞,1] and
fχ(1,∞) separately.)
.13 Give two proofs of the Riemann–Lebesgue Lemma: if f is an integrable
function, then the functions x →f(x) sin nx and x →f(x) cos nx are
integrable, and
lim
n→∞
$
f(x) sin nx dx = 0,
lim
n→∞
$
f(x) cos nx dx = 0.
(One proof proceeds like this. First reduce to the case where f ≥0
and f vanishes outside a compact interval I = [−Nπ, Nπ] for some
positive integer N. Let F be an extremal element of Pf, and carry
out integration by parts on
% Nπ
−Nπ F ′(x) sin nx dx.)
.14 Let ϕ, ψ, θ be nonnegative bounded integrable functions on I = [0, c]
such that
θ(x) ≤ϕ(x) +
$ x
0
ψ(t)θ(t) dt
(x ∈I).
Prove that
θ(x) ≤ϕ(x) +
$ x
0
ϕ(t)ψ(t) exp
$ x
t
ψ(s) ds

dt
(x ∈I).
(Deﬁne
γ(x)
=
$ x
0
ψ(t)θ(t) dt,
λ(x)
=
γ(x) exp

−
$ x
0
ψ(t) dt

.

2.3 Measurable Sets and Functions
113
Show that
λ′(x) ≤ϕ(x)ψ(x) exp

−
$ x
0
ψ(t) dt

almost everywhere on I, and then use Proposition (2.1.7).)
A subset A of R is called a measurable set (respectively, integrable set) if
χA is a measurable (respectively, integrable) function. A measurable subset
of an integrable set is integrable, by Proposition (2.3.1).
If A ⊂R is integrable, we deﬁne its (Lebesgue) measure to be µ(A) =
%
χA.
(2.3.4) Exercises
.1
Let A, B be measurable sets. Prove that A ∪B, A ∩B, and A\B are
measurable.
.2
Let (An) be a sequence of pairwise–disjoint measurable sets. Prove
that
(i) ∞
n=1 An is measurable;
(ii) if ∞
n=1 µ(An) is convergent, then ∞
n=1 An is integrable, and
µ (∞
n=1 An) = ∞
n=1 µ(An).
.3
Prove that any interval in R is measurable.
.4
Let B be the smallest collection of subsets of R that satisﬁes the
following properties.
— Any open subset of R is in B.
— If A ∈B, then R\A ∈B.
— The union of a sequence of elements of B belongs to B.
The elements of B are called Borel sets. Prove that any Borel set is
measurable.
If 3 is a binary relation on R and f, g are functions deﬁned almost
everywhere on R, we deﬁne
[[f 3 g]] = {x ∈R : f(x) 3 g(x)} .
So, for example,
[[f > g]] = {x ∈R : f(x) > g(x)} .
We also use analogous notations such as
[[a ≤f < b]] = {x ∈R : a ≤f(x) < b} .

114
2. Diﬀerentiation and the Lebesgue Integral
Just as the measurability of a set is related to that of a corresponding
(characteristic) function, so the measurability of a function is related to
that of certain associated sets.
(2.3.5) Proposition.
Let f be a real–valued function deﬁned almost ev-
erywhere. Then f is measurable if and only if [[f > r]] is measurable for
each r ∈R.
Proof.
Suppose that f is measurable, let r ∈R, and for each positive
integer n deﬁne
fn =
(f −r)+
1
n + (f −r)+ .
Since the functions t →t+ and
t →
t
1
n + t
are continuous on R and R0+, respectively, we see from Exercises (2.3.3: 2
and 9) that fn is measurable. But limn→∞fn = χ[[f > r]] almost everywhere,
so [[f > r]] is measurable, by Exercise (2.3.3: 4).
Now assume, conversely, that [[f > r]] is measurable for each r ∈R.
Given a positive integer n, choose real numbers
. . . , r−2, r−1, r0, r1, r2, . . .
such that 0 < rk+1 −rk < 2−n for each k. Then
[[rk−1 < f ≤rk]] = [[f > rk−1]]\[[f > rk]]
is measurable, by Exercise (2.3.4: 1); let χk denote its characteristic
function. The function
fn =
∞

k=−∞
rk−1χk
is measurable: for it is the limit almost everywhere of the sequence of
partial sums of the series on the right–hand side, and Exercises (2.3.3: 3
and 4) apply. To each x in the domain of f there corresponds a unique k
such that rk−1 ≤f(x) < rk; then
0 ≤f(x) −fk(x) < rk −rk−1 < 2−k.
Hence the sequence (fn) converges almost everywhere to f, which is
therefore measurable, again by Exercise (2.3.3: 4).
2
The exercises in the next set extend the ideas used in the proof of Propo-
sition (2.3.5). In particular, when taken together with the subsequent dis-
cussion of measurability in the sense of Carath´eodory (a concept deﬁned

2.3 Measurable Sets and Functions
115
shortly), the second and third exercises link our approach to integration
with the one originally used by Lebesgue; see [40], pages 94–96.
(2.3.6) Exercises
.1
Let f be a function deﬁned almost everywhere on R. Prove that the
following conditions are equivalent.
(i) f is measurable.
(ii) [[f ≥r]] is measurable for each r.
(iii) [[f ≤r]] is measurable for each r.
(iv) [[f < r]] is measurable for each r.
(v) [[r ≤f < R]] is measurable whenever r < R.
.2
In the notation of the second part of the proof of Proposition
(2.3.5), prove that if f is nonnegative and integrable, then each fn is
integrable and limn→∞
%
fn =
%
f.
.3
Let f be a nonnegative measurable function vanishing outside the
interval [a, b]. For the purpose of this exercise, we call a sequence
(rn)∞
n=0 of real numbers admissible if r0 = 0 and there exists δ >
0 such that rn+1 −rn < δ for all n; and we say that the series
∞
n=1 rnµ(En) corresponds to the admissible sequence, where En,
whose characteristic function we denote by χn, is the measurable set
[[rn−1 ≤f < rn]]. Suppose that this series converges. Let (r′
n)∞
n=0
be any admissible sequence for f, and let χ′
n be the characteristic
function of E′
n = [[r′
n−1 ≤f < r′
n]]. Prove that
(i) the series ∞
n=1 r′
n−1χ′
n and ∞
n=1 rnχn converge almost every-
where to integrable functions,
(ii) ∞
n=1 r′
n−1χ′
n ≤f ≤∞
n=1 rnχn almost everywhere,
(iii) the series ∞
n=1 r′
n−1µ(E′
n) and ∞
n=1 rnµ(En) converge, and
(iv) ∞
n=1 r′
n−1µ(E′
n) ≤∞
n=1 rnµ(En).
Hence prove that if ∞
n=1 rnµ(En) converges for at least one admis-
sible sequence (rn), then f is integrable, and
%
f is both the inﬁmum
of the set
! ∞

n=1
rnµ(En) : (rn) is admissible, ∀n (En = [[rn−1 ≤f < rn]])
"
and the supremum of the set
! ∞

n=1
rn−1µ(En) : (rn) is admissible, ∀n (En = [[rn−1 ≤f < rn]])
"
.

116
2. Diﬀerentiation and the Lebesgue Integral
.4
By a simple function we mean a ﬁnite sum of functions of the form cχ,
where c ∈R and χ is the characteristic function of an integrable set.
Let f be a nonnegative integrable function. Show that there exists a
sequence (fn) of simple functions such that
(i) 0 ≤fn ≤f for each n,
(ii) f = ∞
n=1 fn almost everywhere, and
(iii)
%
f = ∞
n=1
%
fn.
(First reduce to the case where f is nonnegative and vanishes outside
a compact interval. Then use the preceding exercise to construct fk
inductively such that
% 
f −k
n=1 fn

< 2−k.)
This exercise relates our development to axiomatic measure theory,
which is based on primitive notions of a “measurable subset” of a set
X and the “measure” of such a set, and in which the integral is often
built up in the following way. First, deﬁne a function f : X →R
to be measurable if [[f < α]] is a measurable set for each α ∈R.
Next, deﬁne the integral of a simple function N
n=1 cnχAn, where
the measurable sets An are pairwise–disjoint, to be N
n=1 cnµ(An).
If f is a nonnegative measurable function, then deﬁne its integral to
be the supremum of the integrals of simple functions s which satisfy
0 ≤s ≤f on the complement of a set whose measure is 0. For this
approach to integration see, for example, [43] or [44].
There is another deﬁnition of measurability for sets, due to Carath´eodory:
we call a set A ⊂R C–measurable if
µ∗(A ∩I) + µ∗(I\A) = |I|
for each compact interval I. We prove two lemmas that enable us to show
that this notion of measurability is equivalent to our original one.
(2.3.7) Lemma.
Let f be an integrable function. Then there exists a se-
quence (fn) of step functions converging almost everywhere to f. Moreover,
if f vanishes outside a compact interval I, then
(i) fn can be chosen to vanish outside I; and
(ii) if, in addition, f is the characteristic function of an integrable set,
then fn can be taken as the characteristic function of a ﬁnite union
of subintervals of I.
Proof.
Since f = limn→∞fχ[−n,n], it suﬃces to consider the case where
f vanishes outside a compact interval I = [a, b]. For each n let
a = xn,0 < xn,1 < · · · < xn,2n = b

2.3 Measurable Sets and Functions
117
be a partition of [a, b] into 2−n subintervals of equal length. Deﬁne a step
function fn by setting
fn(x) =







2−n
$ xn,j+1
xn,j
f
if xn,j < x < xn,j+1
0
otherwise,
and let
E =
∞

n=1
{xn,j : 0 ≤j ≤2n} ∪{x ∈R : f(x) is undeﬁned} .
Then E has measure zero, and, by Exercise (2.2.4: 9), limn→∞fn(x) = f(x)
for all x in E. This completes the proof of (i).
Now suppose that f is the characteristic function of an integrable set
A ⊂I, and, using the ﬁrst part of the proof, construct a sequence (φn) of
step functions that vanish outside I and converge almost everywhere to f.
Deﬁne
fn =



1
if φn(x) > 1
2
0
otherwise.
Then fn is the characteristic function of a ﬁnite union of subintervals of I,
and f = limn→∞fn almost everywhere.
2
(2.3.8) Lemma.
Let A be an integrable subset of a compact interval I.
Then there exists a decreasing sequence (χn) of integrable functions con-
verging almost everywhere to χA, such that each χn is the characteristic
function of a countable union of pairwise–disjoint bounded open intervals.
Proof.
Using Lemma (2.3.7), choose a sequence (fn) of step functions
that vanish outside I and converge almost everywhere to χA, such that
each fn is the characteristic function of a ﬁnite union Sn of pairwise–disjoint
bounded open intervals. Then χA is also the limit, almost everywhere, of
the decreasing sequence (gn), where
gn = sup
k≥n
fk.
Also, gn is the characteristic function of ∞
k=n Sk, which is a countable
union of bounded open subintervals of I. We now build up a sequence
(Tk)∞
k=n of ﬁnite collections of pairwise–disjoint bounded open intervals, as
follows: taking Tn = Sn, suppose we have constructed TN for some N ≥n,
and form TN+1 by adjoining to TN all the intervals of the form J\ N
k=n Tk
with J ∈SN+1. Let χn be the characteristic function of ∞
k=n Tk, which is a
countable union of pairwise–disjoint bounded open intervals. Then χn = gn
almost everywhere, so χn converges to χA almost everywhere.
2

118
2. Diﬀerentiation and the Lebesgue Integral
(2.3.9) Proposition.
Let A be a subset of R. Then
(i) A is measurable if and only if it is C–measurable;
(ii) A is integrable if and only if it is measurable and has ﬁnite outer
measure, in which case µ∗(A) = µ(A).
Proof.
Assume, to begin with, that A is C–measurable. Given a compact
interval I = [a, b] and ε > 0, choose sequences (In) and (Jn) of bounded
open intervals such that
A ∩I ⊂
∞

n=1
In,
I\A ⊂
∞

n=1
Jn,
∞

n=1
|In| < µ∗(A ∩I) + ε/2,
∞

n=1
|Jn| < µ∗(I\A) + ε/2.
By Lebesgue’s Series Theorem (Exercise (2.2.13: 4)), the functions
g = χI −
∞

n=1
χJn,
h =
∞

n=1
χIn
are deﬁned almost everywhere and integrable,
$
g = b −a −
∞

n=1
|Jn| ,
and
$
h =
∞

n=1
|In| .
So
$
(h −g) < µ∗(A ∩I) + µ∗(I\A) −(b −a) + ε = ε.
Since
g ≤χA∩I ≤h

2.3 Measurable Sets and Functions
119
almost everywhere and ε > 0 is arbitrary, we see from Exercise (2.2.13: 12)
that χA∩I is integrable. Moreover,
$
χA∩I ≥
$
g
≥b −a −µ∗(I\A) −ε
2
= µ∗(A ∩I) −ε
2
and
$
χA∩I ≤
$
h ≤µ∗(A ∩I) + ε
2.
Again as ε > 0 is arbitrary, we see that
%
χA∩I = µ∗(A ∩I).
Since χA is the limit of the sequence

χA∩[−n,n]
	∞
n=1, it follows that A is
measurable in our original sense. If also µ∗(A) is ﬁnite, then
lim
n→∞µ∗(A ∩[−n, n]) = µ∗(A),
by Exercise (2.1.1: 10); so, applying Beppo Levi’s Theorem (2.2.12), we
conclude that A is integrable, with µ(A) = µ∗(A). On the other hand, if
A is integrable, then Lebesgue’s Dominated Convergence Theorem (2.2.14)
shows that
lim
n→∞µ∗(A ∩[−n, n]) =
$
χA.
It then follows from Exercise (2.1.1: 10) that µ∗(A) = µ(A).
It remains to prove that measurability implies C–measurability. Accord-
ingly, let A be measurable in our original sense, and again let I = [a, b]
be any compact interval. Using Lemma (2.3.8), construct a decreasing se-
quence (χn) of integrable functions converging almost everywhere to χA∩I,
such that each χn is the characteristic function of the union of a sequence
(In,k)∞
k=1 of pairwise–disjoint bounded open intervals. Then ∞
k=1 In,k in-
cludes (A ∩I)\E, where E is a (possibly empty) set of measure zero;
so
µ∗(A ∩I) ≤
∞

k=1
|In,k| =
$
χn,
the last equality being a consequence of Beppo Levi’s Theorem (2.2.12).
By Lebesgue’s Dominated Convergence Theorem, we now have
µ(A ∩I) = lim
n→∞
$
χn ≥µ∗(A ∩I).
Similarly,
b −a −µ(A ∩I) = µ(I\A) ≥µ∗(I\A),
so
µ∗(A ∩I) + µ∗(I\A) ≤b −a.

120
2. Diﬀerentiation and the Lebesgue Integral
But Exercise (2.1.1: 6) shows that µ∗(A ∩I) + µ∗(I\A) ≥b −a; so
µ∗(A ∩I) + µ∗(I\A) = b −a,
and therefore A is measurable.
2
(2.3.10) Exercise
Let I be a compact interval, and f an integrable function that van-
ishes outside I. Prove that there exists a sequence (fn) of continuous
functions, each vanishing outside I, such that
%
|f −fn| →0. (Re-
duce to the case where f is bounded. Then use Lemma (2.3.7) to
reduce to the case where f is a step function.)
Are all subsets of R measurable? No: the Axiom of Choice (Appendix B)
ensures that nonmeasurable sets exist.5 To show this, following Zermelo,
we deﬁne an equivalence relation ∼on [0, 1) by
x ∼y if and only if x −y ∈Q.
Let ˙x denote the equivalence class of x under this relation. By the Axiom
of Choice, there exists a function φ on the set of these equivalence classes
such that
φ ( ˙x) ∈˙x
(x ∈[0, 1)).
Let
E = {φ( ˙x) : x ∈[0, 1)} .
Now let r1, r2, . . . be a one–one enumeration of Q ∩[0, 1), and for each n
deﬁne
An = E ∩[0, rn),
Bn = E ∩[rn, 1),
E0
n = {x ∈[0, 1) : x + rn −1 ∈An} ,
E1
n = {x ∈[0, 1) : x + rn ∈Bn} ,
En = E0
n ∪E1
n.
We show that if rn < rm, then the sets Em, En are disjoint. To this end,
ﬁrst note that
Ek = {x ∈[0, 1) : x + rk −⌊x + rk⌋∈E} ,
5Solovay [48] has shown that there is a model of Zermelo-Fraenkel set theory,
without the Axiom of Choice, in which every subset of R is Lebesgue measurable.

2.3 Measurable Sets and Functions
121
where ⌊x⌋denotes the integer part of the real number x. Suppose that
x ∈Em ∩En, so that
ym = x + rm −⌊x + rm⌋∈E
and
yn = x + rn −⌊x + rn⌋∈E.
Then
ym −yn = rm −rn + integer
is a rational number. Since E contains exactly one element from each equiv-
alence class under ∼, we must have ym = yn; so rm−rn is an integer, which
is impossible as 0 ≤rn < rm < 1. Hence, in fact, Em ∩En is empty.
Now suppose that E is measurable; then An, Bn are measurable and have
ﬁnite measure. Since E0
n and E1
n are translates of An and Bn, respectively, it
follows from Exercise (2.2.9: 9) that En is measurable, with µ(En) = µ(E).
But ∞
n=1 En = [0, 1), so by Exercise (2.3.4: 2), ∞
n=1 µ(En) = 1. This is
absurd, since an inﬁnite series with all terms equal cannot converge unless
all its terms are 0. Hence E is not measurable.
For more on nonmeasurable sets, see Chapter 5 of [33].
(2.3.11) Exercises
.1
Let E be a nonmeasurable subset of R, and A a subset of E that is
measurable. Prove that µ∗(A) = 0.
.2
Give an example of a nonmeasurable function f such that |f| is
integrable.
At ﬁrst sight it might appear that our approach to the Lebesgue integral
cannot be generalised to multiple integrals. However, in the context of Rn
it is relatively straightforward to develop notions of outer measure, set of
measure zero, and Dini derivates (of a special, set–based kind), and it is not
too hard to prove a version of the Vitali Covering Theorem and hence of
Fubini’s Series Theorem ([46], Chapter 4). With these at hand, as Riesz has
pointed out,6 it is indeed possible to develop the Lebesgue integral in Rn by
6Il ne s’agira, dans le pr´esent M´emoire, que les fonctions d’une seule variable
et il pourrait paraˆıtre, `a premi`ere vue, comme si notre m´ethode ´etait fa¸conn´ee
enti`erement sur ce cas particulier. Dans cet ordre d’id´ees, il convient d’observer
que l’on aurait pu baser les consid´erations, au lieu de la d´eriv´ee au sens ordinaire,
sur l’id´ee moins exigeante de d´eriv´ee par rapport `a un r´eseau, comme s’en sert M.
de la Vall´ee Poussin pour l’´etude de la d´erivation des fonctions d’ensemble [53].
Non seulement que la d´emonstration de l’existence presque partout de cette sorte
de d´eriv´ee d’une fonction monotone est presque imm´ediate, mais en outre on
ne rencontre aucune nouvelle diﬃcult´e quand on veut passer au cas de plusieurs
variables et les consid´erations concernant l’int´egrale s’´etendent `a ce cas g´en´eral
avec des modiﬁcations ´evidentes. ([39], pages 192–193)

122
2. Diﬀerentiation and the Lebesgue Integral
methods akin to those we have used for one–dimensional integration. But
as there are more illuminating approaches to integration on Rn, especially
once a general theory of measures has been developed (see [44] or [43]), we
do not discuss the theory of multivariate integrals in this book.

Part II
Abstract Analysis

3
Analysis in Metric Spaces
...an excellent play; well digested in the scenes,
set down with as much modesty as cunning.
hamlet, Act 2, Scene 2
In Section 1 we abstract many of the ideas from Chapter 1 to the context of a
metric space, a set in which we can measure the distance between two points. In
Section 2 we discuss limits and continuity in that context. Section 3 deals with
compactness, which, as a substitute for ﬁniteness, is perhaps the single most
useful concept in analysis. The next section covers connectedness and lifts the
Intermediate Value Theorem into its proper context. Finally, in Section 5, we
study the product of a family of metric spaces, thereby enabling us to deal with
analysis in Rn and Cn.
3.1
Metric and Topological Spaces
The notion of a metric space generalises the properties of R that are asso-
ciated with the distance given by the function (x, y) →|x −y|. A further
generalisation, which we touch on at the end of this section, is a topological
space, in which, since there may be no analogue of distance, the concept of
open set plays a primary role.
A metric, or distance function, on a set X is a mapping ρ of X × X into
R such that the following properties hold for all x, y, z in X.
M1
ρ(x, y) ≥0.

126
3. Analysis in Metric Spaces
M2
ρ(x, y) = 0 if and only if x = y.
M3
ρ(x, y) = ρ(y, x).
M4
ρ(x, y) ≤ρ(x, z) + ρ(z, y) (triangle inequality).
A metric space is a pair (X, ρ) consisting of a set X and a metric ρ on X;
when the identity of the metric is clear from the context, we simply refer
to X itself as a metric space. We use the letter ρ to denote the metric on
any metric space, except where it might be confusing to do so.
The standard example of a metric space is, of course, the real line R
taken with the metric (x, y) →|x −y|. More generally, if S is a subset of
R, then the restriction of this metric to a function on S × S is a metric
on S. Unless we say otherwise, whenever we consider S ⊂R as a metric
space, we assume that it carries this canonical metric.
(3.1.1) Exercises
.1
Let x1, . . . , xn be elements of a metric space X. Prove the generalised
triangle inequality:
ρ(x1, xn) ≤ρ(x1, x2) + ρ(x2, x3) + · · · + ρ(xn−1, xn).
.2
Let X be a set. Prove that the mapping ρ : X × X →R, deﬁned by
ρ(x, y) =



0
if x = y
1
if x ̸= y
is a metric on X.
This metric is called the discrete metric, and X, taken with the
discrete metric, is called a discrete space.
.3
Prove that each of the following mappings from Rn × Rn to R is a
metric on Rn.
(i) (x, y) →n
i=1 |xi −yi|
(taxicab metric).
(ii) (x, y) →max{|xi −yi| : 1 ≤i ≤n}.
Here, and in the next two exercises, x = (x1, . . . , xn) and y =
(y1, . . . , yn).
.4
Prove the Cauchy–Schwarz inequality,
n

i=1
xiyi ≤
 n

i=1
x2
i
1/2  n

i=1
y2
i
1/2
.
Hence prove Minkowski’s inequality,
 n

i=1
(xi −yi)2
1/2
≤
 n

i=1
x2
i
1/2
+
 n

i=1
y2
i
1/2
.

3.1 Metric and Topological Spaces
127
.5
Show that the mapping
(x, y) →
/
0
0
1
n

i=1
(xi −yi)2
is a metric on Rn. (Note the preceding exercise.)
This metric is known as the Euclidean metric, and Rn, taken with the
Euclidean metric, is known as Euclidean n–space or n–dimensional
Euclidean space.
.6
Let p be a prime number. For each positive integer n deﬁne vp(n) to
be the exponent of p in the prime factorisation of n. For each rational
number r = ±m/n, where m, n are positive integers, deﬁne
vp (r) = vp(m) −vp(n).
Show that this deﬁnition does not depend on the particular represen-
tation of r as a quotient of integers, and that if r′ is also rational,
then
vp(rr′) = vp(r) + vp(r′).
Finally, show that
ρ(x, y) =



p−vp(x−y)
if x ̸= y
0
if x = y
deﬁnes a metric ρ —which we call the p–adic metric —on Q, such
that
ρ(x, z) ≤max {ρ(x, y), ρ(y, z)} .
On any set X a metric ρ that satisﬁes this last property is called an
ultrametric, and (X, ρ) is called an ultrametric space; clearly, X is
then a metric space.
.7
Let X be a nonempty set, and denote by B(X, R) the set of all
bounded mappings of X into R. Show that
ρ(f, g) = sup {|f(x) −g(x)| : x ∈X}
deﬁnes a metric on B(X, R).
From now on, when we refer to B(X, R) as a metric space, it is
understood that the metric is the one deﬁned in this exercise.
.8
A pseudometric on a set X is a mapping ρ : X × X →R that
satisﬁes M1, M3, M4 and the following weakening of M2: if x = y,

128
3. Analysis in Metric Spaces
then ρ(x, y) = 0. The pair (X, ρ), or, loosely, X itself, is then called
a pseudometric space. Prove that in that case,
x ∼y if and only if ρ(x, y) = 0
deﬁnes an equivalence relation on X, and that
ρ (x, y) = ρ(x, y)
deﬁnes a metric ρ on the quotient set X/ ∼, where x is the
corresponding equivalence class of x.
In practice, we often identify X/ ∼with X, and thereby turn X into
a metric space, by calling two elements x, y of X equal if ρ(x, y) = 0
or, equivalently, if x = y.
.9
Prove that
ρ(f, g) =
,
$ b
a
|f −g|
deﬁnes a metric on the set of continuous real–valued mappings on the
compact interval [a, b] , where ,
% b
a denotes the Riemann integral.
.10 Prove that
ρ(f, g) =
$
|f −g|
deﬁnes a pseudometric on the set of Lebesgue integrable functions on
R.
The corresponding metric space (see Exercise (3.1.1: 8)) is denoted by
L1(R). We see from Exercise (2.2.4: 6) that two elements of L1(R) are
equal if and only if, as functions, they are equal almost everywhere.
Let X and Y be metric spaces. A bijection f of X onto Y is called an
isometry if
ρ(f(x), f(y)) = ρ(x, y)
for all x, y in X, in which case the inverse mapping f −1 is an isometry of
Y onto X, and the spaces X and Y are said to be isometric (under f).
Two isometric spaces can be regarded as indistinguishable for all practical
purposes that involve only distance.
Now let X be a metric space, and Y a set in one–one correspondence
with X. With any bijection f of X onto Y there is associated a natural
metric ρY on Y, deﬁned by setting
ρY (f(x), f(y)) = ρ(x, y).
We say that the metric ρ has been transported from X to Y by f. The
mapping f is then an isometry from (X, ρ) onto (Y, ρY ).

3.1 Metric and Topological Spaces
129
An important example of the transport of a metric occurs in connection
with the real line R, and enables us, in Section 3.2, to discuss the conver-
gence of sequences in a metric space as a special case of the convergence of
functions. The mapping f deﬁned on R by
f(x) =
x
1 + |x|
(x ∈R)
is an order–preserving bijection of R onto the open interval (−1, 1), with
inverse mapping g deﬁned by
g(y) =
y
1 −|y|
(|y| < 1).
Let ¯R be obtained from R by adjoining two new elements −∞and ∞,
called the points at inﬁnity. (Note that −∞and ∞are not real numbers,
and that the real numbers are often referred to as the ﬁnite elements of
¯R.) Extend f to a bijection of ¯R onto [−1, 1] by setting
f(−∞) = −1 and f(∞) = 1.
Then g extends to a bijection of [−1, 1] onto ¯R, such that the extended
mapping g is the inverse of the extended mapping f. Now transport (by g)
the standard metric (s, t) →|s −t| from [−1, 1] to ¯R; that is, deﬁne
ρ¯R(x, y) = |f(x) −f(y)|
(x, y ∈¯R).
Taken with the metric ρ¯R, the set ¯R becomes a metric space, called the
extended real line. Note that ρ¯R, restricted to R, is diﬀerent from the
standard metric (x, y) →|x −y| on R.
We introduce the order relations >, ≥on ¯R (and hence the opposite
relations <, ≤) by setting
x > y if and only if f(x) > f(y),
x ≥y if and only if f(x) ≥f(y).
On R these relations coincide with the respective standard inequality
relations.
(3.1.2) Exercises
.1
Prove that the function ρ¯R is a metric on ¯R.
.2
Show that the relations > and ≥on ¯R have the properties that you
would expect. In particular, prove that
(i) −∞< x < ∞for all x ∈R;

130
3. Analysis in Metric Spaces
(ii) a nonempty subset S of R is bounded, and has a supremum and
inﬁmum, relative to the order ≥on ¯R (where sup S and inf S
may equal ∞or −∞);
(iii) when restricted to R, the order relations > and ≥on ¯R coincide
with the standard order relations > and ≥.
Let (X, ρ) be a metric space, a ∈X, and r > 0. We deﬁne the open ball
with centre a and radius r to be
B(a, r) = {x ∈X : ρ(a, x) < r},
and the closed ball with center a and radius r to be
B(a, r) = {x ∈X : ρ(a, x) ≤r}.
For example, the open and closed balls with centre a and radius r in R are
the intervals (a −r, a + r) and [a −r, a + r], respectively; and the open ball
with centre ∞and radius r ∈(0, 1) in ¯R is

r−1 −1, ∞
	
∪{∞} .
In order to deﬁne the notions of open set, interior point, interior of a
set, neighbourhood, cluster point, closure, and closed set for a metric space
X, in the corresponding deﬁnition for subsets of R we replace
— the open interval (x −r, x + r) by its analogue, the open ball B(x, r)
in X, and
— the inequality |x −y| < r by the inequality ρ(x, y) < r.
For example, a subset A of X is said to be open (in X) if for each x ∈A
there exists r > 0 such that B(x, r) ⊂A.
Propositions (1.3.2), (1.3.9), and (1.3.10), and the applicable parts of
Exercises (1.3.7) and (1.3.8), carry over unchanged into the context of a
metric space. When we mention those results in future, it is assumed that
we are referring to their metric space versions.
(3.1.3) Exercises
.1
Prove that X itself, the empty set ∅⊂X, and the open balls in X are
open sets; and that X, ∅, and the closed balls in X are closed sets.
.2
Give proofs of the metric space analogues of Proposition (1.3.2),
Exercises (1.3.7: 3–8), and Exercises (1.3.8: 3–8).
.3
Prove that a subset of X is closed if and only if X\S is open (cf.
Proposition (1.3.9)).
.4
Prove that the intersection of a family of closed sets is closed, and
that the union of a ﬁnite family of closed sets is closed (cf. Proposition
(1.3.10)).

3.1 Metric and Topological Spaces
131
.5
Suppose that ρ is an ultrametric on X (see Exercise (3.1.1: 6)). Prove
the following statements.
(i) If ρ(x, y) ̸= ρ(y, z), then ρ(x, z) = max {ρ(x, y), ρ(y, z)} .
(ii) If y ∈B(x, r), then B(y, r) = B(x, r).
(iii) Every open ball in X is a closed set.
(iv) If two open balls in X have a nonempty intersection, then one
of them is a subset of the other.
Is every closed ball in X an open set? Does (iv) hold with “open ball”
replaced by “ball”?
.6
Two metrics on a set are said to be equivalent if they give rise to the
same class of open sets. Prove that the Euclidean metric is equivalent
to each of the metrics in Exercise (3.1.1: 3).
.7
Prove that ∞is a cluster point of R, considered as a subset of the
metric space ¯R.
If S is a subset of a metric space X, then the restriction to S × S of the
metric ρ on X is a metric—also denoted by ρ —on S, and is said to be
induced on S by ρ. The set S, taken with that induced metric, is called a
(metric) subspace of X.
(3.1.4) Exercise
Prove that if x ∈S and r > 0, then S ∩B(x, r) is the open ball,
and S ∩B(x, r) is the closed ball, with centre x and radius r in the
subspace S.
(3.1.5) Proposition.
Let S be a subspace of the metric space (X, ρ), and
A a subset of S. Then A is open in S if and only if A = S ∩E for some
open set E in X; and A is closed in S if and only if A = S ∩E for some
closed set E in X
Proof.
We prove only the part dealing with open sets, since the other
part then follows by considering complements. Accordingly, suppose that
A = S ∩E for some open set E in X, and let x ∈A. Choosing r > 0 such
that B(x, r) ⊂E, we see that
x ∈S ∩B(x, r) ⊂S ∩E.
Since, by Exercise (3.1.4), S ∩B(x, r) is the open ball with centre x and
radius r in S, it follows that x is an interior point of S ∩E in the subspace
S. Hence A = S ∩E is open in S.

132
3. Analysis in Metric Spaces
Conversely, suppose that A is open in S. Then, by Exercise (3.1.4), for
each x ∈A there exists rx > 0 such that S ∩B(x, rx) ⊂A. So
A =

x∈A
(S ∩B(x, rx)) = S ∩

x∈A
B(x, rx),
where the set 
x∈A B(x, rx) is open in X, by (the metric space analogue
of) Proposition (1.3.2).
2
(3.1.6) Exercises
In each of these exercises S is a subspace of (X, ρ).
.1
Complete the proof of Proposition (3.1.5).
.2
Prove that the following conditions are equivalent.
(i) Every subset of S that is open in S is open in X.
(ii) S is open in X.
.3
Prove that the following conditions are equivalent.
(i) Every subset of S that is closed in S is closed in X.
(ii) S is closed in X.
.4
Let x ∈S and U ⊂S. Show that U is a neighbourhood of x in S if
and only if U = S ∩V for some neighbourhood V of x in X.
.5
Let x ∈S. Show that the following conditions are equivalent.
(i) Every neighbourhood of x in S is a neighbourhood of x in X.
(ii) S is a neighbourhood of x in X.
Let A and B be subsets of X. We say that A is
• dense with respect to B if B ⊂A, and
• dense in X, or everywhere dense, if A = X.
The space X is called separable if it contains a countable dense subset.
For example, Q and R\Q are dense in R, by Exercises (1.1.1: 19) and
(1.2.11: 5). Thus R is separable, as Q is countable.
(3.1.7) Proposition.
If A is dense with respect to B, and B is dense
with respect to C, then A is dense with respect to C.
Proof.
We have B ⊂A and C ⊂B. By Exercises (1.3.8: 7 and 3),
B ⊂(A) = A; whence C ⊂A.
2
(3.1.8) Exercises
.1
Show that A is dense in X if and only if each nonempty open set in
X contains a point of A.

3.1 Metric and Topological Spaces
133
.2
Prove that (−∞, −1) ∪(−1, 1) ∪(1, ∞) is dense in R.
.3
Prove that a nonempty subspace S of a separable metric space X
is separable. (Let (xn) be a dense sequence in X. For each positive
integer m consider the set {n : ρ(xn, S) < 1/m} .)
.4
Prove that the union of a countable family of separable subspaces of
X is separable. What about the union of an uncountable family of
separable subspaces?
.5
A point x of a metric space is said to be isolated if there exists r > 0
such that B(x, r) = {x} . Prove that the set of isolated points of a
separable metric space is either empty or countable.
.6
Prove that a nonempty family of pairwise–disjoint, nonempty open
subsets of a separable metric space is countable. (Use the preceding
exercise.)
If S is a nonempty subset of X and x ∈X, then we deﬁne the distance
from x to S to be the real number
ρ(x, S) = inf{ρ(x, s) : s ∈S}.
More generally, if T is also a nonempty subset of X, then we deﬁne
ρ(S, T) = inf {ρ(s, t) : s ∈S, t ∈T} .
(3.1.9) Proposition.
If S is a nonempty subset of X, and x, y are two
points of X, then
|ρ(x, S) −ρ(y, S)| ≤ρ(x, y).
Proof.
For each s ∈S we have
ρ(x, S) ≤ρ(x, s) ≤ρ(x, y) + ρ(y, s).
It follows that
ρ(x, S) ≤ρ(x, y) + inf{ρ(y, s) : s ∈S} = ρ(x, y) + ρ(y, S)
and therefore that
ρ(x, S) −ρ(y, S) ≤ρ(x, y).
Similarly,
ρ(y, S) −ρ(x, S) ≤ρ(x, y).
The result follows immediately.
2
The diameter of a nonempty subset S of a metric space X is deﬁned as
diam(S) = sup{ρ(x, y) : x ∈S, y ∈S}

134
3. Analysis in Metric Spaces
and is either a nonnegative real number or ∞. Clearly, if S ⊂T, then
diam(S) ≤diam(T); and diam(S) = 0 if and only if S contains exactly one
point.
A subset S of X is said to be bounded if its diameter is ﬁnite—that is, if
diam(S) ∈R.
(3.1.10) Exercises
.1
For nonempty subsets S, T of X, prove that ρ(S, S) = 0 and ρ(S, T) =
ρ(T, S).
.2
Is it true that if S, T are closed subsets of R such that ρ(S, T) = 0,
then S ∩T is nonempty?
.3
Prove that a nonempty subset S of X is closed if and only if ρ(x, S) >
0 for each x ∈X\S.
.4
Let X be an ultrametric space, and B, B′ distinct open balls of ra-
dius r in X both of which are contained in a closed ball of radius r.
Compute ρ(B, B′). (Note Exercise (3.1.3: 5).)
.5
Is it true that
diam(B(x, r)) = diam(B(x, r)) = 2r
for any metric space X, x ∈X, and r > 0?
.6
Prove that
(i) the union of two bounded subsets of a metric space is bounded;
(ii) the union of ﬁnitely many bounded subsets of a metric space is
bounded.
Is the union of an inﬁnite family of bounded subsets necessarily
bounded?
Although the notion of a metric space is suﬃciently strong to underpin
a large amount of analysis, the following more general notion is needed in
more advanced work.1
A topological space (X, τ) consists of a set X and a family τ of subsets
of X satisfying the following conditions.
TO1
X ∈τ and ∅∈τ.
TO2
If Ai ∈τ for each i ∈I, then 
i∈I Ai ∈τ.
1As we do not use the notion of a topology, other than a metric one, in the
remainder of this book, this part of the section can be skipped without penalty.

3.2 Continuity, Convergence, and Completeness
135
TO3
If A1 ∈τ and A2 ∈τ, then A1 ∩A2 ∈τ.
τ is called the topology of the space, and the elements of τ the open sets
of that topology. When the topology τ is clear from the context, we speak
loosely of X as a topological space and of the elements of τ as open sets in
X.
A metric space (X, ρ) is associated with a topological space (X, τ) in
the obvious way: the open sets of τ are precisely those subsets of X that
are open relative to the metric ρ. In such a case we say that the metric ρ
deﬁnes the topology τ, and we identify the metric space (X, ρ) with the
associated topological space (X, τ).
A topological space (X, τ) is said to be metrisable if there is a metric ρ
on X that deﬁnes the topology τ. Not every topological space is metris-
able. For example, if X = {0, 1} is given the topology τ consisting of ∅and
X itself, then every neighbourhood of 0 intersects every neighbourhood of
1; if τ were metrisable, then the distinct points 0, 1 of X would have dis-
joint neighbourhoods—namely, B(0, 1
2) and B(1, 1
2). For characterisations
of metrisable topological spaces see [25].
Let S be a subset of a topological space X, and x ∈X. We say that x is
an interior point of S if there is an open set A such that x ∈A ⊂S; and
we deﬁne the interior of S to be the set of all interior points of S. By a
neighbourhood of x we mean a set U ⊂X containing x in its interior. On
the other hand, x is called a cluster point of S if each neighbourhood of
x has a nonempty intersection with S; and we deﬁne the closure of S (in
X) to be the set ¯S of all cluster points of S. A subset C of X is said to be
closed (in X) if it equals its closure.
Propositions (1.3.2), (1.3.9), and (1.3.10), and the applicable parts of
Exercises (1.3.7) and (1.3.8), all hold in the context of a topological space.
(3.1.11) Exercises
.1
Prove that the standard metric on R, and the metric induced on R
as a subset of the extended real line ¯R, give rise to the same topology
on R.
.2
Prove the statement immediately preceding this set of exercises.
3.2
Continuity, Convergence, and Completeness
In contrast to our approach to limits in Chapter 1, in the context of a metric
space we ﬁrst introduce the notion of continuity. The following deﬁnition is
intended to capture formally the idea that f(x) is close to f(a) whenever
x is close to a.
Let X, Y be metric spaces, and f a mapping of X into Y . We say that
f is

136
3. Analysis in Metric Spaces
• continuous at the point a ∈X if for each ε > 0 there exists δ > 0
such that ρ(f(a),f(x)) < ε whenever x ∈X and ρ(a, x) < δ ;
• continuous on X, or simply continuous, if it is continuous at each
point of X.
If f is not continuous at a ∈X, we say that f has a discontinuity at a, or
that f is discontinuous at a.
(3.2.1) Exercises
.1
Prove that the identity mapping iX : X →X, deﬁned on the metric
space X by iX(x) = x, is continuous.
.2
Prove that any constant mapping between metric spaces is continu-
ous.
.3
A mapping f : X →Y between metric spaces is said to be contractive
if ρ(f(x), f(y)) < ρ(x, y) whenever x, y are distinct points of X. Prove
that a contractive mapping is continuous.
.4
Let X be a metric space, a ∈X, and f, g two functions from X into
R that are continuous at a. Prove that the functions f + g, f −g,
max{f, g}, min {f, g} , |f| , and fg are continuous at a. Prove also
that if g(a) ̸= 0, then f/g is deﬁned in a neighbourhood of a and is
continuous at a.
.5
Let Y be a closed subset of a metric space X, and f : Y →R a
bounded continuous mapping. Prove that
x →inf {f(y)ρ(x, y) : y ∈Y }
is continuous on X\Y. (Note Exercise (3.1.10: 3).)
.6
Let h be a mapping of R0+ into itself such that
(i) h(t) = 0 if and only if t = 0,
(ii) h(s + t) ≤h(s) + h(t) for all s, t.
Let ρ be a metric on a set X. Prove that d = h ◦ρ is a metric on X,
and that if h is continuous at 0, then d is equivalent to ρ (see Exercise
(3.1.3: 6)). Prove, conversely, that if X contains a point that is not
isolated relative to ρ (see Exercise (3.1.8: 5), and if ρ and h ◦ρ are
equivalent metrics, then h is continuous at 0.
Taking h(t) = min {t, 1} in the ﬁrst part of this exercise, we obtain a
bounded metric equivalent to the given metric on X.

3.2 Continuity, Convergence, and Completeness
137
(3.2.2) Proposition.
The following are equivalent conditions on a
mapping f : X →Y, where X, Y are metric spaces.
(i) f is continuous.
(ii) For each open set A ⊂Y, f −1(A) is open in X.
(iii) For each closed set A ⊂Y, f −1(A) is closed in X.
Proof.
Suppose that f is continuous, let A ⊂Y be an open set, and
consider any a in f −1(A). Since f(a) ∈A and A is open, there exists ε > 0
such that B(f(a), ε) ⊂A. Choose δ > 0 such that if ρ(a, x) < δ, then
ρ(f(a), f(x)) < ε and therefore f(x) ∈A. Then B(a, δ) ⊂f −1(A). Hence
f −1(A) is open in X, and therefore (i) implies (ii).
Since a set is open if and only if its complement is closed, it readily
follows that (ii) is equivalent to (iii). Finally, assume (ii), let a ∈X and
ε > 0, and set A = B(f(a), ε) ⊂Y . Then A is open in Y , so f −1(A) is open
in X. Since a ∈f −1(A), there exists δ > 0 such that B(a, δ) ⊂f −1(A); so
if ρ(a, x) < δ, then f(x) ∈A and therefore ρ(f(a), f(x)) < ε. Hence f is
continuous at a. Since a ∈X is arbitrary, f is continuous on X. Thus (ii)
implies (i).
2
The preceding result says that a mapping between metric spaces is con-
tinuous if and only if the inverse image of each open set is open. But the
image of an open set under a continuous mapping need not be open: the
continuous function x →0 maps each nonempty open subset of R onto
the closed set {0} . Likewise, although the inverse image of a closed set
under a continuous mapping is closed, the image of a closed set need not
be: the mapping (x, y) →x on the Euclidean space R2 takes the hyperbola
{(x, y) : xy = 1} , a closed set, onto the open set R\ {0} .
(3.2.3) Proposition.
Let X, Y, Z be metric spaces. If f : X →Y is
continuous at a ∈X, and g : Y →Z is continuous at f(a), then the
composite mapping g ◦f : X →Z is continuous at a. If f is continuous on
X and g is continuous on Y , then g ◦f is continuous on X.
Proof.
Suppose that f is continuous at a and that g is continuous at
b = f(a). Let ε > 0. The continuity of g at b ensures that there exists δ′ > 0
such that if ρ(b, y) < δ′, then ρ(g(b), g(y)) < ε. In turn, as f is continuous
at a, there exists δ > 0 such that if ρ(a, x) < δ, then ρ(f(a), f(x)) < δ′. So
if ρ(a, x) < δ, then ρ(b, f(x)) < δ′ and therefore ρ(g(b), g(f(x))) < ε ; that
is,
ρ (g ◦f(a), g ◦f(x)) < ε.
Hence g ◦f is continuous at a.
The second conclusion of the proposition follows immediately from the
ﬁrst.
2

138
3. Analysis in Metric Spaces
Let S be a subset of a metric space X, and a a limit point of S —that
is, a point of the closure of S\ {a} . Let f be a mapping of S\ {a} into a
metric space Y , and l a point of Y. We say that f(x) has a limit l as x
tends to a in S if the mapping F : S ∪{a} →Y deﬁned by
F(x) =



f(x)
if x ∈S\ {a}
l
if x = a
is continuous at a relative to the subspace S ∪{a} of X. We then also use
such expressions as l is a limit of the mapping f at a with respect to S, or
f(x) converges to l as x tends to a in S, or f(x) tends to l as x ∈S tends
to a. In that case we write
l =
lim
x→a, x∈S f(x)
or
f(x) →l as x →a, x ∈S,
Note that in this deﬁnition it is not required either that a ∈S or that f(x)
be deﬁned at x = a.
In the special case where S = X we often write limx→a f(x), rather than
limx→a, x∈X f(x).
(3.2.4) Exercises
.1
Prove that the following condition is both necessary and suﬃcient
for l ∈Y to be a limit of f(x) as x ∈S tends to a: for each ε > 0
there exists δ > 0 such that if x ∈S and 0 < ρ(a, x) < δ, then
ρ(l, f(x)) < ε.
.2
Prove that a mapping f has at most one limit at a ∈(S\{a}) with
respect to the subset S of X. (Thus we are safe in referring to “the”
limit of f at a.)
.3
Let a ∈X be a limit point of X. Prove that f : X →Y is continuous
at a if and only if f(a) = limx→a, x∈X f(x).
.4
Show that if l = limx→a, x∈S f(x), then for each subset A of S such
that a ∈A\{a}, l is the limit of f at a with respect to A.
.5
Show that if l = limx→a, x∈X f(x) and the mapping g : Y →Z is
continuous at l, then g(l) = limx→a, x∈X g(f(x)).
.6
Prove that if l = limx→a, x∈S f(x), then l ∈f(S).

3.2 Continuity, Convergence, and Completeness
139
Using the metric on the extended real line ¯R introduced in Section 1 of
this chapter, we can handle the convergence of sequences in a metric space
X as a special case of the convergence of functions. To this end, recall that
a sequence (xn)∞
n=1 in X is really a mapping n →xn of N+ into X, and
note that ∞is a limit point of N+ in ¯R (see Exercise (3.1.3: 7)). If the
mapping n →xn has a limit l at the point ∞∈¯R with respect to N+, we
call l the limit of the sequence (xn), we say that the sequence (xn) converges
to l as n tends to ∞, and we write
l = lim
n→∞xn
or
xn →l as n →∞.
The next proposition shows, in particular, that on R our current notion
of convergence of sequences coincides with the one introduced in Section
1.2.
(3.2.5) Proposition.
In order that l = limn→∞xn, it is necessary and
suﬃcient that for each ε > 0 there exist a positive integer N such that
ρ(l, xn) < ε whenever n ≥N.
Proof.
By Exercise (3.2.4: 1), in order that a = limn→∞xn, it is necessary
and suﬃcient that for each ε > 0 there exist δ > 0 such that if n ∈N+
and 0 < ρ¯R(∞, n) < δ, then ρ(a, xn) < ε. But
ρ¯R(∞, n) = (n + 1)−1 > 0 ,
so ρ¯R(∞, n) < δ if and only if n ≥N, where N is the smallest positive
integer > δ−1 −1. The desired conclusion now follows.
2
In view of Proposition (3.2.5), we can easily adapt to the context of a
metric space many of the elementary results about limits of sequences that
were proved in the context of R in Chapter 1. We frequently do this without
further comment.
(3.2.6) Proposition.
Let S be a subset of the metric space X, and a ∈
X. In order that a ∈S, it is necessary and suﬃcient that a be the limit of
a sequence of points of S.
Proof.
To prove the necessity of the stated condition, assume that a ∈S.
Then for each positive integer n there exists a point xn in S ∩B(a, n−1).
Since ρ(xn, a) < 1/N whenever n ≥N, the sequence (xn) converges to a.
The suﬃciency part of the proposition is left as an exercise.
2
(3.2.7) Proposition.
Let (xn) be a sequence in X, and a ∈X. In order
that there exist a subsequence of (xn) converging to a, it is necessary and

140
3. Analysis in Metric Spaces
suﬃcient that for each neighbourhood U of a, xn ∈U for inﬁnitely many
values of n.
Proof.
The condition is clearly necessary. Conversely, if it is satisﬁed,
then we can construct, inductively, a strictly increasing sequence (nk)
of positive integers such that xnk ∈B(a, k−1) for each k. Since xnj ∈
B(a, k−1) whenever j ≥k, the subsequence (xnk) of (xn) converges to the
limit a.
2
(3.2.8) Exercises
.1
Prove the suﬃciency of the condition in Proposition (3.2.6).
.2
Prove that the subset A is dense in the metric space X if and only
if for each x ∈X there exists a sequence (xn) of points of A that
converges to X.
.3
Let A be a dense subset of X, and let f, g be continuous functions
from X into a metric space Y such that f(x) = g(x) for all x in A.
Prove that f(x) = g(x) for all x in X.
.4
Let f be a mapping between metric spaces X and Y, and let a ∈
X. Prove that f is continuous at a if and only if it is sequentially
continuous at a, in the sense that f(xn) →f(a) whenever (xn) is a
sequence in X that converges to a.
.5
Let X be a separable metric space, and f a mapping of X into R.
For each pair of rational numbers q, q′ let Xq,q′ be the set of t ∈X
such that limx→t, x∈X f(x) exists and
f(t) ≤q < q′ ≤
lim
x→t, x∈X f(x).
Show that Xq,q′ is either empty or countable. (Use Exercise (3.1.8: 5).)
Hence prove that the set of points t ∈X such that limx→t, x∈X f(x)
exists and does not equal f(t) is empty or countable.
A sequence (xn) in a metric space X is called a Cauchy sequence if
for each ε > 0 there exists a positive integer N such that ρ(xm, xn) < ε
whenever m, n ≥N. Any convergent sequence is a Cauchy sequence: for if
(xn) converges to a limit l, then, given ε > 0 and choosing N such that
ρ(xn, l) < ε/2 for all n ≥N, we use the triangle inequality to show that
ρ(xm, xn) < ε whenever m, n ≥N.
We say that X is complete if each Cauchy sequence in X has a limit in
X. We have already seen that R is complete (Theorem (1.2.10)).
(3.2.9) Proposition.
A complete subspace of a metric space is closed.
A closed subspace of a complete metric space is complete.

3.2 Continuity, Convergence, and Completeness
141
Proof.
Let S be a subspace of the metric space X. If x ∈S, then by
Proposition (3.2.6), there exists a sequence (xn) in S that converges to x.
Being convergent, (xn) is a Cauchy sequence in S. So if S is complete, then
(xn) converges to a limit s in S. By Exercise (3.2.4: 2), we then have x = s,
so x ∈S. Hence S = S —that is, S is closed in X.
Conversely, suppose that X is complete and S is closed in X. If (xn) is a
Cauchy sequence in S, then it converges to a limit x in X. By Proposition
(3.2.6), x ∈S = S. Hence S is complete.
2
(3.2.10) Exercises
.1
Prove that a sequence (xn) in an ultrametric space is a Cauchy se-
quence if and only if limn→∞ρ(xn, xn+1) = 0. Give an example to
show that this is not the case in a general metric space.
.2
Show that a Cauchy sequence (xn) in X is bounded, in the sense that
{xn : n ≥1} is a bounded subset of X.
.3
Prove that if a Cauchy sequence (xn) has a subsequence that
converges to a limit a, then xn →a as n →∞.
.4
Prove that the interval I = (0, 1] is not complete with respect to
the metric ρ induced by the usual metric on R. Deﬁne a mapping
ρ′ : I × I →R by
ρ′(x, y) =
   1
x −1
y
   .
Show that ρ′ is a metric on I, that ρ and ρ′ are equivalent metrics on
I, and that (I, ρ′) is complete.
.5
Let A and B be complete subsets of a metric space. Give at least two
proofs that A ∪B and A ∩B are complete.
.6
Suppose that ρ(S, T) > 0 for any two disjoint closed subsets S, T of X.
Prove that X is complete. (Suppose there exists a Cauchy sequence
(xn) that does not converge to a limit in X. First reduce to the case
where xm ̸= xn whenever m ̸= n. Then consider the sets {x2n : n ≥1}
and {x2n−1 : n ≥1} .)
.7
Prove that if X is a nonempty set, then the metric space B(X, R)
is complete. (See Exercise (3.1.1: 7). Given a Cauchy sequence (fn)
in B(X, R) and a positive number ε, ﬁrst show that for each x ∈X,
(fn(x))∞
n=1 is a Cauchy sequence in R and therefore converges to a
limit f(x) ∈R. Then prove that the function f so deﬁned is bounded,
and that (fn) converges to f in the metric on B(X, R).)
.8
Let X be a metric space, a ∈X, and for all x, y ∈X deﬁne
φx(y) = ρ(x, y)

142
3. Analysis in Metric Spaces
and
Y = {φa + f : f ∈B(X, R)} .
Prove that
(i) φx ∈Y,
(ii) the equation
d(F, G) = sup {|F(x) −G(x)| : x ∈X}
deﬁnes a metric on Y,
(iii) x →φx is an isometric mapping of X into Y, and
(iv) the closure -
X of {φx : x ∈X} in Y is a complete metric space.
We call the metric space ( -
X, d) the completion of X. More generally,
we say that a complete metric space X′ is a completion of X if there is
an isometry of X onto a dense subspace of X′; but as two completions
of the same metric space X are isometric (why?), we commonly refer
to any completion of X as “the” completion of X.
We now arrive at the notion of uniform continuity, a natural strength-
ening of continuity that, as we show in Theorem (3.3.12), turns out to be
equivalent to continuity for certain very important spaces.
We say that a mapping f : X →Y between metric spaces is uniformly
continuous if for each ε > 0 there exists δ > 0 such that ρ(f(x), f(y)) < ε
whenever x, y ∈X and ρ(x, y) < δ.
(3.2.11) Exercises
.1
Prove that a uniformly continuous mapping is continuous. Give an
example of a continuous mapping on (0, 1] that is not uniformly
continuous.
.2
Let f, g be uniformly continuous mappings of X into R. Show that
f +g, f −g, and fg are uniformly continuous on X. Show that if also
infx∈X |f(x)| > 0, then 1/f is uniformly continuous on X.
.3
Let f : X →Y and g : Y →Z be uniformly continuous mappings
between metric spaces. Show that g ◦f is uniformly continuous on X.
.4
Let S be a nonempty subset of X. Show that the mapping x →ρ(x, S)
is uniformly continuous on X.
.5
Let (an) be a sequence in X. Prove that the function
x →inf
n≥1 ρ(x, an)
is uniformly continuous on X.

3.2 Continuity, Convergence, and Completeness
143
.6
Let α be a positive number. A mapping f between metric spaces X
and Y is said to satisfy a Lipschitz condition of order α, or to be
Lipschitz of order α, if
ρ (f(x), f(y)) ≤(ρ(x, y))α
(x, y ∈X).
Prove that such a mapping is uniformly continuous.
.7
Prove that a mapping f between metric spaces X, Y is uniformly
continuous if and only if ρ(f(S), f(T)) = 0 whenever S, T ⊂X and
ρ(S, T) = 0.
.8
Prove that if X is not complete, then there exists a uniformly
continuous mapping of X into R+ with inﬁmum 0. (See Exercise
(3.2.10: 8).)
.9
Prove that if X is not complete, then there exists an unbounded
continuous mapping of X into R.
.10 Suppose that every continuous mapping of X into R is uniformly
continuous. Prove that X is complete. (Assume that X is a dense
subset of its completion -
X, as deﬁned in Exercise (3.2.10: 8), and
that there exists a Cauchy sequence of elements of X converging to
x∞∈-
X\X. Consider the function x →1/ρ(x, x∞) on X.)
(3.2.12) Proposition.
Let D be a dense subset of a metric space X, and
f a uniformly continuous mapping of D into a complete metric space Y .
Then there exists a unique continuous mapping F of X into Y such that
F(x) = f(x) for all x in D; moreover, F is uniformly continuous on X.
Proof.
For each ε > 0 there exists δ > 0 such that ρ(f(x), f(x′)) < ε
whenever ρ(x, x′) < δ. Given x in X, let (xn) be a sequence in D converg-
ing to x. Since for each ε > 0 there exists N such that ρ(xm, xn) < δ, and
therefore ρ(f(xm), f(xn)) < ε, whenever m, n ≥N, we see that (f(xn)) is
a Cauchy sequence in Y . As the latter space is complete, (f(xn)) con-
verges to a limit ξ in Y . Moreover, if (x′
n) is another sequence in D
converging to x, then limn→∞f(x′
n) = ξ: for, replacing (xn) by the se-
quence (x1, x′
1, x2, x′
2, . . .) in the foregoing argument, we can show that
(f(x1), f(x′
1), f(x2), f(x′
2), . . .) is a Cauchy sequence; since the subsequence
(f(xn)) converges to ξ, we conclude from Exercise (3.2.10: 3) that the se-
quence (f(x1), f(x′
1), f(x2), f(x′
2), . . .), and hence the subsequence (f(x′
n)),
converges to ξ. Thus
F(x) = ξ = lim
n→∞f(xn)
is an unambiguous deﬁnition of a function F from X into Y . If x ∈D, then
(x, x, . . .) is a sequence in D converging to x, so F(x) = f(x).

144
3. Analysis in Metric Spaces
To prove that F is uniformly continuous, consider x, x′ in X such that
ρ(x, x′) < δ, and let (xn) and (x′
n) be sequences in D converging to x and
x′, respectively. Then (f(xn)) and (f(x′
n)) converge to F(x) and F(x′),
respectively. So for all suﬃciently large n we have ρ(F(x), f(xn)) < ε,
ρ(F(x′), f(x′
n)) < ε, and ρ(xn, x′
n) < δ; whence ρ(f(xn), f(x′
n)) < ε, and
therefore, by the triangle inequality, ρ(F(x), F(x′)) < 3ε. Thus F is uni-
formly continuous on X. Finally, the uniqueness of F is an immediate
consequence of Exercise (3.2.8: 3).
2
The foregoing result enables us to extend uniformly continuous functions
from dense subsets to the whole space. We close this section with a famous
theorem that enables us to extend continuous real–valued functions from
closed subspaces to the whole space.
(3.2.13) The Tietze Extension Theorem.
Let X be a metric space,
Y a closed subspace of X, and f a bounded continuous mapping of Y into
R. Then there exists a bounded continuous mapping F : X →R such that
(i) F(y) = f(y) for all y ∈Y,
(ii) infx∈X F(x) = infy∈Y f(y), and
(iii) supx∈X F(x) = supy∈Y f(y).
Proof.
We may assume that f is not constant. Let h be an increasing
function of the form x →ax + b mapping the interval [inf f, sup f] onto
[1, 2]; replacing f by h◦f, if necessary, we reduce to the case where inf f = 1
and sup f = 2. Since Y is closed, ρ(x, Y ) > 0 for all x ∈X\Y (Exercise
(3.1.10: 3)), and so
F(x) =







f(x)
if x ∈Y
infy∈Y f(y)ρ(x, y)
ρ(x, Y )
if x ∈X\Y
deﬁnes a function F : X →R that coincides with f on Y . To prove that F
satisﬁes (ii) and (iii), we need only show that 1 ≤F(x) ≤2 for all x ∈X\Y.
For such x and all y ∈Y we have
F(x) ≤2ρ(x, y)
ρ(x, Y ) .
So, given ε > 0 and choosing y ∈Y such that
ρ(x, y) ≤

1 + ε
2

ρ(x, Y ),

3.2 Continuity, Convergence, and Completeness
145
we obtain F(x) ≤2 + ε. On the other hand, choosing y′ ∈Y such that
1 ≤ρ(x, y′)
ρ(x, Y ) ≤f(y′)ρ(x, y′)
ρ(x, Y )
< F(x) + ε,
we see that F(x) > 1−ε. As ε > 0 is arbitrary, it follows that 1 ≤F(x) ≤2.
Since f is continuous on Y ◦, so is F. Also, the function x →ρ(x, Y )
is uniformly continuous on X\Y, by Exercise (3.2.11: 4); so, by Exercises
(3.2.1: 5 and 4), F is continuous on X\Y. It therefore remains to prove the
continuity of F at any ξ ∈Y ∩X\Y . Given ε > 0, choose r > 0 such that
if y ∈Y and ρ(ξ, y) < r, then |f(ξ) −f(y)| < ε. It suﬃces to prove that if
x ∈X\Y and ρ(x, ξ) < r/4, then
F(ξ) −ε ≤F(x) ≤F(ξ) + ε.
(1)
To this end, observe that for each y ∈Y \B(ξ, r),
ρ(x, y) ≥ρ(ξ, y) −ρ(x, ξ) > 3r
4 > 2ρ(x, ξ) ≥ρ (x, Y ∩B(ξ, r)) ,
so
f(y)ρ(x, y) > 3r
4 > f(ξ)ρ(x, ξ) ≥
inf
η∈Y ∩B(ξ,r) f(η)ρ(x, η).
It follows that
ρ(x, Y ) = ρ (x, Y ∩B(ξ, r))
(2)
and that
inf
y∈Y f(y)ρ(x, y) =
inf
y∈Y ∩B(ξ,r) f(y)ρ(x, y).
(3)
For each y ∈Y ∩B(ξ, r) we have
f(ξ) −ε < f(y) < f(ξ) + ε
and therefore
(f(ξ) −ε) ρ(x, Y ) ≤f(y)ρ(x, y) ≤(f(ξ) + ε) ρ(x, y).
Hence
(f(ξ) −ε) ρ(x, Y ) ≤
inf
y∈Y ∩B(ξ,r) f(y)ρ(x, y) ≤(f(ξ) + ε) ρ(x, Y ∩B(ξ, r)),
and so, by (2) and (3),
(f(ξ) −ε) ρ(x, Y ) ≤inf
y∈Y f(y)ρ(x, y) ≤(f(ξ) + ε) ρ(x, Y ).
Dividing through by ρ(x, Y ), we obtain the desired inequalities (1).
2
The mapping F in Theorem (3.2.13) is called a continuous extension of
f to X.

146
3. Analysis in Metric Spaces
(3.2.14) Exercises
.1
Give two proofs of Urysohn’s Lemma: if S, T are nonempty disjoint
closed subspaces of a metric space X, then there exists a continuous
mapping f : X →[0, 1] such that f(S) = {0} and f(T) = {1} . (For
one proof, note that ρ(x, S) + ρ(x, T) > 0 for all x ∈X.)
.2
Let Y be a closed subspace of a metric space X, and f a continuous
mapping of Y into R. Prove that there exists a continuous extension
F : X →R of f. (First apply Theorem (3.2.13) to g ◦f for some
suitable function g.)
.3
Suppose that for each pair S, T of nonempty disjoint closed subsets
of X there exists a uniformly continuous mapping f : X →[0, 1] such
that f(S) = {0} and f(T) = {1} . Prove that X is complete.
.4
Show that the following are equivalent conditions on X.
(i) Every continuous function f : X →R is uniformly continuous.
(ii) ρ(S, T) > 0 for all nonempty disjoint closed subsets S, T of X.
(To prove that (ii) implies (i), suppose that f : X →R is continuous
but not uniformly continuous. Then there exist sequences (xn), (yn)
in X and a positive number α such that limn→∞ρ(xn, yn) = 0 and
|f(xn) −f(yn)| ≥α for all n. Consider the sets S = {xn : n ≥1} and
T = {yn : n ≥1} .)
3.3
Compactness
In the context of a metric space, the various notions associated with the
word compactness represent diﬀerent generalisations of, and approxima-
tions to, ﬁniteness.
Let S be a subset of a metric space (X, ρ). By a cover of S we mean a
family U of subsets of X such that S ⊂ U; we then say that S is covered
by U, and that U covers S. If also each U ∈U is an open subset of X, we
refer to U as an open cover of S. On the other hand, if U is a ﬁnite set, we
call it a ﬁnite cover of S. By a subcover of U we mean a subfamily F of U
that covers S.
A metric space X is called compact, or a compact space, if every open
cover of X contains a ﬁnite subcover. By a compact set in a metric space
X we mean a subset of X that is compact when considered as a metric
subspace of X.
Note that we can apply our deﬁnition of compactness to a topological
space X, even if the topology of X is not metrisable.

3.3 Compactness
147
The Heine–Borel–Lebesgue Theorem (1.4.6) shows that a bounded closed
interval in R is compact.
(3.3.1) Proposition.
A compact subset of a metric space is separable
and bounded.
Proof.
Let S be a compact subset of a metric space X. We may assume
that S is nonempty. For each positive integer n the family (B(s, n−1))s∈S
of open balls is an open cover of S, so there exists a ﬁnite subset Fn of S
such that S is covered by the balls B(s, n−1) with s ∈Fn. It follows that
the countable set ∞
n=1 Fn is dense in S, which is therefore separable.
Now ﬁx s1 ∈F1, and deﬁne the nonnegative number
R = max{ρ(s, s1) : s ∈F1}.
For each x ∈S choose s ∈F1 such that ρ(x, s) < 1; then
ρ(x, s1) ≤ρ(x, s) + ρ(s, s1) < 1 + R.
Hence S is bounded.
2
(3.3.2) Proposition.
A compact set in a metric space is closed.
Proof.
Let S be a compact subset of a metric space X. We may assume
that X\S is nonempty. If a ∈X\S, then for each s ∈S,
0 < rs = ρ(a, s).
The open balls B(s, 1
2rs), with s ∈S, form an open cover of S, so there
exists a ﬁnite subset F of S such that S is covered by the balls B(s, 1
2rs)
with s ∈F. Deﬁne the positive number
r = min{rs : s ∈F}.
For each x ∈S choose s ∈F such that x ∈B(s, 1
2rs); then
ρ(a, x) ≥ρ(a, s) −ρ(x, s)
≥rs −1
2rs
≥1
2r.
It follows that B(a, 1
2r) ⊂X\S and therefore that a is an interior point
of X\S. Since a is any point of X\S, we conclude that X\S is open and
therefore that S is closed.
2
(3.3.3) Proposition.
A compact metric space is complete.

148
3. Analysis in Metric Spaces
Proof.
Let X be a compact metric space, and -
X its completion (Exercise
(3.2.10: 8)). By Proposition (3.3.2), X is a closed subspace of -
X. Since -
X
is complete, it follows from Proposition (3.2.9) that X is complete.
2
(3.3.4) Proposition.
A closed subset of a compact metric space is
compact.
Proof.
Let S be a closed subset of a compact metric space X, and let U
be an open cover of S. By Proposition (3.1.5), for each U ∈U there exists
an open set VU in X such that U = S ∩VU. Then X\S and the sets VU,
with U ∈U, form an open cover of X. Since X is compact, there exist
ﬁnitely many sets U1, . . . , Un in U such that
{X\S} ∪{VU1, . . . , VUn}
is an open cover of X. Clearly, {U1, . . . , Un} covers S and so is a ﬁnite
subcover of U; whence S is compact.
2
(3.3.5) Exercises
.1
Find an alternative proof of Proposition (3.3.2).
.2
Find an alternative proof of Proposition (3.3.3). (Suppose that X is
compact but not complete, and let (xn) be a Cauchy sequence in X
that does not converge and therefore has no convergent subsequence.
Then for each x ∈X there exist rx > 0 and Nx ∈N+ such that
ρ(xn, x) > rx for all n ≥Nx. Cover X by ﬁnitely many of the balls
B(x, 1
2rx).)
.3
Prove that a subset of the Euclidean space Rn is compact if and only
if it is bounded and closed.
.4
A family F of subsets of a set X is said to have the ﬁnite intersection
property if every ﬁnite subfamily of F has a nonempty intersection.
Prove that a metric space X is compact if and only if every family
of closed subsets of X with the ﬁnite intersection property has a
nonempty intersection.
.5
Let K be a compact subset of an open set U ⊂X. Prove that there
exists r > 0 such that if ρ(x, K) ≤r, then x ∈U.
.6
Prove that any open cover of a separable metric space has a countable
subcover. (This is a special case of Lindel¨of’s Theorem; see page 72
of [47].)
(3.3.6) Proposition.
If f is a continuous mapping of a compact metric
space X into a metric space Y , then f(X) is a compact set.

3.3 Compactness
149
Proof.
Let U be an open cover of f(X). By Proposition (3.2.2), the family

f −1(U)
	
U∈U is an open cover of X. Since X is compact, there is a ﬁnite
set F ⊂U such that

f −1(U)
	
U∈F is an open cover of X. Then F is an
open cover of f(X), which is therefore compact.
2
(3.3.7) Exercises
.1
Prove that a continuous mapping f of a compact metric space X into
R is bounded. Prove also that f attains its bounds, in the sense that
there exist points a, b in X such that f(a) = inf f and f(b) = sup f.
.2
Prove that a continuous mapping of a compact space X into R+ has
a positive inﬁmum.
.3
Prove that if f is a continuous one–one mapping of a compact metric
space X onto a metric space Y , then the inverse mapping f −1 : Y →
X is continuous. (Use Proposition (3.2.2).)
.4
A mapping f of a set X into itself is called a self–map of X. By
a ﬁxed point of such a mapping we mean a point x ∈X such that
f(x) = x. Let f be a contractive self–map of a compact metric space
X (see Exercise (3.2.1: 3)). Prove that the mapping x →ρ(x,f(x)) of
X into R is continuous. Applying Exercise (3.3.7: 1) to this mapping,
deduce that f has a ﬁxed point (Edelstein’s Theorem). Prove that
there is no other ﬁxed point of f.
There are other properties of a metric space X that capture the idea of
approximate ﬁniteness and are intimately related to compactness. We say
that X is
• sequentially compact if every sequence in X has a convergent
subsequence;
• totally bounded, or precompact, if for each ε > 0 there exists a ﬁnite
cover of X by subsets of diameter < ε.
Sequential compactness, like compactness, is a topological concept, whereas
total boundedness is a metric notion. An analogue of sequential compact-
ness can be deﬁned for a general topological space; see under “ﬁlters” in [7]
or [47]. For a nonmetric analogue of total boundedness we need the context
of a uniform space, which is also discussed in [7] and [47].
The total boundedness of a metric space X can be expressed diﬀerently.
By an ε–approximation to X we mean a subset S of X such that ρ(x, S) < ε
for each x ∈X. It is easy to show that X is totally bounded if and only
if for each ε > 0 it contains a ﬁnite ε–approximation. Note that since the
empty set is regarded as ﬁnite, it is also totally bounded.

150
3. Analysis in Metric Spaces
Corollary (1.2.8) shows that a bounded closed subset of R is sequentially
compact.
(3.3.8) Exercises
.1
Prove that a bounded interval in R is totally bounded.
.2
Prove that a subset of a totally bounded metric space is totally
bounded.
.3
Prove that if a metric space is either sequentially compact or totally
bounded, then it is bounded.
.4
Show that a totally bounded metric space is separable.
.5
Let f be a uniformly continuous mapping of a totally bounded metric
space into a metric space. Prove that the range of f is totally bounded.
.6
Let X be a metric space that is not totally bounded. Prove that
there exist a sequence (xn) in X and a positive number α such that
ρ(xm, xn) ≥α whenever m ̸= n.
.7
Let f be a function of bounded variation on a compact interval I ⊂R.
Prove that f(I) is totally bounded. (Use the preceding exercise.)
.8
Let X be a metric space that is not totally bounded, and choose
(xn) and α as in Exercise (3.3.8: 6). For each n construct a uniformly
continuous function φn : X →[0, 1] such that (i) φn(xn) = 1 and (ii)
φn(x) = 0 if ρ(x, xn) ≥α/3. Given any sequence (cn) of real numbers,
show that f = ∞
n=1 cnφn is a well–deﬁned continuous function on
X, and that if (cn) is bounded, then f is uniformly continuous on X.
.9
Let (X, ρ) be a separable metric space. Show that there exists on X
a metric d equivalent to ρ, such that (X, d) is totally bounded. (Let
(xn) be a dense sequence in X, and use Exercise (3.2.1: 6) to reduce
to the case where ρ < 1. Deﬁne
d(x, y) =
∞

n=1
2−n |ρ(x, xn) −ρ(y, xn)|
for all x, y ∈X.)
We now arrive at a fundamental theorem linking compactness, sequential
compactness, and total boundedness.
(3.3.9) Theorem.
The following are equivalent conditions on a metric
space (X, ρ).

3.3 Compactness
151
(i) X is compact.
(ii) X is sequentially compact.
(iii) X is totally bounded and complete.
Proof.
First, let X be a compact metric space, and (xn) a sequence in
X. For each n let Fn be the closure of {xn, xn+1, xn+2, . . .} in X. It is
easy to show that (Fn)∞
n=1 has the ﬁnite intersection property. By Exercise
(3.3.5: 4), ∞
n=1 Fn contains a point a. Consider any neighbourhood U of a.
For each n, since a ∈Fn, there exists m ≥n such that xm ∈U. It follows
that U contains xk for inﬁnitely many values of k; whence, by Proposition
(3.2.7), there exists a subsequence of (xn) converging to a. Thus (i) implies
(ii).
Next, let X satisfy (ii). Then any Cauchy sequence in X has a conver-
gent subsequence and so converges to a limit in X, by Exercise (3.2.10: 3);
whence X is complete. Suppose that X is not totally bounded. Then, by
Exercise (3.3.8: 6), there exist a sequence (xn) in X and a positive number
α such that ρ(xm, xn) ≥α whenever m ̸= n. Clearly, (xn) has no Cauchy
subsequences and therefore no convergent subsequences. This contradicts
our assumption (ii); so, in fact, X is totally bounded. Thus (ii) implies (iii).
It remains to prove that (iii) implies (i). Accordingly, let X be totally
bounded and complete, and suppose that there exists an open cover U of
X that contains no ﬁnite subcover. With B0 = X, we construct a sequence
(Bn)∞
n=1 of closed balls in X such that for each n ≥1,
(a) Bn has radius 2−n,
(b) Bn has a nonempty intersection with Bn−1, and
(c) no ﬁnite subfamily of U is a cover of Bn−1.
Having constructed B0, . . . , Bn−1 with the applicable properties, let (Vj)m
j=1
be a ﬁnite cover of Bn−1 by balls in Bn−1 of radius 2−n. (Note that Bn−1
is totally bounded, by Exercise (3.3.8: 2).) Amongst the sets Vj there exists
at least one—call it Bn—that is not covered by ﬁnitely many of the sets in
U: otherwise each of the ﬁnitely many sets Vj, and therefore Bn−1, would
be covered by ﬁnitely many elements of U, thereby contradicting (c). This
completes the inductive construction of Bn.
For each n ≥1 let xn be the centre of Bn. Since Bn ∩Bn−1 is nonempty,
it follows from the triangle inequality that for n ≥2,
ρ(xn, xn−1) ≤2−n + 2−n+1 < 2−n+2.
So if j > i ≥N ≥1, then
ρ(xi, xj) ≤
j

k=i+1
ρ(xk, xk−1)

152
3. Analysis in Metric Spaces
<
j

k=i+1
2−k+2
< 2−i+1
∞

k=0
2−k = 2−i+2 ≤2−N+2.
Hence (xn) is a Cauchy sequence in X and so, as X is complete, converges
to a limit x∞in X. Now pick U ∈U such that x∞∈U. Since U is open,
there exists r > 0 such that B(x∞, r) ⊂U. Choosing N > 1 such that
ρ(x∞, xN) < r/2 and 2−N < r/2, we see that for each x ∈BN,
ρ(x, x∞) ≤ρ(x, xN) + ρ(x∞, xN) < 2−N + r/2 < r,
so x ∈B(x∞, r). Hence BN ⊂B(x∞, r) ⊂U, which contradicts (c). It
follows that our initial assumption about the open cover U is false; whence
X is compact, and therefore (iii) implies (i).
2
The proof that (iii) implies (i) in Theorem (3.3.9) is a generalisation of
the argument we used to prove the Heine–Borel–Lebesgue Theorem (1.4.6).
(3.3.10) Exercises
.1
Use sequential compactness arguments to show that a compact subset
of a metric space is both bounded and closed.
.2
Show that if X is compact, then there exist points a, b of X such that
ρ(a, b) = diam(X).
.3
Let A, B be nonempty disjoint subsets of a metric space X with A
closed and B compact. Give two proofs that ρ(A, B) > 0.
.4
Let (Sn) be a descending sequence of compact sets in a metric space
X (so S1 ⊃S2 ⊃· · ·). Prove, in at least two diﬀerent ways, that if
Sn ̸= ∅for all n, then ∞
n=1 Sn ̸= ∅.
.5
Let X be a compact space in which each point x is isolated (see
Exercise (3.1.8: 5)). Give at least two proofs that X is ﬁnite.
.6
Prove that if every continuous mapping of X into R is bounded, then
X is compact. (First suppose that X is not totally bounded, and use
Exercise (3.3.8: 8) to construct an unbounded continuous mapping of
X into R. Then use Exercise (3.2.11: 9).)
Is this true if “continuous” is replaced by “uniformly continuous” in
the hypothesis?
.7
Prove that if every uniformly continuous mapping of X into R+ has
a positive inﬁmum, then X is compact. (cf. Exercise (3.3.7: 2). Use
Exercises (3.3.8: 8), (3.2.11: 5), and (3.2.11: 8).)

3.3 Compactness
153
.8
Let (X, ρ) be a metric space, and suppose that X is complete with
respect to every metric equivalent to ρ (see Exercise (3.1.3: 6)). Prove
that X is compact. (Suppose that X is not totally bounded. By Exer-
cise (3.3.8: 6), there exist a sequence (xn) in X and a positive number
α such that ρ(xm, xn) ≥α whenever m ̸= n. Show that
d(x, y) = min
*
ρ(x, y),
inf
m,n≥1

ρ(x, xm) +
  1
m −1
n
  α + ρ(y, xn)
+
deﬁnes a metric equivalent to ρ with respect to which X is not
complete.)
.9
Prove that the following are equivalent conditions on a metric space
(X, ρ).
(i) If d is a metric equivalent to ρ, and S, T are disjoint closed
subsets of (X, d), then d(S, T) > 0.
(ii) X is compact.
(Use Exercises (3.3.10: 3), (3.2.10: 6), and (3.3.10: 8); also, note the
guide to the solution of Exercise (3.3.5: 2).)
The following property of a metric space X is known as the Lebesgue
covering property.
For each open cover U of X there exists r > 0 such that any
open ball of radius r in X is contained in some U ∈U.
The positive number r associated with the open cover U in this way is
called a Lebesgue number for U.
(3.3.11) Proposition.
A compact metric space has the Lebesgue cover-
ing property.
Proof.
Let X be a compact metric space, and U an open cover of X. For
each x ∈X choose rx > 0 such that B(x, 2rx) ⊂U for some U ∈U. The
balls B(x, rx), with x ∈X, form an open cover of X, from which we can
extract a ﬁnite subcover, say
{B(xi, rxi) : 1 ≤i ≤n} .
Then
0 < r = min {rx1, . . . , rxn} .
Given x ∈X, choose i such that x ∈B(xi, rxi). Then for each y ∈B(x, r)
we have
ρ(y, xi) ≤ρ(x, y) + ρ(x, xi) < r + rxi ≤2rxi.

154
3. Analysis in Metric Spaces
So
B(x, r) ⊂B(xi, 2rxi) ⊂U
for some U ∈U.
2
The implications (i) ⇒(ii) ⇒(iii) of the ﬁrst part of the next result—a
general version of the Uniform Continuity Theorem for metric spaces—are
well known, in contrast to the implication (iii) ⇒(i), which is due to Wong
[55].
(3.3.12) Theorem.
The following are equivalent conditions on a metric
space X.
(i) X has the Lebesgue covering property.
(ii) Every continuous mapping of X into a metric space is uniformly
continuous.
(iii) Every continuous mapping of X into R is uniformly continuous.
Proof.
Assuming (i), let f be a continuous mapping of X into a metric
space, and let ε > 0. For each t ∈X there exists δt > 0 such that if
ρ(x, t) < δt, then ρ(f(x), f(t)) < ε/2. It follows from the triangle inequality
that if x and y belong to B(t, δt), then ρ(f(x), f(y)) < ε. Let δ > 0 be a
Lebesgue number for the open cover (B(t, δt))t∈X of X. If x and y are
points of X such that ρ(x, y) < δ, then both x and y belong to B(x, δ),
which is a subset of B(t, δt) for some t; so ρ(f(x), f(y)) < ε. Thus f is
uniformly continuous, and therefore (i) implies (ii).
It is trivial that (ii) implies (iii). To complete the proof, suppose that X
does not have the Lebesgue covering property; so there exists an open cover
U of X for which there is no Lebesgue number. For each positive integer
n we can therefore construct xn ∈X such that B(xn, n−1)\U is nonempty
for each U ∈U. Then there exists yn ∈B(xn, n−1)\ {xn} : for otherwise
we would have
B(xn, n−1) = {xn} ⊂U
for some U ∈U. We show that
neither (xn) nor (yn) has a convergent subsequence.
(1)
Indeed, if (xn) had a subsequence that converged to a limit ξ ∈X, then,
choosing U ∈U such that ξ ∈U, we would have B(xn, n−1) ⊂U for
some n, a contradiction. On the other hand, if (ynk)∞
k=1 were a convergent
subsequence of (yn), then the subsequence (xnk) of (xn) would converge to
the same limit, which contradicts what we have just proved.

3.3 Compactness
155
Setting n1 = 1, suppose we have constructed n1 < n2 < · · · < nk such
that the sets
Sk = {xn1, . . . , xnk} ,
Tk = {yn1, . . . , ynk}
are disjoint. There exists nk+1 > nk such that xnk+1 /∈Sk and ynk+1 /∈Tk:
otherwise we would have either xj ∈Sk for inﬁnitely many j or else yj ∈Tk
for inﬁnitely many j; since Sk and Tk are ﬁnite, this would imply that either
(xn) or (yn) had a convergent subsequence, thereby contradicting (1). Thus
we have inductively constructed a strictly increasing sequence (nk)∞
k=1 of
positive integers such that the sets
S = {xnk : k ≥1} ,
T = {ynk : k ≥1}
are disjoint. These sets are both closed in X: for example, any point of
S\S would be the limit of some subsequence of (xn), which contradicts
(1). Applying Urysohn’s Lemma (Exercise (3.2.14: 1)), we now construct a
continuous function f : X →[0, 1] such that f(S) = {0} and f(T) = {1} .
Since ρ(xnk, ynk) < 1/nk but |f(xnk) −f(ynk)| = 1, the function f is not
uniformly continuous. Hence (iii) implies (i).
2
(3.3.13) Corollary—The Uniform Continuity Theorem.
Every
continuous mapping of a compact metric space into a metric space is
uniformly continuous.
Proof.
This follows from the preceding two results.
2
The converse of Corollary (3.3.13) is not true, since every function from
the discrete metric space N to R is uniformly continuous but N, being un-
bounded, is not compact. However, there is an interesting partial converse
to Corollary (3.3.13), which we discuss in Section 4.
(3.3.14) Exercises
.1
Use a sequential compactness argument to prove that a compact
metric space has the Lebesgue covering property.
.2
Give an example of a totally bounded metric space for which the
Lebesgue covering property does not hold.
.3
Prove that X has the Lebesgue covering property if and only if for
each nonempty closed set S ⊂X and each open set U containing S,
there exists r > 0 such that the r–enlargement of S,
B(S, r) = {x ∈X : ρ(x, S) < r} ,

156
3. Analysis in Metric Spaces
is contained in U. (For “only if”, consider the open cover {X\S, U}
of X. For “if”, suppose that X does not have the Lebesgue cov-
ering property and, as in the second part of the proof of Theo-
rem (3.3.12), construct disjoint nonempty closed subsets S, T of X
such that ρ(S, T) = 0; then show that there exists r > 0 such that
B(S, r) ⊂X\T.)
.4
Prove that a metric space with the Lebesgue covering property is
complete. Need it be totally bounded?
.5
Let X have the Lebesgue covering property, and let Y be a closed
subset of X. Give two proofs that Y has the Lebesgue covering prop-
erty. (For one proof, use the Tietze Extension Theorem; for another,
work directly with an open cover of Y.)
.6
Prove the Uniform Continuity Theorem using sequential compactness
without the Lebesgue covering property.
.7
Let X be a metric space, and h a mapping of X into a compact
metric space Y. Suppose that f ◦h is uniformly continuous for each
continuous (and therefore uniformly continuous) mapping f : Y →R.
Give at least two proofs that h is uniformly continuous.
The notion of compactness can be generalised in a number of ways. The
one we deal with is typical of topology, in that it replaces a global property
(one that holds for the whole space) by a local one (one that holds in some
neighbourhood of any given point).
A metric space X is said to be locally compact, or a locally compact
space, if each point in X has a compact neighbourhood in X. For example,
although (in view of Proposition (3.3.1)) R is not compact, it is locally
compact: if x ∈R, then [x −1, x + 1] is a compact neighbourhood of x in
R. Of course, a compact metric space is locally compact.
(3.3.15) Proposition.
Let X be a locally compact space, and S a subset
of X. If either S is open or S is closed, then S is locally compact.
Proof.
Let a ∈S, and choose a compact neighbourhood K of a in X. If
S is open, then
a ∈(K ∩S)◦= K◦∩S◦,
so there exists r > 0 such that B(a, r) ⊂K and B(a, r) ⊂S. As B(a, r) is
closed in X, it is closed in K (by Proposition (3.1.5)) and therefore compact
(by Proposition (3.3.4)). Hence a has a compact neighbourhood in S, and
so S is locally compact.
Now suppose that S is closed in X. Since K is a neighbourhood of a in
X, K ∩S is a neighbourhood of a in S (Exercise (3.1.6: 4)). Also, K ∩S is

3.3 Compactness
157
closed in K, by Proposition (3.1.5), and therefore compact, by Proposition
(3.3.4). Hence S is locally compact.
2
(3.3.16) Exercises
.1
Let S and T be locally compact subspaces of a locally compact metric
space X. Prove that S ∩T is locally compact. Need S ∪T be locally
compact?
.2
Is every locally compact space complete?
.3
Let X be a metric space in which every bounded set is contained in
a compact set. Prove that X is locally compact and separable.
.4
Let X be locally compact, and K a compact subset of X. Prove that
for some r > 0 the closure of the r–enlargement of K is compact.
(See Exercise (3.3.14: 3).)
.5
Let X be a separable locally compact metric space. Show that there
exists a sequence (Vn) of open subsets of X, each of which has compact
closure, with the property that for each x ∈X and each neighbour-
hood U of x there exists n such that x ∈Vn ⊂U. Hence prove that
there exists a sequence (Un) of open subsets of X with the following
properties.
(i) Un is compact;
(ii) Un ⊂Un+1;
(iii) X = ∞
n=1 Un.
(Set U1 = V1 and Un+1 = Vn+1 ∪B(Un, r), where, using Exercise
(3.3.16: 4), r > 0 is chosen to make the closure of B(Un, r) compact.)
.6
Let X be a separable locally compact metric space that is not com-
pact, and let (Un) be as in the preceding exercise. Use Urysohn’s
Lemma (Exercise (3.2.14: 1)) to show that there exists a continuous
function f : X →R such that f(x) ≤n for all x ∈Un, and f(x) ≥n
for all x ∈X\Un. Then show that
d(x, y) = ρ(x, y) + |f(x) −f(y)|
deﬁnes a metric d equivalent to ρ, and that in the space (X, d) any
bounded set is contained in a compact set.

158
3. Analysis in Metric Spaces
3.4
Connectedness
In analysis there are many situations where progress is made by restrict-
ing attention to parts of a metric space that cannot be split into smaller,
separated parts. Our next deﬁnition captures this imprecise idea formally.
A metric space is said to be connected, or a connected space, if it can
not be expressed as a union of two disjoint nonempty open subsets. So
if X is connected, and if S, T are nonempty open subsets of X such that
S ∪T = X, then S ∩T ̸= ∅. A subspace that is connected is called a
connected set in the metric space. Clearly, the empty subset of any metric
space is connected.
(3.4.1) Proposition.
The following are equivalent conditions on a
metric space X.
(i) X is connected.
(ii) X is not a union of two disjoint nonempty closed subsets.
(iv) The only subsets of X that are both open and closed in X are X and
the empty subset.
Proof.
The straightforward proof is left as the next exercise.
2
(3.4.2) Exercises
.1
Prove Proposition (3.4.1).
.2
Prove that a metric space X is connected if and only if there is no
continuous mapping of X onto {0, 1} .
We showed in Proposition (1.3.13) that the only subsets of R that are
both open and closed are R and ∅. It follows from Proposition (3.4.1) that
R is connected. In fact, we can say more.
(3.4.3) Proposition.
A nonempty subset of R is connected if and only
if it is an interval.
Proof.
Let S be a nonempty subset of R, and suppose ﬁrst that S is
connected. Let a, b be points of S with a ≤b, and consider any x such that
a ≤x ≤b. If x /∈S, then S is the union of the disjoint subsets S ∩(−∞, x)
and S ∩(x, ∞), each of which is open in S, by Proposition (3.1.5). This
contradicts the assumption that S is connected. So x ∈S, and therefore S
has the intermediate value property. Hence, by Proposition (1.3.3), S is an
interval.
Now let S be an interval in R, and suppose that S is not connected.
Then there exist nonempty open subsets A, B of the subspace S such that

3.4 Connectedness
159
S = A ∪B and A ∩B = ∅. We may assume that there exist a ∈A and
b ∈B such that a < b. Let x be the supremum of the nonempty bounded
set A ∩[a, b), and suppose that x ∈A. Then a ≤x < b, as b /∈A. Since A
is open in S, there exists r > 0 such that S ∩[x, x + r] ⊂A ∩[a, b). Being
an interval, S has the intermediate value property (Proposition (1.3.3)), so
[a, b] ⊂S, and therefore [x, x + r] ⊂S. Hence x + r ∈A ∩[a, b), which
contradicts the deﬁnition of x. Thus, in fact, x /∈A. A similar argument
shows that x /∈B, which is absurd since, as we have already observed,
[a, b] ⊂S. This contradiction shows that S is connected.
2
(3.4.4) Exercise
Let S, T be nonempty closed subsets of a metric space X such that
S ∪T and S ∩T are connected. Prove that S and T are connected.
Give an example to show that the conclusion no longer holds if we
remove the hypothesis that S and T are closed.
We now prove some general results about connected spaces.
(3.4.5) Proposition.
I f S, T are subsets of a metric space X such that
S is connected and S ⊂T ⊂S, then T is connected. In particular, S is
connected.
Proof.
Suppose that A, B are nonempty open sets in the subspace T such
that T = A ∪B and A ∩B = ∅. As S is dense in T, both S ∩A and S ∩B
are nonempty. They are clearly disjoint, and, by Proposition (3.1.5), they
are open in S. Since S = (S ∩A) ∪(S ∩B), we have contradicted the fact
that S is connected.
2
(3.4.6) Proposition.
If F is a family of connected sets in a metric space
X such that  F is nonempty, then  F is connected.
Proof.
Let S =  F and a ∈ F. Suppose that S = A ∪B, where
A, B are nonempty disjoint open sets in S. Consider, for example, the case
where a ∈A. Choose F ∈F such that B ∩F is nonempty, and note that
a ∈A ∩F. Then A ∩F and B ∩F are open in F (by Proposition (3.1.5)),
have union F, are disjoint, and are nonempty. This contradicts the fact
that F is connected.
2
(3.4.7) Exercises
.1
Let S, T be connected subsets of a metric space X such that S ∩T
is nonempty. Prove that S ∪T is connected.
.2
Let (Sn) be a sequence of connected subsets of a metric space X such
that Sn ∩Sn+1 is nonempty for each n. Prove that  Sn is connected.

160
3. Analysis in Metric Spaces
.3
A metric space X is said to be chain connected if for each pair a, b
of points of X, and each ε > 0, there exist ﬁnitely many points
a = x0, x1, . . . , xn = b such that ρ(xi, xi+1) < ε for i = 0, . . . , n −1.
Prove that a compact, chain connected metric space is connected.
.4
If X is a metric space, then it follows from Proposition (3.4.6) that
for each x ∈X,
Cx =

{S ⊂X : S is connected and x ∈S}
is connected. Cx is called the connected component of x in X. Prove
the following statements.
(i) Cx is closed in X.
(ii) Cx is the largest connected subset of X that contains x.
(iii) If y ∈Cx, then Cy = Cx.
(iv) If y /∈Cx, then Cy ∩Cx = ∅.
.5
A subset S of a metric space X is said to be totally disconnected if
for each x ∈X the connected component of x in S is {x}. Prove that
(i) every countable subset of R is totally disconnected;
(ii) the irrational numbers form a totally disconnected set in R.
.6
A metric space X is said to be locally connected if for each x ∈X and
each neighbourhood U of X there exists a connected neighbourhood
V of x with V ⊂U. Prove that X is locally connected if and only if
the following property holds: for each open subset S of X, and each
x ∈S, the connected component of x in the subspace S is an open
subset of X.
.7
Use Proposition (3.4.3) and the previous exercise to give another
proof of Proposition (1.3.6).
.8
Let X be a connected space, and S a nonempty subset of X such that
X\S is also nonempty. Show that the boundary of S is nonempty.
(Suppose the contrary.)
(3.4.8) Proposition.
The range of a continuous mapping from a
connected metric space into a metric space is connected.
Proof.
Let X be a connected space, and f a continuous mapping of
X into a metric space Y . Suppose that f(X) = S ∪T, where S, T are
nonempty disjoint open sets in the subspace f(X) of Y . By Proposition

3.4 Connectedness
161
(3.2.2), the nonempty disjoint sets f −1(S) and f −1(T) are open in X.
Since
X = f −1 (f(X)) = f −1(S ∪T) = f −1(S) ∪f −1(T),
it follows that X is not connected, a contradiction.
2
A very important consequence of Proposition (3.4.8) is the following
generalised Intermediate Value Theorem.
(3.4.9) Theorem.
Let f be a continuous mapping of a connected metric
space X into R, and a, b points of f(X) such that a < b. Then for each
y ∈(a, b) there exists x ∈X such that f(x) = y.
Proof.
By Propositions (3.4.8) and (3.4.3), f(X) is an interval. The result
follows immediately.
2
(3.4.10) Exercises
.1
Let X be an unbounded connected metric space. Prove that for each
x ∈X and each r > 0 there exists y ∈X such that ρ(x, y) = r.
.2
Let S be a connected subset of the Euclidean space Rn. Prove that
for each r > 0 the set
{x ∈Rn : ρ(x, S) ≤r}
is also connected.
.3
Let X be a compact metric space, and suppose that the closure of
any open ball B(a, r) in X is the closed ball B(a, r). Show that any
open or closed ball in X is connected. (Suppose that B(a, r) = S ∪T,
where S, T are nonempty, disjoint, and closed in the subspace B(a, r).
Without loss of generality take a in A. Show that
C = {x ∈X\S : ρ(a, x) ≥ρ(a, T)}
is compact, and hence that there exists t0 ∈T such that ρ(a, t0) =
ρ(a, T) > 0. Then consider B(a, ρ(a, T)).)
Show by an example that we cannot remove the compactness of X
from the hypotheses of this result.
We now prove the partial converse to Corollary (3.3.13) that was
postponed from Section 3.
(3.4.11) Proposition.
Let X be a connected metric space such that ev-
ery continuous function from X to R is uniformly continuous. Then X is
compact.

162
3. Analysis in Metric Spaces
Proof.
Suppose that X is not totally bounded. By Exercise (3.3.8: 6),
there exist a sequence (xn) in X and a positive number α such that
ρ(xm, xn) ≥α whenever m ̸= n. Using Exercise (3.3.8: 8), we can con-
struct, for each k, a uniformly continuous function φk : X →[0, 1] such
that φk(xk) = 1, φk(x) = 0 if ρ(x, xk) ≥α/3, and f = ∞
n=1 nφn is a
well–deﬁned continuous function on X; to be precise, we set
φk(x) = max

0, 1 −3α−1ρ(x, xk)

.
Our hypotheses ensure that f is uniformly continuous. Now, X is con-
nected, the mapping x →ρ(x, xn) is continuous on X, ρ(xn, xn) = 0, and
ρ(xn+1, xn) ≥α. It follows from Theorem (3.4.9) that there exists x ∈X
such that ρ(x, xn) = α/3n. Then
f(xn) −f(x) = n −(n −1) = 1.
Since n > 1 is arbitrary, f is not uniformly continuous. This contradiction
shows that X is totally bounded.
Now suppose that X is not complete; so there exists a Cauchy sequence
(xn) in X that does not converge to a limit in X. Without loss of generality
we may assume that X is a dense subset of its completion ( -
X, ρ). So (xn)
converges to a limit x∞∈-
X\X. The function x →ρ(x, x∞) is (uniformly)
continuous and positive–valued on X, so
f(x) =
1
ρ(x, x∞)
deﬁnes a continuous mapping f : X →R+. By our hypotheses, f is uni-
formly continuous on X, so there exists δ > 0 such that if x, y ∈X and
ρ(x, y) < δ, then |f(x) −f(y)| < 1. Choose N such that ρ(xm, xn) < δ for
all n ≥N. Since ρ(xN, x∞) > 0, there exist positive integers k, m such that
m > N and
ρ(xm, x∞) <
1
k + 1 < 1
k < ρ(xN, x∞).
Then ρ(xm, xN) < δ but
f(xm) −f(xN) > (k + 1) −k = 1,
contrary to our choice of δ. Hence, in fact, X is complete and therefore, by
Theorem (3.3.9), compact.
2
There is another type of connectedness of importance in analysis and
topology, one that generalises the informal idea that a subset X of the
Euclidean plane is in one piece if any two points of X can be joined by
a path that lies wholly in X. (In spite of this correct claim about the
importance of this type of connectedness, we do not actually use it later in
the book; so you can ignore the rest of this section with impunity.)

3.4 Connectedness
163
Let X be a metric space. A continuous mapping f : [0, 1] →X such that
f(0) = a and f(1) = b is called a path in X with endpoints a and b, or a
path in X from a to b ; the path f is also said to join a to b. We say that X
is path connected, or a path connected space, if for each pair a, b of points
of X there is a path in X from a to b. By a path connected subset of X we
mean a subset of X that is path connected as a subspace of X.
A subset S of Rn is said to be convex if tx + (1 −t)y ∈S whenever
x, y ∈S and 0 ≤t ≤1. A convex subset S of Rn is path connected: for if
a, b ∈S, then
f(t) = (1 −t)a + tb
(0 ≤t ≤1)
deﬁnes a path in S from a to b. In particular, an interval in R is path
connected.
(3.4.12) Proposition.
A path connected space is connected.
Proof.
Let X be a path connected space; we may assume that X is
nonempty. Let a ∈X, and for each x ∈X let fx be a path in X joining a to
x; for convenience, let I = [0, 1]. Then fx(I) is connected, by Propositions
(3.4.3) and (3.4.8), and a ∈fx(I). Hence, by Proposition (3.4.6), X =

x∈X fx(I) is connected.
2
Propositions (3.4.3) and (3.4.12) show that path connectedness and con-
nectedness are equivalent properties of a nonempty subset S of R, and hold
precisely when S is an interval. In R2, however, there are subsets that are
connected but not path connected; see Exercise (3.4.16: 1). Our next result
is therefore substantial.
(3.4.13) Proposition.
A connected open subset of Rn is path connected.
In order to prove Proposition (3.4.13) we need some simple consequences
of the following Glueing Lemma.
(3.4.14) Lemma.
Let X, Y be metric spaces, and let A, B be closed sub-
sets of X whose union is X. Let f : A →Y and g : B →Y be continuous
functions such that f(x) = g(x) for all x ∈A ∩B. Then the function
h : X →Y deﬁned by
h(x) =



f(x)
if x ∈A
g(x)
if x ∈B
is continuous.
Proof.
Let C be a closed subset of Y . Then, by Proposition (3.2.2),
f −1(C) is closed in the subspace A of X,and hence, by Exercise (3.1.6: 3),
in X. Similarly, g−1(C) is closed in X. Hence
h−1(C) = f −1(C) ∪g−1(C)

164
3. Analysis in Metric Spaces
is closed in X. It follows from Proposition (3.2.2) that h is continuous.
2
Now consider two paths f, g in a metric space X such that f(1) = g(0).
We deﬁne the product of the paths f and g to be the path gf, where
gf(t) =



f(2t)
if 0 ≤t ≤1
2
g(2t −1)
if 1
2 ≤t ≤1.
It follows from Proposition (3.4.14) that gf is a path in X joining f(0) to
g(1).
The product gf of two paths must not be confused with the composite
g ◦f of two mappings. Indeed, unless f is a path in [0, 1], the composite of
the paths f and g is undeﬁned.
(3.4.15) Exercise
We deﬁne the path component of a point x in a metric space X to be
Px = {y ∈X : there exists a path in X from x to y}.
Prove that Px is the union of the path connected subsets of X that
contain x, and that it is the largest path connected subset of X
containing x. Prove also that if x, y ∈X, then either Px = Py or
Px ∩Py = ∅.
Proof of Proposition (3.4.13).
Let U be a connected open subset of
Rn. For each x in U let Ux be the path component of x in U; we ﬁrst show
that Ux is open in U. Given y in Ux, choose a path f in U joining x to y;
choose also r > 0 such that B(y, r) ⊂U. Since B(y, r) is convex, for each
z ∈B(y, r) there exists a path g in B(y, r) joining y to z; then gf is a path
in U joining x to z. Hence B(y, r) ⊂Ux, ,and therefore Ux is open in U.
Now suppose that U is not path connected. Then there exist distinct
points of U that cannot be joined by a path in U. Let a be one of these
points. By the foregoing, Ua is nonempty and open in U, as is
V =

{Ux : x ∈U\Ua}.
Moreover, U = Ua ∪V . Since U is connected, Ua ∩V is nonempty, so
there exists b ∈U\Ua such that Ua ∩Ub ̸= ∅. Exercise (3.4.15) shows that
Ua = Ub; whence b ∈Ua, a contradiction. Thus U is path connected.
2
(3.4.16) Exercises
.1
Let
A
=

(0, y) ∈R2 : −1 ≤y ≤1

,
B
=

(x, y) ∈R2 : 0 < x ≤1, y = sin π
x

,

3.5 Product Metric Spaces
165
and X = A∪B. Prove that any connected subset of X that intersects
both A and B has diameter greater than 2. Then prove that X is not
path connected. (Suppose there exists a path f : [0, 1] →X with
f(0) ∈A and f(1) ∈B. Let
τ = sup {t ∈[0, 1] : f ([0, t]) ⊂A} ,
and show that there exists τ ′ > τ such that f(τ ′) ∈B and the
diameter of f ([τ, τ ′]) is less than 1.)
.2
Let F be a family of path connected subsets of a metric space X such
that  F ̸= ∅. Prove that  F is path connected.
.3
Let (Sn)∞
n=1 be a sequence of path connected subsets of a metric space
X such that for each n ≥1,
Sn ∩
n−1

i=1
Si ̸= ∅.
Prove that ∞
n=1 Sn is path connected.
3.5
Product Metric Spaces
Let (X1, ρ1) and (X2, ρ2) be nonempty2 metric spaces, and X their Carte-
sian product X1 × X2. Throughout this section we use such notations as
x = (x1, x2), x′ = (x′
1, x′
2), and a = (a1, a2) for points of X; we write
Bk(ak, r) (respectively, Bk(ak, r)) for the open (respectively, closed) ball
in Xk with centre ak and radius r.
It is a simple exercise to show that the mapping ρ : X × X →R deﬁned
by
ρ(x, y) = max{ρ1(x1, y1), ρ2(x2, y2)}
is a metric—called the product metric—on X; taken with this metric, X
is called the product of the metric spaces X1 and X2. We assume that X
carries this metric in the remainder of this section.
There are at least two other natural metrics on the set X: namely, the
metrics ρ′ and ρ′′ deﬁned by
ρ′(x, y) =

ρ1(x1, y1)2 + ρ2(x2, y2)2
and
ρ′′(x, y) = ρ1(x1, y1) + ρ2(x2, y2).
2The requirement that X1 and X2 be nonempty enables us to avoid some
minor complications.

166
3. Analysis in Metric Spaces
Since
ρ(x, y) ≤ρ′(x, y) ≤ρ′′(x, y) ≤2ρ(x, y),
the identity mapping iX (see Exercise (3.2.1: 1)) is uniformly continuous
when its domain and range are given any of the metrics ρ, ρ′, ρ′′. Hence,
in particular, each of these three metrics gives rise to the same topology
(family of open sets) on X; that is, the metrics are equivalent (see Exercise
(3.1.3: 6)).
(3.5.1) Lemma.
The open ball with centre a and radius r in the product
space X is B1(a1, r)×B2(a2, r), and the closed ball with centre a and radius
r in X is B1(a1, r) × B2(a2, r).
Proof.
For example, we have
ρ(a, x) < r
⇔
max{ρ1(a1, x1), ρ2(a2, x2)} < r
⇔
ρ1(a1, x1) < r and ρ2(a2, x2) < r,
so B(a, r) = B1(a1, r) × B2(a2, r).
2
(3.5.2) Proposition.
If A1 is open in X1, and A2 is open in X2, then
A1 × A2 is open in X.
Proof.
Let
a ∈A = A1 × A2.
Then a1 ∈A1 and a2 ∈A2; so there exist r1, r2 > 0 such that B1(a1, r1) ⊂
A1 and B2(a2, r2) ⊂A2. Let r = min{r1, r2}; then by Lemma (3.5.1),
B(a, r) ⊂B1(a1, r1) × B2(a2, r2) ⊂A.
Hence a ∈A◦, and so A is open in X.
2
(3.5.3) Corollary.
If Uk is a neighbourhood of xk in Xk, then U1 × U2
is a neighbourhood of x in X.
Proof.
Choose an open set Ak in Xk such that xk ∈Ak ⊂Uk. Then
(x1, x2) ∈A1 × A2 ⊂U1 × U2,
where, by the previous proposition, A1 × A2 is an open subset of X.
2
The mapping prk : X →Xk deﬁned by
prk(x1, x2) = xk
is called the projection of X onto Xk.

3.5 Product Metric Spaces
167
(3.5.4) Proposition.
If A is an open set in X, then prk(A) is open in
the space Xk.
Proof.
Consider any x1 ∈X1. Either
A(x1) = {x2 ∈X2 : (x1, x2) ∈A}
is empty and therefore open, or else there exists x2 ∈A(x1). In the latter
case, since A is open, we can choose r > 0 such that B(x, r) ⊂A, where
x = (x1, x2). If x′
2 ∈X2 and ρ2(x2, x′
2) < r, then
ρ(x, (x1, x′
2)) = ρ2(x2, x′
2) < r,
so (x1, x′
2) ∈A. Hence A(x1) is open in this case also. Since
pr2(A) =

x1∈X1
A(x1),
a union of open sets, it follows that pr2(A) is open in X2. A similar
argument shows that pr1(A) is open in X1.
2
Note that the projections of a closed subset of X need not be closed; see
the remarks following the proof of Proposition (3.2.2) on page 137.
(3.5.5) Proposition.
If A1 ⊂X1 and A2 ⊂X2, then
A1 × A2 = A1 × A2.
Proof.
Let a ∈A1 × A2. Then for each ε > 0 there exist x1 ∈A1 and
x2 ∈A2 such that ρ1(a1, x1) < ε and ρ2(a2, x2) < ε; whence ρ(a, x) < ε,
where
x = (x1, x2) ∈A1 × A2.
Thus A1 × A2 ⊂A1 × A2.
On the other hand, if a /∈A1 × A2, then either a1 /∈A1 or a2 /∈A2.
Taking, for example, the ﬁrst alternative, we see from Exercise (3.1.3: 3)
and Corollary (3.5.3) that the set (X1\A1) × X2, which is clearly disjoint
from A1 × A2, is a neighbourhood of a; thus a /∈A1 × A2. Hence
X\

A1 × A2
	
⊂X\A1 × A2,
so A1 × A2 ⊂A1 × A2, and therefore A1 × A2 = A1 × A2.
2
(3.5.6) Corollary.
A1 × A2 is closed in X if and only if Ak is closed
in Xk for each k.
Proof.
This follows immediately from the last proposition.
2

168
3. Analysis in Metric Spaces
A mapping f from a set E into X = X1 × X2 can be identiﬁed with the
ordered pair (pr1 ◦f, pr2 ◦f); where there is no risk of confusion, we write
fk for the mapping prk ◦f of E into Xk, so that f = (f1, f2).
(3.5.7) Proposition.
Let f be a mapping of a metric space (E, d) into
X. Then f is continuous at a ∈E if and only if both f1 and f2 are
continuous at a.
Proof.
Suppose that for each k, fk is continuous at ak. Given ε > 0,
choose δk > 0 such that if d(a, x) < δk, then ρk(fk(a), fk(x)) < ε. If
d(a, x) < min {δ1, δ2} , then
ρ(f(a), f(x)) = max {ρ1(f1(a), f1(x)), ρ2(f2(a), f2(x))} < ε.
Thus f is continuous at a.
To prove the converse, ﬁrst note that, trivially, prk is continuous on X;
so if f is continuous at a, then so is prk ◦f, by Proposition (3.2.3).
2
(3.5.8) Proposition.
Let f be a mapping of a metric space E into X.
Then f is uniformly continuous if and only if both f1 and f2 are uniformly
continuous.
Proof.
This is left as an exercise.
2
(3.5.9) Exercises
.1
Prove that if a mapping f of X into a metric space Y is continuous
at (a, b), then the mappings x1 →f(x1, b) and x2 →f(a, x2) are
continuous at a and b, respectively.
.2
Prove Proposition (3.5.8).
.3
Let E be a metric space, A ⊂E, and a ∈A\{a}. Prove that a
mapping f : E →X has a limit at a with respect to A if and only if
both b1 = limt→a, t∈A f1(t) and b2 = limt→a, t∈A f2(t) exist, in which
case limt→a, t∈A f(t) = (b1, b2).
.4
Prove that a sequence (xn) in X converges to a limit in X if and
only if both ξ1 = limn→∞pr1(xn) and ξ2 = limn→∞pr2(xn) exist, in
which case limn→∞xn = (ξ1, ξ2).
.5
Prove that a sequence (xn) in X is a Cauchy sequence if and only
if (pr1(xn)) is a Cauchy sequence in X1 and (pr2(xn)) is a Cauchy
sequence in X2.

3.5 Product Metric Spaces
169
.6
For i = 1, 2 let Xi, Yi be metric spaces, and fi a mapping of Xi into
Yi. Prove that the mapping
(x1, x2) →(f1(x1), f2(x2))
of X1 × X2 into Y1 × Y2 is continuous if and only if both f1 and f2
are continuous.
We have now reached the main result of this section.
(3.5.10) Proposition.
Let T be any one of the following types of metric
space: complete, totally bounded, compact. Then the product X = X1 × X2
of two nonempty metric spaces X1 and X2 is of type T if and only if both
X1 and X2 are of type T.
Proof.
Leaving the necessity of the stated conditions as an exercise, we
prove their suﬃciency. To this end, assume that X1 and X2 are com-
plete, and consider a Cauchy sequence (xn) in X. By Exercise (3.5.9: 5),
(prk(xn))∞
n=1 is a Cauchy sequence in Xk; since Xk is complete,
ξk = lim
n→∞prk(xn)
exists. Reference to Exercise (3.5.9: 4) shows that (xn) converges to the
point (ξ1, ξ2) of X. Hence X is complete.
It is easy to see that if ε > 0 and Fk is a ﬁnite ε–approximation to Xk,
then F1 ×F2 is a ﬁnite ε–approximation to X. It follows that if X1 and X2
are totally bounded, so is X.
The ﬁrst two parts of the proof, and Theorem (3.3.9), show that if X1
and X2 are compact, then so is X.
2
(3.5.11) Exercises
.1
Prove that the product of two discrete metric spaces is discrete.
.2
In the notation of Proposition (3.5.10), prove that if X is of type T,
then so are X1 and X2.
.3
Prove that X is separable if and only if both X1 and X2 are separable.
.4
Prove that X is locally compact if and only if both X1 and X2 are
locally compact.
.5
Prove that X is connected (respectively, path connected) if and only
if both X1 and X2 are connected (respectively, path connected).
.6
Prove that a subset of the product space R2 or C2 is compact if and
only if it is closed and bounded.

170
3. Analysis in Metric Spaces
.7
Prove that the Euclidean spaces R2 and C2 are complete.
.8
Show that in the product space R2 the set
X = ({0} × [0, 1]) ∪([0, 1] × {0})
is compact, that every ball in X is connected, but that the closure
of an open ball in X need not be the corresponding closed ball (cf.
Exercise (3.4.10: 3)).
We deﬁne the product of a ﬁnite family (X1, ρ1), . . . , (Xn, ρn) of metric
spaces to be the metric space (X, ρ), where
X = X1 × · · · × Xn
and
ρ ((x1, . . . , xn), (y1, . . . , yn)) = max{ρi(xi, yi) : i = 1, . . . , n}.
The results proved so far in this section extend in the obvious ways to
a product of more than two, but ﬁnitely many, metric spaces. The ﬁnal
set of exercises in this chapter shows how we can handle the product of a
sequence of metric spaces.
(3.5.12) Exercises
.1
Let ((Xn, ρn))∞
n=1 be a sequence of nonempty metric spaces such that
diam(Xn) ≤1 for each n. Let X be the set of all sequences (xn)∞
n=1
such that xn ∈Xn for each n, and deﬁne a mapping ρ : X × X →R
by
ρ ((xn), (yn)) =
∞

n=1
2−nρn(xn, yn).
Prove that ρ is a metric on X.
The metric space (X, ρ) is called the product of the sequence (Xn) of
metric spaces and is usually denoted by 2∞
n=1 Xn.
The next four exercises use the notation of Exercise (3.5.12: 1).
.2
Let x = (xn)∞
n=1 be a point of X. Prove that U ⊂X is a neighbour-
hood of x in X if and only if for some positive integer m and some
r > 0, U contains a set of the form
Um(x, r) = {(yn)∞
n=1 ∈X : ρi(xi, yi) ≤r for 1 ≤i ≤m} .
.3
For each n let An be a subset of Xn. Prove that the closure of
2∞
n=1 An in X is 2∞
n=1 An.

3.5 Product Metric Spaces
171
.4
For each k let xk = (xk,n)∞
n=1 be a point of X. Prove that the sequence
(xk)∞
k=1 converges in X to a limit a = (an)∞
n=1 if and only if for each n
the sequence (xk,n)∞
k=1 converges to an in Xn. Prove also that (xk)∞
k=1
is a Cauchy sequence in X if and only if for each n the sequence
(xk,n)∞
k=1 is a Cauchy sequence in Xn.
.5
With T as in Proposition (3.5.10), prove that X is of type T if and
only if Xn is of type T for each n.
.6
Let (Xn)∞
n=1 be a sequence of discrete metric spaces, each having
positive diameter ≤1. Prove that the product space 2∞
n=1 Xn is not
discrete.

4
Analysis in Normed Linear Spaces
...I could be bounded in a nutshell, and
count myself a king of inﬁnite space...
hamlet, Act 2, Scene 2
Many signiﬁcant applications of analysis are the fruit of cross–fertilisation be-
tween metric structure and algebraic structure. In this chapter we discuss such
a cross–breed: a normed (linear) space. Section 1 introduces these objects and
deals with their elementary analytic and geometric properties. In Section 2 we
discuss linear mappings between normed spaces, paying particular attention to
bounded linear functionals—continuous linear mappings into R and C. Although
many of the most important normed spaces of analysis are inﬁnite–dimensional,
ﬁnite–dimensional ones remain signiﬁcant in many ways; they are dealt with in
Section 3. The next two sections deal with two fundamental classes of inﬁnite–
dimensional complete normed spaces: the Lp integration spaces and the space
C(X) of continuous functions from a compact metric space X into R. They also
characterise the associated bounded linear functionals. Two of the most impor-
tant results about C(X) —Ascoli’s Theorem and the Stone–Weierstrass Theo-
rem (a far–reaching generalisation of the classical Weierstrass Approximation
Theorem)—are proved in Sections 5 and 6. Both of these theorems reappear in
the ﬁnal section of the chapter, where they are applied to the concrete classical
problem of solving ordinary diﬀerential equations.

174
4. Analysis in Normed Linear Spaces
4.1
Normed Linear Spaces
Metric spaces oﬀer one context within which the analytic and topological
properties of R can be generalised, but they do not provide a natural frame-
work for a generalisation of the algebraic properties of R. A framework of
the latter sort is made available by the notion of a normed linear space.
Let F stand for either R or C, and let X be a linear space (vector space)
over F. A norm on X is a mapping x →∥x∥of X into R such that the
following properties hold for all x, y ∈X and λ ∈F.
N1
∥x∥≥0.
N2
∥x∥= 0 if and only if x = 0.
N3
∥λx∥= |λ| ∥x∥.
N4
∥x + y∥≤∥x∥+ ∥y∥
(triangle inequality).
A normed linear space, or normed space, over F is a pair (X, ∥·∥) consisting
of a linear space X over F and a norm ∥·∥on X; by abuse of language, we
refer to the linear space X itself as a normed space if it is clear from the
context which norm is under consideration. We say that the normed space
X is real or complex, depending on whether F is R or C. A vector with
norm 1 is called a unit vector.
The simplest example of a norm is, of course, the mapping x →|x| on
F.
If X is a normed space, then the mapping (x, y) →∥x −y∥of X ×X into
R is a metric on X (Exercise (4.1.1: 1)), and is said to be associated with
the norm on X. When we consider X as a metric space, it is understood
that we are referring to the metric associated with the given norm on X.
By the unit ball of X we mean the closed ball with centre 0 and radius 1,
B(0, 1) = {x ∈X : ∥x∥≤1} ,
relative to the metric associated with the norm on X.
(4.1.1) Exercises
.1
Prove that ρ(x, y) = ∥x −y∥deﬁnes a metric on a normed space X,
such that
ρ(x + z, y + z) = ρ(x, y),
ρ(λx, λy) = |λ| ρ(x, y)
for all x, y, z ∈X and λ ∈F.

4.1 Normed Linear Spaces
175
.2
Show that
| ∥x∥−∥y∥| ≤∥x −y∥
for all vectors x, y in a normed space X. Hence prove that if a sequence
(xn) converges to a limit x in X, then ∥x∥= limn→∞∥xn∥.
.3
Prove that
∥x∥= inf

|t|−1 : t ∈F, t ̸= 0, ∥tx∥≤1

for each element x of a normed space X.
.4
Prove that for each positive integer n the mappings
(x1, . . . , xn) →max {|x1| , . . . , |xn|} ,
(x1, . . . , xn) →
3
x2
1 + · · · + x2n,
(x1, . . . , xn) →|x1| + · · · + |xn|
are norms on Fn. In the case F = R the second of these norms is
called the Euclidean norm on Rn, and the associated metric is the
Euclidean metric (see Exercise (3.1.1: 5)).
.5
Let X be a nonempty set, and denote by B(X, F) the set of all
bounded mappings of X into F, taken with the pointwise operations
of addition and multiplication–by–scalars:
(f + g) (x) = f(x) + g(x),
(λf) (x) = λf(x).
The supremum norm, or sup norm, on B(X, F) is deﬁned by
∥f∥= sup {|f(x)| : x ∈X} .
Verify that the sup norm is a norm on B(X, F).
.6
Prove that ∥f∥1 =
%
|f| deﬁnes a norm on the set L1(R) of all
Lebesgue integrable functions (deﬁned almost everywhere) on R,
where two such functions are taken as equal if and only if they are
equal almost everywhere.
.7
Let X1, X2 be normed spaces over F, and recall that the standard
operations of addition and multiplication–by–scalars on the product
vector space X = X1 × X2 are given by
(x1, x2) + (x′
1, x′
2) = (x1 + x′
1, x2 + x′
2) ,
λ (x1, x2) = (λx1, λx2) .

176
4. Analysis in Normed Linear Spaces
Verify that the mapping (x1, x2) →max {∥x1∥, ∥x2∥} is a norm on
X, and that the metric associated with this norm is the product
metric on X (considered as the product of the metric spaces X1 and
X2).
Taken with this norm, which we call the product norm, X is known as
the product of the normed spaces X1 and X2. The product norm and
the product space for a ﬁnite number of normed spaces are deﬁned
analogously.
(4.1.2) Proposition.
Let X be a normed space over F. Then
(i) the mapping (x, y) →x + y is uniformly continuous on X × X;
(ii) for each λ ∈F the mapping x →λx is uniformly continuous on X;
(iii) for each x ∈X the mapping λ →λx is uniformly continuous on F;
(iv) the mapping (λ, x) →λx is continuous on F × X.
Proof.
The uniform continuity of the ﬁrst three mappings follows from
the relations
∥(x + y) −(x′ + y′)∥≤∥x −x′∥+ ∥y −y′∥,
∥λx −λy∥= |λ| ∥x −y∥,
∥λx −λ′x∥= |λ −λ′| ∥x∥.
On the other hand, the relations
∥λx −λ0x0∥= ∥λ0(x −x0) + (λ −λ0)x0 + (λ −λ0)(x −x0)∥
≤|λ0| ∥x −x0∥+ |λ −λ0| ∥x0∥+ |λ −λ0| ∥x −x0∥
easily lead to the continuity of (λ, x) →λx at (λ0, x0).
2
If X is a normed space and S is a linear subset of X, then the restriction
to S of the norm on X is a norm on S; taken with this norm, S is called a
normed linear subspace, or simply a subspace, of the normed space X.
(4.1.3) Proposition.
If S is a subspace of a normed space X, then the
closure of S in X is a subspace of X.
Proof.
Let f be the mapping (x, y) →x + y of X × X into X. As S is a
subspace, f maps S × S into S, so
S × S ⊂f −1(S) ⊂f −1(S),

4.1 Normed Linear Spaces
177
and therefore S × S is a subset of the closure of f −1(S). Since, by Propo-
sition (4.1.2), f is continuous on X × X, it follows from Proposition
(3.2.2) that f −1(S) is a closed subset of X; whence S × S ⊂f −1(S). But
S × S = S×S, by Proposition (3.5.5); so if x ∈S and y ∈S, then x+y ∈S.
A similar argument, using the continuity of the mapping (λ, x) →λx, shows
that if λ ∈F and x ∈S, then λx ∈S.
2
(4.1.4) Lemma.
If S is a closed subspace of a normed space X, and
a ∈X, then
a + S = {a + x : x ∈S}
is closed in X.
Proof.
Let f be the mapping z →z −a of X into itself. Since f is the
composition of the mappings z →(z, −a) and (x, y) →x + y, it follows
from Exercise (3.5.9: 1), Proposition (4.1.2), and Proposition (3.2.3) that f
is continuous on X. But a + S = f −1(S); so, by Proposition (3.2.2), a + S
is closed in X.
2
(4.1.5) Exercises
.1
Explain why, in Proposition (4.1.2), the mapping (λ, x) →λx is not
uniformly continuous on F × X.
.2
Complete the proof of Proposition (4.1.3).
.3
Let ( -
X, ρ) be a metric space, and X a normed space such that
(i) ρ(x, y) = ∥x −y∥for all x, y ∈X;
(ii) X is dense in -
X.
Show that the operations of addition and multiplication-by–scalars
can be extended uniquely to make -
X a normed space with associated
metric the given metric ρ. (Use Propositions (4.1.2) and (3.2.12).)
.4
Let A and B be nonempty subsets of a normed space X, and deﬁne
A + B = {x + y : x ∈A, y ∈B} .
Prove that
(i) if A is open, then A + B is open;
(ii) if A is compact and B is closed, then A + B is closed.
Need A + B be closed when A and B are closed?

178
4. Analysis in Normed Linear Spaces
.5
Recall that a subset C of a linear space is said to be convex if tx +
(1 −t)y ∈C whenever x, y ∈C and 0 ≤t ≤1. Prove that the closure
of a convex subset of a normed space is convex.
.6
Let C be a nonempty closed convex subset of a normed space X, x0 a
point of X\C, and r a positive number such that C∩B(x0, r) is empty.
Prove that C +B(0, r) is open and convex, and that x0 /∈C +B(0, r).
.7
Let C be a nonempty convex subset of Rn, and x0 a point of C\C.
Prove that each open ball with centre x0 intersects the complement
of C. (First consider the case where C has a nonempty interior.) Does
the conclusion hold if we drop the hypothesis that C is convex?
In a tribute to one of the founders of functional analysis, the Polish
mathematician Stefan Banach (1892–1945), a complete normed linear space
is called a Banach space. Among examples of Banach spaces are
• Euclidean n–space Rn (Exercise (4.1.1: 4));
• B(X, F) where X is a nonempty set and the norm is the sup norm
(Exercise (4.1.1: 5));
• certain spaces of continuous or integrable functions that we consider
in later sections of this chapter.
(4.1.6) Exercises
.1
Let c0 be the real vector space (with termwise algebraic operations)
consisting of all inﬁnite sequences x = (xn)∞
n=1 in R that converge to
0. For each x ∈c0 write
∥x∥= sup
n≥1
|xn|.
Prove that this deﬁnes a norm on c0 with respect to which c0 is
a separable Banach space. (For the second part, consider a Cauchy
sequence (xk)∞
k=1 in c0, where for each k, xk = (xk,n)∞
n=1. Show that
for each n, (xk,n)∞
k=1 is a Cauchy sequence in R. Denoting its limit by
ξn, show that (ξn)∞
n=1 belongs to c0 and is the limit of the sequence
(xk)∞
k=1 in the space c0.)
.2
Let l1 denote the space of all sequences of real numbers such that
the corresponding series is absolutely convergent, and for each x =
(xn)∞
n=1 ∈l1 write
∥x∥1 =
∞

n=1
|xn| .
Prove that this deﬁnes a norm on l1 with respect to which l1 is a
separable Banach space.

4.1 Normed Linear Spaces
179
.3
Let l∞denote the space of all bounded sequences of real numbers,
and for each x = (xn)∞
n=1 ∈l∞write
∥x∥∞= sup
n≥1
|xn| .
Prove that this deﬁnes a norm on l∞with respect to which l∞is a
Banach space.
.4
Prove that if X is a nonempty set, then B(X, F), taken with the
supremum norm, is a Banach space.
We now sketch how any normed space X can be embedded as a dense
subspace of a Banach space. Deﬁning
φx(y) = ∥x −y∥
(x, y ∈X),
Y = {φ0 + f : f ∈B(X, R)} ,
d(F, G) = sup {|F(x) −G(x)| : x ∈X}
(F, G ∈Y ),
we recall from Exercise (3.2.10: 8) that (Y, d) is a complete metric space,
that x →φx is an isometric mapping of X onto a subset Z of Y, and that
the closure -
X of Z is a complete subspace of Y. We transport the algebraic
structure from X to Z by deﬁning
φx + φy = φx+y,
λφx = φλx
for all x, y ∈X and λ ∈F. Then
∥φx∥= d(φx, φ0) = ∥x∥
deﬁnes a norm on Z whose associated metric is the one induced by d.
Using Exercise (4.1.5: 3), we can extend the operations of addition and
multiplication–by–scalars uniquely from X (identiﬁed with its image under
the mapping x →φx) to -
X, thereby making -
X a Banach space in which
there is a dense linear subspace isometric and algebraically isomorphic to
X.
In practice, we normally forget about the mapping x →φx and regard
X simply as a dense subspace of -
X, which we call the completion of the
normed space X.
(4.1.7) Exercise
Fill in the details of the proof that the foregoing constructions provide
-
X with the structure of a Banach space and that x →φx is a norm–
preserving algebraic isomorphism of X with a dense subspace of -
X.

180
4. Analysis in Normed Linear Spaces
Banach spaces form the natural abstract context for the notion of con-
vergence of series. Given a sequence (xn) of elements of a normed space X,
we deﬁne the corresponding series ∞
n=1 xn to be the sequence (sn), where
sn = n
k=1 xk is the nth partial sum of the series. The series ∞
n=1 xn is
said to be
• convergent if the sequence (sn) converges to a limit s in X, called the
sum of the series,
• absolutely convergent if the series ∞
n=1 ∥xn∥is convergent in R,
• unconditionally convergent if ∞
n=1 xf(n) converges for each permu-
tation f of N+.
In the ﬁrst case we write ∞
n=1 xn = s.
(4.1.8) Exercises
.1
Prove that a series ∞
n=1 xn in a Banach space X converges if and
only if for each ε > 0 there exists a positive integer N such that
∥j
n=i+1 xn∥< ε whenever j > i ≥N.
.2
Prove that an absolutely convergent series in a Banach space is
unconditionally convergent. (See Exercise (1.2.17: 1).)
.3
Let X be a normed linear space, and suppose that each absolutely
convergent series in X is convergent. Prove that X is a Banach space.
(Given a Cauchy sequence (xn) in X, choose n1 < n2 < · · · such
that ∥xi −xj∥< 2−k for all i, j ≥nk. Then consider the series
∞
k=1

xnk+1 −xnk
	
.)
.4
In the Banach space c0 of Exercise (4.1.6: 1), for each positive integer
n let xn be the element with nth term 1/n and all other terms 0.
Prove that the series ∞
n=1 xn is unconditionally convergent but not
absolutely convergent.
Exercises (1.2.17: 1 and 2) show that a series in R is unconditionally
convergent if and only if it is absolutely convergent. Exercise (4.1.8: 4)
shows that this need not be true if R is replaced by an inﬁnite–dimensional
Banach space. In fact, if every unconditionally convergent series in a Banach
space X is absolutely convergent, then X is ﬁnite–dimensional; this is the
Dvoretsky–Rogers Theorem (see [12], Chapter VI).
Let X be a normed space over F, and S a linear subspace of X. Then
x ∼y if and only if x −y ∈S

4.1 Normed Linear Spaces
181
deﬁnes an equivalence relation on X. The set of equivalence classes under
this relation is written X/S and is called the quotient space of X by S. The
canonical map ϕ of X onto X/S is deﬁned by
ϕ(x) = {x + s : s ∈S} ,
and maps each element of X to its equivalence class under ∼. We deﬁne
operations of addition and multiplication–by–scalars on X/S by
ϕ(x) + ϕ(y) = ϕ(x + y),
ϕ(λx) = λϕ(x).
These deﬁnitions are sound: for if x ∼x′ and y ∼y′, then x + y ∼x′ + y′
and λx ∼λx′. If S is a closed linear subspace of X, then
∥ϕ(x)∥= ρ (x, S) = inf {∥x −s∥: s ∈S}
deﬁnes a norm, called the quotient norm, on X/S. In that case we assume
that X/S is equipped with the foregoing algebraic operations and with the
quotient norm.
(4.1.9) Exercises
.1
Verify the claims made without proof in the preceding paragraph.
.2
Prove that if S is closed in X, then the canonical map ϕ : X →X/S
is uniformly continuous on S.
(4.1.10) Proposition.
If S is a closed linear subspace of a Banach space
X, then the quotient space X/S is a Banach space.
Proof.
Let ϕ be the canonical map of X onto X/S, and consider a se-
quence (xn) in X such that (ϕ(xn)) is a Cauchy sequence in X/S. Choose
a strictly increasing sequence (nk)∞
k=1 of positive integers such that
44ϕ(xnk+1) −ϕ(xnk)
44 < 2−k
(k ≥1).
Setting s1 = 0, we construct inductively a sequence (sk) in S such that for
each k,
44(xnk+1 −sk+1) −(xnk −sk)
44 < 2−k.
(1)
Indeed, having constructed elements s1, . . . , sk of S with the applicable
properties, we have
inf
44xnk+1 −(xnk −sk) −s
44 : s ∈S

= inf
44xnk+1 −xnk −s
44 : s ∈S

=
44ϕ(xnk+1 −xnk)
44
=
44ϕ(xnk+1) −ϕ(xnk)
44 < 2−k,

182
4. Analysis in Normed Linear Spaces
so there exists sk+1 ∈S such that (1) holds.
We now see from (1) that (xnk −sk)∞
k=1 is a Cauchy sequence in the
Banach space X; whence it converges to a limit z in X. By Exercise
(4.1.9: 2),
ϕ(xnk) = ϕ(xnk) −ϕ(sk) = ϕ(xnk −sk) →ϕ(z) as k →∞.
Thus the Cauchy sequence (ϕ(xn)) has a convergent subsequence. It follows
from Exercise (3.2.10: 3) that (ϕ(xn)) itself converges in X\S.
2
4.2
Linear Mappings and Hyperplanes
In the context of normed spaces, the important mappings are not just
continuous but also preserve the algebraic structure.
Recall that a mapping u between vector spaces X, Y is linear if
u(x + y) = u(x) + u(y)
and
u(λx) = λu(x)
whenever x, y ∈X and λ ∈F. If Y = F, then u is called a linear functional
on X. Examples of linear mappings are
• the mapping x →Ax on Fn, where A is an n–by–n matrix over F;
• the Lebesgue integral, regarded as a mapping of L1(R) into R (see
Exercise (4.1.1: 6));
• the mapping (xn)∞
n=1 →x1 of c0 into R (see Exercise (4.1.6: 1));
• the canonical mapping of a normed space X onto the quotient space
X/S, where S is a closed subspace of X;
• the mapping x →φx of a normed space onto a dense subspace of its
completion (see page 179).
Here is the fundamental result about the continuity of linear mappings
between normed spaces.
(4.2.1) Theorem.
The following are equivalent conditions on a linear
mapping of a normed space X into a normed space Y.
(i) u is continuous at 0.
(ii) u is continuous on X.
(iii) u is uniformly continuous on X.

4.2 Linear Mappings and Hyperplanes
183
(iv) u is bounded on the unit ball of X.
(v) u is bounded on each bounded subset of X.
(vi) There exists a positive number c, called a bound for u, such that
∥u(x)∥≤c ∥x∥for all x ∈X.
Proof.
Suppose that u is continuous at 0. Then there exists r > 0 such
that
∥u(x)∥= ∥u(x) −u(0)∥≤1
whenever ∥x∥≤r. For each nonzero t ∈F with ∥tx∥≤1 we have ∥rtx∥≤r
and therefore
∥u(x)∥= r−1 |t|−1 ∥u(rtx)∥≤r−1 |t|−1 .
It follows from Exercise (4.1.1: 3) that ∥u(x)∥≤r−1 ∥x∥for all x ∈X.
Hence (i) implies (vi).
It is clear that (vi) ⇒(v) ⇒(iv). Next, suppose that there exists c > 0
such that ∥u(x)∥≤c whenever ∥x∥≤1. Since
∥u(x)∥= ∥x∥
444u

∥x∥−1 x
444 ≤c ∥x∥
(x ̸= 0)
and u(0) = 0, we see that (vi) holds, with c a bound for u. We now have
∥u(x −y)∥≤c ∥x −y∥
(x, y ∈X) ,
from which it follows that u is uniformly continuous on X. Thus (iv) ⇒
(vi) ⇒(iii).
Finally, it is obvious that (iii) ⇒(ii) ⇒(i).
2
In view of property (v) of Proposition (4.2.1), we commonly refer to a
continuous linear mapping between normed spaces X, Y as a bounded linear
mapping on X. We deﬁne the norm of such a mapping by
∥u∥= sup {∥u(x)∥: x ∈X, ∥x∥≤1} .
(1)
The argument used to prove that (iv) ⇒(vi) in the last proof shows that
∥u(x)∥≤∥u∥∥x∥
(x ∈X).
In Exercise (4.2.2: 11) you will prove that equation (1) deﬁnes a norm on
the linear space L(X, Y ) of all bounded linear mappings u : X →Y, and
that if Y is a Banach space, then so is L(X, Y ). The Banach space L(X, F),
consisting of all bounded linear functionals from X into its ground ﬁeld F,
is called the dual space, or simply the dual, of X, and is denoted by X∗. The
interplay between a Banach space and its dual is one of the most signiﬁcant

184
4. Analysis in Normed Linear Spaces
themes of functional analysis, so we spend some time later in this chapter
and in Chapter 6 identifying the duals of certain important Banach spaces.
Two norms ∥·∥, ∥·∥′ on a vector space X are said to be equivalent if
both the identity mapping from (X, ∥·∥) onto (X, ∥·∥′) and its inverse are
continuous; since those mappings are linear, it follows from Proposition
(4.2.1) that ∥·∥and ∥·∥′ are equivalent norms on X if and only if there
exist positive constants a, b such that a ∥x∥≤∥x∥′ ≤b ∥x∥for all x ∈X.
(4.2.2) Exercises
.1
Prove that a linear mapping u : X →Y between normed spaces is
bounded if and only if there exists c > 0 such that ∥u(x)∥≤c for all
x ∈X with ∥x∥= 1, and that we then have
∥u∥= sup {∥u(x)∥: x ∈X, ∥x∥= 1} .
.2
Let u be a bounded linear mapping on a normed space X. Prove that
∥u∥= inf {c ≥0 : ∥u(x)∥≤c ∥x∥for all x ∈X} .
.3
Show that any two of the three norms on Rn introduced in Exercise
(4.1.1: 4) are equivalent.
.4
Let ∥·∥, ∥·∥′ be equivalent norms on a linear space X. Prove that if
X is complete with respect to ∥·∥, then it is complete with respect
to ∥·∥′ .
.5
Let X1, . . . , Xn be normed spaces, X = X1 × · · · × Xn, and Y a
normed space. Let u be a multilinear mapping of X into Y —that is,
a mapping linear in each of its n variables. Prove that u is continuous
if and only if there exists a constant c > 0 (which we call a bound for
u) such that
∥u(x1, . . . , xn)∥≤c ∥x1∥∥x2∥· · · ∥xn∥
for all (x1, . . . , xn) ∈X.
.6
Let X, Y be normed spaces, and u : X →Y a linear mapping such
that for each sequence (xn) in X converging to 0, the sequence (u(xn))
is bounded in Y . Prove that u is continuous. (Let (xn) be a sequence
converging to 0 in X, reduce to the case where ∥xn∥< 1/n2 for each
n, and then consider the sequence (nxn).)
.7
Prove that a linear mapping u : X →Y between normed spaces is
bounded if and only if for each Cauchy sequence (xn) in X, (u(xn))
is a Cauchy sequence in Y.

4.2 Linear Mappings and Hyperplanes
185
.8
Let u be a continuous linear mapping of a normed space X into a
Banach space Y , and let ∞
n=1 xn be an absolutely convergent series
in X. Prove that the series ∞
n=1 u(xn) converges absolutely in Y.
.9
Recalling the Banach space l1 of Exercise (4.1.6: 2), for each n let en
be the element of l1 with nth term 1 and all other terms 0. Show
that to each bounded sequence (xn) in a Banach space X there cor-
responds a unique bounded linear mapping u : l1 →X such that
u(en) = xn for each n.
Now let X be a separable Banach space, and (xn) a dense sequence in
the unit ball B of X. Deﬁne the bounded linear mapping u : l1 →X
as previously. Prove that u maps l1 onto X. (Given x ∈B, construct
inductively n1 < n2 < · · · such that
444444
2k−1(x −xn1) −
k

j=2
2k−jxnj
444444
< 2−k
for each k.)
Thus every separable Banach space is the range of a bounded linear
mapping on l1. For further results of this type see [12].
.10 Let D be a dense linear subspace of a normed space X, and u a
bounded linear mapping from D into a normed space Y. Prove that
u extends to a bounded linear mapping, with the same norm, from
X into Y. (First use Proposition (3.2.12).)
.11 Prove that if X, Y are normed spaces, then
∥u∥= sup{∥u(x)∥: x ∈X, ∥x∥≤1}
deﬁnes a norm on L(X, Y ), and that if Y is complete, then L(X, Y )
is a Banach space with respect to this norm. (To establish the com-
pleteness, let (un) be a Cauchy sequence in L(X, Y ), and show
that
u(x) = lim
n→∞un(x)
deﬁnes an element u of L(X, Y ) such that ∥u −un∥→0 as n →∞.)
.12 Let c0 be the Banach space of Exercise (4.1.6: 1). For each positive
integer n let en be the sequence whose nth term is 1 and which has
all other terms equal to 0. Let u be a bounded linear functional on c0.
Prove that the series ∞
n=1 u(en) is absolutely convergent, and that
the norm of u is ∞
n=1 |u(en)|. Conversely, prove that if ∞
n=1 tn is an
absolutely convergent series of real numbers, then there is a unique
bounded linear functional u on c0 such that u(en) = tn for each n.
Describe u(x), where x = (xn)∞
n=1 ∈c0.

186
4. Analysis in Normed Linear Spaces
This example shows that the dual space c∗
0 can be identiﬁed with the
Banach space l1 of Exercise (4.1.6: 2).
.13 Prove that l∗
1 can be identiﬁed with the Banach space l∞of Exercise
(4.1.6: 3).
.14 Prove the Uniform Boundedness Theorem: let (Ti)i∈I be a family
of bounded linear mappings from a Banach space X into a normed
space Y, such that {∥Tix∥: i ∈I} is bounded for each x ∈X; then
{∥Ti∥: i ∈I} is bounded. (Suppose the contrary. Then construct
sequences (xn)∞
n=1 in X and (in)∞
n=1 in I such that for each n,
∥xn∥= 4−n,
∥Tinxn∥> 2
3 ∥Tin∥∥xn∥,
and
∥Tin∥> 3 × 4n

n + sup
i∈I
{∥Ti (x1 + · · · + xn−1)∥}

.
Taking x = ∞
n=1 xn, deduce the contradiction that ∥Tinx∥> n for
each n.
This proof was published in [22]. A less elementary, but more stan-
dard, approach to the Uniform Boundedness Theorem is based on
Baire’s Theorem (6.3.1) and is discussed in Chapter 6.)
.15 A normed space X is said to be uniformly convex if it has the following
property: for each ε > 0 there exists δ ∈(0, 1) such that ∥x −y∥< ε
whenever ∥x∥≤1, ∥y∥≤1, and
44 1
2 (x + y)
44 > 1 −δ. Prove that if u
is a bounded linear functional on a uniformly convex Banach space
X, then there exists a unit vector x ∈X such that |u(x)| = ∥u∥.
Recall that the kernel, or null space, of a linear mapping u : X →Y
between vector spaces is the subspace
ker(u) = u−1(0) = {x ∈X : u(x) = 0}
of X. We say that u is nonzero if ker(u) ̸= X—that is, if there exists x ∈X
such that u(x) ̸= 0; otherwise, u is said to be zero.
(4.2.3) Proposition.
A linear functional on a normed space X is
continuous if and only if its kernel is closed in X.
Proof.
Let u be a linear functional on X, and S = ker(u). As {0} is a
closed subset of X, Proposition (3.2.2) shows that if u is continuous, then
S is closed in X. Suppose, conversely, that S is closed in X. Since the zero

4.2 Linear Mappings and Hyperplanes
187
linear functional is certainly continuous, we may assume that there exists
a ∈X such that u(a) = 1. Then 0 /∈a + S. On the other hand, by Lemma
(4.1.4), a + S is closed in X, so its complement is open. Hence there exists
r > 0 such that x /∈a + S whenever ∥x∥≤r. Suppose that ∥x∥≤r and
|u(x)| > 1, and let y = u(x)−1x. Then ∥y∥≤r, so y /∈a + S. On the other
hand,
u(y −a) = u(x)−1u(x) −1 = 0,
so y −a ∈S, and therefore
y = a + (y −a) ∈a + S.
This contradiction shows that |u(x)| ≤1 whenever ∥x∥≤r. It follows from
Proposition (4.2.1) that u is continuous.
2
As we show in a moment, nonzero linear functionals on a normed space
X are associated with certain subspaces of X which we now deﬁne.
A subspace H of a vector space X is called a hyperplane if
— X\H is nonempty, and
— for each a ∈X\H and each x ∈X there exists a unique pair (t, y) ∈
F × H such that x = ta + y.
This expression of the element x is called its representation relative to the
pair (H, a) consisting of the hyperplane H and the element a of X\H.
(4.2.4) Proposition.
The kernel of a nonzero linear functional on a
normed space X is a hyperplane in X. Conversely, if H is a hyperplane
in X and a /∈H, then there exists a unique linear functional u on X such
that ker(u) = H and u(a) = 1.
Proof.
First let u be a nonzero linear functional on X. If a /∈ker(u) and
x ∈X, then, using the linearity of u, we easily verify that x = ta + y,
with t ∈F and y ∈ker(u), if and only if t = u(x)/u(a). Hence ker(u) is a
hyperplane.
Conversely, let H be a hyperplane in X, and let a /∈H. For each x ∈X
there exists a unique pair (t, y) in F×H such that x = ta + y. Setting
u(x) = t and f(x) = y, we deﬁne functions u : X →F and f : X →H. If
also x′ ∈X, then
x + x′ = (u(x) + u(x′)) a + f(x) + f(x′),
where u(x)+u(x′) ∈F and (as H is a linear subset of X) f(x)+f(x′) ∈H;
the uniqueness of the representation of a given element of X relative to
(H, a) ensures that u(x+x′) = u(x)+u(x′). Similar uniqueness arguments
show that u(λx) = λu(x) whenever λ ∈F and x ∈X, and that u(a) = 1. In

188
4. Analysis in Normed Linear Spaces
particular, it follows that u is a linear functional on X. Moreover, u(x) = 0
if and only if x = f(x) ∈H; so ker(u) = H. It remains to prove that u
is the unique linear functional on X which takes the value 1 at a and has
kernel H. But if v is another such linear functional on X, then for each
x ∈X we have
v(x) = v (u(x)a + f(x))
= u(x)v(a) + v(f(x))
= u(x) 1 + 0
= u(x).
2
(4.2.5) Exercises
.1
Let H be a hyperplane in a normed space X, a ∈X\H, and α ∈R.
Prove that there exists a unique linear functional u on X such that
a + H = {x ∈X : u(x) = α} .
.2
Let u be a nonzero bounded linear functional on a normed space X,
and H = ker(u). Show that ρ(x, H) = ∥u∥−1 |u(x)| for each x ∈X.
.3
A translated hyperplane1 in a normed space X is a subset of the
form v + H where H is a hyperplane in X and v ∈X. Prove that
a translated hyperplane is closed if and only if its complement has a
nonempty interior.
.4
Let K be a subset of a normed space X, and u a linear functional on
X. For each α ∈R the translated hyperplane
Hα = {x ∈X : u(x) = α}
is called a hyperplane of support for K if
— there exists x0 ∈K such that u(x0) = α, and
— either u(x) ≥α for all x ∈K or u(x) ≤α for all x ∈K.
Prove that if K is compact and is not contained in any Hα, then for
exactly two real numbers α, Hα is a hyperplane of support for K.
(Consider the set

t ∈R : u−1(t) ∩K ̸= ∅

.)
1Some authors use the term “hyperplane” for a translated hyperplane.

4.3 Finite–Dimensional Normed Spaces
189
4.3
Finite–Dimensional Normed Spaces
Before studying some of the more important inﬁnite–dimensional spaces
in analysis, we devote a section to the major analytic properties of ﬁnite–
dimensional spaces. We begin by showing that for any positive integer n,
any normed space of dimension n over F can be identiﬁed with the product
space Fn.
(4.3.1) Proposition.
If X is an n–dimensional normed space with basis
{e1, . . . , en}, then
(ξ1, . . . , ξn) →
n

i=1
ξiei
is a one–one bounded linear mapping of the product space Fn onto X with
a bounded linear inverse.
Proof.
Let f denote the mapping in question. It is easy to verify that f
is one–one and maps Fn onto X, and that both f and f −1 are linear. Let
c = max
1≤i≤n ∥ei∥.
The inequalities
44444
n

i=1
ξiei
44444 ≤
n

i=1
|ξi| ∥ei∥≤c
n

i=1
|ξi| ≤nc max
1≤i≤n |ξi|
show that f is bounded and therefore continuous. Let
S =
*
(ξ1, . . . , ξn) ∈Fn : max
1≤i≤n |ξi| = 1
+
.
Then S is closed (Exercise (4.3.2: 1)) and bounded, and is therefore compact
(see Exercise (3.5.11: 6)). Now, the mapping ξ →∥f(ξ)∥is continuous and
(as {e1, . . . , en} is a basis) maps S into R+; so, by Exercise (3.3.7: 2),
0 < r = inf {∥f(ξ)∥: ξ ∈S} .
If ξ is any nonzero element of Fn, then, setting η = ∥ξ∥−1 ξ, we have η ∈S
and therefore
r ≤∥f(η)∥= ∥ξ∥−1 ∥f(ξ)∥.
Hence ∥ξ∥≤r−1 ∥f(ξ)∥. Since this holds trivially when ξ = 0, we see that
r−1 is a bound for the linear mapping f −1.
2
(4.3.2) Exercises
.1
Prove that the set S in the preceding proof is closed.

190
4. Analysis in Normed Linear Spaces
.2
Show that if X is n–dimensional with basis {e1, . . . , en}, then the
mapping
n

i=1
ξiei →max
1≤i≤n |ξi|
is a norm on X, and that X is complete with respect to this norm.
.3
Find an alternative proof that the mapping f −1 in the proof of
Proposition (4.3.1) is continuous.
.4
Prove that any linear mapping from a ﬁnite–dimensional normed
space into a normed space is bounded. Hence prove that any two
norms on a given ﬁnite–dimensional linear space are equivalent.
(4.3.3) Proposition.
A ﬁnite–dimensional normed space is complete.
Proof.
Let X be a ﬁnite–dimensional normed space. We may assume that
X ̸= {0}, so that X has a basis {e1, . . . ,en}. Let f be the mapping in Propo-
sition (4.3.1), and let (xn) be a Cauchy sequence in X. Then

f −1(xn)
	
is
a Cauchy sequence in Fn and therefore (see Exercise (3.5.11: 7)), converges
to a limit y ∈Fn. Since f is continuous, (xn) converges to f(y) ∈X.
2
(4.3.4) Corollary.
A ﬁnite–dimensional subspace of a normed space X
is closed in X.
Proof.
This is an immediate consequence of Propositions (4.3.3) and
(3.2.9).
2
Our next result is surprisingly useful. We use it to simplify the proof of
Theorem (4.3.6).
(4.3.5) Riesz’s Lemma.
Let S be a closed subspace with a nonempty
complement in a normed space X, and let 0 < θ < 1. Then there exists a
unit vector x ∈X such that ∥x −y∥> θ for each y ∈S.
Proof.
Fix x0 ∈X\S. By Exercise (3.1.10: 3),
0 < r = ρ(x0, S) < θ−1r.
Choosing s0 ∈S such that
r ≤∥x0 −s0∥< θ−1r,
let
x = ∥x0 −s0∥−1 (x0 −s0).

4.3 Finite–Dimensional Normed Spaces
191
Then ∥x∥= 1. Also, for each s ∈S,
s0 + ∥x0 −s0∥s ∈S,
so
∥x0 −s0∥∥x −s∥= ∥x0 −(s0 + ∥x0 −s0∥s)∥≥ρ(x0, S) = r,
and therefore
∥x −s∥≥
r
∥x0 −s0∥> θ.
2
It follows from Riesz’s Lemma that in an inﬁnite–dimensional normed
space X, if 0 < θ < 1, then there exists a sequence (xn) of unit vectors such
that ∥xm −xn∥> θ whenever m ̸= n (see Exercise (4.3.7: 4)). This result
can be improved in various ways. For example, in Chapter 6 we prove that
in any inﬁnite–dimensional normed space there exists a sequence (xn) of
unit vectors such that ∥xm −xn∥> 1 whenever m ̸= n. A much deeper
result, due to Elton and Odell, says that if X is an inﬁnite–dimensional
normed space, then there exist ε > 0 and a sequence (xn) of unit vectors
in X such that ∥xm −xn∥≥1 + ε whenever m ̸= n; see Chapter XIV of
[12].
We now use Riesz’s Lemma to provide a topological characterisation of
ﬁnite–dimensional normed spaces.
(4.3.6) Theorem.
A normed space is ﬁnite–dimensional if and only if
its unit ball is totally bounded, in which case that ball is compact.
Proof.
For simplicity, we take the case F = R. Let X be a normed space,
and B its (closed) unit ball; we may assume that X ̸= {0}. Suppose that
X is ﬁnite–dimensional with basis {e1, . . . , en}, and let u be the one–one
linear mapping n
i=1 ξiei →(ξ1, . . . , ξn) of X onto the product metric
space Rn. By Propositions (4.3.1) and (4.2.1), there exists R > 0 such that
if ∥n
i=1 ξiei∥≤1, then
∥(ξ1, . . . , ξn)∥= max
1≤i≤n |ξi| ≤R.
(1)
By the Heine–Borel–Lebesgue Theorem (1.4.6) and Proposition (3.5.10),
[−R,R]n is a compact subset of Rn; it follows from Propositions (4.3.1)
and (3.3.6) that u−1([−R,R]n) is a compact subset of X. Since B is closed
and, by (1), a subset of u−1([−R,R]n), we see from Proposition (3.3.4) that
B is compact.
Assume, conversely, that B is totally bounded. Construct a ﬁnite
1
2–
approximation F to B, let S be the ﬁnite–dimensional subspace of X gen-
erated by F, and suppose that X ̸= S. Then, by Riesz’s Lemma (4.3.5),

192
4. Analysis in Normed Linear Spaces
there exists a unit vector x ∈X such that ∥x −s∥> 1
2 for all s ∈S; but
this is absurd, as ∥x −s∥< 1
2 for some s ∈F. Hence, in fact, X = S.
2
(4.3.7) Exercises
.1
Show that if a normed space X contains a totally bounded ball, then
every closed ball in X is compact.
.2
Prove that a normed space X is ﬁnite–dimensional if and only if
{x ∈X : ∥x∥= 1} is compact.
.3
Prove that a normed space is locally compact if and only if it is
ﬁnite–dimensional.
.4
Let X be an inﬁnite–dimensional normed space. Use Riesz’s Lemma
to construct, inductively, a sequence (xn) of unit vectors in X such
that for each n,
(i) x1, . . . , xn are linearly independent, and
(ii) ρ(xn+1, Xn) ≥1
2, where Xn = span {x1, . . . , xn} .
Hence prove that the unit ball of X is not compact.
This provides us with another proof that if the unit ball of a normed
space is compact, then the space is ﬁnite–dimensional.
.5
Let X be a metric space, x ∈X, and S a nonempty subset of X.
A point b ∈S is called a best approximation, or a closest point,
to x in S if ρ(x, b) = ρ(x, S). Prove the Fundamental Theorem of
Approximation Theory: if X is a ﬁnite–dimensional subspace of a
normed space X, then each point of X has a best approximation in
X. (See [10], [38], or [52] for further information about approximation
theory, a major branch of analysis with many important practical
applications.)
.6
Prove that any hyperplane in a ﬁnite–dimensional normed space is
closed.
Now let X be the subspace of c0 consisting of all sequences (xn)∞
n=1
of real numbers such that xn = 0 for all suﬃciently large n. Show
that
f((xn)∞
n=1) =
∞

n=1
nxn
deﬁnes a linear functional f : X →R whose kernel is not closed in
X.

4.3 Finite–Dimensional Normed Spaces
193
.7
Let S be a nonempty closed subset of RN, and K, B closed balls in
RN such that (i) B ⊂K and (ii) K intersects S in a single point ζ
on the boundary of K. If B does not intersect the boundary of K, let
ξ be the centre of B; otherwise, B must intersect the boundary of K
in a single point, which we denote by ξ. For each positive integer n
let
Kn = 1
n(ξ −ζ) + K.
Prove that for all suﬃciently large n we have B ⊂Kn and Kn ∩S =
∅. Hence prove that there exists a ball K′ that is concentric with
K, has radius greater than that of K, and is disjoint from S. (For
the ﬁrst part, begin by showing that there exists a positive integer
ν such that B ⊂Kn for all n ≥ν. Then suppose that for each
n ≥ν there exists sn ∈Kn ∩S. Show that there exists a subsequence
(snk)∞
k=1 converging to ζ, and hence ﬁnd k such that snk ∈K ∩S, a
contradiction.)
A sequence in a normed linear space X is said to be total if it generates a
dense linear subspace of X—that is, if the linear space consisting of all ﬁnite
linear combinations of terms of the sequence is dense in X. In that case X
is separable. To see this, let (an) be a total sequence in X, and let S be the
set of all ﬁnite linear combinations r1a1 + · · · + rnan with each coeﬃcient
rk rational. (By a rational complex number we mean a complex number
whose real and imaginary parts are rational.) If λ1, . . . , λn are in F, then
there exist rational elements r1, . . . , rn of F such that n
k=1 |λk −rk| ∥ak∥
is arbitrarily small; since
44444
n

k=1
λkak −
n

k=1
rkak
44444 ≤
n

k=1
|λk −rk| ∥ak∥
and (an) is total, it follows that S is dense in X; but S is countable.
We have the following converse.
(4.3.8) Proposition.
If X is an inﬁnite–dimensional separable normed
space, then it has a total sequence of linearly independent vectors.
Proof.
Let (an) be a dense sequence in X, and assume without loss
of generality that a1 ̸= 0. We construct inductively a strictly increasing
sequence 1 = n1 < n2 < · · · of positive integers such that for each k,
(i) the vectors an1, . . . , ank are linearly independent, and
(ii) for 1 ≤m ≤nk, am is a linear combination of an1, . . . , ank.
Indeed, if an1, . . . , ank have been constructed with properties (i) and (ii), we
take nk+1 to be the smallest integer m > nk such that am does not belong

194
4. Analysis in Normed Linear Spaces
to the subspace Xk of X generated by {an1, . . . , ank}. (If no such integer
exists, then, being closed by Proposition (4.3.4), Xk contains the closure
of the subspace of X generated by the dense sequence (an), so X = Xk
is ﬁnite–dimensional—a contradiction.) It now follows from (ii) that the
sequence (ank)∞
k=1 is total in X.
2
(4.3.9) Exercises
.1
Prove that the Banach spaces c0 and l1 are separable.
.2
Show that the Banach space l∞is not separable. (Consider the set
of elements of l∞whose terms belong to {0, 1} .)
4.4
The Lp Spaces
In this section we introduce certain inﬁnite–dimensional Banach spaces of
integrable functions that appear very frequently in many areas of pure and
applied mathematics. For convenience, we call real numbers p, q conjugate
exponents if p > 1, q > 1, and 1/p + 1/q = 1.
We begin our discussion with an elementary lemma.
(4.4.1) Lemma.
If x, y are positive numbers and 0 < α < 1, then
xαy1−α ≤αx + (1 −α)y.
Proof.
Taking u = x/y, consider
f(u) = uα −αu −1 + α.
We have f ′(u) = α(uα−1 −1), which is positive if 0 < u < 1 and negative
if u > 1. Since f(1) = 0, it follows from Exercise (1.5.4: 7) that f(u) ≤0
for all u > 0. This immediately leads to the desired inequality.
2
(4.4.2) Proposition.
Let p, q be conjugate exponents, and f, g measur-
able functions on R such that |f|p and |g|q are integrable. Then fg is
integrable, and H¨older’s inequality
    
$
fg
    ≤
$
|f|p
1/p $
|g|q
1/q
(1)
holds.
Proof.
We ﬁrst note that if
%
|f|p = 0, then |f|p = 0 almost everywhere;
so f = 0, and therefore fg = 0, almost everywhere. Then fg is integrable,
%
fg = 0, and (1) holds trivially, as it does also in the case where
%
|g|q = 0.

4.4 The Lp Spaces
195
Thus we may assume that
%
|f|p > 0 and
%
|g|q > 0. We then have, almost
everywhere,
|fg|
%
|f|p	1/p %
|g|q	1/q =
 |f|p
%
|f|p
1/p  |g|q
%
|g|q
1/q
≤
|f|p
p
%
|f|p +
|g|q
q
%
|g|q
(where the last step uses Lemma (4.4.1)), so
|fg| ≤
$
|f|p
1/p $
|g|q
1/q 
|f|p
p
%
|f|p +
|g|q
q
%
|g|q

.
(2)
Now, fg is measurable and the right–hand side of (2) is integrable. Hence,
by Proposition (2.3.1), fg is integrable and
    
$
fg
    ≤
$
|fg| ≤
$
|f|p
1/p $
|g|q
1/q 1
p + 1
q

,
from which (1) follows.
2
(4.4.3) Proposition.
Let p ≥1, and let f, g be measurable functions on
R such that |f|p and |g|p are integrable. Then |f + g|p is integrable, and
Minkowski’s inequality
$
|f + g|p
1/p
≤
$
|f|p
1/p
+
$
|g|p
1/p
holds.
Proof.
Clearly, we may assume that p > 1. Now, |f + g|p is measurable,
by Exercise (2.3.3: 5). Since
|f + g|p ≤(2 max {|f| , |g|})p ≤2p (|f|p + |g|p)
and the last function is integrable, it follows from Proposition (2.3.1) that
|f + g|p is integrable. The functions |f| and |f + g|p−1 are measurable, by
Exercise (2.3.3: 5), and

|f + g|p−1q
= |f + g|p ∈L1(R).
Thus, by Proposition (4.4.2), |f + g|p−1 |f| is integrable and
$
|f + g|p−1 |f| ≤
$
|f + g|p
1−p−1 $
|f|p
1/p
.

196
4. Analysis in Normed Linear Spaces
Similarly, |f + g|p−1 |g| is integrable and
$
|f + g|p−1 |g| ≤
$
|f + g|p
1−p−1 $
|g|p
1/p
.
It follows that
$
|f + g|p =
$
|f + g|p−1 |f + g|
≤
$
|f + g|p−1 |f| +
$
|f + g|p−1 |g|
≤
$
|f + g|p
1−p−1 $
|f|p
1/p
+
$
|g|p
1/p
,
from which we easily obtain Minkowski’s inequality.
2
(4.4.4) Exercises
.1
Prove H¨older’s inequality
     
N

n=1
xnyn
     ≤
 N

n=1
|xn|p
1/p  N

n=1
|yn|q
1/q
and Minkowski’s inequality
 N

n=1
|xn + yn|p
1/p
≤
 N

n=1
|xn|p
1/p
+
 N

n=1
|yn|p
1/p
for ﬁnite sequences x1, . . . , xN and y1, . . . , yN of real numbers.
.2
A sequence (xn) of real numbers is called p–power summable if the
series ∞
n=1 |xn|p converges. Prove that if (xn) is p–power summable
and (yn) is q–power summable, where p, q are conjugate exponents,
then
(i) ∞
n=1 xnyn is absolutely convergent, and
(ii) H¨older’s inequality holds in the form
     
∞

n=1
xnyn
     ≤
 ∞

n=1
|xn|p
1/p  ∞

n=1
|yn|q
1/q
.
Prove also that if (xn) and (yn) are both p–power summable, then so
is (xn + yn) , and Minkowski’s inequality
 ∞

n=1
|xn + yn|p
1/p
≤
 ∞

n=1
|xn|p
1/p
+
 ∞

n=1
|yn|p
1/p
holds.

4.4 The Lp Spaces
197
.3
Let p ≥1, and let lp denote the set of all p–power summable se-
quences, taken with termwise addition and multiplication–by–scalars.
Prove that
∥(xn)∞
n=1∥p =
 ∞

n=1
|xn|p
1/p
deﬁnes a norm on lp. (We deﬁne the normed space lp(C) of p–power
summable sequences of complex numbers in the obvious analogous
way.)
Let X be a measurable subset of R, and p ≥1. We deﬁne Lp(X) to be
the set of all functions f, deﬁned almost everywhere on R, such that f is
measurable, f vanishes almost everywhere on R\X, and |f|p is integrable.
Taken with the pointwise operations of addition and multiplication–by–
scalars, Lp(X) becomes a linear space. If we follow the usual practice of
identifying two measurable functions that are equal almost everywhere,
then
∥f∥p =
$
|f|p
1/p
is a norm, called the Lp–norm, on Lp(X). (We met the normed space L1(R)
in Exercise (4.1.1: 6).)
When X = [a, b] is a compact interval, we write Lp[a, b] rather than
Lp ([a, b]) .
(4.4.5) Exercises
In these exercises, X is a measurable subset of R.
.1
Let X be integrable and 1 ≤r < s. Prove the following.
(i) Ls(X) ⊂Lr(X). (Note that if f ∈Ls(X), then |f|r ∈Ls/r(X).)
(ii) The linear mapping f →f of Ls(X) into Lr(X) is bounded and
has norm ≤µ(X)r−1−s−1.
.2
Let 1 ≤r ≤t ≤s < ∞, r ̸= s,
α = t−1 −s−1
r−1 −s−1 ,
β = r−1 −t−1
r−1 −s−1 .
and f ∈Lr(X) ∩Ls(X). Prove that f ∈Lt(X) and
∥f∥t ≤∥f∥α
r ∥f∥β
s .
(Consider |f|αt |f|βt .)

198
4. Analysis in Normed Linear Spaces
.3
Prove that the step functions that vanish outside X form a dense
subspace of Lp(X) for p ≥1. (First consider the case where X is a
compact interval.)
.4
Let p, q be conjugate exponents, and let f, g ∈Lp(X). Prove that if
1 < p < 2, then
2

∥f∥p
p + ∥g∥p
p
q−1
≥∥f + g∥q
p + ∥f −g∥q
p
and
∥f + g∥p
p + ∥f −g∥p
p ≥2

∥f∥q
p + ∥g∥q
p
p−1
,
and that the reverse inequalities hold if p ≥2. (Clarkson’s inequalities.
Use Exercise (1.5.8: 10).)
.5
Use the preceding exercise to prove that if p > 1, then Lp(X) is
uniformly convex. (See Exercise (4.2.2: 15).)
(4.4.6) The Riesz–Fischer Theorem.
Lp(X) is a Banach space for all
p ≥1. More precisely, if (fn) is a Cauchy sequence in Lp(X), then there
exist f ∈Lp(X) and a subsequence (fnk)∞
k=1 of (fn) such that
(i) limn→∞∥f −fn∥p = 0, and
(ii) fnk →f almost everywhere on X as k →∞.
Proof.
We illustrate the proof with the case X = R and p > 1. Given a
Cauchy sequence (fn) in Lp(R), choose a subsequence (fnk)∞
k=1 such that
∥fm −fn∥p ≤2−k
(m, n ≥nk).
Then
44fnk+1 −fnk
44
p ≤2−k.
Writing q = p/(p−1), we see from Proposition (4.4.2) that for each positive
integer N,
  fnk+1 −fnk
  is integrable over [−N, N], and
$   fnk+1 −fnk
  χ[−N,N] ≤
44fnk+1 −fnk
44
p
$
χ[−N,N]
1/q
≤2−k(2N)1/q,
so the series
∞

k=1
$   fnk+1 −fnk
  χ[−N,N]

4.4 The Lp Spaces
199
converges. It follows from Lebesgue’s Series Theorem (Exercise (2.2.13: 4))
that there exists a set EN of measure zero such that the series
∞

k=1
  fnk+1(x) −fnk(x)
  χ[−N,N](x)
converges for all x ∈R\EN, and the function ∞
k=1
  fnk+1 −fnk
  χ[−N,N]
is integrable. Then
E =
∞

N=1
EN
is a set of measure zero, and
f(x) = lim
k→∞fnk(x) = fn1(x) +
∞

k=1

fnk+1(x) −fnk(x)
	
exists for all x ∈R\E. The function f so deﬁned is measurable, by Exercise
(2.3.3: 4). Since
∥fnk∥p ≤∥fn1∥p + ∥fnk −fn1∥p ≤∥fn1∥p + 1
2
for all k, we see from Fatou’s Lemma (Exercise (2.2.13: 11)) that |f|p is
integrable and hence that f ∈Lp(R). Moreover, if n ≥ni, then by applying
Fatou’s Lemma to the sequence (|fnk −fn|)∞
k=i we see that
∥f −fn∥p = lim
k→∞∥fnk −fn∥p ≤2−i.
Hence limn→∞∥f −fn∥p = 0.
2
(4.4.7) Exercises
.1
Prove the Riesz–Fischer Theorem for a general measurable set X ⊂
R. Prove it also in the case p = 1.
.2
Prove that the space lp is complete for p ≥1.
In order to establish an elegant characterisation of bounded linear func-
tionals on Lp(X), we ﬁrst discuss those functions whose derivatives almost
everywhere belong to Lq(R).
(4.4.8) Lemma.
Let I = [a, b] be a compact interval, q > 1, and G a
real–valued function deﬁned almost everywhere on R and vanishing outside
I. Then the following conditions are equivalent.
(i) There exists g ∈Lq(R) such that G′(x) = g(x) almost everywhere.

200
4. Analysis in Normed Linear Spaces
(ii) There exists M > 0 such that
n−1

k=1
|G(xk+1) −G(xk)|q
(xk+1 −xk)q−1
≤M
whenever the points xk ∈I and x1 < x2 < · · · < xn.
In that case, the smallest such M is
%
|g|q .
Proof.
Writing p = q/(q −1), suppose that (i) holds, and let a ≤x1 <
x2 < · · · < xn ≤b. Applying Proposition (4.4.2) to the functions χI and
χIg, we have
|G(xk+1) −G(xk)| =
    
$ xk+1
xk
g
    
≤
$ xk+1
xk
χI
1/p $ xk+1
xk
|g|q
1/q
= (xk+1 −xk)1/p
$ xk+1
xk
|g|q
1/q
.
Hence
|G(xk+1) −G(xk)|q ≤(xk+1 −xk)q−1
$ xk+1
xk
|g|q ,
and therefore
n−1

k=1
|G(xk+1) −G(xk)|q
(xk+1 −xk)q−1
≤
n

k=1
$ xk+1
xk
|g|q ≤
$
|g|q .
Thus (ii) holds, and the smallest M for which (ii) holds is at most
%
|g|q .
Now suppose that (ii) holds, and let ((ak, bk))N
k=1 be a ﬁnite sequence
of nonoverlapping open subintervals of I. Applying Exercise (4.4.4: 1), we
obtain
N

k=1
|G(bk) −G(ak)| =
N

k=1
|G(bk) −G(ak)|
(bk −ak)1/p

(bk −ak)1/p
≤
 N

k=1
|G(bk) −G(ak)|q
(bk −ak)q−1
1/q  N

k=1
(bk −ak)
1/p
≤M
 N

k=1
(bk −ak)
1/p
.
Hence G is absolutely continuous. It follows from Exercise (2.2.17: 2) that
there exists an integrable function g such that G′(x) = g(x) almost
everywhere.

4.4 The Lp Spaces
201
For each positive integer n let
xn,k = a + k
2n (b −a)
(0 ≤k ≤2n)
and deﬁne a step function gn by setting
gn(x) =







G(xn,k+1) −G(xn,k)
xn,k+1 −xn,k
if xn,k < x < xn,k+1
0
otherwise.
Then g(x) = limn→∞gn(x) almost everywhere—to be precise, on the
complement of the union of
{xn,k : n ≥1, 0 ≤k ≤2n}
and the set of measure zero on which G′ = g . Also,
$
|gn|q =
2n

k=0
|G(xn,k+1) −G(xn,k)|q
(xn,k+1 −xn,k)q−1
≤M.
Applying Fatou’s Lemma, we now see that |g|q is integrable and
%
|g|q ≤M.
Hence (ii) implies (i). Referring to the last sentence of the ﬁrst part of the
proof, we also see that
%
|g|q is the smallest M for which (ii) holds.
2
(4.4.9) Lemma.
Let u be a bounded linear functional on Lp[a, b], and
deﬁne
G(x) =





u

χ[a,x]

if a ≤x ≤b
0
otherwise.
Let a ≤x1 < x2 < · · · < xn ≤b, and let f = n−1
k=1 ckχ[xk,xk+1]. Then
u(f) =
n−1

k=1
ck (G(xk+1) −G(xk)) .
Moreover, if there exists g ∈Lq[a, b] such that G′ = g almost everywhere,
then u(f) =
%
fg.
Proof.
We have
u(f) =
n−1

k=1
cku(χ[xk,xk+1])
=
n−1

k=1
ck

u

χ[a,xk+1] −χ[a,xk]

=
n−1

k=1
ck (G(xk+1) −G(xk)) .

202
4. Analysis in Normed Linear Spaces
Now suppose that G′ = g almost everywhere for some g ∈Lq[a, b]. Then
u(f) =
n−1

k=1
ck
$ xk+1
xk
g =
n−1

k=1
$ xk+1
xk
ckg =
$
fg.
2
We now show that if p, q are conjugate exponents, then the dual space
L∗
p can be identiﬁed with Lq.
(4.4.10) Theorem.
Let p, q be conjugate exponents. Then for each g ∈
Lq(X),
ug(f) =
$
fg
deﬁnes a bounded linear functional on Lp(X) with norm equal to ∥g∥q .
Conversely, to each bounded linear functional u on Lp(X) there corresponds
a unique g ∈Lq(X) such that u = ug.
Proof.
If g ∈Lq(X), then by Lemma (4.4.2), ug is well deﬁned on Lp(X).
It is trivial that ug is linear, and H¨older’s inequality shows that ∥g∥q is a
bound for ug. On the other hand, taking
f =

g+	q/p −

g−	q/p ,
we see that f ∈Lp(X) and
ug(f) =
$
fg =
$
|g|1+qp−1
=
$
|g|q
= ∥g∥q
$
|g|q
1−q−1
= ∥g∥q
$
|f|p
1/p
= ∥g∥q ∥f∥p .
Hence ∥ug∥= ∥g∥q .
Now consider any bounded linear functional u on Lp(X). To begin with,
take the case where X is a compact interval [a, b]. If u = ug for some
g ∈Lq(X), then u

χ[a,x]

=
% x
a g for each x ∈X. This suggests that we
deﬁne
G(x) =





u

χ[a,x]

if x ∈X
0
if x ∈R\X
and try to show that G′ ∈Lq(X) and that u(f) =
%
fG′ for all f ∈Lp(X).
To this end, let a ≤x1 < x2 < · · · < xn ≤b. Let φ be the step function

4.4 The Lp Spaces
203
that vanishes outside [x1, xn] and at each xi, and that takes the constant
value
ck = |G(xk+1) −G(xk)|q−1 sgn (G(xk+1) −G(xk))
(xk+1 −xk)q−1
on (xk, xk+1) , where
sgn (x) =











1
if x > 0
0
if x = 0
−1
if x < 0.
Then, by Lemma (4.4.9),
n−1

k=1
|G(xk+1) −G(xk)|q
(xk+1 −xk)q−1
= u(φ)
≤∥u∥∥φ∥p
= ∥u∥
n−1

k=1
|ck|p (xk+1 −xk)
1/p
= ∥u∥
n−1

k=1
|G(xk+1) −G(xk)|q
(xk+1 −xk)q−1
1/p
,
and therefore
n−1

k=1
|G(xk+1) −G(xk)|q
(xk+1 −xk)q−1
≤∥u∥q .
Thus, by Lemma (4.4.8), there exists g ∈Lq(X) such that G′ = g almost
everywhere and ∥g∥q ≤∥u∥. It follows from Lemma (4.4.9) that u(f) =
%
fg for each step function f that vanishes outside X. The set of such step
functions is dense in the space Lp(X), by Exercise (4.4.5: 3); moreover, the
linear functionals u and f →
%
fg are bounded, and therefore uniformly
continuous, on Lp(X). Referring to Proposition (3.2.12), we conclude that
u = ug.
It remains to remove the restriction that X be a compact interval and
to prove the uniqueness of g for a given u. This is left as an exercise.
2
(4.4.11) Exercises
.1
Complete the proof of Theorem (4.4.10) by removing the restriction
that X be a compact interval, and by proving the uniqueness of the
function g for a given u.

204
4. Analysis in Normed Linear Spaces
.2
A measurable function f on R is said to be essentially bounded if
there exists M > 0 such that |f(x)| ≤M almost everywhere. Prove
that
∥f∥∞= inf {M > 0 : |f(x)| ≤M almost everywhere}
deﬁnes a norm on the vector space L∞of all essentially bounded
functions under pointwise operations, and that L∞is a Banach space
with respect to this norm (where, as usual, we identify measurable
functions that are equal almost everywhere).
The real number ∥f∥∞is called the essential supremum of the
element f of L∞.
.3
Let K be a compact subset of R, and f : K →R a continuous
function. Extend f to R by setting f(x) = 0 if x ∈R\K. Prove that
f ∈L∞and that ∥f∥∞= supx∈K |f(x)| .
.4
Prove that if f ∈L1 and g ∈L∞, then fg ∈L1 and H¨older’s
inequality holds in the form
∥fg∥1 ≤∥f∥1 ∥g∥∞.
.5
Prove that for each g ∈L∞,
ug(f) =
$
fg
deﬁnes a bounded linear functional on L1 with norm equal to ∥g∥∞,
and that every bounded linear functional on L1 has the form ug for
a unique corresponding g ∈L∞.
.6
Let 0 < p < 1, and let Lp consist of all measurable functions f on
R such that |f|p is integrable. Show that when we identify functions
that are equal almost everywhere,
ρp(f, g) =
$
|f −g|p
deﬁnes a metric on Lp, and that (Lp, ρp) is a complete metric space.
Show also that the only continuous linear mapping from Lp (with
pointwise operations) to R is the zero mapping.
4.5
Function Spaces
Among the most important examples of Banach spaces are certain subsets
of the space B(X, Y ) of bounded functions from a nonempty set X into a
Banach space Y , where the norm on B(X, Y ) is the sup norm
∥f∥= sup{∥f(x)∥: x ∈X}.

4.5 Function Spaces
205
Note that when X is a compact interval [a, b], we usually write B[a, b] rather
than B([a, b]); we use similar notations without further comment in related
situations.
A special case of the next result has appeared already (Exercise
(4.1.6: 4)).
(4.5.1) Proposition.
If Y is a Banach space, then B(X, Y ) is a Banach
space.
Proof.
Let (fn) be a Cauchy sequence in B(X, Y ), and ε > 0. There
exists N such that ∥fm −fn∥< ε for all m, n ≥N. For each x ∈X we
have
∥fm(x) −fn(x)∥≤∥fm −fn∥< ε
whenever m, n ≥N; so (fn(x))∞
n=1 is a Cauchy sequence in Y . Since Y is
complete,
f(x) = lim
n→∞fn(x)
exists; also, for all m ≥N,
∥fm(x) −f(x)∥= lim
n→∞∥fm(x) −fn(x)∥≤ε.
(1)
Hence
∥f(x)∥≤∥fN(x)∥+ ∥fN(x) −f(x)∥≤∥fN∥+ ε.
Since x ∈X is arbitrary, we see that f ∈B(X, Y ). Also, it follows from (1)
that ∥fm −f∥≤ε for all m ≥N. Since ε > 0 is arbitrary, (fn) converges
to f in B(X, Y ). Hence B(X, Y ) is complete.
2
(4.5.2) Exercises
.1
Let Y be a ﬁnite–dimensional Banach space, and {e1, . . . , en} a basis
of Y. Prove that each f ∈B(X, Y ) can be written uniquely in the
form x →n
k=1 fk(x)ek with each fk ∈B(X, F). Prove also that for
each k, f →fk is a bounded linear mapping of B(X, Y ) into B(X, F).
.2
Prove that the mapping f →supt∈X f(x) of B(X, R) into R is
continuous.
.3
Let Y be a Banach space, and ∞
n=1 fn a series in B(X, Y ). Let
∞
n=1 cn be a convergent series of nonnegative real numbers such that
∥fn∥≤cn for each n. Show that ∞
n=1 fn converges in the Banach
space B(X, Y ).
.4
Let I = [a, b] be a compact interval, and BV(I) the linear space of
all real–valued functions of bounded variation on I, with pointwise
operations. Show that
∥f∥bv = |f(a)| + Tf(a, b)

206
4. Analysis in Normed Linear Spaces
deﬁnes a norm on BV(I), and that BV(I) is complete with respect to
this norm. (For the second part recall Exercise (1.5.15: 6).)
Let f, f1, f2, . . . be mappings of a nonempty set X into a metric space
(Y, ρ). We say that the sequence (fn)
• converges simply to f on X if for each x ∈X the sequence (fn(x))
converges to f(x) in Y ;
• converges uniformly to f on X if
sup
x∈X
ρ(fn(x), f(x)) →0 as n →∞.
Clearly, uniform convergence implies simple convergence; but, as the next
exercise shows, the converse is false.
(4.5.3) Exercises
.1
Give an example of a sequence (fn) of continuous mappings from
[0, 1] into [0, 1] that converges to 0 simply, but not uniformly, on [0, 1].
(Consider a spike of height 1 travelling along the x–axis towards 0.)
.2
Let Y be a normed space. Prove that a sequence (fn) in B(X, Y )
converges to a limit f in the normed space B(X, Y ) if and only if
(fn) converges uniformly to f on X.
.3
Let X be a compact metric space, and (fn), (gn) strictly increasing
sequences of real–valued functions on X that converge simply to the
same bounded function f : X →R. Show that for each m there exists
n such that fm < gn (that is, fm(x) < gn(x) for all x ∈X). Show
also that we cannot omit “compact” from the hypotheses.
Now let (X, ρ) be a metric space, and Y a normed space. The set of all
continuous mappings of X into Y is denoted by C(X, Y ) or CY (X), and
the set of all bounded continuous mappings of X into Y by C∞(X, Y ) or
C∞
Y (X); so
C∞(X, Y ) = B(X, Y ) ∩C(X, Y ).
If X is compact, then C∞(X, Y ) = C(X, Y ), by Exercise (3.3.7: 1). In gen-
eral, C∞(X, Y ) is a linear subspace of B(X, Y ); we consider it as a normed
space, taken with the sup norm.
We usually write C∞(X) and C(X), respectively, instead of C∞(X, R)
and C(X, R).
(4.5.4) Proposition.
If X is a metric space and Y a Banach space, then
C∞(X, Y ) is a closed, and therefore complete, subspace of B(X, Y ).

4.5 Function Spaces
207
Proof.
Let (fn) be a sequence of elements of C(X, Y ) converging to a
limit f in B(X, Y ). For each ε > 0 there exists N such that ∥f −fn∥≤ε/3
whenever n ≥N. Given x0 in X, construct a neighbourhood U of x0 such
that if x ∈U, then ∥fN(x) −fN(x0)∥≤ε/3. For each x ∈U we then have
∥f(x) −f(x0)∥≤∥f(x) −fN(x)∥+ ∥fN(x) −fN(x0)∥
+ ∥fN(x0) −f(x0)∥
≤∥f −fN∥+ ε
3 + ∥fN −f∥
= ε.
Since ε > 0 and x0 ∈X are arbitrary, it follows that f is continuous on X.
Thus C∞(X, Y ) is closed in B(X, Y ); whence, by Propositions (4.5.1) and
(3.2.9), C∞(X, Y ) is complete.
2
Proposition (4.5.4) shows that a uniform limit of bounded continuous
functions is continuous. Taken with Exercise (4.5.3: 1), this observation
highlights the signiﬁcance of the next theorem.
(4.5.5) Dini’s Theorem.
Let X be a compact metric space, and (fn) an
increasing sequence in C(X) that converges simply to a continuous function
f. Then (fn) converges to f uniformly.
Proof.
Let ε > 0. For each x ∈X there exists Nx such that if n ≥Nx,
then 0 ≤f(x)−fn(x) ≤ε/3. Since f and fNx are continuous, there exists an
open neighbourhood Ux of x such that if x′ ∈Ux, then |f(x) −f(x′)| ≤ε/3
and |fNx(x) −fNx(x′)| ≤ε/3; whence
0 ≤f(x′) −fNx(x′)
≤|f(x) −f(x′)| + f(x) −fNx(x) + |fNx(x) −fNx(x′)|
≤ε
3 + ε
3 + ε
3
= ε.
Since X is compact, there are ﬁnitely many points x1, . . . , xν of X such
that the neighbourhoods Uxi cover X. Setting
nε = max{Nxi : 1 ≤i ≤ν},
consider n ≥nε. Given x ∈X, choose i such that x ∈Uxi; then
0 ≤f(x) −fn(x) ≤f(x) −fnε(x) ≤f(x) −fNxi(x) ≤ε.
Since ε > 0 and x ∈X are arbitrary, we conclude that (fn) converges to f
uniformly.
2
(4.5.6) Exercises

208
4. Analysis in Normed Linear Spaces
.1
Show that “increasing” can be replaced by “decreasing” in Dini’s
Theorem.
.2
Give an alternative proof of Dini’s Theorem using the sequential
compactness of X.
.3
Let X be a metric space, Y a Banach space, and D a dense subset of
X. Let (fn) be a sequence of bounded continuous mappings of X into
Y such that the restrictions of the functions fn to D form a uniformly
convergent sequence. Prove that (fn) is uniformly convergent on X.
.4
Let X be a metric space, and Y a normed space. Prove that the
mapping (x, f) →f(x) is continuous on X × C∞(X, Y ) .
.5
Let I be a compact interval in R, and (fn) a sequence of increasing
real functions on I that converges simply in I to a continuous function
f. Prove that f is increasing and that (fn) converges to f uniformly
on I.
.6
Let a, b be real numbers with b > 0, and let X be the set of all
continuous mappings f : [0, b] →R such that f(0) = a. Prove that
X is complete with respect to the sup norm.
.7
Let I be a compact interval in R, x0 ∈I, and α > 0. Show that
∥f∥′ = sup

e−α|x−x0| |f(x)| : x ∈I

deﬁnes a norm on C(I), and that C(I) is complete with respect to this
norm.
.8
In the notation of Exercise (4.5.2: 4) prove that if a sequence (fn)
converges to a limit f with respect to the norm ∥·∥bv on BV(I), then
it converges to f with respect to the sup norm on B(I).
With I = [0, 1] ﬁnd a sequence in BV(I) ∩C(I) that
(i) converges to a limit f ∈C(I) with respect to the sup norm, and
(ii) is not a Cauchy sequence with respect to ∥·∥bv .
(Note Exercise (1.5.15: 4).)
Let X be a metric space, Y a normed space, and F a subset of B(X, Y ).
We say that F is
• equicontinuous at a ∈X if for each ε > 0 there exists δ > 0 such that
∥f(x) −f(a)∥< ε whenever f ∈F and ρ(x, a) < δ,
• equicontinuous (on X) if it is equicontinuous at each point of X;

4.5 Function Spaces
209
• uniformly equicontinuous if for each ε > 0 there exists δ > 0 such that
∥f(x) −f(y)∥< ε whenever f ∈F, x ∈X, y ∈X, and ρ(x, y) < δ.
Clearly, uniform equicontinuity implies equicontinuity, and if F is equicon-
tinuous at a, then each f ∈F is continuous at a.
(4.5.7) Exercises
In these exercises, X, Y, and F are as in the ﬁrst sentence of the last
paragraph.
.1
Suppose that there exist constants c > 0 and λ ≥1 such that
∥f(x) −f(y)∥≤c ρ(x, y)λ
for all f
∈
F and all x, y
∈
X. Show that F is uniformly
equicontinuous.
.2
Let α > 0, and let F be the set of all mappings f : [0, 1] →R such
that f ′ exists, is continuous, and has sup norm at most α. Show that
F is uniformly equicontinuous.
.3
Show that {xn : n ∈N} is not equicontinuous at 1.
.4
Let (fn) be an equicontinuous sequence of real–valued functions on
X. Prove that the sequence
(f1 ∨f2 ∨· · · ∨fn)∞
n=1
is also equicontinuous.
.5
For each λ ∈L let Fλ ⊂B(X, Y ) be equicontinuous at a. Prove
that if L is a ﬁnite set, then 
λ∈L Fλ is equicontinuous at a. Give an
example where L is an inﬁnite set and 
λ∈L Fλ is not equicontinuous
at a.
.6
Let (fn) be a sequence of functions in B(X, Y ) that converges simply
to a function f and is equicontinuous at a ∈X. Prove that f is
continuous at a. Hence prove that the closure of an equicontinuous
set in C∞(X, Y ) is equicontinuous.
.7
Prove that if X is compact and F ⊂C(X, Y ) is equicontinuous, then
F is uniformly equicontinuous.
.8
Suppose that X is compact, and let (fn) be a convergent sequence
in C(X, Y ). Prove that (fn) is uniformly equicontinuous. (Let f =
limn→∞fn. Given ε > 0, choose N such that ∥f −fn∥< ε for all
n ≥N. First ﬁnd δ1 > 0 such that ∥fn(x) −fn(y)∥< 3ε whenever
ρ(x, y) < δ1 and n ≥N.)

210
4. Analysis in Normed Linear Spaces
.9
Suppose that X is compact, and that (fn) is an equicontinuous se-
quence in C (X, Y ) that converges simply to a function f : X →Y.
Then f is continuous on X, by Exercise (4.5.7: 6). Show that (fn)
converges uniformly to f. (Given ε > 0, use Exercise (4.5.7: 7) to ob-
tain δ as in the deﬁnition of “uniformly equicontinuous”. Then cover
X by ﬁnitely many balls of the form B(x, δ).)
.10 Let (fn) be a sequence of continuous real–valued mappings on a
compact interval I.
(i) Prove that if (fn) is a Cauchy sequence in C(I), then it is a
Cauchy sequence in L2(I).
(ii) Prove that if (fn) is both equicontinuous and a Cauchy sequence
relative to the L2–norm, then (fn) converges in C(I).
(For (ii) ﬁx t0 ∈I and ε > 0. Choose δ > 0 such that if t ∈I
and |t −t0| < δ, then |fn(t) −fn(t0)| < ε for all n. Let χ be the
characteristic function of I ∩[t0 −δ, t0 + δ], and show that
$
χ(t) |fm(t0) −fn(t0)|2 dt < cδε2
for some constant c > 0 and all suﬃciently large m and n. Deduce
that (fn(t0)) is a Cauchy sequence in I.)
Show that the equicontinuity hypothesis cannot be dropped in (ii).
If X is compact and Y is a Banach space, then we have a powerful
characterisation of totally bounded subsets of C(X, Y ).
(4.5.8) Ascoli’s Theorem.2
Let X be a compact metric space, Y a
normed space, and F a subset of C(X, Y ). Then F is totally bounded if and
only if
(i) F is equicontinuous and
(ii) for each x ∈X,
Fx = {f(x) : f ∈F}
is a totally bounded subset of Y.
Proof.
Assume ﬁrst that F is totally bounded, and let ε > 0. Construct a
ﬁnite ε–approximation {f1, . . . , fN} to F. Then for each f in F there exists
i such that ∥f −fi∥≤ε. So for each x ∈X we have ∥f(x) −fi(x)∥≤ε,
from which it follows that {f1(x), . . . , fN(x)} is an ε–approximation to Fx.
2This is also known as the Ascoli–Arzel`a Theorem.

4.5 Function Spaces
211
Hence Fx is totally bounded. On the other hand, choose δ > 0 such that if
ρ(x, y) < δ, then ∥fk(x) −fk(y)∥≤ε for each k. With f and fi as in the
foregoing, we have
∥f(x) −f(y)∥≤∥f(x) −fi(x)∥+ ∥fi(x) −fi(y)∥
+ ∥fi(y) −f(y)∥
≤ε + ε + ε
= ε.
Hence F is equicontinuous.
Now assume, conversely, that conditions (i) and (ii) hold, and let ε be
any positive number. For each x ∈X choose an open neighbourhood Ux
of x such that ∥f(y) −f(x)∥< ε for each f ∈F and each y ∈Ux. Since
X is compact, it can be covered by a ﬁnite family {Ux1, . . . ,Uxm} of such
neighbourhoods. Now, the sets Fxi (1 ≤i ≤m) are totally bounded, as
is therefore their union K. Let {ξ1, . . . , ξn} be a ﬁnite ε–approximation to
K. On the other hand, let Φ be the ﬁnite set of all mappings of {1, . . . , m}
into {1, . . . , n}, and for each ϕ ∈Φ let
Sϕ =

f ∈F :
44f(xi) −ξϕ(i)
44 ≤ε (1 ≤i ≤m)

.
Then for each f ∈F there exists ϕ ∈Φ such that f ∈Sϕ. Since there
are only ﬁnitely many of the sets Sϕ (some of which may be empty), to
complete the proof that F is totally bounded it suﬃces to prove that the
diameter of each Sϕ is at most 4ε. To this end, consider any ϕ ∈Φ and
any two elements f, g of Sϕ. Given x ∈X, choose i such that x ∈Uxi.
Then ∥f(x) −f(xi)∥≤ε and ∥g(x) −g(xi)∥≤ε. But
44f(xi) −ξϕ(i)
44 ≤ε
and
44g(xi) −ξϕ(i)
44 ≤ε; two applications of the triangle inequality show,
in turn, that ∥f(xi) −g(xi)∥≤2ε and ∥f(x) −g(x)∥≤4ε. Since x ∈X is
arbitrary, it follows that ∥f −g∥≤4ε; whence diam(Sϕ) ≤4ε.
2
(4.5.9) Exercises
.1
Let X be compact, and let (fn) be a bounded equicontinuous se-
quence of mappings of X into Y. Prove that there exists a subsequence
(fnk)∞
k=1 such that (fnk(x))∞
k=1 converges for each x ∈X. (Let (xn)
be a dense sequence in X. Setting f0,n = fn, construct sequences
(fi,n)∞
n=1 (i = 0, 1, . . .) such that for all i and n,
(i) (fi+1, n) is a subsequence of (fi,n) and
(ii) (fi,n(xi))∞
n=1 converges in Y.
Then show that (fn,n(x)) converges in Y for each x ∈X.)
Use this result to give another proof of the “if” part of Ascoli’s
Theorem.

212
4. Analysis in Normed Linear Spaces
.2
Let c0, c1 > 0, and let S consist of all diﬀerentiable functions f :
[0, 1] →R such that ∥f∥≤c0 and ∥f ′∥≤c1. Prove that S is a
compact subset of C[0, 1].
.3
For each positive integer n and each x ≥0 let
fn(x) = sin

x + 4n2π2.
Prove that
(i) (fn) is equicontinuous on R0+;
(ii) (fn) converges simply to 0 on R0+;
(iii) (fn) is not totally bounded in C∞(R0+).
(For the last part, show that if (fn) were totally bounded, then it
would converge to 0 uniformly on R0+.)
4.6
The Theorems of Weierstrass and Stone
In this section we follow a path from the famous, and widely applicable,
approximation theorem of Weierstrass to its remarkable generalisation by
Stone.
(4.6.1) The Weierstrass Approximation Theorem.
If I is a com-
pact interval in R, then the set of polynomial functions on I is dense in
C(I).
Thus for each f ∈C(I) and each ε > 0 there exists a polynomial function
p on I such that
∥f −p∥= sup {|f(x) −p(x)| : x ∈I} < ε.
In other words, each element of C(I) can be uniformly approximated, to
any degree of accuracy, by polynomial functions.
We derive the Weierstrass Approximation Theorem as a simple conse-
quence of a more general theorem about linear operators on C(I).
By a positive linear operator on C(X), where X is any metric space, we
mean a linear mapping L : C(X) →C(X) such that Lf ≥0 whenever
f ≥0.
In the remainder of this section we let pk denote the monomial function
x →xk on R.
(4.6.2) Korovkin’s Theorem.
Let I be a compact interval in R, and
(Ln) a sequence of positive linear operators on C(I) such that
lim
n→∞Lnpk = pk
(k = 0, 1, 2).

4.6 The Theorems of Weierstrass and Stone
213
Then Lnf →f for all f ∈C(I).
Proof.
For each t in I let gt be the element of C(I) deﬁned by
gt(x) = (t −x)2 = t2p0(x) −2tp1(x) + p2(x).
The linearity of Ln implies that
Lngt = t2Lnp0 −2tLnp1 + Lnp2 ;
whence
0 ≤(Lngt) (t)
= t2 ((Lnp0) (t) −1) −2t ((Lnp1) (t) −t) +

(Lnp2) (t) −t2	
≤t2 ∥Lnp0 −p0∥+ |2t| ∥Lnp1 −p1∥+ ∥Lnp2 −p2∥.
Since t2 and |2t| are bounded on I, our hypotheses ensure that (Lngt) (t) →
0 uniformly on I as n →∞. We use this observation shortly.
Given f ∈C(I) and ε > 0, and noting the Uniform Continuity Theorem
(Corollary (3.3.13)), choose δ > 0 such that if x, y ∈I and |x −y| < δ,
then |f(x) −f(y)| < ε. Fix t in I, and consider any x ∈I. If |t −x| ≥δ,
then
|f(t) −f(x)| ≤2 ∥f∥≤2 ∥f∥(t −x)2
δ2
= 2
δ2 ∥f∥gt(x).
It follows from this and our choice of δ that
|f(t) −f(x)| ≤2
δ2 ∥f∥gt(x) + ε
for all x in I. Hence
−εp0 −2
δ2 ∥f∥gt ≤f(t)p0 −f ≤εp0 + 2
δ2 ∥f∥gt.
Since Ln is linear and positive, we have
−εLnp0 −2
δ2 ∥f∥Lngt ≤f(t) Lnp0 −Lnf ≤εLnp0 + 2
δ2 ∥f∥Lngt.
Hence
|f(t)(Lnp0)(t) −(Lnf)(t)| ≤ε ∥Lnp0∥+ 2
δ2 ∥f∥(Lngt)(t).
Thus
|f(t) −(Lnf)(t)|
≤|f(t) −f(t) (Lnp0)(t)| + |f(t) (Lnp0)(t) −(Lnf)(t)|
≤|f(t)| |1 −(Lnp0)(t)| + ε ∥Lnp0∥+ 2
δ2 ∥f∥(Lngt)(t)
≤∥f∥∥p0 −Lnp0∥+ ε (∥p0∥+ ∥p0 −Lnp0∥) + 2
δ2 ∥f∥(Lngt)(t).

214
4. Analysis in Normed Linear Spaces
It now follows from our hypotheses, and the observation in the ﬁrst
paragraph of the proof, that ∥f −Lnf∥→0 as n →∞.
2
Proof of the Weierstrass Approximation Theorem.
Without loss
of generality, take I = [0, 1]. For each f ∈C(I) and each positive integer n
deﬁne the corresponding Bernstein polynomial Bnf by
(Bnf) (x) =
n

k=0
n
k

xk(1 −x)n−kf(k/n).
Then Bn is a positive linear operator on C(I). Routine calculations (with
reference to the binomial theorem) show that Bnp0 = p0, that Bnp1 = p1,
and that
(Bnp2) (x) = n −1
n
x2 + 1
nx →x2 as n →∞.
It follows from Korovkin’s theorem that limn→∞∥f −Bnf∥= 0 for each
f ∈C(I).
2
(4.6.3) Exercises
.1
Show that there is no loss of generality in our taking I = [0, 1] in the
proof of the Weierstrass Approximation Theorem.
.2
Prove that Bnp0 = p0, that Bnp1 = p1, and that
(Bnp2) (x) = n −1
n
x2 + 1
nx →x2 as n →∞.
.3
Let f(x) = x3. Calculate Bn(f), and hence prove that Bn(f) →f as
n →∞.
.4
Prove that if p is a polynomial function of degree at most k on [0, 1],
then so is Bn(p) for each n. (Use induction on k.)
.5
Prove that there is only one positive linear operator L on C[0, 1] such
that L(f) = f for all quadratic polynomial functions. (Use Korovkin’s
Theorem.)
.6
Suppose that f and f ′ belong to C(I), where I is a compact interval.
Prove that for each ε > 0 there exists a polynomial function p such
that ∥f −p∥< ε and ∥f ′ −p′∥< ε. (Reduce to the case I = [0, 1].
First ﬁnd a polynomial q such that ∥f ′ −q∥< ε.)
.7
Let I be a compact interval contained in (0, 1). For each f ∈C(I)
and each n ∈N deﬁne Qnf on I by
(Qnf) (x) =
n

k=0
5n
k

f(k/n)
6
xk(1 −x)n−k,

4.6 The Theorems of Weierstrass and Stone
215
where ⌊t⌋denotes the integer part of t. Prove that ∥Bnf −Qnf∥→0
and hence that, on I, f is the uniform limit of a sequence of
polynomials with integer coeﬃcients.
.8
A function f : R →C is said to be periodic if
α = min {τ > 0 : ∀t ∈R (f(t + τ) = f(t))}
exists and is positive, in which case α is called the period of f and f
is also said to be α–periodic.
Prove Korovkin’s Theorem for 2π–periodic functions: let I = [−π, π],
let
P(I) = {f ∈C(I) : f(−π) = f(π)} ,
and let (Ln) be a sequence of positive linear operators on P(I) such
that Lnf →f uniformly as n →∞for f = 1, cos, and sin; then
Lnf →f uniformly for all f ∈P(I). (Write z = cos x and apply
Theorem (4.6.2).)
.9
Although this exercise mentions Fourier series, it does not require any
knowledge of Fourier analysis. Let I = [−π, π]. For each f ∈P(I) the
kth partial sum of the Fourier series of f is
(Skf) (x) = a0
2 +
k

n=1
(an cos nx + bn sin nx) ,
where for n ≥1,
an = 1
π
$ π
−π
f (t) cos t dt,
bn = 1
π
$ π
−π
f (t) sin t dt.
The nth Ces`aro mean of the Fourier series of f is
Gnf = 1
n
n−1

k=0
Skf.
Prove that
(Gnf) (x) =
1
2nπ
$ π
−π
f(t + x)
sin 1
2nt
sin 1
2t
2
dt,
and hence that Gn is a positive linear operator on P(I). Then prove
that for each f ∈P(I), (Gnf) converges to f uniformly on I. (Use
the preceding exercise.)

216
4. Analysis in Normed Linear Spaces
The following result, which was proved by M¨untz in 1914, is an interesting
generalisation of the Weierstrass Approximation Theorem.
Let (λn)∞
n=1 be a sequence in [1, ∞) that diverges to ∞. Then
span

1, xλ1, xλ2, . . .

is dense in C[0, 1] if and only if the series
∞
n=1 1/λn diverges to ∞.
An elementary proof of M¨untz’s Theorem can be found on pages 193–198
of [10]. Here is a very recent generalisation of M¨untz’s Theorem, due to P.
Borwein and T. Erd´elyi [6].
Let (λn)∞
n=1 be a sequence of distinct positive real numbers.
Then span

1, xλ1, xλ2, . . .

is dense in C[0, 1] if and only if
∞
n=1 λn
#
λ2
n + 1
	
diverges to ∞.
A diﬀerent, more abstract, generalisation of Theorem (4.6.1) was given
by Stone in 1937. In this generalisation we let X be a compact metric
space; we consider C(X) as an algebra, with the pointwise operations of
addition, multiplication, and multiplication–by–scalars; and we are inter-
ested in dense subalgebras of C(X). The property introduced in the next
deﬁnition plays a key role in the proof of the Stone–Weierstrass theorem.
We say that a set A of real–valued functions on a metric space X sepa-
rates the points of X if for each pair x, y of distinct points of X there exists
f ∈A such that f(x) ̸= f(y).
(4.6.4) The Stone–Weierstrass Theorem.
Let X be a compact metric
space, and A a subalgebra of C(X) that contains the constant functions and
separates the points of X. Then A is dense in the Banach space C(X).
The next two lemmas lead us to the proof of this theorem.
(4.6.5) Lemma.
Under the hypotheses of Theorem (4.6.4), if ϕ, ψ ∈A,
then ϕ ∧ψ and ϕ ∨ψ belong to the closure of A in C(X).
Proof.
Given f ∈A and ε > 0, ﬁrst apply the Weierstrass Approximation
Theorem (4.6.1) to construct a polynomial function p such that
| |t| −p(t)| < ε
(0 ≤t ≤∥f∥).
Then
| |f(x)| −p ◦f(x)| < ε
(x ∈X).
Since ε is arbitrary, we see that |f| ∈A. The desired conclusion now follows
by taking f = |ϕ −ψ| and noting the identities
ϕ ∧ψ = 1
2 (ϕ + ψ −|ϕ −ψ|) ,
ϕ ∨ψ = 1
2 (ϕ + ψ + |ϕ −ψ|) .
2

4.6 The Theorems of Weierstrass and Stone
217
(4.6.6) Lemma.
Under the hypotheses of Theorem (4.6.4), for each pair
x, y of distinct points of X and each pair a, b of real numbers, there exists
g ∈A such that g(x) = a and g(y) = b.
Proof.
Since A separates the points of X, there exists h ∈A such that
h(x) ̸= h(y). Deﬁne
g(t) = a + (b −a) h(t) −h(x)
h(y) −h(x).
Since A contains the constant functions and is an algebra, g ∈A . Clearly,
g(x) = a and g(y) = b.
2
Proof of the Stone–Weierstrass Theorem.
Given f ∈C(X) and
ε > 0, we need only show that there exists h ∈A such that ∥f −h∥< ε.
To this end, for each g in A deﬁne
U(g) = {x ∈X : g(x) < f(x) + ε} ,
L(g) = {x ∈X : g(x) > f(x) −ε} ,
and note that, as g is continuous, U(g) and L(g) are open sets. It follows
from Lemma (4.6.6) that for each t ∈X the sets U(g), with g ∈A and
g(t) = f(t), form an open cover of X. Since X is compact, we can extract
a ﬁnite subcover {U(g1), . . . , U(gn)} of X. Deﬁne
ht = g1 ∧g2 ∧· · · ∧gn.
Then ht ∈A, by Lemma (4.6.5); ht(x) < f(x) + ε for each x ∈X; and
ht(t) = f(t), so t ∈L(ht). Thus (L(ht))t∈X is an open cover of X, from
which we can extract a ﬁnite subcover, say {L(ht1), . . . , L(htm)} . Then the
function
h = ht1 ∨ht2 ∨· · · ∨htm
belongs to A, by Lemma (4.6.5); also,
f(x) −ε < h(x) < f(x) + ε
for each x ∈X, so ∥f −h∥< ε.
2
It is simple to verify that the Weierstrass Approximation Theorem is
the special case of the Stone–Weierstrass Theorem in which the algebra A
consists of all polynomial functions on the compact interval I. Since the
polynomial functions on I with rational coeﬃcients form a countable dense
set in this algebra A, we see that C(I) is a separable metric space; this is a
special case of the following more general corollary of the Stone–Weierstrass
Theorem.

218
4. Analysis in Normed Linear Spaces
(4.6.7) Corollary.
If X is a compact metric space, then the Banach
space C(X) is separable.
Proof.
Let (xn) be a dense sequence in X, and for each positive integer
k write
fn,k(t) = ρ(t, X\B(xn, k−1)).
The set S of all functions of the form
f α1
n1,k1f α2
n2,k2 · · · f αi
ni,ki,
with each αk a nonnegative integer, is countable. Hence the subspace A of
C(X) generated by S is separable (see the paragraph immediately preceding
Proposition (4.3.8)). So to complete the proof we need only show that A is
dense in C(X). Since A is a subalgebra of C(X), if S separates the points
of X we can invoke the Stone–Weierstrass Theorem. But for each pair x, y
of distinct points of X we can choose n, k such that x ∈B(xn, k−1) and
y ∈X\B(xn, k−1). We then have fn,k(x) ̸= 0 (as X\B(xn, k−1) is closed)
and fn,k(y) = 0.
2
(4.6.8) Exercises
.1
Let f be a strictly increasing continuous function on I = [0, 1]. Prove
that the subalgebra of C(I) generated by {1, f} is dense in C(I).
.2
Let X be a compact metric space containing at least two points, and
let A be the subalgebra of C(X) generated by the family
(t →ρ(t, x))x∈X .
Prove that A is dense in C(X).
.3
Deﬁne a sequence (un) of polynomial functions on R inductively, as
follows.
u1(t)
=
0,
un+1(t)
=
un(t) + 1
2

t −un(t)2	
.
Prove that un maps [0, 1] into [0, 1], and that the sequence (un(t))∞
n=1
converges uniformly to
√
t on [0, 1]. Hence prove that if A is a
subalgebra of C[0, 1] and f ∈A, then |f| ∈A.
This proof can be used to eliminate the reference to the Weierstrass
Approximation Theorem from the proof of the Stone–Weierstrass
Theorem, thereby making the former a genuine corollary of the latter.
.4
Let I be a compact interval in R, and f a continuous mapping of
the rectangle I × I into R. Prove that for each ε > 0 there exists a
polynomial
p(x, y) =
n

j,k=0
aj,kxjyk

4.7 Fixed Points and Diﬀerential Equations
219
such that
sup
x,y∈I
|f(x, y) −p(x, y)| < ε.
.5
Prove the Complex Stone–Weierstrass Theorem: let X be a compact
metric space, and A a subalgebra of C(X,C) that contains the con-
stant functions, separates the points of X, and is closed under com-
plex conjugation (so that f ∗∈A whenever f ∈A, where f ∗(x) =
f(x)∗); then A is dense in C(X, C).
Can we remove the hypothesis that A is closed under complex
conjugation?
.6
Use the Stone–Weierstrass Theorem to prove that each 2π–periodic
continuous function f : R →C is a uniform limit of a sequence of
trigonometric polynomials of the form
t →
N

n=−N
(an sin nt + bn cos nt) ,
where the coeﬃcients an, bn belong to C (cf. Exercise (4.6.3: 9). Let
S be the set of 2π-periodic elements of C∞(R, C). First note that
F(eit) = f(t)
deﬁnes an isometric isomorphism of S with C(T, C), where
T = {z ∈C : |z| = 1}
is the unit circle in the complex plane.)
.7
Let I be a compact interval, and p ≥1. Prove that the Banach space
Lp(I) is separable. Prove also that Lp(R) is separable. (First use
Exercise (2.3.10) to prove that C(I) is dense in Lp(I).)
4.7
Fixed Points and Diﬀerential Equations
In this ﬁnal section of the chapter we show how various ideas that have
appeared in the earlier sections are used to establish the existence of a so-
lution ϕ of the ﬁrst–order ordinary diﬀerential equation ϕ′(x) = f(x, ϕ(x))
on a compact interval. In order to do this, we ﬁrst introduce a fundamental
ﬁxed–point theorem.
Let X and Y be metric spaces, and f a mapping of X into Y . We say
that f satisﬁes a Lipschitz condition, or is a Lipschitz mapping, if there
exists a constant c > 0 such that ρ(f(x), f(y)) ≤c ρ(x, y) for all x, y in X;
c is then called a Lipschitz constant for f, and f is said to be Lipschitz

220
4. Analysis in Normed Linear Spaces
of order c. In the special case where 0 < c < 1, f is called a contraction
mapping of X into Y.
A Lipschitz map is uniformly continuous (Exercise (3.2.11: 6)).
A mapping of a metric space X into itself is called a self–map. By a ﬁxed
point of a self–map f : X →X we mean a point ξ ∈X such that f(ξ) = ξ.
(4.7.1)
Exercises
.1
Let
p(x, y) =
n

j,k=0
aj,kxjyk
be a polynomial function of two variables x, y. Prove that p satisﬁes
a Lipschitz condition on any bounded subset of R2.
.2
Let f be a mapping of a metric space X into itself, and deﬁne the
iterates of f inductively: for each x ∈X,
f n(x) =



x
if n = 0
f(f n−1(x))
if n ∈N+.
Prove that if, for some positive integer N, f N has a unique ﬁxed point
ξ, then ξ is a ﬁxed point of f, and f has no other ﬁxed point.
Fixed points play an important role in many applications of mathemat-
ics, including the solution of diﬀerential equations and the existence of
economic equilibria [51]. Many of these applications depend on our next
result, Banach’s Contraction Mapping Theorem.
(4.7.2) Theorem.
A contraction mapping of a nonempty complete
metric space into itself has a unique ﬁxed point.
Proof.
Let X be a nonempty complete metric space, f a contraction
mapping of X into itself, and c ∈(0, 1) a Lipschitz constant for f. Choose x0
in X, and deﬁne a sequence (xn)∞
n=1 inductively by setting xn = f(xn−1).
For each k ≥1 we have
ρ(xk, xk+1) = ρ(f(xk−1), f(xk))
≤c ρ(xk−1, xk)
≤· · ·
≤ckρ(x0, x1).

4.7 Fixed Points and Diﬀerential Equations
221
So if m > n ≥1, then
ρ(xn, xm) ≤
m−1

k=n
ρ(xk, xk+1)
≤
m−1

k=n
ckρ(x0, x1)
≤ρ(x0, x1)
∞

k=n
ck
= ρ(x0, x1) cn
1 −c →0 as n →∞.
Hence (xn) is a Cauchy sequence in the complete space X. Let ξ be its
limit in X; then
ξ = lim
n→∞xn = lim
n→∞f(xn−1) = f(ξ).
Thus ξ is a ﬁxed point of f.
Now suppose that η is a ﬁxed point of f distinct from ξ. Then
ρ(ξ, η) = ρ(f(ξ), f(η)) ≤c ρ(ξ, η) < ρ(ξ, η),
which is absurd. Hence ξ is the unique ﬁxed point of f in X.
2
Recall that a self–map f of a metric space X is said to be contractive
if ρ(f(x), f(y)) < ρ(x, y) for all distinct x, y in X; and that, according to
Edelstein’s Theorem (Exercise (3.3.7: 4)), a contractive self–map of a com-
pact metric space has a unique ﬁxed point. The next exercise shows that we
can neither remove the compactness hypothesis from Edelstein’s Theorem
nor replace the word “contraction” by “contractive” in the hypotheses of
Banach’s Contraction Mapping Theorem.
(4.7.3) Exercises
.1
Let B be the unit ball in the Banach space c0, and for each positive
integer n let en be the element of c0 whose nth term is 1 and all of
whose other terms are 0. Show that there is a unique linear mapping
u : c0 →c0 such that
u(en) =

1 −1
2n

en+1
for each n. Then show that
v(x) = 1
2 (1 + ∥x∥) e1 + u(x)
deﬁnes a contractive map of B into itself such that v(x) ̸= x for each
x ∈B. (For the last part note that 2n
k=1

1 −2−k	
≥1−n
k=1 2−k.)

222
4. Analysis in Normed Linear Spaces
.2
Let X, Y be Banach spaces over F, U the open ball in X with centre
0 and radius a, and V the open ball in Y with centre 0 and radius b.
Let 0 ≤c < 1, and let ϕ : U × V →Y be a continuous mapping such
that for all x ∈U,
(i) ∥ϕ(x, y1) −ϕ(x, y2)∥≤c ∥y1 −y2∥for all y1, y2 ∈V , and
(ii) ∥ϕ(x, 0)∥< b (1 −c) .
Show that there exists a unique mapping f : U →V such that
f(x) = ϕ(x, f(x)) for all x ∈U, and that f is continuous on U. (For
each x ∈U deﬁne
f0(x)
=
0,
fn+1(x)
=
ϕ(x, fn(x)).
Show that fn is a continuous mapping of U into V, that the series
∞
n=1 (fn −fn−1) converges absolutely in the Banach space B(U, F),
and that its sum is the required function f.)
.3
Let Y be a Banach space, y0 ∈Y, V = B(y0, b) ⊂Y, and 0 ≤c < 1.
Let v be a mapping of V into Y such that
(i) ∥v(y1) −v(y2)∥≤c ∥y1 −y2∥for all y1, y2 ∈V, and
(ii) ∥v(y0) −y0∥< b(1 −c).
Prove that v has a unique ﬁxed point in V.
.4
Let X be a metric space such that each continuous self–map of a
closed subset of S has a ﬁxed point. Prove that X is complete. (Sup-
pose the contrary, and choose a Cauchy sequence (xn) in X that does
not converge in X. Assuming, without loss of generality, that xi ̸= xj
whenever i ̸= j, for each x ∈X let
αx = inf {ρ(x, xn) : x ̸= xn} .
Show that αx > 0. Next, let 0 < r < 1, set σ(0) = 0, and deﬁne σ(n)
inductively such that σ(n) > σ(n −1) and
ρ(xi, xj) ≤rαxσ(n−1)
(i, j ≥σ(n)).
Let S =

xσ(n) : n ≥1

and f(xσ(n)) = xσ(n+1).)
.5
Let a, b be real numbers with 0 < b < 1, and let X be the set of all
continuous mappings f : [0, b] →R such that f(0) = a (so, according
to Exercise (4.5.6: 6), X is a Banach space relative to the sup norm).
Deﬁne a mapping T on X by
(Tf)(t) = a +
$ t
0
|f(x)| dx
(0 ≤t ≤b).

4.7 Fixed Points and Diﬀerential Equations
223
Prove that T is a contraction mapping of X into itself, and hence
that there exists a unique f ∈X that is diﬀerentiable and satisﬁes
f ′ = |f| on the interval (0, b).
A function ϕ is said to be continuously diﬀerentiable on an interval I of
R if ϕ′ exists and is continuous on I.
We now use Theorem (4.7.2) to prove the ﬁrst of two theorems about the
existence of solutions of ordinary diﬀerential equations, thereby generalising
the work of Exercise (4.7.3: 5).
(4.7.4) Picard’s Theorem.
Let K be the rectangle

(x, y) ∈R2 : |x −x0| ≤a, |y −y0| ≤b

where a, b > 0. Let f : K →R be a continuous mapping such that there
exists c > 0 with
|f(x, y1) −f(x, y2)| ≤c |y1 −y2|
for all applicable x, y1, y2 (in other words, f satisﬁes a Lipschitz condition
in its second variable). Let
M =
sup
(x,y)∈K
|f(x, y)|
and
h =



min

a, b
M

if M > 0
a
if M = 0.
Then there exists a unique continuously diﬀerentiable mapping ϕ on the
interval I = [x0 −h, x0 + h], such that
ϕ(x0) = y0
and
ϕ′(x) = f(x, ϕ(x)) for all x ∈I.
Proof.
In view of the version of the Fundamental Theorem of Calculus
in Exercise (1.5.14: 1), it suﬃces to ﬁnd a continuous mapping ϕ : I →R
satisfying
ϕ(x) = y0 +
$ x
x0
f(t, ϕ(t)) dt
(1)
for all x ∈I. Let V denote the closed ball with centre y →y0 and radius b
in the Banach space (C(I), ∥·∥) , where ∥·∥denotes the sup norm. If y ∈V,
then for all t ∈I we have |y(t) −y0| ≤b and therefore (t, y(t)) ∈K; so
Fy(x) = y0 +
$ x
x0
f(t, y(t)) dt

224
4. Analysis in Normed Linear Spaces
deﬁnes a mapping Fy : I →R. We see from Exercise (1.5.12: 4) that Fy
satisﬁes the Lipschitz condition
|Fy(x) −Fy(x′)| =
    
$ x
x′ f(t, y(t)) dt
    ≤M |x −x′|
and is therefore uniformly continuous on I. Moreover,
|Fy(x) −y0| ≤M |x −x0| ≤Mh ≤b
for all x ∈I, so y →Fy maps V into V.
We now endow C(I) not with its usual norm, but with the norm deﬁned
by
∥f∥′ = sup

e−2c|x−x0| |f(x)| : x ∈I

.
Recall from Exercise (4.5.6: 7) that C(I), and hence V, is complete with
respect to the metric ρ′ associated with this norm. We prove that y →Fy
is a contraction mapping on (V, ρ′) . To this end, consider y1, y2 ∈V and
x ∈I. Taking, for example, the case where x ≥x0, we have
|Fy1(x) −Fy2(x)| ≤
$ x
x0
|f(t, y1(t)) −f(t, y2(t))| dt
≤c
$ x
x0
|y1(t) −y2(t)| dt
≤c ∥y1 −y2∥′
$ x
x0
e2c|t−x0| dt
< 1
2e2c|x−x0| ∥y1 −y2∥′ ,
since
$ x
x0
e2c(t−x0) dt = 1
2c

e2c(x−x0) −1

.
It follows that
∥Fy1 −Fy2∥′ < 1
2 ∥y1 −y2∥′
(y1, y2 ∈C(I)).
Applying Banach’s Contraction Mapping Theorem (4.7.2), we now obtain
a unique element ϕ of V satisfying equation (1).
2
A restricted version of Picard’s Theorem can be proved by applying the
Contraction Mapping Theorem to a certain complete subset of C(I), taken
with the usual sup norm; this produces a positive number δ, which may be
smaller than h, and a solution of the diﬀerential equation on the interval
[x0 −δ, x0 + δ]. (See Chapter X of [13].) With a bit more work, it can
then be shown that that solution extends to I (Exercise (4.7.5: 4)). The

4.7 Fixed Points and Diﬀerential Equations
225
introduction of the norm ∥·∥′ —a device due to Bielicki [4]—both simpliﬁes
the proof and provides, at a stroke, the solution over the whole interval
I. (Note that when f is only known to be deﬁned on K, I is the largest
interval on which it makes sense to talk about a solution of the diﬀerential
equation y′ = f(x, y).)
By examining closely the proofs of Theorems (4.7.2) and (4.7.4), we
obtain the following iteration scheme for a sequence (yn) of functions
converging to a solution of the diﬀerential equation in the preceding
theorem.
y0(x)
=
y0,
yn(x)
=
y0 +
$ x
x0
f(t, yn−1(t)) dt
(n ≥1).
This scheme can be used in practice, although there are better methods of
ﬁnding solutions of ﬁrst–order diﬀerential equations of special types.
(4.7.5) Exercises
.1
Apply the foregoing iteration scheme to solve the diﬀerential equation
y′ = y on R with initial condition y (0) = 3.
.2
Let
K =

(x, y) ∈R2 : |x| ≤a, |y| ≤b

,
where a, b are positive constants. Let f be a continuous mapping of
K into R such that f(x, y) < 0 if xy > 0, and f(x, y) > 0 if xy < 0.
Prove that x →0 is the unique solution of the diﬀerential equation
y′ = f(x, y) deﬁned in a neighbourhood of 0 and such that y(0) = 0.
(Assume the contrary, and consider, in a compact interval containing
0, the points where a solution attains its maximum or minimum.)
.3
Deﬁne f : R2 →R by
f(x, y) =











−2x
if y ≥x2
−2y
x
if |y| < x2
2x
if y ≤−x2.
Deﬁne a sequence of functions by setting y0(x) = x2 and
yn+1(x) =
$ x
0
f(t, yn(t)) dt.
Show that for each x ̸= 0 the sequence (yn(x))∞
n=0 is not convergent.
Comment on this, in the light of Exercise (4.7.5: 2) and the paragraph
immediately preceding this set of exercises.

226
4. Analysis in Normed Linear Spaces
.4
Let x0, y0, I, and K be as in Theorem (4.7.4), and let f : K →R be a
continuous function with the following property: for each (ξ, η) ∈K◦
there exist δ > 0 and a unique continuously diﬀerentiable function
y : [ξ −δ, ξ + δ] →R such that y(ξ) = η and y′(x) = f(x, y(x))
whenever |x −ξ| ≤δ. Show that there exists a unique continuously
diﬀerentiable function ϕ : I →R such that ϕ(x0) = y0 and ϕ′(x) =
f(x, ϕ(x)) for all x ∈I. (Let S be the set of all positive numbers
δ ≤h with the property that there exists a continuously diﬀerentiable
function y : [x0 −δ, x0 + δ] →R such that y(x0) = y0 and y′(x) =
f(x, y(x)) whenever |x −x0| ≤δ. Let σ = sup S, suppose that σ < h,
and derive a contradiction.)
.5
Let I be the closed interval [a, b] in R, and
A =

(x, y) ∈R2 : a ≤x ≤y ≤b

.
Let the function k : I × I →R be continuous on A and vanish
everywhere on (I × I)\A, and for each f ∈C(I) deﬁne Tf : I →R
by
Tf(t) =
$ t
a
k(s, t)f(s) ds
(t ∈I).
Show that for all suﬃciently large n, T n is a contraction mapping of
C(I) into itself, and hence that the integral equation
f(t) = g(t) +
$ t
a
k(s, t)f(s) ds,
has a unique solution f in C(I) for each given g ∈C(I). (For the
contraction mapping part, show that
|T nf(x) −T ng(x)| ≤M n
n! (x −a)n ∥f −g∥
for all x ∈I and f, g ∈C(I).)
.6
Taking I = [0, 1], use the preceding exercise to ﬁnd the solution of
the integral equation
f(t) = g(t) + c
$ t
0
(t −s)3f(s) ds
(t ∈I),
where c is a positive constant and g ∈C(I).
.7
Let c > 0, let f be a continuous real–valued mapping that satisﬁes
the condition
|f(x, y1) −f(x, y2)| ≤c |y1 −y2|

4.7 Fixed Points and Diﬀerential Equations
227
on the strip [a, b] × R in R2, and let (x0, y0) be any point of that
strip. Prove that the diﬀerential equation y′ = f(x, y) has a unique
solution y : [a, b] →R such that y(x0) = y0. (For each x ∈[a, b]
deﬁne y0(x) = y0 and
yn+1(x) = y0 +
$ x
x0
f(t, yn(t)) dt.
Let
M = |y0| + max {|y1(x)| : a ≤x ≤b} .
Show that the series
y0 +
∞

n=1
(yn(x) −yn−1(x))
converges uniformly on [a, b] to a sum y(x), by comparison with the
series
M +
∞

n=1
cn−1M (b −a)n−1
(n −1)! .
Then show that y is the desired unique solution.)
.8
Let K be the compact set
{(x, y) ∈R × Rn : |x −x0| ≤a, ∥y −y0∥≤b} ,
where a, b > 0. Let f = (f1, . . . , fn) be a continuous mapping of K
into Rn such that there exists c > 0 with
|f(x, y1) −f(x, y2)| ≤c ∥y1 −y2∥
for all applicable x, y1, y2. Let
M =
sup
(x,y)∈K
∥f(x, y)∥
and
h =



min

a, b
M

if M > 0
a
if M = 0.
Prove that there exists a unique mapping ϕ = (ϕ1, . . . , ϕn) of the
interval I = [x0 −h, x0 + h] into Rn, such that
(i) ϕ(x0) = y0, and
(ii) for each k the component mapping ϕk is continuously diﬀeren-
tiable and satisﬁes ϕ′
k(x) = fk(x, ϕ(x)) on I.

228
4. Analysis in Normed Linear Spaces
.9
Let p, q, and r be continuous real–valued functions on the interval
[a, b] , let x0 ∈[a, b] , and let y0, y′
0 be real numbers. Use the preceding
exercise to prove that there exists a unique function y : [a, b] →R
satisfying the diﬀerential equation
y′′ + p(x)y′ + q(x) = r(x)
on [a, b], with initial conditions y(x0) = y0 and y′(x0) = y′
0.
Although Picard’s Theorem enables us to solve, both in principle and in
practice, a large class of diﬀerential equations, there are simple examples of
diﬀerential equations to which it does not apply and yet for which solutions
can easily be found. One such example is the equation y′ = y1/3 with initial
condition y(0) = 0: this equation has two solutions—namely, y = 0 and
y = (2x/3)3/2 —but the function (x, y) →y1/3 does not satisfy a Lipschitz
condition at (0, 0). The ﬁnal theorem of this chapter covers cases such as
this, and provides us with a good application of Ascoli’s Theorem and the
Stone–Weierstrass Theorem.
(4.7.6) Peano’s Theorem.
Let K be the rectangle

(x, y) ∈R2 : |x −x0| ≤a, |y −y0| ≤b

,
where a, b > 0. Let f : K →R be a continuous mapping,
M =
sup
(x,y)∈K
|f(x, y)|
and
h =



min

a, b
M

if M > 0
a
if M = 0.
Then there exists a continuously diﬀerentiable mapping ϕ on the interval
I = [x0 −h, x0 + h], such that
ϕ(x0) = y0
and
ϕ′(x) = f(x, ϕ(x)) for all x ∈I.
Proof.
Using Exercise (4.6.8: 4), construct a sequence (pn) of polynomial
functions of two variables such that ∥f −pn∥≤2−n for each n, where ∥·∥
denotes the sup norm on C(K). We may assume that |pn| ≤2M for each n.
By Exercise (4.7.1: 1), Picard’s Theorem, and the Fundamental Theorem
of Calculus, the integral equation
y(x) = y0 +
$ x
x0
pn(t, y(t)) dt

4.7 Fixed Points and Diﬀerential Equations
229
has a unique solution ϕn on the interval I. Exercise (1.5.12: 4) shows that
for all x1, x2 ∈I,
|ϕn(x2) −ϕn(x1)| ≤
    
$ x2
x1
pn(t, ϕn(t)) dt
    ≤2M |x2 −x1| .
It follows that (ϕn) is an equicontinuous sequence in C(I). Also, for each
x ∈I,
|ϕn(x)| ≤|y0| +
    
$ x
x0
pn(t, ϕn(t)) dt
    ≤|y0| + 2M |I| ;
so (ϕn) is a bounded sequence in C(I). Applying Ascoli’s Theorem (4.5.8),
and, if necessary, passing to a subsequence of (ϕn), we may now assume
that (ϕn) converges uniformly on I to an element ϕ of C(I). Since f is
uniformly continuous on K, for each ε > 0 there exists t > 0 such that if
(xi, yi) ∈K and
max {|x1 −x2| , |y1 −y2|} < t,
then
|f(x1, y1) −f(x2, y2)| < ε.
Choose N such that for all n ≥N,
∥ϕ −ϕn∥< min {t, ε}
and 2−n < ε. Consider any x ∈I and any n ≥N. Note that for each t ∈I,
(t, ϕ(t)) belongs to the closed set K and
|f(t, ϕ(t)) −f(t, ϕn(t))| < ε.
We now have
    
$ x
x0
f(t, ϕ(t)) dt −
$ x
x0
f(t, ϕn(t)) dt
    ≤ε |x −x0| < |I| ε
and therefore
    ϕ(x) −y0 −
$ x
x0
f(t, ϕ(t)) dt
    ≤|ϕ(x) −ϕn(x)|
+
    ϕn(x) −y0 −
$ x
x0
pn(t, ϕn(t)) dt
    
+
    
$ x
x0
(pn(t, ϕn(t)) −f(t, ϕn(t))) dt
    
+
    
$ x
x0
(f(t, ϕn(t)) −f(t, ϕ(t))) dt
    
< ε + 0 + |I| ∥f −pn∥+ |I| ε
= (1 + 2 |I|) ε.

230
4. Analysis in Normed Linear Spaces
Since ε > 0 is arbitrary, we conclude that
ϕ(x) = y0 +
$ x
x0
f(t, ϕ(t)) dt
(x ∈I).
A ﬁnal application of the Fundamental Theorem of Calculus (see Exer-
cise (1.5.14: 1)) shows that ϕ is continuously diﬀerentiable and satisﬁes the
desired conditions.
2
There are two fundamental diﬀerences between Picard’s Theorem and
Peano’s:
• in the former the solution is unique, whereas in the latter it need not
be;
• the proof of Picard’s Theorem embodies an algorithm for com-
puting the solution, but Peano’s Theorem uses the highly noncon-
structive property of sequential compactness and is an intrinsically
nonalgorithmic theorem.
By an ε–approximate solution to the diﬀerential equation
y′ = f(x, y),
y(x0) = y0
(2)
in an interval J containing x0 we mean a mapping y : J →R with the
following properties.
— There exists a partition (x1, x2, . . . , xn) of J such that y is continu-
ously diﬀerentiable on each of the intervals [xi, xi+1] ;
— |y′(x) −f(x, y(x))| ≤ε for all x ∈n−1
i=1 (xi, xi+1) ;
— y(x0) = y0.
(4.7.7) Exercises
.1
Under the hypotheses of Theorem (4.7.6), but without invoking that
theorem, show that for each ε > 0 there exists an ε-approximate
solution of (2). (Choose δ > 0 such that |f(x1, y1) −f(x2, y2)| ≤ε
whenever (xi, yi) ∈K and ∥(x1, y1) −(x2, y2)∥≤δ. Take points x0 <
x1 < · · · < xn = x0 + h such that xi+1 −xi ≤min {δ, δ/M} , and
construct an ε–approximate solution of (2) on [x0, x0 + h] that is
linear on each of the intervals [xi, xi+1] ; then deal with the interval
[x0 −h, x0]. This technique is known as the Cauchy–Euler method.)
.2
Under the hypotheses of Theorem (4.7.6), let (εn) be a sequence of
positive numbers converging to 0, and for each n let ϕn be an εn–
approximate solution of the diﬀerential equation (2) on I. Suppose
that (ϕn) converges uniformly to a continuous function ϕ on I. Prove
that

4.7 Fixed Points and Diﬀerential Equations
231
(i) (t, ϕ(t)) ∈K for each t ∈I ;
(ii)
% x
x0 f(t, ϕn(t)) dt →
% x
x0 f(t, ϕ(t)) dt uniformly on I as n →∞;
(iii) ϕ is a solution of the diﬀerential equation (2) on I.
.3
Use the preceding two exercises to give an alternative proof of Peano’s
Theorem.
.4
Let I, K, f, M, and c be as in the hypotheses of Picard’s Theorem. Let
ε1, ε2 > 0, and let ϕi be an εi–approximate solution to the diﬀerential
equation on I. Show that
|ϕ1(x) −ϕ2(x)| ≤|ϕ1(x0) −ϕ2(x0)| ec|x−x0| + (ε1 + ε2) ec|x−x0| −1
c
for each x ∈I. (Use Exercise (2.3.3: 14).) Hence ﬁnd an alternative
proof of Picard’s Theorem.

5
Hilbert Spaces
When shall we three meet again...?
Macbeth, Act 1, Scene 1
This chapter explores the elementary theory of Hilbert spaces. In Section 1 we
introduce the notion of an inner product, with its associated norm, on a linear
space, and prove some fundamental inequalities. The next section deals with
orthogonality, projections, and orthonormal bases in a Hilbert space, and with
their use in approximation theory. In Section 3 we derive Riesz’s characterisation
of the bounded linear functionals on a Hilbert space, and show how this can
be applied both in the theory of operators and to prove the existence of weak
solutions of the Dirichlet Problem.
5.1
Inner Products
So far we have shown how to abstract the notions of distance and length
from Euclidean space to the abstract contexts of a metric space and a
normed space, respectively. In this chapter we show how to abstract the no-
tion of the inner product in Rn to the context of a linear space. The result-
ing combination of distance, length, and inner product provides the space
with an extremely rich structure that turns out to have many signiﬁcant
applications in pure and applied mathematics. In particular—although we
are not able to explore that subject in this book—certain linear self–maps
of such a space are the mathematical analogues of quantum–mechanical
operations.

234
5. Hilbert Spaces
By an inner product on a linear space X over F we mean a mapping
(x, y) →⟨x, y⟩of X × X into F such that the following hold for all x, y, z
in X and all λ, µ in F.
IP1
⟨x, y⟩= ⟨y, x⟩∗.
IP2
⟨λx + µy, z⟩= λ⟨x, z⟩+ µ⟨y, z⟩.
IP3
⟨x, x⟩≥0, and ⟨x, x⟩= 0 if and only if x = 0.
The element ⟨x, y⟩of F is then called the inner product of the vectors x
and y. Note that by IP2, the inner product is linear in the ﬁrst variable;
and that by IP2 and IP1, it is conjugate linear in the second—that is,
⟨x, λy + µz⟩= λ∗⟨x, y⟩+ µ∗⟨x, z⟩.
We deﬁne an inner product space, or a prehilbert space, to be a pair
(X, ⟨·, ·⟩) consisting of a linear space X over F and an inner product ⟨·, ·⟩
on X. When there is no confusion over the inner product, we refer to X
itself as an inner product space. By a subspace of an inner product space
X we mean a linear subset S of X, taken with the inner product induced
on S by that on X; thus the inner product on S is the restriction to S × S
of the inner product on X.
The simplest example of an inner product space is the Euclidean space
Fn, with the inner product of vectors x = (x1, . . . , xn) and y = (y1, . . . , yn)
deﬁned by
⟨x, y⟩=
n

k=1
xky∗
k.
For another example consider the linear space l2(C) of square–summable
sequences in C, introduced in Exercise (4.4.4: 3), where the inner product
of two elements x = (xk) and y = (yk) is deﬁned as
⟨x, y⟩=
∞

k=1
xky∗
k.
This can be regarded as a generalisation of the ﬁrst example, since the one–
one mapping (x1, . . . , xn) →(x1, . . . , xn, 0, 0, . . .) of Cn into l2(C) preserves
the value of the inner product.
Before discussing a third example, in Exercise (5.1.1: 2), let us agree to
call a complex–valued function f on a subset X of R integrable if its real
and imaginary parts are integrable over X, in which case we deﬁne
$
X
f =
$
X
Re(f) + i
$
X
Im(f).
The complex integration spaces Lp(X, C) are then deﬁned in the obvious
way, and we use Lp(X, F) to denote either Lp(I) or Lp(X, C), depending
on whether F = R or F = C.

5.1 Inner Products
235
(5.1.1) Exercises
.1
Prove that the equation ⟨x, y⟩= ∞
n=1 xny∗
n does deﬁne an inner
product on l2(C). (You must ﬁrst prove that the series ∞
n=1 xny∗
n is
convergent when (xn) and (yn) are elements of l2(C).)
.2
By a weight function on a compact interval I = [a, b] we mean a
nonnegative continuous function w on I such that if f ∈C(I) and
%
I w(t)f(t) dt = 0, then f = 0. Prove that
⟨f, g⟩=
$ b
a
w(t)f(t)g(t)∗dt
deﬁnes an inner product on L2(I, F) (where, as always, we iden-
tify two elements of L2(I, F) that are equal almost everywhere). We
denote the corresponding inner product space by L2,w(I, F).
(5.1.2) Proposition.
Let X be an inner product space. Then
∥x∥= ⟨x, x⟩1/2
deﬁnes a norm on X. Moreover, the inner product and this norm satisfy
the Cauchy–Schwarz inequality
|⟨x, y⟩| ≤∥x∥∥y∥
and Minkowski’s inequality
⟨x + y, x + y⟩1/2 ≤⟨x, x⟩1/2 + ⟨y, y⟩1/2 .
Proof.
We ﬁrst prove the two inequalities. For any x, y ∈X and any
λ ∈F we have, by IP1 through IP3,
0 ≤⟨x + λy, x + λy⟩= ⟨x, x⟩+ ⟨x, λy⟩+ ⟨λy, x⟩+ ⟨λy, λy⟩,
so
∥x∥2 + λ∗⟨x, y⟩+ λ ⟨x, y⟩∗+ λλ∗∥y∥2 ≥0,
(1)
with equality if and only if x + λy = 0. If ∥y∦= 0, the Cauchy–Schwarz
inequality is obtained by taking λ = −⟨x, y⟩/ ∥y∥2; if ∥x∦= 0, the equality
is obtained by taking λ = −⟨x, y⟩/ ∥x∥2 ; if ∥x∥= ∥y∥= 0, then IP3 shows
that x = 0 = y and hence that ⟨x, y⟩= 0, so the Cauchy–Schwarz inequality
holds trivially.
Taking λ = 1 in (1) and using the Cauchy–Schwarz inequality, we obtain
⟨x + y, x + y⟩= ⟨x, x⟩+ 2 Re ⟨x, y⟩+ ⟨y, y⟩
≤⟨x, x⟩+ 2 |⟨x, y⟩| + ⟨y, y⟩
≤⟨x, x⟩+ 2 ∥x∥∥y∥+ ⟨y, y⟩
=

⟨x, x⟩1/2 + ⟨y, y⟩1/22
,

236
5. Hilbert Spaces
which immediately yields Minkowski’s inequality. It is now a simple ex-
ercise, involving this inequality and the deﬁning properties of an inner
product, to show that x →⟨x, x⟩1/2 is a norm on X.
2
When we refer to the norm or the metric structure on an inner product
space X, we always have in mind the norm, and the corresponding metric
structure, associated with the inner product as in Proposition (5.1.2).
(5.1.3) Exercises
.1
Complete the details of the proof that if ⟨·, ·⟩is an inner product on
a linear space X, then ∥x∥= ⟨x, x⟩1/2 deﬁnes a norm on X.
.2
Prove that an inner product on a linear space X is continuous, and
that it is uniformly continuous on bounded sets, with respect to the
corresponding product norm on X × X.
.3
Prove the parallelogram law for vectors x, y in an inner product space:
∥x + y∥2 + ∥x −y∥2 = 2 ∥x∥2 + 2 ∥y∥2 .
Interpreting a norm as a length, we see that this law generalises the
plane geometry theorem that the sum of the squares of the diagonals
of a parallelogram equals the sum of the squares of its sides.
.4
Use the parallelogram law to show that a Hilbert space is uniformly
convex (see Exercise (4.2.2: 15)).
.5
Let X be a normed space whose norm satisﬁes the parallelogram law
(see the exercise before last). Show that if F = R, then
⟨x, y⟩= 1
4

∥x + y∥2 −∥x −y∥2
deﬁnes an inner product on X such that ∥x∥= ⟨x, x⟩1/2 for each
x ∈X. Then show that if F = C, there is a unique inner product on
X related to the norm in this way.
.6
Prove that there is no inner product on C[0, 1] such that ⟨f, f⟩1/2 =
∥f∥(the supremum norm). (Show that the supremum norm does not
obey the parallelogram law.)
.7
Prove that the inner product space L2,w(I, F), introduced in Exer-
cise (5.1.1: 2), is complete. Prove also that C(I, F) is not a complete
subspace of this inner product space.

5.2 Orthogonality and Projections
237
An inner product space that is complete with respect to its norm is
called a Hilbert space. For example, the Euclidean space Fn is a Hilbert
space, as is l2(C). On the other hand, if w is a nonnegative weight function
on a compact interval I, then Exercise (5.1.3: 7) shows that L2,w(I, F) is
complete, but C(I, F) is not complete, with respect to the inner product
⟨f, g⟩=
$
I
w(t)f(t)g(t)∗dt.
(5.1.4) Exercises
.1
Let X be an inner product space, X0 a closed linear subspace of X,
and ϕ the canonical mapping of X onto the quotient space X/X0.
Prove that
⟨ϕ(x), ϕ(y)⟩= ⟨x, y⟩
unambiguously deﬁnes an inner product on X/X0, and that the
corresponding norm is the quotient norm on X/X0.
.2
Show that each inner product space X can be embedded as a dense
subset of a Hilbert space H. (Extend the inner product by continuity
to the completion of X, as deﬁned on page 179.) H is then known as
the (Hilbert space) completion of X.
.3
Prove that any two completions H and H′ of an inner product space
X are isomorphic, in the sense that there exists a one–one linear
mapping u of H onto H′ such that ⟨u(x), u(y)⟩= ⟨x, y⟩for all x, y ∈
H.
.4
Let I be a compact interval. Show that L2(I, F) is the completion of
the Hilbert space C(I, F) with respect to the inner product ⟨f, g⟩=
%
I f(t)g(t)∗dt.
5.2
Orthogonality and Projections
Two elements x, y of an inner product space X are said to be orthogonal if
⟨x, y⟩= 0, in which case we write x ⊥y. In view of IP1, the relation ⊥is
symmetric: x ⊥y if and only if y ⊥x. A vector x is said to be orthogonal
to the subset S of X if x ⊥s for each s ∈S; we then write x ⊥S. The
set of all vectors orthogonal to S is called the orthogonal complement of S,
and is written S⊥(pronounced “S perp”). It follows from IP2 that S⊥is a
(linear) subspace of X; and from IP3 that S ∩S⊥is nonempty if and only
if 0 ∈S, in which case S ∩S⊥= {0}. Moreover, S⊥is orthogonal to S,
in the sense that every element of S⊥is orthogonal to S: for, by Exercise
(5.1.3: 2), if (sn) is a sequence of elements of S converging to s ∈S, then
for each x ∈S⊥,
⟨x, s⟩= lim
n→∞⟨x, sn⟩= 0.

238
5. Hilbert Spaces
For each x ∈X, {x}⊥is the kernel of the continuous linear functional
z →⟨z, x⟩on X, and so, by Proposition (4.2.3), is a closed subspace of X.
Hence for each subset S of X,
S⊥=

s∈S
{s}⊥
is closed in X.
If x and y are orthogonal vectors, then, expanding ⟨x + y, x + y⟩, we
obtain Pythagoras’s Theorem:
∥x + y∥2 = ∥x∥2 + ∥y∥2 .
(5.2.1) Proposition.
Let S be a nonempty complete convex subset of an
inner product space X, and let a ∈X. Then there exists a unique vector s
in S such that ∥a −s∥= ρ(a, S).
Proof.
Let d = ρ(a, S), and choose a sequence (sn) in S such that
ρ(a, sn) →d. Using the parallelogram law (Exercise (5.1.3: 3)) and the
convexity of S, for all m and n we compute
∥sm −sn∥2 = ∥sm −a −(sn −a)∥2
= 2 ∥sm −a∥2 + 2 ∥sn −a∥2 −∥sm −a + (sn −a)∥2
= 2 ∥sm −a∥2 + 2 ∥sn −a∥2 −4
44 1
2(sm + sn) −a
442
≤2 ∥sm −a∥2 + 2 ∥sn −a∥2 −4d2
= 2

∥sm −a∥2 −d2
+ 2

∥sn −a∥2 −d2
→0 as m, n →∞.
Hence (sn) is a Cauchy sequence. Since S is complete, (sn) converges to a
limit s in S; then
∥a −s∥= lim
n→∞∥a −sn∥= ρ(a, S).
On the other hand, if s′ ∈S and ∥a −s′∥= ρ(a, S), then a computation
similar to the one used at the start of the proof shows that
∥s −s′∥2 = 2 ∥s −a∥2 + 2 ∥s′ −a∥2 −4
44 1
2(s + s′) −a
442
= 4

d2 −
44 1
2(s + s′) −a
442
≤0,
so that s = s′.
2

5.2 Orthogonality and Projections
239
It is worth digressing here to prove a converse of the foregoing result.
(5.2.2) Proposition.
Let S be a nonempty closed subset of the Euclidean
space RN such that each point of RN has a unique closest point in S. Then
S is convex.
Proof.
Supposing that S is not convex, we can ﬁnd a, b ∈S and λ ∈(0, 1)
such that
z = λa + (1 −λ) b /∈S.
Since X\S is open, there exists r > 0 such that B(z, r) ∩S = ∅. Let F
be the set of all closed balls B such that B(z, r) ⊂B and S ∩B◦= ∅;
then B(z, r) ∈F. The radii of the balls belonging to F are bounded above,
since any ball containing B and having suﬃciently large radius will meet
S. Let r∞be the supremum of the radii of the members of F, and let
(B(xn, rn))∞
n=1 be a sequence of elements of F such that rn →r∞. Then
xn ∈B(z, r∞) for each n. Since B(z, r∞) is compact (Theorem (4.3.6)) and
therefore sequentially compact (Theorem (3.3.9)), we may assume without
loss of generality that (xn) converges to a limit x∞. Let K = B(x∞, r∞);
we prove that K ∈F.
First we consider any x ∈B(z, r) and any ε > 0. Choosing m such that
∥xm −x∞∥< ε, and noting that B(z, r) ⊂B(xm, rm), we have
∥x −x∞∥≤∥x −xm∥+ ∥xm −x∞∥
< rm + ε
≤r∞+ ε.
Since ε is arbitrary, we conclude that ∥x −x∞∥≤r∞; whence B(z, r) ⊂K.
On the other hand, supposing that there exists s ∈S ∩B(x∞, r∞), choose
δ > 0 such that ∥s −x∞∥< r∞−δ, and then n such that 0 ≤r∞−rn < δ/2
and ∥xn −x∞∥< δ/2. We have
∥s −xn∥≤∥s −x∞∥+ ∥x∞−xn∥
< r∞−δ + δ
2
= r∞−δ
2
< rn,
so s ∈S∩B(xn, rn). This is absurd, as B(xn, rn) ∈F; hence S∩B(x∞, r∞)
is empty, and therefore K ∈F.
Now, the centre x∞of K has a unique closest point p in S. This point
cannot belong to K◦, as K ∈F; nor can it lie outside K, as r∞is the supre-
mum of the radii of the balls in F. Therefore p must lie on the boundary
of K. The unique closest point property of S ensures that the boundary of
K intersects S in the single point p. It now follows from Exercise (4.3.7: 7)
that there exists a ball K′ that is concentric with K, has radius greater

240
5. Hilbert Spaces
than r∞, and is disjoint from S. This ball must contain B(z, r) and so be-
longs to F. Since this contradicts our choice of r∞, we conclude that S is,
in fact, convex.
2
(5.2.3) Exercises
.1
Give an example of a norm ∥·∥′ on R2, a closed convex subset S of
R2, and a point x ∈R2 such that x has inﬁnitely many closest points
in S relative to ∥·∥′ .
.2
Let S be the subset of c0 consisting of all elements (xn) such that
∞
n=1 2−nxn = 0. Show that S is a closed subspace of c0 and that
no point of c0\S has a closest point in S. (Given a = (an) ∈c0\S,
set α = ∞
n=1 2−nan and show that ρ(a, S) ≤|α| . Let x = (xn) ∈S,
suppose that ∥a −x∥≤|α| , and obtain a contradiction.)
.3
Let S be a closed convex set in a uniformly convex Banach space
X. (See Exercise (4.2.2: 15).) Show that to each point a of X there
corresponds a unique closest point in S. (To prove existence, reduce
to the case where a = 0 and ρ(0, S) = 1. Then choose a sequence (sn)
in S such that ∥sn∥→1, and show that

∥sn∥−1 sn

is a Cauchy
sequence in X.)
.4
Give two proofs that c0 is not uniformly convex.
.5
Let S be a bounded closed subset of RN with the property that to
each x ∈RN there corresponds a unique farthest point of S—that is,
a point s0 of S such that
∥x −s0∥= sup {∥x −s∥: s ∈S} .
Show that S consists of a single point. (First show that S is bounded.
Then choose r > 0 such that S ⊂B(0, r/2), and consider the family
F of all closed balls B such that S ⊂B ⊂B(0, r). Show that F
contains a ball with minimum radius, and then show that that radius
is 0.)
Proposition (5.2.2) was ﬁrst proved by Motzkin in 1935, and the result
in Exercise (5.2.3: 5) by Motzkin, Straus, and Valentine in 1953.
We now turn from our digression to the subject of projections. In the
special case of Proposition (5.2.1) where S is a complete subspace of X, the
unique point of S closest to a given vector x ∈X is called the projection
of the vector x on S, and the mapping that carries each vector in X to its
projection on S is called the projection of X on S. For example,
• the projection of X on X is the identity operator I : X →X deﬁned
by Ix = x;

5.2 Orthogonality and Projections
241
• projections on ﬁnite–dimensional subspaces of X are always deﬁned,
since ﬁnite–dimensional normed spaces are complete, by Proposition
(4.3.3);
• the projection of a Hilbert space on any closed subspace is deﬁned,
in view of Proposition (3.2.9).
The next result enables us to show that projections are bounded linear
mappings.
(5.2.4) Proposition.
Let S be a complete subspace of an inner product
space X, and P the projection of X on S. Then for each x ∈X, Px is the
unique vector s ∈S such that x −s is orthogonal to S.
Proof.
Given x in X, let d = ρ(x, S). For all y in S and λ in F, we have
Px −λy ∈S, so that
⟨x −Px + λy, x −Px + λy⟩≥d 2 = ⟨x −Px, x −Px⟩,
and therefore
|λ|2 ∥y∥2 + 2 Re (λ∗⟨x −Px, y⟩) ≥0.
Suppose that Re ⟨x −Px, y⟩̸= 0; then by the Cauchy–Schwarz inequality,
y ̸= 0. Taking
λ = −⟨x −Px, y⟩
∥y∥2
,
we obtain the contradiction
|λ|2 ∥y∥2 + 2 Re (λ∗⟨x −Px, y⟩) < 0.
Thus Re ⟨x −Px, y⟩= 0. Likewise, Im ⟨x −Px, y⟩= 0, so ⟨x −Px, y⟩= 0.
If, conversely, s is any vector in S such that x −s is orthogonal to S,
then s −Px is in S, and so
⟨s −Px, s −Px⟩= ⟨x −Px, s −Px⟩−⟨x −s, s −Px⟩= 0;
whence s = Px, by IP3.
2
(5.2.5) Exercises
.1
Prove that if S is a complete subspace of an inner product space X,
then (S⊥)⊥= S.
.2
Let P be the projection of a Hilbert space H onto a complete subspace
S. Use Proposition (5.2.4) to show that P is a linear mapping, and
that
⟨Px, Py⟩= ⟨Px, y⟩= ⟨x, Py⟩
for all x, y ∈H. Show also that ∥Px∥≤∥x∥for all x ∈H, and that
if S ̸= {0} , then ∥P∥= 1.

242
5. Hilbert Spaces
.3
In the notation of the preceding exercise prove that each vector x ∈H
has a unique representation in the form x = y + z with y ∈S and
z ⊥S, and that I −P is the projection of H on S⊥.
.4
To each vector a in an inner product space X there corresponds a
linear functional ua deﬁned on X by
ua (x) = ⟨x, a⟩.
Prove that ua is bounded and has norm ∥a∥; and that if a ̸= 0, then
z = ∥a∥−2 a is in ker (ua)⊥, ua (z) = 1, and a = ∥z∥−2 z.
.5
Let f be a nonzero linear functional on the Euclidean space Rn.
Prove that there exists a nonzero vector p orthogonal to the hyper-
plane ker(f), such that f(x) = ⟨x, p⟩for each x ∈Rn. (Choose
a ∈Rn\ ker(f) such that f(a) = 1. Let b be the foot of the per-
pendicular from a to ker(f), and let p = λ(a −b) for an appropriate
value of λ. Note that each x ∈Rn can be written uniquely in the
form x = f(x)a + y with y ∈ker(f).)
A family (ei)i∈I of elements of an inner product space X is said to
be orthogonal if ⟨ei, ej⟩= 0 whenever i, j are distinct indices in I. If, in
addition, ∥ei∥= 1 for each i, then (ei) is called an orthonormal family; in
that case we call ⟨x, ei⟩the corresponding ith coordinate of the element x
of X.
For example, in the space L2 ([−π, π], C) , taken with the inner product
⟨f, g⟩= 1
2π
$ π
−π
f(t)g(t)∗dt,
the functions en (n = 0, ±1, ±2, . . .) form an orthonormal sequence, where
en(t) = eint.
The corresponding nth coordinate of f ∈L2 ([−π, π], C) is
1
2π
$ π
−π
f(t)e−int dt,
which is better known as the nth Fourier coeﬃcient of f.

5.2 Orthogonality and Projections
243
(5.2.6) Exercise
Verify the mathematical claims made in the last paragraph.
If (ei)i∈I is an orthonormal family in an inner product space X, then for
any ﬁnite index set J ⊂I the vectors ej (j ∈J) are linearly independent:
for if 
j∈J λjej = 0, where each λj ∈F, then for each i ∈J,
0 =
7
j∈J
λjej, ei
8
=

j∈J
λj ⟨ej, ei⟩= λi.
Thus the vectors ej (j ∈J) form a basis for a ﬁnite–dimensional subspace
of X.
(5.2.7) Lemma.
Let (en)N
n=1 be a ﬁnite orthonormal family in an inner
product space X. Then for each x ∈X,
44444x −
N

n=1
⟨x, en⟩en
44444
2
= ∥x∥2 −
N

n=1
|⟨x, en⟩|2 ,
44444
N

n=1
⟨x, en⟩en
44444
2
=
N

n=1
|⟨x, en⟩|2 ≤∥x∥2 ,
and x −N
n=1 ⟨x, en⟩en is orthogonal to each ek.
Proof.
For each n write λn = ⟨x, en⟩. Then
44444
N

n=1
⟨x, en⟩en
44444
2
=
7 N

m=1
λmem,
N

n=1
λnen
8
=
N

m,n=1
λmλ∗
n ⟨em, en⟩=
N

n=1
|λn|2 .
So
0 ≤
44444x −
N

n=1
λnen
44444
2
= ∥x∥2 −
7
x,
N

n=1
λnen
8
−
7 N

n=1
λnen, x
8
+
44444
N

n=1
λnen
44444
2
= ∥x∥2 −
N

n=1
λ∗
n ⟨x, en⟩−
N

n=1
λn ⟨x, en⟩∗+
N

n=1
|λn|2

244
5. Hilbert Spaces
= ∥x∥2 −2
N

n=1
|λn|2 +
N

n=1
|λn|2
= ∥x∥2 −
N

n=1
|λn|2 .
The ﬁrst two of the desired conclusions now follow. On the other hand,
7
x −
N

n=1
λnen, ek
8
= ⟨x, ek⟩−
N

n=1
λn ⟨en, ek⟩= ⟨x, ek⟩−λk = 0.
2
(5.2.8) Proposition.
If (ei)i∈I is an orthonormal family in an inner
product space X, then for each x ∈X,
Ix = {i ∈I : ⟨x, ei⟩̸= 0}
is either empty or countable.
Proof.
Lemma (5.2.7) shows that for each ﬁnite subset J of I we have

i∈J
|⟨x, ei⟩|2 ≤∥x∥2 .
Hence the set
Ix,n =

i ∈I : |⟨x, ei⟩|2 > n−1 ∥x∥2
has at most n −1 elements. Since Ix = ∞
n=1 Ix,n, we conclude that if Ix is
nonempty, then it is countable.
2
When (ei)i∈I is an orthonormal family in an inner product space X,
Proposition (5.2.8) enables us to make sense of certain summations, such
as 
i∈I |⟨x, ei⟩|2 , over possibly uncountable index sets. If Ix is empty, we
deﬁne 
i∈I |⟨x, ei⟩|2 = 0. If Ix is nonempty, it is either ﬁnite or countably
inﬁnite; taking, for example, the latter case (the former is even easier to
handle), we deﬁne

i∈I
|⟨x, ei⟩|2 =
∞

n=1
|⟨x, fn⟩|2 ,
(1)
where f1, f2, . . . is a one–one enumeration of Ix. Note that the series on the
right–hand side converges, since its terms are nonnegative and (by Lemma
(5.2.7)) its partial sums are bounded by ∥x∥2 ; it follows from Exercise
(1.2.17: 1) that the value of the expression on the left–hand side of (1)

5.2 Orthogonality and Projections
245
is independent of our choice of the one–one enumeration f1, f2, . . . of Ix.
Moreover, we have Bessel’s inequality

i∈I
|⟨x, ei⟩|2 ≤∥x∥2 .
In turn, when X is a Hilbert space, we can give meaning to another
important type of series. Writing
sk =
k

n=1
⟨x, fn⟩fn
and using Lemma (5.2.7), we see that if k > j, then
∥sj −sk∥2 =
444444
k

n=j+1
⟨x, fn⟩fn
444444
2
=
k

n=j+1
|⟨x, fn⟩|2 .
Since ∞
n=1 |⟨x, fn⟩|2 converges, (sn) is a Cauchy sequence in X; so, as X is
complete, ∞
n=1 ⟨x, fn⟩fn converges to a sum s ∈X. Likewise, if f ′
1, f ′
2, . . .
is another one–one enumeration of Ix, then ∞
n=1 ⟨x, f ′
n⟩f ′
n converges to a
sum s′ ∈X. We show that s = s′. Given ε > 0, we choose N such that if
k ≥N, then
∥s −sk∥< ε, ∥s′ −s′
k∥< ε, and
∞

n=k+1
|⟨x, fn⟩|2 < ε2,
where
s′
k =
k

n=1
⟨x, f ′
n⟩f ′
n.
Taking
m = max {k : f ′
k = fn for some n ≤N} ,
we see that m ≥N and
∥s′
m −sN∥2 ≤
∞

n=N+1
|⟨x, fn⟩|2 < ε2.
Hence
∥s −s′∥≤∥s −sN∥+ ∥sN −s′
m∥+ ∥s′
m −s′∥< 3ε.
Since ε is arbitrary, it follows that s = s′. Hence the value of

i∈I
⟨x, ei⟩ei =
∞

n=1
⟨x, fn⟩fn
is independent of the choice of the one–one enumeration f1, f2, . . . of Ix.

246
5. Hilbert Spaces
(5.2.9) Exercise
Let (ei)i∈I be an orthonormal family in a Hilbert space H, and x, y
elements of H such that Ix is countably inﬁnite. Show that the value
of the expression

i∈I
⟨x, ei⟩⟨ei, y⟩=
∞

n=1
⟨x, fn⟩⟨fn, y⟩
is independent of the one–one enumeration f1, f2, . . . of Ix. Show also
that if f ′
1, f ′
2, . . . is a (possibly ﬁnite) one–one enumeration of Iy, then

i∈I
⟨x, ei⟩⟨ei, y⟩=
∞

n=1
⟨x, f ′
n⟩⟨f ′
n, y⟩.
(5.2.10) Proposition.
Let (ei)i∈I be an orthonormal family in a Hilbert
space H, let S be the closure in H of the subspace of H generated by (ei),
and let P be the projection of H on S. Then for all x, y in H,
Px =

i∈I
⟨x, ei⟩ei,
∥Px∥2 =

i∈I
|⟨x, ei⟩|2 ,
∥x −Px∥2 = ∥x∥2 −

i∈I
|⟨x, ei⟩|2 ,
⟨Px, Py⟩=

i∈I
⟨x, ei⟩⟨ei, y⟩.
Proof.
Consider, for example, the case where Ix is countably inﬁnite. Let
f1, f2, . . . be a one–one enumeration of Ix. Lemma (5.2.7) shows that
44444x −
N

n=1
⟨x, fn⟩fn
44444
2
= ∥x∥2 −
N

n=1
|⟨x, fn⟩|2 ,
44444
N

n=1
⟨x, fn⟩fn
44444
2
=
N

n=1
|⟨x, fn⟩|2 ,
and x −N
n=1 ⟨x, fn⟩fn is orthogonal to f1, . . . , fN. Letting N →∞, we
see that
44444x −

i∈I
⟨x, ei⟩ei
44444
2
= ∥x∥2 −

i∈I
|⟨x, ei⟩|2 ,
44444

i∈I
⟨x, ei⟩ei
44444
2
=

i∈I
|⟨x, ei⟩|2 ,

5.2 Orthogonality and Projections
247
and z = x −
i∈I ⟨x, ei⟩ei is orthogonal to each fn. For each i ∈I either
ei = fn for some n, and therefore z ⊥ei, or else i /∈Ix; in the latter case,
using the continuity of the inner product, we have
⟨z, ei⟩= ⟨x, ei⟩−
7 ∞

n=1
⟨x, fn⟩fn, ei
8
= 0 −
∞

n=1
⟨⟨x, fn⟩fn, ei⟩
= −
∞

n=1
⟨x, fn⟩⟨fn, ei⟩
= 0,
as ei is orthogonal to each fn. It now follows that z is orthogonal to each
vector in S, and hence, by Proposition (5.2.4), that Px = 
i∈I ⟨x, ei⟩ei.
Using Exercise (5.2.5: 2), the continuity of the inner product, and
Exercise (5.2.9), we now obtain
⟨Px, Py⟩= ⟨Px, y⟩
=
7 ∞

n=1
⟨x, fn⟩fn, y
8
=
∞

n=1
⟨x, fn⟩⟨fn, y⟩
=

i∈I
⟨x, ei⟩⟨ei, y⟩.
2
By an orthonormal basis of a Hilbert space H we mean an orthonormal
family that generates a dense linear subspace of H. The following is a more
or less immediate consequence of Proposition (5.2.10).
(5.2.11) Proposition.
The following are equivalent conditions on an
orthonormal family (ei)i∈I in a Hilbert space H.
(i) (ei) is an orthonormal basis of H.
(ii) x = 
i∈I ⟨x, ei⟩ei for each x ∈H.
(iii) 
i∈I |⟨x, ei⟩|2 = ∥x∥2 for each x ∈H.
(iv) ⟨x, y⟩= 
i∈I ⟨x, ei⟩⟨ei, y⟩for all x, y ∈H.

248
5. Hilbert Spaces
The identity in condition (iv) of this proposition is known as Parseval’s
identity.
(5.2.12) Exercises
.1
Prove Proposition (5.2.11).
.2
Use Zorn’s Lemma (Appendix B) to prove that every nonzero Hilbert
space has an orthonormal basis.
.3
Let (ei)i∈I be an orthonormal basis in a separable Hilbert space H.
By considering the balls B(ei, 1/
√
2), or otherwise, show that I is a
countable set.
.4
Let H be an inﬁnite–dimensional inner product space, and (en)∞
n=1 an
inﬁnite orthonormal sequence of vectors in H. By considering (en),
and without invoking either Theorem (4.3.6) or Exercise (4.3.7: 4),
prove that the unit ball of H is not sequentially compact.
.5
Let (en)∞
n=1 be an orthonormal basis of a separable Hilbert space H,
and (an)∞
n=1 an element of l2(C). Show that there exists a unique
element a of H such that ⟨a, en⟩= an for each n. (Show that the
partial sums of the series ∞
n=1 anen form a Cauchy sequence.)
.6
Prove that the functions
t →en(t) =
1
√
2π eint
(n ∈Z)
form an orthonormal basis of L2 ([−π, π], C) . (Noting Exercise
(5.2.6), show that the linear space S generated by {en : n ∈Z} is
dense in L2 ([−π, π], C) . To do this, ﬁrst consider f ∈C([−π, π], C).
Construct a continuous function g on R, with period 2π, such
that ∥f −g∥2 is arbitrarily small. Then use Exercise (4.6.8: 6) to
approximate g, and therefore f, by an element of S.)
It follows from this exercise and Proposition (5.2.11) that for each
f ∈L2 ([−π, π], C) the corresponding Fourier expansion
x →
∞

n=−∞
-f(n)einx
converges to f in the L2 norm, where
-f(n) = 1
2π
$ π
−π
f(t)e−int dt.
In this case Parseval’s identity takes the form
$ π
−π
|f(x)|2 dx = 1
2π
∞

n=−∞
   -f(n)
   
2
.

5.2 Orthogonality and Projections
249
.7
Take f(x) = x in the preceding exercise and apply Parseval’s identity,
to show that ∞
n=1 n−2 = π2/6.
.8
Show that ∞
n=1 n−4 = π4/90. (Consider f(x) = 1
2

x2 −π2	
.)
Although Zorn’s Lemma guarantees the existence of an orthonormal ba-
sis in any Hilbert space (Exercise (5.2.12: 2)), it does not enable us to
construct orthonormal bases. The following Gram–Schmidt orthonormali-
sation process enables us to construct orthonormal bases when the Hilbert
space H is separable.
Using Proposition (4.3.8), ﬁrst construct a (possibly ﬁnite) total sequence
(a1, a2, . . .) of linearly independent vectors in H. For each n let Hn be the
n–dimensional subspace of H spanned by {a1, . . . , an}; since this subspace
is complete (by Proposition (4.3.3)), the projection Pn of H onto it is
deﬁned. Suppose we have found orthogonal vectors b1, . . . , bn generating
Hn. If H = Hn, stop the construction. Otherwise, an+1 /∈Hn ; so by
Proposition (5.2.4),
bn+1 = an+1 −Pnan+1
is orthogonal to Hn, and therefore
⟨bn+1, bk⟩= 0
(1 ≤k ≤n).
Elementary linear algebra shows that {b1, . . . , bn+1} is a basis of Hn+1.
This completes the inductive construction of a (possibly ﬁnite) orthogonal
sequence (b1, b2, . . .) in H such that for each n, {b1, . . . ,bn} is a basis of
Hn. Setting en = ∥bn∥−1 bn and noting that 
n Hn is dense in H, we see
that (en) is an orthonormal basis of H.
The Gram–Schmidt orthonormalisation process has a very important
application in approximation theory, which we now describe.
Let w be a nonnegative continuous weight function on a compact interval
I = [a, b]. Deﬁne the inner product
⟨f, g⟩w =
$ b
a
w(t)f(t)g(t) dt
on L2(I), and the corresponding weighted least squares norm by
∥f∥2,w =
$ b
a
w(t)f(t)2 dt
1/2
.
Given an element f of L2(I) and a natural number N, we have the
approximation problem:

250
5. Hilbert Spaces
Find the polynomial function p of degree at most N that
minimises the value of
∥f −p∥2
2,w =
$ b
a
w(t) (f(t) −p(t))2 dt.
This polynomial is called the least squares approximation to f of degree at
most N.
Now, the set PN of polynomials of degree ≤N is a ﬁnite–dimensional
subspace of C(I); so the projection PN of C(I) on PN exists, and the unique
least squares approximation to f of degree at most N is given by pN = PNf.
To compute the coeﬃcients of pN, we can use elementary multivariate
calculus to calculate the values of λ0, . . . , λN that minimise
$ b
a
w(t)

f(t) −
N

n=0
λntn
2
dt;
see [29]. However, this procedure is computationally ineﬃcient if we are
looking for least squares approximations to several functions in C(I). In that
case a better procedure is to apply the Gram–Schmidt process to the total
sequence consisting of the monomials 1, t, t2, . . ., to compute orthonormal
polynomials q0, q1, . . . , where qn(t) has degree n and {q0, . . . , qn} is a basis
for Pn; then
PNf =
N

n=0
⟨f, qn⟩w qn,
by Proposition (5.2.10). One advantage of this method is that, having found
the least squares approximation pn to f of degree at most n, in order to
ﬁnd the least squares approximation of degree at most n+1 we simply add
to pn the single term ⟨f, qn+1⟩w qn+1.
(5.2.13) Exercises
.1
In the notation of the preceding paragraphs, take I = [−1, 1] and
w(t) = 1, and compute q0, q1, and q2. Hence ﬁnd the quadratic least
squares approximation to ex in C[−1, 1].
.2
Let w be a nonnegative continuous weight function on I = [a, b], let
f ∈C(I), and for each n let pn denote the least squares approximation
to f of degree at most n. Prove that
lim
n→∞∥f −pn∥2,w = 0.
.3
In the notation of the last exercise, let (qn) be a sequence of polyno-
mial functions that is orthogonal relative to ⟨·, ·⟩w , such that qn has

5.2 Orthogonality and Projections
251
degree n. Prove that each polynomial p of degree n can be written
uniquely as a linear combination of q0, . . . , qn, and ﬁnd the coeﬃcient
of qk in this linear combination.
.4
Continuing Exercise (5.2.13: 3), prove that qn(t) has n distinct real
zeroes, and that those zeroes lie in the open interval (a, b). (Let
p(t) = (t −t1) · · · (t −tm),
where t1, . . . , tm are the zeroes of qn(t) in (a, b) at which qn(t) changes
sign. Assume that m < n, show that
% b
a w(t)p(t)qn(t) dt ̸= 0, and
deduce a contradiction.)
.5
Continuing Exercise (5.2.13: 4), write
qn(t) = Antn + Bntn−1 + . . . ,
cn = ⟨qn, qn⟩w ,
αn = An+1
An
,
βn = αn
Bn+1
An+1
−Bn
An

,
and, for n ≥1,
γn = An+1An−1
A2n
·
⟨qn, qn⟩w
⟨qn−1, qn−1⟩w
.
Prove the triple recursion formula:
qn+1(t) = (αnt + βn)qn(t) −γnqn−1(t).
(Consider p(t) = qn+1(t) −αntqn(t).)
.6
Let I = [a, b], let w ∈C(I), and let p be a polynomial function. Prove
the equivalence of the following conditions.
(i)
% b
a w(t)p(t)q(t) dt = 0 for all polynomial functions q of degree at
most n.
(ii) There exists an (n + 1)-times diﬀerentiable function u on I such
that
w(x)p(x) = u(n+1)(x)
(x ∈I)
and
u(k)(a+) = u(k)(b−) = 0
(k = 0, 1, . . . , n).

252
5. Hilbert Spaces
.7
Let I = [−1, 1], let α, β ∈(−1, ∞) , and let
w(x) = (1 −x)α (1 + x)β
(x ∈I).
For each n ∈N deﬁne the Jacobi polynomial of degree n by
Rodrigues’s formula:
φn(x) = (1 −x)−α (1 + x)−β dn
dxn

(1 −x)α+n (1 + x)β+n
(where, of course, dn/dxn denotes the nth derivative). Use the pre-
ceding exercise to prove that (φn)∞
n=0 is an orthogonal sequence in
L2,w(I, C).
.8
In the special case α = β = 0 of the last exercise, the Jacobi poly-
nomial φn is known as a Legendre polynomial and is usually denoted
by Pn. Prove that the Legendre polynomials satisfy the recurrence
relation
Pn+1(x) = (4n + 2)xPn(x) −4n2Pn−1(x)
on [−1, 1]. Use this and Exercise (5.2.13: 1) to ﬁnd P3(x) and P4(x).
(To establish the recurrence relation, write each term in the form
dn−1
dxn−1

x2 −1
	n−1 q(x)

,
where q(x) is a quadratic polynomial.)
5.3
The Dual of a Hilbert Space
We saw in Exercise (5.2.5: 4) that for each vector a in an inner product
space X the mapping x →⟨x, a⟩is a bounded linear functional on X. We
now show that the dual of a Hilbert space consists precisely of bounded
linear functionals of this form (cf. Exercise (5.2.5: 5)).
(5.3.1) The Riesz Representation Theorem.
If u is a bounded linear
functional on a Hilbert space H, then there exists a unique vector a ∈H
such that u(x) = ⟨x, a⟩for each x ∈H. In that case ∥u∥= ∥a∥.
Proof.
We ﬁrst dispose of the uniqueness1 of a: indeed, if
⟨x, a⟩= u(x) = ⟨x, a′⟩
(x ∈H) ,
1This uniqueness argument applies to a linear functional of the form x →⟨x, a⟩
on an inner product space.

5.3 The Dual of a Hilbert Space
253
then, taking x = a −a′, we obtain
∥a −a′∥2 = ⟨a −a′, a −a′⟩= 0,
so a = a′.
To establish the existence of a, we may assume that u ̸= 0. As u is linear
and continuous, ker (u) is a closed subspace of H (Proposition (4.2.3)). Let
P be the projection of H on ker (u), and choose y ∈H such that u(y) ̸= 0.
Setting
z = u(y)−1 (y −Py) ,
we see that z ∈ker (u)⊥, by Proposition (5.2.4), and that
u(z) = u(y)−1 (u(y) −u(Py)) = 1.
So for each x in H we have
x −u(x)z ∈ker(u)
and therefore
0 = ⟨x −u(x)z, z⟩= ⟨x, z⟩−u(x) ⟨z, z⟩= ⟨x, z⟩−u(x) ∥z∥2 .
Thus u(x) = ⟨x, a⟩, where a = ∥z∥−2 z. The Cauchy–Schwarz inequality
shows that |u(x)| ≤∥a∥∥x∥. Since also
   u

∥a∥−1 a
   = ∥a∥, we see that
∥u∥= ∥a∥.
2
(5.3.2) Exercises
.1
Find an alternative proof of the existence part of the Riesz Represen-
tation Theorem (5.3.1) for a separable Hilbert space H. (Let (en)∞
n=1
be an orthonormal basis of H, and u a bounded linear functional
on H. Show that ∞
n=1 u(en)∗en converges to the desired element
a ∈H.)
.2
Use the Riesz Representation Theorem to give another solution to
Exercise (5.2.12: 5). (In the notation of that exercise, show that
u(x) = ∞
n=1 a∗
n ⟨x, en⟩deﬁnes a bounded linear functional on H.)
.3
By the second dual of a normed space X we mean the dual space
X∗∗= (X∗)∗of X∗. We say that X is reﬂexive if for each u ∈X∗∗
there exists xu ∈X such that u(f) = f(xu) for each f ∈X∗. Prove
that any Hilbert space is reﬂexive.
By an operator on a normed space X we mean a bounded linear mapping
from X into itself; the set of operators on X is written L(X). (Strictly
speaking, we have here deﬁned a bounded operator; since we do not consider

254
5. Hilbert Spaces
unbounded operators in this book, it is convenient for us to use the term
“operator” to mean “bounded operator”.)
It is common practice to denote the composition of operators by juxta-
position; thus if S, T are operators on X, then T ◦S is usually written TS;
moreover, we write T 2 for TT, T 3 for T(TT), and so on.
For a ﬁrst application of the Riesz Representation Theorem, let T be
an operator on a Hilbert space H, and for each a ∈X consider the linear
functional x →⟨Tx, a⟩on H. The inequality
|⟨Tx, a⟩| ≤∥Tx∥∥a∥≤∥T∥∥a∥∥x∥
shows that this functional is bounded and has norm at most ∥T∥∥a∥. By
the Riesz Representation Theorem, there exists a unique vector T ∗a such
that
⟨Tx, a⟩= ⟨x, T ∗a⟩
(x ∈H) ;
moreover,
∥T ∗a∥≤∥T∥∥a∥.
(1)
The mapping T ∗: H →H so deﬁned is called the adjoint of T, and is an
operator on H. To justify this last claim, consider a, b in H and λ, µ in F.
Since
⟨Tx, λa + µb⟩= λ∗⟨Tx, a⟩+ µ∗⟨Tx, b⟩
= λ∗⟨x, T ∗a⟩+ µ∗⟨x, T ∗b⟩
= ⟨x, λT ∗a + µT ∗b⟩
for all x ∈H, we see that
T ∗(λa + µb) = λT ∗a + µT ∗b.
So T ∗is linear. Inequality (1) shows that T ∗is bounded and has norm at
most ∥T∥. Since
⟨T ∗x, y⟩= ⟨y, T ∗x⟩∗= ⟨Ty, x⟩∗= ⟨x, Ty⟩,
the uniqueness of the adjoint of T ∗shows that (T ∗)∗= T. So ∥T∥=
∥(T ∗)∗∥≤∥T ∗∥and therefore ∥T ∗∥= ∥T∥.
An operator T on H is said to be
• selfadjoint, or Hermitian, if T ∗= T;
• normal if T ∗T = TT ∗.
Selfadjoint and normal operators have particularly amenable properties and
are among the most important objects in Hilbert space theory. (See [24],
[44], and other books that deal with such topics as spectral theory.)
(5.3.3) Exercises
In all the exercises of this set except the ﬁrst, H is a complex Hilbert space,
S and T are operators on H, and ran(T) denotes the range of T.

5.3 The Dual of a Hilbert Space
255
.1
Let (e1, e2, . . . , en) be an orthonormal basis of the Euclidean Hilbert
space Fn, and T an operator on Fn. Show that
Tx =
n

j,k=1
⟨x, ej⟩⟨Tej, ek⟩ek,
and hence that T can be associated with the n–by–n matrix whose
(j, k)th entry is ⟨Tej, ek⟩. With what matrix is T ∗associated in this
way?
.2
By a bounded conjugate–bilinear functional on H we mean a mapping
u : H × H →C that is linear in the ﬁrst variable, conjugate linear
in the second, and bounded, in the sense that there exists c > 0 such
that |u(x, y)| ≤c ∥x∥∥y∥for all x, y ∈H. The least such c is the
number written
∥u∥= sup {|u(x, y)| : x, y ∈H, ∥x∥≤1, ∥y∥≤1} .
Show that the mapping u : H × H →C deﬁned by
u(x, y) = ⟨Tx, y⟩
(2)
is a bounded conjugate–linear functional on H such that ∥u∥= ∥T∥.
Show also that each bounded conjugate–linear functional u on H is
related to a unique corresponding operator T as in equation (2). (For
the second part, show that for each x ∈H the mapping y →u(x, y)∗
is a bounded linear functional on H.)
.3
Verify the polarisation identity:
4 ⟨Tx, y⟩
=
⟨T(x + y), x + y⟩−⟨T(x −y), x −y⟩
+i ⟨T(x + iy), x + iy⟩−i ⟨T(x −iy), x −iy⟩.
Show that if ⟨Sx, x⟩= ⟨Tx, x⟩for all x ∈H, then S = T.
Give an example of a nonzero operator T on the real Hilbert space
R2 such that ⟨Tx, x⟩= 0 for all x ∈R2.
.4
Let λ, µ be complex numbers. Show that (λS + µT)∗= λ∗S∗+ µ∗T ∗
and (ST)∗= T ∗S∗.
.5
Prove that T ∗T and TT ∗are selfadjoint.
.6
Prove each of the following statements.
(i) ker(T ∗) = ran(T)⊥
(ii) ran(T ∗) = ker(T)⊥.
(iii) ker(T) = ker(T ∗T).

256
5. Hilbert Spaces
(iv) ran(TT ∗) is dense in ran(T).
.7
Show that
(i) T is selfadjoint if and only if ⟨Tx, x⟩∈R for all x ∈H.
(ii) T is normal if and only if ∥Tx∥= ∥T ∗x∥for each x ∈H.
(For part (i), consider ⟨Tx, x⟩−⟨T ∗x, x⟩, and note Exercise (5.3.3: 3).)
.8
Prove that T is a projection if and only if T ∗T = T, in which case
T is idempotent—that is, T 2 = T. (For “if”, show ﬁrst that T is
selfadjoint, and then that (x −Tx) ⊥Ty for all x, y ∈H.)
We close this chapter by sketching how the techniques of Hilbert space
theory can be applied to prove the existence of a type of solution for one
of the fundamental problems of potential theory. (For more information on
this topic, see, for example, pages 117–122 of [23].)
For the rest of this chapter only, we follow the usual notational conven-
tions of applied mathematicians. Thus we denote three–dimensional vectors
by boldface letters, the element of volume in R3 by dV, the element of sur-
face area by dS, the unit outward normal to a surface by n, and the inner
product of two vectors u, v in R3 by u · v. We assume familiarity with
calculus in R3, including the elementary vector analysis of the gradient
operator ∇and the divergence operator div, deﬁned, respectively, by
∇f =
∂f
∂x, ∂f
∂y , ∂f
∂z

for a real–valued function f, and
div u =
∂ux
∂x , ∂uy
∂y , ∂uz
∂z

for a vector u = (ux, uy, uz). We also assume the fundamentals of the
theory of L2(Ω) when Ωis a Lebesgue measurable subset of R3.
Let Ωbe a bounded open set in R3 for which Gauss’s Divergence
Theorem holds:
$
Ω
div u dV =
$
∂Ω
u · n dS,
where ∂Ωis the boundary surface of Ωand u : Ω→R3 is continuously
diﬀerentiable on Ω. It follows that Green’s Theorem holds in the form
$
Ω

u ∇2v −v ∇2u
	
dV =
$
∂Ω

u ∂v
∂n −v ∂u
∂n

dS,

5.3 The Dual of a Hilbert Space
257
where u, v are twice continuously diﬀerentiable mappings of Ωinto R, ∂/∂n
denotes diﬀerentiation along the outward normal to ∂Ω, and ∇2 is the
Laplacian operator,
∇2 = ∂2
∂x2 + ∂2
∂y2 + ∂2
∂z2 .
We assume the following result, embodying Poincar´e’s inequality.
There exists a constant c > 0 such that if v : Ω→R is
diﬀerentiable on Ωand vanishes on the boundary of Ω, then
$
Ω
v2 dV
1/2
≤c
$
Ω
∥∇v∥2 dV
1/2
.
For a proof of this inequality under reasonable conditions on Ωwe refer to
[37], Chapter 5, Theorem 1.
Given a bounded continuous function f : Ω→R, we consider the
corresponding Dirichlet Problem:
Find a function u : Ω→R that is twice diﬀerentiable on Ω,
satisﬁes ∇2u = f on Ω, and vanishes on the boundary of Ω.
Suppose we have found a solution u of this Dirichlet Problem. Let v : Ω→
R be twice diﬀerentiable and have compact support in Ω—that is, v = 0
outside some compact subset of Ω. Then it follows from Green’s Theorem
that
$
Ω
u ∇2v dV =
$
Ω
vf dV,
(3)
since both u and v vanish on ∂Ω.
Now, it may not be possible to solve the Dirichlet Problem on Ω; but, as
we now show, we can ﬁnd a function u on Ωthat behaves appropriately on
∂Ωand that satisﬁes (3) for all v : Ω→R that are twice diﬀerentiable and
have compact support in Ω. More advanced theory of partial diﬀerential
equations then provides conditions on Ωunder which this so–called weak
solution u of the Dirichlet Problem can be identiﬁed with a solution of the
standard type.
Let C1
0(Ω) be the space of functions u : Ω→R that have compact
support in Ωand are diﬀerentiable on Ω; and let C1(Ω) be the space of
functions u : Ω→R such that u is diﬀerentiable on Ωand ∇u extends to a
continuous function on Ω. Let 9C1(Ω) be the space consisting of all elements
of C1(Ω) that vanish on ∂Ω, H1
0(Ω) the completion of 9C1(Ω) with respect
to the inner product deﬁned by
⟨u, v⟩=
$
Ω
∇u · ∇v dV,

258
5. Hilbert Spaces
and ∥·∥H the corresponding norm on H1
0(Ω). It is not hard to show that
C1
0(Ω) is dense in H1
0(Ω) with respect to this norm, and that H1
0(Ω) can be
identiﬁed with a certain set of Lebesgue integrable real–valued functions u
on Ω.
Now deﬁne a linear functional ϕf on 9C1(Ω) by
ϕf(v) =
$
Ω
vf dV.
Applying the Cauchy–Schwarz inequality in the Hilbert space L2(Ω), we
obtain
|ϕf(v)| ≤
$
Ω
v2 dV
1/2 $
Ω
f 2 dV
1/2
.
Hence, by Poincar´e’s inequality,
|ϕf(v)| ≤c
$
Ω
f 2 dV
1/2 $
Ω
∥∇v∥2 dV
1/2
= c
$
Ω
f 2 dV
1/2
∥v∥H ,
where the constant c is independent of v. Thus the linear functional ϕf is
bounded. It therefore extends by continuity to a bounded linear functional
ϕf on H1
0(Ω); see Exercise (4.2.2: 10). Thus, by the Riesz Representation
Theorem (5.3.1), there exists a unique element u of H1
0(Ω) such that
ϕf(v) = −⟨v, u⟩

v ∈H1
0(Ω)
	
.
For each v that has compact support in Ωand is twice diﬀerentiable on Ω,
we now use the elementary vector identity
div (u∇v) = ∇u · ∇v + u ∇2v
and Gauss’s Divergence Theorem to show that
$
Ω
u ∇2v dV = −⟨v, u⟩+
$
Ω
div (u∇v) dV
= ϕf(v) +
$
∂Ω
u∇v · n dS
=
$
Ω
vf dV.
(Recall that v = 0 on the boundary of Ω). This completes the proof that u
is the weak solution that we wanted.

6
An Introduction to Functional
Analysis
...a wonderful piece of work; which not to have been
blessed withal would have discredited your travel.
Antony and Cleopatra, Act 1, Scene 2
In this chapter we ﬁrst discuss the Hahn–Banach Theorem, the most famous case
of which provides conditions under which a bounded linear functional on a sub-
space of a normed space X can be extended, with preservation of its norm, to a
bounded linear functional on the whole of X. We then present several applica-
tions of this theorem, some of which illustrate the interplay between a normed
space and its dual. In Section 2 we use the Hahn–Banach Theorem to obtain re-
sults about the separation of convex sets by hyperplanes. The last section of the
chapter introduces the Baire Category Theorem, and includes some of its many
applications in classical and functional analysis.
6.1
The Hahn–Banach Theorem
Let X be a linear space over F. If F = C, then by a complex–linear
functional on X we mean a mapping f : X →C such that
f(x + y) = f(x) + f(y)
and
f(λx) = λf(x)

260
6. An Introduction to Functional Analysis
for all x, y ∈X and all λ ∈C. If f maps X into R and satisﬁes these
equations for all real numbers λ, then f is called a real–linear functional
on X.
According to our ﬁrst lemma, real–linear functionals can be characterised
as the real parts of associated complex–linear functionals.
(6.1.1) Lemma.
Let X be a complex normed linear space. If f is a
complex–linear functional on X and u is the real part of f, then u is a
real–linear functional on X and
f(x) = u(x) −iu(ix)
(x ∈X).
(1)
If u is a real–linear functional on X and f is deﬁned by equation (1), then
f is a complex–linear functional on X. Moreover, if f and u are related
as in equation (1) and either f or u is bounded, then both functionals are
bounded and ∥f∥= ∥u∥.
Proof.
If f is a complex–linear functional on X and u = Re (f), then it
is easy to show that u is real–linear; moreover, equation (1) follows from
the fact that z = Re (z) −i Re(iz) for any complex number z. On the other
hand, if u is a real–linear functional on X, and f is deﬁned as in (1), then
it is clear that f(x + y) = f(x) + f(y), and that f(λx) = λf(x) for all real
λ. Also,
f(ix) = u(ix) −iu(i2x)
= u(ix) −iu(−x)
= u(ix) + iu(x)
= if(x),
from which it follows that f is complex–linear.
If f is bounded, then as |u(x)| ≤|f(x)| for all x ∈X, u is bounded
and ∥u∥≤∥f∥. For each x ∈X there exists λ ∈C such that |λ| = 1 and
f(λx) = λf(x) = |f(x)|; then f(λx) ∈R, so
|f(x)| = f(λx)
= Re (f(λx))
= u(λx)
≤∥u∥∥λx∥= ∥u∥∥x∥.
Hence ∥f∥≤∥u∥, and therefore ∥f∥= ∥u∥. Finally, if u is bounded, then
for all x ∈X with ∥x∥≤1 we have
|f(x)| ≤|u(x)| + |u(ix)|
≤∥u∥(∥x∥+ ∥ix∥)
≤2 ∥u∥,
so f is bounded. By the foregoing, ∥f∥= ∥u∥.
2

6.1 The Hahn–Banach Theorem
261
Let X be a vector space over F, and p a mapping of X into R. We say
that p is
• subadditive if p(x + y) ≤p(x) + p(y) for all x, y ∈X;
• positively homogeneous if p(λx) = λp(x) for all x ∈X and λ ≥0;
• a sublinear functional if it is subadditive and positively homogeneous;
• a seminorm if it is nonnegative and subadditive, and if p(λx) =
|λ| p(x) for all x ∈X and λ ∈F.
For example, if c ≥0, then p(x) = c ∥x∥deﬁnes a sublinear functional on
X.
Now let X0 be a subspace of X, f0 a linear functional on X0, and f a
linear functional on X. We say that f extends f0 to X, or that f is an
extension of f0 to X, if f(x) = f0(x) for all x ∈X0. If also f is bounded
and ∥f∥= ∥f0∥, we say that f is a norm–preserving extension of f0 to X.
We now prove a preliminary version of the extension theorem for linear
functionals.
(6.1.2) Proposition.
Let X be a real normed space, X0 a subspace of
X, x1 a point of X\X0, and X1 the subspace of X spanned by X0 ∪{x1}.
Let p be a sublinear functional on X, and f0 a linear functional on X0 such
that f0(x) ≤p(x) for all x ∈X0. Then there exists a linear functional f
that extends f0 to X1 and satisﬁes f(x) ≤p(x) for all x ∈X1.
Proof.
Since x1 /∈X0, each element of X1 can be written uniquely in
the form x + λx1 with x ∈X0 and λ ∈R. Let τ be any real number, and
provisionally deﬁne
f(x + λx1) = f0(x) + λτ.
It is easily shown that f is a linear extension of f0 to X1; hence it remains
to choose τ so that
f0(x) + λτ ≤p(x + λx1)
(x ∈X0, λ ∈R\ {0}) .
(2)
To this end, replacing x by λx, using the positive homogeneity of p, and
then dividing both sides of (2) by |λ| , we observe that (2) is equivalent to
the two conditions
f0(x) + τ
≤
p(x + x1)
if x ∈X0 and λ > 0,
−f0(x) −τ
≤
p(−x −x1)
if x ∈X0 and λ < 0.
In turn, these two conditions can be gathered together in one:
−p(−x′ −x1) −f0(x′) ≤τ ≤p(x + x1) −f0(x)
(x, x′ ∈X0).

262
6. An Introduction to Functional Analysis
But for all x, x′ ∈X0 we have
f0(x) −f0(x′) = f0(x −x′)
≤p(x −x′)
= p(x + x1 −x′ −x1)
≤p(x + x1) + p(−x′ −x1)
and therefore
−p(−x′ −x1) −f0(x′) ≤p(x + x1) −f0(x).
Thus in order to satisfy (2), and thereby complete the proof, we need only
invoke Exercise (1.1.1: 21).
2
This brings us to the Hahn–Banach Theorem.
(6.1.3) Theorem.
Let X0 be a subspace of a real normed space X, p
a sublinear functional on X, and f0 a linear functional on X0 such that
f0(x) ≤p(x) for all x in X0. Then there exists a linear functional f that
extends f0 to X and satisﬁes f(x) ≤p(x) for all x ∈X.
Proof.
Let F denote the set of all linear functionals f that are deﬁned
on subspaces of X containing X0 and that have the following properties.
(i) f = f0 on X0 and
(ii) f(x) ≤p(x) for all x in the domain of f.
Deﬁne the binary relation ≼on F by inclusion:
f ≼g if and only if f ⊂g.
Then ≼is a partial order on F. Let C be a chain in F (that is, a nonempty
totally ordered subset of F), and deﬁne
G =

g∈C
g = {(x, y) : ∃g ∈C (y = g(x))} .
If (x, y1) ∈G and (x, y2) ∈G, then there exist g1, g2 ∈C such that (x, y1) ∈
g1 and (x, y2) ∈g2. Since C is a chain, either g1 ⊂g2 or else, as we may
assume, g2 ⊂g1; then (x, y2) ∈g1 and therefore, as g1 is a function,
y2 = y1. It follows that G is a function on X; and that if x is in the domain
of some g ∈C, then x is in the domain of G, G(x) = g(x), and therefore
G(x) ≤p(x). It is easy to show that the domain of G contains X0, and
that G = f0 on X0. To complete the proof that G ∈F, we must show
that G is linear on X. To this end, given x, x′ in the domain of G, choose
g, g′ ∈C such that (x, G(x)) ∈g and (x′, G(x′)) ∈g′. As C is a chain, we

6.1 The Hahn–Banach Theorem
263
may assume that g′ ⊂g, so that (x′, G(x′)) ∈g; as g is linear, it follows
that x + x′ is in the domain of g and therefore in the domain of G, and
that
G(x + x′) = g(x + x′)
= g(x) + g(x′)
= G(x) + G(x′).
Similarly, for each λ ∈R, G(λx) = λG(x). Hence G ∈F. It is trivial to
verify that G is an upper bound of C in F.
We can now apply Zorn’s Lemma (see Appendix B) to produce a maximal
element f of F. It only remains to show that f is deﬁned throughout X.
But if f is not deﬁned at some point x0 of X, then, using Proposition
(6.1.2), we can ﬁnd an element g of F such that f ≼g and g is deﬁned at
x0. Since f is maximal in F, it follows that f = g, a contradiction.
2
The name “Hahn–Banach Theorem” is often applied to the following
corollary.
(6.1.4) Corollary.
Let X0 be a subspace of a normed space X, and f0
a bounded linear functional on X0. Then there exists a norm–preserving
extension of f0 to X.
Proof.
First consider the case where f0 is a real–linear functional on X0.
Applying Theorem (6.1.3) with p(x) = ∥f0∥∥x∥, we obtain a real–linear
functional f that extends f0 to X and satisﬁes f(x) ≤∥f0∥∥x∥for all
x ∈X. Replacing x by −x in this last inequality, we see that
|f(x)| = max {f(x), −f(x)} ≤∥f0∥∥x∥
for all x ∈X; whence f is bounded, and ∥f∥≤∥f0∥. But f extends f0, so
∥f∥≥∥f0∥and therefore ∥f∥= ∥f0∥.
When f is a complex–linear functional, we apply the foregoing argument
to construct a norm–preserving extension u of the real–linear functional
Re(f0) to X. Lemma (6.1.1) then shows us that
f(x) = u(x) −iu(ix)
deﬁnes a norm–preserving extension of f0 to X.
2
(6.1.5) Exercises
.1
Prove the complex Hahn–Banach Theorem: let X0 be a subspace of
a complex normed space X, p a seminorm on X, and f0 a linear
functional on X0 such that |f0(x)| ≤p(x) for all x ∈X0; then there
exists a linear functional f that extends f0 to X and satisﬁes |f(x)| ≤
p(x) for all x ∈X. (First apply the Hahn–Banach Theorem to the
real–linear functional Re(f0).)

264
6. An Introduction to Functional Analysis
.2
Let X be a separable normed space. Prove Theorem (6.1.3) without
using Zorn’s Lemma. (Let (xn) be a dense sequence in X, and p a
sublinear functional on X. Starting with a given linear functional f0
on a subspace X0 of X, extend f0 inductively to the subspace Xn of
X spanned by Xn−1 ∪{xn} , such that the linear extension fn to Xn
satisﬁes fn(x) ≤p(x) for all x ∈Xn. Then consider f = ∞
n=0 fn.)
The Hahn–Banach Theorem—especially in the form of Corollary (6.1.4)—
has many interesting applications. We begin with some of the simpler
ones.
(6.1.6) Proposition.
Let S be a closed subspace of a normed space X,
and let x0 ∈X\S. Then there exists a bounded linear functional f on X
such that
(i) f(x0) = 1 and
(ii) f(x) = 0 for all x ∈S.
Proof.
Let X0 be the subspace of X spanned by S ∪{x0}, and deﬁne
f0(x + λx0) = λ
(x ∈S, λ ∈F).
(This is a good deﬁnition: for, as x0 /∈S, the representation of a given
element of X0 in the form x+λx0, with x ∈S and λ ∈F, is unique.) Then
f0 is a linear functional on X0, f0(x) = 0 if x ∈S, and f0(x0) = 1. Now,
as S is closed, we see from Exercise (3.1.10: 3) that ρ(x0, S) > 0. So for all
x in S and all nonzero λ ∈F,
∥x + λx0∥= |λ|
44λ−1x + x0
44 ≥|λ| ρ(x0, S).
Hence
|f(x + λx0)| = |λ| ≤ρ(x0, S)−1 ∥x + λx0∥,
and therefore f0 has the bound ρ(x0, S)−1. Applying Corollary (6.1.4) to
f0, we obtain the desired linear functional f on X.
2
(6.1.7) Proposition.
If x0 is a nonzero element of a normed space X,
then there exists a bounded linear functional f on X such that f(x0) = ∥x0∥
and ∥f∥= 1.
Proof.
Let X0 be the subspace of X generated by {x0}, deﬁne a linear
functional f0 on X0 by f0(λx0) = λ ∥x0∥, and apply Corollary (6.1.4) to
f0.
2
(6.1.8) Corollary.
For each x in a normed space X,
∥x∥= sup {|f(x)| : f ∈X∗, ∥f∥= 1} .

6.1 The Hahn–Banach Theorem
265
Proof.
If x = 0, the conclusion is trivial. If x ̸= 0, then for all f ∈X∗
with ∥f∥= 1 we have
|f(x)| ≤∥f∥∥x∥= ∥x∥.
Since, by Proposition (6.1.7), there exists f ∈X∗such that ∥f∥= 1 and
f(x) = ∥x∥, the result follows.
2
The remaining results and exercises in this section illustrate the interac-
tion between a normed space X and its dual X∗, one of the most fascinat-
ing and beautiful aspects of modern analysis, in which the Hahn–Banach
Theorem plays a fundamental part.
(6.1.9) Exercises
.1
Show that if X is a ﬁnite–dimensional Banach space, then X∗is
ﬁnite–dimensional and dim(X∗) = dim(X). (Reduce to the case
where X is n–dimensional Euclidean space.)
.2
Let S be a closed subspace of a Banach space X, and deﬁne
S⊥= {f ∈X∗: f(x) = 0 for all x ∈S} .
Prove that S⊥is a closed linear subspace of X∗. Show that the fol-
lowing procedure yields a well–deﬁned mapping T of S∗into X∗/S⊥:
given f in S∗, choose a norm–preserving extension F of f to X, and
set Tf equal to the element of X∗/S⊥that contains F. Prove that T
is a norm–preserving linear isomorphism of S∗onto X∗/S⊥. Hence
prove that for each F ∈X∗,
sup {|F(x)| : x ∈S, ∥x∥≤1} = inf

∥F −f∥: f ∈S⊥
.
.3
Let S be a closed linear subspace of a Banach space X, let ϕ be
the canonical map of X onto X/S, and for each f in (X/S)∗deﬁne
Tf = f◦ϕ. Prove that T is an isometric linear isomorphism of (X/S)∗
onto S⊥. Hence prove that for each x ∈X,
inf {∥x −s∥: s ∈S} = sup

|f(x)| : f ∈S⊥, ∥f∥≤1

.
.4
Let x1, . . . , xn be elements of a real normed space X, and c1, . . . , cn
real numbers. Prove the equivalence of the following conditions.
(i) There exists f ∈X∗with ∥f∥= 1 and f(xi) = ci for each i.
(ii) |λ1c1 + · · · + λncn| ≤∥λ1x1 + · · · + λnxn∥.

266
6. An Introduction to Functional Analysis
.5
Let X be a normed space, and deﬁne
-x(f) = f(x)
(x ∈X, f ∈X∗).
Prove that
(i) the mapping x →-x is a linear isometry of X into its second dual
X∗∗;
(ii) X is reﬂexive (see Exercise (5.3.2: 3)) if and only if this mapping
has range X∗∗;
(iii) if X is reﬂexive, then it is a Banach space.
.6
Prove that if X is an inﬁnite–dimensional normed space, then X∗
is inﬁnite–dimensional. (cf. Exercise (6.1.9: 1). Suppose that X∗is
ﬁnite–dimensional, and consider the mapping x →-x deﬁned in the
preceding exercise.)
.7
Let X be a Banach space. Prove that
(i) if X∗is separable, then so is X;
(ii) if X is separable and reﬂexive, then X∗is separable.
(For (i), let {f1, f2, . . .} be dense in X∗, and for each n choose a unit
vector xn such that |fn(xn)| ≥1
2 ∥xn∥. Let Y be the closure of the
subspace generated by {x1, x2, . . .} , suppose that Y ̸= X, and use
Proposition (6.1.6) to deduce a contradiction.)
.8
Prove that a closed subspace Y of a reﬂexive Banach space X is
reﬂexive. (For each f ∈X∗let fY denote the restriction of f to Y.
Given u ∈Y ∗∗, choose ξ ∈X such that u(fY ) = f(ξ) for all f ∈X∗.
Then use Propositions (6.1.6) and (6.1.4).)
.9
We saw in Exercise (4.4.11: 5) that the space L∞, introduced in
Exercise (4.4.11: 2), can be identiﬁed with the dual space of L1 =
L1(R). In this exercise we show that L1 can be identiﬁed with a
subset of the dual of L∞but is not the whole of that dual.
Prove that for each g ∈L1,
ug(f) =
$
fg
deﬁnes an element of the dual of L∞. Let X0 be the set of all con-
tinuous functions f : R →R that vanish outside some compact set,
and deﬁne a bounded linear functional u0 on X0 by u0(f) = f(0).

6.1 The Hahn–Banach Theorem
267
Using Corollary (6.1.4), construct a norm–preserving extension u of
u0 to L∞. By considering u(fn), where
fn(x) =



(1 −|x|)n
if |x| ≤1
0
if |x| > 1,
show that there is no element g of L1 such that u = ug.
It follows from this exercise that, in contrast to Lp for 1 < p < ∞
(see Theorem (4.4.10)), L1 is not reﬂexive.
The next three lemmas, together with our work on the Hahn–Banach
Theorem, enable us to produce a substantial strengthening of the following
consequence of Riesz’s Lemma (4.3.5): in an inﬁnite–dimensional normed
space, if 0 < θ < 1, then there exists a sequence (xn) of unit vectors such
that ∥xm −xn∥> θ whenever m ̸= n.
(6.1.10) Lemma.
If f, f1, . . . , fn are linear functionals on a linear space
X over F such that ker(f) ⊃n
i=1 ker(fi), then f, f1, . . . , fn are linearly
dependent.
Proof.
We may assume that none of the functions under consideration
is identically zero. We proceed by induction on n. In the case n = 1, choose
a ∈X such that f1(a) = 1. Then for each x ∈X,
(x −f1(x)a) ∈ker(f1),
so
0 = f(x −f1(x)a) = f(x) −f(a)f1(x).
Hence f = f(a)f1, and therefore f and f1 are linearly dependent.
Now suppose that the lemma holds for n = k, and consider the case
n = k + 1. Let g be the restriction of f to ker(fk+1), and for i = 1, . . . , k
let gi be the restriction of fi to ker(fk+1). Then ker(g) ⊃k
i=1 ker(gi), so
g = k
i=1 λigi for some elements λi of F, by our induction hypothesis.
Thus f −k
i=1 λifi vanishes on ker(fk+1). By the case n = 1 that we
have already proved, f −k
i=1 λifi and fk+1 are linearly dependent; so
f, f1, . . . , fk+1 are linearly dependent and the induction is complete.
2
(6.1.11) Lemma.
Let X be an inﬁnite–dimensional normed space, and
f1, . . . , fn elements of X∗. Then n
i=1 ker(fi) ̸= {0} .
Proof.
First assume that the fi are linearly independent. By Exercise
(6.1.9: 6), there exists an element f of X∗such that f, f1, . . . , fn are linearly
independent. Lemma (6.1.10) now shows that n
i=1 ker(fi) is not contained
in ker(f), from which the desired conclusion follows immediately.

268
6. An Introduction to Functional Analysis
Now consider the case where the fi are linearly dependent. Without
loss of generality, we may assume that for some m ≤n, {f1, . . . , fm} is
a basis for the linear space generated by all the fi. By the ﬁrst part of
the proof, there exists a nonzero element ξ in m
i=1 ker(fi); clearly, ξ ∈
n
i=1 ker(fi).
2
(6.1.12) Lemma.
Let X be an inﬁnite–dimensional normed space, and
f1, . . . , fn linearly independent elements of X∗. Then there exist nonzero
elements ξ, η of X such that fi(η) < 0 = fi(ξ) for each i.
Proof.
The existence of ξ follows from Lemma (6.1.11). On the other
hand, Lemma (6.1.10) shows that for each i there exists xi ∈X such that
fi(xi) = 1 and fj(xi) = 0 when j ̸= i. Setting η = −n
i=1 xi, we see that
fi(η) = −1 for each i.
2
(6.1.13) Proposition.
If X is an inﬁnite-dimensional normed space,
then there exists a sequence (xn) of unit vectors in X such that ∥xm −xn∥
> 1 whenever m ̸= n.
Proof.
We construct the required vectors inductively as follows. Choos-
ing a unit vector x1 ∈X, apply Proposition (6.1.7) to obtain f1 ∈X∗
such that ∥f1∥= 1 = f1(x1). Now suppose that we have constructed unit
vectors x1, . . . , xn in X, and linearly independent unit vectors f1, . . . , fn in
X∗, such that fi(xi) = 1 = ∥fi∥for each i. By Lemma (6.1.12), there exist
nonzero elements ξ, η of X such that fi(η) < 0 = fi(ξ) for each i. Choose
c > 0 such that ∥η∥< ∥η + cξ∥. Setting
xn+1 = ∥η + cξ∥−1 (η + cξ) ,
note that fi(xn+1) < 0 for 1 ≤i ≤n. Now use Proposition (6.1.7) to obtain
an element fn+1 of X∗such that ∥fn+1∥= 1 = fn+1(xn+1). Suppose that
fn+1 = n
i=1 λifi for some elements λi of F. Then
∥η + cξ∥= fn+1(η + cξ)
=
     
n

i=1
λifi(η + cξ)
     
=
     
n

i=1
λifi(η)
     
= |fn+1(η)|
≤∥η∥
< ∥η + cξ∥,
a contradiction. Hence the linear functionals f1, . . . , fn, fn+1 are linearly
independent. Moreover, if 1 ≤i ≤n, then
∥xn+1 −xi∥≥|fi(xn+1 −xi)| = |fi(xn+1) −fi(xi)| > 1,

6.1 The Hahn–Banach Theorem
269
since fi(xi)
=
1 and fi(xn+1)
<
0. This completes our inductive
construction.
2
A sequence (xn) in a Banach space X is called a Schauder basis if for each
x ∈X there exists a unique sequence (λn) in F such that x = ∞
n=1 λnxn.
In that case, X is separable, and the mapping x →(λn)∞
n=1 can be used to
identify X with a sequence space.
The notion of a Schauder basis generalises that of a basis in a ﬁnite–
dimensional space. In the spaces c0 and lp (1 ≤p < ∞) let en be the
vector with nth term equal to 1 and all other terms 0; then {e1, e2, . . .} is
a Schauder basis. Schauder bases for other separable Banach spaces, such
as C[0, 1], are not so easy to construct, and Enﬂo [15] has shown that there
exist separable Banach subspaces of c0 that do not have a Schauder basis.
We can, however, prove the following theorem.
(6.1.14) Theorem.
Every inﬁnite–dimensional Banach space contains
an inﬁnite–dimensional closed subspace with a Schauder basis.
The next two lemmas make this possible.
(6.1.15) Lemma.
Let (xn) be a total sequence of nonzero elements of a
Banach space X, and c a positive number such that if λ1, . . . , λn belong to
F, and m < n, then
44444
m

i=1
λixi
44444 ≤c
44444
n

i=1
λixi
44444 .
(3)
Then (xi) is a Schauder basis for X.
Proof.
Consider any sequence (λn) in F such that ∞
i=1 λixi converges
in X. If n > k, then
|λk| = ∥xk∥−1 ∥λkxk∥
≤c ∥xk∥−1
44444
n

i=k
λixi
44444 .
Letting n →∞, we see that
|λk| ≤c ∥xk∥−1
44444
∞

i=k
λixi
44444 .
A simple induction argument now enables us to prove that if ∞
i=1 λixi =
0, then λi = 0 for each i. Thus a given element of X has at most one
representation in the form ∞
i=1 λixi with each λi in F. It remains to show
that such a representation exists.

270
6. An Introduction to Functional Analysis
Let X∞be the subspace of X generated by {x1, x2, . . .} , and for each n
let Xn be the subspace generated by {x1, . . . , xn}. Deﬁne a (clearly linear)
mapping Pn of X∞onto Xn by
Pn
 ∞

i=1
λixi

=
n

i=1
λixi.
It follows from (3) that c is a bound for Pn on X∞. But X∞is dense in
X, so, by Exercise (4.2.2: 10), Pn extends to a bounded linear mapping Pn
on X with bound c. By Corollary (6.1.4), the mapping ∞
i=1 λixi →λn
extends to a bounded linear functional fn on X such that
fn(x)xn = Pn(x) −Pn−1(x),
where, for convenience, we set P0(x) = 0.
We prove that x = ∞
n=1 fn(x)xn for each x ∈X. To this end, let ε > 0
and, using the fact that the sequence (xn) is total, choose λ1, . . . , λN in F
such that
44444x −
N

n=1
λnxn
44444 < ε.
For each k ≥N we have
∥x −Pk(x)∥≤
44444x −
N

n=1
λnxn
44444 +
44444
N

n=1
λnxn −Pk(x)
44444
< ε +
44444Pk
 N

n=1
λnxn −x
44444
≤ε + ∥Pk∥
44444
N

n=1
λnxn −x
44444
≤ε + ∥Pk∥ε
≤(1 + c)ε.
Hence
x = lim
k→∞Pkx = lim
k→∞
k

n=1
fn(x)xn =
∞

n=1
fn(x)xn.
2
(6.1.16) S. Mazur’s Lemma.
Let Y be a ﬁnite–dimensional subspace
of an inﬁnite–dimensional Banach space X. Then for each ε > 0 there
exists a unit vector ξ ∈X such that
∥y∥≤(1 + ε) ∥y + λξ∥
(4)
for all y ∈Y and λ ∈F.

6.1 The Hahn–Banach Theorem
271
Proof.
Without loss of generality we may take ε < 1. Let {y1, . . . , yn}
be an ε/2–approximation to the set
S = {y ∈Y : ∥y∥= 1}
(which is compact, by Exercise (4.3.7: 2)). Using Proposition (6.1.7), for
i = 1, . . . , n construct fi ∈X∗with norm 1 such that fi(yi) = 1. By
Lemma (6.1.11), there exists a unit vector ξ ∈n
i=1 ker(fi). Consider any
vector y ∈Y and any λ ∈F. If y = 0, then (4) is trivial. If y ̸= 0, then we
may assume that ∥y∥= 1: otherwise, we just consider ∥y∥−1 y. Choosing i
such that ∥y −yi∥< ε/2, we have
∥y + λξ∥≥∥yi + λξ∥−∥y −yi∥
≥fi(yi + λξ) −ε
2
= 1 −ε
2
>
1
1 + ε,
since ε < 1. Hence (4) obtains.
2
Proof of Theorem (6.1.14).
Let X be an inﬁnite–dimensional Banach
space, and ε > 0. Choose positive numbers εn such that
ln (1 + εn) < 2−n−2 ln (1 + ε)
for each n. Then
∞
:
n=1
(1 + εn) = lim
N→∞
N
:
n=1
(1 + εn) ≤
√
1 + ε < 1 + ε.
Let x1 be a unit vector in X. By Mazur’s Lemma, there exists a unit vector
x2 ∈X such that
∥y∥≤(1 + ε1) ∥y + λx2∥
for all y in the subspace generated by x1 and for all λ ∈F. By the same
lemma, there exists a unit vector x3 ∈X such that
∥y∥≤(1 + ε2) ∥y + λx3∥
for all y in the subspace generated by {x1, x2} and for all λ ∈F. Carrying
on in this way, we construct an inﬁnite sequence (xn) of unit vectors in X
such that
∥y∥≤(1 + εn) ∥y + λxn+1∥
for all y in the subspace generated by {x1, . . . , xn} and for all λ ∈F. It
follows that if λ1, . . . , λn ∈F and m < n, then
44444
m

i=1
λixi
44444 ≤(1 + εm)
44444
m

i=1
λixi + λm+1xm+1
44444

272
6. An Introduction to Functional Analysis
≤(1 + εm)(1 + εm+1)
44444
m+1

i=1
λixi + λm+2xm+2
44444
≤· · ·
≤(1 + εm)(1 + εm+1) · · · (1 + εn−1)
44444
n

i=1
λixi
44444
≤(1 + ε)
44444
n

i=1
λixi
44444 .
Hence, by Lemma (6.1.15), (xn)∞
n=1 is a Schauder basis of the closure of
the subspace of X that it generates. 2
For our last application of the Hahn–Banach Theorem in this section,
we show that if I is a compact interval, then the dual space C(I)∗can be
isometrically embedded in the Banach space

BV(I), ∥·∥bv
	
of functions of
bounded variation on I (introduced in Exercise (4.5.2: 4)). To this end, for
convenience we say that a bounded function f : I →R is representable if
there exists an increasing sequence (fn) of elements of C(I) that converges
simply to f. We denote by R(I) the subspace of B(I) consisting of all
bounded real–valued functions on I that can be written as the diﬀerence
of two representable functions. Note that C(I) ⊂R(I).
(6.1.17) Exercises
1.
Prove that if J
is a compact subinterval of I, then −χJ
is
representable.
.2
Let f ∈C(I), where I = [a, b], let P = (x0, . . . , xn) be a partition of
I, and for each k (0 ≤k ≤n −1) let ξk be any point of [xk, xk+1].
Deﬁne ψ ∈B(I) by
ψ =
n−1

k=0
f(ξk)

χ[a,xk+1] −χ[a,xk]

.
Show that ∥f −ψ∥→0 as the mesh of P tends to 0.
(6.1.18) Theorem.
Let I = [a, b] be a compact interval. Then for each
real–valued function α of bounded variation on I,
uα =
$ b
a
f(x) dα(x)
deﬁnes a bounded linear functional, with norm Tα(a, b), on the Banach
space C(I). Moreover, each bounded linear functional on C(I) is of the form

6.1 The Hahn–Banach Theorem
273
uα, where α is a function of bounded variation on I that is unique up to
an additive constant.
Proof.
Throughout this proof, P = (x0, x1, . . . , xn) is a partition of I,
and for each i, ξi is any point of the interval [xi, xi+1]. Consider ﬁrst a real–
valued function α of bounded variation on I. The linearity of uα follows
from Exercise (1.5.16: 4). For each f ∈C(I) we have the following inequality
for Riemann–Stieltjes sums:
     
n−1

i=0
f(ξi)(α(xi+1) −α(xi))
     ≤∥f∥
n−1

i=0
|α(xi+1) −α(xi)|
≤∥f∥Tα(a, b).
In the limit as the mesh of the partition tends to 0 we obtain the inequality
|uα(f)| ≤∥f∥Tα(a, b),
which shows that the linear functional uα has bound Tα(a, b).
Now consider any bounded linear functional u on C(I). By Corollary
(6.1.4), there exists a norm–preserving extension u♯of u to R(I). Referring
to Exercise (6.1.17: 1), deﬁne a function α : I →R by
α(x) = u♯(χ[a,x])
(x ∈I) .
To show that α is of bounded variation on I, let P be as in the foregoing,
and for each k (0 ≤k ≤n −1) let
σk = sgn (α(xk+1) −α(xk)) .
Then
φ =
n−1

k=0
σk

χ[a,xk+1] −χ[a,xk]

∈R(I),
∥φ∥≤1, and
n−1

k=0
|α(xk+1) −α(xk)| = u♯(φ) ≤
44u♯44 = ∥u∥.
Hence α is of bounded variation on I, and
Tα(a, b) ≤∥u∥.
(5)
If, now, f is any element of C(I), consider the function
ψ =
n−1

k=0
f(ξk)

χ[a,xk+1] −χ[a,xk]

,

274
6. An Introduction to Functional Analysis
which, again by Exercise (6.1.17: 1), belongs to R(I). We have
     u(f) −
n−1

k=0
f(ξk) (α(xk+1) −α(xk))
     =
  u♯(f) −u♯(ψ)
  
≤∥u∥∥f −ψ∥.
Letting the mesh of the partition P tend to 0, we see from Exercise
(6.1.17: 2) that ∥f −ψ∥→0; also,
n−1

k=0
f(ξk) (α(xk+1) −α(xk)) →
$ b
a
f(x) dα(x).
Hence u(f) = uα(f). Moreover, from (5) and the ﬁrst part of the proof,
∥u∥= Tα(a, b).
Finally, the uniqueness, up to an additive constant, of the function α
corresponding to the given bounded linear functional u on C(I) follows
from Proposition (1.5.19).
2
The full power of the Hahn–Banach Theorem is not needed to prove
Theorem (6.1.18): for, as is shown on pages 106–110 of [40], it is possible
to construct an extension of u to R(I) by elementary means.
We say that a function f : I →R of bounded variation on I = [a, b]
is normalised if f(a) = 0. It is easy to show that the normalised elements
form a closed, and therefore complete, linear subspace of the Banach space

BV(I), ∥·∥bv
	
.
(6.1.19) Corollary.
Under the hypotheses of Theorem (6.1.18), C(I)∗is
isometrically isomorphic to the Banach space of normalised functions of
bounded variation on I.
(6.1.20) Exercises
.1
Let I = [a, b] be a compact interval. Prove that the normalised el-
ements of BV(I) form a Banach space relative to the norm ∥·∥bv .
Then prove Corollary (6.1.19).
.2
Compute the norm of the bounded linear functional u deﬁned on
C[−1, 1] by
u(f) =
∞

n=1
(−1)n
n2
f(1/n).
.3
Let X be a compact metric space, and u a linear functional on C(X)
that is positive, in the sense that u(f) ≥0 for all nonnegative f ∈
C(X). Prove that u is bounded and has norm equal to u(1), where 1
is the constant function x →1 on X.

6.2 Separation Theorems
275
.4
Let u be a bounded linear functional on C(X), where X is a com-
pact metric space. Prove that there exist positive linear function-
als v, w on C(X) such that u = v −w. (For f ≥0 in C(X) let
v(f) = sup {u(g) : g ∈C(X), 0 ≤g ≤f} .)
6.2
Separation Theorems
In this section we use the Hahn–Banach Theorem to establish a number
of geometric results about the separation of convex sets by a hyperplane.
These results have many applications, including some signiﬁcant ones in
mathematical economics (see Appendix C).
If A is a subset of a vector space, and t ∈F, we deﬁne
tA = {tx : x ∈A} .
(6.2.1) Lemma.
Let X be a normed space, and A a convex subset of X
containing 0 in its interior. Then the Minkowski functional p : X →R,
deﬁned by
p(x) = inf {t > 0 : x ∈tA} ,
is a sublinear functional on X. If p(x) < 1, then x ∈A; and if A is open,
then
A = {x ∈X : p(x) < 1} .
Proof.
Choose r > 0 such that B(0, r) ⊂A. If x ̸= 0, then
x ∈2 ∥x∥
r
B(0, r) ⊂2 ∥x∥
r
A.
It follows that p is deﬁned throughout X. Let α, β be positive numbers
such that x ∈αA and y ∈βA; then
x + y = (α + β)

α
α + β α−1x +
β
α + β β−1y

,
where, by convexity,
α
α + β α−1x +
β
α + β β−1y ∈A.
So x + y ∈(α + β)A. It now follows that p(x + y) ≤p(x) + p(y). On the
other hand, if λ > 0, then for all positive t we have
λx ∈tA ⇔x ∈

λ−1t
	
A
and therefore
t ≥p(λx) ⇔λ−1t ≥p(x),

276
6. An Introduction to Functional Analysis
so p(λx) = λp(x). This last equation also holds when λ = 0, since p(0) = 0.
Thus p is a sublinear functional on X.
If p(x) < 1, then there exists t ∈(0, 1) such that t−1x ∈A; by the
convexity of A, x = (1 −t)0 + t(t−1x) belongs to A.
Finally, suppose that A is open, and consider any x ∈A. Since p(0) = 0,
to prove that p(x) < 1 we may assume that x ̸= 0. Choose s > 0 such that
B (x, s ∥x∥) ⊂A; then (1 + s)x ∈A, so p(x) ≤(1 + s)−1 < 1.
2
(6.2.2) Lemma.
Let A be a nonempty open convex subset of a normed
space X, and x0 a point of X\A. Then there exists a bounded real–linear
functional f on X such that f(x) < f(x0) for all x in A.
Proof.
By translation, we may assume that 0 ∈A; so, by Lemma (6.2.1),
p(x) = inf

t > 0 : t−1x ∈A

deﬁnes a sublinear functional on X, and p(x) < 1 if and only if x ∈A.
Hence p(x0) ≥1. Let X0 be the real linear subspace of X generated by
{x0}, and deﬁne a bounded real–linear functional f0 on X0 by
f0(λx0) = λ
(λ ∈R).
If λ ≥0, then
f0(λx0) = λ ≤λp(x0) = p(λx0);
if λ < 0, then
f0(λx0) = λ < 0 ≤p(λx0).
Thus f0(x) ≤p(x) for all x ∈X0. By the Hahn–Banach Theorem (6.1.3),
there exists a real–linear functional f on X such that
• f(x) = f0(x) for all x ∈X0, and
• f(x) ≤p(x) for all x ∈X.
For all x ∈A,
f(x) ≤p(x) < 1 = f(x0).
It follows that the nonempty open set A is contained in the complement
of the translated hyperplane x0 + ker(f); whence, by Exercise (4.2.5: 3)
and Lemma (4.1.4), the hyperplane ker(f) is closed in X. It follows from
Proposition (4.2.3) that f is bounded.
2
(6.2.3) Proposition.
Let C be a nonempty closed convex subset of a
normed space X, and x0 a point of X\C. Then there exist a bounded real–
linear functional f on X, and a real number α, such that f(x) < α < f(x0)
for all x ∈C.

6.2 Separation Theorems
277
Proof.
Choose r > 0 such that B(x0, r) ∩C = ∅. By Exercise (4.1.5: 6),
A = {x + y : x ∈C, y ∈B(0, r)}
is open and convex; also, x0 /∈A. By Lemma (6.2.2), there exists a bounded
real–linear functional f on X such that f(x) < f(x0) for all x in A. Since f
is not identically 0, f(b) > 0 for some b ∈B(0, r). Taking α = f(x0)−f(b),
we see that for all x ∈C,
f(x) = f(x + b) −f(b) < α < f(x0).
2
(6.2.4) Exercises
.1
Let A be a compact convex subset of a real normed space X, and
B a closed convex subset of X. Prove that there exist f ∈X∗and
α, β ∈R such that f(x) ≤α < β ≤f(y) for all x ∈A and y ∈B.
.2
Prove Helly’s Theorem: let F be a ﬁnite family of convex subsets of
Rn with the property that the intersection of any n + 1 sets in F is
nonempty; then  F is nonempty. (First use induction on the number
of sets in F; then use induction on the dimension n.)
.3
Let K be a convex subset of a normed space X, and S ⊂K. We say
that S is an extreme subset of K if, for any distinct points x, y of K
such that 1
2(x + y) ∈S, we have x ∈S and y ∈S. If also S contains
only one element, then that element is called an extreme point of K.
Prove that the intersection of any family of extreme subsets of K is
either empty or an extreme subset.
Now suppose that K is also compact, and let E be the family of all
extreme subsets of K, partially ordered by inclusion. Prove that E has
a minimal element S0. (Use the ﬁnite intersection property and Zorn’s
Lemma.) Then prove that S0 consists of a single point. (Suppose that
S0 contains two distinct points ξ, η. Choose f ∈X∗such that f(ξ) <
f(η), and let α = supx∈K f(x). Show that S1 = {x ∈S0 : f(x) = α}
is an extreme subset of K such that S0\S1 ̸= ∅.)
Finally, prove that K has at least one extreme point.
.4
By the convex hull of a subset K of a normed space we mean the set
of all elements of the form N
n=1 λixi, where the xi are elements of K
and the λi are nonnegative real numbers such that N
i=1 λi = 1. Prove
the Krein–Milman Theorem: a compact convex subset of a normed
space X is the closure of the convex hull of the set of its extreme
points. (Let C be the convex hull of the set of extreme points of the
compact convex set, let x0 ∈X\C, and apply Proposition (6.2.3).)

278
6. An Introduction to Functional Analysis
When X = Rn, there is a weak extension of Proposition (6.2.3) to the
case where C need not be closed.
(6.2.5) Proposition.
Let C be a nonempty convex subset of the Eu-
clidean space Rn, and x0 a point of Rn\C. Then there exists a bounded
real–linear functional f on Rn such that f(x) ≤f(x0) for all x ∈C.
Proof.
Since C is nonempty, closed, and convex, Proposition (6.2.3) al-
lows us to assume that x0 ∈C\C. Then, by Exercise (4.1.5: 7), each open
ball with centre x0 contains some point of the complement of C. Choose a
sequence (xk) in Rn that converges to x0, such that xk /∈C for each k. By
Proposition (6.2.3) and Theorem (5.3.1), for each k there exist pk ∈Rn
and αk ∈R such that
• ⟨x, pk⟩< αk for all x ∈C, and
• ⟨xk, pk⟩= αk.
Replacing pk by ∥pk∥−1 pk, we may assume that ∥pk∥= 1 for each k.
Since the unit ball of Rn is compact (Theorem (4.3.6)), we may pass to
a subsequence and assume that (pk) converges to a limit p in Rn; then
∥p∥= 1. Also, as
|αk| ≤∥pk∥∥xk∥= ∥xk∥
and the sequence (∥xk∥) , being convergent, is bounded, (αk) is a bounded
sequence in R. Passing to another subsequence, we may further assume
that (αk) converges to a limit α in R. By continuity, for all x ∈C we have
⟨x, p⟩≤α = ⟨x0, p⟩.
It remains to take f(x) = ⟨x, p⟩.
2
Let H be a hyperplane in the normed space X, and a an element of X\H.
By Propositions (4.2.4) and (6.1.1), for each α ∈R there exists a unique
real–linear functional f on X such that
a + H = {x ∈X : f(x) = α} .
We say that the translated hyperplane a + H separates the nonempty sub-
sets A and B of X if f(x) ≤α for all x ∈A, and f(x) ≥α for all
x ∈B.
(6.2.6) Minkowski’s Separation Theorem.
Let A and B be dis-
joint nonempty convex subsets of Rn. Then there exists a closed translated
hyperplane that separates A and B.
Proof.
The nonempty set
C = B −A = {x −y : x ∈B, y ∈A}

6.3 Baire’s Theorem and Beyond
279
is convex, and 0 /∈C. By Proposition (6.2.5), there exists a bounded real–
linear functional f on Rn such that f(z) ≥f(0) = 0 for all z ∈C. Hence
f(x) ≥f(y) for all x ∈A and y ∈B, and we need only apply Exer-
cise (1.1.1: 21) to obtain the required real number α. The corresponding
hyperplane f −1 ({α}) then separates A and B.
2
(6.2.7) Exercise
Let A, B be disjoint nonempty convex subsets of a normed space
X such that A is compact and B is closed. Prove that there exist a
bounded real–linear functional f on X, and a real number α, such that
f(x) > α for all x ∈A, and f(x) < α for all x ∈B. (Reduce to the
case where A = {0}, note Exercise (4.1.5: 6), and apply Proposition
(6.2.3).)
6.3
Baire’s Theorem and Beyond
In this section we prove one of the most useful theorems about complete
metric spaces, Baire’s Theorem, and then study several of its many interest-
ing consequences. Among these are the existence of uncountably many con-
tinuous, nowhere diﬀerentiable functions on [0, 1], and the Open Mapping
Theorem for bounded linear mappings between Banach spaces.
(6.3.1) Baire’s Theorem.
The intersection of a sequence of dense open
sets in a complete metric space is dense.
Proof.
Let X be a complete metric space, (Un) a sequence of dense open
subsets of X, and
U =
∞

n=1
Un.
We need only prove that for x0 ∈X and r0 > 0, the set U ∩B(x0, r0)
is nonempty. To this end, since U1 is dense in X, we can ﬁnd x1 in
U1 ∩B(x0, r0). Moreover, since both U1 and B(x0, r0) are open, so is their
intersection; whence there exists r1 such that 0 < r1 < 1 and
B(x1, r1) ⊂U1 ∩B(x0, r0).
Since U2 is dense in X, we can now ﬁnd x2 in U2 ∩B(x1, r1); but U2 ∩
B(x1, r1) is open, so there exists r2 such that 0 < r2 < 1/2 and
B(x2, r2) ⊂U2 ∩B(x1, r1).
Carrying on in this way, we construct a sequence (xn) of points of X, and a
sequence (rn) of positive numbers, such that for each n ≥1, 0 < rn < 1/n
and
B(xn, rn) ⊂Un ∩B(xn−1, rn−1).

280
6. An Introduction to Functional Analysis
By induction, if m ≥n, then xm ∈B(xn, rn); whence
ρ(xm, xn) < rn < 1
n
(m ≥n).
(1)
Thus (xn) is a Cauchy sequence in X. Since X is complete, (xn) con-
verges to a limit x∞in X. Letting m tend to ∞in inequality (1), we have
ρ(x∞, xn) ≤rn, and therefore x∞∈B(xn, rn), for each n. Taking n = 0,
we see that x∞∈B(x0, r0); taking n ≥1, we see that x∞∈Un. 2
The alternative name Baire Category Theorem for Theorem (6.3.1)
originates from the following deﬁnitions (due to Baire).
A subset S of a metric space X is said to be
• nowhere dense in X if the interior of S is empty;
• of the ﬁrst category if it is a countable union of nowhere dense subsets;
• of the second category if it is not of the ﬁrst category.
Baire’s Theorem is equivalent to the statement a nonempty complete metric
space is of the second category.
(6.3.2) Exercises
.1
Prove the last statement; more precisely, prove that if a nonempty
complete metric space is the union of a sequence of closed sets, then
at least one of those closed sets has a nonempty interior.
.2
Prove the extended version of Cantor’s theorem on the uncountability
of R (Exercise (1.2.11: 4)): if (xn) is a sequence of real numbers, then
{x ∈R : ∀n (x ̸= xn)} is dense in R.
.3
Prove that a nonempty complete metric space without isolated points
is uncountable.
We now show how Baire’s Theorem can be used to prove the existence
of continuous functions on I = [0, 1] that are nowhere diﬀerentiable on I.
For each positive integer n let En be the set of all f ∈C(I) with the
property:
there exists t ∈
;
0, 1 −n−1<
such that |f(t + h) −f(t)| ≤nh
whenever 0 < h < 1 −t.
Note that ∞
n=1 En contains any f ∈C(I) such that for some t ∈[0, 1) the
right–hand derivative of f at t,
f ′(t+) =
lim
h→0,h>0
f(t + h) −f(t)
h
,

6.3 Baire’s Theorem and Beyond
281
exists. To see this, consider such f and t. Choose a positive integer n1 such
that t ∈
;
0, 1 −n−1
1
<
and |f ′(t+)| < n1. Next choose h0 > 0 such that if
0 < h < h0, then |f(t + h) −f(t)| ≤n1h. If h0 = 1 −t, set n = n1. If
h0 < 1 −t, then for h0 ≤h < 1 −t we have
|f(t + h) −f(t)| ≤2 ∥f∥
h0
h,
where ∥·∥denotes the sup norm on C(I); so, taking n = max {n1, n2} ,
where the positive integer n2 > 2 ∥f∥/h0, we have f ∈En.
We prove that C(I)\En is dense and open in I. To this end, ﬁrst let
(fk)∞
k=1 be a sequence in En that converges to a limit f in C(I). Then there
exists a sequence (tk) in
;
0, 1 −n−1<
such that
|fk(tk + h) −fk(tk)| ≤nh
whenever k ≥1 and 0 < h < 1 −tk. Since
;
0, 1 −n−1<
is sequentially
compact, we may assume without loss of generality that (tk) converges to
a limit t ∈
;
0, 1 −n−1<
. If 0 < h < 1 −t, then for all suﬃciently large k we
have 0 < h < 1 −tk and therefore
|f(t + h) −f(t)| ≤|f(t + h) −f(tk + h)| + |f(tk + h) −fk(tk + h)|
+ |fk(tk + h) −fk(tk)| + |fk(tk) −f(tk)|
+ |f(tk) −f(t)|
≤|f(t + h) −f(tk + h)| + ∥f −fk∥+ nh
+ ∥f −fk∥+ |f(tk) −f(t)| .
Letting k →∞and using the continuity of f, we obtain
|f(t + h) −f(t)| ≤nh.
Hence f ∈En, and therefore En is closed in C(I). Thus C(I)\En is open
in C(I).
Given f ∈C(I) and ε > 0, we now use the Weierstrass Approximation
Theorem (4.6.1) to construct a polynomial function p such that ∥f −p∥<
ε/2. Choosing a positive integer
N > ε−1 (n + ∥p′∥) ,
deﬁne a continuous function q : [0, 1] →R such that for 0 ≤k ≤N −1,
q
 k
N

= 0,
q
k + 1
2
N

= ε/2,

282
6. An Introduction to Functional Analysis
and q is linear on each of the intervals
= k
N , k + 1
2
N
>
,
=k + 1
2
N
, k + 1
N
>
.
Let g = p + q ∈C(I). For each t ∈[0, 1) we have
  g′(t+)
  ≥
  q′(t+)
  −|p′(t)| ≥Nε −∥p′∥> n,
so g /∈En. Since
∥f −g∥≤∥f −p∥+ ∥q∥< ε,
we conclude that C(I)\En is dense in C(I).
Now let Fn be the set of all f ∈C(I) with the property:
there exists t ∈
;
n−1, 1
<
such that |f(t + h) −f(t)| ≤nh
whenever 0 < h < t.
Arguments similar to those just used show that C(I)\Fn is dense and open
in C(I), and that it contains any f ∈C(I) such that for some t ∈(0, 1] the
left–hand derivative of f at t,
f ′(t−) =
lim
h→0,h<0
f(t + h) −f(t)
h
,
exists. Let
S =
∞

n=1
En ∪
∞

n=1
Fn.
Since C(I) is complete (Proposition (4.5.4)), we see from Baire’s Theorem
that
C(I)\S =
∞

n=1
(C(I)\En) ∩
∞

n=1
(C(I)\Fn)
is dense in C(I). Clearly, C(I)\S consists of continuous, nowhere diﬀeren-
tiable functions on I.
(6.3.3) Exercises
.1
Prove that [0, 1] cannot be written as the union of a sequence of
pairwise–disjoint closed sets. (Suppose that there exists a sequence
(Fn) of pairwise–disjoint closed sets whose union is [0, 1] . Show that
the union of the boundaries of the sets Fn is closed and has an empty
interior.)
.2
Let X be a Banach space, and C a closed convex subset of X that is
absorbing—that is, for each x ∈X there exists t > 0 such that tx ∈C.
Prove that 0 does not belong to the closure of X\C. (Suppose the
contrary, and show that for each positive integer n the complement
of nC is dense and open in X.)

6.3 Baire’s Theorem and Beyond
283
.3
Prove that if a Banach space is generated by a compact set, then it
is ﬁnite–dimensional.
.4
Let X be a complete metric space, and (fi)i∈I a family of continuous
mappings of X into R. Suppose that for each x ∈X there exists
Mx > 0 such that |fi(x)| ≤Mx for all i ∈I. Prove that there exist
a nonempty open set E ⊂X and a positive integer N such that
|fi(x)| ≤N for all i ∈I and all x ∈E. (Let
Cn,i
=
{x ∈X : |fi(x)| ≤n} ,
Cn
=

i∈I Cn,i,
and use Baire’s Theorem.)
A mapping f between metric spaces X and Y is called an open mapping
if f(S) is an open subset of Y whenever S is an open subset of X.
(6.3.4) Exercise
Prove that a linear mapping T between normed spaces X, Y is open
if and only if there exists r > 0 such that B(0, r) ⊂T(B(0, 1)).
We now aim to apply Baire’s Theorem to prove the following fundamental
result on linear mappings between Banach spaces.
(6.3.5) The Open Mapping Theorem.
A bounded linear mapping of
a Banach space onto a Banach space is open.
The next lemma prepares us for the proof of this theorem.
(6.3.6) Lemma.
Let T be a linear mapping of a Banach space X into a
normed space Y . Then T is open if and only if there exists r > 0 such that
B (0, r) ⊂T

B (0, 1)
	
.
Proof.
Suppose that such a real number r exists. In view of the pre-
ceding exercise, it suﬃces to prove that B(0, r/2) ⊂T(B(0, 1)). Given
y ∈B(0, r/2), since 2y ∈B(0, r), we can ﬁnd an element x1 of the unit
ball of X such that
∥2y −Tx1∥< r
2.
So 22y −2Tx1 ∈B(0, r), and therefore there exists x2 in the unit ball of
X such that
4422y −2Tx1 −Tx2
44 < r
2.
Carrying on in this way, we construct a sequence (xn) of elements of the
unit ball of X such that
442Ny −2N−1Tx1 −2N−2Tx2 −· · · −TxN
44 < r
2

284
6. An Introduction to Functional Analysis
for each N. Thus
44444y −
N

n=1
2−nTxn
44444 < 2−N−1r,
and therefore the series ∞
n=1 2−nTxn converges to y. Since
k

n=j
2−n ∥xn∥≤
k

n=j
2−n
whenever k > j, we see from Exercise (4.1.8: 2) that ∞
n=1 2−nxn converges
to an element x in the unit ball of X. The boundedness of T now ensures
that
Tx =
∞

n=1
2−nTxn = y.
Hence B(0, r/2) ⊂T(B(0, 1)), and therefore T is open.
The converse is trivial.
2
Proof of the Open Mapping Theorem.
Let T be a bounded linear
mapping of a Banach space X onto a Banach space Y. Then
Y = T(X) =
∞

n=1
T(B (0, n)),
where each of the sets T

B (0, n)
	
is closed in Y . By Exercise (6.3.2: 1),
there exists a positive integer N such that T(B (0, N)) has a nonempty
interior; so there exist y1 ∈Y and R > 0 such that
B(y1, R) ⊂T(B (0, N)).
Setting z = N −1y1 and r = N −1R, we easily see that
B(z, r) ⊂T(B (0, 1)).
So if y ∈Y and ∥y∥< r, then
z ± y ∈T(B (0, 1))
and therefore
y = 1
2 ((z + y) −(z −y)) ∈T(B (0, 1)).
Hence
B(0, r) ⊂T(B (0, 1)),
and therefore, by Lemma (6.3.6), T is open.
2

6.3 Baire’s Theorem and Beyond
285
The Open Mapping Theorem is one of a number of closely interrelated
results.
(6.3.7) Banach’s Inverse Mapping Theorem.
A one–one bounded
linear mapping of a Banach space onto a Banach space has a bounded
linear inverse.
Proof.
Let T be a one–one bounded linear mapping of a Banach space X
onto a Banach space Y . It is routine to prove that T −1 is a linear mapping
from Y onto X. By the Open Mapping Theorem (6.3.5), if U is an open
subset of X, then
(T −1)−1(U) = T(U)
is open in Y ; so T −1 is continuous, by Proposition (3.2.2), and is therefore
a bounded linear mapping, by Proposition (4.2.1).
2
By the graph of a mapping f : X →Y we mean the subset
G(f) = {(x, f(x)) : x ∈X}
of X × Y . (The graph of f is really the same as the function f itself,
regarded as a set of ordered pairs.)
(6.3.8) The Closed Graph Theorem.
A linear mapping of a Banach
space X into a Banach space Y is bounded if and only if its graph is a
closed subset of X × Y.
Proof.
Let T be a linear mapping of X into Y . It is a simple exercise to
show that if T is bounded, then its graph is a closed subset of X × Y .
Suppose, conversely, that G(T) is closed in X ×Y. Since X ×Y , a product
of complete metric spaces, is complete (by Proposition (3.5.10)), we see
from Proposition (3.2.9) that G (T), which is clearly a subspace of X × Y,
is a Banach space. Deﬁne a mapping H of G(T) onto X by
H(x, Tx) = x
(x ∈X).
It is straightforward to show that H is one–one and linear. Also,
∥H(x, Tx)∥≤∥x∥+ ∥Tx∥
≤2 max {∥x∥, ∥Tx∥}
= 2 ∥(x, Tx)∥,
so H is bounded. It follows from Banach’s Inverse Mapping Theorem (6.3.7)
that H−1 is a bounded linear mapping of X onto G(T); but
∥Tx∥≤∥(x, Tx)∥=
44H−1x
44 ≤
44H−144 ∥x∥

286
6. An Introduction to Functional Analysis
for all x ∈X, and so T is bounded.
2
We met the following result—the Uniform Boundedness Theorem—in
Exercise (4.2.2: 14), where you were asked to ﬁll in the details of a relatively
little known elementary proof. We now place the Uniform Boundedness
Theorem in its normal context, with its standard proof.
(6.3.9) Theorem.
Let (Ti)i∈I be a family of bounded linear mappings
from a Banach space X into a Banach space Y , such that {∥Tix∥: i ∈I}
is bounded for each x ∈X. Then {∥Ti∥: i ∈I} is bounded.
Proof.
Our hypotheses ensure that for each x ∈X,
ux(i) = Tix
(i ∈I)
deﬁnes an element ux of B(I, Y ). Clearly, the mapping x →ux of X into
B(I, Y ) is linear. We prove that its graph is closed in X × B(I, Y ). Indeed,
if (xn) is a sequence converging to a limit x∞in X, such that the sequence
(uxn) converges to a limit f in B(I, Y ), then for each i ∈I we have
∥f(i) −ux∞(i)∥≤∥f(i) −uxn(i)∥+ ∥uxn(i) −ux∞(i)∥
≤∥f −uxn∥+ ∥Ti(xn −x∞)∥
≤∥f −uxn∥+ ∥Ti∥∥xn −x∞∥
→0 as n →∞.
Hence f = ux∞, and so the linear mapping x →ux has a closed graph. By
Proposition (4.5.1) and the Closed Graph Theorem (6.3.8), this mapping
is bounded. Let
c = sup {∥ux∥: x ∈X, ∥x∥≤1} .
Then for all i ∈I and all x in the unit ball of X,
∥Tix∥= ∥ux(i)∥≤∥ux∥≤c.
2
(6.3.10) Exercises
.1
Prove that if T is an open bounded linear mapping of a Banach space
X into a normed space Y , then the range of T is complete.
.2
Let X be a separable real Banach space with a Schauder basis (xn),
and let S be the linear space consisting of all sequences (λn)∞
n=1 of
real numbers such that the series ∞
n=1 λnxn converges in X. Show
that
∥(λn)∞
n=1∥= sup
N≥1
44444
N

n=1
λnxn
44444

6.3 Baire’s Theorem and Beyond
287
deﬁnes a norm on S. Prove that S is a Banach space with respect to
this norm. Then show that the mapping
(λn)∞
n=1 →
∞

n=1
λnxn
is a bounded linear isomorphism of S onto X with a continuous
inverse. Deduce that for each positive integer N the coordinate
functional ∞
n=1 λnxn →λN belongs to the dual space X∗.
.3
Use an argument like that of Exercise (6.3.3: 4) to give another proof
of the Uniform Boundedness Theorem.
.4
Let X, Y be Banach spaces, and suppose that for all distinct y, y′ in
Y there exists a bounded linear functional f on Y such that f(y) ̸=
f(y′). Let T : X →Y be a linear mapping such that if (xn) is a
sequence in X converging to 0, then (f ◦T) (xn) converges to 0 for
each bounded linear functional f on Y . Prove that T is bounded.
(Use the Closed Graph Theorem.)
.5
Let (Tn) be a sequence of bounded linear mappings of a Banach space
X into a Banach space Y, such that the sequence (Tnx) converges in
Y for each x ∈X. Prove that
Tx = lim
n→∞Tnx
deﬁnes a bounded linear mapping T : X →Y. (Use the Uniform
Boundedness Theorem.)
.6
Let S, T be mappings of a Hilbert space H into itself such that
⟨Sx, y⟩= ⟨x, Ty⟩for all x, y ∈H. Prove that S and T are linear
mappings. Then give two proofs that both S and T are bounded.
(For one proof use the Closed Graph Theorem.)
.7
Let A, B be disjoint subspaces of a Banach space X such that each
element x of X can be written uniquely in the form
x = PAx + PBx
with PAx ∈A and PBx ∈B. Prove that the oblique projection map-
pings PA : X →A and PB : X →B so deﬁned are linear, and that
they are bounded if and only if A and B are closed in X.
.8
Prove Landau’s Theorem: if (an) is a sequence of complex num-
bers such that ∞
n=1 anxn converges for each (xn) ∈l2(C), then
(an) ∈l2(C). (For each x = (xn) ∈l2(C) and each k, deﬁne
sk(x) = k
n=1 anxn. Apply the Uniform Boundedness Theorem to
the sequence (sk)∞
k=1 of linear functionals on l2(C), to show that the
partial sums of ∞
n=1 |an|2 are bounded.)

288
6. An Introduction to Functional Analysis
.9
Let w be a weight function on the compact interval I = [a, b]. For
each positive integer n let (xn,0, xn,1, . . . , xn,n) be a partition of I,
and deﬁne a linear functional Ln on C(I) by
Lnf =
n

k=0
cn,kf(xn,k),
where each cn,k ∈R. Prove Polya’s Theorem on approximate quadra-
ture: in order that limn→∞Lnf =
% b
a f(x)w(x) dx for all f ∈C(I), it
is necessary and suﬃcient that supn≥1
n
k=0 |cn,k| < ∞.
.10 Let T be an operator on a Hilbert space. Prove that ran(T) is closed
if and only if ran(T ∗) is closed. (Suppose that ran(T) is closed, note
Exercise (5.3.3: 6), and show that ran(T ∗T) is closed. To do so, let
T ∗Txn →ξ, and use the Uniform Boundedness Theorem to show
that the linear functional Tx →⟨x, ξ⟩is bounded on the Hilbert
space ran(T).)
Perhaps the standard illustration of the Uniform Boundedness Theorem
in action is the proof that there exists a 2π–periodic continuous function
f : R →C whose Fourier series does not converge at 0.
Let S denote the subspace of C∞(R, C) consisting of all 2π–periodic
continuous mappings of R into C. Recall that the Fourier series, or Fourier
expansion, of f ∈S at x is deﬁned to be
s(f, x) =
∞

n=−∞
-f(n)einx,
where the Fourier coeﬃcients are given by
-f(n) = 1
2π
$ π
−π
f(t)e−int dt
(n ∈Z).
For each positive integer N let
sN(f, x) =
N

n=−N
-f(n)einx.
Then
sN(f, x) = 1
2π
$ π
−π
f(t)DN(x −t) dt = 1
2π
$ π
−π
f(−t)DN(t) dt,
where the Dirichlet kernel DN is deﬁned by
DN(t) =
N

n=−N
eint.

6.3 Baire’s Theorem and Beyond
289
Deﬁne a linear mapping uN : S→R by
uN(f) = sN(f, 0).
Then
|uN(f)| ≤1
2π ∥f∥
$ π
−π
|DN(t)| dt,
where ∥f∥is the sup norm of f. Thus uN is bounded, and
∥uN∥≤1
2π
$ π
−π
|DN(t)| dt.
(2)
On the other hand, there exists a sequence (fn) of elements of S such that
• −1 ≤fn ≤1 for each n, and
• fn(t) →sgn (DN(t)) for each t ∈R;
see Exercise (6.3.11: 2). Using Lebesgue’s Dominated Convergence Theorem
(2.2.14), we now obtain
uN(fn) = 1
2π
$ π
−π
fn (−t) DN (t) dt →1
2π
$ π
−π
sgn (DN(−t) ) DN (t) dt
as n →∞. But
DN(t) = sin

N + 1
2
	
t
sin
 t
2
	
= DN(−t),
so
lim
n→∞uN(fn) = 1
2π
$ π
−π
|DN (t)| dt,
and therefore, in view of (2),
∥uN∥= 1
2π
$ π
−π
|DN(t)| dt.
Next, noting that |sin (t/2)| ≤t/2 for all t > 0, we have
∥uN∥= 1
2π
$ π
−π
|DN (t)| dt
= 1
π
$ π
0
     
sin

N + 1
2
	
t
sin
 t
2
	
     dt
≥2
π
$ π
0
1
t
  sin

N + 1
2
	
t
  dt
= 2
π
$ (N+ 1
2)π
0
1
t |sin t| dt

290
6. An Introduction to Functional Analysis
> 2
π
N

n=1
1
nπ
$ nπ
(n−1)π
|sin t| dt
= 4
π2
N

n=1
1
n
and therefore ∥uN∥→∞as N →∞. By the Uniform Boundedness The-
orem (6.3.9), there exists f ∈S such that the set {|uN(f)| : N ≥1} is
unbounded. Hence the Fourier series of f cannot converge at 0.
(6.3.11) Exercises
.1
Prove that
N

n=−N
eint = sin

N + 1
2
	
t
sin
 t
2
	
for each natural number N.
.2
Prove that, in the notation of the preceding paragraphs, there exists
a sequence (fn) of elements of S such that −1 ≤fn ≤1 for each n,
and such that fn(t) →sgn (DN(t)) for each t ∈R.
.3
In view of the Riemann–Lebesgue Lemma (Exercise (2.3.3: 13)),
Tf =

-f(n)
∞
n=1
deﬁnes a mapping T : L1[−π, π] →c0. Prove that T is one–one but
not onto c0. (Show that there exists α > 0 such that ∥T(Dn)∥≥
α ∥Dn∥1 for each n.)

Appendix A
What Is a Real Number?
In this appendix we sketch Bishop’s adaptation of Cauchy’s construction
of the set R, based on the idea that a real number is an object that can
be approximated arbitrarily closely by rational numbers.
Passing over the standard construction of the set Z of integers, we deﬁne
a rational number to be an ordered pair (m, n) of integers, usually written
m/n or m
n , such that n ̸= 0. Two rational numbers m/n and m′/n′ are said
to be equal, and we write m/n = m′/n′, if mn′ and m′n are equal integers;
this relation of equality is an equivalence relation.
We should really deﬁne a rational number to be an equivalence class of
ordered pairs of integers relative to the equivalence relation of equality that
we have just introduced. In that case two rational numbers (equivalence
classes) would be equal if and only if they were one and the same. However,
it more closely reﬂects common practice if we follow the approach in which
rational numbers are given by the integer pairs themselves, and equality of
rational numbers is a deﬁned notion (given by a certain condition on the
integer pairs) rather than the logical one of identity.1 We follow a similar
approach to the equality of real numbers in due course. In every case we
use without further mention the standard symbol = to denote equality.
1For example, from childhood we are led to consider the rational numbers
1
2, 2
4, and 3
6 as equal, not as representatives of some equivalence class. For another
example, we consider the numbers 1, 0 · 999 · · · , and 5
5 to be equal although they
are not logically identical (they are presented to us in diﬀerent ways).

292
Appendix A. What Is a Real Number?
We omit the details of the familiar algebraic operations and the order
relations >, ≥on the set Q of rational numbers. We identify the integer n
with the rational number n/1.
By a real number we mean a sequence x = (xn)∞
n=1 of rational numbers
that is regular in the sense that
|xm −xn| ≤1
m + 1
n
(m, n ∈N+).
The term xn is called the nth rational approximation to the real number
x. The set of real numbers is, of course, denoted by R.
We identify a rational number r with the real number (r, r, r, ...) ; with
that identiﬁcation, Q, N, and Z become subsets of R.
To specify completely the set R of real numbers, we must equip it with
an appropriate notion of equality. Two real numbers x = (xn) and y = (yn)
are said to be equal if
|xn −yn| ≤2
n
(n ∈N+).
Note that this notion of equality is an equivalence relation: it is clearly
reﬂexive and symmetric; its transitivity is a simple consequence of the
following result.
(A.1) Lemma.
Two real numbers x = (xn) and y = (yn) are equal if
and only if for each positive integer k there exists a positive integer Nk such
that |xn −yn| ≤1/k whenever n ≥Nk.
Proof.
If x = y, then for each k we need only take Nk = 2k. Conversely,
suppose that for each k there exists Nk with the stated property, and
consider any positive integers n and k. Setting m = k + Nk, we have
|xn −yn| ≤|xn −xm| + |xm −ym| + |ym −yn|
≤
 1
n + 1
m
	
+ 1
k +
 1
n + 1
m
	
< 2
n + 3
k.
Since this holds for all positive integers k, we see that |xn −yn| ≤2/n. But
n is arbitrary, so x = y.
2
(A.2) Exercises
.1
Complete the proof that equality of real numbers is an equivalence
relation.
.2
Let k be any positive integer. Show that the operation which assigns
to each real number (xn)∞
n=1 its kth rational approximation xk does
not preserve equality.

Appendix A. What Is a Real Number?
293
.3
Prove that two real numbers x = (xn) and y = (yn) are equal if and
only if for each c > 0 and each positive integer k there exists Nk such
that |xn −yn| ≤c/k for all n ≥Nk.
To introduce the algebraic operations on R we need a special bound for
the terms of a regular sequence x = (xn) of rational numbers. We deﬁne
the canonical bound Kx of x to be the least positive integer greater than
|x1| + 2. It is easy to show that |xn| < Kx for all n.
The arithmetic operations on real numbers x = (xn) and y = (yn) are
deﬁned in terms of the rational approximations to those numbers as follows.
(x + y)n = x2n + y2n,
(x −y)n = x2n −y2n,
(xy)n = x2κny2κn, where κ = max{Kx, Ky},
max{x, y}n = max{xn, yn},
min{x, y}n = min{xn, yn},
|x|n = |xn| .
Here, for example, (x + y)n denotes the nth rational approximation to the
real number x+y, and max{xn, yn} is the maximum, computed in the usual
way, of the rational numbers xn and yn. Of course, we must verify that the
foregoing deﬁnitions yield real numbers; we illustrate this veriﬁcation with
the case of the product xy. Writing zn = x2κny2κn, so that xy = (zn), for
all positive integers m and n we have
|zm −zn| = |x2κm(y2κm −y2κn) + y2κn(x2κm −x2κn)|
≤|x2κm| |y2κm −y2κn| + |y2κn| |x2κm −x2κn|
≤κ

1
2κm +
1
2κn
	
+ κ

1
2κm +
1
2κn
	
= 1
m + 1
n.
Thus xy is a regular sequence of rational numbers—that is, a real number.
In the rest of this appendix, x = (xn), y = (yn), and z = (zn) are real
numbers.
(A.3) Exercises
.1
Prove that |xn| < Kx for each n.
.2
Prove that x + y, x −y, max{x, y}, min{x, y}, and |x| are real
numbers.
.3
Let x′ and y′ be real numbers such that x = x′ and y = y′. Prove
that x + y = x′ + y′ and xy = x′y′.
Thus the operations of addition and multiplication arise from func-
tions on the Cartesian product R × R when the relation of equality

294
Appendix A. What Is a Real Number?
on that set is deﬁned in the natural way: (x, y) = (x′, y′) if and only
if x = x′ and y = y′.
.4
Sums, diﬀerences, products, maxima, and minima of ﬁnitely many
real numbers are deﬁned inductively: for example, we deﬁne
max{x1, . . . , xn+1} = max{max{x1, . . . , xn}, xn+1}.
Show that if σ is a permutation of {1, . . . , n}, then
max{xσ(1), . . . , xσ(n)} = max{x1, . . . , xn}.
.5
Prove each of the following identities.
(i) x + y = y + x
(ii) x + (y + z) = (x + y) + z
(iii) xy = yx
(iv) 0 + x = x + 0 = x
(v) 1x = x1 = x.
(These should serve to convince you that addition and multiplica-
tion, as deﬁned previously, have the properties that we expect from
elementary school.)
.6
Prove that for each m the mth rational approximation to 1/n −
|x −xn| is 1/n −|x4m −xn| .
The real number x = (xn) is said to be positive if there exists n such
that xn > 1/n. We deﬁne x > y to mean that x −y is positive; thus x > 0
if and only if x is positive. On the other hand, we say that x is
• negative if −x is positive, and
• nonnegative if xn ≥−1/n for all n.
We write x ≥y to denote that x −y is nonnegative, and we deﬁne x < y
and x ≤y to have the usual meanings relative to the relations >, ≥.
(A.4) Exercise
Prove that if x > 0, then x ≥0.
(A.5) Proposition.
A real number x = (xn) is positive if and only if
there exists a positive integer N such that xm ≥1/N for all m ≥N. On
the other hand, x is nonnegative if and only if for each positive integer k
there exists a positive integer Nk such that xm ≥−1/k for all m ≥Nk.

Appendix A. What Is a Real Number?
295
Proof.
If x is positive, then xn > 1/n for some n. Choosing the positive
integer N so that 2/N ≤xn −1/n, for each m ≥N we have
xm ≥xn −|xm −xn|
≥xn −1
m −1
n
≥xn −1
N −1
n
> 1
N .
So the required property holds. If, conversely, that property holds, then
xN+1 > 1/(N + 1), so x > 0.
The proof of the second part of the proposition is left as an exercise.
2
(A.6) Exercises
.1
Prove the second part of the preceding proposition.
.2
Prove that if x = x′, y = y′, and x > y (respectively, x ≥y), then
x′ > y′ (respectively, x′ ≥y′).
.3
Prove the Axiom of Archimedes: if x > 0 and y ≥0, then there exists
n ∈N+ such that nx > y.
.4
Prove that on Q the relations > and ≥, deﬁned as for real num-
bers, coincide with the standard elementary order relations between
rational numbers.
.5
Prove the triangle inequality for real numbers: |x + y| ≤|x| + |y| .
It is left as a relatively straightforward exercise to prove most of the
elementary properties of the partial orders >, ≥on R. However, we need
to tie up a few loose ends, the ﬁrst of which concerns the order density of
Q in R and requires a simple lemma.
(A.7) Lemma.
|x −xn| ≤1/n for each n.
Proof.
Fix the positive integer n. By Exercise (A.3: 6), for each m the
mth rational approximation to 1/n −|x −xn| is
1
n −|x4m −xn| ≥1
n −( 1
4m + 1
n) = −1
4m > −1
m.
Hence 1/n −|x −xn| ≥0, and therefore |x −xn| ≤1/n.
2
(A.8) Proposition.
Q is order dense in R —that is, for all x and y in
R with x < y, there exists r ∈Q such that x < r < y.
Proof.
Since
0 < y −x = (y2n −x2n)∞
n=1 ,

296
Appendix A. What Is a Real Number?
there exists N such that y2N −x2N > 1/N. Writing
r = 1
2 (x2N + y2N)
and using Lemma (A.7), we have
r −x ≥r −x2N −|x2N −x|
≥1
2 (y2N −x2N) −
1
2N > 0,
and similarly y −r > 0. Hence x < r < y.
2
Here is a good application of Proposition (A.8).
(A.9) Proposition.
If x + y > 0, then either x > 0 or y > 0.
Proof.
Let x + y > 0. By Proposition (A.8), there exists a rational
number α such that 0 < α < x + y. Using Exercise (A.6: 3), choose a
positive integer n > 4/α. Let r = xn and s = yn. Then r and s are
rational; also, by Lemma (A.7), |x −r| < α/4 and |y −s| < α/4. Using the
triangle inequality, we now see that
r + s ≥(x + y) −(|x −r| + |y −s|)
> α −
 α
4 + α
4
	
= α
2 .
Since r and s are rational numbers, either r > α/4 or s > α/4. In the ﬁrst
case, x ≥r −|x −r| > 0 ; in the second, y > 0.
2
For each nonzero real number x the reciprocal, or inverse, of x is the real
number 1
x (also written 1/x or x−1) deﬁned as follows. Choose a positive
integer N such that |xn| ≥1/N for all n ≥N, and set
 1
x

n
=



1/xN 3
if n < N
1/xnN 2
if n ≥N.
The last set of exercises in this appendix shows that this is a good deﬁnition
of 1/x.
(A.10) Exercises
.1
Let x be a nonzero real number, and 1/x the reciprocal of x as just
deﬁned. Prove that 1/x is a real number, and that it is the unique
real number t such that xt = 1.

Appendix A. What Is a Real Number?
297
.2
Let x be a nonzero real number, and let N be as in the deﬁnition of
1/x. Let M be a positive integer such that |xn| ≥1/M for all n ≥M,
and deﬁne a real number y = (yn) by
yn =



1/xM 3
if n < M
1/xnM 2
if n ≥M.
Give two proofs that y = 1/x.
.3
Prove that the operation that assigns 1/x to the nonzero real number
x is a function (respects equality) and maps the set of nonzero real
numbers onto itself.

Appendix B
Axioms of Choice and Zorn’s
Lemma
In the early years of this century it was recognised that the following princi-
ple, the Axiom of Choice, was necessary for the proofs of several important
theorems in mathematics.
AC
If F is a nonempty family of pairwise–disjoint nonempty sets, then
there exists a set that intersects each member of F in exactly one
element.
In particular, Zermelo used this axiom explicitly in his proof that every set
S can be well–ordered—that is, there is a total partial order ≥on S with
respect to which every nonempty subset of X has a least element [57]. It
was shown by G¨odel [18] in 1939 that the Axiom of Choice is consistent
with the axioms of Zermelo–Fraenkel set theory (ZF), in the sense that
the axiom can be added to ZF without leading to a contradiction, and
by Cohen [11] in 1963 that the negation of the Axiom of Choice is also
consistent with ZF. Thus the Axiom of Choice is independent of ZF: it can
be neither proved nor disproved without adding some extra principles to
ZF.
The Axiom of Choice is commonly used in an equivalent form (the one
we used in the proof of Lemma (1.3.5)):
AC′ If A and B are nonempty sets, S ⊂A × B, and for each x ∈A
there exists y ∈B such that (x, y) ∈S, then there exists a function
f : A →B —called a choice function for S —such that (x, f(x)) ∈S
for each x ∈A.

300
Appendix B. Axioms of Choice and Zorn’s Lemma
To prove the equivalence of these two forms of the Axiom of Choice, ﬁrst
assume that the original version AC of the axiom holds, and consider
nonempty sets A, B and a subset S of A × B such that for each x ∈A
there exists y ∈B with (x, y) ∈S. For each x ∈A let
Fx = {x} × {y ∈B : (x, y) ∈S} .
Then F = (Fx)x∈A is a nonempty family of pairwise–disjoint sets, so, by
AC, there exists a set C that has exactly one element in common with each
Fx. We now deﬁne the required choice function f : A →B by setting
(x, f(x)) = the unique element of C ∩Fx
for each x ∈A.
Now assume that the alternative form AC′ of the Axiom of Choice holds,
and consider a nonempty family F of pairwise–disjoint nonempty sets.
Taking
A = F,
B =

X∈F
X,
S = {(X, x) : X ∈F, x ∈X}
in AC′, we obtain a function
f : F →

X∈F
X
such that f(X) ∈X for each X ∈F. The range of f is then a set that has
exactly one element in common with each member of F.
There are two other choice principles that are widely used in analysis.
The ﬁrst of these, the Principle of Countable Choice, is the case A = N of
AC′. The second is the Principle of Dependent Choice:
If a ∈A, S ⊂A × A, and for each x ∈A there exists y ∈A
such that (x, y) ∈S, then there exists a sequence (an)∞
n=1 in A
such that a1 = a and (an, an+1) ∈S for each n.
It is a good exercise to show that the Axiom of Choice entails the Principle
of Dependent Choice, and that the Principle of Dependent Choice entails
the Principle of Countable Choice. Since the last two principles can be
derived as consequences of the axioms of ZF, they are deﬁnitely weaker
than the Axiom of Choice.
There are many principles that are equivalent to the Axiom of Choice.
One of those, Zorn’s Lemma, is needed for our proof of the Hahn–Banach
Theorem in Chapter 6.
A nonempty subset C of a partially ordered set (A, ≽) is called a chain
if for all x, y ∈C either x ≽y or y ≽x. Zorn’s Lemma states that

Appendix B. Axioms of Choice and Zorn’s Lemma
301
If every chain in a partially ordered set A has an upper bound
in A, then A has a maximal element.
For a fuller discussion of axioms of choice, Zorn’s Lemma, and related
matters, see the article by Jech on pages 345–370 of [2].

Appendix C
Pareto Optimality
In this appendix we show how some of the results and ideas in our main
chapters can be applied within theoretical economics.
We assume that there are a ﬁnite number m of consumers and a ﬁnite
number n of producers. Consumer i has a consumption set Xi ⊂RN, where
a consumption bundle xi = (xi1, . . . , xiN ) ∈Xi is interpreted as follows:
xik is the quantity of the kth commodity (a good or a service) taken by
consumer i when he chooses the consumption bundle xi. Producer j has
a production set Yj ⊂RN, where the kth entry in the production vector
yj = (yj1, . . . , yjN ) ∈Yj is interpreted as the amount of the kth commodity
produced by producer j under her adopted production schedule. Other
important sets in this context are the aggregate consumption set
X = X1 + · · · + Xm
and the aggregate production set
Y = Y1 + · · · + Yn.
A price vector is simply an element p of RN; the kth component pk of
p is the price of one unit of the kth commodity. Thus the total cost to
consumer i of the consumption bundle xi is ⟨p, xi⟩, where ⟨·, ·⟩denotes the
usual inner product on RN; and the proﬁt to producer j of the production
vector yj is ⟨p, yj⟩.
We assume that the preferences of consumer i are represented by a re-
ﬂexive, transitive total partial order ≽i on Xi, called the preference relation
of consumer i. The corresponding relations ≻i of strict preference, and ∼i

304
Appendix C. Pareto Optimality
of preference–indiﬀerence, are deﬁned on Xi as follows.
x ≻i y
if and only if
x ≽i y and not (y ≽i x) ;
x ∼i y
if and only if
x ≽i y and y ≽i x.
Routine arguments show that ≻i and ∼i are transitive; that x ≻i x is
contradictory; that if either x ≻i y or x ∼i y, then x ≽i y; and that if
either x ≻i y ≽i z or x ≽i y ≻i z, then x ≻i z. The informal meaning of
x ≽i y is that consumer i ﬁnds x at least as attractive as y; x ≻i y means
that he strictly prefers x to y; and x ∼i y signiﬁes that he does not mind
which of x or y he obtains.
It is convenient to introduce consumer i’s upper contour set at x,
[x, →) = {ξ ∈Xi : ξ ≽i x} ,
and his strict upper contour set at x,
(x, →) = {ξ ∈Xi : ξ ≻i x} .
The preference relation ≻i is said to be locally nonsatiated at xi ∈Xi if for
each ε > 0, B(xi, ε) ∩(xi, →) is nonempty—that is, there exists x′
i ∈Xi
such that ∥xi −x′
i∥< ε and x′
i ≻i xi.
By a chosen point for consumer i under the price vector p we mean a
point ξi ∈Xi such that for all xi ∈Xi,
⟨p, ξi⟩≥⟨p, xi⟩⇒ξi ≽i xi
or, equivalently,
xi ≻i ξi ⇒⟨p, xi⟩> ⟨p, ξi⟩.
(C.1) Lemma.
If ξi ∈Xi is a chosen point for consumer i under the
price vector p, and xi ∼ξi is a point of Xi at which ≻i is locally nonsatiated,
then ⟨p, xi⟩≥⟨p, ξi⟩.
Proof.
Suppose that ⟨p, xi⟩< ⟨p, ξi⟩. By the continuity of the mapping
x →⟨p, x⟩on RN, there exists r > 0 such that if x′
i ∈Xi and ∥x′
i−xi∥< r,
then ⟨p, x′
i⟩< ⟨p, ξi⟩. As ≽i is locally nonsatiated at xi, there exists x′
i ∈Xi
such that x′
i ≻i xi and ∥x′
i −xi∥< r. Then ⟨p, ξi⟩> ⟨p, x′
i⟩; so ξi ≽i x′
i, as
ξi is a chosen point. But we also have x′
i ≻i xi ∼i ξi and therefore x′
i ≻i ξi,
a contradiction.
2
We now assume that consumer i has an initial endowment of com-
modities, represented by the vector ¯xi = (¯xi1, . . . , ¯xiN ). The total initial
endowment of all consumers is then
¯x = ¯x1 + · · · + ¯xm ∈X.

Appendix C. Pareto Optimality
305
We say that an element (y1, . . . , yn) of Y1 × · · · × Yn is an admissible array
of production vectors; and that an element (x1, . . . , xm) of X1 ×· · ·×Xm is
a feasible array of consumption bundles if there exists an admissible array
(y1, . . . , yn) of production vectors such that
m

i=1
xi =
n

j=1
yj + ¯x.
Intuitively, a feasible array is one that can be obtained by a distribution of
the total initial endowment and the total of the production vectors under
some production schedule.
An array (ξ1, . . . , ξm) ∈X1 ×· · ·×Xm of consumption bundles is said to
be Pareto optimal, or a Pareto optimum, if it is feasible and if the following
condition holds.
PO
If (x1, . . . , xm) is a feasible array such that xi ≻i ξi for some i, then
there exists k such that ξk ≻k xk.
Equivalently, the array is Pareto optimal if there is no feasible array (x1, . . . ,
xm) such that xi ≽i ξi for all i, and such that xi ≻i ξi for at least one i.
By a competitive equilibrium we mean a triple consisting of a price vector
p, an array (ξ1, . . . , ξm) of consumption bundles, and an admissible array
(η1, . . . , ηn) of production vectors, satisfying the following conditions.
CE1 For 1 ≤i ≤m, ξi is a chosen point for consumer i under the price
vector p.
CE2 For 1 ≤j ≤n, if yj ∈Yj, then ⟨p, ηj⟩≥⟨p, yj⟩.
CE3 m
i=1 ξi = n
j=1 ηj + ¯x.
Condition CE1 expresses consumer satisfaction; CE2, proﬁt maximisation;
and CE3, feasibility.
(C.2) Proposition.
Assume that each ≽i is locally nonsatiated, and let
(p, (ξ1, . . . , ξm), (η1, . . . , ηn))
be a competitive equilibrium. Then (ξ1, . . . , ξm) is a Pareto optimum.
Proof.
Condition CE3 ensures that (ξ1, . . . ,ξm) is a feasible array of
consumption bundles. Suppose that (ξ1, . . . , ξm) is not a Pareto optimum.
Then there exist an array (x1, . . . , xm) of consumption bundles and an
admissible array (y1, . . . , yn) of production vectors such that
m

i=1
xi =
n

j=1
yj + ¯x,
(1)

306
Appendix C. Pareto Optimality
xi ≽i ξi for all i, and xk ≻k ξk for some k. By CE1, if xi ≻i ξi, then
⟨p, xi⟩> ⟨p, ξi⟩; in particular, ⟨p, xk⟩> ⟨p, ξk⟩. If ξi ≽i xi, then xi ∼i ξi
and so, by Lemma (C.1), ⟨p, xi⟩≥⟨p, ξi⟩. Thus
m

i=1
⟨p, xi⟩>
m

i=1
⟨p, ξi⟩
=
n

j=1
⟨p, ηj⟩+ ⟨p, ¯x⟩
(by CE3)
≥
n

j=1
⟨p, yj⟩+ ⟨p, ¯x⟩
(by CE2).
Hence
7
p,


m

i=1
xi −
n

j=1
yj −¯x


8
> 0,
and therefore, by the Cauchy–Schwarz inequality in RN,
m

i=1
xi ̸=
n

j=1
yj + ¯x.
This contradicts (1).
2
Our next aim is to establish a partial converse of Proposition (C.2), pro-
viding conditions under which a Pareto optimum gives rise to a competitive
equilibrium. We ﬁrst introduce some more deﬁnitions.
The preference relation ≽i on Xi is said to be convex if
• Xi is convex,
• x ≻i x′ ⇒tx + (1 −t)x′ ≻i x′ whenever 0 < t < 1, and
• x ∼i x′ ⇒tx + (1 −t)x′ ≽i x′ whenever 0 < t < 1.
In that case the sets [x, →) and (x, →) are convex.
We say that consumer i is nonsatiated at ξi ∈Xi if there exists x ∈Xi
such that x ≻i ξi ; otherwise, we say that he is satiated at ξi.
(C.3) Proposition.
Let (ξ1, . . . , ξm) be a Pareto optimum such that for
at least one value of i, consumer i is nonsatiated at ξi, and let (η1, . . . , ηn)
be an admissible array of production vectors. Suppose that ≽i is convex for
each i, and that the aggregate production set Y is convex. Then there exists
a nonzero price vector p such that
(i) for each i, if xi ∈Xi and xi ≽i ξi, then ⟨p, xi⟩≥⟨p, ξi⟩;

Appendix C. Pareto Optimality
307
(ii) for each j, if yj ∈Yj, then ⟨p, ηj⟩≥⟨p, yj⟩.
Proof.
We may assume that consumer 1 is nonsatiated at ξ1. Choose an
admissible array (η1, . . . , ηn) of production vectors such that
ξ =
m

i=1
ξi =
n

j=1
ηj + ¯x.
Let A be the algebraic sum of the sets (ξ1, →) and m
i=2[ξi, →),
A =
! N

i=1
xi ∈RN : x1 ≻1 ξ1 and ∀i ≥2 (xi ≽i ξi)
"
,
and let
B =

x ∈RN : ∃y ∈Y (x = y + ¯x)

.
Clearly, B is convex; by our convexity hypotheses, A is convex. If A ∩B
is nonempty, then there exist x1 ≻1 ξ1, xi ≽i ξi (2 ≤i ≤m), and yj ∈
Yj (1 ≤j ≤n), such that
m

i=1
xi =
n

j=1
yj + ¯x.
This contradicts the hypothesis that (ξ1, . . . , ξm) is a Pareto optimum.
Hence A and B are disjoint subsets of RN. Since these sets are clearly
nonempty, it follows from Minkowski’s Separation Theorem (6.2.6) and the
Riesz Representation Theorem (5.3.1) that there exist a nonzero vector
p ∈RN and a real number α such that ⟨p, x⟩≥α for all x ∈A, and
⟨p, x⟩≤α for all x ∈B. Since ξ ∈B, we have ⟨p, ξ⟩≤α. We now show
that ⟨p, ξ⟩= α.
To this end, consider m
i=1 xi,with x1 ≻1 ξ1 and xi ≽i ξi (2 ≤i ≤m).
For 0 < t < 1 deﬁne
zi(t) = txi + (1 −t)ξi
(1 ≤i ≤m)
and
z(t) =
m

i=1
zi(t).
Since ≽i is convex for each i,
z1(t) ∈(ξ1, →) ,
zi(t) ∈[ξi, →)
(2 ≤i ≤m) ;
whence z(t) ∈A and therefore ⟨p, z(t)⟩≥α. Letting t →0 and using the
continuity of the mapping x →⟨p, x⟩on RN, we see that ⟨p, ξ⟩≥α and
therefore that ⟨p, ξ⟩= α, as we wanted to show.

308
Appendix C. Pareto Optimality
It now follows that ⟨p, x⟩≥⟨p, ξ⟩for all x ∈A, and that ⟨p, x⟩≤⟨p, ξ⟩
for all x ∈B. Thus if (y1, . . . , yn) is an admissible array of production
vectors, then
7
p,
n

j=1
yj + ¯x
8
≤⟨p, ξ⟩=
7
p,
n

j=1
ηj + ¯x
8
and therefore
n

j=1
⟨p, yj⟩≤
n

j=1
⟨p, ηj⟩.
Given j ∈{1, . . . , n}, and taking yj ∈Yj and yk = ηk for all k ̸= j (1 ≤
k ≤n), we now obtain ⟨p, ηj⟩≥⟨p, yj⟩. This completes the proof of (ii).
A similar argument, using the fact that ⟨p, x⟩≥⟨p, ξ⟩for all x ∈A,
shows that
⟨p, x1⟩≥⟨p, ξ1⟩for all x1 ∈(ξ1, →)
(2)
and that ⟨p, xi⟩≥⟨p, ξi⟩for all xi ∈[ξi, →) (2 ≤i ≤m). To complete the
proof of (i), we show that if x1 ∼1 ξ1, then ⟨p, x1⟩≥⟨p, ξ1⟩. To this end, we
recall that consumer 1 is nonsatiated at ξ1, so there exists x′
1 ∈X1 with
x′
1 ≻1 ξ1 ∼1 x1.
It follows from this and the convexity of ≽1 that for each t ∈(0, 1),
x′
1(t) = tx′
1 + (1 −t)x1 ≻1 ξ1;
whence ⟨p, x′
1(t)⟩≥⟨p, ξ1⟩, by (2). The continuity of the function x →⟨p, x⟩
on RN now ensures that ⟨p, x1⟩≥⟨p, ξ1⟩, as we required. This completes
the proof of (i).
2
(C.4) Corollary.
Under the hypotheses of Proposition (C.3), suppose
also that the following conditions hold.
(i) For each price vector p and each i (1 ≤i ≤m), there exists ξ′
i ∈Xi
such that ⟨p, ξ′
i⟩< ⟨p, ξi⟩(cheaper point condition).
(ii) For each i (1 ≤i ≤m), (ξi, →) is open in Xi.
Then (p, (ξ1, . . . , ξm), (η1, . . . , ηn)) is a competitive equilibrium.
Proof.
In view of Proposition (C.3), we need only prove that CE1 holds.
To this end, let xi ≻i ξi, and choose ξ′
i ∈Xi as in hypothesis (i). Then, by
Proposition (C.3), ξi ≻i ξ′
i. For each t ∈(0, 1) deﬁne
xi(t) = tξ′
i + (1 −t)xi.

Appendix C. Pareto Optimality
309
As (ξi, →) is open in Xi, we can choose t ∈(0, 1) so small that xi(t) ≻i ξi.
Then, by Proposition (C.3),
t ⟨p, ξ′
i⟩+ (1 −t) ⟨p, xi⟩= ⟨p, xi(t)⟩
≥⟨p, ξi⟩
= t ⟨p, ξi⟩+ (1 −t) ⟨p, ξi⟩
> t ⟨p, ξ′
i⟩+ (1 −t) ⟨p, ξi⟩.
Hence
(1 −t) ⟨p, xi⟩> (1 −t) ⟨p, ξi⟩
and therefore ⟨p, xi⟩> ⟨p, ξi⟩. Thus ξi is a chosen point.
2
The cheaper point assumption cannot be omitted from the hypotheses
of Corollary (C.4); see pages 198–201 of [51].

References
The following list contains both works that were consulted during the
writing of this book and suggestions for further reading.
University libraries usually have lots of older books, such as [36], dealing
with classical real analysis at the level of Chapter 1; a good modern refer-
ence for this material is [16]. Excellent references for the abstract theory
of measure and integration, following on from the material in Chapter 2,
are [21], [44], and [43]. (Note, incidentally, the advocacy of a Riemann–like
integral by some authors [1].) Dieudonn´e’s book [13], the ﬁrst of a series
in which he covers a large part of modern analysis, is outstanding and was
a source of much inspiration in my writing of Chapters 3 through 5. An
excellent text for a general course on functional analysis is [45]. This could
be followed by, or taken in conjunction with, material from the two volumes
by Kadison and Ringrose [24] on operator algebra theory, currently one of
the most active and important branches of analysis. Two other excellent
books, each of which overlaps our book in some areas but goes beyond it in
others, are [34], which includes such topics as spectral theory and abstract
integration, and [14], which extends measure theory into a rigorous devel-
opment of probability. More specialised books expanding material covered
in Chapter 6 are the one by Oxtoby [33] on the interplay between Baire
category and measure, and Diestel’s absorbing text [12] on sequences and
series in Banach spaces.
A wonderful book, written in a more discursive style than most others
at this level, is the classic by Riesz and Nag´y [40]; although more old–
fashioned in its approach (it was ﬁrst published in 1955), it is a source of
much valuable material on Lebesgue integration and the theory of operators

312
References
on Hilbert space. A relatively unusual approach to analysis, in which all
concepts and proofs must be fully constructive, is followed in [5]; see also
Chapter 4 of [8].
For general applications of functional analysis see Zeidler’s two volumes
[56]. Applications of analysis in mathematical economics can be found in
[9], [30], and [51].
[1] R. G. Bartle: Return to the Riemann integral, Amer. Math. Monthly 103
(1996), 625–632.
[2] J. Barwise: Handbook of Mathematical Logic, North–Holland, Amsterdam,
1977.
[3] G. H. Behforooz: Thinning out the harmonic series, Math. Mag. 68(4), 289–
293, 1985.
[4] A. Bielicki: Une remarque sur la m´ethode de Banach–Cacciopoli–Tikhonov,
Bull. Acad. Polon. Sci. IV (1956), 261–268.
[5] E.A. Bishop and D.S. Bridges: Constructive Analysis, Grundlehren der
math. Wissenschaften 279, Springer–Verlag, Berlin–Heidelberg–New York,
1985.
[6] P. Borwein and T. Erd´elyi: The full M¨untz theorem in C[0, 1] and L1[0, 1],
J. London Math. Soc. (2), 54 (1996), 102–110.
[7] N. Bourbaki: El´ements de Math´ematique, Livre III: Topologie G´en´erale,
Hermann, Paris, 1958.
[8] D.S. Bridges: Computability: A Mathematical Sketchbook, Graduate Texts
in Mathematics 146, Springer–Verlag, Berlin–Heidelberg–New York, 1994.
[9] D.S. and G.B. Mehta: Representations of Preference Orderings, Lecture
Notes in Economics and Mathematical Systems 422, Springer–Verlag,
Berlin–Heidelberg–New York, 1995.
[10] E.W. Cheney: Introduction to Approximation Theory, McGraw–Hill, New
York, 1966.
[11] P.J. Cohen: Set Theory and the Continuum Hypothesis, W.A. Benjamin,
Inc., New York, 1966.
[12] J. Diestel: Sequences and Series in Banach Spaces, Graduate Texts in
Mathematics 92, Springer–Verlag, Berlin–Heidelberg–New York, 1984.
[13] J. Dieudonn´e: Foundations of Modern Analysis, Academic Press, New York,
1960.
[14] R.M. Dudley, Real Analysis and Probability, Chapman & Hall, New York,
1989.
[15] P. Enﬂo: A counterexample to the approximation property in Banach spaces,
Acta Math. 130 (1973), 309–317.

References
313
[16] E. Gaughan: Introduction to Analysis (4th Edn), Brooks/Cole, Paciﬁc
Grove, CA, 1993.
[17] R.P. Gillespie: Integration, Oliver & Boyd, Edinburgh, 1959.
[18] K. G¨odel: The Consistency of the Axiom of Choice and the Generalized Con-
tinuum Hypothesis with the Axioms of Set Theory, Annals of Mathematics
Studies, Vol. 3, Princeton University Press, Princeton, NJ, 1940.
[19] R. Gray: Georg Cantor and transcendental numbers, Amer. Math. Monthly
101 (1994), 819–832.
[20] P.R. Halmos: Naive Set Theory, van Nostrand, Princeton, NJ, 1960;
reprinted as Undergraduate Texts in Mathematics, Springer–Verlag, Berlin–
Heidelberg–New York, 1974.
[21] P.R. Halmos: Measure Theory, van Nostrand, Princeton, NJ, 1950; reprinted
as Graduate Texts in Mathematics 18, Springer–Verlag, Berlin–Heidelberg–
New York, 1975.
[22] J. Hennefeld: A nontopological proof of the uniform boundedness theorem,
Amer. Math. Monthly 87 (1980), 217.
[23] F. John: Partial Diﬀerential Equations (4th Edn), Applied Mathematical
Sciences 1, Springer–Verlag, Berlin–Heidelberg–New York, 1982.
[24] R.V. Kadison and J.R. Ringrose: Fundamentals of the Theory of Operator
Algebras, Academic Press, New York, 1983 (Vol. 1) and 1986 (Vol. 2).
[25] J.L. Kelley: General Topology, van Nostrand, Princeton, NJ, 1955; reprinted
as Graduate Texts in Mathematics 27, Springer–Verlag, Berlin–Heidelberg–
New York, 1975.
[26] D. Kincaid and E.W. Cheney: Numerical Analysis (2nd Edn), Brooks/Cole
Publishing Co., Paciﬁc Grove, CA, 1996.
[27] M. Kline: Mathematical Thought from Ancient to Modern Times, Oxford
University Press, Oxford, 1972.
[28] T.W. K¨orner: Fourier Analysis, Cambridge University Press, Cambridge,
1988.
[29] J. Marsden and A. Tromba: Vector Calculus (3rd Edn), W.H. Freeman &
Co., New York, 1988.
[30] A. Mas–Colell, M.D. Whinston, J.R. Green: Microeconomic Theory, Oxford
University Press, Oxford, 1995.
[31] Y. Matsuoka: An elementary proof of the formula ∞
k=1 1/k2 = π2/6, Amer.
Math. Monthly 68 (1961), 485–487.
[32] N.S. Mendelsohn: An application of a famous inequality, Amer. Math.
Monthly 58 (1951), 563.
[33] J.C. Oxtoby: Measure and Category, Graduate Texts in Mathematics 2,
Springer–Verlag, Berlin–Heidelberg–New York, 1971.

314
References
[34] G.K. Pedersen: Analysis Now, Graduate Texts in Mathematics 118, Springer–
Verlag, Berlin–Heidelberg–New York, 1991.
[35] W.E. Pfaﬀenberger: A converse to a completeness theorem, Amer. Math.
Monthly 87 (1980), 216.
[36] E.G. Phillips: A Course of Analysis (2nd Edn), Cambridge Univ. Press,
Cambridge, 1939.
[37] J. Rauch: Partial Diﬀerential
Equations, Graduate Texts in Mathematics
128, Springer–Verlag, Berlin–Heidelberg–New York, 1991.
[38] J.R. Rice: The Approximation of Functions
(Vol. 1), Addison–Wesley,
Reading, MA, 1964.
[39] F. Riesz: Sur l’int´egrale de Lebesgue comme l’op´eration inverse de la
d´erivation, Ann. Scuola Norm. Sup. Pisa (2) 5, 191–212 (1936).
[40] F. Riesz and B. Sz–Nagy: Functional Analysis, Frederic Ungar Publishing
Co., New York, 1955. Republished by Dover Publications Inc., New York,
1990.
[41] J. Ritt: Integration in Finite Terms, Columbia University Press, New York,
1948.
[42] W.W. Rogosinski: Volume and Integral, Oliver & Boyd, Edinburgh, 1962.
[43] H. Royden: Real Analysis (3rd Edn), Macmillan, New York, 1988.
[44] W. Rudin: Real and Complex Analysis, McGraw–Hill, New York, 1970.
[45] W. Rudin: Functional Analysis (2nd Edn), McGraw–Hill, New York, 1991.
[46] S. Saks: Theory of the Integral (2nd Edn), Dover Publishing, Inc., New York,
1964.
[47] H. Schubert: Topology (S. Moran, transl.), Macdonald Technical & Scientiﬁc,
London, 1968.
[48] R.M. Solovay: A model of set theory in which every set of reals is Lebesgue
measurable, Ann. Math. (Ser. 2) 92, 1–56 (1970).
[49] M. Spivak: Calculus, W.A. Benjamin, London, 1967.
[50] B. Sz–Nagy: Introduction to Real Functions and Orthogonal Expansions,
Oxford University Press, New York, 1965.
[51] A. Takayama: Mathematical Economics, The Dryden Press, Hinsdale IL.,
1974.
[52] J.A. Todd: Introduction to the Constructive Theory of Functions, Birkh¨auser
Verlag, Basel, 1963.
[53] C. de la Vall´ee Poussin: Int´egrales de Lebesgue, fonctions d’ensemble, classes
de Baire, Gauthier–Villars, Paris, 1916.

References
315
[54] B.L. van der Waerden: Ein einfaches Beispiel einer nichtdiﬀerenzierbaren
stetigen Funktion, Math. Zeitschr. 32, 474–475, 1930.
[55] Y.M. Wong: The Lebesgue covering property and uniform continuity, Bull.
London Math. Soc. 4, 184–186, 1972.
[56] E. Zeidler: Applied Functional Analysis (2 Vols), Applied Mathematical
Sciences 108–109, Springer–Verlag, Berlin–Heidelberg–New York,1995.
[57] E. Zermelo: Beweis, dass jede Menge wohlgeordnet werden kann, Math.
Annalen 59 (1904) 514–516.

Index
Absolute convergence, 31
absolute value, 15
absolutely continuous, 84
absolutely convergent, 180
absorbing, 282
adjoint, 254
admissible array, 305
aggregate consumption set, 303
aggregate production set, 303
almost everywhere, 85
α–periodic, 215
alternating series test, 28
antiderivative, 69
antisymmetric, 6
approximate solution, 230
approximation theory, 192
Ascoli’s Theorem, 210
associated metric, 174
asymmetric, 6
attains bounds, 149
Axiom of Archimedes, 14, 295
Axiom of Choice, 299
Baire’s Theorem, 279
Banach space, 178
Beppo Levi’s Theorem, 101
Bernstein polynomial, 214
Bessel’s inequality, 245
best approximation, 192
binary expansion, 29
binomial series, 61
Bolzano–Weierstrass property, 48
Bolzano–Weierstrass Theorem, 48
Borel set, 113
bound, 184
boundary, 39
bounded above, 7
bounded below, 7
bounded function, 8
bounded linear map, 183
bounded operator, 254
bounded sequence, 21, 141
bounded set, 134
bounded variation, 71
BV(I), 205
B(X, Y ), 204
C-measurable, 116
canonical bound, 293
canonical map, 181
Cantor set, 39
Cantor’s Theorem, 26
Cauchy sequence, 25, 140
Cauchy-Euler method, 230

318
Index
Cauchy-Schwarz inequality, 235
Cauchy–Schwarz, 126
centre, 130
Ces`aro mean, 215
chain, 300
chain connected, 160
Chain Rule, 55
change of variable, 107
characteristic function, 99
chosen point, 304
C∞(X, Y ), 206
Clarkson’s inequalities, 198
closed ball, 130
Closed Graph Theorem, 285
closed set, 38, 130, 135
closest point, 192, 239
closure, 38, 130
cluster point, 38, 130, 135
compact, 146
comparison test, 27
competitive equilibrium, 305
complete, 26, 140
completion, 142, 179
complex numbers, 19
conjugate, 19
conjugate bilinear, 255
conjugate exponents, 194
conjugate linear, 234
connected, 158
connected component, 160
consumer, 303
consumption bundle, 303
consumption set, 303
continuous, 44, 136
continuous on an interval, 45
continuous on the left, 44
continuous on the right, 44
continuously diﬀerentiable, 223
contraction mapping, 220
Contraction Mapping Theorem, 220
contractive, 136
converge simply, 206
converge uniformly, 206
convergent mapping, 138
convergent sequence, 20, 139
convergent series, 27, 180
convex, 163, 178
convex hull, 277
coordinate, 242
coordinate functional, 287
countable, 4
countable choice, 300
countably inﬁnite, 4
cover, 47, 146
C(X, Y ), 206
Decreasing, 8, 101
dense, 132
dependent choice, 300
derivative, 53
derivative, higher, 54
derivative, left, 53
derivative, right, 53
diameter, 133
diﬀerentiable, 53
diﬀerentiable on an interval, 53
diﬀerentiable, inﬁnitely, 54
diﬀerentiable n–times, 54
Dini derivates, 88
Dini’s Theorem, 207
Dirichlet kernel, 288
Dirichlet Problem, 257
discontinuity, 45, 136
discrete metric, 126
distance to a set, 133
divergence, 256
divergent series, 28
diverges, 20
Dominated Convergence Theorem,
104
dominates, 104
dual, 183
Edelstein’s Theorem, 149
endpoint, 19, 163
enlargement, 155
ε-approximation, 149
equal, 291, 292
equicontinuous, 208
equivalence class, 6
equivalence relation, 6
equivalent metrics, 131
equivalent norms, 184
essential supremum, 204
essentially bounded, 204
Euclidean metric, 127
Euclidean norm, 175
Euclidean space, 127

Index
319
Euler’s constant, 33
exp, 32
exponential series, 32
extended real line, 129
extension, continuous, 145
extremal element, 93
extreme point, 277
extreme subset, 277
Family, 5
farthest point, 240
Fatou’s Lemma, 104
feasible array, 305
ﬁnite intersection property, 148
ﬁnite real number, 129
ﬁrst category, 280
ﬁxed point, 149, 220
Fourier coeﬃcient, 242, 288
Fourier expansion, 248
Fourier series, 215, 288
frontier, 39
Fubini’s Series Theorem, 90
function, 3
Fundamental Theorem of Calculus,
68, 69
Gauss’s Divergence Theorem, 256
geometric series, 28
Glueing Lemma, 163
gradient, 256
Gram–Schmidt, 249
graph, 285
greatest element, 7
greatest lower bound, 7
Green’s Theorem, 256
Hahn–Banach Theorem, 262
Hahn–Banach Theorem, complex,
263
Heine–Borel–Lebesgue Theorem, 47
Helly’s Theorem, 277
Hermitian, 254
Hilbert space, 237
H¨older’s inequality, 194, 196, 204
hyperplane, 187
hyperplane of support, 188
hyperplane, translated, 188
Idempotent, 256
identity mapping, 136
identity operator, 240
imaginary part, 19
increasing, 8, 101
index set, 5
induced metric, 131
inﬁmum, 7
inﬁmum of a function, 8
inﬁnitely many, 20
inner product, 234
inner product space, 234
integers, 3
integrable, 95, 98, 234
integrable over a set, 99
integrable set, 113
integral, 95, 98
integration by parts, 109
integration space, 197
interior, 37, 130, 135
intermediate value property, 36
Intermediate Value Theorem, 51,
161
interval of convergence, 31
interval, bounded, 19
interval, closed, 19
interval, compact, 19
interval, ﬁnite, 19
interval, half open, 19
interval, inﬁnite, 19
interval, length of, 19
interval, open, 18
Inverse Mapping Theorem, 285
irreﬂexive, 5
isolated, 133
isometric, 128
isometry, 128
iterates, 220
Jacobi polynomial, 252
Kernel, 186
Korovkin’s Theorem, 212, 215
Krein-Milman Theorem, 277
L’Hˆopital’s Rule, 57
Landau’s Theorem, 287
Laplacian operator, 257
largest element, 7
laws of indices, 16

320
Index
laws of logarithms, 18
least element, 8
least squares approximation, 250
least upper bound, 7
least–upper-bound principle, 12
Lebesgue covering property, 153
Lebesgue integrable, 95
Lebesgue integral, 95, 98
Lebesgue measure, 113
Lebesgue number, 153
Lebesgue primitive, 93
Lebesgue’s Series Theorem, 103
left hand derivative, 282
Legendre polynomial, 252
lim inf, 24
lim sup, 24
limit as x tends to inﬁnity, 43
limit comparison test, 28
limit inferior, 24
limit of a function, 41
limit of a mapping, 138
limit of a sequence, 20, 139
limit point, 48, 138
limit superior, 24
limit, left–hand, 41
limit, right–hand, 41
Lindel¨of’s Theorem, 148
linear functional, 182
linear functional, complex–, 259
linear functional, extension of, 261
linear functional, real–, 260
linear map, 182
L∞, 204
Lipschitz condition, 143, 219
Lipschitz constant, 219
locally compact, 156
locally connected, 160
locally nonsatiated, 304
logarithmic function, 18
lower bound, 7
lower integral, 63, 73
lower limit, 24
lower sum, 63, 73
Lp(X), 197
Lp–norm, 197
Majorant, 7
majorised, 7
maximum element, 7
Mazur’s Lemma, 270
Mean Value Theorem, 57
Mean Value Theorem, Cauchy’s, 57
measurable, 110
measurable set, 113
measure, 113
measure zero, 80
mesh, 62
metric, 125
metric space, 126
metrisable, 135
minimum element, 7
Minkowski functional, 275
Minkowski’s inequality, 126, 195,
196, 235
Minkowski’s Separation Theorem,
278
minorant, 7
minorised, 7
modulus, 19
monotone sequence principle, 22
M¨untz, 216
multilinear map, 184
multiplication of series, 32
Natural logarithmic function, 18
natural numbers, 3
negative, 12, 294
neighbourhood, 37, 130, 135
nested intervals, 24
nonnegative, 13, 294
nonoverlapping, 84
nonsatiated, 306
nonzero linear map, 186
norm, 174
norm of a linear map, 183
norm, weighted least squares, 249
norm-preserving, 261
normal operator, 254
normed space, 174
nowhere dense, 280
nowhere diﬀerentiable, 2, 282
null space, 186
Oblique projection, 287
open ball, 130
open mapping, 283
Open Mapping Theorem, 283
open set, 35, 130, 135

Index
321
operator, 253
order dense, 14, 295
orthogonal, 237
orthogonal complement, 237
orthogonal family, 242
orthonormal, 242
orthonormal basis, 247
oscillation, 45
outer measure, 79
outer measure, ﬁnite, 80
P-adic metric, 127
p-power summable, 196
parallelogram law, 236
Pareto optimum, 305
Parseval’s identity, 248
partial order, 6
partial sum, 27, 180
partially ordered set, 6
partition, 62
path, 163
path component, 164
path connected, 163
Peano’s Theorem, 228
period, 215
periodic, 215
Picard’s Theorem, 223
points at inﬁnity, 129
pointwise, 4
polarisation identity, 255
Polya’s Theorem, 288
positive, 12, 294
positive integers, 3
positive linear operator, 212
positively homogeneous, 261
power series, 31
precompact, 149
preference relation, 303
preference relation, convex, 306
preference-indiﬀerence, 304
prehilbert space, 234
preorder, 6
price vector, 303
primitive, 69
producer, 303
product metric, 165
product norm, 176
product normed space, 176
product of paths, 164
product, of metric spaces, 165, 170
production set, 303
production vector, 303
projection, 166, 240
pseudometric, 127
Pythagoras’s Theorem, 238
Quotient norm, 181
quotient space, 181
Radius, 130
radius of convergence, 31
ratio test, 29
rational approximation, 292
rational complex number, 193
rational number, 291
rational numbers, 3
real line, extended, 129
real number, 12, 292
real number line, 11
real part, 19
rearrangement, 34
reciprocal, 296
reﬁnement, 62
reﬂexive, 253, 266
reﬂexive, 5
regular, 292
remainder term, Cauchy form, 59
remainder term, Lagrange form, 59
representable, 272
representation, 187
Riemann integrable, 64
Riemann integral, 64
Riemann sum, 67
Riemann-Lebesgue Lemma, 112
Riemann–Stieljtes integrable, 72
Riemann–Stieltjes integral, 72
Riemann–Stieltjes sum, 72
Riesz Representation Theorem, 252
Riesz’s Lemma, 190
Riesz–Fischer Theorem, 198
right hand derivative, 280
Rodrigues’ formula, 252
Rolle’s Theorem, 56
root test, 30
Satiated, 306
Schauder basis, 269
second category, 280

322
Index
second dual, 253
self–map, 149, 220
selfadjoint, 254
seminorm, 261
separable, 132
separates, 278
sequence, 4
sequentially compact, 149
sequentially continuous, 45, 140
series, 27, 180
simple function, 116
smallest element, 8
step function, 99
Stone–Weierstrass Theorem, 216,
219
strict partial order, 6
strict preference, 303
strictly decreasing, 8
strictly increasing, 8
subadditive, 261
subcover, 47, 146
subfamily, 5
sublinear, 261
subsequence, 4
subspace, 131, 176
subspace of a prehilbert space, 234
suﬃciently large, 20
sum, 180
sup norm, 175, 204
supremum, 7
supremum norm, 175
supremum of a function, 8
symmetric, 5
Taxicab metric, 126
Taylor expansion, 61
Taylor polynomial, 58
Taylor series, 61
Taylor’s Theorem, 58
term, 4, 27
termwise, 5
Tietze Extension Theorem, 144
topological space, 134
topology, 135
total, 193
total order, 6
totally bounded, 149
totally disconnected, 160
transitive, 6
translation invariant, 81, 99
transported, 128
triangle inequality, 15, 126, 174
triple recursion formula, 251
Ultrametric, 127
unconditionally convergent, 180
uncountable, 4
Uniform Boundedness Theorem,
186, 286
Uniform Continuity Theorem, 49,
154
uniformly approximated, 212
uniformly continuous, 49, 142
uniformly convex, 186
uniformly equicontinuous, 209
unit ball, 174
unit vector, 174
upper bound, 7
upper contour set, 304
upper integral, 63, 73
upper limit, 24
upper sum, 63, 73
Urysohn’s Lemma, 146
Variation, 71
Vitali covering, 82
Vitali Covering Theorem, 82
Weak solution, 257
Weierstrass Approximation
Theorem, 212
Weierstrass’s M–test, 46
weight function, 235
Zermelo, 299
Zorn’s Lemma, 300



