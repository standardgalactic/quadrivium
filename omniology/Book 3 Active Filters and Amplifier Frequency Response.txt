Fundamentals of
Electronics: 
Book 3
Active Filters and Amplifier
Frequency Response
Thomas F. Schubert, Jr.
Ernest M. Kim

Fundamentals of Electronics
Book 3
Active Filters and
Ampliﬁer Frequency Response


Synthesis Lectures on Digital
Circuits and Systems
Editor
Mitchell A. ornton, Southern Methodist University
e Synthesis Lectures on Digital Circuits and Systems series is comprised of 50- to 100-page books
targeted for audience members with a wide-ranging background. e Lectures include topics that
are of interest to students, professionals, and researchers in the area of design and analysis of digital
circuits and systems. Each Lecture is self-contained and focuses on the background information
required to understand the subject matter and practical case studies that illustrate applications. e
format of a Lecture is structured such that each will be devoted to a speciﬁc topic in digital circuits
and systems rather than a larger overview of several topics such as that found in a comprehensive
handbook. e Lectures cover both well-established areas as well as newly developed or emerging
material in digital circuits and systems design and analysis.
Fundamentals of Electronics: Book 3 Active Filters and Ampliﬁer Frequency Response
omas F. Schubert, Jr. and Ernest M. Kim
2016
Bad to the Bone: Crafting Electronic Systems with BeagleBone and BeagleBone Black,
Second Edition
Steven F. Barrett and Jason Kridner
2015
Fundamentals of Electronics: Book 2 Ampliﬁers: Analysis and Design
omas F. Schubert and Ernest M. Kim
2015
Fundamentals of Electronics: Book 1 Electronic Devices and Circuit Applications
omas F. Schubert and Ernest M. Kim
2015
Applications of Zero-Suppressed Decision Diagrams
Tsutomu Sasao and Jon T. Butler
2014
Modeling Digital Switching Circuits with Linear Algebra
Mitchell A. ornton
2014

iv
Arduino Microcontroller Processing for Everyone! ird Edition
Steven F. Barrett
2013
Boolean Diﬀerential Equations
Bernd Steinbach and Christian Posthoﬀ
2013
Bad to the Bone: Crafting Electronic Systems with BeagleBone and BeagleBone Black
Steven F. Barrett and Jason Kridner
2013
Introduction to Noise-Resilient Computing
S.N. Yanushkevich, S. Kasai, G. Tangim, A.H. Tran, T. Mohamed, and V.P. Shmerko
2013
Atmel AVR Microcontroller Primer: Programming and Interfacing, Second Edition
Steven F. Barrett and Daniel J. Pack
2012
Representation of Multiple-Valued Logic Functions
Radomir S. Stankovic, Jaakko T. Astola, and Claudio Moraga
2012
Arduino Microcontroller: Processing for Everyone! Second Edition
Steven F. Barrett
2012
Advanced Circuit Simulation Using Multisim Workbench
David Báez-López, Félix E. Guerrero-Castro, and Ofelia Delﬁna Cervantes-Villagómez
2012
Circuit Analysis with Multisim
David Báez-López and Félix E. Guerrero-Castro
2011
Microcontroller Programming and Interfacing Texas Instruments MSP430, Part I
Steven F. Barrett and Daniel J. Pack
2011
Microcontroller Programming and Interfacing Texas Instruments MSP430, Part II
Steven F. Barrett and Daniel J. Pack
2011
Pragmatic Electrical Engineering: Systems and Instruments
William Eccles
2011

v
Pragmatic Electrical Engineering: Fundamentals
William Eccles
2011
Introduction to Embedded Systems: Using ANSI C and the Arduino Development
Environment
David J. Russell
2010
Arduino Microcontroller: Processing for Everyone! Part II
Steven F. Barrett
2010
Arduino Microcontroller Processing for Everyone! Part I
Steven F. Barrett
2010
Digital System Veriﬁcation: A Combined Formal Methods and Simulation Framework
Lun Li and Mitchell A. ornton
2010
Progress in Applications of Boolean Functions
Tsutomu Sasao and Jon T. Butler
2009
Embedded Systems Design with the Atmel AVR Microcontroller: Part II
Steven F. Barrett
2009
Embedded Systems Design with the Atmel AVR Microcontroller: Part I
Steven F. Barrett
2009
Embedded Systems Interfacing for Engineers using the Freescale HCS08 Microcontroller
II: Digital and Analog Hardware Interfacing
Douglas H. Summerville
2009
Designing Asynchronous Circuits using NULL Convention Logic (NCL)
Scott C. Smith and JiaDi
2009
Embedded Systems Interfacing for Engineers using the Freescale HCS08 Microcontroller
I: Assembly Language Programming
Douglas H.Summerville
2009

vi
Developing Embedded Software using DaVinci & OMAP Technology
B.I. (Raj) Pawate
2009
Mismatch and Noise in Modern IC Processes
Andrew Marshall
2009
Asynchronous Sequential Machine Design and Analysis: A Comprehensive Development
of the Design and Analysis of Clock-Independent State Machines and Systems
Richard F. Tinder
2009
An Introduction to Logic Circuit Testing
Parag K. Lala
2008
Pragmatic Power
William J. Eccles
2008
Multiple Valued Logic: Concepts and Representations
D. Michael Miller and Mitchell A. ornton
2007
Finite State Machine Datapath Design, Optimization, and Implementation
Justin Davis and Robert Reese
2007
Atmel AVR Microcontroller Primer: Programming and Interfacing
Steven F. Barrett and Daniel J. Pack
2007
Pragmatic Logic
William J. Eccles
2007
PSpice for Filters and Transmission Lines
Paul Tobin
2007
PSpice for Digital Signal Processing
Paul Tobin
2007
PSpice for Analog Communications Engineering
Paul Tobin
2007

vii
PSpice for Digital Communications Engineering
Paul Tobin
2007
PSpice for Circuit eory and Electronic Devices
Paul Tobin
2007
Pragmatic Circuits: DC and Time Domain
William J. Eccles
2006
Pragmatic Circuits: Frequency Domain
William J. Eccles
2006
Pragmatic Circuits: Signals and Filters
William J. Eccles
2006
High-Speed Digital System Design
Justin Davis
2006
Introduction to Logic Synthesis using Verilog HDL
Robert B.Reese and Mitchell A.ornton
2006
Microcontrollers Fundamentals for Engineers and Scientists
Steven F. Barrett and Daniel J. Pack
2006

Copyright © 2014 by Morgan & Claypool
All rights reserved. No part of this publication may be reproduced, stored in a retrieval system, or transmitted in
any form or by any means—electronic, mechanical, photocopy, recording, or any other except for brief quotations
in printed reviews, without the prior permission of the publisher.
Fundamentals of Electronics: Book 3 Active Filters and Ampliﬁer Frequency Response
omas F. Schubert, Jr. and Ernest M. Kim
www.morganclaypool.com
ISBN: 9781627055666
paperback
ISBN: 9781627055673
ebook
DOI 10.2200/S00712ED1V03Y201603DCS049
A Publication in the Morgan & Claypool Publishers series
SYNTHESIS LECTURES ON DIGITAL CIRCUITS AND SYSTEMS
Lecture #49
Series Editor: Mitchell A. ornton, Southern Methodist University
Series ISSN
Print 1932-3166
Electronic 1932-3174

Fundamentals of Electronics
Book 3
Active Filters and
Ampliﬁer Frequency Response
omas F. Schubert, Jr. and Ernest M. Kim
University of San Diego
SYNTHESIS LECTURES ON DIGITAL CIRCUITS AND SYSTEMS #49
C
M
&
cLaypool
Morgan
publishers
&

ABSTRACT
is book, Active Filters and Ampliﬁer Frequency Response, is the third of four books of a larger
work, Fundamentals of Electronics. It is comprised of three chapters that describe the frequency
dependent response of electronic circuits. is book begins with an extensive tutorial on creating
and using Bode Diagrams that leads to the modeling and design of active ﬁlters using operational
ampliﬁers. e second chapter starts by focusing on bypass and coupling capacitors and, after
introducing high-frequency modeling of bipolar and ﬁeld-eﬀect transistors, extensively develops
the high- and low-frequency response of a variety of common electronic ampliﬁers. e ﬁnal
chapter expands the frequency-dependent discussion to feedback ampliﬁers, the possibility of
instabilities, and remedies for good ampliﬁer design.
Fundamentals of Electronics has been designed primarily for use in an upper division course
in electronics for electrical engineering students and for working professionals. Typically such a
course spans a full academic year consisting of two semesters or three quarters. As such, Active
Filters and Ampliﬁer Frequency Response, and the ﬁrst two books in the series, Electronic Devices
and Circuit Applications, and Ampliﬁers: Analysis and Design, form an appropriate body of material
for such a course.
KEYWORDS
active ﬁlters, frequency response, Bode plot, ﬁlter, Butterworth, low-pass, high-pass,
band-pass, band-stop, Chebyshev, switched capacitor, gain margin, phase margin,
cutoﬀfrequency, high frequency transistor modeling, Miller’s theorem, capacitive
coupling, Cascode, Darlington, multipole feedback frequency response, Nyquist sta-
bility, dominant pole compensation, compensation networks

xi
Contents
Preface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xv
9
Active Filters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 649
9.1
Bode Plots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 650
9.1.1 Bode Plots of the Factors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 652
9.2
Filter Characteristics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 667
9.3
Butterworth Filters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 670
9.3.1 Alternate Deﬁnitions: . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 674
9.3.2 High-pass Butterworth Characterization: . . . . . . . . . . . . . . . . . . . . . . . 675
9.4
OpAmp Realizations of Butterworth Filters . . . . . . . . . . . . . . . . . . . . . . . . . . . 676
9.4.1 Low-pass OpAmp Filters: . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 677
9.4.2 High-pass OpAmp Filters: . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 682
9.4.3 Band-pass and Band-stop OpAmp Filters . . . . . . . . . . . . . . . . . . . . . . . 685
9.5
Resonant Band-pass Filters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 689
9.5.1 RLC Realization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 691
9.5.2 RC Realization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 692
9.5.3 Resonant Bandstop Filters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 695
9.6
Chebyshev Filters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 697
9.6.1 OpAmp Realization of Chebyshev Filters . . . . . . . . . . . . . . . . . . . . . . . 707
9.7
Comparison of Filter Types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 714
9.8
Switched-Capacitor Filters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 715
9.8.1 MOS Switch . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 715
9.8.2 Simple Integrator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 719
9.8.3 Gain Stage . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 720
9.8.4 Low-Pass Filters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 722
9.9
OpAmp Limitations. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 722
9.9.1 Frequency Response of OpAmps . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 724
9.9.2 OpAmp Slew Rate . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 726
9.10
Concluding Remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 728
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 741

xii
10
Frequency Response of Transistor Ampliﬁers . . . . . . . . . . . . . . . . . . . . . . . . . . 743
10.1
Frequency Distortion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 744
10.1.1 Gain and Phase Response . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 745
10.1.2 Step and Pulse Response . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 746
10.2
Dominant Poles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 753
10.2.1 Low CutoﬀFrequency (High Pass) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 753
10.2.2 Low-Pass Response . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 755
10.3
Eﬀect of Bias and Coupling Capacitors on Low-frequency Response . . . . . . . 757
10.3.1 BJT Low-Frequency Response . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 757
10.3.2 FET Low-Frequency Response . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 766
10.4
High-Frequency Models of the BJT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 768
10.4.1 Modeling a p-n Junction Diode at High Frequencies . . . . . . . . . . . . . . 770
10.4.2 Modeling the BJT at High Frequencies in the Forward-Active Region 772
10.5
Miller’s eorem. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 775
10.6
High-Frequency Response of Simple BJT Ampliﬁers . . . . . . . . . . . . . . . . . . . 778
10.6.1 Common-Emitter Ampliﬁer High-Frequency Characteristics . . . . . . . 779
10.6.2 Exact Common-emitter High-frequency Characteristics . . . . . . . . . . . 782
10.6.3 Common-Collector Ampliﬁer High-Frequency Characteristics . . . . . . 786
10.6.4 Common-Base Ampliﬁer High-Frequency Characteristics. . . . . . . . . . 789
10.6.5 Common-Emitter with Emitter Degeneration (CE C Re)
Characteristics. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 791
10.7
High-Frequency Models of the FET. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 795
10.7.1 Dynamic Models for the FET . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 795
10.8
High-Frequency Response of Simple FET Ampliﬁers . . . . . . . . . . . . . . . . . . . 800
10.8.1 Common-source Ampliﬁer High-Frequency Characteristics . . . . . . . . 800
10.8.2 Exact Common-Source High-Frequency Characteristics . . . . . . . . . . . 802
10.8.3 Common-Drain High-Frequency Characteristics . . . . . . . . . . . . . . . . . 803
10.8.4 Common-Gate High-Frequency Characteristics . . . . . . . . . . . . . . . . . . 804
10.8.5 Common-Source with Source Degeneration (CS C Rs)
Characteristics. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 806
10.9
Multistage Ampliﬁers. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 810
10.9.1 Capacitor Coupling between Stages . . . . . . . . . . . . . . . . . . . . . . . . . . . . 811
10.9.2 DC (Direct) Coupling between Stages. . . . . . . . . . . . . . . . . . . . . . . . . . 816
10.9.3 Darlington Pair . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 818
10.9.4 Cascode Ampliﬁer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 820
10.10 Concluding Remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 822

xiii
10.11 Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 831
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 851
11
Feedback Ampliﬁer Frequency Response . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 853
11.1
e Eﬀect of Feedback on Ampliﬁer Bandwidth (Single-Pole Case) . . . . . . . . 854
11.2
Double Pole Feedback Frequency Response . . . . . . . . . . . . . . . . . . . . . . . . . . . 857
11.2.1 Frequency Response . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 859
11.2.2 Step Response . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 866
11.3
Multipole Feedback Frequency Response . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 869
11.4
Stability in Feedback Circuits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 873
11.4.1 Gain and Phase Margins. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 874
11.4.2 Nyquist Stability Criterion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 879
11.5
Compensation Networks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 883
11.5.1 Dominant Pole (Lag) Compensation . . . . . . . . . . . . . . . . . . . . . . . . . . . 884
11.5.2 Lag-Lead (Pole-Zero) Compensation . . . . . . . . . . . . . . . . . . . . . . . . . . 889
11.5.3 Lead Compensation (Equalizer) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 894
11.5.4 Phantom Zero Compensation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 898
11.6
Concluding Remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 899
11.7
Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 903
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 921
Authors’ Biographies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 923


xv
Preface
In the previous two books of this series, all electronic circuit operation was considered to be
either at near-zero frequency or in the “midband” region of operation. e midband range of
frequencies, vitally important to ampliﬁer discussions, is characterized by two basic simplifying
assumptions:
• e midband frequencies are large enough so that discrete circuit capacitors appear to have
negligible impedance with respect to the resistances in the circuit, and
• e midband frequencies are small enough so that the active elements (transistors,
OpAmps, etc.) appear to have frequency-invariant properties.
It is the purpose of this book to explore the variation of circuit behavior over the entire range
of frequencies. In addition to exploring frequency dependence, the time domain equivalence of
these eﬀects is explored.
A review of the characteristics of ideal ﬁlters and frequency response plots leads into the
design of active ﬁlters. Active Butterworth and Chebyshev ﬁlter design is discussed in this section
using OpAmps as the active circuit elements. Discussion of passive ﬁlters and ﬁlters with other
active elements is saved until the chapter in Book 4 on communication circuits. e frequency
response limitations of OpAmps provide an introduction to limitations common in other devices.
Transistor ampliﬁer frequency response is ﬁrst discussed through the eﬀects of coupling
and bypass capacitors. Once those principles are mastered, modiﬁed models for the diode, BJT
and FET are introduced to model the high-frequency limitations of common devices and the
result of these limitations on the frequency response of ampliﬁer circuits. e eﬀect of feedback
on frequency response is initially presented as a special case of stabilization: here stabilization
against variation in element value change due to frequency. Feedback eﬀects on pole migration is
emphasized. Compensation against possible instabilities or oscillations is explored extensively.
In this book, ampliﬁer oscillations are considered an undesirable condition. In the next
book of this series, these instabilities are explored in the design of linear oscillators.
omas F. Schubert, Jr. and Ernest M. Kim
March 2016


649
C H A P T E R
9
Active Filters
An electronic ﬁlter is deﬁned as a device that separates, passes, or suppresses an electronic signal
(or group of signals) from a mixture of signals. Most common among all possible ﬁlters are those
that separate signals according to the signal frequency content. is type of ﬁlter is found in
virtually every common electronic device. As an example, consider a radio receiver. e antenna
system for a radio receiving system receives a wide range of frequencies associated with many
distinct radio stations. A radio receiver attached to that antenna system can be tuned to receive
any particular station: its input ﬁlter section passes only those frequencies associated with that
station and blocks all other frequencies. Of interest in this chapter are the characterization and
design of such frequency-selective ﬁlters
Electronic frequency-selective ﬁlters are divided into two major groups based on the cir-
cuit elements making up the ﬁlter: passive ﬁlters and active ﬁlters. Passive electronic ﬁlters are
commonly constructed using the basic passive building blocks familiar to all electrical engineers:
resistors, capacitors, and inductors. ese ﬁlters are of great value particularly in high power and
high frequency applications.¹ In low frequency applications, the high-value inductances required
in passive ﬁlter designs present several problems. Large value inductors are physically large, heavy,
non-linear, and usually have a relatively large loss factor. In addition, the magnetic ﬁelds they gen-
erate are a source of electromagnetic interference. In many designs one or more of these features
is undesirable. It is therefore often necessary to design ﬁlters that contain only resistors and ca-
pacitors. e addition of another common building block, the operational ampliﬁer, allows for
the design of these lower frequency ﬁlters as eﬃcient and cost eﬀective devices. e inclusion of
an active device in the design has led to calling these ﬁlters, “active ﬁlters.”
e approach to active ﬁlter design and characterization developed in this chapter begins
with a review of frequency response characterization in the form of Bode plots. is form of
graphical representation of ﬁlter response leads to a presentation of the four basic ideal types
of frequency-selective ﬁlters: high-pass, low-pass, bandpass, and bandstop. Since ideal ﬁlter re-
sponse is not achievable in the real world, several common, realistic ﬁlter response approximations
are discussed and compared. e design process necessary to realize the four basic ﬁlter types using
OpAmps, resistors, and capacitors is developed and explored.
Resistor size, weight, and power dissipation can also present problems to the ﬁlter designer.
In integrated circuits, one low-frequency solution to the problem is switched-capacitor ﬁlters.
¹A discussion of the uses of passive ﬁlters in communication circuits can be found in Chapter 15 (Book 4). Of particular interest
is the discussion of tradeoﬀs between active and passive ﬁlters.

650
9. ACTIVE FILTERS
ese ﬁlters are closely related to standard active ﬁlters where the resistors are replaced by rapidly
switched capacitors. A discussion of this variation of active ﬁlters is found in Section 9.7.
Although OpAmps are highly useful electronic building blocks, they do have limitations.
Most signiﬁcant in ﬁlter design is the degradation in the voltage gain with frequency. e chapter
ends with a discussion of the limitations of active ﬁlters designed with the use of OpAmps.
9.1
BODE PLOTS
Characterization of electronic systems in the frequency domain is directly related to time-domain
system response. e response of a linear time-invariant system, xo.t/, to an arbitrary input, xi.t/,
can be characterized, in the time-domain, by its impulse response, h.t/:
xo.t/ D
Z t
0
h.t   /xi./ d:
(9.1)
While the convolution integral of Equation (9.1) has great utility in many situations,² a frequency-
domain characterization of the system is more typical. e frequency-domain response of a system
can be obtained by taking the Fourier Transform of the output quantity, xo.t/:
Xo.!/ D Ffxo.t/g D
Z 1
 1
xo.t/e j!t dt
(9.2)
which reduces to
Xo.!/ D H.!/Xi.!/:
(9.3)
e spectrum of the output quantity, Xo.!/, is the product of the input quantity spectrum, Xi.!/,
and the transfer function of the system, H.!/. e impulse response and the transfer function of
a system are related by the Fourier Transform:
H.!/ D Ffh.t/g:
(9.4)
is frequency-domain transfer function is most typically characterized by its fundamental parts
in polar form:
• jH.!/j—the magnitude response, and
• †H.!/—the phase response.
One of the most useful representations of these two quantities is a pair of plots. e typical
format for these plots is the magnitude (on either a linear or a decibel scale) or the phase (in either
degrees or radians) as the ordinate and frequency (on a logarithmic scale) as the abscissa. While
²Time-domain characteristics of electronic circuits and the relationship of these characteristics to the frequency-domain char-
acteristics are discussed in Chapters 10 and 11 in Book 3 and Chapters 12 and 13 in Book 4.

9.1. BODE PLOTS
651
many computer simulation programs exist for the eﬃcient creation of such plots, much insight
into the functioning of a ﬁlter (or any electronic circuit) and the dependence of the responses to
circuit parameter variation can be gained by the manual creation of simple straight-line approxi-
mations to these magnitude and phase plots. Plots of the magnitude of the transfer function, in
decibels, and the phase of the transfer function are called Bode plots.³ e two plots together form
a Bode diagram.
Mathematical Derivations
e response of a linear system to sinusoidal inputs can be described as the ratio of two polyno-
mials in frequency, !:
H.!/ D Ko
Zm.!/
Pn.!/ :
(9.5)
Here Zm.!/ is an mth order polynomial whose roots identify the m zeroes of the response. e
roots of Pn.!/ identify the n poles. For all real electronic systems, the response must not increase
as frequency becomes inﬁnite; thus the number of poles must be equal to or larger than the number
of zeroes, n  m. Equation (9.5) can be expanded to be of the form:
H.!/ D Ko
1 C .j!/a1 C .j!/2a2 C : : : C .j!/mam
1 C .j!/b1 C .j!/2b2 C : : : C .j!/nbn
:
(9.6)
e numerator and denominator polynomials, Zm.!/ and Pn.!/ respectively, can each be written
as a factored product of multiples of four types of simple function, hereafter identiﬁed as factors,
fF.!/g:
1. Ko
— a constant
2. j!
— a root at the origin
3. 1 C j!
!o
— a simple root at ! D !o
4. 1 C 2 j!
!o C

j!
!o
2
— a complex conjugate root pair.
Each of these four simple functions has a straight-line approximate Bode representation.
e use of decibels (a logarithmic function) as a vertical scale for the magnitude plot and a linear
scale for phase converts the product of the factors into the sum of the factor magnitudes (in dB)
and the sum of the factor phases: division becomes subtraction. erefore the total system response
plot becomes the algebraic sum of the plots of the individual simple factors describing the system.
³Named for Hendrik Wade Bode (1905–1982). One early reference is his book Network Analysis and Feedback Design, Van
Nostrand, New York, 1945.

652
9. ACTIVE FILTERS
9.1.1
BODE PLOTS OF THE FACTORS
e Bode magnitude straight-line representation of each of the four simple factors is unique. e
Bode phase straight-line representation is unique for two of the factors (a constant and a root at
the origin) and universally standardized for a third (a simple root). However, a variety of approx-
imate representations for the phase of a complex conjugate root pair exists in the literature. e
representation for a constant and for a root at the origin is exact: the other two factor representa-
tions are asymptotic in the case of magnitude and approximate in the case of phase. A discussion
of each Bode representation follows. A summary can be found in Table 9.1.
A constant:
e most simple of the factors is a constant.
FC.!/ D K:
(9.7)
Here the magnitude is constant at 20 log jKj. e phase plot is also constant at  D 0ı or  D 180ı
depending on the mathematical sign of K. Each plot is an exact representation of the factor.
A pole or zero at zero frequency:
A pole or zero at the origin also has a simple Bode representation. e factor is of the form:
F0.!/ D j!:
(9.8)
e magnitude plot is a straight line on a logarithmic frequency scale:
jF0.!/jdB D 20 log jj!j D 20 log.!/:
(9.9)
If the factor is in the numerator (indicating a zero), this straight line has a slope of
C20 dB/decade:⁴ denominator factors (poles) have a slope of  20 dB/decade. In each case the
line passes through the point {0 dB, 1 rad/s).
e factor phase is constant at  D 90ı (or  radians). Consequently, the phase plot for
zeroes will be at C90ı and at  90ı for poles.
A simple pole or zero at ! D !o:
Single poles and zeroes not at the origin have more complex plots. e factor form for a simple
pole is:
F1 .!; !o/ D 1 C j!
!o
;
(9.10)
⁴A decade is a change in frequency by a factor of ten (10). A slope of 20 dB/decade is also identiﬁed in some sources as
6 dB/octave, where an octave is a frequency change by a factor of two (2).

9.1. BODE PLOTS
653
where !o is the pole (zero) frequency. e magnitude of the factor (in dB) is given by:
jF1 .!; !o/jdB D 20 log
s
1 C
 !
!o
2
D 10 log
 
1 C
 !
!o
2!
:
(9.11)
e phase is given by:
†F1 .!; !o/ D tan 1
 !
!o

:
(9.12)
ese two components of the simple factor are shown in Figure 9.1 as if the factor were in the de-
nominator (representing a pole). Also shown in the ﬁgure are the Bode straight-line approximate
plots.
e Bode plot of the magnitude is an asymptotic approximationand is made up of two
intersecting straight lines that form a piecewise continuous plot. If !  !o, F.!/  1 and the
magnitude plot is constant at 0 dB. If !  !o,
jF1 .!; !o/jdB  10 log
  !
!o
2!
D 20 log .!/   20 log .!o/ :
(9.13)
Magnitude (dB)
o
 
Phase
magnitude
phase
 
 
ω
ω
0.01
0.1
1
5
0
−5
−10
−15
−20
−25
−30
−30°
−60°
−90°
   0°
−25
−40
10
100
Figure 9.1: A simple pole Bode diagram.
e asymptote is a straight line with slope of 20 dB/decade that intersects the 0 dB line
at ! D !o. e Bode approximation transitions between the two asymptotic lines at the root
frequency where the approximation has its greatest error (20 log.2/  3:01 dB).

654
9. ACTIVE FILTERS
As can be seen in Figure 9.1, the factor phase never exceeds 90ı and essentially all phase
change takes place within ˙one decade of !o.†F1.0:1!o; !o/ D 5:71ı and †F1.10!o; !o/ D
84:29ı). Beyond one decade from the root, !o, the phase is approximated by a constant:
! < 0:1!o
— †F1.!; !o/ D 0ı
! > 10!o
— †F1.!; !o/ D 90ı:
Within ˙ decade of !o, the phase can be approximated by a straight line of slope 45ı/decade:
0:1!o < ! < 10!o
—†F.!/ D 45ıflog.10!=!o/g:
is straight-line Bode approximation has a maximum error of  5:71ı.
e error introduced by the Bode straight-line approximations has distinct symmetry about
!o (Figure 9.2). Any corrections to the plots, if necessary, are accomplished by interpolation and
comparison to standard plots. Some data points that are helpful in making accurate corrections
are:
• Magnitude plot
– e magnitude error at !o is 3.01 dB
– e magnitude error at ˙ one octave (0:5!o and 2!o) is 0.97 dB
• Phase plot
– Slope at !o is  66ı/decade
– e phase error is zero at 0:159!o; !o, and 6:31!o
– e phase error at ˙ one decade is ˙5:71ı
Complex conjugate pole or zero pairs
A complex conjugate root pair presents a more complex relationship. e appropriate form of the
factor is given by:
F2 .!; !o; / D 1 C 2 j!
!o
C
j!
!o
2
(9.14)
where !o is identiﬁed as the resonant frequency and  is the damping factor.⁵ A plot of the
magnitude and phase response for a complex pair of poles with the damping factor as a parameter
(0:2    0:9 in increments of 0.1) is shown in Figure 9.3.
e variation of the plot with damping coeﬃcient makes straight-line approximations near
the resonant frequency questionable. Still, at about a third of a decade or larger from the reso-
nant frequency, reasonable approximations of the magnitude plot can be made. Once again, if
⁵e damping factor lies in the range, 0   < 1, for complex conjugate root pairs.

9.1. BODE PLOTS
655
0.01
0.1
1
10
100
4
_
3
_
2
_
1
_
0
1
2
6
_
0
6
Normalized frequency (rad/sec)
Magnitude error (dB)
Phase error (deg)
phase
magnitude 
Figure 9.2: Bode straight-line approximation error: simple root.
ζ
ζ
ζ
ζ
dB
10
−10
−20
−30
−35
−40 0.1
1
10
−25
−16
5
−5
0
(a) Magnitude
0.1
1
10
180
160
140
120
100
80
60
40
20
0
ζ=0.6
ζ=0.8
ζ=0.2
ζ=0.4
(b) Phase
Figure 9.3: Complex conjugate pair pole frequency response.

656
9. ACTIVE FILTERS
!  !o; F.!/  1 and the approximate magnitude plot is constant at 0 dB. If !  !o,
jF2 .!; !o; /jdB  20 log
ˇˇˇˇˇ
j!
!o
2ˇˇˇˇˇ D 40 log.!/   40 log.!o/:
(9.15)
In this region the magnitude has a slope of 40 dB/decade with an intercept of the 0 dB axis at
! D !o. Near the resonant frequency, there can be a large diﬀerence between the approximate
Bode magnitude plot and the true magnitude plot. Depending on the application, corrections
to the curve may be necessary. ese corrections can usually be accomplished with the addition
of only a few data points and interpolation. Two helpful data points are the magnitude at the
resonant frequency and the magnitude of the peak in the curve (if one exists). e magnitude at
the resonant frequency is given by:
jF2 .!o; !o; /jdB D 20 log .2/ :
(9.16)
For damping coeﬃcients less than, a 1=
p
2 valley occurs in the magnitude of the factor. is valley
will occur at the maximum diﬀerence between the true magnitude plot and the Bode straight
line approximation (Figure 9.4). Interesting, this valley in the factor magnitude plot is usually
encountered with the factor in the denominator and is consequently identiﬁed in the literature as
a “peak.” If only the factor is considered, the valley (peak) occurs at a frequency somewhat lower
than the resonant frequency:
!peak D !o
p
1   22;
(9.17)
and has value,
ˇˇF2
 !peak; !o; 
ˇˇ
dB D 20 log

2
p
1   2

:
(9.18)
In cases where a complex-conjugate pair of poles cancels lower frequency zeroes so that the
asymptotic plot is a constant for frequencies higher than the resonant frequency, the peak, neces-
sarily of the same magnitude, occurs at a frequency somewhat higher than the resonant frequency:
!peak D
!o
p
1   2
2 :
(9.19)
e Bode phase plot for a complex root pair is also simpliﬁed into a three-segment, straight-
line plot. However, the damping coeﬃcient complicates the location of the transition between
segments. At frequencies much lower than the resonant frequency, the phase is near constant at
0ı: at frequencies much higher than !o, the phase is near constant at 180ı. Near !o the Bode
approximate curve is a straight line joining the other segments.
e location of the transition points between the segments of the approximate Bode phase
plot is not uniformly described in the literature: a -independent approximation and at least two
approximations that depend on the value of  are to be found. e -independent approximation

9.1. BODE PLOTS
657
6
_
_3
0
3
6
9
peaks 
 = 0.2 
 = 0.4 
 = 0.6 
 = 0.8 
o
Magnitude error   (dB) 
 
ζ
ζ
ζ
ζ
0.1
ω
o
ω
o
ω
10
Figure 9.4: Bode straight-line magnitude error: complex conjugate root pair.
chooses a transition points at ˙ one decade, while the most prevalent of the -dependent approx-
imations vary the transition points (as a fraction of a decade) linearly with damping coeﬃcient,
.
Of the -dependent approximations found in the literature, it has been shown that the
decade-fraction approximation more closely approximates the phase plot variation with damping
coeﬃcient under a variety of criteria. e decade-fraction approximation identiﬁes the transition
frequencies as lying ˙ decades from the resonant frequency. e constant phase regions are a
function of  and are described as:
! < !o10 
— †F2.!; !o; / D 0ı
! > 10!o
— †F2.!; !o; / D 180ı:
e phase between the two constant phase regions is approximated by a straight line of slope
(90=/ı/decade passing through the point !o; 90ı:
!o10  < ! < 10!o
— †F2.!; !o; / D 90ı


log
 !
!o

C 90ı
was the case in ﬁrst order factors, the error introduced by the Bode straight-line approximations
has distinct symmetry about !o. Any corrections to the plots, if necessary, are accomplished by
interpolation and comparison to standard plots. Some data points that are helpful in making
accurate corrections to the phase plot are:
• Phase plot slope at !o is  .132=/ı/decade

658
9. ACTIVE FILTERS
• e phase error goes to zero at:
• ! D !o
• ! D 10˙.0:32C0:49C0:01/.
• e magnitude of the phase error at the transition points (! D !o10˙) is:
•   15:8 C 27:2
for   0:4
• D 103   22:82   0:7 C 23:5
(all values of ).
e decade-fraction -dependent Bode phase approximation is shown in Figure 9.5 for two
values of  along with the actual phase plots. Helpful data points, as identiﬁed above, are marked
with a “C” sign.
 = 0.7 
 = 0.3 
H
da
elpful 
ata points
ζ
ζ
Figure 9.5: e decade-fraction -dependent Bode phase approximation.
e Bode approximate plots for each of the four factors are summarized in Table 9.1 as if the
factors are in the denominator. Factors in the numerator will have positive slopes and mathematical
signs but otherwise be similar in shape. Total Bode plots are the sum of the plots of the factors.
Time delay
Systems with an inherent time delay, td, will experience a ﬁfth factor: a phase shift that is linear
with frequency:
FD.!/ D e j!td :
e delay factor has a Bode magnitude plot that is constant at zero dB: the system Bode magnitude
plot is unchanged by the factor. Unfortunately the phase is linear with frequency f D  td!g and

9.1. BODE PLOTS
659
does not have a “nice” plot on a logarithmic frequency scale: each decade in frequency experiences
ten times the phase variation of the decade directly lower in frequency. Typically, any system delay
is treated separately from the Bode phase plots: in systems where the time delay is small compared
to the period of the highest frequency present, delay eﬀects are usually considered insigniﬁcant
and consequently ignored. A Bode diagram of the delay factor is shown in Figure 9.6.
Table 9.1: Bode factor magnitude and phase plots
Factor
Bode Magnitude Plot
Bode Phase Plot
K 
0 dB
-20 log  K       
0o
j  
1
0 dB
-20 dB/decade
0o
90
o
j
1
j
j
0 dB
-20 dB/decade
o
0
-45  /decade
o
o
o
o
o
90
2
o
o
1
2
0 dB
-40 dB/decade
o
0o
   decade
o
-90
10
 
o
10  
o
o
180
ω
ω
ω
ω
ω
ω
ω
ζ
ζ
ζ
ζ
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
Temporal frequency vs. angular frequency
eoretical derivations of Bode factors tend to utilize angular frequency (!: rad/s). However, in
the real world, it is likely that systems will be described using temporal frequency (f : Hz).

660
9. ACTIVE FILTERS
0.01
0.1
1
10
100
420
_
_
_
_
_
_
_
360
300
240
180
120
60
0
60
Normalized frequency
Gain (dB)
Phase (deg)
t d 
0 
phase 
gain 
ω
Figure 9.6: Time delay factor Bode diagram.
e functional form of the response, H.!/ or H.f /, is identical and conversions can be
made using ! D 2f . e only other diﬀerence appears in a diﬀerence in the constant factor FC
for a particular system. If there are simple roots at the origin .F0 D j!/, the constant terms in
H.!/ and H.f / for the system {K! and Kf respectively} will diﬀer by a factor:
Kf D .2/m nK!:
Where m   n is the number of simple roots at the origin in the numerator minus those in the
denominator.
Example 9.1
(Drawing Bode plots)
Draw the Bode diagram for the following transfer function:
H .!/ D

0:836  10 3
Œj!2

1 C j!
150
 
1 C j!
800
 "
1 C
j!
625  103 C
.j!/2
250  109
#:
Solution:
e Bode diagram consists of the Bode magnitude plot and the Bode phase plot. e given
transfer function contains all of the primary factor types:
• a constant
• two zeroes at the origin
• two simple poles

9.1. BODE PLOTS
661
• a complex conjugate pair of poles
e Bode magnitude plot for the constant is a horizontal line at:
20 log
 0:836  10 3
D  61:56 dB:
e Bode magnitude plot for the two zeroes at the origin has slope of C40 dB/decade (2 
20 dB/decade) and passes through (0 dB, 1 rad/sec). e simple poles each introduce a slope in-
crement of  20 dB/decade beginning at the pole frequencies:
!p1 D 150 rad=sec
and
!p2 D 800 rad=sec:
e complex pair of poles will introduce a slope increment of  40 dB/decade at the resonant
frequency:
!2
o D 250  109
)
!o D 500  103 rad=sec:
e pole pair damping coeﬃcient is calculated to be:
2
!o
D
1
625  103
)
 D 0:4:
e magnitude at the resonant frequency can then be (optionally) corrected by determining:
jF2 .!o; !o; 0:4/j D 2  0:4 D 0:8
)
 1:94 dB:
Since the damping coeﬃcient is less than 1=p2 and the factor cancels out lower frequency zeroes,
a peak in the magnitude response exists above the resonant frequency at:
!peak D !o
p
1   22 D 400  103.0:825/ D 329:9  103 rad=sec:
Consequently, the other optional correction point has value:
ˇˇF2
 !peak; !0; 0:4
ˇˇ D 2.0:4/
p
1   0:42 D 0:733
)
 2:70 dB:
Since the complex conjugate pair are poles, the factor lies in the denominator, the slope is
 40 dB/decade, and the signs of the magnitude corrections are reversed (making them both, in
this case, positive).
e magnitude plot is constructed as follows:
• A low-frequency starting point is found where the sum of all factors is known and below
any pole (or zero) frequencies (other than those at the origin). Here ! D 10 is a good choice
(evaluate the constant and the zeroes at the origin): jH.10/j   61:56 C 20 dB C 20 dB D
 21:56 dB.
• e slope of the plot at the above point is 20 dB/decade  (number of poles at origin), i.e.,
40 dB/decade.

662
9. ACTIVE FILTERS
• e pole and zero frequencies are located and marked: Simple poles (down) and zeroes (up)
by an arrow. Similarly, complex conjugate pairs are marked by a double arrow.
• e plot slope is incremented at the arrow frequencies by 20 dB/decade in the direction of
the arrow. Multiple arrows at the same frequency indicate a multiplicative change in slope.
• Any higher order corrections are then made (if desired).
e resultant uncorrected Bode straight-line magnitude plot, four optional correction points
(marked by “C”), and the exact magnitude plot for this system are shown in Figure 9.7.
e Bode phase plot for the constant and each of the zeroes at the origin are simple hori-
zontal lines at 0ı and 90ı respectively. Each simple pole will increment the phase by  45ı/decade
at one decade below the pole frequency and decrement the phase by the same quantity one decade
above the pole frequency. For the complex conjugate pair phase plot, the frequency range where
the phase changes must be calculated by determining the quantity:
10 D 100:4 D 2:51:
15
_
_
_
_
10
5
0
5
10
15
20
25
30
35
40
45
50
Magnitude   (dB) 
Frequency   (rad/s) 
10 
1k 
100k 
10M 
simple root ( 3 dB) 
peak (+2.79 dB) 
resonance (+1.94 dB) 
20 dB/decade slope 
increment arrows 
_
Figure 9.7: Magnitude of the frequency response for Example 9.1 with the Bode approximation over-
lay.

9.1. BODE PLOTS
663
e transition frequencies for the phase change are then determined:
!o
2:51 < ! < 2:51!o
)
199  103 < ! < 1:26  106:
Since the factor is in the denominator, the phase plot between the transition frequencies has a
slope increment of:
 90

D  225ı=decade:
e phase plot is constructed as follows:
• A low-frequency starting point is found where the sum of all factors is known and at least
one decade below any pole (or zero) frequencies (other than those at the origin): here ! D
0:1 is a good choice: †H.0:1/  0ı C 90ı C 90ı   0ı   0ı   0ı D 180ı.
• e phase plot transition frequencies are located and marked. Simple poles and zeroes by
opposing arrow pairs at one tenth and ten times the pole or zero frequency (15 & 1500;
80 & 8000): complex conjugate root pairs by opposing arrow pairs at the calculated slope
transition frequencies (199  103 & 1:26  106).
• e phase plot slope is changed at the arrow frequencies by the appropriate amount in the
direction of the arrow.
• Any higher order corrections are then made (if desired).
e system uncorrected Bode straight-line approximate phase plot and the exact phase plot
are shown in Figure 9.8. Six optional correction points (marked by “C”) are also shown. Note that
while these optional correction points improve the curve in regions where roots are far apart, in
regions where the root transition regions overlap (i.e., at 80 and 1500 rad/s), their use may not
improve the overall curve.
Example 9.2
(Drawing Bode plots—alternate method)
Draw the Bode diagram for the following transfer function:
H.!/ D
 1:25  10 3Œj!2

1 C j!
100
 
1 C j!
800
 
1 C
j!
100  103
 
1 C
j!
600  103
:
Solution:
e Bode diagram consists of the Bode magnitude plot and the Bode phase plot. e given
transfer function contains three of the primary factor types:
• a constant

664
9. ACTIVE FILTERS
180
_
_
_
_
135
90
45
0
45
90
135
180
45°
45°
45°
45°
225°
225°
slope (°/decade) 
 increment arrows  
 
simple root (± 5.7°) 
 
root pair  = 0.4 (± 20.1°) 
 
Phase  (deg) 
 
Frequency (rad/s)
10
10
100k
1M
ζ
1k
Figure 9.8: Phase of the frequency response for Example 9.1 with the Bode approximation overlay.
• two zeroes at the origin
• four simple poles
– two at low frequencies (100 and 800 rad/sec)
– two at high frequencies (100 and 600 krad/sec)
is particular form of the transfer function is quite common in electronic applications. Low-
frequency poles (in this case, two) are canceled by the same number of zeroes at the origin resulting
in a middle range of frequencies (the midband region) where the transfer function is essentially
constant, and regions of decreasing gain as frequency varies from the midband region for both
higher and lower frequencies. Similarly, the phase is relatively constant in the midband region.
In such a situation, the Bode plot can be begun in the midband region and progress outwards.
One should note that this method is not dependent on the poles being simple: the presence of
complex conjugate pole pairs does not change the method described as long as there is a midband
region of essentially constant gain or phase.
e value of the transfer function in the midband region can be determined by assuming a
midband frequency, !mid, that is conceptually much larger than the largest of the low-frequency
poles, but much smaller than the smallest of the high-frequency poles. Under that assumption,
the pole factors take on a simpler form and result in an approximate transfer function value in the

9.1. BODE PLOTS
665
midband region:
H .!mid/   1:25  10 3 Œj!mid2
j!mid
100
 j!mid
800

Œ1 Œ1
D  100:
e Bode magnitude plot for this example in the midband region becomes a horizontal line at:
20 log j   100j D 40 dB.
e magnitude plot is constructed as follows:
• e plot begins in the midband region with a horizontal line at the midband gain value:
here, 40 dB.
• e pole and zero frequencies are located and marked: Simple poles (down) and zeroes (up)
by an arrow. Similarly, complex conjugate pairs are marked by a double arrow.
• e plot slope is incremented at the arrow frequencies by 20 dB/decade in the direction of
the arrow. Multiple arrows at the same frequency indicate a multiplicative change in slope.
• Any higher order corrections are then made (if desired).
e resultant uncorrected Bode straight-line magnitude plot and the exact magnitude plot for
this system are shown below in Figure 9.9.
e Bode phase plot can be similarly constructed from the midband outward. e phase
plot is constructed as follows:
• e plot begins in the midband with a horizontal line at the midband phase value: here,
†H.!mid/  †. 100/ D ˙180ı.
Since poles introduce negative angles,  180ı is more commonly chosen.
• e phase plot transition frequencies are located and marked. Simple poles and zeroes by
opposing arrow pairs at one tenth and ten times the pole or zero frequency: complex con-
jugate root pairs by opposing arrow pairs at the calculated slope transition frequencies with
the appropriate slope increment noted.
• e phase plot slope is changed at the arrow frequencies by the appropriate amount in the
direction of the arrow.
• Any higher order corrections are then made (if desired).
e system uncorrected Bode straight-line approximate phase plot and the exact phase plot are
shown as the second plot (Figure 9.10).

666
9. ACTIVE FILTERS
15
_
_
_
10
5
0
5
10
15
20
25
30
35
40
45
Magnitude   (dB)
Frequency   (rad/s) 
10 
1k 
100k 
10M
simple root (-3 dB) 
20 dB/decade slope 
increment arrows 
40 dB midband 
Figure 9.9: Magnitude of the frequency response for Example 9.2 with the Bode approximation over-
lay.
360
_
_
_
_
_
_
_
_
315
270
225
180
135
90
45
0
45°
45°
45°
45°
slope (°/decade) 
 
 
 
Phase  (deg) 
 
Frequency  (rad/s) 
10
1k
100k
1M
45°
45°
45°
45°
midband phase 
180   
 
_
º
increment arrows
Figure 9.10: Phase of the frequency response for Example 9.2 with the Bode approximation overlay.

9.2. FILTER CHARACTERISTICS
667
9.2
FILTER CHARACTERISTICS
Filters are classiﬁed according to the function that they perform. Ideal frequency selective ﬁlters
have three fundamental design goals:
• To have no attenuation of input signals over a range of frequencies, called the passband.
• Over another, distinct range of frequencies, called the stopband, to have complete attenua-
tion of input signals.
• To have no distortion of signals whose frequency content lies within the passband.
e relative frequency location of the passband and the stopband give rise to the four most
common types of ﬁlters: low-pass, high-pass, band-pass, and band-stop. e magnitude of the
ideal frequency response characteristics of these four ﬁlter types is depicted in Figure 9.11.
An ideal low-pass transfer characteristic is shown in Figure 9.11a with the passband ex-
tending from zero frequency to a cutoﬀfrequency, ! D !c, and the stopband extending from !c
to inﬁnite frequency. e ﬁlter gain in the passband is unity and zero in the stopband. e ideal
high-pass ﬁlter of Figure 9.11b is the inverse of the low-pass ﬁlter: the stopband extends from
zero frequency to ! D !c and the passband from !c to inﬁnite frequency. A band-pass ﬁlter
(Figure 9.11c) has a single passband extending in the frequency range, !1 < ! < !2, while all
other frequencies are stopped. Band-stop ﬁlters (Figure 9.11d) have a single stopband extending
in the frequency range, !1 < ! < !2, while all other frequencies are passed. Band-stop ﬁlters are
often called band-elimination ﬁlters or notch ﬁlters.
e requirement for constant magnitude of the frequency response in the passband is a
consequence of the need to pass signals whose frequency content lies within the passband without
distortion. In order that a signal pass through a ﬁlter without distortion, the output of the ﬁlter
must be an ampliﬁed duplicate of the input signal possibly delayed by a time lag, td:⁶
xo.t/ D Koxi.t   td/:
(9.20)
e frequency domain equivalent of Equation (9.20) is obtained through the use of the Fourier
Transform:
Xo.!/ D Ffxo.t/g D
Z 1
 1
xo.t/e j!t dt:
(9.21)
Here Xo.!/ is the spectrum of xo.t/. Replacing xo.t/ by its deﬁnition (Equation (9.20)) yields
the frequency domain relationship between the input signal spectrum and the undistorted output
signal spectrum:
Xo.!/ D Koe j!td Xi.!/:
(9.22)
⁶e time lag for many low-frequency ﬁlters can be approximated as td  0. As frequencies become large, the physical size
of an electronic ﬁlter and the internal capacitance of its elements can make time lag a signiﬁcant property of the ﬁlter.

668
9. ACTIVE FILTERS
Passband
Stopband
0
0
c
1
|H(  )|
(a) Low-pass
Passband
Stopband
0
0
c
1
|H(  )|
(b) High-pass
Passband
Stopband
0
0
2
|H(  )|
(c) Band-pass
Stopband
1
1
Passband
0
0
2
|H(  )|
(d) Band-stop
Stopband
1
Passband
1
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
Figure 9.11: Filter idealized characteristics.
e transfer characteristic of the non-distorting ﬁlter, H.!/, is interpreted from Equation (9.22)
to be the multiplier of the input signal spectrum:
H.!/ D Koe j!td :
(9.23)
e properties of a non-distorting ﬁlter are apparent. It is necessary that, over the range
of frequencies contained in the input signal, the magnitude of the ﬁlter transfer function be con-
stant with respect to frequency and the phase shift induced by the ﬁlter be linear with respect to
frequency:
jH.!/j D Ko
and
†H.!/ D  !td:
(9.24)
Notice that for zero time delay, td D 0, the phase shift induced by the ﬁlter is also zero.⁷
Real ﬁlters can only approximate the ideal transfer relationships depicted in Figure 9.11.
e abrupt transition between the passband and the stopband of the various types of ideal ﬁlters
is, unfortunately, impossible to achieve with a ﬁnite number of real circuit elements. In addition,
⁷Often a constant phase shift of ˙180ı (˙ radians) is also acceptable: constant ˙180ı phase shift is a simple inversion of
the signal when passing through the ﬁlter.

9.2. FILTER CHARACTERISTICS
669
zero gain in the stopband and no variation in gain in the passband are, at best, diﬃcult to achieve.
It is necessary to relax the design goals for these ﬁlters in order to be able to design and fabricate
practical, real ﬁlters. A realistic set of practical design goals for frequency-selective ﬁlters is:
• In the passband, to have relatively small attenuation (or a gain) of input signals over a range
of frequencies. e variation in gain over the passband is speciﬁed by a maximum variation
value, max.
• Over the stopband, to have relatively large attenuation of input signals speciﬁed by a mini-
mum attenuation value, min.
• To have a transition region lying between passband and stopband speciﬁed by a passband
cutoﬀfrequency, !c and a stopband edge, !s.
• To have minimal distortion of signals whose frequency content lies within the passband.
Figure 9.12 is a graphical representation of these design goals applied to a low-pass ﬁlter. Here the
separation of the passband and the stopband by a transition band is apparent. e ration of the
frequencies that specify the transition band, !c=!s, is called the selectivity factor and indicates
the “sharpness” of the ﬁlter. e shaded areas represent tolerances in the passband and stopband
gains: one of many possible ﬁlter responses that meet the design goals is presented as an arbitrary
example.
Passband
0
0
c
|H(  )|
Stopband
band
s
max
min
transition
ω  
ω
ω
ω
γ
γ
Figure 9.12: Realistic low-pass ﬁlter design goals and one possible solution.
As the tolerances for a ﬁlter are reduced, (max reduced, min increased, and !c=!s in-
creased) the ﬁlter approaches ideal characteristics. While this goal may seem worthwhile in all
cases, reducing tolerances increases the complexity of the circuitry involved to accomplish the
more stringent design goals. Good design involves a balance between constraints and complexity.

670
9. ACTIVE FILTERS
ere are several families of ﬁlters that meet the practical design goals of realistic ﬁlters in
an eﬃcient manner. Each family meets the goals in a unique manner. Two of the families that are
common and will be discussed at length in this chapter are:
• Butterworth Filters
• Chebyshev Filters
Butterworth Filters are smooth ﬁlters. ere is no ripple in the response in either the passband
or the stopband and the transition between bands is monotonic. e edge of the passband is the
frequency at which the magnitude of the ﬁlter transfer function. jH.!/j drops by max. e edge of
the stopband occurs at the frequency at which jH.!/j drops by min below the nominal passband
gain. Chebyshev Filters have ripple in either the passband or in the stopband: once out of the
region of ripple they are monotonic. Chebyshev ﬁlters can achieve a smaller transition region as
compared to an equivalent-complexity Butterworth ﬁlter.
All real ﬁlters introduce some phase shift. In good ﬁlters this shift is reasonably linear with
frequency throughout most of the passband: it can be interpreted as a time delay between the input
and the output. As the order of the ﬁlter increases, the delay typically increases as well. Near the
junction between the passband and the transition region the phase shifts become increasingly
non-linear: frequencies near the edge of the passband suﬀer from phase distortion, as well as
magnitude distortion. Discussion of ﬁlter design criteria in the following sections will be based
primarily on the magnitude of the ﬁlter frequency response.
9.3
BUTTERWORTH FILTERS
Butterworth ﬁlters, often called maximally ﬂat ﬁlters, are arguably the most common type of
electronic ﬁlter. ey meet the realistic goals of ﬁlters presented in the last section in a unique
manner: they are smooth ﬁlters that transition monotonically from the passband to the stop band.
e polynomials that characterize the Butterworth response are functions of only two parameters:
the order of the ﬁlter, n, and the 3 dB frequency, !o. e response of an nth order low-pass But-
terworth ﬁlter is an all-pole response characterized by the nth Butterworth polynomial, Bn.!/:
AV .!/ D
AV 0
Bn.!/:
(9.25)
e magnitude of the nth Butterworth polynomial applied to low-pass ﬁlters is given by:
jBn.!/j D
s
1 C
 !
!o
2n
:
(9.26)
ere are several interesting properties of the Butterworth polynomials. At ! D !o the magnitude
of every Butterworth polynomial is:
jBn .!o/j D
p
1 C .1/2n D
p
2:
(9.27)

9.3. BUTTERWORTH FILTERS
671
us, !o is the frequency at which the output signal of the ﬁlter (a voltage or current) is reduced
by a factor of p2 or, equivalently, the output power is reduced to one-half its passband value. e
half-power frequency, here !o, is also commonly called the 3 dB frequency:
20 log
p
2

D 3:01030 dB  3 dB:
(9.28)
Since all Butterworth ﬁlters have a response that is reduced by 3 dB at the resonant frequency, it
is often common to specify Butterworth ﬁlters with max D 3 dB.
e slope of the ﬁlter magnitude response at ! D 0 is zero, and at high frequencies,
! >> !o, is  20n dB/decade. us, the order of the ﬁlter will determine the magnitude of the
response in the stopband. e magnitude frequency response plot for the ﬁrst six orders of Butter-
worth low-pass ﬁlter is presented in Figure 9.13. Butterworth polynomials are generated in order
to achieve a smooth ﬁlter. In Section 9.1 it was demonstrated that the response of a system is
determined only by the roots of the transfer characteristic equation. For a Butterworth ﬁlter, the
roots of an nth order polynomial are chosen so that the ﬁrst 2n   1 derivatives of the magnitude
of the response are zero at ! D 0. ese roots can easily be derived to be:
rk;n D !oe
h
j.2kCn 1/
2n
i
;
k D 1; 2; : : : ; n;
(9.29)
where rk;n is the kth root of the nth order Butterworth polynomial.
0.1
1
10 
ω
0
5
−5
−15
−10
−20
−25
−30
−40
−35
−45
n = 6
n = 5
n = 3
n = 2
n = 1
n = 4
Figure 9.13: Butterworth ﬁlter frequency response.
e Butterworth polynomial roots lie in the complex plane on a circle of radius, !o, and are
separated by an angle of by =n. Odd order Butterworth polynomials have one real root at  !o
and .n   1/=2 complex conjugate pairs. Even order polynomials have n=2 complex conjugate pairs

672
9. ACTIVE FILTERS
and no real roots. the location of the roots of the ﬁfth and sixth Butterworth polynomials is shown
in Figure 9.14.
 
ωo
n = 5
n = 6
ωo
Figure 9.14: Butterworth polynomial pole locations.
A Butterworth polynomial can therefore be characterized by !o and the damping coef-
ﬁcient associated with each of the complex conjugate pairs. ese damping coeﬃcients can be
calculated simply as:
i;n D
ˇˇˇˇcos
.2i C n   1/
2n
ˇˇˇˇ ;
i D 1; 2; : : : ; n=2
(9.30)
where i;n is the ith damping coeﬃcient of the nth order Butterworth polynomial. While com-
putation of the damping coeﬃcients is quite simple, repetitive use of the same quantities makes
a table of the ﬁrst several order coeﬃcients useful: the damping coeﬃcients for the ﬁrst eleven
Butterworth polynomials are listed in Table 9.2. It is important to remember that odd order But-
terworth polynomials also have a real root.
Example 9.3
A low-pass Butterworth ﬁlter is to be designed to meet the following design criteria:
Passband
nominal gain; AVo D 1
max D 3 dB at frequency, f3 dB D 3 kHz
Stopband
fs D 20 kHz
min D 40 dB minimum:

9.3. BUTTERWORTH FILTERS
673
Table 9.2: Butterworth ﬁlter damping coeﬃcients
Filter 
Order 
Damping Coefficients, 
1 
 
 
 
 
 
2 
0.7071 
 
 
 
 
3 
0.5000 
 
 
 
 
4 
0.3827 
0.9239 
 
 
 
5 
0.3090 
0.8090 
 
 
 
6 
0.2588 
0.7071 
0.9660 
 
 
7 
0.2225 
0.6235 
0.9010 
 
 
8 
0.1951 
0.5556 
0.8315 
0.9808 
 
9 
0.1736 
0.5000 
0.7660 
0.9397 
 
10 
0.1564 
0.4540 
0.7071 
0.8910 
0.9877 
11 
0.1423 
0.4154 
0.6549 
0.8413 
0.9595 
ζ
Determine the order of ﬁlter necessary to achieve the design goals and the ﬁlter transfer function,
H.!/.
Solution:
e resonant frequency of the ﬁlter response is
!o D 2f3dB D 18:85  103:
e order of the ﬁlter can be determined with Equation (9.26):
jBn .!/j D
s
1 C
 !
!o
2n
)
10. 40
20/ D
s
1 C
2fs
2fo
2n
:
Which can be rearranged to solve for n:
n D
log

10
40
10   1

2 log
fs
fo

D 2:427:
Since fractional order ﬁlters are not realistic, a third-order ﬁlter is necessary to accomplish the
design goals. A third-order ﬁlter is characterized by a real pole and a single complex conjugate
pair with damping coeﬃcient (from Table 9.2),  D 0:5.
e ﬁlter transfer function is given by (!o D 18:85  103):

674
9. ACTIVE FILTERS
H .!/ D
1

1 C j!
!o
  
1 C j!
!o
C
j!
!o
2!:
9.3.1
ALTERNATE DEFINITIONS:
e deﬁnition of the Butterworth polynomials as given in Equation (9.26) is extremely useful for
the particular (and common) case where the edge of the passband is deﬁned by the 3 dB frequency.
ere are, however many cases where the edge of the passband must be deﬁned by a variation in
the gain, max. In those situations a slight variation in deﬁnition is necessary. e Butterworth
polynomials can be deﬁned with a third degree of freedom:
jBn.!/j D
s
1 C "2
 !
!c
2n
:
(9.31)
Here !c is the edge frequency of the passband. At ! D !c, the magnitude of all Butterworth
polynomials is:
jBn.!/j D max D
p
1 C "2:
(9.32)
Notice that " D 1 relates to the standard deﬁnition of Butterworth polynomials given previously.
e order of the ﬁlter is determined from Equation (9.31) using the attenuation necessary in the
stopband. Once n and " are known the resonant frequency of the ﬁlter can be determined:
!o D !c
np":
(9.33)
Example 9.4
A low-pass Butterworth ﬁlter is to be designed to meet the following design criteria:
Passband
nominal gain, AVo D 1
passband edge, fc D 3 kHz
max D 1 dB maximum
Stopband
fs D 15 kHz
min D 40 dB minimum
Determine the Butterworth design parameters.

9.3. BUTTERWORTH FILTERS
675
Solution:
A 1 dB variation in gain in the passband sets the value of " (Equation (9.32)):
p
1 C "2 D 10
1
20
)
" D 0:50885:
e order of the ﬁlter can now be obtained by solving Equation (9.31):
jBn .!/j D
s
1 C "2
 !
!c
2n
)
10
40
20 D
s
1 C 0:508852
2fs
2fc
2n
:
is has a solution n D 3:28: a fourth-order ﬁlter is necessary.
e resonant frequency of the ﬁlter is given by Equation (9.33):
!o D !c
np" D 2 .3000/
4p
0:50885
D 22:318  103 rad/s
fo D 3:552 kHz:
e design goals of this ﬁlter can be met by a fourth-order Butterworth ﬁlter with resonant fre-
quency 3.552 kHz. e fourth-order Butterworth polynomial has two pairs of complex conjugate
poles with damping coeﬃcients 0.3827 and 0.9329.
9.3.2
HIGH-PASS BUTTERWORTH CHARACTERIZATION:
High-pass Butterworth ﬁlters are characterized by Butterworth polynomials with the quantities
! and !o interchanged. is interchange has the eﬀect of adding two zero-frequency zeroes to
the transfer function. e magnitude of the Butterworth polynomials applied to high-pass ﬁlters
is given by:
jBn .!/j D
r
1 C
!o
!
2n
D
r
1 C "2
!c
!
2n
:
(9.34)
With the interchange of variable, all design processes are similar. e only exception is in the
determination of the resonant frequency when the passband edge frequency is used. e highpass
relationship is:
!o D
np" !c:
(9.35)
Example 9.5
A high-pass Butterworth ﬁlter is to be designed to meet the following design criteria:
Passband
nominal gain, AVo D 1
passband edge, fc D 3 kHz
max D 0:5 dB

676
9. ACTIVE FILTERS
Stopband
fs D 1 kHz
min D 50 dB minimum:
Determine the Butterworth design parameters.
Solution:
A 0.5 dB variation in gain in the passband sets the value of " (Equation (9.32)):
p
1 C "2 D 10
0:5
20
)
" D 0:3493:
e order of the ﬁlter can now be obtained by solving Equation (9.34) modiﬁed to allow
for " ¤ 1:
jBn .!/j D
r
1 C "2
!c
!
2n
)
10
50
20 D
s
1 C 0:34932
2 fc
2fs
2n
:
is has a solution n D 6:197: a seventh-order ﬁlter is necessary.
e resonant frequency of the ﬁlter is given by Equation (9.35):
!o D
np"
!c D
7p
0:3493 .2 .3000// D 16:220  103 rad/s
fo D 2:581 kHz:
e design goals of this ﬁlter can be met by a seventh-order Butterworth ﬁlter with resonant
frequency 2.581 kHz. e seventh-order Butterworth polynomial has one real pole and three
pairs of complex conjugate poles with damping coeﬃcients 0.2225, 0.6235 and 0.9010.
9.4
OPAMP REALIZATIONS OF BUTTERWORTH FILTERS
One of the major problems in designing passive high-order ﬁlters is the interaction of cascaded
ﬁlter stages. Each passive stage presents a load to preceding and following stages that can vary
the design parameters of the ﬁlter. While this is not an insurmountable problem, elimination of
stage interaction can make the design process signiﬁcantly more simple. While limited to the
maximum range of frequencies at which they can operate, OpAmp circuits provide the required
isolation of stages in many electronic applications.
Individual OpAmp circuits can be placed in cascade without interaction of the individual
stages: each stage does not typically present a gain-changing load to either preceding or following
stages. us, the voltage transfer function of a cascade connection of several OpAmp stages is the
product of the individual transfer functions. Mathematically one can represent the total voltage
transfer function, AV T .!/, of a series of N individual stages in terms of the gain of the individual
stages:
AV T .!/ D
N
Y
iD1
AV i .!/:
(9.36)

9.4. OPAMP REALIZATIONS OF BUTTERWORTH FILTERS
677
e voltage transfer relationship represented by Equation (9.36) is particularly useful when using
OpAmp circuits to realize the transfer function of a ﬁlter. As with the Butterworth polynomials,
ﬁlter transfer functions are speciﬁed as a product of ﬁrst and second order polynomials in (j!). If
simple OpAmp circuits are constructed to have the transfer characteristic of these ﬁrst and second
order polynomials, then a high-order ﬁlter can be realized with a cascade of the simple OpAmp
circuits. e OpAmp circuits must meet the following design criteria:
• e resonant frequency, !o, must be variable in both ﬁrst and second order stages.
• e damping coeﬃcient, , of second order stages must be variable.
In the case of Butterworth low-pass and high-pass ﬁlters, !o is the 3 dB frequency and 
is the damping coeﬃcient (tabulated in Table 9.2). Fortunately circuits that meet these design
criteria are readily available to provide all types of frequency selective ﬁlters. e speciﬁcs of each
type are suﬃciently diﬀerent so that discussion of low-pass, high-pass, band-pass, and band-stop
ﬁlters must be separated.
9.4.1
LOW-PASS OPAMP FILTERS:
Figure 9.15 presents the schematic representation of two stages with appropriate ﬁrst and second
order low-pass voltage transfer relationships.
ov
_
+
1
R
1
C
R
R’
iv
(a) First order low-pass
ov
_
+
1
R
2
R
1
C
2
C
R
R’
iv
bv
(b) Second order low-pass
Figure 9.15: Low-pass section realizations.
First order low-pass stage
e response of the ﬁrst order OpAmp ﬁlter stage (Figure 9.15a) is obtained by noting that the
circuit is a non-inverting ampliﬁer in series with a low-pass passive RC ﬁlter. e transfer char-

678
9. ACTIVE FILTERS
acteristic is therefore given by:
vo
vi
D
1 C R0=R
1 C j!R1C1
:
(9.37)
is circuit meets the design goal of adjustable resonant frequency. e resonant frequency, !o,
of this circuit is determined by the input RC time constant:
!o D
1
R1C1
:
(9.38)
In addition the low-frequency gain of the circuit is adjustable through the elements R0 and R:
AVo D 1 C R0
R :
(9.39)
Second order low-pass stage
e second order stage (Figure 9.15b) was developed by R. P. Sallen and E. L. Key and is therefore
known as the Sallen and Key circuit. It includes, as its core element, a ﬁrst order stage whose
transfer characteristic has been derived to be:
vo
vb
D
1 C R0=R
1 C j!R1C1
:
(9.40)
e additional elements present necessitate an additional relationship so that the total transfer
characteristic can be determined. If the currents are summed at the node identiﬁed with vb the
resultant equation is:
vi   vb
R2
C .v0   vb/ .j!C2/  vb
R1 C 1=j!C1
D 0:
(9.41)
Equations 9.40 and 9.41 are combined to determine the transfer characteristic:
vo
vi
D
1 C R0=R
1 C j! Œ.R1 C R2/ C1   .R0=R/ R2C2 C .j!/2 .R1R2C1C2/
:
(9.42)
is relationship is immediately recognizable as a second order low-pass characteristic with the
following parameters:
AVo D 1 C R0=R;
(9.43)
!o D
1
pR1R2C1C2
:
(9.44)
2
!o
D .R1 C R2/ C1   R0=R

R2C2:
(9.45)
is is the best of all possible worlds: there are only three constraints on the design and ﬁve
quantities to vary. While an inﬁnite variety of possible solutions for any speciﬁc design exists,
there are two speciﬁc cases that are of particular interest and which commonly occur in electronic
design. ese cases are characterized by (a) a need for unity gain in the passband or (b) uniform
time constants in the ﬁlter section.

9.4. OPAMP REALIZATIONS OF BUTTERWORTH FILTERS
679
Unity gain designs:
Often it is important that a ﬁlter have unity gain in the passband. is restriction leads to the
following constraints:
AVo D 1
)
R0=R D 0:
(9.46)
In order to achieve the gain requirements, a short circuit is connected between the output and
the inverting input of the OpAmp and resistor R is omitted (R D 1). e transfer relationship
reduces to:
vo
vi
D
1
1 C j! Œ.R1 C R2/ C1 C .j!/2 .R1R2C1C2/
:
(9.47)
e pertinent design parameters are then:
!o D
1
pR1R2C1C2
;
(9.48)
and
2
!o
D .R1 C R2/ C1:
(9.49)
Example 9.6
Design a fourth-order Butterworth low-pass ﬁlter with unity gain in the passband that has a 3 dB
frequency at 1 kHz.
Solution:
A fourth order ﬁlter is constructed from two second-order stages. Each stage will have its
resonant frequency at:
!o D 2f3 dB D 6:2832 krad/s:
e damping coeﬃcients of the two Butterworth stages are obtained from the fourth-order row
of Table 9.2:
1 D 0:3827
2 D 0:9239:
While there appears to only be two constraints on the values chosen for the elements, realis-
tic solutions are of vital importance. Resistance values must be large with respect to the output
resistance of the OpAmp and small with respect to OpAmp input resistance. Limited commer-
cial capacitor availability suggests that they be chosen ﬁrst. A directed approach usually produces
appropriate results, but iteration may be necessary.
For the stage with 1 D 0:3827
In working with the constraints of Equations (9.48) and (9.49), a good to start is the balance
between C1 and the sum of R1 and R2:

680
9. ACTIVE FILTERS
Choose C1 D 0:010 F
e two constraint equations become;
R1 C R2 D 12:182 k
and
R1R2C2 D 2:5330:
Here the resultant sum of resistor values is such that the resistors will probably fall into the ac-
ceptable range. Attention must now be placed on C2. Whenever the sum and the product of two
variables are known, real, non-zero solutions exist only if:
R1R2 < .R1 C R2/2
4
:
C2 is chosen so that criterion is met reasonably.
Choose C2 D 0:082 F
)
R1R2 D 30:89  106.
is choice leads to the resistor values:⁸
R1 D 8:5824 k  8:56 k
R2 D 3:5993 k  3:61 k:
For the stage with 1 D 0:9239, the same process is followed. In order to reduce complexity, it is
convenient to try the same capacitor values:
Choose C1 D 0:010 F
)
R1 C R2 D 29:409 k
and
R1R2C2 D 2:5330.
Choose C2 D 0:082 F
)
R1R2 D 30:89  106.
ose value choices lead to the resistor values:
R1 D 1:091 k  1:09 k
R2 D 28:318 k  28:4 k:
e completed design takes the ﬁnal form shown below. While it is necessary to place these stages
in cascade, the order of the stages is not signiﬁcant.
ov
_
+
iv
_
+
3.61 kΩ
8.56 kΩ
28.4 kΩ
1.09 kΩ
0.082 µF
0.082 µF
0.01 µF
0.01 µF
⁸Resistor values are rounded to standard values.

9.4. OPAMP REALIZATIONS OF BUTTERWORTH FILTERS
681
Uniform time constant designs:
Another interesting special case in when the value of the low-frequency gain is not signiﬁcant. It
that case, it is convenient to set the capacitors and associated resistors to speciﬁc values:
C1 D C2 D Cc
R1 D R2 D Rc:
(9.50)
e pertinent ﬁlter parameters are then reduced to:
!o D
1
RcCc
(9.51)
and
2 D 2   R0=R:
(9.52)
is speciﬁc choice of resistor and capacitor values separates the two main parameters of the ﬁlter
stage. e resonant frequency, !o, is controlled only by Rc and Cc: the damping coeﬃcient is
controlled only by the gain of the individual stage.
Example 9.7
Design a ﬁfth-order Butterworth low-pass ﬁlter with a 3 dB frequency at 1 kHz.
Solution:
A ﬁfth-order ﬁlter is comprised of a single ﬁrst-order stage and two second-order stages.
e lack of a requirement on the passband gain suggests a uniform time constant ﬁlter would be
appropriate. Table 9.2 yields the two damping coeﬃcients necessary for a ﬁfth-order ﬁlter:
1 D 0:3090
2 D 0:8090:
e ﬁlter resonant frequency is set to the 3 dB frequency:
!o D 2f3 dB D 6:2832 krad=s:
Any reasonable pair of resistor and capacitor values that satisfy Equation (9.51) are appropriate.
One pair that utilizes standard value components is:
Rc D 5:9 k
Cc D 0:027 F:
e gain, as established by the ratio of resistors R and R0, of each second-order stage is obtained
from Equation (9.52):
R0=R D 2   2 D 1:382
and
0:382:
If R is set to 10 k in each stage, the two values for R0 are (standard values):
R0  13:8 k
and
3:83 k:
e gain of the ﬁrst-order stage is not signiﬁcant to the performance of the ﬁlter as speciﬁed. A
gain of two allows the use of identical resistors for R and R0. e ﬁnal design of the speciﬁed
low-pass ﬁlter is shown in schematic form below:

682
9. ACTIVE FILTERS
ov
_
+
iv
_
+
_
+
5.9 kΩ
5.9 kΩ
5.9 kΩ
5.9 kΩ
10 kΩ
3.83 kΩ
10 kΩ
10 kΩ
10 kΩ
13.83 kΩ
5.9 kΩ
0.027 µF
0.027 µF
0.027 µF
0.027 µF
0.027 µF
9.4.2
HIGH-PASS OPAMP FILTERS:
e two low-pass circuits of Figure 9.15 can be converted into high-pass ﬁlter sections simply by
interchanging the position of the numbered capacitors with the numbered resistors. Interchanging
these elements retains the same number of transfer function poles and adds zero-frequency zeroes.
Figure 9.16 presents the schematic representation of these two high-pass stages.
ov
_
+
1
R
1
C
R
R’
iv
(a) First order high-pass
ov
_
+
1
R
2
C
R
R’
iv
bv
2
R
1
C
(b) Second order high-pass
Figure 9.16: High-pass section realizations.
First order high-pass stage
e ﬁrst order OpAmp ﬁlter stage (Figure 9.16a) is a non-inverting ampliﬁer in series with a
high-pass passive RC ﬁlter. e transfer characteristic is therefore given by:
vo
vi
D .j!R1C1/ .1 C R0=R/
1 C j!R1C1
:
(9.53)

9.4. OPAMP REALIZATIONS OF BUTTERWORTH FILTERS
683
is circuit meets the design goal of adjustable resonant frequency. e resonant frequency, !o,
of this circuit is determined by the input RC time constant:
!o D
1
R1C1
:
(9.54)
In addition the high-frequency gain of the circuit is adjustable through the elements R0 and R:
AVo D 1 C R0=R:
(9.55)
Second order high-pass stage
e second order high-pass stage (Figure 9.16b) transfer function is obtained in much the same
fashion as the low-pass stage. e transfer characteristic is:
vo
vi
D
.j!/2 .R1R2C1C2/ .1 C R0=R/
1 C j! ŒR2 .C1 C C2/   .R0=R/ R1C1 C .j!/2 .R1R2C1C2/
:
(9.56)
is form is immediately recognizable as a second order high-pass characteristic with the follow-
ing parameters:
AVo D 1 C R0=R;
(9.57)
!0 D
1
pR1R2C1C2
;
(9.58)
2
!0
D R2 .C1 C C2/   .R0=R/R1C1:
(9.59)
e passband gain and the resonant frequency are the same as for the low-pass case. e damping
coeﬃcient expression is diﬀerent. e same two speciﬁc design cases are of particular interest: (a)
unity gain in the passband and (b) uniform time constants in the ﬁlter section.
Unity gain designs:
Often it is important that a ﬁlter have unity gain in the passband. is restriction leads to the
following constraints:
AVo D 1
)
R0=R D 0:
(9.60)
In order to achieve the gain requirements, a short circuit is connected between the output and
the inverting input of the OpAmp and resistor R is omitted (R D 1). e transfer relationship
reduces to:
vo
vi
D
.j!/2 .R1R2C1C2/
1 C j! ŒR2 .C1 C C2/ C .j!/2 .R1R2C1C2/
:
(9.61)
e pertinent parameters are then:
!o D
1
pR1R2C1C2
(9.62)

684
9. ACTIVE FILTERS
and
2
!o
D R2 .C1 C C2/ :
(9.63)
Uniform time constant designs:
Another interesting special case in when the value of the high-frequency gain is not signiﬁcant.
It that case, it is convenient to set the capacitors and associated resistors to speciﬁc values:
C1 D C2 D Cc
R1 D R2 D Rc:
e pertinent ﬁlter parameters are then reduced to:
!o D
1
RcCc
;
(9.64)
and
2 D 2   R0=R:
(9.65)
Notice that these parameters are unchanged from the low-pass case. is speciﬁc choice of resistor
and capacitor values separates the two main parameters of the ﬁlter stage. e resonant frequency,
!o, is controlled only by Rc and Cc: the damping coeﬃcient is controlled only by the gain of the
individual stage.
Example 9.8
Design a 3rd order Butterworth high-pass ﬁlter with unity gain in the passband and a 3 dB fre-
quency of 2 kHz.
Solution:
ird order ﬁlters are comprised of a ﬁrst-order stage followed by a second-order stage with
damping coeﬃcient  D 0:5. e resonant frequency is given by:
!o D 2f3dB D 12:5664  103:
e ﬁrst order stage can be realized with element values (rounded to standard values):
R1.ﬁrst/ D 7:96 kC1.ﬁrst/ D 0:01 F:
e second order stage requires a bit more eﬀort. For simplicity, identical capacitors with the same
value as the ﬁrst-order stage capacitor will be utilized:
C1.second/ D C2.second/ D 0:01 F:
Equation (9.63) then reduces to:
R2.second/ D 3:97 k:

9.4. OPAMP REALIZATIONS OF BUTTERWORTH FILTERS
685
Equation (9.62) yields the other resistor value:
R1.second/R2.second/ D 63:326  106
)
R2.second/ D 16:0 k:
e ﬁnal design is shown below:
ov
_
+
iv
_
+
16.0 kΩ
7.96 kΩ
3.97 kΩ
0.01 µF
0.01 µF
0.01 µF
9.4.3
BAND-PASS AND BAND-STOP OPAMP FILTERS
In many cases band-pass and band-stop ﬁlters can be achieved with the series or parallel con-
nection of high-pass and low-pass ﬁlters. ese ﬁlters are particularly useful if the passband or
stopband is relatively large.
e series connection of a low-pass ﬁlter with a high-pass ﬁlter will produce a band-pass
ﬁlter if there exists a region of common passband. e band-pass ﬁlter will extend from the low
edge of the high-pass ﬁlter passband to the high edge of the low-pass ﬁlter passband. is concept
is depicted in Figure 9.17.
Passband
0
0
2
|H(   )|
1
Overall
Low Passband
High Passband
 
ω
ω
ω
ω
Figure 9.17: Cascaded band-pass ﬁlter characteristic.
Similarly, the parallel connection of a low-pass ﬁlter and a high-pass ﬁlter will produce
a band-stop ﬁlter if there is a region of common stopband. e stopband will extend from the

686
9. ACTIVE FILTERS
low edge of the low-pass ﬁlter stopband to the high edge of the high-pass ﬁlter stopband. is
concept is depicted in Figure 9.18
Stopband
0
0
2
|H(   )|
1
Overall
Low
High
Passband
Passband
 
ω
ω
ω
ω
Figure 9.18: Parallel band-stop ﬁlter characteristic.
Example 9.9
Design a Butterworth band-pass ﬁlter using a minimum number of OpAmps to meet the follow-
ing design goals:
Midband Region
low 3 dB frequency — 500 Hz
high 3 dB frequency — 2.35 kHz
voltage gain — any value (AVo)
Stopband Region
f  150 Hz—jAV jdB  jAVojdB–50 dB
f  10 kHz—jAV jdB  jAVojdB–50 dB
Verify if the design meets the design goals using SPICE.
Solution:
is ﬁlter can be constructed with the series connection of a low-pass ﬁlter and a high-pass
ﬁlter. Minimum number of OpAmps implies that the order of the ﬁlter should be kept as small as
possible while still meeting speciﬁcations. e absence of a midband gain requirement suggests
(but does not require) uniform time constant designs.
low-pass section:
e signiﬁcant radian frequencies of interest are the 3 dB frequency and the edge of the
stopband frequency:
!olp D 2.2350/ D 14:77  103
!s D 2.10,000/ D 62:83  103

9.4. OPAMP REALIZATIONS OF BUTTERWORTH FILTERS
687
50 dB attenuation translates into the magnitude of the Butterworth polynomial at the edge of the
stopband
jBn.!/j D 10.50=20/ D 316:23:
e order of this ﬁlter is found by solving Equation (9.26):
jBn .!/j D
s
1 C
!s
!o
2n
)
316:2 D
p
1 C .4:255/2n
n D log
 316:22   1

2 log .4:255/
D 3:975:
A fourth order low-pass ﬁlter is necessary. e necessary damping coeﬃcients are found in Ta-
ble 9.2:
1 D 0:3827
2 D 0:9239:
Uniform time constant design controls the damping coeﬃcient with the ampliﬁer gain:
R0=R D 2   2 D 1:2346; 0:1522:
If R is chosen arbitrarily as 10 k then the two feedback resistors are:
R0
lp1 D 12:3 k
R0
lp2 D 1:52 k:
e resonant frequency of the ﬁlter is chosen so that
!o D
1
Rc.lp/Cc.lp/
:
Two standard value components that will satisfy this relationship are:
Rc.lp/ D 1:74 k
Cc.lp/ D 0:039 F:
high-pass section:
e signiﬁcant frequencies of interest are:
!ohp D 2.500/ D 3:142  103
!s D 2.150/ D 942:5:
It is found that a ﬁfth order high-pass ﬁlter is needed:
n D log
 316:22   1

2 log .3:333/
D 4:781:
e damping coeﬃcients are:
1 D 0:3090
2 D 0:8090:

688
9. ACTIVE FILTERS
Which lead to resistor values:
R D 10 k
R0
hp1 D 13:8 k
R0
hp2 D 3:82 k:
e other components are chosen to have the proper 3 dB frequency:
Rc.hp/ D 8:16 k
Cc.hp/ D 0:039 F:
e ﬁnal design is a series connection of the two sections as shown below:
ov
_
+
iv
_
+
_
+
1.74 kΩ
1.74 kΩ
8.16 kΩ
1.74 kΩ
10 kΩ
1.52 kΩ
10 kΩ
10 kΩ
3.83 kΩ
10 kΩ
12.3 kΩ
1.74 kΩ
0.039 µF
0.039 µF
0.039 µF
0.039 µµF
10 kΩ
ov
_
+
8.16 kΩ
8.16 kΩ
0.039 µF
0.039 µF
10 kΩ
13.8 kΩ
_
+
8.16 kΩ
8.16 kΩ
0.039 µF
0.039 µF
0.039 µF
e magnitude response plot is shown below. Notice each of the predicted design goals are very
close to theory. e midband gain is approximately the product of the passband gains of each
stage:
AVo D 20 logf.2/.2:38/.1:383/.2:23/.1:152/g D 20 log 16:91 D 24:56 dB:

9.5. RESONANT BAND-PASS FILTERS
689
497.947, 2
1.000 K
1.445  
149.998, _27.737
1
K, 24.546 
2.34 4
0.000 K, _25.822
 
42 K, 21.508 
Frequency (Hz)
50
0
−50
−100
−150
Gain (dB)
10
100
10k
100k
1k
Each 3 dB frequency is exact to within a fraction of a Hz and the stopbands begin at the correct
frequencies. Notice the asymmetry of the response plot due to the diﬀerent order ﬁlters in high-
pass and low-pass sections.
9.5
RESONANT BAND-PASS FILTERS
If the passband of a ﬁlter is relatively narrow compared to the center frequency, the series connec-
tion of high-pass and low-pass stages, as described in the last section, can become prohibitive in
terms of number of components and overall cost. An alternative conﬁguration for narrow band-
pass ﬁlters utilizes the characteristics of an underdamped pole-pair in a system transfer charac-
teristic. When such a pole pair is coupled with a zero at the origin, the transfer characteristic
is:
H.!/ D
Ao
j!o
!o
1 C 2 j!o
!o
C
j!o
!o
2 :
(9.66)
e Bode magnitude plot of the transfer characteristic takes the form shown in Figure 9.19: a
band-pass characteristic that is centered at !o and that has a passband bandwidth dependent on
the complex pole pair damping coeﬃcient,  . Since the characteristic of interest occurs at the
resonant frequency of the complex conjugate pole pair, the ﬁlter characteristic is considered a
resonant ﬁlter.

690
9. ACTIVE FILTERS
|H(ω)|dB 
NNormalized fre
ζ = 0
   = 0
   = 0
   = 0
  = 0
equency ω/ωo
0.05
0.10
0.20
0.50
0.10
Figure 9.19: Resonant bandpass magnitude characteristics.
e gain at the resonant frequency of the ﬁlter is a function of the damping coeﬃcient and
is given by:
jH.!o/j D
ˇˇˇˇˇˇˇˇˇ
Ao
j!o
!o
1 C 2 j!o
!o
C
j!o
!o
2
ˇˇˇˇˇˇˇˇˇ
D Ao
2 :
(9.67)
e two half-power frequencies, !H and !L are easily calculated:
!H D !o

 C
p
1 C 2

and
!L D
!o
 C
p
1 C 2 :
(9.68)
Subtracting the half-power frequencies yields the bandwidth of the ﬁlter passband:
BW D !H   !L D 2!o:
(9.69)
Typically, ﬁlter designers deﬁne the quality factor, Q, of the circuit as the resonant frequency of
the ﬁlter divided by the bandwidth:
Q D
!o
BW
D
!o
2  !o
D
1
2  :
(9.70)
High Q band-pass ﬁlters are easily constructed using circuits with low damping coeﬃcient, .
In the regions more than about one decade from the resonance, the slope of the ﬁlter response
is ˙20 dB/decade. Should greater slope be necessary in these regions, additional resonant ﬁlter
stages can be cascaded to achieve that requirement.

9.5. RESONANT BAND-PASS FILTERS
691
9.5.1
RLC REALIZATION
ere exist a large number of possible circuit topology realizations for the resonant band-pass
ﬁlter characteristic of Equation (9.66). One such circuit topology is shown in Figure 9.20. is
circuit uses a series connection of an inductor, capacitor and resistor.
ov
_
+
G
R
L
F
R
R
C
iv
Figure 9.20: An active resonant band-pass ﬁlter.
e transfer characteristic is obtained through voltage division and the response of a non-inverting
ampliﬁer:
H.j!/ D
R
R C j!L C 1=j!C .1 C RF =RG/
D
j!RC
1 C j!RC C .j!/2LC .1 C RF =RG/ :
(9.71)
A comparison of terms to Equation (9.66) leads to expressions for the resonant frequency:
!o D
1
p
LC
(9.72)
and the damping coeﬃcient
 D R
2
r
C
L :
(9.73)
Another useful expression is that for the bandwidth:
BW D 2!o D R
L:
(9.74)
Unfortunately, in many cases, narrow band RLC realizations may require unreasonably large
inductor values.

692
9. ACTIVE FILTERS
Example 9.10
Design a RLC resonant bandpass ﬁlter with the following design goals:
Center frequency,
fo D 10 kHz
3 dB bandwidth,
B D 400 Hz:
Solution:
Choose L D 0:01 H. e bandwidth speciﬁcation leads to:
R D L  BW D 0:01.2  400/ D 25:1 :
e resonant frequency speciﬁcation leads to:
C D
1
L!2o
D
1
0:01.2  10; 000/2 D 25:3 nF:
 
4k
7k
10k
40k
100k
1k
Frequency (Hz)
20
10
0
−10
−20
−30
Magnitude (dB)
(9.8085k, 16.9958dB)
(10.2074k, 16.9960dB)
(10.0000k, 19.9957dB)
While not speciﬁed in the design goals, the gain of the ﬁlter at resonance is simply that of the
non-inverting ampliﬁer. e output to a simulation of the ﬁlter response is shown above where the
midband gain was chosen to be 10 (20 dB). e ﬁlter correctly peaks at 10 kHz with a bandwidth
of 400 Hz.
9.5.2
RC REALIZATION
It is also possible to implement the transfer characteristic of Equation (9.66) in a OpAmp circuit
containing only resistors and capacitors (Figure 9.21).

9.5. RESONANT BAND-PASS FILTERS
693
ov
_
+
2
R
1
R
3
R
1
C
2
C
iv
Av
Figure 9.21: An active resonant band-pass ﬁlter without an inductance.
e transfer characteristic of this circuit topology can be obtained through Kirchhoﬀ’s
current law applied at the negative input terminal of the OpAmp and at the node identiﬁed by
vA:
At the negative input terminal of the OpAmp:
vo
R3
C j!C2vA D 0
)
vA D
vo
j!R3C2
(9.75)
and at node vA
vi   vA
R1
  vA
R2
C j!C1 .vo   vA/ C vo
R3
D 0:
(9.76)
Combining Equations (9.75) and (9.76) yields the ﬁlter transfer characteristic:
H .j!/ D vo
vi
D
 j! RP R3C2
R1
1 C j!RP .C1CC2/ C .j!/2RP R3C1C2
:
(9.77)
Where RP D R1==R2. From the form of H.j!/, one can then deduce:
!o D
1
p
RpR3C1C2
2
!o
D RP .C1CC2/
and
Ao
!o
D RP R3C2
R1
:
(9.78)
e ﬁlter designer is in the enviable position of having ﬁve circuit variables and only three con-
straints: the ﬁlter gain, resonant frequency, and bandwidth. Since capacitor values are more con-
strained than resistor values, ﬁlter designers typically choose the two capacitor values and calculate
the three resistor values. If one further assumes the capacitors have equal value (C1 D C2 D C),
the resistor values can be determined to be:
R3 D
1
C!o
R1 D
R3
2 j H .!o/ j
and
R2 D
C!o

  1
R1
 1
:
(9.79)

694
9. ACTIVE FILTERS
Example 9.11
Design an RC resonant band-pass ﬁlter with the following design goals:
Midband voltage gain D 33 dB
Center frequency D 200 Hz
3 dB bandwidth D 20 Hz
Solution:
A necessary parameter that must be determined is the damping coeﬃcient:
 D BW
2!o
D B
2fo
D
20
2  200 D 0:05:
Arbitrarily choose C D 0:1 F. Calculate the resistor values:
R3 D
1
C!o
D
1
0:1  10 6 .0:05/ .2  200/ D 159 k
R1 D
R3
2 jH .!o/j D
159; 000
2  1033=20 D 1:78 k
R2 D
C!o

  1
R1
 1
D
0:1  10 6  2  200
0:05
 1
1780

D 512 :
e output to a simulation of the ﬁlter response is shown below. e ﬁlter appropriately peaks at
200 Hz with a gain of 33 dB and a bandwidth of 20 Hz.
 
400
700 1k
4k
100
(190.4103, 29.9890dB)
(210.4070, 29.9890dB)
(200.0000, 32.9889dB)
70
40
10
Frequency (Hz)
–5
5
15
25
35
–15
Magnitude (dB)

9.5. RESONANT BAND-PASS FILTERS
695
9.5.3
RESONANT BANDSTOP FILTERS
e ﬁlter designer is often faced with the task of eliminating a narrow band of frequencies while
retaining the remainder of the frequency spectrum. Designing a band-stop ﬁlter as the parallel
connection of a high-pass and a low-pass ﬁlter as described in Section 9.4.3 can similarly become
prohibitive in terms of number of components and overall cost when the required stop band is
narrow. While a number of OpAmp realizations for narrow band-stop (often called a “notch”)
ﬁlters exist, the circuit shown in Figure 9.22 is one that uses resonance characteristics.
ov
_
+
1
R
N
R
1
C
iv
av
pv
nv
2
C
F
R
2
R
Figure 9.22: An active resonant band-stop ﬁlter.
e ﬁlter transfer relationship can be determined by solving the set of simultaneous equations
obtained by applying Kirchhoﬀ’s current law at the nodes identiﬁed with voltages vp; vn and vo
(note that vn D vp):
 vi   vp

j!C1 C 0   vp
R1
D 0
vi   vn
RN
C va   vn
RA
D 0
.va   vo/ j!C2 C vi   vo
R2
D 0:
(9.80)
e ﬁlter transfer relationship is determined to be:
H .!/ D
1 C

C1R1   C2R2
RF
RN

j! C .C1R1C2R2/ .j!/2
1 C .C1R1CC2R2/ j! C .C1R1C2R2/ .j!/2
:
(9.81)

696
9. ACTIVE FILTERS
Both the numerator and denominator of H.!/ are resonant at:
!o D
1
pR1C1R2C2
:
(9.82)
However, the damping coeﬃcients of the numerator, N, and the denominator, D, are diﬀerent:
N D
C1R1   C2R2
RF
RN
2pR1C1R2C2
and
D D C1R1 C C2R2
2pR1C1R2C2
:
(9.83)
H.!/ has the characteristics that at frequencies much less than the resonant frequency and much
larger than the resonant frequency, jH.!/j D 1 and at the resonant frequency
jH .!o/j D
C1R1   C2R2
RF
RN
C1R1CC2R2
D N
D
:
(9.84)
In theory, the notch in the ﬁlter can be made arbitrarily deep: in practice it is possible to obtain
as much as 60 dB of attenuation at the resonant frequency.
One typical design choice for this ﬁlter conﬁguration sets R1 D R2 D R and C1 D C2 D
C, so that:
!o D
1
RC ;
N D 1   RF
RN
;
and
D D 1:
(9.85)
Example 9.12
Design a resonant band-stop ﬁlter with the following design goals:
Center frequency D 60 Hz
Notch depth > 40 dB:
Solution:
Arbitrarily choose C1 D C2 D 0:1 F and R1 D R2 D R.
en
R D
1
!oC D
1
2 .60/
 0:1  10 6 D 26:5 k
jH .!o/j D 10
 40
20 D N
D
)
N D 0:01
and
RF
RN
D 1    D 0:99:
Choose RN D 10 k and RF D 9:88 k (closest standard value).
e resultant SPICE simulation plot is shown below. All design goals are met.

9.6. CHEBYSHEV FILTERS
697
 
0
–10
–20
–30
–40
–50
Magnitude (dB)
400
100
(59.9791, −44.2221dB)
70
40
10
Frequency (Hz)
is resonant band-stop ﬁlter conﬁguration has limitations that need to be noted. In partic-
ular, it is necessary that it be driven by a low-impedance source and that it drives a high-impedance
load. As such, buﬀer circuitry may be necessary in some circumstances to insure proper operation.
In addition, the width of the band for which attenuation is more than 3 dB, of this particular
band-stop ﬁlter is not adjustable and is ﬁxed:
BW>3dB  2!o
. 3=4 decade/:
(9.86)
Performance similar to that obtained in Example 9.12, if obtained with a high-pass and a low-
pass ﬁlter connected in parallel while maintaining this same attenuation band, would require two
sixth-order ﬁlters. e savings in terms of number of components and overall cost is considerable.
e high-pass cutoﬀfrequency, !hp, and the low-pass cutoﬀfrequency !lp are approxi-
mately given by:
!hp 

1 C
p
2

!o
and
!lp 
!o
1 C
p
2
:
(9.87)
More complex circuit conﬁgurations can avoid these limitations, but are beyond the scope of this
discussion.
9.6
CHEBYSHEV FILTERS
When ﬁlter design speciﬁcations allow for a small amount of ripple in either the passband or
the stopband, an all-pole ﬁlter called the Chebyshev ﬁlter can be used. Two types of Chebyshev
ﬁlters can be speciﬁed as shown in Figure 9.23: one containing ripple in the passband, classiﬁed
as type 1, and the other with the ripple in the stopband called type 2. e disadvantage of the
ripple in the ﬁlter response is counteracted by a steeper transition band for a given ﬁlter order.
at is, for a low-pass ﬁlter of a given order, the Chebyshev ﬁlter has a lower stopband frequency
than the Butterworth ﬁlter.

698
9. ACTIVE FILTERS
0
0
1
c
1
1 + 2
(     )
H
(     )
H
0
2
s
1
A2
ω
ω
ω
ω
ε
(a)
0
1
1
A2
(     )
H
(     )
H
0
2
c
s
0
ω
ω
ω
ω
(b)
Figure 9.23: (a) Chebyshev type 1 low-pass ﬁlter response; (b) Chebyshev type 2 low-pass ﬁlter re-
sponse.
In most electronic applications, the Chebyshev type 1 response, with ripple in the passband, is
the more common of the two types. e Chebyshev type 1 ﬁlter transfer function is,⁹
ˇˇˇˇ
H .!/
Ho
ˇˇˇˇ
2
D
1
1 C "2C 2n

!
!c
;
(9.88)
where
ˇˇˇ H.!/
Ho
ˇˇˇ, and Cn

!
!c

are the normalized magnitude o f the ﬁlter transfer function and the
Chebyshev polynomials deﬁned from a recursive formula given in Table 9.3, respectively. e
parameter is related to the ripple deﬁned in Equation (9.32):
max D
p
1 C "2:
Table 9.3 is a tabulation of the ﬁrst nine Chebyshev polynominals. It is evident that for x D 0, the
Chebyshev polynomial Cn.0/ is 1 when n is even, and zero when n is odd. e resulting response
is,
ˇˇˇˇ
H .0/
Ho
ˇˇˇˇ
2
D
8
<
:
1
1 C "2 ;
n even
1;
n odd
:
(9.89)
e two general shapes of the Chebyshev type 1 low-pass ﬁlter for n odd and even are shown in
Figure 9.24. e squared magnitude frequency response oscillates between 1 and (1 C "/ 1 within
the passband and has a value of (1 C "/ 1 at the cutoﬀfrequency !c. e response is monotonic
outside the passband. e stopband edge is deﬁned by !s corresponding to a magnitude of A 2 .
⁹e Chebyshev type 2 ﬁlter transfer function is:
ˇˇˇ H.!/
Ho
ˇˇˇ
2
D
"2C 2
n. !c
! /
1C"2C 2
n. !c
! /.

9.6. CHEBYSHEV FILTERS
699
Table 9.3: First nine Chebyshev polynomials
n
ω
ω
C (x) , where  x =
n
c
0 
1 
1 
x 
2 
2
2
1
x
 
3 
3
4
3
x
x 
4 
4
2
8
8
1
x
x
 
5 
5
3
16
20
5
x
x
x 
6 
6
4
2
32
48
18
1
x
x
x
 
7 
7
5
3
64
112
56
7
x
x
x
x
8 
8
6
4
2
128
256
160
32
1
x
x
x
x
 
9 
9
7
5
3
256
1280
432
120
9
x
x
x
x
x
0
0
1
c
1
1 + 2
(     )
H
(     )
H
0
2
s
1
A2
ω
ω
ω
ω
ε
(a)
0
1
1
A2
(     )
H
(     )
H
0
2
c
s
0
1
1 + 2
ω
ω
ω
ω
ε
(b)
Figure 9.24: (a) Frequency Response of odd order Chebyshev type 1 ﬁlter; (b) Frequency Response
of even order Chebyshev type 1 ﬁlter.
e roots of 1 C "2C 2
n

!
!c

in the denominator of the Chebyshev type 1 transfer function (the
poles) lie on an ellipse on the complex plane as shown in Figure 9.25. For simplicity, let !r D
!=!c. e amount of ripple in the response is related to the eccentricity of the ellipse.

700
9. ACTIVE FILTERS
X
X
X
X
X
X
X
X
X
X
X
X
X
X
Poles on axis
for even n
(LHP)
(RHP)
Left Hand Plane
Right Hand Plane
Figure 9.25: Poles of a low-pass Chebyshev type 1 ﬁlter.
Using the LHP poles only, the transfer function can be written as,
H .!r/
Ho
D
K
nQ
kD1
Œ.j !r   sk/
D
K
Vn .j!r/;
(9.90)
where sk are the pole locations,
Vn .j!r/ D .j !r/n C bn 1.j!r/n 1 C : : : C b1 .j!r/ C b0:
Here K is a normalizing constant that makes
H .0/
Ho
D
8
<
:
1
p
1 C "2 ;
n even
1;
n odd
:
e normalizing constant is therefore,
K D Vn.0/ D b0;
n odd
K D
Vn .0/
p
1 C "2 ;
n even:
Table 9.4 provides the normalized polynomials for Chebyshev type 1 ﬁlters for orders n D 1 to 9
and " corresponding to 0.5, 1, 2, and 3 dB ripples in the passband.
e required order of a Chebyshev type 1 low-pass ﬁlter depends on the following factors:
• Cutoﬀfrequency
• Stopband frequency
• Stopband attenuation

9.6. CHEBYSHEV FILTERS
701
• Passband ripple
Design speciﬁcations usually provide the required minimum attenuation desired at a certain
stopband frequency instead of an exact attenuation. e required order of the ﬁlter, n, is found
by applying Equation (9.91):
n D
log
h
g C
p
g2   1
i
log
h
!r C
p
!r 2   1
i;
(9.91)
where
A D
ˇˇˇˇ
Ho
H .!r/
ˇˇˇˇ ;
(9.92)
and
g D
r
A2   1
"2
:
(9.93)
Example 9.13
Find the transfer function for a low-pass ﬁlter with the following speciﬁcations:
1. Cutoﬀfrequency fc D 1000 Hz.
2. Acceptable passband ripple of 2 dB.
3. Stopband attenuation of  20 dB beyond 1300 Hz.
Solution:
e speciﬁcations imply the following relationships:
20log
ˇˇˇˇ
H .2  1k/
Ho
ˇˇˇˇ D 20log

1
p
1C"2

D  2 dB
and
20log
ˇˇˇˇ
H .2  1:3k/
Ho
ˇˇˇˇ D 20log

1
p
A2

D  20 dB:
e solutions to the two relationships above are: " D 0:7648 and A D 10. e relative stopband
frequency is 1:3 k=1 k D 1:3.
e required order of the Chebyshev type 1 low-pass ﬁlter is found by using Equations
(9.91)–(9.93),
g D
r
A2   1
"2
D 13:01;

702
9. ACTIVE FILTERS
and
n D
2
666
log
h
13:01 C
p
13:012   1
i
log
h
1:3C
p
1:3   1
i
3
777
D d4:3e D 5:
Table 9.4: Normalized Chebyshev polynomials (Continues.)
n
0.5 dB ripple (
0.3493)
n
1.0 dB ripple (
0.5089)
1 j
+ 2.863 
2 (j )2 +1.426(j )+1.516 
3 [(j )+0.626]{[(j )+0.313]2+1.0222} 
4 {[(j )+0.175]2+1.0162}{[(j )+0.423]2+0.4212} 
5 [(j )+0.362]{[(j )+0.112]2+1.0122}{[(j )+0.293]2+0.6252}
6 {[(j )+0.078]2+1.0092}{[(j )+0.212]2+0.7382}{[(j )+0.290]2+0.2702} 
7 [(j )+0.256]{[(j )+0.057]2+1.0062}{[(j )+0.160]2+0.8072}{[(j )+0.231]2+0.4482} 
8 {[(j )+0.044]2+1.0052}{[(j )+0.124]2+0.8522}{[(j )+0.186]2+0.5692}{[(j )+0.219]2+0.2002} 
9 
[(j )+0.198]{[(j )+0.034]2+1.0042}{[(j )+0.099]2+0.8832}{[(j )+0.152]2+0.6552}{[(j )+0.186]2+0.3492} 
1 j
+ 1.962 
2 (j )2 +1.098(j )+1.103 
3 [(j )+0.494]{[(j )+0.247]2+0.9662} 
4 {[(j )+0.140]2+0.9832}{[(j )+0.337]2+0.4072} 
5 [(j )+0.289]{[(j )+0.090]2+0.9902}{[(j )+0.234]2+0.6122}
6 {[(j )+0.062]2+0.9932}{[(j )+0.170]2+0.7272}{[(j )+0.232]2+0.2662} 
7 [(j )+0.205]{[(j )+0.046]2+0.9952}{[(j )+0.128]2+0.7982}{[(j )+0.185]2+0.4432} 
8 {[(j )+0.035]2+0.9972}{[(j )+0.100]2+0.8452}{[(j )+0.149]2+0.5642}{[(j )+0.176]2+0.1982} 
9 
[(j )+0.159]{[(j )+0.028]2+0.9972}{[(j )+0.080]2+0.8772}{[(j )+0.122]2+0.6512}{[(j )+0.150]2+0.3462} 
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ε =
ε =

9.6. CHEBYSHEV FILTERS
703
Table 9.5: (Continued.) Normalized Chebyshev polynomials
n
2.0 dB ripple (
0.7648)
n
3.0 dB ripple (
0.9953)
1 j
+ 1.308 
2 (j )2 +0.804(j )+0.637 
3 [(j )+0.369]{[(j )+0.184]2+0.9232} 
4 {[(j )+0.105]2+0.9582}{[(j )+0.253]2+0.3972} 
5 [(j )+0.218]{[(j )+0.068]2+0.9742}{[(j )+0.177]2+0.6022}
6 {[(j )+0.047]2+0.9822}{[(j )+0.128]2+0.7192}{[(j )+0.175]2+0.2632} 
7 [(j )+0.155]{[(j )+0.035]2+0.9872}{[(j )+0.097]2+0.7912}{[(j )+0.140]2+0.4402} 
8 {[(j )+0.027]2+0.9902}{[(j )+0.075]2+0.8392}{[(j )+0.113]2+0.5612}{[(j )+0.133]2+0.1972} 
9 [(j )+0.121]{[(j )+0.021]2+0.9922}{[(j )+0.060]2+0.8722}{[(j )+0.092]2+0.6472}{[(j )+0.113]2+0.3452} 
1 j
+ 1.002 
2 (j )2 +0.645(j )+0.708 
3 [(j )+0.299]{[(j )+0.149]2+0.9042} 
4 {[(j )+0.085]2+0.9472}{[(j )+0.206]2+0.3922} 
5 [(j )+0.178]{[(j )+0.055]2+0.9662}{[(j )+0.144]2+0.5972}
6 {[(j )+0.038]2+0.9762}{[(j )+0.104]2+0.7152}{[(j )+0.143]2+0.2622} 
7 [(j )+0.127]{[(j )+0.028]2+0.9832}{[(j )+0.079]2+0.7882}{[(j )+0.114]2+0.4372} 
8 {[(j )+0.022]2+0.9872}{[(j )+0.062]2+0.8372}{[(j )+0.092]2+0.5592}{[(j )+0.109]2+0.1962} 
9 [(j )+0.098]{[(j )+0.017]2+0.9902}{[(j )+0.049]2+0.8702}{[(j )+0.075]2+0.6462}{[(j )+0.092]2+0.3442} 
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
ε =
ε =
e partial bracket,
˙ , is a symbol for the operation to round up to the next integer.
Using Table 9.4 for n D 5 and 2 dB ripple, the transfer function is,
H
 !
!c

Ho
D
1

j !
!c

C0:218
 (
j !
!c

C0:068
2
C0:9742
) (
j !
!c

C0:177
2
C0:6022
)
D
1

j!
0:218!c
C 1
 "
.j!/2
0:953!2c
C 0:136 .j!/
0:953!c
C 1
# "
.j!/2
0:394!2c
C 0:354 .j!/
0:394!c
C 1
#:
e response of the ﬁfth order low-pass ﬁlter transfer function in this example is shown below.

704
9. ACTIVE FILTERS
ω
ωc
 
│H (ω)│
0.01
0.1
1
10
10
1
0.1
0.01
High-Pass Characterization:
High-pass Chebyshev ﬁlters are characterized by using the analog-to-analog transformation. e
Chebyshev low-pass to high-pass transformation, like the Butterworth low-pass to high-pass
analog-to-analog transformation, has the eﬀect of adding two zero-frequency zeroes to the trans-
fer function. e generic procedure for the analog-to-analog transformation from low to high-
pass shown in Figure 9.26 is not restricted to Chebyshev ﬁlters, but may be used for other ﬁlter
types.
e general procedure to ﬁnd the transfer function of a high-pass ﬁlter is as follows:
1. Perform a backward transformation using the high-pass ﬁlter speciﬁcations for the cutoﬀ
frequency, !c, and the stopband frequency, !s, which is associated with some level of at-
tenuation. e backward transformation of frequencies yields the normalized low-pass ratio
of stopband to cutoﬀfrequency, !r.
2. Use the normalized low-pass ratio of stopband to cutoﬀfrequency, !r, to ﬁnd the order of
the ﬁlter.
3. Use Table 9.4 to ﬁnd the transfer function of the normalized low-pass ﬁlter.
4. Perform a forward transformation on the transfer function by replacing all (j!) with !c
j! .

9.6. CHEBYSHEV FILTERS
705
0
0
1
ωs
ω
A1
A2
(     )
ω
H
H0
20 log
1
Normalized Low-Pass Response
Forward:  ωs =  
ω
ω
c
r
(a)
0
1
A2
ω
ω
c
ωs
0
A1
H (ω)
H0
20 log
j ω
ωc
j ω
Transformed High-Pass Response
Backward:  ωr =  
ωc
ω s
(b)
Figure 9.26: Analog-to-analog transformation: low-pass to high-pass.

706
9. ACTIVE FILTERS
Example 9.14
Find the transfer function for a high-pass ﬁlter with the following speciﬁcations:
1. Cutoﬀfrequency fc D 1000 Hz.
2. Acceptable passband ripple of 2 dB.
3. Stopband attenuation of  20 dB below 500 Hz.
Solution:
e high-pass to low-pass transformation procedure yields,
!r D !c
!s
D 2 .1000/
2 .500/ D 2:
e speciﬁcations imply the following relationships:
20log
ˇˇˇˇ
H .2  1k/
Ho
ˇˇˇˇ D 20log

1
p
1C"2

D  2 dB;
and
20log
ˇˇˇˇ
H .2  500/
Ho
ˇˇˇˇ D 20log

1
p
A2

D  20 dB:
e solutions to the two relationships above are: " D 0:7648 and A D 10 .
e required order of the Chebyshev type 1 low-pass ﬁlter is found by using Equa-
tions (9.91)–(9.93),
g D
r
A2   1
"2
D
s
102   1
0:76482 D 13:01;
and
n D
2
666
log
h
13:01 C
p
13:012   1
i
log
h
2C
p
2   1
i
3
777
D d2:96e D 3:
Using Table 9.4 for n D 3 and 2 dB ripple, the transfer function is,
H
 !
!c

Ho
D
1

j !
!c

C0:299
 (
j !
!c

C0:149
2
C0:9042
)
D
1

j !
!c

C0:299
 "
j !
!c
2
C 0:298

j !
!c

C 0:839
#:

9.6. CHEBYSHEV FILTERS
707
Perform a forward transformation to yield the high-pass ﬁlter transfer function:
H .!/
Ho
ˇˇˇˇ
j!! !c
j!
D
1
 !c
j!

C0:299
 " !c
j!
2
C 0:298
 !c
j!

C 0:839
#:
e normalized high-pass ﬁlter function is:
H
 !
!c

Ho
ˇˇˇˇˇˇˇˇ
j!! !c
j!
D
j!
!c
3

1C0:299
j!
!c
 "
1 C 0:298
j!
!c

C 0:839
j!
!c
2#:
e response of the third order high-pass ﬁlter transfer function in this example is shown below.
0.0 1
0.1
1
10
0.01
0.1
1
10
│H (ω)│
ω
ωc
9.6.1
OPAMP REALIZATION OF CHEBYSHEV FILTERS
Since the Chebyshev type 1 low-pass ﬁlter is an all-pole ﬁlter, the OpAmp circuit implementation
is identical to the Butterworth ﬁlter circuit conﬁgurations. Both the unity gain and Sallen and
Key conﬁgurations can be used to implement Chebyshev type 1 ﬁlters.
Low-Pass OpAmp Filters
Although the OpAmp circuit conﬁgurations for the Chebyshev Type 1 and the Butterworth low-
pass ﬁlters are identical, the calculations for the components of the circuit components diﬀer.
e calculations for the ﬁrst order low-pass stages of Chebyshev Type 1 and Butterworth ﬁlters
is identical. However, the calculation of the component values for the Chebyshev Type 1 trans-
fer function of second order low-pass stages requires some modiﬁcation from the Butterworth
calculations.

708
9. ACTIVE FILTERS
ese modiﬁcations for calculating second order stages of Chebyshev Type 1 low-pass ﬁl-
ters are as follows. If
H
 !
!c

D
n
Y
iD1
1
"
.j!/2
ai!2c
C bi .j!/
ai!c
C 1
#;
(9.94)
then the “relative” resonant frequency for the two second order stages are:
!oi D pai!c:
(9.95)
e damping coeﬃcient is,
.2i/ D
bi
pai
:
(9.96)
en Equation 9.44 is replaced by,
!oi D
1
pR1R2C1C2
:
(9.97)
Using the uniform time constant form of the Sallen and Key second-order stage where R1 D R2
and C1 D C2, the gain can be expressed as,
AV i D 3   .2i/ :
(9.98)
Example 9.15
Design a low-pass ﬁlter with the following speciﬁcations:
1. Cutoﬀfrequency fc D 1000 Hz.
2. Acceptable passband ripple of 3 dB.
3. Stopband attenuation of  20 dB above 1400 Hz.
Implement the ﬁlter transfer function with the Sallen and Key conﬁguration.
Solution:
e speciﬁcations imply the following relationships:
20log
ˇˇˇˇ
H .2  1k/
Ho
ˇˇˇˇ D 20log

1
p
1C"2

D  3 dB
and
20log
ˇˇˇˇ
H .2  1400/
Ho
ˇˇˇˇ D 20log

1
p
A2

D  20 dB:

9.6. CHEBYSHEV FILTERS
709
e solutions to the two relationships above are: " D 1 and A D 10.
e required order of the Chebyshev type 1 low-pass ﬁlter is found by using Equa-
tions (9.91)–(9.93),
g D
r
A2   1
"2
D
s
102   1
12
D 9:95;
and
n D
2
666
log
h
9:95 C
p
9:952   1
i
log
h
1:4C
p
1:42 1
i
3
777
D d3:45e D 4:
Using Table 9.4 for n D 4 and 3 dB ripple, the transfer function is,
H
 !
!c

Ho
D
1
(
j !
!c

C0:085
2
C0:9472
) (
j !
!c

C0:206
2
C0:3922
)
D
1
"
j !
!c
2
C 0:170

j !
!c

C 0:904
# "
j !
!c
2
C 0:412

j !
!c

C 0:196
#
D
5:644
"
.j!/2
0:904!2c
C 0:170j!
0:904!c
C 1
# "
.j!/2
0:196!2c
C 0:412j!
0:196!c
C 1
#
e “relative” resonant frequencies for the two second order stages are:
!o1 D
p
0:904!c D .0:951/ .2/ .1k/ D 5:98 krad=s;
and
!o2 D
p
0:196!c D .0:443/ .2/ .1k/ D 2:78 krad=s:
e damping coeﬃcients are:
21 D
0:170
p
0:904
D 0:179
and
22 D
0:412
p
0:196
D 0:931:

710
9. ACTIVE FILTERS
Let the capacitors be equal and C D 0:1 F. Let the frequency controlling resistances within each
stage be identical. en, the frequency controlling resistors for the two stages are:
R1 D
1
!01C D
1
5:98k .0:1/ D 3:6 k;
and
R2 D
1
!02C D
1
2:78 k .0:1/  1:6 k
(standard value).
e gain for the two stages are:
Av1 D 3   .21/ D 2:82;
and
Av2 D 3   .21/ D 2:07:
If R0
gain1 D R0
gain2 D 10 k, then Rgain1  18 k and Rgain2  10 k.
e completed fourth-order Chebyshev ﬁlter design is shown below.
ov
_
+
iv
_
+
1.6 kΩ
1.6 kΩ
3.6 kΩ
10 kΩ
10 kΩ
10 kΩ
18 kΩ
3.6 kΩ
0.1 µF
0.1 µF
0.1 µF
0.1 µF
High-Pass OpAmp Filters
Unlike Butterworth ﬁlters, the Chebyshev high-pass OpAmp ﬁlter is not arrived at by simple
interchanges of the frequency controlling resistances and capacitances. As shown in Section 9.6.1,
the transfer function of the Chebyshev high-pass ﬁlter is found by performing analog-to-analog
transformations. e high-pass transfer function is then implemented by a circuit using the same
techniques outlined for the Chebyshev low-pass ﬁlter.
Example 9.16
Design a high-pass ﬁlter with the following speciﬁcations:
1. Cutoﬀfrequency fc D 1000 Hz.
2. Acceptable passband ripple of 3 dB.

9.6. CHEBYSHEV FILTERS
711
20
1
4
7 10
Frequency (Hz)
40
100
400
1k
4k
5
–10
–25
–40
Magnitude (dB)
Figure 9.27: SPICE frequency response for Example 9.15.
3. Stopband attenuation of  20 dB below 600 Hz.
Implement the ﬁlter transfer function with the Sallen and Key conﬁguration.
Solution:
e speciﬁcations imply the following relationships:
20log
ˇˇˇˇ
H .2  1k/
Ho
ˇˇˇˇ D 20log

1
p
1C"2

D  3 dB
and
20log
ˇˇˇˇ
H .2  600/
Ho
ˇˇˇˇ D 20log

1
p
A2

D  20 dB:
e solutions to the two relationships above are: " D 1 and A D 10.
An analog-to-analog transformation is performed to determine the transformed normal-
ized LOW-PASS characteristics. e backward transformation from high to low-pass yields,
!r D !c
!s
D 2 .1000/
2 .600/ D 1:67:

712
9. ACTIVE FILTERS
e required order of the normalized Chebyshev type 1 low-pass ﬁlter is found by using Equa-
tions (9.91)–(9.93),
g D
r
A2   1
"2
D
s
102   1
12
D 9:95;
and
n D
2
666
log
h
9:95 C
p
9:952   1
i
log
h
1:67C
p
1:67   1
i
3
777
D d3:27e D 4:
Using Table 9.4 for n D 4 and 3 dB ripple, the transfer function is,
H .!/
Ho
D
1
n
Œ.j!/ C0:0852C0:9472
o n
Œ.j!/ C0:2062C0:3922
o
D
1
h
.j!/2 C 0:170 .j!/ C 0:904
i h
.j!/2 C 0:412 .j!/ C 0:196
i:
Another analog-to-analog transformation is performed to yield the normalized HIGH-PASS
transfer function by replacing j! with !c
j! .
H .!/
Ho
D
1
" !c
j!
2
C 0:170
 !c
j!

C 0:904
# " !c
j!
2
C 0:412
 !c
j!

C 0:196
#
D
j!
!c
2
"
1 C 0:170
j!
!c

C 0:904
j!
!c
2# "
1 C 0:412
j!
!c

C 0:196
j!
!c
2#
D
j!
!c
2
2
641 C 0:188
1
0:904
j!
!c

C
1
1
0:904
j!
!c
2
3
75
2
641 C 2:112
1
0:196
j!
!c

C
1
1
0:196
j!
!c
2
3
75
:
e “relative” resonant frequencies for the two second order stages are:
!o1 D
r
1
0:904
!c D .1:052/ .2/ .1k/ D 6:61 krad=s

9.6. CHEBYSHEV FILTERS
713
and
!o2 D
r
1
0:196
!c D .2:259/ .2/ .1k/ D 14:18 krad=s:
e damping coeﬃcients are:
21 D 0:188
q
1
0:904
D 0:179
and
2 D 2:112
q
1
0:196
D 0:935:
Note that the damping coeﬃcients are identical (except for round-oﬀerror) to that of the fourth
order low-pass example in Example 9.15
Let the capacitors be equal and C D 0:1 F. Let the frequency controlling resistances
within each stage be identical. en, the frequency controlling resistors for the two stages are:
R1 D
1
!01C D
1
6:61 k .0:1/  1:5 k;
and
R2 D
1
!02C D
1
14:18 k .0:1/  680 
(standard value).
e gain for the two stages are:
Av1 D 3   .21/ D 2:82
and
Av2 D 3   .21/ D 2:07:
If R0
gain1 D R0
gain2 D 10 k, then Rgain1  18 k and Rgain2  10 k: the gain resistors are iden-
tical to the fourth order low-pass example in Example 9.15.
ov
_
+
iv
_
+
680 Ω
680 Ω
1.5 kΩ
1.5 kΩ
10 kΩ
10 kΩ
10 kΩ
18 kΩ
0.1 µF
0.1 µF
0.1 µF
0.1 µF

714
9. ACTIVE FILTERS
 
 
300
700
1k
4k
7k
10k
30k
20
10
0
–10
–20
–30
–40
Magnitude (dB)
Figure 9.28: High-pass Chebyshev ﬁlter of Example 9.16.
9.7
COMPARISON OF FILTER TYPES
e Butterworth and Chebyshev ﬁlter types have been discussed in the previous section. e
three ﬁlter types oﬀer diﬀerent performance characteristics that may be used to fulﬁll design
speciﬁcations. To simplify the choice of ﬁlter used to fulﬁll a certain speciﬁcation, several key
characteristics are compared:
1. Cut-oﬀfrequency
e Butterworth ﬁlter passband is typically deﬁned by the cut-oﬀfrequency which is the
half power point in the frequency response. However, in Chebyshev ﬁlters the passband, and
therefore, the so-called cut-oﬀfrequency, is deﬁned by the frequency that identiﬁes the end
of the ripple. ese two frequencies are diﬀerent unless " D 1. erefore, it is important to
keep separate the deﬁnitions of cut-oﬀfrequency and half-power points for diﬀerent ﬁlter
types.
2. Ripple
e Butterworth ﬁlter has a maximally ﬂat response which results in a ripple-free passband
and stopband. Chebyshev ﬁlters exhibit ripple in either the passband or the stopband for
Chebyshev type 1 or type 2 ﬁlters; that is, passband ripple corresponds to type 1 ﬁlters
and stopband ripple corresponds to type 2 ﬁlters. In the Chebyshev response, the ripple is
dependent on the factor ".
3. DC response for a low-pass ﬁlter

9.8. SWITCHED-CAPACITOR FILTERS
715
In the Butterworth ﬁlter, the response is peaked at DC. However, in the Chebyshev designs,
the DC ﬁlter response may be either peaked or at the power level of the response at the cut-
oﬀfrequency: that is, the DC response is peaked for odd order ﬁlters, and corresponds to
the cut-oﬀfrequency power level for even order ﬁlters.
4. Transition band
One of the most important ﬁlter speciﬁcations is the steepness of the transition band.
Steeper transitions from the passband to stopband requires the use of higher order ﬁlters:
higher order ﬁlters require more electronic components to implement. Fortunately, the three
ﬁlter types discussed in the previous section have varying transition band steepness given
an identical ﬁlter order. e Butterworth ﬁlter is the least steep in the transition band.
For example, for a n D 5 ﬁlter (with " D 1), the Chebyshev response has 24 dB greater
attenuation than the Butterworth response.
9.8
SWITCHED-CAPACITOR FILTERS
Using MOSFETS as switches, switched-capacitor (SC) ﬁlters can be designed in precision mono-
lithic integrated circuits, and is widely used in digital signal procession applications. e advantage
of using MOSFET SC ﬁlters is derived from the simple fact that it is diﬃcult to manufacture
precision resistors in integrated circuits. OpAmps and capacitors are more easily fabricated. Al-
though accurate values of capacitances may be diﬃcult to achieve, precise ratios of capacitances
can easily be achieved in integrated circuits.
e key features of SC ﬁlters are:
• e ﬁlter can be fabricated in a precision monolithic integrated circuit.
• Since MOS technology allows high component density in integrated circuits, a single chip
can be fabricated to fulﬁll both analog and digital signal processing.
• MOS devices have very low power dissipation and temperature coeﬃcients.
• Precise capacitance ratios can be fabricated. is is particularly important since active ﬁlters
depend largely on RC time constants: the time constant can be controlled by capacitance
ratios.
• Because resistors are eliminated, power consumption is reduced.
9.8.1
MOS SWITCH
e FET as an analog switch was discussed in Section 4.5 (Book 1). Ideal enhancement type
NMOSFET switch has the following design goals:
• In the ON state (VGS > VT ), it passes signal from the drain to source without attenuation.

716
9. ACTIVE FILTERS
• In the OFF state (VGS < VT ), the signal is not passed from the drain to source.
• Transitions between the ON and OFF states is instantaneous.
Real NMOSFET switches have the following characteristics:
• In the ON state (VGS > VT ), the drain-source resistance, rD, is in the order of kilo-ohms
(< 10 k).¹⁰
• In the OFF state (VGS < VT ), the drain-source resistance, rD, is in the order of several
hundred mega-ohms (100 M–1000 M).
e ratio of the resistance values between the ON and OFF states of an enhancement
NMOSFET is in the order or 105 or 100 dB. An equivalent representation of the characteristic
of enhancement NMOSFET switches is shown in Figure 9.29.
G
D
S
Condition
Switch State
Equivalent Resistor
Switch Model
ON
OFF
10 kΩ
100MΩ
VGS > V T
VGS < V T
Enhancement NMOSFET Symbol
Figure 9.29: Circuit and switch representation of enhancement NMOSFET.
A voltage signal is applied to the gate-source junction with fast rise and fall times and with
a peak amplitude greater than VT . Since the gate-source voltage is now a time varying signal, it is
represented as vgs or more commonly as a pulse train signal . e NMOSFET switch is open or
closed depending on the value of . is type of switch is known as the single-pole single-throw
(SPST) switch.
e clock signal, , which is a pulse train signal, is usually generated by an external digital
system. e pulse train is periodic with a period of TC with a clock frequency of f D 1=TC. e
clock signal is used to turn the NMOSFET ON or OFF.
A two phase clock is shown in Figure 9.30. e two clock signals, 1 and 2, have the
same clock frequency but is out of phase; that is, when 1 is ON, 2 is OFF. e duty cycle
(percentage of time ON to the period of the signal) is commonly slightly less than 50% to insure
non-overlapping clocks.
¹⁰e comparatively large ON resistance of these switches is due to on-chip geometries that are not present in discrete FET
switches as described in 4 (Book 1).

9.8. SWITCHED-CAPACITOR FILTERS
717
1
2
Tc
Tc
t
t
Vø
Vø
ø
ø
Figure 9.30: Biphase non-overlapping clocks.
For two NMOSFET switches in series in a “T” arrangement with a capacitor forms an
SC circuit, shown in Figure 9.31a, with each FET with M1 driven by 1 and M2 by 2, one of
the two FETs will always be ON. Simpliﬁed equivalent diagrams of the SC circuit are shown
in Figure 9.31b and c. Figure 9.31b is derived by directly replacing the NMOSFETs with SPST
switch representations, while Figure 9.31c is the functional equivalent diagram of the SC circuit.
With biphase clock signal inputs 1 and 2 to FETs M1 and M2, respectively, it is evident that
there will never be a direct connection between v1 and v2, as shown in Figure 9.31c. e term
“switched capacitor” derives from the switching operation of the FETs on the capacitor.
For a time varying input voltage, v1.t/ , with switch S1 closed and S2 open, the equivalent
circuit is that shown in Figure 9.32. If v1.t/ is a constant voltage, the voltage across the capacitor,
C, will increase with the time constant  D RON1C, where RON1 is the ON resistance of the
NMOSFET M1. For typical capacitance of C D 1 pF and RON1 D 10 k, the voltage across the
capacitor will reach 63% of the input voltage when  D RON1C D 10 ns.
For the switched capacitor ﬁlter to operate properly, the time constant formed by RON1C
must be signiﬁcantly small compared to the variations in the input voltage signal. If the switch
position is changed from 1 to 2, the charge on the capacitor will discharge at the output, v2. e
charge transferred is,
Q D C .v1   v2/ ;
(9.99)
over a discharge time, TC. e average current through the capacitor during this discharging
period in time is,
i .t/ D dQ
dt D Q
t  C .v1   v2/
TC
:
(9.100)

718
9. ACTIVE FILTERS
v1
v2
+
+
_
_
C
M1
M2
1
2
ø
ø
(a)
C
S 1
S 2
+
+
_
_
v2
v1
(b)
C
S
+
+
_
_
v2
v1
(c)
Figure 9.31: (a) NMOSFET switched capacitor, (b) FETs replaced by SPST switches, (c) simpliﬁed
functional circuit representation.
C
S
+
+
_
_
v2
v1
1
2
(a)
C
S 1
S 2
+
_
v1
RON1
+
_
vC
v2
+
_
(b)
Figure 9.32: (a) Switched capacitor with node 1 closed, (b) Equivalent circuit with FET ON resis-
tance shown.

9.8. SWITCHED-CAPACITOR FILTERS
719
e equivalent resistor formed by the switched capacitor to yield the same value of current is:
REQ D v1   v2
i.t/
D TC
C D
1
fcC ;
(9.101)
since i.t/ D v1 v2
REQ
the approximate equivalent circuit for the switched capacitor of Figure 9.31a
is Figure 9.33.
_
v1
R
EQ
+
v2
+
_
Figure 9.33: Approximate equivalent circuit for a switched capacitor.
Consider the range of values of REQ. Using C D 1 pF (requiring a silicon area on the chip of ap-
proximately 0.01 mm2) and a typical switching frequency of the NMOSFETs of fc D 100 kHz,
REQ is found to be 10 M. For the switched capacitor network to be useful, the switching fre-
quency, fC, must be much larger than the signal frequencies of interest in v1.t/ and v2.t/.
9.8.2
SIMPLE INTEGRATOR
e switched capacitor networks are used to implement active circuits for a variety of analog
operations. A simple integrator shown in Figure 9.34a is described by the transfer function,
vo .!/
vi .!/ D  1
j!RCf
:
(9.102)
e resistance in the integrator of Figure 9.34a can be replaced with a switched capacitor to obtain
Figure 9.34b. e integrator transfer function can be rewritten using Equation (9.101),
vo .!/
vi .!/ D   fCC1
j!Cf
:
(9.103)
e transfer function of the switched capacitor implementation of the active integrator
clearly shows a dependence on the clock frequency of the NMOSFET input signals and the ra-
tio of the two capacitors. Since MOS integrated circuit technology can hold tight tolerances on
capacitance ratios, precision integrators may be fabricated using the switched capacitor imple-
mentation.

720
9. ACTIVE FILTERS
ov
_
+
f
C
R
iv
(a)
ov
_
+
f
C
1
C
1
M
1
Ø
2
Ø
iv
2
M
(b)
Figure 9.34: (a) Simple active RC integrator, (b) Switched capacitor implementation of (a).
9.8.3
GAIN STAGE
A switched capacitor inverting ampliﬁer arrangement is shown in Figure 9.35a with two switched
capacitor ﬁlter networks, each equivalent to a resistance. e gain of the circuit is,
AV D vo
vi
D  C2
C1
:
(9.104)
In Figure 9.35a, the capacitor C1 is charged to input signal level for 1 D V and C2 is discharged.
When 1 D 0 then the voltage across C1 is applied to the OpAmp and C2 becomes the feedback
path.
A direct replacement of the resistors in the inverting OpAmp ampliﬁer conﬁguration with
switched capacitors yields the circuit shown in Figure 9.35b. is circuit is unworkable since
the switches used to form the feedback resistance is never closed simultaneously. erefore, the
feedback path from the output to the input of the OpAmp is only periodically closed and the
OpAmp will saturate.

9.8. SWITCHED-CAPACITOR FILTERS
721
ov
_
+
2
C
1
C
1
M
1
Ø
2
Ø
iv
2
M
1
Ø
3
M
(a)
ov
_
+
1
C
1
M
1
Ø
2
Ø
iv
2
C
2
M
2
Ø
3
M
1
Ø
4
M
(b)
Figure 9.35: (a) Practical switched capacitor inverting ampliﬁer, (b) Unworkable switched capacitor
inverting ampliﬁer.

722
9. ACTIVE FILTERS
9.8.4
LOW-PASS FILTERS
A switched capacitor active low-pass ﬁlter is shown in Figure 9.36. e NMOSFETs M1 and M2
and the capacitor C1 form the equivalent resistance, REQ, such that the transfer function of this
circuit is,
vo .!/
vi .!/ D
1
REQC2
0
BB@
1
j! C
1
REQC2
1
CCA D fCC1
C2
0
BB@
1
j! C fCC1
C2
1
CCA :
(9.105)
ov
_
+
1
C
1
M
1
Ø
2
Ø
iv
2
C
2
M
Figure 9.36: First-order low-pass ﬁlter.
rough careful switched capacitor network arrangements, second order switched capaci-
tor ﬁlter circuit can be implemented. Figure 9.37 shows a Sallen and Key second order all-pole
low-pass ﬁlter and its switched capacitor equivalent. Note that resistors R2 and R3 are in the feed-
back path and the switched capacitor implementation replaces these resistors with the alternate
switched capacitor network of a NMOSFET in parallel with the switched capacitor.
9.9
OPAMP LIMITATIONS
us, far, designs using OpAmps have assumed that the OpAmp has very large open-loop gain
(A  200 k) over all frequencies. Filter designs have used this assumption by ignoring potential
frequency eﬀects of OpAmps in their design. In reality, OpAmps themselves have a frequency
response: the frequency response is dependent on the closed loop gain of the ampliﬁer. erefore,
the OpAmp may itself limit the operational frequency range of the application.
When a large step input voltage is applied to an OpAmp, the output waveform rises with
a ﬁnite slope called the slew rate. e slewing behavior of the output is due to ampliﬁer non-
linearities. erefore, the slew rate cannot be calculated from the frequency response of the
OpAmp using linear analysis. e inability of the OpAmp output to rise in voltage as quickly
as linear theory predicts will also limit the frequency range of the ampliﬁer.

9.9. OPAMP LIMITATIONS
723
ov
_
+
2
R
4
R
3
R
1
R
2
C
1
C
iv
(a)
ov
_
+
5
C
3
C
1
R
4
R
2
R
3
R
1
M
1
Ø
2
Ø
iv
4
C
1
C
2
C
6
C
2
M
3
M
1
Ø
6
M
2
Ø
5
M
1
Ø
4
M
1
Ø
(b)
Figure 9.37: (a) Sallen and key second order low-pass ﬁlter section, (b) Switched capacitor imple-
mentation.

724
9. ACTIVE FILTERS
9.9.1
FREQUENCY RESPONSE OF OPAMPS
Returning to the deﬁnition of the OpAmp output voltage presented in Equation 1.2 (Book 1), a
frequency dependent gain is used,
vo D A .j!/ Œv2   v1 D A .j!/ vi;
(9.106)
where
A.j!/ is the frequency dependent large signal gain
v2 is the non-inverting input voltage
v1 is the inverting input voltage
vo is the output voltage, and
vi is the voltage applied between the input terminals of the OpAmp.
For a A741, the gain characteristics are shown in Figure 9.38. e A741 is an internally
compensated OpAmp, meaning that a capacitor is fabricated on the chip to for stability resulting
in a low-frequency pole in the transfer function.
A(j
, Hz
0
, dB
20
40
60
80
100
120
-20 dB / decade
f
ω)
10
100
1 k
10 k
100 k
1 M
Figure 9.38: OpAmp open loop gain characteristics.
e curve shows an open loop gain of between 100 and 120 dB at DC. en at the OpAmp
corner frequency, fca D 5 Hz, the gain falls oﬀat  20 dB/decade, reaching 0 dB at 1 MHz. e
product of the gain with the bandwidth is constant and is deﬁned as the Gain Bandwidth Product
(GBP). e GBP of the A741 is 106. e open loop gain, A.j!/, of this curve is,
A .j!/ D
Ao
1 C j!
!ca
D
Ao!ca
j! C !ca
D
GBP
j! C !ca
;
(9.107)

9.9. OPAMP LIMITATIONS
725
where Ao is the open loop gain at DC,
!ca D 2fca
and
(9.108)
GBP D Ao!ca:
Referring to Figure 9.39, the GBP is conﬁrmed as being constant, where the bandwidth is deﬁned
by the corner frequency (fc) and the closed loop gain as Av.
A(j
, Hz
10
100
1 k
10 k
100 k
1 M
0
, dB
20
40
60
80
100
120
-20 dB / decade
f
A v = 10 k
A v = 1 k
A v = 100
A v
= 10
f ca
f t
ω)
Figure 9.39: Closed loop gain characteristics.
e output voltage, vo, of an inverting OpAmp ampliﬁer shown in Figure 9.40 is,
vo D A .j!/ va;
(9.109)
where va is the input to the OpAmp.
e input voltage to the OpAmp is,
va D
 vo   vi
Rs C Rf

Rs C vi:
(9.110)
Combining Equations (9.109) and (9.110), and knowing that Rf =Rs D K, the gain of the circuit
is,
AV D vo
vi
D  K
A.j!/=.1 C K/
1 C A.j!/=.1 C K/:
(9.111)
Let A.j!/ D GBP=j! then the voltage gain in Equation (9.111) becomes,
AV D vo
vi
D  K
GBP=.1 C K/
j! C GBP=.1 C K/:
(9.112)

726
9. ACTIVE FILTERS
ov
_
_
_
_
+
+
+
+
S
R
f
R
CC
V
CC
V
iv
av
Figure 9.40: Inverting OpAmp ampliﬁer.
Equation (9.112) is a transfer function of the inverting OpAmp ampliﬁer taking into account the
frequency response of the OpAmp. It is of the form of a single-pole transfer function with 3 dB
frequency:
!3 dB D GBP
1 C K :
(9.113)
9.9.2
OPAMP SLEW RATE
Time domain responses of OpAmp circuits require a introduction to a characteristic that is im-
portant in the speciﬁcation of OpAmps. e most important of these is the slew rate. Because
OpAmps have responses that are frequency dependent, the output due to a step input is not a
perfect step, causing the output to be distorted.
When a step function, shown in Figure 9.41a, is applied to a unity gain follower OpAmp
circuit, the resulting output is that similar to Figure 9.41b. e output voltage is in the form of a
low-pass ﬁlter,
AV .!/ D vo .!/
vi .!/ D
1
1 C j!
!t
;
(9.114)
where
vo.!/ is the output voltage
vi.!/ is the input voltage
!t is the unity gain bandwidth.
e step response of the circuit is an exponentially rising waveform,
vo.t/ D V1.1   e !tt/ D V1

1   e t=
:
(9.115)

9.9. OPAMP LIMITATIONS
727
0
t
V1
vi
)t(
(a)
vo
)t(
t
0
V1
(b)
vo( t )
t
0
V1
(c)
Figure 9.41: (a) Input voltage to OpAmp unity gain follower (b) Output waveform with V1 small
(Non-Saturating) (c) Input waveform with V1 large.
For a small input voltage V1, the output will be non-saturating, and the output waveform is shown
in Figure 9.41b.
e initial slope of the output voltage is,
dvo.t/
dt
D V1!t D V1.GBP /:
(9.116)
e results above are valid for linear operation; implying that the input voltage must be suﬃciently
small so that the OpAmp does not saturate. For a large, saturating input voltage, the output
waveform is shown in Figure 9.41c. Note that the initial slope of the output response is lower
than predicted for linear theory. e inability of the OpAmp to rise as quickly as predicted by
linear theory is called slew rate limiting. e initial slope of the output response is called the slew
rate, SR, deﬁned as,
SR D dvo.t/
dt
ˇˇˇˇ
maximum
:
(9.117)
e OpAmp begins slewing when the initial slope of the output waveform is less than V1.GBP /.
e slew rate is speciﬁed in manufacture’s speciﬁcations in volts per microsecond.
e slew rate is related to power bandwidth, fp. e power bandwidth of the OpAmp is
deﬁned as the frequency at which a sinusoidal output begins to distort. e implication is that
slew rate limits the bandwidth of OpAmp operation for ampliﬁer and ﬁlter designs.
Given a output signal at the rated output voltage of the OpAmp,
vo .t/ D Vout sin
 2fpt

;
(9.118)
the maximum slew rate is,
dvo .t/
dt
ˇˇˇˇ
maximum
D Vout2fp cos
 2fpt
ˇˇ
tD0 D Vout2fp:
(9.119)

728
9. ACTIVE FILTERS
If Vout2fp > SR, the output waveform is distorted. e power bandwidth is therefore deﬁned
by the slew rate,
fp D
SR
2Vrated
;
(9.120)
where Vrated is the rated OpAmp output voltage.
Detailed SPICE models for the A741, created from its equivalent models and including
all the above discussed properties, are available in essentially every modern SPICE simulation
package.
9.10
CONCLUDING REMARKS
Signal ﬁltering concepts have been described in this chapter. It was demonstrated that bandpass
ﬁlters could be designed by cascading low-pass and high-pass ﬁlters. ree types of active ﬁl-
ters employing OpAmps were shown. Design criteria such as cutoﬀfrequency, passband ripple,
and stopband attenuation are used to determine order and type of active ﬁlter that best suits the
requirements.
e three ﬁlter types and their characteristics are:
Butterworth Filter
• Maximally ﬂat - no ripple
• All pole low-pass ﬁlter
• Can be implemented using Sallen and Key circuit
Chebyshev Type 1 Filter
• Ripple in the passband
• All pole low-pass ﬁlter
• Can be implemented using Sallen and Key circuit
• Has a steeper transition region than Butterworth for a given order ﬁlter
Switched capacitor networks were discussed as a means to implement active circuits in MOS
integrated circuit using capacitance ratios instead of resistors. e design advantage lies in the
elimination of resistors, which require large areas when fabricated in integrated circuits. e major
drawback is the frequency limitations imposed by the switching.
e frequency response limitations of OpAmps was discussed in terms of gain bandwidth
(GBP) and slew rate (SR). e response of an active circuit depends not only on the components
external to the OpAmp, but on the OpAmp itself.

9.10. CONCLUDING REMARKS
729
SUMMARY DESIGN EXAMPLE
Digital-to-Analog (D/A) conversion of electrical signals typically requires output low-pass ﬁl-
tering in order to remove undesirable high-frequency signal components. As an example, digital
audio systems typically require this low-pass ﬁltering at the output so that the signals passed on
to the power ampliﬁcation stages are faithful reproductions of the original audio input.
Audio signals are contained to the frequency band, 40 Hz < f < 20 kHz. Compact disk
systems sample this audio signal at 44.1 kHz prior to analog-to-digital conversion. e digital
samples are then converted to 16 binary bits of information (65,536 levels) and encoded onto the
compact disk. When the disk is to be replayed, the individual words of information are sampled
several times (oversampled) before D/A conversion. e output of the D/A converter contains the
original signal spectrum with sidebands centered at frequencies that are multiples of the product
of the sampling rate and the oversampling constant. It is these sidebands that must be eliminated.
Design a ﬁlter to eliminate the sidebands of 4x oversampled compact disk D/A conversion
without distorting the frequency content of the original signal by more than 0.25 dB at any
frequency.
Solution:
e human ear is particularly sensitive to variations in frequency content: the designed
ﬁlter should be smooth in the passband. A Butterworth ﬁlter is a good choice (Chebyshev, Type
2 might be an alternative). e sideband signals should be attenuated so that they are less than one
level of digitization. Quantization into 65,536 levels implies that ﬁlter must introduce 96.33 dB
attenuation at the lower frequency edge of the ﬁrst sideband. e lower edge of this sideband is
at:
fs D 4.44:1 kHz/   20 kHz D 156:4 kHz:
A 0.25 dB variation at the edge of the passband sets the value of for the Butterworth ﬁlter:
p
1 C "2 D 100:025
)
" D 0:24342:
e order of the ﬁlter is then determined to be:
n D 1
2
8
ˆˆ<
ˆˆ:
log
 109:633   1

  log
 "2
log
fs
fc

9
>>=
>>;
D 6:08:
At least a seventh-order Butterworth ﬁlter is necessary. e three second-order damping coeﬃ-
cients necessary for this ﬁlter are:
1 D 0:2225
2 D 0:6235
3 D 0:9010:

730
9. ACTIVE FILTERS
e resonant frequency for the Butterworth ﬁlter is given by:
!o D !c
np" D 2 .20; 000/
7p
0:24343
D 153:77 krad=s .24:473 kHz/ :
Since gain is not a factor in the design requirements, a uniform time constant realization is chosen
for simplicity and uniformity. One resistor-capacitor pair that will adequately approximate the
resonant frequency (the ﬁlter resonant frequency has been chosen slightly larger [24.54 kHz]
than the theoretical value) is:
R D 1:38 k
C D 0:0047 F:
One possible ﬁlter realization is shown below with the SPICE veriﬁcation:
10 k
1.
1.38 
1
8 k
0.0047   F
10 k
10 k
1.38 k
k
0.0047   F
1
7.5 k
0.0047   F
1.3
1.38 k
0.0047   
10 
1.38 k
10.000, 20.615 
156.422 K
10 k
0.0047   F
8 k
1.38 k
1
15.6 k
F
0.0047   F
K, _92.009 
 
1.98 k
0.0047   F
20.029 K, 20.400 
10  kΩ
10  kΩ
7.5  kΩ
10  kΩ
1.98 kΩ
1.38  kΩ
_
+
_
+
_
+
_
+
0.0047µ F
0.0047µ F
0.0047µ F
0.0047µ F
0.0047µ F
0.0047µ F
0.0047µ F
1.38  kΩ
1.38  kΩ
1.38  kΩ
1.38  kΩ
1.38  kΩ
1.38  kΩ
vi
vo
10  kΩ
10  kΩ
15.6  kΩ
Gain (dB)
Frequency (Hz)
-160
1
10
100
1K
10K
100K
1M
-120
-80
-40
40
0
ov
_
+
iv
_
+
_
+
1.38 kΩ
1.38 kΩ
1.38 kΩ
10 kΩ
1.98 kΩ
10 kΩ
10 kΩ
7.5 kΩ
1.38 kΩ
1.38 kΩ
1.38 kΩ
0.0047 µF
0.0047 µF
0.0047 µF
0.0047 µF
0.0047 µF
0.0047 µF
0.0047 µF
10 kΩ
1.38 kΩ
10 kΩ
13.8 kΩ
_
+

9.10. CONCLUDING REMARKS
731
PROBLEMS
9.1.
A complex-conjugate pair of poles is characterized by its resonant frequency and damping
coeﬃcient:
!o D 1 krad=sec
 D 0:6:
(a) Determine the maximum magnitude error of the Bode straight-line magnitude ap-
proximation.
(b) Determine the maximum magnitude phase error of the -dependent Bode straight-
line phase approximation.
9.2.
e voltage gain of an ampliﬁer is described by the following transfer function:
Av.!/ D
.j!/2
 
1 C 0:9j!
50 C
j!
50
2! 
1 C
j!
10,000
 
1 C
j!
80,000
:
Plot the straight-line approximate Bode diagram. Compare results to a computer gener-
ated exact plot of the magnitude and phase.
9.3.
e transconductance of an ampliﬁer is described by the following transfer function:
GM.!/ D
.j!/2

1 C j!
10
 
1 C j!
40
  
1 C 0:7
j!
15,000 C

j!
15,000
2!:
Plot the straight-line approximate Bode diagram. Compare results to a computer gener-
ated exact plot of the magnitude and phase.
9.4.
e transresistance of an ampliﬁer is described by ﬂat midband region of value 20 k
edged by low- and high-frequency poles.
e two low-frequency poles are at:
fL1 D 100 Hz
and
fL2 D 30 Hz:
ere are three high-frequency poles: a complex-conjugate pair described by:
fHo D 80 kHz
and
 D 0:8;
and a single pole at
fH3 D 300 kHz:
(a) How many zero-frequency zeros does the expression for the transresistance contain?

732
9. ACTIVE FILTERS
(b) Plot the straight-line approximate Bode diagram.
9.5.
e current gain of an ampliﬁer is described by ﬂat midband region of value 1:8 kA/A
edged by low- and high-frequency poles.
ere are three low-frequency poles: a complex-conjugate pair described by:
fLo D 70 Hz
and
 D 0:7;
and a single pole at
fL3 D 20 Hz:
e three high-frequency poles are at:
fH1 D 14 kHz;
fH2 D 26 kHz;
and
fH3 D 160 kHz:
(a) How many zero-frequency zeros does the expression for the transresistance contain?
(b) Plot the straight-line approximate Bode diagram.
9.6.
Design requirements require the use of a 14th order low-pass Butterworth Filter. Avail-
able tables only provide the damping coeﬃcients for ﬁrst through eleventh order ﬁlters.
What are the damping coeﬃcients necessary for this 14th order low-pass Butterworth
ﬁlter?
9.7.
Design requirements require the use of a 15th order high-pass Butterworth Filter. Avail-
able tables only provide the damping coeﬃcients for ﬁrst through eleventh order ﬁlters.
What are the damping coeﬃcients necessary for this 15th order high-pass Butterworth
ﬁlter?
9.8.
A low-pass Butterworth ﬁlter is to be designed to meet the following design criteria:
Passband
nominal gain, Avo D 1
max D 0:6 dB at frequency, fc D 150 Hz.
Stopband
fs D 900 Hz
min D 60 dB min.
Determine the order of ﬁlter necessary to achieve the design goals and the ﬁlter transfer
function.
9.9.
A high-pass Butterworth ﬁlter is to be designed to meet the following design criteria:

9.10. CONCLUDING REMARKS
733
Passband
nominal gain, Avo D 1
max D 0:3 dB at frequency, fc D 150 Hz
Stopband
fs D 60 Hz
min D 50 dB min.
Determine the order of ﬁlter necessary to achieve the design goals and the ﬁlter transfer
function.
9.10.
First-order ﬁlter stages can be realized with a variety of OpAmp circuit topologies. Deter-
mine the frequency response of the transfer function of the two ﬁrst-order stages shown.
ov
_
+
C
R
R’
iv
(a)
ov
_
+
C
R
R’
iv
(b)
9.11.
ird-order Butterworth transfer functions can be realized using a single OpAmp.
ov
_
+
R
iv
R
R
2
C
1
C
3
C

734
9. ACTIVE FILTERS
(a) Determine the transfer function of the circuit shown.
(b) Choose appropriate component values to achieve a third-order low-pass Butter-
worth ﬁlter with resonant frequency, !o D 2 krad/sec.
(c) Verify the design using SPICE.
9.12.
A second-order, resonant band-pass ﬁlter can be realized as shown.
ov
_
+
iv
2
R
1
R
2
C
1
C
(a) Determine the transfer function of the circuit shown.
(b) Choose appropriate component values to achieve a resonant frequency of 1 kHz
with a damping coeﬃcient of 0.5.
(c) Use SPICE to simulate the circuit: determine the bandwidth between 3 dB fre-
quencies.
9.13.
Design a unity gain 7th order Butterworth low-pass ﬁlter using OpAmps, resistors, and
capacitors with a 3 dB frequency of 200 Hz. Verify your design with SPICE.
9.14.
Design a uniform time constant 6th order Butterworth low-pass ﬁlter using OpAmps,
resistors, and capacitors with a passband edge at 400 Hz and max D 1:5 dB. Verify your
design with SPICE.
9.15.
Design a unity gain 5th order Butterworth high-pass ﬁlter using OpAmps, resistors, and
capacitors with a 3 dB frequency of 200 Hz. Verify your design with SPICE.
9.16.
Design a uniform time constant 8th order Butterworth high-pass ﬁlter using OpAmps,
resistors, and capacitors with a passband edge at 1 kHz and max D 2:2 dB. Verify your
design with SPICE.
9.17.
A high-pass ﬁlter is to be designed to meet the following speciﬁcations.
Passband
nominal voltage gain, AVo D 25 dB

9.10. CONCLUDING REMARKS
735
passband edge, fc D 500 Hz
max D 1:5 dB maximum
Stopband
fs D 150 Hz
min D 50 dB (the gain in the stopband must be less than  25 dB)
(a) What is the minimum order Butterworth ﬁlter to meet these design goals?
(b) Design such a ﬁlter.
(c) Verify the design with computer simulation
9.18.
A low-pass ﬁlter is to be designed to meet the following speciﬁcations.
Passband
nominal voltage gain, AVo D 0 dB
passband edge, fc D 500 Hz
max D 1:3 dB maximum
Stopband
fs D 1:6 kHz
min D 55 dB
(a) What is the minimum order Butterworth ﬁlter to meet these design goals?
(b) Design such a ﬁlter.
(c) Verify the design with computer simulation
9.19.
A Butterworth band-pass ﬁlter is to be constructed to meet the following design goals:
Passband
nominal voltage gain, AVo D 0 dB
passband edges, fc1 D 600 Hz
and
fc2 D 4 kHz
max D 0:4 dB maximum
Stopbands
min D 35 dB (both stopbands)
cutoﬀfrequencies, fs1 D 300 Hz
and
fs2 D 8 kHz
Design the ﬁlter and verify the design goals using SPICE.

736
9. ACTIVE FILTERS
9.20.
Scenario: You are a junior engineer at Alcalá Engineering (a signiﬁcant, but ﬁctitious,
electronics ﬁrm). e company is in the process of designing a device that has an analog
multiplier as a critical component. In the process of investigating many possible designs
for this multiplier, the attached design was uncovered (reprinted from EDN, October
25, 1990). Your boss, the chief engineer, stops by your desk, comments on the inferior
design of the lowpass ﬁlter, asks you to ﬁx it, and leaves.
Your task:
• Investigate the design of the current four-pole, low-pass ﬁlter.
• Prepare a design that will improve on the current design.
• Prepare a formal proposal to the chief engineer for your design. eoretical analysis
and computer simulation of designs are mandatory.
Constraints:
• Alcalá Engineering is operating in a highly competitive environment: thus the ad-
dition of a signiﬁcant number of component parts is unacceptable (i.e., the ﬁlter is
to remain a four-pole ﬁlter).
• e low-frequency gain of this ﬁlter is signiﬁcant to the design of the analog mul-
tiplier and therefore must not be changed from that of the original design.
AD581
AD630
AD707
2000 pF
5 kΩ
10 kΩ
10 kΩ
10 kΩ
95 kΩ
10 kΩ
100 kΩ
11 kΩ
0.2 μF
0.2 µF
0.1 µF
0.1 µF
150 kΩ
1
V
2
10
V
out
V
Analog Multiplier
=
1
1
3 17
10
12
13
14
9
16
17
16
15 19
20
12
13
14
10
9
1
15 19
20
2
2
_
_
+
AD708
_
+
AD708
_
+
AD708
_
+
AD708
_
+
+
AD630
_
+
100 kΩ
100 kΩ
100 kΩ
100 kΩ
100 kΩ
200 kΩ
200 kΩ
1V
2V
out
V
REF
V
9.21.
A Butterworth band-stop ﬁlter is to be constructed from a fourth-order Butterworth
low-pass ﬁlter and a fourth-order Butterworth high-pass ﬁlter. All input signals in the

9.10. CONCLUDING REMARKS
737
frequency range 500 Hz  f  2 kHz are to be attenuated by at least 40 dB: signals in
the passbands are to have unity gain and the passbands are to be as wide as possible.
Design the ﬁlter and verify the design goals using SPICE.
9.22.
Design a resonant RLC band-pass ﬁlter to meet the following speciﬁcations:
Midband voltage gain D 0 dB
Center frequency D 15 kHz
3 dB bandwidth D 300 Hz
Conﬁrm the design with SPICE.
9.23.
A ﬁfth-order low-pass Butterworth ﬁlter is under design. Its design goals include:
Avo D 1
fc D 1 kHz
max D 1:5 dB
ov
_
+
R
iv
R
R
2
C
1
C
3
C
In order to reduce the number of OpAmps, it has been decided to use a unity-gain,
third-order stage of the topology shown and a second-order stage.
e transfer function for this third-order stage has been determined to be:
vo D
vi
1 C j!R.C2 C 3C3/ C .j!/22R2C3.C1 C C2/ C .j!/3R3C1C2C3
:
Complete the ﬁlter design and verify compliance to the design goals using SPICE.
9.24.
Design a resonant RC band-pass ﬁlter to meet the following speciﬁcations:
Midband voltage gain D 12 dB
Center frequency D 500 kHz
3 dB bandwidth D 75 Hz

738
9. ACTIVE FILTERS
Conﬁrm the design with SPICE.
9.25.
Design a resonant RC band-pass ﬁlter to meet the following speciﬁcations:
Midband voltage gain D 6 dB
Center frequency D 1 kHz
3 dB bandwidth D 50 Hz
Conﬁrm the design with SPICE. Pass a 1 kHz square wave through the ﬁlter and deter-
mine the THD of the output.
9.26.
Design a low-pass ﬁlter to meet the following speciﬁcations:
1 dB attenuation at 100 Hz
> 20 dB attenuation at 200 Hz
for the following ﬁlter types:
(a) Butterworth
(b) Chebyshev
Compare the order for each of the ﬁlters.
9.27.
Design a 1 kHz Chebyshev low-pass ﬁlter with the following speciﬁcations:
Passband ripple: 2 dB
Cutoﬀfrequency, fc W 1 kHz
Stopband attenuation: > 20 dB at 1.8 kHz
Conﬁrm the design with SPICE.
9.28.
Plot the transfer function of a seventh order Chebyshev type I ﬁlter with a cutoﬀfre-
quency of 4 kHz and 1 dB passband ripple. Determine the stopband attenuation at 6 kHz.
9.29.
Contrast the attenuation provided by a fourth order low-pass Chebyshev ﬁlter to a But-
terworth ﬁlter of the same order at a stopband frequency twice that of the cutoﬀfre-
quency. Let the ripple of the Chebyshev ﬁlter equal 1 dB.
9.30.
Find the transfer function of a low-pass ﬁlter with the following speciﬁcations:
Cutoﬀfrequency, fc W 200 Hz
Passband ripple: 2 dB
• Stopband attenuation > 20 dB above 400 Hz
9.31.
Find the transfer function of a high-pass ﬁlter with the following speciﬁcations:

9.10. CONCLUDING REMARKS
739
Cutoﬀfrequency, fc W 100 Hz
Passband ripple: 3 dB
Stopband attenuation > 20 dB below 50 Hz
9.32.
Design a high-pass ﬁlter with the following speciﬁcations:
Cutoﬀfrequency, fc W 100 Hz
Passband ripple: 3 dB
Stopband attenuation > 20 dB below 50 kHz
Conﬁrm the design with SPICE.
9.33.
A switched-capacitor integrator, shown in the ﬁgure, is designed to have as its output the
following expression:
vo.t/ D  10
Z
vi.t/ dt:
If the switching frequency is 100 kHz, what value capacitor, C, is necessary?
ov
_
+
1 µF
C
1
Ø
2
Ø
iv
9.34.
For the switched-capacitor integrator shown below, what input resistance corresponds to
the 2 pF and 12 pF for C1 with a clock frequency of 100 kHz?
ov
_
+
f
C
1
C
1
M
1
Ø
2
Ø
iv
2
M

740
9. ACTIVE FILTERS
9.35.
Design a switched-capacitor version of the diﬀerential integrator shown and ﬁnd the
transfer function.
ov
_
_
+
+
i2
v
i1
v
1
R
1
C
15 V
15 V
2
R
2
C
9.36.
Design an inverting ampliﬁer with a gain of  10 using the circuit shown below. Assume
a clock frequency of 100 kHz and C1 D 5 pF. Show the clock waveforms for 1 and 2.
ov
_
+
2
C
1
C
1
M
1
Ø
2
Ø
iv
2
M
1
Ø
3
M
9.37.
Design a ﬁrst order low-pass switched-capacitor ﬁlter with a cutoﬀfrequency of 500 Hz
with a clock frequency of 100 kHz. Use a capacitor value of 8 pF for one of the ﬁxed
capacitors. Find the transfer function of the circuit.
9.38.
Design a ﬁrst order high-pass switched-capacitor ﬁlter with a cutoﬀfrequency of 500 Hz
with a clock frequency of 100 kHz. Use a capacitor value of 8 pF for one of the ﬁxed
capacitors. Find the transfer function of the circuit.
9.39.
Design a switched-capacitor version of the diﬀerence ampliﬁer shown and ﬁnd the trans-
fer function.

9.10. REFERENCES
741
ov
_
_
+
+
i2
v
i1
v
1
R
4
R
2
R
15 V
15 V
3
R
27 kΩ
20 kΩ
5.1 kΩ
9.40.
For an OpAmp with a slew rate of 7 V/s used in the unity gain conﬁguration, what is
the shortest 0 V to 5 V pulse that can be used to ensure a full-amplitude output?
9.41.
For an inverting ampliﬁer using an OpAmp with a slew rate of 8 V/s, determine the
highest frequency input at which an 18 V peak-to-peak output sine wave can be gener-
ated.
REFERENCES
[1] Bowron, P. and Stephenson, F. W., Active Filters for Communications and Instrumentation,
McGraw-Hill Book Company, New York, 1979.
[2] Chen, W. K., Passive and Active Filters: eory and Implementations, John Wiley and Sons,
Publishers, New York, 1986.
[3] Ghausi, M. S., Electronic Devices and Circuits: Discrete and Integrated, Holt, Rinehart and
Winston, New York, 1985.
[4] Ludeman, L. C., Fundamentals of Digital Signal Processing, Holt, Rinehart, and Winston,
Philadelphia, 1986.
[5] Millman, J. and Grabel, A., Microelectronics, 2nd ed., McGraw-Hill Book Company, New
York, 1987.
[6] Millman, J. and Halkias, C. C., Integrated Electronics: Analog and Digital Circuits and Sys-
tems, McGraw-Hill Book Company, New York, 1972.
[7] Nilsson, J. W., Electrical Circuits, 3rd ed., Addison-Wesley, Reading, 1990.
[8] Savant, C. J., Roden, M. S., and Carpenter, G. L., Electronics Design: Circuits and Systems,
2nd ed., Benjamin/Cummings Publishing Company, Redwood City, 1991.

742
9. ACTIVE FILTERS
[9] Sedra, A. S. and Smith, K. C., Microelectronic Circuits, 3rd ed., Holt, Rinehart, and Win-
ston, Philadelphia, 1991.
[10] Van Valkenburg, M. E., Analog Filter Design, Holt, Rinehart, and Winston, Philadelphia,
1982.

743
C H A P T E R
10
Frequency Response of
Transistor Ampliﬁers
e characterization of the performance of ampliﬁers as described in Book 2 of this text has
suppressed all frequency-dependent eﬀects. e ampliﬁers have been described in the so-called
“mid-band” frequency range. is range of frequencies is characterized by two basic simplifying
assumptions:
• e midband frequencies are high enough so that discrete circuit capacitors appear to have
negligible impedance with respect to the resistances in the circuit, and
• e midband frequencies are low enough so that the active elements (transistors, OpAmps,
etc.) appear to have frequency-invariant properties.
e magnitude of the gain of a typical ampliﬁer is shown in Figure 10.1. At low frequencies
the circuit coupling and bypass capacitors reduce the gain.¹ At high frequencies the circuit active
elements degrade in performance. is degradation in performance also causes a drop in the gain
magnitude. Between these two extremes, the midband region of constant gain prevails.
A
.707A
o
o
H
L
midband region
ω
ω
|A(ω)|
ω
Figure 10.1: Typical ampliﬁer gain frequency response.
In order to predict the frequency-dependent performance of ampliﬁers and other electronic
circuitry, several options are available:
¹Ampliﬁers without bypass or coupling capacitors do not experience degradation in performance characteristics at low frequen-
cies. e midband region for such ampliﬁers extends to DC.

744
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
• Computer simulation
• Analytic calculations using phasor techniques and expanded transistor models on the entire
circuit
• Separate high-frequency and low-frequency eﬀects from midband performance in analytic
calculations
Computer simulation alone accurately predicts circuit performance but gives the circuit designer
little insight into which factors are dominant in determining the performance characteristics. An-
alytic calculations also give accurate performance prediction but these calculations often involve
extremely diﬃcult algebraic manipulation which must be repeated for each individual circuit. e
separation of individual eﬀects (midband, low-frequency, and high-frequency) gives the designer
insight into exactly which circuit elements are dominant in each performance characteristic.
is chapter focuses on the separation of eﬀects method as the primary analysis and design
tool with computer simulation as an aid in ﬁnal ﬁne tuning of designs. e separation method
follows the basic procedure:
1. e ampliﬁer midband performance properties are determined as described in Book 2 of
this text,
2. e pole locations that aﬀect low-frequency performance are separately determined,
3. e pole locations that aﬀect high-frequency performance are separately determined, and
4. e results of steps 1–3 are combined to form the total response characteristic.
As was seen in Chapter 9, midband gain and pole location are suﬃcient to determine a frequency
response characteristic.
After a short reminder on frequency distortion, the chapter discusses time-domain testing
of ampliﬁers through the step response. Since ampliﬁer performance characteristics are usually
only of interest between the 3-dB frequencies, the concept of dominant poles is explored. e
eﬀect of bias and coupling capacitors on low-frequency response is discussed for both simple BJT
and FET ampliﬁer stages. After modeling the high-frequency characteristics of diodes, BJTs, and
FETs, the high-frequency response of simple ampliﬁer stages is discussed. Multistage ampliﬁer
frequency response is determined through the cascading of the responses of the simple stages.
e frequency response of feedback ampliﬁers is discussed in Chapter 11.
10.1
FREQUENCY DISTORTION
In the previous chapters, transistor ampliﬁers were assumed to have constant gain-frequency re-
sponse over the desired frequency passband. ese ampliﬁers were described in the so-called
mid-band frequency range where external reactive elements and the reactive components of the

10.1. FREQUENCY DISTORTION
745
transistor small-signal model did not aﬀect the frequency domain properties of the ampliﬁer. e
gain of the ampliﬁer outside the mid-band frequency range is dependent on the reactive elements,
causing possible unequal gains for the frequency components of the input signal. is frequency
distortion is reﬂected in the gain-frequency (Bode) and phase-frequency plots of the ampliﬁer.
10.1.1 GAIN AND PHASE RESPONSE
In Section 9.2, a frequency response in the passband was shown to have no distortion when the
circuit transfer function is constant with respect to frequency and the phase shift induced by
the circuit is linear with respect to frequency. e gain of an ampliﬁer is reduced outside of the
mid-band. e gain-frequency curve is that of a band-pass ﬁlter.
Consider a single-pole high-pass function,
HHP.!/ D
1
1   j !L
!
;
(10.1)
where !L is the (lower) cutoﬀfrequency for the high-pass transfer function.
e magnitude and phase of the single-pole transfer function of Equation (10.1) are,
jHHP.!/j D
1
r
1 C
!L
!
2 ;
(10.2)
and
†HHP.!/ D tan 1 !L
!

:
(10.3)
e frequency response is shown on a Bode diagram in Figure 10.2.
When a single-pole system is excited with an input signal consisting of two sinusoids of
frequencies 0:5!L and 6!L (Figure 10.3a), the output (Figure 10.3b) is distorted due to the dif-
ference in gain and phase of the two input sinusoids.
Similar analysis may be performed to show frequency distortion in systems described by
single-pole low-pass transfer functions,
HLP.!/ D
1
1 C j !
!H
;
(10.4)
where !H is the (high) cutoﬀfrequency for the low-pass transfer function.
e magnitude and phase of the single-pole low-pass transfer function are
jHLP.!/j D
1
s
1 C
 !
!H
2 ;
(10.5)

746
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
0.01
0.1
1
10
40
30
20
10
0
H
)
in dB
(
HP
L
ω
ω
ω
(a)
θ (ω )
in degrees
0.01
0.1
1
10
0
20
40
60
80
90
L
ω
ω
(b)
Figure 10.2: (a) Magnitude of high-pass transfer function, (b) Phase of high-pass transfer function.
and
†HLP.!/ D   tan 1
 !
!H

:
(10.6)
Bode diagrams of Equations (10.5) and (10.6) are mirror images of Figure 10.2 with a high
cutoﬀfrequency of !H.
10.1.2 STEP AND PULSE RESPONSE
Signal distortion by an ampliﬁer can be classiﬁed into three general categories:

10.1. FREQUENCY DISTORTION
747
0
5
High Frequency Input
Low Frequency Input
Combined Output
10
15
20
2
1
0
1
2
t
V( )
t
(a)
High Frequency Input
Low Frequency Input
Combined Output
0
5
10
15
20
2
1
0
1
2
t
V( )
t
(b)
Figure 10.3: (a) Input signal of consisting of two sinusoids, (b) Resulting distorted output due to
high-pass transfer function.
1. If an ampliﬁer is linear but its amplitude response is not constant with frequency, the ampli-
ﬁer introduces amplitude distortion. e amount of amplitude distortion can be determined
from the frequency response of the ampliﬁer.
2. If an ampliﬁer is linear but its phase shift is not a linear function of frequency, it introduces
phase, or delay, distortion.
3. If an ampliﬁer is non-linear, non-linear distortion results; e.g., superposition can no longer
be used.
e step response provides information about all three types of distortion mentioned above.
erefore, the determination of the step response (pulse response testing is a subset of step re-
sponse) is a powerful test of ampliﬁer linearity.
A step voltage, shown in Figure 10.4, is a voltage signal that maintains a zero value for all
time t < 0 and a constant value V1 for all time t > 0. e transition between the two voltage levels

748
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
occurs at t D 0 and is ideally instantaneous. In real systems, the transition time from 0 to V1 is
accomplished in an arbitrarily small time interval that is signiﬁcantly smaller than the response
time of the circuit under test.
t
0
V1
Step Input
Figure 10.4: Step input voltage.
For a single-pole electronic circuit, the output voltage in the time domain is of the form,
vo D B1 C B2e t=;
(10.7)
where
vo is the output voltage,
B1 and B2 are constants, and
 is the time constant of the electronic circuit.
e constant B1 is the ﬁnal steady-state value of the output voltage as t ! 1. If the ﬁnal voltage
is deﬁned as Vf , then B1 D Vf . e constant B2 is determined by the initial voltage, Vi. At
t D 0; vo D Vi D B1 C B2, or B2 D Vi   Vf . erefore, the general solution for a single-pole
electronic circuit,
vo D Vf C
 Vi   Vf

e t=:
(10.8)
Low Pass Circuit Response
For a low-pass electronic circuit, the initial voltage Vi D 0 and the ﬁnal voltage Vf D V1.² e
output therefore is given by,³
vo D V1

1   e t=
;
(10.9)
where
 D
1
!H
:
(10.9a)
²In this discussion, only the time varying portion of the signal is considered: in order to obtain the total output signal, the
quiescent condition must be included.
³e relationship between Equation (10.4) and (10.9) is obtained through Laplace techniques.

10.1. FREQUENCY DISTORTION
749
e low-pass circuit step response is shown in Figure 10.5. e rise time, tr, is deﬁned as the
time it takes the voltage to rise from 0.1 to 0.9 of its ﬁnal value. e time required for vo to rise
to 0:1V1 is approximately 0:1 and the time to reach 0:9V1 is approximately 2:3. e diﬀerence
between these two time values is the rise time of the circuit, and is given by
tr D .2:3   0:1/ D 2:2:
(10.10)
0
0
0.2
0.4
0.6
0.8
1
t
vo
V1
0.9
0.1
tr
Figure 10.5: Low-pass circuit step response.
Since the time constant, , of a circuit is equal to the inverse of the low-pass cutoﬀfrequency in
radians, !H, Equation (10.10) can be related to the cutoﬀfrequency,
tr D 2:2 D 2:2
!H
D
2:2
2fH
 0:35
fH
:
(10.11)
us, the rise time is proportional to the time constant of the circuit and inversely proportional
to the cutoﬀfrequency.
A variant of the step input voltage is the pulse input shown in Figure 10.6. e low-pass
circuit response to a pulse is identical to that of the step response given in Equation (10.12) for
t < tp. At the end of the pulse .t D tp/, the output voltage is at a peak of Vp and must decrease
to zero with a time constant  for t > tp, as indicated in Figure 10.7. e output waveform is
distorted when compared to the input pulse waveform. In particular, the output waveform extends
well beyond the pulse width.
To minimize pulse distortion, the rise time must be small compared to the pulse width.
If the cutoﬀfrequency, fH, is chosen to be 1=p, then the rise time is tr D 0:35tp. e output
voltage for this case is shown in Figure 10.8. A rule of thumb that may be used with regards to
pulse response is: a pulse shape will be preserved if the cutoﬀfrequency is greater than the reciprocal of
the pulse width.

750
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
t
0
V1
Pulse Input
t p
Figure 10.6: Pulse input voltage.
vo
0
tp
t
vi
V
=
p
V1
v
V e
o
p
−(t−tp)/τ
Figure 10.7: Low-pass circuit pulse response.
High-Pass Circuit Response
From Equation (10.8), the time domain response of the high-pass circuit has an initial voltage
Vi D V1 and a ﬁnal voltage Vf D 0. erefore, the output voltage of the high-pass circuit is that
of a decaying exponential,
vo D V1e t=;
(10.12)
where, in this case  is related to the lower cutoﬀfrequency:
 D 1
!L
:
(10.12a)
e input and output voltages are shown in Figure 10.9. e output voltage is 0.61 of its initial
value at 0:5, 0.37 at 1:0, and 0.14 at 2:0. e output is nearly decayed to 5% of the peak voltage
after 3:0, and less than 1% if t > 5:0.
For a pulse with tp small compared to the time constant , the output response is shown in
Figure 10.10. e output at t D tp is vo D V1e tp= D Vp. Since Vp is less than V1, the voltage
becomes negative and decays exponentially to zero. For t > tp, the output voltage is,
vo D V1

e tp=   1

e .t tp/=:
(10.13)

10.1. FREQUENCY DISTORTION
751
V 1
0
t
t
p
vi
vo
0.9 V1
0.1 V1
=0.35 tp
tr
 
Figure 10.8: Low-pass pulse response with short time constant for fH D
1
p .
V1
0
vo
t
Figure 10.9: High-pass circuit step response.
Note that the distortion in the pulse caused by the high-pass circuit has resulted in a tilt to
the top of the pulse and an undershoot at the end of the pulse. e percent tilt or sag in time tp
is approximately
vo  V1

1   t


:
(10.14)
If Figure 10.9 is re-drawn for tp  , shown in Figure 10.11, the tilt in the output voltage is clear.
e percent tilt or sag in time t1 is,
sag D V1   Vp
V1
 100 D tp
  100%:
(10.15)
Equation (10.15) is valid for the tilt of each half cycle of a symmetrical square wave with peak-
to-peak voltage of V1 and a period T D 2tp. If fsq D 1=Tsq is the frequency of the square wave,

752
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
0
0
t
V1
t p
vo
Vp
Figure 10.10: High-pass circuit pulse response.
V1
0
vo
t
Vp
t p
v i
vo
 
 
Figure 10.11: Tilt in step or pulse response due to high-pass circuit.
the sag may be expressed as,
sag D Tsq
2  100 D
1
2fsq  100 D fL
f
 100%:
(10.16)
e tilt is then directly proportional to the cutoﬀfrequency, fL.
Example 10.1
Find the single-pole unity gain frequency response required for 10% sag at 1 kHz.

10.2. DOMINANT POLES
753
Solution:
Using Equation (10.16), the cutoﬀfrequency of the high-pass transfer function is deter-
mined:
fL D sag
100
f


D 10.1000/
100 
D 31:85 Hz:
e cutoﬀfrequency must not exceed 31.85 Hz for the desired sag. erefore, the transfer function
from Equation (10.1) is,
HHP.!/ D
1
1   j !L
!
D
1
1   j 2.31:85/
!
D
1
1   j 200
!
:
10.2
DOMINANT POLES
e location of the high or low cutoﬀfrequency for electronic circuits with more than one pole
(and zero) becomes increasingly diﬃcult to ﬁnd analytically as the number of poles increases.
Computer software packages with an equation solver, such as MathCAD, or advanced engineer-
ing and scientiﬁc calculators with the equation solver capabilities may be required to ﬁnd the
cutoﬀfrequency. However, it may be desirable to use simple formulas and approximations that
yield the cutoﬀfrequencies when initially designing a circuit.
e dominant pole approximation simply ignores second-order eﬀects of poles (and zeros)
that are far removed from the pole that dominates in the calculation for the cutoﬀfrequency
of the electronic circuit. e low cutoﬀfrequency of a high-pass response is dominated by the
largest pole in the transfer function; whereas the high cutoﬀfrequency of a low-pass response is
dominated by the smallest pole. When circuits are designed with dominant poles, the analysis
of the cutoﬀfrequencies becomes considerably simpler. Non-dominant poles and zeros must be
carefully analyzed in some instances that may aﬀect circuit stability, such as in feedback ampliﬁers
and oscillators. Stability issues in feedback ampliﬁers are discussed in Chapter 11.
10.2.1 LOW CUTOFF FREQUENCY (HIGH PASS)
e general form of the transfer function of a low-frequency response is,
HHP.!/ D .j! C !z1/.j! C !z2/ : : : .j! C !zn/
.j! C !p1/.j! C !p2/ : : : .j! C !pn/;
(10.17)
where !z1; : : : ; !zn the frequencies for the low-frequency zeros of the response,
and !p1; : : : ; !pn the frequencies for the low-frequency poles of the response.
If a midband region exists, the number of poles must equal the number of zeros. e highest pole
frequency is !p1 and subsequent poles are ordered such that !p1  !p2  !p3  : : :  !pn. As
! approaches midband frequencies, HHP.!/ approaches unity.

754
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
In designing a circuit, the zeros are placed at very low frequencies so that they do not
contribute appreciably to the determination of the low cutoﬀfrequency. A dominant pole, say
!p1, has a much higher frequency than the others. In this case, the transfer function in Equa-
tion (10.17) can be approximated as a ﬁrst-order high-pass response,
HHP.!/ 
j!
.j! C !p1/:
(10.18)
e approximate transfer function implies that the ampliﬁer low cutoﬀfrequency is dominated
by a pole at j! D  !p1, and that the low cutoﬀfrequency is approximately
!1  !p1:
(10.19)
As a rule of thumb, the dominant pole approximation can be made if the highest frequency pole
is separated from the nearest pole or zero by a factor of four.
If a dominant pole does not exist, a complete Bode plot may have to be constructed to
determine the low cutoﬀfrequency. Alternately, approximate formulas may be used to determine
the location of the low cutoﬀfrequency. For instance, a frequency response with two poles and
two zeros has a transfer function of the form,
HHP.!/ D .j! C !z1/.j! C !z2/
.j! C !p1/.j! C !p2/:
(10.20)
e squared magnitude of the transfer function is,
jHHP.!/j2 D .!2 C !2
z1/.!2 C !2
z2/
.!2 C !2
p1/.!2 C !2
p2/:
(10.21)
e low cutoﬀfrequency is deﬁned by jHHP.!l/j2 D 1=2. erefore, Equation (10.21) becomes,
1
2 D .!2
l C !2
z1/.!2
l C !2
z2/
.!2
l C !2
p1/.!2
l C !2
p2/
D
1 C
 
1
!2
l
!
 !2
z1 C !2
z2

C
 
1
!4
l
!
 !2
z1!2
z2

1 C
 
1
!2
l
! 
!2
p1 C !2
p2

C
 
1
!4
l
! 
!2
p1!2
p2
:
(10.22)
Equation (10.22) is simpliﬁed by assuming that the zeros are signiﬁcantly smaller than the low
cutoﬀfrequency,
1
2 
1
1 C
 
1
!2
l
! 
!2
p1 C !2
p2

C
 
1
!4
l
! 
!2
p1!2
p2
:
(10.23)

10.2. DOMINANT POLES
755
Solving for !l using the quadratic equation yields,
!l D
!p1
s
 .1 C k2/ C
p
.1 C k2/2 C 4k2
2
;
(10.24)
where !p1 D k!p2.
A plot of Equation (10.24) is shown in Figure 10.12, clearly showing that for k > 4, the
dominant pole frequency is within 5.4% of the low cutoﬀfrequency.
1
2
3
4
5
6
7
8
9
10
1
1.1
1.2
1.3
1.4
1.5
1.6
L
p1
k
ω
ω
Figure 10.12: Low cutoﬀfrequency as a function of the ratio of pole locations.
If the zeros cannot be ignored, Equation (10.22) can be solved by using the approximation
that !L is greater than all of the poles and zeros. By neglecting the terms containing 1=!4
L, the
low cutoﬀfrequency is approximately,
!L 
q
!2
p1 C !2
p2   2!2
z1   2!2
z2:
(10.25)
Equation (10.25) can be extended to any number of poles and zeros; that is,
!L 
q
!2
p1 C !2
p2 C    C !2pn   2!2
z1   2!2
z2        2!2zn:
(10.26)
If a dominant pole exists, Equations (10.25) and (10.26) reduce to Equation (10.19).
10.2.2 LOW-PASS RESPONSE
e general form of the transfer function of a high-frequency response is,
HLP.!/ D

1 C j!
!z1
 
1 C j!
!z2

: : :

1 C j!
!zn


1 C j!
!p1
 
1 C j!
!p2

: : :

1 C j!
!pn
;
(10.27)

756
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
where !z1; : : : ; !zn the frequencies for the high-frequency zeros of the response,
and !p1; : : : ; !pn the frequencies for the high-frequency poles of the response.
If a midband region exists, the number of poles must be greater than or equal to the number
of zeros. e lowest pole frequency is !p1 and subsequent poles are ordered such that !p1  !p2 
!p3      !pn. As ! approaches midband frequencies, HLP.!/ approaches unity.
In designing a circuit, the zeros are placed at very high frequencies so that they do not con-
tribute appreciably to the determination of the high cutoﬀfrequency. A dominant pole, say !p1,
has a much low-frequency than the others. In this case, the transfer function in Equation (10.17)
can be approximated as a ﬁrst order high-pass response,
HLP .!/ 
1

1 C j!
!p1
:
(10.28)
e approximate transfer function implies that the ampliﬁer high cutoﬀfrequency is dominated
by a pole at j! D  !p1, and that the high cutoﬀfrequency is approximately
!H  !p1:
(10.29)
As a rule of thumb, the dominant pole approximation can be made if the lowest frequency pole
is separated from the nearest pole or zero by a factor of four.
If a dominant pole does not exist, approximate formulas may be used to determine the
location of the high cutoﬀfrequency. For instance, a frequency response with two poles and two
zeros has a transfer function of the form,
HLP.!/ D

1 C j!
!z1
 
1 C j!
!z2


1 C j!
!p1
 
1 C j!
!p2
:
(10.30)
An approximate formula for the high cutoﬀfrequency can be derived in a manner similar to that
used above to determine the low cutoﬀfrequency. e high cutoﬀfrequency is,
!H D !p1
v
u
u
t  .1 C k2/ C
q
.1 C k2/2 C 4k2
2
;
(10.31)
where
!p1 D !p2=k:
Figure 10.12 can be used to show that for k  4, the dominant pole frequency, !p1, is within
5.4% of the high cutoﬀfrequency.

10.3. EFFECTOFBIASANDCOUPLINGCAPACITORSONLOW-FREQUENCYRESPONSE
757
If the zeros cannot be ignored, !H is approximately,
!H 
1
s
1
!2
p1
C
1
!2
p2
 2
!2
z1
 2
!2
z2
:
(10.32)
Equation (10.32) can be extended to any number of poles and zeros; that is,
!H 
1
s
1
!2
p1
C
1
!2
p2
C    C 1
!2pn
 2
!2
z1
 2
!2
z2
       2
!2zn
:
(10.33)
If a dominant pole exists, Equations (10.32) and (10.29) reduce to Equation (10.29).
10.3
EFFECT OF BIAS AND COUPLING CAPACITORS ON
LOW-FREQUENCY RESPONSE
As mentioned in the preface to this chapter, the low-frequency response is separately determined
by analyzing the eﬀects of bias and coupling capacitors on the circuit. In this section, the methods
for determining BJT and FET ampliﬁer low cutoﬀfrequency are shown.
10.3.1 BJT LOW-FREQUENCY RESPONSE
Common-emitter Ampliﬁer
A single stage common-emitter ampliﬁer with input and output coupling capacitors is shown in
Figure 10.13a. e small-signal equivalent model of the circuit is shown in Figure 10.13b.
In performing the analysis, it is convenient to assume that h 1
oe is very large. With this
assumption, the small-signal circuit shows that there is little interaction between the coupling
capacitors. e poles can be found by determining the output voltage and input current of the
ampliﬁer.
e input impedance is of the small-signal equivalent of Figure 10.13b is,
Zi D Rin C RS C
1
j!C1
D

RB==
 hie C
 1 C hfe

RE

C RS C
1
j!C1
:
(10.34)
e input current to the circuit is the ratio for the input voltage to the input impedance,
ii D
vi
Rin C RS C
1
j!C1
;
(10.35)

758
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
s
R
1
C
2
C
L
R
E
R
C
R
CC
+V
B2
R
B1
R
iv
ov
(a)
s
R
iZ
in
R
1
C
2
C
E
R
B
R
B1
=R
B2
R
C
R
L
R
+
_
+
_
iv
ie
h
fe
h
bi
oe
h
-1
ii
bi
ov
(b)
Figure 10.13: (a) Common-emitter ampliﬁer with input and output coupling capacitors, (b) Small-
signal equivalent circuit.
and the base current is,
ii D
viRB
RB C hie C
 1 C hfe

RE
j!C1
1 C j!C1 .Rin C RS/
D
vi
hie C
 1 C hfe

RE
j!RinC1
j!C1 .Rin C RS/ C 1
D
viRinC1

hie C
 1 C hfe

RE

!p1

j!
j! C !p1

;
(10.36)

10.3. EFFECTOFBIASANDCOUPLINGCAPACITORSONLOW-FREQUENCYRESPONSE
759
where the one of the pole locations is,
!p1 D
1
C1
˚
RS C

RB==

hie C
 1 C hfe

RE
	:
(10.37)
e output voltage of the ampliﬁer is,
vo D  hfeibRCRL
RC C RL C
1
j!C2
D  hfeibRO
j!
j! C !p2
;
(10.38)
where the other pole is at,
!p2 D
1
C2 .RC C RL/:
(10.39)
Inspection of the pole frequencies shows that the poles are determined by the capacitor
multiplied by the resistive discharge path. is is merely the time constant of the circuit.
at is, the discharge path for C1 is through the resistance RS C fRB==Œhie C .1 C
hfe/REg and discharge path for C2 is through the resistance RC C RL. erefore, the poles can
be found by simply determining the time constant of that portion of the ampliﬁer circuit being
analyzed. From the bias conditions and selection of the two capacitor values, the dominant pole
can be established by one of the capacitors.
Common-Emitter Ampliﬁers with Emitter-Bypass Capacitors
e simple analysis described above cannot be accurately used for a common-emitter ampliﬁer
with emitter-bypass capacitor shown in Figure 10.14a due to the interaction of the capacitors C1
and CE. By studying the small-signal equivalent in Figure 10.14b, it becomes obvious that there
is some interaction between the input coupling capacitor and the emitter-bypass capacitor.
In performing the analysis, it is again convenient to assume that h 1
oe is very large. To ﬁnd
the pole locations, nodal analysis is carried out using frequency domain equivalent impedances.
e current gain Ai.!/, is found by nodal analysis:
IS D vi
RS
D v1
RS
C j!C1 .v1   v2/
(10.40a)
j!C1 .v1   v2/ D v2
RB
C .v2   v3/
hie
(10.40b)
.v2   v3/
hie
C hfeib D v3

j!CE C
1
RE

(10.40c)
0 D hfeib C v4
RC
C v4
j!C2
RLC2 C 1:
(10.40d)
e small-signal base current is,
ib D .v2   v3/
hie
:
(10.41)

760
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
s
R
1
C
2
C
L
R
E
R
E
C
C
R
CC
+V
B2
R
B1
R
iv
ov
(a)
s
R
1
C
2
C
E
R
E
C
B
R
C
R
L
R
+
_
+
_
iv
1v
3v
2v
4v
ie
h
fe
h
bi
oe
h
-1
bi
ov
(b)
Figure 10.14: (a) Common-emitter ampliﬁer with emitter-bypass capacitor, (b) Small-signal equiv-
alent circuit.
e output current is,
io D
j!C2v4
j!RLC2 C 1:
(10.42)
e solution to the nodal equations in Equation (10.40) for the current gain is,
Ai.!/ D io
iS
D
 Aim.j!/2

j! C
1
RECE


j! C
1
.RL C RC/C2

Œ.j!/2 C j!a2 C a1
;
(10.43)

10.3. EFFECTOFBIASANDCOUPLINGCAPACITORSONLOW-FREQUENCYRESPONSE
761
where
a2 D
RB C hie
C1
C .RB C RS/

hie C
 1 C hfe

RE

C RSRB
RECE
RBRS C hie .RB C RS/
(10.44a)

1
C1 .RS C hie/ C
hfe
CE .RS C hie/;
RB  RS; hie
a1 D
RB C hie C
 1 C hfe

RE
RECEC1 ŒRBR1 C hie .RB C RS/
(10.44b)

RB C
 1 C hfe

RE
RBRE .RS C hie/ C1CE
;
RB  RS; hie;
and Aim is the midband current gain with all capacitors shorted,
Aim D
hfe .RS==RB/ .RC/
Œ.RS==RB/ C hie .RC C RL/ 
hfeRS
RS C hie

RC
RC C RL

;
(10.44c)
for RB  Rs.
As expected, the order of the numerator and denominator are the same: three zeros and
three poles. It is evident from the above equations that, as expected, the output coupling capacitor,
C2, does not interact with the emitter-bypass capacitor, CE, and the input coupling capacitor, C1,
since C2 does not appear in Equation (10.44) and contributes a pole in Equation (10.43). From
Equation (10.44a) and (10.44b), a strong interaction between C1 and CE is evident.
e three capacitor values can be manipulated to design a circuit with a speciﬁc low cutoﬀ
frequency, !l. Since C2 contributes its own pole and does not interact with the other capacitors,
the diﬃculty in determining the pole locations does not rest with this capacitor value. e pole
location due to C2 can be designed to be signiﬁcantly lower than the chosen dominant pole. e
other two poles are a complex interaction of C1 and CE. e zero location due to 1=RECE must
be signiﬁcantly smaller than the low cutoﬀfrequency. e two remaining pole locations are found
by making the following approximations:
.j!/2 C j!a2 C a1 D
 j! C !p1
  j! C !p2

;
where !p1  !p2
 .j! C a2/

j! C a1
a2

;
where a2  a1
a2
:
(10.45)
e pole locations due to the interacting C1 and CE are found from Equations (10.43)
and (10.45),
!p1  a2 
1
.RS C hie/
 
1
C1
C
 1 C hfe

CE
!
(10.46)

762
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
and
!p2  a1
a2

RB C
 1 C hfe

RE
RBRE

CE C
 1 C hfe

C1
:
(10.47)
In designing a circuit with a speciﬁc low cutoﬀfrequency, it is suggested that the cutoﬀ
frequency equal !l  !p1  a2, and select the values for C1 and CE. e value for C2 can be
designed to be signiﬁcantly lower than the dominant pole. Since one end of the emitter-bypass
capacitor, CE is ground, a large value chemical capacitor (electrolytic or tantalum) can be used.
In doing so, a suggested value of CE is,
CE  .hfe C 1/C1;
(10.48)
which allows for the solution for C1 using Equation (10.46) and !l  !p1  a2,
C1 
2
!l .RS C hie/:
(10.49)
With the C1 and CE established, the !p2 can be found,
!p2 D RB C
 1 C hfe

RE
2hFERBREC1
:
(10.50)
e pole location due to C2 is ﬁxed at !p3  !l,
!p3 D
1
.RC C RL/ C2
 !l
10:
(10.51)
erefore, the output-coupling capacitor value is:
C2 
10
!l .RC C RL/:
(10.52)
Example 10.2
Complete the design for the common-emitter ampliﬁer shown below for a low cutoﬀfrequency
of 40 Hz. Find the midband gain. From the quiescent point, the following parameters were de-
termined: hfe D 200; hie D 34:7 k.

10.3. EFFECTOFBIASANDCOUPLINGCAPACITORSONLOW-FREQUENCYRESPONSE
763
1
C
2
C
L
R
10 kΩ
10 kΩ
3.9kΩ
22 kΩ
180 kΩ
E
R
E
C
C
R
CC
+V
=12
B2
R
B1
R
iv
ov
Solution:
e midband gain is easily found from the midband small-signal model,
Avm D  hfe .RC==RL/
hie
D  200.5000/
34:7 k
D  28:8:
Equation (10.49) yields the value for C1,
C1 
2
!l .hie/ D
2
2 .40/ .34:7 k/  0:22 F:
Using Equation (10.48), the value of the emitter-bypass capacitor is,
CE  hfeC1 D 200.0:22 / D 44 F ) 47 F (standard value):
Lastly, Equation (10.52) yields,
C2 
10
!l .RC C RL/ D
10
2.40/.20 k/  2 F ) 2:2 F(standard value):
e values of the capacitors are consistent with a dominant pole response.
Although the exact analysis above will yield accurate results, it may be preferable in design
to use approximate relationships using a simpliﬁed approach. e simpliﬁed approach consists
of assuming that the capacitances do not interact. e pole corresponding to each capacitor is
determined with the other capacitors shorted: that is, e pole location corresponding to each
capacitor is determined by ﬁnding the resistance in its discharge path.
For the common-emitter ampliﬁer with coupling and bypass capacitors, the poles corre-
sponding to C1 and C2 have been solved above in the analysis for the common-emitter ampliﬁer
with input and output capacitors (Equations (10.37) and (10.39)). e voltage gain of the circuit

764
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
with C1 and C2 shorted yields the frequency dependent eﬀects of the emitter-bypass capacitor.
e base current is then,
ib D
vi
hie C
 hfe C 1
 
RE==
1
j!CE
;
(10.53)
where
1
j!CE is the impedance of the emitter-bypass capacitor. e output voltage is,
vo D  hfeib .RC==RL/ :
(10.54)
Substituting Equation (10.53) into (10.54) yields the voltage gain,
Av.!/ D vo
vi
D
 hfe.RC==RL/

1 C
1
j!RECE

hie

1 C
1
j!RECE

C
 1 C hfe

j!CE
:
(10.55)
With the capacitor shorted, the midband gain is found,
Av D vo
vi
D  hfe .RC==RL/
hie
:
(10.56)
e gain is therefore,
Av.!/ D
Avm

j! C
1
RECE

j! C
 1
RE
C hfe C 1
hie
 1
CE
:
(10.57)
e pole due to CE is therefore,
!P 3 D
 1
RE
C hfe C 1
hie
 1
CE
:
(10.58)
e pole in Equation (10.58) is then designed to be signiﬁcantly smaller than !p1 and !p2 in
Equations (10.37) and (10.39) to complete the simpliﬁed design approach: that is, CE is chosen
so that !p3  !p1; !p2.
In integrated circuit design, it is undesirable to have large coupling and bypass capacitors
since they require large chip area. Since most integrated circuit ampliﬁers use constant current
source biasing schemes and are commonly DC coupled in a diﬀerential ampliﬁer conﬁguration, a
low cutoﬀfrequency does not exist. is implies that DC signals are ampliﬁed by these circuits.

10.3. EFFECTOFBIASANDCOUPLINGCAPACITORSONLOW-FREQUENCYRESPONSE
765
2
C
L
R
E
R
C
R
CC
+V
B2
R
B1
R
s
R
1
C
iv
ov
(a)
B
R
1
C
2
C
E
R
C
R
L
R
+
_
+
_
S
R
iv
ie
h
fe
h
bi
bi
ov
(b)
Figure10.15: (a) Common-base ampliﬁer with input and output coupling capacitors, (b) Small-signal
equivalent circuit.
Common-Base Ampliﬁer
Figure 10.15 shows a common-base ampliﬁer and its small-signal equivalent. e analysis and
design procedure follows that of the common-emitter ampliﬁer.
In performing the analysis, it is again convenient to assume that h 1
oe is very large. With this
assumption, the small-signal circuit shows that there is little interaction between the coupling
capacitors. erefore, the pole locations due to each capacitor can be independently calculated.
e discharge path for C1 is through the resistance
RS C
 1 C hfe

RE== Œhie C RB

:
erefore, the pole due to C1 is,
!p1 D
1
C1
˚
RS C
 1 C hfe

RE== Œhie C RB
	:
(10.59)

766
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
e discharge path for C2 is through the resistance RC C RL. erefore, the pole due to C2 is,
!p2 D
1
C2 .RC C RL/:
(10.60)
From the bias conditions and selection of the two capacitor values, the dominant pole can be
established by one of the capacitors.
e simple analysis described above cannot be accurately used for a common-base ampliﬁer
with base-bypass capacitor, CB from the base to ground, due to the interaction of the capacitors
C1 and CB. For this circuit, the analysis is similar to that performed for the common-emitter
ampliﬁer with emitter bypass capacitor is required. However, if an exact solution to the poles is
not required, a simpliﬁed approach similar to that shown for the common-emitter ampliﬁer with
emitter-bypass capacitor may be used, where the pole determined by CB is signiﬁcantly smaller
than the other two poles found in Equations (10.59) and (10.60). at is, the pole due to CB may
be ignored since !RBCB  1.
10.3.2 FET LOW-FREQUENCY RESPONSE
A single stage common source enhancement NMOSFET ampliﬁer with input and output cou-
pling capacitors and source-bypass capacitor is shown in Figure 10.16a. e small-signal equiva-
lent model of the circuit is shown in Figure 10.16b.
In performing the analysis, it is convenient to assume that rd is large compared to the
output load and that the impedance of the dependent current source is also very large. With these
assumptions, the small-signal circuit shows that there is little interaction between the coupling
and bypass capacitors due to the large input resistance inherent in FETs. erefore, the pole
locations due to each capacitor can be independently calculated.
e discharge path for C1 is through the resistance, RG C Ri. erefore, the pole due to
C1 is,
!p1 D
1
C1 .RG C Ri/:
(10.61)
When C2 and CS are shorted, the transfer function of the ampliﬁer due to C1 is,
Av1.!/ D
Avm .j!/
j! C
1
C1 .RG C Ri/
;
(10.62)
where Avm is the midband gain of the ampliﬁer. e midband gain of the ampliﬁer is found by
analyzing the circuit with all capacitors shorted. e midband gain is,
Avm D  gmRG .RD C RL C rd/
Ri C RG
:
(10.63)

10.3. EFFECTOFBIASANDCOUPLINGCAPACITORSONLOW-FREQUENCYRESPONSE
767
2
C
L
R
S
S
R
D
R
CC
+V
G2
R
G1
R
iR
1
C
iv
ov
C
(a)
iR
o
R
1
C
2
C
S
R
S
C
G
R
G1
=R
G2
R
D
R
L
R
+
_
+
_
+
_
iv
gs
v
m
g
gs
v
dr
ov
(b)
Figure 10.16: (a) Common source ampliﬁer, (b) Small-signal equivalent circuit.
e discharge path for C2 is through the resistance RL and the parallel combination of RD and
the Ro. erefore, the pole due to C2 is,
!p2 D
1
C2 ŒRL C ŒRD==Ro D
1
C2 ŒRL C ŒRD== .rd C .1 C gmrd/ RS/:
(10.64)
When C1 and CS are shorted, the transfer function of the ampliﬁer due to C2 is,
Av2 .!/ D
Avm .j!/
j! C
1
C2 ŒRL C ŒRD== .rd C .1 C gmrd/ RS/
;
(10.65)

768
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
When C1 and C2 are shorted, the transfer function of the ampliﬁer due to CS is,
Av3.!/ D
Avm

1
RSCS

j! C rd C .RD==RL/ C .1 C gmrd/ RS
RSCS Œrd C .RD==RL/
:
(10.66)
erefore, the pole location due to CS is,
!pS D rd C .RD==RL/ C .1 C gmrd/ RS
RSCS Œrd C .RD==RL/
:
(10.67)
It is typical to let C1 or C2 establish the dominant pole. e value for CS can be designed so that
!pS is signiﬁcantly lower than the dominant pole frequency. Since one end of the emitter-bypass
capacitor, CS is ground, a large value chemical capacitor (electrolytic or tantalum) can be used.
Because of the inherently large input resistance of the FET, the common gate and common
drain ampliﬁer analysis and design procedures follow that of the common source ampliﬁer: in all
cases, each pole location is determined by calculating the pole location for each capacitor while
the others are shorted since the capacitors do not interact to establish the poles.
10.4
HIGH-FREQUENCY MODELS OF THE BJT
Analysis of the response of BJT circuits at high frequencies is based on accurate modeling of
the frequency dependent performance of transistors. e dominant model used for small-signal
analysis of a BJT in the forward-active region, the h-parameter model as presented in 3 (Book 1)
does not contain frequency sensitive elements and is therefore invariant with respect to changes
in frequency. It is therefore necessary to introduce a new BJT model or to reinterpret an old
model to include frequency-dependent terms. Once again, the Ebers-Moll model provides an
excellent basis for creation of a simpler model in the forward-active region. In this modeling pro-
cess, it is necessary to begin with a slight variation of the Ebers-Moll model that was presented
in 3 (Book 1). As is shown in Figure 10.17, this presentation has added an additional base resis-
tance of small value, rb, to model the parasitic bulk resistance between the physical base terminal
contact and the active base region⁴ and a large output resistance, ro, to model reduced output
resistance due to early voltage .VA/ eﬀects.
In the forward-active region and at low frequencies the Ebers-Moll Model of Figure 10.17
can be replaced by the linear two-port model shown in Figure 10.18. is model is known as the
hybrid- model. It is similar to the h-parameter model used previously in this text, but has partic-
ular utility when frequency-dependent terms are included. Also of particular interest is the direct
correlation between the individual hybrid- impedances and the corresponding circuit elements
in the Ebers-Moll model.
⁴Many models also include parasitic bulk resistances in series with the emitter and collector terminals. ese two resistances
typically have a much smaller eﬀect on ampliﬁer performance than rb and therefor will be ignored (assumed to be zero) in the
presentation provided here.

10.4. HIGH-FREQUENCY MODELS OF THE BJT
769
B
E
C
or
br
B
I
R
I
F
I
C
I
E
I
F
α
F
I
R
α
R
I
▼
▼
Figure 10.17: e Ebers-Moll model of a BJT.
r
B
E
C
or
+
_
br
r
V
V
m
g
µ
Figure 10.18: Low-frequency Hybrid-BJT model.
e resistances rb and ro are directly carried from one model to the other, while r and r are
the forward resistance of the base-emitter junction and the reverse resistance of the base-collector
junction respectively.
e relationships between h-parameter and hybrid- models can be obtained by appli-
cation of the two-port parameter tests as was performed (albeit on the Ebers-Moll model) in
Section 5.2 (Book 2).
e base-collector junction reverse resistance is extremely large .r > 20 M/ and is typ-
ically ignored (left as an open circuit) the model. e simpliﬁed hybrid- parameters are related
to the h-parameter model parameters by:

770
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
gm D hfe
r
D jIcj
Vt
r D ˇF
Vt
jIcj D ˇF
gm
;
ro  1
hoe
D jVAj
jIcj
rb D hie   r:
(10.68)
As will be seen in Section 10.7, the hybrid- model is also useful in modeling FETs.
In addition to the modeling these purely resistive, second-order, low-frequency eﬀects, the
diodes of the Ebers-Moll model are replaced by more complex, frequency-dependent models.
e frequency-dependent component of transistor behavior is based on the capacitive component
of p-n junction impedance. Once the capacitive nature of a p-n junction is known, a frequency
dependent model for a BJT can be obtained.
10.4.1 MODELING A P-N JUNCTION DIODE AT HIGH FREQUENCIES
In the semiconductor region near a p-n junction under a voltage bias, there is a signiﬁcant buildup
of electrical charge on each side of the junction. Since this charge buildup is dependent on the
voltage applied across the junction, there is a capacitance associated with the junction. is ca-
pacitance is strongly dependent on the doping densities of the two semiconductor regions and
the geometry of the junction. It is modeled as a capacitor shunting the dynamic resistance of the
junction (Figure 10.19).
dr
i
C
▼
Figure 10.19: High-frequency model of a p-n junction.
In most electronic applications the p-n junction capacitance is dominated by the diﬀusion
of carriers in the depletion regions. A good analytic approximation of this depletion capacitance,
Cj, is given by:
Cj 
Cjo

1   Vd
 o
m ;
(10.69)
where,
Cjo
D small-signal junction capacitance at zero voltage bias,
 o
D junction built-in potential, and
m
D junction grading coeﬃcient .0:2 < m  0:5/.

10.4. HIGH-FREQUENCY MODELS OF THE BJT
771
While theoretical derivations are possible for each of the capacitance parameters, it is more
common in practice to determine these parameters empirically. A plot the junction capacitance
as described by Equation (10.69) is shown in Figure 10.20. is expression is very accurate for
reverse biased junctions and for forward biased junctions where the junction current is small. In
most electronic applications, it provides an adequate level of modeling.⁵
Notice that the junction capacitance under reverse-biased conditions exhibits small varia-
tion while under forward-biased conditions it increases dramatically with bias voltage.
dV
jC
oѱ
jo
C
Figure 10.20: p-n junction depletion capacitance.
Example 10.3
If the zero-bias capacitance of a p-n junction is 5 pF and the built-in potential,  o, is 640 mV,
determine the junction capacitance at junction voltages
Vd D  20 V;  10 V;  5 V;  1 V; 0:3 V; 0:6 V:
Assume the junction grading coeﬃcient has value, m D 0:40.
Solution
Equation (10.69) yields:
Cj 
5 pF

1   Vd
0:64
0:40 :
e tabulated results are:
⁵High forward current modeling requires two modiﬁcations. Equation (10.69) indicates inﬁnite capacitance at the built-in
potential: in actuality, the depletion capacitance decreases slightly for voltages above the built-in potential. An additional
capacitance term, the carrier diﬀusion capacitance, must also be included. is term is directly proportional to diode current.

772
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
Vd D
 20 V
Cj D
1.25 pF
 10 V
1.62 pF
 5 V
2.09 pF
 1 V
3.43 pF
0:3 V
6.44 pF
0:6 V
15.2 pF
e small variation in the junction capacitance for a wide range of negative bias is evident.
10.4.2 MODELING THE BJT AT HIGH FREQUENCIES IN THE
FORWARD-ACTIVE REGION
In order to model the BJT at high frequencies, the hybrid- model of Figure 10.18 is altered
by shunting each p-n junction dynamic resistance with an appropriate junction capacitance. is
alteration is shown in Figure 10.21. Here, the base-emitter junction has been modeled by a capac-
itor, C, in parallel with the junction forward resistance, r. Similarly, the base-collector junction
has been modeled by a capacitor, C.r  1/.
µ
C
̟
C
B
E
C
or
+
_
br
̟r
̟
V
̟
V
m
g
Figure 10.21: e high-frequency hybrid- model of a BJT.
Determination of the values of the two junction capacitances for a particular transistor is
necessary in order to complete the modeling process. While it is possible to analytically determine
these capacitances from the physical dimensions and properties of and individual transistor, it is
quite common to determine the values experimentally. e base-collector junction is reverse bi-
ased when the BJT is in the forward-active region, hence the junction capacitance, C, is relatively
independent of quiescent conditions. Typical manufacturer data sheets provide a value for C at a
given reverse bias (typically, VCB D 5 or 10 V): further discussions of C in this text will consider
it to be constant at the manufacturer’s supplied value.⁶ e forward-biased base-emitter junction
⁶C exhibits the same variation with junction bias as is given in Equation (10.69). If data is available to determine the built-in
potential,  o, and the junction grading coeﬃcient, m, the values should be used to determine a better approximation for C.

10.4. HIGH-FREQUENCY MODELS OF THE BJT
773
exhibits greater variation with bias conditions: its junction capacitance, C, must therefore be
determined with greater caution.
e value of the base-emitter junction capacitance, C, for a BJT is usually determined
through a measurement of the variation with frequency of the BJT short-circuit current gain.
e transistor is placed in a test ﬁxture as shown in Figure 10.22. e term “short-circuit” applies
to the collector-emitter port of the BJT which appears, in an ac sense, to be a short circuit. A plot
of the current gain frequency response is then determined experimentally.
CE
V
bi
ci
bi
Figure 10.22: Measurement of the short-circuit current gain.
In order to correlate these measurements with the hybrid- parameters, an ac equivalent
circuit of the test circuit must be created (Figure 10.23).
µ
C
C
B
E
C
or
ci
bi
+
_
br
r
V
V
m
g
̟
̟
̟
̟
Figure 10.23: Short-circuit current gain AC equivalent circuit.
e current gain is found to be:
AI.!/ D ic.!/
ib.!/ D
 ic
V
 V
ib

;
(10.70)
or:
AI.!/ D .gm/
 
r
1 C j!r
 C C C

!
D
hfe
1 C j!r
 C C C
:
(10.71)

774
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
is current gain expression is in the form of a single-pole low-pass frequency response. e
transistor short-circuit current gain has a low-frequency value of hfe and a 3-dB frequency of:
!3dB D
1
r
 C C C
:
(10.72)
A more common description of the results of Equation (10.71) depends on at the frequency at
which the current gain is unity, !T ,
!T D
hfe   1
r
 C C C
 
gm
C C C
:
(10.73)
is unity-gain frequency, !T , is often referred to as the gain-bandwidth product: the product
of short-circuit current gain at a particular frequency and that frequency has constant value for
all frequencies greater than !3dB. Manufacturer’s data sheets will either provide a value for !T or
provide the gain at some other high frequency. e gain-bandwidth is given by:
!T D Am!m;
(10.74)
where !m is the frequency at which the manufacturer made the gain measurement and Am is the
gain at that frequency.
Example 10.4
Given a Silicon npn BJT with parameters:
ˇF D 150,
VA D 350,
rb D 30 ,
C D 3 pF,
fT D 250 MHz.
Determine an appropriate small-signal hybrid- model for the transistor.
3V
20 V
22 kΩ
1.2 kΩ
100 Ω

10.5. MILLER’S THEOREM
775
Solution:
e ﬁrst step in modeling any BJT is to determine the quiescent conditions. Since this is
the same transistor and circuit as Example 5.6 (Book 2), the quiescent conditions have already
been determined to be:
IC D 9:3 mA
and
VCE D 7:90 V:
e BJT is in the forward-active region and the hybrid- model parameters can be determined
from Equations (10.68) and (10.73). Equation (10.68) yields the low-frequency parameters:
gm D jIcj
Vt
D 9:30 m
26 m D 358 mS
r D ˇF
gm
D 150
0:358 D 419:4 ;
ro D jVAj
jIcj D
350
9:30 m D 37:6 k
rb D 30 :
Equation (10.73) yields the capacitor values:
C D 3 pF
C D gm
!T
  C D
0:358
2.250 M/   3 pF D 225 pF:
10.5
MILLER’S THEOREM
e process of determining the high-frequency poles for transistor ampliﬁers is not always a
simple process. In particular, the introduction of an impedance that connects ampliﬁer input and
output ports adds a great deal of complexity in the analysis process. One technique that often helps
reduce the complexity in some circuits is the use of Miller’s theorem. Miller’s theorem addresses
the problem introduced by the interconnection of input and output ports.
Miller’s theorem applies to the process of creating equivalent circuits. is general circuit
theorem is particularly useful in the high-frequency analysis of certain transistor ampliﬁers at high
frequencies. It is based on the principle that two circuits appear equivalent if they have identical
voltage-current relationships at the ports where they interconnect with any adjoining circuitry.
Miller’s eorem generally states:
Given any general linear network having a common terminal and two terminals whose
voltage ratio, with respect to the common terminal, is given by:
V2 D AV1:
(10.75)
If the two terminals of the network are then interconnected by an impedance, Z, an equiva-
lent circuit can be formed. is equivalent circuit consists of the same general linear network

776
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
and two impedances; each of which shunt a network terminal to common terminal. ese
two impedances have value (Figure 10.24):
Z1 D
Z
1   A
Z2 D
AZ
A   1
(10.76)
+
_
+
_
General Linear
Network
with
2
1
V
1V
1i
I
in
I
out
I
2i
I
2V
Z
AV
=
(a)
+
_
+
_
General Linear
Network
with
2
1
V
1V
1Z
1s
I
in
I
2s
I
out
I
2V
AV
=
2Z
(b)
Figure 10.24: Miller equivalent circuits: (a) Interconnecting impedance, (b) Port-shunting
impedances.
Miller’s eorem can be veriﬁed by showing that the voltage-current relationships at each
port of the two circuits are identical. Notice that the voltage at each port of the linear network is
applied in the same manner so that the port currents, Iin and Iout, are unchanged by the attached
impedances. At the left port of Figure 10.24a, the input current, I1i, is given by:
I1i D Iin C V1   V2
Z
D Iin C V1   AV1
Z
:
(10.77)
e input current of the equivalent circuit (Figure 10.24b is given by:
I1s D Iin C V1
Z1
:
(10.78)

10.5. MILLER’S THEOREM
777
Using the relationship given in Equation (10.76), the input current expression becomes:
I1s D Iin C
V1
Z
1   A
D Iin C V1.1   A/
Z
D I1i:
(10.79)
Similarly, at the right port of Figure 10.24a, the output current, I2s, is given by:
I2i D Iout C V2   V1
Z
D Iin C V2   1=A V2
Z
:
(10.80)
e output current of the equivalent circuit (Figure 10.24b) is given by:
I2s D Iout C V2
Z2
:
(10.81)
Using the relationship given in Equation (10.76), the output current expression becomes:
I2s D Iout C V2
A   1
AZ

D Iout C V2   1=A V2
Z
D I2i:
(10.82)
For these two Miller equivalent circuits, the individual port voltage-current relationships are iden-
tical and the two circuits appear identical to any other circuitry that may be connected at these
two ports.
Replacement of the input-output interconnection is particularly useful in the analysis of
common-emitter and common source ampliﬁers. In these ampliﬁers, the voltage gain necessary
to invoke Miller’s theorem is easily attainable and the substitution produces signiﬁcant reduction
in analysis complexity.
Example 10.5
e circuit shown consists of an OpAmp inverting ampliﬁer bridged by a capacitor.
Determine the Miller equivalent circuit if the inverting ampliﬁer is considered to be the
general linear network.
ov
_
+
82 kΩ
iv
10 kΩ
22 µF
+_

778
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
Solution:
e gain of the OpAmp inverter is given by:
A D vo
vi
D  82 k
10 k D  8:2:
e two Miller impedances are given by:
Z1 D
Z
1   A D
1
j!.22  10 6/
1   . 8:2/
D
1
j!.202:4  10 6/
and
Z2 D
AZ
A   1 D
 8:2

1
j!.22  10 6/

 8:2   1
D
1
j!.24:68  10 6/:
Z1 appears to be a 202:4 F capacitor and Z2 a 24:68 F capacitor.
e Miller equivalent circuit is given by:
ov
_
+
82 kΩ
iv
10 kΩ
24.68 µF
202.4 µF
+_
10.6
HIGH-FREQUENCY RESPONSE OF SIMPLE BJT
AMPLIFIERS
At high frequencies, ampliﬁer response is characterized by the midband gain and the high-
frequency poles. Each poles eﬀects the frequency response curves by introducing a 20 dB/decade
attenuation which begins at the pole frequency. Once the midband gain of an ampliﬁer has been
determined in the usual fashion, it is only important to determine the pole locations in order to
completely determine the ampliﬁer high-frequency response.

10.6. HIGH-FREQUENCY RESPONSE OF SIMPLE BJT AMPLIFIERS
779
In this section, the four single-transistor BJT ampliﬁer types are analyzed in order to de-
termine their high-frequency pole locations. Miller’s theorem is ﬁrst applied to the common-
emitter conﬁguration using the traditional approximation for the Miller gain. A more accu-
rate, frequency-dependent application of Miller’s theorem to the common-emitter and common-
collector conﬁgurations follows. e common-base conﬁguration is analyzed using the techniques
developed in Chapter 5 (Book 2), and symbolic solutions to simultaneous equations are used for
the most complex case: the common-emitter ampliﬁer with emitter degeneration (CE C Re)
case. As in all small-signal analysis, transistor quiescent conditions must be ﬁrst calculated so
that the transistor parameters can be accurately determined. In order to focus discussion on pole
frequency determination, it is assumed that the quiescent analysis has been previously performed
and that the transistor parameters are well-known.
While the emphasis of this section is on analysis, the information gained in that analysis
is signiﬁcant in the practice of design. Only with a secure knowledge of the eﬀects of circuit
element values and transistor parameters on ampliﬁer response can the designer make appropriate
adjustments to meet or exceed speciﬁcations.
10.6.1 COMMON-EMITTER AMPLIFIER HIGH-FREQUENCY
CHARACTERISTICS
e midband AC model of a typical common-emitter ampliﬁer and its high-frequency equivalent,
which uses the hybrid- BJT model, are shown in Figure 10.25.
S
R
C
R
ov
sv
+_
(a)
µ
C
C
B
E
C
or
+
_
br
S
R
C
R
r
V
v
m
g
sv
ov
+_
(b)
Figure 10.25: Common-emitter equivalent circuits: (a) Midband AC equivalent, (b) High-frequency
equivalent.
e use of the analysis techniques previously developed in this text for this circuit is made diﬃcult
by the presence of the capacitor C, which interconnects the input and output sections of the
ampliﬁer. Miller’s eorem is particularly useful in reducing the analysis complexity for this case.
In Figure 10.25b, the shaded two-port network has two terminals for which the voltage gain is

780
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
well-known:
A D vo
v
D  gm.ro==Rc/ D  gmR0
c;
(10.83)
where R0
c is the equivalent load resistance including the output impedance of the BJT:
R0
c D ro==Rc:
(10.84)
e Miller gain as expressed in Equation (10.83) is a ﬁrst-order approximation: it is the product
of the transconductance, gm, and the collector resistance rather than the collector impedance. is
approximate application of Miller’s produces ﬁrst-order approximations to the two pole frequen-
cies. As such, it estimates the lower-frequency, often dominant, pole accurately, but seriously
underestimates the higher-frequency pole. Still, much insight into ampliﬁer frequency response
is gained through this Miller approach. An exact, frequency-dependent application of Miller’s
theorem is presented in the next Section 10.6.2.
e capacitor, C, bridges the two terminals of the shaded two port network. Miller’s the-
orem replaces this bridging capacitor with equivalent capacitances that shunt the ports of the
network (Figure 10.26).
C
C
B
E
C
+
_
br
S
R
C
R’
r
V
v
m
g
sv
o
o
v
+_
Figure 10.26: Miller’s theorem applied to a common-emitter ampliﬁer.
e input capacitance, Ci, is the parallel combination of C and the Miller input capacitance, C1:
Ci D C C .1 C gmR0
c/C;
(10.85)
and the output capacitance, Co, is the Millers output capacitance, C2:
Co D C
1 C gmR0
c
gmR0c

:
(10.86)
e voltage gain of the circuit is easily determined through typical phasor techniques. In this case,
the gain is the product of a voltage division at the input and a current source-impedance product

10.6. HIGH-FREQUENCY RESPONSE OF SIMPLE BJT AMPLIFIERS
781
at the output:
AV D vo
vs
D
 vo
v
 v
vs

D

 gmR0
c
1 C j!CoR0c

0
B@
r
1 C j!Cir
r
1 C j!Cir
C Rs C rb
1
CA :
(10.87)
Algebraic manipulation yields the desired result:
AV D  gmR0
c

r
r C Rs C rb
 
1
1 C j!CoR0c
 
1
1 C j!Ci fr== .Rs C rb/g

:
(10.88)
is gain has two simple poles at frequencies
!p1 D

1
Ci fr== .Rs C rb/g

D
 
1
˚
C C C
 1 C gmR0c
	
fr== .Rs C rb/g
!
(10.89)
and
!p2 D

1
CoR0c

D
1
C
1 C gmR0
c
gmR0c

R0c
D
1
C
 1=gm C R0c
:
(10.90)
Typical circuit element values imply that !p1 < !p2, but small signal-source resistance,
Rs, may reverse that relationship: both pole locations should always be checked. Typically, the
high-frequency response of a common-emitter ampliﬁer is limited by Ci through the multiplica-
tive alteration of C using Miller’s theorem. is increase in the input circuit capacitance and
the resulting decrease in pole frequency magnitude is called the Miller eﬀect. e two pole loca-
tions, with the midband gain, determine the total high-frequency response of a common-emitter
ampliﬁer.
Example 10.6
Determine the high 3-dB frequency for the common-emitter circuit shown. Assume a Silicon
npn BJT with parameters:
ˇF D 150,
VA D 350,
rb D 30 ,
C D 3 pF,
fT D 100 MHz.

782
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
10 V
200 Ω
220 kΩ
22 kΩ
3.0 kΩ
ov
sv
+_
Solution:
e coupling capacitor is replaced by an open circuit to determine the BJT quiescent—they
are found to be:
IB D 10:45 A
IC D 1:568 mA
VCE D 5:30 V:
e hybrid- parameters are then determined from these quiescent conditions:
gm D 60:31 mS,
r D 2:487 k,
C D 3:0 pF,
ro D 223:2 k,
rb D 30 ,
C D 93:0 pF.
e source resistance, Rs, is the 200  resistor in parallel with the two biasing resistors; thus the
two pole frequencies are determined from Equations (10.89) and (10.90):
!p1 D
1
˚
C C C
 1 C gmR0c
	
fr== .Rs C rb/g D 7:957 Mrad=s .1:27 MHz/
!p2 D
1
C
 1
gm
C R0
c
 D
1
3p

1
60:31 m C 2:96 k
 D 112:0 Mrad=s .17:8 MHz/ :
Clearly !p1 is a dominant pole and the high 3-dB frequency is:
fH  1:27 MHz:
10.6.2 EXACT COMMON-EMITTER HIGH-FREQUENCY
CHARACTERISTICS
It has been found that Equations (10.89) and (10.90) accurately estimate the lower-frequency
pole, whichever it may be, but underestimate the higher-frequency pole.⁷ A frequency dependent
⁷T. F. Schubert, Jr., and E. M., Kim, “A Short Study on the Validity of Miller’s eorem Applied to Transistor Ampliﬁer
High-Frequency Performance,” IEEE Transactions on Education, vol. 52, no. 1, pp. 92–98, Feb. 2009.

10.6. HIGH-FREQUENCY RESPONSE OF SIMPLE BJT AMPLIFIERS
783
application of Miller’s eorem removes the approximations inherent in the traditional applica-
tion of Miller’s eorem to transistor ampliﬁers. As such, the Miller equivalent circuit derived
by this frequency-dependent application is an exact performance equivalent and any performance
parameters derived apply exactly to the original the hybrid- model of the circuit. Both poles and
the zero of the ampliﬁer gain and input impedance are calculated exactly.
e Miller voltage gain, AM.!/, is given by the product of the output of the voltage-
controlled dependent current source,  gm, and the parallel combination of the Miller output
capacitance, Co, and the eﬀective load resistance, R0
c D ro==Rc. As stated above, the Miller gain
is given in phasor domain as:
AM.!/ D
 gmR0
c
1 C j!R0cCo
:
(10.91)
However, the Miller output capacitance, Co, has also been shown to be a function of the Miller
gain:
Co D 1   AM.!/
AM.!/
C:
(10.92)
Solving the above equation pair for the Miller gain, AM.!/, yields:
AM.!/ D
 gmR0
c

1   j! C
gm

1 C j!R0cC
:
(10.93)
e Miller voltage gain experiences a pole at  .R0
cCo/ 1 and a negative-phase zero (np-zero) at
gmC  1
 . An np-zero has the same magnitude response as a typical zero, but the phase is inverted:
some sources in the literature associate an np-zero with negative-value components. In this case,
the np-zero is due to the Miller gain changing from a large negative, real quantity to positive
unity as frequency increases: there must be a total of 180ı of phase shift in the Miller gain at very
high frequencies.
e ampliﬁer input capacitance, Ci, now takes on a frequency dependent characteristic:
Ci.!/ D C C
2
6641 C
gmR0
c

1   j! C
gm

1 C j!R0cC
3
775 CI
(10.94)
and the input gain can be written as:
Ai.!/ D

r
Rs C rb C r
  1 C j!R0
cC

1 C j!
˚
RiC C
 1 C gmR0c

RiC C R0cC
	
C .j!/2 ˚
RiR0cCC
	
(10.95)
where
Ri D r==.Rs C rb/:

784
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
Notice that the zero of the input gain, Ai.!/, is at exactly same frequency as the pole of the
Miller gain, AM.!/. us, pole-zero cancellation occurs and any poles in the Miller gain become
irrelevant in the total gain expression (the np-zero, however, remains). is pole-zero cancellation
is not coincidental: it is the direct result of Miller gain poles appearing in the denominator of the
input gain, thusly becoming zeroes. e total voltage gain of the ampliﬁer can now be expressed
as:
AV D

r
Rs C rb C r
   gmR0
c
 
1   j! C
gm

1 C j!
˚
RiC C
 1 C gmR0c

RiC C R0cC
	
C .j!/2 ˚
RiR0cCC
	:
(10.96)
Comparison of the expression for the Miller-derived gain and numerical solutions resulting
from node-voltage analysis yields exactly (to with the accuracy of the computation package) the
same results. e total gain expression retains the np-zero of the Miller gain at gmC  1

and has
two poles.
Use of the quadratic formula leads to exact values of the pole frequencies:
!p1 D  b C
p
b2   4a
2a
and
!p2 D  b  p
b2   4a
2a
I
where
(10.97)
b D RiC C
 1 C gmR0
c

RiC C R0
cC
and
a D RiR0
cCC:
e complexity of these expressions can be reduced by noting that in essentially all practi-
cal common-emitter and common-source ampliﬁers 4a  b2, and a good approximation of the
square root terms can be made:
p
1   "  1   "
2
)
p
b2   4a  b   2a
b :
(10.98)
e resultant approximate pole frequencies are:
!p1A   1
b D
 1
˚
C C
 1 C gmR0c

C
	
Ri C R0cC
;
and
(10.99)
!p2A   b
a C 1
b D
1
!p1ARiR0cCC
  !p1A:
e Miller eﬀect (multiplication of C by the quantity .1 C gmR0
c/ is still strongly apparent
in the expression for !p1A, however, the expression for !p2A takes a completely diﬀerent form
than what is typically presented in the literature.
e input impedance for common-emitter ampliﬁers can be directly derived from the input
gain Ai.!/, replacing the term Ri by r:
Zin D rb C
r
 1 C j!R0
cC

1 C j!
˚
rC C
 1 C gmR0c

rC C R0cC
	
C .j!/2 ˚
rR0cCC
	:
(10.100)

10.6. HIGH-FREQUENCY RESPONSE OF SIMPLE BJT AMPLIFIERS
785
As a result, there is a true zero at  .R0
cC/ 1 and the approximate poles are somewhat shifted
from those of the voltage gain:
!p1in 
 1
rC C
 1 C gmR0c

rC C R0cC
;
and
(10.101)
!p2in 
1
!p1inrR0cCC
  !p1in:
While the frequency-independent application of Miller’s eorem does not lead to produc-
tive results concerning output impedance, the frequency-dependent approach leads to an exact
representation. e representation of the output impedance is somewhat diﬃcult to obtain by
direct inspection; however, the évenin eorem leads to an appropriate expression:
Zout D Open circuit voltage
Short circuit current D
AV .!/
lim
RL!0
AV .!/
RL
;
or
Zout D
R0
c
˚
1 C j!Ri
 C C C
	
1 C j!
˚
RiC C
 1 C gmR0c

RiC C R0cC
	
C .j!/2 ˚
RiR0cCC
	:
(10.102)
e output impedance also has a zero and two poles. Since the denominator of the output
impedance is the same expression as the voltage gain, the expressions for the pole frequencies
of the output impedance match those for the voltage gain. However, the output impedance pole
frequencies will depend on exactly where that impedance is measured. Particular attention must be
paid to the quantity R0
c D ro==Rc which depends on where the output impedance measurement
is taken (that is, what resistances make up Rc) and may not be the same value as is used for voltage
gain.
Example 10.7
Determine the high-frequency poles for the common-emitter circuit of Example 10.6.
10 V
200 Ω
220 kΩ
22 kΩ
3.0 kΩ
ov
sv
+_

786
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
Solution:
e hybrid- parameters were determined from the quiescent conditions in Example 10.6:
gm D 60:31 mS,
r D 2:487 k,
ro D 223:2 k,
rb D 30 ,
C D 93:0 pF,
C D 3:0 pF.
Also determined in Example 10.6 were the circuit parameters:
Rs D 200==220 k==22 k D 198 
Ri D r==.Rs C rb/ D 208:8 
R0
c D ro==3 k D 2:96 k:
e poles can then be calculated to be:
!p1A D 7:428 Mrad=s
.1:18 MHz/
!p2A D 811:3 Mrad=s
.129 MHz/:
ere is deﬁnitely a dominant pole and the high 3-dB frequency consequently at that pole
frequency: 1.18 MHz. Notice that this result compares nicely with the estimated 3-dB frequency
of Example 10.6 (1.27 MHz). However, the estimated second pole as determined in Example 10.6
is drastically too low (0.86 decades low). If the location of the second pole is important, the poles
determined by the frequency-dependent Miller approach must be used.
10.6.3 COMMON-COLLECTOR AMPLIFIER HIGH-FREQUENCY
CHARACTERISTICS
Miller’s eorem is a valid and useful technique when applied to common-collector ampliﬁers.
e simpliﬁed model of a common-collector ampliﬁer and its high-frequency equivalent, using
the hybrid- BJT model, are shown in Figure 10.27. e capacitor, C, and the resistor, r,
bridge the input and output terminals of the ampliﬁer. Miller’s theorem replaces these bridg-
ing impedances with equivalent impedances shunting the input and output ports of the network
(Figure 10.28). For simplicity of notation, the substitution R0
e D ro==Re has been made.
For this circuit, the Miller voltage gain is deﬁned as:
AM.!/ D vo
vB
:
(10.103)
e Miller gain can be directly determined to be:
AM.!/ D
R0
e
R0e C R
1 C j!RC
1 C j!.R==R0e/C
;
(10.104)
where
R D r== .1=gm/ D
r
1 C gmr
:
(10.105)

10.6. HIGH-FREQUENCY RESPONSE OF SIMPLE BJT AMPLIFIERS
787
S
R
e
R
ov
sV
cc
V
+_
(a)
C
µ
C
or
br
r
S
R
e
R’
v
v
m
g
sv
ov
+_
+
_
(b)
Figure 10.27: Common-collector circuits: (a) Simpliﬁed equivalent, (b) High-Frequency equivalent.
v
ir
o
C
+
+
_
_
br
S
R
e
R’
iC
B
v
v
m
g
sv
ov
+_
Figure 10.28: Miller’s theorem applied to a common-collector ampliﬁer high-frequency model.
e total ampliﬁer voltage gain can then be written as the product of the input gain and the Miller
gain:
AV .!/ D vo
vs
D
vB
vs
  vo
vB

D Ai.!/AM.!/;
(10.106)
where
Ai.!/ D vB
vs
D
Zi
Zi C RS C rb
:
(10.107)
Under the Miller transformations, the input impedance, Zi, becomes the parallel combination of
C and the Miller input impedance:
Zi D
1
j!C
==

r
1 C j!rC
1
1   AM

:
(10.108)

788
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
After much manipulation and the standard substitution for the current gain, ˇ D gmr; the total
common-collector gain can be expressed as:
AV D
2
664

R0
e
R0eC RS CrbCr
1Cˇ
 
1 C j! rC
1Cˇ

1 C j!

r.R0eCRsCrb/CC.RsCrb/ŒR0e.1Cˇ/CrC
RsCrbCrCR0e.1Cˇ/

C .j!/2

.RsCrb/R0erCC
RsCrbCrCR0e.1Cˇ/

3
775 :
is gain has a single zero at:
!z D  1 C ˇ
rC
;
(10.109)
and, using the same quadratic approximations as for the common-emitter case, poles at:
!p1A   1
b D  Rs C rb C r C .1 C ˇ/R0
e
 Rs C rb C R0e

rC C .Rs C rb/

r C .1 C ˇ/R0e

C
;
and
(10.110)
!p2A   .Rs C rb C R0
e/rC C .Rs C rb/

r C .1 C ˇ/R0
e

C
.Rs C rb/rR0eCC
  !p1A:
Since the zero lies, in frequency, between the two poles, it is typical to model a common-
collector ampliﬁer as a single-pole ampliﬁer using !p1A as the pole frequency:
!3 dB  !p1A   Rs C rb C r C .1 C ˇ/R0
e
 Rs C rb C R0e

rC C .Rs C rb/

r C .1 C ˇ/R0e

C
:
(10.111)
e input impedance can be directly obtained from the series combination of the BJT base
resistance, rb, and the Miller input gain:
Zin D rb C Zi
D rb C

r C .1 C ˇ/R0
e
 
1 C
rR0
eC
r C .1 C ˇ/R0e
j!

1 C

r
 C C C

C .1 C ˇ/ R0eC

j! C
 rR0eCC

.j!/2 :
(10.112)
e poles are again somewhat shifted from those of the voltage gain:
!p1in 
 1
rC C
 1 C gmR0c

rC C R0cC
;
and
(10.113)
!p2in 
1
!p1inrR0cCC
  !p1in:

10.6. HIGH-FREQUENCY RESPONSE OF SIMPLE BJT AMPLIFIERS
789
e output impedance also has a zero and two poles. Since the denominator of the output
impedance is the same expression as the voltage gain, the expressions for the pole frequencies
of the output impedance match those for the voltage gain. However, the output impedance pole
frequencies will depend on exactly where that impedance is measured. Particular attention must be
paid to the quantity R0
c D ro==Rc which depends on where the output impedance measurement
is taken (that is, what resistances make up Rc) and may not be the same value as is used for voltage
gain.
10.6.4 COMMON-BASE AMPLIFIER HIGH-FREQUENCY
CHARACTERISTICS
e midband AC model of typical common-base ampliﬁer and its high-frequency equivalent are
shown in Figure 10.29. Notice that there is no element bridging the input and output termi-
nals. It is not necessary to invoke Miller’s eorem in order to ﬁnd the pole frequencies. e
capacitance-increasing Miller eﬀect is not present in common-base ampliﬁers: the pole magni-
tudes are consequently at very high frequencies.
In order to simplify the analysis of this complex circuit, notice that the voltage across the resistor,
rb, is very small: both rb and the BJT base current are relatively small quantities. It is therefore
reasonable to assume the voltage at B’ is essentially AC ground and the voltage at the emitter is
given by:
ve   v:
(10.114)
e output voltage is given by the product of the current source value and the impedance between
the collector and common:
vo D  gmv

1
1 C j!CRc

:
(10.115)
In order to ﬁnd the relationship between v and vs, the currents are summed at the emitter
terminal of the BJT:
vs C v
Rs
C gmv C j!Cv C v
r
D 0:
(10.116)
is expression can be solved for v:
v D
  vs
Rs

Rs C gm C 1
r

1 C j!C
 1
Rs
C gm C 1
r
:
(10.117)
Equations (10.105) and (10.107) are combined to form the total gain expression:
vo D  gm
0
BB@
  vs
Rs
 1
Rs
C gm C 1
r

1 C j!C
 1
Rs
C gm C 1
r

1
CCA

1
1 C j!CRc

:
(10.118)

790
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
S
R
c
R
ov
sv
+_
(a)
µ
C
C
+
_
m
g v
S
R
c
R
E
B
B’
C
r
v
sv
br
ov
+_
(b)
Figure 10.29: Common-base equivalent circuits: (a) Midband AC equivalent, (b) High-frequency
equivalent.
ere are two simple poles. e input pole is at frequency:
!p1 D r C gmrRs C Rs
CrRs
D r C .1 C gmr/Rs
CrRs
:
(10.119)
Since gmr D ˇF , the expression can be further simpliﬁed:
!1 D r C .1 C ˇF / Rs
CrRs

ˇF
Cr
D !T :
(10.120)
e output pole is at frequency:
!p2 D
1
CRc
:
(10.121)
Both poles are at very high frequencies: Common-base ampliﬁer stages are not usually the fre-
quency limiting elements in a multistage ampliﬁer.

10.6. HIGH-FREQUENCY RESPONSE OF SIMPLE BJT AMPLIFIERS
791
10.6.5 COMMON-EMITTER WITH EMITTER DEGENERATION (CE C Re)
CHARACTERISTICS
A typical common emitter ampliﬁer with emitter degeneration is shown in Figure 10.30a. Here
the transistor is biased by évenin sources and resistances: they represent the total linear circuits
connected to the terminals of the transistor. Figure 10.30b is a small-signal ac equivalent of that
ampliﬁer with the transistor replaced by its high-frequency hybrid- model. While the BJT
hybrid- model includes an output resistance, ro, that resistance, in typical common-emitter
applications, is large compared to RC C RE and will be ignored in this analysis.
S
R
c
R
e
R
CC
V
BB
V
ov
sv
+_
(a)
µ
C
C
or
br
S
R
B’
C
E
e
R
e
R
v
v
r
m
g
sv
ov
+_
+
_
(b)
Figure 10.30: Common emitter equivalent circuits: (a) Driven by évenin sources, (b) High-
frequency equivalent.
e application of Kirchhoﬀ’s current law at the nodes B0, E, and C respectively, pro-
duces the following set of equations that can be solved simultaneously in order to determine the
frequency response:
vs   vb
Rs C rb
C ve   vb
r
C .ve   vb/ sC C .vo   vb/ sC D 0
.vb   ve/ sC C vb   ve
r
C gm .vb   ve/   ve
Re
D 0
.vb   vo/ sC   gm .vb   ve/   vo
Rc
D 0:
(10.122)
Here frequency is represented by s D j!. Exact symbolic solutions for the voltage gain
AV D vo=vs take the form of the quotient of two second-order polynomials in s:
AV D vo
vs
D azs2 C bzs C cz
aps2 C bps C cp
;
(10.123)

792
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
with denominator polynomial constants (note R0
s D Rs C rb):
ap D
 R0
sRc C R0
sRe C RcRe

rCC;
bp D
 .1 C gmr/
 R0
sRc C R0
sRe C RcRe

C
Cr
 R0
s C Rc


C C r
 R0
s C Re

C
(10.124)
cp D R0
s C r C .1 C gmr/ Re;
and numerator polynomial constants:
bz D Œ.1 C gmr/ RcRe C rRc C
and
cz D  gmrRc:
(10.125)
e roots of the denominator polynomial lead to the poles of the gain and the roots of the nu-
merator lead to the zeros. Use of the quadratic formula on the polynomials gives exact values of
the pole and zero frequencies:
!1 D  b C
p
b2   4ac
2a
and
!2 D  b  p
b2   4ac
2a
:
(10.126)
For all practical ampliﬁers of this topology, the ﬁrst pole is usually considered dominant in
determining the cutoﬀfrequency of the ampliﬁer and common-emitter ampliﬁers with emitter
degeneration are typically modeled for this purpose by only a single-pole. Single-pole modeling
typically results in a slight underestimation of the 3-dB frequency response due to the ﬁrst zero
being relatively near the dominant pole. When the emitter resistor is small, the second pole and
the ﬁrst zero exchange order and single-pole modeling can slightly overestimate the 3-dB fre-
quency response due to the ﬁrst zero being relatively near the dominant pole. When the emitter
resistor is small, the second pole and the ﬁrst zero exchange order and single-pole modeling can
slightly overestimate the 3-dB frequency.
e complexity of the pole frequency expressions can be reduced by noting that in essen-
tially all practical common-emitter and common-source ampliﬁers, the pole polynomial constants
are such that b2  j4acj, and a good approximation of the square root terms can be made:
p
1   "  1   "
2
)
p
b2   4ac  b

1   2ac
b2

D b   2ac
b :
(10.127)
e pole frequencies can then be approximated by reasonable algebraic expressions
!p1A   cp
bp
D
 
R0
s C r C .1 C gmr/ Re


.1 C gmr/
 R0sRc C R0sRe C RcRe

C r
 R0s C Rc

C C r
 R0s C Re

C
and
!p2A   bp
ap
C cp
bp
(10.128)
D  
.1 C gmr/
 R0
sRc C R0
sRe C RcRe

C r
 R0
s C Rc

C C r
 R0
s C Re

C

R0sRc C R0sRe C RcRe

rCC
  !p1A:

10.6. HIGH-FREQUENCY RESPONSE OF SIMPLE BJT AMPLIFIERS
793
e approximate 3-dB frequency can be cast in more familiar terms by noting that gmr D
ˇF :
!3dB 
 
R0
s C r C .1 C ˇF / Re


.1 C ˇF /
 R0sRc C R0sRe C RcRe

C r
 R0s C Rc

C C r
 R0s C Re

C
:
(10.129)
Here the Miller eﬀect is evident in the multiplication of C as is the widening of the
ampliﬁer bandwidth with feedback (by increasing RE). ese approximations increase the un-
derestimation of the 3-dB frequency somewhat over the exact single-pole estimation.
A comparison of bandwidth calculations for the typical small-signal ampliﬁer of Fig-
ure 10.31a is shown in Table 10.1. In this example circuit, the quotient of polynomials repre-
sentation of gain as derived by the frequency-dependent form of Miller’s eorem is essentially
identical to the SPICE simulation with only  2% (1/100 decade) variation in the 3-dB frequency
and no more than 0.1 dB variation over the entire range of frequencies (Figure 10.31b). Single-
pole approximations to common-emitter with emitter degeneration ampliﬁers are common and
accurately estimate the high 3-dB frequency. In this case, the exact single pole estimate underes-
timated the 3-dB frequency by only 6.3% (1/28 decade) while the approximate, single-pole
expression underestimates the 3-dB frequency, as compared to SPICE simulation, by only 14%
(1/15 decade). A summary of the various high 3-dB calculations is given in Table 10.2, and the
one-pole frequency response plots are also shown in Figure 10.31.
20 V
PN2222A
50 Ω
13 kΩ
75 kΩ
270 Ω
1.5 kΩ
ov
sv
+_
(a)
Gain (dB)
Frequency (MHz)
1
-5
0
5
10
15
Pole-zero
SPICE
Single pole
Approx. pole
10
100
1000
(b)
Figure 10.31: (a) Typical common-emitter ampliﬁer, (b) Frequency responses characterizations.

794
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
Table 10.1: Comparison of 3-dB frequencies for the common-emitter ampliﬁer of Figure 10.31
 
3-dB frequency
SPICE
26.2 MHz
variation
- 2.4%
1/100 decade
- 6.3%
1/28 decade
- 14%
1/15 decade
25.6 MHz
24.6 MHz
22.5 MHz
two poles +
two zeros
single pole
(ωp1)
approx. pole
(ωp1a)
Table 10.2: Summary of BJT ampliﬁer high-frequency pole locations
Amplifier Type
Pole Locations (rad/s.)
 Note:  R'c = Rc // ro , R's = Rs + rb , Ri = r  // R's, and R'e = Re // ro 
Common-emitter 
(single pole)  
(use the smaller) 
s
c
1
// R'
 + (1 + 
 R' )
m
r
C
g
C
or
c
1
1
R'
m
C
g
Common-emitter 
(two poles) 
1
i
c
c
1
R
1
R'
R'
m
C
g
C
C
  , 
p1A
'
p1A
i
c
1
R R C C
Common-emitter 
with emitter 
degeneration 
s
F
e
F
s
c
s
e
c
e
s
c
s
e
R'  + + 1 + 
R
1 + 
R' R + R' R + R R
+ 
R' + R
C + 
R' + R
C
r
r
r
Common-collector 
s
e
s
e
s
e
R'
1
R'
R'
R'
R'
1
R'
r
r C
r
C
Common-base 
T    ,
c
1
R C
R
R
R
R
R
R
R
R
R
R R
R R
R R
R
R
R
R
R
R
R
R
R R
R
R
R
R
ω
ω
ω
̟
̟
̟
̟
̟
̟
̟
̟
̟
̟
̟
µ
µ
µ
µ
µ
µ
µ
µ

10.7. HIGH-FREQUENCY MODELS OF THE FET
795
10.7
HIGH-FREQUENCY MODELS OF THE FET
Analysis of the response of JFET and MOSFET circuits at high frequencies is based on accu-
rate modeling of the frequency dependent performance of the transistors. e FET models used
for signal analysis in the low to midband frequencies in the saturation region, as presented in
Chapter 4 (Book 1), do not contain frequency sensitive elements and are therefore invariant with
respect to changes in frequency. It is therefore necessary to introduce the high-frequency variant
of the model to include the frequency-dependent terms.
10.7.1 DYNAMIC MODELS FOR THE FET
e current-voltage relationships of the JFET in Chapter 4 (Book 1) and the small-signal models
of Chapter 5 (Book 2) were derived only for voltages assumed to change slowly with time. For
high-frequency analysis, the relationships must be modiﬁed to include the following two eﬀects:
1. e JFET structure acts as a parallel plate capacitor when viewed from the gate and source
terminals, with the gate and channel forming the two plates. e plate capacitor separation
is the width of the gate-to-channel junction depletion region. A capacitive current will ﬂow
when there is a change in the gate-to-source voltage.
2. e majority carriers require a ﬁnite transition time to cross the source to gate channel. If the
gate voltage changes signiﬁcantly during the time when the majority carriers are traversing
the channel, the static expression of the drain current becomes invalid.
ere is also a small capacitance in the region between the drain and source formed by the channel
and the two terminal regions.⁸ ere is an additional large gate-to-drain resistance, rgd, that for
all practical purposes is an open circuit. e frequency-dependent components are: Cgs—gate-to-
source capacitance, Cgd—gate-to-drain capacitance (sometimes called the overlap capacitance),
and Cds—drain-to-source capacitance. Since Cgs  Cds; Cds can usually be ignored.
e frequency dependent eﬀects due to charge storage in JFETs occurs mainly in the two
gate junctions. e drain-source capacitance, Cds, is small and therefore does not appreciably
aﬀect the high-frequency response of the FET. e two remaining capacitances can be modeled
as voltage dependent capacitors with values determined by the following expressions:
Cgs D
Cgso

1 C jVGSj
 o
m
(10.130)
Cgd D
Cgdo

1 C jVGDj
 o
m
(10.131)
⁸A detailed discussion of the capacitances for the JFET and MOSFET high frequency small signal model is beyond the scope
of this book. For more detailed descriptions, the reader is referred to the books (listed as references at the end of this chapter)
by M. S. Tyagi, P. R. Gray and R. G. Meyer, and P. Antognetti and G. Massobrio.

796
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
where
Cgso; Cgdo
are the zero-bias gate-source and gate-drain junction
capacitances, respectively, in Farads;
VGS; VDS
are the quiescent gate-source and drain-source voltages, respectively;
m
is the gate p-n grading coeﬃcient (SPICE default D 0:5);
 o
is the gate junction (barrier) potential, typically
0.6 V (SPICE default D 1 V).
e frequency dependent elements for the MOSFET can be obtained in the same manner
as the JFET. e gate-to-source capacitance Cgs is a function of the rate of change of gate charge
with respect to the instantaneous gate voltage. e eﬀect of the electrostatic coupling between the
gate and the drain can be represented by the incremental gate-to-drain capacitance, Cgd. Since
both of these capacitances are eﬀected by the gate voltage, the intrinsic capacitance formed by the
between the gate, oxide layer, and the channel is of critical interest. e capacitance formed by
the oxide layer at the gate is deﬁned as
Cox D "ox WL
tox
D C 0
ox WL;
(10.132)
where
Cox is the oxide capacitance formed by the gate and channel.
C 0
ox is the oxide capacitance per unit area.
"ox is the permittivity of the oxide layer (silicon oxide— SiO2: 3.9"o).
tox
is the thickness of the oxide layer
(separation between the gate and channel).
W; L are the width and the length of the channel under the gate, respectively.
e permittivity of vacuum is, "o D 8:851  10 12 F=m. e oxide capacitance per unit area can
be calculated from physical parameters:
C 0
ox D 1

2IDSS
V 2
PO

;
for depletion MOSFETs
(10.133a)
C 0
ox D 1
 .2K/ ;
for enhancement MOSFETs,
(10.133b)
where  is the charge mobility (typically 600 cm2/V-s for n-channel, 200 cm2/V-s for p-channel.
For a MOSFET operating in saturation, the relevant capacitances for the small-signal
high-frequency model are,
Cgs D 2
3Cox C Cgso W;
(10.134)
and
Cgd D Cgdo W;
(10.135)

10.7. HIGH-FREQUENCY MODELS OF THE FET
797
where Cgso; Cgdo are the zero bias gate-source and gate drain capacitances, respectively, (typically
Cgso D Cgdo D 3  10 12 F=m), and are related to C 0
ox.
e capacitances in the high-frequency small-signal model of the MOSFET are relatively con-
stant over the frequency range. Note also that the MOSFET zero bias capacitance has dimensions
of F/m and in the JFET, it has units of F.
Although the values of the components are diﬀerent, the JFET and MOSFET share the
same small-signal model arrangement shown in Figure 10.32.
dr
ds
C
gd
C
gs
C
+
_
gs
v
+
_
ov
m
g
gs
v
Figure 10.32: Accurate FET high-frequency model.
Since Cds is small compared to Cgs, the drain-source capacitance may be ignored in most analysis
and design situations, and the simpliﬁed model shown in Figure 10.33 may be used.
dr
gd
C
gs
C
+
_
gs
v
+
_
ov
m
g
gs
v
Figure 10.33: Simpliﬁed FET High-frequency model.
Circuit parameters, at speciﬁc bias conditions, can be obtained from the manufacturers’ data
sheets. e data is usually provided in terms of y-parameters. More speciﬁcally, the common-
source short-circuit input capacitance Ciss, reverse transfer capacitance Crss, and output capac-
itance, Coss are provided. ese manufacturer-speciﬁed capacitances are related to the high-
frequency small-signal model parameters by the following relationships:
Cgd  Crss
(10.136)
Cgs  Ciss   Crss
(10.137)
Cds  Coss   Crss:
(10.138)

798
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
e maximum operating frequency, !T , is the frequency at which the FET no longer am-
pliﬁes the input signal: that is, the dependent current source gmvgs is equal to the input current.⁹
Using an analysis similar to that found in 10.4 to ﬁnd the BJT maximum operating frequency,
!T D
gm
 Cgs C Cds
:
(10.139)
In general, BJTs have higher maximum operating frequencies than FETs. Two factors are respon-
sible for the lower frequency performance of FETs compared to BJTs:
• For a given area and operating current, the gm of silicon FETs is less than half of silicon
BJTs.
• In MOSFET structures, considerable capacitance is observed at the input due to the oxide
layer. In JFETs, semiconductor properties and physical dimensions of the device result long
channel lengths that reduce high-frequency performance.
Example 10.8
Given an enhancement NMOSFET with parameters:
K D 2:96 mA=V2,
VA D 150 V,
VT D 2 V,
Ciss D 60 pF at VGS D 0 V,
Coss D 25 pF at VGS D 0 V,
Crss D 5 pF at VGS D 0 V,
W D 30 m,
L D 10 m,
 D 600 cm2=V   s D 0:6 m2=V   s.
operating at ID D 5 mA.
ov
1
C
G1
R
_
+
24 kΩ
DD
V
+ 10 V
L
R
1 kΩ
G2
R
15 kΩ
D
R
2
C
1 kΩ
SS
R
100 Ω
10 µF
10 µF
sv
+_
Determine an appropriate small-signal model for the transistor and the ac equivalent of the circuit
shown.
⁹e overlap resistance, rgd, and the capacitances, Cgs and Cgd, allow for the existence of a signiﬁcant input current at high
frequencies.

10.7. HIGH-FREQUENCY MODELS OF THE FET
799
Solution:
e ﬁrst step to modeling any FET (or any transistor circuit) is to determine the quiescent
conditions. Since this is the same transistor and circuit as Example 5.12 (Book 2), the quiescent
conditions have already been determined to be,
VGS D 3:3 V
and
ID D 5 mA;
operating in the saturation region.
e transconductance is,
gm D 2
p
IDK D 2
q 5  10 3  2:96  10 3
D 7:7 mS:
e drain-source resistance of the FET is,
rd D VA
ID
D
150
5  10 3 D 30 k:
e MOSFET capacitances provided are for zero bias conditions. erefore, the following zero
bias small-signal capacitors can be found:
Cgdo D Crss=W D 5=W pF=m
Cgso D .Ciss   Crss/=W D 55=W pF=m:
In saturation, the small-signal capacitances are,
Cgs D 2
3
2KWL


C CgsoW D 1:97  10 12 C 55  10 12  57 pF
Cgd D CgdoW D 5 pF:
e complete small-signal model of the circuit is shown below:
1
C
10 µF
24 kΩ
G1
R
15 kΩ
100 Ω 
G2
R
57 pF
gs
C
SS
R
30 kΩ 
dr
1 kΩ 
D
R
1 kΩ 
L
R
gd
C
D
S
gs
v
m
g
0.00296
gs
v
gs
v
5 pF
2
C
10 µF
sv
ov
+_
+
_
+
_

800
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
10.8
HIGH-FREQUENCY RESPONSE OF SIMPLE FET
AMPLIFIERS
e high-frequency response of simple FET ampliﬁers is, as with BJT ampliﬁers, characterized
by the ampliﬁer high-frequency pole locations. is section parallels the derivations for BJT am-
pliﬁer topologies (Section 10.6): the analyses are similar, diﬀering only in the transistor parameter
names and typical values. As in all small-signal analysis, transistor quiescent conditions must be
ﬁrst calculated so that the transistor parameters can be accurately determined. In order to focus
discussion on pole frequency determination, it is assumed that the quiescent analysis has been
previously performed and that the transistor parameters are well-known.
10.8.1 COMMON-SOURCE AMPLIFIER HIGH-FREQUENCY
CHARACTERISTICS
A typical common-source ampliﬁer and its high-frequency equivalent, which uses the hybrid-
FET model, are shown in Figure 10.34.
ov
iV
G
R
D
R
DD
V
+_
(a)
gd
C
gs
C
dr
gr
G
R
D
R
v
v
m
g v
m
g
iv
ov
+_
+
_
(b)
Figure 10.34: Common-source equivalent circuits: (a) Simpliﬁed equivalent, (b) High-frequency AC
equivalent.
e traditional application of Miller’s eorem to this circuit again reduces the complexity of the
analysis. e Miller gain can be approximated as:
A D vo
v
D  gm .rd==RD/ D  gmR0
D;
(10.140)
where R0
D is the equivalent load resistance including the output impedance of the FET:
R0
D D rd==RD:
(10.141)
e Miller gain as expressed in Equation (10.140) is a ﬁrst-order approximation: it is the prod-
uct of the transconductance, gm, and the collector resistance rather than the collector impedance.

10.8. HIGH-FREQUENCY RESPONSE OF SIMPLE FET AMPLIFIERS
801
is approximate application of Miller’s produces ﬁrst-order approximations to the two pole fre-
quencies. As such, it estimates the lower-frequency, often dominant, pole accurately, but seriously
underestimates the higher-frequency pole. An exact, frequency-dependent application of Miller’s
theorem is presented in the next Section 10.8.3.
Miller’s theorem replaces the bridging capacitor, Cgd, with equivalent capacitances that
shunt the ports of the network (Figure 10.35).
i
C
G
o
C
D
S
gr
G
R
D
R’
v
v
m
g
sv
ov
+_
+
_
Figure 10.35: Miller’s theorem applied to a common-source ampliﬁer.
e input capacitance, Ci, is the parallel combination of Cgs and the Miller input capacitance,
C1:
Ci D Cgs C .1 C gmR0
D/Cgd
(10.142)
and the output capacitance, Co, is the Millers output capacitance, C2:
Co D Cgd
1 C gmR0D
gmR0D

:
(10.143)
e voltage gain of the circuit is easily determined through typical phasor techniques. In this case,
the gain is the product of a voltage division at the input and a current source-impedance product
at the output:
AV D vo
vs
D
 vo
v
 v
vs

D

 gmR0D
1 C j! CoR0D
  
1
1 C j! Ci
 RG C rg

!
:
(10.144)
is gain has two simple poles which, after making the substitution R0
G D RG C rg, can be shown
to be:
!p1 D
1
Ci .R0G/ D
1

Cgs C .1 C gmR0D/ Cgd

R0G
(10.145)
and
!p2 D
1
CoR0
D
D
1
Cgd
1 C gmR0
D
gmR0
D

R0
D
D
1
Cgd
 1=gm C R0
D
:
(10.146)

802
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
Typical circuit element values imply that !p1 < !p2, but small signal-source resistance, RG,
may reverse that relationship: both pole locations should always be checked.
10.8.2 EXACT COMMON-SOURCE HIGH-FREQUENCY
CHARACTERISTICS
As is the case for the common-emitter ampliﬁer, it has been found that Equations (10.145)
and (10.146) accurately estimate the lower-frequency pole, whichever it may be, but underes-
timate the higher-frequency pole. e frequency dependent application of Miller’s eorem re-
moves the approximations inherent in the traditional application of Miller’s eorem to transistor
ampliﬁers and determines both poles and the zero of the ampliﬁer gain and input impedance ex-
actly.
e Miller voltage gain, AM.!/, is given by the product of the output of the voltage-
controlled dependent current source,  gm, and the parallel combination of the Miller output
capacitance, Co, and the eﬀective load resistance, R0
D D rd==RD. As stated above, the Miller
gain is given in phasor domain as:
AM .!/ D
 gmR0D
1 C j!R0DCo
:
(10.147)
However, the Miller output capacitance, Co, is a function of the Miller gain:
Co D 1   AM.!/
AM.!/
Cgd:
(10.148)
Solving the above equation pair for the Miller gain, AM.!/, yields:
AM .!/ D
 gmR0D

1   j! Cgd
gm

1 C j!R0DCgd
:
(10.149)
e ampliﬁer input capacitance, Ci, now takes on a frequency dependent characteristic:
Ci .!/ D Cgs C
2
6641 C
gmR0
D

1   j! Cgd
gm

1 C j!R0
DCgd
3
775 CgdI
(10.150)
and the input gain can be written as:
Ai .!/ D
 1 C j!R0DCgd

1 C j!
˚
R0GCgs C .1 C gmR0D/ R0GCgd C R0DCgd
	
C .j!/2 ˚
R0GR0DCgsCgd
	:
(10.151)

10.8. HIGH-FREQUENCY RESPONSE OF SIMPLE FET AMPLIFIERS
803
When determining the total voltage gain, there is again pole-zero cancellation resulting in:
AV D
. gmR0D/

1   j! Cgd
gm

1 C j!
˚
R0GCgs C .1 C gmR0D/ R0GCgd C R0DCgd
	
C .j!/2 ˚
R0GR0DCgsCgd
	:
(10.152)
With resultant approximate pole frequencies:
!p1A 
 1
R0GCgs C .1 C gmR0D/ R0GCgd C R0DCgd
;
and
(10.153)
!p2A 
1
!p1AR0GR0DCgsCgd
  !p1A:
10.8.3 COMMON-DRAIN HIGH-FREQUENCY CHARACTERISTICS
Miller’s eorem can also be applied to common-drain ampliﬁers. e simpliﬁed model of a
common-source ampliﬁer and its high-frequency equivalent, using the hybrid- FET model, are
shown in Figure 10.27. e capacitor, Cgs, bridges the input and output terminals of the ampliﬁer.
Miller’s theorem replaces this bridging capacitance with equivalent capacitancess shunting the
input and output ports of the network (Figure 10.37). For simplicity of notation, the substitution
R0
S D rd==RS has been made.
ov
iV
DD
V
G
R
S
R
+_
(a)
gs
C
gd
C
dr
gr
G
v
G
R
S
R
v
m
g v
v
iv
ov
+_
+
_
(b)
Figure 10.36: Common-drain equivalent circuits: (a) Simpliﬁed equivalent, (b) High-frequency AC
equivalent.
For this circuit, the Miller voltage gain is deﬁned as:
AM .!/ D vo
vG
:
(10.154)

804
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
e Miller gain can be directly determined to be:
AM .!/ D
R0S
R0S C Rm
1 C j!RmCgs
1 C j!.Rm==R0S/Cgs
;
(10.155)
where
Rm D 1=gm
and
R0
G D RG C rg:
e total ampliﬁer voltage gain can then be written as the product of the input gain and the Miller
gain:
AV .!/ D vo
vi
D
vB
vi
  vo
vB

D Ai.!/AM.!/:
(10.156)
e derivation of AV .!/ follows that of Section 10.6.3 and results in a voltage gain with a zero
at
!zF D  gm
C
;
(10.157)
and poles at
!p1F D
  .1 C gmR0S/
.R0G C R0S/ Cgs C R0G Œ1 C gmR0S Cgd
;
and
(10.158)
!p2F   b
a C 1
b
D  .R0G C R0S/ Cgs C R0G Œ1 C gmR0S Cgd
R0GR0SCC
  !p1F :
As is the case for common-collector ampliﬁers, the zero for common-drain ampliﬁers lies,
in frequency, between the two poles, it is therefore typical to model a common-drain ampliﬁer as
a single-pole ampliﬁer using !p1A as the pole frequency:
10.8.4 COMMON-GATE HIGH-FREQUENCY CHARACTERISTICS
e midband AC model of typical common gate ampliﬁer and its high-frequency equivalent are
shown in Figure 10.37.
Common gate ampliﬁers are similar to common-base ampliﬁers in that they do not suﬀer from
performance reducing Miller eﬀects. e bridging resistance, rd, does present problems in the
analysis of the circuit. One method of analysis that brings results fairly quickly for the common-
base circuit is the node-voltage method. At the drain node of the FET, Kirchhoﬀ’s current law is
applied:
voGd C vo.j!Cgd/ C gmvgs C .vo C vgs/gd D 0:
(10.159)
e shorthand notation of replacing inverse resistance with conductance (signiﬁed by the letter
“g” with the appropriate subscript) has been used to simplify analytic representation. At the source

10.8. HIGH-FREQUENCY RESPONSE OF SIMPLE FET AMPLIFIERS
805
ov
s
v
S
R
D
R
+_
(a)
gs
v
gs
C
gd
C
dr
S
R
D
R
m
g
gs
v
sv
ov
+_
+
_
(b)
Figure 10.37: Common gate equivalent circuits: (a) Midband AC equivalent, (b) High frequency
equivalent.
node of the FET a similar operation is performed:
.vs C vgs/Gs C vgs.j!Cgs/ C gmvgs C .vo C vgs/gd D 0:
(10.160)
ese two nodal equations are combined (eliminating vgs) to form the gain expression for the
common gate ampliﬁer:
AV D vo
vs
D
Gs
Gd C gd C j!Cgd
gm C gd
  Gs C gm C j! Cgs

  gd
:
(10.161)
In this gain expression, it should be noted that the output resistance of the FET, rd, is typically
much larger than the circuit resistors Rs and Rd (as well as the inverse of gm). It is therefore
reasonable to approximate the gain expression of Equation (10.157) by ignoring the small negative
term in the denominator:
AV 
Gs .gm C gd/
 Gd C gd C j! Cgd
  Gs C gm C j! Cgs
:
(10.162)
is approximate gain expression for the common gate ampliﬁer has poles at:
!p1 D
Rs
Cgs .1 C gmRs/;
and
!p2 D
1
Cgd .rd == Rd/:
(10.163)
ese two poles are at very high frequencies: as with the common-base ampliﬁer, the common
gate ampliﬁer is not usually the frequency limiting element in a multistage ampliﬁer.

806
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
10.8.5 COMMON-SOURCE WITH SOURCE DEGENERATION (CS C Rs)
CHARACTERISTICS
Common-source ampliﬁers with source degeneration are analyzed in the same fashion as
common-emitter ampliﬁers with the exception that a diﬀerent hybrid- model is used for the
ﬁeld eﬀect transistor. An ampliﬁer of this topology driven by évenin sources is shown in Fig-
ure 10.38a and its high-frequency ac equivalent is shown in Figure 10.38b. While a depletion-
mode n-channel FET is shown, the analysis is the same for all types of FET.
G
R
D
R
S
R
DD
V
GG
V
ov
in
v
+_
(a)
gd
C
gs
C
dr
G
R
G
D
S
D
R
S
R
gs
v
gs
v
m
g
in
v
ov
+_
+
_
(b)
Figure 10.38: Common source equivalent circuits. (a) Driven by évenin souces (b) High-frequency
equivalent.
e application of Kirchhoﬀ’s current law at the nodes G; S, and D respectively, produces
the following set of equations that can be solved simultaneously in order to determine the fre-
quency response:
vin   vg
RG
C
 vs   vg

s Cgs C
 vo   vg

s Cgd D 0
 vg   vs

s Cgs C gm
 vg   vs

C vo   vs
rd
  vs
RS
D 0
 vg   vo

s Cgd   gm
 vg   vs

C vs   vo
rd
  vo
RD
D 0:
(10.164)
e exact symbolic solution for the voltage gain, AV D vo=vs, to this set of simultaneous equa-
tions take the form of the quotient of two second-order polynomials in s:
AV D vo
vs
D azs2 C bzs C cz
aps2 C bps C cp
;
(10.165)

10.8. HIGH-FREQUENCY RESPONSE OF SIMPLE FET AMPLIFIERS
807
where the denominator polynomial constants are:
ap D .RGRD C RGRS C RDRS/ rdCgsCgd
bp D Œ.1 C gmrd/ .RGRD C RGRS C RDRS/ C rd .RD C RG/ Cgd
C ŒRGRD C RGRS C RDRS C rd .RG C RS/ Cgs
cp D RD C rd C .1 C gmrd/ RS;
(10.166)
and the numerator polynomial constants are:
az D rdRDRSCgsCgd
bz D Œ.1 C gmrd/ RDRS C rdRD Cgd C RDRSCgs
cz D  gmrdRD:
(10.167)
Exact pole and zero expressions can be found through the quadratic formula. As is the case with
common-emitter ampliﬁers, common-source ampliﬁers with source degeneration are typically
modeled by a single-pole. e complexity of the ﬁrst pole expression can be similarly simpliﬁed
so that the approximate 3-dB frequency is given by:
!3dB 
ŒRDCrdC .1Cgmrd/ RS
Œ.1C gmrd/ .RGRDC RGRSC RDRS/ CgdC ŒRGRDC RGRSC RDRSC rd .RGCRS/ Cgs
:
(10.168)
In this new expression for high 3-dB frequency, the Miller eﬀect is again evident in the multi-
plication of Cgd as is the widening of the ampliﬁer bandwidth with feedback (by increasing RS).
A summary of all derived FET ampliﬁer high-frequency poles is given in Table 10.3.

808
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
Table 10.3: Summary of FET ampliﬁer high-frequency pole locations
Common-source 
(single pole)  
(use the smaller) 
'
'
D
G
1
1
R
R
gs
m
gd
C
g
C
or
D
1
1
'
R
gd
m
g
C
Common-source 
(two poles) 
 
p1A
'
'
'
'
G
D
G
D
1
R
1
R
R
R
gs
m
gd
gd
C
g
C
C
 , 
p1A
'
'
p1A
G
D
1
R R
gs
gd
C C
Common-source 
with source 
degeneration 
D
S
3
3
G
S
R  
 
1 
 
R
1
 
R
 R
d
m d
m d
gd
d
gs
r
g r
g r
R R
C
R R
r
C
3
G
D
G
S
D
S
where    
R R +R R +R R
R R
Common-drain 
'
S
'
'
'
'
G
S
G
S
1
R
R
R
R
1
R
m
gs
m
gd
g
C
g
C
Common-gate 
S
S
R
1
R
gs
m
C
g
  , 
'
D
1
R
gd
C
Note:  
G
G
D
D
S
S
R'
R
,R'
// R ,and R'
// R
g
d
d
r
r
r
Amplifier Type
Pole Locations (rad/s.)
R
R
R
R
R
R R
R R
R
R
R R
R R
R R
R R
R
R
R
R
R
R
R
R
R
R
R
R R
R
R
R
R
R
Example 10.9
Determine the high frequency poles for the ampliﬁer shown.
e JFET parameters are:
IDSS D 6 mA, VPO D   4.7 V,
VA D 100 V,
Ciss D 4:5 pF at
VGS D 0,
Crss D 1:5 pF at
VGS D 0.

10.8. HIGH-FREQUENCY RESPONSE OF SIMPLE FET AMPLIFIERS
809
ov
sv
1
C
1
C
+_
+
_
510 kΩ
1 kΩ
1 kΩ
3 kΩ
3 kΩ
12 V
Solution:
Find the quiescent conditions to determine if the JFET is in the saturation region: that is,
the bias condition must fulﬁll the following criteria:
VDS  VGS   VPO:
Solve for VGS by ﬁnding the voltage across RS. e drain current, ID, is
ID D IDSS

1   VGS
VPO
2
D IDSS

1   .VG   VS/
VPO

:
Substituting VG D 0 and VS D IDRS in to the equation for the drain current above,
ID D IDSS

1 C IDRS
VPO
2
:
Solving for ID in the second order equation above yields ID D 2 mA. erefore,
VGS D VG   VS D 0   IDRS D  0:002.1000/ D  2 V:
e condition for operation in the saturation is conﬁrmed:
VDS  VGS   VPO
or
4   2   . 4:7/ D 2:7:
e small-signal parameters for the JFET are:
gm D
 2ID
.VPO   VGS/ D
 0:002
. 4:7   . 2// D 1:48 mS;
and
rd D VA
ID
D 100
0:002 D 50 k:

810
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
e zero bias small-signal capacitors are:
Cgso  Ciss   Crss D 4:5 pF   1:5 pF D 3 pF
Cgdo  Crss D 1:5 pF:
e small-signal capacitors at the quiescent point are:
Cgs D
Cgso
s
1 C jVGSj
 o
D 3  10  12
r
1 C 2
0:6
D 1:44 pF
Cgd D
Cgdo
s
1 C jVGDj
 o
D 1:5  10  12
r
1 C 6
0:6
D 0:452 pF:
Substituting values in to the previously derived mathematical expressions for the poles of a com-
mon source with source degeneration ampliﬁer yields:
!3dB 
ŒRDCrdC .1Cgmrd/ RS
Œ.1C gmrd/ .RGRDC RGRSC RDRS/ CgdC ŒRGRDC RGRSC RDRSC rd .RGCRS/ Cgs
D 443:8 Mrad=sec.70:6MHz/:
10.9
MULTISTAGE AMPLIFIERS
Multistage ampliﬁer frequency domain analysis is a combination of techniques shown in the pre-
vious sections of this chapter and the analysis and design techniques shown in Chapter 6 (Book 2).
e important concepts from Chapter 6 (Book 2) and the previous sections of this chapter that
will be used for multistage ampliﬁer analysis are:
• e total voltage gain of a cascade-connected ampliﬁer can be expressed as a product of
gains of the individual stages and simple voltage divisions.
• Each stage presents a load to the previous stage: its input resistance is part of the total load
that is apparent to the previous stage.
• e total input resistance or total output resistance may be modiﬁed by the interaction of
individual stages.
e analysis procedure used for designing multistage ampliﬁers is:

10.9. MULTISTAGE AMPLIFIERS
811
• Perform midband gain analysis of the total circuit and of each stage taking into account the
load presented by the input resistance of the next stage.
• Perform low-frequency analysis of the circuit. In most cases, careful application of the time
constant approach will yield a good approximation of the low cutoﬀfrequency.
• Perform high-frequency analysis using the high-frequency model of the circuit. When ap-
propriate, use Miller’s theorem to create a Miller’s equivalent circuit of the ampliﬁer. In
most cases, the high-frequency output capacitance of the Miller’s equivalent model may be
ignored since the pole associated with the output capacitance is signiﬁcantly higher than
the pole for the Miller’s equivalent input capacitance. is greatly simpliﬁes analysis and
design without sacriﬁcing a great deal of accuracy.
e analysis of multistage ampliﬁer high-frequency response is greatly simpliﬁed by assuming
non-interacting capacitances in the high-frequency model. is assumption is particularly impor-
tant when determining the gain of an ampliﬁer stage loaded by the input impedance of a fol-
lowing stage: often a complex impedance. at impedance is evaluated at midband frequencies,
thus eliminating the reactive component from the analysis. Using this assumption, the input
impedance of the ampliﬁer stage at the output of the stage under consideration presents a purely
resistive load.
10.9.1 CAPACITOR COUPLING BETWEEN STAGES
A common method found in multistage ampliﬁer design makes use of coupling capacitors be-
tween stages. is method has the advantage that the bias condition of each stage is unaﬀected
by the others. e disadvantage is the potential degradation in ampliﬁer low-frequency response:
that is, the low cutoﬀfrequency may increase without careful selection of capacitor values. Ad-
ditionally, the use of coupling capacitors between stages does not lend itself to integrated circuit
implementations of the circuit since large capacitors require large areas, or “real estate,”¹⁰ on the
chip.
Figure 10.39 depicts a two stage common-emitter cascaded ampliﬁer.
e AC model of the circuit is shown in Figure 10.40. Note that parallel resistors are replaced by
their equivalent: RB1 D RB11==RB21 and RB2 D RB21==RB22.
e midband gain of the circuit has been previously determined in Example 6.1 (Book 2).
While it is possible to recast the gain expressions using hybrid- parameters, using h-parameter
expressions is equivalently valid. e midband gain has been determined to be:
AVm D
vo
vs

D
vb1
vs
 vb2
vb1
  vo
vb2

;
(10.169)
¹⁰Area on integrated circuits are sometimes referred to as “real estate” since a chip may be designed with a near capacity of
number of components, and space may not be available.

812
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
ov
sv
+_
+
_
1
C
2
C
3
C
L
R
S
R
B21
R
E1
R
E2
R
B11
R
C1
R
C2
R
CC
V
B12
R
B22
R
1
Q
2
Q
Figure 10.39: Two-stage common-emitter cascaded ampliﬁer.
ov
sv
+_
+
_
1
C
2
C
3
C
S
R
b1
v
B1
R
E1
R
B2
R
E2
R
C1
R
C2
R
L
R
1
Q
2
Q
Figure 10.40: AC model of Figure 10.39.
where
vi1
vs
D
Ri1
Ri1 C RS
;
(10.170)
vo1
vi1
D  hfe1 Œ.RC1==RB2 / ==Ri2
hie1 C
 1 C hfe1

RE1
;
(10.171)
vo
vo1
D  hfe .RC2==RL/
Ri2
;
(10.172)
where
Ri1 D hie1 C
 1 C hfe1

RE1
and
Ri2 D hie2 C
 1 C hfe2

RE2:

10.9. MULTISTAGE AMPLIFIERS
813
e low cutoﬀfrequency is found by using the equations derived in Section 10.6 setting all high-
frequency transistor capacitors as open circuits and following the time constant analysis of Sec-
tion 10.3. e low-frequency poles of the ampliﬁer in Figure 10.39 are:
!L1 D
1
C1
˚
RS C

RB1 ==
 hie1 C
 1 C hfe1

RE1
	;
(10.173)
!L2 D
1
C2 ŒRC1 C .RB2 ==Ri2/;
(10.174)
!L3 D
1
C3 .RC2 C RL/:
(10.175)
e high cutoﬀfrequency is found using the equations summarized in Table 10.2 for each
stage, using the applicable transistor parameters and circuit element values. For this particular
circuit, both stages are common-emitter with emitter degeneration stages. In determining the
correct values for the resistances in the expressions, total évenin resistances at the ampliﬁer
terminal must be used.
For the ﬁrst stage, the appropriate resistances are:
R0
s D rb1 C RS==RB1
Rc D RC1==RB2==Ri2
(10.176a)
RE D RE1:
For the second stage, the resistances are:
R0
s D rb2 C Rc1==RB2
Rc D RC2==RL
(10.176b)
Re D RE2:
Example 10.10
e two stage cascade connected ampliﬁer of Example 6.1 (Book 2) is shown. e two silicon
BJTs have characteristic parameters:
hfe  ˇF D 150;
rb D 30 ,
VA D 350.
C1 D C2 D 3 pF,
!T1 D !T 2 D 2.400/ Mrad/s.
Determine the low and high cutoﬀfrequencies of the circuit.

814
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
S
R
1
C
CC
+V
15 V
2.2 kΩ
2.2 kΩ
100 Ω
430 Ω
430 Ω
10 µF
10 µF
1 µF
82 kΩ
82 kΩ
12 kΩ
2.7 kΩ
12 kΩ
+
_
B21
R
B11
R
E1
R
C1
R
B22
R
B12
R
2
C
3
C
1
Q
2
Q
E2
R
C2
R
L
R
ov
sv
+_
Solution:
e determination of the multistage ampliﬁer performance follows the same basic steps
that were derived in Chapter 6 (Book 2):
1. Model the transistors with the appropriate DC model.
2. Determine the circuit quiescent conditions. Verify forward-active region for BJTs or satu-
ration region for FETs.
3. Determine transistor AC parameters from quiescent conditions.
4. Create AC equivalent circuit.
5. Determine the midband performance of each ampliﬁer stage by:
(a) replacing the transistors by their respective AC models, or
(b) using previously derived results for the circuit topology.
6. Combine stage performance quantities to obtain total midband gain.
7. Perform low-frequency analysis to determine the low cutoﬀfrequency using the small signal
AC model with all internal (high-frequency) capacitors open circuited.
8. Perform high-frequency analysis to determine the high cutoﬀfrequency using the small
signal AC model including the internal (high-frequency) capacitors and short circuiting all
external (coupling and bypass) capacitors.

10.9. MULTISTAGE AMPLIFIERS
815
9. Combine results of DC, midband, low-frequency and high-frequency analysis to obtain
total circuit performance.
e DC analysis was performed in Example 6.1 (Book 2) and the result for both collector
currents and collector-emitter voltages are:
IC D 2:427 mA
and
VCE D 8:64 V:
e quiescent conditions lead to hie D 1:624 k.
e hybrid- small signal parameters are:
r1 D r2 D hie   rb D 1:624 k   30 D 1:594 k
gm1 D gm2 D gm D ˇF
r
D 150
1594 D 94:1 mS
C1 D C2 D gm
!T
  C D
0:0941
2
 400  103   3  10 12 D 34:4 pF:
e AC model of the circuit is shown below:
ov
sv
+_
+
_
1
C
2
C
3
C
S
R
b1
v
B1
R
E1
R
B2
R
E2
R
C1
R
C2
R
L
R
1
Q
2
Q
100 Ω
430 Ω
430 Ω
10 µF
10 µF
1 µF
10.5 kΩ
10.5 kΩ
2.7 kΩ
2.7 kΩ
2.2 kΩ
Where RB1 D RB11==RB21 and RB2 D RB12==RB22. Since VA is very large, the output resis-
tance, h 1
oe , is very large and can be approximated as an inﬁnite resistance.
e low-frequency poles are:
!L1 D
1
C1
˚
RS C

RB1 ==
 hie1 C
 1 C hfe1

RE1
	 ) 10:9 rad=s D 1:74 Hz
!L2 D
1
C2 ŒRC1 C .RB2 ==Ri2/ D 88:9 rad=s ) 14:2 Hz
!L3 D
1
C3 .RC2 C RL/ D 20:4 rad=s ) 3:25 Hz:
e high-frequency poles for the common-emitter with emitter degeneration stages are found
using Table 10.2 with applicable circuit element values.

816
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
For the ﬁrst stage, those resistances are:
R0
s D rb1 C RS==RB1 D 30 C 100==10:5 k D 226 
Rc D RC1==RB2==Ri2 D 2:2 k==10:5 k==.1:62 k C 151  430/ D 1:77 k
Re D RE1 D 430 :
For the second stage, the resistances are:
R0
s D rb1 C Rc1==RB2 D 1:889 k
Rc D RC2==RL D 1:212 k
Re D RE2 D 430 :
e single high-frequency pole approximations for each stage are then calculated as:
!H1 D 108 Mrad=s
)
17:3 MHz
!H2 D 39:1 Mrad=s
)
6:22 MHz;
!L2 is the dominant low-frequency pole. e lower 3-dB frequency is 14.2 Hz.
e high frequency poles are separated by a factor of k D 2:78 thus the high 3-dB frequency
is computed as described in Section 10.2.2:
fH D 6:22 MHz
v
u
u
t .1Ck2/ C
q
.1Ck2/2 C 4k2
2
D 5:59 MHz
10.9.2 DC (DIRECT) COUPLING BETWEEN STAGES
In Example 10.10, the coupling capacitor between the two stages established the dominant low-
frequency pole, and therefore the low cutoﬀfrequency. e eﬀect of coupling capacitors between
ampliﬁer stages on the low-frequency response can be eliminated by DC coupling the stages. e
midband analysis of a DC (or direct) coupled two-stage common source—common-collector
ampliﬁer (Figure 10.42) was shown in Example 6.2 (Book 2).
e analysis of the midband gain, low cutoﬀfrequency, and high cutoﬀfrequency are found
in the manner as the capacitor-coupled ampliﬁers. Following the analysis of the capacitor coupled
multistage ampliﬁer, and the results in Sections 10.6 and 10.8, the midband gain of the direct
coupled common source—common-collector ampliﬁer is,
AVm D vo
vs
D  
RG1
RG1 C ROS

gm1rd .RD1 ==Ri2/
Œrd C .RD1 ==Ri2/ C .1 C / RS1
Ri2   .hie/
Ri2

(10.177)
where
Ri2 D hie C
 1 C hfe

.RE2==RL/ :

10.9. MULTISTAGE AMPLIFIERS
817
ov
sv
+_
+
_
1
C
2
C
L
R
OS
R
G1
R
S1
R
E2
R
D1
R
CC
V
1
Q
2
Q
Figure 10.41: DC (Direct) coupled two-stage ampliﬁer.
o
v
sv
+_
+
_
1
C
2
C
S
R
B1
R
C
R
B2
R
E
R
E
C
L
R
CC
V
1
Q
2
Q
Figure 10.42: Common-emitter ampliﬁer using Darlington pair.
e low-frequency poles are calculated from the product of the resistive discharge paths, calcu-
lated using évenin equivalent resistances, and the external capacitors:
!l1 D
1
C1 .ROS C RG/
(10.178)
!l2 D
1
C2

RL C

RE2 ==hie C rd C .1 C gm1rd/ RS1
1 C hfe
 :
(10.179)

818
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
e high-frequency poles are found by applying Equation from Table 10.3 for the common
source stage and Table 10.1 for the common-collector stage. e appropriate circuit element
calculations for this circuit are:
Common source with source degeneration stage:
RD D RD1==Ri2
RS D RS1
(10.180)
RG D ROS==RG1:
Common collector stage
R0
s D rb C RD1==Ro1
(10.181)
R0
e  RE2==RL:
Each stage will, in this case, provide a single pole. e total ampliﬁer high 3-dB frequency
is determined by appropriately combining those two poles.
10.9.3 DARLINGTON PAIR
e frequency response of ampliﬁers using the Darlington pairs can be found using the techniques
developed thus far in this chapter. Figure 10.42 is a common-emitter ampliﬁer using the dual
common-collector composite transistor.
e complete hybrid- small signal equivalent is shown in Figure 10.43. e analysis of
this ampliﬁer follow techniques developed in this chapter. e midband gain is found by treating
all external (bypass and coupling) capacitors as short circuits and all high-frequency capacitors
as open circuits. e gain expression is a little diﬀerent than those that have been derived thus
far. e midband gain has additive terms because the two dependent current sources, gm1v1 and
gm2v2, add to yield the ampliﬁer output current. e midband gain of the ampliﬁer is,
AVm D  vi1
vs

.gm1v1 C gm2v2/ RO;
(10.182)
where
RO D RC==RL
for midband and high-frequency analysis,
RB D RB1==RB2;
and
vi1
vs
D
RB
RB C RS
:
e controlling voltages for the dependent current sources are,
v1 D
vi1r1
rb1 C .1 C gm1r1/ .rb2 C r2/;
(10.183)

10.9. MULTISTAGE AMPLIFIERS
819
1
C
S1
R
b1
r
i1
v
B
R
r
C
v
r
b2
r
m1
g v
m2
g v
E1
R
E
C
C
R
L
R
O
R
µ1
C
µ2
C
2
C
ov
sv
+_
+
_
v
C
+
_
+
_
+
_
̟2
̟1
̟1
̟1
̟1
̟2
̟2
̟2
Figure 10.43: All-frequency hybrid- small signal model of Figure 10.42.
and
v2 D
vi1r2 .1 C gm1r1/
rb1 C r1 C .1 C gm1r1/ .rb2 C r2/:
(10.184)
e complete expression for the midband gain is found by substituting Equations (10.183)
and (10.184) into (10.182),
Avm D   RBRO
RB C RS

gm1r1
rb1 C .1 C gm1r1/ .rb2 C r2/ C
gm2r2 .1 C gm1r1/
rb1 C r1 C .1 C gm1r1/ .rb2 C r2/

: (10.185)
e high-frequency model is simpliﬁed using Miller’s theorem to yield the high-frequency
Miller’s equivalent small signal model shown in Figure 10.44. e high-frequency Miller’s equiv-
alent output capacitances since the poles associated with these capacitances are not dominant.
e pole locations are found by determining the input impedance, Zi in Figure 10.44,
Zi D rb1 C

r1

1
j!Ci1

C .1 C gm1/

rb2 C

r2

1
j!Ci2

D

rb1

1
r1Ci1
C j!

C
r1
r1Ci1
 
1
r2Ci2
C j!

C .1 C gm1r1/

rb2

1
r2Ci2
C j!

C
r2
r2Ci2
 
1
r1Ci1
C j!


1
r2Ci2
C j!
 
1
r1Ci1
C j!

:
(10.186)
From Equation (10.186), the pole locations of the Darlington circuit in Figure 10.42 are,
1
r1Ci1
and
1
r2Ci2
:
(10.187)

820
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
m1
g v
m2 π2
π2
π2
π1
π1
π1
g v
b2
r
iZ
S
R
b1
r
µ1
C
C
R
L
R
ov
+
_
i1
v
B
R
sv
+_
+
_
_
r
l2
C
E
C
l1
C
v
r
+
_
_
v
+
_
Figure 10.44: High-frequency Miller’s equivalent circuit of Figure 10.43.
10.9.4 CASCODE AMPLIFIER
A cascode ampliﬁer and its AC equivalent circuit are shown in Figure 10.45a and 10.45b where
Q1 forms the common-emitter stage and Q2 forms the common-base stage. e analysis of the
cascode ampliﬁer is simpliﬁed because, as shown in Section 10.6.4, the common-base ampliﬁer
high-frequency cutoﬀis very high. erefore, the common-base stage does not limit the high-
frequency operation of the cascode ampliﬁer.
e analysis and design for the low cutoﬀfrequency follows the technique demonstrated in the
previous sections of this chapter. Since the common-base stage does not aﬀect the high-frequency
response of the cascode ampliﬁer, the simpliﬁed high-frequency small signal model shown in
Figure 10.46 is used to ﬁnd the dominant high-frequency pole.
e equivalent load resistance, RO, of the common-emitter stage is the évenin input resistance
of the common-base stage,
RO D
r2 C rb2
1 C gm2r2
:
(10.188)
e midband gain of the ampliﬁer is,
AVm D  gm1RO D  gm1
 r2 C rb2
1 C gm2r2

:
(10.189)
e Miller’s equivalent high-frequency input capacitor is,
Ci1 D C1 C C1 .1 C gm1RO/ :
(10.190)

10.9. MULTISTAGE AMPLIFIERS
821
o
v
sv
+_
+
_
1
1
C
L
R
S
R
B12
R
B21
R
B11
R
CC
V
CC
V
E1
R
B22
R
E
C
B
C
Q
2
Q
(a)
2
Q
o
v
sv
+_
+
_
1
L
R
i
R
S
R
B1
R
=
//
B2
R
//
Q
(b)
Figure 10.45: (a) Cascode ampliﬁer, (b) AC model of the cascode ampliﬁer.
e dominant high-frequency pole is determined from the following transfer function of the
input portion of the high-frequency small signal model of Figure 10.46,
v1
vs
D
r1==
1
j!Ci1
Ri C rb1 C

r1 ==
1
j!Ci1
 D
1
C1 .Ri C rb1/
0
BB@
1
j! C r1 C Ri C rb1
C1r1 .Ri C rb1/
1
CCA : (10.191)
erefore, the high cutoﬀfrequency is,
!H D r1 C Ri C rb1
C1r1 .Ri C rb1/:
(10.192)
e other high-frequency poles are signiﬁcantly higher in frequency than Equation (10.192) due
to the small value of the Miller’s equivalent output capacitance of Q1 and the very high cutoﬀ
frequency of the common-base stage.

822
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
m1 ̟1
̟2
̟2
̟2
̟1
g
v
m2
g
v
iR
O
R
b1
r
ov
+
_
v
+
_
v
+
_
r
r
b2
r
l1
C
L
R
sv
+_
Figure 10.46: Simpliﬁed high-frequency model of the cascode ampliﬁer.
10.10 CONCLUDING REMARKS
Frequency response of ampliﬁers has been discussed in this chapter. e distortion caused by
frequency limitations was explored in the time domain. A demonstration of the eﬀect of the
ampliﬁer transfer function (gain and phase response) on the input signal conﬁrmed that frequency
distortion can dramatically alter the output signal shape when compared to its input. Low and
high pass responses to a pulse input were explored and the concept of sag was introduced.
For multi-pole electronic systems, the diﬃculty in analytically ﬁnding the low and high
cutoﬀfrequencies was resolved through simple formulas and approximations of the cutoﬀfre-
quencies. is technique utilized the dominant pole of electronic systems to readily determine
the cutoﬀfrequency. Dominant poles were deﬁned as those poles that are at least a factor of four
from the next nearest pole frequency.
e low-frequency response of an electronic ampliﬁer was shown to be a function of the
external coupling and bypass capacitors of an ampliﬁer. Although in some instances, the capacitors
interacted with each other in the circuit, a method was developed for approximating the low-
frequency poles by analyzing the poles associated with individual capacitors. is technique relied
on the dominant pole concept.
High-frequency hybrid- models were developed for the BJT and the FET. e high-
frequency models included capacitances that determine the high-frequency operation of the de-
vices. Miller’s theorem was developed to simplify the analysis of the high-frequency models.
Single and multistage ampliﬁers were analyzed using the techniques developed in this chap-
ter. e analysis and design of ampliﬁers followed the following procedure:
1. Model the transistors with the appropriate DC model.
2. Determine the circuit quiescent conditions. Verify forward-active region for BJTs or satu-
ration region for FETs.

10.10. CONCLUDING REMARKS
823
3. Determine transistor AC (hybrid- or h-) parameters from quiescent conditions.
4. Create AC equivalent circuit.
5. Determine the midband performance of each ampliﬁer stage by:
(a) replacing the transistors by their respective AC models, or
(b) using previously derived results for the circuit topology.
6. Combine stage performance quantities to obtain total midband gain.
7. Perform low-frequency analysis to determine the low cutoﬀfrequency using the low-
frequency, small-signal AC model.
8. Perform high-frequency analysis to determine the high cutoﬀfrequency using:
(a) e small-signal hybrid- model including the internal (high-frequency) capacitors
and short circuiting all external (coupling and bypass) capacitors. Use Miller’s theorem
to simplify the small-signal model of the ampliﬁer where appropriate.
(b) Previously derived expressions for the pole locations taking into account appropriate
loading conditions.
9. Combine results of DC, midband, low-frequency and high-frequency analysis to obtain
total circuit performance.
As an aid to the designer faced with a variety of sources for transistor data, Tables 10.4
(BJT), 10.5 (JFET), and 10.6 (MOSFET) have been included. ese tables provide formulas for
transistor parameter conversion between the various models. e three parameter sets included
in the tables are: manufacturer’s data book parameters, hybrid- model parameters, and SPICE
model parameters.

824
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
Table 10.4: Conversion of BJT high-frequency modeling parameters
Source of Parameters
Conversion to SPICE Parameters
Conversion to Hybrid-
Model Parameters (1)
(2)
Manufacturer’s Data 
Books 
fT @ ICT  – gain  
     bandwidth product 
Cobo @ VCB  
– output capacitance
Cibo @ VEB  
– input capacitance
   Cµ = Cobo 
T
2 f
m
g
C
C
 
 
CB
V
CJC
1
m
obo
C
 
 
EB
V
CJE
1
m
ibo
C
EB
T
1
V
TF
2 f
0.7
m
t
ibo
obo
CT
V
C
C
I
SPICE Models 
CJE  – zero-bias 
base-emitter 
capacitance 
CJC  – zero-bias 
base-collector 
capacitance 
TF  – forward transit 
time 
  
CB
CJC
V
1
m
C
TF+1.617 CJE
m
C
g
  VJE  VJC    0.75 
  MJE  MJC  m  0.33 
IC Design Models 
Cieo  – zero-bias 
base-emitter 
capacitance 
Cµo  – zero-bias 
base-collector 
capacitance 
F  
– forward transit 
time 
  
CB
V
1
o
m
C
C
+1.617
m
F
ieo
C
g
C
  CJE = Cieo 
  CJC = Cµo 
  TF = F 
NOTES:    (1) Use the quiescent value of VCB in the equations in this column. 
(2) Use the data book values for VCB and VEB in the equations in this column. 
(3) fT is assumed to be approximately constant in this text:  It has a non-linear dependence on IC
(4) The values for  and m are device dependent.  The indicated values are the SPICE default 
values. 
(5) The subscripted junction voltages are for npn BJTs.   The equations for pnp BJTs are 
identical with these subscripts reversed. 
(6) C  is dependent on device parameters as shown below:  the approximation given uses SPICE 
default values 
MJE+1
CJE
TF
1 FC 1+MJE +MJE
TF+1.617 CJE
VJE
1 FC
BE
m
m
V
C
g
g
ψ
ψ
ψ
ψ
ψ
ψ
ψ
ψ
̟
̟
̟
̟
̟
̟
̟
µ
µ
µ

10.10. CONCLUDING REMARKS
825
Table 10.5: Conversion of JFET high-frequency modeling parameters
Source of Parameters
Conversion to SPICE 
Parameters
Conversion to Hybrid-
Model Parameters (1)
Manufacturer’s Data Books 
Ciss @ VGS = 0  
– input short-circuit
capacitance
Crss @ VGS = 0  
– reverse transfer
capacitance
GD
V
1
rss
gd
m
C
C
GS
V
1
iss
rss
gs
m
C
C
C
CGD = Crss 
CGS = Ciss - Crss 
SPICE Models 
CGD  
– zero-bias gate-drain 
capacitance 
CGS  
– zero-bias gate-source 
capacitance 
GD
CGD
V
1
gd
m
C
GS
CGS
V
1
gs
m
C
PB = 
 
 0.6 
M = m
 
 0.5 
IC Design Models 
Cgdo  
– zero-bias gate-drain 
capacitance 
Cgso  
– zero-bias gate-source
capacitance
GD
V
1
gdo
gd
m
C
C
GS
V
1
gso
gs
m
C
C
CGD = Cgdo
 
CGS = Cgso
 
NOTES:    (1) Use quiescent values for VGD and VGS in the equations in this column. 
(2)The values for  and m are device dependent.  Typical values are as  = 0.6 and m = 0.5. 
SPICE default values are  = 1.0 and m = 0.5 
(3) The subscripted junction voltages are for n-channel JFETs.  The equations for p-channel 
JFETs are identical with these subscripts reversed.
ψ
ψ
ψ
ψ
ψ
ψ
ψ
ψ
ψ
ψ

826
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
Table 10.6: Conversion of MOSFET high-frequency modeling parameters
Source of Parameters
Conversion to SPICE 
Parameters
Conversion to Hybrid-
Model Parameters (1)
Manufacturer’s Data Books 
Ciss @ VGS –  input capacitance 
Crss @ VGS   –  reverse transfer 
capacitance 
Coss @ VGS  – output 
capacitance 
Cgs
 Ciss – Crss
Cgd
 Crss
Cds
 Coss – Crss 
WL
2
TOX
3
OX
iss
rss
C
C
2
CGDO
W
rss
C
SPICE Models 
CGDO  – zero-bias gate-drain 
capacitance 
CGSO  – zero-bias gate-source 
capacitance 
VTO  
– threshold voltage 
KP 
– transconductance
coefficient
Cgd = CGDO W
WL
2
3
TOX
OX
gs
C
Cds = 0
VT = VTO 
KP W
K
2
L
OX = 3.9 o  
= 3.9(8.51) pF/m 
 
for SiO2 
IC Design Models 
Levels 2, 3, and 4  
PSpice Models 
Levels 2, 3, and 4 
PSpice Parameters 
Levels 2, 3, and 4 
PSpice Parameters 
NOTES: (1) Default geometry parameters in PSpice are L = W = 100 µm.  In SPICE2, 
the default geometry parameters are L = W = 1m.  Setting L = W = 100µm or less in the 
MOSFET model statement is recommended.  Failure to make L = W affects the constants 
used to determine the DC operating point. 
(2) The value for 
OX is dependent on the gate insulation material.  The value of 3.9 
O is for 
SiO2 insulated gates only. 
(3) Integrated circuit parameters require the most accurate representation of the physical 
realization of the device.  Detailed device geometry information is required.   More complex 
models of the MOSFET are used in specifying parameters for IC design.  These models are 
beyond the scope of this text:  the simple model presented in this text does not have 
sufficient detail to be used for IC designs. 
ε
ε
ε
ε
ε
ε

10.10. CONCLUDING REMARKS
827
SUMMARY DESIGN EXAMPLE: PREAMPLIFIER FOR A LORAN C
NAVIGATIONAL SYSTEM RECEIVER
e Loran C is a standard navigational system using pulsed information in the very low frequency
(VLF) range. Loran C is a form of hyperbolic navigational system that uses time diﬀerentials
between signals from a pair of widely separated transmitting sites to locate the coordinates of the
receiving station. e required operational frequency range is 10 Hz to 1500 kHz. e output of a
“whip” antenna, with an output resistance of 2200 , must be ampliﬁed by a factor of C2 to C3 by
a preampliﬁer. is preampliﬁed signal is applied to the 50  input of the Loran C navigational
receiver which will process the incoming information. e output impedance of the preampliﬁer
must match the input impedance of the Loran C receiver to eliminate potential signal reﬂections
which will corrupt the signal to the Loran C receiver. It is critical that the preampliﬁer is a non-
inverting ampliﬁer which will preserve the duty cycle of the pulsed information detected by the
whip.
Design an inexpensive Loran C preampliﬁer to meet the stated requirements. A C9 V
automotive/marine battery is used as the power source.
Solution:
e antenna signal is applied to a common-source n-JFET ampliﬁer which will provide
moderate gain and high input resistance. However, since a common-source n-JFET ampliﬁer
inverts the input signal, a unity gain inverter is required at the output. erefore, the output
of the FET stage is applied to a unity gain common-emitter npn BJT ampliﬁer. To minimize
signal reﬂections, the output resistance of the BJT unity gain inverting ampliﬁer must be 50 .
A possible topology for the ampliﬁer is shown below:
ov
S
R
“Whip” Antenna
D
R
C
R
2.2 kΩ
51 Ω
G
C
G
v
D
v
G
R
SS
R
SS
C
1
Q
2
Q
E2
R
E1
R
O
C
E
C
i2
R
DD
+V
+9 V

828
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
e BJT parameters are:
ˇF D 200,
VA D 160 V,
rb D 30 ,
Cibo D 8 pF at VEB D 0:5 V,
Cobo D 4 pF at VCB D 5 V
fT D 300 MHz.
e JFET parameters are:
IDSS D 6 mA,
VPO D  4:7 V,
VA D 100 V,
Ciss D 4:5 pF at VGS D 0 V,
Crss D 1:5 pF at VGS D 0 V .
Initiate the design by selecting the DC operating point and synthesizing the circuit for operation
in the midband region. e FET biasing resistor RG is set arbitrarily large: RG D 510 k.
Let ID D 1 mA. Solve for VGS:
ID D IDSS

1   VGS
VPO
2
;
or
VGS D VPO
 
1  s
ID
IDSS
!
D  4:7
 
1  r
1
6
!
D  2:8 V:
Since VG D 0, then VS D 2:8 V. is implies that the source resistor is,
RSS D VS
ID
D
2:8
0:001 D 2:8 k:
e midland gain of the ampliﬁer is,
Av  vo
vg
D
vd
vg
 v
vd
  vo
v

D Œ gm1 .rd==RD ==Ri2/

r
r C .1 C gm2r/ RE1

Œ gm2RC ;
where
gm1 D
 2ID
.VPO   VGS/ D
 2 .0:001/
. 4:7   . 2:8// D 1:05 mS
r D .ˇF C 1/ Vt
jIcj   rb;
and
gm2 D ˇF
r
:

10.10. CONCLUDING REMARKS
829
For a gain of 2 to 3, the parallel combination of RD and Ri2 (assuming rd is very large, here
rd D 100 k) is in the range,
2

gm1gm2RCr
r C .1 C gm2r/ RE1
  RD ==Ri2 
3

gm1gm2RCr
r C .1 C gm2r/ RE1
:
Since the second stage will be designed to have an inverting gain magnitude of approximately
unity, the gain of the ﬁrst stage can be designed to have a gain of  2:5.
e second stage will be designed for a collector current of 1 mA. erefore,
r D 5:2 k
and
gm2 D 0:038 S:
For an inverting unity gain second stage,
Av2 D vo
vd
D
v
vd
  vo
v



r
r C .1 C gm2r/ RE1

. gm2RC/ :
But gm2RC D .0:038/ .51/ D 1:96. erefore, the expression
r
rC.1Cgm2r/RE1  0:5 for Av2 D
 1. is implies that .1 C gm2r/ RE1  5:2 k, or, RE1 D 26  27 .
e input resistance of the second stage is then,
Ri2 D rb C r C .1 C gm2r/ RE1 D 30 C 5200 C 5200 D 10:43 k:
For an overall gain of  2:5 the RD is,
RD D 3:17 k  3:3 k:
Checking the DC conditions of the ﬁrst stages, the drain-source voltage of the JFET is,
VDS D VDD   ID .RD C RSS/ D 9   0:001 .3300 C 2800/ D 2:9 V:
To check that the FET is in the saturation region of operation,
VDS  VGS   VPO D  2:8   . 4:7/ D 1:9 V;
and since VDS D 2:9 V > 1:9 V, the FET is operating in the saturation region. e DC voltage
at the drain is VD D 9   0:001.3300/ D 5:7 V.
Now solve for RE2 to bias the BJT at IC D 1 mA,
RE2 D
ˇF
IC .ˇF C 1/
 VD   V2

  RE1 D
200
0:001 .201/ .5:7   0:7/   27 D 4:9 k  4:99 k:
is indicates that VCE  4 V.

830
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
To conﬁrm that the frequency response of the circuit is suﬃcient to receive the Loran C
signal, the device capacitances must ﬁrst be found. For the FET,
Cgs D
Cgso
s
1 C jVGSj
 o
D
Ciss   Crss
s
1 C jVGSj
 o
D 1:3 pF;
Cgd D
Cgdo
s
1 C jVGSj
 o
D
Crss
s
1 C jVGSj
 o
D 0:463 pF:
For the BJT,
CJC D Cobo

1 C VCB
0:75
0:33
D 7:83 pF;
CJE D Cibo

1 C VEB
0:75
0:33
D 9:47 pF;
TF D
1
2fT
  Vt
jICTj
2
6664
CJE

1   0:7
0:75
0:33 C Cobo
3
7775 D 460 ps;
and
C2 D
CJC

1 C VCB
0:75
0:33 D 4:5 pF;
C2 D gm2
!T 2
  C2 D 15:9 pF:
e high frequency response is found by using Tables 10.1 and 10.3. e common source
ampliﬁer has poles at:
!p1A 
 1
R
0
GCgs C
 1 C gmR
0
D

R
0
GCgd C R
0
DCgd
!p2A 
1
!p1AR
0
GR
0
DCgsCgd
  !p1A:
While the common-emitter with emitter degeneration ampliﬁer has a pole at:
!CE D
ŒR0SCrC .1CˇF / RE
Œ.1CˇF / .R0SRCC R0SREC RCRE/ Cr .R0SCRC/ CCr .R0SCRE/ C
:

10.11. PROBLEMS
831
e high-frequency poles are calculated to be:
!p1A D 130 Mrad=s ) 20:7 MHz;
!p2A D 2:20 Grad=s ) 3:5 GHz;
!CE D 24:3 Mrad=s ) 3:87 MHz:
ere is clearly a dominant pole and the high frequency cutoﬀ( 3:87 MHz) is more than double
the required 1500 kHz: the high frequency cutoﬀmeets speciﬁcation.
e speciﬁcations require a low frequency cutoﬀof 10 Hz. erefore, design all low fre-
quency poles at 5 Hz or less.
!L1 D 10 D
1
C1 .RS C RG/ ) C1 D 3182 pF  3300 pF;
and let CE D 4700 F.
e design is now complete.
10.11 PROBLEMS
10.1.
A rectangular pulse of duration 10 s is the input to an ampliﬁer described by a single
high-frequency pole. Plot the ampliﬁer output for the following locations of that single
pole:
(a) 10 MHz
(b) 1 MHz
(c) 100 kHz
10.2.
e output voltage response of an ampliﬁer to a input consisting of a unit voltage step is
shown. Assume the high-frequency response is characterized by a single pole. Determine:
(a) e voltage gain of the ampliﬁer.
(b) e high 3-dB frequency of the ampliﬁer.
0
1
2
3
4
5
0
t (msec)
0.01

832
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
10.3.
A rectangular pulse of duration 10 ms is the input to an ampliﬁer described by a single
low-frequency pole. Plot the ampliﬁer output for the following locations of that single
pole:
(a) 1 Hz
(b) 10 Hz
(c) 100 Hz
10.4.
e response of a unity-gain buﬀer to a 100 Hz square wave with 5 V amplitude is shown.
If the low-frequency response is characterized by a single pole, determine the low 3-dB
frequency of the unity-gain buﬀer.
3
2
1
0
1
2
3
4
5
0
t
10.5.
e low-frequency response of an ampliﬁer is characterized by three poles of frequency
30 Hz, 10 Hz, and 2 Hz and three zero-frequency zeroes. Calculate the lower 3-dB fre-
quency, fL, using the following techniques:
(a) Dominant pole approximations.
(b) Root-sum of squares approximation (Equation (10.25)).
(c) Compare results to exact calculations.
10.6.
An audio ampliﬁer is described by a single low-frequency pole, fL D 100 Hz, and a single
high-frequency pole, fH D 20 kHz.
(a) Sketch the response of this ampliﬁer to square waves of frequency:
i. fsq D 250 Hz
ii. fsq D 4 kHz
(b) Using simple, ﬁrst-order OpAmp ﬁlters to model the ampliﬁer, use SPICE to de-
termine the response of the ampliﬁer to these same square waves.
(c) Compare results of parts a) and b).

10.11. PROBLEMS
833
10.7.
A particular ampliﬁer can be described as having a midband gain of 560, three high-
frequency poles at the following frequencies:
fp1 D 25 kHz
fp2 D 75 kHz
fp3 D 150 kHz;
and a complex-conjugate pair of low-frequency poles ( D 0:6) with resonant frequency:
fo D 100 Hz:
(a) Draw the idealized Bode magnitude and phase plots. On the graph label all slopes
and use a small circle to indicate where the slope changes. Compare these straight-
line approximate curves to exact curves (use a software package to generate the exact
curves).
(b) Use dominant-pole analysis to estimate the high and low 3-dB frequencies. Com-
pare these estimates to exact calculations.
10.8.
e BJT is the given circuit is described by:
ˇF D 200
and
VA D 150 V:
(a) Determine the location of the three low-frequency poles.
(b) Which poles can be considered dominant?
(c) Determine the low 3-dB frequency of the circuit.
(d) Verify results using SPICE.
sv
+_
ov
50 Ω
2 µF
100 µF
4.7 µF
68 kΩ
1.2 kΩ
3.3 kΩ
180 kΩ
2.7 kΩ
24 V
10.9.
For the circuit shown, ﬁnd the low 3-dB frequency and the midband voltage gain. Con-
ﬁrm using SPICE.
e transistor is described by:
ˇF D 200;
fT D 600 MHz; and
VA D 200 V:

834
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
sv
+
_
+
_
ov
47 µF
20 kΩ
S
C
B1
R
2.2 kΩ
B2
R
1 kΩ
L
R
100 Ω
E
R
1
Q
1 kΩ
C
R
+10 V
10.10. e design goals for the ampliﬁer shown include maximum symmetrical output voltage
swing and a low 3-dB frequency of 70 ˙ 2 Hz. e Silicon BJT is described by:
ˇF D 150;
VA D 300 V:
Complete the circuit design: use SPICE to verify compliance with the design goals.
sv
+_
ov
50 Ω
B1
R
B1
R
1
C
E
C
1.5 kΩ
120 Ω
20 V
10.11. For the circuit shown below, ﬁnd the midband voltage gain and low 3-dB frequency. e
transistor has
ˇF D 100;
fT D 600 MHz; and
VA D 200 V:
Let RB1==RB2 D 10 k.
Conﬁrm results using SPICE.

10.11. PROBLEMS
835
sv
+
_
+
_
ov
1 µF
100 Ω
S
C
B1
R
B2
R
E
R
S
R
1
Q
1 kΩ
+6 V
10.12. For the circuit shown, ﬁnd the midband voltage gain. Complete the design to achieve a
low 3-dB frequency of 40 Hz. e transistor has
ˇF D 200 and
VA D 200 V:
sv
+
_
+
_
ov
180 kΩ
S
C
O
C
B1
R
22 kΩ
B2
R
10 kΩ
L
R
E
R
E
C
1
Q
10 kΩ
C
R
+12 V
10.13. For the circuit shown below, ﬁnd the low 3-dB frequency and the midband voltage gain.
e transistor is described by:
VPO D  4 V;
IDSS D 8 mA; and
VA D 200 V:
Conﬁrm results using SPICE.

836
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
+
_
ov
+
_
sv
20 kΩ
2.7 kΩ
S
C
D
R
O
C
1
Q
S
R
100 kΩ
G
R
4.02 kΩ
L
R
40 Ω
SS1
R
422 Ω
SS2
R
+20 V
0.33 µF
1 µF
SS
C
10 µF
10.14. e design goals for the circuit shown include a low 3-dB frequency , fL, at 80 Hz. e
MOSFET has parameters:
IDSS D 5 mA;
VPO D  2 V;
VA D 150 V:
(a) Complete the design by specifying capacitor values that will accomplish the design
goal to within ˙5%.
(b) Compare the results to SPICE simulation.
sv
+_
ov
75 Ω
330 Ω
S
C
L
C
1 kΩ
2 kΩ
10 V
10.15. e design goals for the circuit shown include a low 3-dB frequency , fL, at 50 Hz. e
MOSFET has parameters:
K D 2:5 mA=V2;
VT D 1:5 V;
VA D 120 V:

10.11. PROBLEMS
837
(a) Complete the design by specifying capacitor values that will accomplish the design
goal to within ˙5%.
(b) Compare the results to SPICE simulation.
sv
+_
ov
60 Ω
180 Ω
S
C
L
C
1
C
1 kΩ
2 kΩ
820 kΩ
220 kΩ
10 V
10.16. Design an n-JFET common-source ampliﬁer for a low 3-dB frequency of 40 Hz with a
midband voltage gain of  2. e input resistance of the ampliﬁer is 100 k. e output
resistance is 10 k. A power supply voltage of 12 V is available. e Q-point is deﬁned
by: VDS D 6 V and VGS D  1 V. e transistor parameters are:
IDSS D 5 mA; VPO D  4 V;
and
VA D 150 V:
10.17. e Silicon BJT in the circuit shown has parameters:
ˇF D 120;
VA D 200:
(a) Determine a realistic minimum value for the capacitor C so that a 75 Hz square
wave will have will experience no more than 5% sag.
(b) Determine the midband gain for the circuit.
(c) Determine the low 3-dB frequency using the capacitor chosen in part a).
sv
+_
ov
100 Ω
C
2.2 kΩ
2.7 kΩ
82 kΩ
9.1 kΩ
20 V
10.18. e design goals for the circuit shown include a lower 3-dB frequency, fL, at 100 Hz.
e Silicon BJT has parameters: ˇF D 150 and VA D 350 V.

838
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
(a) Complete the design by specifying capacitor values that will accomplish the design
goal to within ˙ 5%.
(b) Sketch the Bode voltage gain plot for the ampliﬁer.
(c) Compare results to SPICE simulation.
sv
+_
ov
50 Ω
1
C
E
C
2 kΩ
82 kΩ
12 kΩ
470 Ω
15 V
10.19. e design goals for the circuit shown include the requirement that a 100 Hz square
wave will have will experience no more than 4% sag. e Silicon BJT has parameters:
ˇF D 160 and VA D 150 V.
(a) Complete the design by specifying capacitor values that will accomplish the design
goal to within ˙ 5%.
(b) Compare results to SPICE simulation.
sv
+_
ov
50 Ω
12 kΩ
470 Ω
2 kΩ
82 kΩ
15 V
1
C
E
C
10.20. e zero-bias capacitance of a p-n junction is 2 pF and the built-in potential,  o, is
780 mV, Assume the junction grading coeﬃcient has value, m D 0:35.
(a) Plot the junction capacitance for the range of junction capacitances,  10 V  Vd 
0:75 V.

10.11. PROBLEMS
839
(b) If the capacitance value at Vd D  6 V is used as a reference, determine the maximum
% variation in the capacitance over the range  10 V  Vd   2 V.
10.21. A Silicon BJT is described by the following parameters:
ˇF D 160,
VA D 200 V,
rb D 10 ,
C D 2:5 pF,
fT D 160 MHz.
Determine the high-frequency hybrid- model for the BJT under the following bias
conditions:
(a) Ic D 2 mA.
(b) Ic D 5 mA.
10.22. e Silicon BJT is the circuit shown is described by:
ˇF D 140VA D 133 V;
rb D 12 ;
C D 3 pF;
fT D 120 MHz:
(a) Determine the high-frequency hybrid- model for the BJT.
(b) Determine the high 3-dB and low 3-dB frequencies for the given circuit.
sv
+_
ov
75 Ω
12 kΩ
470 Ω
2 kΩ
82 kΩ
16 V
4.7 µF
10.23. e Silicon BJT in the circuit shown is described by the following parameters:
ˇF D 120,
VA D 160 V,
rb D 25 ,
C D 3:5 pF,
fT D 225 MHz.
Determine the high-frequency hybrid- model for the BJT.

840
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
68 kΩ
3.3 kΩ
180 kΩ
1.2 kΩ
24 V
82 µF
10.24. e transistors in the circuit shown are identical and have the following characteristics:
ˇF D 200; fT D 600 MHz;
VA D 200 V; Cobo D 2 pF:
(a) Find the midband voltage gain.
(b) Find the high 3-dB frequency.
(c) What is the largest peak-to-peak swing attainable with this circuit?
sv
ov
+
_
+
_
100 Ω
3.3 kΩ
S
C
S
R
C1
R
2.2 kΩ
E1
R
1 kΩ
C2
R
270 Ω
E2
R
2.2 kΩ
E1
R
O
C
E
C
1
Q
2
Q
+12 V
CC
V
1 µF
1 µF
33 µF

10.11. PROBLEMS
841
10.25. Complete the design of the circuit shown for maximum symmetrical swing in the mid-
band frequency range. e transistor is described by:
ˇF D 180; fT D 600 MHz; Cobo D 8 pF;
VCE D 2:5 V;
and
VA D 200 V:
(a) Find the high 3-dB frequency. Conﬁrm using SPICE.
(b) Compare a) to the SPICE frequency response for the small-signal model of the
circuit.
(c) Compare b) to the SPICE frequency response found when using the Miller’s equiv-
alent model of the transistor.
CC
V
22 µF
33 µF
47 µF
sv
+
_
+
_
+
_
ov
51 Ω
750 Ω
O
C
C
I
S
R
S
C
B2
R
L
R
CE
V
E
R
E
C
1
Q
510 Ω
C
R
18 kΩ
B1
R
+15 V
10.26. Determine the high and low 3-dB frequencies for the circuit shown. e Silicon BJT is
described by:
ˇF D 150,
VA D 300 V,
rb D 20 ,
C D 3 pF,
fT D 200 MHz.
Sketch a Bode voltage gain plot for the circuit.

842
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
sv
+_
ov
50 Ω
13 kΩ
120 Ω
1.5 kΩ
75 kΩ
20 V
47 µF
10.27. For the circuit shown, FET is described by:
IDSS D 5 mA,
VPO D  2 V,
VA D 150 V,
Crss D 6:5 pF,
Ciss D 35 pF
(a) Determine the high 3-dB frequency for the voltage gain.
(b) Remove the capacitor shunting the resistor at the FET source (the 220 F) and
determine the high 3-dB frequency.
(c) Comment on results.
50 Ω
220 µF
sv
+_
ov
330 Ω
1.5 MΩ
2.2 kΩ
15 V
10.28. Complete the design of the ampliﬁer shown for a Q-point deﬁned by VGS D 5 V.
(a) Find the low and high 3-dB frequencies.
(b) Simulate the design using SPICE.
(c) Compare simulation in b) to a simulation of the small-signal equivalent circuit of
the ampliﬁer.

10.11. PROBLEMS
843
(d) In c), plot the voltage across all of the capacitors (including the device capacitances)
and comment on the results.
e transistor parameters are: K D 0:3 mA=V2; VT D 2 V; VA D 150 V; Ciss D 12 pF,
and Crss D 2 pF.
DD
V
1µF
10 µF
1 µF
sv
+
_
+
_
+
_
ov
51 Ω
1.5 kΩ
1.5 kΩ
O
C
S
R
S
C
G2
R
SS
R
DS
V
SS
R
SS
C
1
Q
3.48 kΩ
10 kΩ
D
R
G1
R
+20 V
10.29. e JFET in the circuit shown is described by parameters:
VPO D  1:8 V,
IDSS D 4 mA,
VA D 90 V,
Cgso D 3:5 pF,
Cgdo D 1:5 pF.
Determine the high-frequency model of the JFET for the following values of the gate
voltage:
(a) Vg D 0 V.
(b) Vg D 1 V.
g
V
3.9 kΩ
270 Ω
24 V
10.30. Determine the high and low 3-dB frequencies for the circuit shown. e JFET transistors
have parameters,

844
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
VPO D  2 V,
IDSS D 5 mA,
VA D 200 V,
Cgso D 3 pF,
Cgdo D 1 pF.
(a) Sketch a Bode voltage gain plot for the circuit.
(b) Verify results using SPICE (note: SPICE Parameters, CGS D Cgso and CGD D
Cgdo).
sv
+_
ov
240 Ω
300 Ω
100 Ω
3.9 kΩ
4.7 kΩ
1.15 MΩ
1.2 MΩ
22 nF
22 nF
20 V
10.31. e circuit below was designed with identical transistors with the following characteris-
tics:
IDSS D 10 mA; VPO D  2 V; VA D 100 V; Crss D 7:3 pF; Ciss D 26:5 pF:
Determine:
(a) the midband voltage gain.
(b) low 3-dB frequency.
(c) high 3-dB frequency.
(d) Verify the results using SPICE.

10.11. PROBLEMS
845
DD
V
1µF
1 µF
33 µF
1 µF
sv
_
_
ov
51 Ω
S
R
S
C
C
C
O
C
D1
R
1
Q
1
Q
4.7 kΩ
G1
R
510 kΩ
SS1
R
1 kΩ
G2
R
510 kΩ
SS2
R
510 Ω
SS1
C
33 µF
SS2
C
D2
R
2.7 kΩ
L
R
2.7 kΩ
+15 V
10.32. Complete the design of the circuit shown by determining a value for Rd that will achieve
a quiescent output voltage of 5 V. Determine the high and low 3-dB frequencies for the
completed circuit. e transistors are described by:
JFET:
BJT
IDSS D 2 mA
ˇF D 120
VPO D  2 V
VA D 135 V
VA D 120 V
Cobo D 6 pF at
VBC D 5 V
Cgso D 4 pF
Cibo D 15 pF at
VBE D 0:5 V
Cgdo D 1:5 pF
fT D 180 MHz at
ICT D 2:5 mA
sv
+_
ov
50 Ω
220 kΩ
1.5 kΩ
1 kΩ
+8 V
d
R

846
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
10.33. Design a three stage npn BJT ampliﬁer with an overall gain which is greater than 500 with
a high 3-dB frequency of 10 MHz and a low 3-dB frequency under 100 Hz. e tran-
sistors are identical with the following characteristics:
ˇF D 200; fT D 400 MHz; VA D 200 V;
and
Cobo D 2 pF:
A 15 V power supply is available. Conﬁrm the design with SPICE.
10.34. Given the circuit shown below with transistor parameters:
JFET: IDSS D 10 mA; VPO D  3:1 V; VA D 100 V; Crss D 6:5 pF; Ciss D 33:5 pF;
BJT: ˇF D 200; fT D 500 MHz; VA D 200 V;
and
Cobo D 5 pF:
Determine the high and low 3-dB frequencies.
0.1 µF
1 µF
33 µF
18 µF
sv
_
ov
51 Ω
S
R
S
C
C
C
O
C
D
R
1
Q
2
Q
5.1 kΩ
G
R
510 kΩ
SS
R
1 kΩ
B2
R
15 kΩ
E
R
2.2 kΩ
SS
C
33 µF
SS2
C
C
R
2.7 kΩ
B1
R
30 kΩ
L
R
2.7 kΩ
+15 V
10.35. Determine the high and low 3-dB frequencies for the circuit shown. e JFET has pa-
rameters,
VPO
D  2 V,
IDSS
D 2 mA,
VA
D 200 V,
Cgso
D 3 pF,
Cgdo
D 1 pF.
e BJT has parameters:

10.11. PROBLEMS
847
ˇF
D 150,
VA
D 200 V,
Cobo
D 7 pF at
VCB D 5 V,
Cibo
D 16 pF at
VBE D 0:5 V,
fT
D 160 MHz at
ICT D 3 mA.
Compare results to SPICE simulation.
sv
+_
ov
200 Ω
505 Ω
5.6 kΩ
15 V
10.36. For the Common-collector circuit shown, the BJT is described by:
ˇF
D 150,
rb D 30 ,
VA
D 200 V,
C
D 0:5 pF,
fT D 200 MHz.
(a) Complete the design by determining the coupling capacitors so that the low 3-dB
frequency is 10 Hz ˙ 2 Hz.
(b) What is the midband gain?
(c) Determine the high 3-dB frequency.

848
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
sv
+_
ov
5.6 kΩ
4.7 kΩ
10 kΩ
270 kΩ
6 V
10.37. In the emitter-coupled ampliﬁer circuit shown, it has been decided to ground one of the
inputs and only use a single-ended output. e transistor parameters are:
ˇF
D 120,
VA
D 250 V,
rb
D 15 ,
C
D 2 pF,
fT
D 150 MHz.
(a) Determine the quiescent conditions on all transistors.
(b) Determine the midband voltage gain of the circuit.
(c) Determine the high and low 3-dB frequencies.

10.11. PROBLEMS
849
+15 V
-15 V
sv
ov
+_
50 Ω
50 Ω
3.3 kΩ
3.3 kΩ
2.4 kΩ
10.38. e BJT cascode ampliﬁer shown uses identical transistors with parameters:
ˇF D 200,
VA D 200 V,
fT D 600 MHz,
and Cobo D 2 pF.
(a) Complete the design of the ampliﬁer for IE D  3 mA, and VCE1 D VCE2 D 3:5 V.
Find the quiescent point of all of the transistors.
(b) Determine the high and low 3-dB frequencies.
(c) Conﬁrm the results using SPICE.

850
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
sv
ov
o
C
2
Q
1
Q
4.7 µF
B11
R
B12
R
B22
R
S
C
33 µF
E
C
33 µF
1 µF
B
C
680 kΩ
C
R
1.5 kΩ
B21
R
510 kΩ
E
R
E
I
1 kΩ
CC
+V
+15 V
10.39. e transistors in the diﬀerential ampliﬁer shown below are identical and have the fol-
lowing characteristics:
IDSS D 10 mA; VPO D  4:5 V;
Crss D 7:3 pF; Ciss D 26:5 pF; Coss D 8:3 pF;
and VA D 100 V:
Determine the high and low 3-dB frequencies.
i1v
i2v
o1
v
o2
v
1
Q
2
Q
D1
R
10 kΩ
i1
R
G1
R
1 kΩ
i2
R
1 kΩ
SS
R
10 kΩ
G2
R
510 kΩ
510 kΩ
D2
R
10 kΩ
DD
V
+10 V
SS
-V
-10 V

10.11. REFERENCES
851
10.40. For the single-input diﬀerential ampliﬁer shown, ﬁnd the low and high 3-dB frequencies
Assume identical transistors with
ˇF D 120;
fT D 600 MHz;
VA D 200 V; and
Cobo D 2 pF:
i1v
o1
v
o2
v
1
Q
2
Q
C1
R
1.8 kΩ
i1
R
100 Ω
i2
R
100 Ω
EE
R
22 kΩ
C2
R
1.8 kΩ
CC
V
+12 V
EE
-V
-12 V
REFERENCES
[1] Antognetti, P. and Massobrio, G., Semiconductor Device Modeling with SPICE, McGraw-
Hill, New York, 1988.
[2] Ghausi, M. S., Electronic Devices and Circuits: Discrete and Integrated, Holt, Rinehart and
Winston, New York, 1985.
[3] Gray, P. R. and Meyer, R. G., Analysis and Design of Analog Integrated Circuits, 3rd ed.,
John Wiley & Sons, Inc., New York, 1993.
[4] Millman, J., Microelectronics: Digital and Analog Circuits and Systems, McGraw-Hill Book
Company, New York, 1979.
[5] Millman, J. and Halkias, C. C., Integrated Electronics: Analog and Digital Circuits and Sys-
tems, McGraw-Hill Book Company, New York, 1972.
[6] Savant, C. J., Roden, M. S., and Carpenter, G. L., Electronics Design: Circuits and Systems,
2nd ed., Benjamin/Cummings Publishing Company, Redwood City, 1991.

852
10. FREQUENCY RESPONSE OF TRANSISTOR AMPLIFIERS
[7] Sedra, A. S. and Smith, K. C., Microelectronic Circuits, 3rd ed., Holt, Rinehart, and Win-
ston, Philadelphia, 1991.
[8] Seymour, J., Electronic Devices & Components, 2nd ed., Longman Scientiﬁc & Technical,
Essex, U.K., 1988.
[9] Tyagi, M. S., Introduction to Semiconductor Materials and Devices, John Wiley & Sons, New
York, 1991

853
C H A P T E R
11
Feedback Ampliﬁer Frequency
Response
e basic topology of a feedback ampliﬁer, as previously described is shown in Figure 11.1.
Xi 
Xo 
Xf 
Xδ 
+
_
∑
A
f 
Figure 11.1: Basic negative feedback topology.
In Chapter 8 (Book 2) several of the beneﬁts of negative feedback were presented and
analyzed. e mixing of a portion of the output signal with the input signal was shown to provide
several beneﬁts:
• e gain of the ampliﬁer is stabilized against variation in the characteristic parameters of
the active devices.
• e input and output impedances of the ampliﬁer can be selectively increased or decreased.
• Non-linear signal distortion is reduced.
An additional beneﬁt of negative feedback is the general increase in the midband frequency
range. Previously described as a reduction in the variation of the gain due to changes in frequency,
this increase in midband frequency range is exhibited by both an increase in the high 3 dB fre-
quency, fH, and a decrease in the low 3 dB frequency, fL.¹
e above listed beneﬁts were shown to be accompanied by a drawback:
• e gain of the circuit is reduced.
¹Ampliﬁers for which fL D 0 will, with the application of negative feedback, continue to operate with no low-frequency
deterioration.

854
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
An additional drawback is the possibility of oscillations. Ampliﬁers for which the high- and
low-frequency response is described by either single or double pole expressions are shown to be
inherently stable and not subject to oscillations. If the ampliﬁer high- or low-frequency response
is described by three or more poles, the application of feedback brings forth the possibility of
instability in the form of oscillations. is possibility of instability can be controlled by either
limiting the range of applied feedback or with the addition of a compensation network to the
ampliﬁer.
In this chapter the beneﬁt of increased bandwidth and the possibility of oscillations re-
lated to negative feedback are explored in electronic ampliﬁers. As in Chapter 10, the fre-
quency response of an ampliﬁer is broken into three regions: low-frequency, midband, and high-
frequency regions. e eﬀect of feedback on the midband region was discussed thoroughly in
Chapter 8 (Book 2). Of interest here is the eﬀect of feedback on the poles that determine the am-
pliﬁer response in the low- and high-frequency regions. After deriving the pole location change
in single-pole systems, the analysis is expanded to two-pole, three-pole, and many-pole systems.
e concept of dominant poles is utilized to simplify system characterization when applicable.
While the early sections of this chapter focus on analysis techniques, the later sections focus
on design techniques to ensure stable ampliﬁer operation. Stability against oscillation is explored
through the use of Bode diagrams and computer simulation, as well as other standard stability
criteria. Several common compensation networks that can alter the pole-zero characterization of
the basic forward ampliﬁer and, thereby ensure ampliﬁer stability are also explored.
11.1
THE EFFECT OF FEEDBACK ON AMPLIFIER
BANDWIDTH (SINGLE-POLE CASE)
It has been previously shown that the gain, Af , of a feedback ampliﬁer is simply related to the
forward gain, A, of a loaded basic forward ampliﬁer and the feedback ratio, f :
Af D
A
1 C Af :
(11.1)
As in the derivations and demonstrations of Chapter 8 (Book 2), the ampliﬁer gain can be ex-
pressed as a transresistance, a current gain, a voltage gain, or a transconductance depending on
the topology of the mixing and sampling processes. e frequency response derivations presented
here are not dependent the mixing or sampling topology.
As was seen in Chapter 10, the small-signal sinusoidal forward gain of an ampliﬁer is
dependent on the frequency of the input. e high-frequency response of an ampliﬁer that is
characterized by a single high-frequency pole, !H, and a mid-band gain, Ao, is given by:
A D
Ao
1 C j !
!H
:
(11.2)

11.1. THE EFFECT OF FEEDBACK ON AMPLIFIER BANDWIDTH (SINGLE-POLE CASE)
855
When the feedback gain relationship, Equation (11.1), is applied to this single-pole frequency-
dependent gain expression, the resultant feedback gain is given by:
Af D
Ao
1 C j!
!H
1 C
0
BB@
Ao
1 C j!
!H
1
CCA f
D
Ao
1 C Aof C j!
!H
D
Ao
1 C Aof
0
BB@
1
1 C
j!
.1 C Aof / !H
1
CCA :
(11.3)
is gain is of the same form as that of a single-pole ampliﬁer with reduced gain and increased
pole frequency:
Aof D
Ao
1 C Aof
and
!Hf D .1 C Aof /!H:
(11.4)
e gain has been reduced, as expected, by the return ratio (D D 1 C Aof ) and the high-frequency
pole value has also been increased by the return ratio.
Similarly, if the low-frequency response of an ampliﬁer is characterized by a single pole:
A D
Ao
1 C !L
j!
;
(11.5)
the feedback gain can be derived to be:
Af D
Ao
1 C !L
j!
1 C
0
B@
Ao
1 C !L
j!
1
CA f
D
Ao
1 C Aof C !L
j!
D
Ao
1 C Aof
0
B@
1
1 C
!L
.1 C Aof / j!
1
CA :
(11.6)
is gain is again of the same form as that of a single low-frequency pole ampliﬁer. e feedback
ampliﬁer low-frequency pole magnitude is given by:
!Lf D
!L
1 C Aof :
(11.7)
e gain has been reduced, as expected, by the return ratio (D D 1 C Aof ) and the low-frequency
pole value has been decreased by the return ratio.
Frequency Response
e magnitude of the gain function of a general ampliﬁer with (Af ) and without (A) feedback
is shown in Figure 11.2a with frequency on a logarithmic scale. e increase in the width of

856
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
the midband frequency range is evident. In Figure 11.2b, the Bode straight-line approximate
amplitude plot is shown. It is interesting to note that the intersection of the two Bode plots
occurs at ! D !Lf and ! D !Hf. Outside the midband region of the feedback ampliﬁer, the Bode
plots are coincident. is property is a useful aid in the design of feedback ampliﬁers described
by simple poles.
Step Response
e time-domain response of a single-pole ampliﬁer to unit step is a simple exponential decay to
the ﬁnal value:
Xo.t/ D Xo.ﬁnal/ C
 Xo.initial/   Xo.ﬁnal/

e t=;
(11.8)
where
 D 2
!H
:
(11.9)
|A|
|Af |
Ao 
Aof 
.707Ao 
.707Aof 
ωLf
ωHf
ωL
ωH
ω(log scale)
(a)
20 log |Ao| 
20 log |Aof | 
20 log |1 +Ao f | 
ωLf
ωHf
ωL
ωH
ω(log scale)
20 dB/decade
–20 dB/decade
(b)
Figure 11.2: Changes to gain with the application of feedback: (a) Gain on a linear scale; (b) Idealized
Bode plot.

11.2. DOUBLE POLE FEEDBACK FREQUENCY RESPONSE
857
Application of feedback increases the high-frequency pole, !H, and consequently reduces the
time constant of the exponential decay for the step response:
f D 2
!Hf
:
(11.10)
e ampliﬁer responds more quickly to step inputs. e tilt or sag of the ampliﬁer is measured
with a pulse train of frequency, !, and is dependent on the low-frequency pole:
sag D !L
!
 100% D fL
f
 100%:
(11.11)
e application of feedback reduces !L and consequently reduces the tilt or sag of the pulse train
response.
11.2
DOUBLE POLE FEEDBACK FREQUENCY RESPONSE
e high-frequency response of an ampliﬁer that is characterized by two high-frequency poles,
!1 and !2, and a mid-band gain, Ao, is given by:
A D
Ao

1 C j!
!1
 
1 C j!
!2
:
(11.12)
In order to more appropriately study the change in pole location for multiple-pole ampliﬁers, a
change in the notation to describe frequency will be used:
j! ) s D j! C :
(11.13)
is notation is common as one progresses from Fourier analysis to Laplace analysis and should
be familiar to the reader. Under this change of variables, Equation (11.12) becomes:
A D
Ao

1 C s
!1
 
1 C s
!2
:
(11.14)
When the feedback gain relationship, Equation (11.2), is applied to this double-pole frequency-
dependent gain expression, the resultant feedback gain is given by:
Af D
Ao

1 C s
!1
 
1 C s
!2

C Aof
(11.15)

858
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
which is more commonly written in the form:
Af D
Ao
1 C Aof
0
BB@
1
1 C
s
1 C Aof
 1
!1
C 1
!2

C
s2
1 C Aof

1
!1!2

1
CCA :
(11.16)
As expected, the low-frequency gain is reduced by the return ratio. However, the new locations
of the two poles is not obvious. One heuristic approach to visualizing the general pole loca-
tion change due to various amounts of feedback is through a plot of the denominator of Equa-
tion (11.15):
P .s/ D

1 C s
!1
 
1 C s
!2

C Aof:
(11.17)
e plot of the denominator, P.s/, is shown in Figure 11.3 for four values of the loop gain, Aof.
With unity return ratio (no feedback), the curve intersects the horizontal axis at the two poles,
 !1 and  !2, of the basic ampliﬁer gain, A. Increasing the feedback raises the curve, P.s/, by
Aof and results in a translation of the two poles, seen as the intersection of the curve with the
horizontal axis, toward each other. With suﬃciently large loop gain, the curve, P.s/, no longer
crosses the horizontal axis and the poles become a complex conjugate pair.
A more rigorous approach to determining the migration of the pole locations with varying
feedback casts Equation (11.16) into the general form:
Af D
Ao
.1 C Aof /

1 C 2 s
!o
C s2
!2o
:
(11.18)
is format was initially presented in Chapter 9 and is standard for a two-pole system with
resonant frequency,
!o D
p
!1!2 .1 C Aof /I
(11.19)
and damping coeﬃcient,
 D
!1 C !2
2
p
.1 C Af /!1!2
D !1 C !2
2!0
:
(11.20)
e resonant frequency and the damping coeﬃcient depend on the original pole location and
return diﬀerence, D D 1 C Aof . e resonant frequency increases as the square root of the return
diﬀerence, while the damping coeﬃcient decreases by the same factor. With the use of the quadratic
formula, the two poles can be found to be located at:
s D  !1 C !2
2
˙ !1 C !2
2
s
1   1
2 :
(11.21)

11.2. DOUBLE POLE FEEDBACK FREQUENCY RESPONSE
859
pole
translation
pole
translation
increased
feedback
P(s)
ω
–ω1
–ω2
–ω1
Figure 11.3: Heuristic interpretation of pole migration with increasing loop gain.
As predicted by the heuristic approach, when there is a large damping coeﬃcient,  > 1, (small
amounts of feedback) there are two distinct, real poles: for small damping coeﬃcient,  < 1, (large
amounts of feedback) the argument of the square root becomes negative and the poles become a
complex conjugate pair.
It is common to display the locus of pole locations with varying damping coeﬃcient on
the complex s plane. is plot, called a root-locus plot, is shown in Figure 11.4. As the damping
coeﬃcient decreases (return diﬀerence increases) the poles converge along the real axis and then
split vertically. Notice that when the poles of this two-pole gain function become a complex
conjugate pair, the real part of the pole location remains a constant. is constancy of the real
part of the complex pair pole location indicates that the poles are always located in the left-half
of the complex plain: the resonant frequencies, est, contain an exponential decay. Consequently,
resonances do not experience uncontrolled growth and the two-pole feedback ampliﬁer is always
stable.
11.2.1 FREQUENCY RESPONSE
e frequency response of a two-pole system has been discussed extensively in Section 9.1. A
normalized plot the frequency response of a two high-frequency pole system in the general neigh-
borhood of !o with the damping coeﬃcient as a parameter (0:2    1:0 in increments of 0:1)
is shown in Figure 11.5.
In Chapter 9, a peak in the frequency response was found to exist for damping coeﬃcients
less than 1=
p
2. is characteristic is particularly important in the design of ampliﬁers: the design

860
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
ζ < 1
ζ > 1
ζ =1
ζ < 1
ζ > 1   –ω1
jω
0
–ω2
ω1 + ω2
2
σ
Figure 11.4: e root locus of a two-pole gain function.
10
5
–5
–10
–15
–20
0
0.1ω
ωo
10ωo
ζ = 0.2
ζ = 1.0
Af
Afo dB
Figure 11.5: Normalized feedback ampliﬁer gain.
requirements of good ampliﬁers rarely allows for signiﬁcant peaks in the frequency response of
the gain. e frequency at which this peak occurs is related to !o:
!peak D !o
p
1   22;
(11.22)
and has magnitude:
ˇˇAf
 !peak
ˇˇ D
ˇˇAof
ˇˇ
2
p
1   2 :
(11.23)

11.2. DOUBLE POLE FEEDBACK FREQUENCY RESPONSE
861
e design speciﬁcations on the midband ﬂatness will place an lower limit on the damping coeﬃ-
cient (and consequently the return diﬀerence). Good ampliﬁers rarely have damping coeﬃcients
less than 0:5.
In ampliﬁer design it is important to ﬁnd the change in the 3 dB frequency as feedback
is applied to the ampliﬁer. In two-pole systems, the high 3 dB frequency, !Hf, is dependent on
the resonant frequency, !o, and the damping coeﬃcient, . Each of these quantities is, in turn,
dependent on the original pole locations, !1 and !2, and the return diﬀerence, D. e calculation
of the 3 dB frequency is therefore a complicated process. One approach to this process begins with
the notational convention that the ampliﬁer before the application of feedback is described by two
simple poles with frequency ratio:
!2 D k!1:
(11.24)
It was previously shown in Section 10.2 that if k > 4, a dominant pole exists. After the application
of feedback, it is also possible that a dominate pole exists. To determine the appropriate condition
for a dominant pole with feedback, the ratio of the two feedback pole frequencies, kf , given in
Equation (11.21) is taken:
kf D
 !1 C !2
2
 
1 C
s
1   1
2
!
 !1 C !2
2
 
1  s
1   1
2
! > 4:
(11.25)
e condition necessary for a feedback dominant pole is the solution of Equation (11.25), given
by:
 
1 C
s
1   1
2
!
> 4
 
1  s
1   1
2
!
(11.26)
or
 > 1:25:
(11.27)
If this condition on the damping coeﬃcient is met, the 3 dB frequency of the system can be
obtained with the methods described in Section 10.2. While the dominant pole case is signiﬁcant,
in many cases the damping coeﬃcient is smaller than the appropriate value ( < 1:25) and other
methods of determining the 3 dB frequency must be used. e 3 dB frequency must be obtained
by analysis of the magnitude of the feedback gain equation (Equation (11.18)). If the parameter
s is replaced by its sinusoidal equivalent, s ) j!, the gain expression becomes:
Af
Aof
D
1

1 C 2 j!
!o
  !2
!2o
:
(11.28)

862
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
Which, when related to relative magnitudes, reduces to:
ˇˇˇˇ
Af
Aof
ˇˇˇˇ
2
D
1

1   !2
!2o
2
C 42 !2
!2o
:
(11.29)
e 3 dB frequency, !Hf, occurs when the gain power ratio is reduced to one-half its midband
value or when the denominator of Equation (11.29) has value 2:
 
1  !2
Hf
!2o
!2
C 42 !2
Hf
!2o
D 2:
(11.30)
Application of the quadratic formula leads to a solution for !Hf:
!2
Hf
!2o
D 1   22 C
q
.1   22/2 C 1:
(11.31)
Equation (11.19) can be recast into a form to relate !o to the lowest non-feedback pole frequency:
!o D !1
p
k.1 C Af / D !1
p
kD:
(11.32)
Which leads to a relationship between the feedback 3 dB frequency and the lowest non-feedback
pole:
!Hf
!1
D
s
1   22 C
q
.1   22/2 C 1

kD:
(11.33)
Because of the dependence of  on the initial pole spacing, k, and the return diﬀerence, D, the
true signiﬁcance of Equation (11.33) is disguised. One form of interpreting the signiﬁcance of
this expression is the ratio of 3 dB frequency to the product of the return diﬀerence and !1:
!Hf D
 s
1   22 C
q
.1   22/2 C 1
 k
D
!
.D!1/ :
(11.34)
Further insight can be obtained by replacing the return diﬀerence (inside the square root) with
its equivalent expression in k and :
D D .k C 1/2
4k2
:
Equation (11.34) now takes the form:
!Hf D
 
2k
k C 1
s
1   22 C
q
.1   22/2 C 1
 !
.D!1/ :
(11.34a)

11.2. DOUBLE POLE FEEDBACK FREQUENCY RESPONSE
863
e relationship is similar to the single pole case with an additional factor:
!Hf D K .; k/  D  !1
(11.35)
where the factor, K.; k/, is given by:
K .; k/ D 2k
k C 1
s
1   22 C
q
.1   22/2 C 1

:
(11.36)
is relationship is shown in Figure 11.6 for a variety of initial pole ratios, k.
1.4
1.3
1.2
1.1
0.5
0.8
0.9
0.6
0.7
0.4 0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
0.5
ζ
k = 2
k = 5
k = 10
k = 20
k = 50
ωH
Dω1
Figure 11.6: High 3 dB frequency as a function of  and non-feedback pole spacing.
Example 11.1
A two-pole ampliﬁer with midband gain, Ao D 1000, and two high-frequency poles, f1 D
100 kHz and f2 D 1 MHz, has feedback applied so that the midband gain is reduced to
Aof D 80:
Determine the location of the new poles and the high 3 dB frequency.
Solution
e ratio of the two pole frequencies is: k D 10. e return diﬀerence is the ratio of the
two gains:
D D Ao
Aof
D 1000
80
D 12:5:
e resonant frequency is found to be:
fo D
p
f1f2 .1 C Aof / D
p
100 k .1M/ 12:5 D 1:118 MHz

864
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
and damping coeﬃcient,
 D f1 C f2
2fo
D k C 1
2
p
kD
D
10 C 1
2
p
10  12:5
D 0:492:
e high 3 dB frequency, fH, can be found by obtaining K.; 10/ from Figure 11.6 (or Equa-
tion (11.36)) and by multiplying K.; 10/; D and f1.
fH D K.; 10/Df1 D .1:146/.12:5/.100k/ D 1:43 MHz:
e two poles are a complex conjugate pair located at
s D 2
h
 550k ˙ j550k
p
3:1311
i
D  1:1 ˙ j1:95 Mrad=s:
A plot of the ampliﬁer gain (in dB) with and without feedback is shown below.
dB
Gain
f
no feedback
with feedback
1∙104
1∙105
1∙106
1∙107
60
50
40
30
20
10
Low-frequency response
If the low-frequency response of an ampliﬁer is described by two low-frequency poles, !1L and
!2L, the gain function can be expressed as:
A D
Ao

1 C !1L
s
 
1 C !2L
s
:
(11.37)
e application of feedback to the ampliﬁer will produce a convergence of poles similar to that
described for high-frequency poles. ere are, however distinct diﬀerences. e low-frequency
resonant frequency, !oL is given by:
!oL D
r!1L!2L
1 C Af ;
(11.38)

11.2. DOUBLE POLE FEEDBACK FREQUENCY RESPONSE
865
and the expression for the damping coeﬃcient is:
L D !oL
2
 1
!1L
C
1
!2L

D k C 1
2
p
kD
:
(11.39)
e frequency response plots take the same form as for high-frequency poles with the single
exception of being mirror images on the logarithmic frequency scale. e low 3 dB frequency, !Lf,
can be determined in a similar manner as was the case for !Hf. For damping coeﬃcients, , greater
than 1.25, a dominant pole exists and the methods of Chapter 10 can be used to determine !Lf.
If the damping coeﬃcient is smaller than 1.25, the methods of this chapter are more appropriate.
If the two low-frequency poles are identiﬁed by !1L , the pole closest to the midband
region, and
!2L D !1L
k ;
(11.40)
the low 3 dB frequency is given by:
!Lf D
!1L
K .L; k/  D ;
(11.41)
where, K.; k/ is deﬁned by Equation (11.36).
e frequency response curve will also exhibit a peak if the low-frequency damping coeﬃ-
cient is less than 1=
p
2. Peaks in the low-frequency response are usually undesirable in ampliﬁers
and good ampliﬁers rarely have damping coeﬃcients less than 0.5. e frequency of this peak is
related to !oL:
!peak D
!oL
p
1   22 ;
(11.42)
and has magnitude:
ˇˇ Af
 !peak
ˇˇ D
ˇˇAof
ˇˇ
2
p
1   2 :
(11.43)
Example 11.2
A two-pole ampliﬁer with midband gain, Ao D 1000, and two low-frequency poles, f1 D 100 Hz
and f2 D 10 Hz, has feedback applied so that the midband gain is reduced to
Aof D 80:
Determine the low 3 dB frequency.

866
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
Solution:
Here the ratio of the two pole frequencies is 10. e return diﬀerence is the ratio of the
two gains:
D D Ao
Aof
D 1000
80
D 12:5:
e resonant frequency is found to be:
foL D
s
f1Lf2L
1 C Aof D
r
100 .10/
12:5
D 8:944 Hz
and damping coeﬃcient,
L D k C 1
2
p
kD
D
10 C 1
2
p
10  12:5
D 0:492:
e low 3-dB frequency, fL, can be found by obtaining K.L; 10/ from Figure 11.6 (or Equa-
tion (11.36)) and by dividing f1L by the product of K.L; 10/ and D.
fL D
f1L
K .L; 10/  D D
100
1:146 .12:5/ D 7:0 Hz:
A plot of the ampliﬁer gain (in dB) with and without feedback is shown below.
10
0 1
10
100
1000
10
40
50
60
20
Gain
f
no feedback
with feedback
11.2.2 STEP RESPONSE
e step response for an ampliﬁer with two real high-frequency poles was discussed in Sec-
tion 10.1. Feedback ampliﬁers with greater than unity value damping coeﬃcients behave is the

11.2. DOUBLE POLE FEEDBACK FREQUENCY RESPONSE
867
same manner: the step response is the sum of two exponential terms converging to a steady-
state value. Damping coeﬃcients less than unity value are underdamped systems and have a more
complex step response.
e response of an underdamped feedback ampliﬁer to a unit step is given by:
X.t/ D Aof

1  !o
!d
sin !dt C cos !dt

e !ot

;
(11.44)
where the damped frequency, !d, is given by the expression:
!d D
p
1   2!o:
(11.45)
A plot of the normalized step response of a feedback ampliﬁer is shown in Figure 11.7 for several
values of the damping coeﬃcient, .
1.6
1.4
1.2
1
0.8
0.6
0.4
0.2
00
0.5
1
1.5
2
2.5
3
3.5
X(t)
Aof
ωot
2̟
ζ
ζ
ζ
ζ
Figure 11.7: Step response of a two-pole feedback ampliﬁer.
For small values of the damping coeﬃcient, , the step response of a feedback ampliﬁer overshoots
and oscillates about the ﬁnal value before settling down to a steady-state condition. While a
small amount of overshoot is often acceptable, large overshoot is often unsatisfactory for quality
ampliﬁers. In order to quantify the response several quantities are deﬁned as follows:

868
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
Rise time
 time to rise from 10% to 90% of the ﬁnal value
Delay time
 time to rise to 50% of the ﬁnal value
Overshoot
 peak excursion above the peak value
Damped period
 time interval for one cycle of oscillation
Settling time
 time for response to settle to within ˙P % of the
steady-state value
ese parameters are displayed for a typical underdamped step response in Figure 11.8.
1.5
1.4
1.3
1.2
1.1
1
0.9
0.8
0.9
0.6
0.5
0.4
0.3
0.2
0.1
9
overshoot
rise time
delay time
settling time
error band
±P%
t
Figure 11.8: Step response for  D 0:25.
e quantifying parameters can be obtained through careful analysis of Equation (11.43).
One signiﬁcant parameter, the overshoot, is obtained by setting the ﬁrst derivative of Equa-
tion (11.43) to zero: the resultant time of the ﬁrst peak is:
tpeak D 2
!d
D
2
p
1   2!o
:
(11.46)
e peak value of the step response is given by X.tpeak/:
X
 tpeak

D Aof
0
BB@1 C e
 
p
1   2
1
CCA :
(11.47)

11.3. MULTIPOLE FEEDBACK FREQUENCY RESPONSE
869
Which is equivalent to an overshoot of
overshoot D e
 
p
1   2  100%:
(11.48)
A good ampliﬁer will have small rise, delay and settling times and a small overshoot. Rise and
delay time decrease with increased return ratio (D) while overshoot and settling time increase once
the system becomes underdamped. e design process balances the conﬂicting requirements.
Tilt or Sag
It has previously be shown the low-frequency poles tilt the constant portion of a square wave. Am-
pliﬁers described by underdamped low-frequency poles also exhibit tilted square wave response.
e response of a low-frequency underdamped ampliﬁer to a unit step is given by:
XL .t/ D Aof

cos .!dLt/   !oL
!dL
sin .!dLt/

e !oLt:
(11.49)
While this response is oscillatory, it can be approximated as
XL .t/  Aof f1   2!oLtg ;
(11.50)
for small values of !oLt. Under these approximations, the percent tilt of a square wave of frequency
! is given by
sag  2!oL
!
 100% D 2foL
f
 100%:
(11.51)
Notice that increasing feedback reduces the resonant frequency and the damping coeﬃcient: the
percent tilt will be decreased by each of these reductions.
11.3
MULTIPOLE FEEDBACK FREQUENCY RESPONSE
It has been shown that the frequency response of an ampliﬁer is dependent the pole locations.
e application of feedback alters the pole locations and therefore the frequency response. In
ﬁrst and second order systems, the migration of poles is relatively simple to describe: the poles
move in a predictable manner and remained in the left-hand plane. As a consequence, single-
pole or double-pole feedback ampliﬁers are always stable. In systems with three or more poles,
hereafter identiﬁed as Multipole Ampliﬁers, some of the poles migrate into the right-hand plane if
suﬃciently large quantities of feedback (large return diﬀerence) are applied. Multiple ampliﬁers
can become unstable.² If, however, the feedback is moderate, multipole ampliﬁers are stable and
extremely useful.
²Stability criteria and compensation are discussed in the Sections 11.4 and 11.5.

870
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
e high-frequency response of an ampliﬁer that is characterized by three high-frequency
poles, !1; !2, and !3, and a mid-band gain, Ao, is given by:
A D
Ao

1 C s
!1
 
1 C s
!2
 
1 C s
!3
:
(11.52)
When the feedback gain relationship, Equation (11.2), is applied to this triple-pole frequency-
dependent gain expression, the resultant feedback gain is given by:
Af D
Ao

1 C s
!1
 
1 C s
!2
 
1 C s
!3

C Aof
:
(11.53)
As expected, the midband gain is reduced by the return diﬀerence: the new pole locations are
obscure. e heuristic approach to pole location migration is shown in Figure 11.9. As can be
seen in the ﬁgure, the two lower-frequency poles, !1 and !2, converge and, with suﬃcient feed-
back, become a complex conjugate pair. With increased feedback, the highest magnitude pole
frequency, !3, increases in magnitude and becomes more distant from the two lower-frequency poles.
is separation of the poles is of particular interest as it indicates that the lower-frequency poles
become more dominant poles as feedback increases.
As with the two-pole case, the heuristic approach gives no insight into pole migration once
poles become a complex conjugate pair. A root-locus plot is necessary to show the pole migration
in the complex plane: Figure 11.10 shows the migration of poles for a third-order system.
e lower-frequency pole pair converge until the damping coeﬃcient associated with the
pair is of unity value. At this point, the pair diverges vertically: this migration mimics the two-
pole case. However, as feedback is increased and the damping coeﬃcient is reduced further, the
pole-pair migrates toward the right-hand plane. With large amounts of feedback, the pole-pair
crosses the axis into the right-hand plane and the system becomes unstable. Since small damp-
ing coeﬃcients are, in general, undesirable in ampliﬁers, a quality ampliﬁer with a relatively ﬂat
midband region will not suﬃciently displace the pole pair to cause instability.
As the number of poles increases, it becomes more diﬃcult to intuitively understand the
migration of poles with changes in feedback. Continued application of the heuristic interpretation
shows that the lowest pole pair will converge in all cases. Each successive pole pair thereafter will
also converge. In odd-order systems, the ﬁnal highest magnitude frequency pole will move to
even higher frequencies. e migration of the poles once they have become complex conjugate
pairs is, as usual, determined through the use of a root-locus plot.
ere are three simple rules to aid in the construction of an approximate root-locus plot for
an ampliﬁer described by high-frequency poles:

11.3. MULTIPOLE FEEDBACK FREQUENCY RESPONSE
871
increased
feedback
pole
translation
pole
translation
pole
translation
−ω3
−ω2
−ω1
P(s)
ω
Figure 11.9: Heuristic interpretation of pole migration: third-order system.
unstable
unstable
–ω3
jω
ζ >1
ζ >1
ζ >1
ζ >1
ζ = 1
–ω2
–ω1
0
σ
Figure 11.10: Root-locus of a three-pole gain function.
1. e average of the pole frequencies remains unchanged with the application of feedback. It
is given as:
o D 1
np
np
X
cD1
pc:
(11.54)

872
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
2. When a pole pair becomes underdamped (  < 1) the root-locus for that pair departs from
the real axis at an angle of 90ı. e location of the departure point is at a zero of the slope
of the denominator function, P.s/.
3. Each pole-pair root-locus approaches an asymptote that intersects the real axis at o and
diverges from the real axis at an angle of:
 D ˙180ı C m360ı
np
m D 1; 2; : : : ; np=2:
(11.55)
For example, the asymptotes for a third order system are at ˙60ı and at 180ı (seen as dotted
lines on Figure 11.10): for a fourth-order system, they are at ˙45ı and ˙135ı: for a ﬁfth-order
system, at ˙36ı, ˙108ı, ˙180ı.
Some conclusions that can be drawn from these construction rules are:
• e two lowest-frequency poles form a pole pair that will have the greatest signiﬁcance in
determining ampliﬁer high-frequency response.
• Poles that are at higher frequencies than the lowest-frequency pole pair will migrate farther
away from the pole pair. For example, in a third-order system, the second and third poles
migrate away from each other.
• If the lowest-frequency pole pair is dominant before the application of feedback, it will
remain dominant.
e consequence of these conclusions is the treatment of multipole ampliﬁers as if they
were two-pole ampliﬁers as long as the second and third poles are at least two octaves apart:
ˇˇˇˇ
!3
!2
ˇˇˇˇ  4:
(11.56)
e low-frequency response of a feedback ampliﬁer is also approximately determined by its dom-
inant poles: the pole pair that is closest to the midband region.
Example 11.3
A three-pole ampliﬁer with midband gain, Ao D 1000, and three high-frequency poles, f1 D
100 kHz, f2 D 1 MHz, and f3 D 6 MHz has feedback applied so that the midband gain is re-
duced to
Aof D 80:
Determine the high 3 dB frequency.

11.4. STABILITY IN FEEDBACK CIRCUITS
873
Solution
is ampliﬁer is the same as the ampliﬁer of Example 11.1 with the addition of an addi-
tional pre-feedback pole at 6 MHz. e ratio of the second and third pole frequencies is given
by:
ˇˇˇˇ
!3
!2
ˇˇˇˇ D
ˇˇˇˇ
f3
f2
ˇˇˇˇ D 6 MHz
1 MHz D 6  4:
e pole pair is dominant and the results of Example 11.1 are approximately valid:
fH  1:43 MHz:
A computer simulation of the exact response (including all three poles) found the 3 dB frequency
to be at fH D 1:489 MHz. e approximate result is entirely satisfactory with less than  4%
variation in the 3 dB frequency from the exact result. e three feedback ampliﬁer poles can be
numerically found to be:
p1 D  0:4332 C j1:054 MHz
p2 D  0:4332 C j1:054 MHz
p3 D  6:233 MHz:
Notice that the sum of the feedback poles is  7:1 MHz: the same as the sum of the non- feedback
poles.
11.4
STABILITY IN FEEDBACK CIRCUITS
It was shown in Chapter 8 (Book 2) that the beneﬁts of negative feedback were obtained at the
expense of reduction in gain by the reduction factor, D. An additional drawback to using feedback
in circuits is the possibility of self-oscillation: that is, the ampliﬁer may become an unstable system.
In general, a stable electronic system has an output response, that decays to zero with time when
excited by any initial energy in the system. e initial energy can take the form of random noise
in the power supply rails. A stable system in steady state does not have a time-varying output
when the input is zero. An unstable or marginally stable electronic system will have some form
of output when the input is zero.
Instability in electronic circuits stems from the fact that the forward gain of the ampliﬁer
and reverse gain from the feedback elements may be frequency sensitive. At low and high fre-
quencies, the output voltage may be shifted in phase and changed in magnitude relative to the
midband frequencies. At the mixing point in the feedback circuit, the input signal to the circuit
and the output signal of the feedback network may, because of this additional phase shift, add
rather than subtract which can result in possible oscillation.
Unstable circuit behavior can be visualized by studying Equation 8.5 (Book 2), which is
repeated here:
Af .s/ D
A .s/
1 C A .s/ f :
(11.57)

874
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
When A.s/f D  1, the total gain of the circuit Af .s/ ! 1: a condition that is intolerable in
ampliﬁers and represents an output that is essentially limited by the power rails.³
For the loop gain, A.s/f , to be negative, the combination of phase shifts by the forward
gain and the feedback ratio must cause a summation of in-phase signals at the mixing point of
the feedback ampliﬁer. Stable ampliﬁer operation requires that the magnitude of the loop gain,
jA.s/f j, to be less than unity when its phase angle approaches 180ı.⁴
11.4.1 GAIN AND PHASE MARGINS
Ampliﬁer stability can be analyzed using the magnitude and phase verses frequency plots of the
loop gain. Figure 11.11 shows the magnitude and phase verses frequency plots of a three- pole loop
gain function. e gain margin is the diﬀerence in gain (in dB) between the 0 dB loop gain (unity
magnitude) and the loop gain magnitude at a phase angle, †A.s/f , of 180ı from the midband:
that is, Gain Margin D  jA.s/f j180ı in dB. A positive value for the gain margin indicates stable
ampliﬁer operation; if the gain margin is near zero, the ampliﬁer is unstable and its output will
oscillate without regard to its input.
e phase margin is the diﬀerence between the loop gain phase angle, †A.s/f , at
jA.s/f j D 0 dB (unity magnitude) and †A.s/f D  180ı: that is,
Phase Margin D †A.s/f j0 dB C 180ı:
(11.58)
For stable operation, the phase margin must be greater than 0ı.
Alternately, the stability of a feedback ampliﬁer can be determined from the diﬀerence
between the magnitude and phase verses frequency plots of the open-loop gain and the feedback
ratio. If the feedback ratio is frequency independent (resistive), 20 log j1=f j is a straight horizontal
line on the open-loop gain magnitude verses frequency plot. e phase of f is constant for a
resistive feedback network. In the midband region, A.s/ and f both have the same sign: their
phases must be identical at either 0ı or 180ı. e magnitude of the loop gain (in dB) can be
expressed as the diﬀerence of the magnitude of the open-loop gain and the magnitude of the
inverse of the feedback ratio,
20 log jA .s/ f j D 20 log jA .s/j   20 log
ˇˇˇˇ
1
f
ˇˇˇˇ :
(11.59)
Equation (11.59) can be used to plot the magnitude and phase verses frequency characteristics
for the open-loop gain and the feedback ratio to determine ampliﬁer gain and phase margins
for varying values of the feedback ratio, f . Figure 11.12 shows how the plots of the open-loop
gain and feedback ratio can be used to determine the gain and phase margins. e phase of the
open loop ampliﬁer is plotted as a relative phase diﬀerence to the midband phase of A.s/. e
Figure shows a straight horizontal line (for a resistive network) representing the feedback ratio,
³e output voltage is actually limited by the nonlinear regions of the transistor characteristics.
⁴Recall that a 180ı phase shift causes a sign change in the signal.

11.4. STABILITY IN FEEDBACK CIRCUITS
875
20 log j1=f j, superimposed on the magnitude verses frequency plot of the open-loop gain. e
loop gain is the diﬀerence between the open-loop gain and the inverse of the feedback ratio. e
gain margin is the diﬀerence (in dB) of the inverse of the feedback ratio to the open-loop gain
magnitude (in dB) at a phase angle, †A.s/, of 180ı: that is,
Gain Margin .in dB/ D 20 log j1=f j   20 log jA.s/j180ı:
(11.60)
20
10
0
10
20
1
10
100
1000
Gain Margin
Frequency in Hz
│A(s) f │
in dB
│A(s) f │180˚
0
−45
−60
−120
−180
1
10
100
1000
Frequency in Hz
Phase Margin
A(s) f 
in degrees
A(s) f │0 dB
Figure 11.11: Deﬁnition of (a) Gain margin and (b) Phase margin.
e phase margin is the diﬀerence of the phase angle at the intersection of the magnitudes of the
open-loop gain and inverse of the feedback ratio to †A.s/ D  180ı.
It is common to specify the design of feedback ampliﬁers with gain and phase margins of greater
than 10 dB and 50ı, respectively. is assures stable ampliﬁer operation over variations in com-
ponent parameter values.
e amount of phase margin has a signiﬁcant eﬀect on the shape of the closed-loop mag-
nitude response of the feedback ampliﬁer. Using the deﬁnitions of gain and phase margin, the
frequency !1 where the loop gain is unity is,
A .j !1/ f D 1  e j;
(11.61)

876
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
where
 D 180ı   .phase margin/:
(11.62)
e closed-loop gain at !1 is,
Af .j !1/ D
A .j !1/
1 C A .j !1/ f D
1
f e j
ˇˇ1 C e jˇˇ:
(11.63)
100
80
60
40
20
0
−20 1k
10k
100k
1M
10M
100M
Magnitude
in dB
A(s)
Relative Phase
in degrees
Frequency in Hz
Gain Margin
20 log│A(s)│
20 log│Af│
20 log│1/f│
│A(s)│-180˚
q
y
0
−45
−90
−135
−180
−225 1k
10k
100k
1M
10M
100M
Frequency in Hz
Phase Margin
Figure 11.12: Alternate stability analysis technique.
e magnitude of the closed-loop gain is therefore,
ˇˇAf .j !1/
ˇˇ D
1
f
ˇˇ1 C e jˇˇ D
1
f
q
.1 C cos /2 C sin2
:
(11.64)

11.4. STABILITY IN FEEDBACK CIRCUITS
877
Using Equation (11.64), the magnitude of the closed-loop gain for a 50ı phase margin, or  D
180ı   50ı D 130ı, is
ˇˇAf .j !1/
ˇˇ D
1
f
q
.1 C cos 130ı/2 C sin2130ı
D 1:18
f
:
(11.65)
Equation (11.65) indicates that the magnitude plot of the closed-loop gain will peak by
a factor of 1.18, or 1.4 dB, above the midband gain value of 1=f . For lower phase margins, the
peaking in the magnitude plot increases. For example, for a 10ı phase margin, the closed-loop
gain magnitude plot will peak by 5.7, or 15.1 dB, above the midband gain at frequency at !1. For
a 90ı phase margin, the magnitude plot of the closed-loop gain at !1 is 0.707, or  3 dB, of the
midband gain.
For a two pole system or a three pole system that is dominated by the two lowest pole
frequencies, the phase margin is related to the damping coeﬃcient in Equation (9.17) which is
repeated here:
ˇˇAf
 !peak
ˇˇ D
ˇˇAf .!1/
ˇˇ D
1
2
p
1   2 :
(11.66)
An equation solver may be used to determine  in Equation (11.66) for a given phase margin.
Example 11.4
A feedback ampliﬁer has an open loop transfer function,
A .s/ D
100  103
 
1 C
s
2
 10  103
!  
1 C
s
2
 200  103
!  
1 C
s
2
 20  106
!
and resistive feedback ratio f D 1=100.
1. Find the gain and phase margins.
2. Is the ampliﬁer stable?
3. Plot the closed loop gain response.
Solution:
1. e Gain and Phase margins are found by plotting (either asymptotic or computer) the
open loop transfer function and the feedback ratio as shown below:

878
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
100
50
0
−50
0
−45
−90
−135
−180
−225
1k
10k
100k
1M
10M
100M
1k
10k
100k
1M
10M
100M
Magnitude
in dB
A(s) Phase
in degrees
Frequency in Hz
Frequency in Hz
Gain Margin = ±10dB
Phase Margin = ±10˚
20 log (1/f )
A(s)
40
30
−170
From the frequency plots, the Phase Margin D C10ı and Gain Margin D C10 dB.
2. e feedback ampliﬁer is just stable since Gain Margin > 0 and Phase Margin > 0. How-
ever, since the Phase Margin is less than C50ı, variations in temperature and component
parameters may cause the ampliﬁer to become unstable.
Since the circuit frequency response has dominant pole characteristics, the approximate
analysis discussed in this section may be used to determine the amount of peaking. It was
shown in this section that a 10ı phase margin corresponded to an amplitude peak of 15.1 dB
relative to the midband gain.
3. e closed loop response exhibits peaking of slightly greater than 15 dB above the midband
gain.

11.4. STABILITY IN FEEDBACK CIRCUITS
879
1k
10k
100k
1M
10M
100M
Frequency in Hz
1k
10k
100k
1M
10M
100M
Frequency in Hz
−50
−25
0
−45
−90
−135
−180
−225
0
25
50
75
Closed Loop Gain
in dB
Closed Loop Phase
in degrees
11.4.2 NYQUIST STABILITY CRITERION
An alternate method for analyzing feedback ampliﬁers was developed by H. Nyquist in 1932. e
Nyquist criterion can determine whether a linear ampliﬁer is stable.
A closed-loop feedback ampliﬁer with gain, Af .s/, is stable if it has no poles with positive
or zero real parts. Assuming that the open-loop gain and the feedback ratio are stable,⁵ only the
loop gain A.s/f need be inspected for poles with positive or zero real parts.
e Nyquist diagram is simply a polar plot of A.s/f for s on the contour shown in Fig-
ure 11.13a.
e Nyquist diagram maps the right half of the s-plane, shown in Figure 11.13a, into the
interior of the contour in the Af plane (Figure 11.13b). If there are zeros of D.s/ in the RHP, the
Af plane contour will enclose the point  1†0ı, which is called the critical point. e number
of times that the Af plane contour encircles the critical point in a counterclockwise direction is
equal to the number of zeros of D.s/ with positive real parts.
⁵e open-loop gain in electronic ampliﬁers are assumed to be stable. However, if the open-loop ampliﬁer contains feedback
elements, the open-loop gain must be analyzed for stability. Passive component feedback ratios are stable.

880
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
jω
s plane
R    ∞
σ
(a)
Im{A(jω)f }
A(jω)f plane
Re{A(jω)f }
ω = ∞
ω = 0
Increasing ω
(b)
Figure 11.13: (a) Nyquist s-plane contour; (b) A.j!/f plane contour for a loop gain with three
identical poles.
e behavior of the closed-loop response is determined largely by the nearness of the plot
of A.j!/f to the  1 point on the Nyquist diagram. Figure 11.14a is a plot of a loop gain response
that encircles the critical point and is unstable by the Nyquist criterion. Figure 11.14b is a plot of
a stable ampliﬁer whose loop gain response does not encircle the critical point.
Im{A(jω)f }
A(jω)f plane
Re{A(jω)f }
|
–1
(a)
Im{A(jω)f }
A(jω)f plane
Re{A(jω)f }
|
–1
(b)
Figure 11.14: (a) Nyquist diagram for a stable loop gain; (b) Nyquist diagram for an unstable loop
gain.
e Nyquist diagram can be used to ﬁnd the gain and phase margins of a feedback ampliﬁer.
Since stability is related to the ampliﬁer gain at  180ı phase shift, the gain margin and phase
margin are deﬁned in a Nyquist diagram as follows (Figure 11.15):
Gain margin: For a stable ampliﬁer, the ratio 1=˛ in dB, where ˛ is the distance from the  180ı
crossover on the Nyquist diagram (where the plot of A.j!/f crosses the negative real axis) to the
origin, corresponds to the gain margin: that is, gain margin ŒdB D 20 log j1=˛j. If the Nyquist
diagram has multiple  180ı crossovers, the gain margin is determined by that point that lies
closest to the critical point.

11.4. STABILITY IN FEEDBACK CIRCUITS
881
øM
Im{A(jω)f }
A(jω)f plane
Re{A(jω)f }
|
–1
1
–1
α
Figure 11.15: Gain margin and phase margin for Nyquist diagram.
Phase margin: For a stable ampliﬁer, the phase margin is the magnitude of the minimum angle
M between a line from the origin to the point where the Nyquist diagram of A.j!/f intersects
a circle of unit radius with the center at the origin and the negative real axis.
Example 11.5
A three stage transistor ampliﬁer with feedback was found to have a loop gain frequency response
that is approximately
A .j!/ f D
5
 
1 C
j!
2
 104
!3 :
(a) Plot the loop gain on the complex plane.
(b) Is the ampliﬁer stable?
(c) At what frequency does a 180ı phase shift occur for the ampliﬁer?
(d) What is the maximum magnitude of the loop gain for stable operation for networks having
this form of transfer function?
(e) What are the gain and phase margins?
Solution:
(a) Using MathCAD, the following Nyquist plot was drawn:

882
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
Im{A(jω)f }
Negative Frequencies
Positive Frequencies
Re{A(jω)f }
ω = ∞
ω = 0
4
2
–2
–4
–1
0
1
2
3
4
5
5
8
–
(b) e ampliﬁer is stable since the Nyquist plot does not encircle the  1 C j 0 point.
(c) From the expression of the loop gain, the intersection of the plot with the negative real axis
occurs when the imaginary part of the loop gain is zero. e denominator of the loop gain
is expanded to solve for the frequency where the imaginary part of the loop gain is zero,

1 C j!
!o
3
D

1   3!2
!2o

C j

3!2
!2o
  !3
!3o

;
where !o D 2  .10  103/. is expression is real when,

3!2
!2o
  !3
!3o

D 0
at the frequency, !o D 108:8 krad/s ) 17; 320 Hz.
At 17; 320 Hz, the loop gain is,
jA .j!/ f j!D108:8 krad=s D
5
1   3!2
!2
0
D
5
1   3
 
108:8  103
2
 10  103
! D  5
8:
is value is greater than  1, and as is evident from the plot of the loop gain, no encir-
clement of  1 C j0 occurs at this value of gain.
(d) e gain can be increased by 8/5 before  1 C j0 is intersected. erefore, the condition for
absolute stability for ampliﬁers having this form of loop gain transfer function is,
jA .j!/ f j <
8
5

5 D 8:
However, by doing so, there will no longer be any margin for stability and the ampliﬁer
transient response will become increasingly oscillatory as this limiting value of gain is ap-
proached.

11.5. COMPENSATION NETWORKS
883
(e) From part (c), ˛ D 5=8 and 20 log.5=8/ 1 D 4:08 dB is the gain margin. Data from the
Nyquist plot shows A.j!/f D 1 at ! D 87:5 krad/s ) 13:88 kHz and †A.j!/f D 17:3ı.
e phase margin is j†A.j!/f   180ıj D 168ı.
11.5
COMPENSATION NETWORKS
Feedback ampliﬁers have been shown to be unstable if they are characterized by negative phase
margins. In negative feedback ampliﬁers, the potential for instability is present when the ampliﬁer
open-loop (loaded basic forward) transfer function has three or more poles. Unstable ampliﬁers
can be stabilized by:
• Decreasing the loop gain, Af , of the ampliﬁer
• Adding a compensation network to the ampliﬁer to shape the loop gain frequency response
characteristic so that the phase and gain margins are positive and in the acceptable range
(desirable phase margin  50ı and gain margin  10 dB).
Careful design is required in each of these cases to ensure stable ampliﬁer operation over temper-
ature and parameter variations.
In many cases, decreasing the loop gain to achieve stability is not acceptable due to bias
or ampliﬁer gain constraints. Alternately, the designer many not have control over f , as in the
case of OpAmp circuits. Here the ampliﬁer must operate over a wide range of feedback ratios
determined by the user rather than the designer of the OpAmp. In such cases, compensation
networks are added to the ampliﬁers to increase gain and phase margins.
e placement of compensation networks in feedback ampliﬁers is of some importance.
e basic topology of the negative-feedback ampliﬁer of Figure 8.1 (Book 2) is repeated in Fig-
ure 11.16a. e triangle symbol is a linear ampliﬁer of gain A, and the rectangular symbol is the
feedback network of feedback ratio f . e compensation network must be placed in the signal path of
the linear ampliﬁer and the feedback network, as shown in Figure 11.16b. Depending on the feed-
back topology, the compensation network could be placed between ampliﬁer stages internal to a
multi-stage linear ampliﬁer or at the output of a linear ampliﬁer. It is necessary that the signal
pass through the ampliﬁer, compensation network, and the feedback network.
Compensation networks add poles or a combination of poles and zeros to the loop gain
transfer characteristic to achieve desired gain and phase margins. e following compensation
techniques and their passive-component circuit implementations are presented in this section:
• Dominant Pole,
• Lag-Lead,
• Lead,
• Phantom Zero.

884
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
◦
+
–
xi
xo
A
f
(a)
◦
+
–
xi
xo
A
f
Compensation
Network
(b)
Figure 11.16: (a) Basic negative feedback topology; (b) Compensation network added to the negative
feedback topology.
11.5.1 DOMINANT POLE (LAG) COMPENSATION
e simplest form of compensation adds an additional dominant (real) pole in the transfer charac-
teristic of the open-loop ampliﬁer gain. e transfer function of the dominant pole compensation
network is,
HDP .s/ D
1
1 C s
!p
;
where the pole location of the network, !p, is signiﬁcantly smaller than the poles of the uncom-
pensated ampliﬁer: !p << !p1; !p2.
When this compensation network is added to the circuit, the open-loop gain becomes
Acomp .s/ D A .s/ HDP .s/ D
A .s/
1 C s
!p
:
(11.67)
e dominant pole added by the compensation network is chosen so that the loop gain,
jAcomp.s/f j is 0 dB at a frequency where the poles of the uncompensated open-loop gain A.s/f
contribute negligible phase shift. Typically, the compensation network adds a dominant pole that
reduces the compensated loop gain to unity (0 dB gain) at the lowest high-frequency pole, !p1,
of the open-loop ampliﬁer. e compensation network causes a phase “lag” in the signal path.
erefore, the phase of the compensated loop gain is shifted lower in frequency which results in
increased gain and phase margins.
e method for ﬁnding the frequency of the dominant pole can be visualized as in Fig-
ure 11.17. e dominant pole of the compensation network is designed so that its transfer func-
tion has a gain of 0 dB at the ﬁrst pole frequency of the uncompensated loop gain, with a slope of
 20 dB/decade. e dominant pole frequency of the compensation network, !p, is found through

11.5. COMPENSATION NETWORKS
885
the following relationship:
0 D 20 log jAmidbandf j   20 log
!p1
!p

;
(11.68a)
or simply
!p D
!p1
Amidbandf :
(11.68b)
Magnitude
in dB
0
ωp
ωp1
ωp2
Frequency
A (s) f
–20 dB/decade
–20 dB/decade
Figure 11.17: Construction technique for dominant-pole location.
A small-signal model of the ampliﬁer can be used to determine the (loaded basic forward)
open-loop transfer function. However, the transfer function of an open-loop ampliﬁer becomes
increasingly cumbersome for open-loop characteristics with more than three poles. erefore,
it may be preferable to use SPICE computer simulations to provide a graphical output of the
compensated loop gain transfer characteristic from which the new pole locations can be found.
A simple dominant-pole compensation network, shown in the shaded area of Figure 11.18,
is added to the open-loop ampliﬁer. As stated previously, the compensation network could, de-
pending on the feedback topology, reside within the open-loop ampliﬁer so that the signal passes
through the linear ampliﬁer, compensation network, and feedback network. Here, the dominant
pole of the compensated open-loop ampliﬁer transfer function is
!p 
1
 Rp C Ro

Cp
;
(11.69)
where Ro is the output resistance of the open-loop ampliﬁer.
e procedure for designing a dominant pole compensation network is as follows:
1. Determine the midband loop gain.
2. Find the dominant high-frequency pole, fp1, or high 3-dB bandwidth of the loop gain
transfer characteristic.

886
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
vo
vs
Compensation
Network
Rp
RS
Ro
Cp
◦
Open-Loop
Amplifier
+
+
–
–
Figure 11.18: Dominant pole compensation network at output terminal of open-loop ampliﬁer.
3. Design the dominant pole of the compensation network such that the compensated loop
gain drops to 0 dB, with a slope of  20 dB/decade, at the uncompensated high 3-dB cutoﬀ
frequency.
e dominant-pole compensation network is a simple low-pass ﬁlter with a cutoﬀfrequency, fp1,
that is signiﬁcantly lower than the 3-dB frequency (fH) of the open-loop ampliﬁer. erefore,
the dominant-pole compensation network yields greater phase margin at the expense of bandwidth.
Example 11.6
Consider the OpAmp inverting ampliﬁer shown. e open-loop gain of the ampliﬁer is:
RM .s/ D
 104
 
1 C
s
2
 106
!  
1 C
s
2
 10  106
!  
1 C
s
2
 40  106
!:
vs
Ro
◦
−
+
+
–
51 Ω
180 Ω
•
e input and output resistances of the OpAmp are Ro D 75  and Ri D 1 M, respectively.
Find the gain and phase margins and, if necessary, compensate the circuit using a dominant-
pole compensation network.
Solution
Since the feedback topology of the ampliﬁer is a shunt-shunt conﬁguration, the feedback
ratio is f D  1=R2 D  1=180. e gain and phase versus frequency plots of the loop gain, RMf ,
shown essentially zero gain and phase margins. erefore, the ampliﬁer is unstable in its current
conﬁguration.

11.5. COMPENSATION NETWORKS
887
RMf (in dB)
40
20
0
–20
0
-90
–180
–270
Frequency (Hz)
100
1×103
1×104
1×105
1×106
1×107
1×108
RMf
A dominant-pole compensation network is used to stabilize the ampliﬁer. e pole location
of the compensation network is found by following the suggested dominant-pole compensation
network design procedure in this section.
e dominant-pole frequency of the uncompensated loop gain, equal to the dominant pole
of the open-loop ampliﬁer, is 1 MHz. e midband loop gain is 34.9 dB. e compensation net-
work is designed so that the magnitude of the loop gain at 1 MHz is 0 dB. Since the compensation
network has a slope of  20 dB/decade, the location of the dominant pole, fp, of the compensation
network is easily found by using the following formula:
0 D 20 log jRM;midbandf j D 20 log
 
106
fp
!
;
where RM;midband D 34:9 dB. Solving for fp yields fp D 18:0 kHz.
e compensation circuit has a dominant pole at fp D 18:0 kHz. e component values
of the compensation network are found for Rp D 0 and Ro < R2 to ensure that the feedback
resistor does not inﬂuence the dominant pole of the compensation network. e capacitance of
the compensation network is therefore
Cp D
1
2fpRo
D
1
2
 18  103
75 D 0:12 F:
vs
◦
−
+
+
–
51 Ω
180 Ω
•
0.12 µF

888
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
e compensated ampliﬁer is as shown above. e gain and phase response plots for the
feedback ampliﬁer before and after compensation are also shown below. e uncompensated am-
pliﬁer oscillation at 21 MHz of is easily observed. e compensated ampliﬁer has a much smoother
gain proﬁle and is clearly stable; however, the high 3-dB frequency is signiﬁcantly reduced: for this
example to 1.33 MHz. Also noticeable in the compensated frequency is a “bump.” Such bumps
are diﬃcult to predict exactly in multipole system, but, if necessary, can be completely eliminated
by further reducing the compensation pole frequency, fp. In this example, the bump is elimi-
nated by reducing fp by a factor of approximately two which results in a high 3-dB frequency
 750 kHz.
Gain (dB)
40
60
20
0
–20
180
90
0
–90
–180
Frequency (Hz)
100
1×103
1×104
1×105
1×106
1×107
1×108
1×109
Angle (°)
Uncompensated
gain
Compensated gain
Example 11.7
Given the two-stage shunt-series feedback ampliﬁer shown, ﬁnd the gain and phase margins. If
necessary, compensate the circuit using a dominant-pole compensation network. e capacitors
CS; Cp; CE1, and CE2 are very large and contribute only to the lower 3-dB frequency.
e BJT SPICE model parameters are BF D 200; CJE D 35:5 pF, CJC D 19:3 pF, and
TF D 477 ps.
Solution
DC analysis results in the quiescent values for the circuit: ICQ1 D 1:8 mA, VCEQ1 D 2:0 V,
ICQ2 D 2:3 mA, and VCEQ2 D 5:7 V.
e loop gain frequency characteristics are found with SPICE using the following circuit
shown. e circuit is modiﬁed to take into account the loading due to the feedback elements. e
input voltage source has been converted to a Norton source as required for shunt-series ampliﬁer
analysis.

11.5. COMPENSATION NETWORKS
889
e input and output loading eﬀects due to the feedback network are RF1 D RF C RE2 D
3 k and RF 2 D 1 k, respectively. e large capacitor CF is used to block the DC voltages in
order to maintain the bias conditions.
11.5.2 LAG-LEAD (POLE-ZERO) COMPENSATION
Although dominant-pole (lag) compensation is successful in reducing the loop gain to 0 dB be-
fore the phase shift of the open-loop ampliﬁer becomes excessive, the ampliﬁer bandwidth is
signiﬁcantly reduced. In many cases, design speciﬁcations may call for maximum bandwidth and
a speciﬁed closed-loop gain. e lag-lead compensation network, which introduces both a pole
and a zero, will usually yield a wider bandwidth ampliﬁer than a dominant-pole network. e
transfer function of the lag-lead network is
HLL .s/ D
1 C s
!z
1 C s
!p
;
!p < !z;
(11.70)
where !z is the zero location and !p is the pole location of the lag-lead network.
e lag-lead compensated open-loop gain is then
Acomp .s/ D HLL .s/ A .s/ D A .s/
1 C s
!z
1 C s
!p
:
(11.71)
e zero is chosen to be at the same frequency as the smallest high-frequency pole of the open-
loop ampliﬁer transfer function. is choice has the eﬀect of increasing the compensated band-
width over the simple dominant-pole compensated ampliﬁer. For example, given an open loop
gain transfer function
A .s/ D
Amidband

1 C
s
!p1
 
1 C
s
!p2
 
1 C
s
!p3
:
(11.72)
Here !p1 is the smallest high-frequency pole. e lag-lead compensated transfer function be-
comes
Acomp .s/ D HLL .s/ A .s/ D A .s/
1 C s
!z

1 C
s
!p1
 
1 C
s
!p2
 
1 C
s
!p3
:
(11.73)

890
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
e smallest pole of A.s/ is canceled by setting the zero of the lag-lead network at the same point;
that is,
!z D !p1:
(11.74)
e open-loop gain becomes a three-pole transfer function with a new dominant pole, !p:
A .s/ D
Amidband

1 C s
!p
 
1 C
s
!p2
 
1 C
s
!p3
:
(11.75)
Figure 11.19 is a graphical visualization of the method for ﬁnding the dominant pole of the lag-
lead compensation network. e dominant pole of the compensation network is designed so that
its transfer function has a gain of 0 dB at the second pole frequency of the uncompensated loop
gain, with a slope of  20 dB/decade. e dominant pole frequency of the compensation network,
!p, is found through the following relationship:
0 D 20 log jAmidbandf j   20 log
!p2
!p

;
(11.76a)
or
!p D
!p2
Amidbandf :
(11.76b)
Magnitude
in dB
ωp ωp1 = ωz
ωp2
Frequency
0
A ( s )f
addition of
zero
uncompensated
dominant
pole
Figure 11.19: Construction technique for ﬁnding lag-lead compensation pole and zero location.
e result of the introduction of a zero, in addition to the dominant pole, in the lag-lead com-
pensation network, is an increase in open-loop (and therefore in the closed-loop) bandwidth.
A lag-lead compensation network implementation is shown in Figure 11.20. As stated pre-
viously, the compensation network could, depending on the feedback topology, reside within the
open-loop ampliﬁer so that the signal passes through the linear ampliﬁer, compensation network,

11.5. COMPENSATION NETWORKS
891
and feedback network. e dominant pole of the compensated open-loop ampliﬁer transfer func-
tion is,
!p D
1
.Ra C Rb C Ro/ Cc
;
(11.77)
where Ra is the output resistance of the open-loop ampliﬁer. e zero of the compensation net-
work is located at the lowest pole of the open-loop ampliﬁer to increase the loop gain bandwidth,
!z D !p1 D
1
RbCc
:
(11.78)
vo
vs
Ra
RS
Ro
Rb
Cc
◦
Open-Loop
Amplifier
+
+
–
–
Figure 11.20: Lag-lead compensation network at the output terminal of the open-loop ampliﬁer.
e Bode diagrams for the transfer function of the lag-lead compensation network are shown in
Figure 11.21.
e procedure for designing a lag-lead compensation network is:
1. Find the midband loop gain.
2. Find the dominant high frequency pole, !p1, or high 3 dB bandwidth of the loop gain
transfer characteristic.
3. Find the second to the lowest pole, !p2 .
4. Design the compensation network so that the compensated loop gain drops to 0 dB, with a
slope of  20 dB/decade, at !p2 of the uncompensated loop gain characteristics.
5. Design the compensation network so that the zero of the network is at !p1 of the uncom-
pensated loop gain characteristic.
6. In some cases, the zero location may have to be changed due to interactions with the reactive
components of the open-loop ampliﬁer.

892
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
Magnitude
in dB
Phase
in Degrees
Frequency
Frequency
ωp
ωp
ωp
ωp
10ωp
ωp
ωz
ωz
ωz
ωz
ωz
ωz
pole
zero
network
–20 dB/decade
0
10
90
–90
45
–45
0
–20
20 log 
0.1
0.1
√
Figure 11.21: Bode diagrams for the lag-lead compensation network.
ere is no loop gain magnitude penalty when using a lag-lead compensation network.
Example 11.8
Compensate the unstable OpAmp inverting ampliﬁer of Example 11.6 using a lag-lead compen-
sation network.
vs
◦
−
+
+
–
51 Ω
180 Ω
•
Ro
Solution:
e open-loop gain of the ampliﬁer was given as:
RM .s/ D
 104
 
1 C
s
2
 106
!  
1 C
s
2
 10  106
!  
1 C
s
2
 40  106
!;
and the input and output resistances of the OpAmp are Ro D 75  and Ri D 1 M, respectively.

11.5. COMPENSATION NETWORKS
893
Lag-lead compensation introduces a zero at the ﬁrst pole of the open-loop gain and a pole
at a fraction of the second pole frequency.
fz D fp1 D 1 MHz
and
fpc D
fp2
Amidbandf D 10  106
.55:56/ D 180 kHz:
If one makes the design decision, Cc D 3 nF, the compensation network resistors can be calculated
to be:
Rb D
1
 2  106
Cc
D 53:0 
and
Ra D
1
 2  180  103
Cc
  Rb   Ro D 167 ;
both of which are standard values. Shown below is the circuit diagram for the compensated am-
pliﬁer. Note that the compensation network lies within the feedback loop.
vs
◦
−
+
+
–
51 Ω
53 Ω
180 Ω
167 Ω
•
3 nF
Shown below are the Bode response plots for the uncompensated ampliﬁer and the com-
pensated ampliﬁer. As was the case in Example 11.6, the compensated ampliﬁer has a much
smoother gain proﬁle and is clearly stable; however, the high 3-dB frequency is signiﬁcantly
higher than for dominant-pole compensation. For this example the high 3-dB frequency is
13.3 MHz: approximately a factor of ten higher.
Frequency (Hz)
100
1×103
1×104
1×105
1×106
1×107
1×108
1×109
180
90
0
–90
–180
Angle (°)
Gain (dB)
40
60
20
0
–20
Uncompensated
gain
Compensated gain

894
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
11.5.3 LEAD COMPENSATION (EQUALIZER)
e midband loop gain is often ﬁxed by the speciﬁcations on the closed-loop gain and bandwidth
of an ampliﬁer. If a dominant pole (or a lag-lead) network results in a bandwidth that is too
narrow, an alternate solution must be found. Since stability depends only on the phase margin, a
compensation network that would introduce phase lead at this point would be the desired alternate
solution. A simple lead network, or equalizer, has a transfer function,
HEQ .s/ D s C !eqz
s C !eqp
;
!eqp >> !eqz:
(11.79)
Note that the transfer function of the lead compensation network is similar to the lag-lead com-
pensation characteristics in Equation (11.69), except that here the pole occurs at a higher fre-
quency than the zero.
Using Equation (11.76), the lag-lead compensated open-loop gain is,
Acomp .s/ D HEQ .s/ A .s/ D A .s/ s C !eqz
s C !eqp
:
(11.80)
e zero is chosen at the second high-frequency pole location of the loop gain transfer function,
!eqz D !p2. e pole location is chosen to be signiﬁcantly large so that !eqp does not aﬀect
the bandwidth of the loop-gain. is choice has the eﬀect of increasing the compensated band-
width over both the dominant pole and lag-lead compensated ampliﬁers. However, there is a gain
penalty that is incurred when using lead compensation networks. e midband gain yields,
HEQ .0/ D !eqz
!eqp
:
(11.81)
is attenuation must be taken into account since it directly impacts midband gain.
Figure 11.22 is a graphical visualization of the method for ﬁnding the zero of the lead
compensation network. e zero of the compensation network is designed so that its transfer
function has zero at the second pole frequency of the uncompensated loop gain, with a slope of
 20 dB/decade, !eqz D !p2. e zero frequency of the compensation network is found through
the following relationship:
0 D 20 log jAmidbandj   20 log
!p1
!z

;
(11.82a)
or simply,
!z D
!p1
Amidband
:
(11.82b)
For example, if an open-loop transfer function has the form,
A .s/ D
Amidband

1 C
s
!p1
 
1 C
s
!p2
 
1 C
s
!p3
;
(11.83)

11.5. COMPENSATION NETWORKS
895
Magnitude
in dB
ωp1
ωp2 = ωeqz ωeqp
Frequency
0
A ( s )f
uncompensated
addition of
zero
compensation
pole
A ( 0 ) f
HEQ( 0 )A ( 0 ) f
Figure 11.22: Construction technique for ﬁnding the lead compensation pole and zero locations.
where !p1 is the smallest pole, the lead compensated loop-gain transfer function becomes,
Acomp .s/ f D
AmidbandHEQ .0/ f

1 C
s
!eqz


1 C
s
!eqp
 
1 C
s
!p1
 
1 C
s
!p2
 
1 C
s
!p3
:
(11.84)
e second lowest pole of A.s/ is canceled by setting the zero of the lead network at the same
point; that is,
!eqz D !p2:
(11.85)
e lead network cancels the second-lowest ampliﬁer pole. e pole in the lead compensation
network is chosen to be large enough so that it has little eﬀect on the phase margin. e open-
loop gain becomes the three-pole transfer function,
Acomp .s/ f D
AmidbandHEQ .0/ f

1 C
s
!eqp
 
1 C
s
!p1
 
1 C
s
!p3
;
(11.86)
where !eqp >> !p3 > !p1 or if !p1 is dominant, !p3 >> !eqp >> !p1. e introduction of a
zero in the lead compensation network results in an increase in open-loop (and therefore in the
closed-loop) bandwidth.
A lead compensation network implementation is shown in Figure 11.23. As stated previ-
ously, the compensation network could, depending on the feedback topology, reside within the
open-loop ampliﬁer so that the signal passes through the linear ampliﬁer, compensation network,
and feedback network. e zero of the compensation network is located at the second lowest pole
frequency of the open-loop ampliﬁer characteristics to increase bandwidth,
!eqz D
1
RaCc
:
(11.87)

896
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
vo
vs
Ra
RS
Ro
Rb
Cc
◦
Open-Loop
Amplifier
•
•
+
+
–
–
Figure 11.23: Lead compensation network at output terminal of open-loop ampliﬁer.
e pole location of the compensation network,
!eqp D
1
.Ra==Rb/ Cc
(11.88)
is chosen to be signiﬁcantly large so as to have minimal eﬀect the loop gain crossover point (0 dB
point). Using Equations (11.81), (11.87), and (11.88), yields the expression for the attenuation
due to the compensation network,
H .0/ D
Rb
Ra C Rb
:
(11.89)
e actual output signal attenuation taking into account the output resistance of the open-loop
ampliﬁer is,
H 0 .0/ D
Rb
Ro C Ra C Rb
:
(11.90)
e resistor values must be carefully selected so that the closed-loop ampliﬁer gain is acceptable.
e Bode diagrams for the transfer function of the lead compensation network are shown
in Figure 11.24.

11.5. COMPENSATION NETWORKS
897
Magnitude
in dB
Phase
in Degrees
Frequency
ωeqz
ωeqz
ωeqz
ωeqz
ωeqp
ωeqp
ωeqp
ωeqp
pole
zero
network
+20 dB/decade
0
10
90
–90
45
–45
0
–20
20 log 
√
Figure 11.24: Bode diagrams for the lead compensation network.
Example 11.9
Compensate the unstable OpAmp inverting ampliﬁer of Example 11.6 using a lead compensation
network.
Solution
e open-loop gain of the ampliﬁer was given as:
RM .s/ D
 104
 
1 C
s
2
 106
!  
1 C
s
2
 10  106
!  
1 C
s
2
 40  106
!;
with output resistance, Ro D 75 .
Lead compensation requires that a zero be inserted at the second pole frequency and a pole
at a frequency higher than the third pole frequency. e signiﬁcant equations are:
fz D fp2 D
1
2RaCc
and
fpc D
1
2 .Ra==Rb/ Cc
:
With the design choice Cc D 0:2 pF and fpc D 2fp3 D 80 MHz, the resistor values in the circuit
of Figure 11.23 are determined to be:
Ra D 79:6 k
and
Rb D 11:4 k:
Shown below are the Bode response plots for the uncompensated ampliﬁer and the com-
pensated ampliﬁer. e compensated ampliﬁer has a very smooth gain proﬁle and is clearly stable.

898
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
e high 3-dB frequency is approximately the same as for lag-lead compensation: it is approx-
imately 10.5 MHz for this case. e gain reduction suﬀered by the design choices for the lead
compensation network was approximately 1 dB: a reduction from 44.95 dB to 43.94 dB.
Frequency (Hz)
100
1×103
1×104
1×105
1×106
1×107
1×108
1×109
180
90
0
–90
–180
Angle (°)
Gain (dB)
40
60
20
0
–20
Uncompensated
gain
Compensated gain
11.5.4 PHANTOM ZERO COMPENSATION
Instead of shaping the open-loop transfer characteristics of an ampliﬁer, the loop gain may be
altered by the addition of reactive elements in the feedback network, f , for compensating a feed-
back ampliﬁer. e use of the reactive elements in the feedback circuit is essentially equivalent to
adding lead compensation: the locations of the zero and the pole for a phantom compensation
network are the same as that of the lead compensation network. Figure 11.25 shows phantom
zero compensation for a shunt-shunt feedback ampliﬁer. e shaded area in the ﬁgure consti-
tutes the phantom compensation network. Note that removal of the capacitor, Cf , results in a
simple resistive shunt-shunt feedback ampliﬁer.
Another slightly diﬀerent version of phantom zero compensation is the Miller compen-
sation method shown in Figure 11.26. In the Miller compensation method, a capacitor, Cf , is
placed in shunt between the collector and base (drain and gate for FETs) of an internal transistor
ampliﬁer stage that establishes the ampliﬁer’s lowest high frequency pole, !p1. e eﬀect will be
an increase in the input capacitance due to Miller’s eﬀect, which in turn, reduces !p1 and results
in a dominant pole.
e advantage of Miller’s compensation is the reduction of the capacitance value compared
to the techniques shown in Sections 11.5.1–11.5.3. e small value of Cf is multiplied by the
Miller-eﬀect factor (ampliﬁer gain) resulting in a much larger capacitance value. Since small values
of Cf can be used, Miller’s compensation may be used in integrated circuit design.

11.6. CONCLUDING REMARKS
899
vo
vs
Rf
RS
Cf
◦
◦
•
•
A
+
+
–
–
Figure 11.25: Phantom zero compensation for a shunt-shunt feedback ampliﬁer.
RC
VCC
RE
Cf
Previous
Amplifier Stage
Next
Amplifier Stage
•
•
Figure 11.26: Miller’s compensation method using shunting capacitor.
11.6
CONCLUDING REMARKS
Frequency response of feedback ampliﬁers is discussed in this chapter. e eﬀects of feedback
on the poles in the low and high frequency regions were investigated. It was shown that pole
locations changed with feedback. In particular, the low frequency pole decreased with increased
return ratio and the high frequency pole increased with increased return ratio. is “pole-splitting”
phenomenon was discussed for single, double, and multipole feedback frequency responses.
Time domain eﬀects of feedback were also shown to be dependent on the return ratio. e
rise and delay times (with step inputs) decrease with increased return ratio, while overshoot and
settling times increase once the ampliﬁer becomes underdamped. Increased feedback proved to
reduce the damping coeﬃcient in double pole feedback ampliﬁers resulting in a decrease in the
percent tilt.

900
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
e root-locus method was introduced as a tool to analyze the pole behavior with feedback.
A simple set of rules was established to aid in the construction of approximate root-locus plots of
ampliﬁers described by high-frequency poles. e concept of dominant poles was used to simplify
ampliﬁer frequency characteristics when applicable.
e stability of ampliﬁers was investigated. Stable systems were deﬁned and the conditions
for instability discussed. Design goals for stability were related to frequency response analysis (or
Bode plots). Gain and phase margins were deﬁned and used to quantify stability. An alternate
method, developed by Nyquist, for determining stability was also discussed.
Methods to compensate for unstable ampliﬁers were established. ese methods include
the addition of electrical networks to shift the pole locations of the ampliﬁers. e trade-oﬀs for
each compensation technique were presented.
Summary Design Example: Fiber-Optic Transimpedance Preampliﬁer
Fiber-optic receivers consist of a photodiode, which can be modeled as a current source and a
parallel capacitor, and amplifying electronics. e ﬁrst stage of ampliﬁcation, which is often called
the preampliﬁer is critical in determining the performance of a ﬁber-optic receiver. A moderately
low input resistance ampliﬁer is often used as the preampliﬁer. e low input resistance allows for
the RC time constant of the ampliﬁer and the photodiode shunt capacitance to be small, allowing
for large bandwidth operation. Since the input signal can be modeled as a current source, output
voltages are desired, and large transresistances are required to amplify the low input currents, a
transimpedance (transresistance) ampliﬁer is often used.
Low cost transistor components can be used for low bandwith applications. Low data rate
(corresponding to moderate bandwidth) ﬁber-optic links are often used in simple computer net-
works. For a 32 kbit/s link, a high frequency cutoﬀof approximately 22.4 kHz is required. With
proper digital encoding, the low cutoﬀfrequency is approximately 1 kHz. e minimum mid-
band transresistance requirement is  2000. A photodiode with a 10 pF shunt capacitance and
responsivity of 0.9 A/W is used. A C6 V power supply is available. e npn BJT parameters are:
ˇF D 150;
VA D 160 V;
rb D 30 ;
Cibo D 8 pF
at
VEB D 0:5 V;
Cobo D 4 pF
at
VCB D 5 V;
and
fT D 300 MHz:
Design the ﬁber-optic preampliﬁer to meet the required speciﬁcations.

11.6. CONCLUDING REMARKS
901
Solution:
e transimpedance ampliﬁer topology is shown below:
vo
ip
RE
Rf
RC
+VCC
Cp
◦
◦
•
•
•
•
•
Since the transresistance must be at least  2000 , let Rf D 3:3 k, which will allow the ampli-
ﬁer to exceed the required speciﬁcations.
Also let IC D 3:8 mA and VCE D 0:785 V. is allows for a small value for r D 1:02 k
and gm D 0:146.
Let the value of the emitter degenerative resistor RE D 27 , then the collector resistor is
RC D 3:9 k.
e midband loaded forward ampliﬁer is shown below:
vo
ip
  Rf
3.3 kΩ
if
Ro
Ri
◦
◦
•
•
•
•
•
•
•
  RE
27 Ω
  RC
3.9 kΩ
  Rf
3.3 kΩ
+
–
e feedback quantity is,
f D if
vo
D  1
3300:
e input resistance is,
Ri D 3300 kŒr C rb C .1 C gmr/ 27 D 2 k:

902
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
e output resistance is,
Ro D 3:9 k==3:3 k D 1:79 k:
e ampliﬁer forward transresistance is,
RM D vo
ip
D AvRi D  105:2 k:
e feedback quantities of interest are:
D D 1 C Af D 32:9
Rif D Ri
D D 60:8 
Rof D Ro
D D 54:3 
RMf D RM
D D  3:2 k;
which meets the midband transresistance speciﬁcation.
One ﬁnds the frequency response of the transimpedance ampliﬁer by determining the ca-
pacitances for the BJT and the frequency response of the loaded forward ampliﬁer.
CJC D Cobo

1 C VCB
0:75
0:33
D 7:83 pF;
CJE D Cibo

1 C VEB
0:75
0:33
D 9:47 pF;
TF D
1
2fT
  Vt
jICT j
2
6664
CJE

1   0:7
0:75
0:33 C Cobo
3
7775 D 460 ps;
and
C D
CJC

1 C VCB
0:75
0:33 D 7:6 pF:
C D gm
!T
  C D 70 pF:
e high-frequency response is found using the equations found in Table 9.3 for a Common-
emitter with emitter-degeneration ampliﬁer:
!H D

R0
SCrC .1CˇF / RE


.1CˇF /
 R0
SRCC R0
SREC RCRE

Cr
 R0
SCRC

CCr
 R0
S C RE

C
D 1:16 Grad=sec
)
184 kHz:

11.7. PROBLEMS
903
erefore, the high frequency cutoﬀof the feedback ampliﬁer is,
!H D D  184 kHz D 6:0 MHz:
Which easily fulﬁlls the speciﬁcation for the high frequency cutoﬀ.
Since the preampliﬁer does not use external capacitors, the low frequency response extends
to DC.
11.7
PROBLEMS
11.1.
e voltage gain of an ampliﬁer is described by the following quantities:
midband gain - 1000
low 3 dB frequency - 100 Hz
high 3 dB frequency - 50 kHz
(a) Assume that the high- and low-frequency responses are characterized by single
poles. Feedback is to be applied to increase the bandwidth of the ampliﬁer by a
factor of ten (10). Assuming the feedback network does not load the initial ampli-
ﬁer, what return diﬀerence is necessary to accomplish the design goal? Determine
the new midband gain and the high and low 3 dB frequencies after the application
of feedback.
(b) Upon a more careful analysis of the original ampliﬁer (prior to application of feed-
back) it was discovered that a second high-frequency pole exists at 1 MHz. What
eﬀect will this second pole have on the feedback ampliﬁer speciﬁed by the results of
part a)?
11.2.
An audio ampliﬁer is described by two high-frequency poles at 25 kHz and 60 kHz. It is
desired to increase the bandwidth with the application of feedback without signiﬁcantly
destroying the step response of the ampliﬁer. A design goal of no more than 2% overshoot
is established. Assuming that the feedback network will not change the pole location of
the original ampliﬁer, determine the following:
(a) the maximum high 3 dB frequency that can be obtained.
(b) the rise time before and after the application of feedback.
11.3.
e response to an OpAmp non-inverting ampliﬁer to a unit step voltage input is shown.
Assume the ampliﬁer frequency response is characterized by a single high-frequency pole.

904
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
3.2
3
2.8
2.6
2.4
2.2
2
1.8
1.6
1.4
1.2
1
0.8
0.6
0.4
0.2
0
t(ns)
v(t)
0
2
4
6
8
10
12
14
16
(a) Determine the high 3 dB frequency.
(b) Determine the gain bandwidth product (GBP) of the ampliﬁer.
(c) If the OpAmp has an open loop gain of 110 dB, what is the 3 dB frequency of the
OpAmp open loop gain?
11.4.
An ampliﬁer is described by two low-frequency poles at
fL1 D 50 Hz
fL2 D 4 Hz:
(a) Determine the low 3 dB frequency of this ampliﬁer.
(b) Estimate the sag that a 1 kHz square wave will experience passing through this
ampliﬁer.
(c) It is desired to reduce the sag to 1% with the application of feedback. What return
ratio, D, will result in that amount of sag?
(d) What is the new 3 dB frequency of the resultant feedback ampliﬁer?
11.5.
e current gain of an ampliﬁer is described by the following quantities:
midband gain - 10 A/mA
low 3 dB frequency - 120 Hz
high 3 dB frequency - 2.4 MHz
(a) Assume the high- and low-frequency responses are characterized by single poles.
Feedback is to be applied to increase the high 3 dB frequency to 20 MHz. Assuming
the feedback network does not load the initial ampliﬁer, what return diﬀerence is
necessary to accomplish the design goal? Determine the new midband gain and the
low 3 dB frequency after the application of feedback.
(b) Upon a more careful analysis of the original ampliﬁer (prior to the application of
feedback) it was discovered that a second low-frequency pole exists at fL2 D 10 Hz
and a second high-frequency poles exists at fH2 D 48 MHz. What eﬀect will these
initially non-dominant poles have on the feedback ampliﬁer speciﬁed by the results
of part a)?

11.7. PROBLEMS
905
11.6.
An audio ampliﬁer is described by a midband gain of 420, a single low-frequency pole
at:
fL1 D 100 Hz;
and two high-frequency poles at:
fH1 D 14 kHz
and
fH2 D 26 kHz:
e ampliﬁer is to be redesigned as a feedback ampliﬁer so that the midband region will
be extended to at least cover the frequency range 40 Hz  f  20 kHz. Assuming that
the application of feedback does not alter the original ampliﬁer, determine the following
properties of the redesigned ampliﬁer:
(a) the minimum feedback ratio, f , that will accomplish the new design goals.
(b) the feedback return diﬀerence, D.
(c) the high and low 3 dB frequencies.
(d) the midband gain.
(e) are there any peaks in the frequency response? If so, determine the peak character-
istics.
11.7.
An audio ampliﬁer is described by a midband gain of 251, two low-frequency poles at
fl1 D 60 Hz
and
fl2 D 20 Hz;
and two high-frequency poles at
fh1 D 40 kHz
and
fh2 D 100 kHz:
e ampliﬁer is to be redesigned as a feedback ampliﬁer so that the midband region
will be as large as possible without introducing any peaks in the frequency response.
Assuming that the application of feedback does not alter the original ampliﬁer, determine
the following properties of the redesigned ampliﬁer:
(a) the minimum feedback ratio, f , that will accomplish the new design goals.
(b) the feedback return diﬀerence, D.
(c) the high and low 3 dB frequencies.
(d) the midband gain.
11.8.
A designer is attempting to create a feedback ampliﬁer with a midband voltage gain of 40.
e basic forward gain elements of this ampliﬁer are two ampliﬁer stages (each described
by single high- and low-frequency poles) with properties:

906
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
#1
#2
midband voltage gain
15
20
high 3 dB frequency
30 kHz
20 kHz
low 3 dB frequency
40 Hz
30 Hz
Assume that series interconnection of the ampliﬁer stages does not change the above
stated properties.
(a) Apply global feedback to the ampliﬁer so that a gain of 40 is obtained and determine
the resultant frequency response.
•
•
vi
vo
A1
A2
g
f
(b) Unfortunately the technique of part a results in signiﬁcant peaks in the frequency
response. An alternate approach is proposed whereby an attenuator is placed in the
forward gain path as shown. Determine the values of the attenuation factor, g, and
feedback ratio, f , that will result in maximum bandwidth, no peaks in the frequency
response, and a voltage gain of 40. Note, for this conﬁguration, the feedback gain is
given by:
Af D
A1gA2
1 C f A1gA2
:
(c) What are the high and low 3 dB frequencies for the ampliﬁer designed in part b)?
11.9.
Another circuit topology that might be used to accomplish the design goals of the pre-
vious problem incorporates both local and global feedback. For the topology shown, de-
termine the local and global feedback ratios, fLocal, and fGlobal, that will maximize the
bandwidth and produce a voltage gain of 40 without introducing any peaks in the fre-
quency response. e individual, non-interacting ampliﬁer stages are described by:
•
•
•
•
vi
vo
A1
A2
fglobal
flocal

11.7. PROBLEMS
907
#1
#2
midband voltage gain
15
20
high 3 dB frequency
30 kHz
20 kHz
low 3 dB frequency
40 Hz
30 Hz
11.10. A macromodel for a A741 Bipolar OpAmp is provided in most SPICE-based circuit
simulators.
(a) Use SPICE to determine the frequencies of the ﬁrst two high-frequency poles of
the A741 OpAmp. Assume a resistive load of 820 .
(b) Design a simple inverting ampliﬁer with a voltage gain of  10. Use SPICE to de-
termine the high 3 dB frequency of this ampliﬁer.
(c) Compare the results of part b) to those predicted by feedback theory.
11.11. A macromodel for an LM324 Bipolar OpAmp is provided in most SPICE-based circuit
simulators.
(a) Use SPICE to determine the frequencies of the ﬁrst two high-frequency poles of
the LM324 OpAmp. Assume a resistive load of 560 .
(b) Design a simple non-inverting ampliﬁer with a voltage gain of C8. Use SPICE to
determine the high 3 dB frequency of this ampliﬁer.
(c) Compare the results of part b) to those predicted by feedback theory.
11.12. A macromodel for an LF411 JFET input OpAmp is provided in most SPICE-based
circuit simulators.
(a) Use SPICE to determine the frequencies of the ﬁrst two high-frequency poles of
the LF411 OpAmp. Assume a resistive load of 1 k.
(b) Design a simple non-inverting ampliﬁer with a voltage gain of C15. Use SPICE to
determine the high 3 dB frequency of this ampliﬁer.
(c) Compare the results of part b) to those predicted by feedback theory.
11.13. e transistors in the given feedback ampliﬁer circuit are 2N2222. e quiescent condi-
tions have been previously determined to be:
Ic1  Ic2  2:0 mA:

908
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
vs
Q1
Q2
◦
◦•
•
•
•
•
•
•
+
–
10 μF
10 μF
1 kΩ
12 V
2 kΩ
330 Ω
100 Ω
3.3 kΩ
4.7 kΩ
vo
(a) Determine the midband voltage gain and approximate 3 dB frequencies of the am-
pliﬁer.
(b) Compare hand calculations to PSpice simulation.
11.14. For the single stage feedback ampliﬁer shown, determine the high and low 3 dB frequen-
cies.
e FET parameters are:
K D 1 mA=V2
Crss D 1:3 pF
VT D 1:5 V
Ciss D 5:0 pF
VA D 160 V:
vs
vo
◦
◦
•
•
•
•
+
–
22 μF
12 V
100 Ω
100 μF
3.3 kΩ
1.8 kΩ
8.2 kΩ

11.7. PROBLEMS
909
11.15. e transistors in the given feedback ampliﬁer circuit are 2N3904. e quiescent condi-
tions have been previously determined to be:
Ic1  Ic2  1:32 mA:
vs
vo
◦
◦
•
•
•
•
•
•
•
•
•
•
+
–
30 V
500 Ω
200 Ω
10 μF
5.6 μF
Q1
Q2
1.2 kΩ
1.6 kΩ
6.7 kΩ
20 kΩ
12 kΩ
10 μF
(a) Determine the midband voltage gain and approximate 3 dB frequencies of the am-
pliﬁer.
(b) Compare hand calculations to PSpice simulation.
11.16. For the ampliﬁer shown, determine the high and low 3 dB frequencies. e JFETs are
described by:
VPO D  2 V
IDSS D 4 mA
VA D 200 V
Crss D 1:0 pF
Ciss D 5:0 pF:

910
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
vs
vo
◦
◦
•
•
•
•
•
•
•
•
•
•
+
–
15 V
330 Ω
870 kΩ
910 kΩ
22 μF
0.1 μF
2.2 kΩ
75 Ω
4.7kΩ
3.9 kΩ
100 μF
180 Ω
Verify the analysis using SPICE.
11.17. e transistor in the given feedback ampliﬁer circuit is a 2N3904 (description is given in
the PSpice libraries).
vi
vo
◦
◦
•
•
•
+
–
82 Ω
C
47 kΩ
2.2 kΩ
500 Ω
10 V
(a) Complete the ampliﬁer design by determining a realistic value for the capacitor, C,
that will result in a low 3 dB frequency  100 Hz.
(b) Determine the high 3 dB frequency of the ampliﬁer.
(c) Use SPICE to determine the high and low 3 dB frequencies of the ﬁnal design:
compare the simulation results to hand calculations. Comment.
11.18. Determine the high and low 3 dB frequencies for the feedback ampliﬁer shown. Assume
the following circuit parameters:

11.7. PROBLEMS
911
BJTs - 2N2222
Coupling capacitors - 10 F
Bypass capacitor - 1000 F
Feedback capacitor - 1000 F .
Compare results to SPICE simulation.
vs
vo
◦
◦
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
+
–
12 V
470 Ω
100 Ω
10 kΩ
1.2 kΩ
2.2 kΩ
500 Ω
4.4 kΩ
82 kΩ
1 kΩ
1.2 kΩ
A
11.19. Compute the high and low 3 dB frequencies for the ampliﬁer of the previous problem if
the mixing point is moved to location “A.” Compare results to SPICE simulation.
11.20. Determine the high and low 3 dB frequencies for the feedback ampliﬁer shown. Assume
the following circuit parameters:
BJTs - 2N2222
Coupling capacitors - 20 F
Bypass capacitor - 2200 F

912
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
vs
vo
◦
◦
•
•
•
•
•
•
•
•
•
•
•
•
•
•
+
–
12 V
470 Ω
100 Ω
10 kΩ
2.2 kΩ
500 Ω
4.4 kΩ
82 kΩ
1 kΩ
1.2 kΩ
1.2 kΩ
Q1
Q2
CL
(a) Compare results to SPICE simulation.
(b) e frequency response for this circuit is not ﬂat in the midband. Modify the circuit
so that the midband region is ﬂat. Use SPICE to verify that the design modiﬁcations
improve the midband region.
11.21. In the previous problem the load capacitor, CL, is included within the feedback ampliﬁer
due to the sampling point of the feedback network. Assume the sampling point is moved
to the collector of Q2 and a 100 F capacitor is inserted in series with the 1.2 k feedback
resistor: this change essentially removes CL from the feedback ampliﬁer.
(a) Determine the high and low 3 dB frequencies of the modiﬁed circuit.
(b) Compare results to SPICE simulation.
11.22. A particular series-shunt feedback ampliﬁer can be described as having a midband voltage
gain of 10,000 with three high-frequency poles at the following frequencies:
fp1 D 1 MHz
fp2 D 4 MHz
fp3 D 25 MHz;
(a) Write an expression for Av as a function of frequency.
(b) Draw the idealized Bode magnitude and phase plots. On the graph label all slopes
and use a small circle to indicate where the slope changes.
(c) At what frequency will this feedback ampliﬁer oscillate (if it oscillates at all)?
(d) In order to have at least 45ı phase margin, what is the amount of feedback that can
be added? Is this a maximum or a minimum for stable ampliﬁer operation?
(e) What is the gain margin for the amount of feedback determined in part c)?

11.7. PROBLEMS
913
11.23. An ampliﬁer can be described by a midband gain of 251, two low-frequency poles at
fl1 D 60 Hz
and
fl2 D 20 Hz;
and four high-frequency poles at
fh1 D 40 kHz
fh2 D 100 kHz
fh3 D 200 kHz
and
fh4 D 1 MHz:
(a) Draw the idealized Bode magnitude and phase plots. On the graph label all slopes
and use a small circle to indicate where the slope changes. Compare these straight-
line approximate curves to exact curves (use a software package to generate the exact
curves).
(b) At what frequency will this feedback ampliﬁer oscillate (if it oscillates at all)?
(c) In order to achieve a gain margin of at least 5 dB, what is the amount of feedback
that can be added? Is this a maximum or a minimum for stable ampliﬁer operation?
(d) What is the phase margin for the amount of feedback determined in part c)?
11.24. If the loop gain of an inverting ampliﬁer is
A .j!/ f D
 250
.1 C j!/ .1 C j0:01!/2 :
Determine whether the ampliﬁer is stable using:
(a) the Nyquist plot
(b) the gain and phase plot of the loop gain.
11.25. e loop gain of an inverting ampliﬁer is
A .j!/ f D
 K
.1 C j0:01!/3 :
(a) If K D 5, is the ampliﬁer stable?
(b) What value of K deﬁnes a gain margin of greater than 10 dB and phase margin of
greater than 50ı?
11.26. e loop gain of an ampliﬁer is
A .j!/ D
24000

1 C
j!
2  105
2 
1 C j!
105
:
with a feedback factor f D  5,

914
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
(a) plot the magnitude and phase of the loop gain
(b) determine whether the ampliﬁer is stable. If the ampliﬁer is stable, determine the
gain and phase margins.
11.27. An OpAmp with an open loop gain of
A .j!/ D
105

1 C j!
105
2 
1 C j!
102
:
is used to design an inverting ampliﬁer with a gain of  125. Determine the gain and
phase margins of the inverting ampliﬁer using:
(a) the Nyquist plot
(b) the gain and phase plot of the loop gain.
11.28. Sketch the Nyquist plot of the loop gain for a three pole ampliﬁer with a DC open
loop gain of Ao D  1100, and open-loop poles at 500 kHz, 1.1 MHz, and 1.8 MHz.
Determine whether the ampliﬁer is stable with the following feedback factors:
(a) f D  0:005
(b) f D  0:02
(c) Determine the maximum value of f for which the ampliﬁer is stable.
11.29. A three pole ampliﬁer has an open-loop DC gain of  1000 and poles located at 1.1 MHz,
12 MHz, and 28 MHz. Dominant pole compensation is applied to the ampliﬁer.
(a) Find the proper location of the dominant pole.
(b) Determine the maximum value of the feedback factor f for which this compensated
ampliﬁer is marginally stable.
(c) Determine the maximum value of the feedback factor f for which this compensated
ampliﬁer has a gain margin greater than 10 dB and phase margin of at least 50ı?
11.30. Lag-lead compensation is used with an ampliﬁer with a DC gain of  1200 and poles at
1 MHz, 10 MHz, and 220 MHz. e zero of the compensation network is selected to
cancel the 1 MHz pole of the uncompensated ampliﬁer.
(a) Find the pole of the lag-lead compensation network so that the ampliﬁer is stable
with a phase margin of 50ı when the feedback factor is f D  0:01.
(b) Determine the bandwidth of the compensated feedback ampliﬁer.

11.7. PROBLEMS
915
11.31. An inverting OpAmp inverting ampliﬁer is to be stabilized using lead compensation, as
shown. e OpAmp input and output resistances are Ri D 1 M and Ro D 75 . e
open-loop gain of the OpAmp is
A .j!/ D
24000

1 C
j!
2  105
2 
1 C j!
105
:
(a) Complete the design for a phase margin of 50ı.
(b) Conﬁrm the result with SPICE.
◦
◦
–15 V
+15 V
8.2 kΩ
Cc
Ra
Rp
51 kΩ
RF
10 kΩ
RS
Rb
−
+
vi
vo
•
•
•
•
11.32. An inverting OpAmp inverting ampliﬁer is to be stabilized using dominant pole com-
pensation, as shown. e OpAmp input and output resistances are:
Ri D 1 M
and
Ro D 75 :
e open-loop gain of the OpAmp is:
A .j!/ D
24000

1 C
j!
2  105
2 
1 C j!
105
:
(a) Complete the design for a phase margin of 50ı.
(b) Conﬁrm the result with SPICE.

916
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
◦
◦
–15 V
+15 V
8.2 kΩ
Cc
Rp
51 kΩ
RF
10 kΩ
RS
−
+
vi
vo
•
•
11.33. e lag-lead compensated ampliﬁer shown uses an OpAmp with input and output resis-
tances of Ri D 1 M and Ro D 75 , respectively. e open-loop gain of the OpAmp
is
A .j!/ D
1000

1 C
j!
2  106
 
1 C
j!
2  106
:
(a) Complete the design for a phase margin of 50ı.
(b) Conﬁrm the result with SPICE.
◦
◦
–15 V
+15 V
1 kΩ
Cc
Rp
10 kΩ
RF
2k Ω
RS
−
+
Rb
vi
vo
•
•
11.34. For the shunt-series feedback ampliﬁer shown below, the transistor characteristics are:
NPN: ˇF D 200; VA D 120 V, CJC = 7.31 pF, CJE = 22.01 pF, and TF = 411 ps
PNP: ˇF D 200; VA D 100 V, CJC = 14.76 pF, CJE = 19.82 pF, and TF = 603.7 ps.

11.7. PROBLEMS
917
(a) Determine the value of the feedback resistor, Rf , for unstable ampliﬁer operation.
(b) Using the value of Rf found in a), design a stable dominant pole compensated
ampliﬁer.
(c) Conﬁrm the results using SPICE.
vs
vo
◦
◦
◦
◦
◦
•
•
•
•
•
•
•
•
•
•
+15 V
4.12 kΩ
5.1 kΩ
5.1 kΩ33 μF
47 μF
68 μF
Q1
RS
Rf
RB1
RE1
5.1 kΩ
RC1
VCC
1 kΩ
RC2
CE1
CS
Q2
Co
820 Ω
RE2
+
–
+
–
11.35. Design a lead compensated ampliﬁer using the result found in part a) of Problem 11.34.
Conﬁrm the results using SPICE.
11.36. Design a lag-lead compensated ampliﬁer using the result found in part a) of Problem
11.34. Conﬁrm the results using SPICE.
11.37. For the diﬀerential ampliﬁer shown, assume identical transistors with
ˇF D 120;
VA D 175 V;
CJE D 19 pF;
CJE D 36 pF;
and
TF D 3:3 ns:
(a) Determine the value of the feedback resistor, Rf 1, for unstable ampliﬁer operation.
(b) Using the value of Rf 1 found in a), design a stable dominant pole compensated
ampliﬁer.
(c) Conﬁrm the results using SPICE.

918
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
◦
◦
◦
◦
•
•
•
•
•
•
•
+12 V
−12 V
47μF
Q1
Q2
Rf1
1.8 kΩ
1.8 kΩ
1 kΩ
1.8 kΩ
100 kΩ
10 kΩ
100 kΩ
•
5 mA
1 mA
Vo
vi1
11.38. Design a lead compensated ampliﬁer using the result found in part a) of Problem 11.37.
Conﬁrm the results using SPICE.
11.39. e ampliﬁer shown uses identical NMOSFETs with the following characteristics:
K D 1:25 mA=V2;
VT D 2 V;
VA D 150 V;
Ciss D 12 pF;
Crss D 2 pF:
(a) Determine the value of the feedback resistor, Rf , for unstable ampliﬁer operation.
(b) Using the value of Rf found in a), design a stable dominant pole compensated
ampliﬁer.
(c) Conﬁrm the results using SPICE.

11.7. PROBLEMS
919
◦
◦
◦
•
•
•
•
•
•
•
•
+15 V
68 μF
47 μF
33 μF
Q1
Q2
Rf
12 kΩ
10 kΩ
105 Ω
105 Ω 
510 kΩ
5.1 kΩ
10 kΩ
10 kΩ
•
•
•
•
vs
3V
+
–
◦
◦
vo
+
–
•◦
11.40. Design a lead compensated ampliﬁer using the result found in part a) of Problem 11.39.
Conﬁrm the results using SPICE.
11.41. Design an analog ampliﬁer to meet the following speciﬁcations:
• Input - a diﬀerential ampliﬁer
• Input voltage - at least ˙1 mV
• Midband voltage gain - 1000 ˙ 10
• Midband input resistance - at least 1 M
• Midband output resistance - less than 100 
• Low 3 dB frequency - 100 Hz, maximum
• High 3 dB frequency - 1 MHz, minimum
Design limitations are:
• Coupling capacitors are to be limited to 1 F, maximum
• Bypass capacitors are to be limited to 1000 F, maximum
• At least one BJT and one JFET must be used .
Active devices are limited to the following types:
• 2N2222A
NPN bipolar transistor

920
11. FEEDBACK AMPLIFIER FREQUENCY RESPONSE
• 2N2907A
PNP bipolar transistor
• 2N3904
NPN bipolar transistor
• 2N3906
PNP bipolar transistor
• 2N3819
N-channel Junction ﬁeld eﬀect transistor
• 2N4393
N-channel Junction ﬁeld eﬀect transistor
A report on the design is required. Minimum requirements for the report include:
• A complete theoretical analysis of the design
• SPICE veriﬁcation of design speciﬁcations
• Comparisons, conclusions, and comments
11.42. Design an analog feedback ampliﬁer to meet the following speciﬁcations:
• Midband voltage gain - 100 ˙ 5 (driving a 1 k load)
• Midband input resistance - at least 40 k
• Midband output resistance - less than 50 
• Low 3 dB frequency - 30 Hz, maximum
• High 3 dB frequency - 10 MHz, minimum
• Output voltage swing - ˙4 V (from Q point), minimum
Design limitations are:
• Coupling capacitors are to be limited to 1 F, maximum
• Bypass capacitors are to be limited to 1000 F, maximum
Active devices are limited to the following types:
• 2N2222A
NPN bipolar transistor
• 2N2907A
PNP bipolar transistor
• 2N3904
NPN bipolar transistor
• 2N3906
PNP bipolar transistor
• 2N3819
N-channel JFET
• 2N4393
N-channel JFET
A report on the design is required. Minimum requirements for the report include
• A complete theoretical analysis of the design
• SPICE veriﬁcation of design speciﬁcations
• Comparisons, conclusions, and comments.

11.7. REFERENCES
921
REFERENCES
[1] D’Azzo, J. J. and Houpis, C. H., Linear Control System Analysis and Design: Conventional
and Modern, 3rd ed., McGraw-Hill Book Company, New York, 1988.
[2] Fitchen, F. C., Transistor Circuit Analysis and Design, Van Nostrand Company, Princeton,
1966.
[3] Ghausi, M. S., Electronic Devices and Circuits: Discrete and Integrated, Holt, Rinehart and
Winston, New York, 1985.
[4] Gray, P. R. and Meyer, R. G., Analysis and Design of Analog Integrated Circuits, 3rd ed.,
John Wiley & Sons, Inc., New York, 1993.
[5] Millman, J., Microelectronics: Digital and Analog Circuits and Systems, McGraw-Hill Book
Company, New York, 1979.
[6] Millman, J. and Halkias, C. C., Integrated Electronics: Analog and Digital Circuits and Sys-
tems, McGraw-Hill Book Company, New York, 1972.
[7] Nise, N. S., Control Systems Engineering, Benjamin/Cummings Publishing Company,
Redwood City, 1992.
[8] Rosenstark, S., Feedback Ampliﬁer Principles, Macmillan Publishing Company, New York,
1986.
[9] Sedra, A. S. and Smith, K. C., Microelectronic Circuits, 3rd ed., Holt, Rinehart, and Win-
ston, Philadelphia, 1991.
[10] Schilling, D. L. and Belove, C., Electronic Circuits, 3rd ed., McGraw-Hill Book Company,
New York, 1989.


923
Authors’ Biographies
omas F. Schubert, Jr., and Ernest M. Kim are colleagues in the Electrical Engineering
Department of the Shiley-Marcos School of Engineering at the University of San Diego.
THOMAS F. SCHUBERT, JR.
omas Schubert received BS, MS, and PhD degrees in Elec-
trical Engineering from the University of California at Irvine
(UCI). He was a member of the ﬁrst engineering graduating
class and the ﬁrst triple-degree recipient in engineering at UCI.
His doctoral work discussed the propagation of polarized light
in anisotropic media.
Dr. Schubert arrived at the University of San Diego in
August, 1987 as one of the two founding faculty of its new En-
gineering Program. From 1997–2003, he led the Department as
Chairman, a position that became Director of Engineering Pro-
grams during his leadership tenure. Prior to coming to USD, he
was at the Space and Communications Division of Hughes Air-
craft Company, the University of Portland, and Portland State
University. He is a Registered Professional Engineer in the State of Oregon.
In 2012, Dr. Schubert was awarded the Robert G. Quinn Award by the American So-
ciety of Engineering Education “in recognition of outstanding contributions in providing and
promoting excellence in engineering experimentation and laboratory instruction.”

924
AUTHORS’ BIOGRAPHIES
ERNEST M. KIM
Ernest Kim received his B.S.E.E. from the University of
Hawaii at Manoa in Honolulu, Hawaii in 1977, an M.S.E.E.
in 1980 and Ph.D. in Electrical Engineering in 1987 from New
Mexico State University in Las Cruces, New Mexico. His dis-
sertation was on precision near-ﬁeld exit radiation measure-
ments from optical ﬁbers.
Dr. Kim worked as an Electrical Engineer for the Uni-
versity of Hawaii at the Naval Ocean Systems Center, Hawaii
Labs at Kaneohe Marine Corps Air Station after graduating
with his B.S.E.E. Upon completing his M.S.E.E., he was an
electrical engineer with the National Bureau of Standards in
Boulder, Colorado designing hardware for precision ﬁber optic
measurements. He then entered the commercial sector as a staﬀ
engineer with Burroughs Corporation in San Diego, California developing ﬁber optic LAN sys-
tems. He left Burroughs for Tacan/IPITEK Corporation as Manager of Electro-Optic Systems
developing ﬁber optic CATV hardware and systems. In 1990 he joined the faculty of the Univer-
sity of San Diego. He remains an active consultant in radio frequency and analog circuit design,
and teaches review courses for the engineering Fundamentals Examination.
Dr. Kim is a member of the IEEE, ASEE, and CSPE. He is a Licensed Professional
Electrical Engineer in California.

