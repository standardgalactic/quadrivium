Table of Contents 
 
-------------------------- 
Chapter 1: Introduction 
-------------------------- 
• 1.1 Preliminary Remarks 
• 1.2 Symbolic Computation 
• 1.2.1 Global Rules 
• 1.2.2 Local Rules 
• 1.2.3 Pattern Matching 
• 1.2.4 Using Patterns in Rules 
• 1.2.5 Restricting Pattern Matching with Predicates 
• 1.2.6 Pure Functions 
• 1.2.7 Map and Apply 
• 1.2.8 Nest and Fold 
 
------------------------------------- 
Chapter 2: The Duffing Equation 
------------------------------------- 
• 2.1 The Duffing Equation 
• 2.2 Straightforward Expansion 
• 2.3 The Lindstedt-Poincaré Technique 
• 2.4 The Method of Multiple Scales 
• 2.4.1 Second-Order Real-Valued System 
• 2.4.2 First-Order Real-Valued System 
• 2.4.3 First-Order Complex-Valued System 
• 2.5 Variation of Parameters 
• 2.6 The Method of Averaging 
 
------------------------------------------------------------------- 
Chapter 3: Systems with Quadratic and Cubic Nonlinearities 
------------------------------------------------------------------- 
• 3.1 Nondimensional Equation of Motion 
• 3.2 Straightforward Expansion 
• 3.3 The Lindstedt-Poincaré Technique 
• 3.4 The Method of Multiple Scales 
• 3.4.1 Second-Order Real-Valued System 
• 3.4.2 First-Order Real-Valued System 
• 3.4.3 First-Order Complex-Valued System 
• 3.5 The Method of Averaging 
• 3.6 The Generalized Method of Averaging 
• 3.7 The Krylov-Bogoliubov-Mitropolsky Technique 

• 3.8 The Method of Normal Forms 
 
------------------------------------------------------------- 
Chapter 4: Forced Oscillations of the Duffing Equation 
------------------------------------------------------------- 
• 4.1 Straightforward Expansion 
• 4.2 The Method of Multiple Scales 
• 4.2.1 Preliminaries 
• 4.2.2 Primary Resonance 
• 4.2.3 Secondary Resonances Due to Cubic Nonlinearities 
• 4.2.4 Secondary Resonances Due to Quadratic Nonlinearities 
• 4.2.5 First-Order Real-Valued System 
• 4.2.6 First-Order Complex-Valued System 
• 4.2.7 The Function MMS1 
• 4.3 The Generalized Method of Averaging 
• 4.4 The Method of Normal Forms 
 
----------------------------------------------------------------------------------------- 
Chapter 5: Higher-Order Approximations for Systems with Internal Resonances 
----------------------------------------------------------------------------------------- 
• 5.1 Euler-Lagrange Equations 
• 5.2 Method of Multiple Scales 
• 5.2.1 Second-Order Real-Valued System 
• 5.2.2 First-Order Real-Valued System 
• 5.2.3 First-Order Complex-Valued System 
• 5.3 Method of Normal Forms 
• 5.4 Generalized Method of Averaging 
 
---------------------------------------------------------------------------------- 
Chapter 6: Forced Oscillators of Systems with Finite Degrees of Freedom 
---------------------------------------------------------------------------------- 
• 6.1 Externally Excited Linearly Uncoupled Systems 
• 6.2 Parametrically Excited Linearly Coupled Systems 
 
---------------------------------------------------------------- 
Chapter 7: Continuous Systems with Cubic Nonlinearities 
---------------------------------------------------------------- 
• 7.1 Solvability Conditions and the Concept of Adjoint 
• 7.2 Hinged-Clamped Beam 
• 7.2.1 EOM and BC's 
• 7.2.2 Direct Attack of the Continuous Problem 
• 7.2.3 Discretization of the Continuous Problem 
• 7.2.4 Method of Time-Averaged Lagrangian 

• 7.3 Cantilever Beam 
• 7.3.1 EOM and BC's 
• 7.3.2 Direct Attack of the Continuous Problem 
• 7.3.3 Discretization of the Continuous Problem 
• 7.3.4 Method of Time-Averaged Lagrangian 
 
-------------------------------------------------------------------------------- 
Chapter 8: Continuous Systems with Quadratic and Cubic Nonlinearities 
-------------------------------------------------------------------------------- 
• 8.1 Buckled Beams 
• 8.1.1 Postbuckling Deflection 
• 8.1.2 Perturbation Analysis 
• 8.1.3 The Function MMSDirect11 
• 8.1.4 Three-to-One Internal Resonances Between the First Two Modes 
• 8.1.5 One-to-One and Three-to-One Internal Resonances Between the First and 
Third Modes 
• 8.1.6 One-to-One and Three-to-One Internal Resonances Between the First and 
Fourth Modes 
• 8.2 Circular Cylindrical Shells 
• 8.2.1 First-Order Solution 
• 8.2.2 Second-Order Solution 
• 8.2.3 Solvability Conditions 
• 8.3 Near-Square Plates 
• 8.3.1 First-Order Solution 
• 8.3.2 Second-Order Solution 
• 8.3.3 Solvability Conditions 
• 8.3.4 Mixed Approach 
 
--------------------------------------------------------------------------------------- 
Chapter 9: Higher Approximations of Continuous Systems Having Two-to-One 
Internal Resonances 
--------------------------------------------------------------------------------------- 
• 9.1 Two-Mode Interactions in Buckled Beams 
• 9.1.1 First-Order Solution 
• 9.1.2 Second-Order Solution 
• 9.1.3 Solvability Conditions 
• 9.2 Four-Mode Interactions in Suspended Cables 
• 9.2.1 First-Order Solution 
• 9.2.2 Second-Order Solution 
• 9.2.3 Solvability Conditions 
 

Chapter 1
Introduction
For convenience we turn off the spell checker by typing
Off@General::spell1D
à 1.1 Preliminary Remarks
à 1.2 Symbolic Computation
The Mathematica programming language allows not only for interactive manipulations of a wide range of objects, but it also
encourages the automation of complicated computations. Mathematica actually works by using systems  of rewrite rules, and
the user can freely create  and use his  or her own systems  of rules. This  distinguishes  it from traditional programming lan-
guages,  which  normally  have  no  such  features. We  have  applied  rule-based  and  functional programming  techniques  in
Mathematica  throughout  this  book.  Hence,  we  briefly cover the  basic  ingredients  of rule-based  programming in Sections
1.2.1--1.2.5 and some functional programming features in Sections 1.2.6--1.2.8.
For further information on Mathematica, consult  the standard  Mathematica reference: The Mathematica Book, Stephen
Wolfram, Third Edition, Wolfram Media  and Cambridge University Press, 1996. Full descriptions of the functions in the
standard Mathematica packages are available in Mathematica 3.0 Standard  Add-On Packages manual, Wolfram Media
and Cambridge University Press, 1996. Alternatively, simply click on the Help menu to view the Help Browser.
In the Text  cells  of this  book, we  use bold-magenta to indicate user-defined functions or names and bold-black to indicate
Mathematica's built-in functions.
 1.2.1 Global Rules
Global rules are applied whenever the appropriate left-hand side is  encountered or matched. The advantage of using global
rules is  that one does not need to apply explicitly a rule to get things done. However, it is almost impossible to prevent such
global rules from being applied to a certain expression. There are two types  of user-defined global rewrite rules: those using
= and those using :=. The distinction between them lies in when the right-hand side is  evaluated. Moreover, each of these
rules has two forms, depending on where the rule is stored, resulting in four rules indicated by = , ^= , := , and ^:=.

 1.2.1.1   = rules
We  can  think of =, an  assignment  statement  in analogy  with  traditional procedural programming languages, as  a  (global)
rewrite rule. The  characteristic  property  of using  the  rule = is  that  the right-hand  side  is  evaluated immediately  when  the
assignment is  made, and all subsequent matched left-hand sides  are replaced by the evaluated right-hand side. For example,
let us consider the rule
a = 2;
The output is suppressed by ending the input with a semicolon. From now on, whenever a is  encountered in any expression,
Mathematica will replace it by its value 2.
expr1 = a2 + 3 - a + Tan@aD
5 + Tan@2D
Let us try to evaluate expr1 for another value,
a = 3;
expr1
5 + Tan@2D
The new value of a is not recognized in expr1.
Let us try to clear the definition of a by using Clear or
a =.
Then, let us evaluate expr1,
expr1
5 + Tan@2D
Again, expr1 is not changed accordingly.
To be able to evaluate expr1 for different values of a, we need to either define expr1 before the assignment of a or use ":=",
instead of "=". The precise meaning of := is taken up in the next section. Here, we illustrate the former choice.
Clear@aD; expr1 = a2 + 3 - a + Tan@aD
3 - a +a2 + Tan@aD
a = 2; expr1
5 + Tan@2D
2
Chapter1.nb

a = 3; expr1
9 + Tan@3D
In traditional programming languages, the left-hand side of an assignment statement is required to be a simple identifier (i.e.,
a symbol). In computer algebra, the left-hand side can be arbitrarily complicated. For example,
look@here + 9D = Expand@H1 + xL^ 2 + yD
1 + 2 x+ x2 + y
Note that the output of an = expression is the evaluated form of the right-hand side. Mathematica regards the left-hand side
as  a pattern. Whenever Mathematica finds something that matches  this pattern, it replaces  the something by the evaluated
right-hand side.
look@there + look@here + 5 + 2 ^2DD
look@1 + there + 2 x + x2 + yD
In this evaluation, the pattern  look @here + 5 + 22D simplifies to look @here + 9D , which is  replaced by 1 + 2 x + x2 + y. The
resulting expression does  not match any pattern involving look and so it is  left in unevaluated form. This  rule is  stored with
look.
?look
Global`look
look@9 + hereD = 1 + 2 * x + x ^2 + y
Again, we see the evaluated form on the right-hand side.
There  are  some  problems  associated  with  left-hand  sides  that are  not  symbols. For example, suppose we  try to  make  the
following rule:
x + y = z
Set::write :  Tag Plus in x + y is Protected.
z
We get an error message stating that Plus is protected, which means new rules cannot be added for Plus. Every time Mathe-
matica encounters Plus, it searches through the rules for Plus to see if anything applies. If we add a new rule for Plus, then
that rule would have to be examined at every  subsequent addition. When a rule of the form x + y = z is given, Mathematica
interprets it as  a rule of the form Plus@x, yD = z. Rules have to be stored somewhere and the default  rule is that for the head of
the left-hand side. One way of adding  a new rule for Plus is to unprotect Plus, make the rule, and then reprotect it.
Unprotect@PlusD;
x + y = z;
Protect@PlusD;
Now whenever Mathematica sees x + y, it rewrites it as z.
Chapter1.nb
3

x + s +y + t
s + t +z
Alternatively, we  can use UpValues  to associate the  rule with the  unprotected argument of the left-hand side. (Definitions
that attach a value to the head of the left-hand side are called DownValues of the head.) For example,
s + t ^= u
u
Note the caret ^ before the = sign. This rule is associated with the symbol s or t.
?s
Global`s
s : s + t = u
t + s +t
t + u
A given symbol can have both up and down values. Let's give s a down value in addition to the up value it already has.
s@x_D := Exp@I a xD;
Then looking at s shows both kinds of values:
?s
Global`s
s : s + t = u
s@x_D := Exp@I * a * xD
Finally, we can access the up and down values individually.
8UpValues@sD, DownValues@sD<
88HoldPattern@s + tD ƒ u<, 8HoldPattern@s@x_DD ƒ Exp@I a xD<<
Now let us try naively define the sine function using an = rule according to
m@xD = Sin@xD;
It works properly for the symbol x but not for anything else.
8m@xD, m@yD, m@1D<
8Sin@xD, m@yD, m@1D<
4
Chapter1.nb

This  is where the special symbol _ comes  in. The form x_ means a pattern named x. We can show the internal representation
of any expression, such as x_ , by either using
FullForm@x_D
Pattern@x, Blank@DD
or using
x_  FullForm
Pattern@x, Blank@DD
An underscore _ in a pattern matches anything, so it is  a dummy  variable or a "wild card". If it appears  on the left-hand side
of "="  rule  with  a name, like  x, then  the  left-hand  side  is  rewritten  as  the  right-hand  side  with  x  replaced  by  the  desired
variable. Let us use this to redefine m; that is,
m@x_D = Sin@xD;
Now m works for any argument:
8m@xD, m@yD, m@1D, m@s - tD<
8Sin@xD, Sin@yD, Sin@1D, Sin@s - tD<
Thus, one can use = rules to define functions.
 1.2.1.2   := rules
Rules using :=  do not evaluate the right-hand side immediately but instead leave it unevaluated until the function is actually
used. They can be used with simple left-hand sides or with left-hand sides  containing patterns. As an example, let us define
and compare two rules using = or :=.
Clear@xD;
lhs1 = Expand@Hx + 1L ^2D;
lhs2 := Expand@Hx + 1L ^2D;
If these are evaluated, they give the same result.
8lhs1, lhs2<
81 + 2 x+ x2, 1 + 2 x + x2<
If we now give a value to x, then lhs1 and lhs2 will use this value in different ways.
x = p + q;
8lhs1, lhs2<
81 + 2 Hp + qL + Hp + qL2, 1 + 2 p + p2 + 2 q + 2 p q + q2<
Chapter1.nb
5

If the left-hand side of a := rule contains a pattern, then on a subsequent occurrence of the left-hand side with actual argu-
ments, the formal (dummy) arguments  (or names  of patterns) on the right-hand side are replaced by the actual arguments and
then the right-hand side is  evaluated. Thus, each time the left-hand side of such a rule matches  something, it is replaced by a
new evaluation of the right-hand side. To see the difference, we again set up the two rules
f@k_D = Expand@k^ 2D
k2
g@k_D := Expand@k^ 2D
We note that the right-hand side of the rule for f is  evaluated immediately when it is  defined, whereas the right-hand side of g
is kept unevaluated. Now, try out these two definitions on the same value.
8f@p + qD, g@p + qD<
8Hp + qL2, p2 + 2 p q + q2<
Because the right-hand side of the rule for f was evaluated immediately when it was defined, there is nothing to expand, and k
is replaced with p+q without expanding the result. On the other hand, the right-hand side of the rule for g was not expanded
when defined and it retains the whole expression Expand[k ^2]. When the two functions are subsequently  used, f@p + qD is
just replaced by Hp + qL2, while g@p +qD is  replaced by Expand@Hp + qL^2D , which evaluates  to p2 + 2 p q + q2. The internal
representation of such a definition has the following form:
FullForm@g@k_D := pD
Null
To  see  the  actual  head  of  an  expression  before  it  is  evaluated, we  wrap  the  expression  with  Hold and  then  request  its
FullForm
FullForm@Hold@g@k_D := pDD
Hold@SetDelayed@g@Pattern@k, Blank@DDD, pDD
Thus, the  symbol := is  the  infix form of SetDelayed. This  makes  dramatically  clear the distinction  between  the evaluation
when the rule is given and the evaluation when the rule is used.
When the head of the left-hand side is protected, we can use UpValues to associate the rule with the unprotected argument
of the  left-hand  side.  For example, when  we  try to  differentiate  a  user-defined  definite  integral with  constant bounds, we
obtain
Clear@int, f, xD
D@int@f@xD, 8x, 0, 1<D, xD
intH0,81,0,0<L@f@xD, 8x, 0, 1<D + f¢@xD intH1,80,0,0<L@f@xD, 8x, 0, 1<D
which is not what we intended. We can either unprotect D and add a rule or use ^:= to assign the definition with int; that is,
6
Chapter1.nb

D@int@x_, a_D, y_D ^:= int@D@x, yD, aD
Now we check to see if Mathematica gives us the answer we want.
D@int@f@xD, 8x, 0, 1<D, xD
int@f¢@xD, 8x, 0, 1<D
As a second example, we define Cos@n pD = H-1Ln and Sin@n pD = 0 for integer n:
Unprotect@Cos, SinD;
Cos@n_ pD := H-1Ln ; IntegerQ@nD
Sin@n_ pD := 0 ; IntegerQ@nD
Protect@Cos, SinD;
If we declare m to be an integer (here UpValues is used),
IntegerQ@mD ^= True;
then
8Cos@m pD, Sin@m pD<
8H-1Lm, 0<
 1.2.2 Local Rules
Local rewrite rules (lhs->rhs  or  lhs:>rhs) are  useful for making substitutions  without making the  definitions permanent.
These  rules  are  applied  to  an  expression  using  the  operation  .  (means  ReplaceAll)  or  .  (means  ReplaceRepeated  in
Mathematica).
 1.2.2.1   -> rules
We can use Solve to obtain the solutions of some algebraic equations. For example,
eq1 = u2 - 3 u + 2 == 0;
sol1 = Solve@eq1, uD
88u ﬁ1<, 8u ﬁ2<<
We can check the result by substituting sol1 into eq1 and obtain
eq1 . sol1
8True, True<
The output of Solve is a list of lists of local rules. Thus, u -> 1 is  a local rule, which is  the analog of the global rule u = 1. The
rule is  applied to an  expression by using /. , so the expression eq1/.sol1 means "use the rewrite rules u -> 1 and u -> 2 in
Chapter1.nb
7

eq1". The result of this  is 80 == 0, 0 == 0<, which is then evaluated as {True, True}. The usual form of the right-hand side of
/. is a list of local rules for some of the symbols  that appear on the left-hand side.
u v w . 8u -> 3, w -> 5<
15 v
If the right-hand side is  a list of lists  of local rules, then the result is  a list of modified expressions, one for each substitution
in the list.
u v w . 88u -> 3, w -> 5<, 8v -> 2, w -> 3<<
815 v, 6 u<
Local replacement rules  also  work on  expressions  which have  a  Hold wrapped  around them.  For example, without  a  Hold,
¶xCos@xD immediately evaluates to -Sin@xD.
¶xCos@xD
-Sin@xD
However, the rewrite rule goes under the Hold to make the replacement.
Hold@¶xCos@xDD . Cos -> Sin
Hold@¶xSin@xDD
Local rules with "->" share with "=" rules the property that their right-hand sides are evaluated at the time they are defined.
 1.2.2.2   :> rules
The  local analog  of a ":="  rule  is  a  ":>"  rule; i.e., a  local rule  that  evaluates  its  right-hand  side only  when it  is  used. For
example,
expr1 = Exp@I Hw2 - w1L T0D;
Clear@aD
expr1 . Exp@a_D -> Exp@Expand@aDD
EI T0 H-w1+w2L
8expr1 . Exp@a_D :> Exp@Expand@aDD, expr1  ExpandAll<
8E-I T0 w1+I T0 w2, E-IT0 w1+I T0 w2<
8
Chapter1.nb

where the immediate rule (lhs->rhs) fails  to do the expansion. The left-hand sides  of the local rules involve patterns rather
than just symbols. The difference is that the immediate rule for Exp@a_D replaces it by the evaluation of Exp@Expand@aDD which
equals  Exp@aD. Hence, when this  is used with a equal to IHw2 - w1L T0, we get the result  EI T0 H-w1 +w2L. On the other hand, the
delayed  rule  (lhs:>rhs)  for  Exp@a_D  replaces  it  by  the  unevaluated  Exp@Expand@aDD  which,  when  used  with  a  equal  to
IHw2 - w1L T0, gives E-I T0 w1+I T0 w2. Alternatively, for this simple example, we can use ExpandAll to obtain the same result.
We can check how these expressions are represented internally.
FullForm@Hold@p . q -> rDD
Hold@ReplaceAll@p, Rule@q, rDDD
FullForm@Hold@p . q :> rDD
Hold@ReplaceAll@p, RuleDelayed@q, rDDD
Thus, /. is  the infix form of ReplaceAll, the arrow -> is  the infix form of Rule, and the arrow :> is  the infix form of RuleDe-
layed, corresponding to Set and SetDelayed for = and :=.
 1.2.2.3   . and .
There is another form of . given by . which applies a local rule repeatedly until the expression no longer changes. Internally,
. is represented by
p . q -> r  FullForm  HoldForm
ReplaceRepeated@p, Rule@q, rDD
An example of the difference between . and . follows. This example uses  a list of rules rather than just a single rule. When a
list of rules is  applied to a single  expression, then the rule for each symbol is tried from the left until a match is  found. In the
following example, the right-hand side of the . expression consists  of a list of two rules for the same symbol, fac. This list is
searched from the left until a pattern  is found that matches the left-hand side of the . expression. In the first case using ., as
soon as  a match is  found, the evaluation is  finished. In the second case using ., the rules are tried repeatedly  from the left
on the output of the previous evaluation until no matches are found.
fac@5D . 8fac@1D -> 1, fac@i_D -> i fac@i - 1D<
5 fac@4D
fac@5D . 8fac@1D -> 1, fac@i_D -> i fac@i - 1D<
120
In the first case, the left-hand side of the rule fac@1D -> 1 does  not match anything in fac@5D, but fac@i_D -> i fac@i - 1D does
with i_ equal to 5, so the output is 5fac@4D. In the second case, the left-hand side of the rule fac@i_D -> i fac@i - 1D continues to
match a  part of the  existing expression until  120fac@1D is  obtained. Then the left-hand  side of the  rule fac@1D -> 1 matches,
leading to 120*1, which simplifies to 120 where neither rule matches, so the output is 120.
Chapter1.nb
9

If such rules are given globally, then the order in which they are given does not matter since Mathematica will put the more
specific rule, fac@1D = 1, first. However, in a list of local rules, applied with ., we are completely responsible  for the ordering.
Thus, the following gives the wrong answer:
fac@5D . 8fac@i_D -> i fac@i - 1D, fac@1D -> 1<
0
If several local rules are given for different symbols, then these rules are applied simultaneously. For example,
8u, v, w< . 8u -> v, v -> w, w -> s<
8v, w, s<
If the substitutions are carried out sequentially, then the results are quite different.
8u, v, w< . 8u -> v< . 8v -> w< . 8w -> s<
8s, s, s<
In particular, this means that variables can be interchanged without introducing an intermediate temporary variable.
8u, v< . 8u -> v, v -> u<
8v, u<
 1.2.3 Pattern Matching
Mathematica is  a language based on pattern matching. Patterns refer to the structure  of expressions. The symbol _ by itself,
without any symbol on the left, can be used to describe a pattern. (Recall that the FullForm of _ is  Blank@D). For instance,
the expression _^_ matches anything of the form x^ y, where x and y are any (dummy) expressions.
Clear@a, xD
g1@_, _ ^ _D := u;
8g1@a, a ^aD, g1@a, b^ cD<
8u, u<
A pattern of the form x_ is matched by any expression, which is then used for evaluating the right-hand side.
g2@x_^y_, z_D := u@x, y, v@zDD;
8g2@a^a, aD, g2@a^ b, cD<
8u@a, a, v@aDD, u@a, b, v@cDD<
10
Chapter1.nb

g3@x_^y_, x_D := u@y, v@xDD;
8g3@a^a, aD, g3@a^ b, cD, g3@a^ b, aD<
8u@a, v@aDD, g3@ab, cD, u@b, v@aDD<
A pattern of the form x_h is matched by any expression whose head is h.
g4@x_^y_Integer, z_D := u@x, y, v@zDD;
8g4@a^a, aD, g4@a^ 3, arg2D<
8g4@aa, aD, u@a, 3, v@arg2DD<
If we give a rule for an expression involving two separate arguments with underscores, then we are constructing a function
of two variables. Such a function only works if it is given exactly two arguments.
g5@x_, y_D := x + y;
8g5@aD, g5@a, bD, g5@a, b, cD<
8g5@aD, a + b, g5@a, b, cD<
Besides  rule-schemes  using  a  single  underscore_, there  are  rule-schemes  using  double  and  triple  underscores. A  double
underscore,  __, is  matched  by  any  number of  arguments, excluding zero  arguments, separated by  commas, while  a triple
underscore, ___, is  matched by any number of arguments, including zero arguments. The form x__ means a sequence of one
or more  arguments, named  x, and  x__Head means  a  sequence  of one  or more arguments, named  x, with  the  head of each
argument  is  Head. Similarly, the  form x___  means  zero  or more  arguments, named  x,  and  x___Head  means  zero  or more
arguments, named x, with the head of each argument is Head.
g6@x__D := Length@8x<D;
8g6@D, g6@aD, g6@a, bD, g6@a, b, cD<
8g6@D, 1, 2, 3<
g7@x___D := Length@8x<D;
8g7@D, g7@aD, g7@a, bD, g7@a, b, cD<
80, 1, 2, 3<
Default  values  and  double  and  triple  underscores  are  important techniques, which  give  optional number of arguments  to
functions; that  is, a variable  number of arguments  can  be  given to  such  functions. Alternatively, there  is  another rule  in
which a specific argument can be optional.
g8@x_^y_, z_D := u@x, y, zD;
8g8@a^ b, cD, g8@a, cD<
8u@a, b, cD, g8@a, cD<
Chapter1.nb
11

Because a = a ^1, one might think that  g8@a, cD should  match  the pattern  g8@a^1, cD, which would  mean  that it  should  be
rewritten as  u@a, 1, cD, but of course Mathematica cannot guess that this is  what we intend. However, there is a provision to
take  care of such default  values. To  assign a  default  value  v to  a pattern, one can  write _ :v. So, the  effect we  wanted to
achieve is given by the form
g9@x_^Hy_: 1L, z_D := u@x, y, zD;
8g9@a^ b, cD, g9@a, cD<
8u@a, b, cD, u@a, 1, cD<
In  this  case,  the  default  value  1 for the exponent  is  the natural and  obvious choice,  and Mathematica  knows  this. It  has
standard  built-in default  values for a number of such positions. The notation _. tells  Mathematica to use the built-in default
value. Note the almost invisible period after the underscore. Thus, the effect we wanted at the beginning is  given by a tiny
modification of the original form.
g10@x_^ y_., z_D := u@x, y, zD;
8g10@a^ b, cD, g10@a, cD<
8u@a, b, cD, u@a, 1, cD<
There  is  still another way  that  optional arguments  occur in  Mathematica. Some  functions, such  as  Plot, can  take  named
optional arguments  such as  AspectRatio -> 1. By incorporating such functions into our own definitions, we can use these
named optional arguments too. Consider an example of a plotting function.
plotwithSin@func_, var_, opts___D := Plot@8Sin@varD, func@varD<,
8var, 0, 2 Pi<, opts, PlotStyle -> 8RGBColor@1, 0, 0D, RGBColor@0, 0, 1D<D;
plotwithSin@Cos@2 #D &, xD;
1
2
3
4
5
6
-1
-0.5
0.5
1
12
Chapter1.nb

plotwithSin@Cos@2 #D &, x, AspectRatio -> 1D;
1
2
3
4
5
6
-1
-0.5
0.5
1
In an expression of the form g[x_^n_Integer, z_], the patterns are named with the symbols  x, n, and z, but there is no name for
the whole  compound pattern  x_^n_Integer.  There is  a way to  give names  to  such compound patterns  so that they  can be
referred to  directly on  the right-hand  side. The  syntax consists  of a name  followed by a  colon followed  by the compound
pattern.
g11@expr : x_^y_Real, z_D := z expr;
8g11@Ha + b - 2L^ 0.5, 2D, g11@Ha + b - 2L^ 3, 2D<
82 H-2 + a + bL0.5, g11@H-2 + a + bL3, 2D<
 1.2.4 Using Patterns in Rules
Patterns play an important role in both global and local rules.
 1.2.4.1 Patterns in Global Rules
For example, it is very easy to give rewrite rules for differentiating polynomials of one variable.
diff@x_^ n_., x_D := n x^Hn - 1L;
diff@a_ + b_, x_D := diff@a, xD + diff@b, xD;
Notice the default value for n in the first rule. Try it out on some typical functions.
8diff@y, yD, diff@z ^2.1, zD, diff@u^ 2 + v ^3, uD<
81, 2.1 z1.1, 2 u + diff@v3, uD<
But notice  that diff does  not know what to do  with a constant  times x, or just a constant for that matter, and  we have no
obvious way as yet to teach it what to do.
Chapter1.nb
13

8diff@3, xD, diff@3 x, xD<
8diff@3, xD, diff@3 x, xD<
We could try the following: first, give a rule for products.
diff@a_ b_, xD := a diff@b, xD + b diff@a, xD
Using this for a x gives
diff@a x, xD
a + x diff@a, xD
The program does not know that a is supposed to be a constant, so we have to tell it that explicitly, with a last rule.
diff@a, xD = 0;
Then it gives the "correct" answer.
diff@a x, xD
a
However, this  is  not  very  satisfactory. We would like  some general way  to say that  a is  not  a function  of x. Section  1.2.5
below will continue this discussion.
 1.2.4.2 Patterns in Local Rules
We will encounter this  type  of application quite often in the following chapters. In the following example, we show how to
change the appearance of a matrix. Using Array to make a matrix with indexed entries, we then use a local rule to display the
indices as subscripts.
Array@x, 83, 5<D . x@i__D -> xi  MatrixForm
i
k
jjjjjj
x1,1
x1,2
x1,3
x1,4
x1,5
x2,1
x2,2
x2,3
x2,4
x2,5
x3,1
x3,2
x3,3
x3,4
x3,5
y
{
zzzzzz
where the two consecutive underscores next to i on the left-hand side of the rule represent one or more arguments.
We can also use pattern matching to replace the coefficients of various terms any way we want. For example,
Clear@fD
eq1 = u†@tD + u@tD f¢@x0D + 1
2
u@tD2 f†@x0D + 1
6
u@tD3 fH3L@x0D == 0;
eq2 = eq1 . _. u@tD^ b_. -> kb u@tD^ b
k1 u@tD+ k2 u@tD2 + k3 u@tD3 + u†@tD == 0
14
Chapter1.nb

Sometimes we  may obtain, in a  bifurcation analysis, a data set, which includes  a set of bifurcation  points  xi  and the corre-
sponding control parameters  cpSearch and cpFix, such as 88x1, x2, x3, x4, cpSearch<, cpFix<. If we want to switch these two
parameters  and then use the same data format as  our initial input to a program, we have at least two choices. First, we take
apart the data list and then assemble them:
data1 = 88x1, x2, x3, x4, cp1<, cp2<;
8Append@Drop@data1@@1DD, -1D, data1@@2DDD, data1@@1, -1DD<
88x1, x2, x3, x4, cp2<, cp1<
Second, we simply apply a local rule using patterns to the data list as a whole:
data1 . 88a__, b_<, c_< -> 88a, c<, b<
88x1, x2, x3, x4, cp2<, cp1<
 1.2.5 Restricting Pattern Matching with Predicates
So  far, all of the  rules  we have  considered  have  been  "context  free"  rewrite rules. Whenever the  pattern  is  matched, the
rewriting is  carried out. There can be a restriction on the head of the matching expression included in the pattern. However,
there  are  also conditional rewrite rules, which  are only  applied  when some condition  is  satisfied. First, we have to discuss
predicates  (functions  that  return  the  value  True  or False)  in  Mathematica  because all of  the  conditions  will always  be
expressed in terms  of them. All built-in predicates  that are defined for all expressions end with Q. It is  easy to display all of
them.
?*Q
ArgumentCountQ       LinkConnectedQ       OrderedQ
AtomQ                LinkReadyQ           PartitionsQ
DigitQ               ListQ                PolynomialQ
EllipticNomeQ        LowerCaseQ           PrimeQ
EvenQ                MachineNumberQ       SameQ
ExactNumberQ         MatchLocalNameQ      StringMatchQ
FreeQ                MatchQ               StringQ
HypergeometricPFQ    MatrixQ              SyntaxQ
InexactNumberQ       MemberQ              TrueQ
IntegerQ             NameQ                UnsameQ
IntervalMemberQ      NumberQ              UpperCaseQ
InverseEllipticNomeQ NumericQ             ValueQ
LegendreQ            OddQ                 VectorQ
LetterQ              OptionQ
Specifically requesting information on our function gives the usage message.
?OddQ
OddQ@exprD gives True if expr is an odd integer, and False otherwise.
Predicates are used to control pattern matching. In general, they are applied using ; , which is the infix form of Condition.
Chapter1.nb
15

FullForm@Hold@x ; yDD
Hold@Condition@x, yDD
However, the position of the predicate in an expression allows it to be used in different ways. If the predicate is placed at the
end of a global rule definition, it will restrict  the application  of the rule. For instance,  we can use predicates  to extend  our
definition  of differentiation  in  Section  1.2.4.1 to  deal with  arbitrary  polynomials  in  a very  natural way  by  adding  a  single
conditional rule.
Clear@diffD
diff@x_^ n_., x_D := n x^Hn - 1L;
diff@a_ + b_, x_D := diff@a, xD + diff@b, xD;
diff@a_ b_, x_D := a diff@b, xD + b diff@a, xD;
diff@a_, x_D := 0 ; FreeQ@a, xD
Now constants and products are handled properly
diff@a@xD + b x ^2 + c, xD
2 b x + diff@a@xD, xD
Using rule;Predicate restricts  the rule to those situations in which the predicate evaluates to True;  that is, to those expres-
sions belonging to the type given by the predicate. An unrestricted rule is  the same as  a conditional rule where the predicate
always equals  True.
If a  predicate is  immediately applied  after a pattern, it  will restrict the pattern  matching rather than the  rule application. For
instance,
fac1@1D = 1; fac1@n_D := n fac1@n - 1D
This will work perfectly well if positive integers are given as arguments.
fac1@5D
120
However, if another argument is given, then it will fail badly.
8fac1@-3D, fac1@endlessD<;
$RecursionLimit::reclim :  Recursion depth of 256 exceeded.
$RecursionLimit::reclim :  Recursion depth of 256 exceeded.
$RecursionLimit::reclim :  Recursion depth of 256 exceeded.
General::stop :  Further output of $RecursionLimit::reclim will be suppressed during this calculation.
16
Chapter1.nb

A very  large output is  suppressed. What happens, of course, in these cases  is that the value 1 is  never encountered as  an
argument, so the function keeps calling itself recursively until the built-in recursion limit is reached. This  bad behavior can be
corrected by using a conditional rule.
fac2@1D = 1; fac2@n_D := n fac2@n - 1D ; n > 1;
8fac2@5D, fac2@-2D, fac2@somethingD<
8120, fac2@-2D, fac2@somethingD<
One can also use the form _?Predicate, which restricts the pattern to something for which the predicate evaluates to True.
fac3@1D = 1; fac3@n_ ?PositiveD := n fac3@n - 1D;
fac4@1D = 1; fac4@n_ ; Positive@nDD := n fac4@n - 1D;
8fac3@5D, fac3@-2D, fac4@5D, fac4@-2D<
8120, fac3@-2D, 120, fac4@-2D<
In n_ ?Positive, Positive is a pure function, while in the form using ; , the condition is  the value of the predicate for the name
of the pattern. In either case, Positive  or Positive[n] is  a positive test in the sense that the pattern  is  matched and the rule
applied only if the test succeeds. Now try fac4 on a real number and see what happens.
fac4@3.6D
8.9856 fac4@-0.4D
The rule is applied until the negative value -0.4 is  reached, where the condition fails  so fac4[-0.4] is returned in unevaluated
form. Of course, the real problem is  that we only  intend the function to apply  to integers. But this  additional restriction can
easily be added.
fac5@1D = 1; fac5@n_Integer ?PositiveD := n fac5@n - 1D;
8fac5@5D, fac5@3.6D, fac5@-2D<
8120, fac5@3.6D, fac5@-2D<
The predicate that appears after ; or ? can also be a user defined expression.
test@x_Integer? HH# > 2L &LD := x + 1
8test@1D, test@2D, test@3D, test@4D, test@5D<
8test@1D, test@2D, 4, 5, 6<
The form ? Predicate can only  be used after single  slots, but the form ; Predicate can be used after any pattern, simple or
compound. For instance,
f1@a_, b_D ; EvenQ@a + bD := a ^ b;
f1@a_, b_D ; OddQ@a + bD := a ^H- bL;
Chapter1.nb
17

8f1@1, 3D, f1@2, 3D, f1@3, 3D<
91, 1
8
, 27=
Predicates also play an important role in manipulating lists.
Select@Range@-5, 5D, PositiveD
81, 2, 3, 4, 5<
Cases@Range@-5, 5D, _? PositiveD
81, 2, 3, 4, 5<
Cases@Range@-5, 5D, a_ ; a > 0D
81, 2, 3, 4, 5<
There is also another form of Cases in which an operation is applied to the entries that are selected.
Cases@Range@-5, 5D, Ha_ ; a > 0L :> Sqrt@aDD
91,  ! !!2 ,  !!!3 , 2,  !!!5 =
The  following example  was the  1992 Mathematica  programming competition  question. The problem is  to  write a function
called maxima that starts  with a list of numbers  and constructs the sublist of the numbers bigger than all previous ones from
the given  list. For instance, maxima[{3, 6, 4, 2, 8, 7, 9}] should  return  {3, 6, 8, 9}. The winning entry  used  a pattern  with a
condition in a local rule.
maxima@list_ListD := list . 8a___, x_, y_, b___< ; y <= x -> 8a, x, b<
maxima@83, 6, 4, 2, 8, 7, 9<D
83, 6, 8, 9<
 1.2.6 Pure Functions
Given an expression expr involving a variable x, we can think of expr as describing a function with x being the argument. If
we  need  to  refer to  this  function  by  name, we  can  either define  a  rule  for f  in  the  form f@x_D :=  expr or use the  object
Function[x, expr]. Either f or Function[x, expr] is a name for this  function, and we can use the two interchangeably. To apply
them to an argument, we write f[arg] in the familiar way or in the so-called pure function form Function[x, expr][arg].
f@x_D := 1 + x^2
g = Function@x, 1 + x^2D;
8f@2D, g@2D<
85, 5<
18
Chapter1.nb

The  name of the formal argument  in a  pure  function  does  not  matter. Function[x, x^2] is  the same  function as  Function[y,
y^2]. This fact is easy to see if you apply such a function to an argument, the result is the same in both cases.
8Function@x, x^ 2D@aD, Function@y, y^2D@aD, Sin@aD<
8a2, a2, Sin@aD<
Note that Sin and all built-in functions, with no arguments, are pure functions. Because the names  of the variables  in a pure
function  do not  matter, Mathematica  denotes  these variables  with symbols. The  symbols  #1, #2, ... are  used for the first,
second, ... variable. The internal form of #i is Slot[i]. If we use these forms, then we do not give the arguments of Function[ ]
in order to declare the names  of the variables. Thus, instead of Function[x, x^2] we simply write Function[#1^2]. A conve-
nient abbreviation for #1 is  #, so we  can simplify our example a bit more and write Function[#^2]. Finally, there  is  a postfix
operator & for Function. That is, body& is  the same as  Function[body]. Using this  operator, we arrive at the shortest form
#^2 & that our example can take. We have used this  form quite frequently  in this  book. Let us see the internal form of this
short form of a pure function.
FullForm@#^ 2 &D
Function@Power@Slot@1D, 2DD
The operator & has a very low priority, just above assignment. Therefore, x = body & is understood as  x =Function[body],
but x -> body & is  interpreted as Function[x -> body]. If we want the right-hand side of the rule to be the pure function, we
use x -> (body &). Beware of x -> (body) &. Another case where  the  low priority  of pure  functions  requires  the  use of
parentheses is in predicates for patterns: x_?body& is not the same as x_?(body&). The latter is usually correct.
1 + # +#^2 & @3D
13
The  whole  expression  to  the  left  of  &  is  part  of the  body  of  the  pure  function. No  parentheses  are  necessary. In  other
situations, parentheses are necessary.
h@aD . h -> H#^ 2 &L
a2
Parentheses  around the pure  function are needed here; otherwise, the whole rule would be considered a part of the body of
the function.
Pure  functions written  in the  form with  # and  & are  very  concise and  useful, especially, in functional operations, such  as
Map, Apply, Thread, and iteration functions, such as FoldList. For example,
eq1 = ¶t,tu@x, tD  a + u@x, tD == F@xD  a
u@x, tD + uH0,2L@x, tD

a
== F@xD

a
Clear@lhs2D
Chapter1.nb
19

eq2 = lhs2 == rhs2;
eq3 = lhs3 == rhs3;
We can multiply both sides of eq1 by a and use Thread and obtain
eq1  Thread@a #, EqualD &  ExpandAll
a u@x, tD + uH0,2L@x, tD == F@xD
Moreover, we can add eq2 to eq3 by
eq2 + eq3  Thread@#, EqualD &
lhs2 + lhs3 == rhs2 + rhs3
 1.2.7 Map and Apply
In Mathematica, two important commands that take functions as arguments are Map[ ] and Apply[ ]. The various versions of
Map act on the arguments of an expression, while Apply acts only on its head.
 1.2.7.1 Mapping Functions onto Expressions
The operation Map[f, list] or in infix form f  list applies the function  f  to each element of the list list. The second argument
of Map[ ] need not be a list, however. Any expression of the form h[e1, e2, ..., en ] will do. The result  of the mapping is  the
expression h@ f@e1D, f@e2D, ..., f@enDD.
Clear@fD
8Map@f, a + b + cD, # ^2 &  81, 2, 3<<
8f@aD + f@bD + f@cD, 81, 4, 9<<
Map[f, expr, levelspec] has an optional third argument that specifies  the levels at which to map. The default  level is {1};  that
is, at the elements  of expr. In a matrix, the entries  are at level 2 (there are two levels of lists). If we want to map a function at
these entries, we can use Map[f, matrix, {2}].
expr1 = 88a1,1, a1,2<, 8a2,1, a2,2<<;
Map@entry, expr1, 82<D  MatrixForm
i
k
jj entry@a1,1D
entry@a1,2D
entry@a2,1D
entry@a2,2D
y
{
zz
This  is  a  very  powerful facility and  is  one  of our main tools  in  manipulating  expressions. The  purpose of the  operations
based on Map is to make it possible to treat lists as  wholes. For instance, a really poor way to square the entries  in a list is  as
follows:
20
Chapter1.nb

list1 = 8a, b, c<;
Table@list1@@iDD^ 2, 8i, Length@list1D<D
8a2, b2, c2<
The  term list1[[i]]  tears  apart  the  original list by  extracting  its parts  one  at  a  time, ^2 squares  each  part, and  then  Table
reassembles  the parts  into a new list. Map, however, allows us to treat mathematical structures  as wholes  so that we do not
tear them apart and rebuild them again.
Map[ ] always maps the function at all elements  of the given levels. The command MapAt[f, expr, poslist] allows you to apply
a function at selective positions.
MapAt@G, a b + c d + e f, 82, 1<D
a b + e f + d G@cD
expr2 = a + b  a + c Exp@a + 1D
a + b
a
+ c E1+a
If we want to map a function f at all occurrences of a, we first find all the positions of a in our expression.
Position@expr2, aD
881<, 82, 1, 1<, 83, 2, 2, 2<<
This list of positions is in the right form for MapAt and can be used directly.
MapAt@f, expr2, %D
c E1+f@aD +
b

f@aD
+ f@aD
This particular example could have been done more easily with a replacement rule.
expr2 . a -> f@aD
c E1+f@aD +
b

f@aD
+ f@aD
In  some  applications, the  function  to  be  performed  on  an  element  ei  may depend  on  its  position  i. The  operation  Map-
Indexed[f, {e1, e2, ..., en}] behaves  essentially like Map[ ], but it passes the position of each element as a second argument to
f. The resulting expression is
MapIndexed@1 + # ^2 &, 8a, b, c, d<D
81 + a2, 1 + b2, 1 + c2, 1 + d2<
MapIndexed@1 + # ^2 &, 88a, b<, 8c, d<<, 82<D
881 + a2, 1 + b2<, 81 + c2, 1 + d2<<
Chapter1.nb
21

Therefore, the function that is  mapped must be a function of two arguments. The second argument is a position (note the list
braces) that can be used to modify the operation performed on the first argument.
MapIndexed@#1^ First@#2D &, 8a, b, c, d, e<D
8a, b2, c3, d4, e5<
 1.2.7.2 Apply
The rule Apply[h, expr] or h  expr replaces the head of expr by h.
a + b +c  FullForm
Plus@a, b, cD
Replacing the head Plus by Times gives the product of the three terms in the sum above.
8Apply@Times, a + b + cD, Times  Ha + b + cL<
8a b c, a b c<
With a third argument, Apply[h, expr, levelspec] replaces heads in the parts of expr described by levelspec by h.
Apply@b, 88a@1, 1D, a@1, 2D<, 8a@2, 1D, a@2, 2D<<, 82<D
88b@1, 1D, b@1, 2D<, 8b@2, 1D, b@2, 2D<<
This simple definition finds the average of a list of numbers
average@list1_ListD := Apply@Plus, list1D  Length@list1D
average@8a, b, c<D
1
3
Ha + b + cL
Note that  computing the average of a list in this  way requires  no do-loops or knowledge  of the length of the list. Apply is
frequently used if one first wants  to prepare a number of ingredients and then apply some operation to them. The ingredients
can be held in a list until they are ready and then the head of the list is changed to the appropriate operation by using Apply.
To generate more concise notations for the outputs created in the following chapters, we can introduce displayRule to meet
our needs. For example,
output = u2
H2,0,0L@T0, T1, T2D + w2 u2@T0, T1, T2D == 2 u1
H1,1,0L@T0, T1, T2D - d u1@T0, T1, T2D2;
displayRule = 9Derivative@a__D@ui_D@__D :>
SequenceFormATimes  MapIndexedAD#2@@1DD-1
#1
&, 8a<E, uiE, ui_@__D -> ui=;
output . displayRule
D0
2u2 + w2 u2 == 2 HD0 D1u1L - d u1
2
22
Chapter1.nb

 1.2.8 Nest and Fold
Nest and its  related operations  NestList and FixedPoint apply  a function  to its  argument many times. Nest[function, x, n]
applies function to x and repeats the application n times
NestAH1 + #L2 &, x, 3E
J1 + H1+ H1 + xL2L
2N
2
NestListAH1 + #L2 &, x, 3E
9x, H1 + xL2, H1 + H1 + xL2L2, J1 + H1 + H1 + xL2L2N
2
=
Here is an example producing a simple continued fraction.
Nest@1 H1 + #L &, a, 3D
1

1 +
1

1+ 1

1+a
An operation that  is  closely  related to Nest is  FixedPoint, which nests  its operation  until there  is  no change. For instance,
everyone is familiar with what happens if the Cos key on a pocket calculator is pushed repeatedly. In principle, FixedPoint is
what happens if it is pushed forever.
8Nest@Cos, 0.3, 5D, Nest@Cos, 0.3, 10D, FixedPoint@Cos, 0.3D<
80.784436, 0.732698, 0.739085<
Actually, FixedPoint stops  after machine accuracy  is  achieved. We  can  use the option  SameTest to  get  some  control of
FixedPoint.
FixedPoint@Cos, 0.3, SameTest -> HAbs@#1 - #2D < 10^ -5 &LD
0.739089
The  second  pair  of  functions, Fold and  FoldList, do  something  similar to  Nest  and  NestList,  but  for  functions  of two
variables.
Fold@f, u, 8x, y, z<D
f@f@f@u, xD, yD, zD
FoldList@f, u, 8x, y, z<D
8u, f@u, xD, f@f@u, xD, yD, f@f@f@u, xD, yD, zD<
Chapter1.nb
23

Chapter 2
The Duffing Equation
Off@General::spell1D
To symbolize some notations, we need to load the package
Needs@"Utilities`Notation`"D
à 2.1 The Duffing Equation
The free oscillations of many conservative  systems  having a single  degree  of freedom are governed by an  equation of
the form
eq21a = x†@tD + f@x@tDD == 0;
H* An equation is set and then assigned to eq21a *L
where f  is a nonlinear function of x@tD. Here, x†@tD is  the acceleration of the system, whereas f@x@tDD is the restoring force.
Let x = x0 be an equilibrium position of the system.  Then x0 is a constant and hence f@x0D = 0. In order for Mathematica
to interpret x0 as a constant, we need to symbolize it. Otherwise,  if we replace x with an expression g@tD, Mathematica will
replace x0 with g@tD sub 0 and not treat it as a constant. For example, replacing x with Sin@tD in the expression x2 + x0 yields 
x2 +x0 . x -> Sin@tD
Sin@tD2 + HSin@tDL0
Clearly, x0 is  treated as a variable x with subscript 0, which is  wrong. Therefore, we need to symbolize  x0 as   (enter and
select x0 followed by clicking Symbolize@D from NotationPalette)
Symbolize@x0D;
H* Note that symbol form is also required in certain built-in functions *L
Then, Mathematica  treats  the  symbolized  expression  x0  as  a  constant.  Consequently, replacing  x  with   Sin@tD in  the
expression x2 + x0 yields 
x2 + x0 . x -> Sin@tD
x0 +Sin@tD2
which is correct.
Next, we assume that f is an analytic function of x at x = x0 and expand it in a Taylor series around x0 as

fexp = Series@f@x@tDD, 8x@tD, x0, 3<D
f@x0D+ f¢@x0D Hx@tD - x0L + 1
2
f†@x0D Hx@tD - x0L2 + 1
6
fH3L@x0D Hx@tD - x0L3 + O@x@tD - x0D4
where terms up to cubic are retained. Using Normal to truncate the higher-order terms from fexp, we have
fpoly = fexp  Normal
f@x0D+ H-x0 + x@tDL f¢@x0D + 1
2
H-x0 + x@tDL2 f†@x0D + 1
6
H-x0 + x@tDL3 fH3L@x0D
Substituting fpoly for f@x@tDD and using the equilibrium condition f@x0D = 0, we obtain
temp = eq21a . 8f@x@tDD -> fpoly< . f@x0D -> 0
H-x0 + x@tDL f¢@x0D + 1
2
H-x0 + x@tDL2 f†@x0D + x†@tD + 1
6
H-x0 + x@tDL3 fH3L@x0D == 0
Now, we introduce the transformation x@tD ﬁx0 +u@tD in temp to obtain  the final form of the equation that will be used in the
subsequent  analysis.  To  accomplish  this,  we  need  to  express  this  transformation  in  a  pure  function  form  as
x ﬁHx0 +u@#D &L; otherwise, Mathematica will not transform the derivatives of x@tD in terms  of the derivatives  of u@tD unless
we  explicitly define  the rules  for those derivatives; that  is, it  will not  replace x¢@tD with u¢@tD and  x†@tD with u†@tD by  simply
substituting x@tD ﬁx0 + u@tD. Moreover, it will not replace x@pD with x0 +u@pD as  desired. To see the difference between these
two transformations, we compare the following two statements:
8x@tD, x@pD, x¢@tD, x†@tD< . x@tD -> x0 + u@tD
8x0 +u@tD, x@pD, x¢@tD, x†@tD<
8x@tD, x@pD, x@a, bD, y@tD, x¢@tD, x†@tD< . x -> Hx0 + u@#D &L
8x0 +u@tD, x0 + u@pD, x0 + u@aD, y@tD, u¢@tD, u†@tD<
We note that the pure  function form can be used for any expression with the head x, especially, for the derivatives. Conse-
quently, we introduce this transformation in pure function form into temp and obtain 
eq21b = temp . x -> Hx0 + u@#D &L
u@tD f¢@x0D + 1
2
u@tD2 f†@x0D + u†@tD + 1
6
u@tD3 fH3L@x0D == 0
To simplify the notation in eq21b, we denote the coefficient of u@tDb by kb. The result is
eq21c = eq21b . _. u@tD^ b_. -> kb u@tD^ b
k1 u@tD+ k2 u@tD2 + k3 u@tD3 + u†@tD == 0
We relate the kb to the derivatives of the function f@xD by using the built-in function Cases as 
26
Chapter2.nb

CasesAeq21b, a_. u@tDb_. -> 8kb -> a<, 82<E  Flatten
9k1 ﬁf¢@x0D, k2 ﬁ1
2
f†@x0D, k3 ﬁ1
6
fH3L@x0D=
Most of this  chapter is devoted to the special case of cubic nonlinearities. Thus, we set the coefficient of the quadratic term
in eq21c equal to zero and obtain
eq21d = eq21c . k2 -> 0
k1 u@tD+ k3 u@tD3 + u†@tD == 0
which is called the Duffing equation. We note that k1 and k3 may be positive or negative.
It is  a good practice to nondimensionalize  the governing equations before  treating them with perturbation methods. To this
end, we nondimensionalize  u and t using a characteristic  length U and a characteristic  time T of the motion and denote the
nondimensional variables by an asterisk. In nondimensional form, eq21d becomes
eq21e = eq21d . u -> HU u*@#  TD &L . t -> T t*
U k1 u*@t*D + U3 k3 u*@t*D3 + U Hu*L†@t*D

T2
== 0
Next, we multiply the left-hand side of eq21e (using eq21e[[1]]) by T2 U so that the coefficient of u*†@t*D is unity. The result
is
eq21f = Ieq21e@@1DD T2 U  ExpandM == 0
T2 k1 u*@t*D + T2 U2 k3 u*@t*D3 + Hu*L†@t*D == 0
We choose T so that the linear natural frequency of the system is unity; that is, we let k1 T2 = 1, for ease of notation, we let
e = k3 T2 U2, drop the asterisk, and rewrite eq21f as
DuffingEq = eq21f . 9k1 T2 -> 1, k3 T2 U2 -> e= . anything_* -> anything
u@tD + e u@tD3 + u†@tD == 0
We note that e is a nondimensional quantity, which is a measure of the strength of the nonlinearity.
à 2.2 Straightforward Expansion
To solve the DuffingEq, we augment it with the initial conditions
ic = 8u@0D == u0, u¢@0D == v0<;
The solution u of the initial-value problem (IVP), consisting of the DuffingEq and associated initial conditions ic, is  a func-
tion of the independent variable t and the parameter e. Next, we determine an approximation of the IVP for weak nonlinearity;
that is, for small but finite e.
Chapter2.nb
27

First, we  set  e equal  to  zero  in  the  DuffingEq, augment  the  result  with  the  initial conditions  by  using  the  Mathematica
command Join, and obtain the following linear IVP:
linearIVP = Join@8DuffingEq . e -> 0<, icD
8u@tD + u†@tD == 0, u@0D == u0, u¢@0D == v0<
The solution of this linear IVP can be obtained by using the Mathematica command DSolve. The result is
linearSol = DSolve@linearIVP, u@tD, tD@@1DD
8u@tD ﬁu0 Cos@tD + v0 Sin@tD<
When e is small but different from zero, the solution of the nonlinear initial-value problem is no longer given by linearSol, but
deviates from it. We try a correction in the form of a power series in e; that is, we expand u@tD in a power series in e as
uExpRule@maxOrder_D := u -> ISumAei ui@#D, 8i, 0, maxOrder<E &M
where u0@tD is the solution of the linear problem. For example, to first order, we have
u@tD . uExpRule@1D
u0@tD+ e u1@tD
and to third order, we have
u@tD . uExpRule@3D
u0@tD+ e u1@tD + e2 u2@tD + e3 u3@tD
and to fifth order, we have
u@tD . uExpRule@5D
u0@tD+ e u1@tD + e2 u2@tD + e3 u3@tD + e4 u4@tD + e5 u5@tD
Next, we restrict our discussion to first order;  that is, we keep two terms  in the power series. Thus, we apply the rule uExp-
Rule[1] to the DuffingEq, expand the result, and obtain
eq22atemp = DuffingEq . uExpRule@1D  ExpandAll
u0@tD+ e u0@tD3 + e u1@tD + 3 e2 u0@tD2 u1@tD + 3 e3 u0@tD u1@tD2 + e4 u1@tD3 + u0
†@tD + e u1
†@tD == 0
Since we kept only terms  up to OHeL in the expansion of u@tD, we need to neglect terms of order higher than e in eq22atemp for
consistency. To accomplish this, we use the rule en;n>k ﬁ0 to discard terms with order higher than ek and obtain
eq22a = eq22atemp . en_;n>1 -> 0
u0@tD+ e u0@tD3 + e u1@tD + u0
†@tD + e u1
†@tD == 0
Setting the coefficients of like powers of e in eq22a equal to zero, we obtain the following hierarchy of linear equations:
28
Chapter2.nb

eqEps = CoefficientList@eq22a@@1DD, eD == 0  Thread
8u0@tD+ u0
†@tD == 0, u0@tD3 + u1@tD + u1
†@tD == 0<
which needs to be solved in succession. That is, we first solve the first equation in eqEps to obtain u0@tD and then substitute
the result into the second equation in eqEps to obtain a linear nonhomogeneous equation, which can be solved for u1@tD.
The general solution of the zeroth-order problem (eqEps[[1]]) can be expressed in Cartesian form as
DSolve@eqEps@@1DD, u0@tD, tD@@1DD
8u0@tD ﬁC@2D Cos@tD - C@1D Sin@tD<
Alternatively, we can express the solution of the zeroth-order problem in the polar form u0@tD ﬁa0 Cos@t + b0D by adding two
appropriate initial conditions to eqEps[[1]] as
sol0 =
DSolve@8eqEps@@1DD, u0@0D == a0 Cos@b0D, u0¢@0D == -a0 Sin@b0D<, u0@tD, tD@@1DD  Simplify
8u0@tD ﬁCos@t + b0D a0<
where a0 and b0 are arbitrary constants. Because eqEps[[1]] represents  a linear undamped oscillator, one can write down its
general solution in either Cartesian or polar form without using the Mathematica command DSolve. 
Substituting for u0@tD in the first-order equation (eqEps[[2]]) and determining the general solution of the resulting equation for
u1@tD, we obtain
sol1temp = DSolve@eqEps@@2DD . sol0, u1@tD, tD@@1DD  Simplify
9u1@tD ﬁ
1

32
H32 HC@2D Cos@tD - C@1D Sin@tDL + H-6 Cos@t + b0D + Cos@3 Ht + b0LD - 12 t Sin@t + b0DL a0
3L=
We note  that the homogeneous  part of sol1temp consists  of the terms  involving the  C@iD (the usual case) and Cos@t + b0D
(obtained from DSolve in this case). Hence, we can replace them by a1 Cos@t + b1D and rewrite sol1temp as
sol1 = u1@tD ﬁHsol1temp@@1, 2DD . 8C@_D -> 0, Cos@t + _D -> 0<L + a1 Cos@t + b1D
u1@tD ﬁ
1

32
HCos@3 Ht + b0LD - 12 t Sin@t + b0DL a0
3 + Cos@t + b1D a1
Combining the  solutions  of the  zeroth- and  first-order problems, we  obtain  the  general solution  of the  DuffingEq, to  first
order, as
sol = u@tD == Hu@tD . uExpRule@1D . sol0 . sol1L
u@tD == Cos@t + b0D a0 + e i
k
jj 1

32
HCos@3 Ht + b0LD - 12 t Sin@t + b0DL a0
3 + Cos@t + b1D a1y
{
zz
where a0, a1, b0, and b1 are arbitrary constants.
Chapter2.nb
29

We started with a second-order equation that can support  two initial conditions but it appears  that we ended up with four
arbitrary constants. It turns out that only  two of the constants  a0, a1, b0, and b1 are arbitrary and that the two initial condi-
tions in ic are sufficient to determine all of them. To see this, we first change the Equal form in ic to the Rule form as
icRule = ic . Equal -> Rule
8u@0D ﬁu0, u¢@0D ﬁv0<
Then, we impose the initial conditions icRule by evaluating sol and its derivative at t = 0 according to
eq22b = 8sol, D@sol, tD< . t -> 0 . icRule
9u0 == Cos@b0D a0 + e i
k
jj 1

32
Cos@3 b0D a0
3 + Cos@b1D a1y
{
zz,
v0 == -Sin@b0D a0 + e i
k
jj 1

32
H-12 Sin@b0D - 3 Sin@3 b0DL a0
3 - Sin@b1D a1y
{
zz=
We equate the coefficient of each power of e in eq22b and obtain  four algebraic equations for the constants a0, a1, b0, and
b1. The result is
eq22c = Table@Map@Coefficient@#, e, iD &, eq22b, 82<D, 8i, 0, 1<D
98u0 == Cos@b0D a0, v0 == -Sin@b0D a0<,
90 ==
1

32
Cos@3 b0D a0
3 + Cos@b1D a1, 0 ==
1

32
H-12 Sin@b0D - 3 Sin@3 b0DL a0
3 - Sin@b1D a1==
Thus, once a0 and b0 are known from eq22c[[1]], a1 and b1 can be calculated from eq22c[[2]].
Alternatively,  instead  of  including  the  homogeneous  solution  at  each  order  and  consider  the  arbitrary  constants  to  be
independent of e as done above, one may disregard  the homogeneous solution at all orders  except the first and consider the
arbitrary constants to depend on e in imposing the initial conditions. With the latter approach, the solution to first order can
be rewritten as
sol . 8a0 -> a, b0 -> b, a1 -> 0<  ExpandAll
u@tD == a Cos@t + bD +
1

32
a3 e Cos@3 t + 3 bD - 3
8
a3 t e Sin@t + bD
We  note  that  the  correction  term  1
32  a3 eCos@3 t +3 bD - 38  a3 t eSin@t + bD  is  small  compared  to  the  principal  term
a Cos@t + bD, as it is supposed to be, only when et is small compared with unity. When et is OH1L, the term that is  supposed
to  be a small correction becomes  the same  order as  the principal term. Moreover, when et > OH1L, the "small-correction"
term becomes  larger than the principal term. Hence, the above obtained straightforward  expansion is  valid only  for times
such that et < OH1L; that is, t < OHe-1L. Consequently, we say such expansions are nonuniform or breakdown for long times
and we call them pedestrian  or naive expansions. The reason for the breakdown of the above expansion is the presence
of the term t Sin@t + bD, a product of algebraic and circular terms. Such terms are called mixed-secular terms. In subsequent
sections, we implement four methods that avoid secular terms, and hence yield uniform expansions.
30
Chapter2.nb

à 2.3 The Lindstedt-Poincaré Technique
The  breakdown  in  the  straightforward  expansion  is  due  to  its  failure  to  account  for  the  nonlinear dependence  of the
frequency  of the  system on  the  nonlinearity. A number of techniques  that yield  uniformly  valid  expansions have  been
developed. Four of these techniques  are discussed in this chapter. We start with the Lindstedt-Poincaré  technique in this
section.
To account for the dependence of the frequency w of the system on the nonlinearity, we explicitly exhibit w in the govern -
ing  differential equation. To this  end, we introduce  the transformation t = w t, where  w is  a constant  that depends on  e,
and obtain
DuffingEq = u†@tD + u@tD + e u@tD3 == 0;
eq23a = DuffingEq . u -> Hu@w #D &L . t -> t  w
u@tD + e u@tD3 + w2 u†@tD == 0
To determine a uniform expansion of the solution of eq23a, we expand both u@t; eD and w@eD in powers of e using uExpRule[k]
and  
omgRule@maxOrder_D := w -> w0 + SumAei wi, 8i, maxOrder<E
where w0  is  the linear natural frequency  of the system.  In  the present case, the  linear natural frequency  was normalized to
unity. Hence, we set w0 = 1. The corrections to the linear frequency are determined in the course of the analysis  by requiring
the expansion of u to be uniform for all t. Next, we show how one can determine w1.
Substituting the expansions of u and w into eq23a, using the fact that w0 = 1, setting maxOrder = 1, expanding the result,
and discarding terms of order higher than e, we obtain
eq23b = ExpandAll@eq23a . uExpRule@1D . omgRule@1DD . w0 -> 1 . en_;n>1 -> 0
u0@tD+ e u0@tD3 + e u1@tD + u0
†@tD + 2 e w1 u0
†@tD + e u1
†@tD == 0
Equating coefficients of like powers of e on both sides of eq23b yields
eqEps = CoefficientList@eq23b@@1DD, eD == 0  Thread
8u0@tD+ u0
†@tD == 0, u0@tD3 + u1@tD + 2 w1 u0
†@tD + u1
†@tD == 0<
The general solution of eqEps[[1]], the zeroth-order equation, can be expressed in polar form as
sol0 = DSolve@8eqEps@@1DD, u0@0D == a Cos@bD, u0¢@0D == -a Sin@bD<, u0, tD@@1DD
8u0 ﬁHa Cos@bD Cos@#1D - a Sin@bD Sin@#1D &L<
where a and b are constants. We have expressed u0 as  a pure  function so that we can evaluate its derivatives in the higher-
order problems.
Substituting for u0@tD in eqEps[[2]], the first-order equation, yields
Chapter2.nb
31

order1Eq = eqEps@@2DD . sol0  Simplify
a3 Cos@b + tD3 - 2 a Cos@b + tD w1 + u1@tD + u1
†@tD == 0
whose particular solution is
u1pSol = DSolve@order1Eq, u1@tD, tD@@1DD . C@_D -> 0  Simplify
9u1@tD ﬁ
1

32
a Ha2 H-6 Cos@b + tD + Cos@3 Hb + tLD - 12 t Sin@b + tDL + 16 HCos@b + tD + 2 t Sin@b + tDL w1L=
It is  clear that u1pSol contains a mixed-secular term, which makes the expansion nonuniform. In contrast with the straightfor-
ward expansion, where the secular term cannot be annihilated unless u is  trivial, in this case, we can choose the parameter w1
to eliminate the secular term according to
omg1Rule = Solve@Coefficient@u1pSol@@1, 2DD, Sin@b + tDD == 0, w1D@@1DD
:w1 ﬁ3 a2

8
>
Substituting for w1 into u1pSol, we have
sol1 = u1pSol . omg1Rule  Simplify
9u1@tD ﬁ
1

32
a3 Cos@3 Hb + tLD=
We  note that, to determine  the condition  for the  elimination of the  secular term from u1, we do  not need  to determine  the
particular solution first as  done above. Instead, we only  need to inspect order1Eq and choose w1  so that the coefficient of
Cos@b + tD, which  produces  secular terms  in  u1, is  equal to  zero. To  this  end, we  calculate  the  nonhomogeneous part  of
order1Eq and simplify the result using trigonometric identities as
expr23a = order1Eq@@1DD . u1 -> H0 &L  TrigReduce
1
4
H3 a3 Cos@b + tD + a3 Cos@3 b + 3 tD - 8 a Cos@b + tD w1L
Next, we choose w1 to annihilate the term in expr23a that produces secular terms, namely Cos@b + tD, and obtain
Solve@Coefficient@expr23a, Cos@b + tDD == 0, w1D@@1DD
:w1 ﬁ3 a2

8
>
Substituting sol0 and sol1 into uExpRule[1] yields
u@tD = Hu@tD . uExpRule@1D . sol0 . sol1  SimplifyL
a Cos@b + tD +
1

32
a3 e Cos@3 Hb + tLD
32
Chapter2.nb

Replacing t with w t, substituting for w, using the fact that w0 = 1, and expanding the arguments  of the trigonometric func-
tions, we obtain
solLP =
u@tD == Hu@tD . t -> w t . omgRule@1D . omg1Rule . w0 -> 1 . f_@arg_D :> f@arg  ExpandDL
u@tD == a CosAt + b + 3
8
a2 t eE +
1

32
a3 e CosA3 t + 3 b + 9
8
a2 t eE
Clearly, the expansion solLP is free of secular terms and the correction term 1
32  a3 eCosA3 t +3 b + 98  ea2 tE is small compared
with the principal term a CosAt + b + 38  ea2 tE for all t and hence it is uniformly valid.
à 2.4 The Method of Multiple Scales
We note from solLP that the functional dependence of u on t and e is not disjoint. In fact, u depends on the combination
et as  well as  on the individual t and e. Carrying out the expansion to higher order, we find that u depends on the combina-
tions  et,e2 t,e3 t,”  as  well  as  on  the  individual  t  and  e.  Hence,  u = u(et,e2 t,e3 t,”;  e).  For  small  e,  Tn = en t,  for
n = 1, 2, 3,”, represent  different time  scales. For example, if e =
1
60 , variations on  the time  scales  T0, T1, and T2  can  be
observed, respectively, on the second, minute, and hour arms  of a watch. Thus, T0  represents a fast time scale, T1  repre-
sents  a slower time scale, T2 represents an even slower time scale, and so on. Since the dependence of u on t and e occurs
on  different time  scales, we  imagine that  we have  a watch  and attempt  to observe the  behavior of u  using the  different
scales  of the watch. Therefore, instead of determining u as  a function of t, we determine u as  a function of T0, T1, T2, ”.
To this  end, we change the independent variable t in the governing equation from t to T0, T1, T2, ” , which are symbolized
by
Symbolize@T0D; Symbolize@T1D; Symbolize@T2D;
timeScales = 8T0, T1, T2<;
We define the derivative operators as
dt@1D@expr_D := SumAei D@expr, timeScales@@i + 1DDD, 8i, 0, maxOrder<E;
dt@2D@expr_D := Hdt@1D@dt@1D@exprDD  ExpandL . ei_;i>maxOrder -> 0;
and treat the time scales T0, T1, and T2 as independent variables.
Next, we use the method of multiple scales  to determine an approximate solution for the DuffingEq. In Section 2.4.1, we treat
the DuffingEq in its second-order form;  in Section 2.4.2, we transform it first into a system of two real-valued equations; and
in Section 2.4.3, we transform it first into a single complex-valued equation.
 2.4.1 Second-Order Real-Valued System
DuffingEq = u†@tD + u@tD + e u@tD3 == 0;
Chapter2.nb
33

To determine a first-order uniform expansion of the solution of the Duffing equation, we use the two time scales  T0 and T1
and hence let
maxOrder = 1;
Expressing the time derivative in DuffingEq in terms of the two time scales T0 and T1, we have
eq241a = DuffingEq . 8u@tD -> u@T0, T1D, Derivative@n_D@uD@tD -> dt@nD@u@T0, T1DD<
u@T0, T1D + e u@T0, T1D3 + 2 e uH1,1L@T0, T1D + uH2,0L@T0, T1D == 0
Consequently, we have replaced the original ordinary-differential equation by a partial-differential equation, and it appears
that, as  a result, we have complicated the problem. This  is  partially true, but experience with this  method has  shown  that
the  disadvantages  of introducing  this  complication  are  far outweighed  by  the  advantages. Not  only  does  this  method
provide  a  uniform expansion,  but  it  also  provides  all  the  various  nonlinear resonance  phenomena,  as  we  shall  see  in
subsequent chapters.
We seek a uniform second-order expansion of the solution of eq241a in the form
solRule = u -> ISumAei ui@#1, #2D, 8i, 0, maxOrder<E &M;
Substituting this expansion into eq241a, expanding the result, and discarding terms of order higher than e, we obtain
eq241b = Heq241a . solRule  ExpandAllL . en_;n>maxOrder -> 0
u0@T0, T1D + e u0@T0, T1D3 + e u1@T0, T1D + 2 e u0
H1,1L@T0, T1D + u0
H2,0L@T0, T1D + e u1
H2,0L@T0, T1D == 0
Equating coefficients of like powers of e in eq241b yields
eqEps = CoefficientList@eq241b@@1DD, eD == 0  Thread
9u0@T0, T1D + u0
H2,0L@T0, T1D == 0, u0@T0, T1D3 + u1@T0, T1D + 2 u0
H1,1L@T0, T1D + u1
H2,0L@T0, T1D == 0=
The general solution of eqEps[[1]] can be written in a pure function form as
sol0 = u0 -> Ha@#2D Cos@#1 + b@#2DD &L;
where #1 stands for the scale T0 and #2 stands for the scale T1. The functional dependence of a and b on T1 is not known at
this level of approximation; it is determined at subsequent levels of approximation by eliminating the secular terms.
Substituting sol0 into eqEps[[2]] and moving the nonhomogeneous parts  to the right-hand side of the resulting equation
yields
eq241c = HeqEps@@1, 1DD . u0 -> u1L - # &  Reverse@eqEps@@2DD . sol0  SimplifyD
u1@T0, T1D + u1
H2,0L@T0, T1D ==
-a@T1D3 Cos@T0 + b@T1DD3 + 2 Sin@T0 + b@T1DD a¢@T1D + 2 a@T1D Cos@T0 + b@T1DD b¢@T1D
Next, we expand the right-hand side of eq241c in a Fourier series using trigonometric identities and obtain
34
Chapter2.nb

eq241c@@2DD = eq241c@@2DD  TrigFactor  Expand
- 3
4
a@T1D3 Cos@T0 + b@T1DD - 1
4
a@T1D3 Cos@3 T0 + 3 b@T1DD +
2 Sin@T0 + b@T1DD a¢@T1D + 2 a@T1D Cos@T0 + b@T1DD b¢@T1D
To  produce  a  uniform expansion, we  eliminate the  terms  that  produce  secular terms  from eq241c[[2]];  that  is, we  choose
a1¢@T1D and b¢@T1D to annihilate each of the coefficients of Sin@T0 + b@T1DD and Cos@T0 + b@T1DD. The result is
eq241d = Coefficient@eq241c@@2DD, #D == 0 &  8Sin@T0 + b@T1DD, Cos@T0 + b@T1DD<
92 a¢@T1D == 0, - 3
4
a@T1D3 + 2 a@T1D b¢@T1D == 0=
Solving eq241d for a1¢@T1D and b¢@T1D when a@T1D „ 0 yields
SCond = Solve@eq241d, 8a¢@T1D, b¢@T1D<D@@1DD
9a¢@T1D ﬁ0, b¢@T1D ﬁ3
8
a@T1D2=
The solution of SCond[[1]] is a = a0 = constant. Then, the solution of SCond[[2]] is
betaRule = DSolve@eq241d@@2DD . a@T1D -> a0, b@T1D, T1D@@1DD . C@1D -> b0
9b@T1D ﬁ3
8
T1 a0
2 + b0=
With the above solvability conditions, eq241c becomes
eq241e = eq241c . SCond
u1@T0, T1D + u1
H2,0L@T0, T1D == - 1
4
a@T1D3 Cos@3 T0 + 3 b@T1DD
The particular solution of eq241e can be obtained as
sol1 = DSolve@eq241e, u1@T0, T1D, 8T0, T1<D@@1DD . C@_D -> H0 &L  Simplify
9u1@T0, T1D ﬁ
1

32
a@T1D3 Cos@3 HT0 + b@T1DLD=
eq241f = u@T0, T1D == Hu@T0, T1D . solRule . sol0 . sol1 . a@T1D -> a0 . betaRuleL
u@T0, T1D == CosAT0 + 3
8
T1 a0
2 + b0E a0 +
1

32
e CosA3 i
k
jjT0 + 3
8
T1 a0
2 + b0y
{
zzE a0
3
where a0  and  b0  are constants  to within the  order of the error indicated. In terms  of the original variable  t, eq241f can  be
expressed as
u@tD == eq241f@@2DD . 8T0 -> t, T1 -> e t<
u@tD == CosAt + 3
8
t e a0
2 + b0E a0 +
1

32
e CosA3 i
k
jjt + 3
8
t e a0
2 + b0y
{
zzE a0
3
Chapter2.nb
35

in agreement with the expansion obtained by using the Lindstedt-Poincaré technique.
In the  higher-order approximations, we include the  scales  T0, T1, ”, TN  but we do  not include the term O@eN D in an  N th-
order expansion.
Before closing this  section, we present an alternate representation of the solutions of the perturbation equations. Instead of
the real-valued form sol0, we represent the solution of eqEps[[1]] in a complex-valued form; that is,
sol0 = u0 -> IA@#2D Exp@I #1D + A@#2D Exp@-I #1D &M;
where A is the complex conjugate of A and
ruleA = 9A -> i
k
jj 1
2
 a@#D Exp@I b@#DD &y
{
zz, A-> i
k
jj 1
2
 a@#D Exp@-I b@#DD &y
{
zz=;
Substituting sol0 into eqEps[[2]] and moving the nonhomogeneous terms to the right-hand side of the resulting equation, we
have
eq241g = u1@T0, T1D + u1
H2,0L@T0, T1D - # &  HeqEps@@2DD . sol0L  ExpandAll  Reverse
u1@T0, T1D + u1
H2,0L@T0, T1D == -E3 IT0 A@T1D3 - 3 EI T0 A@T1D2 A@T1D -
3 E-I T0 A@T1D A@T1D
2 - E-3 I T0 A@T1D
3 - 2 I EI T0 A¢@T1D + 2 I E-I T0 A¢@T1D
We note that the terms  proportional to Exp@I T0D and Exp@-I T0D produce secular terms  in the particular solution of u1. Thus,
to produce a uniform expansion, we set the coefficient of each of these functions equal to zero; that is,
eq241h = Coefficient@eq241g@@2DD, #D == 0 &  8Exp@I T0D, Exp@-I T0D<
:-3 A@T1D2 A@T1D - 2 I A¢@T1D == 0, -3 A@T1D A@T1D2 + 2 I A¢@T1D == 0>
These two  equations  are  not  independent  because they  are  complex conjugates  of each  other.  Hence,  if one  of them is
satisfied, the other is automatically satisfied.
To analyze the solutions of eq241h[[1]], we multiply it by Exp@-I b@T1DD and replace A with its polar form ruleA. The result is
eq241i = Expand@eq241h@@1, 1DD Exp@-I b@T1DD . ruleAD == 0
- 3
8
a@T1D3 - I a¢@T1D + a@T1D b¢@T1D == 0
Next, we separate the real and imaginary parts of eq241i. To accomplish this, we define the following rule: 
realRule = 8Re@s_D -> s, Im@s_D -> 0<;
Using the realRule, we find that the imaginary part of eq241i is
ampEq = Im@eq241i@@1DDD == 0 . realRule
-a¢@T1D == 0
36
Chapter2.nb

which governs the modulation of the amplitude. Similarly, the real part of eq241i is
phaseEq = Re@eq241i@@1DDD == 0 . realRule
- 3
8
a@T1D3 + a@T1D b¢@T1D == 0
which  governs the  modulation of the  phase. These modulation equations  are in  agreement  with those obtained above  by
expressing the solution in real form.
Comparing the complex-valued and  the real-valued  representations, we find  it more  convenient to  use the complex-valued
form. Therefore, the complex-valued form is used in the remainder of this book.
 2.4.2 First-Order Real-Valued System
We let v@tD = u¢@tD and transform the DuffingEq into the following set of two first-order equations:
eq242a = 9u¢@tD == v@tD, v¢@tD + u@tD == -e u@tD3=;
We seek a first-order uniform expansion of the solution of eq242a in terms of the two time scales T0 and T1 in the form
solRule = 9u -> ISumAej uj@#1, #2D, 8j, 0, 1<E &M, v -> ISumAej vj@#1, #2D, 8j, 0, 1<E &M=;
Substituting solRule into eq242a, transforming the derivative with respect to t in terms  of the derivatives  with respect to T0
and T1, and discarding terms of order higher than e, we obtain
eq242b = Heq242a . 8u_¢@tD -> dt@1D@u@T0, T1DD, u_@tD -> u@T0, T1D< . solRule  ExpandAllL .
en_;n>1 -> 0
9e u0
H0,1L@T0, T1D + u0
H1,0L@T0, T1D + e u1
H1,0L@T0, T1D == v0@T0, T1D + e v1@T0, T1D,
u0@T0, T1D + e u1@T0, T1D + e v0
H0,1L@T0, T1D + v0
H1,0L@T0, T1D + e v1
H1,0L@T0, T1D == -e u0@T0, T1D3=
Equating coefficients of like powers of e, we have
eqEps = Thread@CoefficientList@Subtract  #, eD == 0D &  eq242b  Transpose
99-v0@T0, T1D + u0
H1,0L@T0, T1D == 0, u0@T0, T1D + v0
H1,0L@T0, T1D == 0=,
9-v1@T0, T1D + u0
H0,1L@T0, T1D + u1
H1,0L@T0, T1D == 0,
u0@T0, T1D3 + u1@T0, T1D + v0
H0,1L@T0, T1D + v1
H1,0L@T0, T1D == 0==
 Zeroth-Order Problem: Linear System
The zeroth-order problem is given by the linear system
linearSys = #@@1DD &  eqEps@@1DD
9-v0@T0, T1D + u0
H1,0L@T0, T1D, u0@T0, T1D + v0
H1,0L@T0, T1D=
Chapter2.nb
37

To determine the solution of this linear system, we seek a solution proportional to Exp@I T0D as
coefList = E-I T0 linearSys . 9u0 -> IP EI # &M, v0 -> IQ EI # &M=  Expand
8I P - Q, P + I Q<
Next, we determine the coefficient matrix as
coefMat = Outer@Coefficient, coefList, 8P, Q<D
88I, -1<, 81, I<<
To determine the eigenvalues and eigenvectors of coefMat, we define the following conjugate rule and Hermitian matrix:
conjugateRule = 9A -> A, A -> A, Complex@0, n_D -> Complex@0, -nD=;
hermitian@mat_? MatrixQD := mat . conjugateRule  Transpose
Then the left and right eigenvectors of coefMat are given by
leftVec = 81, c1< . Solve@Hhermitian@coefMatD.81, c1<L@@1DD == 0, c1D@@1DD
81, I<
rightVec = 81, c1< . Solve@HcoefMat.81, c1<L@@1DD == 0, c1D@@1DD
81, I<
To express the solution of the zeroth-order problem, we introduce the following basic function:
basicH = A@T1D EI T0 ;
In terms of this function and the right eigenvector, the solution of the zeroth-order problem can be expressed in terms of
sol0Form = rightVec basicH
8EI T0 A@T1D, I EI T0 A@T1D<
and its complex conjugate as
sol0 =
8u0 -> Function@8T0, T1<, sol0Form@@1DD + Hsol0Form@@1DD . conjugateRuleL  EvaluateD,
v0 -> Function@8T0, T1<, sol0Form@@2DD + Hsol0Form@@2DD . conjugateRuleL  EvaluateD<
8u0 ﬁFunction@8T0, T1<, EI T0 A@T1D + E-I T0 A@T1DD,
v0 ﬁFunction@8T0, T1<, I EI T0 A@T1D - I E-I T0 A@T1DD<
We  have expressed  the solution  of the zeroth-order problem in  function form so  that its  partial derivatives  can  be readily
evaluated.
38
Chapter2.nb

 First-Order Problem
Substituting the zeroth-order solution sol0 into the first-order problem eqEps[[2]] and moving the nonhomogeneous terms  to
the right-hand sides of the resulting equations, we obtain
order1Eq = HlinearSys . u_0 -> u1L ==
HlinearSys . u_0 -> u1L - HSubtract  # &  eqEps@@2DD . sol0  ExpandL  Thread
:-v1@T0, T1D + u1
H1,0L@T0, T1D == -EI T0 A¢@T1D - E-I T0 A¢@T1D,
u1@T0, T1D + v1
H1,0L@T0, T1D == -E3 IT0 A@T1D3 - 3 EI T0 A@T1D2 A@T1D -
3 E-I T0 A@T1D A@T1D
2 - E-3 I T0 A@T1D
3 - I EI T0 A¢@T1D + I E-I T0 A¢@T1D>
Eliminating the terms  that produce  secular terms  in  order1Eq demands that  their  right-hand sides  are orthogonal to  every
solution  of the  adjoint  homogeneous  problem.  To  determine  these conditions, we  first calculate  the  coefficient  vector of
Exp@I T0D as
STerms = Coefficient@#@@2DD, Exp@I T0DD &  order1Eq
8-A¢@T1D, -3 A@T1D2 A@T1D - I A¢@T1D<
Then, we demand that this vector is orthogonal to the left eigenvector and obtain the solvability condition
SCond = Expand@Conjugate@leftVecD.STermsD == 0
3 I A@T1D2 A@T1D - 2 A¢@T1D == 0
which is  in agreement with that obtained by treating the second-order form of the DuffingEq. Repeating the procedure for the
coefficient vector of Exp@-I T0D, we obtain the complex conjugate of SCond.
 2.4.3 First-Order Complex-Valued System
In this  section, we  determine a first-order uniform expansion of the solution of the DuffingEq by transforming it  first into a
single first-order complex-valued equation. To this end, we introduce the transformation
transfRule = 9u@tD -> z@tD + z@tD, u¢@tD -> I Iz@tD - z@tDM=;
whose inverse is
zetaRule = SolveAtransfRule . Rule -> Equal, 9z@tD, z@tD=E@@1DD
9z@tD ﬁ1
2
Hu@tD - I u¢@tDL, z@tD ﬁ1
2
Hu@tD + I u¢@tDL=
It follows from the DuffingEq that the acceleration is related to the displacement according to
Chapter2.nb
39

acceleration = Solve@DuffingEq, u†@tDD@@1DD
8u†@tD ﬁ-u@tD - e u@tD3<
Differentiating  z@tD,  zetaRule[[1]],  with  respect  to  t  and  substituting  for u@tD, u¢@tD, and  u†@tD  using  the  acceleration  and
transfRule, we obtain
eq243a = D@zetaRule@@1DD, tD . acceleration . transfRule . Rule -> Equal  ExpandAll
z¢@tD == I z@tD + 1
2
I e z@tD3 + 3
2
I e z@tD2 z@tD + 3
2
I e z@tD z@tD
2 + 1
2
I e z@tD
3
Next, we use the method of multiple scales to determine a first-order uniform expansion of the solution of eq243a in the form
solRule = 9z -> ISumAej zj@#1, #2D, 8j, 0, 1<E &M, z -> ISumAej z
j@#1, #2D, 8j, 0, 1<E &M=;
Substituting this expansion into eq243a, expanding the result, and discarding terms of order higher than e, we have
eq243b =
Ieq243a . 9z@tD -> z@T0, T1D, z@tD -> z@T0, T1D, z¢@tD -> dt@1D@z@T0, T1DD= . solRule 
ExpandAllM . en_;n>1 -> 0
e z0
H0,1L@T0, T1D + z0
H1,0L@T0, T1D + e z1
H1,0L@T0, T1D == I z0@T0, T1D + 1
2
I e z0@T0, T1D3 +
I e z1@T0, T1D + 3
2
I e z0@T0, T1D2 z
0@T0, T1D + 3
2
I e z0@T0, T1D z
0@T0, T1D
2 + 1
2
I e z
0@T0, T1D
3
Equating coefficients of like power of e in eq243b yields
eqEps = CoefficientList@Subtract  eq243b, eD == 0  Thread
9-I z0@T0, T1D + z0
H1,0L@T0, T1D == 0,
- 1
2
I z0@T0, T1D3 - I z1@T0, T1D - 3
2
I z0@T0, T1D2 z
0@T0, T1D - 3
2
I z0@T0, T1D z
0@T0, T1D
2 -
1
2
I z
0@T0, T1D
3 + z0
H0,1L@T0, T1D + z1
H1,0L@T0, T1D == 0=
The solution of the zeroth-order problem, eqEps[[1]], can be expressed as
sol0Form = DSolve@eqEps@@1DD, z0@T0, T1D, 8T0, T1<D@@1DD . C@1D -> A
8z0@T0, T1D ﬁEI T0 A@T1D<
which we express in function form as
sol0 = 8z0 -> Function@8T0, T1<, sol0Form@@1, 2DD  EvaluateD<
8z0 ﬁFunction@8T0, T1<, EI T0 A@T1DD<
To evaluate the complex conjugates of A and z, we define the conjugate rule
40
Chapter2.nb

conjugateRule = 9A -> A, A -> A, z -> z, z -> z, Complex@0, n_D -> Complex@0, -nD=;
Substituting sol0  into the first-order problem, eqEps[[2]], using  conjugateRule, and moving  the nonhomogeneous terms  to
the right-hand side of the resulting equation, we obtain
order1Eq = HeqEps@@1, 1DD . z0 -> z1L ==
HeqEps@@1, 1DD . z0 -> z1L - HeqEps@@2, 1DD . sol0 . Hsol0 . conjugateRuleLL
-I z1@T0, T1D + z1
H1,0L@T0, T1D ==
1
2
I E3 I T0 A@T1D3 + 3
2
I EI T0 A@T1D2 A@T1D + 3
2
I E-I T0 A@T1D A@T1D
2 + 1
2
I E-3 I T0 A@T1D
3 - EI T0 A¢@T1D
Elimintaing the terms that lead to secular terms from order1Eq yields the solvability condition
SCond = CoefficientAorder1Eq@@2DD, EIT0 E == 0
3
2
I A@T1D2 A@T1D - A¢@T1D == 0
in agreement with that obtained by treating the second-order form of the DuffingEq as  well as  that obtained by transforming
it first into two first-order real-valued equations.
à 2.5 Variation of Parameters
In  the  next  section, we  use  the  method  of averaging  to  determine  a  first-order uniform expansion  of  the  solution  of the
Duffing equation. To this  end, we use the method of variation of parameters  to transform it into a system of two first-order
equations. The Duffing equation is repeated here; that is,
DuffingEq = u†@tD + u@tD + e u@tD3 == 0;
When e = 0, the solution of this equation can be written as
usolEq = u@tD == a Cos@t + bD;
where a and b are constants, which are sometimes referred to as parameters. It follows from usolEq that
cond01 = D@usolEq, tD
u¢@tD == -a Sin@t + bD
When e „ 0, we assume that the solution of DuffingEq is still given by usolEq but with time-varying a and b; that is,
tdepRule = 8a -> a@tD, b -> b@tD<;
and hence
usolEqt = usolEq . tdepRule
u@tD == a@tD Cos@t + b@tDD
Chapter2.nb
41

In  other words, we  consider usolEq as  a transformation  from u@tD to  a@tD and  b@tD. This  is  why  this  approach is  called  the
method of variation of parameters. Using this  view, we note that we have two equations, namely DuffingEq and usolEq, for
the  three  unknowns  u@tD, a@tD, and  b@tD. Hence,  we  have  the  freedom of imposing  a  third  condition  (third  equation).  This
condition is  arbitrary except that it must be independent of DuffingEq and usolEq. This  arbitrariness can be used to advan-
tage,  namely to  produce a simple  and convenient  transformation. Out  of all possible  conditions, we  choose to  impose the
condition cond01, thereby assuming that u@tD as well as  u¢@tD have the same form as in the linear case. This  condition leads to
a convenient transformation; it leads to a set of first-order rather than second-order equations for a@tD and b@tD.
Differentiating usolEq with respect to t and recalling that a and b are functions of t, we have
cond02 = D@usolEqt, tD
u¢@tD == Cos@t + b@tDD a¢@tD - a@tD Sin@t + b@tDD H1 + b¢@tDL
Comparing cond02 with cond01, we conclude that
cond1 = Expand@cond02@@2DD - Hcond01@@2DD . tdepRuleLD == 0
Cos@t + b@tDD a¢@tD - a@tD Sin@t + b@tDD b¢@tD == 0
Differentiating cond01 with respect to t, we obtain
cond03 = D@cond01 . tdepRule, tD
u†@tD == -Sin@t + b@tDD a¢@tD - a@tD Cos@t + b@tDD H1 + b¢@tDL
Substituting for u@tD and u†@tD from usolEqt and cond03 into DuffingEq, we have
cond2 = DuffingEq . H8usolEqt, cond03< . Equal -> RuleL  ExpandAll
e a@tD3 Cos@t + b@tDD3 - Sin@t + b@tDD a¢@tD - a@tD Cos@t + b@tDD b¢@tD == 0
Solving cond1 and cond2 for a¢@tD and b¢@tD, we obtain the desired two first-order equations
transformedEq = HSolve@8cond1, cond2<, 8a¢@tD, b¢@tD<D@@1DD  SimplifyL . Rule -> Equal
8a¢@tD == e a@tD3 Cos@t + b@tDD3 Sin@t + b@tDD, b¢@tD == e a@tD2 Cos@t + b@tDD4<
if a T 0. Thus, the original second-order DuffingEq for u@tD has been replaced by two first-order equations for a@tD and b@tD.
We emphasize  that no approximations  have been made in deriving  transformedEq. Comparing transformedEq with Duff-
ingEq, we  find  that the  transformed  equations  are more  nonlinear than  the original equation. Then, the question  arises
what is the value of this transformation? The answer depends on the value of e. If e is small, the major parts of a and b vary
more slowly  with t  than u. This  fact  can be  used to advantage  analytically and numerically. The analytical advantage is
utilized in  the method of averaging, as  discussed in the  next  section. Numerically, it is  advantageous  to solve the trans-
formed equations  instead  of the original equation  because a  large step  size  can  be  used in  the  integration. This  is  the
reason why astronomers  numerically  solve the variational equations rather than the original equations. Usually, astrono-
mers and celestial mechanicians refer to this approach as the special method of perturbations.
42
Chapter2.nb

à 2.6 The Method of Averaging
In this  section, we determine a first-order approximation to the transformed equations obtained  in the preceding section.
To this end, we rewrite transformedEq as
ampEq = TrigReduce  transformedEq@@1DD
a¢@tD == 1
8
H2 e a@tD3 Sin@2 t + 2 b@tDD + e a@tD3 Sin@4 t + 4 b@tDDL
phaseEq = TrigReduce  transformedEq@@2DD
b¢@tD == 1
8
H3 e a@tD2 + 4 e a@tD2 Cos@2 t + 2 b@tDD + e a@tD2 Cos@4 t + 4 b@tDDL
The major parts  of a  and b are slowly varying functions of time if e is  small. Hence, they change very  little during the time
interval p (the period of the circular functions) and, to the first approximation, they can be considered constant in the interval
@0, pD. Hence, we replace a@tD and b@tD on the right-hand sides  of ampEq and phaseEq with time-independent a and b and
obtain
ampEq@@2DD = ampEq@@2DD . HReverse  tdepRuleL
1
8
H2 a3 e Sin@2 t + 2 bD + a3 e Sin@4 t + 4 bDL
phaseEq@@2DD = phaseEq@@2DD . HReverse  tdepRuleL
1
8
H3 a2 e + 4 a2 e Cos@2 t + 2 bD + a2 e Cos@4 t + 4 bDL
We average the right-hand sides of ampEq and phaseEq over the interval @0, pD and obtain
list26a = 1

p
Integrate@#, 8t, 0, p<D &  8ampEq@@2DD, phaseEq@@2DD<  Expand
Integrate::gener :  Unable to check convergence
Integrate::gener :  Unable to check convergence
:0, 3 a2 e

8
>
It follows from the above result that
averagingEq = 8a¢@tD, b¢@tD< == list26a  Thread
:a¢@tD == 0, b¢@tD == 3 a2 e

8
>
This averaging method is usually referred to as the Krylov-Bogoliubov or van der Pol technique.
Solving the averaged equations yields
Chapter2.nb
43

rule26a = DSolve@averagingEq, 8a@tD, b@tD<, tD@@1DD . 8C@1D -> a0, C@2D -> b0<
9a@tD ﬁa0, b@tD ﬁ1
8
H3 a2 t e + 8 b0L=
Substituting for a@tD and b@tD into usolEq, we obtain, to the first approximation, that
usolEq . tdepRule . rule26a . Cos@arg_D :> Cos@Expand@argDD
u@tD == CosAt + 3
8
a2 t e + b0E a0
in agreement with the solutions obtained by using the Lindstedt-Poincaré technique and the method of multiple scales.
Before closing this  section, we note that one can arrive at the final results  in ampEq and phaseEq without going through the
averaging process. The right-hand sides of ampEq and phaseEq are the sum of two groups of terms  — a group that is a linear
combination of fast varying terms and a group that is  a linear combination of slowly varying terms. Then, to the first approxi-
mation, a¢@tD in ampEq is  equal to the slowly varying group on its right-hand side, which is zero. And, to the first approxima-
tion, b¢@tD in phaseEq is equal to the slowly varying group on its right-hand side, which is 38  ea2.
44
Chapter2.nb

Chapter 3
Systems with Quadratic and Cubic 
Nonlinearities
Off@General::spell1D
à 3.1 Nondimensional Equation of Motion
We consider the free oscillations of a particle of mass m under the action of gravity and restrained by a nonlinear spring. The
equation of motion is
eq31a = m D@x*@t*D, 8t*, 2<D + f@x*@t*DD == m g
f@x*@t*DD + m Hx*L†@t*D == g m
where g is  the gravitational acceleration and f@x*D is the restraining force of the spring. We assume that f@x*D is an odd cubic
function of x*; that is,
eq31b = eq31a . f@a_D -> k1 a + k3 a3
k1 x*@t*D + k3 x*@t*D3 + m Hx*L†@t*D == g m
The equilibrium positions x* = xs
* = constant can be obtained by dropping the acceleration term. The result is
eq31c = eq31b . x* -> Hxs
* &L
k1 HxsL* + k3 HHxsL*L3 == g m
In this chapter, we investigate small oscillations about one of the equilibrium positions. To this  end, we shift  this equilibrium
position to the origin by using the transformation
xRule = 8x* -> Hxs
* + u*@#D &L<;
Substituting this transformation into eq31b and using the equilibrium condition eq31c, we obtain
eq31d = Expand@Subtract  eq31b . xRuleD == 0 . Heq31c . Equal -> RuleL
k1 u*@t*D + 3 k3 HHxsL*L2 u*@t*D + 3 k3 HxsL* u*@t*D2 + k3 u*@t*D3 + m Hu*L†@t*D == 0
As before, we introduce the following dimensionless quantities:
dimenRule = 8u* -> Hxs
* u@#  TD &L, t* -> T t<;

into eq31d and obtain
eq31e = Ieq31d@@1DD T2 Hm xs
*L . dimenRule  ExpandM == 0
T2 k1 u@tD

m
+ 3 T2 k3 HHxsL*L2 u@tD


m
+ 3 T2 k3 HHxsL*L2 u@tD2


m
+ T2 k3 HHxsL*L2 u@tD3


m
+ u†@tD == 0
We rewrite eq31e as
eq31f = HCollect@eq31e@@1DD, u@tDD . 8_ u@tD ^n_. -> an u@tD ^n<L == 0
a1 u@tD+ a2 u@tD2 + a3 u@tD3 + u†@tD == 0
where the a j are given by
alphas = Ia# -> CoefficientAeq31e@@1DD, u@tD#EM &  81, 2, 3<
:a1 ﬁT2 k1

m
+ 3 T2 k3 HHxsL*L2

m
, a2 ﬁ3 T2 k3 HHxsL*L2

m
, a3 ﬁT2 k3 HHxsL*L2

m
>
We choose T so that a1 = 1 and hence the natural frequency is unity; that is,
TRule = Solve@a1 == 1 . alphas, TD@@2DD
:T ﬁ
 ! !!m


" ### #### #### #### ### #### ###
k1 + 3 k3 HHxsL*L2
>
Consequently, a2 and a3 can be rewritten as
alphas = alphas . TRule  Rest
:a2 ﬁ
3 k3 HHxsL*L2


k1 + 3 k3 HHxsL*L2 , a3 ﬁ
k3 HHxsL*L2


k1 + 3 k3 HHxsL*L2 >
With a1 being unity, eq31f becomes
eq31g = eq31f . a1 -> 1
u@tD + a2 u@tD2 + a3 u@tD3 + u†@tD == 0
In contrast with the DuffingEq, eq31g contains a quadratic as well as a cubic term.
In  the  next  section, we  determine  a  second-order straightforward  expansion  to the  solutions  of eq31g  for small but  finite
amplitudes. In Section  3.3, we  determine a  uniform second-order expansion  by  using the  Lindstedt-Poincaré  technique. In
Section 3.4, we determine a uniform second-order expansion by using the method of multiple scales. In Section 3.5, we show
that the first approximation obtained with the method of averaging yields an incomplete solution. In Section 3.6, we introduce
the  generalized  method  of  averaging  and  obtain  a  uniform  second-order expansion.  Finally, in  Sections  3.7 and  3.8, we
introduce the Krylov-Bogoliubov-Mitropolsky technique and the method of normal forms, respectively.
46
Chapter3.nb

à 3.2 Straightforward Expansion
To carry out a straightforward  expansion for small but finite amplitudes for eq31g, we need to introduce a small parameter e as
a bookkeeping parameter. In terms of this parameter, we seek a third-order expansion in the form
uExpRule@maxOrder_D := u -> ISumAei ui@#D, 8i, 1, maxOrder<E &M
where maxOrder is  the order of the expansion sought. In what follows, we let maxOrder = 3 for an expansion of order three.
Clearly, e is  a measure  of the amplitude  of oscillation and can  be set equal to unity in the  final solution if the  amplitude is
taken to be small, as described below. Substituting this expansion into eq31g, expanding the result for small e, and discarding
terms of order higher than e3, we have
eq32a = Heq31g . uExpRule@3D  ExpandAllL . en_;n>3 -> 0
e u1@tD+ e2 a2 u1@tD2 + e3 a3 u1@tD3 + e2 u2@tD +
2 e3 a2 u1@tD u2@tD + e3 u3@tD + e u1
†@tD + e2 u2
†@tD + e3 u3
†@tD == 0
Equating coefficients of like powers of e in eq32a yields
eqEps = TableACoefficientAeq32a@@1DD, eiE == 0, 8i, 3<E
8u1@tD+ u1
†@tD == 0, a2 u1@tD2 + u2@tD + u2
†@tD == 0, a3 u1@tD3 + 2 a2 u1@tD u2@tD + u3@tD + u3
†@tD == 0<
which can be solved sequentially for u1, u2, and u3.
The general solution of the first-order equation, eqEps[[1]], can be expressed as
sol1 = DSolve@8eqEps@@1DD, u1@0D == a Cos@bD, u1¢@0D == -a Sin@bD<, u1@tD, tD@@1DD  Simplify
8u1@tD ﬁa Cos@t + bD<
where a and b  are constants. Substituting sol1, u1@tD, into the second-order equation, eqEps[[2]], and solving  the resulting
equation for u2@tD, we obtain
sol2 = DSolve@eqEps@@2DD . sol1, u2@tD, tD@@1DD . C@_D -> 0  Simplify
9u2@tD ﬁ1
6
a2 H-3 + Cos@2 Ht + bLDL a2=
As before, we do not include the solution of the homogeneous problem for u2@tD.
Substituting sol1 and sol2 into the third-order equation, eqEps[[3]], and solving the resulting equation u3@tD, we have
sol3 = DSolve@eqEps@@3DD . sol1 . sol2, u3@tD, tD@@1DD . C@_D -> 0  Simplify
9u3@tD ﬁ
1

96
a3 H2 H10 Cos@t + bD + Cos@3 Ht + bLD + 20 t Sin@t + bDL a2
2 +
3 H-6 Cos@t + bD + Cos@3 Ht + bLD - 12 t Sin@t + bDL a3L=
Chapter3.nb
47

Simply letting C@_D ﬁ0 did not remove all of the solutions of the homogeneous equation in this  case. Therefore, we clear it
one more time and obtain
sol3 = sol3 . Cos@t + _D -> 0  ExpandAll
9u3@tD ﬁ
1

48
a3 Cos@3 t + 3 bD a2
2 +
5

12
a3 t Sin@t + bD a2
2 +
1

32
a3 Cos@3 t + 3 bD a3 - 3
8
a3 t Sin@t + bD a3=
Combining the first-, second-, and third-order solutions, we obtain, to the third approximation, that
sol = u@tD == Hu@tD . uExpRule@3D . Flatten@8sol1, sol2, sol3<DL
u@tD == a e Cos@t + bD + 1
6
a2 e2 H-3 + Cos@2 Ht + bLDL a2 +
e3 i
k
jj 1

48
a3 Cos@3 t + 3 bD a2
2 +
5

12
a3 t Sin@t + bD a2
2 +
1

32
a3 Cos@3 t + 3 bD a3 - 3
8
a3 t Sin@t +bD a3y
{
zz
We  note that  the dependence  of u  on e and a  is  in  the combination  ea. Thus, one  can set  e = 1 and consider a as  the
perturbation parameter.
The straightforward  expansion sol breaks  down  for t ‡ OHe-1 a-1L because the third-order term is  the same order or larger
than  the  second-order term owing to  the  presence of the mixed-secular term.  Next, we  use the  Lindstedt-Poincaré  tech-
nique to determine a third-order uniform solution.
à 3.3 The Lindstedt-Poincaré Technique
To apply the Lindstedt-Poincaré technique to eq31g, we introduce the transformation t = w t and rewrite it as
eq33a = eq31g . u -> Hu@w #D &L . t -> t  w
u@tD + a2 u@tD2 + a3 u@tD3 + w2 u†@tD == 0
To determine a uniform expansion of order maxOrder of the solution of eq33a, we expand both w and u@tD in powers of e as
omgRule@maxOrder_D := w -> 1 + SumAei wi, 8i, maxOrder<E
uExpRule@maxOrder_D := u -> ISumAei ui@#D, 8i, maxOrder + 1<E &M
As discussed in the preceding chapter, the first term in the expansion of w is taken to be the linear natural frequency of the
system,  which  is  unity in this  case. We note that  the order of the expansion for u  is  larger than  that of w and the  uniform
expansion  required. As discussed  below, we  eliminate the terms  that lead to  secular terms  from the equation  at order max-
Order+1 but do not include in the solution of the resulting equation in the expansion.
For a uniform second order expansion, we let
maxOrder = 2;
48
Chapter3.nb

Substituting the expansions of u and w into eq33a, expanding the result  for small e, and discarding terms  of order higher
than e3, we obtain
eq33b = Heq33a . 8uExpRule@maxOrderD, omgRule@maxOrderD<  ExpandAllL . en_;n>maxOrder+1 -> 0
e u1@tD+ e2 a2 u1@tD2 + e3 a3 u1@tD3 + e2 u2@tD + 2 e3 a2 u1@tD u2@tD + e3 u3@tD + e u1
†@tD +
2 e2 w1 u1
†@tD + e3 w1
2 u1
†@tD + 2 e3 w2 u1
†@tD + e2 u2
†@tD + 2 e3 w1 u2
†@tD + e3 u3
†@tD == 0
eqEps = TableACoefficientAeq33b@@1DD, eiE == 0, 8i, 3<E
8u1@tD+ u1
†@tD == 0, a2 u1@tD2 + u2@tD + 2 w1 u1
†@tD + u2
†@tD == 0,
a3 u1@tD3 + 2 a2 u1@tD u2@tD + u3@tD + w1
2 u1
†@tD + 2 w2 u1
†@tD + 2 w1 u2
†@tD + u3
†@tD == 0<
The general solution of the first-order equation, eqEps[[1]], can be expressed as
sol1 = DSolve@8eqEps@@1DD, u1@0D == a Cos@bD, u1¢@0D == -a Sin@bD<, u1, tD@@1DD
8u1 ﬁHa Cos@bD Cos@#1D - a Sin@bD Sin@#1D &L<
where a and b are constants. Instead of using u1@tD, we use u1 in the second argument to DSolve so that sol1 can be used in
the terms involved with derivatives.
Substituting  sol1, u1@tD, into  the second-order equation, eqEps[[2]], moving  the nonhomogeneous  terms  to the  right-hand
side of the resulting equation, we obtain
eq33c = u2@tD + u2
†@tD - # &  Reverse@eqEps@@2DD . sol1  SimplifyD
u2@tD+ u2
†@tD == -a2 Cos@b + tD2 a2 + 2 a Cos@b + tD w1
Expanding the right-hand side of eq33c in a Fourier series using trigonometric identities yields
eq33c@@2DD = eq33c@@2DD  TrigReduce
1
2
H-a2 a2 - a2 Cos@2 b + 2 tD a2 + 4 a Cos@b + tD w1L
Eliminating  the  terms,  Cos@b +tD  and  Sin@b + tD,  demands  that  w1 = 0.  Then,  the  particular  solution  of  eq33c  can  be
expressed as
sol2 = DSolve@eq33c . w1 -> 0, u2@tD, tD@@1DD . C@_D -> 0  Simplify
9u2@tD ﬁ1
6
a2 H-3 + Cos@2 Hb + tLDL a2=
or in a pure function format as
sol21 = u2 -> Function@t, sol2@@1, 2DD  EvaluateD
u2 ﬁFunctionAt, 1
6
a2 H-3 + Cos@2 Hb + tLDL a2E
Substituting sol1 and sol21 into the third-order equation, eqEps[[3]], and using the fact that w1 = 0, we obtain
Chapter3.nb
49

eq33d = u3@tD + u3
†@tD - # &  Reverse@eqEps@@3DD . w1 -> 0 . sol1 . sol21  SimplifyD
u3@tD+ u3
†@tD == - 1
3
a3 Cos@b + tD H-3 + Cos@2 Hb + tLDL a2
2 - a3 Cos@b + tD3 a3 + 2 a Cos@b + tD w2
Expanding the right-hand side of eq33d in a Fourier series using trigonometric identities, we have
eq33d@@2DD = eq33d@@2DD  TrigReduce
1

12
H10 a3 Cos@b + tD a2
2 - 2 a3 Cos@3 b + 3 tD a2
2 -
9 a3 Cos@b + tD a3 - 3 a3 Cos@3 b + 3 tD a3 + 24 a Cos@b + tD w2L
Eliminating the terms that lead to secular terms from eq33d[[2]] demands that
omg2Rule = Solve@Coefficient@eq33d@@2DD, Cos@t + bDD == 0, w2D@@1DD  ExpandAll
:w2 ﬁ- 5

12
a2 a2
2 + 3 a2 a3

8
>
As  discussed  above,  for a  second-order uniform expansion, we  do  not  need  to  solve  for u3@tD. Combining the  first- and
second-order solutions, we obtain, to the second approximation, that
u@tD == Hu@tD . uExpRule@2D . sol1 . sol21  Simplify  ExpandL
u@tD == a e Cos@b + tD - 1
2
a2 e2 a2 + 1
6
a2 e2 Cos@2 Hb + tLD a2 + e3 u3@tD
where
t == w t . omgRule@2D . omg2Rule . w1 -> 0
t == t i
k
jjj1 + e2 i
k
jjj- 5

12
a2 a2
2 + 3 a2 a3

8
y
{
zzzy
{
zzz
The above expansion is  uniform to second order because secular terms  do not appear in it and the correction term (the term
proportional to e2) is small compared with the first term.
Returning to sol in the  previous section, we note that the first secular term appears  at O(e3). Consequently, we could  have
concluded that w1 = 0 before carrying out the expansion because the term ew1 in omgRule[2] creates  secular terms  at OHe2L
and not at OHe3L, as needed to eliminate the secular term from sol.
à 3.4 The Method of Multiple Scales
We  use the  method  of multiple  scales  to  attack directly  eq31g  in  Section  3.4.1, the  corresponding  first-order real-valued
equations of eq31g in Section 3.4.2, and the corresponding first-order complex-valued equation of eq31g in Section 3.4.3. To
obtain  a  second-order  uniform  expansion  by  using  the  method  of  multiple  scales,  we  need  the  three  time  scales
T0 = t, T1 = et, and T2 = e2 t, which we symbolize by
Needs@"Utilities`Notation`"D
50
Chapter3.nb

Symbolize@T0D; Symbolize@T1D; Symbolize@T2D;
and list as
timeScales = 8T0, T1, T2<;
In terms of the time scales Tn, the time derivatives become
dt@1D@expr_D := SumAei D@expr, timeScales@@i + 1DDD, 8i, 0, maxOrder<E;
dt@2D@expr_D := Hdt@1D@dt@1D@exprDD  ExpandL . ei_;i>maxOrder -> 0;
For a uniform second-order expansion, we let
maxOrder = 2;
To represent some of the expressions in a more concise way, we introduce the following display rule:
displayRule =
9Derivative@a__DAu_i_E@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD-1
#1
&, 8a<E, uiE,
Derivative@a__D@AD@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD
#1
&, 8a<E, AE,
Derivative@a__D@AD@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD
#1
&, 8a<E, AE,
u_i_@__D -> ui, A@__D -> A, A@__D -> A=;
 3.4.1 Second-Order Real-Valued System
Using the derivative rule, we transform eq31g into the partial-differential equation
eq341a = eq31g . 8u@tD -> u@T0, T1, T2D, Derivative@n_D@uD@tD -> dt@nD@u@T0, T1, T2DD<
u@T0, T1, T2D + a2 u@T0, T1, T2D2 + a3 u@T0, T1, T2D3 + e2 uH0,2,0L@T0, T1, T2D +
2 e2 uH1,0,1L@T0, T1, T2D + 2 e uH1,1,0L@T0, T1, T2D + uH2,0,0L@T0, T1, T2D == 0
Again, to determine a uniform expansion of order maxOrder, we expand u to order maxOrder+1, eliminate the secular terms
from the maxOrder+1 equation, but do not include its solution in the final approximate solution. Hence, we seek a uniform
expansion of the solution of eq341a in the form
solRule = u -> ISumAei ui@#1, #2, #3D, 8i, maxOrder + 1<E &M;
Substituting this  expansion into eq341a, expanding the result  for small e, and discarding terms  of order higher than e3, we
have
eq341b = Heq341a . solRule  ExpandAllL . en_;n>maxOrder+1 -> 0
e u1@T0, T1, T2D + e2 a2 u1@T0, T1, T2D2 + e3 a3 u1@T0, T1, T2D3 + e2 u2@T0, T1, T2D +
2 e3 a2 u1@T0, T1, T2D u2@T0, T1, T2D + e3 u3@T0, T1, T2D + e3 u1
H0,2,0L@T0, T1, T2D +
2 e3 u1
H1,0,1L@T0, T1, T2D + 2 e2 u1
H1,1,0L@T0, T1, T2D + 2 e3 u2
H1,1,0L@T0, T1, T2D +
e u1
H2,0,0L@T0, T1, T2D + e2 u2
H2,0,0L@T0, T1, T2D + e3 u3
H2,0,0L@T0, T1, T2D == 0
Chapter3.nb
51

Equating coefficients of like powers of e in eq341b, we obtain
eqEps = CoefficientList@eq341b@@1DD, eD == 0  Thread  Rest
9u1@T0, T1, T2D + u1
H2,0,0L@T0, T1, T2D == 0,
a2 u1@T0, T1, T2D2 + u2@T0, T1, T2D + 2 u1
H1,1,0L@T0, T1, T2D + u2
H2,0,0L@T0, T1, T2D == 0,
a3 u1@T0, T1, T2D3 + 2 a2 u1@T0, T1, T2D u2@T0, T1, T2D + u3@T0, T1, T2D + u1
H0,2,0L@T0, T1, T2D +
2 u1
H1,0,1L@T0, T1, T2D + 2 u2
H1,1,0L@T0, T1, T2D + u3
H2,0,0L@T0, T1, T2D == 0=
To place the linear operator on one side and the rest of the terms on the other, we define
eqOrder@i_D := HeqEps@@1, 1DD . u1 -> uiL - # &  eqEps@@iDD  Reverse
Using eqOrder[i] and displayRule, we rewrite eqEps in a concise way as
Array@eqOrder, 3D . displayRule  TableForm
D0
2u1 + u1 == 0
D0
2u2 + u2 == -2 HD0 D1u1L - u1
2 a2
D02u3 + u3 == -2 HD0 D1u2L - D12u1 - 2 HD0 D2u1L - 2 u1 u2 a2 - u13 a3
where Dn ui = ¶ui@T0, T1, T2D¶Tn .
The general solution of the first-order equation, eqOrder[1], can be expressed as
sol1 = 9u1 -> IA@#2, #3D Exp@I #1D + A@#2, #3D Exp@-I #1D &M=;
where A is the complex conjugate of A defined by the conjugate rule
conjugateRule = 9A -> A, A -> A, Complex@0, n_D -> Complex@0, -nD=;
Then, the second-order equation, eqOrder[2], becomes
eq341c = eqOrder@2D . sol1  ExpandAll;
eq341c . displayRule
D0
2u2 + u2 == -2 I EI T0 HD1AL + 2 I E-I T0 HD1AL - A2 E2 I T0 a2 - 2 A A a2 - E-2 I T0 A2 a2
Eliminating the term EI T0 that produces secular terms in u2 from the right-hand side of eq341c demands that
SCond1 = Coefficient@eq341c@@2DD, Exp@I T0DD == 0
-2 I AH1,0L@T1, T2D == 0
or
52
Chapter3.nb

SCond1Rule = SolveASCond1, AH1,0L@T1, T2DE@@1DD
H* either copy and paste AH1,0L@T1,T2D from SCond1 or
use Derivative@1,0D@AD@T1,T2D as the second argument to Solve *L
8AH1,0L@T1, T2D ﬁ0<
Eliminating the term E-I T0 that produces secular terms  in u2 from the right-hand side of eq341c yields the complex conjugate
of SCond1Rule; that is,
ccSCond1Rule = SCond1Rule . conjugateRule
:AH1,0L@T1, T2D ﬁ0>
It follows from SCond1 that A = A@T2D. Substituting the solvability conditions into eq341c, we have
eq341d = eq341c . SCond1Rule . ccSCond1Rule
u2@T0, T1, T2D + u2
H2,0,0L@T0, T1, T2D ==
-E2 I T0 A@T1, T2D2 a2 - 2 A@T1, T2D a2 A@T1, T2D - E-2 I T0 a2 A@T1, T2D
2
The particular solution of eq341d can be obtained by using DSolve; the result is
u2Sol =
DSolve@eq341d, u2@T0, T1, T2D, timeScalesD@@1DD . C@_D -> H0 &L  TrigToExp  ExpandAll
9u2@T0, T1, T2D ﬁ1
3
E2 I T0 A@T1, T2D2 a2 - 2 A@T1, T2D a2 A@T1, T2D + 1
3
E-2 I T0 a2 A@T1, T2D
2=
whose right-hand side can be used directly to express u2 in a pure function form as
sol2 = 8u2 -> Function@8T0, T1, T2<, u2Sol@@1, 2DD  EvaluateD<
9u2 ﬁ
FunctionA8T0, T1, T2<, 1
3
E2 I T0 A@T1, T2D2 a2 - 2 A@T1, T2D a2 A@T1, T2D + 1
3
E-2 I T0 a2 A@T1, T2D
2E=
Substituting the first- and second-order solutions, sol1 and sol2, into the third-order equation, eqOrder[3], we obtain
eq341e = eqOrder@3D . sol1 . sol2  ExpandAll;
eq341e . displayRule
D0
2u3 + u3 == -EI T0 HD1
2AL - E-I T0 HD1
2AL - 2 I EI T0 HD2AL + 2 I E-I T0 HD2AL -
8
3
I A E2 I T0 HD1AL a2 + 8
3
I E-2I T0 A HD1AL a2 - 2
3
A3 E3I T0 a2
2 + 10

3
A2 EI T0 A a2
2 +
10

3
A E-I T0 A2 a2
2 - 2
3
E-3 I T0 A3 a2
2 - A3 E3 I T0 a3 - 3 A2 EI T0 A a3 - 3 A E-I T0 A2 a3 - E-3 I T0 A3 a3
Eliminating the terms that produce secular terms in u3 from the right-hand side of eq341e demands that
Chapter3.nb
53

SCond2 = Coefficient@eq341e@@2DD, Exp@I T0DD == 0
10

3
A@T1, T2D2 a2
2 A@T1, T2D - 3 A@T1, T2D2 a3 A@T1, T2D - 2 I AH0,1L@T1, T2D - AH2,0L@T1, T2D == 0
Using SCond1Rule and the fact that A = A@T2D, we can rewrite SCond2 as
SCond = SCond2 . D@SCond1Rule, T1D . 9A -> HA@#2D &L, A -> IA@#2D &M=
10

3
A@T2D2 a2
2 A@T2D - 3 A@T2D2 a3 A@T2D - 2 I A¢@T2D == 0
Expressing A in the polar form
ruleA = 9A -> i
k
jj 1
2
 a@#D Exp@I b@#DD &y
{
zz, A -> i
k
jj 1
2
 a@#D Exp@-I b@#DD &y
{
zz=;
where a and b are real and using the rule
realRule = 8Re@s_D -> s, Im@s_D -> 0<;
we write SCond as
eq341f = SCond@@1DD Exp@-I b@T2DD . ruleA  Expand
5

12
a@T2D3 a2
2 - 3
8
a@T2D3 a3 - I a¢@T2D + a@T2D b¢@T2D
Separating the real and imaginary parts in eq341f, we obtain the modulation equations
ampEq = Im@eq341fD == 0 . realRule
-a¢@T2D == 0
phaseEq = Re@eq341fD == 0 . realRule
5

12
a@T2D3 a2
2 - 3
8
a@T2D3 a3 + a@T2D b¢@T2D == 0
The solution of ampEq is a = a0 = const. Then, if a0 „ 0, the solution of phaseEq is
betaRule = DSolve@phaseEq . a@T2D -> a0, b@T2D, T2D@@1DD . C@1D -> b0  ExpandAll
9b@T2D ﬁ- 5

12
T2 a0
2 a2
2 + 3
8
T2 a0
2 a3 + b0=
where b0 is  a constant. Substituting ruleA into sol1 and sol2 and recalling that T0 = t and T2 = e2 t, we obtain, to the second
approximation, that
54
Chapter3.nb

u@tD == IIu@T0, T1, T2D . solRule . sol1 . sol2 . e3 -> 0 . 9A@__D -> A@T2D, A@__D -> A@T2D= .
ruleA  ExpToTrigM . 8a@T2D -> a0< . betaRule .
9T0 -> t, T2 -> e2 t= . Cos@arg_D :> Cos@Collect@arg, tDDM
u@tD == e CosAt i
k
jj1 - 5

12
e2 a0
2 a2
2 + 3
8
e2 a0
2 a3y
{
zz + b0E a0 -
1
2
e2 a0
2 a2 + 1
6
e2 CosAt i
k
jj2 - 5
6
e2 a0
2 a2
2 + 3
4
e2 a0
2 a3y
{
zz + 2 b0E a0
2 a2
which is in full agreement with that obtained by using the Lindstedt-Poincaré technique.
 3.4.2 First-Order Real-Valued System
In  this  section, we  first transform  eq31g  into  a  system of two  real-valued  first-order  equations  using  the  transformation
v@tD = u¢@tD and obtain
eq342a = 8u¢@tD == v@tD, eq31g . u†@tD -> v¢@tD<
8u¢@tD == v@tD, u@tD + a2 u@tD2 + a3 u@tD3 + v¢@tD == 0<
To  determine  a  second-order uniform  expansion  of the  solution  of eq342a  using  the  method  of multiple  scales, we  first
introduce
multiScales = 8u@tD -> u@T0, T1, T2D, v@tD -> v@T0, T1, T2D,
u¢@tD -> dt@1D@u@T0, T1, T2DD, v¢@tD -> dt@1D@v@T0, T1, T2DD<;
to transform the derivative with respect to t in terms of the derivatives with respect to the three time scales T0, T1, and T2 and
then expand u and v in the form
solRule = 9u -> ISumAej uj@#1, #2, #3D, 8j, 3<E &M, v -> ISumAej vj@#1, #2, #3D, 8j, 3<E &M=;
Substituting multiScales and solRule into eq342a, expanding the result for small e, and discarding terms of order higher than
e3, we obtain
eq342b = Heq342a . multiScales . solRule  ExpandAllL . en_;n>3 -> 0;
Equating coefficients of like powers of e in eq342b yields
eqEps = Thread@CoefficientList@Subtract  #, eD == 0D &  eq342b  Transpose  Rest;
To place the linear operator on one side and the rest of the terms on the other, we define
eqOrder@i_D := H#@@1DD &  eqEps@@1DD . u_1 -> uiL ==
H#@@1DD &  eqEps@@1DD . u_1 -> uiL - H#@@1DD &  eqEps@@iDDL  Thread
Using eqOrder[i] and displayRule, we rewrite eqEps in a concise way as
Chapter3.nb
55

eqOrder@1D . displayRule  TableForm
eqOrder@2D . displayRule  TableForm
eqOrder@3D . displayRule  TableForm
D0u1 - v1 == 0
D0v1 + u1 == 0
D0u2 - v2 == -HD1u1L
D0v2 + u2 == -HD1v1L - u1
2 a2
D0u3 - v3 == -HD1u2L - D2u1
D0v3 + u3 == -HD1v2L - D2v1 - 2 u1 u2 a2 - u1
3 a3
 First-Order Equations: Linear System
To determine the solution of the first-order equations, eqOrder[1], we list their left-hand sides and obtain
linearSys = #@@1DD &  eqOrder@1D
9-v1@T0, T1, T2D + u1
H1,0,0L@T0, T1, T2D, u1@T0, T1, T2D + v1
H1,0,0L@T0, T1, T2D=
Next, we seek a solution of linearSys in the form u1 = P EI T0  and v1 = QEI T0 and obtain
coefList = E-I T0 linearSys . 9u1 -> IP EI # &M, v1 -> IQ EI # &M=  Expand
8I P - Q, P + I Q<
The coefficient matrix of coefList is
coefMat = Outer@Coefficient, coefList, 8P, Q<D
88I, -1<, 81, I<<
and its adjoint is defined by
hermitian@mat_? MatrixQD := mat . conjugateRule  Transpose
Hence, the right and left eigenvectors of coefMat are
rightVec = 81, c1< . Solve@HcoefMat.81, c1<L@@1DD == 0, c1D@@1DD
81, I<
leftVec = 81, c1< . Solve@Hhermitian@coefMatD.81, c1<L@@1DD == 0, c1D@@1DD
81, I<
Then the solution of the first-order equations can be expressed as
56
Chapter3.nb

sol1Form = rightVec A@T1, T2D EI T0
8EI T0 A@T1, T2D, I EI T0 A@T1, T2D<
and hence u1 and v1 can be expressed in a pure function form as
order1Sol =
8u1 -> Function@8T0, T1, T2<, sol1Form@@1DD + Hsol1Form@@1DD . conjugateRuleL  EvaluateD,
v1 -> Function@8T0, T1, T2<, sol1Form@@2DD + Hsol1Form@@2DD . conjugateRuleL  EvaluateD<
8u1 ﬁFunction@8T0, T1, T2<, EIT0 A@T1, T2D + E-I T0 A@T1, T2DD,
v1 ﬁFunction@8T0, T1, T2<, I EI T0 A@T1, T2D - I E-I T0 A@T1, T2DD<
 Second-Order Equations
Substituting the first-order solution, order1Sol, into the second-order equations, eqOrder[2], we have
order2Eq = eqOrder@2D . order1Sol  ExpandAll;
order2Eq . displayRule
:D0u2 - v2 == -EI T0 HD1AL - E-I T0 HD1AL,
D0v2 + u2 == -I EI T0 HD1AL + I E-I T0 HD1AL - A2 E2 I T0 a2 - 2 A A a2 - E-2 I T0 A2 a2>
To eliminate the terms that produce secular terms  in u2 and v2, we determine the vector proportional to EI T0 in the right-hand
sides of order2Eq and obtain
STerms1 = Coefficient@#@@2DD, Exp@I T0DD &  order2Eq
8-AH1,0L@T1, T2D, -I AH1,0L@T1, T2D<
Then, the condition for the elimination of the terms that produce secular terms, solvability condition, demands that STerms1
be orthogonal to the adjoint, left eigenvector. The result is
SCond1 = SolveAConjugate@leftVecD.STerms1 == 0, AH1,0L@T1, T2DE@@1DD
8AH1,0L@T1, T2D ﬁ0<
whose complex conjugate is
ccSCond1 = SCond1 . conjugateRule
:AH1,0L@T1, T2D ﬁ0>
With this solvability condition, order2Eq becomes
Chapter3.nb
57

order2Eqm = order2Eq . SCond1 . ccSCond1;
order2Eqm . displayRule
:D0u2 - v2 == 0, D0v2 + u2 == -A2 E2 I T0 a2 - 2 A A a2 - E-2 IT0 A2 a2>
whose particular solution can be expressed as
DSolve@order2Eqm, 8u2@T0, T1, T2D, v2@T0, T1, T2D<, timeScalesD
DSolve::pde :  Partial differential equation may not have
a general solution. Try loading Calculus`DSolveIntegrals` to find special solutions.
DSolveB:-v2@T0, T1, T2D + u2
H1,0,0L@T0, T1, T2D == 0, u2@T0, T1, T2D + v2
H1,0,0L@T0, T1, T2D ==
-E2 I T0 A@T1, T2D2 a2 - 2 A@T1, T2D a2 A@T1, T2D - E-2 I T0 a2 A@T1, T2D
2>,
8u2@T0, T1, T2D, v2@T0, T1, T2D<, 8T0, T1, T2<F
Here, directly applying DSolve to solve for order2Eqm does not work. Since the differential operators  on the left-hand sides
of order2Eqm are essentially ordinary-differential operators in terms of T0, we can first transform order2Eqm into an ordinary-
differential-equation form and then use DSolve to obtain the particular solution as
sol2pForm =
DSolve@order2Eqm . 8u2 -> Hu2@#1D &L, v2 -> Hv2@#1D &L<, 8u2@T0D, v2@T0D<, T0D@@1DD .
C@_D -> 0  TrigToExp  ExpandAll
9u2@T0D ﬁ1
3
E2 I T0 A@T1, T2D2 a2 - 2 A@T1, T2D a2 A@T1, T2D + 1
3
E-2 I T0 a2 A@T1, T2D
2,
v2@T0D ﬁ2
3
I E2 I T0 A@T1, T2D2 a2 - 2
3
I E-2 I T0 a2 A@T1, T2D
2=
We can then express the solution of the second-order equations in a pure function form as
order2Sol = 8u2 -> Function@8T0, T1, T2<, sol2pForm@@1, 2DD  EvaluateD,
v2 -> Function@8T0, T1, T2<, sol2pForm@@2, 2DD  EvaluateD<
9u2 ﬁ
FunctionA8T0, T1, T2<, 1
3
E2 I T0 A@T1, T2D2 a2 - 2 A@T1, T2D a2 A@T1, T2D + 1
3
E-2 I T0 a2 A@T1, T2D
2E,
v2 ﬁFunctionA8T0, T1, T2<, 2
3
I E2 IT0 A@T1, T2D2 a2 - 2
3
I E-2 I T0 a2 A@T1, T2D
2E=
 Third-Order Equations
Substituting the first- and second-order solutions into the third-order equations, eqOrder[3], yields
58
Chapter3.nb

order3Eq = eqOrder@3D . order1Sol . order2Sol  ExpandAll;
order3Eq . displayRule
9D0u3 - v3 ==
-EI T0 HD2AL - E-I T0 HD2AL - 2
3
A E2 I T0 HD1AL a2 + 2 A HD1AL a2 + 2 A HD1AL a2 - 2
3
E-2 I T0 A HD1AL a2,
D0v3 + u3 == -I EI T0 HD2AL + I E-I T0 HD2AL - 4
3
I A E2 I T0 HD1AL a2 +
4
3
I E-2 I T0 A HD1AL a2 - 2
3
A3 E3 I T0 a2
2 + 10

3
A2 EI T0 A a2
2 + 10

3
A E-I T0 A2 a2
2 -
2
3
E-3 I T0 A3 a2
2 - A3 E3 I T0 a3 - 3 A2 EIT0 A a3 - 3 A E-I T0 A2 a3 - E-3 I T0 A3 a3=
To eliminate the  terms  that lead to secular terms  from order3Eq, we calculate the  vector proportional to EI T0  in their right-
hand sides and obtain
STerms2 = Coefficient@#@@2DD, Exp@I T0DD &  order3Eq
9-AH0,1L@T1, T2D, 10

3
A@T1, T2D2 a2
2 A@T1, T2D - 3 A@T1, T2D2 a3 A@T1, T2D - I AH0,1L@T1, T2D=
Hence, the solvability condition at this order is
SCond2 = Conjugate@leftVecD.STerms2 == 0  ExpandAll
- 10

3
I A@T1, T2D2 a2
2 A@T1, T2D + 3 I A@T1, T2D2 a3 A@T1, T2D - 2 AH0,1L@T1, T2D == 0
This solvability condition is the same as that obtained by attacking the second-order form of the governing equation.
 3.4.3 First-Order Complex-Valued System
In this section, we first transform eq31g into a single first-order complex-valued equation using the transformation
transfRule = 9u@tD -> z@tD + z@tD, u¢@tD -> I Iz@tD - z@tDM=;
whose inverse is given by
zetaRule = SolveAtransfRule . Rule -> Equal, 9z@tD, z@tD=E@@1DD
9z@tD ﬁ1
2
Hu@tD - I u¢@tDL, z@tD ﬁ1
2
Hu@tD + I u¢@tDL=
where z
_
 is the complex conjugate of z as defined by the complex conjugate rule
conjugateRule = 9A -> A, A -> A, z -> z, z -> z, Complex@0, n_D -> Complex@0, -nD=;
It follows from eq31g that the acceleration is given by
Chapter3.nb
59

acceleration = Solve@eq31g, u†@tDD@@1DD
8u†@tD ﬁ-u@tD - a2 u@tD2 - a3 u@tD3<
Differentiating  zetaRule[[1]]  once  with respect  to  t  and  using  acceleration and  transfRule, we  obtain  the  following first-
order complex-valued equation:
eq343a = D@zetaRule@@1DD, tD . acceleration . transfRule . Rule -> Equal  ExpandAll
z¢@tD == I z@tD + 1
2
I a2 z@tD2 + 1
2
I a3 z@tD3 + I a2 z@tD z@tD +
3
2
I a3 z@tD2 z@tD + 1
2
I a2 z@tD2 + 3
2
I a3 z@tD z@tD2 + 1
2
I a3 z@tD3
To  determine  a  second-order uniform  expansion  of the  solution  of eq343a  using  the  method  of multiple  scales, we  first
introduce
multiScales = 9z@tD -> z@T0, T1, T2D, z@tD -> z@T0, T1, T2D, z¢@tD -> dt@1D@z@T0, T1, T2DD=;
and then expand z and z in the form
solRule = 9z -> ISumAej zj@#1, #2, #3D, 8j, 3<E &M, z -> ISumAej z
j@#1, #2, #3D, 8j, 3<E &M=;
Substituting multiScales and solRule into eq343a, expanding the result of small e, and discarding terms of order higher than
e3, we obtain
eq343b = Heq343a . multiScales . solRule  ExpandAllL . en_;n>3 -> 0;
Equating coefficients of like powers of e yields
eqEps = CoefficientList@Subtract  eq343b, eD == 0  Thread  Rest;
To place the linear operator on one side and the rest of the terms on the other, we define
eqOrder@i_D := HeqEps@@1, 1DD . z1 -> ziL - # &  eqEps@@iDD  Reverse
Using eqOrder[i] and displayRule, we rewrite eqEps in a concise way as
Array@eqOrder, 3D . displayRule  TableForm
D0z1 - I z1 == 0
D0z2 - I z2 == -HD1z1L + 12 I a2 z12 + I a2 z1 z
1 + 12 I a2 z
1
2
D0z3 - I z3 == -HD1z2L - D2z1 + 12 I a3 z1
3 + I a2 z1 z2 + 32 I a3 z1
2 z
1 + I a2 z2 z
1 + 32 I a3 z1 z
1
2 + 12 I a3 z
1
3 + I a
The general solution of the first-order equation, eqOrder[1], can be expressed in a pure function form as
sol1 = DSolve@eqOrder@1D, z1, timeScalesD@@1DD . C@1D -> A
8z1 ﬁHEI #1 A@#2, #3D &L<
60
Chapter3.nb

whose complex conjugate is
ccsol1 = sol1 . conjugateRule
8z
1 ﬁHEComplex@0,-1D #1 A@#2, #3D &L<
Substituting the first-order solution into the second-order equation, eqOrder[2], we have
order2Eq = eqOrder@2D . sol1 . ccsol1;
order2Eq . displayRule
D0z2 - I z2 == -EI T0 HD1AL + 1
2
I A2 E2 IT0 a2 + I A A a2 + 1
2
I E-2 I T0 A2 a2
Eliminating the terms that lead to seculr terms in z2 from order2Eq yields
SCond1 = CoefficientAorder2Eq@@2DD, EIT0 E == 0
-AH1,0L@T1, T2D == 0
or
SCond1Rule = SolveASCond1, AH1,0L@T1, T2DE@@1DD
8AH1,0L@T1, T2D ﬁ0<
With this solvability condition, the particular solution of order2Eq can be expressed in a pure function form as
sol2 = DSolve@order2Eq . SCond1Rule, z2, timeScalesD@@1DD . C@_D -> H0 &L
9z2 ﬁi
k
jjEI #1 H0 &L@#2, #3D +
1
6
E-2 I #1 a2 J3 E4 I #1 A@#2, #3D2 - 6 E2 I #1 A@#2, #3D A@#2, #3D - A@#2, #3D
2N &y
{
zz=
whose complex conjugate is
ccsol2 = sol2 . conjugateRule;
Substituting the first- and second-order solutions in the third-order equation, eqOrder[3], we obtain
order3Eq = eqOrder@3D . sol1 . ccsol1 . sol2 . ccsol2  ExpandAll;
order3Eq . displayRule
D0z3 - I z3 == -EI T0 HD2AL - A E2 I T0 HD1AL a2 + A HD1AL a2 + A HD1AL a2 +
1
3
E-2 I T0 A HD1AL a2 + 1
3
I A3 E3 I T0 a2
2 - 5
3
I A2 EI T0 A a2
2 - 5
3
I A E-I T0 A2 a2
2 +
1
3
I E-3 I T0 A3 a2
2 + 1
2
I A3 E3 I T0 a3 + 3
2
I A2 EI T0 A a3 + 3
2
I A E-I T0 A2 a3 + 1
2
I E-3 I T0 A3 a3
Eliminating the terms that produce secular terms in z3 from order3Eq demands the following condition
Chapter3.nb
61

SCond2 = CoefficientAorder3Eq@@2DD, EIT0 E == 0;
SCond2 . displayRule
-HD2AL - 5
3
I A2 A a2
2 + 3
2
I A2 A a3 == 0
which is in full agreement with that obtained by attacking directly eq31g.
à 3.5 The Method of Averaging
As before, we use the method of variation of parameters to transform the dependent variable u into a and b according to
eq35a = u@tD == e a Cos@t + bD;
subject to the constraint
eq35b = D@eq35a, tD
u¢@tD == -a e Sin@t + bD
where a and b are functions of t
tdependentRule = 8a -> a@tD, b -> b@tD<;
and e is  a small dimensionless parameter that is  a measure of the amplitude of oscillation. Differentiating eq35a with respect
to t yields
eq35c = D@eq35a . tdependentRule, tD
u¢@tD == e Cos@t + b@tDD a¢@tD - e a@tD Sin@t + b@tDD H1 + b¢@tDL
Comparing eq35b and eq35c, we conclude that
cond35a = Expand@eq35c@@2DD - Heq35b@@2DD . tdependentRuleLD == 0
e Cos@t + b@tDD a¢@tD - e a@tD Sin@t + b@tDD b¢@tD == 0
Differentiating eq35b once with respect to t yields
eq35d = D@eq35b . tdependentRule, tD
u†@tD == -e Sin@t + b@tDD a¢@tD - e a@tD Cos@t + b@tDD H1 + b¢@tDL
Substituting eq35a and eq35d into eq31g, we have
cond35b = eq31g . H8eq35a . tdependentRule, eq35d< . Equal -> RuleL  ExpandAll
e2 a@tD2 Cos@t + b@tDD2 a2 + e3 a@tD3 Cos@t + b@tDD3 a3 -
e Sin@t + b@tDD a¢@tD - e a@tD Cos@t + b@tDD b¢@tD == 0
62
Chapter3.nb

Solving cond35a and cond35b for a¢@tD and b¢@tD, we have
transformedEq = Solve@8cond35a, cond35b<, 8a¢@tD, b¢@tD<D@@1DD . Rule -> Equal  Simplify
8a¢@tD == e a@tD2 Cos@t + b@tDD2 Sin@t + b@tDD Ha2 + e a@tD Cos@t + b@tDD a3L,
b¢@tD == e a@tD Cos@t + b@tDD3 Ha2 + e a@tD Cos@t + b@tDD a3L<
where a is  assumed to be different from zero in arriving at transformedEq[[2]]. Using trigonometric identities, we expand the
right-hand sides of transformedEq in Fourier series and obtain
ampEq1 = TrigReduce  transformedEq@@1DD
a¢@tD == 1
8
H2 e a@tD2 Sin@t + b@tDD a2 + 2 e a@tD2 Sin@3 t + 3 b@tDD a2 +
2 e2 a@tD3 Sin@2 t + 2 b@tDD a3 + e2 a@tD3 Sin@4 t + 4 b@tDD a3L
phaseEq1 = TrigReduce  transformedEq@@2DD
b¢@tD == 1
8
H6 e a@tD Cos@t + b@tDD a2 + 2 e a@tD Cos@3 t + 3 b@tDD a2 +
3 e2 a@tD2 a3 + 4 e2 a@tD2 Cos@2 t + 2 b@tDD a3 + e2 a@tD2 Cos@4 t + 4 b@tDD a3L
Since e is small, a¢@tD and b¢@tD are slowly varying functions of t. Then, according to the method of averaging, we can neglect
the fast-varying terms in ampEq1 and phaseEq1 and obtain the following averaged equations:
ampAvgEq = ampEq1 . Sin@_. t + _D -> 0
a¢@tD == 0
phaseAvgEq = phaseEq1 . Cos@_. t + _D -> 0
b¢@tD == 3
8
e2 a@tD2 a3
Whereas ampAvgEq agrees with ampEq, phaseAvgEq does not agree with phaseEq obtained in the preceding section by using
the method of multiple scales. There is  a term 5
12  e2 a2 a2
2  missing from phaseAvgEq. Following the details  of the solution in
the preceding section, one finds that this  term is  the result  of the interaction of the first- and second-order approximations.
This  interaction was  not taken into account in arriving at ampAvgEq and phaseAvgEq. To include the effect of this  interac-
tion, we need to carry out the solutions of ampEq1 and phaseEq1 to higher order. This is accomplished by using the general-
ized method  of averaging, which  is  discussed next, or its  variant the  Krylov-Bogoliubov-Mitropolsky  technique,  which is
discussed in Section 3.7.
à 3.6 The Generalized Method of Averaging
To apply this method, we introduce the variable f = t + b and rewrite ampEq1 and phaseEq1 as
Chapter3.nb
63

ampEq2 = ampEq1 . Sin@n_. t + a_D :> Sin@Expand@n Hf@tD - b@tDL + aDD
a¢@tD == 1
8
H2 e a@tD2 Sin@f@tDD a2 +
2 e a@tD2 Sin@3 f@tDD a2 + 2 e2 a@tD3 Sin@2 f@tDD a3 + e2 a@tD3 Sin@4 f@tDD a3L
phaseEq2 = f¢@tD == 1 + phaseEq1@@2DD . Cos@n_. t + a_D :> Cos@Expand@n Hf@tD - b@tDL + aDD
f¢@tD == 1 + 1
8
H6 e a@tD Cos@f@tDD a2 + 2 e a@tD Cos@3 f@tDD a2 +
3 e2 a@tD2 a3 + 4 e2 a@tD2 Cos@2 f@tDD a3 + e2 a@tD2 Cos@4 f@tDD a3L
We seek approximate solutions to ampEq2 and phaseEq2 in the form
asol = a@tD == a0@tD + SumAei ai@a0@tD, f0@tDD, 8i, 2<E
a@tD == a0@tD + e a1@a0@tD, f0@tDD + e2 a2@a0@tD, f0@tDD
phisol = f@tD == f0@tD + SumAei fi@a0@tD, f0@tDD, 8i, 2<E
f@tD == f0@tD + e f1@a0@tD, f0@tDD + e2 f2@a0@tD, f0@tDD
where a0@tD and f0@tD are expanded in power series in e as
a0Eq = a0¢@tD == SumAei Ai@a0@tDD, 8i, 2<E
a0
¢ @tD == e A1@a0@tDD + e2 A2@a0@tDD
phi0Eq = f0
¢@tD == 1 + SumAei Fi@a0@tDD, 8i, 2<E
f0
¢ @tD == 1 + e F1@a0@tDD + e2 F2@a0@tDD
The functions a1, a2, …, an and f1, f2, …, fn  are fast varying functions of f0, while it follows from a0Eq and phi0Eq that a0,
and hence the An and Fn  are slowly varying functions of t.
To the second approximation, we differentiate a@tD and f@tD once with respect to t, use a0Eq and phi0Eq, expand the result  for
small e, discard terms of order higher than e2, and obtain
aEq1 = HD@asol, tD . H8a0Eq, phi0Eq< . Equal -> RuleL  ExpandAllL . en_;n>2 -> 0
a¢@tD == e A1@a0@tDD + e2 A2@a0@tDD + e a1
H0,1L@a0@tD, f0@tDD +
e2 F1@a0@tDD a1
H0,1L@a0@tD, f0@tDD + e2 a2
H0,1L@a0@tD, f0@tDD + e2 A1@a0@tDD a1
H1,0L@a0@tD, f0@tDD
phiEq1 = HD@phisol, tD . H8a0Eq, phi0Eq< . Equal -> RuleL  ExpandAllL . en_;n>2 -> 0
f¢@tD == 1 + e F1@a0@tDD + e2 F2@a0@tDD + e f1
H0,1L@a0@tD, f0@tDD +
e2 F1@a0@tDD f1
H0,1L@a0@tD, f0@tDD + e2 f2
H0,1L@a0@tD, f0@tDD + e2 A1@a0@tDD f1
H1,0L@a0@tD, f0@tDD
Next, we substitute asol and phisol into ampEq2 and phaseEq2, expand the right-hand sides  for small e keeping terms  up to
OHe2L, and rewrite their right-hand sides as
64
Chapter3.nb

ampEqrhs = Series@ampEq2@@2DD . H8asol, phisol< . Equal -> RuleL, 8e, 0, 2<D  Normal
1
8
e H2 Sin@f0@tDD a2 a0@tD2 + 2 Sin@3 f0@tDD a2 a0@tD2L +
1
8
e2 H2 Sin@2 f0@tDD a3 a0@tD3 + Sin@4 f0@tDD a3 a0@tD3 +
2 a2 H2 Sin@f0@tDD a0@tD a1@a0@tD, f0@tDD + Cos@f0@tDD a0@tD2 f1@a0@tD, f0@tDDL +
2 a2 H2 Sin@3 f0@tDD a0@tD a1@a0@tD, f0@tDD + 3 Cos@3 f0@tDD a0@tD2 f1@a0@tD, f0@tDDLL
phaseEqrhs = Series@phaseEq2@@2DD . H8asol, phisol< . Equal -> RuleL, 8e, 0, 2<D  Normal
1 + 1
8
e H6 Cos@f0@tDD a2 a0@tD + 2 Cos@3 f0@tDD a2 a0@tDL +
1
8
e2 H3 a3 a0@tD2 + 4 Cos@2 f0@tDD a3 a0@tD2 + Cos@4 f0@tDD a3 a0@tD2 +
6 a2 HCos@f0@tDD a1@a0@tD, f0@tDD - Sin@f0@tDD a0@tD f1@a0@tD, f0@tDDL +
2 a2 HCos@3 f0@tDD a1@a0@tD, f0@tDD - 3 Sin@3 f0@tDD a0@tD f1@a0@tD, f0@tDDLL
Equating coefficients of like powers of e from aEq1, ampEqrhs, phiEq1, and phaseEqrhs, we obtain
ampEq3 = CoefficientList@#, eD &  HaEq1@@2DD == ampEqrhsL  Thread  Rest
9A1@a0@tDD + a1
H0,1L@a0@tD, f0@tDD == 1
8
H2 Sin@f0@tDD a2 a0@tD2 + 2 Sin@3 f0@tDD a2 a0@tD2L,
A2@a0@tDD + F1@a0@tDD a1
H0,1L@a0@tD, f0@tDD + a2
H0,1L@a0@tD, f0@tDD +
A1@a0@tDD a1
H1,0L@a0@tD, f0@tDD == 1
8
H2 Sin@2 f0@tDD a3 a0@tD3 + Sin@4 f0@tDD a3 a0@tD3 +
2 a2 H2 Sin@f0@tDD a0@tD a1@a0@tD, f0@tDD + Cos@f0@tDD a0@tD2 f1@a0@tD, f0@tDDL +
2 a2 H2 Sin@3 f0@tDD a0@tD a1@a0@tD, f0@tDD + 3 Cos@3 f0@tDD a0@tD2 f1@a0@tD, f0@tDDLL=
phaseEq3 = CoefficientList@#, eD &  HphiEq1@@2DD == phaseEqrhsL  Thread  Rest
9F1@a0@tDD + f1
H0,1L@a0@tD, f0@tDD == 1
8
H6 Cos@f0@tDD a2 a0@tD + 2 Cos@3 f0@tDD a2 a0@tDL,
F2@a0@tDD + F1@a0@tDD f1
H0,1L@a0@tD, f0@tDD +
f2
H0,1L@a0@tD, f0@tDD + A1@a0@tDD f1
H1,0L@a0@tD, f0@tDD ==
1
8
H3 a3 a0@tD2 + 4 Cos@2 f0@tDD a3 a0@tD2 + Cos@4 f0@tDD a3 a0@tD2 +
6 a2 HCos@f0@tDD a1@a0@tD, f0@tDD - Sin@f0@tDD a0@tD f1@a0@tD, f0@tDDL +
2 a2 HCos@3 f0@tDD a1@a0@tD, f0@tDD - 3 Sin@3 f0@tDD a0@tD f1@a0@tD, f0@tDDLL=
Next, we use the method  of separation of variables  to  separate  fast and  slowly  varying terms  in the  first-order equations,
ampEq3[[1]] and phaseEq3[[1]]. The slowly varying parts yield
cond36a = 8A1@a0@tDD -> 0, F1@a0@tDD -> 0<;
whereas the fast varying parts yield
Chapter3.nb
65

order1Eq = 8ampEq3@@1DD, phaseEq3@@1DD< . cond36a
9a1
H0,1L@a0@tD, f0@tDD == 1
8
H2 Sin@f0@tDD a2 a0@tD2 + 2 Sin@3 f0@tDD a2 a0@tD2L,
f1
H0,1L@a0@tD, f0@tDD == 1
8
H6 Cos@f0@tDD a2 a0@tD + 2 Cos@3 f0@tDD a2 a0@tDL=
To  determine  the  solutions  of order1Eq using  DSolve, we  transform them  from partial-differential to  ordinary-differential
equations, replace f0@tD with s, and obtain
order1EqTransf = order1Eq . 8a1 -> Ha1@#2D &L, f1 -> Hf1@#2D &L< . f_@tD -> f . f0 -> s
9a1
¢ @sD == 1
8
H2 Sin@sD a0
2 a2 + 2 Sin@3 sD a0
2 a2L, f1
¢@sD == 1
8
H6 Cos@sD a0 a2 + 2 Cos@3 sD a0 a2L=
Instead of replacing f0@tD, we could have symbolized it. Using DSolve, we find that a1 and f1 are given by
rule36@1D = DSolve@order1EqTransf@@1DD, a1@sD, sD@@1DD . C@_D -> 0 .
8s -> f0@tD, a0 -> a0@tD< . a1@arg_D -> a1@a0@tD, argD
9a1@a0@tD, f0@tDD ﬁ
1

12
H-3 Cos@f0@tDD a2 a0@tD2 - Cos@3 f0@tDD a2 a0@tD2L=
rule36@2D = DSolve@order1EqTransf@@2DD, f1@sD, sD@@1DD . C@_D -> 0 .
8s -> f0@tD, a0 -> a0@tD< . f1@arg_D -> f1@a0@tD, argD
9f1@a0@tD, f0@tDD ﬁ
1

12
H9 Sin@f0@tDD a2 a0@tD + Sin@3 f0@tDD a2 a0@tDL=
which can be combined into
cond36b = Join@rule36@1D, rule36@2DD;
Substituting the slow- and fast- varying components of the first-order solution, cond36a and cond36b, into the second-order
equations, we have
66
Chapter3.nb

order2Eq = 8ampEq3@@2DD, phaseEq3@@2DD< . cond36a . cond36b
9A2@a0@tDD + a2
H0,1L@a0@tD, f0@tDD == 1
8
i
k
jj2 Sin@2 f0@tDD a3 a0@tD3 + Sin@4 f0@tDD a3 a0@tD3 +
2 a2 i
k
jj 1

12
Cos@f0@tDD a0@tD2 H9 Sin@f0@tDD a2 a0@tD + Sin@3 f0@tDD a2 a0@tDL +
1
6
Sin@f0@tDD a0@tD H-3 Cos@f0@tDD a2 a0@tD2 - Cos@3 f0@tDD a2 a0@tD2Ly
{
zz +
2 a2 i
k
jj 1
4
Cos@3 f0@tDD a0@tD2 H9 Sin@f0@tDD a2 a0@tD + Sin@3 f0@tDD a2 a0@tDL +
1
6
Sin@3 f0@tDD a0@tD H-3 Cos@f0@tDD a2 a0@tD2 - Cos@3 f0@tDD a2 a0@tD2Ly
{
zzy
{
zz,
F2@a0@tDD + f2
H0,1L@a0@tD, f0@tDD == 1
8
i
k
jj3 a3 a0@tD2 + 4 Cos@2 f0@tDD a3 a0@tD2 + Cos@4 f0@tDD
a3 a0@tD2 + 6 a2 i
k
jj- 1

12
Sin@f0@tDD a0@tD H9 Sin@f0@tDD a2 a0@tD + Sin@3 f0@tDD a2 a0@tDL +
1

12
Cos@f0@tDD H-3 Cos@f0@tDD a2 a0@tD2 - Cos@3 f0@tDD a2 a0@tD2Ly
{
zz +
2 a2 i
k
jj- 1
4
Sin@3 f0@tDD a0@tD H9 Sin@f0@tDD a2 a0@tD + Sin@3 f0@tDD a2 a0@tDL +
1

12
Cos@3 f0@tDD H-3 Cos@f0@tDD a2 a0@tD2 - Cos@3 f0@tDD a2 a0@tD2Ly
{
zzy
{
zz=
Next, we  use trigonometric  identities  to  expand  the  right-hand  sides  of the  second-order equations  in  Fourier series  and
obtain
order2Eqrhs = H#@@2DD  TrigReduce  ExpandL &  order2Eq
9- 9

32
Sin@2 f0@tDD a2
2 a0@tD3 + 5

24
Sin@4 f0@tDD a2
2 a0@tD3 +
1

96
Sin@6 f0@tDD a2
2 a0@tD3 + 1
4
Sin@2 f0@tDD a3 a0@tD3 + 1
8
Sin@4 f0@tDD a3 a0@tD3,
- 5

12
a2
2 a0@tD2 -
3

16
Cos@2 f0@tDD a2
2 a0@tD2 + 1
4
Cos@4 f0@tDD a2
2 a0@tD2 +
1

48
Cos@6 f0@tDD a2
2 a0@tD2 + 3
8
a3 a0@tD2 + 1
2
Cos@2 f0@tDD a3 a0@tD2 + 1
8
Cos@4 f0@tDD a3 a0@tD2=
Since we are seeking an expansion valid to OHe2L, we do not need to solve for a2 and f2. All we need to do is  to investigate
the above expressions to determine the slowly varying parts and determine A2 and F2. The result is
cond36c = 8A2@a0@tDD, F2@a0@tDD< -> Horder2Eqrhs . 8Sin@_D -> 0, Cos@_D -> 0<L  Thread
9A2@a0@tDD ﬁ0, F2@a0@tDD ﬁ- 5

12
a2
2 a0@tD2 + 3
8
a3 a0@tD2=
Substituting the fast-varying components of the first-order solution, cond36b, into the expansions for a and f and discarding
terms of order higher than e, we obtain, to the second approximation, that
asolF = asol . cond36b . e2 -> 0
a@tD == a0@tD +
1

12
e H-3 Cos@f0@tDD a2 a0@tD2 - Cos@3 f0@tDD a2 a0@tD2L
Chapter3.nb
67

phisolF = phisol . cond36b . e2 -> 0
f@tD ==
1

12
e H9 Sin@f0@tDD a2 a0@tD + Sin@3 f0@tDD a2 a0@tDL + f0@tD
Substituting  the  solw-varying  components  of the  first- and  second-order solutions, cond36a and  cond36c, into  a0Eq and
phi0Eq yields
a0Eq1 = a0Eq . cond36a . cond36c
a0
¢ @tD == 0
phi0Eq1 = phi0Eq . cond36a . cond36c
f0
¢ @tD == 1 + e2 i
k
jj- 5

12
a2
2 a0@tD2 + 3
8
a3 a0@tD2y
{
zz
It follows from the above equations that a0 = constant and
phi0Rule = DSolve@phi0Eq1 . a0@tD -> a0, f0@tD, tD@@1DD . C@1D -> b0
9f0@tD ﬁt i
k
jj1 -
5

12
e2 a0
2 a2
2 + 3
8
e2 a0
2 a3y
{
zz + b0=
where b0 is a constant. Substituting these expansions into eq35a, we obtain the following second-order expansion:
eq36a = u@tD == e a@tD Cos@f@tDD . H8asolF, phisolF< . Equal -> RuleL
u@tD == e CosA 1

12
e H9 Sin@f0@tDD a2 a0@tD + Sin@3 f0@tDD a2 a0@tDL + f0@tDE
i
k
jja0@tD +
1

12
e H-3 Cos@f0@tDD a2 a0@tD2 - Cos@3 f0@tDD a2 a0@tD2Ly
{
zz
To  compare  the  present solution  with  those obtained  by  using the  method  of multiple  scales  and the  Lindstedt-Poincaré
technique, we expand the circular functions in eq36a for small e about f0 and obtain
u@tD == HSeries@eq36a@@2DD, 8e, 0, 2<D  Normal  TrigReduce  ExpandL
u@tD == e Cos@f0@tDD a0@tD - 1
2
e2 a2 a0@tD2 + 1
6
e2 Cos@2 f0@tDD a2 a0@tD2
This expansion and phi0Rule are in full agreement with those obtained by using the method of multiple scales.
à 3.7 The Krylov-Bogoliubov-Mitropolsky Technique
In this  section, we describe a variant of the generalized method of averaging, namely the Krylov-Bogoliubov-Mitropolsky
technique. It is  often referred to as the asymptotic  method. When the nonlinear terms are neglected, the solution of eq31g
is
linearSol = u == e a Cos@t + bD;
68
Chapter3.nb

where a and b are constants  and e is a small dimensionless parameter that is a measure of the amplitude. When the nonlinear
terms  are  included, we consider linearSol  to be the  first term in an  approximate solution of eq31g but with slowly  varying
rather than constant  a and  b. Moreover, we  introduce the  fast scale  f = t + b  and use a to  represent  the slow variations.
Thus, we seek a second-order uniform expansion of the solution of eq31g in the form
uSol = u@a@tD, f@tDD == e a@tD Cos@f@tDD + SumAei ui@a@tD, f@tDD, 8i, 2, 3<E
u@a@tD, f@tDD == e a@tD Cos@f@tDD + e2 u2@a@tD, f@tDD + e3 u3@a@tD, f@tDD
Again, terms of order e3 have been included in the expansion, but these terms will not be included in the final result. Since a
and b are slowly varying functions of t, we express them in power series of e in terms of a as
apEq = a '@tD == SumAei Ai@a@tDD, 8i, 2<E
a¢@tD == e A1@a@tDD + e2 A2@a@tDD
phipEq = f'@tD == 1 + SumAei Fi@a@tDD, 8i, 2<E
f¢@tD == 1 + e F1@a@tDD + e2 F2@a@tDD
In what follows, we need a†@tD and f†@tD. To this end, we differentiate apEq and phipEq with respect to t, use these equations
to express a¢@tD and f¢@tD in terms of the Ai@a@tDD and Fi@a@tDD, discard terms of order higher than e2, and obtain
appEq = HD@apEq, tD . HapEq . Equal -> RuleL  ExpandAllL . en_;n>2 -> 0
a†@tD == e2 A1@a@tDD A1
¢@a@tDD
phippEq = HD@phipEq, tD . HapEq . Equal -> RuleL  ExpandAllL . en_;n>2 -> 0
f†@tD == e2 A1@a@tDD F1
¢@a@tDD
Thus, this method can be viewed as a multiple scales procedure with a and f being the scales.
Substituting the assumed  expansion for u@tD, expressed in function form,  and the expansions for the derivatives  of a@tD and
f@tD into eq31g, expanding the result for small e, and keeping terms up to order e3, we have
eq37a = Heq31g . u -> Function@t, uSol@@2DD  EvaluateD .
H8apEq, phipEq, appEq, phippEq< . Equal -> RuleL  ExpandAllL . en_;n>3 -> 0
e2 a@tD2 Cos@f@tDD2 a2 + e3 a@tD3 Cos@f@tDD3 a3 - 2 e2 Sin@f@tDD A1@a@tDD -
2 e3 Sin@f@tDD A2@a@tDD + e2 u2@a@tD, f@tDD + 2 e3 a@tD Cos@f@tDD a2 u2@a@tD, f@tDD +
e3 u3@a@tD, f@tDD - 2 e2 a@tD Cos@f@tDD F1@a@tDD - 2 e3 Sin@f@tDD A1@a@tDD F1@a@tDD -
e3 a@tD Cos@f@tDD F1@a@tDD2 - 2 e3 a@tD Cos@f@tDD F2@a@tDD + e3 Cos@f@tDD A1@a@tDD A1
¢ @a@tDD-
e3 a@tD Sin@f@tDD A1@a@tDD F1
¢@a@tDD + e2 u2
H0,2L@a@tD, f@tDD +
2 e3 F1@a@tDD u2
H0,2L@a@tD, f@tDD + e3 u3
H0,2L@a@tD, f@tDD + 2 e3 A1@a@tDD u2
H1,1L@a@tD, f@tDD == 0
Equating coefficients of like powers of e in eq37a yields
Chapter3.nb
69

eqEps = TableACoefficientAeq37a@@1DD, eiE == 0, 8i, 2, 3<E . f_@tD -> f
9a2 Cos@fD2 a2 - 2 Sin@fD A1@aD + u2@a, fD - 2 a Cos@fD F1@aD + u2
H0,2L@a, fD == 0,
a3 Cos@fD3 a3 - 2 Sin@fD A2@aD + 2 a Cos@fD a2 u2@a, fD + u3@a, fD -
2 Sin@fD A1@aD F1@aD - a Cos@fD F1@aD2 - 2 a Cos@fD F2@aD + Cos@fD A1@aD A1
¢ @aD -
a Sin@fD A1@aD F1
¢ @aD + 2 F1@aD u2
H0,2L@a, fD + u3
H0,2L@a, fD + 2 A1@aD u2
H1,1L@a, fD == 0=
Next, we use trigonometric identities to expand the nonhomogeneous terms in eqEps[[1]] in a Fourier series and obtain
order2Eq = TrigReduce  eqEps@@1DD
1
2
Ia2 a2 + a2 Cos@2 fD a2 - 4 Sin@fD A1@aD + 2 u2@a, fD - 4 a Cos@fD F1@aD + 2 u2
H0,2L@a, fDM == 0
Eliminating the terms that produce secular terms in u2 from order2Eq demands that
rule37a =
Solve@Coefficient@order2Eq@@1DD, 8Cos@fD, Sin@fD<D == 0  Thread, 8F1@aD, A1@aD<D@@1DD
8F1@aD ﬁ0, A1@aD ﬁ0<
Then, the solution of the resulting order2Eq can be written as
rule37b = DSolve@order2Eq . rule37a, u2@a, fD, 8a, f<D@@1DD . C@_D -> H0 &L  Simplify
9u2@a, fD ﬁ1
6
a2 H-3 + Cos@2 fDL a2=
which can be expressed in function form as
rule37c = 8u2 -> Function@8a, f<, rule37b@@1, 2DD  EvaluateD<
9u2 ﬁFunctionA8a, f<, 1
6
a2 H-3 + Cos@2 fDL a2E=
Substituting rule37a and rule37c into eqEps[[2]], we obtain
eq37b = eqEps@@2DD . rule37a . rule37c
1
3
a3 Cos@fD H-3 + Cos@2 fDL a2
2 + a3 Cos@fD3 a3 -
2 Sin@fD A2@aD + u3@a, fD - 2 a Cos@fD F2@aD + u3
H0,2L@a, fD == 0
Eliminating the terms that produce secular terms in u3 from eq37b demands that
eq37c = Coefficient@eq37b@@1DD  TrigReduce, 8Cos@fD, Sin@fD<D == 0  Thread
:- 5
6
a3 a2
2 + 3 a3 a3

4
- 2 a F2@aD == 0, -2 A2@aD == 0>
or 
70
Chapter3.nb

rule37d = Solve@eq37c, 8A2@aD, F2@aD<D@@1DD
9A2@aD ﬁ0, F2@aD ﬁ- 1

24
a2 H10 a2
2 - 9 a3L=
Substituting rule37a and rule37d into apEq and phipEq yields
apEq . Hrule37a~ Join~rule37d . a -> a@tDL
a¢@tD == 0
phipEq . Hrule37a~ Join~rule37d . a -> a@tDL  ExpandAll
f¢@tD == 1 -
5

12
e2 a@tD2 a2
2 + 3
8
e2 a@tD2 a3
which  are  in  full  agreement  with  those obtained  by  using  the  method  of  multiple  scales  and  the  generalized  method  of
averaging.
à 3.8 The Method of Normal Forms
In this section, we use the method of normal forms  to determine a second-order uniform expansion of the solution of eq31g.
To this end, we start with the corresponding first-order complex-valued equation
eq343a = z¢@tD == I z@tD + 1
2
I a2 z@tD2 + 1
2
I a3 z@tD3 + I a2 z@tD z@tD +
3
2
I a3 z@tD2 z@tD + 1
2
I a2 z@tD
2 + 3
2
I a3 z@tD z@tD
2 + 1
2
I a3 z@tD
3;
According to the method of normal forms, we introduce the near-identity transformation
basicTerms = 8h@tD, h@tD<;
zetaRule = 9
z -> FunctionAt, e h@tD + SumAej hj  basicTerms, 8j, 2, 3<E  EvaluateE,
z -> FunctionAt, e h@tD + SumAej h
j  basicTerms, 8j, 2, 3<E  EvaluateE=
8z ﬁFunction@t, e h@tD + e2 h2@h@tD, h@tDD + e3 h3@h@tD, h@tDDD,
z ﬁFunction@t, e h@tD + e2 h
2@h@tD, h@tDD + e3 h
3@h@tD, h@tDDD<
that results in the simplest possible equation
etaRule = 9h¢@tD -> I h@tD + SumAej gj@tD, 8j, 2<E=
8h¢@tD ﬁI h@tD + e g1@tD + e2 g2@tD<
where the overbar denotes the complex conjugate
conjugateRule = 8h -> h, h -> h, g -> g, g -> g, Complex@0, n_D -> Complex@0, -nD<;
Chapter3.nb
71

Substituting the expansion for z, the zetaRule, into eq343a, using etaRule, expanding the result  for small e, and discarding
terms of order higher than e3, we have
eq38a =
Heq343a . zetaRule . etaRule . HetaRule . conjugateRuleL  ExpandAllL . en_;n>3 -> 0;
Equating coefficients of like powers of e in eq38a yields
eqEps = TableACoefficientASubtract  eq38a, eiE == 0, 8i, 2, 3<E
9- 1
2
I a2 h@tD2 - I a2 h@tD h@tD - 1
2
I a2 h@tD2 + g1@tD -
I h2@h@tD, h@tDD - I h@tD h2
H0,1L@h@tD, h@tDD + I h@tD h2
H1,0L@h@tD, h@tDD == 0,
- 1
2
I a3 h@tD3 - 3
2
I a3 h@tD2 h@tD - 3
2
I a3 h@tD h@tD2 - 1
2
I a3 h@tD3 + g2@tD -
I a2 h@tD h2@h@tD, h@tDD - I a2 h@tD h2@h@tD, h@tDD - I h3@h@tD, h@tDD -
I a2 h@tD h
2@h@tD, h@tDD - I a2 h@tD h
2@h@tD, h@tDD + g
1@tD h2
H0,1L@h@tD, h@tDD -
I h@tD h3
H0,1L@h@tD, h@tDD + g1@tD h2
H1,0L@h@tD, h@tDD + I h@tD h3
H1,0L@h@tD, h@tDD == 0=
 Second-Order Solution
We choose the hi to eliminate as many terms  from eqEps, thereby reducing them into their simplest possible form. It turns out
that we can eliminate all nonresonance terms. To determine the resonance terms  in eqEps[[1]], we note that all of the possible
forms of its nonhomogeneous terms are
possibleQTerms = Outer@Times, basicTerms, basicTermsD  Flatten  Union
9h@tD2, h@tD h@tD, h@tD2=
It follows from the linear parts of the etaRule that
form = 9h@tD -> EI t, h@tD -> E-I t=;
Hence, the possible resonance terms are given by
ResonantQTerm = IE-I t possibleQTerms . form . E_t -> 0M possibleQTerms  Union  Rest
8<
Consequently, there are no resonance terms in the second-order problem and the nonresonance terms can be defined as
NRQT = Complement@possibleQTerms, ResonantQTermD
9h@tD2, h@tD h@tD, h@tD2=
We associate with each of them a coefficient according to
72
Chapter3.nb

coeffsQ = Table@Gj, 8j, Length@NRQTD<D
8G1, G2, G3<
Therefore, h2 and its complex conjugate have the form
hFormQ = 9h2 -> HEvaluate@coeffsQ.NRQT . Thread@basicTerms -> 8#1, #2<DD &L,
h
2 -> HEvaluate@coeffsQ.NRQT . conjugateRule . Thread@basicTerms -> 8#1, #2<DD &L=
8h2 ﬁH#12 G1 + #1 #2 G2 + #22 G3 &L, h
2 ﬁH#22 G1 + #1 #2 G2 + #12 G3 &L<
Substituting  for  h2  in  eqEps[[1]], equating  the  coefficients  of  the  possible  nonresonance  terms  to  zero,  and  solving  the
resulting equations for the Gi, we obtain
coeffsQRule = Solve@Coefficient@eqEps@@1, 1DD . hFormQ, NRQTD == 0  Thread, coeffsQD@@1DD
:G1 ﬁa2

2
, G2 ﬁ-a2, G3 ﬁ- a2

6
>
We choose g1 to eliminate the resonance terms in eqEps[[1,1]] according to
gRuleQ = g1@tD -> - Coefficient@eqEps@@1, 1DD, ResonantQTermD.ResonantQTerm
g1@tD ﬁ0
In this case, there are on resonance terms and hence g1 = 0.
 Third-Order Equations
Substituting the second-order results into the third-order equation yields
order3expr =
eqEps@@2, 1DD . hFormQ . coeffsQRule . gRuleQ . HgRuleQ . conjugateRuleL  Expand
- 1
3
I a2
2 h@tD3 - 1
2
I a3 h@tD3 + 5
3
I a2
2 h@tD2 h@tD - 3
2
I a3 h@tD2 h@tD +
5
3
I a2
2 h@tD h@tD2 - 3
2
I a3 h@tD h@tD2 - 1
3
I a2
2 h@tD3 - 1
2
I a3 h@tD3 + g2@tD -
I h3@h@tD, h@tDD - I h@tD h3
H0,1L@h@tD, h@tDD + I h@tD h3
H1,0L@h@tD, h@tDD
The nonhomogeneous terms in order3expr are proportional to
possibleCTerms = Outer@Times, possibleQTerms, basicTermsD  Flatten  Union
9h@tD3, h@tD2 h@tD, h@tD h@tD2, h@tD3=
Next, we determine the resonance terms according to
Chapter3.nb
73

ResonantCTerm = IE-I t possibleCTerms . form . E_t -> 0M possibleCTerms  Union  Rest
8h@tD2 h@tD<
Then, the nonresonance terms are the complement of these resonance terms; that is,
NRCT = Complement@possibleCTerms, ResonantCTermD
9h@tD3, h@tD h@tD2, h@tD3=
Again, we associate coefficients with these terms as follows:
coeffsC = Table@Lj, 8j, Length@NRCTD<D
8L1, L2, L3<
Consequently, h3 and its complex conjugate have the forms
hFormC = 9h3 -> HEvaluate@coeffsC.NRCT . Thread@basicTerms -> 8#1, #2<DD &L,
h
3 -> HEvaluate@coeffsC.NRCT . conjugateRule . Thread@basicTerms -> 8#1, #2<DD &L=
8h3 ﬁH#13 L1 + #1 #22 L2 + #23 L3 &L, h
3 ﬁH#23 L1 + #12 #2 L2 + #13 L3 &L<
Substituting  for h3  into  order3expr, equating  the coefficient  of each  possible  nonresonance  term to  zero, and  solving the
resulting algebraic equations for the Li, we obtain
coeffsCRule = Solve@Coefficient@order3expr . hFormC, NRCTD == 0  Thread, coeffsCD@@1DD
9L1 ﬁ
1

12
H2 a2
2 + 3 a3L, L2 ﬁ
1

12
H10 a2
2 - 9 a3L, L3 ﬁ
1

24
H-2 a2
2 - 3 a3L=
Choosing g2 to eliminate the resonance terms from order3expr yields
gRuleC = g2@tD -> - Coefficient@order3expr, ResonantCTermD.ResonantCTerm
g2@tD ﬁ-i
k
jjjj
5 I a2
2

3
- 3 I a3

2
y
{
zzzz h@tD2 h@tD
Combining etaRule, gRuleQ, and gRuleC and letting h = A@tDEI t, we obtain the modulation equation
moduEq = 2 I E-I t Hh¢@tD - Hh¢@tD . etaRule . gRuleQ . gRuleCLL == 0 .
9h -> IA@#D EI # &M, h -> IA@#D E-I # &M=  ExpandAll
- 10

3
e2 A@tD2 a2
2 A@tD + 3 e2 A@tD2 a3 A@tD + 2 I A¢@tD == 0
which is in full agreement with that obtained by using the other techniques.
74
Chapter3.nb

Chapter 4
Forced Oscillations of the Duffing 
Equation
Off@General::spell1D
In  contrast with  the preceding  chapters, which  deal with  free oscillations, this  chapter and  the  next  two  deal with  forced
oscillations. We consider
FDuffingEq = u†@tD + w2 u@tD + 2 m‘ u¢@tD + d u@tD2 + a u@tD3 == F Cos@W tD;
where  m‘  is  a  positive  constant. In  this  chapter,  we  determine  second-order  solutions  to  FDuffingEq beginning  with  the
straightforward  expansion  in  the  next  section.  We  investigate  this  straightforward  expansion  and  determine  under what
conditions it breaks  down. This  leads to the so-called resonance values of W. In Section 4.2, we use the method of multiple
scales  to  determine second-order uniform expansions of the solutions of FDuffingEq for all resonance cases, including  the
effect  of light  viscous  damping. In  Sections  4.3 and  4.4, we  use the  generalized  method of averaging  and  the  method  of
normal forms, respectively, to  determine second-order uniform expansions for the case of subharmonic  resonance of order
one-half; that is, W » 2 w.
à 4.1 Straightforward Expansion
We seek a straightforward expansion for the solutions of FDuffingEq in the form
uSol = u -> ISumAei ui@#D, 8i, 3<E &M;
Substituting  uSol  into  FDuffingEq , letting  F = e f and m‘ = e m, expanding  the  result  for small e, and  discarding  terms  of
order higher than e3, we have
eq41a = HFDuffingEq . uSol . 8F -> e f, m‘ -> e m<  ExpandAllL . en_;n>3 -> 0
e w2 u1@tD + d e2 u1@tD2 + a e3 u1@tD3 + e2 w2 u2@tD + 2 d e3 u1@tD u2@tD +
e3 w2 u3@tD + 2 e2 m u1
¢@tD + 2 e3 m u2
¢@tD + e u1
†@tD + e2 u2
†@tD + e3 u3
†@tD == f e Cos@t WD
Equating coefficients of like powers of e on both sides yields
eqEpsa = CoefficientList@Subtract  eq41a, eD == 0  Thread  Rest
8-f Cos@t WD + w2 u1@tD + u1
†@tD == 0, d u1@tD2 + w2 u2@tD + 2 m u1
¢ @tD + u2
†@tD == 0,
a u1@tD3 + 2 d u1@tD u2@tD + w2 u3@tD + 2 m u2
¢ @tD + u3
†@tD == 0<
The particular solution of the first-order equation, linear and undamped problem, can be expressed as

sol1p = DSolve@eqEpsa@@1DD, u1@tD, tD@@1DD . C@_D -> 0  TrigToExp  Simplify
:u1@tD ﬁ- E-I t W H1 + E2 It WL f


2 H-w2 + W2L
>
We note that sol1p consists  of a term whose denominator is  very small when W » w. Such a term is called a small-divisor
term. Moreover, u@tD tends to  infinity as  W ﬁw, and the excitation  is  referred  to as  a resonance  excitation. Because the
small-divisor term appears  in the  first-order problem, we  speak of a  primary or main  resonance. When  the  small-divisor
terms  appear in  the  higher-order  problems, we  speak of  secondary  resonances. In  the  case of primary  resonance,  the
scaling F ﬁe f is  not valid. Physically, as soon as  the motion becomes  large, the damping and nonlinearity are activated
to  counter the effect of the resonance. Consequently, to obtain  a uniform expansion in this  case, we rescale  F  and m‘ , as
discussed  in  Section  4.2, so  that  the  influence  of the  damping  and  nonlinearity  balances  the  influence  of the  primary
resonance.
When  W  is  away  from w, we add  the homogeneous  solution to  sol1p and  obtain  the  general solution  of the  first-order
problem as
fRule = 9f -> 2 L IW2 - w2M=;
sol1 = u1 -> FunctionAt, A EI w t + A E-I w t + sol1p@@1, 2DD . fRule  Expand  EvaluateE
u1 ﬁFunction@t, A EIt w - E-I t W L - EI t W L + E-I t w AD
where A is a complex-valued constant. Substituting sol1 into the second-order equation, eqEpsa[[2]], yields
order2Eqa = u2†@tD + w2 u2@tD - # &  eqEpsa@@2DD . sol1  ExpandAll  Reverse
w2 u2@tD + u2
†@tD ==
-A2 E2 I t w d + 2 A EI t w-It W d L + 2 A EI t w+I t W d L - 2 d L2 - E-2 I t W d L2 - E2I t W d L2 - 2 I A EIt w m w -
2 I E-I t W L m W + 2 I EI t W L m W - 2 A d A + 2 E-I t w-I t W d L A + 2 E-I t w+I t W d L A + 2 I E-I t w m w A - E-2 I t w d A2
Solving for the particular solution of order2Eqa, we obtain
sol2p = Hu2@tD . DSolve@order2Eqa@@1DD == #, u2@tD, tD@@1DD . C@_D -> 0  TrigToExp 
SimplifyL &  order2Eqa@@2DD
A2 E2 I t w d

3 w2
- 2 d L2

w2
- A EI t w m HI + 2 t wL


2 w
+ 2 A EI t Hw-WL d L

H2 w - WL W
-
2 A EI tHw+WL d L

WH2 w + WL
+ 2 I EI t W L m W

w2 - W2
+ 2 I E-I t W L m W

-w2 + W2
+ E-2I t W d L2

-w2 + 4 W2
+ E2 I t W d L2

-w2 + 4 W2 -
2 A d A

w2
- E-I t w m H-I + 2 t wL A


2 w
+ 2 E-I t Hw-WL d L A

H2 w - WL W
- 2 E-I t Hw+WL d L A

W H2 w + WL
+ E-2 I t w d A2

3 w2
Clearly, sol2p breaks  down  because it  contains  secular terms  proportional to  the  damping  coefficient m. Moreover,  sol2p
breaks  down  when W » 2 w, W » w 2, or W » 0 because they produce small-divisor terms  and hence secondary  resonances.
As  discussed in Section  4.2, the case W » 2 w is  called  subharmonic  resonance  of order one-half  and the case W » w 2 is
called superharmonic resonance of order two.
76
Chapter4.nb

When W is away from w, 2w, w 2, or 0, sol2p is  valid only if we rescale  the damping term so that it first appears in the third-
order equation; that is, m‘ -> e2 m. Using this scaling, we rewrite eq41a as
eq41b = eq41a . m -> e m . e4 -> 0
e w2 u1@tD + d e2 u1@tD2 + a e3 u1@tD3 + e2 w2 u2@tD + 2 d e3 u1@tD u2@tD +
e3 w2 u3@tD + 2 e3 m u1
¢@tD + e u1
†@tD + e2 u2
†@tD + e3 u3
†@tD == f e Cos@t WD
eqEpsb = CoefficientList@Subtract  eq41b, eD == 0  Thread  Rest
8-f Cos@t WD + w2 u1@tD + u1
†@tD == 0, d u1@tD2 + w2 u2@tD + u2
†@tD == 0,
a u1@tD3 + 2 d u1@tD u2@tD + w2 u3@tD + 2 m u1
¢ @tD + u3
†@tD == 0<
Comparing eqEpsb to eqEpsa, we immediately obtain its solution from sol2p as
sol2pNew = sol2p . m -> 0
A2 E2 I t w d

3 w2
- 2 d L2

w2
+ 2 A EI t Hw-WL d L

H2 w - WL W
- 2 A EI t Hw+WL d L

W H2 w + WL
+ E-2 I t W d L2

-w2 + 4 W2
+
E2 I tW d L2

-w2 +4 W2 - 2 A d A

w2
+ 2 E-It Hw-WL d L A

H2 w - WL W
- 2 E-I t Hw+WL d L A

W H2 w + WL
+ E-2 I t w d A2

3 w2
Hence, the general solution of eqEpsb[[2]] can be written as
sol2New = u2 -> FunctionAt, B EI w t + B E-I w t + sol2pNew  EvaluateE
u2 ﬁFunctionBt, B EIt w + A2 E2I t w d

3 w2
- 2 d L2

w2
+ 2 A EIt Hw-WL d L

H2 w - WL W
- 2 A EI t Hw+WL d L

W H2 w + WL
+ E-2I t W d L2

-w2 + 4 W2
+
E2 I tW d L2

-w2 + 4 W2 - 2 A d A

w2
+ 2 E-It Hw-WL d L A

H2 w - WL W
- 2 E-I t Hw+WL d L A

W H2 w + WL
+ E-2 I t w d A2

3 w2
+ E-I t w BF
where B is a complex-valued constant.
Substituting sol1 and sol2New into eqEpsb[[3]] yields
Chapter4.nb
77

order3Eqb = u3†@tD + w2 u3@tD - # &  eqEpsb@@3DD . sol1 . sol2New  ExpandAll  Reverse
w2 u3@tD + u3
†@tD == -A3 E3 I t w a - 2 A B E2 I t w d + 3 A2 E2 I t w-It W a L + 3 A2 E2 It w+I t W a L +
2 B EI t w-I tW d L + 2 B EI t w+I t W d L - 6 A EI t w a L2 - 3 A EIt w-2 I t W a L2 - 3 A EI t w+2 I t W a L2 +
3 E-I t W a L3 + 3 EI t W a L3 + E-3 I t W a L3 + E3 It W a L3 - 2 A3 E3 I t w d2

3 w2
+ 2 A2 E2 I t w-I t W d2 L


3 w2
+
2 A2 E2 I t w+I tW d2 L


3 w2
+ 4 A EI t w d2 L2

w2
- 4 E-I t W d2 L3

w2
- 4 EI t W d2 L3

w2
- 2 I A EI t w m w -
2 I E-I t W L m W + 2 I EI t W L m W - 4 A2 E2 I t w-I tW d2 L


2 w W - W2
+ 4 A EI t w d2 L2

2 w W - W2
+ 4 A EI t w-2 It W d2 L2


2 w W - W2
+
4 A2 E2 I t w+I tW d2 L


2 w W + W2
- 4 A EI t w d2 L2

2 w W + W2
- 4 A EI t w+2 It W d2 L2


2 w W + W2
- 2 A EIt w+2 I t W d2 L2


-w2 + 4 W2
+ 2 EI t W d2 L3

-w2 + 4 W2
+
2 E3 It W d2 L3

-w2 + 4 W2
-
2 A EI t w d2 L2


-E2 I t W w2 + 4 E2I t W W2 +
2 E-I tW d2 L3


-E2 I tW w2 + 4 E2 I t W W2 +
2 EI tW d2 L3


-E2 I t W w2 + 4 E2 I t W W2 -
3 A2 EIt w a A - 2 B d A + 6 A E-I t W a L A + 6 A EI t W a L A - 6 E-I t w a L2 A - 3 E-I t w-2 I t W a L2 A -
3 E-I t w+2 It W a L2 A + 10 A2 EI t w d2 A

3 w2
- 4 A E-I t W d2 L A

w2
- 4 A EI t W d2 L A

w2
+ 4 E-I tw d2 L2 A

w2
+
2 I E-I t w m w A - 4 A E-I t W d2 L A

2 w W - W2
+ 4 A EI t W d2 L A

2 w W + W2
- 2 E-It w+2 I t W d2 L2 A


-w2 + 4 W2
-
2 E-I tw d2 L2 A


-E2 I t W w2 + 4 E2 I t W W2 -
4 A EI tw d2 L A


2 EI tw-I t W w W - EI t w-I tW W2 +
4 E-I t W d2 L2 A


2 EI t w-I t W w W - EIt w-I t W W2 +
4 EI t W d2 L2 A


2 EI t w-I t W w W - EI t w-I tW W2 +
4 A EI tw d2 L A


2 EI tw+I t W w W + EI t w+I tW W2 -
4 E-I t W d2 L2 A


2 EI t w+I t W w W + EIt w+I t W W2 -
4 EI t W d2 L2 A


2 EI t w+I t W w W + EI t w+I tW W2 -
3 A E-I t w a A2 + 3 E-2 I t w-It W a L A2 + 3 E-2 It w+I t W a L A2 + 10 A E-I t w d2 A2

3 w2
+ 2 E-2 I tw-I t W d2 L A2


3 w2
+
2 E-2 It w+I t W d2 L A2


3 w2
-
4 E-I t w d2 L A2


2 EI t w-I tW w W - EI t w-I t W W2 +
4 E-I t w d2 L A2


2 EIt w+I t W w W + EI t w+It W W2 -
E-3 I t w a A3 - 2 E-3 I tw d2 A3

3 w2
- 2 A d B + 2 E-I t w-I t W d L B + 2 E-I t w+I t W d L B - 2 E-2I t w d A B
The particular solution of order3Eqb is given by
78
Chapter4.nb

Hsol3p = Hu3@tD . DSolve@order3Eqb@@1DD == #, u3@tD, tD@@1DD . C@_D -> 0  TrigToExp 
SimplifyL &  order3Eqb@@2DDL  Timing
:64.803 Second, A3 E3 I t w d2

12 w4
+ A3 E3 I t w a

8 w2
+ 2 A B E2 I tw d

3 w2
+ A EI tw d2 L2 H1 - 2 I t wL


w4
+
3 I A EIt w a L2 HI + 2 t wL


2 w2
- A EI t w m HI + 2 t wL


2 w
- 3 A EI t Hw-2 WL a L2

4 Hw - WL W
+ 2 B EI t Hw-WL d L

H2 w - WL W
+
A EI tw d2 L2 H1 - 2 I t wL


w2 H2 w - WL W
+ 3 A EI t Hw+2 WL a L2

4 W Hw + WL
- 2 B EI t Hw+WL d L

W H2 w + WL
+ I A EI t w d2 L2 HI + 2 t wL


w2 W H2 w + WL
+
AEI t Hw+2 WL d2 L2


W2 Hw + WL H2 w + WL
- 3 A2 EI t H2 w+WL a L

Hw + WL H3 w + WL
-
2 A2 EI t H2w+WL d2 L


3 w2 Hw + WL H3 w + WL
-
4 A2 EI t H2 w+WL d2 L


W Hw + WL H2 w + WL H3 w + WL
+
E-3 It W a L3

w2 - 9 W2
+ E3 I t W a L3

w2 - 9 W2
+
A EI t Hw-2 WL d2 L2


2 Hw - WL W Hw2 - 4 W2L
-
A EI t Hw+2 WL d2 L2


2 W Hw + WL Hw2 - 4 W2L
+ 3 E-I t W a L3

w2 - W2
+
3 EI tW a L3

w2 - W2
+ 2 I EI t W L m W

w2 - W2
+ 4 E-I t W d2 L3

w2 H-w2 + W2L
+
4 EI t W d2 L3

w2 H-w2 + W2L
+ 2 I E-I t W L m W

-w2 + W2
- 3 A2 EI t H2 w-WL a L

3 w2 - 4 w W + W2
-
2 A2 EI t H2 w-WL d2 L


3 w2 H3 w2 - 4 w W + W2L
+
A EI t Hw-2WL d2 L2


W2 H2 w2 - 3 w W + W2L
-
4 A2 EIt H2 w-WL d2 L


W H-6 w3 + 11 w2 W - 6 w W2 + W3L
-
2 E-It W d2 L3

w4 - 5 w2 W2 + 4 W4 -
2 EI t W d2 L3

w4 - 5 w2 W2 + 4 W4 -
2 E-3 I t W d2 L3


w4 - 13 w2 W2 + 36 W4 -
2 E3 I t W d2 L3


w4 - 13 w2 W2 + 36 W4 - 2 B d A

w2
+
5 A2 EI t w d2 H1 - 2 I t wL A


6 w4
+ E-I t w d2 L2 H1 + 2 I t wL A


w4
- 3 I E-I t w a L2 H-I + 2 t wL A


2 w2
-
E-I tw m H-I + 2 t wL A


2 w
+ 3 I A2 EI t w a HI + 2 t wL A


4 w2
+ E-I t w d2 L2 H1 + 2 I t wL A


w2 H2 w - WL W
+
3 E-I tHw+2 WL a L2 A


4 W Hw + WL
-
4 A E-I t W d2 L A


W H-2 w + WL H-w + WL Hw + WL
-
4 A EI t W d2 L A


W H-2 w + WL H-w + WL Hw + WL
-
I E-I tw d2 L2 H-I + 2 t wL A


w2 W H2 w + WL
+
E-I t Hw+2 WL d2 L2 A


W2 Hw + WL H2 w + WL
-
4 A E-It W d2 L A


W H-w + WL Hw + WL H2 w + WL
-
4 A EI t W d2 L A


W H-w + WL Hw + WL H2 w + WL
+
E-I t Hw-2 WL d2 L2 A


2 Hw - WL W Hw2 - 4 W2L
-
E-I t Hw+2 WL d2 L2 A


2 W Hw + WL Hw2 - 4 W2L
+
6 A E-It W a L A

w2 - W2
+ 6 A EI t W a L A

w2 - W2
+ 4 A E-I t W d2 L A

w2 H-w2 + W2L
+ 4 A EI t W d2 L A

w2 H-w2 + W2L
+
E-I t Hw-2 WL d2 L2 A


W2 H2 w2 - 3 w W + W2L
+
3 E-I tw+2 I t W a L2 A


-4 w W + 4 W2
+ 5 A E-I t w d2 H1 + 2 I t wL A2


6 w4
- 3 I A E-I t w a H-I + 2 t wL A2


4 w2
-
3 E-I tH2 w+WL a L A2


Hw + WL H3 w + WL
-
2 E-I t H2 w+WL d2 L A2


3 w2 Hw + WL H3 w + WL
-
4 E-It H2 w+WL d2 L A2


W Hw + WL H2 w + WL H3 w + WL
-
3 E-2 It w+I t W a L A2


3 w2 - 4 w W + W2
-
2 E-2 I t w+I t W d2 L A2


3 w2 H3 w2 - 4 w W + W2L
-
4 E-2 I t w+I tW d2 L A2


W H-6 w3 + 11 w2 W - 6 w W2 + W3L
+
E-3 It w d2 A3

12 w4
+ E-3I t w a A3

8 w2
- 2 A d B

w2
+ 2 E-I t Hw-WL d L B

H2 w - WL W
- 2 E-I t Hw+WL d L B

W H2 w + WL
+ 2 E-2 I t w d A B

3 w2
>
Clearly,  sol3p breaks  down  because  it  contains  secular  terms  and  small-divisor  terms  when  W » w,  W » 0,  W » 2 w,
W » w 2, W » 3 w, and W » w 3. As shown  in  the  next  section, the  small-divisor terms  arising  from W » 3 w  produce  a
Chapter4.nb
79

subharmonic  reosonance of order one-third  and those arising from W » w 3 produce a superharmonic  resonance of order
three. Carrying out the expansion to higher order, one finds that other resonances may occur.
We  note  that  the  resonances  that  occur depend  on  the  order of the  nonlinearity. Quadratic  nonlinearities  produce  (a)
subharmonic  resonances  of order one-half and  superharmonic  resonances  of order two at second  order and (b) subhar-
monic resonances of order one-third and superharmonic resonances  of order three at third order. On the other hand, cubic
nonlinearities  produce subharmonic  resonances  of order one-third  and superharmonic  resonances  of order three at third
order. For a given system and order of approximation, the resonances  produced can be easily identified by carrying out a
straightforward expansion as done above.
In the next  three sections, we use the method of multiple scales, generalized method of averaging, and method of normal
forms  to determine second-order uniform expansions for the solutions of FDuffingEq that do not contain  secular or small-
divisor terms.
à 4.2 The Method of Multiple Scales
 4.2.1 Preliminaries
For a uniform second-order expansion, we need three time scales, which we symbolize and list as follows:
Needs@"Utilities`Notation`"D
Symbolize@T0D; Symbolize@T1D; Symbolize@T2D;
timeScales = 8T0, T1, T2<;
The maximum order of the expansion is related, in general, to the number of time scales by 
maxOrder = Length@timeScalesD - 1;
In what follows, we need the complex conjugates of A, z, and G, which we define by
conjugateRule = 9Complex@0, n_D -> Complex@0, -nD, A -> A, A -> A, z -> z, z -> z, G -> G, G -> G=;
In terms of the time scales Tn, the time derivatives become
dt@1D@expr_D := SumAei D@expr, timeScales@@i + 1DDD, 8i, 0, maxOrder<E;
dt@2D@expr_D := Hdt@1D@dt@1D@exprDD  ExpandL . ei_;i>maxOrder -> 0;
To represent some of the expressions in a more concise way, we introduce the following display rule:
80
Chapter4.nb

displayRule =
9Derivative@a__DAz_i_E@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD-1
#1
&, 8a<E, ziE,
Derivative@a__D@AD@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD
#1
&, 8a<E, AE,
Derivative@a__D@AD@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD
#1
&, 8a<E, AE,
z_i_@__D -> zi, A@__D -> A, A@__D -> A=;
Using the time scales  T0, T1, and T2, we transform FDuffingEq from an ordinary-differential equation into a partial-differen-
tial equation according to the rule
multiScalesRule =
8u@tD -> u@T0, T1, T2D, Derivative@n_D@uD@tD :> dt@nD@u@T0, T1, T2DD, t -> T0<;
We seek a second-order uniform expansion of the solution of FDuffingEq in the form
solRule = u -> ISumAei ui@#1, #2, #3D, 8i, maxOrder + 1<E &M;
For a uniform expansion, we need to eliminate the secular and small-divisor terms. To accomplish this, we need to distinguish
between primary and secondary resonances. They are treated separately beginning with the case of primary resonance.
 4.2.2 Primary Resonance
We scale the damping m‘  and forcing F so that the damping term and resonance terms  appear at the same order at which the
secular and / or small-divisor terms generated by the nonlinearities appear. In this  case, they appear at order e3, and hence we
scale the forcing and damping as
scaling = 9F -> e3 f, m‘ -> e2 m=;
Substituting  the  solRule  into  FDuffingEq, using  the  scaling  and  multiScalesRule,  expanding  the  result  for small e, and
discarding terms of order higher than e3, we obtain
eq422a =
HFDuffingEq . scaling . multiScalesRule . solRule  ExpandAllL . en_;n>maxOrder+1 -> 0;
eq422a . displayRule
2 e3 m HD0u1L + e HD0
2u1L + e2 HD0
2u2L + e3 HD0
2u3L + 2 e2 HD0 D1u1L + 2 e3 HD0 D1u2L + e3 HD1
2u1L +
2 e3 HD0 D2u1L + e w2 u1 + d e2 u1
2 + a e3 u1
3 + e2 w2 u2 + 2 d e3 u1 u2 + e3 w2 u3 == f e3 Cos@T0 WD
Equating coefficients of like powers of e in eq422a, we obtain
eqEps = CoefficientList@Subtract  eq422a, eD == 0  Thread  Rest  TrigToExp;
To place the linear operator on one side and the nonhomogeneous terms on the other side, we define
eqOrder@i_D := HeqEps@@1, 1DD . u1 -> uiL - # &  eqEps@@iDD  Reverse
Using eqOrder[i] and the displayRule, we rewrite eqEps in a concise way as
Chapter4.nb
81

Array@eqOrder, 3D . displayRule
9D0
2u1 + w2 u1 == 0, D0
2u2 + w2 u2 == -2 HD0 D1u1L - d u1
2,
D0
2u3 + w2 u3 == 1
2
HE-I T0 W + EI T0 WL f - 2 m HD0u1L - 2 HD0 D1u2L - D1
2u1 - 2 HD0 D2u1L - a u1
3 - 2 d u1 u2=
The general solution of eqOrder[1] can be expressed as
sol1 = u1 -> FunctionA8T0, T1, T2<, A@T1, T2D Exp@I w T0D + A@T1, T2D Exp@-I w T0DE;
Using sol1, we rewrite eqOrder[2] as
order2Eq = eqOrder@2D . sol1  ExpandAll;
order2Eq . displayRule
D0
2u2 + w2 u2 == -A2 E2 I T0 w d - 2 A d A - E-2 IT0 w d A2 - 2 I EI T0 w w HD1AL + 2 I E-I T0 w w HD1AL
Eliminating the terms that produce secular terms in order2Eq demands that
SCond1 = Coefficient@order2Eq@@2DD, Exp@I w T0DD == 0
-2 I w AH1,0L@T1, T2D == 0
Solving SCond1 for AH1,0L@T1, T2D yields
SCond1Rule = SolveASCond1, AH1,0L@T1, T2DE@@1DD
8AH1,0L@T1, T2D ﬁ0<
Hence, A = A@T2D.
Substituting the solvability condition into order2Eq, we have
order2Eqm = order2Eq . SCond1Rule . HSCond1Rule . conjugateRuleL;
order2Eqm . displayRule
D0
2u2 + w2 u2 == -A2 E2 I T0 w d - 2 A d A - E-2 IT0 w d A2
The particular solution of order2Eqm can be obtained by using DSolve; the result is
sol2p = DSolve@order2Eqm, u2  timeScales, timeScalesD@@1DD . C@_D -> H0 &L  TrigToExp 
ExpandAll;
sol2p . displayRule
:u2 ﬁA2 E2 I T0 w d

3 w2
- 2 A d A

w2
+ E-2 I T0 w d A2

3 w2
>
Next, we use sol2p[[1,2]] directly to express u2 in a pure function form as
sol2 = u2 -> Function@8T0, T1, T2<, sol2p@@1, 2DD  EvaluateD;
82
Chapter4.nb

Substituting the first- and second-order solutions, sol1 and sol2, into the third-order equation, eqOrder[3], we obtain
order3Eq = eqOrder@3D . sol1 . sol2  ExpandAll;
order3Eq . displayRule
D0
2u3 + w2 u3 == 1
2
E-I T0 W f + 1
2
EIT0 W f - A3 E3 I T0 w a - 2 A3 E3 I T0 w d2

3 w2
-
2 I A EI T0 w m w - 3 A2 EI T0 w a A + 10 A2 EI T0 w d2 A

3 w2
+ 2 I E-I T0 w m w A - 3 A E-I T0 w a A2 +
10 A E-IT0 w d2 A2

3 w2
- E-3I T0 w a A3 - 2 E-3 I T0 w d2 A3

3 w2
- 8 I A E2 I T0 w d HD1AL


3 w
+
8 I E-2I T0 w d A HD1AL


3 w
- EI T0 w HD1
2AL - E-IT0 w HD1
2AL - 2 I EI T0 w w HD2AL + 2 I E-I T0 w w HD2AL
To express the nearness of W to w, we introduce a detuning parameter s = OH1L defined by
OmgRule = 9W -> w + e2 s=;
Using the OmgRule, we  convert  the small-divisor term arising from the excitation  into a secular term. Then, eliminating the
secular terms from u3 demands that
expRule1 = Exp@a_D :> ExpAExpand@a . OmgRuleD . e2 T0 -> T2E;
SCond2 = Coefficient@order3Eq@@2DD . expRule1, Exp@I w T0DD == 0;
SCond2 . displayRule
1
2
EI T2 s f - 2 I A m w - 3 A2 a A + 10 A2 d2 A

3 w2
- D1
2A - 2 I w HD2AL == 0
Using the fact that A = A@T2D from SCond1Rule, we rewrite SCond2 as
SCond = SCond2 . D@SCond1Rule, T1D . 9A -> HA@#2D &L, A -> IA@#2D &M=
1
2
EI T2 s f - 2 I m w A@T2D - 3 a A@T2D2 A@T2D + 10 d2 A@T2D2 A@T2D


3 w2
- 2 I w A¢@T2D == 0
 4.2.3 Secondary Resonances Due to Cubic Nonlinearities
In this  case W is away from w, 2 w, and w 2 and small-divisor terms  first appear at OHe3L. We scale  the damping m‘  and forcing
F so that the damping term and resonance terms appear at the same order as the cubic nonlinearity according to
scaling = 9F -> e f, m‘ -> e2 m=;
Chapter4.nb
83

eq423a =
HFDuffingEq . scaling . multiScalesRule . solRule  ExpandAllL . en_;n>maxOrder+1 -> 0;
eq423a . displayRule
2 e3 m HD0u1L + e HD0
2u1L + e2 HD0
2u2L + e3 HD0
2u3L + 2 e2 HD0 D1u1L + 2 e3 HD0 D1u2L + e3 HD1
2u1L +
2 e3 HD0 D2u1L + e w2 u1 + d e2 u1
2 + a e3 u1
3 + e2 w2 u2 + 2 d e3 u1 u2 + e3 w2 u3 == f e Cos@T0 WD
Equating coefficients of like powers of e, we obtain
eqEps = CoefficientList@Subtract  eq423a, eD == 0  Thread  Rest  TrigToExp;
To place the linear operator on one side and the nonhomogeneous terms on the other side, we define
eqOrder@i_D := HeqEps@@1, 1DD . f -> 0 . u1 -> uiL - # &  eqEps@@iDD  Reverse
Using eqOrder[i] and displayRule, we rewrite eqEps in a concise way as
Array@eqOrder, 3D . displayRule  TableForm
D02u1 + w2 u1 ==
12 HE-I T0 W + EI T0 WL f
D0
2u2 + w2 u2 == -2 HD0 D1u1L - d u1
2
D02u3 + w2 u3 == -2 m HD0u1L - 2 HD0 D1u2L - D12u1 - 2 HD0 D2u1L - a u13 - 2 d u1 u2
The particular solution of eqOrder[1] can be expressed as
sol1p = DSolve@eqOrder@1D, u1  timeScales, timeScalesD@@1DD . C@_D -> H0 &L  Simplify
:u1@T0, T1, T2D ﬁ- E-I T0 W H1 + E2 I T0 WL f


2 H-w2 + W2L
>
The general solution of eqOrder[1] can be written as
fRule = 9f ﬁ-2 L I-w2 + W2M=;
sol1 = u1 -> FunctionA8T0, T1, T2<,
A@T1, T2D Exp@I w T0D + A@T1, T2D Exp@-I w T0D + sol1p@@1, 2DD . fRule  Expand  EvaluateE
u1 ﬁFunction@8T0, T1, T2<, E-I T0 W L + EI T0 W L + EI T0 w A@T1, T2D + E-I T0 w A@T1, T2DD
Substituting sol1 into eqOrder[2] yields
order2Eq = eqOrder@2D . sol1  ExpandAll;
order2Eq . displayRule
D0
2u2 + w2 u2 == -A2 E2 I T0 w d - 2 A EI T0 w-I T0 W d L - 2 A EI T0 w+I T0 W d L - 2 d L2 - E-2 I T0 W d L2 - E2 I T0 W d L2 -
2 A d A - 2 E-I T0 w-IT0 W d L A - 2 E-I T0 w+I T0 W d L A - E-2 I T0 w d A2 - 2 I EI T0 w w HD1AL + 2 I E-I T0 w w HD1AL
84
Chapter4.nb

 The Case W » 3 w 
To express the nearness of W to 3 w, we introduce a detuning parameter s = OH1L defined by
OmgRule = 9W -> 3 w + e2 s=;
expRule1 = 9Exp@arg_D :> ExpAExpand@arg . OmgRuleD . e2 T0 -> T2E=;
Eliminating the secular terms from u2 demands that
SCond1 = Coefficient@order2Eq@@2DD . expRule1, Exp@I w T0DD == 0
-2 I w AH1,0L@T1, T2D == 0
SCond1Rule = SolveASCond1, AH1,0L@T1, T2DE@@1DD
8AH1,0L@T1, T2D ﬁ0<
whose complex conjugate is
ccSCond1Rule = SCond1Rule . conjugateRule
:AH1,0L@T1, T2D ﬁ0>
Substituting the solvability condition, SCond1Rule, and its complex conjugate, into order2Eq, we have
Horder2Eqm = order2Eq . SCond1Rule . ccSCond1RuleL . displayRule
D0
2u2 + w2 u2 == -A2 E2 I T0 w d - 2 A EI T0 w-I T0 W d L - 2 A EI T0 w+I T0 W d L - 2 d L2 -
E-2 I T0 W d L2 - E2 I T0 W d L2 - 2 A d A - 2 E-I T0 w-I T0 W d L A - 2 E-I T0 w+I T0 W d L A - E-2I T0 w d A2
In order to efficiently use DSolve to determine the particular solution of order2Eqm, we first transform the partial-differential
equation to an ordinary-differential equation. Then we solve for the particular solution of the resulting equation and obtain
sol2p =
Hu2@T0D . DSolve@Horder2Eqm@@1DD . u2 -> Hu2@#1D &LL == #, u2@T0D, T0D@@1DD . C@_D -> 0 
TrigToExp  ExpandL &  order2Eqm@@2DD;
sol2p . displayRule
A2 E2 I T0 w d

3 w2
- 2 d L2

w2
- 2 A EI T0 Hw-WL d L

H2 w - WL W
+ 2 A EI T0 Hw+WL d L

W H2 w + WL
+
E-2 IT0 W d L2


H-w + 2 WL Hw + 2 WL
+
E2 I T0 W d L2


H-w+ 2 WL Hw + 2 WL
- 2 A d A

w2
- 2 E-I T0 Hw-WL d L A

H2 w - WL W
+ 2 E-I T0 Hw+WL d L A

W H2 w + WL
+ E-2 I T0 w d A2

3 w2
which can be used directly to express u2 in a pure function form as
sol2 = u2 -> Function@8T0, T1, T2<, sol2p  EvaluateD;
Substituting sol1 and sol2 into the third-order equation, eqOrder[3], we obtain
Chapter4.nb
85

order3Eq = eqOrder@3D . sol1 . sol2  ExpandAll;
Eliminating the secular terms from u3 demands that
SCond2 =
Coefficient@order3Eq@@2DD . expRule1 . W -> 3 w, Exp@I w T0DD == 0 . D@SCond1Rule, T1D;
SCond2 . displayRule
-6 A a L2 + 12 A d2 L2

5 w2
- 2 I A m w - 3 A2 a A + 10 A2 d2 A

3 w2
- 3 EI T2 s a L A2 - 2 EI T2 s d2 L A2

w2
- 2 I w HD2AL == 0
 The Case W » 
13 w 
To express the nearness of W to 13  w, we introduce a detuning parameter s = OH1L defined by
OmgRule = 9W -> 1
3
 Iw + e2 sM=;
expRule1 = 9Exp@arg_D :> ExpAExpand@arg . OmgRuleD . e2 T0 -> T2E=;
Eliminating the secular terms from u2 demands that
SCond1 = Coefficient@order2Eq@@2DD . expRule1, Exp@I w T0DD == 0
-2 I w AH1,0L@T1, T2D == 0
or 
SCond1Rule = SolveASCond1, AH1,0L@T1, T2DE@@1DD
8AH1,0L@T1, T2D ﬁ0<
whose complex conjugate is
ccSCond1Rule = SCond1Rule . conjugateRule;
Substituting the solvability condition, SCond1Rule, and its complex conjugate, into order2Eq, we have
order2Eqm = order2Eq . SCond1Rule . ccSCond1Rule;
order2Eqm . displayRule
D0
2u2 + w2 u2 == -A2 E2 I T0 w d - 2 A EI T0 w-I T0 W d L - 2 A EI T0 w+I T0 W d L - 2 d L2 -
E-2 I T0 W d L2 - E2 I T0 W d L2 - 2 A d A - 2 E-I T0 w-I T0 W d L A - 2 E-I T0 w+I T0 W d L A - E-2I T0 w d A2
Again, we first transform the partial-differential equation into an ordinary-differential equation and then use DSolve to obtain
the particular solution of order2Eqm as
86
Chapter4.nb

Hsol2p =
Hu2@T0D . DSolve@Horder2Eqm@@1DD . u2 -> Hu2@#1D &LL == #, u2@T0D, T0D@@1DD . C@_D -> 0 
TrigToExpL &  order2Eqm@@2DDL . displayRule
A2 E2 I T0 w d

3 w2
- 2 d L2

w2
- 2 A EI T0 Hw-WL d L

H2 w - WL W
+ 2 A EI T0 Hw+WL d L

W H2 w + WL
+
E-2 IT0 W d L2


H-w + 2 WL Hw + 2 WL
+
E2 I T0 W d L2


H-w+ 2 WL Hw + 2 WL
- 2 A d A

w2
- 2 E-I T0 Hw-WL d L A

H2 w - WL W
+ 2 E-I T0 Hw+WL d L A

W H2 w + WL
+ E-2 I T0 w d A2

3 w2
sol2 = u2 -> Function@8T0, T1, T2<, sol2p  EvaluateD;
Substituting sol1 and sol2 into the third-order equation, eqOrder[3], we obtain
order3Eq = eqOrder@3D . sol1 . sol2  ExpandAll;
Converting the terms  that produce small-divisor terms into terms  that produce secular terms  and then eliminating the secular
terms from u3 demands that
SCond2 =
CoefficientAorder3Eq@@2DD . expRule1 . W -> 1
3
 w, Exp@I w T0DE == 0 . D@SCond1Rule, T1D;
SCond2 . displayRule
-6 A a L2 - EI T2 s a L3 + 212 A d2 L2

35 w2
+ 18 EI T2 s d2 L3

5 w2
- 2 I A m w - 3 A2 a A + 10 A2 d2 A

3 w2
- 2 I w HD2AL == 0
 4.2.4 Secondary Resonances Due to Quadratic Nonlinearities
In this  case W is away from w and small-divisor terms first appear at OHe2L. We scale the damping m‘  and forcing F so that the
damping term and resonance terms appear at the same order as the quadratic nonlinearity; that is,
scaling = 8F -> e f, m‘ -> e m<;
eq424a =
HFDuffingEq . scaling . multiScalesRule . solRule  ExpandAllL . en_;n>maxOrder+1 -> 0;
eq424a . displayRule
2 e2 m HD0u1L + 2 e3 m HD0u2L + e HD0
2u1L + e2 HD0
2u2L + e3 HD0
2u3L +
2 e3 m HD1u1L + 2 e2 HD0 D1u1L + 2 e3 HD0 D1u2L + e3 HD1
2u1L + 2 e3 HD0 D2u1L +
e w2 u1 + d e2 u1
2 + a e3 u1
3 + e2 w2 u2 + 2 d e3 u1 u2 + e3 w2 u3 == f e Cos@T0 WD
Equating coefficients of like powers of e, we obtain
eqEps = CoefficientList@Subtract  eq424a, eD == 0  Thread  Rest  TrigToExp;
To place the linear operator on one side and the nonhomogeneous terms on the other side, we define
eqOrder@i_D := HeqEps@@1, 1DD . f -> 0 . u1 -> uiL - # &  eqEps@@iDD  Reverse
Chapter4.nb
87

Using eqOrder[i] and displayRule, we rewrite eqEps in a concise way as
Array@eqOrder, 3D . displayRule  TableForm
D0
2u1 + w2 u1 ==
12 HE-I T0 W + EI T0 WL f
D0
2u2 + w2 u2 == -2 m HD0u1L - 2 HD0 D1u1L - d u1
2
D0
2u3 + w2 u3 == -2 m HD0u2L - 2 m HD1u1L - 2 HD0 D1u2L - D1
2u1 - 2 HD0 D2u1L - a u1
3 - 2 d u1 u2
The particular solution of eqOrder[1] can be expressed as
sol1p = DSolve@eqOrder@1D, u1  timeScales, timeScalesD@@1DD . C@_D -> H0 &L  Simplify
:u1@T0, T1, T2D ﬁ- E-I T0 W H1 + E2 I T0 WL f


2 H-w2 + W2L
>
fRule = f -> -2 I-w2 + W2M L;
The general solution of eqOrder[1] can be written in pur function form as
sol1 = u1 -> FunctionA8T0, T1, T2<,
A@T1, T2D Exp@I w T0D + A@T1, T2D Exp@-I w T0D + sol1p@@1, 2DD . fRule  Expand  EvaluateE
u1 ﬁFunction@8T0, T1, T2<, E-I T0 W L + EI T0 W L + EI T0 w A@T1, T2D + E-I T0 w A@T1, T2DD
Substituting sol1 into eqOrder[2] yields
order2Eq = eqOrder@2D . sol1  ExpandAll;
order2Eq . displayRule
D0
2u2 + w2 u2 == -A2 E2 I T0 w d - 2 A EI T0 w-I T0 W d L - 2 A EI T0 w+I T0 W d L - 2 d L2 - E-2 I T0 W d L2 -
E2 I T0 W d L2 - 2 I A EI T0 w m w + 2 I E-I T0 W L m W - 2 I EI T0 W L m W - 2 A d A - 2 E-I T0 w-IT0 W d L A -
2 E-I T0 w+I T0 W d L A + 2 I E-I T0 w m w A - E-2 I T0 w d A2 - 2 I EI T0 w w HD1AL + 2 I E-I T0 w w HD1AL
 The Case W » 2 w
To express the nearness of W to 2 w, we introduce a detuning parameter s = OH1L defined by
OmgRule = 8W -> 2 w + e s<;
sigRule = Solve@OmgRule . Rule -> Equal, sD@@1DD
9s ﬁ- 2 w - W

e
=
expRule2 = 8Exp@arg_D :> Exp@Expand@arg . OmgRuleD . e T0 -> T1D<;
Converting the terms  that produce small-divisor terms into terms  that produce secular terms  and then eliminating the secular
terms from u2 demands that
88
Chapter4.nb

SCond1 = Coefficient@order2Eq@@2DD . expRule2, Exp@I w T0DD == 0;
SCond1 . displayRule
-2 I A m w - 2 EI T1 s d L A - 2 I w HD1AL == 0
or 
SCond1Rule = ISolveASCond1, AH1,0L@T1, T2DE@@1DD  ExpandAllM;
SCond1Rule . displayRule
:D1A ﬁ-A m + I EI T1 s d L A

w
>
Substituting sigRule into SCond1Rule yields
SCond1Rulem = SCond1Rule . Exp@a_D :> Exp@a . sigRule . T1 -> e T0  ExpandD;
SCond1Rulem . displayRule
:D1A ﬁ-A m + I E-2 I T0 w+I T0 W d L A


w
>
whose complex conjugate is
ccSCond1Rulem = SCond1Rulem . conjugateRule;
Substituting these conditions into order2Eq yields
order2Eqm = order2Eq . SCond1Rulem . ccSCond1Rulem  ExpandAll;
order2Eqm . displayRule
D0
2u2 + w2 u2 == -A2 E2 I T0 w d - 2 A EI T0 w+I T0 W d L - 2 d L2 - E-2 IT0 W d L2 -
E2 I T0 W d L2 + 2 I E-I T0 W L m W - 2 I EI T0 W L m W - 2 A d A - 2 E-I T0 w-I T0 W d L A - E-2 IT0 w d A2
Transforming order2Eqm into an ordinary-differential equation, we can obtain the particular solution as
sol2p =
Hu2@T0D . DSolve@Horder2Eqm@@1DD . u2 -> Hu2@#1D &LL == #, u2@T0D, T0D@@1DD . C@_D -> 0 
TrigToExpL &  order2Eqm@@2DD;
sol2p . displayRule
A2 E2 I T0 w d

3 w2
- 2 d L2

w2
- 2 I E-I T0 W L m W

H-w + WL Hw + WL
+
2 I EI T0 W L m W

H-w + WL Hw + WL
+ 2 A EI T0 Hw+WL d L

W H2 w + WL
+
E-2 I T0 W d L2


H-w+ 2 WL Hw + 2 WL
+
E2 I T0 W d L2


H-w + 2 WL Hw + 2 WL
- 2 A d A

w2
+ 2 E-I T0 Hw+WL d L A

W H2 w + WL
+ E-2I T0 w d A2

3 w2
sol2 = u2 -> Function@8T0, T1, T2<, sol2p  EvaluateD;
Then, using sol1 and sol2 in eqOrder[3], we have
order3Eq = eqOrder@3D . sol1 . sol2  ExpandAll;
Chapter4.nb
89

Converting the terms  that produce small-divisor terms into terms  that produce secular terms  and then eliminating the secular
terms from u3 demands that
SCond2 =
Coefficient@order3Eq@@2DD . expRule2 . W -> 2 w, Exp@I w T0DD == 0 . D@SCond1Rule, T1D .
SCond1Rule . HSCond1Rule . conjugateRuleL  ExpandAll;
SCond2 . displayRule
-6 A a L2 + A m2 + 5 A d2 L2

2 w2
- 3 A2 a A + 10 A2 d2 A

3 w2
- 8 I EI T1 s d L m A

3 w
+ EI T1 s d L s A

w
- 2 I w HD2AL == 0
or
SCond2Rule = SolveASCond2, AH0,1L@T1, T2DE@@1DD  ExpandAll;
SCond2Rule . displayRule
:D2A ﬁ- 5 I A d2 L2

4 w3
+ 3 I A a L2

w
- I A m2

2 w
- 5 I A2 d2 A

3 w3
- 4 EI T1 s d L m A

3 w2
- I EI T1 s d L s A

2 w2
+ 3 I A2 a A

2 w
>
The two partial-differential equations, SCond1Rule and SCond2Rule, can be reconstituted to obtain  an ordinary-differential
equation governing A. The result is
H2 I w A¢ == H2 I w dt@1D@A@T1, T2DD . SCond1Rule . SCond2Rule  Expand  Collect@#, eD &LL .
displayRule
2 I w A¢ == e H-2 I A m w - 2 EI T1 s d L AL +
e2 i
k
jjjj-6 A a L2 + A m2 + 5 A d2 L2

2 w2
- 3 A2 a A + 10 A2 d2 A

3 w2
- 8 I EI T1 s d L m A

3 w
+ EI T1 s d L s A

w
y
{
zzzz
 4.2.5 First-Order Real-Valued System
As in Section 4.2.4 , we determine a second-order uniform expansion of the solution of the FDuffingEq for the case of subhar-
monic resonance  of order one-half.  However, instead of treating the second-order form of this  equation, we treat its corre-
sponding first-order form;  that is, we first transform it into a system of two real-valued first-order equations. To this end, we
introduce the transformation
vRule = u¢@tD -> v@tD;
In  order that  the  influence  of the  nonlinearity  and  damping  balance  the  subharmonic  resonance,  we  scale  the  damping
coefficient m‘  and forcing amplitude F as
scaling = 8F -> e f, m‘ -> e m<;
Using the scaling and vRule, we transform the FDuffingEq into the following system of two real-valued first-order equations:
eq425a = 8vRule . Rule -> Equal, FDuffingEq . scaling . vRule . D@vRule, tD<
8u¢@tD == v@tD, w2 u@tD + d u@tD2 + a u@tD3 + 2 e m v@tD + v¢@tD == f e Cos@t WD<
90
Chapter4.nb

To  determine  a  second-order uniform  expansion  of the  solution  of eq425a  using  the  method  of multiple  scales, we  first
transform these equations  from ordinary-differential equations  into partial-differential equations  in  terms  of the  three time
scales T0, T1, and T2 according to
multiScales =
8u@tD -> u@T0, T1, T2D, v@tD -> v@T0, T1, T2D, u_¢@tD -> dt@1D@u@T0, T1, T2DD, t -> T0<;
Next, we expand u and v in the form
solRule = 9u -> ISumAej uj@#1, #2, #3D, 8j, 3<E &M, v -> ISumAej vj@#1, #2, #3D, 8j, 3<E &M=;
Substituting multiScales and solRule into eq425a, expanding the result for small e, and discarding terms of order higher than
e3, we obtain
eq425b = Heq425a . multiScales . solRule  ExpandAllL . en_;n>3 -> 0;
Equating coefficients of like powers of e in eq425b yields
eqEps = Thread@CoefficientList@Subtract  #, eD == 0D &  eq425b  Transpose  Rest 
TrigToExp;
To place the linear operator on one side and the nonhomogeneous terms on the other side, we define
linearSys = #@@1DD &  eqEps@@1DD . f -> 0;
linearSys . displayRule
8D0u1 - v1, D0v1 + w2 u1<
eqOrder@i_D :=
HlinearSys . u_1 -> uiL == HlinearSys . u_1 -> uiL - H#@@1DD &  eqEps@@iDDL  Thread
Using eqOrder[i] and the displayRule, we rewrite eqEps in a concise way as
eqOrder@1D . displayRule  TableForm
eqOrder@2D . displayRule  TableForm
eqOrder@3D . displayRule  TableForm
D0u1 - v1 == 0
D0v1 + w2 u1 ==
12 HE-I T0 W + EI T0 WL f
D0u2 - v2 == -HD1u1L
D0v2 + w2 u2 == -HD1v1L - d u1
2 - 2 m v1
D0u3 - v3 == -HD1u2L - D2u1
D0v3 + w2 u3 == -HD1v2L - D2v1 - a u13 - 2 d u1 u2 - 2 m v2
 First-Order Equations: Linear System
We seek a solution of the linearSys in the form u1 = P EI w T0 and v1 = QEI w T0  and obtain
Chapter4.nb
91

coefList = E-I w T0 linearSys . 9u1 -> IP EI w # &M, v1 -> IQ EI w # &M=  Expand
8-Q +I P w, I Q w + P w2<
The coefficient matrix of coefList is
coefMat = Outer@Coefficient, coefList, 8P, Q<D
88I w, -1<, 8w2, I w<<
whose adjoint is defined by
hermitian@mat_? MatrixQD := mat . conjugateRule  Transpose
Hence, the right and left eigenvectors of coefMat are
rightVec = 81, c1< . Solve@HcoefMat.81, c1<L@@1DD == 0, c1D@@1DD
81, I w<
leftVec = 8c1, 1< . Solve@Hhermitian@coefMatD.8c1, 1<L@@1DD == 0, c1D@@1DD
8-I w, 1<
The complex conjugate of leftVec is
ccleftVec = leftVec . conjugateRule
8I w, 1<
Thefore, the homogeneous solution of eqOrder[1] is given by
sol1h = # + H# . conjugateRuleL &  IrightVec A@T1, T2D EI w T0M
8EI T0 w A@T1, T2D + E-I T0 w A@T1, T2D, I EI T0 w w A@T1, T2D - I E-I T0 w w A@T1, T2D<
Transforming  eqOrder[1]  into  ordinary-differential  equations  and  using  DSolve,  we  obtain  the  particular  solution  of
eqOrder[1] as
sol1p = DSolve@eqOrder@1D . 8u1 -> Hu1@#1D &L, v1 -> Hv1@#1D &L<, 8u1@T0D, v1@T0D<, T0D@@1DD .
C@_D -> 0  TrigToExp  Simplify
:u1@T0D ﬁ- E-I T0 W H1 + E2 I T0 WL f


2 H-w2 + W2L
, v1@T0D ﬁ- I E-IT0 W H-1 + E2 IT0 WL f W


2 H-w2 + W2L
>
Then, the general solution of the first-order equations can be expressed in pure function form as
fRule = f -> -2 I-w2 + W2M L;
92
Chapter4.nb

sol1 =
8u1 -> Function@8T0, T1, T2<, sol1h@@1DD + Hu1@T0D . sol1p . fRule  ExpandL  EvaluateD,
v1 -> Function@8T0, T1, T2<, sol1h@@2DD + Hv1@T0D . sol1p . fRule  ExpandL  EvaluateD<
8u1 ﬁFunction@8T0, T1, T2<, E-I T0 W L + EI T0 W L + EI T0 w A@T1, T2D + E-I T0 w A@T1, T2DD,
v1 ﬁFunction@8T0, T1, T2<, -I E-I T0 W L W + I EI T0 W L W + I EI T0 w w A@T1, T2D - I E-I T0 w w A@T1, T2DD<
 Second-Order Equations
Substituting the first-order solution, sol1, into the second-order equations, eqOrder[2], we have
order2Eq = eqOrder@2D . sol1  ExpandAll;
order2Eq . displayRule
:D0u2 - v2 == -EI T0 w HD1AL - E-I T0 w HD1AL,
D0v2 + w2 u2 == -A2 E2 I T0 w d - 2 A EI T0 w-I T0 W d L - 2 A EI T0 w+I T0 W d L - 2 d L2 - E-2 I T0 W d L2 -
E2 I T0 W d L2 - 2 I A EI T0 w m w + 2 I E-I T0 W L m W - 2 I EI T0 W L m W - 2 A d A - 2 E-I T0 w-IT0 W d L A -
2 E-I T0 w+I T0 W d L A + 2 I E-I T0 w m w A - E-2 I T0 w d A2 - I EI T0 w w HD1AL + I E-I T0 w w HD1AL>
To express quantitatively the nearness of the subharmonic resonance of order one-half, we introduce the detuning parameter
s defined by
OmgRule = 8W -> 2 w + e s<;
To convert the terms that produce small-divisor terms into terms that produce secular terms, we use the rule
expRule1 = Exp@arg_D :> Exp@Expand@arg . OmgRuleD . e T0 -> T1D;
To eliminate the terms that produce secular terms  in u2 and v2 (i.e., the solvability condition of order2Eq), we first determine
the vector proportional to EI w T0 in the right-hand sides of order2Eq and obtain
STerms1 = Coefficient@#@@2DD . expRule1, Exp@I w T0DD &  order2Eq
8-AH1,0L@T1, T2D, -2 I m w A@T1, T2D - 2 EIT1 s d L A@T1, T2D - I w AH1,0L@T1, T2D<
Then, the  solvability condition  of order2Eq demands  that  STerms1  be  orthogonal to  the  solution of the  adjoint;  that is,
ccleftVec. The result is
SCond1 = SolveAccleftVec.STerms1 == 0, AH1,0L@T1, T2DE@@1DD
:AH1,0L@T1, T2D ﬁ- m w A@T1, T2D - I EI T1 s d L A@T1, T2D



w
>
whose complex conjugate is
ccSCond1 = SCond1 . conjugateRule
:AH1,0L@T1, T2D ﬁ- I E-I T1 s d L A@T1, T2D + m w A@T1, T2D



w
>
Chapter4.nb
93

Next, we use the solvability condition to eliminate D1 A and its complex conjugate from order2Eq and then find their particu-
lar solution. To simplify the resulting equations using Mathematica, we need to replace T1 with eT0. To this end, we express
the detuning parameter s in terms of w and W as
sigRule = Solve@OmgRule . Rule -> Equal, sD@@1DD
9s ﬁ- 2 w - W

e
=
and define the rule
expRule2 = Exp@a_D :> Exp@a . T1 -> e T0 . sigRule  ExpandD;
This rule enables us to rewrite SCond1 and ccSCond1 as
SCond1f = Join@SCond1, ccSCond1D . expRule2;
SCond1f . displayRule
:D1A ﬁ- A m w - I E-2 I T0 w+I T0 W d L A


w
, D1A ﬁ- I A E2I T0 w-I T0 W d L + m w A


w
>
With this form of the solvability condition, order2Eq becomes
order2Eqm = order2Eq . SCond1f  ExpandAll;
order2Eqm . displayRule
:D0u2 - v2 == A EI T0 w m + I A EI T0 w-I T0 W d L

w
+ E-I T0 w m A - I E-I T0 w+I T0 W d L A


w
,
D0v2 + w2 u2 == -A2 E2 I T0 w d - A EI T0 w-IT0 W d L - 2 A EI T0 w+I T0 W d L - 2 d L2 -
E-2 I T0 W d L2 - E2 I T0 W d L2 - I A EI T0 w m w + 2 I E-IT0 W L m W - 2 I EI T0 W L m W -
2 A d A - 2 E-I T0 w-I T0 W d L A - E-I T0 w+I T0 W d L A + I E-I T0 w m w A - E-2 I T0 w d A2>
Next, we use the method of undetermined coefficients  to determine the particular solution of order2Eqm. To accomplish this,
we first identify the form of their nonhomogeneous terms, which we will refer to as possible terms, and then seek the solution
as a linear combination of them. Substituting this solution into order2Eqm and equating the coefficient of each possible  term
to zero, we obtain a set of pairs of algebraic equations that need to be solved for the unknown  coefficients. The solutions of
these pairs  are unique  except for the coefficients  of EI w T0  and  E-I w T0. To  determine a  unique solution corresponding  to
these terms, we use two different approaches.
Approach 1:
In the first approach, we replace w with another symbol, say w0, find the solution of the system of algebraic equations, and
then take the limit as w0 tends to w. To accomplish this, we define
collectForm = 9EI T0 w A@T1, T2D, E-I T0 w A@T1, T2D, EI T0 W L, E-I T0 W L=;
Then, the form of the possible terms on the right-hand sides of order2Eqm can be determined as
94
Chapter4.nb

possibleTerms =
HcollectForm . w -> w0L ~Join~ HOuter@Times, collectForm, collectFormD  Flatten  UnionL
:EI T0 w0 A@T1, T2D, E-I T0 w0 A@T1, T2D, EI T0 W L, E-I T0 W L, L2, E-2 I T0 W L2,
E2 I T0 W L2, EI T0 w-I T0 W L A@T1, T2D, EI T0 w+I T0 W L A@T1, T2D, E2 I T0 w A@T1, T2D2,
E-I T0 w-I T0 W L A@T1, T2D, E-I T0 w+IT0 W L A@T1, T2D, A@T1, T2D A@T1, T2D, E-2 I T0 w A@T1, T2D
2>
Next, we associate with each possible term an undetermined coefficient in u2 by
symbolList1 = Table@Gi, 8i, Length@possibleTermsD<D
8G1, G2, G3, G4, G5, G6, G7, G8, G9, G10, G11, G12, G13, G14<
and an undetermined coefficient in v2 by
symbolList2 = symbolList1 . G -> L
8L1, L2, L3, L4, L5, L6, L7, L8, L9, L10, L11, L12, L13, L14<
Then, we seek a particular solution of order2Eqm in the form
sol2Rule = 8u2 -> Function@8T0, T1, T2<, symbolList1.possibleTerms  EvaluateD,
v2 -> Function@8T0, T1, T2<, symbolList2.possibleTerms  EvaluateD<;
Substituting sol2Rule into order2Eqm and replacing E–I w T0 on the right-hand sides of order2Eqm by E–I w0 T0, we have
order2Eqf = Subtract  # &  order2Eqm . sol2Rule .
8Exp@I w T0D -> Exp@I w0 T0D, Exp@-I w T0D -> Exp@-I w0 T0D<  Expand;
Applying directly the function Coefficient to collect the coefficients of all possibleTerms could result  in extra terms  that are
functions of T0 ,which we eliminate. The result is
algEqs = Flatten@Coefficient@order2Eqf, #D &  possibleTermsD == 0 . Exp@_ T0D -> 0  Thread
9-m -L1 + I G1 w0 == 0, I m w + w2 G1 + I L1 w0 == 0, -m - L2 - I G2 w0 == 0,
-I m w + w2 G2 - I L2 w0 == 0, I W G3 - L3 == 0, 2 I m W + w2 G3 + I W L3 == 0, -I W G4 - L4 == 0,
-2 I m W + w2 G4 - I W L4 == 0, -L5 == 0, 2 d + w2 G5 == 0, -2 I W G6 - L6 == 0,
d + w2 G6 - 2 I W L6 == 0, 2 I W G7 - L7 == 0, d + w2 G7 + 2 I W L7 == 0, - I d

w
+ I w G8 - I W G8 - L8 == 0,
d + w2 G8 + I w L8 - I W L8 == 0, I w G9 + I W G9 - L9 == 0, 2 d + w2 G9 + I w L9 + I W L9 == 0,
2 I w G10 - L10 == 0, d + w2 G10 + 2 I w L10 == 0, -I w G11 - I W G11 - L11 == 0,
2 d + w2 G11 - I w L11 - I W L11 == 0, I d

w
- I w G12 + I W G12 - L12 == 0, d + w2 G12 - I w L12 + I W L12 == 0,
-L13 == 0, 2 d + w2 G13 == 0, -2 I w G14 - L14 == 0, d + w2 G14 - 2 I w L14 == 0=
Using the function Solve, we directly solve the system of algebraic equations algEqs for these undetermined coefficients and
obtain
var = Join@symbolList1, symbolList2D;
Chapter4.nb
95

coefs = Solve@algEqs, varD@@1DD;
Substituting coefs into sol2Rule and changing w0  back to w, we obtain  the solution of the second-order equations in pure
function form as
sol2a = sol2Rule . Function@8T0, T1, T2<, b_D :>
Function@8T0, T1, T2<  Evaluate, b . coefs . w0 -> w  EvaluateD;
sol2a . displayRule
:u2 ﬁFunctionB8T0, T1, T2<, - 2 d L2

w2
- E-2 I T0 W d L2

w2 - 4 W2
- E2 I T0 W d L2

w2 - 4 W2
+ 2 I E-I T0 W L m W

w2 - W2
-
2 I EIT0 W L m W

w2 - W2
- I EI T0 w m A

2 w
- EIT0 w-I T0 W d L A

w W
+ 2 EI T0 w+I T0 W d L A

W H2 w + WL
+ E2 I T0 w d A2

3 w2
+
I E-IT0 w m A

2 w
- E-I T0 w+I T0 W d L A

w W
+ 2 E-IT0 w-I T0 W d L A


W H2 w + WL
- 2 d A A

w2
+ E-2 IT0 w d A2

3 w2
F,
v2 ﬁFunctionB8T0, T1, T2<, 2 I E-2 I T0 W d L2 W

w2 - 4 W2
- 2 I E2 I T0 W d L2 W

w2 - 4 W2
+ 2 E-IT0 W L m W2

w2 - W2
+
2 EI T0 W L m W2

w2 - W2
- 1
2
EI T0 w m A - I EI T0 w-I T0 W d L A

W
+ 2 I EI T0 w+I T0 W d L Hw + WL A


W H2 w + WL
+ 2 I E2I T0 w d A2

3 w
-
1
2
E-I T0 w m A + I E-I T0 w+I T0 W d L A


W
- 2 I E-I T0 w-I T0 W d L Hw + WL A


W H2 w + WL
- 2 I E-2 I T0 w d A2

3 w
F>
Approach 2:
As discussed above,  solutions of the algebraic equations  resulting from applying the method of undetermined coefficients
are unique except those corresponding to EI w T0  and E-I w T0. To render them unique, we demand that they be orthogonal to
solutions  of the  corresponding  adjoint  problems;  that  is, we  damand  that  the  coefficient  vector of EI w T0  be  8u2 , v2< be
orthogonal to  ccleftVec. To  accomplish  this, we  first determine  the  form of all possible  terms  on  the  right-hand  sides  of
order2Eqm and then identify those among them corresponding to the resonance terms and those corresponding to nonreso-
nance terms.
possibleTerms =
collectForm ~ Join~HOuter@Times, collectForm, collectFormD  Flatten  UnionL
:EI T0 w A@T1, T2D, E-I T0 w A@T1, T2D, EIT0 W L, E-I T0 W L, L2, E-2 I T0 W L2,
E2 I T0 W L2, EI T0 w-I T0 W L A@T1, T2D, EI T0 w+I T0 W L A@T1, T2D, E2 I T0 w A@T1, T2D2,
E-I T0 w-I T0 W L A@T1, T2D, E-I T0 w+IT0 W L A@T1, T2D, A@T1, T2D A@T1, T2D, E-2 I T0 w A@T1, T2D
2>
Next, we identify the resonance terms among them by
RT = I# . 8a_ ; a =!= 0 -> 1< &  IE-I wT0 possibleTerms . expRule1 . Exp@_ T0 + _.D -> 0MM
possibleTerms  Union  Rest
8EI T0 w A@T1, T2D, E-I T0 w+IT0 W L A@T1, T2D<
96
Chapter4.nb

Hence, the nonresonance part of possibleTerms is the complement of RT; that is,
NRT = Complement@possibleTerms, Join@RT, RT . conjugateRuleDD
:E-I T0 W L, EI T0 W L, L2, E-2 I T0 W L2, E2 I T0 W L2, EI T0 w+I T0 W L A@T1, T2D,
E2 I T0 w A@T1, T2D2, E-I T0 w-I T0 W L A@T1, T2D, A@T1, T2D A@T1, T2D, E-2I T0 w A@T1, T2D
2>
Next, we associate with each possible resonance term an undetermined coefficient by using the rule
RTsymbolList = Table@Gj, 8j, Length@RTD<D
8G1, G2<
and we associate with each possible nonresonance term an undetermined coefficient by using the rule
NRTsymbolList@i_D = Table@Li,j, 8j, Length@NRTD<D
8Li,1, Li,2, Li,3, Li,4, Li,5, Li,6, Li,7, Li,8, Li,9, Li,10<
Hence, the coefficients of RT in the nonhomogeneous terms in order2Eqm are
coefRT = Coefficient@#@@2DD, RTD &  order2Eqm . Exp@_ T0 + _.D -> 0
99m, - I d

w
=, 8-I m w, -d<=
It follows from
ccleftVec.coefRT === 80, 0<
True
that coefRT is orthogonal to the solution of the adjoint, ccleftVec, as it should.
Imposing the condition that {u2 , v2} is orthogonal to ccleftVec, we seek u2 and v2 in pure function form as
sol2Form = 8
u2 -> Function@8T0, T1, T2<, RTsymbolList.RT +
HRTsymbolList.RT . conjugateRuleL + NRTsymbolList@1D.NRT  EvaluateD, v2 ->
Function@8T0, T1, T2<, -I w RTsymbolList.RT + H-I w RTsymbolList.RT . conjugateRuleL +
NRTsymbolList@2D.NRT  EvaluateD<;
Substituting sol2Form into order2Eqm and collecting coefficients of NRT, we obtain the following set of algebraic equations:
Chapter4.nb
97

algEqs1 = HCoefficient@Subtract  #, NRTD &  Horder2Eqm . sol2FormL . Exp@_ T0D -> 0 
FlattenL == 0  Thread
8-I W L1,1 - L2,1 == 0, I W L1,2 - L2,2 == 0, -L2,3 == 0, -2 I W L1,4 - L2,4 == 0,
2 I W L1,5 - L2,5 == 0, I w L1,6 + I W L1,6 - L2,6 == 0, 2 I w L1,7 - L2,7 == 0,
-I w L1,8 - I W L1,8 - L2,8 == 0, -L2,9 == 0, -2 I w L1,10 - L2,10 == 0, -2 I m W + w2 L1,1 - I W L2,1 == 0,
2 I m W + w2 L1,2 + I W L2,2 == 0, 2 d + w2 L1,3 == 0, d + w2 L1,4 - 2 I W L2,4 == 0,
d + w2 L1,5 + 2 I W L2,5 == 0, 2 d + w2 L1,6 + I w L2,6 + I W L2,6 == 0, d + w2 L1,7 + 2 I w L2,7 == 0,
2 d + w2 L1,8 - I w L2,8 - I W L2,8 == 0, 2 d + w2 L1,9 == 0, d + w2 L1,10 - 2 I w L2,10 == 0<
Solving algEqs1 for the undetermined coefficients NRTsymbolList yields
coef1 = Solve@algEqs1, Array@NRTsymbolList, 2D  FlattenD@@1DD
:L2,9 ﬁ0, L1,3 ﬁ- 2 d

w2 , L1,9 ﬁ- 2 d

w2 , L2,3 ﬁ0, L1,1 ﬁ2 I m W

w2 - W2 , L1,4 ﬁ-
d

w2 - 4 W2 ,
L1,2 ﬁ- 2 I m W

w2 - W2 , L1,5 ﬁ-
d

w2 - 4 W2 , L2,1 ﬁ
2 m W2

w2 - W2 , L1,7 ﬁ
d

3 w2 , L2,2 ﬁ
2 m W2

w2 - W2 ,
L2,5 ﬁ- 2 I d W

w2 - 4 W2 , L1,10 ﬁ
d

3 w2 , L2,10 ﬁ- 2 I d

3 w
, L2,4 ﬁ
2 I d W

w2 - 4 W2 , L2,7 ﬁ2 I d

3 w
,
L2,6 ﬁ2 I d Hw + WL

W H2 w + WL
, L1,6 ﬁ
2 d

W H2 w + WL
, L1,8 ﬁ
2 d

2 w W + W2 , L2,8 ﬁ- 2 I d Hw + WL

2 w W + W2
>
Substituting sol2Form into either of the two order2Eqm and collecting the coefficients of RT, we obtain the following set of
algebraic equations:
algEqs2 =
Coefficient@Subtract  order2Eqm@@1DD . sol2Form, RTD == 0 . Exp@_ T0D -> 0  Thread
9-m +2 I w G1 == 0, I d

w
+ I W G2 == 0=
Solving algEqs2 for the undetermined coefficients RTsymbolList yields
coef2a = Solve@algEqs2, RTsymbolListD@@1DD
9G1 ﬁ- I m

2 w
, G2 ﬁ-
d

w W
=
coef2 = Join@coef2a, coef2a . conjugateRuleD
9G1 ﬁ- I m

2 w
, G2 ﬁ-
d

w W
, G
1 ﬁI m

2 w
, G
2 ﬁ- d

w W
=
Substituting coef1 and coef2 into sol2Form, we obtain the solution of the second-order equations in pure function form as
98
Chapter4.nb

sol2b = sol2Form . Function@8T0, T1, T2<, b_D :>
Function@8T0, T1, T2<  Evaluate, b . coef1 . coef2  Expand  EvaluateD;
sol2b . displayRule
:u2 ﬁFunctionB8T0, T1, T2<, - 2 d L2

w2
- E-2 I T0 W d L2

w2 - 4 W2
- E2 I T0 W d L2

w2 - 4 W2
+ 2 I E-I T0 W L m W

w2 - W2
-
2 I EIT0 W L m W

w2 - W2
- I EI T0 w m A

2 w
- EIT0 w-I T0 W d L A

w W
+ 2 EI T0 w+I T0 W d L A

W H2 w + WL
+ E2 I T0 w d A2

3 w2
+
I E-IT0 w m A

2 w
- E-I T0 w+I T0 W d L A

w W
+ 2 E-IT0 w-I T0 W d L A


2 w W + W2
- 2 d A A

w2
+ E-2 IT0 w d A2

3 w2
F,
v2 ﬁFunctionB8T0, T1, T2<, 2 I E-2 I T0 W d L2 W

w2 - 4 W2
- 2 I E2 I T0 W d L2 W

w2 - 4 W2
+ 2 E-IT0 W L m W2

w2 - W2
+
2 EI T0 W L m W2

w2 - W2
- 1
2
EI T0 w m A - I EI T0 w-I T0 W d L A

W
+ 2 I EI T0 w+I T0 W d L A


2 w + W
+
2 I EIT0 w+I T0 W d L w A


W H2 w + WL
+ 2 I E2 I T0 w d A2

3 w
- 1
2
E-IT0 w m A + I E-I T0 w+IT0 W d L A


W
-
2 I E-I T0 w-I T0 W d L w A


2 w W + W2
- 2 I E-I T0 w-I T0 W d L W A


2 w W + W2
- 2 I E-2 I T0 w d A2

3 w
F>
These two approaches generate the same results because
Subtract  Hu2@T0, T1, T2D . 8sol2a, sol2b<L  Simplify
0
Subtract  Hv2@T0, T1, T2D . 8sol2a, sol2b<L  Simplify
0
The second approach is more convenient to use for a general system of equations. Hence, we will adopt this approach in the
remainder of this book.
 Third-Order Equations
Substituting the first- and second-order solutions into the third-order equations, eqOrder[3], yields
order3Eq = eqOrder@3D . sol1 . sol2b  ExpandAll;
Using the expRule1 to convert  the terms  that produce small-divisor terms  into terms  that produce secular terms  in the right-
hand sides of order3Eq and collecting the terms that could produce secular terms, we have
Chapter4.nb
99

STerms2 = Coefficient@#@@2DD . expRule1 . W -> 2 w, Exp@I w T0DD &  order3Eq;
STerms2 . displayRule
: I m HD1AL

2 w
+ EI T1 s d L HD1AL

2 w2
- D2A, -6 A a L2 + A m2 + 9 A d2 L2

2 w2
- 3 A2 a A +
10 A2 d2 A

3 w2
- 14 I EI T1 s d L m A

3 w
+ 1
2
m HD1AL - I EI T1 s d L HD1AL

2 w
- I w HD2AL>
Then, the solvability condition demands that STerms2 be orthogonal to the solution of the adjoint ccleftVec. The result is
SCond2 = SolveAccleftVec.STerms2 == 0, AH0,1L@T1, T2DE@@1DD  ExpandAll;
SCond2 . displayRule
:D2A ﬁ- 9 I A d2 L2

4 w3
+ 3 I A a L2

w
- I A m2

2 w
- 5 I A2 d2 A

3 w3
- 7 EI T1 s d L m A

3 w2
+ 3 I A2 a A

2 w
>
The two partial-differential equations, SCond1 and SCond2, can be reconstituted to obtain  an ordinary-differential equation
governing A. The result is
H2 I w A¢ == H2 I w dt@1D@A@T1, T2DD . SCond1 . SCond2  Expand  Collect@#, eD &LL .
displayRule
2 I w A¢ ==
e H-2 I A m w - 2 EI T1 s d L AL + e2 i
k
jjj-6 A a L2 + A m2 + 9 A d2 L2

2 w2
- 3 A2 a A + 10 A2 d2 A

3 w2
- 14 I EI T1 s d L m A

3 w
y
{
zzz
 4.2.6 First-Order Complex-Valued System
In this section, we first transform FDuffingEq into a single first-order complex-valued equation using the transformation
transformRule = 9u -> Iz + zM, u¢ -> I w Iz - zM=;
gRule = g -> - 2 e m u¢ - d u2 - a u3 + e f Cos@W tD;
then FDuffingEq becomes
eq426a = z¢ == I w z -
I

2 w
g . gRule . transformRule  ExpandAll
z¢ == -e z m + I d z2

2 w
+ I a z3

2 w
+ I z w -
I f e Cos@t WD

2 w
+ e m z + I d z z

w
+ 3 I a z2 z

2 w
+ I d z2

2 w
+ 3 I a z z2

2 w
+ I a z3

2 w
To  determine  a  second-order uniform  expansion  of the  solution  of eq426a  using  the  method  of multiple  scales, we  first
introduce
multiScales = 9z -> z@T0, T1, T2D, z -> z@T0, T1, T2D, z¢ -> dt@1D@z@T0, T1, T2DD, t -> T0=;
100
Chapter4.nb

and then expand z and z in the form
solRule =
9z -> ISumAej zj@#1, #2, #3D, 8j, 1, 3<E &M, z -> ISumAej z
j@#1, #2, #3D, 8j, 1, 3<E &M=;
Substituting multiScales and solRule into eq426a, expanding the result for small e, and discarding terms of order higher than
e3, we obtain
eq426b = Heq426a . multiScales . solRule  ExpandAllL . en_;n>3 -> 0;
Equating coefficients of like powers of e yields
eqEps = CoefficientList@Subtract  eq426b, eD == 0  Thread  Rest  TrigToExp;
To place the linear operator on one side and the nonhomogeneous terms on the other side, we define
eqOrder@i_D := HeqEps@@1, 1DD . f -> 0 . z1 -> ziL - # &  eqEps@@iDD  Reverse
Using eqOrder[i] and displayRule, we rewrite eqEps in a concise way as
Array@eqOrder, 3D . displayRule  TableForm
D0z1 - I w z1 == - I HE-I T0 W+EI T0 WL f

4 w
D0z2 - I w z2 == -HD1z1L - m z1 + I d z12

2 w
+ m z
1 + I d z1 z
1

w
+ I d z
1
2

2 w
D0z3 - I w z3 == -HD1z2L - D2z1 + I a z13

2w
- m z2 + I d z1 z2

w
+ 3I a z12 z
1

2 w
+ I d z2 z
1

w
+ 3 I a z1 z
1
2

2 w
+ I a z
1
3

2 w
+ m z
2 + I d z1 z
2

w
The general solution of the first-order equation, eqOrder[1], can be expressed in pure function form as
sol1Form =
HDSolve@eqOrder@1D, z1@T0, T1, T2D, timeScalesD@@1, 1, 2DD . C@1D -> A  ExpandL .
Exp@a_D :> Exp@a  ExpandD . c1_ Exp@x_D + c2_ Exp@x_D :> Factor@c1 + c2D Exp@xD
EI T0 W f

4 w Hw- WL
+
E-I T0 W f

4 w Hw + WL
+ EI T0 w A@T1, T2D
sol1 = 9z1 -> Function@8T0, T1, T2<, sol1Form  EvaluateD,
z
1 -> Function@8T0, T1, T2<, sol1Form . conjugateRule  EvaluateD=
:z1 ﬁFunctionB8T0, T1, T2<,
EI T0 W f

4 w Hw - WL
+
E-I T0 W f

4 w Hw + WL
+ EI T0 w A@T1, T2DF,
z
1 ﬁFunctionB8T0, T1, T2<,
E-I T0 W f

4 w Hw - WL
+
EI T0 W f

4 w Hw + WL
+ E-IT0 w A@T1, T2DF>
Substituting the first-order solution into the second-order equation, eqOrder[2], we have
Chapter4.nb
101

order2Eq = Expand  HeqOrder@2D . sol1L;
order2Eq . displayRule
D0z2 - I w z2 ==
-A EI T0 w m + I A2 E2 I T0 w d

2 w
+
I f2 d

16 w3 Hw - WL2 + I E-2 I T0 W f2 d

32 w3 Hw - WL2 + I E2 IT0 W f2 d

32 w3 Hw - WL2 + I A EI T0 w-I T0 W f d

4 w2 Hw - WL
+
I A EI T0 w+I T0 W f d

4 w2 Hw - WL
+ E-IT0 W f m

4 w Hw - WL
-
EI T0 W f m

4 w Hw - WL
+
I f2 d

16 w3 Hw + WL2 + I E-2 IT0 W f2 d

32 w3 Hw + WL2 + I E2 I T0 W f2 d

32 w3 Hw + WL2 +
I A EI T0 w-I T0 W f d

4 w2 Hw + WL
+ I A EI T0 w+I T0 W f d

4 w2 Hw + WL
- E-I T0 W f m

4 w Hw + WL
+
EI T0 W f m

4 w Hw + WL
+
I f2 d


8 w3 Hw - WL Hw + WL
+
I E-2 IT0 W f2 d


16 w3 Hw - WL Hw + WL
+
I E2 I T0 W f2 d


16 w3 Hw - WL Hw + WL
+ E-I T0 w m A + I A d A

w
+ I E-I T0 w-I T0 W f d A


4 w2 Hw - WL
+
I E-I T0 w+I T0 W f d A


4 w2 Hw - WL
+ I E-I T0 w-I T0 W f d A


4 w2 Hw + WL
+ I E-I T0 w+I T0 W f d A


4 w2 Hw + WL
+ I E-2 I T0 w d A2

2 w
- EI T0 w HD1AL
Eliminating the terms that lead to secular terms in z2 from order2Eq yields
SCond1 = Coefficient@order2Eq@@2DD . expRule1, Exp@I w T0DD == 0
-m A@T1, T2D + I EI T1 s f d A@T1, T2D


4 w2 Hw - WL
+ I EI T1 s f d A@T1, T2D


4 w2 Hw + WL
- AH1,0L@T1, T2D == 0
or
SCond1Rule =
ISolveASCond1, AH1,0L@T1, T2DE@@1DD  ExpandAllM . c1_ m + c2_ m :> Factor@c1 + c2D m
:AH1,0L@T1, T2D ﬁ-m A@T1, T2D + I EIT1 s f d A@T1, T2D


2 w3 - 2 w W2
>
With this solvability condition, we rewrite order2Eq as
order2Eqm = Expand 
Horder2Eq . SCond1Rule . Exp@arg_D :> Exp@arg . T1 -> e T0 . sigRule  ExpandDL;
There  are at  least two  approaches  we  can use to solve  for the particular solution of order2Eqm. In the  first approach, we
transform order2Eqm into an ordinary-differential equation and then use DSolve and Map to determine the following particu-
lar solution:
102
Chapter4.nb

Hsol2a =
Hz2@T0D . DSolve@Horder2Eqm@@1DD . z2 -> Hz2@#1D &LL == #, z2@T0D, T0D@@1DD . C@_D ->
0L &  order2Eqm@@2DD . Exp@a_D :> Exp@Expand@aDD  ExpandL  Timing
:6.629 Second, -
f2 d

16 w4 Hw - WL2 - I EI T0 W f m

4 w Hw - WL2 -
E2 I T0 W f2 d


32 w3 Hw - 2 WL Hw - WL2 -
f2 d

16 w4 Hw + WL2 -
I E-I T0 W f m

4 w Hw + WL2 -
E2 IT0 W f2 d


32 w3 Hw - 2 WL Hw + WL2 -
f2 d


8 w4 Hw - WL Hw + WL
+
I E-I T0 W f m


4 w Hw - WL Hw + WL
+
I EI T0 W f m


4 w Hw - WL Hw + WL
-
E2 I T0 W f2 d


16 w3 Hw - 2 WL Hw - WL Hw + WL
-
E-2 I T0 W f2 d


32 w3 Hw - WL2 Hw + 2 WL
-
E-2 I T0 W f2 d


32 w3 Hw + WL2 Hw + 2 WL
-
E-2 I T0 W f2 d


16 w3 Hw - WL Hw + WL Hw + 2 WL
- EIT0 w-I T0 W f d A@T1, T2D


4 w2 Hw - WL W
+
EI T0 w+I T0 W f d A@T1, T2D


4 w2 Hw - WL W
- EI T0 w-I T0 W f d A@T1, T2D


4 w2 W Hw + WL
+ EIT0 w+I T0 W f d A@T1, T2D


4 w2 W Hw + WL
+
E2 I T0 w d A@T1, T2D2


2 w2
+ I E-I T0 w m A@T1, T2D


2 w
- E-IT0 w+I T0 W f d A@T1, T2D


4 w2 Hw - WL H2 w - WL
-
E-I T0 w+I T0 W f d A@T1, T2D


4 w2 H2 w - WL Hw + WL
- E-IT0 w-I T0 W f d A@T1, T2D


4 w2 Hw - WL H2 w + WL
- E-I T0 w-IT0 W f d A@T1, T2D


4 w2 Hw + WL H2 w + WL
+
E-I T0 w+I T0 W f d A@T1, T2D


2 w H2 w - WL Hw2 - W2L
- d A@T1, T2D A@T1, T2D


w2
- E-2I T0 w d A@T1, T2D
2


6 w2
>
In the second approach, we multiply order2Eqm by an integrating factor and then use the function Integrate. To reduce the
computation time, we define first the rule
intRule = int@a_ + b_, arg_D -> int@a, argD + int@b, argD;
Then, using this rule and an integrating factor, we find a particular solution of order2Eqm as
Chapter4.nb
103

Hsol2b = HHint@order2Eqm@@2DD * Exp@-I T0 wD  Expand, T0D . intRule . int -> IntegrateL*
Exp@I T0 wD  ExpandL . Exp@a_D :> Exp@Expand@aDDL  Timing
:0.841 Second, -
f2 d

16 w4 Hw - WL2 - I EI T0 W f m

4 w Hw - WL2 -
E2 I T0 W f2 d


32 w3 Hw - 2 WL Hw - WL2 -
f2 d

16 w4 Hw + WL2 -
I E-I T0 W f m

4 w Hw + WL2 -
E2 IT0 W f2 d


32 w3 Hw - 2 WL Hw + WL2 -
f2 d


8 w4 Hw - WL Hw + WL
+
I E-I T0 W f m


4 w Hw - WL Hw + WL
+
I EI T0 W f m


4 w Hw - WL Hw + WL
-
E2 I T0 W f2 d


16 w3 Hw - 2 WL Hw - WL Hw + WL
-
E-2 I T0 W f2 d


32 w3 Hw - WL2 Hw + 2 WL
-
E-2 I T0 W f2 d


32 w3 Hw + WL2 Hw + 2 WL
-
E-2 I T0 W f2 d


16 w3 Hw - WL Hw + WL Hw + 2 WL
- EIT0 w-I T0 W f d A@T1, T2D


4 w2 Hw - WL W
+
EI T0 w+I T0 W f d A@T1, T2D


4 w2 Hw - WL W
- EI T0 w-I T0 W f d A@T1, T2D


4 w2 W Hw + WL
+ EIT0 w+I T0 W f d A@T1, T2D


4 w2 W Hw + WL
+
E2 I T0 w d A@T1, T2D2


2 w2
+ I E-I T0 w m A@T1, T2D


2 w
- E-IT0 w+I T0 W f d A@T1, T2D


4 w2 Hw - WL H2 w - WL
-
E-I T0 w+I T0 W f d A@T1, T2D


4 w2 H2 w - WL Hw + WL
- E-IT0 w-I T0 W f d A@T1, T2D


4 w2 Hw - WL H2 w + WL
- E-I T0 w-IT0 W f d A@T1, T2D


4 w2 Hw + WL H2 w + WL
+
E-I T0 w+I T0 W f d A@T1, T2D


2 w H2 w - WL Hw2 - W2L
- d A@T1, T2D A@T1, T2D


w2
- E-2I T0 w d A@T1, T2D
2


6 w2
>
The CPU time is decreased by a factor of
%%%@@1DD  %@@1DD
7.88228
sol2a === sol2b
True
Then, the particular solution of order2Eqm can be expressed in pure function form as
sol2 = 9z2 -> Function@8T0, T1, T2<, sol2b  EvaluateD,
z
2 -> Function@8T0, T1, T2<, sol2b . conjugateRule  EvaluateD=;
Substituting the first- and second-order solutions into the third-order equation, eqOrder[3], we obtain
order3Eq = Expand  HeqOrder@3D . sol1 . sol2L;
Eliminating the terms that produce secular terms in z3 from order3Eq yields
104
Chapter4.nb

SCond2Rule =
ISolveACoefficient@order3Eq@@2DD . expRule1, Exp@I w T0DD == 0, AH0,1L@T1, T2DE@@1DD .
SCond1Rule . HSCond1Rule . conjugateRuleL  ExpandAllM .
9c1_ m + c2_ m :> Factor@c1 + c2D m, c1_ f2 d2 + c2_ f2 d2 :> Factor@c1 + c2D f2 d2,
c1_ f2 a + c2_ f2 a :> Factor@c1 + c2D f2 a=;
SCond2Rule . displayRule
:D2A ﬁ- I A m2

2 w
+
3 I A f2 a


4 w Hw - WL2 Hw + WL2 -
I A f2 d2 H5 w + 2 WL


4 w3 Hw - WL2 Hw + WL2 H2 w + WL
-
5 I A2 d2 A

3 w3
+ 3 I A2 a A

2 w
- EI T1 s f d m H2 w3 + w2 W - 6 w W2 - W3L A



4 w2 Hw - WL2 W Hw + WL2
>
or
fRule = 9f -> 2 Iw2 - W2M L=;
SCond2Rule . fRule . W -> 2 w . displayRule
:D2A ﬁ- 9 I A d2 L2

4 w3
+ 3 I A a L2

w
- I A m2

2 w
- 5 I A2 d2 A

3 w3
- 7 EI T1 s d L m A

3 w2
+ 3 I A2 a A

2 w
>
which is in agreement with that obtained in the preceding section.
 4.2.7 The Function MMS1
Collecting the steps described in Section 4.2.5 for a system of two real-valued first-order equations, we can build a function
named MMS1 (Method of Multiple Scales for 1DOF system) specifically for FDuffingEq. A more general function (a Package)
can be similarly created by considering as arguments  the governing equation, symbols  for the dependent variable, indepen-
dent variable, excitation amplitudes and frequencies, and all other related quantities  which allow the program to identify their
respective meanings. We then use MMS1 to solve for different resonance cases.
MMS1@scaling_List, ResonanceCond : 8__Equal<D :=
ModuleA8<,
vRule = u¢@tD -> v@tD;
OmgRule = Solve@ResonanceCond, WD@@1DD;
eqa = 8vRule . Rule -> Equal, FDuffingEq . scaling . vRule . D@vRule, tD<;
multiScales =
8u@tD -> u@T0, T1, T2D, v@tD -> v@T0, T1, T2D, u_¢@tD -> dt@1D@u@T0, T1, T2DD, t -> T0<;
solRule = 9u -> ISumAej uj@#1, #2, #3D, 8j, 3<E &M,
v -> ISumAej vj@#1, #2, #3D, 8j, 3<E &M=;
eqb = Heqa . multiScales . solRule  TrigToExp  ExpandAllL . en_;n>3 -> 0;
eqEps =
Thread@CoefficientList@Subtract  #, eD == 0D &  eqb  Transpose  Rest;
H* First-Order Problem *L
Chapter4.nb
105

linearSys = #@@1DD &  eqEps@@1DD . f -> 0;
eqOrder@i_D :=
HlinearSys . u_1 -> uiL == HlinearSys . u_1 -> uiL - H#@@1DD &  eqEps@@iDDL  Thread;
coefList = E-I wT0 linearSys . 9u1 -> IP EI w # &M, v1 -> IQ EI w # &M=  Expand;
coefMat = Outer@Coefficient, coefList, 8P, Q<D;
hermitian@mat_? MatrixQD := mat . conjugateRule  Transpose;
rightVec = 81, c1< . Solve@HcoefMat.81, c1<L@@1DD == 0, c1D@@1DD;
leftVec = 8c1, 1< . Solve@Hhermitian@coefMatD.8c1, 1<L@@1DD == 0, c1D@@1DD;
ccleftVec = leftVec . conjugateRule;
sol1h = # + H# . conjugateRuleL &  IrightVec A@T1, T2D EI wT0 M;
sol1p =
DSolve@eqOrder@1D . 8u1 -> Hu1@#1D &L, v1 -> Hv1@#1D &L<, 8u1@T0D, v1@T0D<, T0D@@1DD .
C@_D -> 0  TrigToExp  Simplify;
fRule = f -> -2 I-w2 + W2M L;
sol1 =
8u1 -> Function@8T0, T1, T2<, sol1h@@1DD + Hu1@T0D . sol1p . fRule  ExpandL  EvaluateD,
v1 -> Function@8T0, T1, T2<,
sol1h@@2DD + Hv1@T0D . sol1p . fRule  ExpandL  EvaluateD<;
H* Second-Order Problem *L
order2Eq = eqOrder@2D . sol1  ExpandAll;
expRule1 =
Exp@arg_D :> Exp@Expand@arg . OmgRuleD . en_. T0 :> timeScales@@n + 1DDD;
STerms1 = Coefficient@#@@2DD . expRule1, Exp@I w T0DD &  order2Eq;
SCond1 = SolveAccleftVec.STerms1 == 0, AH1,0L@T1, T2DE@@1DD;
ccSCond1 = SCond1 . conjugateRule;
sigRule = Solve@OmgRule . Rule -> Equal, sD@@1DD;
expRule2 = Exp@a_D :> ExpAa . 9T1 -> e T0, T2 -> e2 T0= . sigRule  ExpandE;
SCond1f = Join@SCond1, ccSCond1D . expRule2;
order2Eqm = order2Eq . SCond1f  ExpandAll;
collectForm = JoinA9EIT0 w A@T1, T2D, E-I T0 w A@T1, T2D=,
IfAHF  f . scalingL === e, 9EI T0 W L, E-I T0 W L=, 8<EE;
possibleTerms = collectForm ~Join~
HOuter@Times, collectForm, collectFormD  Flatten  UnionL;
RT = I# . 8a_ ; a =!= 0 -> 1< &  IE-I w T0 possibleTerms . expRule1 .
Exp@_ T0 + _.D -> 0MM possibleTerms  Union  Rest;
NRT = Complement@possibleTerms, Join@RT, RT . conjugateRuleDD;
RTsymbolList = Table@Gj, 8j, Length@RTD<D;
NRTsymbolList@i_D = Table@Li,j, 8j, Length@NRTD<D;
sol2Form = 8
u2 -> Function@8T0, T1, T2<,
RTsymbolList.RT + HRTsymbolList.RT . conjugateRuleL + NRTsymbolList@1D.NRT 
EvaluateD, v2 -> Function@8T0, T1, T2<, -I w RTsymbolList.RT +
106
Chapter4.nb

H-I w RTsymbolList.RT . conjugateRuleL + NRTsymbolList@2D.NRT  EvaluateD<;
algEqs1 = HCoefficient@Subtract  #, NRTD &  Horder2Eqm . sol2FormL .
Exp@_ T0D -> 0  FlattenL == 0  Thread;
coef1 = Solve@algEqs1, Array@NRTsymbolList, 2D  FlattenD@@1DD;
algEqs2 =
Coefficient@Subtract  order2Eqm@@1DD . sol2Form, RTD == 0 . Exp@_ T0D -> 0  Thread;
coef2a = Solve@algEqs2, RTsymbolListD@@1DD;
coef2 = Join@coef2a, coef2a . conjugateRuleD;
sol2 = sol2Form . Function@8T0, T1, T2<, b_D :>
Function@8T0, T1, T2<  Evaluate, b . coef1 . coef2  Expand  EvaluateD;
H* Third-Order Problem *L
order3Eq = eqOrder@3D . sol1 . sol2  ExpandAll;
STerms2 =
Coefficient@#@@2DD . expRule1 . HOmgRule . e -> 0L, Exp@I w T0DD &  order3Eq;
SCond2 = SolveAccleftVec.STerms2 == 0, AH0,1L@T1, T2DE@@1DD  ExpandAll;
H* Reconstitution *L
moduEq = 2 I w A¢ == H2 I w dt@1D@ A@T1, T2DD . SCond1 . SCond2  Collect@#, eD &L;
Print@"The second-order approximate solution:"D;
Print@
u@tD == Hu  timeScales . solRule . e^ 3 -> 0 . sol1 . sol2 . displayRuleLD;
IfAHF  f . scalingL === e, PrintA"where\n L==fH2Hw2-W2LL"E
E;
Print@"\nThe modulation equations:"D;
Print@moduEq . displayRuleD
E
 Primary Resonance:  W » w
scaling1 = 9F -> e3 f, m‘ -> e2 m=;
ResonanceCond1 = 9W == w + e2 s=;
Chapter4.nb
107

MMS1@scaling1, ResonanceCond1D  Timing
The second-order approximate solution:
u@tD == e IA EI T0 w + E-I T0 w AM + e2 i
k
jjjj
A2 E2 I T0 w d

3 w2
-
2 A d A

w2
+
E-2 I T0 w d A2

3 w2
y
{
zzzz
The modulation equations:
2 I w A¢ == 2 I e2 w
i
k
jjj-A m - I EIT2 s f

4 w
- 5 I A2 d2 A

3 w3
+ 3 I A2 a A

2 w
y
{
zzz
81.513 Second, Null<
 Subharmonic Resonance of Order 1/2:  W » 2w
scaling2 = 8F -> e f, m‘ -> e m<;
ResonanceCond2 = 8W == 2 w + e s<;
MMS1@scaling2, ResonanceCond2D  Timing
The second-order approximate solution:
u@tD ==
e IA EI T0 w + E-I T0 W L + EI T0 W L + E-I T0 w AM + e2 i
k
jjjj
A2 E2 I T0 w d

3 w2
- 2 d L2

w2
- I A EI T0 w m

2 w
- A EI T0 w-I T0 W d L

w W
+
2 A EIT0 w+I T0 W d L

W H2 w + WL
- E-2 I T0 W d L2

w2 - 4 W2
- E2 I T0 W d L2

w2 - 4 W2
+ 2 I E-I T0 W L m W

w2 - W2
- 2 I EI T0 W L m W

w2 - W2
-
2 A d A

w2
+
I E-I T0 w m A

2 w
-
E-IT0 w+I T0 W d L A

w W
+
2 E-I T0 w-I T0 W d L A


2 w W + W2
+
E-2 IT0 w d A2

3 w2
y
{
zzzz
where
L==fH2Hw2-W2LL
The modulation equations:
2 I w A¢ == -2 I e IA m w - I EI T1 s d L AM +
2 I e2 w i
k
jjj- 9 I A d2 L2

4 w3
+ 3 I A a L2

w
- I A m2

2 w
- 5 I A2 d2 A

3 w3
- 7 EI T1 s d L m A

3 w2
+ 3 I A2 a A

2 w
y
{
zzz
88.562 Second, Null<
 Subharmonic Resonance of Order 1/3:  W » 3w
scaling3 = 9F -> e f, m‘ -> e2 m=;
ResonanceCond3 = 9W == 3 w + e2 s=;
108
Chapter4.nb

MMS1@scaling3, ResonanceCond3D  Timing
The second-order approximate solution:
u@tD == e IA EI T0 w + E-I T0 W L + EI T0 W L + E-I T0 w AM +
e2 i
k
jjjj
A2 E2 I T0 w d

3 w2
-
2 d L2

w2
-
2 A EI T0 w-I T0 W d L

H2 w - WL W
+
2 A EI T0 w+I T0 W d L

W H2 w + WL
-
E-2I T0 W d L2

w2 - 4 W2
-
E2 IT0 W d L2

w2 - 4 W2
-
2 A d A

w2
-
2 E-I T0 w+I T0 W d L A


H2 w - WL W
+
2 E-IT0 w-I T0 W d L A


W H2 w + WL
+
E-2 I T0 w d A2

3 w2
y
{
zzzz
where
L==fH2Hw2-W2LL
The modulation equations:
2 I w A¢ ==
2 I e2 w
i
k
jjjj-A m - 6 I A d2 L2

5 w3
+ 3 I A a L2

w
- 5 I A2 d2 A

3 w3
+ 3 I A2 a A

2 w
+ I EI T2 s d2 L A2

w3
+ 3 I EI T2 s a L A2

2 w
y
{
zzzz
87.03 Second, Null<
 Superharmonic Resonance of Order 2:  2W » w
scaling4 = 8F -> e f, m‘ -> e m<;
ResonanceCond4 = 82 W == w + e s<;
MMS1@scaling4, ResonanceCond4D  Timing
The second-order approximate solution:
u@tD ==
e IA EI T0 w + E-I T0 W L + EI T0 W L + E-I T0 w AM + e2 i
k
jjjj
A2 E2 I T0 w d

3 w2
-
2 d L2

w2
-
I A EI T0 w m

2 w
+
2 A EI T0 w+I T0 W d L

W H2 w + WL
-
E-2I T0 W d L2

2 w Hw + 2 WL
-
E2 I T0 W d L2

2 w Hw + 2 WL
+
2 I E-I T0 W L m W

w2 - W2
-
2 I EI T0 W L m W

w2 - W2
-
2 A EI T0 w-I T0 W d L

2 w W - W2
-
2 A d A

w2
+ I E-I T0 w m A

2 w
+ 2 E-I T0 w-I T0 W d L A


W H2 w + WL
- 2 E-I T0 w+I T0 W d L A


2 w W - W2
+ E-2I T0 w d A2

3 w2
y
{
zzzz
where
L==fH2Hw2-W2LL
The modulation equations:
2 I w A¢ == -I e H-I EI T1 s d L2 + 2 A m wL +
2 I e2 w
i
k
jjj-
46 I A d2 L2

15 w3
+
13 EI T1 s d L2 m

12 w2
+
3 I A a L2

w
-
I A m2

2 w
-
5 I A2 d2 A

3 w3
+
3 I A2 a A

2 w
y
{
zzz
88.993 Second, Null<
Chapter4.nb
109

 Superharmonic Resonance of Order 3:  3W » w
scaling5 = 9F -> e f, m‘ -> e2 m=;
ResonanceCond5 = 93 W == w + e2 s=;
MMS1@scaling5, ResonanceCond5D  Timing
The second-order approximate solution:
u@tD == e IA EI T0 w + E-I T0 W L + EI T0 W L + E-I T0 w AM +
e2 i
k
jjjj
A2 E2 I T0 w d

3 w2
-
2 d L2

w2
-
2 A EI T0 w-I T0 W d L

H2 w - WL W
+
2 A EI T0 w+I T0 W d L

W H2 w + WL
-
E-2I T0 W d L2

w2 - 4 W2
-
E2 IT0 W d L2

w2 - 4 W2
-
2 A d A

w2
-
2 E-I T0 w+I T0 W d L A


H2 w - WL W
+
2 E-IT0 w-I T0 W d L A


W H2 w + WL
+
E-2 I T0 w d A2

3 w2
y
{
zzzz
where
L==fH2Hw2-W2LL
The modulation equations:
2 I w A¢ ==
2 I e2 w
i
k
jjj-A m - 106 I A d2 L2

35 w3
- 9 I EIT2 s d2 L3

5 w3
+ 3 I A a L2

w
+ I EI T2 s a L3

2 w
- 5 I A2 d2 A

3 w3
+ 3 I A2 a A

2 w
y
{
zzz
87.08 Second, Null<
 Slowly-Modulated Load:  W » 0
scaling6 = 8F -> e f, m‘ -> e m<;
ResonanceCond6 = 8W == e s<;
110
Chapter4.nb

MMS1@scaling6, ResonanceCond6D  Timing
The second-order approximate solution:
u@tD ==
e IA EI T0 w + E-I T0 W L + EI T0 W L + E-I T0 w AM + e2 i
k
jjjj
A2 E2 I T0 w d

3 w2
-
2 d L2

w2
-
I A EI T0 w m

2 w
-
A EI T0 w-I T0 W d L

w H2 w - WL
-
A EIT0 w+I T0 W d L

w H2 w + WL
-
E-2 I T0 W d L2

w2 - 4 W2
-
E2 I T0 W d L2

w2 - 4 W2
+
2 I E-I T0 W L m W

w2 - W2
-
2 I EI T0 W L m W

w2 - W2
-
2 A d A

w2
+ I E-I T0 w m A

2 w
- E-IT0 w+I T0 W d L A

w H2 w - WL
- E-I T0 w-I T0 W d L A

w H2 w + WL
+ E-2 I T0 w d A2

3 w2
y
{
zzzz
where
L==fH2Hw2-W2LL
The modulation equations:
2 I w A¢ == -2 I A E-I T1 s e H-I d L - I E2 I T1 s d L + EI T1 s m wL +
2 I e2 w
i
k
jjj-
3 I A d2 L2

w3
-
3 I A E-2 I T1 s d2 L2


2 w3
-
3 I A E2 I T1 s d2 L2

2 w3
+
3 I A a L2

w
+
3 I A E-2 I T1 s a L2

2 w
+ 3 I A E2 I T1 s a L2

2 w
- I A m2

2 w
- 5 I A2 d2 A

3 w3
+ 3 I A2 a A

2 w
y
{
zzz
88.002 Second, Null<
à 4.3 The Generalized Method of Averaging
To  apply  either the  method  of averaging or the  generalized  method of averaging  to  FDuffingEq, we  need first to  use the
method  of variation  of parameters  to  transform it into  a  system of two  first-order equations  governing  the amplitude  and
phase. To this end, we introduce the following transformation:
states = 8a@tD, f@tD<;
transformRule = 8u -> a@tD Cos@f@tDD + L Cos@Y@tDD, u¢ -> - w a@tD Sin@f@tDD - W L Sin@Y@tDD<;
gRule = g -> -2 e m u¢ - e d u2 - e2 a u3;
After some algebraic manipulations (Nayfeh, 1973, 1981), we transform FDuffingEq into two first-order equations as
eq43a =
D@states, tD == i
k
jj9- g
w
Sin@f@tDD, w -
g

a@tD w
Cos@f@tDD= . gRule . transformRule  Expand 
TrigReduce  Expandy
{
zz  Thread;
We seek approximate solutions to eq43a in the form
basicTerms = 8h@tD, j@tD, Y@tD<;
Chapter4.nb
111

solRule = 9a -> IEvaluateAh@tD + SumAej aj  basicTerms, 8j, 2<E . t -> #E &M,
f -> IEvaluateAj@tD + SumAej fj  basicTerms, 8j, 2<E . t -> #E &M=
8a ﬁHh@#1D + e a1@h@#1D, j@#1D, Y@#1DD + e2 a2@h@#1D, j@#1D, Y@#1DD &L,
f ﬁHj@#1D + e f1@h@#1D, j@#1D, Y@#1DD + e2 f2@h@#1D, j@#1D, Y@#1DD &L<
where h@tD and j@tD are expanded in power series in e as
basicDRule = D@basicTerms@@81, 2<DD, tD ->
9SumAei Ai  basicTerms, 8i, 2<E, w + SumAei Fi  basicTerms, 8i, 2<E=  Thread
8h¢@tD ﬁe A1@h@tD, j@tD, Y@tDD + e2 A2@h@tD, j@tD, Y@tDD,
j¢@tD ﬁw + e F1@h@tD, j@tD, Y@tDD + e2 F2@h@tD, j@tD, Y@tDD<
The functions a1, a2, f1, and f2 are fast varying functions of j, while it follows from basicDRule that h, and hence the An
and Fn  are slowly varying functions of t.
To the second approximation, we differentiate a@tD and f@tD once with respect to t, use solRule and basicDRule, expand the
result for small e, discard terms of order higher than e2, and obtain
eq43bLHS =
CoefficientListAExpand@#@@1DD . solRule . basicDRuleD . en_;n>2 -> 0, eE &  eq43a;
Next, we substitute  solRule  into the  right-hand  sides  of eq43a, expand the  result  for small e, keep  terms  up  to  OHe2L, and
rewrite their right-hand sides as
eq43bRHS =
CoefficientList@Series@#@@2DD . solRule, 8e, 0, 2<D  Normal  Expand, eD &  eq43a;
Equating coefficients of like powers of e in eq43bLHS and eq43bRHS, we obtain
eqEps = MapThread@Equal, 8eq43bLHS, eq43bRHS<, 2D  Transpose  Rest;
Next, we use the method  of separation of variables  to  separate  fast and  slowly  varying terms  in the  first-order equations,
eqEps[[1]]. We first introduce the rules
SVT@j_D := 8Aj  basicTerms, Fj  basicTerms<
solVar@j_D := 8aj, fj<
psiRule = 8j@tD -> w t + b@tD, Y@tD -> W t<;
betaRule = Solve@psiRule . Rule -> Equal, 8b@tD, W<D@@1DD
9b@tD ﬁ-t w + j@tD, W ﬁY@tD

t
=
For the case of subharmonic resonance of OI 12 M, we define
OmgRule = 8W -> 2 w + e s<;
112
Chapter4.nb

sigRule = Solve@OmgRule . Rule -> Equal, sD@@1DD
9s ﬁ- 2 w - W

e
=
expRule1 = f_@a_D :> f@Expand@a . psiRule . OmgRuleD . e t -> t1D;
expRule2 = f_@a_D :> f@Expand@a . t1 -> e t . sigRule . betaRuleDD;
Using these rules, we find that the slowly varying parts of eqEps[[1]] are given by
SVT1Rule =
Table@Solve@eqEps@@1, iDD . Thread@solVar@1D -> H0 &LD . expRule1 . f_@_ t + _.D -> 0 .
expRule2, SVT@1D@@iDDD @@1DD, 8i, 2<D  Flatten
9A1@h@tD, j@tD, Y@tDD ﬁ- 2 m w h@tD - d L Sin@2 j@tD - Y@tDD h@tD



2 w
,
F1@h@tD, j@tD, Y@tDD ﬁd L Cos@2 j@tD - Y@tDD


2 w
=
whereas the fast varying parts are given by
FVT1 =
Table@Subtract  eqEps@@1, iDD . Thread@solVar@1D -> H0 &LD, 8i, 2<D . SVT1Rule  Expand
: L m W Cos@j@tD - Y@tDD


w
- L m W Cos@j@tD + Y@tDD


w
- d L2 Sin@j@tDD

2 w
-
d L2 Sin@j@tD - 2 Y@tDD


4 w
- d L2 Sin@j@tD + 2 Y@tDD


4 w
- m Cos@2 j@tDD h@tD -
d L Sin@2 j@tD + Y@tDD h@tD


2 w
- d Sin@j@tDD h@tD2


4 w
- d Sin@3 j@tDD h@tD2


4 w
,
- dL Cos@Y@tDD

w
- d L Cos@2 j@tD + Y@tDD


2 w
+ m Sin@2 j@tDD - d L2 Cos@j@tDD

2 w h@tD
-
d L2 Cos@j@tD - 2 Y@tDD


4 w h@tD
- d L2 Cos@j@tD + 2 Y@tDD


4 w h@tD
- L m W Sin@j@tD - Y@tDD


w h@tD
+
L m W Sin@j@tD + Y@tDD


w h@tD
- 3 d Cos@j@tDD h@tD


4 w
- d Cos@3 j@tDD h@tD


4 w
>
To  determine  a  particular solution  corresponding  to  these fast varying  terms, we  use the  method  of undetermined coeffi-
cients. To accomplish this, we first determine the possible forms of the terms in FVT1 as follows:
Chapter4.nb
113

FVT1Forms =
HCases@#, HCos ¨ SinL@a_D -> 8Cos@aD, Sin@aD<, InfinityD  Flatten  UnionL &  FVT1
88Cos@j@tDD, Cos@2 j@tDD, Cos@3 j@tDD, Cos@j@tD - 2 Y@tDD,
Cos@j@tD - Y@tDD, Cos@j@tD + Y@tDD, Cos@2 j@tD + Y@tDD, Cos@j@tD + 2 Y@tDD,
Sin@j@tDD, Sin@2 j@tDD, Sin@3 j@tDD, Sin@j@tD - 2 Y@tDD, Sin@j@tD - Y@tDD,
Sin@j@tD + Y@tDD, Sin@2 j@tD + Y@tDD, Sin@j@tD + 2 Y@tDD<,
8Cos@j@tDD, Cos@2 j@tDD, Cos@3 j@tDD, Cos@j@tD - 2 Y@tDD, Cos@j@tD - Y@tDD,
Cos@Y@tDD, Cos@j@tD + Y@tDD, Cos@2 j@tD + Y@tDD, Cos@j@tD + 2 Y@tDD,
Sin@j@tDD, Sin@2 j@tDD, Sin@3 j@tDD, Sin@j@tD - 2 Y@tDD, Sin@j@tD - Y@tDD,
Sin@Y@tDD, Sin@j@tD + Y@tDD, Sin@2 j@tD + Y@tDD, Sin@j@tD + 2 Y@tDD<<
Using the principle of superposition, we seek a particular solution corresponding to the fast-varying terms as a linear combina-
tion of these possible forms:
sol1Form = MapIndexed@Hcoeffs1@#2@@1DDD = Array@c, Length@#1DDL.#1 &, FVT1FormsD
8c@1D Cos@j@tDD + c@2D Cos@2 j@tDD + c@3D Cos@3 j@tDD +
c@4D Cos@j@tD - 2 Y@tDD + c@5D Cos@j@tD - Y@tDD + c@6D Cos@j@tD + Y@tDD +
c@7D Cos@2 j@tD + Y@tDD + c@8D Cos@j@tD + 2 Y@tDD + c@9D Sin@j@tDD + c@10D Sin@2 j@tDD +
c@11D Sin@3 j@tDD + c@12D Sin@j@tD - 2 Y@tDD + c@13D Sin@j@tD - Y@tDD +
c@14D Sin@j@tD + Y@tDD + c@15D Sin@2 j@tD + Y@tDD + c@16D Sin@j@tD + 2 Y@tDD,
c@1D Cos@j@tDD + c@2D Cos@2 j@tDD + c@3D Cos@3 j@tDD + c@4D Cos@j@tD - 2 Y@tDD +
c@5D Cos@j@tD - Y@tDD + c@6D Cos@Y@tDD + c@7D Cos@j@tD + Y@tDD + c@8D Cos@2 j@tD + Y@tDD +
c@9D Cos@j@tD + 2 Y@tDD + c@10D Sin@j@tDD + c@11D Sin@2 j@tDD + c@12D Sin@3 j@tDD +
c@13D Sin@j@tD - 2 Y@tDD + c@14D Sin@j@tD - Y@tDD + c@15D Sin@Y@tDD +
c@16D Sin@j@tD + Y@tDD + c@17D Sin@2 j@tD + Y@tDD + c@18D Sin@j@tD + 2 Y@tDD<
Substituting  sol1Form into  eqEps[[1]], using  SVT1Rule, collecting  the  coefficients  of FVT1Forms, solving  the  resulting
algebraic  equations for the  undetermined coefficients, and  then  substituting the  result  back into sol1Form, we obtain  the
solution
114
Chapter4.nb

sol1rhs = Table@sol1Form@@iDD .
Solve@Coefficient@Subtract  eqEps@@1, iDD . SVT1Rule . solVar@1D@@iDD -> HEvaluate@
sol1Form@@iDD . Thread@basicTerms -> 8#1, #2, #3<DD &L, FVT1Forms@@iDDD ==
0  Thread, coeffs1@iDD@@1DD . D@psiRule, tD  Expand, 8i, 2<D
:- dL2 Cos@j@tDD

2 w2
- d L2 Cos@j@tD - 2 Y@tDD


4 w Hw - 2 WL
- d L2 Cos@j@tD + 2 Y@tDD


4 w Hw + 2 WL
-
L m W Sin@j@tD - Y@tDD


w Hw - WL
+ L m W Sin@j@tD + Y@tDD


w Hw + WL
- d L Cos@2 j@tD + Y@tDD h@tD


2 w H2 w + WL
+
m Sin@2 j@tDD h@tD


2 w
- d Cos@j@tDD h@tD2


4 w2
- d Cos@3 j@tDD h@tD2


12 w2
,
m Cos@2 j@tDD

2 w
+ d L Sin@Y@tDD

w W
+ d L Sin@2 j@tD + Y@tDD


2 w H2 w + WL
- L m W Cos@j@tD - Y@tDD


w Hw - WL h@tD
+
L m W Cos@j@tD + Y@tDD


w Hw + WL h@tD
+ d L2 Sin@j@tDD

2 w2 h@tD
+ d L2 Sin@j@tD - 2 Y@tDD


4 w Hw - 2 WL h@tD
+
d L2 Sin@j@tD + 2 Y@tDD


4 w Hw + 2 WL h@tD
+ 3 d Sin@j@tDD h@tD


4 w2
+ d Sin@3 j@tDD h@tD


12 w2
>
which can be expressed in pure function form as
sol1Rule = Table@solVar@1D@@iDD ->
HEvaluate@sol1rhs@@iDD . Thread@basicTerms -> 8#1, #2, #3<DD &L, 8i, 2<D
:a1 ﬁi
k
jj- d L2 Cos@#2D

2 w2
- d L2 Cos@#2 - 2 #3D


4 w Hw - 2 WL
-
d L2 Cos@#2 + 2 #3D


4 w Hw + 2 WL
- L m W Sin@#2 - #3D


w Hw - WL
+ L m W Sin@#2 + #3D


w Hw + WL
-
d L Cos@2 #2 + #3D #1


2 w H2 w + WL
+ m Sin@2 #2D #1

2 w
- d Cos@#2D #12

4 w2
- d Cos@3 #2D #12

12 w2
&y
{
zz,
f1 ﬁi
k
jj m Cos@2 #2D

2 w
+ d L Sin@#3D

w W
+ d L Sin@2 #2 + #3D


2 w H2 w + WL
- L m W Cos@#2 - #3D


w Hw - WL #1
+ L m W Cos@#2 + #3D


w Hw + WL #1
+
d L2 Sin@#2D

2 w2 #1
+ d L2 Sin@#2 - 2 #3D


4 w Hw - 2 WL #1
+ d L2 Sin@#2 + 2 #3D


4 w Hw + 2 WL #1
+ 3 d Sin@#2D #1

4 w2
+ d Sin@3 #2D #1

12 w2
&y
{
zz>
Substituting the  slow- and  fast-varying components  of the first-order solution, SVT1Rule  and  sol1Rule, into the  second-
order equations, we have
Horder2Expr = Table@TrigReduce 
HSubtract  eqEps@@2, iDD . SVT1Rule . sol1Rule  ExpandL, 8i, 2<D;L  Timing
812.36 Second, Null<
Since we are seeking an expansion valid up to OHe2L, we do not need to solve for a2  and f2. All we need to do is  to investi-
gate the above expressions to determine the slowly varying parts and determine A2 and F2. The result is
Chapter4.nb
115

SVT2Rule =
Table@Solve@order2Expr@@iDD == 0 . Thread@solVar@2D -> H0 &LD . expRule1 . f_@_ t + _.D ->
0 . expRule2 . HOmgRule . e -> 0L, SVT@2D@@iDDD, 8i, 2<D  Flatten  ExpandAll
:A2@h@tD, j@tD, Y@tDD ﬁ- 7 d L m Cos@2 j@tD - Y@tDD h@tD


6 w2
, F2@h@tD, j@tD, Y@tDD ﬁ
- 9d2 L2

16 w3
+ 3 a L2

4 w
- m2

2 w
+ 7 d L m Sin@2 j@tD - Y@tDD


6 w2
- 5 d2 h@tD2

12 w3
+ 3 a h@tD2

8 w
>
Hence, to the second approximation, we find  that
u@tD ==
HTrigReduce  HNormal@Series@u . transformRule . solRule, 8e, 0, 1<DD . sol1Rule 
ExpandL  Collect@#, eD &L
u@tD ==
L Cos@Y@tDD + Cos@j@tDD h@tD + e i
k
jj- d L2

2 w2 - d L2 Cos@2 Y@tDD

4 w Hw - 2 WL
- d L2 Cos@2 Y@tDD

4 w Hw + 2 WL
+ L m W Sin@Y@tDD

w Hw -WL
+
L m W Sin@Y@tDD

w Hw + WL
- d L Cos@j@tD - Y@tDD h@tD


2 w W
+ d L Cos@j@tD + Y@tDD h@tD


2 w W
-
d L Cos@j@tD + Y@tDD h@tD


2 w H2 w + WL
+ m Sin@j@tDD h@tD


2 w
- d h@tD2

2 w2
+ d Cos@2 j@tDD h@tD2


6 w2
y
{
zz
where the equations governing the amplitude and phase are
8ampEqs, phaseEqs< = HbasicDRule . SVT1Rule . SVT2Rule  ExpandAllL .
f_@a_D :> f@Collect@a . psiRule, tDD . Rule -> Equal
:h¢@tD == -e m h@tD - 7 d e2 L m Cos@t H2 w - WL + 2 b@tDD h@tD



6 w2
+ d e L Sin@t H2 w - WL + 2 b@tDD h@tD



2 w
,
j¢@tD == - 9 d2 e2 L2

16 w3
+ 3 a e2 L2

4 w
- e2 m2

2 w
+ w + d e L Cos@t H2 w - WL + 2 b@tDD


2 w
+
7 d e2 L m Sin@t H2 w - WL + 2 b@tDD



6 w2
- 5 d2 e2 h@tD2

12 w3
+ 3 a e2 h@tD2

8 w
>
à 4.4 The Method of Normal Forms
In this  section, we use the method of normal forms to determine a second-order uniform expansion of the solution of FDuff-
ingEq. To this  end, we start  with the corresponding first-order complex-valued equation, which was derived in Section 4.2.6
and a summary of the derivation is given below:
transformRule = 9u@tD -> Iz@tD + z@tDM, u¢@tD -> I w Iz@tD - z@tDM, f Cos@W tD -> 1
2
 Hz@tD + z@tDL=;
gRule = g -> -2 e m u¢@tD - e d u@tD2 - e2 a u@tD3 + f Cos@W tD;
116
Chapter4.nb

eq44a = 8z¢@tD == I w z@tD - I g  H2 wL . gRule . transformRule  ExpandAll, z¢@tD == I W z@tD<
:z¢@tD ==
- Iz@tD

4 w
- e m z@tD + I w z@tD + I d e z@tD2

2 w
+ I a e2 z@tD3

2 w
- I z@tD

4 w
+ e m z@tD + I d e z@tD z@tD

w
+
3 I a e2 z@tD2 z@tD


2 w
+ I d e z@tD
2

2 w
+ 3 I a e2 z@tD z@tD
2


2 w
+ I a e2 z@tD
3

2 w
, z¢@tD == I W z@tD>
According to the method of normal forms, we introduce the near-identity transformation
basicTerms = 8h@tD, h@tD, z@tD, z@tD<;
zetaRule = 9z -> FunctionAt, h@tD + SumAej hj@Sequence  basicTermsD, 8j, 0, 2<E  EvaluateE,
z -> FunctionAt, h@tD + SumAej h
j@Sequence  basicTermsD, 8j, 0, 2<E  EvaluateE=
8z ﬁFunction@t, h@tD + h0@h@tD, h@tD, z@tD, z@tDD +
e h1@h@tD, h@tD, z@tD, z@tDD + e2 h2@h@tD, h@tD, z@tD, z@tDDD,
z ﬁFunction@t, h@tD + h
0@h@tD, h@tD, z@tD, z@tDD +
e h
1@h@tD, h@tD, z@tD, z@tDD + e2 h
2@h@tD, h@tD, z@tD, z@tDDD<
that results in the simplest possible equation
etaRule = 9h¢@tD -> I w h@tD + SumAej gj@tD, 8j, 2<E, z¢@tD -> I W z@tD=
8h¢@tD ﬁI w h@tD + e g1@tD + e2 g2@tD, z¢@tD ﬁI W z@tD<
where the overbar denotes the complex conjugate
conjugateRule = 8h -> h, h -> h, g -> g, g -> g, z -> z, z -> z, Complex@0, n_D -> Complex@0, -nD<;
Substituting the expansion for z, the zetaRule, into eq44a, using the etaRule, expanding the result for small e, and discarding
terms of order higher than e2, we have
eq44b = Heq44a@@1DD . zetaRule . etaRule . HetaRule . conjugateRuleL  ExpandAllL .
en_;n>2 -> 0;
Equating coefficients of like powers of e in eq44b yields
eqEps = CoefficientList@Subtract  eq44b, eD == 0  Thread;
 First-Order Solution
Using the method of undetermined coefficients, we assume
coeffsL = Table@Di, 8i, Length@basicTermsD<D
8D1, D2, D3, D4<
Chapter4.nb
117

hFormL = 9h0 -> HEvaluate@coeffsL.basicTerms . Thread@basicTerms -> 8#1, #2, #3, #4<DD &L,
h
0 -> HEvaluate@coeffsL.basicTerms . conjugateRule .
Thread@basicTerms -> 8#1, #2, #3, #4<DD &L=;
Substituting the hFormL into eqEps[[1]], collecting the coefficients of the basicTerms, and solving for the coeffsL, we obtain
coeffsLRule =
Solve@Coefficient@eqEps@@1, 1DD . hFormL, basicTermsD == 0  Thread, coeffsLD@@1DD
Solve::svars :  Equations may not give solutions for all "solve" variables.
:D2 ﬁ0, D3 ﬁ
1

4 w Hw - WL
, D4 ﬁ
1

4 w Hw + WL
>
Substituting the coeffsLRule into the hFormL yields
hSolL = h0  basicTerms . hFormL . coeffsLRule . Di_ -> 0
z@tD

4 w Hw- WL
+
z@tD

4 w Hw + WL
Then, we write the first-order solution in pure function form as
hRuleL = 9h0 -> HEvaluate@hSolL . Thread@basicTerms -> 8#1, #2, #3, #4<DD &L,
h
0 -> HEvaluate@hSolL . conjugateRule . Thread@basicTerms -> 8#1, #2, #3, #4<DD &L=
:h0 ﬁi
k
jj
#3

4 w Hw - WL
+
#4

4 w Hw + WL
&y
{
zz, h
0 ﬁi
k
jj
#3

4 w Hw + WL
+
#4

4 w Hw - WL
&y
{
zz>
 Second-Order Solution
Substituting the hRuleL into the left-hand side of the second-order equation, eqEps[[2]], yields
order2expr = eqEps@@2, 1DD . hRuleL  Expand
m z@tD

4 w Hw- WL
-
m z@tD

4 w Hw + WL
-
I d z@tD2

32 w3 Hw - WL2 -
I d z@tD2

32 w3 Hw + WL2 -
I d z@tD2


16 w3 Hw - WL Hw + WL
+ m h@tD -
I d z@tD h@tD

4 w2 Hw - WL
- I d z@tD h@tD

4 w2 Hw + WL
- I d h@tD2

2 w
-
m z@tD

4 w Hw - WL
+
m z@tD

4 w Hw + WL
- I d z@tD z@tD

16 w3 Hw - WL2 -
I d z@tD z@tD

16 w3 Hw + WL2 -
I d z@tD z@tD


8 w3 Hw - WL Hw + WL
- I d h@tD z@tD

4 w2 Hw - WL
- I d h@tD z@tD

4 w2 Hw + WL
-
I d z@tD2

32 w3 Hw - WL2 -
I d z@tD2

32 w3 Hw + WL2 -
I d z@tD2


16 w3 Hw - WL Hw + WL
- m h@tD - I d z@tD h@tD

4 w2 Hw - WL
- I d z@tD h@tD

4 w2 Hw + WL
- I d h@tD h@tD

w
-
I d z@tD h@tD

4 w2 Hw - WL
- I d z@tD h@tD

4 w2 Hw + WL
- I d h@tD2

2 w
+ g1@tD - I w h1@h@tD, h@tD, z@tD, z@tDD -
I W z@tD h1
H0,0,0,1L@h@tD, h@tD, z@tD, z@tDD + I W z@tD h1
H0,0,1,0L@h@tD, h@tD, z@tD, z@tDD -
I w h@tD h1
H0,1,0,0L@h@tD, h@tD, z@tD, z@tDD + I w h@tD h1
H1,0,0,0L@h@tD, h@tD, z@tD, z@tDD
118
Chapter4.nb

We choose h1 to eliminate as many terms from order2expr, thereby reducing it to its simplest possible form. It turns out that
we  can  eliminate all  nonresonance  terms.  To  determine  the  resonance  terms  in  order2expr,  we  first  determine  all of  the
possible forms of its nonhomogeneous terms:
possibleQTerms =
basicTerms~ Join~HOuter@Times, basicTerms, basicTermsD  Flatten  UnionL
9h@tD, h@tD, z@tD, z@tD, z@tD2, z@tD h@tD, h@tD2,
z@tD z@tD, h@tD z@tD, z@tD2, z@tD h@tD, h@tD h@tD, z@tD h@tD, h@tD2=
It follows from the linear parts of the etaRule that
form = 9h@tD -> EI w t, h@tD -> E-I w t, z@tD -> EIW t, z@tD -> E-I W t=;
Hence, the possible resonance terms are given by
ResonantQTerm =
IE-I w t possibleQTerms . form . W -> 2 w . E_ t -> 0M possibleQTerms  Union  Rest
8h@tD, z@tD h@tD<
We choose g1 to eliminate the resonance terms in order2expr according to
gRuleQ =
g1@tD -> -HCoefficient@order2expr . h1 -> H0 &L, ResonantQTermD . Thread@basicTerms -> 0DL.
ResonantQTerm
g1@tD ﬁ-m h@tD - i
k
jj-
I d

4 w2 Hw - WL
-
I d

4 w2 Hw + WL
y
{
zz z@tD h@tD
The nonresonance terms are the complement of the resonance terms; that is,
NRQT = Complement@possibleQTerms, ResonantQTermD;
We associate with each of them an undetermined coefficient according to
coeffsQ = Table@Gj, 8j, Length@NRQTD<D
8G1, G2, G3, G4, G5, G6, G7, G8, G9, G10, G11, G12<
Therefore, h1 has the form
hFormQ = 8h1 -> HEvaluate@coeffsQ.NRQT . Thread@basicTerms -> 8#1, #2, #3, #4<DD &L<
8h1 ﬁH#3 G1 + #32 G2 + #1 #3 G3 + #12 G4 + #4 G5 +
#3 #4 G6 + #1 #4 G7 + #42 G8 + #2 G9 + #1 #2 G10 + #2 #4 G11 + #22 G12 &L<
Substituting  for h1  in  order2expr, equating  the  coefficients  of the  possible  nonresonance  terms  to  zero, and  solving  the
resulting equations for the Gi, we obtain
Chapter4.nb
119

coeffsQRule = Solve@Coefficient@order2expr . gRuleQ . hFormQ  Expand, NRQTD == 0 .
Thread@basicTerms -> 0D  Thread, coeffsQD@@1DD
9G3 ﬁ-
d


2 w W H-w + WL Hw + WL
, G4 ﬁ
d

2 w2 , G6 ﬁ-
d


4 w2 Hw - WL2 Hw + WL2 , G7 ﬁ
d


2 w W H-w + WL Hw + WL
,
G9 ﬁI m

2 w
, G10 ﬁ- d

w2 , G12 ﬁ-
d

6 w2 , G1 ﬁ-
I m W


2 w Hw - WL2 Hw + WL
, G2 ﬁ-
d


8 w Hw - 2 WL Hw - WL2 Hw + WL2 ,
G5 ﬁ
I m W


2 w Hw - WL Hw + WL2 , G11 ﬁ-
d


2 w Hw - WL Hw + WL H2 w + WL
, G8 ﬁ-
d


8 w Hw - WL2 Hw + WL2 Hw + 2 WL
=
Substituting the coeffsQRule into the hFormQ yields
hSolQ = h1  basicTerms . hFormQ . coeffsQRule
-
I m W z@tD


2w Hw - WL2 Hw + WL
-
d z@tD2


8 w Hw - 2 WL Hw - WL2 Hw + WL2 -
d z@tD h@tD


2 w W H-w + WL Hw + WL
+
d h@tD2

2 w2
+
I m W z@tD


2 w Hw - WL Hw + WL2 -
d z@tD z@tD


4 w2 Hw - WL2 Hw + WL2 +
d h@tD z@tD


2 w W H-w + WL Hw + WL
-
d z@tD2


8 w Hw- WL2 Hw + WL2 Hw + 2 WL
+ I m h@tD

2 w
- d h@tD h@tD

w2
-
d z@tD h@tD


2 w Hw - WL Hw + WL H2 w + WL
- d h@tD2

6 w2
Hence, we can write the second-order solution in pure function form as
hRuleQ = 9h1 -> HEvaluate@hSolQ . Thread@basicTerms -> 8#1, #2, #3, #4<DD &L,
h
1 -> HEvaluate@hSolQ . conjugateRule . Thread@basicTerms -> 8#1, #2, #3, #4<DD &L=;
 Third-Order Equations
Substituting the hRuleL, hRuleQ, and gRuleQ into the left-hand side of the third-order equation, eqEps[[3]], yields
order3expr =
eqEps@@3, 1DD . hRuleL . hRuleQ . gRuleQ . HgRuleQ . conjugateRuleL  Expand;
The nonhomogeneous terms in order3expr are proportional to
possibleCTerms = Outer@Times, possibleQTerms, basicTermsD  Flatten  Union
9z@tD2, z@tD3, z@tD h@tD, z@tD2 h@tD, h@tD2, z@tD h@tD2, h@tD3, z@tD z@tD, z@tD2 z@tD,
h@tD z@tD, z@tD h@tD z@tD, h@tD2 z@tD, z@tD2, z@tD z@tD2, h@tD z@tD2, z@tD3, z@tD h@tD,
z@tD2 h@tD, h@tD h@tD, z@tD h@tD h@tD, h@tD2 h@tD, z@tD h@tD, z@tD z@tD h@tD,
h@tD z@tD h@tD, z@tD2 h@tD, h@tD2, z@tD h@tD2, h@tD h@tD2, z@tD h@tD2, h@tD3=
120
Chapter4.nb

possibleTerms = Join@possibleQTerms, possibleCTermsD  Union
9z@tD, z@tD2, z@tD3, h@tD, z@tD h@tD, z@tD2 h@tD, h@tD2, z@tD h@tD2, h@tD3, z@tD, z@tD z@tD,
z@tD2 z@tD, h@tD z@tD, z@tD h@tD z@tD, h@tD2 z@tD, z@tD2, z@tD z@tD2, h@tD z@tD2,
z@tD3, h@tD, z@tD h@tD, z@tD2 h@tD, h@tD h@tD, z@tD h@tD h@tD, h@tD2 h@tD, z@tD h@tD,
z@tD z@tD h@tD, h@tD z@tD h@tD, z@tD2 h@tD, h@tD2, z@tD h@tD2, h@tD h@tD2, z@tD h@tD2, h@tD3=
Next, we determine the resonance terms according to
ResonantCTerm =
IE-I w t possibleTerms . form . W -> 2 w . E_ t -> 0M possibleTerms  Union  Rest
8h@tD, z@tD h@tD z@tD, z@tD h@tD, h@tD2 h@tD<
Choosing g2 to eliminate the resonance terms from order3expr yields
gRuleC = g2@tD ->
-Factor@Coefficient@order3expr . h2 -> H0 &L, ResonantCTermD . Thread@basicTerms -> 0DD.
ResonantCTerm
g2@tD ﬁ- I m2 h@tD

2 w
+ I H-5 d2 w + 6 a w3 - 2 d2 W + 3 a w2 WL z@tD h@tD z@tD




4 w3 Hw - WL2 Hw + WL2 H2 w + WL
-
d m H2 w3 + w2 W - 6 w W2 - W3L z@tD h@tD



4 w2 Hw - WL2 W Hw + WL2
- I H10 d2 - 9 a w2L h@tD2 h@tD


6 w3
The nonresonance terms are the complement of the resonance terms; that is,
NRCT = Complement@possibleTerms, ResonantCTermD;
Again, we associate an undetermined coefficient with each of these terms as follows:
coeffsC = Table@Lj, 8j, Length@NRCTD<D
8L1, L2, L3, L4, L5, L6, L7, L8, L9, L10, L11, L12, L13, L14, L15,
L16, L17, L18, L19, L20, L21, L22, L23, L24, L25, L26, L27, L28, L29, L30<
Consequently, h2 has the form
hFormC = 8h2 -> HEvaluate@coeffsC.NRCT . Thread@basicTerms -> 8#1, #2, #3, #4<DD &L<;
Substituting  for h2  into  order3expr, equating  the coefficient  of each  possible  nonresonance  term to  zero, and  solving the
resulting algebraic equations for the Li, we obtain
coeffsCRule = Solve@Coefficient@order3expr . gRuleC . hFormC  Expand, NRCTD == 0 .
Thread@basicTerms -> 0D  Thread, coeffsCD@@1DD  ExpandAll;
Substituting the coeffsCRule into the hFormC yields
hSolC = h2  basicTerms . hFormC . coeffsCRule;
Chapter4.nb
121

Combining the etaRule, gRuleQ, and gRuleC and letting
solForm = 9h -> IA@#D EI w # &M, h -> IA@#D E-I w # &M, z -> If EI W # &M, z -> If E-I W # &M=;
we obtain the modulation equation
moduEq = I2 I w E-I wt Hh¢@tD - Hh¢@tD . etaRule . gRuleQ . gRuleCLL . solForm  Expand 
Collect@#, eD &M == 0
e i
k
jjjj2 I m w A@tD + E-2 I tw+I t W f d A@tD


2 w Hw - WL
+ E-2 I t w+It W f d A@tD


2 w Hw + WL
y
{
zzzz +
e2 i
k
jjj-m2 A@tD -
5 f2 d2 A@tD


2 w Hw - WL2 Hw + WL2 H2 w + WL
+
3 f2 a w A@tD


Hw - WL2 Hw + WL2 H2 w + WL
+
3 f2 a W A@tD


2 Hw - WL2 Hw + WL2 H2 w + WL
-
f2 d2 W A@tD


w2 Hw - WL2 Hw + WL2 H2 w + WL
+
I E-2I t w+I t W f d m w A@tD


2 Hw - WL2 Hw + WL2
+ I E-2I t w+I t W f d m w2 A@tD


Hw - WL2 W Hw + WL2
- 3 I E-2 I t w+It W f d m W A@tD


Hw - WL2 Hw + WL2
-
I E-2I t w+I t W f d m W2 A@tD


2 w Hw - WL2 Hw + WL2
+ 3 a A@tD2 A@tD - 10 d2 A@tD2 A@tD

3 w2
y
{
zzzz + 2 I w A¢@tD == 0
or
moduEq . f -> 2 L IW2 - w2M . W -> 2 w
e H2 I m w A@tD - 2 d L A@tDL +
e2 i
k
jjj6 a L2 A@tD - m2 A@tD - 9 d2 L2 A@tD

2 w2
- 14 I d L m A@tD

3 w
+ 3 a A@tD2 A@tD - 10 d2 A@tD2 A@tD

3 w2
y
{
zzz +
2 I w A¢@tD == 0
which is in agreement with those obtained by using the method of multiple scales and the generalized method of averaging.
122
Chapter4.nb

Chapter 5
Higher-Order Approximations for Systems 
with Internal Resonances
Off@General::spell1D
à 5.1 Euler-Lagrange Equations
In  this  chapter,  we  use  different  methods  to  determine  approximate  solutions  of  nonlinear  systems  possessing  internal
resonances  to orders  higher than  the order at which  the influence  of the  internal resonance first appears. To  describe the
methods with minimum algebra, we  consider the free oscillations of a two-degree-of-freedom conservative system possess-
ing a two-to-one internal resonance and having simple quadratic nonlinearities. In particular, we consider a system governed
by the Lagrangian
Lagrangian = 1
2
 u1
¢@tD2 + 1
2
 u2
¢@tD2 - 1
2
 w1
2 u1@tD2 - 1
2
 w2
2 u2@tD2 + d u1@tD2 u2@tD;
where  w2 » 2 w1. Writing  down  the  Euler-Lagrange  equations  corresponding  to  the  Lagrangian, we  obtain  the  following
second-order equations of motion:
EOM1 = Table@D@D@Lagrangian, ui¢@tDD, tD - D@Lagrangian, ui@tDD == 0, 8i, 2<D
8w1
2 u1@tD - 2 d u1@tD u2@tD + u1
†@tD == 0, -d u1@tD2 + w2
2 u2@tD + u2
†@tD == 0<
Approximate solutions of general two-degree-of-freedom system with quadratic and cubic nonlinearities  having a two-to-one
internal resonance can be obtained by replacing the Lagrangian with the Lagrangian corresponding to the general system.
As discussed in the next section, treating this second-order form, EOM1, of the governing equations by using the method of
multiple scales  may lead to results  that violate the conservative nature  of the system under consideration. To determine an
approximate  solution  that  preserves  the  conservative  nature  of the  system,  we  treat  a  first-order form of  the  governing
equations. To  transform EOM1  into a  system of first-order equations, we  form a  modified Lagrangian by introducing  two
more states v1@tD and v2@tD such that
velRule = 8u1¢@tD -> v1@tD, u2¢@tD -> v2@tD<;
Then, the Lagrangian becomes
Lag1 = Lagrangian . velRule
- 1
2
w1
2 u1@tD2 + d u1@tD2 u2@tD - 1
2
w2
2 u2@tD2 + 1
2
v1@tD2 + 1
2
v2@tD2

Substituting Lag1 into Euler-Lagrange equations, we obtain the following first-order equations
eq51a = Table@D@D@Lag1, vi@tDD, tD - D@Lag1, ui@tDD == 0, 8i, 2<D
8w1
2 u1@tD - 2 d u1@tD u2@tD + v1
¢ @tD == 0, -d u1@tD2 + w2
2 u2@tD + v2
¢ @tD == 0<
Using the velRule and eq51a, we obtain the following first-order equations of motion:
EOM2 = 8velRule . Rule -> Equal, eq51a<  Transpose  Flatten
8u1
¢ @tD == v1@tD, w1
2 u1@tD - 2 d u1@tD u2@tD + v1
¢ @tD == 0,
u2
¢ @tD == v2@tD, -d u1@tD2 + w2
2 u2@tD + v2
¢ @tD == 0<
The corresponding linear system of EOM2 can be defined as x  = A x, where x is the state vector; that is,
states = Table@8ui@tD, vi@tD<, 8i, 2<D  Flatten
8u1@tD, v1@tD, u2@tD, v2@tD<
Using these states, we find that the coefficient matrix A of the linear part of EOM2 is given by
matrixA = Outer@D, #@@2DD &  Solve@EOM2, D@states, tDD@@1DD . d -> 0, statesD
880, 1, 0, 0<, 8-w1
2, 0, 0, 0<, 80, 0, 0, 1<, 80, 0, -w2
2, 0<<
whose adjoint is defined by
conjugateRule = 9A -> A, A -> A, Complex@0, n_D -> Complex@0, -nD=;
hermitian@mat_? MatrixQD := mat . conjugateRule  Transpose
The eigenvalues and eigenvectors of matrixA can be obtained as
matrixA  Eigensystem
:8-I w1, I w1, -I w2, I w2<, :: I

w1
, 1, 0, 0>, :- I

w1
, 1, 0, 0>, :0, 0,
I

w2
, 1>, :0, 0, - I

w2
, 1>>>
Hence, the right eigenvectors of matrixA corresponding to the eigenvalues I w1 and I w2, respectively, are
rightVec = Eigenvectors@matrixAD@@82, 4<DD
::- I

w1
, 1, 0, 0>, :0, 0, - I

w2
, 1>>
Moreover, the left eigenvectors of matrixA corresponding to the eigenvalues I w1 and Iw2, respectively, are
leftVec = Eigenvectors@hermitian@matrixADD@@81, 3<DD
88-I w1, 1, 0, 0<, 80, 0, -I w2, 1<<
whose complex conjugate is
120
Chapter5.nb

ccleftVec = leftVec . conjugateRule
88I w1, 1, 0, 0<, 80, 0, I w2, 1<<
à 5.2 Method of Multiple Scales
We use the method of multiple scales to obtain  a second-order uniform expansion of the solution of EOM1 in Section 5.2.1,
EOM2  in  Section  5.2.2, and  the  corresponding  first-order complex-valued equations  of EOM1  in  Section  5.2.3. Again, we
need the three time scales T0 = t, T1 = et, and T2 = e2 t, which we symbolize by
Needs@"Utilities`Notation`"D
Symbolize@T0D; Symbolize@T1D; Symbolize@T2D;
timeScales = 8T0, T1, T2<;
In terms of the new time scales, we can express the time derivatives as
dt@1D@expr_D := SumAei D@expr, timeScales@@i + 1DDD, 8i, 0, 2<E;
dt@2D@expr_D := Hdt@1D@dt@1D@exprDD  ExpandL . ei_;i>3 -> 0;
To represent some of the expressions in a more concise way, we introduce the following display rule:
displayRule =
9Derivative@a__DAu_i_,j_E@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD-1
#1
&, 8a<E, ui,jE,
Derivative@a__DAA_i_E@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD
#1
&, 8a<E, AiE,
u_i_,j_@__D -> ui,j, A_i_@__D -> Ai=;
 5.2.1 Second-Order Real-Valued System
Using method of multiple scales, we assume that the solution of EOM1 can be expressed in the form
solRule = ui_ -> ISumAej ui,j@#1, #2, #3D, 8j, 3<E &M;
multiScales = 8ui_@tD -> ui@T0, T1, T2D, Derivative@n_D@ui_D@tD :> dt@nD@ui@T0, T1, T2DD<;
Substituting multiScales and solRule into EOM1, expanding the result for small e, and discarding terms of order higher than
e3, we obtain
Chapter5.nb
121

eq521a = HEOM1 . multiScales . solRule  ExpandAllL . en_;n>3 -> 0;
eq521a . displayRule
8e HD0
2u1,1L + e2 HD0
2u1,2L + e3 HD0
2u1,3L + 2 e2 HD0 D1u1,1L + 2 e3 HD0 D1u1,2L + e3 HD1
2u1,1L + 2 e3 HD0 D2u1,1L +
e w1
2 u1,1 + e2 w1
2 u1,2 + e3 w1
2 u1,3 - 2 d e2 u1,1 u2,1 - 2 d e3 u1,2 u2,1 - 2 d e3 u1,1 u2,2 == 0,
e HD0
2u2,1L + e2 HD0
2u2,2L + e3 HD0
2u2,3L + 2 e2 HD0 D1u2,1L + 2 e3 HD0 D1u2,2L + e3 HD1
2u2,1L +
2 e3 HD0 D2u2,1L - d e2 u1,1
2
- 2 d e3 u1,1 u1,2 + e w2
2 u2,1 + e2 w2
2 u2,2 + e3 w2
2 u2,3 == 0<
Equating coefficients of like powers of e, we obtain
eqEps = Rest@Thread@CoefficientList@Subtract  #, eD == 0DD &  eq521a  Transpose;
To place the linear operators on one side and the nonhomogeneous terms on the other side, we define
eqOrder@i_D := I#@@1DD &  eqEps@@1DD . u_k_,1 -> uk,iM ==
I#@@1DD &  eqEps@@1DD . u_k_,1 -> uk,iM - H#@@1DD &  eqEps@@iDDL  Thread
Using eqOrder[i] and displayRule, we rewrite eqEps in a concise way as
eqOrder@1D . displayRule  TableForm
eqOrder@2D . displayRule  TableForm
eqOrder@3D . displayRule  TableForm
D0
2u1,1 + w1
2 u1,1 == 0
D02u2,1 + w22 u2,1 == 0
D0
2u1,2 + w1
2 u1,2 == -2 HD0 D1u1,1L + 2 d u1,1 u2,1
D0
2u2,2 + w2
2 u2,2 == -2 HD0 D1u2,1L + d u1,1
2
D0
2u1,3 + w1
2 u1,3 == -2 HD0 D1u1,2L - D1
2u1,1 - 2 HD0 D2u1,1L + 2 d u1,2 u2,1 + 2 d u1,1 u2,2
D0
2u2,3 + w2
2 u2,3 == -2 HD0 D1u2,2L - D1
2u2,1 - 2 HD0 D2u2,1L + 2 d u1,1 u1,2
 First-Order Equations: Linear System
To obtain the solution of eqOrder[1] by using DSolve, we transform eqOrder[1] into a set of ordinary-differential equations
as
order1Eq = eqOrder@1D . ui_,j_ -> Hui,j@#1D &L
8w1
2 u1,1@T0D + u1,1
†
@T0D == 0, w2
2 u2,1@T0D + u2,1
†
@T0D == 0<
The particular solution of order1Eq can be expressed as
sol1p = DSolve@order1Eq, 8u1,1@T0D, u2,1@T0D<, T0D@@1DD . C@_D -> 0
8u1,1@T0D ﬁ0, u2,1@T0D ﬁ0<
Hence, we write the first-order solution in function form as
122
Chapter5.nb

sol1 = TableAui,1 -> FunctionA8T0, T1, T2<,
Ai@T1, T2D Exp@I wi T0D + A
i@T1, T2D Exp@-I wi T0D + ui,1@T0D . sol1p  EvaluateE, 8i, 2<E
8u1,1 ﬁFunction@8T0, T1, T2<, EI T0 w1 A1@T1, T2D + E-I T0 w1 A
1@T1, T2DD,
u2,1 ﬁFunction@8T0, T1, T2<, EI T0 w2 A2@T1, T2D + E-I T0 w2 A
2@T1, T2DD<
 Second-Order Equations
Substituting sol1 into eqOrder[2] yields
order2Eq = eqOrder@2D . sol1  ExpandAll;
order2Eq . displayRule
:D0
2u1,2 + w1
2 u1,2 == 2 EIT0 w1+I T0 w2 d A1 A2 - 2 I EI T0 w1 HD1A1L w1 +
2 I E-I T0 w1 HD1A
1L w1 + 2 E-I T0 w1+I T0 w2 d A2 A
1 + 2 EI T0 w1-I T0 w2 d A1 A
2 + 2 E-I T0 w1-IT0 w2 d A
1 A
2,
D0
2u2,2 + w2
2 u2,2 == E2I T0 w1 d A1
2 - 2 I EI T0 w2 HD1A2L w2 + 2 I E-I T0 w2 HD1A
2L w2 + 2 d A1 A
1 + E-2 I T0 w1 dA
1
2>
To describe quantitatively the nearness of the two-to-one internal resonance w2 » 2 w1, we introduce the detuning parameter
s defined by
ResonanceCond = 8w2 == 2 w1 + e s<;
In eliminating secular terms, we need to express w2 in terms of w1 in some of the equations and w1 in terms of w2 in the other
equations. To accomplish this, we let
omgList = Table@wi, 8i, 2<D;
omgRule = Solve@ResonanceCond, Drop@omgList, 8#<DD@@1DD &  81, 2<
98w2 ﬁe s + 2 w1<, 9w1 ﬁ1
2
H-e s + w2L==
To convert small-divisor terms into secular terms, we define the rule
expRule1@j_D := Exp@arg_D :> Exp@Expand@arg . omgRule@@jDDD . e T0 -> T1D
Substituting  expRule1[i]  into  the  right-hand  sides  of order2Eq and  collecting  the  coefficients  of EI wi T0,  we  obtain  the
solvability conditions as
SCond1 = Coefficient@order2Eq@@#, 2DD . expRule1@#D, Exp@I w# T0DD == 0 &  81, 2<
92 EI T1 s d A2@T1, T2D A
1@T1, T2D - 2 I w1 A1
H1,0L@T1, T2D == 0,
E-I T1 s d A1@T1, T2D2 - 2 I w2 A2
H1,0L@T1, T2D == 0=
Because the system is conservative, the modulation equations given by SCond1 must be derivable from a Lagrangian. These
equations are the Euler-Lagrange equations corresponding to the Lagrangian
Chapter5.nb
123

Lag = EI T1 s d A2@T1, T2D A
1@T1, T2D
2 + E-I T1 s d A1@T1, T2D2 A
2@T1, T2D -
I w1 A
1@T1, T2D A1
H1,0L@T1, T2D - I w2 A
2@T1, T2D A2
H1,0L@T1, T2D +
I w1 A1@T1, T2D A
1
H1,0L@T1, T2D + I w2 A2@T1, T2D A
2
H1,0L@T1, T2D;
because
alSCond1 = TableA- DADALag, A
k
H1,0L@T1, T2DE, T1E + DALag, A
k@T1, T2DE == 0, 8k, 2<E
92 EI T1 s d A2@T1, T2D A
1@T1, T2D - 2 I w1 A1
H1,0L@T1, T2D == 0,
E-I T1 s d A1@T1, T2D2 - 2 I w2 A2
H1,0L@T1, T2D == 0=
Equations alSCond1 are identical to equations SCond1 as shown below
alSCond1 === SCond1
True
Alternatively, we  can  determine  the  modulation  equations  by  using  the  time-averaged  Lagrangian. To  this  end, we  first
define the rule
expRule2 = Exp@a_D :> Exp@Expand@a . HResonanceCond . Equal -> RuleLD . e T0 -> T1D;
Substituting multiScales, solRule, sol1, and expRule2 into the Lagrangian and selecting the slow-varying terms, we obtain
the following time-averaged Lagrangian:
TAL1 =
SelectAIHLagrangian . multiScales . solRule  ExpandL . en_;n>3 -> 0 . sol1  ExpandM .
expRule2, FreeQ@#, T0D &E . e -> 1;
TAL1 . displayRule
I HD1A
1L A1 w1 + I HD1A
2L A2 w2 - I HD1A1L w1 A
1 + EI T1 s d A2 A
1
2 + E-I T1 s d A1
2 A
2 - I HD1A2L w2 A
2
One can easily verify that TAL1 is identical to Lag. In fact,
TAL1 == Lag
True
Next, we rewrite SCond1 as
SCond1Rule1 = SolveASCond1, 9A1
H1,0L@T1, T2D, A2
H1,0L@T1, T2D=E@@1DD
:A1
H1,0L@T1, T2D ﬁ- I EI T1 s d A2@T1, T2D A
1@T1, T2D


w1
, A2
H1,0L@T1, T2D ﬁ- I E-IT1 s d A1@T1, T2D2


2 w2
>
whose complex conjugate is
ccSCond1Rule1 = SCond1Rule1 . conjugateRule;
124
Chapter5.nb

To solve for the particular solution of order2Eq, we express the detuning parameter s in terms of the wi; that is,
sigRule = Solve@ResonanceCond, sD@@1DD
9s ﬁ- 2 w1 - w2

e
=
Moreover, we express the scale T1 in terms of the scale T0 by using the rule
expRule3 = Exp@a_D :> Exp@a . T1 -> e T0 . sigRule  ExpandD;
With the solvability conditions and the expRule3, order2Eq becomes
order2Eqm = order2Eq . SCond1Rule1 . ccSCond1Rule1 . expRule3;
order2Eqm . displayRule
8D0
2u1,2 + w1
2 u1,2 == 2 EIT0 w1+I T0 w2 d A1 A2 + 2 E-I T0 w1-I T0 w2 d A
1 A
2, D0
2u2,2 + w2
2 u2,2 == 2 d A1 A
1<
Again, to use DSolve, we first transform order2Eqm into a set of ordinary-differential equations and then obtain the particular
solution of order2Eqm as
sol2p = DSolve@order2Eqm . ui_,j_ -> Hui,j@#1D &L, 8u1,2@T0D, u2,2@T0D<, T0D@@1DD . C@_D -> 0 
Simplify
:u1,2@T0D ﬁ
-
1

w2 H2 w1 + w2L
 H2 E-I T0 Hw1+w2L d HE2I T0 Hw1+w2L A1@T1, T2D A2@T1, T2D + A
1@T1, T2D A
2@T1, T2DLL,
u2,2@T0D ﬁ2 d A1@T1, T2D A
1@T1, T2D


w22
>
The second-order solution can be expressed in pure function form as
sol2 = TableAui,2 -> FunctionA8T0, T1, T2<, Bi@T1, T2D Exp@I wi T0D +
B
i@T1, T2D Exp@-I wi T0D + sol2p@@i, 2DD  Expand  EvaluateE, 8i, 2<E;
sol2 . displayRule
:u1,2 ﬁFunctionB8T0, T1, T2<, - 2 EI T0 Hw1+w2L d A1 A2


w2 H2 w1 + w2L
+ EIT0 w1 B1 - 2 E-IT0 Hw1+w2L d A
1 A
2


w2 H2 w1 + w2L
+ E-I T0 w1 B
1F,
u2,2 ﬁFunctionB8T0, T1, T2<, EI T0 w2 B2 + 2 d A1 A
1

w22
+ E-IT0 w2 B
2F>
As  shown  below,  the  obtained modulation  equations  will violate  the  conservative nature  of system unless  we  include an
appropriate part of the homogeneous solutions of the second-order problem. This is the reason why we included the homoge-
neous solutions with the undetermined functions Bi@tD. They will be determined so as  to preserve the conservative nature of
the system.
Chapter5.nb
125

 Third-Order Equations
Substituting sol1 and sol2 into eqOrder[3] yields
order3Eq = eqOrder@3D . sol1 . sol2  ExpandAll;
Substituting  expRule1[i]  into  the  right-hand  sides  of order3Eq and  collecting  the  coefficients  of EI wi T0,  we  obtain  the
solvability conditions as
SCond2 = Coefficient@order3Eq@@#, 2DD . expRule1@#D, Exp@I w# T0DD == 0 &  81, 2<;
SCond2 . displayRule
:-HD1
2A1L - 2 I HD1B1L w1 - 2 I HD2A1L w1 + 2 EI T1 s d B2 A
1 + 4 d2 A1
2 A
1

w22
- 4 d2 A1 A2 A
2

2 w1 w2 + w22
+ 2 EI T1 s d A2 B
1 == 0,
-HD1
2A2L + 2 E-I T1 s d A1 B1 - 2 I HD1B2L w2 - 2 I HD2A2L w2 - 4 d2 A1 A2 A
1

2 w1 w2 + w22
== 0>
Using the solvability conditions at second order, SCond1Rule1, we obtain
SCond1Rule2 = D@SCond1Rule1, T1D . SCond1Rule1 . ccSCond1Rule1;
SCond1Rule2 . displayRule
:D1
2A1 ﬁEI T1 s d s A2 A
1

w1
- d2 A1
2 A
1

2 w1 w2
+ d2 A1 A2 A
2

w12
, D1
2A2 ﬁ- E-I T1 s d s A1
2

2 w2
- d2 A1 A2 A
1

w1 w2
>
Hence, we rewrite the solvability conditions at third order as
SCond2Rule1 = SolveASCond2, 9A1
H0,1L@T1, T2D, A2
H0,1L@T1, T2D=E@@1DD . SCond1Rule2  ExpandAll;
SCond2Rule1 . displayRule
:D2A1 ﬁ-HD1B1L + I EI T1 s d s A2 A
1

2 w1
2
- I EIT1 s d B2 A
1

w1
-
2 I d2 A12 A
1

w1 w2
2
- I d2 A12 A
1

4 w1
2 w2
+ I d2 A1 A2 A
2

2 w1
3
+
2 I d2 A1 A2 A
2

w1 H2 w1 w2 + w2
2L
- I EI T1 s d A2 B
1

w1
,
D2A2 ﬁ-HD1B2L - I E-I T1 s d s A1
2

4 w22
- I E-I T1 s d A1 B1

w2
- I d2 A1 A2 A
1

2 w1 w22
+
2 I d2 A1 A2 A
1

w2 H2 w1 w2 + w22L
>
 Reconstitution
Using SCond1Rule1 and SCond2Rule1, we reconstitute the modulation equations as
126
Chapter5.nb

moduEq = Table@2 I wk Ak¢, 8k, 2<D ==
HTable@2 I wk dt@1D@ Ak@T1, T2DD, 8k, 2<D . SCond1Rule1 . SCond2Rule1  Expand 
Collect@#, eD &L  Thread;
moduEq . displayRule
:2 I w1 A1
¢ ==
2 EI T1 s d e A2 A
1 + e2 i
k
jjjj-2 I HD1B1L w1 + 2 EI T1 s d B2 A
1 - EIT1 s d s A2 A
1

w1
+ 4 d2 A1
2 A
1

w22
+ d2 A1
2 A
1

2 w1 w2
-
d2 A1 A2 A
2

w12
- 4 d2 A1 A2 A
2

2 w1 w2 + w22 + 2 EIT1 s d A2 B
1
y
{
zzzz, 2 I w2 A2
¢ ==
E-I T1 s d e A1
2 + e2 i
k
jjj2 E-I T1 s d A1 B1 + E-I T1 s d s A1
2

2 w2
- 2 I HD1B2L w2 + d2 A1 A2 A
1

w1 w2
- 4 d2 A1 A2 A
1

2 w1 w2 + w2
2
y
{
zzz>
Without including the Bi in the second-order solution, the following two coefficients:
CoefficientAmoduEq@@1, 2DD, A1@T1, T2D A2@T1, T2D A
2@T1, T2DE . w2 -> 2 w1  Simplify
- 3d2 e2

2 w1
2
CoefficientAmoduEq@@2, 2DD, A1@T1, T2D A2@T1, T2D A
1@T1, T2DE . w2 -> 2 w1  Simplify
0
are not the same,  which violates  the conservative nature  of the system in that  the modulation equations must be derivable
from a  Lagrangian. Using the flexibility given by the homogeneous  parts  of the solutions of the second-order problem, we
choose the functions Bi@tD so that these coefficients are the same. To this end, we assume that
BForm = 9B1 -> FunctionA8T1, T2<, c1 EI T1 s A
1@T1, T2D A2@T1, T2D E,
B
1 -> FunctionA8T1, T2<, c1 E-I T1 s A1@T1, T2D A
2@T1, T2D E,
B2 -> FunctionA8T1, T2<, c2 E-I T1 s A1@T1, T2D2 E=;
where c1 and c2  are undetermined constants. Substituting BForm and the solvability conditions into the right-hand sides of
moduEq yields
moduEqMod = HExpand@# . BForm . SCond1Rule1 . ccSCond1Rule1D &  moduEqL  ExpandAll;
moduEqMod . displayRule
:2 I w1 A1
¢ == 2 EI T1 s d e A2 A
1 + 2 d e2 A1
2 c2 A
1 - EI T1 s d e2 s A2 A
1

w1
+ 2 EI T1 s e2 s A2 c1 w1 A
1 + 4 d2 e2 A1
2 A
1

w22
+
d2 e2 A1
2 A
1

2 w1 w2
- d e2 A1
2 c1 w1 A
1

w2
+ 4 d e2 A1 A2 c1 A
2 - d2 e2 A1 A2 A
2

w1
2
- 4 d2 e2 A1 A2 A
2

2 w1 w2 + w2
2
,
2 I w2 A2
¢ == E-I T1 s d e A1
2 + E-I T1 s d e2 s A1
2

2 w2
- 2 E-I T1 s e2 s A1
2 c2 w2 + 2 d e2 A1 A2 c1 A
1 +
d2 e2 A1 A2 A
1

w1 w2
- 4 d e2 A1 A2 c2 w2 A
1


w1
- 4 d2 e2 A1 A2 A
1

2 w1 w2 + w22
>
Chapter5.nb
127

In order that the moduEqMod be derivable from a Lagrangian, the following condition must be satisfied:
CoefficientAmoduEqMod@@1, 2DD, A1@T1, T2D A2@T1, T2D A
2@T1, T2DE -
CoefficientAmoduEqMod@@2, 2DD, A1@T1, T2D A2@T1, T2D A
1@T1, T2DE == 0 . e -> 1 . w2 -> 2 w1
2 d c1 + 8 d c2 - 3 d2

2 w1
2 == 0
This provides a compatibility condition. However, one extra constant is floating !!!
To obtain  a consistent second-order uniform expansion, we apply  the method of multiple scales  to the system of four first-
order real-valued  equations EOM2  in  Section 5.2.2 and to  a system of two first-order complex-valued equations in Section
5.2.3.
 5.2.2 First-Order Real-Valued System
As  shown  in  the  preceding  section, treating  the  second-order form of the  equations  governing  a  system may lead  to
inconsistent  results  unless  appropriate  parts  of the homogeneous  solutions  of the  perturbation equations  are included.
Moreover, the consistent expansions might contain arbitrary constants that need to be chosen judiciously. In this section,
we show that treatment of an equivalent set of first-order real-valued equations, namely EOM2, leads to consistent results
without floating constants.
We seek a second-order uniform expansion of the solution of EOM2 in the form
solRule =
9ui_ -> ISumAej ui,j@#1, #2, #3D, 8j, 3<E &M, vi_ -> ISumAej vi,j@#1, #2, #3D, 8j, 3<E &M=;
Expressing the time derivative in EOM2 in terms of the time scales T0, T1, and T2, we have
multiScales = 9u_i_@tD -> ui@T0, T1, T2D, Derivative@n_DAu_i_E@tD :> dt@nD@ui@T0, T1, T2DD=;
Substituting multiScales  and solRule into  EOM2, expanding the  result  for small e, and discarding  terms  of order higher
than e3, we obtain
eq522a = HEOM2 . multiScales . solRule  ExpandAllL . en_;n>3 -> 0;
Equating coefficients of like powers of e, we obtain
eqEps = Rest@Thread@CoefficientList@Subtract  #, eD == 0DD &  eq522a  Transpose;
To place the linear operators on one side and the nonhomogeneous terms on the other side, we define
eqOrder@i_D := I#@@1DD &  eqEps@@1DD . u_k_,1 -> uk,iM ==
I#@@1DD &  eqEps@@1DD . u_k_,1 -> uk,iM - H#@@1DD &  eqEps@@iDDL  Thread
Using eqOrder[i] and displayRule, we rewrite eqEps in a concise way as
128
Chapter5.nb

eqOrder@1D . displayRule  TableForm
eqOrder@2D . displayRule  TableForm
eqOrder@3D . displayRule  TableForm
D0u1,1 - v1,1 == 0
D0v1,1 + w12 u1,1 == 0
D0u2,1 - v2,1 == 0
D0v2,1 + w2
2 u2,1 == 0
D0u1,2 - v1,2 == -HD1u1,1L
D0v1,2 + w1
2 u1,2 == -HD1v1,1L + 2 d u1,1 u2,1
D0u2,2 - v2,2 == -HD1u2,1L
D0v2,2 + w2
2 u2,2 == -HD1v2,1L + d u1,1
2
D0u1,3 - v1,3 == -HD1u1,2L - D2u1,1
D0v1,3 + w12 u1,3 == -HD1v1,2L - D2v1,1 + 2 d u1,2 u2,1 + 2 d u1,1 u2,2
D0u2,3 - v2,3 == -HD1u2,2L - D2u2,1
D0v2,3 + w22 u2,3 == -HD1v2,2L - D2v2,1 + 2 d u1,1 u1,2
 First-Order Equations
The homogeneous solution of eqOrder[1] can be obtained by using
eigenForm = #@@2DD Exp@#@@1DD T0D &  Transpose@Eigensystem@matrixADD
:: I E-I T0 w1

w1
, E-I T0 w1, 0, 0>, :- I EI T0 w1

w1
, EI T0 w1, 0, 0>,
:0, 0, I E-I T0 w2

w2
, E-I T0 w2 >, :0, 0, - I EI T0 w2

w2
, EI T0 w2>>
sol1hForm = FlattenATableAI wi 9-A
i@T1, T2D, Ai@T1, T2D=, 8i, 2<EE.eigenForm
8EI T0 w1 A1@T1, T2D + E-I T0 w1 A
1@T1, T2D, I EI T0 w1 w1 A1@T1, T2D - I E-I T0 w1 w1 A
1@T1, T2D,
EI T0 w2 A2@T1, T2D + E-I T0 w2 A
2@T1, T2D, I EI T0 w2 w2 A2@T1, T2D - I E-I T0 w2 w2 A
2@T1, T2D<
Since the first-order equations are homogeneous, the solution of eqOrder[1] can be expressed as
states1 = 8u1,1, v1,1, u2,1, v2,1<;
sol1 = Table@states1@@iDD -> Function@8T0, T1, T2<, sol1hForm@@iDD  EvaluateD, 8i, 4<D
8u1,1 ﬁFunction@8T0, T1, T2<, EI T0 w1 A1@T1, T2D + E-I T0 w1 A
1@T1, T2DD,
v1,1 ﬁFunction@8T0, T1, T2<, I EI T0 w1 w1 A1@T1, T2D - I E-I T0 w1 w1 A
1@T1, T2DD,
u2,1 ﬁFunction@8T0, T1, T2<, EI T0 w2 A2@T1, T2D + E-I T0 w2 A
2@T1, T2DD,
v2,1 ﬁFunction@8T0, T1, T2<, I EI T0 w2 w2 A2@T1, T2D - I E-I T0 w2 w2 A
2@T1, T2DD<
Chapter5.nb
129

 Second-Order Equations
Substituting the first-order solution into the second-order equations, eqOrder[2], yields
order2Eq = eqOrder@2D . sol1  ExpandAll;
order2Eq . displayRule
:D0u1,2 - v1,2 == -EI T0 w1 HD1A1L - E-I T0 w1 HD1A
1L,
D0v1,2 + w1
2 u1,2 == 2 EIT0 w1+I T0 w2 d A1 A2 - I EI T0 w1 HD1A1L w1 + I E-I T0 w1 HD1A
1L w1 + 2 E-I T0 w1+I T0 w2 d A2 A
1 +
2 EI T0 w1-I T0 w2 d A1 A
2 + 2 E-I T0 w1-IT0 w2 d A
1 A
2, D0u2,2 - v2,2 == -EI T0 w2 HD1A2L - E-I T0 w2 HD1A
2L,
D0v2,2 + w2
2 u2,2 == E2I T0 w1 d A1
2 - I EI T0 w2 HD1A2L w2 + I E-I T0 w2 HD1A
2L w2 + 2 d A1 A
1 + E-2 I T0 w1 d A
1
2>
Next, we substitute the  expRule1[i] into the  right-hand sides  of order2Eq to  transform the  small-divisor terms  into  secular
terms, collect the terms responsible for secular terms, and obtain
ST11 = Coefficient@#@@2DD . expRule1@1D, Exp@I w1 T0DD &  order2Eq;
ST11 . displayRule
8-HD1A1L, -I HD1A1L w1 + 2 EI T1 s d A2 A
1, 0, 0<
ST12 = Coefficient@#@@2DD . expRule1@2D, Exp@I w2 T0DD &  order2Eq;
ST12 . displayRule
80, 0, -HD1A2L, E-I T1 s d A1
2 - I HD1A2L w2<
The solvability conditions of the second-order equations demands that ST11 and ST12 be orthogonal to every  solution of
the adjoint homogeneous problems, namely the components of ccleftVec. Imposing these conditions, we obtain
SCond1 = 8ccleftVec@@1DD.ST11 == 0, ccleftVec@@2DD.ST12 == 0<;
SCond1 . displayRule
8-2 I HD1A1L w1 + 2 EI T1 s d A2 A
1 == 0, E-I T1 s d A1
2 - 2 I HD1A2L w2 == 0<
or
SCond1Rule1 = SolveASCond1, 9A1
H1,0L@T1, T2D, A2
H1,0L@T1, T2D=E@@1DD;
SCond1Rule1 . displayRule
:D1A1 ﬁ- I EIT1 s d A2 A
1

w1
, D1A2 ﬁ- I E-I T1 s d A1
2

2 w2
>
whose complex conjugate is
ccSCond1Rule1 = SCond1Rule1 . conjugateRule;
Using these solvability conditions and expRule3, we rewrite order2Eq as
130
Chapter5.nb

order2Eqm = order2Eq . SCond1Rule1 . ccSCond1Rule1 . expRule3;
order2Eqm . displayRule
9D0u1,2 - v1,2 == I E-IT0 w1+I T0 w2 d A2 A
1


w1
- I EI T0 w1-I T0 w2 d A1 A
2


w1
, D0v1,2 + w1
2 u1,2 ==
2 EI T0 w1+I T0 w2 d A1 A2 + E-I T0 w1+I T0 w2 d A2 A
1 + EI T0 w1-I T0 w2 d A1 A
2 + 2 E-I T0 w1-I T0 w2 d A
1 A
2,
D0u2,2 - v2,2 == I E2I T0 w1 d A12

2 w2
- I E-2 I T0 w1 d A
1
2

2 w2
,
D0v2,2 + w2
2 u2,2 == 1
2
E2 I T0 w1 d A1
2 + 2 d A1 A
1 + 1
2
E-2 IT0 w1 d A
1
2=
Transforming order2Eqm into a set of ordinary-differential equations and using DSolve, we obtain the particular solutions as
Isol2p = DSolveAorder2Eqm . u_i_,2 -> Hui,2@#1D &L,
8u1,2@T0D, v1,2@T0D, u2,2@T0D, v2,2@T0D<, T0E@@1DD . C@_D -> 0  Simplify;M  Timing
813.139 Second, Null<
Hence, the second-order solutions of order2Eqm can be expressed as
states2 = states1 . u_i_,1 -> ui,2
8u1,2, v1,2, u2,2, v2,2<
sol2 = Table@states2@@iDD -> Function@8T0, T1, T2<,
Expand@sol2p@@i, 2DDD . Exp@a_D :> Exp@a  ExpandD  EvaluateD, 8i, 4<D;
sol2 . displayRule
9u1,2 ﬁFunctionB8T0, T1, T2<, - 2 EI T0 w1+I T0 w2 d A1 A2


w2 H2 w1 + w2L
+ E-IT0 w1+I T0 w2 d A2 A
1


w1 H2 w1 + w2L
+
2 E-IT0 w1+I T0 w2 d A2 A
1


w2 H2 w1 + w2L
+ EIT0 w1-I T0 w2 d A1 A
2


w1 H2 w1 + w2L
+ 2 EIT0 w1-I T0 w2 d A1 A
2


w2 H2 w1 + w2L
- 2 E-I T0 w1-I T0 w2 d A
1 A
2


w2 H2 w1 + w2L
F,
v1,2 ﬁFunctionB8T0, T1, T2<, - 2 I EIT0 w1+I T0 w2 d A1 A2


2 w1 + w2
- 2 I EI T0 w1+I T0 w2 d w1 A1 A2


w2 H2 w1 + w2L
-
I E-IT0 w1+I T0 w2 d A2 A
1


2 w1 + w2
- 2 I E-I T0 w1+I T0 w2 d w1 A2 A
1


w2 H2 w1 + w2L
+ I EI T0 w1-I T0 w2 d A1 A
2


2 w1 + w2
+
2 I EIT0 w1-I T0 w2 d w1 A1 A
2


w2 H2 w1 + w2L
+ 2 I E-I T0 w1-I T0 w2 d A
1 A
2


2 w1 + w2
+ 2 I E-I T0 w1-I T0 w2 d w1 A
1 A
2


w2 H2 w1 + w2L
F,
u2,2 ﬁFunctionA8T0, T1, T2<,
E2I T0 w1 d A1
2

2 w2 H2 w1 + w2L
+
4 d w1 A1 A
1

w22 H2 w1 + w2L
+
2 d A1 A
1

w2 H2 w1 + w2L
+
E-2 I T0 w1 d A
1
2

2 w2 H2 w1 + w2L
E,
v2,2 ﬁFunctionA8T0, T1, T2<, - I E2 IT0 w1 d A1
2

2 H2 w1 + w2L
+ I E-2 I T0 w1 d A
1
2

2 H2 w1 + w2L
E=
Chapter5.nb
131

 Third-Order Equations
Substituting the first- and second-order solutions into the right-hand sides of the third-order equations, eqOrder[3], yields
order3Eqrhs = Expand@#@@2DD . sol1 . sol2D &  eqOrder@3D;
To eliminate the terms  that lead to secular terms  from order3Eqrhs, we use expRule1[i] to transform the terms  that convert
small-divisor terms into secular terms, calculate the vectors proportional to the EI wi T0, and obtain
ST21 = Coefficient@order3Eqrhs . expRule1@1D, Exp@I w1 T0DD;
ST21 . displayRule
:-HD2A1L - EI T1 s d HD1A
1L A2

w1 H2 w1 + w2L
- 2 EI T1 s d HD1A
1L A2


w2 H2 w1 + w2L
- EI T1 s d HD1A2L A
1

w1 H2 w1 + w2L
- 2 EI T1 s d HD1A2L A
1


w2 H2 w1 + w2L
,
-I HD2A1L w1 + I EI T1 s d HD1A
1L A2


2 w1 + w2
+ 2 I EI T1 s d HD1A
1L A2 w1


w2 H2 w1 + w2L
+ I EI T1 s d HD1A2L A
1


2 w1 + w2
+
8 d2 A1
2 w1 A
1

w22 H2 w1 + w2L
+
5 d2 A1
2 A
1

w2 H2 w1 + w2L
+ 2 I EI T1 s d HD1A2L w1 A
1


w2 H2 w1 + w2L
+
2 d2 A1 A2 A
2

w1 H2 w1 + w2L
, 0, 0>
ST22 = Coefficient@order3Eqrhs . expRule1@2D, Exp@I w2 T0DD;
ST22 . displayRule
:0, 0, -HD2A2L - E-I T1 s d HD1A1L A1


w2 H2 w1 + w2L
, -I HD2A2L w2 + I E-IT1 s d HD1A1L A1


2 w1 + w2
+
2 d2 A1 A2 A
1

w1 H2 w1 + w2L
>
Hence, demanding that ST21 and ST22 be orthogonal to the components of ccleftVec yields the solvability conditions
SCond2 = 8Expand@ccleftVec@@1DD.ST21D == 0, Expand@ccleftVec@@2DD.ST22D == 0<;
SCond2 . displayRule
:-2 I HD2A1L w1 +
8 d2 A1
2 w1 A
1

w22 H2 w1 + w2L
+
5 d2 A1
2 A
1

w2 H2 w1 + w2L
+
2 d2 A1 A2 A
2

w1 H2 w1 + w2L
== 0,
-2 I HD2A2L w2 +
2 d2 A1 A2 A
1

w1 H2 w1 + w2L
== 0>
or
SCond2Rule1 = SolveASCond2, 9A1
H0,1L@T1, T2D, A2
H0,1L@T1, T2D=E@@1DD;
SCond2Rule1 . displayRule
:D2A1 ﬁ- I H8 d2 A1
2 w1
2 A
1 + 5 d2 A1
2 w1 w2 A
1 + 2 d2 A1 A2 w2
2 A
2L




2 w12 w22 H2 w1 + w2L
, D2A2 ﬁ-
I d2 A1 A2 A
1

w1 w2 H2 w1 + w2L
>
 Reconstitution
We reconstitute SCond1Rule1 and SCond2Rule1 and obtain
132
Chapter5.nb

moduEq = Table@2 I wk Ak¢, 8k, 2<D ==
HTable@2 I wk dt@1D@ Ak@T1, T2DD, 8k, 2<D . SCond1Rule1 . SCond2Rule1 
ExpandL  Thread;
moduEq . displayRule
:2 I w1 A1
¢ == 2 EI T1 s d e A2 A
1 + 8 d2 e2 A1
2 w1 A
1

w22 H2 w1 + w2L
+
5 d2 e2 A1
2 A
1

w2 H2 w1 + w2L
+ 2 d2 e2 A1 A2 A
2

w1 H2 w1 + w2L
,
2 I w2 A2
¢ == E-I T1 s d e A1
2 + 2 d2 e2 A1 A2 A
1

w1 H2 w1 + w2L
>
These equations are derivable from a Lagrangian because
CoefficientAmoduEq@@1, 2DD, A1@T1, T2D A2@T1, T2D A
2@T1, T2DE -
CoefficientAmoduEq@@2, 2DD, A1@T1, T2D A2@T1, T2D A
1@T1, T2DE == 0 . e -> 1 . w2 -> 2 w1
True
Therefore,  treatment  of  the  first-order  version  of  the  governing  equations  yields  consistent  results  without  floating
constants.
 5.2.3 First-Order Complex-Valued System
In this section, we show that treatment of a first-order complex -valued version of the governing equations yields consistent
results  without floating constants. We start by transforming the second-order form EOM1 of the governing equations into a
system of first-order complex-valued equations by introducing the transformation
transfRule = 9uk_@tD -> zk@tD + z
k@tD, uk_¢@tD -> I wk Izk@tD - z
k@tDM=;
Then, we define the dependent variables
depVar = 8u1@tD, u1
¢@tD, u2@tD, u2
¢@tD<;
nmodes = 9z1@tD, z
1@tD, z2@tD, z
2@tD=;
Substituting transfRule into depVar and solving for the nmodes, we obtain
zetaRule = Solve@depVar == HdepVar . transfRuleL  Thread, nmodesD@@1DD
:z1@tD ﬁ- -w1 u1@tD + I u1
¢ @tD


2 w1
, z
1@tD ﬁ- -w1 u1@tD - I u1
¢ @tD


2 w1
,
z2@tD ﬁ- -w2 u2@tD + I u2
¢ @tD


2 w2
, z
2@tD ﬁ- -w2 u2@tD - I u2
¢ @tD


2 w2
>
It follows from EOM1 that the acceleration is given by
acceleration = Solve@EOM1, 8u1†@tD, u2†@tD<D@@1DD
8u1
†@tD ﬁ-w1
2 u1@tD + 2 d u1@tD u2@tD, u2
†@tD ﬁd u1@tD2 - w2
2 u2@tD<
Chapter5.nb
133

Then, differentiating the dependent variables in zetaRule and using transfRule and acceleration, we transform the system of
two second-order equations EOM1 into the following two first-order complex-valued equations:
EOM3 = z#
¢@tD == HD@z#@tD . zetaRule, tD . acceleration . transfRule  ExpandL &  81, 2<
:z1
¢ @tD == I w1 z1@tD - I d z1@tD z2@tD

w1
- I d z2@tD z
1@tD

w1
- I d z1@tD z
2@tD

w1
- I d z
1@tD z
2@tD

w1
,
z2
¢ @tD == - I d z1@tD2

2 w2
+ I w2 z2@tD - I d z1@tD z
1@tD

w2
- I d z
1@tD
2

2 w2
>
To determine a second-order uniform expansion of the solution of EOM3 using the method of multiple  scales, we expand z
and z in the form
solRule =
9zi_ -> ISumAej zi,j@#1, #2, #3D, 8j, 3<E &M, z
i_ -> ISumAej z
i,j@#1, #2, #3D, 8j, 3<E &M=;
eq523a = HEOM3 . multiScales . solRule  ExpandAllL . en_;n>3 -> 0;
Equating coefficients of like powers of e, we obtain
eqEps = Rest@Thread@CoefficientList@Subtract  #, eD == 0DD &  eq523a  Transpose;
To place the linear operator on one side and the nonhomogeneous terms on the other side, we define
eqOrder@i_D := I#@@1DD &  eqEps@@1DD . u_k_,1 -> uk,iM ==
I#@@1DD &  eqEps@@1DD . u_k_,1 -> uk,iM - H#@@1DD &  eqEps@@iDDL  Thread
Using eqOrder[i] and the displayRule, we rewrite eqEps in a concise way as
eqOrder@1D . displayRule  TableForm
eqOrder@2D . displayRule  TableForm
eqOrder@3D . displayRule  TableForm
D0z1,1 - I w1 z1,1 == 0
D0z2,1 - I w2 z2,1 == 0
D0z1,2 - I w1 z1,2 == -HD1z1,1L - I d z1,1 z2,1

w1
- I dz2,1 z
1,1

w1
- I d z1,1 z
2,1

w1
- I d z
1,1 z
2,1

w1
D0z2,2 - I w2 z2,2 == -HD1z2,1L - I d z1,1
2

2 w2
- I d z1,1 z
1,1

w2
- Id z
1,1
2

2 w2
D0z1,3 - I w1 z1,3 == -HD1z1,2L - D2z1,1 - I d z1,2 z2,1

w1
- I d z1,1 z2,2

w1
- I d z2,2 z
1,1

w1
- I dz2,1 z
1,2

w1
- I d z1,2 z
2,1

w1
- I d z
1,2

w1
D0z2,3 - I w2 z2,3 == -HD1z2,2L - D2z2,1 - I d z1,1 z1,2

w2
- I d z1,2 z
1,1

w2
- I d z1,1 z
1,2

w2
- I dz
1,1 z
1,2

w2
 First-Order Equations
Since eqOrder[1] are homogeneous, we can write their solutions as
134
Chapter5.nb

sol1 = TableA9zi,1 -> Function@8T0, T1, T2<, Ai@T1, T2D Exp@I wi T0D  EvaluateD,
z
i,1 -> FunctionA8T0, T1, T2<, A
i@T1, T2D Exp@-I wi T0D  EvaluateE=, 8i, 2<E  Flatten
8z1,1 ﬁFunction@8T0, T1, T2<, EI T0 w1 A1@T1, T2DD,
z
1,1 ﬁFunction@8T0, T1, T2<, E-I T0 w1 A
1@T1, T2DD,
z2,1 ﬁFunction@8T0, T1, T2<, EI T0 w2 A2@T1, T2DD,
z
2,1 ﬁFunction@8T0, T1, T2<, E-I T0 w2 A
2@T1, T2DD<
 Second-Order Equations
Substituting the first-order solution into the second-order equations, eqOrder[2], we have
order2Eq = eqOrder@2D . sol1;
order2Eq . displayRule
9D0z1,2 - I w1 z1,2 == -EI T0 w1 HD1A1L - I EI T0 w1+I T0 w2 d A1 A2


w1
-
I E-IT0 w1+I T0 w2 d A2 A
1


w1
- I EIT0 w1-I T0 w2 d A1 A
2


w1
- I E-I T0 w1-I T0 w2 d A
1 A
2


w1
,
D0z2,2 - I w2 z2,2 == -EI T0 w2 HD1A2L - I E2 I T0 w1 d A1
2

2 w2
- I d A1 A
1

w2
- I E-2 I T0 w1 d A
1
2

2 w2
=
Converting  the  terms  that produce  small-divisor terms  by using  the  expRule1  and  then  eliminating the terms  that  lead  to
secular terms from order2Eq yields
SCond1 = Coefficient@order2Eq@@#, 2DD . expRule1@#D, Exp@I w# T0DD == 0 &  81, 2<;
SCond1 . displayRule
:-HD1A1L - I EI T1 s d A2 A
1

w1
== 0, -HD1A2L - I E-I T1 s d A1
2

2 w2
== 0>
or
SCond1Rule1 = SolveASCond1, 9A1
H1,0L@T1, T2D, A2
H1,0L@T1, T2D=E@@1DD;
SCond1Rule1 . displayRule
:D1A1 ﬁ- I EIT1 s d A2 A
1

w1
, D1A2 ﬁ- I E-I T1 s d A1
2

2 w2
>
Substituting SCond1Rule1 and expRule3 into order2Eq yields
Chapter5.nb
135

order2Eqm = order2Eq . SCond1Rule1 . expRule3;
order2Eqm . displayRule
9D0z1,2 - I w1 z1,2 == - I EI T0 w1+IT0 w2 d A1 A2


w1
- I EI T0 w1-IT0 w2 d A1 A
2


w1
- I E-IT0 w1-I T0 w2 d A
1 A
2


w1
,
D0z2,2 - I w2 z2,2 == - I d A1 A
1

w2
- I E-2 I T0 w1 d A
1
2

2 w2
=
We transform order2Eqm into a set of ordinary-differential equations and obtain their particular solutions as
sol2p = DSolve@order2Eqm . zi_,2 -> Hzi,2@#1D &L, 8z1,2@T0D, z2,2@T0D<, T0D@@1DD . C@_D -> 0;
expRule4 = Exp@a_D :> Exp@Expand@aDD;
We write the second-order solution in function form as
sol2 = TableA9zi,2 -> Function@8T0, T1, T2<, Hsol2p@@i, 2DD  ExpandL . expRule4  EvaluateD,
z
i,2 -> Function@8T0, T1, T2<, Hsol2p@@i, 2DD  ExpandL . expRule4 . conjugateRule 
EvaluateD=, 8i, 2<E  Flatten;
sol2 . displayRule
9z1,2 ﬁFunctionB8T0, T1, T2<, - EI T0 w1+IT0 w2 d A1 A2


w1 H2 w1 + w2L
- 2 EI T0 w1+I T0 w2 d A1 A2


w2 H2 w1 + w2L
+
EI T0 w1-IT0 w2 d A1 A
2


w1 H2 w1 + w2L
+ 2 EI T0 w1-I T0 w2 d A1 A
2


w2 H2 w1 + w2L
+ E-I T0 w1-I T0 w2 d A
1 A
2


w1 H2 w1 + w2L
F,
z
1,2 ﬁFunctionB8T0, T1, T2<, EI T0 w1+I T0 w2 d A1 A2


w1 H2 w1 + w2L
+ E-I T0 w1+I T0 w2 d A2 A
1


w1 H2 w1 + w2L
+
2 E-IT0 w1+I T0 w2 d A2 A
1


w2 H2 w1 + w2L
- E-IT0 w1-I T0 w2 d A
1 A
2


w1 H2 w1 + w2L
- 2 E-I T0 w1-I T0 w2 d A
1 A
2


w2 H2 w1 + w2L
F,
z2,2 ﬁFunctionA8T0, T1, T2<,
2 d w1 A1 A
1

w22 H2 w1 + w2L
+
d A1 A
1

w2 H2 w1 + w2L
+
E-2I T0 w1 d A
1
2

2 w2 H2 w1 + w2L
E,
z
2,2 ﬁFunctionB8T0, T1, T2<,
E2I T0 w1 d A1
2

2 w2 H2 w1 + w2L
+
2 d w1 A1 A
1

w2
2 H2 w1 + w2L
+
d A1 A
1

w2 H2 w1 + w2L
F=
 Third-Order Equations
Substituting  the  first-  and  second-order solutions  into  the  right-hand  sides  of the  third-order equations, eqOrder[3], we
obtain
order3Eqrhs = Expand@#@@2DD . sol1 . sol2D &  eqOrder@3D;
Converting  the  terms  that  produce  small-divisor  terms  and  eliminating  the  terms  that  produce  secular  terms  in  z i,3  from
order3Eqrhs demands the following conditions:
136
Chapter5.nb

SCond2 = Coefficient@order3Eqrhs@@#DD . expRule1@#D, Exp@I w# T0DD == 0 &  81, 2<;
SCond2 . displayRule
:-HD2A1L -
4 I d2 A12 A
1

w2
2 H2 w1 + w2L
-
5 I d2 A12 A
1


2 w1 w2 H2 w1 + w2L
-
I d2 A1 A2 A
2

w1
2 H2 w1 + w2L
== 0, -HD2A2L -
I d2 A1 A2 A
1

w1 w2 H2 w1 + w2L
== 0>
or
SCond2Rule1 = SolveASCond2, 9A1
H0,1L@T1, T2D, A2
H0,1L@T1, T2D=E@@1DD;
SCond2Rule1 . displayRule
:D2A1 ﬁ- I H8 d2 A1
2 w1
2 A
1 + 5 d2 A1
2 w1 w2 A
1 + 2 d2 A1 A2 w2
2 A
2L




2 w12 w22 H2 w1 + w2L
, D2A2 ﬁ-
I d2 A1 A2 A
1

w1 w2 H2 w1 + w2L
>
 Reconstitution
We reconstitute SCond1Rule1 and SCond2Rule1 and obtain
moduEq = Table@2 I wk Ak
¢, 8k, 2<D ==
HTable@2 I wk dt@1D@ Ak@T1, T2DD, 8k, 2<D . SCond1Rule1 . SCond2Rule1 
ExpandL  Thread;
moduEq . displayRule
:2 I w1 A1
¢ == 2 EI T1 s d e A2 A
1 + 8 d2 e2 A1
2 w1 A
1

w2
2 H2 w1 + w2L
+
5 d2 e2 A1
2 A
1

w2 H2 w1 + w2L
+ 2 d2 e2 A1 A2 A
2

w1 H2 w1 + w2L
,
2 I w2 A2
¢ == E-I T1 s d e A1
2 + 2 d2 e2 A1 A2 A
1

w1 H2 w1 + w2L
>
à 5.3 Method of Normal Forms
To apply the method of normal forms, we find it convenient to start with the first-order complex-valued form EOM3
EOM3 = 9z1
¢ @tD == I w1 z1@tD - I d z1@tD z2@tD

w1
- I d z2@tD z
1@tD

w1
- I d z1@tD z
2@tD

w1
- I d z
1@tDz
2@tD

w1
,
z2
¢ @tD == - I d z1@tD2

2 w2
+ I w2 z2@tD - I d z1@tD z
1@tD

w2
- I d z
1@tD
2

2 w2
=;
of the governing equations. Then, according to the method of normal forms, we introduce the near-identity transformation
basicTerms = Table@8hk@tD, h
k@tD<, 8k, 2<D  Flatten
8h1@tD, h
1@tD, h2@tD, h
2@tD<
Chapter5.nb
137

zetaRule =
9zi_ -> FunctionAt, e hi@tD + SumAej+1 hi,j@Sequence  basicTermsD, 8j, 2<E  EvaluateE,
z
i_ -> FunctionAt, e h
i@tD + SumAej+1 h
i,j@Sequence  basicTermsD, 8j, 2<E  EvaluateE=
8zi_ ﬁFunction@t,
e hi@tD + e2 hi,1@h1@tD, h
1@tD, h2@tD, h
2@tDD + e3 hi,2@h1@tD, h
1@tD, h2@tD, h
2@tDDD, z
i_ ﬁ
Function@t, e h
i@tD + e2 h
i,1@h1@tD, h
1@tD, h2@tD, h
2@tDD + e3 h
i,2@h1@tD, h
1@tD, h2@tD, h
2@tDDD<
that results in the simplest possible equations
etaRule = hi_¢@tD -> I wi hi@tD + SumAej gi,j@tD, 8j, 2<E
hi_
¢ @tD ﬁI wi hi@tD + e gi,1@tD + e2 gi,2@tD
where the overbar denotes the complex conjugate
conjugateRule = 8h -> h, h -> h, g -> g, g -> g, Complex@0, n_D -> Complex@0, -nD<;
Substituting  the  expansion  for the  z i, the  zetaRule, into  EOM3, using  the etaRule, expanding  the  result  for small e, and
discarding terms of order higher than e3, we have
eq53a =
HEOM3 . zetaRule . etaRule . HetaRule . conjugateRuleL  ExpandAllL . en_;n>3 -> 0;
 Second-Order Equations
Collecting the coefficients of e2 in eq53a yields
order2expr = CoefficientASubtract  #, e2E &  eq53a;
To determine the resonance terms in order2expr, we note that all of the possible forms of its nonhomogeneous terms are
possibleQTerms = Outer@Times, basicTerms, basicTermsD  Flatten  Union
9h1@tD2, h1@tD h2@tD, h2@tD2, h1@tD h
1@tD,
h2@tD h
1@tD, h
1@tD2, h1@tD h
2@tD, h2@tD h
2@tD, h
1@tD h
2@tD, h
2@tD2=
It follows from the linear parts of the etaRule that to the first approximation
form = 9hi_@tD -> EI wi t, h
i_@tD -> E-I wi t=;
Hence, the possible resonance terms are given by
ResonantQTerm@1D =
IE-I w1 t possibleQTerms . form . w2 -> 2 w1 . E_ t -> 0M possibleQTerms  Union  Rest
8h2@tD h
1@tD<
138
Chapter5.nb

ResonantQTerm@2D =
i
k
jjE-I w2 t possibleQTerms . form . w1 -> 1
2
w2 . E_ t -> 0y
{
zz possibleQTerms  Union  Rest
8h1@tD2<
Then, the nonresonance terms and their associated coefficients can be defined as
Do@NRQT@iD = Complement@possibleQTerms, ResonantQTerm@iDD;
coeffsQ@iD = Table@Gi,j, 8j, Length@NRQT@iDD<D, 8i, 2<D
Thus, the hi,1 and their complex conjugates have the form
hFormQ =
TableA9hi,1 -> HEvaluate@coeffsQ@iD.NRQT@iD . Thread@basicTerms -> 8#1, #2, #3, #4<DD &L,
h
i,1 -> HEvaluate@coeffsQ@iD.NRQT@iD . conjugateRule .
Thread@basicTerms -> 8#1, #2, #3, #4<DD &L=, 8i, 2<E  Flatten;
Substituting for the hi,1 in order2expr, equating the coefficients of the possible nonresonance terms to zero, and solving the
resulting algebraic equations for the Gi, j, we obtain
coeffsQRule = Table@
Solve@Coefficient@order2expr@@iDD . hFormQ, NRQT@iDD == 0  Thread, coeffsQ@iDD@@1DD,
8i, 2<D  Flatten
:G1,1 ﬁ0, G1,2 ﬁ-
d

w1 w2
, G1,4 ﬁ0, G1,5 ﬁ0, G1,6 ﬁ
d

w1 w2
, G1,7 ﬁ0,
G1,3 ﬁ0, G1,8 ﬁ
d

w1 H2 w1 + w2L
, G1,9 ﬁ0, G2,1 ﬁ0, G2,2 ﬁ0, G2,3 ﬁ
d

w22 ,
G2,4 ﬁ0, G2,7 ﬁ0, G2,9 ﬁ0, G2,5 ﬁ
d

2 w2 H2 w1 + w2L
, G2,6 ﬁ0, G2,8 ﬁ0>
Using these coefficients, we rewrite hFormQ as
hSolQ = Table@hi,1@Sequence  basicTermsD ->
Hhi,1@Sequence  basicTermsD . hFormQ . coeffsQRuleL, 8i, 2<D
:h1,1@h1@tD, h
1@tD, h2@tD, h
2@tDD ﬁ- d h1@tD h2@tD

w1 w2
+ d h1@tD h
2@tD

w1 w2
+ d h
1@tD h
2@tD

w1 H2 w1 + w2L
,
h2,1@h1@tD, h
1@tD, h2@tD, h
2@tDD ﬁd h1@tD h
1@tD

w2
2
+
d h
1@tD2

2 w2 H2 w1 + w2L
>
or in pure function form as
hRuleQ = TableA9hi,1 -> HEvaluate@hSolQ@@i, 2DD . Thread@basicTerms -> 8#1, #2, #3, #4<DD &L,
h
i,1 -> HEvaluate@hSolQ@@i, 2DD . conjugateRule .
Thread@basicTerms -> 8#1, #2, #3, #4<DD &L=, 8i, 2<E  Flatten;
Chapter5.nb
139

We choose the gi,1 to eliminate the resonance terms in order2expr according to
gRuleQ = Table@
gi,1@tD -> - Coefficient@order2expr@@iDD, ResonantQTerm@iDD.ResonantQTerm@iD, 8i, 2<D
:g1,1@tD ﬁ- I d h2@tD h
1@tD

w1
, g2,1@tD ﬁ- I d h1@tD2

2 w2
>
 Third-Order Equations
Collecting the coefficients of e3 in eq53a and using hRuleQ and gRuleQ, we have
order3expr = MapACoefficientASubtract  #, e3E &, eq53aE . hRuleQ . gRuleQ .
HgRuleQ . conjugateRuleL  Expand;
The nonhomogeneous terms in order3expr are proportional to
possibleCTerms = Outer@Times, possibleQTerms, basicTermsD  Flatten  Union
9h1@tD3, h1@tD2 h2@tD, h1@tD h2@tD2, h2@tD3, h1@tD2 h
1@tD,
h1@tD h2@tD h
1@tD, h2@tD2 h
1@tD, h1@tD h
1@tD2, h2@tD h
1@tD2, h
1@tD3,
h1@tD2 h
2@tD, h1@tD h2@tD h
2@tD, h2@tD2 h
2@tD, h1@tD h
1@tD h
2@tD,
h2@tD h
1@tD h
2@tD, h
1@tD2 h
2@tD, h1@tD h
2@tD2, h2@tD h
2@tD2, h
1@tD h
2@tD2, h
2@tD3=
Next, we determine the resonance terms according to
ResonantCTerm@1D =
IE-I w1 t possibleCTerms . form . w2 -> 2 w1 . E_ t -> 0M possibleCTerms  Union  Rest
8h1@tD2 h
1@tD, h1@tD h2@tD h
2@tD<
ResonantCTerm@2D =
i
k
jE-I w2 t possibleCTerms . form . w1 -> 1
2
w2 . E_ t -> 0y
{
z possibleCTerms  Union  Rest
8h1@tD h2@tD h
1@tD, h2@tD2 h
2@tD<
Then, the nonresonance terms and their associated coefficients are given by
Do@NRCT@iD = Complement@possibleCTerms, ResonantCTerm@iDD;
coeffsC@iD = Table@Li,j, 8j, Length@NRCT@iDD<D, 8i, 2<D
Consequently, the hi,2 and their complex conjugates have the forms
hFormC =
TableA9hi,2 -> HEvaluate@coeffsC@iD.NRCT@iD . Thread@basicTerms -> 8#1, #2, #3, #4<DD &L,
h
i,2 -> HEvaluate@coeffsC@iD.NRCT@iD . conjugateRule .
Thread@basicTerms -> 8#1, #2, #3, #4<DD &L=, 8i, 2<E  Flatten;
140
Chapter5.nb

Substituting for the hi,2 in order3expr, equating the coefficient of each possible  nonresonance term to zero, and solving the
resulting algebraic equations for the Li, j, we obtain
coeffsCRule = Table@
Solve@Coefficient@order3expr@@iDD . hFormC, NRCT@iDD == 0  Thread, coeffsC@iDD@@1DD,
8i, 2<D  Flatten
:L1,1 ﬁ-
d2 w1 + d2 w2


2 w12 w22 H2 w1 + w2L
, L1,3 ﬁ
d2

w1 w22 H2 w1 + w2L
, L1,7 ﬁ- -5 d2 w1 - 3 d2 w2


2 w12 w22 H2 w1 + w2L
,
L1,9 ﬁ
d2


4 w1
2 w2 H2 w1 + w2L
, L1,13 ﬁ-
d2

w1
2 w2 H2 w1 + w2L
, L1,15 ﬁ-
-d2 w1 - d2 w2

w1
2 w2
2 H2 w1 + w2L
,
L1,2 ﬁ0, L1,16 ﬁ0, L1,4 ﬁ0, L1,17 ﬁ-
d2


w1 w2 Hw1 + w2L H2 w1 + w2L
, L1,5 ﬁ0,
L1,18 ﬁ0, L1,10 ﬁ0, L1,8 ﬁ0, L1,6 ﬁ
d2

w1
2 Hw1 - w2L w2
, L1,11 ﬁ0, L1,14 ﬁ0, L1,12 ﬁ0,
L2,2 ﬁ
d2

w1 w2
2 H2 w1 + w2L
, L2,4 ﬁ0, L2,8 ﬁ0, L2,12 ﬁ
d2

w1 w2
2 H2 w1 + w2L
, L2,16 ﬁ0, L2,18 ﬁ0,
L2,1 ﬁ0, L2,3 ﬁ0, L2,5 ﬁ0, L2,6 ﬁ0, L2,7 ﬁ0, L2,9 ﬁ0, L2,10 ﬁ-
d2

w1 Hw1 - w2L w22 ,
L2,11 ﬁ0, L2,17 ﬁ0, L2,13 ﬁ0, L2,14 ﬁ-
d2


w22 Hw1 + w2L H2 w1 + w2L
, L2,15 ﬁ0>
Using these coefficients, we rewrite hFormC as
hSolC = Table@hi,2@Sequence  basicTermsD ->
Hhi,2@Sequence  basicTermsD . hFormC . coeffsCRuleL, 8i, 2<D
:h1,2@h1@tD, h
1@tD, h2@tD, h
2@tDD ﬁ- Hd2 w1 + d2 w2L h1@tD3


2 w1
2 w2
2 H2 w1 + w2L
+ d2 h1@tD h2@tD2

w1 w2
2 H2 w1 + w2L
+ d2 h2@tD2 h
1@tD

w1
2 Hw1 - w2L w2
-
H-5 d2 w1 - 3 d2 w2L h1@tD h
1@tD2



2 w12 w22 H2 w1 + w2L
+
d2 h
1@tD3


4 w12 w2 H2 w1 + w2L
- d2 h2@tD h
1@tD h
2@tD


w12 w2 H2 w1 + w2L
-
H-d2 w1 - d2 w2L h1@tD h
2@tD2


w12 w22 H2 w1 + w2L
-
d2 h
1@tD h
2@tD2


w1 w2 Hw1 + w2L H2 w1 + w2L
, h2,2@h1@tD, h
1@tD, h2@tD, h
2@tDD ﬁ
d2 h1@tD2 h2@tD

w1 w2
2 H2 w1 + w2L
- d2 h1@tD2 h
2@tD

w1 Hw1 - w2L w2
2
+ d2 h1@tD h
1@tD h
2@tD


w1 w2
2 H2 w1 + w2L
-
d2 h
1@tD2 h
2@tD


w2
2 Hw1 + w2L H2 w1 + w2L
>
or in pure function form as
hRuleC = TableA9hi,2 -> HEvaluate@hSolC@@i, 2DD . Thread@basicTerms -> 8#1, #2, #3, #4<DD &L,
h
i,2 -> HEvaluate@hSolC@@i, 2DD . conjugateRule .
Thread@basicTerms -> 8#1, #2, #3, #4<DD &L=, 8i, 2<E  Flatten;
Choosing the gi,2 to eliminate the resonance terms from order3expr yields
Chapter5.nb
141

gRuleC = Table@
gi,2@tD -> - Coefficient@order3expr@@iDD, ResonantCTerm@iDD.ResonantCTerm@iD, 8i, 2<D
:g1,2@tD ﬁ-i
k
jj 2 I d2

w1 w2
2 +
I d2


2 w1 w2 H2 w1 + w2L
y
{
zz h1@tD2 h
1@tD - I d2 h1@tD h2@tD h
2@tD


w1
2 H2 w1 + w2L
,
g2,2@tD ﬁ- I d2 h1@tD h2@tD h
1@tD


w1 w2 H2 w1 + w2L
>
Combining etaRule, gRuleQ, and gRuleC and letting hi = Ai@tDEI wi t, we obtain the modulation equation
moduEq = TableA2 I wk E-I wk t Hhk¢@tD - Hhk¢@tD . etaRule . gRuleQ . gRuleCLL == 0 .
9hi_ -> IAi@#D EI wi # &M, h
i_ -> IA
i@#D E-I wi # &M= .
Exp@a_D :> ExpAa . w2 -> 2 w1 + e2 s  ExpandE  ExpandAll, 8k, 2<E
:- 4d2 e2 A1@tD2 A
1@tD


w22
- 2 d2 e2 w1 A1@tD2 A
1@tD


4 w12 w2 + 2 w1 w22
-
2 EI t e2 s d e A2@tD A
1@tD - 2 d2 e2 w1 A1@tD A2@tD A
2@tD


2 w13 + w12 w2
+ 2 I w1 A1
¢ @tD == 0,
-E-I t e2 s d e A1@tD2 - 2 d2 e2 w2 A1@tD A2@tD A
1@tD


2 w1
2 w2 + w1 w2
2
+ 2 I w2 A2
¢@tD == 0>
Using zetaRule, hRuleQ, and hRuleC, we obtain the following second-order uniform expansion of the solution of EOM3:
142
Chapter5.nb

solution = TableAuk@tD == CollectAzk@tD + z
k@tD . zetaRule . hRuleQ . hRuleC, eE, 8k, 2<E
:u1@tD == e Hh1@tD + h
1@tDL + e2 i
k
jj- d h1@tD h2@tD

w1 w2
+ d h1@tD h2@tD

w1 H2 w1 + w2L
+
d h2@tD h
1@tD

w1 w2
+ d h1@tD h
2@tD

w1 w2
- d h
1@tD h
2@tD

w1 w2
+ d h
1@tD h
2@tD

w1 H2 w1 + w2L
y
{
zz +
e3 i
k
jjjj
d2 h1@tD3


4 w1
2 w2 H2 w1 + w2L
- Hd2 w1 + d2 w2L h1@tD3


2 w1
2 w2
2 H2 w1 + w2L
+ d2 h1@tD h2@tD2

w1 w2
2 H2 w1 + w2L
-
d2 h1@tD h2@tD2


w1 w2 Hw1 + w2L H2 w1 + w2L
-
H-5 d2 w1 - 3 d2 w2L h1@tD2 h
1@tD



2 w12 w22 H2 w1 + w2L
+ d2 h2@tD2 h
1@tD

w12 Hw1 - w2L w2
- H-d2 w1 - d2 w2L h2@tD2 h
1@tD


w12 w22 H2 w1 + w2L
-
H-5 d2 w1 - 3 d2 w2L h1@tD h
1@tD2



2 w1
2 w2
2 H2 w1 + w2L
+
d2 h
1@tD3


4 w1
2 w2 H2 w1 + w2L
- Hd2 w1 + d2 w2L h
1@tD3


2 w1
2 w2
2 H2 w1 + w2L
-
d2 h1@tD h2@tD h
2@tD


w12 w2 H2 w1 + w2L
- d2 h2@tD h
1@tD h
2@tD


w12 w2 H2 w1 + w2L
+ d2 h1@tD h
2@tD2

w12 Hw1 - w2L w2
-
H-d2 w1 - d2 w2L h1@tD h
2@tD2


w1
2 w2
2 H2 w1 + w2L
+ d2 h
1@tD h
2@tD2

w1 w2
2 H2 w1 + w2L
-
d2 h
1@tD h
2@tD2


w1 w2 Hw1 + w2L H2 w1 + w2L
y
{
zzzz,
u2@tD == e2 i
k
jjjj
d h1@tD2

2 w2 H2 w1 + w2L
+ 2 d h1@tD h
1@tD

w2
2
+
d h
1@tD2

2 w2 H2 w1 + w2L
y
{
zzzz + e Hh2@tD + h
2@tDL +
e3 i
k
jjjj
d2 h1@tD2 h2@tD

w1 w22 H2 w1 + w2L
-
d2 h1@tD2 h2@tD


w22 Hw1 + w2L H2 w1 + w2L
+ d2 h1@tD h2@tD h
1@tD


w1 w22 H2 w1 + w2L
- d2 h2@tD h
1@tD2

w1 Hw1 - w2L w22
-
d2 h1@tD2 h
2@tD

w1 Hw1 - w2L w22
+ d2 h1@tD h
1@tD h
2@tD


w1 w22 H2 w1 + w2L
+ d2 h
1@tD2 h
2@tD

w1 w22 H2 w1 + w2L
-
d2 h
1@tD2 h
2@tD


w22 Hw1 + w2L H2 w1 + w2L
y
{
zzzz>
à 5.4 Generalized Method of Averaging 
We define the nonlinear part of EOM1, a transformation rule, and the states vector as
NLTerms = 9f1 -> 2 e d u1@tD u2@tD, f2 -> e d u1@tD2=;
transformRule = ui_ -> Hai@#D Sin@fi@#DD &L;
states = 8a1@tD, a2@tD, f1@tD, f2@tD<;
Substituting the above rules into the four first-order equations obtained by using the method of variation of parameters, we
have
Chapter5.nb
143

eq54a = D@states, tD ==
i
k
jj9 f1

w1
Cos@f1@tDD, f2

w2
 Cos@f2@tDD, w1 -
f1

a1@tD w1
Sin@f1@tDD, w2 -
f2

a2@tD w2
Sin@f2@tDD= .
NLTerms . transformRule  TrigReduce  Expandy
{
zz  Thread
:a1
¢ @tD == d e Cos@2 f1@tD - f2@tDD a1@tD a2@tD



2 w1
- d e Cos@2 f1@tD + f2@tDD a1@tD a2@tD



2 w1
, a2
¢@tD ==
- de Cos@2 f1@tD - f2@tDD a1@tD2



4 w2
+ d e Cos@f2@tDD a1@tD2


2 w2
- d e Cos@2 f1@tD + f2@tDD a1@tD2



4 w2
,
f1
¢ @tD == w1 - d e Sin@2 f1@tD - f2@tDD a2@tD


2 w1
- d e Sin@f2@tDD a2@tD


w1
+
d e Sin@2 f1@tD + f2@tDD a2@tD


2 w1
, f2
¢ @tD ==
w2 - d e Sin@2 f1@tD - f2@tDD a1@tD2



4 w2 a2@tD
- d e Sin@f2@tDD a1@tD2


2 w2 a2@tD
+ d e Sin@2 f1@tD + f2@tDD a1@tD2



4 w2 a2@tD
>
We seek a second-order approximate solution of eq54a in the form
basicTerms = 8h1@tD, h2@tD, j1@tD, j2@tD<;
solRule = 9 ai_ -> IEvaluateAhi@tD + SumAej ai,j@Sequence  basicTermsD, 8j, 2<E . t -> #E &M,
fi_ -> IEvaluateAji@tD + SumAej fi,j@Sequence  basicTermsD, 8j, 2<E . t -> #E &M=;
where the hi@tD and ji@tD are expanded in power series in e as
basicDRule =
D@basicTerms, tD -> 9SumAei A1,i@h1@tD, h2@tDD, 8i, 2<E, SumAei A2,i@h1@tD, h2@tDD, 8i, 2<E,
w1 + SumAei F1,i@h1@tD, h2@tDD, 8i, 2<E, w2 + SumAei F2,i@h1@tD, h2@tDD, 8i, 2<E=  Thread
8h1
¢ @tD ﬁe A1,1@h1@tD, h2@tDD + e2 A1,2@h1@tD, h2@tDD,
h2
¢ @tD ﬁe A2,1@h1@tD, h2@tDD + e2 A2,2@h1@tD, h2@tDD,
j1
¢ @tD ﬁw1 + e F1,1@h1@tD, h2@tDD + e2 F1,2@h1@tD, h2@tDD,
j2
¢ @tD ﬁw2 + e F2,1@h1@tD, h2@tDD + e2 F2,2@h1@tD, h2@tDD<
The functions ai, j and fi, j are fast varying functions of the ji, while it follows from basicDRule that the hi, and hence the
Ai, j and Fi, j, are slowly varying functions of t.
To the second approximation, we differentiate the ai@tD and fi@tD once with respect to t, use solRule and basicDRule, expand
the result for small e, discard terms of order higher than e2, and obtain
eq54bLHS =
CoefficientListAExpand@#@@1DD . solRule . basicDRuleD . en_;n>2 -> 0, eE &  eq54a;
Next, we substitute  solRule  into the  right-hand  sides  of eq54a, expand the  result  for small e, keep  terms  up  to  OHe2L, and
rewrite their right-hand sides as
eq54bRHS = CoefficientList@Series@#@@2DD . solRule, 8e, 0, 2<D  Normal, eD &  eq54a;
144
Chapter5.nb

Equating coefficients of like powers of e in eq54bLHS and eq54bRHS, we obtain
eqEps = MapThread@Equal, 8eq54bLHS, eq54bRHS<, 2D  Transpose  Rest;
To express the nearness of the two-to-one internal resonance, we introduce the detuning parameter s defined according to
omgRule = 8w2 -> 2 w1 + e s<;
Hence, s can be related to the wi by
sigRule = Solve@omgRule . Rule -> Equal, sD@@1DD
9s ﬁ- 2 w1 - w2

e
=
To use the method of averaging, we define the following rules:
psiRule = 8j1@tD -> w1 t + b1, j2@tD -> w2 t + b2<;
betaRule = Solve@psiRule . Rule -> Equal, 8b1, b2<D@@1DD
8b1 ﬁ-t w1 + j1@tD, b2 ﬁ-t w2 + j2@tD<
expRule1 = f_@a_D :> f@Expand@a . psiRule . omgRuleD . e t -> t1D;
expRule2 = f_@a_D :> f@Expand@a . t1 -> e t . sigRule . betaRuleDD;
Next, we separate  the fast and slowly varying  terms  in  the first-order equations, eqEps[[1]]. To this  end, we  define a  slow
state vector and a fast state vector according to
SVT@j_D := 8A1,j@h1@tD, h2@tDD, A2,j@h1@tD, h2@tDD, F1,j@h1@tD, h2@tDD, F2,j@h1@tD, h2@tDD<
solVar@j_D := 8a1,j, a2,j, f1,j, f2,j<
Then, the slowly varying parts of eqEps[[1]] are given by
SVT1Rule =
Table@Solve@eqEps@@1, iDD . Thread@solVar@1D -> H0 &LD . expRule1 . f_@_ t + _.D -> 0 .
expRule2 . f_@a_D :> f@Expand@aDD, SVT@1D@@iDDD @@1DD, 8i, 4<D  Flatten
:A1,1@h1@tD, h2@tDD ﬁd Cos@2 j1@tD - j2@tDD h1@tD h2@tD



2 w1
,
A2,1@h1@tD, h2@tDD ﬁ- d Cos@2 j1@tD - j2@tDD h1@tD2


4 w2
,
F1,1@h1@tD, h2@tDD ﬁ- d Sin@2 j1@tD - j2@tDD h2@tD


2 w1
,
F2,1@h1@tD, h2@tDD ﬁ- d Sin@2 j1@tD - j2@tDD h1@tD2


4 w2 h2@tD
>
whereas the fast varying parts are given by
Chapter5.nb
145

FVT1 = Table@Subtract  eqEps@@1, iDD . Thread@solVar@1D -> H0 &LD, 8i, 4<D . SVT1Rule
: d Cos@2 j1@tD + j2@tDD h1@tD h2@tD



2 w1
, - d Cos@j2@tDD h1@tD2


2 w2
+ d Cos@2 j1@tD + j2@tDD h1@tD2


4 w2
,
d Sin@j2@tDD h2@tD


w1
- d Sin@2 j1@tD + j2@tDD h2@tD


2 w1
,
d Sin@j2@tDD h1@tD2


2 w2 h2@tD
- d Sin@2 j1@tD + j2@tDD h1@tD2


4 w2 h2@tD
>
To determine  the solution  corresponding to these fast varying terms, we use the method of undetermined coefficients. To
accomplish this, we first identify the possible forms of the nonhomogeneous terms. The result is
FVT1Forms = Flatten@Cases@#, HCos ¨ SinL@a_D -> 8Cos@aD, Sin@aD<, InfinityDD &  FVT1
88Cos@2 j1@tD + j2@tDD, Sin@2 j1@tD + j2@tDD<,
8Cos@j2@tDD, Sin@j2@tDD, Cos@2 j1@tD + j2@tDD, Sin@2 j1@tD + j2@tDD<,
8Cos@j2@tDD, Sin@j2@tDD, Cos@2 j1@tD + j2@tDD, Sin@2 j1@tD + j2@tDD<,
8Cos@j2@tDD, Sin@j2@tDD, Cos@2 j1@tD + j2@tDD, Sin@2 j1@tD + j2@tDD<<
The fast-varying component of the first-order solution can be expressed as a linear combination of these forms; that is,
sol1Form = MapIndexed@Hcoeffs1@#2@@1DDD = Array@c, Length@#1DDL.#1 &, FVT1FormsD
8c@1D Cos@2 j1@tD + j2@tDD + c@2D Sin@2 j1@tD + j2@tDD,
c@1D Cos@j2@tDD + c@3D Cos@2 j1@tD + j2@tDD + c@2D Sin@j2@tDD + c@4D Sin@2 j1@tD + j2@tDD,
c@1D Cos@j2@tDD + c@3D Cos@2 j1@tD + j2@tDD + c@2D Sin@j2@tDD + c@4D Sin@2 j1@tD + j2@tDD,
c@1D Cos@j2@tDD + c@3D Cos@2 j1@tD + j2@tDD + c@2D Sin@j2@tDD + c@4D Sin@2 j1@tD + j2@tDD<
Substituting  sol1Form into  eqEps[[1]], using  SVT1Rule, collecting  the  coefficients  of FVT1Forms, solving  the  resulting
algebraic equation for the undetermined coefficients, and then substituting the result back into sol1Form, we obtain
sol1rhs = Table@sol1Form@@iDD .
Solve@Coefficient@Subtract  eqEps@@1, iDD . SVT1Rule . solVar@1D@@iDD ->
HEvaluate@sol1Form@@iDD . Thread@basicTerms -> 8#1, #2, #3, #4<DD &L,
FVT1Forms@@iDDD == 0  Thread, coeffs1@iDD@@1DD, 8i, 4<D
:- dSin@2 j1@tD + j2@tDD h1@tD h2@tD



2 w1 H2 w1 + w2L
, d Sin@j2@tDD h1@tD2


2 w2
2
- d Sin@2 j1@tD + j2@tDD h1@tD2


4 w2 H2 w1 + w2L
,
d Cos@j2@tDD h2@tD


w1 w2
- d Cos@2 j1@tD + j2@tDD h2@tD


2 w1 H2 w1 + w2L
,
d Cos@j2@tDD h1@tD2


2 w22 h2@tD
- d Cos@2 j1@tD + j2@tDD h1@tD2


4 w2 H2 w1 + w2L h2@tD
>
or in a pure function form as
146
Chapter5.nb

sol1Rule = Table@solVar@1D@@iDD ->
HEvaluate@sol1rhs@@iDD . Thread@basicTerms -> 8#1, #2, #3, #4<DD &L, 8i, 4<D
:a1,1 ﬁi
k
jj- d Sin@2 #3 + #4D #1 #2


2 w1 H2 w1 + w2L
&y
{
zz, a2,1 ﬁi
k
jj d Sin@#4D #12

2 w2
2
- d Sin@2 #3 + #4D #12


4 w2 H2 w1 + w2L
&y
{
zz,
f1,1 ﬁi
k
jj d Cos@#4D #2

w1 w2
- d Cos@2 #3 + #4D #2


2 w1 H2 w1 + w2L
&y
{
zz, f2,1 ﬁi
k
jj d Cos@#4D #12

2 #2 w22
- d Cos@2 #3 + #4D #12


4 #2 w2 H2 w1 + w2L
&y
{
zz>
Substituting the  slow- and  fast-varying components  of the first-order solution, SVT1Rule  and  sol1Rule, into the  second-
order equations, we have
Horder2Expr = Table@Subtract  eqEps@@2, iDD . SVT1Rule . sol1Rule  Expand  TrigReduce,
8i, 4<D;L  Timing
85.748 Second, Null<
Since we are seeking an expansion valid up to OHe2L, we do not need to solve for the ai, 2 and fi, 2. All we need to do is  to
investigate the above expressions to determine the slowly varying parts and hence determine the Ai, 2 and Fi, 2. The result is
SVT2Rule = Table@
Solve@order2Expr@@iDD == 0 . Thread@solVar@2D -> H0 &LD . expRule1 . f_@_ t + _.D -> 0 .
expRule2 . f_@a_D :> f@Expand@aDD, SVT@2D@@iDDD, 8i, 4<D  Flatten
:A1,2@h1@tD, h2@tDD ﬁ0, A2,2@h1@tD, h2@tDD ﬁ0,
F1,2@h1@tD, h2@tDD ﬁ- 8 d2 w1
2 h1@tD2 + 5 d2 w1 w2 h1@tD2 + 2 d2 w2
2 h2@tD2




8 w12 w22 H2 w1 + w2L
,
F2,2@h1@tD, h2@tDD ﬁ-
d2 h1@tD2


4 w1 w2 H2 w1 + w2L
>
Hence, we find that, to the second approximation, the solution is given by
eq54c =
8u1@tD, u2@tD< == HNormal@Series@8u1@tD, u2@tD< . transformRule . solRule, 8e, 0, 1<DD .
sol1Rule  TrigReduce  ExpandL  Thread
:u1@tD == 2 Sin@j1@tDD w1 h1@tD


2 w1 + w2
+ Sin@j1@tDD w2 h1@tD


2 w1 + w2
+ d e Cos@j1@tD - j2@tDD h1@tD h2@tD



2 w1 H2 w1 + w2L
+
d e Cos@j1@tD - j2@tDD h1@tD h2@tD



w2 H2 w1 + w2L
+ d e Cos@j1@tD + j2@tDD h1@tD h2@tD



w2 H2 w1 + w2L
,
u2@tD == d e w1 h1@tD2

w2
2 H2 w1 + w2L
+
d e h1@tD2

2 w2 H2 w1 + w2L
- d e Cos@2 j1@tDD h1@tD2


4 w2 H2 w1 + w2L
+
2 Sin@j2@tDD w1 h2@tD


2 w1 + w2
+ Sin@j2@tDD w2 h2@tD


2 w1 + w2
>
where the amplitudes and phases are given by
Chapter5.nb
147

ampEqs = basicDRule@@81, 2<DD . SVT1Rule . SVT2Rule . psiRule .
f_@a_D :> f@Collect@a, tDD . Rule -> Equal
:h1
¢ @tD == d e Cos@2 b1 - b2 - t H-2 w1 + w2LD h1@tD h2@tD



2 w1
,
h2
¢ @tD == - d e Cos@2 b1 - b2 - t H-2 w1 + w2LD h1@tD2



4 w2
>
phaseEqs = basicDRule@@83, 4<DD . SVT1Rule . SVT2Rule . psiRule .
f_@a_D :> f@Collect@a, tDD . Rule -> Equal
:j1
¢ @tD ==
w1 - d e Sin@2 b1 - b2 - t H-2 w1 + w2LD h2@tD



2 w1
- e2 H8 d2 w1
2 h1@tD2 + 5 d2 w1 w2 h1@tD2 + 2 d2 w2
2 h2@tD2L




8 w1
2 w2
2 H2 w1 + w2L
,
j2
¢ @tD == w2 -
d2 e2 h1@tD2


4 w1 w2 H2 w1 + w2L
- d e Sin@2 b1 - b2 - t H-2 w1 + w2LD h1@tD2



4 w2 h2@tD
>
148
Chapter5.nb

Chapter 6
Forced Oscillators of Systems with Finite 
Degrees of Freedom
In this  chapter, we discuss nonlinear systems  having finite degrees  of freedom. The discussion is limited to weakly nonlinear
systems, and  approximate solutions are obtained  by using the method  of multiple scales. In the  case of strongly  nonlinear
systems, perturbation  methods can be used  in cases  for which  a basic  exact nonlinear solution exists. For the other cases,
recourse is  often made to numerical methods and / or geometrical methods to obtain a qualitative description of the behavior
of the system, including its stability.
In contrast with a single-degree-of-freedom system,  which has  only  a  single  linear natural frequency and a  single  mode of
oscillation, an n-degree-of-freedom system has  n linear natural frequencies and n corresponding modes. Let us denote these
frequencies  by w1, w2, …, wn  and assume  that all of them are real and different from zero. An important case occurs when-
ever two or more of these frequencies are commensurate or nearly commensurate. Examples of near-commensurability are
8w2 » 2 w1, w3 » w2 – w1, w2 » 3 w1, w3 » 2 w2 – w1, w4 » w3 – w2 – w1<
Depending  on the order of the  nonlinearity in the  system,  these commensurate relationships  of frequencies  can cause the
corresponding modes to be strongly  coupled, and an internal or autoparametric  resonance is  said to exist. For example, if the
system has  quadratic  nonlinearities, then to first order an internal resonance may exist if wm » 2 wk  or wq » wp – wm. For a
system with cubic nonlinearities, to first order an internal resonance may exist if wm » 3 wk  or wq » wp – wm – wk or wm » wk
or wq » 2 wp – wm. When  an  internal resonance  exists in  a  free undamped  system,  energy imparted  initially  to  one  of the
modes  involved  in the internal resonance  will be continuously  exchanged among the modes  involved in that internal reso-
nance. If damping is present in the system, then the energy will decay with time as it is being continuously exchanged.
In  a  conservative  nongyroscopic  system,  if the  linear motion  is  oscillatory, then  the  nonlinear motion  is  bounded. For a
conservative gyroscopic  multidegree-of-freedom system,  the nonlinear motion may be unbounded and hence unstable  if an
internal resonance exists.
If an  external harmonic  excitation  of frequency  W  acts  on  a  multidegree-of-freedom system,  then  in  addition  to  all of the
primary  and secondary  resonances  (p W » q wm, with p  and  q being  integers) of a single-degree-of-freedom system,  there
might exist other resonance combinations of the frequencies in the form
p W == a1 w1 + a2 w2 + ” + aN wN
where p and the an are positive or negative integers such that
É pÉ +Ún=1
N
É an É == M
where  M  is  the  order of the  nonlinearity  plus  one  and N  is  the  number of degrees  of freedom.  The  type  of combination
resonance which might exist in a system depends on the order of its nonlinearity. For a system having quadratic  nonlineari-
ties, to first order the combination resonances  that might exist involve two frequencies in addition to W;  that is, W » wm +wk

or W » wm - wk. The  first of these is  called  a  summed  combination resonance  or a combination  resonance  of the  additive
type, whereas  the second  is  called  a difference  combination resonance  or a  combination resonance  of the difference  type.
These types  of combination resonances  were  predicted theoretically  by Malkin  (1956) and  found experimentally  by  Yama-
moto (1957, 1960). For a system having cubic  nonlinearities, to first order the combination resonances that might exist involve
either two or three of the natural frequencies in addition to W; that is,
8W » wp – wm – wk, W » 2 wp – wm, W » wp – 2 wm, 2 W » wm – wk<
à Preliminaries
Off@General::spell1D
Needs@"Utilities`Notation`"D
To use the method of multiple scales, we introduce different time scales, symbolize them as
Symbolize@T0D; Symbolize@T1D; Symbolize@T2D;
and form a list of them as follows:
timeScales = 8T0, T1, T2<;
In terms of the time scales Tn, the time derivatives become
dt@1D@expr_D := SumAei D@expr, timeScales@@i + 1DDD, 8i, 0, maxOrder<E;
dt@2D@expr_D := Hdt@1D@dt@1D@exprDD  ExpandL . ei_;i>maxOrder -> 0;
In the course of the analysis, we need the complex conjugates of A and G. We define them using the following rule:
conjugateRule = 9A -> A, A -> A, G -> G, G -> G, Complex@0, n_D -> Complex@0, -nD=;
To represent some of the expressions in a more concise way, we introduce the following display rule:
displayRule =
9Derivative@a__DAu_i_,j_E@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD-1
#1
&, 8a<E, ui,jE,
Derivative@a__DAA_i_E@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD
#1
&, 8a<E, AiE,
u_i_,j_@__D :> ui,j, A_i_@__D :> Ai=;
à 6.1 Externally Excited Linearly Uncoupled Systems
 System of Equations
We consider the response of the following two-degree-of-freedom system with quadratic  and cubic  geometric nonlineari-
ties to an external (additive) excitation:
148
Chapter6.nb

eq61a = 9
u1†@tD + w1
2 u1@tD + 2 m‘
1 u1¢@tD + D@V@u1@tD, u2@tDD, u1@tDD == F1 Cos@W t + t1D,
u2†@tD + w2
2 u2@tD + 2 m‘
2 u2¢@tD + D@V@u1@tD, u2@tDD, u2@tDD == F2 Cos@W t + t2D=
8w1
2 u1@tD + 2 m‘
1 u1
¢ @tD + u1
†@tD + VH1,0L@u1@tD, u2@tDD == Cos@t W + t1D F1,
w2
2 u2@tD + 2 m‘
2 u2
¢ @tD + u2
†@tD + VH0,1L@u1@tD, u2@tDD == Cos@t W + t2D F2<
where the potential function V possesses  cubic  and quartic  nonlinearities. The most general such potential function can be
expressed as follows:
basicModes = 8u1@tD, u2@tD<;
cubicTerms = Nest@Outer@Times, basicModes, #D &, basicModes, 2D  Flatten  Union
8u1@tD3, u1@tD2 u2@tD, u1@tD u2@tD2, u2@tD3<
quarticTerms = Outer@Times, basicModes, cubicTermsD  Flatten  Union
8u1@tD4, u1@tD3 u2@tD, u1@tD2 u2@tD2, u1@tD u2@tD3, u2@tD4<
potential =
V -> HEvaluate@Sum@di cubicTerms@@iDD, 8i, Length@cubicTermsD<D + Sum@ai quarticTerms@@iDD,
8i, Length@quarticTermsD<D . Thread@basicModes -> 8#1, #2<DD &L
V ﬁH#14 a1 + #13 #2 a2 + #12 #22 a3 + #1 #23 a4 + #24 a5 + #13 d1 + #12 #2 d2 + #1 #22 d3 + #23 d4 &L
Approximate solutions  of such a  system can  be  obtained  using  a number of techniques, including  the  method of normal
forms, the  method  of  multiple  scales, the  Krylov-Bogoliubov-Mitropolsky  technique,  and  the  method  of averaging. With
these methods, one determines a set of ordinary-differential equations (modulation equations) that govern  the time evolution
of the amplitudes  and phases of the modes  participating in the response. If these equations are time-dependent, one usually
transforms  them into a set of autonomous equations. In this  chapter, we describe how the method of multiple scales  can be
used to determine uniform expansions of this system, including the modulation equations.
Secondary resonances  of nonlinear systems  include subharmonic, superharmonic, and combination resonances. One or more
of these resonances might be activated in the presence or absence of internal resonances. When a combination resonance is
activated in the presence of an internal resonance, fractional harmonics might be excited.
For a consistent expansion, we first transform eq61a into a system of four first-order equations. To this end, we introduce the
two states v1@tD and v2@tD defined by
vel = 8u1¢@tD -> v1@tD, u2¢@tD -> v2@tD<;
Substituting the  velocity and  acceleration terms, using vel  and potential, into  eq61a and  combining the result  with vel, we
transform eq61a into the following set of four first-order equations:
Chapter6.nb
149

eq61b = 8vel . Rule -> Equal, eq61a . D@vel, tD . vel . potential<  Transpose  Flatten
8u1
¢ @tD == v1@tD, w1
2 u1@tD + 3 d1 u1@tD2 + 4 a1 u1@tD3 + 2 d2 u1@tD u2@tD + 3 a2 u1@tD2 u2@tD +
d3 u2@tD2 + 2 a3 u1@tD u2@tD2 + a4 u2@tD3 + 2 m‘
1 v1@tD + v1
¢ @tD == Cos@t W + t1D F1,
u2
¢ @tD == v2@tD, d2 u1@tD2 + a2 u1@tD3 + w2
2 u2@tD + 2 d3 u1@tD u2@tD + 2 a3 u1@tD2 u2@tD +
3 d4 u2@tD2 + 3 a4 u1@tD u2@tD2 + 4 a5 u2@tD3 + 2 m‘
2 v2@tD + v2
¢ @tD == Cos@t W + t2D F2<
We seek a uniform second-order expansion of the solution of eq61b in the form
solRule =
9ui_ -> ISumAej ui,j@#1, #2, #3D, 8j, 3<E &M, vi_ -> ISumAej vi,j@#1, #2, #3D, 8j, 3<E &M=;
and set
maxOrder = 2;
The damping and forcing terms in eq61b need to be scaled so that they balance the influence of the nonlinearity. The scaling
of the forcing depends on the type of resonance. Next, we treat different resonance cases in the following sections.
 6.1.1 W » w2 and w2 » 2 w1
In this case, we have a combination of a primary resonance of the second mode, a subharmonic resonance of order one-half
of the first mode, and a two-to-one internal resonance. In order to bring the effects  of damping, forcing, and nonlinearity at
the same order, we let
scaling = 9m‘
n_ -> e mn, F1 -> e f1, F2 -> e2 f2=;
To describe quantitatively the nearness of the resonances, we introduce the two detunings s1 and s2 defined by
ResonanceCond = 8w2 == 2 w1 + e s1, W == w2 + e s2<;
Then, we define the following lists:
omgList = 8w1, w2<;
omgRule = Solve@ResonanceCond, 8W, #<  FlattenD@@1DD &  omgList  Reverse
98W ﬁe s1 + e s2 + 2 w1, w2 ﬁe s1 + 2 w1<, 9W ﬁe s2 + w2, w1 ﬁ1
2
H-e s1 + w2L==
Using the time scales T0, T1, and T2, we express the time derivative as
multiScales = 8ui_@tD -> ui  timeScales, vi_@tD -> vi  timeScales,
Derivative@1D@u_D@tD -> dt@1D@u  timeScalesD, t -> T0<;
Substituting  the scaling, multiScales, and solRule  into eq61b, expanding the  result  for small e, and  discarding terms  of
order higher than e3, we obtain
150
Chapter6.nb

eq611a = Heq61b . scaling . multiScales . solRule  TrigToExp  ExpandAllL . en_;n>3 -> 0;
Equating coefficients of like powers of e, we obtain
eqEps = Rest@Thread@CoefficientList@Subtract  #, eD == 0DD &  eq611a  Transpose;
To place the linear operator on one side and the nonhomogeneous terms on the other side, we define
eqOrder@i_D := I#@@1DD &  eqEps@@1DD . fs_ -> 0 . u_k_,1 -> uk,iM ==
I#@@1DD &  eqEps@@1DD . fs_ -> 0 . u_k_,1 -> uk,iM - H#@@1DD &  eqEps@@iDDL  Thread
Using the eqOrder[i] and displayRule, we rewrite eqEps in a concise way as
eqOrder@1D . displayRule
eqOrder@2D . displayRule
eqOrder@3D . displayRule
9D0u1,1 - v1,1 == 0, D0v1,1 + w1
2 u1,1 == 1
2
E-I T0 W-I t1 f1 + 1
2
EI T0 W+I t1 f1,
D0u2,1 - v2,1 == 0, D0v2,1 + w2
2 u2,1 == 0=
9D0u1,2 - v1,2 == -HD1u1,1L, D0v1,2 + w1
2 u1,2 == -HD1v1,1L - 3 d1 u1,1
2
- 2 d2 u1,1 u2,1 - d3 u2,1
2
- 2 m1 v1,1,
D0u2,2 - v2,2 == -HD1u2,1L, D0v2,2 + w2
2 u2,2 ==
-HD1v2,1L + 1
2
E-I T0 W-It2 f2 + 1
2
EI T0 W+I t2 f2 - d2 u1,1
2
- 2 d3 u1,1 u2,1 - 3 d4 u2,1
2
- 2 m2 v2,1=
8D0u1,3 - v1,3 == -HD1u1,2L - D2u1,1,
D0v1,3 + w1
2 u1,3 == -HD1v1,2L - D2v1,1 - 4 a1 u1,1
3
- 6 d1 u1,1 u1,2 - 3 a2 u1,1
2
u2,1 -
2 d2 u1,2 u2,1 - 2 a3 u1,1 u2,1
2
- a4 u2,1
3
- 2 d2 u1,1 u2,2 - 2 d3 u2,1 u2,2 - 2 m1 v1,2,
D0u2,3 - v2,3 == -HD1u2,2L - D2u2,1, D0v2,3 + w2
2 u2,3 == -HD1v2,2L - D2v2,1 - a2 u1,1
3
- 2 d2 u1,1 u1,2 -
2 a3 u1,1
2
u2,1 - 2 d3 u1,2 u2,1 - 3 a4 u1,1 u2,1
2
- 4 a5 u2,1
3
- 2 d3 u1,1 u2,2 - 6 d4 u2,1 u2,2 - 2 m2 v2,2<
 First-Order Problem: Linear System
The  first-order  problem,  eqOrder[1],  consists  of  two  sets  of  uncoupled  linear  nonhomogeneous  differential  equations.
Hence, the general solution of each set can be obtained by using the principle of superposition as  the sum of any particular
solution and  the solution of the  homogeneous equations. To determine  the general solution of the homogeneous sets, we
rewrite the homogeneous part of eqOrder[1] as
linearSys = #@@1DD &  eqOrder@1D;
linearSys . displayRule
8D0u1,1 - v1,1, D0v1,1 + w1
2 u1,1, D0u2,1 - v2,1, D0v2,1 + w2
2 u2,1<
Next, we seek a solution of the linearSys in the form ui,1 = PEI wi T0 and vi,1 = QEI wi T0 and obtain
Chapter6.nb
151

expr1 =
linearSys . 9ui_,1 -> IP EI wi #1 &M, vi_,1 -> IQ EI wi #1 &M= . Exp@a_D -> 1  Partition@#, 2D &
88-Q +I P w1, I Q w1 + P w1
2<, 8-Q + I P w2, I Q w2 + P w2
2<<
The coefficient matrices of expr1 are
coefMat = Outer@D, #, 8P, Q<D &  expr1
888I w1, -1<, 8w1
2, I w1<<, 88I w2, -1<, 8w2
2, I w2<<<
and their adjoints are defined by
hermitian@mat_? MatrixQD := mat . conjugateRule  Transpose
Hence, the right and left eigenvectors of coefMat are
rightVec = #  #@@1DD &  HNullSpace@#D@@1DD &  coefMatL
881, I w1<, 81, I w2<<
leftVec = NullSpace@hermitian@#DD@@1DD &  coefMat
88-I w1, 1<, 8-I w2, 1<<
whose complex conjugates are
ccleftVec = leftVec . conjugateRule
88I w1, 1<, 8I w2, 1<<
To determine particular solutions of the partial-differential equations eqOrder[1] using the Mathematica function DSolve, we
first transform them into a set of ordinary-differential equations as
order1Eq = eqOrder@1D . u_i_,1 -> Hui,1@#1D &L
9-v1,1@T0D + u1,1
¢
@T0D == 0, w1
2 u1,1@T0D + v1,1
¢
@T0D == 1
2
E-I T0 W-I t1 f1 + 1
2
EI T0 W+I t1 f1,
-v2,1@T0D + u2,1
¢
@T0D == 0, w2
2 u2,1@T0D + v2,1
¢
@T0D == 0=
Then, the particular solutions of order1Eq are
sol1p =
DSolve@order1Eq, 8u1,1@T0D, v1,1@T0D, u2,1@T0D, v2,1@T0D<, T0D@@1DD . C@_D -> 0  Simplify
:u1,1@T0D ﬁ- E-I HT0 W+t1L H1 + E2 I HT0 W+t1LL f1


2 HW2 - w12L
,
v1,1@T0D ﬁ- I E-I HT0 W+t1L H-1 + E2I HT0 W+t1LL W f1



2 HW2 - w1
2L
, u2,1@T0D ﬁ0, v2,1@T0D ﬁ0>
152
Chapter6.nb

To simplify some of the expressions, we let
fRule = 9fi_ -> 2 Li Iwi
2 - W2M=;
and express ui,1 and vi,1 in pure function form as
sol1u = TableAui,1 -> FunctionA8T0, T1, T2<, Ai@T1, T2D Exp@I wi T0D + A
i@T1, T2D Exp@-I wi T0D+
Hui,1@T0D . sol1p . fRule  Simplify  ExpandL  EvaluateE, 8i, 2<E
8u1,1 ﬁFunction@8T0, T1, T2<, E-I T0 W-It1 L1 + EI T0 W+I t1 L1 + EI T0 w1 A1@T1, T2D + E-I T0 w1 A
1@T1, T2DD,
u2,1 ﬁFunction@8T0, T1, T2<, EI T0 w2 A2@T1, T2D + E-I T0 w2 A
2@T1, T2DD<
sol1v =
Table@vi,1 -> Function@8T0, T1, T2<, D@ui,1  timeScales, T0D . sol1u  EvaluateD, 8i, 2<D
8v1,1 ﬁFunction@8T0, T1, T2<,
-I E-I T0 W-I t1 W L1 + I EI T0 W+I t1 W L1 + I EI T0 w1 w1 A1@T1, T2D - I E-I T0 w1 w1 A
1@T1, T2DD,
v2,1 ﬁFunction@8T0, T1, T2<, I EI T0 w2 w2 A2@T1, T2D - I E-I T0 w2 w2 A
2@T1, T2DD<
Then, we combine them using the Mathematica function Join as
sol1 = Join@sol1u, sol1vD;
 Second-Order Problem
Substituting the first-order solution sol1 into the second-order problem, eqOrder[2], yields
order2Eq = eqOrder@2D . sol1  ExpandAll;
order2Eq . displayRule
9D0u1,2 - v1,2 == -EI T0 w1 HD1A1L - E-I T0 w1 HD1A
1L,
D0v1,2 + w1
2 u1,2 == -3 E2 I T0 w1 A1
2 d1 - 2 EI T0 w1+I T0 w2 A1 A2 d2 - E2I T0 w2 A2
2 d3 -
6 E-I T0 W-I t1+IT0 w1 A1 d1 L1 - 6 EI T0 W+I t1+IT0 w1 A1 d1 L1 - 2 E-I T0 W-I t1+IT0 w2 A2 d2 L1 -
2 EI T0 W+I t1+IT0 w2 A2 d2 L1 - 6 d1 L1
2 - 3 E-2I T0 W-2 It1 d1 L1
2 - 3 E2 I T0 W+2 I t1 d1 L1
2 +
2 I E-I T0 W-I t1 W L1 m1 - 2 I EI T0 W+I t1 W L1 m1 - I EI T0 w1 HD1A1L w1 + I E-IT0 w1 HD1A
1L w1 -
2 I EI T0 w1 A1 m1 w1 - 6 A1 d1 A
1 - 2 E-I T0 w1+I T0 w2 A2 d2 A
1 - 6 E-I T0 W-I t1-I T0 w1 d1 L1 A
1 -
6 EI T0 W+I t1-IT0 w1 d1 L1 A
1 + 2 I E-I T0 w1 m1 w1 A
1 - 3 E-2 I T0 w1 d1 A
1
2 - 2 EI T0 w1-I T0 w2 A1 d2 A
2 - 2 A2 d3 A
2 -
2 E-I T0 W-I t1-IT0 w2 d2 L1 A
2 - 2 EI T0 W+I t1-IT0 w2 d2 L1 A
2 - 2 E-I T0 w1-I T0 w2 d2 A
1 A
2 - E-2 I T0 w2 d3 A
2
2,
D0u2,2 - v2,2 == -EI T0 w2 HD1A2L - E-I T0 w2 HD1A
2L,
D0v2,2 + w2
2 u2,2 == 1
2
E-I T0 W-I t2 f2 + 1
2
EI T0 W+I t2 f2 - E2 I T0 w1 A1
2 d2 - 2 EI T0 w1+I T0 w2 A1 A2 d3 -
3 E2 I T0 w2 A2
2 d4 - 2 E-I T0 W-I t1+I T0 w1 A1 d2 L1 - 2 EI T0 W+I t1+I T0 w1 A1 d2 L1 -
2 E-I T0 W-I t1+IT0 w2 A2 d3 L1 - 2 EI T0 W+I t1+IT0 w2 A2 d3 L1 - 2 d2 L1
2 - E-2 IT0 W-2 I t1 d2 L1
2 -
E2 I T0 W+2 I t1 d2 L1
2 - I EI T0 w2 HD1A2L w2 + I E-I T0 w2 HD1A
2L w2 - 2 I EI T0 w2 A2 m2 w2 -
2 A1 d2 A
1 - 2 E-I T0 w1+I T0 w2 A2 d3 A
1 - 2 E-I T0 W-I t1-I T0 w1 d2 L1 A
1 - 2 EI T0 W+It1-I T0 w1 d2 L1 A
1 -
E-2 I T0 w1 d2 A
1
2 - 2 EI T0 w1-I T0 w2 A1 d3 A
2 - 6 A2 d4 A
2 - 2 E-I T0 W-I t1-I T0 w2 d3 L1 A
2 -
2 EI T0 W+I t1-IT0 w2 d3 L1 A
2 + 2 I E-I T0 w2 m2 w2 A
2 - 2 E-I T0 w1-I T0 w2 d3 A
1 A
2 - 3 E-2 IT0 w2 d4 A
2
2=
Chapter6.nb
153

Any particular solution of order2Eq contains secular terms and small-divisor terms, making the expansion nonuniform. For a
uniform expansion, we  choose D1 A1  and  D1 A2  to  eliminate these  terms. To  accomplish  this, we  first convert  the  small-
divisor terms into secular terms using the rule
expRule1@i_D := Exp@a_D :> Exp@Expand@a . omgRule@@iDDD . e T0 -> T1D
To  eliminate the  terms  that  produce secular terms  (i.e., determine the solvability  conditions) from order2Eq, we collect  the
terms proportional to EI w1 T0  and EI w2 T0 and obtain
ST11 = Coefficient@order2Eq@@#, 2DD . expRule1@1D, Exp@I w1 T0DD &  81, 2<;
ST11 . displayRule
8-HD1A1L, -I HD1A1L w1 - 2 I A1 m1 w1 - 2 EI T1 s1 A2 d2 A
1 - 6 EI T1 s1+I T1 s2+I t1 d1 L1 A
1<
ST12 = Coefficient@order2Eq@@#, 2DD . expRule1@2D, Exp@I w2 T0DD &  83, 4<;
ST12 . displayRule
9-HD1A2L, 1
2
EI T1 s2+I t2 f2 - E-I T1 s1 A1
2 d2 - I HD1A2L w2 - 2 I A2 m2 w2=
Then, the  solvability conditions, conditions for the elimination of the  terms  that produce secular terms, demand that ST11
and ST12 be orthogonal to every  solution of the corresponding adjoint problem, namely, the components  of ccleftVec. The
result is
SCond1 = 8ccleftVec@@1DD.ST11 == 0, ccleftVec@@2DD.ST12 == 0<;
SCond1 . displayRule
9-2 I HD1A1L w1 - 2 I A1 m1 w1 - 2 EI T1 s1 A2 d2 A
1 - 6 EI T1 s1+I T1 s2+I t1 d1 L1 A
1 == 0,
1
2
EI T1 s2+I t2 f2 - E-I T1 s1 A1
2 d2 - 2 I HD1A2L w2 - 2 I A2 m2 w2 == 0=
Solving SCond1 for D1 A1 and D1 A2 yields
SCond1Rule1 = SolveASCond1, 9A1
H1,0L@T1, T2D, A2
H1,0L@T1, T2D=E@@1DD  ExpandAll;
SCond1Rule1 . displayRule
:D1A1 ﬁ-A1 m1 + I EI T1 s1 A2 d2 A
1

w1
+ 3 I EI T1 s1+IT1 s2+I t1 d1 L1 A
1


w1
,
D1A2 ﬁ-A2 m2 - I EI T1 s2+I t2 f2

4 w2
+ I E-I T1 s1 A1
2 d2

2 w2
>
With these conditions, order2Eq are solvable. However, their solutions are not unique. To render them unique, we demand
that they be orthogonal to solutions of the corresponding adjoint problems; that is, we damand that 8u1,2 , v1,2< be orthogo-
nal to ccleftVec[[1]] and 8u2,2 , v2,2< be orthogonal to ccleftVec[[2]].
Next, we use the solvability conditions to eliminate D1 A1 and D1 A2 from order2Eq. To simplify the resulting equations using
Mathematica, we replace the scale T1 in SCond1Rule1 with eT0. To this end, we express the detuning parameters si in terms
of the wi and W as
154
Chapter6.nb

sigRule = Solve@ResonanceCond, 8s1, s2<D@@1DD
9s1 ﬁ- 2 w1 - w2

e
, s2 ﬁ- -W + w2

e
=
and replace T1 with eT0 using the rule
expRule2 = Exp@a_D :> Exp@a . T1 -> e T0 . sigRule  ExpandD;
Using the expRule2, we rewrite SCond1Rule1 as
SCond1Rule2 = SCond1Rule1 . expRule2;
SCond1Rule2 . displayRule
:D1A1 ﬁ-A1 m1 + I E-2 I T0 w1+I T0 w2 A2 d2 A
1


w1
+ 3 I EI T0 W+I t1-2 I T0 w1 d1 L1 A
1


w1
,
D1A2 ﬁ-A2 m2 - I EI T0 W+I t2-I T0 w2 f2


4 w2
+ I E2 I T0 w1-I T0 w2 A1
2 d2


2 w2
>
whose complex conjugate is
ccSCond1Rule2 = SCond1Rule2 . conjugateRule;
Substituting this form for the solvability conditions into order2Eq yields
Chapter6.nb
155

order2Eqm = order2Eq . SCond1Rule2 . ccSCond1Rule2  ExpandAll;
order2Eqm . displayRule
9D0u1,2 - v1,2 == EI T0 w1 A1 m1 + 3 I E-IT0 W-I t1+I T0 w1 A1 d1 L1


w1
+ E-I T0 w1 m1 A
1 -
I E-IT0 w1+I T0 w2 A2 d2 A
1


w1
- 3 I EI T0 W+I t1-IT0 w1 d1 L1 A
1


w1
+ I EI T0 w1-I T0 w2 A1 d2 A
2


w1
,
D0v1,2 + w1
2 u1,2 == -3 E2 I T0 w1 A1
2 d1 - 2 EI T0 w1+I T0 w2 A1 A2 d2 - E2I T0 w2 A2
2 d3 - 3 E-I T0 W-It1+I T0 w1 A1 d1 L1 -
6 EI T0 W+I t1+IT0 w1 A1 d1 L1 - 2 E-I T0 W-I t1+IT0 w2 A2 d2 L1 - 2 EI T0 W+I t1+I T0 w2 A2 d2 L1 - 6 d1 L1
2 -
3 E-2 I T0 W-2 I t1 d1 L1
2 - 3 E2 I T0 W+2I t1 d1 L1
2 + 2 I E-I T0 W-I t1 W L1 m1 - 2 I EI T0 W+I t1 W L1 m1 -
I EI T0 w1 A1 m1 w1 - 6 A1 d1 A
1 - E-IT0 w1+I T0 w2 A2 d2 A
1 - 6 E-I T0 W-I t1-I T0 w1 d1 L1 A
1 -
3 EI T0 W+I t1-IT0 w1 d1 L1 A
1 + I E-I T0 w1 m1 w1 A
1 - 3 E-2 I T0 w1 d1 A
1
2 - EI T0 w1-I T0 w2 A1 d2 A
2 - 2 A2 d3 A
2 -
2 E-I T0 W-I t1-IT0 w2 d2 L1 A
2 - 2 EI T0 W+I t1-IT0 w2 d2 L1 A
2 - 2 E-I T0 w1-I T0 w2 d2 A
1 A
2 - E-2 I T0 w2 d3 A
2
2,
D0u2,2 - v2,2 == EI T0 w2 A2 m2 - I E-IT0 W-I t2 f2

4 w2
+ I EI T0 W+I t2 f2

4 w2
-
I E2 IT0 w1 A1
2 d2

2 w2
+ I E-2 IT0 w1 d2 A
1
2

2 w2
+ E-I T0 w2 m2 A
2,
D0v2,2 + w2
2 u2,2 == 1
4
E-I T0 W-I t2 f2 + 1
4
EI T0 W+I t2 f2 - 1
2
E2I T0 w1 A1
2 d2 - 2 EI T0 w1+I T0 w2 A1 A2 d3 -
3 E2 I T0 w2 A2
2 d4 - 2 E-I T0 W-I t1+I T0 w1 A1 d2 L1 - 2 EI T0 W+I t1+I T0 w1 A1 d2 L1 - 2 E-I T0 W-I t1+I T0 w2 A2 d3 L1 -
2 EI T0 W+I t1+IT0 w2 A2 d3 L1 - 2 d2 L1
2 - E-2 IT0 W-2 I t1 d2 L1
2 - E2 I T0 W+2 I t1 d2 L1
2 - I EI T0 w2 A2 m2 w2 -
2 A1 d2 A
1 - 2 E-I T0 w1+I T0 w2 A2 d3 A
1 - 2 E-I T0 W-I t1-I T0 w1 d2 L1 A
1 - 2 EI T0 W+It1-I T0 w1 d2 L1 A
1 -
1
2
E-2 I T0 w1 d2 A
1
2 - 2 EI T0 w1-I T0 w2 A1 d3 A
2 - 6 A2 d4 A
2 - 2 E-I T0 W-It1-I T0 w2 d3 L1 A
2 -
2 EI T0 W+I t1-IT0 w2 d3 L1 A
2 + I E-I T0 w2 m2 w2 A
2 - 2 E-I T0 w1-I T0 w2 d3 A
1 A
2 - 3 E-2 IT0 w2 d4 A
2
2=
Next, we  use the  method  of undetermined coefficients  to  determine the  particular solutions of order2Eqm. To  accomplish
this, we first identify the form of the nonhomogeneous terms. To this end, we let
basicH = TableA9Ai@T1, T2D EIwi T0, A
i@T1, T2D E-I wi T0=, 8i, 2<E  Flatten
8EI T0 w1 A1@T1, T2D, E-I T0 w1 A
1@T1, T2D, EI T0 w2 A2@T1, T2D, E-I T0 w2 A
2@T1, T2D<
collectForm = JoinAbasicH, 9L1 EI W T0+I t1, L1 E-I W T0-I t1=E
8EI T0 w1 A1@T1, T2D, E-I T0 w1 A
1@T1, T2D,
EI T0 w2 A2@T1, T2D, E-I T0 w2 A
2@T1, T2D, EI T0 W+I t1 L1, E-I T0 W-I t1 L1<
Then, the possible form of the nonhomogeneous terms in order2Eqm is
156
Chapter6.nb

possibleTerms = JoinAcollectForm, 9EIW T0+I t2, E-I W T0-I t2=,
Outer@Times, collectForm, collectFormD  Flatten  UnionE
:EI T0 w1 A1@T1, T2D, E-I T0 w1 A
1@T1, T2D, EI T0 w2 A2@T1, T2D, E-I T0 w2 A
2@T1, T2D,
EI T0 W+I t1 L1, E-I T0 W-I t1 L1, EI T0 W+I t2, E-I T0 W-I t2 , L1
2, E-2 I T0 W-2 I t1 L1
2, E2 I T0 W+2 I t1 L1
2,
E-I T0 W-I t1+I T0 w1 L1 A1@T1, T2D, EIT0 W+I t1+I T0 w1 L1 A1@T1, T2D, E2 I T0 w1 A1@T1, T2D2,
E-I T0 W-I t1+I T0 w2 L1 A2@T1, T2D, EIT0 W+I t1+I T0 w2 L1 A2@T1, T2D, EI T0 w1+I T0 w2 A1@T1, T2D A2@T1, T2D,
E2 I T0 w2 A2@T1, T2D2, E-I T0 W-I t1-IT0 w1 L1 A
1@T1, T2D, EI T0 W+It1-I T0 w1 L1 A
1@T1, T2D,
A1@T1, T2D A
1@T1, T2D, E-I T0 w1+IT0 w2 A2@T1, T2D A
1@T1, T2D, E-2I T0 w1 A
1@T1, T2D
2,
E-I T0 W-I t1-I T0 w2 L1 A
2@T1, T2D, EIT0 W+I t1-I T0 w2 L1 A
2@T1, T2D, EI T0 w1-I T0 w2 A1@T1, T2D A
2@T1, T2D,
A2@T1, T2D A
2@T1, T2D, E-I T0 w1-IT0 w2 A
1@T1, T2D A
2@T1, T2D, E-2I T0 w2 A
2@T1, T2D
2>
Using  the method of undetermined coefficients, we assume  that  the ui,2  and  vi,2  are linear combinations of these possible
terms, substitute the result  into the governing equations, order2Eqm, equate the coefficients of each of the possible terms  on
both sides  of each equation, and obtain  a system of nonhomogeneous algebraic equations governing the unknown  coeffi-
cients. Associated  with  each  possible  term  is  a  pair of  two  algebraic  equations. The  solutions  of  all pairs, except  those
associated with resonance terms, are  unique. The solutions of the pairs corresponding to the possible  resonance terms  are
rendered  unique  by  requiring  them to  be  orthogonal  to  the  components  of ccleftVec. The  possible  resonance  terms  are
proportional to EI w1 T0 , EI w2  T0, and their complex conjugates; that is,
ResonantTerms@i_D :=
I# . 8a_ ; a =!= 0 -> 1< &  IE-I wi T0 possibleTerms . expRule1@iD . Exp@_ T0 + _.D -> 0MM
possibleTerms  Union  Rest
RT = Array@ResonantTerms, 2D
88EI T0 w1 A1@T1, T2D, EIT0 W+I t1-I T0 w1 L1 A
1@T1, T2D, E-I T0 w1+I T0 w2 A2@T1, T2D A
1@T1, T2D<,
8EI T0 W+I t2, EIT0 W+I t1 L1, E2 I T0 w1 A1@T1, T2D2, EI T0 w2 A2@T1, T2D<<
Hence, the coefficients of RT in the nonhomogeneous terms in order2Eqm[[1]] are
r1Rule =
MapIndexed@r1,#2@@1DD -> Coefficient@order2Eqm@@1, 2DD, #1D &, RT@@1DDD . Exp@_ T0 + _.D -> 0
:r1,1 ﬁm1, r1,2 ﬁ- 3 I d1

w1
, r1,3 ﬁ- I d2

w1
>
and the coefficients of RT in the nonhomogeneous terms in order2Eqm[[2]] are
r2Rule =
MapIndexed@r2,#2@@1DD -> Coefficient@order2Eqm@@2, 2DD, #1D &, RT@@1DDD . Exp@_ T0 + _.D -> 0
8r2,1 ﬁ-I m1 w1, r2,2 ﬁ-3 d1, r2,3 ﬁ-d2<
It follows from
Chapter6.nb
157

Table@ccleftVec@@1DD.8r1,i, r2,i<, 8i, 3<D . r1Rule . r2Rule
80, 0, 0<
that  the parts  r1Rule and  r2Rule are  orthogonal to the  solution of the adjoint, the first component of ccleftVec, as  they
should.
Similarly, the coefficients of RT in the nonhomogeneous terms in order2Eqm[[3]] are
r3Rule = MapIndexed@r3,#2@@1DD -> Coefficient@order2Eqm@@3, 2DD, #1D &, RT@@2DDD
:r3,1 ﬁI f2

4 w2
, r3,2 ﬁ0, r3,3 ﬁ- I d2

2 w2
, r3,4 ﬁm2>
and the coefficients of RT in the nonhomogeneous terms in order2Eqm[[4]] are
r4Rule =
MapIndexed@r4,#2@@1DD -> Coefficient@order2Eqm@@4, 2DD, #1D &, RT@@2DDD . Exp@_ T0 + _.D -> 0
9r4,1 ﬁf2

4
, r4,2 ﬁ0, r4,3 ﬁ- d2

2
, r4,4 ﬁ-I m2 w2=
Again, it follows from
Table@ccleftVec@@2DD.8r3,i, r4,i<, 8i, 4<D . r3Rule . r4Rule
80, 0, 0, 0<
that the vector 8r3, i , r4, i< is orthogonal to the solution of the adjoint, the second component of ccleftVec, as it should.
The complement of the resonance terms RT in possibleTerms yields the nonresonance terms; that is,
NRT = Complement@possibleTerms, Join@#, # . conjugateRuleDD &  RT
::E-I T0 W-I t2, EI T0 W+I t2, E-I T0 W-I t1 L1, EI T0 W+I t1 L1, L1
2, E-2 I T0 W-2 I t1 L1
2,
E2 I T0 W+2 I t1 L1
2, EI T0 W+I t1+I T0 w1 L1 A1@T1, T2D, E2 I T0 w1 A1@T1, T2D2, EI T0 w2 A2@T1, T2D,
E-I T0 W-I t1+I T0 w2 L1 A2@T1, T2D, EIT0 W+I t1+I T0 w2 L1 A2@T1, T2D, EI T0 w1+I T0 w2 A1@T1, T2D A2@T1, T2D,
E2 I T0 w2 A2@T1, T2D2, E-I T0 W-I t1-I T0 w1 L1 A
1@T1, T2D, A1@T1, T2D A
1@T1, T2D, E-2 I T0 w1 A
1@T1, T2D
2,
E-I T0 w2 A
2@T1, T2D, E-I T0 W-It1-I T0 w2 L1 A
2@T1, T2D, EI T0 W+I t1-I T0 w2 L1 A
2@T1, T2D,
A2@T1, T2D A
2@T1, T2D, E-I T0 w1-IT0 w2 A
1@T1, T2D A
2@T1, T2D, E-2I T0 w2 A
2@T1, T2D
2>,
:L1
2, E-2 I T0 W-2 I t1 L1
2, E2 I T0 W+2I t1 L1
2, EI T0 w1 A1@T1, T2D, E-I T0 W-I t1+I T0 w1 L1 A1@T1, T2D,
EI T0 W+I t1+I T0 w1 L1 A1@T1, T2D, E-IT0 W-I t1+I T0 w2 L1 A2@T1, T2D, EI T0 W+I t1+I T0 w2 L1 A2@T1, T2D,
EI T0 w1+I T0 w2 A1@T1, T2D A2@T1, T2D, E2 I T0 w2 A2@T1, T2D2, E-I T0 w1 A
1@T1, T2D,
E-I T0 W-I t1-I T0 w1 L1 A
1@T1, T2D, EIT0 W+I t1-I T0 w1 L1 A
1@T1, T2D, A1@T1, T2D A
1@T1, T2D,
E-I T0 w1+I T0 w2 A2@T1, T2D A
1@T1, T2D, E-I T0 W-I t1-I T0 w2 L1 A
2@T1, T2D,
EI T0 W+I t1-I T0 w2 L1 A
2@T1, T2D, EIT0 w1-I T0 w2 A1@T1, T2D A
2@T1, T2D,
A2@T1, T2D A
2@T1, T2D, E-I T0 w1-IT0 w2 A
1@T1, T2D A
2@T1, T2D, E-2I T0 w2 A
2@T1, T2D
2>>
158
Chapter6.nb

To implement the method of undetermined coefficients, we associate with each possible resonance term an unknown coeffi-
cient using the rules
RTsymbolList1 = Table@G1,j, 8j, Length@RT@@1DDD<D
8G1,1, G1,2, G1,3<
RTsymbolList2 = Table@G3,j, 8j, Length@RT@@2DDD<D
8G3,1, G3,2, G3,3, G3,4<
And, we associate with each possible nonresonance term two unknown coefficients using the rules
NRTsymbolList1@i_D = Table@Li,j, 8j, Length@NRT@@1DDD<D
8Li,1, Li,2, Li,3, Li,4, Li,5, Li,6, Li,7, Li,8, Li,9, Li,10, Li,11,
Li,12, Li,13, Li,14, Li,15, Li,16, Li,17, Li,18, Li,19, Li,20, Li,21, Li,22, Li,23<
NRTsymbolList2@i_D = Table@Li+2,j, 8j, Length@NRT@@2DDD<D
8L2+i,1, L2+i,2, L2+i,3, L2+i,4, L2+i,5, L2+i,6, L2+i,7, L2+i,8, L2+i,9, L2+i,10, L2+i,11,
L2+i,12, L2+i,13, L2+i,14, L2+i,15, L2+i,16, L2+i,17, L2+i,18, L2+i,19, L2+i,20, L2+i,21<
Accounting  for  the  orthogonality  conditions,  8u1,2 , v1,2<  must  be  orthogonal  to  ccleftVec[[1]]  and  8u2,2 , v2,2<  must  be
orthogonal to ccleftVec[[2]], for the resonance terms, RT, we express ui,2 and vi,2 in the following function form:
8ratio1, ratio2< = Table@-ccleftVec@@i, 1DD, 8i, 2<D
8-I w1, -I w2<
sol2Form = 8u1,2 -> Function@8T0, T1, T2<,
RTsymbolList1.RT@@1DD + HRTsymbolList1.RT@@1DD . conjugateRuleL +
NRTsymbolList1@1D.NRT@@1DD  EvaluateD, v1,2 -> Function@8T0, T1, T2<,
ratio1 * RTsymbolList1.RT@@1DD + Hratio1 * RTsymbolList1.RT@@1DD . conjugateRuleL +
NRTsymbolList1@2D.NRT@@1DD  EvaluateD, u2,2 -> Function@8T0, T1, T2<,
RTsymbolList2.RT@@2DD + HRTsymbolList2.RT@@2DD . conjugateRuleL +
NRTsymbolList2@1D.NRT@@2DD  EvaluateD, v2,2 -> Function@8T0, T1, T2<,
ratio2 * RTsymbolList2.RT@@2DD + Hratio2 * RTsymbolList2.RT@@2DD . conjugateRuleL +
NRTsymbolList2@2D.NRT@@2DD  EvaluateD<;
Substituting sol2Form into order2Eqm and collecting the coefficients of like NRT, we obtain two sets  of algebraic equations
as
Chapter6.nb
159

eq611b = HCoefficient@Subtract  # . sol2Form, NRT@@1DDD . Exp@_ T0 + _.D -> 0 & 
order2Eqm@@81, 2<DD  FlattenL == 0  Thread
8-I W L1,1 - L2,1 == 0, I W L1,2 - L2,2 == 0, -I W L1,3 - L2,3 == 0, I W L1,4 - L2,4 == 0, -L2,5 == 0,
-2 I W L1,6 - L2,6 == 0, 2 I W L1,7 - L2,7 == 0, I W L1,8 + I w1 L1,8 - L2,8 == 0, 2 I w1 L1,9 - L2,9 == 0,
I w2 L1,10 - L2,10 == 0, -I W L1,11 + I w2 L1,11 - L2,11 == 0, I W L1,12 + I w2 L1,12 - L2,12 == 0,
I w1 L1,13 + I w2 L1,13 - L2,13 == 0, 2 I w2 L1,14 - L2,14 == 0, -I W L1,15 - I w1 L1,15 - L2,15 == 0,
-L2,16 == 0, -2 I w1 L1,17 - L2,17 == 0, -I w2 L1,18 - L2,18 == 0, -I W L1,19 - I w2 L1,19 - L2,19 == 0,
I W L1,20 - I w2 L1,20 - L2,20 == 0, -L2,21 == 0, -I w1 L1,22 - I w2 L1,22 - L2,22 == 0,
-2 I w2 L1,23 - L2,23 == 0, w1
2 L1,1 - I W L2,1 == 0, w1
2 L1,2 + I W L2,2 == 0,
-2 I W m1 + w1
2 L1,3 - I W L2,3 == 0, 2 I W m1 + w1
2 L1,4 + I W L2,4 == 0, 6 d1 + w1
2 L1,5 == 0,
3 d1 + w1
2 L1,6 - 2 I W L2,6 == 0, 3 d1 + w1
2 L1,7 + 2 I W L2,7 == 0, 6 d1 + w1
2 L1,8 + I W L2,8 + I w1 L2,8 == 0,
3 d1 + w1
2 L1,9 + 2 I w1 L2,9 == 0, w1
2 L1,10 + I w2 L2,10 == 0, 2 d2 + w1
2 L1,11 - I W L2,11 + I w2 L2,11 == 0,
2 d2 + w1
2 L1,12 + I W L2,12 + I w2 L2,12 == 0, 2 d2 + w1
2 L1,13 + I w1 L2,13 + I w2 L2,13 == 0,
d3 +w1
2 L1,14 + 2 I w2 L2,14 == 0, 6 d1 + w1
2 L1,15 - I W L2,15 - I w1 L2,15 == 0,
6 d1 + w1
2 L1,16 == 0, 3 d1 + w1
2 L1,17 - 2 I w1 L2,17 == 0, w1
2 L1,18 - I w2 L2,18 == 0,
2 d2 + w1
2 L1,19 - I W L2,19 - I w2 L2,19 == 0, 2 d2 + w1
2 L1,20 + I W L2,20 - I w2 L2,20 == 0,
2 d3 + w1
2 L1,21 == 0, 2 d2 + w1
2 L1,22 - I w1 L2,22 - I w2 L2,22 == 0, d3 + w1
2 L1,23 - 2 I w2 L2,23 == 0<
eq611c = HCoefficient@Subtract  # . sol2Form, NRT@@2DDD . Exp@_ T0 + _.D -> 0 & 
order2Eqm@@83, 4<DD  FlattenL == 0  Thread
8-L4,1 == 0, -2 I W L3,2 - L4,2 == 0, 2 I W L3,3 - L4,3 == 0, I w1 L3,4 - L4,4 == 0,
-I W L3,5 + I w1 L3,5 - L4,5 == 0, I W L3,6 + I w1 L3,6 - L4,6 == 0, -I W L3,7 + I w2 L3,7 - L4,7 == 0,
I W L3,8 + I w2 L3,8 - L4,8 == 0, I w1 L3,9 + I w2 L3,9 - L4,9 == 0, 2 I w2 L3,10 - L4,10 == 0,
-I w1 L3,11 - L4,11 == 0, -I W L3,12 - I w1 L3,12 - L4,12 == 0, I W L3,13 - I w1 L3,13 - L4,13 == 0, -L4,14 == 0,
-I w1 L3,15 + I w2 L3,15 - L4,15 == 0, -I W L3,16 - I w2 L3,16 - L4,16 == 0, I W L3,17 - I w2 L3,17 - L4,17 == 0,
I w1 L3,18 - I w2 L3,18 - L4,18 == 0, -L4,19 == 0, -I w1 L3,20 - I w2 L3,20 - L4,20 == 0,
-2 I w2 L3,21 - L4,21 == 0, 2 d2 + w2
2 L3,1 == 0, d2 + w2
2 L3,2 - 2 I W L4,2 == 0, d2 + w2
2 L3,3 + 2 I W L4,3 == 0,
w2
2 L3,4 + I w1 L4,4 == 0, 2 d2 + w2
2 L3,5 - I W L4,5 + I w1 L4,5 == 0, 2 d2 + w2
2 L3,6 + I W L4,6 + I w1 L4,6 == 0,
2 d3 + w2
2 L3,7 - I W L4,7 + I w2 L4,7 == 0, 2 d3 + w2
2 L3,8 + I W L4,8 + I w2 L4,8 == 0,
2 d3 + w2
2 L3,9 + I w1 L4,9 + I w2 L4,9 == 0, 3 d4 + w2
2 L3,10 + 2 I w2 L4,10 == 0, w2
2 L3,11 - I w1 L4,11 == 0,
2 d2 + w2
2 L3,12 - I W L4,12 - I w1 L4,12 == 0, 2 d2 + w2
2 L3,13 + I W L4,13 - I w1 L4,13 == 0, 2 d2 + w2
2 L3,14 == 0,
2 d3 + w2
2 L3,15 - I w1 L4,15 + I w2 L4,15 == 0, 2 d3 + w2
2 L3,16 - I W L4,16 - I w2 L4,16 == 0,
2 d3 + w2
2 L3,17 + I W L4,17 - I w2 L4,17 == 0, 2 d3 + w2
2 L3,18 + I w1 L4,18 - I w2 L4,18 == 0,
6 d4 + w2
2 L3,19 == 0, 2 d3 + w2
2 L3,20 - I w1 L4,20 - I w2 L4,20 == 0, 3 d4 + w2
2 L3,21 - 2 I w2 L4,21 == 0<
Solving eq611b for the NRTsymbolList1, we obtain
160
Chapter6.nb

coef11 = Solve@eq611b, Array@NRTsymbolList1, 2D  FlattenD@@1DD
:L2,5 ﬁ0, L2,16 ﬁ0, L2,21 ﬁ0, L1,5 ﬁ- 6 d1

w12 , L1,16 ﬁ- 6 d1

w12 , L1,21 ﬁ- 2 d3

w12 , L2,1 ﬁ0, L2,2 ﬁ0,
L2,3 ﬁ- 2 W2 m1

W2 - w12 , L2,4 ﬁ- 2 W2 m1

W2 - w12 , L2,6 ﬁ- 6 I W d1

4 W2 - w12 , L2,7 ﬁ
6 I W d1

4 W2 - w12 , L2,9 ﬁ2 I d1

w1
,
L2,10 ﬁ0, L2,14 ﬁ- 2 I d3 w2

w12 - 4 w22 , L2,17 ﬁ- 2 I d1

w1
, L2,18 ﬁ0, L2,23 ﬁ2 I d3 w2

w12 - 4 w22 , L1,1 ﬁ0, L1,2 ﬁ0,
L1,3 ﬁ- 2 I W m1

W2 - w1
2 , L1,4 ﬁ2 I W m1

W2 - w1
2 , L1,6 ﬁ
3 d1

4 W2 - w1
2 , L1,7 ﬁ
3 d1

4 W2 - w1
2 , L1,9 ﬁd1

w1
2 , L1,10 ﬁ0,
L1,14 ﬁ-
d3

w1
2 - 4 w2
2 , L1,17 ﬁd1

w1
2 , L1,18 ﬁ0, L1,23 ﬁ-
d3

w1
2 - 4 w2
2 , L2,8 ﬁ6 I d1 HW + w1L

W HW + 2 w1L
,
L2,11 ﬁ-
2 I d2 HW - w2L


W2 - w12 - 2 W w2 + w22 , L2,12 ﬁ
2 I d2 HW + w2L


W2 - w12 + 2 W w2 + w22 , L2,13 ﬁ2 I d2 Hw1 + w2L

w2 H2 w1 + w2L
,
L2,15 ﬁ- 6 I d1 HW + w1L

W HW + 2 w1L
, L2,19 ﬁ-
2 I d2 HW + w2L


W2 - w12 + 2 W w2 + w22 , L2,20 ﬁ
2 I d2 HW - w2L


W2 - w12 - 2 W w2 + w22 ,
L2,22 ﬁ- 2 I d2 Hw1 + w2L

w2 H2 w1 + w2L
, L1,8 ﬁ
6 d1

W HW + 2 w1L
, L1,11 ﬁ-
2 d2


-W2 + w1
2 + 2 W w2 - w2
2 ,
L1,12 ﬁ-
2 d2


-W2 + w12 - 2 W w2 - w22 , L1,13 ﬁ
2 d2

w2 H2 w1 + w2L
, L1,15 ﬁ
6 d1

W HW + 2 w1L
,
L1,19 ﬁ-
2 d2


-W2 + w12 - 2 W w2 - w22 , L1,20 ﬁ-
2 d2


-W2 + w12 + 2 W w2 - w22 , L1,22 ﬁ
2 d2

w2 H2 w1 + w2L
>
Solving eq611c for the NRTsymbolList2, we obtain
coef12 = Solve@eq611c, Array@NRTsymbolList2, 2D  FlattenD@@1DD
:L4,1 ﬁ0, L4,14 ﬁ0, L4,19 ﬁ0, L3,1 ﬁ- 2 d2

w22 , L3,14 ﬁ- 2 d2

w22 , L3,19 ﬁ- 6 d4

w22 , L4,2 ﬁ- 2 I W d2

4 W2 - w22 ,
L4,3 ﬁ
2 I W d2

4 W2 - w2
2 , L4,4 ﬁ0, L4,10 ﬁ2 I d4

w2
, L4,11 ﬁ0, L4,21 ﬁ- 2 I d4

w2
, L3,2 ﬁ
d2

4 W2 - w2
2 ,
L3,3 ﬁ
d2

4 W2 - w2
2 , L3,4 ﬁ0, L3,10 ﬁd4

w2
2 , L3,11 ﬁ0, L3,21 ﬁd4

w2
2 , L4,5 ﬁ-
2 I d2 HW - w1L


W2 - 2 W w1 + w1
2 - w2
2 ,
L4,6 ﬁ
2 I d2 HW + w1L


W2 + 2 W w1 + w12 - w22 , L4,7 ﬁ- 2 I d3 HW - w2L

W HW - 2 w2L
, L4,8 ﬁ2 I d3 HW + w2L

W HW + 2 w2L
, L4,9 ﬁ2 I d3 Hw1 + w2L

w1 Hw1 + 2 w2L
,
L4,12 ﬁ-
2 I d2 HW + w1L


W2 + 2 W w1 + w12 - w22 , L4,13 ﬁ
2 I d2 HW - w1L


W2 - 2 W w1 + w12 - w22 , L4,15 ﬁ- 2 I d3 Hw1 - w2L

w1 Hw1 - 2 w2L
,
L4,16 ﬁ- 2 I d3 HW + w2L

W HW + 2 w2L
, L4,17 ﬁ2 I d3 HW - w2L

W HW - 2 w2L
, L4,18 ﬁ2 I d3 Hw1 - w2L

w1 Hw1 - 2 w2L
, L4,20 ﬁ- 2 I d3 Hw1 + w2L

w1 Hw1 + 2 w2L
,
L3,5 ﬁ
2 d2


W2 - 2 W w1 + w12 - w22 , L3,6 ﬁ
2 d2


W2 + 2 W w1 + w12 - w22 , L3,7 ﬁ
2 d3

W HW - 2 w2L
, L3,8 ﬁ
2 d3

W HW + 2 w2L
,
L3,9 ﬁ
2 d3

w1 Hw1 + 2 w2L
, L3,12 ﬁ
2 d2


W2 + 2 W w1 + w1
2 - w2
2 , L3,13 ﬁ
2 d2


W2 - 2 W w1 + w1
2 - w2
2 , L3,15 ﬁ
2 d3

w1 Hw1 -2 w2L
,
L3,16 ﬁ
2 d3

W HW + 2 w2L
, L3,17 ﬁ
2 d3

W HW - 2 w2L
, L3,18 ﬁ
2 d3

w1 Hw1 - 2 w2L
, L3,20 ﬁ
2 d3

w1 Hw1 + 2 w2L
>
Chapter6.nb
161

Substituting sol2Form into order2Eqm and collecting the coefficients of like RT, we obtain two sets of algebraic equations as
eq1 = MapIndexed@Coefficient@order2Eqm@@1, 1DD . sol2Form, #1D == r1,#2@@1DD &, RT@@1DDD .
Exp@_ T0 + _.D -> 0
82 I w1 G1,1 == r1,1, I W G1,2 == r1,2, I w2 G1,3 == r1,3<
eq2 = MapIndexed@Coefficient@order2Eqm@@3, 1DD . sol2Form, #1D == r3,#2@@1DD &, RT@@2DDD .
Exp@_ T0 + _.D -> 0
8I W G3,1 + I w2 G3,1 == r3,1, I W G3,2 + I w2 G3,2 == r3,2, 2 I w1 G3,3 + I w2 G3,3 == r3,3, 2 I w2 G3,4 == r3,4<
Solving eq1 and eq2 for the RTsymbolList1 and RTsymbolList2, we obtain
coef21 = Solve@eq1, RTsymbolList1D@@1DD . r1Rule
:G1,1 ﬁ- I m1

2 w1
, G1,2 ﬁ- 3 d1

W w1
, G1,3 ﬁ-
d2

w1 w2
>
coef22 = Solve@eq2, RTsymbolList2D@@1DD . r3Rule
:G3,4 ﬁ- I m2

2 w2
, G3,1 ﬁ
f2

4 w2 HW + w2L
, G3,2 ﬁ0, G3,3 ﬁ-
d2

2 w2 H2 w1 + w2L
>
Combining these coefficients using the function Join yields
coeffs = Join@coef11, coef12, coef21, coef22,
coef21 . conjugateRule, coef22 . conjugateRuleD . HomgRule@@1DD . e -> 0L;
Then, we express the solution of the second-order equations in pure function form as
sol2 = sol2Form . Function@8T0, T1, T2<, a_D :>
Function@8T0, T1, T2<  Evaluate, a . coeffs  Expand  EvaluateD;
sol2 . displayRule
9u1,2 ﬁFunctionA8T0, T1, T2<,
- 6 d1 L1
2

w1
2
+ E-2 I T0 W-2 I t1 d1 L1
2


5 w1
2
+ E2 I T0 W+2 I t1 d1 L1
2

5 w1
2
- 4 I E-IT0 W-I t1 L1 m1


3 w1
+ 4 I EI T0 W+I t1 L1 m1


3 w1
-
3 E-IT0 W-I t1+I T0 w1 d1 L1 A1


2 w12
+ 3 EI T0 W+I t1+I T0 w1 d1 L1 A1


4 w12
- I EI T0 w1 m1 A1

2 w1
+ E2 I T0 w1 d1 A1
2

w12
-
2 E-IT0 W-I t1+I T0 w2 d2 L1 A2


w1
2
+ 2 EI T0 W+I t1+I T0 w2 d2 L1 A2


15 w1
2
+ EI T0 w1+I T0 w2 d2 A1 A2


4 w1
2
+ E2 I T0 w2 d3 A2
2

15 w1
2
+
3 E-IT0 W-I t1-I T0 w1 d1 L1 A
1


4 w12
- 3 EI T0 W+I t1-I T0 w1 d1 L1 A
1


2 w12
+ I E-I T0 w1 m1 A
1

2 w1
- 6 d1 A1 A
1

w12
-
E-I T0 w1+I T0 w2 d2 A2 A
1


2 w12
+ E-2 I T0 w1 d1 A
1
2

w12
+ 2 E-I T0 W-I t1-I T0 w2 d2 L1 A
2


15 w12
- 2 EI T0 W+I t1-I T0 w2 d2 L1 A
2


w12
-
162
Chapter6.nb

EI T0 w1-IT0 w2 d2 A1 A
2


2 w1
2
- 2 d3 A2 A
2

w1
2
+ E-I T0 w1-I T0 w2 d2 A
1 A
2


4 w1
2
+ E-2 I T0 w2 d3 A
2
2

15 w1
2
E,
v1,2 ﬁFunctionA8T0, T1, T2<, - 8
3
E-I T0 W-I t1 L1 m1 - 8
3
EI T0 W+I t1 L1 m1 - 4 I E-2 I T0 W-2 I t1 d1 L1
2


5 w1
+
4 I E2I T0 W+2 It1 d1 L1
2


5 w1
- 1
2
EI T0 w1 m1 A1 - 3 I E-I T0 W-It1+I T0 w1 d1 L1 A1


2 w1
+ 9 I EIT0 W+I t1+I T0 w1 d1 L1 A1


4 w1
+
2 I E2I T0 w1 d1 A1
2

w1
+ 8 I EIT0 W+I t1+I T0 w2 d2 L1 A2


15 w1
+ 3 I EI T0 w1+I T0 w2 d2 A1 A2


4 w1
+ 4 I E2 I T0 w2 d3 A2
2

15 w1
-
1
2
E-I T0 w1 m1 A
1 - 9 I E-I T0 W-I t1-I T0 w1 d1 L1 A
1


4 w1
+ 3 I EI T0 W+I t1-I T0 w1 d1 L1 A
1


2 w1
+
I E-IT0 w1+I T0 w2 d2 A2 A
1


2 w1
- 2 I E-2 I T0 w1 d1 A
1
2

w1
- 8 I E-I T0 W-I t1-I T0 w2 d2 L1 A
2


15 w1
-
I EI T0 w1-I T0 w2 d2 A1 A
2


2 w1
- 3 I E-I T0 w1-I T0 w2 d2 A
1 A
2


4 w1
- 4 I E-2 I T0 w2 d3 A
2
2

15 w1
E,
u2,2 ﬁFunctionA8T0, T1, T2<, E-I T0 W-I t2 f2

32 w1
2
+ EI T0 W+I t2 f2

32 w1
2
- d2 L12

2 w1
2 + E-2 I T0 W-2 I t1 d2 L12


12 w1
2
+
E2 IT0 W+2 I t1 d2 L1
2

12 w12
- 2 E-I T0 W-It1+I T0 w1 d2 L1 A1


3 w12
+ 2 EI T0 W+I t1+I T0 w1 d2 L1 A1


5 w12
- E2 I T0 w1 d2 A1
2

16 w12
-
E-I T0 W-I t1+I T0 w2 d3 L1 A2


2 w1
2
+ EI T0 W+I t1+IT0 w2 d3 L1 A2


6 w1
2
- I EI T0 w2 m2 A2

4 w1
+ 2 EI T0 w1+I T0 w2 d3 A1 A2


5 w1
2
+
E2 IT0 w2 d4 A2
2

4 w12
+ 2 E-I T0 W-I t1-I T0 w1 d2 L1 A
1


5 w12
- 2 EI T0 W+I t1-IT0 w1 d2 L1 A
1


3 w12
- d2 A1 A
1

2 w12
-
2 E-IT0 w1+I T0 w2 d3 A2 A
1


3 w12
- E-2 I T0 w1 d2 A
1
2

16 w12
+ E-I T0 W-I t1-I T0 w2 d3 L1 A
2


6 w12
- EIT0 W+I t1-I T0 w2 d3 L1 A
2


2 w12
+
I E-IT0 w2 m2 A
2

4 w1
- 2 EI T0 w1-IT0 w2 d3 A1 A
2


3 w1
2
- 3 d4 A2 A
2

2 w1
2
+ 2 E-I T0 w1-I T0 w2 d3 A
1 A
2


5 w1
2
+ E-2 I T0 w2 d4 A
2
2

4 w1
2
E,
v2,2 ﬁFunctionA8T0, T1, T2<, - I E-2I T0 W-2 It1 d2 L12


3 w1
+ I E2 I T0 W+2 I t1 d2 L12


3 w1
+ I E-I T0 W-I t2 f2 w2

32 w1
2
-
I EI T0 W+I t2 f2 w2

32 w1
2
+ 2 I E-I T0 W-I t1+I T0 w1 d2 L1 A1


3 w1
+ 6 I EI T0 W+I t1+I T0 w1 d2 L1 A1


5 w1
+
I E2 IT0 w1 d2 w2 A1
2

16 w12
+ 2 I EI T0 W+I t1+I T0 w2 d3 L1 A2


3 w1
- EIT0 w2 m2 w2 A2

4 w1
+ 6 I EI T0 w1+I T0 w2 d3 A1 A2


5 w1
+
I E2 IT0 w2 d4 A2
2

w1
- 6 I E-IT0 W-I t1-I T0 w1 d2 L1 A
1


5 w1
- 2 I EI T0 W+I t1-I T0 w1 d2 L1 A
1


3 w1
-
2 I E-I T0 w1+I T0 w2 d3 A2 A
1


3 w1
- I E-2 I T0 w1 d2 w2 A
1
2


16 w1
2
- 2 I E-I T0 W-I t1-I T0 w2 d3 L1 A
2


3 w1
-
E-I T0 w2 m2 w2 A
2

4 w1
+ 2 I EI T0 w1-I T0 w2 d3 A1 A
2


3 w1
- 6 I E-I T0 w1-I T0 w2 d3 A
1 A
2


5 w1
- I E-2 I T0 w2 d4 A
2
2

w1
E=
 Third-Order Problem
Chapter6.nb
163

Substituting the first- and second-order solutions into the third-order problem, eqOrder[3], yields
order3Eq = eqOrder@3D . sol1 . sol2  ExpandAll;
Substituting the expRule1 into the right-hand sides  of order3Eq and collecting the terms  that could  produce secular terms,
the terms proportional to EI w1 T0  and EI w2  T0, we have
ST21 = Coefficient@order3Eq@@#, 2DD . expRule1@1D, Exp@I w1 T0DD &  81, 2<;
ST21 . displayRule
:-HD2A1L + EI T1 s1 HD1A
1L A2 d2


2 w12
+ 3 EI T1 s1+I T1 s2+I t1 HD1A
1L d1 L1


2 w12
+ I HD1A1L m1

2 w1
+ EI T1 s1 HD1A2L d2 A
1


2 w12
,
-6 E-I T1 s2-It1 A1 A2 a2 L1 - 24 A1 a1 L1
2 + 1
2
HD1A1L m1 + A1 m1
2 + 27 E-I T1 s2-I t1 A1 A2 d1 d2 L1


2 w12
+
23 E-IT1 s2-I t1 A1 A2 d2 d3 L1


15 w12
+ 81 A1 d1
2 L1
2

2 w12
+ 23 A1 d2
2 L1
2

15 w12
- I EI T1 s1 HD1A
1L A2 d2


2 w1
-
3 I EI T1 s1+I T1 s2+I t1 HD1A
1L d1 L1


2 w1
- I HD2A1L w1 - 12 A1
2 a1 A
1 + 30 A1
2 d1
2 A
1

w12
- EI T1 s1+I T1 s2+I t2 f2 d2 A
1


16 w12
+
9 A1
2 d2
2 A
1

8 w12
- I EI T1 s1 HD1A2L d2 A
1


2 w1
- 2 I EI T1 s1 A2 d2 m1 A
1


w1
- 14 I EI T1 s1+I T1 s2+I t1 d1 L1 m1 A
1


w1
+
I EI T1 s1 A2 d2 m2 A
1


2 w1
- 4 A1 A2 a3 A
2 - 6 EI T1 s2+I t1 A1 a2 L1 A
2 + A1 A2 d2
2 A
2

2 w1
2
+ 12 A1 A2 d1 d3 A
2

w1
2
+
8 A1 A2 d32 A
2

15 w1
2
+ 3 A1 A2 d2 d4 A
2

w1
2
+ 27 EI T1 s2+I t1 A1 d1 d2 L1 A
2


2 w1
2
+ 23 EI T1 s2+It1 A1 d2 d3 L1 A
2


15 w1
2
>
164
Chapter6.nb

ST22 = Coefficient@order3Eq@@#, 2DD . expRule1@2D, Exp@I w2 T0DD &  83, 4<;
ST22 . displayRule
:-HD2A2L + E-I T1 s1 HD1A1L A1 d2


8 w1
2
+ I HD1A2L m2

4 w1
,
-3 E-I T1 s2-It1 A2
2 a4 L1 - 4 A2 a3 L1
2 - 3 EI T1 s2+I t1 a2 L1
3 + 58 E-I T1 s2-I t1 A2
2 d2 d3 L1


15 w12
+
5 E-I T1 s2-I t1 A2
2 d3 d4 L1


2 w1
2
+ 56 A2 d2
2 L1
2

15 w1
2
+ 12 A2 d1 d3 L1
2

w1
2
+ 2 A2 d3
2 L1
2

3 w1
2
+ 3 A2 d2 d4 L1
2

w1
2
+
58 EI T1 s2+I t1 d1 d2 L1
3


5 w12
+ 5 EI T1 s2+It1 d2 d3 L1
3


6 w12
+ I E-I T1 s1 A1
2 d2 m1

w1
- I HD2A2L w2 -
I E-I T1 s1 HD1A1L A1 d2 w2


8 w1
2
+ I EI T1 s2+I t2 f2 m2 w2


16 w1
2
- I E-I T1 s1 A1
2 d2 m2 w2


8 w1
2
+ HD1A2L m2 w2

4 w1
+
A2 m2
2 w2

2 w1
- 4 A1 A2 a3 A
1 - 6 EI T1 s2+I t1 A1 a2 L1 A
1 + A1 A2 d2
2 A
1

2 w1
2
+ 12 A1 A2 d1 d3 A
1

w1
2
+
8 A1 A2 d3
2 A
1

15 w12
+ 3 A1 A2 d2 d4 A
1

w12
+ 27 EI T1 s2+I t1 A1 d1 d2 L1 A
1


2 w12
+ 23 EI T1 s2+It1 A1 d2 d3 L1 A
1


15 w12
-
12 A2
2 a5 A
2 - 6 EI T1 s2+I t1 A2 a4 L1 A
2 - 2 E2 I T1 s2+2 I t1 a3 L1
2 A
2 + 58 A2
2 d3
2 A
2

15 w12
+ 15 A2
2 d4
2 A
2

2 w12
+
116 EI T1 s2+I t1 A2 d2 d3 L1 A
2


15 w12
+ 5 EI T1 s2+It1 A2 d3 d4 L1 A
2


w12
+ 4 E2 I T1 s2+2 I t1 d2
2 L1
2 A
2


w12
-
2 E2 IT1 s2+2 I t1 d1 d3 L1
2 A
2


5 w1
2
+ E2 I T1 s2+2 I t1 d3
2 L1
2 A
2


w1
2
- E2 I T1 s2+2 It1 d2 d4 L1
2 A
2


2 w1
2
>
Then, the solvability conditions demand that ST21 and ST22 be orthogonal to solutions of their corresponding adjoints, the
components of ccleftVec. The result is
Chapter6.nb
165

SCond2 = 8ccleftVec@@1DD.ST21 == 0, ccleftVec@@2DD.ST22 == 0<  ExpandAll;
SCond2 . displayRule
:-6 E-I T1 s2-It1 A1 A2 a2 L1 - 24 A1 a1 L1
2 + A1 m1
2 + 27 E-I T1 s2-I t1 A1 A2 d1 d2 L1


2 w1
2
+
23 E-IT1 s2-I t1 A1 A2 d2 d3 L1


15 w12
+ 81 A1 d1
2 L1
2

2 w12
+ 23 A1 d2
2 L1
2

15 w12
- 2 I HD2A1L w1 - 12 A1
2 a1 A
1 + 30 A1
2 d1
2 A
1

w12
-
EI T1 s1+IT1 s2+I t2 f2 d2 A
1


16 w12
+ 9 A1
2 d2
2 A
1

8 w12
- 2 I EI T1 s1 A2 d2 m1 A
1


w1
- 14 I EI T1 s1+I T1 s2+It1 d1 L1 m1 A
1


w1
+
I EI T1 s1 A2 d2 m2 A
1


2 w1
- 4 A1 A2 a3 A
2 - 6 EI T1 s2+I t1 A1 a2 L1 A
2 + A1 A2 d2
2 A
2

2 w12
+ 12 A1 A2 d1 d3 A
2

w12
+
8 A1 A2 d3
2 A
2

15 w12
+ 3 A1 A2 d2 d4 A
2

w12
+ 27 EI T1 s2+I t1 A1 d1 d2 L1 A
2


2 w12
+ 23 EI T1 s2+It1 A1 d2 d3 L1 A
2


15 w12
== 0,
-3 E-I T1 s2-It1 A2
2 a4 L1 - 4 A2 a3 L1
2 - 3 EI T1 s2+I t1 a2 L1
3 + 58 E-I T1 s2-I t1 A2
2 d2 d3 L1


15 w12
+
5 E-IT1 s2-I t1 A2
2 d3 d4 L1


2 w1
2
+ 56 A2 d2
2 L1
2

15 w1
2
+ 12 A2 d1 d3 L1
2

w1
2
+ 2 A2 d3
2 L1
2

3 w1
2
+ 3 A2 d2 d4 L1
2

w1
2
+
58 EI T1 s2+I t1 d1 d2 L1
3


5 w12
+ 5 EI T1 s2+It1 d2 d3 L1
3


6 w12
+ I E-I T1 s1 A1
2 d2 m1

w1
- 2 I HD2A2L w2 +
I EI T1 s2+I t2 f2 m2 w2


16 w12
- I E-I T1 s1 A1
2 d2 m2 w2


8 w12
+ A2 m2
2 w2

2 w1
- 4 A1 A2 a3 A
1 -
6 EI T1 s2+I t1 A1 a2 L1 A
1 + A1 A2 d2
2 A
1

2 w1
2
+ 12 A1 A2 d1 d3 A
1

w1
2
+ 8 A1 A2 d3
2 A
1

15 w1
2
+
3 A1 A2 d2 d4 A
1

w12
+ 27 EI T1 s2+I t1 A1 d1 d2 L1 A
1


2 w12
+ 23 EI T1 s2+I t1 A1 d2 d3 L1 A
1


15 w12
-
12 A2
2 a5 A
2 - 6 EI T1 s2+I t1 A2 a4 L1 A
2 - 2 E2 I T1 s2+2 I t1 a3 L1
2 A
2 + 58 A2
2 d3
2 A
2

15 w12
+ 15 A2
2 d4
2 A
2

2 w12
+
116 EIT1 s2+I t1 A2 d2 d3 L1 A
2


15 w1
2
+ 5 EI T1 s2+I t1 A2 d3 d4 L1 A
2


w1
2
+ 4 E2 I T1 s2+2 I t1 d22 L12 A
2


w1
2
-
2 E2 IT1 s2+2 I t1 d1 d3 L12 A
2


5 w1
2
+ E2 I T1 s2+2 I t1 d32 L12 A
2


w1
2
- E2 I T1 s2+2 It1 d2 d4 L12 A
2


2 w1
2
== 0>
Solving SCond2 for D2 A1 and D2 A2, we have
166
Chapter6.nb

SCond2Rule1 = SolveASCond2, 9A1
H0,1L@T1, T2D, A2
H0,1L@T1, T2D=E@@1DD  ExpandAll;
SCond2Rule1 . displayRule
:D2A1 ﬁ- 27 I E-I T1 s2-I t1 A1 A2 d1 d2 L1


4 w13
- 23 I E-I T1 s2-I t1 A1 A2 d2 d3 L1


30 w13
- 81 I A1 d1
2 L1
2

4 w13
- 23 I A1 d2
2 L1
2

30 w13
+
3 I E-IT1 s2-I t1 A1 A2 a2 L1


w1
+ 12 I A1 a1 L1
2

w1
- I A1 m1
2

2 w1
- 15 I A1
2 d1
2 A
1

w13
+ I EI T1 s1+I T1 s2+I t2 f2 d2 A
1


32 w13
-
9 I A1
2 d2
2 A
1

16 w13
- EI T1 s1 A2 d2 m1 A
1

w12
- 7 EI T1 s1+I T1 s2+I t1 d1 L1 m1 A
1


w12
+ EIT1 s1 A2 d2 m2 A
1

4 w12
+ 6 I A1
2 a1 A
1

w1
-
I A1 A2 d2
2 A
2

4 w1
3
- 6 I A1 A2 d1 d3 A
2

w1
3
- 4 I A1 A2 d3
2 A
2

15 w1
3
- 3 I A1 A2 d2 d4 A
2

2 w1
3
- 27 I EI T1 s2+I t1 A1 d1 d2 L1 A
2


4 w1
3
-
23 I EIT1 s2+I t1 A1 d2 d3 L1 A
2


30 w13
+ 2 I A1 A2 a3 A
2

w1
+ 3 I EI T1 s2+I t1 A1 a2 L1 A
2


w1
,
D2A2 ﬁEI T1 s2+I t2 f2 m2

32 w1
2
- E-I T1 s1 A1
2 d2 m2

16 w1
2
- I A2 m2
2

4 w1
+ 3 I E-I T1 s2-It1 A2
2 a4 L1


2 w2
+ 2 I A2 a3 L1
2

w2
+
3 I EIT1 s2+I t1 a2 L1
3


2 w2
- 29 I E-I T1 s2-I t1 A2
2 d2 d3 L1


15 w12 w2
- 5 I E-I T1 s2-I t1 A2
2 d3 d4 L1


4 w12 w2
- 28 I A2 d2
2 L1
2

15 w12 w2
-
6 I A2 d1 d3 L1
2

w1
2 w2
- I A2 d3
2 L1
2

3 w1
2 w2
- 3 I A2 d2 d4 L1
2

2 w1
2 w2
- 29 I EI T1 s2+I t1 d1 d2 L1
3


5 w1
2 w2
- 5 I EI T1 s2+I t1 d2 d3 L1
3


12 w1
2 w2
+
E-I T1 s1 A1
2 d2 m1

2 w1 w2
+ 2 I A1 A2 a3 A
1

w2
+ 3 I EI T1 s2+I t1 A1 a2 L1 A
1


w2
- I A1 A2 d2
2 A
1

4 w1
2 w2
- 6 I A1 A2 d1 d3 A
1

w1
2 w2
-
4 I A1 A2 d3
2 A
1

15 w12 w2
- 3 I A1 A2 d2 d4 A
1

2 w12 w2
- 27 I EI T1 s2+I t1 A1 d1 d2 L1 A
1


4 w12 w2
- 23 I EI T1 s2+I t1 A1 d2 d3 L1 A
1


30 w12 w2
+
6 I A2
2 a5 A
2

w2
+ 3 I EI T1 s2+It1 A2 a4 L1 A
2


w2
+ I E2 I T1 s2+2 I t1 a3 L1
2 A
2


w2
- 29 I A2
2 d3
2 A
2

15 w12 w2
- 15 I A2
2 d4
2 A
2

4 w12 w2
-
58 I EIT1 s2+I t1 A2 d2 d3 L1 A
2


15 w12 w2
- 5 I EIT1 s2+I t1 A2 d3 d4 L1 A
2


2 w12 w2
- 2 I E2I T1 s2+2 I t1 d2
2 L1
2 A
2


w12 w2
+
I E2 IT1 s2+2 I t1 d1 d3 L1
2 A
2


5 w1
2 w2
- I E2 I T1 s2+2 It1 d3
2 L1
2 A
2


2 w1
2 w2
+ I E2 I T1 s2+2I t1 d2 d4 L1
2 A
2


4 w1
2 w2
>
 Reconstitution
Using  the  method  of reconstitution,  Ak
¢ = eD1 Ak + e2 D2 Ak + ”,  we  combine  the  partial-differential equations  SCond1-
Rule1  and SCond2Rule1  into  the following two  ordinary-differential equations  governing  the modulation  of the complex-
valued functions Ak :
Chapter6.nb
167

moduEq = Table@2 I wk Ak¢, 8k, 2<D ==
HTable@2 I wk dt@1D@ Ak@T1, T2DD, 8k, 2<D . SCond1Rule1 . SCond2Rule1 
Collect@#, eD &L  Thread;
moduEq . displayRule
:2 I w1 A1
¢ == 2 I e w1
i
k
jjjj-A1 m1 + I EI T1 s1 A2 d2 A
1

w1
+ 3 I EI T1 s1+I T1 s2+I t1 d1 L1 A
1


w1
y
{
zzzz +
2 I e2 w1
i
k
jjjj- 27 I E-I T1 s2-I t1 A1 A2 d1 d2 L1


4 w13
- 23 I E-I T1 s2-I t1 A1 A2 d2 d3 L1


30 w13
-
81 I A1 d12 L12

4 w1
3
- 23 I A1 d22 L12

30 w1
3
+ 3 I E-I T1 s2-It1 A1 A2 a2 L1


w1
+ 12 I A1 a1 L12

w1
- I A1 m12

2 w1
-
15 I A1
2 d1
2 A
1

w1
3
+ I EI T1 s1+IT1 s2+I t2 f2 d2 A
1


32 w1
3
- 9 I A1
2 d2
2 A
1

16 w1
3
- EI T1 s1 A2 d2 m1 A
1

w1
2
-
7 EIT1 s1+I T1 s2+I t1 d1 L1 m1 A
1


w12
+ EI T1 s1 A2 d2 m2 A
1

4 w12
+ 6 I A1
2 a1 A
1

w1
- I A1 A2 d2
2 A
2

4 w13
-
6 I A1 A2 d1 d3 A
2

w13
- 4 I A1 A2 d3
2 A
2

15 w13
- 3 I A1 A2 d2 d4 A
2

2 w13
- 27 I EIT1 s2+I t1 A1 d1 d2 L1 A
2


4 w13
-
23 I EI T1 s2+I t1 A1 d2 d3 L1 A
2


30 w13
+ 2 I A1 A2 a3 A
2

w1
+ 3 I EI T1 s2+I t1 A1 a2 L1 A
2


w1
y
{
zzzz,
2 I w2 A2
¢ == 2 I e i
k
jjj-A2 m2 - I EI T1 s2+It2 f2

4 w2
+ I E-I T1 s1 A12 d2

2 w2
y
{
zzz w2 +
2 I e2 w2
i
k
jjjj
EIT1 s2+I t2 f2 m2

32 w12
- E-I T1 s1 A1
2 d2 m2

16 w12
- I A2 m2
2

4 w1
+ 3 I E-I T1 s2-I t1 A2
2 a4 L1


2 w2
+ 2 I A2 a3 L1
2

w2
+
3 I EIT1 s2+I t1 a2 L13


2 w2
- 29 I E-I T1 s2-I t1 A22 d2 d3 L1


15 w1
2 w2
- 5 I E-I T1 s2-I t1 A22 d3 d4 L1


4 w1
2 w2
- 28 I A2 d22 L12

15 w1
2 w2
-
6 I A2 d1 d3 L1
2

w12 w2
- I A2 d3
2 L1
2

3 w12 w2
- 3 I A2 d2 d4 L1
2

2 w12 w2
- 29 I EI T1 s2+I t1 d1 d2 L1
3


5 w12 w2
- 5 I EI T1 s2+I t1 d2 d3 L1
3


12 w12 w2
+
E-IT1 s1 A1
2 d2 m1

2 w1 w2
+ 2 I A1 A2 a3 A
1

w2
+ 3 I EI T1 s2+I t1 A1 a2 L1 A
1


w2
- I A1 A2 d2
2 A
1

4 w12 w2
- 6 I A1 A2 d1 d3 A
1

w12 w2
-
4 I A1 A2 d3
2 A
1

15 w12 w2
- 3 I A1 A2 d2 d4 A
1

2 w12 w2
- 27 I EI T1 s2+I t1 A1 d1 d2 L1 A
1


4 w12 w2
- 23 I EI T1 s2+I t1 A1 d2 d3 L1 A
1


30 w12 w2
+
6 I A22 a5 A
2

w2
+ 3 I EI T1 s2+I t1 A2 a4 L1 A
2


w2
+ I E2 I T1 s2+2 I t1 a3 L12 A
2


w2
- 29 I A22 d32 A
2

15 w1
2 w2
- 15 I A22 d42 A
2

4 w1
2 w2
-
58 I EI T1 s2+I t1 A2 d2 d3 L1 A
2


15 w1
2 w2
- 5 I EI T1 s2+I t1 A2 d3 d4 L1 A
2


2 w1
2 w2
- 2 I E2 I T1 s2+2 I t1 d22 L12 A
2


w1
2 w2
+
I E2I T1 s2+2 I t1 d1 d3 L1
2 A
2


5 w12 w2
- I E2 I T1 s2+2 It1 d3
2 L1
2 A
2


2 w12 w2
+ I E2 I T1 s2+2 I t1 d2 d4 L1
2 A
2


4 w12 w2
y
{
zzzz>
168
Chapter6.nb

 6.1.2 The function MMS
According to  the procedures  described  in the previous section, we can build  a function named MMS (Method  of Multiple
Scales) specifically for eq61b. A more general function (a Package) can be created by considering as  arguments  the govern -
ing  equations, symbols  for dependent variables, independent variable, excitation  amplitudes  and  frequencies, and all other
related  quantities  which  allow the  program to  identify  their  respective meanings. We  will use MMS  to  solve  for different
resonance cases in the following sections.
MMS@scaling_List, ResonanceCond : 8__Equal<D :=
ModuleA8<,
omgList = 8w1, w2<;
omgRule = Solve@ResonanceCond, 8W, #<  FlattenD@@1DD &  omgList  Reverse;
multiScales = 8ui_@tD -> ui  timeScales, vi_@tD -> vi  timeScales,
Derivative@1D@u_D@tD -> dt@1D@u  timeScalesD, t -> T0<;
eqa = Heq61b . scaling . multiScales . solRule  TrigToExp  ExpandAllL .
en_;n>3 -> 0;
eqEps = Rest@Thread@CoefficientList@Subtract  #, eD == 0DD &  eqa  Transpose;
eqOrder@i_D :=
I#@@1DD &  eqEps@@1DD . fs_ -> 0 . u_k_,1 -> uk,iM == I#@@1DD &  eqEps@@1DD . fs_ -> 0 .
u_k_,1 -> uk,iM - H#@@1DD &  eqEps@@iDDL  Thread;
H* First-Order Problem *L
linearSys = #@@1DD &  eqOrder@1D;
expr1 = linearSys . 9ui_,1 -> IP EI wi #1 &M, vi_,1 -> IQ EI wi #1 &M= . Exp@a_D -> 1 
Partition@#, 2D &;
coefMat = Outer@D, #, 8P, Q<D &  expr1;
hermitian@mat_? MatrixQD := mat . conjugateRule  Transpose;
rightVec = #  #@@1DD &  HNullSpace@#D@@1DD &  coefMatL;
leftVec = NullSpace@hermitian@#DD@@1DD &  coefMat;
ccleftVec = leftVec . conjugateRule;
order1Eq = eqOrder@1D . u_i_,1 -> Hui,1@#1D &L;
sol1p =
DSolve@order1Eq, 8u1,1@T0D, v1,1@T0D, u2,1@T0D, v2,1@T0D<, T0D@@1DD . C@_D -> 0  Simplify;
fRule = 9fi_ -> 2 Li Iwi
2 - W2M=;
sol1u =
TableAui,1 -> FunctionA8T0, T1, T2<, Ai@T1, T2D Exp@I wi T0D + A
i@T1, T2D Exp@-I wi T0D +
Hui,1@T0D . sol1p . fRule  Simplify  ExpandL  EvaluateE, 8i, 2<E;
sol1v = Table@vi,1 -> Function@8T0, T1, T2<,
D@ui,1  timeScales, T0D . sol1u  EvaluateD, 8i, 2<D;
sol1 = Join@sol1u, sol1vD;
Chapter6.nb
169

H* Second-Order Problem *L
order2Eq = eqOrder@2D . sol1  ExpandAll;
expRule1@i_D :=
Exp@a_D :> Exp@Expand@a . omgRule@@iDDD . en_. T0 :> timeScales@@n + 1DDD;
ST11 = Coefficient@order2Eq@@#, 2DD . expRule1@1D, Exp@I w1 T0DD &  81, 2<;
ST12 = Coefficient@order2Eq@@#, 2DD . expRule1@2D, Exp@I w2 T0DD &  83, 4<;
SCond1 = 8ccleftVec@@1DD.ST11 == 0, ccleftVec@@2DD.ST12 == 0<;
SCond1Rule1 = SolveASCond1, 9A1
H1,0L@T1, T2D, A2
H1,0L@T1, T2D=E@@1DD  ExpandAll;
sigRule = Solve@ResonanceCond, 8s1, s2<D@@1DD;
expRule2 = Exp@a_D :> ExpAa . 9T1 -> e T0, T2 -> e2 T0= . sigRule  ExpandE;
SCond1Rule2 = SCond1Rule1 . expRule2;
ccSCond1Rule2 = SCond1Rule2 . conjugateRule;
order2Eqm = order2Eq . SCond1Rule2 . ccSCond1Rule2  ExpandAll;
IfAUnion@#@@2DD &  order2EqmD === 80<,
sol2 = 8u1,2 -> H0 &L, v1,2 -> H0 &L, u2,2 -> H0 &L, v2,2 -> H0 &L<,
basicH = TableA9Ai@T1, T2D EI wi T0 , A
i@T1, T2D E-I wi T0=, 8i, 2<E  Flatten;
collectForm =
Join@basicH, If@list1 = List  Plus  H#@@2DD &  eqOrder@1DL . c_ fi_ Ea_ -> Li Ea;
Head@list1D === List, list1, 8<DD;
possibleTerms = JoinAcollectForm,
IfAlist1 = List  Plus  I#@@2DD &  eqOrder@2D . u_i_,j_ -> H0 &LM . c_ fi_ Ea_ -> Ea;
Head@list1D === List, list1, 8<E,
Outer@Times, collectForm, collectFormD  Flatten  UnionE;
ResonantTerms@i_D :=
I# . 8a_ ; a =!= 0 -> 1< &  IE-Iwi T0 possibleTerms . expRule1@iD . Exp@_ T0 + _.D -> 0MM
possibleTerms  Union  Rest;
RT = Array@ResonantTerms, 2D;
r1Rule = MapIndexed@
r1,#2@@1DD -> Coefficient@order2Eqm@@1, 2DD, #1D &, RT@@1DDD . Exp@_ T0 + _.D -> 0;
H* r2Rule=MapIndexed@r2,#2@@1DD->Coefficient@order2Eqm@@2,2DD,#1D &,
RT@@1DDD.Exp@_ T0+_.D->0; *L
r3Rule = MapIndexed@r3,#2@@1DD -> Coefficient@order2Eqm@@3, 2DD, #1D &, RT@@2DDD .
Exp@_ T0 + _.D -> 0;
H* r4Rule=MapIndexed@r4,#2@@1DD->Coefficient@order2Eqm@@4,2DD,#1D &,
RT@@2DDD.Exp@_ T0+_.D->0; *L
NRT = Complement@possibleTerms, Join@#, # . conjugateRuleDD &  RT;
RTsymbolList1 = Table@G1,j, 8j, Length@RT@@1DDD<D;
RTsymbolList2 = Table@G3,j, 8j, Length@RT@@2DDD<D;
NRTsymbolList1@i_D = Table@Li,j, 8j, Length@NRT@@1DDD<D;
NRTsymbolList2@i_D = Table@Li+2,j, 8j, Length@NRT@@2DDD<D;
8ratio1, ratio2< = Table@-ccleftVec@@i, 1DD, 8i, 2<D;
sol2Form = 8u1,2 -> Function@8T0, T1, T2<,
170
Chapter6.nb

RTsymbolList1.RT@@1DD + HRTsymbolList1.RT@@1DD . conjugateRuleL +
NRTsymbolList1@1D.NRT@@1DD  EvaluateD, v1,2 -> Function@8T0, T1, T2<,
ratio1 * RTsymbolList1.RT@@1DD + Hratio1 * RTsymbolList1.RT@@1DD . conjugateRuleL +
NRTsymbolList1@2D.NRT@@1DD  EvaluateD, u2,2 -> Function@8T0, T1, T2<,
RTsymbolList2.RT@@2DD + HRTsymbolList2.RT@@2DD . conjugateRuleL +
NRTsymbolList2@1D.NRT@@2DD  EvaluateD, v2,2 -> Function@8T0, T1, T2<,
ratio2 * RTsymbolList2.RT@@2DD + Hratio2 * RTsymbolList2.RT@@2DD . conjugateRuleL +
NRTsymbolList2@2D.NRT@@2DD  EvaluateD<;
eqb = HCoefficient@Subtract  # . sol2Form, NRT@@1DDD . Exp@_ T0 + _.D -> 0 & 
order2Eqm@@81, 2<DD  FlattenL == 0  Thread;
eqc = HCoefficient@Subtract  # . sol2Form, NRT@@2DDD . Exp@_ T0 + _.D -> 0 & 
order2Eqm@@83, 4<DD  FlattenL == 0  Thread;
coef11 = Solve@eqb, Array@NRTsymbolList1, 2D  FlattenD@@1DD;
coef12 = Solve@eqc, Array@NRTsymbolList2, 2D  FlattenD@@1DD;
eqd = MapIndexed@Coefficient@order2Eqm@@1, 1DD . sol2Form, #1D == r1,#2@@1DD &,
RT@@1DDD . Exp@_ T0 + _.D -> 0;
eqe = MapIndexed@Coefficient@order2Eqm@@3, 1DD . sol2Form, #1D == r3,#2@@1DD &,
RT@@2DDD . Exp@_ T0 + _.D -> 0;
coef21 = Solve@eqd, RTsymbolList1D@@1DD . r1Rule;
coef22 = Solve@eqe, RTsymbolList2D@@1DD . r3Rule;
coeffs = Join@coef11, coef12, coef21, coef22,
coef21 . conjugateRule, coef22 . conjugateRuleD . HomgRule@@1DD . e -> 0L;
sol2 = sol2Form . Function@8T0, T1, T2<, a_D :>
Function@8T0, T1, T2<  Evaluate, a . coeffs  Expand  EvaluateD
E;
H* Third-Order Problem *L
order3Eq = eqOrder@3D . sol1 . sol2  ExpandAll;
ST21 = Coefficient@order3Eq@@#, 2DD . expRule1@1D, Exp@I w1 T0DD &  81, 2<;
ST22 = Coefficient@order3Eq@@#, 2DD . expRule1@2D, Exp@I w2 T0DD &  83, 4<;
SCond2 = 8ccleftVec@@1DD.ST21 == 0, ccleftVec@@2DD.ST22 == 0<  ExpandAll;
SCond2Rule1 = SolveASCond2, 9A1
H0,1L@T1, T2D, A2
H0,1L@T1, T2D=E@@1DD  ExpandAll;
H* Reconstitution *L
moduEq =
Table@2 I wk Ak
¢, 8k, 2<D == HTable@2 I wk dt@1D@ Ak@T1, T2DD, 8k, 2<D . SCond1Rule1 .
SCond2Rule1  Collect@#, eD &L  Thread;
Print@"The second-order approximate solution:"D;
PrintATableA
ui@tD == Iui  timeScales . solRule . e3 -> 0 . sol1 . sol2 . displayRuleM, 8i, 2<EE;
IfAOr  Table@HFi  fi . scalingL === e, 8i, 2<D,
Print@"where"D;
Chapter6.nb
171

PrintA"Li==
fi

2 Iwi2 - W2M
"E
E;
Print@"\nThe modulation equations:"D;
Print@moduEq . displayRuleD
E
As an example, we check the case in Section 6.1.1:
scaling1 = 9m‘
n_ -> e mn, F1 -> e f1, F2 -> e2 f2=;
ResonanceCond1 = 8w2 == 2 w1 + e s1, W == w2 + e s2<;
MMS@scaling1, ResonanceCond1D  Timing
The second-order approximate solution:
:u1@tD == e IEIT0 w1 A1 + E-I T0 W-I t1 L1 + EI T0 W+It1 L1 + E-IT0 w1 A
1M +
e2 i
k
jjjj
E2 I T0 w1 A1
2 d1

w12
+
EI T0 w1+I T0 w2 A1 A2 d2


4 w12
+
E2 I T0 w2 A2
2 d3

15 w12
-
3 E-I T0 W-I t1+IT0 w1 A1 d1 L1


2 w12
+
3 EIT0 W+I t1+I T0 w1 A1 d1 L1


4 w12
-
2 E-I T0 W-I t1+I T0 w2 A2 d2 L1


w12
+
2 EI T0 W+I t1+IT0 w2 A2 d2 L1


15 w12
-
6 d1 L1
2

w12
+
E-2 I T0 W-2 I t1 d1 L1
2


5 w12
+
E2 I T0 W+2 I t1 d1 L1
2

5 w12
-
I EI T0 w1 A1 m1

2 w1
-
4 I E-I T0 W-I t1 L1 m1


3 w1
+
4 I EIT0 W+I t1 L1 m1


3 w1
- 6 A1 d1 A
1

w12
- E-I T0 w1+IT0 w2 A2 d2 A
1


2 w12
+ 3 E-I T0 W-I t1-I T0 w1 d1 L1 A
1


4 w12
-
3 EIT0 W+I t1-I T0 w1 d1 L1 A
1


2 w12
+ I E-I T0 w1 m1 A
1

2 w1
+ E-2 I T0 w1 d1 A
1
2

w12
- EI T0 w1-I T0 w2 A1 d2 A
2


2 w12
- 2 A2 d3 A
2

w12
+
2 E-IT0 W-I t1-I T0 w2 d2 L1 A
2


15 w1
2
- 2 EI T0 W+I t1-I T0 w2 d2 L1 A
2


w1
2
+ E-I T0 w1-I T0 w2 d2 A
1 A
2


4 w1
2
+ E-2I T0 w2 d3 A
2
2

15 w1
2
y
{
zzzz,
u2@tD == e IEIT0 w2 A2 + E-I T0 w2 A
2M + e2 i
k
jjjj
E-IT0 W-I t2 f2

32 w12
+ EI T0 W+I t2 f2

32 w12
- E2 IT0 w1 A12 d2

16 w12
+
2 EIT0 w1+I T0 w2 A1 A2 d3


5 w12
+ E2 I T0 w2 A22 d4

4 w12
- 2 E-I T0 W-I t1+I T0 w1 A1 d2 L1


3 w12
+
2 EIT0 W+I t1+I T0 w1 A1 d2 L1


5 w12
- E-I T0 W-I t1+I T0 w2 A2 d3 L1


2 w12
+ EI T0 W+I t1+I T0 w2 A2 d3 L1


6 w12
-
d2 L12

2 w12
+
E-2 I T0 W-2I t1 d2 L12


12 w12
+
E2 I T0 W+2 I t1 d2 L12

12 w12
-
I EI T0 w2 A2 m2

4 w1
-
A1 d2 A
1

2 w12
-
2 E-IT0 w1+I T0 w2 A2 d3 A
1


3 w12
+ 2 E-I T0 W-I t1-IT0 w1 d2 L1 A
1


5 w12
- 2 EI T0 W+I t1-I T0 w1 d2 L1 A
1


3 w12
-
E-2I T0 w1 d2 A
1
2

16 w12
-
2 EI T0 w1-IT0 w2 A1 d3 A
2


3 w12
-
3 A2 d4 A
2

2 w12
+
E-I T0 W-I t1-I T0 w2 d3 L1 A
2


6 w12
-
EI T0 W+I t1-I T0 w2 d3 L1 A
2


2 w12
+ I E-I T0 w2 m2 A
2

4 w1
+ 2 E-I T0 w1-I T0 w2 d3 A
1 A
2


5 w12
+ E-2I T0 w2 d4 A
2
2

4 w12
y
{
zzzz>
where
172
Chapter6.nb

Li==
fi

2 Hwi2 - W2L
The modulation equations:
:2 I w1 A1
¢ == 2 I e w1
i
k
jjj-A1 m1 +
I EI T1 s1 A2 d2 A
1

w1
+
3 I EI T1 s1+I T1 s2+I t1 d1 L1 A
1


w1
y
{
zzz +
2 I e2 w1
i
k
jjj-
27 I E-I T1 s2-I t1 A1 A2 d1 d2 L1


4 w1
3
-
23 I E-I T1 s2-I t1 A1 A2 d2 d3 L1


30 w1
3
-
81 I A1 d12 L12

4 w13
-
23 I A1 d22 L12

30 w13
+
3 I E-I T1 s2-It1 A1 A2 a2 L1


w1
+
12 I A1 a1 L12

w1
-
I A1 m12

2 w1
-
15 I A12 d12 A
1

w13
+ I EI T1 s1+IT1 s2+I t2 f2 d2 A
1


32 w13
- 9 I A12 d22 A
1

16 w13
- EI T1 s1 A2 d2 m1 A
1

w12
-
7 EIT1 s1+I T1 s2+I t1 d1 L1 m1 A
1


w12
+
EI T1 s1 A2 d2 m2 A
1

4 w12
+
6 I A1
2 a1 A
1

w1
-
I A1 A2 d2
2 A
2

4 w13
-
6 I A1 A2 d1 d3 A
2

w13
-
4 I A1 A2 d32 A
2

15 w13
-
3 I A1 A2 d2 d4 A
2

2 w13
-
27 I EIT1 s2+I t1 A1 d1 d2 L1 A
2


4 w13
-
23 I EI T1 s2+I t1 A1 d2 d3 L1 A
2


30 w1
3
+ 2 I A1 A2 a3 A
2

w1
+ 3 I EI T1 s2+I t1 A1 a2 L1 A
2


w1
y
{
zzz,
2 I w2 A2
¢ == 2 I e i
k
jj-A2 m2 -
I EI T1 s2+It2 f2

4 w2
+
I E-I T1 s1 A12 d2

2 w2
y
{
zz w2 +
2 I e2 w2
i
k
jjj
EIT1 s2+I t2 f2 m2

32 w12
-
E-I T1 s1 A12 d2 m2

16 w12
-
I A2 m22

4 w1
+
3 I E-I T1 s2-I t1 A22 a4 L1


2 w2
+
2 I A2 a3 L12

w2
+
3 I EIT1 s2+I t1 a2 L13


2 w2
- 29 I E-I T1 s2-I t1 A22 d2 d3 L1


15 w12 w2
- 5 I E-I T1 s2-I t1 A22 d3 d4 L1


4 w12 w2
-
28 I A2 d22 L12

15 w12 w2
- 6 I A2 d1 d3 L12

w12 w2
- I A2 d32 L12

3 w12 w2
- 3 I A2 d2 d4 L12

2 w12 w2
- 29 I EI T1 s2+I t1 d1 d2 L13


5 w12 w2
-
5 I EIT1 s2+I t1 d2 d3 L13


12 w12 w2
+
E-IT1 s1 A12 d2 m1

2 w1 w2
+
2 I A1 A2 a3 A
1

w2
+
3 I EI T1 s2+I t1 A1 a2 L1 A
1


w2
-
I A1 A2 d22 A
1

4 w12 w2
- 6 I A1 A2 d1 d3 A
1

w12 w2
- 4 I A1 A2 d32 A
1

15 w12 w2
- 3 I A1 A2 d2 d4 A
1

2 w12 w2
-
27 I EI T1 s2+I t1 A1 d1 d2 L1 A
1


4 w12 w2
-
23 I EI T1 s2+I t1 A1 d2 d3 L1 A
1


30 w12 w2
+
6 I A2
2 a5 A
2

w2
+
3 I EIT1 s2+I t1 A2 a4 L1 A
2


w2
+
I E2 I T1 s2+2 I t1 a3 L12 A
2


w2
-
29 I A22 d32 A
2

15 w12 w2
-
15 I A22 d42 A
2

4 w12 w2
-
58 I EI T1 s2+I t1 A2 d2 d3 L1 A
2


15 w12 w2
- 5 I EI T1 s2+I t1 A2 d3 d4 L1 A
2


2 w12 w2
- 2 I E2 I T1 s2+2 I t1 d22 L12 A
2


w12 w2
+
I E2I T1 s2+2 I t1 d1 d3 L12 A
2


5 w12 w2
- I E2 I T1 s2+2 It1 d32 L12 A
2


2 w12 w2
+ I E2 I T1 s2+2 I t1 d2 d4 L12 A
2


4 w12 w2
y
{
zzz>
882.98 Second, Null<
Chapter6.nb
173

 6.1.3 W » w1 and w2 » 2 w1
In  this  case,  we  have a  combination  of a  primary  resonance  of the  first mode,  a  superharmonic  resonance of the  second
mode,  and a two-to-one  internal resonance.  In order to  bring the effects  of damping, forcing, and nonlinearity at  the same
order, we let
scaling3 = 9m‘
n_ -> e mn, F1 -> e2 f1, F2 -> e f2=;
To describe quantitatively  the nearness of the resonances, we introduce the detuning parameters s1 and s2 defined accord-
ing to
ResonanceCond3 = 8w2 == 2 w1 + e s1, W == w1 + e s2<;
Using  MMS,  we  obtain  the  second-order approximate  solution  and  the  two  equations  governing  the  modulation  of the
complex-valued functions Ak:
MMS@scaling3, ResonanceCond3D  Timing
The second-order approximate solution:
174
Chapter6.nb

:u1@tD == e IEIT0 w1 A1 + E-I T0 w1 A
1M +
e2 i
k
jjjj
E-I T0 W-I t1 f1

8 w1
2
+
EI T0 W+I t1 f1

8 w1
2
+
E2 I T0 w1 A12 d1

w1
2
+
EI T0 w1+I T0 w2 A1 A2 d2


4 w1
2
+
E2 I T0 w2 A22 d3

15 w1
2
-
2 E-IT0 W-I t2+I T0 w1 A1 d2 L2


w12
+
2 EI T0 W+I t2+I T0 w1 A1 d2 L2


3 w12
-
E-I T0 W-I t2+IT0 w2 A2 d3 L2


2 w12
+
EI T0 W+I t2+I T0 w2 A2 d3 L2


4 w1
2
-
2 d3 L22

w1
2
+
E-2 IT0 W-2 I t2 d3 L22


3 w1
2
+
E2 I T0 W+2I t2 d3 L22

3 w1
2
-
I EIT0 w1 A1 m1

2 w1
-
6 A1 d1 A
1

w12
-
E-I T0 w1+I T0 w2 A2 d2 A
1


2 w12
+
2 E-IT0 W-I t2-I T0 w1 d2 L2 A
1


3 w12
-
2 EIT0 W+I t2-I T0 w1 d2 L2 A
1


w12
+
I E-I T0 w1 m1 A
1

2 w1
+
E-2 I T0 w1 d1 A
1
2

w12
-
EI T0 w1-I T0 w2 A1 d2 A
2


2 w12
-
2 A2 d3 A
2

w12
+
E-IT0 W-I t2-I T0 w2 d3 L2 A
2


4 w12
-
EI T0 W+I t2-I T0 w2 d3 L2 A
2


2 w12
+
E-I T0 w1-I T0 w2 d2 A
1 A
2


4 w12
+
E-2 I T0 w2 d3 A
2
2

15 w12
y
{
zzzz,
u2@tD == e IEIT0 w2 A2 + E-I T0 W-I t2 L2 + EI T0 W+It2 L2 + E-IT0 w2 A
2M +
e2 i
k
jjjj- E2 I T0 w1 A12 d2

16 w12
+ 2 EI T0 w1+I T0 w2 A1 A2 d3


5 w12
+ E2 IT0 w2 A22 d4

4 w12
-
E-IT0 W-I t2+I T0 w1 A1 d3 L2


2 w12
- EI T0 W+I t2+I T0 w1 A1 d3 L2


8 w12
- 2 E-I T0 W-I t2+I T0 w2 A2 d4 L2


w12
+
6 EIT0 W+I t2+I T0 w2 A2 d4 L2


5 w12
- 3 d4 L22

2 w12
- 3 E-2I T0 W-2 It2 d4 L22


16 w12
- 3 E2 I T0 W+2 I t2 d4 L22


16 w12
-
I EIT0 w2 A2 m2

4 w1
+
2 I E-I T0 W-I t2 L2 m2


3 w1
-
2 I EIT0 W+I t2 L2 m2


3 w1
-
A1 d2 A
1

2 w12
-
2 E-IT0 w1+I T0 w2 A2 d3 A
1


3 w1
2
- E-I T0 W-I t2-IT0 w1 d3 L2 A
1


8 w1
2
- EI T0 W+It2-I T0 w1 d3 L2 A
1


2 w1
2
-
E-2I T0 w1 d2 A
1
2

16 w12
- 2 EI T0 w1-IT0 w2 A1 d3 A
2


3 w12
- 3 A2 d4 A
2

2 w12
+ 6 E-I T0 W-I t2-I T0 w2 d4 L2 A
2


5 w12
-
2 EIT0 W+I t2-I T0 w2 d4 L2 A
2


w1
2
+ I E-I T0 w2 m2 A
2

4 w1
+ 2 E-I T0 w1-I T0 w2 d3 A
1 A
2


5 w1
2
+ E-2 I T0 w2 d4 A
2
2

4 w1
2
y
{
zzzz>
where
Li==
fi

2 Hwi2 - W2L
The modulation equations:
Chapter6.nb
175

:2 I w1 A1
¢ ==
2 I e w1
i
k
jjj-A1 m1 -
I EI T1 s2+I t1 f1

4 w1
+
I EI T1 s1-I T1 s2-I t2 A2 d3 L2


w1
+
I EI T1 s1 A2 d2 A
1

w1
y
{
zzz + 2 I e2 w1
i
k
jjj
I EIT1 s1-I T1 s2-I t1 A2 f1 d2


8 w13
-
5 I E-I T1 s2-I t2 A12 d1 d2 L2


w13
-
9 I E-I T1 s2-It2 A12 d2 d3 L2


16 w13
-
4 I A1 d22 L22

3 w13
-
6 I A1 d1 d3 L2
2

w13
-
5 I A1 d3
2 L2
2

8 w13
-
3 I A1 d2 d4 L2
2

2 w13
-
5 I EI T1 s2+I t2 d2 d3 L2
3


3 w13
-
27 I EI T1 s2+I t2 d3 d4 L2
3


16 w13
+
EI T1 s2+I t1 f1 m1

8 w12
-
EI T1 s1-I T1 s2-I t2 A2 d3 L2 m1


2 w12
-
5 EI T1 s1-I T1 s2-I t2 A2 d3 L2 m2


12 w12
+
3 I E-I T1 s2-I t2 A12 a2 L2


2 w1
+ 2 I A1 a3 L22

w1
+ 3 I EIT1 s2+I t2 a4 L23


2 w1
- I A1 m12

2 w1
- 15 I A12 d12 A
1

w13
-
9 I A1
2 d2
2 A
1

16 w13
-
10 I EI T1 s2+I t2 A1 d1 d2 L2 A
1


w13
-
9 I EI T1 s2+I t2 A1 d2 d3 L2 A
1


8 w13
-
2 I E2I T1 s2+2 I t2 d22 L22 A
1


w1
3
+
I E2 I T1 s2+2 I t2 d1 d3 L22 A
1


w1
3
-
I E2 IT1 s2+2 I t2 d32 L22 A
1


2 w1
3
-
3 I E2I T1 s2+2 I t2 d2 d4 L22 A
1


16 w13
- EI T1 s1 A2 d2 m1 A
1

w12
+ EI T1 s1 A2 d2 m2 A
1

4 w12
+
6 I A12 a1 A
1

w1
+
3 I EI T1 s2+I t2 A1 a2 L2 A
1


w1
+
I E2 I T1 s2+2 I t2 a3 L22 A
1


w1
-
I A1 A2 d22 A
2

4 w13
-
6 I A1 A2 d1 d3 A
2

w1
3
- 4 I A1 A2 d32 A
2

15 w1
3
- 3 I A1 A2 d2 d4 A
2

2 w1
3
- 9 I EIT1 s2+I t2 A2 d2 d3 L2 A
2


4 w1
3
-
23 I EI T1 s2+I t2 A2 d3 d4 L2 A
2


10 w13
+ 2 I A1 A2 a3 A
2

w1
+ 3 I EI T1 s2+I t2 A2 a4 L2 A
2


w1
y
{
zzz, 2 I w2 A2
¢ ==
2 I e i
k
jj-A2 m2 +
I E-I T1 s1 A12 d2

2 w2
+
I E-I T1 s1+I T1 s2+I t2 A1 d3 L2


w2
+
3 I E-IT1 s1+2 I T1 s2+2 I t2 d4 L22


2 w2
y
{
zz w2 +
2 I e2 w2
i
k
jjj-
E-I T1 s1 A1
2 d2 m2

16 w12
-
E-I T1 s1+I T1 s2+It2 A1 d3 L2 m2


8 w12
-
3 E-I T1 s1+2 I T1 s2+2 I t2 d4 L2
2 m2


16 w12
-
I A2 m22

4 w1
+ 3 I E-I T1 s2-I t2 A1 A2 a4 L2


w2
+ 12 I A2 a5 L22

w2
+ I E-I T1 s1+I T1 s2+I t1 A1 f1 d2


8 w12 w2
+
I E-IT1 s1+2 I T1 s2+I t1+I t2 f1 d3 L2


8 w12 w2
- 9 I E-I T1 s2-I t2 A1 A2 d2 d3 L2


4 w12 w2
-
23 I E-I T1 s2-I t2 A1 A2 d3 d4 L2


10 w12 w2
-
9 I A2 d32 L22

4 w12 w2
-
69 I A2 d42 L22

10 w12 w2
+
E-I T1 s1 A12 d2 m1

2 w1 w2
+
E-IT1 s1+I T1 s2+I t2 A1 d3 L2 m1


2 w1 w2
+
2 E-I T1 s1+I T1 s2+I t2 A1 d3 L2 m2


3 w1 w2
+
2 E-I T1 s1+2 I T1 s2+2 It2 d4 L22 m2


w1 w2
+
2 I A1 A2 a3 A
1

w2
+ 3 I EI T1 s2+I t2 A2 a4 L2 A
1


w2
- I A1 A2 d22 A
1

4 w12 w2
- 6 I A1 A2 d1 d3 A
1

w12 w2
-
4 I A1 A2 d32 A
1

15 w12 w2
-
3 I A1 A2 d2 d4 A
1

2 w12 w2
-
9 I EI T1 s2+I t2 A2 d2 d3 L2 A
1


4 w12 w2
-
23 I EI T1 s2+I t2 A2 d3 d4 L2 A
1


10 w12 w2
+
6 I A22 a5 A
2

w2
-
29 I A22 d32 A
2

15 w12 w2
-
15 I A22 d42 A
2

4 w12 w2
y
{
zzz>
860.36 Second, Null<
176
Chapter6.nb

 6.1.4 W » w1 + w2 and w2 » 2 w1
In this case, we have a combination resonance and a two-to-one internal resonance. We let
scaling4 = 8m‘
n_ -> e mn, F1 -> e f1, F2 -> e f2<;
ResonanceCond4 = 8w2 == 2 w1 + e s1, W == w1 + w2 + e s2<;
Using  MMS,  we  obtain  the  second-order approximate  solution  and  the  two  equations  governing  the  modulation  of the
complex-valued functions Ak:
MMS@scaling4, ResonanceCond4D  Timing
The second-order approximate solution:
:u1@tD == e IEIT0 w1 A1 + E-I T0 W-I t1 L1 + EI T0 W+It1 L1 + E-IT0 w1 A
1M +
e2 i
k
jjjj
E2 I T0 w1 A12 d1

w12
+
EI T0 w1+I T0 w2 A12 d2

4 w12
+
E2I T0 w2 A12 d3

15 w12
+
2 E-IT0 W-I t1+I T0 w1 A1 d1 L1


w12
+
2 EIT0 W+I t1+I T0 w1 A1 d1 L1


5 w12
-
E-I T0 W-I t1+I T0 w2 A1 d2 L1


2 w12
+
EI T0 W+I t1+I T0 w2 A1 d2 L1


12 w12
-
6 d1 L12

w1
2
+
3 E-2 I T0 W-2 I t1 d1 L12


35 w1
2
+
3 E2 I T0 W+2 I t1 d1 L12


35 w1
2
+
2 E-I T0 W-I t2+I T0 w1 A1 d2 L2


3 w1
2
+
2 EIT0 W+I t2+I T0 w1 A1 d2 L2


15 w1
2
- E-I T0 W-I t2+I T0 w2 A1 d3 L2


2 w1
2
+ EI T0 W+I t2+I T0 w2 A1 d3 L2


12 w1
2
+
2 E-2I T0 W-I t1-I t2 d2 L1 L2


35 w12
- 2 EI t1-It2 d2 L1 L2

w12
- 2 E-I t1+I t2 d2 L1 L2


w12
+
2 E2I T0 W+I t1+I t2 d2 L1 L2


35 w12
- 2 d3 L22

w12
+ E-2 I T0 W-2 I t2 d3 L22


35 w12
+ E2 I T0 W+2 I t2 d3 L22

35 w12
- I EIT0 w1 A1 m1

2 w1
-
3 I E-I T0 W-I t1 L1 m1


4 w1
+
3 I EI T0 W+It1 L1 m1


4 w1
-
6 A1 d1 A
1

w12
-
EIT0 w1-I T0 w2 A1 d2 A
1


2 w12
-
E-IT0 w1+I T0 w2 A1 d2 A
1


2 w12
- 2 A1 d3 A
1

w12
+ 2 E-I T0 W-It1-I T0 w1 d1 L1 A
1


5 w12
+ 2 EIT0 W+I t1-I T0 w1 d1 L1 A
1


w12
+
E-IT0 W-I t1-I T0 w2 d2 L1 A
1


12 w12
-
EI T0 W+I t1-I T0 w2 d2 L1 A
1


2 w12
+
2 E-I T0 W-I t2-I T0 w1 d2 L2 A
1


15 w12
+
2 EIT0 W+I t2-I T0 w1 d2 L2 A
1


3 w12
+
E-I T0 W-I t2-I T0 w2 d3 L2 A
1


12 w12
-
EI T0 W+I t2-I T0 w2 d3 L2 A
1


2 w12
+
I E-IT0 w1 m1 A
1

2 w1
+
E-2 I T0 w1 d1 A
1
2

w12
+
E-I T0 w1-I T0 w2 d2 A
1
2


4 w12
+
E-2 I T0 w2 d3 A
1
2

15 w12
y
{
zzzz,
u2@tD == e IEIT0 w2 A2 + E-I T0 W-I t2 L2 + EI T0 W+It2 L2 + E-IT0 w2 A
2M +
e2 i
k
jjjj- E2 I T0 w1 A22 d2

16 w12
+ 2 EI T0 w1+I T0 w2 A22 d3


5 w12
+ E2 I T0 w2 A22 d4

4 w12
- E-I T0 W-I t1+I T0 w1 A2 d2 L1


8 w12
+
EI T0 W+I t1+I T0 w1 A2 d2 L1


6 w12
- 2 E-I T0 W-I t1+I T0 w2 A2 d3 L1


3 w12
+ 2 EI T0 W+I t1+I T0 w2 A2 d3 L1


21 w12
-
d2 L12

2 w12
+
E-2 I T0 W-2I t1 d2 L12


32 w12
+
E2 I T0 W+2 I t1 d2 L12

32 w12
-
E-I T0 W-I t2+I T0 w1 A2 d3 L2


8 w12
+
Chapter6.nb
177

EI T0 W+I t2+I T0 w1 A2 d3 L2


6 w12
-
2 E-I T0 W-I t2+I T0 w2 A2 d4 L2


w12
+
2 EI T0 W+I t2+I T0 w2 A2 d4 L2


7 w12
+
E-2I T0 W-I t1-I t2 d3 L1 L2


16 w12
-
EI t1-I t2 d3 L1 L2

2 w12
-
E-I t1+I t2 d3 L1 L2

2 w12
+
E2I T0 W+I t1+I t2 d3 L1 L2


16 w12
-
3 d4 L22

2 w12
+
3 E-2 I T0 W-2 I t2 d4 L22


32 w12
+
3 E2 I T0 W+2 I t2 d4 L22


32 w12
-
I EI T0 w2 A2 m2

4 w1
-
6 I E-I T0 W-I t2 L2 m2


5 w1
+ 6 I EI T0 W+It2 L2 m2


5 w1
- A2 d2 A
2

2 w12
- 2 EIT0 w1-I T0 w2 A2 d3 A
2


3 w12
-
2 E-IT0 w1+I T0 w2 A2 d3 A
2


3 w12
-
3 A2 d4 A
2

2 w12
+
E-I T0 W-It1-I T0 w1 d2 L1 A
2


6 w12
-
EI T0 W+I t1-I T0 w1 d2 L1 A
2


8 w12
+
2 E-IT0 W-I t1-I T0 w2 d3 L1 A
2


21 w12
- 2 EI T0 W+I t1-I T0 w2 d3 L1 A
2


3 w12
+ E-I T0 W-I t2-IT0 w1 d3 L2 A
2


6 w12
-
EI T0 W+I t2-I T0 w1 d3 L2 A
2


8 w12
+
2 E-I T0 W-I t2-I T0 w2 d4 L2 A
2


7 w12
-
2 EI T0 W+I t2-I T0 w2 d4 L2 A
2


w12
+
I E-IT0 w2 m2 A
2

4 w1
- E-2 I T0 w1 d2 A
2
2

16 w12
+ 2 E-I T0 w1-IT0 w2 d3 A
2
2


5 w12
+ E-2 I T0 w2 d4 A
2
2

4 w12
y
{
zzzz>
where
Li==
fi

2 Hwi
2 - W2L
The modulation equations:
:2 I w1 A1¢ ==
2 I e2 w1
i
k
jjjj- I EI T1 s1-I T1 s2-I t1 A22 d22 L1


2 w13
+ I EI T1 s1-I T1 s2-I t1 A22 d1 d3 L1


5 w13
- 2 I EI T1 s1-I T1 s2-I t1 A22 d32 L1


3 w13
+
I EIT1 s1-I T1 s2-I t1 A22 d2 d4 L1


4 w13
- 54 I A1 d12 L12

5 w13
- 11 I A1 d22 L12

24 w13
- 13 I EI T1 s1-I T1 s2-I t2 A22 d2 d3 L2


30 w13
-
7 I EIT1 s1-I T1 s2-I t2 A22 d3 d4 L2


4 w13
-
18 I EI t1-I t2 A1 d1 d2 L1 L2


5 w13
-
18 I E-I t1+It2 A1 d1 d2 L1 L2


5 w13
-
11 I EI t1-I t2 A1 d2 d3 L1 L2


24 w13
-
11 I E-I t1+I t2 A1 d2 d3 L1 L2


24 w13
+
4 I A1 d2
2 L2
2

5 w13
-
6 I A1 d1 d3 L2
2

w13
+
I A1 d3
2 L2
2

24 w13
-
3 I A1 d2 d4 L2
2

2 w13
+
I EIT1 s1-I T1 s2-I t1 A2
2 a3 L1


w1
+
12 I A1 a1 L1
2

w1
+
3 I EIT1 s1-I T1 s2-I t2 A22 a4 L2


2 w1
+
3 I EI t1-I t2 A1 a2 L1 L2


w1
+
3 I E-I t1+It2 A1 a2 L1 L2


w1
+
2 I A1 a3 L22

w1
-
I A1 m12

2 w1
-
15 I A12 d12 A
1

w13
-
9 I A12 d22 A
1

16 w13
-
EI T1 s1 A2 d2 m1 A
1

w12
+
EI T1 s1 A2 d2 m2 A
1

4 w12
+
6 I A12 a1 A
1

w1
+
9 I EIT1 s1+I T1 s2+I t1 d12 L1 A
1
2


w13
-
3 I EI T1 s1+I T1 s2+I t1 d22 L1 A
1
2


16 w13
+
3 I EI T1 s1+I T1 s2+I t2 d1 d2 L2 A
1
2


w13
-
3 I EIT1 s1+I T1 s2+I t2 d2 d3 L2 A
1
2


16 w13
+
6 I EI T1 s1+I T1 s2+I t1 a1 L1 A
1
2


w1
+
3 I EIT1 s1+I T1 s2+I t2 a2 L2 A
1
2


2 w1
-
I A1 A2 d22 A
2

4 w13
-
6 I A1 A2 d1 d3 A
2

w13
-
4 I A1 A2 d32 A
2

15 w13
-
3 I A1 A2 d2 d4 A
2

2 w13
-
5 EI T1 s2+I t1 d2 L1 m1 A
2


4 w12
-
178
Chapter6.nb

EI T1 s2+I t2 d3 L2 m1 A
2


2 w12
-
EI T1 s2+I t1 d2 L1 m2 A
2


4 w12
-
29 EI T1 s2+I t2 d3 L2 m2 A
2


20 w12
+
2 I A1 A2 a3 A
2

w1
y
{
zzzz +
2 I e w1
i
k
jjj-A1 m1 +
I EI T1 s1 A2 d2 A
1

w1
+
I EI T1 s2+I t1 d2 L1 A
2


w1
+
I EI T1 s2+I t2 d3 L2 A
2


w1
y
{
zzz,
2 I w2 A2¢ == 2 I e w2
i
k
jjj-A2 m2 +
I E-I T1 s1 A1
2 d2

2 w2
+
I EI T1 s2+I t1 d2 L1 A
1


w2
+
I EI T1 s2+I t2 d3 L2 A
1


w2
y
{
zzz +
2 I e2 w2
i
k
jjj-
E-I T1 s1 A12 d2 m2

16 w12
-
I A2 m22

4 w1
+
2 I A2 a3 L12

w2
+
3 I EI t1-I t2 A2 a4 L1 L2


w2
+
3 I E-I t1+I t2 A2 a4 L1 L2


w2
+ 12 I A2 a5 L22

w2
- 5 I A2 d22 L12

12 w12 w2
- 6 I A2 d1 d3 L12

w12 w2
- 4 I A2 d32 L12

7 w12 w2
-
3 I A2 d2 d4 L12

2 w12 w2
-
29 I EI t1-I t2 A2 d2 d3 L1 L2


12 w12 w2
-
29 I E-It1+I t2 A2 d2 d3 L1 L2


12 w12 w2
-
45 I EI t1-I t2 A2 d3 d4 L1 L2


14 w12 w2
-
45 I E-I t1+I t2 A2 d3 d4 L1 L2


14 w12 w2
-
29 I A2 d3
2 L2
2

12 w12 w2
-
135 I A2 d42 L22

14 w1
2 w2
+ E-I T1 s1 A12 d2 m1

2 w1 w2
- EIT1 s2+I t1 d2 L1 m2 A
1


8 w1
2
- EI T1 s2+I t2 d3 L2 m2 A
1


8 w1
2
+
2 I A1 A2 a3 A
1

w2
-
I A1 A2 d22 A
1

4 w12 w2
-
6 I A1 A2 d1 d3 A
1

w12 w2
-
4 I A1 A2 d32 A
1

15 w12 w2
-
3 I A1 A2 d2 d4 A
1

2 w12 w2
-
5 EIT1 s2+I t1 d2 L1 m1 A
1


4 w1 w2
- EI T1 s2+I t2 d3 L2 m1 A
1


2 w1 w2
- 6 EI T1 s2+It2 d3 L2 m2 A
1


5 w1 w2
+ 6 I A22 a5 A
2

w2
+
2 I E-I T1 s1+I T1 s2+I t1 A1 a3 L1 A
2


w2
+ 3 I E-I T1 s1+I T1 s2+I t2 A1 a4 L2 A
2


w2
- 29 I A22 d32 A
2

15 w12 w2
-
15 I A22 d42 A
2

4 w12 w2
-
I E-I T1 s1+I T1 s2+I t1 A1 d22 L1 A
2


w12 w2
+
2 I E-I T1 s1+I T1 s2+I t1 A1 d1 d3 L1 A
2



5 w12 w2
-
4 I E-I T1 s1+I T1 s2+I t1 A1 d32 L1 A
2


3 w12 w2
+ I E-I T1 s1+IT1 s2+I t1 A1 d2 d4 L1 A
2


2 w12 w2
-
13 I E-I T1 s1+I T1 s2+I t2 A1 d2 d3 L2 A
2



15 w12 w2
- 7 I E-I T1 s1+I T1 s2+I t2 A1 d3 d4 L2 A
2



2 w12 w2
y
{
zzz>
8192.266 Second, Null<
 6.1.5 W » w2 and w2 » 3 w1
In this  case, we have a primary resonance of the second mode, a subharmonic resonance of the first mode, and a three-to-one
internal resonance. We let
scaling5 = 9m‘
n_ -> e2 mn, F1 -> e f1, F2 -> e3 f2=;
ResonanceCond5 = 9w2 == 3 w1 + e2 s1, W == w2 + e2 s2=;
Using  MMS,  we  obtain  the  second-order approximate  solution  and  the  two  equations  governing  the  modulation  of the
complex-valued functions Ak:
MMS@scaling5, ResonanceCond5D  Timing
The second-order approximate solution:
Chapter6.nb
179

:u1@tD == e IEIT0 w1 A1 + E-I T0 W-I t1 L1 + EI T0 W+It1 L1 + E-IT0 w1 A
1M +
e2 i
k
jjjj
E2 I T0 w1 A12 d1

w1
2
+
2 EI T0 w1+I T0 w2 A1 A2 d2


15 w1
2
+
E2 I T0 w2 A22 d3

35 w1
2
+
2 E-I T0 W-I t1+IT0 w1 A1 d1 L1


w1
2
+
2 EIT0 W+I t1+I T0 w1 A1 d1 L1


5 w12
-
2 E-I T0 W-I t1+I T0 w2 A2 d2 L1


w12
+
2 EI T0 W+I t1+IT0 w2 A2 d2 L1


35 w12
-
6 d1 L12

w12
+
3 E-2 I T0 W-2 I t1 d1 L12


35 w12
+
3 E2 I T0 W+2 I t1 d1 L12


35 w12
-
6 A1 d1 A
1

w12
+
2 E-IT0 w1+I T0 w2 A2 d2 A
1


3 w12
+
2 E-I T0 W-I t1-IT0 w1 d1 L1 A
1


5 w12
+
2 EI T0 W+I t1-I T0 w1 d1 L1 A
1


w12
+
E-2I T0 w1 d1 A
1
2

w1
2
+ 2 EI T0 w1-IT0 w2 A1 d2 A
2


3 w1
2
- 2 A2 d3 A
2

w1
2
+ 2 E-I T0 W-I t1-I T0 w2 d2 L1 A
2


35 w1
2
-
2 EIT0 W+I t1-I T0 w2 d2 L1 A
2


w12
+
2 E-I T0 w1-IT0 w2 d2 A
1 A
2


15 w12
+
E-2 I T0 w2 d3 A
2
2

35 w12
y
{
zzzz,
u2@tD == e IEIT0 w2 A2 + E-I T0 w2 A
2M + e2 i
k
jjjj- E2 I T0 w1 A12 d2

5 w1
2
+ 2 EIT0 w1+I T0 w2 A1 A2 d3


7 w1
2
+ E2 I T0 w2 A22 d4

9 w1
2
-
2 E-IT0 W-I t1+I T0 w1 A1 d2 L1


5 w1
2
+
2 EI T0 W+I t1+I T0 w1 A1 d2 L1


7 w1
2
-
2 E-I T0 W-I t1+IT0 w2 A2 d3 L1


9 w1
2
+
2 EIT0 W+I t1+I T0 w2 A2 d3 L1


27 w12
-
2 d2 L1
2

9 w12
+
E-2I T0 W-2 It1 d2 L1
2


27 w12
+
E2 I T0 W+2I t1 d2 L1
2

27 w12
-
2 A1 d2 A
1

9 w12
-
2 E-IT0 w1+I T0 w2 A2 d3 A
1


5 w12
+
2 E-I T0 W-I t1-IT0 w1 d2 L1 A
1


7 w12
-
2 EI T0 W+I t1-I T0 w1 d2 L1 A
1


5 w12
-
E-2I T0 w1 d2 A
1
2

5 w12
- 2 EI T0 w1-IT0 w2 A1 d3 A
2


5 w12
- 2 A2 d4 A
2

3 w12
+ 2 E-I T0 W-I t1-I T0 w2 d3 L1 A
2


27 w12
-
2 EIT0 W+I t1-I T0 w2 d3 L1 A
2


9 w12
+
2 E-I T0 w1-IT0 w2 d3 A
1 A
2


7 w12
+
E-2 I T0 w2 d4 A
2
2

9 w12
y
{
zzzz>
where
Li==
fi

2 Hwi2 - W2L
The modulation equations:
180
Chapter6.nb

:2 I w1 A1
¢ ==
2 I e2 w1
i
k
jjjj-A1 m1 -
18 I E-I T2 s2-I t1 A1 A2 d1 d2 L1


5 w1
3
-
106 I E-IT2 s2-I t1 A1 A2 d2 d3 L1


315 w1
3
-
54 I A1 d12 L12

5 w1
3
-
106 I A1 d22 L12

315 w13
+ 3 I E-IT2 s2-I t1 A1 A2 a2 L1


w1
+ 12 I A1 a1 L12

w1
- 15 I A12 d12 A
1

w13
- 19 I A12 d22 A
1

45 w13
+
6 I A1
2 a1 A
1

w1
+
3 I EI T2 s1 A2 d1 d2 A
1
2


w13
-
3 I EI T2 s1 A2 d2 d3 A
1
2


5 w13
+
9 I EI T2 s1+I T2 s2+I t1 d1
2 L1 A
1
2


w13
-
3 I EIT2 s1+I T2 s2+I t1 d2
2 L1 A
1
2


5 w13
+
3 I EI T2 s1 A2 a2 A
1
2

2 w1
+
6 I EI T2 s1+I T2 s2+It1 a1 L1 A
1
2


w1
+
4 I A1 A2 d2
2 A
2

5 w13
-
6 I A1 A2 d1 d3 A
2

w13
-
4 I A1 A2 d32 A
2

35 w13
-
2 I A1 A2 d2 d4 A
2

3 w13
-
18 I EIT2 s2+I t1 A1 d1 d2 L1 A
2


5 w13
-
106 I EI T2 s2+I t1 A1 d2 d3 L1 A
2


315 w1
3
+
2 I A1 A2 a3 A
2

w1
+
3 I EI T2 s2+I t1 A1 a2 L1 A
2


w1
y
{
zzzz,
2 I w2 A2¢ == 2 I e2 w2
i
k
jjj-A2 m2 -
I EI T2 s2+It2 f2

4 w2
+
I E-I T2 s1 A1
3 a2

2 w2
+
3 I E-I T2 s2-I t1 A2
2 a4 L1


2 w2
+
2 I A2 a3 L12

w2
+ 3 I EI T2 s2+It1 a2 L13


2 w2
+ I E-I T2 s1 A13 d1 d2

w12 w2
- I E-I T2 s1 A13 d2 d3

5 w12 w2
-
69 I E-I T2 s2-I t1 A22 d2 d3 L1


35 w12 w2
- 5 I E-I T2 s2-I t1 A22 d3 d4 L1


9 w12 w2
- 68 I A2 d22 L12

35 w12 w2
- 6 I A2 d1 d3 L12

w12 w2
-
4 I A2 d32 L12

27 w12 w2
-
2 I A2 d2 d4 L12

3 w12 w2
-
207 I EI T2 s2+I t1 d1 d2 L13


35 w12 w2
-
5 I EI T2 s2+I t1 d2 d3 L13


27 w12 w2
+
2 I A1 A2 a3 A
1

w2
+
3 I EI T2 s2+I t1 A1 a2 L1 A
1


w2
+
4 I A1 A2 d22 A
1

5 w1
2 w2
-
6 I A1 A2 d1 d3 A
1

w1
2 w2
-
4 I A1 A2 d32 A
1

35 w1
2 w2
-
2 I A1 A2 d2 d4 A
1

3 w12 w2
- 18 I EI T2 s2+It1 A1 d1 d2 L1 A
1


5 w12 w2
- 106 I EI T2 s2+I t1 A1 d2 d3 L1 A
1


315 w12 w2
+
6 I A22 a5 A
2

w2
+
3 I EI T2 s2+It1 A2 a4 L1 A
2


w2
+
I E2 I T2 s2+2 I t1 a3 L12 A
2


w2
-
69 I A22 d32 A
2

35 w12 w2
-
5 I A22 d42 A
2

3 w12 w2
-
138 I EI T2 s2+I t1 A2 d2 d3 L1 A
2


35 w1
2 w2
- 10 I EI T2 s2+I t1 A2 d3 d4 L1 A
2


9 w1
2 w2
- 2 I E2 I T2 s2+2 I t1 d22 L12 A
2


w1
2 w2
+
3 I E2I T2 s2+2 I t1 d1 d3 L12 A
2


35 w12 w2
- 2 I E2 I T2 s2+2I t1 d32 L12 A
2


9 w12 w2
+ I E2 IT2 s2+2 I t1 d2 d4 L12 A
2


9 w12 w2
y
{
zzz>
866.906 Second, Null<
 6.1.6 W » w2 - 2 w1 and w2 » 3 w1
In this case, we have a primary resonance of the first mode, a superharmonic  resonance of the second mode, and a three-to-
one internal resonance. We let
scaling6 = 9m‘
n_ -> e2 mn, F1 -> e3 f1, F2 -> e f2=;
ResonanceCond6 = 9w2 == 3 w1 + e2 s1, W == w2 - 2 w1 + e2 s2=;
Chapter6.nb
181

Using  MMS,  we  obtain  the  second-order approximate  solution  and  the  two  equations  governing  the  modulation  of the
complex-valued functions Ak:
MMS@scaling6, ResonanceCond6D  Timing
The second-order approximate solution:
:u1@tD == e IEIT0 w1 A1 + E-I T0 w1 A
1M +
e2 i
k
jjjj
E2 I T0 w1 A12 d1

w12
+
2 EI T0 w1+I T0 w2 A12 d2


15 w12
+
E2 I T0 w2 A12 d3

35 w12
-
2 E-I T0 W-I t2+I T0 w1 A1 d2 L2


w12
+
2 EIT0 W+I t2+I T0 w1 A1 d2 L2


3 w12
+
2 E-I T0 W-I t2+I T0 w2 A1 d3 L2


3 w12
+
2 EI T0 W+I t2+IT0 w2 A1 d3 L2


15 w12
-
2 d3 L22

w12
+ E-2 I T0 W-2 I t2 d3 L22


3 w12
+ E2 I T0 W+2 I t2 d3 L22

3 w12
- 6 A1 d1 A
1

w12
+
2 EIT0 w1-I T0 w2 A1 d2 A
1


3 w12
+
2 E-I T0 w1+I T0 w2 A1 d2 A
1


3 w12
-
2 A1 d3 A
1

w12
+
2 E-IT0 W-I t2-I T0 w1 d2 L2 A
1


3 w1
2
-
2 EI T0 W+I t2-I T0 w1 d2 L2 A
1


w1
2
+
2 E-I T0 W-I t2-IT0 w2 d3 L2 A
1


15 w1
2
+
2 EIT0 W+I t2-I T0 w2 d3 L2 A
1


3 w12
+
E-2 I T0 w1 d1 A
1
2

w12
+
2 E-I T0 w1-I T0 w2 d2 A
1
2


15 w12
+
E-2 I T0 w2 d3 A
1
2

35 w12
y
{
zzzz,
u2@tD == e IEIT0 w2 A2 + E-I T0 W-I t2 L2 + EI T0 W+It2 L2 + E-IT0 w2 A
2M +
e2 i
k
jjjj-
E2 I T0 w1 A2
2 d2

5 w12
+
2 EI T0 w1+I T0 w2 A2
2 d3


7 w12
+
E2 I T0 w2 A2
2 d4

9 w12
-
2 E-IT0 W-I t2+I T0 w1 A2 d3 L2


9 w12
-
2 EI T0 W+I t2+I T0 w1 A2 d3 L2


5 w12
-
6 E-I T0 W-I t2+IT0 w2 A2 d4 L2


5 w12
+
6 EIT0 W+I t2+I T0 w2 A2 d4 L2


7 w12
-
2 d4 L2
2

3 w12
-
3 E-2I T0 W-2 It2 d4 L2
2


5 w12
-
3 E2 I T0 W+2 I t2 d4 L2
2


5 w12
-
2 A2 d2 A
2

9 w1
2
- 2 EI T0 w1-I T0 w2 A2 d3 A
2


5 w1
2
- 2 E-I T0 w1+I T0 w2 A2 d3 A
2


5 w1
2
- 2 A2 d4 A
2

3 w1
2
-
2 E-IT0 W-I t2-I T0 w1 d3 L2 A
2


5 w12
-
2 EI T0 W+I t2-I T0 w1 d3 L2 A
2


9 w12
+
6 E-I T0 W-I t2-IT0 w2 d4 L2 A
2


7 w12
-
6 EIT0 W+I t2-I T0 w2 d4 L2 A
2


5 w12
- E-2 I T0 w1 d2 A
2
2

5 w12
+ 2 E-I T0 w1-I T0 w2 d3 A
2
2


7 w12
+ E-2 I T0 w2 d4 A
2
2

9 w12
y
{
zzzz>
where
Li==
fi

2 Hwi
2 - W2L
The modulation equations:
:2 I w1 A1¢ ==
2 I e2 w1
i
k
jjjj-A1 m1 - 5 I E-I T2 s1-I T2 s2-I t2 A12 d1 d2 L2


w13
- 19 I E-I T2 s1-I T2 s2-It2 A12 d2 d3 L2


45 w13
- 4 I A1 d22 L22

3 w13
-
6 I A1 d1 d3 L22

w13
+ I E-I T2 s1-2 I T2 s2-2 I t2 A2 d2 d3 L22


w13
- 28 I A1 d32 L22

45 w13
-
182
Chapter6.nb

2 I A1 d2 d4 L22

3 w13
-
9 I E-I T2 s1-2 I T2 s2-2 It2 A2 d3 d4 L22



5 w13
-
5 I EI T2 s1+I T2 s2+I t2 d2 d3 L23


3 w13
-
19 I EIT2 s1+I T2 s2+I t2 d3 d4 L23


15 w13
-
I EI T2 s1+I T2 s2+I t1 f1


4 w1
+
3 I E-I T2 s1-I T2 s2-I t2 A12 a2 L2


2 w1
+
2 I A1 a3 L22

w1
+ 3 I E-I T2 s1-2 I T2 s2-2 I t2 A2 a4 L22


2 w1
+ 3 I EI T2 s1+I T2 s2+I t2 a4 L23


2 w1
- 15 I A12 d12 A
1

w13
-
19 I A12 d22 A
1

45 w13
-
10 I EI T2 s1+I T2 s2+I t2 A1 d1 d2 L2 A
1



w13
+
4 I E-I T2 s2-I t2 A2 d22 L2 A
1


3 w13
+
2 I E-I T2 s2-I t2 A2 d1 d3 L2 A
1


w1
3
- 38 I EI T2 s1+I T2 s2+I t2 A1 d2 d3 L2 A
1



45 w1
3
- 4 I E-I T2 s2-I t2 A2 d32 L2 A
1


5 w1
3
-
6 I E-I T2 s2-I t2 A2 d2 d4 L2 A
1


5 w13
- 2 I E2 I T2 s1+2 I T2 s2+2 I t2 d22 L22 A
1


w13
+ I E2 I T2 s1+2 IT2 s2+2 I t2 d1 d3 L22 A
1


w13
-
2 I E2I T2 s1+2 I T2 s2+2 I t2 d32 L22 A
1


9 w13
-
3 I E2 I T2 s1+2 IT2 s2+2 I t2 d2 d4 L22 A
1



5 w13
+
6 I A12 a1 A
1

w1
+
3 I EIT2 s1+I T2 s2+I t2 A1 a2 L2 A
1


w1
+ 2 I E-I T2 s2-It2 A2 a3 L2 A
1


w1
+ I E2 I T2 s1+2 I T2 s2+2 It2 a3 L22 A
1


w1
+
3 I EIT2 s1 A2 d1 d2 A
1
2


w13
-
3 I EI T2 s1 A2 d2 d3 A
1
2


5 w13
+
3 I EI T2 s1 A2 a2 A
1
2

2 w1
+
4 I A1 A2 d2
2 A
2

5 w13
-
6 I A1 A2 d1 d3 A
2

w13
-
4 I A1 A2 d32 A
2

35 w13
-
2 I A1 A2 d2 d4 A
2

3 w13
-
6 I EIT2 s1+I T2 s2+I t2 A2 d2 d3 L2 A
2



5 w13
-
106 I EI T2 s1+I T2 s2+I t2 A2 d3 d4 L2 A
2



105 w1
3
+
2 I A1 A2 a3 A
2

w1
+
3 I EI T2 s1+I T2 s2+It2 A2 a4 L2 A
2


w1
y
{
zzzz,
2 I w2 A2¢ == 2 I e2 w2
i
k
jjj-A2 m2 +
I E-I T2 s1 A1
3 a2

2 w2
+
I EI T2 s2+I t2 A1
2 a3 L2


w2
+
3 I E-I T2 s1-I T2 s2-I t2 A1 A2 a4 L2


w2
+
3 I EIT2 s1+2 I T2 s2+2 I t2 A1 a4 L2
2


2 w2
+
12 I A2 a5 L2
2

w2
+
2 I E2 I T2 s1+3 I T2 s2+3 It2 a5 L2
3


w2
+
I E-IT2 s1 A1
3 d1 d2

w12 w2
-
I E-I T2 s1 A1
3 d2 d3

5 w12 w2
+
2 I EI T2 s2+I t2 A1
2 d2
2 L2


3 w12 w2
+
I EI T2 s2+I t2 A1
2 d1 d3 L2


w12 w2
-
6 I E-I T2 s1-I T2 s2-I t2 A1 A2 d2 d3 L2



5 w12 w2
-
2 I EI T2 s2+I t2 A12 d32 L2


5 w12 w2
-
3 I EI T2 s2+I t2 A12 d2 d4 L2


5 w12 w2
-
106 I E-I T2 s1-I T2 s2-I t2 A1 A2 d3 d4 L2



105 w12 w2
+
I EI T2 s1+2 I T2 s2+2 I t2 A1 d2 d3 L22


w12 w2
-
6 I A2 d32 L22

5 w12 w2
-
9 I EIT2 s1+2 I T2 s2+2 I t2 A1 d3 d4 L22


5 w12 w2
-
106 I A2 d42 L22

35 w12 w2
+
I E2 I T2 s1+3I T2 s2+3 I t2 d32 L23


3 w12 w2
-
9 I E2I T2 s1+3 I T2 s2+3 I t2 d42 L23


5 w12 w2
+ 2 I A1 A2 a3 A
1

w2
+ 3 I EI T2 s1+I T2 s2+I t2 A2 a4 L2 A
1


w2
+ 4 I A1 A2 d22 A
1

5 w12 w2
-
6 I A1 A2 d1 d3 A
1

w12 w2
-
4 I A1 A2 d32 A
1

35 w12 w2
-
2 I A1 A2 d2 d4 A
1

3 w12 w2
-
6 I EIT2 s1+I T2 s2+I t2 A2 d2 d3 L2 A
1



5 w12 w2
-
106 I EI T2 s1+I T2 s2+I t2 A2 d3 d4 L2 A
1



105 w12 w2
+
6 I A22 a5 A
2

w2
-
69 I A22 d32 A
2

35 w12 w2
-
5 I A22 d42 A
2

3 w12 w2
y
{
zzz>
872.154 Second, Null<
Chapter6.nb
183

 6.1.7 W » w1 + w2 and w2 » w1
In this case, we have a subharmonic resonance of either mode and a one-to-one internal resonance. We let
scaling7 = 8m‘
n_ -> e mn, F1 -> e f1, F2 -> e f2<;
ResonanceCond7 = 8w2 == w1 + e s1, W == w1 + w2 + e s2<;
Using  MMS,  we  obtain  the  second-order approximate  solution  and  the  two  equations  governing  the  modulation  of the
complex-valued functions Ak:
MMS@scaling7, ResonanceCond7D  Timing
The second-order approximate solution:
:u1@tD == e IEIT0 w1 A1 + E-I T0 W-I t1 L1 + EI T0 W+It1 L1 + E-IT0 w1 A
1M +
e2 i
k
jjjj
E2 I T0 w1 A12 d1

w12
+
2 EI T0 w1+I T0 w2 A12 d2


3 w12
+
E2 I T0 w2 A12 d3

3 w12
-
3 E-I T0 W-I t1+I T0 w1 A1 d1 L1


2 w12
+
3 EIT0 W+I t1+I T0 w1 A1 d1 L1


4 w12
-
E-I T0 W-I t1+I T0 w2 A1 d2 L1


2 w12
+
EI T0 W+I t1+I T0 w2 A1 d2 L1


4 w12
-
6 d1 L12

w12
+
E-2I T0 W-2 It1 d1 L12


5 w1
2
+
E2 I T0 W+2 I t1 d1 L12

5 w1
2
-
E-I T0 W-I t2+I T0 w1 A1 d2 L2


2 w1
2
+
EI T0 W+I t2+I T0 w1 A1 d2 L2


4 w1
2
-
E-IT0 W-I t2+I T0 w2 A1 d3 L2


2 w1
2
+ EI T0 W+I t2+I T0 w2 A1 d3 L2


4 w1
2
+ 2 E-2 I T0 W-I t1-It2 d2 L1 L2


15 w1
2
-
2 EIt1-I t2 d2 L1 L2

w12
- 2 E-I t1+I t2 d2 L1 L2


w12
+ 2 E2 IT0 W+I t1+I t2 d2 L1 L2


15 w12
- 2 d3 L22

w12
+
E-2I T0 W-2 It2 d3 L22


15 w12
+ E2 I T0 W+2 I t2 d3 L22

15 w12
- I EI T0 w1 A1 m1

2 w1
- 4 I E-I T0 W-I t1 L1 m1


3 w1
+
4 I EIT0 W+I t1 L1 m1


3 w1
-
6 A1 d1 A
1

w12
-
2 EI T0 w1-IT0 w2 A1 d2 A
1


w12
-
2 E-I T0 w1+I T0 w2 A1 d2 A
1


w12
-
2 A1 d3 A
1

w12
+ 3 E-I T0 W-I t1-I T0 w1 d1 L1 A
1


4 w12
- 3 EI T0 W+I t1-IT0 w1 d1 L1 A
1


2 w12
+
E-IT0 W-I t1-I T0 w2 d2 L1 A
1


4 w12
-
EI T0 W+I t1-I T0 w2 d2 L1 A
1


2 w12
+
E-I T0 W-I t2-I T0 w1 d2 L2 A
1


4 w12
-
EI T0 W+I t2-I T0 w1 d2 L2 A
1


2 w12
+
E-I T0 W-I t2-I T0 w2 d3 L2 A
1


4 w12
-
EI T0 W+I t2-I T0 w2 d3 L2 A
1


2 w12
+
I E-IT0 w1 m1 A
1

2 w1
+
E-2 I T0 w1 d1 A
1
2

w12
+
2 E-I T0 w1-IT0 w2 d2 A
1
2


3 w12
+
E-2 I T0 w2 d3 A
1
2

3 w12
y
{
zzzz,
u2@tD == e IEIT0 w2 A2 + E-I T0 W-I t2 L2 + EI T0 W+It2 L2 + E-IT0 w2 A
2M +
e2 i
k
jjjj
E2 I T0 w1 A22 d2

3 w12
+ 2 EI T0 w1+I T0 w2 A22 d3


3 w12
+ E2 I T0 w2 A22 d4

w12
- E-IT0 W-I t1+I T0 w1 A2 d2 L1


2 w12
+
EI T0 W+I t1+I T0 w1 A2 d2 L1


4 w12
- E-I T0 W-I t1+I T0 w2 A2 d3 L1


2 w12
+ EI T0 W+I t1+I T0 w2 A2 d3 L1


4 w12
-
2 d2 L12

w12
+
E-2 I T0 W-2 I t1 d2 L12


15 w12
+
E2 I T0 W+2 I t1 d2 L12

15 w12
-
E-I T0 W-I t2+I T0 w1 A2 d3 L2


2 w12
+
184
Chapter6.nb

EI T0 W+I t2+I T0 w1 A2 d3 L2


4 w12
-
3 E-I T0 W-I t2+I T0 w2 A2 d4 L2


2 w12
+
3 EI T0 W+I t2+I T0 w2 A2 d4 L2


4 w12
+
2 E-2I T0 W-I t1-I t2 d3 L1 L2


15 w12
-
2 EI t1-It2 d3 L1 L2

w12
-
2 E-I t1+I t2 d3 L1 L2


w12
+
2 E2I T0 W+I t1+I t2 d3 L1 L2


15 w12
-
6 d4 L22

w12
+
E-2 I T0 W-2 I t2 d4 L22


5 w12
+
E2 I T0 W+2 I t2 d4 L22

5 w12
-
I EIT0 w2 A2 m2

2 w1
-
4 I E-I T0 W-I t2 L2 m2


3 w1
+ 4 I EI T0 W+It2 L2 m2


3 w1
- 2 A2 d2 A
2

w12
- 2 EIT0 w1-I T0 w2 A2 d3 A
2


w12
-
2 E-IT0 w1+I T0 w2 A2 d3 A
2


w12
-
6 A2 d4 A
2

w12
+
E-I T0 W-It1-I T0 w1 d2 L1 A
2


4 w12
-
EI T0 W+I t1-I T0 w1 d2 L1 A
2


2 w12
+
E-IT0 W-I t1-I T0 w2 d3 L1 A
2


4 w12
- EI T0 W+I t1-I T0 w2 d3 L1 A
2


2 w12
+ E-I T0 W-I t2-I T0 w1 d3 L2 A
2


4 w12
-
EI T0 W+I t2-I T0 w1 d3 L2 A
2


2 w12
+
3 E-I T0 W-I t2-I T0 w2 d4 L2 A
2


4 w12
-
3 EI T0 W+I t2-I T0 w2 d4 L2 A
2


2 w12
+
I E-IT0 w2 m2 A
2

2 w1
+ E-2 I T0 w1 d2 A
2
2

3 w12
+ 2 E-I T0 w1-IT0 w2 d3 A
2
2


3 w12
+ E-2 I T0 w2 d4 A
2
2

w12
y
{
zzzz>
where
Li==
fi

2 Hwi
2 - W2L
The modulation equations:
:2 I w1 A1
¢ == 2 I e2 w1
i
k
jjj-
81 I A1 d12 L12

4 w13
-
27 I EI T1 s1 A2 d1 d2 L12


4 w13
-
9 I A1 d22 L12

4 w13
-
9 I EIT1 s1 A2 d2 d3 L12


4 w13
-
27 I EI t1-I t2 A1 d1 d2 L1 L2


4 w13
-
27 I E-I t1+I t2 A1 d1 d2 L1 L2


4 w13
-
7 I EI T1 s1+I t1-It2 A2 d22 L1 L2


4 w13
-
5 I EIT1 s1-I t1+I t2 A2 d2
2 L1 L2


2 w13
-
3 I EI T1 s1+I t1-I t2 A2 d1 d3 L1 L2


2 w13
+
3 I EI T1 s1-I t1+I t2 A2 d1 d3 L1 L2


4 w13
-
9 I EIt1-I t2 A1 d2 d3 L1 L2


4 w13
-
9 I E-I t1+I t2 A1 d2 d3 L1 L2


4 w13
-
7 I EI T1 s1+I t1-It2 A2 d3
2 L1 L2


4 w13
-
5 I EIT1 s1-I t1+I t2 A2 d32 L1 L2


2 w13
-
3 I EI T1 s1+I t1-I t2 A2 d2 d4 L1 L2


2 w13
+
3 I EI T1 s1-I t1+I t2 A2 d2 d4 L1 L2


4 w13
-
I A1 d22 L22

4 w13
-
6 I A1 d1 d3 L22

w13
-
9 I EI T1 s1 A2 d2 d3 L22


4 w13
-
I A1 d32 L22

4 w13
-
6 I A1 d2 d4 L22

w13
-
27 I EI T1 s1 A2 d3 d4 L22


4 w13
+
12 I A1 a1 L12

w1
+
3 I EI T1 s1 A2 a2 L12

w1
+
3 I EI t1-I t2 A1 a2 L1 L2


w1
+
3 I E-I t1+I t2 A1 a2 L1 L2


w1
+ 2 I EI T1 s1+I t1-It2 A2 a3 L1 L2


w1
+ 2 I EI T1 s1-I t1+I t2 A2 a3 L1 L2


w1
+
2 I A1 a3 L22

w1
+
3 I EI T1 s1 A2 a4 L22

w1
-
I A1 m12

2 w1
-
15 I A12 d12 A
1

w13
-
10 I EI T1 s1 A1 A2 d1 d2 A
1


w13
-
5 I A12 d22 A
1

3 w1
3
- 2 I E2 IT1 s1 A22 d22 A
1


w1
3
+ I E2 I T1 s1 A22 d1 d3 A
1


w1
3
- 10 I EI T1 s1 A1 A2 d2 d3 A
1


3 w1
3
-
2 I E2I T1 s1 A22 d32 A
1


w13
+ I E2 I T1 s1 A22 d2 d4 A
1


w13
- 7 EI T1 s1+I T1 s2+I t1 d1 L1 m1 A
1


w12
-
Chapter6.nb
185

EI T1 s1+I T1 s2+I t2 d2 L2 m1 A
1


w12
- 4 EI T1 s1+I T1 s2+I t2 d2 L2 m2 A
1


3 w12
+ 6 I A12 a1 A
1

w1
+ 3 I EIT1 s1 A1 A2 a2 A
1


w1
+
I E2I T1 s1 A22 a3 A
1

w1
-
5 I E-I T1 s1 A12 d1 d2 A
2


w13
-
4 I A1 A2 d22 A
2

3 w13
-
6 I A1 A2 d1 d3 A
2

w13
-
5 I E-I T1 s1 A12 d2 d3 A
2


3 w1
3
-
5 I EIT1 s1 A22 d2 d3 A
2


3 w1
3
-
4 I A1 A2 d32 A
2

3 w1
3
-
6 I A1 A2 d2 d4 A
2

w1
3
-
5 I EIT1 s1 A22 d3 d4 A
2


w13
- 11 EI T1 s2+It1 d2 L1 m1 A
2


6 w12
- EI T1 s2+I t2 d3 L2 m1 A
2


2 w12
- EI T1 s2+I t1 d2 L1 m2 A
2


2 w12
-
11 EIT1 s2+I t2 d3 L2 m2 A
2


6 w12
+
3 I E-I T1 s1 A1
2 a2 A
2


2 w1
+
2 I A1 A2 a3 A
2

w1
+
3 I EI T1 s1 A2
2 a4 A
2

2 w1
y
{
zzz +
2 I e w1
i
k
jjj-A1 m1 + 3 I EI T1 s1+I T1 s2+I t1 d1 L1 A
1


w1
+ I EI T1 s1+I T1 s2+I t2 d2 L2 A
1


w1
+
I EIT1 s2+I t1 d2 L1 A
2


w1
+
I EI T1 s2+I t2 d3 L2 A
2


w1
y
{
zzz,
2 I w2 A2
¢ == 2 I e w2
i
k
jjj-A2 m2 +
I EI T1 s2+I t1 d2 L1 A
1


w2
+
I EI T1 s2+I t2 d3 L2 A
1


w2
+
I E-IT1 s1+I T1 s2+I t1 d3 L1 A
2


w2
+
3 I E-I T1 s1+I T1 s2+I t2 d4 L2 A
2


w2
y
{
zzz +
2 I e2 w2
i
k
jjj-
I A2 m2
2

2 w1
+
3 I E-I T1 s1 A1 a2 L1
2


w2
+
2 I A2 a3 L1
2

w2
+
2 I E-IT1 s1+I t1-I t2 A1 a3 L1 L2


w2
+
2 I E-I T1 s1-I t1+It2 A1 a3 L1 L2


w2
+
3 I EI t1-It2 A2 a4 L1 L2


w2
+
3 I E-I t1+I t2 A2 a4 L1 L2


w2
+
3 I E-I T1 s1 A1 a4 L2
2


w2
+
12 I A2 a5 L2
2

w2
-
27 I E-I T1 s1 A1 d1 d2 L1
2


4 w12 w2
-
I A2 d2
2 L1
2

4 w12 w2
-
6 I A2 d1 d3 L1
2

w12 w2
-
9 I E-I T1 s1 A1 d2 d3 L12


4 w12 w2
-
I A2 d32 L12

4 w12 w2
-
6 I A2 d2 d4 L12

w12 w2
-
5 I E-I T1 s1+I t1-It2 A1 d22 L1 L2


2 w12 w2
-
7 I E-I T1 s1-I t1+It2 A1 d22 L1 L2


4 w12 w2
+
3 I E-I T1 s1+I t1-I t2 A1 d1 d3 L1 L2


4 w12 w2
-
3 I E-I T1 s1-I t1+It2 A1 d1 d3 L1 L2


2 w12 w2
-
9 I EI t1-I t2 A2 d2 d3 L1 L2


4 w12 w2
-
9 I E-I t1+I t2 A2 d2 d3 L1 L2


4 w12 w2
-
5 I E-I T1 s1+I t1-It2 A1 d32 L1 L2


2 w1
2 w2
-
7 I E-I T1 s1-I t1+I t2 A1 d32 L1 L2


4 w1
2 w2
+
3 I E-I T1 s1+I t1-I t2 A1 d2 d4 L1 L2


4 w1
2 w2
-
3 I E-I T1 s1-I t1+It2 A1 d2 d4 L1 L2


2 w1
2 w2
- 27 I EI t1-I t2 A2 d3 d4 L1 L2


4 w1
2 w2
- 27 I E-I t1+I t2 A2 d3 d4 L1 L2


4 w1
2 w2
-
9 I E-I T1 s1 A1 d2 d3 L22


4 w12 w2
- 9 I A2 d32 L22

4 w12 w2
- 27 I E-I T1 s1 A1 d3 d4 L22


4 w12 w2
- 81 I A2 d42 L22

4 w12 w2
-
EI T1 s2+I t1 d2 L1 m2 A
1


2 w12
-
EI T1 s2+I t2 d3 L2 m2 A
1


2 w12
+
3 I E-I T1 s1 A12 a2 A
1


2 w2
+
2 I A1 A2 a3 A
1

w2
+
3 I EIT1 s1 A22 a4 A
1

2 w2
-
5 I E-I T1 s1 A12 d1 d2 A
1


w1
2 w2
-
4 I A1 A2 d22 A
1

3 w1
2 w2
-
6 I A1 A2 d1 d3 A
1

w1
2 w2
-
5 I E-I T1 s1 A12 d2 d3 A
1


3 w12 w2
- 5 I EIT1 s1 A22 d2 d3 A
1


3 w12 w2
- 4 I A1 A2 d32 A
1

3 w12 w2
- 6 I A1 A2 d2 d4 A
1

w12 w2
-
5 I EIT1 s1 A22 d3 d4 A
1


w12 w2
-
11 EI T1 s2+It1 d2 L1 m1 A
1


6 w1 w2
-
EI T1 s2+I t2 d3 L2 m1 A
1


2 w1 w2
-
186
Chapter6.nb

4 EIT1 s2+I t2 d3 L2 m2 A
1


3 w1 w2
- E-I T1 s1+I T1 s2+I t1 d3 L1 m2 A
2


2 w12
- 3 E-I T1 s1+I T1 s2+I t2 d4 L2 m2 A
2


2 w12
+
I E-2I T1 s1 A12 a3 A
2


w2
+
3 I E-I T1 s1 A1 A2 a4 A
2


w2
+
6 I A22 a5 A
2

w2
-
2 I E-2 I T1 s1 A12 d22 A
2


w12 w2
+
I E-2I T1 s1 A12 d1 d3 A
2


w1
2 w2
-
10 I E-I T1 s1 A1 A2 d2 d3 A
2


3 w1
2 w2
-
2 I E-2 I T1 s1 A12 d32 A
2


w1
2 w2
-
5 I A22 d32 A
2

3 w12 w2
+ I E-2 IT1 s1 A12 d2 d4 A
2


w12 w2
- 10 I E-I T1 s1 A1 A2 d3 d4 A
2


w12 w2
- 15 I A22 d42 A
2

w12 w2
-
4 E-IT1 s1+I T1 s2+I t1 d3 L1 m1 A
2


3 w1 w2
-
E-I T1 s1+I T1 s2+I t1 d3 L1 m2 A
2


2 w1 w2
-
11 E-I T1 s1+I T1 s2+I t2 d4 L2 m2 A
2


2 w1 w2
y
{
zzz>
8194.159 Second, Null<
 6.1.8 W » 2 w2 - w1 and w2 » w1
In this case, we have a primary resonance of either mode and a one-to-one internal resonance. We let
scaling8 = 9m‘
n_ -> e2 mn, F1 -> e3 f1, F2 -> e3 f2=;
ResonanceCond8 = 9w2 == w1 + e2 s1, W == 2 w2 - w1 + e2 s2=;
Using  MMS,  we  obtain  the  second-order approximate  solution  and  the  two  equations  governing  the  modulation  of the
complex-valued functions Ak:
MMS@scaling8, ResonanceCond8D  Timing
The second-order approximate solution:
:u1@tD == e IEIT0 w1 A1 + E-I T0 w1 A
1M +
e2 i
k
jjjj
E2 I T0 w1 A1
2 d1

w12
+
2 EI T0 w1+I T0 w2 A1 A2 d2


3 w12
+
E2 I T0 w2 A2
2 d3

3 w12
-
6 A1 d1 A
1

w12
-
2 E-I T0 w1+I T0 w2 A2 d2 A
1


w12
+
E-2I T0 w1 d1 A
1
2

w12
-
2 EI T0 w1-IT0 w2 A1 d2 A
2


w12
-
2 A2 d3 A
2

w12
+
2 E-I T0 w1-I T0 w2 d2 A
1 A
2


3 w12
+
E-2 I T0 w2 d3 A
2
2

3 w12
y
{
zzzz,
u2@tD == e IEIT0 w2 A2 + E-I T0 w2 A
2M + e2 i
k
jjjj
E2 IT0 w1 A12 d2

3 w12
+
2 EI T0 w1+IT0 w2 A1 A2 d3


3 w12
+
E2 IT0 w2 A22 d4

w1
2
- 2 A1 d2 A
1

w1
2
- 2 E-I T0 w1+I T0 w2 A2 d3 A
1


w1
2
+ E-2 I T0 w1 d2 A
1
2

3 w1
2
-
2 EIT0 w1-I T0 w2 A1 d3 A
2


w12
-
6 A2 d4 A
2

w12
+
2 E-I T0 w1-I T0 w2 d3 A
1 A
2


3 w12
+
E-2 I T0 w2 d4 A
2
2

w12
y
{
zzzz>
The modulation equations:
Chapter6.nb
187

:2 I w1 A1
¢ ==
2 I e2 w1
i
k
jjj-A1 m1 -
I E2 I T2 s1+IT2 s2+I t1 f1


4 w1
-
15 I A12 d12 A
1

w13
-
10 I EI T2 s1 A1 A2 d1 d2 A
1


w13
-
5 I A12 d22 A
1

3 w13
-
2 I E2I T2 s1 A22 d22 A
1


w13
+
I E2 I T2 s1 A22 d1 d3 A
1


w13
-
10 I EI T2 s1 A1 A2 d2 d3 A
1


3 w13
-
2 I E2I T2 s1 A22 d32 A
1


w13
+ I E2 I T2 s1 A22 d2 d4 A
1


w13
+ 6 I A12 a1 A
1

w1
+ 3 I EI T2 s1 A1 A2 a2 A
1


w1
+
I E2I T2 s1 A2
2 a3 A
1

w1
-
5 I E-I T2 s1 A1
2 d1 d2 A
2


w13
-
4 I A1 A2 d2
2 A
2

3 w13
-
6 I A1 A2 d1 d3 A
2

w13
-
5 I E-I T2 s1 A12 d2 d3 A
2


3 w13
-
5 I EI T2 s1 A22 d2 d3 A
2


3 w13
-
4 I A1 A2 d32 A
2

3 w13
-
6 I A1 A2 d2 d4 A
2

w13
-
5 I EIT2 s1 A22 d3 d4 A
2


w1
3
+
3 I E-I T2 s1 A12 a2 A
2


2 w1
+
2 I A1 A2 a3 A
2

w1
+
3 I EI T2 s1 A22 a4 A
2

2 w1
y
{
zzz,
2 I w2 A2
¢ == 2 I e2 w2
i
k
jjj-A2 m2 -
I EI T2 s1+IT2 s2+I t2 f2


4 w2
+
3 I E-I T2 s1 A12 a2 A
1


2 w2
+
2 I A1 A2 a3 A
1

w2
+
3 I EIT2 s1 A22 a4 A
1

2 w2
-
5 I E-I T2 s1 A12 d1 d2 A
1


w12 w2
-
4 I A1 A2 d22 A
1

3 w12 w2
-
6 I A1 A2 d1 d3 A
1

w12 w2
-
5 I E-I T2 s1 A12 d2 d3 A
1


3 w1
2 w2
- 5 I EI T2 s1 A22 d2 d3 A
1


3 w1
2 w2
- 4 I A1 A2 d32 A
1

3 w1
2 w2
- 6 I A1 A2 d2 d4 A
1

w1
2 w2
-
5 I EIT2 s1 A22 d3 d4 A
1


w12 w2
+ I E-2 IT2 s1 A12 a3 A
2


w2
+ 3 I E-I T2 s1 A1 A2 a4 A
2


w2
+ 6 I A22 a5 A
2

w2
-
2 I E-2 I T2 s1 A12 d22 A
2


w12 w2
+
I E-2 I T2 s1 A12 d1 d3 A
2


w12 w2
-
10 I E-I T2 s1 A1 A2 d2 d3 A
2


3 w12 w2
-
2 I E-2I T2 s1 A12 d32 A
2


w12 w2
-
5 I A22 d32 A
2

3 w12 w2
+
I E-2 IT2 s1 A12 d2 d4 A
2


w12 w2
-
10 I E-I T2 s1 A1 A2 d3 d4 A
2


w12 w2
-
15 I A22 d42 A
2

w12 w2
y
{
zzz>
816.664 Second, Null<
à 6.2 Parametrically Excited Linearly Coupled Systems
 6.2.1 Two-Pendulum Oscillator
As an example, we consider a parametrically excited two-pendulum oscillator with a three-to-one internal resonance:
eq621a = 9q1†@tD + a q2†@tD + q1@tD == 1
2
 a Hq2@tD - q1@tDL2 q2†@tD + 1
6
 q1@tD3 +
a Hq2@tD - q1@tDL q2
¢@tD2 - 2 F1 W2 q1@tD Cos@W tD, q2
†@tD + q1
†@tD + q2@tD ==
1
2
 Hq2@tD - q1@tDL2 q1
†@tD + 1
6
 q2@tD3 - Hq2@tD - q1@tDL q1
¢@tD2 - 2 F1 W2 q2@tD Cos@W tD=;
where
params = 9a -> 16

25
+ e2 s1=;
188
Chapter6.nb

for small e. Here, the excitation frequency, W, is assumed to be close to twice the natural frequency of the second mode, w2,
which is three times the natural frequency of the first mode, w1. Hence, we define the following lists:
omgList = 8w1, w2<;
ResonanceCond = 9W == 2 w2 + e2 s2, w2 == 3 w1=;
omgRule = Solve@ResonanceCond, 8W, #<  FlattenD@@1DD &  omgList  Reverse
:8W ﬁe2 s2 + 6 w1, w2 ﬁ3 w1<, :W ﬁe2 s2 + 2 w2, w1 ﬁw2

3
>>
In order to bring the effects of forcing and nonlinearity at the same order, we let
scaling = 9F1 -> e2 f1=;
For a consistent expansion, we first transform eq621a into a system of four first-order equations. To this  end, we introduce
the two states v1@tD and v2@tD defined by
vel = 8q1¢@tD -> v1@tD, q2¢@tD -> v2@tD<;
Substituting  the  velocity  and  acceleration  terms, using  vel, into  eq621a and  combining  the  result  with  vel, we  transform
eq621a into the following set of four first-order equations:
eq621b = 8vel . Rule -> Equal, eq621a . D@vel, tD . vel<  Transpose  Flatten
9q1
¢ @tD == v1@tD, q1@tD + v1
¢ @tD + a v2
¢ @tD ==
-2 W2 Cos@t WD F1 q1@tD + 1
6
q1@tD3 + a v2@tD2 H-q1@tD + q2@tDL + 1
2
a H-q1@tD + q2@tDL2 v2
¢@tD,
q2
¢ @tD == v2@tD, q2@tD + v1
¢ @tD + v2
¢ @tD ==
-2 W2 Cos@t WD F1 q2@tD + 1
6
q2@tD3 - v1@tD2 H-q1@tD + q2@tDL + 1
2
H-q1@tD + q2@tDL2 v1
¢@tD=
We seek a uniform second-order expansion of the solution of eq621b in the form
solRule =
9qi_ -> ISumAej qi,j@#1, #2, #3D, 8j, 3<E &M, vi_ -> ISumAej vi,j@#1, #2, #3D, 8j, 3<E &M=;
maxOrder = 2;
Using the time scales T0, T1, and T2, we express the dependent variables and their time derivatives as
multiScales = 8qi_@tD -> qi  timeScales, vi_@tD -> vi  timeScales,
Derivative@1D@u_D@tD -> dt@1D@u  timeScalesD, t -> T0<;
Substituting the params, scaling, multiScales, and solRule  into eq621b, expanding the result  for small e, and discarding
terms of order higher than e3, we obtain
eq621c = Heq621b . params . scaling . multiScales . solRule  TrigToExp  ExpandAllL .
en_;n>3 -> 0;
Chapter6.nb
189

Equating coefficients of like powers of e, we obtain
eqEps = Rest@Thread@CoefficientList@Subtract  #, eD == 0DD &  eq621c  Transpose;
To place the linear operator on one side and the nonhomogeneous terms on the other side, we define
eqOrder@i_D := I#@@1DD &  eqEps@@1DD . fs_ -> 0 . u_k_,1 -> uk,iM ==
I#@@1DD &  eqEps@@1DD . fs_ -> 0 . u_k_,1 -> uk,iM - H#@@1DD &  eqEps@@iDDL  Thread
Using the eqOrder[i] and displayRule, we rewrite eqEps in a concise way as
eqOrder@1D . displayRule
eqOrder@2D . displayRule
eqOrder@3D . displayRule
9D0q1,1 - v1,1 == 0, D0v1,1 + 16

25
HD0v2,1L + q1,1 == 0, D0q2,1 - v2,1 == 0, D0v1,1 + D0v2,1 + q2,1 == 0=
9D0q1,2 - v1,2 == -HD1q1,1L, D0v1,2 + 16

25
HD0v2,2L + q1,2 == -HD1v1,1L - 16

25
HD1v2,1L,
D0q2,2 - v2,2 == -HD1q2,1L, D0v1,2 + D0v2,2 + q2,2 == -HD1v1,1L - D1v2,1=
:D0q1,3 - v1,3 == -HD1q1,2L - D2q1,1,
D0v1,3 + 16

25
HD0v2,3L + q1,3 == -HD1v1,2L - 16

25
HD1v2,2L - D2v1,1 - 16

25
HD2v2,1L -
HD0v2,1L s1 - E-I T0 W W2 f1 q1,1 - EI T0 W W2 f1 q1,1 - 16

25
v2,1
2
q1,1 +
8

25
HD0v2,1L q1,1
2
+
q1,1
3

6
+
16

25
v2,1
2
q2,1 - 16

25
HD0v2,1L q1,1 q2,1 +
8

25
HD0v2,1L q2,1
2
, D0q2,3 - v2,3 == -HD1q2,2L - D2q2,1,
D0v1,3 + D0v2,3 + q2,3 == -HD1v1,2L - D1v2,2 - D2v1,1 - D2v2,1 + v1,1
2
q1,1 + 1
2
HD0v1,1L q1,1
2
-
E-I T0 W W2 f1 q2,1 - EI T0 W W2 f1 q2,1 - v1,1
2
q2,1 - HD0v1,1L q1,1 q2,1 + 1
2
HD0v1,1L q2,1
2
+
q2,1
3

6
>
 First-Order Problem: Linear System
The  first-order  problem,  eqOrder[1],  consists  of a  set  of coupled  linear homogeneous  differential  equations. Hence,  the
general solution is  the solution of the homogeneous equations. To determine the general solution of the homogeneous set,
we rewrite eqOrder[1] as
linearSys = #@@1DD &  eqOrder@1D;
linearSys . displayRule
9D0q1,1 - v1,1, D0v1,1 + 16

25
HD0v2,1L + q1,1, D0q2,1 - v2,1, D0v1,1 + D0v2,1 + q2,1=
Next, we seek a solution of the linearSys in the form
190
Chapter6.nb

assumedForm = 9qi_,1 -> Ici EI w # &M, vi_,1 -> Idi EI w # &M=;
Substituting assumedForm into linearSys and collecting coefficients of ci and di, we obtain the coefficient matrix as
coefMat = OuterAD, E-I w T0 linearSys . assumedForm  Expand, 8c1, d1, c2, d2<E
98I w, -1, 0, 0<, 91, I w, 0, 16 I w

25
=, 80, 0, I w, -1<, 80, I w, 1, I w<=
whose adjoint is defined by
hermitian@mat_? MatrixQD := mat . conjugateRule  Transpose
The natural frequencies of the two modes involved are
evals = Cases@w . Solve@Det@coefMatD == 0, wD, n_ ; n > 0D
:
 !!!5

3
,  !!!5 >
Hence, the right and left eigenvectors of coefMat corresponding to evals are
rightVec = #  #@@1DD &  HNullSpace@coefMat . w -> #D@@1DD &  evalsL
::1, I  !!!5

3
, 5
4
, 5 I  !!!5

12
>, :1, I  ! !!5 , - 5
4
, - 5 I  !!!5

4
>>
leftVec = NullSpace@hermitian@coefMatD . w -> #D@@1DD &  evals
::- 3I  ! !!5

4
, 5
4
, - 3 I

 ! !!5
, 1>, : I  ! !!5

4
, - 5
4
, -
I

 !!!5
, 1>>
whose complex conjugates are
ccleftVec = leftVec . conjugateRule
:: 3 I  !!!5

4
, 5
4
,
3 I

 !!!5
, 1>, :- I  !!!5

4
, - 5
4
,
I

 !!!5
, 1>>
Based on the rightVec, we can assume the general solution form as
sol1Form = Transpose@rightVecD.9A1@T1, T2D EI w1 T0 , A2@T1, T2D EI w2 T0=
9EI T0 w1 A1@T1, T2D + EI T0 w2 A2@T1, T2D, 1
3
I  ! !!5 EI T0 w1 A1@T1, T2D + I  !!!5 EI T0 w2 A2@T1, T2D,
5
4
EI T0 w1 A1@T1, T2D - 5
4
EI T0 w2 A2@T1, T2D,
5

12
I  !!!5 EI T0 w1 A1@T1, T2D - 5
4
I  !!!5 EIT0 w2 A2@T1, T2D=
where w1 =  !!!5  3 and w2 =  !!!5 . Therefore, the general solution of eqOrder[1] can be expressed in pure function form as
Chapter6.nb
191

sol1 = 8q1,1, v1,1, q2,1, v2,1< ->
HFunction@8T0, T1, T2<, # + H# . conjugateRuleL  EvaluateD &  sol1FormL  Thread;
sol1 . displayRule
9q1,1 ﬁFunction@8T0, T1, T2<, EI T0 w1 A1 + EI T0 w2 A2 + E-I T0 w1 A
1 + E-I T0 w2 A
2D, v1,1 ﬁ
FunctionA8T0, T1, T2<, 1
3
I  !!!5 EIT0 w1 A1 + I  !!!5 EIT0 w2 A2 - 1
3
I  !!!5 E-I T0 w1 A
1 - I  !!!5 E-IT0 w2 A
2E,
q2,1 ﬁFunctionA8T0, T1, T2<, 5
4
EIT0 w1 A1 - 5
4
EI T0 w2 A2 + 5
4
E-I T0 w1 A
1 - 5
4
E-IT0 w2 A
2E,
v2,1 ﬁFunctionA8T0, T1, T2<,
5

12
I  !!!5 EI T0 w1 A1 - 5
4
I  ! !!5 EI T0 w2 A2 - 5

12
I  ! !!5 E-I T0 w1 A
1 + 5
4
I  !!!5 E-I T0 w2 A
2E=
where A1 and A2 are to be determined from the solvability conditions at the next levels of approximation.
 Second-Order Problem
Substituting the first-order solution sol1 into the second-order problem, eqOrder[2], yields
order2Eq = eqOrder@2D . sol1  ExpandAll;
order2Eq . displayRule
:D0q1,2 - v1,2 == -EI T0 w1 HD1A1L - EI T0 w2 HD1A2L - E-I T0 w1 HD1A
1L - E-I T0 w2 HD1A
2L,
D0v1,2 + 16

25
HD0v2,2L + q1,2 ==
- 4I EI T0 w1 HD1A1L

3  !!!5
- 1
3
I  !!!5 EIT0 w1 HD1A1L + 4 I EI T0 w2 HD1A2L

 !!!5
- I  !!!5 EI T0 w2 HD1A2L +
4 I E-IT0 w1 HD1A
1L


3  !!!5
+ 1
3
I  ! !!5 E-I T0 w1 HD1A
1L - 4 I E-I T0 w2 HD1A
2L


 ! !!5
+ I  !!!5 E-I T0 w2 HD1A
2L,
D0q2,2 - v2,2 == - 5
4
EI T0 w1 HD1A1L + 5
4
EI T0 w2 HD1A2L - 5
4
E-I T0 w1 HD1A
1L + 5
4
E-I T0 w2 HD1A
2L,
D0v1,2 + D0v2,2 + q2,2 ==
- 3
4
I  !!!5 EI T0 w1 HD1A1L + 1
4
I  !!!5 EI T0 w2 HD1A2L + 3
4
I  ! !!5 E-I T0 w1 HD1A
1L - 1
4
I  !!!5 E-I T0 w2 HD1A
2L>
For a uniform expansion, we choose D1 A1 and D1 A2  to eliminate the secular or small-divisor terms. To accomplish this, we
first convert the small-divisor terms into secular terms using the rule
expRule1@i_D := Exp@a_D :> ExpAExpand@a . omgRule@@iDDD . e2 T0 -> T2E
To  eliminate the  terms  that  produce secular terms  (i.e., determine the solvability  conditions) from order2Eq, we collect  the
terms proportional to EI w1 T0  and EI w2 T0 and obtain
ST11 = CoefficientAorder2Eq@@#, 2DD . expRule1@1D, EI w1 T0E &  Range@4D
9-A1
H1,0L@T1, T2D, - 3 I A1
H1,0L@T1, T2D


 !!!5
, - 5
4
A1
H1,0L@T1, T2D, - 3
4
I  !!!5 A1
H1,0L@T1, T2D=
192
Chapter6.nb

ST12 = CoefficientAorder2Eq@@#, 2DD . expRule1@2D, EI w2 T0E &  Range@4D
9-A2
H1,0L@T1, T2D, - I A2
H1,0L@T1, T2D

 !!!5
, 5
4
A2
H1,0L@T1, T2D, 1
4
I  !!!5 A2
H1,0L@T1, T2D=
Then, the solvability conditions demand that ST11 and ST12 be orthogonal to every solution of the corresponding adjoint
problem, namely, the components of ccleftVec. The result is
SCond11 = ccleftVec@@1DD.ST11 == 0
-3 I  !!!5 A1
H1,0L@T1, T2D == 0
SCond12 = ccleftVec@@2DD.ST12 == 0
I  !!!5 A2
H1,0L@T1, T2D == 0
Solving SCond11 and SCond12 for D1 A1 and D1 A2, respectively, yields
SCond11Rule = SolveASCond11, A1
H1,0L@T1, T2DE@@1DD
9A1
H1,0L@T1, T2D ﬁ0=
SCond12Rule = SolveASCond12, A2
H1,0L@T1, T2DE@@1DD
9A2
H1,0L@T1, T2D ﬁ0=
SCond1Rule = Join@SCond11Rule, SCond12RuleD;
whose complex conjugate is
ccSCond1Rule = SCond1Rule . conjugateRule;
Substituting SCond1Rule and ccSCond1Rule into order2Eq, we obtain
order2Eqm = order2Eq . SCond1Rule . ccSCond1Rule  ExpandAll;
order2Eqm . displayRule
9D0q1,2 - v1,2 == 0, D0v1,2 + 16

25
HD0v2,2L + q1,2 == 0, D0q2,2 - v2,2 == 0, D0v1,2 + D0v2,2 + q2,2 == 0=
which is  a set of homogeneous equations. Then, we express the solution of the second-order equations in pure function form
as
sol2 = 8q1,2 -> H0 &L, v1,2 -> H0 &L, q2,2 -> H0 &L, v2,2 -> H0 &L<;
 Third-Order Problem
Substituting the first- and second-order solutions into the third-order problem, eqOrder[3], yields
order3Eq = eqOrder@3D . sol1 . sol2  ExpandAll;
Chapter6.nb
193

Substituting the expRule1 into the right-hand sides  of order3Eq and collecting the terms  that could  produce secular terms,
the terms proportional to EI w1 T0  and EI w2  T0, we have
ST21 = CoefficientA#@@2DD . expRule1@1D, EI w1 T0E &  order3Eq;
ST21 . displayRule
9-HD2A1L, - 3 I HD2A1L

 !!!5
+
5

12
 !!!5 A1 s1 w1 + 23

36
A1
2 A
1 - A1
2 w1 A
1

8  !!!5
+ 11

12
A2 A
1
2 +
3 A2 w1 A
1
2

4  !!!5
+ A2 w2 A
1
2

8  ! !!5
+ 7
2
A1 A2 A
2 - 27 A1 A2 w1 A
2

4  ! !!5
- 9 A1 A2 w2 A
2

2  ! !!5
, - 5
4
HD2A1L,
- 3
4
I  !!!5 HD2A1L + 965 A1
2 A
1

1152
-
1

32
 !!!5 A1
2 w1 A
1 - 1175

384
A2 A
1
2 +
3

16
 ! !!5 A2 w1 A
1
2 -
1

32
 ! !!5 A2 w2 A
1
2 - 35

64
A1 A2 A
2 - 27

16
 ! !!5 A1 A2 w1 A
2 + 9
8
 !!!5 A1 A2 w2 A
2=
ST22 = CoefficientA#@@2DD . expRule1@2D, EI w2 T0E &  order3Eq;
ST22 . displayRule
:-HD2A2L, - I HD2A2L

 !!!5
+ A1
3

36
-
A1
3 w1

24  !!!5
- 5
4
 !!!5 A2 s1 w2 - 3
2
A1 A2 A
1 +
3 A1 A2 w1 A
1

2  !!!5
+ A1 A2 w2 A
1

4  !!!5
- 43

4
A2
2 A
2 - EI T2 s2 W2 f1 A
2 + 243 A22 w2 A
2

8  !!!5
, 5
4
HD2A2L,
1
4
I  ! !!5 HD2A2L + 535 A1
3

1152
-
1

96
 !!!5 A1
3 w1 + 35

64
A1 A2 A
1 + 3
8
 !!!5 A1 A2 w1 A
1 -
1

16
 ! !!5 A1 A2 w2 A
1 + 1315

128
A2
2 A
2 + 5
4
EI T2 s2 W2 f1 A
2 - 243

32
 !!!5 A2
2 w2 A
2>
Then, solvability conditions demand that ST21 and ST22 be orthogonal to their corresponding adjoints. The result is
SCond21 = SolveAccleftVec@@1DD.ST21 == 0, A1
H0,1L@T1, T2DE@@1DD .
9w1 ->  !!!5  3, w2 ->  !!!5 =  ExpandAll;
SCond21 . displayRule
:D2A1 ﬁ- 25

432
I  !!!5 A1 s1 - 353 I  !!!5 A1
2 A
1

3456
+ 11

128
I  ! !!5 A2 A
1
2 + 23

192
I  ! !!5 A1 A2 A
2>
SCond22 = SolveAccleftVec@@2DD.ST22 == 0, A2
H0,1L@T1, T2DE@@1DD .
9W -> 2  !!!5 , w1 ->  !!!5  3, w2 ->  !!!5 =  ExpandAll;
SCond22 . displayRule
9D2A2 ﬁ
11

128
I  ! !!5 A1
3 + 25

16
I  !!!5 A2 s1 + 23

64
I  !!!5 A1 A2 A
1 - 1337

128
I  !!!5 A2
2 A
2 + 10 I  !!!5 EI T2 s2 f1 A
2=
SCond2Rule = Join@SCond21, SCond22D;
194
Chapter6.nb

 Reconstitution
Using the method of reconstitution, Ak
¢ = eD1 Ak + e2 D2 Ak + ”, we combine the partial-differential equations SCond1Rule
and  SCond2Rule  into  the  following  two  ordinary-differential equations  governing  the  modulation  of the  complex-valued
functions Ak :
moduEq = Table@2 I wk Ak¢, 8k, 2<D ==
HTable@2 I wk dt@1D@ Ak@T1, T2DD, 8k, 2<D . SCond1Rule . SCond2RuleL  Thread;
moduEq . displayRule
:2 I w1 A1
¢ == 2 I e2 w1
i
k
jjjj- 25

432
I  !!!5 A1 s1 - 353 I  !!!5 A1
2 A
1

3456
+
11

128
I  !!!5 A2 A
1
2 +
23

192
I  !!!5 A1 A2 A
2
y
{
zzzz,
2 I w2 A2
¢ == 2 I e2 w2
i
k
jj 11

128
I  !!!5 A1
3 + 25

16
I  !!!5 A2 s1 + 23

64
I  !!!5 A1 A2 A
1 - 1337

128
I  !!!5 A2
2 A
2 + 10 I ! !!5 EI T2 s2 f1 A
2y
{
zz>
 6.2.2 The function MMSC
According  to  the  procedures  described  in  the  previous  section, we  build  a  function  named  MMSC  (Method  of Multiple
Scales for Linearly Coupled Systems) to automate the process.
MMSC@eqs_List, depVar_List, scaling_List, ResonanceCond : 8__Equal<D :=
ModuleA8<,
omgList = 8w1, w2<;
omgRule = Solve@ResonanceCond, 8W, #<  FlattenD@@1DD &  omgList  Reverse;
mydepVar = 8u1, v1, u2, v2<;
solRule = 8ui_ -> HSum@e ^j ui,j@#1, #2, #3D, 8j, 3<D &L,
vi_ -> HSum@e ^j vi,j@#1, #2, #3D, 8j, 3<D &L<;
maxOrder = 2;
multiScales = 8ui_@tD -> ui  timeScales, vi_@tD -> vi  timeScales,
Derivative@1D@u_D@tD -> dt@1D@u  timeScalesD, t -> T0<;
eqa = Heqs . Thread@depVar -> mydepVarD . scaling . multiScales . solRule 
TrigToExp  ExpandAllL . e^Hn_ ; n > 3L -> 0;
eqEps = Rest@Thread@CoefficientList@Subtract  #, eD == 0DD &  eqa  Transpose;
eqOrder@i_D :=
I#@@1DD &  eqEps@@1DD . fs_ -> 0 . u_k_,1 -> uk,iM == I#@@1DD &  eqEps@@1DD . fs_ -> 0 .
u_k_,1 -> uk,iM - H#@@1DD &  eqEps@@iDDL  Thread;
H* First-Order Problem *L
linearSys = #@@1DD &  eqOrder@1D;
assumedForm = 8ui_,1 -> Hci E ^HI w #L &L, vi_,1 -> Hdi E ^HI w #L &L<;
coefMat =
Chapter6.nb
195

Outer@D, E^ H-I w T0L linearSys . assumedForm  Expand, 8c1, d1, c2, d2<D;
hermitian@mat_? MatrixQD := mat . conjugateRule  Transpose;
evals = Cases@w . Solve@Det@coefMatD == 0, wD, n_ ; n > 0D;
values = Append@omgRule@@1DD . e -> 0 . w1 -> evals@@1DD, w1 -> evals@@1DDD;
rightVec = #  #@@1DD &  HNullSpace@coefMat . w -> #D@@1DD &  evalsL;
leftVec = NullSpace@hermitian@coefMatD . w -> #D@@1DD &  evals;
ccleftVec = leftVec . conjugateRule;
order1Eq = eqOrder@1D . u_i_,1 -> Hui,1@#1D &L;
sol1p =
DSolve@order1Eq, 8u1,1@T0D, v1,1@T0D, u2,1@T0D, v2,1@T0D<, T0D@@1DD . C@_D -> 0  Simplify;
fRule = 9fi_ -> 2 Li Iwi
2 - W^ 2M=;
sol1Form = H#@@2DD &  sol1pL + HH# + H# . conjugateRuleLL & 
HTranspose@rightVecD.8A1@T1, T2D E ^HI w1 T0L, A2@T1, T2D E^HI w2 T0L<LL;
sol1 = 8u1,1, v1,1, u2,1, v2,1< -> HFunction@8T0, T1, T2<, #  EvaluateD & 
sol1FormL  Thread;
H* Second-Order Problem *L
order2Eq = eqOrder@2D . sol1  ExpandAll;
expRule1@i_D :=
Exp@a_D :> Exp@Expand@a . omgRule@@iDDD . e ^n_. T0 :> timeScales@@n + 1DDD;
ST11 = Coefficient@#@@2DD . expRule1@1D, E ^HI w1 T0LD &  order2Eq;
ST12 = Coefficient@#@@2DD . expRule1@2D, E ^HI w2 T0LD &  order2Eq;
SCond1 = 8ccleftVec@@1DD.ST11 == 0, ccleftVec@@2DD.ST12 == 0<;
SCond1Rule1 = SolveASCond1, 9A1
H1,0L@T1, T2D, A2
H1,0L@T1, T2D=E@@1DD  ExpandAll;
H* sigRule=Solve@ResonanceCond,8s1,s2<D@@1DD; *L
sigRule = Solve@ResonanceCond, s2D@@1DD;
expRule2 = Exp@a_D :> Exp@a . 8T1 -> e T0, T2 -> e ^2 T0< . sigRule  ExpandD;
SCond1Rule2 = SCond1Rule1 . expRule2;
ccSCond1Rule2 = SCond1Rule2 . conjugateRule;
order2Eqm = order2Eq . SCond1Rule2 . ccSCond1Rule2  ExpandAll;
IfAUnion@#@@2DD &  order2EqmD === 80<,
sol2 = 8u1,2 -> H0 &L, v1,2 -> H0 &L, u2,2 -> H0 &L, v2,2 -> H0 &L<,
Return@"The particular solution of the second order
equations needs to be solved, which is not included in this function."D
H*
basicH=
TableA9Ai@T1,T2D E^HI wi T0L,A
i@T1,T2D E^H-I wi T0L=,8i,2<EFlatten;
collectForm=Join@basicH,
If@list1=List  Plus  H#@@2DD &  eqOrder@1DL.c_ fi_ E^a_->Li E^a;
Head@list1D===List,list1,8<DD;
possibleTerms=JoinAcollectForm,
IfAlist1=List  Plus  I#@@2DD &  eqOrder@2D.u_i_,j_->H0 &LM.
196
Chapter6.nb

c_ fi_ E^a_->E^a;Head@list1D===List,list1,8<E,
Outer@Times,collectForm,collectFormDFlattenUnionE;
ResonantTerms@i_D:=H#.8a_;a=!=0->1< & 
HE^H-I wi T0L possibleTerms.expRule1@iD.Exp@_ T0+_.D->0LL
possibleTermsUnionRest;
RT=8Array@ResonantTerms,2D,Array@ResonantTerms,2D.conjugateRule<
Flatten;
NRT=Complement@possibleTerms,RTD;
rRule=Table@MapIndexed@
ri,#2@@1DD->Coefficient@order2Eqm@@i,2DD,#1D &,RTD,8i,4<DFlatten;
list1=Join@ccleftVec,Conjugate@ccleftVecDD;
r4Rule=
Table@Solve@list1@@jDD.Table@ri,j,8i,4<D==0,r4,jD@@1DD,8j,4<DFlatten;
RTsymbolList@i_D=Table@Gi,j,8j,Length@RTD<D;
NRTsymbolList@i_D=Table@Li,j,8j,Length@NRTD<D;
sol2Form=8u1,2,v1,2,u2,2,v2,2<->
HFunction@8T0,T1,T2<,RTsymbolList@#D.RT+NRTsymbolList@#D.NRTEvaluateD & 
Range@4DLThread;
coef1=Solve@Coefficient@Subtract  #.sol2Form,NRTD==0.
Exp@_ T0+_.D->0 &  order2Eqm,
Array@NRTsymbolList,4DFlattenD@@1DD.valuesExpandAll;
eq1=Table@MapIndexed@Coefficient@order2Eqm@@k,1DD.sol2Form,#1D==
rk,#2@@1DD &,RTD.Exp@_ T0+_.D->0,8k,4<D.r4RuleFlatten;
coef2=HSolve@eq1,Join  Array@RTsymbolList,4DD@@1DDSimplifyL.values.
rRuleExpandAll;
sol2=sol2Form.Function@8T0,T1,T2<,a_D:>
Function@8T0,T1,T2<Evaluate,a.coef1.coef2ExpandEvaluateD
*L
E;
H* Third-Order Problem *L
order3Eq = eqOrder@3D . sol1 . sol2  ExpandAll;
ST21 = Coefficient@#@@2DD . expRule1@1D, Exp@I w1 T0DD &  order3Eq;
ST22 = Coefficient@#@@2DD . expRule1@2D, Exp@I w2 T0DD &  order3Eq;
SCond2 = 8ccleftVec@@1DD.ST21 == 0, ccleftVec@@2DD.ST22 == 0<  ExpandAll;
SCond2Rule1 =
SolveASCond2, 9A1
H0,1L@T1, T2D, A2
H0,1L@T1, T2D=E@@1DD . values  ExpandAll;
H* Reconstitution *L
moduEq = Table@2 I wk Ak
¢, 8k, 2<D ==
HTable@2 I wk dt@1D@ Ak@T1, T2DD, 8k, 2<D . HSCond1Rule1 . valuesL . SCond2Rule1 
Collect@#, eD &L  Thread;
Print@"The second-order approximate solution:"D;
Print@
Chapter6.nb
197

Table@ui@tD == Hui  timeScales . solRule . e^ 3 -> 0 . sol1 . sol2 . displayRuleL,
8i, 2<D . Thread@mydepVar -> depVarDD;
IfAOr  Table@HFi  fi . scalingL === e, 8i, 2<D,
Print@"where"D;
PrintA"Li==fiH2Hwi
2-W^2LL"E
E;
Print@"\nThe modulation equations:"D;
Print@moduEq . displayRuleD
E
As an example, we check the case in Section 6.2.1:
eqtest = 9
q1
¢ @tD == v1@tD,
v1
¢ @tD + a v2
¢ @tD + q1@tD ==
-2 W2 Cos@t WD F1 q1@tD + 1
6
q1@tD3 + a v2@tD2 H-q1@tD + q2@tDL + 1
2
a H-q1@tD + q2@tDL2 v2
¢@tD,
q2
¢ @tD == v2@tD,
v2
¢ @tD + v1
¢ @tD + q2@tD ==
-2 W2 Cos@t WD F1 q2@tD + 1
6
q2@tD3 - v1@tD2 H-q1@tD + q2@tDL + 1
2
H-q1@tD + q2@tDL2 v1
¢@tD
= . 9a ﬁ16

25
+ e2 s1=;
scaling1 = 9F1 -> e2 f1=;
ResonanceCond1 = 9w2 == 3 w1, W == 2 w2 + e2 s2=;
MMSC@eqtest, 8q1, v1, q2, v2<, scaling1, ResonanceCond1D  Timing
The second-order approximate solution:
:q1@tD == e IEIT0 w1 A1 + EI T0 w2 A2 + E-I T0 w1 A
1 + E-I T0 w2 A
2M,
q2@tD == e i
k
j 5

4
EI T0 w1 A1 -
5

4
EI T0 w2 A2 +
5

4
E-I T0 w1 A
1 -
5

4
E-I T0 w2 A
2y
{
z>
The modulation equations:
:2 I w1 A1¢ == 2 I e2 w1
i
k
jjjj-
25

432
I  !!!!
5 A1 s1 -
353 I  !!!
5 A12 A
1

3456
+
11

128
I  !!!!
5 A2 A
1
2 +
23

192
I  !!!
5 A1 A2 A
2
y
{
zzzz,
2 I w2 A2¢ == 2 I e2 w2
i
k
jj 11

128 I  !!!
5 A1
3 +
25

16 I  !!!!
5 A2 s1 +
23

64 I  !!!!
5 A1 A2 A
1 -
1337

128
I  !!!!
5 A2
2 A
2 + 10 I  !!!
5 EI T2 s2 f1 A
2y
{
zz>
87.691 Second, Null<
198
Chapter6.nb

Chapter 7
Continuous Systems with Cubic 
Nonlinearities
Elastic  systems,  such  as  beams,  plates,  and  shells,  are  usually  modeled  by  partial-differential  equations  with  specified
boundary  conditions. For small oscillations, the responses  of such  deformable bodies, continuous  or distributed-parameter
systems, can  be adequately  described  by linear equations and boundary  conditions. However, as  the amplitude of oscilla-
tions increases, nonlinear effects  in the governing equations, boundary  conditions, or both come into play. The sources  of
nonlinearities may be geometric, inertial, material, or damping in nature.
Geometric  nonlinearities  may  be  due  to  one  or more  of the  following: nonlinear relationships  among  the  strains  and  the
displacements, large rotations, free surfaces in fluids, time-dependent constraints, mid-plane stretching, and large curvatures.
Nonlinear stretching of the midplane of a deformable body accompanies  its transverse vibrations if it is  supported in such a
way as  to restrict the movement of its ends and / or edges. If large-amplitude vibrations are accompanied by large changes in
the curvature, it is necessary  to employ a nonlinear relationship between the curvature and the displacement. Inertial nonlin-
earities  are  caused  by  concentrated  and  /  or distributed  masses, convective  accelerations,  and  Corriolis  and  centripetal
accelerations. Material nonlinearities  occur whenever  the  constitutive  relations  are  nonlinear,  such  as  the  case when  the
stresses  are nonlinear functions of the strains; the resistive, inductive, and capacitive circuit elements  are nonlinear;  and the
feedback control forces  and moments in servomechanisms  are nonlinear. Damping nonlinearities occur due to form drag and
hysteresis.
Since exact solutions are, in general, not available for determining the dynamic responses of nonlinear continuous systems  to
external or parametric  excitations, recourse has  been  made to  approximate analyses  by  using  either purely  numerical tech-
niques,  or  purely  analytical  techniques,  or a  combination  of numerical  and  analytical techniques.  Application  of purely
numerical techniques  to such problems  may be costly in terms  of computation time and may not reveal some of their intricate
and  complicated  responses. With  purely  analytical  methods, it  may be  difficult  to  treat  systems  with  inhomogeneities  or
complicated geometries. With a combination of numerical and analytical techniques, one can determine some of the compli-
cated responses of systems  with inhomogeneities and complicated shapes.
The numerical-analytic approaches  can  be divided into two groups: discretization and direct methods.  In the discretization
methods, one postulates the solution in the form
w[x,t]=Úm=1
M fmHxLqmHtL   
where  M is  a finite integer.  Then, one  assumes  the  spatial functions  fmHxL, space  discretization, or the temporal functions
qmHtL, time  discretization. With  this  discretization, the  qmHtL are usually  taken  to be  harmonic  and the  method  of harmonic
balance is used to obtain a set of nonlinear boundary-value problems for the fmHxL.
With space discretization, the fmHxL (and thus the spatial dependence) are assumed a priori. If the boundary conditions are
homogeneous,  the  fmHxL are  usually  taken  to  be  the  eigenfunctions  of the  linearized problem.  The  method  of weighted
residuals  or variational principles  can then be used to determine a set of ordinary-differential equations governing the qmHtL.

The  obtained set  of ordinary-differential equations  can be  studied using  any of a great number of methods  developed for
discrete systems.
The  most  common implementation  of  weighted  residuals  is  the  Galerkin  method.  The  great  majority of  recent  studies  of
forced vibrations assume that the response can be expressed in terms  of only  the linear modes that are directly or indirectly
excited (Nayfeh and Mook, 1979). For example, if a system is driven near the natural frequency of a linear mode and that mode
is  not involved  in an internal resonance with  other modes, the response is  assumed to consist of only  that mode. Such an
approach is usually referred to as a single-mode approximation.
In the direct approach, a reduction method, such as  the method of multiple scales, is applied directly to the governing partial-
differential equations  and  associated  boundary  conditions  and  no assumptions  are  made  a  priori regarding  the spatial or
temporal dependence of the response. The  principal advantage of this  approach is  in the treatment of the boundary  condi-
tions at higher orders. This approach has been used recently  by Nayfeh and Nayfeh (1979), Nayfeh (1975, 1996), Nayfeh and
Asfar (1986), Nayfeh  and Bouguerra  (1990), Pai and Nayfeh  (1990), Raouf and Nayfeh  (1990), Nayfeh, Nayfeh, and  Mook
(1992), Nayfeh and Nayfeh (1993, 1995), Nayfeh, Nayfeh, and Pakdemirli (1995), Pakdemirli, Nayfeh, and Nayfeh (1995), Chin
and Nayfeh (1996), Nayfeh and Lacarbonara  (1997, 1998), Lacarbonara, Nayfeh, and Kreider (1998), Nayfeh, Lacarbonara, and
Chin (1999), and Rega, et al. (1999).
Some of the aforementioned  studies  show that  the discretization and  direct approaches  yield the same  results  for systems
with cubic nonlinearities provided that first-order approximations are sought. For systems  with quadratic and cubic nonlineari-
ties, the  discretization  approach  might produce  quantitative,  and  in  some  case qualitative,  errors  unless  many  modes  are
included in the  discretized model. In other words, one has  to include as  many terms  in  the discretized model as  needed for
convergence.  Since we  are dealing  with systems  with cubic  nonlinearities  in this  chapter, we  will obtain  first-order results
using both the discretization and direct approaches.
à Preliminaries
Off@General::spell1, Integrate::generD
Needs@"Utilities`Notation`"D
To use the method of multiple scales, we introduce different time scales T0 = t ,T1= e t, and T2= e2t, symbolize them as
Symbolize@T0D; Symbolize@T1D; Symbolize@T2D;
and form a list of them as follows:
timeScales = 8T0, T1, T2<;
In terms of the time scales Tn, the time derivatives become
dt@0D@expr_D := expr; dt@1D@expr_D := SumAei D@expr, timeScales@@i + 1DDD, 8i, 0, 1<E;
dt@2D@expr_D := Hdt@1D@dt@1D@exprDD  ExpandL . ei_;i>1 -> 0;
In the course of the analysis, we need the complex conjugates of A and G. We define them using the following rule:
conjugateRule = 9A -> A, A -> A, G -> G, G -> G, Complex@0, n_D -> Complex@0, -nD=;
196
Chapter7.nb

To manipulate some complicated integrals without Mathematica being choked, we define the following rules:
intRule1 = 8int@fun_, arg2__D :> int@Expand@funD, arg2D<;
intRule2 = 8int@a_ + b_, arg2__D :> int@a, arg2D + int@b, arg2D,
int@en_. fun_, arg2__D :> en int@fun, arg2D,
int@a_ fun_, a1_, b1___D :> a int@fun, a1, b1D ; FreeQ@a, First@a1DD,
int@int@a1_, a2_D fun_., a3__D :> int@a1, a2D int@fun, a3D ; FreeQ@Rest@a2D, First@a2DD<;
To represent some of the expressions in a more concise way, we introduce the following display rule:
displayRule = 9Derivative@a_, b__DAw_i_E@x, __D :>
SequenceFormAIfAarg1 = Times  MapIndexedAD#2@@1DD-1
#1
&, 8b<E; arg1 =!= 1, arg1, ""E,
wi
SequenceForm  Table@"'",8a<DE,
Derivative@a__D@Ai_D@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD
#1
&, 8a<E, AiE,
Derivative@a__D@A
i_D@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD
#1
&, 8a<E, A
iE,
w_i_@x, __D -> wi, Ai_@__D -> Ai, A
i_@__D -> A
i,
Exp@a_. + b_. Complex@0, m_D T0 + c_. Complex@0, n_D T0D :> Exp@a + Hm * b + n * cL I T0D,
int -> Integrate=;
à 7.1 Solvability Conditions and the Concept of Adjoint
In  directly  attacking  continuous  systems,  one  often  encounters  nonhomogeneous  boundary-value  problems  whose
homogeneous  parts  have  nontrivial  solutions.  Consequently,  the  nonhomogeneous  problems  have  solutions  only  if
solvability  or consistency  conditions  are  satisfied  (Nayfeh, 1981). In  this  section, we  describe  how to  determine  such
solvability conditions.
We start the discussion with the simple problem
eq1 = y†@xD + p2 y@xD == p Sin@p xD;
bc1 = 8y@0D == b1, y@1D == b2<;
The corresponding homogeneous problem has the nontrivial solution
DSolve@8eq1@@1DD == 0<~Join ~ bc1 . bi_ -> 0, y@xD, xD@@1DD
8y@xD ﬁ-C@1D Sin@p xD<
Hence, the nonhomogeneous  problem will not have a solution unless a  solvability condition is  satisfied. To determine this
solvability condition, we use two approaches.
In the first approach, we find the general solution of eq1 using the function DSolve as
yRule = DSolve@eq1, y@xD, xD@@1DD  Simplify
:y@xD ﬁJ- x
2
+ C@2DN Cos@p xD - C@1D Sin@p xD>
Chapter7.nb
197

where C[1] and C[2] are arbitrary constants. Imposing the boundary conditions bc1, we have
bc2 = bc1 . Flatten@yRule . 88x -> 0<, 8x -> 1<<D
9C@2D == b1, 1
2
- C@2D == b2=
These equations are inconsistent unless
Equal  Plus  HList  # &  bc2L
1
2
== b1 + b2
which is the desired solvability condition.
In  the  second  approach, instead  of determining  the  general solution  of the  homogeneous  differential equations and  then
enforcing the boundary conditions to determine the solvability conditions, we use the concept of adjoint as  described next.
This  approach is  attractive if one is  not interested in  determining the  solution of the  nonhomogeneous problem but inter-
ested only in determining the solvability conditions, as is the case in many applications of perturbation methods.
To determine the adjoint and then the solvability conditions, we need to perform integration by parts  of some products. To
accomplish this with Mathematica, we define a function named intByParts according to
intByParts@expr_ ; Head@exprD =!= Equal, depVar_D :=
Module@8intRule1, intRule2, intRule3<,
intRule1 = f_@terms_, x_D :> int@Expand@termsD, xD;
intRule2 = int@term1_ + term2_, x_D :> int@term1, xD + int@term2, xD;
intRule3 = c1_. int@term1_, x_D + c2_. int@term2_, x_D :> int@c1 term1 + c2 term2, xD;
IBP@u_, v_, n_ ; n >= 1, range : 8x_, a_, b_<D := Hu Derivative@n - 1D@vD@xD . x -> bL -
Hu Derivative@n - 1D@vD@xD . x -> aL - IBP@D@u, xD, v, n - 1, rangeD;
IBP@u_, v_, 0, range : 8x_, a_, b_<D := int@u v@xD, rangeD;
expr . intRule1 . intRule2 . int@u_ Derivative@n_D@depVarD@x_D, arg2_D :>
IBP@u, depVar, n, arg2D . intRule3 . int -> Integrate
D
To  determine the  solvability condition of eq1  and bc1 with  this  approach, we multiply  eq1 by  u@xD, integrate  the result  by
parts from x = 0 to x = 1, and obtain
eq1a = intByParts@int@u@xD #, 8x, 0, 1<D, yD &  eq1
à
0
1
 Hp2 u@xD y@xD + y@xD u†@xDL â x + y@0D u¢@0D - y@1D u¢@1D - u@0D y¢@0D + u@1D y¢@1D ==
p à
0
1
Sin@p xD u@xD â x
To determine the adjoint, we set the coefficient of y@xD in the integrand on the left-hand side of eq1a equal to zero; that is,
198
Chapter7.nb

adjointEq1 = Cases@eq1a@@1DD, Integrate@expr_, _D :> Coefficient@expr, y@xDDD@@1DD == 0
p2 u@xD+ u†@xD == 0
To determine the adjoint boundary  conditions, we consider the homogeneous problem (i.e., f@xD = 0, b1 = 0, and b2 = 0), use
the adjointEq1, and obtain from eq1a that
bc1a = eq1a . Integrate -> H0 &L . Hbc1 . Equal -> Rule . bi_ -> 0L
-u@0D y¢@0D + u@1D y¢@1D == 0
To determine  the adjoint boundary  conditions, we set  each of the coefficients  of y¢@0D and y¢@1D in bc1a equal to zero  and
obtain
adjointBC1 =
Solve@Coefficient@bc1a@@1DD, 8y¢@0D, y¢@1D<D == 0, 8u@0D, u@1D<D@@1DD . Rule -> Equal
8u@0D == 0, u@1D == 0<
Therefore, the adjoint u is defined by the adjoint system consisting of adjointEq1 and adjointBC1. Since they are the same as
the homogeneous parts of eq1 and bc1, the problem is said to be self-adjoint. Hence, u@xD = Sin@xD.
adjoint = 8u -> Function@x, Sin@p xDD<
8u ﬁFunction@x, Sin@p xDD<
Once the adjoint  problem has  been defined, we return  to  the nonhomogeneous problem to determine the solvability condi-
tion. Substituting for the adjoint and the boundary conditions bc1 into eq1a yields the solvability condition
SolvCond1 = eq1a@@2DD ==
Heq1a@@1DD . Integrate -> H0 &L . Hbc1 . Equal -> RuleL . HadjointBC1 . Equal -> RuleLL
p à
0
1
Sin@p xD u@xD â x == b1 u¢@0D - b2 u¢@1D
SolvCondf = SolvCond1 . adjoint
p
2
== p b1 + p b2
which is the same as the solvability condition obtained with the other method.
 7.1.1 Hinged-Clamped Beam
In treating a hinged-clamped beam, we need to determine the adjoint of the boundary-value problem
eq1a = -w2 f@xD - 2 P f†@xD + fH4L@xD == f@xD;
bc1a = 8f@0D == 0, f†@0D == 0, f@1D == 0, f¢@1D == 0<;
Chapter7.nb
199

Multiplying eq1a by u@xD and integrating the result by parts from x = 0 to x = 1, we obtain
eq1b = intByParts@int@u@xD #, 8x, 0, 1<D, fD &  eq1a
à
0
1
 H-w2 u@xD f@xD - 2 P f@xD u†@xD + f@xD uH4L@xDL â x - 2 P f@0D u¢@0D + 2 P f@1D u¢@1D +
2 P u@0D f¢@0D - 2 P u@1D f¢@1D - f¢@0D u†@0D + f¢@1D u†@1D + u¢@0D f†@0D - u¢@1D f†@1D +
f@0D uH3L@0D - f@1D uH3L@1D - u@0D fH3L@0D + u@1D fH3L@1D == à
0
1
f@xD u@xD â x
To determine the adjoint equation, we set the coefficient of f@xD in the integrand on the left-hand side of eq1b equal to zero;
that is,
adjointEq1 = Cases@eq1b@@1DD, Integrate@expr_, _D :> Coefficient@expr, f@xDDD@@1DD == 0
-w2 u@xD - 2 P u†@xD + uH4L@xD == 0
To determine the adjoint boundary  conditions, we consider the homogeneous problem, use the adjointEq1, and obtain  from
eq1b that
bc1b = eq1b . Integrate -> H0 &L . Hbc1a . Equal -> RuleL
2 P u@0D f¢@0D - f¢@0D u†@0D - u¢@1D f†@1D - u@0D fH3L@0D + u@1D fH3L@1D == 0
To determine the adjoint boundary conditions, we set each of the coefficients of f¢@0D, fH3L@0D, f†@1D, and fH3L@1D in bc1b equal
to zero and obtain
adjointBC1 = SolveACoefficientAbc1b@@1DD, 9f¢@0D, fH3L@0D, f†@1D, fH3L@1D=E == 0,
8u@0D, u†@0D, u@1D, u¢@1D<E@@1DD . Rule -> Equal
8u†@0D == 0, u@1D == 0, u¢@1D == 0, u@0D == 0<
Therefore, the adjoint u is defined by the adjoint system consisting of adjointEq1 and adjointBC1. Since they are the same as
the homogeneous parts of eq1a and bc1a, the problem is said to be self-adjoint.
Once the adjoint  problem has  been defined, we return  to  the nonhomogeneous problem to determine the solvability condi-
tion. Substituting for the adjoint and the boundary conditions bc1a into eq1b yields the solvability condition
SolvCond1 = eq1b@@2DD ==
Heq1b@@1DD . Integrate -> H0 &L . Hbc1a . Equal -> RuleL . HadjointBC1 . Equal -> RuleLL
à
0
1
f@xD u@xD â x == 0
 7.1.2 Cantilever Beam
The boundary-value problem for a cantilever beam can be written as
eq2a = -w2 f@xD + fH4L@xD == f@xD;
200
Chapter7.nb

bc2a = 9f@0D == 0, f¢@0D == 0, f†@1D == 0, fH3L@1D == 0=;
To determine  the adjoint of this  problem, we multiply  eq2a by  u@xD, integrate the result  by parts  from x = 0 to x = 1, and
obtain
eq2b = intByParts@int@u@xD #, 8x, 0, 1<D, fD &  eq2a
à
0
1
 H-w2 u@xD f@xD + f@xD uH4L@xDL â x - f¢@0D u†@0D + f¢@1D u†@1D + u¢@0D f†@0D -
u¢@1D f†@1D + f@0D uH3L@0D - f@1D uH3L@1D - u@0D fH3L@0D + u@1D fH3L@1D == à
0
1
f@xD u@xD â x
We set the coefficient of f@xD in the integrand on the left-hand side of eq2b equal to zero and obtain the adjoint equation as
adjointEq2 = Cases@eq2b@@1DD, Integrate@expr_, _D :> Coefficient@expr, f@xDDD@@1DD == 0
-w2 u@xD + uH4L@xD == 0
To determine the adjoint boundary  conditions, we consider the homogeneous problem, use the adjointEq2, and obtain  from
eq2b that
bc2b = eq2b . Integrate -> H0 &L . Hbc2a . Equal -> RuleL
f¢@1D u†@1D + u¢@0D f†@0D - f@1D uH3L@1D - u@0D fH3L@0D == 0
To determine the adjoint boundary  conditions, we set each of the coefficients of f†@0D, fH3L@0D, f@1D, and f¢@1D in bc2b equal
to zero and obtain
adjointBC2 = SolveACoefficientAbc2b@@1DD, 9f†@0D, fH3L@0D, f@1D, f¢@1D=E == 0,
9u@0D, u¢@0D, u†@1D, uH3L@1D=E@@1DD . Rule -> Equal
8u@0D == 0, u¢@0D == 0, u†@1D == 0, uH3L@1D == 0<
Therefore, the adjoint u is defined by the adjoint system consisting of adjointEq2 and adjointBC2. Since they are the same as
the homogeneous parts of eq2a and bc2a, the problem is said to be self-adjoint.
Once the adjoint  problem has  been defined, we return  to  the nonhomogeneous problem to determine the solvability condi-
tion. Substituting for the adjoint and the boundary conditions bc2a into eq2b yields the solvability condition
SolvCond2 = eq2b@@2DD ==
Heq2b@@1DD . Integrate -> H0 &L . Hbc2a . Equal -> RuleL . HadjointBC2 . Equal -> RuleLL
à
0
1
f@xD u@xD â x == 0
Chapter7.nb
201

à 7.2 Hinged-Clamped Beam
 7.2.1 EOM and BC's
We consider the nonlinear planar response of a hinged-clamped uniform prismatic beam to a harmonic axial load. The beam is
subjected to a static  axial load and one of its ends is restrained by a linear spring. We assume that the curvature and inertia
nonlinearities  are much smaller than the nonlinearity caused by the mid-plane stretching. The transverse deflection w@x, tD of
the  beam at  the position x and  time t  is  governed  by the  nondimensional integral-partial-differential equation (Nayfeh and
Mook, 1979)
EOM = ¶t,t w@x, tD - 2 P ¶x,x w@x, tD + ¶x,x,x,x w@x, tD ==
-2 e m@xD ¶t w@x, tD + 4 e F ¶x,x w@x, tD Cos@W tD + e a ¶x,x w@x, tD à
0
1
H¶x w@x, tDL2 â x
wH0,2L@x, tD - 2 P wH2,0L@x, tD + wH4,0L@x, tD ==
-2 e m@xD wH0,1L@x, tD + 4 F e Cos@t WD wH2,0L@x, tD + a e i
k
jjà
0
1
 wH1,0L@x, tD
2 â xy
{
zz wH2,0L@x, tD
and homogeneous boundary conditions
BC = 8w@0, tD == 0, ¶x,x w@x, tD == 0 . x -> 0, w@1, tD == 0, ¶x w@x, tD == 0 . x -> 1<
8w@0, tD == 0, wH2,0L@0, tD == 0, w@1, tD == 0, wH1,0L@1, tD == 0<
We assume  that the static  axial load is  such that the lowest two natural frequencies  of the beam are in the ratio of three-to-
one;  that  is, there  is  a  three-to-one  internal  resonance  between  the  second  and  first modes. Moreover,  we  assume  that
neither of these two modes  is  involved  in an  internal resonance  with any  other mode.  We consider three parametric reso-
nances, namely, principal parametric  resonance  of the  first mode, principal parametric resonance  of the second  mode, and
combination parametric resonance of the first and second modes.
 7.2.2 Direct Attack of the Continuous Problem
In this section, we directly attack the integral-partial-differential equation EOM and associated boundary  conditions BC and
seek a first-order uniform expansion of their solution in the form
solRule = w -> IEvaluateASumAej wj@#1, #2, #3D, 8j, 0, 1<EE &M
w ﬁHw0@#1, #2, #3D + e w1@#1, #2, #3D &L
where the first independent variable stands for x and the last two independent variables stand for the two time scales T0 and
T1. Substituting the solRule into EOM, transforming the total time derivatives  into partial derivatives  in terms of T0 and T1,
expanding the result for small e, discarding terms of order higher than e, and using the intRule2 to simplify the expansions of
the integrands, we obtain
202
Chapter7.nb

eq722a =
HHJoin@8EOM<, BCD . Integrate -> int . 8w@x_, tD -> w@x, T0, T1D, Derivative@m_, n_D@wD@
x_, tD -> dt@nD@D@w@x, T0, T1D, 8x, m<DD, t -> T0< .
solRule  ExpandAllL . intRule2  ExpandAllL . en_;n>1 -> 0;
Equating coefficients of like powers of e in eq722a, we obtain
eqEps = Thread@CoefficientList@Subtract  #, eD == 0D &  eq722a  Transpose;
eqEps . displayRule
:9-2 P Hw0
''L + w0
'''' + D0
2w0 == 0, w0@0, T0, T1D == 0,
w0
H2,0,0L@0, T0, T1D == 0, w0@1, T0, T1D == 0, w0
H1,0,0L@1, T0, T1D == 0=,
:-4 F Cos@T0 WD Hw0
''L - a Hw0
'L
2 Hw0
''L - 2 P Hw1
''L + w1
'''' + D0
2w1 + 2 HD0 D1w0L + 2 HD0w0L m@xD == 0,
w1@0, T0, T1D == 0, w1
H2,0,0L@0, T0, T1D == 0, w1@1, T0, T1D == 0, w1
H1,0,0L@1, T0, T1D == 0>>
Because in the presence of damping, all modes that are not directly excited by the forcing or indirectly excited by the internal
resonance will decay with time (Nayfeh and Mook, 1979), the solution of eqEps[[1]] can be expressed in terms  of the lowest
two linear free-vibration modes; that is,
sol0 =
w0 -> FunctionA8x, T0, T1<, SumAAi@T1D fi@xD Exp@I wi T0D + A
i@T1D fi@xD Exp@-I wi T0D, 8i, 2<EE;
where w1 and w2 are the natural frequencies of these modes. For later use, we define the list
omgList = 8w1, w2<;
One can easily show that the mode shapes fi@xD are orthogonal. We assume that these modes are normalized so that
Ù0
1fi@xD fj@xD â x -> dij
where dij is the Kronecker delta function.
Substituting sol0 into the first-order equation, eqEps[[2,1]], and using intRule1 and intRule2, we obtain
Chapter7.nb
203

order1Eq = HeqEps@@1, 1, 1DD . w0 -> w1L ==
HHeqEps@@1, 1, 1DD . w0 -> w1L - HSubtract  eqEps@@2, 1DD . sol0  TrigToExp 
ExpandL . intRule1 . intRule2  ExpandL;
order1Eq . displayRule
-2 P Hw1
''L + w1
'''' + D0
2w1 == -2 I EI T0 w1 HD1A1L w1 f1@xD + 2 I E-I T0 w1 HD1A
1L w1 f1@xD -
2 I EI T0 w1 A1 w1 m@xD f1@xD + 2 I E-I T0 w1 w1 A
1 m@xD f1@xD - 2 I EI T0 w2 HD1A2L w2 f2@xD +
2 I E-I T0 w2 HD1A
2L w2 f2@xD - 2 I EI T0 w2 A2 w2 m@xD f2@xD + 2 I E-I T0 w2 w2 A
2 m@xD f2@xD +
2 EI T0 H-W+w1L F A1 f1
†@xD + 2 EIT0 HW+w1L F A1 f1
†@xD + E3 I T0 w1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz A1
3 f1
†@xD +
2 EI T0 H2 w1+w2L a i
k
jjà
0
1
 f1
¢ @xD f2
¢@xD â xy
{
zz A1
2 A2 f1
†@xD + EI T0 Hw1+2 w2L a i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A1 A2
2 f1
†@xD +
2 EI T0 H-W-w1L F A
1 f1
†@xD + 2 EIT0 HW-w1L F A
1 f1
†@xD + 3 EI T0 w1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz A1
2 A
1 f1
†@xD +
4 EI T0 w2 a i
k
jjà
0
1
 f1
¢ @xD f2
¢ @xD â xy
{
zz A1 A2 A
1 f1
†@xD + EIT0 H-w1+2 w2L a i
k
jjà
0
1
 f2
¢@xD2 â xy
{
zz A2
2 A
1 f1
†@xD +
3 E-I T0 w1 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz A1 A
1
2 f1
†@xD + 2 EI T0 H-2 w1+w2L a i
k
jjà
0
1
 f1
¢ @xD f2
¢@xD â xy
{
zz A2 A
1
2 f1
†@xD +
E-3 I T0 w1 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz A
1
3 f1
†@xD + 2 EIT0 H2 w1-w2L a i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A1
2 A
2 f1
†@xD +
2 EI T0 w1 a i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A1 A2 A
2 f1
†@xD + 4 E-IT0 w2 a i
k
jjà
0
1
 f1
¢ @xD f2
¢@xD â xy
{
zz A1 A
1 A
2 f1
†@xD +
2 E-I T0 w1 a i
k
jjà
0
1
 f2
¢@xD2 â xy
{
zz A2 A
1 A
2 f1
†@xD + 2 EIT0 H-2 w1-w2L a i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A
1
2 A
2 f1
†@xD +
EI T0 Hw1-2 w2L a i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A1 A
2
2 f1
†@xD + EI T0 H-w1-2 w2L a i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A
1 A
2
2 f1
†@xD +
2 EI T0 H-W+w2L F A2 f2
†@xD + 2 EIT0 HW+w2L F A2 f2
†@xD + EI T0 H2 w1+w2L a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz A1
2 A2 f2
†@xD +
2 EI T0 Hw1+2 w2L a i
k
jjà
0
1
 f1
¢ @xD f2
¢@xD â xy
{
zz A1 A2
2 f2
†@xD + E3 I T0 w2 a i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A2
3 f2
†@xD +
2 EI T0 w2 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz A1 A2 A
1 f2
†@xD + 2 EI T0 H-w1+2 w2L a i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A2
2 A
1 f2
†@xD +
EI T0 H-2 w1+w2L a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz A2 A
1
2 f2
†@xD + 2 EI T0 H-W-w2L F A
2 f2
†@xD + 2 EI T0 HW-w2L F A
2 f2
†@xD +
EI T0 H2 w1-w2L a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz A1
2 A
2 f2
†@xD + 4 EI T0 w1 a i
k
jjà
0
1
 f1
¢ @xD f2
¢@xD â xy
{
zz A1 A2 A
2 f2
†@xD +
3 EI T0 w2 a i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A2
2 A
2 f2
†@xD + 2 E-I T0 w2 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz A1 A
1 A
2 f2
†@xD +
4 E-I T0 w1 a i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A2 A
1 A
2 f2
†@xD + EIT0 H-2 w1-w2L a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz A
1
2 A
2 f2
†@xD +
2 EI T0 Hw1-2 w2L a i
k
jjà
0
1
 f1
¢ @xD f2
¢@xD â xy
{
zz A1 A
2
2 f2
†@xD + 3 E-I T0 w2 a i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A2 A
2
2 f2
†@xD +
2 EI T0 H-w1-2 w2L a i
k
jjà
0
1
 f1
¢ @xD f2
¢ @xD â xy
{
zz A
1 A
2
2 f2
†@xD + E-3 I T0 w2 a i
k
jjà
0
1
 f2
¢@xD2 â xy
{
zz A
2
3 f2
†@xD
It follows from eqEps[[2]] that the first-order boundary conditions are
204
Chapter7.nb

order1BC = eqEps@@2DD  Rest
9w1@0, T0, T1D == 0, w1
H2,0,0L@0, T0, T1D == 0, w1@1, T0, T1D == 0, w1
H1,0,0L@1, T0, T1D == 0=
à Principal Parametric Resonance of the First Mode
In  this  case, W » 2 w1. To describe  the nearness  of the internal and principal parametric resonances, we  introduce the two
detuning parameters s1 and s2 defined by
ResonanceConds = 8w2 == 3 w1 + e s1, W == 2 w1 + e s2<;
and define the following rules:
OmgRule = Solve@ResonanceConds, Drop@omgList, 8#<D ~Join~ 8W<D@@1DD &  81, 2<
98w2 ﬁe s1 + 3 w1, W ﬁe s2 + 2 w1<, 9w1 ﬁ1
3
H-e s1 + w2L, W ﬁ1
3
H-2 e s1 + 3 e s2 + 2 w2L==
expRule@i_D := Exp@arg_D :> Exp@Expand@arg . OmgRule@@iDDD . e T0 -> T1D
We substitute ResonanceConds into the right-hand side of order1Eq and obtain the source of secular terms as
ST = Table@Coefficient@order1Eq@@2DD . expRule@iD, Exp@I wi T0DD, 8i, 2<D;
ST . displayRule
:-2 I HD1A1L w1 f1@xD - 2 I A1 w1 m@xD f1@xD + 2 EI T1 s2 F A
1 f1
†@xD +
3 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz A1
2 A
1 f1
†@xD + 2 EI T1 s1 a i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A2 A
1
2 f1
†@xD +
2 a i
k
jjà
0
1
 f2
¢@xD2 â xy
{
zz A1 A2 A
2 f1
†@xD + 2 EI T1 s1-I T1 s2 F A2 f2
†@xD +
EI T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz A2 A
1
2 f2
†@xD + 4 a i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A1 A2 A
2 f2
†@xD,
-2 I HD1A2L w2 f2@xD - 2 I A2 w2 m@xD f2@xD + 2 E-I T1 s1+I T1 s2 F A1 f1
†@xD +
E-I T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz A1
3 f1
†@xD + 4 a i
k
jjà
0
1
 f1
¢ @xD f2
¢@xD â xy
{
zz A1 A2 A
1 f1
†@xD +
2 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz A1 A2 A
1 f2
†@xD + 3 a i
k
jjà
0
1
 f2
¢@xD2 â xy
{
zz A2
2 A
2 f2
†@xD>
Because the homogeneous  part of order1Eq and order1BC has  a nontrivial solution, the corresponding  nonhomogeneous
problem has  a solution only  if solvability conditions are satisfied. It follows from Section 7.1.1 that the homogeneous prob-
lem is  self-adjoint and that the solvability conditions demand that ST be orthogonal to f1@xD and f2@xD, respectively. Impos-
ing these conditions, we have
Chapter7.nb
205

SCond =
Table@int@fj@xD ST@@jDD, 8x, 0, 1<D . intRule1 . intRule2 . int -> Integrate, 8j, 2<D ==
0  Thread;
SCond . displayRule
:2 EI T1 s1-I T1 s2 F i
k
jjà
0
1
 f1@xD f2
†@xD â xy
{
zz A2 - 2 I i
k
jjà
0
1
f1@xD2 â xy
{
zz HD1A1L w1 - 2 I i
k
jjà
0
1
m@xD f1@xD2 â xy
{
zz A1 w1 +
2 EI T1 s2 F i
k
jjà
0
1
 f1@xD f1
†@xD â xy
{
zz A
1 + 3 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f1@xD f1
†@xD â xy
{
zz A1
2 A
1 +
2 EI T1 s1 a i
k
jjà
0
1
 f1
¢ @xD f2
¢ @xD â xy
{
zz i
k
jjà
0
1
 f1@xD f1
†@xD â xy
{
zz A2 A
1
2 +
EI T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f1@xD f2
†@xD â xy
{
zz A2 A
1
2 + 2 a i
k
jjà
0
1
 f2
¢@xD2 â xy
{
zz
i
k
jjà
0
1
 f1@xD f1
†@xD â xy
{
zz A1 A2 A
2 + 4 a i
k
jjà
0
1
 f1
¢ @xD f2
¢@xD â xy
{
zz i
k
jjà
0
1
 f1@xD f2
†@xD â xy
{
zz A1 A2 A
2 == 0,
2 E-I T1 s1+I T1 s2 F i
k
jjà
0
1
 f2@xD f1
†@xD â xy
{
zz A1 + E-I T1 s1 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz i
k
jjà
0
1
 f2@xD f1
†@xD â xy
{
zz A1
3 -
2 I i
k
jjà
0
1
f2@xD2 â xy
{
zz HD1A2L w2 - 2 I i
k
jjà
0
1
m@xD f2@xD2 â xy
{
zz A2 w2 +
4 a i
k
jjà
0
1
 f1
¢ @xD f2
¢@xD â xy
{
zz i
k
jjà
0
1
 f2@xD f1
†@xD â xy
{
zz A1 A2 A
1 + 2 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz
i
k
jjà
0
1
 f2@xD f2
†@xD â xy
{
zz A1 A2 A
1 + 3 a i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f2@xD f2
†@xD â xy
{
zz A2
2 A
2 == 0>
To simplify the notation in the solvability conditions, we use the orthonormality of the mode shapes and define the following
parameters:
notationRule = 9à
0
1
fi_@xD2 â x -> 1, à
0
1
m@xD fi_@xD2 â x -> mi, F à
0
1
 fi_@xD fj_
† @xD â x -> -wi si,j f=;
To  identify the  forms  of the nonlinear terms  in  the solvability  conditions, we  first identify  all of the possible  forms  of the
nonhomogeneous terms in the first-order problem. To this end, we let
basicTerms = TableA9Ai@T1D EI wi T0, A
i@T1D E-I wi T0=, 8i, 2<E  Flatten
8EI T0 w1 A1@T1D, E-I T0 w1 A
1@T1D, EI T0 w2 A2@T1D, E-I T0 w2 A
2@T1D<
Then, all of the possible forms of the nonlinear terms in the first-order problem are given by
cubicTerms = Nest@Outer@Times, basicTerms, #D &, basicTerms, 2D  Flatten  Union;
cubicTerms . displayRule
:E3 I T0 w1 A1
3, EI T0 H2w1+w2L A1
2 A2, EI T0 Hw1+2 w2L A1 A2
2, E3 I T0 w2 A2
3, EI T0 w1 A1
2 A
1,
EI T0 w2 A1 A2 A
1, EI T0 H-w1+2 w2L A2
2 A
1, E-I T0 w1 A1 A
1
2, EI T0 H-2 w1+w2L A2 A
1
2, E-3 I T0 w1 A
1
3,
EI T0 H2 w1-w2L A1
2 A
2, EI T0 w1 A1 A2 A
2, EI T0 w2 A2
2 A
2, E-I T0 w2 A1 A
1 A
2, E-I T0 w1 A2 A
1 A
2,
EI T0 H-2 w1-w2L A
1
2 A
2, EI T0 Hw1-2 w2L A1 A
2
2, E-I T0 w2 A2 A
2
2, EI T0 H-w1-2 w2L A
1 A
2
2, E-3 I T0 w2 A
2
3>
206
Chapter7.nb

Out of these terms, only the terms  that may lead to secular terms  appear in the solvability conditions, which can be identified
according to
secularTerms =
IE-I w# T0  cubicTerms . expRule@#D . Exp@_ T0 + _.D -> 0  Union  RestM &  81, 2<
::A1@T1D2 A
1@T1D, EI T1 s1 A2@T1D A
1@T1D
2, A1@T1D A2@T1D A
2@T1D>,
8E-I T1 s1 A1@T1D3, A1@T1D A2@T1D A
1@T1D, A2@T1D2 A
2@T1D<>
Next, we define the following parameters:
symbolList = 8-8 w1 8g11, d1, g12<, -8 w2 8d2, g21, g22<<
88-8 g11 w1, -8 d1 w1, -8 g12 w1<, 8-8 d2 w2, -8 g21 w2, -8 g22 w2<<
and express SCond in a more concise form as
eqMod = ExpandA- 1

w#
 HHSCond@@#, 1DD . notationRule . Thread@secularTerms@@#DD -> 0DL +
symbolList@@#DD.secularTerms@@#DDLE == 0 &  81, 2<
:2 I m1 A1@T1D + 2 EI T1 s1-I T1 s2 f s1,2 A2@T1D + 2 EI T1 s2 f s1,1 A
1@T1D + 8 g11 A1@T1D2 A
1@T1D +
8 EI T1 s1 d1 A2@T1D A
1@T1D
2 + 8 g12 A1@T1D A2@T1D A
2@T1D + 2 I A1
¢ @T1D == 0,
2 E-I T1 s1+I T1 s2 f s2,1 A1@T1D + 8 E-I T1 s1 d2 A1@T1D3 + 2 I m2 A2@T1D +
8 g21 A1@T1D A2@T1D A
1@T1D + 8 g22 A2@T1D2 A
2@T1D + 2 I A2
¢ @T1D == 0>
where
-symbolList@@1DD -> H-Coefficient@SCond@@1, 1DD, #D &  secularTerms@@1DDL  Thread 
TableForm
8 g11 w1 ﬁ-3 a IÙ0
1 f1¢ @xD2 â xM Ù0
1 f1@xD f1†@xD â x
8 d1 w1 ﬁ-2 a IÙ0
1 f1
¢ @xD f2
¢@xD â xM Ù0
1 f1@xD f1
†@xD â x - a IÙ0
1 f1
¢ @xD2 â xM Ù0
1 f1@xD f2
†@xD â x
8 g12 w1 ﬁ-2 a IÙ0
1 f2
¢ @xD2 â xM Ù0
1 f1@xD f1
†@xD â x - 4 a IÙ0
1 f1
¢ @xD f2
¢ @xD â xM Ù0
1 f1@xD f2
†@xD â x
-symbolList@@2DD -> H-Coefficient@SCond@@2, 1DD, #D &  secularTerms@@2DDL  Thread 
TableForm
8 d2 w2 ﬁ-a IÙ0
1 f1
¢ @xD2 â xM Ù0
1 f2@xD f1
†@xD â x
8 g21 w2 ﬁ-4 a IÙ0
1 f1
¢ @xD f2
¢@xD â xM Ù0
1 f2@xD f1
†@xD â x - 2 a IÙ0
1 f1
¢@xD2 â xM Ù0
1 f2@xD f2
†@xD â x
8 g22 w2 ﬁ-3 a IÙ0
1 f2¢ @xD2 â xM Ù0
1 f2@xD f2†@xD â x
Modulation Equations in Polar Form
The complex-valued solvability conditions can be expressed in real-valued form by introducing the polar transformation
Chapter7.nb
207

ruleA = 9Ai_ -> i
k
jj 1
2
 ai@#D Exp@I qi@#DD &y
{
zz, A
i_ -> i
k
jj 1
2
 ai@#D Exp@-I qi@#DD &y
{
zz=;
into eqMod and obtain
expr1 = Expand@eqMod@@#, 1DD Exp@-I q#@T1DD . ruleAD &  81, 2<
8I m1 a1@T1D + EI T1 s2-2 I q1@T1D f s1,1 a1@T1D + g11 a1@T1D3 + EI T1 s1-IT1 s2-I q1@T1D+I q2@T1D f s1,2 a2@T1D +
EI T1 s1-3 I q1@T1D+Iq2@T1D d1 a1@T1D2 a2@T1D + g12 a1@T1D a2@T1D2 + I a1
¢ @T1D - a1@T1D q1
¢@T1D,
E-I T1 s1+I T1 s2+I q1@T1D-I q2@T1D f s2,1 a1@T1D + E-IT1 s1+3 I q1@T1D-I q2@T1D d2 a1@T1D3 +
I m2 a2@T1D + g21 a1@T1D2 a2@T1D + g22 a2@T1D3 + I a2
¢ @T1D - a2@T1D q2
¢@T1D<
Next, we separate the real and imaginary parts  of expr1 to obtain the equations governing the modulation of the amplitudes
ai and phases qi. To accomplish this, we define the rule
realRule = 8Re@s_D -> s, Im@s_D -> 0<;
Then, the equations governing the amplitudes of motion correspond to the imaginary parts of expr1; that is,
ampEq = Solve@ComplexExpand@Im@#DD == 0 . realRule &  expr1, 8a1
¢ @T1D, a2
¢ @T1D<D@@1DD .
Rule -> Equal  ExpandAll
8a1
¢ @T1D == -m1 a1@T1D - f Sin@T1 s2 - 2 q1@T1DD s1,1 a1@T1D -
f Sin@T1 s1 - T1 s2 - q1@T1D + q2@T1DD s1,2 a2@T1D - Sin@T1 s1 - 3 q1@T1D + q2@T1DD d1 a1@T1D2 a2@T1D,
a2
¢ @T1D == f Sin@T1 s1 - T1 s2 - q1@T1D + q2@T1DD s2,1 a1@T1D +
Sin@T1 s1 - 3 q1@T1D + q2@T1DD d2 a1@T1D3 - m2 a2@T1D<
Moreover, the equations governing the phases of motion correspond to the real parts of expr1; that is,
phaseEq = Solve@ComplexExpand@Re@#DD == 0 . realRule &  expr1, 8q1¢@T1D, q2¢@T1D<D@@1DD .
Rule -> Equal  ExpandAll
:q1
¢ @T1D ==
f Cos@T1 s2 - 2 q1@T1DD s1,1 + g11 a1@T1D2 + f Cos@T1 s1 - T1 s2 - q1@T1D + q2@T1DD s1,2 a2@T1D




a1@T1D
+
Cos@T1 s1 - 3 q1@T1D + q2@T1DD d1 a1@T1D a2@T1D + g12 a2@T1D2,
q2
¢ @T1D == g21 a1@T1D2 + f Cos@T1 s1 - T1 s2 - q1@T1D + q2@T1DD s2,1 a1@T1D




a2@T1D
+
Cos@T1 s1 - 3 q1@T1D + q2@T1DD d2 a1@T1D3



a2@T1D
+ g22 a2@T1D2>
These modulation equations are nonautonomous because they depend explicitly on T1.
To  determine  an autonomous  set  of modulation equations, we  start  with  expr1  and  identify  the independent  phase argu-
ments in it. To accomplish this, we first identify all possible phase arguments; that is,
208
Chapter7.nb

expTerms = I Cases@expr1, Exp@arg_D -> arg, InfinityD  Expand
8-T1 s2 + 2 q1@T1D, -T1 s1 + T1 s2 + q1@T1D - q2@T1D,
-T1 s1 + 3 q1@T1D - q2@T1D, T1 s1 - T1 s2 - q1@T1D + q2@T1D, T1 s1 - 3 q1@T1D + q2@T1D<
Out of these arguments, only two are independent because
Outer@D, expTerms, 8q1@T1D, q2@T1D<D  RowReduce
881, 0<, 80, 1<, 80, 0<, 80, 0<, 80, 0<<
Denoting these two independent arguments by g1 and g2, we have
gammaList = 82 g1@T1D, g2@T1D< == expTerms@@81, 2<DD  Thread
82 g1@T1D == -T1 s2 + 2 q1@T1D, g2@T1D == -T1 s1 + T1 s2 + q1@T1D - q2@T1D<
which can be solved for q1 and q2 to obtain
thetaRule = Solve@gammaList, 8q1@T1D, q2@T1D<D@@1DD  ExpandAll
9q1@T1D ﬁT1 s2

2
+ g1@T1D, q2@T1D ﬁ-T1 s1 + 3 T1 s2

2
+ g1@T1D - g2@T1D=
Substituting for the qi in expr1 yields
expr2 = expr1 . Table@qi -> HEvaluate@thetaRule@@i, 2DD . T1 -> #D &L, 8i, 2<D .
Exp@arg_D :> Exp@Expand@argDD  Expand
9I m1 a1@T1D - 1
2
s2 a1@T1D + E-2 I g1@T1D f s1,1 a1@T1D + g11 a1@T1D3 + E-I g2@T1D f s1,2 a2@T1D +
E-2 I g1@T1D-I g2@T1D d1 a1@T1D2 a2@T1D + g12 a1@T1D a2@T1D2 + I a1
¢ @T1D - a1@T1D g1
¢@T1D,
EI g2@T1D f s2,1 a1@T1D + E2 I g1@T1D+I g2@T1D d2 a1@T1D3 + I m2 a2@T1D + s1 a2@T1D - 3
2
s2 a2@T1D +
g21 a1@T1D2 a2@T1D + g22 a2@T1D3 + I a2
¢ @T1D - a2@T1D g1
¢@T1D + a2@T1D g2
¢@T1D=
Then, the equations governing the amplitudes of motion correspond to the imaginary parts of expr2; that is,
HampEq = Solve@ComplexExpand@Im@#DD == 0 . realRule &  expr2, 8a1
¢ @T1D, a2
¢ @T1D<D@@1DD .
Rule -> Equal  ExpandAllL . f_@T1D -> f
8a1
¢ == Sin@2 g1 + g2D a1
2 a2 d1 - a1 m1 + f Sin@2 g1D a1 s1,1 + f Sin@g2D a2 s1,2,
a2
¢ == -Sin@2 g1 + g2D a1
3 d2 - a2 m2 - f Sin@g2D a1 s2,1<
Moreover, the equations governing the phases of motion correspond to the real parts of expr2; that is,
Chapter7.nb
209

HphaseEq = Solve@ComplexExpand@Re@#DD == 0 . realRule &  expr2, 8g1¢@T1D, g2¢@T1D<D@@1DD .
Rule -> Equal  ExpandAllL . f_@T1D -> f
:g2
¢ == a1
2 g11 + a2
2 g12 - a1
2 g21 - a2
2 g22 + Cos@2 g1 + g2D a1 a2 d1 -
Cos@2 g1 + g2D a13 d2


a2
- s1 + s2 + f Cos@2 g1D s1,1 + f Cos@g2D a2 s1,2

a1
- f Cos@g2D a1 s2,1

a2
,
g1
¢ == a1
2 g11 + a2
2 g12 + Cos@2 g1 + g2D a1 a2 d1 - s2

2
+ f Cos@2 g1D s1,1 + f Cos@g2D a2 s1,2

a1
>
The modulation equations are autonomous because they are independent of the independent variable T1.
Modulation Equations in Cartesian Form and Symmetry Property
In  performing  bifurcation  analyses  of the  dynamics  of the  system,  one  might  find  it  more  convenient, in  some  cases, to
represent the modulation equations in Cartesian rather than polar form. As a byproduct, one can also obtain  the symmetries
of the system.To this end, we introduce the Cartesian transformation
cartRule =
9Ak_ -> i
k
jj 1
2
Hpk@#D - I qk@#DL Exp@I lk@#DD &y
{
zz, A
k_ -> i
k
jj 1
2
Hpk@#D + I qk@#DL Exp@-I lk@#DD &y
{
zz=;
realRule = 8Im@x_D -> 0, Re@x_D -> x, lk_¢@T1D -> nk<;
where  the li  are chosen  to  render the  resulting  modulation equations  autonomous. Substituting the  cartRule  into  eqMod
yields
eqModCart@k_D := Exp@-I lk@T1DD Subtract  eqMod@@kDD . cartRule  Expand;
Next, we  choose the  li  to  render eqModCart autonomous. To  accomplish  this, we identify  its  independent  arguments  by
identifying first all of its arguments. They are given by
list1 =
-I HCases@#, Exp@x_D -> x, InfinityD &  Array@eqModCart, 2D  Flatten  UnionL  Expand
8T1 s2 - 2 l1@T1D, -T1 s1 + T1 s2 + l1@T1D - l2@T1D,
-T1 s1 + 3 l1@T1D - l2@T1D, T1 s1 - T1 s2 - l1@T1D + l2@T1D, T1 s1 - 3 l1@T1D + l2@T1D<
To determine the number of independent relations in list1, we use the function RowReduce and obtain
Outer@D, list1, 8 l1@T1D, l2@T1D<D  RowReduce
881, 0<, 80, 1<, 80, 0<, 80, 0<, 80, 0<<
Hence,  there  are  only  two  linearly  independent  arguments  in  list1. We  choose the  first two  to  determine  the  li.  For an
invariant  set  of modulation  equations, we  set  each  of these  relations  to  be  an  even  multiple  of p.  Solving  the  resulting
relations for the li, we obtain
list1 = list1@@81, 2<DD;
210
Chapter7.nb

lambdaRule = Solve@list1 + 8m1, m2< 2 p == 0  Thread, Table@ li@T1D, 8i, 2<DD@@1DD
9l1@T1D ﬁ1
2
H2 p m1 + T1 s2L, l2@T1D ﬁ1
2
H2 p m1 + 4 p m2 - 2 T1 s1 + 3 T1 s2L=
where the mi are positive or negative integers. Letting ni = li
¢ yields
D@lambdaRule, T1D . realRule
9n1 ﬁs2

2
, n2 ﬁ1
2
H-2 s1 + 3 s2L=
Then,  separating  the  real and  imaginary  parts  of eqModCart, we  obtain  the  following  Cartesian  form of the  modulation
equations:
Heqs = Solve@
Flatten@Table@ComplexExpand@8Im@#D, Re@#D<D &  HeqModCart@kD . Exp@_D -> 1L .
realRule, 8k, 2<DD == 0  Thread, Table@8pk¢@T1D, qk¢@T1D<, 8k, 2<D 
FlattenD@@1DD . Rule -> EqualL . f_@T1D -> f  TableForm
p1
¢ == p1
2 q1 g11 + q1
3 g11 + p2
2 q1 g12 + q1 q2
2 g12 - 2 p1 p2 q1 d1 + p1
2 q2 d1 - q1
2 q2 d1 - p1 m1 - q1 n1 - f q1 s1,1 + f q2
q1
¢ == -p1
3 g11 - p1 q1
2 g11 - p1 p2
2 g12 - p1 q2
2 g12 - p1
2 p2 d1 + p2 q1
2 d1 - 2 p1 q1 q2 d1 - q1 m1 + p1 n1 - f p1 s1,1 -f p
p2¢ == p12 q2 g21 + q12 q2 g21 + p22 q2 g22 + q23 g22 + 3 p12 q1 d2 - q13 d2 - p2 m2 - q2 n2 + f q1 s2,1
q2
¢ == -p1
2 p2 g21 - p2 q1
2 g21 - p2
3 g22 - p2 q2
2 g22 - p1
3 d2 + 3 p1 q1
2 d2 - q2 m2 + p2 n2 - f p1 s2,1
The symmetry property of the system can also be obtained as follows:
phase = Flatten@
Table@Mod@#@@2DD &  lambdaRule . T1 -> 0, 2 pD, 8m1, 0, 10<, 8m2, 0, 10<D, 1D  Union
880, 0<, 8p, p<<
rotMat@a_D = 88Cos@aD, Sin@aD<, 8-Sin@aD, Cos@aD<<;
symmetryList = Join  Table@rotMat@#@@iDDD.8pi, qi<, 8i, 2<D &  phase
88p1, q1, p2, q2<, 8-p1, -q1, -p2, -q2<<
Hence, if 8p1, q1, p2, q2< is  a solution of the modulation equations, then 8- p1, -q1, -p2, -q2< is  also another solution  of
these equations. If these two sets  of solutions  are  the same,  then the  system response is  symmetric; otherwise,  it  will be
asymmetric.
Chapter7.nb
211

à The Functions PolarForm and CartesianForm
Following the  procedures  described in  the  preceding  section, we  build two  functions, PolarForm and  CartesianForm, to
automate  the  process  provided that  the  complex dependent  variables  in the  modulation  equations  are  written  in the  form
Si, i = 1, ..., neq and the corresponding  complex conjugates  are S
i. The functions can be  slightly  modified to allow a  more
general form for the modulation equations. To obtain the polar form or Cartesian form of the complex modulation equations,
we simply  provide the list of modulation equations and  S  as  two required inputs  in PolarForm or CartesianForm, respec-
tively. If S = A, the list of modulation equations is the only required input.
PolarForm@eqs_List, S_Symbol: AD :=
ModuleA8neq = Length@eqsD, t<,
t = Cases@eqs, Si_@a_D -> a, ¥D@@1DD;
polarRule = 9Sk_ -> i
k
jj 1
2
 ak@#D Exp@I bk@#DD &y
{
zz, S
k_ -> i
k
jj 1
2
 ak@#D Exp@-I bk@#DD &y
{
zz=;
realRule = 8Im@x_D -> 0, Re@x_D -> x<;
eqModPolar@k_D := Exp@-I bk@tDD Subtract  eqs@@kDD . polarRule  Expand;
list1 = I Cases@Array@eqModPolar, neqD, Exp@a_D -> a, ¥D  Expand  Union;
newLists@list_, n_D :=
With@8v = Table@Unique@D, 8n<D<,
ReplaceList@list,
Append@Flatten@8___, Pattern@#, _D< &  vD, ___D -> vDD;
betaList = Table@bi@tD, 8i, neq<D;
list2 = 8<;
Scan@
If@NullSpace@Outer@Coefficient, #, betaListDD === 8<, list2 = -#; Return@DD &,
newLists@list1, neqDD;
If@list2 === 8<, Print@
"Autonomous system is not possible!!!\nThe phase list is:"D; Return@list1D
D;
betaRule1 = Solve@list3 = Table@gi@tD, 8i, neq<D == list2  Thread, betaListD@@1DD;
betaRule2 =
Table@bi -> Function@t  Evaluate, bi@tD . betaRule1  EvaluateD, 8i, neq<D;
Do@eq0@iD = eqModPolar@iD . betaRule2 . Exp@a_D :> Exp@Expand@aDD;
eq@iD =
Solve@ComplexExpand@Im@eq0@iDDD == 0 . realRule, ai¢@tDD@@1, 1DD . Rule -> Equal;
eqRe@iD = ComplexExpand@Re@eq0@iDDD == 0 . realRule, 8i, neq<
D;
gammapList = Table@gi¢@tD, 8i, neq<D;
eqList = Solve@Array@eqRe, neqD, gammapListD@@1DD . Rule -> Equal  ExpandAll;
Do@eq@i + neqD = eqList@@iDD, 8i, neq<D;
8Array@eq, 2 * neqD, list3<
E
212
Chapter7.nb

CartesianForm@eqs_List, S_Symbol: AD :=
ModuleA8neq = Length@eqsD, t<,
t = Cases@eqs, Si_@a_D -> a, ¥D@@1DD;
cartRule = 9Sk_ -> H1  2 Hpk@#D - I qk@#DL Exp@I lk@#DD &L,
S
k_ -> H1  2 Hpk@#D + I qk@#DL Exp@-I lk@#DD &L=;
realRule = 8Im@x_D -> 0, Re@x_D -> x, lk_
¢@tD -> nk<;
eqModCart@k_D := Exp@-I lk@tDD Subtract  eqs@@kDD . cartRule  Expand;
eqs1 = 8ComplexExpand@Im@#DD == 0, ComplexExpand@Re@#DD == 0< & 
HArray@eqModCart, neqD . E^ _ -> 1L . realRule  Flatten;
eqs2 = Solve@eqs1, Table@8pk¢@tD, qk¢@tD<, 8k, neq<D  FlattenD@@1DD .
Rule -> Equal;
list1 = I Cases@Array@eqModCart, neqD, Exp@a_D -> a, ¥D  Expand  Union;
newLists@list_, n_D :=
With@8v = Table@Unique@D, 8n<D<,
ReplaceList@list,
Append@Flatten@8___, Pattern@#, _D< &  vD, ___D -> vDD;
lambdaList = Table@li@tD, 8i, neq<D;
list2 = 8<;
Scan@
If@NullSpace@Outer@Coefficient, #, lambdaListDD === 8<, list2 = -#; Return@DD &,
newLists@list1, neqDD;
If@list2 === 8<, Print@
"Autonomous system is not possible!!!\nThe phase list is:"D; Return@list1D
D;
lambdaRule = Solve@list2 + 2 Table@mi, 8i, neq<D p == 0  Thread, lambdaListD@@1DD;
iterList = Table@8mi, 0, 10<, 8i, neq<D;
phase =
Flatten@Table@Mod@Select@#, ! FreeQ@#, pD &D &  HlambdaList . lambdaRule  ExpandL,
2 pD  Evaluate, Sequence  iterList  EvaluateD, neq - 1D  Union;
rotMat@q_D := 88Cos@qD, -Sin@qD<, 8Sin@qD, Cos@qD<<;
symmetryList = Flatten@Table@rotMat@#@@kDDD.8pk, qk<, 8k, 2<DD &  phase;
8eqs2, D@lambdaRule, tD . realRule, symmetryList<
E
 Principal Parametric Resonance of the Second Mode
In  this  case,  W » w2. To describe  the  nearness  of the  internal and  principal parametric  resonances, we  introduce  the two
detuning parameters s1 and s2 defined by
ResonanceConds = 8w2 == 3 w1 + e s1, W == 2 w2 + e s2<;
and define the following rules:
Chapter7.nb
213

OmgRule = Solve@ResonanceConds, Drop@omgList, 8#<D ~Join~ 8W<D@@1DD &  81, 2<
98w2 ﬁe s1 + 3 w1, W ﬁ2 e s1 + e s2 + 6 w1<, 9w1 ﬁ1
3
H-e s1 + w2L, W ﬁe s2 + 2 w2==
expRule@i_D := Exp@arg_D :> Exp@Expand@arg . OmgRule@@iDDD . e T0 -> T1D
We substitute ResonanceConds into the right-hand side of order1Eq and obtain the source of secular terms as
ST = Table@Coefficient@order1Eq@@2DD . expRule@iD, Exp@I wi T0DD, 8i, 2<D;
ST . displayRule
:-2 I HD1A1L w1 f1@xD - 2 I A1 w1 m@xD f1@xD + 3 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz A1
2 A
1 f1
†@xD +
2 EI T1 s1 a i
k
jjà
0
1
 f1
¢ @xD f2
¢ @xD â xy
{
zz A2 A
1
2 f1
†@xD + 2 a i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A1 A2 A
2 f1
†@xD +
EI T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz A2 A
1
2 f2
†@xD + 4 a i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A1 A2 A
2 f2
†@xD,
-2 I HD1A2L w2 f2@xD - 2 I A2 w2 m@xD f2@xD + E-I T1 s1 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz A1
3 f1
†@xD +
4 a i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A1 A2 A
1 f1
†@xD + 2 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz A1 A2 A
1 f2
†@xD +
2 EI T1 s2 F A
2 f2
†@xD + 3 a i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A2
2 A
2 f2
†@xD>
As  discussed  in  the  case of principal parametric  resonance of the  first mode,  the  solvability  conditions  of order1Eq and
order1BC demand that ST be orthogonal to f1@xD and f2@xD, respectively. Imposing these conditions, we have
214
Chapter7.nb

SCond =
Table@int@fj@xD ST@@jDD, 8x, 0, 1<D . intRule1 . intRule2 . int -> Integrate, 8j, 2<D ==
0  Thread;
SCond . displayRule
:-2 I i
k
jjà
0
1
f1@xD2 â xy
{
zz HD1A1L w1 -
2 I i
k
jjà
0
1
m@xD f1@xD2 â xy
{
zz A1 w1 + 3 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz i
k
jjà
0
1
 f1@xD f1
†@xD â xy
{
zz A1
2 A
1 +
2 EI T1 s1 a i
k
jjà
0
1
 f1
¢ @xD f2
¢ @xD â xy
{
zz i
k
jjà
0
1
 f1@xD f1
†@xD â xy
{
zz A2 A
1
2 + EI T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz
i
k
jjà
0
1
 f1@xD f2
†@xD â xy
{
zz A2 A
1
2 + 2 a i
k
jjà
0
1
 f2
¢@xD2 â xy
{
zz i
k
jjà
0
1
 f1@xD f1
†@xD â xy
{
zz A1 A2 A
2 +
4 a i
k
jjà
0
1
 f1
¢ @xD f2
¢@xD â xy
{
zz i
k
jjà
0
1
 f1@xD f2
†@xD â xy
{
zz A1 A2 A
2 == 0,
E-I T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f2@xD f1
†@xD â xy
{
zz A1
3 - 2 I i
k
jjà
0
1
f2@xD2 â xy
{
zz HD1A2L w2 -
2 I i
k
jjà
0
1
m@xD f2@xD2 â xy
{
zz A2 w2 + 4 a i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz i
k
jjà
0
1
 f2@xD f1
†@xD â xy
{
zz A1 A2 A
1 +
2 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f2@xD f2
†@xD â xy
{
zz A1 A2 A
1 + 2 EI T1 s2 F i
k
jjà
0
1
 f2@xD f2
†@xD â xy
{
zz A
2 +
3 a i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f2@xD f2
†@xD â xy
{
zz A2
2 A
2 == 0>
Using the notations introduced in the preceding section, we can express SCond in a more concise form as
eqMod = ExpandA- 1

w#
 HHSCond@@#, 1DD . notationRule . Thread@secularTerms@@#DD -> 0DL +
symbolList@@#DD.secularTerms@@#DDLE == 0 &  81, 2<
:2 I m1 A1@T1D + 8 g11 A1@T1D2 A
1@T1D +
8 EI T1 s1 d1 A2@T1D A
1@T1D
2 + 8 g12 A1@T1D A2@T1D A
2@T1D + 2 I A1
¢ @T1D == 0,
8 E-I T1 s1 d2 A1@T1D3 + 2 I m2 A2@T1D + 8 g21 A1@T1D A2@T1D A
1@T1D +
2 EI T1 s2 f s2,2 A
2@T1D + 8 g22 A2@T1D2 A
2@T1D + 2 I A2
¢@T1D == 0>
where
-symbolList@@1DD -> H-Coefficient@SCond@@1, 1DD, #D &  secularTerms@@1DDL  Thread 
TableForm
8 g11 w1 ﬁ-3 a IÙ0
1 f1
¢ @xD2 â xM Ù0
1 f1@xD f1
†@xD â x
8 d1 w1 ﬁ-2 a IÙ0
1 f1
¢ @xD f2
¢@xD â xM Ù0
1 f1@xD f1
†@xD â x - a IÙ0
1 f1
¢ @xD2 â xM Ù0
1 f1@xD f2
†@xD â x
8 g12 w1 ﬁ-2 a IÙ0
1 f2
¢ @xD2 â xM Ù0
1 f1@xD f1
†@xD â x - 4 a IÙ0
1 f1
¢ @xD f2
¢ @xD â xM Ù0
1 f1@xD f2
†@xD â x
Chapter7.nb
215

-symbolList@@2DD -> H-Coefficient@SCond@@2, 1DD, #D &  secularTerms@@2DDL  Thread 
TableForm
8 d2 w2 ﬁ-a IÙ0
1 f1
¢ @xD2 â xM Ù0
1 f2@xD f1
†@xD â x
8 g21 w2 ﬁ-4 a IÙ0
1 f1
¢ @xD f2
¢@xD â xM Ù0
1 f2@xD f1
†@xD â x - 2 a IÙ0
1 f1
¢@xD2 â xM Ù0
1 f2@xD f2
†@xD â x
8 g22 w2 ﬁ-3 a IÙ0
1 f2¢ @xD2 â xM Ù0
1 f2@xD f2†@xD â x
Modulation Equations in Polar Form
Using eqMod and the function PolarForm defined in the preceding section, we obtain the modulation equations in polar form
and the definitions for gi as
PolarForm@eqModD
::a1
¢ @T1D == -m1 a1@T1D - Sin@g1@T1DD d1 a1@T1D2 a2@T1D,
a2
¢ @T1D == Sin@g1@T1DD d2 a1@T1D3 - m2 a2@T1D - f Sin@g2@T1DD s2,2 a2@T1D,
g1
¢@T1D == s1 + f Cos@g2@T1DD s2,2 - 3 g11 a1@T1D2 + g21 a1@T1D2 +
Cos@g1@T1DD d2 a1@T1D3


a2@T1D
- 3 Cos@g1@T1DD d1 a1@T1D a2@T1D - 3 g12 a2@T1D2 + g22 a2@T1D2,
g2
¢@T1D == s2 - 2 f Cos@g2@T1DD s2,2 - 2 g21 a1@T1D2 - 2 Cos@g1@T1DD d2 a1@T1D3


a2@T1D
- 2 g22 a2@T1D2>,
8g1@T1D == T1 s1 - 3 b1@T1D + b2@T1D, g2@T1D == T1 s2 - 2 b2@T1D<>
Modulation Equations in Cartesian Form and Symmetry Property
Using  eqMod and  the  function  CartesianForm  defined  in  the  preceding  section,  we  obtain  the  modulation  equations  in
Cartesian form, the definitions for ni, and the symmetry property as
216
Chapter7.nb

CartesianForm@eqModD
:8p1
¢ @T1D == -m1 p1@T1D - n1 q1@T1D + g11 p1@T1D2 q1@T1D - 2 d1 p1@T1D p2@T1D q1@T1D +
g12 p2@T1D2 q1@T1D + g11 q1@T1D3 + d1 p1@T1D2 q2@T1D - d1 q1@T1D2 q2@T1D + g12 q1@T1D q2@T1D2,
q1
¢ @T1D == n1 p1@T1D - g11 p1@T1D3 - d1 p1@T1D2 p2@T1D - g12 p1@T1D p2@T1D2 - m1 q1@T1D -
g11 p1@T1D q1@T1D2 + d1 p2@T1D q1@T1D2 - 2 d1 p1@T1D q1@T1D q2@T1D - g12 p1@T1D q2@T1D2,
p2
¢ @T1D == -m2 p2@T1D + 3 d2 p1@T1D2 q1@T1D - d2 q1@T1D3 - n2 q2@T1D - f s2,2 q2@T1D +
g21 p1@T1D2 q2@T1D + g22 p2@T1D2 q2@T1D + g21 q1@T1D2 q2@T1D + g22 q2@T1D3,
q2
¢ @T1D == -d2 p1@T1D3 + n2 p2@T1D - f s2,2 p2@T1D - g21 p1@T1D2 p2@T1D - g22 p2@T1D3 +
3 d2 p1@T1D q1@T1D2 - g21 p2@T1D q1@T1D2 - m2 q2@T1D - g22 p2@T1D q2@T1D2<,
9n1 ﬁ1
6
H2 s1 + s2L, n2 ﬁs2

2
=, :8p1, q1, p2, q2<, : p1

2
-
 !!!3 q1

2
,
 !!!3 p1

2
+ q1

2
, -p2, -q2>,
:- p1

2
-
 !!!3 q1

2
,
 !!!3 p1

2
- q1

2
, p2, q2>, 8-p1, -q1, -p2, -q2<,
:- p1

2
+
 !!!3 q1

2
, - 1
2
 ! !!3 p1 - q1

2
, p2, q2>, : p1

2
+
 ! !!3 q1

2
, - 1
2
 !!!3 p1 + q1

2
, -p2, -q2>>>
 Combination Parametric Resonance of the Two Modes
In this case, W » w1 + w2. To describe the nearness of the internal and combination parametric resonances, we introduce the
two detuning parameters s1 and s2 defined by
ResonanceConds = 8w2 == 3 w1 + e s1, W == w1 + w2 + e s2<;
and define the following rules:
OmgRule = Solve@ResonanceConds, Drop@omgList, 8#<D ~Join~ 8W<D@@1DD &  81, 2<
98w2 ﬁe s1 + 3 w1, W ﬁe s1 + e s2 + 4 w1<, 9w1 ﬁ1
3
H-e s1 + w2L, W ﬁ1
3
H-e s1 + 3 e s2 + 4 w2L==
expRule@i_D := Exp@arg_D :> Exp@Expand@arg . OmgRule@@iDDD . e T0 -> T1D
We substitute ResonanceConds into the right-hand side of order1Eq and obtain the source of secular terms as
Chapter7.nb
217

ST = Table@Coefficient@order1Eq@@2DD . expRule@iD, Exp@I wi T0DD, 8i, 2<D;
ST . displayRule
:-2 I HD1A1L w1 f1@xD - 2 I A1 w1 m@xD f1@xD + 3 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz A1
2 A
1 f1
†@xD +
2 EI T1 s1 a i
k
jjà
0
1
 f1
¢ @xD f2
¢ @xD â xy
{
zz A2 A
1
2 f1
†@xD + 2 a i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A1 A2 A
2 f1
†@xD +
EI T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz A2 A
1
2 f2
†@xD + 2 EI T1 s2 F A
2 f2
†@xD + 4 a i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A1 A2 A
2 f2
†@xD,
-2 I HD1A2L w2 f2@xD - 2 I A2 w2 m@xD f2@xD + E-I T1 s1 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz A1
3 f1
†@xD +
2 EI T1 s2 F A
1 f1
†@xD + 4 a i
k
jjà
0
1
 f1
¢ @xD f2
¢@xD â xy
{
zz A1 A2 A
1 f1
†@xD +
2 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz A1 A2 A
1 f2
†@xD + 3 a i
k
jjà
0
1
 f2
¢@xD2 â xy
{
zz A2
2 A
2 f2
†@xD>
The  solvability  conditions  demand  that  ST  be  orthogonal  to  solutions  of  the  adjoint  homogeneous  problem.  Since  the
problem is self-adjoint, we have
SCond =
Table@int@fj@xD ST@@jDD, 8x, 0, 1<D . intRule1 . intRule2 . int -> Integrate, 8j, 2<D ==
0  Thread;
SCond . displayRule
:-2 I i
k
jjà
0
1
f1@xD2 â xy
{
zz HD1A1L w1 - 2 I i
k
jjà
0
1
m@xD f1@xD2 â xy
{
zz A1 w1 +
3 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f1@xD f1
†@xD â xy
{
zz A1
2 A
1 + 2 EI T1 s1 a i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz
i
k
jjà
0
1
 f1@xD f1
†@xD â xy
{
zz A2 A
1
2 + EI T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f1@xD f2
†@xD â xy
{
zz A2 A
1
2 +
2 EI T1 s2 F i
k
jjà
0
1
 f1@xD f2
†@xD â xy
{
zz A
2 + 2 a i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f1@xD f1
†@xD â xy
{
zz A1 A2 A
2 +
4 a i
k
jjà
0
1
 f1
¢ @xD f2
¢@xD â xy
{
zz i
k
jjà
0
1
 f1@xD f2
†@xD â xy
{
zz A1 A2 A
2 == 0,
E-I T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f2@xD f1
†@xD â xy
{
zz A1
3 - 2 I i
k
jjà
0
1
f2@xD2 â xy
{
zz HD1A2L w2 -
2 I i
k
jjà
0
1
m@xD f2@xD2 â xy
{
zz A2 w2 + 2 EI T1 s2 F i
k
jjà
0
1
 f2@xD f1
†@xD â xy
{
zz A
1 +
4 a i
k
jjà
0
1
 f1
¢ @xD f2
¢@xD â xy
{
zz i
k
jjà
0
1
 f2@xD f1
†@xD â xy
{
zz A1 A2 A
1 + 2 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz
i
k
jjà
0
1
 f2@xD f2
†@xD â xy
{
zz A1 A2 A
1 + 3 a i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f2@xD f2
†@xD â xy
{
zz A2
2 A
2 == 0>
Using the notations introduced in the preceding section, we can express SCond in a more concise form as
218
Chapter7.nb

eqMod = ExpandA- 1

w#
 HHSCond@@#, 1DD . notationRule . Thread@secularTerms@@#DD -> 0DL +
symbolList@@#DD.secularTerms@@#DDLE == 0 &  81, 2<
:2 I m1 A1@T1D + 8 g11 A1@T1D2 A
1@T1D + 8 EIT1 s1 d1 A2@T1D A
1@T1D
2 +
2 EI T1 s2 f s1,2 A
2@T1D + 8 g12 A1@T1D A2@T1D A
2@T1D + 2 I A1
¢ @T1D == 0,
8 E-I T1 s1 d2 A1@T1D3 + 2 I m2 A2@T1D + 2 EI T1 s2 f s2,1 A
1@T1D +
8 g21 A1@T1D A2@T1D A
1@T1D + 8 g22 A2@T1D2 A
2@T1D + 2 I A2
¢ @T1D == 0>
where
-symbolList@@1DD -> H-Coefficient@SCond@@1, 1DD, #D &  secularTerms@@1DDL  Thread 
TableForm
8 g11 w1 ﬁ-3 a IÙ0
1 f1
¢ @xD2 â xM Ù0
1 f1@xD f1
†@xD â x
8 d1 w1 ﬁ-2 a IÙ0
1 f1
¢ @xD f2
¢@xD â xM Ù0
1 f1@xD f1
†@xD â x - a IÙ0
1 f1
¢ @xD2 â xM Ù0
1 f1@xD f2
†@xD â x
8 g12 w1 ﬁ-2 a IÙ0
1 f2¢ @xD2 â xM Ù0
1 f1@xD f1†@xD â x - 4 a IÙ0
1 f1¢ @xD f2¢ @xD â xM Ù0
1 f1@xD f2†@xD â x
-symbolList@@2DD -> H-Coefficient@SCond@@2, 1DD, #D &  secularTerms@@2DDL  Thread 
TableForm
8 d2 w2 ﬁ-a IÙ0
1 f1
¢ @xD2 â xM Ù0
1 f2@xD f1
†@xD â x
8 g21 w2 ﬁ-4 a IÙ0
1 f1¢ @xD f2¢@xD â xM Ù0
1 f2@xD f1†@xD â x - 2 a IÙ0
1 f1¢@xD2 â xM Ù0
1 f2@xD f2†@xD â x
8 g22 w2 ﬁ-3 a IÙ0
1 f2
¢ @xD2 â xM Ù0
1 f2@xD f2
†@xD â x
Modulation Equations in Polar Form
Using eqMod and the function PolarForm, we obtain the modulation equations in polar form and the definitions for gi as
PolarForm@eqModD
::a1
¢ @T1D == -m1 a1@T1D - f Sin@g2@T1DD s1,2 a2@T1D - Sin@g1@T1DD d1 a1@T1D2 a2@T1D,
a2
¢ @T1D == -f Sin@g2@T1DD s2,1 a1@T1D + Sin@g1@T1DD d2 a1@T1D3 - m2 a2@T1D,
g1
¢@T1D == s1 - 3 g11 a1@T1D2 + g21 a1@T1D2 + f Cos@g2@T1DD s2,1 a1@T1D


a2@T1D
+ Cos@g1@T1DD d2 a1@T1D3


a2@T1D
-
3 f Cos@g2@T1DD s1,2 a2@T1D


a1@T1D
- 3 Cos@g1@T1DD d1 a1@T1D a2@T1D - 3 g12 a2@T1D2 + g22 a2@T1D2,
g2
¢@T1D == s2 - g11 a1@T1D2 - g21 a1@T1D2 - f Cos@g2@T1DD s2,1 a1@T1D


a2@T1D
- Cos@g1@T1DD d2 a1@T1D3


a2@T1D
-
f Cos@g2@T1DD s1,2 a2@T1D


a1@T1D
- Cos@g1@T1DD d1 a1@T1D a2@T1D - g12 a2@T1D2 - g22 a2@T1D2>,
8g1@T1D == T1 s1 - 3 b1@T1D + b2@T1D, g2@T1D == T1 s2 - b1@T1D - b2@T1D<>
Chapter7.nb
219

Modulation Equations in Cartesian Form and Symmetry Property
Using eqMod and the function CartesianForm, we obtain  the modulation equations in Cartesian form, the definitions for ni,
and the symmetry property as
CartesianForm@eqModD
98p1
¢ @T1D == -m1 p1@T1D - n1 q1@T1D + g11 p1@T1D2 q1@T1D - 2 d1 p1@T1D p2@T1D q1@T1D + g12 p2@T1D2 q1@T1D +
g11 q1@T1D3 - f s1,2 q2@T1D + d1 p1@T1D2 q2@T1D - d1 q1@T1D2 q2@T1D + g12 q1@T1D q2@T1D2,
q1
¢ @T1D == n1 p1@T1D - g11 p1@T1D3 - f s1,2 p2@T1D - d1 p1@T1D2 p2@T1D - g12 p1@T1D p2@T1D2 -
m1 q1@T1D - g11 p1@T1D q1@T1D2 + d1 p2@T1D q1@T1D2 - 2 d1 p1@T1D q1@T1D q2@T1D - g12 p1@T1D q2@T1D2,
p2
¢ @T1D == -m2 p2@T1D - f s2,1 q1@T1D + 3 d2 p1@T1D2 q1@T1D - d2 q1@T1D3 - n2 q2@T1D +
g21 p1@T1D2 q2@T1D + g22 p2@T1D2 q2@T1D + g21 q1@T1D2 q2@T1D + g22 q2@T1D3,
q2
¢ @T1D == -f s2,1 p1@T1D - d2 p1@T1D3 + n2 p2@T1D - g21 p1@T1D2 p2@T1D - g22 p2@T1D3 +
3 d2 p1@T1D q1@T1D2 - g21 p2@T1D q1@T1D2 - m2 q2@T1D - g22 p2@T1D q2@T1D2<,
9n1 ﬁ1
4
Hs1 + s2L, n2 ﬁ1
4
H-s1 + 3 s2L=, 88p1, q1, p2, q2<, 8-q1, p1, q2, -p2<,
8-p1, -q1, -p2, -q2<, 8q1, -p1, -q2, p2<<=
 7.2.3 Discretization of the Continuous Problem
As  an  alternative,  we  apply  the  method  of multiple  scales  to  the  discretized  system  of EOM and  BC. To  determine  the
discretized form, we expand w@x, tD in terms of the linear mode shapes fm@xD as
wRule1 = w -> FunctionA8x, t<, â
m=1
¥
um@tD fm@xDE;
To  simplify the computation, we temporarily  drop the Ú  sign in  wRule1, as  long  as  we know the repeated  m represents  a
summation index, and rewrite it as
wRule2 = w -> Function@8x, t<, um@tD fm@xDD;
where  the  um@tD  are  the  generalized  coordinates.  Substituting  wRule2  into  EOM,  multiplying  the  result  with  fn@xD,  and
integrating  the  outcome  from x = 0 to  x = 1 using intRule1  and  intRule2, we  obtain  the  following discretized form of the
equations describing the response of the beam:
eq723a = int@fn@xD H# . Integrate -> int . wRule2L, 8x, 0, 1<D . intRule1 . intRule2 .
int -> Integrate &  EOM
-2 P i
k
jjà
0
1
 fn@xD fm
†@xD â xy
{
zz um@tD + i
k
jjà
0
1
 fn@xD fm
H4L@xD â xy
{
zz um@tD + i
k
jjà
0
1
fm@xD fn@xD â xy
{
zz um
† @tD ==
4 F e Cos@t WD i
k
jjà
0
1
 fn@xD fm
†@xD â xy
{
zz um@tD +
a e i
k
jjà
0
1
 fm
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 fn@xD fm
†@xD â xy
{
zz um@tD3 - 2 e i
k
jjà
0
1
m@xD fm@xD fn@xD â xy
{
zz um
¢ @tD
220
Chapter7.nb

where the damping is assumed to be modal. The nonlinear term, in general, should be rewritten as
NT = ICoefficientAeq723a@@2DD, um@tD3E . fm
¢ @xD2 -> fk
¢@xD f{
¢@xDM um@tD uk@tD u{@tD
a e i
k
jjà
0
1
 fk
¢ @xD f{
¢@xD â xy
{
zz i
k
jjà
0
1
 fn@xD fm
†@xD â xy
{
zz uk@tD um@tD u{@tD
Using the orthonormality of the mode shapes fi@xD and the results from the corresponding eigenvalue problem, we define the
following rules:
notationRule1 =
9à
0
1
fm@xD fn@xD âx -> dm,n, à
0
1
 fn@xD fm
H4L@xD âx -> 2 P à
0
1
 fn@xD fm
†@xD â x + wm
2 dm,n=;
notationRule2 = 9à
0
1
m@xD fm@xD fn@xD â x -> mm dm,n, à
0
1
 fn@xD fm
† @xD âx -> -gn,m,
i
k
jjà
0
1
 fk
¢ @xD f{
¢@xD â xy
{
zz i
k
jjà
0
1
 fn@xD fm
†@xD âxy
{
zz -> -gk,{ gn,m, a_ dm,n :> Ha . m -> nL=;
and then rewrite eq723a as
EOM1 =
Expand@eq723a@@1DD . notationRule1D == Ieq723a@@2DD . um@tD3 -> 0M + NT . notationRule2
wn
2 un@tD + un
†@tD == -4 F e Cos@t WD gn,m um@tD - a e gk,{ gn,m uk@tD um@tD u{@tD - 2 e mn un
¢@tD
where m, k, and { represent summation indicies.
Using the method of multiple scales, we seek a first-order uniform expansion in the form
solRule = un_ ->
i
k
jjjjjâ
j=0
1
ej un,j@#1, #2D &
y
{
zzzzz;
Transforming the total time derivatives  in EOM1 into partial derivatives  in terms  of T0 and T1, substituting the solRule into
EOM1, expanding the result for small e, and discarding terms of order higher than e, we obtain
eq723b = HEOM1 . 8us_@tD -> us@T0, T1D, Derivative@n_D@us_D@tD -> dt@nD@us@T0, T1DD, t -> T0< .
solRule  ExpandAllL . en_;n>1 -> 0
wn
2 un,0@T0, T1D + e wn
2 un,1@T0, T1D + 2 e un,0
H1,1L@T0, T1D + un,0
H2,0L@T0, T1D + e un,1
H2,0L@T0, T1D ==
-4 F e Cos@T0 WD gn,m um,0@T0, T1D -
a e gk,{ gn,m uk,0@T0, T1D um,0@T0, T1D u{,0@T0, T1D - 2 e mn un,0
H1,0L@T0, T1D
Equating coefficients of like powers of e in eq723b, we obtain
Chapter7.nb
221

eqEps = CoefficientList@#, eD &  eq723b  Thread
9wn
2 un,0@T0, T1D + un,0
H2,0L@T0, T1D == 0,
wn
2 un,1@T0, T1D + 2 un,0
H1,1L@T0, T1D + un,1
H2,0L@T0, T1D == -4 F Cos@T0 WD gn,m um,0@T0, T1D -
a gk,{ gn,m uk,0@T0, T1D um,0@T0, T1D u{,0@T0, T1D - 2 mn un,0
H1,0L@T0, T1D=
Because in the presence of damping, all modes that are not directly or indirectly excited decay with time, all of the un,0 decay
with time except u1,0 and u2,0. Then it follows from eqEps[[1]] that
sol0 = ui_,0 -> FunctionA8T0, T1<, Ai@T1D Exp@I wi T0D + A
i@T1D Exp@-I wi T0DE;
Taking account of the summation indicies, we define
sumRule = 9gk,{ gn,m uk,0@a__D um,0@a__D u{,0@a__D -> â
k=1
2
â
m=1
2
â
{=1
2
gk,{ gn,m uk,0@aD um,0@aD u{,0@aD,
gn,m um,0@a__D -> â
m=1
2
gn,m um,0@aD=;
Hence, we rewrite eqEps[[2]] as
Clear@order1EqD
order1Eq@n_D = HeqEps@@1, 1DD . un,0 -> un,1L ==
HeqEps@@1, 1DD . un,0 -> un,1L - HSubtract  eqEps@@2DDL . sumRule
wn
2 un,1@T0, T1D + un,1
H2,0L@T0, T1D == -4 F Cos@T0 WD Hgn,1 u1,0@T0, T1D + gn,2 u2,0@T0, T1DL -
a Hg1,1 gn,1 u1,0@T0, T1D3 + g1,2 gn,1 u1,0@T0, T1D2 u2,0@T0, T1D +
g2,1 gn,1 u1,0@T0, T1D2 u2,0@T0, T1D + g1,1 gn,2 u1,0@T0, T1D2 u2,0@T0, T1D +
g2,2 gn,1 u1,0@T0, T1D u2,0@T0, T1D2 + g1,2 gn,2 u1,0@T0, T1D u2,0@T0, T1D2 +
g2,1 gn,2 u1,0@T0, T1D u2,0@T0, T1D2 + g2,2 gn,2 u2,0@T0, T1D3L - 2 mn un,0
H1,0L@T0, T1D - 2 un,0
H1,1L@T0, T1D
Substituting sol0 into order1Eq[1] and order1Eq[2] yields
eqOrder1 = Array@order1Eq, 2D . sol0  TrigToExp  ExpandAll;
à Principal Parametric Resonance of the First Mode
ResonanceConds = 8w2 == 3 w1 + e s1, W == 2 w1 + e s2<;
OmgRule = Solve@ResonanceConds, Drop@omgList, 8#<D ~Join~ 8W<D@@1DD &  81, 2<
98w2 ﬁe s1 + 3 w1, W ﬁe s2 + 2 w1<, 9w1 ﬁ1
3
H-e s1 + w2L, W ﬁ1
3
H-2 e s1 + 3 e s2 + 2 w2L==
expRule@i_D := Exp@arg_D :> Exp@Expand@arg . OmgRule@@iDDD . e T0 -> T1D
We substitute ResonanceConds into the right-hand sides of eqOrder1 and obtain the solvability condition as
222
Chapter7.nb

SCond = Table@Coefficient@-eqOrder1@@i, 2DD . expRule@iD, Exp@I wi T0DD == 0, 8i, 2<D;
SCond . displayRule
:2 I HD1A1L w1 + 2 I A1 m1 w1 + 2 EI T1 s2 F A
1 g1,1 +
3 a A1
2 A
1 g1,1
2
+ 2 EI T1 s1-I T1 s2 F A2 g1,2 + 2 EI T1 s1 a A2 A
1
2 g1,1 g1,2 + 2 a A1 A2 A
2 g1,2
2
+
EI T1 s1 a A2 A
1
2 g1,1 g2,1 + 2 a A1 A2 A
2 g1,2 g2,1 + 2 a A1 A2 A
2 g1,1 g2,2 == 0,
2 I HD1A2L w2 + 2 I A2 m2 w2 + 2 E-I T1 s1+I T1 s2 F A1 g2,1 + E-IT1 s1 a A1
3 g1,1 g2,1 +
2 a A1 A2 A
1 g1,2 g2,1 + 2 a A1 A2 A
1 g2,1
2
+ 2 a A1 A2 A
1 g1,1 g2,2 + 3 a A2
2 A
2 g2,2
2
== 0>
which is in agreement with that obtained by direct approach.
à Principal Parametric Resonance of the Second Mode
ResonanceConds = 8w2 == 3 w1 + e s1, W == 2 w2 + e s2<;
OmgRule = Solve@ResonanceConds, Drop@omgList, 8#<D ~Join~ 8W<D@@1DD &  81, 2<
98w2 ﬁe s1 + 3 w1, W ﬁ2 e s1 + e s2 + 6 w1<, 9w1 ﬁ1
3
H-e s1 + w2L, W ﬁe s2 + 2 w2==
expRule@i_D := Exp@arg_D :> Exp@Expand@arg . OmgRule@@iDDD . e T0 -> T1D
We substitute ResonanceConds into the right-hand sides of eqOrder1 and obtain the solvability condition as
SCond = Table@Coefficient@-eqOrder1@@i, 2DD . expRule@iD, Exp@I wi T0DD == 0, 8i, 2<D;
SCond . displayRule
:2 I HD1A1L w1 + 2 I A1 m1 w1 + 3 a A1
2 A
1 g1,1
2
+ 2 EI T1 s1 a A2 A
1
2 g1,1 g1,2 +
2 a A1 A2 A
2 g1,2
2
+ EI T1 s1 a A2 A
1
2 g1,1 g2,1 + 2 a A1 A2 A
2 g1,2 g2,1 + 2 a A1 A2 A
2 g1,1 g2,2 == 0,
2 I HD1A2L w2 + 2 I A2 m2 w2 + E-I T1 s1 a A1
3 g1,1 g2,1 + 2 a A1 A2 A
1 g1,2 g2,1 +
2 a A1 A2 A
1 g2,1
2
+ 2 EI T1 s2 F A
2 g2,2 + 2 a A1 A2 A
1 g1,1 g2,2 + 3 a A2
2 A
2 g2,2
2
== 0>
which is in agreement with that obtained by direct approach.
à Combination Parametric Resonance of the Two Modes
ResonanceConds = 8w2 == 3 w1 + e s1, W == w1 + w2 + e s2<;
OmgRule = Solve@ResonanceConds, Drop@omgList, 8#<D ~Join~ 8W<D@@1DD &  81, 2<
98w2 ﬁe s1 + 3 w1, W ﬁe s1 + e s2 + 4 w1<, 9w1 ﬁ1
3
H-e s1 + w2L, W ﬁ1
3
H-e s1 + 3 e s2 + 4 w2L==
expRule@i_D := Exp@arg_D :> Exp@Expand@arg . OmgRule@@iDDD . e T0 -> T1D
We substitute ResonanceConds into the right-hand sides of eqOrder1 and obtain the solvability condition as
Chapter7.nb
223

SCond = Table@Coefficient@-eqOrder1@@i, 2DD . expRule@iD, Exp@I wi T0DD == 0, 8i, 2<D;
SCond . displayRule
:2 I HD1A1L w1 + 2 I A1 m1 w1 + 3 a A1
2 A
1 g1,1
2
+ 2 EI T1 s2 F A
2 g1,2 + 2 EIT1 s1 a A2 A
1
2 g1,1 g1,2 +
2 a A1 A2 A
2 g1,2
2
+ EI T1 s1 a A2 A
1
2 g1,1 g2,1 + 2 a A1 A2 A
2 g1,2 g2,1 + 2 a A1 A2 A
2 g1,1 g2,2 == 0,
2 I HD1A2L w2 + 2 I A2 m2 w2 + 2 EI T1 s2 F A
1 g2,1 + E-I T1 s1 a A1
3 g1,1 g2,1 +
2 a A1 A2 A
1 g1,2 g2,1 + 2 a A1 A2 A
1 g2,1
2
+ 2 a A1 A2 A
1 g1,1 g2,2 + 3 a A2
2 A
2 g2,2
2
== 0>
which is in agreement with that obtained by direct approach.
 7.2.4 Method of Time-Averaged Lagrangian
As a second alternative, we derive the modulation equations by using the method of time-averaged Lagrangian. The nondi-
mensional Lagrangian of the beam can be expressed as (Nayfeh, 1998)
Lagr1 = 1
2
 à
0
1
H¶t w@x, tDL2 â x - 1
2
 à
0
1
H¶x,x w@x, tDL2 âx -
HP + 2 e F Cos@W tDL à
0
1
H¶x w@x, tDL2 âx - 1
4
 e a i
k
jjà
0
1
H¶x w@x, tDL2 âxy
{
zz
2
+ C@tD;
where  C@tD is  independent  of w. Transforming  the total time  derivatives  into  partial derivatives  in  terms  of T0  and T1, we
modify Lagr1 as
Lagr2 = Lagr1 . Integrate -> int . 8w@x_, tD -> w@x, T0, T1D,
Derivative@m_, n_D@wD@x_, tD -> dt@nD@D@w@x, T0, T1D, 8x, m<DD, t -> T0<
C@T0D+ 1
2
intBHe wH0,0,1L@x, T0, T1D + wH0,1,0L@x, T0, T1DL
2, 8x, 0, 1<F -
HP + 2 F e Cos@T0 WDL intBwH1,0,0L@x, T0, T1D
2, 8x, 0, 1<F -
1
4
a e intBwH1,0,0L@x, T0, T1D
2, 8x, 0, 1<F
2
- 1
2
intBwH2,0,0L@x, T0, T1D
2, 8x, 0, 1<F
To this end, we let
solRule = w -> IEvaluateASumAAi@#3D fi@#1D EI wi #2 + A
i@#3D fi@#1D E-I wi #2, 8i, 2<EE &M
w ﬁHEI #2 w1 A1@#3D f1@#1D + EI #2 w2 A2@#3D f2@#1D + E-I #2 w1 f1@#1D A
1@#3D + E-I#2 w2 f2@#1D A
2@#3D &L
where the first independent variable (#1) stands for x and the last two independent variables  (#2 and #3) stand for the two
time  scales  T0  and  T1.  Substituting  solRule  into  Lagr2, using  intRule1  and  intRule2  to  simplify  the  expansions  of  the
integrands, and collecting the coefficients of e, we obtain
order1Lagr =
Lagr2 . solRule . intRule1 . intRule2  TrigToExp  Expand  Coefficient@#, eD &;
224
Chapter7.nb

à Principal Parametric Resonance of the First Mode
ResonanceConds = 8w2 == 3 w1 + e s1, W == 2 w1 + e s2< . Equal -> Rule
8w2 ﬁe s1 + 3 w1, W ﬁe s2 + 2 w1<
Using ResonanceConds, we obtain the slowly varying terms from order1Lagr as
TAL = order1Lagr . Exp@a_D :> Exp@Expand@a . ResonanceCondsD . e T0 -> T1D .
Exp@_ T0 + _.D -> 0 . int -> Integrate
-E-I T1 s2 F i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz A1@T1D2 - 2 EI T1 s1-I T1 s2 F i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A2@T1D A
1@T1D -
EI T1 s2 F i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz A
1@T1D
2 - 3
2
a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz
2
A1@T1D2 A
1@T1D
2 -
EI T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A2@T1D A
1@T1D
3 -
2 E-I T1 s1+I T1 s2 F i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A1@T1D A
2@T1D -
E-I T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A1@T1D3 A
2@T1D -
4 a i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz
2
A1@T1D A2@T1D A
1@T1D A
2@T1D -
2 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A1@T1D A2@T1D A
1@T1D A
2@T1D -
3
2
a i
k
jjà
0
1
 f2
¢@xD2 â xy
{
zz
2
A2@T1D2 A
2@T1D
2 -
I i
k
jjà
0
1
f1@xD2 â xy
{
zz w1 A
1@T1D A1
¢ @T1D - I i
k
jjà
0
1
f2@xD2 â xy
{
zz w2 A
2@T1D A2
¢ @T1D +
I i
k
jjà
0
1
f1@xD2 â xy
{
zz w1 A1@T1D A
1
¢ @T1D + I i
k
jjà
0
1
f2@xD2 â xy
{
zz w2 A2@T1D A
2
¢ @T1D
The Euler-Lagrange equations corresponding to the TAL can be written as
eqMod1 = DADATAL, A
1
¢ @T1DE, T1E - DATAL, A
1@T1DE == 0
2 EI T1 s1-I T1 s2 F i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A2@T1D + 2 EI T1 s2 F i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz A
1@T1D +
3 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz
2
A1@T1D2 A
1@T1D + 3 EI T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f1
¢ @xD f2
¢ @xD â xy
{
zz A2@T1D A
1@T1D
2 +
4 a i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz
2
A1@T1D A2@T1D A
2@T1D +
2 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A1@T1D A2@T1D A
2@T1D + 2 I i
k
jjà
0
1
f1@xD2 â xy
{
zz w1 A1
¢ @T1D == 0
and
Chapter7.nb
225

eqMod2 = DADATAL, A
2
¢ @T1DE, T1E - DATAL, A
2@T1DE == 0
2 E-I T1 s1+I T1 s2 F i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A1@T1D + E-I T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f1
¢ @xD f2
¢ @xD â xy
{
zz A1@T1D3 +
4 a i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz
2
A1@T1D A2@T1D A
1@T1D +
2 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A1@T1D A2@T1D A
1@T1D +
3 a i
k
jjà
0
1
 f2
¢@xD2 â xy
{
zz
2
A2@T1D2 A
2@T1D + 2 I i
k
jjà
0
1
f2@xD2 â xy
{
zz w2 A2
¢@T1D == 0
Adding  linear viscous  damping  to  eqMod1  and  eqMod2  and  performing  integration  by  parts  yields  the  same  modulation
equations as obtained by directly attacking the partial-differential system.
 Principal Parametric Resonance of the Second Mode
ResonanceConds = Solve@8w2 == 3 w1 + e s1, W == 2 w2 + e s2<, 8w2, W<D@@1DD
8w2 ﬁe s1 + 3 w1, W ﬁ2 e s1 + e s2 + 6 w1<
Using ResonanceConds, we obtain the slowly varying terms from order1Lagr as
TAL = order1Lagr . Exp@a_D :> Exp@Expand@a . ResonanceCondsD . e T0 -> T1D .
Exp@_ T0 + _.D -> 0 . int -> Integrate
-E-I T1 s2 F i
k
jjà
0
1
 f2
¢@xD2 â xy
{
zz A2@T1D2 - 3
2
a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz
2
A1@T1D2 A
1@T1D
2 -
EI T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A2@T1D A
1@T1D
3 -
E-I T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A1@T1D3 A
2@T1D -
4 a i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz
2
A1@T1D A2@T1D A
1@T1D A
2@T1D -
2 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A1@T1D A2@T1D A
1@T1D A
2@T1D -
EI T1 s2 F i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A
2@T1D2 - 3
2
a i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz
2
A2@T1D2 A
2@T1D2 -
I i
k
jjà
0
1
f1@xD2 â xy
{
zz w1 A
1@T1D A1
¢ @T1D - I i
k
jjà
0
1
f2@xD2 â xy
{
zz w2 A
2@T1D A2
¢ @T1D +
I i
k
jjà
0
1
f1@xD2 â xy
{
zz w1 A1@T1D A
1
¢ @T1D + I i
k
jjà
0
1
f2@xD2 â xy
{
zz w2 A2@T1D A
2
¢ @T1D
The Euler-Lagrange equations corresponding to the TAL can be written as
226
Chapter7.nb

eqMod1 = DADATAL, A
1
¢ @T1DE, T1E - DATAL, A
1@T1DE == 0
3 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz
2
A1@T1D2 A
1@T1D + 3 EI T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f1
¢ @xD f2
¢@xD â xy
{
zz A2@T1D A
1@T1D
2 +
4 a i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz
2
A1@T1D A2@T1D A
2@T1D +
2 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A1@T1D A2@T1D A
2@T1D + 2 I i
k
jjà
0
1
f1@xD2 â xy
{
zz w1 A1
¢ @T1D == 0
and
eqMod2 = DADATAL, A
2
¢ @T1DE, T1E - DATAL, A
2@T1DE == 0
E-I T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A1@T1D3 + 4 a i
k
jjà
0
1
 f1
¢ @xD f2
¢@xD â xy
{
zz
2
A1@T1D A2@T1D A
1@T1D +
2 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A1@T1D A2@T1D A
1@T1D + 2 EI T1 s2 F i
k
jjà
0
1
 f2
¢@xD2 â xy
{
zz A
2@T1D +
3 a i
k
jjà
0
1
 f2
¢@xD2 â xy
{
zz
2
A2@T1D2 A
2@T1D + 2 I i
k
jjà
0
1
f2@xD2 â xy
{
zz w2 A2
¢@T1D == 0
Adding  linear viscous  damping  to  eqMod1  and  eqMod2  and  performing  integration  by  parts  yields  the  same  modulation
equations as obtained by directly attacking the partial-differential system.
 Combination Parametric Resonance of the Two Modes
ResonanceConds = Solve@8w2 == 3 w1 + e s1, W == w1 + w2 + e s2<, 8w2, W<D@@1DD
8w2 ﬁe s1 + 3 w1, W ﬁe s1 + e s2 + 4 w1<
Using ResonanceConds, we obtain the slowly varying terms from order1Lagr as
Chapter7.nb
227

TAL = order1Lagr . Exp@a_D :> Exp@Expand@a . ResonanceCondsD . e T0 -> T1D .
Exp@_ T0 + _.D -> 0 . int -> Integrate
-2 E-I T1 s2 F i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A1@T1D A2@T1D - 3
2
a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz
2
A1@T1D2 A
1@T1D
2 -
EI T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A2@T1D A
1@T1D
3 -
E-I T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A1@T1D3 A
2@T1D -
2 EI T1 s2 F i
k
jjà
0
1
 f1
¢ @xD f2
¢ @xD â xy
{
zz A
1@T1D A
2@T1D - 4 a i
k
jjà
0
1
 f1
¢ @xD f2
¢ @xD â xy
{
zz
2
A1@T1D A2@T1D A
1@T1D A
2@T1D -
2 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A1@T1D A2@T1D A
1@T1D A
2@T1D -
3
2
a i
k
jjà
0
1
 f2
¢@xD2 â xy
{
zz
2
A2@T1D2 A
2@T1D
2 -
I i
k
jjà
0
1
f1@xD2 â xy
{
zz w1 A
1@T1D A1
¢ @T1D - I i
k
jjà
0
1
f2@xD2 â xy
{
zz w2 A
2@T1D A2
¢ @T1D +
I i
k
jjà
0
1
f1@xD2 â xy
{
zz w1 A1@T1D A
1
¢ @T1D + I i
k
jjà
0
1
f2@xD2 â xy
{
zz w2 A2@T1D A
2
¢ @T1D
The Euler-Lagrange equations corresponding to the TAL can be written as
eqMod1 = DADATAL, A
1
¢ @T1DE, T1E - DATAL, A
1@T1DE == 0
3 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz
2
A1@T1D2 A
1@T1D + 3 EI T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f1
¢ @xD f2
¢@xD â xy
{
zz A2@T1D A
1@T1D
2 +
2 EI T1 s2 F i
k
jjà
0
1
 f1
¢ @xD f2
¢ @xD â xy
{
zz A
2@T1D + 4 a i
k
jjà
0
1
 f1
¢ @xD f2
¢ @xD â xy
{
zz
2
A1@T1D A2@T1D A
2@T1D +
2 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A1@T1D A2@T1D A
2@T1D + 2 I i
k
jjà
0
1
f1@xD2 â xy
{
zz w1 A1
¢ @T1D == 0
and
eqMod2 = DADATAL, A
2
¢ @T1DE, T1E - DATAL, A
2@T1DE == 0
E-I T1 s1 a i
k
jjà
0
1
 f1
¢ @xD2 â xy
{
zz i
k
jjà
0
1
 f1
¢@xD f2
¢ @xD â xy
{
zz A1@T1D3 +
2 EI T1 s2 F i
k
jjà
0
1
 f1
¢ @xD f2
¢ @xD â xy
{
zz A
1@T1D + 4 a i
k
jjà
0
1
 f1
¢ @xD f2
¢ @xD â xy
{
zz
2
A1@T1D A2@T1D A
1@T1D +
2 a i
k
jjà
0
1
 f1
¢@xD2 â xy
{
zz i
k
jjà
0
1
 f2
¢ @xD2 â xy
{
zz A1@T1D A2@T1D A
1@T1D +
3 a i
k
jjà
0
1
 f2
¢@xD2 â xy
{
zz
2
A2@T1D2 A
2@T1D + 2 I i
k
jjà
0
1
f2@xD2 â xy
{
zz w2 A2
¢@T1D == 0
Adding  linear viscous  damping  to  eqMod1  and  eqMod2  and  performing  integration  by  parts  yields  the  same  modulation
equations as obtained by directly attacking the partial-differential system.
228
Chapter7.nb

à 7.3 Cantilever Beam
 7.3.1 EOM and BC's
We  consider the  nonlinear nonplanar response of an  inextensional cantilever beam to  an  external excitation  of one of its
flexural modes. The lowest torsional frequencies  of the beam considered are much higher than the frequencies  of the excited
flexural modes  so that  the torsional inertia  can be neglected. We assume  that  the beam is  uniform and homogeneous. The
transverse deflections v@x, tD and w@x, tD of the beam at the position x and time t are governed by the nondimensional integral-
partial-differential equation (Crespo da Silva and Glynn, 1978)
EOM1 = 9¶t,tv@x, tD + by ¶x,x,x,xv@x, tD == -2 e m@xD ¶tv@x, tD + e H1 - byL
¶xJ¶x,x w@x, tD à
1
x
¶x,xv@x, tD ¶x,x w@x, tD âx - ¶x,x,x w@x, tD à
0
x
¶x,xv@x, tD ¶x w@x, tD â xN -
e
H1 - byL2

bg
¶x,xJ¶x,x w@x, tD à
0
x
à
1
x
¶x,xv@x, tD ¶x,x w@x, tD âx â xN -
e by ¶xH¶xv@x, tD ¶xH¶xv@x, tD ¶x,xv@x, tD + ¶xw@x, tD ¶x,x w@x, tDLL -
e 1
2
 ¶xJ¶xv@x, tD à
1
x
¶t,tJà
0
x
IH¶xv@x, tDL2 + H¶x w@x, tDL2M â xN âxN - e F@xD Cos@W tD,
¶t,t w@x, tD + ¶x,x,x,x w@x, tD == -2 e m@xD ¶t w@x, tD - e H1 - byL
¶xJ¶x,xv@x, tD à
1
x
¶x,xv@x, tD ¶x,x w@x, tD âx - ¶x,x,xv@x, tD à
0
x
¶x,x w@x, tD ¶xv@x, tD â xN -
e H1 - byL2

bg
¶x,xJ¶x,xv@x, tD à
0
x
à
1
x
¶x,xv@x, tD ¶x,x w@x, tD âx â xN -
e ¶xH¶x w@x, tD ¶xH¶xv@x, tD ¶x,xv@x, tD + ¶x w@x, tD ¶x,x w@x, tDLL -
e 1
2
 ¶xJ¶x w@x, tD à
1
x
¶t,tJà
0
x
IH¶xv@x, tDL2 + H¶x w@x, tDL2M â xN â xN=;
along with the homogeneous boundary conditions
BC1 = 8v@0, tD == 0, ¶xv@x, tD == 0 . x -> 0,
¶x,xv@x, tD == 0 . x -> 1, ¶x,x,xv@x, tD == 0 . x -> 1<
8v@0, tD == 0, vH1,0L@0, tD == 0, vH2,0L@1, tD == 0, vH3,0L@1, tD == 0<
BC = Join@BC1, BC1 . v -> wD
8v@0, tD == 0, vH1,0L@0, tD == 0, vH2,0L@1, tD == 0, vH3,0L@1, tD == 0,
w@0, tD == 0, wH1,0L@0, tD == 0, wH2,0L@1, tD == 0, wH3,0L@1, tD == 0<
The spatial derivatives outside the integrals  on the right-hand sides  of EOM1 result  in lengthy expressions. To simplify the
symbolic computation, we first define some operators as
Chapter7.nb
229

op1@v_, w_D = ¶x,x w@x, tD à
1
x
¶x,xv@x, tD ¶x,x w@x, tD âx -
¶x,x,x w@x, tD à
0
x
¶x,xv@x, tD ¶x w@x, tD âx . Integrate -> int@1D
int@1D@vH2,0L@x, tD wH2,0L@x, tD, 8x, 1, x<D wH2,0L@x, tD -
int@1D@wH1,0L@x, tD vH2,0L@x, tD, 8x, 0, x<D wH3,0L@x, tD
op2@v_, w_D =
HoldA¶x,x w@x, tD à
0
x
à
1
x
¶x,xv@x, tD ¶x,x w@x, tD â x âxE . Integrate -> int@2D  ReleaseHold
int@2D@vH2,0L@x, tD wH2,0L@x, tD, 8x, 0, x<, 8x, 1, x<D wH2,0L@x, tD
op3@v_, w_D = ¶xv@x, tD à
1
x
¶t,tJà
0
x
IH¶xv@x, tDL2 + H¶x w@x, tDL2M â xN âx . Integrate -> int@1D
int@1DB
int@1DB2 vH1,1L@x, tD
2 + 2 wH1,1L@x, tD
2 + 2 vH1,0L@x, tD vH1,2L@x, tD + 2 wH1,0L@x, tD wH1,2L@x, tD,
8x, 0, x<F, 8x, 1, x<F vH1,0L@x, tD
where  int@iD  indicates  the  whole  expression, including  the  integrand  and  the  term  multiplied by  int@iD@exprD,  will later  be
wrapped by the ith spatial derivative in the solvability condition.
Then we rewrite EOM1 as
EOM = 9¶t,tv@x, tD + by ¶x,x,x,xv@x, tD ==
-2 e m@xD ¶tv@x, tD + e H1 - byL op1@v, wD - e
H1 - byL2

bg
op2@v, wD -
e by ¶xH¶xv@x, tD ¶xH¶xv@x, tD ¶x,xv@x, tD + ¶xw@x, tD ¶x,x w@x, tDLL -
e 1
2
 op3@v, wD - e F@xD Cos@W tD, ¶t,t w@x, tD + ¶x,x,x,x w@x, tD ==
-2 e m@xD ¶tw@x, tD - e H1 - byL op1@w, vD - e
H1 - byL2

bg
op2@w, vD -
e ¶xH¶x w@x, tD ¶xH¶xv@x, tD ¶x,xv@x, tD + ¶x w@x, tD ¶x,x w@x, tDLL - e 1
2
 op3@w, vD=;
It follows from EOM1 and BC that the linear undamped natural frequencies  and their corresponding mode shapes  are given
by
9w‘
1,m == lm
2 " ## ##
by , w2,n == ln
2,
fi@xD == Cosh@ li xD - Cos@ li xD + Cos@ liD + Cosh@ liD


Sin@ liD + Sinh@ liD
HSin@ li xD - Sinh@ li xDL H* i=m,n *L=;
where w‘
1, m and w2, n  are the natural frequencies in the y and z directions and the li are the roots of
1 + Cos@liD Cosh@ liD == 0
230
Chapter7.nb

We consider the case of one-to-one internal resonance between the mth mode in the y or v direction and the nth mode in the
z or w direction; that is, w‘
1, m » w2, n . To express the nearness of these frequencies quantitatively, we let
betayRule = 8by -> 1 + d0 + e d1<;
so that w1, m = lm
2   !!!!!!!!!!!
1 +d0 = ln
2 = w2, n . The beam has a near-square  cross-section when d0 = 0. We assume neither of these
two  modes  is  involved  in  an  internal resonance  with  any  other mode. Moreover,  we  consider a primary  resonance  of the
flexural mode in the y direction.
To manipulate some complicated integrals, we define the following rules:
intRule3 = 8int@i_D@fun_, arg2__D :> int@iD@Expand@funD, arg2D<;
intRule4 = 8int@i_D@a_ + b_, arg2__D :> int@iD@a, arg2D + int@iD@b, arg2D,
int@i_D@en_. fun_, arg2__D :> en int@iD@fun, arg2D,
int@i_D@a_ fun_, a1_, b1___D :> a int@iD@fun, a1, b1D ; FreeQ@a, First@a1DD,
int@i_D@int@i_D@a1_, a2_D fun_., a3__D :> int@iD@a1, a2D int@iD@fun, a3D ;
FreeQ@Rest@a2D, First@a2DD, int@i_D@int@i_D@a1_, a2_D, a3__D :> int@iD@a1, a3, a2D<;
 7.3.2 Direct Attack of the Continuous Problem
In this section, we directly attack the integral-partial-differential equation EOM and associated boundary  conditions BC and
seek a first-order uniform expansion of their solution in the form
solRule = 9v -> IEvaluateASumAej vj@#1, #2, #3D, 8j, 0, 1<EE &M,
w -> IEvaluateASumAej wj@#1, #2, #3D, 8j, 0, 1<EE &M=
8v ﬁHv0@#1, #2, #3D + e v1@#1, #2, #3D &L, w ﬁHw0@#1, #2, #3D + e w1@#1, #2, #3D &L<
where the first independent variable stands for x and the last two independent variables stand for the two time scales T0 and
T1. Transforming the total time derivatives in EOM into partial derivatives in terms  of T0 and T1, substituting the solRule and
betayRule into EOM and BC, expanding the  result  for small e, discarding  terms  of order higher than  e, and using intRule3
and intRule4 to simplify the expansions of the integrands, we obtain
Ieq732a =
HHJoin@EOM, BCD . 8v@x_, tD -> v@x, T0, T1D, w@x_, tD -> w@x, T0, T1D, Derivative@m_, n_D@
w_D@x_, tD -> dt@nD@D@w@x, T0, T1D, 8x, m<DD, t -> T0< .
solRule . betayRule  ExpandAllL . intRule3 .
intRule4  ExpandAllL . en_;n>1 -> 0;M  Timing
812.629 Second, Null<
Equating coefficients of like powers of e in eq732a, we obtain
eqEps = Thread@CoefficientList@Subtract  #, eD == 0D &  eq732a  Transpose;
Chapter7.nb
231

eqEps@@1DD . displayRule
9v0
'''' + D0
2v0 + Hv0
''''L d0 == 0, w0
'''' + D0
2w0 == 0, v0@0, T0, T1D == 0,
v0
H1,0,0L@0, T0, T1D == 0, v0
H2,0,0L@1, T0, T1D == 0, v0
H3,0,0L@1, T0, T1D == 0,
w0@0, T0, T1D == 0, w0
H1,0,0L@0, T0, T1D == 0, w0
H2,0,0L@1, T0, T1D == 0, w0
H3,0,0L@1, T0, T1D == 0=
In the  presence of damping, all modes  that  are not directly excited by  the forcing or indirectly excited by  the internal reso-
nance will decay with time. Hence, the solution of eqEps[[1]] can be expressed in terms of the two excited linear free-vibration
modes; that is,
sol0 = 9v0 -> FunctionA8x, T0, T1<, A1@T1D fm@xD Exp@I w1,m T0D + A
1@T1D fm@xD Exp@-I w1,m T0DE,
w0 -> FunctionA8x, T0, T1<, A2@T1D fn@xD Exp@I w2,n T0D + A
2@T1D fn@xD Exp@-I w2,n T0DE=;
One can easily show that the mode shapes fi@xD are orthogonal. We assume that these modes are normalized so that
Ù0
1fi@xD fj@xD â x -> dij
where dij is the Kronecker delta function.
Substituting sol0 into the first-order equations, eqEps[[2,1]] and eqEps[[2,2]], and using intRule3 and intRule4, we obtain
Clear@order1EqD
order1Eq@1D = HeqEps@@1, 1, 1DD . v0 -> v1L ==
HHeqEps@@1, 1, 1DD . v0 -> v1L - HSubtract  eqEps@@2, 1DD . sol0  TrigToExp 
ExpandL . intRule3 . intRule4  ExpandL;
order1Eq@2D = HeqEps@@1, 2, 1DD . w0 -> w1L ==
HHeqEps@@1, 2, 1DD . w0 -> w1L - HSubtract  eqEps@@2, 2DD . sol0  TrigToExp 
ExpandL . intRule3 . intRule4  ExpandL;
It follows from eqEps[[2]] that the first-order boundary conditions are
order1BC = Drop@eqEps@@2DD, 2D
9v1@0, T0, T1D == 0, v1
H1,0,0L@0, T0, T1D == 0, v1
H2,0,0L@1, T0, T1D == 0, v1
H3,0,0L@1, T0, T1D == 0,
w1@0, T0, T1D == 0, w1
H1,0,0L@0, T0, T1D == 0, w1
H2,0,0L@1, T0, T1D == 0, w1
H3,0,0L@1, T0, T1D == 0=
We consider the case of primary resonance of the flexural mode in the y direction, W » w1, m. To describe the nearness of the
primary resonance, we introduce the detuning parameter s by
omgList = 8w1,m, w2,n<;
ResonanceConds = 8w2,n == w1,m, W == w1,m + e s<;
and define the following rules:
232
Chapter7.nb

OmgRule = Solve@ResonanceConds, Drop@omgList, 8#<D ~Join~ 8W<D@@1DD &  81, 2<
88w2,n ﬁw1,m, W ﬁe s + w1,m<, 8w1,m ﬁw2,n, W ﬁe s + w2,n<<
expRule@i_D := Exp@arg_D :> Exp@Expand@arg . OmgRule@@iDDD . e T0 -> T1D
We substitute  ResonanceConds  into the  right-hand side of order1Eq[1] and  order1Eq[2] and obtain  the source of secular
terms as
ST = Table@Coefficient@order1Eq@iD@@2DD . expRule@iD, Exp@I omgList@@iDD T0DD, 8i, 2<D;
The solvability conditions of order1Eq[i] and order1BC demand that ST[[i]] be orthogonal to fi@xD. Imposing these condi-
tions, we have
SCond1 = int@fm@xD ST@@1DD, 8x, 0, 1<D == 0 . intRule1 . intRule2;
SCond2 = int@fn@xD ST@@2DD, 8x, 0, 1<D == 0 . intRule1 . intRule2;
Recall that the ith spatial derivative should be recovered back from int@iD as stated in the preceding section. Hence, we define
intRule5@mode_D =
int@mode a_ int@i_D@b_, c__D, d_D :> int@mode HoldForm@D@a int@b, cD, 8x, i<DD, dD;
and rewrite SCond1 and SCond2 as
SCond = 8SCond1 . intRule5@fm@xDD, SCond2 . intRule5@fn@xDD<;
To simplify the notation in the solvability conditions, we use the orthonormality of the mode shapes and define the following
parameters:
notationRule = 9intAfi_@xD2, 8x, 0, 1<E -> 1, intAfi_@xD fi_
H4L@xD, 8x, 0, 1<E -> li
4,
intAm@xD fi_@xD2, 8x, 0, 1<E -> mi, int@F@xD fi_@xD, 8x, 0, 1<D -> w1,i f=;
To  identify the  forms  of the nonlinear terms  in  the solvability  conditions, we  first identify  all of the possible  forms  of the
nonhomogeneous terms in the first-order problem. To this end, we let
basicTerms = TableA9Ai@T1D EI omgList@@iDD T0, A
i@T1D E-I omgList@@iDD T0=, 8i, 2<E  Flatten
8EI T0 w1,m A1@T1D, E-I T0 w1,m A
1@T1D, EI T0 w2,n A2@T1D, E-I T0 w2,n A
2@T1D<
Then, all of the possible forms of the nonlinear terms in the first-order problem are given by
cubicTerms = Nest@Outer@Times, basicTerms, #D &, basicTerms, 2D  Flatten  Union;
cubicTerms . displayRule
:E3 I T0 w1,m A1
3, EI T0 H2 w1,m+w2,nL A1
2 A2, EI T0 Hw1,m+2 w2,nL A1 A2
2, E3 I T0 w2,n A2
3, EI T0 w1,m A1
2 A
1,
EI T0 w2,n A1 A2 A
1, EI T0 H-w1,m+2 w2,nL A2
2 A
1, E-I T0 w1,m A1 A
1
2, EI T0 H-2 w1,m+w2,nL A2 A
1
2, E-3 IT0 w1,m A
1
3,
EI T0 H2 w1,m-w2,nL A1
2 A
2, EI T0 w1,m A1 A2 A
2, EI T0 w2,n A2
2 A
2, E-I T0 w2,n A1 A
1 A
2, E-I T0 w1,m A2 A
1 A
2,
EI T0 H-2 w1,m-w2,nL A
1
2 A
2, EI T0 Hw1,m-2 w2,nL A1 A
2
2, E-I T0 w2,n A2 A
2
2, EI T0 H-w1,m-2 w2,nL A
1 A
2
2, E-3 I T0 w2,n A
2
3>
Chapter7.nb
233

Out of these terms, only the terms  that may lead to secular terms  appear in the solvability conditions, which can be identified
according to
secularTerms =
IE-I omgList@@#DD T0 cubicTerms . expRule@#D . Exp@_ T0 + _.D -> 0  Union  RestM &  81, 2<
88A1@T1D2 A
1@T1D, A1@T1D A2@T1D A
1@T1D, A2@T1D2 A
1@T1D, A1@T1D2 A
2@T1D,
A1@T1D A2@T1D A
2@T1D, A2@T1D2 A
2@T1D<, 8A1@T1D2 A
1@T1D, A1@T1D A2@T1D A
1@T1D,
A2@T1D2 A
1@T1D, A1@T1D2 A
2@T1D, A1@T1D A2@T1D A
2@T1D, A2@T1D2 A
2@T1D<<
Next, we define the following parameters:
coef = Table@Coefficient@SCond@@i, 1DD, secularTerms@@iDDD, 8i, 2<D  Collect@#, d0D &;
Clear@symbolListD
symbolList@1D = MapIndexed@If@#1 =!= 0, 8 w1,m a1,#2@@1DD, 0D &, coef@@1DDD
88 a1,1 w1,m, 0, 8 a1,3 w1,m, 0, 8 a1,5 w1,m, 0<
symbolList@2D = MapIndexed@If@#1 =!= 0, 8 w2,n a2,#2@@1DD, 0D &, coef@@2DDD
80, 8 a2,2 w2,n, 0, 8 a2,4 w2,n, 0, 8 a2,6 w2,n<
and express SCond in a more concise form as
eqMod =
ExpandA-
1

omgList@@#DD
 HHSCond@@#, 1DD . notationRule . Thread@secularTerms@@#DD -> 0DL +
symbolList@#D.secularTerms@@#DDLE == 0 &  81, 2<
: 1
2
EI T1 s f + 2 I mm A1@T1D + d1 lm
4 A1@T1D

w1,m
- 8 a1,1 A1@T1D2 A
1@T1D -
8 a1,3 A2@T1D2 A
1@T1D - 8 a1,5 A1@T1D A2@T1D A
2@T1D + 2 I A1
¢ @T1D == 0, 2 I mn A2@T1D -
8 a2,2 A1@T1D A2@T1D A
1@T1D - 8 a2,4 A1@T1D2 A
2@T1D - 8 a2,6 A2@T1D2 A
2@T1D + 2 I A2
¢@T1D == 0>
where
234
Chapter7.nb

HsymbolList@1D -> coef@@1DD  Thread  Union  RestL . int -> Integrate  Timing
:29.683 Second, :8 a1,1 w1,m ﬁ
-3 à
0
1
 fm@xD fm
†@xD3 â x - 12 à
0
1
 fm@xD fm
¢ @xD fm
†@xD fm
H3L@xD â x - 3 à
0
1
 fm@xD fm
¢ @xD2 fm
H4L@xD â x +
i
k
jj-3 à
0
1
 fm@xD fm
†@xD3 â x - 12 à
0
1
 fm@xD fm
¢ @xD fm
†@xD fm
H3L@xD â x - 3 à
0
1
 fm@xD fm
¢ @xD2 fm
H4L@xD â xy
{
zz d0 +
2 i
k
jjà
0
1
 ¶8x,1< Jfm
¢ @xD à
1
x
 à
0
x
 fm
¢ @xD2 â x â xN fm@xD â xy
{
zz w1,m
2
,
8 a1,3 w1,m ﬁ-à
0
1
 fm@xD fm
† @xD fn
†@xD2 â x - à
0
1
 fm@xD fn
¢@xD fm
† @xD fn
H3L@xD â x -
3 à
0
1
 fm@xD fm
¢ @xD fn
†@xD fn
H3L@xD â x - à
0
1
 fm@xD fm
¢ @xD fn
¢ @xD fn
H4L@xD â x +
i
k
jjà
0
1
 ¶8x,1< Jfn
H3L@xD à
0
x
 fn
¢ @xD fm
† @xD â xN fm@xD â x - à
0
1
 ¶8x,1< Jfn
†@xD à
1
x
 fm
† @xD fn
†@xD â xN fm@xD â x -
à
0
1
 fm@xD fm
† @xD fn
†@xD2 â x - à
0
1
 fm@xD fn
¢ @xD fm
†@xD fn
H3L@xD â x -
3 à
0
1
 fm@xD fm
¢ @xD fn
†@xD fn
H3L@xD â x - à
0
1
 fm@xD fm
¢ @xD fn
¢ @xD fn
H4L@xD â xy
{
zz d0 -
IÙ0
1 ¶8x,2< Hfn
†@xD Ù0
x Ù1
x fm
† @xD fn
†@xD â x â xL fm@xD â xM d0
2




bg
+
2 i
k
jjà
0
1
 ¶8x,1< Jfm
¢ @xD à
1
x
 à
0
x
 fn
¢@xD2 â x â xN fm@xD â xy
{
zz w2,n
2
,
8 a1,5 w1,m ﬁ-2 à
0
1
 fm@xD fm
† @xD fn
†@xD2 â x - 2 à
0
1
 fm@xD fn
¢@xD fm
†@xD fn
H3L@xD â x -
6 à
0
1
 fm@xD fm
¢ @xD fn
†@xD fn
H3L@xD â x - 2 à
0
1
 fm@xD fm
¢ @xD fn
¢ @xD fn
H4L@xD â x +
i
k
jj2 à
0
1
 ¶8x,1< Jfn
H3L@xD à
0
x
 fn
¢@xD fm
† @xD â xN fm@xD â x - 2 à
0
1
 ¶8x,1< Jfn
†@xD à
1
x
 fm
† @xD fn
†@xD â xN fm@xD 
â x - 2 à
0
1
 fm@xD fm
†@xD fn
†@xD2 â x - 2 à
0
1
 fm@xD fn
¢@xD fm
† @xD fn
H3L@xD â x -
6 à
0
1
 fm@xD fm
¢ @xD fn
†@xD fn
H3L@xD â x - 2 à
0
1
 fm@xD fm
¢ @xD fn
¢ @xD fn
H4L@xD â xy
{
zz d0 -
2 IÙ0
1 ¶8x,2< Hfn
†@xD Ù0
x Ù1
x fm
† @xD fn
†@xD â x â xL fm@xD â xM d0
2




bg
>>
Chapter7.nb
235

HsymbolList@2D -> coef@@2DD  Thread  Union  RestL . int -> Integrate  Timing
:22.282 Second, :8 a2,2 w2,n ﬁ-2 à
0
1
 fn@xD fm
† @xD2 fn
†@xD â x -
6 à
0
1
 fn@xD fn
¢ @xD fm
† @xD fm
H3L@xD â x - 2 à
0
1
 fn@xD fm
¢ @xD fn
†@xD fm
H3L@xD â x -
2 à
0
1
 fn@xD fm
¢ @xD fn
¢ @xD fm
H4L@xD â x + i
k
jj-2 à
0
1
 ¶8x,1< Jfm
H3L@xD à
0
x
 fm
¢ @xD fn
†@xD â xN fn@xD â x +
2 à
0
1
 ¶8x,1< Jfm
† @xD à
1
x
 fm
† @xD fn
†@xD â xN fn@xD â xy
{
zz d0 -
2 IÙ0
1 ¶8x,2< Hfm
†@xD Ù0
x Ù1
x fm
† @xD fn
†@xD â x â xL fn@xD â xM d0
2




bg
, 8 a2,4 w2,n ﬁ
-à
0
1
 fn@xD fm
†@xD2 fn
†@xD â x - 3 à
0
1
 fn@xD fn
¢ @xD fm
† @xD fm
H3L@xD â x - à
0
1
 fn@xD fm
¢ @xD fn
†@xD fm
H3L@xD â x -
à
0
1
 fn@xD fm
¢ @xD fn
¢ @xD fm
H4L@xD â x + i
k
jj-à
0
1
 ¶8x,1< Jfm
H3L@xD à
0
x
 fm
¢ @xD fn
†@xD â xN fn@xD â x +
à
0
1
 ¶8x,1< Jfm
† @xD à
1
x
 fm
† @xD fn
†@xD â xN fn@xD â xy
{
zz d0 -
IÙ0
1 ¶8x,2< Hfm
†@xD Ù0
x Ù1
x fm
† @xD fn
†@xD â x â xL fn@xD â xM d0
2




bg
+
2 i
k
jjà
0
1
 ¶8x,1< Jfn
¢ @xD à
1
x
 à
0
x
 fm
¢ @xD2 â x â xN fn@xD â xy
{
zz w1,m
2
,
8 a2,6 w2,n ﬁ-3 à
0
1
 fn@xD fn
†@xD3 â x - 12 à
0
1
 fn@xD fn
¢ @xD fn
†@xD fn
H3L@xD â x -
3 à
0
1
 fn@xD fn
¢ @xD2 fn
H4L@xD â x + 2 i
k
jjà
0
1
 ¶8x,1< Jfn
¢ @xD à
1
x
 à
0
x
 fn
¢@xD2 â x â xN fn@xD â xy
{
zz w2,n
2
>>
Modulation Equations in Polar Form
Using eqMod and the function PolarForm defined in the preceding section, we obtain the modulation equations in polar form
and the definitions for gi as
PolarForm@eqModD
::a1
¢ @T1D == 1
2
H-f Sin@g1@T1DD - 2 mm a1@T1D + 2 Sin@g2@T1DD a1,3 a1@T1D a2@T1D2L,
a2
¢ @T1D == -mn a2@T1D - Sin@g2@T1DD a2,4 a1@T1D2 a2@T1D,
g2
¢@T1D == - d1 lm
4

w1,m
- f Cos@g1@T1DD

a1@T1D
+ 2 a1,1 a1@T1D2 - 2 a2,2 a1@T1D2 -
2 Cos@g2@T1DD a2,4 a1@T1D2 + 2 Cos@g2@T1DD a1,3 a2@T1D2 + 2 a1,5 a2@T1D2 - 2 a2,6 a2@T1D2,
g1
¢@T1D == s - d1 lm
4

2 w1,m
- f Cos@g1@T1DD

2 a1@T1D
+ a1,1 a1@T1D2 + Cos@g2@T1DD a1,3 a2@T1D2 + a1,5 a2@T1D2>,
8g1@T1D == T1 s - b1@T1D, g2@T1D == -2 b1@T1D + 2 b2@T1D<>
236
Chapter7.nb

Modulation Equations in Cartesian Form and Symmetry Property
Using  eqMod and  the  function  CartesianForm  defined  in  the  preceding  section,  we  obtain  the  modulation  equations  in
Cartesian form, the definitions for ni, and the symmetry property as
CartesianForm@eqModD
::p1
¢ @T1D == -mm p1@T1D - n1 q1@T1D + d1 lm
4 q1@T1D

2 w1,m
-
a1,1 p1@T1D2 q1@T1D + a1,3 p2@T1D2 q1@T1D - a1,5 p2@T1D2 q1@T1D - a1,1 q1@T1D3 -
2 a1,3 p1@T1D p2@T1D q2@T1D - a1,3 q1@T1D q2@T1D2 - a1,5 q1@T1D q2@T1D2, q1
¢@T1D ==
- f
2
+ n1 p1@T1D - d1 lm4 p1@T1D

2 w1,m
+ a1,1 p1@T1D3 + a1,3 p1@T1D p2@T1D2 + a1,5 p1@T1D p2@T1D2 - mm q1@T1D+
a1,1 p1@T1D q1@T1D2 + 2 a1,3 p2@T1D q1@T1D q2@T1D - a1,3 p1@T1D q2@T1D2 + a1,5 p1@T1D q2@T1D2,
p2
¢ @T1D == -mn p2@T1D - 2 a2,4 p1@T1D p2@T1D q1@T1D - n2 q2@T1D - a2,2 p1@T1D2 q2@T1D +
a2,4 p1@T1D2 q2@T1D - a2,6 p2@T1D2 q2@T1D - a2,2 q1@T1D2 q2@T1D - a2,4 q1@T1D2 q2@T1D - a2,6 q2@T1D3,
q2
¢ @T1D == n2 p2@T1D + a2,2 p1@T1D2 p2@T1D + a2,4 p1@T1D2 p2@T1D + a2,6 p2@T1D3 + a2,2 p2@T1D q1@T1D2 -
a2,4 p2@T1D q1@T1D2 - mn q2@T1D + 2 a2,4 p1@T1D q1@T1D q2@T1D + a2,6 p2@T1D q2@T1D2>,
8n1 ﬁs, n2 ﬁs<, 88p1, q1, p2, q2<, 8p1, q1, -p2, -q2<<>
 7.3.3 Discretization of the Continuous Problem
As  an  alternative,  we  apply  the  method  of multiple  scales  to  the  discretized  system  of EOM and  BC. To  determine  the
discretized form, we express v@x, tD and w@x, tD in terms of the linear mode shapes fm@xD and fn @xD, respectively, as
discretRule = 8v -> Function@8x, t<, qm@tD fm@xDD, w -> Function@8x, t<, qn@tD fn@xDD<;
modes = 8fm@xD, fn@xD<;
where  the qi@tD are  the generalized  coordinates. We  consider only  qm@tD and  qn @tD because in  the presence  of damping, all
other modes  that are not directly or indirectly excited decay with time. Substituting discretRule into each of EOM, multiply-
ing the results with fm@xD and fn @xD, respectively, and integrating the outcome  from x = 0 to x = 1 using intRule3, intRule4,
intRule1, intRule2, and intRule5, we obtain  the following discretized form of the equations describing the response of the
beam:
eq733a =
Table@int@modes@@kDD # . discretRule, 8x, 0, 1<D . intRule3 . intRule4 . intRule1 .
intRule2 . intRule5@modes@@kDDD .
int@a_, b__D -> HoldForm@Integrate@a, bDD &  EOM@@kDD, 8k, 2<D
:i
k
jjà
0
1
 fm@xD fm
H4L@xD â xy
{
zz by qm@tD + i
k
jjà
0
1
fm@xD2 â xy
{
zz qm
†@tD ==
-e Cos@t WD à
0
1
F@xD fm@xD â x - e i
k
jjà
0
1
 fm@xD fm
† @xD3 â xy
{
zz by qm@tD3 -
Chapter7.nb
237

4 e i
k
jjà
0
1
 fm@xD fm
¢ @xD fm
† @xD fm
H3L@xD â xy
{
zz by qm@tD3 - e i
k
jjà
0
1
 fm@xD fm
¢ @xD2 fm
H4L@xD â xy
{
zz by qm@tD3 -
e i
k
jjà
0
1
 ¶8x,1< Jfn
H3L@xD à
0
x
 fn
¢@xD fm
† @xD â xN fm@xD â xy
{
zz qm@tD qn@tD2 +
e i
k
jjà
0
1
 ¶8x,1< Jfn
†@xD à
1
x
 fm
† @xD fn
†@xD â xN fm@xD â xy
{
zz qm@tD qn@tD2 +
e i
k
jjà
0
1
 ¶8x,1< Jfn
H3L@xD à
0
x
 fn
¢@xD fm
† @xD â xN fm@xD â xy
{
zz by qm@tD qn@tD2 -
e i
k
jjà
0
1
 ¶8x,1< Jfn
†@xD à
1
x
 fm
† @xD fn
†@xD â xN fm@xD â xy
{
zz by qm@tD qn@tD2 -
e i
k
jjà
0
1
 fm@xD fm
† @xD fn
†@xD2 â xy
{
zz by qm@tD qn@tD2 -
e i
k
jjà
0
1
 fm@xD fn
¢ @xD fm
† @xD fn
H3L@xD â xy
{
zz by qm@tD qn@tD2 - 3 e i
k
jjà
0
1
 fm@xD fm
¢ @xD fn
†@xD fn
H3L@xD â xy
{
zz
by qm@tD qn@tD2 - e i
k
jjà
0
1
 fm@xD fm
¢ @xD fn
¢@xD fn
H4L@xD â xy
{
zz by qm@tD qn@tD2 -
e IÙ0
1 ¶8x,2< Hfn
†@xD Ù0
x Ù1
x fm
† @xD fn
†@xD â x â xL fm@xD â xM qm@tD qn@tD2





bg
+
2 e IÙ0
1 ¶8x,2< Hfn
†@xD Ù0
x Ù1
x fm
† @xD fn
†@xD â x â xL fm@xD â xM by qm@tD qn@tD2





bg
-
e IÙ0
1 ¶8x,2< Hfn
†@xD Ù0
x Ù1
x fm
† @xD fn
†@xD â x â xL fm@xD â xM by
2 qm@tD qn@tD2





bg
-
2 e i
k
jjà
0
1
m@xD fm@xD2 â xy
{
zz qm
¢ @tD - e i
k
jjà
0
1
 ¶8x,1< Jfm
¢ @xD à
1
x
 à
0
x
 fm
¢ @xD2 â x â xN fm@xD â xy
{
zz qm@tD qm
¢ @tD2 -
e i
k
jjà
0
1
 ¶8x,1< Jfm
¢ @xD à
1
x
 à
0
x
 fn
¢@xD2 â x â xN fm@xD â xy
{
zz qm@tD qn
¢ @tD2 -
e i
k
jjà
0
1
 ¶8x,1< Jfm
¢ @xD à
1
x
 à
0
x
 fm
¢ @xD2 â x â xN fm@xD â xy
{
zz qm@tD2 qm
†@tD -
e i
k
jjà
0
1
 ¶8x,1< Jfm
¢ @xD à
1
x
 à
0
x
 fn
¢@xD2 â x â xN fm@xD â xy
{
zz qm@tD qn@tD qn
†@tD,
i
k
jjà
0
1
 fn@xD fn
H4L@xD â xy
{
zz qn@tD + i
k
jjà
0
1
fn@xD2 â xy
{
zz qn
†@tD ==
e i
k
jjà
0
1
 ¶8x,1< Jfm
H3L@xD à
0
x
 fm
¢ @xD fn
†@xD â xN fn@xD â xy
{
zz qm@tD2 qn@tD -
e i
k
jjà
0
1
 ¶8x,1< Jfm
† @xD à
1
x
 fm
† @xD fn
†@xD â xN fn@xD â xy
{
zz qm@tD2 qn@tD -
e i
k
jjà
0
1
 fn@xD fm
† @xD2 fn
†@xD â xy
{
zz qm@tD2 qn@tD - 3 e i
k
jjà
0
1
 fn@xD fn
¢ @xD fm
†@xD fm
H3L@xD â xy
{
zz qm@tD2 qn@tD -
e i
k
jjà
0
1
 fn@xD fm
¢ @xD fn
†@xD fm
H3L@xD â xy
{
zz qm@tD2 qn@tD -
e i
k
jjà
0
1
 fn@xD fm
¢ @xD fn
¢ @xD fm
H4L@xD â xy
{
zz qm@tD2 qn@tD -
e i
k
jjà
0
1
 ¶8x,1< Jfm
H3L@xD à
0
x
 fm
¢ @xD fn
†@xD â xN fn@xD â xy
{
zz by qm@tD2 qn@tD +
238
Chapter7.nb

e i
k
jjà
0
1
 ¶8x,1< Jfm
† @xD à
1
x
 fm
† @xD fn
†@xD â xN fn@xD â xy
{
zz by qm@tD2 qn@tD -
e IÙ0
1 ¶8x,2< Hfm†@xD Ù0
x Ù1
x fm† @xD fn†@xD â x â xL fn@xD â xM qm@tD2 qn@tD





bg
+
2 e IÙ0
1 ¶8x,2< Hfm†@xD Ù0
x Ù1
x fm† @xD fn†@xD â x â xL fn@xD â xM by qm@tD2 qn@tD





bg
-
e IÙ0
1 ¶8x,2< Hfm
†@xD Ù0
x Ù1
x fm
† @xD fn
†@xD â x â xL fn@xD â xM by
2 qm@tD2 qn@tD





bg
-
e i
k
jjà
0
1
 fn@xD fn
†@xD3 â xy
{
zz qn@tD3 - 4 e i
k
jjà
0
1
 fn@xD fn
¢@xD fn
†@xD fn
H3L@xD â xy
{
zz qn@tD3 -
e i
k
jjà
0
1
 fn@xD fn
¢ @xD2 fn
H4L@xD â xy
{
zz qn@tD3 -
e i
k
jjà
0
1
 ¶8x,1< Jfn
¢ @xD à
1
x
 à
0
x
 fm
¢ @xD2 â x â xN fn@xD â xy
{
zz qn@tD qm
¢ @tD2 -
2 e i
k
jjà
0
1
m@xD fn@xD2 â xy
{
zz qn
¢@tD - e i
k
jjà
0
1
 ¶8x,1< Jfn
¢@xD à
1
x
 à
0
x
 fn
¢ @xD2 â x â xN fn@xD â xy
{
zz qn@tD qn
¢@tD2 -
e i
k
jjà
0
1
 ¶8x,1< Jfn
¢ @xD à
1
x
 à
0
x
 fm
¢ @xD2 â x â xN fn@xD â xy
{
zz qm@tD qn@tD qm
†@tD -
e i
k
jjà
0
1
 ¶8x,1< Jfn
¢ @xD à
1
x
 à
0
x
 fn
¢@xD2 â x â xN fn@xD â xy
{
zz qn@tD2 qn
†@tD>
where the damping is assumed to be modal. Using the orthonormality of the mode shapes fi@xD, we define
notationRule = 9intAfi_@xD2, 8x, 0, 1<E -> 1, intAfi_@xD fi_
H4L@xD, 8x, 0, 1<E -> li
4,
intAm@xD fi_@xD2, 8x, 0, 1<E -> mi, int@F@xD fi_@xD, 8x, 0, 1<D -> w1,i f= .
int@a_, b__D -> HoldForm@Integrate@a, bDD
:à
0
1
fi_@xD2 â x ﬁ1, à
0
1
 fi_@xD fi_
H4L@xD â x ﬁli
4, à
0
1
m@xD fi_@xD2 â x ﬁmi, à
0
1
F@xD fi_@xD â x ﬁf w1,i>
To simplify the expression for eq733a, we first find possible nonlinear terms as follows:
basicTerms = Table@D@qm@tD, 8t, i<D, 8i, 0, 2<D
8qm@tD, qm
¢ @tD, qm
† @tD<
linearTerms = Join@basicTerms, basicTerms . m -> nD
8qm@tD, qm
¢ @tD, qm
† @tD, qn@tD, qn
¢@tD, qn
†@tD<
cubicTerms = e Nest@Outer@Times, linearTerms, #D &, linearTerms, 2D  Flatten  Union;
The coefficients corresponding to cubicTerms in eq733a are obtained as
coefList = Coefficient@eq733a@@#, 2DD, cubicTermsD &  81, 2<;
We replace these coefficients by ai, j as
Chapter7.nb
239

symbolList = MapIndexed@If@#1 =!= 0, aSequence #2, 0D &, coefList, 82<D;
Using notationRule, symbolList, and cubicTerms, we can rewrite eq733a as
EOM1 = Table@eq733a@@k, 1DD == Heq733a@@k, 2DD . Thread@cubicTerms -> 0DL +
symbolList@@kDD.cubicTerms . notationRule, 8k, 2<D
8by lm
4 qm@tD + qm
† @tD == -f e Cos@t WD w1,m + e a1,1 qm@tD3 + e a1,3 qm@tD qn@tD2 - 2 e mm qm
¢ @tD +
e a1,8 qm@tD qm
¢ @tD2 + e a1,17 qm@tD qn
¢ @tD2 + e a1,21 qm@tD2 qm
†@tD + e a1,37 qm@tD qn@tD qn
†@tD,
ln
4 qn@tD + qn
†@tD == e a2,2 qm@tD2 qn@tD + e a2,4 qn@tD3 + e a2,9 qn@tD qm
¢ @tD2 -
2 e mn qn
¢ @tD + e a2,18 qn@tD qn
¢ @tD2 + e a2,22 qm@tD qn@tD qm
†@tD + e a2,38 qn@tD2 qn
†@tD<
Using the method of multiple scales, we seek a first-order uniform expansion in the form
solRule = qn_ ->
i
k
jjjjjâ
j=0
1
ej qn,j@#1, #2D &
y
{
zzzzz;
Transforming the total time derivatives  in EOM1 into partial derivatives  in terms  of T0  and T1, substituting the solRule and
betayRule into EOM1, expanding the result for small e, and discarding terms of order higher than e, we obtain
eq733b = HEOM1 . 8qs_@tD -> qs@T0, T1D, Derivative@n_D@qs_D@tD -> dt@nD@qs@T0, T1DD, t -> T0< .
solRule . betayRule  ExpandAllL . en_;n>1 -> 0;
Equating coefficients of like powers of e in eq733b, we obtain
eqEps = Thread@CoefficientList@Subtract  #, eD == 0D &  eq733b  Transpose
:9lm
4 qm,0@T0, T1D + d0 lm
4 qm,0@T0, T1D + qm,0
H2,0L@T0, T1D == 0, ln
4 qn,0@T0, T1D + qn,0
H2,0L@T0, T1D == 0=,
:f Cos@T0 WD w1,m + d1 lm
4 qm,0@T0, T1D - a1,1 qm,0@T0, T1D3 + lm
4 qm,1@T0, T1D + d0 lm
4 qm,1@T0, T1D-
a1,3 qm,0@T0, T1D qn,0@T0, T1D2 + 2 mm qm,0
H1,0L@T0, T1D - a1,8 qm,0@T0, T1D qm,0
H1,0L@T0, T1D
2
-
a1,17 qm,0@T0, T1D qn,0
H1,0L@T0, T1D
2 + 2 qm,0
H1,1L@T0, T1D - a1,21 qm,0@T0, T1D2 qm,0
H2,0L@T0, T1D +
qm,1
H2,0L@T0, T1D - a1,37 qm,0@T0, T1D qn,0@T0, T1D qn,0
H2,0L@T0, T1D == 0,
-a2,2 qm,0@T0, T1D2 qn,0@T0, T1D - a2,4 qn,0@T0, T1D3 + ln
4 qn,1@T0, T1D -
a2,9 qn,0@T0, T1D qm,0
H1,0L@T0, T1D
2 + 2 mn qn,0
H1,0L@T0, T1D - a2,18 qn,0@T0, T1D qn,0
H1,0L@T0, T1D
2 +
2 qn,0
H1,1L@T0, T1D - a2,22 qm,0@T0, T1D qn,0@T0, T1D qm,0
H2,0L@T0, T1D -
a2,38 qn,0@T0, T1D2 qn,0
H2,0L@T0, T1D + qn,1
H2,0L@T0, T1D == 0>>
Then it follows from eqEps[[1]] that
sol0 = 9qm,0 -> FunctionA8T0, T1<, A1@T1D Exp@I w1,m T0D + A
1@T1D Exp@-I w1,m T0DE,
qn,0 -> FunctionA8T0, T1<, A2@T1D Exp@I w2,n T0D + A
2@T1D Exp@-I w2,n T0DE=;
Substituting sol0 into eqEps[[2]] yields
order1Eq = H#@@1DD &  eqEps@@1DD . qk_,0 -> qk,1L == H#@@1DD &  eqEps@@1DD . qk_,0 -> qk,1L -
H#@@1DD &  eqEps@@2DDL . sol0  TrigToExp  ExpandAll  Thread;
240
Chapter7.nb

We consider the case of primary resonance of the flexural mode in the y direction, W » w1, m. To describe the nearness of the
primary resonance, we introduce the detuning parameter s and define
omgList = 8w1,m, w2,n<;
ResonanceConds = 8w2,n == w1,m, W == w1,m + e s<;
OmgRule = Solve@ResonanceConds, Drop@omgList, 8#<D ~Join~ 8W<D@@1DD &  81, 2<
88w2,n ﬁw1,m, W ﬁe s + w1,m<, 8w1,m ﬁw2,n, W ﬁe s + w2,n<<
expRule@i_D := Exp@arg_D :> Exp@Expand@arg . OmgRule@@iDDD . e T0 -> T1D
We substitute ResonanceConds into the right-hand sides of order1Eq and obtain the solvability condition as
SCond =
Table@Coefficient@-order1Eq@@i, 2DD . expRule@iD, Exp@I omgList@@iDD T0DD == 0, 8i, 2<D;
SCond . displayRule
9A1 d1 lm
4 - 3 A1
2 A
1 a1,1 - A2
2 A
1 a1,3 - 2 A1 A2 A
2 a1,3 +
1
2
EI T1 s f w1,m + 2 I HD1A1L w1,m + 2 I A1 mm w1,m - A1
2 A
1 a1,8 w1,m
2
+ 3 A1
2 A
1 a1,21 w1,m
2
+
A2
2 A
1 a1,17 w2,n
2
- 2 A1 A2 A
2 a1,17 w2,n
2
+ A2
2 A
1 a1,37 w2,n
2
+ 2 A1 A2 A
2 a1,37 w2,n
2
== 0,
-2 A1 A2 A
1 a2,2 - A1
2 A
2 a2,2 - 3 A2
2 A
2 a2,4 - 2 A1 A2 A
1 a2,9 w1,m
2
+ A1
2 A
2 a2,9 w1,m
2
+ 2 A1 A2 A
1 a2,22 w1,m
2
+
A1
2 A
2 a2,22 w1,m
2
+ 2 I HD1A2L w2,n + 2 I A2 mn w2,n - A2
2 A
2 a2,18 w2,n
2
+ 3 A2
2 A
2 a2,38 w2,n
2
== 0=
where
Chapter7.nb
241

# -> H# . ai_,j_ :> coefList@@i, jDD . betayRule . e -> 0  Expand  Collect@#, d0D &L & 
HsymbolList  Flatten  Union  RestL
:a1,1 ﬁ-à
0
1
 fm@xD fm
† @xD3 â x - 4 à
0
1
 fm@xD fm
¢ @xD fm
† @xD fm
H3L@xD â x - à
0
1
 fm@xD fm
¢ @xD2 fm
H4L@xD â x +
i
k
jj-à
0
1
 fm@xD fm
†@xD3 â x - 4 à
0
1
 fm@xD fm
¢ @xD fm
†@xD fm
H3L@xD â x - à
0
1
 fm@xD fm
¢ @xD2 fm
H4L@xD â xy
{
zz d0,
a1,3 ﬁ-à
0
1
 fm@xD fm
† @xD fn
†@xD2 â x - à
0
1
 fm@xD fn
¢ @xD fm
†@xD fn
H3L@xD â x -
3 à
0
1
 fm@xD fm
¢ @xD fn
†@xD fn
H3L@xD â x - à
0
1
 fm@xD fm
¢ @xD fn
¢ @xD fn
H4L@xD â x +
i
k
jjà
0
1
 ¶8x,1< Jfn
H3L@xD à
0
x
 fn
¢ @xD fm
† @xD â xN fm@xD â x - à
0
1
 ¶8x,1< Jfn
†@xD à
1
x
 fm
† @xD fn
†@xD â xN fm@xD â x -
à
0
1
 fm@xD fm
† @xD fn
†@xD2 â x - à
0
1
 fm@xD fn
¢ @xD fm
†@xD fn
H3L@xD â x -
3 à
0
1
 fm@xD fm
¢ @xD fn
†@xD fn
H3L@xD â x - à
0
1
 fm@xD fm
¢ @xD fn
¢ @xD fn
H4L@xD â xy
{
zz d0 -
IÙ0
1 ¶8x,2< Hfn†@xD Ù0
x Ù1
x fm† @xD fn†@xD â x â xL fm@xD â xM d02




bg
,
a1,8 ﬁ-à
0
1
 ¶8x,1< Jfm
¢ @xD à
1
x
 à
0
x
 fm
¢ @xD2 â x â xN fm@xD â x,
a1,17 ﬁ-à
0
1
 ¶8x,1< Jfm
¢ @xD à
1
x
 à
0
x
 fn
¢@xD2 â x â xN fm@xD â x,
a1,21 ﬁ-à
0
1
 ¶8x,1< Jfm
¢ @xD à
1
x
 à
0
x
 fm
¢ @xD2 â x â xN fm@xD â x,
a1,37 ﬁ-à
0
1
 ¶8x,1< Jfm
¢ @xD à
1
x
 à
0
x
 fn
¢@xD2 â x â xN fm@xD â x,
a2,2 ﬁ-à
0
1
 fn@xD fm
† @xD2 fn
†@xD â x - 3 à
0
1
 fn@xD fn
¢ @xD fm
†@xD fm
H3L@xD â x -
à
0
1
 fn@xD fm
¢ @xD fn
†@xD fm
H3L@xD â x - à
0
1
 fn@xD fm
¢ @xD fn
¢ @xD fm
H4L@xD â x +
i
k
jj-à
0
1
 ¶8x,1< Jfm
H3L@xD à
0
x
 fm
¢ @xD fn
†@xD â xN fn@xD â x + à
0
1
 ¶8x,1< Jfm
† @xD à
1
x
 fm
† @xD fn
†@xD â xN fn@xD â xy
{
zz
d0 -
IÙ0
1 ¶8x,2< Hfm
†@xD Ù0
x Ù1
x fm
† @xD fn
†@xD â x â xL fn@xD â xM d0
2




bg
,
a2,4 ﬁ-à
0
1
 fn@xD fn
†@xD3 â x - 4 à
0
1
 fn@xD fn
¢ @xD fn
†@xD fn
H3L@xD â x - à
0
1
 fn@xD fn
¢@xD2 fn
H4L@xD â x,
a2,9 ﬁ-à
0
1
 ¶8x,1< Jfn
¢ @xD à
1
x
 à
0
x
 fm
¢ @xD2 â x â xN fn@xD â x,
a2,18 ﬁ-à
0
1
 ¶8x,1< Jfn
¢ @xD à
1
x
 à
0
x
 fn
¢@xD2 â x â xN fn@xD â x,
a2,22 ﬁ-à
0
1
 ¶8x,1< Jfn
¢ @xD à
1
x
 à
0
x
 fm
¢ @xD2 â x â xN fn@xD â x,
a2,38 ﬁ-à
0
1
 ¶8x,1< Jfn
¢ @xD à
1
x
 à
0
x
 fn
¢@xD2 â x â xN fn@xD â x>
242
Chapter7.nb

which is in agreement with that obtained by direct approach.
 7.3.4 Method of Time-Averaged Lagrangian
As a second alternative, we derive the modulation equations by using the method of time-averaged Lagrangian. The nondi-
mensional Lagrangian of the beam can be expressed as (Crespo da Silva and Glynn, 1978; Arafat, Nayfeh, and Chin, 1998)
Lagr1 =
HoldAà
0
1i
k
jjjj
1
2
 i
k
jje i
k
jj¶tà
0
x 1
2
 IH¶xv@x, tDL2 + H¶x w@x, tDL2M âxy
{
zz
2
+ H¶tv@x, tDL2 + H¶t w@x, tDL2y
{
zz-
e H1 - byL J¶x,xv@x, tD ¶x,x w@x, tD à
0
x
¶x,xv@x, tD ¶x w@x, tD â xN -
1
2
 IH¶x,x w@x, tDL2 + e H¶x w@x, tDL2 H¶x,x w@x, tDL2M - 1
2
 by IH¶x,xv@x, tDL2 +
e H¶xv@x, tDL2 H¶x,xv@x, tDL2 + e 2 ¶xv@x, tD ¶x,xv@x, tD ¶x w@x, tD ¶x,x w@x, tDM -
e
H1 - byL2

2 bg
 i
k
jjJà
1
x
¶x,xv@x, tD ¶x,x w@x, tD âxN
2
+ 2 ¶x,xv@x, tD ¶x,x w@x, tD
à
0
x
à
1
x
¶x,xv@x, tD ¶x,xw@x, tD â x âxy
{
zz - e F@xD Cos@W tD v@x, tDy
{
zzzz âxE .
Integrate -> int . HoldPattern@¶t int@a_, b_DD :> int@¶ta, bD  ReleaseHold;
where  Hold and  int are  used  to  keep  Integrate  from being  evaluated. Transforming  the  total time  derivatives  into  partial
derivatives in terms of T0 and T1, we modify Lagr1 as
Lagr2 = Lagr1 . 8v@x_, tD -> v@x, T0, T1D, w@x_, tD -> w@x, T0, T1D,
Derivative@m_, n_D@w_D@x_, tD -> dt@nD@D@w@x, T0, T1D, 8x, m<DD, t -> T0<;
To this end, we let
solRule = 9v -> FunctionA8x, T0, T1<, A1@T1D fm@xD Exp@I w1,m T0D + A
1@T1D fm@xD Exp@-I w1,m T0DE,
w -> FunctionA8x, T0, T1<, A2@T1D fn@xD Exp@I w2,n T0D + A
2@T1D fn@xD Exp@-I w2,n T0DE=;
and define
intRule6 = 8int@c1_. int@a1__D^n_., b1_D :>
c1 int@int@a1D^n . intRule1 . intRule2 . e -> 0, b1D ; FreeQ@c1, First@b1DD,
int@c1_ int@a1__D^n_., b1_D :> int@c1 int@a1D^ n . intRule1 . intRule2 . e -> 0, b1D<;
Substituting solRule  and betayRule  into Lagr2, using  intRule1, intRule2, and intRule6 to  simplify the  expansions of the
integrands, and collecting the coefficients of e, we obtain
Chapter7.nb
243

Horder1Lagr =
Lagr2 . solRule . betayRule . intRule1 . intRule2 . intRule6 . intRule1 .
intRule2 . intRule6 . intRule1 . intRule2 
TrigToExp  Expand  Coefficient@#, eD &;L  Timing
814.951 Second, Null<
ResonanceConds = 8w2,n == w1,m, W == w1,m + e s< . Equal -> Rule
8w2,n ﬁw1,m, W ﬁe s + w1,m<
notationRule1 = 9intAfi_@xD2, 8x, 0, 1<E -> 1,
int@F@xD fi_@xD, 8x, 0, 1<D -> f w1,i, intAfi_
† @xD2, 8x, 0, 1<E -> li
4=;
Using ResonanceConds and notationRule1, we obtain the slowly varying terms from order1Lagr as
TAL = order1Lagr . Exp@a_D :> Exp@Expand@a . ResonanceCondsD . e T0 -> T1D .
Exp@_ T0 + _.D -> 0 . notationRule1;
The Euler-Lagrange equations corresponding to the TAL can be written as
244
Chapter7.nb

eqMod1 =
DADATAL, A
1
¢ @T1DE, T1E - DATAL, A
1@T1DE == 0 . int@a_, b__D -> HoldForm@Integrate@a, bDD
1
2
EI T1 s f w1,m + d1 lm
4 A1@T1D + 6 i
k
jjà
0
1
 fm
¢ @xD2 fm
† @xD2 â xy
{
zz A1@T1D2 A
1@T1D +
6 i
k
jjà
0
1
 fm
¢ @xD2 fm
†@xD2 â xy
{
zz d0 A1@T1D2 A
1@T1D - 2 i
k
jjà
0
1
 Jà
0
x
 fm
¢ @xD2 â xN
2
 â xy
{
zz w1,m
2
A1@T1D2 A
1@T1D +
2 i
k
jjà
0
1
 fm
¢ @xD fn
¢ @xD fm
† @xD fn
†@xD â xy
{
zz A2@T1D2 A
1@T1D -
2 i
k
jjà
0
1
 Jà
0
x
 fn
¢ @xD fm
† @xD â xN fm
† @xD fn
†@xD â xy
{
zz d0 A2@T1D2 A
1@T1D +
2 i
k
jjà
0
1
 fm
¢ @xD fn
¢ @xD fm
† @xD fn
†@xD â xy
{
zz d0 A2@T1D2 A
1@T1D +
IÙ0
1 HÙ1
x fm
†@xD fn
†@xD â xL
2 â xM d0
2 A2@T1D2 A
1@T1D




bg
+
2 IÙ0
1 HÙ0
x Ù1
x fm
† @xD fn
†@xD â x â xL fm
†@xD fn
†@xD â xM d0
2 A2@T1D2 A
1@T1D





bg
-
2 i
k
jjà
0
1
 Jà
0
x
 fm
¢ @xD2 â xN à
0
x
 fn
¢@xD2 â x â xy
{
zz w1,m w2,n A2@T1D2 A
1@T1D +
4 i
k
jjà
0
1
 fm
¢ @xD fn
¢ @xD fm
† @xD fn
†@xD â xy
{
zz A1@T1D A2@T1D A
2@T1D -
4 i
k
jjà
0
1
 Jà
0
x
 fn
¢ @xD fm
† @xD â xN fm
† @xD fn
†@xD â xy
{
zz d0 A1@T1D A2@T1D A
2@T1D +
4 i
k
jjà
0
1
 fm
¢ @xD fn
¢ @xD fm
† @xD fn
†@xD â xy
{
zz d0 A1@T1D A2@T1D A
2@T1D +
2 IÙ0
1 HÙ1
x fm
†@xD fn
†@xD â xL2 â xM d0
2 A1@T1D A2@T1D A
2@T1D




bg
+
4 IÙ0
1 HÙ0
x Ù1
x fm
† @xD fn
†@xD â x â xL fm
†@xD fn
†@xD â xM d0
2 A1@T1D A2@T1D A
2@T1D





bg
+ 2 I w1,m A1
¢ @T1D == 0
and
Chapter7.nb
245

eqMod2 =
DADATAL, A
2
¢ @T1DE, T1E - DATAL, A
2@T1DE == 0 . int@a_, b__D -> HoldForm@Integrate@a, bDD
4 i
k
jjà
0
1
 fm
¢ @xD fn
¢ @xD fm
† @xD fn
†@xD â xy
{
zz A1@T1D A2@T1D A
1@T1D -
4 i
k
jjà
0
1
 Jà
0
x
 fn
¢ @xD fm
† @xD â xN fm
† @xD fn
†@xD â xy
{
zz d0 A1@T1D A2@T1D A
1@T1D +
4 i
k
jjà
0
1
 fm
¢ @xD fn
¢ @xD fm
† @xD fn
†@xD â xy
{
zz d0 A1@T1D A2@T1D A
1@T1D +
2 IÙ0
1 HÙ1
x fm
†@xD fn
†@xD â xL2 â xM d0
2 A1@T1D A2@T1D A
1@T1D




bg
+
4 IÙ0
1 HÙ0
x Ù1
x fm
† @xD fn
†@xD â x â xL fm
†@xD fn
†@xD â xM d0
2 A1@T1D A2@T1D A
1@T1D





bg
+
2 i
k
jjà
0
1
 fm
¢ @xD fn
¢ @xD fm
† @xD fn
†@xD â xy
{
zz A1@T1D2 A
2@T1D -
2 i
k
jjà
0
1
 Jà
0
x
 fn
¢ @xD fm
† @xD â xN fm
† @xD fn
†@xD â xy
{
zz d0 A1@T1D2 A
2@T1D +
2 i
k
jjà
0
1
 fm
¢ @xD fn
¢ @xD fm
† @xD fn
†@xD â xy
{
zz d0 A1@T1D2 A
2@T1D +
IÙ0
1 HÙ1
x fm
†@xD fn
†@xD â xL2 â xM d0
2 A1@T1D2 A
2@T1D




bg
+
2 IÙ0
1 HÙ0
x Ù1
x fm
† @xD fn
†@xD â x â xL fm
†@xD fn
†@xD â xM d0
2 A1@T1D2 A
2@T1D





bg
-
2 i
k
jjà
0
1
 Jà
0
x
 fm
¢ @xD2 â xN à
0
x
 fn
¢@xD2 â x â xy
{
zz w1,m w2,n A1@T1D2 A
2@T1D +
6 i
k
jjà
0
1
 fn
¢@xD2 fn
†@xD2 â xy
{
zz A2@T1D2 A
2@T1D -
2 i
k
jjà
0
1
 Jà
0
x
 fn
¢ @xD2 â xN
2
 â xy
{
zz w2,n
2
A2@T1D2 A
2@T1D + 2 I w2,n A2
¢@T1D == 0
Adding  linear viscous  damping  to  eqMod1  and  eqMod2  and  performing  integration  by  parts  yields  the  same  modulation
equations as obtained by directly attacking the partial-differential system.
246
Chapter7.nb

Chapter 8
Continuous Systems with Quadratic and 
Cubic Nonlinearities
In this chapter, we use the method of multiple scales to determine second-order uniform asymptotic solutions of continuous
or  distributed-parameter  systems  with  quadratic  and  cubic  nonlinearities.  We  consider  some  of  the  internal resonances
arising  from the  cubic  nonlinearities, namely, one-to-one  and  three-to-one  internal resonances. Two-to-one  internal  reso-
nances  are treated  in Chapter 9. We directly  attack these continuous  systems  because treatment of reduced-order models
obtained  with  the Galerkin  procedure  might lead  to  erroneous  results. We  consider buckled beams  in  Section 8.1, circular
cylindrical shells in Section 8.2, and near-square plates in Section 8.3.
à Preliminaries
Off@General::spell1, Integrate::generD
Needs@"Utilities`Notation`"D
To determine second-order uniform asymptotic expansions of the solutions of  buckled beams, circular cylindrical shells, and
near-square  plates  by using the method  of multiple scales, we  introduce the three time scales  T0 = t, T1 = et, and T2 = e2 t,
where  e is  a  small nondimensional parameter and  the order of the amplitude of oscillations. Moreover, we  symbolize these
scales according to
Symbolize@T0D; Symbolize@T1D; Symbolize@T2D;
timeScales = 8T0, T1, T2<;
In terms of the time scales T0, T1, and T2, the time derivatives can be expressed as
dt@0D@expr_D := expr; dt@1D@expr_D := SumAei D@expr, timeScales@@i + 1DDD, 8i, 0, 2<E;
dt@2D@expr_D := Hdt@1D@dt@1D@exprDD  ExpandL . ei_;i>3 -> 0;
In  the  course of the  analysis, we  need  the complex conjugates  of A and  other variables. We  define  them by  using  the
following rule:
conjugateRule = 9A -> A, A -> A, Complex@m_, n_D -> Complex@m, -nD=;
To speed up manipulations of the integrals involved in the governing equations with Mathematica, we introduce the rules

intRule1 = 8int@fun_, arg2__D :> int@Expand@funD, arg2D<;
intRule2 = 8int@a_ + b_, arg2__D :> int@a, arg2D + int@b, arg2D,
int@en_. fun_, arg2__D :> en int@fun, arg2D,
int@a_ fun_, a1_, b1___D :> a int@fun, a1, b1D ; FreeQ@a, First@a1DD,
int@int@a1_, a2_D fun_., a3__D :> int@a1, a2D int@fun, a3D ; FreeQ@Rest@a2D, First@a2DD<;
To display the outputs in easily read expressions, we introduce the rules
displayRule = 9Derivative@a_, b__DAw_i_E@_, T0, __D :>
SequenceFormAIfAarg1 = Times  MapIndexedAD#2@@1DD-1
#1
&, 8b<E; arg1 =!= 1, arg1, ""E,
wiSequenceForm  Table@"'",8a<DE,
Derivative@a__D@Ai__D@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD
#1
&, 8a<E, AiE,
Derivative@a__D@A
i__D@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD
#1
&, 8a<E, A
iE,
w_i_@_, T0, __D -> wi, Ai__@__D -> Ai, A
i__@__D -> A
i,
Exp@a_. + b_. Complex@0, m_D T0 + c_. Complex@0, n_D T0D -> Exp@a + Hm * b + n * cL I T0D=;
à 8.1 Buckled Beams
In this  section, we consider the nonlinear transverse response of a buckled beam possessing either a one-to-one or a three-
to-one internal resonance to a principal parametric resonance of the higher mode. The analysis  assumes  a unimodal  buckled
deflection.
The  equation  governing  nonlinear transverse  vibrations  of  a  parametrically  excited  homogeneous  beam  is  (Nayfeh  and
Mook, 1979)
eq81a =
m wt,t + c wt + Es Is wx,x,x,x + i
k
jjP - fp Cos@W tD - Es A

2 {
 à
0
{
HwxL2 âxy
{
zz wx,x == 0 . wm__ :> ¶m w@x, tD;
where P is  a static axial load, fp Cos@W tD is  an axial harmonic excitation, w@x, tD is  the transverse deflection of the beam, x is
the distance along the undeflected beam, and  t is  time. Other dimensional parameters  are the damping coefficient c and the
beam length {, mass per unit length m, cross-sectional area A, modulus of elasticity Es, and cross-sectional area moment of
inertia Is. We note that the subscript s  is  used with I and E so that  Mathematica will not confuse them with  !!!!!!
-1 and the
exponential function . Equation eq81a is supplemented with the four linear homogeneous boundary conditions
bc81a = 8B1@w@0, tDD == 0, B2@w@0, tDD == 0, B3@w@{, tDD == 0, B4@w@{, tDD == 0<;
where the Bi are linear homogeneous operators.
It is  good practice to cast the governing equations and boundary conditions in nondimensional form. Thus, we introduce the
following nondimensional variables:
T = $ %% %%%% %%%%
m {4

Es Is
;
248
Chapter8.nb

nondimRule = 9w -> H{ w@#1  {, #2  TD &L, x -> {x, t -> T t, W -> W  T,
P -> P Es Is {2, fp -> f Es Is  {2, c -> c  !! !!! !!!! !!
Es Is m  {2, A -> 2 a Is  {2=;
where the tilde indicates a nondimensional variable. Substituting nondimRule into eq81a and dropping the tildes, we obtain
eq81b = i
k
jj
{3

Es Is
 eq81a@@1DD . Integrate -> int . nondimRule . s_
 -> s .
int@a_, 8x {, __<D -> { int@a, 8x, 0, 1<D  Expand  PowerExpandy
{
zz == 0;
eq81b .
int ->
Integrate
c wH0,1L@x, tD + wH0,2L@x, tD + P wH2,0L@x, tD -
f Cos@t WD wH2,0L@x, tD - a i
k
jjà
0
1
 wH1,0L@x, tD
2 â xy
{
zz wH2,0L@x, tD + wH4,0L@x, tD == 0
 8.1.1 Postbuckling Deflection
The first step in analyzing the nonlinear vibrations of a buckled beam is  the determination of the critical Euler buckling loads
Pk and their corresponding mode shapes fk@xD. We symbolize the Pk as
Symbolize@PkD;
Dropping the time derivative and neglecting the forcing and nonlinear terms  in eq81b, we define the linear buckling problem
as
buckEq = eq81b . int -> H0 &L . 8P -> Pk, f -> 0, w -> Hfk@#1D &L<
Pk fk
†@xD + fk
H4L@xD == 0
Solving buckEq for fk
H4L@xD yields
buckRule = SolveAbuckEq, fk
H4L@xDE@@1DD
9fk
H4L@xD ﬁ-Pk fk
†@xD=
Next, we increase the axial load P beyond Pk  and assume  that the postbuckling displacement is b fk, where b is a nondimen-
sional  measure  of the  buckling  level.  Substituting  this  displacement  into  eq81b, dropping  the  forcing  term  and  the  time
derivative, and using intRule2 and buckRule, we obtain
bEq = Factor@eq81b@@1DD . 8f -> 0, w -> Hb fk@#1D &L< . intRule2 . buckRuleD == 0
-b H-P+ Pk + b2 a int@fk
¢ @xD2, 8x, 0, 1<DL fk
† @xD == 0
It follows from bEq that either b = 0 (unbuckled case) or b is given by
Chapter8.nb
249

IbRule = b2 -> Ib2 . Solve@bEq, bD@@2DDMM . int -> Integrate
b2 ﬁ
P - Pk

a Ù0
1 fk¢ @xD2 â x
And solving bEq for P yields
HPRule = Solve@bEq, PD@@1DDL . int -> Integrate
:P ﬁPk + b2 a à
0
1
 fk
¢ @xD2 â x>
Because P is greater than Pk, PRule yields the amplitude of the kth buckling mode.
Having solved the postbuckling problem, we assume  that the beam deflection is  the sum of the static buckled displacement
b fk@xD, corresponding to the kth buckled mode, and a time-dependent relative deflection u@x, tD; that is,
wRule = 8w -> Hb fk@#1D + u@#1, #2D &L<;
Substituting wRule  into eq81b and using intRule1, intRule2, buckRule, and PRule, we  find that  the nonlinear transverse
vibrations of the beam around its buckled configuration are given by
EOM = eq81b . wRule . intRule1 . intRule2 . buckRule . PRule  ExpandAll;
EOM . int -> Integrate
-b f Cos@t WD fk
† @xD - 2 b2 a i
k
jjà
0
1
 fk
¢ @xD uH1,0L@x, tD â xy
{
zz fk
† @xD - b a i
k
jjà
0
1
 uH1,0L@x, tD
2 â xy
{
zz fk
† @xD +
c uH0,1L@x, tD + uH0,2L@x, tD + Pk uH2,0L@x, tD - f Cos@t WD uH2,0L@x, tD -
2 b a i
k
jjà
0
1
 fk
¢ @xD uH1,0L@x, tD â xy
{
zz uH2,0L@x, tD - a i
k
jjà
0
1
 uH1,0L@x, tD
2 â xy
{
zz uH2,0L@x, tD + uH4,0L@x, tD == 0
BC = bc81a . 8w -> u, { -> 1<
8B1@u@0, tDD == 0, B2@u@0, tDD == 0, B3@u@1, tDD == 0, B4@u@1, tDD == 0<
In  the  following analysis, we  focus  on  hinged-hinged, first mode-buckled  beams. Then, the   boundary  conditions  for the
static deflection fk@xD can be written as
bBC = 8fk@0D == 0, fk
†@0D == 0, fk@1D == 0, fk
†@1D == 0<;
and the boundary conditions for the dynamic deflection u@x, tD can be written as
BC1 = 8u@0, tD == 0, ¶x,xu@x, tD == 0 . x -> 0, u@1, tD == 0, ¶x,xu@x, tD == 0 . x -> 1<
8u@0, tD == 0, uH2,0L@0, tD == 0, u@1, tD == 0, uH2,0L@1, tD == 0<
For the case of first buckled mode, it follows from buckEq and bBC that the first critical buckling load and associated mode-
shape are
250
Chapter8.nb

bucklingLoad = Pk -> p2;
modeshape = 8fk -> HSin@p #D &L<;
where the buckling modeshape was normalized so that fk@12D = 1.
 Linear Vibrations
The next  step in analyzing the nonlinear vibrations of a buckled beam is  the calculation of its linear natural frequencies  and
corresponding  modeshapes. To  this  end, we linearize  EOM in u@x, tD, drop the  forcing, damping, and nonlinear terms, and
obtain
linearEq = EOM . 8c -> 0, f -> 0< . u -> He u@#1, #2D &L . intRule2 . en_;n>1 -> 0 . e -> 1;
linearEq . int -> Integrate
-2 b2 a i
k
jjà
0
1
 fk
¢ @xD uH1,0L@x, tD â xy
{
zz fk
†@xD + uH0,2L@x, tD + Pk uH2,0L@x, tD + uH4,0L@x, tD == 0
The boundary conditions are the same as BC1, which we list below as
linearBC = BC1
8u@0, tD == 0, uH2,0L@0, tD == 0, u@1, tD == 0, uH2,0L@1, tD == 0<
Then, using separation of variables, we seek the solution of linearEq and linearBC in the form
uSol = u -> Function@8x, t<, F@xD Exp@I w tDD;
where  w is  the  nondimensional linear natural frequency and  F@xD is  the  corresponding  modeshape. Substituting  uSol  into
linearEq and linearBC and using intRule2 and Thread, we obtain the equation governing F@xD as
FEq = linearEq . uSol . intRule2  ThreadAE-I w t #, EqualE &  ExpandAll;
FEq . int -> Integrate
-w2 F@xD + Pk F†@xD - 2 b2 a i
k
jjà
0
1
 F¢@xD fk
¢ @xD â xy
{
zz fk
† @xD + FH4L@xD == 0
and the boundary conditions as
FBC = linearBC . u -> HF@#1D &L
8F@0D == 0, F†@0D == 0, F@1D == 0, F†@1D == 0<
To find the general solution of FEq and FBC, we follow Nayfeh, Kreider, and Anderson (1995) and treat the definite integral
as  a constant B; thus, we have a nonhomogeneous linear ordinary-differential equation. Hence, its general solution can be
expressed  as  a  linear  combination  of homogeneous  and  particular solutions.  Because fk@xD is  a  solution  of buckEq, the
particular solution is proportional to fk
†@xD. Consequently, we express the general solution of FEq and FBC as
cList = Table@ci, 8i, 5<D;
shapeFunc = 8Cos@ l1 xD, Sin@ l1 xD, Cosh@ l2 xD, Sinh@ l2 xD, fk†@xD<;
Chapter8.nb
251

FSol = F -> Function@x, cList.shapeFunc . modeshape  EvaluateD
F ﬁFunction@x, Cos@x l1D c1 + Sin@x l1D c2 + Cosh@x l2D c3 + Sinh@x l2D c4 - p2 Sin@p xD c5D
where the li satisfy the characteristic equation
charEq =
FEq . b -> 0 . bucklingLoad . F -> HExp@ l #D &L  ThreadAE-l x #, EqualE &  ExpandAll
p2 l2 + l4 - w2 == 0
lRule = 9- l1
2, l2
2= -> I l2 . Solve@charEq, lD  UnionM  Thread
:-l1
2 ﬁ1
2
i
k
jj-p2 - " # #### #### ####
p4 + 4 w2 y
{
zz, l2
2 ﬁ1
2
i
k
jj-p2 + " ## #### #### ###
p4 + 4 w2 y
{
zz>
Substituting  bucklingLoad, modeshape, and  FSol  into  the  left-hand  sides  of FBC and  FEq and  using  intRule1  and  int-
Rule2, we obtain
expr1 = Append@#@@1DD &  FBC . FSol,
FEq@@1DD . bucklingLoad . modeshape . FSol . intRule1 . intRule2 . int -> IntegrateD
:c1 +c3, -c1 l1
2 + c3 l2
2, Cos@l1D c1 + Sin@l1D c2 + Cosh@l2D c3 + Sinh@l2D c4,
-Cos@l1D c1 l1
2 - Sin@l1D c2 l1
2 + Cosh@l2D c3 l2
2 + Sinh@l2D c4 l2
2,
-p6 Sin@p xD c5 - w2 HCos@x l1D c1 + Sin@x l1D c2 + Cosh@x l2D c3 + Sinh@x l2D c4 - p2 Sin@p xD c5L +
Cos@x l1D c1 l1
4 + Sin@x l1D c2 l1
4 + Cosh@x l2D c3 l2
4 + Sinh@x l2D c4 l2
4 +
p2 Hp4 Sin@p xD c5 - Cos@x l1D c1 l1
2 - Sin@x l1D c2 l1
2 + Cosh@x l2D c3 l2
2 + Sinh@x l2D c4 l2
2L +
2 b2 p2 a Sin@p xD
i
k
jjj- 1
2
p4 c5 +
p Sin@l1D c2 l1
2

Hp - l1L Hp + l1L
- p c1 l1 i
k
jj-
l1

Hp - l1L Hp + l1L
-
Cos@l1D l1

Hp - l1L Hp + l1L
y
{
zz -
p Sinh@l2D c4 l2
2


Hp - I l2L Hp + I l2L
+ p c3 l2 i
k
jj-
l2


Hp - I l2L Hp + I l2L
-
Cosh@l2D l2


Hp - I l2L Hp + I l2L
y
{
zzy
{
zzz>
The coefficient matrix of cList in expr1 can be obtained as
252
Chapter8.nb

coefMat = Outer@Coefficient, expr1, cListD
:81, 0, 1, 0, 0<, 8-l1
2, 0, l2
2, 0, 0<, 8Cos@l1D, Sin@l1D, Cosh@l2D, Sinh@l2D, 0<,
8-Cos@l1D l1
2, -Sin@l1D l1
2, Cosh@l2D l2
2, Sinh@l2D l2
2, 0<, :-w2 Cos@x l1D -
p2 Cos@x l1D l1
2 + Cos@x l1D l1
4 + 2 b2 p3 a Sin@p xD l12


Hp - l1L Hp + l1L
+ 2 b2 p3 a Cos@l1D Sin@p xD l12


Hp - l1L Hp + l1L
,
-w2 Sin@x l1D - p2 Sin@x l1D l1
2 + Sin@x l1D l1
4 + 2 b2 p3 a Sin@p xD Sin@l1D l12


Hp - l1L Hp + l1L
, -w2 Cosh@x l2D +
p2 Cosh@x l2D l2
2 - 2 b2 p3 a Sin@p xD l22


Hp - I l2L Hp + I l2L
- 2 b2 p3 a Cosh@l2D Sin@p xD l22


Hp - I l2L Hp + I l2L
+ Cosh@x l2D l2
4,
-w2 Sinh@x l2D + p2 Sinh@x l2D l2
2 - 2 b2 p3 a Sin@p xD Sinh@l2D l22


Hp - I l2L Hp + I l2L
+ Sinh@x l2D l2
4,
-b2 p6 a Sin@p xD + p2 w2 Sin@p xD>>
Substituting charEq into coefMat[[5]] and eliminating the common factor Sin@p xD, we have
coefMat@@5DD = Coefficient@coefMat@@5DD, Sin@p xDD
:
2 b2 p3 a l1
2

Hp -l1L Hp + l1L
+ 2 b2 p3 a Cos@l1D l1
2


Hp - l1L Hp + l1L
, 2 b2 p3 a Sin@l1D l1
2


Hp - l1L Hp + l1L
,
-
2 b2 p3 a l2
2


Hp - I l2L Hp + I l2L
- 2 b2 p3 a Cosh@l2D l2
2


Hp - I l2L Hp + I l2L
, - 2 b2 p3 a Sinh@l2D l2
2


Hp - I l2L Hp + I l2L
, -b2 p6 a + p2 w2>
Setting the determinant of coefMat equal to zero yields the following characteristic equation for the natural frequencies:
Factor@Det@coefMatDD == 0
p2 Hb2 p4 a - w2L Sin@l1D Sinh@l2D Hl1
2 + l2
2L
2 == 0
There are two possibilities: b2 p4 a - w2 = 0 and Sin@l1D = 0. Hence, either
wSol1 = SolveAb2 p4 a - w2 == 0, wE@@2DD
9w ﬁb p2  !!!a =
or
wSol2 = SolveA- l1
2 + Hn pL2 == 0 . lRule, wE@@2DD
:w ﬁn " ## #### #####
-1 + n2 p2>
for n > 1. The lowest five natural frequencies are
frequencies = 8w1 -> Hw . wSol1L, w2 -> Hw . wSol2 . n -> 2L,
w3 -> Hw . wSol2 . n -> 3L, w4 -> Hw . wSol2 . n -> 4L, w5 -> Hw . wSol2 . n -> 5L<
9w1 ﬁb p2  !!!a , w2 ﬁ2  ! !!3 p2, w3 ﬁ6  !!!2 p2, w4 ﬁ4  !!!!!
15 p2, w5 ﬁ10  ! !!6 p2=
Chapter8.nb
253

The first two frequencies vs. the buckling level are plotted as follows:
PlotAw . 9wSol1 . b  !!!a -> s, wSol2 . n -> 2=  Evaluate,
8s, 0, 15<, PlotStyle -> 8RGBColor@1, 0, 0D, RGBColor@0, 0, 1D<,
Frame -> True, FrameLabel -> 9"b !!!a ", "w"=, RotateLabel -> False,
Epilog -> 9TextA"C", 92  !!!3 , 2  ! !!3  p2 + 5=E, TextA"b1 : 3", 92   ! !!3 , 3=E,
TextA"b1 : 1", 92  ! !!3 , 3=E, TextA"b3 : 1", 96  !!!3 , 3=E=E;
0
2
4
6
8
10
12
14
b !!!a
0
20
40
60
80
100
120
140
w
C
b1:3
b1:1
b3:1
where the low-frequency mode (red line) is symmetric and the second mode (blue line) is antisymmetric. As the buckling level
increases from zero, the frequency w1 of the first mode increases from zero and crosses the frequency w2 of the second mode
at point C. Hence, there are two possible three-to-one internal resonances: w2 = 3w1 when b  !!!!
a = b1:3 and w1 = 3w2 when
b3:1. There is also a possible one-to-one internal resonance w2 = w1 when b  !!!!
a = b1:1. Whether or not these candidates  for
internal resonances  will be activated  depends on  the corresponding  modeshapes. In  this  section, we  consider the  case of
one-to-one  internal  resonance  between  the  first  and  second  modes.  In  Section  8.1.4,  we  consider  three-to-one  internal
resonances  between  the  first two  modes.  In  Sections  8.1.5  and  8.1.6,  we  consider  one-to-one  and  three-to-one  internal
resonances between the first and third modes and the first and fouth modes, respectively.
In  the  next  section, we  consider a  combination  of a  one-to-one  internal resonance  between  the lowest two  modes  and  a
principal parametric resonance of the second mode; that is,
omgList = 8w1, w2<;
ResonanceConds = 9w2 == w1 + e2 s1, W == 2 w2 + e2 s2=;
where the si are detuning parameters that describe the nearness of the resonances. The buckling level for which the natural
frequencies of the first and second modes are equal (i.e., w2 = w1) is given by
values1 = Solve@w1 == w2 . frequencies, bD@@1DD
:b ﬁ2  !!!3

 !!!a
>
The corresponding lm are
lRuleN = Solve@ lRule . w -> w1 . frequencies . values1 . Rule -> Equal, 8 l1, l2<D@@4DD
9l1 ﬁ2 p, l2 ﬁ ! !!3 p=
254
Chapter8.nb

In order that  the influence of the damping and  nonlinearity balance the influence of the forcing, we scale  the damping and
forcing terms as
scaling = 9c -> 2 e2 m , f -> e2 f=;
Substituting for the natural frequency w1 back into coefMat, we determine the modeshape as
NullSpace@coefMat . w -> w1 . frequenciesD@@1DD.shapeFunc . modeshape
-p2 Sin@p xD
which we normalize as
shape1 = c Sin@p xD . SolveAà
0
1
c2 Sin@p xD2 âx == 1, cE@@2DD
 !!!2 Sin@p xD
Substituting w2 into coefMat, we determine the modeshape as
NullSpace@coefMat . lRuleN . w -> w2 . frequenciesD@@1DD.shapeFunc . lRuleN
Sin@2 p xD
which we also normalize as
shape2 = c Sin@2 p xD . SolveAà
0
1
c2 Sin@2 p xD2 âx == 1, cE@@2DD
 !!!2 Sin@2 p xD
In a similar fashion, we find that the next three normalized modeshapes are
shape3 =  !!!2 Sin@3 p xD;
shape4 =  !!!2 Sin@4 p xD;
shape5 =  !!!2 Sin@5 p xD;
To treat a one-to-one internal resonance between the first and second modes, we define fk  and the first two eigenmodes  of
the buckled beam as
modeshapes = Join@modeshape,
8F1 -> Function@x, shape1  EvaluateD, F2 -> Function@x, shape2  EvaluateD<D;
 8.1.2 Perturbation Analysis
We use the method of multiple scales to directly attack EOM and BC1. To transform the time derivatives  in EOM in terms  of
the scales T0, T1, and T2, we let
Chapter8.nb
255

multiScales = 8u@x_, tD -> u@x, T0, T1, T2D,
Derivative@m_, n_D@u_D@x_, tD -> dt@nD@D@u@x, T0, T1, T2D, 8x, m<DD, t -> T0<;
Then, we seek a second-order approximate solution in the form
solRule = u -> IEvaluateASumAej uj@#1, #2, #3, #4D, 8j, 3<EE &M
u ﬁHe u1@#1, #2, #3, #4D + e2 u2@#1, #2, #3, #4D + e3 u3@#1, #2, #3, #4D &L
where #1 stands for x and #2, #3, and #4 stand for T0, T1, and T2, respectively.
Substituting multiScales, solRule, and scaling into EOM and BC1, expanding the result  for small e, and discarding terms of
order higher than e3, we obtain
eq81c = HJoin@8EOM<, BC1D . multiScales . solRule . scaling . intRule1 . intRule2 
TrigToExp  ExpandAllL . en_;n>3 -> 0;
Equating coefficients of like powers of e, we obtain
eqEps = Thread@CoefficientList@Subtract  #, eD == 0D &  eq81c  Transpose  Rest;
eqEps . displayRule
98Pk Hu1
''L + u1
'''' + D0
2u1 - 2 b2 a int@Hu1
'L fk
¢ @xD, 8x, 0, 1<D fk
†@xD == 0,
u1 == 0, u1
'' == 0, u1 == 0, u1
'' == 0<,
9-2 b a int@Hu1
'L fk
¢ @xD, 8x, 0, 1<D Hu1
''L + Pk Hu2
''L + u2
'''' + D0
2u2 + 2 HD0 D1u1L - 1
2
b E-I T0 W f fk
†@xD -
1
2
b EI T0 W f fk
† @xD - b a intBHu1
'L
2, 8x, 0, 1<F fk
† @xD -
2 b2 a int@Hu2
'L fk
¢ @xD, 8x, 0, 1<D fk
†@xD == 0, u2 == 0, u2
'' == 0, u2 == 0, u2
'' == 0=,
9- 1
2
E-I T0 W f Hu1
''L - 1
2
EI T0 W f Hu1
''L - a intBHu1
'L
2, 8x, 0, 1<F Hu1
''L -
2 b a int@Hu2
'L fk
¢ @xD, 8x, 0, 1<D Hu1
''L - 2 b a int@Hu1
'L fk
¢ @xD, 8x, 0, 1<D Hu2
''L + Pk Hu3
''L +
u3
'''' + 2 m HD0u1L + D0
2u3 + 2 HD0 D1u2L + D1
2u1 + 2 HD0 D2u1L - 2 b a int@Hu1
'L Hu2
'L, 8x, 0, 1<D fk
†@xD -
2 b2 a int@Hu3
'L fk
¢ @xD, 8x, 0, 1<D fk
†@xD == 0, u3 == 0, u3
'' == 0, u3 == 0, u3
'' == 0==
 First-Order Solution
Because in the presence of damping all of the modes that are not directly or indirectly excited decay with time, the solution of
eqEps[[1]] is taken to consist of the two modes that might be involved in the internal resonance; that is,
sol1 = 9u1 -> FunctionA8x, T0, T1, T2<,
SumAAi@T1, T2D Fi@xD Exp@I wi T0D + A
i@T1, T2D Fi@xD Exp@-I wi T0D, 8i, 2<E  EvaluateE=;
where the Fi are the eigenmodes, which satisfy the orthonormality condition Ù0
1Fn@xDFm@xDâ x = dn,m.
256
Chapter8.nb

 Second-Order Solution
Substituting sol1 into eqEps[[2,1]] and using intRule1 and intRule2 yields
order2Eq =
HeqEps@@1, 1, 1DD . u1 -> u2L == HeqEps@@1, 1, 1DD . u1 -> u2L - eqEps@@2, 1, 1DD . sol1 .
intRule1 . intRule2  ExpandAll; order2Eq . displayRule
Pk Hu2
''L + u2
'''' + D0
2u2 - 2 b2 a int@Hu2
'L fk
¢ @xD, 8x, 0, 1<D fk
†@xD ==
-2 I EI T0 w1 HD1A1L w1 F1@xD + 2 I E-IT0 w1 HD1A
1L w1 F1@xD -
2 I EI T0 w2 HD1A2L w2 F2@xD + 2 I E-I T0 w2 HD1A
2L w2 F2@xD + 1
2
b E-I T0 W f fk
†@xD +
1
2
b EI T0 W f fk
† @xD + b E2 I T0 w1 a int@F1
¢ @xD2, 8x, 0, 1<D A1
2 fk
† @xD +
2 b EI T0 Hw1+w2L a int@F1
¢@xD F2
¢ @xD, 8x, 0, 1<D A1 A2 fk
†@xD +
b E2 I T0 w2 a int@F2
¢ @xD2, 8x, 0, 1<D A2
2 fk
† @xD + 2 b a int@F1
¢@xD2, 8x, 0, 1<D A1 A
1 fk
† @xD +
2 b EI T0 H-w1+w2L a int@F1
¢ @xD F2
¢@xD, 8x, 0, 1<D A2 A
1 fk
†@xD +
b E-2 I T0 w1 a int@F1
¢ @xD2, 8x, 0, 1<D A
1
2 fk
† @xD +
2 b EI T0 Hw1-w2L a int@F1
¢@xD F2
¢ @xD, 8x, 0, 1<D A1 A
2 fk
†@xD + 2 b a int@F2
¢ @xD2, 8x, 0, 1<D A2 A
2 fk
†@xD +
2 b EI T0 H-w1-w2L a int@F1
¢ @xD F2
¢@xD, 8x, 0, 1<D A
1 A
2 fk
†@xD +
b E-2 I T0 w2 a int@F2
¢ @xD2, 8x, 0, 1<D A
2
2 fk
† @xD + 2 b E2 I T0 w1 a int@fk
¢ @xD F1
¢@xD, 8x, 0, 1<D A1
2 F1
†@xD +
2 b EI T0 Hw1+w2L a int@fk
¢ @xD F2
¢ @xD, 8x, 0, 1<D A1 A2 F1
†@xD +
4 b a int@fk
¢ @xD F1
¢ @xD, 8x, 0, 1<D A1 A
1 F1
†@xD +
2 b EI T0 H-w1+w2L a int@fk
¢ @xD F2
¢ @xD, 8x, 0, 1<D A2 A
1 F1
†@xD +
2 b E-2 I T0 w1 a int@fk
¢ @xD F1
¢@xD, 8x, 0, 1<D A
1
2 F1
†@xD +
2 b EI T0 Hw1-w2L a int@fk
¢ @xD F2
¢ @xD, 8x, 0, 1<D A1 A
2 F1
†@xD +
2 b EI T0 H-w1-w2L a int@fk
¢ @xD F2
¢ @xD, 8x, 0, 1<D A
1 A
2 F1
†@xD +
2 b EI T0 Hw1+w2L a int@fk
¢ @xD F1
¢ @xD, 8x, 0, 1<D A1 A2 F2
†@xD +
2 b E2 I T0 w2 a int@fk
¢ @xD F2
¢@xD, 8x, 0, 1<D A2
2 F2
†@xD +
2 b EI T0 H-w1+w2L a int@fk
¢ @xD F1
¢ @xD, 8x, 0, 1<D A2 A
1 F2
†@xD +
2 b EI T0 Hw1-w2L a int@fk
¢ @xD F1
¢ @xD, 8x, 0, 1<D A1 A
2 F2
†@xD +
4 b a int@fk
¢ @xD F2
¢ @xD, 8x, 0, 1<D A2 A
2 F2
†@xD +
2 b EI T0 H-w1-w2L a int@fk
¢ @xD F1
¢ @xD, 8x, 0, 1<D A
1 A
2 F2
†@xD +
2 b E-2 I T0 w2 a int@fk
¢ @xD F2
¢@xD, 8x, 0, 1<D A
2
2 F2
†@xD
To collect the terms that might lead to secular terms from the right-hand side of order2Eq, we define the rules:
OmgRule = Solve@ResonanceConds, Complement@omgList, 8#<D ~Join~ 8W<D@@1DD &  omgList
88w2 ﬁe2 s1 + w1, W ﬁ2 e2 s1 + e2 s2 + 2 w1<, 8w1 ﬁ-e2 s1 + w2, W ﬁe2 s2 + 2 w2<<
expRule1@i_D := Exp@arg_D :> ExpAExpand@arg . OmgRule@@iDDD . e2 T0 -> T2E
Collecting the terms that may lead to secular terms, the terms proportional to EI wi T0, we have
Chapter8.nb
257

ST1 = CoefficientAorder2Eq@@2DD . expRule1@#D, EI w# T0E &  81, 2<;
ST1 . displayRule
8-2 I HD1A1L w1 F1@xD - 2 I EI T2 s1 HD1A2L w2 F2@xD, -2 I E-I T2 s1 HD1A1L w1 F1@xD - 2 I HD1A2L w2 F2@xD<
Because  the  homogeneous  parts  of  order2Eq and  corresponding  boundary  conditions  have  a  nontrivial  solution,  the
corresponding  nonhomogeneous  problem  has  a  solution  only  if  solvability  conditions  are  satisfied.  These  conditions
demand  that ST1  be  orthogonal to  every  solution of the  adjoint homogeneous  problem.  In this  case, the  problem is  self-
adjoint and hence solutions of the adjoint problem are given by the Fi@xD. Demanding that ST1[[i]] be orthogonal to the Fi@xD,
we obtain the solvability conditions
SCond1 = TableAà
0
1
ST1@@kDD Fk@xD âx == 0, 8k, 2<E . modeshapes
9-2 I w1 A1
H1,0L@T1, T2D == 0, -2 I w2 A2
H1,0L@T1, T2D == 0=
SCond1Rule = SolveASCond1, 9A1
H1,0L@T1, T2D, A2
H1,0L@T1, T2D=E@@1DD
9A1
H1,0L@T1, T2D ﬁ0, A2
H1,0L@T1, T2D ﬁ0=
whose complex conjugate is
ccSCond1Rule = SCond1Rule . conjugateRule
:A
1
H1,0L@T1, T2D ﬁ0, A
2
H1,0L@T1, T2D ﬁ0>
Substituting SCond1Rule and ccSCond1Rule into order2Eq and using modeshapes, we have
order2Eqm = order2Eq . SCond1Rule . ccSCond1Rule . modeshapes . int -> Integrate .
Integrate -> int;
order2Eqm . displayRule
Pk Hu2
''L + u2
'''' + D0
2u2 + 2 b2 p3 a int@Cos@p xD Hu2
'L, 8x, 0, 1<D Sin@p xD ==
- 1
2
b E-I T0 W f p2 Sin@p xD - 1
2
b EIT0 W f p2 Sin@p xD - 3 b E2 I T0 w1 p4 a Sin@p xD A1
2 -
8 b EI T0 Hw1+w2L p4 a Sin@2 p xD A1 A2 - 4 b E2 I T0 w2 p4 a Sin@p xD A2
2 -
6 b p4 a Sin@p xD A1 A
1 - 8 b EIT0 H-w1+w2L p4 a Sin@2 p xD A2 A
1 -
3 b E-2 I T0 w1 p4 a Sin@p xD A
1
2 - 8 b EI T0 Hw1-w2L p4 a Sin@2 p xD A1 A
2 -
8 b p4 a Sin@p xD A2 A
2 - 8 b EIT0 H-w1-w2L p4 a Sin@2 p xD A
1 A
2 - 4 b E-2 IT0 w2 p4 a Sin@p xD A
2
2
The associated boundary conditions are
order2BC = eqEps@@2DD  Rest
9u2@0, T0, T1, T2D == 0, u2
H2,0,0,0L@0, T0, T1, T2D == 0,
u2@1, T0, T1, T2D == 0, u2
H2,0,0,0L@1, T0, T1, T2D == 0=
We use the method of undetermined coefficients  to determine a particular solution of order2Eqm and order2BC. To accom-
plish this, we first determine the forms of the nonhomogeneous terms (i.e., the terms on the right-hand side of order2Eqm) as
258
Chapter8.nb

rhsTerms = Cases@order2Eqm@@2DD, #D &  9a_ f_@b_ xD :> f@b xD ; FreeQ@a, T0D,
_ Ea_ T0+b_. f_@c_ xD -> Ea T0+b f@c xD=  Flatten  Union
8Sin@p xD, E-I T0 W Sin@p xD, EI T0 W Sin@p xD, E-2 I T0 w1 Sin@p xD,
E2 I T0 w1 Sin@p xD, E-2 I T0 w2 Sin@p xD, E2 IT0 w2 Sin@p xD, E-I T0 w1-I T0 w2 Sin@2 p xD,
EI T0 w1-I T0 w2 Sin@2 p xD, E-I T0 w1+I T0 w2 Sin@2 p xD, EI T0 w1+I T0 w2 Sin@2 p xD<
which all satisfy  the order2BC. Since we have only  even spatial derivatives  on the left-hand side of order2Eqm, we seek a
particular solution as a linear combination of the rhsTerms as follows:
symbolList = Table@ai, 8i, Length@rhsTermsD<D
8a1, a2, a3, a4, a5, a6, a7, a8, a9, a10, a11<
sol2Form = u2 -> Function@8x, T0, T1, T2<, symbolList.rhsTerms  EvaluateD;
Substituting sol2Form into order2Eqm, equating coefficients of like terms, and solving for the symbolList, we have
symbolRule =
Solve@Coefficient@Subtract  order2Eqm . sol2Form . intRule1 . intRule2 . int ->
Integrate, rhsTermsD == 0 . Exp@_ T0 + _.D -> 0  Thread, symbolListD@@1DD
:a1 ﬁ- 2 H3 b p2 a A1@T1, T2D A
1@T1, T2D + 4 b p2 a A2@T1, T2D A
2@T1, T2DL





p2 - Pk + b2 p2 a
,
a2 ﬁ-
b f p2


2 Hp4 - p2 Pk + b2 p4 a - W2L
, a3 ﬁ-
b f p2


2 Hp4 - p2 Pk + b2 p4 a - W2L
,
a4 ﬁ-
3 b p4 a A
1@T1, T2D
2


p4 - p2 Pk + b2 p4 a - 4 w12 , a5 ﬁ-
3 b p4 a A1@T1, T2D2


p4 - p2 Pk + b2 p4 a - 4 w12 ,
a6 ﬁ-
4 b p4 a A
2@T1, T2D
2


p4 - p2 Pk + b2 p4 a - 4 w22 , a7 ﬁ-
4 b p4 a A2@T1, T2D2


p4 - p2 Pk + b2 p4 a - 4 w22 ,
a8 ﬁ- 8 b p4 a A
1@T1, T2D A
2@T1, T2D


16 p4 - 4 p2 Pk - w1
2 - 2 w1 w2 - w2
2 , a9 ﬁ- 8 b p4 a A1@T1, T2D A
2@T1, T2D


16 p4 - 4 p2 Pk - w1
2 + 2 w1 w2 - w2
2 ,
a10 ﬁ- 8 b p4 a A2@T1, T2D A
1@T1, T2D


16 p4 - 4 p2 Pk - w12 + 2 w1 w2 - w22 , a11 ﬁ- 8 b p4 a A1@T1, T2D A2@T1, T2D


16 p4 - 4 p2 Pk - w12 - 2 w1 w2 - w22 >
Substituting for the parameter values in symbolRule yields
Chapter8.nb
259

symbolRuleN = symbolRule . W -> 2 w2 . frequencies . bucklingLoad . values1
:a1 ﬁ- 6  !!!3 p2  !!!a A1@T1, T2D A
1@T1, T2D + 8  ! !!3 p2  ! !!a A2@T1, T2D A
2@T1, T2D





6 p2
, a2 ﬁ
f

12  !!!3 p2  !!!a
,
a3 ﬁ
f

12  ! !!3 p2  ! !!a
, a4 ﬁ
 !!!a A
1@T1, T2D
2

2  ! !!3
, a5 ﬁ
! !!a A1@T1, T2D2

2  !!!3
, a6 ﬁ2  !!!a A
2@T1, T2D
2


3  !!!3
,
a7 ﬁ2  ! !!a A2@T1, T2D2


3  !!!3
, a8 ﬁ4  !!!a A
1@T1, T2D A
2@T1, T2D


3  !!!3
, a9 ﬁ- 4 ! !!a A1@T1, T2D A
2@T1, T2D


 !!!3
,
a10 ﬁ- 4  !!!a A2@T1, T2D A
1@T1, T2D


 !!!3
, a11 ﬁ4  !!!a A1@T1, T2D A2@T1, T2D


3  ! !!3
>
Substituting symbolRuleN into sol2Form yields
sol2 = sol2Form . symbolRuleN
u2 ﬁFunctionB8x, T0, T1, T2<,
Sin@p xD I-I6  !!!3 p2  !!!a A1@T1, T2D A
1@T1, T2D + 8 ! !!3 p2 ! !!a A2@T1, T2D A
2@T1, T2DMM






6 p2
+
E-I T0 W Sin@p xD f

12  !!!3 p2  !!!a
+ EI T0 W Sin@p xD f

12  ! !!3 p2  ! !!a
+
E-2 I T0 w1 Sin@p xD J ! !!a A
1@T1, T2D
2N



2  !!!3
+
E2 I T0 w1 Sin@p xD I !!!a A1@T1, T2D2M



2  !!!3
+
E-2 I T0 w2 Sin@p xD J2  ! !!a A
2@T1, T2D
2N



3  !!!3
+
E2 I T0 w2 Sin@p xD I2  !!!a A2@T1, T2D2M



3  !!!3
+
E-I T0 w1-I T0 w2 Sin@2 p xD I4  !!!a A
1@T1, T2D A
2@T1, T2DM




3  !!!3
+
EI T0 w1-IT0 w2 Sin@2 p xD I-4  ! !!a A1@T1, T2D A
2@T1, T2DM




 !!!3
+
E-I T0 w1+I T0 w2 Sin@2 p xD I-4  !!!a A2@T1, T2D A
1@T1, T2DM




 !!!3
+
EI T0 w1+IT0 w2 Sin@2 p xD I4  !!!a A1@T1, T2D A2@T1, T2DM




3  !!!3
F
 Solvability Conditions
Substituting sol1 and sol2 into eqEps[[3,1]] and using intRule1 and intRule2 yields
order3Eq = HeqEps@@1, 1, 1DD . u1 -> u3L ==
HHeqEps@@1, 1, 1DD . u1 -> u3L - eqEps@@3, 1, 1DD . sol1 . sol2 . intRule1 . intRule2 .
modeshapes . int -> Integrate  ExpandL;  Timing
810.475 Second, Null<
260
Chapter8.nb

Collecting the terms that may lead to secular terms, the terms proportional to EI wi T0, we have
Chapter8.nb
261

ST2 = CoefficientAorder3Eq@@2DD . expRule1@#D, EI w# T0E &  81, 2<;
ST2 . displayRule
:- !!!2 HD1
2A1L Sin@p xD -  !!!2 EI T2 s1 HD1
2A2L Sin@2 p xD -
2 I  !!!2 HD2A1L Sin@p xD w1 - 2 I  !!!2 m Sin@p xD A1 w1 - 2 I  !!!2 EI T2 s1 HD2A2L Sin@2 p xD w2 -
2 I  !!!2 EIT2 s1 m Sin@2 p xD A2 w2 - E2 I T2 s1+I T2 s2 f p2 Sin@p xD A
1


 !!!2
-
b E2 IT2 s1+I T2 s2 f p2  ! !!a Sin@p xD A
1



2  !!!6
- 3  !!!2 p4 a Sin@p xD A1
2 A
1 + 5 $ % %%%
3
2
b p4 a32 Sin@p xD A1
2 A
1 -
8  !!!2 EIT2 s1 p4 a Sin@2 p xD A1 A2 A
1 + 68

3
$ % %%%
2
3
b EI T2 s1 p4 a32 Sin@2 p xD A1 A2 A
1 -
4  !!!2 E2I T2 s1 p4 a Sin@p xD A2
2 A
1 + 14 $ %%%%%
2
3
b E2 I T2 s1 p4 a32 Sin@p xD A2
2 A
1 -
2  !!!2 EIT2 s1+I T2 s2 f p2 Sin@2 p xD A
2 - 1
3
$ %% %%
2
3
b EI T2 s1+IT2 s2 f p2  ! !!a Sin@2 p xD A
2 -
4  !!!2 E-IT2 s1 p4 a Sin@2 p xD A1
2 A
2 + 14 $% %%%%
2
3
b E-I T2 s1 p4 a32 Sin@2 p xD A1
2 A
2 -
8  !!!2 p4 a Sin@p xD A1 A2 A
2 + 68

3
$ %%% %
2
3
b p4 a32 Sin@p xD A1 A2 A
2 -
48  !!!2 EIT2 s1 p4 a Sin@2 p xD A2
2 A
2 + 40

3
$ %%% %
2
3
b EI T2 s1 p4 a32 Sin@2 p xD A2
2 A
2,
- !!!2 E-I T2 s1 HD1
2A1L Sin@p xD -  !!!2 HD1
2A2L Sin@2 p xD - 2 I  !!!2 E-I T2 s1 HD2A1L Sin@p xD w1 -
2 I  !!!2 E-I T2 s1 m Sin@p xD A1 w1 - 2 I  !!!2 HD2A2L Sin@2 p xD w2 - 2 I  !!!2 m Sin@2 p xD A2 w2 -
EI T2 s1+IT2 s2 f p2 Sin@p xD A
1


 ! !!2
- b EI T2 s1+I T2 s2 f p2  !!!a Sin@p xD A
1



2  !!!6
-
3  !!!2 E-IT2 s1 p4 a Sin@p xD A1
2 A
1 + 5 $ %%%%%
3
2
b E-I T2 s1 p4 a32 Sin@p xD A1
2 A
1 -
8  !!!2 p4 a Sin@2 p xD A1 A2 A
1 + 68

3
$ %%% %
2
3
b p4 a32 Sin@2 p xD A1 A2 A
1 -
4  !!!2 EIT2 s1 p4 a Sin@p xD A2
2 A
1 + 14 $ %%%%%
2
3
b EI T2 s1 p4 a32 Sin@p xD A2
2 A
1 -
2  !!!2 EIT2 s2 f p2 Sin@2 p xD A
2 - 1
3
$ % %%%%
2
3
b EI T2 s2 f p2  !!!a Sin@2 p xD A
2 -
4  !!!2 E-2I T2 s1 p4 a Sin@2 p xD A1
2 A
2 + 14 $ % %%%%
2
3
b E-2 I T2 s1 p4 a32 Sin@2 p xD A1
2 A
2 -
8  !!!2 E-IT2 s1 p4 a Sin@p xD A1 A2 A
2 + 68

3
$ % %%%
2
3
b E-I T2 s1 p4 a32 Sin@p xD A1 A2 A
2 -
48  !!!2 p4 a Sin@2 p xD A2
2 A
2 + 40

3
$ % %%%
2
3
b p4 a32 Sin@2 p xD A2
2 A
2>
262
Chapter8.nb

Demanding that ST2[[i]] be orthogonal to the Fi@xD, we obtain the solvability conditions
SCond2 =
Table@int@ST2@@kDD Fk@xD, 8x, 0, 1<D == 0, 8k, 2<D . intRule1 . intRule2 . modeshapes .
values1 . int -> Integrate . D@SCond1Rule, T1D;
SCond2 . displayRule
9-2 I HD2A1L w1 - 2 I m A1 w1 - E2 I T2 s1+I T2 s2 f p2 A
1 + 12 p4 a A1
2 A
1 +
24 E2 I T2 s1 p4 a A2
2 A
1 + 112

3
p4 a A1 A2 A
2 == 0, -2 I HD2A2L w2 - 2 I m A2 w2 +
112

3
p4 a A1 A2 A
1 - 8
3
EI T2 s2 f p2 A
2 + 24 E-2 IT2 s1 p4 a A1
2 A
2 - 64

3
p4 a A2
2 A
2 == 0=
 8.1.3 The Function MMSDirect11
Collecting  the commands in  the preceding  section, we build  a function MMSDirect11, specifically  for the nonlinear trans-
verse vibrations of a hinged-hinged beam around its first buckled mode (EOM and BC1), to determine the solvability condi-
tions for different combinations of frequencies, modeshapes, and ResonanceConds in which the first mode might be involved
in either a one-to-one or a three-to-one internal resonance with one of the other modes.
MMSDirect11@frequencies_, modeshapes_, ResonanceConds_D :=
ModuleA8<,
multiScales = 8u@x_, tD -> u@x, T0, T1, T2D,
Derivative@m_, n_D@u_D@x_, tD -> dt@nD@D@u@x, T0, T1, T2D, 8x, m<DD, t -> T0<;
solRule = u -> IEvaluateASumAej uj@#1, #2, #3, #4D, 8j, 3<EE &M;
scaling = 9c -> 2 e2 m , f -> e2 f=;
eqs = HJoin@8EOM<, BC1D . multiScales . solRule . scaling . intRule1 . intRule2 
TrigToExp  ExpandAllL . en_;n>3 -> 0;
eqEps = Thread@CoefficientList@Subtract  #, eD == 0D &  eqs  Transpose  Rest;
sol1 = 9u1 -> FunctionA8x, T0, T1, T2<,
SumAAi@T1, T2D Fi@xD Exp@I wi T0D + A
i@T1, T2D Fi@xD Exp@-I wi T0D, 8i, 2<E  EvaluateE=;
order2Eq = HeqEps@@1, 1, 1DD . u1 -> u2L == HeqEps@@1, 1, 1DD . u1 -> u2L - eqEps@@2, 1, 1DD .
sol1 . intRule1 . intRule2  ExpandAll;
omgList = 8w1, w2<;
OmgRule =
Solve@ResonanceConds, Complement@omgList, 8#<D ~Join~ 8W<D@@1DD &  omgList;
expRule1@i_D := Exp@arg_D :> ExpAExpand@arg . OmgRule@@iDDD . e2 T0 -> T2E;
ST1 = CoefficientAorder2Eq@@2DD . expRule1@#D, EI w# T0 E &  81, 2<;
SCond1 = TableAà
0
1
ST1@@kDD Fk@xD â x == 0, 8k, 2<E . modeshapes;
SCond1Rule = SolveASCond1, 9A1
H1,0L@T1, T2D, A2
H1,0L@T1, T2D=E@@1DD;
ccSCond1Rule = SCond1Rule . conjugateRule;
order2Eqm = order2Eq . SCond1Rule . ccSCond1Rule . modeshapes . int -> Integrate .
Integrate -> int;
Chapter8.nb
263

rhsTerms = Cases@order2Eqm@@2DD, #D &  9a_ f_@b_ xD :> f@b xD ; FreeQ@a, T0D,
_ Ea_ T0+b_. f_@c_ xD -> Ea T0+b f@c xD=  Flatten  Union;
symbolList = Table@ai, 8i, Length@rhsTermsD<D;
sol2Form = u2 -> Function@8x, T0, T1, T2<, symbolList.rhsTerms  EvaluateD;
symbolRule =
Solve@Coefficient@Subtract  order2Eqm . sol2Form . intRule1 . intRule2 .
int -> Integrate, rhsTermsD == 0 . Exp@_ T0 + _.D -> 0  Thread, symbolListD@@1DD;
values1 = Solve@Select@ResonanceConds, FreeQ@#, WD &D . e -> 0 . frequencies, bD 
Flatten;
symbolRuleN = symbolRule . W -> 2 w2 . frequencies . bucklingLoad . values1;
sol2 = sol2Form . symbolRuleN;
order3Eq = HeqEps@@1, 1, 1DD . u1 -> u3L ==
HHeqEps@@1, 1, 1DD . u1 -> u3L - eqEps@@3, 1, 1DD . sol1 . sol2 . intRule1 . intRule2 .
modeshapes . int -> Integrate  ExpandL;
ST2 = CoefficientAorder3Eq@@2DD . expRule1@#D, EI w# T0 E &  81, 2<;
SCond2 =
Table@int@ST2@@kDD Fk@xD, 8x, 0, 1<D == 0, 8k, 2<D . intRule1 . intRule2 . modeshapes .
values1 . int -> Integrate . D@SCond1Rule, T1D;
Return@SCond2 . Ai_ -> HAi@#2D &L . f_@T1, T2D -> f@T2DD
E
 8.1.4 Three-to-One Internal Resonances Between the First Two Modes
In this section, we consider the case w2 » 3 w1 and W » 2 w2. To describe the nearness of the resonances, we introduce the
detuning parameters si defined by
ResonanceConds1 = 9w2 == 3 w1 + e2 s1, W == 2 w2 + e2 s2=;
Using MMSDirect11, we obtain the solvability conditions
MMSDirect11@frequencies, modeshapes, ResonanceConds1D  Timing
921.501 Second,
9-2 I m w1 A1@T2D + 12 p4 a A1@T2D2 A
1@T2D + 624

35
p4 a A1@T2D A2@T2D A
2@T2D - 2 I w1 A1
¢@T2D == 0,
-2 I m w2 A2@T2D + 624

35
p4 a A1@T2D A2@T2D A
1@T2D -
72

35
EI T2 s2 f p2 A
2@T2D - 576

35
p4 a A2@T2D2 A
2@T2D - 2 I w2 A2
¢@T2D == 0==
which indicates that this three-to-one internal resonance is not activated.
Next, we  consider the  case in  which  the frequency  of the  first mode  is  three  times  that  of the  second mode;  that  is, the
buckling load is  above the first crossover value. To accomplish this, we redefine the frequencies and denote the frequency of
the first mode by w2 and that of the second mode by w1 as follows:
264
Chapter8.nb

frequencies2 = 8w2 -> Hw . wSol1L, w1 -> Hw . wSol2 . n -> 2L<
9w2 ﬁb p2  !!!a , w1 ﬁ2  ! !!3 p2=
Moreover, we redefine the modeshapes according to
modeshapes2 = Join@modeshape,
8F1 -> Function@x, shape2  EvaluateD, F2 -> Function@x, shape1  EvaluateD<D;
To describe the nearness of the resonances, we introduce the two detuning parameters si defined by
ResonanceConds2 = 9w2 == 3 w1 + e2 s1, W == 2 w2 + e2 s2=;
Using MMSDirect11, we obtain the solvability conditions
MMSDirect11@frequencies2, modeshapes2, ResonanceConds2D  Timing
921.721 Second,
9-2 I m w1 A1@T2D + 64

5
p4 a A1@T2D2 A
1@T2D - 496

5
p4 a A1@T2D A2@T2D A
2@T2D - 2 I w1 A1
¢@T2D == 0,
-2 I m w2 A2@T2D - 496

5
p4 a A1@T2D A2@T2D A
1@T2D -
EI T2 s2 f p2 A
2@T2D + 12 p4 a A2@T2D2 A
2@T2D - 2 I w2 A2
¢ @T2D == 0==
Again, this three-to-one internal resonance is not activated.
 8.1.5 One-to-One and Three-to-One Internal Resonances Between the First and Third Modes
Variations of the first and third natural frequencies with the buckling level are plotted as follows:
0
5
10
15
20
25
30
b!!!a
0
50
100
150
200
250
300
w
C
b1:3
b1:1
b3:1
It follows from this  figure that the frequencies  of the first and third modes are equal when b  !!!!
a = b1:1, the frequency of the
third mode is three times that of the first mode when b  !!!!
a = b1:3, and the frequency of the first mode is three times that of
the third mode when b  !!!!
a =  b3:1.  Next, we use the function MMSDirect11 to treat these three cases.
Chapter8.nb
265

 One-to-One Internal Resonance
We denote the frequency of the third mode by w2 and that of the first mode by w1 as follows:
frequencies3 = 8w1 -> Hw . wSol1L, w2 -> Hw . wSol2 . n -> 3L<
9w1 ﬁb p2  !!!a , w2 ﬁ6  ! !!2 p2=
Moreover, we define fk and the first and third eigenmodes of the buckled beam as
modeshapes3 = Join@modeshape,
8F1 -> Function@x, shape1  EvaluateD, F2 -> Function@x, shape3  EvaluateD<D;
We consider a combination of a one-to-one internal resonance between the first and third modes  and a principal parametric
resonance of the third mode; that is,
ResonanceConds3 = 9w2 == w1 + e2 s1, W == 2 w2 + e2 s2=;
Using MMSDirect11, we obtain the solvability conditions
MMSDirect11@frequencies3, modeshapes3, ResonanceConds3D  Timing
826.809 Second,
8-2 I m w1 A1@T2D - E2 I T2 s1+I T2 s2 f p2 A
1@T2D + 12 p4 a A1@T2D2 A
1@T2D + 144 E2 I T2 s1 p4 a A2@T2D2 A
1@T2D +
144 p4 a A1@T2D A2@T2D A
2@T2D - 2 I w1 A1
¢ @T2D == 0,
-2 I m w2 A2@T2D + 144 p4 a A1@T2D A2@T2D A
1@T2D - 6 EIT2 s2 f p2 A
2@T2D +
144 E-2 I T2 s1 p4 a A1@T2D2 A
2@T2D - 108 p4 a A2@T2D2 A
2@T2D - 2 I w2 A2
¢@T2D == 0<<
which indicates that the one-to-one internal resonance between the first and third modes is activated.
 Three-to-One Internal Resonances
To treat the case in which the natural frequency of the third mode is approximately three times that of the first mode using the
function MMSDirect11, we denote these frequencies by w2 and w1, respectively, according to
frequencies4 = 8w1 -> Hw . wSol1L, w2 -> Hw . wSol2 . n -> 3L<
9w1 ﬁb p2  !!!a , w2 ﬁ6  ! !!2 p2=
Moreover, we define fk and the first and third eigenmodes of the buckled beam as
modeshapes4 = Join@modeshape,
8F1 -> Function@x, shape1  EvaluateD, F2 -> Function@x, shape3  EvaluateD<D;
We consider a combination of a three-to-one internal resonance between the first and third modes and a principal parametric
resonance of the third mode; that is,
ResonanceConds4 = 9w2 == 3 w1 + e2 s1, W == 2 w2 + e2 s2=;
266
Chapter8.nb

Using MMSDirect11, we obtain the solvability conditions
MMSDirect11@frequencies4, modeshapes4, ResonanceConds4D  Timing
921.651 Second,
9-2 I m w1 A1@T2D + 12 p4 a A1@T2D2 A
1@T2D + 1584

35
p4 a A1@T2D A2@T2D A
2@T2D - 2 I w1 A1
¢@T2D == 0,
-2 I m w2 A2@T2D + 1584

35
p4 a A1@T2D A2@T2D A
1@T2D -
162

35
EI T2 s2 f p2 A
2@T2D - 2916

35
p4 a A2@T2D2 A
2@T2D - 2 I w2 A2
¢@T2D == 0==
which indicates that this three-to-one internal resonance between the first and third modes is not activated.
When the frequency of first mode is approximately three times that of the third mode, we define the frequencies as
frequencies5 = 8w2 -> Hw . wSol1L, w1 -> Hw . wSol2 . n -> 3L<
9w2 ﬁb p2  !!!a , w1 ﬁ6  ! !!2 p2=
Moreover, we define fk and the third and first eigenmodes of the buckled beam as
modeshapes5 = Join@modeshape,
8F1 -> Function@x, shape3  EvaluateD, F2 -> Function@x, shape1  EvaluateD<D;
We consider a combination of a three-to-one internal resonance between the first and third modes and a principal parametric
resonance of the third mode; that is,
ResonanceConds5 = 9w2 == 3 w1 + e2 s1, W == 2 w2 + e2 s2=;
Using MMSDirect11, we obtain the solvability conditions
MMSDirect11@frequencies5, modeshapes5, ResonanceConds5D  Timing
921.712 Second,
9-2 I m w1 A1@T2D + 324

5
p4 a A1@T2D2 A
1@T2D - 2736

5
p4 a A1@T2D A2@T2D A
2@T2D - 2 I w1 A1
¢@T2D == 0,
-2 I m w2 A2@T2D - 2736

5
p4 a A1@T2D A2@T2D A
1@T2D -
EI T2 s2 f p2 A
2@T2D + 12 p4 a A2@T2D2 A
2@T2D - 2 I w2 A2
¢ @T2D == 0==
which indicates that this three-to-one internal resonance between the first and third modes is not activated.
 8.1.6 One-to-One and Three-to-One Internal Resonances Between the First and Fourth Modes
Variations of the first and fourth natural frequencies with the buckling level are plotted as follows:
Chapter8.nb
267

0
10
20
30
40
50
b!!!a
0
100
200
300
400
500
w
C
b1:3
b1:1
b3:1
Again, there  exist buckling levels  for which the frequencies  of the first and fourth modes  are in the ratio of 1:1, 3:1, and 1:3.
We use the function MMSDirect11 to treat these cases.
 One-to-One Internal Resonance
When  the frequencies  of the  first and  fourth modes  are approximately equal,  we denote  them by  w1  and  w2, respectively,
according to
frequencies6 = 8w1 -> Hw . wSol1L, w2 -> Hw . wSol2 . n -> 4L<
9w1 ﬁb p2  !!!a , w2 ﬁ4  ! !!!
15 p2=
Moreover, we define fk and the first and fourth eigenmodes of the buckled beam as
modeshapes6 = Join@modeshape,
8F1 -> Function@x, shape1  EvaluateD, F2 -> Function@x, shape4  EvaluateD<D;
We consider a combination of a one-to-one internal resonance between the first and fourth modes  and a principal parametric
resonance of the fourth mode; that is,
ResonanceConds6 = 9w2 == w1 + e2 s1, W == 2 w2 + e2 s2=;
Using MMSDirect11, we obtain the solvability conditions
MMSDirect11@frequencies6, modeshapes6, ResonanceConds6D  Timing
929.522 Second,
9-2 I m w1 A1@T2D - E2 I T2 s1+I T2 s2 f p2 A
1@T2D + 12 p4 a A1@T2D2 A
1@T2D + 480 E2 I T2 s1 p4 a A2@T2D2 A
1@T2D +
1216

3
p4 a A1@T2D A2@T2D A
2@T2D - 2 I w1 A1
¢@T2D == 0,
-2 I m w2 A2@T2D + 1216

3
p4 a A1@T2D A2@T2D A
1@T2D - 32

3
EI T2 s2 f p2 A
2@T2D +
480 E-2 I T2 s1 p4 a A1@T2D2 A
2@T2D - 1024

3
p4 a A2@T2D2 A
2@T2D - 2 I w2 A2
¢@T2D == 0==
which indicates that this one-to-one internal resonance between the first and fourth modes is activated.
268
Chapter8.nb

 Three-to-One Internal Resonances
When the frequency of the fourth mode is  approximately three times that of the first mode, we denote these frequencies  by
w2 and w1, respectively, as
frequencies7 = 8w1 -> Hw . wSol1L, w2 -> Hw . wSol2 . n -> 4L<
9w1 ﬁb p2  !!!a , w2 ﬁ4  ! !!!
15 p2=
Moreover, we define fk and the first and fourth eigenmodes of the buckled beam as
modeshapes7 = Join@modeshape,
8F1 -> Function@x, shape1  EvaluateD, F2 -> Function@x, shape4  EvaluateD<D;
We consider a combination of a three-to-one internal resonance between the first and fourth modes  and a principal paramet-
ric resonance of the fourth mode; that is,
ResonanceConds7 = 9w2 == 3 w1 + e2 s1, W == 2 w2 + e2 s2=;
Using MMSDirect11, we obtain the solvability conditions
MMSDirect11@frequencies7, modeshapes7, ResonanceConds7D  Timing
922.653 Second,
9-2 I m w1 A1@T2D + 12 p4 a A1@T2D2 A
1@T2D + 3264

35
p4 a A1@T2D A2@T2D A
2@T2D - 2 I w1 A1
¢@T2D == 0,
-2 I m w2 A2@T2D + 3264

35
p4 a A1@T2D A2@T2D A
1@T2D -
288

35
EI T2 s2 f p2 A
2@T2D - 9216

35
p4 a A2@T2D2 A
2@T2D - 2 I w2 A2
¢@T2D == 0==
which indicates that this three-to-one internal resonance between the first and fourth modes is not activated.
When the frequency of the first mode is  approximately three times that of the fourth mode, we denote these frequencies  by
w2 and w1, respectively, as
frequencies8 = 8w2 -> Hw . wSol1L, w1 -> Hw . wSol2 . n -> 4L<
9w2 ﬁb p2  !!!a , w1 ﬁ4  ! !!!
15 p2=
Moreover, we define fk and the fourth and first eigenmodes of the buckled beam as
modeshapes8 = Join@modeshape,
8F1 -> Function@x, shape4  EvaluateD, F2 -> Function@x, shape1  EvaluateD<D;
We consider a combination of a three-to-one internal resonance between the first and fourth modes  and a principal paramet-
ric resonance of the fourth mode; that is,
ResonanceConds8 = 9w2 == 3 w1 + e2 s1, W == 2 w2 + e2 s2=;
Chapter8.nb
269

Using MMSDirect11, we obtain the solvability conditions
MMSDirect11@frequencies8, modeshapes8, ResonanceConds8D  Timing
922.072 Second,
9-2 I m w1 A1@T2D + 1024

5
p4 a A1@T2D2 A
1@T2D - 8896

5
p4 a A1@T2D A2@T2D A
2@T2D - 2 I w1 A1
¢@T2D == 0,
-2 I m w2 A2@T2D - 8896

5
p4 a A1@T2D A2@T2D A
1@T2D -
EI T2 s2 f p2 A
2@T2D + 12 p4 a A2@T2D2 A
2@T2D - 2 I w2 A2
¢ @T2D == 0==
which indicates again that this three-to-one internal resonance between the first and fourth modes is not activated.
à 8.2 Circular Cylindrical Shells
Following McIvor (1966) and Raouf and Nayfeh (1990), we write the equations of motion governing the dynamic response of
an infinitely long cylindrical shell to a primary-resonance excitation of one of its two orthogonal flexural modes as
EOM = 9w - yq + wt,t + a2 Hw + 2 wq,q + wq,q,q,qL ==
- wq
2

2
- w wq
2 - yt
2 + w yt
2 - 2 w yq + 1
2
wq
2 yq + yq
2 - w yq
2 + f e3 Cos@n qD Cos@W tD H1 - w + yqL -
w wq,q - w2 wq,q + 3
2
wq
2 wq,q + yq wq,q + w yq wq,q - yq
2 wq,q + wq yq,q + w wq yq,q -
2 wq yq yq,q + a2 i
k
jjjj-3 w2 - 11 wq
2

2
- 11 w wq,q + 4 yq wq,q - 6 wq,q
2
+ 4 wq yq,q - 8 wq wq,q,q +
8 yq,q wq,q,q + w yq,q,q + 5 wq,q yq,q,q - 4 w wq,q,q,q + 4 yq wq,q,q,q + wq yq,q,q,q
y
{
zzzz,
wq + yt,t - yq,q == 2 w wq + wq3

2
+ 2 wt yt - 2 w wt yt - 2 wq yq + 2 w wq yq + wq wq,q +
w wq wq,q - 2 wq yq wq,q + 2 w yt,t - w2 yt,t - 2 w yq,q + w2 yq,q - wq
2 yq,q +
a2 Hwq wq,q - w wq,q,q - wq,q wq,q,q + wq wq,q,q,qL= . 8w -> w@q, tD, Hs : w ¨ yLm__ :> ¶m s@q, tD<;
We seek a second-order uniform asymptotic expansion of the solution of EOM in the form
solRule = 9w -> IEvaluateASumAej wj@#1, #2, #3, #4D, 8j, 3<EE &M,
y -> IEvaluateASumAej yj@#1, #2, #3, #4D, 8j, 3<EE &M=
8w ﬁHe w1@#1, #2, #3, #4D + e2 w2@#1, #2, #3, #4D + e3 w3@#1, #2, #3, #4D &L,
y ﬁHe y1@#1, #2, #3, #4D + e2 y2@#1, #2, #3, #4D + e3 y3@#1, #2, #3, #4D &L<
where #1 stands for q and #2, #3, and #4 stand for T0, T1, and T2, respectively. Transforming the time derivatives in EOM in
terms  of the scales  T0, T1, and T2, substituting solRule into EOM, expanding the result  for small e, and discarding  terms  of
order higher than e3, we obtain
270
Chapter8.nb

eq82a = HEOM . 8w@x_, tD -> w@x, T0, T1, T2D, y@x_, tD -> y@x, T0, T1, T2D,
Derivative@m_, n_D@w_D@x_, tD -> dt@nD@D@w@x, T0, T1, T2D, 8x, m<DD,
t -> T0< . solRule  ExpandAllL . en_;n>3 -> 0;
Equating coefficients of like powers of e, we have
eqEps = Rest@Thread@CoefficientList@Subtract  #, eD == 0DD &  eq82a  Transpose;
eqEps . displayRule
982 a2 Hw1
''L + a2 Hw1
''''L - y1
' + D0
2w1 + w1 + a2 w1 == 0, w1
' - y1
'' + D0
2y1 == 0<,
9 1
2
Hw1
'L
2 + 11

2
a2 Hw1
'L
2 + 6 a2 Hw1
''L
2 + 8 a2 Hw1
'L Hw1
'''L + 2 a2 Hw2
''L + a2 Hw2
''''L -
Hw1
''L Hy1
'L - 4 a2 Hw1
''L Hy1
'L - 4 a2 Hw1
''''L Hy1
'L - Hy1
'L
2 - Hw1
'L Hy1
''L - 4 a2 Hw1
'L Hy1
''L -
8 a2 Hw1
'''L Hy1
''L - 5 a2 Hw1
''L Hy1
'''L - a2 Hw1
'L Hy1
''''L - y2
' + HD0y1L2 + D0
2w2 + 2 HD0 D1w1L +
Hw1
''L w1 + 11 a2 Hw1
''L w1 + 4 a2 Hw1
''''L w1 + 2 Hy1
'L w1 - a2 Hy1
'''L w1 + 3 a2 w1
2 + w2 + a2 w2 == 0,
-Hw1
'L Hw1
''L - a2 Hw1
'L Hw1
''L + a2 Hw1
''L Hw1
'''L - a2 Hw1
'L Hw1
''''L + w2
' + 2 Hw1
'L Hy1
'L - y2
'' -
2 HD0w1L HD0y1L + D0
2y2 + 2 HD0 D1y1L - 2 Hw1
'L w1 + a2 Hw1
'''L w1 + 2 Hy1
''L w1 - 2 HD0
2y1L w1 == 0=,
9-f Cos@n qD Cos@T0 WD - 3
2
Hw1
'L
2 Hw1
''L + Hw1
'L Hw2
'L + 11 a2 Hw1
'L Hw2
'L + 8 a2 Hw1
'''L Hw2
'L +
12 a2 Hw1
''L Hw2
''L + 8 a2 Hw1
'L Hw2
'''L + 2 a2 Hw3
''L + a2 Hw3
''''L - 1
2
Hw1
'L
2 Hy1
'L - Hw2
''L Hy1
'L -
4 a2 Hw2
''L Hy1
'L - 4 a2 Hw2
''''L Hy1
'L + Hw1
''L Hy1
'L
2 - Hw2
'L Hy1
''L - 4 a2 Hw2
'L Hy1
''L - 8 a2 Hw2
'''L Hy1
''L +
2 Hw1
'L Hy1
'L Hy1
''L - 5 a2 Hw2
''L Hy1
'''L - a2 Hw2
'L Hy1
''''L - Hw1
''L Hy2
'L - 4 a2 Hw1
''L Hy2
'L -
4 a2 Hw1
''''L Hy2
'L - 2 Hy1
'L Hy2
'L - Hw1
'L Hy2
''L - 4 a2 Hw1
'L Hy2
''L - 8 a2 Hw1
'''L Hy2
''L -
5 a2 Hw1
''L Hy2
'''L - a2 Hw1
'L Hy2
''''L - y3
' + 2 HD0y1L HD0y2L + D0
2w3 + 2 HD0y1L HD1y1L +
2 HD0 D1w2L + D1
2w1 + 2 HD0 D2w1L + Hw1
'L
2 w1 + Hw2
''L w1 + 11 a2 Hw2
''L w1 + 4 a2 Hw2
''''L w1 -
Hw1
''L Hy1
'L w1 + Hy1
'L
2 w1 - Hw1
'L Hy1
''L w1 + 2 Hy2
'L w1 - a2 Hy2
'''L w1 - HD0y1L2 w1 + Hw1
''L w1
2 +
Hw1
''L w2 + 11 a2 Hw1
''L w2 + 4 a2 Hw1
''''L w2 + 2 Hy1
'L w2 - a2 Hy1
'''L w2 + 6 a2 w1 w2 + w3 + a2 w3 == 0,
- 1
2
Hw1
'L
3 - Hw1
''L Hw2
'L - a2 Hw1
''L Hw2
'L - a2 Hw1
''''L Hw2
'L - Hw1
'L Hw2
''L - a2 Hw1
'L Hw2
''L +
a2 Hw1
'''L Hw2
''L + a2 Hw1
''L Hw2
'''L - a2 Hw1
'L Hw2
''''L + w3
' + 2 Hw1
'L Hw1
''L Hy1
'L +
2 Hw2
'L Hy1
'L + Hw1
'L
2 Hy1
''L + 2 Hw1
'L Hy2
'L - y3
'' - 2 HD0w2L HD0y1L - 2 HD0w1L HD0y2L + D0
2y3 -
2 HD0y1L HD1w1L - 2 HD0w1L HD1y1L + 2 HD0 D1y2L + D1
2y1 + 2 HD0 D2y1L - Hw1
'L Hw1
''L w1 -
2 Hw2
'L w1 + a2 Hw2
'''L w1 - 2 Hw1
'L Hy1
'L w1 + 2 Hy2
''L w1 + 2 HD0w1L HD0y1L w1 - 2 HD0
2y2L w1 -
4 HD0 D1y1L w1 - Hy1
''L w1
2 + HD0
2y1L w1
2 - 2 Hw1
'L w2 + a2 Hw1
'''L w2 + 2 Hy1
''L w2 - 2 HD0
2y1L w2 == 0==
 8.2.1 First-Order Solution
To determine the solution of the first-order problem, eqEps[[1]], we use the method of separation of variables and let
svRule = 9w1 -> IA EI m #1 EI wm #2 &M, y1 -> IB EI m #1 EI wm #2 &M=;
Substituting the svRule into eqEps[[1]], we obtain the characteristic equations
Chapter8.nb
271

eqEps1lhs = ExpandAE-I m q-I wm T0 #@@1DD . svRuleE &  eqEps@@1DD
8A - I B m + A a2 - 2 A m2 a2 + A m4 a2 - A wm
2, I A m + B m2 - B wm
2<
Setting  the  determinant  of the  coefficient  matrix in  eqEps1lhs  equal to  zero  yields  the  following equation  governing  the
natural frequencies wm of the shell:
HOuter@D, eqEps1lhs, 8A, B<D  Det  Collect@#, wmD &L == 0
m2 a2 - 2 m4 a2 + m6 a2 + H-1 - m2 - a2 + 2 m2 a2 - m4 a2L wm
2 + wm
4 == 0
It follows from eqEps1lhs that the ratio Gm = I B
A  of the amplitudes of y1 and w1 is given by
GRule = Gm -> FactorAI B

A
. Solve@eqEps1lhs@@1DD == 0, BD@@1DDE
Gm ﬁ1 + a2 - 2 m2 a2 + m4 a2 - wm
2


m
Hence, the solution of eqEps[[1]] can be expressed in terms of the linear free-vibration modes
modeShapes = ComplexExpand@8Re@#D, Im@#D<D &  8Exp@I n qD, -I Gn Exp@I n qD<
88Cos@n qD, Sin@n qD<, 8Sin@n qD Gn, -Cos@n qD Gn<<
as
sol1Form =
modeShapes.TableAAi,n@T1, T2D Exp@I wn T0D + A
i,n@T1, T2D Exp@-I wn T0D, 8i, 2<E  Expand
8EI T0 wn Cos@n qD A1,n@T1, T2D + EIT0 wn Sin@n qD A2,n@T1, T2D +
E-I T0 wn Cos@n qD A
1,n@T1, T2D + E-I T0 wn Sin@n qD A
2,n@T1, T2D, EI T0 wn Sin@n qD Gn A1,n@T1, T2D-
EI T0 wn Cos@n qD Gn A2,n@T1, T2D + E-I T0 wn Sin@n qD Gn A
1,n@T1, T2D - E-I T0 wn Cos@n qD Gn A
2,n@T1, T2D<
It follows from the sol1Form that all of the flexural modes  are degenerate because two linearly independent eigenfunctions,
namely Cos@n  qD and Sin@n  qD, correspond to the same frequency wn for each n.
We consider the case of a primary-resonance excitation of the Cos@n  qD mode corresponding to the frequency wn; it is  called
the driven mode. Because of the degeneracy, this mode is involved in a one-to-one internal resonance with the Sin@n qD mode,
which is  called the companion mode. We assume  that neither of these two modes  is  involved in an internal resonance with
any other mode. Therefore, in  the presence of viscous damping, out of the infinite number of modes  present in w1 and y1,
only  the  driven mode  Cos@n qD and its  companion  mode  Sin@n qD will contribute  to  the steady-state  response (Nayfeh and
Mook, 1979). Consequently, we take the solution of the first-order problem to consist only of these two modes and express it
as
sol1 = 8w1 -> Function@8q, T0, T1, T2<, sol1Form@@1DD  EvaluateD,
y1 -> Function@8q, T0, T1, T2<, sol1Form@@2DD  EvaluateD<;
To describe the nearness of the primary resonance, we introduce the detuning parameter s defined by
272
Chapter8.nb

ResonanceCond = 9W == wn + e2 s=;
where the detuning is ordered at e2 because secular terms appear first at order e3.
 8.2.2 Second-Order Solution
Substituting the sol1 into the second-order problem, eqEps[[2]], we obtain
order2Eq =
Table@HeqEps@@1, i, 1DD . 8w1 -> w2, y1 -> y2<L == HeqEps@@1, i, 1DD . 8w1 -> w2, y1 -> y2<L -
HSubtract  eqEps@@2, iDD . sol1  ExpandL, 8i, 2<D;
Collecting the terms that may lead to secular terms, the terms proportional to EI wn T0, we have
ST1 = CoefficientA#@@2DD, EI wn T0E &  order2Eq
9-2 I Cos@n qD wn A1,n
H1,0L@T1, T2D - 2 I Sin@n qD wn A2,n
H1,0L@T1, T2D,
-2 I Sin@n qD Gn wn A1,n
H1,0L@T1, T2D + 2 I Cos@n qD Gn wn A2,n
H1,0L@T1, T2D=
Because the  homogeneous  parts  of order2Eq have  a  nontrivial solution, the  corresponding  nonhomogeneous  equations
have  a  solution  only  if solvability  conditions  are  satisfied. These  conditions  demand  that  ST1  be  orthogonal to  every
solution  of the  adjoint homogeneous  equations. In  this  case,  these equations  are self-adjoint  and  hence  solutions  of the
adjoint equations are given by the transpose of the modeShapes. Demanding that ST1 be orthogonal to the transpose of the
modeShapes, we obtain the solvability conditions
SCond1 =
SolveAHint@#, 8q, 0, 2 p<D &  HTranspose@modeShapesD.ST1L . intRule1 . intRule2 .
8int@Cos@s_D Sin@s_D, _D -> 0, int@f_@n qD ^2, arg_D -> p<L == 0 
Thread, 9A1,n
H1,0L@T1, T2D, A2,n
H1,0L@T1, T2D=E@@1DD
9A1,n
H1,0L@T1, T2D ﬁ0, A2,n
H1,0L@T1, T2D ﬁ0=
Having determined the solvability conditions of the second-order equations, order2Eq, we use a combination of the superpo-
sition  principle  and  the  method  of undetermined  coefficients  to  determine  a  particular solution  of  them.  To  this  end, we
identify the forms of all of the possible terms on the right-hand sides of order2Eq as follows:
collectForm = OuterATimes, 8Cos@n qD, Sin@n qD<,
TableA9Ai,n@T1, T2D EI wn T0, A
i,n@T1, T2D E-Iwn T0=, 8i, 2<E  FlattenE  Flatten
8EI T0 wn Cos@n qD A1,n@T1, T2D, E-I T0 wn Cos@n qD A
1,n@T1, T2D,
EI T0 wn Cos@n qD A2,n@T1, T2D, E-I T0 wn Cos@n qD A
2,n@T1, T2D, EI T0 wn Sin@n qD A1,n@T1, T2D,
E-I T0 wn Sin@n qD A
1,n@T1, T2D, EI T0 wn Sin@n qD A2,n@T1, T2D, E-I T0 wn Sin@n qD A
2,n@T1, T2D<
Chapter8.nb
273

possibleTerms = Flatten@If@Head@#D === Plus, List  #, #D & 
HOuter@Times, collectForm, collectFormD  Flatten  Union  TrigReduce 
ExpandLD . c_? NumberQ form_ -> form  Union;
possibleTerms . displayRule
:E2 I T0 wn A1,n
2 , E2 I T0 wn Cos@2 n qD A1,n
2
, E2 IT0 wn Sin@2 n qD A1,n
2
, E2 I T0 wn A1,n A2,n,
E2 I T0 wn Cos@2 n qD A1,n A2,n, E2 I T0 wn Sin@2 n qD A1,n A2,n, E2 I T0 wn A2,n
2
, E2 I T0 wn Cos@2 n qD A2,n
2
,
E2 I T0 wn Sin@2 n qD A2,n
2
, A1,n A
1,n, Cos@2 n qD A1,n A
1,n, Sin@2 n qD A1,n A
1,n, A2,n A
1,n,
Cos@2 n qD A2,n A
1,n, Sin@2 n qD A2,n A
1,n, E-2 I T0 wn A
1,n
2
, E-2 I T0 wn Cos@2 n qD A
1,n
2
,
E-2 I T0 wn Sin@2 n qD A
1,n
2
, A1,n A
2,n, Cos@2 n qD A1,n A
2,n, Sin@2 n qD A1,n A
2,n, A2,n A
2,n,
Cos@2 n qD A2,n A
2,n, Sin@2 n qD A2,n A
2,n, E-2 I T0 wn A
1,n A
2,n, E-2 I T0 wn Cos@2 n qD A
1,n A
2,n,
E-2 I T0 wn Sin@2 n qD A
1,n A
2,n, E-2 I T0 wn A
2,n
2
, E-2 I T0 wn Cos@2 n qD A
2,n
2
, E-2 I T0 wn Sin@2 n qD A
2,n
2
>
possibleTerms  Length
30
We note that the complex conjugate of each term on the right-hand sides of order2Eq is also a term on their right-hand sides.
Therefore, we use this  fact to reduce the algebra  and calculate only the particular solutions corresponding to almost half of
the terms because the particular solutions corresponding to the remaining terms  are the complex conjugates of those already
calculated.  Then, we  express  the  right-hand  side  of order2Eq[[i]]  as  the  sum of  two  terms,  tempList[i]  and  its  complex
conjugate, for i = 1 and 2, according to
DoAeq2rhsList = List  order2Eq@@i, 2DD; tempList@iD = eq2rhsList;
IfAterm = # . conjugateRule;
MemberQ@tempList@iD, termD, tempList@iD = Complement@tempList@iD, 8#<D;
IfA# === term, AppendToAtempList@iD, 1
2
#EEE &  Reverse@eq2rhsListD, 8i, 2<E
Next, we determine the coefficients of the possibleTerms in each of the tempList[i] according to
Do@rhs = Plus  tempList@iD . SCond1  TrigReduce  Expand;
coeffs@iD = Coefficient@rhs, possibleTermsD . HCos ¨ SinL@2 n qD -> 0, 8i, 2<D
and denote them by ci, j as
symbolList1 = MapIndexed@If@#1 =!= 0, cSequence #2, 0D &, Array@coeffs, 2D, 82<D
88c1,1, c1,2, 0, 0, 0, c1,6, c1,7, c1,8, 0, c1,10, c1,11, 0, 0, 0, c1,15, 0,
0, 0, 0, 0, 0, c1,22, c1,23, 0, 0, 0, 0, 0, 0, 0<, 80, 0, c2,3, 0, c2,5, 0, 0, 0,
c2,9, 0, 0, c2,12, 0, c2,14, 0, 0, 0, 0, 0, 0, 0, 0, 0, c2,24, 0, 0, 0, 0, 0, 0<<
symbolList2@s_D = Plus  symbolList1 . c -> s;
where ci, j = coeffs[i][[j]]. Moreover, we associate with the jth term in the symbolList1[[i]] the undetermined coefficient di, j
in w2 and the undetermined coefficient ei, j in y2 by replacing the ci, j in symbolList1[[i]] with di, j and ei, j according to
274
Chapter8.nb

sol2temp = 8w2 -> Function@8q, T0, T1, T2<, symbolList2@dD.possibleTerms  EvaluateD,
y2 -> Function@8q, T0, T1, T2<, symbolList2@eD.possibleTerms  EvaluateD<;
Substituting the sol2temp into the left-hand sides  of the second-order equations, order2Eq, setting the coefficient of the jth
term in possibleTerms in the ith equation equal to ci, j, and solving the resulting algebraic equations, we obtain
deRule = Solve@
Flatten@Table@Coefficient@order2Eq@@i, 1DD . sol2temp, possibleTermsD . f_@2 n qD -> 0,
8i, 2<DD == Flatten@symbolList1D  Thread  Union,
8symbolList2@dD, symbolList2@eD<  Flatten  Union  RestD@@1DD
Solve::svars :  Equations may not give solutions for all "solve" variables.
:e1,1 ﬁ0, e1,7 ﬁ0, d1,10 ﬁ
c1,10

1 + a2 , d1,22 ﬁc1,22

1 + a2 , e1,11 ﬁ0, e1,15 ﬁ0,
e1,23 ﬁ0, e2,12 ﬁ-
-2 n c1,11 - c2,12


4 n2 H-1 + 4 n2L2 a2
+ c2,12

4 n2 , e2,14 ﬁc2,14

4 n2 +
-2 n c1,15 + c2,14


4 n2 H-1 + 4 n2L2 a2
,
e2,24 ﬁ-
-2 n c1,23 - c2,24


4 n2 H-1 + 4 n2L2 a2
+ c2,24

4 n2 , d1,1 ﬁ
c1,1

1 + a2 - 4 wn2 , d1,7 ﬁ
c1,7

1 + a2 - 4 wn2 , e1,2 ﬁ0, e1,6 ﬁ0,
e1,8 ﬁ0, e2,3 ﬁ
c2,3

4 n2 - 4 wn2 -
2 n H-H4 n2 - 4 wn
2L c1,2 - 2 n c2,3L





H4 n2 - 4 wn2L H-4 n2 + H4 n2 - 4 wn2L H1 + a2 - 8 n2 a2 + 16 n4 a2 - 4 wn2LL
,
e2,5 ﬁc1,6

2 n
+ H1 + a2 - 8 n2 a2 + 16 n4 a2 - 4 wn2L HH4 n2 - 4 wn2L c1,6 - 2 n c2,5L





2 n H4 n2 - H4 n2 - 4 wn2L H1 + a2 - 8 n2 a2 + 16 n4 a2 - 4 wn2LL
,
e2,9 ﬁ- c1,8

2 n
- H1 + a2 - 8 n2 a2 + 16 n4 a2 - 4 wn
2L HH4 n2 - 4 wn
2L c1,8 + 2 n c2,9L





2 n H4 n2 - H4 n2 - 4 wn2L H1 + a2 - 8 n2 a2 + 16 n4 a2 - 4 wn2LL
,
d1,11 ﬁ- -2 n c1,11 - c2,12


2 n H-1 + 4 n2L2 a2
, d1,15 ﬁ- -2 n c1,15 + c2,14


2 n H-1 + 4 n2L2 a2
, d1,23 ﬁ-
-2 n c1,23 - c2,24


2 n H-1 + 4 n2L2 a2
,
d2,12 ﬁ0, d2,14 ﬁ0, d2,24 ﬁ0, d1,2 ﬁ-
-H4 n2 - 4 wn
2L c1,2 - 2 n c2,3




-4 n2 + H4 n2 - 4 wn2L H1 + a2 - 8 n2 a2 + 16 n4 a2 - 4 wn2L
,
d1,6 ﬁ-
H4 n2 - 4 wn
2L c1,6 - 2 n c2,5




4 n2 - H4 n2 - 4 wn2L H1 + a2 - 8 n2 a2 + 16 n4 a2 - 4 wn2L
,
d1,8 ﬁ-
H4 n2 - 4 wn2L c1,8 + 2 n c2,9




4 n2 - H4 n2 - 4 wn2L H1 + a2 - 8 n2 a2 + 16 n4 a2 - 4 wn2L
, d2,3 ﬁ0, d2,5 ﬁ0, d2,9 ﬁ0>
To simplify the expressions in the second-order solution, we introduce the notation
Chapter8.nb
275

paperNotationRule = ThreadAHsymbolList2@cD  Union  RestL ->
9c2, c1, 2 c1, c2, -c1, -c4, - 1
2
 c3, -c3, -c4, 1
2
 c3, d1, -2 d1, -d1, - 1
2
 d2, d2, 1
2
 d2=E~Join~
9I1 + a2 - 8 n2 a2 + 16 n4 a2 - 4 wn
2M ->
Dn + 4 n2

4 n2 - 4 wn2 , PowerA-1 + 4 n2, -2E Power@a, -2D -> 4 n2

Qn
=
:c1,1 ﬁc2, c1,2 ﬁc1, c1,6 ﬁ2 c1, c1,7 ﬁc2, c1,8 ﬁ-c1, c1,10 ﬁ-c4, c1,11 ﬁ- c3

2
, c1,15 ﬁ-c3,
c1,22 ﬁ-c4, c1,23 ﬁc3

2
, c2,3 ﬁd1, c2,5 ﬁ-2 d1, c2,9 ﬁ-d1, c2,12 ﬁ- d2

2
, c2,14 ﬁd2,
c2,24 ﬁd2

2
, 1 + a2 - 8 n2 a2 + 16 n4 a2 - 4 wn
2 ﬁ
4 n2 + Dn

4 n2 - 4 wn2 ,
1

H-1 + 4 n2L2 a2 ﬁ4 n2

Qn
>
Then, we express the second-order solution as
w2Sol = symbolList2@dD.possibleTerms . deRule . paperNotationRule;
w2Sol . displayRule
E2 I T0 wn c2 A1,n
2

1 +a2 - 4 wn2
-
E2 I T0 wn Cos@2 n qD H-2 n d1 - c1 H4 n2 - 4 wn2LL A1,n
2




Dn
+
E2 I T0 wn Sin@2 n qD H4 n d1 + 2 c1 H4 n2 - 4 wn
2LL A1,n A2,n




Dn
+
E2 I T0 wn c2 A2,n
2

1 + a2 - 4 wn2
+
E2 I T0 wn Cos@2 n qD H-2 n d1 - c1 H4 n2 - 4 wn
2LL A2,n
2




Dn
- c4 A1,n A
1,n

1 + a2
-
2 n Cos@2 n qD In c3 + d2

2 M A1,n A
1,n



Qn
-
2 n Sin@2 n qD H2 n c3 + d2L A2,n A
1,n



Qn
- c4 A2,n A
2,n

1 + a2
-
2 n Cos@2 n qD I-n c3 - d2

2 M A2,n A
2,n



Qn
y2Sol = symbolList2@eD.possibleTerms . deRule . paperNotationRule . ei__ -> 0;
y2Sol . displayRule
E2 I T0 wn Sin@2 n qD
i
k
jjjj
d1

4 n2 - 4 wn2 - 2 n H-2 n d1 - c1 H4 n2 - 4 wn
2LL


Dn H4 n2 - 4 wn2L
y
{
zzzz A1,n
2
+
E2 I T0 wn Cos@2 n qD i
k
jjj
c1

n
- H4 n2 + DnL H4 n d1 + 2 c1 H4 n2 - 4 wn2LL



2 n Dn H4 n2 - 4 wn2L
y
{
zzz A1,n A2,n +
E2 I T0 wn Sin@2 n qD i
k
jjjj
c1

2 n
+ H4 n2 + DnL H-2 n d1 - c1 H4 n2 - 4 wn
2LL



2 n Dn H4 n2 - 4 wn2L
y
{
zzzz A2,n
2
+
Sin@2 n qD
i
k
jjjj- d2

8 n2 -
n c3 + d2

2

Qn
y
{
zzzz A1,n A
1,n +
Cos@2 n qD i
k
jj d2

4 n2 + 2 n c3 + d2

Qn
y
{
zz A2,n A
1,n + Sin@2 n qD
i
k
jjjj
d2

8 n2 -
-n c3 - d2

2

Qn
y
{
zzzz A2,n A
2,n
We express this solution in pure function form as
sol2 = 8w2 -> Function@8q, T0, T1, T2<, w2Sol + Hw2Sol . conjugateRuleL  EvaluateD,
y2 -> Function@8q, T0, T1, T2<, y2Sol + Hy2Sol . conjugateRuleL  EvaluateD<;
276
Chapter8.nb

 8.2.3 Solvability Conditions
Substituting the sol1 and sol2 into eqEps[[3]] yields
order3Eq =
Table@HeqEps@@1, i, 1DD . 8w1 -> w3, y1 -> y3<L == HeqEps@@1, i, 1DD . 8w1 -> w3, y1 -> y3<L -
HSubtract  eqEps@@3, iDD . sol1 . sol2  TrigToExp  ExpandL, 8i, 2<D;  Timing
890.5 Second, Null<
To convert  the terms  that lead to  small-divisor terms  in the third-order equations, order3Eq, into terms  that lead to  secular
terms, we introduce the rule
expRule1 = Exp@arg_D :> ExpAExpand@arg . HResonanceCond . Equal -> RuleLD . e2 T0 -> T2E;
Then, the sources of secular terms in order3Eq, the terms proportional to Exp@– I n q +I wn T0D, are
ST2 =
Expand@Coefficient@#@@2DD . Exp@c1_. + Complex@0, s_ ; Abs@sD != 1D n qD -> 0 . expRule1,
Exp@I wn T0DD . Exp@c1_. + Complex@0, m_D n qD ->
HCos@n qD + I m Sin@n qDL Exp@c1DD &  order3Eq;  Timing
864.343 Second, Null<
These terms consist of linear and cubic terms in the complex-valued amplitudes Ai. The cubic terms are proportional to
cubicTerms =
Flatten@If@Head@#D === Plus, List  #, #D &  HNest@Outer@Times, collectForm, #D &,
collectForm, 2D  Flatten  Union  TrigReduce  ExpandLD .
8f_@s_ n qD -> 0, Exp@c1_. + Complex@0, s_ ; s != 1D wn T0D -> 0< .
Exp@_D -> 1 . c_? NumberQ form_ -> form  Union  Rest;
cubicTerms . displayRule
8Cos@n qD A1,n
2
A
1,n, Sin@n qD A1,n
2
A
1,n, Cos@n qD A1,n A2,n A
1,n, Sin@n qD A1,n A2,n A
1,n,
Cos@n qD A2,n
2
A
1,n, Sin@n qD A2,n
2
A
1,n, Cos@n qD A1,n
2
A
2,n, Sin@n qD A1,n
2
A
2,n,
Cos@n qD A1,n A2,n A
2,n, Sin@n qD A1,n A2,n A
2,n, Cos@n qD A2,n
2
A
2,n, Sin@n qD A2,n
2
A
2,n<
And, their coefficients in ST2 are
coef2 = Outer@Coefficient, ST2, cubicTermsD;
which we denote by
symbolList3 = MapIndexed@If@#1 =!= 0, gSequence #2, 0D &, coef2, 82<D;
Chapter8.nb
277

notationRule = HsymbolList3  Flatten  Union  RestL ->
8E2, E1, E3, E3, E1, E2, -G2, G1, -G3, G3, -G1, G2<  Thread
8g1,1 ﬁE2, g1,4 ﬁE1, g1,5 ﬁE3, g1,8 ﬁE3, g1,9 ﬁE1, g1,12 ﬁE2,
g2,2 ﬁ-G2, g2,3 ﬁG1, g2,6 ﬁ-G3, g2,7 ﬁG3, g2,10 ﬁ-G1, g2,11 ﬁG2<
In terms of this notation, ST2 can be rewritten as
ST2New = H# . Thread@cubicTerms -> 0D &  ST2L + symbolList3.cubicTerms . notationRule .
D@SCond1, T1D;
ST2New . displayRule
9 1
2
EI T2 s f Cos@n qD - 2 I Cos@n qD HD2A1,nL wn - 2 I HD2A2,nL Sin@n qD wn +
Cos@n qD E2 A1,n
2
A
1,n + Sin@n qD E1 A1,n A2,n A
1,n + Cos@n qD E3 A2,n
2
A
1,n + Sin@n qD E3 A1,n
2
A
2,n +
Cos@n qD E1 A1,n A2,n A
2,n + Sin@n qD E2 A2,n
2
A
2,n, 2 I Cos@n qD HD2A2,nL Gn wn -
2 I HD2A1,nL Sin@n qD Gn wn - Sin@n qD G2 A1,n
2
A
1,n + Cos@n qD G1 A1,n A2,n A
1,n -
Sin@n qD G3 A2,n
2
A
1,n + Cos@n qD G3 A1,n
2
A
2,n - Sin@n qD G1 A1,n A2,n A
2,n + Cos@n qD G2 A2,n
2
A
2,n=
The solvability conditions of order3Eq demand that the vector ST2New be orthogonal to the transpose of the modeShapes;
that is,
SCond2 = ExpandA 1
p
int@#, 8q, 0, 2 p<D &  HTranspose@modeShapesD.ST2NewL . intRule1 .
intRule2 . 8int@Cos@s_D Sin@s_D, _D -> 0, int@f_@n qD ^2, _D -> p<E == 0  Thread;
SCond2 . displayRule
9 1
2
EI T2 s f - 2 I HD2A1,nL wn - 2 I HD2A1,nL Gn
2 wn + E2 A1,n
2
A
1,n -
G2 Gn A1,n
2
A
1,n + E3 A2,n
2
A
1,n - G3 Gn A2,n
2
A
1,n + E1 A1,n A2,n A
2,n - G1 Gn A1,n A2,n A
2,n == 0,
-2 I HD2A2,nL wn - 2 I HD2A2,nL Gn
2 wn + E1 A1,n A2,n A
1,n - G1 Gn A1,n A2,n A
1,n +
E3 A1,n
2
A
2,n - G3 Gn A1,n
2
A
2,n + E2 A2,n
2
A
2,n - G2 Gn A2,n
2
A
2,n == 0=
à 8.3 Near-Square Plates
We consider the nonlinear transverse vibrations of a near-square  simply supported plate that is  initially flat. We introduce a
Cartesian coordinate system x y z, with the x and y axes lying in the undisturbed plane of the middle surface of the plate, and
let u, v, and w denote the displacements of the middle surface in the x, y, and z directions, respectively. Then, the equations
of motion are (Chu and Herrmann, 1956)
Needs@"Calculus`VectorAnalysis`"D
BH@wD = Biharmonic@w@x, y, tD, Cartesian@x, y, zDD
wH0,4,0L@x, y, tD + 2 wH2,2,0L@x, y, tD + wH4,0,0L@x, y, tD
278
Chapter8.nb

EOM = 9
ux,x + wx wx,x + n Hvx,y + wy wx,yL + 1
2
 H1 - nL Huy,y + vx,y + wx wy,y + wy wx,yL == cp
-2 ut,t,
vy,y + wy wy,y + n Hux,y + wx wx,yL + 1
2
 H1 - nL Hvx,x + ux,y + wy wx,x + wx wx,yL == cp
-2 vt,t,
1

12
 h2 BH@wD - N1
i wx,x - 2 N12
i
wx,y - N2
i wy,y - ux wx,x -
1
2
 wx
2 wx,x - vy wy,y - 1
2
 wy
2 wy,y - n i
k
jjvy wx,x + 1
2
 wy
2 wx,x + ux wy,y + 1
2
 wx
2 wy,yy
{
zz -
H1 - nL Huy + vx + wx wyL wx,y == -cp
-2 Hwx ut,t + wy vt,t + wt,tL +
F I1 - n2M

Es h
= . Hs : u ¨ v ¨ wLm__ :> ¶m s@x, y, tD;
and the boundary conditions are
BC = 88u@x, y, tD == 0, w@x, y, tD == 0, ¶x,x w@x, y, tD == 0< . 88x -> 0<, 8x -> a<<,
8v@x, y, tD == 0, w@x, y, tD == 0, ¶y,y w@x, y, tD == 0< . 88y -> 0<, 8y -> b<<<  Flatten
8u@0, y, tD == 0, w@0, y, tD == 0, wH2,0,0L@0, y, tD == 0, u@a, y, tD == 0,
w@a, y, tD == 0, wH2,0,0L@a, y, tD == 0, v@x, 0, tD == 0, w@x, 0, tD == 0,
wH0,2,0L@x, 0, tD == 0, v@x, b, tD == 0, w@x, b, tD == 0, wH0,2,0L@x, b, tD == 0<
where cp
2 = Es HrH1- n2LL, Es  is  Young's  modulus, n  is  Poisson's  ratio, r and h  are the  density and thickness  of the plate,
respectively, F  is  the transverse load, the Nk
i  are the uniformly distributed in-plane applied edge loads, and a and b are the
edge lengths, with b » a. EOM are usually  called the dynamic analog of the von Karman equations because they reduce to
von Karman's equations (1910) in the absence of the time derivatives.
For thin plates, h a is very small, which we denote by  !!!e . Next, we introduce the aspect ratio c = a b, define the rule
scaleRule1 = 9h2 -> e a2, a -> c b=;
and nondimensionalize the variables as
charT =  !! !!!! !!!
12  e  a  cp;
H* characteristic time *L
nondimRule = 9Hdv : u ¨ v ¨ wL -> Ha dv@#1  a, #2  b, #3  charTD &L,
F -> F Es h  I12 a I1 - n2MM, x -> a x, y -> b y, t -> charT t=;
Substituting nondimRule and scaleRule1 into EOM and BC and considering the case of no in-plane edge loads, we obtain
EOM1 = Ia HSubtract  #L . Nk_
i -> 0 . nondimRule . scaleRule1  ExpandM == 0 &  EOM;
BC1 = BC . nondimRule . c_ h_@a__, tD :> h@a, tD
8u@0, y, tD == 0, w@0, y, tD == 0, wH2,0,0L@0, y, tD == 0, u@1, y, tD == 0,
w@1, y, tD == 0, wH2,0,0L@1, y, tD == 0, v@x, 0, tD == 0, w@x, 0, tD == 0,
wH0,2,0L@x, 0, tD == 0, v@x, 1, tD == 0, w@x, 1, tD == 0, wH0,2,0L@x, 1, tD == 0<
Chapter8.nb
279

To write EOM1 in a more concise way, we introduce the display rule
display1@expr_D := expr . 8Derivative@a_, b_, c_D@w_D@x, y, tD :>
Subscript@w, Sequence  Join@Table@x, 8a<D, Table@y, 8b<D, Table@t, 8c<DDD<
and obtain
EOM1@@1DD  display1
EOM1@@2DD  display1
EOM1@@3DD  display1
- 1

12
e ut,t + ux,x + 1
2
c2 uy,y - 1
2
c2 n uy,y + 1
2
c vx,y + 1
2
c n vx,y +
wx wx,x + 1
2
c2 wy wx,y + 1
2
c2 n wy wx,y + 1
2
c2 wx wy,y - 1
2
c2 n wx wy,y == 0
1
2
c ux,y + 1
2
c n ux,y -
1

12
e vt,t + vx,x

2
- 1
2
n vx,x + c2 vy,y +
1
2
c wy wx,x - 1
2
c n wy wx,x + 1
2
c wx wx,y + 1
2
c n wx wx,y + c3 wy wy,y == 0
- F

12
+
1

12
e wx ut,t +
1

12
c e wy vt,t +
1

12
e wt,t - ux wx,x - c n vy wx,x - 1
2
wx
2 wx,x - 1
2
c2 n wy
2 wx,x -
c2 uy wx,y + c2 n uy wx,y - c vx wx,y + c n vx wx,y - c2 wx wy wx,y + c2 n wx wy wx,y - c2 n ux wy,y -
c3 vy wy,y - 1
2
c2 n wx
2 wy,y - 1
2
c4 wy
2 wy,y +
1

12
e wx,x,x,x + 1
6
c2 e wx,x,y,y +
1

12
c4 e wy,y,y,y == 0
We use the method of multiple scales  to directly attack EOM1 and BC1. To transform the time derivatives in EOM1 in terms
of the scales T0 and T1, we let
multiScales = 8Hdv : u ¨ v ¨ wL@x_, y_, tD -> dv@x, y, T0, T1D,
Derivative@m_, n_, o_D@u_D@x_, y_, tD -> dt@oD@D@u@x, y, T0, T1D, 8x, m<, 8y, n<DD<;
Then, we seek a second-order approximate solution in the form
solRule = 9Hdv : u ¨ vL -> IEvaluateASumAej+1 dvj@#1, #2, #3, #4D, 8j, 2<EE &M,
w -> IEvaluateASumAej wj@#1, #2, #3, #4D, 8j, 3<EE &M=
8dv : u¨ v ﬁHe2 dv1@#1, #2, #3, #4D + e3 dv2@#1, #2, #3, #4D &L,
w ﬁHe w1@#1, #2, #3, #4D + e2 w2@#1, #2, #3, #4D + e3 w3@#1, #2, #3, #4D &L<
where #1, #2, #3, and #4 stand for x, y, T0, and T1, respectively.
We introduce the detuning s1 to describe the nearness of the edge lengths a and b, consider the case of primary resonance,
and hence let
scaleRule2 = 9c -> 1 + e s1, F -> e3 F@x, yD Cos@W T0D=;
Substituting  multiScales, solRule, and  scaleRule2  into  EOM1 and  BC1, expanding  the  result  for small e, and discarding
terms of order higher than e3, we obtain
280
Chapter8.nb

eq83a =
HEOM1 . multiScales . solRule . scaleRule2  TrigToExp  ExpandAllL . en_;n>3 -> 0;
bc83a = BC1 . multiScales . solRule;
Equating coefficients of like powers of e in eq83a and bc83a yields
eqEps =
Thread@CoefficientList@Subtract  #, eD == 0D &  eq83a  Transpose  Rest  Rest;
bcEpsuv =
Thread@CoefficientList@Subtract  #, eD == 0D &  Select@bc83a, FreeQ@#, wD &D 
Transpose  Rest  Rest
88u1@0, y, T0, T1D == 0, u1@1, y, T0, T1D == 0, v1@x, 0, T0, T1D == 0, v1@x, 1, T0, T1D == 0<,
8u2@0, y, T0, T1D == 0, u2@1, y, T0, T1D == 0, v2@x, 0, T0, T1D == 0, v2@x, 1, T0, T1D == 0<<
bcEpsw = Thread@CoefficientList@Subtract  #, eD == 0D & 
Select@bc83a, ! FreeQ@#, wD &D  Transpose  Rest
99w1@0, y, T0, T1D == 0, w1
H2,0,0,0L@0, y, T0, T1D == 0,
w1@1, y, T0, T1D == 0, w1
H2,0,0,0L@1, y, T0, T1D == 0, w1@x, 0, T0, T1D == 0,
w1
H0,2,0,0L@x, 0, T0, T1D == 0, w1@x, 1, T0, T1D == 0, w1
H0,2,0,0L@x, 1, T0, T1D == 0=,
9w2@0, y, T0, T1D == 0, w2
H2,0,0,0L@0, y, T0, T1D == 0, w2@1, y, T0, T1D == 0,
w2
H2,0,0,0L@1, y, T0, T1D == 0, w2@x, 0, T0, T1D == 0, w2
H0,2,0,0L@x, 0, T0, T1D == 0,
w2@x, 1, T0, T1D == 0, w2
H0,2,0,0L@x, 1, T0, T1D == 0=,
9w3@0, y, T0, T1D == 0, w3
H2,0,0,0L@0, y, T0, T1D == 0, w3@1, y, T0, T1D == 0,
w3
H2,0,0,0L@1, y, T0, T1D == 0, w3@x, 0, T0, T1D == 0, w3
H0,2,0,0L@x, 0, T0, T1D == 0,
w3@x, 1, T0, T1D == 0, w3
H0,2,0,0L@x, 1, T0, T1D == 0==
Next, we introduce the display rule
displayRule1 = 9Derivative@a_, b_, c__DAw_i_E@x_, y_, T0, __D :>
SequenceFormAIfAarg1 = Times  MapIndexedAD#2@@1DD-1
#1
&, 8c<E; arg1 =!= 1, arg1, ""E,
Subscript@w, Sequence  Join@8i<, Table@x, 8a<D, Table@y, 8b<DDDE,
Derivative@a__D@Ai__D@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD
#1
&, 8a<E, AiE,
Derivative@a__D@A
i__D@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD
#1
&, 8a<E, A
iE,
w_i_@__, T0, __D -> wi, Ai__@__D -> Ai, A
i__@__D -> A
i=;
and write eqEps in a more concise way as
Chapter8.nb
281

HeqEpsm = 8eqEps@@1, 3DD, eqEps@@1, 81, 2<DD, eqEps@@2, 3DD<L . displayRule1
9 1

12
Hw1,x,x,x,xL + 1
6
Hw1,x,x,y,yL + 1

12
Hw1,y,y,y,yL +
1

12
HD0
2w1L == 0,
9u1,x,x + 1
2
Hu1,y,yL - 1
2
n Hu1,y,yL + 1
2
Hv1,x,yL + 1
2
n Hv1,x,yL + Hw1,xL Hw1,x,xL +
1
2
Hw1,yL Hw1,x,yL + 1
2
n Hw1,yL Hw1,x,yL + 1
2
Hw1,xL Hw1,y,yL - 1
2
n Hw1,xL Hw1,y,yL == 0,
1
2
Hu1,x,yL + 1
2
n Hu1,x,yL + 1
2
Hv1,x,xL - 1
2
n Hv1,x,xL + v1,y,y + 1
2
Hw1,yL Hw1,x,xL -
1
2
n Hw1,yL Hw1,x,xL + 1
2
Hw1,xL Hw1,x,yL + 1
2
n Hw1,xL Hw1,x,yL + Hw1,yL Hw1,y,yL == 0=,
- 1

24
E-I T0 W F@x, yD - 1

24
EI T0 W F@x, yD - Hu1,xL Hw1,x,xL - n Hv1,yL Hw1,x,xL - 1
2
Hw1,xL2 Hw1,x,xL -
1
2
n Hw1,yL2 Hw1,x,xL - Hu1,yL Hw1,x,yL + n Hu1,yL Hw1,x,yL - Hv1,xL Hw1,x,yL + n Hv1,xL Hw1,x,yL -
Hw1,xL Hw1,yL Hw1,x,yL + n Hw1,xL Hw1,yL Hw1,x,yL - n Hu1,xL Hw1,y,yL - Hv1,yL Hw1,y,yL -
1
2
n Hw1,xL2 Hw1,y,yL - 1
2
Hw1,yL2 Hw1,y,yL +
1

12
Hw2,x,x,x,xL + 1
6
Hw2,x,x,y,yL +
1

12
Hw2,y,y,y,yL +
1

12
HD0
2w2L + 1
6
HD0 D1w1L + 1
3
Hw1,x,x,y,yL s1 + 1
3
Hw1,y,y,y,yL s1 == 0=
 8.3.1 First-Order Solution
Linear vibrations are governed by eqEpsm[[1]] and bcEpsw[[1]]; that is,
Horder1Eq = eqEpsm@@1DDL . displayRule1
1

12
Hw1,x,x,x,xL + 1
6
Hw1,x,x,y,yL + 1

12
Hw1,y,y,y,yL +
1

12
HD0
2w1L == 0
order1BC = bcEpsw@@1DD
9w1@0, y, T0, T1D == 0, w1
H2,0,0,0L@0, y, T0, T1D == 0,
w1@1, y, T0, T1D == 0, w1
H2,0,0,0L@1, y, T0, T1D == 0, w1@x, 0, T0, T1D == 0,
w1
H0,2,0,0L@x, 0, T0, T1D == 0, w1@x, 1, T0, T1D == 0, w1
H0,2,0,0L@x, 1, T0, T1D == 0=
It follows from order1Eq and order1BC that the linear modeshapes and associated frequencies are given by
modeshapes = 8fm_,n_ :> HSin@m p #1D Sin@n p #2D &L<;
frequencies = 9wm_,n_ :> Im2 + n2M p2=;
To investigate the case of one-to-one internal resonance between the mnth and nmth modes (m „ n), we let
w1sol = 9w1 -> FunctionA8x, y, T0, T1<, A1@T1D EI wm,n T0 fm,n@x, yD +
A
1@T1D E-I wm,n T0 fm,n@x, yD + A2@T1D EI wm,n T0 fn,m@x, yD + A
2@T1D E-Iwm,n T0 fn,m@x, yDE=;
282
Chapter8.nb

 8.3.2 Second-Order Solution
Substituting the w1sol into eqEpsm[[2]], we obtain
order2Equ = HeqEpsm@@2, 1, 1DD . w1 -> H0 &LL ==
HHeqEpsm@@2, 1, 1DD . w1 -> H0 &LL - eqEpsm@@2, 1, 1DD . w1sol . modeshapes 
TrigReduce  ExpandL;  Timing
84.39 Second, Null<
order2Eqv = HeqEpsm@@2, 2, 1DD . w1 -> H0 &LL ==
HHeqEpsm@@2, 2, 1DD . w1 -> H0 &LL - eqEpsm@@2, 2, 1DD . w1sol . modeshapes 
TrigReduce  ExpandL;  Timing
84.28 Second, Null<
The associated boundary conditions are
order2BC = bcEpsuv@@1DD
8u1@0, y, T0, T1D == 0, u1@1, y, T0, T1D == 0, v1@x, 0, T0, T1D == 0, v1@x, 1, T0, T1D == 0<
To obtain  particular solutions  for u1  and v1, we  use the  method of undetermined  coefficients. To accomplish  this, we first
look for all possible terms that appear on the right-hand sides of order2Equ and order2Eqv as follows:
possibleTerms1 =
CasesA8order2Equ@@2DD, order2Eqv@@2DD<, _ Sin@a_D Eb_ :> Sin@aD Eb, ¥E  Union;
possibleTerms2 = possibleTerms1 . Exp@_D -> 1  Union;
Chapter8.nb
283

possibleTerms = Join@possibleTerms1, possibleTerms2D
8E-2 I T0 wm,n Sin@2 m p xD, E2 I T0 wm,n Sin@2 m p xD, E-2 I T0 wm,n Sin@2 n p xD, E2 I T0 wm,n Sin@2 n p xD,
E-2 I T0 wm,n Sin@2 m p yD, E2 I T0 wm,n Sin@2 m p yD, E-2 I T0 wm,n Sin@2 n p yD, E2 I T0 wm,n Sin@2 n p yD,
E-2 I T0 wm,n Sin@2 n p x - 2 m p yD, E2 I T0 wm,n Sin@2 n p x - 2 m p yD, E-2I T0 wm,n Sin@2 n p x + 2 m p yD,
E2 I T0 wm,n Sin@2 n p x + 2 m p yD, E-2 I T0 wm,n Sin@2 m p x - 2 n p yD, E2 IT0 wm,n Sin@2 m p x - 2 n p yD,
E-2 I T0 wm,n Sin@m p x - n p x - m p y - n p yD, E2 I T0 wm,n Sin@m p x - n p x - m p y - n p yD,
E-2 I T0 wm,n Sin@m p x + n p x - m p y - n p yD, E2 I T0 wm,n Sin@m p x + n p x - m p y - n p yD,
E-2 I T0 wm,n Sin@m p x - n p x + m p y - n p yD, E2 I T0 wm,n Sin@m p x - n p x + m p y - n p yD,
E-2 I T0 wm,n Sin@m p x + n p x + m p y - n p yD, E2 I T0 wm,n Sin@m p x + n p x + m p y - n p yD,
E-2 I T0 wm,n Sin@m p x - n p x - m p y + n p yD, E2 I T0 wm,n Sin@m p x - n p x - m p y + n p yD,
E-2 I T0 wm,n Sin@m p x + n p x - m p y + n p yD, E2 I T0 wm,n Sin@m p x + n p x - m p y + n p yD,
E-2 I T0 wm,n Sin@m p x - n p x + m p y + n p yD, E2 I T0 wm,n Sin@m p x - n p x + m p y + n p yD,
E-2 I T0 wm,n Sin@m p x + n p x + m p y + n p yD, E2 I T0 wm,n Sin@m p x + n p x + m p y + n p yD,
E-2 I T0 wm,n Sin@2 m p x + 2 n p yD, E2 I T0 wm,n Sin@2 m p x + 2 n p yD, Sin@2 m p xD, Sin@2 n p xD,
Sin@2 m p yD, Sin@2 n p yD, Sin@2 n p x - 2 m p yD, Sin@2 n p x + 2 m p yD, Sin@2 m p x - 2 n p yD,
Sin@m p x - n p x - m p y - n p yD, Sin@m p x + n p x - m p y - n p yD, Sin@m p x - n p x + m p y - n p yD,
Sin@m p x + n p x + m p y - n p yD, Sin@m p x - n p x - m p y + n p yD, Sin@m p x + n p x - m p y + n p yD,
Sin@m p x - n p x + m p y + n p yD, Sin@m p x + n p x + m p y + n p yD, Sin@2 m p x + 2 n p yD<
which satisfy order2BC. We then define the following symbol lists to represent the undetermined coefficients.
usymbolList = Table@ci, 8i, Length@possibleTermsD<D
8c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16,
c17, c18, c19, c20, c21, c22, c23, c24, c25, c26, c27, c28, c29, c30, c31, c32,
c33, c34, c35, c36, c37, c38, c39, c40, c41, c42, c43, c44, c45, c46, c47, c48<
vsymbolList = usymbolList . c -> d
8d1, d2, d3, d4, d5, d6, d7, d8, d9, d10, d11, d12, d13, d14, d15, d16,
d17, d18, d19, d20, d21, d22, d23, d24, d25, d26, d27, d28, d29, d30, d31, d32,
d33, d34, d35, d36, d37, d38, d39, d40, d41, d42, d43, d44, d45, d46, d47, d48<
Then, we express the solution as
u1sol = u1 -> Function@8x, y, T0, T1<, usymbolList.possibleTerms  EvaluateD;
v1sol = v1 -> Function@8x, y, T0, T1<, vsymbolList.possibleTerms  EvaluateD;
Substituting  u1sol and  v1sol into  order2Equ and  order2Eqv, collecting  coefficients  of possibleTerms, and solving  for the
usymbolList and vsymbolList, we obtain
algEq1 = Coefficient@Subtract  order2Equ . u1sol . v1sol, possibleTermsD == 0 .
Exp@_ T0D -> 0  Thread;  Timing
867.45 Second, Null<
284
Chapter8.nb

algEq2 = Coefficient@Subtract  order2Eqv . u1sol . v1sol, possibleTermsD == 0 .
Exp@_ T0D -> 0  Thread;  Timing
865.91 Second, Null<
symbolRule1 = Solve@Join@algEq1, algEq2D, Join@usymbolList, vsymbolListDD@@1DD  Simplify
:c1 ﬁ- p Hm2 - n2 nL A
1@T1D
2


16 m
, c2 ﬁ- p Hm2 - n2 nL A1@T1D2


16 m
, c3 ﬁ- p Hn2 - m2 nL A
2@T1D
2


16 n
,
c4 ﬁ- p Hn2 - m2 nL A2@T1D2


16 n
, c33 ﬁ- p Hm2 - n2 nL A1@T1D A
1@T1D


8 m
, c34 ﬁ- p Hn2 - m2 nL A2@T1D A
2@T1D


8 n
,
d5 ﬁ- p Hm2 - n2 nL A
2@T1D2


16 m
, d6 ﬁ- p Hm2 - n2 nL A2@T1D2


16 m
, d7 ﬁ- p Hn2 - m2 nL A
1@T1D2


16 n
,
d8 ﬁ- p Hn2 - m2 nL A1@T1D2


16 n
, d35 ﬁ- p Hm2 - n2 nL A2@T1D A
2@T1D


8 m
, d36 ﬁ- p Hn2 - m2 nL A1@T1D A
1@T1D


8 n
,
c5 ﬁ0, c6 ﬁ0, c7 ﬁ0, c8 ﬁ0, c35 ﬁ0, c36 ﬁ0, d1 ﬁ0, d2 ﬁ0, d3 ﬁ0, d4 ﬁ0,
d33 ﬁ0, d34 ﬁ0, c9 ﬁ
1

32
n p A
2@T1D
2, c10 ﬁ
1

32
n p A2@T1D2, c11 ﬁ
1

32
n p A
2@T1D
2,
c12 ﬁ
1

32
n p A2@T1D2, c13 ﬁ
1

32
m p A
1@T1D
2, c14 ﬁ
1

32
m p A1@T1D2, c31 ﬁ
1

32
m p A
1@T1D
2,
c32 ﬁ
1

32
m p A1@T1D2, c37 ﬁ
1

16
n p A2@T1D A
2@T1D, c38 ﬁ
1

16
n p A2@T1D A
2@T1D,
c39 ﬁ
1

16
m p A1@T1D A
1@T1D, c48 ﬁ
1

16
m p A1@T1D A
1@T1D, d9 ﬁ- 1

32
m p A
2@T1D
2,
d10 ﬁ- 1

32
m p A2@T1D2, d11 ﬁ
1

32
m p A
2@T1D
2, d12 ﬁ
1

32
m p A2@T1D2, d13 ﬁ- 1

32
n p A
1@T1D
2,
d14 ﬁ- 1

32
n p A1@T1D2, d31 ﬁ
1

32
n p A
1@T1D
2, d32 ﬁ
1

32
n p A1@T1D2, d37 ﬁ- 1

16
m p A2@T1D A
2@T1D,
d38 ﬁ
1

16
m p A2@T1D A
2@T1D, d39 ﬁ- 1

16
n p A1@T1D A
1@T1D, d48 ﬁ
1

16
n p A1@T1D A
1@T1D,
c15 ﬁ
1

32
Hm - nL p H-1 + nL A
1@T1D A
2@T1D, c16 ﬁ
1

32
Hm - nL p H-1 + nL A1@T1D A2@T1D,
c21 ﬁ
1

32
Hm + nL p H-1 + nL A
1@T1D A
2@T1D, c22 ﬁ
1

32
Hm + nL p H-1 + nL A1@T1D A2@T1D,
c25 ﬁ
1

32
Hm + nL p H-1 + nL A
1@T1D A
2@T1D, c26 ﬁ
1

32
Hm + nL p H-1 + nL A1@T1D A2@T1D,
c27 ﬁ
1

32
Hm - nL p H-1 + nL A
1@T1D A
2@T1D, c28 ﬁ
1

32
Hm - nL p H-1 + nL A1@T1D A2@T1D,
c40 ﬁ
1

32
Hm - nL p H-1 + nL HA2@T1D A
1@T1D + A1@T1D A
2@T1DL,
c43 ﬁ
1

32
Hm + nL p H-1 + nL HA2@T1D A
1@T1D + A1@T1D A
2@T1DL,
c45 ﬁ
1

32
Hm + nL p H-1 + nL HA2@T1D A
1@T1D + A1@T1D A
2@T1DL,
c46 ﬁ
1

32
Hm - nL p H-1 + nL HA2@T1D A
1@T1D + A1@T1D A
2@T1DL,
d15 ﬁ- 1

32
Hm + nL p H-1 + nL A
1@T1D A
2@T1D, d16 ﬁ- 1

32
Hm + nL p H-1 + nL A1@T1D A2@T1D,
Chapter8.nb
285

d21 ﬁ
1

32
Hm - nL p H-1 + nL A
1@T1D A
2@T1D, d22 ﬁ
1

32
Hm - nL p H-1 + nL A1@T1D A2@T1D,
d25 ﬁ- 1

32
Hm - nL p H-1 + nL A
1@T1D A
2@T1D, d26 ﬁ- 1

32
Hm - nL p H-1 + nL A1@T1D A2@T1D,
d27 ﬁ
1

32
Hm + nL p H-1 + nL A
1@T1D A
2@T1D, d28 ﬁ
1

32
Hm + nL p H-1 + nL A1@T1D A2@T1D,
d40 ﬁ- 1

32
Hm + nL p H-1 + nL HA2@T1D A
1@T1D + A1@T1D A
2@T1DL,
d43 ﬁ
1

32
Hm - nL p H-1 + nL HA2@T1D A
1@T1D + A1@T1D A
2@T1DL,
d45 ﬁ- 1

32
Hm - nL p H-1 + nL HA2@T1D A
1@T1D + A1@T1D A
2@T1DL,
d46 ﬁ
1

32
Hm + nL p H-1 + nL HA2@T1D A
1@T1D + A1@T1D A
2@T1DL,
c17 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL - 2 m n H1 + nLL A
1@T1D A
2@T1D




32 Hm + nL
,
c18 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL - 2 m n H1 + nLL A1@T1D A2@T1D




32 Hm + nL
,
c19 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL + 2 m n H1 + nLL A
1@T1D A
2@T1D




32 Hm - nL
,
c20 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL + 2 m n H1 + nLL A1@T1D A2@T1D




32 Hm - nL
,
c23 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL + 2 m n H1 + nLL A
1@T1D A
2@T1D




32 Hm - nL
,
c24 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL + 2 m n H1 + nLL A1@T1D A2@T1D




32 Hm - nL
,
c29 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL - 2 m n H1 + nLL A
1@T1D A
2@T1D




32 Hm + nL
,
c30 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL - 2 m n H1 + nLL A1@T1D A2@T1D




32 Hm + nL
,
c41 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL - 2 m n H1 + nLL HA2@T1D A
1@T1D + A1@T1D A
2@T1DL






32 Hm + nL
,
c42 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL + 2 m n H1 + nLL HA2@T1D A
1@T1D + A1@T1D A
2@T1DL






32 Hm - nL
,
c44 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL + 2 m n H1 + nLL HA2@T1D A
1@T1D + A1@T1D A
2@T1DL






32 Hm - nL
,
c47 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL - 2 m n H1 + nLL HA2@T1D A
1@T1D + A1@T1D A
2@T1DL






32 Hm + nL
,
d17 ﬁp Hm2 H-1 + nL + n2 H-1 + nL - 2 m n H1 + nLL A
1@T1D A
2@T1D




32 Hm + nL
,
d18 ﬁp Hm2 H-1 + nL + n2 H-1 + nL - 2 m n H1 + nLL A1@T1D A2@T1D




32 Hm + nL
,
d19 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL + 2 m n H1 + nLL A
1@T1D A
2@T1D




32 Hm - nL
,
286
Chapter8.nb

d20 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL + 2 m n H1 + nLL A1@T1D A2@T1D




32 Hm - nL
,
d23 ﬁp Hm2 H-1 + nL + n2 H-1 + nL + 2 m n H1 + nLL A
1@T1D A
2@T1D




32 Hm - nL
,
d24 ﬁp Hm2 H-1 + nL + n2 H-1 + nL + 2 m n H1 + nLL A1@T1D A2@T1D




32 Hm - nL
,
d29 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL - 2 m n H1 + nLL A
1@T1D A
2@T1D




32 Hm + nL
,
d30 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL - 2 m n H1 + nLL A1@T1D A2@T1D




32 Hm + nL
,
d41 ﬁp Hm2 H-1 + nL + n2 H-1 + nL - 2 m n H1 + nLL HA2@T1D A
1@T1D + A1@T1D A
2@T1DL






32 Hm + nL
,
d42 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL + 2 m n H1 + nLL HA2@T1D A
1@T1D + A1@T1D A
2@T1DL






32 Hm - nL
,
d44 ﬁp Hm2 H-1 + nL + n2 H-1 + nL + 2 m n H1 + nLL HA2@T1D A
1@T1D + A1@T1D A
2@T1DL






32 Hm - nL
,
d47 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL - 2 m n H1 + nLL HA2@T1D A
1@T1D + A1@T1D A
2@T1DL






32 Hm + nL
>
 8.3.3 Solvability Conditions
Substituting the w1sol, u1sol, and v1sol into eqEpsm[[3]], we obtain
order3Eq = Horder1Eq@@1DD . w1 -> w2L ==
HHorder1Eq@@1DD . w1 -> w2L - eqEpsm@@3, 1DD . w1sol . u1sol . v1sol . modeshapes 
ExpandL;  Timing
84.18 Second, Null<
The associated boundary conditions are
order3BC = bcEpsw@@2DD
9w2@0, y, T0, T1D == 0, w2
H2,0,0,0L@0, y, T0, T1D == 0,
w2@1, y, T0, T1D == 0, w2
H2,0,0,0L@1, y, T0, T1D == 0, w2@x, 0, T0, T1D == 0,
w2
H0,2,0,0L@x, 0, T0, T1D == 0, w2@x, 1, T0, T1D == 0, w2
H0,2,0,0L@x, 1, T0, T1D == 0=
To describe the nearness of the primary resonance, we introduce the detuning parameter s2 defined by
ResonanceCond = 8W -> wm,n + e s2<;
Because the homogeneous parts of order3Eq and order3BC have a nontrivial solution, the corresponding nonhomogeneous
problem has  a  solution  only  if  solvability  conditions  are  satisfied.  These conditions  demand  that  the  right-hand  side  of
order3Eq be orthogonal to every solution of the adjoint homogeneous problem. In this case, the problem is self-adjoint.
Chapter8.nb
287

To  determine  the  solvability  conditions,  we  collect  the  terms  that  may  lead  to  secular terms,  the  terms  proportional  to
EI wm,n T0. To this end, we use the rule
expRule = Exp@a_D :> Exp@Expand@a . ResonanceCondD . e T0 -> T1D;
and obtain
ST = CoefficientAorder3Eq@@2DD . expRule, EI wm,n T0E  TrigReduce;  Timing
8132.53 Second, Null<
Among all the spatial-dependent non-forcing terms in ST, only the following terms are not orthogonal to the modeshapes:
terms1 = Cases@ST, Cos@m p x + a_. n p y ; Abs@aD == 1D, ¥D  Union
8Cos@m p x - n p yD, Cos@m p x + n p yD<
terms2 = Cases@ST, Cos@n p x + a_. m p y ; Abs@aD == 1D, ¥D  Union
8Cos@n p x - m p yD, Cos@n p x + m p yD<
The coefficients of these terms in ST are
terms1Coef = Coefficient@ST, terms1D;
terms2Coef = Coefficient@ST, terms2D;
The projection of terms1 onto Sin@mp xDSin@n p yD can be obtained as
trigRule = 8Cos@2 _. pD -> 1, Sin@_. pD -> 0<;
proj1Coef = à
0
1
à
0
1
Sin@m p xD Sin@n p yD # â x â y &  terms1 . trigRule
9 1
4
, - 1
4
=
and the projection of terms2 onto Sin@n p xDSin@mp yD can be obtained as
proj2Coef = à
0
1
à
0
1
Sin@n p xD Sin@m p yD # â x â y &  terms2 . trigRule
9 1
4
, - 1
4
=
The forcing term in ST is
f0 = ST . Cos@_D -> 0
1

24
EI T1 s2 F@x, yD
Then, the solvability conditions demand that ST be orthogonal to every linear eigenfunction, modeshapes; that is,
288
Chapter8.nb

intRule3 = 8int@a_ fun_, a1_, b1_D :> a int@fun, a1, b1D ; FreeQ@a, First@a1D ¨ First@b1DD<;
SCond1 =
Expand@24 Hint@Sin@m p xD Sin@n p yD f0, 8x, 0, 1<, 8y, 0, 1<D + proj1Coef.terms1Coef .
symbolRule1 . intRule3 . int -> IntegrateLD == 0;
SCond2 =
Expand@24 Hint@Sin@n p xD Sin@m p yD f0, 8x, 0, 1<, 8y, 0, 1<D + proj2Coef.terms2Coef .
symbolRule1 . intRule3 . int -> IntegrateLD == 0;
To express these solvability conditions in a more readable form, we define
basicTerms = 9A1@T1D EI wm,n T0, A
1@T1D E-I wm,n T0, A2@T1D EI wm,n T0, A
2@T1D E-I wm,n T0=;
cubicTerms =
IE-I wm,n T0 Nest@Outer@Times, basicTerms, #D &, basicTerms, 2D  FlattenM . Exp@_ T0D -> 0 
Union  Rest
8A1@T1D2 A
1@T1D, A1@T1D A2@T1D A
1@T1D, A2@T1D2 A
1@T1D,
A1@T1D2 A
2@T1D, A1@T1D A2@T1D A
2@T1D, A2@T1D2 A
2@T1D<
Then, we collect the coefficients of cubicTerms from SCond1 and SCond2 and obtain
coef1 = Coefficient@SCond1@@1DD, cubicTermsD  Simplify
9 9
8
p4 H-4 m2 n2 n + m4 H-3 + n2L + n4 H-3 + n2LL, 0,
3
8
p4 H4 m2 n2 H-2 + n2L + m4 H-1 - 2 n + n2L + n4 H-1 - 2 n + n2LL, 0,
3
4
p4 H4 m2 n2 H-2 + n2L + m4 H-1 - 2 n + n2L + n4 H-1 - 2 n + n2LL, 0=
coef2 = Coefficient@SCond2@@1DD, cubicTermsD  Simplify
90, 3
4
p4 H4 m2 n2 H-2 + n2L + m4 H-1 - 2 n + n2L + n4 H-1 - 2 n + n2LL,
0, 3
8
p4 H4 m2 n2 H-2 + n2L + m4 H-1 - 2 n + n2L + n4 H-1 - 2 n + n2LL,
0, 9
8
p4 H-4 m2 n2 n + m4 H-3 + n2L + n4 H-3 + n2LL=
Hence, SCond1 and SCond2 can be rewritten and combined as
Chapter8.nb
289

SCond = 8Collect@SCond1@@1DD . Thread@cubicTerms -> 0D, s1 A1@T1DD + coef1.cubicTerms == 0,
Collect@SCond2@@1DD . Thread@cubicTerms -> 0D, s1 A2@T1DD + coef2.cubicTerms == 0<;
SCond . displayRule1
:EI T1 s2 à
0
1
à
0
1
F@x, yD Sin@m p xD Sin@n p yD â y â x +
H-2 m2 n2 p4 - 2 n4 p4L A1 s1 + 9
8
p4 H-4 m2 n2 n + m4 H-3 + n2L + n4 H-3 + n2LL A1
2 A
1 +
3
8
p4 H4 m2 n2 H-2 + n2L + m4 H-1 - 2 n + n2L + n4 H-1 - 2 n + n2LL A2
2 A
1 +
3
4
p4 H4 m2 n2 H-2 + n2L + m4 H-1 - 2 n + n2L + n4 H-1 - 2 n + n2LL A1 A2 A
2 - I HD1A1L wm,n == 0,
EI T1 s2 à
0
1
à
0
1
F@x, yD Sin@n p xD Sin@m p yD â y â x + H-2 m4 p4 - 2 m2 n2 p4L A2 s1 +
3
4
p4 H4 m2 n2 H-2 + n2L + m4 H-1 - 2 n + n2L + n4 H-1 - 2 n + n2LL A1 A2 A
1 +
3
8
p4 H4 m2 n2 H-2 + n2L + m4 H-1 - 2 n + n2L + n4 H-1 - 2 n + n2LL A1
2 A
2 +
9
8
p4 H-4 m2 n2 n + m4 H-3 + n2L + n4 H-3 + n2LL A2
2 A
2 - I HD1A2L wm,n == 0>
 8.3.4 Mixed Approach
Alternatively, we can  use a  mixed approach, a  combination of discretization  and direct  approaches, to  attack the problem,
EOM1 and BC1. We first define
scaleRule3 = 9Hdv : u ¨ vL -> Ie2 dv@#1, #2, #3D &M, w -> He w@#1, #2, #3D &L=;
Substituting scaleRule2 and  scaleRule3  into EOM1, expanding  the result  for small e, and  discarding terms  of order higher
than e3, we obtain
eq83b = HEOM1 . scaleRule2 . scaleRule3  TrigToExp  ExpandAllL . en_;n>3 -> 0;
To write eq83b in a more concise way, we introduce the dispaly rule
display2@expr_D := expr . 8Derivative@a_, b_, c_D@w_D@x, y, tD :>
Subscript@w, Sequence  Join@Table@x, 8a<D, Table@y, 8b<D, Table@t, 8c<DDD<
Hence,
IuEOM = CoefficientAeq83b@@1, 1DD, e2E == 0M  display2
ux,x +
uy,y

2
- 1
2
n uy,y +
vx,y

2
+ 1
2
n vx,y + wx wx,x + 1
2
wy wx,y + 1
2
n wy wx,y + 1
2
wx wy,y - 1
2
n wx wy,y == 0
IvEOM = CoefficientAeq83b@@2, 1DD, e2E == 0M  display2
ux,y

2
+ 1
2
n ux,y + vx,x

2
- 1
2
n vx,x + vy,y + 1
2
wy wx,x - 1
2
n wy wx,x + 1
2
wx wx,y + 1
2
n wx wx,y + wy wy,y == 0
290
Chapter8.nb

IwEOM = eq83b@@3DD  ThreadAe-2 #, EqualE &  ExpandAllM  display2
- 1

24
E-I T0 W e F@x, yD - 1

24
EI T0 W e F@x, yD + wt,t

12
- e ux wx,x -
e n vy wx,x - 1
2
e wx
2 wx,x - 1
2
e n wy
2 wx,x - e uy wx,y + e n uy wx,y - e vx wx,y + e n vx wx,y -
e wx wy wx,y + e n wx wy wx,y - e n ux wy,y - e vy wy,y - 1
2
e n wx
2 wy,y - 1
2
e wy
2 wy,y +
1

12
wx,x,x,x + 1
6
wx,x,y,y + 1
3
e s1 wx,x,y,y +
1

12
wy,y,y,y + 1
3
e s1 wy,y,y,y == 0
Linear vibrations are governed by wEOM with e = 0; that is,
Horder1Eqw = wEOM . e -> 0L  display2
wt,t

12
+ 1

12
wx,x,x,x + 1
6
wx,x,y,y +
1

12
wy,y,y,y == 0
subject  to the  boundary  conditions BC1. It  follows  from order1Eqw and  BC1  that  the  linear modeshapes  and  associated
frequencies are given by
fm,n@x, yD . modeshapes
Sin@m p xD Sin@n p yD
wm,n . frequencies
Hm2 +n2L p2
To investigate the case of one-to-one internal resonance between the mnth and nmth modes (m „ n), we let
w1sol = 8w -> Function@8x, y, t<, h@tD Sin@m p xD Sin@n p yD + z@tD Sin@n p xD Sin@m p yDD<;
Substituting the w1sol into uEOM and vEOM, we obtain
order2Equ =
HuEOM@@1DD . w -> H0 &LL == HHuEOM@@1DD . w -> H0 &LL - uEOM@@1DD . w1sol  TrigReduceL;
order2Equ  display2
ux,x +
uy,y

2
- 1
2
n uy,y +
vx,y

2
+ 1
2
n vx,y ==
1

16
H4 n3 p3 Sin@2 n p xD z@tD2 - 4 m2 n p3 n Sin@2 n p xD z@tD2 -
2 m2 n p3 Sin@2 n p x - 2 m p yD z@tD2 - 2 n3 p3 Sin@2 n p x - 2 m p yD z@tD2 -
2 m2 n p3 Sin@2 n p x + 2 m p yD z@tD2 - 2 n3 p3 Sin@2 n p x + 2 m p yD z@tD2 +
m3 p3 Sin@m p x - n p x - m p y - n p yD z@tD h@tD - m2 n p3 Sin@m p x - n p x - m p y - n p yD z@tD h@tD +
m n2 p3 Sin@m p x - n p x - m p y - n p yD z@tD h@tD - n3 p3 Sin@m p x - n p x - m p y - n p yD z@tD h@tD -
m3 p3 n Sin@m p x - n p x - m p y - n p yD z@tD h@tD + m2 n p3 n Sin@m p x - n p x - m p y - n p yD
z@tD h@tD - m n2 p3 n Sin@m p x - n p x - m p y - n p yD z@tD h@tD +
n3 p3 n Sin@m p x - n p x - m p y - n p yD z@tD h@tD - m3 p3 Sin@m p x + n p x - m p y - n p yD z@tD h@tD -
3 m2 n p3 Sin@m p x + n p x - m p y - n p yD z@tD h@tD -
Chapter8.nb
291

3 m n2 p3 Sin@m p x + n p x - m p y - n p yD z@tD h@tD -
n3 p3 Sin@m p x + n p x - m p y - n p yD z@tD h@tD + m3 p3 n Sin@m p x + n p x - m p y - n p yD z@tD h@tD -
m2 n p3 n Sin@m p x + n p x - m p y - n p yD z@tD h@tD -
m n2 p3 n Sin@m p x + n p x - m p y - n p yD z@tD h@tD +
n3 p3 n Sin@m p x + n p x - m p y - n p yD z@tD h@tD - m3 p3 Sin@m p x - n p x + m p y - n p yD z@tD h@tD +
3 m2 n p3 Sin@m p x - n p x + m p y - n p yD z@tD h@tD -
3 m n2 p3 Sin@m p x - n p x + m p y - n p yD z@tD h@tD +
n3 p3 Sin@m p x - n p x + m p y - n p yD z@tD h@tD + m3 p3 n Sin@m p x - n p x + m p y - n p yD z@tD h@tD +
m2 n p3 n Sin@m p x - n p x + m p y - n p yD z@tD h@tD - m n2 p3 n Sin@m p x - n p x + m p y - n p yD
z@tD h@tD - n3 p3 n Sin@m p x - n p x + m p y - n p yD z@tD h@tD +
m3 p3 Sin@m p x + n p x + m p y - n p yD z@tD h@tD + m2 n p3 Sin@m p x + n p x + m p y - n p yD z@tD h@tD +
m n2 p3 Sin@m p x + n p x + m p y - n p yD z@tD h@tD + n3 p3 Sin@m p x + n p x + m p y - n p yD z@tD h@tD -
m3 p3 n Sin@m p x + n p x + m p y - n p yD z@tD h@tD - m2 n p3 n Sin@m p x + n p x + m p y - n p yD
z@tD h@tD - m n2 p3 n Sin@m p x + n p x + m p y - n p yD z@tD h@tD -
n3 p3 n Sin@m p x + n p x + m p y - n p yD z@tD h@tD - m3 p3 Sin@m p x - n p x - m p y + n p yD z@tD h@tD +
3 m2 n p3 Sin@m p x - n p x - m p y + n p yD z@tD h@tD -
3 m n2 p3 Sin@m p x - n p x - m p y + n p yD z@tD h@tD +
n3 p3 Sin@m p x - n p x - m p y + n p yD z@tD h@tD + m3 p3 n Sin@m p x - n p x - m p y + n p yD z@tD h@tD +
m2 n p3 n Sin@m p x - n p x - m p y + n p yD z@tD h@tD -
m n2 p3 n Sin@m p x - n p x - m p y + n p yD z@tD h@tD -
n3 p3 n Sin@m p x - n p x - m p y + n p yD z@tD h@tD + m3 p3 Sin@m p x + n p x - m p y + n p yD z@tD h@tD +
m2 n p3 Sin@m p x + n p x - m p y + n p yD z@tD h@tD +
m n2 p3 Sin@m p x + n p x - m p y + n p yD z@tD h@tD + n3 p3 Sin@m p x + n p x - m p y + n p yD z@tD h@tD -
m3 p3 n Sin@m p x + n p x - m p y + n p yD z@tD h@tD - m2 n p3 n Sin@m p x + n p x - m p y + n p yD
z@tD h@tD - m n2 p3 n Sin@m p x + n p x - m p y + n p yD z@tD h@tD -
n3 p3 n Sin@m p x + n p x - m p y + n p yD z@tD h@tD + m3 p3 Sin@m p x - n p x + m p y + n p yD z@tD h@tD -
m2 n p3 Sin@m p x - n p x + m p y + n p yD z@tD h@tD +
m n2 p3 Sin@m p x - n p x + m p y + n p yD z@tD h@tD - n3 p3 Sin@m p x - n p x + m p y + n p yD z@tD h@tD -
m3 p3 n Sin@m p x - n p x + m p y + n p yD z@tD h@tD + m2 n p3 n Sin@m p x - n p x + m p y + n p yD
z@tD h@tD - m n2 p3 n Sin@m p x - n p x + m p y + n p yD z@tD h@tD +
n3 p3 n Sin@m p x - n p x + m p y + n p yD z@tD h@tD - m3 p3 Sin@m p x + n p x + m p y + n p yD z@tD h@tD -
3 m2 n p3 Sin@m p x + n p x + m p y + n p yD z@tD h@tD -
3 m n2 p3 Sin@m p x + n p x + m p y + n p yD z@tD h@tD -
n3 p3 Sin@m p x + n p x + m p y + n p yD z@tD h@tD + m3 p3 n Sin@m p x + n p x + m p y + n p yD z@tD h@tD -
m2 n p3 n Sin@m p x + n p x + m p y + n p yD z@tD h@tD -
m n2 p3 n Sin@m p x + n p x + m p y + n p yD z@tD h@tD + n3 p3 n Sin@m p x + n p x + m p y + n p yD
z@tD h@tD + 4 m3 p3 Sin@2 m p xD h@tD2 - 4 m n2 p3 n Sin@2 m p xD h@tD2 -
2 m3 p3 Sin@2 m p x - 2 n p yD h@tD2 - 2 m n2 p3 Sin@2 m p x - 2 n p yD h@tD2 -
2 m3 p3 Sin@2 m p x + 2 n p yD h@tD2 - 2 m n2 p3 Sin@2 m p x + 2 n p yD h@tD2L
order2Eqv =
HvEOM@@1DD . w -> H0 &LL == HHvEOM@@1DD . w -> H0 &LL - vEOM@@1DD . w1sol  TrigReduceL;
order2Eqv  display2
292
Chapter8.nb

ux,y

2
+ 1
2
n ux,y + vx,x

2
- 1
2
n vx,x + vy,y ==
1

16
H4 m3 p3 Sin@2 m p yD z@tD2 - 4 m n2 p3 n Sin@2 m p yD z@tD2 +
2 m3 p3 Sin@2 n p x - 2 m p yD z@tD2 + 2 m n2 p3 Sin@2 n p x - 2 m p yD z@tD2 -
2 m3 p3 Sin@2 n p x + 2 m p yD z@tD2 - 2 m n2 p3 Sin@2 n p x + 2 m p yD z@tD2 -
m3 p3 Sin@m p x - n p x - m p y - n p yD z@tD h@tD - m2 n p3 Sin@m p x - n p x - m p y - n p yD z@tD h@tD -
m n2 p3 Sin@m p x - n p x - m p y - n p yD z@tD h@tD - n3 p3 Sin@m p x - n p x - m p y - n p yD z@tD h@tD +
m3 p3 n Sin@m p x - n p x - m p y - n p yD z@tD h@tD + m2 n p3 n Sin@m p x - n p x - m p y - n p yD
z@tD h@tD + m n2 p3 n Sin@m p x - n p x - m p y - n p yD z@tD h@tD +
n3 p3 n Sin@m p x - n p x - m p y - n p yD z@tD h@tD + m3 p3 Sin@m p x + n p x - m p y - n p yD z@tD h@tD +
3 m2 n p3 Sin@m p x + n p x - m p y - n p yD z@tD h@tD +
3 m n2 p3 Sin@m p x + n p x - m p y - n p yD z@tD h@tD +
n3 p3 Sin@m p x + n p x - m p y - n p yD z@tD h@tD - m3 p3 n Sin@m p x + n p x - m p y - n p yD z@tD h@tD +
m2 n p3 n Sin@m p x + n p x - m p y - n p yD z@tD h@tD +
m n2 p3 n Sin@m p x + n p x - m p y - n p yD z@tD h@tD -
n3 p3 n Sin@m p x + n p x - m p y - n p yD z@tD h@tD - m3 p3 Sin@m p x - n p x + m p y - n p yD z@tD h@tD +
3 m2 n p3 Sin@m p x - n p x + m p y - n p yD z@tD h@tD -
3 m n2 p3 Sin@m p x - n p x + m p y - n p yD z@tD h@tD +
n3 p3 Sin@m p x - n p x + m p y - n p yD z@tD h@tD + m3 p3 n Sin@m p x - n p x + m p y - n p yD z@tD h@tD +
m2 n p3 n Sin@m p x - n p x + m p y - n p yD z@tD h@tD - m n2 p3 n Sin@m p x - n p x + m p y - n p yD
z@tD h@tD - n3 p3 n Sin@m p x - n p x + m p y - n p yD z@tD h@tD +
m3 p3 Sin@m p x + n p x + m p y - n p yD z@tD h@tD - m2 n p3 Sin@m p x + n p x + m p y - n p yD z@tD h@tD +
m n2 p3 Sin@m p x + n p x + m p y - n p yD z@tD h@tD - n3 p3 Sin@m p x + n p x + m p y - n p yD z@tD h@tD -
m3 p3 n Sin@m p x + n p x + m p y - n p yD z@tD h@tD + m2 n p3 n Sin@m p x + n p x + m p y - n p yD
z@tD h@tD - m n2 p3 n Sin@m p x + n p x + m p y - n p yD z@tD h@tD +
n3 p3 n Sin@m p x + n p x + m p y - n p yD z@tD h@tD + m3 p3 Sin@m p x - n p x - m p y + n p yD z@tD h@tD -
3 m2 n p3 Sin@m p x - n p x - m p y + n p yD z@tD h@tD +
3 m n2 p3 Sin@m p x - n p x - m p y + n p yD z@tD h@tD -
n3 p3 Sin@m p x - n p x - m p y + n p yD z@tD h@tD - m3 p3 n Sin@m p x - n p x - m p y + n p yD z@tD h@tD -
m2 n p3 n Sin@m p x - n p x - m p y + n p yD z@tD h@tD +
m n2 p3 n Sin@m p x - n p x - m p y + n p yD z@tD h@tD +
n3 p3 n Sin@m p x - n p x - m p y + n p yD z@tD h@tD - m3 p3 Sin@m p x + n p x - m p y + n p yD z@tD h@tD +
m2 n p3 Sin@m p x + n p x - m p y + n p yD z@tD h@tD -
m n2 p3 Sin@m p x + n p x - m p y + n p yD z@tD h@tD + n3 p3 Sin@m p x + n p x - m p y + n p yD z@tD h@tD +
m3 p3 n Sin@m p x + n p x - m p y + n p yD z@tD h@tD - m2 n p3 n Sin@m p x + n p x - m p y + n p yD
z@tD h@tD + m n2 p3 n Sin@m p x + n p x - m p y + n p yD z@tD h@tD -
n3 p3 n Sin@m p x + n p x - m p y + n p yD z@tD h@tD + m3 p3 Sin@m p x - n p x + m p y + n p yD z@tD h@tD +
m2 n p3 Sin@m p x - n p x + m p y + n p yD z@tD h@tD +
m n2 p3 Sin@m p x - n p x + m p y + n p yD z@tD h@tD + n3 p3 Sin@m p x - n p x + m p y + n p yD z@tD h@tD -
m3 p3 n Sin@m p x - n p x + m p y + n p yD z@tD h@tD - m2 n p3 n Sin@m p x - n p x + m p y + n p yD
z@tD h@tD - m n2 p3 n Sin@m p x - n p x + m p y + n p yD z@tD h@tD -
n3 p3 n Sin@m p x - n p x + m p y + n p yD z@tD h@tD - m3 p3 Sin@m p x + n p x + m p y + n p yD z@tD h@tD -
3 m2 n p3 Sin@m p x + n p x + m p y + n p yD z@tD h@tD -
3 m n2 p3 Sin@m p x + n p x + m p y + n p yD z@tD h@tD -
n3 p3 Sin@m p x + n p x + m p y + n p yD z@tD h@tD + m3 p3 n Sin@m p x + n p x + m p y + n p yD z@tD h@tD -
Chapter8.nb
293

m2 n p3 n Sin@m p x + n p x + m p y + n p yD z@tD h@tD -
m n2 p3 n Sin@m p x + n p x + m p y + n p yD z@tD h@tD + n3 p3 n Sin@m p x + n p x + m p y + n p yD
z@tD h@tD + 4 n3 p3 Sin@2 n p yD h@tD2 - 4 m2 n p3 n Sin@2 n p yD h@tD2 +
2 m2 n p3 Sin@2 m p x - 2 n p yD h@tD2 + 2 n3 p3 Sin@2 m p x - 2 n p yD h@tD2 -
2 m2 n p3 Sin@2 m p x + 2 n p yD h@tD2 - 2 n3 p3 Sin@2 m p x + 2 n p yD h@tD2L
To obtain  the particular solutions for u and v, we use the method of undetermined coefficients. To accomplish this, we first
look for all possible terms that appear on the right-hand sides of order2Equ and order2Eqv as follows:
possibleTerms =
Cases@8order2Equ@@2DD, order2Eqv@@2DD<, #, ¥D &  9_ Sin@a_D h1_@tD2 -> Sin@aD h1@tD2,
_ Sin@a_D h1_@tD h2_@tD -> Sin@aD h1@tD h2@tD=  Flatten  Union
8Sin@2 n p xD z@tD2, Sin@2 m p yD z@tD2, Sin@2 n p x - 2 m p yD z@tD2, Sin@2 n p x + 2 m p yD z@tD2,
Sin@m p x - n p x - m p y - n p yD z@tD h@tD, Sin@m p x + n p x - m p y - n p yD z@tD h@tD,
Sin@m p x - n p x + m p y - n p yD z@tD h@tD, Sin@m p x + n p x + m p y - n p yD z@tD h@tD,
Sin@m p x - n p x - m p y + n p yD z@tD h@tD, Sin@m p x + n p x - m p y + n p yD z@tD h@tD,
Sin@m p x - n p x + m p y + n p yD z@tD h@tD, Sin@m p x + n p x + m p y + n p yD z@tD h@tD,
Sin@2 m p xD h@tD2, Sin@2 n p yD h@tD2, Sin@2 m p x - 2 n p yD h@tD2, Sin@2 m p x + 2 n p yD h@tD2<
which satisfy BC1. We then define the following symbol lists to represent the undetermined coefficients.
usymbolList = Table@ci, 8i, Length@possibleTermsD<D
8c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16<
vsymbolList = usymbolList . c -> d
8d1, d2, d3, d4, d5, d6, d7, d8, d9, d10, d11, d12, d13, d14, d15, d16<
Then, we express the solution as
usol = u -> Function@8x, y, t<, usymbolList.possibleTerms  EvaluateD;
vsol = v -> Function@8x, y, t<, vsymbolList.possibleTerms  EvaluateD;
Substituting usol and vsol into order2Equ and order2Eqv, collecting coefficients  of possibleTerms, and solving for usymbol-
List and vsymbolList, we obtain
algEq1 = Coefficient@Subtract  order2Equ . usol . vsol, possibleTermsD == 0  Thread;
algEq2 = Coefficient@Subtract  order2Eqv . usol . vsol, possibleTermsD == 0  Thread;
294
Chapter8.nb

HsymbolRule2 =
Solve@Join@algEq1, algEq2D, Join@usymbolList, vsymbolListDD@@1DD  SimplifyL  Timing
:2.48 Second, :c1 ﬁ- p Hn2 - m2 nL

16 n
, c13 ﬁ- p Hm2 - n2 nL

16 m
, d2 ﬁ- p Hm2 - n2 nL

16 m
, d14 ﬁ- p Hn2 - m2 nL

16 n
,
c2 ﬁ0, c14 ﬁ0, d1 ﬁ0, d13 ﬁ0, c3 ﬁn p

32
, c4 ﬁn p

32
, c15 ﬁm p

32
, c16 ﬁm p

32
, d3 ﬁ- m p

32
,
d4 ﬁm p

32
, d15 ﬁ- n p

32
, d16 ﬁn p

32
, c7 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL + 2 m n H1 + nLL



32 Hm - nL
,
c12 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL - 2 m n H1 + nLL



32 Hm + nL
,
d7 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL + 2 m n H1 + nLL



32 Hm - nL
,
d12 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL - 2 m n H1 + nLL



32 Hm + nL
,
c5 ﬁ
1

32
Hm - nL p H-1 + nL, c6 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL - 2 m n H1 + nLL



32 Hm + nL
,
c8 ﬁ
1

32
Hm + nL p H-1 + nL, c9 ﬁ- p Hm2 H-1 + nL + n2 H-1 + nL + 2 m n H1 + nLL



32 Hm - nL
,
c10 ﬁ
1

32
Hm + nL p H-1 + nL, c11 ﬁ
1

32
Hm - nL p H-1 + nL,
d5 ﬁ- 1

32
Hm + nL p H-1 + nL, d6 ﬁp Hm2 H-1 + nL + n2 H-1 + nL - 2 m n H1 + nLL



32 Hm + nL
,
d8 ﬁ
1

32
Hm - nL p H-1 + nL, d9 ﬁp Hm2 H-1 + nL + n2 H-1 + nL + 2 m n H1 + nLL



32 Hm - nL
,
d10 ﬁ- 1

32
Hm - nL p H-1 + nL, d11 ﬁ
1

32
Hm + nL p H-1 + nL>>
 Solvability Conditions
We introduce two time scales  T0 and T1 and seek a first-order uniform asymptotic  expansion of the solution of wEOM in the
form
solRule = 9w -> FunctionA8x, y, T0, T1<, SumAej-1 wj@x, y, T0, T1D, 8j, 2<EE=;
Transforming the time derivatives  in wEOM in terms  of the scales T0 and T1, substituting solRule into wEOM, expanding the
result for small e, and discarding terms of order higher than e, we obtain
eq83c =
HwEOM . 8Hs : u ¨ v ¨ wL@x, y, tD -> s@x, y, T0, T1D, Derivative@a_, b_, c_D@h_D@x, y, tD ->
dt@cD@D@h@x, y, T0, T1D, 8x, a<, 8y, b<DD< . solRule  ExpandAllL . en_;n>1 -> 0;
Equating coefficients of like powers of e, we have
eqEps = CoefficientList@eq83c@@1DD, eD == 0  Thread;
Chapter8.nb
295

Accounting for the two time scales T0 and T1, we create a rule for h@tD and z@tD
ampRule = 9h@tD -> A1@T1D EI wm,n T0 + A
1@T1D E-I wm,n T0, z@tD -> A2@T1D EI wm,n T0 + A
2@T1D E-I wm,n T0=;
and rewrite w1sol, usol, and vsol as
sol1 = 8w1 -> Function@8x, y, T0, T1<, w@x, y, tD . w1sol . ampRule  EvaluateD,
u -> Function@8x, y, T0, T1<, u@x, y, tD . usol . ampRule  EvaluateD,
v -> Function@8x, y, T0, T1<, v@x, y, tD . vsol . ampRule  EvaluateD<;
Substituting the sol1 into the second-order problem, eqEps[[2]], we obtain
order2Eqw = HeqEps@@1, 1DD . w1 -> w2L == HeqEps@@1, 1DD . w1 -> w2L - eqEps@@2, 1DD . sol1 
ExpandAll;  Timing
811.09 Second, Null<
Collecting the terms that may lead to secular terms, the terms proportional to EI wm,n T0, we have
ST = CoefficientAorder2Eqw@@2DD . expRule, EI wm,n T0E  TrigReduce;  Timing
8156.76 Second, Null<
Among all the spatial-dependent non-forcing terms in ST, only the following terms are not orthogonal to the modeshapes:
terms1 = Cases@ST, Cos@m p x + a_. n p y ; Abs@aD == 1D, ¥D  Union
8Cos@m p x - n p yD, Cos@m p x + n p yD<
terms2 = Cases@ST, Cos@n p x + a_. m p y ; Abs@aD == 1D, ¥D  Union
8Cos@n p x - m p yD, Cos@n p x + m p yD<
The coefficients of these terms in ST are
terms1Coef = Coefficient@ST, terms1D;
terms2Coef = Coefficient@ST, terms2D;
The projection of terms1 onto Sin@mp xDSin@n p yD can be obtained as
p1Coef = à
0
1
à
0
1
Sin@m p xD Sin@n p yD # â x ây &  terms1 . trigRule
9 1
4
, - 1
4
=
and the projection of terms2 onto Sin@n p xDSin@mp yD can be obtained as
296
Chapter8.nb

p2Coef = à
0
1
à
0
1
Sin@n p xD Sin@m p yD # â x ây &  terms2 . trigRule
9 1
4
, - 1
4
=
The forcing term in ST is
f0 = ST . Cos@_D -> 0
1

24
EI T1 s2 F@x, yD
Then, the solvability conditions demand that ST be orthogonal to every linear eigenfunction, modeshapes; that is,
SC1 = Expand@24 Hint@Sin@m p xD Sin@n p yD f0, 8x, 0, 1<, 8y, 0, 1<D + p1Coef.terms1Coef .
symbolRule2 . intRule3 . int -> IntegrateLD == 0;
SC2 = Expand@24 Hint@Sin@n p xD Sin@m p yD f0, 8x, 0, 1<, 8y, 0, 1<D + p2Coef.terms2Coef .
symbolRule2 . intRule3 . int -> IntegrateLD == 0;
They agree with the results obtained in the previous section:
8SC1, SC2< === 8SCond1, SCond2<
True
Chapter8.nb
297

Chapter 9
Higher Approximations of Continuous 
Systems Having Two-to-One Internal 
Resonances
In  this  chapter,  we  use the  method  of multiple  scales  to  determine  second-order  uniform  asymptotic  expansions  of the
solutions of continuous systems  with quadratic  and cubic  nonlinearities possessing two-to-one internal resonances. Higher-
order  treatments  of  such  systems  lead  to  inconsistent  results  if  the  time  derivatives  in  their  governing  equations  are
expressed in second-order rather than first-order form. Therefore, we express the time derivatives in the governing equations
in first-order form before treating them with the method of multiple scales. We describe the methodology using two examples:
two-mode interactions in hinged-hinged buckled beams and four-mode interactions in suspended cables.
à Preliminaries
Off@General::spell1, Integrate::generD
To  determine  second-order uniform asymptotic  expansions  of the  solutions  of  buckled  beams  and  suspended cables  by
using the method of multiple scales, taking into account two-to-one internal resonances, we introduce the three time scales
T0 = t, T1 = et, and  T2 = e2 t, where  e is  a  small nondimensional parameter and  the  order of the  amplitude  of oscillations.
Moreover, we symbolize these scales according to
Needs@"Utilities`Notation`"D
Symbolize@T0D; Symbolize@T1D; Symbolize@T2D;
timeScales = 8T0, T1, T2<;
In terms of the time scales T0, T1, and T2, the time derivatives can be expressed as
dt@0D@expr_D := expr; dt@1D@expr_D := SumAei D@expr, timeScales@@i + 1DDD, 8i, 0, 2<E;
To speed up manipulations of the integrals involved in the governing equations with Mathematica, we introduce the rules
intRule1 = 8int@fun_, arg2__D :> int@Expand@funD, arg2D<;
intRule2 = 8int@a_ + b_, arg2__D :> int@a, arg2D + int@b, arg2D,
int@en_. fun_, arg2__D :> en int@fun, arg2D,
int@a_ fun_, a1_, b1___D :> a int@fun, a1, b1D ; FreeQ@a, First@a1DD,
int@int@a1_, a2_D fun_., a3__D :> int@a1, a2D int@fun, a3D ; FreeQ@Rest@a2D, First@a2DD<;

In the ensuing analysis, we express the solutions in terms of complex-variable functions and hence we introduce the complex-
conjugate rule
conjugateRule = 9As_ :> A
s, A
s_ :> As, Complex@m_, n_D :> Complex@m, -nD=;
To display the outputs in easily read expressions, we introduce the rules
displayRule = 9Derivative@a_, b__DAw_i__E@_, T0, __D :>
SequenceFormAIfAarg1 = Times  MapIndexedAD#2@@1DD-1
#1
&, 8b<E; arg1 =!= 1, arg1, ""E,
wiSequenceForm  Table@"'",8a<DE,
Derivative@a__D@Ai__D@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD
#1
&, 8a<E, AiE,
Derivative@a__D@A
i__D@__D :> SequenceFormATimes  MapIndexedAD#2@@1DD
#1
&, 8a<E, A
iE,
w_i__@_, T0, __D -> wi, Ai__@__D -> Ai, A
i__@__D -> A
i,
Exp@a_. + b_. Complex@0, m_D T0 + c_. Complex@0, n_D T0D -> Exp@a + Hm * b + n * cL I T0D=;
à 9.1 Two-Mode Interactions in Buckled Beams
In  this  section,  we  consider  the  nonlinear  response of a  hinged-hinged  buckled  beam possessing  a  two-to-one  internal
resonance to  a principal parametric  resonance of the higher mode. The  analysis  assumes  a  unimodal static  buckled deflec-
tion. The nondimensional equation of motion is (Section 8.1.1)
EOM = ut,t + ux,x,x,x + Pk ux,x - 2 b2 a i
k
jjà
0
1
 ux fk
¢ @xD âxy
{
zz fk
†@xD ==
-c ut + b a i
k
jjà
0
1
ux
2 âxy
{
zz fk
†@xD + 2 b a i
k
jjà
0
1
 ux fk
¢ @xD â xy
{
zz ux,x +
a i
k
jjà
0
1
ux
2 âxy
{
zz ux,x + Cos@t WD f ux,x + b Cos@t WD f fk
†@xD . um__ :> ¶m u@x, tD;
and the associated boundary conditions are
BC = 9u@0, tD == 0, uH2,0L@0, tD == 0, u@1, tD == 0, uH2,0L@1, tD == 0=;
where Pk is the kth critical Euler buckling load, fk is the kth buckling mode shape, and b is the nondimensional buckling level.
Because the two-to-one  internal resonance  is  activated by  the quadratic  nonlinearities, as  indicated  in Chapter 5, second-
and higher-order treatments of such systems  lead to inconsistent results if the time derivatives  in their governing equations
are  expressed in second-order rather than  first-order form. Therefore,  we express the  time derivatives  in  first-order form by
letting v@x, tD == ¶t u@x, tD, adding it to EOM, and obtaining
EOM1 = 8¶tu@x, tD - v@x, tD == 0, EOM . ¶t,tu@x, tD -> ¶tv@x, tD<;
We use the method of multiple scales to directly attack EOM1 and BC. To transform the time derivatives in EOM1 in terms of
the scales T0, T1, and T2, we define
298
Chapter9.nb

multiScales = 8u@x_, tD -> u@x, T0, T1, T2D, v@x, tD -> v@x, T0, T1, T2D,
Derivative@m_, n_D@u_D@x_, tD -> dt@nD@D@u@x, T0, T1, T2D, 8x, m<DD, t -> T0<;
Then, we seek a second-order approximate solution of EOM1 and BC in the form
solRule = h : u ¨ v -> IEvaluateASumAej hj@#1, #2, #3, #4D, 8j, 3<EE &M;
where #1 stands for x and #2, #3, and #4 stand for T0, T1, and T2, respectively.
We consider the case of a two-to-one internal resonance between the lowest two modes and a principal parametric resonance
of the second mode; that is,
omgList = 8w1, w2<;
ResonanceConds = 8w2 == 2 w1 + e s1, W == 2 w2 + e s2<;
where the si are detuning parameters  that describe the nearness of the resonances. Because the influence of the two-to-one
internal resonance appears at O(e), we scale the damping and forcing terms as
scaling = 8c -> 2 e m, f -> e f<;
Substituting multiScales, solRule, and scaling  into EOM1, expanding the result  for small e, and discarding  terms  of order
higher than e3, we obtain
eq91a =
HEOM1 . Integrate -> int . multiScales . solRule . scaling . intRule1 . intRule2 
TrigToExp  ExpandAllL . en_;n>3 -> 0;
Equating coefficients of like powers of e, we obtain
eqEps = Thread@CoefficientList@Subtract  #, eD == 0D &  eq91a  Transpose  Rest;
eqEps . displayRule
99D0u1 - v1 == 0, u1
'''' + D0v1 + Hu1
''L Pk - 1
2
b E-IT0 W f fk
† @xD -
1
2
b EI T0 W f fk
† @xD - 2 b2 a int@Hu1
'L fk
¢ @xD, 8x, 0, 1<D fk
†@xD == 0=,
9D0u2 + D1u1 - v2 == 0, - 1
2
E-I T0 W f Hu1
''L - 1
2
EI T0 W f Hu1
''L -
2 b a int@Hu1
'L fk
¢ @xD, 8x, 0, 1<D Hu1
''L + u2
'''' + 2 m HD0u1L + D0v2 + D1v1 + Hu2
''L Pk -
b a intBHu1
'L
2, 8x, 0, 1<F fk
† @xD - 2 b2 a int@Hu2
'L fk
¢ @xD, 8x, 0, 1<D fk
†@xD == 0=,
9D0u3 + D1u2 + D2u1 - v3 == 0, -a intBHu1
'L
2, 8x, 0, 1<F Hu1
''L -
2 b a int@Hu2
'L fk
¢ @xD, 8x, 0, 1<D Hu1
''L - 1
2
E-I T0 W f Hu2
''L - 1
2
EI T0 W f Hu2
''L -
2 b a int@Hu1
'L fk
¢ @xD, 8x, 0, 1<D Hu2
''L + u3
'''' + 2 m HD0u2L + D0v3 + 2 m HD1u1L + D1v2 + D2v1 +
Hu3
''L Pk - 2 b a int@Hu1
'L Hu2
'L, 8x, 0, 1<D fk
†@xD - 2 b2 a int@Hu3
'L fk
¢ @xD, 8x, 0, 1<D fk
† @xD == 0==
Chapter9.nb
299

 9.1.1 First-Order Solution
The homogeneous part of the first-order equations, eqEps[[1]], can be written as
linearSys = #@@1DD &  eqEps@@1DD . f -> 0;
linearSys . displayRule
8D0u1 - v1, u1
'''' + D0v1 + Hu1
''L Pk - 2 b2 a int@Hu1
'L fk
¢ @xD, 8x, 0, 1<D fk
† @xD<
Because in the presence of damping all of the modes  that are not directly or indirectly excited decay with time (Nayfeh and
Mook, 1979), the solution of eqEps[[1]] is taken to consist of the lowest two modes; that is,
solForm = Y@xD Exp@I W T0D + Y@xD Exp@-I W T0D +
SumAAi@T1, T2D Fi@xD Exp@I wi T0D + A
i@T1, T2D Fi@xD Exp@-I wi T0D, 8i, 2<E;
sol1 = 8u1 -> Function@8x, T0, T1, T2<, solForm  EvaluateD,
v1 -> Function@8x, T0, T1, T2<, D@solForm, T0D  EvaluateD<
8u1 ﬁFunction@8x, T0, T1, T2<, E-IT0 W Y@xD + EI T0 W Y@xD + EI T0 w1 A1@T1, T2D F1@xD +
EI T0 w2 A2@T1, T2D F2@xD + E-I T0 w1 F1@xD A
1@T1, T2D + E-I T0 w2 F2@xD A
2@T1, T2DD,
v1 ﬁFunction@8x, T0, T1, T2<, -I E-I T0 W W Y@xD + I EI T0 W W Y@xD + I EIT0 w1 w1 A1@T1, T2D F1@xD +
I EI T0 w2 w2 A2@T1, T2D F2@xD - I E-IT0 w1 w1 F1@xD A
1@T1, T2D - I E-I T0 w2 w2 F2@xD A
2@T1, T2DD<
where  the  Fi  are  the  eigenmodes, which  satisfy  the orthonormality  condition  Ù0
1Fn @xDFm@xDâ x = dn,m, and  Y  is  uniquely
determined by the following boundary-value problem:
eq91b = CoefficientA
eqEps@@1, 2, 1DD . Isol1 . 9Ai_ -> H0 &L, A
i_ -> H0 &L=M . intRule1 . intRule2,
EI W T0E == 0
-W2 Y@xD + Pk Y†@xD - 1
2
b f fk
† @xD - 2 b2 a int@Y¢@xD fk
¢ @xD, 8x, 0, 1<D fk
† @xD + YH4L@xD == 0
bc91b = BC . u -> Y
8Y@0, tD == 0, YH2,0L@0, tD == 0, Y@1, tD == 0, YH2,0L@1, tD == 0<
In what follows, we consider nonlinear vibrations of a first-mode buckled beam; hence, the critical buckling load is
bucklingLoad = Pk -> p2;
We note that, as  the buckling level increases  from zero, the symmetric mode is the first mode. However, as the buckling level
exceeds the first cross-over value, the symmetric mode becomes  the second mode. Hence, the second natural frequency w2
depends on the buckling level. For buckling levels  greater than the cross-over value, the first static  buckled deflection and
the first two normalized mode shapes and associated natural frequencies are
300
Chapter9.nb

modeshapes = 9fk -> HSin@p #D &L, F1 -> I ! !!2  Sin@2 p #D &M, F2 -> I ! !!2  Sin@p #D &M=;
frequencies = 9w2 -> b p2  !!!a , w1 -> 2  !!!3 p2=;
The buckling level at which w2 = 2 w1 is
values1 = Solve@w2 == 2 w1 . frequencies, bD@@1DD
:b ﬁ4  !!!3

 !!!a
>
Substituting the bucklingLoad and modeshapes into eq91b yields
eq91c = eq91b . bucklingLoad . modeshapes
1
2
b f p2 Sin@p xD +
2 b2 p2 a int@p Cos@p xD Y¢@xD, 8x, 0, 1<D Sin@p xD - W2 Y@xD + p2 Y†@xD + YH4L@xD == 0
Inspection of eq91c and bc91b suggests that Y@xD has the form
Ysol = Y -> HG Sin@p #D &L;
Substituting  Ysol  into eq91c, collecting  the coefficient  of Sin@p xD, solving the  resulting  equation  for G, and  simplifying it
using frequencies and values1, we obtain
GRule = Solve@Coefficient@eq91c@@1DD . Ysol . int -> Integrate, Sin@p xDD == 0, GD@@1DD .
W -> 2 w2 . frequencies . values1
:G ﬁ
f

24  !!!3 p2  !!!a
>
Because the buckled-beam problem is self-adjoint, we have
adjoint = 88-I w1 F1@xD, F1@xD<, 8-I w2 F2@xD, F2@xD<<;
whose complex conjugate is
adjointC = adjoint . conjugateRule
88I w1 F1@xD, F1@xD<, 8I w2 F2@xD, F2@xD<<
 9.1.2 Second-Order Solution
Substituting sol1, Ysol, and some of the parameter values into eqEps[[2]] yields
Chapter9.nb
301

order2Eq =
HlinearSys . u_1 -> u2L == HHlinearSys . u_1 -> u2L - H#@@1DD &  eqEps@@2DDL . sol1 .
Ysol . GRule . intRule1 . intRule2 . modeshapes .
int -> Integrate  ExpandL . bucklingLoad . values1  Thread;
order2Eq . displayRule
:D0u2 - v2 == - !!!2 EIT0 w2 HD1A2L Sin@p xD -  ! !!2 E-I T0 w2 HD1A
2L Sin@p xD -
 !!!2 EI T0 w1 HD1A1L Sin@2 p xD -  ! !!2 E-I T0 w1 HD1A
1L Sin@2 p xD,
p2 Hu2
''L + u2
'''' + D0v2 - 96 int@Hu2
'L fk
¢ @xD, 8x, 0, 1<D fk
† @xD ==
- f2 Sin@p xD

16  !!!3  !!!a
- E-2 I T0 W f2 Sin@p xD


32  !!!3  ! !!a
- E2 I T0 W f2 Sin@p xD


32  !!!3  !!!a
+ I E-I T0 W f m W Sin@p xD


12  !!!3 p2  !!!a
-
I EI T0 W f m W Sin@p xD


12  !!!3 p2  !!!a
- 8
3
 ! !!2 EI T0 H-W+w1L f p2 Sin@2 p xD A1 - 8
3
 ! !!2 EI T0 HW+w1L f p2 Sin@2 p xD A1 -
16  !!!3 E2I T0 w1 p4  ! !!a Sin@p xD A1
2 -  !!!2 EI T0 H-W+w2L f p2 Sin@p xD A2 -  !!!2 EI T0 HW+w2L f p2 Sin@p xD A2 -
32  !!!3 EIT0 Hw1+w2L p4  !!!a Sin@2 p xD A1 A2 - 12  ! !!3 E2 I T0 w2 p4  !!!a Sin@p xD A2
2 -
I  !!!2 EIT0 w1 HD1A1L Sin@2 p xD w1 + I  !!!2 E-I T0 w1 HD1A
1L Sin@2 p xD w1 -
2 I  !!!2 EI T0 w1 m Sin@2 p xD A1 w1 - I  !!!2 EIT0 w2 HD1A2L Sin@p xD w2 + I  !!!2 E-I T0 w2 HD1A
2L Sin@p xD w2 -
2 I  !!!2 EI T0 w2 m Sin@p xD A2 w2 - 8
3
 ! !!2 EI T0 H-W-w1L f p2 Sin@2 p xD A
1 -
8
3
 ! !!2 EI T0 HW-w1L f p2 Sin@2 p xD A
1 - 32  !!!3 p4  !!!a Sin@p xD A1 A
1 -
32  !!!3 EIT0 H-w1+w2L p4  !!!a Sin@2 p xD A2 A
1 + 2 I  ! !!2 E-I T0 w1 m Sin@2 p xD w1 A
1 -
16  !!!3 E-2 I T0 w1 p4  ! !!a Sin@p xD A
1
2 -  !!!2 EI T0 H-W-w2L f p2 Sin@p xD A
2 -
 !!!2 EI T0 HW-w2L f p2 Sin@p xD A
2 - 32  !!!3 EI T0 Hw1-w2L p4  !!!a Sin@2 p xD A1 A
2 -
24  !!!3 p4  !!!a Sin@p xD A2 A
2 + 2 I  !!!2 E-I T0 w2 m Sin@p xD w2 A
2 -
32  !!!3 EIT0 H-w1-w2L p4  !!!a Sin@2 p xD A
1 A
2 - 12  ! !!3 E-2 I T0 w2 p4  !!!a Sin@p xD A
2
2>
In order to collect the terms that may lead to secular terms from the right-hand sides of order2Eq, we define the rules
OmgRule = Solve@ResonanceConds, Complement@omgList, 8#<D ~Join~ 8W<D@@1DD &  omgList
98w2 ﬁe s1 + 2 w1, W ﬁ2 e s1 + e s2 + 4 w1<, 9w1 ﬁ1
2
H-e s1 + w2L, W ﬁe s2 + 2 w2==
expRule1@i_D := Exp@arg_D :> Exp@Expand@arg . OmgRule@@iDDD . e T0 -> T1D
Collecting the terms that may lead to secular terms, the terms proportional to EI wi T0, we have
ST11 = CoefficientA#@@2DD &  order2Eq . expRule1@1D, EI w1 T0 E;
ST11 . displayRule
9- !!!2 HD1A1L Sin@2 p xD,
-I  !!!2 HD1A1L Sin@2 p xD w1 - 2 I  !!!2 m Sin@2 p xD A1 w1 - 32 ! !!3 EI T1 s1 p4  !!!a Sin@2 p xD A2 A
1=
302
Chapter9.nb

ST12 = CoefficientA#@@2DD &  order2Eq . expRule1@2D, EI w2 T0 E;
ST12 . displayRule
9- !!!2 HD1A2L Sin@p xD, -16  !!!3 E-I T1 s1 p4  ! !!a Sin@p xD A1
2 -
I  !!!2 HD1A2L Sin@p xD w2 - 2 I  ! !!2 m Sin@p xD A2 w2 -  !!!2 EI T1 s2 f p2 Sin@p xD A
2=
Demanding that ST11 be orthogonal to the adjointC[[1]], we obtain the solvability condition
SCond11 =
SolveAint@adjointC@@1DD.ST11, 8x, 0, 1<D == 0 . intRule1 . intRule2 . modeshapes .
int -> Integrate, A1
H1,0L@T1, T2DE@@1DD  ExpandAll
:A1
H1,0L@T1, T2D ﬁ-m A1@T1, T2D + 8 I  !!!6 EIT1 s1 p4 ! !!a A2@T1, T2D A
1@T1, T2D



w1
>
Demanding that ST12 be orthogonal to the adjointC[[2]], we obtain the solvability condition
SCond12 =
SolveAint@adjointC@@2DD.ST12, 8x, 0, 1<D == 0 . intRule1 . intRule2 . modeshapes .
int -> Integrate, A2
H1,0L@T1, T2DE@@1DD  ExpandAll
:A2
H1,0L@T1, T2D ﬁ4 I  !!!6 E-IT1 s1 p4 ! !!a A1@T1, T2D2



w2
- m A2@T1, T2D + I EI T1 s2 f p2 A
2@T1, T2D


2 w2
>
Hence, we have the solvability conditions
SCond1 = Join@SCond11, SCond12D;
whose complex conjugates are
ccSCond1 = SCond1 . conjugateRule;
To remove D1A1 and D1A2 from the right-hand sides of order2Eq, we first define the rules
sigRule = Solve@ResonanceConds, 8s1, s2<D@@1DD
9s1 ﬁ- 2 w1 - w2

e
, s2 ﬁ- -W + 2 w2

e
=
expRule2 = Exp@a_D :> Exp@a . sigRule . T1 -> e T0  ExpandD;
Substituting SCond1, ccSCond1, and expRule2 into order2Eq, we obtain
Chapter9.nb
303

order2Eqm = order2Eq . SCond1 . ccSCond1 . expRule2  ExpandAll;
order2Eqm . displayRule
9D0u2 - v2 ==  ! !!2 EI T0 w1 m Sin@2 p xD A1 +  !!!2 EIT0 w2 m Sin@p xD A2 -
8 I  !!!3 E2 I T0 w1 p4  !!!a Sin@p xD A1
2



w2
+ I EI T0 H-W+w2L f p2 Sin@p xD A2


 ! !!2 w2
+
 !!!2 E-IT0 w1 m Sin@2 p xD A
1 - 16 I  !!!3 EI T0 H-w1+w2L p4  !!!a Sin@2 p xD A2 A
1



w1
+
8 I  !!!3 E-2 I T0 w1 p4  !!!a Sin@p xD A
1
2



w2
+  !!!2 E-I T0 w2 m Sin@p xD A
2 +
16 I  !!!3 EI T0 Hw1-w2L p4  ! !!a Sin@2 p xD A1 A
2



w1
- I EI T0 HW-w2L f p2 Sin@p xD A
2


 !!!2 w2
,
p2 Hu2
''L + u2
'''' + D0v2 - 96 int@Hu2
'L fk
¢ @xD, 8x, 0, 1<D fk
† @xD ==
- f2 Sin@p xD

16  !!!3  !!!a
- E-2 I T0 W f2 Sin@p xD


32  !!!3  ! !!a
- E2 I T0 W f2 Sin@p xD


32  !!!3  !!!a
+ I E-I T0 W f m W Sin@p xD


12  !!!3 p2  !!!a
-
I EI T0 W f m W Sin@p xD


12  !!!3 p2  !!!a
- 8
3
 ! !!2 EI T0 H-W+w1L f p2 Sin@2 p xD A1 - 8
3
 ! !!2 EI T0 HW+w1L f p2 Sin@2 p xD A1 -
8  !!!3 E2I T0 w1 p4  ! !!a Sin@p xD A1
2 + EI T0 H-W+w2L f p2 Sin@p xD A2


 !!!2
-  ! !!2 EI T0 H-W+w2L f p2 Sin@p xD A2 -
 !!!2 EI T0 HW+w2L f p2 Sin@p xD A2 - 32  !!!3 EI T0 Hw1+w2L p4  !!!a Sin@2 p xD A1 A2 -
12  !!!3 E2I T0 w2 p4  ! !!a Sin@p xD A2
2 - I  !!!2 EI T0 w1 m Sin@2 p xD A1 w1 -
I  !!!2 EIT0 w2 m Sin@p xD A2 w2 - 8
3
 ! !!2 EI T0 H-W-w1L f p2 Sin@2 p xD A
1 -
8
3
 ! !!2 EI T0 HW-w1L f p2 Sin@2 p xD A
1 - 32  !!!3 p4  !!!a Sin@p xD A1 A
1 -
16  !!!3 EIT0 H-w1+w2L p4  !!!a Sin@2 p xD A2 A
1 + I  ! !!2 E-I T0 w1 m Sin@2 p xD w1 A
1 -
8  !!!3 E-2 I T0 w1 p4  ! !!a Sin@p xD A
1
2 -  !!!2 EI T0 H-W-w2L f p2 Sin@p xD A
2 + EI T0 HW-w2L f p2 Sin@p xD A
2


 !!!2
-
 !!!2 EI T0 HW-w2L f p2 Sin@p xD A
2 - 16  !!!3 EI T0 Hw1-w2L p4  !!!a Sin@2 p xD A1 A
2 -
24  !!!3 p4  !!!a Sin@p xD A2 A
2 + I  !!!2 E-I T0 w2 m Sin@p xD w2 A
2 -
32  !!!3 EIT0 H-w1-w2L p4  !!!a Sin@2 p xD A
1 A
2 - 12  ! !!3 E-2 I T0 w2 p4  !!!a Sin@p xD A
2
2=
We  use the  method  of undetermined  coefficients  to  determine  the  solution  of order2Eqm and  their  associated  boundary
conditions. To implement this, we  first determine  all possible  forms  of the  terms  on  the right-hand  sides  of order2Eqm as
follows:
304
Chapter9.nb

sol2Form = TableACases@order2Eqm@@k, 2DD, #D &  9_ Ea_ T0+b_. f_@c_ xD -> EaT0+b f@c xD,
a_ f_@b_ xD :> f@b xD ; FreeQ@a, T0D=, 8k, 2<E  Flatten  Union
8Sin@p xD, E-I T0 W Sin@p xD, EI T0 W Sin@p xD, E-2 I T0 W Sin@p xD, E2 I T0 W Sin@p xD,
E-2 I T0 w1 Sin@p xD, E2 I T0 w1 Sin@p xD, E-IT0 w2 Sin@p xD, EI T0 w2 Sin@p xD, E-2 I T0 w2 Sin@p xD,
E2 I T0 w2 Sin@p xD, E-I T0 W-IT0 w2 Sin@p xD, EI T0 W-I T0 w2 Sin@p xD, E-I T0 W+I T0 w2 Sin@p xD,
EI T0 W+I T0 w2 Sin@p xD, E-I T0 w1 Sin@2 p xD, EI T0 w1 Sin@2 p xD, E-I T0 W-I T0 w1 Sin@2 p xD,
EI T0 W-I T0 w1 Sin@2 p xD, E-I T0 W+I T0 w1 Sin@2 p xD, EI T0 W+I T0 w1 Sin@2 p xD, E-IT0 w1-I T0 w2 Sin@2 p xD,
EI T0 w1-I T0 w2 Sin@2 p xD, E-I T0 w1+I T0 w2 Sin@2 p xD, EI T0 w1+I T0 w2 Sin@2 p xD<
where all the spatial dependent functions satisfy  the hinged-hinged boundary  conditions. We note that sol2Form consists
of  (a) the  terms  that  are  proportional to  E-I w1 T0, EI w1 T0, E-I w2 T0, EI w2 T0 and  (b)  the  remainder  of the  terms. The
positions of the former terms, which are orthogonal to the adjoint, in sol2Form are
pos@1D =
HPosition@# sol2Form . expRule1@1D . Exp@_. + _ T0D -> 0, a_ ; a =!= 0, 1D  Flatten 
RestL &  9E-I w1 T0, EI w1 T0=
8817, 24<, 816, 23<<
pos@2D =
HPosition@# sol2Form . expRule1@2D . Exp@_. + _ T0D -> 0, a_ ; a =!= 0, 1D  Flatten 
RestL &  9E-I w2 T0, EI w2 T0=
887, 9, 13<, 86, 8, 14<<
Next, we seek the solution of  u2 and v2 in two parts. First, we consider the part of sol2Form that is not related to the secular
terms
sol2Forma = Delete@sol2Form, 8#< &  Flatten@Array@pos, 2DDD
8Sin@p xD, E-I T0 W Sin@p xD, EI T0 W Sin@p xD, E-2 I T0 W Sin@p xD, E2 I T0 W Sin@p xD,
E-2 I T0 w2 Sin@p xD, E2 I T0 w2 Sin@p xD, E-IT0 W-I T0 w2 Sin@p xD, EI T0 W+I T0 w2 Sin@p xD,
E-I T0 W-I T0 w1 Sin@2 p xD, EI T0 W-I T0 w1 Sin@2 p xD, E-I T0 W+I T0 w1 Sin@2 p xD,
EI T0 W+I T0 w1 Sin@2 p xD, E-I T0 w1-I T0 w2 Sin@2 p xD, EI T0 w1+IT0 w2 Sin@2 p xD<
and define the undetermined coefficients as
uSymbola = Table@yi, 8i, Length@sol2FormaD<D;
vSymbola = uSymbola . y -> h;
The general solution in terms of the sol2Forma can be written as
sol2a = 8u2 -> Function@8x, T0, T1, T2<, uSymbola.sol2Forma  EvaluateD,
v2 -> Function@8x, T0, T1, T2<, vSymbola.sol2Forma  EvaluateD<;
Second, we consider the part of sol2Form that is related to the secular terms
Chapter9.nb
305

sol2Formb1 = sol2Form@@pos@1D@@1DDDD
8EI T0 w1 Sin@2 p xD, E-I T0 w1+I T0 w2 Sin@2 p xD<
sol2Formb2 = sol2Form@@pos@2D@@1DDDD
8E2 I T0 w1 Sin@p xD, EI T0 w2 Sin@p xD, EI T0 W-I T0 w2 Sin@p xD<
and define the undetermined coefficients as
uSymbolb1 = Table@ys1,i, 8i, Length@sol2Formb1D<D;
uSymbolb2 = Table@ys2,i, 8i, Length@sol2Formb2D<D;
where  the  undetermined  coefficients  for v2  are  related  to  uSymbolb1  and  uSymbolb2  due  to  the  orthogonality  condition.
Therefore, the general solution in terms of the sol2Formb1 and sol2Formb2 can be written as
sol2b =
8u2 -> Function@8x, T0, T1, T2<, uSymbolb1.sol2Formb1 + uSymbolb2.sol2Formb2  EvaluateD,
v2 -> Function@8x, T0, T1, T2<,
-I w1 uSymbolb1.sol2Formb1 - I w2 uSymbolb2.sol2Formb2  EvaluateD<;
The total solution is the sum of sol2a, sol2b, and the complex conjugate of sol2b.
Next, we  solve  for these  undetermined  coefficients.  Substituting  sol2a  into  order2Eqm  and  equating  the  coefficients  of
sol2Forma, we have
algEqa =
Flatten@Coefficient@Subtract  # . sol2a . intRule1 . intRule2 . modeshapes . int ->
Integrate, sol2FormaD &  order2EqmD == 0 . Exp@_ T0 + _.D -> 0  Thread;
Substituting some of the parameter values into algEqa and solving for uSymbola and vSymbola, we obtain
306
Chapter9.nb

symbolaRule =
Solve@algEqa, uSymbola~ Join~vSymbolaD@@1DD . W -> 2 w2 . frequencies . values1
:h1 ﬁ0, y1 ﬁ-
 !!!3 f2 + 1536  !!!3 p4 a A1@T1, T2D A
1@T1, T2D + 1152  !!!3 p4 a A2@T1, T2D A
2@T1, T2D






2304 p4  !!!a
,
h2 ﬁ-
f m

9  !!!3 p2  !!!a
, h3 ﬁ-
f m

9  !!!3 p2  !!!a
, h4 ﬁ-
I f2

1440 p2  !!!a
, h5 ﬁ
I f2

1440 p2  ! !!a
,
h6 ﬁ-2 I p2  !!!a A
2@T1, T2D
2, h7 ﬁ2 I p2  !!!a A2@T1, T2D2, y2 ﬁ-
I f m

216 p4  !!!a
,
y3 ﬁ
I f m

216 p4  !!!a
, y4 ﬁ
f2


23040  !!!3 p4  !!!a
, y5 ﬁ
f2


23040  ! !!3 p4  ! !!a
, y6 ﬁ
 !!!a A
2@T1, T2D
2

4  ! !!3
,
y7 ﬁ
 ! !!a A2@T1, T2D2

4  !!!3
, h8 ﬁ- 1

16
I $ %% %%
3
2
f A
2@T1, T2D, h9 ﬁ
1

16
I $ % %%%%
3
2
f A2@T1, T2D,
h10 ﬁ- 5 I f A
1@T1, T2D

9  !!!6
, h11 ﬁI f A
1@T1, T2D

 ! !!6
, h12 ﬁ- I f A1@T1, T2D

 !!!6
, h13 ﬁ5 I f A1@T1, T2D

9  !!!6
,
h14 ﬁ-6 I p2  !!!a A
1@T1, T2D A
2@T1, T2D, h15 ﬁ6 I p2  !!!a A1@T1, T2D A2@T1, T2D, y8 ﬁf A
2@T1, T2D

192  !!!2 p2
,
y9 ﬁf A2@T1, T2D

192  !!!2 p2
, y10 ﬁf A
1@T1, T2D

54  !!!2 p2
, y11 ﬁf A
1@T1, T2D

18  !!!2 p2
, y12 ﬁf A1@T1, T2D

18  !!!2 p2
,
y13 ﬁf A1@T1, T2D

54  !!!2 p2
, y14 ﬁ
 !!!a A
1@T1, T2D A
2@T1, T2D


! !!3
, y15 ﬁ
 !!!a A1@T1, T2D A2@T1, T2D


 ! !!3
>
Substituting sol2b into either of the two equations in order2Eqm, equating the coefficients  of sol2Formb1 and sol2Formb2,
and solving for uSymbolb1 and uSymbolb2, we have
symbolbRule =
Solve@Coefficient@Subtract  order2Eqm@@1DD . sol2b, sol2Formb1~Join~ sol2Formb2D ==
0 . Exp@_ T0 + _.D -> 0  Thread,
uSymbolb1~ Join~uSymbolb2D@@1DD . W -> 2 w2 . frequencies . values1
:ys1,1 ﬁ- I m A1@T1, T2D

2  !!!6 p2
, ys1,2 ﬁ- 2  !!!a A2@T1, T2D A
1@T1, T2D


 !!!3
,
ys2,2 ﬁ- I m A2@T1, T2D

4  !!!6 p2
, ys2,3 ﬁ- f A
2@T1, T2D

96  !!!2 p2
, ys2,1 ﬁ-
 !!!a A1@T1, T2D2

4  !!!3
>
Substituting these symbol values into sol2a and sol2b yields
sol2aForm = 8u2@x, T0, T1, T2D, v2@x, T0, T1, T2D< . sol2a . symbolaRule;
sol2bForm = 8u2@x, T0, T1, T2D, v2@x, T0, T1, T2D< . sol2b . symbolbRule;
Chapter9.nb
307

sol2 = 8u2 ﬁFunction@8x, T0, T1, T2<,
sol2aForm@@1DD + sol2bForm@@1DD + Hsol2bForm@@1DD . conjugateRuleL  Expand 
EvaluateD, v2 ﬁFunction@8x, T0, T1, T2<, sol2aForm@@2DD + sol2bForm@@2DD +
Hsol2bForm@@2DD . conjugateRuleL  Expand  EvaluateD<
:u2 ﬁFunctionB8x, T0, T1, T2<,
-
f2 Sin@p xD

768  ! !!3 p4  ! !!a
+ E-2I T0 W f2 Sin@p xD


23040  !!!3 p4  !!!a
+ E2 I T0 W f2 Sin@p xD


23040  ! !!3 p4  ! !!a
- I E-I T0 W f m Sin@p xD


216 p4  !!!a
+
I EI T0 W f m Sin@p xD


216 p4  !!!a
+ E-I T0 W+I T0 w1 f Sin@2 p xD A1@T1, T2D



18  !!!2 p2
+ EIT0 W+I T0 w1 f Sin@2 p xD A1@T1, T2D



54  !!!2 p2
-
I EI T0 w1 m Sin@2 p xD A1@T1, T2D



2  ! !!6 p2
- E2 I T0 w1  !!!a Sin@p xD A1@T1, T2D2



4  ! !!3
-
E-I T0 W+I T0 w2 f Sin@p xD A2@T1, T2D



96  !!!2 p2
+ EI T0 W+I T0 w2 f Sin@p xD A2@T1, T2D



192  ! !!2 p2
-
I EI T0 w2 m Sin@p xD A2@T1, T2D


4  !!!6 p2
+ EI T0 w1+I T0 w2  !!!a Sin@2 p xD A1@T1, T2D A2@T1, T2D




 ! !!3
+
E2 IT0 w2  !!!a Sin@p xD A2@T1, T2D2



4  !!!3
+ E-I T0 W-IT0 w1 f Sin@2 p xD A
1@T1, T2D



54  !!!2 p2
+
EI T0 W-I T0 w1 f Sin@2 p xD A
1@T1, T2D



18  !!!2 p2
+ I E-I T0 w1 m Sin@2 p xD A
1@T1, T2D



2  !!!6 p2
-
2  !!!a Sin@p xD A1@T1, T2D A
1@T1, T2D



 !!!3
- 2 E-I T0 w1+I T0 w2  !!!a Sin@2 p xD A2@T1, T2D A
1@T1, T2D




 !!!3
-
E-2 IT0 w1  !!!a Sin@p xD A
1@T1, T2D
2



4  ! !!3
+ E-I T0 W-I T0 w2 f Sin@p xD A
2@T1, T2D



192  !!!2 p2
-
EI T0 W-I T0 w2 f Sin@p xD A
2@T1, T2D



96  !!!2 p2
+ I E-I T0 w2 m Sin@p xD A
2@T1, T2D


4  !!!6 p2
-
2 EI T0 w1-I T0 w2  !!!a Sin@2 p xD A1@T1, T2D A
2@T1, T2D




 !!!3
- 1
2
 !!!3  ! !!a Sin@p xD A2@T1, T2D A
2@T1, T2D +
E-I T0 w1-I T0 w2  !!!a Sin@2 p xD A
1@T1, T2D A
2@T1, T2D




 ! !!3
+ E-2 I T0 w2  !!!a Sin@p xD A
2@T1, T2D
2



4  !!!3
F,
v2 ﬁFunctionB8x, T0, T1, T2<, - I E-2 I T0 W f2 Sin@p xD


1440 p2  ! !!a
+ I E2I T0 W f2 Sin@p xD


1440 p2 ! !!a
-
E-I T0 W f m Sin@p xD


9  !!!3 p2  !!!a
- EI T0 W f m Sin@p xD


9  !!!3 p2  !!!a
- I E-I T0 W+I T0 w1 f Sin@2 p xD A1@T1, T2D



 !!!6
+
5 I EIT0 W+I T0 w1 f Sin@2 p xD A1@T1, T2D



9  !!!6
- EI T0 w1 m Sin@2 p xD w1 A1@T1, T2D



2  !!!6 p2
+
I E2 IT0 w1  !!!a Sin@p xD w2 A1@T1, T2D2



4  !!!3
+
1

16
I $ %% %%
3
2
EI T0 W+I T0 w2 f Sin@p xD A2@T1, T2D -
308
Chapter9.nb

I E-IT0 W+I T0 w2 f Sin@p xD w2 A2@T1, T2D



96  ! !!2 p2
- EI T0 w2 m Sin@p xD w2 A2@T1, T2D


4  !!!6 p2
+
6 I EI T0 w1+I T0 w2 p2  !!!a Sin@2 p xD A1@T1, T2D A2@T1, T2D + 2 I E2 I T0 w2 p2  !!!a Sin@p xD A2@T1, T2D2 -
5 I E-I T0 W-I T0 w1 f Sin@2 p xD A
1@T1, T2D



9  ! !!6
+ I EI T0 W-I T0 w1 f Sin@2 p xD A
1@T1, T2D



 ! !!6
-
E-I T0 w1 m Sin@2 p xD w1 A
1@T1, T2D



2  !!!6 p2
+ 2 I E-I T0 w1+I T0 w2  !!!a Sin@2 p xD w1 A2@T1, T2D A
1@T1, T2D




 !!!3
-
I E-2I T0 w1  !!!a Sin@p xD w2 A
1@T1, T2D
2



4  !!!3
-
1

16
I $ %% %%
3
2
E-I T0 W-I T0 w2 f Sin@p xD A
2@T1, T2D +
I EI T0 W-I T0 w2 f Sin@p xD w2 A
2@T1, T2D



96  !!!2 p2
- E-I T0 w2 m Sin@p xD w2 A
2@T1, T2D



4  !!!6 p2
-
2 I EIT0 w1-I T0 w2  !!!a Sin@2 p xD w1 A1@T1, T2D A
2@T1, T2D




 !!!3
- 6 I E-I T0 w1-I T0 w2 p2  !!!a
Sin@2 p xD A
1@T1, T2D A
2@T1, T2D - 2 I E-2 I T0 w2 p2  ! !!a Sin@p xD A
2@T1, T2D
2F>
 9.1.3 Solvability Conditions
Substituting sol1, Ysol, sol2, and some of the parameter values into eqEps[[3]] yields
order3Eq = HlinearSys . u_1 -> u3L ==
HHlinearSys . u_1 -> u3L - H#@@1DD &  eqEps@@3DDL . sol1 . Ysol . GRule . sol2 .
intRule1 . intRule2  ExpandL . values1  Thread;  Timing
821.141 Second, Null<
Collecting the terms that may lead to secular terms, the terms proportional to EI wi T0, we have
ST21 =
CoefficientA#@@2DD &  order3Eq . expRule1@1D, EI w1 T0 E . modeshapes . int -> Integrate;
ST22 =
CoefficientA#@@2DD &  order3Eq . expRule1@2D, EI w2 T0 E . modeshapes . int -> Integrate;
Demanding that ST21 be orthogonal to the adjointC[[1]], we obtain the solvability condition
Chapter9.nb
309

SCond21 = SolveAHint@adjointC@@1DD.ST21, 8x, 0, 1<D . intRule1 . intRule2L == 0,
A1
H0,1L@T1, T2DE@@1DD . modeshapes .
int -> Integrate . SCond1 . frequencies . values1  ExpandAll;
SCond21 . displayRule
:D2A1 ﬁ
13 I f2 A1

648  !!!3 p2
-
I m2 A1

4  !!!3 p2
+ I  !!!3 p2 a A1
2 A
1 -
$ %% %%
3
2
EI T1 s1  ! !!a m A2 A
1 - 8 I p2 a A1 A2 A
2

 !!!3
+ 31 I EI T1 s1+I T1 s2 f  !!!a A
1 A
2


72  ! !!2
>
Demanding that ST22 be orthogonal to the adjointC[[2]], we obtain the solvability condition
SCond22 = SolveAHint@adjointC@@2DD.ST22, 8x, 0, 1<D . intRule1 . intRule2L == 0,
A2
H0,1L@T1, T2DE@@1DD . modeshapes . int -> Integrate .
SCond1 . W -> 2 w2 . frequencies . values1  ExpandAll;
SCond22 . displayRule
:D2A2 ﬁ1
4
$ % %%%%
3
2
E-I T1 s1  !!!a m A1
2 -
19 I f2 A2

9216 ! !!3 p2
-
I m2 A2

8  ! !!3 p2
-
4 I p2 a A1 A2 A
1

 ! !!3
+ 31 I EI T1 s1+I T1 s2 f  ! !!a A
1
2


288  !!!2
- 5 EI T1 s2 f m A
2

288 p2
- 1
2
I  !!!3 p2 a A2
2 A
2>
Because  in  the  absence  of damping  the  system is  conservative,  the  modulation  equations,  solvability  conditions, must
satisfy symmetry conditions. To check for these symmetries, we let
formList1a = 9A
1@T1, T2D A
2@T1, T2D, A1@T1, T2D A2@T1, T2D A
2@T1, T2D=;
a1coefs = 8s11, s12< -> Coefficient@H2 w1 IL SCond21@@1, 2DD, formList1aD  Thread
:s11 ﬁ- 31 EI T1 s1+I T1 s2 f  !!!a w1


36  !!!2
, s12 ﬁ16 p2 a w1

 !!!3
>
formList2a = 9A1@T1, T2D A2@T1, T2D A
1@T1, T2D, A
1@T1, T2D
2=;
a2coefs = 8s21, s22< -> Coefficient@H2 w2 IL SCond22@@1, 2DD, formList2aD  Thread
:s21 ﬁ8 p2 a w2

 ! !!3
, s22 ﬁ- 31 EIT1 s1+I T1 s2 f  !!!a w2


144  ! !!2
>
The symmetry condition demands that s12 = s21, which is true because
s12 - s21 . a1coefs . a2coefs . frequencies . values1
0
310
Chapter9.nb

à 9.2 Four-Mode Interactions in Suspended Cables
We  determine a  second-order uniform asymptotic  expansion of the three-dimensional response of a  suspended cable  to a
transverse harmonic distributed  excitation of one of the first two vertical or horizontal modes  when their frequencies  are in
the  ratio  of either two-to-one  or one-to-one  and  no  other internal resonance  is  activated. Benedettini,  Rega,  and Alaggio
(1995) derived nondimensional equations  governing three-dimensional finite-amplitude vibrations  of a suspended  homoge-
neous  elastic  cable  excited  by  harmonic  distributed  vertical and  horizontal  loads. The  time  derivatives  are  expressed  in
second-order form. As discussed in  Chapter 5, second- and higher-order treatments  of such equations lead to inconsistent
results  unless  the  time  derivatives  are  expressed  in  first-order rather than  second-order form. Therefore,  we  rewrite these
equations as
di_Integer,j_Integer := If@i == j, 1, 0D
eq1 = Table@uj,t - vj == 0, 8j, 2<D;
eq2 = TableAvj,t + 2 mj vj - uj,x,x - a Hb y†@xD d1,j + uj,x,xL à
0
1i
k
jjb y¢@xD u1,x + 1
2
Iu1,x
2
+ u2,x
2
My
{
zz âx ==
Pj@xD Cos@W t + tjD, 8j, 2<E;
EOM = Transpose@8eq1, eq2<D . 9u_s_,m__ :> ¶m us@x, tD, vs_ :> vs@x, tD=  Flatten
:-v1@x, tD + u1
H0,1L@x, tD == 0, 2 m1 v1@x, tD + v1
H0,1L@x, tD - u1
H2,0L@x, tD -
a i
k
jjà
0
1
 i
k
jjb y¢@xD u1
H1,0L@x, tD + 1
2
Ju1
H1,0L@x, tD
2
+ u2
H1,0L@x, tD
2
Ny
{
zz â xy
{
zz Ib y†@xD + u1
H2,0L@x, tDM ==
Cos@t W + t1D P1@xD, -v2@x, tD + u2
H0,1L@x, tD == 0, 2 m2 v2@x, tD + v2
H0,1L@x, tD - u2
H2,0L@x, tD-
a i
k
jjà
0
1
 i
k
jjb y¢@xD u1
H1,0L@x, tD + 1
2
Ju1
H1,0L@x, tD
2
+ u2
H1,0L@x, tD
2
Ny
{
zz â xy
{
zz u2
H2,0L@x, tD ==
Cos@t W + t2D P2@xD>
yRule = 8y -> H4 # H1 - #L &L<;
Moreover, we write the associated boundary conditions as
BC = 8uj@0, tD == 0, uj@1, tD == 0<;
Here, the index j = 1 refers to the vertical component of the displacement and j = 2 refers to the horizontal component of the
displacement; the m j are the viscous damping coefficients; the P j@xD are the distributed amplitudes of the excitation with the
frequency W;  di, j denotes  the Kronecker delta; and b y@xD, where y@xD = 4x H1 - xL, defined in the yRule, is  the initial static
configuration. The spatial and temporal variables were nondimensionalized using the span of the cable { and the characteris -
tic time {  !!!!!!!!
•E , where • and E are the cable density and modulous of elasticity, respectively.
We seek an asymptotic  expansion of the response of the cable when  its span  is  such that  the first vertical and horizontal
natural frequencies are in the ratio of two-to-one; that is, b2 a » p2  16. When b2 a = p2  16, the natural frequencies are
params = 9wj_;j!=3 :> 2 p, w3 -> p, b2 a -> p2  16=;
and the corresponding normalized modeshapes are
Chapter9.nb
311

modeshapes = 9F1 ->
i
k
jjjjj$ % %%%%
2
3
 H1 - Cos@2 p #DL &
y
{
zzzzz,
F2 -> I !!!2 Sin@2 p #D &M, F3 -> I !!!2 Sin@p #D &M, F4 -> I !!!2 Sin@2 p #D &M=;
We use the method of multiple scales and seek a second-order uniform asymptotic  expansion of the response of the cable to
a primary-resonance excitation of the first vertical mode in the form
multiScales = 9u_j_@x, tD -> uj@x, T0, T1, T2D,
Derivative@m_, n_D@u_D@x, tD -> dt@nD@D@u@x, T0, T1, T2D, 8x, m<DD, t -> T0=;
solRule = 9ui_ -> IEvaluateASumAej ui,j@#1, #2, #3, #4D, 8j, 3<EE &M,
vi_ -> IEvaluateASumAej vi,j@#1, #2, #3, #4D, 8j, 3<EE &M=;
Taking into account the resonance conditions, we scale the damping and forcing terms as
scaling = 9mj_ -> e2 mj, Pj_@xD -> e3 Pj@xD=;
where the forcing has  been scaled at order e3 so that its influence first appears  at the same order as  the nonlinear shift  in the
frequencies in the absence of the internal resonance.
We consider the case in which the orders  of magnitude of the forcing levels  for both the vertical and horizontal motions are
the same. Otherwise, a primary resonance of the vertical modes  (current study) could  also initiate a subharmonic  resonance
of order one-half   of the first horizontal mode  and a primary resonance of the second horizontal mode at different levels  of
approximation.
Substituting the multiScales, solRule, and scaling into EOM, expanding the result for small e, and discarding terms  of order
higher than e3, we obtain
eq92a =
HHEOM . Integrate -> int . multiScales . solRule . scaling  ExpandAllL . intRule2 
ExpandAllL . en_;n>3 -> 0;
Equating coefficients of like powers of e in eq92a, we obtain
eqEps =
Rest@Thread@CoefficientList@Subtract  #, eD == 0DD &  eq92a  Transpose  TrigToExp;
 9.2.1 First-Order Solution
The homogeneous parts of the first-order equations are
HlinearSys = #@@1DD &  eqEps@@1DDL . displayRule
8D0u1,1 - v1,1, -Hu1,1
'' L + D0v1,1 - b2 a int@Hu1,1
'
L y¢@xD, 8x, 0, 1<D y†@xD,
D0u2,1 - v2,1, -Hu2,1
'' L + D0v2,1<
312
Chapter9.nb

The  first-order problems  are  identical to  the  linear eigenvalue  problems.  To  account  for the  interactions  arising  from the
multiple internal resonances  and the primary resonance, we include the lowest two modes in each plane;  the other modes will
decay due to damping. Hence, the solution of eqEps[[1]] can be expressed as
sol1u = 9u1,1 -> FunctionA8x, T0, T1, T2<,
SumAAi@T1, T2D Fi@xD Exp@I wi T0D + A
i@T1, T2D Fi@xD Exp@-I wi T0D, 8i, 1, 2<E  EvaluateE,
u2,1 -> FunctionA8x, T0, T1, T2<,
SumAAi@T1, T2D Fi@xD Exp@I wi T0D + A
i@T1, T2D Fi@xD Exp@-I wi T0D, 8i, 3, 4<E  EvaluateE=;
sol1v = Table@
vk,1 ﬁFunction@8x, T0, T1, T2<, D@uk,1@x, T0, T1, T2D, T0D . sol1u  EvaluateD, 8k, 2<D;
sol1 = Join@sol1u, sol1vD
8u1,1 ﬁFunction@8x, T0, T1, T2<, EIT0 w1 A1@T1, T2D F1@xD +
EI T0 w2 A2@T1, T2D F2@xD + E-I T0 w1 F1@xD A
1@T1, T2D + E-I T0 w2 F2@xD A
2@T1, T2DD,
u2,1 ﬁFunction@8x, T0, T1, T2<, EIT0 w3 A3@T1, T2D F3@xD + EI T0 w4 A4@T1, T2D F4@xD +
E-I T0 w3 F3@xD A
3@T1, T2D + E-I T0 w4 F4@xD A
4@T1, T2DD,
v1,1 ﬁFunction@8x, T0, T1, T2<, I EI T0 w1 w1 A1@T1, T2D F1@xD + I EI T0 w2 w2 A2@T1, T2D F2@xD -
I E-I T0 w1 w1 F1@xD A
1@T1, T2D - I E-I T0 w2 w2 F2@xD A
2@T1, T2DD,
v2,1 ﬁFunction@8x, T0, T1, T2<, I EI T0 w3 w3 A3@T1, T2D F3@xD + I EI T0 w4 w4 A4@T1, T2D F4@xD -
I E-I T0 w3 w3 F3@xD A
3@T1, T2D - I E-I T0 w4 w4 F4@xD A
4@T1, T2DD<
where F1@xD and F2@xD are the lowest symmetric and antisymmetric  vertical eigenmodes, and F3@xD and  F4@xD are  the lowest
symmetric and antisymmetric horizontal eigenmodes. The Fn @xD are orthogonal;  they are normalized so that they satisfy  the
orthonormality condition Ù0
1Fn @xDFm@xDâ x = dn,m.
Because the problem is self-adjoint, we have
adjoint = Table@8-I wk Fk@xD, Fk@xD<, 8k, 4<D;
whose complex conjugate is
adjointC = adjoint . conjugateRule
88I w1 F1@xD, F1@xD<, 8I w2 F2@xD, F2@xD<, 8I w3 F3@xD, F3@xD<, 8I w4 F4@xD, F4@xD<<
 9.2.2 Second-Order Solution
Substituting sol1 into eqEps[[2]] yields
Chapter9.nb
313

order2Eq = IlinearSys . u_k_,1 -> uk,2M ==
IIlinearSys . u_k_,1 -> uk,2M - H#@@1DD &  eqEps@@2DDL . sol1 . intRule1 . intRule2 .
modeshapes . yRule . int -> Integrate  ExpandM  Thread;
order2Eq . displayRule
:D0u1,2 - v1,2 == -$ %%% %
2
3
EI T0 w1 HD1A1L + $% %%%%
2
3
EI T0 w1 Cos@2 p xD HD1A1L - $ %%% %
2
3
E-IT0 w1 HD1A
1L +
$ %% %%
2
3
E-I T0 w1 Cos@2 p xD HD1A
1L -  ! !!2 EI T0 w2 HD1A2L Sin@2 p xD -  !!!2 E-I T0 w2 HD1A
2L Sin@2 p xD,
-Hu1,2
'' L + D0v1,2 - b2 a int@Hu1,2
' L y¢@xD, 8x, 0, 1<D y†@xD ==
- 16

3
b E2 I T0 w1 p2 a A1
2 + 64

3
b E2 I T0 w1 p2 a Cos@2 p xD A1
2 - 64 b EI T0 Hw1+w2L p2 a Sin@2 p xD A1 A2



 ! !!3
-
16 b E2 I T0 w2 p2 a A2
2 - 4 b E2 IT0 w3 p2 a A3
2 - 16 b E2 I T0 w4 p2 a A4
2 - I $ %% %%
2
3
EI T0 w1 HD1A1L w1 +
I $ %% %%
2
3
EI T0 w1 Cos@2 p xD HD1A1L w1 + I $ %%% %
2
3
E-I T0 w1 HD1A
1L w1 - I $ %%% %
2
3
E-IT0 w1 Cos@2 p xD HD1A
1L w1 -
I  !!!2 EIT0 w2 HD1A2L Sin@2 p xD w2 + I  !!!2 E-I T0 w2 HD1A
2L Sin@2 p xD w2 - 32

3
b p2 a A1 A
1 +
128

3
b p2 a Cos@2 p xD A1 A
1 - 64 b EI T0 H-w1+w2L p2 a Sin@2 p xD A2 A
1



 ! !!3
- 16

3
b E-2 I T0 w1 p2 a A
1
2 +
64

3
b E-2 I T0 w1 p2 a Cos@2 p xD A
1
2 - 64 b EI T0 Hw1-w2L p2 a Sin@2 p xD A1 A
2



 !!!3
-
32 b p2 a A2 A
2 - 64 b EI T0 H-w1-w2L p2 a Sin@2 p xD A
1 A
2



 !!!3
- 16 b E-2 I T0 w2 p2 a A
2
2 -
8 b p2 a A3 A
3 - 4 b E-2 I T0 w3 p2 a A
3
2 - 32 b p2 a A4 A
4 - 16 b E-2 I T0 w4 p2 a A
4
2,
D0u2,2 - v2,2 == - !!!2 EI T0 w3 HD1A3L Sin@p xD -  !!!2 E-I T0 w3 HD1A
3L Sin@p xD -
 !!!2 EI T0 w4 HD1A4L Sin@2 p xD -  ! !!2 E-I T0 w4 HD1A
4L Sin@2 p xD,
-Hu2,2
'' L + D0v2,2 == - 16 b EI T0 Hw1+w3L p2 a Sin@p xD A1 A3



 !!!3
- 64 b EI T0 Hw1+w4L p2 a Sin@2 p xD A1 A4



 !!!3
-
I  !!!2 EIT0 w3 HD1A3L Sin@p xD w3 + I  !!!2 E-I T0 w3 HD1A
3L Sin@p xD w3 -
I  !!!2 EIT0 w4 HD1A4L Sin@2 p xD w4 + I  !!!2 E-I T0 w4 HD1A
4L Sin@2 p xD w4 -
16 b EIT0 H-w1+w3L p2 a Sin@p xD A3 A
1



 !!!3
- 64 b EI T0 H-w1+w4L p2 a Sin@2 p xD A4 A
1



 !!!3
-
16 b EIT0 Hw1-w3L p2 a Sin@p xD A1 A
3



 ! !!3
- 16 b EI T0 H-w1-w3L p2 a Sin@p xD A
1 A
3



 ! !!3
-
64 b EIT0 Hw1-w4L p2 a Sin@2 p xD A1 A
4



 ! !!3
- 64 b EI T0 H-w1-w4L p2 a Sin@2 p xD A
1 A
4



 !!!3
>
We  consider the  case of  primary  resonance  of the  first vertical mode,  a  two-to-one  internal resonance between  the  first
vertical and horizontal modes, a one-to-one internal resonance between the first and second vertical modes, and a one-to-one
314
Chapter9.nb

internal resonance  between the  first vertical and  second  horizontal modes. In  order to  collect  the terms  that  may lead  to
secular terms from the right-hand sides of order2Eq, we define the rules
omgList = Table@wi, 8i, 4<D;
ResonanceConds = 8W == w1 + e s1, w2 == w1 + e s2, 2 w3 == w1 + e s3, w4 == w1 + e s4<;
OmgRule = Solve@ResonanceConds, Complement@omgList, 8#<D ~Join~ 8W<D@@1DD &  omgList
99w2 ﬁe s2 + w1, w3 ﬁ1
2
He s3 + w1L, w4 ﬁe s4 + w1, W ﬁe s1 + w1=,
9w1 ﬁ-e s2 + w2, w3 ﬁ1
2
H-e s2 + e s3 + w2L, w4 ﬁ-e s2 + e s4 + w2, W ﬁe s1 - e s2 + w2=,
8w1 ﬁ-e s3 + 2 w3, w2 ﬁe s2 - e s3 + 2 w3, w4 ﬁ-e s3 + e s4 + 2 w3, W ﬁe s1 - e s3 + 2 w3<,
9w1 ﬁ-e s4 + w4, w2 ﬁe s2 - e s4 + w4, w3 ﬁ1
2
He s3 - e s4 + w4L, W ﬁe s1 - e s4 + w4==
expRule1@i_D := Exp@arg_D :> Exp@Expand@arg . OmgRule@@iDDD . e T0 -> T1D
Collecting  the  terms  that  may lead  to  secular terms, the  terms  proportional to  EI wi T0, from the  equations  governing  the
vertical modes, we have
ST1v = CoefficientA#@@2DD &  order2Eq@@81, 2<DD . expRule1@#D, EI w# T0 E &  81, 2<;
ST1v . displayRule
::-$ %%% %
2
3
HD1A1L + $ %% %%
2
3
Cos@2 p xD HD1A1L -  !!!2 EIT1 s2 HD1A2L Sin@2 p xD, -4 b EI T1 s3 p2 a A3
2 -
I $ %% %%
2
3
HD1A1L w1 + I $ %%% %
2
3
Cos@2 p xD HD1A1L w1 - I  !!!2 EI T1 s2 HD1A2L Sin@2 p xD w2>,
:-$ %%% %
2
3
E-I T1 s2 HD1A1L + $% %%%%
2
3
E-I T1 s2 Cos@2 p xD HD1A1L -  !!!2 HD1A2L Sin@2 p xD,
-4 b E-I T1 s2+I T1 s3 p2 a A3
2 - I $ % %%%%
2
3
E-I T1 s2 HD1A1L w1 +
I $ %% %%
2
3
E-I T1 s2 Cos@2 p xD HD1A1L w1 - I  !!!2 HD1A2L Sin@2 p xD w2>>
Collecting the terms that may lead to secular terms from the equations governing the horizontal modes, we have
ST1h = CoefficientA#@@2DD &  order2Eq@@83, 4<DD . expRule1@#D, EI w# T0 E &  83, 4<;
ST1h . displayRule
::- !!!2 HD1A3L Sin@p xD, -I  !!!2 HD1A3L Sin@p xD w3 - 16 b E-IT1 s3 p2 a Sin@p xD A1 A
3


 !!!3
>,
9- !!!2 HD1A4L Sin@2 p xD, -I  !!!2 HD1A4L Sin@2 p xD w4=>
Demanding that ST1v[[i]] be orthogonal to the adjointC[[i]], we obtain the solvability conditions
Chapter9.nb
315

SCond1v =
SolveAHint@adjointC@@#DD.ST1v@@#DD, 8x, 0, 1<D . intRule1 . intRule2 . modeshapes .
params . int -> IntegrateL == 0, A#
H1,0L@T1, T2DE@@1DD &  81, 2<  Flatten;
SCond1v . displayRule
:D1A1 ﬁI $ %% %%
2
3
b EI T1 s3 p a A3
2, D1A2 ﬁ0>
Demanding that ST1h[[i]] be orthogonal to the adjointC[[i+2]], we obtain the solvability conditions
SCond1h =
SolveAHint@adjointC@@# + 2DD.ST1h@@#DD, 8x, 0, 1<D . intRule1 . intRule2 . modeshapes .
params . int -> IntegrateL == 0, A#+2
H1,0L@T1, T2DE@@1DD &  81, 2<  Flatten;
SCond1h . displayRule
:D1A3 ﬁ4 I $ %% %%
2
3
b E-I T1 s3 p a A1 A
3, D1A4 ﬁ0>
SCond1 = Join@SCond1v, SCond1hD;
whose complex conjugates are
ccSCond1 = SCond1 . conjugateRule;
Next, we use the solvability conditions to eliminate the D1 Ai from the right-hand sides  of order2Eq. To this  end, we define
the rules
sigRule = Solve@ResonanceConds, Table@si, 8i, 4<DD@@1DD
9s1 ﬁ- -W + w1

e
, s2 ﬁ- w1 - w2

e
, s3 ﬁ- w1 - 2 w3

e
, s4 ﬁ- w1 - w4

e
=
expRule2 = Exp@a_D :> Exp@a . sigRule . T1 -> e T0  ExpandD;
Substituting SCond1, ccSCond1, and expRule2 into order2Eq, we obtain
order2Eqm = order2Eq . SCond1 . ccSCond1 . expRule2;
To  determine  the  solution  of  order2Eqm and  the  associated  boundary  conditions,  we  use  the  method  of undetermined
coefficients. To accomplish this, we first determine the forms of the terms  on the right-hand sides of order2Eqm by picking
up the x dependent or x and T0 dependent terms by defining the rule
baits = 9_ Ea_ T0+b_. f_@c_ xD :> Ea T0+b f@c xD, a_ f_@b_ xD :> f@b xD ; FreeQ@a, T0D=;
Then, we collect the solution forms for the horizontal modes according to
316
Chapter9.nb

sol2Formh = Table@Cases@order2Eqm@@k, 2DD, #D &  baits, 8k, 3, 4<D  Flatten  Union
8E-I T0 w1-I T0 w3 Sin@p xD, EI T0 w1-I T0 w3 Sin@p xD, E-I T0 w1+I T0 w3 Sin@p xD, EIT0 w1+I T0 w3 Sin@p xD,
E-I T0 w1-I T0 w4 Sin@2 p xD, EI T0 w1-I T0 w4 Sin@2 p xD, E-I T0 w1+I T0 w4 Sin@2 p xD, EI T0 w1+I T0 w4 Sin@2p xD<
Each of these terms satisfies the boundary conditions. However, not all of the solution forms
sol2Formv = Table@Cases@order2Eqm@@k, 2DD, #D &  baits, 8k, 2<D  Flatten  Union
8Cos@2 p xD, E-2 I T0 w1 Cos@2 p xD, E2 I T0 w1 Cos@2 p xD, E-2 I T0 w3 Cos@2 p xD, E2 I T0 w3 Cos@2 p xD,
E-I T0 w1-I T0 w2 Sin@2 p xD, EI T0 w1-I T0 w2 Sin@2 p xD, E-I T0 w1+I T0 w2 Sin@2 p xD, EI T0 w1+I T0 w2 Sin@2p xD<
for the vertical modes satisfy  the boundary conditions. Besides, there exist terms that are not functions of x on the right-hand
sides of order2Eqm[[{1,2}]], namely
#@@2DD &  order2Eqm@@81, 2<DD . Thread@sol2Formv -> 0D . displayRule
9- 2
3
I b E2 I T0 w3 p a A3
2 + 2
3
I b E-2 I T0 w3 p a A
3
2,
- 16

3
b E2 I T0 w1 p2 a A1
2 - 16 b E2 IT0 w2 p2 a A2
2 - 4 b E2 I T0 w3 p2 a A3
2 - 16 b E2 I T0 w4 p2 a A4
2 +
2
3
b E2 I T0 w3 p a A3
2 w1 - 32

3
b p2 a A1 A
1 - 16

3
b E-2 I T0 w1 p2 a A
1
2 - 32 b p2 a A2 A
2 - 16 b E-2I T0 w2 p2 a A
2
2 -
8 b p2 a A3 A
3 - 4 b E-2 I T0 w3 p2 a A
3
2 + 2
3
b E-2 IT0 w3 p a w1 A
3
2 - 32 b p2 a A4 A
4 - 16 b E-2 I T0 w4 p2 a A
4
2=
Hence, we need to either consider some algebraic forms  or combined algebraic and sinusoidal forms  for x to manually adjust
the forms  in sol2Formv or use a more general approach  to let Mathematica  pick up the right  forms. The latter approach is
used here.
 Vertical Modes
Instead of looking for the x dependent forms, we seek all of the T0 dependent forms as
sol2Formv1 =
Join@81<, Table@Cases@order2Eqm@@k, 2DD, Exp@_D, ¥D, 8k, 2<D  Flatten  UnionD
81, E-2 I T0 w1 , E2 I T0 w1, E-2 I T0 w2 , E2 I T0 w2, E-I T0 w1-I T0 w2 ,
EI T0 w1-I T0 w2 , E-IT0 w1+I T0 w2, EI T0 w1+I T0 w2, E-2 I T0 w3, E2 I T0 w3, E-2I T0 w4, E2 I T0 w4 <
where the first argument in sol2Formv1 is included to account for the T0 independent terms.
We define the undetermined coefficients for u1, 2 and v1, 2 as
uSymbolv = Table@y1,i@xD, 8i, Length@sol2Formv1D<D;
vSymbolv = uSymbolv . y -> h;
and write the general solution in the form
Chapter9.nb
317

sol2v = 8u1,2 -> Function@8x, T0, T1, T2<, uSymbolv.sol2Formv1  EvaluateD,
v1,2 -> Function@8x, T0, T1, T2<, vSymbolv.sol2Formv1  EvaluateD<;
Substituting sol2v into order2Eqm[[1]] and equating the coefficients of the sol2Formv1 on both sides yields
expr1 = Subtract  order2Eqm@@1DD . sol2v;
eqv1 = Join@8expr1 == 0 . Exp@_D -> 0<, Coefficient@expr1, Rest@sol2Formv1DD == 0  ThreadD
9-h1,1@xD == 0, -h1,2@xD - 2 I w1 y1,2@xD == 0, -h1,3@xD + 2 I w1 y1,3@xD == 0,
-h1,4@xD - 2 I w2 y1,4@xD == 0, -h1,5@xD + 2 I w2 y1,5@xD == 0,
-h1,6@xD - I w1 y1,6@xD - I w2 y1,6@xD == 0, -h1,7@xD + I w1 y1,7@xD - I w2 y1,7@xD == 0,
-h1,8@xD - I w1 y1,8@xD + I w2 y1,8@xD == 0, -h1,9@xD + I w1 y1,9@xD + I w2 y1,9@xD == 0,
- 2
3
I b p a A
3@T1, T2D
2 + 2
3
I b p a Cos@2 p xD A
3@T1, T2D
2 - h1,10@xD - 2 I w3 y1,10@xD == 0,
2
3
I b p a A3@T1, T2D2 - 2
3
I b p a Cos@2 p xD A3@T1, T2D2 - h1,11@xD + 2 I w3 y1,11@xD == 0,
-h1,12@xD - 2 I w4 y1,12@xD == 0, -h1,13@xD + 2 I w4 y1,13@xD == 0=
Solving for vSymbolv from eqv1, we obtain
eta1Sol = Solve@eqv1, vSymbolvD@@1DD
9h1,1@xD ﬁ0, h1,2@xD ﬁ-2 I w1 y1,2@xD, h1,3@xD ﬁ2 I w1 y1,3@xD, h1,4@xD ﬁ-2 I w2 y1,4@xD,
h1,5@xD ﬁ2 I w2 y1,5@xD, h1,6@xD ﬁ-I Hw1 y1,6@xD + w2 y1,6@xDL, h1,7@xD ﬁI Hw1 y1,7@xD - w2 y1,7@xDL,
h1,8@xD ﬁ-I Hw1 y1,8@xD - w2 y1,8@xDL, h1,9@xD ﬁI Hw1 y1,9@xD + w2 y1,9@xDL,
h1,10@xD ﬁ2
3
I J-b p a A
3@T1, T2D
2 + b p a Cos@2 p xD A
3@T1, T2D
2 - 3 w3 y1,10@xDN,
h1,11@xD ﬁ- 2
3
I H-b p a A3@T1, T2D2 + b p a Cos@2 p xD A3@T1, T2D2 - 3 w3 y1,11@xDL,
h1,12@xD ﬁ-2 I w4 y1,12@xD, h1,13@xD ﬁ2 I w4 y1,13@xD=
Substituting sol2v and eta1Sol into order2Eqm[[2]] and equating the coefficients of the sol2Formv1 on both sides yields
expr2 = Subtract  order2Eqm@@2DD . sol2v . eta1Sol . intRule1 . intRule2 .
int@y¢@xD y1,k_¢@xD, _D -> bk . yRule;
318
Chapter9.nb

eqv2 = Join@8expr2 == 0 . Exp@_D -> 0<,
Coefficient@expr2, Rest@sol2Formv1DD == 0  ThreadD . params
: p2 b1

2
+ 32

3
b p2 a A1@T1, T2D A
1@T1, T2D -
128

3
b p2 a Cos@2 p xD A1@T1, T2D A
1@T1, T2D + 32 b p2 a A2@T1, T2D A
2@T1, T2D +
8 b p2 a A3@T1, T2D A
3@T1, T2D + 32 b p2 a A4@T1, T2D A
4@T1, T2D - y1,1
†
@xD == 0,
p2 b2

2
+ 16

3
b p2 a A
1@T1, T2D2 - 64

3
b p2 a Cos@2 p xD A
1@T1, T2D2 - 16 p2 y1,2@xD - y1,2
†
@xD == 0,
p2 b3

2
+ 16

3
b p2 a A1@T1, T2D2 - 64

3
b p2 a Cos@2 p xD A1@T1, T2D2 - 16 p2 y1,3@xD - y1,3
†
@xD == 0,
p2 b4

2
+ 16 b p2 a A
2@T1, T2D
2 - 16 p2 y1,4@xD - y1,4
†
@xD == 0,
p2 b5

2
+ 16 b p2 a A2@T1, T2D2 - 16 p2 y1,5@xD - y1,5
†
@xD == 0,
p2 b6

2
+ 64 b p2 a Sin@2 p xD A
1@T1, T2D A
2@T1, T2D



 !!!3
- 16 p2 y1,6@xD - y1,6
†
@xD == 0,
p2 b7

2
+ 64 b p2 a Sin@2 p xD A1@T1, T2D A
2@T1, T2D



 !!!3
- y1,7
†
@xD == 0,
p2 b8

2
+ 64 b p2 a Sin@2 p xD A2@T1, T2D A
1@T1, T2D



 !!!3
- y1,8
†
@xD == 0,
p2 b9

2
+ 64 b p2 a Sin@2 p xD A1@T1, T2D A2@T1, T2D



 !!!3
- 16 p2 y1,9@xD - y1,9
†
@xD == 0,
p2 b10

2
+ 4
3
b p2 a A
3@T1, T2D
2 + 8
3
b p2 a Cos@2 p xD A
3@T1, T2D
2 - 4 p2 y1,10@xD - y1,10
†
@xD == 0,
p2 b11

2
+ 4
3
b p2 a A3@T1, T2D2 + 8
3
b p2 a Cos@2 p xD A3@T1, T2D2 - 4 p2 y1,11@xD - y1,11
†
@xD == 0,
p2 b12

2
+ 16 b p2 a A
4@T1, T2D
2 - 16 p2 y1,12@xD - y1,12
†
@xD == 0,
p2 b13

2
+ 16 b p2 a A4@T1, T2D2 - 16 p2 y1,13@xD - y1,13
†
@xD == 0>
Next, we determine the  solutions of the boundary-value problems: eqv2 and  the associated  boundary  conditions. First, we
obtain the information about the solution forms uSymbolv according to
Chapter9.nb
319

yForm = DSolve@8#@@1DD, #@@2DD == 0 . x -> 0, #@@2DD == 0 . x -> 1<, #@@2DD, xD@@1DD .
C@i_D -> 0 &  Transpose@8eqv2, uSymbolv<D  Flatten  ExpandAll;
yForm . displayRule
:y1,1@xD ﬁ- 1
4
p2 x b1 + 1
4
p2 x2 b1 - 32

3
b a A1 A
1 - 16

3
b p2 x a A1 A
1 +
16

3
b p2 x2 a A1 A
1 + 32

3
b a Cos@2 p xD A1 A
1 - 16 b p2 x a A2 A
2 + 16 b p2 x2 a A2 A
2 -
4 b p2 x a A3 A
3 + 4 b p2 x2 a A3 A
3 - 16 b p2 x a A4 A
4 + 16 b p2 x2 a A4 A
4,
y1,2@xD ﬁb2

32
-
1

32
Cos@4 p xD b2 + 1
3
b a A
1
2 - 16

9
b a Cos@2 p xD A
1
2 + 13

9
b a Cos@4 p xD A
1
2,
y1,3@xD ﬁ1
3
b a A1
2 - 16

9
b a Cos@2 p xD A1
2 + 13

9
b a Cos@4 p xD A1
2 + b3

32
-
1

32
Cos@4 p xD b3,
y1,4@xD ﬁb4

32
-
1

32
Cos@4 p xD b4 + b a A
2
2 - b a Cos@4 p xD A
2
2,
y1,5@xD ﬁb a A2
2 - b a Cos@4 p xD A2
2 + b5

32
-
1

32
Cos@4 p xD b5,
y1,6@xD ﬁb6

32
-
1

32
Cos@4 p xD b6 + 16 b a Sin@2 p xD A
1 A
2


3  !!!3
,
y1,7@xD ﬁ- 1
4
p2 x b7 + 1
4
p2 x2 b7 - 16 b a Sin@2 p xD A1 A
2


 !!!3
,
y1,8@xD ﬁ- 1
4
p2 x b8 + 1
4
p2 x2 b8 - 16 b a Sin@2 p xD A2 A
1


 !!!3
,
y1,9@xD ﬁ16 b a Sin@2 p xD A1 A2


3  !!!3
+ b9

32
- 1

32
Cos@4 p xD b9,
y1,10@xD ﬁb10

8
- 1
8
Cos@2 p xD b10 + 1
3
b a A
3
2 - 1
3
b a Cos@2 p xD A
3
2 + 2
3
b p x a Sin@2 p xD A
3
2,
y1,11@xD ﬁ1
3
b a A3
2 - 1
3
b a Cos@2 p xD A3
2 + 2
3
b p x a Sin@2 p xD A3
2 + b11

8
- 1
8
Cos@2 p xD b11,
y1,12@xD ﬁb12

32
-
1

32
Cos@4 p xD b12 + b a A
4
2 - b a Cos@4 p xD A
4
2,
y1,13@xD ﬁb a A4
2 - b a Cos@4 p xD A4
2 + b13

32
-
1

32
Cos@4 p xD b13>
Then, according to yForm, we pick up the spatial function forms for uSymbolv as
bait1 =
8a_. xn_. :> xn ; FreeQ@a, xD, a_ f_@b_ xD :> f@b xD ; FreeQ@a, xD, a_ x f_@b_ xD :> x f@b xD<;
funcList = Table@
Prepend@Cases@yForm@@i, 2DD, #D &  bait1  Flatten  Union, 1D, 8i, Length@yFormD<D
881, x, x2, Cos@2 p xD<, 81, Cos@2 p xD, Cos@4 p xD<, 81, Cos@2 p xD, Cos@4 p xD<,
81, Cos@4 p xD<, 81, Cos@4 p xD<, 81, Cos@4 p xD, Sin@2 p xD<, 81, x, x2, Sin@2 p xD<,
81, x, x2, Sin@2 p xD<, 81, Cos@4 p xD, Sin@2 p xD<, 81, Cos@2 p xD, x Sin@2 p xD<,
81, Cos@2 p xD, x Sin@2 p xD<, 81, Cos@4 p xD<, 81, Cos@4 p xD<<
320
Chapter9.nb

We  assume  the  solution for y1, i  as  a linear combination of funcList[[i]], substitute  it into  yForm[[i]],  equate both  sides,
solve for the undetermined coefficients, and obtain the solution for y1, i as
psi1Sol = Table@
form = funcList@@kDD;
cList = Table@ci, 8i, Length@formD<D;
sol = cList.form; algExpr =
sol - yForm@@k, 2DD . bk_ -> Integrate@Expand@y¢@xD D@sol, xD . yRuleD, 8x, 0, 1<D;
algEq = Append@Coefficient@algExpr, Rest@formDD,
algExpr . Thread@Rest@formD -> 0DD == 0  Thread;
y1,k -> Function@x, sol . Solve@algEq, cListD@@1DD  Expand  EvaluateD,
8k, Length@yFormD<D
Solve::svars :  Equations may not give solutions for all "solve" variables.
Solve::svars :  Equations may not give solutions for all "solve" variables.
Chapter9.nb
321

:y1,1 ﬁFunctionBx, - 32

3
b a A1@T1, T2D A
1@T1, T2D + 48 b p2 x a A1@T1, T2D A
1@T1, T2D



3 + p2
-
48 b p2 x2 a A1@T1, T2D A
1@T1, T2D



3 + p2
+ 32

3
b a Cos@2 p xD A1@T1, T2D A
1@T1, T2D -
48 b p2 x a A2@T1, T2D A
2@T1, T2D



3 + p2
+ 48 b p2 x2 a A2@T1, T2D A
2@T1, T2D



3 + p2
-
12 b p2 x a A3@T1, T2D A
3@T1, T2D



3 + p2
+ 12 b p2 x2 a A3@T1, T2D A
3@T1, T2D



3 + p2
-
48 b p2 x a A4@T1, T2D A
4@T1, T2D



3 + p2
+ 48 b p2 x2 a A4@T1, T2D A
4@T1, T2D



3 + p2
F, y1,2 ﬁFunctionAx,
4
9
b a A
1@T1, T2D
2 - 16

9
b a Cos@2 p xD A
1@T1, T2D
2 + 4
3
b a Cos@4 p xD A
1@T1, T2D
2E, y1,3 ﬁ
FunctionAx, 4
9
b a A1@T1, T2D2 - 16

9
b a Cos@2 p xD A1@T1, T2D2 + 4
3
b a Cos@4 p xD A1@T1, T2D2E,
y1,4 ﬁFunctionAx, 4
3
b a A
2@T1, T2D
2 - 4
3
b a Cos@4 p xD A
2@T1, T2D
2E,
y1,5 ﬁFunctionAx, 4
3
b a A2@T1, T2D2 - 4
3
b a Cos@4 p xD A2@T1, T2D2E,
y1,6 ﬁFunctionBx, 16 b a Sin@2 p xD A
1@T1, T2D A
2@T1, T2D



3  !!!3
F,
y1,7 ﬁFunctionBx, - 16 b a Sin@2 p xD A1@T1, T2D A
2@T1, T2D



 !!!3
F,
y1,8 ﬁFunctionBx, - 16 b a Sin@2 p xD A2@T1, T2D A
1@T1, T2D



 !!!3
F,
y1,9 ﬁFunctionBx, 16 b a Sin@2 p xD A1@T1, T2D A2@T1, T2D



3  !!!3
F,
y1,10 ﬁFunctionAx, -c2 + Cos@2 p xD c2 + 2
3
b p x a Sin@2 p xD A
3@T1, T2D
2E,
y1,11 ﬁFunctionAx, -c2 + Cos@2 p xD c2 + 2
3
b p x a Sin@2 p xD A3@T1, T2D2E,
y1,12 ﬁFunctionAx, 4
3
b a A
4@T1, T2D
2 - 4
3
b a Cos@4 p xD A
4@T1, T2D
2E,
y1,13 ﬁFunctionAx, 4
3
b a A4@T1, T2D2 - 4
3
b a Cos@4 p xD A4@T1, T2D2E>
We note that all of the spatial dependent functions satisfy the boundary conditions.
The sol2Formv1 consists of two parts: a part is  related to the secular terms, which consists of terms  proportional to E–I w1 T0
and E–I w2 T0  and the other part consists of terms that are not related to the secular terms. The positions of the former are
pos@1D =
HPosition@# sol2Formv1 . expRule1@1D . Exp@_. + _ T0D -> 0, a_ ; a =!= 0, 1D  Flatten 
RestL &  9E-I w1 T0, EI w1 T0=
8811<, 810<<
322
Chapter9.nb

pos@2D =
HPosition@# sol2Formv1 . expRule1@2D . Exp@_. + _ T0D -> 0, a_ ; a =!= 0, 1D  Flatten 
RestL &  9E-I w2 T0, EI w2 T0=
8811<, 810<<
Since pos[1] and pos[2] are the same, we simply define
8pos1, pos1cc< = pos@1D  Flatten
811, 10<
Next, we  augment  y1,pos1  and  h1,pos1  by  a  linear  combination  of all possible  homogeneous  solutions. The  unknown
coefficients  can be determined by the orthogonality conditions. (y1, pos1cc and h1, pos1cc are simply the complex conjugates  of
y1, pos1 and h1, pos1, respectively.) First, we express their solution forms using psi1Sol and eta1Sol as
STFormv =
8y1,pos1@xD + Sum@c1,j Fj@xD, 8j, 2<D, h1,pos1@xD + Sum@c1,j I wj Fj@xD, 8j, 2<D< . eta1Sol .
psi1Sol . ci_ -> 0 . modeshapes . params  Expand
:$ %% %%
2
3
c1,1 - $ %%% %
2
3
Cos@2 p xD c1,1 +  !!!2 Sin@2 p xD c1,2 + 2
3
b p x a Sin@2 p xD A3@T1, T2D2,
2 I $ %% %%
2
3
p c1,1 - 2 I $ % %%%%
2
3
p Cos@2 p xD c1,1 + 2 I  ! !!2 p Sin@2 p xD c1,2 +
2
3
I b p a A3@T1, T2D2 - 2
3
I b p a Cos@2 p xD A3@T1, T2D2 + 4
3
I b p2 x a Sin@2 p xD A3@T1, T2D2>
Demanding that STFormv be orthogonal to the adjointC[[i]], we obtain the unknown coefficients
c1Rule =
Solve@int@adjointC@@#DD.STFormv, 8x, 0, 1<D == 0 . modeshapes . params . intRule1 .
intRule2 . int -> Integrate, c1,#D &  81, 2<  Flatten
:c1,1 ﬁ0, c1,2 ﬁ- b p a A3@T1, T2D2

3  !!!2
>
Then, we adjust psi1Sol with
psi1Sol@@pos1DD = y1,pos1 -> Function@x, STFormv@@1DD . c1Rule  EvaluateD
y1,11 ﬁFunctionAx, - 1
3
b p a Sin@2 p xD A3@T1, T2D2 + 2
3
b p x a Sin@2 p xD A3@T1, T2D2E
psi1Sol@@pos1ccDD =
y1,pos1cc -> Function@x, STFormv@@1DD . c1Rule . conjugateRule  EvaluateD
y1,10 ﬁFunctionAx, - 1
3
b p a Sin@2 p xD A
3@T1, T2D
2 + 2
3
b p x a Sin@2 p xD A
3@T1, T2D
2E
Chapter9.nb
323

 Horizontal Modes
The sol2Formh consists  of two parts: a part is  related to the secular terms, which consists  of terms proportional to E–I w3 T0
and E–I w4 T0  and the other part consists of terms that are not related to the secular terms. The positions of the former are
pos@3D =
HPosition@# sol2Formh . expRule1@3D . Exp@_. + _ T0D -> 0, a_ ; a =!= 0, 1D  Flatten 
RestL &  9E-I w3 T0, EI w3 T0=
882<, 83<<
pos@4D =
HPosition@# sol2Formh . expRule1@4D . Exp@_. + _ T0D -> 0, a_ ; a =!= 0, 1D  Flatten 
RestL &  9E-I w4 T0, EI w4 T0=
88<, 8<<
Hence, we  assume  that  the solution for u2, 2  and  v2, 2  consists  of two parts  corresponding to the  parts  in sol2Formh. The
part, which is not related to the secular terms, is
sol2Formha = Delete@sol2Formh, pos@3DD
8E-I T0 w1-I T0 w3 Sin@p xD, EI T0 w1+I T0 w3 Sin@p xD, E-I T0 w1-I T0 w4 Sin@2 p xD,
EI T0 w1-I T0 w4 Sin@2 p xD, E-I T0 w1+I T0 w4 Sin@2 p xD, EI T0 w1+I T0 w4 Sin@2 p xD<
We define the corresponding undetermined coefficients as
uSymbolha = Table@y2,i, 8i, Length@sol2FormhaD<D;
vSymbolha = uSymbolha . y -> h;
Hence, the general solution in terms of the sol2Formha can be written as
sol2ha = 8u2,2 -> Function@8x, T0, T1, T2<, uSymbolha.sol2Formha  EvaluateD,
v2,2 -> Function@8x, T0, T1, T2<, vSymbolha.sol2Formha  EvaluateD<;
The part of sol2Formh, which is related to the secular terms, is
sol2Formhb = sol2Formh@@pos@3D@@1DDDD
8EI T0 w1-I T0 w3 Sin@p xD<
and define the undetermined coefficients as
uSymbolhb = Table@ys2,i, 8i, Length@sol2FormhbD<D;
where the undetermined coefficients for v2, 2 are related to the uSymbolhb due to the orthogonality condition. Therefore, the
general solution in terms of the sol2Formhb can be written as
324
Chapter9.nb

sol2hb = 8u2,2 -> Function@8x, T0, T1, T2<, uSymbolhb.sol2Formhb  EvaluateD,
v2,2 -> Function@8x, T0, T1, T2<, -I w3 uSymbolhb.sol2Formhb  EvaluateD<;
The total solution is a combination of sol2ha, sol2hb, and the complex conjugate of sol2hb.
Substituting sol2ha into order2Eqm[[{3,4}]] and equating the coefficients of sol2Formha on both sides, we have
algEqa =
Flatten@Coefficient@Subtract  # . sol2ha, sol2FormhaD &  order2Eqm@@83, 4<DDD == 0 
Thread;
Solving for the uSymbolha and the vSymbolha yields
symbolaRule = Solve@algEqa, uSymbolha~Join ~vSymbolhaD@@1DD . params
:y2,1 ﬁ2 b a A
1@T1, T2D A
3@T1, T2D


 !!!3
, y2,2 ﬁ2 b a A1@T1, T2D A3@T1, T2D


 !!!3
,
y2,3 ﬁ16 b a A
1@T1, T2D A
4@T1, T2D


3  ! !!3
, y2,4 ﬁ- 16 b a A1@T1, T2D A
4@T1, T2D


 !!!3
,
y2,5 ﬁ- 16 b a A4@T1, T2D A
1@T1, T2D


 !!!3
, y2,6 ﬁ16 b a A1@T1, T2D A4@T1, T2D


3  !!!3
,
h2,1 ﬁ-2 I  !!!3 b p a A
1@T1, T2D A
3@T1, T2D, h2,2 ﬁ2 I  ! !!3 b p a A1@T1, T2D A3@T1, T2D,
h2,3 ﬁ- 64 I b p a A
1@T1, T2D A
4@T1, T2D



3  !!!3
, h2,4 ﬁ0, h2,5 ﬁ0, h2,6 ﬁ64 I b p a A1@T1, T2D A4@T1, T2D



3  ! !!3
>
Substituting sol2hb into either of order2Eqm[[{3,4}]], equating the coefficients of sol2Formhb on both sides, and solving for
the uSymbolhb, we have
symbolbRule =
Solve@Coefficient@Subtract  order2Eqm@@3DD . sol2hb, sol2FormhbD == 0  Thread,
uSymbolhbD@@1DD . params
:ys2,1 ﬁ- 4 b a A1@T1, T2D A
3@T1, T2D


 !!!3
>
Substituting symbolaRule and symbolbRule into sol2ha and sol2hb yields
sol2haForm = 8u2,2@x, T0, T1, T2D, v2,2@x, T0, T1, T2D< . sol2ha . symbolaRule;
sol2hbForm = 8u2,2@x, T0, T1, T2D, v2,2@x, T0, T1, T2D< . sol2hb . symbolbRule;
Chapter9.nb
325

sol2h = 8u2,2 ﬁFunction@8x, T0, T1, T2<,
sol2haForm@@1DD + sol2hbForm@@1DD + Hsol2hbForm@@1DD . conjugateRuleL  Expand 
EvaluateD, v2,2 ﬁFunction@8x, T0, T1, T2<, sol2haForm@@2DD +
sol2hbForm@@2DD + Hsol2hbForm@@2DD . conjugateRuleL  Expand  EvaluateD<
:u2,2 ﬁFunctionB8x, T0, T1, T2<, 2 b EI T0 w1+I T0 w3 a Sin@p xD A1@T1, T2D A3@T1, T2D




 ! !!3
+
16 b EIT0 w1+I T0 w4 a Sin@2 p xD A1@T1, T2D A4@T1, T2D




3  ! !!3
-
4 b E-I T0 w1+I T0 w3 a Sin@p xD A3@T1, T2D A
1@T1, T2D




 !!!3
-
16 b E-I T0 w1+I T0 w4 a Sin@2 p xD A4@T1, T2D A
1@T1, T2D




 !!!3
-
4 b EIT0 w1-I T0 w3 a Sin@p xD A1@T1, T2D A
3@T1, T2D




 !!!3
+
2 b E-I T0 w1-I T0 w3 a Sin@p xD A
1@T1, T2D A
3@T1, T2D




 !!!3
-
16 b EIT0 w1-I T0 w4 a Sin@2 p xD A1@T1, T2D A
4@T1, T2D




! !!3
+
16 b E-I T0 w1-I T0 w4 a Sin@2 p xD A
1@T1, T2D A
4@T1, T2D




3  !!!3
F,
v2,2 ﬁFunctionB8x, T0, T1, T2<, 2 I  ! !!3 b EI T0 w1+I T0 w3 p a Sin@p xD A1@T1, T2D A3@T1, T2D +
64 I b EI T0 w1+I T0 w4 p a Sin@2 p xD A1@T1, T2D A4@T1, T2D




3  !!!3
-
4 I b E-I T0 w1+I T0 w3 a Sin@p xD w3 A3@T1, T2D A
1@T1, T2D




 !!!3
+
4 I b EI T0 w1-I T0 w3 a Sin@p xD w3 A1@T1, T2D A
3@T1, T2D




 !!!3
-
2 I  !!!3 b E-I T0 w1-I T0 w3 p a Sin@p xD A
1@T1, T2D A
3@T1, T2D -
64 I b E-I T0 w1-I T0 w4 p a Sin@2 p xD A
1@T1, T2D A
4@T1, T2D




3  ! !!3
F>
 9.2.3 Solvability Conditions
Substituting sol1, sol2v, and sol2h into eqEps[[3]] yields
326
Chapter9.nb

order3Eq =
IlinearSys . u_k_,1 -> uk,3M == IIlinearSys . u_k_,1 -> uk,3M - H#@@1DD &  eqEps@@3DDL .
sol1 . sol2v . eta1Sol . psi1Sol . sol2h . intRule1 . intRule2 .
modeshapes . yRule . int -> Integrate  ExpandM  Thread;  Timing
843.242 Second, Null<
Collecting  the  terms  that  may lead  to  secular terms, the  terms  proportional to  EI wi T0, from the  equations  governing  the
vertical modes, we have
ST2v = CoefficientA#@@2DD &  order3Eq@@81, 2<DD . expRule1@#D, EI w# T0 E &  81, 2<;
Collecting the terms that may lead to secular terms from the equations governing the horizontal modes, we have
ST2h = CoefficientA#@@2DD &  order3Eq@@83, 4<DD . expRule1@#D, EI w# T0 E &  83, 4<;
Demanding that ST2v[[i]] be orthogonal to the adjointC[[i]], we obtain the solvability conditions
Chapter9.nb
327

SCond2v =
SolveAHint@adjointC@@#DD.ST2v@@#DD, 8x, 0, 1<D . intRule1 . intRule2 . modeshapes .
params . int -> IntegrateL == 0,
A#
H0,1L@T1, T2DE@@1DD &  81, 2<  Flatten  ExpandAll;
SCond2v . displayRule
:D2A1 ﬁ-
I EIT1 s1+I t1 Ù0
1HP1@xD - Cos@2 p xD P1@xDL â x



4  !!!6 p
- A1 m1 + 2
3
I p3 a A1
2 A
1 -
224

3
I b2 p a2 A1
2 A
1 + 256 I b2 p a2 A1
2 A
1


3 + p2
+ 64 I b2 p3 a2 A1
2 A
1


9 + 3 p2
+ 2
3
I E2 I T1 s2 p3 a A2
2 A
1 -
352

9
I b2 E2 IT1 s2 p a2 A2
2 A
1 + 2
3
I E2 I T1 s4 p3 a A4
2 A
1 - 352

9
I b2 E2 I T1 s4 p a2 A4
2 A
1 +
4
3
I p3 a A1 A2 A
2 - 256

9
I b2 p a2 A1 A2 A
2 - 256 I b2 p a2 A1 A2 A
2


3 + p2
- 64 I b2 p3 a2 A1 A2 A
2


9 + 3 p2
+
1
3
I p3 a A1 A3 A
3 - 4
3
I b2 p a2 A1 A3 A
3 - 64 I b2 p a2 A1 A3 A
3


3 + p2
- 16 I b2 p3 a2 A1 A3 A
3


9 + 3 p2
+
4
3
I p3 a A1 A4 A
4 - 256

9
I b2 p a2 A1 A4 A
4 - 256 I b2 p a2 A1 A4 A
4


3 + p2
- 64 I b2 p3 a2 A1 A4 A
4


9 + 3 p2
,
D2A2 ﬁ-
I EIT1 s1-I T1 s2+I t1 Ù0
1Sin@2 p xD P1@xD â x



4  !!!2 p
- A2 m1 + 4
3
I p3 a A1 A2 A
1 -
1024

9
I b2 p a2 A1 A2 A
1 + 64 I b2 p3 a2 A1 A2 A
1


3 + p2
+ 2
3
I E-2 I T1 s2 p3 a A1
2 A
2 -
352

9
I b2 E-2I T1 s2 p a2 A1
2 A
2 + 6 I p3 a A2
2 A
2 + 32

3
I b2 p a2 A2
2 A
2 - 64 I b2 p3 a2 A22 A
2


3 + p2
+
2 I E-2 I T1 s2+2I T1 s4 p3 a A4
2 A
2 + 32

3
I b2 E-2 I T1 s2+2 I T1 s4 p a2 A4
2 A
2 +
I p3 a A2 A3 A
3 - 16 I b2 p3 a2 A2 A3 A
3


3 + p2
+ 4 I p3 a A2 A4 A
4 - 64 I b2 p3 a2 A2 A4 A
4


3 + p2
>
Demanding that ST2h[[i]] be orthogonal to the adjointC[[i+2]], we obtain the solvability conditions
328
Chapter9.nb

SCond2h =
SolveAHint@adjointC@@# + 2DD.ST2h@@#DD, 8x, 0, 1<D . intRule1 . intRule2 . modeshapes .
params . int -> IntegrateL == 0,
A#+2
H0,1L@T1, T2DE@@1DD &  81, 2<  Flatten  ExpandAll;
SCond2h . displayRule
:D2A3 ﬁ-A3 m2 + 2
3
I p3 a A1 A3 A
1 - 136

3
I b2 p a2 A1 A3 A
1 +
32 I b2 p3 a2 A1 A3 A
1


3 + p2
+ 2 I p3 a A2 A3 A
2 - 32 I b2 p3 a2 A2 A3 A
2


3 + p2
+ 3
4
I p3 a A3
2 A
3 -
4
3
I b2 p a2 A3
2 A
3 - 8 I b2 p3 a2 A3
2 A
3

3 + p2
+ 2 I p3 a A3 A4 A
4 - 32 I b2 p3 a2 A3 A4 A
4


3 + p2
,
D2A4 ﬁ-
I EIT1 s1-I T1 s4+I t2 Ù0
1Sin@2 p xD P2@xD â x



4  !!!2 p
- A4 m2 + 4
3
I p3 a A1 A4 A
1 -
1024

9
I b2 p a2 A1 A4 A
1 + 64 I b2 p3 a2 A1 A4 A
1


3 + p2
+ 4 I p3 a A2 A4 A
2 -
64 I b2 p3 a2 A2 A4 A
2


3 + p2
+ I p3 a A3 A4 A
3 - 16 I b2 p3 a2 A3 A4 A
3


3 + p2
+
2
3
I E-2 I T1 s4 p3 a A1
2 A
4 - 352

9
I b2 E-2 I T1 s4 p a2 A1
2 A
4 + 2 I E2 I T1 s2-2 I T1 s4 p3 a A2
2 A
4 +
32

3
I b2 E2 IT1 s2-2 I T1 s4 p a2 A2
2 A
4 + 6 I p3 a A4
2 A
4 + 32

3
I b2 p a2 A4
2 A
4 - 64 I b2 p3 a2 A4
2 A
4


3 + p2
>
We can rewrite SCond2v and SCond2h in compact form by collecting the coefficients of the same form as follows:
collectForm = TableA9Ai@T1, T2D EI wi T0, A
i@T1, T2D E-I wi T0=, 8i, 4<E  Flatten;
cubicTerms = Nest@Outer@Times, collectForm, #D &, collectForm, 2D  Flatten  Union;
cubicST@i_D := E-I wi T0 cubicTerms . expRule1@iD . Exp@_ T0 + _.D -> 0  Union  Rest
Chapter9.nb
329

moduEq = MapIndexed@Hterm = cubicST@#2@@1DDD; coef = Coefficient@#1@@2DD, termD;
#1@@1DD == H#1@@2DD . Thread@term -> 0DL + coef.termL &, Join@SCond2v, SCond2hDD;
moduEq . displayRule
:D2A1 == -
I EIT1 s1+I t1 Ù0
1HP1@xD - Cos@2 p xD P1@xDL â x



4  !!!6 p
-
A1 m1 + i
k
jj 2
3
I p3 a - 224

3
I b2 p a2 + 256 I b2 p a2

3 + p2
+ 64 I b2 p3 a2

9 + 3 p2
y
{
zz A1
2 A
1 +
E2 I T1 s2 i
k
jj 2
3
I p3 a - 352

9
I b2 p a2y
{
zz A2
2 A
1 + E2 I T1 s4 i
k
jj 2
3
I p3 a - 352

9
I b2 p a2y
{
zz A4
2 A
1 +
i
k
jj 4
3
I p3 a - 256

9
I b2 p a2 - 256 I b2 p a2

3 + p2
- 64 I b2 p3 a2

9 + 3 p2
y
{
zz A1 A2 A
2 +
i
k
jj 1
3
I p3 a - 4
3
I b2 p a2 - 64 I b2 p a2

3 + p2
- 16 I b2 p3 a2

9 + 3 p2
y
{
zz A1 A3 A
3 +
i
k
jj 4
3
I p3 a - 256

9
I b2 p a2 - 256 I b2 p a2

3 + p2
- 64 I b2 p3 a2

9 + 3 p2
y
{
zz A1 A4 A
4,
D2A2 == -
I EIT1 s1-I T1 s2+I t1 Ù0
1Sin@2 p xD P1@xD â x



4  !!!2 p
- A2 m1 +
i
k
jj 4
3
I p3 a - 1024

9
I b2 p a2 + 64 I b2 p3 a2

3 + p2
y
{
zz A1 A2 A
1 + E-2 I T1 s2 i
k
jj 2
3
I p3 a - 352

9
I b2 p a2y
{
zz A1
2 A
2 +
i
k
jjj6 I p3 a + 32

3
I b2 p a2 - 64 I b2 p3 a2

3 + p2
y
{
zzz A2
2 A
2 + E-2I T1 s2+2 I T1 s4 i
k
jj2 I p3 a + 32

3
I b2 p a2y
{
zz A4
2 A
2 +
i
k
jjI p3 a - 16 I b2 p3 a2

3 + p2
y
{
zz A2 A3 A
3 + i
k
jj4 I p3 a - 64 I b2 p3 a2

3 + p2
y
{
zz A2 A4 A
4,
D2A3 == -A3 m2 + i
k
jj 2
3
I p3 a - 136

3
I b2 p a2 + 32 I b2 p3 a2

3 + p2
y
{
zz A1 A3 A
1 + i
k
jj2 I p3 a - 32 I b2 p3 a2

3 + p2
y
{
zz A2 A3 A
2 +
i
k
jj 3
4
I p3 a - 4
3
I b2 p a2 - 8 I b2 p3 a2

3 + p2
y
{
zz A3
2 A
3 + i
k
jj2 I p3 a - 32 I b2 p3 a2

3 + p2
y
{
zz A3 A4 A
4,
D2A4 == -
I EIT1 s1-I T1 s4+I t2 Ù0
1Sin@2 p xD P2@xD â x



4  !!!2 p
- A4 m2 +
i
k
jj 4
3
I p3 a - 1024

9
I b2 p a2 + 64 I b2 p3 a2

3 + p2
y
{
zz A1 A4 A
1 + i
k
jj4 I p3 a - 64 I b2 p3 a2

3 + p2
y
{
zz A2 A4 A
2 +
i
k
jjI p3 a - 16 I b2 p3 a2

3 + p2
y
{
zz A3 A4 A
3 + E-2I T1 s4 i
k
jj 2
3
I p3 a - 352

9
I b2 p a2y
{
zz A1
2 A
4 +
E2 I T1 s2-2 I T1 s4 i
k
jj2 I p3 a + 32

3
I b2 p a2y
{
zz A2
2 A
4 + i
k
jjj6 I p3 a + 32

3
I b2 p a2 - 64 I b2 p3 a2

3 + p2
y
{
zzz A4
2 A
4>
These solvability conditions satisfy the symmetry properties because
formList = TableAAj@T1, T2D TableAAi@T1, T2D A
i@T1, T2D, 8i, 4<E, 8j, 4<E;
formList . displayRule
88A1
2 A
1, A1 A2 A
2, A1 A3 A
3, A1 A4 A
4<, 8A1 A2 A
1, A2
2 A
2, A2 A3 A
3, A2 A4 A
4<,
8A1 A3 A
1, A2 A3 A
2, A3
2 A
3, A3 A4 A
4<, 8A1 A4 A
1, A2 A4 A
2, A3 A4 A
3, A4
2 A
4<<
330
Chapter9.nb

notationList = Table@si,j, 8i, 4<, 8j, 4<D
88s1,1, s1,2, s1,3, s1,4<, 8s2,1, s2,2, s2,3, s2,4<, 8s3,1, s3,2, s3,3, s3,4<, 8s4,1, s4,2, s4,3, s4,4<<
coefRule = MapThread@Rule, 8notationList,
Coefficient@H2 w# IL moduEq@@#, 2DD, formList@@#DDD &  Range@4D<, 2D  Flatten;
testList = Table@si,j - sj,i, 8i, 4<, 8j, i, 4<D  Flatten  Union  Rest
8s1,2 - s2,1, s1,3 - s3,1, s2,3 - s3,2, s1,4 - s4,1, s2,4 - s4,2, s3,4 - s4,3<
testList . coefRule . params  Factor
80, 0, 0, 0, 0, 0<
Chapter9.nb
331

 
329
REFERENCES 
 
 
 
1. 
Arafat, H. N., Nayfeh, A. H., and Chin, C-M., 1998, "Nonlinear Nonplanar Dynamics of 
Parametrically Excited Cantilever Beams," Nonlinear Dynamics, 15, 31-61. 
2. 
Benedettini, F., Rega, G., and Alaggio, R., 1995a, "Experimental Analysis of the Finite 
Dynamics of a Suspended Cable," Proceedings of the 15th ASME Biennial Conference on 
Mechanical Vibrations and Noise, DE Vol. 84-1, 543-552. 
3. 
Benedettini, F., Rega, G., and Alaggio, R., 1995b, "Non-Linear Oscillations of a Four-
Degree-of-Freedom Model of a Suspended Cable under Multiple Internal Resonance 
Conditions," J. Sound and Vibration, 182, 775-798. 
4. 
Chin, C-M. and Nayfeh, A. H., 1996, "Bifurcation and Chaos in Externally Excited Circular 
Cylindrical Shells," J. Applied Mechanics, 63, 565-574. 
5. 
Chin, C-M. and Nayfeh, A. H., 1997, "Three-to-One Internal Resonances in Hinged-Clamped 
Beams," Nonlinear Dynanmics, 12, 129-154. 
6. 
Chin, C-M., Nayfeh, A. H., and Lacarbonara, W., 1997, "Two-to-One Internal Resonances in 
Parametrically Excited Buckled Beams," Proceedings of the AIAA Structures, Structural 
Dynamics and Materials Conference, 1, 213-223 
7. 
Chu, H-N. and Herrmann, G., 1956, "Influence of Large Amplitudes on Free Flexural 
Vibrations of Rectangular Elastic Plates," J. Applied Mechanics, 23, 532-540. 
8. 
Crespo da Silva, M. R. M., 1978, "Flexural-Flexural Oscillations of Beck's Column Subjected 
to a Planar Harmonic Excitation," J. Sound and Vibration, 60, 133-144. 
9. 
Crespo da Silva, M. R. M. and Glynn, C. C., 1978a, "Nonlinear Flexural-Flexural-Torsional 
Dynamics of Inextensional Beams, I. Equations of Motion," J. Structural Mechanics, 6, 437-
448. 
10. 
Crespo da Silva, M. R. M. and Glynn, C. C., 1978b, "Nonlinear Flexural-Flexural-Torsional 
Dynamics of Inextensional Beams, I. Forced Motion," J. Structural Mechanics, 6, 449-461. 
11. 
Lacarbonara, W., Nayfeh, A. H., and Kreider, W., 1998, "Experimental Validation of 
Reduction Methods for Nonlinear Vibrations of Distributed-Parameter Systems: Analysis of a 
Buckled Beam," Nonlinear Dynamics, 17, 95-117. 
12. 
Malkin, I. G., 1956, Some Problems in the Theory of Nonlinear Oscillations, GITTL, 
Moscow. 
13. 
McIvor, I. K., 1966, "The Elastic Cylindrical Shell under Radial Impulse," J. Applied 
Mechanics, 33, 831-837. 
14. 
Nayfeh, A. H., 1975, "Nonlinear Propagation of a Wave Packet in a Hard-Walled Circular 
Duct," J. Acoustical Society of America, 57, 803-809. 
15. 
Nayfeh, A. H., 1981, Introduction to Perturbation Techniques, Wiley, New York. 
16. 
Nayfeh, A. H., 1998, "Reduced-Order Models of Weakly Nonlinear Spatially Continuous 
Systems," Nonlinear Dynamics, 16, 105-125. 
17. 
Nayfeh, A. H. and Asfar, K. R., 1986, "Response of a Bar Constrained by a Non-Linear 
Spring to a Harmonic Excitation," J. Sound and Vibrations, 105, 1-15. 
18. 
Nayfeh, A. H. and Bouguerra, H., 1990, "Non-Linear Response of a Fluid Valve," Int. J. Non-
Linear Mechanics, 25, 433-439. 
19. 
Nayfeh, A. H., Kreider, W., and Anderson, T. J., 1995, "Investigation of Natural Frequencies 
and Mode Shapes of Buckled Beams," AIAA J., 33, 1121-1126. 

 
330
20. 
Nayfeh, A. H. and Lacarbonara, W., 1997, "On the Discretization of Distributed-Parameter 
Systems with Quadratic and Cubic Nonlinearities," Nonlinear Dynamics, 13, 203-220. 
21. 
Nayfeh, A. H. and Lacarbonara, W., 1998, "On the Discretization of Spatially Continuous 
Systems with Quadratic and Cubic Nonlinearities," JSME Int. J., C41, 510-531. 
22. 
Nayfeh, A. H., Lacarbonara, W., and Chin, C-M., 1999, "Nonlinear Normal Modes of 
Buckled Beams: Three-to-One and One-to-One Internal Resonances," Nonlinear Dynamics, 
in press. 
23. 
Nayfeh, A. H. and Mook, D. T., 1979, Nonlinear Oscillations, Wiley, New York. 
24. 
Nayfeh, A. H., Nayfeh, J. F., and Mook, D. T., 1992, "On Methods for Continuous Systems 
with Quadratic and Cubic Nonlinearities," Nonlinear Dynamics, 3, 145-162. 
25. 
Nayfeh, S. A. and Nayfeh, A. H., 1993, "Nonlinear Interactions Between Two Widely Spaced 
Modes - External Excitation," Int. J. Bifurcation and Chaos, 3, 417-427. 
26. 
Nayfeh, A. H. and Nayfeh, S. A., 1995, "Nonlinear Normal Modes of a Continuous System 
with Quadratic Nonlinearities," J. Vibration and Acoustics, 117, 199-205. 
27. 
Nayfeh, A. H., Nayfeh, S. A., and Pakdemirli, M., 1995, "On the Discretization of Weakly 
Nonlinear Spatially Continuous Systems," in Nonlinear Dynamics and Stochastic Mechanics, 
W. Kliemann and N. Sri Namachchivaya, eds., CRC Press, Boca Raton, Florida, 175-200. 
28. 
Pai, P. F. and Nayfeh, A. H., 1990a, "Non-Linear Non-Planar Oscillations of a Cantilever 
Beam under Lateral Base Excitations," Int. J. Non-Linear Mechanics, 25, 455-474. 
29. 
Pai, P. F. and Nayfeh, A. H., 1990b, "Three-Dimensional Nonlinear Vibrations of Composite 
Beams- I. Equations of Motion," Nonlinear Dynamics, 1, 477-502. 
30. 
Pakdemirli, M., Nayfeh, S. A., and Nayfeh, A. H., 1995, "Analysis of One-to-One 
Autoparametric Resonances in Cables - Discretization vs. Direct Treatment," Nonlinear 
Dynamics, 8, 65-83. 
31. 
Raouf, R. A. and Nayfeh, A. H., 1990a, "Nonlinear Axisymmetric Response of Spherical 
Shells to a Radial Harmonic Excitation," Int. J. Non-Linear Mechanics, 25, 475-492. 
32. 
Raouf, R. A. and Nayfeh, A. H., 1990b, "One-to-One Autoparametric Resonances in 
Infinitely Long Cylindrical Shells," Computers & Structures, 35, 163-173. 
33. 
Rega, G., Lacarbonara, W., Nayfeh, A. H., and Chin, C-M., 1999, "Multiple Resonances in 
Suspended Cables: Direct versus Reduced-Order Models," Int. J. Non-Linear Mechanics, 
accepted for publication. 
34. 
von K↔rm↔n, T., 1910, "Festigkeitsprobleme in Maschinenbau," Encyklopadie der 
Mathematischen Wissenschaften, P. R. Halmos, ed., American Mathematical Society, 3, 211-
385. 
35. 
Yamamoto, T. 1957, "On the Vibrations of a Rotating Shaft," Mem. Fac. Eng. Nagoya Univ., 
9, 19-115. 
36. 
Yamamoto, T. 1960, "Response Curves at the Critical Speeds of Subharmonic and Summed 
and Differential Harmonic Oscillations," Bull. JSME, 3, 397-403. 
 

