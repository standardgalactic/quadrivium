Moduli of Curves
Joe Harris
Ian Morrison
Springer





To Phil Grifﬁths
and David Mumford

Preface
Aims
The aim of this book is to provide a guide to a rich and fascinating sub-
ject: algebraic curves, and how they vary in families. The revolution
that the ﬁeld of algebraic geometry has undergone with the introduc-
tion of schemes, together with new ideas, techniques and viewpoints
introduced by Mumford and others, have made it possible for us to
understand the behavior of curves in ways that simply were not possi-
ble a half-century ago. This in turn has led, over the last few decades,
to a burst of activity in the area, resolving long-standing problems
and generating new and unforeseen results and questions. We hope
to acquaint you both with these results and with the ideas that have
made them possible.
The book isn’t intended to be a deﬁnitive reference: the subject is
developing too rapidly for that to be a feasible goal, even if we had
the expertise necessary for the task. Our preference has been to fo-
cus on examples and applications rather than on foundations. When
discussing techniques we’ve chosen to sacriﬁce proofs of some, even
basic, results — particularly where we can provide a good reference —
in order to show how the methods are used to study moduli of curves.
Likewise, we often prove results in special cases which we feel bring
out the important ideas with a minimum of technical complication.
Chapters 1 and 2 provide a synopsis of basic theorems and conjec-
tures about Hilbert schemes and moduli spaces of curves, with few
or no details about techniques or proofs. Use them more as a guide
to the literature than as a working manual. Chapters 3 through 6 are,
by contrast, considerably more self-contained and approachable. Ul-
timately, if you want to investigate fully any of the topics we discuss,
you’ll have to go beyond the material here; but you will learn the tech-
niques fully enough, and see enough complete proofs, that when you
ﬁnish a section here you’ll be equipped to go exploring on your own.
If your goal is to work with families of curves, we’d therefore suggest
that you begin by skimming the ﬁrst two chapters and then tackle the
later chapters in detail, referring back to the ﬁrst two as necessary.

viii
Contents
As for the contents of the book: Chapters 1 and 2 are largely exposi-
tory: for the most part, we discuss in general terms the problems as-
sociated with moduli and parameter spaces of curves, what’s known
about them, and what sort of behavior we’ve come to expect from
them. In Chapters 3 through 5 we develop the techniques that have
allowed us to analyze moduli spaces: deformations, specializations
(of curves, of maps between them and of linear series on them), tools
for making a variety of global enumerative calculations, geometric in-
variant theory, and so on. Finally, in Chapter 6, we use the ideas and
techniques introduced in preceding chapters to prove a number of
basic results about the geometry of the moduli space of curves and
about various related spaces.
Prerequisites
What sort of background do we expect you to have before you start
reading? That depends on what you want to get out of the book. We’d
hope that even if you have only a basic grounding in modern algebraic
geometry and a slightly greater familiarity with the theory of a ﬁxed
algebraic curve, you could read through most of this book and get a
sense of what the subject is about: what sort of questions we ask, and
some of the ways we go about answering them. If your ambition is
to work in this area, of course, you’ll need to know more; a working
knowledge with many of the topics covered in Geometry of algebraic
curves, I [7] ﬁrst and foremost. We could compile a lengthy list of other
subjects with which some acquaintance would be helpful. But, instead,
we encourage you to just plunge ahead and ﬁll in the background as
needed; again, we’ve tried to write the book in a style that makes such
an approach feasible.
Navigation
In keeping with the informal aims of the book, we have used only
two levels of numbering with arabic for chapters and capital letters
for sections within each chapter. All labelled items in the book are
numbered consecutively within each chapter: thus, the orderings of
such items by label and by position in the book agree.
There is a single index. However, its ﬁrst page consists of a list
of symbols, giving for each a single deﬁning occurrence. These, and
other, references to symbols also appear in the main body of the index
where they are alphabetized “as read”: for example, references to Mg
will be found under Mgbar; to κi under kappai. Bold face entries in the
main body index point to the deﬁning occurrence of the cited term.
References to all the main results stated in the book can be found
under the heading theorems.

ix
Production acknowledgements
This book was designed by the authors who provided Springer with
the PostScript ﬁle from which the plates were produced. The type is
a very slightly modiﬁed version of the Lucida font family designed by
Chuck Bigelow and Kristin Holmes. (We added swashes to a few char-
acters in the \mathcal alphabet to make them easier to distinguish
from the corresponding upper-case \mathit character. These alpha-
bets are often paired: a \mathcal character is used for the total space
of a family and the \mathit version for an element.) It was coded in a
customized version of the LATEX2e format and typeset using Blue Sky
Research’s Textures TEX implementation with EPS ﬁgures created in
Macromedia’s Freehand7 illustration program.
A number of people helped us with the production of the book.
First and foremost, we want to thank Greg Langmead who did a truly
wonderful job of producing an initial version of both the LATEX code
and the ﬁgures from our earlier WYSIWYG drafts. Dave Bayer offered
invaluable programming assistance in solving many problems. Most
notably, he devoted considerable effort to developing a set of macros
for overlaying text generated within TEX onto ﬁgures. These allow pre-
cise one-time text placement independent of the scale of the ﬁgure
and proved invaluable both in preparing the initial ﬁgures and in
solving ﬂoat placement problems. If you’re interested, you can ob-
tain the macros, which work with all formats, by e-mailing Dave at
bayer@math.columbia.edu.
Frank Ganz at Springer made a number of comments to improve
the design and assisted in solving some of the formatting problems
he raised. At various points, Donald Arseneau, Berthold Horn, Vin-
cent Jalby and Sorin Popescu helped us solve or work around various
difﬁculties. We are grateful to all of them.
Lastly, we wish to thank our patient editor, Ina Lindemann, who was
never in our way but always ready to help.
Mathematical acknowledgements
You should not hope to ﬁnd here the sequel to Geometry of algebraic
curves, I [7] announced in the preface to that book. As we’ve already
noted, our aim is far from the “comprehensive and self-contained ac-
count” which was the goal of that book, and our text lacks its uni-
formity. The promised second volume is in preparation by Enrico Ar-
barello, Maurizio Cornalba and Phil Grifﬁths.
A few years ago, these authors invited us to attempt to merge our
then current manuscript into theirs. However, when the two sets of
material were assembled, it became clear to everyone that ours was
so far from meeting the standards set by the ﬁrst volume that such
a merger made little sense. Enrico, Maurizio and Phil then, with their

x
usual generosity, agreed to allow us to withdraw from their project
and to publish what we had written here. We cannot too strongly ac-
knowledge our admiration for the kindness with which the partner-
ship was proposed and the grace with which it was dissolved nor our
debt to them for the inﬂuence their ideas have had on our understand-
ing of curves and their moduli.
The book is based on notes from a course taught at Harvard in 1990,
when the second author was visiting, and we’d like to thank Harvard
University for providing the support to make this possible, and Ford-
ham University for granting the second author both the leave for this
visit and a sabbatical leave in 1992-93. The comments of a number
of students who attended the Harvard course were very helpful to us:
in particular, we thank Dan Abramovich, Jean-Francois Burnol, Lucia
Caporaso and James McKernan. We owe a particular debt to Angelo
Vistoli, who also sat in on the course, and patiently answered many
questions about deformation theory and algebraic stacks.
There are many others as well with whom we’ve discussed the var-
ious topics in this book, and whose insights are represented here. In
addition to those mentioned already, we thank especially David Eisen-
bud, Bill Fulton and David Gieseker.
We to thank Armand Brumer, Anton Dzhamay, Carel Faber, Bill Ful-
ton, Rahul Pandharipande, Cris Poor, Sorin Popescu and Monserrat
Teixidor i Bigas who volunteered to review parts of this book. Their
comments enabled us to eliminate many errors and obscurities. For
any that remain, the responsibility is ours alone.
Finally, we thank our respective teachers, Phil Grifﬁths and David
Mumford. The beautiful results they proved and the encouragement
they provided energized and transformed the study of algebraic
curves — for us and for many others. We gratefully dedicate this book
to them.

Contents
Preface
vii
1
Parameter spaces: constructions and examples
1
A Parameters and moduli . . . . . . . . . . . . . . . . . . . . .
1
B
Construction of the Hilbert scheme . . . . . . . . . . . . .
5
C
Tangent space to the Hilbert scheme
. . . . . . . . . . . .
12
D Extrinsic pathologies
. . . . . . . . . . . . . . . . . . . . . .
18
Mumford’s example . . . . . . . . . . . . . . . . . . . . .
19
Other examples . . . . . . . . . . . . . . . . . . . . . . . .
24
E
Dimension of the Hilbert scheme . . . . . . . . . . . . . . .
26
F
Severi varieties . . . . . . . . . . . . . . . . . . . . . . . . . .
29
G Hurwitz schemes . . . . . . . . . . . . . . . . . . . . . . . . .
32
2
Basic facts about moduli spaces of curves
35
A Why do ﬁne moduli spaces of curves not exist? . . . . . .
35
B
Moduli spaces we’ll be concerned with
. . . . . . . . . . .
40
C
Constructions of Mg
. . . . . . . . . . . . . . . . . . . . . .
43
The Teichm¨uller approach . . . . . . . . . . . . . . . . .
43
The Hodge theory approach . . . . . . . . . . . . . . . .
44
The geometric invariant theory (G.I.T.) approach . . .
46
D Geometric and topological properties . . . . . . . . . . . .
52
Basic properties
. . . . . . . . . . . . . . . . . . . . . . .
52
Local properties
. . . . . . . . . . . . . . . . . . . . . . .
52
Complete subvarieties of Mg . . . . . . . . . . . . . . .
55
Cohomology of Mg: Harer’s theorems . . . . . . . . . .
58
Cohomology of the universal curve
. . . . . . . . . . .
62
Cohomology of Hilbert schemes
. . . . . . . . . . . . .
63
Structure of the tautological ring . . . . . . . . . . . . .
67
Witten’s conjectures and Kontsevich’s theorem . . . .
71
E
Moduli spaces of stable maps . . . . . . . . . . . . . . . . .
76
3
Techniques
81
A Basic facts about nodal and stable curves
. . . . . . . . .
81
Dualizing sheaves . . . . . . . . . . . . . . . . . . . . . .
82

xii
Contents
Automorphisms
. . . . . . . . . . . . . . . . . . . . . . .
85
B
Deformation theory . . . . . . . . . . . . . . . . . . . . . . .
86
Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . .
86
Deformations of smooth curves
. . . . . . . . . . . . .
89
Variations on the basic deformation theory plan . . .
92
Universal deformations of stable curves
. . . . . . . .
102
Deformations of maps
. . . . . . . . . . . . . . . . . . .
105
C
Stable reduction
. . . . . . . . . . . . . . . . . . . . . . . . .
117
Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
117
Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . .
120
D Interlude: calculations on the moduli stack
. . . . . . . .
139
Divisor classes on the moduli stack . . . . . . . . . . .
140
Existence of tautological families . . . . . . . . . . . . .
148
E
Grothendieck-Riemann-Roch and Porteous . . . . . . . . .
150
Grothendieck-Riemann-Roch
. . . . . . . . . . . . . . .
150
Chern classes of the Hodge bundle . . . . . . . . . . . .
154
Chern class of the tangent bundle . . . . . . . . . . . .
159
Porteous’ formula . . . . . . . . . . . . . . . . . . . . . .
161
The hyperelliptic locus in M3 . . . . . . . . . . . . . . .
162
Relations amongst standard cohomology classes . . .
165
Divisor classes on Hilbert schemes . . . . . . . . . . . .
166
F
Test curves: the hyperelliptic locus in M3 begun . . . . .
168
G Admissible covers . . . . . . . . . . . . . . . . . . . . . . . .
175
H The hyperelliptic locus in M3 completed . . . . . . . . . .
186
4
Construction of Mg
191
A Background on geometric invariant theory . . . . . . . . .
192
The G.I.T. strategy . . . . . . . . . . . . . . . . . . . . . .
192
Finite generation of and separation by invariants . . .
194
The numerical criterion . . . . . . . . . . . . . . . . . . .
199
Stability of plane curves
. . . . . . . . . . . . . . . . . .
202
B
Stability of Hilbert points of smooth curves . . . . . . . .
206
The numerical criterion for Hilbert points . . . . . . .
206
Gieseker’s criterion
. . . . . . . . . . . . . . . . . . . . .
211
Stability of smooth curves . . . . . . . . . . . . . . . . .
216
C
Construction of Mg via the Potential Stability Theorem .
220
The plan of the construction and a few corollaries . .
220
The Potential Stability Theorem . . . . . . . . . . . . . .
224
5
Limit Linear Series and Brill-Noether theory
240
A Introductory remarks on degenerations . . . . . . . . . . .
240
B
Limits of line bundles . . . . . . . . . . . . . . . . . . . . . .
247
C
Limits of linear series: motivation and examples . . . . .
253
D Limit linear series: deﬁnitions and applications . . . . . .
263
Limit linear series
. . . . . . . . . . . . . . . . . . . . . .
263

Contents
xiii
Smoothing limit linear series
. . . . . . . . . . . . . . .
266
Limits of canonical series and Weierstrass points . . .
269
E
Limit linear series on ﬂag curves . . . . . . . . . . . . . . .
274
Inequalities on vanishing sequences . . . . . . . . . . .
274
The case ρ = 0
. . . . . . . . . . . . . . . . . . . . . . . .
276
Proof of the Gieseker-Petri theorem . . . . . . . . . . .
280
6
Geometry of moduli spaces: selected results
286
A Irreducibility of the moduli space of curves . . . . . . . .
286
B
Diaz’ theorem . . . . . . . . . . . . . . . . . . . . . . . . . . .
288
The idea: stratifying the moduli space . . . . . . . . . .
288
The proof
. . . . . . . . . . . . . . . . . . . . . . . . . . .
292
C
Moduli of hyperelliptic curves . . . . . . . . . . . . . . . . .
293
Fiddling around
. . . . . . . . . . . . . . . . . . . . . . .
293
The calculation for an (almost) arbitrary family . . . .
295
The Picard group of the hyperelliptic locus
. . . . . .
301
D Ample divisors on Mg
. . . . . . . . . . . . . . . . . . . . .
303
An inequality for generically Hilbert stable families .
304
Proof of the theorem
. . . . . . . . . . . . . . . . . . . .
305
An inequality for families of pointed curves . . . . . .
308
Ample divisors on Mg
. . . . . . . . . . . . . . . . . . .
310
E
Irreducibility of the Severi varieties
. . . . . . . . . . . . .
313
Initial reductions . . . . . . . . . . . . . . . . . . . . . . .
314
Analyzing a degeneration
. . . . . . . . . . . . . . . . .
320
An example . . . . . . . . . . . . . . . . . . . . . . . . . .
324
Completing the argument
. . . . . . . . . . . . . . . . .
326
F
Kodaira dimension of Mg
. . . . . . . . . . . . . . . . . . .
328
Writing down general curves
. . . . . . . . . . . . . . .
328
Basic ideas . . . . . . . . . . . . . . . . . . . . . . . . . . .
330
Pulling back the divisors Dr
s . . . . . . . . . . . . . . . .
335
Divisors on Mg that miss j(M2,1 \ W)
. . . . . . . . .
336
Divisors on Mg that miss i(M0,g) . . . . . . . . . . . .
340
Further divisor class calculations . . . . . . . . . . . . .
342
Curves deﬁned over Q
. . . . . . . . . . . . . . . . . . .
342
Bibliography
345
Index
355

Chapter 1
Parameter spaces:
constructions and examples
A
Parameters and moduli
Before we take up any of the constructions that will occupy us in
this chapter, we want to make a few general remarks about moduli
problems in general.
What is a moduli problem? Typically, it consists of two things. First
of all, we specify a class of objects (which could be schemes, sheaves,
morphisms or combinations of these), together with a notion of what
it means to have a family of these objects over a scheme B. Second, we
choose a (possibly trivial) equivalence relation ∼on the set S(B) of all
such families over each B. We use the rather vague term “object” de-
liberately because the possibilities we have in mind are wide-ranging.
For example, we might take our families to be
1. smooth ﬂat morphisms C ✲B whose ﬁbers are smooth curves
of genus g, or
2. subschemes C in Pr × B, ﬂat over B, whose ﬁbers over B are
curves of ﬁxed genus g and degree d,
and so on. We can loosely consider the elements of S(Spec(C)) as the
objects of our moduli problem and the elements of S(B) over other
bases as families of such objects parameterized by the complex points
of B.1
The equivalence relations we will wish to consider will vary consid-
erably even for a ﬁxed class of objects: in the second case cited above,
we might wish to consider two families equivalent if
1More generally, we may consider elements of S(Spec(k)) for any ﬁeld k as objects
of our moduli problem deﬁned over k.

2
1. Parameter spaces: constructions and examples
1. the two subschemes of Pr × B are equal,
2. the two subcurves are projectively equivalent over B, or
3. the two curves are (biregularly) isomorphic over B.
In any case, we build a functor F from the category of schemes to that
of sets by the rule
F(B) = S(B)/ ∼
and call F the moduli functor of our moduli problem.
The fundamental ﬁrst question to answer in studying a given moduli
problem is: to what extent is the functor F representable? Recall that
F is representable in the category of schemes if there is a scheme M
and an isomorphism Ψ (of functors from schemes to sets) between F
and the functor of points of M. This last is the functor MorM whose
value on B is the set Morsch(B, M) of all morphisms of schemes from
B to M.
Deﬁnition (1.1) If F is representable by M, then we say that the
scheme M is a ﬁne moduli space for the moduli problem F.
Representability has a number of happy consequences for the study
of F. If ϕ : D ✲B is any family in (i.e., any element of) S(B), then
χ = Ψ(ϕ) is a morphism from B to M. Intuitively, (closed) points of
M classify the objects of our moduli problem and the map χ sends
a (closed) point b of B to the moduli point in M determined by the
ﬁber Db of D over b. Going the other way, pulling back the identity
map of M itself via Ψ constructs a family 1 : C ✲M in S(M) called the
universal family. The reason for this name is that, given any morphism
χ : B ✲M deﬁned as above, there is a commutative ﬁber-product
diagram
(1.2)
D
✲C
B
ϕ
❄
χ ✲M
❄
1
with ϕ : D ✲B in S(B) and Ψ(ϕ) = χ. In sum, every family over B is
the pullback of C via a unique map of B to M and we have a perfect
dictionary enabling us to translate between information about the ge-
ometry of families of our moduli problem and information about the
geometry of the moduli space M itself. One of the main themes of
moduli theory is to bring information about the objects of our moduli
problem to bear on the study of families and vice versa: the dictionary
above is a powerful tool for relating these two types of information.

A. Parameters and moduli
3
Unfortunately, few natural moduli functors are representable by
schemes: we’ll look at the reasons for this failure in the next chap-
ter. One response to this failure is to look for a larger category (e.g.,
algebraic spaces, algebraic stacks, . . .) in which F can be represented:
the investigation of this avenue will also be postponed until the next
chapter. Here we wish to glance brieﬂy at a second strategy: to ﬁnd a
scheme M that captures enough of the information in the functor F
to provide us with a “concise edition” of the dictionary above.
The standard way to do this is to ask only for a natural transfor-
mation of functors Ψ = ΨM from F to Mor(·, M) rather than an iso-
morphism. Then, for each family ϕ : D ✲B in S(B), we still have a
morphism χ = Ψ(ϕ) : B ✲M as above. Moreover, these maps are still
natural in that, if ϕ′ : D′ = D ×B B′ ✲B′ is the base change by a
map ξ : B′ ✲B, then χ′ = Ψ(ϕ′) = Ψ(ϕ) ◦ξ. This requirement, how-
ever, is far from determining M. Indeed, given any solution (M, Ψ)
and any morphism π : M ✲M′, we get another solution (M′, π ◦Ψ).
For example, we could always take M′ to equal Spec(C) and Ψ(ϕ) to
be the unique morphism B ✲Spec(C) and then our dictionary would
have only blank pages; or, we could take the disjoint union of the
“right” M with any other scheme. We can rule such cases out by re-
quiring that the complex points of M correspond bijectively to the
objects of our moduli problem. This still doesn’t ﬁx the scheme struc-
ture on M: it leaves us the freedom to compose, as above, with a map
π : M ✲M′ as long as π itself is bijective on complex points. For ex-
ample, we would certainly want the moduli space M of lines through
the origin in C2 to be P1 but our requirements so far don’t exclude
the possibility of taking instead the cuspidal rational curve M′ with
equation y2z = x3 in P2 which is the image of P1 under the map
[a, b] ✲[a2b, a3, b3]. This pathology can be eliminated by requir-
ing that M be universal with respect to the existence of the natural
transformation Ψ: cf. the ﬁrst exercise below. When all this holds, we
say that (M, Ψ), or more frequently M, is a coarse moduli space for
the functor F. Formally,
Deﬁnition (1.3) A scheme M and a natural transformation ΨM from
the functor F to the functor of points MorM of M are a coarse moduli
space for the functor F if
1) The map ΨSpec(C) : F(Spec(C)) ✲M(C) = Mor(Spec(C), M) is a
set bijection.2
2) Given another scheme M′ and a natural transformation ΨM′
from F ✲MorM′, there is a unique morphism π : M ✲M′ such that
2Or more generally require this with C replaced by any algebraically closed ﬁeld.

4
1. Parameter spaces: constructions and examples
the associated natural transformation Π : MorM ✲MorM′ satisﬁes
ΨM′ = Π ◦ΨM.
Exercise (1.4) Show that, if one exists, a coarse moduli scheme
(M, Ψ) for F is determined up to canonical isomorphism by condi-
tion 2) above.
Exercise (1.5) Show that the cuspidal curve M′ deﬁned above is not
a coarse moduli space for lines in C2. Show that P1 is a ﬁne moduli
space for this moduli problem. What is the universal family of lines
over P1?
Exercise (1.6) 1) Show that the j-line M1 is a coarse moduli space
for curves of genus 1.
2) Show that a j-function J on a scheme B arises as the j-function
associated to a family of curves of genus 1 only if all the multiplicities
of the zero-divisor of J are divisible by 3, and all multiplicities of
(J −1728) are even. Using this fact, show that M1 is not a ﬁne moduli
space for curves of genus 1.
3) Show that the family y2 −x3 −t over the punctured afﬁne line
A1 −{0} with coordinate t has constant j, but is not trivial. Use this
fact to give a second proof that M1 is not a ﬁne moduli space.
The next exercise gives a very simple example which serves two
purposes. First, it shows that the second condition on a coarse mod-
uli space above doesn’t imply the ﬁrst. Second, it shows that even a
coarse moduli space may fail to exist for some moduli problems. All
the steps in this exercise are trivial; its point is to give some down-to-
earth content to the rather abstract conditions above and working it
involves principally translating these conditions into English.
Exercise (1.7) Consider the moduli problem F posed by “ﬂat fami-
lies of reduced plane curves of degree 2 up to isomorphism”. The set
F(Spec(C)) has two elements: a smooth conic and a pair of distinct
lines.
1) Show (trivially) that there is a natural transformation Ψ from F to
Mor(·, Spec(C)).
Now ﬁx any pair (X, Ψ ′) where X is a scheme and Ψ ′ is a natural
transformation from F to Mor(·, X).
2) Show that, if ϕ : C ✲B is any family of smooth conics, then
there is a unique C-valued point π : Spec(C) ✲X of X such that
Ψ ′(ϕ) = π ◦Ψ(ϕ).
3) Let ϕ : C ✲A1
t be the family deﬁned by the (afﬁne) equation xy −t
and ϕ′ be its restriction to A1 −{0}. Use the fact that ϕ′ is a family
of smooth conics to show that Ψ ′(ϕ) = π ◦Ψ(ϕ).

B. Construction of the Hilbert scheme
5
4) Show that the pair (Spec(C), Ψ) has the universal property in 2)
above but does not satisfy 1). Use Exercise (1.4) to conclude that there
is no coarse moduli space for the functor F.
We conclude by introducing one somewhat vague terminological
dichotomy which is nonetheless quite useful in practice. We would
like to distinguish between problems that focus on purely intrinsic
data and those that involve, to a greater or lesser degree, extrinsic
data. We will reserve the term moduli space principally for problems
of the former type and refer to the classifying spaces for the latter
(which until now we’ve also been calling moduli spaces) as parameter
spaces. In this sense, the space Mg of smooth curves of genus g is a
moduli space while the space Hd,g,r of subcurves of Pr of degree d
and (arithmetic) genus g is a parameter space. The extrinsic element
in the second case is the gr
d that maps the abstract curve to Pr and
the choice of basis of this linear system that ﬁxes the embedding.
Of course, this distinction depends heavily on our point of view. The
space Gr
d classifying the data of a curve plus a gr
d (without the choice of
a basis) might be viewed as either a moduli space or a parameter space
depending on whether we wish to focus primarily on the underlying
curve or on the curve plus the gr
d. One sign that we’re dealing with a
parameter space is usually that the equivalence relation by which we
quotient the geometric data of the problem is trivial; e.g., for Mg this
relation is “biregular isomorphism” while for Hd,g,r it is trivial.
Heuristically, parameter spaces are easier to construct and more
likely to be ﬁne moduli spaces because the extrinsic extra structure in-
volved tends to rigidify the geometric data they classify. On the other
hand, complete parameter spaces can usually only be formed at the
price of allowing the data of the problem to degenerate rather wildly
while complete — even compact — moduli spaces can often be found
for fairly nice classes of objects. In the next sections, we’ll look at
the Hilbert scheme, a ﬁne parameter space, which provides the best
illustration of the parameter space side of this philosophy.
B
Construction of the Hilbert scheme
The Hilbert scheme is an answer to the problem of parameterizing
subschemes of a ﬁxed projective space Pr . In the language of the pre-
ceding section, we might initially look for a scheme H which is a ﬁne
parameter space for the functor whose “data” for a scheme B consists
of all proper, connected, families of subschemes of Pr deﬁned over
B. This functor, however, has two drawbacks. First, it’s too large to
give us a parameter space of ﬁnite type since it allows hypersurfaces
of all degrees. Second, it allows families whose ﬁbers vary so wildly

6
1. Parameter spaces: constructions and examples
that, like the example in Exercise (1.7), it cannot even be coarsely rep-
resented. To solve the ﬁrst problem, we would like to ﬁx the principal
numerical invariants of the subschemes. We can solve the second by
restricting our attention to ﬂat families which, loosely, means requir-
ing that the ﬁbers vary “continuously”. Both problems can thus be
resolved simultaneously by considering only families with constant
Hilbert polynomial.
Recall
that
the
Hilbert
polynomial
of
a
subscheme
X
of
Pr
is
a
numerical
polynomial
characterized
by
the
equations
PX(m) = h0(X, OX(m)) for all sufﬁciently large m. If X has degree
d and dimension s, then the leading term of PX(m) is dms/s!: cf. Ex-
ercise (1.13). This shows both that PX captures the main numerical
invariants of X, and that ﬁxing it yields a set of subschemes of rea-
sonable size. Moreover, if a proper connected family X ✲B of such
subschemes is ﬂat, then the Hilbert polynomials of all ﬁbers of X are
equal, and, if B is reduced, then the converse also holds. Thus, ﬁx-
ing PX also forces the ﬁbers of the families we’re considering to vary
nicely.
Intuitively, the Hilbert scheme HP,r parameterizes subschemes X
of Pr with ﬁxed Hilbert polynomial PX equal to P: More formally, it’s
a ﬁne moduli space for the functor HilbP,r whose value on B is the set
of proper ﬂat families
(1.8)
X✲i✲Pr × B
πPr✲Pr
❅
❅
❅
❅
ϕ
❘
B
❄
πB
with X having Hilbert polynomial P. The basic fact about it is:
Theorem (1.9) (Grothendieck [67]) The functor HilbP,r is repre-
sentable by a projective scheme HP,r .
The idea of the proof is essentially very simple. We’ll sketch it,
but we’ll only give statements of the two key technical lemmas
whose proofs are both somewhat nontrivial. For more details we refer
you to the recent book of Viehweg [148], Mumford’s notes [120] or
Grothendieck’s original Seminaire Bourbaki talk [67]. First some no-
tation: it’ll be convenient to let S = C[x0, . . . , xr ] and to let Or (m)
denote the Hilbert polynomial of Pr itself (i.e.,
(1.10)
Or (m) =

r + m
m

= dim(Sm)

B. Construction of the Hilbert scheme
7
is the number of homogeneous polynomials of degree m in (r + 1)
variables) and to let Q(m) = Or (m) −P(m). For large m, Q(m) is
then the dimension of the degree m piece I(X)m of the ideal of X
in Pr .
The subscheme X is determined by its ideal I(X) which in turn is
determined by its degree m piece I(X)m for any sufﬁciently large m.
The ﬁrst lemma asserts that we can choose a single m that has this
property uniformly for every subscheme X with Hilbert polynomial P.
Lemma (1.11) (Uniform m lemma) For every P, there is an m0 such
that if m ≥m0 and X is a subscheme of Pr with Hilbert polynomial P,
then:
1) I(X)m is generated by global sections and I(X)l≥m is generated
by I(X)m as an S-module.
2) hi(X, IX(m)) = hi(X, OX(m)) = 0 for all i > 0.
3) dim(I(X)m) = Q(m), h0(X, OX(m)) = P(m) and the restriction
map rX,m : Sm ✲H0(X, OX(m)) is surjective.
The key idea of the construction is that the lemma allows us to as-
sociate to every subscheme X with Hilbert polynomial P the point [X]
of the Grassmannian G = G

P(m), Or (m)

determined by rX,m.3More
formally again, if ϕ : X ✲B is any family as in (1.8), then from the
sheaﬁﬁcation of the restriction maps
(πP)∗
OPr (m)

✲(πP)∗
OPr (m)

OX

✲0
we get a second surjective restriction map
(πB)∗(πP)∗
OPr (m)

✲(πB)∗(πP)∗
OPr (m)

OX

✲0 .
OB

Sm



The middle factor is a locally free sheaf of rank P(m) on B and there-
fore yields a map Ψ(ϕ) : B ✲G. Since these maps are functorial in B,
we have a natural transformation Ψ to the functor of points of some
subscheme H = HP,r of G.
It remains to identify H and to show it represents the functor
HilbP,r . The key to doing so is provided by the universal subbundle F
whose ﬁber over [X] is I(X)m and the multiplication maps
×k : F

Sk ✲Sk+m.
3Or, equivalently, for those who prefer their Grassmannians to parameterize sub-
spaces of the ambient space, the point in G = G(Q(m), Or (m)) determined by I(X)m.

8
1. Parameter spaces: constructions and examples
Lemma (1.12) The conditions that rank(×k) ≤Q(m + k) for all k ≥0
deﬁne a determinantal subscheme H of G and a morphism ψ : B ✲G
arises by applying the construction above to a family ϕ : X ✲B
(i.e. , ψ = Ψ(ϕ)) if and only if ψ factors through this subscheme H .
Grothendieck’s theorem follows immediately. By deﬁnition, H is a
closed subscheme of G (and hence in particular projective). The sec-
ond sentence of the lemma is just another way of expressing the condi-
tion that the transformation Ψ is an isomorphism of functors between
HilbP,r and the functor of points of H .
A few additional remarks about the lemmas are nonetheless in or-
der. When we feel that no confusion will result, we’ll often elide the
words “the Hilbert point of”. Most commonly this allows us to say that
“the variety X lies in” a subscheme of a Hilbert scheme when we mean
that “the Hilbert point [X] of the variety X lies in” this locus. More
generally, we’ll use the analogous elision when discussing loci in other
parameter and moduli spaces. In our experience, everyone who works
a lot with such spaces soon acquires this lazy but harmless vice.
For a ﬁxed X, the existence of an m0 with the properties of the Uni-
form m lemma is a standard consequence of Serre’s FAC theorems
[138]. The same ideas, when applied with somewhat greater care, yield
the uniform bound of the lemma. A natural question is: what is the
minimal value of m0 that can be taken for a given P and r? The answer
is that the worst possible behavior is exhibited by the combinatorially
deﬁned subscheme Xlex deﬁned by the lexicographical ideal. With re-
spect to a choice of an ordered system of homogeneous coordinates
(x0, . . . , xr ) on Pr , this is the ideal whose degree m piece is spanned
by the Q(m) monomials that are greatest in the lexicographic order.
This ideal exhibits many forms of extreme behavior. For example, its
Hilbert function h0(X, OX(m)) attains the maximum possible value in
every (and not just in every sufﬁciently large) degree. For more details,
see [13].
Second, we may also ask what values of k it is necessary to consider
in the second lemma. A priori, it’s not even clear that the inﬁnite set
of conditions rank(×k) ≤Q(m + k) deﬁne a scheme. A key step in
the proof of the lemma is to show that the supports of the ideals IK
generated by the conditions rank(×k) ≤Q(m + k) for k ≤K stabilize
for large K. This is done by using the ﬁrst lemma to show that, if
enough of these equalities hold, then rank(×k) is itself represented
by a polynomial of degree r which can only be Q(m+k). It then follows
by noetherianity that for some possibly larger K the ideals IK stabilize
and hence that H is a scheme. A more careful analysis shows that if m
is at least the m0 of the ﬁrst lemma and J is any Q(m)-dimensional
subspace of Sm, then the dimension of the subspace ×k(J

Sk) of
Sk+m is at least Q(k + m). Moreover, equality can hold for any k > 0

B. Construction of the Hilbert scheme
9
only if J is actually the degree m piece of the ideal of a variety X
with Hilbert polynomial P. So H is actually deﬁned by the equations
rank(×1) ≤Q(m + 1). For details, see [63].
The next three exercises show that Hilbert schemes of hypersur-
faces and of linear subspaces are exactly the familiar parameter
spaces for these objects. For concreteness, the exercises treat special
cases but the arguments generalize in both cases.
Exercise (1.13) 1) Use Riemann-Roch to show that, if X ⊂Pr has
degree d and dimension s, then the leading term of PX(m) is
d
s!

ms.
2) Fix a subscheme X ⊂Pr . Show, by taking cohomology of the exact
sequence of X ⊂Pr , that X is a hypersurface of degree d if and only
if
PX(m) =

r + m
m

−

r + m −d
m −d

.
3) Show that X is a linear space of dimension s if and only if
PX(m) =

s + m
m

.
Exercise (1.14) Show that the Hilbert scheme of lines in P3 (that
is, the Hilbert scheme of subschemes of P3 with Hilbert polynomial
P(m) = m + 1) is indeed the Grassmannian G = G(1, 3). Hint: Recall
that G comes equipped with a universal rank 2 subbundle SG ⊂O4
G.
The universal line over G is the projectivization of SG. Conversely,
given any family ϕ : X ✲B of lines in P3, we get an analogous sub-
bundle SB ⊂O4
B by SB = ϕ∗(OX(1))∨⊂H0(P3, OP3(1))

OB ≊O4
B.
Check, on the one hand, that the projectivization of this inclusion
yields the original family ϕ : X ✲B in P3 and, on the other, that the
standard universal property of G realizes this subbundle as the pull-
back of the universal subbundle by a unique morphism χ : B ✲G.
Then apply Exercise (1.4).
Exercise (1.15) This exercise checks that the Hilbert scheme of plane
curves of degree d is just the familiar projective space of dimension
N = d(d + 3)/2 whose elements correspond to polynomials f of de-
gree d up to scalars.
1) Show that the incidence correspondence
C = {(f , P)|f (P) = 0} ⊂PN × P2
is ﬂat over PN.
The plan of attack is clear: to show that the projection π : C ✲PN is
the universal curve. To this end, let ϕ : X ✲B be a ﬂat family of plane
curves over B and I be the ideal sheaf of X in P2 × B.

10
1. Parameter spaces: constructions and examples
2) Show that I is ﬂat over B. Hint: Apply the fact that a coherent sheaf
F on Pr × B is ﬂat over B if and only if, for large m, (πB)∗(F(m)) is
locally free to the twists of the exact sheaf sequence of X in P2 × B.
3) Show that (πB)∗(I(d)) is a line bundle on B and that the associated
linear system gives a morphism χ : B ✲PN.
4) Show that ϕ : X ✲B is the pullback via χ of the universal family
π : C ✲PN. Then use the universal property of projective space to
show that χ is the unique map with this property.
We should warn you that these two examples are rather mislead-
ing: in both cases, the Hilbert schemes parameterize only the “in-
tended” subschemes (linear spaces in the ﬁrst case, and hypersurfaces
in the second). Most Hilbert schemes largely parameterize projective
schemes that you would prefer to avoid. The reason is that, in con-
trast to the conclusions in Exercise (1.13), the Hilbert polynomial of a
“nice” (e.g., smooth, irreducible) subscheme of Pr is usually also the
Hilbert polynomial of many nasty (nonreduced, disconnected) sub-
schemes too. The twisted cubics — rational normal curves in P3 that
have Hilbert polynomial PX(m) = 3m+1 — give the simplest example:
a plane cubic plus an isolated point has the same Hilbert polynomial.
We will look, in more detail, at this example and many others in the
next few sections.
A natural question is: what is the relationship between the Hilbert
scheme and the more elementary Chow variety which parameterizes
cycles of ﬁxed degree and dimension in Pr ? The answer is that they
are generally very different. The most important difference is that the
Hilbert scheme has a natural scheme structure whereas the Chow va-
riety does not.4 This generally makes the Hilbert scheme more useful.
It is the source of the universal properties on which we’ll rely heavily
later in this book and one reﬂection is that the Hilbert scheme cap-
tures much ﬁner structure. Here is a ﬁrst example.
Exercise (1.16) Let C ⊂P3 be the union of a plane quartic and a
noncoplanar line meeting it at one point. Show that C is not the ﬂat
specialization of a smooth curve of degree 5. What if C is the union
of the quartic and a noncoplanar conic meeting it at two points?
4We should note that several authors have produced scheme structures on the
Chow variety: the most complete treatment is in Sections I.3-5 of [100] which gives an
overview of alternate approaches. However, the most natural scheme structures don’t
represent functors in positive characteristics. This means many aspects of Hilbert
schemes have no analogue for Chow schemes, most signiﬁcantly, the characterization
of the tangent space in Section C and the resulting ability to work inﬁnitesimally on it.

B. Construction of the Hilbert scheme
11
There are a number of useful variants of the Hilbert scheme whose
existence can be shown by similar arguments.5
Deﬁnition (1.17) (Hilbert schemes of subschemes) Given a sub-
scheme Z of Pr , we can deﬁne a closed subscheme H Z
P,r of HP,r pa-
rameterizing subschemes of Z that are closed in Pr and have Hilbert
polynomial P.
Deﬁnition (1.18) (Hilbert schemes of maps) If X ⊂Pr and Y ⊂Ps,
there is a Hilbert scheme HX,Y,d parameterizing polynomial maps
f : X ✲Y of degree at most d. This variant is most easily constructed
as a subscheme of the Hilbert scheme of subschemes of X ×Y in Pr ×Ps
using the Hilbert points of the graphs of the maps f.
Deﬁnition (1.19) (Hilbert schemes of projective bundles) From a Pr
bundle P over Z, we can construct a Hilbert scheme HP,P/Z parame-
terizing subschemes of P whose ﬁbers over Z all have Hilbert polyno-
mial P.
Deﬁnition (1.20) (Relative Hilbert schemes) Given a projective mor-
phism π : X ✲Z × Pr ✲Z, we have a relative Hilbert scheme H pa-
rameterizing subschemes of the ﬁbers of π. Explicitly, H represents
the functor that associates to B the set of subschemes Y ⊂B × Pr and
morphisms α : B ✲Z such that Y is ﬂat over B with Hilbert polynomial
P and Y ⊂B ×Z X.
The following is an application of the fact that Hilbert schemes of
morphisms exist and are quasiprojective.
Exercise (1.21) Show that for any g ≥3 there is a number ϕ(g) such
that any smooth curve C of genus g has at most ϕ(g) nonconstant
maps to curves B of genus h ≥2.
One warning about these variants is in order: the notion of scheme
“of type X” needs to be handled with caution. For example, look at the
following types of subschemes of P2:
1. Plane curves of degree d;
2. Reduced and irreducible plane curves of degree d;
3. Reduced and irreducible plane curves of degree d and geometric
genus g; and,
5Perhaps, more accurately, in view of our omissions, by citing similar arguments.

12
1. Parameter spaces: constructions and examples
4. Reduced and irreducible plane curves of degree d and geometric
genus g having only nodes as singularities.
The ﬁrst family is parameterized by the Hilbert scheme H , which we
have seen in the second exercise above is simply a projective space
PN. The second is parameterized by an open subset Wd ⊂PN. The last
one also may be interpreted in such a way that it has a ﬁne moduli
space, which is a closed subscheme Ud,g ⊂Wd.
The third, however, does not admit a nice quasiprojective moduli
space at all. It is possible to deﬁne the notion of a family of curves
with δ nodes over an arbitrary base — so that, for example, the family
xy −ε has no nodes over Spec(C[ε]/ε2) — but it’s harder to make
sense of the notion of geometric genus over nonreduced bases. For
families of nodal curves, we can get around this by using the relation
g + δ = (d −1)(d −2)/2. One way out is to ﬁrst deﬁne the moduli
space Vd,g to be the reduced subscheme of Wd whose support is the
set of reduced and irreducible plane curves of degree d and geometric
genus g, and to then consider only families of such curves with base
B that come equipped with a map B ✲Vd,g. In other words, we could
let the moduli space deﬁne the moduli problem rather than the other
way around. Unfortunately, this approach is generally unsatisfactory
because we’ll almost always want to consider families that don’t meet
this condition.
C
Tangent space to the Hilbert scheme
Let H be the Hilbert scheme parameterizing subschemes of Pr with
Hilbert polynomial P. One signiﬁcant virtue of the fact that H repre-
sents a naturally deﬁned functor is that it’s relatively easy to describe
the tangent space to H . Before we do this, we want to set up a few
general notions. Recall that the tangent space to any scheme X at a
closed point p is just the set of maps Spec(C[ε]/ε2) ✲X centered
at p (that is, mapping the unique closed point 0 of Spec(C[ε]/ε2)
to p). We will write I for Spec(C[ε]/ε2). More generally, we let
Ik = Spec(C[ε]/(εk+1)) and more generally still
(1.22)
I(l)
k
= Spec(C[ε1, . . . , εl]/(ε1, . . . , εl)k+1),
with the convention, already used above, that k and l are suppressed
when they are equal to 1.
If you’re unused to this scheme-theoretic formalism, you may won-
der: if a tangent vector to a scheme X corresponds to a morphism
I ✲X, how do we add them? The answer is that two morphisms I ✲X
that agree on the subscheme Spec(C) ⊂I (i.e., both map it to the

C. Tangent space to the Hilbert scheme
13
same point p) give a morphism from the ﬁbered sum of I with it-
self over Spec(C) to X. But this ﬁbered sum is just I(2), and we have
a sort of “diagonal” inclusion ∆of I in I(2) induced by the map of
rings C[ε1, ε2]/(ε1, ε2)2 ✲C[ε]/(ε2) sending both ε1 and ε2 to ε; the
composition π ◦∆shown in diagram (1.23) is the sum of the tangent
vectors.
(1.23)
I
❅
❅
❅
❅
∆
❘
I(2)
∥
I ×X I
✲I
❅
❅
❅
❅
π
❘
I
❄
✲X
❄
We’re now ready to unwind these deﬁnitions for Hilbert schemes. Most
directly, if H is a Hilbert scheme and [X] ∈H corresponds to the
subscheme X ⊂Pr , then by the universal property of H a map from
I to H centered at [X] corresponds to a ﬂat family X ✲I of sub-
schemes of Pr × I whose ﬁber over 0 ∈Spec(C[ε]/ε2) is X. Such a
family is called a ﬁrst-order deformation of X. We will look at such
deformations in more detail in Chapter 3.
For the time being, however, there is another way to view its tangent
space that is much more convenient for computations. This approach
is based on the fact that H is naturally a subscheme of the Grassman-
nian G of codimension P(m)-dimensional quotients of Sm. Recall that
any tangent vector to G at the point [Q] corresponding to the quotient
Q of Sm by a subspace L of codimension P(m) in Sm can be identiﬁed
with a C-linear map ϕ : L ✲Sm/L. If ϕ : L ✲Sm is any lifting of ϕ,
then the collection {f + ε · ϕ(f )}f∈I(X)m yields the map from I to G
associated to ϕ. Suppose that L = I(X)m or, in other words, that the
point [Q] is the Hilbert point [X] of a subscheme of Pr with Hilbert
polynomial P and ϕ is given by a map I(X)m ✲(S/I(X)m). Then we
may view the collection {f +ε · ϕ(f)}f∈I(X)m as polynomials deﬁning
a subscheme X ⊂I×Pr . The universal property of the Hilbert scheme
implies that such a tangent vector to G will lie in the Zariski tangent
space to the subscheme H if and only if X is ﬂat over I.
What does the condition of ﬂatness mean in terms of the linear
map ϕ? This is also easy to describe and verify: X will be ﬂat over
I if and only if the map ϕ extends to an S-module homomorphism
I(X)l≥m ✲(S/I(X))l≥m (which we will also denote ϕ). For example,

14
1. Parameter spaces: constructions and examples
if this condition is not satisﬁed, we claim that the exact sequence of
S

C[ε]/ε2 modules
0
✲I(X)
✲S

C[ε]/ε2
✲A(X)
✲0
will fail to be exact after we tensor with the C[ε]/ε2-module C. Indeed,
given any S-linear dependence

αifi = 0 with αi ∈S and fi ∈I(X)
for which

αiϕ(fi) is not 0, the element

αi · (fi + εϕ(fi)) will
be nonzero in I(X)

Spec(C), but will go to zero in S. The converse
implication is left to the exercises.
The map ϕ : I(X)l≥m ✲(S/I(X))l≥m of S-modules determines a
map I ✲OPn/I of coherent sheaves (still denoted by ϕ) where I is
the ideal sheaf of X in Pn. By S-linearity, the kernel of such a map
must contain I2. Putting all this together, we see that a tangent vector
to H at [X] corresponds to an element of Hom(I/I2, OX) (where we
write HomOC(F, G) for the space of sheaf morphisms F ✲G, that is,
the space of global sections of the sheaf HomOC(F, G)). Note that if
X is smooth, the sheaf Hom(I/I2, O) is just the normal bundle NX/Pr
to X. By extension, we’ll call this sheaf the normal sheaf to X when X
is singular (or even nonreduced). With this convention, the upshot is
that the Zariski tangent space to the Hilbert scheme at a point X is the
space of global sections of the normal sheaf of X:
(1.24)
T[X]H = H0(X, NX/Pr ).
Exercise (1.25) Verify that the family X ⊂Pr × Spec(C[ε]/ε2) in-
duced by an S-linear map ϕ : I(X)l≥m ✲(S/I(X))l≥m is indeed ﬂat as
claimed.
Exercise (1.26) Determine the normal bundle to the rational normal
curve C ⊂Pr and show, by computing its h0, that the Hilbert scheme
parameterizing such curves is smooth at any point corresponding to
a rational normal curve.
Exercise (1.27) Similarly, show that the Hilbert scheme parameteriz-
ing elliptic normal curves is smooth at any point corresponding to an
elliptic normal curve.
Warning. As we remarked in the last section, the Hilbert scheme, by
deﬁnition, parameterizes a lot of things you weren’t particularly eager
to have parameterized. The examples that we’ll look at in the next sec-
tions will make this point painfully clear. For now, let’s return to the
example of twisted cubics. These form a twelve-dimensional family
parameterized by a component D of the Hilbert scheme H3m+1,3 of
curves in P3 with Hilbert polynomial 3m+1. But H also has a second
irreducible component E, whose general member is the union of a

C. Tangent space to the Hilbert scheme
15
plane cubic and an isolated point: this component has dimension 15.
A general point of the intersection corresponds to a nodal plane cubic
with an embedded point at the node, and at such a point the dimen-
sion of the Zariski tangent space to H is necessarily larger than 15.
In particular, it’s hard to tell whether the component D ⊂H whose
general member is a twisted cubic — the component we’re most likely
to be interested in — is smooth at such a point. That both compo-
nents are, in fact, smooth, has only recently been established by Piene
and Schlessinger [130]. We will return to this point in Chapter 3. The
exercises that follow establish some easier facts which will be needed
then.
Exercise (1.28) Verify that the tangent space to H at a general point
[X] of intersection of the two components of H has dimension 16.
Hint: In this example, the minimum degree m that has the proper-
ties needed in the construction of H is 4 and it’s probably easiest to
explicitly calculate the space of C-linear maps ϕ : I(X)4 ✲(S/I(X))4
that kill I(X)2.
A theme that will be important in later chapters is the use of the
natural PGL(r +1)-action on Hilbert schemes of subschemes of Pr . In
the Hilbert scheme H of twisted cubics, this can be used to consider-
able effect because each component has a single open orbit, namely,
that of the generic element. Hence there are only ﬁnitely many orbits.
Since, by construction, the Hilbert scheme is invariant for the natural
PGL(r + 1)-action on G, its singular loci are also invariant (i.e., unions
of orbits) and can be analyzed completely.
Exercise (1.29) 1) Use the Borel-ﬁxed point theorem to show that
every subscheme of Pr has a ﬂat specialization that is ﬁxed by the
standard Borel subgroup of upper triangular matrices. Conclude that
every component of a Hilbert scheme H contains a point parameter-
izing a Borel-ﬁxed subscheme.
2) Show
that
there
are
exactly
three
Borel-ﬁxed
orbits
in
H = H3m+1,3:
• a spatial double line in P3 (that is, the scheme C deﬁned by the
square of the ideal of a line in P3 );
• a planar triple line plus an embedded point lying in the same
plane as the line;
• a planar triple line plus an embedded point not lying in the same
plane as the line.
3) Show also that these orbits lie in D only, in E only and in D ∩E
respectively. Conclude that H has exactly two components.

16
1. Parameter spaces: constructions and examples
4) Show that the tangent space to H at points of each of the three
orbits in 2) is of dimension 12, 15 and 16 respectively and that in each
case the normal sheaf has vanishing h1.
5) Show that the Hilbert scheme H of twisted cubics contains ﬁnitely
many PGL(4)-orbits. How many lie in D alone? in E alone? in D ∩E?
A few remarks about this example are in order. First, the lexi-
cographic ideal of H (whose degree m piece consists of the ﬁrst
dim(Sm) −P(m) monomials in the lexicographic order) deﬁnes a pla-
nar triple line plus a coplanar embedded point. Note that this scheme
isn’t a specialization of the twisted cubic and that the minimal m0 sat-
isfying the hypotheses of the Uniform m lemma (1.11) for this scheme
is 4. On the other hand, an inspection of the ideals of curves in the list
from 2) of the preceding exercise shows that m0 = 3 works for every
orbit in the “good” component of D. In general, the least m0 that can
be used in the construction will be much greater than the least m0
that works for ideals of smooth (or even reduced) subschemes with
the given Hilbert polynomial.
This annoying discrepancy is unfortunately just about the only way
in which H is a typical Hilbert scheme. The existence of any smooth
component of a Hilbert scheme (even those parameterizing complete
intersections) is extremely rare.
Exercise (1.30) Generalize the scheme C in the preceding exercise to
a multiple line which is a ﬂat specialization of a rational normal curve
in Pr and show that for r > 3 the corresponding Hilbert scheme is
not smooth at [C].
How else is the twisted cubic example misleadingly simple? Com-
ponents of the Hilbert scheme whose general member isn’t connected
(let alone irreducible) are in fact the rule rather than the exception.
For example, in the Hilbert scheme Hd,g,r of curves of degree d and
genus g in Pr , there will be component(s) Cd,g′,r whose general ele-
ment C consists of a curve of geometric genus g′ > g plus (g′ −g)
points (so that pa(C) = g and C has the “correct” Hilbert polynomial
P(m) = md−g+1). Worse yet, for large enough d the Hilbert scheme
of zero-dimensional subschemes of P3 of degree d will have, in addi-
tion to the “standard” component whose general member consists of d
distinct points, components whose general member is nonreduced —
though no one knows how many such components the Hilbert scheme
will have, or what their dimensions might be. So, for large d, there will
be component(s) Cd,g′,r whose general element C consists of a curve of
geometric genus g′ > g plus a subscheme of dimension 0 and degree
(g′ −g) lying on one of these “exotic” components. As in the twisted
cubic example, such components will often (always?) have dimension

C. Tangent space to the Hilbert scheme
17
greater than that of the components that parameterize honest curves
of genus g.
To avoid having to rule out such components repeatedly, it’ll be
convenient to make the
Deﬁnition (1.31) The restricted Hilbert scheme R is the open sub-
scheme of H consisting of those points [X] such that every component
D of H on which [X] lies has smooth, nondegenerate, irreducible gen-
eral element. In other words, the restricted Hilbert scheme is the com-
plement of those irreducible components of H every point of which cor-
responds to a curve that is singular, degenerate or reducible.
What we would really like to do is to take the (closed) union R of all
the components D so as to have a projective scheme but unfortunately
there is no natural scheme structure on D at points where it meets
components outside of R. We can, of course, speak of the restricted
Hilbert variety R by giving this set its reduced structure but then
maps to R will no longer correspond to families of subschemes of Pr .
One further warning: it’s almost never possible to analyze all Borel-
ﬁxed subschemes explicitly. As a result, even when it is possible to list
the components of a Hilbert scheme — restricted or not — it usually
requires considerable effort to verify that no others exist. The dis-
cussion of Mumford’s example in the next section will illustrate this
point.
One of the very few positive results about the global geometry of
Hilbert scheme is Hartshorne’s
Theorem (1.32) (Connectedness Theorem [83]) For any P and r,
the Hilbert scheme HP,r is connected.
Hartshorne’s proof involves ﬁrst showing that every X specializes
ﬂatly to a union Y of linear subspaces that he calls a fan. In fact,
there is an explicit procedure for translating between the coefﬁcients
of P and the number of subspaces of each dimension in Y. Next,
Hartshorne characterizes those Y whose ideals have maximal Hilbert
function: these are the tight fans for which the i-dimensional sub-
spaces lie in a common (i + 1)-dimensional subspace. He then shows
that all tight fans lie on a common component of H . Finally, he shows
that, if Y is a fan that isn’t tight, then there is a fan Y ′ whose Hilbert
function majorizes that of Y and a sequence of generalizations and
specializations connecting Y and Y ′.
The next exercise uses Hartshorne’s theorem to characterize Hilbert
polynomials of projective schemes; we should point out that this char-
acterization, due to Macaulay [111] (see also, [144]), came ﬁrst and is
a key element of Hartshorne’s proof.

18
1. Parameter spaces: constructions and examples
Exercise (1.33) 1) Calculate the Hilbert polynomial P(n0,n1,...,nr )(m)
of a generic (reduced) union
	r
i=0(Li1 ∪· · · ∪Lini) where each Lij is
an i-plane in Pr .
2) Deﬁne
Q(a0,a1,...,as) =
s
i=0

m + i
i + 1

−

m + i −ai
i + 1

.
Show that any rational numerical polynomial P(m) — i.e., an element
of Q[m] that takes integer values for integer m — can be expressed
as
Q(a0,a1,...,as)(m)
for unique nonnegative integers ai with as ≠0.
3) Deﬁne a mapping (n0, n1, . . . , nr ) ✲(a0, a1, . . . , as) by requiring
that
P(n0,n1,...,nr )(m) = Q(a0,a1,...,as)(m).
Show that the image of this map is exactly the set of (a0, a1, . . . , as)
for which a0 ≥a1 ≥· · · ≥as.
4) Use the ﬁrst step of Hartshorne’s proof to deduce Macaulay’s The-
orem [111]: a numerical polynomial is the Hilbert polynomial of a pro-
jective variety if and only if the sequence (a0, a1, . . . , as) of 2) is non-
increasing.
There is little convincing evidence either for or against the con-
nectedness of the restricted Hilbert variety or its closure R: known
examples have so far provided neither a counterexample nor a plausi-
ble replacement for the class of fans used in Hartshorne’s proof. See,
however, Exercise (1.41) on H9,10,3 in Section D.
D
Extrinsic pathologies
The difﬁculties we’ve discussed above are relatively minor annoy-
ances. We will see much nastier behavior in the examples that follow.
The gist of these examples can be summed in:
Law (1.34) (Murphy’s Law for Hilbert Schemes) There is no ge-
ometric possibility so horrible that it cannot be found generically on
some component of some Hilbert scheme.
To illustrate the application of this law, and as an example of a
tangent-space-to-the-Hilbert-scheme calculation, we now wish to re-
call Mumford’s famous example [118] of a component J of the (re-
stricted) Hilbert scheme of space curves that is everywhere nonre-
duced. This example also serves to justify the somewhat technical

D. Extrinsic pathologies
19
construction of the Hilbert scheme. Most of the work there was de-
voted to producing, not the underlying subvariety of the Grassman-
nian G = G(P(m), Sm), but a natural scheme structure on this sub-
variety. Mumford’s example shows that this scheme structure can be
far from reduced. Moreover, since the general point of J is a perfectly
innocent-looking (i.e., smooth, irreducible, reduced, nondegenerate)
curve in P3, it shows that we cannot hope to avoid these complica-
tions simply by restricting ourselves to subschemes of Pr that are
sufﬁciently geometrically nice. The point is that the behavior of fam-
ilies X of subschemes of Pr can exhibit many pathologies even when
the individual members X of the family exhibit none. These phenom-
ena are usually caused by constraints imposed by the particular mod-
els of the ﬁbers that the Hilbert scheme in question parameterizes.
In the examples dealing with space curves that follow, this constraint
typically takes the form of a condition that the curve C corresponding
to any point on some component of the relevant Hilbert scheme H
lies on a surface of some small ﬁxed degree. One of the motivations
for the study of intrinsic moduli space is the possibility of eliminating
such extrinsic pathologies.
Mumford’s example
The curves we want to look at are those lying on smooth cubic sur-
faces S, having class 4H + 2L where H is the divisor class of a plane
section of S and L that of a line on S. (Recall that, on S, H2 = 3, that
H · L = −L2 = 1, and that KS = −H.) We immediately see that the
degree of such a curve is d = H · (4H + 2L) = 14 and that its arith-
metic genus is g = 1
2 C · (C + KS) + 1 = 24. We are therefore going to
be working with the Hilbert scheme H14,24,3 or, in practice, with the
restricted Hilbert scheme R14,24,3.
Note that the linear series |H + L| is base point free since it’s cut
out by quadrics containing a conic curve C ⊂S coplanar with L. Hence
|4H + 2L| is also base point free and its general member is indeed a
smooth curve (even, as we leave you to verify, irreducible). Finally,
the dimension of the family of such curves isn’t hard to compute.
On a particular cubic S, the linear system |4H + 2L| has dimension
predicted by Riemann-Roch on S as h0(OS(C)) = 1
2 C · (C −KS) = 37.
Since the family of cubic surfaces has dimension 19 and each curve
C of this type lies on a unique cubic (d = 14), the dimension of the
sublocus J3 of H14,24,3 cut out by such C’s is 37 + 19 = 56.
The family J3 of curves C that arises in this way is irreducible. This
can be proved in two ways. The ﬁrst is via the monodromy of the
family of all cubic surfaces in P3. In this approach, one ﬁrst shows
that the monodromy group of this family is E6 and in particular acts

20
1. Parameter spaces: constructions and examples
transitively on the set of lines on a given S. For details, we refer you
to [77]. The second, more elementary, approach is to construct this
family as a tower of projective bundles imitating the argument for
the irreducibility of the family J′
3 given preceding Exercise (1.37). We
leave the details to you, as in that exercise.
The key question is: is J3 (open and) dense in a component of the
Hilbert scheme? To answer this, let C now be any curve of degree 14
and genus 24 in P3. We ask ﬁrst: does C have to lie on a cubic? Now,
the dimension of the vector space of cubics in P3 is 20. On the other
hand, by Riemann-Roch on C, the dimension of H0(C, OC(3)) is
h0(OC(3)) = d −g + 1 + h1(OC(3)) = 19 + h0(KC(−3)),
and since deg(KC(−3)) = 2G −2 −3D = 4, this last term could very
well be positive. Indeed, it is for the curves C constructed above: for
those, KC = OC(KS + C) = OC(C −H) so KC(−3) = OC(2L) which has
h0 = 1. Thus, dimensional considerations alone don’t force C to lie
on a cubic.
Suppose C doesn’t lie on a cubic. We have h0(OP3(4)) = 35, while
h0(OC(4)) = 56 −24 + 1 = 33, so C must lie on at least a pencil of
quartics. Moreover, an element T of such a pencil must intersect the
other elements in the union of C and a curve D of degree 2. Since KT
is trivial, (C · C)T = 2(gC −1) = 46. From the linear equivalence of
C + D and 4H, we ﬁrst obtain C · D = C · (4H −C) = 56 −46 = 10,
then D2 = (4H −C)2 = 64 −112 + 46 = −2, and ﬁnally gD = 0.
This is only possible if C is a plane conic. To count the dimension of
the family of such curves, then, we reverse this analysis, starting with
a conic D, which moves with 8 degrees of freedom. The projective
space Λ of quartics containing D has dimension 25. An open subset
of the 48-dimensional Grassmannian G(1, 25) of pencils in Λ will have
base locus the union of D and a curve C not lying on any cubic. The
dimension of the family J4 of all such C is thus 56. Since the loci J3 and
J4 have the same dimension, we deduce that a general curve of class
4H + 2L on a smooth cubic surface is not the specialization of a curve
not lying on a cubic. This assertion together with the irreducibility of
J3 imply that J3 is dense in a component of the Hilbert scheme.
We return to the examination of a curve C ∼4H + 2L in J3 lying on
a smooth cubic S. It’s easy to calculate the dimension of the space of
sections of the normal bundle of C: the standard sequence
0 ✲NC/S ✲NC/P3 ✲NS/P3
OC ✲0
reads
0 ✲KC(1) ✲N ✲OC(3) ✲0 ,
and since KC(1) is nonspecial, it follows that:
h0(N) = h0(KC(1)) + h0(OC(3))

D. Extrinsic pathologies
21
= 37 + 20
= 57 .
Thus the Hilbert scheme is singular at C, and, since C is generic in J3,
even nonreduced.
What is going on here? It’s not hard to see where the extra dimen-
sion of h0(N) is coming from: if h0(OC(3)) really is 20 for curves near
C, then, at least inﬁnitesimally, deformations of C don’t have to lie on
cubics. Naively, you might expect that near C the locus in the Hilbert
scheme of curves Cλ lying on cubics was the divisor in the Hilbert
scheme given by the determinant of the 20 × 20 matrix associated
to the restriction map H0(P3, O(3)) ✲H0(C, O(Z)); thus the local di-
mension of H near C should be 57. Of course, it doesn’t turn out this
way, but this analysis is nonetheless correct to ﬁrst order. There do,
in fact, exist ﬁrst-order deformations of C that don’t lie on any cubic,
and these account for the extra dimension in the tangent space to H .
If you’ve seen some deformation theory before you may attempt:
Exercise (1.35) Make the analysis above precise. What does it mean
to say that a ﬁrst-order deformation of C doesn’t lie on a cubic? Find
such a deformation.
Deformation theory is discussed in Chapter 3. Until then, even if
you’re unfamiliar with the subject, you should be able to understand
our occasional references to deformations by viewing them as alge-
braic analogues of perturbations which themselves are parameterized
by various schemes.
We’ve shown above that there is a unique component J4 of R whose
general member doesn’t lie on a cubic surface. Are there other com-
ponents besides J3 whose general member does lie on a cubic surface
S? The answer is yes: there is exactly one other. Suppose that C is a
curve in R lying on a smooth cubic surface S. The key observation
is that C must lie on a sextic surface T not containing S: we have
h0(P3, O(6)) = 84, while h0(C, O(6)) = 61 and the space of sextics
containing S has vector space dimension 20. We can thus describe C
as residual to a curve B or degree 4 in the intersection of S with a
sextic.6 (Note that the curves in Mumford’s example are residual to a
disjoint union of two conics in such a complete intersection.)
What does B look like? First off, we can tell its arithmetic genus
from the liaison formula7: if two curves C and D, of degrees d and e
6Similar dimension counting shows that the generic C lies on no surface of degree
less than 6 not containing S.
7To see this formula, use adjunction on S to write
2g −2 = (KS + C) · C = ((m −4)H + C) · C = (m −4)d + C2

22
1. Parameter spaces: constructions and examples
and genera g and h respectively, together comprise a complete inter-
section of surfaces S and T of degrees m and n, then
(1.36)
h −g = (m + n −4)(e −d)
2
.
In the present case, this says that B has arithmetic genus (−1) and
self-intersection 0 on S; in particular B is reducible. One possibility
is that B consists of two disjoint conics; in this case the two conics
must be residual to the same line in plane sections of S and we get the
Mumford component. Otherwise, B must contain a line. For example,
B might consist of the disjoint union of a line L and a twisted cubic E
and, unless B has a multiple line, any other conﬁguration must be a
specialization of this. In this case, the class of C in the Neron-Severi
group of NS(S) will not equal 4H + 2L. Since NS(S) is discrete, the
class of C in it must be constant on any component of R. We therefore
conclude that B’s of this type give rise to component(s) of R distinct
from J3.
To see that just one component J′
3 arises in this way, it’s simplest to
use a liaison-theoretic approach.8 We will simply list the steps, leaving
the veriﬁcations as an exercise. First, the set of all pairs (L, E) is irre-
ducible since the locus of E’s and L’s are PGL(4)-orbits in their respec-
tive Hilbert schemes. Second, over a dense open set in this base, the
set of triples (S, L, E) such that S is a cubic surface containing L ∪E
forms a projective bundle, hence is again irreducible. Third, over a
dense set of these triples, the set of quadruples, (T, S, L, E) such that
T is a sextic surface containing L ∪E but not S is a dense open set in
the ﬁber of a second projective bundle. Finally, these quadruples map
onto a dense subset of J′
3.
Exercise (1.37) Verify the four assertions in the preceding para-
graph.
It remains to deal with the case when B has a multiple line. If B has
a multiple line L, then it must have the form 2L+D, where D is a conic
meeting L once.
Exercise (1.38) Let C be a curve in R14,24,3 that lies on the intersec-
tion of a cubic surface S and a sextic surface T. Suppose, further, that
and conclude that C2
= g −2 −(m −4)d. Then plug this into the equation
nd = C · (C + D) = C2 + C · D, to obtain C · D = (m + n −4)d −(2g −2). By
symmetry, C · D = (m + n −4)e −(2h −2), from which the formula as stated is
immediate.
8The same result can also be obtained by showing that the monodromy group E6 of
the family of smooth cubic surfaces acts transitively on the 432 pairs (E, L) as above
on a ﬁxed S.

D. Extrinsic pathologies
23
C is residual in this intersection to a quartic B of the form 2L + D
with L a line and D a conic meeting L once. Show that L + D is the
specialization of a twisted cubic disjoint from L and hence that C is
a specialization of the generic element of J′
3.
A few additional remarks about this third component are in order.
The ﬁrst is that calculations like those carried out for J3 show that
the dimension of J′
3 is again 56 and that for general [C] in J′
3, OC(3)
is nonspecial. We therefore conclude that this component of R is at
least generically reduced.
The analysis above shows that R14,24,3 has three 56-dimensional
components: the generic elements of J3 and J′
3 lie on smooth cubic
surfaces, and any curve C not lying on any cubic surface is param-
eterized by a point of J4. In principle, there might exist other com-
ponents J∗
3 of R14,24,3 whose general elements lie only on a singular
cubic surface.
Exercise (1.39) Complete the analysis of R14,24,3 by showing that, in
fact, no such J∗
3 exists.
Here are a few more exercises dealing with ideas that arise in Mum-
ford’s example.
Exercise (1.40) Make up your own examples of components of the
Hilbert scheme of space curves that are everywhere nonreduced.
Hartshorne feels that, in some sense, “most” components of the
Hilbert scheme are of this type. Do you agree?
Exercise (1.41) 1) Use an analysis like that above to show that the re-
stricted Hilbert scheme R9,10,3 of space curves of degree 9 and genus
10 has exactly two components J2 and J3.
2) Show further that the general element of J2 is a curve of type (3, 6)
on a quadric surface while the general element of J3 is the complete
intersection of two cubic surfaces, and that both components have
dimension 36.
3) Let C be any smooth curve. Show that if the Hilbert point [C] of
C lies in J3, then KC = OC(2) and hence C is not trigonal while if
[C] ∈J2, then KC ≠OC(2) and hence C is trigonal.
4) Conclude that any curve in the intersection of these components
is necessarily singular. Find such a curve.
In particular, this last exercise shows that the locus of smooth
curves in a Hilbert scheme can form a disconnected subvariety, and
shows that there are, in general, limits to how nice we can make the el-
ements of a restricted Hilbert scheme before it becomes disconnected.

24
1. Parameter spaces: constructions and examples
Other examples
Exercise (1.39) might tempt you to suppose that if every curve on a
component of R lies on a hypersurface S of degree d then, for general
C, we can choose S to be smooth. This, heuristically, should not be
true since it would violate Murphy’s Law of Hilbert Schemes (1.34). We
would like to exhibit next an explicit counterexample.
Our example uses double lines in P3. A double line supported on
the reduced line with equations z = w = 0 is a scheme X whose ideal
has the form
IX = (z2, zw, w2, F(x, y)z + G(x, y)w)
where F and G are homogeneous of degree m. If F and G have no com-
mon zeros, then X has degree 2 and arithmetic genus pa(X) = −m. If
T is a smooth surface of degree (m+1) and L is a line lying on T, then
the class 2L on T will deﬁne a double line of arithmetic genus −m.
In our example, we want to take m = 2 so X is twice the class of a
line L on a smooth cubic. Such an X lies on many quartic surfaces S.
Indeed, the general such S will have equation
f = αx(Fz + Gw) −βy(Fz + Gw) + h
with h ∈⟨z, w⟩2 and α and β suitable constants. A short calculation
shows that this S has a double point at the point (β, α, 0, 0). Geometri-
cally, X is a ribbon: i.e., a line L with a second-order thickening along a
normal direction at each point. Because these normal directions wind
twice around L, X cannot lie on any smooth surface of degree greater
than 3.
Let C be the curve residual to X in a complete intersection S ∩T,
where T is a surface of degree n. Then C has degree 4n −2 and the
liaison formula (1.36) shows that its genus is 2n2 −2n −2. Now a
theorem of Halphen [71] asserts that whenever the degree d and genus
g of a smooth space curve satisfy g > (d2 + 5d + 10)/10, then the
curve lies on a quartic surface. A little arithmetic shows that our C
(and hence any ﬂat deformation of it) satisfy these hypotheses for
all n ≥7. Thus, any deformation C′ of our C still lies on a quartic
surface S′.
We next claim that: such a C′ remains residual to a double line in a
complete intersection of S′ with a surface T ′ of degree n not containing
S′. By the argument above, S′ must also be singular, and we conclude
that for n ≥7, the generic curve in the component of Hn−2,2n2−2n,3
containing C lies on a quartic but that this quartic is always singular.
To see the claim, ﬁrst note that KC′ = OC′(n)(−X) and hence, since
X meets C′ positively, that OC′(n) is nonspecial. By Riemann-Roch,
h0(C′, OC′(n)) = n(4n −2) −(2n2 −2n −2) + 1 = 2n3 + 3. The

D. Extrinsic pathologies
25
dimension of the space of surfaces of degree n in P3 containing C′ is
thus at least

n + 3
3

−(2n2 −3) =

n −1
3

+ 1 .
Since the binomial coefﬁcient on the right is the dimension of the
space of degree n surfaces containing the quartic S′, C′ continues to
lie in the complete intersection of S′ and a surface T ′ of degree n.
Reversing the liaison formula, the curve X′ residual to C′ in S′ ∩T ′
again has degree 2 and genus (−2). Since the curve X has no embed-
ded points and is a specialization of X′, X′ can have no embedded
points itself. This next exercise asks you to show that X′ must then
be a double line and completes the proof of the claim above.
Exercise (1.42) Check that the only X′ with no embedded points,
degree 2 and genus (−2) is a double line.
We will cite only one more pathological example. But to really grasp
the force of Murphy’s Law, we suggest that you make up for yourself
examples of curves exhibiting other bizarre forms of behavior.
Modulo a number of veriﬁcations left to the exercises, we’ll con-
struct a smooth, reduced and irreducible curve C lying in the intersec-
tion of two components of the Hilbert scheme — so that, in particular,
its deformation space (as a subscheme of Pr ) is reducible. To do this,
let S be a cone over a rational normal curve in Pr−1, let L1, . . . , Lr−2 ⊂S
be lines on S, let T ⊂Pr be a general hypersurface of degree m con-
taining L1, . . . , Lr−2 and let C be the residual intersection of T with S.
Assuming m is sufﬁciently large, C will then be a smooth curve (it’ll
pass once through the vertex of S).
Such a C is a Castelnuovo curve, that is, a curve of maximum
genus among irreducible and nondegenerate curves of its degree
m(r −1) −(r −2) = (m −1)(r −1) + 1 in Pr . Now, Castelnuovo
theory [21] tells us that a Castelnuovo curve of that degree in Pr must
lie on a rational normal scroll X on which it must have class either
mH −(r −2)F or (m−1)H +F. On the singular scroll S, H ∼(r −1)F
and these coincide, but in general they are distinct; it follows (at least
as long as r ≥4) that there are two components of the Hilbert scheme
of curves of the given degree and genus whose general members are
Castelnuovo curves.
Exercise (1.43) 1) Show that the curve C discussed above can be de-
formed to a curve on a smooth scroll having either of the classes
mH −(r −2)F or (m −1)H + F and hence that [C] lies on both com-
ponents of the Hilbert scheme of Castelnuovo curves.

26
1. Parameter spaces: constructions and examples
2) Find the dimension of the component of the Hilbert scheme param-
eterizing curves of each type and the dimension of their intersection.
3) Find the dimension of the Zariski tangent space to the Hilbert
scheme at the point [C].
E
Dimension of the Hilbert scheme
We will be returning to the Hilbert scheme later on in the book, and
will do more with it then. We should mention here, though, some of
the principal open questions with regard to H . With an eye to our
intended applications, in the remainder of this chapter we’ll deal only
with Hilbert schemes of curves.
The ﬁrst issue is dimension. To begin with, the description of the
tangent space to the Hilbert scheme of curves in Pr at a point [C] as
the space of global sections of the normal bundle to C gives us an a
priori guess as to its dimension: we may naively expect that
dim H = h0(C, NC) = χ(NC) .
This number is readily calculated from the sequence
0 ✲TC ✲TP3
OC ✲NC ✲0 .
We see that the degree of the normal bundle is
deg(NC) = (r + 1)d + 2g −2;
and then by Riemann-Roch we have
χ(NC) = deg(NC) −(r −1)(g −1)
= (r + 1)d −(r −3)(g −1) .
This number we’ll call the Hilbert number hd,g,r .
Of course, neither of the equalities above necessarily holds al-
ways — nor even, unfortunately, that often. Even worse, the naive
inequalities associated to these estimates (dim(H ) ≤h0(NC) and
h0(NC) ≥χ(NC)) go in opposite directions. It is nonetheless the case
that the dimension inequality
(1.44)
dim(H ) ≥hd,g,r := (r + 1)d −(r −3)(g −1)
always holds at points of H parameterizing smooth curves, or more
generally curves that are locally complete intersections. This follows
from a less elementary fact of deformation theory, which we will dis-
cuss in Chapter 3. We can also see it from an alternate derivation of

E. Dimension of the Hilbert scheme
27
the Hilbert number based on a study of tangent spaces to W r
d ’s. This
topic belongs to the theory of special linear series which we’ll take up
in Chapter 5. For now, we recall from [7, IV.4.2.i] that, in any family
of line bundles of degree d on curves of genus g, the locus of those
line bundles having r + 1 or more sections has codimension at most
(r + 1)(g −d + r) = g −ρ in the neighborhood of a line bundle with
exactly r + 1 sections.9 Applying this to the family of all line bundles
of degree d on all curves of genus g, we conclude that the family of
linear series of degree d and dimension r on curves of genus g has
local dimension at least (3g −3)+g −(r +1)(g −d+r)10 everywhere.
Since such a linear series determines a map of a curve to Pr up to the
(r 2 + 2r)-dimensional family PGL(r + 1) of automorphisms of Pr , we
may conclude that
dim(H ) ≥4g −3 −(r + 1)(g −d + r) + r 2 + 2r
= (r + 1)d −(r −3)(g −1).
so the dimension of H is at least the Hilbert number. By way of termi-
nology, we’ll call a component of H general if its dimension is equal to
the Hilbert number, and exceptional if its dimension is strictly greater.
Note one aspect of the Hilbert number: when r = 3, hd,g,3 = 4d is in-
dependent of the genus, while for r ≥4 it decreases with g.
There is another approach to this estimate which is worth mention-
ing since in some cases it yields additional local information. Assume
for the moment that C is smooth, nondegenerate and irreducible and
that OC(1) is nonspecial. Then r ≤d −g. (We don’t necessarily have
equality since we aren’t assuming that C is linearly normal in Pr .) We
can count parameters: the curve C depends on 3g−3 and the line bun-
dle L ∈Picd(C) determined by OC(1) on g. Moreover, close to our ini-
tial choices we continue to have the inequality h0(C, OC(1)) ≤d−g+1.
Hence the choice of the linear subsystem of H0(C, L) of dimension
(r + 1) determines a point in a Grassmannian G(r, d −g) whose di-
mension is (r + 1)(d −g + r). Finally, we must add (r 2 + 2r) pa-
rameters coming from the PGL(r +1)-orbit of each linear system. The
total is exactly hd,g,r . Note that this argument actually proves that
χ(NC/Pr ) = h0(NC/Pr ) = dim(Hd,g,r ) and hence leads to the:
Corollary (1.45) If C is a smooth, irreducible, nondegenerate curve
of degree d and genus g
in Pr
with OC(1) nonspecial, then
9Here ρ is the Brill-Noether number ρ = ρg,r,d := g −(r + 1)(g −d + r).
10In this sum the ﬁrst term expresses the moduli of the curve C, the second the
moduli of the line bundle L of degree d and the third the codimension of the set
of pairs (C, L) with at least (r + 1) sections. Note that this postulation also equals
3g −3 + ρ.

28
1. Parameter spaces: constructions and examples
H1(C, NC/Pr ) = 0 and
dim[C] Hd,g,r = dim T[C]Hd,g,r
= hd,g,r
= (r + 1)d −(r −3)(g −1).
Exercise (1.46) Give an alternate proof that the basic estimate
dim(H ) ≥hd,g,r for the dimension of Hd,g,r holds without the as-
sumption that L = OC(1) is nonspecial as follows:
1) Let C be smooth and irreducible of genus g, let {ω1, . . . , ωg} be a
basis of the holomorphic differentials on C and let L be a line bundle
on C. If D = p1 +· · ·+pd is an effective divisor on C with line bundle
OC(D) ≊L, we may deﬁne a map of ϕD : H0(C, L) ✲Cd by taking
principal parts of sections at the points of the support of D. Show
that the image of this map is the annihilator in Cd of the g × d matrix
MD whose ijth entry is
 pj
p0
ωi
2) Let ξ = {(Λ, M)| Λ ⊂ker(M) } where Λ is an r-dimensional sub-
space of Cd and M is a g × d matrix. The space of quadruples
F = (C, D, V, L) with D an effective divisor on C such that L ≊OC(D)
and V an (r + 1)-dimensional subspace of H0(C, L) maps onto ξ by
taking Λ to be the image of V under the map ϕD and M = MD. Show
that this map is dominant and, by calculating dim(ξ), conclude that
dim(F) ≥hd,g,r + r.
3) Show also that the map from F to Hd,g,r given by forgetting the
choice of D is onto with ﬁber of dimension r and conclude that
dim(Hd,g,r ) ≥hd,g,r .
If we start to compute dimensions of components of H , we see, in
the low-degree examples, only general components. For example, in P3
the lines form a four-dimensional family, conics an eight-dimensional
family, twisted cubics a twelve-dimensional family, etc. It becomes
clear fairly soon, however, that this state of affairs is temporary. For
example, we ﬁnd only exceptional components when we look at the
following: complete intersections of high degree; curves of high de-
gree on quadric or cubic surfaces; determinantal varieties associated
to n × (n + 1) matrices with entries of high degree, etc. The general
question of what the dimensions of the components of H may be
remains very much open. Four questions in particular may be asked:
Question (1.47) 1) For ﬁxed d and r, but possibly varying g, what is
the largest dimension of a component of the restricted Hilbert scheme
Rd,g,r whose general elements are smooth, irreducible and nondegen-
erate?

F. Severi varieties
29
2) For any d, g and r, what is the smallest dimension of a component
of Hd,g,r ? Of course, for r = 3 the answer is 4d, but for r ≥4, the
Hilbert number will be negative for many values of d, g and r, and it’s
very much unknown what the smallest dimension may be. In particu-
lar, it’s conjectured that the only rigid curves — that is, curves that
admit no deformations other than projectivities of Pr — are rational
normal curves; but this remains open.
3) Can we ﬁnd a function σ(g) such that the basic estimate
dim(H ) = hd,g,r holds for any component of H whose image in Mg
has codimension less than σ(g)? This last question is motivated by
the empirical evidence that the expected dimension is correct when
this codimension is small. It’s even possible that σ(g) could be taken
to be roughly equal to g.
4) Does the inequality dim(Hd,g,r ) ≥hd,g,r hold for any component
of a Hilbert scheme of curves? Our motivation for suggesting this
question is the empirical observation that families of singular curves,
which might provide counterexamples, seem to have dimension equal
to the Hilbert number exactly when the curves do not smooth in the
ambient projective space. Consider, for example, the union in P3 of a
line and a plane curve of degree d meeting at a point. If d = 3, the fam-
ily of such curves has dimension 15 (4 for the line plus 2 for the plane
plus 10 for the cubic minus 1 so that the line and cubic meet) which
is less than the Hilbert number 16; however, such curves smooth in
P3 to elliptic normal curves. If d = 4, the family has dimension 20
(4 + 2 + 15 −1) which equals the Hilbert number: such curves are
classic examples of curves that do not smooth in P3.
F
Severi varieties
If we stick to Hilbert schemes parameterizing subcurves of Pr then,
as we’ve seen in Exercise (1.15), the case r = 2 is trivial: the Hilbert
point of a plane curve of degree d is just given by the equation of the
curve. In this case, we can hope to understand much more precisely
the subloci of curves with various geometrically signiﬁcant properties.
In this section, we’ll take some ﬁrst steps in this direction.
We’ve seen that the space of all plane curves of a given degree is
simply a projective space PN where N =
d(d + 3)
2

. What we wish to do
here is to look at the locally closed subvariety of this PN consisting of
curves of degree d and geometric genus g. We introduce three loci:
Deﬁnition (1.48) In the space of plane curves of degree d, deﬁne:
1) Vd,g to be the locus of reduced and irreducible curves of degree
d and genus g;

30
1. Parameter spaces: constructions and examples
2) Ud,g to be the locus of reduced and irreducible curves of degree
d and genus g having only nodes as singularities;
3) V d,g to be the closure of Vd,g in PN.
These are often referred to as Severi varieties. Note that, as with the
restricted Hilbert scheme, Vd,g and V d,g don’t have a natural “para-
metric” scheme structure: that is, there is no known way to deﬁne a
scheme structure on them so that they represent the functor of fam-
ilies of plane curves with the appropriate geometric properties.
On the other hand, the underlying spaces of these varieties are much
better behaved than the Hilbert schemes Hd,g,r for r ≥3. To sum up
the state of our knowledge, we have the:
Theorem (1.49) (Zariski; Harris [80]) For all d and g,
1) Ud,g is smooth of dimension 3d + g −1 = hd,g,2;
2) Ud,g is dense in Vd,g;
3) Vd,g is irreducible.
With the tools we have available at this point, we can’t prove the
irreducibility now or even the fact that the nodal curves are dense in
the curves of genus g, but we can at least verify that the locus of nodal
curves is smooth of the expected dimension (the proof of the second
part will be given in Section 3.B as Corollary (3.46) and of the third
part in Section 6.E). To do this, we look ﬁrst at the variety
Σ = {(C, p1, . . . , pδ)|pi ∈Csing} ⊂PN × (P2)δ.
If we ﬁx (afﬁne) coordinates (x, y) on P2, let aij denote the coefﬁcient
of xiyj in the equation of C and let (xα, yα) be the coordinates of
the node pα, then Σ is given by the α triples of equations
Fα(aij, xα, yα) =

aij(xα)i(yα)j = 0,
Gα(aij, xα, yα) =

i · aij(xα)i−1(yα)j = 0,
and
Fα(aij, xα, yα) =

j · aij(xα)i(yα)j−1 = 0
for all α.
(The ﬁrst equation just says pα is on C and the last two that it’s a
singular point. Just the ability to write down such a simple set of
explicit equations already distinguishes the analysis of Severi varieties
from that of Hilbert schemes in higher dimensions.)
From
these
equations,
we
might
expect
naively
that
dim(Σ) = N + 2δ −3δ = N −δ. In fact, we’ll show that in a
neighborhood of a nodal curve C with nodes p1, . . . , pδ, the variety Σ

F. Severi varieties
31
maps one-to-one to Vd,g by showing that the differential of this map
is injective at C.
Consider, for example, the case δ
=
1. Suppose we’re at a
point (C, p) ∈Σ normalized so that p = (0, 0). The matrix of
partials of F, G and H with respect to x, y and a00 looks like
F
G
H
∂
∂x
0
a20
a11
∂
∂y
0
a11
a02
∂
∂a00
1
0
0
Table (1.50)
The corresponding minor (a20a02 −a112) is nonzero exactly when
C has an ordinary node at p. Note also that all the missing entries
in the ﬁrst column of this matrix are 0 at (C, p). We deduce that at
(C, p), Σ1 is smooth of codimension 3 in PN × P2. Moreover we see
that the projection map π : Σ ✲PN is an immersion at (C, p), with
the tangent space to Σ1 at (C, p) mapping isomorphically to the space
of polynomials of degree d vanishing at p (i.e., having a00=0).
Now, in the general case, if C is a curve with exactly δ nodes
p1, . . . , pδ as singularities, the map from Σ to Pn factors through Σ1
in δ ways by distinguishing each of the pα’s in turn. We can there-
fore represent the locus Vd,g in an analytic neighborhood of C as the
intersection of the images of analytic neighborhoods of the points
(C, pi) ∈Σ1. The tangent space to Vd,g at C is thus the linear space
of polynomials of degree d vanishing at the points pi. But we know
that the pi impose independent conditions on curves of any degree
m ≥d −3 (cf. [7, p. 54, Exercise 11]); it follows that
(1.51)
dim(T[C]Vd,g) = N −δ
and hence that Vd,g is smooth of this dimension. For emphasis, we
again note that
N −δ =
d(d + 3)
2

−
(d −1)(d −2)
2
−g

= 3d + g −1
= hd,g,2.
While we have much better control over Severi varieties than over
more general Hilbert schemes, there are many open problems. We
might ask for a description of the tangent space T[C]Vd,g near a curve

32
1. Parameter spaces: constructions and examples
C having other than nodal singularities. As an example, consider the
variety V = V3,0 of cubics of geometric genus 0 which is a hypersur-
face in the P9 of plane cubics. In the afﬁne plane slice A given by
y2 = x3 + ax + b, the equation of V is ∆= 4a3 + 27b2 = 0. For
(a, b) ≠(0, 0), the cubic C(a,b) corresponding to a point of ∆is nodal
and A∩V is smooth at [C(a,b)]. But C(0,0) is a cuspidal cubic and A∩V
itself has a cusp at [C(0,0)].
The upshot is that, while the locus Ud,g of nodal curves can be com-
pactiﬁed in a natural way to Vd,g, most of its desirable geometric prop-
erties are lost in the process. This leads to the problem: ﬁnd a better
(partial) compactiﬁcation of Ud,g. We would like, at least, a parametric
compactiﬁcation whose tangent space at a point [C] has some natural
description as a linear space of curves of degree d.
There is one known way to improve Vd,g somewhat. Deﬁne Td,g to
be the space of pairs (C, π) where C is a smooth curve of genus g and
π : C ✲P2 is a birational map of degree d. This change of point-of-
view from subvarieties of P2 to maps to P2 may seem to be a somewhat
irrelevant one since Td,g and Vd,g are bijective and both contain Ud,g
as a dense open subvariety. However, these two spaces are not iso-
morphic as varieties. Essentially, Td,g normalizes Vd,g at points [C]
corresponding to curves with cusps. All these observations general-
ize: if you’re interested you’ll ﬁnd a longer discussion in [33].
Exercise (1.52) In the example above show that for (a, b) in ∆but
different from (0, 0) the curve Ca,b has a node at the double root
(x, y) = (−3b
2a, 0) and that the composition of the normalization map
π :
˜
Ca,b ✲Ca,b ⊂P2 with the projection to the x-axis is simply
branched over (x, y) = (0, 3b
a ). Show further that the normalization
˜
Ca,b ≊P1 has equation y2 = x −3b
a and is the ﬁber of a family of P1’s
over ∆−{(0, 0)} which does not extend to all of ∆but which does have
an extension over the normalization ˜∆of ∆.
G
Hurwitz schemes
The last parameter spaces we wish to discuss are perhaps the most
classical ones: the Hurwitz schemes Hd,g, which are parameter spaces
for “maps of curves to P1”, i.e., for branched covers of P1. There are
many variations on their construction in a fairly tight analogy to the
Severi varieties. We could simply try to parameterize pairs (C, π) con-
sisting of a smooth curve C of genus g and a ﬁnite map π : C ✲P1.
Alternately, we can associate to a branched cover its branch divi-
sor B, which, by the Riemann-Hurwitz formula, is a divisor of degree
b = 2d+2g−2 in P1. Since the set of such divisors is canonically a pro-
jective space Pb by associating to B the equation of degree b, unique

G. Hurwitz schemes
33
up to rescaling, that has B as its cycle of zeros, this might seem almost
trivial. Of course, divisors with points of multiplicity greater than d
cannot correspond to any cover so we cannot hope to get a complete
parameter space in this way. A more essential difﬁculty stems from
the fact that the cover C depends on B and the Sd-conjugacy class of
the monodromy homomorphism from π1(P1 −B) into the symmetric
group Sd on a general ﬁber of π: the number of covers with a given
branch locus B and combinatorics of the description of their mon-
odromies thus both depend on the multiplicities of the points in B
itself.
The intersection of all these approaches is the case when all the
branch points of π are simple, that is, when B consists of b distinct
points and hence corresponds to a point in the dense open subset
Bd,g of Pb isomorphic to the quotient by Sb of the complement of
all diagonals in (P1)b. (Such covers thus form a locus analogous to
the locus Ud,g of nodal curves in the case of the Severi variety.) A
straightforward local analysis then yields:
Theorem (1.53) Let 
Hd,g be the set of branched covers of P1 of degree
d and genus g having b = 2d+2g −2 simple branch points. Then,
1) 
Hd,g is an unramiﬁed cover of Bd,g and, hence, is naturally a
smooth quasiprojective variety of dimension
b = 2d + 2g −2 = hd,g,1 .
2) There is a smooth universal family of curves Cd,g: i.e., a diagram
Cd,g
P1 × 
Hd,g
❄

Hd,g
❄
whose ﬁber over a point [π] of 
Hd,g is the covering π : C ✲P1
parameterized by [π].
The key point is that 
Hd,g is a covering space of Bd,g. We will re-
turn to the topic of branched covers in G, and give only a precis here.
First, for any B, we can choose small loops γi around the points bi
in B that generate π1(P1 −B) modulo the single relation

i γi = 1.
Since each branch point is simple, the γi must map to simple trans-
positions τi in Sd satisfying

i τi = 1. Since the cover is connected,

34
1. Parameter spaces: constructions and examples
the subgroup generated by the τi must be transitive. Conversely, any
choice, up to simultaneous Sd conjugacy, of τi’s meeting these condi-
tions determines a unique connected cover simply branched over B.
The rest follows easily. The Hurwitz variety has one other property
that lies somewhat deeper and that we have therefore set off.
Theorem (1.54)

Hd,g is connected. Equivalently, in view of (1.53).1,

Hd,g is irreducible.
The connectedness depends on an analysis (ﬁrst carried out by
Klein, Clebsch, L¨uroth and Hurwitz) of the braid monodromy of 
Hd,g
over Bd,g. Essentially, this involves calculating the action of certain
loops in Bd,g on the combinatorial description of the monodromy of
a cover [π] in 
Hd,g and then building a loop that takes a given com-
binatorial description to a standard one. The classic reference is [26];
a good modern one is Moishezon’s paper [115].
Clearly, 
Hd,g is too small for many purposes. When we try to en-
large it naively, however, we run into trouble. When the map C ✲P1
has nonstandard ramiﬁcation (i.e., the branch divisor B has multiple
points), then the number of possible combinatorial forms for the mon-
odromy drops. Hence the most we can hope for is to extend 
Hd,g to a
ramiﬁed cover Hd,g of some compactiﬁcation of Bd,g of Bd,g.11 What-
ever B we choose, the existence of a universal family of curves C and
maps π becomes a much more subtle question. All that is clear is that

Hd,g will be a dense open subset in the space Hd,g no matter how we
deﬁne the latter.
When we return to this subject in more depth in Section 3.G, we’ll
study a very pretty and useful resolution of this difﬁculty, due to
Knudsen and Mumford. The key idea is to ﬁnd a compactiﬁcation Bd,g
of Bd,g in which branch points always remain distinct: this deﬁnition
then leads one naturally to the compactiﬁcation of 
Hd,g by the space
Hd,g of admissible covers; this has virtually all of the properties we
might desire.
11The obvious compactiﬁcation Pb is ruled out by degree considerations as noted
above

Chapter 2
Basic facts about moduli
spaces of curves
This chapter is an essentially expository one which summarizes the
major approaches to the construction of moduli spaces of curves and
states some of the most important results and open problems about
their local and global geometry.
We have two principal reasons for inserting this summary. The ﬁrst
is to introduce the topics that will occupy the remainder of the book.
The second is to state a number of important results that do not reap-
pear. Indeed, a careful treatment of all the results stated in this chap-
ter would be impossible in a single volume. Rather than simply passing
such results by, we’ve chosen to record their statements and provide
references for them here.
Even with this proviso, this chapter is far from complete. Our choice
of results reﬂects our tastes and interests and we ask your indulgence
if your own preferences differ from ours.
A
Why do ﬁne moduli spaces of curves
not exist?
Most of the moduli spaces of curves that we’ll be studying are only
coarse moduli spaces. The obstructions to representing the corre-
sponding moduli functors (equivalently, to constructing ﬁne moduli
spaces) come from automorphisms of the data of the problems.
In this section, we wish ﬁrst to give some elementary examples
which illustrate the phenomena involved and then to take a look at
the various approaches which have been developed to work around
them. We begin by looking again at moduli of curves of genus 1.

36
2. Basic facts about moduli spaces of curves
Recall that in Exercise (1.6), we constructed an algebraic family
X = {y2 = x(x −1)(x −λ)} ⊂P2
x,y × A1
λ
A1
λ
ϕ
❄
−{0, 1}
of smooth curves of genus 1 in which every such curve appears. More-
over,
Xλ ≊Xλ′ ⇐⇒λ′ ∈

λ, 1 −λ, 1
λ,
1
1 −λ, λ −1
λ
,
λ
λ −1

and there is a j-map j : A1
λ ✲A1
j whose ﬁbers are these S3-orbits. In
other words, the j-line is a coarse moduli space for curves of genus 1.
Exercise (1.6) gave two ways of seeing that the j-line was not a ﬁne
moduli space. Here, we want to see this from yet a third point of view.
If the j-line were a ﬁne moduli space, there would be a universal
curve 1 : C ✲A1
j and a ﬁber-product diagram
X
J ✲C
A1
λ
ϕ
❄
j ✲A1
j
❄
1
Thus the S3-action on A1
λ would have to lift to X. What could the
lifting of the involution λ ✲1 −λ be? Since Xλ is the curve ramiﬁed
over 0, 1, λ and ∞, this lift would have to look like
(x, y, λ) ✲(1 −x, ±iy, 1 −λ).
Either of these choices acts nontrivially on the ﬁber X1/2 and the quo-
tient of X by this involution would have a rational ﬁber over 1/2. (In
fact, X1/2 is the curve corresponding to the lattice C2/(Z1 + Z
√
−1)
which has j-invariant 1728 and the involution above is the extra au-
tomorphism of order 2 of this lattice.)
There is also a more global obstruction to lifting λ due to the fact
that multiplication by (−1) is an automorphism of any elliptic curve.
Either of the potential choices for the lifting above has order 4 on X:
(x, y, λ) ✲(1 −x, ±iy, 1 −λ) ✲(x, −y, λ).
In other words, while the square of such a candidate lifting would
give an automorphism of Xλ, this automorphism would have to be
nontrivial.

A. Why do ﬁne moduli spaces of curves not exist?
37
There are a number of approaches to dealing with the obstructions
to the existence of ﬁne moduli spaces due to automorphisms. To sim-
plify, we’ll restrict our discussion to moduli problems of curves but
all these techniques are more generally applicable.
The simplest is to eliminate the locus of varieties with automor-
phisms.1 If M is the coarse moduli space for a moduli problem F in
which we’re interested, we’ll denote by M0 the locus of curves C in M
such that Aut(C) = {idC}. This will, in general, be a ﬁne moduli space
for the open subfunctor of F of “curves without automorphisms”. This
solution is often extremely unnatural since our interest in the objects
of M may be completely unrelated to their automorphisms. Moreover,
we can almost never hope to ﬁnd complete moduli spaces without al-
lowing some varieties with automorphisms. On the other hand, the
complement of M0 is often of high codimension in M — for example,
in the moduli space Mg of smooth curves of genus g, M0
g has codi-
mension g −2 for g ≥2 — so this approach does allow us to use a
ﬁne moduli space to deal with many low-codimension questions.
The second approach is to ﬁnd some extra structure that can be
added to the moduli problem that is sufﬁciently ﬁne that no auto-
morphisms of an underlying curve can ﬁx the extra structure. This ap-
proach is called rigidifying the problem. For curves, the most common
extra structures to use are sets of marked or distinguished smooth
points on the curve and level structures.
The existence of the bound 84(g −1) for the order of the automor-
phism group of a smooth curve C of genus g ≥2 in terms of g alone
ensures that no nontrivial automorphism of such a curve can ﬁx n
distinct points of C for any sufﬁciently large n: thus we get a ﬁne
moduli space, denoted Mg,n, for such marked curves. The defect of
this approach is that each marked point increases the dimension of
the moduli space by 1. This makes it unclear how much of the geome-
try of the original moduli space of unmarked curves can be captured
from that of the marked curves. On the other hand, there are a num-
ber of interesting geometric questions that deal directly with marked
curves so these spaces often arise naturally.
Level structures are a second method of rigidifying moduli prob-
lems that avoid changing the dimension of the moduli space. A full
level n structure on a curve C of genus g is a symplectic basis
{α1, . . . , αg, β1, . . . , βg} for H1(C, Z/nZ): here symplectic means that,
in terms of the basis, the intersection pairing on H1(C, Z/nZ) has ma-
1Here, and in the rest of this chapter, we’ve allowed ourselves to use the phrases
“with/without automorphisms” as an admittedly slightly abusive shorthand for
“with/without automorphisms other than the identity”.

38
2. Basic facts about moduli spaces of curves
trix of the form


0 Ig
−Ig 0

.
This data is equivalent to the choice of a basis (L1, . . . , L2g) of the
space Jac(C)n of n-torsion points in the Jacobian of C that is symplec-
tic with respect to the Weil pairing on this space. The moduli space of
curves of genus g with full level n structure is denoted M(n)
g . Since the
spaces H1(C, Z/nZ) (or Jac(C)n) are isomorphic as symplectic spaces
for every curve C, we have a ﬁnite Galois covering map M(n)
g
✲Mg
with Galois group Sp(2g, Z/nZ) that is unramiﬁed exactly over M0
g.
Monodromy arguments — see [77] — show that these covers are all
connected.
Another way to rigidify moduli spaces of curves so as to obtain
ﬁnite coverings is to use ordered sets of Weierstrass points on the
curve. This isn’t enough to get a ﬁne moduli space over the locus of
hyperelliptic curves (why?) so sets of higher-order Weierstrass points
are also sometimes used. The covers obtained by these methods have
somewhat larger ramiﬁcation loci: using ordinary Weierstrass points
yields a cover that is ramiﬁed over curves without automorphisms
but having Weierstrass points of weight greater than 1. When such
coverings are connected is very much an open question that has only
been settled by ad hoc methods in a few cases.
Exercise (2.1) 1) Show that, for n ≥3, no curve of genus g ≥1 with
level n structure has any automorphisms — i.e., there does not exist
a curve C and an automorphism ϕ of C ﬁxing all points of order n on
Jac(C).
2) Show that this is false for n = 2.
3) Show that the map j : A1
λ ✲A1
j discussed above is the covering map
M(2)
1
✲M1 associated to level two structures of curves of genus 1.
4) Show that, although the ﬁber of family ϕ : X ✲A1
λ over λ is the
curve with level two structure whose moduli point is λ, the space A1
λ
is not a ﬁne moduli space for curves of genus 1 with level 2 structure.
This example shows the need to use the notion of a “universal fam-
ily” with care: the existence of a family over a coarse moduli space
with the correct ﬁbers need not imply the universal functorial prop-
erty that characterizes the universal family over a ﬁne moduli space.
Exercise (2.2) Consider the family of curves x3 +y3 +z3 +m ·xyz,
parameterized by the afﬁne line A1 with coordinate m.
1) Find the open set U in A1 over which the ﬁbers in this family are
smooth, and compute the j-function j = j(m) on U.

A. Why do ﬁne moduli spaces of curves not exist?
39
2) Show that j expresses U as a Galois cover of the j-line, with Galois
group SL2(Z/3Z).
3) Show that U is a ﬁne moduli space for curves of genus 1 with full
level 3 structure.
Hint: The curves in this family are the plane cubics whose ﬂexes are
located at [0, 1, −ω], [−ω, 0, 1] and [1, −ω, 0] where ω is a primitive
cube root of unity.
Exercise (2.3) Show that there does not exist a universal family of
curves of genus 2 over any open subset U ⊂M2. In general, if
Hg ⊂Mg is the locus of hyperelliptic curves, for which g does there
exist a universal family over some open subset U ⊂Hg? Answer: For
g odd.
Exercise (2.4) Construct examples of:
1) A nontrivial family of smooth curves of genus 3 over a smooth,
one-dimensional base B, all of whose ﬁbers over closed points are
isomorphic.
2) A map ϕ : B ✲M3 from a smooth curve B to M3 that doesn’t come
from any family of curves of genus 3 over B.
3) A map ϕ : B ✲M3 from a smooth surface B to M3 that doesn’t
come from any family of curves of genus 3, but whose restriction to
each open set Uα of a cover of B does.
To say that a moduli functor doesn’t admit a ﬁne moduli space sim-
ply means that it cannot be represented in the category of schemes.
The third approach to this failure is to look for a larger category
in which the functor can be represented. In order to make such an
approach worthwhile, we must understand the larger category well
enough to be able to carry out geometric investigations in it. If this
can be achieved, it becomes a matter of taste whether the advantages
of having a moduli space with good universal properties are sufﬁcient
compensation for the additional technical difﬁculties of working with
these more general objects. The mildest generalization of schemes
that has proven useful is Artin’s category of algebraic spaces [10]. An
algebraic space looks locally like the quotient of a scheme by an ´etale
equivalence relation. Unfortunately, this category is still too small to
provide representing spaces for most moduli problems.
A larger category is that of functors from schemes to sets. This
category has the advantage that moduli functors are, by deﬁnition,
objects in it. What isn’t so clear is how we are to interpret geometric
notions in this category. Here we shall simply state that this can be
done fairly satisfactorily for moduli functors and refer you to Mum-
ford’s seminal article [119] if you want to get a sense of the ﬂavor of

40
2. Basic facts about moduli spaces of curves
the arguments needed. In that paper, Mumford shows how to extend
the notions of invertible sheaf and Picard group to such functors and,
as evidence that it’s possible to work with such notions, calculates the
Picard group of the moduli space of elliptic curves as Z/12Z!
Categories of algebraic stacks are other enlargements of the cate-
gory of schemes that have been widely used to study moduli problems.
Very roughly, a stack — say, the moduli stack of curves of genus g
for concreteness — is itself a category. In our example, typical objects
would be families C ✲A and D ✲B of such curves and a morphism
between two such objects would be a morphism of schemes from B
to A plus an isomorphism of D with the ﬁber product
D ≊B ×A C
✲C
B
❄
✲A
❄
of B and C over A. In essence, twisting by automorphisms is prohib-
ited by deﬁnition. We leave it to you to formulate or ﬁnd the correct
deﬁnition of a morphism between stacks (a task that starts to bring
out the ﬂavor of the subject).
The stack approach has the advantage of being somewhat closer to
geometric intuition: for example, a line bundle on a stack is simply a
system of line bundles on the base of each family, together with, for
each morphism of families as above, an isomorphism of the line bun-
dle associated to the family D ✲B with the pullback to B of the line
bundle associated to C ✲A. We won’t work with stacks here, but we’ll
be working with related notions (see the discussion in Section 3.D). If
you’re interested, you can look at [29] for a ﬁrst discussion of stacks
in the present context; or, if you’re prepared for a considerable effort,
go to [106] for a full treatment. There is also a forthcoming book [14]
that may ﬁnally clear up what has traditionally been a murky area.
The approaches to extending the category of schemes via “cate-
gories of functors” and via “algebraic stack” are not comparable: that
is, neither category faithfully contains the other. There is a com-
mon extension, “ﬁbered categories” due (naturally, as it were) to
Grothendieck [68] which we shall pass by in complete silence.
B
Moduli spaces we’ll be concerned with
We’ve already mentioned the moduli space Mg (though we have yet
to prove its existence). It is the coarse moduli space for smooth, com-
plete, connected curves C of genus g over C. For the rest of this sec-

B. Moduli spaces we’ll be concerned with
41
tion, we use “curve” to abbreviate this package. The space Cg is sim-
ply the coarse moduli space of pairs (C, p) where C is a curve and
p a point of C. Note that Cg naturally maps to Mg by forgetting the
point p. In fact, Cg may look at ﬁrst glance like a universal curve over
Mg, but on closer examination we see that this is true only over the
open set M0
g: the set-theoretic ﬁber of Cg over a point [C] ∈Mg is
the quotient C/Aut(C). Thus, for example, over an open subset of M2,
C2 is a P1-bundle (in the analytic topology; in the Zariski topology it’s
a conic bundle). This is even true scheme-theoretically in this exam-
ple. You may wish to consider the question: what, in general, are the
scheme-theoretic ﬁbers of the map from Cg to Mg? Despite this, we’ll
occasionally abuse language in order to honor custom by calling Cg
the universal curve over moduli.
The space Mg,n is a direct generalization of Cg: it is the coarse
moduli space for (n+1)-tuples (C, p1, . . . , pn) where C is a curve and
p1, . . . , pn ∈C are distinct points. Thus Cg equals Mg,1. (Because the
justiﬁcation for requiring the points to be distinct comes from the way
in which the compactiﬁcations of these spaces are constructed, we’ll
postpone discussion of it until we come to consider these spaces. One
can also construct moduli spaces involving marked sets of unordered
points (distinct or otherwise); in practice, working with these involves
the additional aggravation of keeping track of the Sd-action without
any compensating advantages so Mg,n is the space most commonly
dealt with.) Once again, it’s tempting to view Mg,n as the open subset
of the ﬁber product Cg ×Mg Cg ×Mg · · · ×Mg Cg obtained by removing
all diagonals; but automorphisms, as for Cg, make this correct only
over a sublocus.
The next space we wish to mention is Pd,g2, the coarse moduli space
of pairs (C, L) where C is a curve and L a line bundle of degree d on
C. Again, the ﬁber of Pd,g over a point [C] ∈Mg corresponding to a
curve C without automorphisms is the connected component Picd(C)
of the Picard variety of C; in particular, P0,g is sometimes called the Ja-
cobian bundle over moduli. Despite the fact that all the ﬁbers Picd(C)
of the varieties Pd,g for various values d are isomorphic over M0
g, Pd,g
will not in general be isomorphic to Pd′,g even over M0
g: see the ex-
ercises below. For example, it follows from the Harer-Mestrano proof
of the Franchetta conjecture (discussed later in this chapter; or see
[112]) that P0,g ≊Pd,g if and only if (2g −2)|d. We may, however,
note that
Pd,g ≊Pd+2g−2,g
and
Pd,g ≊P−d,g ,
2Also denoted Jacd
g in some references.

42
2. Basic facts about moduli spaces of curves
the isomorphisms being provided by the maps (C, L) ✲(C, L

KC)
and (C, L) ✲(C, L−1) respectively. Thus, for each g there can be at
most g of these objects — P0,g, . . . , Pg−1,g — that are distinct up to iso-
morphism. Note also that in the special case d = g−1 there is a natural
theta-divisor θ in Pg−1,g, restricting on each ﬁber to the correspond-
ing class: it’s the locus of pairs (C, L) in Pg−1,g with H0(C, L) ≠0.
Beware, however, that we cannot, as for individual curves, deﬁne such
a class in every degree.
Exercise (2.5) Show that for d = 0, . . . , g −2 there does not exist
any line bundle on Pd,g whose restriction to the ﬁber Picd(C) of Pd,g
over a general point [C] ∈Mg is the line bundle associated to some
translate of the Θ-divisor on Picd(C) ≊J(C).
Exercise (2.6) Show that no two of the moduli spaces P0,g, . . . , Pg−1,g
are isomorphic.
For a general curve C of genus g ≥1, the Jacobian J(C) has Picard
number (i.e., rank of Neron-Severi group) equal to 1 and the Neron-
Severi group is generated by a translate of the Θ divisor. It follows
that for each d and g, the Picard group of Pd,g has rank 1 over the
Picard group Pic(Mg), with the generator restricting to some multiple
m(d, g)·Θ of the general ﬁber of Pd,g over Mg, and we may ask what
the coefﬁcient m(d, g) is for each d and g. For example, the existence
of the natural theta-divisor θ ⊂Pg−1,g shows that m(g −1, g) = 1 for
all g. But, m(d, g) = 1 only rarely. The following exercise suggests
some of the naive ways of approaching the problem; following it, we’ll
give the general formula for m(d, g) found by Kouvidakis.
Exercise (2.7) 1) Show that m(0, g) ≠1.
2) Show that the locus of pairs (C, L) where L is a line bundle on C of
the form OC(p1 + · · · + pg−1 −(g −1)p) with p a Weierstrass point
on C forms a divisor in P0,g. Use this to deduce that m(d, g)|(g3 −g)
for any d and g.
3) Show that there exists a divisor on Cg whose ﬁber over a gen-
eral point [C] ∈Mg is a canonical divisor on C, and deduce that
m(d, g)|(2g −2) for any d and g.
4) Find an example where m(d, g) = 5.
Theorem (2.8) (Kouvidakis [105]) For all d and g,
m(d, g) =
2g −2
gcd(2g −2, g + d −1) .

C. Constructions of Mg
43
C
Constructions of Mg
As we indicated earlier, every construction of the moduli space Mg
amounts to looking a priori at curves with some additional structure,
so that a parameter space can be described, and then taking the quo-
tient of this space by the relation that identiﬁes these additional struc-
tures. In this section, we look at the three most common approaches.
The Teichm¨uller approach
Here we consider the space of pairs (C; γ1, . . . , γ2g) where C is a curve
and {γ1, . . . , γ2g} is a normalized set of generators for π1(C) — that
is, one that may be drawn (in genus 2) as shown in Figure (2.9). This
Figure (2.9)
is equivalent to choosing a homeomorphism of the underlying topo-
logical manifold of C with the National Bureau of Standards’ compact
orientable surface X0 of genus g, up to isotopy. The basic theorem
here, due to Bers [15], then says that: the space of such data is natu-
rally an open subset Tg in C3g−3 homeomorphic to a ball. This open set
is called Teichm¨uller space. The group Γg of diffeomorphisms of X0
modulo isotopy then acts on Teichm¨uller space, and we may realize
the moduli space Mg as the quotient of this action. Note that since
the stabilizer of any point is ﬁnite (it’s simply the group of automor-
phisms of the underlying curve C), this quotient exists as an analytic
variety.
Probably the most important thing about this approach is that it
gives us a handle on the topology of Mg: since Mg is a quotient of
a contractible space by the group Γg, we see that for small k, the co-
homology groups Hk(Mg, Q) are just the cohomology groups of the
group Γg tensored with Q. We may then try to calculate these by ex-
amining an action of Γg on another contractible space N .3 By using a
more tractable N that is combinatorially deﬁned, this approach has
3We only get information about the rational cohomology because Γg has ﬁnite iso-
topy subgroups at points of Tg corresponding to curves with automorphisms. There
is, however, an analogue Tg,n of Tg parameterizing marked surfaces of genus g with
n marked points (or to use the indigenous terminology, with n punctures) from which

44
2. Basic facts about moduli spaces of curves
been fruitfully exploited by Harer (whose results we’ll describe later)
and, more recently, by Kontsevich.
We should also mention that this approach provides Mg with a nat-
ural metric, called the Weil-Petersson metric whose positivity proper-
ties have been used by Wolpert ([153], [154]) to construct an embed-
ding of Mg in a projective variety with many of the nice properties of
the Deligne-Mumford stable compactiﬁcation which we will introduce
later in this section. An excellent survey of what is known along these
lines can be found in the paper of Hain and Looijenga [70].
The Hodge theory approach
The idea here is to associate to a curve C the data of its polarized Jaco-
bian: this amounts to giving a complex vector space V of dimension g
with lattice Λ ≊Z2g and skew-symmetric form Q. Respectively, these
ingredients are naturally obtained from C as: the dual of H0(C, KC);
the ﬁrst homology group H1(C, Z); and the intersection pairing. If we
choose a symplectic basis β = {a1, . . . , ag, b1, . . . , bg} for H1(C, Z) and
a complex basis ω1, . . . , ωg of H0(C, KC) whose period matrix with
respect to the a-cycles is Ig, we may in turn associate to these data
the period matrix P ∈Cg2 given by integrating the ω’s around the
b-cycles. The Riemann bilinear relations then say that P is symmet-
ric with positive deﬁnite imaginary part. These last two conditions
deﬁne, respectively, a subspace and an open subset of the space of
g × g complex matrices whose intersection is called the Siegel upper
halfspace of dimension g and is denoted hg. The group Sp(2g, Z) of
symplectic changes of basis acts on hg and this action corresponds
exactly to the choice of symplectic basis made above.
Here the main facts are that: period matrices of curves form a lo-
cally closed subset cg of hg; the quotient Ag of hg by Sp(2g, Z) is a
coarse moduli space for abelian varieties of dimension g; and, Mg can
be constructed by restricting this quotient map to the locus cg. Again,
this construction yields Mg only as an analytic space but it has the
important advantage over the Teichm¨uller approach that the group
Sp(2g, Z) by which we’re quotienting is more approachable than Γg.
We pay for this, however, because we can say much less about the
space cg that we’re quotienting. Describing the locus Mg in Ag (or
cg in hg) is the Schottky problem. Formally, a number of solutions
have recently been obtained ([8], [117], [125], [142]) but for practical
the moduli space Mg,n can be constructed by forming a quotient by a suitable group
Γg,n. For n large enough that such marked curves have no automorphisms, we can
obtain information about Hk(Mg,n, Z) by this method.

C. Constructions of Mg
45
purposes — such as determining whether a given period matrix P in
hg lies in cg — they are little help.
This construction has one other important consequence. Since Ag
is a hermitian symmetric domain, it has by [12] a natural Baily-Borel
compactiﬁcation 
Ag. (We will discuss compactiﬁcations at length be-
low: for the present, when we say that M is a compactiﬁcation of M,
we’ll mean that M is a compact analytic variety that contains M as
an analytic open subset.) The compactiﬁcation 
Ag was historically
the ﬁrst such compactiﬁcation to be constructed [136] and it remains
known as the Satake compactiﬁcation in honor of its discoverer.
Taking the closure of Mg in 
Ag yields a compactiﬁcation of Mg
which we’ll denote by 
Mg and also refer to as the Satake compactiﬁ-
cation. Unfortunately, the Satake compactiﬁcation isn’t modular. Re-
call that this means that 
Mg is not a moduli space for any moduli
functor of curves that contains the moduli functor of smooth curves
as an open subfunctor. (In fact, the points of 
Mg \ Mg do correspond
to isomorphism classes of smooth curves of lower genus, but these
don’t naturally ﬁt into families with curves of genus g. Thus while we
can associate to families of curves with some singular ﬁbers a moduli
map to 
Mg, we can’t go back and interpret subvarieties of 
Mg not
contained in Mg in terms of families of curves.) This greatly lessens
the usefulness of 
Mg for the study of most questions about families
of curves or about Mg itself.
There is one important exception to this last statement. It depends
on the following two properties of 
Mg: ﬁrst, 
Mg is projective; and
second, the codimension of the complement 
Mg \ Mg in 
Mg is equal
to 2 for g ≥3. By intersecting Mg with generic divisors in some large
multiple O(n) of a very ample invertible sheaf on 
Mg through any
point, we see that through any point of Mg there passes a complete
curve lying entirely in Mg. In fact, there is a complete curve through
any ﬁnite collection of points of Mg: see the exercise below. Using a
curve through two points, on which any holomorphic function must
be constant, we see that there are no nonconstant functions on Mg.
Exercise (2.10) Assuming the facts cited above about the Satake
compactiﬁcation 
Mg, show that through any ﬁnite collection of points
of Mg there passes a complete curve lying in Mg. Hint: blowup the
points and use the fact that the pullback to this blowup of a sufﬁ-
ciently large multiple of an ample linear series on 
Mg minus the sum
of the exceptional divisors of the blowup is very ample.
Together these facts show that Mg is neither projective nor afﬁne.
In the next section, we will look at some more reﬁned results about
complete subvarieties of Mg which shed light on where in the range
between these extremes Mg lies.

46
2. Basic facts about moduli spaces of curves
The geometric invariant theory (G.I.T.) approach
This attack is quite distinct in ﬂavor from the previous two. Simply
put, in each of the last two cases, the extra data attached to a curve
C was essentially analytic. Correspondingly, the parameter space of
curves with this extra data was not an algebraic but a complex analytic
variety, and the group acting on this space with quotient Mg was
not an algebraic group. In the G.I.T. approach, however, everything is
algebraic.
The idea is straightforward: for any integer n ≥3, any curve C
may be embedded as a curve of degree 2(g −1)n in projective space
PN = P(2n−1)(g−1)−1 by the complete linear series |nKC|. We may ac-
cordingly attach to a curve C the data of such an embedding — i.e., we
consider pairs consisting of a curve C and an n-canonical embedding
ϕ : C ✲PN. Now, we’ve already seen how to parameterize such pairs:
the family of all such corresponds to a locally closed subset K of the
Hilbert scheme H = H2(g−1)n,g,(2n−1)(g−1)−1 of smooth curves of de-
gree 2(g−1)n and genus g in PN. (Over the open set of smooth curves
in H , the universal curve C carries two natural invertible sheaves,
the hyperplane sheaf, OC(1), and the relative dualizing sheaf, ωC/H ;
K is simply the locus where OC(1) and (ωC/H )⊗n are isomorphic.)
Moreover, the ambiguity in choosing the map ϕ is simply a matter of
choosing a basis for the space H0(C, K⊗n
C ) of n-canonical differentials
on C — in other words, the group PGL(N + 1, C) acts on K, and the
quotient (if one exists) should be Mg.
One
problem
with
this
approach
is
that,
since
the
group
PGL(N + 1, C) is continuous rather than discrete, the existence of a
nice quotient is by no means assured. This is shown by using the tech-
niques of geometric invariant theory, which we’ll discuss later. Assum-
ing, for the moment, that we’ve constructed this quotient, however,
the approach has two signal advantages:
• It exhibits the Mg as a quasiprojective algebraic variety.
• It leads to an explicit, modular projective compactiﬁcation of
Mg.
Brieﬂy, we’ve indicated that it requires some nontrivial work to show
that the quotient K by PGL(N + 1, C) exists. Having undertaken this
work, however, it’s tempting to try to compactify Mg by taking a quo-
tient of the closure K of K in H . However, this is only possible for an
open subset 
K of K containing K. To get an idea of why some such
restriction is necessary, consider the family C(a,b) of smooth cubics
over the afﬁne t-line whose ﬁbers Ct are given by
(2.11)
yz2 = x3 −t2axz2 −t3bz3.

C. Constructions of Mg
47
The curves Ct for t ≠0 are all isomorphic to the smooth curve C1
of genus 1 but the curve C0 is a rational cuspidal curve. Clearly, this
sort of jump discontinuity rules out the existence of any kind of good
moduli space containing both C1 and C0. By varying the choice of a
and b, we can arrange for C1 to have any desired j-invariant so the
blame for this pathology clearly belongs with C0. We’re thus faced with
the problem of determining what abstract curves to admit into the
enlarged parameter space 
K. The right curves, which emerge naturally
from studying this quotienting problem (and, as we’ll see later, from
several other points of view), are stable curves.
Deﬁnition (2.12) A stable curve is a complete connected curve that
has only nodes as singularities and has only ﬁnitely many automor-
phisms.
In view of the connectedness of C, its automorphism group can fail
to be ﬁnite only if C contains rational components. Thus, the ﬁnite-
ness condition can be equivalently reformulated as:
• every smooth rational component C meets the other compo-
nents of C in at least 3 points; or,
• every rational component of the normalization of C has at least
3 points lying over singular points of C.
If we weaken either of these conditions by replacing the number
3 by 2, the resulting curves are called semistable. Geometrically, this
amounts to allowing chains C1, . . . , Ck of smooth rational curves as
subcurves of C. More precisely, saying that we have a chain means
that: C1 and Ck each meet the complement of the chain in C in a single
node; the other Ci are disjoint from this complement; and, each Ci for
i between 2 and (k −1) meets each of Ci−1 and Ci+1 in a single node
and meets no other components of the chain. Later on, we’ll introduce
other notions of stability for curves connected with the quotienting
process and, to distinguish the curves described above, will call them
moduli stable curves or Deligne-Mumford stable curves .
Stable curves with marked points are deﬁned analogously:
Deﬁnition (2.13) A stable n-pointed curve is a complete connected
curve C that has only nodes as singularities, together with an ordered
collection p1, . . . , pn ∈C of distinct smooth points of C, such that the
(n + 1)-tuple (C; p1, . . . , pn) has only ﬁnitely many automorphisms.
As in the deﬁnition of stable curve, the ﬁniteness condition can be
equivalently reformulated as saying that every rational component
of the normalization of C has at least 3 points lying over singular
and/or marked points of C. Also as before, if we weaken either of

48
2. Basic facts about moduli spaces of curves
these conditions by replacing the number 3 by 2, the resulting pointed
curves are called semistable.
As for smooth curves, the arithmetic genus g = h1(C, OC) of a sta-
ble curve C is a primary invariant. As will be veriﬁed in Exercise (3.2),
we can reexpress the genus more geometrically as follows: if C has δ
nodes and ν irreducible components C1, . . . , Cν of geometric genera
g1, . . . , gν, then
(2.14)
g =
ν
i=1
(gi −1) + δ + 1
=
 ν
i=1
gi

+ δ −ν + 1 .
The fact that stable curves of genus g are the right class of curves
to consider is expressed in:
Theorem (2.15) (Deligne-Mumford-Knudsen) There exist coarse
moduli spaces Mg and Mg,n of stable curves and n-pointed stable
curves; and these spaces are projective varieties.
The spaces Mg and Mg,n are called the stable compactiﬁcations of
Mg and Mg,n.
It’s hard to overestimate the importance of having such a modular
compactiﬁcation: i.e., one that is actually a moduli space for a well-
behaved class of (possibly singular) curves. Clearly, being able to deal
with a projective variety like Mg rather than just a quasiprojective
one like Mg allows us to bring to bear many of the tools of projective
algebraic geometry in the study of these spaces; this is what will allow
us, for example, to answer in Section 6.F the classical question about
the unirationality of Mg.
Beyond that, and perhaps even more signiﬁcantly, the existence of a
compact moduli space for curves has changed the way we view them.
Now, anytime we have a one-parameter family of curves {Ct} in pro-
jective space, or simply mapping to projective space — a family of
plane curves acquiring a nasty singularity, or becoming reducible or
nonreduced, or a family of branched covers of P1 in which a large
number of branch points coalesce at once — we know that however
wild the singularities of the ﬂat limit C0 of these curves, there is also a
well-deﬁned limit of the arc {[Ct]} ⊂Mg; in other words, a canonical
limit Y0 of the abstract curves Ct that has only nodes as singularities
and whose geometry will illuminate that of the curve C0. This notion,
expressed formally in Proposition (3.47), underlies almost all of the
constructions and applications in this book. It would not be an exag-
geration to say that Theorem (2.15) has played as fundamental a role
in the theory of algebraic curves in the last thirty years as the notion
of abstract curve did in the preceding sixty.

C. Constructions of Mg
49
As suggested above, Mg may be realized by geometric invariant
theory: if we deﬁne 
K to be the locus of stable curves C embedded
by the nth power of their dualizing sheaves ωC and deﬁne Mg to be
the quotient 
K/PGL(N + 1, C), then Mg is the coarse moduli space
of stable curves. While this will be carried out in detail in Chapter 4,
we’d like now to introduce a few problems related to this construction.
If you haven’t seen the basics of the geometric invariant theory of
Hilbert points, you may want to skip the next few paragraphs until
after you’ve read Chapter 4.
The ﬁrst problem is to show that the orbits that the G.I.T. quotient
of 
K “throws away” are exactly those that are not pluricanonically em-
bedded stable curves. The analysis of this and related questions that
arise in the G.I.T. construction of Mg is quite intricate. Having carried
out this analysis, it’s natural to ask what sort of compact quotient we
can build by considering not just pluricanonically embedded curves
but all embedded curves with semistable Hilbert points. This amounts
to trying to ﬁnd moduli for pairs (C, Λ) where C is a curve of genus g
and Λ is a linear system of degree d and dimension r on C. For smooth
C, the answer is both easy to state and relatively straightforward to
verify. If d ≫g, then the orbit of such a pair produces a point in the
quotient whenever Λ is complete. The resulting quotient is a univer-
sal Picard bundle Pd,g. The full quotient again yields a modular com-
pactiﬁcation Pd,g of Pd,g. Using the isomorphism Pd,g ≊Pd+2g−2,g
discussed in Section B, this gives a stable compactiﬁcation of the Ja-
cobian bundle. Determining which orbits, or, more generally, which ﬁ-
nite sets of orbits, determine points of this quotient involves a lengthy
and delicate combinatorial analysis that has only recently been carried
out by Caporaso [16]: see the discussion following Theorem (4.45) for
more details.
We will discuss Mg in more detail later. For the time being, we want
only to make some elementary observations. Fix a curve C with δ
nodes and ν irreducible components C1, . . . , Cν of geometric genera
g1, . . . , gν. Now, to specify such a stable curve we have to specify the
normalizations ˜
Ci of the Ci, and then specify the points on each that
will be identiﬁed to form the nodes of C — there will be 2δ such points
in all. The family of such curves thus has dimension
ν
i=1
(3gi −3) + 2δ , 4
4You may be worried about this parameter count when gi equals 0 or 1. In the
rational case, the correct contribution should be 0 not −3. Fortunately, this is exactly
compensated for by the fact that the δi ≥3 marked points on such a component
actually depend on only δi −3 parameters because of the automorphisms of the
rational curve ˜
Ci. The number (3gi −3) actually counts moduli of Ci minus moduli

50
2. Basic facts about moduli spaces of curves
which, in view of the genus formula (2.14) equals,
3g −3 −δ .
In other words, the locus in Mg of curves with exactly δ nodes has pure
codimension δ in Mg. Moreover, a local computation in deformation
theory which we’ll carry out in the next chapter shows that the locus of
curves with more than δ nodes lies in the closure of the locus of those
with exactly δ. In particular, the boundary ∆= Mg −Mg is a divisor,
with each component the closure of a locus of curves with 1 node.
In this case, the combinatorics are easy to work out: a stable curve
with one node is either irreducible, or the union of smooth curves of
genera i and g −i meeting at one point. These give rise to divisors ∆0
and ∆i, i = 1, . . . , ⌊g/2⌋.
Parenthetically, we should say that it’s at this point that one in gen-
eral stops drawing curves as two-dimensional objects and starts using
the less suggestive but more efﬁcient one-dimensional representation.
Thus, instead of drawing general curves in the boundary components
∆0 and ∆1 in M3 as in Figure (2.16), we would draw them simply as
and
Figure (2.16)
in Figure (2.17). The surface pictures are actually rather misleading:
and
2
1
Figure (2.17)
locally, a node looks like a pair of (real) two-manifolds meeting trans-
versely in a point; this can and does occur in real fourspace, but not
in threespace. In order to ﬁt our pictures in a two-dimensional repre-
sentation of threespace, we’re obliged to either pinch these planes, as
on the left, or show them as tangent as on the right, either of which
is incorrect.
The boundary components of Mg,n may be listed analogously; here
is the statement for n = 1: the space Mg,1 is often denoted Cg, and
called (misleadingly; see the discussion in Section B) the universal
curve over Mg.
of its automorphisms and this makes all parameter counts like that above come out
right. We leave you to check that the count is also correct in the genus 1 case.

C. Constructions of Mg
51
Exercise (2.18) Show that the boundary Cg \ Cg consists of exactly
g divisors: the closure Σ0 of the locus of pairs (C, p) where C is an
irreducible curve with a single node; and the closures Σi of the locus
of pairs (C, p) where C is the union of smooth curves of genera i and
g−i meeting at a single point, and p lies on the component of genus i.
Exercise (2.19) Even rational curves can have moduli when marked
points are added. Show that M0,3 and M0,3 are both simply a point by
using an automorphism to ﬁx the 3 marked points. Likewise, show that
M0,4 ≊P1\{0, 1, ∞}. Show that any singular stable curve in M0,4 must
consist of a pair of smooth rational curves meeting in a point with each
carrying two of the four marked points and that two such are isomor-
phic if and only if the induced decompositions of {1, 2, 3, 4} into two
pairs agree. For more moduli spaces of rational curves, see [91].
Here are some exercises on the stable compactiﬁcation of Mg.
Exercise (2.20) As a consequence of the dimension computation
above, we may deduce that no stable curve can have more than 3g −3
nodes. Prove this directly.
Exercise (2.21) How many stable curves of genera 2, 3 and 4 are there
up to homeomorphism (in the analytic topology)? For each homeo-
morphism type, ﬁnd the dimension of the locus of the corresponding
curves in Mg and say which of these loci are in the closure of which
others.
Exercise (2.22) Show that the normalization C of a stable curve C
with 3g −3 nodes is a union of rational curves, each having 3 marked
points. Up to isomorphism, how many such curves C are there for
g = 2, 3, 4 and 5? Harder: for general g?
Exercise (2.23) How many components are there in the locus of sta-
ble curves with 2 or more nodes? Which lie in the closure of each
boundary component ∆i?
Let B be a smooth curve, p ∈B any point, and let 
X ✲B −{p} be
any family of stable curves. Let ϕ : B −{p} ✲Mg be the correspond-
ing map to moduli. Since Mg is projective, the valuative criterion for
properness implies that there is a unique extension of ϕ to a map
ϕ : B ✲Mg. In this circumstance, the curve corresponding to ϕ(p)
is called the stable limit of the curves {Xq}q∈B−{p} as q approaches
p. The determination of such limits by the process of semistable re-
duction will be discussed in considerable detail in the next chapter.
Here is a warm-up exercise for those of you already familiar with this
process.

52
2. Basic facts about moduli spaces of curves
Exercise (2.24) Let B be a smooth curve of genus g −1, p ∈B any
point, and for any q ∈B \ {p} let Xq be the stable curve obtained by
identifying p and q on B. What is the stable limit of the family {Xq}
as q approaches p?
Exercise (2.25) [posed by Jean-Francois Burnol] Let ∆(α) ⊂Mg be
the locus of stable curves with α or more nodes. For which α is ∆(α)
connected?
Exercise (2.26) It’s a classical fact that the automorphism group of
a smooth curve of genus g can have order at most 84(g −1). Does the
same statement hold for stable curves?
D
Geometric and topological properties
Basic properties
We’ve already said that Mg is irreducible of dimension 3g −3. Any of
the standard ways of establishing the dimension amounts to making
the computation of the Hilbert number in reverse: we used the dimen-
sion of Mg in computing the dimension (r + 1)d −(r −3)(g −1) of
any component of the Hilbert scheme Hd,g,r whose general member
was nonspecial. Conversely, if we exhibit such a component having
dimension exactly hd,g,r and dominating Mg we will have veriﬁed its
dimension. This is straightforward either using Hurwitz schemes (this
is the more usual, since the dimension of any component of Hd,g is
visibly b = 2d + 2g −2) or Severi varieties.
Irreducibility comes a little harder. Again, the standard approaches
invoke the parameter spaces Hd,g or Vd,g. Thus, for example, Clebsch
analyzed the Hurwitz scheme Hd,g as a covering space of an open
subset of Pb, and showed that the monodromy acted transitively on
the sheets; he deduced that Hd,g was irreducible for any d and g and
hence that Mg was. Likewise, the fact that the Severi variety Vd,g is
irreducible for any d and g implies that Mg is (although historically,
the irreducibility of Mg was known long before the irreducibility of
Vd,g). Although we’ll only prove the irreducibility of Mg in Section 6.A,
we’ll make free use of it in the interim. You can easily check that we
introduce no circular dependencies in doing so.
Local properties
The local structure of the moduli space Mg is very well understood.
The basic facts, which we’ll state here, are all consequences of the
deformation theory we’ll describe in detail in Chapter 3.

D. Geometric and topological properties
53
To begin with, the moduli space Mg is smooth at a point [C] cor-
responding to a curve without automorphisms. For genus g ≥4, the
singular locus of Mg is exactly the locus of curves with automor-
phisms, and the singularities of Mg are ﬁnite quotient singularities
— more precisely, in an analytic neighborhood of any point [C] ∈Mg,
Mg looks like a quotient of an open subset of C3g−3 by a linear ac-
tion of Aut(C), where the ﬁxed point sets of elements ϕ ∈Aut(C)
are exactly the curves nearby to which the automorphism ϕ deforms.
We will see in the following chapter how to describe this linear ac-
tion more explicitly. In particular, whenever the locus of curves with
automorphisms has codimension two or more, a curve with an au-
tomorphism must be a singular point of Mg. Of course, for g = 2,
every curve has a hyperelliptic involution, but M2 is smooth except
at one point (corresponding to the curve given by y2 = x5 −1, which
has additional automorphisms). For g = 3, the hyperelliptic curves
form a divisor whose generic point
corresponds to a curve with a
single nontrivial automorphism, the hyperelliptic involution. At such
points, the space M3 is smooth. This explains the restriction g ≥4
in the second sentence of this paragraph. The exercise below checks
that these are the only divisorial components in the locus of curves
with automorphisms.
Exercise (2.27) Consider a smooth curve C of genus g with a nontriv-
ial automorphism σ of prime order p. Let f : C ✲D be the quotient
of C by the group generated by σ, let h be the genus of D, and let b
be the number of points of D over which f ramiﬁes.
1) Show that all ramiﬁcation points of f have ramiﬁcation index
(p−1) — i.e., exactly p sheets meet at each. Use the Riemann-Hurwitz
formula to derive the relation
2g −2 = p(2h −2) + (p −1)b.
2) Show that the curve D together with the branch points of f is a
stable b-pointed curve of genus h. Then, use the fact that such a D
depends on 3h −3 + b moduli to deduce that the pairs (C, σ) depend
on at most 2g −1 moduli with equality only if h = 0 and p = 2.
3) Show that the only component in the locus of smooth curves of
genus g with automorphisms which is a divisor in Mg is the hyperel-
liptic locus in genus 3.
Analogous statements hold for moduli spaces of curves with
marked points (with the additional exceptional case of M1,1 in which
every curve has an automorphism given by inversion with respect to
the marked point).
A similarly explicit description may be given of the local structure
of Mg. Precisely, near a point [C] ∈Mg, Mg looks like a quotient

54
2. Basic facts about moduli spaces of curves
of an open subset of C3g−3 by a linear action of Aut(C); thus Mg
is smooth at points [C] with Aut(C) trivial, and at worst has ﬁnite
quotient singularities. Note that any curve in Mg with an elliptic tail —
that is, an elliptic component joined to the rest of the curve at a single
point — has a nontrivial automorphism, namely, the involution on
the tail ﬁxing the join point. Thus, for all g, the boundary component
∆1 is a locus of codimension 1 in Mg consisting entirely of curves
with automorphisms. Since a general point of ∆1 has automorphism
group Z/2Z, such a point will be a smooth point of Mg. With this
exception, Mg (g ≥4) is again singular at moduli points of curves
with automorphisms.
Exercise (2.28) 1) Show that, for g ≥4, ∆1 is the only component
of ∆whose generic element has a nontrivial automorphism.
2) Find all divisors in Mg, g ≥3, whose generic element has a non-
trivial automorphism.
We can likewise describe the structure of the boundary ∆=
	
∆i
by appealing to results about deformations of stable curves that will
be discussed in Section 3.C. For simplicity, assume C is a stable curve
with δ nodes p1, . . . , pδ and without automorphisms. Then in a neigh-
borhood of [C], the boundary ∆is a union of smooth hypersurfaces
Si intersecting transversely. The hypersurface Si is the locus of defor-
mations C′ of the curve C not smoothing the node pi (i.e., such that C′
has a node near pi). Thus, for example, if C is a stable curve that looks
schematically like the curve in Figure (2.29) then in a neighborhood
g −i −1
i
Figure (2.29)
of [C] the boundary will, schematically, look like Figure (2.30).
Finally, we note that the loci ∆i are, as our language has been im-
plicitly assuming, the irreducible components of ∆.
Assuming the
irreducibility of Mg itself, and hence of all moduli spaces of pointed
curves, the irreducibility of each ∆i is easily checked by exhibiting it
as the closure of the image of an irreducible scheme X under a map
X ✲Mg. A general point of ∆corresponds to a curve C with a single
node. If C lies in ∆0, then its normalization may be viewed as a smooth
curve of genus (g −1) with the two preimages of the node as marked
points. Identifying the two marked points thus deﬁnes a dominating

D. Geometric and topological properties
55
∆i
∆0
Figure (2.30)
map Mg−1,2 ✲∆0. When C lies on ∆i for some i > 0, its normaliza-
tion has two components of genera i and g −1 each with one marked
point: this determines a dominating map Mi,1 × Mg−i,1 ✲∆i.
Complete subvarieties of Mg
Intuitively, Mg isn’t a projective variety, since smooth curves do de-
generate to singular stable ones. (The implication is only a naive one
because we’ll see later that the moduli map may send the base of a
family of curves with singular ﬁbers into Mg.) On the other hand,
we’ve also said that it isn’t afﬁne: for one thing, it has no noncon-
stant holomorphic functions. The question arises, then, of how close
to being either afﬁne or projective Mg is. One way to quantify this is
to observe that an afﬁne variety contains no projective subvarieties
of positive dimension, while a projective variety X of dimension n
tautologically contains an n-dimensional one. We may thus ask the
question:
Question (2.31) What is the largest dimension rg of a complete (i.e.,
projective) subvariety contained in Mg?
However, the formulation of this question permits some misleading
responses. For example, if we took an afﬁne variety X of dimension n
and blew up a point, the resulting variety X would contain a projective
subvariety of dimension n −1. Accordingly, a better posed question
is:
Question (2.32) If [C] ∈Mg is a general point, what is the largest
dimension rg of a complete (i.e., projective) subvariety contained in
Mg and passing through [C]?
Here is the current state of our knowledge on these issues, in one
direction:

56
2. Basic facts about moduli spaces of curves
Theorem (2.33)
1) For any g ≥3, and for any point [C] ∈Mg,
there is a complete curve X ⊂Mg containing [C].
2) For any n, there exists a g for which Mg contains a complete,
n-dimensional subvariety.
The ﬁrst statement was already mentioned above as a consequence
of the existence of the Satake compactiﬁcation. The second result is
based on an easily described construction due to Kodaira. To give one
variant, start with a ﬁxed curve C0 of genus g0. The family of branched
covers of C0 that have degree 3 and are ramiﬁed at exactly one point5
is a complete one-parameter family {Cλ} of smooth curves of genus
g1 = 3g0 −2. The key point in verifying this is that we have just one
branch point (which by Riemann-Hurwitz forces us to use a covering
of odd degree). As we’ll soon see, the minimum genus in which the
Kodaira construction based on covers of degree d yields a complete
n-dimensional subvariety is roughly dn; hence the choice of degree 3.
If we iterate this construction — that is, consider all covers of degree 3
of curves in the family {Cλ} ramiﬁed at one point — we get a complete,
2-dimensional family of curves of genus g2 = 3g1 −1 = 9g0 −4. In
general, we obtain in this way a complete n-dimensional family of
curves of genus g = 3ng0 −(3n −1)/2. The dimension of the family
must increase with each iteration because any smooth curve covers
only ﬁnitely many curves of positive genus (see Exercise (1.21)). Note
that we don’t claim that these families are connected or that they map
birationally to moduli.
For g large, this yields the complete subvariety of Mg of largest
dimension known as of this writing. At the same time, it’s clear that the
dimension of the families produced is only logarithmic in the genus g.
One idea for improving the bound is to use more branch points gaining
more than a single dimension at each stage and perhaps allowing the
ratio of gi+1/gi to be smaller as well. If we do this, however, we must
somehow ensure that when these branch points meet, as they very
much tend to do in any complete family, the corresponding covers do
not acquire singularities. One condition that would ensure this, but
that seems to be hard to arrange, is that as branch points meet, their
ramiﬁcation cycles have disjoint supports in the corresponding ﬁber
of the covering.
We cannot resist mentioning one trick for forcing the branch points
to remain distinct. If C0 is a curve with a ﬁxed point free involution i,
we consider the family of all double covers of C0 branched at a pair of
points of the form (P, i(P)) getting a complete 1-parameter family of
curves of genus 2g0. The set of all unramiﬁed double covers of curves
5Note that these cannot be cyclic covers.

D. Geometric and topological properties
57
in this family will be a complete family of curves of genus 4g0 −1 with
ﬁxed point free involutions. Iterating this pair of steps, we get complete
n-dimensional families in genus 4ng0 −(4n −1)/3.
We should remark that all the curves in any of these families for
reasonably large n are very special, so the examples are relevant only
to Question (2.31).
In the negative direction, the outstanding result is Diaz’ theorem
[30], whose proof we’ll give in Section 6.B after we’ve introduced the
notion of admissible covers.
Theorem (2.34) (Diaz’ Theorem) There does not exist a complete,
(g −1)-dimensional subvariety of Mg for any g.
The results above leave a large gap that cries out to be ﬁlled. Speciﬁ-
cally, we don’t know whether there exist complete subvarieties of Mg
of any dimension between that produced by the Kodaira construction
(roughly log3(g)) and the bound g −2 given by Diaz. Thus, we know
r2 = 0 and r3 = 1, but already have only the inequalities 1 ≤r4 ≤2,
1 ≤r5 ≤3, and 2 ≤r6 ≤4, in which the gap is growing roughly like g.
Even this pales before our almost complete ignorance about rg. Here
we know that rg ≥1 for g ≥3 with equality for g = 3. But, we don’t
know whether there is any g for which there exists a complete surface
S ⊂Mg passing through a general point [C] ∈Mg.
To close, let’s pose the:
Problem (2.35) Give an explicit complete one-parameter family
X ✲B of plane quartics whose generic element is smooth and whose
associated map B ✲M3 is nonconstant but lies entirely in M3. (Since
the discriminant locus is a hypersurface in the projective space of all
quartic curves, some of the ﬁbers of X must be singular, but we ask
that their semistable models — see Section 3.C — be smooth. As we’ll
see, this could happen, for example, if they are all double conics.)
We might mention parenthetically here that there is an analogous
question for Hilbert schemes that is likewise open. The problem is: if
R ⊂H = Hd,g,r is the open subset of smooth irreducible nondegen-
erate curves in the Hilbert scheme H of curves of degree d and genus
g in Pr , how large a complete subvariety may R contain? The best re-
sult along these lines is a beautiful theorem of Mei-Chu Chang and Ziv
Ran ([24], [23]), which states that R cannot contain a complete variety
of dimension r −1. At the same time, it is possible to construct fami-
lies of smooth irreducible nondegenerate curves C ⊂Pr of dimension
r −3 for any r — see the exercises below — and r −2 for some special
r. Thus, the answer is nearly known, but a gap remains. In particu-
lar, it isn’t known whether there exist complete, positive-dimensional
families of smooth, irreducible and nondegenerate curves in P3.

58
2. Basic facts about moduli spaces of curves
Exercise (2.36) Show that there does not exist a complete, positive-
dimensional family of twisted cubics in P3.
Exercise (2.37) Let A ⊂PN be an abelian variety of dimension n,
embedded in projective space of large dimension, let π : A ✲Pn+3 be
a general projection, and let C ⊂A be a curve. Show that the map π
restricted to any translate of C is an embedding, and deduce that there
exists a complete, (r −3)-dimensional family of smooth irreducible
nondegenerate curves in Pr .
Exercise (2.38) Let σ : Pr × Pr−3 ✲PN be the Segre embedding, and
let ϕ be the map
ϕ : Pr−3 ✲G(n −r −1, N)
sending a point p to the subspace Ann(σ(Pr × {p})).
1) Show that the pullback ϕ∗(Q) of the universal quotient bundle Q
on G(n −r −1, N) is projectively trivial, i.e., is a line bundle tensored
with a trivial bundle of rank r + 1.
2) Now let C ⊂(PN)∨be the general translate (under the action of
PGL(N + 1, C)) of a smooth curve. Show that the projections πϕ(p) of
C from the subspaces ϕ(p) give a family of smooth curves in Pr of
dimension r −3.
Exercise (2.39) More generally, let X ✲B be any family of smooth
abstract curves with n-dimensional complete base B, and let L be a
very ample line bundle on X. Suppose that h0(Xb, L Xb) ≥n + 4 and
that, for b ∈B, the restriction map H0(X, L) ✲h0(Xb, L Xb) is surjec-
tive. Show that if σ0, . . . , σn+3 are n+4 general sections of L, then the
map ϕσ : X ✲Pn+3 embeds each ﬁber Xb of X as a smooth nonde-
generate curve in Pn+3, again giving us an (r −3)-dimensional family
of smooth curves in Pr .
Cohomology of Mg: Harer’s theorems
We come now to the fascinating question of the cohomology and/or
cycle structure of Mg. Most of what we know about the ﬁrst of these
questions is due to work of John Harer ([72], [74]), who uses the de-
scription of Mg as the quotient of the contractible Teichm¨uller space
by the Teichm¨uller modular group Γg to derive results on H∗(Mg, Q).
(As remarked above, these methods lead only to results about rational
cohomology so we shall suppress the coefﬁcients in what follows.)
The ﬁrst result of Harer’s that we’ll give is the one that in some
sense frames all the others. This is the stability theorem, and it says

D. Geometric and topological properties
59
that the low-dimensional cohomology ring of Mg is independent of
g. Speciﬁcally, Harer [73] shows that we have isomorphisms
(2.40)
Hk(Mg) ≊Hk(Mg+1)
for 3k −1 ≤g.
Moreover, when all the relevant isomorphisms are deﬁned they com-
mute with the cup product. The bound for k in this result is proba-
bly far from sharp: Harer conjectures that the isomorphism should
continue to hold until k is roughly equal to g. The most impor-
tant possibility opened up by the stability theorem is that of deﬁn-
ing what is called the stable cohomology ring H∗(M) by setting
Hk(M) = Hk(Mg) for any g ≥3k −1; it is this ring that is the fo-
cus of most of the results that follow. (We emphasize that H∗(M) is a
purely algebraic object: there is no actual moduli space M. Although
it’s possible to construct objects that are topologically like this imagi-
nary M, it’s necessary to take a limit over g of spaces parameterizing
the universal curve Cg plus additional analytic data in the form of a
local coordinate at the marked point. The resulting spaces are inﬁnite-
dimensional for all g [9].)
There is a conjecture about the stable cohomology of moduli, called
the standard conjecture which expresses H∗(M) in terms of certain
standard cohomology classes κi in H2i(Mg). (These classes are also
known as tautological classes.) To motivate the deﬁnition of these
classes, think of a cohomology class on a space X as a functional
that attaches to each cycle of the appropriate dimension a number,
measuring the nontriviality of that cycle in some respect. A cycle in
Mg corresponds to a family of curves, and the cycle is trivial if the
family is, so we may accordingly think of a cohomology class in Mg
as something that attaches to a family X ✲B of curves (of the appro-
priate dimension) a number measuring the variation of the curves in
that family.
For example, suppose π : X ✲B is a family of curves with one-
dimensional base. To say that the family is trivial — i.e., that X = B×C,
with π the projection on the ﬁrst factor — implies that the relative
dualizing sheaf ωX/B (to be deﬁned in the following chapter; for fam-
ilies of smooth curves it is simply the relative cotangent bundle) is
a pullback from C, and hence in particular that its ﬁrst Chern class
has square c1(ωX/B)2 = 0. (Conversely, it’s not hard to see that if
c1(ωX/B)2 = 0, then the family is isotrivial.) We may thus think of the
degree of c1(ωX/B)2 as a measure of the nontriviality of the family.
With a bit more care, we can use this procedure to describe a co-
homology class of codimension 2 on Mg. The extra care is needed
because Mg is neither smooth nor a ﬁne moduli space. The construc-
tion that follows is a ﬁrst example of the kind of persistent, but fun-
damentally minor, irritation that these facts cause. We will give an
informal sketch here assuming g ≥4. We ﬁrst throw away the locus

60
2. Basic facts about moduli spaces of curves
of curves with automorphisms: for g ≥4 this has complex codimen-
sion ≥2, and so won’t affect H2(Mg). (Alternatively, we may make
deﬁnitions analogous to those that follow using a rigidiﬁed moduli
problem π(n) : C(n)
g
✲M(n)
g
and then push the corresponding classes
down to Mg by the corresponding ﬁnite covering map. This method
works for all g ≥2.) We then have a universal curve π : C0
g ✲M0
g with
a smooth base. On C0
g, we have a relative dualizing sheaf ω = ωC0g/M0g.
Therefore, we can deﬁne the class
η = c1

ωC0g/M0g

on C0
g as the ﬁrst Chern class of ω, and, on M0
g the class
κ1 = π∗(η2) = π∗

c1(ωC0g/M0g)2
as the Gysin image of π of η2.
In similar fashion, we can deﬁne classes κi ∈H2i(Mg) by setting
κi = π∗(ηi+1). The standard conjecture [122] then states that the
stable cohomology ring is freely generated by these classes, that is:
Conjecture (2.41) (Mumford’s standard conjecture)
H∗(M) = Q[κ1, κ2, . . .].
Ed Miller [114] has shown that Q[κ1, κ2, . . .] injects into H∗(M) by
constructing, for any ﬁnite set of classes in the standard ring, cycles
on a suitable Mg on which these classes take on independent values.
In the other direction, the evidence we have for this conjecture is all
due to Harer.6 Speciﬁcally, Harer has shown in [72] and [75] that
(2.42)
H1(Mg) = H3(Mg) = 0 ,
H2(Mg) = Q · κ1 ,
H4(Mg) = Q · κ2 ⊕Q · (κ1)2.
The ﬁrst two results show that Pic(Mg)

Q, the rational Picard
group of line bundles on Mg, is of rank 1, and that it is generated by
6Except for examples of natural geometric cohomology classes deﬁned in other
terms that do lie in the standard subring. For example, loci of curves that carry a
divisor with Brill-Noether number ρ < 0 lie in this subring when they are of codimen-
sion ρ. This, however, is inductive evidence of the nonblack noncrow variety. (Since
the statement “all crows are black” is the logical equivalent of “all things that are not
black are not crows”, a white piece of chalk, for example, could be seen as positive
evidence for this assertion.) The evidence above simply shows that certain classes we
know about lie in the space of classes we’re sure we know about. Even the conjectured
range of codimensions in which the underlined hypothesis holds is roughly the same
— those less than roughly g — as the stable range.

D. Geometric and topological properties
61
the line bundle with ﬁrst Chern class κ1. Recently, Arbarello and Cor-
nalba [6] have discovered a beautiful algebro-combinatorial approach
which allows them to calculate the ﬁrst, second, third and ﬁfth co-
homology groups of Mg and also provides some information about
Mg.
Exercise (2.43) Show that if B is any complete curve that maps
ﬁnitely to M0
g and π : C ✲B is the corresponding family then κ1 is
nonzero on B. Conclude that κ1 isn’t a torsion class on Mg and hence
that H2(Mg) does indeed have rank at least 1.
Harer’s results also show that Pic(Mg)

Q is freely generated by κ1
and the classes δi of the boundary components ∆i, and, as discussed
in the next section, allow us to determine Pic(Cg)

Q.
There is another approach to generating cohomology classes in Mg
that should be mentioned. Another way of measuring the nontriviality
of a family π : X ✲B is by its Hodge bundle Λ , which can be viewed
informally as the vector bundle of rank g whose ﬁber over a point
b ∈B is the space of holomorphic forms H0(Xb, K) on the ﬁber Xb.
(More precisely, the Λ is the direct image π∗(ωX/B) of the relative du-
alizing sheaf.) In particular, we can associate to any family π : X ✲B
the Chern classes ci(Λ). This suggests looking at the Hodge bundle
Λ on Mg associated to the universal curve7 Cg ✲Mg and taking its
Chern classes
λi = ci(Λ) .
These also give cohomology classes on Mg. As it turns out, these are
polynomials in the classes κi, although the converse is not true.
One other beautiful result in this line is the calculation of the orb-
ifold Euler characteristics of the moduli spaces Mg,n by Harer and
Zagier [76]. The answers are striking: for example, they show that the
orbifold Euler characteristic of the universal curve is
χ(Mg,1) = ζ(1 −2g) = −B2g
2g ,
where ζ is the Riemann ζ-function and B denotes the Bernoulli num-
ber.
One consequence of their results is that the standard classes do
not generate the full cohomology ring for large g. This can be seen
by bounding the total number of standard classes and comparing to
the absolute value of the Euler characteristic. Already for g ≥15 the
Euler characteristic is clearly larger, but it may well be that there are
7We leave you to supply the incantations analogous to those above needed to make
formal sense of this.

62
2. Basic facts about moduli spaces of curves
nonstandard classes for all g ≥3. For instance, Looijenga has shown
that H6(M3) is nonzero and not tautological.
Cohomology of the universal curve
Harer has also produced analogous conjectures and results for the
moduli spaces of pointed curves. For example, in the case of Cg, Harer
has shown that the stable cohomology of Cg is generated over H∗(M)
by the class ω of the relative dualizing sheaf.
One immediate consequence of this is that the Picard group of Cg
is generated by the classes λ and ω. In other words, the line bun-
dle ω generates the Picard group of Cg over the Picard group of Mg.
By the same token, this implies that Pic(Cg)

Q is freely generated
by the class ω, together with λ and the classes σi of the boundary
components Σi, as described in Exercise (2.18). (For a more complete
statement over Z, see Arbarello and Cornalba, [5].)
An equivalent restatement of the fact that the Picard group of Cg is
generated by the classes λ and ω is that any line bundle on Cg must
restrict to a multiple of KC on a general ﬁber C ⊂Cg. This is almost,
but not quite, the statement of what is called the Enriques-Franchetta
conjecture.
This conjecture states that any assignment to a general curve C of a
line bundle on C — precisely, a section of the universal Picard variety
Pd,g over an open subset of Mg, or equivalently a rational section of
the map Pd,g ✲Mg — must be a power of the canonical line bundle.
This was classically stated in the form, “the only rationally determined
line bundles over moduli are the powers of the canonical bundle”.
This problem was ﬁrst considered by Enriques (cf. [43]) who found
a defective proof; noting that his proof was faulty, he formulated the
conjecture. (The statement of Enriques’ conjecture, which is actually
a stronger assertion implying the Enriques-Franchetta conjecture, is
discussed in the following subsection.) Later, Franchetta [51] gave an-
other false proof; unaware of the defect in his proof, he claimed the
result, with the consequence that the theorem, ﬁnally proved by Harer
and Mestrano, is often referred to as “Franchetta’s conjecture”, or even
“Franchetta’s Theorem”.
The Enriques-Franchetta conjecture doesn’t follow directly from
Harer’s results because giving a line bundle on every curve C in a fam-
ily X ✲B, as in the conjecture, doesn’t necessarily give a line bundle
on the total space — it does so locally over B, but the pieces don’t
necessarily patch together. In the end, however, Mestrano [112] over-
came this obstacle and was able to deduce the conjecture from Harer’s
result.

D. Geometric and topological properties
63
One hypothesis that would guarantee the existence of the desired
patchings would be the existence of a Poincar´e line bundle over Pd,g —
that is, a line bundle on the ﬁber product Pd,g×MgCg whose restriction
to a ﬁber of the product over a point (C, L) ∈Pd,g is L. A theorem due
to Mestrano and Ramanan [113] asserts that there is a Poincar´e line
bundle on Pd,g if and only if d −g + 1 is relatively prime to 2g −2.
A spectral sequence argument does show that, given any rationally
determined line bundle with “ﬁbers” Lx at the points of a variety X,
there is a number n such that all the “ﬁbers” (Lx)⊗n do come from a
line bundle on X. This, combined with Harer’s results, implies that any
rationally determined line bundle over moduli is a rational multiple
of the canonical bundle.
To ﬁnish off the Enriques-Franchetta conjecture, then, it remains to
analyze the ﬁnite covers of Mg obtained by taking roots of powers of
K: that is, for any d, n and g such that (2g −2)|nd, the spaces
Jn,d,g =

(C, L) : L⊗n ≊K
⊗

nd
2g−2

C

⊂Pd,g.
We would like to be able to say that the space Jn,d,g has no section
over Mg, except for the obvious ones when 2g −2 divides d. It would
be independently interesting to know more about the monodromy
of this covering space as well in order to understand its component
structure. When d is divisible by 2g −2, for example, the

d
2g −2

-
canonical bundles form an isolated sheet. When d = 0 so that we’re
considering n-torsion line bundles, the monodromy group is known to
be Sp(2g, Z/nZ) and the cover turns out to be irreducible if and only
if n is prime; of course, this is then also true when d is a multiple of
2g −2. The other classically understood case is when d = g −1 and
n = 2 when there are exactly two components corresponding to even
and odd theta characteristics. A ﬁrst question might be: Is the cover
irreducible when d is relatively prime to 2g −2?
Cohomology of Hilbert schemes
Two considerations prompt us to look for algebraic approaches to the
standard conjecture. The ﬁrst is simply our pride as algebraic geome-
ters. The second is that Harer’s approach to the calculation of Hi(Mg)
becomes much harder to carry out with each increase in i; already with
i = 4 we appear to be reaching the limits of human patience and per-
severance (although Harer and some of his students have done work
on the next cases). It seems unlikely that his methods can be pushed
much further.
The most promising strategy is to try to solve the problem in two
steps: ﬁrst, understand the cohomology of some parameter space or

64
2. Basic facts about moduli spaces of curves
spaces; second, by studying the maps from these spaces to moduli,
deduce the cohomology of Mg. For example, the irreducibility of Mg
(which amounts to the calculation of H0(Mg)) is proved by showing
that the Hurwitz schemes are irreducible and then showing that every
Mg is dominated by such a scheme.
Here we simply want to mention some conjectures on the cohomol-
ogy of the Hilbert scheme that are in close analogy to the standard
conjecture above. We may summarize the approach taken above to
generating the stable cohomology of the moduli space of curves as
follows. First, look for a canonically deﬁned line bundle on the uni-
versal curve Cg, or, roughly equivalently at least up to torsion, for a
consistently deﬁned line bundle on each ﬁber of Cg. Then, take the
Chern class of this bundle, raise it to various powers and take their
Gysin images in the cohomology of Mg.
We may do exactly the same thing in the case of Hilbert schemes
H = Hd,g,r . The main difference is that there are now two canonically
deﬁned bundles on the universal curve π : X ✲H : the relative dual-
izing sheaf ω = ωX/H as before, and the line bundle OX(1) pulled
back from OPr(1) by the inclusion of X in Pr × H . We may thus take
all monomials in the Chern classes η and ξ of these two line bun-
dles, and push them forward. We ask: do these Gysin images generate
the Chow or homology ring of the restricted Hilbert scheme R in low
codimension? For example, we might expect that the group A1(R) of
codimension 1 cycle classes in R will have rank 3, being generated
over Q by the classes
A = π∗(ξ2),
B = π∗(ξ · η)
and
C = π∗(η2).
We may call this statement the standard conjecture for the low-
dimensional cohomology of the Hilbert scheme.
We may make an analogous conjecture on the low-dimensional co-
homology of the universal curve XR ✲R: that it’s generated by the
classes η and ξ over the ring H∗(R). In particular, this would say
that the relative Picard group of XR/R (the group of line bundles on
XR modulo those pulled back from R) is generated by η and ξ. In
the formulation “if LC is a rationally determined line bundle on every
curve C in an open set of the Hilbert scheme, then for some n and
m, LC ≊ω⊗n
C
⊗OC(m)”, this conjecture is already in Enriques. Just
as for Mg and Mg these conjectures lead to statements that the low-
codimensional cohomology of R is generated by standard classes and
boundary components which we won’t formulate here.
Unfortunately, these conjectures are false in general. There are ex-
amples of components of restricted Hilbert schemes R such that the
universal curve XR ✲R admits many line bundles (modulo those
pulled back from R) other than ωX/B and OX(1). The simplest of
these is given in the two exercises below.

D. Geometric and topological properties
65
Exercise (2.44) Let S0 be a smooth cubic surface and L1, . . . , L6 be
disjoint lines on S0. Let C0 ⊂S0 be a general curve in the linear system
C0 ∈|nH −L1 −2L2 −· · · −6L6|.
Show that if n is sufﬁciently large, then
1) C0 is smooth and irreducible;
2) a general curve C in a component H of the Hilbert scheme con-
taining [C0] also lies on a smooth cubic surface S; and,
3) the class of the curve C ⊂S is expressible in the form nH −

i·Li
for a unique choice of 6 skew lines L1, . . . , L6 ⊂S.
How large does n have to be for each of these assertions to hold?
Exercise (2.45) Let X ✲H be the universal curve over the compo-
nent H of the Hilbert scheme described in the preceding exercise and
XR ✲R its restriction to the open set of smooth curves. Show that the
classes H and L1, . . . , L6 give rise to seven independent line bundles
on XR, whose restrictions to a general ﬁber C ⊂XR are independent.
In other words, show that the group of rationally determined line bun-
dles on XR ✲R has rank at least 7. For extra credit, show that the
rank is exactly 7.
Exercise (2.46) Continuing our analysis of the Hilbert scheme de-
scribed in the preceding exercise, consider the Gysin images of the
pairwise products of the classes H and L1, . . . , L6. Show that these
give rise to at least four independent divisor classes on H , thus vi-
olating the standard conjectures on the Picard group of the Hilbert
scheme.
It’s therefore somewhat remarkable that for r = 1 and 2 (that is,
for the Hurwitz scheme and Severi variety), the standard conjectures
do seem to hold. Why this should be is unclear. The situation is com-
pletely analogous with those considered in Chapter 1: the Hurwitz
scheme and Severi variety are always irreducible of the correct di-
mension, while the Hilbert scheme is in general neither. The basic
references for the Severi variety case of these conjectures are [33],
[32] and [36]: in the last it’s shown that a veriﬁcation of the standard
conjecture on the Picard group of Severi varieties would imply Harer’s
theorem on the Picard group of Mg. Diaz and Edidin [31] have some
results in the Hurwitz scheme case.
There is a further point to be made about the standard conjectures
for Hilbert schemes of curves in higher-dimensional space. This is
that, empirically, the components of the Hilbert scheme that violate
the conjectures all lie over relatively small subvarieties of Mg — ones
of codimension on the order of g or more. This phenomenon has been

66
2. Basic facts about moduli spaces of curves
sufﬁciently often observed that we may include it in the statement of
the conjectures. We include these here (for the Picard groups of the
Hilbert schemes and their universal curves) for reference. We start
with the Enriques conjecture:
Conjecture (2.47) (Enriques conjecture) 1) Let

Hd,g
be
the
space of branched covers π : C ✲P1 of P1 of degree d and genus
g. If LC is a rationally determined line bundle on every curve C in an
open set of 
Hd,g, then for some n and m, LC ≊ω⊗n
C
⊗π∗OP1(m).
2) Similarly, let Vd,g be the locus of reduced and irreducible plane
curves of degree d and genus g. If LC is a rationally determined line
bundle on every curve C in an open set of Vd,g, then for some n and
m, LC ≊ω⊗n
C
⊗OC(m).
3) There exist real numbers α = α(g) > 0 and β = β(g) such that
the following statement holds: if H is any component of the restricted
Hilbert scheme of curves of degree d and genus g in Pr such that the
induced rational map ϕ : H ✲Mg has image of codimension less
than or equal to α · g + β, and if LC is a rationally determined line
bundle on every curve C in an open set of Vd,g, then for some n and
m, LC ≊ω⊗n
C
⊗OC(m).
Exercise (2.48) Show that any one of these three statements implies
the Enriques-Franchetta conjecture. (The converse, in case d is sufﬁ-
ciently large with respect to g, was established by Ciliberto [25].)
The statement of the standard conjecture for the low-dimensional
cohomology of the Hilbert scheme (again just for the Picard group)
is slightly more delicate, since it matters just what open subset of
the Hurwitz/Severi/Hilbert scheme we choose. Probably the cleanest
statement in the case of the Hurwitz and Severi schemes involves the
smallest open subset: in the case of the Hurwitz scheme, the variety

Hd,g of branched covers with simple branching, and, in the case of
the Severi variety, the open set Ud,g ⊂V d,g of irreducible plane curves
of degree d and geometric genus g with only nodes as singularities. In
both cases, we expect ﬁrst that the classes A, B and C will be torsion
and second that the rank of the Picard group is 0. For the Severi variety,
the ﬁrst expectation is proved in [33]. Of course, this would give the
second if we knew that these classes also generated the Picard group.
Diaz and Harris actually show that the converse also holds: if the rank
is 0, then these classes must actually generate Pic(Vd,g) ⊗Q.
Conjecture (2.49) (Standard conjecture for Picard groups
of parameter spaces)
1) Pic( 
Hd,g) ⊗Q = 0;
2) Pic(Ud,g) ⊗Q = 0; and

D. Geometric and topological properties
67
3) There exist real numbers α = α(g) > 0 and β = β(g) such that
the following statement holds: if H is any component of the restricted
Hilbert scheme of curves of degree d and genus g in Pr and 
H ⊂H
the open subset parameterizing smooth curves, such that the induced
map ϕ :

H ✲Mg has image of codimension less than or equal to
α · g + β, then the Picard group Pic( 
H ) ⊗Q of H is generated by the
classes A, B and C.
You may feel that the formulation of the third part of each of these
conjectures in terms of unspeciﬁed constants α(g) and β(g) is a
cheat: the statement as a result is so vague as to be virtually immune
to counterexample. We agree. The problem is, the evidence available
doesn’t give a clear indication of what the correct values of these con-
stants should be. For the examples of which we know, α = 1 and β = 0
should work; but that may not be the strongest possible statement.
We leave it instead as a challenge:
Problem (2.50) Can you ﬁnd a component 
H of the Hilbert scheme
whose image in Mg has codimension less than g that violates the
statement of either conjecture above?
Exercise (2.51) Calculate the codimension in Mg of the image of the
component of the Hilbert scheme introduced in Exercise (2.44); in par-
ticular, observe that it’s greater than g.
Finally, we should say that there are analogous conjectures about
the dimension and irreducibility of the Hilbert scheme. As we re-
marked, while the Hurwitz and Severi varieties are always irreducible
of the expected dimension, neither is true of the Hilbert scheme Hd,g,r
in general. But, it may be conjectured that, as in the two conjec-
tures above, the corresponding statements do hold for components of
Hd,g,r whose images in Mg have relatively small codimension. We will
discuss this brieﬂy following the proof of the Brill-Noether theorem
in Chapter 5.
Structure of the tautological ring
Having produced, at least conjecturally, classes which generate the
stable cohomology ring of Mg, a natural problem is to understand
the relations amongst various products of these classes. The results
and conjectures about this question are most easily discussed in the
setting of the Chow ring A∗(Mg) rather than that of the cohomol-
ogy ring H∗(Mg). To set this up, we deﬁne the tautological subring
R∗(Mg) of the Chow ring A∗(Mg) to be the subring generated by the
tautological classes κi and λi.

68
2. Basic facts about moduli spaces of curves
The ﬁrst result about R∗(Mg) is due to Mumford [122] who showed
that it’s generated by the g−2 classes κ1, . . . , κg−2. The ﬁrst element of
the proof is a Grothendieck-Riemann-Roch calculation which shows,
as was already noted in the discussion of Harer’s theorem following
Exercise (2.43), that the λ’s are all expressible in terms of the κ’s.
(The ﬁrst two such expressions are calculated in Section 3.E: see equa-
tions (3.106) and (3.107)). To express κi for i ≥g + 1 in terms of the
lower κ’s, Mumford uses the natural surjection between the pullback
π∗(Λ) of the Hodge bundle under the map π : Cg ✲Mg and the rel-
ative dualizing sheaf ωCg/Mg. The kernel of this map is a locally free
sheaf of rank g −1 on Cg and so its Chern classes vanish in degrees
above g −1. Pushing down to Mg gives a relation in each degree i
greater than g −2 between κi and lower κ’s. He applies the same tech-
nique to κg−1 and κg except that now the pushed-down relation also
involves the λ’s. Since he has already shown how to express these in
terms of the κ’s, he is able to handle this by showing that the ﬁrst two
such relations are independent. Both steps yield a slew of relations
not used in the proof but, at least initially, it was not clear that these
could be summarized in any concise form.
Looijenga recently showed that Mumford’s result is a shadow of a
much stronger vanishing result:
Theorem (2.52) (Looijenga) In any degree i > g−2, Ri(Mg) = {0},
and Rg−2(Mg) is generated by either the class of the hyperelliptic lo-
cus or the class κg−2. These classes are nonzero so Rg−2(Mg) is one-
dimensional.
We won’t discuss the proof here — it’s given in [110] (except for
the nonvanishing of Rg−2(Mg) which is shown in [48]). However, you
may get an idea of the force of this result by noting that Diaz’ theo-
rem [Theorem (2.34)] is an immediate corollary.
Even before Looijenga’s result was established, Faber [48] had in-
cluded it as part of still more precise conjectures about the structure
of the tautological ring. The ﬁrst part can be stated immediately.
Conjecture (2.53) (Faber’s conjecture, ﬁrst part)
1) The tautological ring R∗(Mg) “looks like” the algebraic cohomol-
ogy ring of a nonsingular projective variety of dimension g −2.
More precisely, it’s Gorenstein with socle in degree g −2 — that is,
it vanishes above degree g −2, it’s one-dimensional in degree g −2
and the pairing Ri(Mg) × Rg−2−i(Mg) ✲Rg−2(Mg) is perfect —
and satisﬁes the conclusions of the Hard Lefschetz theorem and the
Hodge index theorem with respect to the class κ1.
2) The ⌊g
3 ⌋classes κ1, . . . , κ⌊g/3⌋generate the ring with no relations
in degrees less than or equal to ⌊g
3 ⌋.

D. Geometric and topological properties
69
The other parts of Faber’s conjecture deal with the nature of the
relations in the tautological ring. The ﬁrst question to ask is: how can
we produce such relations? To answer this, we introduce the space Cd
g,
the d-fold ﬁber product of Cg over Mg, which parameterizes a curve
C of genus g plus a d-tuple of points p1, p2, . . . , pd, not necessarily
distinct. This comes equipped with diagonal divisor classes Dd,ij (the
locus where pi = pj) and with bundles which we denote ωd,i obtained
by pulling back the bundle ωCg/Mg via the projection onto the ith
factor. There are lots of other projection maps: if I ⊂{1, 2, . . . , d} is
a subset of order e, we have a map πd,I : Cd
g ✲Cd−e
g
by forgetting the
points pi for i ∈I. It also carries a particularly interesting bundle
Fd, of rank d, which can be described informally as the bundle whose
ﬁber over [(C, D)] is H0
C, KC/KC(−D)

or, more precisely, as
(πd+1,{d+1})∗
 d

i=1
ODd+1,i

ωd+1,d+1

.
Faber studies the evaluation map ϕ : Λ ✲Fd — we use Λ to denote
the pullback of the Hodge bundle to Cd
g — which is ﬁberwise the map
H0
C, KC
 ✲H0
C, KC/KC(−D)

and shows, by a straightforward ap-
plication of Porteous’ formula (which we’ll study in Chapter 3 starting
on page 161) that:
Proposition (2.54) In A∗(C(2g−1)
g
), cj(F2g−1 −Λ) = 0 for j ≥g.
On the other hand, pushing down to Mg any monomial in the
classes Dd,ij and ωd,i involved in the deﬁnition of the Fd’s turns out
to give an element of the tautological ring on Mg so this relation
pushes down to one in R∗(Mg). The rules for carrying this out were al-
ready written down in [82] (in 1982!). Unfortunately, the codimension
in which this relation lives is negative so all terms are 0. We can cure
this by multiplying this relation with suitable classes before pushing
down. The relations thus obtained are then highly nonobvious. In fact,
Faber conjectures that:
Conjecture (2.55) (Faber’s conjecture, second part) The ideal
of relations in the tautological ring R∗(Mg) is generated by those of
the form
π∗

M · cj(F2g−1 −Λ)

for all monomials M in the classes Dd,ij and ωd,i, and all j ≥g. (Here
π = π2g−1,{1,2,...,2g−1} is the projection which forgets all points).
We won’t go into the mechanics of how individual relations like
those in the second conjecture are unwound nor into the details of
how the conclusions of the conjecture may be deduced from sets of

70
2. Basic facts about moduli spaces of curves
such relations, except to say that the difﬁculties are due mainly to the
rapidly growing combinatorial complexity of the calculations (cf. [47]).
Faber works things out for g = 2, 3 and 4 on pages 10-12 of [48]. In
practice, a computer is required to carry out all but the very simplest
cases. Even using a symbolic calculation program, a naive approach
bogs down around genus 6. However, by cleverly factoring the push-
down operations involved using some auxiliary rules, Faber, assisted
by a computer, has been able to verify the conjecture for g ≤15, thus
providing very strong evidence for it in general.
Having produced relations, it’s natural to ask whether they can be
explicitly expressed in terms of the κ’s themselves. Here again Faber
has a beautiful proposal for which there is also a computer assisted
veriﬁcation for g ≤15.
Conjecture (2.56) (Faber’s conjecture, third part) Fix
any
partition P of the integer g−2 as a sum d1 +d2 +· · ·+dk(P) of positive
integers. For each subset, S ⊂{1, 2, . . . , k(P)}, deﬁne dS =

j∈S dj.
For each permutation σ ∈Sk(P), let
σ = α1 · α2 · . . . · αν(σ)
be its expression as a product of disjoint cycles, let Sl be the support
of αl (so that the sets Si partition the set {1, 2, . . . , k(P)}), let di = dSi,
and let
κσ,P =
ν(σ)

i=1
κdi ∈Rg−2(Mg) .
If we let
τP =

σ∈Sk(P)
κσ,P ,
then, in Rg−2(Mg), we have the relation
τP =

2g −3 + k(P)

!

2g −1

!!

2g −1

!
k(P)
j=1

2dj + 1

!!
κg−2
in which (2n−1)!! denotes, as usual, the product 1·3·5·. . .·(2n−1).
Although we won’t enter into this, these relations can be unwound
to yield relations for individual products of κ’s of total degree g −2.
For example, Zagier showed that the third conjecture implies that
κg−2
1
=
1
g −122g−5
(g −2)!
2κg−2 .

D. Geometric and topological properties
71
Witten’s conjectures and Kontsevich’s theorem
Faber’s motivation for looking at the class τP in the preceding
subsection comes from work of Witten [152]. There he deﬁned
a much larger family of such τ-classes — in Witten’s notation,
τP =

τd1+1, τd2+1, . . . , τdk(P)+1
 
— and conjectured that a generating
function F encoding all the intersection numbers associated to these
classes satisﬁes two distinct systems of differential equations (one of
which is the Korteweg-deVries system and one of which is associated
to the Virasoro algebra).
At the time it was stated, this seemed, to us at least, plausible —
there was numerical evidence for it coming from earlier work of Mum-
ford on R∗(M2) [122] and Faber on R∗(M3) ([45], [46]) — but out of
reach. However, a tour-de-force proof was soon provided by Kontse-
vich [102]. He uses a combinatorial version of the moduli space based
on ribbon graphs to express the generating function F in terms of ma-
trix integrals. This allows him to show that F satisﬁes both systems
of differential equations by applying properties of these matrix mod-
els (cf. [89] and [34]). Probably the best place to begin if you want to
understand the proof is Looijenga’s Bourbaki Seminar talk [109].
In the rest of this subsection, we will simply state Witten’s conjec-
tures, suppressing, as usual, details of how various deﬁnitions which
follow are made precise.8 We begin by deﬁning the line bundle Li on
Mg,n to be the unique line bundle whose ﬁber over each pointed sta-
ble curve (C; p1, . . . , pn) is the cotangent space of C at pi and letting
ψi ∈A1(Mg,n) be the ﬁrst Chern class of Li. It is convenient, and
as we will see, nearly always harmless, to suppress the dependence
of the classes on n and g: when we need to make this dependence
explicit, we will write Lg,n,i and ψg,n,i.
Witten’s conjectures concern the intersection products of the
classes ψi. A concise notation for these products which exploits the
symmetry in the markings is given by
(2.57)

τk1τk2 · · · τkn
 
g =
 n

i=1
τki
 
g =

Mg,n
ψk1
1 ψk2
2 · · · ψkn
n .
Such products are well-deﬁned when all the ki are nonnegative inte-
gers and the dimension condition 3g −3 + n =
n
i=1 ki holds. In all
other cases,

τk1τk2 · · · τkn
 
g is deﬁned to be zero. The empty prod-
uct

1
 
1 is also set to zero. The simplest nonzero integral (on M0,3)
is

τ3
0
 
0 = 1. This evaluation and the ﬁrst evaluation in the following
8We are grateful to Rahul Pandharipande for notes on which this subsection is
based.

72
2. Basic facts about moduli spaces of curves
exercise act as set of initial conditions for the recursions which follow
(cf. Exercise (2.63)).
Exercise (2.58) 1) Verify the evaluation

τ1
 
1 = 1
24 (on M1,1).
2) Verify the evaluation

τ3
0τ1
 
0 = 1 (on M0,4).
Let t = (t0, t1, . . . , ti, . . .) be an inﬁnite vector of variables indexed
by i ≥0 and let γ denote the formal sum γ =
∞
i=0 tiτi. Witten next
considers the formal generating function for the products (2.57):
Fg(t) =
∞

n=0

γn 
g
n!
in which the expression

γn 
g is deﬁned by monomial expansion and
multilinearity in the variables ti. Thus, more concretely,
Fg(t) =

{ni}
 ∞

i=1
tni
i
ni!

τn0
0 τn1
1 τn2
2
· · ·
 
g,
where the sum is over all sequences of nonnegative integers {ni} with
ﬁnitely many nonzero terms. The generating function F deﬁned by
F =
∞

g=0
λ2g−2Fg
arises as a partition function in two-dimensional quantum gravity.
Based on a different physical realization of this function in terms of
matrix integrals, Witten [152] conjectured that F satisﬁes two dis-
tinct systems of differential equations. Each system determines F
uniquely and provides explicit recursions which compute all the prod-
ucts (2.57).
Before describing the full systems, two basic properties are needed
for products with 2g −2 + n > 0. Under this hypothesis, the string
equation says that
(2.59)

τ0
n

i=1
τki
 
g =
n

j=1

τkj−1

i≠j
τki
 
g ,
and the dilaton equation says that
(2.60)

τ1
n

i=1
τki
 
g = (2g −2 + n)
 n

i=1
τki
 
g .
Both the string and dilaton equations are derived from a compar-
ison result describing the behavior of the ψ classes under pullback

D. Geometric and topological properties
73
via the map π : Mg,n+1 ✲Mg,n which forgets the (n + 1)st point. If
i ∈{1, . . . , n}, the basic formula is
(2.61)
ψg,n+1,i = π∗(ψg,n,i) + [D]
where D ≊M0,2 × Mg,n−1 is the boundary divisor on Mg,n+1 whose
generic point parameterizes the join of a curve of genus 0 containing
the marked points pi and pn+1 with a curve of genus g containing the
other n −1 marked points.
Exercise (2.62) Prove equation (2.61) and use it to deduce the string
and dilation equations (2.59) and (2.60).
The next exercise gives a ﬁrst glimpse of the force of these two
equations.
Exercise (2.63) 1) Show the string equation and the initial condition

τ3
0
 
0 = 1 determine all the genus 0 products in (2.57). More precisely,
show that
 n

i=1
τki
 
0 = (n −3)!
n
i=1 ki!.
2) Show that the string equation, the dilaton equation, and the initial
condition

τ1
 
1 = 1
24 determine all the genus 1 products.
Associated to each of the string and dilaton equations is a differ-
ential operator which annihilates exp(F). The operator associated to
the string equation is
(2.64)
L−1 = −∂
∂t0
+ λ−2
2
t2
0 +
∞

i=0
ti+1
∂
∂ti
,
and that associated to the dilaton equation is
(2.65)
L0 = −3
2
∂
∂t1
+
∞

i=0
2i + 1
2
ti
∂
∂ti
+ 1
16 .
Exercise (2.66) 1) Show that the string equation and the initial con-
dition

τ3
0
 
0 = 1 imply the equation L−1

exp(F)

= 0.
2) Show that the dilaton equation and the initial condition

τ1
 
1 = 1
24
imply the equation L0

exp(F)

= 0.
The ﬁrst system of differential equations which Witten conjectured
the τ-products must satisfy are the Korteweg-deVries or KdV equa-
tions. To give his very compact formulation, let us set
(2.67)

τk1τk2 · · · τkn
  
=
∂
∂tk1
∂
∂tk1
· · ·
∂
∂tk1
F ,

74
2. Basic facts about moduli spaces of curves
so that, in particular,

τk1τk2 · · · τkn
  
t=0 =

τk1τk2 · · · τkn
 
. Then,
Witten shows that the KdV equations for F take the form:
Theorem (2.68) (Witten-Kontsevich formulas, KdV form)
For all n ≥1, the generating function F satisﬁes the equations
(2n+1)λ−2
τnτ2
0
  
=

τn−1τ0
  
τ3
0
  
+2

τn−1τ2
0
  
τ2
0
  
+1
4

τn−1τ4
0
  
.
Witten further showed that these equations and equation (2.64) for
L−1 together determine all the products (2.67) and thus uniquely de-
termine F.
As an example of how this works in practice, try taking n = 3 and
evaluating equation (2.68) at t = 0. We obtain
7

τ3τ2
0
 
1 =

τ2τ0
 
1

τ3
0
 
0 + 1
4

τ2τ4
0
 
0.
Applying the string equation (2.59) yields
7

τ1
 
1 =

τ1
 
1 + 1
4

τ3
0
 
0.
Hence, we have rederived the equation

τ1
 
= 1
24.
To describe the second system of differential equations for F, we
introduce a Lie algebra L of holomorphic differential operators9: L is
the algebra spanned by the operators Ln, where for n ≥−1
Ln = −zn+1 ∂
∂z ,
and in which the bracket is given by [Ln, Lm] = (n−m)Ln+m. That this
notation is consistent with the deﬁnitions for L−1 and L0 introduced
above follows from:
Exercise (2.69) Show that the differential operators deﬁned in (2.64)
and (2.65) satisfy
[L−1, L0] = −L−1 .
This suggests that equations (2.64) and (2.65) may be viewed as the
beginning of a representation of L in a Lie algebra of differential oper-
ators. In fact, it turns out that, with certain homogeneity restrictions,
there is a unique way to extend this assignment of L−1 and L0 to such
a representation of L. For n ≥1, the expression for Ln takes the form
9The physical motivation for considering the Lie algebra L in this context comes
from the fact that it is a sub-algebra of the Virasoro algebra.

D. Geometric and topological properties
75
(2.70)
Ln = −
(2n + 3)!!
2n+1

∂
∂tn+1
+
∞

i=0
(2i + 2n + 1)!!
(2i −1)!! 2n+1

ti
∂
∂ti+n
+ λ2
2
n−1

i=0
(2i + 1)!! (2n −(2i + 1))!!
2n+1

∂2
∂ti ∂tn−1−i
.
Recall that (2n −1)!! = 1 · 3 · 5 · . . . · (2n −1) with the convention that
(−1)!! = 1.
Exercise (2.71) Prove that the formula (2.70) deﬁnes a representation
of L. Hint: Use the identity
(2i+1)!!(2n−(2i+1))!! = (−1)i+1 
(−2i−1)(−2i+1) · · · (−2i+2n−1)

.
Theorem (2.72) (Witten-Kontsevich formulas, Lie form) For
all n ≥−1, Ln

exp(F)

= 0.
As with the KdV form, it’s straightforward to see that the system of
equations (2.72) also uniquely determines F. As a practical example
of how this may be used, consider the equation determined by the
operator L3:
−945
16
∂F
∂t4
+
∞

i=0
ti
∂F
∂ti+3
+ λ2
15
16
 ∂2F
∂t0∂t2
+ ∂F
∂t0
∂F
∂t2

+ 9
32
 ∂2F
∂t1∂t1
+ ∂F
∂t1
∂F
∂t1

= 0 .
The constant term of the above relation reads
−945
16

τ4
 
2 + 15
16

τ0τ2
 
1 + 9
32

τ1τ1
 
1 +

τ1
 2
1

= 0.
Exercise (2.73) Use part 2 of Exercise (2.63) to compute the genus 1
numbers above and show that

τ4
 
2 =
1
1152 .
Kontsevich’s proof of both sets of formulas is fundamentally ana-
lytic. It would be very nice to have direct algebraic arguments, but as
yet few cases have been treated; for example, for the Lie version, only
L−1 and L0.
Finally, we note that both Witten and Kontsevich had in mind, more
than the values of these invariants, their applications! More precisely,
Witten conceived a generalization of moduli spaces of stable curves to
moduli spaces of stable maps to a ﬁxed target variety (moduli spaces
of curves being those in which the target of the map was a point)
and saw the resulting intersection numbers as a way of producing
invariants of the target. These moduli spaces of maps are the topic of
our last section.

76
2. Basic facts about moduli spaces of curves
E
Moduli spaces of stable maps
The ideas of Witten and Kontsevich in [152] and [102] have inspired a
theory of moduli spaces of stable maps.10 This theory is still undergo-
ing very active development and many of the conjectured results are
currently only known in very special cases. However, it has already
yielded solutions to a wide range of enumerative problems dealing
with rational curves and seems certain to have much wider applica-
tions.
We won’t use moduli spaces of stable maps elsewhere in this book.
In this section, we just want to introduce these spaces and state the
main properties known and conjectured about them. For further de-
tails, we refer the reader to the excellent set of expository notes of
Fulton and Pandharipande [54] which we’ve relied on heavily for this
sketch.
First of all, what is a stable map

C, (p1, . . . , pn), µ

of genus g with
n marked points? As the name suggests, it’s a map µ from a connected
nodal curve C of arithmetic genus g with a collection (p1, . . . , pn) of
n distinct smooth marked points to a projective scheme X satisfying
the stability condition that the number of automorphisms of the map
µ — that is, maps ϕ : C ✲C ﬁxing the marked points and satisfying
µ ◦ϕ = µ — is ﬁnite.
Exercise (2.74) Show that this stability condition is equivalent to the
condition that, if a smooth rational component D of C is mapped by
µ to a point of X, then the number of marked points on D plus the
number of nodes in which D meets the rest of C be at least 3, plus the
condition that, if g = 1 and n = 0, then µ is nonconstant.
If γ is an element of H2(X, Z) (possibly 0), then we let Mg,n(X, γ)
denote the set of isomorphism classes of stable maps with target X
for which the pushforward µ∗({C}) of the fundamental class {C} of
C equals γ. Although this set may be empty — for example, if γ ̸= 0
and X contains no curves of genus g or less — it can always be made
into a projective coarse moduli space. If l is the class of a line in Pn,
we write Mg,n(Pn, d) for Mg,n(Pn, dl).
Exercise (2.75) Show that if X is a point and hence the class γ
is 0, then we recover the usual moduli space of stable curves, i.e.,
Mg,n(pt, 0) ≊Mg,n.
To get a tractable space, it is, at least at present, necessary to set
g = 0 and to make strong positivity assumptions about X. We call a
10Gromov in [66] had introduced many of the ideas involved from a symplectic point
of view.

E. Moduli spaces of stable maps
77
nonsingular variety X convex if, for every map µ : P1 ✲X, we have
H1
P1, µ∗(TX)

= {0}. This follows if TX is generated by global sec-
tions; hence, any variety admitting a transitive group action is con-
vex. For convex X, the space M0,n(X, γ) has properties very much
like those of moduli spaces of stable curves. In particular,
• M0,n(X, γ) is locally normal of pure dimension
dim(X) +

γ
c1(TX) + n −3 ;
• M0,n(X, γ) is locally a quotient of a smooth variety by a ﬁnite
group;
• The locus of maps without automorphisms in M0,n(X, γ) is a
ﬁne moduli space for such maps; and,
• The boundary of M0,n(X, γ) — that is, the locus of maps with
reducible domain C — is a normal crossing divisor.
The next exercise makes this more concrete by analyzing the simple
examples.
Exercise (2.76) 1) Show that an open set of M0,0(P2, 2) with domain
a smooth rational curve parameterizes nonsingular conics. Maps with
this domain also give all double covers of a line (which are deter-
mined, up to isomorphism, by the line and the two branch points on
it). Next, maps with domain the union of two rational curves meeting
at a point parameterize those singular conics that are the union of two
distinct lines as well as double lines with a distinguished point (the
image of the point where the two rational curves meet). Conclude that
M0,0(P2, 2) is isomorphic to the classical space of complete conics (see
for example Vainsencher [146]).
2) Show that the same classiﬁcation of stable maps extends to
M0,0(Pn, 2) when n ≥3. However, what we obtain is not the classical
space of complete conics (classifying a plane plus a complete conic
in that plane): when the map has image a line, the locus of planes
containing the line is blown down to a point in M0,0(Pn, 2).
The boundary of M0,n(X, γ) can, once again, be broken up into
subloci indexed by the ways in which a stable map can have a re-
ducible domain. Now, however, it’s necessary to keep track not only
of the decomposition of the curve, but also of the set of marked points
and the class γ. For each partition of {1, . . . , n} into disjoint subsets
A and B and each decomposition γ = α+β, we let ∆(A, B; α, β) be the
closure of the locus of stable maps for which C = CA ∪CB, the points
indexed by A lie on CA and those indexed by B on CB, and the restric-
tions of µ to CA and CB represent α and β, respectively. (Note that, if

78
2. Basic facts about moduli spaces of curves
α = 0, then the stability of µ forces #A ≥2 and that ∆(A, B; α, β) is
empty unless the classes α and β are represented by stable maps of
genus 0. Also, the irreducibility of ∆(A, B; α, β) is only known when X
is a projective space.)
If we deﬁne
∆({i, j}|{k, l}) =

{i,j}⊂A
{k,l}⊂B
α+β=γ
∆(A, B; α, β) ,
then we have the fundamental linear equivalence
(2.77)
∆({i, j}|{k, l}) ∼∆({i, l}|{j, k}) .
In the case of the moduli space M0,4 ≊P1, there are three such di-
visors corresponding to the three points 0, 1 and ∞in this space
parameterizing reducible curves — see Exercise (2.19) — and the
linear equivalence is simply that of points on P1. In general, the
equivalence follows by pulling back this special case under the map
M0,n(X, γ) ✲M0,4 which forgets the map γ and the points not in-
dexed by {i, j, k, l}.
When we take X to be a projective space (certain other homogeneous
spaces can be used as well), equation (2.77) can be used to obtain re-
cursions for solutions to a wide range of enumerative questions about
rational curves. The most direct approach is to write down a suitable
curve Y in M0,n(Pn, d) and to interpret its intersection numbers with
various boundary divisors as enumerative quantities. Applying these
interpretations to the two sides of (2.77) then produces relations be-
tween the enumerative quantities.
Rather than even attempt to write down general results of this type,
we sketch the now classic use of M0,3d(P2, d) to calculate the number
Nd of rational plane curves of degree d through 3d−1 general points.
In this case, the “right” curve Y consists of those stable maps which
send the ﬁrst two marked points to points lying on two ﬁxed but
general lines and the other 3d −2 marked points to ﬁxed general
points. The only maps
µ : C = C{1,2} ∪C{3,...,3d} ✲P2
at which Y can meet ∆({1, 2}, {3, . . . , 3d}; 0, d) are those which col-
lapse C{1,2} to the point of intersection of the two ﬁxed lines. Since
the map must also take the points of C{3,...,3d} to the 3d −2 ﬁxed
points, #

Y ∩∆({1, 2}, {3, . . . , 3d}; 0, d)

= Nd.
Since the images of the marked points are general, Y is disjoint
from every other ∆(A, B; 0, d) for which A contains {1, 2} and, for
0 < e < d, it can meet ∆(A, B; e, d−e) only when #A = 3e+1. If so, we
can count as follows: there are
3e −4
3e −1

partitions for which {1, 2} ∈A

E. Moduli spaces of stable maps
79
and {3, 4} ∈B; Ne choices for the image of CA and Nd−e for the image
of CB; e choices for the image of each the points p1 and p2 which must
map to points of intersection of µ(CA) with the corresponding ﬁxed
line; and e(d −e) choices for the image of the intersection CA ∩CB
which must lie in the intersection µ(CA) ∩µ(CB). Thus,
#

Y ∩∆({1, 2}|{3, 4})

= Nd +

0<e<d
NeNd−ee3(d −e)

3d −4
3e −1

Exercise (2.78) Suppose now that {1, 4} ∈A and {2, 3} ∈B. Show
that #

Y ∩∆(A, B; e, d−e)

= 0 if e = 0 or e = d. Otherwise, show that
Y meets ∆(A, B; e, d −e)

only if #A = 3e and that, in each of these
3d −4
3e −2

cases, we have
#

Y ∩∆(A, B; e, d −e)

= NeNd−ee2(d −e)2 .
Finally, use ∆({1, 2}|{3, 4}) = ∆({1, 4}|{2, 3}) (cf. (2.77)) to deduce
the recursion
Nd =

0<e<d
NeNd−e

e3(d −e)

3d −4
3e −1

−e2(d −e)2

3d −4
3e −2

.
Of course, this argument depends coming up with the right curve Y.
This can be avoided by rephrasing (2.77) in terms of the formalism of
Gromov-Witten invariants and quantum cohomology. Even deﬁning
these terms carefully would take us too far aﬁeld, so we give only the
barest sketch and refer to [54] for all details.
Gromov-Witten invariants are numerical invariants of suitable col-
lections of cohomology classes on X obtained by: pulling the classes
back to M0,n(X, γ) using the evaluation maps which send a stable
map to its value at a marked point; cupping together the pullbacks;
and ﬁnally integrating them over the fundamental class of M0,n(X, γ).
When X is a homogeneous space, they have enumerative interpreta-
tions. If, in addition, all classes on X which represent a stable map
are expressible as nonnegative linear combinations of a ﬁnite num-
ber γ1, . . . , γm, the Gromov-Witten invariants can be used to deﬁne
an extension of the ring structure on the Chow ring of A∗(X) to its
tensor product with the formal power series ring Q[[γ1, . . . , γm]]: the
extended ring is called a quantum cohomology ring . Equation (2.77)
amounts to the associativity of this extended product. Once this is set
up, enumerative results can be obtained by simply writing down the
associativity equations and applying the enumerative interpretations
of the Gromov-Witten invariants.
These ideas are currently being pursued in a number of different
directions. The basic program is laid out in [103] and [104]. On the
one hand, there is a symplectic approach to quantum cohomology

80
2. Basic facts about moduli spaces of curves
(cf. [135]) which has been used to prove associativity in some cases
not yet handled by the kinds of methods discussed here. On the other,
the genus 0 results have motivated work by Ran, Caporaso-Harris,
Pandharipande, Vakil, Getzler and others on enumerative geometry
of curves of higher genus (cf. [133], [17], [18], [19], [129], [128], [147],
[55] and [56]) to which the quantum cohomological formalism doesn’t
seem to extend directly.

Chapter 3
Techniques
A
Basic facts about nodal and stable
curves
In this short section, we collect various elementary facts about stable
(or, more generally, nodal) curves that we’ll need later, as well as a few
which have already been used in Chapter 2. Most of the veriﬁcations
are straightforward and will be left to you as exercises. Almost every-
thing we discuss here is treated in the original paper of Deligne and
Mumford [29].
We begin with the genus formula already stated in (2.14): if C is a
connected nodal curve with δ nodes p1, . . . , pδ and ν irreducible com-
ponents C1, . . . , Cν of geometric genera g1, . . . , gν, then in Section 2.C
(3.1)
g =
ν
i=1
(gi −1) + δ + 1 =


ν
i=1
gi

+ δ −ν + 1 .
Exercise (3.2) Let us, as we’ll also do in the sequel, abuse notation
by identifying the sheaf
O C =
ν
i=1
O Ci
on the normalization C =
	 Ci of C with its direct image on C. This is
harmless, since the Leray spectral sequence identiﬁes all cohomology
groups of these two sheaves. Show that we have an exact sequence
0
✲OC
✲O C
✲
δ

j=1
Cpj
✲0
and verify (3.1) by using the associated long exact sequence.

82
3. Techniques
Dualizing sheaves
Next, we list some basic properties of the dualizing sheaf ωC of a
nodal curve C, which will play a role for such curves analogous to
that of the canonical bundle of a smooth curve. We will start with the
most concrete deﬁnition. Let C be a nodal curve, with normalization
ν : C ✲C; let p1, . . . , pδ be the nodes of C, and {qi, ri} = ν−1(pi) the
pair of points qi and ri of C lying over each node pi. The dualizing
sheaf ωC may be deﬁned as a subsheaf of the pushforward of the
sheaf of rational differentials on C: it’s the sheaf associating to each
open U ⊂C the space of rational one-forms η on ν−1(U) ⊂C having
at worst simple poles at the pairs of points qi and ri of C lying over
each node pi ∈U of C, and such that for each such pair of points
(3.3)
Resqi(η) + Resri(η) = 0 .
The following exercise establishes some of the basic properties of the
dualizing sheaf of a nodal curve that we’ll be using:
Exercise (3.4) Let C be a nodal curve of arithmetic genus g.
1) Show that the dualizing sheaf of C is an invertible sheaf.
2) Show that the degree of ωC is 2g −2.
3) Show that if C is connected, then the space H0(C, ωC) of global
sections of the dualizing sheaf has dimension g; more generally,
h0(C, ωC) = g + µ −1, where µ = h0(C, OC) is the number of con-
nected components of C.
More generally, for any curve C with normalization ν : C ✲C, the
dualizing sheaf ωC associates to each U ⊂C the rational one-forms
η on ν−1(U) ⊂C such that for each p ∈U and each f ∈OC,p,
(3.5)

q∈ν−1(p)
Resq(ν∗f · η) = 0
All three parts of Exercise (3.4) are true more generally for any curve
with Gorenstein singularities, a class that includes all local complete
intersection curves; in fact, part 1 of Exercise (3.4) is equivalent to C
being Gorenstein.
Exercise (3.6) 1) Show that in the case of a node the requirement
(3.5) implies that η has at most simple poles.
2) What order of poles are allowed if C has a tacnode? A planar triple
point? A spatial triple point?
3) Show that the dualizing sheaf ωC is invertible at a planar triple
point of C, but not at a spatial triple point.

A. Basic facts about nodal and stable curves
83
The name “dualizing sheaf” derives from an identiﬁcation
(3.7)
H1(C, ωC) = C
such that for any coherent sheaf F on C the cup product map
H1
C, F

H0
C, HomOC(F, ωC)

✲H1(C, ωC) = C
is a nondegenerate pairing, inducing a natural isomorphism
HomC

H1(C, F), C

≊HomOC

F, ωC

.
(Recall that by HomOC(F, G) we mean the space of global sections
of the sheaf HomOC(F, G)), that is, the space of sheaf morphisms
F ✲G.) For a proof, see [84]; alternatively, the following exercise
sketches a proof in case F is invertible.
Exercise (3.8) Fix a nodal curve C together with an invertible sheaf
which we write as OC(
k
i=1 nisi) with s1, . . . , sk are smooth points of
C. Let ∆i ⊂C be an open disc around si. In terms of the covering of C
by the open sets U =
	
∆i and V = C \ {s1, . . . , sk}, any element of
H1
C, OC(
k

i=1
nisi)

may be represented by a collection of Laurent series fi ∈OC(∆i\{pi})
on the punctured discs ∆i \{pi}. Use the analogous statement (that is,
Kodaira-Serre duality) on the normalization C of C to show that the
pairing
H1
C, OC
 k

i=1
nisi

× H0
C, ωC
 k

i=1
−nisi

✲C
given by
{f1, . . . , fk} × η ✲
k

i=1
Respi(fi · η)
is well-deﬁned, and that it’s a perfect pairing.
Note that, as a consequence, the Riemann-Roch theorem likewise
extends to nodal (or more generally Gorenstein) curves, in the form
h0(C, L) = d −g + 1 + h0(C, ωC

L∨)
for a curve C of arithmetic genus g and invertible sheaf L of degree d
on C.
The next two exercises show that the dualizing sheaf of a stable
curve has ampleness properties only very mildly weaker than those
of the canonical bundle on a smooth curve, and give in these terms a
characterization of moduli stable curves amongst all nodal ones.

84
3. Techniques
Exercise (3.9) Let C be a stable curve of genus g.
1) Show that H0(C, ω⊗n
C ) = (2n −1)(g −1), and that for n ≥2,
H1(C, ω⊗n
C ) = 0.
2) Show that for n ≥3, ω⊗n
C
is very ample on C.
Exercise (3.10) Let C be a complete connected nodal curve.
1) Show that, for n ≥3, the sheaf ω⊗n
C
is very ample if and only if C
is moduli stable. Hence, ωC is ample on a complete connected nodal
curve C if and only if C is moduli stable.
2) Similarly, let p1, . . . , pn ∈C be distinct smooth points of C. Show
that (C; p1, . . . , pn) is a stable n-pointed curve if and only if the line
bundle
ωC(
n

i=1
pi)
is ample.
A fundamental and important fact about dualizing sheaves of nodal
curves is that they ﬁt together in families: if ϕ : C ✲B is a ﬂat family
of nodal curves, we may deﬁne the relative dualizing sheaf ωC/B of the
family to be the sheaf of rational relative differentials — that is, ratio-
nal sections of the relative cotangent bundle Coker(dϕ : ϕ∗ΩB ✲ΩC)
— satisfying the residue condition (3.3) on each ﬁber. That this is in
fact an invertible sheaf on C may not be clear, but it may be readily
veriﬁed by a local calculation. In fact, this virtually forces the deﬁni-
tion of the dualizing sheaf on us:
Exercise (3.11) Let C be the locus xy = tk in A3, and consider the
morphism ϕ : C ✲A1 given by (x, y, t) ✲t. Show that the relative
cotangent bundle of ϕ on C∗= C \ {(0, 0, 0)} extends (uniquely) to
a line bundle on all of C, and that the sections of this line bundle on
the ﬁber C0 = ϕ−1(0), viewed as rational differentials on C0, satisfy
the residue condition (3.3).
Given this, the relative dualizing sheaf of a family ϕ : C ✲B of
nodal curves whose general ﬁber is smooth may be characterized as
the unique line bundle on C extending the relative cotangent bundle
on the locus C∗of smooth points of ϕ. Moreover, if the total space
C is smooth, we may the describe the relative dualizing sheaf as the
canonical bundle of C tensored with the dual of the pullback of the
canonical bundle of B:
ωC/B = KC

ϕ∗K∨
B .
Another feature of the relative dualizing sheaf is the naturality of
the identiﬁcation (3.7) as shown by the:

A. Basic facts about nodal and stable curves
85
Exercise (3.12) Let ϕ : C ✲B be a family of connected nodal curves
and ωC/B the relative dualizing sheaf of the family. Using the con-
crete description of the relative dualizing sheaf in terms of rational
differentials, show that
R1ϕ∗ωC/B = OB .
A consequence is that if L is a line bundle on C with h0(Cb, L) constant,
then we have a very special case of Grothendieck duality, the relative
version of Kodaira-Serre duality:
R1ϕ∗(L∨
ωC/B) = (ϕ∗L)∨.
Observe that Exercise (3.12) characterizes yet again the relative du-
alizing sheaf of a family ϕ : C ✲B of nodal curves among all line
bundles whose restriction to each ﬁber is the dualizing sheaf of the
ﬁber.
It follows from any of the descriptions above that the relative dualiz-
ing sheaf is functorial: if B′ ✲B is any morphism and C′ = C×BB′ ✲B′
the pullback family, then ωC′/B′ = π∗(ωC/B), where π : C′ ✲C is the
projection.
Exercise (3.13) Let ϕ : C ✲B be a ﬂat family of stable curves of
genus g. Show that for n ≥2, the direct image ϕ∗(ω⊗n
C/B) is locally
free of rank (2n −1)(g −1).
Automorphisms
Our deﬁnition of a stable curve requires that it have only ﬁnitely many
automorphisms. To verify the local description of Mg given in the
previous chapter (as smooth away from loci of curves with automor-
phisms at which it has quotient singularities), we’ll need the slightly
stronger assertion that the scheme-theoretic automorphism group of
a stable curve is ﬁnite and reduced. This is our next goal.
To start with, we need to make precise the scheme structure on
the automorphism group. This turns out to be a bit involved. We will
just sketch the ideas here and refer you to Section 1 of [29] for more
details. We also simplify by working over a point rather than a more
general base. The ﬁrst step is to deﬁne, for any two stable curves C
and D, an isomorphism functor Isom(C, D) whose value on a scheme
S′ is the set of S′-isomorphisms between C × S′ and D × S′. Any such
isomorphism must identify the relative dualizing sheaves of C and D
and hence all powers of these sheaves. Using Exercise (3.9), this leads
to a representation of the functor Isom(C, D) by a subscheme of a
suitable projective linear group.

86
3. Techniques
More precisely, ﬁx g ≥2 and an integer n ≥3. Deﬁne integers r
and d in terms of these by
(3.14)
r + 1 = (2 · n −1)(g −1)
and
d = 2 · n(g −1).
Let H = Hd,g,r and let [C] and [D] be the points of H determined by
C and D. Deﬁne a map µ : PGL(r +1) ✲H ×H by µ(α) = (α·[C], [D])
and let I(C, D) = µ−1(∆) ∈PGL(r + 1), where ∆is the diagonal in
H × H . The scheme Isom(C, D) turns out to represent Isom(C, D)
although we won’t verify this here.
To deﬁne the automorphism group of a stable curve C, we just take
D = C in the foregoing, This amounts to identifying Aut(C) with the
stabilizer in PGL(r + 1) of [C] ∈H . The assertion we’re after is then:
Lemma (3.15) Aut(C) = stabPGL(r+1)([C]) is reduced.
If not, there would be a nonzero I-valued point of Aut(C) lying over
the identity, or equivalently, a nonzero regular vector ﬁeld on C. The
following exercise rules this out.
Exercise (3.16) Show that, on a stable curve C, there is no nonzero,
everywhere regular vector ﬁeld. Equivalently, Ext0
ΩC, OC

= {0}.
Hint: Such a vector ﬁeld would correspond to a regular vector ﬁeld
on the normalization C vanishing at all points lying over the nodes
of C. Show that such a vector ﬁeld must be identically 0 on every
component of C.
We conclude by remarking that similar arguments give a relative
version: given two stable curves C ✲S and D ✲S, there is a scheme
IsomS(C, D) which is ﬁnite and unramiﬁed over S and represents the
functor of S-isomorphisms between the curves. In particular, if S itself
is a curve, 0 is a point of S and S∗= S \{0}, then any S∗-isomorphism
between the restrictions to S∗of C ✲S and D ✲S extends to an S-
isomorphism.
B
Deformation theory
Overview
In this short section, we want to quickly sketch the typical stages of
an application of deformation theory1 using the simplest example,
1A few words about other references are in order here. We know of no accessible
reference that deals with all the variations we wish to discuss here. For a very read-

B. Deformation theory
87
deformations of smooth varieties, as our model. A deformation of a
smooth variety X with base a pointed scheme (Y, y0) is a proper ﬂat
morphism ϕ : X ✲Y, together with an isomorphism ψ : X ✲ϕ−1(y0)
of X with the scheme-theoretic ﬁber of ϕ over the point y0 ∈Y. In
other words, it’s a ﬁber square
(3.17)
X
ψ ✲X
y0
❄
✲Y
❄
ϕ
where the map X ✲y0 ≊Spec(C) is the structure map and the map
y0 ✲Y is the inclusion. Two such squares are called equivalent if
there is an isomorphism of ﬁber squares between them that equals
the identity on X.
A ﬁrst-order deformation of X is a deformation over the pointed
space (I, 0) of dual numbers. The space Def1(X) of such deformations
is extremely important for two reasons. First, it can almost always be
identiﬁed with some cohomology group and hence is readily calcu-
lated. Second, if there is a moduli space M containing X then Def1(X)
will usually equal the tangent space to M at the moduli point of X:
this must, by deﬁnition, be the case if the moduli space is ﬁne. An
nth-order deformation of X is deﬁned similarly as a deformation over
(In, 0) but, except in the ﬁrst-order case, it’s generally very difﬁcult
to calculate these explicitly.
Having deﬁned such inﬁnitesimal deformations, it’s natural to ask
whether they can be integrated. More precisely, we ask whether there
exists a deformation ϕ : X ✲Y with the versality property: any other
deformation ξ : X ✲Z is analytically isomorphic in a neighborhood
U of each point of Z to the pullback of ϕ : X ✲Y by a map f : U ✲Y.
Such families go by a number of other names. Analysts usually call
them Kuranishi families (especially when deforming a complex mani-
fold, the case originally studied by Kuranishi) and the term complete
deformation is also seen.
able, detailed description of the deformation theory of compact, complex manifolds,
see Kodaira’s book [98]. This also contains references to the papers in which the ba-
sic theory was originally presented. The only drawback here is that the discussion is
limited to smooth abstract varieties. Another good reference for this case is Palam-
odov’s survey [126]; Vistoli’s expository article [150] gives a very careful exposition of
deformations of local complete intersection schemes, both embedded and abstract,
from an algebraic viewpoint; and Koll´ar gives a thorough treatment of deformations
of embedded varieties in [100]. However, none of these deals explicitly with such vari-
ations as deformations of varieties with additional structure (e.g., a line bundle) and
all take distinctly different points of view.

88
3. Techniques
We emphasize that versality is, in two important ways, formally
weaker than the uni-versal properties we have dealt with in discussing
moduli and parameter spaces. First, deformations are required to be
pulled back from the versal deformation only locally on the base. Sec-
ond, and in practice usually much more signiﬁcant, no uniqueness
properties are claimed for the maps f : U ✲Y that realize a given de-
formation as, locally, a pullback of the versal one. In most cases, nei-
ther potential strengthening is possible. Indeed, the base Y of a versal
deformation can have dimension strictly larger than that of Def1(X).
In particular, the existence of a versal deformation doesn’t imply the
representability, even in the coarse sense, of the deformation functor.
These problems, however, don’t arise when X has only ﬁnitely
many automorphisms (or, more generally, when the group of auto-
morphisms of X that extend to all small deformations of X has ﬁ-
nite index in the full automorphism group of X). In this case, a min-
imal versal deformation Y (that is, one for which the induced map
TY ✲Def1(X) is an isomorphism) will be universal so that the map
that realizes a family as a pullback of the versal one will be unique.
(This is one, but not the only, point at which making the identiﬁcation
of the central ﬁber part of the deﬁnition of a deformation is crucial.)
As usual, such uniqueness properties mean that any two versal defor-
mations of X are locally isomorphic. Since we’ll be interested in versal
deformations mainly for stable curves — which, by deﬁnition, have ﬁ-
nite automorphism group — we’ll almost always be able to make such
uniqueness assumptions.
For general varieties, existence of versal deformations is usually a
difﬁcult question. Even the existence of liftings of ﬁrst-order defor-
mations to second order (much less to arbitrary order or to formal
families) can be hard to decide. There is a general theory that de-
scribes groups in which the obstructions to such liftings lie. However,
we’ll only mention this theory brieﬂy at a few points because, even
in cases in which it’s possible to calculate these obstruction groups
explicitly, it’s generally difﬁcult to determine whether the obstruction
deﬁned by a given ﬁrst-order deformation vanishes or not.
Fortunately, for curves, it is possible to give direct and explicit con-
structions of versal deformations. In the next section, we’ll see how
to do this in two ways: ﬁrst, by integrating certain canonical ﬁrst-
order deformations called Schiffer variations; and second, by taking
a suitable subscheme of a Hilbert scheme as the base of such a de-
formation and, in essence, inheriting the deformation and the desired
(uni)versality property from the corresponding universal curve.
The basic model described above can be varied in many ways to
adapt it to the study of a particular problem of interest. However, al-
most all applications of deformation theory involve three steps anal-
ogous to those outlined above:

B. Deformation theory
89
1. Pose the appropriate deformation theoretic problem;
2. calculate the space of ﬁrst-order deformations; and,
3. construct, if one exists, a versal deformation.
In the rest of this section, we ﬁrst work out, in some detail, the three
steps in the basic case where X is a smooth curve. Then, we carry out
the ﬁrst two steps in a variety of useful and representative examples,
often omitting detailed proofs and leaving you to make the necessary
modiﬁcations to the smooth curve model.
Deformations of smooth curves
Throughout this section, we ﬁx a smooth curve C of genus g ≥1. We
begin by determining the ﬁrst-order deformations of C. 2
To begin with, let’s ﬁx an afﬁne open cover Uα of C and a collection
of linear maps ϕαβ : OUα×I Uαβ ✲OUβ×I Uαβ that restrict to the identity
modulo ε — that is, we want the maps ϕαβ to satisfy
ϕαβ(ε) = ε
and
ϕαβ(f ) = f + εDαβ
for f ∈OUαβ
with each Dαβ a C-linear function of f. In order that such a collec-
tion of maps glue together to give a ﬁrst-order deformation of C, two
conditions are necessary and sufﬁcient.
First, each ϕαβ must be a ring homomorphism:
ϕαβ(f g) = ϕαβ(f)ϕαβ(g),
or, using the deﬁnitions above and ε2 = 0,
f g + εDαβ(f g) = f g + ε(fDαβ(g) + gDαβ(f)).
In other words, the maps Dαβ must be derivations and hence give a
cochain, with respect to the cover of Uαβ’s, taking values in the tangent
bundle to C .
Second, on the triple overlaps the ϕαβ’s must satisfy the multiplica-
tive cocycle condition
ϕαγ = ϕβγ ◦ϕαβ.
Plugging in again, this amounts to
f + εDαγ(f ) = Dβγ(f + εDαβ(f)) = f + ε(Dβγ(f) + Dαβ(f))
2The approach that follows is due to M. Artin and was shown to us by Angelo
Vistoli.

90
3. Techniques
or the assertion that the Dαβ’s are an additive cocycle.
Combining these observations, we see that
Def1(C) ≊H1(C, TC).
Notice also that, up to this point, what we’ve said applies equally well
to any smooth variety.
Most references follow a somewhat more analytic path in calculating
Def1(C), which is outlined in the following exercise.
Exercise (3.18) Fix a cover as above and choose a local coordinate zα
on each Uα so that OUα×I can be identiﬁed with the ring of convergent
power series C{zα, ε}/(ε2). Choose in addition a collection {ψαβ} of
coordinate transformations deﬁned on the overlaps Uαβ by
ψαβ(zα) = pαβ(zβ) + εqαβ(zβ)
with p and q power series in one-variable convergent in some neigh-
borhood of the origin.
1) Use Taylor expansions to show that the maps ψαβ satisfy the co-
cycle condition ψαγ = ψβγ ◦ψαβ if and only if
pαγ(zγ) = pβγ ◦pαβ(zγ)
qαγ(zγ) = ∂pαβ
∂z pβγ + qαβpβγ
and hence construct a map from H1(C, TC) to Def1(C).
2) Given a ﬁrst-order deformation X ✲I of C, consider the normal
bundle sequence
0 ✲TC ✲TX C ✲NC/X ✲0.
Show that X is trivial if and only if the derivation
∂
∂ε at 0 in I lifts
to a derivation D ∈H0(C, NC/X) along C. Show that any two such
lifts have the same image in H1(C, TC) under the coboundary map
H0(C, NC/X) ✲H1(C, TC). Conclude that the map in 1) is an isomor-
phism.
Our
calculation
of
Def1(C)
shows
that
it’s
isomorphic
to
H1(C, TC) ≊H0(C, K⊗2
C )∨≊C3g−3. We next want to integrate these,
eventually obtaining a versal family. As a ﬁrst step, we introduce an
important family of one-parameter ﬁrst order deformations that can
be integrated explicitly.
Fix a point P on C and consider the cover of C by two open sets,
a small disc U centered at P and the complement V = C −{P} of
{P} in C. Since there is only a single overlap W = U ∩V ≊∆∗the
cocycle condition is vacuous and a ﬁrst-order deformation is simply

B. Deformation theory
91
a holomorphic vector ﬁeld on U ∩V. If z is a local coordinate on this
overlap, we may choose the vector ﬁeld to be, for example,
sP = 1
z
∂
∂z ,
in which case the corresponding ﬁrst-order deformation is called a
ﬁrst-order Schiffer variation at P.
Exercise (3.19) Using the Serre duality between H1(C, TC) and
H1(C, K⊗2
C ), we may view elements of H0(C, K⊗2
C ) as linear functionals
on H1(C, TC).
1) Show that the annihilator of the ﬁrst-order Schiffer variation at P
is H0(C, K⊗2
C (−P)). In particular, changing coordinates at P simply
rescales the corresponding ﬁrst-order Schiffer variation.
2) Show that the set of all ﬁrst-order Schiffer variations spans
H1(C, TC).
These ﬁrst-order deformations can be integrated to a deformation
X ✲∆t as follows. Let Ut be a constant unit disc ∆z with coordinate
z and Wt be the varying subannulus in which |z| > t1/2. Next let w be
a local coordinate on C centered at P and map Wt to Vt by w = z + t
z.
This amounts to identifying the shaded region below (the ellipsoidal
image of Ut in C minus the similarly shaped image of Ut1/2) with the
annulus Wt.
Making these identiﬁcations for all t at once yields a
2(1 −t)
4t1/2
2(1 + t)
Figure (3.20)
deformation X ✲∆t that sends the vector ﬁeld
∂
∂t to the ﬁrst-order
Schiffer variation of C at P given by sP as desired.

92
3. Techniques
This construction can now be carried out independently near each
of several points P1, . . . , Pk to give deformations of C over a product
of k discs. Generalizing the exercise above, we see that the annihilator
of the image in Def1(C) of the tangent space to such a deformation is
H0(C, K⊗2
C (−P1 −· · · −Pk)).
Hence, if we choose any generic collection of 3g −3 points on C,
we obtain a deformation over a 3g −3-dimensional polydisc whose
tangent space maps isomorphically to Def1(C).
Exercise (3.21) Use the change of coordinates
w = z + t1
z + t2
z2 + · · · + t3g−3
z3g−3
to construct a kth order variation of complex structure over a polydisc
of dimension 3g −3. Show that if p is generic then this variation also
has a tangent space that maps isomorphically to Def1(C).
The deformations constructed above are versal — even universal —
but, unfortunately, there seems to be no direct method of verifying
this. Instead, we give an alternate construction which has the advan-
tage of working for all stable curves at the end of the next section.
Variations on the basic deformation theory plan
In general, the application of deformation theory in a particular in-
stance involves three steps analogous to those carried out for defor-
mations of curves above: posing the appropriate deformation theo-
retic problem, calculating the space of ﬁrst-order deformations and
constructing, if it exists, a versal deformation space.
Pose a deformation theory problem
The ﬁrst step is to specify exactly what is meant by a deformation
of the given object over a given base (B, b0). In this subsection we’ll
discuss only deformations of curves, but we could equally well work
with smooth varieties of any dimension — as, indeed, we do in the
next subsection. Thus,
• A deformation of a curve C is, as we’ve already seen, simply a ﬂat
family ϕ : X ✲B together with an isomorphism C ≊ϕ−1(b0).
• A deformation of a pointed curve (C, p1, . . . , pk) is a ﬂat family
ϕ : X ✲B with an isomorphism ψ : C ≊ϕ−1(b0) and disjoint
sections σi : B ✲X such that σi(b0) = ψ(pi).

B. Deformation theory
93
• A deformation of a curve C with line bundle L is a ﬂat family
ϕ : X ✲B with isomorphism C ≊ϕ−1(b0), together with a line
bundle L on X and isomorphism L ϕ−1(b0) ≊L.
• A deformation of a map f : C ✲C′ with C and C′ ﬁxed is a map
f : C × B ✲C′ × B whose restriction to C × {b0} is f. Note that
if C′ is a projective space Pn and f is an embedding then, in the
absence of automorphisms of C, a deformation of f over B is
just a map of B into the relevant Hilbert scheme.
• A deformation of a map f : C ✲C′ with C′ ﬁxed is a deformation
X ✲B of C (that is, a ﬂat family ϕ : X ✲B with isomorphism
ψ : C ≊ϕ−1(b0)), together with a map f : X ✲C′ ×B ﬁtting into
a commutative diagram:
C
f
✲C′
❅
❅
❅
❅
ψ
❘
✠




ϕ−1(b0)✲
✲X
f ✲C′ × B
b0
❄
=
b0
❄
∈
B
ϕ
❄
=
B
❄
∋
bo
❄
We could list many further types of deformation but these exam-
ples make it clear how to deﬁne such variations. In these examples, we
haven’t explicitly stated when two deformations are to be considered
equivalent since, in each case, the desired relation is fairly unambigu-
ous. But, differences in how we choose this relation can sometimes
signiﬁcantly affect what problem we’re posing. For example, if we are
interested in studying deformations of an isolated singular point of
a variety X, we don’t care about global deformations of X. We may
therefore deﬁne a deformation of the singularity (X, p) to be a defor-
mation U ✲B of a neighborhood U of p in X, with the equivalence
relation generated by inclusions U ⊂V .
Another issue that is sometimes delicate to address is that of im-
posing side conditions on deformations. For example, among defor-
mations of a curve singularity (C, p) are a subclass called equisingular
deformations. In a complex analytic setting, these are the deforma-
tions that are locally topologically trivial — i.e., deformations U ✲B
of C such that some neighborhood of p is actually a topological ﬁber
bundle over B. This deﬁnition seems perfectly reasonable but hides
a subtle problem: what do we mean, for example, by an equisingular
deformation over Spec(C[ε]/ε2)? This question does have an answer,

94
3. Techniques
albeit a rather complicated one, due to Zariski. However, superﬁcially
very similar questions do not. For example, no satisfactory answer is
known to the analogous question for equigeneric deformation. These
are deformations that preserve the δ-invariant of a singularity (its con-
tribution to the genus of the curve) or, equivalently, the length of the
C-vector space Γ(O ˜U)/Γ(OU) where U is a neighborhood of P in C and
˜U its normalization.
Calculate the space of ﬁrst-order deformations
The second step of the process is in general the most fun. Almost in-
variably, if the deformation theory problem has been set up correctly
in the ﬁrst part, the space of ﬁrst-order deformations will turn out to
be a vector space identiﬁable as a cohomology group associated to a
coherent sheaf on the original object being deformed. We’ve already
seen two examples: the space of ﬁrst-order deformations of a smooth
curve C is the cohomology group H1(C, TC), and the space of ﬁrst-
order deformations of an inclusion X✲✲Pr is the space H0(X, NX/Pr )
of global sections of the normal sheaf NX/Pr of X in Pr . In this sub-
section we give statements that apply to varieties of any dimension,
although our applications will only involve curves. Other examples
are:
1)
The
space
of
ﬁrst-order
deformations
of
a
pointed
variety
(X, p1, . . . , pk) is the vector space H1(X, TX(−p1 −· · · −pk)).
Note that in this example there is a natural map to the space of
deformations of X alone. The induced map on the space of ﬁrst-order
deformations is the obvious one: it’s the map on H1’s associated to
the inclusion TX(−

i pi)✲✲TX in the exact sequence
0
✲TX

−

i
pi
✲✲TX
✲TX/TX

−

i
pi

✲0 .
In particular, if X has no global vector ﬁelds (i.e., H0(X, TX) = 0), then
the space of ﬁrst-order deformations of the points (p1, . . . , pk) on the
ﬁxed variety X is just the space of global sections of TX/TX(−

i pi),
which is just to say the direct sum of the tangent spaces to X at the
points pi. In general, vector ﬁelds on X yield other such deformations.
2) The space of ﬁrst-order deformations of a pair (X, D) with X a
ﬁxed smooth variety and D an effective divisor on X is the space
H0(X, O(D)/O).
Exercise (3.22) Let X = C be a smooth curve of genus g ≥2. The
last statement may be rephrased as saying that the tangent space
to the dth-symmetric product Cd of C at a point D is the space

B. Deformation theory
95
H1(C, O(D)/O), and hence that the cotangent space is
T ∗(Cd) D = H0(C, K/K(−D)).
Now let Σ = {(p, D) : D −p ≥0} ⊂C ×Cd be the universal divisor and
π : Σ ✲Cd and η : Σ ✲C the projections. Show that the cotangent
bundle to Cd may be realized as
T ∗(Cd) = π∗(η∗KC

OΣ).
3) The space of ﬁrst-order deformations of a line bundle L on a ﬁxed
variety X is the space H1(X, O).
This is relatively easy: if L is given with respect to a suitable cover
{Uα} of X by transition functions gαβ then a deformation of L will be
given by transition functions of the form {gαβ+ε·hαβ} where the hαβ
are holomorphic functions satisfying the cocycle rule but otherwise
unrestricted (modulo checking, of course, that cohomologous cocy-
cles give rise to equivalent deformations of L). Note that we could see
this directly by observing that the connected components of Pic(X)
are the tori H1(X, O)/H1(X, Z).
In these terms, we can ask as well when a given section σ of a line
bundle L extends to a deformation L of L. The answer is straight-
forward: if L is given by a cocycle {hαβ} as above and σ is given
with respect to the corresponding trivializations of L by the sections
σα ∈Γ(OUα), then an extension of σ to a section of L on X × I will be
given by sections σα + ε · τα satisfying
(σα + ε · τα) = (gαβ + ε · hαβ) · (σβ + ε · τα),
i.e.,
τα = gαβτβ + hαβσα.
To put this another way, the cup product of the classes σ ∈H0(X, L)
and h ∈H1(X, O) is the class in H1(X, L) represented by the cocycle
{hαβσα}, and the section σ extends to L if and only if this cocycle is
a coboundary.
We may in particular conclude from this that the tangent space at
a point [L] to the locally closed subscheme W r (X) ⊂Pic(X) of line
bundles L having h0(X, L) = r + 1 is the kernel of the map
H1(X, O) ✲Hom(H0(X, L), H1(X, L))
given by cup product. In the case of a curve C, we may dualize this to
see that the cotangent space to the subscheme W r (C) is the annihila-
tor of the image of the multiplication map
H0(C, L)

H0(C, K

L−1) ✲H0(C, K).

96
3. Techniques
4) The space of deformations of a pair (X, L) with X a smooth variety
and L a line bundle on X, X not taken to be ﬁxed, is the space H1(X, ΣL)
where ΣL is the sheaf of ﬁrst-order differential operators in L.
Note that ΣL ﬁts into a nice exact sequence
0
✲OX
✲ΣL
✲TX
✲0,
and that the induced maps of the H1’s representing various ﬁrst-order
deformations are the obvious ones.
Exercise-Warning (3.23) Recall from Section 2.B the moduli space
Pd,g of line bundles of degree d on smooth curves of genus g which
is naturally a bundle over Mg. Show that there is no splitting of the
tangent bundle to Pd,g along the ﬁber of this map over a ﬁxed curve
C that realizes the splitting of H1’s in the exact sequence above.
5) The space of ﬁrst-order deformations of a map f : X ✲Y with X
and Y both ﬁxed is the space of sections H0(X, f ∗TY ) of the pullback
to X of the tangent bundle of Y.
Note in particular that the space of ﬁrst-order deformations of the
identity map X ✲X is just the space H0(X, TX) of global vector ﬁelds
on X.
6) The space of ﬁrst-order deformations of a map f : X ✲Y with only
Y assumed ﬁxed is the space of sections H0(X, Nf ), where Nf is the
normal sheaf of the map f , deﬁned by
Nf = Coker(df : TX ✲f ∗TY ).
(We also, as usual, write NX/Y for Nf when the map f is understood.)
For example, if f were the inclusion of X as a subvariety of Y then we
get the usual deﬁnition of
Nf = TY X/TX = (IX/Y /I2
X/Y )∨.
We can also give a deformation-theoretic interpretation to the long
exact cohomology sequence associated to the short exact sequence
0
✲TX
✲f ∗TY
✲Nf
✲0.
The coboundary δ : H0(Nf ) ✲H1(TX) takes a deformation of the map
f to the corresponding deformation of X, forgetting the map; the
kernel consists of the deformations of the map f ﬁxing both X and
Y, modulo automorphisms of X.
Note that if X ⊂Y ⊂Z is a nested sequence of closed subvarieties,
we can identify when a ﬁrst-order deformation X ⊂Z × I of X is

B. Deformation theory
97
contained in a ﬁrst-order deformation Y ⊂Z × I of Y: we look at the
diagram
NX/Z
α✲NY/Z X
NY/Z
✻
β
and if the image of the deformation [X] ∈H0(NX/Z) under the map
α coincides with the image under β of the class [Y] ∈H0(NY/Z), we’ll
have X ⊂Y.
Exercise (3.24) The classical Noether-Lefschetz theorem says that a
general surface S ⊂P3 of degree d ≥4 contains no curves other than
complete intersections with S. There is in fact a stronger form of this,
which says that if S is any smooth surface of degree d ≥4 and C ⊂S
any curve not a complete intersection with S, then a general ﬁrst-order
deformation of S contains no ﬁrst-order deformation of C. Use this
to prove the:
Proposition (3.25) If S is any smooth surface in P3and C ⊂S is any
smooth curve lying on it, then C is a complete intersection with S if and
only if the normal bundle sequence
0
✲NC/S
✲NC/P3
✲NS/P3 C
✲0
splits.
Warning. The locus of surfaces of degree d having “extra” curves
is a countable collection of varieties, each of which is proper but
whose union is everywhere locally dense. Note also that the propo-
sition above is true even when S has degree 2 or 3.
7) The space of ﬁrst-order deformations of a singular point p of a plane
curve C ⊂A2 given by f (x, y) = 0 is the local ring of C at p modulo
the Jacobian ideal J generated by the partial derivatives ∂f
∂x and ∂f
∂y.
The elements of J amount essentially to trivial deformations ob-
tained by translating the coordinate system at p: e.g., modulo ε2,
fε(x, y) = f (x + ε, y) = f(x, y) + ε ∂f
∂x (x, y).
Thus, ﬁrst-order deformations are given simply by (f + ε · g) for
g ∈OC,p/J. In this form, it’s clear that the description is equally

98
3. Techniques
applicable to any planar curve singularity, i.e., one whose Zariski tan-
gent space is two-dimensional. Note that the node xy = 0 has a one-
dimensional space of ﬁrst-order deformations, given by the family
xy −a as shown schematically in Figure (3.26) for real a centered at
0.
−∞
0
∞
Figure (3.26)
The cusp, on the other hand, has a 2-dimensional deformation space
with family
y2 = x3 + a · x + b ;
the tacnode y2 = x4 has a three-dimensional family
y2 = x4 + a · x2 + b · x + c ;
and the triple point x3 −y3 = 0 has a four-dimensional family
y3 + x3 + a · xy + b · x + c · y + d = 0 .
A fascinating question about these families is: what types of singular-
ities occur in ﬁbers near the central one and, over which loci in the
base does each occur? For example, curves in the ﬁrst family are ei-
ther smooth (in general), nodal (for (a, b) lying on the cuspidal curve
4a3 = 27b2) or cuspidal (only for (a, b) = (0, 0)).
Exercise (3.27) Show that in the deformation of a tacnode we may
see curves with two nodes, one cusp or one node. For which values of
(a, b, c) do each of these possibilities arise?
Exercise (3.28) What singularities or combinations of singularities
occur in the ﬁbers of the deformation of a triple point? Over what loci
in (a, b, c, d)-space do they occur?
We should remark that while the analogous stratiﬁcation of the de-
formation space of any given singularity can, like the simple cases
above, be analyzed by hand, there is no systematic method for deter-
mining which “baskets” of singularities will appear on some ﬁber of
the deformation. One important case is:
Exercise (3.29) Show that in the deformation space of an ordinary
m-fold point there is a ﬁber containing every combination of singu-
larities that appears on some plane curve of degree m.

B. Deformation theory
99
There are, of course, some cases whose spaces of ﬁrst-order defor-
mations aren’t immediately calculable. Examples are the spaces of eq-
uisingular deformations of a curve singularity (C, p) or of equigeneric
deformations (those preserving the geometric genus). Such spaces are
usually not smooth (as in the example of the cusp above where the
equigeneric locus is itself a cuspidal curve). Examples suggest that
they tend to be irreducible, but we know of no general results along
this line. In such cases, it would be tremendously helpful for many
reasons (some of which arise later on in Chapter 5) to have even an
estimate on the dimension of the space of ﬁrst-order deformations,
such as might come from a cohomological interpretation; but none is
known.
8) A very important example is the space of ﬁrst-order deformations of
a singular variety.
This is a subject that requires a fair bit of machinery even in simple
cases and that can become arbitrarily elaborate. To give the ﬂavor,
we’ll ﬁrst state the basic result for local complete intersection varieties
referring you to [150] for proofs and further details. In case X is a local
complete intersection (say X is locally embedded in a smooth variety
V, with ideal sheaf I), we have the conormal sequence
0
✲I/I2
✲ΩV X
✲ΩX
✲0.
Since I/I2 is locally free, when we dualize we get
0
✲ΘX
✲TV X
✲NX/V
where ΘX is the sheaf of derivations of OX and N = NX/V is the dual
of I/I2. We then deﬁne the sheaf
T 1
X = Coker(TV X ) ✲NX/V.
An alternate description is
T 1
X = Ext1
OX(ΩX, OX),
so that T 1
X is a sheaf supported on Xsing. If we then set
(3.30)
T1
X = Ext1
OX(ΩX, OX) ,
it turns out that T1
X is the space of ﬁrst-order deformations of X.
Note that the local-to-global spectral sequence for Ext gives us an
exact sequence
0
✲H1(ΘX)
✲T1
X
✲H0(T 1
X)
✲H2(ΘX)
which has a natural geometric interpretation: ﬁrst-order deformations
of X induce ﬁrst-order deformations of the singularities of X; the
space H1(ΘX) gives deformations of X preserving its singularities.

100
3. Techniques
Of course, the case in which we want to apply this theory is that
of nodal curves. Here we can be more concrete. For example, if C is a
curve with one node at the point p, C is its normalization and q1 and
q2 ∈C are the points lying over the node of C, we can identify ΘC as
the pushforward of the sheaf of vector ﬁelds on C vanishing at q1 and
q2. We then have
H1(C, ΘC) = H1( C, Θ C(−q1 −q2)) ;
that is, the deformations of C preserving the singularity correspond,
as expected, to deformations of the 2-pointed curve ( C, q1, q2).
Still in the nodal curve case, we can identify the sheaf T1 (which is
now a skyscraper sheaf supported at the nodes) as follows. Suppose
the curve C is (locally) embedded in a smooth surface S with ideal
sheaf I given in local analytic coordinates on S by I = (xy), with
p = (0, 0) the node. Locally, the ﬁrst two terms of the exact sequence
0
✲I/I2
α✲(T ∨
S ) C
✲Ω1
C
✲0
look like
OC,p⟨xy⟩✲OC,p⟨dx, dy⟩
with the map α given by
xy ✲x dy + y dx .
Hence Ω1
C looks locally like
OC,p⟨dx, dy⟩
⟨x dy + y dx⟩,
which is locally free of rank 1 except at the node p. Dualizing, we get
the sequence
0
✲Θ
✲TS C
α∨✲NC/S
✲T 1
✲0
with α∨locally the map
OC,p
 ∂
∂x , ∂
∂y
 ✲OC,p⟨xy⟩∨
deﬁned by sending
∂
∂x and
∂
∂y to the linear functionals xy ✲y and
xy ✲x respectively. Since NC/S is generated by the homomorphism
xy ✲1 the image of α∨is exactly Mp,C ·NC/S. Hence, at a node p the
quotient T 1 is isomorphic to the stalk at p of NC/S and, in particular,
has length 1. This description may seem to depend on the embedding,

B. Deformation theory
101
but in fact is intrinsic. If C1 and C2 are the branches of C at p, we have
T 1 = OS(−C)∨
Op
= OS(C)

Op
= OS(C1)

OS(C2)

Op
= Tp(C1)

Tp(C2) ,
which is independent of the choice of S.3
Put another way, this chain of ideas says that:
Proposition (3.31) The normal space to the boundary ∆⊂Mg at a
point corresponding to a curve C with one node is the tensor product
of the tangent spaces to the branches of C at the node.
This is an important fact, which will be essential to making enumera-
tive calculations later on.
Finally, we can put this analysis together with what we’ve seen in
the case of a smooth curve to give an inﬁnitesimal description of the
boundary ∆⊂Mg at an arbitrary point. First, because H2(ΘC) = 0,
we have an exact sequence
0
✲H1(ΘC)
✲T1
X
✲H0(T 1
X)
✲0 .
A ﬁrst consequence is that the space B of ﬁrst-order deformations
again has dimension 3g −3. Identifying a neighborhood of [C] itself
in B with a neighborhood of the origin in C3g−3 identiﬁes the defor-
mations of C preserving each node with a smooth divisor in C3g−3 and
any two of these divisors meet transversely at the origin. Thus,
Proposition (3.32) Let C be a curve without automorphisms. In a
neighborhood of the point [C], the boundary ∆is a normal-crossings
divisor, with branches corresponding one-to-one to the nodes of C and
with the normal space to each branch isomorphic to the tensor product
of the tangent spaces to the branches of C at the corresponding node.
Exercise (3.33) Let B and C be smooth curves of genera g and h
(both at least 2) respectively. Use ﬁrst-order deformations to show
that any deformation of B × C is again a product of two curves. Is it
also true that a deformation of a symmetric product of curves is again
a symmetric product?
3Further discussion and applications of this independence are given in [52]

102
3. Techniques
Construct a versal deformation
As we remarked in the overview (page 86), this is usually very hard
to do “from the inside” — that is, by building up from inﬁnitesimal
deformations. When it’s possible at all, the machinery required goes
well beyond our scope here. Instead, we’ll refer you again to [150]
and, in the next subsection, give a construction that uses the Hilbert
scheme as a “deus-ex-machina”.
Universal deformations of stable curves
In this subsection, we’ll sketch how Hilbert schemes may be used to
construct the universal deformation space of any stable curve. Since
any two universal deformations are locally isomorphic near the cor-
responding base points, we’ll henceforth be able to speak of the germ
of the versal deformation of a stable curve.
We will need the following lemma, which follows immediately from
the description given earlier of the versal deformation space of a node.
Lemma (3.34) Let ϕ : C ✲B be a proper ﬂat family of curves. Then
the set U = {b ∈B|Cb is a nodal curve} is open in B.
Next, ﬁx g ≥2 and an integer n ≥3. Deﬁne integers r and d in
terms of these by
r + 1 = (2 · n −1)(g −1)
and
d = 2 · n(g −1).
Then, let H = Hd,g,r , let P(m) = md −g + 1, let ϕ : C ✲H be the
corresponding universal curve, and let L = OC(1) be the universal
line bundle on C. We will abuse language and also write C and L for
the restrictions of the corresponding objects to subschemes of H .
The lemma shows that the subset U of H parameterizing connected
nodal curves is open in H . Since C ✲U is a family of nodal curves,
it has a relative dualizing sheaf ω = ωC/U. We deﬁne 
K to be the
closed subscheme of U over which the sheaves L and ω⊗n are equal.
More formally, 
K is the subscheme deﬁned by the gth Fitting ideal of
R1ϕ∗(ω⊗n
L−1).
Naively, we refer to 
K as the locus of n-canonically embedded stable
curves. (By Exercise (3.10), we could replace “stable” by “semistable”
or “connected, nodal” in this deﬁnition without altering 
K.) Our plan
to produce a versal deformation of a stable curve C is simple: take a
linear slice of 
K passing through [C] and transverse to the PGL(r +1)-
orbit of [C]. Some extra care is needed in order to be able to check
that the resulting slices are versal when C has nontrivial automor-
phisms. To simplify our presentation, we assume that C has no auto-

B. Deformation theory
103
morphisms and, after going through the construction, indicate what
modiﬁcations are needed to handle curves with automorphisms.
The ﬁrst key fact we need is:
Lemma (3.35) 
K is smooth of dimension (3g −3) + (r 2 + 2r).
Proof.
Fix an n-canonically embedded stable curve C with Hilbert
point [C] in 
K. The dimension count for 
K is clear: the curve C de-
pends on 3g−3 moduli and the choice of a basis of H0(C, ω⊗n) (mod-
ulo scalars) on r 2 + 2r.
Now, the restriction to C of the tangent bundle to Pr is a quotient of
a direct sum of r +1 copies of OPr (1). Since OPr (1) restricts to ω⊗n on
C, it follows immediately from the standard normal sheaf sequence
that H1(C, NC/Pr ) = 0 and hence that the tangent space H0(C, NC/Pr )
to H at [C] has the expected dimension (3g −3)+g +(r 2 +2r). (The
extra g parameters are for the choice of a line bundle of degree d on
C.) Thus, the smoothness of 
K would follow if we could solve the:
Problem (3.36) Describe the subspace of H0(C, NC/Pr ) correspond-
ing to tangent vectors to 
K, and show that it has codimension g.
Lacking an answer to this problem, we take an indirect approach.
Let J be the subscheme of H consisting of the Hilbert points of those
subcurves C′ ⊂Pr that are abstractly isomorphic to C (i.e., that cor-
respond to different choices of line bundle and basis of sections on
C). The dimension of J is therefore g + (r 2 + 2r). The intersection of
J and 
K is just the PGL(r + 1)-orbit of [C]. We claim that the tan-
gent space to J ∩
K has dimension (r 2 + 2r). In view of parameter
counts above, this is only possible if the tangent spaces to both J and

K have the minimal possible dimension and hence will imply that 
K
(and incidentally J) is smooth at [C]. Let C ✲H denote the universal
curve over the Hilbert scheme H . Consider the diagram determined
by a general tangent vector χ : I ✲H to H :
C ✛π1
D
ξ ✲C
I
π2
❄
χ ✲H
❄
1
Such a vector is tangent to J if and only if D is a ﬁrst order isotrivial
deformation of C and thus corresponds to such a diagram for which
the ﬁber product D is isomorphic to C ×I. It’s tangent to 
K if and only
if D ✲I is an n-canonical curve, i.e., ξ∗(OC(1)) = ω⊗n
D/I. Therefore,
it’s tangent to J ∩
K if and only if ξ∗(OC(1)) = ω⊗n
C×I/I = OI

ω⊗n
C . In

104
3. Techniques
other words, the choice of χ is equivalent to the choice of a basis of
the space
H0(I, (π2)∗(OI

ω⊗n
C )) = OI

H0(C, ω⊗n
C ).
Since H0(C, ω⊗n
C ) = r +1, this choice depends on (r 2+2r) parameters
as claimed.
Now we’re ready to slice 
K assuming that C has no automorphisms.
First, let W = ΛP(m)(H0(Pr , O(m))∨) where m is taken large enough
that H embeds in P(W) as in Chapter 1. Next, choose a linear sub-
space V in P(W) containing [C] that is complementary to the tangent
space to the orbit of [C]. Finally, choose an afﬁne neighborhood Y of
[C] in 
K ∩V that is small enough that, for every point [C′] ∈Y, the
curve C′ has no automorphisms and its orbit meets Y transversely.
Claim (3.37) ϕ : C ✲Y is a universal deformation of any of its ﬁbers.
Let’s
ﬁrst
show
this
for
C
itself.
Fix
another
deformation
ψ : D ✲(Z, z0) of C with identiﬁcation of Dz0 ≊C. The point [C]
determines a canonical basis of H0(C, ω⊗n
C ) which we may view as a
basis of H0(Dz0, ω⊗n
Dz0 ) and extend to a basis for ψ∗(ω⊗n
D/Z) near
z0. This in turn embeds ψ : D ✲Z as a family of subschemes of Pr .
By the universal property of the Hilbert scheme, this is induced by a
unique map χ : Z ✲H which by construction has image in 
K and ﬁts
into a commutative square
(3.38)
D
ξ ✲C
Z
ψ
❄
χ ✲
K
❄
ϕ
The map χ is close to the pullback we want and all that remains is
to use the PGL(r + 1)-action to adjust it so that its image actually
lies in Y. To arrange this, note ﬁrst that our transversality hypothesis
implies that the multiplication map µ : PGL(r + 1) × Y ✲
K is an
isomorphism near (id, [C]). We can therefore, after possibly shrinking
Z, deﬁne for z near z0 germs ρ : Z ✲Y ⊂
K and σ : Z ✲PGL(r +1) by
ρ = πY ◦µ−1 ◦χ and σ = πPGL(r+1) ◦µ−1 ◦χ. These give a factorization
of χ in the sense that
χ(z) = µ (σ(z), ρ(z)) or χ = µ ◦(σ, ρ) .
On the other hand, σ is injective by construction, so we may also
deﬁne maps χ′ : Z ✲
K and ξ′ : D ✲C by setting χ′ = µ ◦(σ −1, χ)

B. Deformation theory
105
and ξ′ = µ ◦((σ ◦ψ)−1, χ), and, since PGL(r +1) acts equivariantly on
ϕ : C ✲
K, the diagram (3.38) remains commutative if we replace the
maps χ and ξ by χ′ and ξ′. The factorization identity above, however,
says that χ′ = ρ and hence that χ′ be viewed as a map χ′ : Z ✲Y and
ξ′ as a map to C Y . We have therefore produced the desired pullback
D
ξ′ ✲C Y
Z
ψ
❄
χ′ ✲Y
❄
ϕ Y
once we check that we have compatible identiﬁcations of the ﬁber of
C Y over χ′(z0) with C and Dz0. This follows immediately since, by
construction, σ maps z0 to the identity in PGL(r + 1).
Uniqueness for χ′ follows directly from the universality of the
Hilbert scheme. Further, the claim follows for any ﬁber by observ-
ing that the only property of C itself that is used is transversality of
the orbit of [C] to Y and that this, by construction, holds for every
ﬁber. We note, for future reference, that something almost as good —
usually referred to as “openness of versality” is automatically true.
Exercise (3.39) Show that, if ϕ : (X, X) ✲(Y, 0) is a versal deforma-
tion of X, then it’s also a versal deformation of the ﬁber Xy for every
y in some open neighborhood of 0.
Essentially the same ideas work when [C] has a nontrivial stabi-
lizer G in PGL(r + 1) if we take account of these to maintain suitable
equivariance at each step. The neighborhood Y must be chosen to be
G-equivariant (by intersecting with any G-translates) and shrunk, if
necessary, so that the stabilizer of any y ∈Y lies in G — this in turn
requires showing that Y can be chosen so that if g ∈PGL(r + 1) and
gY meets y, then g ∈G.
Similar arguments also produce versal deformations for curves with
marked points. We leave it to you to supply the necessary minor mod-
iﬁcations in case you’re interested.
Deformations of maps
We now consider a second example of deformation theory: the de-
formations of a map. We will describe here the space of ﬁrst-order
deformations of a map, and the Kodaira-Spencer map associated to
a family of maps, which associates to a tangent vector to the base of
a family of maps the corresponding ﬁrst-order deformation. Versal

106
3. Techniques
deformation spaces for maps do exist (at least when the target and
domain are reasonably well-behaved schemes, such as local complete
intersections), but we won’t prove this here; rather, we’ll assert it and
deduce as a consequence a dimension estimate for the space of maps
of curves to the plane. In particular, we’ll be able to conclude, as a
corollary, the second part of Theorem (1.49)
The Kodaira-Spencer map
To keep things relatively simple, we’ll concentrate on maps between
smooth varieties; that is, we’ll be concerned with families of maps
from a possibly variable smooth domain to a ﬁxed smooth target
space. In other words, we’ll consider a ﬂat, smooth, proper family
f : X ✲B over a smooth connected base B, a smooth variety Y and
a morphism ψ : X ✲B × Y of B-schemes. For each b ∈B, we let
ψb : Xb ✲Y be the restriction of ψ to the ﬁber Xb of X over b, and
let
dψb : TXb
✲ψ∗
b TY
be the differential of ψb. We let Nb be the normal sheaf of ψb, that is,
the cokernel of the morphism dψb of sheaves on Xb. Equivalently, if
we let
dψ : TX
✲ψ∗T(B × Y)
be the differential of ψ and N = Coker(dψ) the normal sheaf of ψ,
then the normal sheaf Nb of ψb is the restriction of N to the ﬁber Xb,
that is, Nb = N

OXb . Note that if ψb is an immersion, then Nb will
be locally free; more generally, if ψb is equidimensional onto its image
then the sheaf Nb will have a torsion subsheaf supported exactly on
the locus where dψb fails to be an injective bundle map.
We now describe the Kodaira-Spencer map of the family ψ of mor-
phisms. This is a map Υ : TbB ✲H0(Xb, Nb) that associates to any tan-
gent vector v ∈TbB a global section σ = Υ(v) of the normal sheaf, in
such a way that the family is trivial — that is, the family X ≊B ×Xb as
B-schemes and the morphism ψ = idB × ψb — if and only if Υ(v) = 0
for every v. To deﬁne it, let π : B × Y ✲B be the projection, so that
we have an inclusion of bundles
π∗TB✲✲TB×Y .
We let i : ψ∗π∗TB✲✲ψ∗T(B × Y) be the corresponding inclusion of
pullbacks to X, and let Υ : ψ∗π∗TB ✲N be the composition of i

B. Deformation theory
107
with the surjection ψ∗TB×Y ✲N as shown in the diagram
ψ∗π∗TB
❅
❅
❅
❅
Υ
❘
0
✲TX
dψ✲ψ∗TB×Y
❄
❄
✲N
✲0
Restricting to Xb and taking global sections, we get a map
Υb : TbB✲✲H0(Xb, ψ∗π∗TB)
✲H0(Xb, Nb) ,
which we’ll call the Kodaira-Spencer map of the given family at b.
Equivalently, we let Υ be the pushforward of Υ to B, composed with
the inclusion of TB into f∗ψ∗π∗TB: that is,
Υ = f∗Υ : TB✲✲f∗ψ∗π∗TB
✲f∗N .
We will call Υ the global Kodaira-Spencer map of the family; the maps
Υb are then the composition of the induced maps TbB ✲(f∗N )b on
stalks with the natural maps (f∗N )b ✲H0(Xb, Nb).
There are two main facts to be stated in connection with this con-
struction. The ﬁrst, which can (and will) be left to you as an exercise,
is simply that for any map ψ0 : X ✲Y of smooth varieties, the space
of ﬁrst-order deformations of ψ0 is H0(X, N), where N is the normal
sheaf of ψ0. The second, which is (as usual) substantially harder, is
that there exists a versal deformation space for ψ0, that is, there is a
deformation X ✲B of X ≊X0 and map ψ : X ✲B × Y over B with
ψ X0 = ψ0, such that:
1. every deformation of the map ψ0 is locally a pullback of (X, ψ),
and,
2. the tangent space to B at 0 is the space of ﬁrst-order deforma-
tions of ψ0; that is, the Kodaira-Spencer map Υ0 of (X, ψ) at 0
is an isomorphism.
For proofs of these two facts, see [87] and [88] respectively.
Exercise (3.40) Let ψ : X ✲Y be any map of smooth varieties and
let N be the normal sheaf of ψ. Show that the Kodaira-Spencer map
gives an isomorphism of the space of ﬁrst-order deformations of ψ
with H0(X, N).
Dimension counts for plane curves
The most common application of these facts is a dimension count. It
follows from the existence of the versal deformation space that if the

108
3. Techniques
family ψ of morphisms is nowhere isotrivial (that is, the restriction of
ψ to the subfamily XB0 = f −1(B0) ⊂X isn’t trivial for any analytic arc
B0 ⊂B), then at a general point b ∈B the map Υb must be injective,
so that we have an a priori bound on the dimension of the family:
dim(B) ≤h0(Xb, Nb) .
Moreover, the Chern classes of the normal sheaf are in general read-
ily calculated, so that in many cases it may be possible to estimate
h0(Xb, Nb), giving us an upper bound on the dimensions of families
of maps.
This is exactly what we need, for example, to estimate the dimension
of the Severi variety Vd,g of reduced plane curves of given degree and
geometric genus. To set this up, let C ⊂Vd,g × P2 be the universal
curve, X = C the normalization of the total space C, and U ⊂Vd,g
the dense open subset of Vd,g over which the map X ✲C ✲Vd,g is
smooth; let ψ : X ✲U × P2. If [C0] ∈U is a general point, so that
X0 is a smooth curve of genus g and ψ0 : X0 ✲C0 ⊂P2 a birational
embedding of X0 as a plane curve of degree d, then the normal sheaf
N0 of ψ0 is a rank 1 sheaf on the curve X0, the degree of whose Chern
class is
deg(c1(N0)) = deg(c1(ψ∗
0 TP2)) −deg(c1(TX0))
= 3d + 2g −2
> 2g −2 .
We would thus expect that
dim(U) ≤h0(X0, N0)
= deg(c1(N0)) −g + 1
= 3d + g −1 .
We cannot, however, conclude this yet. The difﬁculty arises from the
possibility that ψ0 isn’t an immersion: if the differential dψ0 vanishes
at points of X0, the sheaf N0 will have torsion there, and in this case
the quotient N0/(N0)tors (and hence N0 itself) may well be special. In
such a case, the dimension h0(X0, N0) will indeed be larger than the
naive estimate 3d + g −1 for the dimension of our family, and the
method appears to fail.
Happily, there is a standard result, due to Arbarello and Cor-
nalba [4], that deals with this situation. We have:

B. Deformation theory
109
Lemma (3.41) Let X ✲B be a ﬂat smooth proper family, Y a smooth
variety and ψ : X ✲B × Y a morphism of B-schemes; assume that
ψ : X ✲B × Y is birational onto its image. If b ∈B is a general point,
then
Im(Υb) ∩H0(Xb, (Nb)tors) = 0 .
Remarks. 1) If we don’t assume the map ψ is birational onto its im-
age, the conclusion of the lemma may well be false. In fact, it will fail
when the map ψb : Xb ✲Y is multiple-to-one, with constant image
but variable branch points.
2) While we won’t introduce the deﬁnitions needed to make this pre-
cise, another way to express this lemma is to say that “the ﬁrst-order
deformation of the map ψb corresponding to a torsion section of Nb
can never be equisingular”. If b ∈B is general, the ﬁrst-order defor-
mations of ψb arising from the family ψ : X ✲B × Y are necessarily
equisingular; it follows that they can’t be torsion.
Proof.
Note ﬁrst that, using the analytic topology, it’s enough
to prove the lemma in case B is one-dimensional: if we had
Im(Υb) ∩H0(Xb, (Nb)tors) ̸= 0 at general b ∈B, we could in an an-
alytic neighborhood of b restrict to a curve whose tangent space was
contained in (Υb)−1(H0(Xb, (Nb)tors)) at each point.
We may thus assume that ψ : X ✲B×Y is a one-parameter family of
maps, the image of whose Kodaira-Spencer map Υb at a general point
is contained in H0(Xb, (Nb)tors). Let Z = ψ(X) ⊂B × Y be the image
of X and p ∈X a general point with image ψ(p) = (b, q) ∈B × Y.
We’re assuming that for any v ∈TbB, the image Υb(v) vanishes at p;
that is, the tangent space T(b,q)Z is of the form
T(b,q)Z = TbB × Λp
for some linear subspace Λp ⊂TqY.
Now, let t be a local analytic coordinate on B near b, and let
(x, y1, . . . , yn) be local coordinates on Y near q such that ψ∗
b x is a
local coordinate on Xb near p (so that the pair (t, x) give local co-
ordinates on the surface X near p). We can write the map ψ locally
as
yi = fi(t, x),
i = 1, . . . , n .
The tangent space T(b,q)Z is then the zero locus of the linear forms
dyi −∂fi
∂t dt −∂fi
∂x dx
and the statement that T(b,q)Z = TbB × Λp for some linear subspace
Λp ⊂TqY says that ∂fi
∂t vanishes identically near p. We deduce that the
image of ψb is constant, that is, that near (b, q) the image Z is equal

110
3. Techniques
to the product of a neighborhood of b ∈B with a neighborhood of
p ∈Xb.
This being true for general p ∈X, it follows that Z = B × ψb(Xb)
everywhere. Finally, since the map ψ is assumed birational, it follows
that X is the normalization of Z; thus it’s likewise a product, the map
ψ = idB × ψb and the Kodaira-Spencer map is identically zero.
To restate the lemma, if we let
Υb : TbB
✲H0(Xb, Nb/(Nb)tors)
be the composition of Υb with the natural map
H0(Nb)
✲H0(Xb, Nb/(Nb)tors) ,
then the lemma implies that Υb is an injection modulo the kernel of
Υb, that is, ker(Υb) = ker(Υb); in particular, if the family ψ is nowhere
isotrivial then for general b ∈B the map Υb is injective, and hence
dim B ≤h0(Xb, Nb/(Nb)tors) .
This is plenty to ﬁx the argument given above for plane curves; in
fact, it gives us a bit more. All we have to observe if that for any line
bundle L of degree d on a smooth curve X of genus g, h0(X, L) is
d−g +1 if L is nonspecial, and at most g if L is special. Now, suppose
that N is any rank 1 sheaf on X and c1(N) ≥2g. If the torsion part of
N has length e, so that deg(N/Ntors) = c1(N) −e, we have
h0(X, N/Ntors) ≤max{d −e −g + 1, g} ≤c1(N) −g + 1 ,
with equality holding if and only if N is torsion-free. Now, let
[Cb] ∈Vd,g be a general point of any component of the Severi va-
riety Vd,g as before, Xb ✲Cb the normalization and Nb the normal
sheaf of the map ψb : Xb ✲Cb ⊂P2. Applying Lemma (3.41) and the
naive dimension estimate above, we have the:
Corollary (3.42) The
dimension
of
the
Severi
variety
Vd,g
is
3d + g −1; and for [Cb] ∈Vd,g general, the map Xb ✲Cb ⊂P2 is
an immersion and the Kodaira-Spencer map Υb is onto.
Now, to complete the proof of part 2 of Theorem (1.49), we simply
need to establish the:
Lemma (3.43) Cb has no triple points or tacnodes.
Proof.
The assertion of the lemma is that the map ψb is never three-
to-one, and where ψb(p) = ψb(q) for p ̸= q ∈Xb, the images of the
differentials d(ψb)p and d(ψb)q aren’t equal. This also follows from

B. Deformation theory
111
an analysis of the Kodaira-Spencer map. For the ﬁrst, suppose that
p, q and r are any three points of Xb mapping to the same point of
Cb. If σ were a section of Nb vanishing at p and q, then under the
corresponding ﬁrst-order deformation of the map ψb, the point of
intersection of the images of neighborhoods of p and q in Xb would
be stationary; in order to preserve the triple point of Cb, then, σ would
have to vanish at r as well.
Thus, to show that a general Cb has no triple points it’s enough to
show that if p, q and r are any three points of Xb then there exists a
section of Nb vanishing at p and q but not at r. But this is immediate:
Nb is a line bundle of degree 3d+2g−2 > 2g+1, so of course the three
points p, q and r impose independent conditions on H0(Xb, Nb).
Similarly, to show that a general Cb has no tacnodes it’s enough to
show that if p, q ∈Xb are points mapping to the same point in P2,
there exists a section of the sheaf Nb vanishing at p but not at q, which
follows from the same argument.
Deformations of maps with tangency conditions
Like the deformation theory of varieties, the deformation theory of
maps admits many variations. We will illustrate this by extending here
the results obtained in the preceding subsection to deformations of
a map X ✲P2 that preserve tangency conditions with respect to a
ﬁxed line L ⊂P2. This choice of topic is motivated in part by future
applications: these extended dimension counts turn out to be crucial
in the proof of part 3 of Theorem (1.49) (that is, the irreducibility of
the Severi varieties), which we’ll carry out in Section 6.E.
The key question here is: if ψ : X ✲P2 is a map that has a point
of tangency with L — that is, a point q ∈X such that the pullback
ψ∗(L) has multiplicity m at q — then, in the space of all deformations
of the map ψ, can we identify the subspace of those preserving the
tangency condition? In particular, can we describe the tangent space
to this subspace as a subspace of H0(X, N)?
To set this up, let X ✲B be as above a smooth family of curves
over a reduced base B, ψ : X ✲B × P2 a morphism of B-schemes, and
Q ⊂X a section of X over B such that the pullback divisor ψ∗(L)
contains the section Q with multiplicity exactly m. Let b ∈B be a
general point and q = Xb ∩Q; suppose ψ(q) = p ∈L. Let v ∈TbB,
σ = Υb(v) ∈H0(Xb, Nb) the corresponding ﬁrst-order deformation,
and σ = Υb(v) ∈H0(Xb, Nb/(Nb)tors). Suppose ﬁnally that the differ-
ential dψb vanishes to order l −1 at q, so that the image ψb(∆) of a
small neighborhood ∆of q ∈Xb will have multiplicity l at p. We then
have the:

112
3. Techniques
Lemma (3.44) σ vanishes to order at least m −l at q, and cannot
vanish to order exactly k for any k with m −l < k < m. Moreover, if
ψ Q is constant, σ vanishes to order at least m at q.
Proof.
It will be sufﬁcient to do this in case B is one-dimensional.
Next, since B is reduced and b ∈B is general, B is smooth at b. Finally,
since again b ∈B is general we may assume that the divisor ψ∗
b L on
Xb contains the point q with multiplicity exactly m as well.
Now, choose coordinates (x, y) in an analytic neighborhood of
p = ψ(q) so that the line L is given simply as the zero locus of y.
Let then
∂
∂x and
∂
∂y be the generators of the rank 2 bundle TY at p;
we’ll abuse notation and write
∂
∂x and
∂
∂y also for the corresponding
sections of ψ∗
b TY .
The ﬁrst thing we’ll show is that the image of
∂
∂x in Nb/(Nb)tors
vanishes to order m −l at q.
We treat the case l < m ﬁrst for simplicity, and leave the case l = m
for later. Let t be an mth root of ψ∗
b y in a neighborhood of q ∈Xb,
then t will be a local coordinate on Xb near q and the map ψb will be
given as
ψb : t
✲(tl + cl+1tl+1 + · · · , tm)
so that the differential dψb is given by
dψb : ∂
∂t
✲
ltl−1 + (l + 1)cl+1tl + · · ·
 ∂
∂x + mtm−1 ∂
∂y
= tl−1
l + (l + 1)cl+1t + · · ·
 ∂
∂x + mtm−l ∂
∂y

Set
τ(t) :=

l + (l + 1)cl+1t + · · ·
 ∂
∂x + mtm−l ∂
∂y .
The torsion subsheaf (Nb)tors ⊂Nb is isomorphic to OXb/ml−1
q
, and is
generated by the section τ(t). Moreover, the quotient
Nb/(Nb)tors = OXb
! ∂
∂x , ∂
∂y
"#
⟨τ⟩
is generated by the image of the section
∂
∂y. Note ﬁnally that modulo
the subsheaf generated by τ,
∂
∂x ∼
mtm−l
l + (l + 1)cl+1t + · · · · ∂
∂y
so that the image of the section
∂
∂x in Nb/(Nb)tors vanishes to order
exactly m −l at q.

B. Deformation theory
113
Now let t and ε be local coordinates on X, with ε a local coordinate
on B. A general deformation ψ of the map ψb over the base B may be
given modulo ε2 by
ψ(t, ε) =

ε ; tl+cl+1tl+1+· · ·+ε(α0+α1t+· · ·), tm+ε(β0+β1t+· · ·)

.
The condition that the divisor ψ∗((y)) = mQ near q says that we
can take t to be an mth root of the pullback ψ∗(y) not just on Xb, but
in a neighborhood of q in X. This means that a deformation satisfying
the hypotheses of the lemma may be written modulo ε2 as
ψ(t, ε) =

ε; tl + cl+1tl+1 + · · · + ε(α0 + α1t + · · ·), tm
.
From the deﬁnitions, the image Υb( ∂
∂ε) ∈H0(Xb, Nb) of the tangent
vector ∂
∂ε ∈TbB under the Kodaira-Spencer map will be given as the
image in Nb of
σ := Υb
 ∂
∂ε

= (α0 + α1t + · · ·) ∂
∂x ,
whose image σ in Nb/(Nb)tors, as we’ve seen, vanishes to order at least
m −l at q. Moreover, since b ∈B is general, the differential dψε will
vanish to order l −1 at Xε ∩Q for all ε near b; that is, tl−1|dψε. This
implies that
α1 = α2 = . . . = αl−1 = 0 ;
or in other words, the order of vanishing of σ at p can’t equal
m −l + 1, . . . , m −1. To complete the proof in case m > l, the further
condition that ψ Q is constant says that α0 = 0, which further implies
that σ vanishes to order at least m at q.
The case m = l is completely analogous. As before we write the map
ψb as
ψb : t
✲(tn + cn+1tn+1 + · · · , tm)
where now n ≥m. We leave it to you to check that the same argument
yields that if ψ Q is constant, the section σ vanishes to order at least
m at q.
We will apply Lemma (3.44) to obtain an estimate on the dimen-
sion of the varieties parameterizing plane curves of given degree and
genus satisfying certain tangency conditions with respect to a line.
First, some deﬁnitions. We ﬁx again a line L ⊂P2, and also a ﬁnite
subset S = {p1, . . . , pk} ⊂L. For any positive integer β, we deﬁne the
generalized Severi variety V β
d,g to be the closure, in the space PN of
all plane curves of degree d, of the locus of reduced, irreducible plane
curves C ⊂P2 of geometric genus g such that if ψ0 : X ✲C is the
normalization map, then
#(ψ−1
0 (L \ S)) ≤β .

114
3. Techniques
The variety V β
d,g will in general be very reducible: for example, in the
simplest nontrivial case β = d−1, the general member of a component
of V β
d,g may either pass through a point of S, or be simply tangent to
L at a general point. In the case β = d−2, there are six possibilities. A
general point [C0] ∈V β
d,g may correspond to a curve that has a node
at a point of S, is tangent to L at a point of S, passes through two
points of S, passes through one point of S and is tangent to L at a
general point, is tangent to L at two general points, or has a ﬂex along
L. In general, though, as the dimension estimates we derive here will
show, the dimension will depend only on β.
Lemma (3.45) The generalized Severi variety V β
d,g has dimension
2d + g −1 + β everywhere. Moreover, if [C] is a general point of any
component of V β
d,g and ψ0 : X ✲C ⊂P2 is the normalization map,
then
1) ψ0 is an immersion;
2) the only singularities of C away from S are nodes;
3) C is smooth along L \ S; and
4) #(ψ−1
0 (L \ S)) = β.
Proof.
To begin with, it follows from a straightforward dimension
count that V β
d,g has dimension at least 2d + g −1 + β everywhere.
We thus have to show that dim V β
d,g ≤2d + g −1 + β everywhere.
Let C ⊂V β
d,g × P2 be the universal curve over V β
d,g, ψ : C ✲C the
normalization of the total space, U ⊂V β
d,g the open subset over which
the map C ✲V β
d,g is smooth, and X the inverse image of U in C, so
that π : X ✲U is a family of smooth curves of genus g.
Let [C] ∈U be a general point, X ✲C ⊂P2 the normalization and
N the normal sheaf of the map ψ0 = ψ X : X ✲C ⊂P2. Write
ψ−1
0 (L) =
β

i=1
mi · qi +
β

i=1
ni · ri
where ψ0(qi) ∈S. By the deﬁnition of V β
d,g and the fact that [C] ∈U
is general, we have, in an analytic neighborhood of [X], collections of
sections {Qi} and {Ri} ⊂X such that
ψ(Qi) ⊂S
(so that in particular ψ Qi is constant),
ψ∗(L) =
β

i=1
mi · Qi +
β

i=1
ni · Ri .

B. Deformation theory
115
and
qi = Qi ∩X
and
ri = Ri ∩X .
We may assume that the points {qi} and {ri} are distinct: if not, then
the component V of V β
d,g in which the curve [C] is general would
also be a component of a Severi variety V β′
d,g for some β′ < β. Our
argument will then show that the dimension of V is bounded above
by 2d + g −1 + β′ < 2d + g −1 + β.
We need to introduce one more bit of notation. We denote by li −1
the order of vanishing of the differential dψ0 at the point ri. We then
deﬁne divisors D and D0 ∈Div(X) by
D =
β

i=1
mi · qi +
β

i=1
(ni −1) · ri
and
D0 =
β

i=1
(li −1) · ri .
Note that
deg(D) = d −β
and that
deg

(ψ∗
0 OP2(1))(−D)

≥0 .
Note also that
deg (c1(Ntors)) ≥deg(D0) ,
with equality holding if and only if ψ0 is an immersion away from
{ri}. Hence
deg (c1(N/Ntors)) ≤deg(c1(N)) −deg(D0) ,
again with equality holding if and only if ψ0 is an immersion away
from {ri}.
Finally, let D1 be the effective part of D −D0.
Now, applying Lemma (3.41) and Lemma (3.44), we see that
dim U ≤h0(X, (N/Ntors)(−D1)) .
We have
deg ((N/Ntors)(−D1)) ≤deg(c1(N)) −deg(D)
and since
c1(N) = ψ∗
0 OP2(3)

ωX
we see that the line bundle
(c1(N)(−D))

ω−1
X =

(ψ∗
0 OP2(1))(−D)
 
ψ∗
0 OP2(2)

116
3. Techniques
has strictly positive degree. We may thus conclude that
dim U ≤h0(X, (N/Ntors)(−D1))
≤deg (c1(N)(−D)) −g + 1
= (3d + 2g −2 −deg(D)) −g + 1
= 2d + g −1 + β .
This completes the proof of the dimension statement in Lemma (3.45).
Notice that the argument above implies that the image of the
Kodaira-Spencer map can be identiﬁed as follows:
Im

Υ[C]

= H0(X, (N/Ntors)(−D1)) .
To prove the second half of Lemma (3.45), we start by establishing
what is perhaps the subtlest point: that the map ψ0 is indeed an im-
mersion. In fact, much of this has already been accomplished in the
proof of the ﬁrst half: since the line bundle (c1(N)(−D)

ω−1
X
on X
has degree at least 2, we may deduce that
(N/Ntors)(−D1) = c1(N)(−D)
so that D1 = D −D0 and
N/Ntors = c1(N)(−D0)
and hence ψ0 is an immersion away from {ri}.
To see that ψ0 is an immersion at the point ri, we observe that the
line bundle

c1(N)(−D)

ω−1
X
has degree at least 4 on X0, so that
there exists a section σ of c1(N)(−D) = (N/Ntors)(−D1) vanishing
to order exactly 1 at ri, and this section must be in the image of the
Kodaira-Spencer map
Υ[X] : T[X]V
✲H0(X, (N/Ntors)).
But the multiplicity of ri in the divisor D1 = D −D0 is
(ni −1) −(li −1) = ni −li ,
and it follows that σ, viewed as a section of N/Ntors, vanishes to order
exactly ni −li + 1 at ri. By Lemma (3.44), then, we must have li = 1;
that is, ψ0 must be an immersion at ri.
Next, to show that X has only nodes as singularities away from S,
we have to show it has no triple points and that no two branches are
tangent to each other. This is simply a variant of the argument given
in the proof of Lemma (3.43), replacing N by N(−D): for example, to

C. Stable reduction
117
show there are no triple points, it’s enough to show that for any three
points p, q, r ∈X there exists a section of N(−D) vanishing at p and
q but not at r, which follows immediately by degree considerations.
Similarly, to establish part 3, we simply have to argue that for any two
points p and q of ψ−1
0 (L \ S), there is a ﬁrst-order deformation that
varies ψ0(p) but not ψ0(q).
Finally, the fact that #(ψ−1
0 (L\S)) = β is an immediate consequence
of the dimension count in the ﬁrst part of the lemma.
We mention, for future application, that the result of Lemma (3.45)
doesn’t depend on the hypothesis that the general member of V β
d,g is
irreducible. In fact, we can derive the following more general state-
ment as a corollary.
Corollary (3.46) Let L in P2 be a line and let S be any ﬁnite subset.
Let V ⊂PN be any locally closed subset of the space PN of plane curves
of degree d, and let [C] ∈V be a general point. Suppose that the curve
C is the image of an abstract nodal curve X of geometric genus g under
a map η : X ✲C that isn’t constant on any connected component of X
and such that the inverse image η−1(L \ S) contains at most β points.
Then
dim V ≤2d + g + β −1 ,
and if equality holds, then C is a nodal curve smooth at its points of
intersection with L \ S.
Proof.
This follows by simply applying Lemma (3.45) to each com-
ponent of C in turn.
C
Stable reduction
Results
It’s a basic fact, quoted without proof above, that the moduli space Mg
of stable curves of genus g is compact and separated. According to the
valuative criterion for properness, the compactness property implies
that any regular map from the complement of a point on a smooth
curve to Mg admits an extension to a regular map on the whole curve.
Likewise, the separability of Mg can be viewed as asserting that this
extension is unique.
As remarked in Chapter 1, a map of a smooth curve B, punctured or
not, to a coarse moduli space Mg corresponds (possibly after a base
change to rigidify) to a family of stable curves over a branched cover
of B. It should therefore follow that:

118
3. Techniques
Proposition (3.47) (Stable reduction) Let B be a smooth curve,
0 a point of B and B∗= B \ {0}. Let X ✲B∗be a ﬂat family of sta-
ble curves of genus g ≥2. Then there exists a branched cover B′ ✲B
totally ramiﬁed over 0 and a family X′ ✲B′ of stable curves extend-
ing the ﬁber product X ×B∗B′. Moreover, any two such extensions are
dominated by a third. In particular, their special ﬁbers — those over
the preimage of 0 in B′ — are isomorphic.
The process of ﬁnding the family X′ ✲B′ is called stable reduction.
It arises quite frequently in practice, since even geometrically smooth
families of curves (e.g., linear systems of curves on a surface, fami-
lies of branched covers) are apt to specialize to nonstable curves —
curves with a cusp or worse singularity, or curves with multiple com-
ponents. In this circumstance, we’re assured in the abstract that we
can, in any one-parameter subfamily with smooth base, replace the
unstable ﬁbers with stable ones by making a base change and bira-
tional modiﬁcation. For many purposes, we need to know not just
that this can be done, but what stable curves actually appear as limits
of one-parameter subfamilies tending to an unstable curve.
Sometimes the geometry of the specialization gives us a good idea
of what special ﬁber to expect. For example, in a general pencil of
plane quartics degenerating to a double conic, we might guess that
the special ﬁber will be a (smooth) hyperelliptic curve (this is worked
out in the following subsection). In other cases (many examples are
given below), what the stable reduction will be is far from clear.
One warning we should offer here is that we cannot necessarily take
the total space of the family X′ ✲B′ to be smooth. It will, however,
have only a very limited range of possible singularities: by the descrip-
tion above of the versal deformation space of a node, any singularity
of X’ will be given locally by the equation xy −tk for some k (in the
usual terminology, will be an Ak−1 singularity). These can be resolved
by blowing up to obtain an exceptional divisor consisting of a chain of
k −1 rational curves each appearing with multiplicity 1 in the ﬁber of
the blown-up surface over the origin 0 ∈B. Recalling from Section 2.C
that a connected curve C is semistable if it has only nodes as singu-
larities and if each rational component of the normalization ˜
C of C
contains at least 2 (as opposed to 3) points lying over nodes of C, we
then have the:
Proposition (3.48) (semistable Reduction) Let B be a smooth
curve, 0 a point of B and B∗= B \ {0}. Let X ✲B∗be a ﬂat fam-
ily of semistable curves of genus g ≥2. Then there exists a branched
cover B′ ✲B totally ramiﬁed over 0 and a family X′ ✲B′ of semistable
curves extending the ﬁber product X ×B∗B′ and having smooth total
space X′. Any two such extensions are dominated by third and so have

C. Stable reduction
119
special ﬁbers whose stable models — obtained by contracting smooth
rational components meeting the rest of the curve in fewer than three
points — are isomorphic.
This will be useful in a number of situations: for example, when we
have a line bundle L on X that we want to extend to some compacti-
ﬁcation X′.
Finally, a third variant will be useful when we wish to resolve the
indeterminacy of a rational map or to replace a divisor in X, ﬁnite over
B, with a collection of disjoint sections. This can be done by making
analogous modiﬁcations to X′ (either blowups or base changes and
blowups) without reintroducing multiple components of the special
ﬁber. Since we may have to blow up smooth points of the special ﬁber
X0, producing smooth rational components of X0 meeting the rest of
X0 only once, we can’t assert that the resulting family is semistable,
but we can ensure that it’s a family of nodal curves.
Proposition (3.49) (Nodal reduction) Let B be a smooth curve,
0 a point of B and B∗= B \ {0}. Let X ✲B∗be a ﬂat family of nodal
curves of genus g, ψ : X ✲Z any morphism to a projective scheme Z,
and D ⊂X any divisor ﬁnite over B∗. Then, there exists a branched
cover B′ ✲B and a family X′ ✲B′ of nodal curves extending the ﬁber
product X ×B∗B′ with the following properties:
1) The total space X′ is smooth.
2) The morphism πX ◦ψ : X ×B∗B′ ✲Z extends to a regular mor-
phism on all of X′.
3) The closure of the inverse image π−1
X (D) in X′ is a disjoint union
of sections of X′ ✲B′.
Any two such extensions are dominated by a third and so have special
ﬁbers whose stable models are isomorphic.
Remark. The last property makes it easy to prove analogous results
for families of stable pointed curves, which we leave you to formulate
precisely.
There are now two things to do. We should prove the propositions
and we should give some examples of how the process of ﬁnding the
extension X′ ✲B of a given family is carried out in practice. You can
by now easily guess which one we’ll actually do. In fact, proofs of
all three results follow, in outline, rather closely the steps illustrated
by the examples below. After we’ve gone through these, we’ll indi-
cate what additional ingredients enter into the proof. (A more detailed
proof can be found in [11].) We should, however, at least remark that
the way we’ve motivated these results in the ﬁrst paragraph above is

120
3. Techniques
somewhat misleading. Historically, these theorems preceded the dis-
covery of Mg and their proof did not depend on knowing that such
a compactiﬁcation exists. Quite the reverse: stable reduction is a key
ingredient in the proof of the existence of Mg.
Examples
Glueing a constant section to a moving one
We start with one of the simplest examples. Suppose that C is a ﬁxed
smooth curve of genus g −1, p ∈C is a point, and for each point
q ≠p ∈C, Cq is the stable curve of genus g obtained by identifying
the points p and q on C. Fixing p and letting q vary, it’s clear that these
ﬁt together to form a family X of stable curves over the punctured
curve C−{p}. We ask: what happens as q approaches p as indicated in
Figure (3.50)? At the level of the ﬁbers, we want to know how we can
p
q
Figure (3.50)
complete the family of stable curves shown in Figure (3.51) (in which
q approaches p as we move from left to right) to one deﬁned over all
of C? In other words, what stable curve should replace the question
mark at the right? There is an obvious way to complete this to a family
?
Figure (3.51)
of curves: in the product C × C, we can simply identify the two cross-
sections ∆and Γp, where ∆is the diagonal and Γp = {p} × C is the
horizontal cross-section as in Figure (3.52). This, however, will yield

C. Stable reduction
121
Γp
∆
Figure (3.52)
a family whose ﬁber over p ∈C is a cuspidal curve. This is perhaps
the ﬁrst case in which it’s unclear what the stable central ﬁber will be.
To ﬁnd out, we do the next obvious thing: we blow up the original
family C × C at the offending point (p, p) before making the iden-
tiﬁcations. This yields the family in Figure (3.53),
and now we can
C
P1
∆

Γp
Figure (3.53)
make the identiﬁcation of the proper transforms ˜∆and ˜Γp to arrive at
a family whose ﬁber over p is the stable curve shown in Figure (3.54).
C
p
P1
Figure (3.54)
Exercise (3.55) Show that the stable limit of the two-pointed curve
(C, p, q) as q approaches p is the union of C and a copy of the line P1

122
3. Techniques
attached at the point p ∈C, with two marked points on P1. Why does
the choice of the two points not matter?
The rational curve with a single node which arises here appears so
frequently that it has been named. For reasons that should be clear
from Figure (3.54), it’s called a pigtail.
If more points come together, however, the moduli of the limit will
depend how they approach each other. The following exercise shows
an example of this.
Exercise (3.56) Let C be a smooth curve of genus g −2. Consider
the family of stable curves of genus g over the complement of the
diagonal in the fourfold product C4 whose ﬁber over a point (p, q, r, s)
is the curve obtained by identifying p with q and r with s. What are
the stable limits of curves in this family? Does this family extend to a
family of stable curves over all of C4? Over what blowup of C4 does
it extend?
Smooth curves acquiring a cusp
This example is probably the most common one. Suppose we have a
pencil {Ct} of curves on a surface, with Ct a smooth curve for t in
a punctured neighborhood of t = 0, but C0 a curve with one cusp.
Suppose moreover that the cusp of C0 isn’t a base point of the pencil,
so that in a neighborhood of the cusp p of C0 and of t = 0 we can
write the equation of the curve Ct as
F(x) + t · G(x)
with G nonzero at p. Generically, the analytic normal form of such a
pencil will be y2 = x3 + t and the picture is that in Figure (3.57). We
ask: what is the stable limit of the curves Ct as t approaches 0?
Figure (3.57)
This problem is substantially more subtle than the preceding one;
for example, here we’ll deﬁnitely have to make a base change to carry

C. Stable reduction
123
out a stable reduction. Before we do this, however, we should clean
up the problem a little by getting rid of the cusp in the special ﬁber.
Indeed, by blowing up the total space X0 ⊂P1 × S of the original
pencil we can always arrive at a family whose ﬁber over the origin is
supported on a nodal curve — the problem is that this ﬁber will have
multiple components — and we do this ﬁrst.4
This takes three blowups. Note ﬁrst of all that, because of the hy-
pothesis that the cusp p of C0 isn’t a base point of the pencil, the
surface X0 is smooth (this is in fact the only aspect of this process
that involves the fact that the original family is a pencil). Starting with
the family in Figure (3.57) and blowing up once, we arrive at the family
in Figure (3.58) whose special ﬁber consists of the normalization C of
C
E1
2
Figure (3.58)
C and an exceptional divisor E1 ≊P1 appearing with multiplicity 2 in
the ﬁber. Here, and in the sequel, we indicate component multiplicities
greater than 1 by circled integers.
Next, we blow up a second time to arrive at the family in Figure (3.59)
whose special ﬁber consists of C, the proper transform of E1 (which
we’ll continue, by abuse of notation, to call E1), and a new exceptional
divisor E2 appearing with multiplicity 3 in the ﬁber, all smooth and
intersecting at a common point p. Finally, we blow up the point p,
introducing another exceptional divisor E3 appearing with multiplic-
ity 6 in the ﬁber as in Figure (3.60). This last blowup separates the
4If you’re familiar with proofs of the stable reduction theorem you may ﬁnd this
procedure somewhat surprising since these usually begin by making all necessary
base changes and only afterwards perform blowups as needed to smooth. However,
the procedure we adopt in this example is, in fact, fairly typical. We will see shortly that
making base changes only after having obtained a (nonreduced) nodal ﬁber greatly
simpliﬁes the bookkeeping of component multiplicities and intersection numbers in
the special ﬁber: this is a task which is superﬂuous in an existence proof but essential
when we want to identify a particular stable limit.

124
3. Techniques
C
E1
E2
3
2
Figure (3.59)
E3
E1
E2
C
2
3
6
Figure (3.60)
proper transforms of the components in the ﬁber of the previous fam-
ily (which we continue to call C, E1 and E2); they now all intersect E3
at distinct points.
We have thus arrived at a family whose reduced special ﬁber has
only nodes as singularities. The problem, of course, is that the ﬁber
is highly nonreduced, having components of multiplicities 2, 3 and 6.
This we deal with by making a base change: we take the ﬁber product
X′ = X ×B B′ of our existing family X ✲B with a branched cover
B′ ✲B of the curve B ramiﬁed over 0 — almost always, the map given
locally for some m by t ✲tm.
Here is where additional practical considerations arise. The base
change will generally introduce new singularities in the surface X,
and the bookkeeping is simpliﬁed if we package each base change
with the normalization of the resulting surface. In practice, it’s also
usually best to perform only base changes with prime exponent m,
if necessary factoring the base change into several stages. Of course,
since the operation of base change is associative, we could just make

C. Stable reduction
125
a single base change of composite order, but doing so makes it much
harder to keep track of what is going on.
In the present case, since we have components of multiplicity divis-
ible by 2 and 3, we’ll want to make base changes of these orders. To
start with, we make a base change of order 2; that is, we take the ﬁber
product of X with a double cover B′ of B given locally by the map
t ✲t2. This is equivalent to taking the double cover of X branched
along the divisor t = 0, so that the local equation of the resulting
surface will be u2 = t everywhere. If D ⊂X is a component of multi-
plicity m in the special ﬁber, then in a neighborhood of a point p of
D, t is the mth power of a local coordinate z on X, so that the local
equation of X′ will be
u2 = zm.
Of course, if m > 1, this will be singular along the inverse image of D.
However, the normalization process will smooth this locus, replacing
u by a local coordinate v = u/z⌊m/2⌋, so that the local equation of the
normalization will be either v2 = z or v2 = 1 depending on whether
m is odd or even. This suggests the following deﬁnition.
Deﬁnition (3.61) For any divisor
D =

ai · Di
on a surface and n ∈Z, deﬁne the divisor D≡n (called the divisor D
reduced mod n) to be the divisor
D≡n =

ai · Di
where 0 ≤ai ≤n −1 and ai ≡ai mod n.
In these terms, we can summarize the discussion in the preceding
paragraph by saying that the effect of the base change of prime or-
der p followed by normalization is to take the branched cover 
X of X
branched along the divisor (t) reduced mod p. The simplicity of this
description is the main reason for factoring any base change into a
succession of base changes of prime order.
Exercise (3.62) Compute the result of performing a base change of
order 6 on X and normalizing the resulting surface and show that
the description above can’t be extended to base changes of composite
order.
In the present circumstance, the divisor (t) reduced mod 2 is simply
the sum of the components E2 and C of the special ﬁber that are
shown thickened in Figure (3.63). Since this branch divisor is smooth,
the resulting surface will be smooth as well. The inverse images of

126
3. Techniques
E3
E1
E2
C
2
3
6
Figure (3.63)
E2 and C will of course be curves mapping isomorphically to them.
Since E3 meets the branch locus in two points, its inverse image will
be a double cover of E3 ≊P1 branched at two points, which is to say,
a single rational curve that we shall continue to call E3. On the other
hand, E1 is disjoint from the branch locus, so that its inverse image
will be an unramiﬁed cover of E1 ≊P1; that is, two disjoint rational
curves that we’ll call E′
1 and E
′′
1 .
The multiplicities of the various components in the special ﬁber are
not hard to calculate either. Brieﬂy, the pullback to 
X of the divisor
(t) on X is simply the sum of the components of the inverse image of
the special ﬁber in X, with multiplicities unchanged from that of the
corresponding component of (t) on X for components not contained
in the branch divisor, and with multiplicity doubled for components
in the branch divisor. Thus,
η∗= 2 C + 6E2 + 2E′
1 + 2E′′
1 + 6E3.
But the special ﬁber (u) of the new family 
X ✲B′ is exactly one-half
of this divisor: thus
(u) = C + 3E2 + E′
1 + E′′
1 + 3E3,
and the picture of our new surface is shown in Figure (3.64) with all
components smooth rational curves (except for C, of course), and all
multiplicities 1 unless marked.
Again, we can apply the same principles to a base change of any
prime order p except that the multiplicities of components of the
special ﬁber Xt in the branch divisor are then multiplied by p in the
inverse image of Xt and the new special ﬁber is
1
p
th of this inverse
image. As an example, we take the logical next step of making a base
change of order 3 and normalizing. We must form the cyclic triple

C. Stable reduction
127
E3
E′
1
E′′
1
E2
C
3
3
Figure (3.64)
cover of our surface branched over the special ﬁber reduced mod 3,
which is to say the curve C ∪E′
1 ∪E′′
2 shown thickened in Figure (3.65).
The inverse images of C, E′
1 and E′′
1 are copies of themselves. Since E2
E3
E′
1
E′′
1
E2
C
3
3
Figure (3.65)
is disjoint from the branch divisor, its inverse image is a disjoint union
of three rational curves, which we’ll call E′
2, E′′
2 and E′′′
2 . Finally, the
inverse image of E3 will be a triple cover of E3 branched over the three
points where E3 meets C, E′
1 and E′′
1 — that is, by Riemann-Hurwitz,
an elliptic curve, which we’ll continue to call simply E3. Figure (3.66)
shows the picture we ﬁnally arrive at. Since in η∗(t) all components
now have multiplicity 3, the new special ﬁber will be reduced.

128
3. Techniques
E3
E′
1
E′′
1
E′
2
E′′
2
E′′′
2
C
Figure (3.66)
We’re now one step away from being ﬁnished: we have a family
whose special ﬁber is a reduced curve with only nodes as singularities.
It’s not semistable, however, because of the presence of the ﬁve E1 and
E2 curves, which are rational curves meeting the rest of the ﬁber only
once. This is, in fact, exactly what allows us to get rid of them. The
intersection number of each of any component E of the special ﬁber
with the whole special ﬁber is 0. Therefore, if E meets the rest of the
special ﬁber exactly once, it follows that
E · E = −1 .
Hence, E is an exceptional curve of the ﬁrst kind and can be con-
tracted. Blowing down the ﬁve curves of this type, then, we arrive at
the family in Figure (3.67) whose special ﬁber consists of the union of
C
E
Figure (3.67)
the normalization C of the original curve C together with the elliptic
curve E (called an elliptic tail ), joined at the point of C lying over the
cusp of C. This, ﬁnally, is the stable reduction of the original family.

C. Stable reduction
129
Exercise (3.68) At each stage of this process, calculate the self-
intersection of each component of the special ﬁber.
Exercise (3.69) Consider the family F + t · G above, with F a quartic
with an ordinary cusp and G a general quartic. Carry out the process
of stable reduction globally, making base changes of orders 2 and 3 by
taking covers P1 ✲P1 of degrees 2 and 3 branched over the point t = 0
and one other general point of P1. What are the numerical invariants
of the resulting surface?
There is one amusing (and signiﬁcant) point to be made here. We
haven’t really speciﬁed in the description above the moduli point in
Mg of the special ﬁber X0 because we haven’t said which elliptic curve
E arises. Looking back at the reduction process we see that E appeared
in the process of making the base change of order 3 as a triple cover
of P1 totally ramiﬁed over three points. Since any three points on
P1 are projectively equivalent, this description completely speciﬁes
E. In fact, it shows that E is Galois with Galois group Z/3Z and so
has an automorphism group of order 3. Thus, the associated lattice is
spanned by 1 and e2πi/3 and the elliptic curve E always has j-invariant
0! To see what is funny about this, consider a two-parameter family
of curves C(a,b) of genus g ≥2 given locally by
y2 = x3 + a · x + b
(which is the versal deformation space of a cusp singularity); assume
that for (a, b) ≠(0, 0), the curve C(a,b) is stable. Figure (3.70) shows
the type of singularity in the ﬁber over each point of the base of this
family.
What the analysis above shows is that if we approach the
origin via a general one-parameter family in this plane not tangent to
the a-axis at the origin, we’ll get the elliptic curve with j-invariant 0
in the limit. What happens if we approach along the discriminant ∆?
This is essentially the situation of the ﬁrst example treated above and
we saw there that the limit is always the pigtail for which j = ∞.
Where are the other elliptic curves hiding? That generic directions
lead to tails E with j-invariant 0 shows what the answer must be.
Associating to a point of the (a, b)-plane C2
a,b other than the origin
the isomorphism class [C(a,b)] of the curve C(a,b) deﬁnes a rational
map C2
a,b
✲Mg. Now, not only is this map not regular at the origin;
but what we’ve seen is that even after we blow up the origin in the
(a, b)-plane, the map doesn’t extend to a regular map. Indeed, what
we’ve seen is that if C2
a,b is the blowup of C2
a,b at the origin, E ⊂C2
a,b
the exceptional divisor, then the map ϕ extends to a regular map on
the complement in C2
a,b of the point p ∈E corresponding to the line
(b = 0), constant on E \ {p}: for any arc in C2
a,b with tangent line
at (0, 0) not equal to (b = 0), the total space of the corresponding

130
3. Techniques
b
a
nodal
smooth
cuspidal
4a3 −27b2 = 0
Figure (3.70)
one-parameter family of curves will be smooth, and the same analysis
shows that the stable limit will have an elliptic tail with j-invariant 0.
In fact, a sequence of three blowups exactly analogous to those
needed to desingularize the total space X in the preceding example is
required to regularize this map. Their effect is shown schematically
in Figure (3.71). At the ﬁnal stage shown on the bottom left, we get
E3
j = 1728
E2
j = 0
E1
j = ∞
∆
j = 0 j = ∞
j = 1728
E1
∆
E0
j = 0
E1
∆
∆
Figure (3.71)
a map to Mg that sends the points of E3 to the joins of C to elliptic
tails having every j-invariant. This map blows down the curves E1, E2
and ∆respectively to the three joins with tails having j-invariants 0,
1728 and ∞.

C. Stable reduction
131
Smooth curves acquiring a triple point
For another (and in fact easier) example, consider a family of curves,
generically smooth, tending to a curve with a triple point. As in the
previous case, we’ll assume that the family has no inﬁnitesimal base
locus so that we have a smooth total space X ✲B. (As the last exam-
ple illustrated, this last assumption is quite a restrictive one.) Locally
such a family might have equation of the form x3 + y3 + g(x, y) + t
where g vanishes to order at least 4 at the origin and look like that
in Figure (3.72). As before, the ﬁrst order of business is to reduce to
Figure (3.72)
the case where the reduced special ﬁber has only nodes. This can be
done in one step by blowing up the triple point of the special ﬁber: we
arrive at the family in Figure (3.73) in which the special ﬁber consists
of the normalization C of the original curve C with a triple point, plus
an exceptional divisor E1 meeting C in the three points lying over the
triple point of C and appearing with multiplicity 3 in the ﬁber.
C
E1
Figure (3.73)
Now, to get rid of the multiplicity we have to make a base change
of order 3, followed by a normalization. As before, this amounts to
taking a cyclic triple cover of the total space of our family branched

132
3. Techniques
over the curve C. The inverse image of E1 is then a cyclic triple cover
of E1 totally branched over the three points of intersection of E1 with
C. Once again, this is the elliptic curve E of j-invariant 0. Since the
points of intersection of E with C are the ﬁxed points of the automor-
phisms of E, they form a subgroup of order 3 of E. We summarize
this example: the stable limit of our family is the normalization C of
the original curve C with an elliptic curve E of j-invariant 0 attached
by identifying the points of C lying over the triple point of C with the
points of a subgroup of order 3 in E.
Again, we can now ask what variations on this reduction will appear
over the deformation space
x3 + y3 + a + bx + cy + dxy
of the triple point. Generic pencils in this family will lead to the limit
above. The derivation above continues to apply as long as the total
space X of the original family is smooth, which will be true here as
long as we avoid pencils lying in (or more generally arcs tangent to) the
hyperplane a = 0. Approaches to the origin along special directions,
or more generally, with special higher-order jets will lead to a whole
menagerie of different stable limits which we begin to explore in the
exercises.
Exercise (3.74) 1) What is the stable limit of a family of curves with
three nodes degenerating to a curve with an ordinary triple point as
shown below? What conditions must the jet of an arc in the deforma-
tion space of the triple point satisfy to yield a family of curves of this
type?
Figure (3.75)
2) Construct an arc in the deformation space of the triple point whose
stable reduction is the join of the normalization C at the points lying
over the triple point with an arbitrary triple of points on an arbitrary
elliptic curve.
3) (Harder) Describe the regularization of the rational map to moduli
from the base of the deformation space of the triple point.

C. Stable reduction
133
Plane quartics specializing to a double conic
Here is a ﬁnal example with a somewhat different ﬂavor: we consider
a family of plane quartic curves specializing to a double conic. To set
this up, say Q(x, y) is the equation of a smooth conic in the plane P3,
and F(x, y) a general quartic, and consider the pencil given by the
equation Q2 + t · F which is sketched in Figure (3.76).
Figure (3.76)
Assuming the conic Q = 0 and the quartic F = 0 intersect trans-
versely at eight points pi as in the ﬁgure, we may take local coordi-
nates x and y around pi so that Q = x and F = y. The local equation
of the family is then x2 + yt = 0. In particular we see that the total
space X ⊂P2 × ∆of our family necessarily has an A1 singularity at
the points (pi, 0). This we can deal with by blowing up once to get
the family in Figure (3.77) whose special ﬁber is the conic curve C
given by Q = 0 (appearing with multiplicity 2 in the ﬁber), plus eight
copies Ei of P1 attached at the points pi ∈C. Note that the Ei will have
self-intersection −2 and will appear with multiplicity 1 in the ﬁber.
C
Ei
2
Figure (3.77)
The next step is to make a base change of order 2, i.e., take a double
cover of the total space branched over the union of the curves Ei.

134
3. Techniques
The inverse image of C is then the double cover of C branched at the
eight points pi, which is a hyperelliptic curve C0 of genus 3. At the
same time, the inverse image of each Ei is then just a rational curve
mapping isomorphically to Ei. These will appear with multiplicity 1
in the ﬁber and will have self-intersection −1 so they can be blown
down to arrive at a family whose special ﬁber is simply the smooth
hyperelliptic curve C0.
This is an interesting example for several reasons; we should men-
tion at least two here. One is that it illustrates that the nastiness of the
nonsemistable ﬁber in a nonsemistable family has little to do with how
singular or reducible the semistable limit will be. The double conic is
certainly the “worst” limit we have looked at, yet for the ﬁrst time we
get a smooth stable specialization.
This example also represents in some ways a nice example of the
20th century approach to projective geometry, which is to focus not
only on subvarieties of projective space but also on the abstract vari-
eties associated to them. Thus, in the original family of plane curves,
the limiting curve is a double conic, which has relatively little struc-
ture (e.g., all double conics are isomorphic, and all points on a double
conic look the same). If we think of the family as a family of abstract
curves of genus 3, however, the natural limiting object is a smooth,
hyperelliptic curve of genus 3 — an object that does have a great deal
of structure.
To illustrate how this notion can be used in practice, we consider
the following classical problem. In the family of curves Ct ⊂P2 given
by Q2 + t · F = 0, the curve Ct will, for each small t ≠0, be smooth
and so will have exactly 28 bitangent lines. We will denote these, some-
what abusively, by L1(t), . . . , L28(t) although these aren’t necessarily,
a priori, single-valued functions of t in a punctured neighborhood of
t = 0. We ask: what are the limits of the bitangents Li(t) as t ✲0?
Similarly, if F is general, the generic curve Ct will have 24 ﬂex points
p1(t), . . . , p24(t) (again, not necessarily single-valued functions of t).5
We may ask what the limits of the points pi(t) are as t ✲0.
To answer the ﬁrst question, we may use the characterization of
a bitangent line to a plane quartic as the line spanned by the points
of an odd theta-characteristic D — that is, a divisor D ≥0 such that
2D ∼K and h0(C, OC(D)) is odd. Since this description doesn’t ex-
plicitly involve the plane embedding, it serves as well to characterize
the limits of these lines as t ✲0. Explicitly, the hyperelliptic curve C0
will have 8 Weierstrass points qi — these are the branch points of the
double cover C0 ✲P1 — and the odd theta-characteristics of C0 are
5In this example, it turns out that the lines Li(t) are single-valued while the points
pi(t) are deﬁned only over O∆[t1/3].

C. Stable reduction
135
just the pairwise sums qi +qj of distinct Weierstrass points. Since the
points qi ∈C0 map to the points pi of intersection of the plane conic
C with the quartic curve F = 0, we conclude that the limits of the 28
bitangent lines to the curves Ct are the lines joining pairs of points of
intersection of C with the curve F = 0.
Again, the point is that the original problem — ﬁnding the limits
of bitangents to a family of plane curves — doesn’t involve in any
way the stable limit of the family. If we look only at the plane curves,
however, it’s difﬁcult to see where the bitangents should go (though
it’s a worthwhile exercise to try and work out the problem rigorously
without invoking stable reduction).
Exercise (3.78) In the example above, show that as t ✲0 the 24 lines
to which the general ﬁber Xt ﬂexes approach the eight tangent lines
to the conic at the base points of the pencil and that each tangent line
occurs with multiplicity 3 in the limit.
Exercise (3.79) 1) Let {Ct} be a general pencil of plane sextics spe-
cializing to a double cubic curve C0 = 2E. What will be the stable limit
of the family?
2) A general smooth sextic plane curve will have 324 bitangent lines.
What are the limiting positions of the bitangent lines to {Ct} as t
approaches 0?
Exercise (3.80) 1) Show that a general pencil of plane sextics spe-
cializing to a triple conic will have as stable limit a smooth cyclic
trigonal curve of genus 10.
2) Make a dimension count that shows that other trigonal curves of
genus 10 must be limits of (special pencils of) plane sextics as well.
3) Show that if Q, R and S are a sufﬁciently generic quadric, quartic
and sextic respectively, then the pencil Q3+tQR+t2S has stable limit
a noncyclic trigonal curve. What does “sufﬁciently generic” mean in
this example?
4) Exactly which trigonal curves arise as limits of pencils of sextics?
Here are a few more exercises that treat stable reductions that come
up frequently in applications.
Exercise (3.81) Find the stable limit of a general pencil {Ct} of plane
quartics specializing to:
1) the union of a smooth cubic plane curve C and a transverse line L
2) the union of a smooth cubic plane curve C and a line L simply
tangent to C
3) the union of a smooth cubic plane curve C and a ﬂex line L to C

136
3. Techniques
4) the union of a cuspidal cubic C and a general line L through the
cusp of C
5) the union of a cuspidal cubic C and the “tangent line” (i.e., the
reduced projective tangent cone) to C at the cusp.
Exercise (3.82) 1) If {Ct} is a general pencil of curves, smooth for
t ≠0, specializing to a curve C with an ordinary fourfold point, show
that the stable limit of the family will be the union of the normalization
C with a curve B of genus 3 meeting C at the four points p1, . . . , p4 ∈C
lying over the fourfold point of C.
2) Show that if {Ct} is any such family, the stable limit will be the
union of C with a stable 4-pointed curve (B; q1, . . . , q4) of genus 3
obtained by identifying pi with qi.
3) Show that not all such stable 4-pointed curves (B; q1, . . . , q4) arise,
by showing that the versal deformation space of a fourfold point has
dimension 9 and the space of pointed curves (B; q1, . . . , q4) as above
has dimension 10.
4) Harder: Naively, the locus of B’s that arise should have the same
dimension as the projectivization of the tangent space at the origin
to the deformation space: in the example above, we expect an eight-
dimensional family. Prove or disprove the
Conjecture (3.83) The stable 4-pointed curve (B; q1, . . . , q4) of genus
3 arises above if and only if q1 + · · · + q4 is a canonical divisor on B.
Exercise (3.84) Partially generalize the previous exercise to the case
of families of curves Ct that for t ≠0 are smooth but for which the
special ﬁber C has an ordinary n-fold point p by showing:
1) Every stable limit will be the join of the normalization C of C at the
n points lying over P with some stable n-pointed curve (B; q1, . . . , qn)
of genus h =
n −1
2

.
2) The B that consists of a union of n lines each meeting the others
and C at one point always appears as a limit.
3) The B that arises as the stable limit of the generic such family is the
n-sheeted cover of P1 totally ramiﬁed at the n points corresponding
to the tangent directions of the branches to C at the n-fold point.
Problem (3.85) Is it always the case that the locus in Mh,n of curves
B that arise as limits in this way has dimension 1 less than that of the
versal deformation space of the n-fold point?
Substantial progress has been made recently on this and related
questions by Hassett [85].

C. Stable reduction
137
Outline of the proof of existence of stable reductions
As we remarked before looking at examples, the proof of the existence
of stable reductions follows, in outline, the stages we have repeatedly
carried out above.
We start with the case where we have a family π : X ✲B over a
smooth one-dimensional base B smooth over B \ {0} and with other-
wise arbitrary special ﬁber X0 over the point 0 ∈B. We will proceed
in stages but continue to use notation like π : X ✲B to denote the
family that results after each step of the process.
The ﬁrst step is to apply resolution of singularities to the pair
(X, X0): by blowing up, we arrive a family such that X is smooth, and
X0 has set-theoretic normal crossings, that is, the reduced scheme
(X0)red is nodal. At this point, the map π will be given by an equation
of the form t = xayb in terms of a local coordinate t on B and local
coordinates x and y on X.
Stage two is to perform a base change. If m is the least common
multiple of the multiplicities of the components of the special ﬁber
X0, we make the base change t ✲tm and normalize the resulting total
space. A local calculation then shows that the special ﬁber X0 has
reduced normal crossings and the map π has local equation of the
form either tn = x or, at nodes of the special ﬁber, tn = xy where t
is again a local coordinate on the base B. In the latter case, the total
space X will be smooth at the node if and only if n = 1. If n > 1, there
is an An−1 singularity at the node. Note that, in both cases, the special
ﬁber is now reduced and nodal.
Third, we minimally resolve the An−1 singularities that arise. This
has the effect of replacing each singularity by a chain of (n−1) rational
curves. We have now arrived at a family with smooth total space and
reduced, nodal special ﬁber.
What we do next depends on which of the three variants we’re after.
To obtain the semistable reduction, we simply blow down any excep-
tional curves of the ﬁrst kind in the total space X: these are just the
smooth rational components of the special ﬁber X −0 meeting the
rest of X0 only once. To obtain the stable reduction, we further blow-
down all semistable chains: that is, chains of smooth rational curves
of self-intersection (−2). To obtain the nodal reduction, it may be nec-
essary to go in the other direction, blowing up some points of X to
extend the map ψ. This causes no trouble unless we need to blow up a
node of X0 in which case the exceptional divisor will be a nonreduced
component of X0 and we need to repeat step two.
Finally, the case where the general ﬁber is singular requires a few ex-
tra operations. By a base change, we may assume that the monodromy
acts trivially on the branches of the nodes of the general ﬁber. Then,
we apply the steps above to the normalization 
X of the total space.

138
3. Techniques
Next, at the end, we make further blowups and base changes as nec-
essary to ensure that closures of the inverse images of the nodes of
the general ﬁber are disjoint sections of 
X. Finally, we reidentify these
appropriately.
As for the uniqueness assertions in all the variants, these all fol-
low by applying the facts about B-isomorphisms discussed at the end
of Section A.
Flat completion of embedded families
Before we leave stable reduction behind, we wish to mention a prob-
lem raised by Carel Faber that roughly involves understanding the in-
verse of the stable reduction process: Given a family of stable curves
X ✲∆∗over the punctured disc together with a line bundle L on X
whose sections give embeddings
Xt ✲Yt ⊂Pn
of the curves in the family as curves in Pn, describe all the curves Y0 in
Pn that can arise as ﬂat limits of the Yt’s. In other words, describe all
the embedded families that (up to base change) have X ✲∆∗as their
stable reduction. We call this problem the ﬂat completion problem.
The ﬁrst interesting example to look at is a constant family of
smooth plane quartics. That is, each Xt for t ≠0 is isomorphic to
a ﬁxed smooth plane quartic curve and the line bundle L is the pull-
back of OP2(1) (equivalently, the relative dualizing sheaf ωX/∆∗). This
means that the images Dt of all the Xt’s are obtained from any one —
say, D1 — by projectivities with coefﬁcients that depend on t.
Exercise (3.86) 1) Show that if we obtain Dt from D1 by the diag-
onal projectivity diag(1, 1, t), then the limiting curve D0 is either a
fourfold line or the union of a triple line with another line depending
on whether the ﬁxed point (0, 0, 1) lies off or on the curve D1.
2) Show that the projectivity diag(1, t, t) yields as limit the sum of
four concurrent lines (not necessarily distinct).
3) How can you obtain the union of the cuspidal cubic y2z −x3 = 0
and its tangent line y = 0 at the cusp?
Alufﬁand Faber [2] show that the set of possible limits that can
arise in isotrivial families like the examples above can depend on
the intrinsic geometry of the general ﬁber D1. For example, the curve
y3z−x4 = 0 appears if and only if the plane model of D1 has a hyper-
ﬂex. Almost nothing general is known, even about the isotrivial case,
but the problem is yet another that clearly merits study.

D. Interlude: calculations on the moduli stack
139
D
Interlude: calculations on the moduli
stack
“O
F course, here I’m working with the moduli stack rather
than with the moduli space. For those of you who aren’t
familiar with stacks, don’t worry: basically, all it means is that
I’m allowed to pretend that the moduli space is smooth and
that there’s a universal family over it.”
Who hasn’t heard these words, or their equivalent, spoken in a talk?
And who hasn’t fantasized about grabbing the speaker by the lapels
and shaking him until he says what — exactly — he means by them?
But perhaps you’re now thinking that all that is in the past, and that
at long last you’re going to learn what a stack is and what they do.
Fat chance. Unless you’ve picked up this book for the ﬁrst time
and have opened it at random to this page, you must know better.
But, we’re not going to evade the issue entirely. Brieﬂy, here is the
situation:
One of the basic techniques we’ll be applying in our study of moduli
is to ﬁnd relations among the various cycle classes on the moduli
space Mg. (Some of these classes were introduced in Section 2.D;
others will appear below). Most of the ways we do this — the
Grothendieck-Riemann-Roch formula, which we’ll discuss in the fol-
lowing subsection, is a perfect example — don’t a priori give such
relations. Rather, they give relations among corresponding divisor
classes on the base of any family X ✲B of stable curves. In order
to get results on the cohomology or Picard group of Mg, then, we
have to translate these statements.
There is a perfect vehicle for doing this: the language of stacks.
As we indicated in Section 2.A, the category of stacks is a relatively
slight enlargement of the category of schemes — slight enough, at
any rate, that we can meaningfully extend to the category of stacks
the deﬁnitions of such things as the Picard group of a scheme, the
cohomology ring of a scheme, and intersection numbers between
line bundles and curves. But the category of stacks is just large
enough that, in it, the functor of families of stable curves is rep-
resentable: in other words, there is a stack M
fun
g
such that for any
scheme B we have a natural identiﬁcation between the set of fami-
lies of stable curves over B and the set of morphisms of B to M
fun
g .
Moreover, since there is (again, in the category of stacks) a universal
stable curve over M
fun
g , there is a natural map π : M
fun
g
✲Mg. Now,
the results we obtain by applying Grothendieck-Riemann-Roch and
other formulas to families of stable curves yield directly relations

140
3. Techniques
among classes on the stack M
fun
g ; and applying the map π we derive
in turn results about the cohomology and Picard groups of Mg.
Well, that’s how it goes in theory, anyway. In practice, there is one re-
spect in which the language of stacks isn’t wholly perfect: it’s difﬁcult
to understand even the deﬁnition of a stack (we’re speaking strictly
for ourselves here). Actually, once you’ve absorbed the basic deﬁni-
tions, the rest is not so bad; but there’s no question that the initial
learning curve is steep, not to say vertical.
What are we going to do in this book? Basically, we’re going to be
guided by two principles. First, we aren’t going to deﬁne a stack; and,
given that we’re not going to deﬁne them, we won’t use any deﬁnition
or result that relies on the deﬁnition of a stack. Second, we will provide
a reasonably self-contained logical framework for the divisor-class
calculations that form an essential part of our study of Mg. We’ve
therefore chosen to make purely local and ad-hoc deﬁnitions of the
objects we’ll be using. But, we’ll also try, parenthetically, to indicate
how the deﬁnitions we make relate to those in the theory of stacks,
so that you can relate our calculations to those that appear elsewhere
in the literature. If you want to explore further, a good place to begin
is Vistoli’s article [149].
Divisor classes on the moduli stack
We start with the deﬁnition of a rational divisor class. On the moduli
space, this is straightforward: since Mg has only ﬁnite quotient sin-
gularities, every codimension 1 subvariety of Mg is Q-Cartier, so that
we have an equality
A1(Mg)

Q = Pic(Mg)

Q.
We will call an element of this group a rational divisor class on the
moduli space. At the same time, it’ll be helpful to introduce the notion
of a divisor class on the moduli stack.
Deﬁnition (3.87) By a rational divisor class on the moduli stack
we’ll mean an association γ to each family ρ : X ✲B of stable curves
of a rational divisor class γ(ρ) ∈Pic(B)

Q on the base of the family,
such that for any ﬁber square
X′ ≊B′ ×B X
✲X
B′
ρ′
❄
✲B
❄
ρ

D. Interlude: calculations on the moduli stack
141
the class γ(ρ′) associated to the morphism ρ′ : X′ ✲B′ is the pullback
of the class γ(ρ) associated to ρ : X ✲B. The group of rational divisor
classes on the moduli stack will be denoted Picfun(Mg)

Q.
We may deﬁne analogously rational cohomology classes on the mod-
uli stack. We should emphasize again that terms like “rational divi-
sor class on the moduli stack” and “rational cohomology class on the
moduli stack” are to be taken as self-contained and atomic: remem-
ber that we do not and will not deﬁne a stack. Moreover, the deﬁnition
above does not even suggest the correct deﬁnition of a line bundle on
a stack: a line bundle on the moduli stack is ofﬁcially something that
associates to every family X ✲B of stable curves a line bundle on the
base of the family, and for every ﬁber square speciﬁes an isomorphism
between the line bundle associated to the morphism X′ ✲B′ and the
pullback of the line bundle associated to X ✲B. It will turn out, how-
ever, that in the present circumstance the two deﬁnitions yield the
same group of bundles.
Of the various divisors and classes we’ve discussed so far, some
seem naturally to be rational divisor classes on the moduli stack: the
class λ, for example. Others, like δ, by contrast, are easy to describe
as rational Cartier divisors (and hence rational line bundles) on the
moduli space Mg; but it may not at ﬁrst be apparent how to deﬁne a
corresponding rational divisor class on the moduli stack: what do we
do, for example, with a family X ✲B of stable curves, all of which are
singular?
Our ﬁrst task, then, is to show that, in fact, a rational divisor class
on the moduli stack is the same thing as a rational divisor class on
the moduli space, that is, an element of Pic(Mg)

Q. Once we’ve es-
tablished this isomorphism, we’ll be free to deﬁne and deal with our
divisor classes in whatever way seems best suited to the class at hand.
We will also give an explicit description of the rational divisor class
on the moduli stack associated to a divisor in Mg, and in particular
answer the question at the end of the last paragraph. In any event, the
ﬁrst step is the:
Proposition (3.88)
Picfun(Mg)

Q ≊Pic(Mg)

Q .
Proof.
We will give inverse maps between the two. In one direction
this is straightforward: given a rational divisor class ν ∈Pic(Mg),
some multiple mν of ν may be represented by a line bundle L on
Mg. Now, to any family ρ : X ✲B of stable curves with induced map
ϕ : B ✲Mg we associate
1
m times the pullback line bundle: in other
words, we set
γ(ρ) = 1
mϕ∗(L).

142
3. Techniques
This deﬁnes a rational divisor class γ on the moduli stack, and thus
a map
π∗: Pic(Mg)

Q ✲Picfun(Mg)

Q.
To deﬁne the inverse isomorphism, it will be useful to have a basic
lemma:
Lemma (3.89) 1) There exists a family ρ : X ✲Ωof stable curves such
that the induced map ϕ : Ω✲Mg is surjective and ﬁnite.
2) For any point [C] ∈Mg, there exists a family X ✲Ωof stable curves
over a smooth base Ωsuch that the induced map Ω✲Mg is surjective,
generically ﬁnite, and ﬁnite over [C].
We should point out that this is a very weak form of a theorem of
Looijenga and Pikaart [108], who have shown (by explicit construction)
that we can take Ωto be simultaneously smooth and ﬁnite over Mg.
It is also true for more general moduli problems; see Koll´ar [99]. This
simple statement is enough for our purposes, however, and (more
importantly) within our ability to prove, so we’ll leave it at that. The
proof will be deferred to the next subsection. The lemma, as stated,
also follows easily from the existence of universal curves with suitably
deﬁned level structure, as in Popp ([131], [132]).
Given the lemma, we can deﬁne a map from the group of ra-
tional divisor classes on the moduli stack to Pic(Mg) as follows.
Given γ ∈Picfun(Mg)

Q, we deﬁne a divisor class on Mg by choos-
ing any tautological family ρ
: X ✲Ωas in the lemma, letting
D = γ(ρ) ∈Pic(Ω)

Q be the divisor class associated to this family by
γ, taking the norm (or pushforward) of D under the map ϕ : Ω✲Mg,
and ﬁnally dividing the result by the degree of the map ϕ: in other
words, we deﬁne a map
π∗: Picfun(Mg)

Q ✲Pic(Mg)

Q
by
π∗(γ) =
1
deg(ϕ)Norm(γ(ρ)).
This is independent of the choice of tautological family ρ : X ✲Ω(any
two tautological families are in turn covered by their ﬁber product
over Mg), and gives a two-sided inverse to π∗above.
Note that since we haven’t deﬁned the notion of stack, morphism
of stacks, or the pullback of a rational divisor class under a morphism
of stacks, we really shouldn’t use the symbols “π∗” and “π∗” to de-
note the maps above; something neutral, like “F” and “G” would have
been more honest. But the fact is, there are such things as stacks, mor-
phisms of stacks, and the pullback of a rational divisor class under

D. Interlude: calculations on the moduli stack
143
a morphism of stacks; there is a natural morphism π from the mod-
uli stack to the moduli space, and the map π∗above is simply the
pullback under this morphism.
The following exercise is helpful in thinking about divisor classes
on the moduli stack.
Exercise (3.90) 1) Show that any rational divisor class on the moduli
stack — say γ ∈Picfun(Mg) — is determined by its values γ(ρ) on
families ρ : X ✲B with smooth, one-dimensional base B.
2) Let Σ ⊂Mg be any proper subvariety of Mg. Extending the result
of the ﬁrst part, show that any rational divisor class γ ∈Picfun(Mg)
on the moduli stack is determined by its values γ(ρ) on families
ρ : X ✲B such that B is smooth and one-dimensional, and such that
the image ϕ(B) ⊂Mg of B under the induced may ϕ : B ✲Mg isn’t
contained in Σ.
3) Finally, in view of the fact that Pic(Mg) is discrete, show that any
rational divisor class γ ∈Picfun(Mg) on the moduli stack is deter-
mined by the degrees
deg(γ(ρ)) ∈Q
of its values on families ρ : X ✲B with smooth, one-dimensional base
B and ϕ(B)  Σ.
Thus, we may think of a rational divisor class γ ∈Picfun(Mg) on
the moduli stack as a gadget that, for any one-parameter family of
stable curves, measures the nontriviality of the family, for example
by counting the number of ﬁbers of a certain type (e.g., the divisor
class δ counts the number of singular ﬁbers). This in turn suggests
another way of associating to a divisor on Mg a divisor on the moduli
stack:
Let Σ ⊂Mg be any closed subvariety of codimension 1. Then to any
one-parameter family ρ : X ✲B of stable curves of genus g we may as-
sociate a number, or more generally a divisor class σ(ρ) ∈Pic(B)

Q
(naively, the “number of members of the family lying in Σ”), as follows:
Case 1: Only a ﬁnite number of ﬁbers Xb of the family correspond to
points of Σ.
In this case, we assign to each ﬁber Xb lying in Σ a multiplicity
multb(σ) and add these up, setting σ(ρ) =

b multb(σ) · b. To de-
ﬁne the multiplicity, let Σ be the inverse image of Σ in the versal de-
formation space Def(Xb) of Xb; since the versal deformation space is
smooth this is a Cartier divisor. Now, for any b ∈B we have a natural
map from a neighborhood of b ∈B to the versal deformation space
of Xb, and we deﬁne multb(σ) to be the multiplicity of the pullback
under this map of the divisor Σ.

144
3. Techniques
Case 2: All the ﬁbers Xb belong to Σ.
Here, we describe a line bundle L on B as follows: in a neighborhood
of each point b ∈B, we take L to be the pullback of the normal space
to Σ in Def(Xb). Combining the openness of versality [Exercise (3.39)]
with the uniqueness of the map to Def(Xb), we see that this is indeed
a well-deﬁned line bundle. We then deﬁne the divisor class σ(ρ) of
curves belonging to Σ to be the line bundle L.
With all this said, we have the:
Proposition (3.91) For any codimension 1 subvariety Σ ⊂Mg, there
exists a rational divisor class σ on the moduli stack whose values on
one-parameter families ρ : X ✲B are given as above.
Note that by Exercise (3.90), γ is determined by its agreement with
the degrees speciﬁed in Case 1 above, so we can avoid the seemingly
trickier calculations invoked in Case 2. Actually, as we’ll see in the
explicit description in Lemma (3.94) of the divisor class on the moduli
stack associated to the boundary ∆⊂Mg, the calculation in Case 2 is
often quite straightforward to carry out.
We now have two ways of passing from an irreducible, codimen-
sion 1 subvariety Σ ⊂Mg to a rational divisor class on the moduli
stack: we can apply the “pullback” map π∗of Proposition (3.88) to the
divisor class [Σ] ∈Pic(Mg)

Q to arrive at a rational divisor class on
the moduli stack; or we can deﬁne a rational divisor class σ on the
moduli stack as in Proposition (3.91). The relationship between the
two is straightforward: we have the:
Proposition (3.92) Let Σ ⊂Mg be an irreducible, codimension 1 sub-
variety, and σ ∈Picfun(Mg) the divisor class on the moduli stack as-
sociated to Σ as in Proposition (3.91). Let [C] ∈Σ be a general point.
Then
σ =
1
#Aut(C)π∗[Σ] .
Proof.
The proof of this proposition is immediate and is simulta-
neously a proof of the last proposition.
Applying Exercise (2.28), we see in particular that the divisor class
on the moduli stack associated by Proposition (3.92) to an effective di-
visor D ⊂Mg coincides with the the class π∗([D]) ∈Picfun(Mg)

Q
associated to [D] ∈Pic(Mg) by the isomorphism in Proposition (3.88)
except in the cases of genus 2, of the divisor H3 ⊂M3 of hyperelliptic
curves of genus 3, and of the divisor ∆1 in general.
Now, all of the above may seem somewhat like hairsplitting: why
introduce rational divisor classes on the moduli stack at all if they
are so closely related to rational divisor classes on the moduli space?

D. Interlude: calculations on the moduli stack
145
The answer is a practical one. As we will see very amply illustrated in
the calculations that follow, the rational divisor classes on the moduli
stack are the ones that we can calculate readily: typically, if we want to
ﬁnd the degree of a divisor class on a one-parameter family of curves,
it’s easier to calculate directly the degree of the corresponding divisor
class on the moduli stack. Likewise, if we want to ﬁnd relations among
divisor classes in Pic(Mg), we will typically ﬁnd relations among the
degrees of corresponding divisor classes on the moduli stack, and
then translate the result back into terms of divisor classes on the
space Mg. Explicitly, we’ll invoke the:
Basic Proposition (3.93) Let Γ in Pic(Mg)

Q and γ = π∗(Γ) in
Picfun(Mg)

Q be divisor classes that correspond under the isomor-
phism of Proposition (3.88). Let Σ1, . . . , Σk ⊂Mg be irreducible codi-
mension 1 subvarieties, and σ1, . . . , σk ∈Picfun(Mg)

Q the rational
divisor classes on the moduli stack associated to the subvarieties Σi as
in Proposition (3.91). Let [Ci] be a general point of Σi and let ai be the
order of the automorphism group of Ci. The following statements are
equivalent:
1) For any family ρ : X ✲B of stable curves of genus g, we have the
relation among divisor classes on B

ci · σi(ρ) = γ(ρ) ∈Pic(B) .
2) We have the relation among divisor classes on Mg

 ci
ai
· [Σi] = Γ ∈Pic(Mg)

Q .
Moreover the second statement follows if we know the ﬁrst for families
X ✲B whose general member does not actually belong to any Σi.
The notion of the degree of a rational divisor class γ on the mod-
uli stack on a one-parameter family ρ : X ✲B of stable curves ex-
tends naturally to families that are only generically stable, that is,
whose general member is stable: by the degree of γ on such a family
we’ll mean the degree of γ on any family ρ′ : X′ ✲B′ obtained from
ρ : X ✲B by semistable reduction, divided by the degree of the base
change morphism B′ ✲B involved. Note that the ﬁrst statement of
Proposition (3.93) follows for generically stable families as well from
the second statement.
At this point we should do a fundamental example: the description
of the rational divisor class δ on the moduli stack associated by Propo-
sition (3.91) to the codimension 1 subvariety ∆= Mg \ Mg ⊂Mg.
To set this up, suppose that ρ : X ✲B is a family of stable curves
over a smooth, one-dimensional base with local parameter t. We con-
sider two cases:

146
3. Techniques
Suppose ﬁrst that the general ﬁber Xt of the family is smooth, and
that the ﬁber X0 over 0 in B has exactly one node, at p ∈X0. By our
description of the versal deformation space of a node, we can choose
local coordinates x and y on X in a neighborhood of the point p so
that xy = tk for some k. Then, by our description of the versal defor-
mation space of a nodal curve we see that, in the versal deformation
space of X0, the image of B will be a curve with contact of order k
with the (smooth) hypersurface of singular deformations. Therefore
the image of ϕ(B) ∈Mg will be tangent to ∆to order k — or, more
accurately (we don’t know that ϕ is one-to-one), the pullback to B of
the deﬁning equation of ∆⊂Mg will vanish to order exactly k at
t = 0. Note in particular the equivalence: the map ϕ : B ✲Mg will be
transverse to ∆at t = 0 if and only if X0 has a single node p and X is
smooth at p.
Generalizing this, suppose now that the ﬁber Xb over b in B has ex-
actly n nodes, at the points p1, p2, . . . , pn. In the versal deformation
space of X0, the hypersurface of singular deformations will have n
smooth sheets corresponding naturally to the nodes pi of X0. (If the
curve X0 has no automorphisms, the same will be true in Mg: the divi-
sor ∆will have n smooth sheets in a neighborhood of the point [X0]).
Moreover, if the local equation of X at pi is xy −tki, then the pull-
back to B of the deﬁning equation of the branch of the discriminant
hypersurface corresponding to pi will vanish to order ki. All in all, we
see that the pullback to B of the deﬁning equation of the discriminant
hypersurface in the versal deformation space of X0 vanishes to order
k1 + k2 + · · · + kn at 0; or, in other words, the multiplicity
multb(δ) = k1 + k2 + · · · + kn.
Now, we turn to the second case. That is, we consider a family of
stable curves ρ : X ✲B, still over a smooth, one-dimensional base, but
now where the general ﬁber is singular. To simplify things, suppose
for the moment that each ﬁber Xb of ρ has a single node p. The cru-
cial fact here is Proposition (3.31), which says that the normal space to
the discriminant hypersurface in the versal deformation space of each
ﬁber Xb is naturally identiﬁed with the tensor product of the tangent
spaces to the branches of C at the node. To apply this, we introduce
the normalization ν :

X ✲X of the total space of X. Then, we let
ρ = ρ ◦ν : 
X ✲B be the composition (so that in particular ρ will be a
smooth map), and Γ ⊂
X be the locus of points lying over the nodes
of the ﬁbers Xb of the original map. The map Γ ✲B is unramiﬁed of
degree 2; after a base change we may assume that Γ consists simply of
two disjoint sections Γ1 and Γ2 of 
X ✲B. In these terms, what Propo-
sition (3.31) is telling us is that the normal space of the discriminant
hypersurface, in the versal deformation space of each ﬁber Xb, is the
tensor product of the tangent spaces to the ﬁber 
Xb at the two points

D. Interlude: calculations on the moduli stack
147
of Γ lying over b. Equivalently, the line bundle associated to the family
X ✲B by the divisor class δ on the moduli stack is the tensor product
of the normal bundles to the components of Γ in 
X:
δ(ρ) = NΓ1/ 
X

NΓ2/ 
X.
Needless to say, the same analysis can be carried out for a family
X ✲B of stable curves whose general ﬁber has any number of nodes.
Combining these two cases, we arrive at the following description
of δ. Suppose ρ : X ✲B is a family of stable curves of genus g over a
smooth, one-dimensional base B with parameter t, whose general ﬁber
has n nodes; let 
X ✲X be the normalization of the total space of X
and ρ : 
X ✲B the composition. For each singular point p ∈sing( ρ)
of the map ρ, let k = k(p) be the unique integer such that there exist
local coordinates x, y, t on 
X near p satisfying xy = tk. Let Γ ⊂X
be the positive-dimensional components of the singular locus of ρ,
and Γ ⊂
X the inverse image of Γ in 
X. After making a base change,
if necessary, we may suppose that Γ consists simply of 2n disjoint
sections Γi.
Lemma (3.94) Let ρ : X ✲B be as above, and let δ be the divisor class
on the moduli stack associated to the boundary ∆⊂Mg. Then
δ(ρ) =
2n
$
i=1
NΓi/ 
X

OB


p∈sing( ρ)
k(p) · ρ(p)

.
In particular, the degree of δ is given by
deg(δ(ρ)) = (Γ)2 +

p∈sing( ρ)
k(p).
We can give similar descriptions of the divisor classes δi on the
moduli stack associated to the divisors ∆i ⊂Mg. Note that as a conse-
quence of Proposition (3.92), the pullback π∗([∆]) of the divisor class
[∆] ∈Pic(Mg)

Q, as deﬁned in Proposition (3.88), is not the divisor
δ on the moduli stack. Rather, since the general point [C] ∈∆1 ⊂Mg
corresponds to a curve with automorphism group of order 2 (there
is an involution on the elliptic tail ﬁxing the point of attachment), we
have:
Corollary (3.95)
π∗([∆]) = δ0 + 2δ1 + δ2 + · · · + δ⌊g
2 ⌋.
A warning about notation. In view of the potential ambiguity, we have
to be careful to distinguish between the class [∆] of the boundary

148
3. Techniques
∆⊂Mg and the divisor δ on the moduli stack, and more generally
between the class of any divisor Σ ⊂Mg, a component of whose sup-
port lies in the locus of curves with automorphisms, and the associ-
ated divisor class σ on the moduli stack. In the case of the divisor
classes λ and κ, which are deﬁned only as classes and aren’t natu-
rally associated to any particular divisor, there is no such confusion.
Therefore, we’ve yielded to temptation, and used the symbols λ and
κ to denote both the divisor classes on Mg and their pullbacks π∗λ
and π∗κ ∈Picfun(Mg)

Q.
Existence of tautological families
To complete this section, we want to give a proof of Lemma (3.89).
Proof.
We observe ﬁrst that for any point [C] ∈Mg, there is a
Zariski open neighborhood U of the point [C] in Mg, a ﬁnite map
ΩU ✲U and a family YU ✲ΩU of stable curves inducing the map
ΩU ✲U ⊂Mg. To see this, we look at the locally closed subset K
of the Hilbert scheme parameterizing m-canonically embedded sta-
ble curves and take Ωa linear section of K transverse to the locus of
curves isomorphic to [C] and Y ✲Ωthe restriction to Ωof the uni-
versal family over the Hilbert scheme. The induced map Ω✲Mg will
then be ﬁnite over some neighborhood U of [C] in Mg; we simply take
ΩU and YU the inverse images of U in Ωand Y respectively.
Next, suppose we’re given two families YU ✲ΩU and YV ✲ΩV of
stable curves whose associated maps ΩU ✲Mg and ΩV ✲Mg are ﬁ-
nite and surjective onto open sets U and V in Mg; we want to con-
struct a family Y ✲Ωwhose associated map Mg is ﬁnite onto U ∪V.
The construction is reasonably straightforward: very brieﬂy, we’ll ex-
tend ΩU and ΩV to ﬁnite covers of Mg, take their ﬁber product, pull
back the families YU ✲ΩU and YV ✲ΩV to the inverse images of ΩU
and ΩV in the product, and then make a further base change in or-
der to make them agree over the inverse image of U ∩V so we can
paste them together to form a single family over the union U ∪V.
The details, however, will sound somewhat complicated as we trace
through them.
To start with, let ΩU and ΩV be the normalizations of Mg in the
function ﬁelds of ΩU and ΩV respectively (these are normal varieties
containing ΩU and ΩV as open sets, to which the maps of ΩU and ΩV
to Mg extend). Let Ω′ be the ﬁber product of ΩU and ΩV over Mg,
and let
πU : Ω′
✲ΩU
πV : Ω′
✲ΩV

D. Interlude: calculations on the moduli stack
149
and
π : Ω′
✲Mg
be the projections. Note that π, being a composition of ﬁnite maps,
is again ﬁnite. Finally (for now!), let Ω′
U = (πU)−1(ΩU) = π−1(U) and
Ω′
V = (πV)−1(ΩV) = π−1(V) be the inverse images of U and V in Ω′.
Via the projection πU : Ω′
U ✲ΩU we can pull back the family of
stable curves YU ✲ΩU to obtain a family Y ′
U = YU ×ΩU Ω′; we de-
ﬁne a family Y ′
V ✲Ω′
V likewise. We now want to patch together the
families Y ′
U and Y ′
V to form a single family over the inverse image
Ω′
U ∪Ω′
V = π−1(U ∪V) ⊂Ω′. This, however, requires a further base
change: even though for each point p of π−1(U ∩V) ⊂Ω′ the ﬁbers
of Y ′
U and Y ′
V over p are isomorphic, there may be no set of choices
of such isomorphisms for each p which glue to give an isomorphism
between the inverse images of U ∩V in YU′ and YV ′.
To overcome this problem, we introduce the variety Z of pairs (p, ψ)
where p lies in Ω′
U ∩Ω′
V and ψ : (Y ′
U)p ✲(Y ′
V)p is an isomorphism.
Let Z0 be any irreducible component of Z dominating Ω′
U ∩Ω′
V, and
take Ω′′ the normalization of Ω′ in the function ﬁeld of Z0. Note
that the projection Ω′′ ✲Ω′, and hence the projection Ω′′ ✲Mg, are
once more ﬁnite maps. Now, on the inverse images Ω′′
U and Ω′′
V of Ω′
U
and Ω′
V in Ω′′, we have pullback families Y ′′
U = Y ′
U ×Ω′
U Ω′′
U ✲Ω′′
U and
Y ′′
V = Y ′
V ×Ω′
V Ω′′
V ✲Ω′′
V ; and their restrictions to the overlap Ω′′
U ∩Ω′′
V
are isomorphic. We may thus patch them together to form a single
family Y = Y ′′
U ∪Y ′′
V ✲Ω= Ω′′
U ∪Ω′′
V over the union Ωof Ω′′
U and Ω′′
V ,
whose associated structure map Ω✲U ∪V is ﬁnite. This, at last, is
the family we’re after over U ∪V.
Finally, since we can cover Mg with a ﬁnite number of open sets
U admitting such families YU ✲ΩU, this glueing step completes the
proof of the Lemma.
It’s worth noting that each step in this construction is already
needed in the case of the moduli space M1 of curves of genus 1: i.e.,
the afﬁne line with coordinate j. To begin with, in order to have a fam-
ily of smooth curves over a neighborhood U of the point 0, we have
to make a base change ΩU ✲U of order 3, ramiﬁed at 0; and similarly
to have a smooth family near 1728, we have to make a base change
ΩV ✲V of order 2, ramiﬁed at 1728. To cover both, we then have to
take the ﬁber product of these covers, giving us a six-sheeted cover
of M1. But this is still not enough: in order to patch these families
together to form a single family covering all of M1, we have to make
a further base change of order 2, arriving (for example) at the rela-
tively familiar family of curves of genus 1, with j-function of degree
12, given as a pencil of plane cubics.
We note one corollary of Lemma (3.89), which we may think as
of stable reduction for families of curves over higher-dimensional

150
3. Techniques
bases, and whose proof we leave as an exercise. To state this corol-
lary, we need one more bit of terminology. Suppose we’re given a
family ρ : X ✲B of curves, and we want to apply to this family the
base change associated to a generically ﬁnite map B′ ✲B with B′ ir-
reducible. If, in fact, the ﬁber dimension of ρ does jump, then it may
happen that the ﬁber product X ×B B′ is no longer irreducible. In this
case, we’ll simply disregard the components of the ﬁber product that
fail to dominate B: we deﬁne the essential pullback X′ ✲B′ of our
family to be the unique irreducible component X′ of the ﬁber product
X ×B B′ dominating B′, equipped with the restriction of the projection
map to B′. We then have the:
Corollary (3.96) (Stable reduction over general bases) For
any morphism f : X ✲B of integral varieties whose general ﬁber is
a smooth curve of genus g ≥2, there exists a generically ﬁnite map
B′ ✲B, a family of stable curves X′ ✲B′ and a birational isomorphism
of X′ with the essential pullback to B′ of the family X ✲B.
We should note (though it’s not really within the purview of this
book) that an analogue of the basic stable reduction theorem Propo-
sition (3.47) holds for families X ✲B of higher-dimensional vari-
eties over a one-dimensional base B: after base change and bira-
tional modiﬁcations, we can arrive at a family all of whose ﬁbers
are scheme-theoretic normal crossings. The situation for families of
higher-dimensional varieties over higher-dimensional bases, however,
is much less clear; in particular, the analogue of Corollary (3.96)
doesn’t seem to hold. For the best statement we know in this direction,
see Abramovich and Karu [1].
E
Grothendieck-Riemann-Roch
and Porteous
Grothendieck-Riemann-Roch
The classical Riemann-Roch formula expresses the holomorphic Euler
characteristic of a vector bundle E on a complex manifold X in terms
of topological invariants of the bundle and of the manifold. A more
naive interpretation is as a solution to the initial problem of giving a
formula for the dimension h0(X, E) of the space of global sections of
E in terms of topological invariants. The difﬁculty is that h0(X, E) isn’t
a topological invariant — it need not even be constant in holomorphi-
cally varying families of bundles E. On the other hand, if we throw in
“error terms” ±hi(X, E) coming from the higher cohomology groups
of E, we arrive at the holomorphic Euler characteristic χ(E), which is

E. Grothendieck-Riemann-Roch and Porteous
151
a topological invariant, and which is expressed by the Riemann-Roch
formula.
The Grothendieck form of the Riemann-Roch formula is, in these
terms, just its extension to the relative case. We have, instead of a
single variety or scheme X, a family of schemes {Xb} (that is, a mor-
phism π : X ✲B of schemes) with smooth connected base B, and a
family of vector bundles on that family of schemes (that is, a vector
bundle E on X). We can then try to form the spaces H0(Xb, E) into
a bundle on B, and attempt to describe that bundle. Of course, this
cannot, in general, be done. But, as a ﬁrst approximation to such a
bundle, we can take the direct image sheaf π∗E on B — after all, if E
is ﬂat over B, then at any point b ∈B in the open subset U ⊂B where
the dimension h0(Xb, E) assumes its generic value, π∗E will in fact be
locally free with ﬁber (π∗E)

kb = H0(Xb, E).
This said, we should next specify what information we’re looking
for. To begin with, we would obviously like to know the rank of the
sheaf π∗E — this is just the information given to us by the classical
Riemann-Roch formula applied to the restriction of E to the general
ﬁber Xb of π. Beyond this, however, we would like to understand the
twisting of the sheaf π∗E, as measured by its Chern classes. (Indeed,
we can think of the rank of a sheaf as just the 0th graded piece of its
Chern character, an object which we would like to understand com-
pletely.) The problem, then, is to ﬁnd a formula for the Chern class or
Chern character c(π∗E).
The difﬁculty now is that, in analogy with the classical case, even the
topology of the sheaf π∗E isn’t a topological invariant of the bundle E
and the map π. Instead, we have to throw in “error terms” as before —
in this case, the higher direct image sheaves Riπ∗E (which have ﬁbers
Hi(Xb, E) at general points b ∈B). The way to do this that minimizes
the amount of bookkeeping required is to take the alternating sum of
the Chern characters ch(Riπ∗E) in the K-group K0(B).
We now brieﬂy review how this is set up and carried out. To start
with, we ﬁx, as above, a proper morphism π : X ✲B of projective
varieties and a vector bundle E on X. (Typically, we’re going to view
this data as describing a family of vector bundles Eb on the ﬁbers Xb
of X over B, but we’ll see below that there are interesting results to be
had even in the case where the map π is the inclusion of a point X in
a variety B.) For the rest of this section, we’ll assume that B is smooth.
In fact, in the applications, we’ll want to take B to be the (singular)
moduli space Mg or Mg but we’ll postpone dealing with this extra
complication.
Our formula will be an equality in the Grothendieck group K0(B) of
coherent sheaves on B (which, since B is smooth, is naturally isomor-
phic to the Grothendieck group K0(B) of vector bundles on B). Recall
that, by deﬁnition, K0(B) is the quotient of the free abelian group gen-

152
3. Techniques
erated by the vector bundles F on B by the subgroup generated by all
elements F −E −G for which there is an exact sequence
(3.97)
0
✲E
✲F
✲G
✲0.
If c(F) denotes the total Chern class
c(F) = 1 + c1(F) + c2(F) + · · · ,
the Whitney product formula says that, when such an exact sequence
exists,
(3.98)
c(F) = c(E) c(G) .
To deﬁne the Chern character, we introduce a formal factorization:
c(E) =

i
(1 + αi(E)) .
We avoid the need to deﬁne the αi(E)’s themselves by working only
with symmetric functions of them: these are all expressible as poly-
nomials in the elementary symmetric functions of the αi(E)’s — that
is, as polynomials in the Chern classes ci(E). The most important ex-
ample of such a function is the Chern character, which we deﬁne as
the formal sum
ch(E) =

i
eαi(E).
If E has rank r and we expand each exponential as a formal series in
the αi’s and then group terms of like degree, we obtain
(3.99)
ch(E) =

i

1 + αi(E) + αi(E)2
2!
+ αi(E)3
3!
+ · · ·

= (1 + 1 + · · · + 1) + (α1 + α2 + · · · + αr )
+(α2
1 + α2
2 + · · · + α2
r )
2
+ (α3
1 + α3
2 + · · · + α3
r )
6
+ · · ·
= rank(E) + c1(E) +

c2
1(E) −2c2(E)

2
+ · · · .
Exercise (3.100) The formula for the quadratic term above comes
from the formula
σ 2
1 = n2 + 2σ2

E. Grothendieck-Riemann-Roch and Porteous
153
in which σi denotes the ith elementary symmetric function and ni the
ith Newton symmetric function (i.e., the sum of the ith powers). Use
the analogous formula for σ3 to derive the cubic term in the expansion
of the Chern character above.
The exponentiation in the deﬁnition of the Chern character gives it
two convenient properties. First, given an exact sequence like (3.97),
the identity (3.98) yields
ch(F) = ch(E) + ch(G).
Second, for any bundles E and F
ch(E

F) = ch(E) ch(F).
Together, these are equivalent to the statement that the Chern char-
acter deﬁnes a ring homomorphism
ch : K0(X) ✲H∗(X, Q).
This identity can be used to give a characterization of the Chern char-
acter avoiding the need to introduce the formal roots αi.
Exercise (3.101) Use the Whitney splitting principle to show that the
map that associates to a line bundle L in K(X) the class ec1(L) in
H∗(X, Q) extends to a ring homomorphism. Then show that this ho-
momorphism K0(X) ✲H∗(X, Q) equals the Chern character.
Next, we introduce the Todd class
td(E) of E. This is deﬁned in
terms of the αi’s by
td(E) =

i
αi
1 −e−αi ∈H∗(X, Q) .
As this, like the Chern character, is symmetric in the αi’s, it must be
expressible in terms of the Chern classes of E. The expansion
α
1 −e−α = 1 + α
2 + α2
12 + · · ·
yields, after expanding and rewriting the product deﬁning td(E), the
expansion
(3.102)
td(E) = 1 + c1(E)
2
+ c2
1(E) + c2(E)
12
+ · · · .
Following custom, we write td(X) for the Todd class of the tangent
bundle of X.

154
3. Techniques
Exercise (3.103) 1) Show that the Todd class is multiplicative in
the sense that, given an exact sequence 0 ✲E ✲F ✲G ✲0, we have
td(F) = td(E) · td(G).
2) Find the degree 3 term in the expression of td(E) in terms of the
Chern classes of E.
Finally, recall that the shriek of E by π is given by
π!(E) =

i
(−1)iRi
π∗(E)

.
While the deﬁnitions are lengthy, the formula that relates them is
beautifully succinct.
Theorem (3.104) (Grothendieck-Riemann-Roch) If π : X ✲B is
a proper morphism with smooth base B, then
ch

π!(E)

· td(B) = π∗

ch(E) · td(X)

.
Exercise (3.105) 1) Show that, when B is a point, π!(E) = χ(E) and
td(B) = 1 and use this to reduce the formula above to the Hirzebruch-
Riemann-Roch formula
χ(E) =

ch(E) · td(X)

[X] ,
where [X] denotes integration over the fundamental class of X.
2) Show that, if X is a curve, then
χ(E) = c1(E) +

rank(E) · (1 −g)

and, in particular, if we take E to be a line bundle L of degree d, then
χ(L) = d −g + 1;
i.e., we recover the most basic Riemann-Roch formula.
Of
course,
when
B
has
larger
dimension,
interpreting
the
Grothendieck-Riemann-Roch formula isn’t so easy. We will see how
to do so in practice in the next sections by applying it in three cir-
cumstances to the universal family of curves over the moduli space
Mg.
Chern classes of the Hodge bundle
Our ﬁrst example of the use of the Grothendieck-Riemann-Roch for-
mula will be a calculation already referred to in the general discussion

E. Grothendieck-Riemann-Roch and Porteous
155
of cohomology classes on moduli spaces in Chapter 2: the expression
of the Chern classes λi of the Hodge bundle in terms of the tautolog-
ical classes κi.
To recall the circumstances, the Hodge bundle Λ on Mg is the bundle
whose ﬁber at a point [C] ∈Mg is the space H0(C, KC) of holomor-
phic differentials on C. More precisely, let π : Cg ✲Mg be the univer-
sal curve, ω = ωC/M be the relative dualizing sheaf, and γ = c1(ω);
we deﬁne
Λ = π∗(ω).
Note that this bundle exists only away from the locus of curves with
automorphisms. This is for the most part not a serious problem: since
the locus of curves with automorphisms has codimension g −2, com-
putations involving the Chern classes ci(Λ) with i < g −2 will still be
valid. Alternately, the bundle Λ exists on a ﬁnite cover of Mg, and we
can deﬁne the Chern class of Λ (with rational coefﬁcients) to be the
pushforward of the class of this bundle, divided by the degree of the
cover. We will address these issues more systematically in a moment.
In any event, the Grothendieck-Riemann-Roch formula gives us a
simple expression for these classes. To begin with, note that the conor-
mal bundle of the map π — that is, the difference TC −TM in K(Cg)
— is simply minus the relative tangent bundle, which is the dual of
the relative dualizing sheaf. Hence,
td(Cg)
π∗td(Mg) = td(ω∨) = 1 −γ
2 + γ2
12 −· · · .
Grothendieck-Riemann-Roch thus says that
ch(π!ω) = π∗

1 −γ
2 + γ2
12 + · · ·

·

1 + γ + γ2
2 + γ3
6 + · · ·

= π∗

1 + γ
2 + γ2
12 + · · ·

.
To evaluate the left-hand side of this equation, note that the higher
direct image R1π∗ω is the structure sheaf OMg. Thus ch(R1π∗ω) = 1
and the higher direct images vanish, giving
ch(Λ) −1 = π∗

γ
2 + γ2
12 + · · ·

.
To evaluate the right-hand side, note ﬁrst that γ has degree 2g −2 on
a ﬁber of Cg over Mg; thus
rank(Λ) −1 = g −1,

156
3. Techniques
which of course is no surprise. Next, we have
(3.106)
c1(Λ) = ch1(Λ) = π∗
γ
2

= κ
12 ,
where κ = κ1 is the ﬁrst tautological class. Similarly, to ﬁnd ch2(Λ)
we write
(3.107)
c2(Λ) = ch1(Λ)2
2
−ch2(Λ) = κ2
288
since ch2(Λ) = 0. In general, it’s clear that the Grothendieck-Riemann-
Roch in this case expresses each of the Chern classes of the Hodge
bundle as a polynomial (with rational coefﬁcients) in the tautological
classes κi, and that the polynomial may be worked out explicitly in
any given case. Note in particular that, while the λi are polynomials
in the κi, the above examples already show that the converse is not
true.
Next, we consider how this computation — at least in the case of the
codimension 1 classes in Mg — may be extended over all of the sta-
ble compactiﬁcation Mg. Here we’ll see the discussion of Section D
used in practice. First of all, to deﬁne our terms, we will denote by
ω the relative dualizing sheaf of Cg over Mg, and call the direct im-
age π∗ω on Mg the Hodge bundle Λ. Note that the problem we were
able to gloss over above has now become more serious: the universal
curve now fails to be universal over a codimension 1 locus (all the
points [C] ∈∆1 ⊂Mg correspond to curves with automorphisms).
But now we have an alternative: by Proposition (3.93), in order to de-
rive or prove any relation among divisor classes on the moduli space
we simply have to verify the corresponding relation among the associ-
ated divisor classes on the base B of any family X ✲B of stable curves
with smooth, one-dimensional base and smooth general ﬁber.
To do this, let ρ : X ✲B be any such one-parameter family of stable
curves. We will use t to denote a local coordinate on the base B of the
family. We make one modiﬁcation: we let µ : Y ✲X be a minimal reso-
lution of the singularities of the total space X, and let ν = ρ◦µ : Y ✲B
be the composition. This has the effect, for each node p of a ﬁber of
X ✲B with local coordinates x, y, t satisfying xy = tk, of replacing
the point p by a chain of k −1 rational curves. In this way we arrive
at a family ν : Y ✲B of semistable curves, with smooth total space
and having k nodes lying over each node of a ﬁber of X with local
equation xy −tk. To relate the invariants of the new family ν : Y ✲B
to those of the original, we have the:
Exercise (3.108) 1) Show that the relative dualizing sheaf of the new
family is trivial on the exceptional divisor of the map µ, and hence that
it’s simply the pullback of the relative dualizing sheaf of ρ : X ✲B,
i.e.,
ωY/B = µ∗ωX/B.

E. Grothendieck-Riemann-Roch and Porteous
157
2) Deduce that their direct images are equal, that is,
ν∗ωY/B = ρ∗ωX/B
and likewise that
ν∗

c1(ωY/B)2
= ρ∗

c1(ωX/B)2
.
3) Let Z ⊂Y be the locus of nodes of ﬁbers of Y ✲B. Show that
ν∗([Z]) = δ(ρ) .
With all this said, pretty much the same calculation is made in this
setting, simply replacing Cg and Mg by Y and B respectively. Only
one thing has changed: the relative tangent bundle TY −ρ∗TB (viewed
as an element of the K-ring K(Y)) is no longer the dual of the relative
dualizing sheaf. To see what it is, let C be a stable curve with a node
p, let t be a coordinate on B near the point [C], and let (x, y) be
coordinates on Y near p in terms of which the map to B is given
by t = xy. Working with the cotangent bundles rather than tangent
bundles, the pullback map gives an injection
π∗T ∨
B ✲T ∨
Y
which we may view more concretely as the map
OY⟨dt⟩✲OY⟨dx, dy⟩
sending dt to x dy + y dx. The cokernel is the relative cotangent
bundle
ΩY/B =
OY⟨dx, dy⟩
⟨x dy + y dx⟩.
Note that this is locally free of rank 1 everywhere except along the
locus Z of nodes of ﬁbers of Y over B.
Now, the relative dualizing sheaf ω = ωY/B may be characterized
as the unique invertible sheaf whose restriction to the locus Y \ Z of
smooth points of ﬁbers of π is isomorphic to the relative cotangent
bundle. It follows that we can write
ω = OC⟨α⟩
where
α = dx
x −dy
y .
Note that xα = 2 dx, while yα = −2 dy, so that
Ω:= ΩY/B = IZ

ω.

158
3. Techniques
We can use this to calculate the Todd class of the relative cotangent
bundle Ωin terms of ω. To begin with, to calculate the Chern character
of the ideal sheaf of Z, we apply Grothendieck-Riemann-Roch to the
inclusion i : Z ✲Y. We have
ch(i∗OZ) = i∗

ch(OZ) · td(TZ −i∗TY)

= i∗(η)
where η denotes the class of the locus Z.
From the exact sequence
0 ✲IZ ✲OY ✲OZ ✲0
we have
ch(IZ) = 1 −ch(OZ) = 1 −η
and so ﬁnally:
(3.109)
ch(Ω) = ch(ω) · ch(IZ)
= (1 + γ + γ2 + · · ·) · (1 −η + · · ·)
= 1 + γ +
γ2
2 −η

+ · · ·.
Thus, c1(Ω) = c1(ω) = γ — no news here, since we are modifying ω
only on a codimension two locus. Further,
c2(Ω) = 1
2ch1(Ω)2 −ch2(Ω) = η
so that
td(Y/B) = 1 −γ
2 + γ2 + η
12
+ · · · .
Plugging this into the Grothendieck-Riemann-Roch, we arrive at
c1

ν∗(ωY/B)

= ν∗
c1(ωY/B)2 + η
12

and ﬁnally invoking Exercise (3.108) we have the relation among the
divisor classes on B associated to the family ρ : X ✲B
(3.110)
λ = κ + δ
12
.
Applying the translation Proposition (3.93) and Corollary (3.95), we
arrive at the corresponding formula
12λ −κ = [∆0] + 1
2[∆1] + [∆2] + · · · + [∆⌊g
2 ⌋] ∈Pic(Mg)

Q.
Exercise (3.111) Carry out the calculation for the relation (3.110)
above without introducing the resolution Y of the total space X of
the original family: that is, describe the relationship between the rel-
ative dualizing sheaf and the relative cotangent bundle on a family
X ✲B of stable curves near a point with local equation xy −tk, and
use this to calculate the Todd class of X/B directly.

E. Grothendieck-Riemann-Roch and Porteous
159
Chern class of the tangent bundle
For our ﬁnal example we’ll calculate the canonical class of Mg in terms
of the standard generators of its Picard group. Before we can even be-
gin to try to compute this class, we have to make sense of its deﬁnition.
On the smooth open sublocus M0
g, we mean, as usual, the bundle gen-
erated by the holomorphic differential forms of top degree (3g −3).
However, this deﬁnition doesn’t make sense at singular points of Mg.
We solve this problem by deﬁning “the canonical bundle on Mg” to be
the unique rational line bundle on Mg extending the canonical bundle
on its smooth locus.
Having thus deﬁned the canonical bundle, the computation of its
class turns out to be very similar to the previous two computations.
The connection is provided by the characterization of the tangent
space to the versal deformation space of a nodal curve C. As we saw in
(3.30), this is just the global Ext group Ext1(ΩC, OC). Applying duality,
then, the cotangent space to the moduli stack at a point C will be the
space
T ∨= H0(C, ΩC

ωC)
of global sections of the tensor product of the dualizing sheaf and the
sheaf of differentials.
Accordingly, we’ll introduce what we will call the canonical class of
the moduli stack: this will be the divisor class K on the moduli stack
that associates to any family ρ : X ✲B of stable curves the class
K(ρ) = ρ∗(ΩX/B

ωX/B).
Again, the phrase “canonical class of the moduli stack” should be
treated as atomic: we haven’t deﬁned a stack, let alone the canonical
class of one. The bundle on the right is simply the bundle that asso-
ciates to each point b ∈B the top exterior power of the cotangent
space to the versal deformation space of the ﬁber Xb.
We will express the class K in terms of the usual generators λ and
δi of Picfun(Mg)

Q, and then use this to derive an expression for the
canonical bundle of the moduli space Mg in terms of the generators
λ and [∆i] of Pic(Mg)

Q.
The actual calculation of the class K is completely straightforward,
given what we have already done. We let ρ : X ✲B be any family of
stable curves with smooth, one-dimensional base and smooth general
ﬁber and apply Grothendieck-Riemann-Roch to ﬁnd the ﬁrst Chern
class of the direct image ρ∗(ΩX/B

ωX/B): since the higher direct
images are all zero, we have

160
3. Techniques
ch

ρ∗(ΩX/B

ωX/B)

= π∗

1 + 2γ + (2γ2 −η)

1 −γ
2 + γ2 + η
12

= π∗

1 + 3
2γ +
13
12 γ2 −11
12 η

= (3g −3) +

13
12 κ1 −11
12 δ

= (3g −3) + (13λ −2δ).
Hence, in particular, the canonical class K of the moduli stack is
given by
(3.112)
K = 13λ −2δ .
How do we use this to get a formula for the canonical class of
the moduli space? We’re actually pretty close: after all, at any point
[C] ∈Mg corresponding to a curve without automorphisms, the ﬁber
of the canonical bundle KMg at [C] is again the top exterior power of
the cotangent space to the versal deformation space of the ﬁber Xb,
so the pullback of KMg to the moduli stack should be just K — or it
would be if it were not for the presence of the divisor ∆1. For a general
point [C] ∈∆1, the versal deformation space of C is a two-sheeted
cover of its image in Mg, ramiﬁed along ∆1. It follows that
π∗KMg = K + δ1 ∈Picfun(Mg)

Q,
that is, we must subtract δ1 from the canonical class of the moduli
stack to obtain the pullback to the moduli stack of the canonical class
KMg of Mg. (In the language of stacks, we would say that “the moduli
stack is ramiﬁed over the moduli space along the locus ∆1” — a pretty
nifty trick, considering that the map π from the moduli stack to the
moduli space is ﬁnite of degree 1). We have then
K −δ1 = 13λ −2δ −δ1
and so we ﬁnd, by again applying our dictionary, that on Mg itself
(3.113)
KMg = 13λ −2[∆0] −3
2[∆1] −2[∆2] −· · ·
= 13λ −2[∆] + 1
2[∆1].

E. Grothendieck-Riemann-Roch and Porteous
161
Porteous’ formula
One further tool that is often of use in analyzing the geometry of
moduli spaces is Porteous’ formula, which expresses the class of the
locus where the rank of a map between vector bundles is less than
or equal to a given bound. Applications of this formula are already
abundant in the theory of a single curve. To cite one example, the
Riemann-Roch formula for divisors on a curve C says that a divisor
D of degree d moves in a linear series of dimension at least r if and
only if the rank of the evaluation map
H0(KC)
✲H0(KC/KC(−D))
is d−r or less. As D varies, the target and domain spaces of this map
give vector bundles over the symmetric product Cd of C, and applying
Porteous to the corresponding bundle map we arrive at a formula for
the class of the locus in Cd of divisors D such that r(D) ≥r. In
particular, observing that this class is nonzero (when its codimension
is d −r or less) gives the ﬁrst proof of the existence of special linear
series on an arbitrary curve whenever the Brill-Noether number ρ ≥0.
For such reasons, the subject of Porteous’ formula and its applica-
tion to curves is already discussed at reasonable length in [7, Chap-
ters 2 and 8]. We will simply state the formula here, assuming a famil-
iarity with its derivation and the applications to a ﬁxed curve, and con-
centrating on giving further applications of the formula to the study
of the geometry of families of curves.
To state this, we need to recall two additional notations. The ﬁrst
is the Chern polynomial. For a vector bundle E, this is just the formal
polynomial
ct(E) =

i
ci(E)ti.
By the Whitney product formula, this extends to a group homomor-
phism from K(X) (which we write additively) to the multiplicative
group of units of the formal power series ring H∗(X)[[t]].
Next, for any formal series ct =

i citi, any integer a and any posi-
tive integer b, we deﬁne Ma,b(ct) to be the b ×b matrix whose (i, j)th
entry is ca+j−i. Finally, we set ∆a,b(ct) = det(Ma,b(ct)). In these terms,
Porteous’ formula is:
Theorem (3.114) (Porteous’ formula) Let ϕ : E ✲F be a homo-
morphism between vector bundles of respective ranks m and n on a
smooth variety X. Let
Xk(ϕ) = {x ∈X | rank(ϕx) ≤k} .

162
3. Techniques
and let [Xk(ϕ)] be the fundamental class of Xk(ϕ). If Xk(ϕ) is either
empty, or of the expected codimension (m −k)(n −k), then
[Xk(ϕ)] = ∆n−k,m−k ((ct(F −E)))
= ∆m−k,n−k ((ct(E∨−F∨)))
= (−1)(e−k)(f −k)∆m−k,n−k ((ct(E −F))) .
The hyperelliptic locus in M3
The ﬁrst problem to which we’ll apply Porteous’ formula is the follow-
ing. In the moduli space M3 of smooth curves of genus 3, let H = H3
denote the locus of hyperelliptic curves. Since H is a closed subvariety
of codimension 1, it has a class in Pic(M3)

Q. We ask now what that
class is.
This will be another example of how these sorts of computations
are most naturally carried out on the moduli stack, rather than the
moduli space. The steps by now should be familiar: we’ll introduce
the divisor class h on the moduli stack associated to the subvariety
H ⊂M3 as in Proposition (3.91); we calculate the degree deg(h(π))
of h on a one-parameter family π : X ✲B of curves of genus 3 —
that is, the number of hyperelliptic curves in such a family — in terms
of the degree λ(π), and ﬁnally use this to deduce a relation between
the classes [H] and λ ∈Pic(Mg). The part that is new is the middle
part, the calculation of the number of hyperelliptic curves in a one-
parameter family, which will involve an application of Porteous.
To carry this out, we ﬁrst need a good characterization of hyperel-
liptic curves. There are, of course, many: the canonical map isn’t an
embedding; we have an involution with 2g + 2 ﬁxed points; there is a
degree 2 map to P1; and so on. The one that is most useful here, how-
ever, is the characterization via Weierstrass points: a smooth curve C
is hyperelliptic if and only if it contains a point p ∈C such that 2p
fails to impose two independent conditions on the canonical series,
i.e., with
h0 
KC(−2p)

= 2.
To globalize this, suppose that π : X ✲B is any smooth family
of curves of genus 3, not all hyperelliptic. We can deﬁne two vector
bundles on the total space X of the family, as follows. First, we let
E be the bundle whose ﬁber at a point (b, p) (where b ∈B and p is
a point of Xb) is the space of sections H0(Xb, KXb). This is just the
pullback of the Hodge bundle:
E = π∗(π∗ωX/B);

E. Grothendieck-Riemann-Roch and Porteous
163
or, if we let X2 = X ×B X be the ﬁber product of X with itself over B
and πi the projection maps to X,
E = (π1)∗(π∗
2 ωX/B).
Next, we take F to be the bundle whose ﬁber over (b, p) is the space
H0(KC/KC(−2p)) of differentials in a neighborhood of p in Xb, mod-
ulo those vanishing to order 2 at p: that is, if X2 is as above and ∆⊂X2
is the diagonal
F = (π1)∗

π∗
2 ωX/B

OX2/I2
∆

.
We then have a natural evaluation map ϕ : E ✲F, sending each global
holomorphic differential on Xb to its truncated Taylor series at p.
Abstractly, this is just the pushforward under π1 of the restriction
map
π∗
2 ωX/B
✲π∗
2 ωX/B

OX2/I2
∆
on X2. The key point is then that the locus Ωof points (b, p) ∈X
such that p is a hyperelliptic Weierstrass point of Xb is exactly the
locus where the map ϕ fails to be surjective. Porteous’ formula (in a
simple case at that) will give us a formula for the class of Ω, and, since
the generic hyperelliptic Xb has exactly eight such p’s, the class h(π)
will be simply
1
8
th of the pushforward of this class.
To make the calculation, we need to know the Chern classes of E
and F. The class of E we’ve already calculated: it’s the pullback to X
of the class
λ = κ
12 = π∗(γ2)
12
,
where γ = c1(ωX/B) is the ﬁrst Chern class of the dualizing sheaf. On
the other hand, for F we have a two-term ﬁltration
(3.115)
0
✲F2
✲F
✲F1
✲0
where the ﬁber of F1 at (b, p) is H0 
KXb/KXb(−p)

and the ﬁber of F2
is H0 
KXb(−p)/KXb(−2p)

. Now, the line bundle F1 is just the relative
dualizing sheaf itself. Similarly, the bundle F2 is just the square of the
relative dualizing sheaf. It follows that
c(F) = (1 + γ)(1 + 2γ) = 1 + 3γ + 2γ2 .
We now apply Porteous’ formula (3.114) to conclude that the locus
where ϕ fails to be surjective has class
[Ω] = c2(E∨−F∨).
(Since here we have n = m = 2 and k = 1, the matrix M has a single
entry, which we’ve chosen to express using the second of the three
forms in (3.114).) Modulo terms of codimension 2 in B, we have
c(E∨) = 1 −λ,

164
3. Techniques
and from the above,
c(−F∨) = (1 −3ω + 2ω2)−1 = 1 + 3ω + 7ω2,
so that
c(E∨−F∨) = 1 + (3ω −λ) + (7ω2 −3ωλ).
Thus,
[Ω] = 7ω2 −3ωλ
and hence
π∗([Ω]) = 7κ −12λ = 72λ .
We conclude that
h = 9λ ∈Picfun(M3)

Q
and hence by our Basic Proposition (3.93) that the class [H] of the
locus H is given by
[H] = 18λ ∈Pic(M3)

Q .
Here are some exercises about hyperelliptic and related loci.
Exercise (3.116) The calculations above make the implicit assump-
tion that the scheme Ω— deﬁned as the determinantal scheme asso-
ciated to the map ϕ — is reduced. Verify this by writing ϕ explicitly
for a family of curves whose associated arc in M3 is transverse to B
— for example, the stable reduction of the general pencil of quartics
specializing to a double conic, as described above.
Exercise (3.117) Find the class in Pic(M3) of the locus of curves C
with a point p such that 4p ∼KC, or equivalently the union of the
locus of plane quartics with a hyperﬂex and the hyperelliptic locus.
Exercise (3.118) More generally, for each semigroup S of nonnega-
tive integers having index g (that is, such that #(Z≥0 \ S) = g), let WS
denote the locus of curves C with genus g possessing a Weierstrass
point with semigroup S. For g = 3 and 4, determine when this locus is
reduced and of the expected codimension, and when it is, calculate its
class in A(M3). (A discussion of these loci in moduli spaces of curves
of general genus g can be found in Section 5.D.)
Exercise (3.119) Let W ⊂Mg be the locus of curves C with a sub-
canonical point — that is, a point p such that (2g −2)p ∼KC. What is
the expected dimension of W? Assuming that W has this dimension,
what is its class?
Exercise (3.120) Prove that the locus of curves in M4 that have only
one pencil of degree 3 is a divisor — the general curve of genus 4 has
two such pencils — and ﬁnd the class of this divisor.

E. Grothendieck-Riemann-Roch and Porteous
165
Relations amongst standard cohomology classes
Note that a variant of this calculation gives us relations in the co-
homology ring of Mg. To see an example in genus 3, consider the
restriction map from the pullback E of the Hodge bundle to the bun-
dle F1 ≊ω in (3.115) above. Since the canonical series of a smooth
curve of positive genus never has a base point, this map is surjective,
from which it follows that c3(E∨
ω) = 0 in H∗(C3). Calculating this
out yields
0 = c3(E∨
ω)
= γ3 + γ2c1(E∨) + γc2(E∨) + c3(E∨)
= γ3 −γ2 · κ
12 + γ · κ2
288 + · · · .
(We have written κ for the pullback to C3 of the class κ = κ1 and, in
the ﬁnal line, omitted the last term, which is the pullback of a class in
codimension 3 in M3). Pushing this forward to H4(M3), we have
0 = κ2 −κ2
12 + 4 κ2
288 ,
or, after simplifying,
72κ2 = 5κ2.
In general, similar constructions can be applied to give relations
among the generators κi of H∗(Mg) for all g. For example, as above
we can use the fact that the canonical series is base point free to
deduce that cg(E∨
ω) = 0 in Mg, where E is as before the pullback
to Cg of the Hodge bundle. As above, pushing this forward gives us
a relation in H2g−2(Mg). At the same time, it’s equally true that no
differential on a smooth curve of genus g vanishes to order 2g −1 at
any point. This says that the bundle map
E∨
✲J2g−1
is injective, where Jk is the bundle on Cg whose ﬁber at a point (C, p)
is the space H0(C, KC/KC(−kp)). This, by Porteous’ formula (3.114),
yields a relation in degree g among the classes γ and κi in H∗(Cg),
and hence a relation among the classes κi in degree g −1 in H∗(Mg).
Although, in view of Looijenga’s vanishing theorem [Theorem (2.52)],
we might expect all terms in this relation to be 0, Faber’s work shows
that such apparently useless relations can in fact have important im-
plications.

166
3. Techniques
Exercise (3.121) Find this relation in H2(M3).
We can generalize this further by deﬁning Em to be the pullback to
Cg of the bundle of m-canonical differentials and Jm
k to be the bundle
of kth-order jets of such differentials. (The previous example is just
the case m = 1.) If C is any smooth curve, p is a point of C and m ≥2,
then
the multiple

(m −1)(2g −2) −1

· p imposes indepen-
dent conditions on |mKC|,
and,
no m-fold differential vanishes to order m(2g−2)+1 at p.
For each m, this yields two more relations among the classes κi and γ
in degrees g+1 in H∗(Cg), and, correspondingly, relations in degree g
in H∗(Mg). Unfortunately, writing down almost any of these inﬁnitely
many relations explicitly (at least by hand) is essentially impossible.
If we note, however, that the coefﬁcient of each κi in the mth relation
is polynomial in m, we do get one simpler relation.
Exercise (3.122) Find the leading term in m of the sequence of rela-
tions deﬁned above to derive an explicit polynomial of degree g + 1
in κi and γ vanishing in H2g+2(Cg).
Divisor classes on Hilbert schemes
Throughout this section, we’ve been applying the Grothendieck-
Riemann-Roch and Porteous formulas to derive relations among
classes on families of stable curves in the abstract, and thereby re-
lations among classes on the moduli space. We can also apply them
to ﬁnd relations among classes on Hilbert schemes parameterizing
curves in projective space.
To set this up, let H0 be a component of the restricted Hilbert
scheme parameterizing curves C ⊂Pr of degree d and genus g, and
let H be the open subset of H0 parameterizing smooth curves. There
are ways of extending these calculations to larger subsets of H0 — see
[33], for example, for analogous computations in case r = 2 — but this
comes at the expense of greater technical complications, and since we
are here trying to indicate simply what calculations are possible, we’ll
skip this.
We ﬁrst introduce the basic divisor classes on H . As on page 64,
we let X ⊂H × Pr be the universal curve; we let ω = ωX/H be the
relative dualizing sheaf of X over H , and we let OX(1) be the pullback

E. Grothendieck-Riemann-Roch and Porteous
167
of OPr (1) via the projection X ✲Pr . We then denote by η and ξ the
Chern classes of the line bundles ω and OX(1), and set
A = π∗(ξ2),
B = π∗(ξ · η)
and
C = π∗(η2)
where π : X ✲H is the projection. Note that by what we’ve already
established, the class C is simply the pullback of the class κ = 12λ
under the induced map H ✲Mg.
In addition to these abstractly deﬁned classes, we have a number
of other divisors and line bundles that may be deﬁned in terms of the
geometry of the projective curves parametrized by H , and we may
ask whether we can describe their classes as linear combinations of
the classes A, B and C. We will give these as a series of exercises.
Exercise (3.123) For any codimension 2 linear space Λ ≊Pr−2 ⊂Pr ,
let
I = IΛ = {[C] ∈H : C ∩Λ ≠∅}
be the locus of curves meeting Λ. Show that the class of I is simply A.
Exercise (3.124) For any hyperplane H ⊂Pr , let T = TH be the locus
of curves tangent to H. Show that the class of T is simply B.
Exercise (3.125) Let S ⊂H be the locus of curves C that possess a
hyperstall, that is, a hyperplane having contact of order r +2 or more
with C at a point p ∈C. (In classical terminology, a point p ∈C whose
osculating hyperplane has contact of order r + 1 or more with C at p
— what we now call a ramiﬁcation point — was called a stall.) Show
that S has pure codimension 1 in H , and ﬁnd its class.
Exercise (3.126) Similarly, let F ⊂H be the locus of curves C that
possess a point p whose osculating (r −2)-plane has contact of order
r or more with C at p. Show that F has pure codimension 1 in H , and
ﬁnd its class. (You can check that S and F are the only two divisors in
H deﬁned by ramiﬁcation conditions.)
Exercise (3.127) To check the preceding two exercises, let R ⊂X be
the locus of ramiﬁcation points. Find its class, and ﬁnd the branch
divisor of the projection R✲✲X ✲H .
Exercise (3.128) Now let r = 3, and let B ⊂H be the locus of curves
possessing a bitangent line. Again, show that B is a divisor, and ﬁnd
its class.
Exercise (3.129) Suppose that nd > 2g −2, and that En = π∗OX(n)
is the vector bundle on H whose ﬁber at each point [C] is the vector
space H0(C, OC(n)). Find the ﬁrst Chern class of En.

168
3. Techniques
Exercise (3.130) Suppose now that d = g+r > 2g−2 and let D ⊂H
be the locus of degenerate curves, that is, curves C lying in some
hyperplane in Pr . Using the result of the preceding exercise, show
that D is a divisor, and ﬁnd its class.
Exercise (3.131) Let now r = 3, d = 6, and g = 3. In this case, the
locus of curves C ⊂P3 lying on a quadric forms a divisor in H ; ﬁnd
its class. (Hint: again apply Exercise (3.129).) What does this have to
do with the calculation of the class of the hyperelliptic locus in M3?
Exercise (3.132) Suppose now that d = 2g −2 and r = g −2. In
this case, the locus of curves that aren’t linearly normal (i.e., that are
projections of canonical curves from Pg−1; or, equivalently, such that
OC(1) ≊ωC) form a divisor. Once more, ﬁnd its class.
Finally, here is a general challenge:
Problem (3.133) Consider two larger open subsets of the Hilbert
scheme containing H : the locus of stable curves embedded in Pr ,
and larger still, the locus of nodal curves. Can you carry out any or all
of the above computations on these loci?
Note that to do this you’ll have to introduce as well the classes of
the divisors corresponding to singular curves, which may be compli-
cated: for example, the loci of curves with two components C1 and
C2 meeting at a point will have to indexed by both the genera g1 and
g2 = g −g1 and the degrees d1 and d2 = d −d1 of the components.
And, even if we start with d ≫g, the degrees and genera of some of
the components of curves appearing in the boundary may not satisfy
any such inequality.
F
Test curves: the hyperelliptic locus in
M3 begun
We will now complete the calculation of the class of the locus H of
hyperelliptic curves in the moduli space of curves of genus 3. By “com-
plete”, we mean the following: we let H = H3 be the closure in M3
of the closed subvariety H ⊂M3 and ﬁnd the class of H in terms of
the three generators λ, [∆0] and [∆1] of Pic(M3)

Q. Equivalently,
if we let h denote the divisor class on the moduli stack associated
to the subvariety H ⊂M3 as in Proposition (3.91), our goal is to ex-
press h as a linear combination of the three generators λ, δ0 and δ1
of Picfun(M3)

Q.

F. Test curves: the hyperelliptic locus in M3 begun
169
We will refer to H as the locus of hyperelliptic stable curves of genus
3. In general, whenever we refer to a subvariety of the moduli space of
stable curves characterized by a property normally ascribed to smooth
curves (e.g., hyperelliptic curves, trigonal curves, plane quintics of
genus 6, etc.) we’ll mean the closure in Mg of the locus of smooth
curves with this property. Thus we deﬁne a hyperelliptic stable curve
of genus g to be a stable curve that is the limit of smooth hyperelliptic
curves.
Warning. H is not the locus of curves that possess a linear series of
degree 2 and dimension 1 because any reducible curve has such a
series. Just take a line bundle of large degree on one component to
get the sections and use a bundle of negative degree on the other to
make the total degree come out right.
How do we calculate the class of H? Trying to to extend the applica-
tion of Porteous’ formula is the most obvious approach. The problem
here is that one of the bundles in question — the bundle F = J2 whose
ﬁber at a point (C, p) is the space H0(C, KC/KC(−2p)) — cannot be
extended to a vector bundle over the nodes of ﬁbers of the family of
curves. At a node P, there is an entire one-parameter family of de-
gree 2 divisors supported at P and none of these is singled out. More
formally, in a family X ✲B, F can be deﬁned as
π1∗

π∗
2

ωX/B
 
OX×BX/I2
∆

.
This deﬁnition certainly extends, but, near nodes, the diagonal ∆isn’t
a local complete intersection, and so has no Cartier divisor structure.
This means that the direct image by π1 is only a coherent sheaf and
not a vector bundle.
What we would need, therefore, to carry out this strategy is a version
of the Porteous formula for coherent sheaves. Such a formula, even
with strong restrictions on the sheaves involved, would be extremely
useful in many contexts; but no one has, as present, been successful
in producing one. Nonetheless, we pose the:
Question (3.134) Is there a Porteous type formula for maps of
torsion-free coherent sheaves? That is, given a map ϕ : E ✲F of such
sheaves on X, can we give the locus
Xr := closure of {p | E and F are locally free at p and rankp(ϕ) ≤r}
a scheme structure, and express its class in terms of the Chern classes
of E and F and of local contributions at points where E and F aren’t
locally free?
Fortunately, there is an alternative, if less direct, approach to the
problem. We know there exists a relation expressing the divisor class

170
3. Techniques
h on the moduli stack as a linear combination of the generators
h = a · λ + b · δ0 + c · δ1.
Indeed, we know already that the coefﬁcient a = 9 and the problem
is simply to determine b and c. We will do this by taking explicit one-
parameter families of stable curves of genus 3 and evaluating both
sides of this equation on them to deduce two independent linear re-
lations among the coefﬁcients a, b and c. This is colloquially referred
to as the method of test curves.
We start with probably the simplest family of (generically smooth)
stable curves of genus 3: a general pencil of plane quartics; that is, the
family of curves {Ct} given by polynomials F(X, t) = t0G(X)+t1H(X)
for general G and H. We have to describe the degree, on the base
B = P1 of this family, of the various divisor classes h, λ, δ0 and δ1.
Two are easy. Since the pencil is general, it will consist entirely of
smooth curves and irreducible curves with one node. Thus, all the
curves Ct are stable, no stable reduction is necessary, and the family
contains no curves corresponding to points in ∆1. The family will also
contain no hyperelliptic curves although this point is subtler: since we
don’t know what plane models singular elements of H might have, we
need to check that none of the irreducible nodal curves in the pencil
lies in H. The birational map from the P14 of plane quartics to M3
takes the discriminant locus D onto ∆. Therefore, the locus in D of
curves mapping to H is proper and a generic pencil avoids it. The
upshot is that
deg

h(ρ)

= deg

δ1(ρ)

= 0.
Next we want to count the points (p, t) at which Ct is singular. Each
of the forms ∂F/∂x, ∂F/∂y and ∂F/∂z must vanish at (p, t). Since
each is bihomogeneous of type (3, 1) in (X, t), what we want is the
intersection of three divisors of type (3, 1) on P2 × P1. Letting α be a
divisor of type (1, 0) and β be one of type (0, 1), this is
(3α + β)2 = 3(3α)2β = 27α2β = 27.
Thus, the discriminant locus has degree 27 and our pencil meets it
transversely that many times. It’s tempting to conclude directly that
the image of the pencil in M3 likewise meets ∆transversely 27 times.
This is, in fact, true here but requires a further argument: speciﬁcally,
we have to invoke Lemma (3.94). Since our pencil is generic, each of
its 27 singular elements contains a single node. Moreover, none of
the nodes is a base point of the pencil. Hence the total space of the
associated family of curves is smooth and we may apply the lemma
to conclude that
deg

δ0(ρ)

= 27.

F. Test curves: the hyperelliptic locus in M3 begun
171
To ﬁnd the degree of λ, we observe that if π : X ✲B is a family of
stable curves, ω = ωX/B, and E = π∗ω, then degB(λ) = c1(E). For a
generic pencil, we can identify E by writing down a spanning set of
sections (or equivalently of differentials on all curves in the pencil).
On the curve in the pencil corresponding to any ﬁnite value of t, with
afﬁne equation f (x, y) = 0, three differentials are
η1 =
dx
∂f /∂y ,
η2 =
x dx
∂f/∂y
and
η3 =
y dx
∂f/∂y .
Homogenizing by setting x = X
Z and y = Y
Z, this gives three rational
sections of E which are deﬁned and independent except at t = ∞. This
is even true at the nodes as ωC is the restriction to C of OP2(1) for all
C in the pencil. As t ✲∞, each of the η’s has a simple zero because
the equation F(t, X, Y, Z) involves t linearly. Thus, the differentials
t · η1, t · η2, and t · η3, are nonvanishing and independent at inﬁnity.
This shows that
E = OP2(1) ⊕OP2(1) ⊕OP2(1)
and hence that
deg

λ(ρ)

= 3.
Another approach to ﬁnding the degree of λ is to view X as a divisor
of type (1, 4) on P1 × P2. By adjunction,
KX = KP1×P2
O(X) = OX(−1, 1).
Since π∗(KB) = OX(−2, 0), we ﬁnd that
ωX/B = KX

π∗(KB)−1 = OX(1, 1).
Hence, if we denote by α a divisor of class (1, 0) and by β one of class
(0, 1), we ﬁnd that deg(κ(ρ)) is the intersection number on P1 × P2
(α + 4β)(α + β)(α + β) = 9.
In view of the relation κ + δ = 12λ and deg(δ(ρ)) = 27, we again
arrive at deg(λ(ρ)) = 3.
Applying our assumed relation of classes
h = aλ + bδ0 + cδ1
to the one-parameter family ρ : X ✲B and taking degrees thus yields
the relation of coefﬁcients
0 = 3a + 27b + 0c ,
which, since we know that a = 9, tells us that b = −1.

172
3. Techniques
Exercise (3.135) Verify the calculations of a and b above by restrict-
ing to the families ρ : X ✲B obtained by
1) taking a pencil of hyperplane sections of a smooth quartic surface
in P3; and
2) taking a pencil of plane quartics containing a double conic but
otherwise generic. (This will require a semistable reduction, and is a
substantially more delicate calculation. The answer, along with the
analogous degrees for other pencils, is given in Exercise (3.166).)
What sort of pencil might we use to extract the ﬁnal coefﬁcient
c? The unfortunate fact is that no pencil of quartics whose singular
elements are stable as abstract curves will do: the only such curves
containing an elliptic component will consist of an elliptic curve plus
a rational component meeting it 3 times. Since none of these three
nodes is a disconnecting one, such curves all lie in ∆0 rather than in
∆1! What is needed is to carry out the stable reduction of a pencil con-
taining a cuspidal quartic member. This is possible but onerous since,
during the entire sequence of blowups, base changes, normalizations
and blow downs, we need to do the bookkeeping of the canonical class
of X, of the relative dualizing sheaf ωX/B, and of all the related in-
tersection numbers. Moreover, to treat values of g larger than 3 we’ll
clearly need other methods. As g increases, writing down generically
smooth pencils becomes increasingly difﬁcult and the accessible ex-
amples such as families of hyperelliptic or trigonal curves only cover
small subvarieties in Mg.
The most common approach is to use families consisting entirely
of singular curves. We will look at three examples of such families.
Since we have uses for these families beyond the consideration of
the hyperelliptic locus in M3, we consider them in all genera greater
than 2.
Example (3.136) Fix a curve D of genus (g−1) and an elliptic curve E
and attach a ﬁxed point p of E to a varying point of D. In other words,
the total space X of our family would be the disjoint union of D × D
and D × E modulo the identiﬁcation of the diagonal ∆of D × D with
D × {p} in E as shown in Figure (3.138).
Example (3.137) Fix a curve D of genus (g −1) and identify a ﬁxed
point p of D with a varying point q of D. This gives a family lying in ∆0.
However, as we established in Section C, the ﬁber over p itself (that is,
where q approaches p) is a copy of D joined by a disconnecting node
to a rational curve with a node or “pigtail” and this family therefore
meets ∆1 once. (To see this, begin with D × D as in the diagram on
the left of Figure (3.139), then blowup the point (p, p) obtaining the

F. Test curves: the hyperelliptic locus in M3 begun
173
diagram on the right and ﬁnally identify the now disjoint sections
D × {p} and ∆to get the bottom diagram.)
∆
D
p
E
D
Figure (3.138)
D × {p}
D × D
∆
D
p
D × D
∆
D × {p}
D
D
P1
D
p
D × D
D
D
p
Figure (3.139)
Example (3.140) Fix a curve D of genus (g −1) and identify a ﬁxed
point p of D with a base point q of a generic pencil of plane cubic
curves E to obtain a family of stable curves of genus g over P1. As
the elliptic curves degenerate, we again pick up a special ﬁbers with a
“pigtail”.
The difﬁculty with all these families is that we have no way of telling
which elements are hyperelliptic (i.e., lie in H3). For this, we’ll need to
introduce the notion of admissible cover, which will be the subject

174
3. Techniques
of the next section. Before we turn to this subject, we’ve recorded
in Table (3.141) the intersection numbers of each with the standard
classes. We haven’t listed the degrees of the δi’s for i ≥2 because
these are all clearly 0.
Example (3.136)
Example (3.137)
Example (3.140)
deg(λ)
0
0
1
deg(δ0)
0
2 −2g
12
deg(δ1)
4 −2g
1
−1
Table (3.141)
Let’s begin to verify this table with Example (3.136) in which the
ﬁber Xq is the union of D and E with q in D identiﬁed to p in E. A
section of ωX/D pulls back on D to a section of KD(q) vanishing at
q and on E to a section KE(q) vanishing at p. Conversely, a pair of
sections sD of KD(q) and sE of KE(q) descend to a section of ωX/D if
and only if sD vanishes at q and sE vanishes at p. The upshot is that
H0(KXq) = H0(KD) ⊕H0(KE)
independent of q. Thus the direct image Λ of ωX/D on D is trivial and
its ﬁrst Chern class λ is trivial. Hence, degD(λ) = 0.
The degree degD(δ0) is also 0 because each ﬁber Xq contains a sin-
gle disconnecting node. For the same reason, the image of this fam-
ily in moduli lies entirely in ∆1. To ﬁnd D · ∆1, therefore, we apply
Lemma (3.94), which says that the value on D of the divisor class δ
(or, equivalently in this case, δ1) on the moduli stack is the tensor
product of the normal bundles ND×{p}/D×E

N∆/D×D. The ﬁrst factor
here is trivial, and the second has degree equal to the self-intersection
of the diagonal ∆in the product D × D of a curve of genus g −1 with
itself. This is just the topological Euler characteristic of D, which is
4 −2g. (Since test curves often lie in a component of ∆, this type of
normal sheaf argument occurs fairly frequently.)
Example (3.137) illustrates this in a somewhat dual manner. Only
the ﬁber Xp contains a disconnecting node and since the surface X
is smooth at this point it follows that degD(δ1) = 1. However the
image of this family in moduli lies entirely in ∆0, so we again need
to compute the restriction to D of the normal bundle to ∆0 in Mg
to evaluate degD(δ0). Here this bundle is the tensor product of the
normal bundles to the proper transforms of ∆and of D × {p} on the
blowup of D × D at (p, p). On D × D, ∆2 = 4 −2g and (D × {p})2 = 0.
Since each curve passes through (p, p), each self-intersection drops
by one when we blow up, yielding degD(δ0) = 2 −2g.

G. Admissible covers
175
To calculate degD(λ), we use the exact sequence on Xq
0
✲H0(KD)
✲H0(ωXq)
resp✲C
✲0.
The corresponding sequence of direct images is
0
✲H0(KD)

O
✲π∗(ωX/D)
✲O
✲0
from which it’s immediate that the ﬁrst Chern class of π∗(ωX/D) is
trivial and, hence, that degD(λ) = 0.
Finally, we come to Example (3.140). Since the elliptic pencil here is
general, there will be twelve singular elements, each a rational nodal
curve or “pigtail”. Moreover, the base point of the pencil will be smooth
on all the elements of the pencil so the total space of the family is
smooth. By Lemma (3.94), each intersection of the family with ∆0 will
be transverse yielding degD(δ0) = 12.
Exercise (3.142) 1) Use a normal bundle argument to show that, in
Example (3.140), degD(δ1) equals the self-intersection, on the rational
elliptic surface associated to the pencil, of the section σq correspond-
ing to the base point q and conclude that degP1(δ1) = −1.
2) Verify that degP1(λ) = 1.
Exercise (3.143) The case g = 2 is special: we have Pic(M2)

Q = 0
(prove this!), and so the class λ ∈Picfun(M2)

Q must be expressible
as a linear combination of the boundary classes δ0 and δ1. Use Ta-
ble (3.141) to show that this relation is
λ = 1
10δ0 + 1
5δ1 .
G
Admissible covers
In order to complete the calculations begun in the preceding section
(and for many other reasons as well), we have to face the question we
ducked earlier: which stable curves are hyperelliptic? Or, more gener-
ally, which stable curves are limits of smooth d-gonal curves?
We will determine the answer by constructing a nice compactiﬁca-
tion of the Hurwitz scheme. Recall from Section 1.G that the classi-
cal Hurwitz scheme Hd,g is the scheme parameterizing pairs (C, π),
where C is a smooth curve of genus g and π : C ✲P1 a branched
cover of P1 of degree d, branched over b = 2d+2g −2 distinct points
p1, . . . , pb. The scheme Hd,g maps naturally to the moduli space Mg
of smooth curves of genus g, and its image contains an open subset of
the locus in Mg of d-gonal curves. What we need is a compactiﬁcation
H d,g of Hd,g with the following somewhat informally expressed list
of properties:

176
3. Techniques
Desired Properties (3.144)
1) The space H d,g should be rela-
tively accessible. For example, its singularities should be reasonable;
it should be possible to describe the components of the boundary
H d,g −Hd,g; and so on.
2) It should be modular, i.e., its points should actually correspond to
some sort of geometric object, preferably a branched cover.
3) It should admit a map to the moduli space Mg of stable curves
extending the map of Hd,g to Mg, i.e., we should have a diagram.
(3.145)
Hd,g✲
✲H d,g
Mg
❄
✲
✲Mg
❄
At ﬁrst glance, this seems not unreasonable. Clearly, we have to
understand what happens when branch points of a branched cover
η : X ✲P1 come together. For example, suppose we have a family
of branched covers {Ct ✲P1} — that is, a family C∗✲∆∗of smooth
curves over the punctured disc, with a map π : C∗✲P1 such that π Ct
is simply branched at b points p1(t), . . . , pb(t) — we can assume after
base change that these are single valued — and suppose that two of
the branch points pi and pj both approach the point p as t ✲0.
What happens in this situation depends on how the simple trans-
positions that express the monodromy of the ﬁbers around pi and pj
are related. There are three possibilities indicated in Figure (3.146).
The two transpositions could be equal, they could be noncommuting
transpositions (that is, overlapping but distinct), or they could be dis-
joint transpositions. In the ﬁrst case, we get in the limit a curve C0
with a simple node. (Note that this curve need not be stable: it may be
reducible with one component rational. This is, in fact, what happens
if the stable limit of the curves Ct is smooth, but the pencil giving the
map Ct ✲P1 acquires a base point at pi(0) = pj(0).) In the other two
cases, we see no visible degeneration as the curve Ct approaches C0
although the covering Ct ✲P1 does degenerate. If the monodromies
overlap, this cover has one triple ramiﬁcation point instead of two
simple ones; if they are disjoint, we see two simple ramiﬁcation points
aligned above one another in a single ﬁber of the covering. In all three
cases, we can ﬁll in the family C∗to a family C ✲∆having only nodal
ﬁbers, with map π : C ✲P1 extending the given map π on C∗and
expressing the ﬁber C0 again as a d-sheeted branched cover of P1.
The problems start when more branch points coincide. What will the
limiting branched cover look like when three or more branch points pi

G. Admissible covers
177
Figure (3.146)
approach a common limit p? Making sketches like those above of a few
examples will convince you that even in cases where you can complete
the family by throwing in a singular curve C0 expressed as a branched
cover of P1, the limiting singularity will depend on the relative rates
of approach of the points pi(t) to p. This makes it unclear what the
space of such covers will look like. Moreover, since the singularities
of the special ﬁber X0 can become extremely complicated, there is no
direct method for determining from the covering data what the stable
limit of the family of curves Xt will be. This in turn prevents us from
describing concretely the closure in Mg of the image of Hd,g.
What is the solution to these problems? The idea, which goes back
to Knudsen [97], is simple: we never allow the branch points to co-
incide. This may at ﬁrst sound outlandish, but in fact we’ve already
seen other examples of how this can be carried out: the moduli space
Mg,n of stable n-pointed curves (C; p1, . . . , pb) of genus g is com-
pact, even though the points pi are never allowed to come together.
In fact, we adopt exactly the same strategy here. The target space of
a simple branched cover will be a P1 with b marked points. Given a
family of branched covers C∗✲∆∗with maps Ct ✲P1 as above, we
can try to ﬁll in the family not with a possibly nastily branched cover

178
3. Techniques
of P1, but with a branched cover of the stable limit (B; p1, . . . , pb) of
the family
!
(P1 × ∆∗; p1(t), . . . , pb(t))
"
⊂M0,b, simply branched over
the points p1, . . . , pb. To put it another way, we think of a point of the
Hurwitz scheme Hd,g as data consisting of a triple: a curve C, a stable
b-pointed rational curve (B; p1, . . . , pb), and a map π : C ✲B simply
branched over the points pi; and we compactify it over the compact-
iﬁcation M0,b of the space M0,b of b-pointed rational curves. Since
Hd,g is a ﬁnite covering space of the variety M0,n, we would ideally
like the compactiﬁcation H d,g to be likewise ﬁnite over M0,n.
Figure (3.147)
Can we in fact implement this idea? The key question to answer is:
what happens to a cover π : C ✲P1 branched over b distinct points
pi(t) as the smooth b-pointed curve (P1; p1(t), . . . , pb(t)) approaches
a general stable b-pointed rational curve (B; p1, . . . , pb)? Happily, it
isn’t impossible to visualize this. To start, consider the simplest case
in which some subset of the points pi(t) come together at comparable
speed — i.e., the family of b-pointed curves is as shown on the left side
of Figure (3.147). In this case, we can simply blow up once at the point
where the pi(t) meet to obtain the stable limit B shown on the right of
the ﬁgure. The curve B is simply a union of two copies of P1 meeting at
one point, with the limits of those pi(t) that remained distinct on one
component and the limits of those that came together on the other.
To see what is going on topologically, we may draw the general ﬁber,
the ﬁbers near t = 0, and, the special ﬁber as shown at the top, middle
and bottom, respectively of Figure (3.148).
Suppose now we have a family of branched covers Ct ✲P1 of the
general ﬁbers of this family. Can we ﬁll it in with a branched cover
C0 ✲B of the special ﬁber? The answer is yes: just as the node of
the special ﬁber B of the family of stable b-pointed rational curves
is created by contracting the loop around the neck of the sphere in
the middle picture above, so the inverse image of that loop in the

G. Admissible covers
179
γ
Figure (3.148)
covers Ct will consist of a collection of disjoint loops, each of which
can likewise be contracted to form a node of C0.
In fact, we can describe C0 explicitly. Suppose q is the node of
B. Then the inverse image π−1(B \ {q}) will be smooth and simply
branched over the points pi ∈B. This leaves only the question: what
goes on at the points of π−1(q)?
To answer this question, we need to ﬁx a bit of notation. Suppose
(after reordering if necessary) that the points {p1(t), . . . , pk(t)} re-
main distinct and that B1 is the component of B on which their limits
lie while the points {pk+1(t), . . . , pb(t)} come together and have lim-
its on the other component B2 of B. Let σi ∈Sd be the monodromy
action associated to the branch point pi(t) on the nearby smooth ﬁber
with respect to a base point on the “collar” γ shown in the middle of
Figure (3.148). The monodromy around the loop γ is then the product
σ = σ1 · . . . · σk = (σk+1 · . . . · σb)−1 ,
and the connected components γ1, . . . , γm of π−1(γ) are loops corre-
sponding bijectively to the cycles of the permutation σ. If γi corre-
sponds to an ai-cycle in σ, then it’ll be a cover of degree ai of γ. Thus,
each branch of the corresponding node ri of C0 will be ramiﬁed over

180
3. Techniques
the corresponding branch of B near q, with ramiﬁcation of order ai.
In other words, if the local equation of B near q is xy = 0, then there
are local coordinates u, v near ri ∈C0 such that C0 is given locally as
u · v = 0
and the map π is given by
x = uai;
y = vai.
It’s a worthwhile exercise to check from this description that the
arithmetic genus of C0 is indeed g. To do this, let C1 and C2 be the
inverse images of B1 and B2. Then C1 is a smooth d-sheeted branched
cover of B1 ≊P1, branched over the k points p1, . . . , pk and also hav-
ing ramiﬁcation points of order ai over q. C1 may or may not be con-
nected, but in any case, by Riemann-Hurwitz, its genus is
g(C1) = −d + 1 +

k +
m
i=1 (ai −1)

2
and similarly the genus of C2 is
g(C2) = −d + 1 +

b −k +
m
i=1 (ai −1)

2
.
Finally, C1 and C2 meet at d −
m
i=1(ai −1) points, so that the genus
of C is
g(C) = g(C1) + g(C2) + d −
m

i=1
(ai −1) −1
= −d + 1 + b
2
= g.
Note that this could also serve to conﬁrm that the singularities of C0
are nodes.
The generalization of this description to the case of an arbitrary
stable b-pointed curve B is immediate and yields the:
Deﬁnition (3.149) Let (B; p1, . . . , pb) be a stable, b-pointed curve of
genus 0 and let q1, . . . , qk the nodes of the curve B. By an admissible
cover of the curve B we’ll mean a nodal curve C and regular map
π : C ✲B such that:
1) π−1(Bns) = Cns, and the restriction of the map π to this open
set is simply branched over the points pi and otherwise unramiﬁed;
and,

G. Admissible covers
181
2) π−1(Bsing) = Csing, and for every node q of B and every node r of
C lying over it, the two branches of C near r map to the branches
of B near q with the same ramiﬁcation index. Equivalently, we can
ﬁnd local analytic coordinates x, y on B and u, v on C such that
for some m,
xy = 0 ,
uv = 0 ,
π∗x = um ,
and
π∗y = vm.
The deﬁnition of a family of admissible covers of a family of stable
b-pointed curves of genus 0 is analogous.
The main theorem about admissible covers says simply that they
have all the desirable properties we hoped for at the start of this sec-
tion:
Theorem (3.150) (Existence of H d,g [82]) There exists a coarse
moduli space H d,g for admissible covers which satisﬁes the conditions
of (3.144).
By deﬁnition, H d,g is modular. Its local geometry is also accessi-
ble: an analytic neighborhood of the point in H d,g corresponding to
a degree d cover π : C ✲(B, p1, . . . , pb) with C of genus G is a quo-
tient of a (2d + 2g −5)-dimensional polydisc by the (ﬁnite) automor-
phism group of the cover π. Likewise, it’s straightforward to describe
the boundary ∆= H d,g −Hd,g: for example, the locus ∆δ of covers
(C; (B, p1, . . . , pb), π) in which B has δ+1 irreducible components (or,
equivalently, δ nodes) has pure codimension δ in H d,g and lies in the
closure of ∆δ−1.
Exercise (3.151) How many irreducible components does the bound-
ary ∆have?
What isn’t so straightforward is the existence of the mapping to Mg
in (3.145) and we won’t give a proof of the main theorem here. Instead,
following our usual practice, we will show, in a few settings that arise
commonly in applications, how to describe the admissible covers that
arise as limits of families of smooth branched covers.
To begin with, suppose that π : Ct ✲P1 is a family of branched
covers with πt branched over the points p1(t), . . . , pb(t). Consider
the three cases illustrated in Figure (3.146) in which two of the
branch points — say p1 and p2 — come together. We know, of
course, what the limit of the family of stable b-pointed rational curves
{(P1, p1(t), . . . , pb(t))} is: it’s the curve of genus 0 in Figure (3.152)
having two components B1 and B2, with p1 and p2 on B2 and the rest
(not shown in the ﬁgure) on B1.
Suppose ﬁrst that the transpositions giving the monodromies σ1
and σ2 around the two points p1 and p2 in the cover Ct ✲P1 are

182
3. Techniques
B1
p1
p2
B2
Figure (3.152)
equal. In this case the monodromy around the neck of the barbell
pictured in Figure (3.148) is trivial, so that the limiting admissible
cover C0 ✲B will be unramiﬁed over the node q of B. Moreover, since
the group generated by σ1 and σ2 has one orbit of order 2 and the
rest of order 1, the inverse image of B2 in C0 will consist of d −1
components. Of these, d −2 will map one-to-one to B2 and one will
be the degree 2 of B2 branched over p1 and p2. (Note that all these
components must be rational.) We may thus draw the picture of the
cover C0 ✲B schematically as in Figure (3.153).
B1
p1
p2
B2
Figure (3.153)
In this case, the stable models C0 of the admissible cover C0 display
a surprising variety. The “new” side of the cover (B2 above) consists
of (d−2) rational curves meeting the “main” side (over B1) in a single
node over the node of the base and one rational curve meeting the
main side in two nodes. In the stable model, all of the former curves
contract away completely and the latter contracts to a node r. It’s
tempting to conclude that the stable model lies in ∆0. This, in fact,
is what happens “most” of the time; but, depending on the combina-
torics of the branch points that remain on the main side of the cover,
the stable model of C0 can lie in any of the ∆i’s or even outside the
boundary.

G. Admissible covers
183
The key fact to recall is that the connected components of the curve
Ct correspond bijectively to the orbits in a general ﬁber of Ct of the
subgroup of the symmetric group generated by the simple transpo-
sitions associated to the monodromy around the full set of branch
points p1, . . . , pb. Since the general curve Ct is connected, this sub-
group must be transitive. However, the transpositions associated to
the branch points p3, . . . , pb that remain on the stable model need
no longer generate a transitive subgroup: the group they do generate
will, in some cases, have two orbits (which were formerly connected
by σ1 = σ2). Correspondingly, the stable model will have two compo-
nents meeting at the node r. Depending on the number of ramiﬁcation
points lying on each component and on the degrees with which each
covers B1, the genera of these components need only satisfy the re-
striction that their sum is g. If the smaller of the two genera is i > 0,
then the stable model will lie in ∆i. If the smaller genus is 0, this ratio-
nal component will again contract away in the stable model leaving a
smooth curve of genus g that covers the line with degree less than d.
d −4 sheets
q
p1
p2
Figure (3.154)
When two branch points come together, there are also two other
combinatorial possibilities for these monodromies. The analysis of
these conﬁrms our earlier conclusions, based on Figure (3.148), that
in these cases the abstract curve Ct undergoes no visible degeneration
as t ✲0.
One possibility, shown as the third in Figure (3.148), is that the
monodromies around the two branch points p1 and p2 are given by a
pair of disjoint transpositions. (If the degree of the covering is large,

184
3. Techniques
we expect this to happen most of the time.) In this case, the schematic
picture of the admissible cover over the new component of the base
(which we’ve shown meeting the main component of the base at a
point q) must be as shown in Figure (3.154). Indeed, the sheets that
ramify over each of p1 and p2 and no others must ramify over the node
q since this monodromy is what occurs at the neck of the “barbell”.
Thus over the new component we have (d −2) rational curves each
meeting the main part of the cover in a single node. In the stable
model, these all contract away, leaving us with a smooth (!) curve in
which two simple branch points on unrelated sheets happen to have
become aligned over q.
The ﬁnal possibility, represented by the middle picture in Fig-
ure (3.148), is that the transpositions corresponding to the mon-
odromies around p1 and p2 have one index in common: their product
is then a three-cycle that gives the monodromy around the point q. We
thus have (d −3) rational components simply covering the new com-
ponent of the base and one rational component that is a triple cover
ramiﬁed simply at p1 and p2 and doubly at q. Again, each of these
curves has a single node and so contracts away in the stable model.
What we see in the stable model is simply a smooth curve in which
two simple branch points have coalesced at q into a double branch
point.
Exercise (3.155) Draw the schematic diagram of the admissible cover
in this case.
Exercise (3.156) The preceding examples may give the impression
that all components of the stable model of an admissible cover lie
over a single component of the base. Show that this isn’t so by showing
that if the new component of the base contains three branch points
all of whose monodromies are identical, then the stable model of the
resulting cover is a reducible curve with an elliptic tail that in the
admissible cover appears as a double cover of a component of the base
containing these three branch points. Find a further degeneration of
this example in which the stable model has a pigtail. (You’ll need three
components in the base curve.)
Exercise (3.157) List the distinct combinatorial possibilities for an
admissible cover whose base curve has two components, one of which
contains exactly three simple branch points.
As we indicated at the outset of this section, one of the main goals
of the theory of admissible covers is to answer the question, “which
stable curves lie in the closure of the locus of smooth k-gonal curves?”.
We will indicate now how this goes. To begin with, some terminology:

G. Admissible covers
185
Deﬁnition (3.158) Let C be a stable curve. We say that a nodal curve
C′ is stably equivalent to C if C is obtained from C′ by contracting to
a point all smooth rational components of C′ meeting the other com-
ponents of C′ in only one or two points (that is, containing only one or
two nodes of C′).
Deﬁnition (3.159) Let C be a stable curve. We say that C is k-gonal
(resp., hyperelliptic, trigonal) if it’s a limit of smooth k-gonal (resp.,
hyperelliptic, trigonal) curves; that is, if [C] lies in the closure of the
locus of smooth curves with a g1
k (resp., g1
2, g1
3).
Now, since the moduli space of admissible covers is projective, we
have the:
Theorem (3.160) A stable curve C is k-gonal if and only if there exists
a k-sheeted admissible cover C′ ✲B of a stable pointed curve of genus
0 whose domain C′ is stably equivalent to C.
With this theorem, we can answer completely the question of which
stable curves are k-gonal. While the combinatorics can get compli-
cated in general, we can usually arrive at a relatively simple answer if
we restrict either to strata of low codimension in the boundary of Mg
or to subvarieties of low codimension in the closure of the locus of
smooth k-gonal curves. The following exercises give some examples.
Exercise (3.161) Let C be a stable curve consisting of two smooth
irreducible components C1 and C2 meeting at a single point p. Show
that C is hyperelliptic if and only if h0(C1, OCi(2p)) = 2 for i = 1 and
2; that is (in case both C1 and C2 have genus at least 2), if and only if
each is hyperelliptic and if p is a Weierstrass point of each.
Exercise (3.162) Now let C be a stable curve consisting of two
smooth irreducible components C1 and C2 meeting at two points p
and q. Show that C is hyperelliptic if and only if h0(Ci, OCi(p+q)) = 2
for i = 1 and 2. That is (in case both C1 and C2 have genus at least 2),
if and only if each is hyperelliptic and if the pair p and q is conjugate
under the corresponding hyperelliptic involution. Note in particular
that every stable curve of genus 3 consisting of two elliptic curves
meeting at two points is hyperelliptic.
Exercise (3.163) Let H ⊂Mg be the locus of hyperelliptic curves,
and H its closure in Mg. Find the irreducible components of H \ H
having codimension 1 in H. Are these all the irreducible components
of H \ H?

186
3. Techniques
Exercise (3.164) Which stable curves of the following types are trig-
onal?
1) Curves C consisting of two smooth irreducible components C1 and
C2 meeting at a single point p.
2) Curves C consisting consisting of two smooth irreducible compo-
nents C1 and C2 meeting at a two points p and q.
A ﬁnal remark: since, in the deﬁnition of admissible cover, we never
allow two of the smooth branch points to come together, or any one
of them to approach a singular point, the deﬁnition and construction
work just as well to compactify the space of covers of a curve B of
arbitrary genus, with arbitrarily speciﬁed branching over b distinct
points p1, . . . , pb. Precisely, for any degree d, pair of genera h and g,
and collection σ1, . . . , σb of conjugacy classes in the symmetric group
Sd, we deﬁne a pseudo-admissible cover with branching (σ1, . . . , σb)
to be a stable b-pointed curve (B; p1, . . . , pb), a nodal curve C, and a
regular map π : C ✲B such that:
1) π−1(Bns) = Cns; the monodromy of the map π around the point
pi is in the conjugacy class σi over the points pi; and π is unram-
iﬁed over Cns \ {p1, . . . , pb}; and
2) π−1(Bsing) = Csing, and over a neighborhood of each node q of
B the map π is as described in the original deﬁnition (3.149) of
admissible cover
The same argument as may be given for Theorem (3.150) shows
simultaneously that there exists a coarse moduli space H d,g for
pseudo-admissible covers with given branching, and that this mod-
uli space satisﬁes the conditions of (3.144). An example of the use
of these covers (and their moduli) will be given in the proof of Diaz’
theorem in Section 6.B.
H
The hyperelliptic locus in M3
completed
To conclude this chapter, let’s return to the problem of ﬁnding the
class of the divisor H in the moduli space Mg (or, equivalently, the
class of the associated divisor class h ∈Picfun(M3)

Q) and see how
the description via admissible covers of the closure of the locus of
hyperelliptic curves in M3 helps us to complete the calculation.
Consider the family in Exercise (3.136) obtained by attaching a ﬁxed
(general) elliptic curve E to a ﬁxed (general) curve D of genus 2 at a
variable point q ∈D. We would like to know the degree of the divisor

H. The hyperelliptic locus in M3 completed
187
h on this family, and clearly the place to start is to identify which
ﬁbers of this family belong to the closure H of H ⊂M3.
The
theory
of
admissible
covers
answers
this
readily.
Let
Cq = D ∪E/p ∼q be the ﬁber of our family over q ∈D. By what
we’ve said, [Cq] will lie in H if and only if there exists an admissible
cover π : C ✲B whose domain curve C is a nodal curve stably equiv-
alent to Cq; and we ask when this is the case. To answer this, observe
that if C is such a curve, C will have components isomorphic to D
and E, and that the map π will necessarily have degree 2 on each of
them. They will thus comprise the inverse images of two components
B1 and B2 of B. Next, note that if either D or E is unramiﬁed over a
node r of B, then in the stable model of C the two points of D or E
lying over r will be identiﬁed either to each other or to points of E or
D respectively — in either case a contradiction. It follows in particular
that the points p ∈E and q ∈D are ramiﬁcation points of the map π.
Of course, this imposes no restriction on p ∈E — it simply says that
the map π restricted to E is the map associated to the linear series
|2p| — but it does imply that q must be a Weierstrass point of D. Con-
versely, if q is a Weierstrass point of D, the two maps of D and E to
P1 associated to the pencils |2q| and |2p| together give an admissible
cover Cq ✲P1 ∪P1. We conclude, therefore, that the point [Cq] will
lie in the closure of H if and only if q is a Weierstrass point of D.
The next issue is whether the intersection of our curve D ⊂Mg with
the divisor H is transverse or not. We can deal with this in two ways.
One is to answer it directly, as follows. Since the curves of the form
{Cq}q∈D give a ﬁbration of an open subset of the boundary ∆1 ⊂M3,
the intersection of a general such curve with H will be transverse if
and only if the intersection of H with ∆1 is. But the divisor H will
restrict to a multiple divisor on ∆1 only if the tangent space to H
at a general point of H ∩∆1 is equal to the tangent space to ∆1 —
in other words, if there are no families of admissible covers Ct ✲B
with [C0] ∈∆1 and total space C smooth. However, we can write
down such a family readily. To start, take one of the admissible covers
Cq ✲P1 ∪P1 described above, let x and y be local coordinates on B
near r, and let u and v be local coordinates on Cq at the two identiﬁed
points p and q respectively satisfying
xy = uv = 0 ,
x = u2
and
y = v2 .
Then take the deformations of B and Cq given locally by xy −t2 and
uv −t.
We therefore conclude that the degree of the divisor h on our curve
D is
degD(h) = 6.

188
3. Techniques
Since we know that degD(λ) = degD(δ0) = 0 while degD(δ1) = −2, we
may plug into the general relation
H = a · λ + b · δ0 + c · δ1
to conclude that c = −3. Putting this together with the results of
Section F, we arrive at the formula
h = 9λ −δ0 −3δ1.
Translating this into the Chow group of cycles on the moduli space
M3 using Proposition (3.92) and Proposition (3.93), we deduce that
(3.165)
[H] = 18λ −2δ0 −3δ1.
We said above that there were two ways to get around the problem
of the transversality of intersection of a curve in M3 with the divisor
h. The second, which we should mention here if only as a check of
the last equality, is simply to use a different family. For this purpose,
we’ll look at the third family introduced in the previous section: the
family of stable curves obtained by attaching to a ﬁxed general curve
D of genus 2 a pencil {Et} of plane cubics by identifying a base point
of the pencil with a ﬁxed general point q ∈D.
As before, we ﬁrst ask which of the curves Ct in this family are
hyperelliptic. The answer when Et is smooth is already known: since
q ∈D is general, and in particular not a Weierstrass point of D, these
curves will never be hyperelliptic. On the other hand, the same argu-
ment as above can be used to show that the curves corresponding to
singular Et — that is, curves obtained by attaching to D an irreducible
nodal cubic — are never hyperelliptic either: as before, any admissible
cover C ✲B from a curve stably equivalent to Ct would have to have
degree 2 on the components corresponding to the two components
of Ct, and so would have to be ramiﬁed at q ∈D. Thus, this family
is disjoint from H, and in particular degP1(h) = 0. Plugging this in
yields the relation
0 = a + 12b −c
and once more we can combine this with our previous calculations to
recover (3.165).
You can test your mastery of these calculations with the following
exercises. For the ﬁrst, Exercise (3.166), which involves virtually all
of the concepts introduced in this Chapter, an answer key has been
provided in Table (3.167) so you can check your results. (You will need
to recall that for a rational divisor class γ on the moduli stack and a
one-parameter family ρ : X ✲B of curves whose general member is
stable, by the degree of γ on B we mean the degree of γ on any family
ρ′ : X′ ✲B′ obtained from ρ : X ✲B by semistable reduction, divided
by the degree of the base change morphism B′ ✲B involved.)

H. The hyperelliptic locus in M3 completed
189
Exercise (3.166) Find the degrees of the classes λ, δ0, δ1, κ and h on
the following one-parameter families of curves of genus 3, and verify
in each case the two relations 12λ = δ0 +δ1 +κ and h = 9λ−δ0 −3δ1
found above among these classes.
1) a
general
pencil
of
plane
quartics
including
a
cuspidal
curve; that is, the family of curves {Ct} given by polynomials
F(X, t) = t0G(X) + t1H(X) for G a general quartic and H a general
quartic with a cusp;
2) a general pencil of plane quartics including a tacnodal curve;
3) a general pencil of plane quartics including a couble conic; and
4) a general pencil of plane sections of a general quartic surface
S ⊂P3.
pencil #1
pencil #2
pencil #3
pencil #4
deg(λ)
2 5
6
2 3
4
3
2
4
deg(δ0)
25
24 1
2
13
36
deg(δ1)
1
6
0
0
0
deg(κ)
8 5
6
8 1
2
5
12
deg(h)
0
1
4
1
2
0
Table (3.167)
For a further discussion of the moduli of stable hyperelliptic curves
(that is, the closure in Mg of the locus of smooth hyperelliptic curves),
see Section 6.C.
Here are some further exercises involving calculations of divisor
classes in Mg:
Exercise (3.168) Find the class of the closure in M5 of the locus of
smooth trigonal curves.
Exercise (3.169) In terms of the generators λ, ω and σi of the Picard
group of C3 as described on page 62, ﬁnd the class of the closure of
the locus of pairs (C, p) where C is a smooth curve of genus 3 and p is
a Weierstrass point of C. For extra credit: what is the branch divisor of
this locus over M3, and what does this have to do with the calculations
in this subsection and in Exercise (3.170)?
Exercise (3.170) Find the class of the closure in M3 of the locus of
smooth plane quartics C with a hyperﬂex, that is, a point whose tan-

190
3. Techniques
gent line has contact of order 4 with C (equivalently, smooth curves
C of genus 3 possessing a point p ∈C such that OC(4p) ≊KC).
Exercise (3.171) Find the class of the closure in M4 of the locus of
smooth curves C possessing only one g1
3 (equivalently, smooth curves
C of genus 4 whose canonical models lie on singular quadrics).
The calculation of the classes of certain divisors in Mg will be the
main ingredient in the proof, in Section 6.F, that Mg is of general type
for large g. In particular, the calculation carried out there subsumes
(almost) Exercise (3.168). If you’re interested, Exercises (3.169), (3.170)
and (3.171) are generalized there, in Exercises (6.75), (6.76) and (6.78)
respectively.

Chapter 4
Construction of Mg
This chapter is organized as follows. We review just enough of the ba-
sic notions of geometric invariant theory (G.I.T.) to indicate how it can
be used to construct moduli of projective varieties: if you have some
familiarity with G.I.T. you can safely skip this section. Then, we give
a fairly complete discussion of the Hilbert-Mumford numerical crite-
rion for the stability of Hilbert points, of Gieseker’s criterion (which
implies this numerical one), and of how it can be used to prove the sta-
bility of Hilbert points of smooth curves embedded by complete linear
series of large degree. We omit only some arithmetic calculations.
At this point, we could but do not construct Mg as a coarse mod-
uli space. Instead, we outline what else must be proved in order to
construct the compactiﬁcation Mg in the approach of Gieseker and
Mumford. The heart of the construction is the Potential Stability The-
orem. We ﬁrst try to motivate this result by showing how it leads to
a construction of Mg from which many basic geometric properties
follow as easy corollaries. In fact, a complete proof of the Potential
Stability Theorem would be too lengthy to include here so we have
instead tried to indicate the main line of the argument leaving many
technical lemmas and veriﬁcations to you in the exercises. Finally, we
deduce the consequences of the theorem that are needed to construct
Mg as a coarse moduli space.
One important feature of the G.I.T. approach is that it’s the only
one that can be carried out in all characteristics (and even over more
general base rings than ﬁelds). Therefore, while we will continue to
work over C, we’ll deviate from the general approach of this book
and make occasional remarks about how the complex case extends to
positive characteristic.

192
4. Construction of Mg
A
Background on geometric invariant
theory
The G.I.T. strategy
Geometric invariant theory is a technique for forming quotient spaces
in algebraic geometry that provides a fundamental method for the
construction of moduli spaces of projective varieties. In this subsec-
tion, we’ll recall the basic facts on which this method is based and
outline the steps involved in verifying these. The remainder of this
chapter deals with the details of carrying out this program for alge-
braic curves.
To begin with, let’s review the basic problem, ﬁxing the complex
numbers as the ground ﬁeld and taking a very naive point of view.
We are given a set M of isomorphism classes of (complex) varieties
— think of smooth curves of genus g. Our ﬁrst task is to ﬁnd a
scheme structure on this set that is natural in the sense that given any
ﬂat proper family π : C ✲B whose ﬁbers are in M, the natural set-
theoretic moduli map ϕ below is actually a morphism of schemes.1
(4.1)
C
B
π
❄
ϕ ✲M
You should pause for a moment to reﬂect on how audacious an as-
piration this really is by considering how hopeless it is in almost any
other mathematical setting.
Next, we want to be able to work with fairly general complete fam-
ilies B and to be able to apply projective methods to the study of M
itself. To do this, we need to ﬁnd a set of varieties M containing M
on which we can construct a natural projective scheme structure with
respect to which M is a dense open subscheme. No matter how nice
the varieties in M itself are, any such M is almost certain to contain
singular elements. A simple example in genus 1 (easily generalized to
any genus) is the family of curves
(4.2)
y2z = x(x −tz)(x −z) .
1More properly, we should (as we did in Chapter 1 but here will not) ask for a
scheme structure that makes M into a coarse moduli space for the associated moduli
functor.

A. Background on geometric invariant theory
193
The curves Ct are, for small nonzero t, nonisomorphic smooth curves
of genus 1. The special ﬁber C0 is a nodal rational cubic curve. But, this
family is its own semistable reduction so there is no hope of ﬁlling in
the family with a smooth special ﬁber. On the other hand, recall the
family (2.11) of plane cubics
y2z = x3 −t2axz2 −t3bz3
discussed in Section 2.C. For t ≠0, the curves Ct are all isomor-
phic to the smooth elliptic curve C1 while the curve C0 with equa-
tion y2z = x3 is rational and has a cusp at (0, 0, 1). No reasonable
algebraic structure on the set of isomorphism classes of plane cubics
can coexist with a set-theoretic map that has one value for nonzero
t and another for t = 0. This example shows that there are some de-
generations that simply cannot be allowed into M if we want a good
scheme structure: let’s call these, informally, bad degenerations. We
thus face a subtle second problem, that of determining an M that is
large enough to complete M but small enough not to contain any bad
elements.
To summarize, we have two basic problems:
Problem 1: Determine the set of “good” degenerations that can be al-
lowed into M.
Problem 2: Construct natural scheme structures on M and M.
Geometric invariant theory (henceforth G.I.T.) provides a two-step
strategy for answering both of these problems simultaneously.
Step 1: Parameterize the elements of a class M′ plus some extra struc-
ture by the points of a projective subvariety K of P(W), where
W is a linear representation of a reductive group G, so that the
set of points of K parameterizing the extra structures on a ﬁxed
element C of M′ forms a single G orbit in K.
Step 2: Form a quotient K/G of K by the action of G.
Before going any further, we want to make a few simplifying re-
marks. The ﬁrst is that, in our applications, G will always be the spe-
cial linear group SL(V) of another vector space V and W will always be
a representation constructed out of the basic representation V of G by
multilinear algebra. In particular, the G-orbit of a point of P(W) will
always parameterize different choices of a system of homogeneous
coordinates on P(V).2 We assume this henceforth. We also adopt the
2Most of what we have to say about G.I.T. applies in more general situations in
which G is any reductive algebraic group that doesn’t map onto Gm and K is any

194
4. Construction of Mg
convention that, if x is a nonzero point of a representation W, then
[x] denotes the corresponding point of P(W). Conversely, if [x] is a
point of P(W), then x denotes any lift to W and we’ll often ascribe a
property to [x] — especially, stability — by reference to a property of
a lift x that doesn’t depend on which lift is chosen.
We’re now ready to make a few comments about the G.I.T. strat-
egy. The ﬁrst step may seem to be merely a more difﬁcult version of
Problem 2 since constructing the parameter space K involves ﬁnding
a natural scheme structure on the set of classes of “elements of M′
plus extra structure”. In particular, the space K must have universal
properties at least as strong as any we wish its quotient M to enjoy. In
practice, adding a suitable extra structure often makes things much
easier. The parameter spaces discussed in Chapter 1 illustrate this
principle.
For example, the Hilbert scheme H = Hd,g,r parameterizes “curves
of arithmetic genus g plus a very ample linear system of degree d
and r + 1 sections” or equivalently “subcurves of Pr of degree d and
arithmetic genus g”. If we let V = Cr+1, the group G = SL(V) acts on
H and a G-orbit consists of all elements of H corresponding to the
same curve and linear system. Moreover, the Hilbert scheme is even
a ﬁne parameter space so has better universal properties than we’re
asking of our moduli spaces. In this example, there are many choices
for the underlying representation W corresponding to the choice of
large degree m used in the construction of H in Section 1.B. For a ﬁxed
m, W is the Pl¨ucker space ΛP(m)Symm(V ∨) of the Grassmannian of
quotients of Symm(V ∨) having with dimension p(m) = dm −g + 1.
We will eventually construct the spaces Mg and Mg by carrying
out Step 2 using the subschemes 
K of H which were used in Sec-
tion 3.B to produce universal deformations of stable curves: recall that
these parameterize “n-canonically embedded stable curves of arith-
metic genus g plus a basis of H0(C, ω⊗n
C )”. In essence, then Step 1
amounts to getting a start on the moduli problem 2 by solving a re-
lated but easier problem.
Finite generation of and separation by invariants
To take advantage of this simpliﬁcation, we must form the quotient
in Step 2 and it’s here that the real difﬁculties in the G.I.T. approach
surface. The basic idea, however, is very simple. If X = Spec(R) is a G-
invariant afﬁne subscheme of K and RG is the subring of G-invariant
scheme on which G acts rationally, but to extend the conclusions we need requires
the introduction of a number of technical concepts and considerable effort. If you’re
interested, you should consult Chapters 1–3 of [50].

A. Background on geometric invariant theory
195
elements of R, deﬁne X/G = Spec(RG). Then the restriction of the
quotient map q to X should be the rational map X
✲X/G dual to
the inclusion of rings RG✲✲R. We then patch these local character-
izations together to the statement that if C[K] is the homogeneous
coordinate ring of K in P(W) and C[K]G is the subring of homoge-
neous G-invariants, then K/G = Proj(C[K]G).3 In other words, the
quotient map q : K
✲K/G is given by taking the values of homo-
geneous invariant polynomials on K.
The ﬁrst question we have to resolve is whether these deﬁnitions
make sense: the implicit assertion that C[K]G is noetherian requires
justiﬁcation since it’s only a sub-ring of C[K]. This and related ques-
tions are known as “Hilbert’s 14th problem”. We won’t enter into this
here except to remark that the ﬁnite generation for every K is equiv-
alent to the reductivity of G: see Appendix A to [50]. There is even
an explicit characteristic p counterexample due to Nagata [123] with
G = Z/pZ. In other words, we must ﬁrst check that there aren’t too
many invariants. This is the beautiful:
Theorem (4.3) (Hilbert-Weyl-Haboush) If a reductive algebraic
group G acts rationally on a noetherian ring R, then RG is ﬁnitely gen-
erated.
The hypothesis of rationality means that for any f
∈
R,
span{g·f |g ∈G} is ﬁnite-dimensional. This is automatic if the action
is algebraic. Using it and the fact that any ﬁnite-dimensional represen-
tation of G is completely reducible, it’s easy to construct a canonical
C-linear projection ρ : C[X] ✲C[X]G called the Reynolds operator.
The key property of this operator is expressed in the second part of
the next exercise.
Exercise (4.4) 1) Verify the existence of the Reynolds operator as-
serted above. More precisely, suppose that G is a linearly reductive
3If you’re familiar with G.I.T. you’ll notice that we haven’t introduced the notion of
a linearization of the G-action on K needed to underpin such a patching argument.
This omission is a deliberate one aimed at simplifying our treatment if you’re seeing
G.I.T. for the ﬁrst time. If you want to see a discussion of the issues we’re glossing
over you can refer to Chapter 1, Section 3 of [50]. If you’re familiar with linearizations
you’ll recognize that our omission is harmless in all the examples that will concern
us here. These will always begin with the canonical linear action of G = SL(V) on V,
pass to the induced G-action on a G-representation W functorially constructed from
V by multilinear algebra and ﬁnally descend to the induced G-action on P(W). In this
situation, there is a canonical choice of an ample line bundle — OP(W)(1) — and of
a G-linearization with respect to this bundle. Moreover, with these canonical choices
stability of a point [x] of P(W) is equivalent to the stability of any lift x of [x] to
W. Likewise, when we consider the problem of quotienting a scheme K, we’ll always
be dealing with a G-invariant subscheme of a P(W) constructed as above. Hence, the
afﬁne linear point of view we use amounts to a simplifying abuse of language.

196
4. Construction of Mg
group (i.e., every ﬁnite-dimensional linear representation V of G de-
composes canonically as a direct sum of irreducible representations)
and that R is a vector space — possibly inﬁnite-dimensional — on
which G acts rationally and show that there is a canonical G-linear
projection ρ : C[X] ✲C[X]G.
2) Show that if R is both a noetherian ring and an S-algebra and
ϕ : R ✲S is a surjective S-module homomorphism, then S is noethe-
rian. Then prove, or simply apply, the following lemma and deduce
Theorem (4.3).
Lemma (4.5) (Reynolds Lemma)
The map ρ : C[X] ✲C[X]G is a
C[X]G-module homomorphism; that is, if f ∈C[X]G and h ∈C[X],
then ρ(f h) = f ρ(h).
Hilbert’s proof of this theorem (for G = SL(n, C)), now translated
into English in [86], marked the ﬁrst nonconstructive use of the Hilbert
basis theorem. Previous work had focused on calculating explicit ﬁnite
bases of invariants in speciﬁc examples. The high point of this line of
study was Gordan’s proof of the ﬁnite generation of the invariants of
SL(2, C) acting on symmetric powers of C2. The length and complexity
of this calculation should be remarked since it shows the necessity of
ﬁnding some way of studying the quotient map without calculating
explicit invariants. The proof sketched above is essentially due to Weyl
[151].
In positive characteristic, reductive groups no longer act completely
reducibly. (The simplest example, when char(k) = 2, is the action
of SL(2, k) on the space of 2 × 2 matrices over k, where the invari-
ant line of scalar matrices has no invariant complement. Equivalently,
there is no nontrivial linear invariant: in characteristic 0, this would
be the trace which is identically 0 in this example.) Nonetheless, with
somewhat more work, the conclusion that their rings of invariants are
ﬁnitely generated can be extended to all characteristics. A group G is
called geometrically reductive if for any representation of G, there is a
nonconstant invariant homogeneous polynomial not identically 0 on
the invariant subspace. (In the example above, the determinant is a
suitable quadratic invariant.) Nagata [124] showed that this hypothe-
sis could be used as a substitute for complete reducibility in proving
the ﬁnite generation of rings of invariants and Haboush [69] proved
that reductive groups in positive characteristics are geometrically re-
ductive.
The next step in carrying out the G.I.T. program is to see that there
aren’t too few invariants. The next theorem states, in effect, that there
are as many invariants as permitted by the obvious restriction that an
invariant is constant on the closure of any G-orbit.

A. Background on geometric invariant theory
197
Theorem (4.6) (Hilbert-Nagata) If G is geometrically reductive
and W is a representation of G, then values of homogeneous invari-
ant polynomials separate disjoint closed G-invariant subsets of P(W).
In characteristic 0, this may be seen as follows. Suppose that X and
Y are disjoint G-invariant subsets with ideals I and J respectively.
Then, we can write 1 = f + g for some f ∈I and g ∈J. Applying the
Reynolds operator to this equation, we ﬁnd that
1 = ρ(1) = ρ(f + g) = ρ(f) + ρ(g).
Since I and J are G-stable, ρ(f ) ∈IG and ρ(g) ∈JG. Thus, ρ(f) is an
invariant that is 0 on X and 1 on Y as required. An alternate proof is
provided by the following exercise.
Exercise (4.7) (in char 0)4 Show that if Y is a closed G-invariant sub-
variety of V there is a G-equivariant polynomial map from V to a
representation V ′ of G such that Y is the inverse image of the origin
in V ′. Use this to deduce:
Corollary (4.8) The quotient map q : P(W)
✲P(W)/G has base
locus exactly the set of points [x] ∈P(W) such that, for any (or equiv-
alently, every) nonzero lifting x of [x] to W, the origin 0 of W lies in
the closure G · x of the G-orbit of x.
This also follows by standard arguments from the theorem as out-
lined in Exercise (4.10) below.
Deﬁnition (4.9) The base locus of q is called the nonsemistable locus
of P(W) and is denoted P(W)n and its complement P(W)ss is called
the semistable locus: thus, [x] is semistable if 0 is not contained in the
closure of G · x. A point [x] is called stable if the orbit G · x of any
lifting is closed and if the stabilizer stabG(x) is of minimal dimension
amongst all stabilizers of points in P(W). The locus of such points is
called the stable locus and is denoted P(W)s.
In all the examples we’ll consider (Exercise (4.12) excepted), the min-
imal dimension of a stabilizer will be 0. To simplify language, we as-
sume henceforth that any K ⊂P(W) we consider contains points
with ﬁnite stabilizers. Therefore, a point will be stable if the orbits of
its liftings are closed and stabG(x) is ﬁnite. Given a subvariety K of
P(W), we deﬁne analogous loci in K by restricting to K from P(W).5
4For extra credit, prove this in characteristic p also. A proof in this case may be
found in [49] or in Appendix A to [50].
5All these properties have intrinsic analogues deﬁned using only the G-action on
K and not referring to a lift to W, but these yield exactly the same semistable and
stable loci.

198
4. Construction of Mg
Exercise (4.10) This exercise characterizes semistable and stable
points of P(W) in terms of the values of homogeneous invariant poly-
nomials.
1) Show that if [x] lies in Kss, then there is a homogeneous G-
invariant polynomial f that does not vanish at [x]. Hint: Take
X = G · x and Y = {0}.
2) Show that if [x] lies in Kss and [y] doesn’t lie in the closure of
G · [x], then there is a homogeneous G-invariant polynomial f that
vanishes at [y] but not at [x]. Hint: Take Y to be the cone over G · y.
3) Show that the polynomials f in the preceding parts may be chosen
to have degree bounded by a constant independent of the choice of
[x] and [y].
Corollary (4.11)
1) Two points [x] and [y] in Ks lie in the same
G-orbit if and only if q([x]) = q([y]).
2) If [x] and [y] are in Kss, then q([x]) = q([y]) if and only if
G · x ∩G · y ∩Kss ≠∅.
Warnings. Two are in order here:
1) The standard term for the nonsemistable locus is the unstable lo-
cus. This choice is very unfortunate since the complement of this lo-
cus is not the stable locus but the semistable locus, as we remark
above. The exercise below shows that the distinction is a real one; i.e.,
there are often points that are semistable but not stable. Such points
are generally called strictly semistable. The standard terminology goes
back to Mumford’s foundational work [50]. We ask your indulgence of
our doubtless quixotic attempt to rationalize custom.
2) There is no a priori connection between the notions of stable and
semistable point introduced above and the notion of moduli stable
or semistable curve. The main theorems of this chapter will show
that nonetheless there is a very close connection between the PGL(V)-
stability in this sense of the Hilbert points of suitable models of a
curve C in P(V) and the moduli stability of the underlying abstract
curve C. When necessary to avoid confusion, we’ll refer to the abstract
concepts deﬁned in Chapter 2 as moduli stability and semistability.
Exercise (4.12) This exercise treats the action of SL(n, C) on the
space Mn×n(C) by conjugation, with orbits the similarity classes of
n × n complex matrices. It provides a rare case in which the ring of
invariants can be explicitly computed. This is the one exception to our
working assumption that points with ﬁnite stabilizers exist.
1) Show that the closure of the similarity class corresponding to a
ﬁxed Jordan normal form contains the diagonalizable similarity class

A. Background on geometric invariant theory
199
with the same characteristic polynomial. Determine the closure of
each similarity class.
2) Show that any homogeneous invariant polynomial is constant on
the set of matrices with given characteristic polynomial.
3) Show that the coefﬁcients of the characteristic polynomial (viewed
as homogeneous polynomial functions on Mn×n(C)) generate the ring
of invariants C[Mn×n(C)]SL(n,C) and that these invariants are alge-
braically independent. In other words, the quotient map q in this case
maps a matrix to its characteristic polynomial.
4) Determine the stable and unstable loci in Mn×n(C).
Exercise (4.13) Show that if x is a semistable point whose orbit isn’t
closed then the closure of the orbit G·x of x contains a unique closed
orbit G · y and that dim stabG(y) > dim stabG(x).
The numerical criterion
The corollaries above show that we can only hope to have a quotient
whose closed points correspond to orbits in K (and hence to isomor-
phism classes in M′) beneath the stable locus in K. This, however,
should be viewed as one of the key beneﬁts of the G.I.T. approach.
The theory simultaneously identiﬁes those bad varieties that must be
excluded to have a separated moduli space (these are identiﬁed as the
ones whose Hilbert points are nonsemistable), while it constructs the
scheme structure on the set of good or stable varieties. The funda-
mental problem of constructing moduli in this approach is then to
determine the stable locus in the appropriate Hilbert schemes. For
emphasis, we repeat that, Exercise (4.12) above notwithstanding, it’s
essentially never possible to determine the stable locus by explicit
calculations with invariants or by directly determining which orbits
in P(W) are closed. This difﬁculty prevented much use being made
of G.I.T. for constructing moduli until Mumford found a means of cir-
cumventing it.
To see how Mumford’s idea works, let’s ask in what, if any, spe-
cial cases it’s easy to determine the stable and semistable loci. The
answer is: when G = Gm, or in our naive setting when G = C∗.6 As
remarked above, we can and will forget about K for the purposes of
this analysis. The decomposition
(4.14)
C[C∗] = C[t, t−1] =
%
i∈Z
Cti
6This is the one point at which we need to think about representations W of a
reductive group G that don’t fall into the special case where G = SL(V) and W is
derived from V by multilinear algebra.

200
4. Construction of Mg
shows that the characters of C∗— since C∗is abelian, all its irre-
ducible representations are one-dimensional — correspond bijectively
with the integers. Since C∗acts completely reducibly,7 we can decom-
pose any ﬁnite-dimensional representation λ : C∗✲GL(W) of C∗as
(4.15)
W =
%
i∈Sλ(W)
Wi
where Wi is the set of vectors w ∈W on which the element t of C∗
acts by the rule λ(t)·w = ti ·w and Sλ(W) is the ﬁnite set of integers
for which Wi is nonzero.
Deﬁnition (4.16) We call the set Sλ(W) the λ-state of the represen-
tation W, the elements i of Sλ(W) the λ-weights of W and the space
Wi the ith λ-weight space of W. If x is any element of W, we deﬁne the
λ-state Sλ(x) of x to be the set of i in Sλ(W) for which the component
xi of x in the subspace Wi is nonzero, call the elements of Sλ(x) the
λ-weights of x and deﬁne
µλ(x) = min(Sλ(x)) .
These invariants are also deﬁned for points [x] of P(W) by our usual
convention of using their common value on any lifting x of [x].
More naively, this amounts to using the fact that λ(C∗) is an abelian
subgroup of GL(W) to choose a basis B = {b1, . . . , bN} of W with
respect to which, for each t ∈C∗, λ(t) acts on W by the diagonal
matrix diag(tw1, . . . , twN). The space Wi is then just the span of those
bj for which wj = i, so Sλ(W) is the set of distinct wj’s and Sλ(x) is
the set of distinct wj’s for which the jth coordinate of x in the basis
B is nonzero.
The point of these deﬁnitions is that, since
λ(t) · x =

i∈Sλ(x)
ti · xi,
we have the equivalences
µλ(x) ≥0 ⇐⇒lim
t ✲0 λ(t) · x exists ⇐⇒x is not stable; and
µλ(x) > 0 ⇐⇒lim
t ✲0 λ(t) · x = 0 ⇐⇒x is not semistable.
The two left equivalences are clear. The limit in the middle condi-
tion on the ﬁrst line is either x itself (in which case all of λ(C∗) lies in
7For once, the analogous statement is also true in characteristic p.

A. Background on geometric invariant theory
201
the stabilizer of x, which therefore has positive dimension) or a point
of the closure of the λ-orbit of x not lying in that orbit. These possi-
bilities correspond exactly to the two ways in which x can fail to be
stable for the λ-action of C∗. The right equivalences on the second line
are an even more direct translation of the deﬁnition of nonsemista-
bility to our special case. Our conventions immediately give the same
equivalences for the (semistability) of [x] as well.
Mumford’s idea (building on some examples due to Hilbert) was
that this easy case is actually the general one. Any algebraic group
homomorphism λ : C∗✲G is called a one-parameter subgroup (often
abbreviated one-parameter subgroup) of G and λ is called nontrivial
if its image is. We have the:
Theorem (4.17) (Hilbert-Mumford numerical criterion)
1) [x] is G-nonsemistable ⇐⇒For some one-parameter subgroup λ
of G, µλ([x]) > 0.
2) [x] is G-semistable ⇐⇒For every one-parameter subgroup λ of
G, µλ([x]) ≤0.
3) [x] is G-nonstable ⇐⇒For some nontrivial one-parameter sub-
group λ of G, µλ([x]) ≥0.
4) [x] is G-stable ⇐⇒For every nontrivial one-parameter subgroup
λ of G, µλ([x]) < 0.
This criterion is often rephrased as the statement that [x] is stable
[resp: semistable] if and only if every nontrivial one-parameter sub-
group of G acts on it with negative [resp: nonpositive] weight(s). Since
the weights of the one-parameter subgroup λ−1 (obtained by element-
wise inversion of the image of λ) are minus those of λ, the criterion can
also be stated more symmetrically as: [x] is stable [resp: semistable]
if and only if every nontrivial one-parameter subgroup of G acts on it
with both positive and negative [resp: nonnegative and nonpositive]
weight(s). This form best illustrates the motivation for using the term
stable point.
If the orbit G · x isn’t closed, then it’s possible to ﬁnd a disc ∆in
P(V) such that ∆∗⊂G·x but ∆̸⊂G·x i.e., such that 0 lies in G · x but
not in G · x. The content of the criterion is that we can actually make
this disc the image of the unit circle in a one-parameter subgroup of G
under the map g ✲g·x. This, in turn, comes down to showing that any
morphism of ∆∗into G can be taken to a one-parameter subgroup by
pre- and post-multiplying by suitable regular maps of ∆∗into SL(V).
Proving this would take us too far aﬁeld, so we refer to [93], which
also contains a beautiful quantitative study of the invariants µλ, for
further details.

202
4. Construction of Mg
Stability of plane curves
We’re now ready to carry out the G.I.T. program in the simple case
when M = M1, the set of smooth curves of genus 1. Our treatment of
this example goes back to Hilbert. The ﬁrst step of setting up the pa-
rameter space K is immediate. The vector space K = P(Sym3(C3)∨)
of homogeneous plane cubic curves parameterizes curves of arith-
metic genus 1 and degree 3 in P2(C). If C is a curve of genus 1, then
C has a one-parameter family of g2
3’s, but these all yield projectively
equivalent plane cubics. Thus the open subset K−∆of K obtained by
removing the discriminant hypersurface ∆(the locus of singular cubic
curves) parameterizes smooth curves of genus 1 plus a choice of ho-
mogeneous coordinates on P2. The basic vector space here is V = C3,
the group G is thus SL(3), and the representation W is Sym3(C3)∨.
(d, 0, 0)
(d −1, 1, 0)
(d −1, 0, 1)
negative
λ-weight
ai + bj + ck < 0
zero
λ-weight
ai + bj + ck = 0
positive
λ-weight
ai + bj + ck > 0
β
d
3 , d
3 , d
3

(1, d −1, 0)
(1, 0, d −1)
(0, d, 0)
(0, 0, d)
(0, d −1, 1)
(0, 1, d −1)
Lλ
Figure (4.18)
Let’s generalize for a moment to plane curves of arbitrary degree d.
If we ﬁx a one-parameter subgroup λ : C∗✲SL(3), then there are
homogeneous coordinates x, y and z on C3 with respect to which
λ(t) = diag(ta, tb, tc)
with a + b + c = 0 since det(λ(t)) = 1. The basis B of Symd(C3)∨
consisting of monomials of degree d in x, y and z also diagonalizes
the action of λ:
λ(t) · xiyjzk = t(ai+bj+ck)xiyjzk.

A. Background on geometric invariant theory
203
If
f (x, y, z) =

i+j+k=d
cijkxiyjzk = 0
is the equation of a curve C of degree d (i.e., f is the point of
Symd(C3)∨determined by C), then the B-coordinates of f are just
its coefﬁcients and the λ-state Sλ(f) is simply the set of monomials
whose coefﬁcients in f are nonzero.
This setup can be represented in planar barycentric coordinates
i + j + k = d
by points of a plane triangle as shown in Figure (4.18). By linearity, we
may speak of the weight of any point in this real plane and then the
line Lλ with equation ai + bj + ck = 0 describes the locus of points
of λ-weight 0. The numerical criterion can immediately be translated
in these terms as follows. The curve C is λ-stable if and only if some
monomial lying strictly on the negative side of the line Lλ appears
with nonzero coefﬁcient in the equation f; C is λ-semistable if and
only if some monomial lying on or to the negative side of this line has
nonzero coefﬁcient.
Now we return to the case of cubics. If we ﬁx (a, b, c) = (−5, 1, 4)
then we get the picture shown in Figure (4.19). We can now analyze
(3, 0, 0)
(2, 1, 0)
(2, 0, 1)
(1, 2, 0)
(1, 0, 2)
(1, 1, 1)
(0, 3, 0)
(0, 0, 3)
(0, 2, 1)
(0, 1, 2)
Lλ
−5i + j + 4k = 0
Figure (4.19)
what λ-stability means geometrically by supposing that successively
greater numbers of the coefﬁcients cijk of the equation f lying in the
negative weight half-plane vanish ordering the coefﬁcients by their
distance from Lλ or equivalently by minus their λ-weights. At each

204
4. Construction of Mg
stage, the equation f becomes more special and this is reﬂected in
the increasingly singular character of the point P = (1, 0, 0) on C.
In the summary below, we use an * to indicate a general nonzero
form and ⟨⟩’s to indicate a general element of an ideal.
c300 = 0:
f = ⟨y, z⟩, so P lies in C.
c210 = 0:
f = ∗x2z + ⟨y, z⟩2, so z = 0 is tangent to C at P.
c201 = 0:
f = ⟨y, z⟩2, so P is a double point of C.
c120 = 0:
f = ∗yz + ∗z2 + ⟨y, z⟩3, so z = 0 is tangent to a
branch of C at P.
c111 = 0:
f = ∗z2 + ⟨y, z⟩3, so P is a cusp of C with tangent
cone twice the line z = 0.
c102 = 0:
f = ⟨y, z⟩3, so P is a triple point of C.
Comparing this summary with the diagram, we may conclude that:
C is smooth ⇐⇒C is λ-stable; and
C has at worst nodes ⇐⇒C is λ-semistable.
Next, what happens if we vary the weights (a, b, c) = (−5, 1, 4) of
λ and the coordinates (x, y, z) with respect to which it diagonalizes?
Consider varying the weights ﬁrst. This amounts to rotating the line
Lλ around the barycenter (1, 1, 1). Observe that if the set of coefﬁ-
cients of C contained in the open [resp: closed] negative halfspace of
Lλ′ contains that of Lλ then any C that is λ-stable [resp: λ-semistable]
is automatically λ′-stable [resp: λ′-semistable]. Also, if Lλ′ is obtained
from Lλ by a symmetry of the triangle of coefﬁcients, then λ′ is the
one-parameter subgroup with weights (a, b, c) in the ordered basis
obtained by applying the corresponding permutation to (x, y, z). To-
gether these observations imply that to determine the stability of C
with respect to an arbitrary one-parameter subgroup λ′, it sufﬁces to
consider the one-parameter subgroup with the weights of λ in every
ordered basis. Now observe that the conclusions at the end of the
last paragraph are invariant under change of coordinates. Hence, we
conclude that:
C is stable ⇐⇒C is smooth;
C is semistable ⇐⇒C has at worst ordinary double points; and
C is nonsemistable ⇐⇒C has a cusp or worse singularity.
(The third of these conclusions follows by negating both sides of the
second.)

A. Background on geometric invariant theory
205
A few further comments about the respects in which this analysis is
and is not typical are in order. The most typical feature is the very di-
rect connection between the instability of f, “undesirable” geometric
features of C, and the destabilizing one-parameter subgroup λ. Note,
ﬁrst, how these results conﬁrm the intuition from the families dis-
cussed at the start of this section that we must avoid cuspidal cubics
in order to have a nice moduli space but that we must include nodal
cubics if the resulting space is to be complete. Also, note that the re-
ducible cubics with nodes — a conic and a transversal line, or a triangle
— are semistable. This phenomenon is again quite typical. Complete
moduli spaces almost always include reducible varieties. Perhaps, the
most subtle difﬁculty in the construction of Mg is to control such
curves.
Second, note that instability is due to a singularity of C and the
destabilizing one-parameter subgroups are very closely tied to the
character of the singularities: for a cusp, the singular point and its
tangent cone are deﬁned by the vanishing of coordinates that diago-
nalize λ and the weights have the property that the coefﬁcients that
must be nonzero to avoid a worse singularity are of equal λ-weight.
It’s a very general phenomenon that instability of the Hilbert point of
a variety X is “caused” by a bad subscheme of X and that the desta-
bilizing one-parameter subgroup is the one that most clearly “picks
out” the subscheme. (A more precise statement of this principle is the
main result of [93].)
The effect of this phenomenon is that it’s generally very easy to
show that a Hilbert point isn’t stable. To show that such a point is
stable, however, requires handling a general one-parameter subgroup
λ, which may bear no relation to the geometry of X. Such proofs, as
we’ll see, involve using geometric estimates about sublinear series of
the hyperplane bundle on X to obtain combinatorial estimates for
the weights of a general λ. Unfortunately, the combinatorics involved
are often extremely hard and lengthy. They are not even completely
understood for Hilbert points of stable curves embedded by complete
linear systems. This difﬁculty represents the main obstacle to using
G.I.T. to construct moduli for higher-dimensional varieties. Because
our Hilbert scheme is a projective space, this difﬁculty doesn’t arise
here.
What aspects of this example are not typical? First, the ring of in-
variants of this example is one of the few that has been computed ex-
plicitly. It’s generated by two elements A of degree 4 and B of degree 6
that are essentially the coefﬁcients of the Weierstrass normal form of
the cubic. The discriminant is one geometrically meaningful invariant
(since projectivities don’t affect the smoothness of a curve): in fact,
∆= (27A3 −4B2). The classical j-invariant is given by j = A3/∆; it
generates the invariant function ﬁeld and hence gives a rational pa-

206
4. Construction of Mg
rameterization of the quotient M1. If C is a smooth cubic, then ∆(C)
is nonzero and the moduli point of C is determined by its j-invariant.
All three orbits of nodal cubics (corresponding to a rational nodal cu-
bic, a conic and a transverse line, and a triangle) have ∆= 0 but A ≠0,
hence j = ∞. Cubics with cusps or worse (amongst which we also ﬁnd
degenerate cases of the reducible semistable conﬁgurations such as
a conic plus a tangent line) have A = B = 0 and hence undeﬁned
j-invariant.
We should also warn that as d increases, the singularities that can
lie on a stable plane curve of degree d become more and more com-
plex: see the exercises below. The case d = 3 is a convenient accident
that conﬁrms our philosophy. Conversely, certain smooth varieties
are unstable — see [116] for examples.
Exercise (4.20) 1) Analyze the stability of quartic plane curves,
showing that cusps are semistable on quartics.
2) Show that for every µ, there is a degree d(µ) such that ordinary
plane curves of degree d with only ordinary µ-fold points have stable
equations.
3) Use a tetrahedron of coefﬁcients to analyze the stability of cubic
and quartic surfaces in P3. Hint: The answer is given in Section 1
of [121].
Problem (4.21) What cubic and quartic threefolds have stable equa-
tions?
B
Stability of Hilbert points of smooth
curves
In this section, we’ll ﬁrst interpret the numerical criterion for the sta-
bility of Hilbert points of general subvarieties of projective space.
Then, we’ll give several sufﬁcient criteria and see how to combine one
criterion due to Gieseker (4.30) with standard results about curves
(Riemann-Roch and Clifford’s theorem) to deduce the stability of
Hilbert points of smooth curves embedded by complete linear sys-
tems of large degree [Theorem (4.34)].
The numerical criterion for Hilbert points
Our ﬁrst task is to understand the meaning of the numerical crite-
rion for the SL(r + 1)-action on the Hilbert scheme H = HP(m),r of
subschemes of Pr with Hilbert polynomial P(m). To do this, we ﬁx a

B. Stability of Hilbert points of smooth curves
207
one-parameter subgroup λ : C∗✲SL(r + 1) and homogeneous coor-
dinates
B = Bλ = {x0, . . . , xi, . . . , xr }
which we view as a basis of (Cr+1)∨with respect to which
λ(t) = diag (tw0, . . . , twi, . . . , , twr )
with

i wi = 0. The data of λ is thus equivalent to the data of B con-
sidered as a weighted basis (i.e., along with a set of integral weights wi
summing to 0) and we’ll henceforth refer to B and λ interchangeably.
As for plane curves, the basis
Bm =

Y =

i
xmi
i
&&&

i
mi = m

of Symm(Cr+1)∨consisting of monomials of degree m in xi’s also
diagonalizes the action of λ: if we deﬁne the B-weight wY of Y by
wY =

i
wimi ,
then
λ(t) · Y = twY Y.
For the rest of this section, ﬁx a suitably large m and let
W = ΛP(m)
Symm(Cr+1)∨
.
Then the construction of Section 1.B exhibits H as a subscheme of
the Grassmannian G of P(m)-dimensional quotients of Symm(Cr+1)∨,
which in turn lies in P(W). The representation W of SL(r + 1) has a
natural Pl¨ucker basis consisting of all unordered P(m)-element sub-
sets
Z =

Yj1, . . . , YjP(m)
&&& Yjk ∈Bm

of Bm. This basis diagonalizes the action of λ on W: if we set
wZ =

k
wYjk ,
then
λ(t) · Z = twZZ.
The Pl¨ucker coordinate Z is nonzero at the point [Q] of the Grass-
mannian G corresponding to a quotient Q if and only if the images
in Q of the P(m) degree m monomials Yjk in Z form a basis of Q.
Since the Hilbert point [X] of a subscheme of X of Pr with Hilbert
polynomial P(m) corresponds to the quotient
Symm(Cr+1)∨
resX✲H0
X, OX(m)

,

208
4. Construction of Mg
Z is nonzero at [X] if and only if the restrictions resX(Yjk) of the
monomials in Z are a basis of h0
X, OX(m)

. We will call such a set
of monomials a B-monomial basis of H0
X, OX(m)

.
The change of point of view from one-parameter subgroups λ to
weighted bases B can be pushed a little further. First, note that, in
the language of weighted bases, there is no need to maintain the re-
quirements that the weights wi be integral or sum to 0. Instead, we
denote this sum by wB. The second simpliﬁcation involves the notion
of a rational weighted ﬁltration F of V = Cr+1. This is just a collec-
tion of subspaces Uw of V, indexed by the rational numbers, with the
property that Uw ⊂Uw′ if and only if w ≥w′. Any weighted basis B
determines a weighted ﬁltration FB by taking
Uw = span{xi|wi ≤w}.
We say that B is compatible with F if FB = F. If so, then we deﬁne
the weight wF of F to be wB: this clearly doesn’t depend on which
compatible B we choose.
Each F is determined by the subspaces associated to the ﬁnite num-
ber of weights w at which there is a jump in the dimension of Uw. It’s
convenient to use a notation that implicitly assumes that all these
jumps in dimension are of size 1 and to view F as the collection of
data:
(4.22)
F = F1 : Cr+1 = V0  V1  · · ·  Vr  {0}
w0 ≥w1 ≥· · · ≥wr
Thus, Uw = ∪wi≤wVi and an element x in V has weight w(x) = wi
if and only if x lies in Vi but not in Vi+1. Of course, if wi = wi+1,
then F has a larger jump and Vi+1 is neither uniquely determined by
F nor, indeed, needed to recover the ﬁltration F. We ask you to accept
this harmless ambiguity since it makes it possible to use the same
indexing in discussing one-parameter subgroups, weighted bases and
weighted ﬁltrations.
By repeating the arguments above using any basis B compatible
with F, we see that F determines weighted ﬁltrations Fm of each
Symm(Cr+1)∨. But anytime we have a weighted ﬁltration on a space
S and a surjective homomorphism ϕ : S ✲H, we get a weighted ﬁl-
tration on H by the rule that the weight of an element h of H is the
minimum of the weights of its preimages in S. Thus, Fm determines
a weighted ﬁltration, which we also denote by Fm, on H0
X, OX(m)

.
We let wF(m) denote the weight of any basis of H0
X, OX(m)

com-
patible with the ﬁltration Fm: as the notation suggests, we’ll shortly
be viewing these weights as giving a function of m depending on F.
With these preliminaries, we have:

B. Stability of Hilbert points of smooth curves
209
Proposition (4.23) (Numerical criterion for Hilbert points)
The mth Hilbert point [X]m of a subvariety X of Pr with Hilbert poly-
nomial P is stable [resp:
semistable] with respect to the natural
SL(r +1)-action if and only if the equivalent conditions below hold:
1) For every weighted basis B of Cr+1, there is a B-monomial basis of
H0
X, OX(m)

whose B-weights have negative [resp: nonpositive]
sum.
2) For every weighted ﬁltration F of V whose weights wi have aver-
age α,
wF(m) < mαP(m)
(resp: wF(m) ≤mαP(m)).
Proof.
If we diagonalize the action of the one-parameter subgroup
λ associated to B on W as above, then the B-monomial bases are just
the nonzero Pl¨ucker coordinates of [X]m and their weights are the
weights of [X]m with respect to λ. Thus 1) is an immediate transla-
tion of the numerical criterion (4.17). To see 2), observe that if B is
any basis compatible with the ﬁltration F and we set w′
i = β(wi −α)
where β is chosen so that all the weights w′
i are integral, then B
becomes a weighted basis, and, moreover, every weighted basis B
arises in this way from some F. The F-weight of any degree m mono-
mial then differs from its B-weight by mαβ. Hence the weight of
any B-monomial basis of H0
X, OX(m)

will differ from βwF(m) by
βmαh0
X, OX(m)

= βmαP(m). Therefore, the given inequality is
equivalent to the negativity of the B-weights of such bases.
Exercise (4.24) 1) Show that a collection of d distinct points in Pr
has a stable Hilbert point if and only if, for every proper linear sub-
space L of projective dimension s the number of points lying in L
is less than d
r + 1
s + 1

. How should this criterion be modiﬁed to treat
general zero-dimensional subschemes?
2) Formulate an analogous criterion for the stability of a cycle of k-
linear subspaces of Pr .
Exercise (4.25) This exercise gives an example of a smooth but
Hilbert unstable variety: the Steiner surface. This is the surface S of de-
gree 4 in P4 which is the closure of the image of P2 under the rational
map given by all conics passing through a ﬁxed point, say, (0, 0, 1).
Equivalently, it’s the projection of the Veronese in P5 from a point
lying on it.
1) Show that H0(S, OS(m)) may be identiﬁed with the span of the
monomials of degree 2m in the homogeneous coordinates (x, y, z)
on P2 whose degree in z is at most m.

210
4. Construction of Mg
2) Use this, ﬁrst, to deﬁne a ﬁltration F on H0(S, OS(1)) by assigning
weight 0 to those sections not divisible by z and weight 1 to all others.
Then, use it to show that the Hilbert point of S is unstable by showing
the inequality wF(m) > mαFP(m) and applying Proposition (4.23).
3) Geometrically, S is an F1 rational ruled surface and the projection
onto the weight 0 subspace of the ﬁltration F has center the excep-
tional section of self-intersection −1 on S. Generalize this example to
the projectivization of any unstable rank 2 bundle on a smooth curve
(cf. [116]).
We will continue to write α := αF for the average weight of an ele-
ment of a basis B of Cr+1 compatible with F. We will also say simply
that the variety X is Hilbert stable with respect to F if, for all large m,
the inequalities of the proposition hold for F, and that X is Hilbert
stable if for all large m, the mth Hilbert points of X are stable: i.e.,
the inequalities of the proposition hold for every nontrivial F. All the
methods of verifying the stability of an mth Hilbert point that we will
use apply to all sufﬁciently large m, the implicit lower bound depend-
ing only on the Hilbert polynomial P of X so this will not introduce
any ambiguity. To see why this is so, we introduce an idea developed
in [121]: the weights wF(m) are given for large m by a numerical poly-
nomial in m of degree (dim(X) + 1). For our purposes, all we’ll need
is the:
Lemma (4.26) (Asymptotic numerical criterion) Let X be a sub-
scheme of dimension n and degree d in Pr .
1) There are constants C and M depending only on the Hilbert poly-
nomial P of X, and, for each F, a constant eF depending on F such
that, for all m ≥M,
&&&&&wF(m) −eF
mn+1
(n + 1)!
&&&&& < Cmn.
2) If eF < αF(n + 1)d, then X is Hilbert stable with respect to F; and
if eF > αF(n + 1)d, then X is Hilbert nonsemistable with respect
to F.
3) Fix a Hilbert polynomial P and a subscheme S of H = HilbP,r .
Suppose that there is a δ > 0 such that
eF < αF(n + 1)d −δ
for all weighted ﬁltrations F associated to the Hilbert point of any
X in S. Then there is an M, depending only on S, such that the mth
Hilbert point [X]m of X is stable for all m ≥M and all X in S.

B. Stability of Hilbert points of smooth curves
211
Proof.
For the ﬁrst assertion, which follows by standard arguments,
we’ll simply refer to [121]. The second then follows by taking leading
coefﬁcients in the second form of the numerical criterion and using
Riemann-Roch to provide the estimate, for large m,
P(m) = h0
X, OX(m)

= dmn
n!
+ O(mn−1).
However, while this comparison of leading coefﬁcients shows that
wF(m) will be negative for m greater than some large M, exactly how
large this M must be taken depends on the ratio of the constant C in
part 1) to the difference αF(n+1)d−eF in part 2). To get the uniform
assertion of part 3), we need both a uniform lower bound (given by
δ) for this last difference and the uniform upper bound, provided by
Mumford, for C.
Remark. It’s possible to carry out the construction of Mg using the
Chow scheme as a parameter space. The inequalities in 2) of the lemma
are respectively equivalent to stability and instability of Chow points.
Equality in 2) is equivalent to Chow semistability but gives no informa-
tion on Hilbert stability. For further discussion, see [116] or [121].
Gieseker’s criterion
We close these technical preliminaries with a fundamental estimate
due to Gieseker [57] for eF. While this is in no way essential, we’ll now
simplify by assuming that X is a smooth curve, which we denote C em-
bedded in Pr = P(V) by a linear series with a ﬁxed Hilbert polynomial
P. In order to state this criterion, we need to deﬁne an additional set
of invariants of the ﬁltration F given as in (4.22). These are the degrees
dj of the subsheaf generated by the sections in |Vj|. Equivalently, dj
is the degree of the image of C under the projection from Pr to P(Vj)
multiplied by the degree of this projection. It’s also convenient to de-
ﬁne ej = d −dj so that ej is the codegree, or drop in degree, under
this projection.
Gieseker ﬁrst ﬁxes a subsequence
0 = j0 > j1 > · · · > jh = r
of (0, . . . , r). He next introduces two auxiliary positive integers p and
n to be ﬁxed later and considers the ﬁltration of H0
C, OC

n(p +1)

given by the images Un
k,i under restriction to X of the subspaces
W n
k,i = Symn(V0) · Symn(p−i)(Vjk) · Symni
Vj(k+1)

of Symn(p+1)(V). Here the index k runs from 0 to h −1 and, for each
k, the index i ranges between 0 and p.

212
4. Construction of Mg
Gieseker’s key claim is that, for any ﬁxed choice of Hilbert polyno-
mial Pand integers n and p, there is an N depending only on these
three choices but not on the Hilbert point [C] or the weighted ﬁltra-
tion F being considered, such that the dimension formula
(4.27)
dim(Un
k,i) = n

d + (p −1)djk + idjk+1

−g + 1
holds for every n ≥N and for every k and i. Since every section in Un
k,i
has weight at most n

w0 + (p −i)wjk + iwjk+1

, this claim leads, as
we shall see more precisely in a moment, to upper bounds for wF(m),
and eventually for eF.
To see (4.27) pointwise, observe that, if Lj is the line bundle on C
generated by the sections in Vj, then we can view Un
k,i as a sub-linear
series of H0
C, (Mk,i)⊗n
where
Mk,i = L

(Ljk)(p−i)
(Ljk+1)i
is a line bundle of degree d + (p −i)djk + idjk+1. Now, |V0| restricts to
a very ample linear series on C since it’s the linear series that realizes
the embedding of C in Pr . Therefore, the linear space W 1
k,i restricts,
on C, to a very ample base point free linear subseries of the complete
linear series H0(C, Mk,i). This, in turn, implies that, for large n, we
have equalities
H0
P(W 1
k,i), O(n)

= Symn(W 1
k,i) = W n
k,i
and, moreover, that the map
ϕn
k,i : W n
k,i ✲H0
C, (Mk,i)⊗n
given by restriction to C will be surjective. Taking n ≥2g, the estimate
of the claim follows from Riemann-Roch applied to (Mk,i)⊗n.
Exercise (4.28) This exercise shows how to obtain the uniform ver-
sion of (4.27) from the pointwise version. Fix the Hilbert polynomial
P and integers n and p as above.
1) Use the Uniform m lemma (1.11) to show that there is an ND,R with
the property that whenever the linear series ϕ1
k,i(W 1
k,i) has degree D
and dimension R, then for all n ≥ND,R, all k ≤h −1 and all i ≤p,
H1
P(W 1
k,i), IC(n)

= 0 ,
and hence ϕn
k,i is surjective.
2) Show that both D and R above can be bounded in terms of P, n
and p alone and hence deduce the uniform version of (4.27).

B. Stability of Hilbert points of smooth curves
213
To prepare to extract estimates for wF(m) from (4.27), we abstract
our setup for a moment. Suppose we’re given a ﬁltration of a vector
space T by subspaces Tk,i such that
T0,0
⊃T0,1
⊃· · · ⊃T0,p−1
⊃T0,p
= T1,0
⊃T1,1
⊃· · · ⊃T1,p−1
⊃T1,p
= · · ·
= Th−1,0 ⊃Th−1,1 ⊃· · · ⊃Th−1,p−1 ⊃Th−1,p
= Th,0 .
Suppose, further, that we know that each Tk,i has dimension Dk,i and
that its elements have weight at most Rk,i. Then, any basis of T com-
patible with the ﬁltration above would have weight at most
h−1

k=0
p−1

i=0

Dk,i −Dk,i+1

Rk,i

+Dh,0Rh,0
= D0,0R0,0 +
h−1

k=0
p

i=1
Dk,i

Rk,i −Rk,i−1

.
We now apply this observation taking T to be H0(C, Ln(p+1)) and
Tk,i = Un
k,i. We can thus take
Dk,i = n

d + (p −i)djk + (i)djk+1

−g + 1
and
Rk,i = n

w0 + (p −i)wjk + iwjk+1

.
Using d = d0 gives an upper bound for wF

n(p + 1)

of

n(p + 1)d −g + 1

n(p + 1)w0

+
h−1

k=0
 p

i=1

n

d + (p −i)djk + (i)djk+1

−g + 1

·

n(wjk+1 −wjk)

which, by applying standard formulae to the interior summation, we
may rewrite as

214
4. Construction of Mg

n(p + 1)d −g + 1

n(p + 1)w0

+
h−1

k=0

npd + n(p2 −p)djk
2
+ n(p2 + p)djk+1
2
−p(g −1)

·

n(wjk+1 −wjk)

.
Expanding this last expression in powers of n and p, we obtain
wF( n(p + 1))
≤n2p2

dw0 + 1
2
h−1

k=0

djk + djk+1

wjk+1 −wjk

+ n2p

2dw0 + 1
2
h−1

k=0

2d −djk + djk+1

wjk+1 −wjk

+ n2'
dw0
(
+ np

−(g −1)

w0 + 1
2
h−1

k=0

wjk+1 −wjk

+ n
'
−(g −1)w0
(
.
Because we have these inequalities whenever p ≫0 and n ≫p, they
yield the estimate
eF ≤2dw0 +
h−1

k=0

djk + djk+1
 
wjk+1 −wjk

.
To see this, ﬁrst note that on the right we just have the n2p2 coefﬁ-
cient from the previous line, which we denote, for a moment, by A.
This would also be the n2(p + 1)2 coefﬁcient were we to have ex-
panded in powers of n and (p + 1). Therefore, given any ε > 0, we
may choose p so large that wF(n(p + 1)) ≤n2(p + 1)2(A + ε) for all
n ≫p. Taking leading coefﬁcients (and recalling that our normaliza-
tion of these introduced a factor of 2 on the right), this proves the
desired inequality to within ε.
Next, observe that
djk + djk+1 =

d −ejk

+

d −ejk+1

= −

ejk + ejk+1 −2d

and that, if we suppose that wr = 0, then
w0 =
h−1

k=0

wjk −wjk+1

.

B. Stability of Hilbert points of smooth curves
215
These allow us to rewrite the estimate for eF above as
eF ≤
h−1

k=0

ejk + ejk+1
 
wjk −wjk+1

.
Finally, deﬁne εF to be the minimum of these estimates over all sub-
sequences of (0, . . . , r):
(4.29)
εF =
min
0=j0<j1···<jh=r
h−1

k=0

ejk + ejk+1

wjk −wjk+1

.
We then obtain:
Lemma (4.30) (Gieseker’s criterion)
1) A smooth curve C is Hilbert stable with respect to a ﬁltration F
with wr = 0 if εF < 2dαF.
2) Fix a smooth curve C of degree d and genus g in Pr as above,
and numbers εi which are upper bounds for the codegree of every
subspace Vi of codimension i in V. Deﬁne εC by
(4.31)
εC =
max
w0≥···≥wr =0
r
i=0 wi=1

min
0=j0<···<jh=r
h−1

k=0

εjk + εjk+1

wjk −wjk+1

Then, C is Hilbert stable if
εC <
2d
(r + 1) .
3) Fix integers d, g and r and a subscheme S of the Hilbert scheme
of curves of arithmetic genus g and degree d in Pr such that every
curve in S is smooth. If there is a δ > 0 such that
εC <
2d
(r + 1) −δ
for every curve C in S, then there is an M such that the mth Hilbert
point [C]m of C is stable for all m ≥M and all curves C in S.
Proof.
The ﬁrst assertion follows directly from the asymptotic nu-
merical criterion by the argument given above. On the other hand, the
quantity deﬁning εF depends only on the codegrees ei and weights wi
of F. We may translate the weights of F so that the smallest equals
0 and then rescale the weights of F so that they sum to 1 and hence
have average
αF =
1
(r + 1)

216
4. Construction of Mg
without affecting the F-stability of C. We will call such ﬁltrations nor-
malized. The right side of (4.29) is increasing as a function of the ei’s
so the maximum in the deﬁnition of εC is an upper bound for the
εF of every normalized weighted ﬁltration. Therefore, the inequality
of part 2 implies Hilbert stability with respect to every F. Finally, the
uniform assertion in part 3 follows from the uniform version of the
asymptotic numerical criterion (4.26).
Remark. This criterion, and its higher-dimensional analogues, are the
best tools currently available for verifying the stability of Hilbert
points. Unfortunately, there are many varieties with stable Hilbert
points for which even the ﬁrst inequality is violated for some ﬁltra-
tions F.
Exercise (4.32) 1) Show
that,
for
a
nodal
plane
cubic,
εC = 2 =
 2d
r + 1

.
2) If C is a nondegenerate moduli stable curve in Pr with n nodes and
r ≥2n, show that there are ﬁltrations F with codegrees ei ≥2i for
0 ≤i ≤n.
3) Give an example of a complete linear system on an irreducible mod-
uli stable curve for which εF >
 2d
r + 1

.
The construction of Mg will show that if d ≫g, then curves like
those in the last part of the exercise do have stable points. In other
words, Gieseker’s criterion is far from being a sharp estimate of eF.
In dimensions greater than 1, the analogous inequality can even be
false for smooth varieties: see [116] for an example. For a wide variety
of applications, therefore, it would be of great interest to have good
answers to the:
Problem (4.33) Find better estimates for eF.
Stability of smooth curves
We’re now ready to state the fundamental:
Theorem (4.34) (Stability of smooth curves of high degree)
Suppose that C is a smooth curve of genus g ≥2 embedded in Pr by
a complete linear system L of degree d ≥2g. Then C is Hilbert stable.
Moreover, an M such that the mth Hilbert point [C]m is stable for all
m ≥M may be chosen uniformly for all such curves C.
We will follow the argument given in [121] following ideas of
Gieseker. First, imagine that both the εi’s and the wi’s in Gieseker’s cri-
terion are ﬁxed and plot the points (εi, wi) as shown in Figure (4.35).

B. Stability of Hilbert points of smooth curves
217
w
(ε0, w0)
(ε1, w1)
(ε2, w2)
(ε3, w3)
(ε4, w4)
(ε5, w5)
area given by sum
using subsequence
(0, 3, 5)
minimal
area given
by sum using
subsequence (0, 2, 4, 5)
ε
Figure (4.35)
The key observation is that the sum
h−1

k=0

εjk + εjk+1

wjk −wjk+1

associated to a subsequence 0 = j0 > j1 > · · · > jh = r + 1 in the
deﬁnition of εC in (4.31) represents twice the area in the ﬁrst quadrant
bounded by the axes and the “curve” obtained by joining the pairs of
points (εjk, wjk) and (εjk+1, wjk+1) by straight line segments.Taking
the minimum of these sums over all such subsequences amounts to
computing twice the area under the lower convex envelope E of these
points.
Now allow the wi’s to vary, keeping the εi’s ﬁxed. If any of the points
(εi, wi) does not lie on E, then moving it down onto E will leave the
minimum in Gieseker’s criterion unchanged while reducing the sum
of the wi’s. Dually, this means that the maximum over sets of weights
summing to 1 in (4.31) must occur when the weights are chosen so that
all the points (εi, wi) lie on E. For such weights, the sum associated
to the full sequence — that is, ji = i for all i from 0 to r — realizes
the minimum over all subsequences.
Next, we claim that we can take
εi =
d
(r + 1)i .
This is most easily seen from the graph in Figure (4.36) in which
the Riemann-Roch line d = r + g and the Clifford line d = 2r are

218
4. Construction of Mg
graphed in the (d, r)-plane. The corresponding theorems state that
the point (dim(U), deg(U)) corresponding to any linear series on C
lies in the region below the graph. In particular, this applies to the
point (r −i, di) = (r −i, d −ei) associated to any linear series Vi
of codimension i in H0(C, L). On the other hand, the hypothesis of
the theorem is that the point (d, r) corresponding to the line bundle
L on C lies on the Riemann-Roch line. Together, these observations
imply that the slope of the line segment from (r −i, d −ei) to (r, d)
is greater than the slope of the segment joining (r, d) to the origin,
which is just our claim.
r = h0 −1
degree d
d = 2r
(2g, g)
(2g −2, g −1)
d = r + g
Figure (4.36)
The claim in turn shows that
εC ≤
r−1

j=0

εj + εj+1
 
wj −wj+1

≤
d
r + 1
r−1

j=0
(j + (j + 1))

wj −wj+1

=
d
r + 1
r−1

j=0

2wj

.
Using our assumption that the wi’s sum to 1 and are decreasing —
and hence that w0 ≥

1
r + 1

— this immediately implies
εC ≤
2d
r + 1 (1 −2w0) ≤
2d
r + 1

1 −
1
r + 1

.

B. Stability of Hilbert points of smooth curves
219
The pointwise assertion of the theorem now follows immediately from
the second part of (4.30) and the uniform assertion from the third part
taking δ = (2d)/(r + 1)2.
Exercise (4.37) This exercise gives a closed form for the expression
that arises in Gieseker’s criterion (4.30). This is useful in studying a
variety of stability problems involving special curves, vector bundles
on curves and K3 surfaces.
Fix an increasing sequence (ε0, . . . , εr+1) and deﬁne ε in terms of this
sequence by (4.31).
1) Show that, up to a common rescaling, the weights wi that maximize
ε are those that minimize
e =

min
0=j0<j1<···<jh=r
h−1

k=0

εjk + εjk+1

wjk −wjk+1

subject to the constraint e = 1. Argue as in the proof of (4.34) that
the wj’s that realize this minimum have the property that the points
(εj, wj) all lie on their own lower convex envelope, and hence, that,
for such weights
(4.38)
e =
r−1

j=0

εj + εj+1

wj −wj−1

=
r−1

j=0

εj + εj+1

xj .
where, on the right, we’ve set xj := wj −wj+1.
2) Show that the wj’s decrease and that the points (εi, wi) all lie
on their own lower convex envelope if and only if the sequence

xj/(εj+1 −ε0)

is decreasing. Deduce that these conditions deﬁne
an (r −1)-simplex in the hyperplane
r
j=1
jxj =
r
j=0
wj
in x-space and hence that the linear function e in (4.38) achieves its
maximum value at one of the vertices of this simplex.
3) Show that a set of wj’s corresponds to a vertex of this simplex if
and only if, for some i between 1 and r, we have
wj =

εi −εj

iεi −ε1 −· · · −εi−1
for j ≤i and wj = 0 for j > i, and that, for these weights, the sum
deﬁning e equals
(εi)2
iεi −ε1 −· · · −εi−1
.

220
4. Construction of Mg
4) Use Figure (4.36) to show that εi ≤i for i ≤d−2g +1 and εi ≤i+l
for i = d −2g + 1 + l. Combine this with part 3) to reprove (4.34) by
explicitly evaluating the εC of Gieseker’s criterion (4.30).
C
Construction of Mg via the Potential
Stability Theorem
The plan of the construction and a few corollaries
Our goal in this section is to outline the main ideas in the G.I.T. con-
struction of Mg when g ≥2. Although the construction is direct and
global in nature and has the projectivity of Mg as an immediate corol-
lary, the main technical result [Theorem (4.45)] involves performing
many small instability calculations. To keep this section brief, we leave
the details of some steps to you, generally by setting them in the form
of exercises; and we work pointwise, indicating in parenthetical re-
marks when stronger uniform results are required and leaving you to
supply the necessary arguments.
The basic technique is to show that suitable projective models of
moduli stable curves have stable Hilbert points and apply G.I.T. How-
ever, no direct proof that Hilbert points of singular moduli stable
curves verify the numerical criterion is known. In particular, as shown
in Exercise (4.32), Gieseker’s criterion may fail for such points. The
paradoxical idea for verifying the stability of certain Hilbert points of
stable curves, due to Gieseker and Mumford, has two parts.
First, consider curves embedded by linear systems of degree suf-
ﬁciently large relative to the arithmetic genus. The Potential Stability
Theorem (4.45) shows that if such a curve isn’t moduli semistable then
it has a nonsemistable Hilbert point, and if it’s moduli semistable,
then the linear system that embeds it must have a number of good
properties. These results came as a big surprise when they were ﬁrst
discovered since stable curves in the plane and other low-dimensional
projective spaces can have arbitrarily bad singularities: see part 2) of
Exercise (4.20). The key idea is that imposing the degree hypothesis
above on the embedding does away with these pathologies. The proof
of the Potential Stability Theorem is the heart of the construction of
Mg and involves most of the work. 8
The second part of the proof involves considering a one-parameter
smoothing of a pluricanonically embedded stable curve C. By the val-
uative criterion, the pluricanonical Hilbert points of the smooth ﬁbers
8However, the rest of the construction and its consequences are independent of
this proof, so if you want you can simply accept this result and omit its proof.

C. Construction of Mg via the Potential Stability Theorem
221
in such a family have a Hilbert semistable limit in the corresponding
Hilbert scheme. The Potential Stability Theorem is then used to deduce
that this limit can only be the Hilbert point of the pluricanonical model
of C. This approach has recently been extended by Caporaso [16], at
the cost of considerably greater technical complications, to prove a
converse to the Potential Stability Theorem that is then applied to
construct modular compactiﬁcations of the universal Picard varieties
Pd,g discussed in Section B.
The remainder of this section is organized as follows. First, we claim
four properties for the pluricanonical locus constructed in C. Assum-
ing these, we construct Mg and deduce a few important properties.
We then turn to the statement and proof of the Potential Stability The-
orem. Finally, we deduce the claims from this theorem.
Deﬁnition of Mg and veriﬁcation of its properties
For the rest of this chapter, we ﬁx a genus g ≥2 and an integer n ≥5
and deﬁne integers r, s and d in terms of these, as in (3.14), by
s = r + 1 = (2 · n −1)(g −1)
and
d = 2 · n(g −1) .
(In this section, our curves will live in a projective space of dimension
r, but it’ll simplify many of the formulas in the proof of the Poten-
tial Stability Theorem to express them in terms of the corresponding
afﬁne dimension s = r +1.) We let H = Hd,g,r and let 
K be the locus
in H of moduli stable curves C of genus g embedded in Pr by the nth
power of their dualizing sheaves.
Finally, we deﬁne 
Kss to be the intersection of 
K with the semistable
locus in H for the natural action of G = SL(r +1). We will continue to
abuse language slightly and refer to all curves in 
K as n-canonically
embedded (even when they aren’t smooth) and will likewise refer to

Kss as the locus of n-canonically embedded Hilbert-semistable curves
in H .
Claim (4.39)
1) 
Kss is smooth.
2) 
Kss is closed in the semistable locus Hss in H .
3) 
Kss = 
Ks; i.e., every curve whose Hilbert point lies in 
Kss is
Hilbert stable.
4) 
Kss contains the n-canonical models of every moduli stable curve
of genus g.

222
4. Construction of Mg
Of course, the last property simply states that 
Kss = 
K. We will,
however, only see this at the very end of the section; hence the need
for the notation 
Kss here. The ﬁrst statement follows immediately
from Lemma (3.35) which proves the smoothness of 
K. The others
will be proved at the end of the section once the Potential Stability
Theorem (4.45) is established.
Deﬁnition (4.40) We deﬁne Mg to be the G.I.T. quotient for the
action of G on

Kss; that is, if we denote the quotient map by
q : 
Kss ✲
Kss/G, then Mg = 
Kss/G.
Implicit in this deﬁnition, of course, is the assertion that this quo-
tient is a coarse moduli space for stable curves of genus g. Let’s check
this now.
Let ϕ : C ✲S be a family of stable curves of genus g. Each frame
for the direct image ϕ∗((ωC/S)⊗n) of the nth power (ωC/S)⊗n of the
relative dualizing sheaf realizes C as a family of n-canonically embed-
ded curves of genus g in Pr × B and hence corresponds to a unique
morphism α : B ✲H . Claim 3 above implies that every such α factors
through 
Kss to give a map B ✲
Kss, which we continue to denote by α.
By construction, the composition χ = q ◦α : B ✲Mg is independent
of the initial choice of basis. The universal properties of the Hilbert
scheme (i.e., the fact that the map α is supplied by an isomorphism of
functors between the functor of points of 
Kss and the moduli func-
tor of “isomorphism classes of stable curves of genus g plus a basis
for the sections of the n-canonical sheaf”) immediately imply that the
maps χ paste together to yield a natural transformation Ψ from the
moduli functor F of “isomorphism classes of stable curves of genus g”
to the functor of points of Mg.
To see that Mg is a coarse moduli space, it remains to check that
Ψ satisﬁes properties 1) and 2) of Deﬁnition (1.3). Conditions 2) and
3) above immediately imply property 1): complex points of Mg cor-
respond bijectively to G-orbits in 
Kss and these in turn correspond
bijectively to moduli stable curves of genus g over C.
To check property 2, suppose we’re given another scheme M′ and
a natural transformation Ψ ′ from F to MorM′. Applying Ψ ′ to the re-
striction to 
Kss of the universal curve C ✲H over the Hilbert scheme
H yields a morphism ρ : 
Kss ✲M′. Since F is the functor of “iso-
morphism classes of stable curves of genus g”, the map ρ must
be constant on each G-orbit in 
Kss and we can therefore factor ρ
uniquely through the quotient Mg of 
Kss by G; that is, ρ = π ◦q
for a unique morphism π : Mg ✲M′. The universal properties of the
Hilbert scheme likewise imply that the natural transformation Π in-
duced by the maps π satisﬁes the relation Ψ ′ = Π ◦Ψ required in
property 2). Modulo the claims in (4.39), we’ve proved:

C. Construction of Mg via the Potential Stability Theorem
223
Theorem (4.41) Mg is the coarse moduli space for stable curves of
genus g.
Our use of the deﬁnite article above is justiﬁed by Exercise (1.4),
which shows that any two models of a ﬁxed coarse moduli space must
be canonically isomorphic.
Projectivity and irreducibility of Mg
Condition 2. of Claim (4.39) seems to be extraneous to the argument
above. In fact, it’s the key to proving conditions 3. and 4. and is the
point at which the Potential Stability Theorem is crucial. The assertion
that 
Kss is closed in the semistable locus has an immediate corollary
of fundamental importance both in psychological and practical terms:
Corollary (4.42) Mg is projective.
This was ﬁrst proved by Knudsen [97] by a delicate study of the
ﬁbers of the Torelli map from Mg to the Satake compactiﬁcation of
the moduli space of principally polarized abelian varieties.
The next corollary depends on the assertion of Lemma (3.15) that
the stabilizer stabSL(r+1)([C]) of any Hilbert point [C] in 
Kss is ﬁnite
and reduced. This, together with the smoothness of 
Kss, immediately
conﬁrms the local description of Mg suggested by the versal defor-
mation theory of stable curves and announced on page 53. The only
singularities are at curves with automorphisms, and all such curves
correspond to singular points (with a few exceptions in small genera
where there is a divisor or curves with automorphisms).
Everything we’ve said thus far can be proved over an algebraically
closed ﬁeld of any characteristic without substantially more work.
With less ease, Seshadri has shown that it’s possible to work over
fairly general base rings [139]. In keeping with the philosophy of this
book, we won’t say too much about this here except to remark that
the G.I.T. approach to the construction of Mg is the only one that
can be carried out in positive characteristics. We cannot, however, re-
sist giving Gieseker’s proof that the irreducibility of Mg in positive
characteristics as a consequence of the classical irreducibility of the
complex moduli space of smooth curves. This beautifully simple proof
also illustrates the usefulness in applications of the explicit G.I.T. con-
struction of Mg as a projective variety.
Theorem (4.43) Mg is irreducible over any algebraically closed ﬁeld.
The proof depends on the classical analytic fact that this is true in
characteristic 0 which will be given in Section 6.A. Now, if our ground

224
4. Construction of Mg
ﬁeld k has characteristic p, choose a discrete valuation ring R hav-
ing quotient ﬁeld F of characteristic zero and having k as its residue
ﬁeld: for example, R can be taken to be the ring of Witt vectors of
k. We can carry out the constructions of Mg as a quotient of 
Kss
by PGL(r + 1) over R. (We’ve been working with SL(r + 1) for conve-
nience but, of course, it is PGL(r +1) which acts effectively on H and
hence on 
Kss). Since Mg(R) is projective and its generic ﬁber Mg(F)
is connected, Zariski’s connectedness theorem implies that the spe-
cial ﬁber Mg(k) is also connected. Since PGL(r + 1, k) is irreducible,

Kss(k) is also connected. Since 
Kss(k) is smooth and connected, it’s
irreducible. Thus, Mg(k) is also irreducible.
This last corollary brings us back to the origins of stable curves. It
was in order to show the irreducibility of Mg in positive characteris-
tics by an induction on g that Deligne and Mumford ﬁrst worked out
the theory of the moduli stack of stable curves in [29]. It’s interest-
ing to compare the proof above with the somewhat intricate inductive
proof that, lacking a concrete projective construction of Mg, Deligne
and Mumford were obliged to give.
The Potential Stability Theorem
Statement and preliminaries
Deﬁnition (4.44) We call a connected curve C of genus g and de-
gree d in Pr = P(V s) where s = r + 1 = d −g + 1 potentially stable
if:
1) The embedded curve C is nondegenerate (i.e., spans Pr ).
2) The abstract curve C is moduli semistable.
3) The linear series embedding C is complete and nonspecial: i.e.,
h0
C, OC(1)

= s and h1
C, OC(1)

= 0.
4) Any chain of smooth rational components of C meeting the rest
of C in exactly two points has length 1.
5) If R is a smooth rational component meeting the rest of C in ex-
actly two points, then degR(OC(1)) = 1; that is, R is embedded as a
line.
6) If Y is a complete subcurve of C of arithmetic genus gY meeting
the rest of C in kY points, then
&&&&&degY (OC(1)) −
d
g −1

gr −1 + kY
2
&&&&& ≤kY
2 .

C. Construction of Mg via the Potential Stability Theorem
225
Conditions 4) and 5) are actually consequences of 6) — we’ll see
this shortly — but we’ve stated them separately because they indicate
how close to moduli stable the abstract curve C underlying a poten-
tially stable curve C in Pr (C) must be. We will continue, as usual,
to abuse language and speak of a “potentially stable curve C” when
the implied embedding is clear from the context. The justiﬁcation for
this somewhat baroque deﬁnition lies in the following theorem, which
with Theorem (4.34) forms the heart of the whole G.I.T. construction
of Mg.
Theorem (4.45) (Potential Stability Theorem) Fix integers g
and d with g ≥2 and d > 9(g −1). Then there is an M depending
only on d and g such that if m ≥M and C in Pr (C) is a connected
curve with semistable mth Hilbert point, then C is potentially stable.
Here we’ll only prove a pointwise version of the theorem (with m
allowed to depend on C), footnoting points at which our argument
must be reﬁned to get the uniform assertion of the theorem.
The answer to the natural question — is potential stability also suf-
ﬁcient for Hilbert semistability? — is, essentially, yes. With slightly
weaker numerical hypotheses, this converse is proved by Caporasoin
[16] and shown to yield modular compactiﬁcations of the universal Pi-
card varieties. In particular, the moduli strictly semistable curves not
ruled out by the theorem will have models of large degree — those sat-
isfying conditions 3 and 6 — with semistable Hilbert points. We will
only prove the converse for pluricanonical curves in the next subsec-
tion. Caporaso uses a generalization of the indirect approach taken
there, but her proof requires an order of magnitude more combinato-
rial and geometric effort.
Even the proof of the necessity is somewhat lengthy: it occupies
pages 35 to 87 of [58]. A condensed proof of a slightly weaker re-
sult, which sufﬁces for the construction of Mg, is given in [60]. Our
argument is most closely modelled on this one.
Despite the complications that ensue, the essential strategy is very
simple: if C fails to have some property covered by (4.44), ﬁnd the
ﬁltration F of V that highlights this failure most clearly and check
that F is destabilizing by showing some form of the numerical cri-
terion (4.23) is violated. Usually, we’ll see that eF > 2dαF and apply
the asymptotic version of Lemma (4.26). A certain care is needed in
the order in which the properties are established since it is often nec-
essary to assume some of these properties to check that the failure
of others is destabilizing. We will indicate the correct order of these
steps, giving the ﬁltration F in each case. In a few steps, we check that
F is destabilizing; in others, these checks are left as exercises. A few
technical lemmas needed on the way have also been left as exercises.

226
4. Construction of Mg
We begin with a few notational preliminaries. If Y is a complete
subcurve of C, we’ll let
Yred = the underlying reduced subcurve
nY : Yns ✲Yred = the normalization of Yred
LY = OC(1) Y
dY = degY (LY )
sY = h0(Y, LY )
gY = arithmetic genus of Y .
In the deﬁnitions given in Section B of the invariants wF(m) and eF
of a weighted ﬁltration F on V, we implicitly had a ﬁxed curve C and
its mth Hilbert points in mind: wF(m) was the least F-weight of a
basis of H0(C, OC(m)) and eF was the leading coefﬁcient of the nu-
merical polynomial representing wF(m). Here, we’ll often wish to con-
sider these invariants for subcurves Y of C: when we do, we’ll write
wF(Y, m) for H0(Y, OY (m)) and eF(Y) for the leading coefﬁcient of
this polynomial. If Y = C, we usually suppress the Y’s in all these
notations and we’ll also generally replace LC by OC(1).
We also let F(Y) denote the ﬁltration (possibly trivial) of V that gives
weight 0 to the kernel UY of the canonical restriction map
ϕY : H0(C, LC) ✲H0(Y, LY )
and weight 1 to all other sections. We note, for future reference, the
obvious estimate
(4.46)
αF(Y) ≤sY
s
with equality if and only if ϕY is surjective.9
If Z is another complete subcurve of C having no common com-
ponent with Y, we’ll let KY,Z = Y ∩Z and kY,Z = |{Y ∩Z}|. We will
denote by Y the closure of the complement of Y in C and write KY
and kY for KY, Y and kY, Y . We will refer to the nodes in KY as boundary
nodes of Y. The other nodes in Y will be called internal to Y while the
other nodes of Y will be called external to Y. Finally, we deﬁne the
quasigenus
hY = gY −1 + kY
2 .
The ﬁrst virtue of the somewhat strange looking expression hY is that
it provides an additive form of the genus in the sense that, if Y and Z
have no common components, then
hY∪Z = hY + hZ.
9This is a typical example of a formula more naturally expressed in terms of the
afﬁne dimension s rather than the projective one r.

C. Construction of Mg via the Potential Stability Theorem
227
This follows directly from the deﬁnition by combining the ordinary
arithmetic genus formula
gY∪Z = gY + gZ + kY,Z −1
with the fact that, as sets,
KY,Z ∪KY∪Z = KY ∪KZ
with both unions disjoint. In effect, we view the boundary nodes as
lying half on Y and half on Y and so contributing 1
2 to the genus of
each.
We will mainly use these notations to help extract consequences of
property 6) of (4.44). To get a ﬁrst feel for this condition, suppose
that Y is any chain of smooth rational curves in the potentially stable
curve C with kY ≤2. Then gY = 0 so gy −1 + kY
2 ≤0 and property 6)
implies dY ≤kY
2 . Since dY > 0, this immediately rules out kY = 1 and
shows that any nodal, potentially semistable C is moduli semistable.
Moreover, if kY = 2, then dY = 1 so that Y must be a single rational
curve embedded as a line. The next exercise gives two restatements
of property 6) of (4.44).
Exercise (4.47) Let C in Pr be a connected, reduced, nodal curve and
let Y be a complete subcurve of C. Assume that H1(C, OC(1)) = 0 (and
hence also that H1(Y, LY ) = 0).
1) Show that property 6) of (4.44) for both Y and Y is equivalent to
either pair of inequalities below:
i)
d
h

hY ≤dY + kY
2
and
d
h

h Y ≤d Y + k Y
2 ,
or,
ii)
sY
s

≥

dY + kY
2

d
and
s Y
s

≥

d Y +
k Y
2

d
.
2) Use the description of the dualizing sheaf of a nodal curve given
in (3.3) to show that degY (ωC Y ) = degY (ωY ) + kY = 2hY . Conclude
that property 6) of (4.44) for Y is also equivalent to
&&&&&dY −

d
degC(ωC)

degY (ωC Y )
&&&&& ≤kY
2 .
By part 1 of this exercise, the Potential Stability Theorem will follow
if we show that the curves C of the theorem are reduced, nodal and
nondegenerate, that the linear series embedding such a C is complete
and nonspecial, and that
(4.48)
sY
s ≥
(dY + kY
2 )
d

228
4. Construction of Mg
for every complete subcurve Y.
We leave as exercises two geometric estimates that will be our main
tools for doing this.
Exercise (4.49) [First Basic Estimate] Fix a weighted ﬁltration F
on V. If S = {Yi|i ∈I} is a collection of subcurves of C such that the
natural map
ϕ : OC ✲%
i∈I
OYi
has ﬁnite kernel and cokernel, then
eF ≥

i∈I
eF(Yi).
If the weights of F are nonnegative, then the same conclusion holds
assuming only that ϕ has ﬁnite cokernel.
Exercise (4.50) [Second Basic Estimate] Fix a weighted ﬁltration
F = {(Vi, wi)} on V with integer weights as in (4.22). Assume that:
1. Y is an irreducible subcurve of C with generic multiplicity µ.
2. For some j, Vj maps to 0 in H0(Yred, Lred).
3. There is an effective divisor K on Yred such that, for each i < j,
Vi maps to
H0(Yred, LYred(−(w0 −wi)K)).
Then,
eF ≥eF(Y) ≥

w0 −wj−1
2
deg(K) + 2µwj−1dYred .
Remark. Proving the uniform version of the Potential Stability Theo-
rem requires slightly stronger forms of the Basic Estimates. The asser-
tion that F is destabilizing is by (4.23) a strict inequality for the poly-
nomial wF(m). Even pointwise, no such comparison can be deduced
from a nonstrict inequality on the leading coefﬁcient eF of wF(m)
such as the estimates give. At ﬁrst, it might seem that what we really
need are versions of the Estimates with each eF replaced by the cor-
responding wF(m) for some (pointwise or uniform) m. However, the
conclusion that F is destabilizing will always involve combining one
of the Basic Estimates with some form of the inequality d > 9(g−1) in
the hypothesis of Theorem (4.45). This introduces a “margin of error”
that tautologically depends only on d and g. This margin is enough
to allow us to apply the Estimates as stated above to obtain pointwise
results. It’s even enough to get uniform results if we strengthen the
Estimates by adding some control over the nonleading terms of the
polynomials wF(m). More precisely, we need to show that there are

C. Construction of Mg via the Potential Stability Theorem
229
constants N, N′ and M, depending only on d and g, such that, for
m ≥M, we have
wF(m) + Nm ≥

i∈I
wF(Yi, m)
and
wF(m) + (N + N′)m ≥wF(Y) + N′m
≥

w0 −wj−1
2 deg(K) + 2µwj−1dYred
m2
2

in the situations of the ﬁrst and second estimate respectively.
The proofs of the Basic Estimates outlined in the following hints also
give this reﬁnement pointwise. Uniform versions can then be obtained
by variations of the arguments used to get the uniform bounds in the
Uniform m lemma (1.11) and Gieseker’s criterion (4.30). We leave you
to supply these reﬁnements if you’re interested.
Hints and sketch of proof : Both proofs are variations on the ideas
used in the proof of Gieseker’s criterion (4.30), the main difference
being that lower bounds for eF are derived from upper bounds for
the dimensions of spaces of sections of small weight, rather than the
reverse.
For example, the First Basic Estimate follows directly from the fact
that the restriction maps
H0(C, L⊗m
C
) ✲%
i∈I
H0(Ci, L⊗m
i
)
have kernel and cokernel of dimensions bounded by those of ϕ.
The Second Basic Estimate requires a bit more work. First, observe
that replacing Y by the curve deﬁned by the µth power of the ideal
of Yred doesn’t affect either the hypotheses or any quantities in the
inequality for eF. Then, use the fact that
h0
Y, O(m)

= µmdYred + O(1)
to see that it sufﬁces to consider the case where wj−1 = ws−1 = 0.
Next, use the fact that wF(m) ≥wF(Yred, m) — since the wi’s are
now positive — to reduce to the case where Y is reduced.
To treat this case, the key observation is that any monomial of
weight at most w restricts on Yred to a section of
H0
Yred, (LYred)⊗m
−(mw0 −w)K

and that the dimension of every such space differs from that of its
preimage in H0
Y, OY (m)

by a uniform constant. The estimate
eF(Y) ≥

w0 −wj−1
2 deg(K) + 2µwj−1dYred

230
4. Construction of Mg
then follows by applying Riemann-Roch, summing over w and tak-
ing leading coefﬁcients. Since the First Basic Estimate applies with
S = {Y} we get the claimed estimate for eF as well. We will mainly use
this estimate in the extreme cases where either j = 1 or j = s.
Outline of the proof
We’re now ready to turn to the proof of Theorem (4.45), which we
present as a series of steps.
Step 1: Cred is nondegenerate.
If not, use the ﬁltration F that gives weight −1 to the sections that
vanish on Cred, and weight w > 0 to the others where w is chosen
so that the average αF of the weights of F is 0. Choose an integer q
so that the qth power of any nilpotent in the ideal sheaf of C is 0.10
Then no monomial that contains more than q factors of weight −1
can even be nonzero modulo this ideal. Hence if (m −q)w > q, every
element of a monomial basis of H0(C, OC(m)) has strictly positive
weight and wF(m) is a fortiori positive. By Proposition (4.23), C is
Hilbert nonsemistable.
Henceforth we assume that d > 9(g−1). Combining this with Step 1
and the Riemann-Roch estimate s ≤d −g + 1, we get an estimate that
we’ll often use without comment in the sequel:
(4.51)
d
s < 9
8 .
We will also often use, when Y is irreducible, the estimate rY ≤dY +1
with equality if and only if Y is a rational normal curve.
Step 2: Every component of C is generically reduced.
Suppose that Y is a multiple component of C of multiplicity µ. We
claim that there is a nonzero section of OC(1) vanishing on Yred; that
is, the ﬁltration F = F(Yred) is nontrivial. If not, then since Cred is
nondegenerate, we would have, by Riemann-Roch,
sYred ≥s ≥
8
9

d.
The trivial estimates
sYred ≤dYred + 1 ≤
1
2

d + 1
10Again, proving the uniform version of Theorem (4.45) requires a bound for q
depending only on d and g that we leave to you if you’re interested.

C. Construction of Mg via the Potential Stability Theorem
231
(the last, because µ ≥2), show that this cannot happen. The same
estimate shows that
αF ≤dYred + 1
s
,
and hence
2αFd < 2
9
8
 
dYred + 1

.
On the other hand, the Second Basic Estimate (4.50) applies to F if we
there take Y as the curve, the kernel W of the restriction map ϕY as the
subspace Vj, and the empty divisor as K. Since w0 = · · · = wj−1 = 1,
we ﬁnd that eF ≥2µdYred. Since αF < 1, these show F is destabilizing
unless
2µdYred < 2
9
8
 
dYred + 1

,
which can only happen if µ = 1 as desired or µ = 2 and dYred = 1.
If we’re in the last case, then 2αFd < 2
9
8
 
dYred + 1

< 9
2. Since
dY = 2, there must be another component Z of C meeting Y in some
point P. We can apply the Second Basic Estimate again to Z, this time
with Vj = {0} and K = {P} — so w0 = 1 and wj−1 = 0 — and conclude
that eF(Z) ≥1. Finally, we may combine our estimates for eF(Y) and
eF(Z) using the First Basic Estimate (4.49) with S = {Y, Z} to ﬁnd
eF ≥eF(Y)+eF(Z) ≥2·2·1+1 = 5 > 2αFd, which, by the Asymptotic
Stability Criterion (4.26), shows that F is destabilizing.
Step 3: If an irreducible subcurve Y of C is not a rational normal curve,
then dY ≥4.
If Y is not rational normal, then sYred ≤dY . If dY < 4 as well, the
ﬁltration F = F(Yred) is nontrivial and Y ≠C. Therefore, there is a
component Z of Y that meets Y in a point P. Arguing exactly as in
the preceding step (except that now we know that µ = 1), we ﬁnd that
eF(Y) ≥2dY , eF(Z) ≥1, and eF ≥eF(Y) + eF(Z) ≥2dY + 1. On the
other hand we also have
2dαF ≤2d
sYred
s

<
9
8

sYred ≤
9
4

dY .
This shows that F is destabilizing unless dY ≥4.
Step 4: If Y is a reduced irreducible subcurve of C, then nY : Yns ✲Y
is unramiﬁed.
Assume that nY ramiﬁes at P. Consider the three-stage weighted
ﬁltration F that gives weight 0 to the space V2 of sections whose
image under restriction to Y and pullback via nY to Yns lie in
H0(Yns, Lns(−3P)), weight 1 to the space V1 of sections with images
in H0(Yns, Lns(−2P)) and weight 3 to all others. Since nY ramiﬁes, Y
itself must be singular. Hence, dY ≥4 by Step 3 and the hypotheses
of the Second Basic Estimate hold with S = {Y}, K = P, and j = 2.

232
4. Construction of Mg
Since w0 −wj = 3, we conclude that eF ≥9. Since P is ramiﬁed
dim(V0/V1) ≤1, and in any case, dim(V1/V2) ≤1 so αF ≤4
s. Using
(4.51), this means that 2dαF < 9 and hence that F is destabilizing.
Step 5: Every singular point of Cred has multiplicity 2.
If P is a point of multiplicity 3 or greater, we claim that the two-stage
ﬁltration F that gives weight 0 to the space V1 of sections vanishing
at P and weight 1 to all others satisﬁes eF ≥3. Since αF is clearly
1
s and 2dαF ≤2
9
8

, this will show that F is destabilizing. Suppose
ﬁrst that (at least) three distinct components Y1, Y2 and Y3 meet
at P. Pick points Pi on (Yi)ns mapping to P. The Second Basic Esti-
mate applies to each Yi separately, taking K = Pi and j = 1 to yield
eF(Yi) ≥1. Now, applying the First Basic Estimate, we conclude that
eF ≥eF(Y1) + eF(Y2) + eF(Y3) ≥3 as desired. If only one component
Y passes through P, then by Step 4, there are at least three distinct
points Q, R and S lying over P on Yns. Moreover, Y is singular at P, so
by Step 3, dY ≥4. The Second Basic Estimate can then be applied to
Y taking K = Q + R + S and j = 1 to yield eF ≥eF(Y) ≥3.
Exercise (4.52) Show that eF ≥3 in the case where exactly two com-
ponents pass through P and complete the veriﬁcation of Step 5.
Step 6: Every double point of Cred is a node.
In view of Steps 4 and 5, this follows from the following exercise.
Exercise (4.53) Suppose that two distinct points Q and R of the nor-
malization Cns of C map to a point P on C and that the correspond-
ing branches of C have a common tangent line L at P. Consider the
three-stage ﬁltration F that gives weight 0 to the space V2 of sections
vanishing on L, weight 1 to the space V1 of those vanishing at P but
not along L, and weight 2 to all others.
1) Suppose both Q and R lie on a component Y of C and K = Q + R.
Show that dY ≥4, that the ﬁltration induced on H0(Yred, LYred) by F is
H0(Yred, LYred) ⊃H0(Yred, LYred(−K)) ⊃H0(Yred, LYred(−2K)) ,
and that eF(Y) ≥8.
2) Suppose Q1 and Q2 lie on different components Y and Z of C.
Show that if dY > 1 then the ﬁltration induced on H0(Yred, LYred) by F
is
H0(Yred, LYred) ⊃H0(Yred, LYred(−Q)) ⊃H0(Yred, LYred(−2Q))
and that eF(Y) ≥4. Show that if dY = 1 then eF(Y) ≥3.

C. Construction of Mg via the Potential Stability Theorem
233
3) Conclude that eF ≥7 and hence is always destabilizing.
Hint: The ﬁrst three parts follow by various applications of the Second
Basic Estimate. Given these, the last part is immediate, except in the
case where Q and R lie on different components when it follows from
the First Basic Estimate by eliminating the possibility that both Y and
Z have degree 1.
Step 7: H1(Cred, OC(1)) = {0}.
First, an exercise based on Clifford’s theorem (cf. [62, Lemma 9.1]),
which will be used in the proof.
Exercise (4.54) Suppose that C is a connected nodal curve and
that L is a line bundle on C generated by global sections such that
H1(C, L) ≠{0}. Show that there is a subcurve Y of C for which
sY ≤(dY /2) + 1.
If H1(Cred, OC(1)) ≠{0} and Y is chosen as in the exercise, we claim
that F = FY will be destabilizing. By applying the Second Basic Esti-
mate separately to each component Z of Y with K empty and Vj the
space of weight-zero sections on that component, we see that, for each
Z, eF(Z) ≥2dZ. Using the First Basic Estimate, we can sum these es-
timates over the components of Y to get eF ≥2dY . The exercise then
gives us the estimate 2dαF < 9
8(dY + 2), which is less than eF unless
dY = 2. In this last case, since LY is ample, Y must be a line, a smooth
plane conic or a pair of lines meeting in one point, all of which violate
the assumption sY ≤(dY /2) + 1.
Step 8: C is reduced, so H1(C, OC(1)) = {0} and V = H0(C, OC(1)).
This is perhaps the prettiest point in the argument. Let I be the ideal
sheaf of nilpotents in OC. Then we have an exact sequence
0
✲I

OC(1)
✲OC(1)
✲OC(1) Cred
✲0.
In cohomology, this gives,
H1(C, I

OC(1))
✲H1(C, OC(1))
✲H1(C, OC(1) Cred)
✲0.
Since we now know I has ﬁnite support, the ﬁrst term is 0. Step 7
shows that the third is also 0, hence so is the second. But the map
H0(C, OC(1)) ✲H0(C, OC(1) Cred) is injective by Step 1, so
h0(C, OC(1)) ≤h0(C, OC(1) Cred) = h0(C, OC(1)) −h0(C, I

OC(1)).
Hence h0(C, I

OC(1)) = 0. Again, since I has ﬁnite support, this
implies that I = 0.

234
4. Construction of Mg
We have now established parts 1 to 3 of (4.44). By Exercise (4.47)
and the remarks following it, all that remains is to show that (4.48)
holds for every complete subcurve Y. To prepare to show this as our
ﬁnal Step 10, we ﬁrst sharpen the result of Step 3.
Step 9: For every subcurve Yof C and every component E of Y, either
1) dE ≥kE,Y , or,
2) E is a rational normal curve for which dE = kE,Y −1.
Consider the subcurve Z
=
Y ∪E. We have sZ
≥
sY since
span(Z) ⊃span(Y), so dZ −gZ + 1 ≥dY −gY + 1 by using
Riemann-Roch and Step 8 twice. Substituting dZ = dY + dE and
gZ = gY + gE −1 + kE,Y yields dE −gE + 1 ≥kE,Y , which in turn
gives case 1) unless E is a smooth, rational curve as in case 2).
Step 10: Inequality (4.48) holds for every subcurve Y of C.
We will show that if the desired inequality doesn’t hold, then the ﬁltra-
tion F = FY must be destabilizing. Since αF ≤(sY /s), this will follow
if we show that eF ≥2dY + kY . We will deduce this inequality from
the following two claims:
1. The Second Basic Estimate for Y itself yields eF(Y) ≥2dY ;
2. The Second Basic Estimate for each component E of Y implies
eF(E) ≥kE,Y .
Summing these using the First Basic Estimate immediately gives
eF ≥2dY + kY . Claim 1. is immediate, taking the subspace Vj of the
Second Basic Estimate to be the kernel UY of the restriction map from
C to Y (so w0 = wj−1 = 1). To prove claim 2. let’s ﬁrst suppose that
dE ≥kE,Y . Then the hypotheses of the Second Basic Estimate hold for
E with Vj = {0} and K = KE,Y . Since w0 = 1 and wj−1 = 0, we obtain
eF(E) ≥kE,Y directly. If dE < kE,Y , then we’re in Case 2) of Step 9 so
(kE,Y /2) ≤dE. But then, since every section in UY vanishes on KE,Y , UY
maps to zero in H0(E, LE). Applying the Second Basic Estimate again
with Vj = UY gives eF ≥2dE, which, by hypothesis, is at least kE,Y .
Completion of the construction
We now return to the proof of the last three properties of 
Kss listed
in Claim (4.39), thereby completing the construction of Mg. Because
we’ve ﬁxed n ≥5, the hypothesis — d > 9(g −1) — of the Potential
Stability Theorem (4.45), holds for the curves in 
Kss. Thus, we know
that every curve whose Hilbert point lies in the semistable locus 
Kss
of H is potentially stable. We ﬁrst prove Claim 2).

C. Construction of Mg via the Potential Stability Theorem
235
Proposition (4.55) 
Kss is closed in Hss.
Since, by Lemma (3.34), we know 
K is open in the full Hilbert
scheme, it’s at least locally closed in Hss. Write 
Kss = Y1 ∪· · · ∪Yp
with each Yi irreducible and locally closed in Hss and let gi : Yi ✲
Kss
be the corresponding inclusions. To show that 
Kss is closed, we
must show that each gi is proper. Applying the valuative criterion
for properness, we must therefore show that given a discrete val-
uation ring R with residue ﬁeld C and quotient ﬁeld F, any map
α : Spec(R) ✲Hss that takes the generic point η = Spec(F) of Spec(R)
into 
Kss also takes the closed point 0 = Spec(C) of Spec(R) into 
Kss.11
We ﬁrst use α to pull back the universal curve C ✲Hss to a curve
ρ : D ✲Spec(R) and let ω = ωD/Spec(R) denote the relative dualiz-
ing sheaf of this family. It follows from the deﬁnition of 
Kss and the
universal property of H , ﬁrst that
(4.56)
OD(1) Dη ≊ω⊗n
Dη
and further that α(0) will lie in 
Kss if and only if we can extend this
isomorphism over the closed point 0.
If we decompose the special ﬁber C0 of D into irreducible compo-
nents
C0 =
l)
i=1
Ci ,
then (4.56) implies that
OD(1) Dη ≊ω⊗n

−
l
i=1
aiCi

with the multiplicities ai determined up to a common integer trans-
lation. (Since Spec(R) is afﬁne, OD(−C) ≊OD.) We normalize the ai’s
so that all are nonnegative and at least one equals 0.
What we must show, then, is that all the ai’s are 0. Note that this
is automatic if C0 is irreducible. To take care of reducible C0’s, we’ll
use property 6) of (4.44). Let Y be the subcurve of C0 consisting of
all Ci for which ai is zero, and let Y be the remainder of C0 — i.e.,
those components for which ai is positive. Then a local equation for
OD

−
l
i=1 aiCi

is identically zero on every component of Y and on
no component of Y. In particular, such an equation is zero at each of
the kY points of KY = KY, Y = Y ∩Y. Therefore, we ﬁnd that
11We use terms chosen to emphasize that our argument is independent of the char-
acteristic, but if you prefer complex analytic language you may replace, as usual,
Spec(R) by a disc ∆, Spec(F) by ∆∗and 0 by the origin in ∆.

236
4. Construction of Mg
kY ≤degY

OD

−
l
i=1 aiCi

= degY

OD(1) C0

−n degy

ω C0

= degY

OD(1) C0

−
degC0

OD(1) C0

degC0

ω C0


degY

ω C0

≤kY
2
by part 2) of Exercise (4.47). Therefore kY = 0 and since C0 is con-
nected, ai = 0 for all i.
Proposition (4.57) Every curve C in Pr whose Hilbert point lies in

Kss is moduli stable.
Since every curve C in 
Kss is potentially stable, the only problem
is that C may contain some smooth rational components meeting the
rest of the curve in only two points. This cannot in fact occur since,
on the one hand, the degree of the dualizing sheaf ωC of C on such
a component is zero while, on the other, ω⊗n
C
is very ample on C
because the Hilbert point of C lies in 
Kss.
Proposition (4.58) Every moduli stable curve of genus g has a model
in 
Kss.
For any moduli stable curve and any n ≥5, ω⊗n
C
is very ample on
C, and thus embeds C as a curve in Pr whose Hilbert point [C] lies
in H . To see that [C] lies in 
Kssor, equivalently, in Hss, choose a
one-parameter deformation C ✲Spec(R) of C to a smooth connected
curve over a discrete valuation ring R; that is, the generic ﬁber Cη of C
is a smooth curve of genus g and the special ﬁber is C. Then C is again
a stable curve over Spec(R), so its n-canonical embedding realizes it
as a family of curves in Pr (C) and hence corresponds to a unique
morphism α : Spec(R) ✲H . Since the generic ﬁber Cη is smooth of
degree 2n(g −1), its Hilbert point [Cη] lies in Hss by Theorem (4.34).
(This is the only — but essential — point at which this theorem is used
in the whole construction.)
Since the quotient of Hss by SL(r + 1) is projective, we can, after
possibly making a ﬁnite change of base, ﬁnd a map β : Spec(R) ✲Hss
that agrees with α at η. By pulling back the universal curve over H
by β, we obtain a second curve C′ ✲Spec(R) whose generic ﬁber is
also Cη. By the uniqueness of the semistable reduction of a family
of stable curves, the stable models of the special ﬁbers C and C′ are
isomorphic. We cannot immediately assert that the curves themselves

C. Construction of Mg via the Potential Stability Theorem
237
are isomorphic since the Potential Stability Theorem only asserts that
C′ is moduli semistable. However, 
Kss is closed in Hss. Therefore,
since β(η) lies in 
Kssand β(0) lies in Hss, we conclude that β(0) also
lies in 
K. In other words, C′ is also n-canonically embedded and hence
must be moduli-stable. Thus C and C′ are both abstractly isomorphic
and projectively equivalent in Pr (C). But the Hilbert point [C′] is in
Hss by construction, hence so is [C].
Proposition (4.59) 
Kss = 
Ks: every curve whose Hilbert point lies
in 
Kss is Hilbert stable.
Every curve C whose Hilbert point lies in 
Kss is, by deﬁnition,
Hilbert semistable. If the Hilbert point of such a curve did not have
a closed SL(r + 1)-orbit, then its closure would contain a semistable
orbit with stabilizer of positive dimension by Exercise (4.13). Since ev-
ery curve whose Hilbert point lies in 
Kss is nondegenerate, this orbit
would correspond to a curve C′ with inﬁnitely many automorphisms,
and since 
Kss is closed in Hss, the Hilbert point of C′ would lie in 
Kss.
Since every such C′ is moduli stable and hence has only ﬁnitely many
automorphisms this leads to a contradiction. Thus every point of 
Kss
has closed orbit and ﬁnite stabilizer, which means that 
Kss = 
Ks as
desired.
We have therefore completed the construction of Mg. This proof
is based on a yoga due to Gieseker, which ought, morally, to be more
widely applicable. We wish to conclude by laying out the main steps
in his approach to constructing a compactiﬁcation of a moduli space
M for a set of smooth varieties. Gieseker’s idea is to use geometric
invariant theory, not merely as a technical tool to construct the right
scheme structure on the moduli space but also as a guide to under-
standing what class of degenerations should appear at the boundary.
The ﬁrst step in his plan is to show directly that suitable projec-
tive models of the varieties in M have stable Hilbert points. In our
example, this is the stability of smooth curves. Next, we try to elim-
inate possible candidates for the boundary points by showing that
they have unstable Hilbert points. Typically, this amounts to ﬁnding
restrictions both on the intrinsic geometry of varieties with semistable
Hilbert points and on how they are projectively embedded: here this
role is played by the Potential Stability Theorem. In one sense, this
step is easier than the ﬁrst step. As we’ve seen above, a destabilizing
ﬁltration F is generally closely tied to some more-or-less pathological
geometric property of the unstable variety and this makes the esti-
mation of the weight function wF(m) fairly easy. Proving a variety
stable, on the other hand, requires dealing with an arbitrary F; some
idea of just how difﬁcult this can be in higher dimensions, even for
smooth varieties, can be obtained by examining Gieseker’s tour-de-

238
4. Construction of Mg
force veriﬁcation of the stability of sufﬁciently pluricanonical models
of surfaces of general type [57]. In another sense, however, the sec-
ond step can be harder, since the number of nonsemistable cases to
be ruled out can be dauntingly large. Now comes Gieseker’s key idea:
whatever class of varieties we cannot by our best efforts eliminate
in the second step ought to form the boundary of the compactiﬁed
moduli space M. The ﬁnal step is to try to make this concrete by com-
bining valuative methods with a study of degenerations of elements
of M to these “potential” boundary varieties to yield an indirect proof
of their Hilbert stability. In the construction of Mg, this involves the
deformation theoretic results and the tricks with the valuative crite-
rion used in this section. A bonus of this approach is that, when it
works, the completion M is automatically projective.
All three steps pose substantial difﬁculties and represent a chal-
lenge for further study. Other than Mg, the only case in which this
program has been completely worked out is that of degenerations of
vector bundles on curves: see [127], [62] and [61]. It would be more
satisfying, but seems even harder, to modify the last step by verifying
directly the stability of the Hilbert points of varieties on the bound-
ary. As we’ve remarked earlier, this has not even been done for stable
curves.
Somewhat less precise results have been obtained for higher-
dimensional varieties of general type by rather different methods. We
close with a few brief pointers to the main results. For more details
and deﬁnitions of unfamiliar terms, see the cited references.
Viehweg has constructed a quasiprojective coarse moduli space
for smooth varieties of arbitrary dimension having ample canonical
divisor and ﬁxed pluricanonical Hilbert polynomial: his approach,
described in [148], is via G.I.T. but uses a strategy different from
Gieseker’s and yields slightly weaker existence results for curves and
surfaces than those obtained by Gieseker.
By combining this with ideas of Koll´ar which essentially replace the
further use of G.I.T. by methods from minimal model theory, Karu [90]
has recently shown that the minimal model program in dimension
n + 1 implies the existence of a projective coarse moduli space for
almost smoothable n-folds with semi-log-canonical singularities, am-
ple canonical divisor and ﬁxed pluricanonical Hilbert polynomial. The
keystone of his proof is a theorem of Koll´ar [99] which states that the
corresponding moduli functor is represented by a projective scheme
if it has various other expected properties — more precisely, if it
is bounded, locally closed, separated, complete, has tame automor-
phisms and has semi-positive canonical polarization.
Karu’s key innovation is the deduction of the boundedness of the
moduli functor — the existence of a family over a projective base in
which every such variety is a ﬁber — from the minimal model pro-

C. Construction of Mg via the Potential Stability Theorem
239
gram. His strategy, based on the notion of weak semistable reduction
introduced in Abramovich-Karu [1], avoids any need for G.I.T. but re-
mains close in spirit to the proof of of the projectivity of Mg given
here. It simpliﬁes earlier work of Alexeev in the surface case — see
Karu’s paper for details and all further references — and also relies
on an earlier boundedness theorem of Matsusaka and work of Kawa-
mata and Siu on invariance of plurigenera. The remaining properties
in Koll´ar’s criterion were known or follow fairly directly by combining
boundedness with work of other authors including Iitaka, Kleiman,
Koll´ar, Shepherd-Barron and Viehweg.
Exciting as this result is, it is only a step towards being able to
deal with moduli of higher-dimensional varieties as we do with those
of curves, even for surfaces where the minimal model hypothesis is
known. Much work remains before we have the explicit description
of the boundary so essential to nearly all the applications which fol-
low in the rest of this book. For example, no one has yet enumerated
the boundary divisors in the compactiﬁcation of the space of quintic
surfaces in P3.

Chapter 5
Limit Linear Series and
Brill-Noether theory
In this chapter, we want to illustrate how the moduli space of stable
curves can be used as a tool to prove theorems that deal with a single
curve. In most such applications, the role of the moduli space is to
allow us to deduce facts about certain smooth curves by studying
what happens when these curves undergo suitable degenerations.
As our example, we’ve chosen the theory of special linear series. We
will develop a theory of limits of linear series on some singular curves,
and use this to give proofs of the basic results of Brill-Noether theory.
A
Introductory remarks on
degenerations
Before getting to work, a few words are in order concerning the na-
ture of the theorems we will discuss, their history and their various
proofs. We ﬁrst recall the statements of the two most important re-
sults. The Kempf/Kleiman-Laksov/Grifﬁths-Harris/Brill-Noether the-
orem (which, following custom, we’ll henceforth refer to as simply
“Brill-Noether”) says that a general curve C of genus g carries a gr
d if
and only if the Brill-Noether number ρ = ρ(g, r, d) deﬁned by
(5.1)
ρ = (r + 1)(d −r) −rg = g −(r + 1)(g −d + r)
is nonnegative; and if so, then ρ is the dimension of the locus W r
d (C)
of such linear series in Picd(C). The Gieseker-Petri theorem says that
the multiplication map
(5.2)
µ0 : H0(L)

H0(K

L−1) ✲H0(K)
is injective for any line bundle L on a general curve C.

A. Introductory remarks on degenerations
241
Exercise (5.3) Show that a gr
d with negative ρ corresponds to a line
bundle L for which the domain of µ0 has dimension at least g + 1
and conclude that Gieseker-Petri implies the nonexistence statement
in Brill-Noether. Give an example of a line bundle L on a curve C for
which µ0 fails to be injective where this isn’t forced by dimensional
considerations (the ﬁrst such example occurs in genus 4).
What distinguishes these theorems from more elementary results
on linear series like Riemann-Roch and Clifford? The obvious answer
is that they aren’t true on every curve C of genus g: they apply only
to an open dense subset in, but not to all of, Mg. (This isn’t true of
the existence half of the Brill-Noether theorem (ρ ≥0 ⇒W r
d (C) ̸= ∅),
which was indeed the ﬁrst of the statements proved, independently
by Kempf and by Kleiman and Laksov: see [92], [95], [96] and [7]
for an overview. But it’s certainly true of the nonexistence half
(ρ < 0 ⇒W r
d (C) = ∅) and of the Gieseker-Petri theorem.) Moreover,
we have no independent way to characterize the loci over which they
do hold. It follows that any proof of such results must be fundamen-
tally different from proofs of the more elementary results, which take
place on an arbitrary, ﬁxed curve.
The most direct approach would be to work on a curve that is no
longer arbitrary but merely sufﬁciently general. Indeed, the fact that
these theorems concern conditions that are open on proper, smooth
families of curves and that we’re only required to prove them on an
open subset of Mgmeans that we could prove any one by exhibiting
a single smooth curve satisfying it. This doesn’t, however, seem to
help: as of this writing, no one yet knows how to write down for large
g (at least, say, 16), a single complete, smooth curve satisfying any
of these theorems. The curves we can write down for large g, such
as hyperelliptic and trigonal curves, complete intersections, and the
like, are invariably special with respect to all the properties that these
theorems assert to be general. (See, in this connection, the discussion
at the end of Section 6.F.)
One resolution of this problem is to work not on ﬁxed curves but
in families, so as to incorporate variational elements into the proofs.
This idea, as we shall see in a moment, goes back to the classical Ital-
ian geometers. However, their approach amounted to replacing the
search for general curves with one for general sets of Schubert cycles.
Once again, it turned out that all examples that can be analyzed ex-
plicitly are special. Although this path did eventually lead to a proof of
the Brill-Noether statement itself, it gradually became clear that more
reﬁned results like the Gieseker-Petri theorem would be possible only
with better control of both the families used and the linear series on
them. With hindsight, we can now see that what was needed was to
ﬁnd degenerations to curves that are sufﬁciently special that we can

242
5. Limit Linear Series and Brill-Noether theory
carry out the necessary analysis explicitly but that remain general in
the senses of the theorems. Such curves do exist, but all known exam-
ples are not merely singular but highly reducible. This explains why
the approaches to these problems via the theory of limit linear series
remained unexplored until the theory of stable curves had been de-
veloped and, incidentally, why, although their statements deal with a
single curve, they are naturally treated in a book on moduli of curves.
Let’s now examine this history a bit more closely. To begin with,
Brill and Noether asserted the truth of the theorem based, apparently,
on a naive dimension count bolstered by the calculation of examples
in low genus. Exactly how the desired variational element might en-
ter into the proofs was ﬁrst suggested by Castelnuovo. His goal was
not to establish any of the present theorems. Rather, he assumed the
statement of the Brill-Noether theorem and applied it to compute the
number of gr
d’s on a general curve in the case ρ = 0, when we expect
it to be ﬁnite. To do this, Castelnuovo looked not at any smooth curve
of genus g, but at a g-nodal curve C0: that is, a rational curve with g
nodes r1, . . . , rg obtained by identifying g pairs of points (pi, qi) on
P1. Any gr
d on C0, Castelnuovo reasoned, would pull back to a gr
d on
P1, which could then be represented as the linear series cut out on
a rational normal curve C ≊P1✲✲Pd of degree d by those hyper-
planes containing a ﬁxed (d−r −1)-plane Λ ⊂Pd. The condition that
the gr
d on P1 be the pullback of one on C0 was simply that every divi-
sor of the gr
d containing pi should contain qi as well; in other words,
Λ should meet each of the chords piqi to C in Pd. The number of gr
d’s
on a general curve of genus g was thus, according to Castelnuovo, the
number of (d−r −1)-planes in Pd meeting each of g lines, a problem
in Schubert calculus that Castelnuovo went on to solve (to obtain the
correct value for the number of gr
d’s on a general curve in [20]).
It was Severi who ﬁrst pointed out, some twenty years later, that
Castelnuovo’s computation might serve as the basis of a proof of the
Brill-Noether statement. Severi’s idea was to argue in two steps: ﬁrst,
if one had a family of curves {Ct} with C0 as above and Ct a complete,
smooth curve for t ≠0, then by upper semicontinuity of dimension we
should have dim

W r
d (Ct)

≤dim

W r
d (C0)

for general t; and second,
since the requirement that a (d −r −1)-plane Λ ⊂Pd meet a line in
Pd is a codimension r condition, we should have
dim(W r
d (C0)) = dim(G(d −r −1, d)) −rg
= (r + 1)(d −r) −rg
= ρ
Problems abound with both halves of this argument. First of all, if
one deﬁnes W r
d (C0) to be line bundles of degree d on C0 with r + 1

A. Introductory remarks on degenerations
243
or more sections, there one runs into the difﬁculty that the family
{W r
d (Ct)} may not be proper, simply because the family {Picd(Ct)}
isn’t; i.e., the limit of linear series need not be a linear series. (The
classic example of this is the g1
2 associated to the meromorphic func-
tion
y
x

on the cubic plane curve Ct given by y2 = x(x+1)(x−t) for t
different from 0 and (−1), or, equivalently, to the pencil cut out on Ct
by lines through the origin.) This difﬁculty may be overcome, as it was
ﬁrst by Kleiman [94], by using the fact that the varieties parameteriz-
ing torsion-free sheaves of rank 1 on Ct do form a proper family, and
that for each subset I = {i1, . . . , ik} ⊂{1, . . . , g} those torsion-free
sheaves on C0 that fail to be locally free exactly at {ri1, . . . , rik} are
direct images of invertible sheaves of degree d −k on the partial nor-
malization CI of C0 at {ri1, . . . , rik}. Since ρ(d−k, g−k, r) ≤ρ(d, g, r),
we need only verify the Brill-Noether statement dim(W r
d ) = ρ on all
the partial normalizations of C0.
As for the second half of Severi’s intended argument, it’s not the
case that the g sets of conditions on a (d−r −1)-plane Λ ⊂Pd that it
meet the chords piqi to C are algebraically independent — i.e., that the
corresponding Schubert cycles intersect in the expected codimension
rg in G(d −r −1, d) — for all choices of pi, qi ∈C. The simplest
example of this is the hyperelliptic case d = 2, r = 1. Here the g1
2’s
on the curve C0 correspond to points in P2 lying on each of the g
chords piqi to the conic C ⊂P2. If g = 2, of course there is always a
unique such point, corresponding to the fact that every genus 2 has
a unique g1
2. If g = 3, however, there may or may not exist such a
point, depending on the choice of the points pi, qi, corresponding to
the fact that while the general curve of genus 3 doesn’t possess a g1
2,
some do.
Once again, we might hope to overcome this problem by introduc-
ing a further variational element into the argument: that is, to con-
sider a further specialization of the points pi, qi ∈P1. As before, how-
ever, nobody knows, for large g, even a single choice of such points
for which the corresponding Schubert cycles are dimensionally trans-
verse. Hence, this approach must also involve a further degeneration
of the underlying curve. What worked in the end was to let the points
q1, p2, q2, p3, q3, . . . tend to p1, one at a time, in that order. This was
done by Grifﬁths and Harris in [65], who were able to conclude the
Brill-Noether statement.
Grifﬁths and Harris did not consider, in their paper, what happened
in the limit to the curve C0 as they carried out their degeneration.
There, the Brill-Noether problem had been transposed into a question
of whether certain Schubert cycles in G(d−r −1, d) intersected trans-
versely, and they were only concerned with the behavior, in the limit,
of those Schubert cycles. It was Gieseker, in his proof of Petri’s con-
jecture in [59], who ﬁrst thought to follow the curve C0 into the limit.

244
5. Limit Linear Series and Brill-Noether theory
Gieseker worked with a family of curves obtained by taking P1 × ∆t
and identifying sections pi(t) with qi(t) over ∆, with pi(t) and qi(t)
all distinct for t ≠0 and coming together with different orders of
contact with p1 at t = 0, as in Figure (5.4).
Figure (5.4)
In order to make sense out of “the curve C0 obtained by identifying
pi(t) with qi(t) on P1 × {t}” when t = 0, it’s natural before making
the identiﬁcations to blow up the point p1(0) until the sections be-
come disjoint. This results in a family shown in Figure (5.5).
After
Figure (5.5)
making the appropriate identiﬁcations, the resulting C0 looks like the
one pictured in Figure (5.6).
One beneﬁt of Gieseker’s approach is that if one applies a base
change to a family of curves degenerating to a curve of the type pic-
tured in Figure (5.6), and then minimally resolves the resulting singu-
larities of the total space, we again get such a family. We can also blow
up a node and make a double base change with the same effect. It fol-
lows, then, that any family of line bundles away from the central ﬁber
of such a family of curves may be assumed to be single-valued over

A. Introductory remarks on degenerations
245
Figure (5.6)
the base, and then to extend over the central ﬁber. Thus, the need to
deal with torsion-free sheaves as in Kleiman’s reworking of the ﬁrst
part of Severi’s argument is avoided. This beneﬁt comes at a price of
a new technical complication, however: we’re now dealing with linear
series on a reducible curve and have to develop a formalism for doing
this. Setting this up will occupy most of the remainder of this chapter.
In another, more or less orthogonal development, it was noticed
by Eisenbud and Harris ([37], [38]) that the proof of the Brill-Noether
statement could be substantially simpliﬁed by specializing to cuspi-
dal, rather than nodal curves. In its simplest case, cited above, of g1
2’s
on curves of genus 3, this amounts to the observation that, while three
chords to a conic in the plane may or may not be concurrent (in fact,
they are so in codimension 1), three tangent lines can never be. Thus,
while the Brill-Noether condition doesn’t hold for all nodal curves of
genus 3, it apparently does for all cuspidal rational curves. This phe-
nomenon is in fact general: as it turns out, the Pl¨ucker formulas ap-
plied to a linear series on P1 directly imply the Brill-Noether property
for an arbitrary g-cuspidal curve. (In the case of g1
2’s on curves of
genus 3, the relevant Pl¨ucker formula is just the Riemann-Hurwitz
formula, that a pencil of degree 2 on P1 cannot have more than two
branch points.)
In these circumstances, it’s natural to ask if it’s possible to prove
the Gieseker-Petri theorem via a specialization to a g-cuspidal curve.
This turns out to be not as easy as Brill-Noether: for one thing, it isn’t
true that every g-cuspidal curve satisﬁes Petri’s condition, and con-
sequently further degeneration is required. The obvious thing to do
is to let the cusps come together one at a time. On the other hand,
in order to analyze linear series on the limiting curve `a la Gieseker,
we’ll need to ﬁnd a well-behaved model for this limit by consider-
ing the semistable reduction of such a degeneration. Since cuspidal
curves aren’t themselves semistable, the ﬁrst thing to do is to apply
a semistable reduction to the family of curves specializing to a g-

246
5. Limit Linear Series and Brill-Noether theory
cuspidal one. This yields a family of smooth curves specializing to a
rational curve with g elliptic tails attached (shown as the “S”-curves in
Figure (5.7) and those that follow). Next, we can bring the points qi at
irreducible rational
backbone
elliptic tails
Figure (5.7)
which the tails are attached together one at a time (in effect, making
the cusps of the original family come together) to arrive at the curve
pictured in Figure (5.8). Finally, to allow for the possibility of further
rational chain
backbone
elliptic tails
Figure (5.8)
base change and/or blowing up of nodes and subsequent semistable
reduction, we generalize this to the curve X0 pictured in Figure (5.10).
In this diagram, all the components are rational except the g elliptic
tails on the at the right end of each chain.
These are the curves that we’ll use in our proofs of the Brill-Noether
and Gieseker-Petri theorems; we’ll call them ﬂag curves. Speciﬁcally,
we will show that:
Theorem (5.9) If π : X ✲B is any ﬂat projective family of curves
with smooth general ﬁber and special ﬁber X0 = π−1(b0) isomorphic
to a ﬂag curve, as pictured in Figure (5.10), then the general ﬁber of π
satisﬁes the Brill-Noether and Petri conditions (5.1) and (5.2).

B. Limits of line bundles
247
rational chain
backbone
elliptic tails
joined to backbone
by rational chains
Figure (5.10)
In fact, the Brill-Noether statement will be shown for a larger class of
curves: it will be true for the general member of any family of curves
that includes a curve composed of a tree of rational curves with g
elliptic tails attached. The Petri statement, however, will only be shown
for the speciﬁc conﬁguration of Figure (5.10).
We close this section by mentioning that there is another approach
to these questions due to Lazarsfeld [107], which we won’t go into here
but which is perhaps the most elegant. Lazarsfeld uses a beautiful
vector bundle argument to show that special linear series on certain
curves lying on K3-surfaces must be cut out by linear series on the
surface and is able to deduce that a curve whose class generates the
Neron-Severi group of such a surface must be general in the senses of
Brill-Noether and Gieseker-Petri.
B
Limits of line bundles
We begin by assembling some basic facts about line bundles on in-
dividual stable curves and families of them. Let’s consider, to begin
with, the group Pic(C) of line bundles on a connected but possibly
singular and/or reducible curve C. We will assume C is reduced, al-
though a description of the group of line bundles on a nonreduced
curve is a question of some interest as well. If we let π : C ✲C be the
normalization of C, then an essentially complete description of Pic(C)
is obtained by comparing the sheaf O∗
C of nonzero functions on C with
the pushforward π∗O∗
C of that of C. Speciﬁcally, the map π gives an
inclusion O∗
C✲✲π∗O∗
C. The quotient sheaf F is a skyscraper sheaf
supported at the singular points of C, whose stalks are fairly easy to
describe in terms of these singularities. Thus, for example, if p ∈C is

248
5. Limit Linear Series and Brill-Noether theory
an ordinary node, the stalk at p of π∗O∗
C consists of pairs of germs of
nonzero functions (f , g) on the two branches of C at p, the subgroup

O∗
C

p consists of those pairs with f(p) = g(p), and the quotient
Fp ≊C∗with the map

π∗O∗
C

p ✲Fp sending (f, g) to (f(p)/g(p)).
Similarly, if p is a cusp of C and t a local parameter on C around
p = π−1(p), then we can write the completion of the stalk

π∗O∗
C

p
simply as invertible power series {a0 + a1t + a2t2 + · · ·}, and the
subgroup

O∗
C

p as those power series with a1 = 0. We see then that
Fp ≊C, with the map

π∗O∗
C

p ✲Fp given by (a1/a0).
Exercise (5.11) 1) Verify that the map

π∗O∗
C

p ✲Fp given by
(a1/a0) is indeed a homomorphism.
2) Show that, for any p ∈C, the stalk Fp is an extension
0
✲Ca
✲Fp
✲
C∗b
✲0
where (b + 1) is the number of branches of C at p (that is, #π−1(p))
and a + b = dim

π∗O C/OC

p is the drop in genus associated to the
singularity, that is, the contribution at p to the difference in arithmetic
genus between C and C.
Having described F, we turn now to the exact sequence
0
✲O∗
C
✲π∗O∗
C
✲F
✲0.
Since C is connected, we have identiﬁcations
H0 
O∗
C

= C∗
H0 
π∗O∗
C

= (C∗)ν
where ν is the number of irreducible components of C. Using, for
example, the Leray spectral sequence, we may also identify
H1
O∗
C

:= Pic(C)
H1
π∗O∗
C

≊H1
O∗
C

= Pic( C) .
Putting these together, we obtain an exact sequence
(5.12)
0
✲C∗
✲
C∗ν
✲Γ(F)
✲Pic(C)
✲Pic( C)
✲0
in which the ﬁrst and last maps are just those induced by the pullback
of the normalization map π∗. This sequence may thus be interpreted
as saying:

B. Limits of line bundles
249
1. To specify a line bundle L on C, we have to specify its pullback
L = π∗L to C, plus give “descent data”, that is, specify when
a section of L is the pullback of a section of L. For example, if
p ∈C is a node with π−1(p) = {q, r} ⊂C, we have to give
an identiﬁcation ϕp : Lq ✲Lr of the ﬁbers of L over p as one-
dimensional complex vector spaces.
2. When L is trivial, this descent data corresponds to giving a coset
of O∗
C in π∗O∗
C. For example, if p is a node as above and we ﬁx
a trivialization of L near p, then ϕp is simply an element of C∗
as above.
3. The descent data are only determined up to our choice of trivi-
alization of L over the nodes, which we may alter by composing
a given trivialization with multiplication by a nonzero scalar on
each connected component of C.
4. However, altering the trivialization in this way by multiplication
by the same nonzero scalar on each component of C does not,
of course, change the descent data.
Finally, we see that in the analytic topology the coboundary map in
the exponential sheaf sequence
c1 : H1(C, O∗
C) ✲H2(C, Z) ≊Zν
carries a line bundle L on C to its degrees on each of the irreducible
components of C. We deﬁne Pic0(C), or J(C) called the Jacobian of
C to be the connected component of the identity in the Picard group
Pic(C), that is, the group of line bundles of degree 0 on every compo-
nent. We then have the sequence
(5.13)
0
✲C∗
✲
C∗ν
✲Γ(F)
✲J(C)
✲J( C)
✲0.
From this it’s usually straightforward to describe J(C) in terms of the
singularitites of C. Here are two ﬁrst examples.
Exercise (5.14) 1) If C is a g-nodal curve (that is, P1 with g pairs of
points identiﬁed), show that J(C) = (C∗)g.
2) If C is a g-cuspidal curve, show that J(C) = Cg.
More generally, suppose that C is any connected, reduced curve
whose only singularities are nodes. We may associate to C what is
called its dual graph Γ(C), a one-dimensional cell complex deﬁned as
follows. Take one zero-cell or vertex for each irreducible component of
C. Then, for each node of C attach a one-cell or edge by glueing the two
ends of the edge to the vertices (not necessarily distinct) associated

250
5. Limit Linear Series and Brill-Noether theory
Figure (5.15)
to the components containing the branches at that node. Thus, if C
is a g-nodal curve, its dual graph is a bouquet of g loops (shown in
Figure (5.15) for g = 4).
The dual graph lets us succinctly summarize what the sequence
(5.13) says about the Jacobian of C by noting that we have a sequence
0
✲
C∗b
✲J(C)
✲J( C)
✲0
where b is the ﬁrst Betti number of Γ(C). The g-nodal curve rep-
resents, for this sequence, one extreme, in which J( C) = {0} and
J(C) ≊(C∗)g. At the other extreme, we have nodal curves C satis-
fying the equivalent conditions:
1. J(C) is compact;
2. The sum of the geometric genera of the components of C is g;
3. The dual graph of C is a tree.
We will say such a curve is of compact type. In particular, note that if
C is of compact type, each irreducible component of C will be smooth,
and no two components will meet in more than one point. Note also
that the curve of Figure (5.10), which will be our main object of study,
is of compact type, with Jacobian
J =
g

i=1
J(Ei) =
g

i=1
Ei
where the Ei are the elliptic components of the curve.
Remark. While we’ve deﬁned the Jacobian of C as the group of line
bundles of degree 0 on C, it may also be deﬁned, in analogy with the
smooth case, as linear functionals on the space of global sections of
the dualizing sheaf ωC modulo those linear functionals arising from
integration over closed loops in C−Csing. This is immediate if we recall
from (3.5) that the sections of ωC over an open set U ⊂C are given by

B. Limits of line bundles
251
meromorphic one-forms ω on π−1(U) ⊂C such that for any p ∈U
and f ∈OC,p,

q∈π−1(p)
Resq(ω · π∗f) = 0,
so that integration of sections of ω over cycles avoiding the singular
points of C makes sense. As usual, we can write
J(C) =

H0
C, ωC
∨* 
H1

C −Csing, Z

.
In particular, an Abel-type theorem holds: two divisors, D =

pi and
E =

qi, supported on the smooth locus of C will be linearly equiv-
alent if and only they have the same degree on each irreducible com-
ponent of C, and if, after reordering so that pi and qi lie on the same
component, we can choose paths of integration γi from pi to qi for
which

i

γi
ω

= 0
for all ω ∈H0 (C, ωC).
Having described the group of line bundles on a singular curve, we
turn our attention now to families of line bundles on families of curves
acquiring a singularity. Speciﬁcally, for the remainder of this chapter,
we’ll be concerned with a projective, ﬂat family
π : X ✲B
over a smooth curve B. We also ﬁx a local parameter t at a point 0 ∈B
and assume that the ﬁber Xt = π−1(t) is smooth for t ≠0 and that
the special ﬁber X0, while possibly singular and/or reducible, is always
reduced. We will, in addition, work with families whose total spaces X
are smooth, though this is really a luxury in which we indulge mainly
to keep our statements as simple as possible.
What we want to develop are methods for obtaining information
about the behavior of linear series in the general ﬁber Xt of such a
family by looking at their “limits” on the central ﬁber X0. This raises a
second question, that of choosing a central ﬁber X0 so that informa-
tion about such limits is easy to obtain and work with. For example, we
might wish, as Castelnuovo suggested, to take X0 to be an irreducible,
g-nodal curve. One difﬁculty with this, and many other choices, is
that the limit of a family of line bundles on Xt may no longer be a
line bundle, reﬂecting the fact that the Jacobian of X0 need not be
compact. Put another way, when we take the closure of the variety
W r
d = {(t, L) : L ∈W r
d (Xt), t ≠0} over B −{0} in the family of Picard
varieties over B, the resulting scheme need not be proper over B.
One example of this is a family X ✲B of general curves Xt of
genus 4 specializing to a curve X0 with a node obtained by taking

252
5. Limit Linear Series and Brill-Noether theory
a hyperelliptic curve of genus 3 and identifying two points not con-
jugate under the hyperelliptic involution. (In this example, the family
is general if Xt is nonhyperelliptic and if its canonical image lies on a
smooth quadric Qt.) What will happen then as t goes to zero is that
the quadric Qt will specialize to a quadric cone Q0, and the canonical
image of Xt to the intersection of Q0 with a cubic passing through
the vertex P of Q0: in particular, X0 will have a node at P. Then, since
the g1
3’s on Xt are cut out by the rulings of Qt, W 1
3 will be a nice,
connected two-sheeted cover of B −{0} ramiﬁed only over 0. More-
over, since the lines on Q0 aren’t Cartier divisors and don’t restrict
to Cartier divisors on X0, W 1
3 will already be closed in the family of
Picard varieties: that is, the limit of the linear series determined by Lt
in W 1
3 (Xt) will not be a line bundle.
This difﬁculty will not arise if the line bundles Lt on each ﬁber Xt for
t ≠0 are restrictions of a single line bundle L on X \ X0. In this case,
since we’re assuming that the total space X is smooth, L will extend to
a line bundle on all of X and hence the limit as t ✲0 of the Lt will be
a line bundle. The problem here is that, in general, the single-valued
section of W r
d needed to deﬁne L may not exist, even if W r
d (Xt) is
nonempty for each t ≠0. For instance, in the example above, because
W 1
3 is a connected covering of B −{0}, the two g1
3’s on Xt cannot
be distinguished. Moreover, if we apply a base change to make {Lt}
single-valued, then the total space of X will become singular, and line
bundles on X −X0 no longer extend over all of X. Finally, if we resolve
the singularities introduced into X by a base change, then the central
ﬁber X0 becomes a reducible curve. This, as we shall see in the sections
that follow, introduces its own set of complications.
What can one do in this situation? The most natural thing to do
might be to try and describe the limits of line bundles and/or linear
series in families in which the total space is smooth and the central
ﬁber is irreducible. The answers aren’t too bad: the limit of a line
bundle is always a rank 1 torsion-free sheaf, and in the limit a linear
series may acquire a non-Cartier base divisor but will otherwise re-
main a bona ﬁde linear series on a partial normalization of X0. This
approach was, as discussed in Section A, the basis of the ﬁrst proofs of
the Brill-Noether theorem. Carrying out this program requires a fairly
large amount of machinery that doesn’t seem to give the Gieseker-Petri
theorem. The reason for this is that the Brill-Noether theorem deals
only with a general gr
d on a general curve: thus, by a suitable induc-
tion, we may avoid considering those Lt’s on Xt that fail to specialize
to line bundles. Petri’s statement deals with all gr
d’s on a general curve,
which forces us to handle all limiting gr
d’s.
Our approach here will be the opposite one: we’ll allow ourselves
to make base changes and to resolve singularities that this introduces
and, correspondingly, will allow X0 to be reducible. Having opened the

C. Limits of linear series: motivation and examples
253
door to the barn of reducible special ﬁbers, there is no reason why we
shouldn’t go to the other extreme from Castelnuovo and avoid, as far
as possible, the failures of properness discussed above by taking X0
to be of compact type. In the following section, then, we’ll develop
the theory of limit linear series, which describes limits of linear series
in families tending to such curves; and in the subsequent two sec-
tions we’ll use this theory to give proofs of the Brill-Noether and Petri
theorems.
C
Limits of linear series: motivation and
examples
As we indicated in the last section, we want to consider here limits
of linear series on a family of curves {Xt} specializing to a reducible
curve X0 with the restriction that X0 is of compact type. Our analysis
here will allow us to give a proof of the Brill-Noether theorem (5.1) at
the end of this section. In the ﬁnal two sections of this chapter, we’ll
use it to prove the harder Gieseker-Petri theorem [Theorem (5.78)].
We begin by considering the simplest possible case. Fix a one-
parameter family π : X ✲B of curves with smooth total space X,
smooth ﬁbers Xt for t ≠0, and central ﬁber X0 = Y ∪Z the union of
two smooth curves meeting at a single point p. B itself we’ll take to be
small enough to have trivial Picard group, e.g. a disc or the spectrum
of a discrete valuation ring. We saw in the last section that, in general,
a family of line bundles on the smooth ﬁbers of such a degenerating
family need not extend to a line bundle on the singular one. By con-
trast, what seems to be the difﬁculty in this case isn’t the absence of
an extension of a given line bundle L on 
X = X \ X0 to X, but rather
the presence of too many, no one of which really captures all the ge-
ometry of the linear series on Xt. Precisely, if L is a line bundle on 
X
there will always exist a line bundle L on X extending L; but if L is
any such bundle then so is the line bundle L(Y) = L

OX(Y).
To compare L and L(Y), note that the line bundle OX(Y) clearly
restricts to the line bundle OZ(p) on Z. On the other hand, OX(X0) is
trivial, so OX(Y) = OX(−Z) and hence OX(Y) must restrict to OY (−p)
on Y. Thus, if L has degree α on Y and d −α on Z, the line bundle
L(Y) will have degree α −1 on Y and d −α + 1 on Z. In other words,
we see that for given L on 
X of relative degree d, there exists, for
every α ∈Z, a unique extension Lα of L to X having degree α on Y
and d −α on Z.
More generally now, suppose we assume only that X0 is a nodal
curve whose dual graph is a tree, and that Y and Z are components of
X0 meeting at a point p. By hypothesis, X0 −{p} has two connected

254
5. Limit Linear Series and Brill-Noether theory
components; let E be the union of the components of X0 lying in the
connected component of X0 \ {p} containing Y. Then the line bundle
OX(E) will have restrictions
(5.16)
OX(E)

OZ = OZ(p) ,
OX(E)

OY = OY (−p)
and
OX(E)

OW = OW
for any component W of X0 other than Y and Z.
Let Ad be the set of integer-valued functions on the set of irreducible
components of X0 whose values sum to d. It follows that: if L is any
line bundle of relative degree d on 
X and if α is any element of the set
Ad, then there exists a unique extension Lα of L to X such that
(5.17)
deg(Lα

OY ) = α(Y)
for every component Y of X0. If, moreover, Y and Z are two components
of X0 meeting at the point p, and β is obtained from α by adding 1 to
α(Y) and subtracting 1 from α(Z), then
(5.18)
Lβ

OY = Lα

OY (p)
and
Lβ

OZ = Lα

OZ(−p) .
This completely answers the question of what data we get in the limit
from a family of line bundles of degree d on the family of curves Xt.
We get a collection of line bundles, indexed by Ad, satisfying rela-
tions (5.17) and (5.18) above.
Observe that such a collection of data depends only on the curve
X0 itself and not on the particular family Xt specializing to it. This
phenomenon is special to limiting ﬁbers of compact type; for a family
specializing to a general nodal curve, what constitutes a limit of line
bundles will depend on the family.
We come now to the main question of interest: suppose that we have
not just a line bundle Lt on the general ﬁber Xt of our family, but a
linear series Vt ⊂H0(Xt, Lt) — in other words, we are given a line
bundle L on 
X together with a locally free subsheaf 
V ⊂π∗( L) of
rank r +1. What data on X0 can we associate to such a family that will
provide information about the limiting geometry of the linear series
Vt as t ✲0?
One natural answer to this question would be to look at all possi-
ble limits of the family L of line bundles and at the corresponding
linear system in each. For each α ∈Ad, we have an extension Lα; the
subbundle 
V ⊂π∗( L) will extend to a subbundle Vα ⊂π∗(Lα); and

C. Limits of linear series: motivation and examples
255
hence the linear series Vt have a limit Vα ⊂H0(X0, Lα

OX0) (that is,
the ﬁber of the sheaf Vα over 0). The upshot is that we again have a
collection of limiting linear series Vα indexed by Ad.
The problem with this approach is that this data is both redundant
and inconvenient to manage. Fortunately, as we’ll see, it’s not neces-
sary to look at all these linear series. For the most part, it’s sufﬁcient
to focus on a much smaller subset of the set of linear series Vα. For
each component Y of X0, we denote by LY the unique extension of L
to X with degree d on Y and degree 0 on all other components of X0
and we let
VY = lim
t ✲0(Vt) ⊂H0
X0, LY

OX0

.
These extensions have the immediate advantage (over those given by
general α) that a section of LY vanishing on Y vanishes on all of X0,
so that we have an inclusion
VY ⊂H0
X0, LY

OX0

⊂H0
Y, LY

OY

.
Thus we can view VY as a gr
d on the smooth curve Y, rather than on
all of X0. Anticipating the formal deﬁnitions of the next section, we’ll
refer to VY as the limiting aspect of 
V on Y. To sum up: Associated
to a linear series gr
d(t) on the general ﬁber Xt of X is a collection of
limiting aspects VY that are gr
d’s on the various components Y of X0.
The logical next question now becomes, what is the relationship
among the various linear series VY arising in this way? To answer
this, let’s again look ﬁrst at the case in which X0 has just two compo-
nents Y and Z meeting at a point p; let Lα be the extension of a line
bundle L to X having degree α on Y and d −α on Z. Recall that the
various extensions Lα are related by Lα = Lα+1(−Z) on Y. In other
words, the linear series |Lα| on the total space X is just the subseries
of |Lα+1| containing the component Z with this ﬁxed component re-
moved. Thus, if D is any divisor in |Lα|, then
D + Z ∈|Lα+1| ,
and if D doesn’t contain Y, then
(D + Z) Y = D Y + p .
This immediately gives the containments of linear series:
(Vα+1) Y ⊃(Vα) Y + p
or, dually,
(Vα) Y ⊂(Vα+1) Y −p .
(Here and in the sequel we denote by V(−D), or simply V −D, the
linear subseries of V obtained by imposing the base point condi-
tion given by the effective divisor D, and then subtracting D; that
is, V(−D) = {E −D : E ∈V and E −D ≥0}.)

256
5. Limit Linear Series and Brill-Noether theory
These containments explain why, for most purposes, it sufﬁces to
look at the extreme linear series VY = (Vd) Y and VZ = (V0) Z intro-
duced above, since they show us that
(Vα) Y ⊂VY (−(d −α)p)
and
(Vα) Z ⊂VZ(−αp) .
Further, these inclusions give rise to the basic relations between VY
and VZ. Since dim(Vα) = r, we must have
(5.19)
dim(Vα Y )+ dim(Vα Z)
= dim(VY (−(d −α)p)) + dim(VZ(−αp))
≥



r ,
if p is not a base point of Vα
r −1 , if p is a base point of Vα .
Happily, there is a more convenient way to express such relations.
For any linear series V on a curve Y and any smooth point p ∈Y, we
introduce the vanishing sequence
0 ≤a0(V, p) < a1(V, p) < · · · < ar (V, p) ,
which is deﬁned by the condition that, as sets, the aj(V, p)’s are just
the orders with which nonzero elements of V vanish at p:
!
aj(V, p)
&&i = 0, . . . , r
"
=
!
ordp(σ)
&&σ ̸= 0 ∈V
"
.
Vanishing sequences encode information about how the map
ϕV : Y ✲Pr associated to V is inﬂected at p. For example, a0(V, p)
is just the multiplicity with which p occurs as a base point of V. More
generally, we have
(5.20)
dim

V(−bp)

= r −i ⇐⇒ai−1(V, p) < b ≤ai(V, p) .
Thus, to say that V has no base point at p means that a0(V, p) = 0;
assuming this is the case and that ϕV is birational onto its image,
to say that ϕV(Y) doesn’t have a cusp at P = ϕV(p) means that
a1(V, p) = 1; and in this case, if r = 2, to say that P isn’t a ﬂex
of ϕV(Y) means that a2(V, p) = 2. For a general p, we expect no
inﬂectionary behavior in V and hence that
ai(V, p) = i,
i = 0, 1, . . . , r .
This suggests deﬁning the ramiﬁcation sequence
bi(V, p) of the
point p as the difference between the vanishing sequence at p and
the generic one
bi(V, p) = ai(V, p) −i,
i = 0, 1, . . . , r ,

C. Limits of linear series: motivation and examples
257
and the ramiﬁcation index bi(V, p) of p as the sum
β(V, p) =
r
i=0
bi(V, p) .
The classical Pl¨ucker formula (cf. Exercise 1.C.13 of [7]) then gives a
global measure of the ramiﬁcation of V at all points:
Lemma (5.21) (Pl¨ucker formula) If V is any gr
d on a smooth curve
Y of genus g,

p∈Y
β(V, p) = (r + 1)d + (r + 1)r(g −1) .
In the context of limit linear series, vanishing sequences provide a
convenient way to encode the relation between the aspects VY and VZ
expressed in (5.19), which in view of (5.20), immediately translate to
the inequalities:
(5.22)
ai(VY , p) + ar−i(VZ, p) ≥d,
i = 0, 1, . . . , r .
This is a strong condition on the pair of linear series VY , VZ. For
instance, if a0(VY , p) = 0 (that is, p is not a base point of VY ), then
this implies VZ(−dp) ≠∅, so that ar (VZ, p) = d; this implies that p
is a highly inﬂected point for the linear series VZ on Z. In fact, (5.22) is
often a sufﬁcient, as well as a necessary, condition for a pair of linear
series VY and VZ to arise as limits of linear series on smooth curves
tending to X0.
We remark here that, as we’ll verify shortly, (5.22) holds more gener-
ally for the collection {VY } of aspects we obtain from a family of linear
systems on curves tending to a nodal curve X0 of compact type: if Y
and Z are any two components of X0 meeting at a point p, then we
must have
ai(VY , p) + ar−i(VZ, p) ≥d
for all i.
To make these notions more concrete, let’s look at an example that
sheds light on the contrast between irreducible and reducible limit
curves. Suppose we have a family π : X ✲B of curves specializing to
a g-cuspidal curve X0, a family L of line bundles on X −X0, and a
linear series
Vt ⊂H0(Xt, Lt)
on Xt for t ≠0. Let P1 = X0 ✲X0 be the normalization of X0. We
consider the pullback to P1 of divisors D ∈| L|. These do in fact form
a linear system V0 on P1, which may be described as follows. For each
cusp pi of X0, the limit as t ✲0 of the line bundles Lt, which is a priori

258
5. Limit Linear Series and Brill-Noether theory
just a torsion-free sheaf on X0, may or may not, in fact, be locally free
at pi. If it is, then the series V0 will factor through the map π : P1 ✲X0
near pi. Informally, the linear series V0 “has a cusp” at the point pi
over pi. If this limiting line bundle fails to be locally free at pi, then
the limiting linear series need no longer factor through π near pi but,
if it doesn’t, it must have a base point at pi. We can cover both these
possibilities by the statement
a1( V0, pi) ≥2 .
Equivalently, 2 pi imposes only one condition on
V0, which we
rephrase informally as “ V0 has at least a cusp at pi”.
Let’s now compare this to what happens after we make a base
change of order 6 and minimally resolve the singularities of the re-
sulting surface. The central ﬁber X0 of the resulting family consists
of a copy of P1, which we’ll call Y and which is the normalization of the
original g-cuspidal curve, plus g elliptic curves E1, . . . , Eg attached to
Y at the g points pi which were formerly cusps. Now, the limit of the
line bundles Lt is always locally free. We will analyze it along the lines
of the preceding discussion but without the results we’ve obtained in
general.
Let LY be the limiting line bundle having degree d on Y and degree 0
on each Ei, and let VY be the restriction to Y of the linear series
V0 = lim
t ✲0 Vt ⊂H0(X0, LY )
on X0. Thus VY is a linear series of degree d and dimension r on
Y ≊P1, and to describe it we may use the analysis above, as follows.
For each i, there are the two possibilities for LY Ei. If LY Ei ≠OEi, i.e.,
is nontrivial, then H0(Ei, LY

OEi) = 0, so that every section of LY on
X0 vanishes on Ei. Correspondingly, VY has a base point at pi.
The case LY Ei = OEi is the more interesting possibility. In this
case, we want to consider also the limiting line bundles Li having
degrees d −1 on Y, 1 on Ei, and 0 on Ej for j ≠i, and the corre-
sponding limiting linear series V0,i in H0(X0, Li). The point is that the
line bundle
Li Ei = OEi(pi)
still has only one global section that vanishes at pi. On the other hand,
the linear series V0,i restricted to Y has dimension at least r −1 and is
contained in V0(−pi). Since dim(V0,i) = r, we conclude that V0,i must
have a base point at pi; i.e., 2pi imposes only one condition on VY .
Our conclusion, then, about the limiting series VY remains as it was
for the linear series V0 on P1 in the ﬁrst analysis: the series VY must
have at least a cusp at each pi.
Observe, ﬁnally, that this conclusion about VY may be obtained di-
rectly from the relation (5.22): if VEi is the limiting gr
d on Ei, we cannot

C. Limits of linear series: motivation and examples
259
have two sections of VEi vanishing to order d−1 at pi, since otherwise
the pencil they spanned would be a g1
1 plus the ﬁxed divisor (d−1)pi.
Thus
ar−1(VEi, pi) ≤d −2 ,
and by (5.22), we conclude
a1(VY , pi) ≥2;
so VY has at least a cusp at pi.
With this as motivation, we now want to go back and rederive the
basic relation (5.22), this time algebraically and for arbitrary X0 of
compact type. As before, we’ll let Y and Z be two components of
X0 meeting at a point p; again, we’ll denote by E and F the divisors
consisting of the sum of the curves in the connected components of
X0 \ {p} containing Z and Y respectively. Then by (5.16), for any line
bundle L on X\X0, we have
(5.23)
LY ≊LZ(dE)
and
LZ ≊LY (−dE) .
Now, suppose we’re given a family of divisors Dt ∈|Lt| for t ≠0 —
i.e., a divisor D ∈| L| on X\X0 — and we’re asked to ﬁnd the limit as t
approaches 0 of (Dt) as a divisor in the linear series |LZ

OZ|. To do
this, we simply write D = (σ) and Dt = (σ) Xt for some section σ of
L over X\X0, and then multiply σ by the (unique) correct power of t
so that it extends to a holomorphic section σZ of LZ on all of X, not
vanishing identically on X0. If σZ X0 ≠0 we must have σZ Z ≠0, and
then, of course, the limit of the Dt is the divisor (σZ Z).
In terms of this prescription, it’s easy to relate the limit of the Dt
as a divisor in |LY

OY | to the limit in Z: in view of (5.23), the section
σY of LY extending σ is obtained by multiplying σZ by the section of
OX(dE) vanishing d times on E, then dividing by the highest power
tα of t that divides the product. Equivalently,
(5.24)
(σY ) = (σZ) + dE −αX0
= (σZ) + (d −σ)E −αF
where α is determined by the requirements that (σY ) be effective, but
that (σY ) −X0 not be.
To go in the other direction is even easier: by (5.23), we may view
LZ as a subsheaf of LY . Given σY , σZ will simply be tασY where α
is the smallest integer such that tασY ∈Γ(LZ); that is, the smallest
integer such that (σY ) + αX0 ≥dE. Note that this requirement means
that (σY ) ≥(d −α)E, so that in particular the order of vanishing
ordp

σY Y

≥d −α.

260
5. Limit Linear Series and Brill-Noether theory
Similarly, by (5.24) we see that (σZ) ≥αF, and hence
ordp

σZ Z

≥α.
We combine these in the:
Lemma (5.25) If σY ∈Γ(LY ) and σZ ∈Γ(LZ) with neither vanishing
identically on X0 and (σY ) = (σZ) on X\X0, then σZ = tασY and
d −ordp

σY Y

≤α ≤ordp

σZ Z

.
We remark for future use that as a consequence we have, trivially
(5.26)
ordp′
σY Y

≤ordp

σZ Z

where p′ is any other point of Y, since ordp′(σY Y ) + ordp(σY Y ) ≤d.
To see how the linear series VY and VZ relate to one another, we use
a second lemma.
Lemma (5.27) There exist sections σ0, . . . , σr of LY and τ0, . . . , τr of
LZ generating π∗LY and π∗LZ such that:
1) In terms of the inclusion LZ ⊂LY , τi = tαiσi.
2) The orders ordp(σi Y ) are all distinct.
Proof.
The matrix expressing the inclusion of free OB,0-modules
π∗LZ ✲π∗LY can be diagonalized over OB,0 by Gaussian elimination;
this yields bases σi and τi satisfying condition 1). Moreover, if g(t) is
holomorphic on B and αi ≥αj, we can replace σi by σi + gσj, and τi
by tαi(σi + gσj) without affecting 1); such transformations allow us
to achieve 2) as well.
We can express our conclusions in terms of the vanishing sequences
of VY and VZ by applying (5.25) and (5.26) to the bases for VY and VZ
found in Lemma (5.27). The result is:
Theorem (5.28) Let π : X ✲B be a family of curves over a smooth,
one-dimensional base, with general ﬁber smooth and special ﬁber X0
a curve of compact type. Let Y and Z be irreducible components of X0
meeting at a point p. Let L be a line bundle on X\X0, V ⊂π∗L a family
of gr
d’s on X\X0, LY [resp. LZ] the unique extension of L to X having
degree d on Y [resp. Z] and degree 0 on all other components of X0,
and VY [resp. VZ] the limit of V in H0(Y, LY ) [resp. H0(Z, LZ)]. Then
ai(VY , p) + ar−i(VZ, p) ≥d.

C. Limits of linear series: motivation and examples
261
Proof.
The previous two lemmas imply that, for some permutation
ρ of {0, . . . , r}
ar−i(VZ, p) ≥d −aρ(i)(VY , p) .
The theorem then follows by applying the following lemma.
Lemma (5.29) If a0 < a1 < · · · < ar and b0 < b1 < · · · < br are
sequences and for some permutation π of {0, . . . , r}, we have ai ≥bπ(i)
for all i, then ai ≥bi for all i.
This analysis actually yields a slight reﬁnement for which we’ll have
use later.
Lemma (5.30) Let Y, Z and p be as above, and let p′ be any point of
Y other than p. Then,
1) ai(VZ, p) ≥ai(VY , p′);
2) Equality holds in 1) for at most as many values of i as there are
independent sections of VY vanishing only at p and p′.
We also note that, by summing the inequalities of (5.28) over i and
expressing the result in terms of ramiﬁcation indices, we obtain:
Corollary (5.31) Let Y, Z and p be as above. Then,
β(VY , p) + β(VZ, p) ≥(r + 1)(d −r) .
To see how this sort of analysis is applied in practice, let’s use it
to prove the Brill-Noether theorem, redeeming our earlier promise to
do so. We start by taking X0 to be any semistable curve of genus g
consisting of a tree of N rational curves Yi, to which g elliptic curves
Ei are attached, with each Ei attached at one point pi and the points pi
distinct: for example, the curve in Figure (5.10) will do. Let π : X ✲B
be any smoothing of the curve X0. We claim that for general t ∈B, the
ﬁber Xt satisﬁes the Brill-Noether condition dim W r
d (Xt) ≤ρ.
To prove this, suppose we have a family of gr
d’s on the smooth ﬁbers
of X, given as above, and consider the limit linear series associated to
it. (Note that, if the general ﬁber Xt has a gr
d, we can always assume
we have such a family after making a base change and blowing up:
the new central ﬁber will have more components but will still meet
the conditions above.)
By the Pl¨ucker formula (5.21), the total ramiﬁcation of each of the
aspects |VYi| of our limiting gr
d on any of the rational components of
X0 is (r +1)(d−r). On the other hand, since the elliptic curves Ei don’t
have any rational functions with only one pole, the vanishing sequence

262
5. Limit Linear Series and Brill-Noether theory
of the aspect |VEi| at the point pi will be term-by-term bounded by the
sequence
(5.32)
(d −r −1, d −r, . . . , d −3, d −2, d)
and the ramiﬁcation index of |VEi| at pi is therefore at most
(r + 1)(d −r) −r. Thus the sum of the ramiﬁcation indices of the
aspects of the limiting gr
d at the nodes of X0 is at most
(N + g)(r + 1)(d −r) −rg .
But the curve X0 has N + g −1 nodes, and at each of those nodes
the sum of the ramiﬁcation indices of the relevant aspects must be at
least (r + 1)(d −r) by Corollary (5.31). We must therefore have
(N + g)(r + 1)(d −r) −rg ≥(N + g −1)(r + 1)(d −r) ;
i.e., (r + 1)(d −r) ≥rg; or, equivalently, ρ ≥0. This proves that the
general curve Xt possesses no gr
d’s with ρ < 0.
To complete the proof, observe that equality can hold in the inequal-
ity (5.32) above only if the line bundle LEi restricted to Ei is isomorphic
to OEi(d · pi), or, equivalently, if for any rational component Y of X0
the line bundle LY restricted to Ei is trivial. It follows that if our family
of gr
d’s has Brill-Noether number ρ, then the line bundle LY will have
to be trivial on at least g −ρ of the curves Ei. In terms of the identi-
ﬁcation of the Jacobian of X0 with the product of the elliptic curves
Ei, this says that the limit in Picd(X0) of the varieties W r
d (Xt) will be
supported on the union of the ρ-dimensional coordinate planes, and
hence that
dim(W r
d (Xt)) ≤ρ .
We remark that the same method can be used to prove the existence
of gr
d’s on a general (and hence on every) curve of genus g whenever
ρ(g, r, d) ≥0. We won’t do this here since the methods of Kempf,
Kleiman-Laksov and Fulton-Lazarsfeld (as described in [7]) yield more
information; but there are times when we may want to use this ap-
proach to prove the existence of linear series satisfying some addi-
tional conditions. We will illustrate this in a series of exercises proving
the existence of curves with certain special Weierstrass points [Exer-
cise (5.48)]. To do this, however, we must ask a basic question: when,
conversely, does a collection of linear series {VY } on the components
of a curve X0 of compact type, satisfying the inequalities of Theo-
rem (5.28), actually arise as the limit of a family of gr
d’s on smooth
curves Xt tending to X0? We will give the best known answer to this
[Theorem (5.41)] after ﬁrst introducing the necessary formalism in the
following section.

D. Limit linear series: deﬁnitions and applications
263
D
Limit linear series: deﬁnitions and
applications
In this section, the results of the previous section are formalized in
the theory of limit linear series. While we won’t give a complete ac-
count of this theory here, we indicate the basic statements and a few
applications; in particular we’ll reinterpret and give a stronger form
of the Brill-Noether theorem.
Limit linear series
The ﬁrst thing to do is to make a precise deﬁnition:
Deﬁnition (5.33) Let X be a curve of compact type. A limit linear
series D of degree d and dimension r on X assigns to every irreducible
component Y of X a linear series |VY | of degree d and dimension r
called the aspect of D on Y, such that for every pair of components Y,
Z ⊂X meeting at a point p the aspects VY and VZ satisfy
(5.34)
ai(VY , p) + ar−i(VZ, p) ≥d.
We will say the limit linear series D is reﬁned if equality holds in (5.34)
for each i; we’ll call it crude otherwise.
The notion of ramiﬁcation is central to the theory of limit linear
series. Given a smooth point p on a curve X of compact type, and a
limit linear series D on X, we deﬁne the ramiﬁcation sequence of D
at p to be just the ramiﬁcation sequence at p of the aspect of D on
the component of X containing p.
The results of the previous section amount to saying that in a one-
parameter family {Xt} of curves of compact type with smooth total
space, a linear series Dt on the general ﬁber specializes to a limit linear
series D on the special ﬁber. We observe as well that a smooth point
of the special ﬁber X0 will be a ramiﬁcation point for D if and only
if it’s the limit of ramiﬁcation points of Dt; further, the ramiﬁcation
index of D at p will be the sum of the ramiﬁcation indices of Dt at
points of Xt tending to p.
This ties in nicely with the Pl¨ucker formula (5.21): the linear series
Dt will have a total of (r + 1)d + r(r + 1)(g −1) ramiﬁcation points
(counting multiplicity), while if X0 has components Yi of genera gi, we
expect (r + 1)d + r(r + 1)(gi −1) ramiﬁcation points of the aspect of
D on Yi. Of course, some of the ramiﬁcation of the VYi will occur at the
nodes of X0 lying on Yi: by (5.34), the sum of the ramiﬁcation indices
at a node of X0 of the aspects of D on the two components containing
the node will be at least (r + 1)(d −r); if X0 has k components, and

264
5. Limit Linear Series and Brill-Noether theory
hence k−1 nodes, this will account for a total of (k−1)(r +1)(d−r)
ramiﬁcation points of the aspects of D. The total ramiﬁcation of the
aspects of D at smooth points of X0 is thus at most

i

(r + 1)d + r(r + 1)(gi −1)

−(k −1)(r + 1)(d −r)
= (r + 1)d + r(r + 1)(g −1) ;
comparing this with the number of ramiﬁcation points of Dt we con-
clude that the limit linear series D is reﬁned if and only if no node of X0
is a limit of ramiﬁcation points of Dt. Note that as a consequence we
can always achieve this state after blowing up our family at nodes of
the special ﬁber, and then making further base changes and blowups
to resolve the resulting singularities.
The calculation above suggests the following deﬁnition:
Deﬁnition (5.35) The adjusted Brill-Noether number ρ of a linear
series D on a smooth curve X with respect to a given collection of points
pj ∈X is deﬁned to be the ordinary Brill-Noether number of D minus
the sum of the ramiﬁcation indices of D at the points pj.
The idea behind this deﬁnition is to generalize the variety Gr
d pa-
rameterizing linear series of degree d and dimension r. Just as Gr
d is
determinantal and either empty or of dimension at least ρ, so given
any collection of points p1, . . . , pk ∈C and, for each pj, a ramiﬁca-
tion sequence bj = (bj
0, . . . , bj
r ) summing to βj, we have a variety
Gr
d(p1, . . . , pk; b1, . . . , bk) parameterizing linear series with ramiﬁca-
tion sequence at least bj at pj, and this variety will again be deter-
minantal and either empty or of dimension at least ρ −

j βj. When
equality holds, we say the limit linear series is dimensionally proper.
We deﬁne in the same way the adjusted Brill-Noether number of a
limit linear series D on a curve X of compact type with respect to a
collection of smooth points. In these terms, the calculation above says
that:
Lemma (5.36) The adjusted Brill-Noether number of a limit linear se-
ries D on a curve X of compact type with respect to a collection of
smooth points pi ∈X is equal to the sum, over the components Y of
X, of the adjusted Brill-Noether numbers of the aspects of D on Y with
respect to the union of the subset of the pi on Y and the nodes of X
lying on Y.
This is useful because in the case of curves of genus 0 or 1, it’s
not hard to estimate adjusted Brill-Noether numbers. Two frequently
useful estimates are

D. Limit linear series: deﬁnitions and applications
265
1. Since the sum of the ramiﬁcation indices of a gr
d on P1 at all
points is (r +1)(d−r), which is exactly equal to the Brill-Noether
number of the gr
d, the adjusted Brill-Noether number of any linear
series on P1 with respect to any collection of points is nonnegative.
2. Similarly, the adjusted Brill-Noether number of a linear series on
an elliptic curve with respect to any one point is nonnegative.
Combining these facts with the statement above, we deduce that
if X is a curve of compact type formed by attaching g elliptic tails
to a tree of rational curves, and p1, . . . , pk are points lying on rational
components of X, then the adjusted Brill-Noether number of any limit
linear series on X with respect to the points pi is nonnegative. By
specialization to such curves, we arrive at the following generalization
of the Brill-Noether theorem:
Theorem (5.37) Let C be a general curve of genus g, and p1, . . . , pk
general points of C. Then the adjusted Brill-Noether number of any
linear series on C with respect to the points pj is nonnegative, i.e., for
any linear series D on C the sum of the ramiﬁcation indices of D at
the pj is at most ρ = g −(r + 1)(g −d + r). Moreover, for any collec-
tion of k ramiﬁcation sequences, the variety Gr
d(p1, . . . , pk; b1, . . . , bk)
will have dimension exactly ρ −

βi
j when it’s nonempty; that is, all
limit linear series with nonnegative adjusted Brill-Noether number are
dimensionally proper.
Exercise (5.38) Complete the argument given above by proving the
dimension assertion in the last sentence.
Exercise (5.39) 1) Show that, if a general curve of genus g has a gr
d
with ramiﬁcation sequence (b0(p), . . . , br (p)) at a general point p,
then ρ(g, r, d) ≥β(p). Give an example that shows that this condition
is not sufﬁcient for the existence of such a gr
d.
2) Show that the inequality ρ(g, r, d) ≥β(p) is equivalent to
r
i=0

bi(p) + (g −d + r)

≤g .
We may extend the results on limit linear series to a slightly larger
class of stable curves, which we’ll call treelike curves. Brieﬂy, we call
a node of a stable curve C an interior node if its two branches belong
to the same irreducible component of C, and deﬁne a stable curve
C to be treelike if the normalization of C at its interior nodes is of
compact type. A nomenclatural warning is perhaps in order here. The
dual graphs of most treelike curves are not trees; rather, their dual

266
5. Limit Linear Series and Brill-Noether theory
graphs become trees after removing all “loops” (edges joining a vertex
to itself).
Treelike curves share with curves of compact type (i.e., those whose
dual graphs are trees) the basic property that, if a family of line bun-
dles of degree d on a family of smooth curves specializing to a treelike
curve C0 has a line bundle as limit, then it also has a limit with arbi-
trarily assigned degrees (adding up to d) on the components of C0.
(The difference is the need for the “if” clause: a family of line bundles
on a family of smooth curves specializing to a treelike curve need not
have a line bundle as limit.) We may then deﬁne a limit linear series on
a treelike curve just as we do for curves of compact type, and likewise
the ramiﬁcation sequence of a limit linear series at a smooth point. As
the following exercise shows, the basic property of curves of compact
type — that a limit of smooth curves possessing linear series with
negative Brill-Noether number must possess a limit linear series with
negative ρ — holds as well for treelike curves, after a fashion.
Exercise (5.40) Let π : X ✲B be a family of curves with smooth total
space and treelike special ﬁber X0. Show that if the general ﬁber of π
possess a gr
d with ρ < 0, then the partial normalization of X0 at some
subset of its interior nodes possesses a limit gr
d with ρ < 0 as well.
Hint: A family of line bundles on such a family of curves will have as
limit a torsion-free sheaf on X0. Consider the subset of interior nodes
of X0 at which this sheaf fails to be locally free.
Smoothing limit linear series
In the preceding and subsequent sections, we’ve used our analysis of
the behavior of a linear series as the curve carrying it degenerates
to obtain restrictions on the existence of individual series and on the
dimensions of families of them. We would now like to turn these ideas
around and use our analysis to show the existence of certain linear
series on smooth curves. In other words, we ask: when does a limit
linear series on a curve X0 actually occur as the limit of linear series
on a family Xt of smooth curves specializing to X0.
The answer to this question in its full generality isn’t known. On
the one hand, there are examples of limit linear series that cannot be
smoothed. On the other, we have techniques for proving the smootha-
bility of such series under fairly mild hypotheses, which we’ll now
describe.
The key construction is that of a scheme parameterizing limit linear
series. Just as for any smooth curve X there exists a scheme Gr
d(X)
parameterizing linear series of degree d and dimension r on X (cf. [7]),
so there exists for any curve of compact type a scheme parameterizing

D. Limit linear series: deﬁnitions and applications
267
limit linear series of degree d and dimension r on X, which we’ll con-
tinue to denote by Gr
d(X). Moreover, for any family X ✲B of curves
of compact type, there exists a scheme Gr
d(X/B) ✲B parameterizing
limit linear series of degree d and dimension r on the ﬁbers of the
family. Most importantly for our applications, Gr
d(X/B) ✲B has the
expected local description: it’s determinantal, and every component
has dimension at least dim(B) + ρ.
This dimension estimate is what allows us to assert the smootha-
bility of certain limit linear series. For example, suppose that we have
a curve X0 of compact type, and that Gr
d(X0) has dimension exactly ρ.
If π : X ✲B is any smoothing of X0 — that is, a one-parameter family
of curves with smooth general ﬁber and special ﬁber π−1(b0) = X0
— then the dimension estimate tells us that Gr
d(X/B) has dimension
at least ρ + 1 everywhere, and in particular that no component of
Gr
d(X/B) can lie over b0. In other words, in every smoothing π : X ✲B
of X0, every limit linear series of degree d and dimension r on X0 is a
limit of linear series on the general ﬁber.
More generally, we see that if π : X ✲B is any family of singular
curves of compact type such that dim(Gr
d(X/B)) = dim(B) + ρ, then
any limit linear series of degree d and dimension r on a ﬁber of π
can be smoothed. The argument is the same: we simply enlarge (lo-
cally) the family to a family X′ ✲B′ of one larger dimension, such
that B ⊂B′ is the discriminant divisor of X′ ✲B′, and argue that for
dimension reasons the subvariety Gr
d(X/B) ⊂Gr
d(X′/B′) must lie in
the closure of its complement.
We can also do the same thing for k-pointed curves, associating to
a family π : X ✲B with k disjoint sections σj : B ✲X (with image in
the smooth locus of π) and k ramiﬁcation sequences bj = (bj
0, . . . , bj
r )
a scheme Gr
d(X/B; σ1, . . . , σk; b1, . . . , bk) parameterizing limit linear
series on ﬁbers Xt of X with ramiﬁcation sequence bj at σj(t). Ar-
guing as above, it follows that, for any such family, the dimension of
Gr
d(X/B; σ1, . . . , σk; bi, . . . , bk) is at least dim(B) + ρ −

i,j

βj
i

; and if
equality holds, then any limit linear series on a ﬁber Xt of X with ram-
iﬁcation sequence bj at σj(t) is a limit of a linear series on a smooth
curve X having ramiﬁcation sequences bj at points pj specializing to
σj(t) as X specializes to Xt.
We will summarize the state of our knowledge as the following the-
orem, known as the Regeneration Theorem. We need one further bit of
terminology. Let X′ be a semistable curve stably equivalent to a stable
curve X. We say a reﬁned limit linear series on X′ is stably equiva-
lent to a reﬁned limit linear series on X if the two series have the
same aspects on corresponding components of X′ and X. (Note that
this determines completely the aspects on the components of X′ con-
tracted in X: the ramiﬁcation sequences at the two nodes of X′ lying

268
5. Limit Linear Series and Brill-Noether theory
on such a component are precisely complementary, and so force the
aspect there to be monomial.)
Theorem (5.41) (Regeneration Theorem) Fix a family π : X ✲B
and σj : B ✲X of k-pointed nodal curves and any k ramiﬁcation
sequences bj = (bj
0, . . . , bj
r ). Let G = Gr
d(X/B; σ1, . . . , σk; b1, . . . , bk),
and let [V] ∈G be a point corresponding to a limit linear series
V = {VY } on a ﬁber X0 = π−1(0). If the dimension of G at [V] is
exactly dim(B) + ρ −

i,j

βj
i

, then there exists a family of smooth k-
pointed curves (Xt; p1(t), . . . , pk(t)) specializing to a k-pointed curve
stably equivalent to (X0, σ1(0), . . . , σk(0)), and a family Vt of linear
series on the curves Xt specializing to a limit linear series stably equiv-
alent to V.
As we’ve indicated, the proof follows simply from the existence of
parameter spaces Gr
d(X/B; σi, . . . , σk; bi, . . . , bk) for limit linear series
and the basic dimension estimate on them; for their construction, see
Eisenbud and Harris ([39], [42]).
We will give some applications of the Regeneration Theorem in the
following subsection. In addition, in Exercises (5.63)–(5.65), we’ll de-
duce as a consequence the following converse to the generalized Brill-
Noether theorem [Theorem (5.37)]. To state it, we introduce some no-
tation: following Fulton [53, §14.7] for any sequence λ = (λ0, . . . , λr )
with λ0 ≥λ1 ≥. . . ≥λr , we’ll denote by {λ} or {λ0, . . . , λr } the class,
in the cohomology or Chow ring of the Grassmannian, of the corre-
sponding Schubert cycle: this is the class denoted σλ0,...,λr in Grifﬁths
and Harris [64]. In these terms, we have:
Theorem (5.42) Let C be a general smooth curve of genus g, let
p1, . . . , pk be general points of C and let bj
=
(bj
0, . . . , bj
r ) for
j = 1, . . . , k be any k ramiﬁcation sequences. There exists a gr
d on C
having ramiﬁcation at least bj at pj if and only if the product
k

j=1
{bj
r , . . . , bj
0} · {1, 1, . . . , 1, 0}g ̸= 0
in the cohomology ring H∗(G(r + 1, d + 1), Z) of the Grassmannian
G(r + 1, d + 1).
When k
=
1, there is a simple condition on the ramiﬁca-
tion sequence b
=
b1 equivalent to this: using the Littlewood-
Richardson formula for products of Schubert cycles in the Grass-
mannian (see for example [53]), it’s possible to see that the prod-
uct {br , . . . , b0} · {1, 1, . . . , 1, 0}g
̸=
0 if and only if the sum

(bi + g −d + r)+ ≤g, where we use the notation (x)+ to denote
max{x, 0}. We thus have the following:

D. Limit linear series: deﬁnitions and applications
269
Corollary (5.43) Let C be a general curve of genus g, p be a general
point of C and b = (b0, . . . , br ) be any ramiﬁcation sequence. There
exists a gr
d on C having ramiﬁcation at least b at p if and only if the
sum
r
i=0

bi + g −d + r

+ ≤g .
Limits of canonical series and Weierstrass points
As a ﬁrst application of the theory in the preceding subsection, we’ll
describe the limiting positions of the Weierstrass points of a smooth
curve degenerating to a reducible curve X0 = Y ∪Z where Y and Z are
smooth curves of genera i and g −i respectively with a point p ∈Y
identiﬁed to a point q ∈Z: for more on this topic, see [40]. In general,
these limiting positions have nothing to do with — indeed, are disjoint
from — the Weierstrass points of Y and Z themselves.
The key to the analysis here is to identify the Weierstrass points of
a smooth curve Xt as the ramiﬁcation points of the canonical linear
series. This identiﬁes their limits as the inﬂectionary points of the as-
pects of the limit (VY , VZ) of the canonical linear series Vt = |KXt| on
Xt. Our task is thus to describe this limiting series. The key inequali-
ties are:
ag−i(VY , p)
+ ai−1(VZ, q) ≥2g −2
and
ag−i−1(VY , p) +
ai(VZ, q)
≥2g −2 .
The linear series VY (−ag−i(VY , p)·p) has dimension i−1 and hence,
by Clifford’s theorem, degree at least 2i −2 with equality holding
only if it equals |KY |: therefore, we have ag−i(VY , p) ≤2(g −i).
Similarly, ai−1(VZ, q) ≤2(i −1). This is only possible if equality
holds throughout: in particular, VY (−ag−i(VY , p) · p) is the com-
plete canonical series of Y. Using the second inequality, we ﬁnd that
ag−i−1(VY , p) = 2(g −i −1), ai(VZ, q) = 2i, and VY (−ai(VZ, q) · q) is
the complete canonical series on Z.
Now, assume that p is not a Weierstrass point of Y. Then the linear
series VY (−ag−i(VY , p) · p) =
&&KY
&& will be unramiﬁed at p and in
particular
ag−1(VY , p) ≤ag−i(VY , p) + i −1 = 2g −i −1 .
This in turn forces
a0(VZ, q) ≥i −1 ;
i.e., VZ has a base point of order i−1 at q, and after removing this base
point, VZ is a linear series of dimension g −1 and degree 2g −1−i. In
other words, VZ is the complete series
&&KZ

(i + 1) · q
&&, plus the ﬁxed

270
5. Limit Linear Series and Brill-Noether theory
divisor (i −1) · q. Applying the same argument to the aspect VY , we
see that in case p and q aren’t Weierstrass points of Y and Z, the limit
on X0 of the canonical series |KXt| can only be the limit linear series
(VY , VZ) with aspects
VY = |KY ((g −i + 1)p)| + (g −i −1)p
and
VZ = |KZ((i + 1)q)| + (i −1)q .
Note in particular that in this case the limit of the series |KXt| depends
only on X0, and not on the family of curves tending to it; in the general
setting — that is, if p or q is a Weierstrass point — we’ll see that the
limit does depend on the family.
The argument so far shows that if p is not a Weierstrass point of
Y, then a point of Z will be a limit of Weierstrass points of smooth
curves Xt of genus g tending to X0 only if it’s a ramiﬁcation point
for the linear series
&&KZ

(i + 1) · q
&&. To obtain a converse to this
result we need to suitably smooth this limit linear series; we do this
by applying the Regeneration Theorem (5.41). To set it up, we take our
base B = Z \ {q} and consider the one-pointed family X = X0 × B ✲B
with section σ : B ✲X given by the diagonal in B × B ⊂X0 × B and
ramiﬁcation sequence b = (0, . . . , 0, 1). Now, let r ∈Z \{q} = B be any
ramiﬁcation point of the series |KZ((i + 1)q)| other than q. The ar-
gument above shows that the limit linear series (VY , VZ), with VY and
VZ as above, will be an isolated point of the scheme Gg−1
2g−2(X/B; σ; b).
Since the expected dimension of Gg−1
2g−2(X/B; σ; b) is indeed zero, we
conclude from Theorem (5.41) that (VY , VZ) is indeed a limit of gg−1
2g−2’s
on smooth curves tending to X0, ramiﬁed at points pt ∈Xt tending to
r. In sum, then, we see that every ramiﬁcation point of
&&KX

(i+1)·q
&&
is indeed a limit of ramiﬁcation points for canonical series on smooth
curves — that is, of Weierstrass points.
We turn now to the case of a curve X0 = Y ∪Z/p ∼q where the
point of attachment is a Weierstrass point of a component. For sim-
plicity, suppose that p is a simple Weierstrass point of Y — that is, the
ramiﬁcation sequence of the canonical series |KY | at p is (0, . . . , 0, 1)
— and that q is not a Weierstrass point of Z. The inequality
ag−1(VY , p) ≤ag−i(VY , p) + i −1 = 2g −i −1
on the vanishing sequence of the aspect VY of a limit gg−1
2g−2 on X0
that we used in our previous analysis need no longer hold; instead,
we have only
ag−1(VY , p) ≤2g −i
and
ag−2(VY , p) ≤2g −i −2 .
These in turn give
a0(VZ, q) ≥i −2
and
a1(VZ, q) ≥i .

D. Limit linear series: deﬁnitions and applications
271
In other words, the aspect VZ of the limit linear series associated to
the canonical series on the members Xt of a family of smooth curves
tending to X0 is not uniquely determined! Rather, it can a priori be
any one of the one-parameter family of gg−1
2g−2’s on Z satisfying
(5.44)
|KZ(iq)| + iq ⊂VZ ⊂|KZ((i + 2)q)| + (i −2)q .
In fact, we claim that all of these do occur as (aspects of) limits
of |KXt| for suitable families of curves Xt tending to X0. To see this,
consider the family π : X ✲B with base B = Y obtained by identifying
the ﬁxed point q ∈Z with a variable point p ∈Y. By our previous
analysis, the ﬁber of Gg−1
2g−2(X/B) over points p′ ∈Y = B that aren’t
Weierstrass points will consist of a single point, while the ﬁber over
p will be one-dimensional. Thus, over a neighborhood of p ∈Y = B,
we have
dim Gg−1
2g−2(X/B) = 1 = dim B + ρ ,
and applying the Regeneration Theorem we deduce that for any linear
series VZ on Z satisfying the inclusions (5.44) above, the pair (VY , VZ)
(with VY = |KY ((g −i + 1)p)| + (g −i −1)p as before) is the limit of
the canonical series |KXt| for some family of curves Xt tending to X0.
By the same token, we see that for such a curve X0, every point
s ∈Z ⊂X is a limit of Weierstrass points on (some) nearby smooth
curves Xt. The point is that a general point s ∈Z will be a ramiﬁcation
point of a ﬁnite number V1, . . . , Vm of the linear series VZ satisfying the
inclusions (5.44) above. Thus, we can take π : X ✲B = Y as before,
mark the family with the section σ corresponding to the point s in
each ﬁber, and again set b = (0, . . . , 0, 1). Now in a neighborhood
of the point p ∈Y = B, the scheme dim Gg−1
2g−2(X/B; σ; b) is zero-
dimensional; and once more applying Theorem (5.41) we conclude
that there exists a family of pointed curves (Xt, st) and gg−1
2g−2’s on Xt
ramiﬁed at st tending to (X0, s) and (VY , Vi) — in other words, we
conclude that s is a limit of Weierstrass points of smooth curves. In
sum, then, we’ve proved the:
Theorem (5.45) Let X0 = Y ∪Z/p ∼q be a curve consisting of two
smooth components meeting at a point as above.
1) If p is not a Weierstrass point of Y, then a point s ∈Z \ {q}
will be a limit of Weierstrass points of smooth curves Xt of genus g
tending to X0 if and only if it’s a ramiﬁcation point for the linear
series |KZ((i + 1)q)|.
2) If p is a Weierstrass point of Y, then every point of Z will be such
a limit.

272
5. Limit Linear Series and Brill-Noether theory
Note ﬁnally that, according to the Pl¨ucker formulas, the result above
does indeed account for all the limits of Weierstrass points: the linear
series |KZ((i+1)q)| will have (g−i)(g2 −1) ramiﬁcation points other
than q, and the series
&&KY

(g −i + 1) · p
&& will have i(g2 −1).
The limits of Weierstrass points on curves not of compact type are
studied in [44].
As we indicated earlier, we can go further with this analysis to prove
the existence of curves with Weierstrass points of higher weight. This
is sketched in the following sequence of exercises. Before we begin,
though, we need to introduce some terminology and notation relevant
to Weierstrass points.
First of all, we have what we may call the Weierstrass stratiﬁ-
cation of the universal curve Mg,1: for any ramiﬁcation sequence
b = (b0, . . . , bg−1), we’ll denote by Cb ⊂Mg,1 the locally closed subset
of Mg,1 consisting of pairs (C, p) such that the canonical series |KC|
of C has ramiﬁcation sequence exactly equal to b at C; that is,
Cb = {[(C, p)] : bi(|KC|, p) = bi} .
This is just the locus of points with Weierstrass gap sequence
{bi + i + 1}i=0,...,g−1. We will say that b satisﬁes the semigroup con-
dition if the complement H(b) = N \ {bi + i + 1 | i = 0, . . . , g −1} is
indeed a semigroup; clearly, Cb will be empty otherwise.
One more bit of terminology. The expected codimension of Cb in
Mg,1 is simply the sum β =
g−1
i=0 bi (this is also an upper bound for
the codimension of Cb whenever it’s nonempty). We will say, then, that
a Weierstrass point (C, p) ∈Cb is proper if in fact dim[(C,p)](Cb) = β
— in English, the codimension of the Weierstrass stratum containing
[(C, p))] is equal to the weight. Note that any point of weight 0 or 1
is trivially proper. In these terms, our ﬁrst result is a direct general-
ization of an argument above:
Exercise (5.46) Let X0 = Y ∪Z/p ∼q be as above the curve obtained
by identifying p ∈Y with q ∈Z, and assume that (Y, p) and (Z, q) are
both proper, of weights w1 and w2. Show that the variety Gg−1
2g−2(X0)
of limit gg−1
2g−2’s on X0 has dimension w1 +w2, and that any such limit
on X0 is indeed the limit of the canonical series |KXt| on a family of
smooth curves Xt tending to X0.
Our ﬁrst application will be to prove the existence of (both kinds
of) Weierstrass points of weight 2.
Exercise (5.47) Let X0 = Y ∪Z/p ∼q be as above the curve obtained
by identifying p ∈Y with q ∈Z; but now assume g ≥4, Y is a smooth
curve of genus g−1, and Z an elliptic curve. Assume that p is a simple
Weierstrass point of Y.

D. Limit linear series: deﬁnitions and applications
273
1) Let r ∈Z be a point such that r −q is torsion of order exactly
g + 1 in the group law on Z. Show that there is a limit gg−1
2g−2 on X0
with ramiﬁcation sequence (0, . . . , 0, 2) at r, and use the Regeneration
Theorem to deduce that (X0, r) is a limit of proper Weierstrass points
with gap sequence (1, 2, . . . , g −1, g + 2).
2) Now let r ∈Z be a point such that r −q is torsion of order exactly
g−1 in the group law on Z. Show that there is a limit gg−1
2g−2 on X0 with
ramiﬁcation sequence (0, . . . , 0, 1, 1) at r, and use the Regeneration
Theorem to deduce that (X0, r) is a limit of proper Weierstrass points
with gap sequence (1, 2, . . . , g −2, g, g + 1).
Note that in the last exercise, if r is a general point of Z then r
will be a limit of simple Weierstrass points. We may apply the same
techniques more generally:
Exercise (5.48) Let X0 = Y ∪Z/p ∼q be as above, and now as-
sume Y is a smooth curve of genus g −1 and Z is an elliptic curve.
Assume only that (Y, p) is a proper Weierstrass point, with ramiﬁca-
tion sequence (b0, . . . , bg−2). For any j = 0, . . . , g −2, let r ∈Z be
a point such that r −q is torsion of order exactly bj + j + 2 in the
group law on Z. Assuming that bj + j + 2 doesn’t divide bk + k + 2 for
any k > j, show that there is a limit gg−1
2g−2 on X0 with ramiﬁcation se-
quence (0, b0, . . . , bj−1, bj +1, bj+1, . . . , bg−2) and that (X0, r) is a limit
of proper Weierstrass points with this ramiﬁcation sequence. Simi-
larly, if r ∈Z is a general point, show that (X0, r) is a limit of proper
Weierstrass points with ramiﬁcation sequence (0, b0, . . . , bg−2).
We may deduce from this the following theorem and corollary.
Theorem (5.49) If Cb ⊂Mg−1,1 contains a proper point, then so does
Cb′ ⊂Mg,1 if either
1) b′
0 = 0 and b′
i = bi−1 for i = 1, . . . , g −1; or
2) for some j = 1, . . . , g −2, we have b′
0 = 0, b′
j = bj−1 + 1 and
b′
i = bi−1 for i = 1, . . . , g −1, i ̸= j, and b satisﬁes the semigroup
condition.
Corollary (5.50) If H ⊂N is any semigroup of index #(N \ H) = g
and weight
w =


i∈N\H
i

−g(g + 1)
2
≤g
2
then there exists a Weierstrass point (C, p) with semigroup H.
Exercise (5.51) Use Exercise (5.48) to prove Theorem (5.49) and
Corollary (5.50).

274
5. Limit Linear Series and Brill-Noether theory
E
Limit linear series on ﬂag curves
As we’ve seen, the Brill-Noether theorem follows directly from inequal-
ities on the total ramiﬁcation indices of the aspects of a limit linear
series on an arbitrary curve formed from a tree of rational curve and g
elliptic tails. To get more subtle information about the behavior of lin-
ear series on a general curve, such as that expressed by the Gieseker-
Petri theorem, we need to analyze in more detail limit linear series on
a more special type of curve, namely the ﬂag curves described in the
ﬁrst section of the chapter, and this is what we shall do in this ﬁnal
section. For the remainder of the chapter, then, X0 will be the curve
pictured in Figure (5.10), and D will be a limit linear series on X0 of
degree d and dimension r.
Inequalities on vanishing sequences
To
analyze
D,
we
label
the
components
of
X0
as
in
Fig-
ure (5.10), with Y1, . . . , YN forming the main vertical chain and
pi = Yi ∩Yi−1, f ori = 2, . . . , N. In addition, for m ∈{1, · · · , g}, let
us denote by Em one of the elliptic tails, by Yc(m) the component of Y
joined to Em, and by qm and sm the respective points of attachment
on Yc(m) and Em.
We begin our analysis by looking at a ﬁxed elliptic tail E = Em, so
we’ll drop the subscript m’s for the moment. Let Z0 = Y, Z1, . . . , Zk be
the chain of rational curves leading to E, with qi = Zi−1 ∩Zi. To start
with, we observe that we must have
ar−1(VE, s) ≤d −2,
since if ar−1(VE, s) = d −1, the pencil generated by the two sections
of VE vanishing to highest order at s would have d −1 base points,
and hence would contain a g1
1. By Theorem (5.28), then
a1(VZk, s) ≥2
and now by 1) of Lemma (5.30),
a1(VY , q1) ≥a1(VZ1, q2) ≥a1(VZ2, q3)
...
...
≥a1(VZk−1, qk) ≥a1(VZk, s) ≥2 .
We deduce from this the:
Proposition (5.52) If l = cm for some m, the linear series VYl can
have at most one section vanishing only at pl and pl+1.

E. Limit linear series on ﬂag curves
275
Proof.
Two such sections σ, τ would generate a pencil totally ram-
iﬁed at pl and pl+1, and consequently unramiﬁed elsewhere. In partic-
ular, suitable linear combinations of σ and τ would vanish to orders
0 and 1 at qm, violating a1(VY , q1) ≥2.
Note that, for like reasons, the equality ar (VE, s) = d can hold only
if LE

OE = OE(ds) — equivalently, LYl

OE = OE. Mimicking the
argument above, we see that, unless LE

OE = OE(ds), the point q1 is
a base point of VYL, which implies that there can be no section of VYl
vanishing solely at pl and pl+1. Combining both parts of Lemma (5.30)
with this observation, we see that in general we have the inequality
(5.53)
ai(VYl+1, pl+1) ≥ai(VYl, pl)
and if l = cm for some m, then equality can hold in (5.53) for at most
one value of i.
But now for any l and i we have trivially
i ≤ai(VYl, pl) ≤d −(r −i)
and hence, in general,
(5.54)
ai(VYl1 , pl1) −ai(VYl2 , pl2) ≤(d −r) .
Taking l1 = N and l2 = 1 and untelescoping the difference gives
N−1

l=1

ai(VYl+1, pl+1) −ai(VYl, pl)

≤(d −r) .
Finally, summing over i yields
r
i=0
N−1

l=1

ai(VYl+1, pl+1) −ai(VYl, pl)

≤(r + 1)(d −r) .
Interchanging the summation, and dropping those (nonnegative)
terms for which l isn’t one of the c(m)’s gives the lower bound
(5.55)
(r + 1)(d −r) ≥
g
m=1
r
i=0

ai(VYc(m)+1, pc(m)+1) −ai(VYc(m), pc(m))

.
But, for ﬁxed m, we know that all but one of the (r + 1) terms in
the sum over i is strictly positive. Thus, we recover the Brill-Noether
inequality
(r + 1)(d −r) ≥rg
and the weak form of the Brill-Noether theorem: X0, and hence a gen-
eral curve of genus g, cannot possess a (limit) linear series with neg-
ative Brill-Noether number.

276
5. Limit Linear Series and Brill-Noether theory
Exercise (5.56) The argument following Proposition (5.52) shows
that, unless LEm

OEm = OEi(d · s), every term in the mth inner sum
in (5.55) will be positive. Use this sharpening to rederive the strong
form of Brill-Noether as well.
The case ρ = 0
One case in which the above analysis gives us a more or less complete
description of the limit linear series D is when ρ = 0. In this case, all
the inequalities used in the argument must be equalities. In particu-
lar, this means that the vanishing sequences al,i = ai(VYl, pl) of the
aspects VY of D do not merely satisfy al+1,i ≥al,i for all l and i. More
precisely, we have the:
Lemma (5.57) In case ρ = 0,
1) for l ≠cm, we have al+1,i = al,i for all i; and
2) for l = cm, we have al+1,i = al,i + 1 for all but one i.
There are only a ﬁnite number of collections of sequences al,i sat-
isfying this system of equations; in fact, as we’ll see in Exercise (5.66),
there are exactly as many as there are gr
d’s on a general curve of
genus g. For example, in the case of g1
3’s on a curve of genus 4, we
have the two solutions as shown in Table (5.59). Similarly, for the g1
4’s
on a curve of genus 6 there are 5 solutions, shown in Table (5.60).
One circumstance in which there is always a unique solution is the
case d = 2g −2, r = g −1 corresponding to the canonical series.
The case of g = 5 is typical. Table (5.61) shows the only solution. In
general, we claim that the unique solution of the constraints expressed
in Lemma (5.57) is given, for l between cm−1 and cm, by
(5.58)
al,i =

m + i −2 if i < m −1
m + i −1 if i ≥m −1 .
To see this, observe that for each m = 1, . . . , g there is exactly one
i = i(m) such that acm,i = acm+1,i, every i occurs for exactly one m,
and these indices completely determine the solution. Equation (5.58)
amounts to the assertion that i(m) = m −1 for all m. To see this for
m = g, recall that the instances of (5.54) used in the proof are sharp
only if ai(YN, pn) = d −r + i = g −1 + i for every i and hence, in
particular, acg,i must be an increasing sequence. But now dropping
the al,i for i = g −1 and/or l ≥cg we’re left with the same system
of equations with g replaced by g −1 and can conclude by an induc-
tion. We remark that the uniqueness of the canonical series on X0 is
a property of this curve not shared by all curves of compact type.

E. Limit linear series on ﬂag curves
277
c1
c2
c3
c4
N
l
0
0
0
1
1
2
1
1
2
2
3
3
0
0
0
0
1
2
1
1
2
3
3
3
i
Table (5.59)
c1
c2
c3
c4
c5
c6
N
l
0
0
0
0
0
1
2
3
1
1
2
3
4
4
4
4
0
0
0
0
1
1
2
3
1
1
2
3
3
4
4
4
0
0
0
0
1
2
2
3
1
1
2
3
3
3
4
4
0
0
0
1
1
1
2
3
1
1
2
2
3
4
4
4
0
0
0
1
1
2
2
3
1
1
2
2
3
3
4
4
i
Table (5.60)
c1
c2
c3
c4
c5
N
l
0
0
0
1
2
3
4
1
1
2
2
3
4
5
2
2
3
4
4
5
6
3
3
4
5
6
6
7
4
4
5
6
7
8
8
i
Table (5.61)
There is one particular consequence of (5.58) that will be crucial in
the following argument.
Lemma (5.62) If D is a limit of the canonical series, there is, for
m = 1, . . . , g and l = cm, a unique section in VYl vanishing only at
pl and pl+1, and it vanishes at pl to order exactly 2m −2.

278
5. Limit Linear Series and Brill-Noether theory
We will use this description of the limits of canonical series on ﬂag
curves in the following subsection to prove the Gieseker-Petri theo-
rem. In the meantime, we’ll indicate in the following series of exercises
how this description of limit linear series on ﬂag curves may be used
to prove the converse to the generalized Brill-Noether theorem [Theo-
rem (5.42)]. The one ingredient that doesn’t involve limit linear series
is Exercise (5.63), This is essentially an exercise in Schubert calculus
which we express using the notation for Schubert classes introduced
with Theorem (5.42); you may wish to simply assume this statement
and proceed to the remaining exercises.
Exercise (5.63) Let r and d ≥r be positive integers, and ﬁx any three
ramiﬁcation sequences bj = (bj
0, . . . , bj
r ) for j = 1, 2, 3, satisfying

i,j
bj
i = (r + 1)(d −r) .
Show that there exists a gr
d on P1 having ramiﬁcation sequences b1,
b2 and b3 at the points 0, 1 and ∞respectively if and only if the
intersection number
3

j=1
{bj
r , . . . , bj
0} ̸= 0
in the cohomology ring H∗(G(r + 1, d + 1), Z) of the Grassmannian
G(r + 1, d + 1). Moreover, in this case there exists a ﬁnite number of
such gr
d’s.
Exercise (5.64) Now let C be a ﬂag curve of genus g, and p1, . . . , pk
smooth points of C lying on distinct components of the backbone of
C. Let bj = (bj
0, . . . , bj
r ), j = 1, . . . , k, be any k ramiﬁcation sequences
satisfying rg +

bj
i = (r + 1)(d −r). Assuming the result of Exer-
cise (5.63), show that there exists a limit gr
d on C having ramiﬁcation
at least bj at pj if any only if the product
k

j=1
{bj
r , . . . , bj
0} · {1, 1, . . . , 1, 0}g ̸= 0
in the cohomology ring H∗(G(r + 1, d + 1), Z) of the Grassmannian
G(r + 1, d + 1), and that in this case there are a ﬁnite number of such
limit linear series.
Exercise (5.65) Use the Regeneration Theorem (5.41) to deduce the
converse of the generalized Brill-Noether theorem [Theorem (5.42)]
from Exercise (5.64): you may need to impose extra ramiﬁcation
points with ramiﬁcation sequence (0, . . . , 0, 1) to make up the equality
rg +

bj
i = (r + 1)(d −r).

E. Limit linear series on ﬂag curves
279
Here are a couple other applications of the description of limit linear
series on ﬂag curves.
Exercise (5.66) Again let C be a ﬂag curve of genus g and p1, . . . , pk
smooth points of C lying on distinct components of the backbone of C,
and suppose that g, r and d satisfy the equality g = (r +1)(g−d+r).
Show that there are exactly as many limit gr
d’s on C as the expected
number of gr
d’s on a general curve of genus g, and (using the Regen-
eration Theorem) deduce that for a general curve X of genus g the
scheme Gr
d(X) is reduced.
Exercise (5.67) The following somewhat lengthy exercise illustrates
the use of many of the ideas we’ve seen so far to prove the existence
of a stable curve C of compact type and of genus 23 possessing a
dimensionally proper limit g1
12 but no crude limit g2
17. The existence
of such a curve will be used in Section 6.F.
We take for C the curve in Figure (5.68) where (Fi, pi) are general
F1
p1
E
p2
F2
Figure (5.68)
pointed curves of genus 11, E is an elliptic curve, and p1 and p2 differ
by a translation of order exactly 12; that is, 12(p1 −p2) ∼0, but
n(p1 −p2) ̸∼0 for n < 12.
1) Show that, if we set VFi to be the complete series |12pi| on Fi and
take VE to be the pencil spanned by 12p1 and 12p2 on E, then the V’s
are the aspects of a reﬁned and dimensionally proper limit g1
12 on C.
2) Now suppose that we’re given a limit g2
17 on C. Use the fact that the
Fi are general and the additivity of the adjusted Brill-Noether number
to deduce that ρ(VE, p1, p2) < 0.
3) Use a dimension count to show that VE contains sections σi van-
ishing on the divisors
Ai = ai(VE, p1)p1 + a2−i(VE, p2)p2 ,
so that
(5.69)
deg(Ai) = ai(VE, p1) + a2−i(VE, p2) ≤17.

280
5. Limit Linear Series and Brill-Noether theory
Sum these to obtain the estimate
βi(VE, p1) + β2−i(VE, p2) ≤45.
Combine these with ρ(1, 2, 17) = 43 to show that
ρ(VE, p1, p2) ≥−2 ,
and, moreover, that if ρ(VE, p1, p2) = −1 [resp:ρ(VE, p1, p2) = −2],
then equality holds in (5.69) for at least two [resp: for all three] values
of i.
4) Let σi1 and σi2 be two sections in VE, with i1 < i2 with associated
divisors Ai1 and Ai2. Use the hypothesis on the points pi to show that
0 ∼(σi1) −(σi2) = 12(p2 −p1) in Pic(E) and hence that
(5.70)
(σi1) = B + 12p2
and
(σi2) = B + 12p1
for some effective divisor B of degree 5 supported on p1 and p2.
Conclude that there cannot be three such sections and hence that
ρ(VE, p1, p2) cannot equal −2. Thus ρ(VE, p1, p2) = −1, and we must
have ρ(VFi, pi) = 0.
5) By Corollary (5.43) we must have

j

bj(VFi, pi) −4

+ ≤g.
Since ρ(VFi, pi) = 0, we have also

j

bj(VFi, pi) −4

= g,
from which we deduce bj(VFi, pi) ≥4 for all i and j. Use the
compatibility conditions (5.34) to show that, for each i and j, ﬁrst
bj(VFi, pi) ≤11, and then bj(VE, pi) ≤13. Show that this contradicts
at least one of the equations (5.70) and hence that the hypothetical
limit g2
17 cannot exist.
Proof of the Gieseker-Petri theorem
In this section, we’ll use the methods of the previous sections to an-
alyze products of linear systems on a family of curves. For the time
being, we let π : X ✲B be a projective family and let t be a local
parameter at a distinguished point b0 ∈B. We assume that the total
space X is smooth and that the central ﬁber X0 over b0 is a nodal
curve of compact type. We let L and M be line bundles on X \ X0 of
relative degrees d and e. As before, for each component Y of X0, we
denote by LY and MY the (unique) extensions of L and M to X whose

E. Limit linear series on ﬂag curves
281
restrictions to each component of X0 other than Y have degree zero.
Recall that a section σ ∈Γ(LY ) vanishing on Y vanishes on all of X0,
and likewise for MY .
Our ﬁrst task is to deﬁne, for each component Y of X0 and point
p ∈Y, an “order of vanishing” at p along Y for elements µ of the
tensor product Γ(LY )

Γ(MY ). To do this, deﬁne a ﬂag
Γ(LY )

Γ(MY ) = Σ0 ⫆Σ1 ⫆Σ2 ⫆· · ·
by letting Σk be the linear span of all tensor products σ ⊗τ such that
ordp

σ Y

+ ordp

τ Y

≥k.
We adopt the convention that ordp(σ Y ) = ∞if σ Y = 0; thus, for all
k, Σk ⊃Σ∞= t

Γ(LY )

Γ(MY )

. Note also that Σd+e+1 = Σ∞.
We
now
deﬁne
the
order
of
vanishing
of
an
element
µ
∈
Γ(LY )

Γ(MY ) to be the largest k such that µ
∈
Σk; we
write this as ordp(µ Y ).
As in our analysis of a single linear series, our basic tool will be to re-
late the “order of vanishing” at p along Y of a given µ ∈Γ(LY )

Γ(MY )
to its order of vanishing considered as an element of Γ(LY )

Γ(MY )
for other components Z. Our basic lemma refers to the now familiar
picture diagrammed in Figure (5.71) in which p′ is any point of Y dis-
tinct from p. As before, we’ll denote by E the sum of the irreducible
p′
Y
p
Z
Figure (5.71)
components of X0 lying in the connected component of X0 \ {p} con-
taining Z, so that
LZ = LY (−dE)
and
MZ = MY (−eE).
We will use these relations to view LZ, MZ and Γ(LZ)

Γ(MZ) as sub-
sheaves and a subspace of LY , MY and Γ(LY )

Γ(MY ) respectively.
Lemma (5.72) If µ ∈Γ(LY )

Γ(MY ), µ ̸∈Σ∞, and α is the smallest
integer such that
ν = tαµ ∈Γ(LZ)

Γ(MZ),
then
ordp′(µ Y ) ≤α ≤ordp(ν Z).

282
5. Limit Linear Series and Brill-Noether theory
Proof.
To begin with, choose sections σ0, . . . ., σr of LY and τ0, . . . , τs
of MY generating π∗LY and π∗MY respectively, as in Lemma (5.27).
Suppose σ ′
i = tαiσi and τ′
i = tβiτi are the corresponding sections of
LZ and MZ generating π∗LZ and π∗MZ. We ﬁrst write our given µ as
µ =

fij(0) σi ⊗τj
with fij(t) a holomorphic function of t
in B. (Here, and in
the sequel, any implicit indexing is over the full set of pairs
{(i, j) | 0 ≤i ≤r, 0 ≤j ≤s }.) Since this expression is unique and
the elements of each of the σ and τ bases all vanish to distinct orders
at p′, we see that
(5.73)
ordp′
µ Y

=
min
!
(i,j)
&& fij(0)≠0
"

ordp′
σi Y

+ ordp′
τj Y

.
The key point now is to express α. To do this, set
gij(t) = tα−αi−βjfij(t)
and, note that, in these terms
(5.74)
ν = tαµ =

tα−αi−βjfij(0)

tαiσi ⊗tβjτj

=

tα−αi−βjfij(0)

σ ′
i ⊗τ′
j

=

gij(0) σ ′
i ⊗τ′
j .
Since, by hypothesis, ν ∈Γ(LZ)

Γ(MZ) but ν ̸∈t · Γ(LZ)

Γ(MZ),
all the coefﬁcient functions gij must be holomorphic and at least one
must be nonzero at 0; thus
(5.75)
α = max

αi + βj −ord0(fij)

.
Now by Lemma (5.25),
αi ≥ordp′
σi Y

and
βj ≥ordp′
τj Y

and combining this with (5.73) and (5.75) yields
ordp′
µ Y

≤α.
On the other hand, if the pair (i, j) is chosen from among the subset
for which gij(0) ≠0 so as to minimize the sum
ordp(σ ′
i Z) + ordp(τ′
j Z) ,

E. Limit linear series on ﬂag curves
283
then we have
ordp

ν Z

≥ordp

σ ′
i Z

+ ordp

τ′
j Z

≥αi + βj
(by (5.25))
= α + ord0(fij)
(since gij(0) ≠0)
≥α ,
which gives the other inequality.
We now specialize. First, we go back to the situation where X0 is
the curve pictured in Figure (5.10) and M

L is the dualizing sheaf
on the general ﬁber of π. We suppose that we have an element
µ1 ∈Γ(LY1)

Γ(MY1) such that the image of µ1 is zero under the map
Γ(LY1)

Γ(MY1) ✲Γ(ωY1).
Hence, we may also suppose that µ1 ∈tbigl(Γ(LY1)

Γ(MY1)bigr).
We now plan to proceed as follows. First, as above, we inductively
identify, for each l, LYl+1 and MYl+1 with subsheaves of LYl and MYl
respectively and hence identify Γ(LYl+1)

Γ(MYl+1) with a subspace of
Γ(LYl)

Γ(MYl). Then, for each l, we let γl be the smallest integer such
that tγl · µ1 ∈Γ(LYl)

Γ(MYl), and we set
µl = tγlµ1.
Finally, we’ll consider the orders of vanishing
εl = ordpl

µl Yl

.
These, by (5.72), form an nondecreasing sequence. In fact, we claim
this can be sharpened as follows. If Yc(m) is the component of Y to
which the mth elliptic curve is joined as in the preceding two subsec-
tions, then we claim:
(5.76)
If l > cm, then εl ≥2m.
Since the sum of the relative degrees of L and M is 2g −2, so that
we must have εl ≤2g −2 for all l, this will yield a contradiction by
taking l ≥c(m). Statement (5.76) will in turn follow from (5.72) once
we establish the
Lemma (5.77) If l = cm for any m = 1, . . . , g and
εl = ordpl

µl Yl

≥2m −2,
then
γl+1 −γl ≥2m.

284
5. Limit Linear Series and Brill-Noether theory
Proof.
The proof amounts to a more careful examination of the
situation of Lemma (5.72) whose notation we would like to reuse. We
do this by ﬁxing l = c(m) and writing Y for Yl, Z for Yl+1, µ for
µl, ν for µl+1, p′ for pl and p for pl+1. We then have ν = tαµ with
α = γl+1 −γl. As in the proof, we also ﬁx bases {σi} of Γ(LY ) and {tj}
of Γ(MY ) and write
µ =

fij(0) σi ⊗τj .
By (5.73), the hypothesis of the lemma then implies
2m −2 ≤ordp′
µ Y

=
min
!
(i,j)
&& fij(0)≠0
"

ordp′
σi Y

+ ordp′
τj Y

and, by (5.75), its conclusion will follow if we show that
α = max
!
αi + βj −ord0(fij)
"
≥2m.
We will prove the slightly more precise statement that there exist i
and j such that fij(0) ≠0 and
αi + βj ≥2m.
To ﬁnd the pair (i, j), we use, for the ﬁrst and only time, the assump-
tion that µ is in the kernel of the product map
Γ(LY )

Γ(MY ) ✲Γ (LY

MY ) .
This implies that

!
(i,j)
&& fij(0)≠0
"

fij(0) σi ⊗τj

Y ≡0 .
Therefore, the minimum value, among the pairs (i, j) such that
fij(0) ≠0, of ordp′(σi Y )+ordp′(τj Y ) must be taken more than once.
Consequently, there exist at least two such pairs for which
2m −2 ≤εl = ordp′

µ Y

= ordp′

σi Y

+ ordp′

τj Y

.
Let (i1, j1) and (i2, j2) be two such pairs and note, further that, since
the σi and τj vanish to distinct orders at p′, we must have both i1 ≠i2
and j1 ≠j2.
We claim now that αi + βj ≥2m for either (i, j) = (i1, j1) or
(i, j) = (i2, j2). To see this, recall that by Theorem (5.28),
αi ≥ordp′

σi Y


E. Limit linear series on ﬂag curves
285
and that by 2) of (5.30) and (5.52), equality can hold for at most one i.
Therefore, we’ll have αi + βj ≥εl + 2 ≥2m for either (i, j) = (i1, j1)
or (i2, j2) unless we have both
εl = 2m −2
and, after interchanging 1 and 2 if necessary,
αi1 = ordp′

σi1 Y

,
αi2 = ordp′

σi2 Y

+ 1 ,
βj1 = ordp′

τj1 Y

+ 1 ,
βj2 = ordp′

τj2 Y

.
In this situation, the sections σi1 Y and τj2 Y each vanish only at p′
and p, and hence so does their product viewed as a section of ωY Y .
But by Lemma (5.62), this says that
ordp′

σi1τj2 Y

= ordp′

σi1 Y

+ ordp′

τj2 Y

= 2m −2
and we arrive at
2m −2 = εl = ordp′

µ Y

= ordp′

σi1 Y

+ ordp′

τj1 Y

> ordp′

σi1 Y

+ ordp′

τj2 Y

= 2m −2,
a contradiction.
Our conclusion is that µ cannot exist; i.e., the tensor product map
is injective. We have thus established the:
Theorem (5.78) (Gieseker-Petri theorem) If C is a general curve
and L any line bundle on C, the map
µ0 : H0(C, L)

H0(C, K

L−1) ✲H0(C, K)
is injective.

Chapter 6
Geometry of moduli spaces:
selected results
Our aim in this chapter is to illustrate how the techniques we’ve de-
veloped so far may be used to prove theorems about the geometry of
the various moduli and parameter spaces we’ve introduced. We have
not aimed at completeness, even for the problems we discuss; rather,
we want to brieﬂy highlight a fairly broad range of examples.
A
Irreducibility of the moduli space of
curves
As a warm-up, we’ll give here a proof of the classical fact that Mg is
irreducible. This serves two purposes. First, it gives another example
of the usefulness of the compactiﬁcation of the Hurwitz scheme by
admissible covers. Second, it’ll also serve as something of a trial run
for more complex arguments in later sections. For example, the series
of reductions made here is in many ways analogous to the one used
in the solution of the Severi problem in Section E of this chapter.
The basic plan is to work by induction, assuming it known that Mk
is irreducible for k < g and using an analysis of the behavior of Mg
near the boundary ∆to deduce irreducibility for Mg. This of course
requires some knowledge of the stable compactiﬁcation Mg of Mg;
in particular, we need to know that:
1. Mg is everywhere locally irreducible;
2. The boundary ∆g of Mg is a normal crossing divisor.
3. The
irreducible
components
of
∆g
are
the
varieties
∆i,
i = 0, . . . , ⌊g
2⌋.

A. Irreducibility of the moduli space of curves
287
4. For any distinct i and j, the components ∆i and ∆j intersect.
We veriﬁed the ﬁrst point in (3.32) and the second and third on
page 54. (The argument there used the irreducibility of Mi but only
for i < g.) The last point may be seen directly: ∆i and ∆j meet in the
locus of curves of the form seen in Figure (6.1) if i and j are both
Ci
Cg−i−j
Cj
Figure (6.1)
positive, and in the locus of curves of the form seen in Figure (6.2) if
Ci
Figure (6.2)
j = 0. Given this, we may make a series of reductions of the original
problem, as follows. First, since Mg is locally irreducible everywhere,
we have the:
First Reduction: It’s sufﬁcient to show that any two components Σ and
Σ′ of Mg meet.
Second, since any two ∆i’s meet, we have the:
Second Reduction: It’s sufﬁcient to show that any component Σ of Mg
contains the boundary component ∆i for some i.
Now, by the local irreducibility of Mg, any component of Mg contain-
ing a point [C] ∈∆i contains an open subset of ∆i and hence, since
the ∆i’s are themselves irreducible, all of ∆i. We deduce the:
Third Reduction: It’s sufﬁcient to show that any component Σ of Mg
contains a point [C] ∈∆.
With this said, how do we go about exhibiting a singular stable curve
in a given component Σ of Mg? We could apply Diaz’ theorem (2.34),
which will be proved in the next section, but in fact there is a much
simpler argument based on admissible covers. To set this up, choose
an integer d large enough that every smooth curve C of genus g admits
a map of degree d to P1 with simple branching — i.e., such that there
exists a component H of the Hurwitz scheme Hd,g dominating Σ.
Any component of the Hurwitz scheme maps surjectively onto the
space Pb of b-pointed stable curves of genus 0, so that H will contain

288
6. Geometry of moduli spaces: selected results
C1
C2
Cb−1
Cb−2
Figure (6.3)
a point [π : C ✲B] where B is the stable pointed curve consisting
of a chain of rational curves C1, . . . , Cb−2 with two marked points on
C1 and Cb−2 and one on each of the others. From the description of
admissible covers in Section 3.G, we see that each component of the
curve C must map to one of the components Ci of B; in particular
it’ll be a branched cover of P1 branched over only three points, with
simple branching over at least one. By Riemann-Hurwitz, this implies
that every component of the curve C is rational; the same is then true
of the stable model of C. The image of [π : C ✲B] in H is thus the
desired point of the boundary.
A historical remark is order here about the two principal ideas in
this argument. First, we can use the geometry of the stable compact-
iﬁcation Mg of Mg to deduce the irreducibility of Mg if we show
that any component must meet the boundary: this observation was
made by Deligne and Mumford in their original study [29] of stable
curves and was used by them to deduce the main result of that paper,
the irreducibility of Mg in positive characteristic, from irreducibil-
ity in characteristic 0. Second, we use the properness of the Hurwitz
scheme parameterizing admissible covers to ﬁnd boundary curves in
any component: this idea is due to Fulton in his appendix to [82].
B
Diaz’ theorem
Our next example is Diaz’ proof that a complete subvariety of Mg has
dimension at most g −2.
The idea: stratifying the moduli space
The basic approach is one ﬁrst proposed by Enrico Arbarello in [3]: to
introduce a stratiﬁcation of the moduli space Mg such that the (open)
strata contain no complete curves, and such that closed strata of codi-
mension g−2 likewise don’t contain complete curves. The point is that
if we can exhibit such a stratiﬁcation, any complete subvariety Σ of
dimension d will have to intersect the codimension 1 strata in com-
plete subvarieties of dimension d−1, hence the codimension 2 strata
in complete subvarieties of dimension d −2, and so on; ultimately we
conclude that Σ will meet the codimension g −2 strata in complete
varieties of dimension d −g + 2, and hence that d ≤g −2.

B. Diaz’ theorem
289
Arbarello, with this as one goal among others, introduced the se-
quence of subvarieties
W2 ⊂W3 ⊂· · · ⊂Wg−1 ⊂Wg = Mg,
where Wα is deﬁned to be the subvariety of smooth curves C of
genus g expressible as a cover of P1 of degree at most α with one
point of total ramiﬁcation. Equivalently, Wα is the locus of curves C
possessing a Weierstrass point p whose ﬁrst nongap is at most α, that
is, for which h0
C, O(αp)

≥2. (In particular, the smallest subvariety
W2 is just the locus of hyperelliptic curves, which is afﬁne.) Arbarello
showed that these subvarieties were closed in Mg and that all the
inclusions above are proper, or, in other words, that Wα is of codi-
mension g −α in Mg. In a deeper vein, he also showed that each Wα
is irreducible. It remains an open question, though, whether or not
the open strata Uα = Wα −Wα−1 of this stratiﬁcation can contain
complete curves.
To see how this question may be approached (and why the an-
swer is unclear), consider a family X ✲B of curves with general ﬁber
Xb ∈Wα. What we want to show is that if B is complete, then (pos-
sibly after a base change) some ﬁbers must either be singular or lie
in Wα−1. As a ﬁrst step, we can assume, after a base change, that the
family has a cross-section — that is, a point pb = σ(b) ∈Xb on each
ﬁber such that h0
Xb, O(α · pb)

≥2. After further base changes, we
can pick out on each ﬁber Xb a linear series of dimension 1 in |α·pb|,
or in other words a map to P1, so that we can take the total space X to
be an α-sheeted branched cover of a P1 bundle Y ✲B, totally ramiﬁed
over a cross-section Σ = σ(B) ⊂Y. After one ﬁnal base change, we
can assume that the branch divisor of this map consists of the cross-
section Σ (with multiplicity α −1, of course) plus a total of 2g −3 + α
other cross-sections Σi.
Σ
Σi
b0
Figure (6.4)

290
6. Geometry of moduli spaces: selected results
The key now is to ask: what happens when one (or more) of the sec-
ondary branch divisors Σi crosses the primary branch divisor Σ over
a point b0 ∈B as shown in Figure (6.4)? The ﬁrst point to note is that,
since the cover Xb ✲Yb ≊P1 is totally ramiﬁed over the point σ(b),
the stable limit of the curve Xb as b ✲b0 cannot continue to be an
α-sheeted branched cover of P1: given that there is no way to add any
more ramiﬁcation over the point σ(b0), we cannot produce enough
total ramiﬁcation in the limit to yield such a cover. Using the theory of
admissible covers we can determine what type of degeneration must
occur. This is the subject of the following:
Exercise (6.5) Show that in the above circumstances, either
1) the stable limit as b ✲b0 of the curves Xb is singular, or
2) the stable limit X of the curves Xb is smooth, so that the limit of
the admissible covers Xb ✲Yb ≊P1 is an admissible cover X0 ✲Y0
with X0 stably equivalent to X, and the map has degree strictly less
than α on the component of X0 isomorphic to X.
Given this exercise, why is the result not proved? The reason is simply
that we have no assurance that any of the secondary branch divisors Σi
will meet Σ. What might happen is for Σ to be a section of the P1 bun-
dle Y ✲B having negative self-intersection −n, and for all the Σi to be
sections of self-intersection n disjoint from Σ, giving instead the pic-
ture in Figure (6.6). (More precisely, Y ✲B will be the projectivization
P(E) of a split vector bundle E ≊L ⊕L−1, with deg(L) > 0; Σ will be
the cross-section corresponding to the unique summand L of positive
degree; and the Σi will be cross-sections corresponding to certain of
the inﬁnitely many summands isomorphic to L−1.) Of course, in this
Σ
Σi
b0
Figure (6.6)
situation, the sections Σi will necessarily meet each other. But while
we expect to see singular ﬁbers when they do, we lack the control over

B. Diaz’ theorem
291
which admissible covers will arise at such points to be sure. The up-
shot is that it remains an open question whether or not the open strata
of the Arbarello ﬂag admit complete curves.
How can we revive the argument? Diaz’ idea was this: while one sec-
tion of a P1 bundle may have negative self-intersection and be disjoint
from a collection of others, two such sections cannot exist: if three sec-
tions of a P1 bundle are disjoint, the bundle must be trivial and the
sections constant. So if we keep track of the branching of a cover over
not one but two points of P1, we’re sure to see some degeneracy in a
complete, one-parameter family.
Now, we cannot look just at curves that are branched covers of P1
totally ramiﬁed at two points, since such curves will never ﬁll up the
moduli space Mg (whatever the degree of the map, the variety of such
curves will, by Riemann-Hurwitz, have dimension 2g −1). What we
can do, however, is to take more generally a branched cover of P1, ﬁx
its total ramiﬁcation index at two points (or, equivalently and more
conveniently, the cardinality of two ﬁbers), and track the behavior of
this total. This motivates us to deﬁne the (closed) subvariety Dk ⊂Mg
to be the locus of curves C that admit maps π : C ✲P1 such that
deg(π) ≤g and
#

π−1{0, ∞}

≤k.
(We take D1 to be the empty set.) The upper bound g for deg(π) is
taken purely for technical convenience. We need some bound on the
degree of π or the locus Dk would have countably many components,
but we could replace g by any other integer d0 ≥g without affecting
the argument that follows.
Exercise (6.7) Show that Dk is a closed subvariety of Mg, of pure
codimension g −k for k ≥2.
Note that D2 is simply the locus of curves expressible as branched
covers of P1 (of degree at most g) with two points of total ramiﬁcation.
At the other extreme, Dg is all of Mg: for example, every curve may be
expressed as a branched cover of P1 of degree d ≤g totally ramiﬁed
over 0 — that is, every curve has a Weierstrass point — and then it
sufﬁces to choose ∞to be another branch point of this cover. An
alternative proof is given in:
Exercise (6.8) 1) If g is even, show that Dg = Mg by arguing that
for any curve C of genus g we can ﬁnd a branched cover C ✲P1 of
degree (g + 2)/2 branched over 0 and ∞.
2) In general, for which triples (n, α, β) of integers with n ≥α, β ≥0
and 2n −α −β + 2 ≥g, can we ﬁnd a map π : C ✲P1 of degree n
with ramiﬁcation indices α and β at two points p and q of C?

292
6. Geometry of moduli spaces: selected results
The proof
The basic theorem to be proved, from which Diaz’ theorem will follow
immediately, is the:
Theorem (6.9) The open strata Dk −Dk−1 of the Diaz stratiﬁcation
do not contain complete curves.
Proof.
Let B ⊂Dk be a complete curve; we’ll show that B must meet
Dk−1. The basic setup for doing this has already been described: af-
ter making a base change, we may assume we have a family of curves
X′ ✲B and for some open subset U ⊂B a family of branched covers
πU : XU ✲YU of degree k, where YU is a P1-bundle over U. Suppose
that for a general point b ∈U the restriction πb : Xb ✲P1 has branch
points p1, . . . , pb with the monodromy around pi given by the conju-
gacy class τi in the symmetric group Sk. We may take p1 and p2 to be
the points 0 and ∞. Let H be the Hurwitz scheme of branched covers
of P1 of degree k branched over b points with branching τ1, . . . , τb,
and let H be the compactiﬁcation of H by pseudo-admissible covers
(see the end of Section 3.G for the deﬁnition of these covers). We may
then complete YU to a birationally ruled surface Y ✲B with disjoint
sections Σi, XU to a surface X ✲B birationally equivalent to X, and
πU to a family π : X ✲Y of pseudo-admissible covers branched over
the sections Σi.
The point is now simply that since the family π : X ✲Y is non-
trivial, we must have degeneracies involving Σ1 or Σ2 and one of the
other sections Σi, that is, a ﬁber X0 ✲Y0 of the map π such that the
points p1(0) = Σ1 ∩Y0 and p2(0) = Σ2 ∩Y0 lie on different irreducible
components of Y0 — say Y ′ and Y ′′. Now, since we’ve assumed that
the original family B ⊂Dk is a complete curve in Mg, all the ﬁbers of
X ✲B are stably equivalent to smooth curves; in particular, the ﬁber
X0 of X over 0 will consist of a smooth curve X with trees of rational
curves attached.
We want to show that the point [X] ∈Dk−1. To do this we look at
the map π restricted to X. Let Y be the image of X in Y0; Y0 can also be
pictured as the curve Y ≊P1 with one or more trees of rational curves
attached (each at one point). If Y is distinct from both Y ′ and Y ′′, then
we let p′ and p′′ be the points in Y where the trees containing Y ′ and
Y ′′ meet Y; if Y ′ = Y, we take p′ to be the point p1(0), and similarly
in case Y ′′ = Y.
We claim that the covering map X ✲Y has total ramiﬁcation index
of at most 2g −3 + k outside {p′, p′′}. Indeed, the ramiﬁcation of X
over Y occurs only over those points pj(0) lying on Y, and over each
pj(0) ∈Y the ramiﬁcation index of X ✲Y is at most the ramiﬁcation
index of τj. By construction, the sum of the ramiﬁcation indices of the
classes τ1, . . . , τb is 2g+2d−2. Since the ramiﬁcation indices of τ1 and

C. Moduli of hyperelliptic curves
293
Y ′′
p2(0)
p′′
Y
p′
Y ′
p1(0)
Figure (6.10)
τ2 add up to 2d−k, the sum of the ramiﬁcation indices of τ3, . . . , τb is
2g −2 + k. Finally, since the locus Y −{p′, p′′} must contain a proper
subset of the points {p3, . . . , pb}, it follows that the total ramiﬁcation
index of X ✲Y over Y −{p′, p′′} is strictly less than 2g −2 + k. Now,
whatever the degree of the cover X ✲Y, it follows from the claim that
the cardinality of the inverse image of {p′, p′′} ⊂Y is at most k −1
so that X ∈Dk−1 as desired.
C
Moduli of hyperelliptic curves
Next, we show how the techniques we’ve assembled may be used to
study suitably geometric subvarieties of the moduli space of curves
with the example of the moduli space Hg ⊂Mg of smooth hyperellip-
tic curves, and its closure Hg in the moduli space of stable curves. The
space Hg is particularly tractable, since it can be viewed as a subvari-
ety of the moduli space of all curves of genus g, as a ﬁnite quotient
of the Hurwitz scheme of double covers, or, what is, in this case, the
same, as the moduli space of stable (2g + 2)-pointed rational curves.
We will be mostly concerned with the divisor theory of Hg: we would
like to describe the Picard group of Hg, understand the restriction
map from Pic(Mg) to Pic(Hg), and get some idea which line bundles
are positive on Hg.
Fiddling around
To get a feel for the problem, we start by simply writing down a “gen-
eral” one-parameter family of hyperelliptic curves: that is, we consider
the family of curves given by the equation
y2 = a2g+2(t) · x2g+2 + · · · + a1(t) · x + a0(t)
where the ai are general polynomials in t of some even degree d. The
total space X of this family is simply the double cover of P1 × P1

294
6. Geometry of moduli spaces: selected results
branched along a general curve C of type (2g + 2, d). (If d were odd,
X ✲P1 × P1 would be ramiﬁed over the line t = ∞.) Since C is gen-
eral, it (and hence the total space X) will be smooth. Moreover, the
intersection of C with the ﬁber of P1 × P1 over t is either transverse
at all points or with a single point of simple tangency. Correspond-
ingly, the ﬁber Xt will either be smooth or irreducible with a single
node (over the point of tangency). The curve α : P1 ✲Mg determined
by the pencil will thus miss the boundary components ∆i entirely for
i ≥1; and the degree of the boundary divisor ∆0 on P1 will be the
number of branch points of C over P1. To calculate this last number,
use Riemann-Hurwitz: C has genus (d −1)(2g + 1), and so a map ex-
pressing C as a simply branched cover of degree 2g+2 of P1 will have
2d(2g + 1) branch points; thus
degP1(δ0) = 2d(2g + 1).
To calculate the degree of the line bundle λ on P1 there are sev-
eral approaches. The simplest is to write down a frame for the Hodge
bundle: for general (ﬁnite) t, a basis for the space of holomorphic
one-forms on Xt is given by
ω1 = dx
y ,
ω2 = x dx
y
,
· · · ,
ωg = xg−1dx
y
.
These give sections of the Hodge bundle E that are everywhere inde-
pendent except at the point t = ∞. At this point, each section ωα has
a zero of order
d
2

and after multiplying ωα by td/2 these sections do
in fact form a frame for E in a neighborhood of t = ∞; thus
E ≊

OP1
d
2
⊕g
and in particular
degP1(λ) = g · d
2 .
For future reference, we note the relation
(6.11)
degP1(δ0) =

8 + 4
g

degP1(λ) .
The next exercise gives another method for calculating the degree of λ.
Exercise (6.12) 1) Apply Riemann-Hurwitz to the map X ✲P1 × P1
to ﬁnd the canonical class KX of X.
2) Use this to ﬁnd the class of the dualizing sheaf ωX/P1 = KX/KP1
of the family, and hence the degree of the class κ1 on P1.
3) Finally, apply formula (3.110) — 12 · λ = κ1 + δ — to recover
degP1(λ).

C. Moduli of hyperelliptic curves
295
You may have noticed that we used quotes when describing the pen-
cil above as general. Of course, these families don’t give general curves
in the hyperelliptic locus: taking the branch curve C to be general gives
us curves that avoid all the ∆i for i > 0. But the pencils above are not
even general amongst families with such branching. The reason is that
not every family of hyperelliptic curves over a base B will have total
space X a double cover of B × P1; X will in general be a double cover
of a P1-bundle over B but only if this bundle is trivial is X itself a dou-
ble cover of B ×P1. This exercise shows that, nonetheless, the relation
(6.11) continues to hold.
Exercise (6.13) Let S ✲B be a ruled surface and let D be a suitably
ample divisor class on S of even degree d = 2g + 2 over B. Let C be
a general curve in the linear system |D|, and let X ✲S be the double
cover of S branched along C. Mimic the calculations above to deter-
mine the degrees of λ and δ0 for the family of hyperelliptic curves
X ✲B. In particular, show that we’ll always have
degB(δ0) =

8 + 4
g

· degB(λ0) .
The calculation for an (almost) arbitrary family
The next logical question to ask is: how do we go from the “general”
one-parameter families described (those in the last exercise are, at
least, general amongst families that meet only the boundary compo-
nent of ∆0) to more arbitrary families. One natural way to attempt this
would be to consider double covers of ruled surfaces S ✲B branched
over curves that have more general branching behavior over B. Unfor-
tunately, this quickly gets very complicated: the ﬁbers over B of the
double covers we get aren’t in general stable, and the process of sta-
ble reduction makes the formulas messy. A more tractable approach
is to use the description of the closure Hg of Hg given by the Hurwitz
scheme of admissible covers of degree 2 of stable (2g + 2)-pointed
rational curves — that is, to consider one-parameter families of such
admissible covers, over one-parameter families of stable pointed ra-
tional curves. We will do this, deriving in this subsection a relation
among the degrees of various divisor classes associated to such a fam-
ily, and then in the next one, laying out what this means in terms of
the rational Picard group of Hg.
Let’s set things up. Given a one-parameter family of curves whose
general member is smooth and hyperelliptic, we may after base change
assume we have a family of admissible covers of degree 2 of stable
2g + 2-pointed rational curves: that is, a surface S ✲B ﬁbered over
a curve B with rational nodal ﬁbers and 2g + 2 everywhere disjoint

296
6. Geometry of moduli spaces: selected results
σl
Figure (6.14)
sections σl : B ✲S, and a double cover X ✲S that restricts on each
ﬁber Sb to an admissible cover of Sb branched at the points σl(b).
In fact, since we’re primarily interested in the divisor theory of the
hyperelliptic locus in moduli, we can simplify by working only with
families that don’t meet any of the strata of the Hurwitz scheme of
codimension greater than 1. This amounts to making the additional
assumption that each ﬁber Sb of S ✲B has either one or two compo-
nents. The schematic picture of a typical family S ✲B is therefore as
shown in Figure (6.14).
Next, we ask what the double cover Xb ✲Sb looks like over one of
the singular curves Sb. A ﬁrst observation is that the answer depends
on whether the numbers of points σl(b) on each of the two compo-
nents of Sb are even or odd. The cover cannot be branched over the
node of Sb in the former case and must be branched over this node in
the latter.
Figure (6.15)
In the even case, the admissible cover Xb ✲Sb looks, near the node
of Sb, like that shown in Figure (6.15).There are two possibilities for
the curve Xb. If each component Sb contains at least four of the branch
points σl(b), then Xb is a stable curve consisting of two hyperellip-
tic curves attached to each other at two points conjugate on each. If

C. Moduli of hyperelliptic curves
297
one of the components Sb contains only two of the σl(b), then the
corresponding component of Xb will be a semistable rational curve
and the main component will be a hyperelliptic curve of genus g −1.
The stable model of Xb is thus obtained by taking this hyperelliptic
curve and identifying two conjugate points. In both cases, the stable
model of the curve Xb will lie in the boundary component ∆0. Note
that the curve B ✲Mg associated to the family X ✲B will have inter-
section number 2 with ∆0 at such points b ∈B if the total space S
(and hence likewise X) is smooth over b. More generally, it will have
intersection number 2k with ∆0 if the local equation of S at the node
of Sb is (xy −tk).
Figure (6.16)
In the odd case, there must be at least three branch points on each
component since both are stable. This means that Xb is always stable
and consists of two hyperelliptic curves joined by identifying a Weier-
strass point on each. In this case, the curve Xb will lie in the boundary
component of ∆i if and only if the components of Sb contain 2i + 1
and 2g+1−2i of the points σl(b). Moreover, if the local equation of S
at the node p of Sb is (xy −t2k) — the power of t must be even since
X ✲S will be ramiﬁed at the isolated point p — then X will have local
equation (xy −tk) at the point lying over p, and b will be a point of
intersection multiplicity k of B with ∆i.
To count the number of such ﬁbers, we’ll let dj be the number of
singular ﬁbers Sb of S ✲B in which one component contains j of the
points σl(b) and the other 2g + 2 −j, each such ﬁber counted with
multiplicity k if the local equation of S at the node of Sb is xy −tk.
We can then write
(6.17)
degB(δ0) = 2 ·

j
d2j;
while for each i > 0 we have
(6.18)
degB(δi) = d2i+1
2
.
Note that we can deﬁne the integers dj for general families S ✲B of
pointed rational curves: let dj be the number of nodes p of ﬁbers
Sb such that the connected components of the complement Sb −{p}
contain j and 2g + 2 −j of the points σl(b).

298
6. Geometry of moduli spaces: selected results
Exercise (6.19) Show that with this convention, if X ✲S ✲B is the
family of hyperelliptic curves given as admissible covers of the curves
Sb branched in the points σl(b), then the relations above on the de-
grees degB(δi) still hold.
The next task is to ﬁnd the self-intersection of the relative dualizing
sheaf of X over B in terms of the numbers dj. By Riemann-Hurwitz,
the relative dualizing sheaf of X over B is expressed in terms of the rel-
ative dualizing sheaf of S over B and the classes of the branch divisors
Γl = σl(B) ⊂S. To use this we must thus relate the self-intersections
of the sections, the class of the relative dualizing sheaf of the surface
S ✲B, and the number of singular ﬁbers of each type.
This is a calculation that takes place on S. To simplify, let’s ﬁrst con-
sider only the case in which the total space S of the family is smooth.
What we want to do ﬁrst, in this case, is to blow down all the compo-
nents of the singular ﬁbers that meet fewer than g +1 of the sections;
and for every singular ﬁber in which both components meet g + 1 of
the sections, to blow down one of the two at random. We then have
a nice P1 bundle T over B, with 2g + 2 sections Γl meeting pairwise
transversely; for each singular ﬁber of S ✲B contributing to dj we
have a point where j of the sections meet. In particular,

l<m
ΓlΓm =

j
j(j −1)
2
· dj.
On the other hand, there is a basic relation between the pairwise
intersections of the Γl and their self-intersections. For any two sections
Γl and Γm, the difference Γl −Γm is numerically equivalent to a sum of
ﬁbers, and so has self-intersection 0; thus
Γ 2
l + Γ 2
m = 2Γl · Γm.
Combining this with the last equality, we have
(2g + 1) ·

l
Γ 2
l =

j
j(j −1) · dj.
What happens when we pass from the P1 bundle back to our original
surface S? Each time we blow up a point where j of the sections Γl
meet, the sum of the self-intersections of the Γl decreases by j, so
that on S the sum of the self-intersections of the proper transforms
of the sections Γj satisﬁes
(6.20)
(2g + 1) ·

l Γ 2
l = (2g + 1)

l Γ 2
l −

j j · dj

= −

j j(2g + 2 −j) · dj.

C. Moduli of hyperelliptic curves
299
For use later in this chapter, it’s convenient to observe that this in-
equality generalizes in two ways.
Exercise (6.21) Verify that this last relation holds even if the family
S ✲B has singular points as follows. Suppose that, at a point p ∈Sb,
S has local equation xy −tk. Show that:
1) after blowing down the component of Sb containing j ≤g + 1 of
the points σl(b), the resulting surface will be smooth at the image of
p;
2) the corresponding sections Γl will meet pairwise with intersection
number k, contributing k · j(j −1) to the sum of the intersections
Γl · Γm; and,
3) to recover the original surface S we must ﬁrst blow up k times to
separate the sections Γl passing through the image of p, and then blow
down the ﬁrst (k −1) exceptional divisors lowering from the sum of
the self-intersections Γ 2
l by k · j2.
Exercise (6.22) Suppose S ✲B is a family of rational curves with
smooth total space and such that each singular ﬁber contains exactly
two components and that we’re given n pairwise disjoint sections Γl.
Deﬁne, as above, dj to be the number of singular ﬁbers with i of the
sections passing through one component and (n−i) passing through
the other. Show that the argument above now yields
(n −1) ·

l
Γ 2
l = −

j
j(n −j) · dj.
Next, consider the class ωS/B of the relative dualizing sheaf of
S ✲B. Before we blew up, the relative dualizing sheaf had self-
intersection 0. This follows, for example, from the fact that any P1-
bundle over B is obtained from B × P1 by a like number of blowups
and blowdowns; or, alternately, by applying (KT )2 = 4 −4g(B). Since
there is one blowup for each singular ﬁber there are a total of

j(dj),
giving
(6.23)

ωS/B
2 = −

j
dj.
Finally, we can use this to calculate the self-intersection of the class
ωX/B of the relative dualizing sheaf of a family X ✲B of hyperelliptic
curves realized as a double cover ϕ : X ✲S of S branched along the
sections Γα. We have, ﬁrst of all, by Riemann-Hurwitz
ωX/B = ϕ∗ωS/B + RX
= ϕ∗
ωS/B + RS
2


300
6. Geometry of moduli spaces: selected results
where RX is the class of the ramiﬁcation divisor of X ✲S on X and
RS =

i Γi is the corresponding the branch divisor on S. We thus have

ωX/B
2 = 2 ·

ωS/B +

i
Γi
2
2
= 2

ωS/B
2 + 2

i

ωS/B · Γi

+ 1
2

i
Γ 2
i

since Γl · Γm = 0 for l ≠m. On the other hand, the intersection num-
ber of ωS/B with a section of the map S ✲B is just minus the self-
intersection of that section, so that after clearing denominators, the
last two terms yield

ωX/B
2 = 2

ωS/B
2 −3
2

i
Γ 2
i

.
Using (6.20) and (6.23), this gives the relation
2(2g + 1) ·

ωX/B
2 = 4(2g + 1) ·

ωS/B
2 −3(2g + 1)

i
Γ 2
i

=

j

−4(2g + 1) −3j(j −2g −2)

· dj
=

j

6jg −3j2 + 6j −8g −4

· dj .
On the other hand, by (6.17) and (6.18),
degB(δ) = 2
 
j even
dj

+ 1
2
 
j odd
dj

.
Combining both of these with the basic formula 12λ = κ1 + δ
(cf. (3.110)), we see that we can write
degB(λ) =

j
cj · dj
where, for even j = 2α, we have
cj =
 1
12
 
1
(4g + 2)

6jg −3j2 + 6j −8g −4

+ 2

=

1
12(4g + 2)
 
12αg −12α2 + 12α

= α(g + 1 −α)
(4g + 2)
,

C. Moduli of hyperelliptic curves
301
and, for odd j = 2α + 1, we have
cj =
 1
12
 
1
(4g + 2)

6jg −3j2 + 6j −8g −4

+ 1
2

= α(g −α)
(4g + 2) .
To summarize, then, we have
degB(λ) =

j=2α
α(g + 1 −α)
4g + 2
dj +

j=2α+1
α(g −α)
4g + 2 dj.
Since the numbers d2α aren’t determined by the degrees of the divi-
sor classes δi on B, we cannot express this as a relation among the
restrictions to the hyperelliptic locus Hg ⊂Mg of the generators
λ, δ0, . . . , δ⌊g/2⌋of Pic(Mg). The exception is our original “general”
case, however, where all di = 0 for i ≥3. Then we have
d2 = degB(δ0) = degB(δ)
and so we recover the relation
degB(δ) =

8 + 4
g

· degB(λ).
In general, we obtain only an inequality. If we ﬁrst note that
c2α ≥c2
and
2 · c2α+1 ≥c2
2 ,
we obtain:
Corollary (6.24) Let X ✲B be any one-parameter family of curves
whose general member is smooth and hyperelliptic. Then
degB(δ) ≤

8 + 4
g

· degB(λ).
We will have occasion to use this inequality in determining the ample
cone of Mg in the following section.
The Picard group of the hyperelliptic locus
What conclusions can we draw from the relations derived in the pre-
ceding discussion? We will try to shed some light on them by express-
ing them in terms of the rational Picard group Pic(Hg)⊗Q of the locus
Hg ⊂Mg of hyperelliptic curves.

302
6. Geometry of moduli spaces: selected results
To begin with, we can describe the locus Hg ⊂Mg as the quotient
of the Hurwitz scheme H 2,g of admissible covers of degree 2 by the
action of the symmetric group S2g+2 on 2g + 2 letters. Thus, to ﬁnd
the rational Picard group of Hg we’ll start by describing the Picard
group of H 2,g. This is reasonably straightforward, since the Hurwitz
scheme H 2,g of admissible covers of degree 2 is the same thing as the
moduli space R = M0,2g+2 of stable 2g + 2-pointed rational curves.
We have an open subset R of R, consisting of smooth curves C ≊P1
with 2g + 2 distinct marked points. This is isomorphic to an open
subset in (P1)2g−1: speciﬁcally, if we choose for each C the unique
isomorphism ϕ : C ✲P1 carrying p1, p2 and p3 to 0, 1 and ∞re-
spectively, we can identify R with the complement in (P1)2g−1 of the
divisors determined by the conditions pi ∈{0, 1, ∞} or (pi = pj).
This clearly has trivial Picard group, so that the Picard group of R is
generated by the classes of the boundary divisors. For every partition
of I ⊂{1, 2, . . . , 2g + 2} into two sets I and J such that both I and J
have cardinality at least 2, we have a divisor DI ⊂R whose general
point corresponds to a curve C = C1 ∪p C2 consisting of two smooth
rational curves Ci meeting at a point p, with the marked points pi in
C1 for i ∈I and in C2 for i ∈J. Of course, swapping I and J gives rise
to the same divisor.
The rational Picard group of the hyperelliptic locus Hg can be de-
scribed in these terms. To begin with, Hg is the quotient of R by the
symmetric group on 2g+2 letters, with the open subset Hg of smooth
curves corresponding to the open subset R (see Exercise (6.25) below);
thus
Pic(Hg) ⊗Q = (0),
and Pic(Hg) ⊗Q is generated by those linear combinations of the
divisors DI invariant under the symmetric group. These are just the
sums Ei over all subsets I ⊂{1, 2, . . . , 2g + 2} of given cardinality i
of the divisors DI. The upshot is that we get one class Ei for each
i = 2, . . . , g +1, and Ei is simply the closure of the locus of admissible
covers of curves of the form C = C1 ∪p C2 with i marked points p on
C1 and 2g + 2 −i marked points on C2.
Next, observe that these divisor classes are indeed independent.
One way to see this is to exhibit a collection of curves in M0,2g+2 whose
images in Hg have independent intersection numbers with them. For
example, 2g + 2 general sections of P1 × P1 ✲P1 will meet pairwise
but not triply; thus, the corresponding curve P1 ✲Hg will meet the
boundary component E2 but will not meet Ei for i > 2. On the other
hand, we could simply ﬁx a point p ∈P1 × P1 and take i general
sections passing through this point followed by 2g + 2 −i general
sections; the corresponding curve will meet E2, Ei and no divisor Ej
with j ≠2, i. This shows that the divisor classes Ei are independent.

D. Ample divisors on Mg
303
To relate this to the standard divisor classes on the moduli space
Mg, we can express this as saying that the Picard group of the locus
Hg ⊂Mg of hyperelliptic curves is generated by boundary compo-
nents Ξ0, . . . , Ξ⌊(g−1)/2⌋and Θ1, . . . , Θ⌊g/2⌋, where the general point of
Ξα = E2α+2 corresponds to a double cover of P1 ∪P1 branched over
2α + 2 points in one component and 2g −2α in the other, and a gen-
eral point of Θα = E2α+1 corresponds to a double cover of P1 ∪P1
branched over 2α+1 points in one component and 2g +1−2α in the
other.
Now, let X ✲B be any family of hyperelliptic curves. After making a
base change, we can associate to X ✲B a family of admissible covers
with base B′; and the numbers di introduced in the preceding part
are just the intersection numbers of the corresponding curve B′ ⊂R
with the divisor classes Ei. It follows by our previous analysis that the
pullback map
ι∗: Pic

Mg
 ✲Pic

Hg

sends ∆0 to 2 ·

Ξα and ∆α to Θα/2 for each α. Finally, our previous
relation says that the pullback of the divisor class λ to Pic(Hg) is given
as the linear combination
ι∗(λ) =
⌊(g−1)/2⌋

i=0
α(g + 1 −α)
4g + 2
Ξα +
⌊g/2⌋

i=1
α(g −α)
4g + 2 Θα.
Exercise (6.25) Prove that if (B; p1, . . . , p2g+2) is any stable (2g +2)-
pointed rational curve, there exists a unique admissible cover C ✲B
branched at the pi. In this way, we have a bijection between Hg and
the quotient of the moduli space M0,2g+2 by the symmetric group on
2g + 2 letters. Is this, in fact, an isomorphism?
D
Ample divisors on Mg
Our goal in this section is to describe the cone of ample divisors on
the moduli space of stable curves. The main tool here is a theorem
that translates the stability (in the G.I.T. sense) of the Hilbert point of
a general ﬁber of a family of curves in Pr into an inequality relating
certain intersection numbers of the ﬁrst Chern class of the line bun-
dle that embeds the family. We begin by setting up the statement of
this inequality. Its proof then takes up most of the section. The third
subsection translates this inequality into one relating standard divi-
sor classes and the fourth then combines this with the results of the
preceding section to determine the ample cone.

304
6. Geometry of moduli spaces: selected results
An inequality for generically Hilbert stable families
We start with a very naive and general question. Suppose we’re given a
proper ﬂat family π : X ✲B of varieties, and a family of line bundles
on the ﬁbers Xb = π−1(b) of the family — that is, a line bundle L on X,
considered modulo pullbacks of line bundles on B. If L is sufﬁciently
ample, its direct image π∗L will be a vector bundle E of some rank
r +1: we’ll assume this from now on. What we would like is to estimate
the twisting of this vector bundle, as encoded in its ﬁrst Chern class.
Of course, this question isn’t well-posed as it stands, because ten-
soring L with the pullback π∗M of a line bundle M on B will have the
effect of tensoring E by M (and so in particular adding (r + 1)c1(M)
to c1(E)). There is a way to ﬁx this, though: we simply consider the
difference between the pullback π∗c1(E) of the ﬁrst Chern class of E
to X, and r +1 times the ﬁrst Chern class of L itself. Thus, we consider
the divisor class
D = (r + 1)c1(L) −π∗c1(E);
by what we’ve said, this is invariant under tensoring L with pullbacks
of line bundles from B.
The class D has the drawback of being a divisor class on the total
space X of our family, and not on the base B as desired, but we can
ﬁx this too. If the family X ✲B has ﬁber dimension k, we can deﬁne
a divisor class F on B by raising the class D ∈A∗X to the (k + 1)st
power and taking the Gysin image
F = π∗

Dk+1
.
Thus, for example, if B is one-dimensional, then all terms involving
c1(E) to a power greater than 1 will vanish and the degree of F will
equal
(r + 1)k+1c1(L)k+1 −(k + 1)(r + 1)kc1(E)c1(L)k .
With all this said, what can we say about the class F? The answer
in general seems to be: nothing. However, with one relatively mild
hypothesis we have a straightforward inequality:
Theorem (6.26) (Cornalba-Harris [27]) Assume that B is one di-
mensional, and that for a general point b ∈B the line bundle Lb = L Xb
is very ample and embeds Xb as a Hilbert stable variety in Pr . Then
deg(F) ≥0, i.e.,
(r + 1) · c1(L)k+1 ≥(k + 1) · c1(L)k · c1(E).
Note that, since B is one-dimensional, it sufﬁces to exhibit one value
of b for which h0(Xb, LB) = r + 1, Lb is very ample and ϕLb(Xb) is

D. Ample divisors on Mg
305
Hilbert stable. In general, if we assume that these conditions are met
for every b ∈B (or for all but a ﬁnite number), we may deduce that F
has nonnegative intersection number with every curve in B and hence
that F lies in the closure of the cone of ample divisors on B.
Before proving this theorem, let’s see what its consequences are for
curves. We apply it in the simplest way possible: we assume we have
a one-parameter family π : X ✲B of stable curves, with the general
ﬁber Xb smooth and nonhyperelliptic; and we take the line bundle L
to be simply the relative dualizing sheaf L = ωX/B. The degree of L
on the ﬁbers of π is 2g −2 and the degree of L on X is the degree of
the line bundle κ on B, so we have
gκ ≥2(2g −2)λ.
On the other hand, we know that κ = 12λ −δ; plugging this in and
collecting terms, we have the:
Corollary (6.27) If π : X ✲B is any one-parameter family of stable
curves, not all hyperelliptic or singular, then the degree λ of the Hodge
bundle and the number δ of singular ﬁbers satisfy the inequality
degB(δ) ≤

8 + 4
g

· degB(λ) .
This, combined with a separate analysis of families of hyperelliptic
and/or singular curves, will allow us to say when a linear combination
of the divisor classes λ and δ is ample on Mg.
Proof of the theorem
The ﬁrst step is to observe that for any cover B′ ✲B, the divisor class
F′ associated to the pullback of L to the pullback family X′ = X×BB′ is
just the pullback of F to B′. It’s thus sufﬁcient to prove the inequality
after such a base change; in particular, we may assume, if we like, that
the ﬁrst Chern class c1(E) is divisible by r + 1. Next, since the divisor
class F was speciﬁcally chosen to be invariant under tensoring L with
pullbacks of line bundles on B, we may choose a line bundle M on
B with ﬁrst Chern class c1(E)/(r + 1) and replace L by L

π−1M∨.
Thus we may assume to begin with that c1(E) = 0 and what we have
to show under this hypothesis is that c1(L)k+1 ≥0.
Now consider the natural map
ϕ : Symm(E) ✲π∗(Lm) .
For sufﬁciently large values of m, Symm(E) and π∗(Lm) will be vec-
tor bundles of ranks Or (m) =
r + m
m

and P(m) respectively where

306
6. Geometry of moduli spaces: selected results
P = PXb is the Hilbert polynomial of the ﬁber Xb of π and the map ϕ
will be generically surjective. We thus have an induced map
ψ : W = ΛP(m)
Symm(E)
 ✲ΛP(m)
π∗(Lm)

which is likewise generically surjective: since the right-hand side is a
line bundle this simply means the map isn’t identically zero.
Let us now choose a point b ∈B such that on the ﬁber Xb the line
bundle Lb is very ample and embeds Xb as a Hilbert stable variety
Xb ⊂Pr = P(E∨
b ), and consider these maps just over that point. The
kernel of ϕb is just the mth graded piece of the ideal of Xb; so the
kernel of ψb, viewed as a point in the projective space P

Wb

is just
the Hilbert point [Xb] of Xb in
G = G

P(m), Symm(Eb)

⊂P

Wb

.
Now, by the hypothesis that Xb is stable, there exists a polynomial
fb of some degree n on the vector space V := W ∨
B , with the properties
that
1. fb is invariant under the action of the group SL(Eb) on Symn(V);
2. fb([Xb]) ≠0.
The ﬁrst of these properties states that: there is a global holomorphic
section f of the bundle Symn
W

whose value at b is fb. To see this,
observe that, because the vector bundle E has zero ﬁrst Chern class,
we can choose a collection of trivializations ϕα : EUα
≊✲OUα whose
transition functions gαβ take values in SL(n, C) rather than GL(n, C).
Such trivializations induce trivializations on all the multilinear alge-
bra relatives of E; in particular, we get trivializations ϕα of Symn
W

whose transition functions gαβ preserve f. Thus, if b ∈Uα we can
simply take f to be given in each coordinate patch by the constant
polynomial fα = ϕα(fb) and the compatibilities fβ = gαβfα on the
overlaps are automatic.
The second property above says simply that the image of the section
f under the map
Symn(ψ) : Symn
W
 ✲Symn
ΛP(m)
π∗(Lm)

is nonzero at the point b. In particular, Symn 
ΛP(m) (π∗(Lm))

has a
nonzero global holomorphic section and hence
c1

Symn
ΛP(m)
π∗(Lm)

≥0.
This is all we really need to know. To start with, this implies that
c1

ΛP(m)
π∗(Lm)

= c1

π∗(Lm)

≥0.

D. Ample divisors on Mg
307
What is this last quantity? We can try to estimate it by applying the
Grothendieck-Riemann-Roch formula to the line bundle Lm on X. Of
course, this formula describes, not the Chern class of the direct image,
but the alternating sum
c1

π!(Lm)

=

i
(−1)i · c1

Riπ∗(Lm)

.
In the present circumstances, though, the higher cohomology of Lm
vanishes on every ﬁber of X ✲B, so that the higher direct images of
Lm are zero. Grothendieck-Riemann-Roch then tells us that
c1

π∗Lm
=
/
π∗

td(X/B) · ch(Lm)
0
1
= π∗
/
td(X/B) · ch(Lm)
0
k+1

= π∗
c1(Lm)k+1
(k + 1)!
+ c1(Lm)k
k!
· td1(X/B) + · · ·

= π∗

mk+1 c1(L)k+1
(k + 1)! + mk c1(Lm)k
k!
· td1(X/B) + · · ·

.
This last expression is a polynomial in m so, if it’s nonnegative for all
sufﬁciently large m, then the leading coefﬁcient must be nonnegative.
Thus, as desired, we see that
c1(L)k+1 = deg(f) ≥0.
Exercise (6.28) What inequality on the degrees of λ and δ do you
get for an arbitrary family X ✲B of stable curves by applying this
theorem to powers of the relative dualizing sheaf?
Exercise (6.29) Now let π : X ✲B be a family of stable curves, not
all singular or hyperelliptic, and let σ : B ✲X be a section with image
Σ = σ(B). Assume that Km
Xb

−nσ(b)

is very ample and embeds Xb
as a stable curve for some b so that Theorem (6.26) applies to the line
bundle ωm(−nΣ). What inequality on the degrees of λ and δ and the
intersection number ω · Σ does the theorem yield? In particular, is
it possible to improve the ratio

8 + 4
g

for families of curves not all
hyperelliptic?
The discussion that follows will shed light on this last question and
you may want to return to it after reading the remainder of this sec-
tion.

308
6. Geometry of moduli spaces: selected results
An inequality for families of pointed curves
We will consider here inequalities among the degrees of the three di-
visor classes λ, δ and ω on the moduli space Cg = Mg,1 of pointed
curves. Recall that λ here stands for the pullback of the class of the
Hodge bundle on Mg, ω = c1

ωCg/Mg

is the class of the relative
dualizing sheaf of Cg over Mg, and the total boundary class δ is the
sum of the boundary components ∆0, . . . , ∆g−1 ⊂Cg, or equivalently
the pullback of the total boundary δ of Mg. (The methods we’ll use
would allow us to obtain more precise estimates in terms of λ, ω and
the individual divisor classes δα, but we won’t go into these here).
As we indicated at the beginning of this section, the argument here
is elementary. Start with a curve B ✲Cg. After a base change, which of
course just multiplies the degrees of λ, ω and δ by a common integer,
we can assume that B arises from an actual family of stable pointed
curves, that is, a family X ✲B of nodal curves and a section σ : B ✲X
such that for each b ∈B the pair (Xb, σ(b)) is a stable pointed curve.
Replacing X by its minimal desingularization, we can assume instead
that X is smooth and that the ﬁbers (Xb, σ(b)) are semistable pointed
curves — that is, nodal curves Xb with a marked smooth point such
that every component of the normalization Xb of genus 0 contains at
least two points lying over the marked point or the nodes of Xb.
Consider now the three divisor classes on X given by
• the class f of a ﬁber of X ✲B;
• the class γ of the section Γ = σ(B) ⊂X; and,
• the class η = c1(ωX/B).
Note that the self-intersection γ2 is simply minus the intersection
number γ · η, since the relative dualizing sheaf of X/B restricts to
the normal bundle of Γ in X (in general, the intersection number of
the relative dualizing sheaf of a family X ✲B with a curve C ⊂X
will be the self-intersection of C plus the number of branch points
of C ✲B, properly counted). Next, the intersection number γ · η is
just the degree of the line bundle ω on Cg pulled back to B. Finally,
the self-intersection η2 is just the degree of the line bundle κ on Mg
pulled back to B. In particular, the reduction above in which the total
space of the stable model is replaced by its minimal desingularization
doesn’t affect the self-intersection of the relative dualizing sheaf.
We can thus write out the intersection matrix of the three classes
f, γ and η as shown in Table (6.30). Now, the subspace of the Neron-
Severi group NS(X) spanned by these three classes contains divisors
of positive self-intersection: as an example, take γ plus a large multi-
ple of f . It follows from the Hodge index theorem that the intersection
form on this subspace has one positive and two nonpositive eigenval-
ues; in particular, its determinant must be nonnegative.

D. Ample divisors on Mg
309
f
γ
η
f
0
1
2g −2
γ
1
γ2
−γ2
η
2g −2
−γ2
η2
Table (6.30)
Writing this out, we have
−2g(2g −2)γ2 −η2 ≥0 ,
which translates into the basic inequality
(6.31)
4g(g −1) · degB(ω) ≥12 · degB(λ) −degB(δ) .
Note that if X ✲B has general ﬁber smooth (and of genus g > 1),
then the term on the right is positive. In other words, the self-
intersection of a section of a family of stable curves, not all singular, is
nonpositive; if the family is nonconstant, it’s negative. Another corol-
lary follows from the observation that if X ✲B is a nonconstant family
of stable curves, not all singular, and C ⊂X is any curve of degree m
over B, then the degree of the relative dualizing sheaf ωX/B restricted
to C is greater than or equal to m ·

12 degB(λ) −degB(δ)

. In partic-
ular, we can invoke:
Seshadri’s Criterion (6.32) Let X be a projective variety and let L
be a line bundle on X. If for some ε > 0, L satisﬁes
deg

L C

> ε · multp(C)
for all curves C ⊂X and points p ∈C, then L is ample.
Since the multiplicity of a singular point p ∈C on a curve C ⊂X
is at most the degree of C over B (and since we know the relative
dualizing sheaf has positive degree on the components of the ﬁbers
of X ✲B), we may deduce the:
Theorem (6.33) If X ✲B is any nonconstant family of stable curves,
not all of whose ﬁbers are singular, then the relative dualizing sheaf
ωX/B of X over B is ample.
Problem (6.34) Is the inequality
4g(g −1) · degB(ω) ≥12 · degB(λ) −degB(δ)

310
6. Geometry of moduli spaces: selected results
optimal? Does any sharper inequality hold generally, or do there in-
stead exist one-parameter families of pointed curves for which the
ratio of the two sides is arbitrarily close to 1?
Problem (6.35) Can we ﬁnd a more exact collection of inequalities
on the degrees of the divisor classes λ, ω and δi on a one-parameter
family of pointed curves? To be more precise, can we describe the
cone in Rg−2 of linear combinations of λ, ω and the δi that have
nonnegative degree on every family?
Problem (6.36) Do the results above have analogues for multiply-
pointed curves? That is, can we ﬁnd inequalities on the degrees of the
restrictions to one-parameter families of the various divisor classes on
the moduli space Mg,n? This is already a fairly substantial problem
in case g = 0 (cf. [105]). A ﬁrst step, however, would be to look for
inequalities in which the set of divisor classes δi corresponding to
degenerations of the underlying curve, as well as the set of boundary
components corresponding to points coming together are grouped
much as the δi are in this section.
Exercise (6.37) We can now make the question asked at the end of
Exercise (6.29) slightly more precise. For example, we ask: can we do
better than (6.31) for a family π : X ✲B of stable pointed curves with
section σ : B ✲X if we assume that the general curve Xb is embedded
as a stable curve by the line bundle ωXb(−σ(b))?
Ample divisors on Mg
Combining the results of the preceding section and this one, we see
that the inequality

8 + 4
g

degB(λ) ≥degB(δ)
holds for any family X ✲B of stable curves whose general member
is smooth. What about families X ✲B whose general member is sin-
gular? We can use the inequalities of the last subsection to estimate
the degrees of the line bundles λ and δ on these, and ultimately to
show the ampleness of certain linear combinations of these two line
bundles.
To set this up, let X ✲B be a family of stable curves whose general
ﬁber has d nodes. By way of terminology, we’ll call those nodes of a
ﬁber Xb that are specializations of the nodes on a general ﬁber the
general nodes of Xb, and call those nodes of Xb that aren’t limits
of nodes on nearby ﬁbers the special nodes of Xb. Thus, every ﬁber

D. Ample divisors on Mg
311
will have exactly d general nodes and a ﬁnite number will have some
special nodes as well.
Let Y ✲X be the normalization of the total space of X: that is,
Y ✲B is the family whose ﬁber Yb over any b ∈B is the partial nor-
malization of Xb at its general nodes. After making a base change, we
can assume that there are 2d sections σ1, . . . , σ2d : B ✲Y whose im-
ages Γl meet a ﬁber Yb in the points lying over the general nodes of the
corresponding ﬁber Xb. Note that the general ﬁber Yb of Y ✲B will
be reducible if the general ﬁber of X ✲B is. If so, then after a further
base change we may assume that Y itself is the disjoint union of a
collection of families Yi ✲B with connected ﬁbers. The exercise be-
low shows that any ﬁber of one of the Yi, together with those marked
points σi(b) lying on it, is a stable pointed curve. Finally, we replace
each Yi by its minimal desingularization (so that now each ﬁber of Yi
is a semistable pointed curve).
Exercise (6.38) Let (C, p1, . . . , pn) be a stable n-pointed curve. Let
πS : CS ✲C be the partial normalization of C at a set S of nodes. Make
each connected component D of CS into a pointed curve by marking
the points on D that map under π to either a marked point of C or a
node lying in S. Show that each such component D is then stable as a
pointed curve .
We’re now ready to describe the degrees of the divisor classes λ
and δ on B associated to the family X ✲B in terms of the corre-
sponding classes λi and δi associated to the families Yi ✲B and the
self-intersections (Γl)2 of the images of the sections σl : B ✲Yi. We
have
deg(λ) =

i
deg(λi)
and
deg(δ) =

i
deg(δi) +

l
(Γl)2 .
Given this, what is the largest possible ratio of deg(δ) to deg(λ)? The
ﬁrst thing to notice is that components Yi ✲B whose general ﬁber has
large genus gi do not help maximize this ratio: for such a component
we’ll have deg(δi) ≤(8 + 4/gi) · deg(λi), and the sections Γl lying
on Yi will have negative self-intersection, bringing the total degree of
δ down further. Components Yi with ﬁbers of genus 1 do better: we
have
deg(δi) = 12 · deg(λi);
and while we do have to have at least one section Γα lying on Yi, its self-
intersection will be simply −deg(λi). We can thus make up a family
of any genus g with
deg(δ) = 11 · deg(λ) :

312
6. Geometry of moduli spaces: selected results
just take a constant family C ×B ✲B of smooth curves of genus g −1,
with constant section Γ = {p}×B, and attach any family of semistable
curves of genus 1 — for example, take a pencil {Eλ} of plane cubics,
choose a base point q of the pencil, and attach each Eλ to C by iden-
tifying p with q as shown, schematically, in Figure (6.39).
Figure (6.39)
Can we do better than 11? Clearly, we can do this only by including
components Yi whose general ﬁber is rational; so we have to investi-
gate the contributions of these. But we’ve already done this in effect
in the preceding section: each family Yi ✲B is a family of nodal ratio-
nal curves with smooth total space (and at most two components in
each ﬁber). If ni of the disjoint sections Γl lie on Yi, then applying Ex-
ercise (6.22), we have
(ni −1) ·

l
Γ 2
l = −

j
j(ni −j) · dj
where dj is the number of singular ﬁbers with j of the ni sections
passing through one component and ni−j passing through the other.
Given that in our present circumstance each ni ≥3, we see that the
sum of the self-intersections of the sections Γl is less than or equal to
minus the number of singular ﬁbers. A component Yi ✲B with rational
ﬁber thus contributes nothing to λ and a negative quantity to δ, so that
in fact the ratio of 11 obtained above is the best (or worst, depending
on your point of view) we can do. We deduce the:
Theorem (6.40) (Cornalba-Harris [27]) For any positive integers
a and b, the divisor class aλ−bδ is ample on Mg if and only if a > 11b.
The following exercise is a warning against the temptation to con-
clude that λ itself is ample on Mg: that, in other words, we can let
b = 0 above.

E. Irreducibility of the Severi varieties
313
Exercise (6.41) Let Y ✲B be the family of stable curves obtained by
identifying a ﬁxed point on a ﬁxed smooth curve C1 of genus g1 with
a variable point on a ﬁxed curve C2 of genus g2 = g −g1. Show that
degB(λ) = 0 and hence that the linear system given by any multiple
of λ contracts the image of B in Mg.
Theorem (6.40) suggests numerous variations that, to our knowl-
edge, have never been worked out. First, we can, as usual, ask what
happens if we consider the boundary components individually:
Problem (6.42) What linear combinations of the classes λ and
δ0, . . . , δ⌊g/2⌋are ample on Mg?
Next, we can ask for extensions to moduli spaces of n-pointed
curves. A ﬁrst question is:
Problem (6.43) What linear combinations of λ, δ and ω are ample
on the moduli space Cg of one-pointed curves?
Note ﬁnally that, among all generically smooth one-parameter fam-
ilies of stable curves, the ones that we’ve seen achieve the maximum
ratio of deg(δ) to deg(λ) consist entirely of hyperelliptic curves. We
could ask: does a stronger inequality hold for families not contained
in the hyperelliptic locus? How about trigonal curves, and so on? All
of this motivates the:
Problem (6.44) Deﬁne, as usual, a stable curve to be hyperelliptic,
trigonal, etc. if it’s the limit of smooth curves in the corresponding
locus inMg. What linear combinations of λ and δ are ample when
restricted to the locus of hyperelliptic, or of trigonal curves in Mg?
The best results to date on this question are due to Stankova-
Frenkel [143].
E
Irreducibility of the Severi varieties
In this section we’ll sketch a proof of the result stated in Chapter 1 as
the third part of Theorem (1.49): that the family of irreducible plane
curves of given degree and (geometric) genus is irreducible. This is a
topic that draws upon many of the ideas we’ve developed in the pre-
ceding chapters; in fact, it represents one of the best examples of how
we can combine the insights obtained from both the parameter space
and moduli-theoretic viewpoints to analyze a family of curves. The
reason why the abstract and projective viewpoints are both involved
may not be clear from a ﬁrst glance at the problem, but it should
emerge in the course of the following reductions.

314
6. Geometry of moduli spaces: selected results
Initial reductions
Let’s ﬁrst ask the naive question, why should we expect such a the-
orem to be true? After all, we’ve seen that the Hilbert schemes pa-
rameterizing irreducible, nondegenerate curves of ﬁxed degree and
genus in higher-dimensional projective spaces are only very rarely ir-
reducible. What about the geometry of plane curves should make them
different?
The ﬁrst answer was given by Severi [140]. (Indeed, although there
are now a number of proofs given of the theorem, they all go back to
this answer in the end.) Severi’s idea was to look at degenerations of
the curves parameterized by a given component of the Severi variety.
Speciﬁcally, Severi claimed that if we let PN be the space of all plane
curves of degree d, let m =
d −1
2

be the genus of a smooth curve
of degree d, and Vd,g ⊂PN be the variety of irreducible nodal plane
curves of degree d and geometric genus g (or, equivalently, with ex-
actly δ = m −g nodes), then the closure of any component Σ of Vd,g
must contain the variety Vd,0 of rational nodal plane curves. (Observe
that a rational nodal plane curve of degree d is the same thing as an
irreducible nodal curve of degree d with exactly m nodes).
To see why this implies the irreducibility of Vd,g, observe ﬁrst that
the variety Vd,0 is irreducible, since all rational nodal curves of de-
gree d are simply projections of the rational normal curve X ⊂Pd
from various subspaces Λ ≊Pd−3 ⊂Pd to a plane Γ ≊P2. This
gives a dominant rational map from the product of the Grassman-
nian G(d −3, d) with the variety PGL3 of isomorphisms of Γ with P2
to the Severi variety Vd,0, showing that Vd,0 is irreducible.
In fact, more is true. Given a family of nodal curves Ct ∈Vd,0,
the m =
d −1
2

nodes p1, . . . , pm vary continuously, tracing out arcs
p1(t), . . . , pm(t). We claim that not only can we ﬁnd such a family {Ct}
of nodal curves joining any two given ones C0 and C1 in Vd,0, but we
can ﬁnd one such that the arcs p1(t), . . . , pm(t) induce an arbitrary
bijection between the nodes pi(0) of C0 and the nodes pi(1) of C1. In
other words, the monodromy in the family Vd,0 acts on the nodes of
C0 as the full symmetric group on m letters. To see this, note that a
nodal curve C ⊂P2 may be represented as above as the projection of a
rational normal curve X ⊂Pd from a plane Λ ≊Pd−3 ⊂Pd; the nodes
of C correspond to the points of intersection of Λ with the chordal
variety of X. Our monodromy assertion then follows from the:
Uniform position principle (6.45) If Z is any nondegenerate irre-
ducible variety of dimension k and degree d in Pn, and Λ ≊Pn−k ⊂Pn
is a subspace meeting Z transversely at points p1, . . . , pd, then, as we
vary Λ ∈G(n−k, n) in the open subset U of planes transverse to Z, the
monodromy acts on the points pi as the symmetric group on d letters.

E. Irreducibility of the Severi varieties
315
For a proof (and other applications) of this statement, see [7] or [78].
In our present circumstances, it gives us a picture of what the clo-
sure V d,g of the variety Vd,g must look like in a neighborhood of
Vd,0. To begin with, let [C0] ∈Vd,0 correspond to a curve C0 ⊂P2
with nodes p1, . . . , pm. We’ve seen in our discussion of deformation
theory that a neighborhood of [C0] in PN will map to the product
of the deformation spaces of the singularities (C0, pi) (which are
each smooth and one-dimensional). This means that we have local
coordinates z1, . . . , zN on PN in a neighborhood of [C0] in terms of
which Vd,0 is the codimension m coordinate subspace with equations
z1 = · · · = zm = 0, and the closure V d,g is the union of the codi-
mension δ-coordinate planes zi1 = · · · = ziδ = 0 determined by all
δ-element subsets {i1, . . . , iδ} of {1, . . . , m} — in other words, for any
subset I of m −δ of the nodes of C0, there is a (smooth) branch ΣI
of V d,g near [C0] such that a deformation of C0 in ΣI smooths all the
nodes in I and none of the δ others. The schematic picture is that like
that in Figure (6.46) (where we have taken m = 2 and δ = 1).
Vd,g
Vd,0
[C0]
Figure (6.46)
Thus, V d,g isn’t locally irreducible at [C0]; rather, it has
m
δ

branches. But, as [C0] varies in Vd,0, the monodromy acts transitively
on these branches. Since any irreducible component of Vd,g containing
Vd,0 in its closure must contain one of the branches of Vd,g near Vd,0,
it must therefore contain them all. Thus, in order to demonstrate the
irreducibility of Vd,g it’s enough to show that any irreducible compo-
nent of Vd,g must contain Vd,0 in its closure. As an obvious extension,
we have the:
First Reduction: It’s sufﬁcient to show that any irreducible component
of Vd,g contains in its closure an irreducible component of Vd,g′
for some g′ < g.

316
6. Geometry of moduli spaces: selected results
We can get away with even less because the picture of Vd,g and Vd,g′
in a neighborhood of a point [C0] ∈Vd,g′ corresponding to a curve C0
with m −g′ nodes looks very much like the one above — that is, Vd,g
is locally a union of sheets on each of which some (g −g′)-element
subset of the nodes of C0 smooth. Thus:
Second Reduction: It’s sufﬁcient to show that any irreducible compo-
nent of Vd,g contains in its closure a point [C0] corresponding
to a nodal curve C0 of genus g′ < g.
This reduction seems to be what convinced many that Vd,g is irre-
ducible: it certainly seems plausible enough that any component of
Vd,g must include in its closure, for example, curves with δ+1 nodes.
However, it turns out to be something of a red herring for us: our
proof will use a statement that reduces the irreducibility of Vd,g to
the existence of a more general degeneration in its closure.
We will eventually produce such a degeneration, but our path to it
will be circuitous. Why can’t we proceed directly? All we need to do
is to show that every component of Vd,g admits the simplest kind of
degenerations. Moreover, it’s not hard to see that every component
W of Vd,g contains degenerations in its closure. For example, we can
just choose any [C] ∈W meeting the line Z0 transversely, and take
the limit as t goes to zero of the curves Ct obtained from C = C1 by
applying the linear transformation ψt(Z0, Z1, Z2) = (tZ0, Z1, Z2). This
yields a point [C0] in W corresponding to a curve C0 consisting of d
concurrent lines. Alternatively, assuming C doesn’t contain the point
Z0 = Z1 = 0, we can take the limit as t ✲∞, which is a d-fold line.
(Severi tried to use the presence of these degenerations to prove the
theorem; but no one has seen any way to make his arguments precise.)
Yet another way to exhibit degenerations is to observe that, for any
point p ∈P2, the locus of curves containing p is a hyperplane in the
space PN of plane curves of degree d. By taking points p1, p2, . . . , pd+1
lying on a line L ⊂P2, we deduce that W contains curves containing all
the pi and hence containing L. The problem here is that the presence
of these possibly wild degenerations doesn’t guarantee that W admits
the milder degenerations to nodal curves required by the reductions.
Another approach to showing that every component of Vd,g admits
degenerations is to apply Diaz’ theorem (2.34) that Mg doesn’t con-
tain any complete subvarieties of dimension g −1. Consider the ra-
tional map
ϕ : Vd,g
✲Mg .
Since any component of W r
d (C) whose general member is birationally
very ample has dimension at most d −3r (cf. Exercise IV-E-2 of [7]),
the ﬁbers of ϕ cannot have dimension greater than d + 2. Since the
dimension of Vd,g is 3d + g −1, Diaz concluded that the closure in

E. Irreducibility of the Severi varieties
317
Mg of the image of ϕ on any component W of Vd,g necessarily meets
the boundary ∆⊂Mg. An arc in W whose image in Mg tended to ∆
would certainly induce a family of curves degenerating in moduli. The
existence of even such families had not previously been known. Here
again, however, there seems to be no way to control the singularities
of the limiting model in P2 and hence to conclude the irreducibility
of Vd,g. A priori, every such arc in W might tend, for example, to a
nonreduced curve.
These considerations make it clear that what we really need here
isn’t simply to degenerate, but to do so retaining some control over the
limiting curve, i.e., to exhibit in the closure of any W reduced curves
having lower geometric genus but still reasonably mild singularities.
The question is, how do we exert such control? For example, we’ve
seen that in W there are curves that contain a line L, but how do
we rule out the possibility that every such curve is just a d-tuple of
concurrent lines?
To surmount these difﬁculties, the key extra idea is to keep track
of dimensions, or degrees of freedom, in our families. Using this, we’ll
make two further reductions. In the end, these reductions won’t be
used in the proof; however, they help us come to grips with the dif-
ﬁculties discussed above and lead to the kind of degenerations we’ll
study in the next subsection.
How does keeping track of dimensions help us rule out, for example,
the possibility that every curve in W containing L is a d-tuple of con-
current lines? Simply, we know that the dimension of W is 3d+g −1,
and so the locus in W of curves containing L is, by the argument
above, of dimension at least dim(W) −(d + 1) = 2d + g −2. But
the family of d-tuples of concurrent lines including L has dimension
just d.
As another example, recall that, by Lemma (3.45), any locus
W ′ ⊂PN consisting of curves of degree d and genus g′ < g and
having dimension 3d + g −2 must be open in a component of Ud,g−1.
We conclude that:
Third Reduction: It’s sufﬁcient to show that if W is any component
of Vd,g, then W −W has codimension 1: i.e., that W contains a
locus of codimension 1 consisting of curves other than reduced
curves of geometric genus g.
Now, clearly the ﬁrst two constructions of degenerations given
above will not produce such loci. Diaz’ construction, on the other
hand, seems a much better bet: after all, all we have to show is that the
inverse image, under the map ϕ, of the boundary ∆⊂Mg has codi-
mension 1 in W. Since ∆has codimension 1 in Mg (and is even the
support of a Cartier divisor), this, at ﬁrst, seems promising. The difﬁ-
culty now is that ϕ isn’t a regular map, only a rational one. When we

318
6. Geometry of moduli spaces: selected results
talk loosely about the inverse image of ∆, we really mean ϕ1(ϕ−1
2 (∆)),
where ϕ1 and ϕ2 are the projection maps from the graph T of ϕ
to W and Mg respectively. And, while ϕ−1
2 (∆) will necessarily have
codimension 1 in T , the ﬁbers of ϕ1 on ϕ−1
2 (∆) may be positive-
dimensional.
{[C0]} = ϕ−1(∆1)
b
a
locus of singular curves
= ϕ−1 (∆0)
Figure (6.47)
To see that this really happens, consider a family of plane curves
over a two-dimensional base W, generically smooth in a neighborhood
of a point p ∈P2 and specializing to a curve C0 with a cusp at p — e.g.,
the family given, in terms of afﬁne coordinates x, y on P2 near p and
a, b on W near [C0], by the equation y2 = x3 + ax + b as sketched in
Figure (6.47). Assuming the curves Cλ are well-behaved away from p,
the map ϕ : W ✲Mg will be deﬁned everywhere except at the origin
a = b = 0 in W. There, however, it’s undeﬁned, and we’ll have to blow
up three times — once at the origin and then at the intersection of the
ﬁrst two exceptional divisors with the proper transform on the a-axis
— to resolve it. The map will then blow down the ﬁrst two exceptional
divisors, so the graph T of ϕ will be as shown in Figure (6.48). This is
the basic example of a situation where a divisor in Mg — in this case,
∆1 — may have inverse image of codimension greater than 1 in W.
A second example, not involving singularities, can be obtained by
considering the rational map ϕ : W = P14
✲M3 from the space
of plane quartics to their moduli. In M3, the locus H of hyperelliptic
curves is a divisor; but anytime we have a family of smooth curves
of genus 3 approaching a hyperelliptic one, the canonical models will
tend to a double conic, and the locus S in P14 of double conics is of
course ﬁve-dimensional. What’s going on here is again simple to de-
scribe, at least over a general point of H: the map ϕ is blowing up the
locus S, replacing points [2C] ∈S with pairs (2C, D) where D is a nor-
mal direction to H in P14, represented by a divisor D ∈|O2C(4)|, and

E. Irreducibility of the Severi varieties
319
ϕ−1
2
(∆0) :
stable curve is
ϕ−1
2
(∆0 ∩∆1) :
stable curve is
ϕ−1
2
(∆1) :
stable curve is
C0/p ∼q
C0
C0
E
Figure (6.48)
mapping the pair (2C, D) to the curve of genus 3 given as the double
cover of C ≊P1 branched over the eight points of D. (Incidentally, the
inverse image ϕ−1(H) doesn’t have codimension 9 in P14, but codi-
mension 3: the locus in M3 of curves consisting of two elliptic curves
meeting at two points lies in H, and its inverse image in P14 contains
the locus of quartics with a tacnode.)
In any event, it’s clear that to ﬁnd a locus of codimension 1 in W
consisting of curves of lower geometric genus, we need to ﬁnd a point
[C] ∈ϕ−1(∆) ⊂W such that the ﬁber of ϕ−1
2 (∆) ⊂T over [C] is
(ideally) ﬁnite or, failing this, at least contains an isolated point. Now,
one circumstance in which a point (C, D) ∈T will be an isolated point
of ϕ−1
2 (∆)∩ϕ−1
1 ({[C]}) is when the stable curve D is stably equivalent
to a nodal partial normalization of the plane curve C — there are only
ﬁnitely many nodal partial normalizations of a given curve. We have
thus arrived at the ﬁnal reduction:
Fourth Reduction: It’s sufﬁcient to exhibit in any component W of
Vd,g an arc B ⊂W with parameter t such that B −{0} lies in W
but {0} does not, and such that the stable limit of the normal-
izations of the curves Ct as t ✲0 is a singular curve (i.e., maps
to a point of the boundary ∆of Mg) that is stably equivalent to
a partial normalization of the curve C0.

320
6. Geometry of moduli spaces: selected results
There is one point about this reduction that doesn’t follow from the
preceding discussion. The stable limit X0 of the normalizations Xλ of
the Cλ need not automatically lie in the boundary ∆⊂Mg under the
other hypotheses of the reduction. However, if X0 is indeed smooth,
then letting Lt be the pullback of OP2(1) to Xt and L0 the limit on X0
of the Lt’s, then the subspace V0 ⊂H0(Xt, Lt) giving the maps from
Xt to P2 will have a base point. This implies that the corresponding
locus in Vd,g has pure codimension 1, and hence consists generically
of nodal curves with δ + 1 nodes, so in this case the result follows
immediately.
Analyzing a degeneration
With this said, let V be an arbitrary component of the closed Severi
variety V d,g. We will ﬁnd the sort of one-parameter family of curves
in V we want by looking at curves C in V containing a line. To do this,
we ﬁx a line L in P2 and d points p1, . . . , pd lying on L, and let V0 ⊂V
be the closure of the locus of irreducible, nodal curves containing
p1, . . . , pd. (We can ensure that V0 is nonempty by choosing the points
p1, . . . , pd to be the intersection of L with a general member of V.) Note
that by Lemma (3.45), the dimension of V0 is exactly 2d + g −1.
Now choose one more point pd+1 ∈L, let H ⊂PN be the hyperplane
of plane curves containing Pd+1 and let W = V0 ∩H. Of course, W
will consist entirely of curves containing L. Note also that, being the
intersection of V0 with a hyperplane, W will have dimension exactly
2d + g −2.
Let [C0] ∈W be a general point of any component of W. Our initial
goal will be to describe the curve C = C0, and our tool will be the
method of semistable reduction.
To carry this out, let {[Ct]}t∈∆be an arc in V 0 meeting W trans-
versely at [C0], with Ct irreducible and nodal for t ≠0. Let Xt be the
normalization of Ct for t ≠0; the curves Xt form the ﬁbers of a fam-
ily X∗✲∆∗over the punctured disc, and the normalization maps
ηt : Xt ✲Ct string together to form a map η : X∗✲P2. Applying
nodal reduction [Proposition (3.49)], we can (after base change) com-
plete this family to a family π : X ✲∆of nodal curves, proper over ∆
and satisfying the conditions that
1. the total space of X is smooth;
2. there is a regular map η
:
X ✲P2 restricting to the map
ηt : Xt ✲Ct on each ﬁber Xt of π over ∆∗; and
3. X is minimal with respect to these properties; i.e., there are no
rational components of the central ﬁber X0 meeting the rest of
the central ﬁber only once and on which the map η is constant.

E. Irreducibility of the Severi varieties
321
We have, of course, no a priori idea of what the central ﬁber X0 of
this family looks like, or how the map η0 behaves. However, we’ll see
that the information we do have — that η0 has degree d, that X0 has
arithmetic genus g, and that η0 is the limit of maps ηλ whose images
contain the points pi — combined with the basic dimension estimates
above allow us to describe X0 completely.
We start by introducing some notation. By construction, the image
C0 of η0 contains the line L. Let Y0 ⊂X0 be the union of the com-
ponents of X0 mapping to L, let Y1 be the union of the remaining
components, and let q1, . . . , qk be the points of intersection of Y0 and
Y1. Denote by α the degree of η0 on the curve Y0, so that we can write
C0 = α · L + D
where D is the image of Y1 under η0. Clearly a crucial part of our
analysis must be to control α: it turns out that α must equal 1. A con-
Y0
Y1
Z
Figure (6.49)
sequence will be that X0 looks schematically as shown in Figure (6.49):
Y0 is a tree of curves (all, in fact, rational) whose root Z (shown thick-
ened) maps isomorphically under η to L and whose leaves each meet
Y1 in one of the points qi (shown as dots).
To express the fact that η0 is the limit of maps whose images contain
the points pi so that we can apply this hypothesis, let Σ∗
i be the inverse
image of the point pi in X∗, and let Σi be its closure. Observe that
since the total space X is smooth, the sections Σi of π must meet the
central ﬁber X0 in smooth points of X0. We can now write
(6.50)
η∗L = Σ1 + · · · + Σd + M,

322
6. Geometry of moduli spaces: selected results
where M is a divisor whose support is exactly the curve Y0. In partic-
ular, the only points of Y1 lying over a point of L other than one of
the pi are the points q1, . . . , qk of intersection of Y1 with Y0. In fact,
we can reﬁne this a little: of the k points qi, suppose that β lie on
connected components of Y0 on which η isn’t constant, and γ = k −β
on connected components of Y0 on which η is constant. A connected
component Y of Y0 on which η is constant must meet one of the sec-
tions Σi and hence map to one of the points pi: if Y were disjoint from
all Σi, then the part MY of the divisor M supported on Y would have
self-intersection (MY · MY ) = (MY · η∗L) = 0, contradicting the fact
that any divisor supported on a proper subset of a ﬁber of π must
have negative self-intersection. Thus, there can be at most β points
of Y1 lying over points of L other than the pi. (Note that, since every
connected component of Y1 must meet Y0, η can’t be constant on any
connected component of Y1.)
The key question to ask is now: what is the geometric genus g1 of
Y1? To estimate this, we use the fact that the arithmetic genus of the
whole ﬁber X0 is g; it follows that
pa(Y0) + pa(Y1) + k −1 = g.
Now, since every connected component of Y0 must meet Y1, Y0 can
have at most k connected components. In fact, we can do a little bet-
ter: there are at most γ connected components of Y0 on which η is
constant, and at most α connected components on which it’s noncon-
stant. Thus
pa(Y0) ≥1 −γ −α
= 1 −k + β −α
and hence
(6.51)
g(Y1) ≤pa(Y1)
= g + 1 −k −pa(Y0)
≤g + α −β.
Now let’s assemble what we know about D = η(Y1). It’s the image
of the nodal curve Y1 of geometric genus at most g + α −β via the
map η of degree d −α. Moreover, η isn’t constant on any connected
component of Y1, and it takes at most β points of Y1 to points of L
other than p1, . . . , pd. By Corollary (3.46), such curves form a family
of dimension at most
(6.52)
2(d −α) + (g + α −β) + β −1 = 2d + g −1 −α .

E. Irreducibility of the Severi varieties
323
On the other hand, the curve D moves in the (2d+g −2)-dimensional
family of plane curves W. We conclude that 2d+g−2 ≤2d+g−1−α.
Therefore, equality is only possible if α = 1 and if, moreover, all the
upper bounds used in obtaining the estimate (6.52), and in the appli-
cation of Corollary (3.46), are in fact exact. A whole series of conse-
quences follow:
1. Y0 is connected: it consists of a tree with one irreducible com-
ponent Z mapping isomorphically to L, plus chains of rational
curves joining Z to the points q1, . . . , qk on Y1. In particular,
γ = 0 and β = k.
2. Y1 is smooth of genus g + 1 −k.
3. The stable limit of the curves Xt is the union X0 of Y1 and Z ≊P1,
joined at the k points q1, . . . , qk (or the curve we get from this
by contracting Z if k = 1 or 2).
First, the sharpness of the estimate (6.51) for the genus of Y1 im-
plies that any connected component of Y0 has arithmetic genus 0, so
is a tree of rational curves. Moreover, any connected component of Y0
on which η is constant can meet Y1 in only one point, since equality in
the dimension statement of Corollary (3.46) implies that the k points
of Y0 ∩Y1 map via η to distinct points of L. Since each connected com-
ponent of Y0 is a tree, the minimality hypothesis in the construction of
X implies that there are no connected components of Y0 on which η
is constant. Equivalently, we must have γ = 0 and β = k. Since α = 1,
there is exactly one component of Y0 on which η is nonconstant. This
gives the ﬁrst consequence. The chain of inequalities in (6.51) must
also be sharp: i.e., g(Y1) = pa(Y1) = g + 1 −k, which gives the second
consequence. The third is then immediate from the ﬁrst two.
Our analysis also gives us a fairly precise picture of what is hap-
pening to the plane models. Since the k points q1, . . . , qk don’t map to
points pi, the points of Y1 that do map to points pi are points of inter-
section of Y1 with the sections Σi; in particular, since each Σi occurs
with multiplicity 1 in η∗L, we see that whenever the image D of Y1
meets L at a point pi, it does so transversely. Thus D is a nodal curve
of degree d−1 (thus having δ−d+k+1 nodes), meeting L transversely
at a subset of l the points pi and at k further points ri = η(qi) which
are smooth on D.
In sum, the picture of the degeneration is this: as Ct tends to
C0 = L ∪D, we see a node tending to each of the l points pi lying
on D. The curve D meets L in k other points ri, and if mi is the order
of contact of D with L at ri, then we’ll see mi −1 nodes of Ct tending
to ri. Note that l may be zero — i.e., D may miss all of the points pi
— but k cannot be; D must contain at least one point of L other than

324
6. Geometry of moduli spaces: selected results
the pi. Also, observe that there is only one other restriction on the
numbers k and l: l must be at least δ. As for the multiplicities mi of
intersection of D with L at the points ri, they have to satisfy only the
restriction that

(mi −1) ≤δ −l. The components of the variety W
are thus classiﬁed by the sequences (l, m1, . . . , mk) satisfying these
inequalities.
We repeat, for emphasis, that this analysis applies only to a family
of curves in V0 tending to a general point of a component of the hy-
perplane section W of V0; obviously, in an arbitrary family tending to
a point of W, things can happen that would curl your toenails.
We have now almost arrived at a family meeting the conditions of
the fourth reduction. Before completing the argument, however, we’ll
pause to give an example making explicit the general constructions of
this subsection.
An example
p1
D
L
p2, . . . , p8
Figure (6.53)
To make the preceding general analysis a bit more concrete, consider
a family Ct of plane curves of degree 8 and genus 16 meeting a line
L in ﬁxed points p1, . . . , p8, and specializing to a curve C0 containing
L as above — that is, with C0 a general point of a component of the
locus of curves in the closure of V8,16 containing L. The limiting curve
will then consist of the line L plus an irreducible nodal septimic D
meeting L at smooth points. One possibility, consistent with all our
restrictions, is that D will pass through p1 but none of the points
p2, . . . , p8, will meet L three times away from p1, once transversely,
once in a point of simple tangency, and once with contact of order 3,
and will have single node not lying on L: a schematic diagram is shown
in Figure (6.53)
In this case, the central ﬁber X0 of the family π : X ✲∆constructed
above will look like Figure (6.54). There, Y1 is the normalization of D
and all the other curves shown are components of Y0 and are rational
with the unique component Z mapping onto L under η shown at the
left. If we write η∗L =

Σi+M, then the numbers next to components
of Y0 are the multiplicities with which each appears in M; these are

E. Irreducibility of the Severi varieties
325
Y1
Z
6
5
4
3
2
1
4
2
3
Σ1
Σ2, . . . , Σ8
Figure (6.54)
dictated by the requirements that η be constant on all but one com-
ponent, so that the degree of η∗L =

Γi +M on all other components
of Y0 is zero, and that M meet Y1 with multiplicities 1, 2 and 3.
Exercise (6.55) Verify the multiplicities in Figure (6.54)
P1
Y1
Figure (6.56)
The stable reduction of X0, shown in Figure (6.56) thus is the union
of the curve Y1 with a copy of P1 — the image of Z — meeting it at three
points (which, in the notation of the preceding subsection would be
q1, q2 and q3) or in other words the partial normalization of the curve

326
6. Geometry of moduli spaces: selected results
C0 in which the two branches at p1 are separated, and the remaining
singularities of C0 are reduced to nodes.
What we would actually see, if we then looked at the entire family,
would be one of the ﬁve nodes of the general member Ct tending to
the point p1, one tending to the point where D is simply tangent to L,
two tending to the point where D has contact or order 3 with L, and,
ﬁnally, one staying away from L and arriving at the (unique) node of
D itself.
Completing the argument
The general analysis carried out earlier in this section produces a fam-
ily that is very close to meeting the conditions of the fourth reduction.
The only point that isn’t clear is that the stable limit of the normal-
izations Xt of the curves Ct really is singular. In fact, there will be
components of W such that the stable limit of the normalizations of
a family of curves Ct tending to a general point [C0] ∈W is simply
a smooth curve of genus g, mapped to the plane by a linear series
of degree d −1 or less. In these cases, we would like to be able to
conclude that there is still a codimension 1 component of the bound-
ary V d,g \ Vd,g containing [C0], and so apply the third reduction. We
won’t do this here simply because the details are lengthy. We leave it
as an exercise for you to carry out the modiﬁcations of the previous ar-
guments necessary to make this approach work, if you’re interested.
Instead, we’ll give an alternative argument in which we use a local
analysis based on facts about deformations of tacnodes as a shortcut
to deducing the existence of a degeneration to a nodal curve of lower
geometric genus from the existence of the degenerations constructed
above.
Recall that the singularities of C0 = L ∪D along the line L are two-
branch double points, consisting of L plus a smooth arc having contact
of order say m with L. Such a singularity may be given by a local
equation y2 + x2m, and its versal deformation given by the family of
curves
(6.57)
y2 + x2m + a2m−2x2m−2 + · · · + a1x + a0
parameterized by a0, . . . , a2m−2 — that is, the versal deformation
space A is an ´etale neighborhood of the origin in afﬁne (2m −1)-
space with coordinates a0, . . . , a2m−2.
Within this deformation space, there are two loci of particular in-
terest to us. One is the equigeneric locus B, deﬁned to be the locus
of δ-constant deformations, or deformations that preserve the total
contribution of the singularity to the geometric genus. In general, for
a singularity (C, p) with contribution δ = length(O C,p/OC,p) = m,

E. Irreducibility of the Severi varieties
327
this will be the closure of the locus of curves with m nodes; in our
present case, it’s the locus of (a0, . . . , a2m−2) such that the polynomial
f(x) = x2m + a2m−2x2m−2 + · · · + a1x + a0 has m double roots. Us-
ing the vanishing of the x2m−1 coefﬁcient in (6.57), this locus is given
parametrically by
f (x) = (x −λ1)2 (x −λ2)2 · · · (x −λm−1)2

x +
m−1

i=1
λi
2
;
in particular, we see that it’s irreducible of dimension m −1 in A.
Exercise (6.58) Show, more generally, that the codimension of the
δ-constant locus in the versal deformation space of a plane curve sin-
gularity is always δ.
The second locus B′ ⊂A of interest to us is the closure of the locus
of curves with m −1 nodes nearby. This is given parametrically as
f(x) = (x −λ1)2 (x −λ2)2 · · · (x −λm−1)2 (x −µ)

x + µ + 2
m−1

i=1
λi

and so is irreducible of dimension m.
We now consider how this relates to deformations of C0 as a plane
curve. Speciﬁcally, we take U to be the component of an ´etale neigh-
borhood of the point [C0] in V containing the arc {[Ct]} constructed
in the preceding subsections, and look at the induced map ψ from U
to the product of the deformation spaces Ai of the k singular points
ri ∈C0. We ﬁrst observe that the ﬁber of U over the point [C0] con-
sists entirely of reducible curves D = L′ ∪D′ where L′ is a line and D′
has degree d −1. Moreover, the singularities of D′ consist of exactly
δ −d + k + 1 nodes (i.e., D′ is nodal of geometric genus g −k + 1), and
D′ meets L′ at smooth points with multiplicities m1, . . . , mk.
By our earlier dimension counts, D′ has 3(d −1) + (g −k + 1) −1
moduli. Adding 2 moduli for L′ and subtracting the (mi −1) condi-
tions imposed by the ith multiplicity, the dimension of this ﬁber is
thus
3(d −1) + (g −k + 1) −1 + 2 −
k

i=1
(mi −1) = 3d −1 + g −
k

i=1
mi .
On the other hand, the map ψ carries U into the product of the sub-
spaces B′
i corresponding to deformations of C0 to curves with mi −1
nodes near rt. Since this product has dimension

i mi and U itself
has dimension 3d + g −1, we deduce that ψ maps U surjectively onto
it. In particular, the image of ψ must also contain the product of the
equigeneric subspaces Bi.

328
6. Geometry of moduli spaces: selected results
Therefore, the deformations of C0 in U ⊂V include nodal curves
with δ + k nodes. This is exactly the statement we need to apply the
last of the initial reductions above and complete the proof of the ir-
reducibility of Vd,g.
F
Kodaira dimension of Mg
In this section, we’ll show how the theory of limit linear series, in
combination with our description of the Picard group of Mg, may be
used to prove that:
Theorem (6.59) (Harris-Mumford Theorem, [82] and [79]) The
moduli space of curves of genus g is of general type if g ≥24, and has
Kodaira dimension at least 1 if g = 23.
Before undertaking this, we should say a few words about the back-
ground of the problem.
Writing down general curves
If someone put a gun to your head and demanded that you show him
this “general curve of genus 2” that everyone was proving theorems
about — in other words, that you write down the equation of a general
curve of genus 2 — you would have no problem: you would whip out
your pen, write
y2 = x6 + a5x5 + · · · + a0
and say, “where the ai are general complex numbers”. Likewise, if the
challenge were to write down a general curve of genus 3, you could
write the equation of a plane quartic

i+j≤4
aijxiyj = 0
and again take the coefﬁcients aij to be general. For genus 4 and
5, there is a similar solution: in each case, the canonical model of a
general curve is a complete intersection, and you can just write down
a homogeneous quadric and a cubic in four variables (for genus 4) or
three homogeneous quadrics in ﬁve variables (for genus 5) and once
more let the coefﬁcients vary freely.
In genus 6 you might have to stop and think. Here the canonical
model C ⊂P5 of a general curve of genus 6 isn’t a complete inter-
section; it’s the intersection of six quadric hypersurfaces in P5, and
you can’t just take six general quadric polynomials and expect their

F. Kodaira dimension of Mg
329
intersection to be anything but empty. But Brill-Noether theory pro-
vides an answer: a general curve of genus 6 is representable as a plane
sextic curve with four double points, no three collinear. So everything
is OK: we can take those points to be the coordinate points in P2 to-
gether with the point [1, 1, 1], write down a basis for the subspace
V ⊂H0(P2, O(6)) of sextics vanishing to order 2 at those points, and
simply take a general linear combination of these basis elements.
Genus 7 presents a new challenge: a general such curve can most
simply be represented as a plane octic with eight double points, and
those points can’t be put in a ﬁxed position. But it’s really no problem:
if we simply let the points p1, . . . , p8 be general, we see that there is a
21-dimensional vector space of octic polynomials vanishing doubly on
p1, . . . , p8, and as these points vary the corresponding vector spaces
form a vector bundle over an open subset of (P2)8. Trivialize this vec-
tor bundle, and we once more have a family of curves, parametrized
by an open subset of an afﬁne space, that includes the general curve of
genus 7. Of course, the gunman may get a little anxious at this point:
the nodes of the octic plane model of a general curve of genus 7, he
may point out, need not be eight general points in the plane. But you
can handle this one: simply refer him to the paper of Arbarello and
Cornalba [4], where this is veriﬁed. Moreover, analogous constructions
work as well for genera g = 8, 9 and 10.
Unfortunately, it stops working with g = 11. Chang-Ran [22] and
Sernesi [137] prove the existence of such families for genera 11, 12
and 13, but far more subtle methods are needed for these cases, and
that’s the end of the line, at least as far as our present knowledge is
concerned. If your mugger wants more, you might as well tell him to
go ahead and shoot.
What’s going on here? Basically, to say that there exists a family
of curves, parametrized by an open subset of an afﬁne space, that
includes the general curve of genus g, is exactly to say that the moduli
space Mg is unirational, that is, there is a dominant rational map from
a projective space PN to Mg. In particular, it implies that the Kodaira
dimension of Mg is negative; that is, there are no pluricanonical forms
on Mg. Thus, one consequence of Theorem (6.59) is the fact that for
g ≥23, such a family cannot exist.
Other facts are known about the birational geometry of Mg for
small values of g. It’s known to be rational for g = 2, 4 and 6 (see
the articles of Dolgachev [35] and Shepherd-Barron [141]). In addi-
tion, Koll´ar and Schreyer [101] prove that Mg is actually rational for
all g ≤6. Also, it’s known that M15 has negative Kodaira dimension.
The proofs employ a variety of methods but there doesn’t seem to be
much chance of using similar ideas to ﬁll in the missing g. We con-
jecture, however,
that for g ≤22, Mg has Kodaira dimension −∞.

330
6. Geometry of moduli spaces: selected results
More precisely, the authors conjecture that the third condition in the
criterion at the start of the next subsection holds for such g. This
would have a number of other consequences of interest (for further
details, see [81]). But whatever our guesses about the intermediate
cases, Theorem (6.59) remains the extent of our knowledge about the
cases where Mg isn’t unirational, and the remainder of this section
will be devoted, more or less, to its proof.
Basic ideas
It turns out that the computations required for the proof of Theo-
rem (6.59) are signiﬁcantly simpler if we assume that g + 1 is a com-
posite integer. Since this case reveals all of the ideas needed in general,
we’ll deal only with it, using a strategy laid out by Eisenbud and Harris
in [41]. The variants needed to deal with general g can also be found
there.
We should establish one point of notation before we begin. The es-
sential ingredient in our argument is a calculation in the Picard group
of the moduli space Mg; and while the divisors we’ll be considering
will come to us as subschemes D ⊂Mg of the moduli space, we’ll ﬁnd
it much more convenient to carry out the necessary calculations in the
group Picfun(Mg)

Q of rational divisor classes on the moduli stack,
and to express the results in terms of the standard generators λ and δi
of Picfun(Mg)

Q. Since it would be burdensome to introduce a sepa-
rate symbol each time, we’ll abuse notation and use the same letter D
to denote an effective divisor D ⊂Mg and the class in Picfun(Mg)

Q
associated to it in Proposition (3.91). (Recall that by Proposition (3.92),
this coincides with the the class π∗([D]) ∈Picfun(Mg)

Q associated
to [D] ∈Pic(Mg) by the isomorphism in Proposition (3.88) except in
the cases of genus 2, of the divisor ∆1 in general, and of the divisor
H3 ⊂M3 of hyperelliptic curves of genus 3.)
With this said, the starting point of our analysis is a criterion that
relates the Kodaira dimension of Mg to the existence of certain effec-
tive divisors D ⊂Mg.
Criterion (6.60) For any effective divisor D ⊂Mg, express the class
of D in terms of standard classes as
D = aλ −
⌊g/2⌋

i=0
biδi .
1) Mg is of general type if there exists an effective divisor D with
a
bi
< 13
2
for all i, and
a
b1
< 13
3 .

F. Kodaira dimension of Mg
331
2) Mg has Kodaira dimension ≥1 if there are two effective divisors
with distinct support in Mg satisfying the weaker inequalities
a
bi
≤13
2
for all i, and,
a
b1
≤13
3 .
3) Mg has Kodaira dimension −∞if there is no effective divisor
satisfying the inequality
a
b0
≤13
2 .
The general type statement follows almost immediately from two
facts established earlier. The ﬁrst is the computation of the canonical
class of Mg in (3.113):
KMg = 13λ −2[∆0] −3
2[∆1] −2[∆2] −· · ·
= 13λ −2δ0 −3δ1 −2δ2 −· · · .
The second is the calculation of the cone of ample divisors in The-
orem (6.40), which shows that aλ −bδ is ample on Mg whenever
a > 11b > 0. Together these show that if there is an effective divi-
sor D as in the criterion, then for suitably divisible m we can ﬁnd an
effective divisor E and an ample divisor H such that
K⊗m
Mg = H + E .
In particular, this shows that the Hilbert function
h0(Mg, K⊗m
Mg )
has order in m at least that of the ample divisor H: this is just another
way to say that this order is maximal, or, equivalently, that Mg is of
general type.
Exercise (6.61) Prove the second and third assertions of the crite-
rion.
There is one other point that needs to be addressed before we may
conclude Criterion (6.60). As we remarked when it was ﬁrst intro-
duced, since Mg is singular, it doesn’t have a canonical bundle per
se; the canonical bundle on Mg is deﬁned simply as the unique (ratio-
nal) line bundle on Mg extending the canonical bundle on its smooth
locus. There is thus no guarantee that a global regular section of a
power of KMg will yield a pluricanonical form on a desingularization
of Mg. In order to ensure that this is in fact the case, we need to study
more closely the singularities of Mg. What must be checked is what
was stated classically as the property that “the singularities of Mg

332
6. Geometry of moduli spaces: selected results
don’t impose adjunction conditions”, or, in the language of contem-
porary birational geometry, that “Mg has only terminal singularities”.
Fortunately, the Reid-Tai criterion (cf., [134] and [145]) provides a very
effective method of checking whether any ﬁnite quotient singularity
— and recall that all singularitites of Mg are of this type — is terminal.
We will give no details here and simply refer to Mumford’s argument
in [82]. You should be aware, however, that this veriﬁcation involves
some lengthy and nontrivial combinatorial complications, since, for
each g, we ﬁnd a different menagerie of such singularities on Mg.
Indeed, the last step in the argument requires a computer veriﬁca-
tion whose Basic program listing must surely be the only one ever to
appear in Inventiones!
The idea of the proof of Theorem (6.59) is clear: show that for all
g ≥24 there are divisor classes on Mg that satisfy the ﬁrst part of
the criterion. Those that are easiest to work with are usually dubbed
Brill-Noether divisors. Informally, a Brill-Noether divisor is the locus
of curves that carry a gr
d for which the Brill-Noether number ρ = −1.
More carefully, these are the union of the codimension 1 components
of the closure of the locus of smooth curves possessing such a linear
series. The one defect these divisors have is that they exist only for
certain g. Since we’re assuming that
ρ = g −(r + 1)(g −d + r) = −1 ,
g + 1 must be composite. This is why our proof, which will use only
these divisors, applies only in this case. For other g, their role can be
taken by certain Petri divisors but the computations become much
more complicated. Again, see [41]. We will loosely refer to loci of
curves possessing exceptional linear series as loci of “special” curves.
We can rewrite the condition ρ = −1 in terms of r and the projective
dimension s = g −d + r −1 of the linear series residual to the given
one in the canonical series as
g = (r + 1)(s + 1) −1 .
Under this assumption, d, r and s are also related by
d = r(s + 2) −1 .
Of course, in view of these constraints, once g is ﬁxed any of the
quantities r, d and s determines the other two. However, it’ll simplify
statements of several propositions to index these divisors by both r
and s. We will thus deﬁne Dr
s ⊂Mg to be union of the codimension 1
components of the closure of the locus of smooth curves possessing
such a gr
d.
The aim of the remainder of this section is to compute the class of
Dr
s , up to a positive rational multiple, for all (r, s) with r, s ≥1 or,
more precisely, to prove:

F. Kodaira dimension of Mg
333
Theorem (6.62) (Brill-Noether Ray Theorem) Whenever s ≥3
and g = (r + 1)(s −1) −1, the class of Dr
s on Mg is given, for some
rational number c > 0, by
Dr
s = c

g + 3

λ −
g + 1
6

δ0 −
⌊g/2⌋

i=1

i(g −i)

δi

.
Note the remarkable fact that the coefﬁcients (apart from c) depend
only on g, not on r or s.
A little arithmetic with the coefﬁcients should quickly convince you
that the only ratio a/bi in this expression for Dr
s that is substantially
larger than 1 for large g is
a
b0
= g + 3
 g+1
6
 = 6 +
12
g + 1 .
This is less than 13/2 for g ≥24 so we’re done by applying crite-
rion (6.60) for such (composite) g.
When g = 23, a/b0 = 13/2. We can therefore only conclude that
the Kodaira dimension is positive and then only if we ﬁnd two Dr
s ’s
that have distinct support. Since the Hurwitz scheme is irreducible,
the locus of smooth curves of genus 23 possessing a g1
13 is of pure
codimension 1; i.e., D1
13 contains every such curve. Thus, we can show
that D1
13 isn’t contained in D2
9 by producing a smooth curve with a
g1
13 but no g2
17. This in turn follows from the existence of a curve
of compact type possessing a smoothable (i.e., dimensionally proper)
limit g1
13 but no limit g2
17. Exercise (5.67) constructs such a curve.
For genera g < 23, according to Theorem (6.62), a/b0 < 13/2 and
so the ﬁrst two parts of Theorem (6.62) give no information. In the
opposite direction. However, all known examples suggest that Brill-
Noether divisors minimize this ratio amongst all effective ones:
Conjecture (6.63) (Slope conjecture, [81]) If D is any effective
divisor on Mg, the ratio
a
b0
≥6 +
12
g + 1 .
Applying the third part this would imply that Mg has Kodaira dimen-
sion −∞(at least modulo analogous results for the other ratios). The
conjecture is known to be true only for g ≤6.
Theorem (6.62) is deduced by studying the pullbacks of Dr
s to
smaller spaces. These pullbacks lie in certain special subloci and gen-
eral results show that the coefﬁcients of divisors whose pullbacks lie
in these subloci satisfy various relations. Together these relations are
enough to yield Theorem (6.62).

334
6. Geometry of moduli spaces: selected results
i
Figure (6.64)
The ﬁrst space we use is the moduli space M0,g of stable g-pointed
rational curves. We let i : M0,g ✲Mg be the map obtained by attach-
ing a copy of a ﬁxed pointed elliptic curve at each of the g marked
points as in Figure (6.64). The second space we use is M2,1, the mod-
uli space of stable one-pointed curves of genus 2 equipped with the
map j : M2,1 ✲Mg obtained by attaching a ﬁxed general smooth one-
pointed curve of genus g −2 at the marked point.
It seems to be rather common that loci of special curves in Mg
meet j(M2,1) only along the closure W ⊂M2,1 of the locus in which
the marked point is a Weierstrass point of the underlying curve. This
is the case for both the Dr
s and the Petri divisors mentioned above.
Similarly, the curves in i(M0,g) seem to be rather general. This time Dr
s
— but not the more general Petri divisors — misses i(M0,g) entirely.
These yield relations on coefﬁcients by applying:
Theorem (6.65) Let D ⊂Mg be an effective divisor, with class
D = aλ −
⌊g/2⌋

i=0
biδi
.
1) If j∗D is supported on W, then
a = 5b1 −2b2
and
b0 = b1
2 −b2
6 .
Further, if we write j∗D = qW for some (rational) number q, then
b2 = 3q.

F. Kodaira dimension of Mg
335
2) If i∗D = 0, then
bi = i(g −i)
g −1 b1
for
i = 2, . . . , ⌊g
2 ⌋.
Exercise (6.66) Show that if a divisor D satisﬁes the relations in both
parts of this theorem, then it satisﬁes Theorem (6.62) for some c.
Hint: Use the second relation to write b2 in terms of b1. Then use the
ﬁrst to show that a/b0 = 6+

12/(g+1)

. Then show that if a = g+3,
then b0 = (g + 1)/6 and b1 = 1. The remaining coefﬁcients are then
immediate from the second set of relations.
Thus, three tasks remain. First, show that the divisors Dr
s meet
j(M2,1) only along the closure of the image of W and miss i(M0,g)
entirely. Second, show that the constant of proportionality c in The-
orem (6.62) is in fact positive. These will follow from considerations
about limit linear series that follow fairly directly from the results
of Chapter 5. We do this in the next subsection. Third, we must
prove Theorem (6.65). This will take most of the effort and be car-
ried out in the last two subsections.
Pulling back the divisors Dr
s
In this section, we’ll apply results about limit linear series to reduce
Theorem (6.62) to Theorem (6.65).
The key point is that the treelike curves in Dr
s are limits of smooth
curves possessing certain linear series with negative ρ, so they all pos-
sess generalized crude limit series with negative ρ by Exercise (5.40).
On the other hand, no curve in i(M0,g) possesses a series with neg-
ative ρ by the argument on page 275. Hence, no curve in Dr
s can lie
in i(M0,g). For the same reason, Dr
s cannot contain any treelike curve
in j(M2,1 −W). But the generic points of the boundary components
of M2,1 are seen in Figure (6.67) where all components have elliptic
and
Figure (6.67)
normalizations, and these are treelike curves. Thus the locus of non-
treelike curves is of codimension > 1 in j(M2,1), and the intersection
of j(M2,1−W) with a divisor, were it nonempty, could not consist only
of non-treelike curves. Thus, we’ve shown all but the last assertion of:

336
6. Geometry of moduli spaces: selected results
Proposition (6.68) If g = (r +1)(s+1) with r, s ≥1, then the divisor
Dr
s ⊂Mg doesn’t meet either i(M0,g) or j(M2,1\W). Moreover, j∗(Dr
s )
is a positive multiple of the class of W.
This provides the necessary reduction. The ﬁrst statement shows
that Theorem (6.62) must be true for some c by Exercise (6.66). By The-
orem (6.65), the last statement shows that the coefﬁcient cb2 of δ2 in
Theorem (6.62) is positive. Since Dr
s is effective, this, in turn, implies
that c > 0 as required.
To verify the last statement of the proposition, we’ll show that if
(Y, p) is a curve of genus 2 with Weierstrass point p and (Z, p) is
a general pointed curve of genus g −2 with g = (r + 1)(s + 1) −1,
then the curve C = Y ∪p Z possesses a smoothable limit gr
r(s+2)−1 that
extends to a codimension 1 family of nearby smooth curves. This will
show that C, which is a general point of j(W), lies in Dr
s as required.
We will construct the desired limit series aspect by aspect. Leaving
the easy case r = s = 1 to you, we may assume r ≥2 or s ≥2, so that
rs+r −3 ≥0. On Y we take the aspect VY to be |(r +2)p|+(rs+r −3)p.
One computes easily that
b(VY , p) = (rs −r −3, . . . , rs −r −3, rs −r −2, rs −r −1),
and hence that ρ(LY , p) = −1, and VY is dimensionally proper with
respect to p.
A gr
rs−1 on Z with ramiﬁcation sequence (0, 1, 2, . . . , 2) at p will have
adjusted Brill-Noether number 0. By Theorem (5.37), there are ﬁnitely
many (dimensionally proper) gr
rs−1’s on Z with this ramiﬁcation se-
quence at p. We may take any of these to be VZ.
We have ρ(L) = −1 by additivity. Since both the aspects constructed
above are dimensionally proper, the discussion of smoothings on
page 267 shows that this limit linear series smooths to a codimen-
sion 1 family. Thus Y ∪p Z = j(Y) ∈Dr
s , as required.
Remark. The constant c of Theorem (6.62) can be computed from the
number n such that j∗Dr
s = nW.
Question (6.69) Does
n
equal
the
number
of
points
in
Gr
r(s+2)−1(Z, (p, (0, 1, 2, . . . , 2))) ? If so, it can be computed through
the Schubert calculus. What is its value?
Divisors on Mg that miss j(M2,1 \ W)
Next, we want to verify the ﬁrst part of Theorem (6.65). We claim this
follows from the following computation of W in terms of the standard
divisor classes M2,1.

F. Kodaira dimension of Mg
337
Proposition (6.70) W is irreducible, and its class in M2,1 is given by
W = 3ω −λ −δ1.
Let’s admit this for a moment and complete the argument. To do
this, we need to know the pullbacks to M2,1 of the standard classes
on Mg. Clearly, a curve in ∆0(Mg)∩j(M2,1) must come from a curve
in ∆0(M2,1) so j∗(δ0) = δ0. Likewise, j∗(δ1) = δ1. Next, j∗(δi) = 0
if i ≥3 since then ∆i(Mg) is disjoint from j(M2,1). To determine
j∗(δ2), observe that, given any family of genus 2 curves π : C ✲B
with a marked point given by a section σ : B ✲C of π, j∗(δ2) B is
the pullback from Mg of the normal bundle Oδ2(δ2). This may in
turn be identiﬁed with the normal bundle to the section σ. There-
fore, by adjunction j∗(δ2) = −ω. Finally, if C is a curve of compact
type with components Ci, then H0(C, ωC) is naturally the direct sum
1
i H0(Ci, ωCi). In our situation, this means that j∗(λMg) = λM2,1.
Since λ, δ0 and δ1 on M2,1 are pullbacks of the analogous classes on
M2, where, by Exercise (3.143), they satisfy the relation
λ = 1
10δ0 + 1
5δ1 ,
this relation will continue to hold on M2,1.
Using the pullbacks, we see that if j∗D = qW then the coefﬁcients
of D satisfy the relation
aλ −b0δ0 −b1δ1 + b2ω = q(3ω −λ −δ1)
in A(M2,1). This immediately gives b2 = 3q as claimed. Moreover,
making this substitution for q and the one above for λ gives
a
10 −b0 = b2
30
and
a
5 −b1 = −2
5b2
from which the relations in the ﬁrst part of Theorem (6.65) follow by
solving for a and b0.
We are thus left with the proposition. Recall that W is deﬁned as
the closure of W ∩M2,1, the locus of Weierstrass points on smooth
genus 2 curves. By the usual construction of curves of genus 2 as
hyperelliptic covers, the monodromy of W ✲M2,1 is transitive, and
thus W is irreducible.
As for the class of W, it’s enough to prove the relation of (6.70) after
restricting to families
π : C ✲B,
σ : B ✲C
of stable genus 2 curves pointed by a section σ for which B is a com-
plete smooth curve. Further, we may harmlessly assume that B avoids

338
6. Geometry of moduli spaces: selected results
Figure (6.71)
any codimension 2 phenomena in M2,1 that would be inconvenient.
Thus, we may assume that all the ﬁnitely many singular ﬁbers Cb of
C/B are of the forms given in Figure (6.71). We let R be the ﬁnite set
of points of B where the ﬁber is of the reducible type on the right. For
such a ﬁber Cb, we let Zb be the component of Cb containing σ(b)and
Yb be the other component, and let p and q denote the points of Y
and Z respectively that are identiﬁed.
The key to our argument is that we can identify the Weierstrass
points on any ﬁber Cb in terms of ramiﬁcation of the corresponding
canonical or limit canonical series. A smooth point of a smooth curve
is a Weierstrass point if it’s a ramiﬁcation point of the canonical series.
On the other hand, Theorem (5.49) shows that, on a reducible curve
X0 = Y ∪Z/p ∼q consisting of two smooth components meeting at a
point that is not a Weierstrass point on Y, a smooth point s ∈Z\{q} is
the limit of Weierstrass points on nearby smooth curves if and only if
s is a ramiﬁcation point of the Z-aspect of the (unique) limit canonical
series on X.
Thus, the condition that σ(b) be a Weierstrass point on Cb can
be reexpressed as a degeneracy condition on the matrix giving the
Taylor expansion of the sections in the canonical series (or its limiting
aspects). Our next goal is to ﬁt these matrices together into map of
bundles over B. To do this, we ﬁrst let
ωlim = ωC/B

−

b∈R
Zb

.
Thus, ωlim Cb = ωCb if Cb is irreducible. If Cb is reducible, then
ωlim Zb = OZb(2q) (i.e., the restriction is the Z-aspect of the limit
canonical series), and ωlim Yb = OYb. Then, let
E = π∗ωlim .
Since h0
Cb, ωlim Cb

= 2 for all b, E is a rank 2 vector bundle on B.
Next, let Σ = σ(B) be the section, I its ideal sheaf, and
F = π∗

ωlim

OC/I2
.

F. Kodaira dimension of Mg
339
It’s easy to see that F is also a vector bundle of rank 2: in fact, we
have an exact sequence
0
✲σ ∗ωlim

ω
✲F
✲σ ∗ωlim
✲0,
where we’ve written ω for the line bundle σ ∗(I/I2) = σ ∗(ωC/B). We
have a natural map
ωlim
✲ωlim ⊗OC/I2 ,
which induces an “evaluation map”
ϕ : E
✲F .
The description of Weierstrass points as ramiﬁcation points of (limit)
canonical series tells us that the degeneracy locus of ϕ is W. Thus
W = c1(F) −c1(E), and it remains to compute c1(E) and c1(F).
For F this is immediate: we obviously have σ ∗ωlim = ω(−δ1), so
from the exact sequence above
c1(F) = 3ω −2δ1.
To evaluate c1(E) we use the sequence
0
✲ωlim
✲ωC/B
✲
b∈R
(ωC/B) Zb
✲0 ,
which pushes forward on B to an exact sequence
0
✲E
✲π∗ωC/B
✲Oδ1 B
since
(ωC/B) Zb = OZb(q)
and
H0
OZb(q)

≊C.
We claim that for each b lying in δ1 (i.e., with reducible ﬁber), the
map
π∗ωC/B
✲H0
(ωC/B) Zb

= C
is onto — that is, that a nonzero section of (ωC/B) Zb extends to a
neighborhood of Cb in C. This holds since π∗ωC/B is a vector bundle
with ﬁber
H0
(ωC/B) Yb

⊕H0
(ωC/B) Zb

over b. Thus we get an exact sequence
0
✲E
✲π∗ωC/B
✲Oδ1 B
✲0,
which shows that c1(E) = λ −δ1 whence the desired relation
W = c1(F) −c1(E) = 3ω −λ −δ1.

340
6. Geometry of moduli spaces: selected results
Divisors on Mg that miss i(M0,g)
We have now reached the ﬁnal step: verifying the second part of The-
orem (6.65). This amounts to ﬁnding relations on the classes i∗λ and
i∗δi. The ﬁrst is easy. On any family π : X ✲B of curves of genus g
formed by attaching ﬁxed elliptic tails to curves in M0,g at the marked
points, the vector bundle π∗ωC/B is trivial, so i∗λ = 0. Also, since
i(M0,g) misses δ0 we have i∗δ0 = 0. To obtain relations amongst the
higher δi’s we express these classes in terms of certain classes εi on
M0,g deﬁned as follows.
i
g −i
Figure (6.72)
For i = 2, . . . , ⌊g/2⌋, we take εi to be the class of the divisor that is
the closure in M0,g of the set of two-component curves with exactly
i of the g marked points on one of the components as illustrated
schematically in Figure (6.72).
Exercise (6.73) Consider the birational map M0,g ✲Pg−3 taking a
smooth curve to the moduli of the marked points. Show that the divi-
sors εi contract to distinct lower-dimensional subvarieties under this
map and deduce that they are all independent.
For i ≥2, we have i∗δi = εi. We compute i∗δ1. by showing that
(6.74)
i∗δ1 = −
⌊g/2⌋

i=2
i(g −i)
(g −1) εi .
If, then, D is any divisor, given in terms of standard classes as in The-
orem (6.65), it will pull back on M0,g to
−b1

−
⌊g/2⌋

i=2
i(g −i)
(g −1) εi

−
⌊g/2⌋

i=2
biεi .
If, in addition, D misses i(M0,g) this pullback must be 0 and equat-
ing coefﬁcients immediately gives the claimed relations on the coefﬁ-
cients bi.
As usual, it sufﬁces to check (6.74) after restricting to families
π : C ✲B,
σ1, . . . , σg : B ✲C

F. Kodaira dimension of Mg
341
of stable rational g-pointed curves, where B is a smooth curve miss-
ing any inconvenient codimension 1 loci in M0,g, and transverse to
relevant codimension 1 loci in M0,g. We can thus assume that all re-
ducible ﬁbers of C have exactly two components, the general ﬁber
is a smooth curve, and the total space C is a smooth surface. Fix g
pointed elliptic curves (Ei, pi), and let C′ ✲B be the family obtained
by attaching a copy of B × Ei along σi and B × pi. The family C′ ✲B
lies in the g-fold self-intersection of the normal crossing divisor δ1,
and, by Proposition (3.32), i∗δ1 is thus the sum of the pullbacks of
the normal bundles to the branches.
At the point of ∆1 corresponding to a ﬁber C′
b of C′, the branch cor-
responding to the ith node has normal bundle equal to Tσi(b),Cb ⊗Tpi,E.
Thus it pulls back on B to the normal bundle to the section σi(B),
which we may rewrite as π∗

σi(B)
2. Thus
i∗δ1 = π∗
 g

i=1
σi(B)2
.
We may contract the component of each reducible ﬁber meeting the
smaller number of sections (or either component if both components
meet g/2 sections) to obtain a P1-bundle π : C ✲B with g sections
σi : B ✲C. These sections meet transversely in groups of i over points
of εi, and are otherwise disjoint. Thus,
π∗
 g

i=1
σi(B)2
= π∗
 g

i=1
σi(B)2
+
⌊g/2⌋

i=2
iεi .
On any P1-bundle the difference of two sections is a linear combina-
tion of ﬁbers, and thus has self-intersection 0. Applying this remark
to σi(B) −σj(B) gives the relation σi(B)2 + σj(B)2 = 2 σi(B) · σj(B).
Summing over all pairs with i < j, we get
(g −1) π∗
 g

i=1
σi(B)2
= 2 π∗

i<j

σi(B) · σj(B)

=
⌊g/2⌋

i=2

i(i −1)εi

.
Putting the last three formulas together yields
i∗δ1 =
⌊g/2⌋

i=2
i(i −1)
g −1

εi −
⌊g/2⌋

i=2

i

εi = −
⌊g/2⌋

i=2
i(g −i)
g −1

εi .
We have thus veriﬁed (6.74) and completed the proof of Theo-
rem (6.59).

342
6. Geometry of moduli spaces: selected results
Further divisor class calculations
Here are some further calculations of classes of divisors on Mg you
may wish to try. They call for the use of a variety of the techniques
that have appeared in this book.
Exercise (6.75) In terms of the generators λ, ω and σi of the Picard
group of Cg as described on page 62 of Section 2.D, ﬁnd the class of
the closure W ⊂Cg of the locus of pairs (C, p) where C is a smooth
curve of genus 3 and p is a Weierstrass point of C.
See Cukierman [28] for the answer to this and related questions.
Exercise (6.76) 1) Consider the closure in Mg of the locus of
smooth curves C of genus g possessing a point p with Weierstrass
semigroup {g −1, g + 2, g + 3, . . .}. Show that this locus is indeed a
divisor, and ﬁnd its class.
2) Repeat part 1) for the semigroup {g, g + 1, g + 3, g + 4, . . .}.
3) For extra credit, show that the loci described above are the only
codimension 1 components of the locus of curves with nonsimple
Weierstrass points.
See Diaz [30] for a full treatment of this question.
Exercise (6.77) Let W ⊂Cg be as in Exercise (6.75). What is the
branch divisor of the projection W ✲Mg, and what does this have to
do with the answer to Exercise (6.76)?
Exercise (6.78) Find the class of the closure in Mg of the locus of
curves C with a semicanonical pencil, that is, a line bundle L with
L⊗2 ≊ωC and h0(C, L) ≥2.
Curves deﬁned over Q
Among the consequences of Theorem (6.59) are (at least conjecturally)
some that are arithmetic in nature, and we’ll summarize them here.
To begin with, for any number ﬁeld K we’ll say that a curve C may be
deﬁned over K if it can be realized as the zero locus of polynomials
with coefﬁcients in K. The moduli space Mg itself may be given by
equations with coefﬁcients in Q in such a way that for any K the set
of curves that may be deﬁned over K is (if we exclude curves with
automorphisms) just the set Mg(K) of K-rational points of Mg.
Now, the fact that we can for small values of g write down a family
of curves, parametrized by an open subset of an afﬁne space, that
includes the general curve of genus g, implies in particular that the

F. Kodaira dimension of Mg
343
subset Mg(Q) ⊂Mg of curves that may be deﬁned over Q is dense
in Mg. Is this the case in general? Conjecturally not: generalizing the
Mordell Conjecture, we have the:
Conjecture (6.79) (Weak Lang Conjecture) If X is a variety of
general type deﬁned over a number ﬁeld K, then the set X(K) of K-
rational points of X isn’t Zariski dense.
This, if true, would in conjunction with Theorem (6.59) imply that
for g ≥24, all the K-rational points of Mg lie in a proper subvariety!
But wait, there’s a further conjecture:
Conjecture (6.80) (Strong Lang Conjecture) Let X be a variety
of general type, deﬁned over a number ﬁeld K. There exists a proper
closed subvariety Σ ⊂X such that for any number ﬁeld L containing
K, the set of L-rational points of X lying outside Σ is ﬁnite.
If we believe this, there is for each g ≥24 a subvariety Σ ⊂Mg such
that, for any number ﬁeld K, all but ﬁnitely many curves of genus g
deﬁned over K lie in Σ. This raises a host of intriguing questions.
First, can we disprove the Lang Conjectures by exhibiting a Zariski-
dense collection of curves of genus g deﬁned over Q? Second, if we
do believe the Strong Lang Conjecture, what could the minimal such
subvariety Σ be? Clearly, it has to contain the hyperelliptic locus, since
the rational points are dense there; and a little more effort shows
that it’ll also contain the trigonal and tetragonal locus, as well as loci
of plane curves with small numbers of nodes, complete intersection
curves and the like.
At this point, no one has any idea what Σ might look like, if indeed it
exists. There are two guesses we might make, though. The ﬁrst is that
Σ is contained in the locus of special curves, that is, curves possessing
a linear series with negative Brill-Noether number ρ. In fact, no one
has (to our knowledge) written down for large g a single curve, deﬁned
over Q, that satisﬁed the Brill-Noether theorem. The second is that it’s
the intersection of the base loci of all the pluricanonical linear series
of Mg: conjecturally (cf. [81]), this second locus is closely related to
the ﬁrst and it’s known to contain some very special subloci such as
the loci of hyperelliptic and trigonal curves. We leave you with the:
Problem (6.81) Find better evidence that Σ equals either of the can-
didates above, or ﬁnd a better candidate for Σ.

Bibliography
[1] Abramovich, D. & Karu, K. Weak semistable reduction in char-
acteristic 0. math.AG/9707012, 1997.
[2] Alufﬁ, P. & Faber, C. Linear orbits of smooth plane curves. J.
Alg. Geom., 2, 155–184, 1993.
[3] Arbarello, E. Weierstrass points and moduli of curves. Compo-
sitio Math., 29, 325–342, 1974.
[4] Arbarello, E. & Cornalba, M. Footnotes to a paper of Beni-
amino Segre. Math. Annalen, 256, 341–362, 1981.
[5] Arbarello, E. & Cornalba, M. The Picard groups of the moduli
spaces of curves. Topology, 26, 153–171, 1987.
[6] Arbarello, E. & Cornalba, M.
Calculating cohomology
groups of moduli spaces of curves via algebraic geometry.
math.AG/9803001, 1998.
[7] Arbarello, E., Cornalba, M., Grifﬁths, P. & Harris, J. Ge-
ometry of algebraic curves, I. Number 267 in Grundlehren der
mathematischen Wissenschaften (New York: Springer-Verlag),
1985.
[8] Arbarello, E. & DeConcini, C. On a set of equations character-
izing Riemann matrices. Ann. of Math. (2), 120, 119–140, 1984.
[9] Arbarello, E., DeConcini, C., Kac, V. & Procesi, C.
Moduli
spaces of curves and representation theory. Comm. Math. Phys.,
117, 1–36, 1988.
[10] Artin, M. Algebraic spaces. Number 3 in Yale Mathematical
Monographs (New Haven: Yale University Press), 1971.
[11] Ash, A., Mumford, D., Rapoport, M. & Tai, Y. Smooth com-
pactiﬁcation of locally symmetric varieties (Brookline: Math-Sci.
Press), 1975.
[12] Baily, W. & Borel, A. Compactiﬁcation of arithmetic quotients
of bounded symmetric domains. Ann. of Math. (2), 84, 442–528,
1966.

346
Bibliography
[13] Bayer, D. The division algorithm and the Hilbert scheme. Ph.D.
thesis, Harvard University, 1992.
[14] Behrend, K., Fantechi, L., Fulton, W., Goettsche, L. &
Kresch, A. Introduction to stacks. In preparation.
[15] Bers, L.
Spaces of Riemann surfaces.
In J. A. Todd, editor,
Proc. Int. Congress of Math., Cambridge, 1958 (Cambridge: Cam-
bridge Univ. Press), 1960.
[16] Caporaso, L. A compactiﬁcation of the universal Picard variety
over the moduli space of stable curves. J. Amer. Math. Soc., 7,
589–660, 1994.
[17] Caporaso, L. & Harris, J. Counting plane curves of any genus.
Invent. Math., 131, 345–392, 1998.
[18] Caporaso, L. & Harris, J. Enumerating curves on rational sur-
faces: the rational ﬁbration method. math.AG/9608023, to appear
in Compositio Math., 1998.
[19] Caporaso, L. & Harris, J. Parameter spaces for curves on sur-
faces and enumeration of rational curves. math.AG/9608024, to
appear in Compositio Math., 1998.
[20] Castelnuovo, G. Numero delle involuzioni razionali gaicenti
sopra una curva di dato genere. Rendi. R. Accad. Lincei (4), 5,
130–133, 1889.
[21] Castelnuovo, G. Ricerche di geometria sulle curve algebriche.
Atti R. Accad. Sci. Torino, 24, 196–223, 1889.
[22] Chang, M.-C. & Ran, Z. Unirationality of the moduli space of
curves of genus 11, 13 (and 12). Invent. Math., 76, 41–54, 1984.
[23] Chang, M.-C. & Ran, Z. Closed families of smooth space curves.
Duke Math. J., 52, 707–713, 1985.
[24] Chang, M.-C. & Ran, Z. Dimensions of families of space curves.
Compositio Math., 90, 53–57, 1994.
[25] Ciliberto, C. On rationally determined line bundles on a family
of projective curves with general moduli. Duke Math. J., 55, 909–
917, 1987.
[26] Clebsch, A.
Zur Theorie der Riemann’schen Flachen.
Math.
Ann., 6, 216–230, 1872.
[27] Cornalba, M. & Harris, J. Divisor classes associated to fami-
lies of stable varieties, with applications to the moduli space of
curves. Ann. Sci. ´Ecole Norm. Sup. (4), 21, 455–475, 1988.
[28] Cukierman, F. Families of Weierstrass points. Duke Math. J., 58,
317–346, 1989.

Bibliography
347
[29] Deligne, P. & Mumford, D. The irreducibility of the space of
curves of given genus. Publ. Math. I.H.E.S., 36, 75–110, 1969.
[30] Diaz, S. Exceptional Weierstrass points and the divisor on moduli
that they deﬁne. Mem. Amer. Math. Soc., 56, 1985.
[31] Diaz, S. & Edidin, D. Towards the homology of Hurwitz spaces.
J. Diff. Geom., 43, 66–98, 1996.
[32] Diaz, S. & Harris, J. Geometry of Severi varieties, II: Indepen-
dence of divisor classes and examples. In Algebraic Geometry,
1986 (Sundance, Utah), Number 1311 in Lecture Notes in Math.,
23–50 (New York: Springer-Verlag), 1988.
[33] Diaz, S. & Harris, J.
Geometry of the Severi variety.
Trans.
Amer. Math. Soc., 309, 1–34, 1988.
[34] Dijkgraaf, R., Verlinde, E. & Verlinde, H. Loop equations and
Virasoro constraints in nonperturbative two-dimensional quan-
tum gravity. Nuclear Phys. B, 348, 435–456, 1991.
[35] Dolgachev, I. Rationality of ﬁelds of invariants. In Algebraic
Geometry Bowdoin 1985, Vol. 2, Number 46 in Proc. Symp. Pure
Math, 3–16 (Providence: Amer. Math. Soc.), 1987.
[36] Edidin, D. Picard groups of Severi varieties. Comm. Algebra, 22,
2073–2081, 1994.
[37] Eisenbud, D. & Harris, J. Divisors on general curves and cuspi-
dal rational curves. Invent. Math, 74, 371–418, 1983.
[38] Eisenbud, D. & Harris, J. A simpler proof of the Gieseker-Petri
theorem on special divisors. Invent. Math, 74, 269–280, 1983.
[39] Eisenbud, D. & Harris, J. Limit linear series: basic theory. In-
vent. Math, 85, 337–371, 1986.
[40] Eisenbud, D. & Harris, J. Existence, decomposition and limits of
certain Weierstrass points. Invent. Math, 87, 495–515, 1987.
[41] Eisenbud, D. & Harris, J. The Kodaira dimension of the moduli
space of curves of genus ≥23. Invent. Math, 90, 359–387, 1987.
[42] Eisenbud, D. & Harris, J. When ramiﬁcation points meet. Invent.
Math, 87, 485–493, 1987.
[43] Enriques, F. & Chisini, O. Teoria geometrica delle equazione e
delle funzione algebriche, volume III (Bologna: Zanichelle), 1924.
[44] Esteves, E. Compactifying the relative Jacobian over families of
reduced curves. math.AG/9709009, 1997.
[45] Faber, C. Chow rings of moduli spaces of curves, I: The Chow
ring of M3. Ann. of Math., 132, 331–419, 1990.
[46] Faber, C. Chow rings of moduli spaces of curves, II: Some results
on the Chow ring of M4. Ann. of Math., 132, 421–449, 1990.

348
Bibliography
[47] Faber, C.
Algorithms for computing intersection numbers on
moduli spaces of curves, with an application to the class of the
locus of Jacobians. math.AG/9706006, 1996.
[48] Faber, C. A conjectural description of the tautological ring of
the moduli space of curves. Preprint, 1997.
[49] Fogarty, J. Invariant theory (New York: W. Benjamin), 1969.
[50] Fogarty, J., Kirwan, F. & Mumford, D.
Geometric invari-
ant theory.
Number 34 in Ergebnisse der Mathematik und
ihrer Grenzgeibeite, 3. Folge, third edition (New York: Springer-
Verlag), 1994.
[51] Franchetta, A. Sulle serie lineari razionalmente determinate
sulla curve a moduli generali di dato genera. Le Mathematiche,
Catania, 9, 126–147, 1954.
[52] Friedman, R. Hodge theory, degenerations and the global Torelli
problem. Ph.D. thesis, Harvard University, 1981.
[53] Fulton, W.
Intersection theory.
Number 2 in Ergebnisse
der Mathematik und ihrer Grenzgeibeite, 3. Folge (New York:
Springer-Verlag), 1980.
[54] Fulton, W. & Pandharipande, R. Notes on stable maps and
quantum cohomology. In J. Koll´ar, R. Lazarsfeld & D. Morrison,
editors, Algebraic Geometry Santa Cruz 1995, Number 62.2 in
Proc. of Symposia in Pure Math., 45–92 (Amer. Math. Soc.), 1997.
math.AG/9608011.
[55] Getzler, E.
Intersection theory on M1,4 and elliptic Gromov-
Witten invariants. J. Amer. Math. Soc., 10, 973–998, 1997.
[56] Getzler, E.
Topological recursion relations in genus 2.
math.AG/9801003, 1998.
[57] Gieseker, D. Global moduli for surfaces of general type. Invent.
Math, 43, 233–282, 1977.
[58] Gieseker, D. Lectures on moduli of curves. Number 69 in Tata
Institute of Fundamental Research Lecture Notes (New York:
Springer-Verlag), 1982.
[59] Gieseker, D. Stable curves and special divisors. Invent. Math,
66, 251–275, 1982.
[60] Gieseker, D.
Geometric invariant theory and applications to
moduli problems.
In F. Gherardelli, editor, Invariant theory,
Proceedings of the 1st 1982 Session of the C.I.M.E (Montecatini,
Italy), Number 996 in Lecture Notes in Math., 45–73 (New York:
Springer-Verlag), 1983.
[61] Gieseker, D. A degeneration of the moduli space of stable bun-
dles. J. Diff. Geom., 19, 137–154, 1984.

Bibliography
349
[62] Gieseker, D. & Morrison, I. Hilbert stability of rank two bundles
on curves. J. Diff. Geom, 19, 1–29, 1984.
[63] Gotzmann, G. Eine Bedingung f¨ur die Flachheit und das Hilbert-
polynom eines graduiertes Ringes. Math. Zeit., 158, 61–70, 1978.
[64] Grifﬁths, P. & Harris, J. Principles of algebraic geometry (New
York: Wiley-Interscience), 1978.
[65] Grifﬁths, P. & Harris, J. The dimension of the space of special
linear series on a general curve. Duke Math. J., 47, 233–272,
1980.
[66] Gromov, M.
Pseudo-holomorphic curves in symplectic mani-
folds. Invent. Math., 82, 307–383, 1985.
[67] Grothendieck, A.
Techniques de construction et th´eor`emes
d’existence en g´eometrie alg´ebrique, IV: Les sch´emas de Hilbert.
In Seminaire Bourbaki, 1960–61, Expos´es 205–222, Expos´e 221,
221.1–221.28 (New York: Benjamin), 1966.
[68] Grothendieck, A.
Seminaire de g´eometrie alg´ebrique, 1:
Revˆetements ´etales et groupe fondamental. Number 224 in Lec-
ture Notes in Math. (Heidelberg: Springer-Verlag), 1973.
[69] Haboush, W.
Reductive groups are geometrically reductive.
Ann. of Math. (2), 102, 67–83, 1975.
[70] Hain, R. & Looijenga, E.
Mapping class groups and moduli
spaces of curves. In J. Koll´ar, R. Lazarsfeld & D. Morrison, edi-
tors, Algebraic Geometry Santa Cruz 1995, Number 62.2 in Proc.
of Symposia in Pure Math., 97–142 (Amer. Math. Soc.), 1997.
[71] Halphen, G. Memoire sur la classiﬁcation des courbes gauches
alg´ebriques. J. ´Ecole Polytechnique, 52, 1–200, 1882.
[72] Harer, J.
The second homology group of the mapping class
group of an orientable surface. Invent. Math., 72, 221–239, 1983.
[73] Harer, J. Stability of the homology of mapping class groups of
orientable surfaces. Ann. of Math. (2), 121, 215–251, 1985.
[74] Harer, J.
The cohomology of the moduli space of curves. In
E. Sernesi, editor, Theory of moduli : lectures given at the 3rd
1985 session of the Centro Internazionale Matematico Estivo
(C.I.M.E.) held at Montecatini Terme, Italy, June 21-29, 1985,
Number 1337 in Lecture Notes in Math., 138–221 (New York:
Springer-Verlag), 1988.
[75] Harer, J.
The third homology group of the moduli space of
curves. Duke Math. J., 63, 25–55, 1991.
[76] Harer, J. & Zagier, D. The Euler characteristic of the moduli
space of curves. Invent. Math., 85, 457–485, 1986.

350
Bibliography
[77] Harris, J. Galois groups of enumerative problems. Duke Math.
J., 46, 685–724, 1979.
[78] Harris, J. The genus of space curves. Math. Ann., 249, 191–204,
1980.
[79] Harris, J.
On the Kodaira dimension of the moduli space of
curves, II: The even genus case. Invent. Math., 75, 437–466, 1984.
[80] Harris, J. On the Severi problem. Invent. Math., 84, 445–461,
1986.
[81] Harris, J. & Morrison, I. Slopes of effective divisors on the mod-
uli space of curves. Invent. Math., 99, 1990, 321–355.
[82] Harris, J. & Mumford, D. On the Kodaira dimension of the mod-
uli space of curves, with an appendix by William Fulton. Invent.
Math., 67, 1982, 23–88.
[83] Hartshorne, R.
Connectedness of the Hilbert scheme.
Publ.
Math. I.H.E.S., 29, 5–48, 1966.
[84] Hartshorne, R. Residues and duality. Number 20 in Lecture
Notes in Math. (New York: Springer-Verlag), 1966.
[85] Hassett, B. Local stable reduction for plane curve singularities.
In preparation, 1998.
[86] Hilbert, D. Lie groups: history, frontiers and applications. Num-
ber VIII in Hilbert’s invariant theory papers (Brookline: Math Sci.
Press), 1978.
[87] Horikawa, E. On deformations of holomorphic maps, I. J. Math.
Soc. Japan, 25, 372–396, 1973.
[88] Horikawa, E. On deformations of holomorphic maps, II. J. Math.
Soc. Japan, 26, 647–667, 1974.
[89] Kac, V. & Schwarz, A. Geometric interpretation of the partition
function of 2D gravity. Phys. Letters B, 257, 329–334, 1991.
[90] Karu, K. Minimal models and boundedness of stable varieties.
math.AG/9804049, 1998.
[91] Keel, S.
Intersection theory of the moduli space of stable N-
pointed curves of genus 0. Trans. Amer. Math. Soc., 330, 545–
574, 1992.
[92] Kempf, G. Schubert methods with an application to algebraic
geometry (Amsterdam: Publ. Math. Centrum), 1971.
[93] Kempf, G. Instability in invariant theory. Ann. of Math. (2), 108,
299–316, 1978.
[94] Kleiman, S. r-special subschemes and an argument of Severi.
Adv. of Math., 22, 1–23, 1976.

Bibliography
351
[95] Kleiman, S. & Laksov, D. On the existence of special divisors.
Amer. J. Math., 94, 431–436, 1972.
[96] Kleiman, S. & Laksov, D. Another proof of the existence of spe-
cial divisors. Acta Math., 132, 163–176, 1974.
[97] Knudsen, F. The projectivity of the moduli space of stable curves,
I. Math. Scand., 39, 19–66, 1976. II, Math. Scand., 52 161–199,
1983. III, Math. Scand., 52 200–212, 1983.
[98] Kodaira, K. Complex manifolds and deformations of complex
structures (New York: Springer-Verlag), 1986.
[99] Koll´ar, J. Projectivity of complete moduli. J. Diff. Geom., 32,
235–268, 1990.
[100] Koll´ar, J. Rational curves on algebraic varieties. Number 32
in Ergebnisse der Mathematik und ihrer Grenzgeibeite, 3. Folge
(New York: Springer-Verlag), 1996.
[101] Koll´ar, J. & Schreyer, F. O.
The moduli of curves is stably
rational for g ≤6. Duke Math. J., 51, 239–242, 1984.
[102] Kontsevich, M.
Intersection theory on the moduli space of
curves and the matrix Airy function. Comm. Math. Phys., 147,
1–23, 1992.
[103] Kontsevich, M. & Manin, Y. Gromov-Witten classes, quantum
cohomology, and enumerative geometry. Comm. Math. Phys.,
164, 525–562, 1994.
[104] Kontsevich, M. & Manin, Y. Quantum cohomology of a product.
Invent. Math., 124, 313–339, 1996.
[105] Kouvidakis, A. The Picard group of the universal Picard vari-
eties over the moduli space of curves. J. Diff. Geom., 34, 839–850,
1991.
[106] Laumon,
G.
&
Moret-Bailly,
L.
Champs
alg´ebriques.
Pr´epublication de l’Universit´e de Paris-Sud 92-42, 1992.
[107] Lazarsfeld, R. Brill-Noether-Petri without degenerations. J. Diff.
Geom., 23, 299–307, 1986.
[108] Looijenga, E.
Smooth Deligne-Mumford compactiﬁcations by
means of Prym level structures. J. Alg. Geom., 3, 283–293, 1992.
[109] Looijenga, E. Intersection theory on Deligne-Mumford compact-
iﬁcations after Witten and Kontsevich. In Seminaire Bourbaki,
1992-93, volume 216 of Ast´erisque, Expos´e 768, 187–212 (Paris:
Soc´et´e Math´ematique de France), 1993.
[110] Looijenga, E. On the tautological ring of Mg. Invent. Math.,
121, 411–419, 1995.

352
Bibliography
[111] Macaulay, F. R. Some properties of enumeration in the theory
of modular systems. Proc. Lond. Math. Soc., 26, 531–555, 1927.
[112] Mestrano, N. Conjecture de Franchetta forte. Invent. Math., 87,
365–376, 1987.
[113] Mestrano, N. & Ramanan, S. Poincare bundles for families of
curves. J. Reine Angew. Math., 362, 169–178, 1985.
[114] Miller, E. The homology of the mapping class group. J. Diff.
Geom., 24, 1–14, 1986.
[115] Moishezon, B. Stable branch curves and branch monodromies.
In Algebraic Geometry (Proc. Univ. Ill. Chicago Circle, 1980),
Number 862 in Lecture Notes in Math., 107–192 (New York:
Springer-Verlag), 1981.
[116] Morrison, I. Projective stability of ruled surfaces. Invent. Math.,
50, 269–304, 1980.
[117] Mulase, M. Cohomological structure in soliton equations and
Jacobian varieties. J. Diff. Geom., 19, 403–430, 1984.
[118] Mumford, D. Further pathologies in algebraic geometry. Amer.
J. Math., 84, 642–648, 1962.
[119] Mumford, D. Picard groups of moduli problems. In Arithmetic
algebraic geometry, Proc. Conf. Purdue Univ. 1963, 33–81 (New
York: Harper and Row), 1965.
[120] Mumford, D. Lectures on curves on an algebraic surface. Num-
ber 59 in Princeton Mathematical Series (Princeton: Princeton
University Press), 1966.
[121] Mumford, D. Stability of projective varieties. L’Ens. Math., 23,
39–110, 1977.
[122] Mumford, D. Towards an enumerative geometry of the moduli
space of curves. In Arithmetic and geometry, II, Number 36 in
Progress in Math., 271–326 (Boston: Birkh¨auser), 1983.
[123] Nagata, M. On the fourteenth problem of Hilbert. Amer. Math.
J., 81, 766–772, 1959.
[124] Nagata, M. Lectures on the fourteenth problem of Hilbert. Num-
ber 31 in Tata Institute of Fundamental Research Lecture Notes
(New York: Springer-Verlag), 1965.
[125] Novikov, S.
The periodic problem for the Korteweg-deVries
equation. Funct. Anal. Appl., 8, 236–246, 1974.
[126] Palamodov, V. Deformations of complex spaces. Russian Math.
Surveys, 31, 129–197, 1976.

Bibliography
353
[127] Pandharipande, R. A compactiﬁcation over Mg of the universal
moduli space of slope-semistable vector bundles. J. Amer. Math.
Soc., 9, 425–471, 1996.
[128] Pandharipande, R. A note on elliptic plane curves with ﬁxed
j-invariant. Proc. Amer. Math. Soc., 125, 3471–3479, 1997.
[129] Pandharipande, R.
Intersections of Q-divisors on Kontse-
vich’s moduli space M0,n(PR, d) and enumerative geometry.
math.AG/9504004, to appear in Trans. Amer. Math. Soc., 1998.
[130] Piene, R. & Schlessinger, M. On the Hilbert scheme compacti-
ﬁcation of the space of twisted cubics. Amer. J. Math., 107, 761–
774, 1985.
[131] Popp, H. Classiﬁcation of algebraic varieties and compact com-
plex manifolds.
Number 412 in Lecture Notes in Math. (New
York: Springer-Verlag), 1974.
[132] Popp, H. Moduli Theory and Classiﬁcation Theory of Algebraic
Varieties.
Number 620 in Lecture Notes in Math. (New York:
Springer-Verlag), 1977.
[133] Ran, Z. Enumerative geometry of singular plane curves. Invent.
Math, 97, 447–465, 1989.
[134] Reid, M. Young person’s guide to canonical singularities. In Alge-
braic Geometry, Bowdoin 1985, Number 46 in Proc. of Symposia
in Pure Math., 345–414 (Providence: Amer. Math. Soc.), 1987.
[135] Ruan, Y. & Tian, G. A mathematical theory of quantum coho-
mology. J. Diff. Geom, 45, 259–367, 1995.
[136] Satake, I. On the compactiﬁcation of the Siegel space. J. Indian
Math. Soc., 20, 259–281, 1956.
[137] Sernesi, E. L’unirazionalit`a della variet`a dei moduli delle curve
di genere dodici. Ann. Sc. Norm. Sup. Pisa, Cl. Sci. IV, 8, 405–439,
1981.
[138] Serre, J.-P. Faisceaux alg´ebriques coh´erents. Ann. of Math. (2),
61, 197–278, 1955.
[139] Seshadri, C. S. Geometric reductivity over an arbitrary base.
Adv. in Math., 26, 225–274, 1977.
[140] Severi, F. Vorlesungen ¨uber Algebraische Geometrie, Anhang F
(Leipzig: Teubner), 1921.
[141] Shepherd-Barron, N. Rationality of moduli spaces via invari-
ant theory.
In Topological methods in algebraic transforma-
tion groups, Number 80 in Progress in Math., 153–164 (Boston:
Birkh¨auser), 1989.

354
Bibliography
[142] Shiota, T. Characterization of Jacobian varieties in terms of
soliton equations. Invent. Math., 83, 333–382, 1986.
[143] Stankova-Frenkel,
Z.
Moduli
of
trigonal
curves.
math.AG/9710015, 1997.
[144] Stanley, R. Hilbert functions of graded algebras. Adv. Math.,
28, 57–83, 1978.
[145] Tai, Y. S.
On the kodaira dimension of the moduli space of
abelian varieties. Invent. Math., 68, 425–439, 1982.
[146] Vainsencher, I.
Schubert calculus for complete quadrics.
In
Enumerative geometry and classical algebraic geometry (Nice,
1981), Number 24 in Progress in Math., 199–235 (Boston:
Birkh¨auser), 1982.
[147] Vakil, R. Enumerative geometry of rational and elliptic curves
in projective space. math.AG/9709007, 1997.
[148] Viehweg, E.
Quasi-projective moduli for polarized manifolds.
Number 30 in Ergebnisse der Mathematik und ihrer Gren-
zgeibeite, 3. Folge (Berlin: Springer-Verlag), 1995.
[149] Vistoli, A. Intersection theory on algebraic stacks and on their
moduli spaces. Invent. Math., 97, 613–670, 1989.
[150] Vistoli, A.
Deformation of local complete intersections.
math.AG/9703008, 1997.
[151] Weyl, H. Classical groups, their invariants and representations
(Princeton: Princeton University Press), 1946.
[152] Witten, E. Two-dimensional gravity and intersection theory on
moduli space. Surveys in Diff. Geom., 1, 243–310, 1991.
[153] Wolpert, S. On obtaining a positive line bundle from the Weil-
Petersson class. Amer. J. Math., 107, 1485–1507, 1985.
[154] Wolpert, S. On the Weil-Petersson geometry of the moduli space
of curves. Amer. J. Math., 107, 969–997, 1985.

Index
The Symbols section below gives the deﬁning occurrence of each notation.
All other references to these notations are indexed in the alphabetical section
“as read”: e.g., for references to Mg, look under Mgbar.
Symbols
!, 154
Ag, 44

Ag, 45
ai(V, p), 256
αF, 210
β(i, V)p, 257
bi(V, p), 256
c(·), 152
Cg, 41
Cd
g, 69
ch(·), 152
ct(·), 161
∆, 50
∆0, 50
∆a,b, 161
∆i, 50
dj, 211
D≡n, 125
dY , 226
eF, 210
ej, 211
εc, 215
η, 60
F(Y), 226
Γg, 43
Gr
d, 267
HP,r , 6
hY , 226
H d,g, 175
Hd,g,r , 16
hd,g,r , 26
Hg, 162
hg, 44
Hg, 168
HilbP,r , 6
I(l)
k , 12
K, 46
K0, 151
K0, 151
KY , 226
kY , 226
KY,Z, 226
kY,Z, 226
κ1, 60
κi, 60

K, 46

Kss, 221
Λ, 61
λi, 61
LY , 226
M0, 37
Ma,b, 161
Mg, 37
M0
g, 37
Mg, 48
Mg,n, 41
Mg,n(X, γ), 76
MorM, 2
µλ(x), 200
Or (m), 6
P, 6
Pd,g, 41
Pd,g, 49
R, 17
rg, 55
rg, 57
ρ, 27
R∗(Mg), 67
Sλ(W), 200
Sλ(x), 200
sY , 226
td(·), 153
Tg, 43
T 1, 99
T1, 99
Υ, 106
VY , 255
V β
d,g, 113
wB, 208

356
Index
A
Abramovich, Dan, 150
adjunction conditions, 332
adjusted Brill-Noether number,
264
additivity, 264
estimates for, 264
admissible covers, 34, 180
applications, 286
existence theorem for, 181
properties, 177–184
pseudo-, 186
simplest cases, 178
topological description, 179
two branch points meet
admissible description, 181
naive description, 176
Ag, 44

Ag, 45
ai(V, p), 256
Ak singularity, 118
algebraic space, 39
algebraic stack, see stack, algebraic
αF, 210
Alufﬁ, Paolo, 138
Arbarello, Enrico, 62, 288, 329
Artin, Michael, 39, 89
aspects
limit linear series, 255
relations amongst, 255
asymptotic numerical criterion,
210
B
B-monomial basis, 208
Baily-Borel compactiﬁcation, 45
base change, 124
prime order, of
effect on special ﬁbers, 125
Bayer, Dave, 8
β(V, p), 257
bitangent, 134, 167
bi(V, p), 256
boundary
codimension, 45, 50
in Mg, 50, see also ∆, ∆i etc.
Brill, A., 242
Brill-Noether
divisor on Mg, 332
pullbacks to M0,g and M2,1,
335
standard classes, in terms of,
332
ﬁrst proof, 261
ﬂag curves, via, 246
generalized, 265
converse of, 268
Gieseker’s approach, 243
Grifﬁths-Harris’s argument, 243
Lazarsfeld’s approach, 247
ray theorem, 332
second proof, 265
Severi’s argument, 242–243
third proof, 275
Brill-Noether number, 27, 161, 240
adjusted, 264
estimates for, 264
Burnol, Jean-Francois, 52
C
c(·), 152
canonical class of the moduli
stack, 159
Caporaso, Lucia, 49, 225
Castelnuovo curves, 25
Castelnuovo, Guido, 242
Cg, 41
cohomology of, 62
Picard group of, 62
Cd
g, 69
ch(·), 152
Chang, Mei-Chu, 57, 329
Chern character, 152
alternate characterization, 153
expansion formula, 152
properties, 153
Chern polynomial, 161
Chow variety, 10
Ciliberto, Ciro, 66
Clebsch, A., 34
coarse moduli space, 3
uniqueness of, 4
compact type, 250
complete deformation, 87
conjectures
Enriques-Franchetta, 62
Faber’s on R∗(Mg), 68–70

Index
357
Kodaira dimension of moduli,
329
Lang, 343
rigid curves, 29
Severi, see Severi variety,
irreducibility
slope conjecture, 333
standard, 59, 60
Witten’s
KdV form, 74
Lie form, 75
convex variety, 77
Cornalba, Maurizio, 62, 304, 312,
329
ct(·), 161
Cukierman, Fernando, 342
curves
Castelnuovo, 25
compact type, 250
deﬁned over Q, 342–343
degree 2, 4
elliptic normal, 14
genus 1, 4, 14, 36, 38
genus 2, 39, 53, 175, 328
genus 3, 39, 53, 57, 133–138,
162–164, 168–175,
186–190, 245, 328
genus 4, 164, 190, 276, 328
genus 5, 189, 276, 328
genus 6, 276, 328
genus 7, 329
genus 23, 279
Mumford’s example, 19–23
plane cubics, 202–204
plane quartics, 57, 133–138,
164, 170, 206
bitangents to, 134
ﬂexes, 135
plane sextics, 135
potentially stable, 224
rational normal, 14
rigid, 29
space
complete families, 57
degree 5, 10
degree 6, 10
symmetric product
tangent space to, 94
treelike, 265
twisted cubics, 10, 14, 58
universal, 41
cusp, 98, 121–130, 204, 206, 232,
318
D
deformation, 87
complete, 87
curve with line bundle, of a, 93
curve, of a, 92
equigeneric, 94
equisingular, 93
equivalence of, 87
ﬁrst-order, 87
curve with effective divisor,
of a, 94
curve with line bundle, of a,
96
cusp, 98
line bundle over a ﬁxed
curve, of a, 95
local complete intersection,
of a, 99
map with ﬁxed source and
target, of a, 96
map with ﬁxed target, of a,
96
nodal curve, 100
node, 98
ordinary triple point, 98
planar curve singularity, 97
pointed curve, of a, 94
Schiffer variation, 91
singular variety, of a, 99
smooth curve, 89
tacnode, 98
map with ﬁxed source and
target, of a, 93
map with ﬁxed target, of a, 93
map with tangency conditions,
of a, 111–117
map, of a, 105–111
minimal, 88
nth-order, 87
pointed curve, of a, 92
Schiffer variation, 91
three step paradigm, 88
universal, 88
versal, 87

358
Index
degree inequality
general family, for a, 305
singular family, for a, 311
Deligne, Pierre, 48
Deligne-Mumford stable, 47
∆, 50, 54
inﬁnitesimal description in Mg,
101
normal bundle to in Mg, 101
rational divisor class associated
to, 145–147
∆0, 50
irreducibility of, 54
∆a,b, 161
∆i, 50
irreducibility of, 54
Diaz, Steve, 57, 66, 292, 342
dilaton equation, 72
dimension inequality, 26
dimensionally proper, 264
divisor
reduced mod n, 125
dj, 211
D≡n, 125
Dolgachev, Igor, 329
double line, 15, 24, 77
dual graph, 249
dualizing sheaf, 82
ampleness of, 83
relative, 84
dY , 226
E
eF, 210
Eisenbud, David, 245, 330
ej, 211
elliptic tail, 54, 128
Enriques, F., 62
εc, 215
equigeneric deformation, 94
equisingular deformation, 93
η, 60
extrinsic pathologies
double space lines, 24
Mumford’s example, 19
F
Faber, Carel, 68–70, 138
fan, 17
ﬁbered category, 40
ﬁne moduli space, 2, 35
obstructions to existence of, 36
ﬁrst-order Schiffer variation, 91
ﬁrst-order deformation, 13
Fitting ideal, 102
ﬂag curves, 247
limit linear series on, 274–285
canonical, 276
inequalities for, 274
ρ = 0, with, 276
schematic diagram, 247
ﬂat completion, 138
ﬂat family, 6
ﬂat limit
examples, 138
ﬂexes, 134
formulas
genus, 81
Grothendieck-Riemann-Roch,
154
Hirzebruch-Riemann-Roch, 154
Porteous’, 161, see also
Porteous’ formula
fourfold point, 136
Franchetta, A., 62
Fulton, Bill, 76, 262, 268, 288
functor of points, 2
F(Y), 226
G
Γg, 43
general curves
historical overview of theorems
about, 241–247
generalized Severi variety, see
Severi variety,
generalized
genus formula, 81
geometric invariant theory, see
G.I.T.
geometrically reductive, 196
Gieseker’s criterion, 215
application, 216–219
Gieseker, David, 191, 211, 215,
220, 223, 240, 243, 285
Gieseker-Petri theorem, 240, see
also Brill-Noether
proof, 280–285

Index
359
G.I.T., 46
alternatives to, 238
linearization, 195
plane cubics, of, 204
plane curves, of, 202–206
problem, 193
quotient map, 194
base locus, 197
ﬁbers, 198
simplifying assumptions, 193,
197
strategy, 193
gonality, 185
Gorenstein singularity, 82
Gotzmann, G., 9
Gr
d, 5, 267
Grifﬁths, Phil, 243
Gromov, M., 79
Gromov-Witten invariant, 79
Grothendieck duality, 85
Grothendieck group
coherent sheaves, of, 151
vector bundles, of, 151
Grothendieck, Alexandre, 6, 40,
154
Grothendieck-Riemann-Roch
applications, 154–160
formula, 154
setup for, 151
H
Haboush, Bill, 195
Halphen, G. H., 24
Harer, John, 44, 58, 60
Harris, Joe, 30, 66, 243, 245, 304,
312, 328, 330
Hartshorne’s Connectedness
Theorem, 17
Hartshorne, Robin, 17, 23
H d,g, 175
desired properties, 175
existence theorem for, 181
Hd,g,r , 5, 16, 102, see also Hilbert
scheme
hd,g,r , 26–29
Hg, 162
H3 in terms of standard classes,
162–164
rational Picard group, 302
hg, 44
Hg, 168
H3 in terms of standard classes,
168–172
inequalities for λ and δ on, 294,
301
Picard group, 303
Hilbert function, 17
Hilbert functor
representability, 6
Hilbert number, 26
Hilbert point
smooth curve, of a
stability, 216
Hilbert polynomial, 6
characterization of, 18
Hilbert scheme, 5, 6
cohomology of, 64
nonstandard classes, 64, 65
standard classes, 64
complete subvarieties of, 57
connectedness of, 17
construction of, 5–9
curves, 26
dimension, 26
open questions, 28
dimension at nonspecial curve,
27
dimension inequality, 26
divisor classes on, 166
equations of, 8
examples
elliptic normal curves, 14
lines in P3, 9
plane curves, 9
rational normal curves, 14
twisted cubics, 14, 15, 58
exceptional component, 27
general component, 27
Murphy’s Law of, 18
relative, 11
restricted, 17
tangent space, 12–14
variants
bundles, of, 11
maps, of, 11
relative, 11
subschemes, of, 11
Hilbert stable, 210

360
Index
Hilbert, David, 195, 196, 201
Hilbert-Mumford numerical
criterion, see numerical
criterion
HilbP,r , 6
representability, 6
Hirzebruch-Riemann-Roch
formula, 154
Hodge bundle, 61, 155
Chern classes, 155–158
over Mg, 156
over Mg, 158
HP,r , 6
Hurwitz scheme, 32, 52, 175, see
also admissible covers
cohomology of
standard classes, 65
rational Picard group, 302
Hurwitz, A., 34
hY , 226
hyperelliptic curve, 53, 134
characterizations of, 162
universal family of, 39
hyperelliptic locus, 293–303
class in H∗(Mg), 68
class in Pic(M3)

Q, 188
class in Pic(M3)

Q, 164
closure of in Mg, 185
general curve in, 295
degree of Hodge bundle, 300
degrees of boundary classes,
297
relative dualizing sheaf, 299
in Mg
rational Picard group, 302
in Mg
rational Picard group, 302
inequalities for λ and δ on, 294,
301
Picard group, 303
rational Picard group
relations to Pic(Mg), 303
smoothness of Mg along, 53
universal family over, 39
hyperelliptic stable curve, 169
hyperﬂex, 189
hyperstall, 167
I
I, 12
Ik, 12
I(l)
k , 12
inﬂection point, see ramiﬁcation
point
invariants
ﬁnite generation of, 195
separation by, 196
J
Jacobian bundle, 41
Jacobian ideal, 97
Jacobian of a nodal curve, 249
Jk, 165
Jm
k , 166
K
K, 46
k-gonal, 185
K0, 151
K0, 151
κ1, 60
κi, 60
Karu, Kalle, 150, 238
Kempf, George, 241, 262
Kleiman, Steve, 241, 243, 262
Klein, Felix, 34
KMg
in terms of standard classes,
160
Knudsen, Finn, 177, 223
Kodaira’s construction, 56
Kodaira, Kunihiko, 56, 87, 106
Kodaira-Serre duality, 83
Kodaira-Spencer map, 106
at a point, 107
global, 107
Koll´ar, J´anos, 10, 87, 142, 238, 329
Kontsevich, Maxim, 44, 71, 76
Korteweg-deVries, 74
Kouvidakis, Alexis, 310

K, 46

Kss, 221
properties
claims, 221
veriﬁcations, 234–237
Kuranishi, 87
Kuranishi family, 87

Index
361
KY , 226
kY , 226
KY,Z, 226
kY,Z, 226
L
L¨uroth, J., 34
Laksov, Dan, 241, 262
Λ, 61
λ-state
representation, of a, 200
vector, of a, 200
λ-weight
representation, of a, 200
space, 200
vector, of a, 200
λi, 61
Lang, Serge, 343
Lazarsfeld, Rob, 247, 262
Lefshetz, Solomon, 97
level n structure, 38
level structures, 37
lexicographical ideal, 8
liaison formula, 21
limit linear series, 263, 253–272
aspects, 255
relations amongst, 255
canonical, 269–272
dimensionally proper, 264
ﬂag curves, on, 274–285
canonical, 276
inequalities for, 274
ρ = 0, with, 276
reﬁned, 263
simplest example, 253
smoothing, 266
smoothing of, 268
line bundle
limits of, 251–252
Poincar´e, 63
stable curve, on a, 247–251
Looijenga, E., 68
LY , 226
M
M0, 37
M1, 202
Ma,b, 161
Macaulay, F. S., 17
marked point, 37
Mestrano, Nicole, 62, 63
Mg, 37, 46
cohomology of, 58
dimension, 52
functions on, 45
irreducibility, 52, 286
local structure, 52
singular locus, 53
stratiﬁcations
Arbarello’s, 289
Diaz’, 291, 292
topology of, 43
universal curve over, 41
M0
g, 37
Mg, 48
ample cone, 312
canonical class, 160
construction, 220–223
consequences, 223–224
plan, 220
cotangent bundle
Chern character, 159
divisor classes
relation to classes on
Picfun(Mg), 144
relations on, 145
irreducibility of, 223
Kodaira dimension
basic criterion, 330
g ≥23, 328
g ≤22, 329
local description of, 223
local structure, 53
projectivity of, 223
rational points on, 342
relations on divisors disjoint
from subloci, 336–341
singular locus, 54
slope conjecture, 333
tangent bundle
Chern class of, 159
Mg,n, 41
Mg,n(X, γ), 76
properties of, for convex X, 77
Miller, Ed, 60
modular, 45
moduli functor, 2
moduli problem, 1

362
Index
rigidiﬁed, 37
moduli space, see Mg, Mg etc.
elementary examples
j-line, 4, 36
lines in C2, 4
plane conics, 4
versus parameter space, 5
moduli stable, 47
moduli stack, see stack, moduli
Moishezon, Boris, 34
monodromy
of branched covers, 33, 52, 176,
292
of cubic surfaces, 19
of nodes of plane curves, 314
of subcanonical line bundles, 63
monomial basis, 208
Mordell, L., 343
Morrison, Ian, 211, 330
µλ(x), 200
Mumford’s example, 19
Mumford, David, 6, 18, 40, 48, 60,
68, 191, 198, 201, 328,
332
M0,3d(P2, d), 78
enumerative applications,
78–79
N
Nagata, M., 195, 196
nodal curve
genus formula, 81
nodal reduction, 119
node
general, 310
special, 310
Noether, Max, 97, 242
nonsemistable, 197
normal sheaf, 96
numerical criterion
asymptotic, 210
general statement, 201
Hilbert points, for, 208
plane curves, for, 203
O
openness of nodality, 102
openness of versality, 105, 144
Or (m), 6
P
P, 6
Palamodov, V., 87
Pandharipande, Rahul, 76
parameter space
versus moduli space, 5
pathologies, 19
Pd,g, 41, 49
Pd,g, 49
period matrix, 44
Petri divisors, 332
Petri, K., 240, 285
Picard variety of a nodal curve, 249
Piene, Ragne, 15
pigtail, 122, 175
planar singularity, 98
Poincar´e line bundle, 63
pointed stable curve, 47
Popp, H., 142
Porteous’ formula, 161
applications, 162–168
Porteous, I. R., 161
potential stability theorem, 225
ﬁrst basic estimate, 228
second basic estimate, 228
potentially stable, 224
potentially stable curve, 224
pseudo-admissible covers, 186
Q
quantum cohomology ring, 79
quotient map, 194
base locus, 197
ﬁbers, 198
R
R, 17
Ramanan, S., 63
ramiﬁcation index, 257
Pl¨ucker formula for, 257
ramiﬁcation point, 167
ramiﬁcation sequence, 256
basic inequality for, 260
Ran, Ziv, 57, 329
rational action, 195
rational divisor class
associated to ∆, 145–147
associated to a hypersurface in
Mg, 144

Index
363
on Mg, 140
on a moduli stack, 140–148
rational normal scroll, 25
rational numerical polynomial, 18
regeneration theorem, 268
relative cotangent bundle of Cg
over Mg
Todd class, 158
relative cotangent bundle of y
over B
Chern character, 158
relative dualizing sheaf, 59, 60, 62,
64, 68, 84, 102, 155
ampleness, 309
hyperelliptic curves, 298
representable functor, 2
restricted Hilbert scheme, 17
Reynolds operator, 195
rg, 55
rg, 57
ρ, 27
ρ, 240
ribbon, 24
Riemann-Roch formula, 150
rigid curves, 29
rigidifying, 37
approaches
level structures, 37
marked points, 37
Weierstrass points, 38
R∗(Mg), 67
Looijenga’s theorem for, 68
S
Satake compactiﬁcation, 45
Satake, I., 45
Schiffer variation, 91
ﬁrst-order, 91
versality of, 92
Schlessinger, Michael, 15
Schreyer, Frank-Olaf, 329
semistable, 47, 48, 197
characterization by invariants,
198
semistable reduction, 51, 118
Sernesi, Edoardo, 329
Serre, Jean-Pierre, 8
Seshadri, C., 223
Severi conjecture, see Severi
variety, irreducibility
Severi variety, 11, 30, 52, 108
cohomology of
standard classes, 65
density of nodal curves, 30, 110
dimension, 30, 110
dimension estimate, 108
generalized, 113
dimension estimates, 114,
117
local description, 114
irreducibility, 30
open problems, 31
Severi, F., 30, 242, 314
sheaves
normal, 96
Shepherd-Barron, Nick, 329
shriek operator, 154
Siegel upper halfspace, 44
singularity
Gorenstein, 82
planar, 98
terminal, 332
Sλ(W), 200
Sλ(x), 200
slope conjecture, 333
Spencer, D., 106
stability theorem, 58
stable, 197
characterization by invariants,
198
Hilbert, 210
stable cohomology ring, 59
stable curve, 47
compact type, 250
Deligne-Mumford, 47
divisors
Abel-Jacobi theorem for, 251
linear equivalence of, 251
families
ampleness of relative ω, 309
basic inequality for standard
classes, 309
line bundles on, 251–252
genus formula, 81
line bundles on, 247–251
moduli, 47
pointed, 47

364
Index
stable hyperelliptic curve, 185
stable limit, 51
stable map, 76
genus g with n marked points,
of, 76
moduli space of, 76
stable reduction, 118
examples, 120–138
glueing transverse sections,
120
smoothing of cusp, 122
smoothing of double conic,
133
smoothing of double cubic,
135
smoothing of quadruple
point, 136
smoothing of triple conic,
135
smoothing of triple point,
131
over general bases, 150
practical considerations, 124
stably equivalent, 185
stack
moduli, 139
canonical class of, 159
rational divisor class on,
140–148
stack, algebraic, 40
stall, 167
standard
cohomology classes, 59
relations amongst, 165
cohomology subring, 60
conjectures, 59, 60
state, 200
stratiﬁcations
Arbarello’s, 289
Diaz’, 291, 292
strictly semistable points, 198
string equation, 72
subcanonical point, 164
sY , 226
symmetric product
tangent space to, 94
symplectic basis, 37
T
tacnode, 82, 98, 232, 326–327
tangent spaces
Hilbert scheme, 14
tangent vectors
addition of, 12
tautological classes, 59
tautological families, 142, 148
td(·), 153
Teichm¨uller space, 43
terminal singularity, 332
test curves, 170
contained in ∆, 172–175,
186–188
Tg, 43
theorems
additivity of adjusted
Brill-Noether number,
264
ample cone of Mg, 312
ampleness of relative ω, 309
aspects
nonvanishing sections, 260
relations between ai(V, p)’s,
261
special bases, 260
asymptotic numerical criterion,
210
basic properties of 
Kss, 221
basic ramiﬁcation/vanishing
sequence, 260
Bers, 43
Brill-Noether, 240
converse of, 268
ﬁrst proof, 261
ﬂag curves, via, 246
generalized, 265
Gieseker’s approach, 243
Grifﬁths-Harris’s argument,
243
Lazarsfeld’s approach, 247
second proof, 265
Severi’s argument, 242–243
third proof, 275
Brill-Noether ray, 332
Chang-Ran, 57
characterization of k-gonality,
185

Index
365
comparing divisor class
relations in families and
on Mg, 145
connectedness of 
Hd,g, 34
Cornalba-Harris inequality, 304
degree inequality
general stable families, 305
hyperelliptic families, 301
Diaz’, 57, 288–293
dimension estimate for V β
d,g,
117
dimension of the Severi variety,
110
divisors on Mg disjoint from
certain loci, 334
equations deﬁning the HilbP,r , 8
existence of complete
subvarieties of Mg, 56
existence of H d,g, 181
existence of Mg, 48, 222
Gieseker’s criterion, 215
Gieseker-Petri, 240, see also
Brill-Noether
proof, 280–285
Grothendieck’s, 6
Grothendieck-Riemann-Roch,
154
Harer’s, 58
Harer’s stability, 58
Harris’, see Severi variety,
irreducibility
Harris-Mumford, 328, see also
Mg, Kodaira dimension
Hartshorne’s, 17
Hilbert-Mumford numerical
criterion, 201
Hilbert-Nagata, 196
Hilbert-Weyl-Haboush, 195
Hurwitz’, 33
inﬁnitesimal description of
∆⊂Mg, 101
irreducibility of Mg, 223
isomorphism of Picfun(Mg)

Q
and Pic(Mg)

Q, 141
Kontsevich’
KdV form, 74
Lie form, 75
Kouvidakis’, 42
limits of canonical series, 277
local description of V β
d,g, 114
Looijenga’s theorem on
R∗(Mg), 68
Macaulay’s, 18
multiplicity in Picfun(Mg) of
classes in Pic(Mg), 144
nodal reduction, 119
Noether-Lefschetz, 97
numerical criterion for Hilbert
points, 209
open Diaz strata, 292
openness of nodality, 102
Pl¨ucker formula, 257
potential stability theorem, 225
projectivity of Mg, 223
reducedness of automorphisms
of a stable curve, 86
regeneration, 268
relation of [∆i] to δi, 147
Reynolds lemma, 196
semistable reduction, 118
smoothness of 
K, 103
stability of smooth curves of
large degree, 216
stable reduction, 118
over general bases, 150
subloci disjoint from
Brill-Noether divisors,
335
tautological families over Mg,
142
Uniform m lemma, 7
Weierstrass points
existence of, 273
limits of, 271
theta characteristics, 134, 190, 342
TMg
Chern class of, 159
Todd class, 153
expansion formula, 153
multiplicativity, 154
T 1, 99
stalk at a node, 101
T1, 99
torsion-free sheaves, 243
total Chern class, 152
treelike curves, 265
trigonal, 185, 189
triple point, 82, 98, 131–132, 232

366
Index
U
Uniform m lemma, 7
uniform position principle, 314
universal
curve, 41
relative Todd class over Mg,
158
family, 2, 38
Υ, 106
V
vanishing sequence, 256
basic inequalities for, 260
Vd,g
irreducibility, 30
via contracting
degenerations, 319
via Diaz’ theorem, 316
via general degenerations,
314
proof, 313–328
V β
d,g, 113
versality, 87
Viehweg, Eckhard, 6, 238
Virasoro algebra, 75
Vistoli, Angelo, 87, 89
VY , 255
W
wB, 208
Weierstrass points, 38, 135, 164,
187, 189
class of, 342
existence of, 273
gap sequence, 272
limits of, 271
proper, 272
semigroup, 272
Weierstrass stratiﬁcation, 272
weight, 200
weighted basis, 207
compatible with weighted
ﬁltration, 208
weighted ﬁltration, 208
induced by a surjection, 208
normalized, 216
Weyl, Hermann, 195
wF(m), 208
Whitney product formula, 152
Witten, Ed, 71, 76, 79
W r (C)
tangent space to, 95
Z
Zagier, Don, 70
Zariski, Oscar, 30, 94




