
DISCRETE MATHEMATICS AND ITS APPLICATIONS
Series Editor KENNETH H. ROSEN

DISCRETE 
MATHEMATICS
ITS APPLICATIONS
Series Editor
Kenneth H. Rosen, Ph.D.
Juergen Bierbrauer, Introduction to Coding Theory
Francine Blanchet-Sadri, Algorithmic Combinatorics on Partial Words
Richard A. Brualdi and Drago˘s Cvetkovi´c, A Combinatorial Approach to Matrix Theory and Its Applications
Kun-Mao Chao and Bang Ye Wu, Spanning Trees and Optimization Problems
Charalambos A. Charalambides, Enumerative Combinatorics
Gary Chartrand and Ping Zhang, Chromatic Graph Theory
Henri Cohen, Gerhard Frey, et al., Handbook of Elliptic and Hyperelliptic Curve Cryptography
Charles J. Colbourn and Jeffrey H. Dinitz, Handbook of Combinatorial Designs, Second Edition
Martin Erickson, Pearls of Discrete Mathematics
Martin Erickson and Anthony Vazzana, Introduction to Number Theory
Steven Furino, Ying Miao, and Jianxing Yin, Frames and Resolvable Designs: Uses, Constructions, 
    and Existence 
Randy Goldberg and Lance Riek, A Practical Handbook of Speech Coders
Jacob E. Goodman and Joseph O’Rourke, Handbook of Discrete and Computational Geometry,
 Second Edition
Jonathan L. Gross, Combinatorial Methods with Computer Applications
Jonathan L. Gross and Jay Yellen, Graph Theory and Its Applications, Second Edition
Jonathan L. Gross and Jay Yellen, Handbook of Graph Theory
Darrel R. Hankerson, Greg A. Harris, and Peter D. Johnson, Introduction to Information Theory and 
 Data Compression, Second Edition
Darel W. Hardy, Fred Richman, and Carol L. Walker, Applied Algebra: Codes, Ciphers, and 
 Discrete Algorithms, Second Edition
Daryl D. Harms, Miroslav Kraetzl, Charles J. Colbourn, and John S. Devitt, Network Reliability:
 Experiments with a Symbolic Algebra Environment
Silvia Heubach and Toufik Mansour, Combinatorics of Compositions and Words
Leslie Hogben, Handbook of Linear Algebra
Derek F. Holt with Bettina Eick and Eamonn A. O’Brien, Handbook of Computational Group Theory

Titles (continued)
David M. Jackson and Terry I. Visentin, An Atlas of Smaller Maps in Orientable and Nonorientable
 Surfaces
Richard E. Klima, Neil P. Sigmon, and Ernest L. Stitzinger, Applications of Abstract Algebra 
  with Maple™ and MATLAB®, Second Edition
Patrick Knupp and Kambiz Salari, Verification of Computer Codes in Computational Science 
  and Engineering 
William Kocay and Donald L. Kreher, Graphs, Algorithms, and Optimization 
Donald L. Kreher and Douglas R. Stinson, Combinatorial Algorithms: Generation Enumeration and Search 
C. C. Lindner and C. A. Rodger, Design Theory, Second Edition
Hang T. Lau, A Java Library of Graph Algorithms and Optimization
Elliott Mendelson, Introduction to Mathematical Logic, Fifth Edition 
Alfred J. Menezes, Paul C. van Oorschot, and Scott A. Vanstone, Handbook of Applied Cryptography 
Richard A. Mollin, Advanced Number Theory with Applications
Richard A. Mollin, Algebraic Number Theory 
Richard A. Mollin, Codes: The Guide to Secrecy from Ancient to Modern Times
Richard A. Mollin, Fundamental Number Theory with Applications, Second Edition
Richard A. Mollin, An Introduction to Cryptography, Second Edition
Richard A. Mollin, Quadratics 
Richard A. Mollin, RSA and Public-Key Cryptography
Carlos J. Moreno and Samuel S. Wagstaff, Jr., Sums of Squares of Integers
Dingyi Pei, Authentication Codes and Combinatorial Designs
Kenneth H. Rosen, Handbook of Discrete and Combinatorial Mathematics
Douglas R. Shier and K.T. Wallenius, Applied Mathematical Modeling: A Multidisciplinary Approach
Jörn Steuding, Diophantine Analysis  
Douglas R. Stinson, Cryptography: Theory and Practice, Third Edition
Roberto Togneri and Christopher J. deSilva, Fundamentals of Information Theory and Coding Design
W. D. Wallis, Introduction to Combinatorial Designs, Second Edition
Lawrence C. Washington, Elliptic Curves: Number Theory and Cryptography, Second Edition

CRC Press
Taylor & Francis Group
6000 Broken Sound Parkway NW, Suite 300
Boca Raton, FL 33487-2742
© 2010 by Taylor and Francis Group, LLC
CRC Press is an imprint of Taylor & Francis Group, an Informa business
No claim to original U.S. Government works
Printed in the United States of America on acid-free paper
10 9 8 7 6 5 4 3 2 1
International Standard Book Number: 978-1-4398-1616-5 (Paperback)
This book contains information obtained from authentic and highly regarded sources. Reasonable efforts 
have been made to publish reliable data and information, but the author and publisher cannot assume 
responsibility for the validity of all materials or the consequences of their use. The authors and publishers 
have attempted to trace the copyright holders of all material reproduced in this publication and apologize to 
copyright holders if permission to publish in this form has not been obtained. If any copyright material has 
not been acknowledged please write and let us know so we may rectify in any future reprint.
Except as permitted under U.S. Copyright Law, no part of this book may be reprinted, reproduced, transmit-
ted, or utilized in any form by any electronic, mechanical, or other means, now known or hereafter invented, 
including photocopying, microfilming, and recording, or in any information storage or retrieval system, 
without written permission from the publishers.
For permission to photocopy or use material electronically from this work, please access www.copyright.
com (http://www.copyright.com/) or contact the Copyright Clearance Center, Inc. (CCC), 222 Rosewood 
Drive, Danvers, MA 01923, 978-750-8400. CCC is a not-for-profit organization that provides licenses and 
registration for a variety of users. For organizations that have been granted a photocopy license by the CCC, 
a separate system of payment has been arranged.
Trademark Notice: Product or corporate names may be trademarks or registered trademarks, and are used 
only for identification and explanation without intent to infringe.
Library of Congress Cataloging‑in‑Publication Data
Erickson, Martin J., 1963-
Pearls of discrete mathematics / Martin Erickson.
p. cm. --  (Discrete mathematics and its applications)
Includes bibliographical references and index.
ISBN 978-1-4398-1616-5 (pbk. : alk. paper)
1.  Combinatorial analysis. 2.  Graph theory. 3.  Number theory.  I. Title. II. Series.
QA164.E745 2009
511’.1--dc22 
2009027565
Visit the Taylor & Francis Web site at
http://www.taylorandfrancis.com
and the CRC Press Web site at
http://www.crcpress.com 

To my mother, Lorene Erickson
v


Contents
I
Counting: Basic
1
1
Subsets of a Set
3
2
Pascal’s Triangle
5
3
Binomial Coeﬃcient Identities
11
II
Counting: Intermediate
19
4
Finding a Polynomial
21
5
The Upward-Extended Pascal’s Triangle
25
6
Recurrence Relations and Fibonacci Numbers
27
III
Counting: Advanced
37
7
Generating Functions and Making Change
39
8
Integer Triangles
49
9
Rook Paths and Queen Paths
53
IV
Discrete Probability
65
10 Probability Spaces and Distributions
67
11 Markov Chains
81
12 Random Tournaments
91
V
Number Theory
95
13 Divisibility of Factorials and Binomial Coeﬃcients
97
14 Covering Systems
103

15 Partitions of an Integer
109
VI
Information Theory
121
16 What Is Surprise?
123
17 A Coin-Tossing Game
133
18 Shannon’s Theorems
139
VII
Games
153
19 A Little Graph Theory Background
155
20 The Ramsey Game
165
21 Tic-Tac-Toe and Animal Games
173
VIII
Algorithms
181
22 Counters
183
23 Listing Permutations and Combinations
187
24 Sudoku Solving and Polycube Packing
193
A Hints and Solutions to Exercises
201
B Notation
259
Bibliography
261
Index
263

Preface
This book presents subjects suitable for a topics course or self-study in
discrete mathematics. The focus is on representative, intriguing, and beau-
tiful examples, problems, theorems, and proofs. Of course, the choice of
coverage is personal and subjective, but I hope that the concepts I treat
will be of interest to you and that you will ﬁnd some as fascinating as I do.
Discrete structures (which are based on ﬁnite sets) comprise an area of
mathematics that most people relate to naturally. How many ways can you
choose an appetizer, a main course, and a dessert at dinner? How many
walking routes can you take through town?
How many lottery number
combinations can you buy? These are typical counting problems in discrete
mathematics. In our day-to-day mathematical lives, we often encounter
counting problems or other types of problems involving discrete structures.
We should learn the methods used to solve these problems.
Discrete structures play a central role in mathematics. They are in-
timately related to algebra, geometry, number theory, and combinatorics,
and these relationships are illustrated with several of the pearls in this book.
One needs only to look at the many journal titles in discrete mathematics
(at least thirty in number) to see that this area is huge. The journal titles
indicate connections between discrete mathematics and computing, infor-
mation theory and codes, and probability. I think it’s safe to say that all
mathematicians and computer scientists would beneﬁt from investigating
the basic principles of discrete mathematics.
The world of discrete mathematics is like a mosaic or tapestry, with one
pattern ﬁtting into another and theories gradually emerging. I have taken
an organic approach in this book, exploring concrete problems, introducing
theory, and adding generalizations as we go.
ix

x
Having taught mathematics for twenty-ﬁve years, I understand the im-
portance of examples and exercises. Accordingly, I have kept examples and
exercises at the forefront of the discussion. I’ve tried to arrange it so that
each chapter features a particularly surprising, stunning, elegant, or un-
usual result. Included are mathematical items that don’t appear in many
books, such as the upward extension of Pascal’s triangle, a recurrence rela-
tion for powers of Fibonacci numbers, the number of ways to make change
for a million dollars, integer triangles, the period of Alcuin’s sequence, Rook
and Queen paths and the equivalent Nim and Wythoﬀ’s Nim games, the
probability of a perfect bridge hand, random tournaments, a Fibonacci-like
sequence of composite numbers, Shannon’s theorems of information theory,
higher-dimensional tic-tac-toe, animal achievement and avoidance games,
and an algorithm for solving Sudoku puzzles and polycube packing prob-
lems. I introduce each chapter with a mathematical “teaser” or two to whet
your appetite—mathematics can be engaging, inspiring, and even fun!
You will proﬁt from doing the exercises, as a good deal of the mathe-
matics is revealed there. The problems range in diﬃculty from easy to quite
challenging. Exercises designated with a star (⋆) are particularly diﬃcult
or require advanced mathematical background; exercises designated with a
diamond (⋄) require the use of a calculator or computer; exercises desig-
nated with a dagger (†) are of theoretical importance. Hints or solutions
to the exercises are provided in an appendix in the back of the book.
Thanks to the people who have kindly provided suggestions concerning
this work: Robert Cacioppo, Robert Dobrow, Rodman Doll, Christine Er-
ickson, Suren Fernando, David Garth, Joe Hemmeter, Daniel Jordan, Ken
Price, Khang Tran, and Anthony Vazzana. Special thanks to Lorene Erick-
son for creating the cover artwork, Spacescape V. I would also like to thank
the people at CRC Press, especially David Grubbs and Kenneth Rosen, for
their help and encouragement in writing this book.

Part I
Counting: Basic
1


Chapter 1
Subsets of a Set
Abby has collected 100 pennies. She oﬀers Betty the choice of any or all of
the pennies from her collection. The number of selections of pennies that
Betty can make is 1,267,650,600,228,229,401,496,703,205,376.
We begin with one of the simplest theorems of discrete mathematics.
Denote by N the set of natural numbers, {1, 2, 3, . . .}.
Theorem 1.1. Given n ∈N, a set with n elements has 2n subsets.
Proof. Each element in the given n-element set can either be included or
not included in a subset. Hence, there are
2 × 2 × 2 × · · · × 2
|
{z
}
n
= 2n
choices in forming subsets.
■
Notice that when choices are made independently, we multiply the num-
bers of choices. This principle is called the “product rule.”
Example 1.2. How many subsets does the set {A, B, C} have?
Solution: The set {A, B, C} has 23 = 8 subsets:
∅, {A}, {B}, {C}, {A, B}, {A, C}, {B, C}, {A, B, C}.
■
Example 1.3. How many subsets does a 100-element set have?
Solution: As stated in the teaser above, the number of subsets of a 100-
element set is the colossal number
2100 = 1267650600228229401496703205376 .= 1.3 × 1030.
■
3

4
Pearls of Discrete Mathematics
Exercises
1. How many subsets does the set {A, B, C, D} have? List the subsets.
2. At a certain dinner, there are four choices for the appetizer, two
choices for the main course, and three choices for the dessert. How
many diﬀerent meals are possible?
33. Find the smallest integer n such that the number of subsets of an
n-element set is greater than 10100 (a googol).
4. A teacher making a book display wants to showcase a novel, a history
book, and a science book. There are four choices for the novel, two
choices for the history book, and 10 choices for the science book. How
many choices are possible for the three books?
5. A license consists of three digits (0 through 9), followed by a letter (A
through Z), followed by another digit. How many diﬀerent licenses
are possible?
6. How many strings of 10 symbols are there in which the symbols may
be 0, 1, or 2?
7. How many subsets of the set {a, b, c, d, e, f, g, h, i, j} do not contain
both a and b?
8. How many binary strings of length 99 are there such that the sum of
the elements in the string is an odd number?
9. How many functions map the set {a, b, c} to the set {w, x, y, z}?
10. How many functions map an n-element set to itself?
11. Let X = {1, 2, 3, . . ., 2n}. How many functions map X to X such
that each even number is mapped to an even number and each odd
number is mapped to an odd number?
12. Is the result of Theorem 1.1 true for n = 0?
13. How many ways can you place a White King and a Black King on
an 8 × 8 chessboard so that they don’t attack each other? (A King
attacks the squares horizontally, vertically, and diagonally adjacent
to its own square.)

Chapter 2
Pascal’s Triangle
Using Pascal’s triangle, it is easy to calculate the number of subsets of a
given set that have a certain size.
A permutation of a set is a selection of the elements of the set in some
order. The number of permutations of n objects is n!, that is, the factorial
function deﬁned by
n! = n(n −1)(n −2) . . .3 · 2 · 1, for n ≥1, and 0! = 1.
Example 2.1. How many ways may 10 books be arranged on a shelf?
Solution: The number of arrangements is the number of permutations of
10 elements:
10! = 10 · 9 · 8 · 7 · 6 · 5 · 4 · 3 · 2 · 1 = 3628800.
■
More generally, the number of permutations of k objects from a set of
n objects is
P (n, k) = n(n −1)(n −2) . . .(n −k + 1) =
n!
(n −k)!,
0 ≤k ≤n.
Example 2.2. How many ways can four books from a set of 10 books be
arranged on a shelf?
Solution: The number of arrangements is P (10, 4) = 10·9·8·7 = 5040.
■
A combination from a set is a subset of the set, i.e., a selection of
elements of the set in which the order of the selected elements doesn’t
matter. The number of k-element combinations from an n-element set is
C(n, k) = P (n, k)
k!
=
n!
k!(n −k)!,
0 ≤k ≤n.
We set C(n, k) = 0 if k < 0 or k > n.
The numbers C(n, k) are given in Pascal’s triangle, named after Blaise
5

6
Pearls of Discrete Mathematics
1
1
1
1
2
1
1
3
3
1
1
4
6
4
1
1
5
10
10
5
1
1
6
15
20
15
6
1
1
7
21
35
35
21
7
1
1
8
28
56
70
56
28
8
1
1
9
36
84
126 126 84
36
9
1
1
10
45
120 210 252 210 120 45
10
1
...
FIGURE 2.1: Pascal’s triangle.
Pascal (1623–1662).
See Figure 2.1.
The rows of Pascal’s triangle are
numbered 0, 1, 2, etc. from top to bottom, and the columns are numbered
0, 1, 2, etc. from left to right. Each non-1 entry of Pascal’s triangle is equal
to the sum of the two entries directly above it.
The entry in row n, column k of Pascal’s triangle is C(n, k).
This
number is the same as the binomial coeﬃcient
n
k

.
For example, entry 2 of row 6 is C(6, 2) =  6
2
 = 6!/(2!4!) = 15.
Theorem 1.1 tells us that the sum of the numbers in row n of Pascal’s
triangle is 2n.
For example, the sum of the entries in the sixth row is
1 + 6 + 15 + 20 + 15 + 6 + 1 = 64 = 26.
The simple rule that generates Pascal’s triangle is a recurrence relation
known as Pascal’s identity:
n
k

=
n −1
k −1

+
n −1
k

,
1 ≤k ≤n −1,
n
0

= 1,
n
n

= 1.
Pascal’s identity has a counting proof. The binomial coeﬃcient
 n
k

is the
number of k-element subsets of the set {1, . . ., n}. Each such subset either
contains the element n or does not contain n. The number of k-element
subsets that contain n is  n−1
k−1
.
The number of k-element subsets that
don’t contain n is
 n−1
k

.

2 Pascal’s Triangle
7
Binomial coeﬃcients get their name because they are the coeﬃcients of
a binomial expansion. That is,
 n
k

is the coeﬃcient of an−kbk in (a + b)n.
The binomial theorem says just that.
Theorem 2.3 (Binomial Theorem).
(a + b)n =
n
X
k=0
n
k

an−kbk,
n ≥0.
Example 2.4. Give the expansion of (a + b)6.
Solution: By the binomial theorem, the expansion of (a + b)6 is
6
0

a6b0 +
6
1

a5b1 +
6
2

a4b2 +
6
3

a3b3 +
6
4

a2b4 +
6
5

a1b5 +
6
6

a0b6
= a6 + 6a5b + 15a4b2 + 20a3b3 + 15a2b4 + 6ab5 + b6.
■
Armed with the binomial theorem, we can give a second proof of The-
orem 1.1. Set a = 1 and b = 1, and we get
2n =
n
X
k=0
n
k

.
Thus, there are 2n subsets of an n-element set.
Exercises
1. A teacher has eight books to put on a shelf.
How many diﬀerent
orderings of the books are possible?
2. A student has 10 books but only room for six of them on a shelf. How
many permutations of the books are possible on the shelf?
33. Find the smallest integer n such that n! > 10100 (a googol).
4. A couple plans to visit three selected cities in Germany, followed by
four selected cities in France, followed by ﬁve selected cities in Spain.
In how many ways can the couple order their itinerary?

8
Pearls of Discrete Mathematics
5. You have three small glasses, four medium-size glasses, and ﬁve large
glasses. If glasses of the same size are indistinguishable, how many
ways can you arrange the glasses in a row?
6. A librarian wants to arrange four astronomy books, ﬁve medical
books, and six religious books on a shelf.
Books of the same cat-
egory should be grouped together, but otherwise the books may be
put in any order. How many orderings are possible?
7. In how many ways can you arrange the letters of the word RHODO-
DENDRUM?
8. How many one-to-one functions are there from the set {a, b, c} to the
set {t, u, v, w, x, y, z}?
9. Let X be an n-element set, where n ∈N. How many functions from
X to X are not one-to-one?
10. Find a formula for the number of diﬀerent binary relations possible
on a set of n elements, where n ∈N.
11. Professor Bumble teaches ﬁve diﬀerent classes, A, B, C, D, and E. He
prepared a diﬀerent lecture for each class today, but he gave some or
all of the lectures to the wrong classes. He knows that class A received
the wrong lecture. In how many diﬀerent orders can Professor Bumble
have given his lectures today?
12. A singer plans to perform three songs from a repertoire of 12 songs.
How many diﬀerent programs are possible if there are two songs, A
and B, that cannot both be performed?
13. A student decides to take three classes from a set of 10. In how many
ways may she do this?
14. In a certain lottery, a contestant must choose six numbers from the
set 1, 2, . . . , 44. How many combinations are possible?
15. Evaluate
 20
10

.
16. What is the coeﬃcient of a10b10 in the expansion of (a + b)20?
17. Give the expansion of (a + b)10.
18. Give simple formulas for
 n
2

and
 n
3

.
19. What is the coeﬃcient of x10 in (1 + x2)20?
20. What is the coeﬃcient of x7 in (1 −2x)10?

2 Pascal’s Triangle
9
21. What is the constant in the expansion of (x + 1/x)20?
22. What is the constant in the expansion of (x4 + 1/x)20?
23. Explain the formula C(n, k) = P (n, k)/k!.
24. Give an algebraic proof of Pascal’s identity.
†25. Prove the binomial theorem.
26. Professor Bumble doesn’t remember how many students are in his
honors mathematics class. But he does remember that there are 924
ways to divide the class into two equal-size groups of students. Help
Professor Bumble determine how many students are in his class.
27. A pointer starts at 0 on the real number line and moves right or left
one unit at each step. Let n and k be positive integers. How many
diﬀerent paths of k steps terminate at the integer n?
328. Use the recurrence relation for Pascal’s triangle to compute the value
of the binomial coeﬃcient
 100
50

.
29. Suppose that n lines are given in the plane in “general position” (no
two parallel and no three concurrent at a point).
Into how many
regions is the plane partitioned?
30. Suppose that n planes are given in three-dimensional space in “general
position” (no two parallel, no three concurrent in a line, and no four
concurrent in a point). Into how many regions is space partitioned?


Chapter 3
Binomial Coeﬃcient Identities
Every ﬁnite nonempty set has as many subsets with an even number of
elements as subsets with an odd number of elements.
Consider again the subsets of the three-element set {A, B, C}. Half of
these subsets have an even number of elements and half an odd number of
elements:
even number of elements
odd number of elements
∅
{A}
{A, B}
{B}
{A, C}
{C}
{B, C}
{A, B, C}.
We claim that this property holds for every ﬁnite nonempty set.
Proposition 3.1. Given n ≥1, half of the subsets of an n-element set
have an even number of elements and half have an odd number of elements.
Proof. Let a = 1 and b = −1 in the binomial theorem. Then
n
X
k=0
n
k

(−1)k = (−1 + 1)n = 0n = 0,
n ≥1.
Putting the summands associated with even k on one side of the relation
and those associated with odd k on the other side, we obtain
X
k odd
n
k

=
X
k even
n
k

.
■
For n odd, this assertion follows trivially from the symmetry of the
binomial coeﬃcients, that is,
 n
k

=
  n
n−k

. We give a counting argument
11

12
Pearls of Discrete Mathematics
valid for all n ≥1. Let X = {1, 2, 3, . . ., n} and
A
=
{S ⊆X : |S| is even and 1 ∈S}
B
=
{S ⊆X : |S| is odd and 1 ∈S}
C
=
{S ⊆X : |S| is even and 1 ̸∈S}
D
=
{S ⊆X : |S| is odd and 1 ̸∈S}.
There is a one-to-one correspondence between A and D: simply remove 1
from every element of A to form an element of D. (What is the inverse?)
Similarly, there is a one-to-one correspondence between B and C. Hence
|A| = |D| and |B| = |C|, and it follows that
|A| + |C| = |B| + |D|.
Let’s explore a few more binomial coeﬃcient identities.
Example 3.2. What is the sum Pn
k=0
 n
k
2 ?
Solution: We work out some examples using Pascal’s triangle:
n = 1 : 12 = 1
n = 2 : 12 + 12 = 2
n = 3 : 12 + 22 + 12 = 6
n = 4 : 12 + 32 + 32 + 12 = 20
n = 5 : 12 + 42 + 62 + 42 + 12 = 70.
We recognize these sums as central binomial coeﬃcients, and we make
the conjecture that
n
X
k=0
n
k
2
=
2n
n

.
Typically, the mathematical process consists of working examples, look-
ing for patterns, making conjectures, and proving the conjectures. Let’s try
to prove our conjecture.
We rewrite our conjecture as follows:
n
0
n
0

+
n
1
n
1

+
n
2
n
2

+ · · · +
n
n
n
n

=
2n
n

.
We know that the right side counts the ways of selecting n numbers from

3 Binomial Coeﬃcient Identities
13
the set {1, 2, 3, . . ., 2n}. Why is this counted by the left side? Rewrite a
little, using symmetry:
n
0
n
n

+
n
1

n
n −1

+
n
2

n
n −2

+ · · · +
n
n
n
0

=
2n
n

.
Now the truth of the identity is clear. The right side counts the number of
n-element subsets of {1, 2, 3, . . ., 2n}. The left side counts the same thing,
where, for 0 ≤k ≤n, the term
 n
k
  n
n−k

counts the number of subsets in
which k elements are chosen from the set {1, . . ., n} and n−k elements are
chosen from the set {n + 1, . . ., 2n}.
■
The identity of Example 3.2 has a counting interpretation in terms of
lattice paths, i.e., paths along the lines of an n × n grid. The binomial
coeﬃcient
 2n
n

is the number of northeast paths that start at the south-
west corner of the grid and stop at the northeast corner. Each path has
length 2n and is determined by a sequence of n “easts” and n “norths” in
some order. The summation Pn
k=0
 n
k
2 counts the paths according to their
intersection with the main southeast diagonal of the grid. The number of
paths that cross the diagonal at the point k units east of the starting point
is
 n
k
2, where 0 ≤k ≤n.
Both Pascal’s identity and the identity of Example 3.2 are generalized
by Vandermonde’s identity, credited to Alexandre-Th´eophile Vandermonde
(1735–1796):
m + n
k

=
k
X
i=0
m
i
 n
k −i

,
m, n, k ≥0.
The binomial coeﬃcient  m+n
k
 is the number of k-element subsets of the set
{1, . . ., m+n}. The number of such subsets that contain i elements from the
set {1, . . ., m} and k−i elements from the set {m+1, . . ., m+n} is
 m
i
  n
k−i

.
The summation Pk
i=0
 m
i
  n
k−i

counts these subsets for 0 ≤i ≤k. Letting
m = 1, and changing n to n −1, the relation becomes Pascal’s identity.
Letting k = m = n, we obtain the identity from Example 3.2.
The next identity is often useful (e.g., see Chapter 13).
Proposition 3.3 (“Subcommittee Identity”). For 0 ≤j ≤k ≤n, we have
n
k
k
j

=
n
j
n −j
k −j

.
Proof. Both expressions count the number of ways to choose, from n people,
a committee of size k and a subcommittee of size j.
■

14
Pearls of Discrete Mathematics
Example 3.4. Prove the identity
n
X
k=0
n + k
n

2−k = 2n.
Solution: We give a counting proof of the equivalent identity
n
X
k=0
n + k
n

2 · 2n−k = 22n+1.
The right side of this relation is the number of binary strings of length
2n + 1. We must show that the left side counts the same strings. Each
binary string of length 2n + 1 contains at least n + 1 0s or at least n + 1 1s
(but not both). Counting from the left, let n + k + 1, where 0 ≤k ≤n, be
the position of the (n + 1)st 0 or (n + 1)st 1. There are two possibilities for
this element (0 or 1); there are
 n+k
n

binary strings of length n + k that
contain n of one symbol and k of the other; and there are 2n−k choices for
the remaining n −k elements. This establishes the identity.
■
The binomial theorem generalizes to arbitrary exponents. For any real
number α, and k a positive integer, deﬁne
α
k

= α(α −1)(α −2) . . .(α −k + 1)
k!
.
Also, deﬁne
 α
0

= 1. For a proof of the following theorem, see [Rud76].
Theorem 3.5 (Binomial Series). Let α be a real number and |x| < 1.
Then
(1 + x)α =
∞
X
k=0
α
k

xk.
Example 3.6. Let n be an integer greater than or equal to 1. Prove the
formula
1
(1 + x)n =
∞
X
k=0
(−1)k
n + k −1
k

xk,
|x| < 1.
Solution: By the binomial series theorem,
(1 + x)−n =
∞
X
k=0
−n
k

xk.
The result now follows from the identity (see Exercises)
−n
k

= (−1)k
n + k −1
k

.
■

3 Binomial Coeﬃcient Identities
15
Example 3.7. Prove the identity
n
X
k=1
k
n
k

= n2n−1.
Solution: We give three proofs.
(1) The ﬁrst proof is algebraic. Noting that we can “pull an n out” of
each term in the sum, we obtain
n
X
k=1
k
n
k

=
n
X
k=1
k
n!
k!(n −k)!
= n
n
X
k=1
(n −1)!
(k −1)!(n −k)!
= n
n
X
k=1
n −1
k −1

= n2n−1.
(2) The second proof is a counting proof. Consider all possible ways
of choosing a team and a team leader from a group of n people. The left
side clearly counts this, according to the size k of the team. The right side
counts the same thing, as we have n choices for the leader and each other
person can be on or oﬀthe team.
(3) The third proof uses calculus. From the binomial theorem, we have
(x + 1)n =
n
X
k=0
n
k

xk.
Taking a derivative with respect to x yields
n(x + 1)n−1 =
n
X
k=1
n
k

kxk−1.
Evaluating both sides of the last relation at x = 1, we obtain our desired
identity.
See Chapter 10 for a probabilistic proof of this result.
■

16
Pearls of Discrete Mathematics
Exercises
1. Prove the following identities:
(a)  n
k
 = n
k
 n−1
k−1

(b)
 −n
k

= (−1)k n+k−1
k

.
2. Prove the identity
1 · 2 + 2 · 3 + 3 · 4 + · · · + n · (n + 1) = n(n + 1)(n + 2)/3.
3. Find and prove a simple formula for
1 · 2 · 3 + 2 · 3 · 4 + 3 · 4 · 5 + · · · + n · (n + 1) · (n + 2).
4. Prove the following identities:
(a)
 2n−1
n

= Pn
k=0
 n
k
 n−1
k

(b)
 3n
n

= Pn
k=0
 n
k
 2n
k

.
5. (a) Prove the identity  n
k
 = n−k+1
k
  n
k−1
.
(b) Use the identity of part (a) to show that the entries of each row of
Pascal’s triangle increase from left to right, attain a maximum value
at the middle entry (or two middle entries), and then decrease.
6. Prove the inequality  n
k
2 ≥  n
k−1
  n
k+1
, where 1 ≤k ≤n −1.
7. Prove the identity
m −1
k

=
k
X
i=0
m
i

(−1)k−i.
8. Suppose that ﬁve particles travel back and forth on the unit inter-
val [0, 1]. At the start, all ﬁve particles move to the right with the
same speed. When a particle reaches 0 or 1, it reverses direction but
maintains its speed. When two particles collide, they both reverse
direction (and maintain their speeds).
How many particle–particle
collisions occur before the particles once again occupy their original
positions and are moving to the right?
9. Show that the number of ways that 2n people may be paired into n
pairs is
 2n
n

n!2−n.

3 Binomial Coeﬃcient Identities
17
10. Prove that the number
4700!
100!(47!)100
is an integer. Do this without actually calculating the number.
11. Prove the identity
m + n + 1
n + 1

=
m
X
i=0
n + i
n

.
12. Simplify the expression
n
X
k=1
n
k
k2
3k .
13. Prove that the number of binary strings of length n that contain
exactly k copies of the string 10 is
 n + 1
2k + 1

.
†⋆14. For each integer k ≥0, deﬁne
Sk(n) =
n
X
i=1
ik.
Give formulas for S0(n), S1(n), S2(n), and S3(n). Prove that Sk(n)
is a polynomial in n of degree k +1 with leading coeﬃcient 1/(k +1).
315. Use a computer to ﬁnd S10(n), where this polynomial is deﬁned in
the previous exercise.
16. Give the ﬁrst several terms of the expansion of (1 + x)−4 in powers
of x.
317. Use a computer to give the ﬁrst 10 terms of the expansion of (1+3x)−7
in powers of x.
†18. Prove the multinomial theorem: In the expansion of
(x1 + x2 + · · · + xk)n,
the coeﬃcient of xα1
1 xα2
2 . . . xαk
k , where the αi are nonnegative integers
such that α1 + α2 + · · · + αk = n, is the multinomial coeﬃcient

n
α1, α2, . . ., αk

=
n!
α1!α2! . . .αk!.

18
Pearls of Discrete Mathematics
19. Give the expansion of (a + b + c)4.
20. What is the coeﬃcient of x3y7 in the expansion of (x + y + 1)20?
21. Let R be the set of real numbers.
(a) How many paths in R2 start at the origin (0, 0), move in steps of
(1, 0) or (0, 1), and end at (10, 15)?
(b) How many paths in R3 start at the origin (0, 0, 0), move in steps
of (1, 0, 0), (0, 1, 0), or (0, 0, 1), and end at (10, 15, 20)?
322. Use a computer and the multinomial theorem to ﬁnd the coeﬃcient
of x10y10 in the expansion of (1 + x + y)100.
23. You can order a pizza with up to four toppings (repetitions allowed)
from a set of 12 toppings. The order of the toppings is unimportant.
How many diﬀerent pizzas can you order?
24. How many solutions does the equation
x1 + x2 + x3 = 10
have in nonnegative integers?
†25. How many solutions does the equation
x1 + · · · + xk = n
have in nonnegative integers?
26. How many ways can k indistinguishable balls be placed in n distin-
guishable urns so that each urn contains an odd number of balls?
27. Prove the identity
n
X
j=0
n
X
k=0
n + j + k
n, j, k

3−j−k = 3n.
†28. Let S(n) be the number of ways that n can be written as a sum of
positive integers: n = n1 +· · ·+nk for any k (order important). Such
summations are called compositions of n.
†29. Show that the number of permutations of n elements with an odd
number of cycles is equal to the number of permutations of n elements
with an even number of cycles.

Part II
Counting: Intermediate
19


Chapter 4
Finding a Polynomial
There is a simple method for ﬁnding a polynomial given its initial values.
Suppose that the values of a polynomial p(n), for n ≥0, are
5, 13, 25, 83, 277, 745, 1673, 3295, 5893, 9797, 15385, . . . .
What is p(n)?
We take successive diﬀerences of consecutive terms of the sequence,
forming the ﬁrst diﬀerence sequence:
8, 12, 58, 194, 468, 928, 1622, 2598, 3904, 5588, . . ..
Repeating this operation, we ﬁnd the second diﬀerence sequence:
4, 46, 136, 274, 460, 694, 976, 1306, 1684, . . . .
The third diﬀerence sequence is
42, 90, 138, 186, 234, 282, 330, 378, . . ..
The fourth diﬀerence sequence is
48, 48, 48, 48, 48, 48, 48, . . ..
Having obtained a constant sequence, we stop.
We ﬁnd p(n) by multi-
plying the ﬁrst terms of these diﬀerence sequences by successive binomial
coeﬃcients:
p(n) = 5
n
0

+ 8
n
1

+ 4
n
2

+ 42
n
3

+ 48
n
4

= 2n4 −5n3 + 3n2 + 8n + 5.
If p(n) is a polynomial of degree 4, then we have found it. However, it’s
possible that p(n) is only masquerading as this simple polynomial and more
of its values would reveal a diﬀerent (higher degree) answer.
21

22
Pearls of Discrete Mathematics
Why does this method work? The key is Pascal’s identity:
n
k

=
n −1
k

+
n −1
k −1

,
1 ≤k ≤n −1.
Every polynomial of degree d can be written as a linear combination of
the polynomials  n
k
, for 0 ≤k ≤d. Let’s see what happens under the
diﬀerence operations to the sequence given by the polynomial  n
k
. From
Pascal’s identity, the sequence
0
k

,
1
k

,
2
k

,
3
k

, . . .
yields the ﬁrst diﬀerence sequence

0
k −1

,

1
k −1

,

2
k −1

,

3
k −1

, . . ..
Continuing in this manner, the kth diﬀerence sequence is
0
0

,
1
0

,
2
0

,
3
0

, . . . .
Since these terms are all equal to 1, we stop, and the contribution to p(n)
from our calculation is 1 ·
 n
k

=
 n
k

, which is correct.
Since p(n) can
be written as a linear combination of the polynomials
 n
k

, and each such
polynomial gives the correct contribution in our formula, then our formula
is correct.
Example 4.1. Let’s try another sequence, say,
0, 5, 18, 45, 92, 165, 270, 413, . . ..
What polynomial produces this sequence?
Solution: We write down the array of diﬀerence sequences:
0,
5,
18,
45,
92,
165,
270,
413,
. . .
5,
13,
27,
47,
73,
105,
143,
. . .
8,
14,
20,
26,
32,
38,
. . .
6,
6,
6,
6,
6,
. . . .
We obtain the polynomial
0
n
0

+ 5
n
1

+ 8
n
2

+ 6
n
3

= n3 + n2 + 3n.
■

4 Finding a Polynomial
23
Exercises
1. Suppose that the sequence
7, 11, 25, 73, 203, 487, 1021, 1925, 3343, 5443, 8417, . . .
represents the values of a polynomial p(n), where n = 0, 1, 2, . . . .
What is the polynomial?
2. Professor Bumble wrote down the ﬁrst few terms p(0), p(1), etc. of a
polynomial,
0, 1, 32, 243, 1024, 3125, 7776, 16807, 32768, 59049, 100000, . . .,
but he forgot what polynomial he started with. Help Professor Bum-
ble ﬁnd p(n).
3. Show how to write the polynomial n3 + 2n2 −n + 1 as a linear com-
bination of the polynomials
 n
k

, for 0 ≤k ≤3.
4. Suppose that p is a polynomial such that p(0) = 3, p(2) = 5, p(4) =
39, p(6) = 153, and p(8) = 395. What is your best guess for p(n)?
†5. Explain why every polynomial of degree d can be written as a linear
combination of the polynomials  n
k
, for 0 ≤k ≤d.
†6. Prove that
nd =
d
X
k=1
T(d, k)
n
k

,
where T(d, k) is the number of onto functions from {1, . . ., d} to
{1, . . ., k}.
37. Professor Bumble wrote the values of a polynomial in two variables,
p(m, n), for 0 ≤m, n ≤5, in a two-dimensional array, as follows.
10
16
22
28
34
40
15
23
33
45
59
75
20
36
68
116
180
260
25
61
151
295
493
745
30
104
306
636
1094
1680
35
171
557
1193
2079
3215
Professor Bumble has forgotten what polynomial he started with.
Can you devise a simple, fast way to ﬁnd p(m, n)?

24
Pearls of Discrete Mathematics
8. Find a recurrence relation for the sequence
3, 2, −1, 0, 11, 38, 87, 164, 275, 426, 623, . . . .
9. Suppose that p is a polynomial of degree 3 such that p(0) = 1, p′(0) =
1, p′′(0) = 4, and p′′′(0) = 18. What is p(n)?
10. Is there a polynomial p(n), with integer coeﬃcients, whose values, for
n ≥0, are
1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, . . .?

Chapter 5
The Upward-Extended Pascal’s
Triangle
Do you know that Pascal’s triangle extends upward? The extended triangle
gives the coeﬃcients of binomial series for negative exponents.
In Figure 5.1, Pascal’s identity is used to calculate binomial coeﬃcients
 n
k
 with negative values of n. (In the ﬁgure, the triangle is left-justiﬁed and
some entries are padded with 0s to aid in the calculation.) The recurrence
relation is
n
k

=
n + 1
k

−

n
k −1

,
k ≥0,
and we deﬁne   n
−1
 = 0, for all n.
Try to verify some of the entries in
the extended Pascal’s triangle. Do you recognize the values?
They are
the numbers (−1)k n+k−1
k

, given by the binomial series theorem for the
coeﬃcients of x in the expansion of (1 + x)−n.
Example 5.1. Give the ﬁrst several terms of the expansion of (1 + x)−4
in powers of x.
Solution: We locate the coeﬃcients of the expansion in row −4 of the ex-
tended Pascal’s triangle. Thus
(1 + x)−4 = 1 −4x + 10x2 −20x3 + 35x4 −56x5 + · · · .
■
Exercises
1. Use the extended Pascal’s triangle to give the ﬁrst several terms of
the expansion of (1 + x)−5 in powers of x.
2. Use the extended Pascal’s triangle to give the ﬁrst several terms of
the expansion of (1 −x2)−4 in powers of x.
25

26
Pearls of Discrete Mathematics
...
...
...
...
...
...
...
0
1
−5
15
−35
70
−126
· · ·
0
1
−4
10
−20
35
−56
· · ·
0
1
−3
6
−10
15
−21
· · ·
0
1
−2
3
−4
5
−6
· · ·
0
1
−1
1
−1
1
−1
· · ·
0
1
0
0
0
0
0
· · ·
0
1
1
0
0
0
0
· · ·
0
1
2
1
0
0
0
· · ·
0
1
3
3
1
0
0
· · ·
0
1
4
6
4
1
0
· · ·
0
1
5
10
10
5
1
· · ·
...
...
...
...
...
...
...
FIGURE 5.1: The extended Pascal’s triangle.
3. Calculate by hand (using the recurrence relation) the ﬁrst few terms
of row −6 of Pascal’s triangle.
4. What is the sum of the series
1 −2
7 + 3
72 −4
73 + 5
74 −6
75 + · · · ?
5. What is the sum of the series
1 + 3
2
3

+ 6
2
3
2
+ 10
2
3
3
+ 15
2
3
4
+ 21
2
3
5
+ · · · ?
6. If the ﬁrst few terms of the expansion of (1 + x)n + (1 + x)−n, in
powers of x, are
2 + 9x2 −9x3 + 15x4 −21x5 + 28x6 −36x7 + 45x8 −55x9 + · · · ,
what is n?
7. Professor Bumble computes the ﬁrst few terms of the expansion of
(1 + x)n, for some integer n. One of the terms he obtains is 15x4.
Later, he forgets the value of n that he used. Help Bumble ﬁnd the
possible values of n.
38. Use a computer and Pascal’s recurrence relation to generate a table
of binomial coeﬃcients
 n
k

, with −10 ≤n ≤10 and 0 ≤k ≤10.

Chapter 6
Recurrence Relations and Fibonacci
Numbers
Inﬁnitely many numbers appear at least six times in Pascal’s triangle.
The kth powers of the Fibonacci numbers satisfy a linear homogeneous re-
currence relation of order k + 1 with integer coeﬃcients.
Let’s consider one of the most famous sequences of numbers, the Fi-
bonacci sequence, named after Leonardo of Pisa, a.k.a. Leonardo Fibonacci
(1170–1250). The Fibonacci sequence {F0, F1, F2, . . .} is deﬁned recursively
by the initial values
F0 = 0, F1 = 1,
and the recurrence relation
Fn = Fn−1 + Fn−2,
for n ≥2.
Thus, the Fibonacci numbers are
0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, . . . .
Fibonacci numbers count many things. For example:
• Fn+1 is the number of ways that an n × 1 box may be packed with
2 × 1 and 1 × 1 boxes.
• Fn+2 is the number of binary strings of length n that do not contain
the substring 00.
• Fn+2 is the number of subsets of the set {1, . . ., n} that contain no
two consecutive integers.
Let’s prove the second of these formulas. Let sn be the number of bi-
nary strings of length n that contain no 00. We will prove that sn = Fn+2,
for n ≥1. Observe that s1 = F3 = 2, and s2 = F4 = 3. We will show that
sn = sn−1 + sn−2, for n ≥2 (the same recurrence relation as the one satis-
ﬁed by the Fibonacci numbers). Notice that each binary string of length n
27

28
Pearls of Discrete Mathematics
that does not contain 00 ends in either 1 or 10. The number of such strings
of the ﬁrst type is sn−1 and the number of such strings of the second type
is sn−2. Hence sn = sn−1 + sn−2, for n ≥2. Now, since {sn} satisﬁes
the same recurrence relation as the Fibonacci numbers, and s1 = F3 and
s2 = F4, it follows by mathematical induction that sn = Fn+2, for all n ≥1.
The next result, a very handy identity, was discovered by Giovanni
Domenico Cassini (1625–1712).
Example 6.1. (Cassini’s identity) Prove that F 2
n −Fn−1Fn+1 = (−1)n+1,
for n ≥1.
Solution: We will prove the result by induction.
The identity holds for
n = 1, since F 2
1 −F0F2 = 1 −0 = 1 = (−1)2. Assume that it holds for n.
Then
F 2
n+1 −FnFn+2 = F 2
n+1 −Fn(Fn + Fn+1)
= Fn+1(Fn+1 −Fn) −F 2
n
= Fn+1Fn−1 −F 2
n
= (−1)n+2.
Hence, the formula holds for n + 1 and by induction for all n ≥1.
■
Here is a wonderful (and perhaps little known) fact about Pascal’s tri-
angle.
Proposition 6.2 (David Singmaster, 1975). Inﬁnitely many numbers oc-
cur at least six times in Pascal’s triangle.
Proof. Consider solutions to
r =

n
m −1

=
n −1
m

,
given by
m = F2k−1F2k,
n = F2kF2k+1,
k ≥2.
The number r in such a solution occurs (at least) six times in Pascal’s
triangle:
r
1

=

r
r −1

=

n
m −1

=

n
n −m + 1

=
n −1
m

=

n −1
n −m −1

.
Check that these occurrences are really distinct!

6 Recurrence Relations and Fibonacci Numbers
29
Let’s verify that such m and n give the claimed values of r. The following
relations are equivalent:

n
m −1

=
n −1
m

n!
(m −1)!(n −m + 1)! =
(n −1)!
m!(n −m −1)!
mn = (n −m + 1)(n −m)
F2k−1F2kF2kF2k+1 = (F2kF2k+1 −F2k−1F2k + 1)(F2kF2k+1 −F2k−1F2k)
= (F2k(F2k+1 −F2k−1) + 1)(F2k(F2k+1 −F2k−1))
= (F 2
2k + 1)F 2
2k
F2k−1F2k+1 = F 2
2k + 1.
The ﬁnal relation is true by Cassini’s identity.
■
The smallest such number given by our proof (when k = 2) is 3003.
Pascal’s identity together with initial values (see p. 6) makes a recur-
rence formula that allows us to build Pascal’s triangle:
n
k

=
n −1
k −1

+
n −1
k

,
1 ≤k ≤n,
n
0

=
n
n

= 1,
n ≥0.
We also have a direct formula for any given entry of Pascal’s triangle:
n
k

=
n!
k!(n −k)!,
0 ≤k ≤n.
Which is more useful, the recurrence formula or the direct formula? It de-
pends on the situation.
A sequence {an} satisﬁes a linear homogeneous recurrence relation of
order k with constant coeﬃcients if
an =
k
X
i=1
cian−i,
for constants c1, . . . , ck, and all n ≥k.

30
Pearls of Discrete Mathematics
The Fibonacci sequence satisﬁes a linear homogeneous recurrence rela-
tion of order 2 with constant coeﬃcients.
How do we ﬁnd an explicit formula for the nth Fibonacci number?
We will show how to guess and construct a solution.
Assume that xn,
where n ≥0, is the general term of a sequence that satisﬁes the Fibonacci
recurrence relation (but not necessarily with the same initial values). Then
xn = xn−1 + xn−2.
Assuming that x ̸= 0, we divide through by xn and obtain the equation
x2 −x −1 = 0.
This polynomial x2 −x −1 is called the characteristic polynomial of the
sequence. We use the quadratic formula to ﬁnd the two roots of the char-
acteristic polynomial:
φ = 1 +
√
5
2
,
ˆφ = 1 −
√
5
2
.
We call φ the “golden ratio.” Note that φ .= 1.6 and ˆφ .= −0.6.
So we know that φn and ˆφn both satisfy the Fibonacci recurrence re-
lation. Any linear combination of the basic solutions, Aφn + B ˆφn, with
A, B ∈R, also satisﬁes the recurrence relation, for
(Aφn−1 + B ˆφn−1) + (Aφn−2 + B ˆφn−2) = A(φn−1 + φn−2) + B(ˆφn−1 + ˆφn−2)
= Aφn + B ˆφn.
We use the initial values to solve for the coeﬃcients A and B.
Re-
calling that F0 = 1 and F1 = 1, we obtain two linear equations to solve
simultaneously:
1 = Aφ0 + B ˆφ0 = A + B
1 = Aφ1 + B ˆφ1 = A
 
1 +
√
5
2
!
+ B
 
1 −
√
5
2
!
.
We ﬁnd that
A =
1
√
5
and B = −1
√
5
.
Thus, the general formula for the Fibonacci numbers is
Fn =
1
√
5φn −1
√
5
ˆφn,
n ≥0.

6 Recurrence Relations and Fibonacci Numbers
31
The above function satisﬁes the recurrence relation and initial values of
the Fibonacci sequence, and hence is a formula for the Fibonacci sequence
(since the sequence is well-deﬁned).
What is the growth rate of {Fn}? We say that a positive-valued function
f(n) is “asymptotic” to another such function g(n), and we write f(n) ∼
g(n), if limn→∞f(n)/g(n) = 1. Since ˆφn →0 as n →∞, we conclude that
Fn ∼φn
√
5
.
If f and g are functions deﬁned on the set of positive integers, and
|f(n)| ≤C|g(n)|
for some positive constant C and all n ≥n0, for some n0, then we say that
f is “big oh” of g, and write f(n) = O(g(n)). In this notation,
Fn = O (φn) .
Example 6.3. Find an explicit formula for the sequence {an} deﬁned by
the recurrence formula
a0 = 1, a1 = 1, an = 6an−1 −9an−2,
n ≥2.
Solution: The characteristic polynomial of the sequence is
x2 −6x + 9 = (x −3)2,
which has 3 as a double root. Hence, 3n is a solution to the recurrence
relation. However, we need a second solution in order to make the formula
satisfy the initial values. A guess for a second solution is n3n. Let’s check
that this solution satisﬁes the recurrence relation:
6(n −1)3n−1 −9(n −2)3n−2 = 3n−2(18n −18 −9n + 18)
= n3n.
Any linear combination of our two solutions also satisﬁes the recurrence
relation:
A3n + Bn3n.
In order to satisfy the initial values, a0 = 1 and a1 = 1, we require that
1 = A
1 = 3A + 3B,
and hence A = 1 and B = −2/3. Therefore, the explicit formula for the
sequence is
an = 3n −2n3n−1,
n ≥0.
We see that an = O(n3n).
■

32
Pearls of Discrete Mathematics
The next example illustrates the technique of adding a particular solu-
tion and a homogeneous solution.
Example 6.4. Find an explicit formula for the sequence {an} deﬁned by
the recurrence formula
a0 = 1, a1 = 1, an = 6an−1 −9an−2 + n,
n ≥2.
Solution: We ﬁnd a particular solution to the recurrence relation. Assume
the existence of a solution of the form an = αn + β. Thus
αn + β = 6(α(n −1) + β) −9(α(n −2) + β) + n
(4α −1)n = 12α −4β.
In order for this identity to hold for all n, we must have α = 1/4 and hence
β = 3/4. Therefore
1
4n + 3
4
satisﬁes the recurrence relation.
We solved the homogeneous version of this recurrence relation in the
previous example. Thus, the general solution to the recurrence relation is
of the form
A3n + Bn3n + 1
4n + 3
4.
The initial values, a0 = 1 and a1 = 1, determine the values A = 1/4 and
B = −1/4. Therefore, an explicit formula is
an = 1
43n −1
4n3n + 1
4n + 3
4,
n ≥0.
■
The Lucas numbers, named after Fran¸cois ´Edouard Anatole Lucas (1842–
1891), are deﬁned as
L0 = 2, L1 = 1, Ln = Ln−1 + Ln−2,
n ≥2.
Thus, the Lucas numbers are
2, 1, 3, 4, 7, 11, 18, 29, 47, 76, 123, 200, 323, 523, 846, 1369, . . . .
• Ln is the number of ways an n × 1 box may be packed with 2 × 1 and
1 × 1 boxes, allowing “wrap-around.”
Since the Lucas numbers satisfy the same recurrence relation as the
Fibonacci numbers, they have the same characteristic polynomial, x2−x−1.
Taking into account the initial values L0 = 2 and L1 = 1, we obtain a
formula for the Lucas numbers:
Ln = φn + ˆφn,
n ≥0.
The simplicity of this formula is a shining property of the Lucas sequence.

6 Recurrence Relations and Fibonacci Numbers
33
Exercises
1. Prove the identity
F1 + · · · + Fn = Fn+2 −1,
n ≥1.
2. Prove the identity
F 2
1 + · · · + F 2
n = FnFn+1,
n ≥1.
3. Prove the identity
Fm+n = FmFn+1 + Fm−1Fn,
m ≥1, n ≥0.
34. Use a computer and the Fibonacci recurrence formula to calculate
F100.
5. Where do you ﬁnd Fibonacci numbers in Pascal’s triangle? What
identity supports this?
6. Find positive integers n, k, with k < n, for which
n
k

+

n
k + 1

=

n
k + 2

.
⋆7. Prove that
∞
X
n=1
tan−1
1
F2n+1
= π
4 .
38. Use a computer to ﬁnd the smallest number other than 1 that appears
six times in Pascal’s triangle.
39. Use a computer to ﬁnd the second smallest number given by Propo-
sition 6.2 that appears six times in Pascal’s triangle.
10. Let {an} be deﬁned by the recurrence
a0 = 0, a1 = 1, an = 5an−1 −6an−2, n ≥2.
Find an explicit formula for an.
11. Suppose that the sequence {an} satisﬁes the recurrence relation
an = 3an−1 + 4an−2 −12an−3,
n ≥3,
where a0 = 0, a1 = 1, and a2 = 2. Find an explicit formula for an.

34
Pearls of Discrete Mathematics
12. Let {bn} be deﬁned by the recurrence
b0 = 0, b1 = 0, b2 = 1, bn = 4bn−1 −bn−2 −6bn−3, n ≥3.
Find an explicit formula for bn.
Do the same where the initial values are b0 = 0, b1 = 1, b2 = 2.
13. Deﬁne {an} by the recurrence
a0 = 0, a1 = 1, an = 5an−1 −6an−2, n ≥2
and {bn} by the recurrence
b0 = 0, b1 = 1, bn = 9bn−1 −20bn−2, n ≥2.
Find a linear recurrence for the sequence {cn} deﬁned by
cn = an + bn,
n ≥0.
Find a linear recurrence for the sequence {dn} deﬁned by
dn = anbn,
n ≥0.
14. Find a linear recurrence for the sequence {an} deﬁned by
an = Fn + 2n,
n ≥0,
where Fn is the nth Fibonacci number.
15. (a) Find a linear homogeneous recurrence formula for the sequence
{an} deﬁned by an = 3n + n2, where n ≥0.
(b) Find a linear homogeneous recurrence formula for the sequence
{an} deﬁned by an = 3n + n2 + 6n + 7, where n ≥0.
16. Find an explicit formula for the sequence {an} deﬁned by the recur-
rence formula
a0 = 0, a1 = 1, an = an−1 + an−2 + n, n ≥2.
17. Find an explicit formula for the sequence {an} deﬁned by the recur-
rence formula
a0 = 0, a1 = 1, an = an−1 + an−2 + 2n, n ≥2.
18. Prove the identity Ln = Fn−1 + Fn+1, for n ≥1.
19. Prove the identity Fn = (Ln−1 + Ln+1)/5, for n ≥1.

6 Recurrence Relations and Fibonacci Numbers
35
20. Prove the identity F2n = FnLn, for n ≥0.
21. Find a relation for Lucas numbers similar to Cassini’s identity.
22. Find a linear recurrence relation satisﬁed by all cubic polynomials.
23. A square number is an integer of the form n2. A triangular number
is an integer of the form 1 + 2 + · · · + n = n(n + 1)/2. Let an be the
nth number that is both square and triangular. For example, a0 = 0,
a1 = 1, and a2 = 36. Find a linear homogeneous recurrence relation
with constant coeﬃcients for {an}.
24. Find a linear recurrence relation with constant coeﬃcients for the
sequence {2nFn}.
25. Find a linear recurrence relation with constant coeﬃcients for the
sequence of squares of the Fibonacci numbers, {F 2
n}.
⋆26. Prove that the kth powers of the Fibonacci numbers satisfy a linear
homogeneous recurrence relation of order k + 1 with integer coeﬃ-
cients.


Part III
Counting: Advanced
37


Chapter 7
Generating Functions and Making
Change
There are 293 ways to make change for a dollar.
There are 88,265,881,340,710,786,348,934,950,201,250,975,072,332,541,120,001
ways to make change for a million dollars.
Given any sequence a0, a1, a2, . . . , we deﬁne the (ordinary) generating
function
f(x) =
∞
X
n=0
anxn = a0 + a1x + a2x2 + a3x3 + · · · .
The inﬁnite series may or may not converge.
Example 7.1. Find the ordinary generating function for the Fibonacci
sequence {F0, F1, F2, . . .}.
Solution: Let f(x) = P∞
n=0 Fnxn. Then
f(x)
=
x + x2 + 2x3 + 3x4 + 5x5 + · · ·
xf(x)
=
x2 + x3 + 2x4 + 3x5 + 5x6 + · · ·
x2f(x)
=
x3 + x4 + 2x5 + 3x6 + 5x7 + · · · .
Through mass-cancellation, the recurrence relation for the Fibonacci num-
bers yields
f(x) −xf(x) −x2f(x) = x
and hence
f(x) =
x
1 −x −x2 .
■
The generating function for the Fibonacci sequence can be used to ﬁnd
the direct formula for Fn that we found in Chapter 6.
39

40
Pearls of Discrete Mathematics
Notice that the generating function for the Fibonacci sequence is a ra-
tional function. In general, a sequence satisﬁes a linear homogeneous re-
currence relation with constant coeﬃcients if and only if it has a rational
ordinary generating function of a certain type. We will prove this shortly.
Also, notice that the denominator of the generating function for the
Fibonacci numbers, 1−x−x2, takes its form from the Fibonacci recurrence,
while the numerator comes from multiplying the generating function by the
denominator and keeping only those terms of degree less than 2.
Recall that a sequence {an} satisﬁes a linear homogeneous recurrence
relation of order k with constant coeﬃcients c1, . . . , ck if
an =
k
X
i=1
cian−i,
for all n ≥k.
Theorem 7.2. Given a sequence {an} and arbitrary numbers c1, . . . , ck,
the following three assertions are equivalent.
(1) The sequence {an} satisﬁes a linear recurrence relation with constant
coeﬃcients c1, . . . , ck, i.e.,
an =
k
X
i=1
cian−i,
for n ≥k.
(2) The sequence {an} has a rational ordinary generating function of the
form
g(x)
1 −Pk
i=1 cixi ,
where g is a polynomial of degree at most k −1.
(3) If
1 −
k
X
i=1
cixi = (1 −r1x)(1 −r2x) . . .(1 −rkx),
with the ri distinct, then
an = α1rn
1 + · · · + αkrn
k ,
for all n ≥0, and constants α1, . . . , αk.

7 Generating Functions and Making Change
41
More generally, if
1 −
k
X
i=1
cixi = (1 −r1x)m1(1 −r2x)m2 . . .(1 −rlx)ml,
where the roots r1, . . . , rl occur with multiplicities m1, . . . , ml, then
an = p1(n)rn
1 + · · · + pl(n)rn
l
for all n ≥0 and polynomials p1, . . . , pl, where deg pj < mj for 1 ≤j ≤l.
The proof proceeds along the lines of Example 7.1, although the case
of repeated roots of the characteristic polynomial requires partial fractions
decompositions.
Note. The factorization of 1 −Pk
i=1 cixi called for in the proof (and in
practice) can be accomplished using the change of variables y = 1/x. Then
1 −
k
X
i=1
cixi = 1 −
k
X
i=1
ciy−i = y−k
 
yk −
k
X
i=1
ciyk−i
!
.
The problem is reduced to factoring the polynomial
yk −
k
X
i=1
ciyk−i.
This polynomial is the characteristic polynomial of the recurrence relation.
Example 7.3. Find the generating function for the sequence deﬁned by
the recurrence relation an = 6an−1 −9an−2, for n ≥2, and a0 = 1, a1 = 1.
(This comes from Example 6.3.) Use the generating function to ﬁnd a direct
formula for an.
Solution: The form of the recurrence relation tells us that the denominator
of the generating function is 1−6x+9x2. To get the numerator, we calculate
(1 −6x + 9x2)(a0 + a1x) = (1 −6x + 9x2)(1 + x) = 1 −5x + · · ·. The only
terms of degree less than 2 are 1 −5x, so the numerator is 1 −5x. Hence,
the generating function is
1 −5x
1 −6x + 9x2 .
To ﬁnd a direct formula for an, we write the generating function as
(1 −5x)(1 −3x)−2.
Thus, we have a binomial series with a negative exponent. The expansion
is
(1 −5x)
∞
X
k=0
(−1)k3k
−2
k

xk.

42
Pearls of Discrete Mathematics
Therefore
an = (−1)n3n
−2
n

−5(−1)n−13n−1
 −2
n −1

= 3n
n + 1
n

−5 · 3n−1

n
n −1

= 3n(n + 1) −5n3n−1
= 3n −2n3n−1,
n ≥0.
This is the same solution that we saw before.
■
If f(x) is the ordinary generating function for a sequence {an}, then
an = f(n)(0)
n!
,
n ≥0.
Similarly, if f(x, y) is the ordinary generating function (in two variables)
for a sequence {am,n}, then
am,n = ∂m
x ∂n
y f(0, 0)
m!n!
,
m ≥0, n ≥0.
Example 7.4. How many ways can you make change for $1.00, using units
of 0.01, 0.05, 0.10, 0.25, 0.50, and 1.00? Here are some examples:
5 + 10 + 10 + 25 + 50
1 + 1 + 1 + 1 + 1 + 1 + 1 + 1 + 1 + 1 + 10 + 10 + 10 + 25 + 25
25 + 25 + 25 + 25.
(We write the summands in terms of cents, with no decimals.)
Solution: We solve the problem by generalizing. For n ≥0, let an be the
number of ways to make change for an amount n. For convenience, we set
a0 = 1. It’s easy to work out the ﬁrst few values of the sequence {an}, so
we see that its generating function looks like
1 + 1x + 1x2 + 1x3 + 1x4 + 2x5 + 2x6 + 2x7 + 2x8 + 2x9 + 4x10 + · · · .
We claim that this generating function is the rational function
1
(1 −x)(1 −x5)(1 −x10)(1 −x25)(1 −x50)(1 −x100).
Using a computer algebra system, one ﬁnds that the coeﬃcient of x100 of

7 Generating Functions and Making Change
43
this generating function is 293, i.e., there are 293 ways to make change for
a dollar. Essentially, the computation amounts to ﬁnding the coeﬃcient of
x100 in the generating function product
(1 + x + · · · + x100)
·(1 + x5 + · · · + x100)
·(1 + x10 + · · · + x100)
·(1 + x25 + · · · + x100)
·(1 + x50 + · · · + x100)
·(1 + x100).
In order to explain the generating function, observe that the factors
in the denominator give rise to geometric series. For example, the second
factor gives
1
(1 −x5) = 1 + x5 + x2·5 + x3·5 + x4·5 + x5·5 + x6·5 + · · · .
In the product, each term corresponds to a way to make change for a
dollar. For instance, the term corresponding to the sum 5+10+10+25+50
is shown in boldface:
(1 + x + x2 + x3 + x4 + x5 + x6 + · · · )
· (1 + x5 + x2·5 + x3·5 + x4·5 + x5·5 + x6·5 + · · · )
· (1 + x10 + x2·10 + x3·10 + x4·10 + x5·10 + x6·10 + · · · )
· (1 + x25 + x2·25 + x3·25 + x4·25 + x5·25 + x6·25 + · · ·)
· (1 + x50 + x2·50 + x3·50 + x4·50 + x5·50 + x6·50 + · · ·)
· (1 + x100 + x2·100 + x3·100 + x4·100 + x5·100 + x6·100 + · · · ).
By the way, since the denominator of the generating function is a poly-
nomial of order 191, the sequence {an} satisﬁes a linear recurrence relation
of order 191.
■
Example 7.5. How many ways can you make $1 million using any number
of pennies, nickels, dimes, quarters, half-dollars, one-dollar bills, ﬁve-dollar
bills, ten-dollar bills, twenty-dollar bills, ﬁfty-dollar bills, and hundred-
dollar bills?

44
Pearls of Discrete Mathematics
Solution: The generating function that counts the number of ways to make
change using the given denominations is
f(x) =
1
1 −x
1
1 −x5
1
1 −x10
1
1 −x25
1
1 −x50
1
1 −x100
·
1
1 −x500
1
1 −x1000
1
1 −x2000
1
1 −x5000
1
1 −x10000.
Our job is to ﬁnd a100,000,000, the coeﬃcient of x100,000,000 in this generating
function. The idea is to manipulate the generating function to make the
task easier.
Every exponent of x in the denominator is a multiple of 5 except for in
the ﬁrst factor. Hence, we rewrite the factor (1 −x)−1 as
(1 + x + x2 + x3 + x4)/(1 −x5),
and deﬁne
ˆf(x) =
1
1 −x
1
1 −x
1
1 −x2
1
1 −x5
1
1 −x10
1
1 −x20
·
1
1 −x100
1
1 −x200
1
1 −x400
1
1 −x1000
1
1 −x2000,
so that
f(x) = (1 + x + x2 + x3 + x4) ˆf(x5).
Since $1 million is a multiple of 5 (cents), the terms x, x2, x3, and x4 in
the ﬁrst factor don’t matter. In the denominator of ˆf(x), all the powers of
x divide the largest power, 2000. Accordingly, we rewrite each factor in the
denominator as (1 −x2000), with a compensating factor in the numerator.
The new numerator is
(1 + x + · · · + x1999)2(1 + x2 + x4 + · · · + x1998)
· (1 + x5 + · · · + x1995)(1 + x10 + · · · + x1990)(1 + x20 + · · · + x1980)
· (1 + x100 + · · · + x1900)(1 + x200 + · · · + x1800)
· (1 + x400 + · · · + x1600)(1 + x1000).
A computer algebra system can multiply out the new numerator in a mo-
ment. Now the denominator looks like (1 −x2000)11, which we expand as a
binomial series:
(1 −x2000)−11 =
∞
X
k=0
k + 10
10

x2000k.

7 Generating Functions and Making Change
45
We complete our calculation by multiplying the appropriate terms from
the numerator and this binomial series to obtain ˆa20,000,000, the coeﬃcient
of x20,000,000 in ˆf. The numerator is a polynomial of degree 18261, but
the only powers of x that matter are multiples of 2000; the corresponding
coeﬃcients are, say,
α0 = 1
α2000 = 1424039612928
α4000 = 212561825179035
α6000 = 3224717280609587
α8000 = 11601166434205649
α10000 = 12519790995056639
α12000 = 4102067385934937
α14000 = 334900882733305
α16000 = 3371148659578.
α18000 = 8008341.
Finally, we calculate
a100,000,000 = ˆa20,000,000 =
9
X
j=0
α2000j
10000 + 10 −j
10

= 88265881340710786348934950201250975072332541120001
.= 8.8 × 1049.
■
Exercises
1. Evaluate the inﬁnite sum P∞
n=1 nFn/3n.
2. Find the ordinary generating function for the Lucas numbers.
3. Find the ordinary generating function for the sequence {an} given by
the recurrence formula
a0 = 0, a1 = 1, an = 5an−1 −6an−2, n ≥2.

46
Pearls of Discrete Mathematics
4. Evaluate the inﬁnite series
∞
X
n=0
(−1)nan
10n
,
where {an} is the sequence of the previous exercise.
5. Find a recurrence formula for the coeﬃcient of xn in the series ex-
pansion of (1 + 3x + x2)−1.
6. Let an be the coeﬃcient in the previous exercise. Prove that an =
(−1)nF2n+2.
7. Find a recurrence formula for the coeﬃcient of xn in the series ex-
pansion of (1 + x + 2x2)−1.
8. Find the generating function for the sequence of perfect squares, {n2},
for n ≥0.
39. When Professor Bumble left a tip at a restaurant, he noticed that the
amount he left, n, can be given in n diﬀerent ways using the units 1,
5, 10, 25, 50, and 100. What is n?
310. Use a computer and an appropriate generating function to determine
the number of ways of making change for $1 using an even number of
coins.
11. Suppose that the units of money are 1, 5, 10, 25, 50, and 100. Show
that for every positive integer n, there are more ways to make n using
an even number of these coins than using an odd number if n is even,
and more ways to make n using an odd number of these coins than
using an even number if n is odd. Show that the same result holds
for any system of coins S with the property that 2k ∈S =⇒k ∈S.
12. Show that we can calculate the number of ways to make change for
a dollar in the following way. Let Pn be the number of ways to make
change for an amount n, given that the highest denomination used is a
penny. Similarly, deﬁne Nn, Dn, Qn, Hn, and Wn to be the number of
ways to make change for n given that the highest denomination used
is a nickel, dime, quarter, half-dollar, and whole dollar, respectively.

7 Generating Functions and Making Change
47
Explain why the following relations are true.
Pn = Pn−1
Nn = Pn−5 + Nn−5
Dn = Pn−10 + Nn−10 + Dn−10
Qn = Pn−25 + Nn−25 + Dn−25 + Qn−25
Hn = Pn−50 + Nn−50 + Dn−50 + Qn−50 + Hn−50
Wn = Pn−100 + Nn−100 + Dn−100 + Qn−100 + Hn−100 + Wn−100
Use these relations to ﬁnd the number of ways to make change for a
dollar.
13. (a) Show that the generating function (in two variables) for binomial
coeﬃcients is
1
1 −x −y .
(b) Show that the generating function (in three variables) for multi-
nomial coeﬃcients of the form  n
n1,n2,n3
 is
1
1 −x −y −z .
314. Use a generating function to determine the number of solutions in
nonnegative integers to the equation
a + 2b + 4c = 1030.
315. Determine the number of solutions in nonnegative integers to the
equation
a + 2b + 3c = 1030.
316. Determine the number of solutions in nonnegative integers to the
equation
a + b + 4c = 1030.
⋆17. Prove that, for each positive integer k, there exists a monic polynomial
p(n) of degree k + 1 with integer coeﬃcients such that
n
X
i=1
ik
n
i

= 2n−kp(n).

48
Pearls of Discrete Mathematics
18. Find a linear homogeneous recurrence relation (not with constant
coeﬃcients) for the sequence {an}, where an = 2n + n!.
⋆19. (Frobenius’ stamp problem) Let a and b be integers greater than 1
with no common factor. Given an unlimited supply of stamps in the
denominations a and b, show that the set of positive integer amounts
that cannot be made with these stamps is ﬁnite and ﬁnd the size of
the set. Find a formula for the largest value that cannot be made.
The problem is due to Ferdinand Georg Frobenius (1849–1917).
320. How many ways can you make $1 million using any number of pennies,
nickels, dimes, quarters, half-dollars, and one-dollar bills?
⋄⋆21. How many ways can you make $1 million using any number of pennies,
nickels, dimes, quarters, half-dollars, one-dollar bills, two-dollar bills,
ﬁve-dollar bills, ten-dollar bills, twenty-dollar bills, ﬁfty-dollar bills,
and hundred-dollar bills?

Chapter 8
Integer Triangles
The number of incongruent triangles with integer side lengths and perimeter
10100 is
208 3 . . .3
| {z }
196
.
How do we arrive at such a number?
Let’s ﬁrst solve some simpler
problems. How many incongruent triangles have integer side lengths and
perimeter 10? There are only two: (2, 4, 4) and (3, 3, 4). (We specify a
triangle by giving the ordered triple of its side lengths in nondecreasing
order. A triple (a, b, c) must satisfy the triangle inequality a + b > c.)
Let t(n) be the number of integer triangles of perimeter n. Let’s generate
some data. It is convenient to set t(0) = 0.
n
0
1
2
3
4
5
6
7
8
t(n)
0
0
0
1
0
1
1
2
1
The sequence {t(n)} is known as Alcuin’s sequence, after Alcuin of York
(735–804).
If we generate more data and plot the values of t(n), we are led to the
conjecture that the function is nearly a quadratic polynomial of the form
n2/48. We can also guess this from a rough estimate. For three side lengths
to satisfy the triangle inequality, it is necessary and suﬃcient that the sum
of any two of them is less than n/2. So, there are about n/2 choices for,
say, x, and given x, the value of x + y must be between n/2 and n/2 + x.
This deﬁnes z as z = n −x −y. Hence, the number of choices of x, y, and
z is about
n/2
X
x=1
x ∼(n/2)(n/2 + 1)
2
∼n2
8 .
Most of the time, x, y, and z will be diﬀerent, so the ordered triples (a, b, c)
have been over-counted by a factor of 3! = 6. Therefore t(n) is approxi-
49

50
Pearls of Discrete Mathematics
mately n2/48. A little tinkering yields the formula
t(n) =



n
n2
48
o
if n is even,
n
(n+3)2
48
o
if n is odd,
where {x} is the nearest integer to x.
We need to prove the formula, but if it’s true then it’s a simple matter
to compute the number of incongruent triangles with integer sides and
perimeter 10100. We have t(10100) = 208 3 . . .3
| {z }
196
(by direct calculation), as
claimed in the teaser at the beginning of this chapter.
Note. We should show that our formula for t(n) is well-deﬁned, that is,
{x2/48} cannot be half-way between two integers.
If x2/48 = i + 1/2,
where x and i are integers, then x2 = 48i + 24. Since 8 divides the right
side of this relation, 8 must divide the left side. The left side is a perfect
square, so it is divisible by 16, but the right side is not divisible by 16 (the
ﬁrst term is and the second term isn’t). This is a contradiction.
Let’s prove our formula. We claim that the generating function
t(0) + t(1)x + t(2)x2 + t(3)x3 + · · ·
is the rational function
x3
(1 −x2)(1 −x3)(1 −x4).
The idea is that we can “build up” to any given triangle (a, b, c) starting
with the triangle (1, 1, 1). The key observation is that we can write
(a, b, c) = (1, 1, 1) + α(0, 1, 1) + β(1, 1, 1) + γ(1, 1, 2),
where α, β, and γ are determined uniquely (just solve for them, given
a + b + c = n). The vectors (0, 1, 1), (1, 1, 1), and (1, 1, 2) satisfy the weak
triangle inequality a + b ≥c, and this is suﬃcient since we start with a
non-degenerate triangle. As 2α+3β +4γ = a+b+c−3 = n−3, this shows
that t(n) is equal to the number of partitions of n −3 where the parts are
2s, 3s, and 4s (order of terms unimportant). That is precisely what the
generating function generates.
We can determine the approximate value t(n) ∼n2/48 from the gener-
ating function by noting that the zeros of the denominator polynomial are
all on the unit circle in the complex plane, with the zero of largest order
being z = 1 (of order 3). By the binomial series expansion,
t(n) ∼C
2!n2,

8 Integer Triangles
51
where
C = lim
z→1

(1 −z)3
z3
(1 −z2)(1 −z3)(1 −z4)

= 1
24.
The denominator of the rational generating function yields a recurrence
formula for the sequence {t(n)} (expand the polynomial and look at its
form), namely,
t(n) = t(n−2)+t(n−3)+t(n−4)−t(n−5)−t(n−6)−t(n−7)+t(n−9),
n ≥9.
The initial values of the sequence are given in our table above.
Finally, we can use the recurrence relation to prove our formula for t(n)
by induction. For the moment, let’s call the proposed formula ˆt(n). We
want to show that ˆt(n) = t(n), for n ≥0. By direct calculation, we see that
ˆt(n + 24) = ˆt(n) + n + 12,
if n is even
ˆt(n + 24) = ˆt(n) + n + 15,
if n is odd.
It’s easy to use our known recurrence relation to calculate t(n) for 0 ≤n ≤
32 and ﬁnd that ˆt(n) = t(n) for these values.
For the induction hypothesis, assume that ˆt(n) = t(n) for a “block” of
24 consecutive integers. Then, rewriting our recurrence relation, we have
ˆt(n)+ˆt(n−5)+ˆt(n−6)+ˆt(n−7) = ˆt(n−2)+ˆt(n−3)+ˆt(n−4)+ˆt(n−9)
for n in this block. Notice that whether n is even or odd, there are two even
values of the argument and two odd values of the argument on the left side
and the same on the right side. Thus, adding two terms of n + 12 and two
terms of n + 15 on each side and −5 −6 −7 on the left and −2 −3 −4 −9
on the right, we obtain
ˆt(n + 24) + ˆt(n + 24 −5) + ˆt(n + 24 −6) + ˆt(n + 24 −7)
= ˆt(n + 24 −2) + ˆt(n + 24 −3) + ˆt(n + 24 −4) + ˆt(n + 24 −9).
Hence, ˆt(n) = t(n) for the next block of 24 consecutive integers. By induc-
tion, ˆt(n) = t(n) for all n ≥0.
While not as famous as the Fibonacci sequence, Alcuin’s sequence has
some marvelous properties (as we will see in the exercises), and might repay
further study.

52
Pearls of Discrete Mathematics
Exercises
1. Find the number of incongruent triangles with integer sides and perime-
ter 1000.
32. Derive the formula for t(n) using the generating function and partial
fractions.
3. Find some pairs of (non-similar) integer triangles that have a common
angle.
34. Find the smallest integer triangle for which the measure of one angle
is twice that of another angle.
5. Find inﬁnitely many (non-similar) integer triangles with one angle
equal to 60◦.
36. Let R and r represent the circumradius and inradius of a triangle,
respectively. Find an integer triangle for which R/r = 26. Investigate
which ratios R/r are possible for integer triangles.
7. Find a formula for the number of scalene integer triangles of perimeter
n. What is the generating function for the number of such triangles?
8. Prove that Alcuin’s sequence {t(n)} is a zigzag sequence (its values
alternately rise and fall), for n ≥6.
9. Professor Bumble announces that there is exactly one integer n for
which there are exactly n integer triangles with perimeter n. What
is n?
10. Prove that Alcuin’s sequence {t(n)} satisﬁes the recurrence relation
t(n) = 3t(n −12) −3t(n −24) + t(n −36),
n ≥36.
⋆11. Consider Alcuin’s sequence modulo 2. We obtain a repeating cycle of
length 24:
0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0.
We say that the period mod 2 is 24. Prove that, given any modulus
m ≥2, the period of Alcuin’s sequence mod m is 12m.
12. Find inﬁnitely many (non-similar) pairs of integer triangles such that
the two triangles in each pair have the same perimeter and the same
area.

Chapter 9
Rook Paths and Queen Paths
A chess Rook may travel in 470,010 ways from one corner square of a
chessboard to the opposite corner square. A Queen may make the same trip
in 1,499,858 ways.
A chess Rook may move any number of squares horizontally or vertically
in one step. How many paths can a chess Rook take from the lower-left
corner square to the upper-right corner square of an ordinary 8 × 8 chess-
board? Assume that the Rook moves right or up at each step. An example
of such a Rook path is shown in Figure 9.1.
Notice that the pausing points are important. Without them, the num-
ber of paths is easily counted by the binomial coeﬃcient
 14
7

. This is the
famous problem of counting paths along city blocks from one intersection
to another (as on p. 13).
It’s often helpful to generalize a problem.
Rook paths to any given
square are equivalent to lattice paths that start at (0, 0) and move by steps
of the form (x, 0) or (0, y), where x and y are positive integers, toward a
goal point (m, n), where m, n ≥0. Let’s call the number of paths a(m, n),
where m, n ≥0. Starting with the value a(0, 0) = 1, we calculate each
other number in turn by adding all the entries to the left of that number
and below that number. For example, a(3, 2) = 2 + 5 + 14 + 4 + 12 = 37.
The reason for this rule is that the Rook must arrive at that particular
square from one of the squares to its left or below it. Thus, the number
of Rook paths from the lower-left corner to the upper-right corner of the
chessboard is a(7, 7) = 470010.
...
...
...
...
...
...
...
...
64
320
1328
4864
16428
52356
159645
470010
. . .
32
144
560
1944
6266
19149
56190
159645
. . .
16
64
232
760
2329
6802
19149
52356
. . .
8
28
94
289
838
2329
6266
16428
. . .
4
12
37
106
289
760
1944
4864
. . .
2
5
14
37
94
232
560
1328
. . .
1
2
5
12
28
64
144
320
. . .
1
1
2
4
8
16
32
64
. . .
53

54
Pearls of Discrete Mathematics
FIGURE 9.1: A Rook path.
It’s elementary to obtain by inclusion–exclusion a recurrence formula
for a(m, n) that requires only a ﬁxed number of previous terms, namely,
a(0, 0) = 1, a(0, 1) = 1, a(1, 0) = 1, a(1, 1) = 2;
a(m, n) = 2a(m, n −1) + 2a(m −1, n) −3a(m −1, n −1), m ≥2 or n ≥2.
We are assuming that a(m, n) = 0 for m or n negative.
We indicate this recurrence relation with an array of coeﬃcients.
−2
1
3
−2
The recurrence formula yields a rational generating function for the
doubly-inﬁnite sequence {a(m, n)}, namely,
X
m≥0, n≥0
a(m, n)smtn =
1 −s −t + st
1 −2s −2t + 3st.
The form of the denominator of this function comes from the recurrence
relation. The numerator is obtained by multiplying the denominator by the
polynomial that represents the initial values, 1 + s + t + 2st, and keeping
only those monomials with exponents of s and t both less than 2.
We can pose the same kind of problem for a Rook moving in a 3-
dimensional space. In how many ways can a Rook move from (0, 0, 0) to
(n, n, n), where each step is a positive integer multiple of (1, 0, 0), (0, 0, 1),
or (0, 0, 1)?

9 Rook Paths and Queen Paths
55
3
3
−2
3
−2
−2
1
−4
FIGURE 9.2: Coeﬃcients of a recurrence relation for 3-D Rook paths.
The coeﬃcients for a recurrence relation are indicated in Figure 9.2.
In any dimension, a Rook path is at each step a positive integer multiple
of a vector that consists of a single 1 and the other coordinates 0. The
recurrence relation for a d-dimensional Rook depends on decrementing each
variable by 0 or 1, and each coeﬃcient is equal to (n + 1)(−1)n, where n is
the number of variables decremented.
For 3-dimensional Rook paths, the generating function is
(1 −s)(1 −t)(1 −u)
1 −2(s + t + u) + 3(st + su + tu) −4stu.
We notice a pattern in both the numerator and the denominator. The
numerator is the product of terms of the form (1−x), where x is an indeter-
minate. The denominator is an alternating sum of elementary symmetric
polynomials in three indeterminates. Let’s describe the general situation.
We are interested in counting lattice paths in d dimensions from the origin
to a given point p = (p1, . . ., pd), such that each step is a positive integer
multiple of a basic step of the form ui = (ui1, . . ., uid), where 1 ≤i ≤k. As
a convenient notation, let xα = xα1
1 . . .xαd
d , where α = (α1, . . ., αd). For
0 ≤j ≤n, the jth elementary symmetric polynomial in the indeterminates
x1, . . . , xn is the sum of all products of j of the xi.
Theorem 9.1. For d ≥1 and 1 ≤i ≤k, let ui = (ui1, . . ., uid) be a nonzero
d-tuple of nonnegative integers. Let σj be the jth elementary symmetric
polynomial in the indeterminates xui. Then the number of lattice paths in
d dimensions that start at (0, . . ., 0), stop at p = (p1, . . ., pd), where the pi
are nonnegative integers, and each step is a positive integer multiple of one
of the ui, is the coeﬃcient of xp in the rational generating function
Qk
i=1(1 −xui)
Pk
j=0(−1)j(j + 1)σj
.

56
Pearls of Discrete Mathematics
Proof. In the case of d-dimensional Rook paths, the recurrence relation
which says that each value of the sequence is determined by adding its
predecessors in each coordinate implies that
X
(n1,...,nd)
a(n1, . . ., nd)xn1
1 . . .xnd
d
 
1 −
d
X
i=1
∞
X
h=1
xh
i
!
= a(0, . . ., 0) = 1.
Hence, using geometric series, we obtain
X
(n1,...,nd)
a(n1, . . ., nd)xn1
1 . . .xnd
d
=
1
1 −Pd
i=1(xi/(1 −xi))
=
Qd
i=1(1 −xi)
Qd
i=1(1 −xi) −Pd
j=1 xj
Q
i̸=j(1 −xi)
.
The numerator is of the correct form. The summands in the denominator
are products of distinct xi. Let’s ﬁnd the coeﬃcient of the product of some
speciﬁc j of the xi. The term Qd
i=1(1 −xi) yields a coeﬃcient of (−1)j
and the term −Pd
j=1 xj
Q
i̸=j(1 −xi) contributes a coeﬃcient of j(−1)j.
Hence, the sum of the coeﬃcients is (j + 1)(−1)j, as required.
The general result follows upon letting xi = xui, for 1 ≤i ≤k. The fact
that d is no longer necessarily the dimension of the space is immaterial.
■
Let’s apply this theorem to the problem of counting Queen paths. A
chess Queen can move any number of squares horizontally, vertically, or
diagonally in one step.
In how many ways can a Queen move from the
lower-left corner to the upper-right corner of an 8×8 chessboard, assuming
that the Queen moves up, right, or diagonally up-right at each step? Such
a Queen path is shown in Figure 9.3.
As with Rook paths, we can ﬁll out a table of the number of Queen
paths to each square. Let b(m, n) be the number of paths from (0, 0) to
(m, n), such that at each step the path goes up, right, or up-right. Notice
that we calculate each entry by adding all the entries to the left of, below,
and diagonally left-below that entry. For example, b(3, 3) = 4 + 17 + 60 +
4+17+60+1+3+22 = 188. The reason for this rule is that the Queen has
to arrive from one of the aforementioned squares. We see that the number
of paths to the upper-right corner is b(7, 7) = 1499858.

9 Rook Paths and Queen Paths
57
FIGURE 9.3: A Queen path.
...
...
...
...
...
...
...
...
64
464
2392
10305
39625
140658
470233
1499858
. . .
32
208
990
3985
14430
48519
154352
470233
. . .
16
92
401
1498
5079
16098
48519
140658
. . .
8
40
158
543
1712
5079
14430
39625
. . .
4
17
60
188
543
1498
3985
10305
. . .
2
7
22
60
158
401
990
2392
. . .
1
3
7
17
40
92
208
464
. . .
1
1
2
4
8
16
32
64
. . .
By Theorem 9.1, the generating function for the doubly-inﬁnite sequence
for Queen paths (with generators s, t, and st) is
(1 −s)(1 −t)(1 −st)
1 −2(s + t + st) + 3(s · t + s · st + t · st) −4(s · t · st).
From the denominator, we obtain a recurrence formula:
b(0, 0) = 1, b(0, 1) = 1, b(0, 2) = 2,
b(1, 0) = 1, b(1, 1) = 3, b(1, 2) = 7,
b(2, 0) = 2, b(2, 1) = 7, b(2, 2) = 22;
b(m, n) = 2b(m −1, n) + 2b(m, n −1) −b(m −1, n −1) −3b(m −2, n −1)
−3b(m −1, n −2) + 4b(m −2, n −2),
m ≥2 or n ≥2.

58
Pearls of Discrete Mathematics
We are assuming that b(m, n) = 0 for m or n negative.
Here is the array of coeﬃcients.
0
−2
1
3
1
−2
−4
3
0
An inclusion–exclusion proof for the recurrence relation is possible but
tricky. The generating function approach is much easier.
Let an = a(n, n), the nth diagonal element of the sequence for 2-D Rook
paths. Then the sequence {an} is A051708 in the Encyclopedia of Integer
Sequences (EIS):
1, 2, 14, 106, 838, 6802, 56190, 470010, . . ..
(In the database, the ﬁrst term is a(1), whereas ours is a0.)
In 2003 Curtis Coker found the generating function and recurrence re-
lation for the diagonal sequence for 2-D Rook paths. We will derive these
here. We’ll show that the generating function for the sequence is
f(x) = 1
2
 
1 +
(1 −x)
p
(1 −x)(1 −9x)
!
.
In order to accomplish this, we make the change of variables t = x/s (so
that st = x). Now we allow arbitrary integer exponents of s, while the
exponents of x are nonnegative integers. Thus, for example, we represent
s3t5 as s−2x5. The generating function becomes
1
2

1 +
(1 −x)s
−2s2 + (3x + 1)s −2x

.
We focus on the function
s
−2s2 + (3x + 1)s −2x =
s
−2(s −α)(s −β),
where
α = 3x + 1 −
p
(1 −x)(1 −9x)
4
, β = 3x + 1 +
p
(1 −x)(1 −9x)
4
.
The diagonal generating function is the coeﬃcient of s0.
The partial fractions expansion of our formula is
1
2(β −α)

α
s −α −
β
s −β

=
1
2(β −α)

α/s
1 −(α/s) +
1
1 −(s/β)

.

9 Rook Paths and Queen Paths
59
Expanding the function in a Laurent series in the annulus |α| < |s| < |β|
in powers of (α/s) and (s/β), where −1/9 < x < 1/9, yields
1
2(β −α)
" ∞
X
n=1
α
s
n
+
∞
X
n=0
 s
β
n#
.
The coeﬃcient of s0 is
1
2(β −α) =
1
p
(1 −x)(1 −9x)
.
This establishes the formula for the generating function f(x).
In ﬁnding a recurrence relation for the numbers an, it’s easier to work
with the function
g(x) = 2f(x) −1 =
√1 −x
√1 −9x,
rather than the generating function f. Note that f and g yield sequences
satisfying the same recurrence relation but with diﬀerent initial values. By
logarithmic diﬀerentiation, we obtain
log g(x) = 1
2 log(1 −x) −1
2 log(1 −9x),
and hence
g′(x)
g(x) =
−1
2
1 −x +
9
2
1 −9x,
or
g′(x)(1 −x)(1 −9x) = 4g(x).
Sequences such as ours, whose generating functions consist of polynomials
and a ﬁnite number of derivatives, are called D-ﬁnite.
We can read oﬀthe recurrence formula for the an directly:
a0 = 1; a1 = 2;
an = ((10n −6)an−1 −(9n −18)an−2)/n,
n ≥2.
We do not know a counting proof of this formula.
Rook paths have a tie-in with a game called Nim. Nim is played with a
number of piles of stones. Players alternately remove any number of stones
from a single pile. The game ends when some player takes the last stone(s).
Rook paths in d dimensions that go from (0, 0, . . ., 0) to (a1, a2, . . ., ad) are
equivalent to Nim games that start with d piles of stones of sizes a1, a2, . . . ,
ad. Therefore, by our analysis, the number of Nim games that start with

60
Pearls of Discrete Mathematics
two equal piles of n stones satisﬁes a linear recurrence relation of order 2,
with polynomial coeﬃcients of degree 1.
In 2009 Khang Tran, Suren Fernando, and the author found that the
number of d-dimensional Rook paths from (0, . . ., 0) to (n, . . ., n) is asymp-
totic to
(d + 1)dn−1d(d+2)/2(2πn(d + 2))(1−d)/2.
This is also the asymptotic number of Nim games that start with d piles of
n stones each.
We now return to Queen paths.
The diagonal sequence for the 2-D
Queen, {bn = b(n, n)}, is the EIS sequence A132595:
1, 3, 22, 188, 1712, 16098, 154352, 1499858, 14717692, 145509218, . . ..
Let x = st. Then the generating function becomes
(x −1)(s2 −(−x −1)s + x)
(3x −2)s2 + (−4x2 + x + 1)s + (3x2 −2x).
We focus on the function
s2 + (−x −1)s + x
(3x −2)s2 + (−4x2 + x + 1)s + (3x2 −2x)
=
1
3x −2 + (x −1)2
(3x −2)2 ·

1
α −β

α
s −α −
β
s −β

,
where
α, β = 1
2
4x2 −x −1
3x −2
∓
√
∆

∆= (x −1)2(1 −12x + 16x2)
(3x −2)2
.
We rewrite this function as
1
3x −2 + (x −1)2
(3x −2)2

1
α −β

α/s
1 −(α/s) +
1
1 −(s/β)

.
Expanding in |α| < |s| < |β|, we obtain
1
3x −2 + (x −1)2
(3x −2)2
"
1
α −β
" ∞
X
n=1
(α/s)n +
∞
X
n=0
(s/β)n
##
.

9 Rook Paths and Queen Paths
61
Therefore
f(x) = (x −1)

1
3x −2 + (x −1)2
(3x −2)2 · −1
√
∆

= (x −1)
(3x −2)

1 +
1 −x
√
1 −12x + 16x2

.
Solving for 1/
√
1 −12x + 16x2 and taking a derivative yields
f(x)(46x2−47x+11)+f′(x)(48x4−116x3+95x2−29x+2) = 10x2−15x+5,
and we can read oﬀthe recurrence formula:
b0 = 1; b1 = 3; b2 = 22; b3 = 188;
bn = ((29n −18)bn−1 + (−95n + 143)bn−2
+ (116n −302)bn−3 + (−48n + 192)bn−4)/(2n),
n ≥4.
In any dimension, a Queen path is at each step a positive integer multiple
of a vector consisting of only 0s and 1s (and not all 0s).
Wythoﬀ’s Nim, named after Willem Abraham Wythoﬀ(1865–1939), is
a game that starts with a number of piles of stones. Players alternately
remove the same number of stones from any number of piles. The game
ends when a player takes the last stone(s). Queen paths in d dimensions
that go from (0, 0, . . ., 0) to (a1, a2, . . ., ad) are equivalent to Wythoﬀ’s Nim
games that start with d piles of stones of sizes a1, a2, . . . , ad. Therefore, the
number of Wythoﬀ’s Nim games that start with two equal piles of n stones
satisﬁes a linear recurrence relation of order 4, with polynomial coeﬃcients
of degree 1.
Exercises
1. A lone King is on a chessboard. How many ways may the King travel
from the lower-left corner of the board to the upper-right corner,
moving one square right, up, or diagonally up-right at every step?
2. Show that the number of Rook paths from (0, 0) to (n, 0) is 2n−1. For
what well-known counting problem is this the formula?
33. How many 3-D Rook paths are there from (0, 0, 0) to (7, 7, 7)?

62
Pearls of Discrete Mathematics
34. Write the generating function and recurrence relation coeﬃcients for
a depth four linear recurrence relation for the 3-D Queen. How many
Queen paths are there from (0, 0, 0) to (7, 7, 7)?
5. Suppose that a piece moves in the plane like a Queen but only diago-
nally and horizontally (not vertically). Write the generating function
and recurrence relation for the number of paths that this piece can
take going from (0, 0) to (m, n), always moving right or up-right at
each step.
36. You have two stamp rolls, one with 1-cent stamps and the other with
2-cent stamps. Let a(n) be the number of ways to make postage of
n cents by taking strips of stamps from the two rolls. The order of
the strips and the number of stamps per strip matter. For example,
a(4) = 15 since
4 = (1) + (1) + (1) + (1) = (1 + 1) + (1) + (1)
= (1) + (1 + 1) + (1) = (1) + (1) + (1 + 1)
= (1 + 1) + (1 + 1) = (1 + 1 + 1) + (1)
= (1) + (1 + 1 + 1) = (1 + 1 + 1 + 1)
= (2) + (1) + (1) = (1) + (2) + (1) = (1) + (1) + (2)
= (2) + (1 + 1) = (1 + 1) + (2) = (2) + (2) = (2 + 2).
Find a(100), the number of ways to make postage of $1. Give an
approximation of a(105), the number of ways to make postage of
$1000.
7. Professor Bumble announces that there is only one number n for
which a(n) is a prime number. (See the previous problem.) What is
n and can you prove that it is the only such number?
⋆8. Find a direct formula (not a recurrence relation) for a(m, n), the
number of Rook paths from (0, 0) to (m, n).
⋆9. Suppose that a ChildRook moves like a chess Rook but only at most
two squares horizontally or vertically at each step. Let a(m, n) be
the number of ways that a ChildRook can move from (0, 0) to (m, n).
Assume that the ChildRook always moves right or up at each step.
(a) Find a ﬁnite-order recurrence relation for {a(m, n)}.
(b) Find a rational generating function for {a(m, n)}.
(c) Find a recurrence formula for the diagonal sequence {a(n, n)}.

9 Rook Paths and Queen Paths
63
⋆10. Suppose that a RookPlus moves like a chess Rook with the additional
option of moving one square diagonally at each step. Let b(m, n) be
the number of ways that a RookPlus can move from (0, 0) to (m, n).
Assume that the RookPlus always moves right, up, or up-right at
each step.
(a) Find a ﬁnite-order recurrence relation for {b(m, n)}.
(b) Find a rational generating function for {b(m, n)}.
(c) Find a recurrence formula for the diagonal sequence {b(n, n)}.
⋆11. Suppose that a HalfRook moves like a chess Rook, any number of
squares horizontally, but only one square up at each step. Let c(m, n)
be the number of ways that a HalfRook can move from (0, 0) to (m, n).
Assume that the HalfRook always moves right or up at each step.
(a) Find a ﬁnite-order recurrence relation for {c(m, n)}.
(b) Find a rational generating function for {c(m, n)}.
(c) Find a recurrence formula for the diagonal sequence {c(n, n)}.
⋆12. Suppose that a BishopPlus moves like a chess Bishop, any number
of squares diagonally, or one square horizontally or vertically at each
step. Let d(m, n) be the number of ways that a BishopPlus can move
from (0, 0) to (m, n). Assume that the BishopPlus always moves right,
up, or up-right at each step.
(a) Find a ﬁnite-order recurrence relation for {d(m, n)}.
(b) Find a rational generating function for {d(m, n)}.
(c) Find a recurrence formula for the diagonal sequence {d(n, n)}.
13. Construct a generating function for the number of 2-D Rook paths
that also keeps track of the number of steps. Let a(m, n; k) be the
number of Rook paths from (0, 0) to (m, n) that take k steps. Find a
recurrence relation for a(m, n; k).
14. Generate a table for the number of paths of a generalized Knight
from (0, 0) to a point (m, n). The generalized Knight may move in
any positive multiple of the basic steps (1, 2) or (2, 1). What pattern
do you ﬁnd? What is the explanation?
315. How many Nim games can be played starting with three piles of stones
of sizes 10, 10, and 20? How many games of Wythoﬀ’s Nim?

64
Pearls of Discrete Mathematics
316. Let an be the number of 3-D Rook paths from (0, 0, 0) to (n, n, n),
i.e., lattice paths in which each step is a positive integer multiple of
(1, 0, 0), (0, 1, 0), or (0, 0, 1). Find a linear recurrence formula with
polynomial coeﬃcients for {an}.

Part IV
Discrete Probability
65


Chapter 10
Probability Spaces and Distributions
In a game of bridge, all 52 playing cards are dealt randomly to four players,
13 cards per player. The probability that at least one player has all cards of
the same suit (a perfect hand) is
18772910672458601/745065802298455456100520000 .= 2.5 × 10−11.
Suppose that an urn contains n white balls and n black balls. A ball is se-
lected at random from the urn and removed. This process is repeated until
the urn contains only balls of one color. If n is large, then the expected
number of balls remaining in the urn is approximately 2.
A sample space is a set of (simple) events or outcomes of an experiment.
Example 10.1. Consider one ﬂip of a fair coin. What is the sample space?
Solution: The possible outcomes are heads and tails. Thus, we can repre-
sent the sample space as {H, T}.
■
A probability space is a sample space with a probability Pr(E) assigned
to each event E. The probability of each simple event is nonnegative and
the sum of the probabilities is 1.
Example 10.2. In our coin example, what is the probability space?
Solution: The events H and T each occur with probability 1/2, so we write
Pr(H) = 1
2
and
Pr(T) = 1
2.
We can also consider combinations of the simple events. For instance, one
of H and T must occur, so
Pr({H, T}) = 1.
The complementary probability is 0, that is,
Pr(∅) = 0.
■
67

68
Pearls of Discrete Mathematics
Example 10.3. A single card is dealt from a deck of 52 cards. What is
the probability space?
Solution: The sample space consists of all 52 cards, each with probability
1/52 of being chosen.
■
In discrete mathematics, we are mainly concerned with sample spaces
with only a ﬁnite number of elements.
However, sometimes the sample
space may be inﬁnite if its elements are discrete, i.e., they are countable.
The following is an example of a sample space with a countably inﬁnite
number of elements.
Example 10.4. A fair coin is ﬂipped until heads occurs.
What is the
probability space?
Solution: The sample space consists of all strings of T’s (including the
empty string) followed by a single H. Thus, the sample space is the count-
ably inﬁnite set
{H, TH, TTH, TTTH, TTTTH, TTTTTH, TTTTTTH, . . .}.
For n ≥0, the probability of a string of n tails occurring followed by heads
is (1/2)n(1/2) = (1/2)n+1. Hence, the sum of all the probabilities is
∞
X
n=0
1
2
n+1
= 1.
■
A random variable deﬁned on a probability space is a function from the
set of possible events to the set of real numbers.
For instance, suppose that a fair coin is tossed and we record 10 points
if the coin lands heads and −3 points if it lands tails. Then the random
variable X given by this situation is
X =
 10
with probability 1/2
−3
with probability 1/2.
Let X be a random variable that takes values xi with probabilities pi,
for 1 ≤i ≤n. The mean, or expected value, of X is
µ(X) = E(X) =
n
X
i=1
pixi.
The variance of X is
V (X) = E((X −E(X))2) = E(X2) −E(X)2 =
n
X
i=1
pix2
i −µ2.

10 Probability Spaces and Distributions
69
The standard deviation of X is
σ(X) =
p
V (X).
A Bernoulli random variable, named after Jacob Bernoulli (1654–1705),
is a random variable X such that
X =
 1
with probability p
0
with probability q,
where 0 ≤p ≤1 and p + q = 1. We say that 1 represents “success” and 0
represents “failure.” We denote by B(p) the Bernoulli variable with success
probability p.
It is easy to determine the expected value (i.e., the mean) and variance
of a Bernoulli variable:
E(X) = 0 · q + 1 · p = p,
and
V (X) = (q · 02 + p · 12) −p2 = pq.
We say that two variables X and Y are independent if knowledge of the
value of one of them yields no information about the distribution of the
other.
Proposition 10.5. If X1, X2, . . . , Xn are random variables with sum X,
then
E(X) = E(X1) + E(X2) + · · · + E(Xn).
If the Xi are independent, then
V (X) = V (X1) + V (X2) + · · · + V (Xn).
Suppose that X1, . . . , Xn are independent Bernoulli random variables
with success probability p. Let X = X1 + · · · + Xn. We call X a binomial
random variable, and denote it by B(n, p).
We have
E(X) = E(X1) + · · · + E(Xn)
= p + · · · + p
= np
and
V (X) = V (X1) + · · · + V (Xn)
= pq + · · · + pq
= npq.

70
Pearls of Discrete Mathematics
The possible values of X are 0, 1, . . . , n. We have X = k only when
k of the Xi are equal to 1 (and the others are equal to 0), and this can
happen in
 n
k

ways. Therefore
Pr(X = k) =
n
k

pkqn−k,
0 ≤k ≤n.
In Example 3.7, we gave three proofs of the identity
n
X
k=1
k
n
k

= n2n−1.
Let’s also give a proof using probability. Upon division by 2n, our identity
becomes
n
X
k=1
k
n
k
 1
2
n
= n
2 .
Here is a probabilistic interpretation. Let S be a set of n elements. For
each element of S, ﬂip a fair coin and if the coin comes up heads put the
element in a subset T. What is the expected size of T? Both sides of the
identity give the answer.
The inclusion–exclusion principle is a generalization of the Venn dia-
gram rule.
Proposition 10.6 (Venn Diagram Rule). If A and B are ﬁnite sets, then
|A ∪B| = |A| + |B| −|A ∩B|.
Proof. Figure 10.1 shows two sets, A and B, and their union and intersec-
tion. The sum |A| + |B| counts all the elements of A ∪B, but the elements
of A ∩B are counted twice and therefore must be removed as on the right
side of the relation.
■
&%
'$
&%
'$
A ∪B
A ∩B
A
B
FIGURE 10.1: Venn diagram for two sets.

10 Probability Spaces and Distributions
71
Theorem 10.7 (Inclusion–Exclusion Principle). If A1, . . . , An are ﬁnite
sets, then
|A1 ∪· · · ∪An| =
n
X
i=1
(−1)i+1
X
1≤k1<···<ki≤n
|Ak1 ∩· · · ∩Aki|.
Proof. Let S be a ﬁnite set containing all the Ai. For s ∈S, suppose that
s is contained in exactly m of the Ai. If m = 0, then the contribution of s
to the right side of our relation is 0. If m ≥1, then the contribution is
n
X
j=1
(−1)j+1
m
j

=
m
X
j=1
(−1)j+1
m
j

(because m ≤n)
=
1
(by Proposition 3.1).
Hence, each s ∈S not in the union of the Ai contributes 0 to both sides of
the relation, while each s ∈S in the union contributes 1. Therefore, each
element of S contributes an equal amount to both sides of the relation.
This conﬁrms the formula.
■
Example 10.8. A derangement of a set is a permutation of the set with
no ﬁxed points. Let dn be the number of derangements of n elements. Find
a formula for dn.
Solution: For 1 ≤j ≤n, let Aj be the set of permutations of {1, 2, 3, . . ., n}
such that j is a ﬁxed point. Then the intersection of any i of the Aj, for
1 ≤i ≤n, has (n −i)! elements, because the n −i not necessarily ﬁxed
elements may be permuted arbitrarily. Since  n
i
 of the Aj make up the
intersection, by the principle of inclusion and exclusion, we have
|A1 ∪· · · ∪An|
=
n
X
j=1
(−1)j+1
n
j

(n −j)!.
A permutation is a derangement if it is not a member of one of the Aj, so
we conclude that
dn =
n
X
j=0
(−1)j n!
j! .
■
Theorem 10.9 (Inclusion–Exclusion Principle, Probability Version). Let
E1, . . . , En be events in a ﬁnite probability space. Then
Pr(E1 ∪· · · ∪En)
=
n
X
i=1
(−1)i+1
X
1≤k1<···<ki≤n
Pr(Ek1 ∩· · · ∩Eki).

72
Pearls of Discrete Mathematics
Example 10.10. A deck of 52 playing cards is dealt randomly to four
players, 13 cards per player.
What is the probability that at least one
player has all cards of the same suit?
Solution: For 1 ≤i ≤4, let Ei be the event that player i has all cards of
the same suit. Using the principle of inclusion and exclusion, we ﬁnd that
the desired probability, Pr(S Ei), is
4
1
 4
 52
13
 −
4
2
  4
2
2!
 52
13
 39
13
 +
4
3

 4
3
3!
 52
13
 39
13
 26
13
 −
4
4

 4
4
4!
 52
13
 39
13
 26
13
 13
13

= 18772910672458601/745065802298455456100520000
.= 2.5 × 10−11.
To understand the above calculation, consider for example the second term,
4
2

 4
2

2!
 52
13
 39
13
.
This is the probability that at least two players have all cards of the same
suit. The leading expression  4
2
 counts the choices of the two lucky players.
The term  4
2
 in the numerator counts the choices of the two solid suits. This
expression is multiplied by 2! to account for the ways that the two lucky
players can have the two chosen suits. The denominator is the number of
ways of dealing 13 cards each to the two lucky players.
■
Example 10.11. What is the probability Pn that a random permutation
of n elements is a derangement?
Solution: We found in Example 10.8 that
dn =
n
X
j=0
(−1)j n!
j! .
Therefore
Pn =
n
X
j=0
(−1)j
j!
.
Thus, {Pn} is a zigzag sequence (consecutive values rise and fall) and
lim
n→∞Pn = e−1 .= 0.37.
■

10 Probability Spaces and Distributions
73
Example 10.12. Show that the expected number of ﬁxed points of a per-
mutation of n elements is 1.
Solution: We illustrate the result in the case n = 3. Below are the permu-
tations of {1, 2, 3} and the number of ﬁxed points of each.
permutation
number of ﬁxed points
(1)(2)(3)
3
(1)(2 3)
1
(2)(1 3)
1
(3)(1 2)
1
(1 2 3)
0
(1 3 2)
0
The permutations are written in cycle form. For instance, the permutation
(2)(13) is the one that maps 2 →2, 1 →3, and 3 →1. The total number
of ﬁxed points is 6 and the average is 6/6 = 1.
Randomly choose a permutation of {1, 2, . . ., n}. For 1 ≤i ≤n, deﬁne
Xi = 1 if i is ﬁxed and 0 otherwise. Then the number of ﬁxed points is
X = X1+X2+· · ·+Xn. The expected value of each Xi is (n−1)!/n! = 1/n.
Hence, the expected number of ﬁxed points is
E(X) = E(X1) + E(X2) + · · · + E(Xn)
= 1
n + 1
n + · · · + 1
n
= n · 1
n
= 1.
■
Example 10.13. An object travels along the integer points of the plane,
starting at the point (0, 0). At each step, the object moves one unit to the
right or one unit up (with equal probability). The object stops when it
reaches the line x = n or the line y = n. Show that the expected length of
the object’s lattice path is
2n −n
2n
n

21−2n.
Solution: Assume that the object hits the line x = n at the point (n, k) or

74
Pearls of Discrete Mathematics
the line y = n at the point (k, n), where 0 ≤k ≤n −1. Then the expected
length of the path is given by
E =
n−1
X
k=0
(n + k)2 · 1
2
n + k −1
n −1
 1
2
n+k−1
=
1
2
n n−1
X
k=0
(n + k)
n + k −1
n −1
 1
2
k−1
=
1
2
n
n
n−1
X
k=0
n + k
n
 1
2
k−1
=
1
2
n
2n
n−1
X
k=0
n + k
n
 1
2
k
=
1
2
n
2n
 n
X
k=0
n + k
n
 1
2
k
−
2n
n
 1
2
n!
.
By the result of Example 3.4, this simpliﬁes to
E = 2n −n
2n
n

21−2n.
■
The inclusion–exclusion principle is generalized by the Bonferroni in-
equalities of probability theory, named after Carlo Emilio Bonferroni (1892–
1960).
Theorem 10.14 (Bonferroni Inequalities). Let A1, . . . , An be subsets of
a ﬁnite set S. If t is an odd positive integer, then
|A1 ∪· · · ∪An| ≤
t
X
i=1
(−1)i+1
X
1≤k1<···<ki≤n
|Ak1 ∩· · · ∩Aki|.
If t is even, then the inequality is reversed.
Proof. Let s ∈S and assume that s is contained in exactly m of the Ai.
If m = 0, then the contribution to both sides of the inequality is 0. For
m > 0, the result follows from the identity Pt
i=0
 m
i

(−1)i =
 m−1
t

(−1)t.
(See Exercise 7 of Chapter 3.)
■
Example 10.15. Use the Bonferroni inequalities to give bounds on dn,
the number of derangements of {1, 2, 3, . . ., n}.

10 Probability Spaces and Distributions
75
Solution: If k is even, then
dn ≤
k
X
j=0
(−1)j n!
j! .
If k is odd, then the inequality is reversed.
■
The Bonferroni inequalities have a natural probability interpretation
when both sides of an inequality are divided by the size of the sample space.
For instance, the probability that a random permutation of n elements is a
derangement is bounded by
k
X
j=0
(−1)j
j!
.
This is an upper bound if k is even and a lower bound if k is odd.
Let’s consider some other useful probability distributions.
The distribution of the negative binomial random variable is deﬁned to
be the probability of obtaining, in a sequence of s + f Bernoulli trials, s
successes and f failures, with a success on the last trial. This probability
is
s + f −1
f

psqf,
s ≥1, f ≥0.
Notice that the coeﬃcient above is the coeﬃcient of xf in the series expan-
sion of (1 + x)−s (see p. 14).
Example 10.16. A person shooting basketball free throws has a 0.7 chance
of success. What is the probability that in 10 attempts the shooter will have
seven successes and three failures, with a success on the last attempt?
Solution: The probability is given by a negative random variable with p =
0.7, q = 0.3, s = 7, and f = 3. Thus, the probability is
9
3

(0.7)7(0.3)3 = 0.18678.
■
In the special case s = 1, we have the geometric random variable, with
distribution given by
pqf,
f ≥0.
Example 10.17. Another free throw shooter has a 0.1 chance of success.
In 10 attempts, what is the probability that the shooter misses the ﬁrst
nine and makes the last one?

76
Pearls of Discrete Mathematics
Solution: The probability is given by a geometric random variable with
p = 0.1, q = 0.9, and f = 9. Thus, the probability is
(0.1)(0.9)9 = 0.0909533.
■
The hypergeometric random variable has a distribution given by the
probability of obtaining a certain sample from a bin of marbles. Suppose
that a bin contains b blue marbles and g green marbles. A sample of size m
is made without replacement. The probability that exactly k blue marbles
are selected is
 b
k
 g
m−k

 b+g
m

,
0 ≤m ≤b + g, 0 ≤k ≤b.
The fact that the sum of these probabilities is 1 can be seen from Vander-
monde’s identity.
Example 10.18. An urn contains 10 green marbles and 10 blue marbles.
A random selection of 10 balls is made from the urn without replacement.
What is the probability that the selection consists of ﬁve green marbles and
ﬁve blue marbles?
Solution: The probability is
 10
5
 10
5

 20
10

= 15876
46189
.= 0.343718.
■
Example 10.19. Suppose that an urn contains n white balls and n black
balls. A ball is selected at random from the urn and removed. This process
is repeated until the urn contains only balls of one color.
What is the
expected number of balls remaining in the urn?
Solution: What is the probability that a given white ball is left in the urn?
Imagine that we continue the selection and withdrawal process until the
urn is empty. Then the given white ball is left in the urn (in the original
set-up) if and only if it is selected after all the black balls in the extended
process. Relative to the black balls, and ignoring all the other white balls,
there are n + 1 places at which the white ball can be selected: before the
ﬁrst black ball, between the ﬁrst and second black balls, . . . , after the last
black ball. Since these places are equally likely, the probability that the
given white ball is left in the urn is 1/(n + 1). As each of the 2n balls

10 Probability Spaces and Distributions
77
(black or white) has this probability of remaining, the expected number of
balls remaining is 2n/(n + 1).
As n tends to inﬁnity, the expected number of balls left in the urn
approaches 2.
■
We end this chapter with a brief description of some central results
in probability theory, most importantly, the law of large numbers.
The
variables in our discussion may be continuous or discrete.
The basic result is due to Andrey Markov (1856–1922).
Lemma 10.20 (Markov’s Inequality). Let X be a random variable with
mean µ, and λ any positive real number. Then
Pr(X ≥λ) ≤µ/λ.
Proof. From the deﬁnition of µ, we obtain
λ Pr(X ≥λ) ≤µ.
The result follows immediately.
■
The next result is attributed to Pafnuty Lvovich Chebyshev (1821–
1894).
Theorem 10.21 (Chebyshev’s Inequality). Let X be a random variable
with mean µ and variance σ2. Then, for any real number k > 0, we have
Pr(|X −µ| ≥kσ) ≤1
k2 .
Proof. By Markov’s inequality,
σ2 = V (X) = E((X −µ)2) ≥k2σ2 Pr(|X −µ| ≥kσ).
■
Theorem 10.22 (Law of Large Numbers for Repeated Trials of a Bernoulli
Random Variable). Let X be a Bernoulli variable. Then, for any positive
number ϵ, we have
Pr
 |X −E(X)| ≥ϵ

−→0
(as n →∞),
where X = (X1 + · · · + Xn)/n, and the Xi are independent and identically
distributed to X.

78
Pearls of Discrete Mathematics
Proof. If X is a Bernoulli random variable of type B(p), then X has stan-
dard deviation σ =
p
pq/n. By Chebyshev’s inequality,
Pr

|X −E(X)| ≥k
p
pq/n

≤1
k2 .
Choose k so that k
p
pq/n ≥ϵ. Now
1
k2 ≤pq
ϵ2n −→0
(as n →∞).
■
Exercises
1. A deck of 52 playing cards is dealt to two players so that each player
receives half of the deck. What is the sample space in this situation
and how many elements does it have? What is the probability of each
simple event in the sample space?
2. A pair of dice is rolled.
What is the sample space?
What is the
probability that the sum of the two dice is 7?
3. Three dice are rolled. What is the probability that the sum of the
three dice is at least 17?
4. Let X ∼B(n, 1/2), with n odd. Prove that Pr(X < n/2) = 1/2.
5. An unfair coin has probability p of coming up heads (p > 1/2). We
ﬂip the coin repeatedly until it comes up heads. What is the expected
number of ﬂips?
6. Prove that the expected number of “runs” in a sequence of n inde-
pendent Bernoulli variables B(p) is 2p(1 −p)(n −1) + 1. (A run is a
longest consecutive sequence of identical outcomes. For example, the
sequence 001110010101 has eight runs.)
7. Prove that the expected number of diﬀerent birth dates (out of 365
equally likely dates) among a group of n people is
365

1 −
364
365
n
.
†8. Find a recurrence formula for the derangement numbers dn.

10 Probability Spaces and Distributions
79
39. Use a computer and the result of the previous exercise to calculate
d30.
†10. Prove the following recurrence relation for the derangement numbers:
dn = ndn−1 + (−1)n,
n ≥2.
†⋆11. Find a simple formula for the exponential generating function for
{dn}, that is, the function
∞
X
n=0
dn
xn
n! .
⋆12. For n ≥1, let dn be the number of derangements of n elements. Then
the expected number of ﬁxed points in a permutation of n elements
is
1
n!
n
X
k=1
k
n
k

dn−k.
Show that this expression simpliﬁes to 1.
13. Two decks of 52 playing cards are shuﬄed and then dealt face up
from both decks one at a time. How many “matches” are expected?
A match is the same card (rank and suit) dealt from both decks.
⋆14. All 52 playing cards are dealt to four players, 13 cards per player.
What is the probability that exactly one player has all cards of the
same suit?
†⋆15. Find a formula for Euler’s function φ(n), which is the number of
integers between 1 and n that have no common factor with n.
⋆16. Show that the formula in Example 10.13 tends to
2n

1 −
1
√πn

,
as n →∞.
⋆17. Show that a pair of dice cannot be weighted so as to give all sums 2,
. . . , 12 with equal probability.
⋆18. Can three dice be weighted so as to give all sums 3, . . . , 18 with equal
probability?
19. A juggler can do a certain routine with probability of success 0.9.
Given 10 attempts, what is the probability that the juggler succeeds
nine times with the last attempt a success?

80
Pearls of Discrete Mathematics
20. An urn contains 10 green marbles and 20 blue marbles. A random
selection of 10 balls is made from the urn without replacement. What
is the probability that the selection consists of ﬁve green marbles and
ﬁve blue marbles?
321. An urn contains 100 green marbles and 100 red marbles. A random
selection of 100 marbles is made from the urn without replacement.
Use a computer to ﬁnd the probability that the number of green
marbles selected is between 48 and 52.
22. An urn contains nine red balls, nine white balls, and nine blue balls. A
random selection of nine balls is made from the urn without replace-
ment.
What is the probability that the selection consists of three
balls of each color?
23. Suppose that an urn contains w white balls and b black balls. A ball
is selected at random from the urn and removed.
This process is
repeated until the urn contains only balls of one color. What is the
expected number of balls remaining in the urn?
24. An urn contains balls numbered 1, . . . , n but otherwise identical. A
ball is picked at random from the urn, its number noted, and then
returned to the urn. This operation is performed three times. Prove
that the probability that the sum of the three numbers obtained is
divisible by 3 is at least 1/4.
25. An urn contains ﬁve white balls and ﬁve black balls. A ball is with-
drawn at random. If it is white it is returned to the urn. If it is black
it is left out. The process is repeated until all the black balls have
been removed from the urn. What is the expected number of balls
withdrawn from the urn?
26. There are two urns. Urn A contains ﬁve white balls. Urn B contains
four white balls and one black ball. An urn is selected at random and
a ball in that urn is selected at random and removed. This procedure
is repeated until one of the urns is empty. What is the probability
that the black ball has not been selected?

Chapter 11
Markov Chains
A boy, a girl, and a dog are playing with a ball. The boy throws the ball
to the girl 2/3 of the time and to the dog 1/3 of the time. The girl throws
the ball to the boy 1/2 of the time and to the dog 1/2 of the time. The dog
brings the ball to the girl all of the time. Then, on average, the boy will
have the ball 3/13 of the time, the girl 6/13 of the time, and the dog 4/13
of the time.
Suppose that a boy, a girl, and a dog play with a ball according to the
scenario described in the introduction. If play continues for a long time,
and the probabilities that the boy, the girl, and the dog have the ball at
any given time are b, g, and d, respectively, then these probabilities satisfy
the equations
b
=
1
2g
g
=
2
3b + d
d
=
1
3b + 1
2g
b + g + d
=
1.
We can solve these equations using elementary algebra, ﬁnding that b =
3/13, g = 6/13, and d = 4/13. This is called the “steady-state solution” to
the problem. We would like to show that the probabilities always tend to
this steady-state solution.
We can turn the situation into a matrix equation. Let the probabilities
that the boy, the girl, and the dog have the ball at time n be bn, gn, and dn,
respectively. The initial probabilities b0, g0, and d0 are three nonnegative
real numbers that sum to 1. These probabilities satisfy the matrix equations


bn+1
gn+1
dn+1

=


0
1/2
0
2/3
0
1
1/3
1/2
0




bn
gn
dn

,
n ≥0.
After the boy, girl, and dog have been playing with the ball for a long
81

82
Pearls of Discrete Mathematics
time, we expect that there are limiting values of the probabilities bn, gn,
and dn. Let
b = lim
n→∞bn,
g = lim
n→∞gn,
d = lim
n→∞dn.
We expect that b, g, and d satisfy the equation


b
g
d

=


0
1/2
0
2/3
0
1
1/3
1/2
0




b
g
d

.
As we will see, these limits don’t depend on b0, g0, and d0, and they can
be found using algebra as above.
A system such as the one described is called a Markov chain.
The
concept of a Markov chain is due to Andrey Markov (1856–1922), who
introduced it in 1906. The matrix
P =


0
1/2
0
2/3
0
1
1/3
1/2
0


is called the transition matrix for the Markov chain.
A Markov chain is a sequence X0, X1, . . . of random variables that
indicate states 1, 2, 3, . . . , m such that there is a probability pij that
Xn+1 = i given that Xn = j. The pij, called transition probabilities, are
nonnegative numbers whose sum, for each ﬁxed i, is 1. We can write the
transition probabilities in matrix form called a transition matrix:
P =


p11
. . .
p1m
p21
. . .
p2m
...
...
...
pm1
. . .
pmm

.
A state vector X is changed to a new state vector X′ via the transition
matrix:
X′ = P X.
Given the matrix P , it is easy to calculate the probability of reaching
any state from any other state in two steps. These probabilities are the
entries of P 2. The reason is that the ijth entry of P 2 is
m
X
k=1
pikpkj.
In general, the ijth entry of P n is the probability of reaching state j from
state i in n steps. In terms of conditional probability, we write
p(n)
ij
= Pr(Xn+k = j : Xk = i).

11 Markov Chains
83
We denote by P ∞the limit of P n as n →∞(if it exists). Thus, the ijth
entry of P ∞is limn→∞p(n)
ij .
A Markov chain is regular if there exists an n such that all the entries
of P n are positive. This means that for all states i and j, there is a positive
probability of reaching state j from state i in n steps.
Theorem 11.1. Given a regular Markov chain with transition matrix P ,
the matrix P ∞exists and its columns are each equal to X, where X is the
unique probability vector satisfying the equation
X = P X.
For a proof of this theorem, see [Hel97].
We will show that the limiting probabilities exist in our case of the 3×3
transition matrix. The key is to ﬁnd a way to exponentiate the matrix P .
We do this by writing P in terms of a diagonal matrix D. Thus, we wish
to write
P = ADA−1,
where D is a diagonal matrix. Then
P n = ADnA−1.
The entries of Dn are easily computed, since Dn is a diagonal matrix whose
diagonal entries are the entries of D raised to the nth power.
We ﬁnd the matrices D and A using eigenvalues and eigenvectors. An
eigenvector of a square matrix A is a nonzero vector v such that
Av = λv,
for some scalar λ. We call λ the eigenvalue associated with v.
If Av = λv, then (A −λI)v = 0. The only way that this equation can
have a nontrivial solution v (i.e., v ̸= 0) is for the matrix A −λI to be
singular. So λ is an eigenvalue of A if and only if A −λI is a singular
matrix, that is, the determinant of this matrix is 0.
In our example, we want to solve the equation

−λ
1/2
0
2/3
−λ
1
1/3
1/2
−λ

= 0.
Working out the determinant, we obtain the characteristic equation1
λ3 −5
6λ −1
6 = 0.
1Our use of the term “characteristic equation” for a transition matrix is consistent
with our use of the same term for a recurrence relation because a recurrence relation can
be written via a transition matrix with the same characteristic equation.

84
Pearls of Discrete Mathematics
The characteristic equation has solutions λ1 = 1, λ2 = (−3 −
√
3)/6, and
(−3 +
√
3)/6. The eigenvector associated with the eigenvalue 1 is the vec-
tor [3/13, 6/13, 4/13] that we found as the steady-state solution (we freely
write vectors either horizontally or vertically). Note that we have normal-
ized this vector so that the sum of the three coordinates is 1. What is the
signiﬁcance of the other two eigenvalues? They control the rate of conver-
gence to the steady-state solution. Let’s ﬁnd eigenvectors corresponding to
the other eigenvalues. We have


0
1/2
0
2/3
0
1
1/3
1/2
0




x
y
z

= −3 −
√
3
6


x
y
z

.
From this system, we obtain the eigenvector [
√
3, −1−
√
3, 1]. Similarly, the
eigenvalue (−3 +
√
3)/6 corresponds to the eigenvector [−
√
3, −1 −
√
3, 1].
Let v1, v2, and v3 be the eigenvectors corresponding to the eigenvalues
λ1, λ2, and λ3, respectively. Let A be the 3 × 3 matrix whose columns are
v1, v2, and v3, i.e., A = [v1, v2, v3]. Then, by the deﬁnition of eigenvalue
and eigenvector, we obtain
P A = A


λ1
0
0
0
λ2
0
0
0
λ3

.
It follows that
P = ADA−1,
where D is the diagonal matrix with diagonal entries λ1, λ2, and λ3. This
is the required decomposition of P .
Suppose that we start with the vector v0. Let A−1v0 = [α1, α2, α3].
Then
P nv0 = [v1, v2, v3]


1
0
0
0
λn
2
0
0
0
λn
3




α1
α2
α3


= α1v1 + α2λn
2 v2 + α3λn
3 v3.
Since λ2 and λ3 are both less than 1 in absolute value, λn
2 and λn
3 tend to
0 as n →∞. Hence
P ∞v0 = α1v1.
Since α1v1 is a probability vector, α1 = 1. Therefore
P ∞v0 = v1.
So the probability distribution tends to v1, regardless of the starting prob-
abilities.

11 Markov Chains
85
Furthermore, since P P ∞= P ∞, each column of P ∞is equal to v1.
Example 11.2. Use a transition matrix to ﬁnd a formula for the nth
Fibonacci number, Fn. (This time the transition matrix does not represent
probabilities.)
Solution: It is convenient to work with pairs of consecutive Fibonacci num-
bers. Thus, the Fibonacci recurrence yields
 Fn+1
Fn

=
 1
1
1
0
 Fn
Fn−1

,
n ≥1.
Hence
 Fn+1
Fn

=
 1
1
1
0
n  1
0

,
n ≥0.
Let
M =
 1
1
1
0

.
If we can write M as
M = ADA−1,
then it will follow that
M n = ADnA−1.
If D is a diagonal matrix, then Dn is easily computed, so in this case we
would have a simple way of computing the nth Fibonacci number directly.
If
M =  v1
v2
  λ1
0
0
λ2
  v1
v2
−1 ,
then
M

v1
v2

=

v1
v2
  λ1
0
0
λ2

,
and we see that v1 and v2 are eigenvectors with eigenvalues λ1 and λ2,
respectively. The eigenvalues are
λ1 = 1 +
√
5
2
,
λ2 = 1 −
√
5
2
,
with corresponding eigenvectors
v1 =
 λ1
1

,
v2 =
 λ2
1

.
Now we have

Fn+1
Fn

=

λ1
λ2
1
1
 
λn
1
0
0
λn
2
 
λ1
λ2
1
1
−1 
1
0

.

86
Pearls of Discrete Mathematics
Since

λ1
λ2
1
1
−1
=
1
λ1 −λ2

1
−λ2
−1
λ1

,
we obtain
Fn =λn
1 −λn
2
λ1 −λ2
= 1
√
5
 
1 +
√
5
2
!n
−1
√
5
 
1 −
√
5
2
!n
,
n ≥0.
■
In general, suppose that the sequence {an} satisﬁes a linear recurrence
relation with constant coeﬃcients, i.e., a relation
an = c1an−1 + c2an−2 + · · · + ckan−k,
with constants c1, . . . , ck, for all n ≥k.
In terms of a transition matrix, we have


an
an−1
...
an−k+2
an−k+1


=


c1
c2
. . .
ck−1
ck
1
0
. . .
0
0
0
1
. . .
0
0
...
...
...
0
. . .
1
0




an−1
an−2
...
an−k+1
an−k


,
n ≥k.
Call the k × k transition matrix C. The characteristic polynomial of C is
det(C −xI) =

c1 −x
c2
c3
. . .
ck
1
−x
0
. . .
0
0
1
−x
. . .
0
...
...
...
...
0
. . .
0
1
−x

.
The value of this determinant is
(c1 −x)(−x)k−1 −1 · (c2(−x)k−2 −1 · (c3(−x)k−3 −· · · ))
= (−1)k(xk −xk−1c1 −xk−2c2 −xk−3c3 −· · · −ck).
This is (−1)k times the characteristic polynomial for the recurrence relation.
Suppose that the roots of this polynomial are r1, . . . , rk, with the ri distinct.
Then C is diagonalizable as
C = ADA−1,

11 Markov Chains
87
where D is a diagonal matrix with diagonal entries r1, . . . , rk. Hence


an
an−1
...
an−k+1


=
ADnA−1


ak−1
ak−2
...
a0

.
The top relation of this system is
an = α1rn
1 + · · · + αkrn
k,
n ≥0,
where α1, α2, . . . , αk are constants.
What is the geometric signiﬁcance of eigenvalues and eigenvectors? Let’s
take a look at the Fibonacci numbers transition matrix:
M =
 1
1
1
0

This matrix represents an action on the real plane R2. That is to say, each
vector v ∈R2, upon multiplication by M, is transformed into a new vector
v′ ∈R2.
We note that the zero vector is mapped to itself under this action. Also,
 1
1
1
0
  1
0

=
 1
1

,
 1
1
1
0
  0
1

=
 1
0

.
Furthermore, the eigenvalues and eigenvectors are deﬁned so that Mv1 =
λ1v1 and Mv2 = λ2v2. Figure 11.1 shows the action. We can see in the
ﬁgure that the vectors v1 and v2 are linearly independent; hence they form
a coordinate system for the plane. Given any v ∈R2, we can write
v = av1 + bv2.
The “coordinates” of v with respect to the new basis are a and b. Now it is
easy to see what happens to v under the transformation given by M. We
have
Mv
=
M(av1 + bv2)
=
aMv1 + bMv2
=
aλ1v1 + bλ2v2.
Therefore, the vector with coordinates (a, b) is sent to a new vector v′ = Mv
with coordinates (aλ1, bλ2). Simply put, the coordinates of v are multiplied
by the eigenvalues of M.

88
Pearls of Discrete Mathematics
-
6
     
3
3
J
J
J
J
J]
J
J
J^
v2
λ2v2
v1
λ1v1
v
(1, 0)
(0, 1)
FIGURE 11.1: The action of the matrix M.
Exercises
1. What is the steady-state solution of the Markov chain with transition
matrix
P =


0
1/3
1/2
1/4
0
1/2
3/4
2/3
0

?
What are the eigenvalues and eigenvectors of this matrix? Calculate
P ∞.
32. Suppose that the Markov chain of the previous exercise starts with
the probability distribution [1, 0, 0]. After 100 steps, how close is the
probability distribution to the steady-state solution?
3. Does the transition matrix


0
1
0
0
0
1
1
0
0


represent a regular Markov chain?

11 Markov Chains
89
4. Let
M =
 −15
−2
153
20

.
Find M raised to the 100th power.
5. Find a 2 × 2 non-identity matrix M such that M 5 = I2.
6. Find the 2 × 2 matrix that reﬂects each vector in the plane with
respect to the x-axis. What are the eigenvalues and eigenvectors of
this matrix?
7. Find the 2×2 matrix that reﬂects each vector in the plane with respect
to the line y = x + 1. What are the eigenvalues and eigenvectors of
this matrix?
8. Find the 2 × 2 matrix that projects each vector in the plane orthogo-
nally onto the line y = 3x. What are the eigenvalues and eigenvectors
of this matrix?
9. Use matrices to ﬁnd a formula for an, where a0 = 0, a1 = 1, and
an = 2an−1 −an−2,
n ≥2.
10. Use matrices to ﬁnd a formula for bn, where b0 = 3, b1 = 10, b3 = 38,
and bn = 10bn−1 −31bn−2 + 30bn−3, for n ≥3.
11. Find a 2×2 matrix M with integer entries such that M 2 −M −I = 0.
12. A group of n people, X1, . . . , Xn, are throwing a ball back and
forth. Suppose that at each increment of time, the person currently
holding the ball throws it to one of the others. Let the steady-state
probability distribution be [p1, p2, . . ., pn]; that is, pi, for 1 ≤i ≤n,
is the probability that Xi has the ball at any given time.
(a) Show that p1 = 1/n regardless of who X1 throws the ball to (as
long as the others throw the ball to everyone with equal likelihood).
(b) Suppose that everyone throws the ball to everyone else with equal
likelihood except that X1 always throws the ball to X2. Show that
[p1, p2, . . ., pn] =
 1
n, 2n −2
n2
, n −1
n2
, . . ., n −1
n2

.
Thus, on average, X2 has the ball twice as often as every other person
except X1, who has the ball more often than every other person except
X2.


Chapter 12
Random Tournaments
A large random tournament almost assuredly has the property that for every
10 teams, there is a team that beats all 10.
In a large random tournament, almost assuredly every vertex is both a King
and a Serf.
A tournament is a complete graph (we will see more about graphs later
in the book) in which each edge is replaced by an arrow (i.e., a directed
edge). If an edge goes from vertex v to vertex w, say that team v beats
team w in a game.
A tournament has Property k if, for every k vertices, some vertex beats
all of them. For example, the tournament of Figure 12.1 has Property 1.
Figure 12.2 shows a tournament with Property 2. The tournament is
called a quadratic residue tournament. The vertices are labeled 0 through
7.
The assignment of the direction of the edges is based on modulo 7
arithmetic. Vertex i is directed to vertex j if j −i is a square modulo 7.
The squares modulo 7 are 02 ≡0, (±1)2 ≡1, (±2)2 ≡4, and (±3)2 ≡2.
Since a nonzero element x is a square modulo 7 if and only if −x is a
non-square modulo 7, the direction of edges is well-deﬁned.
It isn’t obvious how to construct a tournament with, say, Property 10.
However, we can prove that such a tournament exists without constructing
1
2
3
FIGURE 12.1: A tournament with Property 1.
91

92
Pearls of Discrete Mathematics
0
1
2
3
4
5
6
FIGURE 12.2: A tournament with Property 2.
it. The main result is sometimes called Sch¨utte’s theorem but was proved
by Paul Erd˝os (1913–1996). The proof uses probability.
Theorem 12.1 (P. Erd˝os, 1963). Let k be a positive integer. For some
integer n, there exists a tournament on n vertices with Property k.
Proof. Let k be a positive integer and n an integer to be determined later.
Let the edges of the tournament on n vertices be directed one way or the
other at random, with equal probability, and independently of all the other
edges.
We call such a tournament a “random tournament.”
For every
subset S of k vertices, denote by AS be the event that there is no vertex in
the tournament that beats all the vertices of S. In order for AS to occur,
none of the n −k vertices in the complement of S may be directed to all
vertices of S. Hence
Pr(AS) = (1 −2−k)n−k.
Since the probability of a union of events is at most equal to the sum of the
probabilities of the individual events (the case t = 1 in Theorem 10.14), we
have
Pr
 [
S
AS
!
≤
X
S
Pr(AS) =
n
k

(1 −2−k)n−k.
Note that Pr(S
S AS) is the probability that the tournament does not have
Property k. We have an upper bound for this union that is the product of
two terms:
 n
k

and
 1 −2−kn−k. Since k is ﬁxed,
 n
k

is a polynomial in
n (of degree k), while
 1 −2−kn−k is an exponential function in n (with a
base less than 1). As n tends to inﬁnity, the exponential function dominates

12 Random Tournaments
93
and the product of the two terms tends to 0. Since the upper bound tends
to 0, the probability of the union must be less than 1 for some n.
By
taking complements, we see that for such an n, a random tournament on n
vertices has Property k with positive probability. This probability is equal
to the number of tournaments with Property k divided by the total number
of tournaments on n vertices. Therefore, there exists a tournament on n
vertices with Property k.
■
Following the method of the proof, we deduce that there exists a tour-
nament with Property 10 on 102,653 vertices, since
 n
10

(1 −2−10)n−10 < 1,
for n = 102653.
Now we consider another type of question about tournaments.
In a tournament, a King is a vertex from which every other vertex can
be reached in one or two directed steps. A Serf is a vertex that can be
reached from every other vertex in one or two directed steps. Every vertex
in the tournaments of Figures 12.1 and 12.2 is both a King and a Serf. We
will prove that this situation is typical.
The outdegree of a vertex is the number of edges directed away from
that vertex. The indegree of a vertex is the number of edges directed to it.
Theorem 12.2 (H. G. Landau, 1951). Every tournament has a King.
Proof. Consider a vertex v of maximum outdegree. We will prove that v
is a King of the tournament. Suppose that there are edges directed from v
to r vertices, u1, . . . , ur. Assume that there is a vertex w that cannot be
reached in one or two steps from v. Then w is not among the ui and there
are edges directed from w to all the ui and to v. But then the outdegree of
w is at least r + 1, contradicting the choice of v.
■
Theorem 12.3 (Stephen B. Maurer, 1980). The probability that every
vertex in a random tournament on n vertices is both a King and a Serf
tends to 1 as n tends to inﬁnity.
Proof. We use the probabilistic method. A tournament lacks the desired
property if and only if there exists a pair of vertices v and w with v →w
such that there is no directed path of length 2 from w to v. This happens
with probability at most
n
2
 3
4
n−2
−→0 (as n →∞).
■

94
Pearls of Discrete Mathematics
Exercises
31. Find a value of n for which there is a tournament on n vertices with
Property 3. Can you construct a tournament with Property 3?
32. Find a value of n for which there is a tournament on n vertices with
Property 12.
33. Find a value of n for which a random tournament on n vertices has
Property 12 with probability greater than 0.5.
⋆4. Prove that the tournament on seven vertices with Property 2 shown
in Figure 12.2 is unique up to isomorphism.
†5. Prove that no tournament on 2n −1 vertices has Property n.
6. Prove that every tournament has a directed path that visits each
vertex exactly once.
7. Find a formula for the maximum number of directed 3-cycles in a
tournament of order n.
8. Prove that every tournament has a Serf.
9. Construct a quadratic residue tournament on 11 vertices. How many
Kings and Serfs does it have?
10. A vertex which reaches every other vertex in one step is called an
Emperor. Prove that a tournament with no Emperor has at least
three Kings.
†11. Show that a tournament on n > 4 vertices can have any number of
Kings between 1 and n except 2. What happens when n = 3 or 4?
12. In the proof of Theorem 12.2, we tacitly assumed that the tournament
has a ﬁnite number of vertices. Is it true that every tournament on a
countably inﬁnite set of vertices has a King?

Part V
Number Theory
95


Chapter 13
Divisibility of Factorials and
Binomial Coeﬃcients
In any row of Pascal’s triangle, any two numbers aside from the 1s have a
common factor.
Many observations can be made about the number-theoretic properties
of factorials and binomial coeﬃcients.
Example 13.1. How many 0s occur at the right of 40! ?
Solution: The 0s at the right of 40! appear due to factors of 2 and 5 among
the numbers 1, 2, . . . , 40. Since there are more 2s than 5s, the number of
0s is determined by the exponent of 5 that divides 40!. This number is
∞
X
k=1
40
5k

=
40
5

+
40
25

= 8 + 1 = 9.
■
In the following discussion, let p be a prime number.
Proposition 13.2. The power to which a prime p divides n! is given by
∞
X
k=1
 n
pk

.
This series is actually a ﬁnite one, since pk > n for k suﬃciently large.
Denote by db(n) the sum of the “digits” in the base-b representation of n.
For instance, if the base-3 representation of n is 102012, then d3(n) = 6.
Proposition 13.3. The power of 2 that divides n! is n −d2(n).
Proof. Let the base-2 representation of n be
n = bkbk−1 . . . b1b0.
97

98
Pearls of Discrete Mathematics
Then n = Pk
i=0 bi2i, so that the exponent of 2 that divides n! is
∞
X
i=1
j n
2i
k
=
(b1 + 2b2 + 22b3 + · · · + 2k−1bk)
+(b2 + 2b3 + · · · + 2k−2bk)
+ · · ·
+bk
=
(20 −1)b0 + (21 −1)b1 + (22 −1)b2 + · · · + (2k −1)bk
=
n −d2(n).
■
The previous result is a special case of a theorem of Adrien-Marie Leg-
endre (1752–1833).
Theorem 13.4 (A.-M. Legendre, 1808). The exponent of p that divides
n! is
n −dp(n)
p −1
.
Next, we turn to the question of the divisibility of binomial coeﬃcients
by primes.
Proposition 13.5. If p is a prime and 1 ≤k ≤p −1, then
 p
k

is divisible
by p.
Proof. The numerator of p!/(k!(p −k)!) is a multiple of p and p does not
divide the denominator.
■
The following surprising (and delightful) result was discovered by Ernst
Kummer (1810–1893).
Theorem 13.6 (E. Kummer, 1852). The exponent to which a prime p
divides the binomial coeﬃcient
 n
k

is equal to the number of “carries”
when k and n −k are added in base p.
Proof. We will prove the result in the base 2 case. Let j = n −k. The
exponent to which 2 divides
 n
k

is
n −d2(n) −(j −d2(j) + k −d2(k)) = d2(j) + d2(k) −d2(n).
Assume that the binary representation of n requires l binary digits. For
1 ≤i ≤l, let ni, ji, and ki be the ith binary digit of the expansion of n,
j, and k, respectively; let ci = 1 if there is a carry in the ith place when j

13 Divisibility of Factorials and Binomial Coeﬃcients
99
and k are added (in binary), and ci = 0 if there is no carry. Also, deﬁne
c−1 = 0. From the deﬁnition of “carry,” ni = ji + ki + ci−1 −2ci, for
1 ≤i ≤l. Hence, the exponent to which 2 divides
 n
k

is
l
X
i=0
(ji + ki −ni) =
l
X
i=0
(2ci −ci−1) =
l
X
i=0
ci.
■
Corollary 13.7. For e ≥1 and 1 ≤m < pe, we have
pe
m

≡0
(mod p).
Now we hear from another great mathematician, Fran¸cois ´Edouard Ana-
tole Lucas (1842–1891). Lucas’ theorem gives a practical method for cal-
culating
 a
b

mod p.
Theorem 13.8 (E. Lucas, 1878). Let 0 ≤ai, bi < p, for 1 ≤i ≤k. Then
a0 + a1p + a2p2 + · · · + akpk
b0 + b1p + b2p2 + · · · + bkpk

≡
a0
b0
a1
b1
a2
b2

· · ·
ak
bk

(mod p).
Proof. The left side counts the ways of choosing b0 +b1p+b2p2 +· · ·+bkpk
balls from a set of a0 +a1p+a2p2 +· · ·+akpk balls. Suppose that the balls
to be selected are in boxes, with a0 boxes containing a single ball each,
a1 boxes containing p balls each, a2 boxes containing p2 balls each, . . . ,
and ak boxes containing pk balls each. In selecting the balls from boxes,
any choice of some but not all the balls from a box leads to a contribution
of 0 (mod p), since  pe
m
 ≡0 (mod p), for 1 ≤m < pe. Hence, the only
selections that matter (modulo p) are those that take none or all the balls
from a particular box. This means that we need to select bi boxes from a
set of ai boxes from which to take all the balls, for 0 ≤i ≤k. The number
of ways to do this is
a0
b0
a1
b1
a2
b2

· · ·
ak
bk

.
■
We say that the base-p representation of n “dominates” the base-p rep-
resentation of k if the number in each place of the base-p representation of
n is at least equal to the number in the corresponding place in the base-p
representation of k.

100
Pearls of Discrete Mathematics
Corollary 13.9. The binomial coeﬃcient
 n
k

is divisible by p if and only if
the base-p representation of n does not dominate the base-p representation
of k.
Example 13.10. Is
 59
11

divisible by 7?
Solution: Let’s see: 59 = 1·72 +1·7+3 and 11 = 1·7+4. Since the base-7
representation of 59 does not dominate the base-7 representation of 11, we
know that  59
11
 is divisible by 7.
■
We conclude with a discussion of the chapter teaser about numbers in a
row of Pascal’s triangle, a result due to Paul Erd˝os (1913–1996) and George
Szekeres (1911–2005).
Theorem 13.11 (P. Erd˝os and G. Szekeres, 1978). In any row of Pascal’s
triangle, any two numbers aside from the 1s have a common factor.
For example, in the sixth row,
1 6 15 20 15 6 1,
the entries 6 and 15 have a common factor 3, while 6 and 20 have a common
factor 2, and 15 and 20 have a common factor 5.
Proof. Suppose that the numbers are
 n
j

and
 n
k

, with 0 < j < k < n.
Then, by the subcommittee identity (Proposition 3.3),
n
k
k
j

=
n
j
n −j
k −j

.
Since
 n
j

divides the right side of this equation, it also divides the left side.
If  n
j
 and  n
k
 have no common factor, then  n
j
 divides  k
j
, but this is
impossible since  n
j
 >  k
j
.
■
Exercises
1. How many 0s occur at the right of 1000!?
2. Find the smallest integer n such that n! ends with exactly one hundred
0s.
3. To what power does 2 divide (2100 + 1)! ?

13 Divisibility of Factorials and Binomial Coeﬃcients
101
4. To what power does 2 divide (2100 −1)! ?
5. Does 7 divide  750+6·725+6
3·725+1
?
6. Show that (kn)! is divisible by (n!)k, for any positive integers k and
n.
7. Prove that  n
k
 is divisible by n if gcd(n, k) = 1.
8. Let k and m be integers such that 0 ≤m ≤2k −1. Prove that the
binomial coeﬃcient
 2k−1
m

is odd.
9. Investigate the entries of Pascal’s triangle modulo 2. What pattern
do you ﬁnd?
10. Prove that in any row of Pascal’s triangle, the number of odd numbers
is a power of 2.
11. Is  210+25+1
25+1
 divisible by 2?
12. Use Lucas’ theorem to calculate
 7100+73+2·7+5
73+4

mod 7.
313. Paul Erd˝os proved that there is only one nontrivial perfect power (not
a ﬁrst power) of the form  n
k
, with 3 ≤k ≤n −3. Use a computer
to ﬁnd this binomial coeﬃcient.
14. Show that n! cannot be a perfect square greater than 1.
15. Notice that 6! = 3!5!. Can you ﬁnd other instances of integers a, b,
and c, all greater than 1, such that a!b! = c!? Is there any pattern to
these numbers?
16. Prove the following result of Erd˝os and Szekeres:
gcd
n
i

,
n
j

≥2i,
where 0 < i ≤j ≤n/2.
†⋄17. Use a computer to ﬁnd the only two ordered pairs (n, k), with 1 <
k < n/2 for which
e
X
k=0
n
k

is a power of 2.
Note. The values (n, k) are the feasible parameters for perfect binary
codes.


Chapter 14
Covering Systems
There exists an odd integer k such that k + 2n is a composite number for
every positive integer n.
There exists a sequence of composite numbers satisfying the Fibonacci re-
currence relation with relatively prime initial values.
A covering system is a collection of congruences of the form x ≡ai
(mod mi), for 1 ≤i ≤k, where the mi are integers greater than 1, such
that every integer x satisﬁes at least one of the congruences. An example
of a covering system is the set of congruences
x ≡0
(mod 2)
x ≡0
(mod 3)
x ≡1
(mod 4)
x ≡1
(mod 6)
x ≡11
(mod 12).
It’s easy to verify that these congruences are a covering system. Write the
integers 0 through 11 and cross out the integers covered by each congruence.
Every integer will be crossed out.
We will show that there exists an odd integer k such that k+2n is prime
for no positive integer n. The method of proof, due to Paul Erd˝os, uses a
covering system.
The value k = 23 does not satisfy the requirement of the problem but
let’s see what happens with this value. We have 23 + 21 = 25, which is
divisible by 5. Hence, 23 + 2n is divisible by 5 if 2n ≡2 (mod 5). The
powers of 2 modulo 5 form the cycle {2, 4, 3, 1}. It follows that 23 + 2n
is composite (divisible by 5) for n ≡1 (mod 4). Similarly, 23 + 22 = 27,
which is divisible by 3. Hence, 23 + 2n is divisible by 3 if 2n ≡1 (mod 3).
The powers of 2 modulo 3 form the cycle {2, 1}. It follows that k + 2n
is composite (divisible by 3) for n ≡0 (mod 2). We have ruled out two
inﬁnite arithmetic progressions as choices for k, namely, all solutions to
103

104
Pearls of Discrete Mathematics
n ≡1 (mod 4) and n ≡0 (mod 2). The smallest positive integer not ruled
out is 3, and 23 + 23 = 31, a prime.
Erd˝os’ method is to choose a set of primes to rule out all possible values
of n. We see from the example k = 23 that we should investigate cycles of
powers of 2 modulo various primes. The following table shows our selection
of primes and the length of each corresponding cycle of powers of 2.
prime
length of cycle of powers of 2
3
2
5
4
7
3
13
12
17
8
241
24
We form a covering system with the lengths as moduli:
x ≡1
(mod 2)
x ≡0
(mod 4)
x ≡0
(mod 3)
x ≡2
(mod 12)
x ≡2
(mod 8)
x ≡22
(mod 24).
To ﬁnd an odd integer k such that k + 2n is never prime, we look for a
solution to the system of congruences
k ≡1
(mod 2)
k ≡−21
(mod 3)
k ≡−20
(mod 5)
k ≡−20
(mod 7)
k ≡−22
(mod 13)
k ≡−22
(mod 17)
k ≡−222
(mod 241).
(The purpose of the ﬁrst congruence is to ensure that k is odd.) This will
furnish an arithmetic progression of integers k that satisfy the condition
of the problem. For instance, if n ≡0 (mod 4), then 2n ≡1 (mod 5) and

14 Covering Systems
105
since k ≡−1 (mod 5), it follows that k + 2n is divisible by 5 (and hence
composite).
We ﬁnd a simultaneous solution to the above congruences using the
Chinese remainder theorem.1
Theorem 14.1 (Chinese Remainder Theorem). If n1, n2, . . . , nk are pair-
wise relatively prime numbers, and r1, r2, . . . , rk are any integers, then
there exists an integer x satisfying the simultaneous congruences
x
≡
r1
(mod n1)
x
≡
r2
(mod n2)
...
x
≡
rk
(mod nk).
Furthermore, x is unique modulo n1n2 . . . nk.
The solution to our problem will illustrate the constructive nature of
the proof of the Chinese remainder theorem.
Let m = 2 · 3 · 5 · 7 · 13 · 17 · 241 = 11184810. We solve the following
system of congruences:
(m/2)k1 ≡1
(mod 2)
(m/3)k2 ≡−21
(mod 3)
(m/5)k3 ≡−20
(mod 5)
(m/7)k4 ≡−20
(mod 7)
(m/13)k5 ≡−22
(mod 13)
(m/17)k6 ≡−22
(mod 17)
(m/241)k7 ≡−222
(mod 241).
Choosing the values k1 = 1, k2 = 2, k3 = 2, k4 = 2, k5 = 12, k6 = 1, and
k7 = 210 yields the solution
k ≡
m
2

1 +
m
3

2 +
m
5

2 +
m
7

2 +
 m
13

12 +
 m
17

1 +
 m
241

210
≡41446999
(mod m).
1The Chinese remainder theorem ﬁrst appeared around 400 in the book Sun Tzu
Suan Ching (“Sun Tzu’s Calculation Classic”) by Sun Tzu.

106
Pearls of Discrete Mathematics
Take k to be the smallest positive integer in this congruence class, i.e.,
k = 41446999 −3 · 11184810 = 7892569.
The number 7892569 + 2n is a prime for no positive integer n.
Let’s turn to another problem that can be solved with a covering system,
that of constructing a Fibonacci-like sequence of composite numbers.
It is not known whether there are inﬁnitely many prime Fibonacci num-
bers. Certainly, there are inﬁnitely many composite Fibonacci numbers,
since every third Fibonacci number is even. We will show that there exist
relatively prime positive integers a and b, such that the Fibonacci-like se-
quence deﬁned by the Fibonacci recurrence relation and the initial values
a and b contains no prime numbers. The ﬁrst example of such a sequence
was found in 1990 by Donald Knuth. We will show an example discovered
in 2004 by Maxim Vsemirnov.
Our sequence {an} is deﬁned by
a0 = a, a1 = b, an = an−1 + an−2, n ≥2.
It follows by mathematical induction that
an = aFn−1 + bFn,
n ≥1.
We deﬁne 17 quadruples of integers (pi, mi, ri, ci), where 1 ≤i ≤17.
These quadruples satisfy the following properties:
(1) each pi is prime;
(2) pi | Fmi;
(3) the congruences x ≡ri (mod mi) cover all the integers; that is, given
any integer n, at least one of the congruences is satisﬁed by n.
We deﬁne
a ≡ciFmi−ri
(mod pi),
b ≡ciFmi−ri+1
(mod pi),
1 ≤i ≤17.
Such integers a and b exist by (1) and the Chinese remainder theorem.
Now, using the identity from Exercise 6 of Chapter 3, we have
an ≡ciFmi−riFn−1 + ciFmi−ri+1Fn
(mod pi)
≡ci(Fmi−riFn−1 + Fmi−ri+1Fn)
(mod pi)
≡ciFmi−ri+n
(mod pi).
From (2) and the fact that Fm | Fmn (exercise), we have pi | an, where i is
given by property (3).
The following collection of 17 quadruples is found by computer experi-
mentation. (The values of ci help to keep the solutions a and b small.)

14 Covering Systems
107
(3, 4, 3, 2)
(2, 3, 1, 1)
(5, 5, 4, 2)
(7, 8, 5, 3)
(17, 9, 2, 5)
(11, 10, 6, 6)
(47, 16, 9, 34)
(19, 18, 14, 14)
(61, 15, 12, 29)
(23, 24, 17, 6)
(107, 36, 8, 19)
(31, 30, 0, 21)
(1103, 48, 33, 9)
(181, 90, 80, 58)
(41, 20, 18, 11)
(541, 90, 62, 85)
(2521, 60, 48, 306)
Using the (constructive) Chinese remainder theorem, we ﬁnd
a = 106276436867, b = 35256392432.
The smallest initial values that generate a Fibonacci-like sequence of com-
posite numbers are not known.
Exercises
1. Give an example of a covering system with three congruences having
distinct moduli.
32. Find a smaller odd positive integer than k = 7892569 for which k+2n
is a composite number for every positive integer n.
3. Prove that there are inﬁnitely many odd positive integers that are
not equal to the sum of a prime number and a power of 2.
4. Show that there exists an integer k, not divisible by 3, such that k+3n
is prime for no positive integer n.
†5. Prove the Chinese remainder theorem.
†⋆6. An exact covering system is a covering system in which each integer
satisﬁes exactly one of the congruences. Prove that there does not
exist an exact covering system for the integers with distinct moduli.
†7. Show that no Fibonacci number Fn with n odd has a prime factor of
the form 4k + 3.
†8. Prove that Fm | Fn if and only if m | n.
†9. Prove that gcd(Fm, Fn) = Fgcd(m,n).
10. Check that the congruences x ≡ri (mod mi) given by the 17 quadru-
ples cover all integers.


Chapter 15
Partitions of an Integer
There are 24,061,467,864,032,622,473,692,149,727,991 partitions of 1000 as
unordered sums of positive integers.
A partition of a positive integer n is a collection of positive integers
(order unimportant) whose sum is n. The integers in a partition are called
parts. We denote by p(n) the number of partitions of n, and by p(n, k) the
number of partitions of n into exactly k parts. Clearly,
p(n) =
n
X
k=1
p(n, k).
We call p(n) and p(n, k) partition numbers.
Example 15.1. Determine p(5, k), for 1 ≤k ≤5, and p(5).
Solution:
p(5, 1) = 1
(5)
p(5, 2) = 2
(4 + 1, 3 + 2)
p(5, 3) = 2
(3 + 1 + 1, 2 + 2 + 1)
p(5, 4) = 1
(2 + 1 + 1 + 1)
p(5, 5) = 1
(1 + 1 + 1 + 1 + 1)
p(5) = p(5, 1) + p(5, 2) + p(5, 3) + p(5, 4) + p(5, 4)
= 1 + 2 + 2 + 1 + 1 = 7
■
As in our example, we typically represent a partition of n with the parts
in monotonically decreasing order:
n = λ1 + λ2 + · · · + λk,
λ1 ≥λ2 ≥· · · ≥λk.
109

110
Pearls of Discrete Mathematics
Recall from Exercise 28 of Chapter 3 that a composition of n is an
ordered sum of positive integers equal to n. The number of compositions
of n is 2n−1. In a partition, the order of the summands is unimportant. A
formula for the number of partitions of n is known but complicated. In 1918
G. H. Hardy (1877–1947) and Srinivasa Ramanujan (1887–1920) found the
asymptotic formula
p(n) ∼eπ√
2n/3
4n
√
3 .
We will discuss recurrence relations for partition numbers and special prop-
erties of certain restricted types of partition numbers.
We can calculate p(n, k) and p(n) via a simple recurrence formula:
p(1, 1) = 1,
p(n, k) = 0,
k > n or k = 0,
p(n, k) = p(n −1, k −1) + p(n −k, k),
n ≥2 and 1 ≤k ≤n.
The ﬁrst two lines are obvious. As for the recurrence relation in the
third line, there are two possibilities for the least part, λk, in a partition
of n into k parts: either λk = 1 or λk > 1. If λk = 1, then there are
p(n −1, k −1) partitions of the remaining number n −1 into k −1 parts. If
λk > 1, then partitions of n into k parts are in one-to-one correspondence
with partitions of n −k into k parts (subtract 1 from each part in each
partition of n).
These recurrence relations and the formula p(n) = Pn
k=1 p(n, k) yield
Tables 15.1 and 15.2. We should note that in order to calculate p(n) using
this method, we must calculate an entire table of values of p(n, k). A more
direct way to calculate p(n) for large n is furnished by Euler’s pentagonal
number theorem, which we will see later.
We can picture partitions with “Ferrers diagrams,” named after Norman
Ferrers (1829–1903). Given a partition n = λ1 + λ2 + · · · + λk, with λ1 ≥
λ2 ≥· · · ≥λk, the corresponding Ferrers diagram consists of k rows of dots
with λi dots in row i, for 1 ≤i ≤k. The Ferrers diagram for the partition
11 = 7 + 2 + 1 + 1 is shown in Figure 15.1.
λ1
•
•
•
•
•
•
•
λ2
•
•
λ3
•
λ4
•
FIGURE 15.1: The Ferrers diagram of a partition of 11.
We create the transpose of a Ferrers diagram by writing each row of dots

15 Partitions of an Integer
111
k
n
1
2
3
4
5
6
7
8
9
10
1
1
2
1
1
3
1
1
1
4
1
2
1
1
5
1
2
2
1
1
6
1
3
3
2
1
1
7
1
3
4
3
2
1
1
8
1
4
5
5
3
2
1
1
9
1
4
7
6
5
3
2
1
1
10
1
5
8
9
7
5
3
2
1
1
TABLE 15.1: Partition numbers p(n, k).
as a column. We call the resulting partition the conjugate of the original
partition. For example, the partition 11 = 7 + 2 + 1 + 1 of Figure 15.1 is
transposed to create the conjugate partition 11 = 4 + 2 + 1 + 1 + 1 + 1 + 1
of Figure 15.2.
λ1
•
•
•
•
λ2
•
•
λ3
•
λ4
•
λ5
•
λ6
•
λ7
•
FIGURE 15.2: A transpose Ferrers diagram.
You may want to test your understanding by matching each partition
of 5 in Example 15.1 with its conjugate. How many of the partitions are
self-conjugate?
Let p(0) = 1. Then the (ordinary) generating function for the partition
numbers p(n) is
∞
X
n=0
p(n)xn = 1 + x + 2x2 + 3x3 + 5x4 + 7x5 + 11x6 + 15x7 + 22x8 + · · · .
This generating function has a representation as an inﬁnite product.

112
Pearls of Discrete Mathematics
n
p(n)
n
p(n)
n
p(n)
n
p(n)
1
1
26
2436
51
239943
76
9289091
2
2
27
3010
52
281589
77
10619863
3
3
28
3718
53
329931
78
12132164
4
5
29
4565
54
386155
79
13848650
5
7
30
5604
55
451276
80
15796476
6
11
31
6842
56
526823
81
18004327
7
15
32
8349
57
614154
82
20506255
8
22
33
10143
58
715220
83
23338469
9
30
34
12310
59
831820
84
26543660
10
42
35
14883
60
966467
85
30167357
11
56
36
17977
61
1121505
86
34262962
12
77
37
21637
62
1300156
87
38887673
13
101
38
26015
63
1505499
88
44108109
14
135
39
31185
64
1741630
89
49995925
15
176
40
37338
65
2012558
90
56634173
16
231
41
44583
66
2323520
91
64112359
17
297
42
53174
67
2679689
92
72533807
18
385
43
63261
68
3087735
93
82010177
19
490
44
75175
69
3554345
94
92669720
20
627
45
89134
70
4087968
95
104651419
21
792
46
105558
71
4697205
96
118114304
22
1002
47
124754
72
5392783
97
133230930
23
1255
48
147273
73
6185689
98
150198136
24
1575
49
173525
74
7089500
99
169229875
25
1958
50
204226
75
8118264
100
190569292
TABLE 15.2: Partition numbers p(n).
Theorem 15.2.
∞
X
n=0
p(n)xn =
∞
Y
k=1
(1 −xk)−1
The concept behind this formula is basically the same as that of the
generating functions for making change and for integer triangles that we
saw in Chapters 7 and 8.
Denote by p(n | λ1 = k) the number of partitions of n in which the
largest part is k. The next proposition is a simple observation using trans-
pose Ferrers diagrams.
Proposition 15.3.
p(n, k) = p(n | λ1 = k)
Denote by p(n, ≤k) the number of partitions of n into at most k parts,

15 Partitions of an Integer
113
and by p(n | λ1 ≤k) the number of partitions of n into parts of size at
most k. From Proposition 15.3, we have
p(n, ≤k) = p(n | λ1 ≤k).
Each partition of n into k parts corresponds to a partition of n −k
into at most k parts (by subtracting 1 from each part). From the previous
relation, we conclude that
p(n, k) = p(n −k | λ1 ≤k).
That is to say, the number of partitions of n into k parts is equal to the
number of partitions of n −k with largest part at most k. The generating
function for the partition numbers p(n, k) follows immediately.
Theorem 15.4.
∞
X
n=k
p(n, k)xn = xk
k
Y
j=1
(1 −xj)−1
We have covered the basic identities and generating functions for par-
titions. Now let’s consider a variety of restrictions on partitions. Denote
by p(n | distinct parts) the number of partitions of n into distinct parts.
The next result is a simple observation regarding another inﬁnite product
representation.
Proposition 15.5.
∞
X
n=0
p(n | distinct parts)xn =
∞
Y
k=1
(1 + xk)
Denote by p(n | odd parts) the number of partitions of n into parts
each of which is an odd number. Leonhard Euler (1707–1783) proved the
following identity as one of many about partitions.
Proposition 15.6 (L. Euler, 1748).
p(n | odd parts) = p(n | distinct parts)

114
Pearls of Discrete Mathematics
Proof. The proof is a bit of generating function magic. We have
∞
X
n=0
p(n | odd parts)xn =
1
(1 −x)(1 −x3)(1 −x5) . . .
=
(1 −x2)
(1 −x)(1 −x2) ·
(1 −x4)
(1 −x3)(1 −x4) ·
(1 −x6)
(1 −x5)(1 −x6) · · · ·
= (1 −x2)
(1 −x) · (1 −x4)
(1 −x2) · (1 −x6)
(1 −x3) · · · ·
= (1 + x)(1 + x2)(1 + x3) . . .
=
∞
X
n=0
p(n | distinct parts)xn.
The result follows by comparing coeﬃcients of xn.
■
Example 15.7. Find the partitions of 6 into odd parts and the partitions
of 6 into distinct parts.
Solution:
p(6 | odd parts) = 4
(5 + 1, 3 + 3, 3 + 1 + 1 + 1, 1 + 1 + 1 + 1 + 1 + 1)
p(6 | distinct parts) = 4
(6, 5 + 1, 4 + 2, 3 + 2 + 1)
■
Denote by p(n | even # distinct parts) the number of partitions of n
into an even number of distinct parts, and by p(n | odd # distinct parts)
the number of partitions of n into an odd number of distinct parts. The
following result is similar to the kind of generating function that we found
in Chapter 7 for the number of ways of making change with an odd number
or an even number of coins.
Proposition 15.8.
∞
Y
n=1
(1−xn) =
∞
X
n=0
[p(n | even # distinct parts)−p(n | odd # distinct parts)]xn
Each coeﬃcient of xn in the expansion of the above product is 0, 1, or
−1. The pattern is given succinctly in terms of “pentagonal numbers.” A
pentagonal number is a number that can be represented by dots arranged
in a pentagonal array, as in Figure 15.3. Thus, the pentagonal numbers are
1, 5, 12, 22, 35, 51, 70, 92, 117, . . ..

15 Partitions of an Integer
115
1
5
12 22 35 ...
FIGURE 15.3: Pentagonal numbers.
Let ak be the kth pentagonal number. We observe a recurrence formula
for {ak} from the diagram:
ak = ak−1 + 3k −2,
k ≥2,
a1 = 1.
Hence
ak = a1 + 3(2 + 3 + · · · + k) −2(k −1)
= 1 + 3
k(k + 1)
2
−1

−2(k −1)
= k(3k −1)
2
,
and we see that a pentagonal number has the form
k(3k −1)/2,
k ≥1.
We may replace k by −k, obtaining the so-called “pseudopentagonal
numbers”:
(−k)(−3k −1)/2 = k(3k + 1)/2,
k ≥1.
Thus, the pseudopentagonal numbers are
2, 7, 15, 26, 40, 57, 77, 100, 126, . . . .
The two types of pentagonal numbers, together with 0, are called “gener-
alized pentagonal numbers” and are given by
n = k(3k ± 1)/2,
k ≥0.

116
Pearls of Discrete Mathematics
Proposition 15.9.
p(n | even number of distinct parts) −p(n | odd number of distinct parts)
=
 (−1)k
if n = k(3k ± 1)/2,
for k ≥1
0
otherwise
The following bijective proof using Ferrers diagrams was discovered in
1881 by Fabian Franklin (1853–1939).
Proof. We will describe a correspondence between partitions of n with an
even number of distinct parts and partitions of n with an odd number of
distinct parts. The correspondence is a one-to-one correspondence for all n
that are not generalized pentagonal numbers. For generalized pentagonal
numbers, there is one extra partition in one of the collections.
Given a Ferrers diagram for a partition with distinct parts, let H (for
horizontal) be the bottom row of dots (representing the smallest part of the
partition), and let D (for diagonal) be the longest diagonal of dots, starting
with the right-most dot in the top row. Let h be the number of dots in H
and d the number of dots in D. If h ≤d, then move H so that it forms a
diagonal to the right of D, with its top dot in the top row. If h > d, then
move D to the bottom row as a new smallest part.
Figure 15.4 illustrates the case n = 17 (not a generalized pentagonal
number), showing the correspondence between the Ferrers diagrams of the
partitions 17 = 6+5+4+2 (even number of distinct parts) and 17 = 7+6+4
(odd number of distinct parts).
h=2
d=3
h=4
d=2
FIGURE 15.4: Correspondence between partitions with distinct parts.
Usually (as in our example), the correspondence changes the parity of
the number of parts in the partition, giving a one-to-one correspondence
between partitions with an even number of distinct parts and partitions
with an odd number of distinct parts.
The correspondence fails in two
cases: when H and D have a dot in common and h = d or h = d + 1. In

15 Partitions of an Integer
117
the ﬁrst case,
n = d2 + 1 + · · · + (d −1) = d(3d −1)
2
.
In the second case,
n = d2 + 1 + · · · + d = d(3d + 1)
2
.
We see that these two cases can occur only when n is a generalized pen-
tagonal number.
If n is a dth generalized pentagonal number, then the
diﬀerence between the number of partitions with an even number of dis-
tinct parts and the number of partitions with an odd number of distinct
parts is (−1)d.
■
Example 15.10. Verify Proposition 15.9 for n = 12.
Note that 12 =
3 · (3 · 3 −1)/2 is a pentagonal number.
Solution:
p(12 | even number of distinct parts) = 7
(11 + 1, 10 + 2, 9 + 3, 8 + 4, 7 + 5, 6 + 3 + 2 + 1, 5 + 4 + 2 + 1)
p(12 | odd number of distinct parts) = 8
(12, 9 + 2 + 1, 8 + 3 + 1, 7 + 4 + 1, 6 + 5 + 1, 7 + 3 + 2, 6 + 4 + 2, 5 + 4 + 3)
p(12 | even number of distinct parts) −p(12 | odd number of distinct parts)
= 7 −8 = (−1)3
■
Combining Propositions 15.8 and 15.9, we obtain Euler’s famous pen-
tagonal number theorem.
Theorem 15.11 (Euler’s Pentagonal Number Theorem, 1750).
∞
Y
n=1
(1 −xn) =
∞
X
k=−∞
(−1)kxk(3k−1)/2
From the relation
1 =
∞
X
n=0
p(n)xn
∞
Y
n=1
(1 −xn),
we obtain a fast recurrence formula for partition numbers.

118
Pearls of Discrete Mathematics
Corollary 15.12.
p(0) = 1
p(n) = p(n −1) + p(n −2) −p(n −5) −p(n −7) + p(n −12) + p(n −15) −· · ·
The formula in the recurrence relation consists of all partition numbers
p(n−m), where m is a generalized pentagonal number such that n−m ≥0.
These terms occur in pairs with the same sign, one pentagonal and the other
pseudopentagonal. The signs of the pairs alternate, with the positive signs
occurring when k is odd and the negative signs when k is even, where m is
a kth generalized pentagonal number.
Example 15.13. Find p(10) using the above recurrence formula.
Solution: We have
p(1) = 1
p(2) = p(1) + p(0) = 1 + 1 = 2
p(3) = p(2) + p(1) = 2 + 1 = 3
p(4) = p(3) + p(2) = 3 + 2 = 5
p(5) = p(4) + p(3) −p(0) = 5 + 3 −1 = 7
p(6) = p(5) + p(4) −p(1) = 7 + 5 −1 = 11
p(7) = p(6) + p(5) −p(2) −p(0) = 11 + 7 −2 −1 = 15
p(8) = p(7) + p(6) −p(3) −p(1) = 15 + 11 −3 −1 = 22
p(9) = p(8) + p(7) −p(4) −p(2) = 22 + 15 −5 −2 = 30
p(10) = p(9) + p(8) −p(5) −p(3) = 30 + 22 −7 −3 = 42.
These values agree with Table 15.2.
■
With a computer, we can use the recurrence relation from Euler’s pen-
tagonal number theorem to compute p(n) for large n. For example,
p(1000) = 24061467864032622473692149727991 .= 2.4 × 1031.
The asymptotic formula of Hardy and Ramanujan gives an estimate ap-
proximately 1.014 times this number.

15 Partitions of an Integer
119
Exercises
1. List the partitions of 5, 6, and 7.
32. Implement recurrence formulas to calculate p(n, k) and p(n).
⋆3. Find formulas for p(n, 1), p(n, 2), and p(n, 3). Conjecture an asymp-
totic estimate for p(n, k) with k ﬁxed.
34. Use a computer to verify Theorem 15.2 for 0 ≤n ≤20.
†5. Prove Theorem 15.2.
6. Prove Proposition 15.5.
7. Prove Proposition 15.6 by describing a one-to-one correspondence be-
tween partitions of n into odd parts and partitions of n into distinct
parts.
8. Denote by p(n | even # of parts) and p(n | odd # of parts) the num-
ber of partitions of n into an even number of parts and into an odd
number of parts, respectively. Denote by p(n | distinct odd parts) the
number of partitions of n with distinct odd parts. Let ˜p(n) be the
number of self-conjugate partitions of n. Prove that
˜p(n) = p(n | distinct odd parts)
= (−1)n(p(n | even # of parts) −p(n | odd # of parts)).
9. Show that the number of partitions of n in which no part occurs
exactly once is the same as the number of partitions of n in which
none of the parts is congruent to 1 or 5 modulo 6.
10. Prove that the two sequences of generalized pentagonal numbers have
no elements in common.
11. Prove that every pentagonal number is 1/3 of a triangular number,
i.e., a number of the form 1 + 2 + 3 + · · · + n = n(n + 1)/2.
12. Show the correspondence in Proposition 15.9 for the partitions with
distinct parts of n = 10 (not a generalized pentagonal number).
313. Use the recurrence relation from Euler’s pentagonal number theorem
to compute p(1000).


Part VI
Information Theory
121


Chapter 16
What Is Surprise?
The memory feat of reciting the order of a shuﬄed deck of 52 cards is worth
about 223 bits.
The subject of information theory, of which entropy is the central con-
cept, was born in 1948 when Claude E. Shannon (1914–2001) published
his landmark paper [Sha48] on information sources and channels. The ﬁeld
has since borne many beautiful results both pure and applied. Information
theory is the practical motivation for error-correcting codes.
To introduce this topic, let’s begin by considering some memory feats.
Suppose that you take a deck of 52 cards, shuﬄe it, turn each card face
up brieﬂy, and then turn it face down again. Suppose that after you have
seen every card you can recite the entire sequence of cards in order. (This
memory stunt is within the range of most people, with practice.) Now,
suppose that your friend has a diﬀerent memory feat. She can memorize a
string of 100 digits that you read at random from, say, a telephone book.
After she has heard the digits, she can recite them back in order. These
are two impressive memory feats, but which one is better? Can we put a
measure on these stunts, or are we just trying to equate apples and oranges?
It turns out that we can measure these memory feats and the measure-
ment is the key ingredient for the concept of mathematical surprise. There
are 52! diﬀerent ways to order a deck of 52 cards. Let’s denote the “value”
of memorizing a deck of cards in order as 52!. This number is gigantic:
52! =8065817517094387857166063685640376
6975289505440883277824000000000000.
In fact, having 68 digits, this number is between 1067 and 1068. Regarding
the other memory stunt, memorizing 100 digits, there are 10100 diﬀerent
strings of 100 digits, so let’s say that the value of this feat is 10100. Thus,
the digit-memorizing feat is far better than the card-memorizing feat.
Our measure for the memory feats is simply the number of possible
outcomes of the events in question. If S is the set of possible outcomes,
and we are able to produce (e.g., memorize) one of them, then we have
123

124
Pearls of Discrete Mathematics
given the value of |S| to that feat. Similar calculations hold for probability
spaces. If the sample space (set of possible outcomes) of an event is S, and
all simple events are equally likely, then the probability that a particular
outcome occurs is p = 1/|S|. According to our deﬁnition, the value assigned
to this outcome is 1/p.
Various synonyms describe the quantity that we are deﬁning. This quan-
tity is referred to as “surprise,” “information,” and “uncertainty.” Typi-
cally, we normalize our quantity by taking a logarithm base 2. Suppose
that E is an event that occurs with probability p > 0. If we learn with
certainty that E has occurred, then we say that we have received
I(p) = log2(1/p) = −log2 p
bits of information. The reason for the base 2 is that this is the number of
bits it takes to represent the value in binary.
Example 16.1. What is the amount of surprise, in bits, of the memory
stunt of reciting the order of a shuﬄed deck of 52 cards?
Solution: The value of the stunt is log2(52!) .= 223 bits.
■
We justify the deﬁnition of surprise by observing that I, a function
from (0, 1] into R+ ∪{0}, has three properties that can be interpreted as
common-sense statements about information.
(1) I(p) ≥0 for all p ∈(0, 1].
Interpretation: Suppose that E is an event that occurs with probability p.
If we learn that E has occurred, then we certainly have not lost information.
(2) I(p) is a continuous function of p.
Interpretation: If the likelihood of E varies slightly, then the information
associated with E varies only slightly.
(3) I(pq) = I(p) + I(q) for all p, q.
Interpretation: Suppose that E and F are independent events with Pr(E) =
p, Pr(F ) = q, and Pr(EF ) = pq. If we already know that E has occurred
and we are told that F occurs, then the new information obtained is I(q) =
I(pq) −I(p).
Theorem 16.2. If I is a function from (0, 1] into R satisfying the properties
(1), (2), and (3) above, then I(p) = −C log2 p, where C is an arbitrary
positive number.
Proof. Let p ∈(0, 1]. From the property (3), I(p2) = I(p) + I(p) = 2I(p),
and, by mathematical induction, I(pm) = mI(p) for all positive integers
m. Similarly, I(p) = I(p1/n · · · · · p1/n) = nI(p1/n), and hence I(p1/n) =
(1/n)I(p) for all integers n.
These observations imply that I(pm/n) =
(m/n)I(p).
Hence, by (2), I(px) = xI(p) for all positive real numbers
x. Therefore I(p) = I((1/2)−log2 p) = −I(1/2) log2 p = −C log2 p, where
C = I(1/2). By (1), C must be positive.
■

16 What Is Surprise?
125
For convenience, we take C = 1, so that I(p) = −log2 p.
Here are two immediate consequences of the formula for I(p):
(1) I(1)=0.
Interpretation: If an event E occurs with probability 1 and we are told that
E occurs, then we have gained no information.
(2) I(p) is a strictly decreasing function of p; that is, p < q implies that
I(p) > I(q).
Interpretation: If an event E is less likely than an event F , then we receive
more information if we are told that E occurs than if we are told that F
occurs.
Shannon’s seminal idea in information theory is to associate an amount
of information, or entropy, with an information source. Now that we have
deﬁned a function that measures the uncertainty (also called surprise or
information) of an event, we will proceed to show how to deﬁne the entropy
of an information source.
A source S is a sequence of random variables X1, X2, X3, . . . with com-
mon range {x1, . . ., xn}.
Such a sequence is also called a discrete-time,
discrete-valued stochastic process.
(“Stochastic” comes from the Greek
word stokhastikos, meaning “capable of aiming, conjectural,” and here we
are forming conjectures about the source from values of some of its terms.)
The elements xi are called states or symbols, and we think of S as emitting
these symbols at regular intervals of time, as in Figure 16.1.
S
−→x5, x1, x2, x2, x5, x3, x1, . . .
FIGURE 16.1: A source.
In a discrete memoryless source (DMS), also called a zero-memory
source, the random variables Xi are independent and identically distributed.
Suppose that the Xi are distributed as X, a random variable that takes
values x1, . . . , xn with probabilities p1, . . . , pn, respectively, where each
pi ≥0 and Pn
i=1 pi = 1. As a random variable, X is a function from N
into {x1, . . ., xn}, and Pr{X(i) = xj} = pj, for all i ≥1 and 1 ≤j ≤n.
The sequence X1, X2, X3, . . . , called a sampling of X, represents a process
that repeatedly selects values of X. If S is a discrete memoryless source,
we write
S =

x1
x2
. . .
xn
p1
p2
. . .
pn

.

126
Pearls of Discrete Mathematics
Given our formula for I, we can say that when S emits the symbol xi,
we receive I(pi) = −log2 pi bits of information. Since xi is emitted with
probability pi, the average amount of information obtained per symbol is
H(S) =
n
X
i=1
piI(pi) = −
n
X
i=1
pi log2 pi bits.
We call H(S) the entropy of the source S. The concept of entropy was
introduced by Ludwig Boltzmann (1844–1906) in 1896, but Shannon was
the ﬁrst to apply it to information sources.
We will usually not mention the units (“bits”) when referring to in-
formation or entropy. We will sometimes suppress the index in the sigma
notation. Also, we write log for log2 and set 0 log0 = limx→0+ x log x = 0.
Note that H is a continuous function of the pi. Some other properties
of H will be demonstrated in the following discussion.
Example 16.3. Suppose that a source S is given by
S =
 x1
x2
x3
x4
1/2
1/4
1/8
1/8

.
What is the entropy of S?
Solution: The entropy of S is
H(S) = −1
2 log 1
2 −1
4 log 1
4 −1
8 log 1
8 −1
8 log 1
8 = 1
2 + 2
4 + 3
8 + 3
8 = 7
4.
■
Sources consisting of only two states are particularly important. Let S
be the source with states x1 and x2, occurring with probabilities p and q,
respectively:
S =
 x1
x2
p
q

.
The entropy of S is H(S) = −p log p −q log q. Deliberately over-using the
symbol H, we denote this expression by H(p). Figure 16.2 shows the graph
of this function.
Here is a technical lemma that will be used three times in the upcoming
proofs of facts about entropy.
Lemma 16.4 (Convexity of the Logarithm Function). Let p1, . . . , pn and
q1, . . . , qn be nonnegative real numbers with Pn
i=1 pi = Pn
i=1 qi = 1. Then
−
n
X
i=1
pi log pi ≤−
n
X
i=1
pi log qi,
with equality if and only if pi = qi for all i.

16 What Is Surprise?
127
r
(0, 0)
r
(1, 0)
r
(0.5, 1)
p
H(p)
FIGURE 16.2: The entropy function H(p).
Proof. There is no contribution to the summations from any pi = 0, so we
discard these values. If any of the remaining qi are 0, then the inequality
holds, so we may assume that no qi is 0. Now we obtain
X
pi log qi −
X
pi log pi
=
X
pi(logqi −log pi)
=
X
pi log(qi/pi)
≤
X
pi(qi/pi −1)
=
X
qi −
X
pi
=
X
qi −1
≤
0.
The ﬁrst inequality follows from the fact that log x ≤x −1 for x ∈R+.
Equality occurs if and only if x = 1, i.e., when pi = qi for all i.
■
We next consider two extreme types of sources.
A source is uniform if every state has the same likelihood of occurring.
The uniform source with n states is
S =
 x1
. . .
xi
. . .
xn
1/n
. . .
1/n
. . .
1/n

.
It has entropy −Pn
i=1(1/n) log(1/n) = log n.
A source is singular if pi = 1 for some i. The singular source with n
states is
S =

x1
. . .
xi−1
xi
xi+1
. . .
xn
0
. . .
0
1
0
. . .
0

.

128
Pearls of Discrete Mathematics
It has entropy 0, since 0 log 0 = 1 log1 = 0. A singular source conveys no
information.
Theorem 16.5. Let S be a source with n states. Then 0 ≤H(S) ≤log n,
with the lower bound attained if and only if S is singular and the upper
bound attained if and only if S is uniform.
Proof. To establish the lower bound, we note that pi log pi > 0 if pi ∈(0, 1).
Therefore H(S) > 0 unless each pi = 0 or 1, in which case S is singular
and H(S) = 0, as stated above.
We now prove the upper bound.
H(S)
=
−
X
pi log pi
≤
−
X
pi log 1
n
(by Lemma 16.4)
=
−log 1
n
X
pi
=
log n.
According to Lemma 16.4, equality occurs if and only if pi = 1/n for all i,
i.e., the source is uniform.
■
Although the remaining discussion will focus on discrete memoryless
sources, let us say a few words about a more sophisticated source called a
Markov source.
One everyday example of a source is a person speaking or writing En-
glish. The DMS model that we have discussed allows us to make a simplistic
calculation of the entropy of the English language. Based on a memoryless
source of 27 characters (26 letters and a space), the DMS model yields an
entropy value of about 4 (each revealed character conveys 4 bits of infor-
mation). But the model is too simplistic. If past characters are used to
predict future ones (the source has a memory), then the calculated entropy
of English decreases to a number believed to be between 0.5 and 1.5.
One model that takes into account past symbols is called a Markov
source. For realistic computations, we use an mth order Markov source, i.e.,
a source in which the probability that a given symbol is emitted depends
on the previous m symbols. Formally, an mth order Markov source (or
Markov chain) consists of an alphabet A = {x1, . . ., xn} and the values of
conditional probabilities (also called transitional probabilities)
Pr(xi : xj1, . . ., xjm),
for i = 1, . . . , n and (j1, . . ., jm) ∈[n]m. We say that m consecutive sym-
bols of an mth order Markov source constitute a state of the source. Since

16 What Is Surprise?
129
S contains n symbols, the source has nm states, and these may be repre-
sented in a state diagram as in the next example.
Example 16.6. Let S be a ﬁrst-order Markov source with alphabet A =
{a, b} and conditional probabilities Pr(a : a) = 0.6, Pr(b : b) = 0.6, Pr(b :
a) = 0.4, and Pr(a : b) = 0.4. Show the state diagram of this source.
Solution: The state diagram of the source is shown in Figure 16.3.
&%
'$
i
6
0.6
&%
'$
i?0.6
a
b
-

0.4
0.4
FIGURE 16.3: A ﬁrst-order Markov source.
■
An mth order Markov source can always be encoded as a ﬁrst-order
Markov source (take the symbols of the new source to be m-tuples of the
old symbols). Let us calculate the entropy of a ﬁrst-order Markov source.
If the source is in state xi, then the information obtained when the symbol
xj occurs is
I(xj : xi) = −logPr(xj : xi).
Therefore the average amount of information conveyed when a state is
revealed after xi is
H(S : xi) = −
X
A
Pr(xj : xi) log Pr(xj : xi).
This means that the entropy of the source is
H(S) = −
X
A2
Pr(xi) Pr(xj : xi) logPr(xj : xi).
Example 16.7. What is the entropy of the source S in the previous ex-
ample?

130
Pearls of Discrete Mathematics
Solution: First, we ﬁnd the steady-state probabilities Pr(a) and Pr(b). Al-
though we could solve the system of equations
Pr(a) + Pr(b) = 1
Pr(a) = 0.6 Pr(a) + 0.4 Pr(b)
Pr(b) = 0.4 Pr(a) + 0.6 Pr(b),
it is easier to note that, by symmetry, Pr(a) = Pr(b) = 0.5. Next, we
calculate
H(S)
=
−0.5 · (0.6 log0.6) −0.5 · (0.4 log0.4)
−0.5 · (0.6 log0.6) −0.5 · (0.4 log0.4)
.=
0.970951.
Notice that the entropy of this source is less than 1. By comparison, a mem-
oryless source (i.e., a zero-order Markov source) that takes values a and b
with equal probabilities has entropy equal to 1. The ﬁrst-order Markov
source has lower entropy than the memoryless source because knowledge of
previous symbols reduces uncertainty. To put it into a common-place set-
ting, let a stand for “fair day” and b stand for “foul day.” Then the Markov
source is a very simplistic model of weather, in which current weather is
somewhat inﬂuenced by the previous day’s weather. Although in the long
run the model says that the weather is fair half of the days and foul half
of the days, the uncertainty in the weather is less than it would be if the
current weather had no relation to the previous day’s weather.
■
Exercises
1. A memory performer memorizes and recites the order of two decks
of cards shuﬄed together. What is the information content of this
stunt?
32. Another memory performer can recite a string of 100 arbitrary letters.
Does this feat, or the one in the previous exercise, have a greater
value?
3. Professor Bumble says that if told a digit (0 through 9) and a letter
(A through Z), he can recite them back, but not always in the order
given. What is his stunt worth in bits?

16 What Is Surprise?
131
4. If an event occurs with probability 2−10, and we learn that the event
occurs, how many bits of information do we receive? If we learn that
the event does not occur, how many bits of information do we receive?
5. Two dice are rolled and you are told that their total is 9. If you are
then told that both dice show an even number, how much additional
information is this?
6. Prove that I(pq) = I(p) + I(q), for all 0 ≤p, q ≤1.
7. Consider a source with states a, b, c, d, e, f, with probabilities 1/2,
1/4, 1/8, 1/16, 1/32, and 1/32 (respectively). Find the entropy.
8. Consider a source with states a, b, c, d, with probabilities 1/3, 1/3,
1/6, 1/6 (respectively). Find the entropy.
9. Give an example of a source with ﬁve states and entropy 15/8 bits.
10. What is the minimum number of states in a source with entropy 10
bits?
11. Let S be a source with states x1, x2, . . . , xn, with probabilities p1, p2,
. . . , pn (respectively). Let T be a source with states x1, x2, . . . , xn,
xn+1, with probabilities 1
2p1, 1
2p2, . . . , 1
2pn, 1
2 (respectively). Find a
formula for the entropy of T in terms of the entropy of S.
12. Suppose that
S =
 x1
x2
α
β

,
with α + β = 1 and α, β ≥0. Use calculus to show that H(S) is
maximized when α = β = 0.5.
13. Professor Bumble has a class in which he sometimes gives pop quizzes.
If he gives a pop quiz one day, there is a 2/5 chance that he will give
a pop quiz the next day. If he does not give a pop quiz one day, there
is a 2/5 chance that he will not give a pop quiz the next day. At the
beginning of class, a student remarks that he knows that there will
be a pop quiz today. If this is true, how much information is it?
14. Let S be a ﬁrst-order Markov source with alphabet A = {a, b, c} and
conditional probabilities Pr(a : a) = Pr(b : b) = Pr(c : c) = 0.1,
Pr(b : a) = Pr(c : b) = Pr(a : c) = 0.7, and Pr(a : b) = Pr(b : c) =
Pr(c : a) = 0.2. Find H(S).
15. If the Markov source of the previous exercise is changed so that Pr(b :
a) = Pr(c : b) = Pr(a : c) = Pr(a : b) = Pr(b : c) = Pr(c : a) = 0.45,
will the entropy increase or decrease? Give a common sense argument
rather than a calculation.

132
Pearls of Discrete Mathematics
16. Let S be a ﬁrst-order Markov source with alphabet A = {a, b} and
conditional probabilities Pr(a : a) = Pr(b : b) = 0.1 and Pr(b : a) =
Pr(a : b) = 0.9. Let T be a ﬁrst-order Markov source with alphabet
A = {a, b} and conditional probabilities Pr(a : a) = Pr(b : b) = 0.9
and Pr(b : a) = Pr(a : b) = 0.1. Let U be a ﬁrst-order Markov source
with alphabet A = {a, b} and conditional probabilities Pr(a : a) =
Pr(a : b) = 0.9 and Pr(b : b) = Pr(b : a) = 0.1. Find the entropies of
S, T, and U.
17. Select a page of text in English and calculate its entropy as a mem-
oryless source. Assume that there are only 26 possible symbols, the
letters of the alphabet.

Chapter 17
A Coin-Tossing Game
We play a game in which we are given a biased coin with probability 0.53
of landing heads and probability 0.47 of landing tails. We start the game
with $1 and once a day, every day, we may bet any fraction of our current
amount on the event that the coin lands heads. If the coin lands heads, we
win an even money payoﬀ; if the coin lands tails, we lose the amount bet.
If we lose all of our money, the game is over. What fraction of our current
amount should we bet every day to maximize our long-term proﬁt?
Let’s solve the above problem in general, where the coin lands heads with
probability p and tails with probability q, with p+q = 1 and p > q > 0. The
following analysis was demonstrated in 1956 by John L. Kelly Jr. (1923–
1965) [Kel56].
We shouldn’t wager all of our current amount at any time, because we
could lose and not be able to continue playing. Of course, it doesn’t make
sense to bet on the coin landing tails (even if we could) because the coin is
biased toward heads. However, let’s imagine the possibility of placing bets
on heads and tails.
If we divide our entire fortune on the two types of bets, some of the bets
will cancel out. A hunch is that we should bet p of our current amount on
heads and q of our current amount on tails. In this case, q of the bets will
cancel out, leaving a remainder of p −q of our amount bet on heads. This
is equivalent to betting p −q of our amount on heads and nothing on tails.
With p = 0.53, we would bet 0.53 −0.47 = 0.06 of our current amount on
heads.
Let’s prove that the hunch results in the maximum long-term proﬁt.
Over n days, the expected number of heads is pn and the expected number
of tails is qn. Suppose that we bet λ1 of our amount on heads and λ2 of
our amount on tails, where λ1 + λ2 = 1. We wish to show that the best
choice is λ1 = p and λ2 = q. Each occurrence of heads yields a return of
2λ1 of our amount, while each occurrence of tails yields a return of 2λ2 of
our amount. Hence, after n days, our expected amount is
(2λ1)np(2λ2)nq.
133

134
Pearls of Discrete Mathematics
-
XXXXXXXXXXXXXXXXXXz
-
:
1
0
1
0
p
p
q
q
FIGURE 17.1: The Binary Symmetric Channel (BSC).
We write this expression as an exponential function,
2cn,
where
c = 1 + p log λ1 + q log λ2,
and logarithms are base 2.
The hunch is that c, the coeﬃcient of growth, is maximized when λ1 = p
and λ2 = q. From Lemma 16.4 (convexity of the log function),
c ≤1 + p log p + q log q,
with equality if and only if λ1 = p and λ2 = q. Therefore, the optimal
strategy is to consistently bet p −q of our current amount.
With p = 0.53, the maximum coeﬃcient of growth is c .= 0.00259841.
At this growth rate, it would take about 21 years of steadily playing the
game (with the optimal strategy) to go from $1 to $1,000,000.
In information theory, the expression
c = 1 + p log p + q log q
is known as the channel capacity of a binary symmetric channel.
The
channel capacity measures the rate at which information can be reliably
sent over a noisy channel.
In a binary symmetric channel (BSC), each binary symbol, 0 and 1,
is sent accurately over a channel with probability p and inaccurately with
probability q = 1 −p. See Figure 17.1.
The capacity c(p) of a BSC is deﬁned as
c(p) = 1 −H(p) = 1 + p log p + q log q.
The graph of the capacity function c(p) is shown in Figure 17.2. Observe
that the capacity function is an “upside-down” version of the entropy func-
tion (compare with Figure 16.2).

17 A Coin-Tossing Game
135
s
(0, 1)
s
(0.5, 0)
s (1, 1)
p
c(p)
FIGURE 17.2: The capacity function c(p).
We see from Figure 17.2 that c(0.5) = 0, i.e., a completely random
channel cannot convey any information, and c(0) = c(1) = 1, i.e., a channel
that is completely accurate or completely inaccurate can convey information
perfectly.
Shannon’s second theorem of information theory (which we will see in
Chapter 18) states that information can be sent (using an error-correcting
code) over a BSC with arbitrarily high accuracy at any rate below the chan-
nel capacity.
We have found the optimal fraction of our amount to bet in the coin-
tossing game. Let’s analyze the game further to ﬁnd the failure threshold,
that is, the smallest fraction which, when bet consistently, will result in
long-term ruin.
Suppose that we start with $1 and on each day we bet some fraction λ,
0 < λ < 1, of our current holdings. Each investment has an even money
payoﬀ, with probability of success p and failure q = 1 −p. Let Xn be our
amount after the nth coin toss.
Let’s suppose that in n coin tosses we obtain s heads (successes) and f
tails (failures), where s + f = n. Then
Xn = (1 + λ)s(1 −λ)f.
The expected values of s and f are np and nq, respectively. Hence, the
expected value of Xn is
(1 + λ)pn(1 −λ)qn = 2g(λ)n,
where
g(λ) = p log(1 + λ) + q log(1 −λ).
Logarithms are base 2. We call g(λ) the growth rate function.

136
Pearls of Discrete Mathematics
To ﬁnd the optimal value of λ, we set the derivative g′ equal to 0. Thus
g′ =
p
(1 + λ) ln 2 −
q
(1 + λ) ln 2 = 0,
which implies that
p(1 −λ) −q(1 + λ) = 0.
Hence, the optimal value of λ, call it λ∗, is given by λ∗= λ∗(p + q) = p −q
(we already knew this). Furthermore,
g′′ =
−p
(1 + λ)2 ln 2 +
−q
(1 −λ)2 ln2 < 0.
We ﬁnd that g is a concave downward function of λ, with one maximum and
one point, λ0, where the function crosses the horizontal axis (the critical
value). See Figure 17.3.
s
(0, 0)
s
g(λ∗)
λ∗
s critical value
λ0
AAU
FIGURE 17.3: The growth rate function g(λ).
In our original example, p = 0.53, q = 0.47, and λ∗= p −q = 0.06.
As we have said, the best strategy is to consistently bet 6 per cent of our
current amount. In this case, the coeﬃcient of growth is approximately
0.00259841. The critical value is λ0 .= 0.12. If we consistently wager more
than λ0, then we are on the road to ruin.

17 A Coin-Tossing Game
137
Exercises
31. In the coin-tossing game, given a coin with probability 0.51 of landing
heads, what is the optimal fraction to bet? How long would it take (on
average) to go from $1 to $1,000,000, following the optimal strategy?
32. In the game of the previous exercise, what is the smallest fraction
that leads to ruin?
33. In the coin-tossing game, given a coin with probability 0.9 of landing
heads, what is the optimal fraction to bet? How long would it take (on
average) to go from $1 to $1,000,000, following the optimal strategy?
34. In the game of the previous exercise, what is the smallest fraction
that leads to ruin?
5. Suppose that there are three outcomes, A, B, and C, with proba-
bilities p, q, and r, respectively. Suppose that these outcomes give
payoﬀs of x, y, and z, per unit bet, respectively. How much of our
current amount should be bet on each outcome?
†⋆6. Generalize the result of the previous exercise.
7. What is the capacity of a BSC with p = 0.75? What is the capacity
if p = 0.25?
8. If three symbols are sent over a BSC with p = 0.9, what is the prob-
ability that two or three of the symbols are received correctly?


Chapter 18
Shannon’s Theorems
The average length of a source code is at least equal to the entropy of the
source.
Information can be reliably sent over a noisy channel at any rate below the
channel capacity.
A code C for a source with n states is a sequence w1, . . . , wn of binary
strings, none the preﬁx of another. The wi are the words of the code. We
may now write our source as


x1
x2
. . .
xn
p1
p2
. . .
pn
w1
w2
. . .
wn

.
The length li of a code word wi is the number of bits in wi.
The following pivotal result is credited to Leon G. Kraft Jr.
Theorem 18.1 (Kraft’s Inequality, 1949). A source with n states has a
code with word lengths l1, . . . , ln if and only if
n
X
i=1
2−li ≤1.
Proof. Let l be the maximum of the li. Then a word of length li in the code
prevents 2l−li binary strings of length l from being code words (because of
the “no preﬁx” rule).
Therefore, the encoding is possible if and only if
Pn
i=1 2l−li ≤2l, i.e., Pn
i=1 2−li ≤1.
■
Example 18.2. Verify Kraft’s inequality for the code


x1
x2
x3
1/2
1/4
1/4
0
10
11

.
139

140
Pearls of Discrete Mathematics
Solution: Note that none of the code words is a preﬁx of another (so the
code is legitimate). We have
n
X
i=1
2−li = 1
2 + 1
4 + 1
4 = 1 ≤1.
■
The average length of the code C is l = Pn
i=1 pili. This quantity is the
average number of code symbols per source symbol.
Example 18.3. Find the average length of the code of the previous exam-
ple.
Solution: We have
l = 1
2 · 1 + 1
4 · 2 + 1
4 · 2 = 3
2.
■
Shannon’s seminal result in noiseless coding theory says that the average
length of a code is at least equal to the entropy of the source.
Theorem 18.4 (Shannon’s First Theorem, 1948). The average length l of
a code for a source S satisﬁes l ≥H(S).
Proof.
l
=
X
pili
≥
X
pili + log
X
2−li
(by Theorem 18.1)
=
X
pili +
X
pi log
X
2−li
=
−
X
pi log
 2−li
P 2−li

≥
−
X
pi log pi
(by Lemma 16.4)
=
H(S)
The second inequality follows from Lemma 16.4, since
n
X
i=1
2−li
Pn
i=1 2−li = 1.
■

18 Shannon’s Theorems
141
Example 18.5. Verify Shannon’s ﬁrst theorem for the code of the previous
example.
Solution: We calculated that l = 3/2. The entropy of the code is
H(S) = −1
2 log 1
2 −1
4 log 1
4 −1
4 log 1
4 = 3
2.
So, in this case, the average length and the entropy are equal.
■
As we have said, Shannon’s theorem asserts that the entropy of a source
is a lower bound for the average number of code symbols needed to encode
each source symbol. In fact, the lower bound is nearly achievable.
Theorem 18.6. Given a source S, there exists a code for S with average
length less than H(S) + 1.
Proof. Suppose that the source has n symbols which occur with probabili-
ties p1, . . . , pn. For 1 ≤i ≤n, deﬁne li to be the integer for which
−log pi ≤li < −log pi + 1.
Then
n
X
i=1
2−li ≤
n
X
i=1
2log pi =
n
X
i=1
pi = 1.
By the Kraft inequality, we can encode S with strings of lengths l1, . . . , ln.
Moreover, the average length of the code, l, satisﬁes
l <
n
X
i=1
(−log pi + 1)pi = H(S) + 1.
■
Example 18.7. Let
S =
 x1
x2
x3
x4
x5
x6
x7
x8
0.2
0.2
0.1
0.1
0.1
0.1
0.1
0.1

.
What is the entropy of this source? Find a code for this source that has
average length within 1 bit of the entropy.
Solution: We have H(S) = 2(−0.2 log0.2) + 6(−0.1 log0.1) .= 2.9. Accord-
ing to Theorem 18.4, we can ﬁnd a code for S within 1 bit of this quantity.
Following the proof of the theorem, we take the code lengths to be l1, l2,
l3, l4, l5, l6, l7, l8, where
−log 0.2 ≤l1, l2 < −log 0.2 + 1,

142
Pearls of Discrete Mathematics
−log 0.1 ≤l3, l4, l5, l6, l7, l8 < −log 0.1 + 1.
Thus l1 = l2 = 3 and l3 = l4 = l5 = l6 = l7 = l8 = 4. These choices give an
average code length of 2(0.2 · 3) + 6(0.1 · 4) = 3.6. In fact, a suitable code
is given by


x1
x2
x3
x4
x5
x6
x7
x8
0.2
0.2
0.1
0.1
0.1
0.1
0.1
0.1
100
101
0000
0001
0010
0011
0100
0101

.
■
For sources X and Y , with
X =
 x1
x2
. . .
xm
p1
p2
. . .
pm

and
Y =
 y1
y2
. . .
yn
q1
q2
. . .
qn

,
we deﬁne the product source XY as
XY =
 (xi, yj)
piqj

,
where i = 1, . . . , m and j = 1, . . . , n.
Proposition 18.8. Given any two sources X and Y , we have
H(XY ) = H(X) + H(Y ).
Proof.
H(XY )
=
−
m
X
i=1
n
X
j=1
piqj log piqj
=
−
m
X
i=1
n
X
j=1
piqj log pi −
m
X
i=1
n
X
j=1
piqj log qj
=
−
m
X
i=1
pi log pi
n
X
j=1
qj −
m
X
i=1
pi
n
X
j=1
qj log qj
=
H(X) + H(Y )
■

18 Shannon’s Theorems
143
The nth product of a source S with itself, written Sn, is called the nth
extension of S.
Corollary 18.9. Given a source S and any integer n ≥1, we have
H(Sn) = nH(S).
Corollary 18.10. There is a sequence of codes for Sn with average lengths
ln satisfying
lim
n→∞
ln
n = H(S).
Proof. By Theorems 18.4 and 18.6, there exists a code with
H(Sn) ≤ln < H(Sn) + 1.
By Corollary 18.9, we have nH(S) ≤ln < nH(S) + 1, i.e.,
H(S) ≤ln/n < H(S) + 1/n.
Letting n →∞, the conclusion follows.
■
This result says that, in the limit, the entropy of a source is equal to
the number of bits needed to encode its states.
A channel (X, Y ) consists of an input alphabet X = {x1, x2, . . ., xm},
an output alphabet Y = {y1, y2, . . ., yn}, and conditional probabilities pij =
p(yj|xi), for 1 ≤i ≤m, 1 ≤j ≤n. The conditional probability p(yj|xi)
is the probability that the output symbol yj is received when the input
symbol xi is sent. We represent the channel as
Y
y1
. . .
yn
q1
. . .
qn
X
x1
p1
...
...
p(yj|xi)
xm
pm
or by a matrix of conditional probabilities:


p11
. . .
p1n
...
...
pm1
. . .
pmn

.
What we have deﬁned as a channel is usually called a discrete memoryless
channel (DMC). “Memoryless” means that the appearance of a symbol has

144
Pearls of Discrete Mathematics
message
-
encoded
message
-
noise
?
received
message
-
decoded
message
FIGURE 18.1: A communication model.
no bearing on the probability distribution of future symbols. The commu-
nication model in Figure 18.1 includes a channel of information from an
encoded message to a received message.
Given a channel (X, Y ), various entropies are deﬁned:
1. Input entropy:
H(X) = −
m
X
i=1
pi log pi;
2. Output entropy:
H(Y ) = −
n
X
j=1
qj log qj;
3. Conditional entropy or equivocation:
H(X|Y ) = −
m
X
i=1
n
X
j=1
p(xi, yj) log p(xi|yj)
and
H(Y |X) = −
m
X
i=1
n
X
j=1
p(xi, yj) log p(yj|xi);
4. Total entropy:
H(X, Y ) = −
m
X
i=1
n
X
j=1
p(xi, yj) log p(xi, yj);
5. Mutual information:
I(X, Y ) = H(X) −H(X|Y ).
Figure 18.2 indicates the relationships among the various entropies. By

18 Shannon’s Theorems
145
H(X)
H(Y)
I(X,Y)
H(X|Y)
H(Y|X)
H(X,Y)
FIGURE 18.2: The entropies associated with a channel.
analogy with a priori and a posteriori probabilities, H(X) and H(X|Y )
are called a priori entropy and a posteriori entropy, respectively.
We now explain the deﬁnition of H(X|Y ). Suppose that Y is observed
to equal yj. Then the amount of uncertainty in X is
H(X|Y = yj) = −
m
X
i=1
p(xi|yj) log p(xi|yj).
Hence the average amount of uncertainty that remains in X when Y is
observed is
H(X|Y )
=
n
X
j=1
H(X|Y = yj)qj
=
−
m
X
i=1
n
X
j=1
p(xi|yj)qj log p(xi|yj)
=
−
m
X
i=1
n
X
j=1
p(xi, yj) log p(xi|yj).
Therefore, we may think of H(X|Y ) as the amount of information lost in
the channel. This is consistent with the following theorem.
Theorem 18.11. Given any channel (X, Y ), we have
H(X, Y ) = H(Y ) + H(X|Y ).

146
Pearls of Discrete Mathematics
Proof.
H(X, Y )
=
−
m
X
i=1
n
X
j=1
p(xi, yj) log p(xi, yj)
=
−
m
X
i=1
n
X
j=1
p(xi, yj)[logqj + log p(xi|yj)]
=
−
m
X
i=1
n
X
j=1
p(xi, yj) log qj −
m
X
i=1
n
X
j=1
p(xi, yj) log p(xi|yj)
=
−
n
X
j=1
qj log qj + H(X|Y )
=
H(Y ) + H(X|Y )
■
Similarly, H(X, Y ) = H(X) + H(Y |X).
It follows that I(X, Y ) =
H(Y ) −H(Y |X).
Theorem 18.12. Given any channel (X, Y ), we have
H(X, Y ) ≤H(X) + H(Y ).
Equality holds if and only if X and Y are independent.
Proof.
H(X, Y )
=
−
m
X
i=1
n
X
j=1
p(xi, yj) log p(xi, yj)
≤
−
m
X
i=1
n
X
j=1
p(xi, yj) log piqj
(by Lemma 16.4)
=
−
m
X
i=1
n
X
j=1
p(xi, yj) log pi −
m
X
i=1
n
X
j=1
p(xi, yj) log qj
=
H(X) + H(Y )
According to Lemma 16.4, equality occurs if and only if p(xi, yj) = piqj
for all i and j, i.e., when X and Y are independent.
■
Corollary 18.13. Given any channel (X, Y ), the following inequalities
hold:

18 Shannon’s Theorems
147
1. 0 ≤H(X|Y ) ≤H(X);
2. 0 ≤H(Y |X) ≤H(Y );
3. 0 ≤I(X, Y ).
The binary symmetric channel (BSC) is the channel in which X and Y
each have two symbols, 0 and 1, and the probability that a symbol is sent
accurately over the channel is independent of whether the symbol is a 0 or a
1. For deﬁniteness, let us suppose that each symbol is sent accurately with
probability p and inaccurately with probability q = 1 −p. See Figure 17.1.
The BSC is represented by the matrix

p
q
q
p

.
The matrix representation of BSCn is the nth Kronecker power of the BSC
matrix.
Given a channel from a source X to a source Y , we always have the
inequality
H(Y ) ≥H(X).
Intuitively, the channel only adds uncertainty to a source. More formally,
we can prove the inequality by noting that px + qy ≤y, where x ≤y.
The capacity c of a channel is deﬁned as the maximum mutual informa-
tion of the channel:
c = max
{pi} I(X, Y ).
We denote by c(p) the capacity of the binary symmetric channel BSC(p).
Theorem 18.14. The capacity c(p) is given by the formula
c(p) = 1 + p log p + q log q = 1 −H(p).
Proof. Suppose that 0 and 1 are transmitted with probabilities x and y,
respectively. We have
I(Y, X) = H(Y ) −H(Y |X) = H(Y ) −H(p) ≤1 −H(p),
with equality if x = y = 1/2. Hence
c(p) = 1 −H(p) = 1 + p log p + q log q.
■

148
Pearls of Discrete Mathematics
The capacity function c(p) is shown in Figure 17.2.
Seeing the entropy function H(p) occur in many of the above theorems,
and seeing the proofs of the theorems work out so perfectly, we begin to
appreciate that the entropy function, like the exponential and trigonomet-
ric functions, is a fundamental function of mathematics.
The rate of a code is a measure of the number of code words versus the
number of bits in the code words. Given a code C with all code words of
length n, we deﬁne the rate of C to be
r(C) = log2 |C|
n
.
Notice that r(C) = 1 if and only if C consists of all binary strings of
length n. Otherwise, r(C) is strictly less than 1.
Shannon’s second theorem asserts that we can send information over a
noisy channel with an arbitrarily high degree of accuracy, as long as the
rate is less than the channel capacity.
Theorem 18.15 (Shannon’s Second Theorem, 1948). Consider the binary
symmetric channel BSC with probability of error p < 1/2 and capacity
c = 1 −H(p). Let R < c and ϵ > 0. For suﬃciently large n, there exists a
subset of M ≥2Rn code words (to represent M equally probable messages)
from the set of 2n possible inputs to the BSC n such that the probability of
error (per word) is less than ϵ.
The code guaranteed by Shannon’s second theorem has rate
log2 M
n
≥log2 2Rn
n
= R.
Thus it is possible, by choosing n suﬃciently large, to reduce the maximum
probability of error to an amount as low as desired while at the same time
maintaining the transmission rate near the channel capacity.
Lemma 18.16. If n is a positive integer and 0 < x < 1/2, then
⌊nx⌋
X
k=0
n
k

< 2nH(x).

18 Shannon’s Theorems
149
Proof. Let y = 1 −x. Then
1 = (x + y)n
=
n
X
k=0
n
k

xkyn−k
>
⌊nx⌋
X
k=0
n
k

(x/y)kyn
>
⌊nx⌋
X
k=0
n
k

(x/y)nxyn
=
⌊nx⌋
X
k=0
n
k

xnxyny.
Therefore
⌊nx⌋
X
k=0
n
k

< x−nxy−ny = 2nH(x).
■
Proof of theorem. The proof uses the probabilistic method, in which the
existence of a desired object (a good code) is established by showing that
it exists with positive probability.
We establish some technical preliminaries. Choose R′ with R < R′ < c.
Let δ = ϵ/2. Choose ∆so that
R′ < 1 −H(p∆) = c(p∆) < c,
where p∆= p + ∆. See Figure 18.3.
The Hamming distance between two code words, named after Richard
Hamming (1915–1998), is the number of coordinates in which the words
diﬀer. The Hamming distance of a code is the minimum Hamming distance
between code words. Assume that the channel is a BSCn with probability
of error p, with n to be determined. Suppose that α is transmitted and
β is received.
The expected Hamming distance between α and β is np.
Consider a sphere T of radius np∆about β. Our decision procedure is as
follows: if there is a unique word in T, then we accept it. If there is no
code word in T, or more than one code word, then we concede an error.

150
Pearls of Discrete Mathematics
s
(0, 1)
s
(0.5, 0)
s (1, 1)
p
c
R′
R
p p∆
FIGURE 18.3: Ingredients for Shannon’s second theorem.
The probability of error is
Pr(error)
=
Pr(α ̸∈T) + Pr(α ∈T) Pr(α′ ∈T : α′ ̸= α)
≤
Pr(α ̸∈T) + Pr(α′ ∈T : α′ ̸= α)
≤
Pr(α ̸∈T) +
X
α′̸=α
Pr(α′ ∈T).
The second inequality is due to the subadditivity of probabilities (Bonfer-
roni inequalities).
It follows from the law of large numbers that, given ∆and δ, there exists
n0 such that
Pr
|X −np|
n
> ∆

< δ,
for n ≥n0. Hence, the probability that the number of errors, X, exceeds the
expected number of errors, np, by more than n∆is less than δ. Therefore,
we may make the ﬁrst term arbitrarily small (less than δ).
This argument for the ﬁrst term is independent of the M code words
chosen. However, the argument for the second term, P
α′̸=α Pr(α′ ∈T), is
not. Choose M with 2nR ≤M ≤2nR′. Suppose that M words are selected
randomly from the 2n possible words. There are 2nM possible codes, each
selected with probability 2−nM. Thus
Pr(error)
<
δ + (M −1)Pr(α′ ∈T)
(α′ ̸= α)
≤
δ + MPr(α′ ∈T),
where Pr denotes an average probability over all 2nM codes.

18 Shannon’s Theorems
151
Now Pr(α′ ∈T) = |T|/2n, where |T| = P⌊np∆⌋
k=0
 n
k

.
Therefore, by
Lemma 18.16, we have
Pr(error)
<
δ + M2−n2nH(p∆)
≤
δ + 2nR′−n+nH(p∆)
=
δ + 2n(R′−1+H(p∆))
=
δ + 2n(R′−c(p∆)).
The second term may be made less than δ for n ≥n1. Take n = max(n0, n1).
This makes the average probability of error, over all codes of size M, less
than ϵ. Therefore, there exists such a code.
■
According to Shannon’s second theorem, there is a trade-oﬀbetween
information rate and error-correcting capability of a code. The main goal
in the area of error-correcting codes is to produce codes with both high
information rate and high error-correcting capability.
Exercises
1. Encode a, b, c, d, e, f, g with binary strings (no string an extension
of another) with lengths 4, 4, 3, 3, 3, 2, 2.
2. Describe how to construct a code for n symbols with word lengths 1,
2, . . . n. If the corresponding words occur with probabilities 1/2, 1/4,
. . . , 1/2n, respectively, what is the average length of the code?
3. Find a binary code for S in Exercise 16.8 so that the average word
length is within one bit of H(S).
4. For the channel (X, Y ) given below, ﬁnd H(X), H(Y ), H(X, Y ),
H(X|Y ), H(Y |X), and I(X, Y ).
Y
y1
y2
5/8
3/8
X
x1
3/4
1/4
3/4
x2
1/4
1/8
7/8
5. Find the rate of the code {011, 101, 110}.

152
Pearls of Discrete Mathematics
6. In a triplicate code, each bit is sent over a BSC three times. What is
the rate of the triplicate code? If p = 0.9, what is the per information
bit error rate of the triplicate code?
7. Find a binary code with words of length 7 and rate 4/7.
†8. Show that if a binary code C consisting of strings of length n has
minimum Hamming distance d, then
|C| ≤
2n
P⌊(d−1)/2⌋
e=0
 n
e
.
This is known as the Hamming bound or sphere-packing bound. If
equality occurs, then we say that C is a perfect binary code.
9. Give an example of a perfect binary code of length 7.
⋆10. Suppose that k binary strings are randomly and independently chosen
from the set of binary strings of length n. If the chosen strings are
taken to be the words of a code, what is the expected minimum
Hamming distance of the code?

Part VII
Games
153


Chapter 19
A Little Graph Theory Background
In any group of six people, there are three all of whom know each other or
three none of whom know each other.
A graph G consists of a set V of vertices (also called points or nodes)
and a set E of edges (also called lines or arcs) which are unordered pairs
of vertices. We sometimes denote an edge {x, y} as xy. In a drawing of a
graph, two vertices x and y are joined by a line if and only if {x, y} ∈E.
If two vertices are joined by a line, they are adjacent; otherwise, they are
nonadjacent. If |V | = p and |E| = q, then we say that G has order p and
size q. Some good references on graph theory are [Bol79], [CL96], [CZ05],
[Har69], and [Wes95].
The complete graph Kn consists of n vertices and all
 n
2

possible edges.
The complete bipartite graph Km,n consists of a set A of m points, a set B
of n points, and all the mn edges between A and B. The cycle Cn consists
of n vertices connected by n edges in a circuit. The path Pn is Cn minus an
edge. Figure 19.1 illustrates some of these graphs (without vertex labels).
Given a vertex v of a graph, we denote by δ(v) the degree of v, that is,
the number of vertices adjacent to v. If δ(v) is the same for all vertices,
then the graph is regular of degree δ(v). Complete graphs and cycles are
regular. For example, K3, K2,2, and C4 are each regular of degree 2.
K3
K2,2
C4
P4
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
@
@
@
@
@
     @
@
@
@
@
FIGURE 19.1: Examples of graphs.
155

156
Pearls of Discrete Mathematics
Two graphs are isomorphic if the vertices of one graph can be relabeled
to create the second graph. For example, K2,2 and C4 are isomorphic.
The graph complement Gc of a graph G consists of the vertices of G and
the non-edges of G. For example, P4 is isomorphic to its own complement.
A formula for the number of nonisomorphic graphs of given order is
derived in [Eri96].
As an example, there are 12,005,168 nonisomorphic
graphs of order 10.
We will prove a few simple but important facts about graphs.
The
pigeonhole principle will be a useful tool.
Proposition 19.1 (Pigeonhole Principle). Given any function f : X →Y ,
where |X| = |Y | + 1, we have f(x1) = f(x2) for some distinct x1, x2 ∈X.
Proof. The result is so obvious it hardly needs proving, but we oﬀer a proof
by contradiction. If the result were not true, then the inverse image under
f of each element in Y would consist of at most one element of X. But this
implies that the cardinality of X is at most equal to the cardinality of Y ,
which is false. This contradiction establishes that the result is true.
■
The pigeonhole principle is often paraphrased as follows: If n+1 objects
are placed in n pigeonholes, then at least one pigeonhole must contain at
least two objects. Johann Peter Gustav Lejeune Dirichlet (1805–1859) was
the ﬁrst mathematician to explicitly use the pigeonhole principle in proofs.
He referred to it as the “drawer principle.”
We consider an “extremal property” of graphs. How many edges are
possible in a triangle-free graph with 2n vertices? The complete bipartite
graph Kn,n has n2 edges and no triangle.
In fact, n2 is the maximum
number of edges in a triangle-free graph with 2n vertices.
Theorem 19.2 (W. Mantel, 1907). A graph with 2n vertices and n2 + 1
edges must contain a triangle.
Proof 1 (Mathematical Induction). Let G be a graph with 2n vertices and
n2 + 1 edges. If n = 1, then G cannot have n2 + 1 edges; hence the result
is vacuously true. Assuming the result for n, we consider a graph G with
2(n + 1) vertices and (n + 1)2 + 1 edges. Let x and y be adjacent vertices
in G and let H be G minus x and y and any edges from x and y. If H,
a graph with 2n vertices, has more than n2 edges, then the result holds
by the induction hypothesis. So suppose that H has at most n2 edges and
hence there exist at least 2n + 1 edges joining x and y to vertices in H. By
the pigeonhole principle, there exists a vertex z in H that is adjacent to
both x and y. Therefore G contains a triangle xyz.
■
We give a second proof that doesn’t use the pigeonhole principle. Denote
by α(G) the maximum number of pairwise nonadjacent vertices in G. This
is called the independence number of G.

19 A Little Graph Theory Background
157
Proof 2 (AM–GM Inequality). Suppose that the graph G has no triangles.
Let α = α(G) and let I be an independent set of α vertices. Let β = 2n−α
(the cardinality of V −I). We make two simple observations: (1) Every
edge of G has at least one vertex in V −I (since I is independent). (2)
Every vertex of G has degree at most α (since G is triangle-free). By (1),
(2), and the arithmetic mean-geometric mean (AM–GM) inequality,
|E| ≤
X
v∈V −I
δ(v) ≤αβ ≤
α + β
2

= n2.
This contradicts the assumption that |E| = n2 + 1. Therefore G contains a
triangle.
■
Mantel’s theorem is a special case of an important theorem of P´al Tur´an
(1910–1976).
A subgraph of a graph G is a graph obtained from G by
possibly removing some vertices and edges.
Theorem 19.3 (P. Tur´an, 1941). In a graph with n vertices containing no
complete subgraph Km, the number of edges is at most
(m −2)n
2(m −1) .
For a proof, see [Bol79].
Now let’s prove the result from the chapter teaser: In any group of six
people, there are three all of whom know each other or three none of whom
know each other.
The six people and the relations between each pair of them (“know each
other” or “don’t know each other”) can be represented via the complete
graph K6. We think of the people as the vertices of the graph and the
relations as the edges.
A coloring of the set of edges of a graph G is an assignment of a color
to each edge of G. If all the edges of G have the same color, then G is
monochromatic. We want to show that if each edge of K6 is colored either
green or red, then there is a monochromatic subgraph K3 (a triangle). The
coloring may be done in an arbitrary manner. In fact, since K6 has
 6
2

= 15
edges, there are 215 = 32,768 possible green–red colorings of the edges of
K6. We claim that every coloring has a monochromatic subgraph K3.
Assume that the edges of K6 are colored using green and red colors, and
choose any vertex v. By the pigeonhole principle, at least three of the ﬁve
edges from v are the same color. Without loss of generality, suppose that
v is joined by green edges to vertices x, y, z. If any of the edges xy, yz, or
xz is green, then there is a green triangle (vxy, vyz, or vxz). On the other
hand, if each of these edges is red, then xyz is a red triangle.

158
Pearls of Discrete Mathematics
In fact, six is the smallest number of people that force the property of
having three all of whom know each other or all of whom don’t know each
other. This is because there is a 2-coloring of the edges of K5 without a
monochromatic triangle (see Exercises).
In 1930 Frank Ramsey (1903–1930) proved that for every positive integer
m, there exists an integer n such that every 2-coloring of the edges of Kn
has a monochromatic subgraph Km.
Theorem 19.4 (Ramsey’s Theorem, 1930). Given integers a, b ≥2, there
exists a least integer R(a, b) with the following property: Every green–red
coloring of the edges of the complete graph on R(a, b) vertices yields a
subgraph Ka all of whose edges are green or a subgraph Kb all of whose
edges are red. Furthermore
R(a, b) ≤R(a −1, b) + R(a, b −1),
a, b ≥3.
Proof (Induction on a and b). The values R(a, 2) = a and R(2, b) = b are
trivial (why?). These values are the basis of the induction. Assume that
R(a −1, b) and R(a, b −1) exist; we will show that R(a, b) exists. Let G
be the complete graph on R(a −1, b)+ R(a, b −1) vertices, and let v be an
arbitrary vertex of G. By the pigeonhole principle, at least R(a−1, b) green
edges or at least R(a, b −1) red edges are incident with v. Without loss of
generality, suppose that v is joined by green edges to a complete subgraph
on R(a −1, b) vertices. By deﬁnition of R(a −1, b), this subgraph must
contain a green subgraph Ka−1 or a red subgraph Kb. In the former case,
the green subgraph Ka−1, v, and all the edges between the two constitute a
green subgraph Ka. We have shown that G contains a green subgraph Ka
or a red subgraph Kb. Therefore, R(a, b) exists and satisﬁes the inequality
R(a, b) ≤R(a −1, b) + R(a, b −1).
■
The integers R(a, b) are called Ramsey numbers.
Very few Ramsey
numbers have been calculated.
We mentioned in the proof that R(a, 2) = a for all a ≥2. Also, by
symmetry, R(a, b) = R(b, a) for all a, b ≥2. Furthermore, the inequality of
the theorem is very important in ﬁnding bounds for Ramsey numbers.
The values R(a, a) are called diagonal Ramsey numbers. From the result
of the chapter introduction and one of the exercises, we know one diagonal
Ramsey number: R(3, 3) = 6. The only other nontrivial diagonal Ramsey
number known is R(4, 4), which we will address shortly.
Ramsey’s theorem has a straightforward generalization to edge-coloring
with an arbitrary number of colors.

19 A Little Graph Theory Background
159
Theorem 19.5 (Ramsey’s Theorem for Arbitrarily Many Colors). For
any integer c ≥2 and integers a1, . . . , ac ≥2, there exists a least integer
R(a1, . . ., ac) with the following property: If the edges of the complete
graph on R(a1, . . ., ac) vertices are colored with colors α1, . . . , αc, then for
some i there exists a complete subgraph on ai vertices all of whose edges
are color αi.
Proof. The case c = 2 is covered by our previous version of Ramsey’s the-
orem. Suppose that R(a1, . . ., ac−1) exists for all a1, . . . , ac−1 ≥2. We
claim that R(a1, . . ., ac) exists and satisﬁes
R(a1, . . ., ac) ≤R(R(a1, . . ., ac−1), ac).
A c-coloring of the complete graph on R(R(a1, . . ., ac−1), ac) vertices may
be regarded as a 2-coloring with colors {α1, . . ., αc−1} and αc.
Such a
coloring contains a complete graph on ac vertices colored αc or a (c −1)-
colored complete graph on R(a1, . . ., ac−1) vertices, using colors α1, . . . ,
αc−1, in which case the induction hypothesis holds.
In either case, we
obtain a complete monochromatic subgraph on the appropriate number of
vertices.
■
The c-color Ramsey numbers R(a1, . . ., ac) satisfy certain trivial rela-
tions, e.g., they are symmetric in the c variables. Furthermore
R(a1, . . ., ac−1, 2) = R(a1, . . ., ac−1),
ai ≥2,
because there is either an edge colored αc or else all edges are colored from
the set {α1, . . ., αc−1}.
We know that R(3, 3) = 6. Let’s evaluate the Ramsey number R(3, 4).
To obtain an upper bound, we use the inequality of Theorem 19.4:
R(3, 4) ≤R(3, 3) + R(2, 4) = 6 + 4 = 10.
In fact, R(3, 4) = 9. For suppose that there is a green–red coloring of K9
with no green subgraph K3 and no red subgraph K4. Since R(2, 4) = 4
and R(3, 3) = 6, each vertex of the graph K9 must be incident with exactly
three green edges and ﬁve red edges. But this implies that the sum of the
degrees of the vertices of the green subgraph is 9· 3 = 27, contradicting the
fact that the sum of degrees is always even (it is twice the number of edges).
Hence R(3, 4) ≤9. In the exercises, you are asked to furnish a 2-coloring
of K8 containing no green subgraph K3 and no red subgraph K4, thereby
proving that R(3, 4) = 9.
Next we determine the Ramsey number R(4, 4). The inequality of The-
orem 19.4 yields the upper bound
R(4, 4) ≤R(4, 3) + R(3, 4) = 9 + 9 = 18.

160
Pearls of Discrete Mathematics
In fact, R(4, 4) = 18. To prove this, it suﬃces to show a green–red coloring
of K17 containing no monochromatic K4.
Assume that the vertices of K17 are labeled with the residue classes
modulo 17: 0, 1, 2, . . . , 16. An edge ij is colored green or red according
to whether i −j is a quadratic residue or a quadratic nonresidue modulo
17. The set of quadratic residues modulo 17 is the set of nonzero squares
modulo 17, i.e.,
R17 = {1, 2, 4, 9, 8, 13, 15, 16},
and the set of quadratic nonresidues is the set of nonzero nonsquares, i.e.,
N17 = {3, 5, 6, 7, 10, 11, 12, 14}.
Notice that −1 = 16 ∈R17; hence i −j is a quadratic residue if and only if
j −i is a quadratic residue. Color the edge ij green if i−j ∈R17 and red if
i−j ∈N17. Suppose that there is a monochromatic K4 on vertices a, b, c, d.
We note that the coloring is translation invariant: (i + k) −(j + k) = i −j.
Hence, we may assume that a = 0.
Multiply each vertex by b−1 (the
multiplicative inverse of b), and note that either no edge changes color
(if b ∈R17) or every edge changes color (if b ∈N17).
This is because
b−1i−b−1j = b−1(i−j). In either case, we have a monochromatic subgraph
K4 on vertices 0, 1, cb−1, db−1. Since 1 −0 = 1 is a quadratic residue, the
other diﬀerences, cb−1, db−1, cb−1 −1, db−1 −1, and db−1 −cb−1, are all
quadratic residues. By inspection of the elements of R17, we ﬁnd that this
is impossible.
This proves the lower bound R(4, 4) > 17 and therefore
R(4, 4) = 18.
The above construction involving quadratic residues was discovered in
1955 by Robert E. Greenwood Jr. (1911–1995) and Andrew M. Gleason
(1921–2008). Although it gives the exact Ramsey number in the case of
R(4, 4), the method only gives upper bounds for higher numbers. For ex-
ample, using this technique we can show that 38 ≤R(5, 5), but other
techniques show that 43 ≤R(5, 5). In Table 19.1, we present all the known
nontrivial Ramsey numbers and bounds on some other Ramsey numbers.
The notation a/b means that a and b are the best known lower and upper
bounds for that particular Ramsey number. See [GRS90] and the dynamic
survey by Stanislaw Radziszowski in the Electronic Journal of Combina-
torics at http://www.combinatorics.org.
How diﬃcult would it be to calculate R(5, 5)? We have the upper bound
R(5, 5) ≤R(4, 5) + R(5, 4) = 50, but this still leaves us with an enormous
computation problem in evaluating R(5, 5). A naive approach, examining
all 2(
49
2 ) labeled graphs on 49 vertices, is beyond our current computer
capability.
When we consider more than two colors, the only known nontrivial
Ramsey number is R(3, 3, 3) = 17.

19 A Little Graph Theory Background
161
b
a
3
4
5
6
7
8
9
3
6
9
14
18
23
28
36
4
18
25
35/41
49/61
56/84
73/115
5
43/49
58/87
80/143
101/216
125/316
6
102/165
113/298
127/495
169/780
7
205/540
216/1031
233/1713
8
282/1870
317/3583
9
565/6588
TABLE 19.1: Ramsey numbers R(a, b).
We now state an upper bound for 2-color Ramsey numbers (see Exer-
cises).
Theorem 19.6. For all a, b ≥2, we have R(a, b) ≤
 a+b−2
a−1

.
It follows that
R(a, a)
≤
2a −2
a −1

<
22a−2
=
4a−1
<
4a.
For a lower bound for the diagonal Ramsey numbers R(a, a), we give
two non-constructive proofs. (See Chapter 12 and [ASE92].)
Theorem 19.7. If
 n
a

21−(
a
2) < 1, then n < R(a, a).
Proof 1 (Cardinality). There are 2(
n
2) green–red colorings of the
 n
2

edges
of Kn. The number of green–red colorings of Kn with a monochromatic
subgraph Ka is | SAS|, where AS is the collection of green–red colorings
in which the subgraph S is monochromatic, and S ranges over all possible
subgraphs of Kn isomorphic to Ka. We bound | S AS| as follows:

[
AS
 ≤
X
S
|AS|
(Bonferroni inequalities)
= 2 ·
n
a

2(
n
2)−(
a
2)
< 2(
n
2).

162
Pearls of Discrete Mathematics
The equality holds because there are
 a
2

subgraphs Ka in Kn. Since each
Ka is monochromatic, there are two choices for the color of its edges. The
remaining
 n
2

−
 a
2

edges of Kn are colored green or red arbitrarily.
As | S AS| is less than the total number of green–red colorings of Kn,
we conclude that there exists a coloring without a monochromatic Ka.
Therefore R(a, a) > n.
■
Proof 2 (Probability). Suppose that the edges of Kn are randomly and in-
dependently colored green or red. Each edge has an equal chance of being
colored green or red. For each subgraph S of Kn isomorphic to Ka, let AS
be the event that S is monochromatic. Then
Pr(AS)
=
Pr(S is green) + Pr(S is red)
=
2−(a
2) + 2−(a
2)
=
21−(
a
2),
and it follows that
Pr
[
AS

≤
X
S
Pr(AS)
(Bonferroni inequalities)
=
n
a

21−(
a
2)
<
1.
Since the complement of S AS occurs with positive probability, there exists
a 2-coloring of Kn with no monochromatic Ka. Therefore R(a, a) > n.
■
Theorem 19.7 gives a lower bound for R(a, a) (see Exercises):
R(a, a) > 2a/2,
a ≥3.
Thus, we conclude that
√
2
a < R(a, a) < 4a,
a ≥3.
The precise growth rate of the diagonal Ramsey numbers R(a, a) is un-
known.
In 1995 Jeong Han Kim showed that the order of magnitude of R(n, 3)
is n2/ log n (see [CG99]). The growth rate of R(n, k) for arbitrary ﬁxed k
is unknown.

19 A Little Graph Theory Background
163
Exercises
1. How many nonisomorphic graphs of order 4 are there?
2. Find a self-complementary graph of order 5.
⋆3. Show that there exists a self-complementary graph of order n if and
only if n is of the form 4k or k + 1.
4. Using the pigeonhole principle, show that some positive integral power
of 13 ends in 0001 (base 10).
5. Let q be an odd integer greater than 1. Show that there is a positive
integer n such that 2n −1 is a multiple of q.
6. Show that if S is a subset of {1, . . ., 2n} and |S| > n, then there exist
x, y ∈S with x and y relatively prime.
7. Show that if S is a subset of {1, . . ., 2n} and |S| > n, then there exist
x, y ∈S with x a divisor of y.
8. Suppose that an n×n binary matrix contains a 1 in every row, column,
and diagonal (diagonals of every length are considered here). What
is the minimum number of 1s in the matrix?
†9. Show that, up to isomorphism, Kn,n is the only triangle-free graph
with 2n vertices and n2 edges.
†⋆10. Prove Tur´an’s theorem.
11. Find a 2-coloring of the edges of K5 having no monochromatic trian-
gle.
†12. A tournament is a complete directed graph. (See Chapter 12.) Use
Ramsey’s theorem to show that for every n, there exists an f(n)
such that every tournament on f(n) vertices contains a transitive
subtournament on n vertices.
13. Show that every 2-coloring of the edges of K6 yields two monochro-
matic triangles.
14. Find a 2-coloring of K8 that proves that R(3, 4) > 8.
15. Prove that R(3, 5) = 14.
†16. Prove that R(3, 3, 3) = 17.

164
Pearls of Discrete Mathematics
17. Show that if K327 is 5-colored, there exists a monochromatic K3.
†18. Prove Theorem 19.6.
†19. Prove the lower bound for diagonal Ramsey numbers given at the end
of the chapter.
320. Find lower and upper bounds for R(10, 10).

Chapter 20
The Ramsey Game
In the Ramsey game, the second player has a drawing strategy if
2(
k
2)−1 >
n
k

.
Many of the concepts and theorems of discrete mathematics can be
converted into enjoyable and interesting games. Often, playing the games
serves as a way to become more familiar with the mathematics involved, or
to appreciate the mathematics from a diﬀerent perspective. In some cases,
we can determine which of two players should win the games and what the
best strategies are.
We now deﬁne a game that has been investigated by many mathemati-
cians, including Paul Erd˝os (1913–1996). We call the game Graph Achieve-
ment. Suppose that G is a graph without isolated vertices. The game is
played by two players, called Solid and Dotted, on the “board” Kn, i.e., the
complete graph on n vertices, for some n. The ﬁrst player, Solid, chooses
an edge of Kn and marks it with a solid line. The second player, Dotted,
chooses an unmarked edge and marks it with a dotted line. Play continues
in this way until someone has made a copy of G in his or her own marked
lines. The ﬁrst player to do this is the winner. If neither player succeeds
in producing the goal graph, then the game is a draw.
Let’s play an example of Graph Achievement with the graph K3 (a
triangle) on the board K5. The moves of Solid and Dotted are shown in
Figure 20.1. The moves are depicted on the graph and tabulated to the
right of the graph. Solid’s ﬁrst move is 15, joining vertices 1 and 5 with
a solid edge.
Following a convention of Frank Harary (1921–2005), we
jokingly call this move a “shrewd move” since it is completely arbitrary.
Dotted responds with the move 12, joining edges 1 and 2 with a dotted
line. Next, Solid makes the move 14, setting up a threat (indicated by a
check mark ✓) of playing 45 and making a triangle. Thus, Dotted’s move
45 is forced (indicated by an exclamation point !). Now, Solid makes the
move 13, setting up a double-threat (of both 34 and 35). Dotted can only
parry one of these threats, say, 34, so Solid wins on the fourth move with
35 (making the triangle 135).
165

166
Pearls of Discrete Mathematics
1
2
3
4
5
Solid
Dotted
15 (shrewd)
12
14 ✓
45!
13 ✓✓
34!
35 (wins)
FIGURE 20.1: Solid wins a game of K3 Achievement on K5.
A little experimentation shows that Solid cannot force a win on the
smaller board K4. Hence, we say that the achievement number of K3 is 5.
The achievement number of a graph G, denoted by a(G), is the smallest
number n such that Solid can always win Graph Achievement for G played
on Kn.
In the above discussion, we took for granted a commonplace of game
theory, namely, that if there is a winner (with best possible play) of an
achievement game in which players mark objects (in this case edges of a
complete graph), then the winner is the ﬁrst player (Solid). The rationale
for this precept is that if the second player had a winning strategy, then
the ﬁrst player could simply appropriate it and “get there ﬁrst.”
Now let’s consider a version of our game in which the ﬁrst player to
construct a K3 loses. We call this game Graph Avoidance. Again, suppose
that G is a graph with no isolated vertices. The game is played on a board
Kn, for some n. Solid and Dotted take turns marking edges with solid lines
(for Solid) and dotted lines (for Dotted). The ﬁrst player to make a copy
of G in his or her marked lines loses. If neither player makes a copy of G,
then the game is a draw.
Now the basic principle of game theory is inverted. If there is a winner
of an avoidance game, it must be the second player (Dotted).
If G is the triangle graph K3, then Dotted can force a win in Graph
Avoidance playing on K5. (Try the game!) Since Dotted cannot force a
win on K4, we say that the avoidance number of G is 5. The avoidance
number of a graph G, denoted by a(G), is the smallest number n such that
Dotted can always win Graph Avoidance for G played on Kn.

20 The Ramsey Game
167
G
K2
P3
2K2
P4
K1,3
K3
C4
K1,3 + e
K4 −e
K4
a
2
3
5
5
5
5
6
5
7
10
a
2
3
5
5
5
5
6
5
?
?
r
2
3
5
5
6
6
6
7
10
18
TABLE 20.1: Achievement, avoidance, and Ramsey numbers.
The achievement and avoidance numbers of a triangle are related to
Ramsey numbers. Recall that the Ramsey number R(3, 3) = 6, since 6 is
the smallest value of n such that if the edges of Kn are colored with two
colors, there must be a monochromatic subgraph K3. Thinking of the two
colors as solid lines and dotted lines, the Ramsey number result implies
that there will always be a winner of Graph Achievement for K3 on K6,
and the same is true for Graph Avoidance.
For any graph G, we deﬁne the graph Ramsey number r(G) to be the
smallest integer n such that if the edges of Kn are colored using two colors,
then there exists a monochromatic copy of G. If G is a complete graph
Km, then r(G) is the same as R(m, m). If G is a graph on n vertices, then
r(G) ≤R(n, n), since a monochromatic Kn contains a monochromatic copy
of G. Obviously, a(G) ≤r(G) and a(G) ≤r(G).
Table 20.1 shows achievement numbers, avoidance numbers, and graph
Ramsey numbers of graphs with 2, 3, and 4 vertices.
Explanations are
in order for the unfamiliar graph names. The graph 2K2 consists of two
disjoint copies of K2. The graph K1,3+e consists of the graph K1,3 with one
additional edge. The graph K4 −e (sometimes jokingly called the “random
graph”) is the graph K4 with one edge deleted. Veriﬁcation of some of these
values is called for in the exercises. The question marks indicate unknown
values.
Paul Erd˝os and John Selfridge proved the following result about Graph
Achievement for Kk played on the graph Kn: the game is a draw if 2l >  n
k
,
where l =
 k
2

−1. We will prove this result shortly.
The Graph Achievement game for a complete graph is also called the
Ramsey game. Let n ≥k ≥1. Suppose that Solid and Dotted take turns
marking unmarked edges of Kn. The winner is the ﬁrst person to complete
a Kk in his or her own marked edges. If neither player succeeds, then the
game is a draw. By our basic principle of game theory, if there is a winner
it must be the ﬁrst player. However, it isn’t clear how large n must be
relative to k to ensure a win, or how the players should play this game. In

168
Pearls of Discrete Mathematics
fact, in the case where the game is a ﬁrst player win, the winning strategy
isn’t known in general.
We will invoke a seminal result of Erd˝os and Selfridge. We deﬁne a
game as follows. Let {Ak} be a ﬁnite family of ﬁnite sets. Two players
take turns choosing elements of S
k Ak. The ﬁrst player who has chosen all
the elements of some Ak is the winner. If neither player succeeds, then the
game is a draw. From our basic principle, we know that only the ﬁrst player
can win (with best play). But how many sets are needed to guarantee that
the ﬁrst player can win? If the number of sets is small enough, then the
second player always has a blocking strategy.
Theorem 20.1 (Erd˝os–Selfridge, 1973). Let f(n) be the least integer for
which there exist f(n) sets Ak, with |Ak| = n for 1 ≤k ≤f(n), such
that the ﬁrst player has a winning strategy in the game above.
Then
f(n) = 2n−1.
Proof. We begin by showing that there exist 2n−1 sets of size n for which
the ﬁrst player has a winning strategy. The winning sets are the subsets of
the collection {w, x1, y1, x2, y2, . . ., xn−1, yn−1} that contain w and exactly
one of xi and yi, for 1 ≤i ≤n −1. Thus, there are 2n−1 winning subsets,
each of size n. The ﬁrst player has a winning strategy: on the ﬁrst turn,
choose w, and thereafter choose xi if the second player chooses yi, and vice
versa. In this way, the ﬁrst player chooses a winning set.
Now suppose that there are fewer than 2n−1 winning sets. We must
show that the second player has a drawing strategy. At any stage in the
game when it is the second player’s turn to play, we deﬁne the “danger” of
the position to indicate how close the second player is to losing. Sets from
which the second player has already selected some elements represent no
danger to the second player (since they cannot be completed by the ﬁrst
player), so we ignore such sets. We say that the danger of any other set
is 2k, where the ﬁrst player has chosen k of the elements. The danger of
the position is the total danger of all the sets. If the ﬁrst player were to
occupy all n elements of some set, then the danger of that set would be 2n.
However, we will describe a strategy by which the second player can keep
the danger of the position less than 2n, so that a fortiori the ﬁrst player
cannot win. Deﬁne the “score” of each unchosen element in the collection
to be the total danger of all the sets that contain that element. The second
player chooses an element with maximum score. Then the ﬁrst player gets
a turn. We claim that the result of the second player’s turn and the ﬁrst
player’s turn cannot be to increase the danger of the position. The second
player’s move removes from consideration all sets that contain the chosen
element, and the ﬁrst player’s move doubles the score of each element in
the collection of sets containing the chosen element. The second player has
chosen a point with maximal score, so the result of these two moves is to

20 The Ramsey Game
169
decrease the danger or leave it unchanged. Since the danger of the position
after the ﬁrst player’s ﬁrst move is less than 2n−1 · 21 = 2n, and the danger
never increases, the danger never reaches 2n. Therefore, the ﬁrst player
cannot complete a set.
■
In the Ramsey game, there are  n
k
 winning sets each of cardinality  k
2
.
Corollary 20.2. The second player has a drawing strategy in the Ramsey
game if
2(
k
2)−1 >
n
k

.
The drawing strategy for the second player is given explicitly in the
proof of the Erd˝os–Selfridge theorem.
Exercises
1. Prove that for the quadrilateral C4, the achievement number is 6.
2. Show that Dotted wins the Graph Avoidance game for K3, playing
on K5 but not on K4, implying that a(G) = 5.
3. Investigate a three-person version of Graph Achievement for K3. What
is the achievement number?
†4. Show that
(a) a(Cm) = m, m ≥8;
(b) a(mK2) = 2m + 1, m ≥2.
⋆5. Deﬁne Bipartite Graph Achievement and Avoidance games as follows.
Suppose that G is a bipartite graph with no isolated vertices. Let
two players, Solid and Dotted, take turns marking the edges (solid or
dotted, respectively) of a complete bipartite graph Kn,n. In Bipartite
Graph Achievement, the ﬁrst player to make a copy of G in his or her
marked lines is the winner. In Bipartite Graph Avoidance, the ﬁrst
person to do this is the loser. Deﬁne the bipartite graph achievement
number, ba(G), to be the smallest n such that Solid wins Bipartite
Graph Achievement on Kn,n. Deﬁne the bipartite graph avoidance
number, ba(G), to be the smallest n such that Dotted wins Bipartite
Graph Avoidance on Kn,n. Deﬁne the bipartite graph Ramsey number
br(G) to be the minimum n such that no matter how the edges of Kn,n
are colored with two colors, there exists a monochromatic copy of G.

170
Pearls of Discrete Mathematics
(a) Illustrate a game of Bipartite Graph Achievement for C4 on K4,4.
Show that Solid can always win.
(b) Verify the values in the table below. (The Y graph is K3,1 with
an additional edge appended to one of the vertices of degree 1.)
G
K2
P3
2K2
P4
K1,3
P3 ∪K2
ba
1
2
3
3
4
3
ba
1
3
3
3
4
3
br
1
3
3
3
5
3
G
C4
P5
K2,3 −e
K1,4
Y
K2,3
ba
4
4
4
6
5
6
ba
4
4
4
?
4
?
br
5
4
5
7
5
9
(c) Verify the following formulas (for m ≥1):
(1) ba(K1,m) = 2m −2;
(2) ba(mK2) = m + ⌊√m −1⌋;
(3) ba(Pm) =

m −1, m = 2, 3, 4,
⌊(m + 3)/2⌋, m ≥5;
(4) ba(C2m) = 2m.
(d) What is the greatest value of n that you can ﬁnd for which the
second player can draw playing Bipartite Graph Achievement
with the graph K10,10 on the board Kn,n?
(e) Find ba(K1,4) and ba(K2,3).
6. Deﬁne Positive Triangle Achievement as follows. Two players take
turns marking the edges of the complete graph Kn, for some n, using
+ and −marks. The players may choose either mark; for this reason
the game is called a choice game. In Positive Triangle Achievement,
the ﬁrst player to complete a triangle with an even number of −
signs (a “positive triangle”) wins. In this game, the goal triangle can
contain marks made by both players.
(a) Show that the ﬁrst player wins Positive Triangle Achievement if
n ≡2 or 3 (mod 4), while the second player wins if n ≡0 or 1
(mod 4).
(b) How would you deﬁne Negative Triangle Achievement?
Who
wins this game on Kn?
(c) Deﬁne Positive Triangle Avoidance and Negative Triangle Avoid-
ance. Investigate these games and demonstrate who wins on Kn
for various values of n.

20 The Ramsey Game
171
37. Let k = 10. Find the largest value of n that you can for which the
second player has a drawing strategy in the corresponding Ramsey
game.
†8. Given k, determine n such that the second player has a drawing strat-
egy in the Ramsey game. Find the greatest value of n (relative to k)
that you can.
†9. Find a(K4 −e) and a(K4).
†10. In 2009 Roland Bacher and Shalom Eliahou proved that every 14×15
binary matrix contains four equal entries (all 0s or all 1s) at the
vertices of a square with horizontal and vertical sides. Play a two-
person game based on this result. Can you ﬁnd a good strategy for
the ﬁrst player to employ?


Chapter 21
Tic-Tac-Toe and Animal Games
Tic-tac-toe is a draw game on a 5-dimensional board of side 22.
There are 12 winning animals and 12 minimal non-winning animals (if
Snaky is a winner).
In this chapter, we will investigate higher-dimensional tic-tac-toe and
generalizations of tic-tac-toe known as animal achievement and avoidance
games.
Tic-tac-toe is played on a 3 × 3 board, as shown (in two versions) in
Figure 21.1. Two players, Oh and Ex, take turns placing their symbols
(O and X) in unoccupied cells of the board. The ﬁrst player to complete
three cells in a row (horizontally, vertically, or diagonally) in his or her
own symbol wins. It is well known that with best play this game is a draw
(neither player can force three-in-a-row).
But what if we play this game on a larger board, say a 5 × 5 board?
In this game, the players try to complete ﬁve cells in a row. Can one of
the players force a win? Recall from Chapter 20 that in a game such as
this, where both players are taking unclaimed objects (the cells), if there is
a winner with best-possible play, the winner must be the ﬁrst player. The
FIGURE 21.1: The tic-tac-toe board.
173

174
Pearls of Discrete Mathematics
reason is that if the second player had a winning strategy then the ﬁrst
player would simply appropriate it and make the winning plays sooner.
In the tic-tac-toe game on an n-dimensional board of side k, there are
1
2[(k + 2)n −kn]
winning lines (rows, columns, and diagonals). The proof of this is neat. Let
T be the set {1, 2, 3, . . ., k}. Then T n, which consists of all strings of length
n from T, is the tic-tac-toe board in n-dimensional space of side k. Let S
be the set {0, 1, 2, 3, . . ., k, ∞}. The set Sn consists of all strings of length
n from the set S. Thus, Sn is a “superboard” of the tic-tac-toe board T n.
The “border” of Sn is the set of elements of Sn that contain at least one
coordinate 0 or ∞. The idea is to start at a border cell and go “across”
the interior cells T n. For example, the cell (0, 3, 1, ∞) gives rise to the line
(1, 3, 1, 3), (2, 3, 1, 2), (3, 3, 1, 1). The cell (∞, 1, 3, 0) yields the same line.
Since there are (k + 2)n elements of Sn, and we subtract the kn elements
of T n, the number of pairs of border cells is 1
2[(k + 2)n −kn], and this is
the number of winning lines.
For example, in ordinary 3 × 3 tic-tac-toe, the number of winning lines
is ((3 +2)2 −32)/2 = 8. These lines can be viewed as lines that join border
cells in a 5 × 5 array. There are 16 border cells joined in 8 pairs.
It follows from the Erd˝os–Selfridge theorem (Theorem 20.1) that if
1
2[(k + 2)n −kn] < 2k−1,
then the second player has a drawing strategy in tic-tac-toe on an n-
dimensional board of side k.
For example, the second player can draw
5-dimensional tic-tac-toe on a board of side 22.
We next discuss generalizations of 2-dimensional tic-tac-toe.
Frank Harary (1921–2005) created numerous games based on mathe-
matical concepts and theorems that turn out to be fun and interesting to
play. Professor Harary was a pioneer of graph theory; he was interested not
only in the foundations of the subject, but also in applying the theory to
real-life situations, including psychology and political science. Using graph
theory as the basis for games is a good way to make the theory accessible.
An animal is a collection of edge-wise adjacent unit squares in the plane.
This type of ﬁgure is also called a polyomino. The most primitive animal
is Elam, consisting of a single square. From Elam grows, as in cell repro-
duction, the unique 2-cell animal called Domino. Domino has two children,
Tic and El. Tic and El have as progeny the ﬁve 4-cell animals Fatty, Elly,
Tippy, Skinny, and Knobby. From these animals are born the 5-cell ani-
mals, which generate the 6-cell animals, etc. The family tree of the animals
is shown in Figure 21.2.

21 Tic-Tac-Toe and Animal Games
175
FIGURE 21.2: Evolution of the larger from the smaller animals.
No one knows a formula for the number of n-cell animals.
Any of the animals may be used as the goal conﬁguration in an achieve-
ment game. By deﬁnition, in an achievement game the object is to be the
ﬁrst player to complete a certain goal. Let two players, Oh and Ex, play
an achievement game on a square board decomposed into smaller squares.
Oh writes an O into any small square of the board and Ex writes an X into
any unoccupied square, and so on. The ﬁrst player who completes in his
or her symbol a conﬁguration shaped like the predetermined goal animal is
the winner. If neither player is able to do this, then the game is a draw.
For each animal, an avoidance game can also be played.
We assume that Ms. Oh and Mr. Ex always make the best possible
moves. This assumption of rational play is necessary to see exciting games.
More speciﬁcally, rational play means that a player who has a winning
position plays so that he wins or still has a winning position; if he has a
drawing position, he plays so that he still has a draw; and if he has a losing
position, he plays so that the loss is delayed as long as possible.
Even under the conditions of rational play, some games are more exciting
than others. The game of Elam Achievement is dull. Ms. Oh, on her ﬁrst
turn, writes an O anywhere on the playing board and wins instantly. She
has constructed in her symbol a conﬁguration in the same shape as the

176
Pearls of Discrete Mathematics
O1
X1
O2
X2
O3
X3
O4
FIGURE 21.3: Oh wins a game of Skinny Achievement.
1-cell animal Elam. Mr. Ex doesn’t even get a turn. Such a game is called
a trivial game or, whimsically, a banker’s game because of the risk involved
to the eventual winner.
Oh can achieve Elam on a playing board consisting of a single square.
Hence, we say that the board number of Elam is 1. In general, the board
number of an animal is the smallest size square board on which a player
can force a win.
Oh achieves Elam in a single move on a 1 × 1 board.
Thus we say
that the move number of Elam is 1. The move number of an animal is the
number of turns necessary to achieve the animal on the smallest possible
board. Animals for which the move number is equal to the number of cells
in the animal are called economical.
As we have already indicated, in a rational two-person achievement
game in which there is a winner, that winner will be the ﬁrst player. In an
avoidance game, the winner will be the second player.
Figure 21.3 shows an Example of Skinny Achievement on a 4 × 4 board
in which Oh wins in six moves.
This particular game does not exhibit
rational play by Ex.
The biggest surprise in animal achievement theory is that there are
animals which Ex can block Oh from making, even on an inﬁnite board.
The simplest example of such a non-winner animal is Fatty. Andreas Blass
conceived of the idea of a domino blocking pattern. Consider the domino
tiling pattern of the inﬁnite board indicated in Figure 21.4. Any Fatty
on this board must contain a complete domino. Hence Ex’s strategy for
blocking Fatty is simply to take the other half of any domino entered by
Oh. Then Oh can never complete a domino, and thus never achieve Fatty.

21 Tic-Tac-Toe and Animal Games
177
FIGURE 21.4: A domino blocking pattern for Fatty.
There are 11 known winning animals, pictured in Figure 21.5. For all
other animals (except one), there is a blocking pattern which Ex can use
to prevent Oh from winning the achievement game. There are 12 known
minimal non-winners. The exceptional animal is Snaky (Figure 21.6), which
does not have a domino blocking pattern, yet which still may be a non-
winner. If Snaky is a winner, then there are 12 winners and 12 minimal
non-winners. The status of Snaky has remained an open question for over
30 years.
What progress has been made on this long-standing problem of Snaky
Achievement? In 1982 the author showed that there is no domino blocking
pattern for Snaky. However, the lack of a domino blocking pattern doesn’t
mean that Snaky is a winner. It may be that Ex can draw without using
a domino blocking pattern. Figure 21.7 displays a game in which Oh wins.
But this is not a proof either as Ex might play better. In 2004 N´andor
Sieben proved that the polyomino version of Snaky Achievement is a ﬁrst
player win on a 41-dimensional board.
A generalization of animal achievement and avoidance is aﬀorded by
so-called Picasso animals. A Picasso animal is a collection of cells on a
square grid (not necessarily connected) with the property that when certain
columns and rows of empty cells are eliminated, there results an animal.
Figure 21.8 shows a Picasso Snaky.
Achievement and avoidance games can be played with Picasso animals.
Some Picasso animals are equivalent to bipartite graphs. The equivalence
is eﬀected by turning the squares of the Picasso animals into edges of the
graph. Two edges are incident at a vertex if the two cells of the Picasso
animal are in the same row or column.
For example, Picasso Tippy is

178
Pearls of Discrete Mathematics
FIGURE 21.5: Animal winners.
FIGURE 21.6: Snaky (is it a winner?).
O1
X1
O2
X2
O3
X3
O4
X4
O5
X5
O6
X6
O7
X7
O8
X8
O9
X9
O10
X10
O11 X11
O12
X12
O13
FIGURE 21.7: Oh wins a game of Snaky Achievement.

21 Tic-Tac-Toe and Animal Games
179
FIGURE 21.8: A Picasso Snaky.
FIGURE 21.9: A Picasso Tippy and an equivalent bipartite graph.
equivalent to the path of length 4, as shown in Figure 21.9. A complete
bipartite graph Km,n is equivalent to the Picasso Animal based on an m×n
“block.” For example, Picasso Fatty is equivalent to K2,2. For the Picasso
animals that are not equivalent to bipartite graphs, the achievement and
avoidance games are genuinely new games that can be fun to play.
Exercises
1. Prove that tic-tac-toe is a draw on a 5 × 5 board.
2. Find the greatest side length that you can for which the second player
can draw 7-dimensional tic-tac-toe on a board of this side length.
3. In Figure 21.2, identify Elam, Domino, Tic, El, Skinny, Knobby, Elly,
Fatty, and Tippy.
4. Show that Tippy Achievement is a ﬁrst player winner on a 3×3 board.
5. Which animals are economical winners?
6. Draw pictures of the 12 (known) minimal non-winning animals and
ﬁnd a blocking strategy for each.

180
Pearls of Discrete Mathematics
7. Find the board number of Picasso Fatty Achievement.
8. What is the outcome of Domino Avoidance on an n × n board with
best-possible play?
9. What is the outcome of Domino Avoidance on an n × 1 board with
best-possible play?
10. Consider the game of avoiding Tic on a 4 × 4 board or a 5 × 5 board.
Decide whether Tic is a loser or a draw on these boards.
11. Which 4-cell animal avoidance game, when played on a 3 × 3 board,
is a ﬁrst player loss?
12. Which 4-cell animals are equivalent to unique bipartite graphs?
13. Prove that every Picasso animal is a ﬁrst player winner in the achieve-
ment game.
14. We know that Tippy is a winner on a 3×3 board. Is it a winner on a
5 × 5 board with the center square removed? What if “wrap-around”
is allowed?
15. Investigate achievement and avoidance games for 3-D animals made
of cubes. Give an example of a non-winning animal.
16. Animal achievement and avoidance can be played as one-color games,
in which both players put the same symbol down on the board. The
ﬁrst player to make a copy of a predetermined animal is the winner
(in the achievement game) or the loser (in the avoidance game). Who
wins one-color Fatty Achievement on a 3 × 3 board?
17. Let Oh and Ex take turns packing 4-cell animals that have not yet
been packed into a 4×5 board, with the last player able to move being
the winner. Show that Oh wins the achievement game by packing
Tippy ﬁrst. Find the unique place in the board where Tippy must be
placed in order that Oh wins.

Part VIII
Algorithms
181


Chapter 22
Counters
The three-digit numbers 000 through 999 (base 10) can be arranged in a
circular list so that consecutive numbers diﬀer in exactly one digit.
In this chapter, we describe some basic counting algorithms, including
Gray codes. Gray codes are a popular topic in computer science because
of their connections with algorithms, graphs, and puzzles like the Tower of
Hanoi.
We all know how to count, but how do we tell a computer how to count?
Consider how an odometer counts from 000 to 999. The count looks like
000, 001, 002, 003, 004, 005, 006, 007, 008, 009, 010, . . ..
At each step, the units digit is advanced until a 9 is reached, and then at
the next step the units digit is set back to 0 and the tens digit is advanced.
Similarly, the tens digit is advanced at every tenth step until a 9 is reached,
and ten steps later the tens digit is set back to 0 and the hundreds digit is
advanced.
The following algorithm formalizes this procedure. For any base k and
any length of string n, the algorithm produces all kn strings of length n
over the set {0, 1, . . ., k −1}, starting with the all 0 string and ending with
the all k −1 string.
Counting Algorithm
Let k and n be positive integers, with k > 1.
Let x0 = 0, x1 = 0, ..., xn−1 = 0.
Output {xn−1, . . ., x1, x0}.
While {xn−1, . . ., x1, x0} ̸= {k −1, . . ., k −1, k −1}, do:
Set i ←0.
While xi = k −1, do:
xi = 0, i ←i + 1.
Set xi ←xi + 1.
Output {xn−1, . . ., x1, x0}.
183

184
Pearls of Discrete Mathematics
The output for n = 3, k = 2 is
{0, 0, 0}
{0, 0, 1}
{0, 1, 0}
{0, 1, 1}
{1, 0, 0}
{1, 0, 1}
{1, 1, 0}
{1, 1, 1}.
The task of listing all subsets of a set is similar to the task of listing all
binary strings (i.e., the case k = 2), but we only need to keep track of the
selected elements, not the non-selected elements. The following algorithm
lists all subsets of the set {1, 2, . . ., n}.
Subsets Listing Algorithm
Let n be a positive integer.
Output {}.
Let x = {1}.
While x ̸= {n}, do:
If the last element of x is n,
then delete the last element of x
and increase the new last element of x by 1;
otherwise, append to x
the last element of x incremented by 1.
Output x.
The output for n = 3 is
{}, {1}, {1, 2}, {1, 2, 3}, {1, 3}, {2}, {2, 3}, {3}.
Notice that consecutive sets diﬀer in size by one element, and this includes
the ﬁrst and last sets as a consecutive pair. The sets are listed in a diﬀerent
order from the one essentially given by the Counting Algorithm in the case
k = 2.
In 1953 Frank Gray introduced the binary (base 2) Gray codes to solve
a problem concerning mechanical switches. The Gray code is a method of
counting in binary so that each binary string diﬀers in only one bit from

22 Counters
185
the previous string (including wrap-around, so that the ﬁrst and last string
are considered to be consecutive).
Generalizations of these sequences to any base are called generalized
Gray codes.
In a generalized Gray code, two consecutive strings diﬀer
in only one coordinate and by a numerical value of 1 (allowing “wrap-
around”) in that coordinate. Generalized Gray codes have some curious
combinatorial properties. For instance, one of the exercises is an illustration
of the discrete derivative and integral.
In the following algorithm, the generalized Gray code advances only the
digit advanced by the normal count. This results in the code having the
desired property that consecutive strings diﬀer in only one coordinate and
by a numerical value of 1 in that coordinate.
Generalized Gray Code Algorithm
Let k and n be positive integers, with k > 1.
Let x0 = 0, x1 = 0, ..., xn−1 = 0.
Let y0 = 0, y1 = 0, ..., yn−1 = 0.
Output {yn−1, . . ., y1, y0}.
While {xn−1, . . ., x1, x0} ̸= {k −1, . . ., k −1, k −1}, do:
Set i ←0.
While xi = k −1, do:
xi = 0, i ←i + 1.
Set xi ←xi + 1.
Set yi ←mod (yi + 1, k).
Output {yn−1, . . ., y1, y0}.
Here is the output for n = 3 and k = 3.
{0, 0, 0}, {0, 0, 1}, {0, 0, 2},
{0, 1, 2}, {0, 1, 0}, {0, 1, 1},
{0, 2, 1}, {0, 2, 2}, {0, 2, 0},
{1, 2, 0}, {1, 2, 1}, {1, 2, 2},
{1, 0, 2}, {1, 0, 0}, {1, 0, 1},
{1, 1, 1}, {1, 1, 2}, {1, 1, 0},
{2, 1, 0}, {2, 1, 1}, {2, 1, 2},
{2, 2, 2}, {2, 2, 0}, {2, 2, 1},
{2, 0, 1}, {2, 0, 2}, {2, 0, 0}

186
Pearls of Discrete Mathematics
Exercises
31. Implement the Counting Algorithm in your favorite computer lan-
guage.
2. Give the output of the Subsets Listing Algorithm for n = 4.
33. Implement the Subsets Listing Algorithm in your favorite computer
language.
4. Give the Gray code for n = 3 and k = 2.
35. Implement the Generalized Gray Code Algorithm in your favorite
computer language.
36. Write a computer program to list the subsets of an n-element set that
have an even number of elements.
37. Write a computer program to recursively output the binary Gray code
of length n using the binary Gray code of length n −1.
8. A normal counter (base 10) reads 1123094. What is the corresponding
Gray code count?
A Gray code counter (base 10) reads 3210109.
What is the corresponding normal count?
†9. Research the Tower of Hanoi puzzle and ﬁnd out how it is related to
the Gray code.
10. A Hamiltonian circuit of a ﬁnite graph G, named after William Rowan
Hamilton (1805–1865), is a circular sequence of all the vertices of G
such that every two consecutive vertices in the sequence are adjacent
in G. Show how a generalized Gray code is equivalent to a Hamilto-
nian circuit of a certain graph. What is the graph?

Chapter 23
Listing Permutations and
Combinations
There is a simple way to list all the permutations of an n-element set in
lexicographic order.
There is a simple way to list all the k-element combinations of an n-element
set in lexicographic order.
In this chapter, we describe algorithms to list permutations and combi-
nations of a set. Such algorithms are useful in a variety of mathematics and
computer science applications. We will conclude with a wonderful “minimal
change” listing of permutations known as the Johnson–Trotter algorithm.
Consider the following ordering of the 24 permutations of {1, 2, 3, 4}
(read left-to-right and top-to-bottom):
1234
1243
1324
1342
1423
1432
2134
2143
2314
2341
2413
2431
3124
3142
3214
3241
3412
3421
4123
4132
4213
4231
4312
4321.
In our notation, the permutation 1324, for example, is the one that maps
1 →1, 2 →3, 3 →2, and 4 →4.
This ordering is called the lexicographic or dictionary ordering. The
permutations are listed in the order that they would appear in a dictionary
if the “alphabetical” order of the numbers is 1, 2, 3, 4.
Here is an algorithm that lists the permutations of the set {1, . . ., n}
in lexicographic order.
To see how the algorithm works, try to determine
what the permutation following 2431 should be (checking your answer with
the listing above).
187

188
Pearls of Discrete Mathematics
Permutations Listing Algorithm
Let n be a positive integer greater than 1.
Let x1, . . ., xn = 1, . . ., n.
Output x1, . . ., xn.
While x1, . . ., xn ̸= n, . . ., 1, do:
Set i∗←n −1.
While xi∗> xi∗+1, do:
i∗←i∗−1.
Set j∗←n.
While xj∗< xi∗, do:
j∗←j∗−1.
Interchange the values of xi∗and xj∗.
Set xi∗+1, . . ., xn ←xn, . . ., xi∗+1.
Output x1, . . ., xn.
Notice that to ﬁnd the next permutation in the sequence, we leave unal-
tered as many digits as possible at the left. To do this, we ﬁnd the rightmost
number a whose right neighbor b satisﬁes a < b. Then a is exchanged for
the next greater available number, and the places to the right are ﬁlled with
the available numbers in increasing order.
Now we describe an algorithm that lists all k-element combinations of
the set {1, . . ., n} in lexicographic order. To ﬁnd the next subset in the
order, we want to simply add 1 to the last element in the current subset.
When this isn’t possible (i.e., the last element is n), then we drop this last
element and, if possible, increment the new last element and include its
successor. This isn’t possible when the new last element is n −1; in this
case, we need to go further back in the list to ﬁnd an element to increment.
The following algorithm makes this procedure precise.
Combinations Listing Algorithm
Let n and k be positive integers with 1 ≤k ≤n.
Let x = {1, . . ., k}.
Output x.
While x ̸= {n −k + 1, . . ., n}, do:
Set i∗←k.
While xi∗= n −k + i∗, do:
i∗←i∗−1.
Set xi∗←xi∗+ 1.
Set xi∗+1, . . ., xk ←xi∗+ 1, . . ., xi∗+ k −i∗.
Output x.

23 Listing Permutations and Combinations
189
Here is the output for n = 6 and k = 3.
{1, 2, 3}, {1, 2, 4}, {1, 2, 5}, {1, 2, 6}, {1, 3, 4},
{1, 3, 5}, {1, 3, 6}, {1, 4, 5}, {1, 4, 6}, {1, 5, 6},
{2, 3, 4}, {2, 3, 5}, {2, 3, 6}, {2, 4, 5}, {2, 4, 6},
{2, 5, 6}, {3, 4, 5}, {3, 4, 6}, {3, 5, 6}, {4, 5, 6}
For our ﬁnal topic of this chapter, let’s return to permutations. We
have seen that we can list the permutations of {1, 2, . . ., n} in lexicographic
order. Can we also list permutations in such a way that successive per-
mutations diﬀer only by a transposition of elements? Can you ﬁnd a way
to list the permutations of {1, 2, 3} so that successive permutations diﬀer
by a transposition of adjacent elements? Such a listing is aﬀorded by the
Johnson–Trotter algorithm, discovered in 1962-63 by Selmer M. Johnson
and Hale F. Trotter. To each integer we assign a direction, left or right.
Ultimately, we don’t care about the directions, but they are used in the
algorithm. We represent, say, a 3 with a “left” direction as
←
3 .
Initially, all integers are directed to the left.
We say that an integer is
mobile if it is larger that its immediate neighbor (if one exists) in its given
direction. Each step of the algorithm consists of transposing the largest
mobile integer with its neighbor in its given direction, and changing the
direction of all larger integers. This transpires until there are no mobile
integers.
Johnson–Trotter Algorithm
Let n be a positive integer.
Assign to each integer 1, ..., n a ‘‘left’’ direction.
Output {1, 2, . . ., n}.
While there exists a mobile integer, do:
Let l be the largest mobile integer.
Transpose l and its neighbor in the direction of l.
Reverse the direction of all integers larger than l.
Output the current permutation.

190
Pearls of Discrete Mathematics
Here is the output for n = 3.
←
1 ,
←
2 ,
←
3
←
1 ,
←
3 ,
←
2
←
3 ,
←
1 ,
←
2
→
3 ,
←
2 ,
←
1
←
2 ,
→
3 ,
←
1
←
2 ,
←
1 ,
→
3
Notice that the list is circular, that is, the ﬁrst and last permutations
diﬀer by a transposition of adjacent numbers.
Exercises
31. Write a program to compute n! for any nonnegative integer n.
32. Write a program to compute binomial coeﬃcients  n
k
.
3. An unusual dictionary contains as “words” all permutations of the 26
letters of the alphabet. The words are listed in alphabetical order (in
all capital letters), starting with
ABCDEFGHIJKLMNOPQRSTUVWXYZ
and ending with
ZYXWVUTSRQPONMLKJIHGFEDCBA.
What word in the dictionary comes immediately after
JMZORTXLBPSYWVINGDUQEKHFCA?
34. Implement the Permutations Listing Algorithm.
35. Implement the Combinations Listing Algorithm.

23 Listing Permutations and Combinations
191
6. Professor Bumble’s favorite permutations of integers are those that
map even integers to odd integers and odd integers to even integers.
Of the permutations of the set {1, 2, . . ., 2n}, where n ≥1, how many
are among Professor Bumble’s favorites? Describe a procedure that
lists these permutations.
†7. Explain why the Johnson–Trotter algorithm works.
Do you see a
resemblance between the lists produced and Gray codes?
8. In the Johnson–Trotter algorithm, how many steps occur between the
permutations {1, 2, . . ., n} and {n, n −1, . . ., 1}? What directions do
the integers have for the permutation {n, n −1, . . ., 1}?


Chapter 24
Sudoku Solving and Polycube
Packing
There is a simple algorithm that solves Sudoku puzzles instantly.
There are 128 ways to pack the seven 4-cube polycubes into a 2 × 2 × 7 box.
In this chapter, we will discuss a multi-purpose tool called an Exact
Cover Algorithm. We show how to use this algorithm to solve Sudoku puz-
zles and polycube packing problems. The algorithm furnishes all solutions
to these problems.
An exact cover problem consists of a ﬁnite S and a collection of subsets
of S. The goal is to ﬁnd an exact cover of S, that is, a subcollection of the
subsets whose disjoint union is S. For example, suppose that
S = {1, 2, 3, 4, 5}
and the subsets are X1 = {1}, X2 = {2}, X3 = {3, 4, 5}, and X4 =
{2, 3, 4, 5}. Then there are two exact covers: {X1, X2, X3} and {X1, X4}.
An exact cover problem can be given in terms of a binary matrix (where
each entry is 0 or 1). The columns of the matrix represent the elements of
the base set and the rows represent the subsets. Put a 1 in a given position
if the corresponding element is in the corresponding subset; put a 0 in the
position otherwise. The binary matrix associated with our example is


1
0
0
0
0
0
1
0
0
0
0
0
1
1
1
0
1
1
1
1

.
The columns represent the elements 1, 2, 3, 4, and 5, and the rows represent
the subsets X1, X2, X3, and X4. The exact cover problem is to ﬁnd a set
of rows that have exactly one 1 in each column. The two solutions are (1)
the ﬁrst three rows and (2) the ﬁrst and fourth rows.
An Exact Cover Algorithm is a procedure for solving an exact cover
193

194
Pearls of Discrete Mathematics
problem. Here is a straightforward version proposed by Donald Knuth. No
faster general Exact Cover Algorithm is known.
Exact Cover Algorithm
Let M be a binary matrix.
If M is empty, then the problem is solved.
Otherwise, choose a column c with the minimum number of 1s.
If this number is zero, then terminate unsuccessfully.
Choose, in turn, all rows r such that M[r, c] = 1.
Include r in a partial solution.
For each j such that M[r, j] = 1, do:
Delete column j from M.
For each i such that M[i, j] = 1, delete row i from M.
Repeat this algorithm recursively on the reduced matrix M.
The direction to choose column c with the minimum number of 1s is
arbitrary; it has been found empirically that this criterion results in fast
run-times. Once c is chosen, we should look at each row in turn that “cov-
ers” the element that column c represents. Each such row, included in a
partial solution, may also cover other elements of the given set, and so the
columns representing these elements are deleted, and any rows that dupli-
cate the coverage of these elements are deleted. The program calls itself on
the reduced matrix, essentially cloning copies of itself.
We describe how to apply our Exact Cover Algorithm to the problem of
solving Sudoku puzzles and the problem of packing polycubes into a box.
In a Sudoku puzzle, the goal is to ﬁll in the blank cells of a 9 × 9 grid
so that every row, column, and 3 × 3 box contains every digit from 1 to 9.
See the example puzzle in Figure 24.1.
We convert the Sudoku puzzle into an exact cover problem by forming
a 729 × 324 binary matrix that encodes all possible ways to put a number
into the Sudoku grid.
As there are 9 numbers and 81 cells, there are
9 · 81 = 729 choices altogether. Thus, our binary matrix has 729 rows.
Each row has exactly four 1s, corresponding to conditions that are satisﬁed
when a number is placed in the grid. The conditions are of four types:
• xOy means that cell (x, y) is occupied;
• xRy means that number x is in row y;
• xCy means that number x is in column y;
• xBy means that number x is in block y.

24 Sudoku Solving and Polycube Packing
195
9
6
2
5
5
7
4
5
3
6
2
2
8
8
4
2
7
5
3
5
7
2
6
8
1
5
2
1
1
6
8
3
FIGURE 24.1: A Sudoku puzzle.
These conditions are represented by the 4 · 92 = 324 columns.
The given numbers in a Sudoku puzzle are represented by given rows of
the matrix. Solving the Sudoku puzzle is equivalent to extending the set of
given rows to an exact cover of the matrix. Since an exact cover contains
exactly one 1 in each column, there is exactly one i (where 1 ≤i ≤9) in
each row, column, and block of the Sudoku grid and each cell is occupied
by some number.
A computer implementation of our Exact Cover Algorithm instantly
solves any Sudoku puzzle or determines that there is no solution.
For
instance, the puzzle in Figure 24.2 isn’t solvable because there is no way to
put a 4 in the top-left block. The program discovers this since there is no
1 in column 4B1. The algorithm has a nice symmetry in that the search is
over all the digits that can ﬁt in a cell and all the places a digit can ﬁt in
a row, column, or block.
By the way, there are exactly 6670903752021072936960 .= 6.7×1021 dif-
ferent Sudoku boards, as found in 2005 by Bertram Felgenhauer and Frazer
Jarvis.
Now let’s consider a 3-D polycube packing problem. We will refer to
the ﬁgures as either polycubes or animals. As shown in Figure 24.3, there
are seven animals composed of four cubes. Two animals are considered the
same if one can be rotated and/or reﬂected to form the other.

196
Pearls of Discrete Mathematics
1
2
3
4
4
FIGURE 24.2: An unsolvable Sudoku puzzle.
Tippy
Knobby Cornery Twisty
Elly
Skinny
Fatty
FIGURE 24.3: The seven four-cube 3-D animals.

24 Sudoku Solving and Polycube Packing
197
35
34
33
32
31
30
29
28
27
26
25
24
23
22
21
20
19
18
17
16
15
14
13
12
11
10
 9
 8
FIGURE 24.4: A labeled 2 × 2 × 7 box
We label the animals 1, 2, 3, 4, 5, 6, and 7. The particular order isn’t
important, but let’s say that Skinny is labeled 1. We label the cells of the
box 8 through 35, as shown in Figure 24.4.
The placement of an animal in the box is represented by a binary vector
of length 35. The ﬁrst seven coordinates of the vector tell which animal is
packed. The other coordinates tell where it is packed. For example, the
binary vector of length 35 consisting of all 0s except 1s in positions 1, 8,
9, 10, 11, and 12 represents a Skinny in positions 8, 9, 10, 11, and 12.
Considering all possible placements of all seven animals, there are 399 such
vectors. When we run our Exact Cover Algorithm on this set of vectors, we
ﬁnd 128 exact covers. One of these (indicating the nonzero coordinates) is
{1, 9, 10, 11, 12}, {2, 22, 23, 29, 30}, {3, 25, 26, 27, 33}, {4, 13, 14, 19, 20},
{5, 8, 15, 16, 17}, {6, 21, 28, 34, 35}, {7, 18, 24, 31, 32}.
In every solution, the Skinny animal is placed one cell away from a corner.
Since there are eight symmetries of the box, there are 128/8 = 16 non-
equivalent packings of the eight animals.
A wealth of polycube packings is shown on the “Polycubes” page at
http://www.geocities.com/alclarke0/PolyPages/Polycubes.html.
Exercises
31. Implement the Exact Cover Algorithm to solve Sudoku puzzles. Try
your program on the puzzle of Figure 24.1.
2. In a Sudoku puzzle, what is the maximum number of given numbers
that allow for more than one solution?

198
Pearls of Discrete Mathematics
33.
(a) How many solutions are there to a Sudoku puzzle with the ﬁrst
six rows given as
{1, 2, 3, 4, 5, 6, 7, 8, 9}
{4, 5, 6, 7, 8, 9, 1, 2, 3}
{7, 8, 9, 1, 2, 3, 4, 5, 6}
{3, 6, 4, 9, 7, 2, 5, 1, 8}
{5, 1, 2, 3, 6, 8, 9, 4, 7}
{9, 7, 8, 5, 1, 4, 3, 6, 2}?
(b) A Latin square is an n × n array in which each row and column
contains all the integers from 1 to n. How many 4 × 4 Latin
squares are there?
(c) Can you ﬁnd a relationship between the problems in (a) and (b)?
34. Prove that the ﬁve 4-cell animals cannot be packed into a 4×5 board.
However, two sets of these animals can be packed into a 5 × 8 board
or a 4 × 10 board. How many ways can each such packing be done?
35. There are twelve 5-cell animals. How many ways can they be packed
into
(a) a 3 × 20 box?
(b) a 5 × 12 box?
(c) a 6 × 10 box?
36. How many ways can the twelve 5-cell animals be packed into a 6 ×10
box so that each of them touches the border of the box?
37. How many ways can you pack eight dominoes (2-cell polyominoes)
into a 4 × 4 board? How many ways can you pack 18 dominoes into
a 6 × 6 board?
Note. These are instances of the dimer problem, which asks for the
number of ways to pack an m × n board with dominoes (where at
least one of m and n is even).
38. What happens in the dimer problem (see previous exercise) if two
squares of the board of opposite checkerboard color are missing?
What choice of the two squares results in the greatest possible number
of domino tilings? What choice results in the least number?
39. How many ways can you pack eight dominoes into a 4 × 4 toroidal
board (i.e., allowing wrap-around)?

Sudoku Solving and Polycube Packing
199
310. Determine the number of ways that an n × n board can be packed
with dominoes and/or 1-cell animals, where 1 ≤n ≤4.
311. How many ways can eight mutually hostile Queens be placed on an
8×8 chessboard so that no Queen attacks another? Solve the problem
using a generalized Exact Cover Algorithm. Placing a Queen on a
square “covers” the row and column containing that square, as well
as the diagonal(s) containing that square.
Every row and column
must be covered exactly once and every diagonal may be covered at
most once.


Appendix A
Hints and Solutions to Exercises
The computer code shown uses Mathematica.
Chapter 1
1. There are 24 = 16 subsets: ∅, {A}, {B}, {C}, {D}, {A, B}, {A, C},
{A, D}, {B, C}, {B, D}, {C, D}, {A, B, C}, {A, B, D}, {A, C, D},
{B, C, D}, {A, B, C, D}.
2. By the product rule, there are 4 × 2 × 3 = 24 choices.
33. 333
4. There are 4 · 2 · 10 = 80 choices.
5. There are 103 choices for the ﬁrst three digits, 26 for the letter, and
10 for the last digit. Hence, there are
103 · 26 · 10 = 260000
diﬀerent licenses.
6. There are 310 = 59049 such strings.
7. From the collection of 210 subsets of {a, b, c, d, e}, we must remove
those in which both a and b appear.
Since there are 28 of these
subsets, the number of desired subsets is 210 −28 = 1024−256 = 768.
8. There are 299 binary strings of length 99. In half of these, the sum of
the elements is an odd number. The reason is that the complement of
a string, formed by changing each 0 to a 1 and each 1 to a 0, has a sum
of elements equal to 99 minus the sum of the elements of the original
string. If the original sum is odd, then the new sum is even, and vice
versa. Therefore, the number of desired strings is 299/2 = 298.
9. There are four choices for the image of each of the three elements in
the domain of the function. Hence, there are 43 = 64 functions.
10. There are n choices for the image of each of the n elements of the
domain. Hence, there are nn functions.
201

202
Pearls of Discrete Mathematics
11. There are n choices for the image of each even number and n choices
for the image of each odd number. Hence, there are nn · nn = n2n
functions.
12. yes
13. If the White King is in a corner, then there are 64 −4 = 60 places to
put the Black King. If the White King is on a side, not in a corner,
then there are 64−6 = 58 places to put the Black King. If the White
King is in the 6 × 6 “inner board,” then there are 64 −9 = 55 places
to put the Black King. So altogether there are
4 · 60 + 24 · 58 + 36 · 55 = 3612
arrangements.
Chapter 2
1. The number of orderings is 8! = 40320.
2. The number of permutations is P (10, 6) = 10 · 9 · 8 · 7 · 6 · 5 = 151200.
33. 70
4. There are 3! diﬀerent orderings of the cities in Germany, 4! orderings
of the cities in France, and 5! orderings of the cities in Spain. Hence,
there are 3!4!5! = 17280 diﬀerent itineraries.
5. The number of arrangements is (3 + 4 + 5)!/(3!4!5!) = 27720.
6. There are 4! ways to order the astronomy books, 5! ways to order the
medical books, and 6! ways to order the religious books. The groups
of books can be ordered in 3! ways.
Hence, there are 4!5!6!3! =
12,441,600 orderings of all the books.
7. The word RHODODENDRON has two Rs, one H, three Os, three Ds,
one E, and two Ns, totaling 12 letters. Hence, the number of ways of
arranging the letters is 12!/(2!1!3!3!1!2!) = 3326400.
8. The number of one-to-one functions is P (7, 3) = 7 · 6 · 5 = 210.
9. The total number of functions is nn and the number of one-to-one
functions is n!. Hence, the number of functions that are not one-to-
one is nn −n!.
10. There are n2 ordered pairs of elements from the given set.
Each
ordered pair can be included or not included in a relation. Hence,
there are 2n2 relations.

A Hints and Solutions to Exercises
203
11. Without the restriction that class A received the wrong lecture, there
are 5! possible orders of the lectures. We must subtract the number
for which A received the right lecture. This is 4! (as the other four
lectures can be permuted arbitrarily). Hence, the number of possible
orderings is 5! −4! = 120 −24 = 96.
12. Without the restriction that A and B cannot both be performed, the
number of programs is P (12, 3) = 12!/9! = 1320. We must subtract
from this those programs that include both A and B. There are ten
choices for the third song in such a program, and there are 3! = 6 ways
to permute the three songs. Hence, the total number of satisfactory
programs is 1320 −10 · 6 = 1260.
13. The number of selections is C(10, 3) = 10!/(3!7!) = 10 · 9 · 8/6 = 120.
14. C(66, 4) = 7059052
15. C(20, 10) = 20!/(10!10!) = 184756
16. By the binomial theorem, the coeﬃcient is
 20
10

= 184756.
17. The tenth row of Pascal’s triangle is 1, 10, 45, 120, 210, 252, 210, 120,
45, 10, 1. Hence
(a + b)10 =a10 + 10a9b + 45a8b2 + 120a7b3 + 210a6b4 + 252a5b5
+ 210a4b6 + 120a3b7 + 45a2b8 + 10ab9 + b10.
18.
 n
2

= n!/(2!(n −2)!) = n(n −1)/2
 n
3

= n!/(3!(n −3)!) = n(n −1)(n −2)/6
19.
 20
5

20. −27 10
7

21.
 20
10

22.
 20
4

23. The formula is equivalent to the relation k!C(n, k) = P (n, k).

204
Pearls of Discrete Mathematics
24.
n −1
k −1

+
n −1
k

=
(n −1)!
(k −1)!(n −k)! +
(n −1)!
k!(n −k −1)!
=
(n −1)! · k
k!(n −k)! + (n −1)! · (n −k)
k!(n −k)!
=
(n −1)! · n
k!(n −k)!
=
n!
k!(n −k)!
=
n
k

†25. The coeﬃcient of an−kbk is the number of ways of selecting n −k
factors a+b that contribute as to the expansion of (a+b)n (the other
factors contribute bs).
26. We are evidently looking for a solution to the equation
 2n
n

= 924. A
check of Pascal’s triangle shows that the only solution to this equation
is n = 6. So there are 12 students in the class.
27. Let L and R be the number of left steps and right steps in a path,
respectively. Then L + R = k and R −L = n, so that R = (n + k)/2.
Hence, the number of paths is C(k, (n + k)/2).
328. c[0, 0] = 1; c[n_, 0] = 1; c[n_, n_] := 1;
c[n_, k_] := c[n, k] = c[n - 1, k] + c[n - 1, k - 1];
c[100,50]
100891344545564193334812497256
29. C(n, 0) + C(n, 1) + C(n, 2)
30. C(n, 0) + C(n, 1) + C(n, 2) + C(n, 3)
Chapter 3
1. (a)
n
k

=
n!
k!(n −k)! =
n(n −1)!
k(k −1)!(n −k)! = n
k
n −1
k −1


A Hints and Solutions to Exercises
205
(b)
−n
k

= (−1)k
n + k −1
k

= (−n)(−n −1)(−n −2) . . .(−n −k + 1)
k!
= (−1)kn(n + 1)(n + 2) . . .(n + k −1)
k!
= (−1)k
n + k −1
k

2. We use a multiplication trick. Let
S = 1 · 2 + 2 · 3 + 3 · 4 + · · · + n(n + 1).
Multiply by 3:
3S =1 · 2 · 3 + 2 · 3 · (4 −1) + 3 · 4 · (5 −2) + · · · + n(n + 1)(n + 2 −(n −1))
=1 · 2 · 3 + 2 · 3 · 4 −1 · 2 · 3 + 3 · 4 · 5 −2 · 3 · 4 + · · ·
+ n(n + 1)(n + 2) −(n −1)n(n + 1).
This telescoping series collapses to yield
3S = n(n + 1)(n + 2)
and hence
S = n(n + 1)(n + 2)/3.
3. Using the same multiplication trick as in the previous exercise, we
can show that
1 · 2 · 3 + 2 · 3 · 4+ · · ·+ n · (n + 1) · (n + 2) = n(n + 1)(n + 2)(n + 3)/4.
4. (a) The left side counts the ways of selecting n elements from the
set {1, 2, 3, . . ., 2n −1}. Suppose that k elements are chosen from
the subset {n + 1, . . ., 2n −1} and the remaining n −k elements are
chosen from the subset {1, 2, 3, . . ., n}. Since   n
n−k
 =  n
k
, the right
side counts these possibilities, for 0 ≤k ≤n.
(b) The left side counts the ways of selecting n elements from the set
{1, 2, 3, . . ., 3n}. Suppose that k elements are chosen from the subset
{1, 2, 3, . . ., 2n} and the remaining n −k elements are chosen from
the subset {2n + 1, . . ., 3n}. Since
  n
n−k

=
 n
k

, the right side counts
these possibilities, for 0 ≤k ≤n.

206
Pearls of Discrete Mathematics
5. (a)
n
k

=
n!
k!(n −k)! =
(n −k + 1)n!
k(k −1)!(n −k + 1)! = n −k + 1
k

n
k −1

(b) From part (a), we have  n
k
k = (n −k + 1)  n
k−1
. Hence,  n
k
 ≥
  n
k−1

if and only if k ≤n−k+1, which is equivalent to k ≤(n+1)/2.
This proves our result.
6. From the previous problem, we have
n
k

= n −k + 1
k

n
k −1

n
k
n −k
k + 1 =

n
k + 1

,
and so
n
k
2 n −k
k + 1 = n −k + 1
k

n
k −1

n
k + 1

.
The inequality follows if we can show that
n −k
k + 1 ≤n −k + 1
k
,
and this inequality is equivalent to 0 ≤n + 1.
7. Apply Pascal’s identity to the binomial coeﬃcient  m
i
 and collapse
the resulting telescoping sum.
8. To compute the number of collisions, we may as well assume that
the particles pass through each other and simply count the number
of passes. In returning to its original position, each particle passes
each other particle twice. Hence, the total number of particle–particle
interactions is 2 · 5 · 4/2 = 20.
9. In order to group 2n people into n pairs, we line up the 2n people,
which may be done in (2n)! ways, and take the ﬁrst two as the ﬁrst
pair, the second two as the second pair, and so on. We have committed
a lot of double-counting. We need to divide by the double-counting
within pairs, (2!)n, and the double-counting due to permutations of
pairs, n!. Hence, the number of pairings is
(2n)!
2nn! =
2n
n
 n!
2n .

A Hints and Solutions to Exercises
207
10. The expression is equal to the number of ways to group 4700 people
into 100 groups of size 47.
11. The binomial coeﬃcient
 m+n+1
n+1

counts the number of (n+1)-element
subsets of the set {1, . . ., m + n + 1}. The (n + 1)st element can be
any number between n + 1 and m + n + 1. This means that the other
elements must be chosen from the set {1, . . ., n+i}, where 0 ≤i ≤m.
These cases are counted by the right side of the relation.
12. The expression is equal to
x d
dx

x d
dx(1 + x)n

evaluated at x = 1/3. Elementary calculus shows that this simpliﬁes
to
4
3
n n(n + 3)
16
.
13. The main idea is that in order to produce a 10 in a binary string, we
need to switch from a run of 0s to a 1 and then from a run of 1s to a
0. There are four cases to consider.
Case (1): The string begins with 0 and ends with 0. There are 2k
places where switches occur. Hence, the number of desired strings is
C(n −1, 2k).
Case (2): The string begins with 0 and ends with 1. There are 2k +1
places where switches occur (the last switch being from a run of 0s to
a run of 1s). Hence, the number of desired strings is C(n −1, 2k + 1).
Case (3): The string begins with 1 and ends with 0. There are 2k −1
places where switches occur. Hence, the number of desired strings is
C(n −1, 2k −1).
Case (4): The string begins with 1 and ends with 1. There are 2k
places where switches occur (the last switch being from a run of 0s
to a run of 1s). Hence, the number of desired strings is C(n −1, 2k).
Therefore, the total number of desired strings is
C(n −1, 2k) + C(n −1, 2k + 1) + C(n −1, 2k −1) + C(n −1, 2k)
= C(n, 2k + 1) + C(n, 2k) = C(n + 1, 2k + 1).
†⋆14. Obviously S0(n) = n.
The formula for S1(n) can be obtained by
noting that 2S1(n) = (n+1)n and hence S1(n) = n(n+1)/2. To ﬁnd
S2(n) and S3(n), we use the following technique. The sum
n
X
i=1
[(i + 1)k+1 −ik+1]

208
Pearls of Discrete Mathematics
is a telescoping series. Hence
(n + 1)k+1 −1 =
n
X
i=1
[(i + 1)k+1 −ik+1]
=
n
X
i=1
k
X
j=0
k + 1
j

ij
=
k
X
j=0
k + 1
j

Sj(n).
Therefore
Sk(n) =
1
k + 1

(n + 1)k+1 −1 −
k−1
X
j=0
k + 1
j

Sj(n)

.
We compute
S2(n) = 1
3

(n + 1)3 −1 −
3
0

n −
3
1
n(n + 1)
2

= n(n + 1)(2n + 1)
6
and, similarly,
S3(n) =
n(n + 1)
2
2
.
The fact that Sk(n) is a monic polynomial in n of degree k +1 is clear
from our method.
315. s[0] := n;
s[k_] := (1/(k + 1))((n + 1)^(k + 1) - 1 -
Sum[Binomial[k + 1, j]s[j], {j, 0, k - 1}])
s[10]
n(6n^{10}+33n^9+55n^8-66n^6+66n^4-33n^2+5)/66
16. (1 + x)−4 = 1 −4x + 10x2 −20x3 + 35x4 −56x5 −84x6 −120x7 + · · ·
317. Series[(1 + 3x)^(-7), {x, 0, 10}]
1-21x+252x^2-2268x^3+17010x^4-112266x^5+673596x^6
-3752892x^7+19702683x^8-98513415x^9-472864392x^10+...

A Hints and Solutions to Exercises
209
†18. In the expansion of (x1+x2+· · ·+xk)n, the coeﬃcient of xα1
1 xα2
2 . . . xαk
k ,
where the αi are nonnegative integers such that α1+α2+· · ·+αk = n,
is the number of ways of selecting αi factors that contribute an xi, for
each i. This is the same as the number of ways of arranging the letters
of an n-element word, where there are αi equivalent letters, for each
i. These arrangements are counted by the multinomial coeﬃcient

n
α1, α2, . . ., αk

=
n!
α1!α2! . . .αk!.
19. By the multinomial theorem, (a+b+c)4 = a4 +4a3b+6a2b2 +4ab3 +
b4 + 4a3c + 12a2bc + 12ab2c + 4b3c + 6a2c2 + 12abc2 + 6b2c2 + 4ac3 +
4bc3 + c4.
20. By the multinomial theorem, the coeﬃcient is
 20
3,7,10

= 22170720.
21. (a)
  25
10,15

= 3268760
(b)
 45
10,15,20

= 10361546974682663760
322. 100!/(10!10!80!)
99026143582326261786805320
23. The total number of pizzas is
1 + 12 +
2 + 12 −1
2

+
3 + 12 −1
3

+
4 + 12 −1
4

= 1820.
24. The number of solutions is  12
2
 = 66.
†25. The number of solutions is  n+k−1
k−1
.
26. The problem is equivalent to counting solutions to
(2x1 + 1) + (2x2 + 1) + · · · + (2xn + 1) = k,
where the xi are nonnegative integers. This equation is equivalent to
x1 + x2 + · · · + xn = (k −n)/2,
and hence the number of solutions is
n + (k −n)/2 −1
(k −n)/2

.
Of course, k and n must have the same parity and k ≥n.

210
Pearls of Discrete Mathematics
27. We prove the equivalent identity
n
X
j=0
n
X
k=0
3
n + j + k
n, j, k

32n−j−k = 33n+1.
The right side counts the number of strings of length 3n+1 composed
of symbols A, B, and C. Each such string contains at least n + 1 As,
Bs, or Cs. Reading the string left to right, suppose that the (n+1)st
occurrence of one symbol takes place in the (n+j +k +1)st position,
where 0 ≤j, k ≤n, and there are already j occurrences of the next
available symbol in cyclic order (A, B, C) and k occurrences of the
next available symbol in cyclic order. The left side counts the number
of strings of this type.
†28. A composition of n can be obtained from a sum of n 1s:
n = 1 + 1 + · · · + 1
|
{z
}
n
.
We can place a vertical line between any two consecutive 1s; summing
the elements bounded by lines, we obtain a composition. For example,
10 = 1 + 1 + 1 + 1 | +1 | +1 + 1 + 1 | +1 + 1
gives the composition 10 = 4 + 1 + 3 + 2. In general, there are n −1
places for the vertical lines, so there are 2n−1 compositions.
†29. We must show that, for any n ≥1, the number of permutations of
X = {1, . . ., n} with an odd number of cycles is equal to the number
of permutations of X with an even number of cycles. Clearly, this is
true for n = 1. Let
A = {perm. of X with odd # of cycles and 1 in a cycle by itself}
B = {perm. of X with odd # of cycles and 1 not in a cycle by itself}
C = {perm. of X with even # of cycles and 1 in a cycle by itself}
D = {perm. of X with oven # of cycles and 1 not in a cycle by itself}.
Since there are n −1 places where 1 can follow one of the other n −1
elements, we have
(n −1)|A| = |D|, (n −1)|C| = |B|.
The relation |A| + |B| = |C| + |D| now follows by induction from the
hypothesis that |A| = |C|.

A Hints and Solutions to Exercises
211
Chapter 4
1. We take successive diﬀerences:
7,
11,
25,
73,
203,
487,
1021,
. . .
4,
14,
48,
130,
284,
534,
. . .
10,
34,
82,
154,
250,
. . .
24,
48,
72,
96,
. . .
24,
24,
24,
. . . .
Having obtained a constant sequence, we stop.
We ﬁnd that the
polynomial is
p(n) = 7 + 4n + 10
n
2

+ 24
n
3

+ 24
n
4

= n4 −2n3 + 4n2 + n + 7.
2. We see that the p(n) = n5.
3.
n3 + 2n2 −n + 1 = 6
n
3

+ 10
n
2

+ 2
n
1

+ 1
n
0

4. Deﬁne q(n) = p(2n).
†5. Given a polynomial p(n) of degree d, we choose the coeﬃcient of  n
d

to be d! times the leading coeﬃcient of p. This “kills oﬀ” the degree d
term of p. We repeat this procedure on the remainder until the entire
polynomial is a linear combination of the
 n
k

terms.
†6. The expression nd counts all functions from {1, . . ., d} to {1, . . ., n}.
Each such function is onto some nonempty subset of {1, . . ., n}. The
summation counts these onto functions according to the size k of the
image.
37. One way to ﬁnd p(m, n) is to use matrices. Let the given matrix be
D (for data). Deﬁne
P =


1
1
1
1
1
1
0
1
2
3
4
5
0
1
4
9
16
25
0
1
8
27
64
125
0
1
16
81
256
625
0
1
32
243
1024
3125


.
The columns of P are powers of m, for 0 ≤m ≤5. Then deﬁne
C = (P t)−1DP −1.

212
Pearls of Discrete Mathematics
Finally,
p(m, n) =
6
X
i=1
6
X
j=1
[C]ijmi−1nj−1.
With the matrix D of our problem, we obtain
p(m, n) = m3n2 + mn + 5m + 6n + 10.
Why does this method work?
8. Find the degree of the polynomial that gives this sequence.
9. 3n3 + 2n2 + n + 1
10. Even p(0) = 1 and p(2) = 2 is impossible.
Chapter 5
1. (1 + x)−5 = 1 −5x + 15x2 −35x3 + 70x4 −126x5 + · · ·
2. (1 −x2)−4 = 1 + 4x2 + 10x4 + 20x6 + 35x8 + 56x10 + · · ·
3. Row −6 begins
0 1 −6 21 −56 126 −252.
4. 49/64
5. 27
6. n = 3
7. If n is positive, then
 n
4

= 15, and we see by inspecting Pascal’s
triangle that the only solution is n = 6.
If n is negative, then
 −n+4−1
4

= 15, and we ﬁnd that n = −3.
38. c[n_, -1] := 0; c[0, k_] := 0;
c[0, 0] = 1; c[n_, k_] := c[n, k] =
If[n = 0, c[n-1, k-1] + c[n-1, k], c[n+1, k] - c[n, k-1]];
Table[c[n, k], {n, -10, 10}, {k, 0, 10}] // TableForm

A Hints and Solutions to Exercises
213
Chapter 6
1. The identity holds for n = 1, since F1 = 1 = 2 −1 = F3 −1. Assume
that the identity holds for n. Then
F1 + · · · + Fn+1 = (F1 + · · · + Fn) + Fn+1
= Fn+2 −1 + Fn+1
= Fn+3 −1.
Hence, the identity holds for n + 1 and by induction for all n ≥1.
2. The identity holds for n = 1, since F 2
1 = 1 = 1 · 1 = F1F2. Assume
that the identity holds for n. Then
F 2
1 + · · · + F 2
n+1 = (F 2
1 + · · · + F 2
n) + F 2
n+1
= FnFn+1 + F 2
n+1
= Fn+1(Fn + Fn+1)
= Fn+1Fn+2.
Hence, the identity holds for n + 1 and by induction for all n ≥1.
3. It follows by induction that
 1
1
1
0
n
=
 Fn+1
Fn
Fn
Fn−1

,
n ≥1.
Hence

Fm+n+1
Fm+n
Fm+n
Fm+n−1

=

1
1
1
0
m+n
=

1
1
1
0
m 
1
1
1
0
n
=
 Fm+1
Fm
Fm
Fm−1
  Fn+1
Fn
Fn
Fn−1

.
Considering the (2, 1) entry of this matrix identity, we obtain the
desired relation.
34. f[0] = 0; f[1] = 1; f[n_] := f[n] = f[n - 1] + f[n - 2];
f[100]
354224848179261915075

214
Pearls of Discrete Mathematics
5. The Fibonacci numbers are sums of “shallow diagonals” of Pascal’s
triangle. For example,
1 + 10 + 15 + 7 + 1 = 34.
The identity is
n
0

+
n −1
1

+
n −2
2

+ · · · = Fn+1,
n ≥0.
You can prove the identity by induction.
6. The equation is equivalent to
n + 1
k + 1

=

n
k + 2

.
Hence, we have
14
4

+
14
5

=
14
6

= 3003.
⋆7. Using Cassini’s identity, we have
∞
X
n=1
tan−1
1
F2n+1
=
∞
X
n=1
tan−1 F2n+1
F 2
2n+1
=
∞
X
n=1
tan−1
 F2n+2 −F2n
F2nF2n+2 + 1

=
∞
X
n=1
tan−1
 1/F2n −1/F2n+2
1 + 1/(F2nF2n+2)

=
∞
X
n=1

tan−1
1
F2n
−tan−1
1
F2n+2

= tan−1 1
F2
= tan−1 1
= π
4 .
38. The number 210 occurs six times in Pascal’s triangle:
210 =
210
1

=
210
209

=
10
3

=
10
7

=
16
2

=
16
14

.

A Hints and Solutions to Exercises
215
39.
 104
39

= 61218182743304701891431482520
10. The characteristic polynomial of the sequence {an} is
x2 −5x −6 = (x −3)(x −2).
Hence
an = A3n + B2n,
n ≥0,
for some constants A and B.
From the initial values, a0 = 0 and a1 = 1, we ﬁnd that
A + B = 0
3A + 2B = 1,
and hence A = 1, B = −1. Therefore
an = 3n −2n,
n ≥0.
11. The characteristic polynomial is
x3 −3x2 −4x + 12,
with roots −2, 2, and 3. Hence
an = A(−2)n + B2n + C3n,
for some constants A, B, and C.
With the initial values a0 = 0,
a1 = 1, and a2 = 2, we ﬁnd that
an = −3
20(−2)n −1
42n + 2
53n,
n ≥0.
12. The characteristic polynomial is
x3 −4x2 + x + 6,
with roots 3, 2, and −1. Hence
bn = A3n + B2n + C(−1)n,
n ≥0,
for some constants A, B, and C.
With the initial values b0 = 0, b1 = 0, b2 = 1, we ﬁnd that
bn = 1
43n −1
32n + 1
12(−1)n,
n ≥0.
With the initial values b0 = 0, b1 = 1, b2 = 2, we ﬁnd that
bn = 1
43n −1
4(−1)n,
n ≥0.

216
Pearls of Discrete Mathematics
13. Since cn = an + bn, the characteristic roots of {cn} include the char-
acteristic roots of {an} and {bn}. The characteristic roots of {an}
are 2 and 3. The characteristic roots of {bn} are 4 and 5. Hence, a
characteristic polynomial for {cn} is
(x −2)(x −3)(x −4)(x −5) = x4 −14x3 + 71x2 −154x + 120,
and the recurrence for {cn} is
c0 = 1, c1 = 2, c2 = 14, c3 = 80,
cn = 14cn−1 −71cn−2 + 154cn−3 −120cn−4,
n ≥4.
The characteristic roots of {dn} are 8, 10, 12, and 15. Hence, the
characteristic polynomial for {dn} is (x−8)(x−10)(x−12)(x−15) =
x4 −45x3 + 746x2 −5400x + 14400. Hence, a recurrence relation is
dn = 45dn−1 −746dn−2 + 5400dn−3 −14400dn−4,
n ≥4.
14. The characteristic roots of {an} are φ, ˆφ, and 2. Hence, the charac-
teristic polynomial is
(x2 −x −1)(x −2) = x3 −3x2 + x + 2,
and a recurrence relation is
an = 3an−1 −an−2 −2an−3,
n ≥3.
15. The answer is the same for (a) and (b). The characteristic polynomial
is
(x −3)(x −1)2 = x3 −5x2 + 7x −3.
Hence, the recurrence relation is
an = 5an−1 −7an−2 + 3an−3,
n ≥3.
16. We ﬁnd the particular solution an = −n−3 to the recurrence relation.
Hence, the general solution is of the form
an = Aφn + B ˆφn −n −3.
We need to choose A and B so that the initial values are satisﬁed.
Thus,
0 = A + B −3
1 = Aφ + B ˆφ −4.

A Hints and Solutions to Exercises
217
We ﬁnd that
A = (3ˆφ −5)/(ˆφ −φ) = (15 + 7
√
5)/10
B = (3φ −5)/(φ −ˆφ) = (15 −7
√
5)/10.
17. We obtain a particular solution assuming it has the form α2n. Thus
α2n = α2n−1 + α2n−2 + 2n,
which implies that α = 4. Therefore, the solution is
an = Aφn −B ˆφn + 4 · 2n,
n ≥0,
for some constants A and B. With the initial values, we ﬁnd that
A = (−2
√
5 −6)/5 and B = 2(5 −3
√
5)/5.
18. The identity holds for n = 1, as L1 = 1 = 0 + 1 = F0 + F1. Assume
that the identity holds for n −1 and n. Then
Ln+1 = Ln−1 + Ln
= (Fn−2 + Fn) + (Fn−1 + Fn+1)
= (Fn−2 + Fn−1) + (Fn + Fn+1)
= Fn + Fn+2.
Hence, the identity holds for n + 1 and by induction for all n ≥1.
19. The identity holds for n = 1, as F1 = 1 = (2 + 3)/5 = (L0 + L1)/5.
Assume that the identity holds for n −1 and n. Then
Fn+1 = Fn−1 + Fn
= (Ln−2 + Ln)/5 + (Ln−1 + Ln+1)/5
= (Ln−2 + Ln−1)/5 + (Ln + Ln+1)/5
= (Ln + Ln+2)/5.
Hence, the identity holds for n + 1 and by induction for all n ≥1.
20. We have
FnLn =
1
√
5(φn −ˆφn)(φn + ˆφn) =
1
√
5(φ2n −ˆφ2n) = F2n.
21. L2
n −Ln−1Ln+1 = 5(−1)n,
n ≥1

218
Pearls of Discrete Mathematics
22. For any cubic polynomial p(n), we have 0 = ∆4p(n), where ∆is the
diﬀerence operator. Hence
0 = p(n + 4) −4p(n + 3) + 6p(n + 2) −4p(n + 1) + p(n),
and a recurrence relation satisﬁed by all cubic polynomials is
an = 4an−1 −6an−2 + 4an−3 −an−4,
n ≥4.
23. We have a0 = 0, a1 = 1, a2 = 36, and a3 = 1225 (the last value
perhaps via a computer). The square roots of these numbers are 0,
1, 6, and 35, so we guess that the square roots satisfy the recurrence
relation bn = 6bn−2 −bn−2, for n ≥2. The characteristic polynomial
of this recurrence is x2 −6x + 1, with roots r1 and r2. From the form
of the characteristic polynomial, we ﬁnd that r2
1 + r2
2 = (r1 + r2)2 −
2r1r2 = 62 −2 = 34 and r2
1r2
2 = (r1r2)2 = 1, so the characteristic
polynomial of {an} is (x2 −34x + 1)(x −1) = x3 −35x2 + 35x −1,
and a recurrence relation is an = 35an−1 −35an−2 + an−2, for n ≥2.
24. Let an = 2nFn, for n ≥0. Then a0 = 0, a1 = 2, and an = 2an−1 +
4an−2, for n ≥2.
25. Start with the relations
Fn = Fn−1 + Fn−2
Fn−3 = Fn−1 −Fn−2.
Square both equations and add:
F 2
n + F 2
n−3 = (Fn−1 + Fn−2)2 + (Fn−1 −Fn−2)2
= 2F 2
n−1 + 2F 2
n−2.
And so we obtain the recurrence formula
F 2
0 = 0, F 2
1 = 1, F 2
2 = 1,
F 2
n = 2F 2
n−1 + 2F 2
n−2 −F 2
n−3,
n ≥3.
⋆26. The characteristic polynomial of the recurrence relation for the kth
powers of the Fibonacci numbers is
⌊(k−1)/2⌋
Y
i=0
(x2+(−1)i+1Lk−2ix+(−1)k)·



1
if k mod 4 = 1, 3
(x −1)
if k mod 4 = 0
(x + 1)
if k mod 4 = 2,
where Ln is the nth Lucas number.

A Hints and Solutions to Exercises
219
Chapter 7
1. (xf′(x))|x=1/3 = 6/5
2. The generating function is (2 −x)/(1 −x −x2).
3. The denominator is 1−5x +6x2. To ﬁnd the numerator, we multiply
x(1−5x+6x2), keeping only those terms of degree less than 2; so the
numerator is x. Hence, the generating function is x/(1 −5x + 6x2).
4. We put x = −1/10 in the generating function and obtain the value
−5/78.
5. Deﬁne {an} by a0 = 1, a1 = −3, and an = −3an−1 −an−2, for n ≥2.
6. While we can give a proof by induction, a fast proof uses generating
functions. Since
∞
X
n=0
Fnxn =
x
1 −x −x2 ,
we have
∞
X
n=0
(−1)nF2n+2x2n+2 = 1
2

x
1 −x −x2 +
−x
1 + x −x2

=
x2
1 −3x2 + x4 ,
and the desired formula follows.
7. Deﬁne {an} by a0 = 1, a1 = −1, and an = −an−1 −2an−2, for n ≥2.
8. x(x((1 −x)−1)′)′ = x(x + 1)(1 −x)−3
39. Series[
1/((1-x)(1-x^5)(1-x^10)(1-x^25)(1-x^50)(1-x^100)),
{x, 0, 100}]
...+50x^50+...
310. The generating function
((1 + x)(1 + x5)(1 + x10)(1 + x25)(1 + x50)(1 + x100))−1
counts the diﬀerence between the number of ways of making change
with an even number of coins and an odd number of coins.
The
coeﬃcient of x100 is 19. Let e and o be the number of ways of making
change for $1 with an even number of coins and an odd number of
coins, respectively. Then e −o = 19 and e + o = 293. Hence e = 156.

220
Pearls of Discrete Mathematics
11. The coeﬃcients of the generating function for the diﬀerence between
sums with an odd number of coins and sums with an even number of
coins alternate between positive and negative. Surprisingly, there is
a one-line proof of this fact:
1
(1 + x)(1 + x5)(1 + x10)(1 + x25)(1 + x50)(1 + x100)
=
(1 −x)(1 −x5)(1 −x25)
(1 −x2)(1 −x20)(1 −x200).
We need to interpret this equation to see that it proves that the
coeﬃcients alternate in sign. The numerator is a polynomial with
alternating coeﬃcients, while the denominator is equal to an inﬁnite
series with only positive coeﬃcients of even powers of x. Hence the
resulting series has alternating coeﬃcients.
Is the condition 2k ∈S =⇒k ∈S necessary as well as suﬃcient?
12. We ﬁll in the following table by hand.
Pn
Nn
Dn
Qn
Hn
Wn
5
1
1
0
0
0
0
10
1
2
1
0
0
0
15
1
3
2
0
0
0
20
1
4
4
0
0
0
25
1
5
6
1
0
0
30
1
6
9
2
0
0
35
1
7
12
4
0
0
40
1
8
16
6
0
0
45
1
9
20
9
0
0
50
1
10
25
13
1
0
54
1
11
30
18
2
0
60
1
12
36
24
4
0
65
1
13
42
31
6
0
70
1
14
49
39
9
0
75
1
15
56
49
13
0
80
1
16
64
60
18
0
85
1
17
71
73
25
0
90
1
18
81
87
31
0
95
1
19
89
103
39
0
100
1
20
100
121
50
1
We conclude that the number of ways to make change for a dollar is
P100 + N100 + D100 + Q100 + H100 + W100 = 293.

A Hints and Solutions to Exercises
221
13. (a)
1
1 −x −y =
1
1 −(x + y) = 1 + (x + y) + (x + y)2 + (x + y)3 + · · ·
(b)
1
1 −x −y −z =
1
1 −(x + y + z) = 1+(x+y+z)+(x+y+z)2+(x+y+z)3+· · ·
314. We ﬁnd that
1
(1 −x)(1 −x2)(1 −x4)
=
1
8(1 −x)3 +
1
4(1 −x)2 +
9
32(1 −x) +
1
16(1 + x)2 +
5
32(1 + x) +
1 + x
8(1 + x2).
The coeﬃcient of xn is
1
8
−3
n

(−1)n + 1
4
−2
n

(−1)n + 9
32 + 1
16
−2
n

+ 5
32(−1)n
+

1
8(−1)n/2
n even
1
8(−1)(n−1)/2
n odd

.
Using the identity
 −α
n

= (−1)n α+n−1
n

, this simpliﬁes to
(n + 2)(n + 1)
16
+ n + 1
4
+ 9
32 + (n + 1)(−1)n
16
+ 5
32(−1)n
+

1
8(−1)n/2
n even
1
8(−1)(n−1)/2
n odd

.
Hence, the number of solutions with n = 1030 is
62500000000000000000000000000500000000000000000000000000001.
315. We ﬁnd that
1
(1 −x)(1 −x2)(1 −x3)
=
1
6(1 −x)3 +
1
4(1 −x)2 +
17
72(1 −x) +
1
8(1 + x) +
2 + x
9(1 + x + x2).
The coeﬃcient of xn is
1
6
−3
n

(−1)n + 1
4
−2
n

(−1)n + 17
72 + 1
8(−1)n + (pattern mod 3).

222
Pearls of Discrete Mathematics
This simpliﬁes to
(n + 2)(n + 1)
16
+ n + 1
4
+ 17
72 + 1
8(−1)n + (pattern mod 3).
Plugging in n = 1030, we ﬁnd that the number of solutions is
1
6(1032 + 2)(1030 + 1) + 1
4(1030 + 1) + 17
72 + 1
8 −1
9 = 8 3 . . .3
| {z }
57
4.
This is equal to the number of partitions of 1030 into 1, 2, or 3 parts:
1 + 1030
2
+
(1030)2
12

.
316. We ﬁnd that
1
(1 −x)(1 −x2)(1 −x4) =
1
12(1 −x)3 +
5
24(1 −x)2
+
41
144(1 −x) +
1
16(1 + x) +
1
4(1 + x2) +
1 + 2x
9(1 + x + x2).
The coeﬃcient of xn is
1
12
−3
n

(−1)n + 5
24
−2
n

(−1)n + 41
144 + 1
16(−1)n
+ (pattern mod 4) + (pattern mod 3).
This simpliﬁes to
(n + 2)(n + 1)
24
+ 5(n + 1)
24
+ 41
144 + 1
16(−1)n
+ (pattern mod 4) + (pattern mod 3).
With n = 1030, we have
4 6 . . .6
| {z }
26
7 0 . . .0
| {z }
29
1
solutions.
⋆17. Let E be the operator xDx. We will show that Ek(1+x)n is a function
of the form (1 + x)n−kq(x, n), where q is a polynomial in x and n, of
degree k in x, with leading term nkxk. The result then follows upon
letting x = 1. The binomial theorem says that
n
X
i=1
n
i

xi = (1 + x)n,

A Hints and Solutions to Exercises
223
so the claim is true for k = 0. Assume that it is true for k. Then
Ek+1(1 + x)n = xDx(1 + x)n−kq(x, n)
= x(n −k)(1 + x)n−k−1q(x, n) + x(1 + x)n−kq′(x, n)
= (1 + x)n−k−1[x(n −k)q(x, n) + x(1 + x)q′(x, n)].
The leading term of the second factor is
xk+1nk(n −k) + x2kxk−1nk = nk+1xk+1.
Hence, the result is true for k + 1 and by induction for all k ≥0.
Upon plugging in x = 1, we obtain the desired result.
18. Let
u =
∞
X
n=0
n!xn +
∞
X
n=0
(2x)n
=
∞
X
n=0
n!xn +
1
1 −2x.
Then
ux =
∞
X
n=0
n!xn+1 +
x
1 −2x
and so
(ux)′ = u′x + u =
∞
X
n=0
(n + 1)!xn +
1
(1 −2x)2 .
Hence
u′x2 + ux =
∞
X
n=0
(n + 1)!xn+1 +
x
(1 −2x)2 .
It follows that
u′x2(2x −1)2 + u(x −1)(2x −1)2 = g(x),
where g(x) is a polynomial. Upon identifying the coeﬃcient of xn,
we obtain the recurrence relation
an = (n + 4)an−1 −4nan−2 + (4n −8)an−3,
n ≥3.
⋆19. The generating function that indicates all positive integers is 1/(1−x).
Find the generating function that indicates amounts that can be made
and subtract from 1/(1 −x). Show that the result is a polynomial
and ﬁnd its degree and number of nonzero terms.

224
Pearls of Discrete Mathematics
320.
13333398333445333413833354500001 .= 1.3 × 1031
⋄⋆21.
4012504634719967902995238092061023959932853457130267501 .= 4.0×1054
Chapter 8
1. 20833
32. The partial fractions decomposition is
−
1
24(x −1)3 +
13
288(x −1) −
1
16(x + 1)2 −
1
32(x + 1)
−
x + 1
8(x2 + 1) +
x + 2
9(x2 + x + 1).
Use binomial series.
3. The triangles (4, 4, 7) and (1, 2, 2) both have an angle with cosine 7/8.
(The triangle (2, 3, 4) has the same angle.) The triangles (3, 7, 8) and
(5, 7, 8) both have an angle of 60◦and hence cosine 1/2.
34. Use the law of cosines.
5. Use the law of cosines.
36. (11, 39, 49)
7. Let s(n) be the number of scalene integer triangles of perimeter n.
Then s(n) = t(n −6), for n ≥6. Let (a, b, c) be a scalene triangle
and consider the triangle (a −1, b −2, c −3). Alternatively, ﬁnd the
generating function by building up from the smallest scalene triangle.
8. We will show that for k ≥3, there are more triangles with (odd)
perimeter 2n + 1 than triangles with (even) perimeter 2k or 2k + 2.
Suppose that a triangle with perimeter 2k has sides a, b, c, with
a ≤b ≤c. Then the triangle with sides a, b, c + 1 has perimeter
2k + 1, and it is a genuine triangle because a + b = c + 1 is impossible
since 2k +1 is odd. Also, the triangle with sides 1, k, k does not come
from such a transformation, so t(2k +1) is strictly greater than t(2k).
Similarly, starting with a triangle with sides a, b, c, where a ≤b ≤c,
and a + b + c = 2k + 2, we ﬁnd that the triangle with sides a, b, and
c−1 satisﬁes the triangle inequality. Also, the triangle with sides 1, k,
k does not come from such a transformation, so t(2k +1) > t(2k +2).
Notice that the restriction k ≥3 is needed to ensure that the triangle
with sides 1, k, k isn’t the only triangle with perimeter 2k + 1.

A Hints and Solutions to Exercises
225
9. The only such number is n = 48.
10. We can ﬁnd a simple formula for t(n), where n has any given remain-
der upon division by 12. Thus
t(12k) = 3k2
t(12k + 1) = 3k2 + 2k
t(12k + 2) = 3k2 + k
t(12k + 3) = 3k2 + 3k + 1
t(12k + 4) = 3k2 + 2k
t(12k + 5) = 3k2 + 4k + 1
t(12k + 6) = 3k2 + 3k + 1
t(12k + 7) = 3k2 + 5k + 2
t(12k + 8) = 3k2 + 4k + 1
t(12k + 9) = 3k2 + 6k + 3
t(12k + 10) = 3k2 + 5k + 2
t(12k + 11) = 3k2 + 7k + 4.
Since these formulas are all quadratic polynomials, t(n) satisﬁes the
recurrence relation
t(12k + r) = 3t(12(k −1) + r) −3t(12(k −2) + r) + t(12(k −3) + r).
(See Exercise 22 of Chapter 6.) The desired recurrence relation follows
immediately.
⋆11. First, we prove that the period of {t(n) mod m} is at most 12m. If n
is even, we may write n = 12m + 2r and we have
t(12m + 2r) = {(12m + 2r)2/48}
= 3m2 + mr + {(2r)2/48}
≡t(2r)
(mod m).
The odd case is similar, so that t(12m + u) ≡t(u) mod m, for all u.
Hence, the period of {t(n) mod m} is a divisor of 12m and therefore
at most 12m.

226
Pearls of Discrete Mathematics
Second, we show that the period of {t(n) mod m} is at least 12m.
Suppose that the period is p. Then let k = p or p −1 so that k is
even. We then have {k2/48} ≡0 (mod m) and {(k + 2)2/48} ≡0
(mod m) since t(−1) = t(0) = t(1) = t(2) = 0. Thus, m divides
{(k + 2)2/48} −{k2/48}, which is nonzero because p > 12.
This
diﬀerence is less than (k + 2)2/48 −k2/48 + 1 = (k + 13)/12. Hence
12m < k + 13 ≤p + 13, and this completes the proof since 12m is a
multiple of p and p > 12.
Note. Every linear recurrence sequence is periodic with respect to
any given modulus. The period is the least common multiple of the
periods with respect to the prime power divisors of the modulus. It is
surprising that for the well-studied Fibonacci sequence, no formula is
known for the periods with respect to prime power moduli; however,
it is known that the period modulo 2n is 3 · 2n−1 and the period
modulo 5n is 4 · 5n.
12. One such inﬁnite family of pairs is (2n, 4n2 −3n + 1, 4n2 −3n + 1)
and (2n2 −n + 1, 2n2 −n + 1, 4n2 −2n), where n ≥2, with common
perimeter 8n2 −4n + 2 and common area n(2n −1)
√
4n2 −2n + 1.
Chapter 9
1. The recurrence formula is
k(1, 1) = 1;
k(0, n) = 0; k(m, 0) = 0;
k(m, n) = k(m −1, n) + k(m, n −1) + k(m −1, n −1),
m, n ≥1.
We calculate k(8, 8) = 48639.
2. This is the number of compositions (ordered partitions) of n. See
p. 18.
33. 75059524392.

A Hints and Solutions to Exercises
227
34.
0
0
0
−2
1
0
0
3
1
−2
0
0
−4
3
0
0
0
0
0
0
0
0
0
0
0
0
0
3
1
−2
0
−4
−2
3
1
0
1
−4
−2
3
0
5
1
−4
0
0
0
0
0
0
0
0
−4
3
0
0
1
−4
−2
3
5
5
4
−4
−4
−6
−2
5
1
0
0
−6
5
0
0
0
0
0
0
0
0
5
1
−4
0
−6
−2
5
1
0
1
−6
−2
5
0
7
1
−6
0
0
0
0
0
0
0
0
0
0
0
0
0
−6
5
0
0
7
1
−6
0
0
−8
7
0
0
0
The number of Queen paths from (0, 0, 0) to (7, 7, 7) is 1,540,840,801,552.
5. The generating function is
(1 −x)(1 −xy)
1 −2(x + xy) + 3(x · xy).
Hence, the recurrence formula is
a(m, n) = 2a(m −1, n) + 2a(m −1, n −1) −3a(m −2, n −1).
The initial values are a(0, 0) = 1, a(1, 0) = 1, a(2, 0) = 2, a(1, 1) = 1,
and a(2, 1) = 4.

228
Pearls of Discrete Mathematics
36. We have
a(n) = 2a(n −1) + 2a(n −2) −3a(n −3),
n ≥4,
a(0) = 1, a(1) = 1, a(2) = 3, a(4) = 6.
With the help of a computer, we ﬁnd that
a(100) = 870338141873214655919573200648700175
.= 8.7 × 1035.
7. The only value is n = 3. To prove uniqueness, consider the sequence
modulo 3.
⋆8.
X X
a(m, n)xmyn =
1
1 −(x/(1 −x)) −(y/(1 −y))
=
∞
X
k=0

x
1 −x

+

y
1 −y
k
=
∞
X
p=0
∞
X
q=0
p + q
p
 
x
1 −x
p 
y
1 −y
q
a(m, n) =
m
X
p=0
n
X
q=0
p + q
p
m −1
p −1
n −1
q −1

⋆9.
(a) The recurrence formula is
a(0, 0) = 1; a(0, 1) = 1; a(1, 0) = 1;
a(−1, n) = 0; a(−2, n) = 0; a(m, −1) = 0; a(m, −2) = 0;
a(m, n) = a(m −1, n) + a(m −2, n) + a(m, n −1) + a(m, n −2),
m, n ≥2.
(b) The generating function is
1
1 −s −t −s2 −t2 .
(c) Set st = x and ﬁnd s0.

A Hints and Solutions to Exercises
229
⋆10.
(a) The recurrence formula is
b(0, 0) = 1; b(0, 1) = 1; b(1, 0) = 1; b(1, 1) = 3;
b(2, 0) = 2; b(0, 2) = 2; b(2, 1) = 7; b(1, 2) = 7; b(2, 2) = 21;
b(m, −1) = 0; b(m, −2) = 0; b(−1, n) = 0; b(−1, n) = 0;
b(m, n) = 2b(m −1, n) + 2b(m, n −1) −2b(m −1, n −1)
−b(m −2, n −1) −b(m −1, n −2) + b(m −2, n −2),
m, n ≥2.
(b) The denominator of the generating function is
1 −2s −2t + 2st + s2t + st2 −s2t2.
(c) Set st = x and ﬁnd s0.
⋆11.
(a) The recurrence formula is
c(0, 0) = 1; c(0, 1) = 1; c(1, 0) = 1;
c(−1, n) = 0; c(−2, n) = 0; c(m, −1) = 0; c(m, −2) = 0;
c(m, n) = 2c(m −1, n) −c(m −1, n −1) + c(m, n −1),
m, n ≥2.
(b) The denominator of the generating function is
1 −2s −t + st.
(c) Set st = x and ﬁnd s0.
⋆12.
(a) The recurrence formula is
d(0, 0) = 1; d(0, 1) = 1; d(1, 0) = 1; d(1, 1) = 3;
d(−1, n) = 0; d(m, −1) = 0;
d(m, n) = d(m −1, n) + d(m, n −1)
+ 2d(m −1, n −1) −d(m −2, n −1) −d(m −1, n −2),
m, n ≥2.
(b) The generating function is
1 −st
1 −s −t −2st + s2t + st2 .
(c) Set st = x and ﬁnd s0.

230
Pearls of Discrete Mathematics
13. The generating function is
1
1 −t(x/(1 −x)) −t(y/(1 −y)) =
(1 −x)(1 −y)
1 −x −tx −y −ty + xy + 2txy.
We read oﬀthe recurrence relation:
a(m, n; k) = a(m −1, n; k) + a(m −1, n; k −1) + a(m, n −1; k)
+ a(m, n −1; k −1) −a(m −1, n −1; k) −2a(m −1, n −1; k −1).
14. A generalized Knight path from (0, 0) to (m, n) is possible if and only
if there exist nonnegative integers α and β such that α(1, 2)+β(2, 1) =
(m, n). Solve this system for α and β. Then ﬁnd a connection between
generalized Knight paths and Rook paths.
315. The number of Nim games is equal to the number of Rook paths from
(0, 0, 0) to (10, 10, 20).
316. The recurrence formula is
a0 = 1, a1 = 6, a2 = 222, a3 = 9918;
0 = (2n3 −2n2)an + (−121n3 + 212n2 −85n −6)an−1
+ (−475n3 + 3462n2 −7853n + 5658)an−2
+ (1746n3 −14580n2 + 40662n −37908)an−3
+ (−1152n3 + 12672n2 −46080n + 55296)an−4,
n ≥4.
This result is empirical; we don’t have a proof of it.
Chapter 10
1. The sample space consists of all partitions of 52 cards into two subsets
of size 26. The number of such partitions is
 52
26

. The probability of
each simple event is 1/
 52
26

.
2. The sample space consists of all ordered pairs of numbers between 1
and 6. The probability that the sum of the two dice is 7 is 6/36 = 1/6.
3. The probability that the sum is at least 17 is (1 + 3)/216 = 1/54.
4.
Pr

X < n
2

=
1
2
n ⌊n/2⌋
X
k=0
n
k

=
1
2
n
2n−1 = 1
2

A Hints and Solutions to Exercises
231
5. The expected number of ﬂips is
1q +2pq +3p2q +4p3q +5p4q +· · · = q(1+2p+3p2 +4p3 +5p4 +· · ·).
From the series (1−x)−1 = 1+x+x2+x3+· · · , we obtain ((1−x)−1)′ =
(1 −x)−2 = 1 + 2x + 3x2 + 4x3 + · · ·. Hence, the expected number of
ﬂips is p(1 −q)−2 = 1/p.
6. For 2 ≤i ≤n, let Xi be a random variable equal to 1 if the ith element
in the string begins a run, and 0 otherwise. Then, for each i, we have
E(Xi) = pq+qp = 2pq (conditioning on the previous element). Hence,
the expected value of the sum of the Xi is 2pq(n −1). Since the ﬁrst
element in the string begins a run, the expected number of runs is
2pq(n −1) + 1.
7. For 1 ≤i ≤365, let Xi = 1 if date i is among the birth dates.
Then each E(Xi) = 1 −(364/365)n, so that E(X1 + · · · + X365) =
365(1 −(364/365)n).
†8. A recurrence formula for {dn} is
d0 = 1, d1 = 0; dn = (n −1)(dn−1 + dn−2),
n ≥2.
In a derangement of {1, 2, 3, . . ., n}, the element n occurs in a cycle
of length 2 or in a cycle of greater length. In a cycle of length 2, there
are n −1 choices for the other element, while the remaining elements
constitute a derangement of n −2 elements.
In a cycle of length
greater than 2, there are n −1 choices for the element that precedes
n, while the elements other than n constitute a derangement of n −1
elements.
39. d[0] = 1; d[1] = 0;
d[n_] := d[n] = (n - 1)(d[n - 1] + d[n - 2]);
d[30]
97581073836835777732377428235481
†10. The formula holds for n = 2, since d2 = 1 = 2d1 −1. Assume that
the formula holds for n. Then
dn+1 = n(dn−1 + dn)
= ndn−1 + ndn
= dn −(−1)n + ndn
= (n + 1)dn + (−1)n+1.

232
Pearls of Discrete Mathematics
Hence, the formula holds for n + 1 and by induction for all n ≥2.
The recurrence relation implies the formula dn = Pn
j=0(−1)jn!/j!.
†⋆11. Let
d(x) =
∞
X
n=0
dn
xn
n! .
From a recurrence relation for {dn}, we ﬁnd that
(1 −x)d′(x) = xd(x).
We solve this diﬀerential equation using separation of variables:
Z d′(x)
d(x) dx =
Z
x
1 −x dx
and hence
d(x) = C e−x
1 −x,
for some constant C.
The condition d0 = 1 implies that C = 1.
Therefore
d(x) = e−x
1 −x.
⋆12.
E
=
1
n!
n
X
k=1
k
n
k

dn−k
=
n
X
k=1
k
k!(n −k)!
n−k
X
j=0
(−1)j (n −k)!
j!
=
n−1
X
k=0
n−k−1
X
j=0
(−1)j
k!j!
=
n−1
X
t=0
X
k+j=t
(−1)j
k!j!
=
1 +
n−1
X
t=1
1
t!
t
X
j=0
(−1)j
t
j

=
1 +
n−1
X
t=1
1
t! · 0
=
1

A Hints and Solutions to Exercises
233
13. Let Xi, for 1 ≤i ≤52, be 1 if the ith card in the two decks matches
and 0 otherwise. Then the expected number of matches is
E(X1 + · · · + Xn) = E(X1) + · · · + E(Xn) = 1
n + · · · + 1
n = 1.
⋆14. The probability of exactly two players having a hand with all cards
the same suit is
4
2
4
2

2
26
13

−2

/
52
13
39
13
26
13
13
13

,
(as there are two non-allowed hands for the two players that don’t
have a hand with all cards the same suit).
It is not possible for
exactly three players to have all cards of the same suit. Hence, the
probability of exactly one player having a hand with all cards the
same suit is
18772910672458601
745065802298455456100520000 −
1733433
124177633716409242683420000
−
24
 52
13
 39
13
 26
13
 =
242753155112819
9634471581445544690955000.
We can also solve the problem by deﬁning six events Ei,j, where
1 ≤i < j ≤4, equal to the probability that players i and j both have
perfect hands, and using the inclusion–exclusion principle.
†⋆15. Suppose that the factorization of n into prime powers is n = Qk
i=1 pαi
i .
For 1 ≤i ≤k, let Xi = {y : 1 ≤y ≤n and pi | y}. Then
φ(n)
=
n −|X1 ∪· · · ∪Xk|
=
n −
 n
p1
+ n
p2
+ · · ·

+
 n
p1p2
+
n
p1p3
+ · · ·

−· · ·
=
n

1 −1
p1

· · ·

1 −1
pk

.
⋆16. Using Stirling’s estimate,
n! ∼nnen√
2πn,
we obtain
2n
n

= (2n)!
n!n! ∼
22n
√
2πn,
from which the result follows directly.

234
Pearls of Discrete Mathematics
⋆17. Assume that die P takes the values 1, 2, 3, 4, 5, 6 with probabilities
p1, p2, p3, p4, p5, p6, respectively, and die Q takes the values 1, 2, 3,
4, 5, 6 with probabilities q1, q2, q3, q4, q4, q5, q6, respectively. Then
p1q1 = 1/11 and p6q6 = 1/11. By the arithmetic mean–geometric
mean (AM–GM) inequality,
p1q6 + p6q1
2
≥√p1q6p6q1 = √p1q1p6q6 = 1
11,
and hence
p1q6 + q1p6 ≥2
11,
contradicting the fact that p1q6 + p2q5 + p3q4 + p4q3 + p5q2 + p6q1 =
1/11. Therefore, not all sums occur with the same probability.
⋆18. It is impossible. Let the probabilities of the dies coming up i, for
1 ≤i ≤6, be pi, qi, ri, respectively. Then if all the sums are equal,
p1q1r1 = 1/16 and p6q6r6 = 1/16. By the arithmetic mean–geometric
mean inequality,
p1q6r1 + p1q1r6 + p6q1r1
3
≥(p2
1q2
1r2
1p6q6r6)1/3 = 1
16.
and this contradicts the fact that p1q6r1 + p1q1r6 + p6q1r1 ≤1/16.
19.  9
8
(0.9)8(0.1)(0.9) = 0.348678
20.
 10
5
 20
5

 30
10

= 62016
476905
.= 0.130038
321.
52
X
k=48
 100
k
  100
100−k

 200
100

= 935746568229294765422852889912396972990784164125892
1798124206093858125839783990357133458918226556075415
.= 0.520402
22.
 9
3
 9
3

 27
9

= 197568
1562275
.= 0.126462

A Hints and Solutions to Exercises
235
23. The expected number of balls remaining in the urn is
w
b + 1 +
b
w + 1.
The proof is a straightforward generalization of the argument in Ex-
ample 10.19.
24. Let Pn be the probability that, when three balls are chosen, the sum
of their numbers is divisible by 3. Note that P1 = 1 and P2 = 1/4. We
must show that Pn ≥1/4, for all n ≥3. The only relevant property
of the integers 1, . . . , n is their residues modulo 3. Thus, when n ≥3,
we may think of there being three integers, 0, 1, 2, occurring in the
urn with certain probabilities. Let i be an integer selected at random.
We consider three cases:
(1) n = 3k. Here Pr(i = 0) = k/n, Pr(i = 1) = k/n, and Pr(i = 2) =
k/n. The only triples of residues that sum to 0 modulo 3 are 000,
111, 222, and 012. Hence
Pn = 3k3 + 3k3 + 3k3 + 6k3
n3
= 9k3
n3 = 1
3.
(2) n = 3k + 1. Here Pr(i = 0) = k/n, Pr(i = 1) = (k + 1)/n, and
Pr(i = 2) = k/n. Hence
Pn = k3 + (k + 1)3 + k3 + 6k2(k + 1)
n3
=
9k3 + 9k2 + 3k + 1
27k3 + 27k2 + 9k + 1 > 1
3.
(3) n = 3k + 2. Here Pr(i = 0) = k/n, Pr(i = 1) = (k + 1)/n, and
Pr(i = 2) = (k + 1)/n. Hence
Pn = k3 + (k + 1)3 + (k + 1)3 + 6k(k + 1)2
n3
= 9k3 + 18k2 + 12k + 2
27k3 + 54k2 + 18k + 8
= 1
4 +
9k3 + 18k2 + 30k
108k3 + 216k2 + 72k + 32 > 1
4.
25. We can think of this process as waiting time until a success occurs.
At ﬁrst, the probability of a success (withdrawing a black ball) is
5/(5 + 5).
The average waiting time is therefore 10/5.
After one
black ball has been withdrawn, then the probability of success is 4/9
and the average waiting time 9/4, etc. The total average waiting time
is therefore
10
5 + 9
4 + 8
3 + 7
2 + 6
1 = 197
12 .

236
Pearls of Discrete Mathematics
26. The desired outcomes culminate with a ball chosen from Urn A. The
number of balls selected from Urn B is some integer k between 0
and 4, meaning that 5 + k balls are selected altogether. With 5 + k
selections of the urns, the probability of selecting Urn A 5 times and
Urn B k times, with Urn A selected last, is (1/2)4+k 4+k
k
(1/2). If k
balls are selected from Urn B, then the probability that the black ball
is not selected is (5 −k)/5. Therefore, the probability of a desired
outcome is
4
X
k=0
4 + k
k
 1
2
5+k 5 −k
5

= 63
256.
Chapter 11
1. The steady-state solution is [x, y, z] = [16/53, 15/53, 22/53].
eigenvector
eigenvalue
[16/53, 15/53, 22/53]
1
[2 −
√
6, −3 +
√
6, 1]
−(6 +
√
6)/12
[2 +
√
6, −3 −
√
6, 1]
(−6 +
√
6)/12
The matrix P ∞consists of three columns equal to the eigenvector
corresponding to eigenvalue 1.
32. m={{0,1/3, 1/2},{1/4, 0, 1/2},{3/4, 2/3, 0}};
MatrixPower[m,100].{{1},{0},{0}}-{{16/53},{15/53},{22/53}}
//N
3. The given matrix is a permutation matrix; therefore, it is not regular
since all its powers are also permutation matrices and hence have 0
entries.
4. We have
M =

2
−1
−17
9
  2
0
0
3
  9
1
17
2

,
and hence
M 100 =

2
−1
−17
9
  2100
0
0
3100
  9
1
17
2

.
5. Use a rotation matrix.

A Hints and Solutions to Exercises
237
6. The matrix is
 1
0
0
−1

.
Eigenvectors are [1, 0], with eigenvalue 1, and [0, 1], with eigenvalue
−1.
7. Make a change of coordinates so that the reﬂection is with respect to
the line y = x.
8. We have
 a
b
c
d
  1
3

=
 1
3

and
 a
b
c
d
  3
1

=
 0
0

.
Thus, we have a system of four equations and four unknowns. The
system is easily solvable, yielding the matrix
 1/10
3/10
−3/8
9/8

.
The only eigenvalue is 1, and a corresponding eigenvector is [1, 3].
9. The transition matrix is
 2
−1
1
0

.
10. bn = 2n + 3n + 5n, n ≥0
11. Let M be the transition matrix for the Fibonacci sequence. This re-
sult is an illustration of the Cayley–Hamilton theorem, due to Arthur
Cayley (1821–1895) and William Rowan Hamilton (1805–1865), which
says that a square matrix M satisﬁes its characteristic equation.
12. (a) It is immediate that
p1 = 1 −p1
n −1 ,
and therefore p1 = 1/n.
(b) By symmetry, p3 = · · · = pn. Let p denote the common value.
Then
p =
1
n −1p2 +
1
n −1(n −3)p,

238
Pearls of Discrete Mathematics
and hence
p2 = 2p.
Now
1
n + 2p + (n −2)p = 1,
and so p = (n −1)/n2. Therefore
[p1, p2, . . ., pn] =
 1
n, 2n −2
n2
, n −1
n2
, . . ., n −1
n2

.
Chapter 12
31. Using a computer, we ﬁnd that
n
3

(1 −2−3)n−3 < 1,
for n = 91.
It isn’t obvious how to construct a tournament with
Property 3. One approach is to construct a tournament randomly
on, say, 100 vertices and check to see whether the tournament has
Property 3. Since
100
3

(1 −2−3)100−3 .= 0.38,
a random tournament has a good chance of having Property 3. The
number of checks needed to verify that a tournament on 100 vertices
has Property 3 is  100
3
 = 161700.
32. Since
 n
12

(1 −2−12)n−12 < 1,
for n = 569459, there exists a tournament on 569,459 vertices with
Property 12.
33. We ﬁnd that
 n
12

(1 −2−12)n−12 < 1
2,
for n = 572565.
⋆4. Suppose that a tournament on seven vertices has Property 2. We
claim that every vertex has outdegree three.
If not, then by the
pigeonhole principle some vertex x has outdegree at least four. We
see that x cannot have outdegree ﬁve or six, or else a set of two vertices

A Hints and Solutions to Exercises
239
including x is not dominated by another vertex. Suppose that x has
outdegree four, a and b are directed to x, and a is directed to b. Then
the set {x, a} is not dominated by another vertex. This contradiction
shows that every vertex has outdegree three.
Next, we show that the three vertices directed to any vertex are di-
rected in a cyclic triple.
Suppose that a, b, and c are directed to
x. If a, b, and c are not a cyclic triple, then they are a transitive
triple, with, say, a directed to b, b to c, and a to c. But then {a, x} is
not dominated by another vertex. This establishes the claim that the
three vertices directed to any vertex are directed in a cyclic triple.
Now we proceed to show that the tournament is isomorphic to the one
shown in Figure 12.2. Label the three vertices to which 0 is directed
1, 2, and 4. Then the vertices 3, 5, and 6 form a cyclic triple. Choose
the labeling so that 3 is directed to 5, 5 to 6, and 6 to 3. Since 3
has outdegree three, it must be directed to one of 1, 2, or 4. Choose
the labeling so that 3 is directed to 4, and 1 and 2 are directed to 3.
Choose the labeling of 1 and 2 so that 1 is directed to 2. We see that
5 cannot be directed to 4, because 1, 2, and 3 are not a cyclic triple.
Hence 4 is directed to 5. Similarly, 1 cannot be directed to 4, because
0, 5, and 6 are not a cyclic triple. Hence 4 is directed to 1. By the
same token, 4 cannot be directed to 2, because 0, 3, and 6 are not a
cyclic triple. Hence, 2 is directed to 4. Continuing in this manner,
we ﬁnd that the remaining edges are directed just as in Figure 12.2.
†5. The result is trivially true when n = 1. Assume that the result holds
for n −1. Consider a tournament on 2n −1 vertices with Property n.
We will show that there exists a tournament on 2n−1−1 vertices with
Property n−1, a contradiction. Let v be a vertex of outdegree at least
2n−1−1. (Such a vertex exists by the pigeonhole principle.) Consider
any set of n−1 vertices, not including v. Because the tournament has
Property n, this set of vertices together with v is dominated by some
vertex v′ ̸= v. But this means that the tournament without vertex v
has Property n −1.
6. Consider a directed path of maximum length. Suppose that not all
the vertices are visited by the path, and derive a contradiction.
7.

1
24n(n + 1)(n −1)
if n is odd
1
24n(n + 2)(n −2)
if n is even
8. Change the direction of each edge.
9. 11 of each

240
Pearls of Discrete Mathematics
10. Suppose that the tournament has no Emperor and v is a King. Show
that there is another King among the vertices directed to v.
†11. Try direct constructions.
12. No. Let the vertices be all integers (positive, negative, and 0), and
say that a is directed to b if a < b.
Chapter 13
1. The number of 0s at the right of 1000! is the same as the exponent of
5 that divides 1000!, and we ﬁnd that this is
1000
5

+
1000
52

+
1000
53

+
1000
54

= 200 + 40 + 8 + 1 = 249.
2. 405
3. 2100 −1
4. 2100 −101
5. no
6. Since
(kn)!
(n!)k =

kn
n, n, . . ., n

is a multinomial coeﬃcient, it is an integer. Hence, (kn)! is divisible
by (n!)k.
7. From the identity
 n
k

= n
k
 n−1
k−1

, we see that k divides
 n−1
k−1

, since
gcd(n, k) = 1. Hence
 n
k

is a multiple of n.
8. The binary representation of 2k −1 consists of all 1s; hence it domi-
nates any number m with 0 ≤m ≤2k −1. It follows that 2 does not
divide  2k−1
m
.
9. There is a fractal-looking pattern of equilateral triangles of 0s.
10. Count the numbers whose binary expansions are dominated by the
binary expansion of a given number.
11. The binary representation of 210 + 25 + 1 dominates the binary rep-
resentation of 25 + 1, so
 210+25+1
25+1

is not divisible by 2.
12. 5

A Hints and Solutions to Exercises
241
313. A computer search reveals the solution
 50
3

= 1402.
14. Bertrand’s Postulate, named after Joseph Bertrand (1822–1900), says
that for any integer n > 1, there is a prime number between n and
2n. It follows that n! cannot be a perfect square, for there would be
a prime p such that n/2 < p < n, and p can only divide n! to the ﬁrst
power (since even 2p is greater than n).
15. We have 6! = 3!5!, 24! = 4!23!, and 10! = 6!7!. The ﬁrst two identities
are of the form (n!)! = n!(n! −1)!. It is not know whether there are
solutions besides this inﬁnite family and the third identity.
16. For 0 < i ≤j ≤n/2, we obtain
gcd
n
i

,
n
j

= gcd
n
i

,
n
i
n −i
j −i

/
j
i

≥
n
i

/
j
i

≥2i.
†⋄17. A computer search ﬁnds the pairs (23, 3) and (90, 2). In fact, there is
a perfect binary code corresponding to the pair (23, 3) but not to the
pair (90, 2). See [Ple98].
Chapter 14
1. An example is x ≡0 (mod 2), x ≡0 (mod 3), and x ≡1 (mod 4).
32. Change the values of some of the ki.
3. Inﬁnitely many negative values of k are given in the proof of our main
result. These numbers suﬃce in the present problem.
4. Investigate cycles of powers of 3 modulo various primes.
5. Consider the way that we deﬁned k in the proof of our ﬁrst result.
†⋆6. Use a generating function.
†7. Use Cassini’s identity.
†8. Obviously Fm | Fm. Use the identity
Fm+n = FmFn+1 + Fm−1Fn,
m ≥1, n ≥0
(Exercise 3 of Chapter 6).

242
Pearls of Discrete Mathematics
†9. Since gcd(a, b) | a, it follows from the previous exercise that Fgcd(a,b) |
Fa. Likewise, Fgcd(a,b) | Fb. Hence Fgcd(a,b) | gcd(Fa, Fb).
To prove the other direction, again use the identity
Fm+n = FmFn+1 + Fm−1Fn,
m ≥1, n ≥0,
and the fact that there exist integers x and y such that gcd(a, b) =
ax + by.
10. The least common multiple of the mi is 720, so we only have to check
that each residue class modulo 720 is covered.
Chapter 15
1. 5, 4 + 1, 3 + 2, 3 + 1 + 1, 2 + 2 + 1, 2 + 1 + 1 + 1, 1 + 1 + 1 + 1 + 1
6, 5 + 1, 4 + 2, 4 + 1 + 1, 3 + 3, 3 + 2 + 1, 3 + 1 + 1 + 1, 2 + 2 + 2,
2 + 2 + 1 + 1, 2 + 1 + 1 + 1 + 1, 1 + 1 + 1 + 1 + 1 + 1
7, 6 + 1, 5 + 2, 5 + 1 + 1, 4 + 3, 4 + 2 + 1, 4 + 1 + 1 + 1, 3 + 3 + 1,
3 +2 +2, 3 +2+1+1, 3+1+1+1+1, 2+2+2+1, 2+2+1+1+1,
2 + 1 + 1 + 1 + 1 + 1, 1 + 1 + 1 + 1 + 1 + 1 + 1
32. Do[
p[i, 1] = 1; p[i] = 1;
Do[
If[i - j >= j,
p[i, j] = p[i - 1, j - 1] + p[i - j, j],
p[i, j] = p[i - 1, j - 1]];
p[i] = p[i] + p[i, j],
{j, 2, i - 1}
],
{i, 1, 100}
]
Table[p[n, k], {n, 1, 100}, {k, 1, n}] // TableForm
Table[p[n], {n, 1, 100}] // TableForm
⋆3. The formulas are p(n, 1) = 1, p(n, 2) = ⌊n/2⌋, and p(n, 3) = {n2/12}.
From Theorem 15.4, the generating function for the numbers p(n, 3)
is
x3
(1 −x)(1 −x2)(1 −x3).

A Hints and Solutions to Exercises
243
The partial fraction decomposition of this rational function is
1
6(1 −x)−3 −1
4(1 −x)−2 −1
72(1−x)−1 −1
8(1+x)−1 + 1
9 ·
x + 2
x2 + x + 1.
Expansion of the term (x + 2)/(x2 + x + 1) reveals a repeating pat-
tern of −2, −1, −1, . . . in the coeﬃcients of xn. Via the binomial
series theorem and the identity
 −k
n

= (−1)n n+k−1
n

, we ﬁnd, by
identifying the nth coeﬃcient of the power series, that
p(n, 3) = 1
6
n + 2
n

−1
4
n + 1
n

−1
72 −1
8(−1)n + 1
9C,
where |C| ≤2. This expression simpliﬁes to
p(n, 3) = n2
12 −7
72 −1
8(−1)n + 1
9C,
which is equal to {n2/12}, since
−7
72 −1
8(−1)n + 1
9C
 < 1
2.
With k ﬁxed, p(n, k) ∼nk−1/(k!(k −1)!).
For n and k large, we
can form a partition of n into k parts by writing n 1s in a row and
selecting k −1 of them to be the rightmost terms of summation. This
can be done in   n
k−1
 ways. Almost always, the k summands thus
created will be distinct. Since the order of the parts in a partition
doesn’t matter, we divide by k! to “unorder” the summands. Hence
p(n, k) ∼
  n
k−1

k!
= n(n −1)(n −2) . . .(n −k + 2)
k!(k −1)!
∼
nk−1
k!(k −1)!.
34. Series[Product[(1-x^k)^-1,{k,1,20}],{x,0,20}]
†5. Show that the coeﬃcients of xn on the two sides of the equation are
equal. On the right side, the product may be written as
∞
Y
k=1
(1 −xk)−1 =
∞
Y
k=1
(1 + xk + x2k + x3k + x4k + · · ·).
6. The coeﬃcient of xn in the expansion of the product is the number
of solutions to
n = m1 + 2m2 + 3m3 + · · · + nmn,
where each mi = 0 or 1, which is p(n | distinct parts).

244
Pearls of Discrete Mathematics
7. Given a partition of n into odd parts, any two equal parts can be
combined to produce a single part. Doing this as often as necessary,
eventually all the parts will be distinct. On the other hand, given a
partition of n with distinct parts, any even part can be split into two
parts of half the length. Doing this as often as necessary, eventually
all the parts will be odd.
8. By taking successive corners from a self-conjugate partition of n to
build a partition of n into distinct odd numbers, we see that ˜p(n) =
p(n | distinct odd parts). For example, the correspondence between
the self-conjugate partitions of 18 and the partitions of 18 into distinct
odd parts is
7 + 4 + 2 + 2 + 1 + 1 + 1 ←→13 + 5
5 + 4 + 4 + 4 + 1 ←→9 + 5 + 3 + 1
9 + 2 + 1 + 1 + 1 + 1 + 1 + 1 + 1 ←→17 + 1
8 + 3 + 2 + 1 + 1 + 1 + 1 + 1 ←→15 + 3
6 + 5 + 2 + 2 + 2 + 1 ←→11 + 7.
This correspondence yields an identity between generating functions:
∞
X
n=0
˜p(n)xn =
∞
Y
n=0
(1 + x2n+1).
Replacing x by −x, we obtain
∞
X
n=0
˜p(n)(−1)nxn =
∞
Y
n=0
(1 −x2n+1)
=
∞
Y
n=1
1
(1 + xn)
=
∞
Y
n=1
(1 −xn + x2n −x3n + x4n −· · ·).
The ﬁnal generating function counts
p(n | even # of parts) −p(n | odd # of parts).

A Hints and Solutions to Exercises
245
9.
∞
Y
n=1

1
1 −xn −xn

=
∞
Y
n=1
1 −xn + x2n
1 −xn
=
∞
Y
n=1
x3n + 1
(1 + xn)(1 −xn)
=
(1 + x3)(1 + x6) . . .
(1 + x)(1 −x)(1 + x2)(1 −x2)(1 + x3)(1 −x3)(1 + x4)(1 −x4) . . .
=
1
(1 −x2)(1 −x3)(1 −x4)(1 −x6) . . .
10. If m(3m −1)/2 = n(3n + 1)/2, with m and n positive integers, then
(6m −1)2 = (6n + 1)2, which implies that 6m −1 = 6n + 1, an
impossibility.
11. We have k(3k −1)/2 = (n(n + 1)/2)/3, upon letting n = 3k −1.
12.
9 + 1 ←→10
8 + 2 ←→7 + 2 + 1
7 + 3 ←→6 + 3 + 1
6 + 4 ←→5 + 4 + 1
4 + 3 + 2 + 1 ←→5 + 3 + 2
313. p[0] = 1;
Do[
p[n] = 0;
k = 1;
While[n-k(3k-1)/2 >= 0,
p[n] = p[n] + p[n-k(3k-1)/2](-1)^(k+1); k++];
k = 1;
While[n-k(3k+1)/2 >= 0,
p[n] = p[n] + p[n-k(3k+1)/2](-1)^(k+1); k++],
{n, 1, 1000}
];

246
Pearls of Discrete Mathematics
p[1000]
24061467864032622473692149727991
Chapter 16
1. 104!
32. The value of the feat is 26100. Since this number has 142 digits and
the previous number has 167 digits, the ﬁrst feat has a greater value.
3. We may as well assume that the letter is given ﬁrst, then the digit.
The stunt is worth log2(26 · 10) .= 8.02 bits.
4. If we learn that the event occurs, then we receive log2 210 = 10 bits
of information. If we learn that the event does not occur, then we
receive log2 1/(1 −2−10) .= 0.0014 bits of information.
5. The four ways for the dice to have a sum of 9 are (3, 6), (4, 5), (5, 4),
and (6, 3), and these outcomes are equally likely. We are told that
both dice show an even number. Since this event occurs with proba-
bility 1/2, the information associated with the event is −log2 1/2 = 1
bit.
6. I(pq) = −log2 pq = −log2 p −log2 q = I(p) + I(q)
7. 2 bits
8.
−1
3 log2
1
3 −1
3 log2
1
3 −1
6 log2
1
6 −1
6 log2
1
6
.= 1.9 bits
9. An example is the source with states a, b, c, d, and e, with probabil-
ities 1/2, 1/4, 1/8, 1/16, and 1/16, respectively.
10. Since the maximum entropy of a source with n states is log n, the
minimum number of states necessary to have entropy 10 bits is 210 =
1024.
11. H(T) = 1 + 1
2H(S)
12. Write
f(α) = −α log α −(1 −α) log(1 −α),
where we may as well assume that the log is a natural logarithm.
Then
f′(α) = −log α + log(1 −α),

A Hints and Solutions to Exercises
247
and the only candidate for a maximum is where logα = log(1−α), so
that α = 1/2. We can verify that this yields a maximum by checking
that the second derivative of f is negative.
13. Consider Example 16.6.
14. By symmetry, Pr(a) = Pr(b) = Pr(c) = 1/3. Hence
H(S) = 3(1/3)(−0.1 log0.1 −0.2 log0.2 −0.7 log0.7) .= 1.2.
15. The entropy will increase since there is no predisposition for the sys-
tem to transition from a to b to c to a, as in the original Markov
source.
16. Use symmetry arguments to minimize computations.
17. There is a large range of possible values for the entropy.
Chapter 17
31. The optimal fraction to bet is p −q = 0.02. The growth coeﬃcient is
c = 1 + 0.51 log0.51 + 0.49 log0.49 .= 0.000288558.
At this rate, it would take (log2 1000000)/c .= 189 years to go from
$1 to $1 million.
32. FindRoot[0.51 Log[2, 1 + lambda]
+ 0.49 Log [2, 1 - lambda] == 0, {lambda, .5}]
{lambda -> 0.0399893}
33. The optimal fraction to bet is p −q = 0.8. The growth coeﬃcient is
c = 1 + 0.9 log0.9 + 0.1 log0.1 .= 0.531004.
At this rate, it would take (log2 1000000)/c .= 38 days to go from $1
to $1 million.
34. FindRoot[0.9 Log[2, 1.0 + lambda]
+ 0.1 Log[2, 1.0 - lambda] == 0.0, {lambda, 0.9}]
{lambda -> 0.998029}

248
Pearls of Discrete Mathematics
5. Suppose that we bet λ1, λ2, and λ2, respectively, on the outcomes.
Of course, p + q + r = λ1 + λ2 + λ3 = 1. In n trials, the amount
changes on average by a multiplicative factor of
(λ1x)pn(λ2y)qn(λ3z)rn = 2cn,
where
c = (p log x + q log y + r log z) + (p log λ1 + q log λ2 + r log λ3).
We want to maximize the second quantity in parentheses.
By convexity (speciﬁcally, Lemma 16.4),
p log λ1 + q log λ2 + r log λ3 ≤−p log p −q log q −r log r,
with equality only if λ1 = p, λ2 = q, and λ3 = r.
†⋆6. Suppose that there are n outcomes, x1, . . . , xn, with probabilities p1,
. . . , pn, respectively. We should bet pi of the current amount on Xi,
for 1 ≤i ≤n. The proof is a straightforward generalization of the
solution to the previous exercise.
7. c(0.75) = c(0.25) = 1 + (0.75) log2(0.75) + (0.25) log2(0.25) .= 0.189
8. (0.9)3 + 3(0.9)2(0.1) = 0.972
Chapter 18
1. A possible code is


a
b
c
d
e
f
g
p1
p2
p3
p4
p5
p6
p7
1110
1111
100
110
101
00
01

.
2. A possible code has words 0, 10, 110, 1110, . . . , etc. The average
length of the code is
1
2 · 1 + 1
4 · 2 + 1
8 · 3 + · · · + 1
2n · n.
It can be shown (see Chapter 3) that this sum simpliﬁes to
2 −(n + 2)2−n.

A Hints and Solutions to Exercises
249
3. A possible code is


a
b
c
d
1/3
1/3
1/6
1/6
10
11
00
01

.
The average length of the code is 2 and this is within 1 bit of the
entropy, which we found to be approximately 1.9 bits.
4.
H(X) = −3
4 log 3
4 −1
4 log 1
4
.= 0.811278
H(Y ) = −5
8 log 5
8 −3
8 log 3
8
.= 0.954434
H(X, Y ) = −3
16 log 3
16 −9
16 log 9
16 −1
32 log 1
32 −7
32 log 7
32
.= 1.55563
H(Y |X) = −3
16 log 1
4 −9
16 log 3
4 −1
32 log 1
8 −7
32 log 7
8
.= 0.74435
I(X, Y ) = H(Y ) −H(Y |X) .= 0.954434 −0.74435 = 0.210084
H(X|Y ) = H(X) −I(X, Y ) .= 0.811278 −0.210084 = 0.601194
5. (log2 3)/3
6. The rate of the triplicate code is (log2 2)/3 = 1/3. In the triplicate
code, an error occurs when two or three bit errors are committed
(if no bit errors or only one are committed, then we can recover the
intended symbol). This happens with probability
(0.1)3 + 3(0.1)2(0.9) = 0.028.
7. The code is a (7, 3, 1) Hamming code.
†8. Center a Hamming sphere of radius ⌊(d −1)/2⌋at each codeword.
These spheres must be disjoint.
9. See the solution to Exercise 7.
⋆10. Use order statistics.

250
Pearls of Discrete Mathematics
Chapter 19
1. 11
2. The unique self-complementary graph of order 5 is the 5-cycle C5.
⋆3. The “only if” assertion comes from the parity of the number of edges
of the complete graph of order n. The “if” part comes from a construc-
tion. Arrange the n vertices cyclically and use for an isomorphism
a cyclical shift by one vertex.
Decide on the edges and non-edges
accordingly.
4. By the pigeonhole principle, there exist m and n, with m < n, such
that 13m ≡13n (mod 104). Since gcd(13, 104) = 1, it follows that
13n−m ≡1 (mod 104).
We can ﬁnd such an exponent using Euler’s theorem:
aφ(m) ≡1
(mod m),
if gcd(a, m) = 1. The furnished exponent is φ(104) = 4000.
5. Use the same method as in the previous problem.
6. Consecutive integers are relatively prime.
7. Consider the largest power of 2 that divides each number.
8. 2n −1
†9. Consider the case of equality in Proof 2 of Theorem 19.2.
†⋆10. See [Har69].
11. Color the edges of a 5-cycle C5 green and the other edges red.
†12. Label the vertices 1 through f(n) and color edge ij green if i is di-
rected to j and red if j is directed to i.
13. Assign to each pair of vertices incident at a vertex a score of +2 if
they are the same color and −1 if they are not the same color.
14. Let the green subgraph of K8 be an 8-cycle with two strategically
chosen diagonals.
15. Use the inequality R(3, 5) ≤R(3, 4) + R(2, 5) = 9 + 5 = 14. Then
ﬁnd a 2-coloring of K13 that shows R(3, 5) > 13.
†16. See [GRS90].

A Hints and Solutions to Exercises
251
17. Give a proof similar to the one of the result in the chapter introduc-
tion.
†18. Recall that R(a, 2) = a for all a ≥2, and R(a, b) ≤R(a −1, b) +
R(a, b −1) for all a, b ≥3.
We use induction on a and b. Note that R(a, 2) = a =
  a
a−1

and
R(2, b) = b =   b
b−1
, so the inequality holds when b = 2 or a = 2.
Suppose that the inequality holds for R(a −1, b) and R(a, b −1), for
a, b ≥3. Then
R(a, b)
≤
R(a −1, b) + R(a, b −1)
≤
a + b −3
a −2

+
a + b −3
a −1

=
a + b −2
a −1

.
†19. We must show that
2a/2
a

2 < 2(
a
2).
Use the bound
2a/2
a

= 2a/2(2a/2 −1) . . .(2a/2 −a + 1)
a!
< (2a/2)a
2a/2−1 .
320. 100 < R(10, 10) ≤184756
Chapter 20
1. Since r(C4) = 6, we only have to show that the second player has a
drawing strategy on K5.
2. Prove it by cases.
3. The solution does not appear to be known, so here is a chance for an
independent discovery.
†4. Use mathematical induction.
⋆5. See [EH84].
6. This is another open-ended problem where you can make independent
discoveries.

252
Pearls of Discrete Mathematics
37. n = 100
†8. ⌊2k/2⌋, k ≥3 (see p. 161)
†9. Perhaps a computer will be of help.
†10. On a 14×15 board, there is always a winner in both the achievement
and avoidance games, as follows from the Bacher–Eliahou result. The
best strategy is an open question. Bacher and Eliahou constructed
14×14 binary matrices and 13×∞binary matrices without four equal
entries at the corners of a square (with horizontal and vertical sides),
but the games may still be decisive on these “boards.” As there are
exactly 48,364 binary 14 × 14 matrices with an equal number of 0s
and 1s and without the desired goal conﬁguration, if two players play
randomly on a 14 × 14 board, then the game ends in a draw with
probability 48364/C(142, 142/2) .= 8.46 × 10−54.
Chapter 21
1.


\
−
|
−
/
|
−
−
|
|
−
|
·
|
−
|
|
−
−
|
/
−
|
−
\


2. The value k = 35 yields a draw.
3. The animals occur in the ﬁgure as listed, reading left to right and top
to bottom.
4. The ﬁrst player puts an O in the center square and then reﬂects each
of the second player’s moves.
5. Elam, Domino, Tic, El, Knobby, and Elly
6. Draw a domino tiling of the plane and see which animals are blocked
by it. Repeating this process until you account for all the (known)
minimal non-winning animals, you will obtain diagrams similar to
those following.

A Hints and Solutions to Exercises
253

254
Pearls of Discrete Mathematics
7. Play some sample games.
8. If n is even, then a reﬂection strategy allows the second player to win.
No general results are known for n odd.
9. This problem is unsolved, so there is opportunity for independent
discovery.
10. Play some sample games.
11. Play some sample games.
12. Fatty, Skinny, and Tippy
13. Use the pigeonhole principle to show that, when ﬁlled, a large enough
board must contain any given Picasso animal.
14. The game is a draw. Find a domino blocking pattern. The game with
“wrap-around” is a ﬁrst player win.
15. Consider superanimals of non-winning 2-D animals.
16. Little is known about one-color games. Here is a chance to make some
independent theories and discoveries.
17. This problem can be solved by testing all diﬀerent cases up to sym-
metry.
Chapter 22
31. binarystrings[n_] := (
x = Table[0, {n}];
Print[x];
While[
x != Table[1, {n}],
place = n;
While[x[[place]] == 1, x[[place]] = 0; place--];
x[[place]] = 1;
Print[x]
]
)
2. {}, {1}, {1, 2}, {1, 2, 3}, {1, 2, 3, 4}, {1, 2, 4}, {1, 3}, {1, 3, 4}, {1, 4},
{2}, {2, 3}, {2, 3, 4}, {2, 4}, {3}, {3, 4}, {4}

A Hints and Solutions to Exercises
255
33. subsets[n_] := (
ourlist = {{}, x = {1}};
While[
x != {n},
If[x[[-1]] == n, x = Drop[x, -1]; x[[-1]]++,
AppendTo[x, x[[-1]] + 1]];
AppendTo[ourlist, x]
];
ourlist
)
4. {0, 0, 0}, {0, 0, 1}, {0, 1, 1}, {0, 1, 0}, {1, 1, 0}, {1, 1, 1}, {1, 0, 1}, {1, 0, 0}
35. generalizedgraycode[n_, k_] := (
x = Table[0, {n}];
ourlist = {y = Table[0, {n}]};
While[
x != Table[k - 1, {n}],
place = n;
While[x[[place]] == k - 1, x[[place--]] = 0];
x[[place]]++;
y[[place]] = Mod[y[[place]] + 1, k];
AppendTo[ourlist, y]
];
ourlist
)
36. Put in a check to see that the number of elements in a subset is even.
37. graycode[1] = {{0}, {1}};
graycode[n_] :=
graycode[n] =
Join[Prepend[#, 0] & /@ graycode[n - 1],
Prepend[#, 1] & /@ Reverse[graycode[n - 1]]];
8. A number dndn−1 . . .d1d0 in the ordinary listing corresponds to a
number gngn−1 . . .g1g0 in the generalized Gray code listing if
gi = di −di+1,
0 ≤i ≤n,
and
di = gi + · · · + gn,
0 ≤i ≤n.
Here we have set dn+1 = gn+1 = 0.
To prove this, check that after a carry, only one digit advances. A
carry amounts to adding a vector of the form (0, 0, . . ., 0, 1, 1, . . ., 1),

256
Pearls of Discrete Mathematics
an operation that can be interpreted as ﬁnite integration. The oppo-
site operation, ﬁnite diﬀerentiation, turns this vector into the vector
(0, 0, . . ., 0, 1, 0, . . ., 0, ).
†9. A good reference for the Tower of Hanoi puzzle is the Wikipedia page
http://en.wikipedia.org/wiki/Tower_of_hanoi.
10. Given a generalized Gray code based on n and k, the graph G has as
vertices all n-tuples over {0, 1, . . ., k −1}, with two vertices adjacent
if and only if the two n-tuples diﬀer by 1 in exactly one coordinate.
The graph G is sometimes called a generalized hypercube.
Chapter 23
31. ourfactorial[n_] := n ourfactorial[n - 1];
ourfactorial[0] = 1;
ourfactorial[40]
815915283247897734345611269596115894272000000000
32. f[n_, n_] := 1;
f[n_, 0] := 1;
f[n_, k_] := f[n, k] = f[n - 1, k - 1] + f[n - 1, k];
f[6,3]
20
3. In dictionary order, we change as little of the beginning of the word
as possible.
For example, ABSTRUSE appears shortly after AB-
STRACT. In determining the next word, we want to leave unchanged
as many letters at the left as possible.
This means that we must
change the rightmost letter that isn’t part of a decreasing sequence
of letters at the right. Since the sequence KHFCA is decreasing, and
the letter to the left, E, is not part of a decreasing sequence with this
sequence, the E must be changed. What letter do we change E to?
Clearly, we want to pick the alphabetically least letter to the right of
the E that is alphabetically greater than E. This letter is F. Hence
we switch the E and F. Finally, the resulting sequence KHECA must
be reversed, resulting in the desired word:
JMZORTXLBPSYWVINGDUQFACEHK.
34. ourpermutations[n_] := (
ourlist = {x = Range[1, n]};

A Hints and Solutions to Exercises
257
While[
x != Reverse[Range[1, n]],
istar = n - 1;
While[x[[istar]] > x[[istar + 1]], istar--];
jstar = n; While[x[[jstar]] < x[[istar]], jstar--];
x[[{istar, jstar}]] = x[[{jstar, istar}]];
x = Join[Take[x, istar], Reverse[Drop[x, istar]]];
AppendTo[ourlist, x]
];
ourlist
)
ourpermutations[4]
{{1, 2, 3, 4}, {1, 2, 4, 3}, {1, 3, 2, 4}, {1, 3, 4, 2},
{1, 4, 2, 3}, {1, 4, 3, 2}, {2, 1, 3, 4}, {2, 1, 4, 3},
{2, 3, 1, 4}, {2, 3, 4, 1}, {2, 4, 1, 3}, {2, 4, 3, 1},
{3, 1, 2, 4}, {3, 1, 4, 2}, {3, 2, 1, 4}, {3, 2, 4, 1},
{3, 4, 1, 2}, {3, 4, 2, 1}, {4, 1, 2, 3}, {4, 1, 3, 2},
{4, 2, 1, 3}, {4, 2, 3, 1}, {4, 3, 1, 2}, {4, 3, 2, 1}}
35. ourcombinations[n_, k_] := (
ourlist = {x = Range[1, k]};
While[
x != Range[n - k + 1, n],
istar = k;
While[x[[istar]] == n - k + istar, istar--];
x[[istar]]++;
Do[x[[j]] = x[[istar]] + j - istar, {j, istar + 1, k}];
AppendTo[ourlist, x]
];
ourlist
)
ourcombinations[6, 3]
{{1, 2, 3}, {1, 2, 4}, {1, 2, 5}, {1, 2, 6}, {1, 3, 4},
{1, 3, 5}, {1, 3, 6}, {1, 4, 5}, {1, 4, 6}, {1, 5, 6},
{2, 3, 4}, {2, 3, 5}, {2, 3, 6}, {2, 4, 5}, {2, 4, 6},
{2, 5, 6}, {3, 4, 5}, {3, 4, 6}, {3, 5, 6}, {4, 5, 6}}
6. There are (n!)2 such permutations. We can list them using two nested
loops in conjunction with the Permutations Listing Algorithm.
†7. A good resource is

258
Pearls of Discrete Mathematics
www.cut-the-knot.org/
Curriculum/Combinatorics/JohnsonTrotter.shtml+.
8. Try some examples, such as with n = 3 and n = 4.
Chapter 24
31. Set up a 729 × 324 binary matrix that encodes all possible ways to
put a number into the Sudoku board. Take rows away depending on
the givens of the puzzle. Then run the Exact Cover Algorithm.
2. 77
33. 576
34. Consider a checkerboard coloring of the board.
For the computer
program, include two copies of each set corresponding to placements
of the animals in the box.
35.
(a) 2
(b) 1010
(c) 2339
See [Mar91].
36. 8
See [Mar91].
37. 36, 6728
The number of tilings of a 2m × 2n rectangle by dominoes is
4mn
m
Y
j=1
n
Y
k=1

cos2
jπ
2m + 1 + cos2
kπ
2n + 1

.
38. This is an open problem. Notice that if the two removed squares form
a domino and if this domino is in the corner, then the number of tilings
is halved; if the removed domino is near the middle of the board, then
the number of tilings is reduced by a much greater fraction.
39. 272
310. 1, 7, 131, 10012
311. 92

Appendix B
Notation
N
natural numbers, p. 3
n!
n factorial, p. 5
P (n, k)
number of permutations, p. 5
C(n.k)
number of combinations, p. 5
 n
k

binomial coeﬃcient, p. 6
 n
n1,n2,...,nk

multinomial coeﬃcient, p. 17
R
real numbers, p. 18
Fn
Fibonacci number, p. 27
f(n) ∼g(n)
asymptotic, p. 31
O(g(n))
big oh notation, p. 31
Ln
Lucas number, p. 32
{x}
nearest integer function, p. 50
Pr(E)
probability of event, p. 67
E(X)
expected value, p. 68
µ(X)
mean, p. 68
σ(X)
standard deviation, p. 69
B(p)
Bernoulli random variable, p. 69
B(n, p)
binomial random variable, p. 69
259

260
Pearls of Discrete Mathematics
dn
derangement number, p. 71
db(n)
sum of base-b digits, p. 97
p(n)
partition number, p. 109
p(n, k)
partition number, p. 109
I(p)
information function, p. 124
H(p)
entropy function, p. 126
c(p)
capacity function, p. 134
r(C)
rate of code, p. 148
Kn
complete graph, p. 155
Km,n
complete bipartite graph, p. 155
Cn
cycle, p. 155
Pn
path, p. 155
δ(v)
degree of vertex of graph, p. 155
Gc
graph complement, p. 156
α(G)
independence number of graph, p. 156
R(m, n)
Ramsey number, p. 158
R(a1, . . ., ac)
generalized Ramsey number, p. 159
a(G)
achievement number, p. 166
a(G)
avoidance number, p. 166

Bibliography
[ASE92] N. Alon, J. Spencer, and P. Erd˝os. The Probabilistic Method.
Wiley, New York, 1992.
[Bol79]
B. Bollob´as. Graph Theory: An Introductory Course. Cambridge
University Press, New York, 1979.
[CG99]
F. Chung and R. L. Graham. Erd˝os on Graphs: His Legacy of
Unsolved Problems. A. K. Peters, Wellesley, second edition, 1999.
[CL96]
G. Chartrand and L. Lesniak. Graphs & Digraphs. Chapman &
Hall, New York, third edition, 1996.
[CZ05]
G. Chartrand and P. Zhang. Introduction to Graph Theory.
McGraw–Hill, New York, 2005.
[EH84]
M. Erickson and F. Harary. Generalized Ramsey Theory XV:
Achievement and avoidance games for bipartite graphs. In
Graph Theory Singapore 1983, volume 1073 of Lecture Notes in
Mathematics, pages 212–216. Springer, 1984.
[Eri96]
M. J. Erickson. Introduction to Combinatorics. Wiley, New
York, ﬁrst edition, 1996.
[GRS90] R. L. Graham, B. L. Rothschild, and J. H. Spencer. Ramsey
Theory. Wiley, New York, second edition, 1990.
[Har69]
F. Harary. Graph Theory. Addison–Wesley, Reading, 1969.
[Hel97]
L. L. Helms. Probability Theory: With Contemporary
Applications. W. H. Freeman, New York, 1997.
[Kel56]
J. L. Kelly. A new interpretation of information rate. Bell
System Technical Journal, 35:917–926, 1956.
[Mar91] G. E. Martin. Polyominoes: A Guide to Puzzles and Problems in
Tiling. The Mathematical Association of America, U. S. A.,
1991.

262
Bibliography
[Ple98]
V. Pless. Introduction to the Theory of Error-Correcting Codes.
Wiley, New York, third edition, 1998.
[Rud76] W. Rudin. Principles of Mathematical Analysis. McGraw–Hill,
Inc., New York, third edition, 1976.
[Sha48]
C. Shannon. A mathematical theory of communication. Bell
System Technical Journal, 27:379–423; 623–656, 1948.
[Wes95] D. B. West. Introduction to Graph Theory. Prentice Hall, Upper
Saddle River, 1995.

Index
achievement and avoidance game
bipartite graph, 169
graph, 165, 166
negative triangle, 170
positive triangle, 170
Ramsey, 167
achievement game, 166, 175, 176
achievement number, 166
Alcuin of York, 49
Alcuin’s sequence, 49, 51, 52
generating function for, 50
recurrence relation for, 51
algebraic proof, 9, 15
algorithm, 183
combinations listing, 188
counting, 183
Exact Cover Algorithm, 193
generalized Gray code, 185
Johnson–Trotter, 187, 189, 191
permutations listing, 187
subsets listing, 184
AM–GM inequality, 157, 234
animal, 174, 195
achievement game, 175
avoidance game, 175
non-winner, 176
Picasso, 177
winner, 177
annulus, 59
arithmetic, modular, 91
asymptotic, 31
avoidance game, 166, 175
avoidance number, 166
Bacher, Roland, 171, 252
base-b representation, 97
Bernoulli random variable, 69, 77,
78
Bernoulli, Jacob, 69
Bertrand’s Postulate, 241
Bertrand, Joseph, 241
big oh notation, 31
binary matrix, 193
binary representation, 98, 240
binary string, 4, 14, 27
complement of, 201
binary strings, listing of, 184
binary symmetric channel (BSC),
147
binomial coeﬃcient, 6, 9, 25, 26, 47,
97, 98
computing, 190
binomial random variable, 69
binomial series, 25, 41, 44, 50, 75,
224
binomial series theorem, 243
binomial theorem, 7, 9, 11, 14
bipartite graph, 177, 180
complete, 179
birth dates, 78
bit, 126
Blass, Andreas, 176
board, 198
toroidal, 180, 198
board number, 176
Boltzmann, Ludwig, 126
Bonferroni inequalities, 74, 150,
161, 162
Bonferroni, Carlo Emilio, 74
bridge, 67
263

264
Index
calculus proof, 15, 131
capacity, 147
capacity function, 134
cards, 67, 68, 72, 78, 79, 123
carry (in addition), 98, 255
Cassini’s identity, 28, 35, 214, 241
Cassini, Giovanni Domenico, 28
Cayley, Arthur, 237
Cayley–Hamilton theorem, 237
change, 46
for a dollar, 39, 46, 47
for a million dollars, 39, 48
change of coordinates, 237
channel, 143
binary symmetric (BSC), 134,
147
capacity of, 134, 147
discrete memoryless (DMC),
143
input alphabet of, 143
output alphabet of, 143
channel capacity, 134
characteristic equation, 83, 237
characteristic polynomial, 30, 41, 86
Chebyshev’s inequality, 77
Chebyshev, Pafnuty Lvovich, 77
checkerboard coloring, 258
chess, 4
chess King, 4
chess Knight, 63
chess Queen, 53, 199
chess Rook, 53
chessboard, 4, 53, 61, 199
Chinese remainder theorem,
105–107
circle, unit, 50
code, 139
average length of, 140
error-correcting, 123, 151
generalized Gray, 185
Gray, 184
Hamming, 249
Hamming bound for, 152
Hamming distance of, 149
perfect binary, 101, 152, 241
rate of, 148
sphere packing bound for, 152
triplicate, 152
words of, 139
code word, length of, 139
coeﬃcient of growth, 134
coin
biased, 78, 133
unbiased, 67, 68, 70
Coker, Curtis, 58
combination, 5
combinations, listing of, 188
complex plane, 50
composite number, 103
composition (of integer), 18, 226
congruence, 103, 106
convexity (of function), 126
counter, 183
counting proof, 6, 14, 15, 161
covering system, 103
exact, 107
critical value, 136
derangement, 71
derangement number, 78
derivative, discrete, 185
determinant, 86
dice, 78, 79
dictionary ordering, 187
diﬀerence operator, 218
diﬀerence sequence, 21
diﬀerential equation, 232
diﬀerentiation, discrete, 256
digits, 97
dimer problem, 198
Dirichlet, Johann Peter Gustav
Lejeune, 156
discrete memoryless channel
(DMC), 143
dollar, change for, 42
domino, 198

Index
265
domino blocking pattern, 176
eigenvalue, 83, 85, 87
eigenvector, 83, 85, 87
Electronic Journal of
Combinatorics, 160
Eliahou, Shalom, 171, 252
Encyclopedia of Integer Sequences
(EIS), 58, 60
entropy, 123, 125, 134, 145
of English, 128, 132
Erd˝os–Selfridge theorem, 168
Erd˝os, Paul, 92, 100, 101, 103, 165,
167, 168
error-correcting code, 123, 135, 151
Euler’s function, 79
Euler’s pentagonal number
theorem, 110, 117
Euler’s theorem, 250
Euler, Leonhard, 113, 117
exact cover, 193
Exact Cover Algorithm, 193
exact cover problem, 193
existence argument, 92
expected value, 68, 69
exponential function, 134
factorial, 5, 97
computing, 190
Felgenhauer, Bertram, 195
Fernando, Suren, 60
Ferrers diagram, 110, 116
transpose of, 110
Ferrers, Norman, 110
Fibonacci (Leonardo of Pisa), 27
Fibonacci number, 27, 30, 35, 39,
85, 87, 107
prime, 106
Fibonacci sequence, 39, 51, 226, 237
generating function for, 39
ﬁxed point, 71
fractal, 240
Franklin, Fabian, 116
Frobenius’ stamp problem, 48
Frobenius, Ferdinand Georg, 48
function, 4
convex, 126
nearest integer, 50
one-to-one, 8
onto, 23
rational, 40, 42
game
achievement, 166, 175, 176
avoidance, 166
banker’s, 176
Bipartite Graph Achievement,
169
Bipartite Graph Avoidance,
169
bridge, 67
chess, 4
choice, 170
coin-tossing, 133
Domino Avoidance, 180
Elam Achievement, 175
Fatty Achievement, 180
Graph Achievement, 165, 169
Graph Avoidance, 166
Negative Triangle
Achievement, 170
Negative Triangle Avoidance,
170
Nim, 59
one-color, 180
packing, 180
Picasso Fatty Achievement,
180
Positive Triangle Achievement,
170
Positive Triangle Avoidance,
170
Ramsey, 165, 169, 171
reﬂection strategy in, 254
Skinny Achievement, 176
Snaky Achievement, 177
tic-tac-toe, 173

266
Index
generalizations of, 174
higher-dimensional, 173
Tippy Achievement, 179
trivial, 176
Wythoﬀ’s Nim, 61
generating function, 44, 111
diagonal, 58
exponential, 79
for binomial coeﬃcients, 47
for derangement numbers, 79
for Fibonacci sequence, 39
for integer triangles, 50
for making change, 42
for multinomial coeﬃcients, 47
for partition numbers, 111
for Queen paths, 57
for Rook paths, 55
ordinary, 39
Gleason, Andrew M., 160
golden ratio, 30
graph, 155, 165, 183
bipartite, 169, 177
coloring of, 157
complement, 156
complete, 91, 155
complete bipartite, 155
cycle, 155
edge of, 155
generalized hypercube, 256
independence number of, 156
isomorphic, 156
monochromatic, 157
order of, 155
path, 155
random, 167
regular, 155
self-complementary, 163
size of, 155
triangle-free, 156, 163
vertex of, 155
degree of, 155
indegree of, 93
outdegree of, 93
graph Ramsey number, 167
graphs
extremal property of, 156
nonisomorphic, 156, 163
Gray code, 183, 184, 191
Gray, Frank, 184
Greenwood, Robert E. Jr., 160
growth rate function, 135
Hamilton, William Rowan, 186, 237
Hamiltonian circuit, 186
Hamming code, 249
Hamming distance, 149
Hamming sphere, 249
Hamming, Richard, 149
Harary, Frank, 165, 174
Hardy, G. H., 110, 118
identity
Cassini’s, 28, 35, 214, 241
Pascal’s, 6, 9, 25, 29, 206
subcommittee, 13
Vandermonde’s, 13, 76
inclusion–exclusion principle, 58,
70, 233
inequalities, Bonferroni, 74, 150,
161, 162
inequality
AM–GM, 157, 234
Chebyshev’s, 77
Kraft’s, 139
Markov’s, 77
triangle, 49
information, 124, 125
information channel, 143
information theory, 123, 134, 135
integral, discrete, 185
integration, discrete, 256
interval, 16
Jarvis, Frazer, 195
Johnson, Selmer M., 189
Johnson–Trotter algorithm, 187,
189, 191

Index
267
Kelly, John L. Jr., 133
Kim, Jeong Han, 162
Knuth, Donald, 106, 194
Kraft’s inequality, 139
Kraft, Leon G. Jr., 139
Kronecker power, 147
Kummer, Ernst Eduard, 98
Landau, H. G., 93
Latin square, 198
lattice path, 13, 55, 73
Laurent series, 59
law of cosines, 224
law of large numbers, 77, 150
Legendre, Adrien-Marie, 98
lexicographic ordering, 187
line, 9
loops, nested, 257
Lucas number, 32, 45, 218
Lucas, Fran¸cois ´Edouard Anatole,
32, 99
Mantel’s theorem, 156
Mantel, W., 156
Markov chain, 82
regular, 83
Markov source, 128
Markov’s inequality, 77
Markov, Andrey, 77, 82
Mathematica, 201
mathematical induction, 28, 51,
106, 124, 156, 210, 213,
214, 217, 219, 223, 232,
251
two variables, 158
matrix, 81, 211
binary, 163, 171, 193
determinant of, 83
diagonal, 87
diagonalizable, 86
permutation, 236
projection, 89
reﬂection, 89
rotation, 236
singular, 83
transition, 82, 86, 87
Maurer, Stephen B., 93
memory feats, 123
monochromatic triangle, 158
move number, 176
multinomial coeﬃcient, 17, 47, 209,
240
multinomial theorem, 17, 209
natural numbers, 3
Nim, 59
number
composite, 103, 106
Fibonacci, 30, 35, 39, 85, 87,
107
generalized pentagonal, 115
golden ratio, 30
googol, 4, 7
Lucas, 32, 45, 218
natural, 3
partition, 109
pentagonal, 114, 119
power, 101
power of 2, 107
prime, 62, 97, 103, 107, 241
pseudopentagonal, 115
Ramsey, 158
real, 18
square, 35, 46
triangular, 35, 119
number system, base of, 183
odometer, 183
order statistics, 249
packing problem, 32, 193
partial fractions, 41, 52, 58
particles, 16
partition number, 109
partition of an integer, 50, 109
conjugate, 111
parts of, 109
self-conjugate, 111, 119

268
Index
Pascal’s identity, 6, 9, 25, 29, 206
Pascal’s triangle, 5, 6, 9, 25, 28, 33,
97, 100, 101
shallow diagonals of, 214
Pascal, Blaise, 6
paths, 13
pentagonal number, 114, 119
period, 52
permutation, 5, 71
cycle form, 73
random, 75
permutation matrix, 236
permutations, listing of, 187
Picasso animal, 177
pigeonhole principle, 156, 250, 254
plane, 9
plane (complex), 50
plane (real), 87
polycube, 193, 195
polycube packing problem, 193
polynomial, 21, 23, 223
characteristic, 86
cubic, 35
elementary symmetric, 55
in two variables, 23
polyomino, 174, 177, 198
power, 101
prime number, 62, 97, 103, 106,
107, 241
probabilistic method, 92, 93, 149
probabilistic proof, 70, 162
probability, 79, 80, 89
conditional, 82, 128, 143
transitional, 128
probability space, 67
probability theory, 74
product rule, 3, 201
proof
algebraic, 9, 15
bijective, 116
calculus, 15, 131
contradiction, 93, 156
counting, 6, 11, 14, 15, 59, 161
generating function, 114, 219
induction, 28, 51, 210, 213,
214, 217, 219, 223, 232,
251
non-constructive, 161
pigeonhole principle, 156–158,
163, 254
probabilistic, 70, 93, 149, 162
symmetry, 130
puzzle
polycube packing, 193
Sudoku, 193
Tower of Hanoi, 183, 186, 256
quadratic residue, 160
quadratic residue tournament, 91
Radziszowski, Stanislaw, 160
Ramanujan, Srinivasa, 110, 118
Ramsey game, 165, 167, 169, 171
Ramsey number, 158
bipartite, 169
diagonal, 158, 162, 164
graph, 167
Ramsey’s theorem, 158
Ramsey’s theorem for multiple
colors, 159
Ramsey, Frank, 158
random permutation, 75
random tournament, 92
random variable, 68
Bernoulli, 69, 77, 78
binomial, 69
expected value of, 68
geometric, 75
hypergeometric, 76
mean of, 68
negative binomial, 75
standard deviation of, 69
variance of, 68
random variables, independent, 69
rational play, 175
recurrence relation, 25, 83, 86, 110
characteristic polynomial of, 41

Index
269
for Alcuin’s sequence, 51
for derangement numbers, 78
for Fibonacci sequence, 27
for making change, 43
for partition numbers, 109
for Queen paths, 57
for Rook paths, 54
linear homogeneous with
constant coeﬃcients, 29,
40
relation, binary, 8
Sch¨utte’s theorem, 92
Selfridge, John, 167, 168
separation of variables, 232
sequence
D-ﬁnite, 59
Alcuin’s, 49, 51, 52
diagonal, 58, 60
diﬀerence, 21
doubly-inﬁnite, 54
Fibonacci, 39, 51, 107, 226, 237
Fibonacci-like, 103, 106
Lucas, 32
periodic, 226
run in, 78
zigzag, 52, 72
series
binomial, 14, 41, 44, 50
inﬁnite, 39, 46
Laurent, 59
sum of, 26
telescoping, 205, 208
set, 3
Shannon’s ﬁrst theorem, 140
Shannon’s second theorem, 135, 148
Shannon, Claude E., 123
shrewd move, 165
Sieben, N´andor, 177
Singmaster, David, 28
source, 125
discrete memoryless, 125
extension of, 143
Markov, 128
product, 142
singular, 127
uniform, 127
square number, 35, 46
stamps, 62
Frobenius’ problem, 48
steady-state solution, 81
Stirling’s estimate for the factorial
function, 233
stochastic process, 125
strategy, 171
drawing, 165, 168, 169, 171,
174
optimal, 134
winning, 168, 174
string, 4, 183
binary, 4, 14, 27, 184
strings, listing of, 183
subcommittee identity, 13, 100
subgraph, 157
subset, 3, 27
subsets, listing of, 184
subtournament, transitive, 163
Sudoku, 193, 194
sum
inﬁnite, 45
telescoping, 206
Sun Tzu Suan Ching, 105
surprise, 124
Szekeres, George, 100, 101
telescoping series, 208
tic-tac-toe, 173
2-dimensional generalizations
of, 174
higher-dimensional, 173, 174
tournament, 91, 93, 163
Emperor of, 94
King of, 91, 93
quadratic residue, 91
random, 91, 92
Serf of, 91, 93

270
Index
Tower of Hanoi puzzle, 183, 186,
256
Tran, Khang, 60
transition matrix, 82, 86, 87
triangle, 49
circumradius of, 52
equilateral, 240
inradius of, 52
integer, 49
monochromatic, 163
positive, 170
scalene, 52
triangle inequality, 49
triangular number, 35, 119
Trotter, Hale F., 189
Tur´an’s theorem, 157
Tur´an, P´al, 157
Tzu, Sun, 105
uncertainty, 124
urn, 67, 76, 80
Vandermonde’s identity, 13, 76
Vandermonde,
Alexandre-Th´eophile, 13
Venn diagram, 70
vertices
adjacent, 155
nonadjacent, 155
Vsemirnov, Maxim, 106
waiting time, 235
Wythoﬀ’s Nim, 61
Wythoﬀ, Willem Abraham, 61

