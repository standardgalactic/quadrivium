
Encyclopaedia of Mathematical Sciences
Volume 49
Number Theory I

Yuri Ivanovic Manin
Alexei A. Panchishkin
Introduction to
Modern Number
Theory
Fundamental Problems, Ideas and Theories
Second Edition
123

Authors
Yuri Ivanovic Manin
Max-Planck-Institut für Mathematik
Vivatsgasse 7
53111 Bonn, Germany
e-mail: manin@mpim-bonn.mpg.de
Alexei A. Panchishkin
Universit´e Joseph Fourier UMR 5582
Institut Fourier
38402 Saint Martin d'H`eres, France
e-mail: alexei.pantchichkine@ujf-grenoble.fr
Founding editor of the Encyclopaedia of Mathematical Sciences:
R. V. Gamkrelidze
Original Russian version of the ﬁrst edition
was published by VINITI, Moscow in 1990
The ﬁrst edition of this book was published as Number Theory I,
Yu. I. Manin, A. A. Panchishkin (Authors), A. N. Parshin, I. R. Shafarevich (Eds.),
Vol. 49 of the Encyclopaedia of Mathematical Sciences
Mathematics Subject Classification (2000):
11-XX (11A, 11B, 11D, 11E, 11F, 11G, 11R, 11S, 11U, 11Y), 14-XX, 20-XX, 37-XX, 03-XX
ISSN 0938-0396
ISBN-10 3-540-20364-8 Springer Berlin Heidelberg New York
ISBN-13 978-3-540-20364-3 Springer Berlin Heidelberg New York
This work is subject to copyright. All rights are reserved, whether the whole or part of the material is concerned,
speciﬁcally the rights of translation, reprinting, reuse of illustrations, recitation, broadcasting, reproduction on
microﬁlm or in any other way, and storage in data banks. Duplication of this publication or parts thereof is
permitted only under the provisions of the German Copyright Law of September 9, 1965, in its current version, and
permission for use must always be obtained from Springer. Violations are liable for prosecution under the German
Copyright Law.
Springer is a part of Springer Science+Business Media GmbH
springeronline.com
©Springer-Verlag Berlin Heidelberg 2005
Printed in The Netherlands
The use of general descriptive names, registered names, trademarks, etc. in this publication does not imply, even in
the absence of a speciﬁc statement, that such names are exempt from the relevant pro-
tective laws and regulations and therefore free for general use.
Typesetting: by the authors using a Springer LATEX macro package
Cover Design: E. Kirchner, Heidelberg, Germany
Printed on acid-free paper
46/3142 sz
5 4 3 2 1 0

Preface
The present book is a new revised and updated version of "Number Theory
I. Introduction to Number Theory" by Yu.I.Manin and A.A.Panchishkin, ap-
peared in 1989 in Moscow (VINITI Publishers) [Ma-PaM], and in English
translation [Ma-Pa] of 1995 (Springer Verlag).
The original book had been conceived as a part of a vast project, "En-
cyclopaedia of Mathematical Sciences". Accordingly, our task was to provide
a series of introductory essays to various chapters of number theory, lead-
ing the reader from illuminating examples of number theoretic objects and
problems, through general notions and theories, developed gradually by many
researchers, to some of the highlights of modern mathematics and great, some-
times nebulous designs for future generations.
In preparing this new edition, we tried to keep this initial vision intact. We
present many precise deﬁnitions, but practically no complete proofs. We try
to show the logic of number-theoretic thought and the wide context in which
various constructions are made, but for detailed study of the relevant materials
the reader will have to turn to original papers or to other monographs. Because
of lack of competence and/or space, we had to - reluctantly - omit many
fascinating developments.
The new sections written for this edition, include a sketch of Wiles' proof
of Fermat's Last Theorem, and relevant techniques coming from a synthesis
of various theories of Part II; the whole Part III dedicated to arithmetical
cohomology and noncommutative geometry; a report on point counts on va-
rieties with many rational points; the recent polynomial time algorithm for
primality testing, and some others subjects.
For more detailed description of the content and suggestions for further
reading, see Introduction.

VI
Preface
We are very pleased to express our deep gratitude to Prof. M.Marcolli
for her essential help in preparing the last part of the new edition. We are
very grateful to Prof. H.Cohen for his assistance in updating the book, es-
pecially Chapter 2. Many thanks to Prof. Yu.Tschinkel for very useful sug-
gestions, remarks, and updates; he kindly rewrote §5.2 for this edition. We
thank Dr.R.Hill and Dr.A.Gewirtz for editing some new sections of this edi-
tion, and St.Kühnlein (Universität des Saarlandes) for sending us a detailed
list of remarks to the ﬁrst edition.
Bonn, July 2004
Yu.I.Manin
A.A.Panchishkin

Contents
Part I Problems and Tricks
1
Elementary Number Theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
1.1
Problems About Primes. Divisibility and Primality . . . . . . . . . .
9
1.1.1
Arithmetical Notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
1.1.2
Primes and composite numbers . . . . . . . . . . . . . . . . . . . . . 10
1.1.3
The Factorization Theorem and the Euclidean
Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
1.1.4
Calculations with Residue Classes . . . . . . . . . . . . . . . . . . . 13
1.1.5
The Quadratic Reciprocity Law and Its Use . . . . . . . . . . 15
1.1.6
The Distribution of Primes . . . . . . . . . . . . . . . . . . . . . . . . . 17
1.2
Diophantine Equations of Degree One and Two. . . . . . . . . . . . . . 22
1.2.1
The Equation ax + by = c . . . . . . . . . . . . . . . . . . . . . . . . . . 22
1.2.2
Linear Diophantine Systems . . . . . . . . . . . . . . . . . . . . . . . . 22
1.2.3
Equations of Degree Two . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
1.2.4
The Minkowski-Hasse Principle for Quadratic Forms. . . 26
1.2.5
Pell's Equation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
1.2.6
Representation of Integers and Quadratic Forms by
Quadratic Forms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
1.2.7
Analytic Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
1.2.8
Equivalence of Binary Quadratic Forms . . . . . . . . . . . . . . 35
1.3
Cubic Diophantine Equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
1.3.1
The Problem of the Existence of a Solution . . . . . . . . . . . 38
1.3.2
Addition of Points on a Cubic Curve . . . . . . . . . . . . . . . . . 38
1.3.3
The Structure of the Group of Rational Points of a
Non-Singular Cubic Curve . . . . . . . . . . . . . . . . . . . . . . . . . 40
1.3.4
Cubic Congruences Modulo a Prime . . . . . . . . . . . . . . . . . 47
1.4
Approximations and Continued Fractions . . . . . . . . . . . . . . . . . . . 50
1.4.1
Best Approximations to Irrational Numbers . . . . . . . . . . 50
1.4.2
Farey Series . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
1.4.3
Continued Fractions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51

VIII
Contents
1.4.4
SL2-Equivalence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
1.4.5
Periodic Continued Fractions and Pell's Equation. . . . . . 53
1.5
Diophantine Approximation and the Irrationality . . . . . . . . . . . . 55
1.5.1
Ideas in the Proof that ζ(3) is Irrational . . . . . . . . . . . . . . 55
1.5.2
The Measure of Irrationality of a Number . . . . . . . . . . . . 56
1.5.3
The Thue-Siegel-Roth Theorem, Transcendental
Numbers, and Diophantine Equations . . . . . . . . . . . . . . . . 57
1.5.4
Proofs of the Identities (1.5.1) and (1.5.2) . . . . . . . . . . . . 58
1.5.5
The Recurrent Sequences an and bn . . . . . . . . . . . . . . . . . 59
1.5.6
Transcendental Numbers and the Seventh Hilbert
Problem. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
1.5.7
Work of Yu.V. Nesterenko on eπ, [Nes99] . . . . . . . . . . . . . 61
2
Some Applications of Elementary Number Theory . . . . . . . . . 63
2.1
Factorization and Public Key Cryptosystems . . . . . . . . . . . . . . . . 63
2.1.1
Factorization is Time-Consuming . . . . . . . . . . . . . . . . . . . . 63
2.1.2
One-Way Functions and Public Key Encryption . . . . . . . 63
2.1.3
A Public Key Cryptosystem . . . . . . . . . . . . . . . . . . . . . . . . 64
2.1.4
Statistics and Mass Production of Primes. . . . . . . . . . . . . 66
2.1.5
Probabilistic Primality Tests . . . . . . . . . . . . . . . . . . . . . . . . 66
2.1.6
The Discrete Logarithm Problem and The
Diﬃe-Hellman Key Exchange Protocol . . . . . . . . . . . . . . . 67
2.1.7
Computing of the Discrete Logarithm on Elliptic
Curves over Finite Fields (ECDLP) . . . . . . . . . . . . . . . . . . 68
2.2
Deterministic Primality Tests . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
2.2.1
Adleman-Pomerance-Rumely Primality Test: Basic
Ideas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
2.2.2
Gauss Sums and Their Use in Primality Testing . . . . . . . 71
2.2.3
Detailed Description of the Primality Test . . . . . . . . . . . . 75
2.2.4
Primes is in P . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
2.2.5
The algorithm of M. Agrawal, N. Kayal and N. Saxena . 81
2.2.6
Practical and Theoretical Primality Proving. The
ECPP (Elliptic Curve Primality Proving by F.Morain,
see [AtMo93b]) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
2.2.7
Primes in Arithmetic Progression . . . . . . . . . . . . . . . . . . . . 82
2.3
Factorization of Large Integers . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84
2.3.1
Comparative Diﬃculty of Primality Testing and
Factorization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84
2.3.2
Factorization and Quadratic Forms . . . . . . . . . . . . . . . . . . 84
2.3.3
The Probabilistic Algorithm CLASNO . . . . . . . . . . . . . . . 85
2.3.4
The Continued Fractions Method (CFRAC) and Real
Quadratic Fields . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87
2.3.5
The Use of Elliptic Curves . . . . . . . . . . . . . . . . . . . . . . . . . . 90

Contents
IX
Part II Ideas and Theories
3
Induction and Recursion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
3.1
Elementary Number Theory From the Point of View of Logic . 95
3.1.1
Elementary Number Theory . . . . . . . . . . . . . . . . . . . . . . . . 95
3.1.2
Logic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96
3.2
Diophantine Sets
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98
3.2.1
Enumerability and Diophantine Sets
. . . . . . . . . . . . . . . . 98
3.2.2
Diophantineness of enumerable sets . . . . . . . . . . . . . . . . . . 98
3.2.3
First properties of Diophantine sets . . . . . . . . . . . . . . . . . 98
3.2.4
Diophantineness and Pell's Equation . . . . . . . . . . . . . . . . . 99
3.2.5
The Graph of the Exponent is Diophantine . . . . . . . . . . . 100
3.2.6
Diophantineness and Binomial coeﬃcients . . . . . . . . . . . . 100
3.2.7
Binomial coeﬃcients as remainders . . . . . . . . . . . . . . . . . . 101
3.2.8
Diophantineness of the Factorial. . . . . . . . . . . . . . . . . . . . . 101
3.2.9
Factorial and Euclidean Division . . . . . . . . . . . . . . . . . . . . 101
3.2.10 Supplementary Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102
3.3
Partially Recursive Functions and Enumerable Sets . . . . . . . . . . 103
3.3.1
Partial Functions and Computable Functions . . . . . . . . . 103
3.3.2
The Simple Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103
3.3.3
Elementary Operations on Partial functions. . . . . . . . . . . 103
3.3.4
Partially Recursive Description of a Function . . . . . . . . . 104
3.3.5
Other Recursive Functions . . . . . . . . . . . . . . . . . . . . . . . . . . 106
3.3.6
Further Properties of Recursive Functions . . . . . . . . . . . . 108
3.3.7
Link with Level Sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108
3.3.8
Link with Projections of Level Sets . . . . . . . . . . . . . . . . . . 108
3.3.9
Matiyasevich's Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109
3.3.10 The existence of certain bijections . . . . . . . . . . . . . . . . . . . 109
3.3.11 Operations on primitively enumerable sets . . . . . . . . . . . . 111
3.3.12 Gödel's function. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111
3.3.13 Discussion of the Properties of Enumerable Sets . . . . . . . 112
3.4
Diophantineness of a Set and algorithmic Undecidability. . . . . . 113
3.4.1
Algorithmic undecidability and unsolvability . . . . . . . . . . 113
3.4.2
Sketch Proof of the Matiyasevich Theorem . . . . . . . . . . . 113
4
Arithmetic of algebraic numbers . . . . . . . . . . . . . . . . . . . . . . . . . . . 115
4.1
Algebraic Numbers: Their Realizations and Geometry . . . . . . . . 115
4.1.1
Adjoining Roots of Polynomials . . . . . . . . . . . . . . . . . . . . . 115
4.1.2
Galois Extensions and Frobenius Elements. . . . . . . . . . . . 117
4.1.3
Tensor Products of Fields and Geometric Realizations
of Algebraic Numbers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
4.1.4
Units, the Logarithmic Map, and the Regulator . . . . . . . 121
4.1.5
Lattice Points in a Convex Body . . . . . . . . . . . . . . . . . . . . 123

X
Contents
4.1.6
Deduction of Dirichlet's Theorem From Minkowski's
Lemma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125
4.2
Decomposition of Prime Ideals, Dedekind Domains, and
Valuations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126
4.2.1
Prime Ideals and the Unique Factorization Property . . . 126
4.2.2
Finiteness of the Class Number . . . . . . . . . . . . . . . . . . . . . 128
4.2.3
Decomposition of Prime Ideals in Extensions . . . . . . . . . . 129
4.2.4
Decomposition of primes in cyslotomic ﬁelds . . . . . . . . . . 131
4.2.5
Prime Ideals, Valuations and Absolute Values . . . . . . . . . 132
4.3
Local and Global Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134
4.3.1
p-adic Numbers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134
4.3.2
Applications of p-adic Numbers to Solving Congruences 138
4.3.3
The Hilbert Symbol . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139
4.3.4
Algebraic Extensions of Qp, and the Tate Field. . . . . . . . 142
4.3.5
Normalized Absolute Values . . . . . . . . . . . . . . . . . . . . . . . . 143
4.3.6
Places of Number Fields and the Product Formula . . . . . 145
4.3.7
Adeles and Ideles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 146
The Ring of Adeles. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 146
The Idele Group . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149
4.3.8
The Geometry of Adeles and Ideles . . . . . . . . . . . . . . . . . . 149
4.4
Class Field Theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 155
4.4.1
Abelian Extensions of the Field of Rational Numbers . . 155
4.4.2
Frobenius Automorphisms of Number Fields and
Artin's Reciprocity Map. . . . . . . . . . . . . . . . . . . . . . . . . . . . 157
4.4.3
The Chebotarev Density Theorem . . . . . . . . . . . . . . . . . . . 159
4.4.4
The Decomposition Law and
the Artin Reciprocity Map . . . . . . . . . . . . . . . . . . . . . . . . . 159
4.4.5
The Kernel of the Reciprocity Map . . . . . . . . . . . . . . . . . . 160
4.4.6
The Artin Symbol . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 161
4.4.7
Global Properties of the Artin Symbol . . . . . . . . . . . . . . . 162
4.4.8
A Link Between the Artin Symbol and Local Symbols. . 163
4.4.9
Properties of the Local Symbol . . . . . . . . . . . . . . . . . . . . . . 164
4.4.10 An Explicit Construction of Abelian Extensions of a
Local Field, and a Calculation of the Local Symbol . . . . 165
4.4.11 Abelian Extensions of Number Fields . . . . . . . . . . . . . . . . 168
4.5
Galois Group in Arithetical Problems . . . . . . . . . . . . . . . . . . . . . . 172
4.5.1
Dividing a circle into n equal parts . . . . . . . . . . . . . . . . . . 172
4.5.2
Kummer Extensions and the Power Residue Symbol . . . 175
4.5.3
Galois Cohomology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 178
4.5.4
A Cohomological Deﬁnition of the Local Symbol . . . . . . 182
4.5.5
The Brauer Group, the Reciprocity Law and the
Minkowski-Hasse Principle . . . . . . . . . . . . . . . . . . . . . . . . . 184

Contents
XI
5
Arithmetic of algebraic varieties . . . . . . . . . . . . . . . . . . . . . . . . . . . 191
5.1
Arithmetic Varieties and Basic Notions of Algebraic Geometry 191
5.1.1
Equations and Rings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191
5.1.2
The set of solutions of a system . . . . . . . . . . . . . . . . . . . . . 191
5.1.3
Example: The Language of Congruences . . . . . . . . . . . . . . 192
5.1.4
Equivalence of Systems of Equations . . . . . . . . . . . . . . . . . 192
5.1.5
Solutions as K-algebra Homomorphisms . . . . . . . . . . . . . . 192
5.1.6
The Spectrum of A Ring . . . . . . . . . . . . . . . . . . . . . . . . . . . 193
5.1.7
Regular Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 193
5.1.8
A Topology on Spec(A) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 193
5.1.9
Schemes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 196
5.1.10 Ring-Valued Points of Schemes . . . . . . . . . . . . . . . . . . . . . . 197
5.1.11 Solutions to Equations and Points of Schemes . . . . . . . . . 198
5.1.12 Chevalley's Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 199
5.1.13 Some Geometric Notions . . . . . . . . . . . . . . . . . . . . . . . . . . . 199
5.2
Geometric Notions in the Study of Diophantine equations . . . . 202
5.2.1
Basic Questions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 202
5.2.2
Geometric classiﬁcation . . . . . . . . . . . . . . . . . . . . . . . . . . . . 203
5.2.3
Existence of Rational Points and Obstructions to the
Hasse Principle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 204
5.2.4
Finite and Inﬁnite Sets of Solutions . . . . . . . . . . . . . . . . . . 206
5.2.5
Number of points of bounded height . . . . . . . . . . . . . . . . . 208
5.2.6
Height and Arakelov Geometry. . . . . . . . . . . . . . . . . . . . . . 211
5.3
Elliptic curves, Abelian Varieties, and Linear Groups. . . . . . . . . 213
5.3.1
Algebraic Curves and Riemann Surfaces . . . . . . . . . . . . . . 213
5.3.2
Elliptic Curves . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 213
5.3.3
Tate Curve and Its Points of Finite Order . . . . . . . . . . . . 219
5.3.4
The Mordell - Weil Theorem and Galois Cohomology . . 221
5.3.5
Abelian Varieties and Jacobians . . . . . . . . . . . . . . . . . . . . . 226
5.3.6
The Jacobian of an Algebraic Curve . . . . . . . . . . . . . . . . . 228
5.3.7
Siegel's Formula and Tamagawa Measure . . . . . . . . . . . . . 231
5.4
Diophantine Equations and Galois Representations . . . . . . . . . . 238
5.4.1
The Tate Module of an Elliptic Curve . . . . . . . . . . . . . . . . 238
5.4.2
The Theory of Complex Multiplication . . . . . . . . . . . . . . . 240
5.4.3
Characters of l-adic Representations . . . . . . . . . . . . . . . . . 242
5.4.4
Representations in Positive Characteristic . . . . . . . . . . . . 243
5.4.5
The Tate Module of a Number Field . . . . . . . . . . . . . . . . . 244
5.5
The Theorem of Faltings and Finiteness Problems in
Diophantine Geometry . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 247
5.5.1
Reduction of the Mordell Conjecture to the ﬁniteness
Conjecture . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 247
5.5.2
The Theorem of Shafarevich on Finiteness for Elliptic
Curves . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 249
5.5.3
Passage to Abelian varieties . . . . . . . . . . . . . . . . . . . . . . . . 250
5.5.4
Finiteness problems and Tate's conjecture . . . . . . . . . . . . 252

XII
Contents
5.5.5
Reduction of the conjectures of Tate to the ﬁniteness
properties for isogenies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 253
5.5.6
The Faltings-Arakelov Height . . . . . . . . . . . . . . . . . . . . . . . 255
5.5.7
Heights under isogenies and Conjecture T . . . . . . . . . . . . 257
6
Zeta Functions and Modular Forms . . . . . . . . . . . . . . . . . . . . . . . . 261
6.1
Zeta Functions of Arithmetic Schemes. . . . . . . . . . . . . . . . . . . . . . 261
6.1.1
Zeta Functions of Arithmetic Schemes . . . . . . . . . . . . . . . 261
6.1.2
Analytic Continuation of the Zeta Functions . . . . . . . . . . 263
6.1.3
Schemes over Finite Fields and Deligne's Theorem . . . . . 263
6.1.4
Zeta Functions and Exponential Sums . . . . . . . . . . . . . . . 267
6.2
L-Functions, the Theory of Tate and Explicite Formulae . . . . . . 272
6.2.1
L-Functions of Rational Galois Representations . . . . . . . 272
6.2.2
The Formalism of Artin . . . . . . . . . . . . . . . . . . . . . . . . . . . . 274
6.2.3
Example: The Dedekind Zeta Function . . . . . . . . . . . . . . . 276
6.2.4
Hecke Characters and the Theory of Tate . . . . . . . . . . . . 278
6.2.5
Explicit Formulae . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 285
6.2.6
The Weil Group and its Representations . . . . . . . . . . . . . 288
6.2.7
Zeta Functions, L-Functions and Motives . . . . . . . . . . . . . 290
6.3
Modular Forms and Euler Products . . . . . . . . . . . . . . . . . . . . . . . . 296
6.3.1
A Link Between Algebraic Varieties and L-Functions. . 296
6.3.2
Classical modular forms . . . . . . . . . . . . . . . . . . . . . . . . . . . . 296
6.3.3
Application: Tate Curve and Semistable Elliptic Curves 299
6.3.4
Analytic families of elliptic curves and congruence
subgroups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 301
6.3.5
Modular forms for congruence subgroups . . . . . . . . . . . . . 302
6.3.6
Hecke Theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 304
6.3.7
Primitive Forms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 310
6.3.8
Weil's Inverse Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . 312
6.4
Modular Forms and Galois Representations . . . . . . . . . . . . . . . . . 317
6.4.1
Ramanujan's congruence and Galois Representations . . . 317
6.4.2
A Link with Eichler-Shimura's Construction . . . . . . . . . . 319
6.4.3
The Shimura-Taniyama-Weil Conjecture . . . . . . . . . . . . . 320
6.4.4
The Conjecture of Birch and Swinnerton-Dyer . . . . . . . . 321
6.4.5
The Artin Conjecture and Cusp Forms . . . . . . . . . . . . . . . 327
The Artin conductor . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 329
6.4.6
Modular Representations over Finite Fields . . . . . . . . . . . 330
6.5
Automorphic Forms and The Langlands Program . . . . . . . . . . . . 332
6.5.1
A Relation Between Classical Modular Forms and
Representation Theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 332
6.5.2
Automorphic L-Functions . . . . . . . . . . . . . . . . . . . . . . . . . . 335
Further analytic properties of automorphic L-functions . 338
6.5.3
The Langlands Functoriality Principle . . . . . . . . . . . . . . . 338
6.5.4
Automorphic Forms and Langlands Conjectures . . . . . . . 339

Contents
XIII
7
Fermat's Last Theorem and Families of Modular Forms . . . . 341
7.1
Shimura-Taniyama-Weil Conjecture and Reciprocity Laws . . . 341
7.1.1
Problem of Pierre de Fermat (1601-1665). . . . . . . . . . . . . 341
7.1.2
G.Lamé's Mistake . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 342
7.1.3
A short overview of Wiles' Marvelous Proof . . . . . . . . . . . 343
7.1.4
The STW Conjecture . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 344
7.1.5
A connection with the Quadratic Reciprocity Law . . . . . 345
7.1.6
A complete proof of the STW conjecture . . . . . . . . . . . . . 345
7.1.7
Modularity of semistable elliptic curves . . . . . . . . . . . . . . 348
7.1.8
Structure of the proof of theorem 7.13 (Semistable
STW Conjecture) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 349
7.2
Theorem of Langlands-Tunnell and
Modularity Modulo 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 352
7.2.1
Galois representations: preparation . . . . . . . . . . . . . . . . . . 352
7.2.2
Modularity modulo p . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 354
7.2.3
Passage from cusp forms of weight one to cusp forms
of weight two . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 355
7.2.4
Preliminary review of the stages of the proof of
Theorem 7.13 on modularity . . . . . . . . . . . . . . . . . . . . . . . . 356
7.3
Modularity of Galois representations and Universal
Deformation Rings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 357
7.3.1
Galois Representations over local Noetherian algebras . . 357
7.3.2
Deformations of Galois Representations . . . . . . . . . . . . . . 357
7.3.3
Modular Galois representations . . . . . . . . . . . . . . . . . . . . . 359
7.3.4
Admissible Deformations and Modular Deformations . . . 361
7.3.5
Universal Deformation Rings. . . . . . . . . . . . . . . . . . . . . . . . 363
7.4
Wiles' Main Theorem and Isomorphism Criteria for Local
Rings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 365
7.4.1
Strategy of the proof of the Main Theorem 7.33 . . . . . . . 365
7.4.2
Surjectivity of ϕΣ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 365
7.4.3
Constructions of the universal deformation ring RΣ . . . . 367
7.4.4
A sketch of a construction of the universal modular
deformation ring TΣ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 368
7.4.5
Universality and the Chebotarev density theorem . . . . . . 369
7.4.6
Isomorphism Criteria for local rings. . . . . . . . . . . . . . . . . . 370
7.4.7
J-structures and the second criterion of isomorphism
of local rings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 371
7.5
Wiles' Induction Step: Application of the Criteria and Galois
Cohomology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 373
7.5.1
Wiles' induction step in the proof of
Main Theorem 7.33 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 373
7.5.2
A formula relating #ΦRΣ and #ΦRΣ′ : preparation. . . . . 374
7.5.3
The Selmer group and ΦRΣ . . . . . . . . . . . . . . . . . . . . . . . . . 375
7.5.4
Inﬁnitesimal deformations . . . . . . . . . . . . . . . . . . . . . . . . . . 375
7.5.5
Deformations of type DΣ . . . . . . . . . . . . . . . . . . . . . . . . . . . 377

XIV
Contents
7.6
The Relative Invariant, the Main Inequality and The Minimal
Case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 382
7.6.1
The Relative invariant . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 382
7.6.2
The Main Inequality . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 383
7.6.3
The Minimal Case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 386
7.7
End of Wiles' Proof and Theorem on Absolute Irreducibility . . 388
7.7.1
Theorem on Absolute Irreducibility . . . . . . . . . . . . . . . . . . 388
7.7.2
From p = 3 to p = 5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 390
7.7.3
Families of elliptic curves with ﬁxed ρ5,E . . . . . . . . . . . . . 391
7.7.4
The end of the proof . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 392
The most important insights. . . . . . . . . . . . . . . . . . . . . . . . 393
Part III Analogies and Visions
III-0 Introductory survey to part III: motivations and
description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 397
III.1 Analogies and diﬀerences between numbers and functions:
∞-point, Archimedean properties etc. . . . . . . . . . . . . . . . . . . . . . . 397
III.1.1 Cauchy residue formula and the product formula . . . . . . 397
III.1.2 Arithmetic varieties. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 398
III.1.3 Inﬁnitesimal neighborhoods of ﬁbers . . . . . . . . . . . . . . . . . 398
III.2 Arakelov geometry, ﬁber over ∞, cycles, Green functions
(d'après Gillet-Soulé) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 399
III.2.1 Arithmetic Chow groups . . . . . . . . . . . . . . . . . . . . . . . . . . . 400
III.2.2 Arithmetic intersection theory and arithmetic
Riemann-Roch theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . 401
III.2.3 Geometric description of the closed ﬁbers at inﬁnity . . . 402
III.3 ζ-functions, local factors at ∞, Serre's Γ-factors . . . . . . . . . . . . . 404
III.3.1 Archimedean L-factors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 405
III.3.2 Deninger's formulae . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 406
III.4
A guess that the missing geometric objects are
noncommutative spaces . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 407
III.4.1 Types and examples of noncommutative spaces, and
how to work with them. Noncommutative geometry
and arithmetic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 407
Isomorphism of noncommutative spaces and Morita
equivalence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 409
The tools of noncommutative geometry . . . . . . . . . . . . . . 410
III.4.2 Generalities on spectral triples . . . . . . . . . . . . . . . . . . . . . . 411
III.4.3 Contents of Part III: description of parts of this program412

Contents
XV
8
Arakelov Geometry and Noncommutative Geometry. . . . . . . 415
8.1
Schottky Uniformization and Arakelov Geometry . . . . . . . . . . . . 415
8.1.1
Motivations and the context of the work of
Consani-Marcolli . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 415
8.1.2
Analytic construction of degenerating curves over
complete local ﬁelds . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 416
8.1.3
Schottky groups and new perspectives in Arakelov
geometry . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 420
Schottky uniformization and Schottky groups . . . . . . . . . 421
Fuchsian and Schottky uniformization. . . . . . . . . . . . . . . . 424
8.1.4
Hyperbolic handlebodies . . . . . . . . . . . . . . . . . . . . . . . . . . . 425
Geodesics in XΓ
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 427
8.1.5
Arakelov geometry and hyperbolic geometry . . . . . . . . . . 427
Arakelov Green function . . . . . . . . . . . . . . . . . . . . . . . . . . . 427
Cross ratio and geodesics . . . . . . . . . . . . . . . . . . . . . . . . . . . 428
Diﬀerentials and Schottky uniformization . . . . . . . . . . . . . 428
Green function and geodesics . . . . . . . . . . . . . . . . . . . . . . . 430
8.2
Cohomological Constructions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 431
8.2.1
Archimedean cohomology. . . . . . . . . . . . . . . . . . . . . . . . . . . 431
Operators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 433
SL(2, R) representations . . . . . . . . . . . . . . . . . . . . . . . . . . . . 434
8.2.2
Local factor and Archimedean cohomology . . . . . . . . . . . 435
8.2.3
Cohomological constructions . . . . . . . . . . . . . . . . . . . . . . . . 436
8.2.4
Zeta function of the special ﬁber and Reidemeister
torsion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 437
8.3
Spectral Triples, Dynamics and Zeta Functions . . . . . . . . . . . . . . 440
8.3.1
A dynamical theory at inﬁnity . . . . . . . . . . . . . . . . . . . . . . 442
8.3.2
Homotopy quotion. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 443
8.3.3
Filtration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 444
8.3.4
Hilbert space and grading . . . . . . . . . . . . . . . . . . . . . . . . . . 446
8.3.5
Cuntz-Krieger algebra . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 446
Spectral triples for Schottky groups . . . . . . . . . . . . . . . . . . 448
8.3.6
Arithmetic surfaces: homology and cohomology . . . . . . . 449
8.3.7
Archimedean factors from dynamics . . . . . . . . . . . . . . . . . 450
8.3.8
A Dynamical theory for Mumford curves . . . . . . . . . . . . . 450
Genus two example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 452
8.3.9
Cohomology of W(∆/Γ)T . . . . . . . . . . . . . . . . . . . . . . . . . . 454
8.3.10 Spectral triples and Mumford curves . . . . . . . . . . . . . . . . . 456
8.4
Reduction mod ∞. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 458
8.4.1
Homotopy quotients and "reduction mod inﬁnity" . . . . . 458
8.4.2
Baum-Connes map . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 460
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 461
Index . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 503

Introduction
Among the various branches of mathematics, number theory is characterized
to a lesser degree by its primary subject ("integers") than by a psychologi-
cal attitude. Actually, number theory also deals with rational, algebraic, and
transcendental numbers, with some very speciﬁc analytic functions (such as
Dirichlet series and modular forms), and with some geometric objects (such
as lattices and schemes over Z). The question whether a given article belongs
to number theory is answered by its author's system of values. If arithmetic
is not there, the paper will hardly be considered as number-theoretical, even
if it deals exclusively with integers and congruences. On the other hand, any
mathematical tool, say, homotopy theory or dynamical systems may become
an important source of number-theoretical inspiration. For this reason, com-
binatorics and the theory of recursive functions are not usually associated
with number theory, whereas modular functions are.
In this book we interpret number theory broadly. There are compelling
reasons to adopt this viewpoint.
First of all, the integers constitute (together with geometric images) one of
the primary subjects of mathematics in general. Because of this, the history
of elementary number theory is as long as the history of all mathematics, and
the history of modern mathematic began when "numbers" and "ﬁgures" were
united by the concept of coordinates (which in the opinion of I.R.Shafarevich
also forms the basic idea of algebra, see [Sha87]).
Moreover, integers constitute the basic universe of discrete symbols and
therefore a universe of all logical constructions conceived as symbolic games.
Of course, as an act of individual creativity, mathematics does not reduce
to logic. Nevertheless, in the collective consciousness of our epoch there does
exist an image of mathematics as a potentially complete, immense and pre-
cise logical construction. While the unrealistic rigidity of this image is well
understood, there is still a strong tendency to keep it alive. The last but not
the least reason for this is the computer reality of our time, with its very
strict demands on the logical structure of a particular kind of mathematical
production: software.

2
Introduction
It was a discovery of our century, due to Hilbert and Gödel above all,
that the properties of integers are general properties of discrete systems and
therefore properties of the world of mathematical reasoning. We understand
now that this idea can be stated as a theorem that provability in an arbitrary
ﬁnitistic formal system is equivalent to a statement about decidability of a
system of Diophantine equations (cf. below). This paradoxical fact shows that
number theory, being a small part of mathematical knowledge, potentially
embraces all this knowledge. If Gauss' famous motto on arithmetic ∗) needs
justiﬁcation, this theorem can be considered as such.
We had no intention of presenting in this report the whole of number theo-
ry. That would be impossible anyway. Therefore, we had to consider the usual
choice and organization problems. Following some fairly traditional classiﬁca-
tion principles, we could have divided the bulk of this book into the following
parts:
1. Elementary number theory.
2. Arithmetic of algebraic numbers.
3. Number-theoretical structure of the continuum (approximation theory,
transcendental numbers, geometry of numbers Minkowski style, metric
number theory etc.).
4. Analytic number theory (circle method, exponential sums, Dirichlet series
and explicit formulae, modular forms).
5. Algebraic-geometric methods in the theory of Diophantine equations.
6. Miscellany ("wastebasket").
We preferred, however, a diﬀerent system, and decided to organize our subject
into three large subheadings which shall be described below. Because of our
incompetence and/or lack of space we then had to omit many important
themes that were initially included into our plan. We shall nevertheless brieﬂy
explain its concepts in order to present in a due perspective both this book
and subsequent number-theoretical issues of this series.
Part I. Problems and Tricks
The choice of the material for this part was guided by the following principles.
In number theory, like in no other branch of mathematics, a bright young
person with a minimal mathematical education can sometimes work wonders
using inventive tricks. There are a lot of unsolved elementary problems waiting
"... Mathematik ist die Königin von Wissenschaften und Arithmetik die Köni-
gin von Mathematik. . . . in allen Relationen sie wird zum ersten Rank erlaubt."
-Gauss. . . . , cf. e.g. http://www.geocities.com/RainForest/Vines/2977
/gauss/deutsch/quotes.html ("Mathematics is the queen of sciences and arith-
metic the queen of mathematics. She often condescends to render service to as-
tronomy and other natural sciences, but in all relations she is entitled to the ﬁrst
rank." -Gauss. Sartorius von Walterhausen: Gauss zum Gedächtniss. (Leipzig,
1856), p.79.)

Introduction
3
for fresh approaches. Of course, good taste is still necessary, and this comes
with long training. Also, nobody can tell a priori that, say, the ancient problem
on the pairs of "friendly numbers" is a bad one, while the Fermat conjecture is
a beauty but it cannot be approached without seriously developed technique.
Elementary number theory consists of many problems, posed, solved and
developed into theorems in the classical literature (Chapter 1), and also of
many tricks which subsequently grew into large theories. The list of such
tricks is still growing, as Apéry's proof of the irrationality of ζ(3) shows. Any
professional mathematician can gain by knowing some of these stratagems.
In order not to restrict ourselves to very well known results we emphasize
algorithmic problems and such modern applications of number theory as pub-
lic key cryptography (Chapter 2). In general, the number-theoretical methods
of information processing, oriented towards computer science (e.g. the fast
Fourier transform) have revitalized the classical elementary number theory.
Part II. Ideas and Theories
In this part we intended to explain the next stage of the number-theoreti-
cal conceptions, in which special methods for solving special problems are
systematized and axiomatized, and become the subject-matter of monographs
and advanced courses.
From this vantage point, the elementary number theory becomes an imag-
inary collection of all theorems which can be deduced from the Peano axioms,
of which the strongest tool is the induction axiom. It appears in such a role in
meta-mathematical investigations and has for several decades been developed
as a part of mathematical logic, namely the theory of recursive functions.
Finally, since the remarkable proof of Matiyasevich's theorem, a further ac-
complished number-theoretical fragment has detached itself from this theory
- the theory of Diophantine sets.
A Diophantine set is any subset of natural numbers that can be deﬁned
as a projection of the solution set of a system of polynomial equations with
integral coeﬃcients. The Matiyasevich theorem says that any set generated
by an algorithm (technically speaking, enumerable or listable) is actually Dio-
phantine. In particular, to this class belongs the set of all numbers of provable
statements of an arbitrary ﬁnitely generated formal system, say, of axioma-
tized set-theoretical mathematics (Chapter 3).
The next large chapter of modern arithmetic (Chapter 4) is connected with
the extension of the domain of integers to the domain of algebraic integers.
The latter is not ﬁnitely generated as a ring, and only its ﬁnitely generated
subrings consisting of all integers of a ﬁnite extension of Q preserve essential
similarity to classical arithmetic. Historically such extensions were motivated
by problems stated for Z, (e.g. the Fermat conjecture, which leads to the
divisibility properties of cyclotomic integers). Gradually however an essen-
tially new object began to dominate the picture - the fundamental symmetry
group of number theory Gal(Q/Q). It was probably Gauss who ﬁrst under-
stood this clearly. His earliest work on the construction of regular polygons by

4
Introduction
ruler-and-compass methods already shows that this problem is governed not
by the visible symmetry of the ﬁgure but by the well-hidden Galois symmetry.
His subsequent concentration on the quadratic reciprocity law (for which he
suggested seven or eight proofs!) is striking evidence that he foresaw its place
in modern class-ﬁeld theory. Unfortunately, in most modern texts devoted to
elementary number theory one cannot ﬁnd any hint of explanation as to why
quadratic reciprocity is anything more than just a curiosity. The point is that
primes, the traditional subject matter of arithmetic, have another avatar as
Frobenius elements in the Galois group. Acting as such upon algebraic num-
bers, they encode in this disguise of symmetries much more number-theoretical
information than in their more standard appearance as elements of Z.
The next two chapters of this part of our report are devoted to algebraic-
geometric methods, zeta-functions of schemes over Z, and modular forms.
These subjects are closely interconnected and furnish the most important
technical tools for the investigation of Diophantine equations.
For a geometer, an algebraic variety is the set of all solutions of a system of
polynomial equations deﬁned, say, over the complex numbers. Such a variety
has a series of invariants. One starts with topological invariants like dimension
and (co)homology groups; one then takes into account the analytic invariants
such as the cohomology of the powers of the canonical sheaf, moduli etc. The
fundamental idea is that these invariants should deﬁne the qualitative features
of the initial Diophantine problem, for example the possible existence of an
inﬁnity of solutions, the behaviour of the quantity of solutions of bounded size
etc. (see Chapter 5). This is only a guiding principle, but its concrete realiza-
tions belong to the most important achievements of twentieth century number
theory, namely A.Weil's programme and its realization by A.Grothendieck and
P.Deligne, as well as G.Faltings' proof of the Mordell conjecture.
Zeta-functions (see Chapter 6) furnish an analytical technique for reﬁning
qualitative statements to quantitative ones. The central place here belongs to
the so called "explicit formulae". These can be traced back to Riemann who in
his famous memoir discovered the third avatar of primes - zeroes of Riemann's
zeta function. Generally, arithmetical functions and zeroes of various zetas are
related by a subtle duality. Proved or conjectured properties of the zeroes are
translated back to arithmetic by means of the explicit formulae. This duality
lies in the heart of modern number theory.
Modular forms have been known since the times of Euler and Jacobi. They
have been used to obtain many beautiful and mysterious number-theoretical
results. Simply by comparing the Fourier coeﬃcients of a theta-series with its
decomposition as a linear combination of Eisenstein series and cusp forms,
one obtains a number of remarkable identities. The last decades made us
aware that modular forms, via Mellin's transform, also provide key informa-
tion about the analytic properties of various zeta-functions.
The material that deserved to be included into this central part of our re-
port is immense and we have had to pass in silence over many important devel-
opments. We have also omitted some classical tools like the Hardy-Littlewood

Introduction
5
circle method and the Vinogradov method of exponential sums. These were
described elsewhere (see [Vau81-97], [Kar75], . . . ). We have said only a few
words on Diophantine approximation and transcendental numbers, in partic-
ular, the Gelfond-Baker and the Gelfond-Schneider methods (see [FelNes98],
[Bak86], [BDGP96], [Wald2000], [Ch-L01], [Bo90]. . . ).
The Langlands program strives to understand the structure of the Galois
group of all algebraic numbers and relates in a series of deep conjectures the
representation theory of this group to zeta-functions and modular forms.
Finally, at the end of Part II we try to present a comprehensive exposi-
tion of Wiles' marvelous proof of Fermat's Last Theorem and the Shimura-
Taniyama-Weil conjecture using a synthese of several highly developed the-
ories such as algebraic number theory, ring theory, algebraic geometry, the
theory of elliptic curves, representation theory, Iwasawa theory, and defor-
mation theory of Galois representations. Wiles used various sophisticated
techniques and ideas due to himself and a number of other mathemati-
cians (K.Ribet, G.Frey, Y.Hellegouarch, J.-M.Fontaine, B.Mazur, H.Hida, J.-
P.Serre, J.Tunnell, ...). This genuinely historic event concludes a whole epoque
in number theory, and opens at the same time a new period which could be
closely involved with implementing the general Langlands program. Indeed,
the Taniyama-Weil conjecture may be regarded as a special case of Langlands'
conjectural correspondence between arithmetical algebraic varieties (motives),
Galois representations and automorphic forms.
Part III. Analogies and Visions
This part was conceived as an illustration of some basic intuitive ideas that
underlie modern number-theoretical thinking. One subject could have been
called Analogies between numbers and functions. We have included under this
heading an introduction to Non-commutative geometry, Arakelov geometry,
Deninger program, Connes' ideas on Trace formula in noncommutative Geom-
etry and the zeros of the Riemann zeta function . . . Note also the excellent
book [Huls94] which intends to give an overview of conjectures that dominate
arithmetic algebraic geometry. These conjectures include the Beilinson conjec-
tures, the Birch-Swinnerton-Dyer conjecture, the Shimura-Taniyama-Weil and
the Tate conjectures, . . . . Note also works [Ta84], [Yos03], [Man02],[Man02a]
on promising developments on Stark's conjectures.
In Arakelov theory a completion of an arithmetic surface is achieved by
enlarging the group of divisors by formal linear combinations of the "closed
ﬁbers at inﬁnity". The dual graph of any such closed ﬁber can be described
in terms of an inﬁnite tangle of bounded geodesics in a hyperbolic handle-
body endowed with a Schottky uniformization. In the last Chapter 8, largerly
based on a recent work of Caterina Consani and Matilde Marcolli, we consider
arithmetic surfaces over the ring of integers in a number ﬁeld, with ﬁbers of
genus g ≥2. One can use Connes' theory to relate the hyperbolic geometry to
Deninger's Archimedean cohomology and the cohomology of the cone of the
local monodromy N at arithmetic inﬁnity.

6
Introduction
We use the standard system of cross-referencing in this book.
Suggestions for further reading
A number of interesting talks on Number Theory can be found in the pro-
ceedings of the International Congresses of Mathematicians in Beijing, 2002,
in Berlin, 1998 and in Zürich, 1994 (see [ICM02], [ICM98], [ICM94]).
A quite complete impression on development of number-theoretic sub-
jects can be obtained from Bourbaki talks : [Des90], [Bert92], [Fon92], [Oe92],
[Clo93], [Se94], [Bo95], [Se95], [Oe95], [Goo96], [Kon96] [Loe96], [Wald96],
[Abb97], [Fal98], [Mich98], [Colm2000], [Breu99], [Ma99], [Edx2000], [Ku2000],
[Car02], [Hen01], [Pey02], [Pey04], [Coa01], [Colm01], [Colm03], [Bi02].
For a more detailed exposition of the theory of algebraic numbers, of Dio-
phantine geometry and of the theory of Transcendental numbers we refer the
reader to the volumes Number Theory II, III, and IV of Encyclopaedia of
Mathematical Sciences see [Koch97], [La91], [FelNes98], the excellent mono-
graph by J.Neukirch [Neuk99] (completed by [NSW2000]). We recommend
also Lecture Notes [CR01] on Arithmetic algebraic geometry from Graduate
Summer School of the IAS/Park City Mathematics Institute.
Acknowledgement
We are very grateful to the Institut Fourier (UJF, Grenoble-1) and to the Max-
Planck-Institut für Mathematik (Bonn) for the permanent excellent working
conditions and atmosphere.
Many thanks to Mrs. Ruth Allewelt, to Dr.Catriona M.Byrne, and to Dr.
Martin Peters (Springer Verlag) for their stimulation of our work and for a
lot of practical help.

Part I
Problems and Tricks

1
Number Theory
1.1 Problems About Primes. Divisibility and Primality
1.1.1 Arithmetical Notation
The usual decimal notation of natural numbers is a special case of notation
to the base m. An integer n is written to the base m if it is represented in the
form
n = dk−1mk−1 + dk−2mk−2 + · · · + d0
where 0 ≤di ≤m −1. The coeﬃcients di are called m-ary digits (or simply
digits). Actually, this name is often applied not to the numbers di but to the
special signs chosen to denote these numbers. If we do not want to specify
these signs we can write the m-ary expansion as above in the form n =
(dk−1dk−2 . . . d1d0)m. The number of digits in such a notation is
k = [logm n] + 1 = [log n/ log m] + 1
where [ ] denotes the integral part. Computers use the binary system; a binary
digit (0 or 1) is called a bit. The high school prescription for the addition of
a k-bit number and an l-bit number requires max(k, l) bit-operations (one
bit-operation here is a Boolean addition and a carry). Similarly, multipli-
cation requires ≤2kl bit-operations (cf. [Knu81], [Kob94]). The number of
bit-operations needed to perform an arithmetical operation furnishes an es-
timate of the computer working time (if it uses an implementation of the
corresponding algorithm). For this reason, fast multiplication schemes were
invented, requiring only O(k log k log log k) bit-operations for the multiplica-
tion of two ≤k-bit numbers, instead of O(k2), cf. [Knu81]. One can also
obtain a lower bound: there exists no algorithm which needs less than sous
certaines restrictions naturelles on peut démontrer qu'il n'existe pas d'algo-
rithme de multiplication des nombres à k chiﬀres avec le temps d'exécution
inférieur à (k log k/(log log k)2) bit-operations for the multiplication of two
general ≤k-bit numbers.

10
1 Elementary Number Theory
Notice that in order to translate the binary expansion of a number n into
the m-ary expansion one needs O(k2) bit-operations where k = log2 n. In
fact, this takes O(k) divisions with remainder, each of which, in turn, requires
O(kl) bit-operations where l = log2 m.
We have brieﬂy discussed some classical examples of algorithms. These
are explicitly and completely described procedures for symbolic manipulation
(cf. [Mar54], [GJ79], [Man80], [Ma99]). In our examples, we started with the
binary expansions of two integers and obtained the binary expansion of their
sum or product, or their m-ary expansions. In general, an algorithm is called
polynomial if the number of bit-operations it performs on data of binary length
L is bounded above by a polynomial in L. The algorithms just mentioned are
all polynomial (cf. [Kob94], [Knu81], [Ma99], [Ries85]).
1.1.2 Primes and composite numbers
The following two assertions are basic facts of number theory: a) every natural
number n > 1 has a unique factorization n = pa1
1 pa2
2 . . . par
r
where p1 <
p2 · · · < pr are primes, ai > 0; b) the set of primes is inﬁnite.
Any algorithm ﬁnding such a factorization also answers a simpler ques-
tion: is a given integer prime or composite? Such primality tests are important
in themselves. The well known Eratosthenes sieve is an ancient (3rd century
B.C.) algorithm listing all primes ≤n. As a by-product, it furnishes the small-
est prime dividing n and is therefore a primality test. As such, however, it is
quite ineﬃcient since it takes ≥n divisions, and this depends exponentially
on the binary length of n. Euclid's proof that the set of primes cannot be
ﬁnite uses an ad absurdum argument: otherwise the product of all the primes
augmented by one would have no prime factorization. A more modern proof
was given by Euler: the product taken over all primes

p

1 −1
p
−1
=

p

1 + 1
p + 1
p2 + . . .

(1.1.1)
would be ﬁnite if their set were ﬁnite. However, the r.h.s. of (1.1.1) reduces to
the divergent harmonic series ∞
n=1 n−1 due to the uniqueness of factorization.
Fibonacci suggested a faster primality test (1202) by noting that the small-
est non-trivial divisor of n is ≤[√n] so that it suﬃces to try only such numbers
(cf. [Wag86], [APR83]).
The next breakthrough in primality testing was connected with Fermat's
little theorem (discovered in the seventeenth century).
Theorem 1.1 (Fermat's Little Theorem). If n is prime then for any in-
teger a relatively prime to n
an−1 ≡1(mod n),
(1.1.2)

1.1 Problems About Primes. Divisibility and Primality
11
(It means that n divides an−1 −1). The condition (1.1.2) (with a ﬁxed a) is
necessary but generally not suﬃcient for n to be prime. If it fails for n, we
can be sure that n is composite, without even knowing a single divisor of it.
We call n pseudoprime w.r.t. a if gcd(a, n) = 1 and (1.1.2) holds. Certain
composite numbers n = 561 = 3 · 11 · 17, 1105 = 5 · 13 · 17, 1729 = 7 · 13 · 19
are pseudoprime w.r.t. all a (relatively prime to n). Such numbers are called
Carmichael numbers (cf. [Kob94], [LeH.80]). Their set is inﬁnite (it was proved
in [AGP94]). For example, a square-free n is a Carmichael number iﬀfor any
prime p dividing n, p −1 divides n −1.
A remarkable property of (1.1.2) is that it admits a fast testing algorithm.
The point is that large powers am mod n can be readily computed by repeated
squaring. More precisely, consider the binary representation of n −1:
m = n −1 = dk−12k−1 + dk−2 + · · · + d0
with dk−1 = 1. Put r1 = a mod n and
ri+1 ≡

r2
i mod n
if dk−1−i = 0
ar2
i mod n
if dk−1−i = 1
Then an−1 ≡rk mod n because
an−1 = (. . . ((a2+dk−2)2adk−3)2 . . . )ad0.
This algorithm is polynomial since it requires only ≤3[log2 n] multiplica-
tions mod n to ﬁnd rk. It is an important ingredient of modern fast primal-
ity tests using the Fermat theorem, its generalizations and (partial) converse
statements.
This idea was used in a recent work of M. Agrawal, N. Kayal and N.
Saxena: a polynomial version of (1.1.2) led to a fast deterministic algorithm
for primality testing (of polynomial time O(log n)12+ε), cf. §2.2.4.
Fermat himself discovered his theorem in connection with his studies of
the numbers Fn = 22n −1. He believed them to be prime although he was able
to check this only for n ≤4. Later Euler discovered the prime factorization
F5 = 4294967297 = 641 · 6700417. No new prime Fermat numbers have been
found, and some mathematicians now conjecture that there are none.
The history of the search for large primes is also connected with the Mer-
senne primes Mp = 2p−1 where p is again a prime. To test their primality one
can use the following Lucas criterion: Mk(k ≥2) is prime iﬀit divides Lk−1
where Ln are deﬁned by recurrence: L1 = 4, Ln+1 = L2
n−2. This requires much
less time than testing the primality of a random number of the same order
of magnitude by a general method. Mersenne's numbers also arise in various
other problems. Euclid discovered that if 2p −1 is prime then 2p−1(2p −1) is
perfect i.e. is equal to the sum of its proper divisors (e.g. 6 = 1+2+3,
28 =
1 + 2 + 4 + 7 + 14,
496 = 1 + 2 + 4 + 5 + 16 + 31 + 62 + 124 + 248), and
Euler proved that all even perfect numbers are of this type. It is not known

12
1 Elementary Number Theory
whether there are any odd perfect numbers, and this is one baﬄing example of
a seemingly reasonable question that has not lead to any number-theoretical
insights, ideas or tricks worth mentioning here.
Euler also knew the ﬁrst eight prime Mersenne numbers (corresponding to
p = 2, 3, 5, 7, 13, 19, 31. Recently computer-assisted primality tests have
furnished many new Mersenne primes, e.g. the 42nd known Mersenne prime,
discovered by Dr. Martin Nowak on February 26 (2005), is 225,964,951−1. It has
7,816,230 decimal digits. It is therefore not only the largest known Mersenne
prime, but also the largest known prime of any kind.∗)
In Chapter 4 we consider some other modern methods of primality testing,
in particular using elliptic curves (ECPP by Atkin-Morain).
1.1.3 The Factorization Theorem and the Euclidean Algorithm
For integers a, b we write a|b if a divides b i.e., b = ad for some integer d. If
p is a prime and pα is the highest power of p dividing n we write pα∥n and
α = ordpn. The factorization theorem can be easily deduced from its special
case: if a prime p divides ab then either p|a or p|b. Below we shall prove this
property using the Euclidean algorithm. Knowing the prime factorizations of
a and b one readily sees the existence and the explicit form of the greatest
common divisor gcd(a, b) and the least common multiple lcm(a, b). Namely,
put mp = min(ordp(a), ordp(b)), gp = max(ordp(a), ordp(b)). Then
gcd(a, b) =

p
pmp,
lcm(a, b) =

p
pgp.
Again, the Euclidean algorithm allows us to prove the existence and to ﬁnd
eﬃciently gcd(a, b) without even knowing the prime factorizations. Assume
that a ≥b ≥1. The algorithm consists of calculating a sequence x0, x1, x2, . . .
where x0 = a, x1 = b and xi+1 is the residue of xi−1 modulo xi. One stops
when xk = 0; then xk−1 = gcd(a, b). The number of required divisions is
bounded by 5 log10 max(a, b) (Lamé's theorem) (cf. [Knu81], [Wun85]). The
slowest instances for the Euclidean algorithm are the neighbouring Fibonacci
numbers a = uk, b = uk−1 where u0 = u1 = 1 and ui+1 = ui + ui−1. The
Euclidean algorithm also furnishes a representation
gcd(a, b) = Aa + Bb
(1.1.3)
where A, B are integers. In order to ﬁnd these, we shall consecutively deﬁne
pairs (Ai, Bi) such that xi = Aix0 + Bix1. Put A0 = B1 = 1, A1 = B0 = 0
and for i ≥1
∗See http://www.mersenne.org and http://mathworld.wolfram.com/news/ for
updates and for the history, e.g. two previous values are 20996011 and 24036583.
Another recent record is the factorization of M953 (Bahr F., Franke J. and Klein-
jung T. (2002) (footnotes by Yu.Tschinkel and H.Cohen).

1.1 Problems About Primes. Divisibility and Primality
13
Ai+1 = Ai−1 −tAi,
Bi+1 = Bi−1 −tBi
where t is given by xi+1 = xi−1 −txi. Since gcd(a, b) = xk−1 we can take A =
Ak−1, B = Bk−1. Finally, if p|ab for a prime p and p does not divide a then
gcd(a, p)=1 so that Aa+Bp = 1 for some integers A, B. Hence Aab+Bpb = b
and p divides b.
1.1.4 Calculations with Residue Classes
From the algebraic viewpoint, the set of integers Z is an associative commu-
tative ring with identity. The general divisibility theory in such rings uses the
fundamental notion of an ideal. An ideal I in a ring R is a subset which is an
additive subgroup with the property RIR ⊂I.
An ideal of the form I = aR, a ∈A is called a principal ideal and is
denoted (a). The divisibility relation a|b is equivalent to the inclusion relation
(b) ⊂(a)
or
b ∈(a).
Any ideal I of Z must be principal since its elements are all divisible by the
smallest positive element of I. The maximal ideals (ordered by inclusion) are
precisely those which are generated by primes. The numbers having the same
remainder after division by a ﬁxed N, form N classes with pairwise empty
intersections
¯a = a + NZ,
0 ≤a ≤N −1,
the set of which also has a natural commutative associative ring structure
with identity
Z/NZ = Z/(N) = {¯0, ¯1, . . . , N −1}.
We traditionally write a ≡b ( mod N) in place of ¯a = ¯b. Often one succeeds in
reducing some calculations in Z to calculations in an appropriate residue ring
Z/NZ. Besides ﬁniteness, one useful property of this ring is the abundance of
invertible elements (while in Z there are only ±1). Actually, ¯a is invertible iﬀ
gcd(a, N) = 1 since the equation ax+Ny = 1 or, equivalently, ¯a.¯x = ¯1 can be
solved exactly in this case with integers x, y. The group of all invertible residue
classes is denoted (Z/NZ)×. Its order ϕ(N) is called Euler's function. Euler
introduced it in connection with his generalization of the Fermat theorem:
aϕ(N) ≡1(mod N)
(1.1.4)
for any a relatively prime to N, i.e. ¯aϕ(N) = ¯1 for any invertible element
¯a in Z/NZ. Euler's conceptual proof shows in fact that in a ﬁnite Abelian
group of order f the order of an arbitrary element a divides f. In fact, the
multiplication by a is a permutation of the set of all elements. The product
of all elements is multiplied by af under this map. Hence af = 1.
If N = N1N2 . . . Nk and Ni are pairwise coprime we have a canonical
isomorphism

14
1 Elementary Number Theory
Z/NZ ∼= Z/N1Z ⊕· · · ⊕Z/NkZ.
(1.1.5)
The main part of this statement is called the Chinese Remainder Theorem : for
any ai mod Ni,
i = 1, . . . , k there exists an a such that a ≡ai mod Ni for
all i. Again, such an a can be eﬃciently found using the Euclidean algorithm.
Put Mi = N/Ni. By assumption, Mi and Ni are relatively prime. Find Xi
with XiMi ≡1 mod Ni and put
a =
k

i=1
aiXiMi.
(1.1.6)
This is what we sought. From (1.1.5) we deduce the corresponding factoriza-
tion of the multiplicative group
(Z/NZ)× ∼= (Z/N1Z)× ⊕· · · ⊕(Z/NkZ)×,
(1.1.7)
which shows in particular that ϕ(N) = ϕ(N1) . . . ϕ(Nk). Since for a prime
p we have ϕ(pa) = pa−1(p −1) this allows us to ﬁnd ϕ(N) given the prime
factorization of N.
In the special case when N = q is prime the ring Z/NZ is a ﬁeld: all its
non-zero elements are invertible. For a prime p, the notation Fp is used for
the ﬁeld Z/pZ. The group (Z/NZ)× is cyclic: it coincides with the set of all
powers of an element t = tq (it is not unique). No eﬃcient (e.g. polynomial)
algorithm for ﬁnding such a primitive root is known.
Recall Artin's conjecture (on primitive roots): If a ∈Z is not −1 or a perfect
square, then the number N(x, a) of primes p ≤x such that a is a primitive root
modulo p is asymptotic to C(a)π(x), where C(a) is a constant that depends
only on a. In particular, there are inﬁnitely many primes p such that a is a
primitive root modulo p. (Note that another famous Artin's conjecture (on
the holomorphy of L series) will be discussed in §6.4.5). Nobody has proved
this conjecture (on primitive roots) for even a single choice of a. There are
partial results, e.g., that there are inﬁnitely many p such that the order of a
is divisible by the largest prime factor of p−1. (See, e.g., [Mor93] and [HB86],
[BrGo02]). Neither can one eﬃciently compute the "discrete logarithm", (or
index)
x = indt(a) deﬁned for an invertible a mod q by
a ≡tx mod q,
0 ≤x ≤q −1.
(1.1.8)
It is an important unanswered question whether such algorithms exist at all.
However, there are fast ways for calculating indt if all prime divisors of q −1
are small (cf. [Kob94]). First of all, one computes for all p dividing q −1 the
residue classes
rp,j = tj(q−1)/p,
j = 0, 1, . . . , p −1
lying in (Z/qZ)×. This can be eﬃciently done by the iterated squaring method
(cf. 1.1.2). Let αp = ordp(q −1). It suﬃces to compute all the residues x mod

1.1 Problems About Primes. Divisibility and Primality
15
pαp and then to apply the Chinese Remainder Theorem (1.1.5). We ﬁx p,
α = αp > 0 and try to to ﬁnd x mod pα in the form
x ≡x0 + x1p + · · · + xα−1pα−1(mod pα),
0 ≤xi ≤p −1.
Since aq−1 ≡1 mod q the residue a(q−1)/p is a pth root of unity. From a ≡
tx mod q it follows that
a(q−1)/p ≡tx(q−1)/p ≡tx0(q−1)/p ≡rp,x0(mod q).
Therefore we can ﬁnd the ﬁrst digit x0 by computing a(q−1)/p and comparing
it with the precomputed list of rp,j. In order to ﬁnd the next digit x1 we ﬁrst
replace a by a1 = a/tx0. Then we have
indt(a1) = indt(a) −x0 ≡x1p + · · · + xαpα−1(mod pα).
As a1 is a pth power we obtain from here a(q−1)/p
1
≡1 mod q and
a(q−1)/p2
1
≡t(x−x0)(q−1)/p2 ≡t(x1+px2+... )(q−1)/p ≡tx1(q−1)/p ≡rp,x1.
Therefore, one can discover x1 by ﬁnding a(q−1)/p2
1
among the precomputed
list of rp,j. One computes the other digits xi in the same way. The same list
can be used for various a's, q and t being ﬁxed. This is the Silver-Pollig-
Hellman algorithm, cf. [Kob94]. It becomes impractical if q −1 is divisible by
a large prime because then the table of rp,j becomes too long. The diﬃculty
of computing ind (and the general factorization problem) is utilized in cryp-
tography (cf. Chapter 2, §2.1.6, [DH76], [Hel79], [ARS78] , [Odl84] , [Odl87],
[Go02]).
1.1.5 The Quadratic Reciprocity Law and Its Use
Let p and q be odd primes. The main part of the quadratic reciprocity law ﬁrst
proved by Gauss, states that if p ≡q ≡3 mod 4 then the solvability of one
of the congruences x2 ≡p mod q and x2 ≡q mod p implies the insolvability
of the other; in all other cases they are simultaneously solvable or unsolvable.
Gauss used this in order to compile large tables of primes.
To this end, he reﬁned the primality test based on Fermat's congruence
(1.1.2). Namely, deﬁne the Legendre symbol
 a
n

for a prime n by
 a
n

=
⎧
⎪
⎨
⎪
⎩
0
if a ≡0 mod n,
1
if a ≡b2 mod n,
−1
otherwise.
Then from the cyclicity of (Z/nZ)× it follows that

16
1 Elementary Number Theory
a(n−1)/2 ≡
 a
n

(mod n).
(1.1.9)
If n is not prime we deﬁne the Jacobi symbol by multiplicativity: for an odd
positive n = p1p2 . . . pk where pi are primes, not necessarily distinct, put
 a
n

=
a
p 1

. . .
a
p k

(1.1.10)
Now formula (1.1.9), which holds for the Jacobi symbol when n is prime,
can be used as a primality test. Actually, the Jacobi symbol can be extended
to all values of the "numerator" and "denominator" and computed without
knowing the prime factorization of n. This is done with the help of the extended
quadratic reciprocity law
Q
P
 P
Q

= (−1)
(P −1)
2
(Q−1)
2
(1.1.11)
(for odd positive P Q) and two complements to this law:
 2
P

= (−1)(P 2−1)/8
−1
P

= (−1)(P −1)/2
(1.1.12)
together with the multiplicativity property with respect to both "numera-
tor" and "denominator". The computation follows the same pattern as the
Euclidean algorithm and requires ≤log max(P, Q) divisions with remainder.
A natural number n is called an Eulerian pseudoprime w.r.t. a if gcd(a, n) = 1
and (1.1.9) holds. Using the chinese remainder theorem, one can prove that
if n is pseudoprime w.r.t. all a ∈(Z/nZ)× then n is prime. Thus, there are
no Eulerian analogues of the Carmichael numbers. Moreover, it was argued in
[Wag86] that if n is composite then there is an a ≤2 log n log log n such that
n is not an Eulerian pseudoprime w.r.t. a.
The congruence (1.1.9) is used in the modern fast primality tests which
will be considered in Chapter 2 (cf. [ARS78], [Mil76], [LeH.80], [Vas88]).
The primality tests work much faster than all known methods for factor-
izing "random" large integers, see §2.3.
To conclude this subsection we say a few words about a subject which
has traditionally caught the attention of many unselﬁsh amateurs of number
theory: that of ﬁnding "a formula" for primes. Euler noticed that the polyno-
mial x2 + x + 41 takes many prime values. However, it was long known that
the values of an arbitrary polynomial f(x1, . . . , xn) ∈Z[x1, . . . , xn] at integer
points cannot all be prime, e.g. because if p, q are two large primes, then
the congruence f(x1, . . . , xn) ≡0 mod pq is always solvable. Nevertheless,
using methods from the theory of recursive functions, one can construct a
polynomial (in fact, many) whose set of positive values taken at lattice points
coincides with the set of all primes. The following specimen was suggested in
[JSWW76]. It depends on 26 variables that can be conveniently denoted by
the letters of the English alphabet:

1.1 Problems About Primes. Divisibility and Primality
17
F(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z) =
(k + 2)

1 −[wz + h + j −q]2 −[(gk + 2g + k + 1)(h + j) + h −z]2−
[2n + p + q + z −e]2 −[16(k + 1)3(k + 2)(n + 1)2 + 1 −f 2]2−
[e3(e + 2)(a + 1)2 + 1 −o2]2 −[(a2 −1)y2 + 1 −x2]2−
[16r2y4(a2 −1) + 1 −u2]2−
[((a + u2(u2 −a))2 −1)(n + 4dy)2 + 1 −(x + cu)2]2−
(n + l + v −y)2 −[(a2 −1)l2 + 1 −m2]2 −(ai + k + 1 −l −i)2−
[p + l(a −n −1) + b(2an + 2a −n2 −2n −2) −m]2−
[q + y(a −p −1) + s(2ap + 2a −p2 −2p −2) −x]2−
[z + pl(a −p) + t(2ap −p2 −1) −pm]2
.
We also mention an inductive description of the sequence of all primes that
can be derived by combinatorial reasoning (cf. [Gan71]):
pn+1 = [1 −log2 αn]
(1.1.13)
where
αn =
n

r=1

1≤i1<···<ir≤n
(−1)r
2pi1...pir −1.
1.1.6 The Distribution of Primes
A ﬁrst glance at a table of primes leaves an impression of chaos. For several
centuries, mathematicians compiled large tables of primes in an attempt to
see some order in them. Pell's table (1668) lists all primes not exceeding 105.
Lehmer D.H. in [Leh56] published his well known tables containing all primes
up to 107. In [PSW80] one can ﬁnd all Fermat pseudoprimes n < 25 · 109
verifying the congruence 2n−1 ≡1 mod n.
Already the ﬁrst tables allowed the experimental study of the statistical
distribution of primes, which seemed to be more accessible at least asymptot-
ically. Put
π(x) = Card{p | p prime ≤x}.
The graph of this step function even up to x = 100 looks pretty regular. For
x ≤50000 where the jumps are hidden by the scale, the regularity is striking
(cf. Fig. 1.1 and 1.2).
Computing x/π(x) we see that for large x it becomes close to log x. One
sees also from Table 1.1 that that when we multiply x by 10, then
10x
π(10x) ≈
x
π(x) + log 10, and log(10x) = log(x) + log 10 ≈log(x) + 2, 3.

18
1 Elementary Number Theory
Fig. 1.1.
Fig. 1.2.
Table 1.1. For large x the ratio x/π(x) becomes close to log x:
10
4
2,5
100
25
4,0
1 000
168
6,0
10 000
1 229
8,1
100 000
9 592
10,4
1 000 000
78 498
12,7
10 000 000
664 579
15,0
100 000 000
5 761 455
17,4
1 000 000 000
50 847 534
19,7
10 000 000 000
455 052 512
22,0
Actually, the asymptotic law of the distribution of primes (or prime number
theorem),
π(x) ∼
x
log x
(1.1.14)
(meaning that the quotient of the two sides tends to 1 as x tends to inﬁnity)
was conjectured by the ﬁfteen year old Gauss on the basis of his studies of the
available tables of primes, and proved by analytical methods only in 1896 by
Hadamard and de la Vallée-Poussin [Pra57], [Kar75]). Before that, in 1850,
P.L.Chebyshev (cf. [Cheby55]) found a very ingenious elementary proof of the
inequality

1.1 Problems About Primes. Divisibility and Primality
19
0, 89
x
log x < π(x) < 1, 11
x
log x.
For this he used only the divisibility properties of the binomial coeﬃcients.
The asymptotic law itself was ﬁnally proved in an elementary way in 1949 by
Selberg and Erdös (cf. [Sel51]).
Gauss also suggested a much better approximation to π(x). Computing
his tables of primes he noticed that if one counts primes in suﬃciently large
intervals around a large x their density tends to be close to 1/ log x. For this
reason he decided that a better approximation to π(x) would be the integral
logarithm
Li(x) =
 x
2
dt
log t.
This observation was reﬁned by Riemann, cf. [Rie1858]. Investigating the zeta-
function he came to an heuristic conclusion that Li(x) should be a very good
approximation to the function counting all powers of primes ≤x with the
weight equal to the power, that is
π(x) + 1
2π(√x) + 1
3π( 3√x) + · · · ≈Li(x).
(1.1.15)
If one wants to express π(x) via Li(x) from here one should use the Möbius
function
µ(n) =
⎧
⎪
⎨
⎪
⎩
1
if n = 1,
0
n is divisible by a square of a prime,
(−1)k
otherwise,
(1.1.16)
where k is the number of primes dividing n. Let us consider the function
F(x) =
∞

n=1
1
nπ(x1/n).
(1.1.17)
Then
π(x) =
∞

n=1
µ(n)
n
F(x1/n),
(1.1.18)
and
π(x) ≈
∞

n=1
µ(n)
n
Li(x1/n).
(1.1.19)
The special case (1.1.18) of a general inversion formula easily follows from the
main property of the Möbius function:

d|n
µ(d) =

1,
if n = 1
0,
if n > 1.
(1.1.20)

20
1 Elementary Number Theory
In fact, if n = s
i=1 pαi
i ,
αi > 0 then for s ≥1 we have

d|n
µ(n) =
s

k=0
(−1)s
s
k

= (1 −1)s = 0.
The right hand side of (1.1.19) is denoted R(x). Table 1.2 (cf. [Ries85], [RG70],
[Zag77]) shows how well it approximates π(x).
Table 1.2.
x
R(x)
π(x)
100000000
5761455
5761552
200000000
11078937
11079090
300000000
16252325
16252355
400000000
21336326
21336185
500000000
26355867
26355517
600000000
31324703
31324622
700000000
36252931
36252719
800000000
41146179
41146248
900000000
46009215
46009949
1000000000
50847534
50847455
It is useful to slightly renormalize Li(x) taking instead the complex integral
li(eu+iv) =
 u+iv
−∞+iv
ez
z dz
(v ̸= 0).
(1.1.21)
For x > 2, li(x) diﬀers from Li(x) by the constant li(2) ≈1, 045. The Riemann
function
R(x) =
∞

n=1
µ(n)
n
li(x1/n)
is an entire function of log x. It can be expanded into a rapidly convergent
power series
R(x) = 1 +
∞

m=1
tm
m!mζ(m + 1),
(1.1.22)
where x = et, and
ζ(s) =
∞

n=1
n−s =

p prime
(1 −p−s)−1.
(1.1.23)
Of course, this Riemann zeta function is the main hero of the story. Its proper-
ties, established or conjectural, govern the behaviour of π(x). Riemann showed

1.1 Problems About Primes. Divisibility and Primality
21
how to extend ζ(s) meromorphically to the whole complex plane (notice that
(1.1.23) converges only for Re(s) > 1) and he deduced the astonishing explicit
formula for π(x). This looks as follows:
F0(x) = li(x) −

ρ
li(xρ) +
 ∞
0
du
(u2 −1)u log u
−log 2,
(1.1.24)
where the sum is taken over all zeros ρ of ζ(s), and
F0(x) = lim
ε→0
F(x + ε) + F(x −ε)
2
.
The formula ( 1.1.24) was published by Riemann in 1859 and proved by Man-
goldt in 1895. The series in (1.1.24) is only conditionally convergent. If one
excludes the "trivial zeroes" ρ = −2, −4, −6, . . . whose contribution is insignif-
icant the remaining summation should be made in the order of increasing |ρ|.
The set of non-trivial zeros is symmetric with respect to complex conjugation
and lies in the critical strip 0 ≤Re(s) ≤1. The ﬁrst ﬁve roots with positive
imaginary part, up to eight decimal digits, are (cf. [Zag77], [Ries85], [RG70] )
ρ1 = 1
2 + 14, 134735i,
ρ2 = 1
2 + 21, 022040i,
ρ3 = 1
2 + 25, 010856i,
ρ4 = 1
2 + 30, 424878i,
ρ5 = 1
2 + 32, 935057i.
Let us consider the number θ = sup Re(ρ). From (1.1.24) it follows that
π(x) −li(x) = O(xθ log x).
(1.1.25)
This estimate would be non-trivial if we knew that θ < 1. Unfortunately, it is
only known that there are no roots on Re(s) = 1 and in a small neighbourhood
of this line whose width tends to zero as |s| grows (cf. [Pra57]). The famous
Riemann hypothesis, that all non-trivial roots lie on the line Re(s) = 1
2, is
still unproved. A corollary of this would be
π(x) = li(x) + O(x1/2 log x).
These questions, however, lie far outside elementary number theory.
We shall return to the Riemann-Mangoldt type explicit formulae below,
cf. Part II, Chapter 6, §6.2.

1.2 Diophantine Equations of Degree One and Two
1.2.1 The Equation ax + by = c
In this section, all coeﬃcients and indeterminates in various equations are
assumed to be integers unless otherwise stated. Consider ﬁrst a linear equation
with two indeterminates. The set
I(a, b) = {c
|
ax + by = c
is solvable}
coincides with the ideal generated by a and b that is, with dZ where d =
gcd(a, b). It follows that the equation
ax + by = c
(1.2.1)
is solvable iﬀd divides c. A special solution can be found with the help of
the Euclidean algorithm: ﬁrst compute X, Y with aX + bY = d and then put
x0 = eX, y0 = eY where e = c/d. One easily sees that the general solution is
given by the formula
x = x0 + (b/d)t,
y = y0 −(a/d)t,
where t is an arbitrary integer.
Equation (1.2.1) is the simplest example of the general Diophantine prob-
lem of investigating systems of polynomial equations
F1(x1, . . . , xn) = 0,
· · · ,
Fm(x1, . . . , xn) = 0
(1.2.2)
with integral coeﬃcients. We see that all the main questions can be eﬀectively
answered for (1.2.1): the existence of solutions, computation a single solution,
description of the set of all solutions, counting solutions in a box etc. We shall
consider more complicated instances of (1.2.2) and attempt to extend these
results.
1.2.2 Linear Diophantine Systems
The Euclidean algorithm allows us to investigate in the same way a general
linear Diophantine system
Ax = b,
(1.2.3)
where
A =
⎛
⎜
⎝
a11 a12 · · · a1n
· · ·
· · · ... · · ·
am1 am2 · · · amn
⎞
⎟
⎠∈Mm,n(Z), x =
⎛
⎝
x1
· · ·
xn
⎞
⎠, b =
⎛
⎝
b1
· · ·
bm
⎞
⎠.

1.2 Diophantine Equations of Degree One and Two
23
This can be done with the help of the elementary divisor theorem. Recall
that an elementary operation on the rows of a matrix over Z adds to one row
an integral multiple of another. One deﬁnes an elementary column operation
similarly. An elementary operation is equivalent to multiplication of the initial
matrix on the left (resp. on the right) by a matrix of the form Eij = E + λeij
belonging to SLm(Z) (resp. SLn(Z)). By repeated application of elementary
operations we replace A by UAV where U and V are unimodular matrices
with integral entries. On the other hand, the system
UAV y = Ub
(1.2.4)
is equivalent to (1.2.3) since their solutions are in one-to-one correspondence:
x = V y. We can use this if we manage to replace A by a simpler matrix A′ =
UAV . In fact, using the Euclidean algorithm and a version of the Gaussian
elimination procedure avoiding divisions, one can ﬁnd a matrix A′ of the form
D =
⎛
⎜
⎜
⎜
⎜
⎜
⎝
d1
0
0 . . .
0
0
d2
0 . . .
0
· · · · · · ... . . .
0
0
0 . . . dr . . .
· · · · · · · · · · · · . . .
⎞
⎟
⎟
⎟
⎟
⎟
⎠
= UAV.
(1.2.5)
Hence we either see that our system has no solutions even in Q, or we obtain
the set of all rational solutions from the very simple system diyi = ci,
c = Ub
for i ≤r, yi = 0 for the other i. The set of integral solutions is non-empty
iﬀdi divides ci for i ≤r, and can then be parametrized in an obvious way.
The product d1 · · · · · di coincides with gcds of all minors of A of order i and
di|di+1. They are called the elementary divisors of A. It follows that (1.2.3)
is solvable iﬀthe elementary divisors of A of orders ≤m coincide with those
of the extended matrix (with the column b added). In turn, this is equivalent
to the simultaneous solvability of the congruences
Ax ≡b(mod N)
where N is an arbitrary integer. Such a condition can be readily extended to
a completely general system of Diophantine equations. Clearly, it is necessary
for the existence of a solution. The above argument shows that for (1.2.3) it
is also suﬃcient. When this is true for a class of equations one says that the
Minkowski-Hasse principle is valid for this class. The question of the validity
of the Minkowski-Hasse principle is a central problem in this theory. We shall
discuss it below in §1.2.4 and in Part II, §4.5, §5.3.
More diﬃcult problems arise if one wants to ﬁnd "the smallest solution"
to (1.2.3) with respect to some norm. These questions are considered in the
geometry of numbers. Siegel (cf. [Sie29], [Fel82]) has shown that the system
of linear equations
ai1x1 + · · · + ainxn = 0
(i = 1, . . . , m)

24
1 Elementary Number Theory
with n > m in which the integers aij are bounded by B has a non-
trivial integral solution with coordinates bounded by 1 + (nB)m/(n−m). If
the rows of A = (aij) are linearly independent and d denotes the gcd of
the minors of order m of A, one can obtain the more precise upper bound
(d−1
det(AtA))1/(n−m). This estimate and its generalization to algebraic
number ﬁelds was proved by Bombieri and Vaaler (cf. [BV83]) using fairly
subtle results from geometric number theory (Minkowski's theory of the suc-
cessive minima of quadratic forms [Cas59a]).
For applications, it is essential to develop eﬃcient methods for ﬁnding
solutions of a linear Diophantine system with non-negative coordinates. This
is the central problem of integral linear programming. It belongs to the class of
intractable problems i.e. those for which polynomial algorithms are not known.
The intractability of the knapsack problem has been used in cryptography (see
Ch.2). It consists of ﬁnding a solution of the equation a1x1 + · · · + anxn = b
with xi ∈{0, 1} where ai, b are given integers (see [Kob94], [LeH.84]).
1.2.3 Equations of Degree Two
Consider the following Diophantine equation with integral coeﬃcients
f(x1, x2, . . . , xn) =
n

i,j
aijxixj +
n

i=1
bixi + c = 0.
(1.2.6)
Here we shall begin by ﬁnding the set of all rational solutions, which is easier
than ﬁnding the integral solutions but far from trivial.
A classical example is furnished by the rational parametrization of the
circle x2 + y2 = 1 :
x =
2t
1 + t2 y = 1 −t2
1 + t2
(x = cos ϕ, y = sin ϕ, t = tan
ϕ
2

).
(1.2.7)
This parametrization allows us in turn to describe all primitive Pythagorean
triples (X, Y, Z), that is, natural solutions of X2+Y 2 = Z2 with gcd( X, Y, Z )
= 1. The answer is: X = 2uv, Y = u2 −v2, Z = u2 +v2, where u > v > 0 are
relatively prime integers. To prove this it suﬃces to put t = u/v in (1.2.7).
Similarly, ﬁnding rational solutions to (1.2.6) is equivalent to ﬁnding inte-
gral solutions to the homogeneous equation
F(X0, X1, · · · , Xn) =
n

i,j=0
fijXiXj
=
n

i,j=1
fijXiXj + 2
n

i,j=1
fi0XiX0 + f00X2
0
(1.2.8)
where fij = fji = aij/2 for 1 ≤i < j ≤n and f0i = fi0 = bi/2 for i =
1, 2, . . . , n, f00 = c. The non-homogeneous coordinates x1, . . . , xn are related

1.2 Diophantine Equations of Degree One and Two
25
to the homogeneous coordinates X0, . . . , Xn by Xi = xiX0
(i = 1, 2, . . . , n).
The quadratic form F(X) can be conveniently written as
F(X) = XtAF X,
Xt = (X0, X1, . . . , Xn),
where AF = (fij) is the matrix of coeﬃcients. If there exists a non-trivial
integral solution to F(X) = 0 we say that F represents zero over Z. This
equation deﬁnes a quadric QF . Its points are all complex solutions (except
the trivial one) considered as points in the complex projective space CPn:
QF = {(z0 : z1 : · · · : zn) ∈CPn
|
F(z0, z1, . . . , zn) = 0}.
Any non-trivial rational solution of F(X) = 0 gives a point on this quadric.
If we know one solution X0 then we can ﬁnd all the others by considering
intersections of QF with the (projective) lines deﬁned over Q and containing
X0. Algebraically, a line passing through X0 and Y 0 consists of all points
uX0 + vY 0. The equation F(uX0 + vY 0) = 0 reduces to
uv
n

i=1
∂F
∂Xi
(X0)Y 0
i + v2F(Y 0) = 0.
In general, not all the partial derivatives
∂F
∂Xi vanish at X0. If this is the case,
then for any Y 0 we can ﬁnd an intersection point of QF with our line:
v = −u
n

i=1
∂F
∂Xi
(X0)Y 0
i /F(Y 0).
(1.2.9)
(If by chance F(Y 0) = 0 then Y 0 is already on QF ). Again, this point will in
general be unique. Limiting cases can be well understood in geometric terms:
if all partial derivatives vanish at X0 then our quadric is a cone with vertex
X0, and the problem is reduced to that of ﬁnding rational points on the base
of the cone, this base being a quadric of lower dimension; if a line happens
to lie entirely on QF then all its rational points should be taken into account
etc.
This stereographic projection method, applied to x2 +y2 = 1 and the point
(0,-1) gives precisely (1.2.7) if one denotes by t a coeﬃcient of the equation
of the line passing through (0,-1) and (x, y) :
y + 1 = tx.
Considering the equation
F(X0, X1, . . . , Xn) = 0
(1.2.10)
(with F as in (1.2.8)) over the rationals, we could alternatively begin by
diagonalizing F by a non-degenerate linear substitution X = CY where C ∈
Mn+1(Q). The matrix C can be found eﬀectively by Lagrange's method of
successively completing the squares. The previous geometric analysis then
becomes quite transparent.

26
1 Elementary Number Theory
Fig. 1.3.
For homogeneous equations such as (1.2.10) the problems of ﬁnding solu-
tions in Q and in Z are essentially equivalent. Since we can ﬁnd all solutions
starting from one of them, the key question is that of deciding whether there
is one. An answer is given by the following result.
1.2.4 The Minkowski-Hasse Principle for Quadratic Forms
Theorem 1.2. A quadratic form F(x1, x2, . . . , xn) of rank n with integral
coeﬃcients represents zero over the rationals iﬀfor any N, the congruence
F(x1, . . . , xn) ≡0 (mod N) has a primitive solution and in addition F rep-
resents zero over the reals, i.e. it is indeﬁnite.
For a general proof see [BS85], [Cas78]. Of course, the necessity of this
condition is obvious.
We reproduce here the beautiful proof of suﬃciency in the case n = 3 due
to Legendre ( [BS85], [Ire82]). Let
F = a1x2
1 + a2x2
2 + a3x2
3
(a1a2a3 ̸= 0).
Since F is indeﬁnite we may assume that the ﬁrst two coeﬃcients are
positive while the third one is negative. Furthermore, we can and will assume
that they are square-free and relatively prime: this may be achieved by obvious
changes of variables and by dividing the form by the gcd of its coeﬃcients.
Denote the form with such properties by
ax2 + by2 −cz2.
(1.2.11)
Consider a prime p dividing c. Since F ≡0(mod p) has a primitive solution,
we can ﬁnd a non-trivial solution (x0, y0) to the congruence ax2 + by2 ≡
0(mod p). Therefore

1.2 Diophantine Equations of Degree One and Two
27
ax2 + by2 ≡ay−2
0 (xy0 + yx0)(xy0 −yx0) (mod p).
For p = 2 we clearly have
ax2 + by2 −cz2 ≡(ax + by −cz)2 (mod 2).
Hence for all p|2abc we can ﬁnd linear forms L(p), M (p) of x, y, z with integral
coeﬃcients such that F ≡L(p)M (p)(mod p). Using the Chinese Remainder
Theorem, we ﬁnd L (resp. M) with integral coeﬃcients congruent to those of
L(p) (resp. M (p)) (mod p) for all p|abc. We then have
ax2 + by2 + cz2 ≡L(x, y, z)M(x, y, z) (mod abc).
(1.2.12)
Consider now the integral points in the box
0 ≤x <
√
bc,
0 ≤y < √ac,
0 ≤z <
√
ab.
(1.2.13)
If we exclude the trivial case a = b = c = 1, not all square roots are integers
so that the total number of points will exceed the volume of this box which
is abc. Hence there are two diﬀerent points where L takes the same value
mod abc. Taking their diﬀerence, we ﬁnd
L(x0, y0, z0) ≡0 (mod abc)
(1.2.14)
for some |x0| ≤
√
bc,
|y0| ≤√ac,
|z0| ≤
√
ab. Hence
ax2
0 + by2
0 −cz2
0 ≡0 (mod abc)
(1.2.15)
and
−abc < ax2
0 + by2
0 −cz2
0 < 2abc.
It follows that either
ax2
0 + by2
0 −cz2
0 = 0
(1.2.16)
or
ax2
0 + by2
0 −cz2
0 = abc.
(1.2.17)
In the ﬁrst case the theorem is proved. In the second case we obtain the
following non-trivial solution
a(x0z0 + by0)2 + b(y0z0 −ax0)2 −c(z2
0 + ab)2 = 0.
Legendre's original statement is that ax2 + by2 −cz2 = 0 is solvable iﬀall the
residue classes bc (mod a),
ac (mod b),
−ab (mod c) are squares.
One can prove that an indeﬁnite quadratic form of rank ≥5 always repre-
sents zero over the rationals. For smaller rank, the Minkowski-Hasse principle
can be combined with an a priori minimization of the moduli to be tested
to give an eﬀective way of establishing the existence of a solution. Below we
shall reformulate this approach using the more convenient language of p-adic
numbers (cf. Part II Chap. 4 §4.2.5, 4.3.1, Chap. 5 §5.3.6).

28
1 Elementary Number Theory
1.2.5 Pell's Equation
For non-homogeneous problems, the diﬀerence between rational and integral
solutions becomes essential. For example, consider Pell's equation
x2 −dy2 = 1,
(1.2.18)
where d is a positive integer (and not a square). Since we know one trivial
rational solution (1, 0) the others can be easily found by the method described
above. However, to obtain only integral solutions we must act in a totally
diﬀerent way.
First of all, assume that the set of non-trivial integral solutions is non-
empty (in fact, this can be proved by various methods). It is suﬃcient to
consider only solutions with positive coordinates. We shall call such a solution
(x1, y1) minimal if the linear form x+
√
dy takes its minimal value on it. This
solution is unique since
√
d is irrational. The central result of the theory of
Pell's equation states that all solutions are of the form (±xn, ±yn) where
xn +
√
dyn = (x1 +
√
dy1)n, n being an arbitrary non-negative integer.
The most natural proof, which admits a far-reaching generalization, is
based on studying the quadratic ﬁeld K = Q(
√
d) = {a+b
√
d | a, b ∈Q}. The
set A = Z + Z
√
d is a subring in K. The norm of α = a + b
√
d is by deﬁnition
N(α) = NK/Q(α) = a2 −db2.
Clearly,
N(αβ) = N(α)N(β)
(1.2.19)
for all α, β ∈K. Solutions of Pell's equation are numbers in α with norm 1.
From (1.2.19) it follows that they form a group (with multiplication as the
group law), in which the positive elements form the cyclic subgroup generated
by x1 + y1
√
d.
In classical papers several methods were suggested for ﬁnding the minimal
solution, or at least some solution. One of these algorithms is based on approx-
imation theory (cf. §4 below). Dirichlet in 1837 published explicit formulae
giving some solutions of Pell's equation expressed through trigonometric func-
tions. For example, for d = 13 his general formulae show that x1+y1
√
13 = η2
where
η = sin 2π
13 sin 5π
13 sin 6π
13
sin π
13 sin 3π
13 sin 4π
13
∈Q(
√
13)
(cf. [Dir68], [BS85], [Maz83] ). In 1863 Kronecker published an expression for
x1+y1
√
d via special values of elliptic functions (cf. [Kr1863], [Sie65], [Wei76]).
Finally, it is worth mentioning that a general quadratic Diophantine equa-
tion in two variables over the integers may be reduced by linear substitutions
to a Pell-like equation if one solution is known.
A solution of Pell's equation using continued fractions is described in
§1.4.5.

1.2 Diophantine Equations of Degree One and Two
29
1.2.6 Representation of Integers and Quadratic Forms by
Quadratic Forms
Consider two quadratic forms with integral coeﬃcients
f(x) = f(x1, . . . , xn) =
n

i,j=1
aijxixj = A[x] = xtAx,
g(y) = g(y1, . . . , ym) =
m

i,j=1
bijyiyj = B[y] = ytBy,
where A and B are symmetric matrices. We shall say that f represents g over
Z if for some C ∈Mn,m(Z) we have
f(Cy) = g(y),
or, equivalently
A[C] = B.
(1.2.20)
In particular, for m = 1 and g(y) = by2, f represents g iﬀf(c1, . . . , cn) = b
for some integers c1, . . . , cn.
Pell's equation considered above is a special case of the much more diﬃcult
general problem of representing integers and quadratic forms by quadratic
forms. We shall sketch below some results and approaches to this vast domain.
Lagrange proved that every positive integer is a sum of four squares. A
more diﬃcult result due to Gauss states that b > 0 is a sum of three integer
squares iﬀit is not of the form 4k(8l −1),
k, l ∈Z. Lagrange's theorem can
be easily deduced from this fact (cf. [Se70], [Cas78]).
Put
rk(n) = Card{(n1, . . . , nk) ∈Zk | n2
1 + · · · + n2
k = n}.
(1.2.21)
For example, r2(5) = 8, as one may convince oneself by listing all solutions.
There exist many formulae for this arithmetical function (cf. a vast bibliog-
raphy in [Kog71]). Most of them are descendants of the classical formula of
Jacobi ([Mum83], [Se70], [And76]):
r4(n) =
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩
8

d|n
d,
if
n
is odd,
24

d|n
d≡1(2)
d,
if
n
is even.
(1.2.22)
The proof is based on a study of the generating function for the sequence
rk(n), that is, the series
∞

n=0
rk(n)qn =

(n1,...,nk)∈Zk
qn2
1+n2
2+...n2
k = θ(τ)k
where

30
1 Elementary Number Theory
θ(τ) =

n∈Z
qn2,
q = e2πiτ.
(1.2.23)
This theta-function is a holomorphic function on the complex upper half-
plane H = {τ ∈C | Im(τ) > 0}. It has many remarkable analytic properties.
They can be summarized by saying that θ4(τ) is a modular form of weight 2
with respect to the group Γ0(4) where
Γ0(N) =

a b
c d

∈SL(2, Z)
 N|c

.
(1.2.24)
This means that the holomorphic diﬀerential θ4(τ)dτ is invariant with respect
to the substitutions τ →(aτ + b)(cτ + d)−1 for every matrix

a b
c d

in Γ0(4).
Modular functions will be considered more systematically in Part II, Ch. 6,
§6.3. The space of all such diﬀerentials is two-dimensional, and one can con-
struct a basis of this space with the help of Eisenstein series whose Fourier
coeﬃcients are more or less by construction certain divisor sums. Examin-
ing the ﬁrst two coeﬃcients of the series one ﬁnds an expression for θ4(τ) as
a linear combination of the Eisenstein series. On comparing coeﬃcients one
obtains (1.2.22). This method is very general. When the number of squares
grows one has to take into account not only the Eisenstein series but also cusp
forms whose Fourier coeﬃcients have a more complicated arithmetical nature
but in many cases allow a non-trivial direct interpretation. If one manages to
construct an explicit basis of the relevant modular forms, one can then express
the theta-series of a quadratic form f(x1, . . . , xk) = A[x] with respect to this
basis
θ(τ; f) =

x∈Zk
e(f(x)τ) =
∞

n=0
r(f; n)qn
(1.2.25)
where
e(τ) = exp(2πiτ) = q,
r(f; n) = Card{x ∈Zk | f(x) = n}.
This theta-series is a modular form of the weight k/2 with respect to a con-
gruence subgroup of the modular group.
For a recent progress by G.Shimura on the representation of integers as
sums of squares, we refer to [Shi02], [Shi04].
We quote as an example a formula proved by A.N.Andrianov ([An65],
[Fom77]). Let f = x2 + y2 + 9(z2 + t2). The theta-series of this form is a
modular form of weight 2 w.r.t. Γ0(36). For any prime p ̸= 2, 3 we have
r(f; p) = 4
3(p + 1) −8
3
p−1

x=0
x3 + 1
p

(1.2.26)

1.2 Diophantine Equations of Degree One and Two
31
where the sum in the right hand side contains the Legendre symbols, cf. §1.1.4.
Generating functions are traditionally used in combinatorics and the the-
ory of partitions. The simple partitions of n into sums of non-increasing nat-
ural summands are counted by the partition function p(n):
p(1) = 1
:
1 = 1;
p(2) = 2
:
2 = 2,
1 + 1;
p(3) = 3
:
3 = 3,
2 + 1,
1 + 1 + 1;
p(4) = 5;
p(5) = 7.
Its generating function satisﬁes the Euler identity (cf. [Cha70], [And76]): for
|q| < 1 one has
1 +
∞

n=1
p(n)qn =
∞

m=1
(1 −qm)−1.
(1.2.27)
To prove this, it suﬃces to represent the r.h.s. as the product of the power
series and to notice that p(n) is the number of solutions of a linear Diophantine
equation with an inﬁnite set of non-negative indeterminates
a1 + 2a2 + 3a3 + · · · = n.
Remarkably, the theta-series of certain quadratic forms are also connected
with certain inﬁnite products similar to (1.2.27). For example, if |q| < 1, z ̸= 0
we have (cf. [And76])
∞

n=−∞
znqn2 =
∞

m=0
(1 −q2m+2)(1 + zq2m+1)(1 + z−1q2m+1)
(Jacobi),
∞

n=0
qn(n+1)/2 =
∞

m=1
(1 −q2m)(1 −q2m−1)−1
(Gauss).
These identities follow from a more general result of Cauchy, valid for |q| <
1, |t| < 1, a ∈C:
1 +
∞

n=1
(1 −a)(1 −qa) . . . (1 −aqn−1)tn
(1 −q)(1 −q2) . . . (1 −qn)
=
∞

m=0
(1 −atqm)
(1 −tqm) .
(1.2.28)
Recently this list of such identities has been greatly enlarged, thanks to the
discovery that they are connected with the representation theory of the simple
Lie algebras, root systems and ﬁnite simple groups (cf. [Mac80]).

32
1 Elementary Number Theory
An impressive example of the use of generating functions is given by
Borcherds [Borch92] in his proof of the Conway and Norton conjectures con-
cerning connections between the monster simple group, M (and also other ﬁ-
nite sporadic simple groups), and modular functions. This group is the largest
sporadic ﬁnite simple group, its order is
8080, 17424, 79451, 28758, 86459, 90496, 17107, 57005, 75436, 80000, 00000 =
246 · 320 · 59 · 76 · 112 · 133 · 17 · 19 · 23 · 29 · 31 · 41 · 47 · 59 · 71.
The degree of the smallest nontrivial irreducible complex representation
of M is 196883, which is 1 less than the ﬁrst nontrivial q coeﬃcient of the
famous j(q) or elliptic modular function. In fact
j(q) = q−1 + 196884q + 21493760q2 + . . .
and the other coeﬃcients of j turn out to be simple combinations of the
degrees (traces on the identity) of representations of M.
Conway and Norton conjectured in [CoNo79] that the functions jg(q) ob-
tained by replacing the traces on the identity by the traces on other elements g
of M are "genus zero" modular functions. In other words if Gg is the subgroup
of SL2(R) which ﬁxes jg(q), then the quotient of the upper half of the complex
plane by Gg is a sphere with a ﬁnite number of points removed corresponding
to the cusps of Gg, cf. §6.3.
The proof is just as remarkable as the original moonshine conjectures and
involves the theory of vertex operator algebras and generalized Kac-Moody
algebras, cf. [Kon96].
It turns out, that some questions of the quantum ﬁeld theory are related
with modularity properties of such q-expansions, cf. [DGM90]. For example,
this property is an open question for the q-expansions:

X∈Zn
xi≥0
q
1
2 XtAX+BX+c
(q)x1·. . .·(q)xn
where X = (x1, · · · , xn) ∈Zn, n ≥1, (q)m = (1 −q)(1 −q2)·. . .·(1 −qm),
A ∈Mn(Q), B ∈Qn, c ∈Q (private communication by H.Cohen).
Symmetry properties of generating functions were used in Wiles' proof
of Fermat's Last Theorem and of the Shimura-Taniyama-Weil Conjecture
(see [Wi], [Ta-Wi], [DDT97] and Chapter 7). In this truly marvelous proof,
a traditional argument of reductio ad absurdum is presented in the following
form: if ap + bp = cp, abc ̸= 0, for a prime p ≥5 (a primitive solution (a, b, c)),
then one can associate to (a, b, c) a certain generating function f = fa,b,c :
H →C on the Poincaré upper half-plane H, deﬁned by a Fourier series with
the ﬁrst coeﬃcient equal to 1, as explained in §7.1. It turns out that this

1.2 Diophantine Equations of Degree One and Two
33
function has too many symmetries, expressing the fact that it is a modular
cusp form of weight 2 and level 2, and forcing f ≡0 by §6.3, a contradiction
with the construction of f.
1.2.7 Analytic Methods
Generating functions are also used to obtain various asymptotic formulae for
functions like r(f; n) and p(n) as n →∞. In particular, many results have
been derived using the Hardy-Littlewood circle method , its variants and gen-
eralizations (cf. [Vin52], [Vin71], [VK], [Mal62], [HW81], [Vau81-97], [Des90]).
The application of this method to a generating function
F(τ) =
∞

n=0
a(n)qn
(q = e(τ) = exp(2πiτ))
starts with Cauchy's formula:
a(n) =
1
2πi

|q|=r<1
F(τ)q−n−1dq.
(1.2.29)
The following discussion can be eﬃciently applied to many situations when
the unit circle is the natural boundary for the function F(τ) and roots of
unity on this boundary behave as "the worst essential singularities" (to get
some feeling for this, look at the r.h.s. of (1.2.27)). The idea is to break the
integration domain into two parts: I1 (the contribution of roots of unity of
comparatively small degree) and I2 (everything else) and to attempt to prove
that I2 is much smaller than I1. To understand the asymptotic behaviour of I1
and to majorize I2 one often uses exact or approximate functional equations
for F(τ), Poisson summation etc.
For example, to estimate p(n), Hardy, Littlewood and Ramanujan put
r = e−2π/n2. In terms of τ, they integrated over the segment Ln = {τ =
x+iy | 0 ≤x ≤1, y = 1/n2}, which they divided up as follows: I1 is the union
of the pairwise disjoint segments βp,q = {x | |x−p/q| < 1/2qnδ (δ ≥1)} where
p/q runs through the rational numbers between 0 and 1 with denominator ≤n;
I2 is the complement of I1.
For (1.2.27) this furnishes the Hardy-Ramanujan asymptotic formula
p(n) = eKλn
4
√
3λ2n
+ O(eKλn/λ3
n),
where
λn =

n −1/24,
K = π

2/3
(cf. [Cha70]).
Later this method was perfected by K.Rademacher who gave an exact
formula for p(n) as an inﬁnite sum whose summands correspond to (all) roots
of unity.

34
1 Elementary Number Theory
In one of the applications of the circle method to the theory of quadratic
forms, A.V.Malyshev proved in [Mal62] the following general result. Let k ≥4,
f(x1, . . . , xk) a positive quadratic form with integral coeﬃcients and determi-
nant d. Then as n →∞we have
r(f; n) =
πk/2
d1/2Γ( k
2)n
k
2 −1H(f; n) + O(d(k+12)/8n(k−1)/4+ϵ).
Here the constant in O depends only on k and ϵ > 0 and H(f; n) is the so
called singular series. This series is obtained in the process of computing of
the contribution of I1 as an inﬁnite product over all primes including the
"inﬁnite prime":
H(f; n) = r∞(f; n)

p
rp(f; n),
where
rp(f; n) = lim
m→∞p−m(k−1)Card{x ∈(Z/pmZ)k | f(x) ≡0 mod pm}
and r∞(f; n) is a certain "real density" of the solutions of f(x) = n.
It follows that if n is suﬃciently large and is representable by f modulo
all prime powers, then it is representable by f. This method however does
not work for 2 or 3 variables, where more subtle approaches are needed (cf.
[Lin79], [GF77], [Fom77], [Lom78]).
The circle method was considerably modiﬁed and perfected by I.M.Vi-
nogradov (cf. [Vin52], [Vin71], [VK]), who suggested replacing generating
functions by exponential sums, which are essentially their partial sums re-
stricted to the unit circle, e.g.
θN(τ; f) =

(x1,...,xk)∈Zk
|xi|<N
e(f(x)τ).
(1.2.30)
As a function of the real variable τ this sum oscillates vigorously and has
local maxima (of its modulus, real, and imaginary parts) at rational numbers
with small denominators. This behaviour reﬂects the singular behaviour of the
generating function in the vicinity of its natural boundary but is much less
wild and more easily controllable. This is one of the reasons for the success of
Vinogradov's method.
Figures 1.4 and 1.5 show the (scaled) graphs of the two simplest exponen-
tial sums featuring this behaviour. Instead of Cauchy's formula (1.2.29), one
uses in Vinogradov's method the integral formula
 1
0
θN(τ; f)e(−nτ)dτ = Card{x ∈Zk | f(x) = n, |xi| < N}
(1.2.31)
which follows directly from the orthogonality of the basic exponential func-
tions.

1.2 Diophantine Equations of Degree One and Two
35
-4
-2
0
2
4
y
-6
-4
-2
2
4
6
tau
Fig. 1.4. y(τ) = 4
k=0 cos(2π k2
5 τ)
Vinogradov's version of the circle method enabled him to prove that every
large odd integer is a sum of three primes (Goldbach conjectured in 1742
that every even integer is a sum of two primes) and to considerably diminish
the number of summands in Waring's problem (1770) on the representation
of large integers as sums of k-th powers. An improvement on Vinogradov's
bound due to Karacuba, [Kar85] is k(2 log k + 2 log log k + 12). Interesting
results for G(k) asymptotic to k log k has been obtained by R.C.Vaughan and
T.D.Wooley (cf. [VaWo91], [VaWoIV]). Further details of analytic methods
are outside the scope of this report and we refer the interested readers to the
monographs [Vin71], [VK], [Pos71], [AKCh87], [HW81], [Cha70], [Vau81-97]
and others. We should mention only the wide applicability of formulae of the
type (1.2.31) counting various numbers of solutions and the important role of
exponential sums like (1.2.30) in arithmetical problems (Gauss sums, Jacobi
sums, Kloostermann sums etc., cf. Ch.2, §2.2).
More generally, harmonic analysis is now used in number theory in its non-
commutative and multi-dimensional versions. For example, the construction
of the Hecke basis in the space of modular forms which is orthonormal with
respect to the Petersson inner product (scalar product) can be considered as a
two-dimensional analogue of the orthogonality relations for the exponentials
mentioned above (Part II, Ch. 6, §6.3).
1.2.8 Equivalence of Binary Quadratic Forms
Two quadratic forms over the integers f, g are called equivalent (over Z) if
they represent each other (cf. §1.2.6). We shall denote a binary quadratic form

36
1 Elementary Number Theory
-3
-2
-1
0
1
2
3
y
-6
-4
-2
2
4
6
tau
Fig. 1.5. y(τ) = 2
k=0 cos(2π k3
3 τ)
f(x, y) = Ax2+Bxy+Cz2 also (A, B, C). Such a form is called primitive if A,
B and C have no common factor. Its discriminant is denoted ∆= B2 −4AC.
Two forms f and g are called properly equivalent if we have
f(x, y) = g(mx + ny, kx + ly)
for an appropriate matrix
m n
k l

∈SL2(Z).
Gauss founded the equivalence theory of binary quadratic forms. He proved
that if ∆is not a square, then the set Cl(∆) of proper equivalence classes of
forms with discriminant ∆can be made into a ﬁnite Abelian group with re-
spect to a natural composition law. (Actually, this was one of the ﬁrst abstract
Abelian groups discovered in number theory). Very recently M.Bhargava (a
PhD student of A.Wiles, cf. [Bha04]) found higher composition laws, giving a
new view on Gauss composition.
In order to deﬁne this composition law in modern terms, consider the
quadratic number ﬁeld K = Q(
√
∆) = Q(
√
d) = {x + y
√
d | x, y ∈Q} where
d is a square-free integer. We have ∆= Dc2 where D is the discriminant of
the quadratic ﬁeld K, D = d if d ≡1 mod 4 and D = 4d otherwise. An
element α = x + y
√
d ∈K is called an integer if its trace 2x and its norm
x2 −dy2 are integers. The set of all integers in K forms a ring
O = ⟨1, ω⟩= {m + nω | m, n ∈Z},

1.2 Diophantine Equations of Degree One and Two
37
where ω =
√
d if d ≡2, 3 mod 4 and ω = (1 +
√
d)/2 if d ≡1 mod 4.
For any integer c we can deﬁne a subring Oc = Z + cO =< 1, cω >. A
fractional ideal M in Oc is a free additive subgroup with two generators which
is stable with respect to multiplication by elements of Oc. The product of two
fractional ideals is, by deﬁnition, the subgroup generated by the products
of elements from one ideal with elements of the other. The fractional ideals
form an Abelian group with identity Oc. To each such ideal M corresponds
a quadratic form with discriminant D = dc2 which can be constructed as
follows. Deﬁne the norm of M by N(M) = Card(Oc/M). Choose a basis
{α, β} for M in such a way that γ = −β/α = x + y
√
d satisﬁes the condition
y > 0. Then the quadratic form in question is
f(x, y) = Ax2 + Bxy + Cy2 = N(αx + βy)
N(M)
.
One can check that this is a primitive integral form.
Two fractional ideals M and M1 are called equivalent in the narrow sense
if M = γM1 for some γ ∈K with positive norm. The equivalence classes
of fractional ideals correspond bijectively to the proper equivalence classes of
primitive binary forms of discriminant Dc2. Multiplication of the fractional
ideals induces a group structure on this set. The identity of this group is
represented by the quadratic form (1, 0, −∆/4) (resp. (1, 1, (1 −∆)/4) if ∆is
even (resp. odd). In computations it is convenient to work with the reduced
forms (A, B, C) for which A > 0, −A ≤B < A, gcd(A, B, C) = 1. If ∆<
0 then the group Cl(∆) is trivial exactly for the following values: −∆=
4, 8, 3, 7, 11, 19, 43, 67, 163 (c = 1); 16, 12, 28 (c = 2); 27 (c = 3) (cf. Part II,
Ch. 5, §5.4.1).

1.3 Cubic Diophantine Equations
1.3.1 The Problem of the Existence of a Solution
For cubic forms F(X, Y, Z) in three variables with integral coeﬃcients, no-
body has succeeded in devising a general algorithm which provably decides
whether the equation F = 0 has a non-trivial integral solution. Large classes
of such equations have been studied both theoretically and numerically; see for
example the early inﬂuential papers by E.S.Selmer (cf. [Selm51] and [Selm54])
devoted to the equations
aX3 + bY 3 + cZ3 = 0.
Even some of the simplest equations like 3X3 + 4Y 3 + 5Z3 = 0 fail to satisfy
the Minkowski-Hasse principle: they have no non-trivial integral solutions
although they do have both real solutions and primitive integral solutions
modulo any N > 1. The degree of such failure can be measured quantitatively
by the Shafarevich-Tate group: cf. §5.3.
D.R.Heath-Brown has shown (cf. [HB84]) that any non-singular cubic
form in ten variables represents zero non-trivially, and C.Hooley in [H88]
has established the Minkowski-Hasse principle for non-singular nonary cubic
forms (a form is called non-singular if it and all its ﬁrst partial derivatives
have no common non-trivial complex zeroes). Previously Davenport and Birch
had shown that there exist non-singular cubic forms in nine variables which
do not represent zero modulo a power of every prime.
Birch in [Bir61] established that forms of any odd degree d represent zero
if the number of variables is suﬃciently large (with the bound depending
only on d). These results have since been generalized, extended and made
more precise by several authors. They are proved by the circle method, cf.
[Vau81-97], [Des90].
1.3.2 Addition of Points on a Cubic Curve
Any ternary cubic form F(X,Y,Z) deﬁnes a cubic curve C in the complex
projective plane P2:
C = {(X : Y : Z) | F(X, Y, Z) = 0}.
(1.3.1)
If C (that is, F) is non-singular, and if F = 0 has at least one rational
solution, then one can ﬁnd a non-degenerate change of projective coordinates
with rational coeﬃcients which reduces F to a Weierstrass normal form
Y 2Z −X3 −aXZ2 −bZ3
(a, b ∈Q).
(1.3.2)
One may also assume that the initial solution becomes the obvious solution
(0 : 1 : 0) of (1.3.2). The non-singularity condition for (1.3.2) is equivalent to

1.3 Cubic Diophantine Equations
39
the non-vanishing of the discriminant 4a3 + 27b2. Non-singular cubic curves
are also called elliptic. Passing to non-homogeneous coordinates x = X/Z, y =
Y/Z we reduce F = 0 to the form
y2 = x3 + ax + b,
(1.3.3)
where the cubic polynomial in the r.h.s. has no multiple roots. In this aﬃne
form, our initial solution becomes the inﬁnite point O. There is a beautiful
geometric description of a composition law on the set of rational points of C
making it an Abelian group with O as identity (or zero). This is called the
secant-tangent method (cf. [Sha88], [Cas66], [Kob84]). Namely, for a given pair
of points P, Q ∈C(Q), we ﬁrst draw a line containing them both. This line
also intersects C at a well-deﬁned third rational point P ′. Now we again draw
a line through P ′ and O. Its third intersection point with C is, by deﬁnition,
the sum P + Q. If P = Q, the ﬁrst line to be drawn should of course touch C
at P.
Fig. 1.6.
Fig. 1.7.
Calculating in non-homogeneous coordinates P = (x1, y1), Q = (x2, y2)
one ﬁnds P + Q = (x3, y3) where
x3 = −x1 −x2 +
 y1 −y2
x1 −x2
2
,
y3 = y1 −y2
x1 −x2
(x1 −x3) −y1.
(1.3.4)
In the limit case P = Q we have instead
x3 = −2x1 +
3x2
1 + a
2y1
2
, y3 = 3x2
1 + a
2y1
(x1 −x3) −y1.
(1.3.5)

40
1 Elementary Number Theory
If x1 = x2 and y1 = −y2 then P + Q = O, the inﬁnite point which is zero for
the group law.
This method allows us to construct new rational points starting with some
known ones. They will be the elements of the group generated by the initial
points, e.g. mP, m ∈Z, if just one point P (except O) was found initially.
For singular cubic curves this construction fails. For example, consider the
curve
C : y2 = x2 + x3,
(1.3.6)
which is drawn in Fig. 1.8. Any line passing through (0, 0) has only one more
common point with C: on y = tx it is deﬁned by the equation x2(t2−x−1) = 0.
Besides the trivial solution x = 0, we obtain x = t2−1 and y = t(t2−1) so that
we have found all points on C with the help of a rational parameterization.
In the non-singular case no such parameterization exists. On the other hand,
in our example we could have still deﬁned the group law on the set of non-
singular points as above. However, this becomes simply multiplication (for a
suitably chosen rational parameterization).
Fig. 1.8.
A curve admitting a rational parameterization is called rational. How one
can establish that such a parameterization exists or otherwise, and how its
existence inﬂuences the problem of describing all rational points, is answered
by algebraic-geometric methods.
1.3.3 The Structure of the Group of Rational Points of a
Non-Singular Cubic Curve
The most remarkable qualitative feature of the secant-tangent method is that
it allows one to construct all rational solutions of a non-singular cubic equa-

1.3 Cubic Diophantine Equations
41
tion (1.3.3) starting with only a ﬁnite number of them. In group-theoretical
language, the following result is true.
Theorem 1.3 (Mordell's Theorem). The Abelian group C(Q) is ﬁnitely
generated.
(cf. ([Mor22], [Cas66], [Mor69], [La83], [Se97] and Appendix by Yu.Manin to
[Mum74]). From the structure theorem for ﬁnitely generated Abelian groups,
it follows that
C(Q) ∼= ∆× Zr
where ∆is a ﬁnite subgroup consisting of all torsion points, and Zr is a
product of r copies of an inﬁnite cyclic group. The number r is called the rank
of C over Q.
The group ∆can be found eﬀectively. For example, Nagell and Lutz (cf.
[Lu37]) proved that torsion points on a curve y2 = x3 + ax + b for which a
and b are integers, have integral coordinates. Furthermore, the y-coordinate
of a torsion point either vanishes or divides D = −4a3 −27b2.
B.Mazur proved in 1976 that the torsion subgroup ∆over Q can only be
isomorphic to one of the following ﬁfteen groups:
Z/mZ (m ≤10, m = 12), Z/2Z × Z/2nZ (n ≤4),
(1.3.7)
and all these groups occur, cf. [Maz77].
It is still an open question whether r can be arbitrarily large. Mestre (cf.
[Me82]) constructed examples of curves whose ranks are at least 14. ∗)
A comparatively simple example of a curve of rank ≥9 is also given there:
y2 + 9767y = x3 + 3576x2 + 425x −2412. One can conjecture that rank is
unbounded. B. Mazur (cf. [Maz86]) connects this conjecture with Silverman's
conjecture (cf. [Silv86]) that for any natural k there exists a cube-free integer
which can be expressed as a sum of two cubes in more than k ways.
Examples. 1) Let C be given by the equation
y2 + y = x3 −x
whose integer solutions list all cases when a product of two consecutive integers
equals a product of three consecutive integers. Here ∆is trivial while the free
part of C(Q) is cyclic, with a generator P = (0, 0). Points mP (labeled by m)
are shown in Figure 9.
The following Table 1.3, reproduced here from [Maz86] with Mazur's kind
permission, shows the absolute values of the X-coordinates of points mP, for
even m between 8 and 58.
∗Martin-Mcmillen (2000) found an elliptic curve of rank ≥24:
y2 +xy + y = x3 −120039822036992245303534619191166796374x
+504224992484910670010801799168082726759443756222911415116
(see
http://www.math.hr/˜duje/tors/rankhist.html
for
more
examples).
(footnote by Yu.Tschinkel).

42
1 Elementary Number Theory
Fig. 1.9.
Table 1.3.
One sees that the last ﬁgures lie approximately on a parabola. This is
not an accident, but a reﬂection of the quadratic nature of heights on elliptic
curves (cf. below).
2) Table 1.4 was kindly calculated for this edition by H.Cohen, using PARI
computing system, [BBBCO]. This table lists ranks r and generators for curves
X3 + Y 3 = AZ3 with natural cube-free A ≤500; it corrects and completes
the Tables of Selmer (cf. [Selm51], [Selm54]) which were reproduced in the
ﬁrst edition [Ma-Pa]. Note the 3 missing values A = 346, 382, 445 for which
H.Cohen proved that r = 1, but the method of Heegner points for computing

1.3 Cubic Diophantine Equations
43
generators (see §6.4.4) takes too much time. However, this computation was
completed by Ch. Delaunay, see Table 1.5.
Table 1.4. Number of generators r and basic solutions of X3 + Y 3 = AZ3 with A
cube-free, A ≤500.
A r (X, Y, Z)
A
r (X, Y, Z)
6 1 (37, 17, 21)
7 1 (2, -1, 1)
9 1 (2, 1, 1)
12 1 (89, 19, 39)
13 1 (7, 2, 3)
15 1 (683, 397, 294)
17 1 (18, -1, 7)
19 2 (36, -17, 13),(109, -90, 31)
20 1 (19, 1, 7)
22 1 (25469, 17299, 9954)
26 1 (3, -1, 1)
28 1 (3, 1, 1)
30 2 (163, 107, 57),(289, -19,
93)
31 1 (137, -65, 42)
33 1 (1853, 523, 582)
34 1 (631, -359, 182)
35 1 (3, 2, 1)
37 2 (4, -3, 1),(10, -1, 3)
42 1 (449, -71, 129)
43 1 (7, 1, 2)
49 1 (11, -2, 3)
50 1 (23417, -11267, 6111)
51 1 (730511, 62641, 197028)
53 1 (1872, -1819, 217)
58 1 (28747, -14653, 7083)
61 1 (5, -4, 1)
62 1 (11, 7, 3)
63 1 (4, -1, 1)
65 2 (4, 1, 1),(191, -146, 39)
67 1 (5353, 1208, 1323)
68 1 (2538163, -472663,
620505)
69 1 (15409, -10441, 3318)
70 1 (53, 17, 13)
71 1 (197, -126, 43)
75 1 (17351, -11951, 3606)
78 1 (5563, 53, 1302)
79 1 (13, -4, 3)
84 1 (433, 323, 111)
85 1 (2570129, -2404889,
330498)
86 2 (13, 5, 3),(10067, -10049,
399)
87 1 (1176498611, -907929611,
216266610)
89 1 (53, 36, 13)
90 1 (1241, -431, 273)
91 2 (4, 3, 1),(6, -5, 1)
92 1 (25903, -3547, 5733)
94 1 (15642626656646177,
-15616184186396177,
590736058375050)
97 1 (14, -5, 3)
98 1 (5, -3, 1)
103 1 (592, -349, 117)
105 1 (4033, 3527, 1014)
106 1 (165889, -140131, 25767)
107 1 (90, 17, 19)
110 2 (181, -71, 37),(629, 251,
134)
114 1 (9109, -901, 1878)
115 1 (5266097, -2741617,
1029364)
117 1 (5, -2, 1)
123 1 (184223499139,
10183412861,
37045412880)
124 2 (5, -1, 1),(479, -443, 57)
126 2 (5, 1, 1),(71, -23, 14)
127 2 (7, -6, 1),(121, -120, 7)
130 1 (52954777, 33728183,
11285694)
132 2 (2089, -901, 399),(39007,
-29503, 6342)
133 1 (5, 2, 1)
134 1 (9, 7, 2)
139 1 (16, -7, 3)
140 1 (27397, 6623, 5301)
141 1 (53579249, -52310249,
4230030)
142 1 (2454839, 1858411, 530595)
143 1 (73, 15, 14)
151 1 (338, -95, 63)
153 2 (70, -19, 13),(107, -56,
19)
156 1 (2627, -1223, 471)
157 1 (19964887, -19767319,
1142148)
159 1 (103750849, 2269079,
19151118)
161 1 (39, -16, 7)
163 2 (11, -3, 2),(17, -8, 3)
164 1 (311155001, -236283589,
46913867)
166 1 (1374582733040071,
-1295038816428439,
136834628063958)
169 1 (8, -7, 1)
170 1 (26353, 14957, 5031)

44
1 Elementary Number Theory
Table 1.4. (continued)
A
r (X, Y, Z)
A
r (X, Y, Z)
171 1 (37, 20, 7)
172 1 (139, -103, 21)
177 1 (2419913540753,
1587207867247,
468227201520)
178 1 (110623913, 8065063,
19668222)
179 1 (2184480, -1305053,
357833)
180 1 (901, 719, 183)
182 2 (11, 5, 2),(17, 1, 3)
183 2 (14, 13, 3),(295579,
-190171, 46956)
186 1 (56182393, 15590357,
9911895)
187 1 (336491, -149491, 57070)
193 1 (135477799, -116157598,
16825599)
195 1 (68561, -54521, 9366)
197 1 (2339, -2142, 247)
198 1 (1801, -19, 309)
201 2 (16, 11, 3),(3251, 124, 555)
202 1 (2884067, 257437, 491652)
203 2 (229, 32, 39),(2426,
-2165, 273)
205 1 (8191, -6551, 1094)
206 1 (5211, -4961, 455)
209 2 (52, -41, 7),(125, -26, 21)
210 2 (1387, 503, 237),(3961,
-2071, 633)
211 1 (74167, 66458, 14925)
212 1 (337705939853,
-315091652237,
32429956428)
213 1 (64313150142602539-
525717,
46732739212871-
851099283,
12000095230-
802028099750)
214 1 (307277703127,
-244344663377,
40697090945)
215 1 (6, -1, 1)
217 2 (6, 1, 1),(9, -8, 1)
218 2 (7, -5, 1),(279469,
-61469, 46270)
219 2 (17, 10, 3),(168704,
-36053, 27897)
222 1 (5884597, 858653, 972855)
223 1 (509, 67, 84)
228 1 (46323521, -27319949,
7024059)
229 1 (745, -673, 78)
231 1 (818567, -369503,
129186)
233 1 (124253, -124020, 3589)
236 1 (248957, 209827, 47106)
238 1 (53927, 3907, 8703)
241 1 (292, -283, 21)
244 1 (99, -67, 14)
246 2 (571049, -511271, 59787),
(2043883, -1767133,
230685)
247 1 (20, -11, 3)
249 1 (275657307291045075203-
684958997,
-275522784-
968298556737485593813,
4974480998065387679-
603368524)
251 1 (4284, -4033, 373)
254 2 (238013, -206263, 26465),
(238393, -222137, 21676)
258 1 (2195839, -2047231,
198156)
259 1 (13, -5, 2)
265 1 (36326686731109813,
9746422253537867,
5691757727610864)
267 1 (861409, -342361, 130914)
269 1 (800059950, -786434293,
45728263)
271 2 (10, -9, 1),(487, -216, 73)
273 2 (19, 8, 3),(190, -163, 21)
274 1 (111035496427236122887,
-43257922194314055637,
16751541717010945845)
275 1 (424560439, -309086839,
55494828)
277 1 (209, -145, 28)
278 1 (13, 3, 2)
279 1 (7, -4, 1)
282 2 (117217, -96913, 13542),
(2814607, 1571057, 452772)
283 1 (20824888493, -8780429621,
3090590958)
284 1 (7722630462000896449-
941136589,
-12938136226219393-
03367981,
1174877194362780234-
594343698)
285 1 (18989, 1531, 2886)
286 1 (323, -37, 49)
287 1 (248, 121, 39)
289 1 (199, 90, 31)
294 1 (124559, -103391, 14118)
295 1 (34901, -16021, 5068)

1.3 Cubic Diophantine Equations
45
Table 1.4. (continued)
A
r (X, Y, Z)
A
r (X, Y, Z)
301 1 (382, 5, 57)
303 1 (2659949, 67051, 396030)
305 1 (86, -81, 7)
306 1 (6697, -3943, 921)
308 1 (199, 109, 31)
309 2 (20, 7, 3),(272540932,
-142217089, 38305371)
310 1 (5011613, -190493,
740484)
313 1 (22, -13, 3)
314 1 (241, -223, 21)
316 1 (7, -3, 1)
319 1 (6462443919765751305-
499,
-6182025219694143-
438499,
472407353310304561-
590)
321 1 (13755277819,
8670272669,
2164318002)
322 1 (1873, 703, 278)
323 1 (252, 71, 37)
325 1 (128, 97, 21)
330 1 (1621, 1349, 273)
331 1 (11, -10, 1)
333 1 (397, -286, 49)
335 2 (7, -2, 1),(390997, 260243,
61362)
337 1 (53750671, -53706454,
1043511)
339 1 (1392097139, -345604139,
198626610)
341 1 (6, 5, 1)
342 2 (7, -1, 1),(1253, -1205, 86)
345 2 (16543, 8297, 2454),
(389699, -190979,
53292)
346 1
348 2 (40283, -15227, 5622),
(2706139, 425861,
385230)
349 1 (23, -14, 3)
355 1 (2903959, 2617001,
492516)
356 1 (15026630492061476-
041947013,
-4709632110011335-
573393177,
2098221141580681-
446554589)
357 1 (19207, 6497, 2742)
358 1 (7951661, 2922589,
1138095)
359 1 (77517180, 50972869,
11855651)
363 1 (1909159356457,
-1746345039913,
165073101648)
366 1 (2087027, -1675277,
228885)
367 1 (42349, 526, 5915)
370 2 (7, 3, 1),(70523, 19387,
9891)
372 1 (2717893, 630107, 379470)
373 1 (1604, -1595, 57)
377 1 (469, -237, 62)
379 2 (15, -7, 2),(917, -908, 39)
380 1 (1009, -629, 127)
382 1
385 1 (20521, -17441, 2054)
386 1 (9, -7, 1)
387 1 (8, -5, 1)
388 1 (4659, -3287, 553)
390 2 (3043, 467, 417),(4373,
-863, 597)
391 1 (590456252061289,
-171359229789289,
80084103077160)
393 1 (4045451855513988711-
059,
2369372172284459-
347309,
587046969413536968336)
394 1 (1439245403, -573627403,
192088390)
395 1 (7891, -7851, 266)
396 1 (46789273, -37009657,
5074314)
397 2 (12, -11, 1),(360, 37, 49)
399 2 (22, 5, 3),(401, 328, 63)
402 1 (585699417548405371,
102798361240815491,
79502362839530631)
403 1 (53, -22, 7)
407 2 (7, 4, 1),(33733, -33634,
939)
409 1 (22015523, 21425758, 3687411)
411 1 (186871897, 49864103,
25292280)
413 1 (2575, -2103, 266)
414 1 (68073157, 32528843,
9454410)
418 1 (76267, 25307, 10323)

46
1 Elementary Number Theory
Table 1.4. (continued)
A
r (X, Y, Z)
A
r (X, Y, Z)
420 2 (2213, 1567, 327),(10459,
-6679, 1263)
421 1 (19690, 4699, 2639)
422 1 (15, 1, 2)
425 1 (2393, 1007, 326)
427 1 (25, -16, 3)
428 1 (1294057, -1190053,
104013)
429 1 (16739, 14149, 2598)
430 1 (5989967, 3449393,
841204)
431 1 (701, -270, 91)
433 2 (37, 35, 6),(252, 181, 37)
435 2 (32779, -1459, 4326),
(3784049, 2981071,
570276)
436 2 (19, 17, 3),
(1667465, 307927, 220362)
438 1 (12636764083,
11127850973,
1979215602)
439 1 (571, -563, 26)
441 1 (13, 11, 2)
444 1 (4174254535499,
-726500109131,
546201297768)
445 1
446 2 (23, -5, 3), (4286417,
-4285265, 52212)
447 1 (4405301, -382301,
576030)
449 1 (323, 126, 43)
450 1 (21079, 11321, 2886)
452 1 (851498679025552429,
224535817897760071,
111626729681785675)
453 2 (23, 4, 3),(50167097,
39331207, 7447188)
454 1 (753389202595029867-
852290245746241110629,
-204264638826527324-
892641927694862943879,
97368775947767167139-
892682703702288385)
457 1 (41, 31, 6)
458 1 (953039, -761375, 97482)
460 1 (248768189, -234795689,
17466345)
462 2 (3779, 379, 489),(11969,
-7811, 1389)
463 1 (403, -394, 21)
465 1 (1212356942047,
-1197072217207,
52307828958)
466 1 (464540708319337302841,
88798763256715446551,
60057801943830995598)
467 1 (1170, -703, 139)
468 2 (7, 5, 1),(859, -763, 74)
469 2 (13, -12, 1),(26, -17, 3)
474 1 (568871, -453689, 57627)
477 2 (89, 70, 13),
(12040, -11881, 523)
481 1 (43, 29, 6)
483 1 (2401741,
1945259,
352830)
484 1 (236521, -176021, 25235)
485 1 (8, -3, 1)
490 1 (193229, -74159, 24039)
493 1 (8432715268961,
-1057596310369,
1066758076384)
494 1 (59, -33, 7)
495 1 (342361, -57241, 43212)
497 2 (55, 16, 7),
(7411, -6772, 579)
498 2 (611137, -490123, 60543),
(15811001, -15250751, 933765)
499 1 (80968219, 17501213, 10242414)
Table 1.5. Basic solutions of X3 + Y 3 = AZ3 with A = 346, 382, 445.
A r (X, Y, Z)
346 1 (47189035813499932580169103856786964321592777067,
42979005685698193708286233727941595382526544683,
8108695117451325702581978056293186703694064735)
382 1 (58477534119926126376218390196344577607972745895728749,
16753262295125845463811427438340702778576158801481539,
8122054393485793893167719500929060093151854013194574)
445 1 (362650186970550612016862044970863425187,
-58928948142525345898087903372951745227,
47432800292536072666333861784516450106)

1.3 Cubic Diophantine Equations
47
These computations have now been extended up to A ≤70000 (Stephens).
Don Zagier noticed that in this range there are about 38.3% of curves with
r = 0; 48.9% with r = 1; 11.7% with even r ≥2 and 1.1% with odd r ≥3, and
these values vary only slightly within large intervals of the tables. We refer to
[Si01] for a survey of open questions in arithmetic algebraic geometry.
3) Let C be given by the equation
y2 + y = x3 −7x + 6.
Then C(Q) ∼= Z3, and the points (1,0), (6,0), (0, 2) form a basis of this group.
4) For y(y+1) = x(x−1)(x+2) we have r = 2; for y(y+1) = x(x−1)(x+4),
r = 2 (compare this with example 1).
5) Consider the curve y2 = x3 + px, p = 877. A generator modulo torsion
of the group of rational points of this curve has x-coordinate
x = 375494528127162193105504069942092792346201
6215987776871505425463220780697238044100 .
This shows that naive methods of seeking points quickly become ineﬃcient
(cf. [Cas66], [CW77], [Coa84] for an educated approach).
1.3.4 Cubic Congruences Modulo a Prime
Let p be a prime and F(X0, X1, X2) a cubic form with integral coeﬃcients.
Reducing F modulo p, we obtain a cubic form over the prime ﬁnite ﬁeld Fp.
This reduction is called non-singular if it has no common zeroes with its
ﬁrst partial derivatives in any extension of Fp. We can also apply elementary
algebraic-geometric ideas to a ﬁeld K of ﬁnite characteristic. The normal
forms are then slightly more complicated. By making a change of projective
coordinates and passing to the non-homogeneous equation, we can always
reduce the equation F = 0 to the form
y2 + a1xy + a3y = x3 + a2x2 + a4x + a6,
where a1, a2, a3, a4, a6 ∈K and
∆= −b2
2b8 −8b3
4 −27b2
6 + 9b2b4b6 ̸= 0,
where
b2 = a2
1 + 4a2,
b4 = 2a4 + a1a3,
b6 = a2
3 + 4a6.
The notation j = c3
4
∆is used, where
c4 = b2
2 −24b4, c6 = −b3
2 + 36b2b4 −216b6.
Then this equation can be further simpliﬁed using the transformation x →
u2x′ + r, y →u3y′ + su2x′r + t in order to obtain the following (cf. [Ta73],
[Kob87] :

48
1 Elementary Number Theory
1) For p ̸= 2, 3:
y2 = x3 + a4x + a6 with ∆= −16(4a3
4 + 27a2
6 ̸= 0).
(1.3.8)
2) For p = 2 we have that the condition j = 0 is equivalent to a1 = 0, and
the equation transforms as follows: if a1 ̸= 0 (i.e. j ̸= 0), then choosing
suitably r, s, t we can achieve a1 = 1, a3 = 0, a4 = 0, and the equation
takes the form
y2 + xy = x3 + a2x2 + a6,
(1.3.9)
with the condition of smoothness given by ∆̸= 0. Suppose next that
a1 = 0 (i.e. j = 0), then the equation transforms to
y2 + a3y = x3 + a4x + a6,
(1.3.10)
and the condition of smoothness in this case is a3 ̸= 0.
3) For p = 3:
y2 = x3 + a2x2 + a4x + a6,
(1.3.11)
(here multiple roots are again disallowed).
The projective curve deﬁned by the respective homogeneous equation al-
ways has a rational point O = (0 : 1 : 0).
How many points over Fp, that is, solutions of the congruence F ≡0 mod
p, should we expect? Clearly, the total number (counting O) cannot exceed
2p + 1, since every ﬁnite x gives no more than two values of y. On the other
hand, of all the non-zero residue classes, only half of them are squares (for
odd p). Hence we might expect that x3 + ax + b is a square only for about a
half of the x's.
More precisely, let χ(x) =
x
p

be the Legendre symbol (cf. §1.1.5). Then,
by deﬁnition, the number of solutions of y2 = u in Fp is 1 + χ(u). Therefore,
Card C(Fp) = 1 +

x∈Fp
(1 + χ(x3 + ax + b))
= p + 1 +

x∈Fp
χ(x3 + ax + b).
N.Koblitz in [Kob94] compares the last sum with the result of a random walk
on a line. After p steps one might expect to be at distance roughly √p from
zero. Actually, one can prove the following remarkable theorem (cf. [Ha37]):
Theorem 1.4 (Hasse's Theorem). Let Np = Card C(Fp). Then
|Np −(p + 1)| ≤2√p.

1.3 Cubic Diophantine Equations
49
An elementary proof of this theorem was given in 1956 (cf. [Man56]).
Since then, both the algebraic-geometric and the elementary proofs have
been greatly extended. For a review of the elementary methods, cf. [Step74],
[Step84], [Step94].
We refer to [LaTr76] for the problem of the distribution of Frobenius au-
tomorphisms for varying p, and of the diﬀerence Np −(p+1), which is related
to the Sato-Tate Conjecture (cf. Chapter I in [Se68a] and §6.5.1).
The Abelian group structure on the group of points E(Fp) on an elliptic
curve is used in many arithmetical questions. In particular, the case when this
group is cyclic of large size leads to ECDLP ("Elliptic curve discrete logarithm
problem") which is very important for applications in public-key cryptography,
see [Kob87].

1.4 The Structure of the Continuum. Approximations
and Continued Fractions
1.4.1 Best Approximations to Irrational Numbers
Since
√
2 is irrational, the quadratic form x2 −2y2 cannot vanish at integral
points (x, y) ̸= (0, 0). The smallest values taken by this form at such points
are
x2 −2y2 = ±1.
(1.4.1)
This is an instance of Pell's equation, which we discussed in §1.2.5; we are now
interested in it because its successive solutions give the best approximations
to
√
2 by rational numbers.
More precisely, a/b is said to be a best approximation to α if
|bα −a| < |dα −c|
for all 0 < d ≤b, a ̸= c. Every solution to (4.1) can be obtained by setting
a +
√
2b = (1 +
√
2)n.
Table 1.6.
x
y
x/y
1
1
1,0
3
2
1,5
7
5
1,4
17
12
1,416. . .
41
29
1,4137. . .
99
70
1,41428. . .
239
169
1,414201. . .
577
408
1,414215. . .
1393
985
1,4142132. . .
3363
2376
1,4142136. . .
...
...
...
1.4.2 Farey Series
One way of ﬁnding good approximations is connected with a speciﬁc procedure
for enumerating all rational numbers between 0 and 1. Denote by Fn the Farey

1.4 Approximations and Continued Fractions
51
Table 1.7.
1
5
1
4
1
3
2
5
1
2
3
5
2
3
3
4
4
5
1
1
5
4
4
3
3
2
5
3
2
1
5
2
3
1
4
1
5
1
series of order n, which consists of all such numbers in increasing order whose
denominators are ≤n:
Fn = {a/b | 0 ≤a ≤b ≤n, (a, b) = 1}.
(1.4.2)
Theorem 1.5 ( [HaWr]). For every real number α ∈[0, 1] there exists a/b ∈
Fn such that
α −a
b
 ≤
1
b(n + 1).
(1.4.3)
The proof is based on the fact that if a/b, c/d are neighbours in Fn then
ad −bc = ±1. This in turn can be seen by noting that one can go from Fn
to Fn+1 by inserting between a/b and c/d all mediants (a + c)/(b + d) with
c + d = n + 1.
In this theorem α need not be irrational, so we obtain some information
about rational approximations to rational numbers with large denominators.
If α is irrational, this theorem shows that the inequality
α −a
b
 < 1
b2
(1.4.4)
has inﬁnitely many solutions a/b. If a/b is a best approximation, then (1.4.4)
follows from (1.4.3) with n = b. An eﬃcient way of ﬁnding best approximations
is furnished by continued fractions. This tool also allows us to show that for
irrational β the following stronger inequality has inﬁnitely many solutions
β −a
b
 <
1
√
5b2
(1.4.5)
1.4.3 Continued Fractions
(cf. [Khi78], [Dav52], [HaWr]). For an arbitrary real number α, we deﬁne a
sequence of integers ai and real numbers αi by the following rules: a0 = [α]
(the integral part), α0 = α, αi+1 = 1/(αi −ai), ai+1 = [αi+1] (i ≥0). We
obtain a continued fraction

52
1 Elementary Number Theory
α = a0 +
1
a1 +
1
a2 +
1
a3 + . . .
1
am +
1
αm+1
,
which can be written in a more compact notation as
α = [a0; a1, a2, . . . , am, αm+1].
(1.4.6)
Deleting αm+1 in (1.4.6), we get the ﬁnite continued fraction
Cm = [a0; a1, . . . , am]
called the mth convergent of α. The numerators and denominators of the
successive convergents Cm = Am/Bm can be calculated recursively starting
from A−2 = B−1 = 0, A−1 = B−2 = 1 with the help of the following relations:
Ak+1 =ak+1Ak + Ak−1,
Bk+1 = ak+1Bk+Bk−1 (k = −1, 0, 1, . . . ).
(1.4.7)
If α is irrational, then αm ̸= 0 for all natural m. Convergents of even order
increase; those of odd order decrease, and both sequences converge to α. The
limit is denoted as the (inﬁnite) continued fraction
α = [a0; a1, a2, . . . , an, . . . ].
This all follows easily from (1.4.7): ﬁrst we see that
BkAk−1 −AkBk−1 = (−1)k, k ≥1,
BkAk−2 −AkBk−2 = (−1)k−1ak, k ≥0,
(1.4.8)
and then
Ak−1
Bk−1
−Ak
Bk
=
(−1)k
BkBk−1
,
Ak−2
Bk−2
−Ak
Bk
= (−1)k−1ak
BkBk−2
.
(1.4.9)
From (1.4.9) one also deduces that every best approximation to α is equal to
a convergent Am/Bm, because
1
Bm(Bm + Bm+1) <
α −Am
Bm
 <
1
BmBm+1
.
(1.4.10)

1.4 Approximations and Continued Fractions
53
1.4.4 SL2-Equivalence
The numbers αm deﬁned by (4.6) are related to α via fractional linear trans-
formations
α = Am−1αm + Am−2
Bm−1αm + Bm−2
.
(1.4.11)
Moreover, the determinants of these transformations are (−1)m (see (1.4.8)).
In general, two numbers related by a fractional linear transformation of deter-
minant 1 are called SL2(Z)-equivalent. Hence α and (−1)mαm are equivalent
in this sense. Conversely, α and β are equivalent iﬀαm = βn for appropriate
m and n (cf. e.g. [Khi78]). In particular, all rational numbers are equivalent
to one another.
1.4.5 Periodic Continued Fractions and Pell's Equation
Consider an inﬁnite continued fraction which becomes periodic after a certain
place k0, with a period of length k:
α = [a0; a1, . . . , ak0−1, ak0, . . . , ak0+k−1].
(1.4.12)
Then from (1.4.11) it follows that α is a quadratic irrational number.
Example. We have
√
3 = [1; 1, 2, 1, 2, 1, 2, . . . ],
since, denoting by x the r.h.s. continued fraction, we have
x = 1 +
1
1 +
1
1+x
that is,
2x + x2 = 3 + 2x
and, ﬁnally, x =
√
3.
The following algorithm eﬃciently calculates αm for a quadratic irrational-
ity α. Let N be square-free,
α = (P0 +
√
N)/Q0,
N −P 2
0 being divisible by Q0. Find successively
Pi+1 = aiQi −Pi,
Qi+1 = (N −P 2
i+1)/Qi, i = 0, 1, 2, . . .
Then the Pi and Qi are all integers; Qi divides N −P 2
i+1, and

54
1 Elementary Number Theory
αi+1 = Pi+1 +
√
N
Qi+1
.
In general, Pi and Qi do not grow as rapidly as the numerators and denomina-
tors of the successive convergents. For example, if |P0| <
√
N, 0 < Q0 <
√
N,
we have for all i ≥1:
0 < Pi <
√
N, 0 < Qi < 2
√
N,
A2
i −NB2
i = (−1)i+1Qi+1
(cf. [Ries85], [Knu81]). At the ith stage, the calculations consist of four steps.
1) Pi+1 = [
√
N] −Ri (R0 = 0),
2) Qi+1 = (N −P 2
i+1)/Qi (Q−1 = (N −P 2
0 )/Q0),
3) ai+1 = [(Pi+1 + [
√
N])/Qi+1],
4) Ri+1 = the residue of Pi+1 + [
√
N] modulo Qi+1.
This algorithm can be used to calculate eﬃciently the smallest solution to
Pell's equation. In fact, if a2 −Nb2 = 1, then we have a2 ≥1 + N, b2 ≥1, so
that
a
b −
√
N
 =
1
2b2√
N
.
Hence a/b is one of the convergents of
√
N.
Example. The smallest solution to x2 −43y2 = 1 is x = 3482, y = 531. Its
calculation by the method described above is protocolled in table 1.8.
Table 1.8.
i
-2
-1
0
1
2
3
4
5
6
7
8
9
ai
6
1
1
3
1
5
1
3
1
1
Pi
0
6
1
5
4
5
5
4
5
1
Qi
1
7
6
3
9
2
9
3
6
7
Ri
0
5
1
2
1
1
2
1
5
0
Ai
0
1
6
7
13 46 59 341 400 1541 1941 3482
Bi
1
0
1
1
2
7
9
52
61
235
269
531
A2
i −43B2
i
-7
6
-3
9
-2
9
-3
6
-7
1

1.5 Diophantine Approximation and the Irrationality of
ζ(3)
1.5.1 Ideas in the Proof that ζ(3) is Irrational
One of the amazing mathematical inventions of recent time showing the vast
undiscovered power of elementary methods in number theory, was the proof
of the irrationality of ζ(3) = ∞
n=1 n−3 found by the French mathematician
Apéry. This proof was ﬁrst presented in June 1978 in the conference Journée
Arithmétique de Marseille-Luminy.
We follow here an informal exposition of the proof due to van der Poorten
(cf. [vdP79]), who notes the original mistrust of the proof among other math-
ematicians, which was at ﬁrst taken as a collection of mysterious statements.
1) For all integers a1, a2, ...
∞

k=1
a1a2 · · · ak−1
(x + a1) · · · (x + ak) = 1
x
(1.5.1)
2)
ζ(3) = 5
2
∞

n=1
(−1)n−1n3
2n
n

.
(1.5.2)
3) Consider the recurrence relation: for n ≥2
n3un −(34n3 −51n2 + 27n −5)un−1 + (n −1)3un−2 = 0,
(1.5.3)
and let bn be a sequence deﬁned by the initial conditions b0 = 1, b1 = 5
and the relation (1.5.3). Let an be the sequence deﬁned by (1.5.3) and
the initial conditions a0 = 0, a1 = 6. Then the denominators of the
rational numbers an divide 2[1, 2, . . . , n]3 where [1, 2, · · · , n] denotes the
least common multiple of the numbers 1, 2, . . . , n.
4) The sequence an/bn converges to ζ(3) rapidly enough for one to establish
irrationality of ζ(3). Moreover, for ε > 0 and for all integers p, q > 0 with
q suﬃciently large the inequality holds
ζ(3) −p
q
 >
1
qθ+ε ,
θ = 13.41782...
(1.5.4)
One has the following continued fraction expansion:
ζ(3) =
6
p(0) −
16
p(1) −
26
p(2) −
· · ·
· · ·
· · ·
p(n −1) −
n6
p(n) −· · ·
(1.5.5)

56
1 Elementary Number Theory
i.e.
ζ(3) = 6
5−
|
1
117−
|
64
535−
|
729
1436−
|
4096
3105−
· · ·
· · ·
|
n6
34n3 + 51n2 + 27n + 5
· · · .
1.5.2 The Measure of Irrationality of a Number
In §4 of Chapter 1 we noted a link between the property of a number β being
irrational and the existence of inﬁnitely many good rational approximations
p/q to β, i.e. such that the equality holds
β −p
q
 < 1
q2 .
Analogously one could state the following criterium for the irrationality of a
number: if there exists δ > 0 and a sequence {pn/qn} of rational numbers
{pn/qn} ̸= β such that
β −pn
qn
 <
1
q1+δ
(n = 1, 2, . . . , ),
(1.5.6)
then β is an irrational number. The use of this criterium gives an interesting
measure of irrationality: if |β −pn
qn | <
1
q1+δ and qn steadily increase in such a
way that qn < q1+κ
n−1 for suﬃciently large n and κ > 0 then for any ﬁxed ε > 0
and for all suﬃciently large p, q > 0 the following equality holds:
β −pn
qn
 >
1
q(1+δ)/(δ−κ)+ε .
(1.5.7)
In the interesting case when qn increases geometrically, i.e. qn, C, α > 0 one
could take for κ an arbitrarily small positive integer, and the exponent in
(1.5.7) becomes 1 + (1/δ) which is called the irrationality degree of β.
Surprisingly, the method of Apéry turned out also to be applicable to the
number
ζ(2) =
∞

n=1
n−2 = π2/6,
whose transcendence is well known. However Apéry's proof implies the in-
equality
π2 −p
q
 >
1
qθ′+ε
θ′ = 11.85078...,
(1.5.8)
for all ε > 0 and q suﬃciently large. One also knows that the irrationality
degrees of π2 and ζ(3) are not greater than θ and θ′ respectively.

1.5 Diophantine Approximation and the Irrationality
57
1.5.3 The Thue-Siegel-Roth Theorem, Transcendental Numbers,
and Diophantine Equations
(cf. [Roth55], [Dav58], [Spr82], [Fel82], [Shid87], [Maz86]). This famous the-
orem states that if β is an algebraic number, i.e. a root of a polynomial
f(X) = anXn + an−1Xn−1 + · · · + a0 (ai ∈Z), then for an arbitrary ﬁxed
ε > 0 and all suﬃciently large q the following inequality holds:
β −p
q
 >
1
q2+ε .
(1.5.9)
In other words, if we take arbitrary positive constants C and ε, then there
exist only a ﬁnite number of approximations x/y of β satisfying the inequality
β −x
y
 <
1
y2+ε .
(1.5.10)
In particular, if the inequality (1.5.6) holds for a sequence (pn/qn) with a ﬁxed
δ > 1, then the number β must be transcendental (i.e. not algebraic). However
it turns out that this condition deﬁnes only a subset of the transcendental
numbers of measure zero.
Note that the theorem of Thue-Siegel-Roth has very important applica-
tions in the theory of Diophantine equations, which can be explained by the
example of the equation
X3 −5Y 3 = m
(m ̸= 0)
(1.5.11)
for a ﬁxed integer m. This equation resembles Pell's equation, but its degree
is greater then 2. If (x, y) a solution of (1.5.11) then the following equality
holds:
x
y −
3√
5
 ≤
c
|y|3
(c =
3√m).
(1.5.12)
However if we take ε > 0 such that 2+ε < 3 then Roth's theorem implies that
there are only ﬁnitely many solutions for the inequality (1.5.12) and hence for
the equation (1.5.11).
Using algebraic geometric methods, but resting on essentially the same
idea, Siegel established the following result:
Theorem 1.6 (Siegel C.-L. (1929)). Let f(X, Y ) be an irreducible poly-
nomial with integer coeﬃcients. Then the equation
f(X, Y ) = 0
(1.5.13)
has only ﬁnitely many integral solutions excluding the two special cases:
a) The curve f(X, Y ) = 0 admits a rational parameterization: substituting to
(1.5.13) non-zero rational fractions X = p(t)/q(t), Y = r(t)/s(t) ∈Q(t)
this equation becomes an identity of rational functions of t.

58
1 Elementary Number Theory
b) The projective envelope of the curve (1.5.13) has not more than two points
at inﬁnity.
In particular, the Thue equation f(x, y) = m where f(x, y) ∈Z[x, y] is
an irreducible form of the degree n ≥3, has only a ﬁnite number of integral
solutions. A. O. Gelfond (cf. [Ge83] ) has shown that an eﬀective bound for
solutions of the Thue equation can be obtained if one has a good lower bound
for the module of linear forms of logarithms of algebraic numbers α1, . . . , αn
(with integer coeﬃcients). Such estimates were obtained by [Ba71], making
it possible to solve a number of important arithmetic problems. These prob-
lems include besides bounds for solutions of Diophantine equations ([Spr82],
[Step84], [Schm79], [Bak86], [La60], [La62]), also eﬀective bounds for the class
numbers of algebraic number ﬁelds and the numbers of equivalence classes of
quadratic forms ([Ba71], [St67], [St69]). An eﬀective upper bound (see [Bak86]
[Spr82], [ShT86] )
yv < xu < exp exp exp exp 103
was obtained by Baker's method for solutions of the Catalan equation
xv −yu = 1
which provide an example of an exponential Diophantine equation systemati-
cally studied in [ShT86]. Catalan asked in 1843 whether 8 and 9 are the only
consecutive perfect powers. A recent solution of this problem by P. Mihăilescu
(who answered the question aﬃrmatively) has become one of the main arith-
metical highlights of the past few years, cf. [Mih03], [Bi02].
1.5.4 Proofs of the Identities (1.5.1) and (1.5.2)
First of all the equality
K

k=1
a1a2 · · · ak−1
(x + a1) · · · (x + ak) = 1
x −
a1a2 · · · aK−1
(x + a1) · · · (x + aK)
(1.5.14)
is easy to check. We may write the right hand side in the form
A0 −AK,
Ak =
a1a2 · · · ak−1
(x + a1) · · · (x + ak)
and note that each term in the left hand side is equal to Ak−1 −Ak. The
identity (1.5.1) follows immediately from (1.5.14).
Now substituting x = n2 and ak = −k2 and taking k ≤K ≤n −1 we
obtain
n−1

k=1
(−1)k−1(k −1)!2
(n2 −12) · · · (n2 −k2) = 1
n2 −
(−1)n−1(n −1)!2
n2(n2 −12) · · · (n2 −(n −1)2),
= 2(−1)n−1
n22n
n
 .

1.5 Diophantine Approximation and the Irrationality
59
Writing εn,k = 1
2
k!(n −k)!
k3(n + k)!, we have
(−1)kn(εn,k −εn−1,k) =
(−1)k−1(k −1)!2
(n2 −12) · · · (n2 −k2)
from which follows the identity
N

n=1
n−1

k=1
(−1)k(εn,k −εn−1,k) =
N

n=1
1
n3 −2
N

n=1
(−1)n−1
n32n
n
 =
N

k=1
(−1)k(εN,k −εk,k) =
N

k=1
(−1)k
2k3N+k
k
N
k
 +
N

k=1
(−1)k−1
k32k
k
 .
(1.5.15)
The equality (1.5.2) is implied by (1.5.15) on noting that the sum
N

k=1
(−1)k
2k3N+k
k
N
k

tends to zero as N →∞.
1.5.5 The Recurrent Sequences an and bn
Write the recurrence relation (4.3) satisﬁed by an and bn:
n3an −P(n −1)an−1 + (n −1)3an−2 = 0,
n3bn −P(n −1)bn−1 + (n −1)3bn−2 = 0,
where P(n −1) = p(n) = 34n3 −51n2 + 27n −5. If we multiply the ﬁrst
equality by bn−1 and the second by an−1, and then subtract second from the
ﬁrst, we get
n3(anbn−1 −an−1bn) = (n −1)3(an−1bn−2 −an−2bn−1).
Recall that by the initial conditions we have a1b0 −a0b1 = 6 · 1 −0 · 5 = 6,
which implies
anbn−1 −an−1bn = 6
n3 .
(1.5.16)
This easily leads to the relation
ζ(3) −an
bn
 =
∞

k=n+1
6
k3bkbk−1
= O(b−2
n ).
(1.5.17)
This is proved by the induction starting from the equality ζ(3)−a0
b0 = ζ(3).
The absolute values of the numbers bn can be easily estimated using the
relation

60
1 Elementary Number Theory
bn −(34 −51n−1 + 27n−2 −5n−3)bn−1 + (1 −3n−1 + 3n−2 −n−3)bn−2 = 0.
Using the fact that the "linearized characteristic polynomial" of this recurrence
relation is x2 −34x + 1 and has roots 17 ± 2
√
2 = (1 ±
√
2)4, we obtain the
estimate
bn = O(αn), α = (1 +
√
2)4.
Assume for a moment that the statement in 3) on integrality of the num-
bers bn and on the denominators of an dividing 2[1, 2, · · · , n]3 is already
proved. Then it is easy to complete the proof as follows. Let
pn = 2[1, 2, · · · , n]3an, qn = 2[1, 2, · · · , n]3bn,
where pn, qn ∈Z. The value of [1, 2, · · · , n] can be estimated using for example
a rough form of the prime number theorem: 
p≤x 1 ≈x/ log x. Then
[1, 2, · · · , n] =

p≤n
p[log n/ log p] ≤

p≤n
n ≈nn/ log n = en.
Hence qn = O(αne3n) and
ζ(3) −pn
qn
 = O(b−2
n ) = O(α−2n) = O(q−(1+δ)
n
)
with the constant δ = (log α −3)/(log α + 3) = 0.080529... > 0. According to
the irrationality criterium in §1.5.2, we obtain the statement (1.5.6) in which
the irrationality degree is not greater than 1 + (1/δ) = θ.
The statement on the denominators of the numbers an and bn is one of
the most diﬃcult points of the proof. Apéry proved this fact by explicitly
constructing the sequences an and bn:
cn =
n

k=0
n
k
2n + k
k
2
,
an =
n

k=0
n
k
2n + k
k
2
cn,k,
where
cn,k =
n

m=1
1
m3 +
k

m=1
(−1)m−1
2m3
n
m
n + m
m
.
(1.5.18)
It follows from these formulae that the numbers an are integral. The bound
on the denominators of bn is given by the fact that all of the numbers
2[1, 2, · · · , n]3cn,k
n + k
k

are integers. The proof of this uses an estimate for the maximal power with
which a prime p can arise in the denominator of each term in the sum (1.5.18)
deﬁning cn,k.

1.5 Diophantine Approximation and the Irrationality
61
Further irrationality properies of zeta values at odd positive integers were
studied recently in [Riv01], [Zu95], [BaRi01], see also [Zu]. In particular,
W.Zudilin proved that at least one of ζ(5), ζ(7), ζ(9), ζ(11) is irrational.
There are interesting attempts to prove the irrationality of Euler's con-
stant and to understand its arithmetic nature, cf. [Son04]. In [BelBr03] Euler's
constant γ is interpreted as an exponential period. The ring P of periods
is generated by the numbers of the form

γ ω where X is a smooth alge-
braic variety of dimension d deﬁned over Q, D ⊂X is a divisor with nor-
mal crossings, ω ∈Ωd(X) is an algebraic diﬀerential form of degree d on
X, γ ∈Hd(X(C), D(C); Q), cf. Chapter 5. This ring was introduced by M.
Kontsevich and D. B. Zagier in [KoZa01] (see also [Del79]).
1.5.6 Transcendental Numbers and the Seventh Hilbert Problem
It is useful to compare the given elementary proof with the highly developed
theory of transcendental numbers, i.e. the numbers, which are not roots of
polynomials with rational coeﬃcients. The existence of such numbers was
ﬁrst established by Liouville in 1844; then Hermite proved the transcendence
of e (in 1873), and Lindeman in 1883 proved the transcendence of π ([Ba75],
[Bak86], [Shid87]). In the framework of a general theory A. O. Gelfond (see
in [Ge73]) and Th. Schneider (cf. [Sch57]) obtained a solution to the seventh
Hilbert problem (Hilbert D. (cf. [Hil1900] ), [Fel82]): to prove that "the power
αβ of an algebraic base α to an irrational algebraic exponent β (e.g. 2
√
2 or
eπ = i−2i is always transcendental, or at least irrational"; ". . . we found it very
probable that such a function as eπiz, which evidently takes algebraic values
for all rational values of the argument z, will take, on the other hand, for
algebraic irrational values of z, only transcendental values".
1.5.7 Work of Yu.V. Nesterenko on eπ, [Nes99]
One of the most impressive achievments of the last decade in the theory of
transcendental numbers was the work of Yu.V. Nesterenko on the algebraic
independence of π and eπ, see [Nes99] and [Nes02]. This result is based on the
study of the transcendence degree of a ﬁeld generated by numbers connected
with the modular function j(τ). In [Nes99] the algebraic independence of π, eπ
and Γ( 1
4) is also established by this powerful method. For proving this result,
the problem is reduced to estimating the measure of algebraic independence
for the numbers π and Γ( 1
4).

2
Some Applications of Elementary Number
Theory
2.1 Factorization and Public Key Cryptosystems
2.1.1 Factorization is Time-Consuming
In order to multiply two primes p ≤q given their binary expansions, it suﬃces
to perform C(log q)2 bit-operations (see section 1.1.1). Suppose now that we
are given n = pq and are asked to ﬁnd p and q. If p ∼q ∼√n then the naive
repeated trial of all d ≤√n would require more than
C√n = C exp
1
2 log n

divisions with remainder. This exponential growth of the running time makes
the factorization of even rather small numbers unfeasible, at least unless one
invents more eﬃcient algorithms. For example, consider the factorization
(1071 −1)/9 = 241573142393627673576957439049×
(2.1.1)
45994811347886846310221728895223034301839.
With some patience, one can multiply the two numbers on the right hand side
in an hour or two on a sheet of paper. However, the factorization of the result
by the trial-and-error method would take about 1010 years of running time (if
one division requires 10−9 sec: cf. [Sim79], [Pet85], [Wun85], [Ya02]).
In real life, the factorization (2.1.1) was ﬁrst found in 1984 with the assis-
tance of a CRAY supercomputer and fairly advanced factorization methods,
which made this task feasible if not inexpensive.
2.1.2 One-Way Functions and Public Key Encryption
We may consider the binary expansion of n = pq as a message which can
be encoded in many other ways, e.g., by giving expansions of p and q. The

64
2 Some Applications of Elementary Number Theory
rules explaining how to pass from one form to another from the information-
theoretical viewpoint can be called enciphering, encryption and deciphering.
Experimentally, one knows that some functions are easy to compute but dif-
ﬁcult to invert (one-way, or trap-door functions). It is then natural to try
to use these functions in cryptography. We recall that cryptography studies
problems of information handling concerned with keeping and breaking se-
crecy of messages. One-way functions are used in the so called public key
encryption schemes, which were suggested in the seventies and revolutionized
this domain.
Before explaining the design of one such scheme, we must stress however
that there are no theoretical lower bounds on computational complexity justi-
fying our experimental observation that complexity of factorization far exceeds
that of multiplication. In principle, we cannot exclude the possibility that a
very eﬃcient algorithm for factorization (or for inverting any given trap-door
function) might eventually be found. This is one of the basic problems of
computational complexity theory (cf. e.g. [GJ79], [DH76] [CoLe84], [ARS78],
[Ya02]). If, however, we assume this experimental fact, we can use it in order
to generate new encryption schemes with remarkable properties.
We shall now describe the ﬁrst "public key cryptosystem" suggested by
L.Adleman, R.Rivest, and A.Shamir in 1978, cf. [ARS78].
2.1.3 A Public Key Cryptosystem
Imagine a system of users U1, U2, U3, . . . From time to time any pair of users
may need to exchange messages that should remain secret to other users or
outsiders.
In a classical cryptosystem, they should ﬁrst share keys and keep them
secret. A public key system avoids this last restriction: secret pairwise com-
munication becomes possible using only information open to everybody. Such
a system can be devised as follows.
a) Every user Ui choses two large primes pi and qi, and two residue classes
ei, di mod ni, where ni = piqi, such that eidi ≡1 mod ϕ(ni) where
ϕ(ni) = (pi −1)(qi −1) denotes the Euler function (cf. 1.1.4).
b) The numbers (ei, ni) are made public for all users.
We argue that it is unfeasible to calculate di knowing only (ei, ni), so that
di can be considered as a secret known to Ui alone. In fact, we shall show
that an eﬃcient algorithm for calculating di would also ﬁnd eﬃciently the
prime factorization of ni, which we assumed to be diﬃcult. Suppose that
we know di. We then know that ϕ(ni) divides eidi −1. If we knew ϕ(ni)
itself then we could easily ﬁnd pi and qi, since pi + qi = ni + 1 −ϕ(ni)
and pi −qi =

(pi + qi)2 −4ni. One can show that even knowing only a
multiple of ϕ(ni) suﬃces (cf. [Mil76], [Wag86]) to ﬁnd pi and qi.

2.1 Factorization and Public Key Cryptosystems
65
c) Suppose that a user Ui wishes to transmit to Uj a coded message which is
a sequence of bits. He ﬁrst breaks this sequence up into blocks of length
[log2 nj], then considers each block as a residue class m mod nj and ﬁnally
encodes it as the residue class mej mod nj. Thus, (nj, ej) serves as the
encryption key of the jth user (recall that it is common knowledge).
d) Having received the encoded message, Uj decodes any block b mod nj
by computing bdj mod nj (recall that he knows the deciphering key dj).
This is easily checked with the help of Fermat's little theorem (1.1.4).
Clearly, the details of such a scheme can be varied ad inﬁnitum. For ex-
ample, one can devise an authentiﬁcation procedure ("electronic signature")
which uses a form of a secret message from Ui to Uj allowing Uj to convince
a third party (a "judge") that the author of the message is Ui, so that it is not
faked by Uj himself. This can be crucial for certain ﬁnancial transactions.
Denote by Ei the encoding map for messages addressed to Ui and by Di
his deciphering map. Then Ei is public domain while Di is Ui's property. For
an arbitrary plain message M we have Di(Ei(M)) = M and Ei(Di(M)) = M.
The user Ui sending his message M to Uj uses as his signature S = Di(M)
and transmits to Uj its encoded version Ej(S). In his turn, Uj ﬁrst computes
S = Dj(Ej(S) and then M = Ei(S) using the public key Ei. The addressee
can convince a judge that M comes from Ui because only by applying Ei can
one transform S into a given sensible message M. On the other hand, the
addressee cannot fake S since he does not know Di.
We shall concentrate now on the number-theoretical rather than the in-
formation-theoretical aspects of public key cryptosystems. We shall describe
how some classical number-theoretical results can be applied to two particular
problems in this domain.
Problem 1. How does one produce large primes?
We want to stress that we really need an eﬃcient method for mass produc-
tion of "suﬃciently random" large primes, in order to allow a user to compute
(with the assistance of a large computer) his customized pair (pi, qi), and to
be sure that a diﬀerent user will get a diﬀerent pair.
Problem 2. How does one factorize large integers?
This problem is crucial for a third party wanting to break the cryptosystem
and, of course, for the designers wanting to secure its infallibility (cf. [DH76],
[ARS78], [Kah71]).
According to A.Wiles [Wi2000], one change in number theory over the last
twenty years is that it has become an applied subject (Pehaps one should
say it has gone back to being an applied subject as it was more than two
thousand years ago). Public key cryptography has changed the way we look
at secrecy and codes. The RSA system depends on the practical diﬃculty
of factoring a number. The seventeenth century problems of generating large
primes, primality testing and factoring now pose new and precise problems.
How fast can algorithms for answering these questions be? The question of

66
2 Some Applications of Elementary Number Theory
primality testing is solved (cf. §2.2.4, §2.2.6). The other two are not theoreti-
cally solved, although the ﬁrst of the problems seems much easier in practice
than the third.
2.1.4 Statistics and Mass Production of Primes
The asymptotic law of the distribution of primes (or prime number theorem)
is π(x) ∼
x
log x (cf. 1.1.6). We can start then with a naive assumption that if
N is not too small with respect to x then between x and x+N there should be
about N/ log x primes. For example, if the least prime following x is bounded
by x + (log x)M, then one can just check successively x, x + 1, x + 2, . . . . The
complexity of the prime production would then be of the same order as the
complexity of the primality testing algorithm used. If one can take M = 1,
then to produce a prime of order about 2100 one should ﬁrst produce a random
number x of that order, and then test about (log 10100)/2 ≈115 odd integers.
If there is a primality test for y, which is polynomial in log y, then this is a
feasible task.
We shall discuss in the following subsection eﬃcient probabilistic primality
tests.
We should remark however that such absence of large gaps between primes
is not proved and probably is not even true. All known results on the gaps
give upper bounds which are powers of x (see [HB88], [Hild88], [Zag77]). We
quote some of them:
π(x + x7/12) −π(x) = x7/12
log x

1 + O
log log x
log x
4
,
(2.1.2)
π(x + xθ) −π(x) ≥C(θ) xθ
log x
for θ ≥11/20 where C(θ) is a positive function. For almost all x, a stronger
result is known:
π(x + xθ) −π(x) ≥0.15 xθ
log x,
if θ ≥1/12.
For an interesting discussion of large gaps between primes, see [Ries85],
p.84 and [Hild88], [Zag77]).
2.1.5 Probabilistic Primality Tests
Some modern eﬃcient primality tests actually check a weaker property con-
nected with the notion of Eulerian pseudoprimes (cf. §1.1.5). We recall that
n is called an Eulerian pseudoprime modulo b if n and b are relatively prime,
and

2.1 Factorization and Public Key Cryptosystems
67
b(n−1)/2 ≡
 b
n

mod n.
(2.1.3)
Primes are pseudoprimes modulo every b: this follows from the fact that
(Z/nZ)× is cyclic (cf. section 1.1.5). One readily sees that for composite n,
(2.1.3) fails for at least half of the residue classes in (Z/nZ)×. A probabilistic
primality test based upon this observation consists of checking (2.1.3) for, say,
several hundred randomly chosen b. If an n passes such a test it is sometimes
called "a commercial prime". Commercial primes are used in public key cryp-
tosystems although, strictly speaking, their primality is not established by the
test.
It turns out that such a proof could be given if one assumes the generalized
Riemann conjecture on the zeroes of the Dirichlet L−functions. Namely, one
can deduce from this conjecture that the validity of (2.1.3) for all b < 2(log n)2
implies that n is prime (cf. [Mil76], [Wag86]). To check this property, it suﬃces
to perform O((log n)4+ϵ) divisions with remainder, for any ϵ > 0.
This Solovay-Strassen primality test admits some interesting variations,
e.g., the Miller-Rabin test (see [SolSt77]), [Mil76], [Ra80], [Ries85], [Schr84],
[Kob94]). It is based on the following notion of strict pseudoprimality. Suppose
that n is pseudoprime modulo b, so that bn−1 ≡1 mod n. We shall now
calculate all consecutive square roots of the left hand side, that is, b(n−1)/2i
for i = 1, . . . , s where t = (n−1)/2s is odd. If n is prime then the ﬁrst residue
class in this sequence distinct from 1 should be −1. We shall call n strict
pseudoprime if either bt ≡1 mod n or for some 0 ≤r < s we have
b2rt ≡−1 mod n.
(2.1.4)
The Miller-Rabin test consists of checking this property for a set of randomly
chosen b.
It was noticed by F.Morain [Mor03a] that in practice the algorithm of
Miller is quite long, because it needs to compute numerous modular exponents,
and a faster ECPP method is discussed in Section 2.2.6.
In Section 2.2.4 we describe an important recent theoretic discovery that
primes are recognizable in polynomial time: the work of M. Agrawal, N. Kayal
and N. Saxena [AKS] who found that a polynomial version of Fermat's Little
Theorem (1.1.2) leeds to a fast deterministic algorithm for primality testing:
the time of this algorithm is given by 
O(log12 N), where the notation 
O(t(N))
for O(t(n) · poly(logt(N))) is used for a function t(N) of N.
2.1.6 The Discrete Logarithm Problem and The Diﬃe-Hellman
Key Exchange Protocol
The Diﬃe-Hellman key exchange is the ﬁrst public-key cryptosystem ever
published [DH76].

68
2 Some Applications of Elementary Number Theory
In order to communicate an important information to Bob, Alice wish
to use this algorithm as follows: Alice and Bob agree on a prime number p
and an integer g that has order p −1 modulo p. (So gp−1 ≡1 (modp), but
gn ̸≡1 (modp) for any positive n < p −1.) Alice chooses a random number
n < p, and Bob chooses a random number m < p. Alice sends gnmodp to
Bob, and Bob sends gmmodp to Alice. Alice can now compute the secret key:
s = gmn = (gm)n (modp).
Likewise, Bob computes the secret key:
s = gmn = (gn)m (modp).
Now Alice uses the secret key s to send Bob an encrypted version of her
message. Bob, who also knows s, is able to decode the message.
Non-authorized persons can see both gn (modp) and gm (modp), but they
aren't able to use this information to deduce either m, n, or gmn (modp)
quickly enough.
2.1.7 Computing of the Discrete Logarithm on Elliptic Curves
over Finite Fields (ECDLP)
The Abelian group structure on the group of points E(Fp) on an elliptic
curves is used in many arithmetical questions. In particular, the case when
this group is cyclic of large size leads to ECDLP ("Elliptic curve discrete
logarithm problem") which is extremely important for applications in public-
key cryptography, see [Kob87], [Kob98], [Kob01], [Fr01], [Men93], [Kob02].
This idea was independently proposed by Neal Koblitz and Victor Miller in
1985, and since then there has been an enormous amount of research on the
topic. The computational problem on which the security depends is the elliptic
curve discrete logarithm problem: Given an elliptic curve E over a ﬁnite ﬁeld
Fq and two points P, Q ∈E(Fq), ﬁnd an integer λ (if it exists) such that
Q = [λ]P. If the ﬁeld size q is suﬃciently large, and if the elliptic curve E
avoids various special cases, then this seems to be a diﬃcult computational
problem.
Numerous applications of arithmetical algebraic geometry to cryptographic
constructions were discussed in [Fr01], [Men93], and in other good sources:
[Kob2000], where the problem of computing the orders of elliptic curve groups
is discussed in some detail as well. For example, we can learn about the cryp-
tographic signiﬁcance of old number-theoretic questions such as the existence
of inﬁnitely many Sophie Germain primes and Mersenne primes.

2.2 Deterministic Primality Tests
Probablilstic polynomial-time primality tests have been known for many years.
There is a well-known almost-polynomial-time ((log n)log log log n) determinis-
tic algorithm due to Adleman, Pomerance and Rumely (1983) cf. [APR83],
[LeH.80], [CoLe84], and also a randomized algorithms due to Goldwasser-
Kilian, cf. [GK86], [GK99], Atkin-Morain [AtMo93b], and Adleman-Huang
[AdHu92] which give certiﬁcates for both primality and compositeness in ex-
pected polynomial time on all inputs. This method of primality proving using
elliptic curves, the ECPP was further developed by F.Morain, [Mor98a].
In August 2002, a deterministic polnomial-time algorithm was found by
M. Agrawal, N. Kayal and N. Saxena from the IIT Kanpur. Among other
things, we give an exposition of this result in this section.
We describe some deterministic primality tests
a) Adleman, Pomerance and Rumely (1983): they have subexponential run-
ning time, and the proofs that they work are unconditional (i.e. they do
not use any unproved conjectures).
b) A resent discovery that primes are recognizable in polynomial time by M.
Agrawal, N. Kayal and N. Saxena who found that a polynomial version
of Fermat's Little Theorem (1.1.2) led to a fast deterministic algorithm
for primality testing: The time of this algorithme is given by 
O(log12 n),
where the notation 
O(t(n)) for O(t(n)·poly(logt(n))) is used for a function
t(n) of n.
c) Elliptic curves and primality proving, the ECPP (Elliptic Curve Primality
Proving by F.Morain, see [AtMo93b], [Mor98a], [Mor03].
2.2.1 Adleman-Pomerance-Rumely Primality Test: Basic Ideas
There are two main variants of this algorithm cf. [APR83], [LeH.80], [CoLe84]:
a simpler, probabilistic version, and a deterministic one. Its running time is
bounded by
log nc log log log n,
where c is an eﬀective constant. The power in this expression grows so slowly
that this bound can be considered "almost polynomial". All previously known
deterministic primality tests had exponential running time (e.g., Pollard's test,
described in [Pol74], [Ries85], requires about
n
1
8 +ϵ = exp
1
8 + ε

log n

operations).
The algorithm consists of the following steps.

70
2 Some Applications of Elementary Number Theory
a) One checks a series of conditions generalizing the congruence (2.1.3) for
the Jacobi symbol. If n fails to satisfy any of these conditions, then it is
composite.
b) If n passes the ﬁrst stage, the test furnishes a small set of integers con-
taining all divisors r of n not exceeding √n. It remains to check whether
n is divisible by at least one element of this set.
c) The set of potential divisors r is determined by specifying their residue
classes modulo an integer s > √n, which in turn is a product of several
distinct primes q. In view of the Chinese Remainder Theorem (cf. (1.1.5)),
it suﬃces to specify r mod q for all q dividing s.
d) Every q dividing s satisﬁes the following condition: q −1 is a product of
several distinct primes taken from a ﬁxed set {p0, . . . , pk}. These primes
are called the initial primes, and the q are called the Euclidean primes,
because they are constructed by the method used in Euclid's proof that
the set of primes is inﬁnite:
q = 1 + pα0
0 pα1
1 . . . pαk
k , αi = 0 or 1.
To estimate the running-time, one has to use a hard theorem from analytic
number theory (cf. [Pra57]) which guarantees that even for a small set of
initial primes, the product of all Euclidean primes generated by them can
be large. More precisely, given n, one can determine a set of initial primes
{p0, . . . , pk} whose product t is bounded by
t =
k

i=0
pi < log(nc2 log log log n) (n > ee),
(2.2.1)
whereas the product of the corresponding Euclidean primes is bounded
from below by
s =

(q−1)|t
q > √n,
(2.2.2)
where c2 is a computable positive constant. Notice that in this situation
the number of Euclidean primes is bounded by π(t + 1) < t + 1. For any
n ≤10350 one can take t = 2 · 3 · 5 · 7 · 11 · 13 · 17 · 19.
e) To determine r mod q, one actually calculates the discrete logarithms
ind(r, g, q) of all possible r with respect to a ﬁxed generator g of (Z/qZ)×.
These logarithms are in turn determined by their residue classes ind(r, g, q)
mod pi where pi runs over all initial primes. Again, this follow from the
Chinese Remainder Theorem.
We shall now describe the algorithm in more detail.

2.2 Deterministic Primality Tests
71
2.2.2 Gauss Sums and Their Use in Primality Testing
For an odd q, the Euler criterion
 q
n

≡q(n−1)/2 mod n can be rewritten in
the form
n
q

≡(−1)
n−1
2
· q−1
2 q
n−1
2
mod n,
(2.2.3)
which gives a formula for calculating the quadratic residue symbol of n modulo
q. In the algorithm we discuss here, one uses generalizations of this formula
to arbitrary pth power residue symbols for initial primes p. In order to explain
these generalizations, we must introduce Gauss sums, which were initially
used in one of Gauss' proof of the quadratic reciprocity law (cf. below).
One calculates the number of solutions of a congruence xp = a in (Z/qZ)×
with the help of the Dirichlet characters of order p modulo q, that is, the
homomorphisms χ : (Z/qZ)× →C×. Every such character is deﬁned by the
image exp(k · 2πi/p) of a generator g of (Z/qZ)×. The number of such char-
acters is p if p divides q −1, and 1 otherwise. If q is prime, we have
Card{x ∈(Z/qZ)×|xp = a} =

χ|χp=1
χ(a).
(2.2.4)
In particular, for p = 2 this is 1 +
a
q

. The sum in the right hand side of
(2.2.4) vanishes iﬀχ(a) ̸= 1 for some χ. This happens only if p|(q −1) and a
is not a pth power modulo q. If p does not divide q −1, both sides are equal
to 1. Finally, if p|(q −1) and a is a pth power, both sides are equal to p.
One way to understand Gauss sums is to view them as discrete analogues
of the gamma function Γ(s), which for Re(s) > 0 is given by the integral
Γ(s) =
 ∞
0
e−yys dy
y .
(2.2.5)
Here the integrand is the product of an additive quasicharacter of R (the
homomorphism y →e−y) and a multiplicative quasicharacter y →ys of R×
+.
One integrates this over the positive reals with respect to the multiplicative
invariant measure dy
y .
In order to get a Gauss sum, one should replace here R by Z/NZ for some
N > 1; e−y by an additive character Z/NZ →C× : y →ζy
N, ζN = exp
 2πi
n

,
and ys by a multiplicative character χ : (Z/NZ)× →C×. A Dirichlet character
χ : Z →C corresponding to χ and denoted also χ is deﬁned by χ(a) =
χ(a mod N) for (a, N) = 1 and by χ(a) = 0 for (a, N) > 1. The Gauss sum
G(χ) is, by deﬁnition,
G(χ) =
N−1

x=1
χ(x)ζx
n.
(2.2.6)

72
2 Some Applications of Elementary Number Theory
For a ∈Z, the following notation is often used:
Ga(χ) =
N−1

x=1
χ(x)ζax
n .
Since the formulae (2.2.5) and (2.2.6) are obviously similar, they deﬁne func-
tions with many similar properties.
To state them, we need the important notion of a primitive Dirichlet char-
acter. A character χ is primitive modulo N if it is not induced by a character
modulo M for any proper divisor M of N. Equivalently, the restriction of χ to
any subgroup HM = ((1 + MZ)/(1 + NZ))× is non-trivial. If χ is primitive,
we have
Ga(χ) = χ(a)G(χ)
(a ∈Z),
(2.2.7)
G(χ) = χ(−1)G(χ),
(2.2.8)
|G(χ)|2 = N.
(2.2.9)
Property (2.2.7) corresponds to the integral formula
 ∞
0
e−ayys dy
y = a−sΓ(s) (Re(s) > 0),
and (2.2.9), rewritten in the form G(χ)G(χ−1) = χ(−1)N, corresponds to the
functional equation
Γ(s)Γ(1 −s) = −
π
s sin πs.
From (2.2.7)-(2.2.9) one readily deduces the quadratic reciprocity law. Let
us prove, for example, the main formula
 l
q
 q
l

= (−1)
l−1
2 . q−1
2 ,
(2.2.10)
where l and q are odd primes. Notice ﬁrst that the quadratic residue symbol
χ(a) =

a
q

is a primitive Dirichlet character modulo q. The corresponding
quadratic Gauss sum G(χ) is an element of the cyclotomic ring of algebraic
integers R = Z[ζq]. In any commutative ring the congruence (a + b)l ≡al +
bl mod lR holds because the binomial coeﬃcients Ci
l are divisible by l. Since
χl(a) = χ(a) = ±1, we have
G(χ)l ≡Gl(χl) mod lR, Gl(χl) = χ(l)G(χ),
so that

2.2 Deterministic Primality Tests
73
G(χ)l−1 ≡
 l
q

mod lR.
(2.2.11)
On the other hand, χ = χ, and from (2.2.9) it follows that
G(χ)2 = χ(−1)q = (−1)
q−1
2 q.
(2.2.12)
Representing the left hand side of (2.2.11) as G(χ)2 l−1
2
we obtain
(−1)
q−1
2
. l−1
2 q
l−1
2
≡
 l
q

mod lR.
(2.2.13)
Finally, (2.2.13) and Euler's criterion
q
l−1
2
≡
 l
q

mod l
give (2.2.10).
For Z/NZ, there is also an analogue of the beta-function
B(s, t) =
 1
0
xs−1(1 −x)t−1dx =

R×
+
ys
(1 + y)s+t
dy
y
(Re(s), Re(t) > 0).
It is called the Jacobi sum depending on two Dirichlet characters χ, ψ mod N.
By deﬁnition,
J(χ, ψ) =

x mod
N
χ(x)ψ(1 −x) =

y mod
N
χ(y)(χψ)(1 + y).
(2.2.14)
(The equality of these two expressions can be established by the change of
variables y(1 −x) →x, x(1 + y) →y). If χ, ψ, and χψ are primitive modulo
N, we have
J(χ, ψ) = G(χ)G(ψ)/G(χψ) = J(ψ, χ),
(2.2.15)
which corresponds to the classical identity B(s, t) = Γ(s)Γ(t)/Γ(s + t). In
fact, let us calculate the product
G(χ)G(ψ) =

x mod
N
χ(x)ζx
nG(ψ) =

x mod
N
χψ(x)ζx
nψ(x)G(ψ).
(2.2.16)
Applying (2.2.7), we get
ψ(x)G(ψ) = Gx(ψ) =

y mod
N
ζxy
N ψ(y)

74
2 Some Applications of Elementary Number Theory
so that (2.2.16) becomes

x,y mod
N
(χψ)(x)ψ(y)ζx(1+y)
N
=

y mod
N
ψ(y)G1+y(χψ) =

y mod
N
ψ(y)(χψ)(1 + y)G(χψ) = J(ψ, χ)G(χψ).
We now establish some congruences useful in primality testing. Let p and
q be primes, p|(q −1), χ a Dirichlet character of degree p modulo q. Choose a
generator t = tq of (Z/qZ)× and put ηp = χ(tq). This is a primitive pth root
of unity, and G(χ) ∈R = Z[ζp, ζq] = Z[ζpq]. Now let l be a prime distinct
from p and q. From (2.2.7) one deduces that
G(χ)l ≡χ(l)−lG(χl) mod lR.
(2.2.17)
Iterating this p −1 times, we obtain
G(χ)lp−1 ≡χ(l)−lp−1G(χlp−1) mod lR,
so that
G(χ)lp−1−1 ≡χ(l)−1 mod lR,
(2.2.18)
because lp−1 ≡1 mod p. Now (2.2.18) can be rewritten in the form
(G(χ)p)(lp−1−1)/p ≡χ(l) mod lR
which generalizes the formula (2.2.13).
It is important that G(χ)p belongs to the smaller ring Z[ζp] (for p = 2,
this is just Z). Moreover, it can be expressed via Jacobi sums: for p > 2 we
have
G(χ)p = χ(−1)q
p−2

i=1
J(χ, χi).
(2.2.19)
To prove this identity, it suﬃces to multiply termwise the formulae
G(χ)G(χi)
G(χi+1)
= J(χ, χi) (i = 1, 2, . . . , p −2)
taking into account (2.2.8) in the form G(χp−1)G(χ) = G(χ)G(χ) = χ(−1)q.
One uses (2.2.19) in conjunction with a congruence due to Iwasawa ([Iwa75],
Theorem 1):
J(χa, χb) ≡−1 mod (λ)2,
where (λ) = (1 −ζp) is a prime ideal of Z[ζp]. Therefore,
G(χ)p ≡−χ(−1)q mod (λ)2,
(2.2.20)
which becomes an exact equality for p = 2.

2.2 Deterministic Primality Tests
75
2.2.3 Detailed Description of the Primality Test
a) In the preliminary stage (cf. section 2.2.1 d), one calculates the number
t = k
i=0 pi which is the product of the initial primes satisfying (2.2.1)
and (2.2.2):
t < log nc2 log log log n,
s =

q,q−1|t
q > √n.
As we have already mentioned, for n ≤10350 we can take t = 2 · 3 · 5 ·
7 · 11 · 13 · 17 · 19. In general, to ﬁnd t one uses a trial-and-error method,
and the primality of the Euclidean primes is tested by the primitive case-
by-case check. Since each q is bounded by t + 1, and the number of q's
is bounded by π(t + 1) < t + 1, this preliminary stage requires no more
than log nc3 log log log n operations, with an eﬀective positive constant c3.
At this stage, one should also check that (n, s) = (n, t) = 1 (otherwise n
is composite, and the algorithm stops).
b) The necessary conditions of primality, essentially of the type (2.2.18), are
then checked for every pair p, q with p|(q −1), q|s, and every Dirichlet
character χ mod q of degree p. It is convenient to ﬁx p and vary q. For
each q, one calculates a generator tq of (Z/qZ)×. The Dirichlet charac-
ters correspond to primitive roots of unity ηp. The primality condition
corresponding to (p, q, χ) is
G(χ)np−1−1 ≡η(χ) mod nR,
(2.2.21)
where η(χ) is a pth root of unity (for prime n, η(χ) = χ(n), in view of
(2.2.18)). To check (2.2.21), one expands the left hand side with respect
to the Z−basis of R = Z[ζp, ζq] and compares it with the right hand side
coordinate-wise.
c) If all the congruences (2.2.21) hold true, one calculates a set containing
virtual prime divisors r of n not exceeding √n. We shall ﬁrst explain how
this is done in the simplest case when np−1 −1 is not divisible by p2 for
any p. Then we have simply
r ≡ni(mod s) for some i ∈{0, 1, . . . , t}.
In fact, if r|n, put
lp(r) ≡(rp−1 −1)/(np−1 −1) mod p, lp(r) ∈Z/pZ.
(2.2.22)
Then
lp(rr′) = lp(r) + lp(r′), lp(n) = 1.
(2.2.23)
If r is prime, it follows from (2.2.18) that

76
2 Some Applications of Elementary Number Theory
G(χ)rp−1 ≡χ(r)−1 mod rR.
Let us write (rp−1 −1)/(np−1 −1) in the form a/b where b ≡1(mod p),
so that lp(r) ≡a(mod p). From (2.2.21) and (2.2.22) it follows that
χ(r) = χ(r)b ≡G(χ)b(rp−1−1) ≡G(χ)a(np−1−1) ≡η(χ)a mod rR,
and ﬁnally
χ(r) = η(χ)lp(r)
(r > 2).
(2.2.24)
The additivity property (2.2.23) then shows that (2.2.24) holds for all
divisors of n, not only the prime ones. In particular, for r = n, we ﬁnd
η(χ) = χ(n), because lp(n) = 1.
Summarizing, we established, that if np−1 −1 is not divisible by p2, then for
any triple (p, q, χ) we have
χ(r) = χ(n)lp(r),
so that r ≡ni mod q where i ≡lp(r) mod p for all p.
d) In general, we have np−1 −1 = phu, h ≥1, p does not divide u. The
calculations become longer, but the running time is still bounded by
log nc log log log n for a possibly larger constant c. Again, for every triple
(p, q, χ) we have the congruence (2.2.21):
G(χ)phu ≡η(χ) mod nR, h = h(p, q, χ) ≥1.
Let us deﬁne w(χ) as the smallest i ∈{1, 2, . . . , h} such that G(χ)piu
is congruent to a power of ζp modulo nR. If w(χ) ≥2, the number
G(χ)pw(χ)−1u = (G(χ)p)pw(χ)−2u belongs to the ring Z[ζp] with the Z−basis
{1, ζp, . . . , ζp−2
p
}. At this stage, one must check the following auxiliary con-
dition:
for every j ∈{0, 1, . . . , p −1}, at least one
(2.2.25)
of the coefficients of
G(χ)pw(χ)−1u −ζj
p
with respect to this basis is relatively prime to n.
If this assertion is wrong, n is composite, because it has a non-trivial
common divisor with one of the coeﬃcients. Otherwise, one can prove,
as above, that rp−1 ≡1(mod pw(χ)) for all r|n, and that for all triples
(p, q, χ) with a given q one has
χ(r) = χ(νj) for a certain i ∈{0, 1, . . . , t},
(2.2.26)
where ν mod q is the uniquely deﬁned residue class for which

2.2 Deterministic Primality Tests
77
χ(ν) = η′(χ), η′(χ) ≡G(χ)pw(χ)u mod nR.
(2.2.27)
One can also determine the root of unity χ(ν) ∈Z[ζp] using Jacobi sums
(cf. [LeH.80]). Choose a, b ∈Z such that
p2 does not divide ab(a + b), p2 does not divide ((a + b)p −ap −bp)
(e.g., a = b = 1 for p < 3.109, p ̸= 1093, 3511). Using (2.19), one can
prove then that
ν(χ) ≡J(χa, χb) mod nZ[ζp].
e) We must now synthesize all the calculations to obtain a residue class ν
modulo s such that every potential divisor r|n, r < √n, satisﬁes a congru-
ence r ≡νi mod s for some 0 ≤i ≤t. In view of the Chinese Remain-
der Theorem, it suﬃces to determine for every q|s a power k such that
ν ≡tk
q mod q. To this end, we choose for every p|(q −1) a character χ
with χ(tq) = ζp. From (2.2.27) it follows that χ(tk
p) = ζk
p = η′(χ), which
deﬁnes k mod p and ﬁnally ν mod s.
f) It remains to check whether one of the numbers ri deﬁned by
ri ≡νi mod s, 0 ≤ri < s, 0 ≤i ≤t,
actually divides n.
A number n which passes all these checks is prime. In practice, this algo-
rithm is quite fast (cf. [CoLe84], [Vas88]).
Primality testing can often be speeded up by the following elementary
observation. If s is a square-free divisor of n −1, and if for every qi|s there
exists such an ai ∈(Z/nZ)× that
gcd(a(n−1)/qi
i
−1, n) = 1, an−1
i
≡1 mod n,
(2.2.28)
then each prime divisor p of n is congruent to 1 modulo s. In fact, from (2.2.28)
it follows that the order of a(n−1)/qi in (Z/pZ)× is equal to qi. Since qi|(p−1),
we have s|(p −1). In particular, if s > √n, then n is prime. Of course, to
apply this observation, one must know a suﬃciently large divisor s of n −1.
A variant of this idea is used in some related primality tests in [LeH.80],
[GK86], and in the ECPP, see section 2.2.6. This trick was also used in a proof
that R1031 is prime [WD86], where Rn = (10n −1)/9. It is known that for
lesser values of n, only R2, R19, R23, and R317 are prime. A very nontrivial
prime decomposition of R71 was given in the equality (2.1.1).
Since the work of Goldwasser and Kilian, a general primality test was de-
velopped by Atkin-Morain which has probably polynomial time (see [AtMo93b],
and the end of this section for a discussion of the ECPP (Elliptic Curve Primal-
ity Proving). Adleman and Huang in [AdHu92] modiﬁed Goldwasser-Kilian
algorothm to obtain a randomized polynomial-time algorithm that always
produced a certiﬁcate for primality.

78
2 Some Applications of Elementary Number Theory
2.2.4 Primes is in P
manindra@cse.iitk.ac.in, kayaln@iitk.ac.in,
nitinsa@cse.iitk.ac.in
Let us describe now a resent discovery that primes are recognizable in
polynomial time. This is the work of M. Agrawal, N. Kayal and N. Saxena
who found that a polynomial version of Fermat's Little Theorem (1.1.2) led to
a fast deterministic algorithm for primality testing: the time of this algorithme
is given by 
O(log12 n), where the notation 
O(t(n)) for O(t(n) · poly(logt(n)))
is used for a function t(n) of n.
The algorithm is based on the following polynomial version of Fermat's
Little Theorem (1.1.2):
Theorem 2.1. Let p be an integer, and a an integer such that gcd(a, p) = 1.
Then p is a prime iﬀ(x −a)p ≡xp −a(modpZ[x]).
Let n be the given number whose primality or compositeness is to be
determined. If n is prime then obviously the test
Test(a, r) : (x −a)n ?≡xn −a(mod(xr −1, n)
(2.2.29)
will succeed (give the answer "true") for all integers a and r. The result of
Agrawal-Kayal-Saxena says that conversely, if Test(a, r) is true for all integers
a and r in the range 0 < r ≪log6 n, 0 < a ≪log4 n, and n has no prime
factors ≪log4 n, then n is prime or a power of prime. Here and from now on
all constants implied in the sign ≪are absolute).
Since performing Test(a, r) takes time ar most O(r2 log3 n), or even
O(r1+ε log2+ε n), if FFT is used for multiplication of polynomils and of num-
bers modulo n, this gives a deterministic polnomial-time algorithm as desired,
since obviously checking that n is non-trivial power can be done in polynomial
time. Recall that the Fast Fourier Transform (FFT) is a fast algorithm which
reduces the number of multiplications of coeﬃcients needed for of the multi-
plication of polynomials of degree r from O(r2) to O(r log r), and the FFT
reduces the time of multiplication of two integers modulo n from O(log n2)
to O(log n log log n). In fact, the result actually proved by them is somewhat
stronger: one can ﬁnd in a deterministic way a single number r ≪log6 n for
which the validity of Test(a, r) for all a ≪log4 n suﬃces to imply the pri-
mality of n. This improves the maximal running time of the algorithm from
O(log18+ε n) to O(log12+ε n). The actual running time on a well known hy-
pothesis on the density of Sophie Germain primes is in fact only O(log6+ε n)
(Sophie Germain primes are odd primes q such that r = 2q+1 is also a prime):
Conjecture 2.2 (On the density of the Sophie Germain primes).
#{ q ≤x | q and 2q + 1
are primes} ∼C ·
x
log2
2x

2.2 Deterministic Primality Tests
79
Noice that there is an obvious analogy with the asymptotic law of the distri-
bution of primes (1.1.14) (the density of all primes less or equal to x):
#{ q ≤x | q is prime} ∼K ·
x
log2x
More presisely, the results of Agrawal-Kayal-Saxena, which imply the
above statements, are as follows. Here P(m) denotes the largest prime di-
visor of an integer m ond or(m) the order of m(modr), where r is any prime
not dividing m.
Proposition 2.3. For any n, there is a prime r ≪log6 n such that P(or(n)) ≥
2√r log n
Proposition 2.4. Let n be an integer and r ∤n a prime satisfying
(a) P(or(n)) ≥l,
(b) Test(a, r) is true for a = 1, 2, . . . , l,
(c) n has no prime factors < l,
where l = 2√r log n. Then n is a power of a prime number.
The proof uses a result of Fouvry [Fou85], and Baker-Harman [BaHa96],
which says that P(r −1) > r2/3 for a positive proportion of all primes r.
This result, proved with sieve theory, is diﬃcult but not surprising since it
is easy to see that P(m) > m2/3 (or even P(m) > mc for any ﬁxed c < 1)
for a positive proportion of all integers m. (The number of m ≤x having a
prime factor q > xc for c ≥1
2 is

xc<q≤x
qprime
[x/q], which is asymptotically equal
to log(1/c)x for x large.) We will show that, for C suﬃciently large absolute
constant, there exists for every n a prime number r satisfying
(2 log n)6 ≤r ≤(C log n)6, or(n) > r1/3, P(r −1) > r2/3.
(2.2.30)
Indeed, by the result just quoted, the number of primes r < x = (C log n)6
with P(r −1) > r2/3 is at least cπ(x) ∼c C6 log n6
6 log(Cn), where c is an absolute
constant. The number of primes < (2 log n)6 is ≪(log n)6
log log n, and the number of
r ≤x with or(n) ≤r1/3 is ≪C4 log n5
log log n , since all these r divide the number
N := x1/3
j=1 (nj −1), and
number of prime factors of N is ≪
x1/3

j=1
j log n
log(j log n) ≪x2/3 log n
log log n = C4 log n5
log log n .
It follows that for C suﬃciently large there are ≫
log n6
log log n primes satisfying
(2.2.30). Let r be such a prime and q = P(r −1). Then q is a prime dividing

80
2 Some Applications of Elementary Number Theory
r −1 but not (r −1)/or(n) (since (r −1)/or(n) < r2/3 < q ), so q divides
or(n) and P(or(n)) ≥q ≥r2/3 ≥2√r log n
⊓⊔
The idea of the proof of Proposition 2.4 is to consider the integers nipj
and nkpl, and to show that there exist two diﬀerent couples (i, j) and (k, l)
such that nipj ≡nkpl( mod r).
Set q = P(or(n)). Since q is a prime, q must divide or(n) for some prime
divisor p of n. The ﬁeld extension K = Fp[ζ], where ζ is a non-trivial rth root
of unity, has degree d = or(p) ≥q. Let G be the subgroup of K× generated
by ζ −1, ζ −2, . . . , ζ −l. Then we have
|G| ≥
d + l −1
l

(2.2.31)
because the elements (ζ −1)d1(ζ −2)d2 . . . (ζ −l)d1 (dl ≥0,  di < d) of G are
distinct. (The linear functions x −1, . . . , x −l are distinct irreducible polyno-
mials modulo p because of assumption (c), and ζ cannot satisfy a polynomial
equation of degree < d.) On the other hand, we claim that
|G| < n2√r
(2.2.32)
if n is not a power of p, and this proves the proposition since (2.2.31) and
d ≥q ≥l imply
|G| ≥
d + l −1
l

≥
2l −1
l

> el = n2√r.
To prove (2.2.32), we denote by σs (s ∈Z) the automorphism of K induced
by ζ →ζs. We have σp(g) = gp for any g ∈K× and σn(g) = gn for any
g ∈G by virtue of assumption (b), so σs(g) = gs for any s in the form npj.
Let S = {npj | 0 ≤i, j ≤√r}. If n is not a power of p, then these elements
are all distrinct, |S| > r and we can ﬁnd s ̸= s′ ∈S with s ≡s′(modr). But
then gs = σs(g) = σs′ = gs′. Taking for g a generator of the cyclic group G
we deduce from this that |G| ≤|s −s′| < n2√r, as desired.
⊓⊔
The algorithm to check primality is therefore as follows. First check that no
root n1/k(2 < k ≤log2 n) is integral. Then check succesive primes r > 4 log2 n
until one is found for which r −1 has a prime factor q ≥2√r log n with
n(r−1)/q ̸≡1(modr). By Proposition 2.3 the smallest such r is ≪log6 n. Now
check (b) and (c) of Proposition 2.4; n is prime if and only if both hold.
Remark 2.5. It seems that the smallest r satisfying the condition of Propo-
sition 2.3 is not only ≪log6 n, but is very close to the minimum possible
value r0 = [4 log2]. For instance, a two-line PARI program checks that for
n = 10300 + 1, already 1908707, the second prime ≥r0, works and that for
n = 10j + 1(j ≤300) one never needs to try more than 10 primes, or to go
further than r0 + 186, before achieving success. (Total computation time is
about 2 seconds on a SUN work station).
The given version is due to Dan Bernstein, who slightly improved the
original version of August 6, 2002; his contribution is the use of the inequality
d+l−1
l

≥n2√r, cf. [Mor03], [Ber03], and [Mor03a].

2.2 Deterministic Primality Tests
81
2.2.5 The algorithm of M. Agrawal, N. Kayal and N. Saxena
(see [AKS], p.4), and [Mor03a], p. 4.)
Input: integer n > 1
1. if (n is of the form a ab, b > 1) output COMPOSITE;
2. r := 2;
3. while (r < n) {
4.
if (r is prime)
5.
if r divides n output COMPOSITE;
6.
find the largest prime factor q of r −1;
7.
if (q ≥4√r log2 n) and n
r−1
q
̸≡1
mod r ;
8.
break;
9.
r := r + 1;
10. }
11. for a = 1 to 2√r log2 n
12.
if ((x−a)n ≡(xn−a) mod (xr−1, n).) output COMPOSITE;
13. output PRIME;
Theorem 2.6. The algorithm produce PRIME if and only if n is prime.
Remark 2.7. Practically, one can certainly ﬁnd r of the size O((log n)2) in
order to satisfy the conditions in the algorithm. This leads to the estimate of
the complexity ˜O((log n)6) in the best case.
2.2.6 Practical and Theoretical Primality Proving. The ECPP
(Elliptic Curve Primality Proving by F.Morain, see [AtMo93b])
The questions of practical primality proving of numbers with thousands of
digits and the questions of the mass production of large primes are discussed
in [Mor03a].
It is noticed by F.Morain that even the algorithm of Miller is already
long, because it needs to compute numerous modular exponents. The quantity
(log n)6 in AKS gives an idea of the order of the degree of polynomials with
which one needs to work. In practice, it is almost certain that one can ﬁnd
an r = c(log2 n)6 with c ≥64. For example, if n = 2512, then in the most
optimistic case r = 64(log2 n)6 = 224 > 16 · 106, leading to manipulate with
dense polynomials containing more than 1 Gbytes, which is already rather
diﬃcult.
Suppose that we wish to prove the primality of the number n = 109 + 7
(which is a prime). Using an implementation of AKS by E.Thomé with GMP
4.1 on a PC with 700 MHz, one takes r = 57287 which leads to s = 14340 (see
[Mor03a]). Each intermediate computation takes 44 seconds, giving a total
time of more than 7days. If one uses directly the condition (2.2.29), one can
take (r, q, s) = (3623, 1811, 1785), and this takes 1.67 × 1785 seconds or about

82
2 Some Applications of Elementary Number Theory
49 minutes. The best triplet is (r, q, s) = (359, 179, 4326), leading to a total
time of 6 minutes and 9 seconds.
One could compare these algotithms with the algorithm using Jacobi sums
(cf. [Coh96] for a presentation of this algorithm which is close to one presented
in Section 2.2.1), and with another eﬃcient algorithm, the ECPP (Elliptic
Curve Primality Proving) by F.Morain.
The ECCP produces really rapidly a certiﬁcate (in O((log n)4)) using ellip-
tic curves E over Z/nZ, and using an elementary observation on congruences
(2.2.28) adopted to the groups like E(Z/nZ). Such a certiﬁcate is the program
which produces a long list of numbers that constitute the proof of primality for
that number. In brief, a decreasing sequence of primes is built, the primality
of the successor in the list implying that of the predecessor.
The ECCP can even prove the primality of numbers in 512 bits in 1 sec-
onde, and that of 1024 bits in 1 minute, and that for 10000 bits in a rea-
sonable time (of about one month). According to [Mor03a], it seems that
even if one succeed to lower the number r in the algorithm AKS, it will not
produce an algorithm, which is practically more eﬃcient than the ECPP, cf.
http://www.lix. polytechnique.fr/Labo/Francois.Morain/Prgms/
ecpp.english.html.
2.2.7 Primes in Arithmetic Progression
An important recent discovery in [GrTa] by B.J. Green and T.Tao says
that the primes contain arbitrary long arithmetic progressions (cf. [Szm75],
[Gow01], but also http://primes.utm.edu/top20/ for interesting numerical
examples of long arithmetic progressions of consecutive primes).
It was a well-known classical folklore conjecture that there are arbitrarily
long arithmetic progressions of prime numbers. In Dickson's History of the
Theory of Numbers [Dic52] it is stated that around 1770 Lagrange and Waring
investigated how large the common diﬀerence of an arithmetic progression of
L primes must be.
It was proved in [GrTa] that there are arbitrarily long arithmetic progres-
sions of primes. There are three major ingredients. The ﬁrst is Szemerédi's
theorem, which asserts that any subset of the integers of positive density con-
tains progressions of arbitrary length. The second is a certain transference
principle. This allows one to deduce from Szemerédi's theorem that any sub-
set of a suﬃciently pseudorandom set of positive relative density contains
progressions of arbitrary length. The third ingredient is a recent result of
Goldston and Yildirim, cf. [GoYi03]. Using this, one may place the primes
inside a pseudorandom set of "almost primes" with positive relative density.
It was found in 1993 by Moran, Pritchard and Thyssen (cf. [MPTh]) that
11410337850553+4609098694200k is prime for k = 0, 1, ..., 21. In 2003, Markus
Frind found the rather larger example 376859931192959 + 18549279769020k
of the same length. Main theorem of [GrTa] resolves the above conjecture.

2.2 Deterministic Primality Tests
83
Theorem 2.8 (Theorem 1.1 of [GrTa]). The prime numbers contain arith-
metic progressions of length k for all k.
A little stronger result was established:
Theorem 2.9 (Theorem 1.2 of [GrTa]). Let A be any subset of the prime
numbers of positive relative upper density, thus
lim sup
N→∞
π(N)−1|A ∩[1, N]| > 0,
where π(N) denotes the number of primes less than or equal to N. Then A
contains arithmetic progressions of length k for all k.

2.3 Factorization of Large Integers
2.3.1 Comparative Diﬃculty of Primality Testing and
Factorization
Let n > 1 be an integer. The problem of ﬁnding integers a, b > 1 with n =
ab can be divided into two steps: ﬁrst, to establish their existence (this is
solved by any primality test), second, to ﬁnd them explicitly (factorization).
In practice, the primality test described in §2.2.1 does not give a concrete
divisor of n. In fact, when n fails such a test, it usually fails already one of
the necessary conditions in §2.2.3 b), so that the algorithm stops before we
come to the stage of calculating potential divisors. Therefore, this algorithm
factorizes only primes and those n which admit small divisors, namely, divisors
of the numbers s and t, deﬁned in §2.2.1.
As we mentioned in §2.1, an eﬃcient factorization algorithm could be used
for breaking a standard public key cryptosystem. For this reason, factorization
has become an applied problem, attracting considerable eﬀort and support
([Pet85], [Sim79], [Kob94]). However, the running times of the best known
factorization algorithms do not allow one to factorize a product n of two 150-
digit (decimal) primes. The theoretical bound (cf. [Coh2000]) for this running
time is of order
exp

3
 
64
9 log n · (log log n)2

,
(2.3.1)
and for a 300-digit n they may require billions years. This made Odlyzko ask
whether we now see the actual level of diﬃculty of the factorization problem
or whether we are just overlooking something essential, cf. [Pet85].
Anyway, the progress in factorization of some concrete large integers
([Wun85], [Wag86]) relied more on the new hardware or parallel computa-
tion schemes, than on the discovery of conceptually new algorithms, cf. more
recent developments in [Ma99].
2.3.2 Factorization and Quadratic Forms
If n = x2−y2, then x−y is in most cases a non-trivial divisor of n. This simple
remark leads to the "Fermat factorization algorithm" which generally requires
O(n1/2) operations but is more eﬃcient if n is a product of two numbers t, s
with a small diﬀerence. Then n = x2 −y2 where x = (t + s)/2, y = (t −s)/2.
The algorithm consists of calculating x2−n for x starting with [√n]+1 until a
perfect square is found. Similar considerations can be useful in other problems
([Bril81]). One can also generalize this trick and use other quadratic forms in
factorization algorithms ([Kob94], [Ries85]).
Consider an imaginary quadratic ﬁeld Q(√−n). Let n be square-free. De-
note by Cl(∆) the ideal class group of this ﬁeld (cf. §1.2.8, §4.2.2). The ele-
ments of this group may be identiﬁed with the classes under Z-equivalence of

2.3 Factorization of Large Integers
85
the primitive, positive deﬁnite quadratic forms f(x, y) = ax2 +bxy +cy2 with
negative discriminant ∆= b2 −4ac, where ∆= −n if n ≡3 mod 4, ∆= −4n
if n ≡1 mod 4. (Here we assume n to be odd). Denote by α = (a, b, c) such
a form. We shall call α ambiguous if it belongs to one of the types (a, 0, c),
(a, a, c) or (a, b, a) ([Gau], [Shan71]). The discriminant of an ambiguous form
has the explicit factorization: −∆= 4ac (resp. a(4c −a), (2a −b)(2a + b))
for α = (a, 0, c) (resp. (a, a, c), (a, b, a)). One easily sees that a converse state-
ment is also true (cf. [BS85]): a factorization of ∆of this type determines an
ambiguous form. On the other hand, there are independent methods for con-
structing ambiguous forms which are based on the following property: they
represent elements of order two in the class group Cl(∆). In 1971 D.Shanks
devised a rather fast algorithm allowing one to factorize n in O(n1/4) opera-
tions and to determine the structure of the group Cl(∆). This method uses
the analytic formula due to Dirichlet:
L(1, χ∆) = πh(∆)

|∆|
(h(∆) = |Cl(∆)|).
Here χ∆(m) =
 ∆
m

, and L(1, χ∆) is the value at s = 1 of the Dirichlet
L-function
L(s, χ) =
∞

m=1
χ(m)m−s =

p
(1 −χ(p)p−s)−1.
The approximate formula
h(∆) ≈

|∆|
π
P

p=2
p
p −

∆
p

is valid with a relative error < 0.1% for P ≥132000. The elements of the class
group are constructed with the help of small primes p such that

∆
p

= 1.
They are represented by the forms Fp = (p, Bp, Cp) whose coeﬃcients satisfy
the discriminant relation ∆= B2
p −4pCp and are found from the condition
∆≡B2
p mod p. Knowing the class number h(∆) = |Cl(∆)|, we can construct
the second order elements starting with x = Fp, calculating its maximal odd
power dividing h(∆), and then consecutively squaring until we get 1.
2.3.3 The Probabilistic Algorithm CLASNO
(cf. ([Pom87], [Sey87]). The idea of using Cl(∆) in factorization algorithms
can be considerably improved. In this algorithm, one bypasses the calculation
of h(∆), and the running time is estimated by L = exp(√log n · log log n),
which grows slower than any positive power of n. Assume ﬁrst that the prime
divisors of h(∆) are small, or, rather, that h(∆) divides k! for a small k.

86
2 Some Applications of Elementary Number Theory
Take a random element x ∈Cl(∆), say, x = Fp for some p with

∆
p

= 1
and calculate Bk = xodd power of k!. Then an element of order 2 should be
contained in the sequence of consecutive squares of Bk. We need not know
the exact value of k; we just hope that some small k will do. If we succeed,
we factorize ∆in O(k) operations. If we fail, we can try the same trick for the
ﬁeld Q(√−an) where a is a small square-free number.
In order to justify this procedure in general, one assumes that for variable
a, the class number h(∆a) of Q(√−an) behaves like a random number varying
in a neighbourhood of n1/2 (this estimate follows from the Dirichlet formula).
One can then estimate the probability that h(∆a) will be composed of only
small primes. To this end, denote by Ψ(x, y) the number of natural numbers
≤x not divisible by any prime ≥y (they can be called "y-smooth"). Put
k = Lα, α > 0. The probability that a random number of order n1/2 is
Lα-smooth is Ψ(n1/2, Lα)/n1/2. We must now understand the behavior of
Ψ(x, y)/y. Dickman (cf. in [Hild86]) has shown that this depends essentially on
the value of log x/ log y. Namely, for every u > 0 the limit limy→∞Ψ(yu, y)/y
exists. This limit is called the Dickman function ρ(u) and is uniquely deﬁned
by the following properties:
for 0 ≤u ≤1, ρ(u) = 1,
for u > 1, ρ′(u) = −ρ(u −1)
u
.
At u = 1, ρ(u) is continuous. As u →∞, ρ(u) = u(−1+o(1))u. De Bruijn (de
Bruijn N.G. (1951)) proved that
Ψ(yu, y) = yuρ(u)

1 + Oϵ
log(y + 1)
log y

,
where y ≥2, 1 ≤u ≤(log y)3/5−ϵ with a positive ϵ.
In our case, however, Lα grows slower than any positive power of n so that
Dickman's theorem is not applicable. The necessary estimate has recently been
obtained:
Ψ(n1/2, Lα) = n1/2/L(1/4α)+o(1).
For more details, see [Hild86].
Returning to the factorization algorithm under discussion, one sees that
its running time for a given k = [Lα] is bounded by Lα and the probability of
success is about L−1/4α. Hence the total number of attempts should be about
L1/4α, and the total running time will be bounded by Lα+(1/4α)+ϵ, ϵ > 0. This
estimate is minimized by choosing α = 1/2 (i.e. k = L1/2), and the result is
then L1+ϵ. Of course, theoretically we may get stuck on an especially bad n,
but this is quite improbable.
Let us illustrate the estimate
x
Ψ(x, y) ≈u−u when u is much smaller than
y (for a simple proof of this see [Kob87], p. 137). For example, take y ≈106

2.3 Factorization of Large Integers
87
(so that π(y) ≈7.104 and log y ≈14) and x ≈1048. Then the fraction of
natural numbers ≤x which are products of primes ≤y is about 1/224.
2.3.4 The Continued Fractions Method (CFRAC) and Real
Quadratic Fields
(cf. [Kob94], [Wun85], [Ries85], [Wil84]) . Improving the Fermat factorization
method, let us try to seek solutions x, y of the congruence x2 ≡y2 mod n such
that x is not congruent to ±y mod n. Then gcd(x + y, n) or gcd(x −y, n)
is a non-trivial divisor of n because n divides (x + y)(x −y) but neither
x + y nor x −y. Let us look for x among products of such numbers xi that
the residue x2
i mod n with the smallest absolute value is a product of small
primes. Then y will also be a product of these primes. More precisely, consider
a set B = {p1, p2, . . . , ph} all of whose elements are primes, except possibly p1
which can be −1. Let us call such a set a factorization basis for n. We shall
refer to any integer b such that the residue of b2 mod n with the smallest
absolute value is a product of (powers of) elements of B as a B-number. Let
xi be a family of B-numbers, ai = h
j=1 pαij
j
the respective minimal residues
of x2
i mod n. Put
ϵi = (ϵi1, ϵi2, . . . , ϵih) ∈Fh
2, where ϵij ≡αij mod 2.
Suppose that the sum of vectors ϵi vanishes mod 2. Put
x =

i
xi mod n,
y =
h

j=1
pγj
j ,
where
γj = 1
2

i
αij.
Then x2 ≡y2 mod n.
Example 2.10. ([Kob87], p. 133). Let n = 4633, B = {−1, 2, 3}. Then x1 =
67, x2 = 68, x3 = 69 are B-numbers, because
672 ≡−144 mod 4633,
682 ≡−9 mod 4633,
592 ≡128 mod 4633.
Moreover, ϵ1 = (1, 0, 0), ϵ2 = (1, 0, 0), ϵ3 = (0, 1, 0), so that we can put x =
x1x2 = 67.68 ≡−77 mod 4633, c = 2γ23γ3 = 2332 = 36. Besides, −77 is not
congruent to ±36 mod 4633. Summarizing, we obtain a non-trivial divisor
41 = gcd(−77 + 36, 4633) of n = 4633.
Of course, if we are unlucky, it may happen that x ≡±y mod n. Then
one should choose a new xi or even a new B. An eﬃcient method for seeking
B-numbers utilizes continued fractions of real quadratic irrationalities. Let

88
2 Some Applications of Elementary Number Theory
x > 1 be a real number, x = [a0, a1, . . . ] its continued fraction expansion.
Put Ai/Bi = [a0, a1, . . . , ai]. These convergents can be calculated from the
relations A−2 = B−1 = 1, A−1 = B−2 = 0 and Ai = aiAi−1 + Ai−2, Bi =
aiBi−1 + Bi−2. From the relation
Ai
Bi
−Ai+1
Bi+1
= (−1)i+1
1
BiBi+1
it follows that
|A2
i −x2B2
i | < 2x,
(2.3.2)
because
|A2
i −x2B2
i | = B2
i

Ai
Bi
−x
 .

Ai
Bi
+ x
 < B2
i
1
B1B2

2x +
1
B1B2

.
In particular, we can ﬁnd the continued fraction expansion of x = √n with
the help of the algorithm described in §1.4, and ai form a periodic sequence.
Since A2
i ≡A2
i −nB2
i mod n, (2.3.2) shows that the absolute value of the
smallest residue of A2
i mod n is bounded by 2√n which can help in looking
for B-numbers. However, Ai quickly become large even with respect to n, and
to facilitate the calculation of A2
i mod n one can use the congruence
A2
i−1 ≡(−1)iQi mod n,
(2.3.3)
where Qi is the denominator of xi = (√n + Pi)/Qi, of A2
i mod n, that is,
√n = [a0, a1, a2, . . . , ai, xi].
In fact, applying formally the recurrence relations to √n we get
√n = x = Ai−1xi + Ai−2
Bi−1xi + Bi−2
= Ai−1
√n + PiAi−1 + QiAi−2
Bi−1
√n + PiBi−1 + QiBi−2
.
Comparing the coeﬃcients at 1 and √n, we obtain
QiAi−2 + PiAi−1 = nBi−1,
QiBi−2 + PiBi−1 = Ai−1.
Solving this for Qi, we see that
(Ai−2Bi−1 −Ai−1Bi−2)Qi = nB2
i−1 −A2
i−1.
But the coeﬃcient at Qi equals to (−1)i−1. This proves (2.3.3). Recall also
that Pi, Qi can be calculated using a very eﬃcient algorithm which we restate
in a slightly changed form. Let x0 = (P0+√n)/Q0 be a quadratic irrationality,
with Q0 dividing n −P 2
0 . Put xi = (Pi + √n)/Qi. Then

2.3 Factorization of Large Integers
89
Pi+1 = aiQi −Pi,
ai = [Pi + √n/Qi],
(2.3.4)
Qi+1 = Qi−1 + (Pi −Pi+1)ai.
(2.3.5)
This follows directly from xi+1 = 1/(xi −ai), or
Pi + √n
Qi
= ai +
Qi+1
Pi+1 + √n.
If this method does not provide us with the required amount of B-
numbers, we can repeat the calculations with an instead of n where a is a
small square-free number. The number of operations required is estimated by
L
√
3/2 = exp
 
3
2 log n log log n

(compare with section 2.3.3), and the practical eﬃciency of this algorithm
was demonstrated by its application to the Fermat number F7 = 2128 −1 (cf.
[MB75], [Wil84]).
Let us describe also an elegant algorithm SQUFOF due to Shanks which is
also based upon the arithmetic of real quadratic ﬁelds (cf. [Ries85], [Wil84]).
It consists of two stages.
1) Put x0 = √n, that is, P0 = 0, Q0 = 1 in the formulae (2.3.4), (2.3.5).
Calculate xm until we ﬁnd an odd integer m such that Qm−1 = t2 for some
natural t. From (2.3.3) it follows that A2
m−2 ≡t2 mod n. Presumably, one
can then ﬁnd a divisor of n with the help of the Euclidean algorithm as
gcd(Am−2 ± t, n). In practice, however, Am−2 is usually too large to be
calculated directly, so that one changes tactics.
2) Put ˜P0 = Pm, ˜Q0 = t, ˜x0 = ( ˜P0 + √n)/Q0 and calculate the tails of the
continued fraction expansion of ˜x0, ˜xi = ( ˜Pi + √n)/ ˜Qi. We perform this
until we ﬁnd such ˜xq that ˜Pq = ˜Pq+1. From (2.3.4) and (2.3.5) it follows,
that
˜aq ˜Qq = 2 ˜Pq,
˜Qq divides n −˜P 2
q .
Hence either ˜Qq, or ˜Qq/2 divides n. If this divisor is trivial, one should
again replace n by an for a small a and repeat the calculations. Using a
calculator for factorizing a number ≤109, it is convenient to write the
intermediate results in a table. Table 2.1 illustrates the course of calcula-
tions for n = 11111 = 41·271. In general, q is about m/2 (in our example,
m = 7, q = 4. The algorithm is based on the fact, that the fractional ideal
(1, ˜x0) is of order two in Cl(4n), and on the second stage we calculate the
corresponding ambiguous form in disguise. The number of operations is
estimated by n1/4.

90
2 Some Applications of Elementary Number Theory
Table 2.1.
0
1
2
3
4
5
6
7
105
2
2
4
5
2
7
0
105
67
87
97
88
94
81
1
86
77
46
37
91 25 = 52
37
3
1
1
3
81
104
73
25
82
82
5
59
98
107
41
107
Since
˜x4 = 82 +
√
11111
41
= 2 +
√
11111
41
,
the ideal (1, ˜x4) corresponds to the ambiguous form (41,0,-11111/41), or
(41,0,-271), with the discriminant 4n.
2.3.5 The Use of Elliptic Curves
The general idea of utilizing the calculations in a ﬁnite group (such as class
group) in order to factorize n found unexpected implementations using groups
of diﬀerent types.
a) Pollard's (p−1)-method. Suppose that n has such a prime factor p that the
order of (Z/pZ)× is "smooth", that is, p−1 divides k! for a not too large k,
say, k ≤100000. Then we can proceed as follows: calculate consecutively
ai = 2i!−1 mod n using the recursive relation ai+1 ≡(ai+1)i+1−1 mod n
and ﬁnd gcd(ak, n); it will be divisible by p in view of Fermat's little
theorem. This will fail if there are no p|n with smooth p −1 ([Pol74]).
For a change, one can try to use the multiplicative groups of ﬁelds Fpr of
order pr −1. For r = 2, we obtain the Williams p+1-algorithm ([Wil82]).
b) Much wider perspectives of varying the ﬁnite group in the factorization
algorithms are opened by elliptic curves over ﬁnite ﬁelds. Their use leads
to one of the fastest known factorization algorithms requiring O(L1+ϵ)
operations [LeH.87].
Choose a random elliptic curve Γ and a point P on it. To this end, choose
random integers a, x0, y0 and put b = y2
0 −4x3
0 −ax0, P = (x0, y0). Then
P = (x0, y0) is a point on the curve deﬁned by the equation
Γ :
y2 = 4x3 + ax = b
(cf. §1.3.3). It is an elliptic curve over Q, if the right hand side cubic
polynomial has no multiple roots. We may also assume that the discrimi-
nant of this polynomial is relatively prime to n; otherwise we either get a
non-trivial divisor of n, or must change the curve.

2.3 Factorization of Large Integers
91
In the projective plane, Γ is determined by the homogeneous equation
Y 2Z = 4X3 = aXZ2 + Z3
(X = xZ, Y = yZ).
Reducing it modulo a prime p, we obtain an elliptic curve over Fp = Z/pZ.
Its identity is OΓ = (0 : 1 : 0), and the order of Γ(Fp) equals p + 1 −ap where
|ap| < 2√p (Hasse's theorem, see §1.3.3).
Assuming now that (p+1−ap) | k! for some p|n and small k, we calculate
consecutively Pi = i!P mod n in the projective plane over Z. The prime p
must divide the Z-coordinate of Pk, and the gcd(n, Zk). If we are lucky, O(k)
operations will provide us with a non-trivial divisor of n. Otherwise one should
renew the curve, without wasting too much time on an unsuccessful choice
("the strategy of early interruption"). In order to optimize the choice of k for
each test curve and the number of tests, let us take p = nβ. The probability of
success with k = [Lα] is approximately Ψ(nβ, Lα)/nβ ≈L−β/2α+o(1) (see 3.3).
Hence we shall have to try about Lβ/2α random elliptic curves with a marked
point, whereas for each of them the number of operations will be estimated
by Lα. The general number of operations Lα+β/2α is minimal for α =

β/2.
In the worst case, α = β = 1/2 we get L1+ϵ, ϵ > 0.
Notice that our estimates are based upon the following heuristic conjec-
ture: the orders of the groups Γ(Fp) behave with respect to the smoothness
property as the random numbers taken from (p −2√p + 1, p + 2√p + 1). The
belief in this conjecture is strengthened by the study of the set of isomorphism
classes of elliptic curves modulo a prime [LeH.87].
We must also notice that some cryptosystems using elliptic curves also
were suggested [Kob87].
There exists a probabilistic algorithm with rigorously estimated running
time
O(L
√
5/2)
due to [Dix84], and several probabilistic algorithms using linear or quadratic
sieves, with the expected running time
O(L
√
2) and O(L)
respectively [Pom82], [Wag86].
Many more interesting algorithms and computer programs can be found
in Riesel's book [Ries85]. One can also ﬁnd there some heuristic arguments
in favour of the existence of the algorithms which would be much faster then
everything we know now.
More recent information on factoring large integers and new records can
be found in [Coh2000] and at the Web page of F.Morain.

Part II
Ideas and Theories

3
Induction and Recursion
3.1 Elementary Number Theory From the Point of View
of Logic
3.1.1 Elementary Number Theory
Almost all of part I of this book belongs to elementary number theory (ENT).
This notion can be rigorously deﬁned using tools of mathematical logic, but in
order to do this one must ﬁrst introduce a formal language of arithmetic and
ﬁx an adopted system of axioms (one or other version of Peano's axioms). In
order to avoid such irrelevant details, we restrict ourselves to some intuitive
remarks. In ENT there are some initial statements and some axioms, which
formalize our intuitive ideas of natural numbers (or integers), as well as certain
methods for constructing new statements and methods of proofs. The basic
tool for construction is recursion. In the simplest case assume that we want
to deﬁne some property P(n) of a natural number n. Using the method of
recursion we explain how one can decide whether P(n + 1) is true if it is
already known whether P(1), . . . , P(n) are true or not. Say, the property "n
is a prime" can be deﬁned as follows: "1 is not a prime; 2 is a prime; n + 1 ≥3
is a prime iﬀnone of the primes among 1, 2, . . . , n divide n + 1". Analogously
the main tool in the proofs of ENT is induction. In order to prove by induction
a statement of type "∀n, P(n) is true" we ﬁrst prove say P(1) and then the
implication "∀n the property P(n) implies P(n + 1)".
Even in the earliest research into the axiomatics of number theory (Peano,
Frene) it was established that all the notions empirically thought of as be-
longing to ENT (such as divisibility, primality etc.), functions (the number
of divisors, the Euler function ϕ(n), π(x)) and theorems (Fermat's little the-
orem, the quadratic reciprocity law etc.) can be respectively constructed by
recursion and proved by induction, cf. [Rog67], [Man80].
It happens sometimes that a result admits an elementary formulation, but
its elementary proof is not known. For example, the prime number theorem

96
3 Induction and Recursion
π(x) ∼
x
log x can be stated in an elementary way assuming that x runs only
through natural numbers, and replacing log x by the sum
x

i=1
1
i ; an elementary
proof of this theorem was found only in the late 40s by Selberg, cf. [Sel51]
while the analytic proof had been known for half a century.
3.1.2 Logic
The study of ENT from the point of view of logic has lead to new concrete
number theoretical results which we shall discuss below. However the most
important consequence of this study has been that the place of ENT inside
mathematics in general has become much clearer. We wish to stress the fol-
lowing three aspects.
a) ENT as a mathematical discipline in principle can not be "self-suﬃcient".
For every choice of axioms there will always be statements which can be
formulated in an elementary way, and which are decidable, but which can
not be deduced using only elementary methods (cf. the theorem of Gödel
[Gö], discussed in [Man80]).
Thus the historical tradition of proving number theoretic facts using analy-
sis (Euler, Jacobi, Dirichlet, Riemann, Hardy, Littlewood, Vinogradov,
...), geometry (Minkowski, Hermit, ...) and generally all possible tools,
has deep reasons.
b) ENT can be used by means of formal logic to model any axiomatized
mathematical discipline inside elementary number theory (Gödel). In such
a modeling we forget the contentive sense of the deﬁnitions and theorems
of our theory and leave only information concerning their formal structure,
and syntactic rules for deducing one statement from others. Enumerating
by Gödel's method all syntactically correct statements by natural num-
bers, we can then write a program or algorithm to list all provable results
of our theory (its theorems). Thus a theory is modeled by a function
f : Z+ →Z+ (the ﬁrst Z+ is a number generating the theorem, the sec-
ond is the encoded statement in the theory). Instead of asking whether
the theorem with number n is provable we can ask whether the equation
f(x) = n is solvable.
Although the equation f(x) = n is deﬁned in terms of ENT, it is far from
being a Diophantine equation since the function f is not a polynomial. As
was shown by Yu.V.Matiyasevich, it is possible to reduce this problem to
a Diophantine one (Hilbert's tenth problem), see [Mat04].
He showed that one can ﬁnd a polynomial Pf(x1, . . . , xm; n) with integral
coeﬃcients such that the solvability of f(x1) = n is equivalent to the
solvability of Pf(x; n) = 0 with x ∈(Z+)m. The calculation of Pf from f is
completely eﬀective (as is the construction of f given the system of axioms
deﬁning the initial theory). In this sense the problem of provability of any

3.1 Elementary Number Theory From the Point of View of Logic
97
mathematical result is equivalent to a standard kind of number theoretical
problem. (The reader who is used to thinking not in terms of "provability"
but of "truthfulness" must at this point take consciously some intellectual
precautions. Considering for example the theorem of Gödel - Cohen that
the continuum - hypothesis is independent of the standard axioms of set
theory, it is clear that "truthfulness", as opposed to "provability", is a rather
philosophical notion. It would therefore be unreasonable to expect it to
have a precise mathematical deﬁnition.)
c) ENT provides a framework for the precise formulation and study of the
notions of algorithm and (semi-)computable function. These notions, im-
plemented in the theory of recursive functions, turn out to be much more
universal than one could expect a priory (the Church thesis, cf. [Man80],
[Rog67], [KMP74]). The theory of recursive functions has both a fun-
damental general mathematical meaning, and an applied meaning. Its
methods are used in proving the Matiyasevich theorem mentioned above.
In the next section we formulate some basic facts from the theory of recur-
sive functions, which have independent number theoretical interest. We then
give some precise deﬁnitions and hints of proofs.

3.2 Diophantine Sets
3.2.1 Enumerability and Diophantine Sets
Deﬁnition 3.1. A subset E ⊂(Z+)m, m ≥1 is called Diophantine if there
exists a polynomial with integral (or, equivalently, with natural) coeﬃcients
P(t1, . . . , tm, x1, . . . , xn),
such tha
(t1, . . . , tm) ∈E ⇐⇒∃(x1, . . . , xn) ∈Zn, P(t, x) = 0.
Every Diophantine set is enumerable in the following informal sense of the
word: there is a deterministic algorithm, which produces one-by-one all ele-
ments of E (a formal deﬁnition will be given in the next section). Indeed, let
us check one-by-one all the elements of Zm+n: substitute them into P and,
if we get zero, write down the ﬁrst m coordinates. We thus obtain a growing
list of elements of E, which exhausts E when we pass to the limit.
3.2.2 Diophantineness of enumerable sets
Theorem 3.2. Conversely, every enumerable set is Diophantine. Its deﬁning
polynomial can be eﬀectively constructed from the algorithm generating E.
It seems a priori that there are many more enumerable sets than Diophan-
tine sets; it is therefore clear that in proving theorem 3.2, one needs to prove
the Diophantineness of some unexpected sets. J. Robinson discovered that
this problem can be simpliﬁed if one takes for granted the Diophantineness
of the set {(a, b, c) | a = bc}, and Yu. V. Matiyasevich (cf. [Mat72], [Mat04])
established this last step. Below we give some examples and constructions
used in the proof, which are purely number-theoretical. We ﬁrst formulate
the following very general property.
3.2.3 First properties of Diophantine sets
Proposition 3.3. The class of Diophantine sets contains the level sets of
polynomials with integral coeﬃcients, and it is closed with respect to the op-
erations of ﬁnite direct sum, ﬁnite intersection, and projection.
This follows immediately from the deﬁnition. It suﬃces to note that if
E, F ⊂Zm correspond to polynomials P, Q respectively, then E ∩F corre-
sponds to P 2 + Q2; E ∪F corresponds to PQ, and E × F corresponds to
P 2 + ˜Q2, where ˜Q is obtained from Q by renumbering the ﬁrst m variables.
Now we give the key arithmetical lemma - the proof of the Diophantineness
of a set related to solutions of Pell's equation (it is important that for this set
one coordinate grows approximately as the exponent of the other).

3.2 Diophantine Sets
99
Consider Pell's equation x2 −dy2 = 1 (d ∈Z+ is a square free integer). Its
solutions (x, y) ∈Z2 form a cyclic group with respect to the following law of
composition: if (x1, y1) is a solution with the ﬁrst coordinate minimal, then
any other solution is of the type (xn, yn), where n ∈Z+ and
xn + yn
√
d = (x1 + y1
√
d)n.
The number n is called the solution number (cf. Part I, §1.2.5).
The coordinates xn, yn grow exponentially with n, but the set of solutions,
and its projections on the x- and y- axes are Diophantine. However this is
still not what we need: the main diﬃculty is to include the solution number
into a set of coordinates of a Diophantine set; only then will we be able to use
further arguments. This is done below.
It is convenient to use for d the number d = a2 −1, a ∈Z+, since in this
case (x1, y1) = (a, 1). The equation x2 −(a2 −1)y2 = 1 will be called the
a-equation. Deﬁne two sequences xn(a), yn(a) to be the coordinates of its nth
solution:
xn(a) + yn(a)

a2 −1 = (a +

a2 −1)n.
Formal deﬁnitions of xn(a) and yn(a) as polynomials in a can easily be given
by induction over n. Then xn(a) and yn(a) will have sense for all n ∈Z and
a ∈C. In particular, xn(1) = 1, yn(1) = n; in this extended range all of the
formulae given below will be valid.
3.2.4 Diophantineness and Pell's Equation
Proposition 3.4. The set E : y = yn(a), a > 1 is Diophantine in the
(y, n, a)-space.
The idea in the Diophantine reconstruction of n from (y, a) is based on
the remark, that the congruence
yn ≡n mod (a −1)
determines n uniquely for n < a −1. In order to treat the general case, an
auxiliary A-equation is introduced, with big A. Its nth solution so that n be
used only in Diophantine context.
Besides the main variables y, n, a, one introduces six auxiliary variables:
x, x′, y′; A; x1, y1. Furthermore deﬁne the following sets:
E1 : y ≥n, a > 1;
E2 : x2 −(a2 −1)y2 = 1;
E3 : y′ ≡0 mod 2x2y2;
E4 : x′2 −(a2 −1)y′2 = 1;

100
3 Induction and Recursion
E5 : A = a + x′2(x′2 −a);
E6 : x2
1 −(A2 −1)y2
1 = 1;
E7 : y1 −y ≡0 mod x′2;
E8 : y1 ≡n mod 2y.
The sets Ei are all Diophantine, and prE′ = E, where E′ = ∩8
i=1Ei. In order
to check this fact we use the following properties:
yk(a) ≡k mod (a −1).
(3.2.1)
If a ≡b mod c then yn(a) ≡yn(b) mod c.
(3.2.2)
If yi(a) ≡yj(b) mod xn(a), a > 1 then i ≡j mod 2n or i ≡−j mod 2n.
(3.2.3)
If yi(a)2|yj(a) then yj(a)|j.
(3.2.4)
Properties (3.2.1) - (3.2.4) are easily deduced from the equalities
xn±m(a) = xn(a)xm(a) ± (a2 −1)yn(a)ym(a),
yn±m = ±xn(a)ym(a) + xm(a)yn(a).
3.2.5 The Graph of the Exponent is Diophantine
We now prove that the set E : y = an in the (y, a, n)-space is Diophantine.
It suﬃces to check Diophantineness of E0 = E ∩{a | a > 1}. For a > 1 one
easily obtains by induction on n that
(2a −1)n ≤yn+1(a) ≤(2a)n
in the notation of §3.2.4. From this it follows that
an = [yn+1(Na)/yn+1(N)]
for suﬃciently large N. To be more precise, E0 is the projection of the set E1:
a > 1; 0 ≤yn+1(N)y −yn+1(y); N > 4n(y + 1);
and Diophantineness of E1 is then obtained by introducing trivial auxiliary
relations y′ = yn+1(N) and y′′ = yn+1(Na).
3.2.6 Diophantineness and Binomial coeﬃcients
Proposition 3.5. The set E : r =
n
k

, n ≥k in the (r, k, n)-space is Dio-
phantine.

3.2 Diophantine Sets
101
3.2.7 Binomial coeﬃcients as remainders
Lemma 3.6. If u > nk then
n
k

is equal to the remainder of the division
[(u + 1)n/uk] by u.
The proof follows from the binomial formula
(u + 1)n/uk =
n

i=k+1
n
i

ui−k +
n
k

+
k−1

i=0
n
i

ui−k.
The ﬁrst sum is divisible by u and the second is less than 1 for u > nk.
The proof of Proposition 3.5 has the same scheme, using the auxiliary
variables u and v and the relation
E1 : u > nk;
E2 : v = [(u + 1)n/uk];
E3 : r ≡v mod u; E4 : r < v; E5 : n ≥k.
From the lemma it follows immediately that E = pr∪5
i=1Ei. The Diophantine-
ness of E1 follows from that of the exponent; the Diophantineness of E3, E4
and E5 is obvious. The Diophantineness of E2 becomes clear if we represent
E2 in the form
(u + 1)n ≤ukv < (u + 1)n + uk
and use again the Diophantineness of the exponent.
3.2.8 Diophantineness of the Factorial
Proposition 3.7. a) The set E : m = k! is Diophantine.
b) The set
E : x
y =
p/q
k

,
p > qk,
is Diophantine in the space (x, y, p, q, k).
The proof is a modiﬁcation of the arguments in §3.2.6, §3.2.7, using the
following lemma.
3.2.9 Factorial and Euclidean Division
Lemma 3.8. a) If k > 0 and n > (2k)k+1 then
k! =
!
nk
n
k

"
.
b) Let a > 0 be an integer such that a ≡0(mod (qkk!)) and a > 2p−1pk+1.
Then
p/q
k

= a−1[a2k+1(1 + a−2)p/q] −a[a2k−1(1 + a−2)p/q].
The proof of this lemma follows from some elementary computations and
Proposition 3.7 is proved using the same methods as above.

102
3 Induction and Recursion
3.2.10 Supplementary Results
The Diophantine representations stated above are used in the proof of the
general theorem of Matiyasevich. On the other hand they can also be used to
ﬁnd exponential - Diophantine representations for some interesting concrete
sets. As an example consider the set of prime numbers. By Wilson's theorem
p is a prime ⇐⇒(p −1)! + 1 is divisible by p. The set of prime numbers
is therefore a projection of the set of solutions to the following system of
equations
⎧
⎪
⎨
⎪
⎩
p = f + 1
q = f!
q −ap = 1.
which is Diophantine in view of the Diophantineness of q = f!.
Any Diophantine subset E ⊂Z+ coincides with the set of all natural
values of a polynomial with integral coeﬃcients (on ZN). Indeed if E is the
projection of P(t; x1 . . . xn) = 0 then Q(t; x1 . . . xn) = t(1 −P 2) is the appro-
priate polynomial. Thus the set of all primes can be represented as the set
of all natural values of a polynomial Q. (It should be noted that Q will take
inﬁnitely many other integral values ≤0 which is unavoidable).
The Fibonacci numbers form the sequence 1 1 2 3 5 8 . . . , un+2 = un+1+un.
J. Jones found that this sequence can be represented as the set of positive
values of a very simple polynomial in two variables (this is not the case for
the set of all primes):
2a4b + a3b2 −2a2d3 −a5 −ab4 + 2a.
Although as we have noticed above the question on the provability of any
theorem can in principle be reduced to a Diophantine equation some concrete
problems admit natural reductions without the use of a formal language. We
refer the reader to the very interesting and informative article [DMR74]. In
particular this article contains Diophantine forms of the Riemann Hypothesis
and the four-colour problem.

3.3 Partially Recursive Functions and Enumerable Sets
3.3.1 Partial Functions and Computable Functions
In this Section we give a precise deﬁnition of a class of partial functions from
Zm to Zn. This deﬁnition can be considered as an adequate formalization of
the class of (semi-)computable functions. Using the deﬁnition one is able to
deﬁne the class of enumerable sets. We shall denote by D(f) the domain of
deﬁnition of a partial function f, [Rog67], [Man80].
3.3.2 The Simple Functions
suc : Z+ →Z+, suc(x) = x + 1;
1(n) : Zn →Z+, 1(n)(x1, . . . , xn) = 1 n ≥0;
prn
i : Zn →Z+,
prn
i (x1, . . . , xn) = xi,
n ≥1.
3.3.3 Elementary Operations on Partial functions
(a) Composition (or substitution). This operation takes a pair of partial
functions f : Zm →Zn and g : Zn →Zp and gives a partial function
h = g ◦f : Zm →Zp, deﬁned as follows
D(g ◦f) = f −1(D(g)) ∩D(f) = {x ∈Zm | x ∈D(f), f(x) ∈D(g)},
(g ◦f)(x) = g(f(x)) for x ∈D(g ◦f).
(b) Junction. This operation takes partial functions fi from Zm to Zni, i =
1, . . . , k to the function (f1, . . . , fk) from Zm to Zn1 × · · · × Znk deﬁned
as follows
D((f1, . . . , fk)) = D(f1) ∩· · · ∩D(fk),
(f1, . . . , fk)(x1, · · · , xm) = (f1(x1, · · · , xm), · · · , fk(x1, · · · , xm)).
(c) Recursion. This operation takes a pair of functions f from Zn to Z+ and
g from Zn+2 to Z+, to the function h from Zn+1 to Z+ deﬁned as follows
h(x1, . . . , xn, 1) = f(x1, . . . , xn)
(the initial condition);
h(x1, . . . , xn, k + 1) = g(x1, . . . , xn, k, h(x1, . . . , xn, k)) for k ≥1
(the recursive step).
The domain of deﬁnition D(h) is also described recursively:
(x1, . . . , xn, 1) ∈D(h) ⇐⇒(x1, . . . , xn) ∈D(f);
(x1, . . . , xn, k + 1) ∈D(h) ⇐⇒(x1, . . . , xn) ∈D(f) and
(x1, . . . , xn, k, h(x1, . . . , xn, k)) ∈D(g) for k ≥1.

104
3 Induction and Recursion
(d) The µ-Operation. This operation takes a partial function f from Zn+1
to Z+ to the partial function h from Zn to Z+ which is deﬁned as follows:
D(h) ={(x1, . . . , xn) ∈(Z+)n|∃xn+1 ≥1 f(x1, . . . , xn, xn+1) = 1
and (x1, . . . , xn, k) ∈D(f) for all k ≤xn+1},
h(x1, . . . , xn) = min{xn+1 | f(x1, . . . , xn, xn+1) = 1}.
Generally speaking, the role of µ is to introduce "implicitly deﬁned" func-
tions. The use of µ makes it possible to introduce a one-by-one check of
objects in order to ﬁnd a desired object in an inﬁnite family. The following
three features of µ should be stressed immediately. The choice of the min-
imal y with f(x1, . . . , xn, y) = 1 is made, of course, in order to ensure that
the function h is well deﬁned. Also, the domain of deﬁnition of h seems
at ﬁrst sight to be artiﬁcially diminished: if, say, f(x1, . . . , xn, 2) = 1 and
f(x1, . . . , xn, 1) is not deﬁned, we consider h(x1, . . . , xn) to be undeﬁned,
rather than being equal to 2. The reason for this is the wish to preserve
the property that h is intuitively computable. Finally we remark that
all previously deﬁned operations produce everywhere deﬁned functions if
applied to everywhere deﬁned functions. This is obviously not the case
for the operation µ. Hence this is the only operation responsible for the
appearance of partially deﬁned functions.
3.3.4 Partially Recursive Description of a Function
Deﬁnition 3.9. (a) The sequence of functions f1, · · · fN is called a partially
recursive (resp. primitively recursive) description of a function f = fN if f1
is one of the simple functions; fi is for all i ≥2 either a simple function
or is obtained by applying the elementary operations to some of the functions
f1, · · · , fi−1 (resp. one of the elementary operations apart from µ).
(b) The function f is called partially recursive (resp. primitively recursive),
if it admits a partially recursive (resp. primitively recursive) description.
Polynomials with positive values. We ﬁrst establish the recursivity of sums
and products.
a)
sum2 : Z2 →Z+,
(x1, x2) →x1 + x2.
Use recursion over x2 starting from the initial condition x1 + 1 = suc(x1),
with the recursive step x1 + k + 1 = suc(
2(x1, k)).
b)
sumn : Zn →Z+,
(x1, . . . , xn) →
n

i=1
xi,
n ≥3.
Assuming that sumn−1 is recursive we obtain sumn using junctions and
composition

3.3 Partially Recursive Functions and Enumerable Sets
105
sumn = sum2 ◦(sumn−1 ◦(prn
1, · · · , prn
n−1), xn).
Another version is the recursion over xn starting from the initial condition
suc ◦sumn−1 and the recursive step
n−1

i=1
xi + k + 1 = suc(sumn(x1, . . . , xn−1, k)).
One ﬁnds that the number of recursive descriptions of a function increases
step-by-step, even if one only counts the "natural" descriptions.
c)
prod2 : Z2 →Z+,
(x1, x2) →x1x2.
Use recursion over x2 starting from the initial condition x1, with the
recursive step x1(k + 1) = x1k + x1 = sum2(x1k, x1).
d)
prodn : Zn →Z+,
(x1, . . . , xn) →x1 · · · · · xn,
n ≥3 :
prodn = prod2 ◦(prodn−1(prn
1, · · · , prn
n−1), xn).
e) "Substraction of one": Z+ →Z+:
x →x
.−1 =

x −1,
if x ≥2;
1,
if x = 1.
We apply recursion to the simple functions
f : Z+ →Z+,
f = 1,
g = pr3
2Z3 →Z+ : (x1, x2, x3) →x2,
and as a result obtain the function h(x1, x2) = x2
.−1. Hence x
.−1 = h ◦
(x, x), where x = pr1
1(x).
f) "Truncated diﬀerence"
Z2 →Z+ :
(x1, x2) →x1
.−x2 =

x1 −x2,
if x1 > x2;
1,
if x1 ≤x2.
(3.3.1)
This "truncated diﬀerence" is constructed by applying recursion to the
functions
f(x1) = x1
.−1,
g(x1, x2, x3) = x3
.−1.
Let F : Zn →Z+ where F is any polynomial in x1, . . . , xn with integral
coeﬃcients taking only values in Z+. If all of the coeﬃcients of f are non-
negative then F is a sum of products of functions prn
i : (x1, . . . , xn) →xi.
Otherwise F = F + −F −, where F + and F −have non-negative coeﬃcients,
and the values of the untruncated diﬀerence coincide with the values of the
truncated one F + .−F −by the assumption on F. In what follows we use the
recursivity of the functions (x1 −x2)2 + 1 and h = (f −g)2 + 1 where f and
g are recursive: this trick makes it possible to identify the "coincidence set"
f = g with the "level set" h = 1 which is easier to tackle.

106
3 Induction and Recursion
3.3.5 Other Recursive Functions
"The Step":
sa,b
x0 (x) =

a,
for x ≤x0,
b
for x > x0;
a, b, x ∈Z+.
For x0 = 1 this is obtained using recursion with the initial condition a and
the following value b. In the general case
sa,b
x0 (x) = sa,b
1 (x + 1
.−x0).
rem(x, y) = the remainder in {1, . . . , x} after dividing y by x (we do not have
zero!). We have
rem(x, 1) = 1 :
rem(x, y + 1) =

1,
if rem(x, y) = x :
suc ◦rem(x, y),
if rem(x, y) ̸= x.
We use the following artiﬁcial trick. Consider the step s(x) = 2 for x ≥2,
s(1) = 1 and set
ϕ(x, y) = s((rem(x, y) −x)2 + 1).
It is obvious that
rem(x, y) ̸= x ⇐⇒ϕ(x, y) = 1,
rem(x, y) = x ⇐⇒ϕ(x, y) = 2,
hence
rem(x, y + 1) = 2suc(rem(x, y))
.−ϕ(x, y)suc(rem(x, y)).
This gives us a recursive deﬁnition of rem. A generalization of this trick is
"conditional recursion":
h(x1, . . . , xn, 1) = f(x1, . . . , xn);
h(x1, . . . , xn, k + 1) = gi(x1, . . . , xn, k, h(x1, . . . , xn, k),
if the condition Ci(x1, . . . , xn, k; h) (i = 1, . . . , m)
is satisﬁed.
(3.3.2)
We reduce the mutually exclusive conditions Ci(x1, . . . , xn, k; h) to the form
Ci is satisﬁed ⇐⇒ϕi(x1, . . . , xn, k; h(x1, . . . , xn, k)) = 1
(3.3.3)
(an everywhere deﬁned recursive function taking only values 1 and 2.)
Then the recursive step can be described as follows:
h(x1, . . . , xn, k + 1) =2
m

i=1
gi(x1, . . . , xn, k, h(x1, . . . , xn, k))
−
m

i=1
(giϕi)(x1, . . . , xn, k, h(x1, . . . , xn, k)).(3.3.4)

3.3 Partially Recursive Functions and Enumerable Sets
107
This trick makes it possible to establish the primitive recursivity of the
following functions which will be used below.
The incomplete quotient:
qt(x, y) =

integral part of y/x,
if y/x ≥1,
1,
if y/x < 1.
We have
qt(x, y + 1) =
⎧
⎪
⎨
⎪
⎩
qt(x, y),
if rem(x, y + 1) = x, y + 1 ̸= x;
qt(x, y) + 1,
if rem(x, y + 1) ̸= x, y + 1 ̸= x;
1,
y + 1 = x.
One reduces these conditions to the standard form (3.3.3) with the help of
the functions
˜s((rem(x, y + 1) −x)2 + 1),
s((rem(x, y + 1) −x)2 + 1) · ˜s((x −y −1)2 + 1),
s((x −y −1)2 + 1),
where
s(1) = 1, s(≥2) = 2; ˜s(1) = 2, ˜s(≤2) = 1.
The function rad(x) - the integral part of √x. One has
rad(1) = 1
rad(x + 1) =

rad(x)
if qt(rad(x) + 1, x + 1) < rad(x) + 1,
rad(x) + 1
if qt(rad(x) + 1, x + 1) = rad(x) + 1.
These conditions can be reduced to the standard form (3.3.3) in a similar way.
The function min(x, y):
min(x, 1) = 1;
min(x, y + 1) =

min(x, y),
if x ≤y,
min(x, y) + 1,
if x > y.
The function max(x, y) (similarly).

108
3 Induction and Recursion
3.3.6 Further Properties of Recursive Functions
If f(x1, . . . , xn) is recursive then
Sf =
xn

k=1
f(x1, . . . , xn−1, k),
Pf =
xn

k=1
f(x1, . . . , xn−1, k)
are recursive. We can also obtain recursive functions from f in the following
ways:
a) by any substitution of the arguments;
b) by introducing any number of extra arguments;
c) by identifying the members of any group of arguments (e.g. f(x, x) instead
of f(x, y) etc.)
The map f : Zm →Zn is recursive if and only if all of its components prn
i ◦f
are recursive.
Deﬁnition 3.10. The set E ⊂Zn is called enumerable, if there exists a par-
tially recursive function f such that E = D(f) (the domain of deﬁnition).
The discussion of §3.1 and §3.2 shows that enumerability has the following
intuitive meaning: there exists a program which recognizes the elements x
belonging to E, but which not necessarily recognizes elements which do not
belong to E. Below, a diﬀerent description of the enumerable sets will be
given, which will explain the ethimology of the name: they are the sets with
the property that all their elements may be obtained (possibly with repetitions
and in an unknown order) by a "generating program".
The following simple fact is easily deduced from the properties of partially
recursive functions.
3.3.7 Link with Level Sets
Proposition 3.11. The following three classes coincide: a) the enumerable
sets;
b) the level sets of partially recursive functions;
c) the 1-level sets of partially recursive functions.
A much more diﬃcult statement is the following result and its corollaries.
3.3.8 Link with Projections of Level Sets
Theorem 3.12. The following two classes coincide:
a) the enumerable sets;
b) the projections of level sets of primitively recursive functions.
Among the primitively recursive functions are the polynomials with coef-
ﬁcients in Z+. Recall that Diophantine sets are projections of the level sets of
such polynomials. The Matiyasevich theorem can now be stated precisely as
follows:

3.3 Partially Recursive Functions and Enumerable Sets
109
3.3.9 Matiyasevich's Theorem
Theorem 3.13. The enumerable sets are Diophantine; hence the two classes
coincide.
We sketch the proof of Theorem 3.12 in this section, and of Theorem 3.13
in the next section.
Let us temporarily call the projections of level-sets of primitively recursive
functions the primitively enumerable sets. In the ﬁrst part of the proof of
Theorem 3.12 it is established that the primitively enumerable sets are all
enumerable; in the second part the opposite inclusion is proved.
We therefore let f(x1, . . . , xn, xn+1, . . . , xn+m) be a primitively recursive
function, and E the projection of its 1-level to the ﬁrst n coordinates. We
shall explicitly construct a partially recursive function g such that E = D(g).
This will show that any primitively enumerable set must be enumerable
We divide the proof into three cases depending on the codimension of the
projection: m = 0, 1 or m ≥2.
Case a): m = 0. Then the set E is the 1-level of f and is enumerable by
Proposition 3.11.
Case b): m = 1. Set
g(x1, . . . , xn) = min{xn+1 | f(x1, . . . , xn, xn+1) = 1}.
It is clear that g is partially recursive and D(g) = E.
Case c): m ≥2. We shall reduce this to the previous case using the following
lemma, which is interesting in itself (the lack of a notion of "dimension" in
"recursive geometry") and plays an important role in various other ques-
tions.
3.3.10 The existence of certain bijections
Lemma 3.14. For all m ≥1 there exists a one-to-one map t(m) : Z+ →Zm
such that:
a) the functions t(m)
i
= pr(m)
i
◦t(m) are primitively recursive for all 1 ≤i ≤m;
b) the inverse function τ (m) : Zm →Z+ is primitively recursive
Application of the lemma.
We apply Lemma 3.14 in the case 3.3.9 c) and set for m ≥2
g(x1, . . . , xn, y) = f(x1, . . . , xn, t(m)
1
(y), . . . , t(m)
m (y)).
It is clear that g, being a composition of primitively recursive functions is itself
primitively recursive. It is easy to check that E coincides with the projection of

110
3 Induction and Recursion
the 1-level set of the function g to the ﬁrst n coordinates. Since this projection
is of codimension 1, we have reduced Case c to Case b.
Proof of the lemma. The case m = 1 is trivial. We shall prove the lemma
by induction on m, starting from m = 2.
Construction of t(2). We ﬁrst construct τ (2) : Z2 →Z+ by setting
τ (2)(x1, x2) = 1
2((x1 + x2)2 −x1 −3x2 + 2).
It is easy to check that if we index the pairs (x1, x2) ∈Z2 in the "Kantor order",
and inside each group with given x1 +x2 in increasing order, then τ (2)(x1, x2)
will be exactly the number of the pair (x1, x2) in this list. Thus τ (2)(x1, x2) is
bijective and primitively recursive (use (3.3.4) and the recursivity of qt from
(3.3.5) in order to take into account the 1/2.
The reconstruction of a pair (x1, x2) from its image y is an elementary
task and this leads to the following formula for the inverse function t(2):
t(2)(y) = y −1
2
! 
2y −7
4 −1
2
" ! 
2y −7
4 −1
2
"
+ 1

,
t(2)
2 (y) =
! 
2y −7
4 −1
2
"
−t(2)(y) + 2.
Here [z] denotes the integral part of z. Using the results and methods of §3.3.5
- §3.3.6, one can verify that these functions are primitively recursive.
Construction of t(m). Assume that t(m−1), τ (m−1) are already constructed,
and their properties are proved. Set ﬁrst of all
τ (m) = τ (2)(τ (m−1)(x1, . . . , xm−1), xm).
It is clear that τ (m) is primitively recursive and bijective. Solving the equation
τ (2)(τ (m−1)(x1, . . . , xm−1), xm) = y
in two steps, we get the following formulae for the inverse function t(m):
t(m)
m (y) = t(2)
2 (y),
t(m)
i
(y) = t(m−1)
i
(t(2)
1 (y)),
1 ≤i ≤m −1.
By induction, t(m)
1
is primitively recursive.
This ﬁnishes the proof of the lemma and the ﬁrst part of the proof of
theorem 3.12.
The second part of the proof. We now prove that every primitively enumer-
able set is enumerable. We begin with the following easily veriﬁed property of
the class of primitively enumerable sets.

3.3 Partially Recursive Functions and Enumerable Sets
111
3.3.11 Operations on primitively enumerable sets
Lemma 3.15. The class of primitively enumerable sets is closed under the
operations of ﬁnite direct sum, ﬁnite intersection, ﬁnite union and projection.
Now let E be an enumerable set. Using proposition in 3.3.7 we realize
it as the 1-level of a partially recursive function f : Zn →Z+. Note that
in order to prove that E is primitively enumerable it suﬃces to check that
the graph Γf ⊂Zn × Z+ is primitively enumerable. Indeed it is clear that
E coincides with the 1-level of the projection onto the ﬁrst n coordinates of
the set Γf ∩(Zn × {1}). Also the set {1} ⊂Z+ is primitively enumerable in
view of the properties listed in §3.3.4, so if we prove that Γf is primitively
enumerable, then the same would follow for E by lemma 3.15. We have thus
reduced our problem to that of proving that the graphs of partially recursive
functions f are primitively enumerable.
With this purpose we check that: a) the graphs of simple functions are
primitively enumerable; b) if we are given functions whose graphs are prim-
itively enumerable, then any function obtained from them using one of the
elementary operations also has a primitively enumerable graph.
Stability under recursion and the µ operation are the most delicate points.
In order to prove these, the following nice lemma is used.
3.3.12 Gödel's function
Lemma 3.16. There exists a primitively recursive function Gd(k, t) (Gödel's
function) with the following property: for each N ∈Z+ and for any ﬁnite
sequence a1, . . . , aN ∈Z+ of the lenth N there exists t ∈Z+ such that
Gd(k, t) = ak for all 1 ≤k ≤N (In other words, Gd(k, t) may be regarded
as a sequence of functions of the argument k indexed by the parameter t such
that any function of k on an arbitrarily large interval 1, . . . , N can be imitated
by an appropriate term of this sequence).
In order to prove this it is convenient to put ﬁrst
gd(u, k, t) = rem(1 + kt, u)
and to show that gd has the same property as Gd if we allow ourselves to
choose (u, t) ∈Z2. After this we could put
Gd(k, y) = gd(t(2)
1 (y), k, t(2)
2 (y)),
where t(2) : Z+ →Z2 is the isomorphism of Lemma 3.14. Getting rid of the
auxiliary parameter u in Gd(k, t) (in comparison with gd(u, k, t)) causes no
essential problems.

112
3 Induction and Recursion
3.3.13 Discussion of the Properties of Enumerable Sets
Theorem 3.12 of §3.3.8 shows that if E is enumerable, then there exists a
program "generating" E (cf. §3.3.6). Indeed, let E be the projection onto
the ﬁrst n coordinates of the 1-level of a primitively recursive function
f(x1, . . . , xn, y). The program "generating" E should check one-by-one the
vectors (x1, . . . , xn, y), say, in Kantor's order; it should compute f and output
(x1, . . . , xn) if and only if f(x1, . . . , xn, y) = 1. Since f is primitively recur-
sive, the generating program will sooner or later write down each element of
E, and no other element. It cannot stop forever on elements not belonging to
E. However, if E were empty we could never ﬁnd this out just by waiting.
The set E ⊂Zn is called solvable, if it and its complement are enumer-
able. Intuitively this means that that there is a program which decides for any
element of Zn whether it belongs to E or not. These sets can be character-
ized as being the level sets of general recursive (everywhere deﬁned recursive)
functions, or as the sets whose characteristic function is recursive. In order to
establish these properties, the following result is used.
Proposition 3.17. A partial function g from Zn to Z+ is partially recursive
iﬀits graph is enumerable.

3.4 Diophantineness of a Set and algorithmic
Undecidability
3.4.1 Algorithmic undecidability and unsolvability
Before explaining how to prove that the classes of Diophantine and of ennu-
merable sets are the same, we ﬁrst give some interesting applications of this
theorem. It is known from logic that there are sets which are ennumerable
but not solvable. Combining this fact with Matiyasevich's theorem (see Theo-
rem 3.13) and the Church thesis, we deduce that Hilbert's tenth problem (see
section 3.1.2) is undecidable, see [Mat04].
First of all, every natural number is a sum of four squares (Lagrange's the-
orem, see Part I, section 1.2.6). The solvability of the equation f(x1, . . . , xn) =
0 in Zn is therefore equivalent to the solvability of the equation
f

1 +
4

i=1
y2
i1, . . . , 1 +
4

i=1
y2
in

= 0
in Z4n. It is thus suﬃcient to establish the algorithmic undecidability of the
class of questions whether equations have solutions in Zn. Let E ⊂Z+ be
ennumerable but not solvable. We represent it as the 0-level set of a poly-
nomial ft = f(t; x1, · · · , xn) = 0, f ∈Z[t; x1, · · · , xn]. The equation ft0 = 0;
t0 ∈Z+ is solvable iﬀt0 ∈E. According to a general principle (the Church
thesis), intuitive computability is equivalent to partial recursivity of a func-
tion. This implies that the corresponding class of problems for the family {ft}
is algorithmically decidable, iﬀthe characteristic function of E is computable.
However this is not the case by the choice of E: although E is ennumerable,
its complement is not.
Thus the question of solvability in integers is undecidable even for an ap-
propriate one parameter family of equations. The number of variables, or
more generally the codimension of the projection can be reduced to 9 (Yu. I.
Matiyasevich). The precise minimum is still unknown, although this is a very
intriguing problem.
3.4.2 Sketch Proof of the Matiyasevich Theorem
One introduces temporarily a class of sets, intermediate between the ennu-
merable and Diophantine sets. In order to deﬁne this class, consider the map
which takes a subset E ⊂Zn to a new subset F ⊂Zn deﬁned by the following
law:
(x1, . . . , xn) ∈F ⇐⇒∀k ∈[1, xn]
(x1, . . . , xn−1, k) ∈E.
We shall say in this case that F is obtained from E by use of the restricted
generality quantor on the nth coordinate. The restricted generality quantor is
deﬁned analogously on any other coordinate.

114
3 Induction and Recursion
Deﬁnition-Lemma. Consider the following three classes of subsets of Zn
for any n:
I. Projections of the level sets of primitively recursive functions.
II. The smallest class of sets containing the level sets of polynomials with
integral coeﬃcients, which is closed under the operations of ﬁnite direct
sum, ﬁnite union, ﬁnite intersection, projection and the restricted gener-
ality quantor.
III. Projections of the level sets of polynomials with integral coeﬃcients.
Then
a) Class I coincides with the class of ennumerable sets, and Class III with
the class of Diophantine sets. The sets of the class II will be called D-sets.
b) The following inclusions hold: I ⊃II ⊃III.
The ﬁnal steps in the proof of the Matiyasevich theorem consist of reduc-
tions similar to those described above. The crucial part is the proof that the
class of Diophantine sets is closed under the use of the restricted generality
quantor. Here one makes use of the Diophantine representations of concrete
sets from §3.2, in order to check that application of Gödel's function does not
damage the Diophantineness.
Note that B. Poonen studied in [Po03] Hilbert's tenth problem for large
subrings of Q in connection with Mazur's conjecture on varieties over Q whose
real topological closure of rational points has inﬁnitely many components (no
such varieties are known to this point). For the ﬁeld of rational numbers
Hilbert's tenth problem is a major open question. In trying to answer it two
general methods have been used: one is to study the similar question in other
global ﬁelds (such as ﬁelds of rational functions Fq(t) over ﬁnite ﬁelds) and
try to transfer the methods to Q; the other is to try to prove it for ever
larger subrings of Q. Relations of this problem with arithmetic and algebraic
geometry were studied in [DLPvG], see also [Shl03].

4
Arithmetic of algebraic numbers
4.1 Algebraic Numbers: Their Realizations and
Geometry
4.1.1 Adjoining Roots of Polynomials
The idea to extend the ﬁeld of rational numbers owes a lot to various attempts
to solve some concrete Diophantine equations. The use of irrational numbers
which are roots of polynomials with rational coeﬃcients often makes it possible
to reduce such equations to more convenient forms. An intriguing example of
this is the study of the Fermat equation (cf. [BS85], [Pos78], [Edw77], [Rib79]):
xn + yn = zn
(n > 2).
(4.1.1)
The unsolvability of (4.1.1) in non-zero integers for n > 2 is now established in
the work of Wiles [Wi] and Wiles-Taylor [Ta-Wi] on the Shimura-Taniyama-
Weil conjecture and Fermat's Last Theorem, see chapter 7. Wiles used vari-
ous sophisticated techniques and ideas due to himself and a number of other
mathematicians (K.Ribet, G.Frey, Y.Hellegouarch, J.-M.Fontaine, B.Mazur,
H.Hida, J.-P.Serre, J.Tunnell, ...). This genuinely historic event concludes a
whole epoque in number theory.
Notice that before the work of Wiles, it was known from results due to
Faltings (see chapter 5, §5.5) that the number of primitive solutions (i.e. such
that GCD(x, y, z) = 1) is ﬁnite for each n > 2. If n is an odd integer then the
left hand side transforms into the following product:
n−1

k=0
(x + ζky) = zn,
(4.1.2)
where ζ = exp(2πi/n) is a primitive nth root of unity. If we suppose that
the ring R = Z[ζ] has unique factorization of elements, then by studying the
divisibility properties of the left hand side of (4.1.1) one can prove that (4.1.1)

116
4 Arithmetic of algebraic numbers
has no solutions in integers not dividing n (this is the ﬁrst case of the Fermat
conjecture: n ∤xyz) (Kummer). However, this unique factorization property is
far from being always satisﬁed: J.M.Masley and H.L.Montgomery (cf. [MM76])
have found all n with this property; it turns out that there are altogether 29
such numbers, and the primes among them are n = 3, 5, 7, 11, 13, 17, 19. Notice
that before the work of Wiles, the validity of the ﬁrst case of Fermat's Last
theorem has been established for inﬁnitely many primes ([AdHB85], [Fou85],
[GM]).
Let α be a complex root of an irreducible polynomial f(x) = xn +
an−1xn−1 + . . . a1x + a0 ∈Q[x] with rational coeﬃcients ai ∈Q. If k = Q(α)
is the smallest ﬁeld containing α then each of its elements β has the form:
β = r(α), where r(x) ∈Q[x] is a polynomial of degree deg r(x) < n, and the
arithmetical operations in Q(α) are the same as those with residues mod f
in the ring of polynomials Q[x].
In other words, there is an isomorphism between k and the quotient
ring Q[x]/(f), and k is an n-dimensional vector space over Q (with basis
1, α, . . . , αn−1). A choice of basis gives another realization of elements of k as
n × n square matrices: to an element β one attaches the matrix of the linear
transformation ϕβ : x →βx (with respect to the chosen basis). For the basis
{1, α, . . . , αn−1} the endomorphism ϕα is described by the matrix (sometimes
called the adjoint matrix):
Aα =
⎛
⎜
⎜
⎜
⎜
⎝
0
0 . . .
0
−a0
1
0 . . .
0
−a1
0
1 . . .
0
−a2
. . . . . . . . . . . .
. . .
0
0 . . .
1 −an−1
⎞
⎟
⎟
⎟
⎟
⎠
,
and the smallest subring of the matrix algebra Mn(Q) containing Aα can be
identiﬁed with k. Each element β ∈k is a root of the characteristic polynomial
of the endomorphism ϕβ, and its determinant and trace are denoted Nβ and
Trβ. These are called the norm and the trace of β. The bilinear form B :
k × k →Q deﬁned by B(u, v) = Tr(uv) is non-degenerate. An element β is
called integral if all of the coeﬃcients bi of its characteristic polynomial
det(X · 1n −ϕβ) = Xn + bn−1Xn−1 + · · · + b0 ∈Q[X]
are integers. This condition is equivalent to saying that the ring Z[β] is a
ﬁnitely generated Abelian group. The set of all integers of k will be denoted
by O = Ok. This is a free Z-module (a free Abelian group) with a basis
ω1, · · · , ωn. The determinant of the bilinear form B(u, v) with respect to such
a basis is called the discriminant of k, and is denoted by D = Dk. This is
independent of the choice of basis of Ok.
The idea of symbolically manipulating the roots of polynomials has lead to
the theory of algebraic extensions of arbitrary ﬁelds, for which one may repeat

4.1 Algebraic Numbers: Their Realizations and Geometry
117
the above constructions. If k ⊂K are two ﬁelds and the dimension [K : k]
is ﬁnite, then for any β ∈K one deﬁnes analogously NK/k(β) and TrK/k(β).
The claim that the form B(u, v) = TrK/k(uv) is non-degenerate is one of the
deﬁnitions of a separable extension. If this is the case one can always ﬁnd an
element γ ∈K such that K = k(γ) (this statement is known as the primitive
element theorem) (cf. [La65], [Sha87]).
Adjoining the roots of all the irreducible polynomials in k[X] to the ground
ﬁeld k leads to the construction of an algebraic closure k of k. This is a
ﬁeld, uniquely deﬁned by k upto isomorphism, which consists of elements
algebraic over k, and which is also algebraically closed. This means that every
polynomial f(X) ∈k[K] with deg f > 0 has a root α ∈k. When we write Q
we often mean the complex realization of this ﬁeld as the set of all complex
numbers α ∈C which are roots of polynomials with rational coeﬃcients.
4.1.2 Galois Extensions and Frobenius Elements
(cf. [La65], [LN83]). In general let K/k be a ﬁnite separable extension, k ⊂
K ⊂k. Then K/k is called a Galois extension if for every embedding λ :
K →k over k (i.e. λ(x) = x for x ∈k) one has λ(K) = K. In this case the
automorphisms λ : K →K over k form a group G(K/k) = Aut(K/k) of order
n which is called the Galois group. In what follows the action of σ ∈G(K/k)
on x ∈K will be denoted either by xσ, or by σ(x) so that the composition
law is (τσ)(x) = τ(σ(x)), xτσ = (xσ)τ (a left action of G(K/k) on K).
Theorem 4.1 (Main Theorem of Galois Theory). There is a one-to-
one correspondence between subgroups H ⊂G(K/k) and intermediate ﬁelds
L with k ⊂L ⊂K. This correspondence is deﬁned by the following law:
H →KH = {x ∈K | xσ = x for all σ ∈H},
L →HL = {σ ∈G(K/k) | xσ = x for all x ∈L}.
The normal subgroups H ◁G(K/k) correspond exactly to the Galois subex-
tensions L/k, and for such subgroups or extensions we have G(L/k) =
G(K/k)/HL.
Example 4.2 (Finite Fields.). Let K = Fq be a ﬁnite ﬁeld with q elements.
Then q = pf and Fq is a vector space of dimension f over the prime subﬁeld
Fp = Z/pZ (cf. [LN83]). For any integer r > 0 the algebraic closure Fq contains
exactly one extension of Fq of degree r:
Fqr = {x ∈Fq | xqr = x},
so that xqr−1 = 1 for all elements of the multiplicative group F×
qr. The exten-
sion Fqr/Fq is therefore a Galois extension, and its Galois group is cyclic of
order r:
G(Fqr/Fq) = {1, Frq, Fr2
q, · · · , Frr−1
q
},
where Frq(x) = xq is the Frobenius automorphism.

118
4 Arithmetic of algebraic numbers
Example 4.3 (Cyclotomic Fields.).
Let ζm be a primitive root of unity of
degree m. Then the ﬁeld Km = Q(ζm) contains all roots of the polynomial
Xm−1 = m−1
i=0 (X−ζi
m) and is therefore a Galois extension. If σ ∈G(Km/Q)
then the element σζm must also be a primitive mth root of unity, so that
σζm = ζa
m for some a with (a, m) = 1. If ζk
m is another mth root of unity then
σ(ζk
m) = ζak
m . Hence the correspondence σ →a(mod m) produces a canonical
map G(Km/Q) →(Z/mZ)× which is in fact an isomorphism. In order to
prove this it suﬃces to show that the cyclotomic polynomial
Φm(X) =
m−1

i=1
(i,m)=1
(X −ζi
m)
is irreducible over Q. First we see that Xm −1 = 
d|m Φd(X), and hence
Φm(X) = 
d|m(Xm/d −1)µ(d) ∈Z[X] (where µ(d) is the Möbius function
of d). The irreducibility is established by reducing the polynomials modulo
p: Z[X] →Fp[X]: f(X) →f(X) ∈Fp[X]. One applies the properties of the
Frobenius endomorphism f(X) →f(X)p = f(Xp) ∈Fp[X] in the ring Fp[X].
Suppose that Φm(X) is not irreducible and let
Φm(X) = f1(X) · · · · · fr(X)
be the decomposition of Φm as a product of irreducible polynomials in Z[X].
We show that for all a mod m with (a, m) = 1, f1(ζm) = 0 implies f1(ζa
m) = 0.
We use the existence of a prime p such that p ≡a mod m. The polynomial
Xm −1 is coprime to its derivative mXm−1 in Fp[X] since p ̸ | m. Hence the
polynomials f 1(X), . . . , f r(X) are pairwise coprime.
If f1(ζa
m) ̸= 0 then we have fj(ζa
m) = 0 for some j ̸= 1, which implies
fj(ζp
m) = 0. Hence f1(X) has a common factor with fj(Xp). In fact since f1 is
irreducible, it must divide fj(Xp). Therefore f 1(X) divides f j(Xp) = f j(X)p.
This contradicts the fact that f 1(X) and f j(X) are coprime.
Note that we do not need to assume the existence of a p such that p ≡
a mod m. We could instead consider the decomposition a = pα1
1 · · · · ·pαs
s
and
study all the reductions mod pi, i = 1, . . . , s (cf. [BS85], [La65], [Chev40],
[La78b], [Wash82]).
Recall that a Dirichlet character χ modulo m is a homomorphism χ :
(Z/mZ)× →C×. These are often regarded as a functions on Z such that
χ(x) = χ(x mod m) if (x, m) = 1, and χ(x) = 0 if (x, m) > 1 (see Part I,
§2.2.2). According to what we have proved, there is a canonical isomorphism
G(Km/Q) ∼= (Z/mZ)×. Hence a Dirichlet character deﬁnes a homomorphism
ρχ : G(Q/Q) →C× by means of the projection G(Q/Q) →G(Km/Q).
Theorem 4.4 (Theorem of Kronecker-Weber). For any homomorphism
ρ : G(Q/Q) →C× of ﬁnite order there exists a Dirichlet character χ such that
ρ = ρχ

4.1 Algebraic Numbers: Their Realizations and Geometry
119
(cf. [Sha51], [AT51], [Chev40]) .
The theorem of Kronecker-Weber can be restated as saying that any Galois
extension K/Q whose Galois group G(K/Q) is commutative (i.e. any Abelian
extension) is contained in a cyclotomic extension.
A remarkable fact is that the elements of the Galois group G(Km/Q)
correspond to prime numbers (more precisely p mod m for p ∤m). The deep-
est results of algebraic number theory are related to generalizations of the
Kronecker-Weber theorem. For example, Deligne and Serre have shown that
there exists a correspondence between two-dimensional irreducible complex
representations ρ : G(Q/Q) →GL2(C) such that detρ = ρχ for an odd charac-
ter χ, and primitive cusp forms of weight one (cf. Chap. 6, §6.4, the theorem of
Deligne-Serre). It is conjectured that this correspondence is one-to-one, and
therefore gives a two-dimensional analogue of the Kronecker-Weber theorem.
4.1.3 Tensor Products of Fields and Geometric Realizations of
Algebraic Numbers
In order to obtain a convenient geometric realization of an algebraic num-
ber ﬁeld k, we use the tensor product k ⊗R. Constructions involving tensor
products of ﬁelds are frequently used in algebraic number theory, and for this
reason we begin with a general result on these products.
Theorem 4.5 (Theorem on Tensor Products of Fields). Let K/k be a
ﬁnite separable extension, K = k(γ), and let L/k be another extension, and
suppose that
K ∼= k[X]/(fγ(X)),
fγ(X) =
m

i=1
gi(X)
is the decomposition as a product of irreducible polynomials in the ring L[X].
Then there is a ring isomorphism
K ⊗k L ∼=
m

i=1
Li,
where Li ∼= L[X]/(gi(X)) are ﬁnite extensions of L containing K under the
embeddings λi : K →Li deﬁned by
λi(r(γ)) = r(X) mod gi(X).
(cf. [CF67], [Chev40]).
The proof of this theorem is similar to that of the Chinese remainder
theorem. The elements r(γ) ⊗k l with l ∈L, r(X) ∈k[X] generate the whole
ring K ⊗k L, and the isomorphism is given by
r(γ) ⊗k l →(lr(X) mod g1(X), · · · , lr(X) mod gm(X)).

120
4 Arithmetic of algebraic numbers
Corollary 4.6. Let β ∈K. If fβ(X) ∈k[X] is its characteristic polynomial
in the extension K/k and fβ,i(X) ∈L[X] are its characteristic polynomials
in the extensions Li/L, then
fβ(X) =
m

i=1
fβ,i.
In particular, we have
NK/k(β) =
m

i=1
NLi/L(λi(β)),
(4.1.3)
TrK/k(β) =
m

i=1
TrLi/L(λi(β)).
(4.1.4)
If we take k for L, then m = n and λ1, . . . , λn are all possible embeddings
λi : K →k,
fβ(X) = (X −λ1(β)) · · · · · (X −λn(β)).
Hence for any β ∈K we have
NK/k(β) =
n

i=1
λi(β),
TrK/k(β) =
n

i=1
λi(β).
(4.1.5)
By putting L = R, K = Q(γ) and k = Q, we obtain a geometric realization
of the algebraic numbers. Let fγ(X) = (X −γ1) · · · · · (X −γr1) · (X2 + α1X +
β1) · · · · · (X2 + αr2X + βr2) be the decomposition of the minimal polynomial
fγ(X) ∈Q[X] of γ into irreducible polynomials over R. Then
K ⊗k R = Q(γ) ⊗R ∼= Rr1 × Cr2
(4.1.6)
(this is an R-algebra isomorphism), or Q(γ) ⊗R ∼= Rn as a real vector space,
so that n = r1 + 2r2. Let λ1, · · · , λr1, · · · , λr1+r2 be the embeddings of 4.1.2.
Then the tuple
λ = (λ1, · · · , λr1, · · · , λr1+r2)
deﬁnes an embedding of K into Rn, and any embedding of K into C is one of
the following
λ1, · · · , λr1, λr1+1, λr1+1, · · · , λr1+r2, λr1+r2.
A lattice M in a vector space Rn is by deﬁnition a discrete subgroup
M ⊂Rn such that the quotient group Rn/M is compact (in the natural
topology). Every lattice is a free Abelian group generated by a basis e1, . . . , en
of Rn.

4.1 Algebraic Numbers: Their Realizations and Geometry
121
If O is the ring of integers in K, then one veriﬁes that its image M =
λ(O) ⊂Rn is a lattice, and
DK = (−4)r2vol(Rn/λ(O)),
(4.1.7)
where DK is the discriminant of K, and vol(Rn/λ(O)) is the volume of
the fundamental parallelogram {n
i=1 xiei | 0 ≤xi ≤1} of the lattice O =
⟨e1, . . . , en⟩with respect to the usual Lebesgue measure on Rn.
For example, let K = Q(α) be a quadratic ﬁeld, where α2 = d for some
square free integer d. Then a calculation of the characteristic polynomial of a
typical element β = a + bα (where a and b are rational numbers) shows that
O = OK = Z[ω] where
ω = 1 + α
2
and DK = d for d ≡1(mod 4),
ω = α and DK = 4d for d ≡2, 3(mod 4).
If d is positive then the geometric realization of the number β = a + bα will
be the point λ(β) = (a+b
√
d, a−b
√
d). In the case of an imaginary quadratic
ﬁeld (d < 0) the geometric realization of the number β = a + bα will be
the point (a + ib

|d|) in the complex plane. Since Z[ω] = ⟨1, ω⟩we have for
positive d
vol2(R2/λ(Z[ω])) =
√
d
if d ≡1 mod 4,
2
√
d
if d ≡2, 3 mod 4,
and for negative d
vol2(C/Z[ω]) =
√
|d|
2
if |d| ≡3 mod 4,

|d|
if |d| ≡1, 2 mod 4.
Figures 4.1 and 4.2 illustrate the lattices of integers in the quadratic ﬁelds
Q(√−1) and Q(
√
2).
4.1.4 Units, the Logarithmic Map, and the Regulator
In the ring Z there are only two invertible elements (units): 1 and -1. The
group of units, i.e. invertible elements of the ring of integers OK of a number
ﬁeld K has a less trivial structure. However, this group can be completely
described. One uses the notation EK = O×
K.
Some interesting arithmetical problems can be reduced to ﬁnding elements
of EK. For example, consider Pell's equation (see Part I, section 1.2.5)
x2 −dy2 = 1
(4.1.8)
(where d is a square free positive integer).

122
4 Arithmetic of algebraic numbers
Fig. 4.1.
Fig. 4.2.
Note that if β ∈O×
K then Nβ and Nβ−1 = N(β−1) are rational integers,
hence Nβ = ±1. Conversely, any solution to (4.1.8) in integers x, y produces
a unit β = x + yα in the real quadratic ﬁeld k = Q(α), α2 = d since Nβ =
(x + y
√
d)(x −y
√
d) = x2 −dy2. On the other hand for all β ∈OK with
Nβ = ±1 we have that β ∈O×
K. It follows from a general theorem of Dirichlet
on the structure of EK for an algebraic number ﬁeld K (the Dirichlet unit
theorem), that for K = Q(
√
d) one has EK = {±εn | n ∈Z}. Here ε is
a fundamental unit (which can be uniquely deﬁned by the condition that
λ1(ε) = a + b
√
d is minimal with λ1(ε) > 1). The set of solutions to (4.1.8)
can be identiﬁed with a subgroup of EK of the form {±εn
0 | n ∈Z}, where
ε0 = x0 + y0
√α corresponds to the minimal solution λ(ε0) = x0 + y0
√
d > 1.
In order to describe the structure of EK in the general case, one uses the
embedding λ : K →K ⊗R ∼= Rr1 × Cr2 and the following logarithmic map
l : (Rr1 × Cr2)× →Rr1+r2 where for i ≤r1 by deﬁnition li(x) = log |x|,
li : R× →R, and for i > r1 li(x) = log |x|2, li : C× →R. Under the map
l ◦λ, multiplication in K becomes addition in Rr1+r2. If x ∈K then in view
of (4.1.3) we know that
Nx = λ1(x) · · · · · λr1(x)λr1+1(x)λr1+1(x) · · · · · λr1+r2(x)λr1+r2(x).
Hence
r1+r2

i=1
li(λi(x)) = log |Nx|.
In particular, the image lλ(O×
K) of O×
K lies in the hyperplane
V =

(x1, . . . , xr1+r2) ∈Rr1+r2

r1+r2

i=1
xi = 0

V ∼= Rr,
r = r1 + r2 −1.
The kernel of the map l : (K ⊗R)× →Rr1+r2 is the following compact set

4.1 Algebraic Numbers: Their Realizations and Geometry
123
{±1}r1 × Sr2 ⊂Rr1 × Cr2 ∼= Rn,
where S = {z ∈C | |z| = 1} is the unit circle. We see that the logarithmic
map provides an eﬀective way of drawing the units: the kernel of lλ : EK →
Rr1+r2 consists of only a ﬁnite number of elements (the roots of unity in K).
Dirichlet's theorem says that the image lλ(EK) is a complete lattice in V ∼= Rr
(where r = r1 +r2 −1). In other words, one can ﬁnd elements ε1, . . . , εr ∈EK
such that any unit ε ∈EK can be uniquely represented in the form
ε = ηεn1
1 · · · · · εnr
r
where ni ∈Z and η is a root of unity in K. In particular, ε1, . . . , εr ∈EK are
multiplicatively independent:
lλ(ε1), . . . , lλ(εr)
form a basis of the hyperplane V . Consider now the volume vol(V/lλ(EK))
of a fundamental parallelogram for the lattice of units (with respect to the
measure on V induced by Lebesgue measure on Rn). The number RK =
vol(V/lλ(EK))/√r + 1 is called the regulator of K and is equal to the absolute
value of the determinant

l1λ1(ε1)
l2λ2(ε1)
· · · lr1+r2λr1+r2(ε1)
· · ·
· · ·
· · ·
· · ·
l1λ1(εr)
l2λ2(εr)
· · · lr1+r2λr1+r2(εr)
(r1 + r2)−1 (r1 + r2)−1 · · ·
(r1 + r2)−1

.
4.1.5 Lattice Points in a Convex Body
We now describe a general geometric idea, on which the proof of the Dirichlet's
theorem, and some other interesting facts (such as bounds for discriminants
and class numbers) is based.
Theorem 4.7 (Minkowski's Lemma on a Convex Body). Let M be a
lattice in Rn, ∆= vol(Rn/M), and let X ⊂Rn be a centrally-symmetric
convex body of ﬁnite volume v = vol(X). If v > 2n∆, then there exists 0 ̸=
α ∈M ∩X.
Proof. In order to prove the lemma, it is convenient to consider the lattice
2M ⊂Rn whose fundamental parallelotope has volume vol(Rn/2M) = 2n∆.
Then under the natural projection of X ⊂Rn onto a fundamental parallelop-
iped Rn/2M there will be overlaps in the image of X, because the volume
of X is bigger than the volume of a fundamental parallelepiped. Hence there
exist two diﬀerent points z1, z2 ∈X, z1 ̸= z2 such that z1 ∼= z2 mod 2M, i.e.
(z1 −z2)/2 ∈M. The proof follows: the point (z1 −z2)/2 ̸= 0 belongs to X in
view of its convexity and central symmetry, since (z1 −z2)/2 = (z1 +(−z2))/2
(if z ∈X then −z ∈X).

124
4 Arithmetic of algebraic numbers
Here are some examples of convex bodies to which we can apply Minkowski's
lemma. Let x0 = (x0
1, . . . , x0
r1+r2) ∈K⊗R, |N(x0)| = r1
i=1 |x0
i | r2
j=1 |x0
r1+j|2
̸= 0. Put
W(x0) =

x ∈K ⊗R | |xi| < |x0
i |, i = 1, . . . , r1 + r2

.
For a positive integer a we put
U(a) =
⎧
⎨
⎩x ∈K ⊗R

r1

i=1
|xi| + 2
r2

j=1
|xr1+j| < a
⎫
⎬
⎭.
A calculation of these volumes shows that
vol(W(x0)) = 2r1πr2|N(x0)|,
vol(U(a)) = 2r1 π
2
r2 an
n! .
(4.1.9)
Applying Minkowski's lemma to the lattice M = λ(OK) and these bodies
(where ∆= 2−r2
|DK| by (4.1.7)), we see that
a) for arbitrary constants ci > 0 (i = 1, . . . , r1 + r2) satisfying the condition
r1

i=1
ci
r2

j=1
c2
r1+j >
 2
π
r2 
|DK| there exists a non zero element α ∈OK
such that
|λi(α)| < ci
(i = 1, . . . , r1 + r2);
(4.1.10)
it suﬃces to take x0 ∈K ⊗R with |x0
i | = ci (i = 1, . . . , r1 + r2) and
α ∈W(x0);
b) for a ≥

n!
 4
π
r2 
|DK|
1/n
there exists β ∈OK, β ̸= 0 from U(a), such
that
r1

i=1
|λi(β)| + 2
r2

j=1
|λr1+j(β)| < a,
hence in view of the inequality between the arithmetic and geometric
means we have the estimate
|N(β)| <
 4
π
r2 n!
nn

|DK|
(|N(β)| ≥1).
(4.1.11)
From (4.1.11) follows the estimate for the discriminant:
|DK| >
π
4
2r2 n2n
(n!)2 =
π
4
2r2 1
2π ne2n−θ/6n (0 < θ < 1)
showing that |DK| grows with n.
Some other remarkable consequences of Minkowski's lemma are:

4.1 Algebraic Numbers: Their Realizations and Geometry
125
Theorem 4.8 (Hermite's Theorem, (1863)). There are only ﬁnitely many
algebraic number ﬁelds with a given discriminant.
Theorem 4.9 (Minkowski's Theorem, (1890)). If K ̸= Q then |DK| > 1.
For the proofs of these theorems cf. [Wei74a].
From the above estimate for the discriminant it follows also that for large
n one has |DK|1/n > (7.3)r1/n(5.9)r2/n. However nowadays much stronger
estimates for discriminants are known: |DK|1/n > (188)r1/n(41)r2/n (for large
n), cf. [Odl75] , [Kuz84]. The latter are deduced from analytic properties of
the Dedekind zeta-function via explicit formulae (cf. §6.2.3 and §6.2.5).
4.1.6 Deduction of Dirichlet's Theorem From Minkowski's Lemma
Consider the hypersurface Tc = {x ∈K ⊗R | |Nx| = c} for a ﬁxed c > 0.
Under the logarithmic map this becomes the aﬃne hyperplane
Vlog c =

y ∈Rr1+r2

r1+r2

i=1
yi = log c

.
The group of units EK acts on Tc by multiplication with λ(ε), ε ∈EK. Under
the logarithmic map the action of ε becomes a translation by the vector lλ(ε),
which maps Vlog c into itself. The number of orbits of this action on Tc∩λ(OK)
is ﬁnite for any ﬁxed c. Indeed it suﬃces to show that if N(α) = N(β) = c ∈Z
and α ≡β( mod c) in the ring OK then α/β ∈EK. In order to see this, notice
that α divides its norm Nα = c. Hence the number β
α = 1 + β−α
α
belongs to
OK. Similarly, α
β ∈OK, hence α
β ∈EK = O×
K.
We now use the results of §4.1.5, and choose some c >
 2
π
r2 
|DK|.
Then for any element x ∈Tc one can ﬁnd an element α ∈OK such that
λ(α) ∈W(x). We use this fact to show that the quotient group V/lλ(EK)
is compact. It suﬃces to show that V = V0 can be covered by translations
of a bounded set by vectors lλ(ε), ε ∈EK. In turn, this is implied by the
analogous statement for any hyperplane parallel to V , for example of the type
Vlog c instead of V0. For any α ∈OK, α ̸= 0, consider the set Yc(α) ⊂Vlog c
consisting of all y = l(x) ∈Vlog c such that λ(α) ∈W(x). Then Yc(α) are all
bounded, Yc(αε) = Yc(α) + lλ(ε) for ε ∈EK, and Minkowski's lemma implies
that any y ∈Vlog c is contained in some Yc(α). On the other hand, we know
that there are only ﬁnitely many classes of α ∈OK with |N(α)| < c modulo
the action of EK. If {αi} is a ﬁnite system of representatives of these classes,
then the desired compact set can be deﬁned to be the union ∪Yc(αi). This
proves the compactness statement; discreteness is implied by the analogous
fact for the lattice λ(OK), and the fact that the logarithmic map restricted
to any hypersurface Tc is a surjective open map onto Vlog c.

4.2 Decomposition of Prime Ideals, Dedekind Domains,
and Valuations
4.2.1 Prime Ideals and the Unique Factorization Property
The original purpose of Dedekind's theory of ideals was to extend the results
of Kummer on Fermat's theorem to a larger class of exponents. Let R be a
commutative ring with unity. An ideal α of R is by deﬁnition an additive
subgroup α ⊂R such that Rα ⊂α. An ideal α ̸= R is called prime iﬀab ∈α
implies a ∈α or b ∈α (i.e. the factor ring R/α has no zero-divisors). An ideal
of the type α = (a) = Ra for a ∈R is called a principal ideal. The notation
(ai)i∈I denotes the smallest ideal containing all ai ∈R, (i ∈I). An element
π ∈R is called prime iﬀπ = ab implies that either a or b is invertible (i.e. a
unit) in R. The reason for the lack of uniqueness of factorization into prime
elements in R, is related to the fact that the ideal (π) generated by a prime
element π is not always prime.
Example 4.10. Let R = Z[√−5] then there are two essentially diﬀerent fac-
torizations into prime elements:
21 = 3 · 7 = (1 + 2
√
−5) · (1 −2
√
−5).
A simple check shows that none of the divisors of two diﬀerent factors in this
identity belong to R. However, the uniqueness of factorization can be restored
if we pass from prime elements to prime ideals. Indeed, the following ideals
are prime:
p1 = (3,
√
−5 −1),
p2 = (3,
√
−5 −2),
p3 = (7,
√
−5 −3),
p4 = (7,
√
−5 −4).
This is implied by the decompositions:
X2 + 5 ≡(X −1)(X −2)(mod 3),
X2 + 5 ≡(X −3)(X −4)(mod 7),
for example,
R/p1 = Z[X]/(3, X −1, X2 + 5) ∼= F3[X]/(X −1) ∼= F3,
in view of the identity (X −1, X2 + 5) = X −1 in F3[X]. Analogously one
proves the decompositions
(3) = p1 · p2,
(7) = p3 · p4,
(1 + 2
√
−5) = p1 · p3,
(1 −2
√
−5) = p2 · p4,
and the factorization (21) = p1p2p3p4 is the unique decomposition as a prod-
uct of four ideals. The ideals (3), (7), (1 + 2√−5), (1 −2√−5) are not prime.

4.2 Decomposition of Prime Ideals, Dedekind Domains, and Valuations
127
A Dedekind domain is by deﬁnition a commutative associative ring with
identity, in which the factorization of non-zero ideals into prime ideals is
unique. This is equivalent to R being a Noetherian (every ideal being ﬁnitely
generated), integrally closed (containing every element of its ﬁeld of fractions
which is integral over R) ring, all of whose non-zero prime ideals are maximal
(i.e. R/p is a ﬁeld).
One can prove that the ring Z[√−5] of our example is a Dedekind do-
main. From the given characterization it follows that for a given number ﬁeld
K, [K : Q] < ∞, the ring of integers OK is a Dedekind domain. It also fol-
lows that no proper subring of OK with the same ﬁeld of fractions can be
a Dedekind ring, since it cannot be integrally closed. For example, the ring
Z[
√
5] is not a Dedekind ring: the ideal (1−
√
5) cannot be decomposed into a
product of prime ideals. However the bigger ring Z[ 1−
√
5
2
] = OK, K = Q(
√
5)
is a Dedekind ring. Thus one can build a good divisibility theory in this class
of rings by replacing elements α by the corresponding ideals and using prime
ideals rather than prime elements. However, the class of Dedekind rings is
quite narrow, and a good divisibility theory can be built in a much larger class
of rings. For example, in the polynomial ring k[x1, x2, . . . , xn] over a ﬁeld k
one has unique factorization of elements, and the prime elements here are the
irreducible polynomials. On the other hand, the existence and uniqueness of
factorization of ideals into prime ideals does not hold in this ring. For instance,
the ideal (x2, y) ⊂k[x, y] does not have such a decomposition. This last exam-
ple explains particularly Kronecker's mistrust of the prime ideals of Dedekind.
Kronecker himself began developing a diﬀerent theory of divisibility, based on
valuations. This is described below (§4.2.5 and §4.3). The history of the con-
troversy between Kronecker and Dedekind is nicely presented by H.Weyl (cf.
[Wey40]).
Fractional ideals. Let OK be the ring of all integers in a number ﬁeld K,
[K : Q] < ∞. A fractional ideal is by deﬁnition a non-zero OK-submodule
α ⊂K such that αα ⊂OK for some α ∈K×. The properties of Dedekind
domains imply that together with a fractional ideal α, the OK-submodule
α−1 = {x ∈K | xα ⊂OK} will also be a fractional ideal. If α and β are
fractional ideals, then αβ is also a fractional ideal. Thus the fractional ideals
form a multiplicative group IK whose identity element is OK. Since OK is
a Dedekind domain, it follows that IK is a free Abelian group in which the
prime ideals p ⊂OK form a basis: every α ∈IK can be uniquely written in
the form:
α = pn1
1 · · · · · pnk
k
(ni ∈Z).
The norm Nα of an integral ideal α ⊂OK is deﬁned to be the number
of elements of the corresponding factor ring: Nα = Card(OK/α), and the
norm of an arbitrary fractional ideal α ∈IK is deﬁned by multiplicativity. If
α = (α) is a principal ideal, then N((α)) = |Nα| = |NK/Qα|: multiplication
by α deﬁnes an endomorphism of the lattice OK, and one easily veriﬁes that

128
4 Arithmetic of algebraic numbers
the absolute value of its determinant coincides with the index of its image:
(OK : (α)) = N((α)).
4.2.2 Finiteness of the Class Number
To each element α ∈K× one can associate (α) ∈IK, so that we have a
homomorphism K×div
→IK. The image of this homomorphism is called the group
of principal ideals, and is denoted by PK. The quotient group ClK = IK/PK
is called the ideal class group. The following result is another corollary of
Minkowski's lemma.
Theorem 4.11. The group ClK is ﬁnite.
The order |ClK| = hK is called the class number of K.
In order to prove the theorem we note that each ideal class can be
represented by an integral ideal (replacing if necessary a by Ma with an
appropriate integer M, and so getting rid of denominators). According to
Minkowski's lemma (see §4.1.5) there exists a non-zero element α ∈a such
that |Nα| <
 2
π
r2 
|DK|Na. We have αOK ⊂a because a is an ideal, i.e.
OK ⊂α−1a. We see now that the index (α−1a : OK) = (OK : αa−1) is
bounded by the constant
 2
π
r2 
|DK|, because
(OK : αa−1) = |N(α)|Na−1 <
 2
π
r2 
|DK|.
If a′ is an arbitrary fractional ideal containing OK and (a′ : OK) = r then
r−1OK ⊃a′ ⊃OK. But it is obvious that the number of intermediate ideals
a′ between r−1OK and OK is ﬁnite. The theorem follows, in view of the fact
that r can take only a ﬁnite number of values.
As we shall see below, this theorem and Dirichlet's unit theorem not only
have similar proofs, but can be incorporated as parts of a more general result
on the structure of the idele class group (cf. [Chev40], [Wei74a]).
The class number plays an exceptionally important role in number theory.
For example the statement hK = 1 is equivalent to saying that OK is a unique
factorization domain. Another example is that the theorem of Kummer from
§4.1.1 on the ﬁrst case of Fermat's Last Theorem
can be extended to all
prime exponents n with the property that hK is not divisible by n, where
K = Q(exp(2πi/n)) is the corresponding cyclotomic ﬁeld.
There have been a number of experimental and empirical observations
of class groups of number ﬁelds made over the years. H. Cohen and H. W.
Lenstra, Jr. in [CoLe83] introduced a heuristic principle that succeeded in pre-
dicting the statistical distribution of ideal class groups of imaginary quadratic
number ﬁelds and totally real abelian number ﬁelds. Many numerically veri-
ﬁed observations are a precise consequence of the Cohen-Lenstra conjecture,
cf. e.g. [Lee02], where a relation with Leopoldt's Spiegelungssatz (cf. [Leo58])
is discussed.

4.2 Decomposition of Prime Ideals, Dedekind Domains, and Valuations
129
4.2.3 Decomposition of Prime Ideals in Extensions
If K is a number ﬁeld with ring of integers OK, and p is a prime number,
then (p) = pOK can be decomposed into a product of prime ideals of OK:
(p) = pk1
1 pk2
2 · · · · · pks
s .
(4.2.1)
The form of the decomposition (4.2.1) for primes p is one of the most im-
portant characteristics of K; if say K/Q is a Galois extensions, then K is
uniquely determined by the set of primes p satisfying (p) = p1p2 · · · · · pn,
where n = [K : Q] (the product of n distinct primes). If this is the case for
p, we say that p splits completely in K. For a general number ﬁeld it is diﬃ-
cult to determine the precise form of the decomposition (4.2.1) for all p. This
problem is related to the deepest questions of algebraic number theory ("non-
commutative class ﬁeld theory", see §6.4). However, for Abelian extensions K,
i.e. Galois extensions K/Q whose Galois group G(K/Q) is commutative, this
decomposition is known. We shall give the precise form of the decomposition
for quadratic ﬁelds K = Q(
√
d) and cyclotomic ﬁelds K = Q(m√
1). This is
done by a general method, applicable to any extension R ⊂S of commuta-
tive rings, where it is supposed that S is a ﬁnitely generated R-module. In
this case each element α ∈S is a root of a normalized (monic) polynomial
f(X) ∈R[X]. For example, one could take f(X) = Xn+an−1Xn−1+· · ·+a0,
ai ∈R (the characteristic polynomial). Let p be a maximal ideal in R. Denote
by α the image of α in the quotient ring S/pS.
Theorem 4.12 (Theorem on the Decomposition of a Maximal Ideal).
Suppose that for an element α ∈S one has S/pS = (R/p)[α] and n =
deg fα(X) = dimR/p S/pS. Choose normalized polynomials g1(X), . . . , gr(X) ∈
R[X] such that
fα(X) ≡g1(X)e1 · · · · · gr(X)er(mod pR[X])
(4.2.2)
where gi(X)(mod pR[X]) are distinct and irreducible in (R/p)[X]. Then the
ideals Pi = (p, gi(α)) are maximal, and the following decomposition holds:
pS = Pe1
1 · · · · · Per
r .
(4.2.3)
The maximality of Pi follows from the isomorphism:
S/Pi ∼= R[X]/(gi(X), p) ∼= (R/p)[X]/(gi(X))
and from the irreducibility of gi(X)(mod pR[X]); the decomposition (4.2.3)
is deduced from an analogue of the theorem on tensor products of ﬁelds, see
4.1.2 (or from the Chinese Remainder theorem):
S/pS ∼= S ⊗R (R/p) ∼=
r

i=1
(R/p)[X]/(gi(X)ei).

130
4 Arithmetic of algebraic numbers
Example 4.13. a) Quadratic Fields (see [BS85], Chapter 2). For a quadratic
extension K = Q(
√
d) (d ∈Z being square free), O = OK = Z[ω] where
ω = 1 +
√
d
2
, fω(X) = X2 −X + (d −1)/4 and DK = d for d ≡1(mod 4),
ω =
√
d and DK = 4d for d ≡2, 3(mod 4).
The result on the decomposition of primes can be conveniently stated in terms
of the quadratic character χK of K. By deﬁnition χK is the unique primitive
Dirichlet character of order 2 modulo |DK| such that χ(−1) = sgn DK. It can
be written explicitly as follows
χK(x) =
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎩

x
|d|

,
if d ≡1(mod 4)
(−1)(x−1)/2 
x
|d|

,
if d ≡3(mod 4)
(−1)(x2−1)/8+(x−1)(d′−1)/4 
x
|d′|

,
if d = 2d′, d′ ≡1(mod 2).
Then p decomposes in OK as follows:
pOK =
⎧
⎪
⎨
⎪
⎩
pp′, p ̸= p′, and Np = Np′ = p
for χK(p) = 1,
p, Np = p2 (i.e. p remains prime)
for χK(p) = −1,
p2, Np = p
for χK(p) = 0.
In order to prove these decompositions one applies the above theorem with
R = Z, S = OK, α = ω, using the decomposition of the corresponding
quadratic polynomial fω(X) mod p, which either has two distinct roots over
Fp, or is irreducible, or has a double root over Fp in the cases when χK(p) = 1,
χK(p) = −1 or χK(p) = 0 respectively. This result can be elegantly rewritten
as an identity for the Euler factors of the Dedekind zeta-function (cf. §6.2.3
below):

p|(p)
(1 −Np−s) = (1 −p−s)(1 −χK(p)p−s) (s ∈C).
(4.2.4)
Example 4.14. b) Cyclotomic ﬁelds. K = Km = Q(ζm). We use the fact OK =
Z[ζm]. Consider the extension Z[ζm] ⊃Z, and take for fα(X) the cyclotomic
polynomial Φm(X) (see 4.1.2). The proof that OK coincides with Z[ζm] is
rather ﬁne but elementary; it is based on a calculation of the discriminant of
R = Z[ζm] which turns out to be equal to
(−1)ϕ(m)/2mϕ(m)/
⎛
⎝
p|m
pϕ(m)/(p−1)
⎞
⎠,
see [BS85].

4.2 Decomposition of Prime Ideals, Dedekind Domains, and Valuations
131
4.2.4 Decomposition of primes in cyslotomic ﬁelds
Theorem 4.15. a) Let p ∤m, then
pR = p1 · · · · · pr,
Npi = pf,
where pi ⊂R are distinct prime ideals, and the number f is equal to the order
of p mod m in (Z/mZ)×, f · r = ϕ(m).
b) If m = pα1
1 · · · · · pαs
s
then
piR = (p′
1 · · · · · p′
r′)ϕ(p
αi
i ) ,
Np′
i = pf ′,
where ϕ(pαi
i ) = pαi−1
i
(pi −1), f ′ is equal to the order of the element pi mod
mp−αi
i
in Z/(mp−αi
i
)Z, and f ′ · r′ = ϕ(mp−αi
i
).
Proof. Note ﬁrst that for prime ideals p ⊂OK the number f = logp Np
coincides with the degree of the corresponding extension of residue ﬁelds:
f = [(OK/p) : Fp], and thus f is the order of the Frobenius automorphism
x →xp, generating the cyclic Galois group G((OK/p)/Fp). Applying the
theorem on the decomposition of maximal ideals we see that it suﬃces to ﬁnd
the form of the decomposition of the cyclotomic polynomial Φm(X) mod p
in Fp[X] into irreducible polynomials.
It follows also that the form of the decomposition depends in this case only
on p mod m. In particular, p splits completely in K ⇐⇒p ≡1 mod m. A
useful observation is that the decomposition of (p) in OKm is fully determined
by the action of the Frobenius endomorphism Frp on the ﬁnite ring OK/(p),
so that in the case p ∤m this endomorphism may be regarded as the element
of the Galois group G(Km/Q):
(Frp : ζm →ζp
m) ⇐⇒p mod m ∈(Z/mZ)× = G(Km/Q).
It is useful for further applications to reformulate theorem 4.15 using the
Dirichlet characters χ : (Z/mZ)× →C×. The conductor of χ is by deﬁnition
the least positive integer m(χ) such that χ can be deﬁned modulo m(χ), i.e.
to which χ factors through the natural projection
(Z/mZ)× pr
−→(Z/m(χ)Z)× χ0
−→C×.
The corresponding character χ0 mod m(χ) is called the primitive Dirichlet
character associated with χ. Theorem 4.15 is equivalent to the following iden-
tity (cf. §6.2.3 below):

p|(p)
(1 −Np−s) =

χ mod
m
(1 −χ0(p)p−s)
(s ∈C).
(4.2.5)
Indeed, the theorem implies that the left hand side has the form (1 −p−fs)r
for p ̸ | m, and (1−p−f ′s)r′ for p|m, where f is equal to the order of p mod m

132
4 Arithmetic of algebraic numbers
in (Z/mZ)×, f · r = ϕ(m), f ′ is equal to the order of the element pi mod m′
(with m′ = mp−αi
i
) in Z/m′Z, and f ′ · r′ = ϕ(m′). It remains to verify the
equation
(1 −T f)r =

χ mod
m
(1 −χ(p)T).
(4.2.6)
Let µf be the group of roots of unity of degree f, then 1−T f = 
µf (1−ζT).
Equations (4.2.5) and (4.2.6) follow from the fact that for any ζ ∈µf there
are exactly r characters χ(mod m) such that χ(p) = ζ (cf. [BS85], [La70],
[Se70]).
4.2.5 Prime Ideals, Valuations and Absolute Values
An alternative approach to the theory of divisibility has arisen from the notion
of the π-order ordπa of an element a ̸= 0, a ∈R for a prime element π
of a unique factorization domain R: here ordπa is deﬁned to be the largest
exponent of π dividing a in R, so that there is a decomposition: a = επk1
1 ·
· · · · πkr
r , in which ki = ordπia, ε ∈R× is a unit.
The function ordπ can be uniquely extended to the ﬁeld of fractions K of
R as a homomorphism ordπ : K× →Z with the following properties:
1) ∀a, b ∈K× ordπ(ab) = ordπa + ordπb,
2) ∀a, b ∈K× ordπ(a + b) ≥min(ordπa, ordπb),
3) a divides b in R ⇐⇒∀π ordπa ≤ordπb,
4) πR = {a ∈R | ordπa > 0} is a prime ideal of R,
5) R = {x ∈K× | ∀π ordπx ≥0} ∪{0}.
Generalizing, for an arbitrary ﬁeld K the notion of a valuation v is introduced
as a function v : K× →Z satisfying the conditions
1) ∀a, b ∈K× v(ab) = v(a) + v(b),
2) ∀a, b ∈K× v(a + b) ≥min(v(a), v(b)).
More often one uses instead of v a multiplicative absolute value: for a ﬁxed ρ,
0 < ρ < 1 put |x|ρ,v = ρv(x), |0|ρ,v = 0.
Deﬁnition 4.16. An absolute value | · | of a ﬁeld K is a real-valued function
x →|x| with non-negative values, such that
1) ∀a, b ∈K× |a · b| = |a| · |b|,
2) ∀a, b ∈K× |a + b| ≤|a| + |b|,
3) |x| = 0 ⇐⇒x = 0.
An absolute value is called non-Archimedean iﬀinstead of 2) the following
stronger inequality is satisﬁed

4.2 Decomposition of Prime Ideals, Dedekind Domains, and Valuations
133
2′) ∀a, b ∈K× |a + b| ≤max(|a|, |b|).
Thus the function | · |ρ,v is a non-Archimedean absolute value. An absolute
value of the type | · |ρ,v is called a discrete absolute value. An example of such
an absolute value is given by the p-adic absolute value |a/b|p = pordpb−ordpa
(a, b ∈Z) of the ﬁeld Q. The usual absolute value |x| of x ∈Q ⊂R is an
Archimedean absolute value of Q.
If | · | is a non-Archimedean absolute value of K, then the subset O =
{x ∈K | |x| ≤1} is a ring with a unique maximal ideal p = {x ∈K | |x| < 1}.
Such rings are called valuation rings. For the discrete absolute value |·| = |·|ρ,v
corresponding to a valuation v, the notation R(v) = O, p(v) = p is used, and
p(v) is a principal ideal generated by any π ∈K such that v(π) = 1.
Now one can deﬁne a divisibility theory on an integral domain R with ﬁeld
of fractions K with the help of a family of valuations Σ = {v} such that the
following properties are satisﬁed:
1) a divides b in R ⇐⇒∀v ∈Σ, v(a) ≤v(b);
2) for all a ∈K× one has v(a) = 0 for all but a ﬁnite number of v ∈Σ;
3) the set R(v) = {x ∈K | v(x) ≥0} ∪{0} uniquely determines v;
4) R = ∩v∈ΣR(v).
If such a family Σ exists then the group of divisors D = DΣ is deﬁned to
be the free Abelian group with basis Σ. Its elements are written additively
as ﬁnite formal sums 
i kivi or multiplicatively 
i pki
vi, where only ﬁnitely
many of the ki are non zero. The following homomorphism is deﬁned
div : K× →D,
div(x) =

v∈Σ
πv(x)
v
.
This homomorphism is called a divisor map on R.
The class of rings with a divisibility theory is larger than the class of
Dedekind rings, and it admits a purely algebraic characterization as the class
of Krull rings. Notice that in order to construct valuations, not all of the
prime ideals of the ring are used. If we try to deﬁne for a prime ideal p ⊂R
a valuation v by putting for a ∈R, v(a) = min {n ≥0 | a ∈pn}, then we
succeed only when the localization Rp of R with respect to p is a Noetherian,
integrally closed ring with a unique maximal ideal, where
Rp = {x = a/b | a, b ∈R, b ̸∈p}.
The idea of using valuations rather than prime ideals, which arose from
the study of algebraic numbers, has turned out to be very fruitful in algebraic
geometry. In turn, developments in algebraic geometry have lead to a number
of inventions in number theory (cf. Chapters 5 and 6).
To conclude this section we remark that all absolute values of Q either have
the form |x|α (0 < α < 1, |x| being the usual absolute value of x ∈Q ⊂R), or
have the form |x|α
p (α > 0, where |x|p is the p-adic absolute value of x ∈Q).
This result is due to Ostrowski, cf. [BS85], [Chev40].

4.3 Local and Global Methods
4.3.1 p-adic Numbers
The idea of extending the ﬁeld Q appears in algebraic number theory in var-
ious diﬀerent guises. For example, the embedding Q ⊂R often gives useful
necessary conditions for the existence of solutions to Diophantine equations
over Q or Z. The important feature of R is its completeness: every Cauchy
sequence {αn}∞
n=1 in R has a limit α (a sequence is called Cauchy if for any
ε > 0 we have |αn −αm| < ε whenever n and m are greater than some large
N = N(ε)). Also, every element of R is the limit of some Cauchy sequence
{αn}∞
n=1 with αn ∈Q.
An analogous construction exists using the p-adic absolute value | · |p of
Q (see §2):
| · |p : Q →R≥0 = {x ∈R |x ≥0}
|a/b|p = pordpb−ordpa,
|0|p = 0,
where ordpa is the highest power of p dividing the integer a. This general
construction of "adjoining the limits of Cauchy sequences" to a ﬁeld k with an
absolute value | · | leads to a completion of k. This completion, often denoted
ˆk, is complete, and contains k as a dense subﬁeld with respect to the extended
absolute value | · |, [BS85], [Kob80].
As was noted at the end of §2, all absolute values of Q are equivalent either
to the usual Archimedean absolute value, or to the p-adic absolute value.
Thus any completion of Q is either R, or Qp, the ﬁeld of p-adic numbers, i.e.
the completion of the ﬁeld of rational numbers Q with respect to the p-adic
absolute value. Using the embeddings Q →R and Q →Qp (for all primes
p) many arithmetical problems can be simpliﬁed. An important example is
given by the following Minkowski-Hasse theorem [BS85], [Cas78], [Chev40]:
the equation
Q(x1, x2, . . . , xn) = 0,
(4.3.1)
given by a quadratic form Q(x1, x2, . . . , xn) = 
i,j aijxixj, aij ∈Q has a
non-trivial solution in rational numbers, iﬀit is non-trivially solvable over
R and over all Qp. There are very eﬀective tools for ﬁnding solutions in Qp.
These tools are somewhat analogous to those for R such as the "Newton -
Raphson algorithm", which in the p-adic case becomes Hensel's lemma.
The simplest way to deﬁne the p-adic numbers is to consider expressions
of the type
α = ampm + am+1pm+1 + . . . ,
(4.3.2)
where ai ∈{0, 1, . . . .p−1} are digits to the base p, and m ∈Z. It is convenient
to write down α as a sequence of digits, inﬁnite to the left:

4.3 Local and Global Methods
135
α =
⎧
⎨
⎩· · · am+1am
m−1 zeros
&
'(
)
000 . . . 0 (p),
if m ≥0,
· · · a1a0.a−1 · · · am(p),
if m < 0.
These expressions form a ﬁeld, in which algebraic operations are executed
in the same way as for natural numbers n = a0 + a1p + . . . arpr, written
as sequences of digits to the base p. Consequently, this ﬁeld contains all the
natural numbers and hence all rational numbers. For example,
−1 = p −1
1 −p = (p −1) + (p −1)p + (p −1)p2 + · · · = · · · (p −1)(p −1)(p);
−a0
p −1 = a0 + a0p + a0p2 + · · · = · · · a0a0a0(p).
For n ∈N the expression for −n = n · (−1) of type (4.3.2) is obtained if we
multiply the above expressions for n and for −1. Generally, for α ∈Q write
α = c −a
b , where a, c ∈Z, b ∈N, 0 ≤a < b, i.e. a/b is a proper fraction.
Then by an elementary theorem of Euler, pϕ(b) −1 = bu, u ∈N. Hence
−a
b =
au
pϕ(b) −1,
and au < bu = pr −1, r = ϕ(b). Now let au be written to the base p as
ar−1 · · · a0(p), then the expression of type (4.3.2) for α is obtained as the sum
of the expression for c ∈N and
−a
b = · · · a0
r digits
&
'(
)
ar−1 · · · a0
r digits
&
'(
)
ar−1 · · · a0(p).
For example, if p = 5,
9
7 = 2 −5
7 = 2 + 5 · 2232
1 −56
c = 2 a = 5, b = 7,
so that
2232 = 32412(5) = 3 · 54 + 2 · 53 + 4 · 52 + 1 · 5 + 2,
thus
9
7 = · · ·
& '( )
324120
& '( )
324120324122(5).
It is easy to verify that the completion of Q with respect to the p-adic
metric | · |p can be identiﬁed with the described ﬁeld of p-adic expansions
(4.3.2), where |α|p = pm for α as in (3.2) with am ̸= 0 (see Koblitz N. (1980)).
It is curious to compare the expansions (4.3.2) inﬁnite to the left with the
ordinary expansions of real numbers α ∈R, inﬁnite to the right:
α = amam−1 · · · a0.a−1 · · · = am10m + am−110m−1 + · · · a0 + a−110−1 + · · · ,

136
4 Arithmetic of algebraic numbers
where ai ∈{0, 1, · · · , 9} are digits, am ̸= 0. These expansions to any natural
base lead to the same ﬁeld R. Also, a given α can possess various expressions of
this type, e.g. 2.000 · · · = 1.999 · · · . However, in the p-adic case the expressions
(4.3.2) are uniquely determined by α. This fact provides additional comfort
when calculating with p-adic numbers.
The ﬁeld Qp is a complete metric space with the topology generated by
the "open discs":
Ua(r) = {x | |x −a| < r}
(x, a ∈Qp, r > 0)
(or "closed discs" Da(r) = {x | |x −a| ≤r}). From the topological point of
view, the sets Ua(r) and Da(r) are both open and closed in Qp.
An important topological property of Qp is its local compactness: all discs
of ﬁnite radius are compact. The easiest way to show this is to consider any
sequence {αn}∞
n=1 of elements αn ∈Da(r) and to construct a limit point.
Such a point may be found step-by-step using the p-adic digits (4.3.2). One
knows that the number of digits "after the point" is bounded on any ﬁnite
disc. In particular, the disc
Zp = D0(1) = {x | |x|p ≤1} =

x = a0 + a1p + a2p2 + · · ·

is a compact topological ring, whose elements are called p-adic integers. Zp is
the closure of Z in Qp. The ring Zp is local, i.e. it has only one maximal ideal
pZp = U0(1) with residue ﬁeld Zp/pZp = Fp. The set of invertible elements
(units) of Zp is
Z×
p = Zp\pZp = {x | |x|p = 1} =

x = a0 + a1p + a2p2 + · · · | a0 ̸= 0

.
For each x ∈Zp its Teichmüller representative
ω(x) = lim
n→∞xpn
is deﬁned. This limit always exists and satisﬁes the relations: ω(x)p = ω(x),
ω(x) ≡x mod p. For example, if p = 5, we have
ω(1) = 1;
ω(2) = 2 + 1 · 5 + 2 · 52 + 1 · 53 + 3 · 54 · · · ;
ω(3) = 3 + 3 · 5 + 2 · 52 + 3 · 53 + 1 · 54 + · · · ;
ω(4) = 4 + 4 · 5 + 4 · 52 + 4 · 53 + 4 · 54 + · · · = −1;
ω(5) = 0.
The ring Zp can also be described as the projective limit
lim
←−
n
Z/pnZ
of rings An = Z/pnZ with respect to the homomorphisms ϕn : An →An−1 of
reduction modulo pn−1. The sequence

4.3 Local and Global Methods
137
· · ·
ϕn+1
−→An
ϕn
−→An−1
ϕn−1
−→· · ·
ϕ3
−→A2
ϕ2
−→A1
(4.3.3)
forms a projective system indexed by positive integers n ≥1. The projective
limit of the system is deﬁned as a ring
lim
←−
n
An
with the following universal property: there are uniquely deﬁned projections
πn : lim
←−
n
An →An
such that for an arbitrary ring B and a system of homomorphisms ψn : B →
An compatible with each other under the condition: ψn−1 = ϕn◦ψn for n ≥2,
there exists a unique homomorphism ψ : B →A such that ψn = πnψ (cf.
[Kob80], [Se70]). Note that the uniqueness of A is implied from its existence
by abstract nonsense. Hence for the ring Zp it suﬃces to deﬁne the projections
πn : Zp →Z/pnZ, and to check the universal property using digits as in
(4.3.2).
Analogously,
Z×
p = lim
←−
n
(Z/pnZ)×,
and one can describe the structure of the multiplicative group Q×
p .
Put ν = 1 for p > 2 and ν = 3 for p = 2, and deﬁne
U = Up = {x ∈Zp|x ≡1 mod pν}.
Then there is an isomorphism U
∼
→Zp from the multiplicative group Up to the
additive group Zp, which is given by combining the natural homomorphism
U
∼
→lim
←−
n
U/U pn
with the special isomorphisms
αpn : U/U pn
∼
→Z/pnZ,
given by
αpn((1 + pν)a) = a mod pn (a ∈Z).
(4.3.4)
One easily veriﬁes that (4.3.4) is well deﬁned and gives the desired isomor-
phism. Therefore, the group U is a topological cyclic group, and 1+pν can be
taken as its generator. Another proof of this fact is obtained using the power
series
log(1 + x) =
∞

n=1
(−1)n+1 xn
n .
which deﬁnes an isomorphism from U onto pZp
One has the following decompositions
Q×
p = pZ × Z×
p ,
Z×
p ∼= (Z/pνZ)× × U.
(4.3.5)

138
4 Arithmetic of algebraic numbers
4.3.2 Applications of p-adic Numbers to Solving Congruences
The ﬁrst appearances of p-adic numbers, in papers by Hensel, were related to
the problem of ﬁnding solutions to congruences modulo pn. An application of
this method by his student H.Hasse to the theory of quadratic forms has lead
to an elegant reformulation of this theory, without the use of considerations
over the residue rings Z/pnZ. These considerations are tiring because of the
zero-divisors in Z/pnZ. From the above presentation of Zp as the projective
limit
lim
←−
n
Z/pnZ
it follows that for f(x1, . . . , xn) ∈Zp[x1, . . . , xn], the congruences
f(x1, . . . , xn) ≡0(mod pn)
are solvable for all n ≥1 iﬀthe equation
f(x1, . . . , xn) = 0
is solvable in p-adic integers. Solutions in Zp can be obtained using the fol-
lowing p-adic version of the "Newton - Raphson algorithm".
Theorem 4.17 (Hensel's Lemma). Let f(x) ∈Zp[x] be a polynomial in
one variable x, f ′(x) ∈Zp[x] its formal derivative, and suppose that for some
α0 ∈Zp the initial condition
|f(α0)/f ′(α0)2|p < 1
(4.3.6)
is satisﬁed.
Then there exists a unique α ∈Zp such that
f(α) = 0,
|α −α0| < 1.
We prove this by induction using the sequence of "successive approxima-
tions":
αn = αn−1 −f(αn−1)
f ′(αn−1).
Taking into account the formal Taylor expansion of f(x) at x = αn−1 one
shows that this sequence is Cauchy, and its limit α has all the desired prop-
erties (cf. [CF67], [BS85], [Se70]).
For example, if f(x) = xp−1 −1, then any α0 ∈{1, 2, . . . , p −1} satisﬁes
the condition |f(α0)|p < 1 At the same time f ′(α0) = (p−1)αp−2
0
̸≡0 mod p,
hence the initial condition (3.6) is satisﬁed. The root α coincides then with
the uniquely deﬁned Teichmüller representative of α0: α = ω(α0).
The method described is applicable to polynomials in many variables,
although for more than one variable the p-adic solution is not unique (cf.
[BS85], [Kob80], [Se70]).

4.3 Local and Global Methods
139
Another interesting application of Hensel's Lemma is related to describing
the squares of the ﬁeld Qp: for an arbitrary
α = pm · v ∈Qp (m ∈Z, v ∈Z×
p ),
the property that α is a square is equivalent to saying that
a) for p > 2, m ∈2Z, and v = v mod p ∈(Z/pZ)×2 (i.e.

v
p

= 1, where

v
p

is the Legendre symbol (see §1.1.5));
b) for p = 2, m ∈2Z and v ≡1 mod 8.
The solvability of x2 = α in Qp under conditions a) and b) is implied by
Hensel's Lemma, and the necessity of these conditions is deduced more triv-
ially from considerations modulo p and modulo 8.
As a corollary we give the following description of the quotient group
Q×
p /Q×
p
2
a) for p > 2 it is isomorphic to Z/2Z × Z/2Z with the system of coset
representatives {1, p, v, pv},

v
p

= −1;
b) for p = 2 it is isomorphic to Z/2Z×Z/2Z×Z/2Z with the system of coset
representatives {±1, ±5, ±2, ±10}.
4.3.3 The Hilbert Symbol
In this subsection we allow p = ∞, in which case we write Q∞for the ﬁeld of
real numbers R. The Hilbert symbol (or norm residue symbol)
(a, b) =
a, b
p

=
a, b
p

= (a, b)p
is deﬁned for a, b ∈Q×
p by
(a, b) =

1,
if the form ax2 + by2 −z2 has a non-trivial zero in Qp;
−1,
otherwise.
It is clear that (a, b) depends only on a and b modulo squares. There is a
asymmetric form of the deﬁnition, namely (a, b) = 1 iﬀ
a = z2 −by2 for some y, z ∈Qp.
(4.3.7)
Indeed, from (4.3.7) it follows that (1, y, z) is a non-trivial zero of the
quadratic form ax2 + by2 −z2. Conversely, if (x0, y0, z0) is a non-trivial zero,
then one can obtain all other zeros using a geometric trick in which one draws

140
4 Arithmetic of algebraic numbers
secants from the point (x0, y0, z0) in all directions given by vectors with co-
ordinates in Qp (see §1.2.3). Using this method we may reduce to the case
x0 ̸= 0. Then (y0/x0, z0/x0) satisﬁes (4.3.7).
Local properties of the Hilbert symbol:
a)
(a, b) = (b, a);
(4.3.8)
b)
(a1a2, b) = (a1, b)(a2, b),
(a, b1b2) = (a, b1)(a, b2);
(4.3.9)
c)
if (a, b) = 1 for all b, then a ∈Q×
p
2;
(4.3.10)
d)
(a, −a) = 1 for all a;
(4.3.11)
e)
if p ̸= 2, ∞and |a|p = |b|p = 1, then (a, b) = 1.
(4.3.12)
In particular for a ﬁxed b, the a for which (a, b) = 1 form a multiplicative
group. Equation (4.3.7) expresses the fact that a is a norm from the quadratic
extension Qp(
√
b)/Qp (cf. [BS85], [Cas78], [Chev40], [Se70]).
A calculation of the Hilbert symbol makes it possible to solve completely
the "global" question on the existence of non-trivial rational zeros of quadratic
forms (in view of the Minkowski-Hasse theorem). If, say
Q(x, y, z) = ax2 + by2 + cz2 (a, b, c ∈Q, c ̸= 0),
(4.3.13)
then (4.3.13) has a non-trivial zero over Q iﬀ(−a/c, −b/c)p = 1 for all p
including p = ∞. This criterion is very eﬀective because for almost all p we
have |a|p = |b|p = 1, whence (a, b)p = 1 for p ̸= 2, ∞in view of (3.8e). We
give a table of the values of (a, b)p:
Table 4.1.
The Hilbert symbol for p > 2. Here v denotes an element v ∈Z such
that
 v
p

= −1, and ε = 1 iﬀ−1 ∈Q×
p
2 (i.e. iﬀp ≡1 mod 4). Otherwise ε = −1
a
1
v
p
pv
b
1
+1
+1
+1
+1
v
+1
+1
−1
−1
p
+1
−1
ε
−ε
pv
+1
−1
−ε
ε
A global property of the Hilbert symbol (the product formula). Let a, b ∈
Q×. Then (a, b)p = 1 for almost all p and

p including ∞
(a, b)p = 1.
(4.3.14)
Formula (4.3.14) is equivalent to the quadratic reciprocity law (see part I,
§1.1.5). Indeed, by (4.3.12) one has |a|p = |b|p = 1 for all but a ﬁnite number

4.3 Local and Global Methods
141
of p, hence (a, b)p = 1 for p ̸= 2, ∞in view of (4.3.12). Denote the left hand
side of (4.3.14) by f(a, b), then by (4.3.9) one has
f(a1a2, b) = f(a1, b)f(a2, b),
f(a, b1b2) = f(a, b1)f(a, b2),
and one veriﬁes that f(a, b) = 1 when a and b run through the set of generators
of the group Q×: −1, 2, −q an odd prime.
Table 4.2. The Hilbert symbol for p = 2.
a
1
5
−1
−5
2
10
−2
−10
b
1
+1
+1
+1
+1
+1
+1
+1
+1
5
+1
+1
+1
+1
−1
−1
−1
−1
−1
+1
+1
−1
−1
+1
+1
−1
−1
−5
+1
+1
−1
−1
−1
−1
+1
+1
2
+1
−1
+1
−1
+1
−1
+1
−1
10
+1
−1
+1
−1
−1
+1
−1
+1
−2
+1
−1
−1
+1
+1
−1
−1
+1
−10
+1
−1
−1
+1
−1
+1
+1
−1
In what follows we shall need an analogous product formula for the nor-
malized absolute values | · |p.
The product formula for absolute values. Let a ∈Q×. Then |a|p = 1 for all
but a ﬁnite number of p, and

p including ∞
|a|p = 1.
(4.3.15)
Indeed, if a ∈Q×, then
a = ±

p̸=∞
pvp(a),
where vp(a) ∈Z and vp(a) for all but a ﬁnite number of p. The product
formula now follows from the identities:
|a|p = p−vp(a) (for p ̸= ∞),
|a|∞=

p̸=∞
pvp(a).
In §4.3.6 we discuss the global properties of absolute values in more detail.

142
4 Arithmetic of algebraic numbers
4.3.4 Algebraic Extensions of Qp, and the Tate Field
If K is a ﬁnite algebraic extension of Qp then K is generated over Qp by some
primitive element α ∈K. The element α is a root of an irreducible polynomial
of degree d = [K : Qp],
f(x) = xd + ad−1xd−1 + ... + a0 ∈Qp[x].
The absolute value | · |p has a unique extension to K deﬁned by
|β|p = (|NK/Qp(β)|p)1/d,
(4.3.16)
where NK/Qp(β) ∈Qp is the algebraic norm of the element β ∈K. Formula
(4.3.16) deﬁnes a unique extension of | · |p to the algebraic closure Qp of
Qp. The uniqueness of this extension can easily be deduced from the local
compactness of K as a ﬁnite-dimensional Qp-vector space: all of its norms
over Qp are equivalent (the same thing happens for Rn). It then follows from
the multiplicativity of absolute values that any two must coincide.
The function ordp can then also be extended to Qp by setting ordpα =
logp |α|p. Formula (4.3.16) implies that ordpK× is an additive subgroup of
1
dZ. Hence ordpK× = 1
eZ for some positive integer e dividing d. We shall call
e the ramiﬁcation index of the extension K/Qp.
Put
OK = {x ∈K| |x|p ≤1} , pK = {x ∈K| |x|p < 1}.
(4.3.17)
Then pK is the maximal ideal in OK and the residue ﬁeld OK/pK is a ﬁnite
extension of degree f of Fp. One has the relation d = e · f, in which f is
called the inertial degree of the extension. For each x ∈OK its Teichmüller
representative is deﬁned by
ω(x) = lim
n→∞xpfn,
ω(x) ≡x (mod pK),
(4.3.18)
and satisﬁes the equation
ω(x)pf = ω(x).
The map ω provides a homomorphism from the group of invertible elements
O×
K = OK \ pK = {x ∈K| |x|p = 1}
of OK onto the group of roots of unity of degree pf −1 in K, denoted by
µpf −1. One also has an isomorphism
(OK/pK)× ∼
→µpf −1 ⊂O×
K.
(4.3.19)
The structure of the multiplicative group K× can be described analogously
to (4.3.5): if [K : Qp] = d, then

4.3 Local and Global Methods
143
K× = πZ × O×
K,
O×
K ∼= (OK/pK)× × UK,
(4.3.20)
where π is a generator of the principal ideal pK = πOK (i.e. any element
π ∈K× with ordpπ = 1/e),
UK =

x ∈O×
K| |x −1|p < 1

= D1(1−; K).
The structure of the group UK is then described as a direct product of d copies
of the additive group Zp and a ﬁnite group consisting of all p-power roots of
unity contained in K.
Example 4.18. If e = 1 then the extension K is called unramiﬁed. In this case
f = d and the Teichmüller representatives generate K over Qp. Therefore
K = Qp(11/N),
N = pd −1.
On the other hand, if e = d then the extension K is called totally ramiﬁed. For
example, if ζ is a primitive root of unity of degree pn, then Qp(ζ) is totally
ramiﬁed of degree d = pn −pn−1, and we have that
ordp(ζ −1) =
1
pn −pn−1 .
(4.3.21)
The Tate Field. For purposes of analysis it is convenient to embed Qp into
a bigger ﬁeld, which is complete both in the topological and in the algebraic
sense. This ﬁeld is constructed as the completion Cp = *Qp of an algebraic
closure Qp of Qp with respect to the unique absolute value satisfying the
condition |p|p = 1
p. The proof that Cp is algebraically closed is not diﬃcult.
We shall use the notation
Op = {x ∈Cp| |x|p ≤1},
p = {x ∈Cp| |x|p < 1}.
Note that the Op and p are no longer compact, so the ﬁeld Cp is not locally
compact. We also have that Op/p = Fp is an algebraic closure of Fp.
4.3.5 Normalized Absolute Values
If F is a locally compact ﬁeld, then its topology can by given by an absolute
value. This fact is deduced from the existence of a Haar measure µ on a
locally compact group G, i.e. a measure invariant under group shifts x →gx
(x, g ∈G):

G
f(x) dµ(x) =

G
f(x) dµ(gx) ≡

G
f(g−1x) dµ(x)
for all integrable functions f : G →R. This measure is deﬁned uniquely up to
a multiplicative constant. However, we do not need a general construction of
dµ (cf. [Wei40]), and we point out only some concrete examples.

144
4 Arithmetic of algebraic numbers
If G = R (the additive group) then dµ(x) = dx (Lebesgue measure), and
d(x + a) = dx, a ∈R. If G = R× (the multiplicative group), then dµ = dx
x .
If G = C, z = x + iy ∈C, then dµ = dx dy.
If K/Qp is an extension of degree d, and q = pf is the number of elements
of the residue ﬁeld OK/pK, then the measure dµ on the additive group K
is uniquely determined by the number

OK dµ = µ(OK) = c > 0; one has
µ(a + pK) = cq−1, because the measures of all of the sets a + pK are equal
and OK =
∪
a mod
pK(a + pK). More generally, for all n ∈Z and a ∈K one has
µ(a + pn
K) = cq−n.
(4.3.22)
Any measure dµ on the additive group of a locally compact ﬁeld F deﬁnes
an absolute value ∥· ∥: F →R≥0: for a ∈F × the number ∥a∥is deﬁned as
the multiple, by which the two Haar measures dµ(x) and dµ(ax) on F diﬀer:
µ(aU) = ∥a∥µ(U),
(4.3.23)
where U is an open subset of positive measure, µ(U) =

U dµ(x). The multi-
plicativity property
∥αβ∥= ∥α∥· ∥β∥(α, β ∈F ×)
(4.3.24)
follows immediately from deﬁnition (4.3.23). If the topology of F is non-
discrete, i.e. not all subsets are open, then one veriﬁes, that discs of ﬁnite
radius Da(r) = {x ∈F | ∥x −a∥≤r} are compact, and the function ∥· ∥is
continuous. Hence this function is bounded on such discs. In particular,
∥1 + α∥≤C for ∥α∥≤1
(4.3.25)
for a positive constant C ≥1. From (4.3.25) it follows that
∀α, β ∈F
∥α + β∥≤Cmax(∥α∥, ∥β∥)
(4.3.26)
which is weaker than that in the deﬁnition of an absolute value from §4.2.
These functions are called generalized absolute values. If for example F = C,
and U = {z = x+iy ∈C | |z| = 1}, then µ(wU) = |w|2µ(U), where |w|2 = ww,
and (4.3.26) is satisﬁed with C = 4. However, if for all n ∈N one has ∥n∥≤1,
then C = 1, so that ∥· ∥is a non-Archimedean absolute value.
In particular, for an extension K/Qp with [K : Qp] = d put
U = OK,
α = πmv (m ∈Z, v ∈O×
K),
where π is a uniformizing element, pK = (π). We have ∥α∥= q−m = p−fm.
Since p = πeu for some u ∈O×
K, we obtain
∥p∥= µ(pOK)/µ(OK) = |OK/pOK|−1 = p−d.
This proves the formula d = e · f.

4.3 Local and Global Methods
145
4.3.6 Places of Number Fields and the Product Formula
We shall call two (generalized) absolute values ∥· ∥1 and ∥· ∥2 of a ﬁeld F
equivalent if ∥x∥1 = ∥x∥c
2 for all x ∈F and for a constant c > 0. A class of
equivalent absolute values is called a place of F, and it will be denoted by v.
The symbol Fv denotes the corresponding completion (with respect to one of
the equivalent absolute values in v).
The theorem of Ostrowski (see §4.2) says that every place of Q is either
v = p (p a prime), or v = ∞. If the place v is non-Archimedean, then we
let the same symbol v denote the valuation of F normalized by the condition
v(F ×) = Z.
We list places of ﬁnite extensions F of Q. To do this we construct all
possible extensions to F of absolute values on Q, since the restriction to Q of
any absolute value on F is an absolute value of Q. More generally, let F/k
be a ﬁnite separable extension of k with an absolute value | · |v (for example,
k = Q and v = p or v = ∞); f(x) ∈k[x] the irreducible polynomial of degree
n = [F : k] of a primitive element α for F over k, and let
f(x) =
m

j=1
gj(x)
(gj(x) ∈L[x])
(4.3.27)
be the decomposition of f(x) into polynomials irreducible over L, where L =
kv is the completion of k with respect to v.
In view of the theorem on tensor products of ﬁelds (see §4.1.3), there is a
ring isomorphism
F ⊗k L ∼=
m

j=1
Lj,
(4.3.28)
where Lj ∼= L[x]/(gj(x)) is the ﬁnite extension of L containing F via λj :
F →F ⊗k L →Lj.
In §4.3.4 we saw that there exists a unique absolute value on Lj extending
| · |v from L = kv, where it is canonically deﬁned as on the completion. Let
us denote this extended absolute value on Lj by the same symbol | · |v and
deﬁne an absolute value | · |v,j on F using the embedding λj by putting
|β|v,j = |λj(β)|v.
(4.3.29)
It is not diﬃcult to verify that all the |·|v,j are diﬀerent, and that they are the
only extensions of |·|v from k to F, such that (4.3.28) becomes an isomorphism
of topological rings. Thus there are no more than n = [F : k] extensions of
an absolute value | · |v of k to F. These extensions are described explicitly
by (4.3.29), assuming one knows the decomposition (4.3.27). Formula (4.3.16)
shows that
|λj(β)|v =
nj
+
|NLj/L(λj(β))|v,

146
4 Arithmetic of algebraic numbers
where nj = [Lj : L] = deg gj(x) is the local degree.
To obtain the normalized absolute value ∥· ∥v,j we put for β ∈F ×
∥β∥v,j = |NLj/L(λj(β))|v.
Then for all β ∈F × one has:
m

j=1
∥β∥v,j = |NF/k(β)|v.
(4.3.30)
This follows from NF/k(β) = m
j=1 NLj/L(λj(β)) in view of §4.1.3. Product
Formula for Normalized Absolute Values. Let k/Q be a ﬁnite extension, α ∈
k×, and let |·|v run through the normalized absolute values of k. Then |α|v = 1
for all but a ﬁnite number of v, and the following product formula holds

v
|α|v = 1.
(4.3.31)
This is easily deduced from formula (4.3.30), in which we put k/Q instead
of F/k and notice that Nk/Q(α) ∈Q×. It then suﬃces to apply the already
proven product formula for Q, see (4.3.15).
Global Fields. We use the term "global ﬁeld" to refer to either a ﬁnite ex-
tension of Q (an algebraic number ﬁelds) or a ﬁnite, separable extension of
Fq(t), where Fq is the ﬁeld with q elements and t is a (transcendental) vari-
able (a function ﬁeld with positive characteristic) [AW45], [AT51] , [Wei74a],
[CF67], [BoCa79].
In every global ﬁeld there is a product formula and a similar classiﬁcation
of the normalized absolute values. Many problems concerning integers have
natural analogies in function ﬁelds. These analogies can sometimes be more
successfully treated using methods of algebraic geometry, and they provide
a rich source of intuition for the number ﬁeld case (see §4.5, §5.2, §6.5, and
Introductory survey to Part III).
4.3.7 Adeles and Ideles
The Ring of Adeles.
In arithmetical questions the ring Z is often considered as a lattice in R,
i.e. a discrete subgroup of the additive group of the locally compact ﬁeld R
with compact quotient group R/Z, the quotient being isomorphic to a circle. It
turns out, that for a global ﬁeld k one can canonically construct the "smallest"
locally compact ring Ak, containing k as a lattice. This means that k is a
discrete subring in Ak with compact additive quotient group Ak/k. The ring
Ak, which is called the ring of adeles is constructed using all the embeddings
k →kv, where v runs through the set Σ = Σk of all places of k. One deﬁnes

4.3 Local and Global Methods
147
Ak to be the subring of the product 
v∈Σ kv consisting of all inﬁnite vectors
α = (αv)v∈Σ, αv ∈kv such that αv ∈Ov for all but a ﬁnite number of v. In
view of §4.3.6 the number of Archimedean places does not exceed n = [k : Q].
Hence all but a ﬁnite number of places are non-Archimedean, and the compact
subring Ov ⊂kv is deﬁned to be the valuation ring of v):
Ak =
(4.3.32)

α = (αv) ∈

v∈Σ
kv
 αv ∈Ov for all but a ﬁnite number of v

.
One gives Ak the topology generated by the open subsets of the type
WS =

v∈S
Wv ×

v̸∈S
Ov,
(4.3.33)
where S runs through all ﬁnite subsets S ⊂Σ, and Wv are open subsets in kv.
The set WS is compact (has compact closure) if all the Wv are bounded. Hence
Ak is a locally compact topological ring in which k is embedded diagonally
k ∋α →(· · · , α, α, · · · )v∈Σ ∈Ak ⊂

v∈Σ
kv
(note that in view of §4.3.6 |α|v = 1 for all but a ﬁnite number of v ∈Σ). It is
interesting to note that the product 
v∈Σ kv is too big to be locally compact:
by deﬁnition of the product topology, the projection of any open subset U ⊂

v∈Σ kv onto kv coincides with kv for almost all v, thus U would never be
compact having non-compact image under a continuous map (projection).
The above construction of Ak is called the restricted topological product of the
topological spaces kv with respect to the compact subspaces Ov deﬁned for
all but a ﬁnite number of indices v. The convergence of a sequence {α}∞
n=1,
αn = (αv,n)v ∈Ak to β = (βv) ∈Ak means that for any ε > 0 and any ﬁnite
set S ⊂Σ there exist N ∈N such that
1) ∀n > N ∀v ̸∈S αn,v −βv ∈Ov,
2) ∀n > N ∀v ∈S |αn,v −βv|v < ε.
Every principal adele α, i.e.
α = (· · · , α, α, · · · )v ∈k ⊂Ak
(4.3.34)
can be separated from the rest of k by a neighborhood of type (4.3.33) with
S = {v ∈Σ | α ̸∈Ov}. Hence k is discrete in Ak. The compactness of the
quotient group Ak/k has an explanation via the Pontryagin duality theory of
locally compact commutative topological groups: Ak/k is isomorphic to the
group ˆk of all characters of k. Recall that for a locally compact group G its
group of continuous characters

148
4 Arithmetic of algebraic numbers
ˆG = Homcontin(G, S1)
(4.3.35)
(where S1 = {z ∈C× | |z| = 1}) is again a locally compact group in the
natural topology of the character group; one always has G∧∧= G, and for
any exact sequence
1 →G1 →G →G2 →1
with continuous homomorphisms, the dual sequence for characters is exact:
1 →ˆG2 →ˆG →ˆG1 →1.
By the association G →ˆG, ﬁnite groups remain ﬁnite; discrete groups become
compact groups (and conversely), and for a connected group G its dual ˆG is
torsion free. If H ⊂G is a closed subgroup, then its annihilator
H⊥=
,
χ ∈ˆG | χ(H) = 1
-
(4.3.36)
is isomorphic to (G/H)ˆ.
In the simplest example Z ⊂R one has Z∧∼= S1, S1∧∼= Z, and the
group R is self-dual: R∧∼= R (the number t ∈R corresponds to the character
(x →e2πixt), so that Z⊥∼= Z.
One can verify that the additive group Ak is self dual, and α ∈Ak corre-
sponds to the character (β →χ(αβ)) ∈ˆAk, where χ is a non-trivial additive
character of Ak satisfying χ(k) = 1, so that k ∼= k⊥= (Ak/k)∧.
Consider in detail the case k = Q, and the ring A = AQ. For α = (αv)v ∈A
the fractional parts {αv} are deﬁned (for v = p one uses the p-adic expansion
(4.3.2) to deﬁne {αv} = a−1p−1 + · · · + ampm for m < 0). Then for all but a
ﬁnite number of v we have that {αv} = 0, and {α} = 
v̸=∞{αv} is a rational
number. The character χ can be deﬁned by the formula
β →exp(−2πi{β∞}) ·

v̸=∞
exp(2πi{βv}),
(4.3.37)
and for each β ∈Q× one has χ(β) = 1.
For each component v the character χv : Q×
v →S1 is deﬁned by
χv(β) = exp(2πi{β})
(β ∈Qv), which provides the self-duality of the locally compact ﬁeld Qv
(v = p, ∞) in a similar way: an element t ∈Qv corresponds to the character
x →χv(tx). This also gives us a description of the quotient group
A/Q ∼= R/Z ×

p
Zp,
(4.3.38)
which is easily seen by subtracting from an adele α its fractional part

4.3 Local and Global Methods
149
{α} =

v̸=∞
{αv} ∈Q.
(4.3.39)
The quotient group A/Q is compact by the theorem of A.N.Tychonov on
products of compact spaces. For a number ﬁeld k it is useful to consider the
isomorphism of topological rings
Ak ∼= k ⊗AQ,
(4.3.40)
which implies an isomorphism of additive groups A(+)
k
∼= (A(+)
Q )n, where
n = [k : Q], and also statements on the discreteness of k in Ak and on the
compactness of the quotient group Ak/k. One veriﬁes easily that an analogous
isomorphism takes place for an arbitrary extension of global ﬁelds F/k:
AF ∼= F ⊗k Ak.
(4.3.41)
The Idele Group
(cf. [Chev40], [Wei74a]). The set of all invertible elements of a ring R forms a
multiplicative group R×. If R is topological, the topology on R× is deﬁned by
means of the embedding x →(x, x−1) (R →R×R) so that the inversion map
x →x−1 is continuous. The idele group Jk of a global ﬁeld k is the topological
group A×
k of invertible elements of the ring Ak. The group Jk coincides with
the restricted topological product of the locally compact groups k×
v with respect
to the compact subgroups O×
v deﬁned for non-Archimedean places v ∈Σ.
4.3.8 The Geometry of Adeles and Ideles
The embedding of k into its ring of adeles Ak is reminiscent of the geometric
interpretation of the ring of integers O = Ok of k as a lattice in the R-algebra
k∞= k ⊗R ∼=

v|∞
kv ∼= Rr1 × Cr2,
λ : O →k∞.
(4.3.42)
This analogy goes much further. Consider a Haar measure µ on the locally
compact additive group Ak; this measure can be deﬁned on the open subsets
WS of type (4.3.33) by
µ(WS) =

v∈S
µv(Wv),
(4.3.43)
where µv(Ov) = 1 for v ̸ | ∞(i.e. for non-Archimedean v); for Archimedean
places one normalizes the measure as follows:
µv =

dx
(Lebesgue measure)
if kv ∼= R,
2dx dy = |dz ∧dz|
if z = x + iy ∈kv ∼= C.

150
4 Arithmetic of algebraic numbers
If β = (βv) ∈Jk is an idele, then its module is deﬁned to be the mul-
tiplicative constant |β|, by which the Haar measures µ(x) and µ(βx) on Ak
diﬀer:
µ(βx) = |β| · µ(x).
(4.3.44)
It follows from the description (4.3.43) of µ that |β| = 
v |βv|v, where | · |v
is the normalized absolute value from the class of a place v ∈Σ, which for
Archimedean places is given by the following:
|x|v =

|x|
(the usual absolute value)
if kv ∼= R,
|z|2 = zz
if z = x + iy ∈kv ∼= C.
On the compact quotient group Ak/k we deﬁne a measure µ by means
of a general notion of fundamental domain: if Γ is a discrete subgroup of a
locally compact group G, then a fundamental domain X for G modulo Γ is
a complete set of coset representatives for (left) cosets G/Γ, which has some
additional measurability properties. By restricting the Haar measure α of G
onto the subset X, one obtains a uniquely deﬁned measure on G/Γ, which is
denoted by the same letter, and α(G/Γ) = α(X).
In order to construct a fundamental domain X for Ak/k we choose a Z-
basis ω1, · · · , ωn of the free Abelian group O ⊂k of algebraic integers in k.
This is also a basis of the vector space k∞= k ⊗R over R, and it deﬁnes an
isomorphism θ : Rn ∼
→k∞by the formula
θ((u1, . . . , un)) =
n

i=1
uiωi.
Denote by I the interval 0 ≤t < 1 in R. Then θ(In) is a fundamental paral-
lelogram for the lattice O in k∞(see 1.3). Now take X to be the set
X = θ(In) ×

v̸ |∞
Ov
(4.3.45)
(a fundamental domain for k in Ak). To prove that X is a fundamental do-
main, we note that k∞+ k is dense in Ak. This statement is known as the
approximation theorem and it is a version of the Chinese remainder theorem
(cf. §1.1.5). Moreover, k∞× 
v Ov is an open subgroup in Ak, hence for any
x ∈Ak there exists η ∈k such that
x −η ∈k∞×

v
Ov.
The condition that another element η′ ∈k has the same property is equivalent
to saying that η −η′ ∈Ov for all non-Archimedean places v, i.e. that η −η′ ∈
Ok. Thus by an appropriate choice of η we may assume that the y∞-coordinate

4.3 Local and Global Methods
151
of y = x−η belongs to θ(In); therefore y∞= θ(u), u ∈In, where u is uniquely
determined. This establishes the statement.
The ﬁrst application of the measure constructed on Ak/k is a simple proof
of the product formula (4.3.31): if β ∈k× ⊂Jk is a principal idele, then
βk× = k× in Jk, and multiplication by β deﬁnes a homeomorphism of Ak/k
with itself, hence the Haar measures µ(x) and µ(βx) on Ak/k must coincide,
i.e. by (4.3.44) we see that
|β| =

v
|βv|v = µ(βAk/k)
µ(Ak/k) = 1.
Let us calculate the measure µ(Ak/k). The form of the fundamental do-
main X constructed reduces this calculation to the problem of determining
the volume of the fundamental parallelogram θ(In) in k∞. This volume was
already found in §4.1.3, (4.1.7). We obtain
µ(Ak/k) = |Dk|1/2,
(4.3.46)
where Dk = det(Tr(ωiωj)) is the discriminant of k. Here we have taken into
account that the measure 
v|∞µv on k∞diﬀers by a multiple of 2 from the
Lebesgue measure on those components v such that kv ∼= C, when
d µv(z) = 2dx dy = |dz ∧dz| for z = x + iy ∈kv ∼= C.
Consider the constant
C =
 2
π
r2 
|Dk|.
(4.3.47)
This number is important for ﬁnding non-zero points β in the lattice k ⊂Ak
belonging to a parallelotope, i.e. to a set of the form
V (c) = {x = (xv)v ∈Ak | ∀v ∈Σk |xv|v ≤cv},
(4.3.48)
such that c = (cv) is an inﬁnite tuple of positive constants deﬁned for the
places v of k, all but a ﬁnite number of which are 1.
Lemma 4.19 (Blichfeldt). Assume that for the numbers cv we have that

v
cv > C =
 2
π
r2 
|Dk|.
Then there exist β ∈k× ∩V (c) ⊂Ak.
Proof. Consider the auxiliary parallelotope V (c′), c′ = (c′
v)v, v ∈Σ, where
⎧
⎪
⎨
⎪
⎩
c′
v = cv,
if vis non-Archimedean
c′
v = cv/2, if kv ∼= R
c′
v = cv/4,
if z = x + iy ∈kv ∼= C.

152
4 Arithmetic of algebraic numbers
Then one can calculate the measure of V (c′):
µ(V (c′)) =
π
2
r2 
v
cv >

|Dk|.
In other words, the measure of V (c′) is bigger than that of the fundamental
domain for Ak/k, hence there exist two distinct points y and y′ ∈V (c′) whose
images modulo k coincide, i.e. y−y′ ∈k×. We obtain for the number β = y−y′
the following estimates:
|β|v ≤
⎧
⎪
⎨
⎪
⎩
max(|yv|v, |y′
v|v) ≤cv
if v is non-Archimedean,
2max(|yv|v, |y′
v|v) ≤cv
if kv ∼= R,
4max(|yv|v, |y′
v|v)
if z = x + iy ∈kv ∼= C,
proving the lemma.
We now turn our attention to the structure of the idele group. Consider the
homomorphism | · |v : Jk →R×
+, which takes y = (yv)v ∈Jk to |y| = 
v |yv|v.
Denote by J1
k its kernel, then J1
k is a closed subgroup, and in view of the
product formula (3.27) we have that k× ⊂J1
k. The following theorem is one
of the most important facts in algebraic number theory.
Theorem 4.20. The quotient group J1
k/k× is compact.
The proof relies on Blichfeldt's lemma, and is very similar to the proof of
Dirichlet's unit theorem, and the deduction of the latter from Minkowski's
lemma. One can show that this theorem is equivalent to the conjunction of
Dirichlet's unit theorem and the ﬁniteness of the ideal class group (see §4.1.6
and §4.2.2). These two statements can be easily deduced from the above the-
orem as follows:
The Divisor Map. Let Ik be the group of fractional ideals (divisors), i.e.
the free Abelian group generated by the set of non-Archimedean places of k.
Deﬁne
div : Jk −→Ik,
div((xv)) =

v̸ |∞
v(xv) · v,
(4.3.49)
where v denotes as agreed above the valuation of k normalized by the condition
v(k×) = Z. Note that div(Jk) = Ik, and that changing only the Archimedean
component x∞= (xv)v|∞of an idele x does not change div(x). Note also
that div(k×) = Pk is the subgroup of principal ideals in the discrete group
Ik. Hence we have a continuous epimorphism div : J1
k/k× →Ik/Pk = Clk
of a compact group onto a discrete group. The image is both compact and
discrete, and is therefore ﬁnite.
The Logarithmic Map and S-Units. Let S ⊂Σ be a ﬁnite set of places
containing the set Σ∞of all Archimedean places. The set of elements η ∈k×
satisfying |η|v = 1 for all v ̸∈S forms a multiplicative group, which is denoted
by ES and is called the group of S-units.

4.3 Local and Global Methods
153
Theorem 4.21 (Theorem on S-Units). The group ES is the direct sum of
a ﬁnite cyclic group and a free Abelian group of rank s −1, where s = Card S
is the number of places in S.
(cf. [La70]). The proof of this theorem is similar to that of Dirichlet's unit
theorem (see §4.1.4). One considers the logarithmic map
l : Jk −→R ⊕· · · ⊕R
(
)&
'
s times
(4.3.50)
(where R is the additive group of real numbers), deﬁned by
l((xv)v) = (· · · , log |xv|v, · · · )v∈S.
This map is continuous, and its image contains a basis of the vector space Rs
(if S = Σ∞then l is an epimorphism).
With the help of (4.3.49) and (4.3.50) it is not diﬃcult to describe fun-
damental domains for k× in Jk and J1
k (cf. [Wei74a], pp.137-139]). One can
calculate the volume ˜γ(J1
k/k×) with respect to the Haar measure ˜γ on J1
k/k×.
We normalize the measure ˜γ by using the decomposition:
Jk/k× ∼= J1
k/k× × R×
+,
γ =

˜γ × dx
|x|

,
(4.3.51)
in which
γ =

v
γv
is the Haar measure on Jk, normalized as follows:
⎧
⎪
⎨
⎪
⎩
γv(O×
v ) = 1
if v is non-Archimedean,
dγv(x) = |x|−1dx
if kv ∼= R,
dγv(z) = |zz|−1|dz ∧dz| = 2dx dy
if z = x + iy ∈kv ∼= C.
Then the following formula holds:
˜γ(J1
k/k×) =
2r1
(2π)r2 hRk, w, = κk,
(4.3.52)
where h = |Clk| is the class number of k; Rk is the regulator, and w = wk is
the number of roots of unity in k, see 4.1.3. This formula means that for any
positive number m > 1 in R the subset C(m) of Jk/k× deﬁned by C(m) =
{x ∈Jk/k× | 1 ≤|x| ≤m} has measure
γ(C(m)) = κk log m.
(4.3.53)
The quantities R = Rk, h = hk and D = Dk turn out to be the most
important constants characterizing a number ﬁeld k. These quantities occur
together in formulae (4.3.52) and (4.3.53) for the volumes of fundamental

154
4 Arithmetic of algebraic numbers
domains, and are not independent. According to a deep result of Brauer and
Siegel (cf. [La70], [La83]), one knows that for a sequence of number ﬁelds
km of degrees nm = [km : Q] satisfying the condition nm/ log |Dkm| →0 as
m →∞, the following asymptotic relation holds
log(hkm · Rkm) ∼log(|Dkm|)1/2.
(4.3.54)
The idele class group
Ck = Jk/k×
plays a key role in classifying the Abelian extensions of k (class ﬁeld theory),
cf. §4.4.
If k = Q then there are isomorphisms
JQ/Q× ∼= R×
+ ×

p
Z×
p ,
(4.3.55)
J1
Q/Q× ∼=

p
Z×
p ,
(4.3.56)
which are easily established by dividing an idele α ∈JQ by its (multiplicative)
divisor div(α) = 
p pvp(αp), which in this situation turns out to be a positive
rational number. As a result one obtains the element α · sign(α∞) · div(α)−1,
which belongs to the right hand side of (4.3.55).

4.4 Class Field Theory
4.4.1 Abelian Extensions of the Field of Rational Numbers
(cf. [AT51], [Chev40], [Wei74a]). One of the central objects of algebraic number
theory is the full Galois group G = G(Q/Q) of Q over Q, together with its
subgroups H ⊂G of ﬁnite index, which correspond to ﬁnite extensions k of
Q:
H = Gk = G(Q/k) ⊂G.
From the topological point of view G is a compact, totally disconnected group,
with the topology of a proﬁnite group (the projective limit of its ﬁnite quotient
groups):
G ∼= lim
←−
k
G/Gk = lim
←−
k
G(k/Q),
where Gk are normal subgroups which are both closed and open, as they
correspond to ﬁnite Galois extensions k/Q.
Class ﬁeld theory provides a purely arithmetical description of the maximal
Abelian (Hausdorﬀ) quotient group Gab
k
= Gk/Gc
k, where Gc
k is the closure
of the commutator subgroup of Gk. Moreover, one has this description both
for algebraic number ﬁelds and for function ﬁelds (global ﬁelds of positive
characteristic). One form of this description of Gab
k
is given by a calculation
of all characters (one-dimensional complex representations) of the full Galois
group Gk.
The topological structure of inﬁnite Galois groups is similar to that of lo-
cally compact analytic Lie groups over p-adic ﬁelds such as SLn(Qp), Spn(Qp)
etc. The use of analytic methods such as the representation theory of Lie
groups and Lie algebras, has developed drastically in recent decades. These
techniques are related to non-commutative generalizations of class ﬁeld theory
(see §6.5). We ﬁrst describe the group Gab
Q starting from the Kronecker-Weber
theorem, which says that every Abelian extension k of Q (i.e. an extension
whose Galois group G(k/Q) is Abelian) is contained in a cyclotomic ﬁeld
Km = Q(ζm), where ζm is a primitive root of unity of degree m (see §4.1.2).
There is an isomorphism
ψm : (Z/mZ)× −→Gm = G(Km/Q),
(4.4.1)
which associates to a residue class a (mod m) ∈(Z/mZ)×, (a, m) = 1 an
automorphism σ = σa = ψm(a) ∈Gm given by the condition ζσ
m = ζa
m.
The arithmetical isomorphism (4.4.1) makes it possible to regard Dirichlet
characters χ : (Z/mZ)× →C× as one-dimensional representations
ρχ : G
πm
−→Gm
ψm
−→(Z/mZ)×
χ
−→C×,
(4.4.2)
where G
πm
−→Gm is the natural homomorphism restricting the action of the
Galois automorphisms to the subﬁeld Km; ρχ = χ ◦ψm ◦πm. Hence each

156
4 Arithmetic of algebraic numbers
character ρ : G →C× has the form ρ = ρχ for some χ. For example a quadratic
extension k = Q(
√
d) is contained in the cyclotomic extension Q(ζ|D|), where
D is the discriminant of k. This is easily shown using Gauss sums: for the
quadratic character χ = χk of k we have G(χ)2 = D. Hence G(χ) = ±
√
D ∈
K|D|. Recall that χ is a primitive quadratic character modulo |D| which is
uniquely determined by the condition χ(−1) = sign D. The ﬁeld k corresponds
by Galois theory to the subgroup Kerρ ⊂G(K|D|/Q) of index 2, ρ = ρχk.
By the Kronecker-Weber theorem, the maximal Abelian extension Qab
can be described as the union of all Km, and its Galois group coincides with
the projective limit of the groups Gm ∼= (Z/mZ)×, that is
Gab ∼= lim
←−
m
(Z/mZ)×,
where the limit is taken over the system of natural projection homomorphisms
(Z/m1Z)× →(Z/m2Z)×
for m2 dividing m1. Hence the group Gab coincides with the group 
p Z×
p of
invertible elements of the ring ˆZ = 
p Zp (the proﬁnite completion of the ring
of integers).
A more invariant formulation of this isomorphism is based on the intro-
duction of the ring of adeles A and its multiplicative group J = A×, the ideles
of Q (see §4.3.7 and §4.3.8). The group J consists of all inﬁnite vectors
α = (α∞; α2, α3, . . . , αp, . . . ) ∈R× ×

p
Q×
p ,
such that αp ∈Z×
p for all but a ﬁnite number of p. The quotient A×/U1 is
discrete. According to (4.3.55) we have
J/Q× ∼= R×
+ ×

p
Z×
p ,
where R×
+ is the multiplicative group of all positive real numbers.
The group Gab is therefore isomorphic to the quotient of J/Q× by the
connected component of 1:
Gab ∼=

p
Z×
p ∼= J/R×
+Q×.
(4.4.3)
The important feature of this isomorphism is that the elements of Gm, and
hence of Gab, have an arithmetical nature; they correspond to prime numbers.
Namely, a prime p not dividing m corresponds to its Frobenius element σ =
σp : ζm →ζp
m. The set of all primes corresponding to a ﬁxed element σ ∈Gm is
inﬁnite by Dirichlet's theorem on primes in arithmetical progressions. This set
coincides with the set of primes of type p = a+km (k ∈Z), where σ = ψm(a).

4.4 Class Field Theory
157
The automorphism σ is called the Frobenius automorphism (and denoted Frp
or Frobp) for the following reason: if we consider the ring Om = Z[ζm] of all
integers in Km then in the reduction Om/pOm we have Frp(x) = xp, i.e. Frp
acts as the Frobenius automorphism. The way that p splits into prime ideals in
Om depends only on the image of p in the Galois group Gm ∼= (Z/mZ)× (see
§4.1.2). The idea of associating a Galois automorphism to a prime number (or
prime ideal) leads to the isomorphism (4.4.3), in which to Frp one associates
the class of the idele
πp = (1; 1, · · · , 1, p, 1, · · · ) in J/(R+ × Q×).
The ﬁeld Km corresponds to the open subgroup
Um = R×
+ ×

p|m
(1 + mZp)× ×

p̸ |m
Z×
p ⊂J,
so that Gm ∼= J/UmQ×, [La73/87]. This formulation of the result is very easy
to extend to the general case of the group Gab
k
for arbitrary global ﬁelds k.
Note that the set of all primitive Dirichlet characters can be identiﬁed with
the discrete group of all characters of ﬁnite order of the idele class group Ck
(k = Q) using the projection
J/Q× ∼= R+ ×

p
Z×
p →Gm.
Such characters are all trivial on the connected component of the identity.
Abelian extensions of Q correspond bijectively to open subgroups of J/R×
+Q×,
and any such group is the intersection of the kernels of a ﬁnite number of
Dirichlet characters.
4.4.2 Frobenius Automorphisms of Number Fields and Artin's
Reciprocity Map
Let K be an algebraic number ﬁeld, [K : Q] = n, Σ0
K the set of all ﬁnite
places of K (normalized discrete valuations which correspond to prime ideals
pv ̸= 0 in the ring of integers OK of K);
pv = {x ∈OK | |x|v < 1}.
The residue ﬁeld k(v) = OK/pv is ﬁnite, having Nv = pdeg v
v
elements, where
pv = Char k(v) is the characteristic and deg v = fv is the degree of the
extension (or inertial degree) of k(v) over Fpv. The absolute value is normalized
by the condition
v(x) = −logNv |x|v
(|x|v = Nv−v(x)).
(4.4.4)
The ramiﬁcation index ev of v is the number v(pv). With this notation one
has the following decomposition pOK = 
v,v(p)>0 pev
v .

158
4 Arithmetic of algebraic numbers
Let L/K be a ﬁnite Galois extension with Galois group G(L/K), and let
w be a place of L, which extends a ﬁxed place v of K. Deﬁne the action of
the group G(L/K) on the places w ∈ΣL by w →σw,
|x|σw = |xσ−1|w.
If v and w are non-Archimedean, pv and Pw being the corresponding prime
ideals, then σw corresponds to the ideal Pσw = Pσ
w. A Galois automorphism
σ ∈G(L/K) induces an isomorphism of the completions σ : Lw
∼
→Lσw as
normed vector spaces over Kv.
The decomposition group Gw is introduced as the subgroup
Gw = {σ ∈G(L/K) | σw = w} ⊂G(L/K).
(4.4.5)
By deﬁnition we have that
Gτw = {σ ∈G(L/K) | στw = τw} = τGwτ −1.
On the other hand, it is immediate from the explicit construction of the ex-
tensions of places, that G(L/K) acts transitively on the set of places of L
lying over a ﬁxed place v of K. Hence all the corresponding subgroups Gw are
conjugate [Wei74a].
The inertia group Iw ⊂Gw is by deﬁnition the kernel of the natural
homomorphism Gw = G(Lw/Kv) →G(l(w)/k(v)) where l(w) denotes the
residue ﬁeld of the place w. The quotient group Gw/Iw ∼= G(l(w)/k(v)) is
generated by the Frobenius automorphism: G(l(w)/k(v)) = ⟨Frw⟩, Frw(x) =
xNv. The place w is called unramiﬁed iﬀIw = {1}; in this case one has
Gw = ⟨Frw⟩. It follows from the deﬁnitions that Frτw = τ −1Frwτ, so that the
conjugacy class of Frw in G(L/K), if deﬁned, can depend only on v. It turns
out that all but a ﬁnite number of places are unramiﬁed; for such places we
put
FL/K(v) = (the conjugacy class of Frw for w|v).
(4.4.6)
If G(L/K) is commutative, then the right hand side of (4.4.6) consists of one
element.
The Artin reciprocity law tells us where the Frobenius elements FL/K are
situated in a commutative Galois group G(L/K). Let S be a ﬁnite set of
places of K, including all Archimedean places and those places ramiﬁed in
the extension L/K. Denote by IS the free Abelian (multiplicative) group
generated by the elements pv for v ̸∈S. Then the association v →FL/K(v) ∈
G(L/K) extends to a homomorphism
FL/K : IS −→G(L/K),
(4.4.7)
which is called Artin's reciprocity map,

4.4 Class Field Theory
159
FL/K
⎛
⎝
v̸∈S
pnv
v
⎞
⎠=

v̸∈S
FL/K(v)nv.
(4.4.8)
Class ﬁeld theory gives an explicit description of the kernel of the Artin
reciprocity map (4.4.7) (see section §4.4.5 below). The statement that (4.4.7)
is surjective was established ﬁrst, and it could be deduced from the general
Chebotarev density theorem, which is a far-reaching generalization of Dirich-
let's theorem on primes in arithmetical progressions (cf. [Chebo25], [Se70],
[Se68a], [Chev51]).
Let P be a subset of the set Σ0
K of all non-Archimedean places of K. For
any integer x ≥1 denote by ax(P) the number of places v ∈P such that
Nv ≤x. We say that P has density a ≥0 if the limit exists
lim
x→∞
ax(P)
ax(Σ0
K) = a.
(4.4.9)
Not every set of places has a density. For example, if K = Q and P is the set
of primes whose ﬁrst digit is equal to 1, then P does not have a density.
By the prime number theorem one has ax(Σ0
K) ∼x/ log x, hence the con-
dition (4.4.9) is equivalent to the following asymptotic expression
ax(P) = a
x
log x + o

x
log x

.
(4.4.10)
4.4.3 The Chebotarev Density Theorem
Theorem 4.22. Let L/K be a ﬁnite extension of a number ﬁeld K, and X
a subset of G(L/K), invariant under conjugation. Denote by PX the set of
places v ∈Σ0
K unramiﬁed in L such that the classes of Frobenius elements
of these places belong to X: FL/K(PX) ⊂X. Then the set PX has a density,
which is equal to Card X/Card G(L/K).
The proof is based on analytic methods; the notion of the analytic density
of P is introduced as the limit
lim
s→1+

v∈P Nv−s
log

1
s−1
 .
(4.4.11)
Proving the existence of and calculating this limit for P = PX can be done
with the help of the Artin L-functions (see §6.2.2); the density statement in
the above sense (4.4.9) can then be deduced (cf. [Chev40], [La70]).
4.4.4 The Decomposition Law and
the Artin Reciprocity Map
If L/K is an Abelian extension, then the decomposition of pv in OL is com-
pletely determined by the order f of the element FL/K(v) ∈G(L/K): in this

160
4 Arithmetic of algebraic numbers
case pv = Pw1 · · · · · Pws, where s = (G(L/K) : ⟨σ⟩) and f = f(wi/v) =
deg wi/ deg v = [l(wi) : k(v)] is the relative residue ﬁeld degree. This fact is
deduced from the transitivity of the action of the Galois group G(L/K) on
the set of places w dividing v. In particular, the place v splits completely (i.e.
f = 1 and v is unramiﬁed) iﬀFL/K(v) = 1 ∈G(L/K).
Theorem 4.22 shows that a ﬁnite Galois extension G(L/K) is uniquely
determined (in a ﬁxed algebraic closure K) by the set SplL/K of places which
split completely in L/K. The Artin reciprocity law gives us amongst other
things a description of this set when L/K is Abelian. For non-Abelian exten-
sions there are only some special cases when SplL/K is known. However these
examples provide a basis for quite general conjectures (the Langlands program,
see §6.5. These conjectures determine nowadays one of the main directions in
modern algebraic number theory.
4.4.5 The Kernel of the Reciprocity Map
In order to formulate the main result on the kernel of the reciprocity map
(4.4.7) we recall that the relative norm NL/K(w) of a non-Archimedean place
w is deﬁned as pf(w/v)
v
(or, in additive terms, as f(w/v) · v), where
f(w/v) = deg w/ deg v = [l(w) : k(v)] = logNv Nw
is the relative degree of residue ﬁelds. Also, consider the divisor map (see
(4.3.49))
divS : K× →IS,
divS(a) =

v̸∈S
pv(a)
v
∈IS,
where S is the set of all Archimedean places and places ramiﬁed in L/K.
Let L/K be an Abelian extension of K, f = 
v pr(v)
v
an ideal in OK,
divisible by suﬃciently high powers r(v) of the prime ideals ramiﬁed in L. For
each Archimedean place v ∈Σ∞
K we ﬁx an embedding
a →a(v) ∈C,
K →Kv ⊂C,
which induces v, and let
Σ∞
L/K = {v ∈Σ∞
K | Kc ∼= R, Lw ∼= C for w|v}.
Deﬁne the subgroups PL/K(f), NL/K(f) ⊂IS by
PL/K(f) =
,
divS(a)
 a ∈K×, a ≡1 mod f, ∀v ∈Σ∞
L/K a(v) > 0
-
,
(4.4.12)
NL/K(f) = ⟨NL/K(w)⟩w̸∈S,
(4.4.13)
the latter being the subgroup generated by the relative norms of prime divisors
of those places v (or ideals pv) which are unramiﬁed in L/K.

4.4 Class Field Theory
161
Theorem 4.23 (The Artin Reciprocity Law). Let L/K be an Abelian
extension. Then
KerFL/K = PL/K(f) · NL/K(f).
(4.4.14)
Corollary 4.24 (Description of the Galois group). For an Abelian ex-
tension L/K the reciprocity map (4.4.7) induces an isomorphism
G(L/K) ∼= IS/(PL/K(f)NL/K(f)).
4.4.6 The Artin Symbol
Consider the group JK of ideles, and deﬁne a surjective homomorphism
(·, L/K) : JK →G(L/K),
s →(s, L/K)
(4.4.15)
with the help of the reciprocity map (4.4.7). For an arbitrary s ∈JK let us
choose a principal idele α ∈K× such that |αsv −1|v < ε for v ∈S and
suﬃciently small ε > 0. Deﬁne the S-divisor (cf. (4.3.49)) by
div(αs) =

v
pv(αsv)
v
∈IS.
Then the Artin symbol (s, L/K) = ψL/K(s) is deﬁned by the formula
(s, L/K) = ψL/K(s)
def
= FL/K(div(αs)).
(4.4.16)
We stress that (4.4.16) is deﬁned in terms of ideles, and in order to show
that (4.4.16) is well deﬁned it is essential that the reciprocity law in terms of
ideals (4.4.14) is satisﬁed. Indeed, the condition on α in (4.4.16) is satisﬁed
if div(α) ∈PL/K(f) with an appropriate choice of f. Now the reciprocity
law transforms into the statement that KerψK/L coincides with K×NL/KJL,
where NL/KJL is the subgroup of relative norms of ideles from JL:
NL/K((βw)w) =
⎛
⎝
w|v
NLw/Kv(βw)
⎞
⎠
v
.
(4.4.17)
Hence the Artin symbol ψL/K in (4.4.16) is deﬁned for idele classes s ∈CK =
JK/K×. Furthermore FL/K(v) = ψ(s(v)), where s(v) is the idele class of
(· · · , 1, πv, 1, · · · ) for a local uniformizer πv ∈K×
v , i.e. an element with the
condition v(πv) = 1. The homomorphism ψL/K : CK →G(L/K) is continuous
and its kernel is both open and closed, again in view of (4.4.14).

162
4 Arithmetic of algebraic numbers
4.4.7 Global Properties of the Artin Symbol
Let H be a subgroup of a ﬁnite group G. Then the transfer homomorphism
(or Verlagerung)
Ver : G/[G, G] −→H/[H, H],
(4.4.18)
is deﬁned by Ver(g[G, G]) = 
r∈R h(g, r) where r runs through a system
of representatives R of left cosets G/H and h(g, r) ∈H is deﬁned by the
condition gr = grh(g, r) ( gr ∈R being the representative of gr in R).
1) There is a one-to-one correspondence between open subgroups U ⊂CK
and ﬁnite Abelian extensions L/K, such that the symbol (4.4.16) induces
an isomorphism
CK/U
∼
→G(L/K),
and U coincides with the norm subgroup U = NL/K(CL) (see (4.4.17)).
2) Let K′/K be an arbitrary ﬁnite extension. Then for α ∈CK′ the following
equation holds
(NK′/K(α), L/K) = (α, LK′/K′).
(4.4.19)
3) Let L′/K be a ﬁnite Galois extension, L/K the maximal Abelian subex-
tension of L′/K, and K′ a subextension of L′/K over which L′ is Abelian.
Then
(α, L′/K′) = Ver(α, L/K),
(4.4.20)
where Ver is the transfer (4.4.18).
4) Let L′/K be a ﬁnite Galois subextension of L/K. Then for all α ∈CK
the following equation holds
(α, L′/K) = (α, L/K).
(4.4.21)
5) Let σ be an isomorphism of K onto σK, σ ∈Aut K. Then for all α ∈CK
the equation holds
(σα, σL/σK) = σ(α, L/K)σ−1.
(4.4.22)
The bar in the above formulae denotes the restriction to a subﬁeld (cf.
[Chev40], [Koch70], [AT51], [Wei74a]).
These properties make it possible to extend the deﬁnition of the Artin
symbol to inﬁnite Abelian extensions L/K. Consider the correspondence
s →(s, L/K) = lim
←−
ν
(s, Lν/K),
(4.4.23)
where Lν/K runs through all ﬁnite subextensions of L/K. It follows from 4)
that this is well deﬁned and one has a map from CK to G(L/K) with dense

4.4 Class Field Theory
163
image. Taking into account the one-to-one correspondence between subgroups
of ﬁnite index of CK and G(Kab/K), we see that G(Kab/K) is isomorphic
to the proﬁnite completion of CK, which is in fact with the quotient of CK
by its connected component. The thus constructed reciprocity homomorphism
satisﬁes the properties 2), 4) and 5).
Note that a new approach to the class ﬁeld theory was developped by
J.Neukirch in Chapters 4-6 of [Neuk99].
From a proﬁnite group G endowed with a surjective continuous homomor-
phism d : G →*Z and a G-module A endowed with a "Henselian valuation
with respect to d", one constructs in an elementary way the reciprocity homo-
morphisms; if A satisﬁes the so-called class ﬁeld axiom (a statement involving
zeroth and (−1)st cohomology of A), then the reciprocity homomorphisms are
isomorphisms. From this abstract class ﬁeld theory, both local and global class
ﬁeld theory are deduced, and the classical formulation of global class ﬁeld the-
ory, using ray class groups instead of the idèle class group, is presented as well.
Neukirch's approach minimizes the cohomological tools needed to construct
class ﬁeld theory.
4.4.8 A Link Between the Artin Symbol and Local Symbols
Suppose that we already know the existence of the Artin symbol on ideles
(4.4.16). For a ﬁnite Abelian extension L/K, a non-Archimedean place v of
K and an extension w of v to L, consider the completions Kv and Lw, and
the decomposition group
Gv ⊂G(L/K),
Gv ∼= G(Lw/Kv),
which in the Abelian case does not depend on the choice of w. Consider
the embedding iv : K×
v
→JK, and the projection onto the v-component
Jv : JK →K×
v , where iv maps x ∈K×
v
onto the element of JK, whose
v-component is equal to x, and whose other components are all 1. Put
ψv = ψL/K ◦iv = (·, Lw/Kv)v.
(4.4.24)
Then one veriﬁes that the image of ψv belongs to the decomposition group Gv.
The homomorphism ψv : K×
v →Gv is called the local Artin homomorphism
(or the norm residue homomorphism). If x = (xv) ∈JK, then the following
decomposition holds
ψL/K(x) =

v
ψv(xv),
(4.4.25)
where
x = lim
S

v∈S
iv(xv)


164
4 Arithmetic of algebraic numbers
(the limit is taken over an increasing family of places of K). The product
(4.4.25) is actually ﬁnite: if a component xv is a v-unit and v is unramiﬁed,
then xv is a norm in the extension Lw/Kv: for some yw ∈Lw one has xv =
NLw/Kvyw. The existence of yw is established by Hensel's lemma (see 4.3.2).
Thus the knowledge of all local Artin maps ψv is equivalent to the knowl-
edge of the global Artin map ψL/K. In classical work on class ﬁeld theory
the local reciprocity maps were studied using the global theory; in particu-
lar, it was shown that these local maps depend only on the local extensions
Lw/Kv, and are independent on a global extension L/K from which they are
obtained. In this sense, modern expositions of class ﬁeld theory (for example,
in [Chev40] , [Wei74b]) diﬀer from classical texts: ﬁrst one gives a purely local
and independent construction of maps
θv : K× →Gv = G(Lv/Kv),
(4.4.26)
where Lv is a ﬁnite extension of Kv. Then one proves that the product 
v θv
has the properties which uniquely characterize the homomorphism ψL/K. The
most important part of the proof consists of verifying the product formula
θv(a) = 1 for all a ∈K×.
(4.4.27)
In the case of a quadratic extension L = K(
√
b) the image θv(a) belongs to
{±1} = G(L/K), and coincides with the Hilbert symbol, deﬁned in §4.3.3.
The product formula is equivalent to the quadratic reciprocity law of Gauss,
which thus becomes a special case of the general reciprocity law (4.4.14).
The construction of the map (4.4.26) for an arbitrary Abelian extension
Lv/Kv is usually carried out using methods of Galois cohomology theory (see
§4.5, and [Se63], [Se64], [Chev40], [Koch70] [Koch97]). A more direct construc-
tion of θv was suggested by [Haz78] , [Iw86], based on an explicit analysis of
cohomological constructions in low dimensions, compare with the approach of
J.Neukirch cf. [Neuk99]).
4.4.9 Properties of the Local Symbol
The properties of the local symbol
θv = ψv = (·, Lw/Kv) : K×
v →Gv
are completely analogous to the corresponding properties 1) to 5) from §4.4.7,
replacing CK = JK/K× by K×
v , G(L/K) by Gv and ψL/K by θv. Also, the
homomorphism θv maps the group of units Uv = O×
v of Kv onto the inertia
group Iw ⊂Gv. If Lw/Kv is unramiﬁed, then for all α ∈K×
v one has
θv(α) = Frv(α)
v
where Frv ∈Gv is the Frobenius element of the extension, and the valuation
v of Kv is normalized by the condition v(K×
v ) = Z. In the same way as for

4.4 Class Field Theory
165
ψL/K the local symbol can be generalized for inﬁnite Abelian extensions, and
thus one obtains a reciprocity map θv : K×
v →G(Kab
v /Kv), where Kab
v
is the
maximal Abelian extension of Kv. The Galois group can then be described as
follows:
G(Kab
v /Kv) = (K×
v )∧∼= ˆZ × O×
v
(4.4.28)
where ∧denotes the proﬁnite completion. Under the isomorphism (4.4.28) the
Galois group G(Knr
v /Kv) = G(Fq/Fq) of the maximal unramiﬁed extension
Knr
v
of Kv becomes ˆZ, and the inertia group Iw = Iv maps isomorphically
onto the whole group of units O×
v :
θv : O×
v
∼
→Iv
(4.4.29)
(the ﬁeld Knr
v
can be deﬁned as the maximal extension of K, for which the
extension of the valuation v satisﬁes the property v(K×
v ) = Z).
Below we give a remarkable explicit construction of the maximal Abelian
extension Kab
v
of a local non-Archimedean ﬁeld Kv, generalizing the contruc-
tion of Qab
p
by adjoining roots of unity to Qp.
4.4.10 An Explicit Construction of Abelian Extensions of a Local
Field, and a Calculation of the Local Symbol
(cf. [LT65], [Se63], [Chev40], [Ha50], [Sha50], [CW77], [Koly79]). Consider
ﬁrst the ﬁeld Qp as a model example. Any Abelian extension of this ﬁeld
is contained in a cyclotomic extension, i.e. Qab
p
= Qp(W∞), where W∞=
∪n>1Wn, Wn = {ζ ∈Qp | ζn = 1}, W∞is the set of all roots of unity from
Qp. Let Wp∞= ∪m≥0Wpm be the subset of all roots of unity of p-power order,
and V∞= ∪p̸ |nWn the subset of roots of unity of order not divisible by p.
Then
W∞= V∞× Wpm,
Qp(W∞) = Qp(V∞) · Qp(Wp∞),
and the following decomposition takes place:
G(Qab
p /Qp) ∼= G(Qp(V∞)/Qp) × G(Qp(Wp∞)/Qp).
(4.4.30)
Here Qp(V∞) is the maximal unramiﬁed extension (see the example from
4.3.4), for which vp(Qp(V∞)×) = Z and
G(Qp(V∞)/Qp) ∼= G(Fp/Fp) ∼= ˆZ = ⟨Frp⟩∧.
(4.4.31)
The ﬁeld generated by Wp∞= ∪m≥0Wpm is the union of all the totally rami-
ﬁed extensions of Qp. The Galois group G(Qp(Wp∞)/Qp) can be described by
means of its action on the set Wp∞of all roots of unity of p-power order. In
order to do this we note the isomorphisms
End Wp∞∼= Zp,
Aut Wp∞∼= Z×
p ,

166
4 Arithmetic of algebraic numbers
in which a p-adic number α = a0 + a1p + a2p2 + · · · ∈Zp in its digital form
(4.3.2) corresponds to the endomorphism [α] : ζ →ζα for ζ ∈Wp∞:
ζα def
= ζa0+a1p+a2p2+···+am−1pm−1 if ζ ∈Wpm ⊂Wp∞.
From the action of the Galois group on Wp∞one obtains a homomorphism
δp : G(Qp(Wp∞)/Qp)
∼
→Aut Wp∞∼= Z×
p ,
(4.4.32)
which is a one-dimensional p-adic Galois representation (the cyclotomic rep-
resentation), and (4.4.32) is an isomorphism.
It turns out that the local symbol θp(α) = (α, Qab
p /Qp) ∈G(Qab
p /Qp) for
an element α = pmu (m ∈Z, u ∈Z×
p ) can be described using isomorphisms
(4.4.31), (4.4.32):
θp(α) =

Frm
p
on the subﬁeld Qp(V∞),
[u−1]
on the subﬁeld Qp(Wp∞).
We now reformulate this in a manner more suitable for generalization.
Consider the sets Ep∞= ∪m≥0Epm, where
Epm = {w = ζ −1 | ζ ∈Wp∞}.
These sets are groups with respect to the group law
w1 ◦w2 := w1 + w2 + w1w2 (w1, w2 ∈Ep∞),
and for all w ∈Ep∞one has |w|p < 1. The set Ep consists of all roots of the
polynomial
fp(X) = (X + 1)p −1 = pX +
p
2

X2 + · · · + Xp,
which becomes irreducible after division by X according to Eisenstein's irre-
ducibility criterion. Its roots therefore generate a ﬁeld Qp(Ep) of degree p −1
over Qp.
Now consider the iterations of the polynomial fp(X):
fp2(X) = fp(fp(X)) = ((X + 1)p −1)p −1,
· · ·
· · ·
· · ·
fpm(X) = fpm−1(fp(X)).
The group Epm coincides with the set of all roots of the polynomial fpm(X),
and this is isomorphic to p−mZp/Zp. Under this isomorphism the obvi-
ous inclusions Epm ⊂Epm+1 become the natural embeddings p−mZp/Zp ⊂
p−m−1Zp/Zp, and we see that Ep∞∼= Qp/Zp. From this it follows that

4.4 Class Field Theory
167
End E∞∼= Zp. We have Qp(E∞) = Qp(Wp∞), and the isomorphism (4.4.32)
takes the form
δp : G(Qp(Ep∞)/Qp)
∼
→Aut Ep∞∼= Z×
p .
(4.4.33)
Now let Kv be an arbitrary ﬁnite expension of Qp with valuation ring Ov,
maximal ideal pv = (π) and q = |Ov/pv|. Here π is a uniformizing element,
i.e. v(π) = 1. There is an analogous construction of the maximal Abelian
extension of Kv. Consider the polynomial
fπ(X) = πX + Xq.
(4.4.34)
It follows as before by Eisenstein's criterium that fπ(X)/X is irreducible.
Deﬁne recursively the iterations
fπm(X) = fπm−1(fπ(X)),
m ≥1.
Then the sets of roots
Wf,m =

x ∈Kv | fπm(x) = 0

(4.4.35)
of the polynomials fπm(X) form an increasing sequence:
Wf,m ⊂Wf,m+1,
and there is a natural group structure on (4.4.35) such that Wf,m is isomor-
phic to p−m
v
/Ov (∼= Ov/pm
v ). The inclusions Wf,m ⊂Wf,m+1 become the
natural embeddings p−m
v
/Ov ⊂p−m−1
v
/Ov. Thus we obtain a group, which is
analogous to the group of all roots of unity of p-power order:
Wf,∞=
.
m≥1
Wf,m is isomorphic to Kv/Ov.
(4.4.36)
There is a natural action of elements a ∈Ov = End(Kv/Ov) on Wf,m for
which the equation [π]f(x) = fπ(x) holds. This action will be denoted by
[a]f : x →[a]fx. The action of the Galois group on the roots of the polynomials
fπm(X) provides us with a representation analogous to (4.4.32):
G(Kv/Kv) →Aut Wf,∞∼= O×
v .
(4.4.37)
Denote by Kπ the ﬁeld which corresponds to the kernel of the homomorphism
(4.4.37). Then Kπ is an Abelian extension of Kv in view of the isomorphism
δv : G(Kπ/Kv)
∼
→O×
v ,
(4.4.38)
and we obtain the following explicit description of the Abelian extensions of
Kv:
Kab
v
= Knr
v · Kπ,

168
4 Arithmetic of algebraic numbers
where Knr
v = Kv(V∞) is the maximal unramiﬁed extension of Kv (V∞is the
group of all roots of unity of degree not divisible by p),
G(Knr
v /Kv) ∼= G(Fq/Fq) ∼= ˆZ = ⟨Frq⟩∧.
(4.4.39)
The ﬁeld Kπ =
∪
m≥1 Kv(Wf,m) is the union of all totally ramiﬁed Abelian
extensions of Kv.
The norm residue symbols can then be described as follows:
1) for u ∈O×
v the element θv(u) = (u, Kπ/Kv)v acts on Wf,∞via [u−1]f;
2) the norm residue symbol of (π, Kπ/Kv)v is equal to 1.
3) the symbol θv(α) for α = πm (m ∈Z, u ∈O×
v ) acts on Knr
v
as Frm
q ∈
G(Knr
v /Kv).
A remarkable feature of the construction of the group law on the set Wf,∞
is that the ﬁeld Kπ is independent of the choice of uniformizer π and of the
polynomial f(X) ∈Ov[X], which need only satisfy the following requirements:
f(X) ≡πX (modulo degree 2 polynomials),
(4.4.40)
f(X) ≡Xq(mod π).
(4.4.41)
Moreover, instead of a polynomial f(X) one may use any element of the set
Fπ of power series f(X) ∈Ov[[X]] satisfying the above conditions (4.4.40),
(4.4.41).
The above group law is constructed in the theory of Lubin-Tate formal
groups.
4.4.11 Abelian Extensions of Number Fields
For the ﬁeld of rational numbers Q the theorem of Kronecker-Weber (see
§4.1.2) gives an explicit description of all Abelian extensions with the help
of the action of the Galois group on roots of unity, which may be regarded
as certain special values of the exponential function: ζm = exp(2πi/m). An
analogous theory exists also over an imaginary quadratic ﬁeld K = Q(
√
d),
whose Abelian extensions are constructed with the help of the action of the
Galois group G(K/K) on the points of ﬁnite order of an elliptic curve with
complex multiplication (more precisely, on the coordinates of these points,
see §5.4 of Chapter 5). This description is essentially the content of the theory
of complex multiplication. In more classical terms, Abelian extensions of an
imaginary quadratic ﬁeld are described by means of the special values of
elliptic functions and the j-invariants corresponding to lattices with complex
multiplication. The Galois action on these values is explicitly described in
terms of the arithmetic of the imaginary quadratic ground ﬁeld (this was
Kronecker's "Jugendtraum" ("dream of youth"), cf. a nice book by S.Vladut,

4.4 Class Field Theory
169
[Vla91]) The content of Hilbert's famous twelfth problem is to give an explicit
description of all Abelian extensions of an arbitrary number ﬁeld K, [K : Q] <
∞using special values of certain special functions (such as the exponential
function or elliptic functions), and by means of the Galois actions on these
values.
Some progress has been made in solving this problem for the so-called
CM-ﬁelds K. These are totally imaginary quadratic extensions K = F(√−a)
of totally real ﬁelds F: F is a number ﬁeld generated by a root of a polyomial
which splits as a product of linear factors over R, and a ∈F is totally posi-
tive (positive in each real embedding of F). This multi-dimensional complex
multiplication theory is based on the study of Abelian varieties with complex
multiplication by elements of K. For a real quadratic ﬁeld K a description of
certain Abelian extensions of K is given by Shimura's theory of "real multi-
plication". However, in these cases the situation is less satisfactory than for Q
or for an imaginary quadratic ﬁeld K, since these constructions do not give
all Abelian extensions of the ground ﬁeld K. A completely diﬀerent situation
takes place in the function ﬁeld case, when K is a ﬁnite, separable extension
of Fq(T). Here there is a complete description of all Abelian extensions of K
in terms of the elliptic modules of V.G.Drinfel'd (and in terms of elliptic func-
tions in positive characteristic attached to these modules, [Dr]). This result
gives an illustrative example of analogy between numbers and functions.
The idea of describing extensions of K via the action the Galois group
G(K/K) on certain groups and other algebraic objects has turned out to
be very fruitful. Many examples of constructions of Abelian and non-Abelian
extensions of a ground ﬁeld K are based on this idea. A complete classiﬁcation
of all these extensions in terms of Galois representations and in terms of certain
objects of analysis and algebraic geometry (automorphic forms and motives)
is an important aim in Langlands far-reaching program, see §6.5.
In a new book [Yos03] the main object are special values given by the
exponential of the derivative at s = 0 of the partial zeta function of a certain
ideal-class c attached to a number ﬁeld F. Such a special value is an important
invariant which conjecturally gives a unit of an abelian extension of a number
ﬁeld and should give an answer to Hilbert's 12-th problem.
Let F be a totally real ﬁeld, i.e. F ⊗R ∼= Rn as an R-algebra. According
to Shintani, the special values at non-positive integers of the partial zeta
function
ζF (a, f, s) =

I∈a
I⊂OF
N(I)−s
are rational numbers which can be expressed in terms of certain generating
functions which generalize the generating function of Bernoulli numbers, see
[Shin76].

170
4 Arithmetic of algebraic numbers
These generating functions are associated to "cone decompositions" in F ⊗
R which are deﬁned non-canonicaly (see also [Hi93], Chapter I).
Conjectural absolute periods are described in [Yos03] in terms of a function
constructed geometrically from cone decomposions, whose principial term is
given by periodes of abelian varieties of CM-type for an arbitrary CM-ﬁeld,
explicifying a conjecture of Colmez, [Colm93].
Our knowledge of the nature of CM-periods is quite limited, the only
essential fact in the case F = Q is the classical Chowla - Selberg formula,
πpK(id, id)2 ∼
d−1

a=1
Γ
a
d
wχ(a)/2h
= d · exp
L′(0, χ)
L(0, χ)

,
where K is an imaginary quadratic ﬁeld of discriminant −d, w is the number
of roots of unity in K, h the class number of K, and χ the Dirichlet character
corresponding to K [ChSe68]. Also, using the jacobian of the Fermat curve,
G.W.Anderson found that the CM-periods in the case of a cyclotomic ﬁeld
are linked with the logarithmic derivative of Dirichlet's L-functions at s = 0:
pK(id, σ) ∼π−µ(σ)/2 
η∈ˆ
G−
exp
 η(σ)
[K : Q]
L′(0, η)
L(0, η)

.
where η is a Dirichlet character, µ(c) = ±1 or 0 (see [Ande82]).
The conjectures of Harold Stark were made in the 1970's and 80's (see in
[St71-80]) concerning the values at s = 1 and s = 0 of complex Artin L series
attached to Galois extensions of number ﬁelds K/F. A systematic approach
to the Stark conjectures was presented in the book by Tate, cf. [Ta84]. In
the most general terms these conjectures concern the special values of Artin
L-functions of number ﬁelds and their analogies, relating them to certain
"regulators of S-units" and analogous objects.
More precisely the Conjecture S (on units) discussed in Chapter II of
[Yos03], is formulated in terms of the partial zeta function
ζF (s, σ) =

A⊂OF ,(
K/F
A )=σ
N(A)−s
attached to an element σ of the Galois group Gal(K/F) of an abelian extension
K of a totally real ground ﬁeld F ramiﬁed over only one inﬁnite place of F
(here

K/F
A

denotes the Artin symbol). Conjecture S says that there exists
a unit ϵ in K such that
ζ′
F (0, σ) = ϵσ
for every σ ∈Gal(K/F). A method is given, which derives Conjecture S on
units from the following Conjecture on Galois action:
 c(χ)
R(χ)
σ
= c(χσ)
R(χσ).

4.4 Class Field Theory
171
Here χ ∈ˆG denotes a (non-Abelian) irreducible character of a Galois extension
K of F with the ﬁnite Galois group G = Gal(K/F), c(χ) the leading term of
the Taylor expansion of its Artin L-function at s = 0:
L(s, χ, K/F) = c(χ)sr(χ) + O(sr(χ)+1),
0 ≤r(χ) ∈Z
and R(χ) denotes a generalized regulator which is the determinant of a matrix
of size r(χ) whose entries are linear combinations of the absolute values of
units of K with algebraic coeﬃcients.
In recent years there was an important developpement in the study of "class
invariants" of ray classes in a totally real ﬁeld F, and in their arithmeti-
cal interpretations (which include generalizations of Stickelbergers's theorem,
generalization of Dedekind sums as certain cocycles etc.) A recent interpre-
tation of Stark's conjectures using notions of Noncommutative geometry was
given in [Man02], [Man02a].

4.5 Galois Group in Arithetical Problems
4.5.1 Dividing a circle into n equal parts
The problem of dividing a circle into n equal parts (cf. [Gau], [Gin85]) has a
geometric form. However its solution, given by Gauss, was based essentially
on arithmetical and algebraic considerations. The construction of the regular
17-gon was the ﬁrst mathematical invention of Gauss, written in his diary on
March 30th 1796, one month before his 19th birthday. Previously one could
only construct triangles, squares, pentagons, 15-gons, and all those n-gons
which are obtained from these by doubling the number of sides. From the
algebraic point of view, the construction of a regular n-gon is equivalent to
constructing the roots of unity of degree n on the complex plane, i.e. the
solutions to the equation
Xn −1 = 0,
(4.5.1)
which have the form
εk = cos 2πk
n
+ i sin 2πk
n
= exp
2πik
n

,
k = 0, 1, . . . , n −1.
(4.5.2)
Assuming that the segment of length one is given, we can construct using
ruler-and-compass methods all new segments whose length is obtained from
the lengths of given segments using the operations of addition, subtraction,
multiplication, division and extraction of the square root. Through a sequence
of these operations one may construct any number belonging to any ﬁeld L,
which is a union of a tower of quadratic extensions
L = Lm ⊃Lm−1 ⊃· · · L1 ⊃L0 = Q,
(4.5.3)
where Li+1 = Li(√di), di ∈Li. It is not diﬃcult to prove that no other points
of the complex plane can be constructed starting from the point z = 1 and
using only ruler-and-compass methods. In order to construct z = α (if this is
possible) one constructs the corresponding tower of type (4.5.3) for the ﬁeld
L, generated by all the roots of the minimal polynomial f(X) ∈Q[X] of α
(the decomposition ﬁeld of f(X)). By Galois theory, to a quadratic extension
L1/Q corresponds a subgroup G1 = G(L/L1) of index two in the Galois group
G0 = G(L/Q) (the group of Galois symmetries of the polynomial f(X)). The
action of the subgroup G1 partitions the set of all roots of f(X) into two parts,
such that the sum of all elements of each part belongs to L1 and generates
this ﬁeld, being invariant under under automorphisms in G1. In the next step
each of these two parts is divided into two further parts using the action on
the roots by elements of G2 = G(L/L2), which is of index 2 in G1 etc.. This
process continues until we obtain the subset of roots consisting of only one
element z = α.

4.5 Galois Group in Arithetical Problems
173
For example, for the root of unity α = ε1 from (4.5.2) the corresponding
irreducible polynomial f(X) is the cyclotomic polynomial Φn(X), whose roots
εk ((k, n) = 1) are primitive roots of unity; the Galois symmetries have the
form
σa : εk →εa
k = εka mod
n
(a ∈(Z/nZ)×).
For n = 5 one has G0 = {σ1, σ2, σ3, σ4} and the subgroup G1 = {σ1, σ4}
partitions the set of primitive roots into the parts {ε1, ε4} and {ε2, ε3}. One
has Φ5(x) = x4 + x3 + x2 + x + 1. Hence
ε2
1 + ε1 + 1 + ε−1
1
+ ε−2
1
= 0.
By putting u = ε1 + ε−1
1
= ε1 + ε4 we obtain the equation
u2 + u −1 = 0,
ε1 + ε4 = −1 +
√
5
2
,
ε2 + ε3 = −1 −
√
5
2
,
which gives the desired construction of the regular pentagon.
Fig. 4.3.
In the case n = 17 Gauss' intuition led him to the correct partition of
the roots of Φ17(x) = x16 + x15 + · · · + x + 1 given by Galois symmetries
(Galois theory had not yet been discovered!). The group of symmetries G0 ∼=
(Z/17Z)× is a cyclic group of order 16 with a generator 3mod 17 (a primitive
root), and Gauss's idea was to use a more convenient indexing system for
the roots (see Fig. 13). Let us assign to the root εk the new number l (the
notation ε[l]) deﬁned by the condition k ≡3l mod 17, l = 0, 1, . . . , 15, and let
Tl denote the automorphism σk. Then

174
4 Arithmetic of algebraic numbers
Tlε[m] = ε[m+l]
(m, l mod 16).
(4.5.4)
The corresponding subgroups have the form
G0 = {T0, T1, · · · , T15},
G1 = {T0, T2, · · · , T14},
G2 = {T0, T4, · · · , T12},
G3 = {T0, T8}.
We now show how the idea described above works in this case. First of all
note that
ε1 + ε2 + · · · + ε16 = ε[0] + ε[1] + · · · + ε[15] = −1
(4.5.5)
(the sum of a geometric progression). Denote by σm,r the sum of ε[l] with l,
congruent to r modulo m. We thus obtain
σ2,0 = ε[0] + ε[2] + · · · + ε[14] =

Tl∈G1
Tlε[0],
σ2,1 = ε[1] + ε[3] + · · · + ε[15] =

Tl∈G1
Tlε[1].
Identity (4.5.5) implies
σ2,0 + σ2,1 = −1,
and by termwise multiplication we ﬁnd that
σ2,0 · σ2,1 = 4(ε[0] + ε[1] + . . . ε[15]) = −4.
Now using Viète's formulae, we may express σ2,0 and σ2,1 as the roots of the
quadratic equation x2 + x −4 = 0:
σ2,0 =
√
17 −1
2
,
σ2,1 = −
√
17 −1
2
,
which generate the ﬁeld L1 = Q(
√
17). We distinguish the two roots by the
condition that σ2,0 > σ2,1; in each of these ﬁelds the roots arise together with
their conjugates. In the ﬁrst case we have to add and to multiply the real parts
of the numbers ε1, ε2, ε4, ε8 and in the second case we do the same for ε3,
ε5, ε6, ε7. In a similar way we have that σ4,0 + σ4,2 = σ2,0, σ4,1 + σ4,3 = σ2,1,
and the multiplication using (4.5.4) shows that σ4,0 · σ4,2 = σ2,0 + σ2,1 = −1.
Hence σ4,0 and σ4,2 are roots of the equation x2 +σ2,0 +1 = 0 which generates
the ﬁeld L2:
σ4,0 = 1
4
√
17 −1 +
+
34 −2
√
17

,
σ4,2 = 1
4
√
17 −1 −
+
34 −2
√
17

.
In the same way we see that

4.5 Galois Group in Arithetical Problems
175
σ4,1 = 1
4

−
√
17 −1 +
+
34 + 2
√
17

,
σ4,2 = 1
4

−
√
17 −1 −
+
34 + 2
√
17

.
An analogous argument shows that
σ8,0 = ε[0] + ε[8]
= 2 cos 2π
17
= (1/2) ·
+
(σ4,0)2 −4σ4,1)
= (1/8) · (
√
17 −1 +
+
34 −2
√
17)
+ (1/4) ·
 
17 + 3
√
17 −
+
170 + 38
√
17,
which completes the construction.
In the general case of an n-gon with n = 2rpr1
1 ·. . .·prs
s , where pi are odd
primes, we have that
G(Q(ζn)/Q) ∼= (Z/nZ)×.
By considering the tower (4.5.3) of quadratic extensions, we see that the pos-
sibility of constructing the regular n-gon is equivalent to the condition that
the number
|(Z/nZ)×| = ϕ(n) = 2r−1(p1 −1)pr1−1
1
· · · · · (ps −1)prs−1
1
is a power of 2. This holds precisely when n = 2rp1 · · · · · ps, where the pi are
primes such that pi = 2mi + 1. It follows from Lagrange's theorem applied to
the cyclic group (Z/piZ)×, that mi divides pi −1. Hence mi is also a power
of 2. The construction is therefore only possible for n = 2rp1 · · · · · ps where
pi are Fermat primes pi = 22ti + 1, which were discussed in Part I, §1.1.2.
The proof of the latter statement was not published by Gauss: "Although the
framework of our treatise does not allow us to proceed with this proof, we
think that it is necessary to point out this fact, in order to prevent somebody
else from wasting his time, by attempting to ﬁnd some other cases, which are
not given by our theory."
4.5.2 Kummer Extensions and the Power Residue Symbol
(see [CF67], [Chev40], [Koch70]). Let K be a ﬁeld containing a primitive root
of unity ζ of degree m, where m is a ﬁxed positive integer not divisible by
the characteristic of K. One may show that cyclic extensions L/K of degree
dividing m coincide with the so-called Kummer extensions of type K( m√a)/K
(a ∈K). In applications K will be either a number ﬁeld or a completion of

176
4 Arithmetic of algebraic numbers
one. Any extension L/K containing a root α of Xm = a, also contains all the
other roots ζα, . . . , ζm−1α of this polynomial. Let σ be an element of the
Galois group G(K( m√a)/K). If we ﬁx a root α then the automorphism σ is
completely determined by the image of α under the action of σ: ασ = ζbα. In
particular, if α is an element of order m in the multiplicative group K×/K×m
then Xm −a is irreducible and ar is an mth power iﬀm|r. In this case the
assignement σ →b mod m provides an isomorphism of the Galois group
G(K( m√a)/K) with the cyclic group Z/mZ.
Now let L be an arbitrary cyclic extension of degree m of K. We shall
construct explicitly an element a ∈K such that L = K( m√a)/K. Let σ be a
generator of the cyclic group G(L/K) and let L = K(γ) for some primitive
element γ ∈L. Then the elements γ, γσ, . . . , γσm−1 form a basis of L over
K. Consider the sum
β =
m−1

s=0
ζsγσs.
(4.5.6)
Then βσ = ζ−1β, and β ̸= 0 since the elements γ, γσ, γσm−1 are linearly
independent over K. Thus βm ∈K and βr ̸∈K for 0 < r < m, i.e. a = βm
is an element of order m in the quotient group K×/K×m and the above
argument shows that the ﬁeld K(β) is a cyclic extension of degree m contained
in L and is therefore equal to L = K( m√a). In a similar way we can check
that two extensions K( m√a)/K and K(
m√
b)/K coincide iﬀa = brcm for some
c ∈K and r ∈Z such that (r, m) = 1. These statements can be uniﬁed into
one statement by saying that for a given ﬁeld K ⊃µm and its Galois group
GK = G(K/K) there is the isomorphism
K×/K×m ∼= Hom(GK, µm),
(4.5.7)
where µm =

ζ ∈K | ζm = 1

and Char K ̸ | m. In order to construct (4.5.7)
for a given a ∈K× choose γ ∈K
× with the condition γm = a, and for σ ∈GK
the formula ϕa(σ) = γσ/γ deﬁnes then a homomorphism ϕa : GK →µm. The
fact that this map deﬁnes a homomorphism (4.5.7) is deduced from Hilbert's
Theorem 90 on the cohomology of the multiplicative group: H1(GK, K×) =
{1} (see §4.5.3).
Now let K be a number ﬁeld, µm ⊂K, p = pv a prime divisor attached
to a non-Archimedean place v of K. The decomposition of p in the extension
K( m√a)/K is reduced to study of the extension Kv( m√a)/Kv of the local ﬁeld
Kv (by the construction of extensions of absolute values, see §4.3.6). One can
assume that a belongs to the ring OK of integers of K, and that p ̸ | ma.
Then the decomposition of the maximal ideal p ⊂OK is determined by the
decomposition of the polynomial Xm −a(mod p) over the ﬁeld OK/p (by the
lemma in §4.2.3). This decomposition is a product of pairwise coprime irre-
ducible factors of degree f, where f is the degree of the residue ﬁeld extension:
the least positive integer f such that the congruence af ≡xm( mod p) is solv-
able in OK/p. Under our assumptions the ideal p is unramiﬁed in L = K( m√a)

4.5 Galois Group in Arithetical Problems
177
and p = Pw1 · . . . · Pwr
(f · r = m). In particular, p splits completely iﬀ
f = 1, i.e. iﬀthe congruence xm ≡a mod p is solvable.
We now deﬁne the power residue symbol. In order to do this denote by S
the set of places of K which either divide m or are Archimedean. For elements
a1, . . . , al ∈K× denote by S(a1, . . . , al) the union of S and the set of places
v for which |ai|v ̸= 1 for some i. For a ∈K× and a place v ̸∈S(a) deﬁne the
power residue symbol
 a
v

∈µm by
m√a
FL/K(v) =
a
v

m√a,
(4.5.8)
where L = K( m√a) and FL/K(v) ∈G(L/K) is the global Artin symbol, cf.
§4.4.6. The number
 a
v

∈µm does not depend on a choice of
m√a, and one
veriﬁes that
aa′
v

=
a
v
a′
v

(v ̸∈S(a, a′)).
(4.5.9)
According to the deﬁnition of FL/K(v) as a Frobenius element, the identity
(4.5.8) is equivalent to the congruence
m√aNv−1 ≡
 a
v

(mod pv), which im-
plies that m|(Nv −1) and
a(Nv−1)/m ≡
a
v

(mod pv),
(4.5.10)
(the generalized Euler criterium) since the group (Ov/pv)× is cyclic of order
Nv −1. For an arbitrary divisor β = 
v̸∈S(a) pn(v)
v
∈IS(a) put
 a
β

=

v̸∈S(a)
a
v
n(v)
.
Then we have that
m√a
FL/K(β) =
 a
β

m√a,
(4.5.11)
where L = K( m√a), FL/K(β) ∈G(L/K) is the global Artin symbol, and the
following equation holds:
 a
ββ′

=
 a
β
  a
β′

(β, β′ ∈IS(a)).
(4.5.12)
For any prime divisor v ̸∈S(a) the following statements are equivalent:
1)
 a
v

= 1;
2) the congruence xm ≡a(mod pv) is solvable for some x ∈Ov;
3) the equation xm = a is solvable for some x ∈Kv

178
4 Arithmetic of algebraic numbers
A solution in 2) can be lifted to a solution in 3) by Hensel's lemma, see
§4.3.2. For an integral ideal β ⊂OK the value of

a
β

depends only on a mod
β as long as a ∈OK. Thus the following character of order m is deﬁned
χβ : (OK/β)× →µm,
χβ(a) =
 a
β

.
(4.5.13)
The cubic reciprocity law. Let K = Q(ζ3) = Q(√−3), m = 3. Then OK =
Z[ζ3] is a principal ideal domain and if p = pv = (π) for a prime element
π, then we shall use the notation
 a
π

instead of

a
p

. Call a prime element
primary if π ≡2 mod 3, i.e. either π = q is a rational prime number, q ≡
2(mod 3), or Nπ = p ≡1(mod 3), π ≡2 mod 3. One easily veriﬁes that
among the generators of an ideal p, p ̸ | 3 there is exactly one primary element.
Let p1 = (π1) and p2 = (π2), where π1 and π2 are coprime primary elements
such that Np1 ̸= Np2 ̸= 3. Then the following "reciprocity law" holds:
π1
π2

=
π2
π1

.
(4.5.14)
The biquadratic reciprocity law. Let m = 4, K = Q(i) and OK = Z[i], the
ring of Gaussian integers. We shall call α ∈OK primary if α ≡1(mod (1 +
i)3). Then one veriﬁes that in any prime ideal p, p ̸ | 2 one can choose a unique
primary generator. If p1 = (π1) and p2 = (π2), where π1 and π2 are coprime
primary elements, then the following reciprocity law holds:
π1
π2

=
π2
π1

(−1)((Nπ1−1)/4)·((Nπ2−1)/4).
(4.5.15)
4.5.3 Galois Cohomology
The group cohomology theory provides a standard method of obtaining arith-
metical information from Galois groups, acting on various objects: algebraic
numbers, idele classes, points of algebraic varieties and algebraic groups etc.
(cf. [Se58], [Se63], [Se64], [Chev40], [Ire82], [Koch70], [Koly88] [Wei74a]). Let
G be a ﬁnite (or proﬁnite) group acting on a G-module A (endowed with
the discrete topology). The cohomology groups of G with coeﬃcients in A
are deﬁned with the help of the complex of cochains. Consider the following
Abelian groups:
C0(G, A) = A,
and for n ≥1
Cn(G, A) = {f : G × · · · × G →A | f is continuous}

4.5 Galois Group in Arithetical Problems
179
(the addition of functions is pointwise and the continuity of f ∈Cn(G, A)
means that the function f(g1, . . . , gn) depends only on a coset of gi modulo
some open subgroup of G).
The formula
(dnf)(g1, . . . , gn+1) =g1f(g2, . . . , gn+1)
+
n

i=1
(−1)if(g1, . . . , gigi+1, . . . , gn+1)
+ (−1)n+1f(g1, . . . , gn),
(4.5.16)
deﬁnes a homomorphism dn : Cn(G, A) →Cn+1(G, A), such that dn ◦dn+1 =
0.
The group Zn(G, A) = Kerdn is called the group of n-cocycles, and the
group Bn(G, A) = Imdn−1 is called the group of n-coboundaries. The property
dn ◦dn+1 = 0 implies that Bn(G, A) ⊂Zn(G, A). The cohomology groups are
then deﬁned by
Hn(G, A) = Bn(G, A)/Zn(G, A) =

Kerdn/Imdn−1
for n ≥1;
Kerd0
for n = 0.
(4.5.17)
If n = 0 then
H0(G, A) = AG = {a ∈A | ga = a for all g ∈G}.
(4.5.18)
For n = 1 we call a continuous map f : G →A a scew-homomorphism iﬀfor
all g1, g2 ∈G one has
f(g1g2) = f(g1) + g1f(g2).
(4.5.19)
One says that a scew-homomorphism splits, iﬀfor a ﬁxed a ∈A it can be
written in the form f(g) = a −ga. The group H1(G, A) can be identiﬁed
with the quotient group of the group of all scew-homomorphisms modulo
the subgroup formed by all split scew-homomorphisms. If the action of G
on A is trivial then H1(G, A) coincides with the group of all (continuous)
homomorphisms from G into A.
For n = 2 the elements of H2(G, A) correspond bijectively to equivalence
classes of extensions of G by A. Consider an extension
0 →A →˜G →G →1.
(4.5.20)
For all g ∈G choose a lift ˜g in ˜G (i.e. choose a section g →˜g of the projection
˜G →G). Deﬁne f : G × G →A, f(g1, g2) ∈A by
˜g1 · ˜g2 = f(g1, g2) /
g1g2.
Then the function f is a 2-cocycle of G with values in A. If we change our
choice of representatives ˜g (i.e. the choice of section G →˜G), then f is altered

180
4 Arithmetic of algebraic numbers
by a coboundary. Hence the class of f depends only on the extension (4.5.20).
The group H2(G, C×) is called also the Schur multiplier of G. Let L/K be a
Galois extension with Galois group G = G(L/K). Then L× is a G-module
and H2(G, L×) can be interpreted as the Brauer group, see §4.5.5.
For the action of the Galois group G = G(L/K) on L× one has the fol-
lowing fundamental theorem.
Theorem 4.25 (Hilbert's Theorem 90).
H1(G(L/K), L×) = {1}.
The idea of the proof of this theorem is the same as in the description of
all cyclic extensions of K in §4.5.2. Let f : G →L× be an arbitrary scew-
homomorphism, f ∈Z1(G(L/K), L×). In multiplicative notation this means
that for all g, h ∈G we have f(h)g = f(gh)/f(g) ∈L×. We shall ﬁnd an
element b ∈L× such that for all g ∈G one has f(g) = b/bg. In order to do
this choose a primitive element γ in the extension L/K, so that the elements
γg (g ∈G) form a normal basis of L over K. Then the element
b =

h∈G
f(h)γh ∈L
(4.5.21)
is not equal to zero. We apply to both sides of (4.5.21) an element g ∈G.
Then
bg =

h∈G
f(h)g(γh)g
=

h∈G
f(h)gγgh
= f(g)−1 
h∈G
f(gh)γgh
= f(g)−1b
(by the formula of the (left) action of G on L×: (γh)g = γgh for g, h ∈G).
This method of taking the average is also known as the construction of the
Lagrange resolution in the theory of solvable extensions of ﬁelds.
Properties of cohomology groups.
1) For an arbitrary exact sequence of G-modules
0 −→A −→B −→C −→0
the following long exact sequence of cohomology groups is deﬁned:
0 −→H0(G, A) −→H0(G, B) −→H0(G, C)
∆0
−→H1(G, A)
−→H1(G, B) −→H1(G, C)
∆1
−→H2(G, A) −→· · · Hn(G, A) −→
−→Hn(G, B) −→Hn(G, C)
∆n
−→Hn+1(G, A) −→· · ·
(4.5.22)

4.5 Galois Group in Arithetical Problems
181
Example 4.26. Kummer theory. Let K be a ﬁeld containing the group µm
of all roots of unity of degree m in K. Assume further that Char K does
not divide m. For an arbitrary Galois extension L/K with Galois group
G = G(L/K) the map x →xm deﬁnes a homomorphism of G-modules:
ν : L× −→L×. For L = K, and G = GK, one has the following exact
sequence
1 −→µm −→K
×
ν
−→K
× −→1.
Passing to cohomology groups (4.5.22) we obtain the following long exact
sequence
H0(GK, µm) −→H0(GK, K
×)
ν
−→H0(GK, K
×) −→
H1(GK, µm) −→H1(GK, K
×)
ν
−→H1(GK, K
×) −→· · · .
(4.5.23)
Since the group GK acts trivially on µm, it follows that H1(GK, µm)
coincides with the group Hom(GK, µm). The group H0(GK, K
×) is the
subgroup of all ﬁxed points of the Galois action, i.e. H0(GK, K
×) =
K
×GK(K/K) = K×. Also, H0(GK, µm) = µm, and H1(GK, K
×) = {1}
by Hilbert's theorem 90. We thus have the following exact sequence
1 −→µm −→K×
ν
−→K× −→Hom(GK, µm) −→1,
which is equivalent to the isomorphism of Kummer:
K×/K×m ∼= Hom(GK, µm).
2) Let H be an open normal subgroup in G and A a G-module. Then one
has the following "inﬂation - restriction" exact sequence:
0 −→H1(G/H, AH)
Inf
−→H1(G, A)
Res
−→H1(H, A),
(4.5.24)
in which Inf denotes the inﬂation homomorphism, which is deﬁned by
"inﬂating" a cocycle f on G/H with values in AH ⊂A to a cocycle f on
G; and Res is the restriction homomorphism given by restricting cocycles
on G to the subgroup H.
3) ∪-products. Let A, B, C be three G-modules, for which some G-invariant
pairing ◦: A × B →C is given (i.e. for all g ∈G, a ∈A, b ∈B we have
that g(a ◦b) = ga ◦gb). For example, if A = B = C is a ring on which the
group G acts trivially, then the multiplication in A is such a pairing. Any
pairing A × B →C induces for every n ≥0 and m ≥0 a bilinear map
Hn(G, A) × Hm(G, B) →Hn+m(G, C),
(4.5.25)
which is called ∪-product. This is deﬁned on cocycles by the following
rule. If f ∈Cn(G, A), f ′ ∈Cm(G, B) then the cochain

182
4 Arithmetic of algebraic numbers
(f ◦f ′)(g1, · · · , gn+m) = f(g1, · · · , gn) ◦(g1 . . . gn)f ′(gn+1, · · · , gn+m))
(4.5.26)
turns out to be a cocycle, as can be seen from the following equation:
dn+m(f ◦f ′) = dnf ◦f ′ + (−1)nf ◦dmf ′.
The ∪-product (4.5.25) is well deﬁned by the formula
f ∪f ′ = f ◦f ′ ∈Hn+m(G, C).
One has the equation
α ∪∆mβ = (−1)n∆n+m(α ∪β),
(4.5.27)
where ∆m is the "connecting homomorphism" of the long exact sequence
(4.5.22). If A = B = C is a commutative ring on which G acts trivially,
then for all α ∈Hn(G, A), β ∈Hm(G, A) one has
α ∪β = (−1)nmβ ∪α.
(4.5.28)
4.5.4 A Cohomological Deﬁnition of the Local Symbol
Let K be a ﬁnite extension of the ﬁeld Qp of p-adic numbers. The local Artin
symbol is a homomorphism
θ : K× →Gab
K = lim
←−
L
G(L/K)
(4.5.29)
from the multiplicative group of K to the Galois group of the maximal Abelian
extension (the union of all ﬁnite Abelian extensions L/K) of K. This homo-
morphism was described in §4.4 using powerful global methods - the Artin
reciprocity law. However, the local symbol can be deﬁned purely locally. With
this approach the global reciprocity law can then be deduced from the prop-
erties of the local symbols by proving the product formula (4.3.31).
We shall deﬁne for a given α ∈K× the image θ(α) = θL/K(α) ∈G(L/K)
(in a ﬁnite extension L/K) using the characters χ ∈Hom(G(L/K), Q/Z).
Note that the element θ(α) of the ﬁnite Abelian group G(L/K) is completely
determined by the values χ(θ(α)) for all characters χ of G(L/K). For the
trivial G(L/K)-module Q/Z we have:
Hom(G(L/K), Q/Z) = H1(G(L/K), Q/Z),
and there is an exact sequence
0 →Z →Q →Q/Z →0,
which gives rise to the isomorphism

4.5 Galois Group in Arithetical Problems
183
∆1 : H1(G(L/K), Q/Z)
∼
→H2(G(L/K), Z).
(4.5.30)
The latter is found by considering the long exact sequence (4.5.22), and using
the fact that all the higher cohomology groups of the divisible group Q are
trivial: Hi(G(L/K), Q) = {0} for i ≥1.
As we have seen in §4.5.3, H1(G(L/K), L×) = {1}. Moreover, the following
fundamental facts on the cohomology groups of the multiplicative group are
known:
a) H3(G(L/K), L×) = {1} (L is a local ﬁeld)
b) There exists an embedding
invK : H2(G(L/K), L×) →Q/Z.
(4.5.31)
The image of an element β ∈H2(G(L/K), L×) under this embed-
ding is called the invariant of β. For a ﬁnite extension L/K the group
H2(G(L/K), L×) is cyclic of order [L : K].
Now consider the pairing
L× × Z →L×
((x, m) →xm).
This induces a ∪-product in the cohomology groups
H0(G(L/K), L×) × H2(G(L/K), Z) →H2(G(L/K), L×).
Recall that H0(G(L/K), L×) = K×. For ∆1χ ∈H2(G(L/K), Z), we have
α ∪∆1χ ∈H2(G(L/K), L×)
for α ∈K×. Deﬁne for each character χ,
χ(θL/K(α)) = invK(α ∪∆1χ).
(4.5.32)
This determines θL/K(α) as a well deﬁned element of G(L/K). Passing to the
projective limit in (4.5.29), we obtain an element
θ(α) = lim
L θL/K(α) ∈Gab
K .
To do this we need the following compatibility property. Consider a tower of
(Abelian) Galois extensions K ⊂L′ ⊂L and let G = G(L/K), H = G(L/L′).
Let χ′ be a character of G. Then if α ∈K× induces an element sα = θL/K(α) ∈
G and the element s′
α ∈G/H under the projection G →G/H, then we have
that χ(sα) = χ′(s′
α). This follows from the deﬁnition χ(sα) = invK(α ∪∆1χ)
together with the fact that the inﬂation map takes χ′ (respectively, ∆1χ′) to
the character χ (respectively, to ∆1χ), using the commutative diagram

184
4 Arithmetic of algebraic numbers
H2(G/H, L′×)
Inf

invK











H2(G, L×)
invK

Q/Z
(4.5.33)
The map invK will be deﬁned in the next subsection via the Brauer group. The
above compatibility property will also be discussed there. This compatibility
property is very important, since it makes it possible to deﬁne the symbol
(4.5.29).
If the ﬁeld K contains a primitive root of unity ζm of degree m, then the
power residue symbol (α, β) of degree m can be deﬁned for α, β ∈K× by the
condition
θL/K(β) ·
m√α = (α, β) ·
m√α,
(4.5.34)
where L = K( m√α) is a cyclic extension and θL/K(β) is the local symbol
(4.5.32). The values of (α, β) are roots of unity of degree m, and they satisfy
the following conditions:
1) (αα′, β) = (α, β)(α′, β);
2) (α, ββ′) = (α, β)(α, β′);
3) (α, β)(β, α) = 1;
4) if (α, β) = 1 for all β ∈K× then α ∈K×m;
5) (α, β) = 1 iﬀβ is a norm of an element in the extension K( m√α)/K.
The power residue symbol symbol can be interpreted as a ∪-product in
certain one-dimensional cohomology groups, cf. [Koch70]. An explicit calcu-
lation of this symbol is given in [Koly79], [Sha50].
4.5.5 The Brauer Group, the Reciprocity Law and the
Minkowski-Hasse Principle
Recall ﬁrst some basic facts about the Brauer group of an arbitrary ﬁeld K
(see [Man70b], [Man72b], [Se63], [Se86] [Chebo49]).
A ﬁnite dimensional algebra A over K is called a simple central algebra
over K, if there exist n ≥1 such that A⊗K ∼= Mn(K), where Mn denotes the
n × n-matrix algebra and K is an algebraic closure of K. The tensor product
induces a commutative semigroup structure on the set of simple central K-
algebras (modulo isomorphism). The following equivalence relation turns this
set into a group: we say that an algebra A is equivalent to an algebra B, if
there exist m, n ≥1 such that A ⊗Mm(K) is isomorphic to B ⊗Mn(K).
All matrix algebras are equivalent to each other, and they form the identity
class of algebras. The class of the algebra A◦, inverse to A (i.e. consisting

4.5 Galois Group in Arithetical Problems
185
of the same elements and having the same addition but the opposite order
of multiplication), is the inverse of A in the group structure induced by the
tensor product. To see this, consider the canonical map A ⊗A◦→EndK(A)
(endomorphisms of the linear space A), which assignes to an element x ⊗y ∈
A ⊗A◦the multiplication by x on the left, followed by the multiplication
by y on the right. The kernel of this map is trivial, since A ⊗A◦is simple,
and the dimension of A ⊗A◦coincides with the dimension of EndK(A), i.e.
with (dim A)2. Hence the map is an isomorphism, so A ⊗A◦is isomorphic to
EndK(A) ∼= Mdim A(K).
The group of classes of central simple algebras over K is called the Brauer
group of K and is denoted by Br K. We shall now describe the Brauer group
in cohomological terms.
Let L/K be an extension of K. It is called a splitting ﬁeld of a K-algebra
A iﬀA ⊗K L ∼= Mn(L). Equivalent algebras have the same splitting ﬁelds.
Let Br(K, L) be the subset of the Brauer group, consisting of those classes
of K-algebras which split over L. This is a subgroup. Now asume that L/K
is a Galois extension with Galois group G = G(L/K). One has the following
fundamental isomorphism:
Br(K, L) ∼= H2(G, L×).
(4.5.35)
This isomorphism can be constructed in various ways; we point out one of
these, the so-called construction of "scew-products". This method consists of
explicitly constructing a central simple algebra over K from a given "factor
set", i.e. from a cocycle {ag,h} ∈Z2(G, L×). The algebra is construced as
follows:
A =
0
g∈G
Leg,
with multiplication given by
egeh = ag,hegh for all g, h ∈G,
ega = g(a)eg for all g ∈G.
Its dimension over K is obviously equal to [L : K]2. We omit to verify the
various necessary properties of the construction; note only that the associa-
tivity of A is equivalent to the fact that the cochain of structural constants is
actually a cocycle.
The condition that A splits over L has important arithmetical implications.
Put N = n2 and choose a basis {a1, . . . , aN} of A over K. If we use the
isomorphism
F : A ⊗K K
∼
→Mn(K),
(4.5.36)
then all of the elements a = N
i=1 xiai ∈A (xi ∈K) become matrices F(a) ∈
Mn(K). Then it is not diﬃcult to check that the maps

186
4 Arithmetic of algebraic numbers
τ(a) = Tr(F(a)),
ν(a) = det(F(a))
are polynomial functions of x1, . . . , xN with coeﬃcients in the ground ﬁeld K.
These maps are called respectively the reduced trace and the reduced norm of
the element a ∈A, cf. [Wei74a]:
τ(a) = lA(x1, x2, . . . , xN) a linear form,
ν(a) = ΦA(x1, x2, . . . , xN) a homogeneous polynomial of degree n.
Since F(ab) = F(a)F(b) by the isomorphism (4.5.36), ν(ab) = ν(a)ν(b). How-
ever, in case the algebra A is a division algebra, notice that each non-zero
element of A is invertible. Thus the form ΦA has no non-trivial zero over K.
On the other hand if A ⊗K L ∼= Mn(L), then ΦA does have a non-trivial zero
over L; under this isomorphism the solutions to the equation
ΦA(x1, . . . , xN) = 0
(xi ∈L)
(4.5.37)
correspond exactly to degenerate matrices.
We now describe the local invariant (cf. [Chev40], [Se63])
invK : Br K −→Q/Z
(4.5.38)
in the case when K is a ﬁnite extension of Qp. Let A be a central division
algebra (a scew-ﬁeld) over the ﬁeld K, [A : K] = n2. The valuation v = vK
of K has a unique extension to a valuation vA of A, coinciding with vK on
the center of A. For example, one can ﬁrst extend v over local ﬁelds K(α) for
α ∈A and then use the compatibility of these continued absolute values (in
view of the uniqueness property of continuations of absolute values to ﬁnite
extensions of a local ﬁeld). Considering the reduction of the algebra A modulo
the valuation vA one checks that A contains a maximal commutative subﬁeld
L unramiﬁed over the center K, and an element δ ∈Br K corresponding to
A splits over L, i.e. δ ∈H2(G(L/K), L×). A maximal unramiﬁed extension L
may not be unique in A, but all these extensions are conjugate in view of the
theorem of Skolem-Noether. This theorem states that each automorphism of
L in A over K is induced by an inner automorphism of A. Consequently, there
exists an element γ ∈A such that γLγ−1 = L and the inner automorphism
x →γxγ−1, restricted to the subﬁeld L, coincides with the Frobenius auto-
morphism FrL/K. Moreover, the element γ is uniquely deﬁned upto a factor
from L×. Let vA : A× →1
nZ be an extension of vK onto A. Then one can de-
ﬁne invKδ as the image of vA(γ) in the group ( 1
nZ)/Z ⊂Q/Z. This deﬁnition
may be restated, taking into account the fact that the map x →γnxγ−n is
equal to Frn
L/K and is thus the identity (since n = [L : K]). It therefore follows
that the element γn commutes with all elements of L and γn = c ∈L×. This
gives us
vA(γ) = 1
nvA(γn) = 1
nvA(c) = 1
nvL(c).
(4.5.39)

4.5 Galois Group in Arithetical Problems
187
Thus we have that
invKδ = i/n
(c = πi
Lu),
where u ∈O×
L , πL is a uniformizing element in L, i.e. vL(πL) = 1, vL(u) = 0.
Passing to the global case, we consider a Galois extension of number ﬁelds
L/K with Galois group G = G(L/K). Let Gv ⊂G denote the decomposition
group of an extension w of a place v to L. If the extension L/K is Abelian
then we know that the group Gv is uniquely determined by v (cf. §4.4). The
inclusion L →Lw induces a homomorphism
ϕv : H2(G, L×) −→H2(Gv, L×
w).
(4.5.40)
One veriﬁes that for an element α ∈H2(G, L) the images ϕvα vanish
for almost all v (all but a ﬁnite number): if a cocycle {ag,h} ∈Z2(G, L×)
representing α satisﬁes the condition ag,h ∈O×
w and the extension Lw/Kv is
unramiﬁed, then Hi(Gv, O×
v ) = 0 for i ≥1. This fact is deduced from the
exact sequence of cohomology groups obtained from the short exact sequence
1 −→O×
w −→L×
w −→Z −→0.
This is actually a version of Hensel's lemma , cf. §4.3.2.
Thus there exists a well deﬁned map
H2(G, L×) −→
0
v
H2(Gv, L×
w)
(4.5.41)
where w is a ﬁxed continuation of a place v and the summaton runs through
all places v of K. In this situation the local invariants
invKv : H2(Gv, L×
w) −→Q/Z
induce a map
0
v
H2(Gv, L×
w) −→Q/Z,
(4.5.42)
which is deﬁned to be the sum of all the local invariants.
The Minkowski-Hasse Local-Global Principle states that that the sequence
0 −→H2(G, L×) −→
0
v
H2(Gv, L×
w) −→Q/Z,
(4.5.43)
obtained from (4.5.41) and (4.5.42), is exact.
This exact sequence (4.5.43) plays a key role in many arithmetical ques-
tions. For example, the statement that (4.5.41) is an embedding is equivalent
to saying that for the reduced norm
ν(a) = ΦA(x1, x2, . . . , xN)
(4.5.44)

188
4 Arithmetic of algebraic numbers
the Minkowski-Hasse principle holds, i.e. the form ν(a) = ΦA(x1, x2, . . . , xn2)
has a non-trivial zero over L iﬀit has a non-trivial zero over each completion
of L.
The exactness in the middle term ⊕vH2(Gv, L×
w) describes completely
the classes of cenral simple algebras A which split over L. They correspond
bijectively to tuples of numbers i(v), 0 ≤i(v) < n, the sum of which is
divisible by n; for some algebra A with the class δ ∈H2(G, L×) one has
invKvϕv(δ) = i(v)/n ∈1
nZ/Z.
Finally, the statement that for δ ∈H2(G, L×) one always has

v
invKv(ϕv(δ)) = 0 ∈Q/Z,
is essentially equivalent to the product formula for local symbols (4.5.38), and
to the global reciprocity law.
Indeed, if α = (αv)v ∈JK is an idele, then the global Artin symbol θ(α) ∈
Gab
K is deﬁned as the limit θ(α) = limS

v∈S θv(αv) where the product is
ﬁnite, and the local symbols are deﬁned by the condition
χ(θv(αv)) = invKv(α ∪∆1χ)
(4.5.45)
(see (4.5.32)) for all characters χ ∈H1(Gab
Kv, Q/Z).
If α ∈K×, i.e. αv = α ∈K× for all v, then for all characters χ ∈
H1(Gab
K , Q/Z) one has
χ

v
θv(αv)

=

v
invKv(α ∪∆1χ) = 0,
since the element
α ∪∆1χ ∈H2(Gab
K , Q/Z)
belongs to the global Brauer group.
In the case when the extension L/K is cyclic, one can construct using
purely cohomological methods a canonical isomorphism
H2(G(L/K), L×) ∼= K×/NL/KL×
(4.5.46)
and the exact sequence (4.5.43) implies the following:
Theorem 4.27 (Hasse's Theorem on Norms). If a ∈K× and L/K a
cyclic extension, then a ∈NL/KL if and only if a ∈NLw/KvLw for all places
v of K.
In particular, let G be the group of order 2, so that L = K(
√
b). Then
NL/K(x+y
√
b) = x2−by2. Hence a can be represented by the form x2−by2 over
K iﬀit can be represented by it everywhere locally, i.e. over every completion
of K. This implies that a quadratic form Q(x, y, z) in three variables over K

4.5 Galois Group in Arithetical Problems
189
has a non-trivial zero over K iﬀit has a non-trivial zero over every completion
of K. Passing to arbitrary n we obtain the Minkowski-Hasse theorem, which
states that a quadratic form has a non-trivial zero over K iﬀit has a non-
trivial zero everywhere locally, cf. [Chev40], [Cas78].
It was pointed out to us by B.Moroz (MPIM-Bonn), that Hasse's Theo-
rem on Norms may hold for some non-cyclic extensions, providing interesting
examples of the validity of the Minkowski-Hasse principle, and Theorem 6.11
of [PlRa83] at p.309 gives an interesting cohomological condition for Hasse's
Theorem on Norms to hold.

5
Arithmetic of algebraic varieties
5.1 Arithmetic Varieties and Basic Notions of Algebraic
Geometry
5.1.1 Equations and Rings
(cf. [Sha88], [Sha87], [Bou62]). The machinery of algebraic geometry uses com-
mutative rings instead of equations. Replacing a system of equations by a ring
is similar to replacing an algebraic number given as a root of a polynomial by
the corresponding ﬁeld (or ring) extension. Consider a system of equations
X : Fi(Tj) = 0 (i ∈I, j ∈J).
Here I and J are index sets; the Tj are independent variables; Fi are polyno-
mials from the ring K[Tj] and K is a commutative ring. We shall say that X is
deﬁned over K. Now the question arises, which objects should be called solu-
tions of the system X? There is an obvious deﬁnition: it is a family (tj), j ∈J,
of elements of K such that Fi(tj) = 0 for all i ∈I. However, this deﬁnition is
too restrictive. We could also be interested in solutions not belonging to K,
for example the complex roots of a polynomial with rational coeﬃcients. In
general, consider a K-algebra L.
5.1.2 The set of solutions of a system
Deﬁnition 5.1. An L-valued solution of X is a family (tj), j ∈J of elements
of L such that Fi(tj) = 0 for all i ∈I. The set of all such solutions is denoted
X(L).
Since every ring is a Z-algebra, if X is deﬁned over Z then we can con-
sider its solutions with values in any ring. Let f : L1 →L2 be a K-algebra
homomorphism, ie. a homomorphism of rings and of K-modules. Then for
any L1-valued solution (tj) of X, (f(tj)) is an L2-valued solution. Hence f
induces a map X(L1) →X(L2).

192
5 Arithmetic of algebraic varieties
5.1.3 Example: The Language of Congruences
Let n be an integer of the form 4m + 3. Here is the classical proof that n is
not a sum of two integral squares: if it were then there would be a solution
to the congruence T 2
1 + T 2
2 ≡3 mod 4, whereas a short case-by-case check
shows that this is unsolvable. From our new viewpoint this argument can be
rephrased as follows. Let X denote the equation T 2
1 +T 2
2 −n = 0 (K = Z). We
want to prove that X(Z) = ∅. Consider Z/4Z as Z-algebra via the reduction
homomorphism Z →Z/4Z. There is then an induced map X(Z) →X(Z/4Z).
If X(Z) were non-empty, X(Z/4Z) would also be non-empty, which is false.
In general, for any system X over Z, if X(L) is empty for some algebra L, then
X(Z) is empty. In practice one usually tests for solutions in the ﬁnite rings
Z/mZ and the real numbers R. A more satisfactory theoretical formulation
uses p-adic ﬁelds and the ring of adèles (see Chapter 4, §4.3).
5.1.4 Equivalence of Systems of Equations
Deﬁnition 5.2. Two systems of equations X and Y with one and the same
family of indeterminates over a ring K are called equivalent if X(L) = Y (L)
for each K-algebra L. Among all systems equivalent to a given one X, there
is a largest one. Its left hand sides form the ideal P generated in K[Tj] by
the Fi(Tj). In order to see that this is equivalent to X, it suﬃces to take
L = K[Tj]/P.
5.1.5 Solutions as K-algebra Homomorphisms
We summarize the results of our discussion. Starting with the system X as
above, we construct the algebra A = K[Tj]/P. Then for any K-algebra L we
have a natural identiﬁcation
X(L) = HomK(A, L).
The system X is called solvable, if X(L) is non-empty for some non-trivial
(that is, with 0 ̸= 1) K-algebra L. One sees that X is solvable iﬀ1 is not
contained in P.
We have established the equivalence of two languages: systems of equations
up to equivalence and algebras with a marked family of generators. Forgetting
about the generators, we identify further those systems of equations that
are related by invertible changes of variables. Each element of A can play
the role of an indeterminate in a suitable system. The value taken by this
indeterminate at a given solution is equal to its image with respect to the
homomorphism A →L corresponding to this solution.
In classical algebraic geometry, an (aﬃne) algebraic variety over an alge-
braically closed ﬁeld K = K is deﬁned to be the set Z ⊂Kn of common
zeroes of a system of polynomials

5.1 Arithmetic Varieties and Basic Notions of Algebraic Geometry
193
Fi(T1, . . . , Tn) ∈K[T1, . . . , Tn].
The ring of regular algebraic functions on Z is by deﬁnition,
A = K[Z] = K[T1, . . . , Tn]/PZ,
where PZ is the ideal consisting of all polynomials vanishing on Z. Obviously,
A is a ﬁnitely generated K-algebra without nilpotents. Conversely any such
algebra is of the type K[Z].
The abstract notion of a scheme allows us to consider an arbitrary com-
mutative ring A as a set of functions on a space Spec(A).
5.1.6 The Spectrum of A Ring
Deﬁnition 5.3. The set of all prime ideals of a (commutative) ring A (dis-
tinct from A) is called the spectrum of A and is denoted Spec(A). An element
x ∈Spec(A) is called a point of the spectrum; the corresponding ideal is de-
noted px ⊂A.
Recall that an ideal p ⊂A is prime iﬀthe quotient ring A/p has no zero
divisors. We shall denote the ﬁeld of fractions of A/px by R(x).
5.1.7 Regular Functions
Each element f of A deﬁnes a function on Spec(A) whose value at a point
x is the residue class f(x) = f mod px considered as an element of R(x).
Two distinct elements of A may take the same values at all points of the
spectrum. This happens iﬀtheir diﬀerence belongs to the intersection of all
prime ideals of A, i.e. to the ideal of all nilpotent elements of A (cf. [Bou62],
[SZ75]). For this reason, the rings of functions of classical algebraic geometry
usually contained no nilpotents. However, this restriction is unnatural even in
many classical situations, since nilpotents arise geometrically when an alge-
braic variety depending on a parameter degenerates in a certain way (e.g. a
polynomial acquires multiple roots). For this reason nilpotents are allowed in
modern algebraic geometry, and all elements of A are thought of as pairwise
distinct regular functions on the spectrum.
We now deﬁne a canonical topology on Spec(A). A minimal consistency
requirement of this topology with a given set of functions is that the vanishing
sets of all functions are closed.
5.1.8 A Topology on Spec(A)
For any subset E ⊂A, denote by V (E) ⊂Spec(A) the set of all points
x ∈Spec(A) for which f(x) = 0 for all f ∈E. The family {V (E)} consists of
all closed sets of a topology on Spec(A) called the Zariski, or spectral topology.
Each ring homomorphism ϕ : A →B induces a continuous map

194
5 Arithmetic of algebraic varieties
aϕ : Spec(B) →Spec(A).
By deﬁnition for y ∈Spec(B), we have
paϕ(y) = ϕ−1(py).
Each set V (E) is itself a prime spectrum: V (E) can be identiﬁed with
Spec(A/PE) where PE is the ideal generated by E. This identiﬁcation is in-
duced by the canonical homomorphism
A →A/PE.
There is also an important basis of open subsets of Spec(A) consisting of
the sets D(f) = Spec(A[1/f]) for f ∈A. In fact for each E ⊂A we have
Spec(A)\V (E) = ∪f∈ED(f).
The spectra Spec(A) have very non-classical topologies. As a rule, these
spaces are not separable. The closure of any point x ∈Spec(A), can be de-
scribed as follows:
{x} =
.
E⊂px
V (E) = V
 .
E⊂px
E

= V (px) = {y ∈Spec(A) , py ⊃px}.
In particular this space is isomorphic to Spec(A/px), so only the points cor-
responding to the maximal ideals are closed. If y ∈{x}, one sometimes says
that y is a specialization of x; this is equivalent to px ⊂py. If A has no
zero divisors then the ideal (0) ∈Spec(A) corresponds to the generic point of
Spec(A), whose closure coincides with the whole spectrum. One can imagine
that the points of Spec(A) have diﬀerent depths which can be, loosely speak-
ing, measured by the number of specializations of the generic point necessary
to reach a given point. This idea leads to one of the deﬁnitions of dimension in
algebraic geometry. A sequence x0, x1, . . . , xn of points of a topological space
X is called a chain of length n beginning at x0 and ending at xn if xi ̸= xi+1
and xi+1 is a specialization of xi for all i. The dimension dim(X) is deﬁned
to be the maximal length of such chains.
For example in X = Spec K[T1, . . . , Tn] (where K is a ﬁeld) there
is a chain (0) ⊂(T1) ⊂. . . ⊂(T1, . . . , Tn), so dim(X) ≥n. Similarly,
dim Spec Z[T1, . . . , Tn] ≥n + 1 because there is a chain
(0) ⊂(p) ⊂(p, T1) ⊂(p, T1, T2) ⊂. . . ⊂(p, T1, T2, . . . , Tn).
Actually, in both cases the strict equality holds.
Passing to the closures instead of the points themselves, one can say that
this is a variant of the old "deﬁnition" of dimension due to Euclid: points are
boundaries of curves, curves are boundaries of surfaces, surfaces are bound-
aries of solids.
Arithmetical intuition is greatly enhanced when one considers rings of
arithmetical type (that is, quotient rings Z[T1, . . . , Tn]/P) and their spectra
as analogues of algebraic varieties over ﬁelds.

5.1 Arithmetic Varieties and Basic Notions of Algebraic Geometry
195
This is in the spirit of the general analogy between numbers and functions.
For example, integral extensions of rings correspond to coverings of complex
varieties, in particular Riemann surfaces. More precisely, let ϕ : R ⊂S be
an integral extension, so that S is a ﬁnitely generated R-module. Then the
corresponding contravariant map aϕ : Spec(S) →Spec(R) is surjective, and
its restriction to the subset Spm(S) of maximal ideals (closed points) is also
surjective (cf. [Sha88]).
For x ∈Spec(R), the ﬁber (aϕ)−1(x) can be described as Spec(S/ϕ(px)S).
The structure of the ﬁbers over closed points is described by a decomposition
theorem. In particular aϕ is called unramiﬁed at x ∈Spm(R) if S/ϕ(px)S has
no nilpotents, and is therefore a direct sum of ﬁelds.
Example 5.4. Figure 5.1 depicts Spec(Z[i]) as a covering of Spec(Z) (cf.
[Sha88]). The generic point ω′ of Spec(Z[i]) projects onto the generic point ω
of Spec(Z). The other points are closed. A closed point of Spec(Z) is essentially
a prime p. The ﬁber (aϕ)−1((p)) consists of the prime ideals of Z[i] dividing
p. They are principal. There are two of them if p ≡1(mod 4); otherwise there
is one. Only 2 is ramiﬁed (of multiplicity two).
Fig. 5.1.
Notice that Spec(Z) and Spec(Z[i]) are one-dimensional (as are algebraic
curves). More precisely, Spec(Z) should be thought of as being an analogue
of the aﬃne line, that is, the projective line minus one point. (We shall later
explain how one "compactiﬁes" Spec(Z) by adding the arithmetical inﬁnity).
This analogy can be illustrated by two deep theorems of algebraic number
theory. The ﬁrst is Minkowski's theorem that Q has no proper unramiﬁed
extensions. The second theorem is Hermite's theorem that Q (or any ﬁnite
extension of Q) has only a ﬁnite number of extensions with given ramiﬁcation
points and bounded degree.

196
5 Arithmetic of algebraic varieties
These arithmetical facts have their geometric counterparts in the theory
of Riemann surfaces: the Riemannian sphere has no non-trivial unramiﬁed
coverings, and the number of coverings (up to isomorphism) of a given compact
Riemann surface X, which are unramiﬁed outside of a given ﬁnite set of points
and have a ﬁxed degree, is ﬁnite. To prove these statements, one can use the
following formula due to Hurwitz. Let f : Y →X be a covering of Riemann
surfaces; gX, gY their genera and eP the ramiﬁcation index of f at a point
P ∈Y . Then
2gY −2 = deg(f)(2gX −2) +

P ∈Y
(eP −1).
(5.1.1)
Alongside this one uses an explicit description of the fundamental group
π1(X\S) of a Riemann surface with a ﬁnite set of points S removed. This
group has only ﬁnitely many subgroups of a given index.
A more sophisticated version of this analogy (dealing with algebraic curves
over number ﬁelds instead of ﬁnite extensions) was developed by I. R. Shafare-
vich in his Stockholm ICM talk (cf. [Sha62]). The ﬁniteness conjectures stated
in this talk prompted a wealth of research which eventually lead to the proof
of all these conjectures as well as the Mordell conjecture on the ﬁniteness of
the number of rational points on any curve of genus g > 1 over a number ﬁeld
([Fal83], see also §5.5).
5.1.9 Schemes
The notion of a scheme is basic to algebraic geometry. An aﬃne scheme is
essentially a pair (Spec(A), A), where A is a commutative ring. More precisely,
it is a topological space Spec(A) = X, endowed with a sheaf of local rings OX
whose ring of sections over an open set D(f) is A[f −1]. A general scheme X is
a topological space X with a structure sheaf OX such that (X, OX) is locally
(in a neighbourhood of each point) isomorphic to an aﬃne scheme (see [Ha77],
[Sha88]).
Schemes form a category. Morphisms of aﬃne schemes are deﬁned to corre-
spond bijectively to the homomorphisms of the commutative rings. Morphisms
of schemes are given by such homomorphisms locally.
For a commutative ring K, one can deﬁne a K-scheme as a morphism X →
Spec(K). In the category of K-schemes, morphisms should be compatible
with the structural morphisms to Spec(K). Every aﬃne scheme deﬁning X
has locally a canonical structure as the spectrum of a K-algebra.
A scheme is called irreducible if its topological space is irreducible, i.e. if
it is not a non-trivial union of two closed subspaces.
We shall say that X is a scheme of geometric type if it can be covered by a
ﬁnite number of spectra of rings of ﬁnite type over a ﬁeld K. Similarly we say
that X is a scheme of arithmetic type if it can be covered by a ﬁnite number
of spectra of rings of ﬁnite type over Z.

5.1 Arithmetic Varieties and Basic Notions of Algebraic Geometry
197
These two classes have a non-empty intersection consisting of geometric
schemes over ﬁnite ﬁelds Fq. They were and are a standard testing ground
for various conjectures in which geometric and arithmetical intuitions are
combined. We shall repeatedly turn to this class of schemes. In particular,
if X →Spec(OK) is a scheme of arithmetic type over the ring of integers
OK of a number ﬁeld K, we can deﬁne for every prime ideal p ⊂OK the
reduction X mod p. This is a scheme over the ﬁnite ﬁeld OK/p. Considerable
arithmetical information concerning X is encoded in the set all reductions
X mod p.
For a scheme X of one of these types, dim X is deﬁned to be the maximal
length of a chain
Z0 ⊂Z1 ⊂. . . ⊂Zn,
Zi ̸= Zi+1,
consisting of irreducible subspaces of X. If X is itself irreducible, with generic
point x having residue ﬁeld R(x), then dim X coincides with the so-called
Kronecker dimension of R(x), that is, the transcendence degree of R(x) over
its prime subﬁeld, enlarged by one if Char R(x) = 0. In particular,
dim An
Z = dim Spec Z[x1, . . . , xn] = n + 1.
Example 5.5. The projective space Pn
K over a ring K Consider the poly-
nomial ring S = K[T0, . . . , Tn] graded by total degree S = ⊕d≥0Sd. Put
S+ = ⊕d>0Sd. This is a graded ideal. Deﬁne Proj(S) to be the set of all
homogeneous prime ideals of S which do not contain S+. It is a topological
space, whose closed subspaces are the sets
V (a) = {p ∈Proj(S) | p ⊃a}
where a is a homogeneous ideal of S. In order to turn Proj(S) into a scheme,
put
Ai = K[T0/Ti, . . . , Tn/Ti],
Aij = Ai[Ti/Tj].
We can identify Spec(Ai) with an open subset of Proj(S) in such a way that
Spec(Ai) ∩Spec(Aj) = Spec(Aij).
The structure sheaves can also be glued together in a coherent way. As a
result, Proj(A) becomes a K-scheme Pn
K which is called the projective space
over K.
5.1.10 Ring-Valued Points of Schemes
Let X →Spec(K) be a K-scheme and L a K-algebra. We deﬁne an L-
point of X (over K) to be a morphism Spec(L) →X over K. Denote the set
MorK(Spec(L), X) of L-points by X(L). If L is a ﬁeld, we call these points
geometric.

198
5 Arithmetic of algebraic varieties
Example 5.6. a) Let X = An
Z, K = Z, L = Fq. Then an L-point
Z[T1, . . . , Tn] →Fq
is an n-tuple
(t1, . . . , tn) ∈Fn
q .
Hence Card X(Fq) = qn.
b) Let X = Pn
Z, K = Z, L = Z/NZ. An element of X(Z/NZ) is a class of
(n + 1)-tuples (t0 : . . . : tn) ∈(Z/NZ)n+1 such that at least one of the
coordinates is invertible. Two tuples are equivalent iﬀtheir coordinates
diﬀer by a common factor in (Z/NZ)×. The ith coordinate is invertible
precisely when the point lies in Spec(Ai) (cf. §5.1.9). It is not diﬃcult to
count the total number of Z/NZ-points:
Card Pn
Z(Z/NZ) = N n 
p|N
pn+1 −1
(p −1)pn = N n+1
ϕ(N)

p|N
(1 −p−(n+1)). (5.1.2)
5.1.11 Solutions to Equations and Points of Schemes
Solving a Diophantine equation or a system of equations is the same as ﬁnding
a point in a scheme of arithmetic type. In fact, a family of polynomials over
a ring K,
Fi(T1, . . . , Tn) ∈K[T1, . . . , Tn]
(i ∈I)
generates an ideal a ⊂K[T1, . . . , Tn] and for any K-algebra L, the L-points of
the aﬃne scheme Spec(K[T1, . . . , Tn]/a) correspond bijectively to the solutions
of Fi = 0 in Ln.
If the Fi are homogeneous then we may consider the corresponding pro-
jective scheme
Proj(K[T1, . . . , Tn]/a)
and its points. For a general algebra L, the relation between L-points and
solutions here is somewhat complicated. For example if L is the ring of integers
in an algebraic number ﬁeld, then the set of L-points of Pn
Z is related to the
ideal class group of L. However when L is a ﬁeld, the L-points correspond to
non-zero L-valued solutions upto a homogeneity factor.
Projective space over a ﬁeld can be obtained from the aﬃne space by
adding the hyperplane at inﬁnity. Intuitively the transition to projective
schemes is a kind of compactiﬁcation. For this reason, projective schemes
and varieties possess many nice geometric properties which play an important
role in arithmetical investigations.

5.1 Arithmetic Varieties and Basic Notions of Algebraic Geometry
199
5.1.12 Chevalley's Theorem
Theorem 5.7. Let X be a subscheme of Pn
K over a ﬁnite ﬁeld K = Fq deﬁned
by an equation F(T0, . . . , Tn) = 0, where F is a form of degree d and n > d.
Then the set X(Fq) (of projective solutions) is non-empty.
cf. ([BS85], [War36]).
Denote by NF the number of solutions of F = 0 in Fn+1
q
, i.e. the number
of Fq-points of the corresponding aﬃne scheme. We shall prove that p|NF
where p is the prime dividing q. Since F(0, . . . , 0) = 0, this shows that there
must also be a non-zero solution.
Obviously 1 −F(T)q−1 is equal to 1 ∈Fq at the points of (the cone over)
X and 0 elsewhere. Therefore,
¯NF = NF mod p =

t∈An+1(Fq)
(1 −F(t)q−1).
(5.1.3)
We now expand the right hand side of (5.1.3) into a sum of monomials. Most
of these will add up to zero. More precisely,

t∈Fn+1
q
ti0
0 ti1
1 . . . tin
n = 0
(5.1.4)
unless all the ik are non-zero and are divisible by q −1. This can be checked
for n = 0 directly, and then for general n by expanding the sum in (5.1.4) into
the product of n + 1 factors.
If a monomial T i0
0 . . . T in
n
appears in the expansion of 1 −F(T)q−1,
then necessarily ij < q −1 for at least one j; otherwise we would have
(q −1) deg F(T) ≥n(q −1) contradicting the assumption that d < n. Hence
ﬁnally ¯NF = 0, so p|NF .
5.1.13 Some Geometric Notions
In this subsection, we shall brieﬂy review some notions of algebraic geometry
over ﬁelds, which will be used later. For a detailed treatment we refer the
reader to the volumes of this series devoted to algebraic geometry.
i)Irreducible components. Every K-variety (a geometric scheme over a ﬁeld
K without nilpotent elements in its structure sheaf) is a ﬁnite union of its
irreducible components. After a ﬁnite algebraic extension of the base ﬁeld
K, an irreducible variety may become reducible (its components may form
an orbit with respect to the action of an appropriate Galois group). A va-
riety which remains irreducible after any algebraic extension of the ground
ﬁeld, is called absolutely (or geometrically) irreducible. Each irreducible
variety has a well deﬁned dimension.

200
5 Arithmetic of algebraic varieties
ii)Singular points. A point x ∈V can be singular or non-singular (regu-
lar). Amongst the many equivalent deﬁnitions of regularity, the following
is probably the shortest: x is regular iﬀthe completion of the local ring
Ox (with respect to the mx-adic topology where mx is the maximal ideal)
is isomorphic to a ring of formal power series over k(x) = Ox/mx. The
regular points form a Zariski open subset of V . If V is given by a ho-
mogeneous equation F(x1, . . . , xn) = 0 in a projective space, one can ob-
tain additional equations for the subvariety of singular points by putting
∂F(x)/∂xi = 0.
Intersection points. A point of intersection of two irreducible components is
always singular.
Genus and singular points. The existence of singular points can drastically
change both the geometry and the arithmetical properties of a variety.
For example, a non-singular cubic curve in a projective plane has genus
one; its set of rational points over, say, Q is quite small (cf. §5.3 below).
When such a curve acquires a double point, the genus of its non-singular
model becomes zero, and its set of rational points becomes much larger.
iii)Embeddins and heights. A variety V given abstractly by an aﬃne atlas and
gluing rules may or may not be embeddable in a projective space. A vari-
ety which is given as a subvariety of a projective space admits in general
many more inequivalent embeddings. A choice of such an embedding (if it
exists at all) is an extremely important additional structure. In geometry,
it allows one to use various induction techniques (ﬁbration by hyperplane
sections etc.). In algebra, it governs most of the sheaf cohomology calcula-
tions via various ﬁniteness and vanishing results. In arithmetic the choice
of an embedding leads to the notion of the height of a rational point, which
is used in most of the quantitative problems of the Diophantine geometry.
Divisors and Invertible sheafs. We therefore say a few words about divisors
and invertible sheaves, the universally used geometric notions which gen-
eralize the ideas of a hyperplane sections and a projective embeddings.
Cartier divisors. Let V be a variety. A (Cartier) divisor on V is given in an
aﬃne atlas V = ∪Ui by a family of elements {fi}, where fi is a rational
function on Ui. On the intersection Ui ∩Uj, we require that fi = uijfj
for some regular, regularly invertible function uij. Two families {fi}, {gi}
determine the same divisor if fi = uigi for all i, where ui is a regular and
regularly invertible function on Ui. The divisors form a group Div(V ) un-
der the natural composition: {fi}{gi} = {figi}. Every hyperplane section
is a divisor. If all the {fi} are regular, the divisor is said to be eﬀective.
Picard group. An invertible sheaf on V is a locally free, one dimensional OV -
module L. The set of all such sheaves upto isomorphism forms a group
Pic(V ) with respect to the tensor product. Every divisor D deﬁnes an
invertible sheaf O(D): its sections over Ui can be identiﬁed with elements
of fiOUi. Vice versa, a meromorphic section of L deﬁnes a divisor D and an
identiﬁcation L ∼= O(D). In this way, we have a surjective homomorphism
Div(V ) →Pic(V ).

5.1 Arithmetic Varieties and Basic Notions of Algebraic Geometry
201
Ample sheaves. A projective space has a canonical invertible sheaf O(1). Each
morphism ϕ : V →Pn determines the invertible sheaf L = ϕ∗(O(1)). The
sheaves L obtained from the closed embeddings ϕ are called very ample.
L is called ample if some positive power of it is very ample.
iv)Canonical sheaf. If V is non-singular, one can deﬁne the locally free OX-
module of 1-forms Ω1
X whose rank is d = dim(V ). Its dth exterior power
ωV is called the canonical sheaf of V . Its numerical properties have a very
strong inﬂuence on the arithmetical properties of V (cf. the next section).
For V = Pn we have ωV = O(−n −1), so ω−1
V
is ample. Simultaneously
the set of rational points could not be larger. When ωV becomes ample,
one conjectures that most rational points are concentrated on a proper
Zariski closed subvariety.

5.2 Geometric Notions in the Study of Diophantine
equations
5.2.1 Basic Questions
Consider a ﬁnite system of polynomial equations over Z. As was explained in
§5.1, such a system deﬁnes an arithmetic scheme X, its set of integral points
X(Z) and sets X(L) for more general rings L, for example, rings of integers
O of algebraic number ﬁelds.
Let X be a smooth projective algebraic variety over a number ﬁeld K with
the maximal order O = OK. In this case the K-points of X coincide with its
O-points, so we shall speak about X(K) rather than X(O).
In number theory, one is interested in properties of K-rational points X(K)
on X. In algebraic geometery one studies the properties of X(C) considered as
a topological space, analytic manifold, or algebraic variety (or, more generally,
one studies X(L) for various algebraically closed ﬁelds L). Geometric methods
in the theory of Diophantine equations are used in order to relate the geometry
of X(C) to the arithmetical properties of X(K).
The relevance of such methods is most evident for congruences, or, more
generally, varieties over ﬁnite ﬁelds. A.Weil in his famous note (cf. [Wei49]) for-
mulated several conjectures concerning the numbers of points of such schemes
and suggested that there should exist a cohomology theory in ﬁnite charac-
teristic such that a Lefschetz type theorem in this theory would imply (a part
of) these conjectures. A.Grothendieck and his collaborators developed such a
cohomology theory, and P.Deligne accomplished the realization of Weil's pro-
gramme by proving the Weil-Riemann conjecture in full generality. In Chapter
6, §6.1 we brieﬂy describe these results.
In this section we survey some known connections between geometry and
arithmetic over number ﬁelds.
A) Is X(K) non-empty?
B) Is X(K) ﬁnite or inﬁnite? Is it dense in X?
C) If X(K) is inﬁnite, what is the order of growth of
N(H; B) := Card {x ∈X(K)|H(x) ≤B}?
Here H is a (exponential) certain "height" function, e.g. in ﬁxed coordi-
nates, for X ⊂Pn,
H(x0, . . . , xn) =

v∈Val(K)
maxi(|xi|v).
D) Can one, at least in some sense, describe the set X(K) as a ﬁnitely
generated structure?

5.2 Geometric Notions in the Study of Diophantine equations
203
For any of these questions one may also be interested in algorithmic so-
lutions. Matiyasevich's theorem is, however, a strong indication that one will
not be able to answer these questions for all varieties. Instead, one could try to
prove conditional statements of the type "if X(C) has such-and-such geomet-
ric properties (is a one-dimensional irreducible non-singular variety, projective
algebraic group, ﬂag space . . .), then X(K) has such-and-such arithmetical
properties (is ﬁnite, ﬁnitely generated; N(H; B) grows as a power of B . . .)".
One expects that in the stable range, allowing for a ﬁnite extension of K and
restricting to a Zariski open subset U of X, there is a relation between the
set of rational points on U and geometric invariants of X.
Below we shall brieﬂy discuss some results of the latter type, grouping
them around questions A) - D).
5.2.2 Geometric classiﬁcation
One of the main geometric invariants of a smooth projective variety X is
its canonical class KX (see §5.1). Algebraic varieties can be classiﬁed, very
roughly, according to the ampleness of the anticanonical class −KX, resp.
KX. Varieties with ample −KX are called Fano, with ample KX - varieties of
general type and intermediate type varieties, otherwise. In ﬁner classiﬁcation
theories, and in many arithmetic applications, one has to allow "mild" singu-
larieties and to introduce further invariants such as Kodaira dimension, cones
of eﬀective and ample divisors etc.
In dimension one the above classiﬁcation coincides with the topological
classiﬁcation of Riemann surfaces: genus 0, ≥2, resp. 1. Fano varieties in
dimension two are called Del Pezzo surfaces. Over an algebraically closed
ﬁeld, these are:
P2, P1 × P1, Sd
where Sd is the blowup of P2 at 9 −d points, and the degree d = 1, . . . , 8.
Surfaces of intermediate type include: abelian surfaces and their quotients, K3
surfaces and Enriques surfaces. The classiﬁcation of Fano varieties in dimen-
sion three was a major achievement by Iskovskikh and Mori-Mukai, cf. [Isk77],
[Isk78], [MoMu84], [MoMu03], completing the work of the Italian school, no-
tably G. Fano. Examples are cubics, quartics or double covers of P3 ramiﬁed
in a surface of degree 6. Interesting three-dimensional varieties of intermedi-
ate type are Calabi-Yau threefolds. One knows that in every dimension, the
number of families of Fano varieties is ﬁnite.
Fano varieties are, in some sense, similar to projective spaces. As we have
seen, Del Pezzo surfaces over C are birational to P2. Generally, Fano varieties
have the following properties, quite important for arithmetic applications:
through every point in X there is a rational curve of anticanonical degree
≤dim X + 1, deﬁned over C, and any two points can be connected by a chain
of rational curves. However, it is unknown whether or not all Fano threefolds
are dominated by a projective space.

204
5 Arithmetic of algebraic varieties
5.2.3 Existence of Rational Points and Obstructions to the Hasse
Principle
Let X be an algebraic variety over a number ﬁeld K. An obvious necessary
condition for X(K) to be non-empty is that X(Kv) ̸= ∅, for every completion
Kv of K. If this condition is also suﬃcient we say that X satisﬁes the Hasse
(or Minkowski-Hasse) principle.
Using the circle method one can prove the Hasse principle for complete
intersections in projective spaces whose dimension is suﬃciently large with
respect to the degree. B.J. Birch (1962) has proved the following general result.
Let X ⊂Pn−1 be given by r equations. Assume that the dimension of the
subvariety of singular points of X is less than
n −1 −r(r + 1)(d −1)2d−1.
Then X satisﬁes the Hasse principle. In particular, it holds for
a) quadrics of dimension ≥3 (with number of variables n ≥5);
b) intersections of two quadrics of dimension ≥10 (n ≥13);
c) cubic hypersurfaces of dimension ≥15 (n ≥17).
One conjectures that this is true for n ≥9 in case b) and n ≥10 in case c);
this last conjecture was proved, over Q, by Ch. Hooley (cf. [H88]).
The best known results for the case b) are due to J.-L. Colliot-Thélène,
J.-J. Sansuc, and P. Swinnerton-Dyer.
Of course, the case of quadrics is classical. For cubic forms in 3 and 4 vari-
ables the Hasse principle may fail. A conceptual approach to higher obstruc-
tions to the existence of rational points was proposed in [Man70a], [Man72b].
It is based on the Hasse-Minkowski principle for the Brauer group over a num-
ber ﬁeld (see in §4.5 of the previous Chapter, the exact sequence (4.5.43)),
and Grothendieck's generalization of the Brauer group for schemes. One has
the following diagram
Br(X)

x

⊕vBr(Xv)
(xv)v

0
 Br(K)
 ⊕vBr(Kv)

v invv
 Q/Z
 0
In detail, if X is a scheme over a ﬁeld K, an element a ∈Br(X) is represented
by a family of semi-simple algebras parametrized by X. In particular, for
any extension ﬁeld L ⊃K and an L-point x ∈X(L), one has a natural
specialization a(x) ∈Br(L), with obvious functorial properties. Assume that
X(Kv) ̸= ∅for all v and that for every (xv)v ∈X(A), where A is the adèle
ring of K, there exists an a ∈Br(X) such that

v
invv(a(xv)) ̸= 0.

5.2 Geometric Notions in the Study of Diophantine equations
205
Then (xv)v cannot belong to X(K) and one says that X has a non-trivial
Brauer-Manin obstruction to the Hasse principle.
One of the simplest examples in which the Brauer-Manin obstruction is
non-trivial, is furnished by the projective cubic surface X over Q:
z(x + z)(x + 2z) =
3

i=1
(x + θ(i)y + θ(i)2z),
where θ(i) are the three roots of
θ3 + 7(θ + 1)2 = 0
(this example is due to Swinnerton-Dyer). Its set of adèlic points is non-empty.
A local analysis shows that one can construct two elements a1, a2 of the
Brauer group of this surface with the following properties:
i) if v ̸= 7, the local invariants of ai(xv) vanish for every xv ∈X(Qv);
ii) for every x7 ∈X(Q7), either inv7(a1(x7)) ̸= 0, or inv7(a2(x7)) ̸= 0.
Hence the Hasse principle fails for this surface.
J.-L. Colliot-Thélène, J.-J. Sansuc and D. Kanevsky have compiled a table
of diagonal cubic surfaces ax3 + by3 + cz3 + du3 = 0 with integral coeﬃcients
in the range [−500, 500] having rational points everywhere locally, for which
the Brauer-Manin obstruction vanishes. A computer search has shown that
all these surfaces have rational points. One might therefore conjecture that
the vanishing of this obstruction implies the existence of a rational point for
all diagonal cubic surfaces, or perhaps all non-singular cubic surfaces, or even
all non-singular rational surfaces (i.e. those admitting a birational parame-
trization by two independent parameters over C). This conjecture has been
proved for the so called generalized Chatelet surfaces given by an equation of
the form y2 −az2 = P(x), where a is not a square and P is a polynomial of
degree three or four.
The Brauer-Manin obstruction has been thoroughly investigated for three
classes of varieties:
i) rational surfaces;
ii) principal homogeneous spaces of linear algebraic groups, especially alge-
braic tori;
iii) principal homogeneous spaces of elliptic curves and more generally Abelian
varieties.
Historically, iii) was the ﬁrst example. However, it appeared in a diﬀerent form
in the theory of the Shafarevich-Tate group, whose classical deﬁnition will be
given in the next section. The connection with the Brauer-Manin obstruction
is explained in [Man70a].
J.-L. Colliot-Thélène and J.-J. Sansuc have developed a geometric version
of this obstruction, which is called the descent obstruction.

206
5 Arithmetic of algebraic varieties
Assume that for a variety X over K we have somehow constructed a family
of dominating morphisms fi : Yi →X such that X(K) = 1 fi(Yi(K)). Then
one can establish that X(K) is empty by showing that for each Yi there exists
a completion Kv(i) such that Yi(Kv(i)) = ∅. On the other hand, if X(K) is
non-empty, and the Yi are in some sense simpler than X, e.g. rational, one
obtains an explicit description of the set X(K).
Colliot-Thélène and Sansuc have developed a systematic way of construct-
ing such families, based on the notion of a torsor. They have shown that
for non-singular rational varieties these descent families have the following
properties:
a) The descent obstruction vanishes iﬀthe Brauer-Manin obstruction van-
ishes.
b) The Brauer-Manin obstructions for the descent varieties Yi vanish.
Using the machinery of torsors, Skorobogatov cf. [Sko99] constructed an
example of a surface with trivial Brauer-Manin obstruction and not satisfying
the Hasse principle. The surface in question has a nontrivial fundamental
group and the obstruction may be interpreted via non-abelian descent (see
also [Sko01] and [HaSk02]).
5.2.4 Finite and Inﬁnite Sets of Solutions
Once it is established that the set of rational points X(K) on an algebraic
variety X over a number ﬁeld K is not empty one could ask whether this set
is ﬁnite or, for example, dense in X. First of all, let us describe the results in
the case of smooth projective curves:
i) Let X be a curve of genus zero. The X satisﬁes the Hasse principle. More
precisely, X can be given by a homogeneous quadratic equation in P2
K:
aX2 + bY 2 + cZ2 = 0
and the local conditions can be checked algorithmically. If X(K) ̸= ∅then
X is isomorphic to P1
K, so that X(K) = K ∪{∞} is Zariski dense in X.
ii) If X is of genus 1 then X(K) can be empty, ﬁnite or inﬁnite. Even over Q,
one does not know a provably correct algorithm allowing to distinguish
between these cases. However, there are algorithms that work in practice.
In [Man71] an algorithm was suggested to answer the ﬁnite/inﬁnite ques-
tion when it is known that X(K) is non-empty. If one assumes certain
general conjectures on elliptic curves (the Birch-Swinnerton-Dyer conjec-
ture and the Shimura-Taniyama-Weil conjecture, cf. the next section, and
[Man71]) then one can deduce the correctness of this algorithm. Moreover,
X(L) always becomes inﬁnite over an appropriate ﬁnite extension of K.

5.2 Geometric Notions in the Study of Diophantine equations
207
iii) If X is of genus > 1 then X(K) is always ﬁnite. This is the famous Mordell
conjecture, proved by G. Faltings. For more details see the following three
sections.
Note that this rather distinct arithmetic behaviour is well aligned with the
classiﬁcation of one-dimensional algebraic varieties recalled in Section 5.2.2.
One hopes that this property persists in higher dimensions as well. Bombieri,
for surfaces, and Lang-Vojta, in general, conjectured that rational points on
varieties of general type are always contained in proper subvarieties, i.e., they
are never Zariski dense. If true, this conjecture would have remarkable conse-
quences: non-uniqueness of the Brauer-Manin obstruction for general hyper-
surfaces [SarWa], uniform (in terms of K) upper bounds for the number of
rational points on curves of genus g ≥2 etc., cf. [CHM97].
One may ask for a converse to this conjecture. Note that some care is
necessary. First of all, one has to allow ﬁnite extensions of the ground ﬁeld
(already conics may have no rational points at all). Thus we ask for poten-
tial density, i.e., Zariski density after a ﬁnite extension of the ground ﬁeld.
Secondly, X may not be of general type while admitting an étale cover which
dominates a variety of general type. In this case, rational points on X cannot
be Zariski dense. In dimension two, rational points are potentially dense on
i) Del Pezzo surfaces;
ii) abelian, Enriques and K3 surfaces with an elliptic ﬁbration or an inﬁnite
automorphism group [BoTs99].
All Fano threefolds, except double covers of P3 ramiﬁed in a surface of degree
6, are known to satisfy potential density [HaTsch], [BoTs2000].
To get an idea how these results are proved, assume that there is a non-
trivial rational map f : C →X, where C is a curve of genus 0 or 1 with C(K)
inﬁnite. Then, of course, X(K) is also inﬁnite. Families of such embedded
curves can often be constructed by geometric methods.
Examples.
a) Every a ∈K∗can be represented in an inﬁnite number of ways as a sum
of three cubes in K. In fact, one representation is given by the identity
a =

1
32a2 + 34a + 36
3
((a3 −36)3 + (−a3 + 35a + 36)3 + (33a2 + 35a)3).
The geometric picture is as follows: For any non-singular cubic surface X
and any point x ∈X(K), denote by Cx the intersection of X with the
tangent plane to X at x. If x does not belong to a line in X then Cx is a
plane cubic curve with a double point at x. Hence it has genus zero and
a rational point (cf. Part I, §1.3). (This argument must be modiﬁed in
certain degenerate cases).

208
5 Arithmetic of algebraic varieties
b) Euler conjectured in 1769 that the equation
x4 + y4 + z4 = u4
(5.2.1)
has no non-trivial integral solutions. This conjecture was disproved by
N.D. Elkies (1988). He found a solution
26824404 + 153656394 + 187967604 = 206156734
and proved that there are in fact inﬁnitely many solutions by constructing
an elliptic curve lying on (5.2.1) with inﬁnitely many points. Potential
density of rational points on this quartic, and in fact on any smooth quartic
surface containing a line, has been proved in [HaTsch], [BoTs99]. Let us
sketch the geometry behind this result: let X be a quartic surface with
a line ℓand consider the one-parameter family of hyperplanes P2 ⊂P3
containing ℓ. For each P2 in this family, its intersection with X is a curve
of degree 4 containing ℓ. The residual curve to ℓis a plane curve of degree
3 intersecting ℓin three points. Thus X admits a ﬁbration over P1 with
generic ﬁber a curve of genus 1 and a rational trisection ℓ. Generically, this
implies that rational points on X are Zariski dense already over the ground
ﬁeld. In some degenerate situtions one has to pass to a ﬁnite extension to
insure Zariski density of rational points.
c) Of course, we can ﬁnd even more points on X if we manage to construct
maps Pn →X or A →X, where A is an Abelian variety with large
A(K) etc. Many geometric methods for such constructions are known.
For example, the diagonal quartic threefold
x4 + y4 + z4 + t4 + u4 = 0
is geometrically unirational, i.e., dominated by P3. It is unknown whether
or not every smooth quartic threefold is unirational.
d) Here is another general method of proving that X(K) is inﬁnite: if X
has an inﬁnite automorphism group G, an orbit Gx of a point x can be
inﬁnite. Examples of K3 surfaces with inﬁnite automorphism groups are
hypersurfaces of degree (2, 2, 2) in P1 × P1 × P1.
5.2.5 Number of points of bounded height
Let us start with a heuristic argument. Consider a system of equations
Fi(x0, . . . , xn) = 0,
i = 1, . . . , r,
(5.2.2)
where Fi is a form of degree di with integral coeﬃcients. Put
N(B) = Card {(x0, . . . , xn) ∈Zn+1 | H(x) := max(|xi|) ≤B}.
To guess the order of growth of N(B), we may argue as follows. First note
that there are about Bn+1 points in Zn+1 whose heights are ≤B. Secondly

5.2 Geometric Notions in the Study of Diophantine equations
209
Fi takes roughly Bdi values at these points. Assuming that the probability of
taking the zero value is about B−di, and that these events are independent
for diﬀerent i's, we get
N(B) ∼= Bn+1− di.
(5.2.3)
The power on the right hand side of (5.2.3) has a nice geometric interpreta-
tion: if the projective variety X deﬁned by (5.2.2) is a non-singular complete
intersection, then its anticanonical sheaf −KX is given by the following for-
mula:
−KX ∼= O(n + 1 −

di),
where O(1) is induced on X by OPn(1). Hence we can reformulate (5.2.3) in
a more general and a more cautious way, taking into account various counter-
examples to the over-optimistic formulation (5.2.1): we expect the order of
growth of N(B) to be Ba, a > 0 when −KX is ample and O(Bϵ) for any
ϵ > 0 when KX is ample, if one deletes from X some "point-accumulating"
subvarieties, and if one passes to a suﬃciently large ground ﬁeld.
These conjectures were stated in a precise form by V.V. Batyrev and Yu.I.
Manin. We shall add some comments without going into much detail.
a) To obtain a stable picture, allowing to involve geometric notions and con-
structions, we must pass to ﬁnite ﬁeld extensions.
b) We should consider counting problems with respect to arbitrary invertible
sheaves, not only −KX. The latter could fail to be ample, for example, it
could be zero.
The ﬁrst step in this program is the theory of heights, going back to an
old construction of A. Weil.
Let X be a projective algebraic variety over a number ﬁeld K and L an
invertible sheaf on X. Consider all completions Kv of K. Denote by |·|v : K →
R the local norm which is the scaling factor of an additive Haar measure with
respect to multiplication by elements of Kv. We have the classical product
formula 
v |x|v = 1 for all x ∈K×. If Λ is a one-dimensional vector space
over K, ∥· ∥v: Λ →R denotes a norm such that ∥aλ ∥v= |a|v ∥λ ∥v for all
a ∈K and λ ∈Λ. The invertible sheaf L can be considered as a family of
one-dimensional spaces parametrized by X, and one can deﬁne an admissible
metrization as a family of metrics ∥· ∥v for all v, on each ﬁber of L, with
natural continuity properties (cf. Lang S. (1983)). Given such a metrized sheaf
L = (L, ∥· ∥v), the height with respect to it is a function HL : X(K) →R
deﬁned by the following formula:
HL(x) :=

v
∥s(x) ∥−1
v ,
(5.2.4)
where s is a local section of L not vanishing at x. (Its choice is irrelevant due
to the product formula).

210
5 Arithmetic of algebraic varieties
For a list of properties of heights, we refer the reader to Lang S. (1983).
We mention only the following ones:
i)
Up to a function of the type exp(O(1)) HL does not depend on the choice
of metrization and is multiplicative in L. We shall therefore write HL
instead, if we are interested only in questions invariant with respect to
such choice.
ii) If L is ample and U ⊂X is a Zariski open subset then the number
NU(L; B) := Card {x ∈U(K) | HL(x) ≤B}
is ﬁnite for every B.
iii) We have
NPn(−KX; B) = cB(1 + o(1))
(5.2.5)
for all n > 0 and number ﬁelds K (this is Schanuel's theorem, Schanuel S.
(1979)).
A natural generalization of (5.2.5) is the following
Conjecture 5.8 (Linear Growth - ﬁrst version). Let X be smooth, with ample
−KX, and let r denote the rank of the Picard group of X. Then there exists a
suﬃciently small Zariski open subset such that for all suﬃciently large ground
ﬁelds one has
NU(−KX; B) = cB log(B)r−1(1 + o(1)).
(5.2.6)
Clearly, the conjecture cannot be true for varieties without rational points
or for cubic surfaces containing rational lines, since each such line would al-
ready contribute about B2 rational points to the asymptotic. These are the
obvious necessary conditions.
Thus, if X is a cubic surface such that all 27 lines on X are deﬁned over
the ground ﬁeld and U ⊂X is the complement to these lines then
NU(−KX; B) = cB log(B)6(1 + o(1)).
Lower bounds of this shape have been proved over Q in [SSw-D]. Non-trivial
upper bounds are unknown.
Now consider the variety X ⊂P3 × P3 given by the (1, 3)-form
3

j=0
xjy3
j = 0
over a ﬁeld K containing
3√
1. The projection to the x-coordinates exhibits X
as a ﬁbration over P3 with generic ﬁber a cubic surface. A Zariski dense set
of ﬁbers corresponds to cubic surfaces with all 27 lines deﬁned over K, each
contributing B log(B)6 to N(B). However, the rank of the Picard group of X

5.2 Geometric Notions in the Study of Diophantine equations
211
is 2 and Conjecture 5.8 predicts B log(B) points of −KX-height bounded by
B, leading to a contradiction [BaTsch98a]. A reﬁned approach to the Linear
Growth conjecture, taking into account such ﬁbration structures, is explained
in [BaTsch98b].
On the other hand, varieties closely related to linear algebraic groups do
satisfy Conjecture 5.8, see its reﬁnement by Peyre [Pey95] and its generaliza-
tion to arbitrary ample line bundles in [BatMan] and [BaTsch98b]. Precise
asymptotics, compatible with the above conjectures are known for:
- smooth complete intersections of small degree (for example, [Bir61]);
- split smooth Del Pezzo surface of degree 5 over Q [dlBre02];
- generalized ﬂag varieties [FMTsch]
- toric varieties [BaTsch98a];
- smooth equivariant compactiﬁcations of G/U - (horospherical varieties),
where G is a semi-simple group and U ⊂G a maximal unipotent subgroup
[StTsch];
- smooth equivariant compactiﬁcations of Gn
a [Ch-LT02];
- smooth bi-equivariant compactiﬁcations of unipotent groups [ShT04];
- wonderful compactiﬁcation of some semi-simple algebraic group of adjoint
type [ShT-BT04a], [ShT-BT04b].
Very little is known for general higher-dimensional varieties. Geometric
arguments, based on Mori's theorem that every point on a Fano variety X
lies on a rational curve of degree at most dim X + 1, imply that
NU(L; B) > cBβ(U,L)
for any dense Zariski open subset U ⊂X, suﬃciently large K, and some
positive constants c > 0, β(U, L) > 0. Batyrev and Manin state conjectures
about the best possible values of β(U, L) and relate them to Mori's theory.
Further developments are reﬂected in the book [PeyTsch01].
5.2.6 Height and Arakelov Geometry
S.Yu.Arakelov (cf. [Ara74a] and §III.2) had the brilliant idea of considering
Hermitian metrizations of various linear objects related to algebraic varieties
such as invertible sheaves, tangent bundles etc., in order to compactify arith-
metic schemes over number ﬁelds at the arithmetical inﬁnity. In particular,
each curve has a well deﬁned minimal model over O which is called an arith-
metical surface (since we added an arithmetical dimension to the geometric
one). Adding metrics at inﬁnity to this, Arakelov developed the intersection
theory of arithmetical divisors. Heights in this picture become the (exponen-
tiated) intersection index, see [Ara74b], [La88].
This theory was vastly generalized by H.Gillet and C.Soulé [GS91], [GS92],
[SABK94], following some suggestions in [Man84].
Figure 5.2 is a visualization of a minimal arithmetical surface (this notion
was deﬁned and studied by I.R.Shafarevich (cf. [Sha65], [Sha66]). Its ﬁbers

212
5 Arithmetic of algebraic varieties
over the closed points of Spec(O) can be non-singular ("non-degenerate", or
with "good reduction") or singular (having "bad reduction"). Rational points
of the generic ﬁber correspond to the horizontal arithmetical divisors; there
are also vertical divisors (components of closed ﬁbers) and "vertical divisors at
inﬁnity" added formally, together with an ad hoc deﬁnition of their intersection
indices with other divisors deﬁned via Green's functions, (see §III.2).
Fig. 5.2.
Arakelov's picture and the theory of heights played a prominent role in
Faltings' proof and the subsequent development of his work. We postpone
a more detail discussion of Arakelov geometry and its relation with Non-
Commutative geometry to Chapter 8.

5.3 Elliptic curves, Abelian Varieties, and Linear Groups
5.3.1 Algebraic Curves and Riemann Surfaces
An algebraic curve is a one-dimensional algebraic variety over a ﬁeld K. Usu-
ally we shall tacitly assume it to be irreducible. Every algebraic curve can be
obtained by deleting a ﬁnite number of points from a projective curve. For
every projective curve C, there exists a non-singular projective curve C′ and
a morphism C′ →C which is an isomorphism outside of singular points of C.
The curve C′ is called a (complete) non-singular model of its function ﬁeld.
It is uniquely deﬁned (upto isomorphism) by this function ﬁeld.
The genus g of a projective non-singular curve C (and its function ﬁeld)
can be deﬁned (or calculated) in many ways. Here are some of them:
i) It is the dimension of the space Γ(ω) of regular diﬀerential 1-forms on C
(the diﬀerentials of the ﬁrst kind).
ii) If K = C then g is the topological genus (the number of handles) of the
Riemann surface C(C) of complex points of C.
iii) Consider a projective embedding C ⊂Pn
K. In general one can take n ≥3
but not n = 2: our curve may have no non-singular plane model. However,
C always has a plane projection with only simple double points. Let d be
its degree and ν the (geometric) number of double points. Then
g = (d −1)(d −2)
2
−ν.
The basic theorem on algebraic curves is the Riemann-Roch theorem. To
state this theorem we require some deﬁnitions.
Let D be a divisor on C. It has a degree deg(D): a Cartier divisor on
a non-singular curve can be identiﬁed with a formal linear combination of
(geometric) points, and the degree is the sum of the coeﬃcients of this linear
combination.
Recall that each invertible sheaf L is isomorphic to a sheaf of the type
O(D) (cf. §5.1.13). Although D is not uniquely deﬁned by L, its degree is.
We may therefore deﬁne deg(L) = deg(D). In particular deg(ωC) = 2g −2,
where g is the genus of C. A divisor K = KC such that ω ∼= O(K) is called a
canonical divisor. A sheaf L is ample iﬀits degree is positive.
For a divisor D, put l(D) = dim Γ(O(D)). The Riemann - Roch theorem
for curves can be stated as follows:
l(D) −l(K −D) = deg(D) −g + 1.
(5.3.1)
5.3.2 Elliptic Curves
We shall call a non-singular projective curve X of genus one with a non-
empty set X(K) of K-points an elliptic curve. An elliptic curve has exactly

214
5 Arithmetic of algebraic varieties
one (upto constant factor) diﬀerential of the ﬁrst kind. The divisor of this is
zero. In other words ωX ∼= OX. From the Riemann-Roch theorem (5.3.1) it
follows that l(D) = deg(D) for deg(D) > 1. We can use this to show that i) X
is an algebraic group; ii) X is isomorphic to a plane cubic curve. To prove i)
choose a point o ∈X(K). For any two points x, y ∈X(K) let D = x + y −o.
Since deg(D) = 1 we have l(D) = 1. It follows that there exists a unique (upto
constant factor) function f whose divisor is x + y −o −z. Deﬁne x ∗y := z.
One can check directly that ∗is a commutative group law on X(K) (with
identity o). Actually, one can ameliorate this construction in order to deﬁne
the algebraic addition law which is a morphism ∗: X × X →X, verifying the
standard axioms.
To prove ii) choose a non-constant section f ∈L(2o). Then f has a pole of
order precisely two, since sections of L(o) are constants. Furthermore l(3o) =
3, so there is a section h ∈L(3o) with a pole of order three at o. From f and
h we can construct seven sections of L(6o): 1, f, f 2, f 3, h, fh, fh2, whereas
l(6o) = 6. Hence these seven sections are connected by a linear relation
a0 + a1f + a2f 2 + a3f 3 + b0h + b1fh + b2fh2 = 0.
(5.3.2)
Equation (5.3.2) deﬁnes a smooth aﬃne cubic curve. Its projective com-
pletion is a non-singular projective plane model Y of X. The identity point
o ∈X(K) corresponds to the inﬁnite point (0 : 1 : 0) of Y , and the group law
∗becomes the law described in Part I, §1.3.2 in terms of secants and tangents.
Making additional linear changes of variables we may reduce (5.3.2) to the
following (Weierstrass) normal forms over a ﬁeld K:
y2 + a1xy + a3y = x3 + a2x2 + a4x + a6,
where a1, a2, a3, a4, a6 ∈K and
∆= −b2
2b8 −8b3
4 −27b2
6 + 9b2b4b6 ̸= 0,
where
b2 = a2
1 + 4a2,
b4 = 2a4 + a1a3,
b6 = a2
3 + 4a6.
The notation j = c3
4
∆is used, where
c4 = b2
2 −24b4, c6 = −b3
2 + 36b2b4 −216b6.
Then this equation can be further simpliﬁed using the transformation x →
u2x′ + r, y →u3y′ + su2x′r + t in order to obtain the following (cf. [Ta73],
[Kob87] :
1) For p ̸= 2, 3:
y2 = x3 + a4x + a6 with ∆= −16(4a3
4 + 27a2
6) ̸= 0.
(5.3.3)

5.3 Elliptic curves, Abelian Varieties, and Linear Groups
215
2) For p = 2 we have the condition j = 0 is equivalent to a1 = 0, and
the equation transforms as follows: if a1 ̸= 0 (i.e. j ̸= 0), then choosing
suitably r, s, t we can achieve a1 = 1, a3 = 0, a4 = 0, and the equation
takes the form
y2 + xy = x3 + a2x2 + a6,
(5.3.4)
with the condition of smoothness given by ∆̸= 0. Suppose next that
a1 = 0 (i.e. j = 0), then the equation transforms to
y2 + a3y = x3 + a4x + a6,
(5.3.5)
and the condition of smoothness in this case is a3 ̸= 0.
3) For p = 3:
y2 = x3 + a2x2 + a4x + a6,
(5.3.6)
(here multiple roots are again disallowed).
The proper Weierstrass form (in the case (5.3.3)) is
y2 = 4x3 −g2x −g3.
(5.3.7)
The discriminant
∆= g3
2 −27g2
3
(5.3.8)
does not vanish. The coeﬃcients g2 and g3 are deﬁned upto the substitution
g2 →u4g2, g3 →u6g3 with u ∈K. The modular, or absolute invariant j of
our elliptic curve is deﬁned to be
j = 2633
g3
2
g3
2 −27g2
3
= 1728g3
2
∆.
(5.3.9)
Two elliptic curves have the same absolute invariant iﬀthey become isomor-
phic over an algebraic closure of the ground ﬁeld K. The classical Weierstrass
form (5.3.7) emerged in the theory of complex parametrizations of the complex
elliptic curves.
The Riemann surface E(C) of an elliptic curve E deﬁned over C, is a
complex torus, that is, a quotient C/Λ where Λ is a lattice
Λ = {z = n1 + n2τ|n1, n2 ∈Z, Im(τ) > 0}.
(5.3.10)
The connection between this analytic description of E and an algebraic one is
based on the identiﬁcation of rational functions on E with Λ-periodic mero-
morphic functions on C, i.e. elliptic functions.
Weierstrass considered the following basic functions:

216
5 Arithmetic of algebraic varieties
℘(z) = ℘(z, Λ) = 1
z2 +

ω∈Λ
′

1
(z −ω)2 −1
ω2

(5.3.11)
(prime denoting ω ̸= 0);
℘′(z) = ℘′(z, Λ) = −2

ω∈Λ
1
(z −ω)2 .
(5.3.12)
These series converge absolutely outside Λ and deﬁne elliptic functions. The
set of all elliptic functions with periods Λ forms a ﬁeld which is generated over
C by ℘(z) and ℘′(z). These two functions are related by the equation
℘′(z)2 = 4℘(z)3 −g2℘(z) −g3,
(5.3.13)
where
g2 = 60

ω∈Λ
′ 1
ω4 ,
g3 = 140

ω∈Λ
′ 1
ω6 .
(5.3.14)
Now if an elliptic curve Eτ ⊂P2
C is deﬁned by the equation (5.3.7) with g2
and g3 from (5.3.14), we can deﬁne a map
C/Λ
∼
→Eτ(C)
(5.3.15)
for which z →(℘(z) : ℘′(z) : 1) when z is not in Λ. The point 0 is mapped to
the inﬁnite point (0:1:0).
The map (5.3.15) is a complex analytic isomorphism. In order to deﬁne its
inverse, consider the diﬀerential of the ﬁrst kind
dx/y = dx/

4x3 −g2x −g3
(5.3.16)
on the Riemann surface Eτ(C). We integrate this form over a path joining a
ﬁxed initial point (say, o) with a variable point.
The integral depends on the choice of path, but its image in C/Λ is deter-
mined only by the endpoints.
According to a classical theorem due to Jacobi, the discriminant ∆= ∆(τ)
of Eτ can be expressed via Λ = Λτ as
∆= (2π)12q
∞

m=1
(1 −qm)24 = (2π)12
∞

n=0
τ(n)qn
(5.3.17)
for all τ ∈C with Im(τ) > 0, q = exp(2πiτ). The function τ(n) is called
Ramanujan's function. Its ﬁrst few values are
τ(1) = 1, τ(2) = −24, τ(3) = 252, τ(4) = −1472.
The absolute invariant of Eτ is by deﬁnition

5.3 Elliptic curves, Abelian Varieties, and Linear Groups
217
j(τ) = 1728g3(τ)3
∆(τ)
= q−1 + 744 +
∞

n=1
c(n)qn,
(5.3.18)
where c(1) = 196884, c(2) = 21493760, . . .. One can prove that j(τ) takes all
complex values, which shows that every elliptic curve over C is isomorphic to
Eτ for an appropriate τ.
Two curves Eτ, Eτ ′ are isomorphic iﬀτ ′ = aτ+b
cτ+d for some matrix

a
c
b
d

∈
SL(2, Z). In fact, a complex analytic isomorphism C/Λ
∼
→C/Λ′ is necessarily
induced by multiplication by some u ∈C×. Therefore, Λτ = uΛτ ′, so that
(u, uτ ′) is a basis of Λτ and u = cτ +d, uτ ′ = aτ +b. The linear transformation
is unimodular because (1, τ ′), (u, uτ ′) and (1, τ) all deﬁne the same orientation
of C. We therefore have
g2(τ ′) = u4g2(τ),
g3(τ ′) = u6g3(τ).
(5.3.19)
To sum up, isomorphism classes of elliptic curves over C correspond bijectively
to points of the quotient space H/Γ, where H is the upper half plane
H = {τ ∈C|Im(τ) > 0},
(5.3.20)
and the modular group
Γ = SL(2, Z)
(5.3.21)
acts on H by fractional linear transformations. The isomorphism C/Λτ
∼
→
Fig. 5.3.
Eτ(C) is also compatible with the natural group structures. In terms of elliptic
functions, this is reﬂected in the addition theorem for elliptic functions:
℘(z1 + z2) = −℘(z1) −℘(z2) + 1
4
℘′(z1) −℘′(z2)
℘(z1) −℘(z2)
2
.
(5.3.22)

218
5 Arithmetic of algebraic varieties
In terms of the coordinates (x, y) satisfying (5.3.7), we have
x3 = −x1 −x2 + 1
4
 y1 −y2
x1 −x2
2
,
where
P1 = (x1, w1),
P2 = (x2, w2),
P3 = P1 ∗P2 = (x3, w3).
Topologically, C/Λ is a surface of genus one. It can be obtained from the
parallelogram {u1 + u2τ | 0 ≤u1, u2 ≤1} by identifying the opposite sides
(cf. Fig. 5.3).
Points of ﬁnite order. Let E be an elliptic curve deﬁned over a ﬁeld K.
For an integer N denote by EN the kernel of the map which multiplies each
point by N:
NE : E(K) →E(K),
NE(t) = Nt.
(5.3.23)
If E is deﬁned over C then the isomorphism C/Λ ∼= E(C) shows that
EN ∼= Z/NZ × Z/NZ.
In fact EN corresponds to the subgroup
1
N Λ/Λ ⊂C/Λ. For example 2-torsion
points are represented by 0, 1/2, τ/2, (1 + τ)/2. It follows that (5.3.15) maps
1/2, τ/2, (1 + τ)/2 onto (xi, 0) for i = 1, 2, 3, where xi are the roots of the
polynomial 4x3 −g2x −g3. In other words,
℘′(1/2) = ℘′(τ/2) = ℘′((1 + τ)/2) = 0,
and
4x3 −g2x −g3 = 4(x −e1)(x −e2)(x −e3),
where
e1 = ℘′(1/2),
e2 = ℘′(τ/2),
e3 = ℘′((1 + τ)/2).
The 3-torsion points have a nice geometric interpretation: they are the
points of inﬂection of the projective Weierstrass model.
For any ground ﬁeld K, the morphism NE has degree N 2, and if (char K, N) =
1, we still have
E(K)N ∼= Z/NZ × Z/NZ.
(5.3.24)
However for char(K) = p and N = pm we have
E(K)N ∼= (Z/pmZ)γE,
(5.3.25)
where γE = 0 or 1, (cf. [La73/87], [La88]).
Assume that (char(K), N) = 1. The ﬁeld K(EN), generated by the co-
ordinates of all points of EN, is a Galois extension of K and the action of
Gal(K/K) on E(K)N ∼= Z/NZ × Z/NZ determines a representation

5.3 Elliptic curves, Abelian Varieties, and Linear Groups
219
ρN : Gal(K/K) →GL2(Z/NZ)
(5.3.26)
whose image is isomorphic to Gal(K(EN)/K). The ﬁeld K(EN) can be re-
garded as an analog of the cyclotomic ﬁeld K(ζN). However it is not in general
Abelian; only for the so called complex multiplication curves is the analogy
really far-reaching. This is a basic example of the kind of construction made
in Abelian and non-Abelian class ﬁeld theory.
It is known that the representation det(ρN) is the cyclotomic character of
GK = Gal(K/K); that is, it corresponds to the action of GK on the group
µN of N th roots of unity. Actually these roots are contained in K(EN), and
EN is endowed with a canonical non-degenerate alternating Weil pairing
eN : E(K)N × E(K)N →µN.
(5.3.27)
compatible with the action of GK. This is deﬁned purely algebraically, with the
help of the functions fP , P ∈E(K) such that div(f) = NP −No. Calculating
the pairing for an elliptic curve E over C, given by a period lattice Λ, we obtain
eN((a + bτ)/N, (c + dτ)/N) = exp(2πi(ad −bc)/N).
(5.3.28)
5.3.3 Tate Curve and Its Points of Finite Order
(see [Ta74], [He97], p.343). Let us write again the Weierstrass equation for
C/(2πi)Λ
∼
→C×/
2
qZ3
(u →exp(u))
in the following form
Y 2 = 4X3 −E4
12 X + E6
216 (X = ℘(2πiu, (2πi)Λ), X = ℘′(2πiu, (2πi)Λ)), ω = 2πi du,
using the Eisenstein series (see also in §6.3.2, (6.3.4)):
Gk(τ) =

m1,m2∈Z
′
(m1 + m2τ)−k
(5.3.29)
= 2(2πi)k
(k −1)!
!
−Bk
2k +
∞

n=1
σk−1(n) exp(2πinτ)
"
=
= 2(2πi)k
(k −1)! ·

−Bk
2k
 !
1 −2k
Bk
∞

n=1
σk−1(n) exp(2πinτ)
"
= −(2πi)kBk
k!
Ek,
where the prime denoting (m1, m2) ̸= (0, 0),
Ek(τ) = 1 −2k
Bk
∞

n=1
σk−1(n) exp(2πinτ),

220
5 Arithmetic of algebraic varieties
σk−1(n) = 
d|n dk−1 and Bk is the kth Bernoulli number. In particular we
have that
12(2πi)4g2(τ) = E4 = 1 + 240
∞

n=1
σ3(n)qn (q = exp(2πiτ),
−216(2πi)6g3(τ) = E6 = 1 −504
∞

n=1
σ5(n)qn.
Let us pass to the variables x, y via the substitution
X = x + 1
12, Y = x + 2y,
in order to obtain a new equation of this curve (with coeﬃcients in Z[[q]]):
Tate(q) : y2 + xy = x3 + B(q)x + C(q),
where
B(q) = −5
E4 −1
2
40

= −5
∞

n=1
σ3(n)qn = −5
∞

n=1
n3qn
1 −qn ,
(5.3.30)
C(q) =
−5
E4 −1
240

−7
E6 −1
−504

12
= −1
12
∞

n=1
(7n5 + 5n3)qn
1 −qn
.
This equation deﬁnes an elliptic curve over the ring Z((q)) with the canonical
diﬀerential ωcan given by
dx
2y + x = dX
Y .
⎧
⎪
⎨
⎪
⎩
g2 = 60G4 = (2πi)4 E4
12
g3 = 140G6 = −(2πi)6 E6
216.
Let N ≥1 be a natural number. Let us deﬁne
Tate(qN) : y2 + xy = x3 + B(qN)x + C(qN).
Next we put t = exp(2πiu), then the points of order N on Tate(qN) corre-
spond to t = ζi
Nqj, (0 ≤i, j ≤N−1), ζN = exp(2πi/N), and their coordonates
are given by
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩
x(t) =

n∈Z
qNnt
(1 −qNnt)2 −2
∞

n=1
nqNn
1 −qNnt
y(t) =

n∈Z
q2Nnt2
(1 −qNnt)3 +
∞

n=1
nqNn
1 −qNnt.

5.3 Elliptic curves, Abelian Varieties, and Linear Groups
221
It is important for arithmetical applications for the Tate curve that these
coordonates belong to the ring Z[ζN, N −1][[q]].
Proof uses the identity

n∈Z
(u + n)−k = (2πi)k
(k −1)!
∞

n=1
nk−1e2πinu (k ≥2,
u ∈Z).
We have for the lattice Λ = 2πi(Z + τZ) the following equalities
X = ℘(2πiu) =
(2πi)−2
⎛
⎝u−2 +

m,n∈Z
′ 
(u + mτ + n)−2 −(mτ + n)−2
⎞
⎠=
(5.3.31)
(2πi)−2

m∈Z

n∈Z
(u + mτ + n)−2 −2
∞

m=1

n∈Z
(mτ + n)−2 −2ζ(2)

=

m∈Z
∞

n=1
ne2πi(u+mτ)n −2
∞

m=1
∞

n=1
ne2πimnτ + 1
12,
implying the above identities.
5.3.4 The Mordell - Weil Theorem and Galois Cohomology
The fundamental arithmetical property of elliptic curves deﬁned over an al-
gebraic number ﬁeld K is the following result.
Theorem 5.9 (The Mordell-Weil Theorem). The Abelian group E(K)
is ﬁnitely generated, that is
E(K) ∼= E(K)tors ⊕ZrE,
(5.3.32)
where E(K)tors is a ﬁnite (torsion) group, and rE is an integer ≥0, called
the rank of E over K.
(cf. [Wei79], [La83], [Se97] and Appendix by Yu.Manin to [Mum74]).
This theorem is proved in two steps. One ﬁrst shows that E(K)/nE(K)
is ﬁnite (for some, or every n ≥2). Then one uses a descent argument based
on the following property of logarithmic heights h(P):
h(P) ≤const + n−2h(nP + P0)
for a ﬁxed P0, variable P and a constant independent of P.
The weak ﬁniteness theorem for E(K)/nE(K) can be established by a
kind of Kummer theory for K(En).

222
5 Arithmetic of algebraic varieties
Consider the extension K( 1
nE(K)) of K(En). One proves that this is a
ﬁnite Abelian extension whose order divides n. This can be deduced from
Hermite's theorem on the ﬁniteness of the number of extensions of a ﬁxed
number ﬁeld having prescribed degree and ramiﬁcation points. In order to
apply Hermite's result one must check that every ramiﬁed prime either divides
n or is a point of bad reduction of E.
Now consider the exact sequence
0 →En −→E(K)
n
−→E(K) →0.
(5.3.33)
This gives rise to an exact sequence of Galois cohomology groups
E(K)
n→E(K) →H1(GK, En) →H1(GK, E(K))
n→H1(GK, E(K))
which can be rewritten as
0 →E(K)/nE(K) →H1(GK, En) →H1(GK, E(K))n →0.
(5.3.34)
Although the group H1(GK, En) is inﬁnite, the image of E(K)/nE(K) is
contained in a ﬁnite subgroup, which we shall describe in geometric terms.
An element α ∈H1(GK, En) corresponds to an n-fold covering of E over
K, that is to a map a : C →E of algebraic curves, which becomes isomorphic
to n : E ⊗K →E ⊗K when the ground ﬁeld K is extended to K. Given
such a covering, one constructs a 1-cocycle by choosing a point P ∈E(K),
an inverse image Q = a−1P, and a point Q1 ∈E(K), which corresponds to
Q under a structure isomorphism C(K) ∼= E(K). Then one deﬁnes α as the
class of the cocycle:
σ →ασ = Q1 −Qσ
1 ∈En
(σ ∈GK)
(5.3.35)
(subtraction refers to the group law on E; we shall later on denote it by +
instead of ∗). Elements β ∈H1(GK, E(K)) are interpreted as isomorphism
classes of the principal homogeneous spaces X of E over K, that is, curves X
given together with group actions E × X →X which become isomorphic to
the addition morphism of E when the ground ﬁeld is extended to K. Given
such an X, choose a point P ∈E(K), a point P1 ∈X(K) corresponding to
P under a structure isomorphism, and deﬁne a cocycle
σ →βσ = P1 −P σ
1 ∈E(K)
(σ ∈GK).
(5.3.36)
A diﬀerent choice of P leads to a cohomological cocycle. The cohomology class
is trivial iﬀX has a rational K-point. This establishes a direct connection
between Galois cohomology and Diophantine geometry.
The exact sequence (5.3.34) can be conveniently described in this setting.
A point P ∈E(K) determines an n-covering
tP nE : E →E,
(5.3.37)

5.3 Elliptic curves, Abelian Varieties, and Linear Groups
223
where tP is the translation by P. Now choose a point Q ∈E(K) such that
nQ = P. Then tP n = ntQ, so that the translation tQ : E ⊗K →E ⊗K is
a K-isomorphism of algebraic curves, turning (5.3.37) into multiplication by
n. Therefore, our n-covering becomes trivial over K′ = K( 1
nE(K)). Hence its
class belongs to the ﬁnite subgroup
Mn = Inﬂ(H1(G(K′/K), En)) ⊂H1(GK, En),
whose order can be bounded in terms of the degree and ramiﬁcation of K′.
This ﬁnishes the proof of the weak Mordell-Weil theorem.
The descent argument proceeds as follows: choose a ﬁnite number of rep-
resentatives
P1, . . . , Ps
of E(K)/nE(K). There is a constant C such that if h(P) > C, then
h
 1
n(P −Pi)

< h(P),
where Pi is congruent to P modulo n. Hence P can be represented as a linear
combination of
P1, . . . , Ps
and points of height <C whose number is ﬁnite.
The exact sequence (5.3.34) can be used to obtain upper bounds for the
rank rE. In fact, if n = p is a prime and M is a ﬁnite subgroup of H1(GK, Ep)
containing the image of E(K)/pE(K) then (5.3.34) shows that
rE ≤rkZ/pZ(M) −rkZ/pZ(E(K)p).
(5.3.38)
Any improvement on this bound would require an understanding of the co-
kernel of the map
E(K)/pE(K) →M.
In order to choose a small, well-deﬁned M, it is convenient to apply the
usual local-to-global constructions. For each place v of K, choose an exten-
sion w of v to K and denote by Gv ⊂GK the corresponding decomposition
subgroup Gv ∼= G(Kw/Kv). Then for an arbitrary GK-module A we have
restriction homomorphisms Hi(GK, A) →Hi(Gv, A). In our setting, these ﬁt
into the commutative diagram
α
0 →E(K)/nE(K) →H1(GK, En) →
H1(GK, E(K))n
→0
⏐5
⏐5
β =

v
βv
⏐5
0 →

v
E(Kv)/nE(K)→

v
H1(Gv, En)→

v
H1(GK, E(Kw))n→0

224
5 Arithmetic of algebraic varieties
in which βv denotes the composition of the restriction morphism and the
morphism induced by the inclusion E(K) →E(Kw).
Let us consider the group
X(E, K) =
.
n∈N
X(E, K)n,
X(E, K)n = Ker(β).
(5.3.39)
This group is called the Shafarevich-Tate group of E over K; its interpre-
tation in terms of the Brauer group and connection with the Brauer-Manin
obstruction is explained in [Man70b]. In our setting, an element of X(E, K)
corresponds to a principal homogeneous space of E over K (up to isomor-
phism) which has a Kv-point in every completion of K.
The group
S(E, K)n = α−1(X(E, K)n)
(5.3.40)
(and the inductive limit of these groups over all n) is called the Selmer group of
E. An element of S(E, K)n can be interpreted as (the class of) an n-covering
C →E such that C has a Kv-point in each completion Kv of K. By deﬁnition
we have an exact sequence
0 →E(K)/nE(K) →S(E, K)n →X(E, K)n →0.
(5.3.41)
One can say that X(E, K) is a cohomological obstruction to a calculation
of E(K). There is a conjecture that X(E, K) is ﬁnite. This was proved by
K.Rubin in [Rub77] for certain curves with complex multiplication, and by
V.Kolyvagin (cf. [Koly88]) for a class of curves uniformized by modular curves.
More recently, these results were extended to a classe of curves without com-
plex multiplication by K.Kato, cf. [Scho98].
We shall return to this question in Chapter 6 in connection with zeta-
functions and modular functions.
We now consider in more detail the properties of the height function hD :
E(K) →R corresponding to a divisor D, or, equivalently, to the invertible
sheaf O(D) of degree d on an elliptic curve E. Since the degree of the map
nE is n2, one can check that
hD ◦nE ∼n2hD.
(5.3.42)
More precisely the following limit exists:
ˆhD(x) = lim
N→∞hD(2Nx)/22N.
(5.3.43)
This limit ˆhD is called the Néron-Tate height.
If the divisor D is ample (see 5.1.13) then ˆhD is a quadratic form on E(K),
which is positive deﬁnite modulo torsion. Moreover its natural extension

5.3 Elliptic curves, Abelian Varieties, and Linear Groups
225
ˆhD : E(K) ⊗Z R →R
is of the form db0, where d = deg(D) and b0 is a positive deﬁnite quadratic
form independent of D. The kernel of the natural map E(K) →E(K) ⊗Z
R is the ﬁnite torsion subgroup E(K)tors; its image is a lattice in the rE-
dimensional Euclidean space with the scalar product
⟨P, Q⟩= 1
2
6b0(P + Q) −b0(P) −b0(Q)[7
.
Therefore, the region ˆhD ≤log(B) in this space is a ball of radius
(d−1 log(B))1/2.
The number of points in this ball is asymptotically proportional to its volume,
that is const · (log(B))r/2. The constant in this expression depends on the
volume of a fundamental domain for the lattice E(K) mod torsion, that is, on
the regulator of E over K:
H = H(E, K) = det(⟨Pi, Pj⟩)1/2.
(5.3.44)
B.Mazur has proved that Card(E(Q)tors) is universally bounded (cf. [Maz77]).
This result was extended to all number ﬁelds by L. Merel, cf. [Mer96]. Actually
Mazur showed that E(Q)tors is always isomorphic to one of the following ﬁfteen
groups:
Z/mZ (m ≤10, m = 12),
Z/2Z × Z/2νZ (ν ≤4).
All these groups arise in this way.
It is conjectured that there are elliptic curves of arbitrarily large rank over
Q. J.-L. Mestre constructed curves of rank rE ≥14 ([Me82]), by choosing
equations in such a way that their reductions modulo many primes p have as
many points modulo p as possible. A concrete example of a calculation of the
group E(Q) is given in [Maz86]. Consider the curve
E : −206y2 = x3 −x2 + 1/4
and three points on it
Point
x
y
N´eron −Tate height
P1
−15/8
7/32
1.52009244
P1
−55/8
43/32
2.05430703
P3
−55/98 47/1372
2.42706090
A descent argument shows that rE ≤3, and a height computation allows
one to conclude that P1, P2, P3 are linearly independent generators of E(Q) ∼=
Z3; The absence of torsion can be checked by p-adic calculations.

226
5 Arithmetic of algebraic varieties
For a given elliptic curve, the numbers |E(Q)tors|, rE, H(E, K), |X(E, K)|
(conjecturally ﬁnite), and the conductor (a product of primes of bad reduction)
are the most important arithmetical invariants of E. Later we shall see that
all these invariants are combined (partly conjecturally) in the properties of its
zeta-function (see §6.4.4).
5.3.5 Abelian Varieties and Jacobians
(cf. [Mum74], [La58], [Wei48]). Abelian varieties are multi-dimensional gener-
alizations of elliptic curves. By deﬁnition, an Abelian variety A over a ﬁeld K
is a non-singular projective variety, together with a group structure given by
morphisms over K:
A × A →A ((x, y) →x + y),
A →A (x →−x).
One can prove that any such structure is commutative, which justiﬁes the
additive notation.
A homomorphism of Abelian varieties is a morphism λ : A →B of al-
gebraic varieties which is a group homomorphism. If dim(A) = dim(B), the
surjectivity of λ is equivalent to the condition that the kernel of λ is ﬁnite.
If these conditions are satisﬁed then λ is called an isogeny, and A and B are
said to be isogenous.
In particular, multiplication by an integer mA : A →A, mA(x) = mx, is
an isogeny of degree m2g, g = dim(A). If the characteristic of the ground ﬁeld
does not divide m, then
Am = A(K)m = Ker(mA) ∼= (Z/mZ)2g.
In particular the action of the Galois group on Am deﬁnes a Galois represen-
tation
ρm : GK →Aut(Am) ⊂GL2g(Z/mZ).
(5.3.45)
These representations are the best studied examples of the general Galois
actions on Grothendieck's étale cohomology groups. As in the case of elliptic
curves, there is a non-degenerate alternating Weil pairing
em : A(K)m × A(K)m →µm.
(5.3.46)
This is compatible with the action of the Galois group, so that
Im(ρm) ⊂GSpg(Z/mZ) ⊂GL2g(Z/mZ),
where GSpg is the group of symplectic matrices: for an arbitrary ring R,
GSpg(R) = {M ∈GL2g(R)|M tJgM = µ(M)Jg, µ(M) ∈R×},
(5.3.47)

5.3 Elliptic curves, Abelian Varieties, and Linear Groups
227
where Jg is a standard symplectic matrix. Actually, the construction of em
depends on the choice of a polarization on A (cf. below).
If A is an Abelian variety deﬁned over C, the complex variety A(C) is
isomorphic to a complex torus Cg/Λ, where Λ is a lattice in Cg. Not every
complex torus, however, can be obtained in this way. A necessary and suﬃcient
condition for this is the existence of an R-valued, R-bilinear form E(z, w) with
the following properties:
E(z, w) = −E(w, z).
(5.3.48)
E(z, w) ∈Z for all z, w ∈Λ.
(5.3.49)
E(z, iw) is an R −bilinear, symmetric, positive deﬁnite form.
(5.3.50)
Such a form E is called a Riemannian form on the complex torus Cg/Λ.
It also deﬁnes a Hermitean Riemannian form on Cg:
H(z, w) = E(iz, w) + iE(z, w).
(5.3.51)
If such a form E exists at all, it is not unique. We shall say that a choice of
E deﬁnes a polarization of A.
An Abelian variety together with a polarization is called a polarized
Abelian variety.
We recall the following classiﬁcation theorem for non-degenerate alternat-
ing integral forms on a lattice Λ ∼= Z2g: for each form, there exists a basis
{λ1, . . . , λ2g} of Λ such that
E(λi, λj) = E(λg+i, λg+j) = 0 for 1 ≤i, j ≤g,
E(λi, λg+j) = eiδij for 1 ≤i, j ≤g,
where e1, . . . , eg are natural numbers,
e1|e2, . . . , eg−1|eg.
Clearly,
detΛ(E) = (e1e2 . . . eg)2.
A polarization with determinant 1 is called a principal polarization.
There is a totally diﬀerent deﬁnition of polarization, which is purely al-
gebraic and is valid over any ground ﬁeld. Namely, consider an arbitrary
projective embedding A →PN. Call two embeddings equivalent if one can
be obtained from the other by a projective transformation composed with a
translation by a point of A. An equivalence class of projective embeddings
deﬁnes a linear system of hyperplane sections D of A. Over the complex
ground ﬁeld, this gives rise to an integral 2-cohomology class of A(C), which
in turn deﬁnes a Riemannian form E, in view of the known structure of the
cohomology ring of a torus. Elaborating this correspondence, one obtains the
following

228
5 Arithmetic of algebraic varieties
Deﬁnition 5.10. An (algebraic) polarization of an Abelian variety A is a
class of ample divisors {D} up to algebraic equivalence.
5.3.6 The Jacobian of an Algebraic Curve
([La58], [Wei48]). Let X be a non-singular projective curve over a ﬁeld K. One
deﬁnes in an invariant way an Abelian variety J = JX, which parametrizes
the invertible sheaves (or divisor classes) of degree zero on X. This Abelian
variety is called the Jacobian of X. For K = C, its structure is essentially
described by Abel's theorem. Consider a divisor
a =

niPi,

ni = 0.
We have a = ∂C where C is a 1-chain. Choose a basis of the diﬀerentials of
the ﬁrst kind
{ω1, . . . , ωg}
on X, where g is the genus of X. Consider the point

C
ω1, . . . ,

C
ωg

∈Cg.
Since one can replace C by a homologous 1-chain, this point is only well
deﬁned modulo the period lattice H1(X, Z) of our basis. Abel's theorem asserts
that the map sending α to the class of this point in the torus Cg/H1(X, Z),
identiﬁes this torus with the group JX(C) of all classes of divisors of degree
zero.
The classical Riemann periodicity relations imply that the lattice H1(X, Z)
is self-dual with respect to a canonical Hermitean metric. Hence

H1(X) ∼= Cg/H1(X, Z)
where

H1(X, Z) denotes the Pontryagin character group of H1(X, Z). This
shows that JX can be considered as an algebraic avatar of the 1-cohomology
of X.
Properties of Jacobians.
1) dim(JX) = g (the genus of X).
2) JX is an Abelian variety, and for every extension ﬁeld L of K, the group
JX(L) is canonically isomorphic to the group of divisor classes of degree
zero on X with ground ﬁeld extended to L.
3) Every morphism of curves of ﬁnite degree f : X →Y determines a
functorial homomorphism f ∗: JY →JX, corresponding to the inverse
image map on divisor classes.

5.3 Elliptic curves, Abelian Varieties, and Linear Groups
229
4) JX has a canonical principal polarization. This has an algebraic description
as the class of the Poincaré divisor θ. The Poincaré divisor can be deﬁned
as follows. Start with Abel's map
ϕ : X →JX,
(5.3.52)
which sends a point x ∈X(K) to the divisor class cl(x −P), where
P ∈X(K) is some ﬁxed point. Consider the map
ψ : Xg
ϕg
−→Jg
X
µ
−→JX,
where µ is the addition map. From the Riemann-Roch theorem it follows
that ψ is surjective. Put θ = ψ(Xg−1).
Many geometric and arithmetical properties of a curve X can be read
oﬀfrom the properties of its Jacobian. In particular, the classical theorem
of Torelli (cf. [Wei57]) states that X can be uniquely reconstructed from JX
together with its canonical principal polarization. Essentially this theorem
was used in Faltings' theory and in earlier constructions due to A.N.Parshin
and Yu.I.Zarkhin (cf. [Zar74], [Zar85], [Par71], [Par73], [PZ88]).
If X is deﬁned over K, the Jacobian and its principal polarization are both
deﬁned over K. If X has a K-point P, the map (5.3.52) is also deﬁned over
K.
One can also prove that if X is an algebraic curve over an algebraic num-
ber ﬁeld K having good reduction modulo a prime p ⊂OK, then JX with
its canonical projective embedding (given by the divisor θ) also has good
reduction.
Every Abelian variety A over a number ﬁeld (or absolutely ﬁnitely gener-
ated ﬁeld) K satisﬁes the Mordell - Weil theorem: A(K) is a ﬁnitely generated
commutative group, that is
A(K) ∼= A(K)tors ⊕ZrA,
where A(K)tors is ﬁnite and rA is the rank of A over K (cf. [La83], [Se97] and
Appendix by Yu.Manin to [Mum74]).
As with elliptic curves, one can deﬁne the Selmer groups S(A, K)m and
the Shafarevich - Tate groups X(A, K). A standard conjecture is that the
latter are all ﬁnite.
Every divisor D on A determines a Néron - Tate height
ˆhD : A(K) ⊗R →R,
and if D (that is, O(D)) is ample, then ˆhD induces a Euclidean metric on the
rA-dimensional vector space A(K) ⊗R.
A very important role in the theory of Abelian varieties is played by
the endomorphism ring End(A) of A (over K) together with the Q-algebra
End(A) ⊗Q. It is known that this algebra is semi-simple.

230
5 Arithmetic of algebraic varieties
The Abelian variety A is called simple if End(A)⊗Q is simple. A decompo-
sition of End(A)⊗Q as a sum of simple algebras R1 ⊕· · ·⊕Rs corresponds to
a decomposition of A into a product of simple Abelian varieties up to isogeny:
there exists an Abelian variety
B = B1 × · · · × Bs
isogenous to A such that End(Bi) ⊗Q ∼= Ri ([La58]).
Let E be a Riemannian form corresponding to a polarization of an Abelian
variety A over C. Such a form determines a Rosatti involution ρ on
End(A) ⊗Q (that is, an anti-isomorphism of order 1 or 2) which veriﬁes the
relation E(λx, y) = E(x, λρy) for every λ ∈End(A) ⊗Q. Involutions of this
kind can also be deﬁned over a ground ﬁeld of ﬁnite characteristic.
Semi-simple algebras with involutions have been classiﬁed, cf. [Mum74],
[Shi71].
If K is a number ﬁeld, g = 1, then either End(A) ⊗Q = Q or End(A) ⊗Q
is an imaginary quadratic ﬁeld k. In the latter case A is called an elliptic curve
with complex multiplication. It can be represented as a complex torus C/Λτ
(see (5.3.15)) with τ ∈k, Im(τ) > 0.
We now sketch an analytic construction of the space Ag of isomorphism
classes of Abelian varieties over C with principal polarizations. The crucial
observation is that each such variety can be represented as a complex torus
Cg/Λτ, where
Λ = Λτ = {n1 + n2τ | n1, n2 ∈Zg, τ ∈Hg}
(5.3.53)
and Hg is the Siegel upper half space
Hg = {τ ∈GLg(C) | Im(τ) is positive deﬁnite}.
In fact, let A be an Abelian variety with a principal polarization, given as
a torus Cg/Λ, and a Riemannian form E on Λ with determinant 1. Choose
a symplectic basis {ω1, ω2, · · · , ω2g} of Λ. Representing ωi by its column of
coordinates, we can construct a (g × 2g)-matrix
Ω= (ω1, ω2, · · · , ω2g)
which is called a period matrix of A. Put Ω= (Ω1, Ω2) where Ωi ∈Mg(C).
From (5.3.48) and (5.3.50) it follows that
Ω2Ωt
1 −Ω1Ωt
2 = 0,
(5.3.54)
2i(Ω2Ω
t
1 −Ω1Ω
t
2) > 0 is positive deﬁnite.
Thus Ω1, Ω2 ∈GLg(C) and τ = Ω−1
2 Ω1 ∈Hg. From this one deduces that
the complex variety A(C) is isomorphic to the torus Cg/Λτ, and the initial
polarization corresponds to one given by the form

5.3 Elliptic curves, Abelian Varieties, and Linear Groups
231
E(x1 + τy1, x2 + τy2) = xt
1y2 −xt
2y1,
where xi, yi ∈Rg.
The varieties Cg/Λτ and Cg/Λτ ′ are isomorphic iﬀ
τ ′ = (Aτ + B)(Cτ + D)−1
for a certain matrix M =

A
C
B
D

from the group
Spg(Z) =
8
M =
A
C
B
D

∈SL2g(Z) | M tJgM = Mg
9
.
(5.3.55)
This group is called the Siegel modular group of genus g.
Summing up, we see that Ag can be described as the quotient space
Hg/Spg(Z) where M acts on Hg by matrix fractional linear transformations.
One can show that Ag is a complex analytic space of dimension g(g +1)/2
with a natural structure as a normal quasi-projective variety deﬁned over Q.
A generic Abelian variety over C is simple, and its endomorphism ring is Z.
There are important variations of this construction. One can consider fam-
ilies of pairs A, E in which End(A) and E verify some additional constraints,
and one can supply such pairs with so called level structures, for example a
choice of symplectic basis for the subgroup Am of points of order m. In many
situations there exist universal PEL-families (Polarization, Endomorphisms,
Level), whose bases are very important algebraic varieties (Shimura Varieties)
deﬁned over number ﬁelds. The action of the Galois group on the Algebraic
points of these varieties can be described in considerable detail.
5.3.7 Siegel's Formula and Tamagawa Measure
Algebraic groups comprise not only of Abelian varieties but also of linear
groups. The latter are aﬃne varieties, whereas Abelian varieties are projec-
tive. The arithmetic of linear groups is a well-developed chapter of algebraic
geometry. For an extensive report on its qualitative aspects we refer the reader
to the papers of [Pl82], and [PlRa83]. We shall describe here only classical re-
sults due to C.-L. Siegel, which were generalized and reinterpreted by Weil.
These results give a quantitative form to the Minkowski-Hasse principle for
quadratic forms, and lead to certain precise formulae of the kind furnished by
the circle method for the principal terms of some arithmetical functions.
Siegel's formulae concern the equations
S[X] = T
(S[X] = XtSX)
(5.3.56)
where S ∈Mm(Q) and T ∈Mn(Q) are the symmetric matrix forms of Q-
rational quadratic forms qS and qT , the solutions X being in Mm,n(Q).
Let us consider in more detail the case when S and T are the matrices of
integral positive deﬁnite quadratic forms corresponding to the lattices ΛS ⊂

232
5 Arithmetic of algebraic varieties
Rm, ΛT ⊂Rn (in the sense that qS and qT express the lengths of elements of
ΛS, resp. ΛT ). Then an integral solution X to (5.3.56) determines an isometric
embedding ΛS →ΛT . Denote by N(S, T) the total number of such maps,
which is also called the number of integral representations of qT by qS. The
genus of qS is by deﬁnition the set of quadratic forms, rationally equivalent
to qS. The genus consists of a ﬁnite number of classes with respect to integral
equivalence. Let I be the set of these classes. One of Siegel's formulae gives
the value of a certain weighted average of the numbers N(Sx, T) over a set
of representatives Sx for classes x ∈I of forms of a given genus. To be more
precise, denote by w(x) the order of the group of orthogonal transformations
of the lattice ΛSx and deﬁne the mass of S by the formula
Mass(S) =

x∈I
1
w(x).
(5.3.57)
Assume that N(Sx, T) ̸= 0 for at least one x (or, equivalently, that there is an
isometric embedding ΛS ⊗Q →ΛT ⊗Q) and put
˜N(S, T) =
1
Mass(S)

x∈I
N(Sx, T)
w(x)
.
Siegel's formula expresses this average as a product of local factors
˜N(S, T) = cm−nc−1
m α∞(S, T)

p
αp(S, T),
(5.3.58)
where c1 = 1/2, ca = 1 for a > 1, and the proper local factors are deﬁned as
follows. For a prime p denote by N(S, T; pr) the number of solutions of the
congruence
S[X] ≡T (mod pr)
(X ∈Mm,n(Z/prZ))
(5.3.59)
and introduce the local density
αp(S, T) = lim
r→∞cm−n+1N(S, T; pr)prd,
d = mn −n(n + 1)/2
(5.3.60)
(the expression inside the limit actually stabilizes when r is suﬃciently
large). One can deﬁne α∞(S, T) similarly, replacing the p-adic measure by
an Archimedean measure. Consider a neighbourhood V of a matrix S in the
space of symmetric matrices {T = (ti,j) ∈Mm(R) | T t = T} with the measure
given by the volume form αT = ∧i≤jdti,j. Put
U = {X = (xi,j) ∈Mm,n(R) | XtSX ∈V }.
It is a subset of Mm,n(R) with a measure β = ∧i,jdxi,j (i = 1, . . . , m; j =
1, . . . , n). Finally put

5.3 Elliptic curves, Abelian Varieties, and Linear Groups
233
α∞(S, T) = cm−n+1 lim
V →S

U βX

V αT
.
(5.3.61)
The product in (5.3.58) converges absolutely if m ≥3 and m −n ̸= 2.
In the special case T = S we have
˜N(S, T) =
1
Mass(S)
and (5.3.58) becomes the Minkowski-Siegel formula ([Se86], p. 671)
Mass(S) = cmα∞(S, S)−1 
p
αp(S, S)−1.
(5.3.62)
If n = 1, T = (t) then N(S, T) is the number of integral representations of
a positive integer t by the quadratic form qS.
Note that for almost all primes p (i.e. for all but a ﬁnite number) each
solution to the congruence (5.3.59) can be lifted to a solution of the corre-
sponding congruence modulo any pr (using Hensel's lemma). In this case we
have
αp(S, T) = Np(S, T; p)
pd
,
(5.3.63)
which makes it possible to describe explicitly almost all the local factors in
(5.3.58) and to express this product in terms of special values of certain zeta-
functions (for example, values of the Riemann zeta-function at integers).
Consider for example the quadratic form qS = m
i=1 x2
i given by the iden-
tity matrix S = Im. If m is divisible by 4, then (5.3.62) takes the following
form ([Se86], p.673):
Mass(Im) = (1 −2−k)(1 + ε21−k) | B2B4 · · · B2k|/4k!,
where k = m/2, ε = (−1)m/2 and Bi is the ith Bernoulli number. For m not
divisible by 4 there are exactly two classes in the genus of the form I9, and
Mass(I9) = 17/2786918400.
We now say a few words on how Siegel's formula is proved. The proof
uses the theory of integration over the locally compact group G = Om(A) of
orthogonal matrices with respect to S with coeﬃcients in the ring of adeles
A. The group G∞= Om(R) is compact in view of the positive deﬁniteness of
S. Thus G contains the compact open subgroup Ω= G∞× 
p G(Sp), where
G(Sp) = O(Zp) is the orthogonal group of the p-adic lattice ΛS,p = ΛS ⊗Zp
(preserving the quadratic form qS). The subgroup Γ = Om(Q) of orthogonal
matrices with rational coeﬃcients is discrete in G and Γ ∩Ω= Aut ΛS is
the ﬁnite group of automorphisms of the lattice ΛS. For every x = (xv)v ∈G
with (v = p or v = ∞) one can deﬁne a lattice ΛSx such that ΛSx ⊗Qv =
xv(ΛS ⊗Qv). According to a version of the Hasse-Minkowski theorem, there

234
5 Arithmetic of algebraic varieties
is an isomorphism ΛSx ⊗Q = ΛS ⊗Q and the double cosets ΩxΓ of G modulo
Ωand Γ can be interpreted as Z-classes of forms Sx (x ∈I). The ﬁnite group
γx = Ω∩xΓx−1 of order w(x) is the group of automorphisms of the lattice
ΛSx. Below a normalized Haar measure τ on the group G will be constructed.
This measure is invariant under both right and left group shifts, and has the
property that the volume vol(G/Γ) of the compact set G/Γ = ∪x∈IΩxΓ/Γ
is uniquely deﬁned (not only up to a multiplicative constant). This measure
is called the Tamagawa measure on G. The following formula holds
vol(G/Γ) =

x∈I
vol(Ω/γx) = vol(Ω)

x∈I
1
w(x).
(5.3.64)
Let g, γ be closed subgroups of G and suppose that the volume vol(g/γ)
is ﬁnite. Consider a continuous function ϕ with compact support on G/g,
invariant under left shifts of the argument by elements of Ω. For x ∈G put
Nx(ϕ) =

y∈Γ/γ
ϕ(xy).
This sum is ﬁnite and depends only on the double coset ΩxΓ. Consider the
weighted average ˜N(ϕ) of the quantities N(ϕ) as x runs through I,
˜N(ϕ) =

x∈I Nx(ϕ)/w(x)

x∈I 1/w(x)
.
(5.3.65)
Standard integration techniques then show that
˜N(ϕ) = vol(g/γ)
vol(G/Γ)

G/g
ϕ(x) dx
(5.3.66)
assuming that the measures on the groups G and g and the homogeneous
space G/g are compatible.
Siegel's formula can be deduced from equation (5.3.66) by taking for g
the orthogonal adelic group with respect to the quadratic module W over Q
deﬁned by the condition W ⊕(ΛT ⊗Q) ∼= ΛS ⊗Q. For the group γ we take
the group of rational points in g, and the homogeneous space G/g is identiﬁed
with the set of embeddings ΛT ⊗A →ΛS ⊗A preserving the quadratic forms.
For ϕ one takes the characteristic function of the set of those embeddings
ΛT ⊗A →ΛS ⊗A which take ΛT ⊗Zp into ΛS ⊗Zp. The quantities cm−n
and cm become the Tamagawa numbers τ(Om−n) and τ(Om) respectively.
For x = (xv)v ∈G the function ϕ(x) = ϕ(gx) has the form 
v ϕv(xv), where
ϕ∞= 1 on G∞and ϕv(xv) is the characteristic function of Om(Zv). The
integral in (5.3.66) is therefore equal to the product

G∞/g∞
dx∞·

p

Gp/gp
dxp,

5.3 Elliptic curves, Abelian Varieties, and Linear Groups
235
where Gp = Om(Zp), gp = Om−n(Zp), and one easily veriﬁes that
α∞(S, T) =

G∞/g∞
dx∞,
αp(S, T) =

Gp/gp
dxp.
(5.3.67)
Then the evaluation of
τ(Om) = vol(G/Γ)
can also be made using (5.3.66) putting n = 1 and applying some known
asymptotic results for the representation numbers N(S, T) as t →∞. The
latter are obtained for example by the circle method (the cases m = 2, 3 must
be treated separately).
Now we describe the Tamagawa measure on G; formulae (5.3.67) follow
from this description (cf. [CF67], chap. X).
Let V be an algebraic variety over a number ﬁeld K, which is a connected
linear algebraic group. If dim V = n then there is a non-vanishing, left invari-
ant n-form ω on V deﬁned over K. Any two of these diﬀer by a multiplicative
constant λ ∈K×. We now construct a measure on the group V (AK) of adelic
points of the variety V . For this purpose one must ﬁrst ﬁx a Haar measure µv
on the additive group K+
v , where v is a normalized valuation on K. In order
to do this we set µv(Ov) = 1 if v is non-Archimedean, dµv = dx for Kv ∼= R
(Lebesgue measure) and dµv = |dz ∧dz| for z = x + iy ∈Kv ∼= C. Then
according to (4.3.46) one has µ(AK/K) = |DK|1/2, where DK is the discrim-
inant of K and µ is the Haar measure on AK deﬁned as the product of local
measures µv. Deﬁne a measure ωv on V (AK) as follows. In a neighbourhood
of a point P of V the form ω is deﬁned by the expression
ω = f(x) dx1 ∧· · · ∧dxn,
where x1, . . . , xn are local parameters at P which are certain rational func-
tions xi ∈K(V ) and f ∈K(V ) is a rational function regular at P. The
function f can be written as a formal power series in the xis with coeﬃcients
in K, because the variety of an algebraic group is always non-singular. If
the coordinates of P belong to Kv then f is a power series in the variables
xi −x0
i with coeﬃcients in Kv, which converges in a neighbourhood of the
origin in Kn
v . Thus there exists a neighbourhood U of P in V (Kv) such that
ϕ : x →(t1(x), . . . , tn(x)) is a homeomorphism of U onto a neighbourhood
U ′ of the origin in Kn
v , and the power series converges in U ′. In U ′ we have
the positive measure |f(x)|v dt1 · . . . · dtn where dt1 · . . . · dtn is the product
µv × · · · × µv on Kn
v ; we lift it to U using ϕ and thus obtain a positive mea-
sure ωv on U. Explicitly, if g is a continuous real valued function on V (Kv)
supported on U then

U
g ωv =

U ′ g(ϕ−1(t)) dt1 · . . . · dtn,
so that ωv is in fact dependent on a choice of local parameters. If the product

236
5 Arithmetic of algebraic varieties

v
ωv(V (Ov))
(5.3.68)
converges absolutely, then we deﬁne the Tamagawa measure by the formula
τ = |DK|−n/2 
v
ωv.
(5.3.69)
If the product (5.3.68) does not converge absolutely then one needs to intro-
duce certain correcting factors λv > 0, which ensure the convergence in such
a way that the product

v̸ |∞
λ−1
v ωv(V (Ov))
will converge absolutely. The Tamagawa measure (with respect to {λv}) is
then deﬁned by the formula
τ = |DK|−n/2 
v̸ |∞
λ−1
v ωv.
(5.3.70)
In any case, it follows from the product formula that τ is independent of the
choice of ω: if we replace ω by cω (c ∈K×) then (cω)v = |c|n
vωv and by the
product formula (4.3.31) one has 
v |c|v = 1.
Let k(v) denote the residue ﬁeld with respect to a non-Archimedean place
v and let V (v) = V ⊗k(v) be the reduction of V modulo the corresponding
prime ideal pv ⊂Ov. Then one can show, generalizing Hensel's lemma, that
for almost all v
ωv(V (Ov)) = Nv−n Card V (v)(k(v)),
(5.3.71)
where Nv denotes the number of elements of k(v) and V (v)(k(v)) is the group
of points of V (v) with coeﬃcients in k(v).
Examples. If V = Γa (the additive group) then
ωv(V (Ov)) = µv(Ov) = 1;
if V = Γm (the multiplicative group) then
ωv(V (Ov)) = Nv −1
Nv
= 1 −1
Nv ;
if V = GLm then
ωv(V (Ov)) =

1 −1
Nv

· · ·

1 −
1
Nvm

;
if V = SLm then
ωv(V (Ov)) =

1 −
1
Nv2

· · ·

1 −
1
Nvm

.

5.3 Elliptic curves, Abelian Varieties, and Linear Groups
237
The product

v∤∞

1 −
1
Nv−s

= ζK(s)−1
converges for Re(s) > 1 but diverges at s = 1 (here ζK(s) denotes the
Dedekind zeta function of K). The product 
v ωv(V (Ov)) therefore converges
for V = SLm but diverges for V = GLm. In the latter case one could take
for the correcting factors the numbers λv = 1 −
1
Nv. More generally one can
show that if V = G is a semi-simple algebraic group then the product (5.3.68)
converges absolutely and the correcting factors are not needed. The link be-
tween Tamagawa numbers and Siegel's research in the arithmetical theory of
quadratic forms was discovered by Weil in the late 50s. He formulated during
this time a conjecture later proved by Kottwitz, saying that for a connected,
simply connected, semi-simple algebraic group over a number ﬁeld K, which
contains no factors of type E8, one has τ(V ) = 1. For a connected, reductive
group G over K it was proved by Sansuc and Kottwitz that
τ(G) = |Pic(G)|
|X(G)| ,
where X(G) is the Shafarevich-Tate group and Pic(G) is the Picard group
of the aﬃne variety (linear algebraic group) G, cf. [Kott88].
Eskin, Rudnick, Sarnak in [ERS91] gave a new proof of Siegel's famous
mass formula; they used harmonic analysis to obtain an asymptotic formula for
the distribution of integral points on certain aﬃne varieties. In particular, they
gave a new proof of Siegel's theorem for indeﬁnite quadrics (n = 1, m ≥4).
From this it was deduced that the Tamagawa number of any special orthogonal
group is 2, which yields the general Siegel result through a computation of
adelic volumes with respect to the Tamagawa measure. Note that E. Peyre
studued in [Pey95] heights and Tamagawa measures on Fano varieties.

5.4 Diophantine Equations and Galois Representations
5.4.1 The Tate Module of an Elliptic Curve
Let E be an elliptic curve deﬁned over a number ﬁeld K. Then the Galois
group GK = G(K/K) acts on the group En of all points of order dividing n,
En ∼= (Z/nZ)2 so we obtain a Galois representation
ϕn : GK →GL2(Z/nZ) = Aut En.
Now let l be a prime number, n = lm. Set
Tl(E) = lim
←−
m
Elm ∼= Z2
l ,
(5.4.1)
Vl(E) = Tl(E) ⊗Ql ∼= Q2
l ,
where Zl is the ring of l-adic integers and the limit is taken over the set of
homomorphisms Elm →Elm−1 which multiply each point by l. The corre-
sponding homomorphism
ρl : GK →Aut Vl(E) ∼= GL2(Ql)
(5.4.2)
is a continuous representation of the group GK over the ﬁeld Ql. Its image
Im ρl = Gl is a closed subgroup of GL2(Zl) ∼= Aut Tl(E), and the Weil pairing
(5.3.37) determines an isomorphism of detρl with the representation of GK
on the one dimensional vector space
Vl(µ) = Tl(µ) ⊗Ql,
Tl(µ) = lim
←−
m
µlm
(the Tate module deﬁned as the projective limit of roots of unity of l-power
degree).
It follows from recent results of Faltings that the GK-module Tl(E)
uniquely determines the curve E upto an isogeny.
Serre discovered (cf. [Se68a]) that the image Im ρl is as large as it could
possibly be for almost all primes l. More precisely this image coincides with
GL2(Zl) ∼= Aut Tl(E), provided that the curve E is not special in the sense
that it admits no complex multiplication, or equivalently Aut(E) = Z. More-
over the index of the subgroup ϕn(GK) in GL2(Z/nZ) = Aut En is bounded
by a constant which is independent of n, of the curve E and of the ﬁeld K (cf.
[Ner76], [Silv86]). The occurrence of small images Im ρl is closely related to
the existence of K-rational points of ﬁnite order (or of K-rational subgroups
of such points). For example, if there exists a basis P, Q of the group En over
Z/nZ such that the point P is K-rational, i.e. P ∈En(K), then P σ = P for
all σ ∈GK. Elements in the image ϕn(GK) are therefore represented by ma-
trices of the form
 1
0
∗
∗

in GL2(Z/nZ). If the subgroup ⟨Q⟩is also K-rational,
i.e. ⟨Q⟩σ = ⟨Q⟩then elements in the image have the form
 1
0
0
∗

. The result

5.4 Diophantine Equations and Galois Representations
239
of Serre is therefore closely related with Mazur's theorem on the universal
boundedness of the torsion subgroup of an elliptic curve over Q (cf. [Maz77]).
Let A be an Abelian variety of dimension g deﬁned over K. Then the Tate
module is deﬁned by
Tl(A) = lim
←−
m
Ker(A
lm
→A) ∼= Z2g
l ,
Vl(A) = Tl(A) ⊗Ql ∼= Q2g
l ,
and we again have a Galois representation (see (5.3.52))
ρl : GK →Aut Vl(A) ∼= GSp2g(Ql).
(5.4.3)
Note that certain results are known on the maximality of the image of
the Galois representation ρl for higher dimensional Abelian varieties A with
End A = Z (i.e. without complex multiplication).
The study of the image of ρl is based on an examination of the reduction of
the elliptic curve (or Abelian variety) modulo pv, where v is a ﬁnite place of K.
The condition that E has good reduction ˜Ev = E mod pv is equivalent to the
existence of an Abelian scheme Ev over Spec Ov in the sense of Mumford (cf.
[Mum74]) whose generic ﬁber coincides with E (i.e. Ev ⊗Ov Kv ∼= E⊗KKv)
and whose closed ﬁber is an elliptic curve (Abelian variety) ˜Ev = Ev ⊗Ov k(v)
over the residue ﬁeld k(v) = O/pv. The (geometric) Frobenius endomorphism
Fv of ˜Ev is deﬁned by raising the coordinates of points on ˜Ev to their Nv =
|k(v)|th powers.
Now let pv denote the characteristic of the residue ﬁeld k(v) and let l be
another prime number (not pv). Denote by Gv (respectively Iv) the decom-
position group (respectively, the inertia group) of some extension v of v to
a ﬁxed algebraic closure K of K (compare with (4.4.2)). If E has good re-
duction at v then v deﬁnes (in view of Hensel's lemma) an isomorphism from
Elm to the corresponding subgroup of the curve ˜Ev. In particular, the inertia
group Iv acts trivially on Elm, Tl(E) and Vl(E), so the action ρl(Frv) of the
arithmetical Frobenius automorphism Frv is well-deﬁned (Frv ∈Gv/Iv) and
is the same as the action of the geometric Frobenius Fv = FE,v. One therefore
has
detρl(Frv) = det(Fv) = Nv = Card k(v),
(5.4.4)
and the quantity
det(12 −ρl(Frv)) = det(1 −Fv) = 1 −Tr Fv + Nv
(5.4.5)
is equal to the number Card ˜Ev(k(v)) of k(v)-points of the reduction ˜Ev.
Conversely, one has the following
Theorem 5.11 (Criterion of Neron - Ogg - Shafarevich). If the Galois
representation ρl is unramiﬁed at v for some l ̸= pv then E has good reduction
at v.
(cf. [Silv86], Ch. 4 of [Se68a]).

240
5 Arithmetic of algebraic varieties
5.4.2 The Theory of Complex Multiplication
(see Chapter XIII of [CF67], [La73/87], [Shi71]). One of the central aims of
algebraic number theory was formulated in 1900 by Hilbert in Paris as his
twelfth problem: that of ﬁnding an explicit construction of all Abelian exten-
sions of a given number ﬁeld K. For K = Q it is known (by the Kronecker-
Weber theorem (comp. with §4.1.2)) that the maximal Abelian extension Qab
of Q is cyclotomic, and that there is an isomorphism
G(Qab/Q) ∼=

p
Z×
p .
If K is an imaginary quadratic extension of Q then the theory of complex
multiplication makes it possible to construct Kab using elliptic curves E with
complex multiplication by K, and their points of ﬁnite order. By deﬁnition,
one has for such curves End E ⊗Q = K. If E(C) ∼= C/Γ for a lattice Γ ⊂C,
then the endomorphism ring of E has the following form
End E = {z ∈C|zΓ ⊂Γ} = Of = Z + fOK ⊂OK,
where OK is the maximal order of K and f is an appropriate positive integer
(in view of the fact that every subring of OK has the form Z + fOK for some
f).
Theorem 5.12. There is a one-to-one correspondence between elliptic curves
E with a given endomorphism ring Of (upto isomorphism), and elements of
the class group Cl(Of) (i.e. the group of isomorphism classes of projective
modules of rank one over Of).
Indeed, if a lattice Γ corresponds to E then Γ is an Of-module such that
Γ ⊗Q ∼= K, i.e. a projective Of-module of rank one. Conversely, every Of-
module viewed as a lattice in C determines an elliptic curve C/Γ with the
property that End(C/Γ) is the ring of multipliers of Γ, i.e. Of. Therefore the
number hf of curves (upto isomorphism) with a given endomorphism ring Of
is ﬁnite and its order is equal to Card Cl(Of).
For each curve there is a canonically deﬁned invariant j(E) corresponding
to E; if E is written in the Weierstrass form then this is given by
j(E) =
1728g3
2
g3
2 −27g2
3
,
E : y2 = 4x3 −g2x −g3.
(5.4.6)
We now consider the case f = 1 in more detail.
Theorem 5.13 (Weber - Fueter). (a) All the numbers j(E) are algebraic
integers. (b) If α = j(E) is one of these numbers then K(α) coincides with
the maximal unramiﬁed, Abelian extension of K and G(K(α)/K) ∼= Cl(Of).
The action of G(K(α)/K) on the set of numbers {j(E)} is transitive.

5.4 Diophantine Equations and Galois Representations
241
There are precisely nine imaginary quadratic rings Of with f = 1 and hf =
1, namely Z[
√
−d], where d = 1, 2, 3, 7, 11, 19, 43, 67, 163. The corresponding
elliptic curves have rational invariants, which are also algebraic integers in
view of the Weber - Fueter theorem, hence j(E) ∈Z. Moreover, the values of
j(E) are given respectively by:
j =26 · 33,
26 · 53,
0,
−33 · 53,
−215,
−215 · 33,
−218 · 33 · 53,
−215 · 33 · 53 · 113,
−218 · 33 · 53 · 233 · 293.(5.4.7)
In the general case f > 1 the numbers j(E) are also algebraic integers for
all E with End(E) = Of, and for all σ ∈Gal(K/K) one can explicitly describe
the action of σ on j(E). This description depends only on the restriction of σ
to Kab, which is represented via the Artin reciprocity law by an idele s ∈JK:
σ|Kab = ψK(s),
(ψK : JK →G(Kab/K) −the reciprocity map).
Furthermore if Γ is the lattice corresponding to a curve E then one can deﬁne
a lattice s−1Γ: if s = (sv)v (sv ∈K×
v ) then s−1Γ is uniquely determined by
the condition (s−1Γ) ⊗Ov = s−1
v (Γ ⊗Ov) for all ﬁnite v.
Theorem 5.14. Let j(s−1Γ) denote the invariant of the elliptic curve E′
deﬁned by E′(C) = C/s−1Γ. Then one has the following formula for the
action of σ ∈Gal(K/K):
j(E)σ = j(s−1Γ).
(5.4.8)
From this it follows that j(E) ∈Kab. To prove these theorems, one
considers the action of σ ∈Gal(K/K) on the coeﬃcients of the Weier-
strass equation (5.4.6). One obtains as a result the following new curve:
Eσ : y2 = 4x3 −gσ
2 x −gσ
3 ; therefore j(E)σ = j(Eσ). Clearly, one has
End(Eσ) = End(E) ∼= Of, and thus the set

j(E)σ|σ ∈Gal(K/K)

is ﬁ-
nite and the numbers j(E) are all algebraic. Consequently the curve E can
be deﬁned over an algebraic number ﬁeld L. If the restriction of σ to L is
represented by a Frobenius automorphism for some v,
σ|L = FL/K(v) = Frv,
then the above formula (5.4.8) can be established using the reduction E mod
P, where P is a divisor in L which divides pv. Then this formula can be
rephrased as Hasse's theorem:
j(E)F rv = j(p−1
v Γ),
(5.4.9)
where p ⊂OK is a prime ideal of OK deﬁned by the conditions (p, f) = 1,
pf = Of ∩p.
The invariants j(E) therefore generate an extension K(f)/K satisfying the
property G(K(f)/K) ∼= Cl(Of). However the ﬁeld ˜K = ∪f≥1K(f) does not

242
5 Arithmetic of algebraic varieties
yet coincide with the whole of Kab, and in order to obtain Kab it is necessary
to adjoin also to K(1) the coordinates of all points of ﬁnite order on some
elliptic curve E with the property End(E) = OK. More precisely, let E be an
elliptic curve with complex multiplication, i.e. End E ⊗Q ∼= K, deﬁned over
a number ﬁeld L ⊃K. Then the image of the Galois representation
ρl : GL →Aut Vl(E) ∼= GL2(Ql)
(5.4.10)
is an Abelian group which is contained in (Zl ⊗OK)×, and the index of Im ρl
is ﬁnite and is bounded by a constant independent of l. By class ﬁeld theory
the representation factorizes through Gab
L , and for each idele s = (sv)v ∈JL
we can deﬁne an element ρl(s) = ρl(σ), where σ ∈Gal(K/K) is determined
by the condition σ|Lab = ψL(s). It is not diﬃcult to see that there is a unique
continuous homomorphism ε : JL →K× with the condition ε(x) = NL/K(x)
for all x ∈L× and ρL(s) = ε(s)NLl/Kl(sl) for all s ∈JL and all l.
The Abelian l-adic Representations (5.4.10) and the action of GL on the
invariants j(E) describe explicitly the class ﬁeld theory of the ﬁeld K. We see
also that in the complex multiplication case the group Im ρl is Abelian and
is therefore much smaller than in the general case.
An analogous theory (in a less complete form) also exists for CM-ﬁelds
(totally imaginary, quadratic extensions of totally real ﬁelds) and for Abelian
varieties of CM-type, i.e. Abelian varieties A whose endomorphism algebras
End A ⊗Q are totally imaginary, quadratic extensions of totally real ﬁelds of
degree g = dim A (cf. [Shi71]).
5.4.3 Characters of l-adic Representations
As we have seen, one can associate to each elliptic curve E deﬁned over a
number ﬁeld K a system of l-adic representations ρl : GK →Aut Tl(E) ∼=
GL2(Zl) on the Tate module Tl(E). Together (5.4.4) and (5.4.5) give the
following important formula for the traces of Frobenius endomorphisms:
Tr ρl(Frv) = Nv + 1 −Nv(E),
where Nv = Card(k(v)) is the norm of v, Nv(E) = Card ˜Ev(k(v)) is the
number of k(v) - rational points on the reduction ˜Ev modulo v. It turns out
that the values of the character χρl = Tr ρl form an interesting arithmeti-
cal function of the argument v. We shall later see that the list of examples
of this sort is quite rich and contains for example the Ramanujan function
τ(p); the numbers of representations of positive integers by positive deﬁnite
quadratic forms, etc. It is known that the character of ρ uniquely determines
this representation provided that ρ is a semi-simple representation, that is, a
direct sum of irreducible representations. This semi-simplicity property was
established for the Tate modules of elliptic curves and Abelian varieties, cf.
[Fal83], [Fal85], [Fal86], [PZ88].

5.4 Diophantine Equations and Galois Representations
243
A remarkable ﬁniteness property
for the characters χρ of continuous ﬁnite-dimensional l-adic representations
was discovered by G.Faltings (cf. [Fal83]) in his proof of the Mordell con-
jecture: any such character χρ is uniquely determined by a ﬁnite number of
values
χρ(Frv) = Tr ρ(Frv),
(v ∈Q, Q a ﬁnite set),
where Frv denotes the class of a Frobenius element under the assumption
that ρ is unramiﬁed for all v outside a ﬁnite set S of places of K. In this
situation the representation ρ factorizes through a representation of the group
GS = G(KS/K), where KS is the maximal extension of K unramiﬁed outside
S. For each v ̸∈S the value χρ(Frv) is therefore well-deﬁned. We shall now
construct a ﬁnite set Q of places of K, Q ∩S ̸= ∅, such that ρ is is uniquely
determined by the values χρ(Frv) for v ∈Q. Let L/K denote the composite of
all Galois extensions of K unramiﬁed outside S, which are of degree less than
or equal to l2n2. Then by Hermite's theorem (see §4.1.5), the extension L/K is
ﬁnite. Now we choose an appropriate Q outside S such that the elements Frv
ﬁll the whole Galois group G(L/K). The existence of such elements follows
from the Chebotarev density theorem (Theorem 4.22). We claim that the set
Q constructed in this way satisﬁes the conditions of the theorem.
Indeed, let ρ1 and ρ2 be two diﬀerent representations whose characters
coincide on the elements Frv, v ∈Q. Consider the representation
ρ1 × ρ2 : Zl[G] →Mn(Ql) × Mn(Ql)
of the group algebra Zl[G]. Its image M is a Zl-submodule of rank ≤2n2. By
the construction of Q the elements ρ1 × ρ2(Frv),
v ∈Q generate M/lM
as a vector space over Fl, and consequently, the whole of M over Zl (by
Nakayama's lemma for ﬁnitely generated modules over a local ring, applied
to the ring Zl, see [Bou62], [SZ75]). Now consider the linear form
f(a1, a2) = Tr(a1) −Tr(a2)
(a1, a2 ∈Mn(Ql))
on M. By the assumption we have that
χρ1(Frv) = χρ2(Frv),
v ∈Q,
and therefore f(a1, a2) = 0 on the whole Zl-module M, because f = 0 on its
generators (ρ1 × ρ2)(Frv)
v ∈Q. Therefore χρ1(Frv) = χρ2(Frv), establish-
ing the theorem, see [PZ88], [Del83], [Sz(e)81].
5.4.4 Representations in Positive Characteristic
Let E be an elliptic curve over a ﬁnite ﬁeld k with q = pd elements. Consider
its Tate module

244
5 Arithmetic of algebraic varieties
Tp(E) = lim
←−
m
Ker(E
pm
−→E) ∼= Zγ
p,
where γ = 0 or γ = 1. In this way we obtain a representation deﬁned by
ρp : Gal(k/k) →Aut Tp(E),
in which the group Gal(k/k) is a (topologically) cyclic group.
If Tp(E) ̸= 0 then End E ⊗Q is an imaginary quadratic extension of K
and End E = Of for some f ≥1, where Of = Z + fOK is a subring of the
maximal order OK of K.
In this situation one can show that:
1) the prime p does not divide the conductor f,
2) p splits in K.
In the case Tp(E) = 0 we have that DE = End E ⊗Q is a division algebra of
degree 4 (a quaternion algebra) over Q which at all primes l ̸= p decomposes
as DE ⊗Ql ∼= M2(Ql). Also, End E is a maximal order in DE. Curves with
this property are called supersingular curves.
In positive characteristic the endomorphism algebra becomes larger when
there is a Frobenius endomorphism Fq of E, which is a purely inseparable
isogeny; its kernel and image have only one geometric point over k. In par-
ticular, if Fq ∈Z ⊂End E, then also Tp(E) = 0. For further information on
points of ﬁnite order in positive characteristic, also in Abelian varieties, see
[Man61], [La73/87], [Mum74].
5.4.5 The Tate Module of a Number Field
(cf. [Sha69], [Coa73], [Iwa72], [Iw01], [MW83]). The Tate module of the Jaco-
bian variety JC of a curve C gives a functor from the category of curves over
a ﬁeld k to the category of Zl-modules. If k is ﬁnite then the ﬁeld k(C) of ra-
tional functions on C has much in common with a number ﬁeld. Iwasawa has
suggested an analogue of the Tate module for a number ﬁeld K. The group
Jlm can be interpreted as the Galois group of the étale covering Cm →C of
C, where Cm is the inverse image of C embedded into J, with respect to the
morphism lm
J . One veriﬁes that the ﬁeld ∪mk(Cm) is the maximal unramiﬁed,
Abelian l-extension of k(C). Its Galois group coincides exactly with the Tate
module Tl(JC); this gives a reasonable interpretation of the Tate module for
an algebraically closed ﬁeld k. However if k is not algebraically closed (for
example when k is a ﬁnite ﬁeld) then k need not be algebraically closed inside
the ﬁeld k(Jlm). In particular the ﬁeld k(Jlm) must contain roots of unity of
the degree lm since these are values of the Weil pairing. In the case of a ﬁnite
ﬁeld this is almost suﬃcient: that is, for a ﬁnite extension k′/k we have
˜k = k ∩
.
m
k(Jlm)

=
.
m
k′(ζlm),

5.4 Diophantine Equations and Galois Representations
245
where ζlm denotes a primitive root of unity of degree lm and k is the algebraic
closure of k. Indeed, the image of Gal(k/k) in Tl ⊂GL2g(Zl) is a topo-
logically cyclic group, whose intersection with the l-Sylow normal subgroup
S = {g ∈GL2g(Zl)|g ≡1 mod l} is an l-subgroup of ﬁnite index. Therefore
on replacing k by a ﬁnite extension k′ of degree prime to the characteristic of
k, the extension ˜k becomes an l-extension of the ﬁnite ﬁeld k′, i.e.
˜k =
.
m
k′(ζlm).
We see now that for a ﬁnite ﬁeld of constants the Tate module Tl coincides
with the Galois group of the composite Galois extension
k(C) ⊂˜k(C) ⊂A(l),
where ˜k = ∪mk′(ζlm), A(l) is the maximal unramiﬁed, Abelian l-extension of
˜k(C).
Taking this description as a starting point, we may extend the deﬁnition
of the Tate module to the number ﬁeld case. Let K be a number ﬁeld, Km =
K(ζlm), ˜K = ∪mKm, and A(l) ⊃
˜K the maximal Abelian, unramiﬁed l-
extension of ˜K. Further let
Tl(K) = Gal(A(l)/ ˜K).
(5.4.11)
Then Tl(K) is a projective limit of l-groups (a pro-l-group), and is in particular
a Zl-module. Iwasawa, who introduced this module (also called the Iwasawa
module), has shown that Vl(K) = Tl(K) ⊗Ql is a ﬁnite - dimensional Ql-
vector space. Using class ﬁeld theory one can describe Tl(K) explicitly. One
knows that the Galois group of the maximal Abelian, unramiﬁed extension of
a number ﬁeld L is isomorphic to the class group ClL. Denoting by Cl(l)
L the
l-component of this group, one obtains the following description:
Tl(K) = lim
←−Cl(l)
Km,
where the inverse limit is taken with respect to the norm maps of ideals.
On Tl(K) we have an obvious action of the Galois group Gal( ˜K/K) and its
subgroup Γ = G( ˜K/K1) ∼= Zl. On a class represented by an ideal α ∈Cl(l)
Km
this action is given by α →αg, (g ∈G( ˜K/K)), and for the corresponding
h ∈Gal(A(l)/K) the ideal αg corresponds under class ﬁeld theory to g−1hg
(in view of the equality (4.4.22)).
Iwasawa regarded Tl(K) as a module over the completed group ring Λ =
Zl[[Γ]] ∼= Zl[[T]] (the ring of formal power series over Zl). Just using his
classiﬁcation theory for such modules, he obtained the following formula for
the orders of the groups Cl(l)
Km, which is valid for m ≥m0:
logl |Cl(l)
Km| = λm + µlm + const.
(5.4.12)

246
5 Arithmetic of algebraic varieties
Under some additional assumptions he described explicitly the module
Tl(Q) for all l ≤4001. This module turns out to be cyclic, and one can even
ﬁnd a generator of its annihilator. Essentially, this generator coincides with a
product of the l-adic L-functions of Kubota and Leopoldt ([Iwa72], [KuLe64],
[Sha69], [Kuz84]).
The validity of the corresponding statement in the general case (the "Main
conjecture" of Iwasawa theory) was established in 1984 by B. C. Mazur and
A. J. Wiles [MW83]. According to the main conjecture of Iwasawa theory a
module of ideal class groups can be described as the quotient of the Iwasawa
algebra by an explicitly given principal ideal. A later, more accessible proof
using Kolyvagin's notion of Euler systems was found by K. Rubin, cf. his
appendix to [La90].
In the works of Ferrero and Washington ([FeWa79], [Fer88], [Wash82])
another conjecture of Iwasawa was proved, which says that for each Abelian
extension K/Q and each prime l, the invariant µ of the module Tl(K) vanishes.
This result implies that Tl(K) is a ﬁnitely generated Zl-module. Washing-
ton's conjecture, according to which the orders of the groups Cl(p)
Km stabilize
in the cyclotomic Zl-extension of an arbitrary Abelian ﬁeld for l ̸= p, was
proved in ([Wash78]).
Very recently (cf. [Barsky04]) the vanishing of the Iwasawa µ invariant was
proved by D.Barsky for all totally real ﬁelds. The Iwasawa µ- invariant of p-
adic Hecke L- functions was studied by H.Hida in [Hi02].
The methods of Iwasawa have been considerably extended in further re-
search related to the study of Λ-modules of various kinds: those arising from
Selmer groups of Abelian varieties (Mazur modules) see [Man71], [Man76],
[Man78], [Maz79], [Maz83], [Maz86], and also those arising from elliptic units
in Abelian extensions of ﬁelds of CM-type, cf. [Maz83], [Rob73], and the ones
arising from Heegner points on modular curves ([Koly88], [Coa73], [Coa84],
[GZ86], [Rub77]).
New approaches to proving the main conjecture and its generalizations in
various situations were discovered by Kolyvagin in [Koly90], who proposed the
more general concept of an "Euler system", which makes it possible to deal
with all known cases from a uniﬁed point of view.
For recent developments on Euler Systems we refer to [Rub98], [Kato99],
[Kato2000], [MazRub04].
Interesting Euler systems could be constructed in some cases using Beilin-
son elements in K2 of modular curves and the Rankin-Selberg method, cf.
[Scho98]. An analogue of the Selmer groups and the groups of Shafarevich-
Tate were deﬁned in [BK90], [FP-R94] for an arbitrary motive over a number
ﬁeld F, cf. also a new book by B.Mazur and K.Rubin, [MazRub04].
We only mention a GL(2) version of Iwasawa theory developed by Coates
et al., cf. [Coa01], [CSS03]. The GL(2) main conjecture for elliptic curves
without complex multiplication was described very recently by J. Coates, T.
Fukaya, K. Kato, R. Sujata, O. Venjakob in [CFKSV].

5.5 The Theorem of Faltings and Finiteness Problems in
Diophantine Geometry
5.5.1 Reduction of the Mordell Conjecture to the ﬁniteness
Conjecture
A major problem in diophantine geometry was the Mordell conjecture, now a
Theorem 5.15 (Faltings [Fal83]). If X is a projective algebraic curve of
genus g ≥2 deﬁned over a number ﬁeld K and L/K a ﬁnite extension then
X(L) is ﬁnite.
Note that prior to the work of Faltings this was not known for any curve X.
However
Siegel's Theorem was known, the strongest ﬁniteness result until
Faltings:
Theorem 5.16 (Siegel). If X is an aﬃne curve of genus g ≥1 deﬁned over
the ring of integers O ⊂K and OS ⊂O is any subring of S-integral elements
(S ﬁnite) then X(OS) is ﬁnite.
Here OS ⊂K denotes the subring
OS = {x ∈K | ∀v ∈S, v non-Archimedean, |x|v ≤1},
where S ⊂Val(K) is a ﬁnite set of valuations of K.
The starting point for research leading ultimately to the (ﬁrst!) proof of
Mordell's conjecture by Faltings, was the following pair of conjectures, pro-
posed by I.R.Shafarevich [Sha62], on classiﬁcation the problem for algebraic
curves of genus g ≥1 over an algebraic number ﬁeld K, with a ﬁxed set S of
bad reduction points: ∗)
Let X(g, K, S) be the set of (K-isomorphism classes of) algebraic curves
X of genus g(X) ≥1, deﬁned over a number ﬁeld K with bad reduction
contained in a ﬁnite set S ⊂Val(K). When g = 1 we assume in addition that
X(K) ̸= ∅.
I) Finiteness Conjecture. Assume that g ≥2 (or that g ≥1 and X(K) ̸= ∅).
Then for any given g, K, S these exist only ﬁnitely many such curves (up
to isomorphism). This ﬁnite set will be denoted by X(g, K, S).
For the second proof of Mordell's conjecture by Bombieri-Vojta we refer to
[Bom90], [Voj91]. This entirely new proof is based on methods from Diophan-
tine approximation and arithmetic intersection theory. Faltings in [Fal91] simpli-
ﬁed and extended these methods to prove two longstanding conjectures of Lang
concerning integral points on Abelian varieties and rational points on their sub-
varieties, and E. Bombieri subsequently further simpliﬁed the arguments to give
a comparatively elementary proof of Mordell's conjecture.

248
5 Arithmetic of algebraic varieties
II) Bad Reduction Conjecture. If S = ∅and K = Q then these exist no such
curves, i.e. X(g, K, S) = ∅.
These problems generalize theorems of Hermite and Minkowski in the the-
ory of algebraic number ﬁelds (cf. §4.1.5).
It was shown by A.N.Parshin in
[Par72], [Par73], how to reduce Mordell's problem to the ﬁniteness conjecture.
His remarkable construction is given below. The Shafarevich Conjecture and
the related Tate conjecture were proved by Faltings [Fal83] (see also Deligne's
Bourbaki talk [Del83]).
A detailed exposition of all these questions can be found in the survey
[PZ88].
The construction of A.N.Parshin consists in constructing of a map
α : X(K) →X(g′, K′, S′)
(5.5.1)
for some other data of g′, K′, S′ with the property that the ﬁbers of the
map (5.5.1) are ﬁnite. The image of a point P ∈X(K) is a certain curve
XP ∈X(g′, K′, S′), which is constructed in several steps.
1) Let us map the curve X into its Jacobian J using the Abel map (5.3.52):
ϕP : X →J, and consider the multiplication by 2 morphism 2J : J →J.
We deﬁne an auxiliary curve X1 as the inverse image of X under this map
(this is an example of the ﬁber product):
X1 −→X
⏐⏐5
⏐⏐5ϕP
J −→
2J
J
The curve X1 is smooth, it is deﬁned over the same ﬁeld K, and its
genus g1 can be computed using the Hurwitz formula (5.1.1). We have
2g1 −2 = 22g(2g −2), because X1 −→X is an unramiﬁed covering of
degree 22g = CardJ2. The inverse image of the point P is then a rational
divisor D = DP on X1 of degree 22g.
2) One constructs a covering XP →X1 of degree 2, which is ramiﬁed only
over the points in D. Such a covering exists, it has genus g′ = g(XP )
which is also computed by the Hurwitz formula
2g′ −2 = 2(2g1 −2) + 22g = 22g+1(2g −2) + 22g,
that is
g′ = 22g+1(g −1) + 22g−1 + 1.
One checks that the curve XP is deﬁned over an algebraic number ﬁeld
K′ ⊃K, [K′ : K] < ∞, which depends only on the data g, K, S, but
not of the individual point P ∈X(K). Moreover, the curve XP has a
good reduction over the set S′ of non-Archimedean points of K′, lying

5.5 The Theorem of Faltings and Finiteness Problems
249
over S and over the prime 2. The construction of XP is analoguous to
the construction of a 2-covering attached to a rational point on an elliptic
curve (see (5.3.37). In the same way one proves that the reduction of the
resulting curve is good over S′ (lying over S ∪2). Then one deduces the
ﬁniteness of the degree of K′/K using the Theorem of Hermite.
The proof of the fact that the ﬁbers of the map (5.5.1) are ﬁnite, is purely
geometric, and it belongs rather to the theory of Riemann surfaces. Indeed, the
resulting map XP →X is ramiﬁed exactly over exactly one point, namely P. If
there were inﬁnitely many points P such that the curves XP were isomorphic,
say to a ﬁxed curve Y , we would have inﬁnitely many maps Y →X of curves of
genus > 2, ramiﬁed over diﬀerent points of X. Amongst these maps there are
inﬁnitely many non-isomorphic, since the group of analytic isomorphisms of a
Riemann surface of genus ≥2 is ﬁnite (its order is bounded by ≤84(g−1), see
[Hur63], [Maz86]). This leads to a contradiction with the classical theorem
of de Franchis: for any closed Riemann surface Y there exists only ﬁnitely
many non-constant maps f : Y →Z into closed Riemann surfaces Z of genus
gZ ≥2 (upto isomorphism), see [dFr13], [Sev14]).
Note that the theorem of de Franchis is itself a special case of an analogue
of Mordell's conjecture over function ﬁelds (namely, over C(t)). This version
of Mordell's problem was solved in [Man63a], [Man63b].
5.5.2 The Theorem of Shafarevich on Finiteness for Elliptic Curves
(cf. [Sha65], [Se68a]) The ﬁniteness conjecture was proved by I.R.Shafarevich
[Sha65] for hyperelliptic curves as a corollary of the Theorem of Siegel on the
ﬁniteness of the number of S-integral points on an aﬃne algebraic curve of
positive genus. We shall give the proof of this result in the case of elliptic
curves. Let us write the curve X = E in the Weierstrass form:
E : y2 = 4x3 −g′
2x −g′
3
(g′
2, g′
3 ∈K)
(5.5.2)
We next note that is the curve E has a good reduction outside of S, then its
equation could be reduced to the following form
E : y2 = 4x3 −g2x −g3
with
∆= g2
3 −27g3
2 ∈O×
S
(it is assumed that the ﬁnite set S contains the primes over 2 and 3, and S
is also chosen large enough so that OS is a P.I.D.). Indeed, if v ̸∈S, then the
curve E can be led over the local ring Ov to the form
E : y2 = 4x3 −g2,vx −g3,v
with g′
2,v, g′
3,v ∈Ov ∩K, ∆v ∈O×
v .
(5.5.3)
By the uniqueness property of the Weierstrass form (5.5.2) one can choose an
element uv ∈K×, such that
g2,v = u4
vg′
2,
g3,v = u6
vg′
3,
∆v = u12
v ∆′,

250
5 Arithmetic of algebraic varieties
and we may assume that uv = 1 for almost all v.
As the ring OS is a P.I.D., there is an element u ∈K× the equation (5.5.2)
of the curve takes the form
E : y2 = 4x3 −g2x −g3
where
g2 = u4g′
2,
g3 = u6g′
3,
∆= u12∆′,
and it follows that ∆∈OS.
Now we can miltiply ∆by any number u ∈(O×
S )12 keeping ﬁxed the
isomorphism class of the curve. It follows from a version of Dirichlet's unit
theorem (on S-units, see §4.1.6) that the group (O×
S )/(O×
S )12 is ﬁnite. There
therefore exists a ﬁnite set M ⊂O×
S such that any elliptic curve of the given
form can be reduced to the form (5.5.3) with gi ∈OS, ∆∈M. On the other
hand, for a given ∆the equation
U 3 −27V 2 = ∆
is an aﬃne curve of genus 1, which has only ﬁnite number of solutions in OS
by the Theorem of Siegel (see [Sie29], [La60], [Mah34]).
The same idea is used in the proof of the semisimplicity of the Tate module
of an elliptic curve (see [Se68a]).
5.5.3 Passage to Abelian varieties
In order to prove the Shafarevich conjecture for an arbitrary curve of genus g ≥
1 over a ﬁeld K, whose bad reduction points belong to S, one associates to X
its Jacobian variety A = JX, endowed with a canonical principial polarization
θ, deﬁned over the same ﬁeld K. It is known that A has good reduction outside
S, and X is determined by the pair (A, θ) due to the Theorem of Torelli, see
[Wei57]. Let us prove that the number of K-isomorphism classes of curves
X having the same the couple (A, θ) is also ﬁnite over the base ﬁeld K.
For this one ﬁxes a natural number m ≥3, and one consideres the extension
K(Am)/K, obtained by adjoining to K the coordinates of all points of order m
on A. The extension K(Am)/K is then unramiﬁed outside S∪{divisors of m},
and all extensions of the form K(Am)/K have a bounded degree, they are all
contained in a ﬁnite extension K′ by the Theorem of Hermite (cf. (§4.1.5)).
Let us prove that the set K′-isomorphism classes of such curves is ﬁnite.
If σ ∈Gal(Q/Q), and ϕ is an isomorphism of curves with the same Jacobian,
preserving the polarization, then α = ϕσ ◦ϕ−1 induces the identity on Am. It
is well-known that then the morphism α is identical (see, for example, [La62]):
the matrix Tl(A) ∈AutTl(A) ∼= GSPg(Zl) with coeﬃcients in Q is a unitary
matrix with respect to the involution α →αρ determined by the polarization
(the Rosatti involution, i.e. ααρ = 1. The characteristic roots ωi of the matrix

5.5 The Theorem of Faltings and Finiteness Problems
251
Ti(α) are then algebraic integers ωi whoses absolute value is equal to one for
all Archimedean valuations, i. e. ωi are roots of unity. By the assumption,
α −1 = mβ for some β ∈EndA, that is, ωi −1 = mβi, where βi are algebraic
integers, implying ωi = 1.
In order to pass from K′ to K, one can use the fact that the num-
ber of K-forms of a curve X, isomorphic to X over K′, is ﬁnite. In fact,
such forms are classiﬁed up to K-isomorphism by the ﬁnite cohomology set
H1(G(K′/K), AutK′(X)), see [Se64].
We have reduced the Shafarevich conjecture for curves to an analogu-
ous statement for Abelian varieties, more precisely to the ﬁniteness of the
set X(1)
AV (g, K, S) of the K-isomorphism classes of pairs θ, where A is a g-
dimensional Abelian variety over K with good reduction away from S, and
θ is a polarisation of degree 1, deﬁned over K. As we have already seen in
section 5.3.5, the C-isomorphism classes of pairs (A, θ) correspond to points
on the Siegel modular variety Ag(C) = Hg/Spg(Z), which is a quasiprojective
normal variety, and could be deﬁned over Q.
Another key idea, proposed by A.N.Parshin for solving Mordell's problem,
was to associate to elements of X(1)
AV (g, K, S) certain points of the set Ag(K),
and then to prove that all such points have bounded height in some projective
imbedding of the variety Ag. Note that under this correspondence the map
X(1)
AV (g, K, S) →Ag(K) is not injective, since C-isomorphic pairs (A, θ) need
not be K-isomorphic. However, it is easy to check that the above map has
ﬁnite ﬁbers: for a ﬁeld K′, considered above , the corresponding map
X(1)
AV (g, K′, S′) →Ag(K′)
is already injective, and an analoguous argument shows that the ﬁbers of the
map
X(1)
AV (g, K, S) →X(1)
AV (g, K′, S′)
(5.5.4)
are also ﬁnite (the theorem of ﬁniteness for forms of an Abelian variety).
Consideration of Abelian varieties A = JX rather than curves X was a
very fruitful idea: to each Abelian variety A on can attach its Tate module
Tl(A) (l is a prime), regarded as a module over GK. If λ : A →B is an isogeny
over K, then one checks that the corresponding maping
Tl(λ) : Tl(A) →Tl(B)
is an isomorphism of GK-modules, so A and B have the same sets of bad
reduction places. Therefore, the ﬁniteness of X(1)
AV (g, K, S) follows from:
I) The ﬁniteness of the number of isomorphism classes of GK-modules
M ∼= Z2g
l
which arise as Tate modules Tl(A) with given g, K, S.
II) The ﬁniteness of the K-isomorphism classes of pairs (A, θ), for which
the GK-module Tl(A) is isomorphic to a given module M.

252
5 Arithmetic of algebraic varieties
5.5.4 Finiteness problems and Tate's conjecture
Recall the property observed ﬁrst by Faltings that the character of a (conti-
tuous) representation ρ : GK →AutVl(A) is determined by its values on a
ﬁnite set of elements Frv(v ∈Q), Card(Q) < ∞, Q ∩S = ∅, which depends
only on given g, K, S (cf. §5.4.3).
By a theorem of A.Weil for Abelian varieties over ﬁnite ﬁelds (cf. §5.4.1
which generalizes the theorem of Hasse for elliptic curves (cf. §5.1.3), the num-
ber | Tr(ρl(Frv)) | is an integer not exeeding 2g
√
Nv. We conclude that for
every prime l there are ﬁnitely many possibilities for characters of represen-
tations ρl.
Thus statement I) reduces to proving the semisimplicity of the GK-module
Vl(A): for any Ql-subspace W in Vl(A), which is a GK-submodule, there exists
an endomorphism u ∈EndA ⊗Q such that u2 = u and uVl(A) = W, so that
(1 −u)Vl(A) is a GK-invariant subspace of W in Vl(A).
In turn the proof of the statement II) also splits into the following steps:
1) Let us consider the set XAV (g, K, S) of K-isomorphism classes of Abelian
varieties as above (but without polarization) with given g, K, S. Then all
the ﬁbers of the mapping
X(1)
AV (g, K, S) →XAV (g, K, S)
(5.5.5)
are ﬁnite.
2) Tate's conjecture on isogenies. For an arbitrary homomorphism λ : A →B
of Abelian varieties over K, consider the corresponding mapping Vl(λ) :
Vl(A) →Vl(B). Then
- if the GK-modules Vl(A) and Vl(B) are isomorphic then the varieties A
and B are isogenous over K;
- the natural mappings
EndA ⊗Zl →EndTl(A) and EndA ⊗Ql →EndVl(A)
(5.5.6)
are bijective.
3) The ﬁniteness theorem for isogenies. The set of K-isomorphism classes of
Abelian varieties B over K, for which there exists an isogeny A →B, is
ﬁnite.
Statement 1) is not diﬃcult and it reduces to showing that the number of
polarizations of degree 1, deﬁned over K (upto a K isomorphism of polarazed
varieties) is ﬁnite. This is deduced as follows: let us view a principial polariza-
tion θ is an isomorphism θ : A →A∨= Pic0(A). An isomorphism λ : A →A,
compatible with polarizations θ1 and θ2 of A, gives rise to a commutative
diagram

5.5 The Theorem of Faltings and Finiteness Problems
253
A
λ∨
←−A∨
θ1
:⏐⏐
:⏐⏐θ2
A ←−
λ
A
that is,
θ1 = λ∨◦θ2 ◦λ.
(5.5.7)
Let us ﬁx an isomorphism θ0 : EndA ∼= EndA∨. Then the mapping λ →λ∨
becomes the Rosatti invoution ρ, and all the automorphisms of the form θ−1
0 θi
will be then invariant under ρ : (θ−1
0 θi)ρ = θ−1
0 θi. Moreover, the following
equality holds θ−1
0 (λ∨◦θi ◦λ) = λρ ◦θ−1
0
◦θi ◦λ. Hence the equality (5.5.7)
takes the form
θ−1
0
◦θ1 = λρ ◦(θ−1
0
◦θ2) ◦λ
(5.5.8)
This equality shows that our statement is analogous to the assertion on the
ﬁniteness of the number of classes of integral unimodular quadratic forms up
to the integral equivalence. More precisely, this fact can be stated as follows:
if E is an order in a semisimple algebra E ⊗Q with an involution ρ, then the
group E×, acting by the formula (x, h) →xρhx (x ∈E×) on the set of all
Hermitian elements (hρ = h) of E with a ﬁxed norm, has only a ﬁnite number
of orbits. In our case we use E = EndA, and we use the semisimplicity of the
algebra EndA ⊗Q.
Properties a) and b) of 2) are then reduced to the semisimplicity property
of the module Vl(A) applied to the varieties A2 and A × B.
5.5.5 Reduction of the conjectures of Tate to the ﬁniteness
properties for isogenies
A fruitful approach to the proof of the theorem on semisimplicity and of the
conjectures of Tate was developed by Yu.G. Zarhin [Zar74] in the years 1974-
77. He showed that for any ground ﬁeld these properties could be deduced
from the property 3) (which is sometimes known as Conjecture T) using a
"unitary trick" for Abelian varieties discovered by himself. Using this trick
Zarhin proved the Tate conjecture over global ﬁelds of positive characteristic.
Note that over ﬁnite ﬁelds these conjectures were proved by Tate himself
[Ta66].
It suﬃces to show that there is an isomorphism
EndK(A) ⊗Ql
∼
−→EndGK(Tl(A) ⊗Ql)
(induced by a natural map from the left to the right). Consider a non-
degenerate scew-symmetric pairing (see also in section 5.3.5):
eD : Tl(A) × Tl(A) →Zl(1) = lim
←−
m
µlm,

254
5 Arithmetic of algebraic varieties
attached to an ample divisor D over A. We choose a maximal isotropic GK-
submodule W in Tl(A) ⊗Ql, and let Wm be the image of Tl(A) ∩W in the
quotient module
Tl(A)/lmTl(A) = Alm = Ker(A
lm
→A).
There is a commutative diagram
A
πm 
lm










A/Wm
λm

= A(m)
A
It follows from Conjecture T that inﬁnitely many of the varieties A(m) should
be K-isomorphic. Let us denote by
νm : A(m) →A(m0)
be a ﬁxed isomorphism. Now consider
um = λ−1
m ◦νm ◦λm0 ∈EndK(A) ⊗Ql
and deﬁne
u = lim
m→∞um ∈EndK(A) ⊗Ql.
It is easy to check that we can recover the GK-submodule W as the image of
Tl(u):
Tl(u)(Tl(A) ⊗Ql) = W.
We claim that for an arbitrary GK-submodule in EndGK(Tl(A) ⊗Ql) there
exists an idempotent u ∈EndK(A) ⊗Ql, u2 = u, such that
u(Tl(A) ⊗Ql) = W.
(5.5.9)
This can be established by considering the variety A8, and by constructing
a certain maximal isotropic GK-submodule W (8) ∈EndGK(Tl(A(8)) ⊗Ql)
attached to W. Then we apply to W (8) the assertion already proved.
Consider the coordinate projections pi : A8 −→A (i = 1, 2, · · · , 8), and let
Di = p−1
i (D), D(8) = 8
i=1 Di be the divisors on A8. We choose a, b, c, d ∈Ql
satisfying a2 + b2 + c2 + d2 = −1, and deﬁne
I =
⎛
⎜
⎜
⎝
a −b −c −d
b
a
d
c
c −d
a
b
d
c −b
a
⎞
⎟
⎟
⎠.
It is easy to check that tI · I = 14, where 14 is the identity matrix. Consider
I as an element in EndGK(Tl(A4) ⊗Ql) and put

5.5 The Theorem of Faltings and Finiteness Problems
255
W1 =

(x, Ix) | x ∈W 4
,
W2 =

(x, −Ix) | x ∈(W 4)⊥
,
where (W 4)⊥is deﬁned by the scew-symmetric form e4 attached to the divisor
D(4). Then we have that W1 ∩W2 = {0}, W1, W2 are orthogonal with respect
to the pairing e8 associated to the divisor D(8). The GK-submodule
W (8) = W1 + W2 ⊂EndGK(Tl(A8) ⊗Ql)
is a maximal isotropic submodule with respect to the pairing deﬁned by e8
which satisﬁes all desired properties. This arguments show that there exist
elements u1, · · · , u8 ∈EndK(A) ⊗Ql such that
8

i=1
ui(Tl(A) ⊗Ql) = W1 + W2.
The right ideal in EndK(A) ⊗Ql generated by u1, · · · , u8 can be gener-
ated by a single idempotent element u because this algebra is known to be
semisimple (see §5.3.5). This element exactly satisﬁes our requirement (5.5.9).
5.5.6 The Faltings-Arakelov Height
In the previous section we reduced the Mordell conjecture to Conjecture T
on the ﬁniteness of the number of K-isomorphism classes of Abelian varieties,
which are K-isogenous to a given variety A. The proof of Conjecture T uses a
certain canonical height h(A) of A over K introduced by Faltings using ideas
of Arakelov [Ara74a]. Its principal properties are:
Finiteness Principle. For given g, K and a real number b the number of K-
isomorphism classes of Abelian varieties A over K with the condition h(A) ≤b
is ﬁnite.
Boundedness under isogenies: there exists a constant c such that for all
K-isogenous Abelian varieties A and B one has |h(A) −h(B)| < c.
In order to deﬁne the height h(A) consider ﬁrst a one-dimensional vector
space L over K endowed for all places v of K by a v-adic norm ∥·∥: K −→R,
satisfying the condition ∥λs∥v = |λ|v∥s∥v, where ∥λs∥v is the normalized v-
valuation of an element λ ∈K×. Suppose that for s ∈L\{0} the equality
∥λs∥v = 1 holds for almost all v (i.e. with possible exlusion of a ﬁnite number
of them). In view of the product formula (4.3.31) we have 
v |λ|v = 1 for
λ ∈K×, therefore the product 
v ∥λs∥v is independent on a choice of ∥s∥v.
The degree of L is deﬁned by the formula:
deg L = −log

v
∥s∥v.
(5.5.10)

256
5 Arithmetic of algebraic varieties
Let O ⊂K is the maximal order. Deﬁning norms ∥· ∥v for all ﬁnite v is
equivalent to deﬁning of an integral structure, or an OK-form LOK of L, that
is, to deﬁning of a projective OK-module of rang 1 such that LOK ⊗OK K ∼= L.
In order to deﬁne LOK we put
LOK = {s ∈L| ∥λs∥v ≤1, v a ﬁnite place of K}.
Conversely, for a given OK-module of rank 1 LOK ⊂L with the property
LOK ⊗OK K ∼= L we deﬁne the norm ∥· ∥v using the isomorphism of vector
spaces LOK ⊗OK Kv ∼= Kv which takes LOK ⊗OK OK to OK (for a ﬁnite v).
If s ∈LOK\{0} then OK · s is a submodule of LOK and
Card(LOK/OK · s) =

v̸ |∞
∥s∥−1
v .
Consideration of Archimedean metrics ∥s∥v is a convenient replacememt of
the notion of an integral structure. Deﬁning this metric is equivalent to giving
a Hermitian form ⟨·, ·⟩v on the one-dimensional complex vector space Lσ =
L ⊗K,σ C for all embeddings σ : K →C associated with Archimedean places
v. We have that
∥s∥v = ⟨s, s⟩1/2
σ , if Kv ∼= R;
(5.5.11)
∥s∥v = ⟨s, s⟩σ, if Kv ∼= C.
For an Abelian variety A over K, we let ω(A) = Ωg
K[A] denote the one-
dimensional K-vector space of regular (algebraic) diﬀerential forms of maxi-
mal degree g on A where (g = dim A). For a number ﬁeld K there is a natural
v-adic norm ∥· ∥v on ω(A) deﬁned as follows.
a) For non-Archimeadean places v the norm ∥·∥v is deﬁned using the theory
of Néron which makes it possible to deﬁne a minimal model AOv of A over
Ov and a one-dimensional Ov - module ω(AOv) endowed with a canonical
isomorphism
ω(AOv) ⊗Ov K ∼= ω(A) ⊗Kv.
(5.5.12)
The norms are those corresponding to the OK-module ω(A)OK.
b) For a Archimedean place v given by an embedding σ : K →C the norm
∥· ∥v is deﬁned using the Hermitian form
⟨α, β⟩σ =
1
(2π)g

A(C)
α ∧β,
(5.5.13)
on ω(A)σ = ω ⊗K,σ C, where α ∧β is a 2g-dimensional diﬀerential
form, which is integrated against the (topologically) 2g-dimensional vari-
ety A(C).

5.5 The Theorem of Faltings and Finiteness Problems
257
In terms of these norms on ω(A) the height h(A) of the variety A is deﬁned
as follows (see the equality (5.5.10)):
h(A) =
1
[K : Q] deg ω(A).
(5.5.14)
For example, if K = Q and α is one of the two generators ±α of a Z-module
ω(A)Z (the Néron diﬀerential) then
h(A) = −1
2 log

1
(2π)g

A(C)
|α ∧α|

.
The proof of the ﬁniteness principle for the height h(A) may be broken up
into the following steps:
1) Reduction to a ﬁniteness statement for Abelian varieties with a princi-
pal polarization. This can again be achieved using the "unitary trick" of
Yu.G.Zarhin, who proved that for an abelian variety A over K and the
dual variety A∨there always exists a principal polatization on the variety
A4 × (A∨)4 (see [Zar85]).
2) The study of the moduli spaces Ag/Q of K-isomorphism classes of pairs
(A, θ) where θ is a principal polarization of A. Recall that A1 is an aﬃne
line deﬁned over Q parametrizing elliptic curves by means of the elliptic
modular invariant (5.3.16). In general, Ag is a normal algebraic variety
of dimension g(g + 1)/2, which is not compact for g ≥1, and the struc-
ture of its various compactiﬁcations is rather complicated [Fal85]. A pair
(A, θ)deﬁned over K produces a point J(A, θ) ∈Ag and one can deﬁne
heights of various projective embeddings of the variety A deﬁned over Q.
3) A canonical projective embedding of Ag is constructed using Siegel modular
forms; these forms may be viewed as global sections of certain line bundles
(more precisely, powers of the canonical line bundle) on Ag, cf. [MZ72],
[PZ88], [FW84]. The corresponding height of a point J(A, θ) is called the
modular height. A key observation of Faltings was that the height (5.5.14)
and the modular height are essentially equal. Thus the ﬁniteness principle
follows from the basic property of heights of points in a projective space:
there is only ﬁnite number of isomorphism classes of pairs (A, θ) over K
with bounded modular height of the corresponding points J(A, θ) (comp.
with §5.2.5).
The above three steps give only a hint of the strategy of the proof of the
ﬁniteness principle; carrying out this program in detail is a quite technical
task, see also the review of B. Mazur [Maz77].
5.5.7 Heights under isogenies and Conjecture T
By the ﬁniteness principle of §5.5.6, Conjecture T and the Mordell conjecture
follows from the boundedness |h(A) −h(B)| for K-isogenous varieties A and
B.

258
5 Arithmetic of algebraic varieties
The proof of this fact is deduced from theorems I and II given below.
Theorem I. Let p be a prime number unramiﬁed in K. There exists a ﬁnite set
M = M(K, p, g) of primes such that: if A is an Abelian variety of dimension
g over K with good reduction at all places of K dividing p, and S(A) is the set
of all primes divisible by the bad reduction places of A, then for each isogeny
A →B of the degree not dividing any prime in M we have that h(A) = h(B).
In particular, for an Abelian variety A over K there exists a ﬁnite set M
of primes such that there is only a ﬁnite set of Abelian varieties B over K
(up to K-isomorphism), which admit a K-isogeny A →B of the degree not
dividing primes in M.
Theorem II. Let A be an Abelian variety over K, l is a ﬁxed prime number.
Then the set of Abelian varieties B (up to K-isomorphism) which admit a
K-isogeny of degree lm (m ≥1) is ﬁnite.
The proofs of both theorems are based on explicit formulas for the be-
haviour of h(A) under isogenies. In the good case (Theorem I) the height
does not change because in this case one can deﬁne an isomorphism of the
corresponding modules with metrics ω(A) and ω(B) of the same degree.
The proof of theorem II proceeds by reductio ad absurdum. Suppose that there
is an inﬁnite sequence of K - isogenous Abelian varieties
A →B(1) →B(2) →· · · →B(n) →B(n+1) →· · · ,
such that the kernels Wn = Ker (A →B(n)) form an l-divisible group. Using
known results on the structure and properties of l-divisible groups, one proves
that the sequence h(B(n)) stabilizes from a suﬃciently large n0, and theorem
II follows by applying the ﬁniteness principle for the height.
The conjecture T follows from theorems I and II, since every isogeny A →
B can be decomposed into a composition of isogenies
A →B(0) →B(1) →B(2) →· · · →B(n) = B,
satisfying the following conditions:
a) the degree of A →B(0) does not divide any prime in the ﬁnite set M ∪
S(A) = {l1, l2, · · · , ln} of theorem I;
b) the degree of B(i−1) →B(i) is a power of a prime li.
According to Theorem I there are only ﬁnitely many possibilities for the
variety B(0) (up to K-isomorphism). Applying theorem II to the variety B(0)
and to the prime l1 shows that there are only ﬁnitely many possibilities for
the variety B(1). By induction, there are only ﬁnitely many possibilities for
B = B(n) (cf. [PZ88], pp.383-384).

5.5 The Theorem of Faltings and Finiteness Problems
259
This completes the proof of the Mordell conjecture, as well as the conjec-
ture T, the ﬁniteness conjecture of Shafarevich, and the conjecture of Tate for
Abelian varieties.
In §5.5.1 we have mentioned the second conjecture of Shafarevich.
This conjecture can be reformulated as a statement on the non-existence
of certain smooth proper schemes over SpecZ of relative dimension 1 and of
genus ≥1. Of course, the classical geometric analogue of this conjecture is
well known (and discussed in [Sha62] as a motivation).
Moreover, in the 80th J.-M. Fontaine [Fon81] and independently V.A. Ab-
rashkin (see in [PZ88]) proved that over the maximal orders in Q, Q(√−1),
Q(√−2), Q(√−3), Q(√−7), Q(
√
2), Q(
√
5), Q(
5√
1) there exist no smooth
proper Abelian schemes.

6
Zeta Functions and Modular Forms
6.1 Zeta Functions of Arithmetic Schemes
6.1.1 Zeta Functions of Arithmetic Schemes
(cf. [Sha69], [Se65]). Let X be a scheme of ﬁnite type over Spec Z (see §5.1).
Then the closed points x ∈X are those which satisfy the condition that the
corresponding residue ﬁeld R(x) is ﬁnite. The cardinality of R(x) is called the
norm of x and is denoted by N(x). The set of all closed points of X is denoted
by X. For the moment we shall think of this as a discrete topological space.
The zeta function of X is deﬁned to be the Euler product
ζ(X, s) =

x∈X
(1 −N(x)−s)−1.
(6.1.1)
In the case X = Spec Z deﬁnition (6.1.1) leads to the Riemann zeta function
ζ(s) in view of Euler's identity:
ζ(s) =
∞

n=1
n−s =

p
(1 −p−s)−1.
(6.1.2)
For an arithmetic scheme there are only ﬁnitely many points with a given
norm, so the product (6.1.1) is a formal Dirichlet series ∞
n=1 ann−s with
integral coeﬃcients.
Theorem 6.1. The product (6.1.1) is absolutely convergent for Re(s) >
dim X, where dim X is the dimension of X (see §5.2.1 of Chapter 5).
The proof of this fact can be reduced to the following special cases:
(a) X = Spec Z[T1, · · · , Tn]. The product then takes the form:
ζ(X, s) =

p
(1 −pn−s)−1 = ζ(s −n);
(6.1.3)

262
6 Zeta Functions and Modular Forms
(b) X = Spec Fq[T1, · · · , Tn]. We then have
ζ(X, s) = (1 −pn−s)−1 .
(6.1.4)
Equation (6.1.3) is implied by (6.1.4), which can in turn be obtained from the
following calculation of the number of closed points of an arbitrary variety X
over a ﬁnite ﬁeld Fq (q = pr).
Let nk = Card{x ∈X | N(x) = qk } be the number of closed points with
norm qk and νl = Card X(Fql) the number of geometric points with values in
Fql, i.e. the number of morphisms Spec Fql →X.
Lemma 6.2. The numbers νl and nk are ﬁnite and are related by the following
formula
νl =

k|l
knk.
(6.1.5)
This fact is implied by the observation that for a given x ∈X there are
precisely l/k ﬁeld embeddings Fqk →R(x).
We now obtain the following identities:
ζ(X, s) =
∞

k=1
(1 −q−ks)−nk,
(6.1.6)
log ζ(X, s) = −
∞

k=1
nk log(1 −q−ks)
= −
∞

k=1
∞

m=1
nk
q−kms
m
= −
∞

l=1
⎛
⎝
k|l
nk
k l,
⎞
⎠q−ls = −
∞

l=1
νll−1q−ls.
(Here we replaced the variable l by km, taking (6.1.5) into account.)
If X = Spec Fq[T1, · · · , Tn] then νl = qln (the number of points of the
aﬃne space An over Fql). Hence for q = p we have
log ζ(An
p , s) = −
∞

l=1
pln
l
· p−ls = −
∞

l=1
p−l(s−n)
l
= −log(1 −pn−s),
establishing (6.1.4).
In both cases (6.1.3) and (6.1.4) for Re(s) > dim X the product in (6.1.1)
converges absolutely.
Similarly we see that (cf. [Sha69])
ζ(Pn
Fp, s) =
n

m=0
(1 −p−(s−m))−1,
ζ(Pn
Z, s) =

p
n

m=0
(1 −p−(s−m))−1 =
n

m=0
ζ(s −m).
(6.1.7)

6.1 Zeta Functions of Arithmetic Schemes
263
6.1.2 Analytic Continuation of the Zeta Functions
It is thought that the functions ζ(X, s) can all be analytically continued onto
the entire s-plane C. The validity of this conjecture has been veriﬁed for
many varieties. However in the general case only the following weaker result
is known.
Theorem 6.3. The function ζ(X, s) has a meromorphic continuation to the
half plane Re(s) > dim X −1
2.
The singularities of ζ(X, s) in the strip dim X −1
2 < Re(s) < dim X are
described by the following theorem:
Theorem 6.4. Let us assume that X is irreducible and let R(X) be the
residue ﬁeld of its generic point. Then
1) If Char R(X) = 0 then the only pole of ζ(X, s) for Re(s) > dim X −1
2 is
at the point s = dim X, and this pole is simple.
2) If Char R(X) = p > 0 and q is the highest power of p such that R(X)
contains Fq then the only singularities of the function ζ(X, s) for Re(s) >
dim X −1
2 are simple poles at the points
s = dim X + 2πin
log q
(n ∈Z).
(6.1.8)
Corollary 6.5. For each non-empty scheme X the point s = dim X is a pole
of ζ(X, s), whose order is equal to the number of irreducible components of X
of dimension dim X.
Corollary 6.6. The domain of absolute convergence of the Dirichlet series
ζ(X, s) is the right half plane Re(s) > dim X.
Theorems 6.3 and 6.4 are deeper than Theorem 6.1. Their proof is based
on the analogue of the Riemann Hypothesis for curves X over Fq established
by Weil (cf. [Wei49]), see also [Se65], [Nis54], [LaWe].
6.1.3 Schemes over Finite Fields and Deligne's Theorem
If X is a scheme over Fq then for all x ∈X the ﬁeld R(x) is a ﬁnite extension
of Fq. Hence N(x) = qdeg x for some number deg x, called the degree of x. In
studying ζ(X, s) in this case it is convenient to use the new variable t = q−s.
We write
ζ(X, s) = Z(X, q−s),
(6.1.9)
where Z(X, q−s) is the power series given by the product

264
6 Zeta Functions and Modular Forms
Z(X, t) =

x∈X
(1 −tdeg x)−1.
If nk = Card{x ∈X | deg x = k} and νl = Card X(Fql) then we have
seen that
log Z(X, t) = −
∞

l=1
νl
tl
l ,
νl =

k|l
knk,
(6.1.10)
hence
tZ′(X, t)
Z(X, t) = td
dt log Z(X, t) =
∞

l=1
νltl.
(6.1.11)
Equation (6.1.10) is often taken as the deﬁnition of the zeta function, and one
writes
Z(X, t) = exp
! ∞

l=1
Card X(Fql)tl
l
"
.
(6.1.12)
A remarkable property of the zeta function Z(X, t) is its rationality in the
variable t. This was ﬁrst established by B.Dwork in [Dw59]. The rationality
statement has a direct arithmetical interpretation: the numbers νl, i.e. the
numbers of solutions of a certain system of algebraic equations in ﬁnite ﬁelds
must satisfy a recurrence relation of the type:
νl+n =
n−1

i=0
τiνl+i
for suﬃciently large l, where n and the τi are certain constants. It is easy
to check that the rationality of the function Z(X, t) is also equivalent to the
existence of ﬁnitely many complex numbers αi, βj such that
νl =

j
βl
j −

i
αl
i
(6.1.13)
for all l ≥1. Indeed, this is obtained from the logarithmic derivative of the
identity:
Z(X, t) =

i(1 −αit)

j(1 −βjt),
taking into account (6.1.11).
A fundamental role in the study of Z(X, t) is played by the fact the number
νk can be represented as the number of ﬁxed points of a certain map F k acting
on the set of geometric points X(Fq).

6.1 Zeta Functions of Arithmetic Schemes
265
Deﬁnition 6.7. The Frobenius morphism F : X →X of a scheme X over
Fq is deﬁned on each open aﬃne subscheme Spec A ⊂X using the ring
homomorphism a →aq; on the topological space X the morphism F acts as
the identity map.
The consequent self-map of sets of geometric points (not the same thing!)
is written
F : X(Fq) →X(Fq)
(6.1.14)
and the set X(Fqk) coincides with the set of ﬁxed points of F k : X(Fq) →
X(Fq): a point ϕ ∈X(Fqk) is represented by a morphism ϕ : A →Fq, where
Spec A is an open aﬃne subset containing ϕ(Spec Fq). The point F k(ϕ) is
deﬁned by the homomorphism
f →ϕ(f)qk
(f ∈A).
We see that the condition ϕ ∈X(Fk
q) is equivalent to saying that Im ϕ ⊂
Fqk ⊂Fq and ϕ(f) = ϕ(f)qk because Fqk = {x ∈Fq | x = xqk}.
The rationality of the zeta function was a part of a series of conjectures
stated by Weil in 1949. Dwork's proof of the rationality was a signiﬁcant step
towards proving these conjectures in general. The ﬁnal step was made by
Deligne in 1973 who proved the so called "Riemann Hypothesis" for algebraic
varieties X/Fq, cf. [Del74].
For a smooth projective variety X over Fq of dimension d the Weil con-
jectures can be stated as follows:
W1) Rationality:
Z(X, t) = P1(X, t) · . . . · P2d−1(X, t)
P0(X, t) · . . . · P2d(X, t) ,
(6.1.15)
where d = dim X and Pr(X, t) ∈C[t] for all r = 1, 2, . . . , 2d and
Pr(X, 0) = 1.
W2) Integrality:
P0(X, t) = 1 −t,
P2d(X, t) = 1 −qdt,
(6.1.16)
and for r = 1, 2, . . . , 2d we have that Pr(X, t) = (1 −ωr,it), where ωr,it)
are certain algebraic integers.
W3) The Functional Equation:
Z(X, 1/qdt) = ±qdχ/2tχZ(X, t),
(6.1.17)
where χ is the Euler characteristic of X, which can be deﬁned purely
algebraically as χ = (∆· ∆) (the self-intersection number of the diagonal
∆⊂X × X).

266
6 Zeta Functions and Modular Forms
W4) The Riemann Hypothesis: The absolute value of each of the numbers
ωr,it and their conjugates are equal to qr/2.
W5) Degrees of polynomials Pr(X, t): If X is the reduction of a smooth
projective variety Y deﬁned over a number ﬁeld embedded in C, then the
degree of Pr(X, t) is equal to the rth Betti number of the complex variety
Y (C).
In the case when X is a smooth projective curve over Fq these properties
were established by Weil, and in particular we have that
Z(X, t) =
L(t)
(1 −t)(1 −qt),
(6.1.18)
where L(t) =
2g

i=1
(1 −ωit) ∈Z[t] (g is the genus of the curve X), and |ω1| =
· · · = |ω2d| = √q. Using the relations (6.1.11) and (6.1.13) we have
Card X(Fqk) = qk + 1 −
2g

i=1
ωk
i ,
|Card X(Fq) −q −1| < 2g√q.
(6.1.19)
An elementary proof of the estimate (6.1.19) was found by Stepanov S.A.
(1974) in [Step74] (cf. [Step84], [Step94], [Bom72]).
The proof of the Weil conjectures is based on an idea from the theory of
compact topological varieties. If F is a morphism acting on such a variety
V then for the number ν(F) of ﬁxed points of F (appropriately deﬁned) the
famous Lefschetz ﬁxed-point formula holds:
ν(F) =
dim V

i=0
(−1)iTr F|Hi(V )
(6.1.20)
(the summands are the traces of the linear operators induced by F on the
cohomology groups Hi(V )). In this situation one can deﬁne an analogue of (the
logarithmic derivative of) the zeta function ∞
k=1 ν(F k)tk. It is not diﬃcult
to calculate the sum of this series. Let (αij)j=1,··· ,bi be the characteristic roots
of the linear operator Hi(F) = F|Hi(V ) on Hi(V ) and bi = dim Hi(V ) the
Betti numbers; then
Tr F k|Hi(V ) =
bi

j=1
αk
ij,
ν(F k) =
dim V

i=1
(−1)i
bi

j=1
αk
ij,
and hence

6.1 Zeta Functions of Arithmetic Schemes
267
∞

k
ν(F k)tk =
dim V

i=1
(−1)i
bi

j=1
 ∞

k
αk
ij

=
dim V

i=1
(−1)i
bi

j=1
αijt
1 −αijt
=
dim V

i=1
(−1)i
bi

j=1
t d
dt[log(1 −αijt)−1].
(6.1.21)
The series Z(t) is determined by the conditions Z(0) = 1 and
tZ′(t)
Z(t) =
∞

k=1
ν(F k)tk,
and it follows from (1.21) that
Z(t) =
dim V

i=1
⎛
⎝
bi

j=1
(1 −αijt)−1
⎞
⎠
(−1)i−1
.
We see that in this model situation the Z-function is rational and can
be calculated very explicitly. Using this fact Weil proposed conjectures W1)
- W4) and proved these conjectures for curves and Abelian varieties. For
these varieties he introduced an analogue of the group H1(X) and proved a
Lefschetz ﬁxed-point formula of the same type as in the topological situation.
The analogue of H1(X) is provided by the Tate module Tl(JX) of the Jacobian
variety of the curve X (resp. of the given Abelian variety). In the general case
analogues of the (topological) cohomology groups Hi were constructed by
Grothendieck (the étale cohomology groups Hi
´et(X, Ql)). In order to do this
he modiﬁed the very notion of a topological space, which was replaced by a
certain category (in the topological situation objects of this category are open
sets, and morphisms are inclusions). The larger category used by Grothendieck
was called the étale topology.
The use of the groups Hi
´et(X, Ql) and more generally cohomology groups
of sheaves (in the étale topology) made it possible for Deligne to prove the
conjectures of Weil (cf. [Del74], [Del80b] , [Kat76]).
6.1.4 Zeta Functions and Exponential Sums
([Kat76], [Kat88], [Sha69]). A traditional method for counting solutions of
congruences or systems of congruences is related to exponential sums. For-
mulae for the quantities νl = Card X(Fql) can be obtained using Dirichlet
characters χ : F×
q →C× (i.e. multiplicative characters of F×
q ). Let ε denote
the trivial character which is constant function 1 on the whole set Fq. If m
divides q −1 then one has the relation

268
6 Zeta Functions and Modular Forms
Card{x ∈Fq | xm = a} =

χm=ε
χ(a).
(6.1.22)
Now consider the Gauss sum of a non-trivial character χ,
g(χ) =

x∈F×
q
χ(x)ζTr(x),
where Tr : Fq →Fp is the trace and ζ is a primitive pth root of unity.
In the work of Hasse and Davenport of 1934 an interesting relation was
found between exponential sums over ﬁnite ﬁelds and zeros of zeta functions
(cf. [DH34]).
Example 6.8 (The zeta function of a hypersurface.). Let
X : a0T m
0 + a1T m
1 + · · · + anT m
n = 0
be a hypersurface in Pn over Fq, where a0, a1, . . . , an ∈F×
q and q ≡1 mod m.
Then we have that
Z(X, t) =
P(t)(−1)n
(1 −t)(1 −qt) · · · (1 −qn−1t)
(6.1.23)
where P(t) denotes the polynomial

χ0,χ1,··· ,χn

1 −(−1)n+1 1
q χ0(a−1
0 ) · · · χn(a−1
n )t

,
and χ0, χ1, · · · , χn run through all possible (n + 1)-tuples of Dirichlet charac-
ters satisfying the conditions
χi ̸= ε,
χm
i = ε,
χ0χ1 · . . . · χn = ε.
The proof of formula (6.1.23) is based on counting the quantities νl =
Card X(Fql) using relations between Jacobi sums and Gauss sums, and the
Davenport-Hasse relations: for a non - trivial character χ of Fq let us deﬁne
the character χ′ = χ◦N of the ﬁeld Fql, where N : Fql →Fq is the norm map.
Then the following relation holds:
−g(χ′) = (−g(χ))l.
(6.1.24)
Relation (6.1.24) makes it possible to ﬁnd explicitly the numbers αi and βj
such that for l ≥1 one has:
Card X(Fql) =

j
βl
j −

i
αl
i,
and (6.1.23) is then implied by (6.1.13).

6.1 Zeta Functions of Arithmetic Schemes
269
Classically estimates for exponential sums were used to obtain estimates
for the number of geometric points of varieties over ﬁnite ﬁelds. Conversely,
one can eﬀectively use the estimate W4) of the Weil conjectures to study
exponential sums of a rather general type. We give only a simple example
([Sha69], p.87).
Let f(T) ∈Fq[T], 0 < deg f = m < p and ζp = 1, ζ ̸= 1. Then the
following estimate holds:

p−1

x=0
ζf(x) ≤m√q.
(6.1.25)
In order to prove (6.1.25) let us consider an auxiliary curve yp −y = f(x).
Let us denote by X the curve obtained by a desingularization of its projective
closure. Consider the projection X
π→P1 given by (x, y) →x. Then

ξ∈X
(1 −N(ξ)−s)−1 =

x∈P
1

π(ξ)=x
(1 −N(ξ)−s)−1.
(6.1.26)
The equality π(ξ) = ∞is satisﬁed for a single point ξ ∈X and the corre-
sponding factor in the product (6.1.26) is equal to 1 −p−s. If π ̸= ∞then the
equation yp −y = f(x) is solvable in the ﬁeld Fp(x0) with ξ = (x0, y0) so that
there are exactly p solutions y0, y0 +1, . . . , y0 +p−1 with norm N(x0). In this
case the corresponding factor in the inner product is equal to (1−N(x)−s)−1.
The solvability of the equation yp −y = a in Fp(a) is equivalent to the condi-
tion
TrFp(a)/Fp(a) = 0, i.e.
deg a−1

i=0
api = 0,
or

i
f(x)pi =

i
f(xpi) =

P (x)=0
f(x),
where in the last sum x runs through all of the roots of the irreducible polyno-
mial P associated with a closed point π(ξ) ∈P
1\∞. Hence the inner product
in (6.1.26) can be transformed into the following
p−1

r=0
(1 −χ(P)rN(P)−s)−1,
where
χ(P) = ζλ(P ),
λ(P) =

P (x)
ζf(x),
N(P) = pdeg P .
Putting t = p−s we see that
Z(X, s) = (1 −t)

P
p−1

r=0
(1 −χ(P)rN(P)−s)−1,

270
6 Zeta Functions and Modular Forms
where P runs through all irreducible monic polynomials in Fp[t]. Extracting
the factors with r = 0 we obtain:
Z(X, t) =
1
(1 −t)(1 −pt)
p−1

r=1

P
(1 −χ(P)rN(P)−s)−1.
For each monic polynomial G we put
λ(G) =

G(x)=0
f(x),
χ(G) = ζλ(G).
The function χ is multiplicative, so we obtain the equation
Lr(t) =

P
(1 −χ(P)rtdeg P )−1 =

G
χ(G)rtdeg G.
One veriﬁes easily that Lr(t) is a polynomial and deg Lr(t) ≤deg f, and the
coeﬃcient of t is equal to

a∈Fp
χr(T −a) =

a∈Fp
ζrλ(T −a) =
p−1

a=0
ζrf(a).
However, each of these sums is equal to a sum of some (inverse) roots of the
function Z(X, t). The number of these roots is equal to deg Lr(t) ≤deg f, and
the absolute value of each root is less than or equal to √p, so that estimate
(6.1.25) follows.
Applications of cohomological techniques and of methods from representa-
tion theory to the study of exponential sums of general type were considerably
developed in the work of N.M.Katz [Kat76], [Kat88], [KL85], of Deligne and
other mathematicians in the 70s and 80s (cf. [Del74] , [Del80b], [Bry86] ).
In this research an exponential sum is interpreted as the trace of a certain
operator (the Frobenius operator or the monodromy operator) acting on the
space of global sections of a specially constructed sheaf on an algebraic vari-
ety. Thus, the general exponential sums can be constructed using cohomology
groups with compact support on an appropriate Artin-Schreier covering W
of an aﬃne variety V . Then estimates on the exponential sum can be re-
duced to the Weil estimate W4) applied to a smooth compactiﬁcation of W
provided that this compactiﬁcation exists (above we have considered an ex-
ample for curves). In the general case it is not even known whether such
compactiﬁcations exist. However this diﬃculty can be coped with using the
technology developed in the second part of Deligne's paper on the Weil con-
jectures [Del80b], which contains a vast generalization of these conjectures.
This generalization gives absolute values of the Frobenius elements acting on
cohomology with compact support on general varieties, whereas the original
formulation of the conjectures concerns essentially the constant sheaves on

6.1 Zeta Functions of Arithmetic Schemes
271
smooth projective varieties. Impressive examples of the use of Deligne's gen-
eralizations of the Weil conjectures were given by [Kat88] in the interesting
case of the multi-dimensional Kloosterman sums of type
Kl(p, n, a) =

x1,...,xn mod p
x1·...·xn≡a mod p
exp
2πi
p (x1 + · · · + xn)

,
by proving their important equidistribution properties with p ﬁxed and vary-
ing a. For an l-adic sheaf on an algebraic curve the equidistribution properties
of the traces of local Frobenius elements were naturally formulated in terms
of a certain algebraic group Ggeom over Ql which is deﬁned as the Zariski
closure of the image of the geometric fundamental group in the corresponding
l-adic representation. Under rather general assumptions on choice of an em-
bedding of Ql into C one obtains a complex algebraic group Ggeom(C), and the
Frobenius elements correspond to certain points in the space K♮of conjugacy
classes in a maximal compact subgroup K of Ggeom(C). The equidistribution
property is to be understood in the sense of a measure µ♮on K♮obtained
from the Haar measure on K. For the multi-dimensional Kloosterman sums
this construction leads to groups
Ggeom = Sp(n) for even n and arbitrary p,
Ggeom = SL(n) for odd pn,
Ggeom = SO(n) for p = 2 and odd n ≥3, n ̸= 7,
and
Ggeom = G2(n) for p = 2 and n = 7.
(6.1.27)
These methods can be used to study of the equidistribution of the argu-
ments of Gauss sums of the type
θ(a) = g(ψ, χa)
√q
=
1
√q

x∈F×
q
ψ(x)χa(x),
|θ(a)| = 1,
where ψ is a non-trivial additive character of Fq, χ a generator of the cyclic
group of multiplicative characters of F×
q and 1 ≤a ≤q −2. Katz also proved
that for a ﬁxed r ≥1 the r-tuple of angles (θ(a+1), θ(a+2), · · · , θ(a+r)) ∈
(S1)r for 0 ≤a ≤q −2 −r becomes equidistributed with respect to the Haar
measure on (S1)r as q →∞. An interesting related construction of the l-adic
Fourier transform for sheaves on An was suggested by Brylinski and Laumon
(cf. [Bry86], [KL85]).
These results are related to Sato-Tate Conjecture on the uniform distrib-
ution of the arguments ϕp of Frobenius automorphisms in the segment [0, π]
with respect to the measure 2
π sin2 ϕ dϕ (for cusp forms f without complex
multiplication) (cf. Chapter I in [Se68a], [Mich01] and §6.5.1). For recent de-
velopments we refer to [KS99], [KS99a], [Mich01], [Sar98].

6.2 L-Functions, the Theory of Tate and Explicite
Formulae
6.2.1 L-Functions of Rational Galois Representations
Let K be a number ﬁeld, ΣK its set of places (classes of normalized valuations)
and
ρ : GK −→GL(V )
(6.2.1)
a representation of the Galois group GK = Gal(K/K) in a ﬁnite dimensional
vector space V over a ﬁeld F of characteristic zero, which we shall usually
assume to be embedded in C (in examples and applications we shall use F =
Ql, C or Q). We call ρ unramiﬁed at a non-Archimedean place v if for all
places w of K dividing v one has ρ(I(w)) = {1V }, where I(w) is the inertia
group of w over v. In this case the representation ρ can be factorized through
the quotient group
G(w)/I(w) ∼= Gk(v) = Gal((OK/pw)/(OK/pv)),
where G(w) is the decomposition group of w over v and Gk(v) the Galois
group of the algebraic closure OK/pw of the residue ﬁeld k(v) = OK/pv. The
group Gk(v) is canonically generated by the Frobenius automorphism Frv,
Frv(x) = xNv. Choosing a diﬀerent place w above v will lead to the element
ρ(Frv) being replaced by a conjugate element. Hence the conjugacy class of
the Frobenius element Fv,ρ = ρ(Frv) is well deﬁned, and we write
Pv,ρ(t) = det(1V −t · Fv,ρ)
(6.2.2)
for the characteristic polynomial of this element. Suppose that E is a number
ﬁeld embedded in C. We call the representation ρ rational (resp. entire) over
E if there exists a ﬁnite number of places S ⊂ΣK such that
a) for all v ∈ΣK\S the representation ρ is unramiﬁed at v,
b) the coeﬃcients of Pv,ρ(t) belong to E (resp. to the maximal order OE of
E).
Let s be a complex number and v ̸∈S. We have
Pv,ρ(Nv−s) = det(1V −Nv−sFv,ρ) =
d

i=1
(1 −λi,vNv−s),
where d = dimK V and λi,v are algebraic numbers viewed as complex numbers
via a ﬁxed embedding i : Q →C.
Let us deﬁne the L-function of a rational representation:

6.2 L-Functions, the Theory of Tate and Explicite Formulae
273
L(ρ, s) =

v̸∈S
Pv,ρ(Nv−s)−1.
(6.2.3)
This is a formal Dirichlet series ∞
n=1 ann−s with coeﬃcients in E. In all
known cases there exists a real constant c such that |λi,ρ| ≤(Nv)c, which
implies the absolute convergence of the series (6.2.3) in the complex right half
plane Re(s) > 1 + c.
There are various methods of completing the product in (6.2.3) at places
v ∈S. The purpose of such a completion is to obtain an L-function satisfying
a certain nice functional equation. If v is a non-Archimedean place then one
considers the subspace V (v) consisting of elements ﬁxed by the inertia group
I(w) for w above v. If ρ is ramiﬁed at v then V (v) ̸= V (and possibly, V (v) =
{0}. The conjugacy class of ρ(Frv)|V (v) and its characteristic polynomial
Pv,ρ(t) = det(1V (v) −tFv,ρ|V (v))
are then well deﬁned, and the degree of the latter is smaller than d. Put
Lv(ρ, s) = Pv,ρ(Nv−s)−1.
If v is an Archimedean point then a good deﬁnition of Lv(ρ, s) depends on
an additional structure (e.g. a Hodge structure) on the vector space V . In this
case the v-factors can be expressed in terms of the following Γ-factors:
ΓR(s) = π−s/2Γ(s/2),
ΓC(s) = 2(2πi)−sΓ(s).
(6.2.4)
These factors play an important role in the study of the functional equa-
tions satisﬁed by L-functions. If we put
Λ(ρ, s) =

v
Lv(ρ, s),
(6.2.5)
then in important examples it is possible to prove that the function (6.2.5)
admits an analytic continuation onto the entire s-plane and satisﬁes a cer-
tain functional equation relating Λ(ρ, s) and Λ(ρ∨, k −s), where ρ∨is the
representation dual to ρ and k is a real number.
Example 6.9. If χ is a primitive Dirichlet character then in view of the Kro-
necker - Weber theorem there is associated to χ a one dimensional represen-
tation ρχ : GQ →C× such that
L(ρχ, s) =

p
(1 −χ(p)p−s)−1 = L(s, χ) =
∞

n=1
χ(n)n−s.
Let δ be zero or one so as to satisfy χ(−1) = (−1)δ. We then have that
Λ(ρχ, s) = Γ(s + δ)L(ρχ, s) = ξ(s, χ),

274
6 Zeta Functions and Modular Forms
and the following functional equation holds (cf. Ch.3 of [Shi71] and [Wei67]):
Λ(ρχ, 1 −s) = iδ

Cχ
g(χ) Λ(ρχ, s),
(6.2.6)
where Cχ is the conductor of χ and g(χ) is the Gauss sum of χ. The function
ξ(s, χ) is holomorphic on the entire s-plane for nontrivial characters χ. If χ is
trivial then ξ(s) = π−s/2Γ(s/2)ζ(s) has a simple pole at s = 1, and satisﬁes
the functional equation
ξ(1 −s) = ξ(s).
(6.2.7)
6.2.2 The Formalism of Artin
The deﬁnition of the L-functions L(ρ, s) described above is due to E.Artin
(cf. [Ar30]), who studied representations with a ﬁnite image Im(ρ). In this
situation the reprepresentation ρ is always E-rational for some number ﬁeld
E, and is semi-simple (by Maschke's theorem). Hence ρ is uniquely determined
(upto equivalence) by its character χρ (χρ(g) := Tr ρ(g), g ∈GK). If ρ is an
arbitrary rational representation then the function L(ρ, s) is uniquely deﬁned
by its character χρ. This can easily be seen by taking the logarithmic derivative
of the series (6.2.3)
L′(ρ, s)
L(ρ, s) = −

v̸∈S
d

i=1
∞

m=1
λm
i,v log(Nv)Nv−ms
= −

v,m
Tr(F m
ρ,v) log(Nv)
Nvms
,
(6.2.8)
where F m
ρ,v denotes the conjugacy class of the mth power of the Frobenius
element Fρ,v. In view of this fact one often uses the notation L(χρ, s) = L(ρ, s).
If
ρi : GK −→GL(Vi)
(i = 1, 2)
are two rational representations with characters χi = Tr ρi then one can
construct from them the further representations
ρ1 ⊕ρ2 : GK −→GL(V1 ⊕V2),
ρ1 ⊗ρ2 : GK −→GL(V1 ⊗V2).
(6.2.9)
whose characters are equal to χ1 + χ2 and χ1 · χ2 respectively, We have that
L(χ1 + χ2, s) = L(χ1, s)L(χ2, s).
(6.2.10)
If K′/K is a ﬁnite extension and ρ′ is a Galois representation of K′ with
character χ′, then one can deﬁne the induced representation ρ = Ind ρ′, whose
character is given by the formula:

6.2 L-Functions, the Theory of Tate and Explicite Formulae
275
χ(g) =

γ∈GK/GK′
χ′(γ−1gγ),
(6.2.11)
where γ runs over a full set of representatives of left cosets, and it is assumed
that χ′ is extended by zero to the whole group GK.
In this notation the following equation holds
L(ρ, s) = L(ρ′, s).
(6.2.12)
If K′/K is a ﬁnite Galois extension then GK′ is a normal subgroup of
ﬁnite index in GK. Then for any representation ρ of GK rational over E we
deﬁne its restriction to the subgroup GK′ : ρ1 = Res ρ, ρ1 : GK′ →GL(V ).
Then one has the following factorization formula due to Artin:
L(ρ1, s) =

χ∈Irr G(K′/K)
L(ρ ⊗ρχ, s)deg χ,
(6.2.13)
where the product is being taken over the set of characters χ of all irreducible
representations of the quotient group G(K′/K) = GK/GK′, deg χ = χ(1)
(it is assumed that the ﬁeld E contains all values of characters χ, which are
certain sums of roots of unity).
In the general case the representation ρ can always be replaced by its semi-
simpliﬁcation ˜ρ, which has the same character. In order to deﬁne this consider
the composition series
V = V (0) ⊃V (1) ⊃· · · ⊃V (m) = {0},
of ρ-invariant subspaces with irreducible factors V (i)/V (i+1) (0 ≤i ≤m −1).
Then the representation ˜ρ of GK in the space
˜V = V (0)/V (1) ⊕V (1)/V (2) ⊕· · · ⊕V (m−1)/V (m)
(6.2.14)
is semi-simple, E-rational and has the same character as ρ. Furthermore it is
uniquely determined (upto equivalence) by its character.
The representation ρ : GK −→GL(V ) is called Abelian if Im ρ is an
Abelian group. In this case we may consider ρ as a representation of the
group Gab
K = GK/Gc
K, where Gc
K is the commutator subgroup of GK (i.e. the
minimal closed subgroup containing all commutators), ρ : Gab
K −→GL(V ).
We have already seen in §5.3 certain examples of such representations (on
the Tate module Vl(E) of an elliptic curve with complex multiplication, and
on the one dimensional Tate module Vl(µ) = Ql(1) of l-primarily roots of
unity).
If Im ρ is a ﬁnite group (not necessarily Abelian) then for a ﬁnite Galois
extension K′/K one has Kerρ = GK′ and one uses the notation
L(s, χ, K′/K) = L(ρ, s),
(6.2.15)
where χ is the character of the corresponding representation

276
6 Zeta Functions and Modular Forms
ρ : Gal(K′/K) −→GL(V ).
The functions L(s, χ, K′/K) are usually called Artin L-functions; they can
be reduced to products of Abelian L-functions of extensions of K using the
formalism of Artin and the famous theorem of Brauer: if χ is a character of
a representation of a ﬁnite group G over C then there are cyclic subgroups
Gi ⊂G and one dimensional characters χi of Gi such that
χ =

aiIndG
Giχ
(ai ∈Z).
(6.2.16)
If G = G(K′/K) then Gi = G(K′/Ki) and it follows from the relations
(6.2.10) that
L(s, χ, K′/K) =

i
L(s, χi, K′/Ki)ai.
(6.2.17)
The analytic properties of Abelian L-functions are well known and they are
analogous to the corresponding properties of the Dirichlet L-series: all of the
functions L(s, χi, K′/Ki) can be meromorphically continued onto the entire
complex plane, possibly with a simple pole at s = 1 for trivial characters
χi. This implies the existence of a meromorphic analytic continuation of ar-
bitrary Artin L-functions. The famous Artin conjecture says that for a non-
trivial irreducible character χ of G = G(K′/K) the function L(s, χ, K′/K) is
always holomorphic. (Note that another famous Artin's Conjecture (on prim-
itive roots) was discussed in §1.1.4).
However this conjecture seems to be very diﬃcult in general, as is the
generalized Riemann hypothesis which says that all zeroes of the function
L(s, χ, K′/K) lying in the strip 0 < Re(s) ≤1 are actually on the line Re(s) =
1
2. The diﬃculty with the Artin conjecture is related to the fact that one lacks
the non-local deﬁnition of the Dirichlet series representing (6.2.17). In the
Abelian case such a description follows from the fact that the coeﬃcients of
the Dirichlet series are "periodic" modulo a positive integer (or modulo an
integral ideal of a number ﬁeld). However in a number of interesting cases the
Artin conjecture has been proved using the Mellin transforms of automorphic
forms. A general global description of Artin L-series in terms of automorphic
forms is given by the Langlands program (cf. §6.4, 6.5).
6.2.3 Example: The Dedekind Zeta Function
Let X = Spec OK where OK is the maximal order of K. The Dedekind zeta
function of K is the following Euler product
ζK(s) = ζ(X, s) =

p⊂OK
(1 −Np−s)−1,
which is absolutely convergent for Re(s) > 1 and admits a meromorphic con-
tinuation onto the entire complex plane. The continuation is holomorphic with

6.2 L-Functions, the Theory of Tate and Explicite Formulae
277
the exclusion of a simple pole at s = 1. The residue of ζK(s) at s = 1 is known
to be equal to (cf. [BS85], [Wei74a])
Ress=1ζK(s) = hK2r1(2π)r2
RK
wK

|DK|
,
(6.2.18)
where hK is the class number of K, RK is its regulator, DK its discriminant,
wK the number of roots of unity in K and r1 (resp. r2) the number of real
(resp. complex) places of K. Therefore
K ⊗R ∼= Rr1 ⊕Cr2.
From the point of view of L-functions the function ζK(s) corresponds to the
trivial Galois representation of the group GK. It therefore follows from Artin's
factorization formula that
ζK(s) = ζ(s)

χ∈Irr G(K/Q)
L(s, χ, K/Q)deg χ,
(6.2.19)
where the product is taken over all non-trivial irreducible representations of
the group G(K/Q). If the extension K/Q is Abelian then (6.2.19) implies the
following class number formula:
hK =
wK

|DK|
2r1(2π)r2RK

χ̸=ε
L(1, χ),
(6.2.20)
since Res ζ(s) = 1. It is not diﬃcult to compute the values L(1, χ): let Cχ be
the conductor of χ. Then
a) for χ(−1) = −1 one has
L(1, χ) = iπg(χ)
C2χ

(k,Cχ)=1
0<k<Cχ
kχ(k);
(6.2.21)
and
L(0, χ) = −1
Cχ

(k,Cχ)=1
0<k<Cχ
kχ(k); in particular L(0, χ3) = −1
6
(6.2.22)
for χ3(d) =
d
3

(comp. with the functional equation given by the equal-
ity (6.2.6), and see also [Hi93], p.66); the equality (6.2.22) is used in §7.2
expressing the constant term of an Eisenstein series of weight one.
b) for χ(−1) = 1, χ ̸= ε one has

278
6 Zeta Functions and Modular Forms
L(1, χ) = −g(χ)
Cχ

(k,Cχ)=1
0<k<Cχ
χ(k) log |1 −ζ−k|,
(6.2.23)
where ζ = exp(2πi/Cχ) is a primitive root of unity of degree Cχ and g(χ)
is the Gauss sum of χ.
Formulae (6.2.21) and (6.2.23) give essential information on the class num-
ber, the regulator, and the structure of the class group ClK of an Abelian ﬁeld
K, in particular when K is quadratic or cyclotomic (cf. [BS85]).
For a quadratic ﬁeld of discriminant D = DK > 0 we have
hK = −
1
log ε

(k,D)=1
0<k<D/2
χ(k) log sin(πk/D),
(6.2.24)
where ε is the fundamental unit of K with ε > 1.
If D = DK < −4 then
hK = −1
|D|

(k,D)=1
0<k<|D|
kχ(k) = (2 −χ(2))−1

(k,D)=1
0<k<|D|/2
χ(k),
(6.2.25)
and for the remaining ﬁelds K = Q(√−1), Q(√−3) one has hK = 1 (Dirich-
let's class number formula).
We mention that there exists a purely arithmetical proof of the formula
(6.2.25) in the case D ̸≡1 mod 8 found by B.A.Venkov (cf. [V81]).
The number
κK = Ress=1ζK(s) = hK2r1(2π)r2
RK
wK

|DK|
has a geometric interpretation as the volume of a fundamental domain for K×
in J1
K with respect to the measure on the group J1
K = {x ∈JK | ∥x∥= 1},
which comes from the normalized Haar measure µ× on the group JK (see
§4.3).
6.2.4 Hecke Characters and the Theory of Tate
([La70], [CF67], [Wei74a]). The Abelian L-functions of a number ﬁeld K
can be described using class ﬁeld theory, which states in particular that
there is a one-to-one correspondence between irreducible complex represen-
tations of the group Gab
K and characters of ﬁnite order of the idele class
group CK = JK/K×. In the classical theory these characters are known
as "periodic" characters of the group of fractional ideals of K. For any in-
tegral ideal m ⊂OK write S = S(m) for the ﬁnite set of places of K
given by S = S(m) = {v ∈ΣK | v divides m} ∪Σ∞
K , where Σ∞
K is the set

6.2 L-Functions, the Theory of Tate and Explicite Formulae
279
of Archimedean places of K. Let I(S) be the free Abelian group generated by
the ﬁnite places prime to m and let
P (m) = {x ∈K | x ≡1(mod mOv) for v ∈S}.
(6.2.26)
Then for each one dimensional representation ρ : Gab
K →C× there exists
an integral ideal m and a character χ : IS →C× trivial on the subgroup
(P (m)) of principal ideals of type (x), x ∈P (m) such that ρ(Frv) = χ(pv).
The generalized Dirichlet L-series are then deﬁned by
L(s, χ) =

v̸∈S
(1 −χ(pv)Np−s
v )−1 =

n : n+m=OK
χ(n)Nn−s,
(6.2.27)
where n runs through the integral ideals coprime to m.
Hecke has introduced a new class of characters and L-functions, which, in
principle, can not be reduced to L-functions of rational Galois representations.
These characters are associated to arbitrary continuous homomorphisms
ψ : JK/K× −→C×
(6.2.28)
and they can be described in classical terms as follows: there exists m ⊂OK
and a homomorphism χ : IS →C× such that for all x ∈P (m) one has
χ((x)) =

v|∞
 τvx
|τvx|
av
|x|itv
v N((x))σ,
(6.2.29)
where τv : K →C× is the complex embedding which deﬁnes v; |x|v =
|τvx|[Kv:Q] the corresponding normalized norm; tv and σ ∈R; av ∈Z for
Kv ∼= C, av = 0 or 1 for Kv ∼= R. Since χ((x)) depends only on (x) the right
hand side of (6.2.29) must equal 1 for all ε ∈P (m) ∩EK. The ideal m can be
maximally chosen for the above condition; this ideal is called the conductor of
χ and is denoted by m = f(χ). The above condition χ((ε)) = 1 imposes some
restriction on the choice of numbers tv, σ and av. One veriﬁes that these con-
ditions deﬁne a subgroup of (Z/2Z)r1 ⊕Zr2 ⊕Rr1+r2 ⊕R which is isomorphic
to (Z/2Z)r1 ⊕Zr2 ⊕Qr1+r2−1 ⊕R.
A correspondence between χ and ψ is deﬁned using the homomorphism
which takes an idele to its divisor (cf. [CF67], Chapter 8)
divS : JK →I(S),
(xv)v →

v
pv(xv)
v
=

v
v(xv) · v,
(6.2.30)
and using an appropriate section π : I(S) →JK which is deﬁned by a choice
of local uniformizing parameters πV ∈OK (v(πv) = 1 for v ̸∈S): by this
section a prime ideal pv goes to the idele π(v) = (· · · , 1, πv, 1, · · · ) whose v-
coordinate is πv and whose other coordinates are 1. Then the character ψ
corresponds to a unique χ such that χ(pv) = ψ(π(v)), and this is a one-to-one
correspondence.

280
6 Zeta Functions and Modular Forms
Example 6.10. 1) If ψ(x) = ∥x∥s = ωs(x), then m = OK and
χ(pv) = Nps
v,
tv = Im s,
σ = Re s.
(6.2.31)
2) If K is an imaginary quadratic ﬁeld, K ⊂C, then for an arbitrary χ there
exists m such that
χ((x)) =
 x
|x|
av
|x|s = xa|x|s−a,
(6.2.32)
(for all x ∈K, x ≡1(mod m)).
3) If K is a real quadratic ﬁeld, K ⊂R, then
χ((x)) = x2πiρ/ log ε|x|s
(6.2.33)
for x ≡1(mod m), x, x′ > 0, ρ ∈Q, where ε is a fundamental unit in K
and x →x′ is the quadratic conjugation.
The interpretation of Hecke characters as certain characters of the idele
class group was given by C.Chevalley (cf. [Chev40]).
Tate constructed in his thesis a general theory which makes it possible in
particular to establish analytic continuation and a functional equation for all
functions of type L(s, χ). We describe brieﬂy the key points of this theory,
which is based on Fourier analysis in number ﬁelds ([La70], [Ta65]).
Every continuous character ψ : JK/K× →C× may be regarded as a
function on JK and it can be decomposed into a product ψ(x) = 
v ψv(xv),
where ψv : K×
v →C× are quasicharacters (i.e. continuous homomorphisms to
C×) such that for almost all v the quasicharacter ψv is unramiﬁed: ψv(O×
v ) = 1
and in view of the continuity one has ψv(xv) = |xv|σ
v. The number σ = Re ψv
is called the real part of ψv.
The ﬁrst stage in Tate's theory is to obtain a representation for a local
factor of the Hecke L-function
L(s, χ) =

v̸∈S
(1 −χ(pv)Np−s
v )−1 =

n : n+m=OK
χ(n)Nn−s,
(6.2.34)
as a certain integral over the locally compact group K×
v with respect to the
Haar measure µ× normalized by the condition µ×(O×
v ) = 1.
Let c : K×
v →C× be an unramiﬁed quasicharacter. We use the decomposi-
tions K×
v = 1
n∈Z πn
v O×
v and Ov\{0} = 1
n∈Z,n≥0 πn
v O×
v in order to calculate
the integral

Ov\{0} c(x) dµ×
v (x). Consider ﬁrst the integral

πn
v O×
v c(x) dµ×
v (x)
and put x = πn
v ε with ε ∈O×
v . Then

πn
v O×
v
c(x) dµ×
v (x) = c(πn
v )

O×
v
c(ε) dµ×
v (ε)

= c(πv)n
in view of the invariance of dµ×
v (x) under multiplicative shifts: dµ×
v (πnx) =
dµ×
v (x).

6.2 L-Functions, the Theory of Tate and Explicite Formulae
281
If Re c > 0 then it follows that c is integrable on Ov\{0} = ∪n∈Z,n≥0πn
v O×
v
and one has

Ov\{0}
c(x) dµ×
v (x) =

n≥0

πn
v O×
v
c(x) dµ×
v (x) =

n≥0
c(πv)n = (1 −c(πv))−1.
(6.2.35)
If c = ψvωs then c(πv) = χ(pv)Np−s
v
in view of (6.2.29), and the expression
(6.2.35) becomes the local factor of the L series (6.2.34).
The essential fact is that the whole product (6.2.34) can also be inter-
preted as a certain integral over a locally compact group with respect to an
invariant Haar measure. The set Ov\{0} in (6.2.35) refers more to an addi-
tive theory than to a multiplicative theory. This combination of additive with
multiplicative theories is a characteristic feature of Tate's theory.
Let G be a locally compact group with a Haar measure µ; denote by L1(G)
the vector space of all integrable functions on G. If µv is the Haar measure
on the additive group Kv normalized by the condition µv(Ov) = 1 then a
calculation analogous to (6.2.35) shows that
dµ×
v (x) = (1 −Np−1
v )−1 dµv(x)
|x|v
(6.2.36)
in view of the multiplicative invariance of the measure dµv(x)/|x|v. In particu-
lar, the condition f ∈L1(K×
v ) is equivalent to saying that f(x)/|x|v ∈L1(Kv).
Let us introduce the following notation: for a quasicharacter c : K×
v →C×
and f ∈L1(Kv)
ζv(f, c) =

Kv
f(x)c(x) dµ×
v (x)
(6.2.37)
and suppose that fc ∈L1(K×
v ) for Re c > 0. Let f = δOv\{0} be the charac-
teristic function of the set Ov\{0} and c an unramiﬁed quasicharacter. Then
for Re(ψvωs) > 0 one has the following expression for the local ζ-factor:
ζv(f, ψvωs) = (1 −χ(pv)Np−s
v )−1.
In order to obtain a global analogue of this expression let us consider a
function f(x) = 
v fv(xv) on the additive group of adeles AK such that
fv(x) ∈L1(Kv) and fv = δOv\{0} for non-Archimedean places v ̸∈S. For a
quasicharacter c : JK/K× →C× we shall set
ζ(f, c) =

JK
f(x)c(x) dµ×(x) =

v

Kv
f(xv)c(xv) dµ×
v (xv).
(6.2.38)
Then the calculation (6.2.35) implies that
ζ(f, ψωs) = L(s, χ)

v∈S
ζv(fv, ψvωs),
(6.2.39)

282
6 Zeta Functions and Modular Forms
and one easily veriﬁes that under our assumptions the integral and the product
are absolutely convergent for Re(ψvωs) > 1. An analytic continuation for the
function L(s, χ) is constructed using the integral representation (6.2.38) in
which all auxiliary factors can be reduced (in our applications) to Γ-functions
and to Gauss sums.
The technique of analytic continuation is based on tools from the theory
of additive Fourier transforms over the group AK. The following are the key
points:
I) A choice of duality. Let us ﬁx an additive character
λ : AK/K −→C×,
λ(x) =

λv(xv),
where one usually puts:
λv(xv) =
⎧
⎪
⎨
⎪
⎩
exp(−2πixv)
if Kv ∼= R,
exp(−4πiRe xv)
if Kv ∼= C,
exp(−2πi{TrKv/Qpxv})
if [Kv : Qp] < ∞.
(6.2.40)
Then the following isomorphisms of locally compact groups are deﬁned:
Kv ∼= ˆ
Kv,
AK ∼= ˆAK,
(where ˆKv, ˆAK denote the corresponding groups of (continuous) charac-
ters). These isomorphisms are constructed as follows:
x →(χx : y →λ(yx))
(x, y ∈AK),
xv →(χxv : y →λv(yxv))
(x, y ∈Kv).
II) Self-dual measures. One chooses normalized measures ˜µv and ˜µ = 
v ˜µv
such that for the Fourier transforms
ˆf(x) =

AK
f(y)λ(xy) d˜µ(y),
ˆfv(xv) =

Kv
fv(y)λv(xvy) d˜µv(y)
(6.2.41)
the inversion formulae can be written in the following form:
ˆˆf(−x) = f(x),
ˆˆfv(−xv) = f(xv).
(6.2.42)
provided fv ∈L1(Kv), f ∈L1(AK).
If v is a non-Archimedean place then let δv ⊂Ov denotes the local diﬀerent,
δ−1
v
= {x ∈Kv | λv(xy) ∈Z for all y ∈Ov}.
(6.2.43)
Then the self-dual measure is deﬁned as follows:

6.2 L-Functions, the Theory of Tate and Explicite Formulae
283
˜µv =
⎧
⎪
⎨
⎪
⎩
Nδ−1/2
v
µv
if v is non-Archimedean,
dx
(Lebesgue measure)
if Kv ∼= R,
2dx dy
if z = x + iy ∈Kv ∼= C.
(6.2.44)
The important property of the self-dual measure is that ˜µ(AK/K) = 1;
also one has δv = δKOv and NδK = |DK|.
In concrete examples the following orthogonality relation is often used: for
each character λ of a compact group G

G
λ(x) dµ(x) =

µ(G)
if λ = id,
0
otherwise.
(6.2.45)
This implies the following important formula:

Ov
λv(xy) d˜µv(y) = δδv(x) · ˜µv(Ov).
III) The Poisson summation formula. Let f be a continuous function on AK
such that both |f| and | ˆf| are summable over the subset K ⊂AK and
the series 
α∈K f(x + α) converges uniformly on every compact subset
of AK. Then the following summation formula holds:

α∈K
f(α) =

α∈K
ˆf(α).
(6.2.46)
Corollary. Under the above assumptions for all a ∈JK the following holds

α∈K
f(aα) = ∥a∥−1 
α∈K
ˆf(a−1α).
(6.2.47)
Now we turn to main application of the summation formula: the proof of
the functional equation for the ζ-functions. We assume that for all σ > 1
the function |f(x)| ∥x∥σ is integrable over the group of ideles JK. Then for
Re(ψωs) > 1 the following integral is well deﬁned:
ζ(f, ψωs) =

JK
f(x)ψωs(x) dµ×(x).
(6.2.48)
Theorem 6.11. The function ζ(f, ψωs) admits an analytic continuation onto
the entire complex plane and it satisﬁes the functional equation:
ζ(f, ψωs) = ζ( ˆf, ψ−1ω1−s).
(6.2.49)
To prove the theorem we decompose the integral into two parts:
ζ(f, c) =

∥x∥≥1
f(x)c(x) dµ×(x) +

∥x∥≤1
f(x)c(x) dµ×(x) (with c = ψωs).

284
6 Zeta Functions and Modular Forms
In view of the assumption on f the ﬁrst integral converges for all c. Let us
transform the second integral using the Poisson summation formula. We have

∥x∥≤1
f(x)c(x) dµ×(x) =

t∈JK/J1
K

J1
K
f(tx)c(tx) dµ1(x)

dν,
where dµ1(x) is the measure on J1
K which is compatible with the Haar measure
dν(t) = |dt/t| on R×
+ and the original measure dµ× under the isomorphism
JK/J1
K ∼= R×
+. The inner integral on the right hand side transforms into the
following sum

J1
K
f(tx)c(tx) dµ1(x) =

C1
K
 
α∈K×
f(txα)c(txα)

dµ1(x)
where we denote by the same symbol dµ1(x) the measure on C1
K induced by
dµ1(x) on J1
K. Now the inner sum transforms using (6.2.46) as follows:
c(tx)

α∈K×
f(txα) = c(tx)
 
α∈K
f(txα) −f(0)

= c(tx)

∥tx∥−1 
α∈K
ˆf(t−1x−1α) −f(0)

= c(tx)

∥tx∥−1 
α∈K×
ˆf(t−1x−1α) + ∥tx∥−1 ˆf(0) −f(0)

.
We now change variables by putting u = t−1, y = x−1; the measure in J1
K
does not change. Putting the resulting expression into the integral, and using
the notation c1 = ω1c−1 = ψ−1ω1−s, the integral over ∥x∥≤1 becomes the
following

∥x∥≤1
f(x)c(x) dµ×(x) =

∥x∥≥1
ˆf(x)c1(x) dµ×(x)
+

|t|≤1

CK
c(tx)

∥tx∥−1 ˆf(0) −f(0)

dµ1 dν.
This proves the theorem.
As an example of this general calculation let us deduce the classical func-
tional equation for the Dedekind zeta function of a number ﬁeld K. Set
fv = δOv for non-Archimedean v,
fv(x) =

exp(−πx2)
for Kv ∼= R,
exp(−2π|z|2)
for Kv ∼= C.
Then one has

6.2 L-Functions, the Theory of Tate and Explicite Formulae
285
ζv(fv, s) = ζv( ˆfv, s) = ΓKv(s) (Kv ∼= R, C)
and we obtain the following expressions for the global integrals (ζ-functions):
ζ(f, ωs) = Γ r1
R (s)Γ r2
C (s)ζK(s),
ζ( ˆf, ω1−s) = |GK|(1/2)−sΓ r1
R (1 −s)Γ r2
C (1 −s)ζK(1 −s),
which implies in view of (6.2.49) the following functional equation:
ΛK(s) = ΛK(1 −s),
(6.2.50)
where
ΛK(s) = |DK|s/2Γ r1
R (s)Γ r2
C (s)ζK(s).
In the general case of arbitrary quasicharacters we may and we shall as-
sume that 
v|∞tv = 0 (by replacing s if necessary). Put
Lv(s, χ) =

ΓR(s + itv −|av|)
for Kv ∼= R,
ΓC(s + itv −|av|/2)
for Kv ∼= C,
Dχ = |DK|Nf(χ).
Let gv(χ) = 
ε(χvλv)(επ−v(χ)) denote the Gauss sum, where {ε} runs over a
system of coset representatives for O×
v /(1 + f(χ)Ov) with v(χ)
def
= v(f(χ)) > 0.
Then the following functional equation holds:
W(χ)Λ(s, χ) = Λ(1 −s, χ),
(6.2.51)
in which
Λ(s, χ) = Ds/2
χ

v|∞
Lv(s, χ) · L(s, χ),
(6.2.52)
and W(χ) is a complex constant with absolute value 1 given by
W(χ) = iMNf(χ)−1/2 
v∈Sχ
gv(χ)

v̸∈Sχ
χ(δ−1
v )
where Sχ = {v | pv divides f(χ)} and M = 
v|∞|av|.
6.2.5 Explicit Formulae
(cf. [La70], [Wei52b], [Wei72], [More77]). We already mentioned in chapter 1
a link between the zeroes of the Riemann zeta function and the behaviour of
the function π(x) = 
p<x 1, p being prime numbers. This link is expressed by
an explicit formula for the function ∞
i=1
1
i π(x1/i) in terms of the non trivial

286
6 Zeta Functions and Modular Forms
zeroes of ζ(s), i.e. those zeroes in the critical strip 0 ≤Re s ≤1 (the Riemann
- Mangoldt formula), see Part I, §1.1.6.
A generalization of this formula for Hecke L-series Λ(s, χ) (see deﬁnition
(6.2.52)) was proposed by Weil, and is based on the Weierstrass product ex-
pansion of this function over its zeros.
Let us assume that Re χ = 0 and the normalizing condition 
v|∞tv = 0
is satisﬁed (see (6.2.51)). Put δχ = 1 if χ ≡1 and 0 otherwise. Then it follows
from the functional equation (6.2.49) that the function
[s(s −1)]δχΛ(s, χ)
is an entire function of order 1. Hence by a general theorem from the theory of
functions of one complex variable one has the following Weierstrass product
expansion of this function over its zeros:
Λ(s, χ) = aχebχs[s(s −1)]−δχ 
ω

1 −s
ω

es/ω,
(6.2.53)
where ω = α+iγ runs over the set of all zeroes of the function Λ(s, χ) counting
multiplicities, and aχ and bχ are certain constants. The main result on explicit
formulae for the L-functions Λ(s, χ) can then be stated as an equation relating
a linear combination of the values of a certain function over (logarithms of
norms of) powers of prime ideals, to the sum of the Mellin transform of this
function over the zeroes of the L-function (6.2.53).
Let us consider a complex valued function F : R →C with the property
that there exists a constant a > 0 such that
F(x)e((1/2)+a)|x| ∈L1(R).
Then the Mellin transform
Φ(s) =
 +∞
−∞
F(x)e(s−1
2 )x dx
is a function which is holomorphic in the strip −a ≤Re s ≤1+a. We assume
that the function F(x) satisﬁes the following conditions:
A) The function F(x) has continuous derivative everywhere apart from a
ﬁnite number of points αi, at which both F(x) and F ′(x) have only breaks
of the ﬁrst kind, and F(αi) = 1
2[F(αi + 0) + F(αi −0)].
B) For some number b > 0 the following estimates hold as |x| →∞:
F(x) = O(e−((1/2)+b)|x|),
F ′(x) = O(e−((1/2)+b)|x|).

6.2 L-Functions, the Theory of Tate and Explicite Formulae
287
Then we have that Φ(s) = O(|t|−1) uniformly in the strip −a′ ≤σ ≤1+a′
if 0 < a′ < b (σ = Re s, t = Im s).
The explicit formula. With the above notation and assumptions consider
the sum

|t|<T
Φ(ω)
extended over all zeroes ω = β+it of the function L(s, χ) satisfying 0 ≤β ≤1,
|t| < T. Then as T →∞this tends to a limit, which is equal to
lim
T →∞

|t|<T
Φ(ω) =δχ
 +∞
−∞
F(x)

e
x
2 + e−x
2 
dx
+ F(0) log Aχ
−

p,n
log Np
Npn/2 [χ(p)nF(log Npn) + χ(p)−nF(log Np−n)]
−

v|∞
Wv(Fv),
(6.2.54)
where Aχ = 2−r1(2π)−r2DχNf(χ),
Fv(x) = F(x)e−itvx/nv
(nv = [Kv : R]),
and Wv is the functional uniquely deﬁned by the property
Wv(g) = lim
λ→∞
; +∞
−∞
(1 −e−λ|x|)Kv(x)g(x) dx −2g(0) log λ
<
.
Here the function Kv(x) is deﬁned by
Kv(x) =
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩
e−(1/2)|avx|
|ex/2 −e−x/2|
for Kv ∼= R (nv = 2),
e−((1/2)−|avx|)
|ex −e−x|
for Kv ∼= C (nv = 1).
The explicit formula (6.2.54) is a rich source of possibilities for studying
very ﬁne points in the distribution of prime ideals in number ﬁelds and the
images of the corresponding Frobenius elements in Abelian Galois represen-
tations. We mention that there is an analogue of these formulae in the case
of global ﬁelds of positive characteristic (the function ﬁeld case). This gen-
eralization makes it possible to obtain some very precise estimates for the
numbers of points on curves over ﬁnite ﬁelds, and has some other interesting
applications (cf. [Se83], [Step99], [TsVl91]).
The logical structure of the proof of (6.2.54) is quite simple and is based
on studying the integral of the function Φ d log Λ(s, χ) along a special contour

288
6 Zeta Functions and Modular Forms
using two explicit expressions for the logarithmic derivative Λ′(s, χ)
Λ(s, χ) arising
from the Euler product deﬁning L(s, χ) and from the Weierstrass product
formula (6.2.53). One uses only the following results of an arithmetical nature:
a) The boundedness of the |L(s, χ)| in each right half plane of type Re(s) ≥
1 + a, a > 0.
b) The functional equation (6.2.51) for Λ(s, χ).
c) The boundedness of the function Λ(s, χ) in every strip σ0 ≤Re(s) ≤σ1
excluding a ﬁnite number of poles.
6.2.6 The Weil Group and its Representations
(cf. [Ta79], [Wei74a]). We wish to discuss a general construction which makes
it possible to treat at the same time representations of Galois groups and
quasicharacters of number ﬁelds, and their L-functions. This construction is
based on the notion of the Weil group, which we brieﬂy discuss now.
Let F be a local or global ﬁeld and F s its separable algebraic closure. For
a ﬁnite extension E/F in F s let GE = Gal(F s/E) be the corresponding open
subgroup. Let
CE =

JE/E×
if E is a global ﬁeld,
E×
if E is a local ﬁeld.
The relative Weil group WE/F can be described as a group extension
0 →CE →WE/F →Gal(E/F) →0,
(6.2.55)
whose isomorphism class is deﬁned by the canonical generator αE/F of the
cohomology group H2(Gal(E/F), CE) = ⟨αE/F ⟩given by class ﬁeld theory
(see §4.4).
There is also a more invariant deﬁnition which makes it possible to treat
all extensions E/F at the same time (cf. [Ta79]).
The absolute Weil group WF is deﬁned as a topological group endowed
with a continuous homomorphism ϕ : WF →GF with dense image, which
satisﬁes the following additional conditions ([Ta79], p. 74-75):
W1) There exist isomorphisms rE : CE
∼
→W ab
E for which WE = ϕ−1(GE) for
all ﬁnite extensions E and W ab
E = WE/W c
E, W c
E being the minimal closed
subgroup of WE containing all its commutators. These isomorphisms sat-
isfy the following condition: the composition
CE
rE
∼
→W ab
E
ϕ
−→Gab
E
coincides with the homomorphism of class ﬁeld theory.

6.2 L-Functions, the Theory of Tate and Explicite Formulae
289
W2) Let w ∈WF and σ = ϕ(w) ∈GF . Then for each E the following
diagram commutes:
CE
rE
−→W ab
E
isomorphism,
induced by σ
⏐5
⏐5
conjugation
by w
CEσ rEσ
−→W ab
Eσ
W3) For E′ ⊂E the following diagram commutes:
CE′
rE′
−→W ab
E′
homomorphism, induced
by the inclusion E′⊂E
⏐5
⏐5
transfer,
see (4.4.18)
CE
rE
−→W ab
E .
W4) The natural map
WF →WE/F
def
=
WF /W c
E
deﬁnes an isomorphism
WF ∼= lim
←−
E
WE/F .
It is not diﬃcult to verify that this is equivalent to the previous deﬁnition.
The group WF can be constructed starting from the above relative Weil
groups WE/F using certain functorial properties of the classes αE/F . From
the existence of WF with properties W1) - W4) one can deduce all the main
theorems of class ﬁeld theory (in both local and global cases).
Also, there exists a homomorphism w →∥w∥of WF to R×
+ which corre-
sponds under the isomorphism rF : CF
∼
→W ab
F
to the norm homomorphism
to R×
+ of the idele class group CF = J×
F /F × in the global case, and to the
normalized absolute value of CF = F × in the local case. In view of the relation
∥NE/F α∥F = ∥α∥E the restriction of this norm function ∥w∥on WF to the
subgroup WE coincides with the corresponding norm function for WE, so that
we can omit the index E. One veriﬁes that the kernel of the homomorphism
w →∥w∥is compact.
The relation between the local and global Weil groups. Let F be a global
ﬁeld and v a place of F extended to F. Then there exists a natural embedding
θv : WFv →WF which is compatible with the inclusions iv : GFv →GF and
Ev →CE for all E/F, [E : F] < ∞.
Representations of the Weil groups. Denote by M(G) the set of isomor-
phism classes of ﬁnite dimensional complex representations ρ : G →GL(V )
of a topological group G. A one dimensional representation χ : G →C× will
be called a quasicharacter of G. Using the isomorphism rF : CF
∼
→W ab
F
we
can identify quasicharacters of WF with quasicharacters of F (or of CF ). For

290
6 Zeta Functions and Modular Forms
example, the quasicharacter corresponding to the quasicharacter c →∥c∥s
F
(with ∥c∥F being the idele norm of c ∈CF ) will be denoted by the same
symbol ωs, so that one has ωs(w) = ∥w∥s.
On the other hand the image of ϕ : WF →GF is dense, hence the set
M(GF ) can be identiﬁed with a subset of M(WF ). Representations in this
subset are called Galois-type representations. A representation ρ is of Galois
type iﬀthe image ρ(WF ) is ﬁnite.
Under the above identiﬁcation a character χ of GF corresponds to the
character of CF obtained from χ using class ﬁeld theory.
Using the embeddings θv : WFv →WF Weil has deﬁned L-functions
L(ρ, s) of representations ρ ∈M(WF ) which include the L-functions of Artin
and Hecke as special cases (Hecke-Weil L-functions). For these L-functions
the usual Artin formalism is valid. Also, there is an analogue of the theorem
of Brauer, which makes it possible to reduce the Hecke-Weil L-functions to
products of integral powers of Hecke L-functions of quasicharacters of ﬁnite
extensions E of F. A precise statement of the functional equation of L(ρ, s)
and a deﬁnition of all its local factors are given in [Ta79].
Weil has established explicit formulae of the type (6.2.54), and proposed
a generalized Riemann hypothesis, and an analogue of the Artin conjecture
for the Hecke-Weil L-functions L(ρ, s). A remarkable fact is that both the
Riemann and Artin conjectures can be reduced to positivity properties of
a certain linear functional in the right hand side of the generalized explicit
formula of type (6.2.54).
Apart from complex representations one can also consider l-adic represen-
tations of WF , and compatible systems of such representations. Tate gives in
[Ta79] general conjectures which indicate that complex and l-adic representa-
tions of the Weil group play a universal role in number theory.
6.2.7 Zeta Functions, L-Functions and Motives
(cf. [Man68], [Del79]). As we have seen with the example of the Dedekind zeta
function ζK(s), the zeta function ζ(X, s) of an arithmetic scheme X can often
be expressed in terms of L-functions of certain Galois representations. This
link seems to be universal in the following sense.
Let X →Spec OK be an arithmetic scheme over the maximal order OK
of a number ﬁeld K such that the generic ﬁber XK = X ⊗OK K is a smooth
projective variety of dimension d, and let
ζ(X, s) =

p
ζ(X(p), s)
be its zeta function, where X(p) = X ⊗OK (OK/p) is the reduction of X
modulo a maximal ideal p ⊂OK. The shape of the function ζ(X(p), s) is
described by the Weil conjecture (W4). If we assume that all X(p) are smooth
projective varieties over OK/p ∼= Fq then we obtain the following expressions
for ζ(X, s):

6.2 L-Functions, the Theory of Tate and Explicite Formulae
291
ζ(X, s) =
2d

i=0
Li(X, s)(−1)i+1,
(6.2.56)
where
Li(X, s) =

p
Pi,p(X, Np−s)−1,
and Pi,p(X, t) ∈Q[t] denote polynomials from the decomposition of the zeta
function
ζ(X(p), s) =
2d

i=0
Pi,p(X, Np−s)(−1)i+1.
In order to prove the conjecture (W4) ("the Riemann Hypothesis over a ﬁnite
ﬁeld"), Deligne identiﬁed the functions Li(X, s) with the L-functions of certain
rational l-adic Galois representations
ρX,i : GK →Aut Hi
´et(XK, Ql);
Li(X, s) = L(ρX,i, s)
deﬁned by a natural action of the Galois group GK on the l-adic cohomology
groups H∗
´et(XK, Ql) using the transfer of structure
XK
= XK ⊗K
⏐5
Spec K
σ→Spec K (σ ∈Aut K).
If XK is an algebraic curve then there are GK-module isomorphisms
H1
´et(XK, Ql) ∼= Vl(J) = Tl(X) ⊗Zl Ql
(the Tate module of the Jacobian of X),
H0
´et(XK, Ql) = Ql,
H2
´et(XK, Ql) ∼= Vl(µ)
(Vl(µ) = Tl(µ)⊗Zl Ql the Tate module of l-power roots of unity). This implies
the following explicit expressions for the L-functions
L0(X, s) = ζK(s),
L2(X, s) = ζK(s −1),
and the zeta function
L1(X, s) = L(X, s) =

p
P1,p(X, Np−s)−1,
(where deg P1,p(X, t) = 2g, g is the genus of the curve XK) is often called the
L-function of the curve X.
For topological varieties cohomology classes can be represented using cy-
cles (by Poincaré duality), or using cells if the variety is a CW-complex.
Grothendieck has conjectured that an analogue of CW-decomposition must

292
6 Zeta Functions and Modular Forms
exist for algebraic varieties over K. In view of this decomposition the factor-
ization of the zeta function (6.2.56) should correspond to the decomposition
of the variety into "generalized cells", which are no longer algebraic varieties
but motives, elements of a certain larger category MK. This category is con-
structed in several steps, starting from the category VK of smooth projective
varieties over K.
Step 1). One constructs ﬁrst an additive category M′
K in which Hom(M, N)
are Q-linear vector spaces, and one constructs a contravariant functor H∗
from VK to M′
K, which is bijective on objects (i.e. with objects H∗(X)
one for each X ∈Ob(VK)). This category is endowed with the following
additional structures:
a) a tensor product ⊗satisfying the standard commutativity, associativ-
ity and distributivity constraints;
b) the functor H∗takes disjoint unions of varieties into direct sums and
products into tensor products (by means of a natural transformation
compatible with the commutativity and associativity).
In this deﬁnition the group Hom(H∗(X), H∗(Y )) is deﬁned as a certain
group of classes of correspondences between X and Y . For a smooth pro-
jective variety X over K denote by Zi(X) the vector space over Q whose
basis is the set of all irreducible closed subschemes of codimension i, and
denote by Zi
R(X) its quotient space modulo cohomological equivalence
of cycles. Then in Grothendieck's deﬁnition, for ﬁelds K of characteristic
zero one puts
Hom(H∗(Y ), H∗(X)) = Zdim(Y )
R
(X × Y ).
Step 2. The category Meﬀ,K of false eﬀective motives. This is obtained from
M′
K by formally adjoining the images of all projections (i.e. of idempo-
tent morphisms). In this category every projection arises from a direct
sum decomposition. Categories with a tensor product and with the latter
property are called caroubien or pseudo-Abelian categories; Meﬀ,K is the
pseudo-Abelian envelope of M′
K, cf. [Del79].
Step 3. The category
◦
MK of false motives. Next we adjoin to Meﬀ,K all
powers of the Tate object Q(1) = Hom(L, Q), where L = Q(−1) = H2(P1)
is the Lefschetz object and Hom denotes the internal Hom in Meﬀ,K. As
a result we get the category
◦
MK of "false motives". The category
◦
MK
can be obtained by a universal construction which converts the functor
M →M ⊗Q(−1) = M(−1) into an invertible functor. Each object of
◦
MK
has the form M(n) with some M from Meﬀ,K.
Note that for X ∈Ob(VK) the objects Hi(X) are deﬁned as the images
of appropriate projections and

6.2 L-Functions, the Theory of Tate and Explicite Formulae
293
H∗(X) =
2d
0
i=0
Hi(X).
The category
◦
MK is a Q-linear rigid Abelian category with the commu-
tativity rule
Ψ r,s : Hr(X) ⊗Hs(Y ) ∼= Hs(Y ) ⊗Hr(X), u ⊗v →(−1)rsv ⊗u,
which implies that the rank rk(H(X)) = (−1)r dim Hr(X) could be
negative (in fact it coincides with the Euler characteristic of X).
Step 4. The category MK of true motives is obtained from
◦
MK by a modi-
ﬁcation of the above commutativity constraint, in which the sign (−1)rs
is dropped. This is a Q-linear Tannakian category, formed by direct sums
of factors of the type M ⊂Hr(X)(m), see [Del79].
Tannakian categories are characterized by the property that every such
category (endowed with a ﬁber functor) can be realized as the category
of ﬁnite dimensional representations of some (pro-) algebraic group.
In particular, the thus obtained category of motives can be regarded as the
category of ﬁnite dimensional representations of a certain (pro-) algebraic
group (the so-called motivic Galois group).
Each standard cohomology theory H on VK (a functor from VK to an
Abelian category with the Künneth formula and with some standard func-
toriality properties) can be extended to the category MK. This extension
thus deﬁnes the H-realizations of motives.
In order to construct L-functions of motives one uses the following real-
izations:
a) The Betti realization HB: for a ﬁeld K embedded in C and X ∈Ob(VK)
the singular cohomology groups (vector spaces over Q) are deﬁned
H : X →H∗(X(C), Q) = HB(X).
One has a Hodge decomposition of the complex vector spaces
HB(M) ⊗C = ⊕Hp,q
B (M)
(hp,q = dimC Hp,q
B (M)),
so that Hp,q
B (M) = Hq,p
B (M). If K ⊂R then the complex conjugation on
X(C) deﬁnes a canonical involution F∞on HB(M), which may be viewed
as the Frobenius element at inﬁnity.
b) The l-adic realizations Hl: if Char K ̸= l, X ∈Ob(VK) then the l-adic
cohomology groups are deﬁned as certain vector spaces over Ql
H : X →H∗
´et(XK, Ql) = Hl(X).

294
6 Zeta Functions and Modular Forms
There is a natural action of the Galois group GK on Hl(X) by way of
which one assigns an l-adic representation to a motive M ∈MK
ρM,l : GK −→Aut Hl(M).
A non-trivial fact is that these representations are E-rational for some
E, E ⊂C in the sense of §6.2.1.
Using the general construction of 6.2.1 one deﬁnes the L-functions
L(M, s) =

v
Lv(M, s) (v ﬁnite),
where Lv(M, s)−1 = Lpv(M, Np−s
v )−1 are certain polynomials in the variable
t = Np−s
v
with coeﬃcients in E.
For Archimedean places v one chooses a complex embedding τv : K →
C deﬁning v. Then the factors Lv(M, s) are constructed using the Hodge
decomposition HB(M) ⊗C = ⊕Hp,q
B (M) and the action of the involution F∞
(see the table in 5.3. of [Del79]).
According to a general conjecture the product
Λ(M, s) =

v
Lv(M, s) (v ∈ΣK).
admits an analytic (meromorphic) continuation to the entire complex plane
and satisﬁes a certain (conjectural) functional equation of the form
Λ(M, s) = ε(M, s)Λ(M ∨, 1 −s),
where M ∨is the motive dual to M (its realizations are duals of those of M),
and ε(M, s) is a certain function of s which is a product of an exponential
function and a constant.
One has the following equation
Λ(M(n), s) = Λ(M, s + n).
A motive M is called pure of weight w if hp,q = 0 for p + q ̸= w. In
this case we put Re(M) = −w
2 . The Weil conjecture W4) (see section 6.1.3)
implies that for a suﬃciently large ﬁnite set S of places of K the corresponding
Dirichlet series (and the Euler product)
LS(M, s) =

v̸∈S
Lv(M, s)
converges absolutely for Re(M) + Re(s) > 1.
For points s on the boundary of absolute convergence (i.e. for Re(M) +
Re(s) = 1 there is the following general conjecture (generalizing the theorem
of Hadamard and de la Vallée-Poussin):

6.2 L-Functions, the Theory of Tate and Explicite Formulae
295
a) the function LS(M, s) does not vanish for Re(M) + Re(s) = 1;
b) the function LS(M, s) is entire apart from the case when M has even
weight −2n and contains as a summand the motive Q(n); in the last case
there is a pole at s = 1 −n.
For example, for the motive Q(−1) one has
HB(Q(−1)) = H2(P1(C), Q),
Hl(Q(−1)) ∼= Vl(µ) = Tl(µ) ⊗Zl Ql,
w = 2, n = −1 and the L -function
L(Q(−1), s) = ζK(s −1)
has a simple pole at s = 2.
There are some very general conjectures on the existence of a correspon-
dence between motives and compatible systems of l-adic representations.
Nowadays these conjectures essentially determine key directions in arithmeti-
cal research ([CR01], [Tay02], [BoCa79], [Bor79], [Ta79]). We mention only a
remarkable fact that in view of the proof of the theorem of G. Faltings (see
§5.5) an Abelian variety is uniquely determined upto isogeny by the corre-
sponding l-adic Galois representation on its Tate module.
This important result is cruicial also in Wiles' marvelous proof: in order
to show that every semistable elliptic curve E over Q admits a modular para-
metrisation (see §7.2), it is enough (due to Faltings) to check that for some
prime p the L-function of the Galois representation ρp,E coinsides with the
Mellin transform of a modular form of weight two (Wiles has used p = 3
and p = 5). In other words, the generating series of such a representation,
deﬁned starting from the traces of Frobenius elements, is a modular form of
weight two which is proved by counting all possible deformations of the Galois
representation in question taken modulo p.

6.3 Modular Forms and Euler Products
6.3.1
A Link Between Algebraic Varieties and L-Functions
There is one more method of constructing L-functions, which is connected
with modular forms (or more generally with automorphic forms). These forms
may be regarded as certain special functions on real reductive groups G(R)
(or on the symmetric spaces associated with them). These functions, which
at ﬁrst sight seem to be analytic rather than number theoretical objects, turn
out to be closely related to a) Diophantine equations (arithmetic schemes, see
§6.1), and b) Galois representations. A link between the three types of object
is given by identifying the corresponding L-functions. A non-trivial example
of the link between a) and b) is given by the proof of the theorem of Faltings:
the L-function L1(A, s) attached to H1(A) of an Abelian variety A uniquely
determines A upto isogeny. It is even suﬃcient to know a ﬁnite number of the
local factors (see §5.5)
L1,v(A, s) = det(1 −Np−s
v Frv|Tl(A))−1 (l ∤Char v).
Therefore the ﬁniteness problems for Abelian varieties upto isogeny can be
reread in terms of the corresponding Galois representations.
A characteristic feature of the modern theory of L-functions is the study
of automorphic forms together with the (inﬁnite dimensional) representations
of the groups G(R) and G(A) generated by these forms, where A denotes
the adele ring of Q and it is assumed that G is a reductive algebraic group
deﬁned over Q. These representations (automorphic representations) occur in
the corresponding regular representations, i.e. in vector spaces of smooth (or
square integrable) functions over these groups (with respect to Haar measure).
This approach makes it possible to study the L-functions using methods from
the representation theory of the groups G(Qp), G(R) and G(A) (cf. [Bor79]
and §6.5).
6.3.2 Classical modular forms
are introduced as certain holomorphic functions on the upper half plane H =
{z ∈C | Im z > 0}, which can be regarded as a homogeneous space for the
group G(R) = GL2(R):
H = GL2(R)/O(2) · Z,
(6.3.1)
where Z = {
 x
0
0
x

|x ∈R×} is the center of G(R) and O(2) is the orthogonal
group. The group GL+
2 (R) of matrices γ =

aγ
cγ
bγ
dγ

with positive determinant
acts on H by fractional linear transformations; on cosets (6.3.1) this action
transforms into the natural action by group shifts.

6.3 Modular Forms and Euler Products
297
Let Γ be a subgroup of ﬁnite index in the modular group SL2(Z). A
holomorphic function f : H →C is called a modular form of (integral) weight
k with respect to Γ iﬀthe conditions a) and b) are satisﬁed:
a) Automorphy condition
f((aγz + bγ)/(cγz + dγ)) = (cγz + dγ)kf(z)
(6.3.2)
for all elements γ ∈Γ;
b) Regularity at cusps: f is regular at cusps z ∈Q ∪i∞(the cusps can
be viewed as ﬁxed points of parabolic elements of Γ); this means that
for each element σ =

a
c
b
d

∈SL2(Z) the function (cz + d)−kf

az+b
cz+d

admits a Fourier expansion over non-negative powers of q1/N = e(z/N)
for a natural number N. One writes traditionally
q = e(z) = exp(2πiz).
A modular form
f(z) =
∞

n=0
a(n)e(nz/N)
is called a cusp form if f vanishes at all cusps (i.e. if the above Fourier ex-
pansion contains only positive powers of q1/N), see [La76], [Mi89], [Ogg65],
[Fom77], [Pan81] .
The complex vector space of all modular (resp. cusp) forms of weight k
with respect to Γ is denoted by Mk(Γ) (resp. Sk(Γ)).
A basic fact from the theory of modular forms is that the spaces of modular
forms are ﬁnite dimensional. Also, one has Mk(Γ)Ml(Γ) ⊂Mk+l(Γ). The
direct sum
M(Γ) =
∞
0
k=0
Mk(Γ)
turns out to be a graded algebra over C with a ﬁnite number of generators.
An example of a modular form with respect to SL2(Z) of weight k ≥4 is
given by the Eisenstein series
Gk(z) =

m1,m2∈Z
′
(m1 + m2z)−k
(6.3.3)
(prime denoting (m1, m2) ̸= (0, 0)). For these series the automorphy condition
(6.3.2) can be deduced straight from the deﬁnition. One has Gk(z) ≡0 for
odd k and

298
6 Zeta Functions and Modular Forms
Fig. 6.1. The group SL(2, Z).
Graphics in Figure 6.1 is contributed by Curtis T. McMullen. It represents the action
of the group SL(2, Z) on H.
Gk(z) = 2(2πi)k
(k −1)!
!
−Bk
2k +
∞

n=1
σk−1(n)e(nz)
"
,
(6.3.4)
where σk−1(n) = 
d|n dk−1 and Bk is the kth Bernoulli number.
The graded algebra M(SL2(Z)) is isomorphic to the polynomial ring of the
(independent) variables G4 and G6.
The set H/SL2(Z) can be identiﬁed with the set of isomorphism classes
of elliptic curves over C: to each z ∈H one associates the complex torus
C/(Z + zZ) which is analytically isomorphic to the Riemann surface of the
elliptic curve written in Weierstrass form as follows
y2 = 4x3 −g2(z)x −g3(z)
(6.3.5)
where g2 = 60G4(z), g3(z) = 140G6(z).
If we replace z by γ(z) for γ =

aγ
cγ
bγ
dγ

∈SL2(Z) then the lattice Λz =
Z + zZ is replaced by

6.3 Modular Forms and Euler Products
299
Λγ(z) = Z + γ(z)Z = (cz + d)−1(Z + zZ) = (cz + d)−1Λz,
and the curve (6.3.5) is then replaced by the curve whose Weierstrass form
has the coeﬃcients
g2(γ(z)) = (cz + d)4g2(z),
g3(γ(z)) = (cz + d)6g3(z).
The discriminant of the cubic polynomial in the right hand side of (6.3.5)
is a cusp form of weight 12 with respect to Γ = SL2(Z):
2−4(g3
2 −27g2
3) =
(6.3.6)
2−4(2π)12e(z)
∞

m=1
(1 −e(mz))24 = 2−4(2π)12
∞

n=1
τ(nz)e(nz),
where τ(n) is the Ramanujan function. The function
j(z) = 1728
g3
2
g3
2 −27g2
3
= 1
q + 744 +
∞

n=1
c(nz)qn
(6.3.7)
is meromorphic on H and at ∞, and is invariant under Γ = SL2(Z). This
function provides an important example of a modular function; it is called the
modular invariant.
6.3.3 Application: Tate Curve and Semistable Elliptic Curves
(see [Ta74], [He97], p.343, [Se72], p.276.). Let us use the modiﬁed Weierstrass
equation of §5.3.3 in the following form (with coeﬃcients in Z[[q]]):
Tate(q) : y2 + xy = x3 + B(q)x + C(q),
(6.3.8)
where
B(q) = −5
E4 −1
240

= −5
∞

n=1
σ3(n)qn = −5
∞

n=1
n3qn
1 −qn ,
(6.3.9)
C(q) =
−5
E4 −1
240

−7
E6 −1
−504

12
= −1
12
∞

n=1
(7n5 + 5n3)qn
1 −qn
.
This equation deﬁnes an elliptic curve over the ring Z((q)) with the canonical
diﬀerential ωcan given by
dx
2y + x = dX
Y ,
the variables x, y deﬁned via the substitution
X = x + 1
12, Y = x + 2y
as in §5.3.3.

300
6 Zeta Functions and Modular Forms
Next let us take any p-adic number q ∈Q×
p such that |q|p < 1.
Then for any t ∈Q×
p /⟨q⟩let us consider the following series
ρ(t) =
∞

n∈Z
qnt
(1 −qnt)2
(6.3.10)
and one obtains a Tate curve Eq over Qp with the equation (6.3.8) in which
B(q) = −5
∞

n=1
n3qn
1 −qn ∈Zp,
(6.3.11)
C(q) = −1
12
∞

n=1
(7n5 + 5n3)qn
1 −qn
∈Zp.
Theorem 6.12 (Tate). There is a Qp-analytic isomorphism
Q×
p /⟨q⟩
∼
→Eq(Qp),
t →(x(t), y(t))
where
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩
x(t) =

n∈Z
qnt
(1 −qnt)2 −2
∞

n=1
nqn
1 −qnt
y(t) =

n∈Z
(qnt)2
(1 −qnt)3 +
∞

n=1
nqn
1 −qnt.
Moreover for any semistable elliptic curve E over Qp there exists a p-adic
number q ∈Q×
p such that |q|p < 1, and E is isomorphic to Eq (over an
unramiﬁed quadratic extention Qp(

E4(q)).
Let N ≥1 be a natural number. Let us deﬁne
Tate(qN) : y2 + xy = x3 + B(qN)x + C(qN).
Next we put t = exp(2πiu), then the points of order N on Tate(qN) corre-
spond to t = ζi
Nqj, (0 ≤i, j ≤N−1), ζN = exp(2πi/N), and their coordonates
are given by
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩
x(t) =

n∈Z
qNnt
(1 −qNnt)2 −2
∞

n=1
nqNn
1 −qNnt
y(t) =

n∈Z
(qNnt)2
(1 −qNnt)3 +
∞

n=1
nqNn
1 −qNnt.
It is important for arithmetical applications for the Tate curve that these
coordonates belong to the ring Z[ζN, N −1][[q]].

6.3 Modular Forms and Euler Products
301
Proof
uses the identity

n∈Z
(u + n)−k = (2πi)k
(k −1)!
∞

n=1
nk−1e2πinu (k ≥2,
u ∈Z).
We have for the lattice Λ = 2πi(Z + τZ) the following equalities
X = ℘(2πiu) =
(2πi)−2
⎛
⎝u−2 +

m,n∈Z
′ 
(u + mτ + n)−2 −(mτ + n)−2
⎞
⎠=
(6.3.12)
(2πi)−2

m∈Z

n∈Z
(u + mτ + n)−2 −2
∞

m=1

n∈Z
(mτ + n)−2 −2ζ(2)

=

m∈Z
∞

n=1
ne2πi(u+mτ)n −2
∞

m=1
∞

n=1
ne2πimnτ + 1
12,
implying the above identities.
6.3.4 Analytic families of elliptic curves and congruence subgroups
For an integer N the following congruence subgroups are deﬁned:
Γ0(N) = {γ ∈SL2(Z) | cγ ≡0 mod N} ,
(6.3.13)
Γ1(N) = {γ ∈Γ0(N) | aγ ≡dγ ≡1 mod N} ,
(6.3.14)
Γ(N) = {γ ∈SL2(Z) | γ ≡1 mod N} .
(6.3.15)
More generally, a subgroup Γ ⊂SL2(Z) is called a congruence subgroup
iﬀΓ ⊃Γ(N) for some N. Consider fundamental domains in H for the actions
of the above congruence subgroups: (a) H/Γ0(N), (b) H/Γ1(N), (c) H/Γ(N).
These domains can be identiﬁed respectively with the sets of isomorphism
classes over C of the following objects:
(a) (E, ⟨P⟩), an elliptic curve over C together with a cyclic subgroup of order
N, ⟨P⟩⊂E(C), Card⟨P⟩= N;
(b) (E, P), an elliptic curve over C together with a point P ∈E(C) of order
N, Card⟨P⟩= N;

302
6 Zeta Functions and Modular Forms
(c) (E, φ) = (E, P, Q), an elliptic curve over C together with an isomorphism
φ : Z/NZ ⊕Z/NZ
∼
→E(C)N,
such that
φ∗eN = exp(2πidet/N),
where eN is the Weil pairing (5.3.28) thus φ gives a basis of the points of
order N:
P, Q ∈E(C)N = ⟨P⟩⊕⟨Q⟩∼= Z/NZ ⊕Z/NZ.
In order to describe this identiﬁcation one associates to a point z ∈H the
following objects:
(a) (C/Λz, ⟨1/N⟩mod Λz⟩);
(b) (C/Λz, 1/N mod Λz);
(c) (C/Λz, 1/N mod Λz, z/N mod Λz),
1/N mod Λz →(1, 0) mod N, z/N mod Λz →(0, 1) mod N
6.3.5 Modular forms for congruence subgroups
For the study of modular forms it is convenient to use the traditional notation
(f|kγ)(z) = detγk/2f(γ(z))(cγz + dγ)−k
(6.3.16)
for the weight k action of an element γ =

aγ
cγ
bγ
dγ

∈GL+
2 (R) with positive
determinant detγ > 0.
Let ψ be a Dirichlet character mod N. Put
Mk(N, ψ) = {f ∈MK(Γ1(N)) | f|kγ = ψ(dγ)f for all γ ∈Γ0(N)},
(6.3.17)
Sk(N, ψ) = Mk(N, ψ) ∩Sk(Γ1(N)).
(6.3.18)
One then has the following decomposition
Mk(Γ1(N)) =
0
ψ
mod
N
Mk(N, ψ),
Sk(Γ1(N)) =
0
ψ
mod
N
Sk(N, ψ).
For a modular form h ∈Mk(N, ψ) the Petersson inner product of h with
f ∈Sk(N, ψ) is deﬁned by the formula
⟨f, h⟩N =

H/Γ0(N)
f(z)h(z)yk−2 dx dy,
(6.3.19)

6.3 Modular Forms and Euler Products
303
where z = x + iy, H/Γ0(N) is a ﬁxed fundamental domain for H modulo
Γ0(N). Then one has the following orthogonal decomposition:
Mk(N, ψ) = Sk(N, ψ) ⊕Ek(N, ψ),
(6.3.20)
where Ek(N, ψ) is the subspace of Eisenstein series, whose basis can be ex-
plicitly described and consists of Fourier series of type (6.3.3) ([La76], [He59],
[Shi71]), [Mi89].
The arithmetical signiﬁcance of modular forms is well illustrated by the
example of the theta series. Let
Q(X) = 1
2
tXAX
be a positive deﬁnite, integral quadratic form in an even number 2k of vari-
ables, with an even matrix A = (aij), aij ∈Z, aii ∈2Z, k ≥2, where
X = t(x1, x2, . . . , x2k) is an integral column vector. Let us associate to Q(X)
the following theta series
θ(z; Q) =

M∈Z2k
e(Q(M)z) =
∞

n=0
a(n)e(nz),
(6.3.21)
where
t(m1, m2, . . . , m2k) = M,
a(n) = a(n; Q) = Card

M ∈Z2k | Q(M) = n

(6.3.22)
is the number of representations of n by the integral quadratic form Q with
matrix A.
Let N be the level of Q, i.e. the smallest positive integer N such that NA−1
is an even integral quadratic form. It turns out that θ(z; Q) ∈Mk(N, ε∆),
where ε∆(d) =
 ∆
d

is the quadratic character attached to the discriminant
∆of the form Q, cf. [Ogg65], [Kog71].
The theory of modular forms makes it possible to obtain good estimates,
and sometimes even explicit expressions, for the numbers a(n; Q). In order to
do this the theta function (6.3.21) is represented as a sum of an Eisenstein
series
Ek(z; Q) =
∞

n=0
ρk(n; Q)e(nz) ∈Ek(N, ε∆)
(6.3.23)
and a cusp form
Sk(z; Q) =
∞

n=1
bk(n; Q)e(nz) ∈Sk(N, ε∆).
(6.3.24)

304
6 Zeta Functions and Modular Forms
The coeﬃcients ρk(n; Q) are elementary arithmetical functions such as
σk−1(n). For the coeﬃcients of cusp forms one has the famous estimate
b(n) = O

n
k−1
2
+ε
,
ε > 0
(6.3.25)
which was known as the Petersson-Ramanujan conjecture before being proved
by Deligne (cf. [Del74]), who ﬁrst reduced this conjecture to the Weil con-
jecture (see §6.1.3) in [Del68], and then proved all these conjectures, using
Grothendieck's étale l-adic cohomology.
In particular for the Ramanujan function τ(n) Deligne's estimate takes
the form
τ(p) < 2p11/2
(p prime numbers).
Applying the estimate (6.3.25) to the series (6.3.21) gives
a(n; Q) = ρk(n; Q) + O

n
k−1
2
+ε
,
ε > 0
(6.3.26)
The proof of (6.3.25) is based on a geometric interpretation of a cusp form
f ∈S(Γ) of even weight k as a multiple diﬀerential: for γ ∈Γ the expression
f(z) (dz)k/2
does not change if we replace z by γ(z), and can therefore be deﬁned over the
modular curve XΓ = H/Γ, i.e. on a projective algebraic curve, whose Rie-
mann surface is compact and is obtained by adding to H/Γ a ﬁnite number of
cusps. In particular, for k = 2 the expression f(z) dz represents a holomorphic
diﬀerential on XΓ , and the estimate (6.3.25) in this case was ﬁrst established
by [Eich54] (the congruence relation of Eichler-Shimura, see a detailed expo-
sition in [Shi71] and in Röhrlich's papers in [CSS95]).
Many interesting examples of formulae for the numbers a(n; Q) can be
found in the book of L.A.Kogan, [Kog71], and in [An65], [Lom78], [He59] and
elsewhere.
6.3.6 Hecke Theory
In the examples of Eisenstein series and theta functions one notices an in-
teresting fact: the Fourier coeﬃcients a(n) of these modular forms turn out
to be either multiplicative arithmetical functions or linear combinations of
such functions. For the Ramanujan function τ(n) (6.3.6) these multiplicativ-
ity properties have the following form
τ(mn) = τ(n)τ(m) for (m, n) = 1,
τ(pr) = τ(p)τ(pr−1) −p11τ(pr−2) (p a prime number, r ≥2) (6.3.27)

6.3 Modular Forms and Euler Products
305
and it seems that not even these relations can be established using only ele-
mentary methods. They might provide an example for the theorem of Gödel
(see Chapter 3) (cf. [He59], [An74], [La76]).
Let m be a positive integer, f(z) = ∞
n=0 a(n)e(nz) a function on H. Then
the following functions are deﬁned
f|U(m)(z) =
∞

n=0
a(mn)e(nz) = mk/2−1

u
mod
m
f|k
1
0
u
m

,
f|V (m)(z) =
∞

n=0
a(n)e(mnz) = f(mz) = m−k/2f|k
m
0
0
1

.
(6.3.28)
Imagine that the operator
f →f|U(m)
acts on the space of modular forms Mk(N, ψ). Then one might expect to ﬁnd
a basis consisting of its eigenfunctions. Assuming f to be an eigenfunction
would then imply the relations
a(mn) = λ(m)a(n)
(n ∈N)
where λ(m) are the corresponding eigenvalues:
f|U(m) = λ(m)f.
The desired multiplicativity property would then follow. However, if f ∈
Mk(N, ψ) then in general one can only state that
f|U(m)(z), f|V (m)(z) ∈Mk(mN, ψ),
(6.3.29)
and
f|U(m)(z) ∈Mk(N, ψ)
holds only when m divides N. In order to overcome with this diﬃculty
in the general case note that the matrices
 1
0
u
m

in the deﬁnition (6.3.28)
of U(m) form part of a complete system of right coset representatives for
Γ0(N)\∆m(N), where ∆m(N) denotes the set
∆m(N) =
8
γ =
a
c
b
d
  a, b, c, d ∈Z, c ≡0 mod N, detγ = m
9
,
which is invariant under right multiplication by elements of Γ0(N). As a com-
plete system of right coset representatives for Γ0(N)\∆m(N) one could take
the set
8a
0
b
d
  a, d > 0, ad = m, b = 0, . . . , d −1
9
.
(6.3.30)

306
6 Zeta Functions and Modular Forms
This fact makes it possible to deﬁne instead of U(m) another operator
which does act on the space of modular forms Mk(N, ψ). This other operator
is called the Hecke operator T(m):
f →f|kT(m) = mk/2−1 
σ
ψ(aσ)f|kσ,
(6.3.31)
where σ =

aσ
cσ
bσ
dσ

∈Γ0(N)\∆m(N), (m, N) = 1.
The action of T(m) on the Fourier coeﬃcients is easily calculated using
the systems of representatives (6.3.30):
f|kT(m) =

m1|m
ψ(m1)mk−1
1
f|U(m/m1)V (m1)
=a(0)

m1|m
ψ(m1)mk−1
1
+
∞

n=1

m1|(m,n)
ψ(m1)mk−1
1
a(mn/m2
1)e(nz),
(6.3.32)
where it is implicitly assumed that a(x) = 0 for x ̸∈Z.
Multiplying the systems (6.3.30) together shows that the multiplication
rule for the operators Tk(m) is as follows:
Tk(m)Tk(n) =

m1|(m,n)
ψ(m1)mk−1
1
Tk(mn/m2
1).
(6.3.33)
In particular all the operators Tk(n) commute. If f ∈Mk(N, ψ) is an eigen-
function for all Tk(m) with (m, N) = 1, i.e. if
f|Tk(m) = λh(m)f
((m, N) = 1),
(6.3.34)
then (6.3.33) implies that
λf(m)λf(n) =

m1|(m,n)
ψ(m1)mk−1
1
λf(mn/m2
1).
Equating the Fourier coeﬃcients a(n) in (6.3.34) one obtains the following
equalities
a(0)

m1|m
ψ(m1)mk−1
1
= λf(m)a(0),

m1|(m,n)
ψ(m1)mk−1
1
a(mn/m2
1) = λf(m)a(n).
(6.3.35)
In particular for n = 1 one has

6.3 Modular Forms and Euler Products
307
a(m) = λf(m)a(1),
(6.3.36)
and for a(1) ̸= 0 the function a(m) is therefore proportional to the function
λ(m) for (m, N) = 1.
All these properties can be especially neatly expressed in terms of Dirichlet
series: for the function
f(z) =
∞

n=0
a(n)e(nz) ∈Mk(N, ψ),
satisfying (6.3.34) put formally
LN(s, f) =
∞

n=1
(N,n)=1
λf(n)n−s,
RN(s, f) =
∞

n=1
(N,n)=1
a(n)n−s.
(6.3.37)
Then these (formal) Dirichlet series satisfy the following identities:
I) The Euler product expansion:
LN(s, f) =

p : p̸ |N
[1 −λf(p)p−s + ψ(p)pk−1−2s]−1.
(6.3.38)
II) RN(s, f) = a(1)LN(s, f).
Indeed the multiplication rule (6.3.33) for distinct primes pi, pi ∤N implies
that one has
LN(s, f) =

p : p̸ |N
 ∞

δ=0
λf(pδ)p−δs

,
and each of the series can be summed over δ using the relation
λf(p)λf(pδ) = λf(pδ+1) + ψ(p)λf(pδ−1) (δ ≥1).
(6.3.39)
Equation II) follows then directly from (6.3.36).
Convergence of the series (6.3.37) for Re(s) ≫0 follows from the following
estimates for the coeﬃcients
a) If f ∈Mk(N, ψ) then
|a(n)| = O(nk−1+ε),
ε > 0
(6.3.40)
and the Dirichlet series (6.3.37) converges absolutely for Re s > k.
b) If f ∈Sk(N, ψ) then
|a(n)| = O(n
k−1
2
+ε),
ε > 0
(6.3.41)
and the series LN(s, f) and RN(s, f) converge absolutely for Re s > (k+1)
2
.

308
6 Zeta Functions and Modular Forms
The estimates (6.3.40) and especially (6.3.41) use some ﬁne arithmetical
properties of the coeﬃcients a(n). However, using only analytic properties of
f(z) (the fact that it is holomorphic and the automorphic condition (6.3.2))
one can easily obtain rougher estimates:
a)
|a(n)| = O(nk), for f ∈Mk(N, ψ);
b)
|a(n)| = O(nk/2), for f ∈Sk(N, ψ);
the latter estimate is implied by the estimate |f(z)| = O(yk/2) (y →0,
z = x + iy).
A basis consisting of eigenfunctions for Hecke operators can be found using
the Petersson inner product (6.3.19). One veriﬁes that the operators Tk(m)
on Sk(N, ψ) are normal with respect to this inner product for (m, N) = 1.
Moreover, the operators are ψ-Hermitian: for all f, h ∈Sk(N, ψ) the following
equation holds:
ψ(m)⟨f|Tk(m), h⟩N = ⟨f, h|Tk(m)⟩N.
(6.3.42)
By a general theorem of linear algebra on families of commuting nor-
mal operators, there is an orthogonal basis of Sk(N, ψ) consisting of common
eigenfunctions of all the Tk(m), ((m, N) = 1). A basis with this property is
called a Hecke basis. In the case that the number m is divisible only by prime
divisors of the level N, one may use the operator U(m) instead of Tk(m).
As was mentioned above (see (6.3.28)) these operators leave Mk(N, ψ) invari-
ant. However, they are not normal and in general are not diagonalizable in
Sk(N, ψ).
The Mellin transform of a modular form and its analytic continuation. Let
f(z) =
∞

n=0
a(n)e(nz) ∈Mk(N, ψ).
Then the Dirichlet series
R(s, f) = R1(s, f) =
∞

n=1
a(n)n−s
which converges absolutely for Re s ≫0 can be analytically continued to the
entire complex plane using the Mellin transform of the modular form f:
(2π)−sΓ(s)R(s, f) =
 ∞
0
[f(iy) −a(0)]ys−1 dy (Re(s) ≫0).
(6.3.43)
This can be seen by integrating termwise the series

6.3 Modular Forms and Euler Products
309
f(iy) −a(0) =
∞

n=1
a(n) exp(−2πny)
and using the integral representation of the gamma function:
Γ(s) =
 ∞
0
e−yys−1 dy (Re(s) > 0).
The vector space of all Dirichlet series of type R(s, f) for f ∈Mk(N, ψ)
can be characterized by analytic properties of these series. Following [An74],
we give this characterization in the case N = 1.
Theorem A. Let f ∈Mk = Mk(SL2(Z)). Then the Dirichlet series R(s, f)
admits a meromorphic continuation to the entire complex plane, and if one
puts
Λ(s, f) = (2π)−sΓ(s)R(s, f),
then the function
Λ(s, f) + a(0)
s
+ (−1)k/2a(0)
k −s
(6.3.44)
is entire. The following functional equation holds
Λ(k −s, f) = (−1)k/2Λ(s, f).
(6.3.45)
Theorem B. Every Dirichlet series R(s) = ∞
n=1 a(n)n−s whose coeﬃcients
a(n) have not more than a polynomial order of growth, and which satisﬁes
(6.3.44) and (6.3.45), has the form R(s, f) for some modular form f ∈Mk =
Mk(SL2(Z)).
Indeed, in order to prove theorem A we use the Mellin transform (6.3.43)
and write
Λ(s, f) =
 ∞
0
[f(iy) −a(0)]ys−1 dy (Re(s) > k + 1).
Taking into account that f(−1/z) = zkf(z) we see that
Λ(s, f) =
 ∞
1
[f(iy) −a(0)]ys−1 dy −a(0)
s
+
 1
0
f(iy)ys−1 dy
=
 ∞
1
[f(iy) −a(0)]ys−1 dy −a(0)
s
+
 1
0
f(−1/iy)y−s−1 dy
=
 ∞
1
[f(iy) −a(0)](ys−1 + ikyk−s−1) dy −a(0)
s
−ika(0)
k −s .
The function f(iy) −a(0) tends to zero exponentially as y →∞, so the last
integral converges absolutely for all s and turns out to be a holomorphic

310
6 Zeta Functions and Modular Forms
function of the variable s. This proves (6.3.44). By the substitution s →
k −s the last written expression for Λ(s, f) is multiplied by ik, and both the
functional equation (6.3.45) and theorem A follow.
In order to prove theorem B it suﬃces to use the inverse Mellin transform,
and the fact that the whole modular group SL2(Z) is generated by the matrices
 1
0
1
1

and
 0
1
−1
0

.
Theorems A and B can be extended to modular forms of integral weight for
congruence subgroups of SL2(Z) (with natural technical complications). The
theorem generalizing Theorem A in this situation is called the direct theorem,
and the generalization of Theorem B is called the inverse theorem (or converse
theorem, cf. [CoPSh02]). This inverse theorem was stated by [Wei67], [Wei71]
in terms of the twisted Dirichlet series
Λ∗(s, χ) = (2π)−sΓ(s)
∞

n=1
χ(n)a(n)n−s,
(6.3.46)
where χ is an arbitrary Dirichlet character. Assume that the series
R(s) =
∞

n=1
a(n)n−s
converges absolutely for s = k−δ, δ > 0, and that for all χ mod r, (r, N) = 1
the functions (6.3.46) are entire, bounded in every vertical strip and satisfy
certain functional equations relating Λ∗(s, χ) to Λ∗(k −s, χ). Then one can
deduce that the Fourier series
f(z) =
∞

n=0
a(n)e(nz)
represents a modular form in Sk(N, ψ). In other words, the automorphy prop-
erties of this Fourier series can be deduced from functional equations of the
corresponding Dirichlet series twisted by Dirichlet characters; the precise form
of the functional equations for these series is given in [Wei67].
6.3.7 Primitive Forms
Atkin and Lehner have made an important complement to Hecke's theory
by constructing a satisfactory theory of Hecke operators for all m including
the divisors of the level. We begin with a simple example (following [La76],
[Fom77], [Gel75]). Consider the vector space S12(Γ0(2)) containing f1(z) =
∆(z) and f2(z) = ∆(2z). These two functions have the same eigenvalues for
all Hecke operators T12(p) with p ̸= 2. However they are linearly independent.
A natural question then arises: which additional conditions must be imposed
on f(z) = ∞
n=0 a(n)e(nz) ∈Sk(N, ψ) so that it is uniquely determined by
its eigenvalues λf(m) for (m, N) = 1.

6.3 Modular Forms and Euler Products
311
In order to ﬁnd such conditions one constructs ﬁrst the subspace of old
forms Sold
k (Γ1(N)) ⊂Sk(Γ1(N)) as the sum of images of the operators
V (d′) : Sk(Γ1(N/d)) →Sk(Γ1(N))
(see (6.3.28)) for all divisors d of the level N, and for all divisors d′ of d. Set
Sold
k (N, ψ) = Sk(N, ψ) ∩Sold
k (Γ1(N)).
Then the vector space of new forms of level precisely N is deﬁned to be the
orthogonal complement of the old forms:
Sk(N, ψ) = Snew
k
(N, ψ) ⊕Sold
k (N, ψ).
(6.3.47)
The main result of Atkin - Lehner theory is that if a function f ∈Snew
k
(N, ψ)
is an eigenfunction of all Hecke operators Tk(m) with (N, m) = 1, then f is
uniquely determined (upto a multiplicative constant) by the eigenvalues and
one can normalize f by the condition a(1) = 1. A primitive form of conductor
N is then deﬁned as a normalized new eigenform f ∈Snew
k
(N, ψ). For such
forms f the condition f|U(q) = a(q)f for q|N is automatically satisﬁed. One
has the following Euler product expansion:
L(s, f) =
∞

n=1
a(n)n−s
=

q|N
(1 −a(q)q−s)−1 
p∤N
(1 −a(p)p−s + ψ(p)pk−1−2s)−1,
(6.3.48)
in which |a(q)| = q(k−1)/2 if the character ψ can not be deﬁned modulo the
smaller level N/q, and if ψ is deﬁned modulo N/q then a(q)2 = ψ(q)qk−1
provided q2 ∤N, and a(q) = 0 otherwise (i.e. for q2|N), cf. [Li75].
Let f(z) = ∞
n=0 a(n)e(nz) ∈Sk(N, ψ) be a primitive cusp form of con-
ductor Cf, Cf|N. If we put
W(Cf) =
 0
Cf
−1
0

,
f ρ(z) = f(−z) =
∞

n=0
a(n)e(nz) ∈Sk(N, ψ),
then there is a complex number λ(f) with |λ(f)| = 1 such that
f|kW(Cf) = λ(f)f ρ.
(6.3.49)
Primitive cusp forms of a given conductor are characterized by the identity
(6.3.49), which is equivalent to a certain nice functional equation for the cor-
responding Dirichlet series (cf. [Li75])
L(s, f) =

p
(1 −a(p)p−s + ψ(p)pk−1−2s)−1
=

p
[(1 −α(p)p−s)(1 −α′(p)p−s)]−1,

312
6 Zeta Functions and Modular Forms
where
α(p)α′(p) = ψ(p)pk−1,
α(p) + α′(p) = a(p).
(6.3.50)
If we put
Λ(s, f) = (2π/

Cf)−sΓ(s)L(s, f),
then this functional equation has the form
Λ(k −s, f) = ik/2λ(f)Λ(s, fρ).
(6.3.51)
For a primitive Dirichlet character χ whose conductor Cχ is coprime to
Cf, the twisted modular form
fχ(z) =
∞

n=0
χ(n)a(n)e(nz) ∈Sk(CfC2
χ, ψ)
(6.3.52)
is a primitive cusp form of conductor CfC2
χ (comp. with (6.3.51) and (6.3.45)).
6.3.8 Weil's Inverse Theorem
A converse statement concerning analytic properties of the series (6.3.52) was
found by A.Weil [Wei67] giving necessary and suﬃcient conditions that a
Fourier series f(z) = ∞
n=0 a(n)e(nz) represents a modular form in Mk(N, ψ)
in terms of the Dirichlet series
Λ(s, f, χ) = (2π)−sΓ(s)
∞

n=1
χ(n)a(n)n−s,
where χ is a Dirichlet series.
If f ∈Mk(N, ψ), and χ is primitive modm let us consider the twist
fχ(z) =
∞

n=0
χ(n)a(n)e(nz) = χ(−1)f|G(χ)
m

a mod m
χ(a)
m
0
a
m

,
where G(χ) = 
a mod m χ(a)e(a/m) is the Gauss sum and one checks
fχ(z) ∈Sk(Nm2, ψχ2).
Moreover if f|WN = C1f ρ, then
fχ|WNm2 = Cχf ρ
χ = Cχ(fχ)|K,
(6.3.53)
where
Cχ = C1
G(χ)
G(χ)χ(−N)ψ(m),
(6.3.54)

6.3 Modular Forms and Euler Products
313
g|WN(z) = g|
 0
N
−1
0

(z) = N k/2zkg(−1/Nz),
(6.3.55)
gρ(z) = g|K(z) = g(−z) =
∞

n=0
a(n; g)e(nz).
These statements follow from known properties of Gauss sums.
Lemma 6.13. Let Gb(χ) =

a mod m
χ(a)e(ab/m), and consider a primitive
Dirichlet character χ modulo m. Then:
(i) Gb(χ) = χ(b)G(χ),
(ii) G(χ)G(χ) = χ(−1)m.
We see that (6.3.53) is equivalent to the identity
f|G(χ)
m

a mod m
χ(a)
m
0
a
m

= Cχf|G(χ)
m

a mod m
χ(a)
m
0
a
m

|KWNm2,
and one may commutate the terms on the right as follows:
Cχf|G(χ)
m

a mod m
χ(a)
m
0
a
m

|KWNm2 =
Cχ
G(χ)
m

a mod m
χ(a)f|K
m
0
−a
m

|WNm2 =
Cχ
G(χ)
m

a mod m
χ(a)f|K
m
0
a
m

|WNm2,
because of the equality f|
 m
0
a
m

|KWNm2 = f|K
 m
0
−a
m

WNm2, and we re-
place a par −a. Notice also that
f|K
m
0
a
m

WNm2 = f|KWNγ(a, b)
m
o
b
m

γ(a, b) =
 m
−Na
−b
n

∈Γ0(N),
because of the equality
WNγ(a, b)
m
o
b
m
 m
0
0
m

=
m
0
a
m

WNm2,
−Nab ≡1(modm).
Let us rewrite (6.3.53) in the following form (6.3.56):
G(χ)

a mod m
χ(a)f|
m
0
a
m

(6.3.56)
= CχG(χ)χ(−N)

a mod m
χ(b)f|KWNγ(a, b)
m
0
b
m

.

314
6 Zeta Functions and Modular Forms
It follows that
f|KWN = (−1)kf|WNK = (−1)k(C1f|K)K = (−1)kC1f,
f|KWNγ(a, b) = (−1)kC1ψnf = (−1)kC−1
1 ψ(m)f
hence (6.3.56) implies that Cχ is given by the above formula (6.3.54).
Let us rewrite (6.3.56) in the equivalent form:

a mod m
χ(a)f|
m
0
a
m

= ψ(m)

a mod m
χ(b)f|γ(a, b)
m
0
b
m

(6.3.57)
using −Nab ≡1(modN).
The Mellin transform gives directly the equality:
Λ∗(s, f, χ) = Cχik(Nm2)
k
2 −sΛ∗(k −s, f ρ, χ).
A converse statement concerning analytic properties of the series (6.3.52)
was found by A.Weil [Wei67].
Theorem 6.14 (A.Weil, 1967). Suppose that a series
R(s) =
∞

n=1
a(n)n−s
with complex coeﬃcients a(n) converges absolutely for s = k −δ, δ > 0,
and that for every χ mod m of prime conductor m, (m ∤N) the function
Λ∗(s, f, χ) is entier, bounded in every vertical strip and satisﬁes the following
functional equation:
Λ∗(s, f, χ) = Cχik(Nm2)
k
2 −sΛ∗(k −s, f ρ, χ),
where f ρ(z) = ∞
n=1 a(n)e(nz),
Cχ = C1
G(χ)
G(χ)χ(−N)ψ(m).
Then
f(z) =
∞

n=1
a(n)e(nz)
represents a modular cusp form in Sk(N, ψ).
In other words, the properties of automorphy of such series can be deduced
from the functional equations and the analytic properties of all the series
(6.3.52)

6.3 Modular Forms and Euler Products
315
Sketch of the proof.
Let us consider the group algebra C[[GL+(2, R)]] of GL+(2, R), and its right
ideal
Ωf ⊂C[[GL+(2, R)]]
consisting of all w ∈C[[GL+(2, R)]] such that f|w = 0.
One has to show that for every γ =

a
c
b
d

∈Γ0(N) the element w =
(ψ(d) −γ) = ψ(d)(1 −ψ(a)γ) ∈Ωf.
Let us consider ﬁrst the elements γ = γ(a, b) =

m
−Nb
−b
n

∈Γ0(N) as
above and let us show
(1 −ψ(m)γ(a, b)) ∈Ωf.
for all γ(a, b) =

m
−Nb
−b
n

with m, n ∈S, where S is the set of all primes m
for which the functional equation is satisﬁed for every χ mod m.
Lemma 6.15. The equality (6.3.57) is equivalent to (6.3.58): for all b, b′ mod
m, (b, m) = (b′, m) = 1 one has
(1 −ψ(m)γ(a, b))
m
0
b
m

(6.3.58)
≡(1 −ψ(m)γ(a′, b′))
m
0
b′
m

(modΩf).
Proof of Lemma 6.15 is a simple veriﬁcation: for all b′, b′′ mod m, (b′, m) =
(b
′′, m) = 1 one can multiply the two parts of (6.3.57) by χ(b
′′) −χ(b′) and
summate over χ, cf. op.cit.
⊓⊔
In order to ﬁnish the proof of Theorem 6.14, it suﬃcies to show that
1 −ψ(a)γ ∈Ωf for all other elements γ =
 a
Nc
b
d

∈Γ0(N).
First, let c = 0, γ =

1
0
b
1

, then f = f|γ because f is periodic of period 1.
Next, let b = 0, γ =
 1
Nc
0
1

∈Γ0(N). Then
 1
Nc
0
1

=
 0
N
−1
0
 1
0
−c
1
  0
N
−1
0
−1
hence
f|
 1
Nc
0
1

= f|WN
1
0
−c
1

W −1
N
= (−1)kf|WN
1
0
−c
1

WN =
(−1)kf|K2WN
1
0
−c
1

WN = f|KWNK
1
0
−c
1

WN =
C1f|
1
0
c
1

KWN = C1C1f = f,

316
6 Zeta Functions and Modular Forms
in view of the known properties of K et WN: KWN = (−1)kWNK, W 2
N =
(−1)2, and from the fact that f|KWN = C1f which is equivalent to the
functional equation with χ = 1, m = 1. Finally, if γ =

a
Nc
b
d

Γ0(N), b ̸= 0,
let us choose s, t ∈Z such that m = a + Nbs, n = d + Nbt ∈S. Then
γ =

1
−Nt
0
1
  m
Nb′
b
n
 
1
−Ns
0
1

;
implying
f|γ = ψ(n)f = ψ(d)f.
This proves the automorphy property; it remains to chack the vanishing
of f at the cusps of Γ0(N). Let us use the absolute convergence of the series
R(s) =
∞

n=1
a(n)n−s
at s = k−δ, δ > 0. One easily deduces analytically that f(x+iy) = O(y−k+δ)
for y →0. This means that f is a cusp form in Sk(N, ψ).

6.4 Modular Forms and Galois Representations
6.4.1 Ramanujan's congruence and Galois Representations
A new chapter in the theory of modular forms, and generally in arithmetic, was
opened by Serre and Deligne, who discovered a link between modular forms
and Galois representations. Their results have enhanced our understanding of
a universal role played by modular forms in number theory, and have explained
a whole series of mysterious facts concerning various arithmetical functions.
Examples of these facts are the conjecture of Ramanujan-Petersson τ(p) <
2p11/2 for the Ramanujan function τ(p), and the congruence of Ramanujan
τ(n) ≡

d|n
d11 mod 691.
(6.4.1)
The ﬁrst result in this direction concerns the normalized cusp forms
f(z) =
∞

n=1
a(n)e(nz) ∈Sk(SL2(Z)) with k = 12, 16, 18, 20, 22, 26,
when dim Sk(SL2(Z)) = 1. Serre conjectured (in [Se68a], [Se68b])), and
Deligne proved (cf. [Del68]), that for each of the above cusp forms and for
every prime number l there exists a continuous Galois representation
ρl : G(Kl/Q) →GL2(Zl)
(6.4.2)
(where Kl is the maximal extension of Q ramiﬁed only at l) with the property
that the image of the p-Frobenius element Fρ,p = ρl(Frp) for p ̸= l has
characteristic polynomial t2 −a(p)t + pk−1, where a(p) is the pth coeﬃcient
of f, and k is its weight.
One can rephrase the statement on the characteristic polynomial as saying
that the representation ρl is Z-integral in the sense of §6.2.1, and the following
equation holds:
(1 −a(l)l−s + lk−1−2s)L(s, f) = L(ρl, s).
(6.4.3)
This result makes it possible to study congruences modulo a prime number
l for the coeﬃcients a(n). It turns out that such congruences exist only when
l is exceptional for ρl, i.e. when the image Im ρl does not contain SL2(Zl). In
this case there are certain relations modulo l between the trace Tr Fρ,p = a(p)
and the determinant detFρ,p = pk−1 of the matrix Fρ,p. For example, in the
case of the Ramanujan function τ(n) we have k = 12, l = 691, and the image
of ρl mod l (modulo conjugation) lies in the subgroup of upper triangular
matrices
 ∗
0
∗
∗

mod l. One has
Fρl,p ≡
p11
0
∗
1

mod l,

318
6 Zeta Functions and Modular Forms
which implies τ(p) ≡p11 + 1 mod l, and by multiplicativity one obtains
the congruence (6.4.1). H.P.Swinnerton-Dyer in [SwD73] gave the following
description of the possible exceptional primes l for the above cusp forms:
a) there exists an integer m such that a(m) ≡nmσk−1−2m mod l whenever
n is a quadratic non-residue mod l; in this case
Fρl,p ≡
pm
0
∗
pk−1−m

mod l :
b) a(n) ≡0 mod l whenever n is a quadratic residue mod l;
c) p1−ka(p)2 ≡0, 1, 2, 4 mod l.
For the Ramanujan function τ(n) the exceptional primes are: l = 2, 3, 5,
7, 23, 691.
The construction of the representation ρl is based on methods from alge-
braic geometry, in particular on the study of the l-adic cohomology groups of
the Kuga-Sato variety Ew
Γ which is deﬁned as the ﬁber product of w = k −2
copies of the universal elliptic curve EΓ →XΓ over the modular curve
XΓ = H/Γ, Γ = SL2(Z) (cf. §6.3.2, and [Sho80]).
The variety Ew
Γ is deﬁned over Q and its algebraic (and complex) dimension
is equal to w + 1 = k −1. Deligne has shown that the representation ρl of
Gal(Q/Q) occurs in the vector space Hk−1
´et
(Ew
Γ,Q, Ql); in other words one can
associate to f a motive Mf of weight k −1 which occurs in the cohomology
of the Kuga-Sato variety. However, the construction of Mf requires many
additional cohomological techniques ([Ja90] , [Scho90]).
Ribet in [Ri77] has extended the results of Deligne to primitive modular
forms of arbitrary level.
The Galois representation ρl = ρf,l attached to a cusp form f is irreducible;
if on the other hand we take for f an Eisenstein series which is an eigenfunction
of all Hecke operators, f ∈Mk(N, ψ) then it is not diﬃcult to construct a
reducible l-adic representation ρl whose L-function is the Mellin transform of
f, i.e. such that the characteristic polynomial of Fρl,p coincides with
1 −λf(p)p−s + ψ(p)pk−1−2s (f|Tk(p) = λf(p)f)
for l ̸= p, lp coprime to N. Formula (6.3.35) shows that if a(0) ̸= 0 then λ(p) =
1+ψ(p)pk−1. Hence one may take for ρl the direct sum 1⊕(ρψ ⊗χk−1
l
), where
χl : Gal(Q/Q) →Z×
l
(χl(Frp) = p) is the cyclotomic character and ρψ :
Gal(Q/Q) →Q
× ⊂Q
×
l is the one dimensional representation associated to ψ
via the Kronecker-Weber theorem. For the Eisenstein series the L-function of
this representation coincides with
ζ(s)L(s −k + 1, ψ) =

p
[(1 −p−s)(1 −ψ(p)pk−1−2s)]−1.

6.4 Modular Forms and Galois Representations
319
6.4.2 A Link with Eichler-Shimura's Construction
The idea behind Deligne's construction dates back to Eichler's study of the
zeta functions of modular curves; these functions can be characterized as the
Mellin transforms of cusp forms of weight 2 (see [Eich54]).
If Γ is a congruence subgroup, then there is a one-to-one correspondence
between cusp forms f ∈S2(Γ) and holomorphic diﬀerentials f(z) dz on XΓ .
Hence dim S2(Γ) = g = g(XΓ ), where g(XΓ ) denotes the genus of XΓ .
Formulae for the genera of the curves XΓ can be found in the book of Shimura
(1971). If Γ = Γ0(N) then the notation XΓ = X0(N) is often used. A modular
curve X0(N) is an algebraic curve deﬁned over Q, such that the Riemann
surface X0(N)(C) is identiﬁed to the compact quotient Γ0(N)\H in such a
way that
X0(N)(C) ←→Γ0(N)\H, H = H ∪Q ∪∞;
Y0(N)(C) ←→Γ0(N)\H
for an aﬃne algebraic curve Y0(N) which is an algebraic curve deﬁned over Q
(see §6.4.2).
Let us choose a Hecke basis {f1, . . . , fg} and consider the corresponding
Euler products L(s, fi) (see (6.3.37)).
Eichler discovered that the zeta function of the modular curve X0(N) has
the form
ζ(s)ζ(s −1)L(X0(N), s)−1
where the L - function L(X0(N), s) coincides upto a ﬁnite number of Euler
factors (corresponding to the divisors of the level N) with the product
g

i=1
L(s, fi).
Recall that the L-function L(X, s) coincides with the L-function of the l-adic
representation of Gal(Q/Q) on the Jacobian JX = J0(N) of the curve X0(N).
Using the L-functions L(s, fi) one can also obtain a decomposition of the
Jacobian into a product of simple Abelian varieties (upto isogeny):
J0(N) ∼= A1 × · · · × Ar.
(6.4.4)
One proves that the endomorphism algebra End Aj ⊗Q = Kj is a totally real
extension of Q generated by the Hecke eigenvalues λf(m) ((m, N) = 1) of a
cusp form f(z) = ∞
n=1 a(n)e(nz) ∈S2(Γ0(N)). One has
L(Aj, s) =

σ
L(s, f σ),
where σ runs through the embeddings σ : Kj →R, and

320
6 Zeta Functions and Modular Forms
f σ(z) =
∞

n=1
a(n)σe(nz) ∈S2(Γ0(N)).
(6.4.5)
In particular, [Kj : Q] = dim Aj.
A detailed exposition of these results can be found in the book of Shimura
(1971).
The especially interesting case g(X0(N)) = 1 arises only for N =11, 14,
15, 17, 19, 20, 21, 24, 27, 32, 36, 49, when the vector space S2(Γ0(N)) is
generated by a single cusp form with integral Fourier coeﬃcients. If N = 11
then
f(z) = η(z)2η(11z)2,
where
η(z) = e(z/24)
∞

m=1
(1 −e(mz))
(6.4.6)
is the Dedekind η-function. For N = 36 we have
f(z) = η(12z)2θ(z),
(6.4.7)
where θ(z) = 
n∈Z e(n2z) is the theta function (cf. [Frey86]).
6.4.3 The Shimura-Taniyama-Weil Conjecture
is discussed in more detail in Chapter 7 in connection with Fermat's Last
Theorem which have been completely proved in [Wi], [Ta-Wi], together with
the Shimura-Taniyama-Weil conjecture (the STW conjecture) for semi-stable
elliptic curves (cf. also [CSS95] [Tan57], [Wei67], [Frey86], [Gel76]). The STW
conjecture was proved in full generality in 1999 by Ch.Breuil, B.Conrad,
F.Diamond and R.Taylor (cf. [Da99] and Chapter 7 for relevant techniques).
An elliptic curve E deﬁned over Q is called a modular elliptic curve (a
Weil curve) if there exists a non constant morphism ϕN : X0(N) →E. The
Shimura-Taniyama-Weil conjecture says that every elliptic curve over Q is
modular. The smallest number N with this property is called the analytic
conductor of E. In this case E has good reduction modulo all primes p not
dividing N, and its L-function coincides with the Mellin transform of a cusp
form f ∈S2(Γ0(N)):
L(E, s) = L(s, f).
In particular, the function L(E, s) admits an analytic continuation to the
entire complex plane and satisﬁes a functional equation of the type
Λ(E, s) = (2π/
√
N)−sΓ(s)L(E, s) = ±Λ(E, 2 −s).
This conjecture seems to be both very natural, and surprising since it estab-
lishes a correspondence between two quite diﬀerent kinds of object: elliptic
curves over Q and primitive cusp forms of weight 2 with integral coeﬃcients.
Before Wiles' proof, the conjecture has been veriﬁed for a number of curves,

6.4 Modular Forms and Galois Representations
321
in particular for all curves with complex multiplication. In the latter case the
l-adic Galois representation on the Tate module turns out to be Abelian, and
one proves ﬁrst that its L-function coincides with the L-function of a Hecke
character of the corresponding imaginary quadratic ﬁeld ("Grössencharakter").
The analytic continuation and functional equation of these functions is known
(see 6.2.4), so it follows from Weil's inverse theorem that L(E, s) = L(s, f) for
some primitive cusp form f of weight 2, which is equivalent to the Shimura-
Taniyama-Weil conjecture. In the above examples the curve X0(36) admits
complex multiplication by Q(√−3), whereas the curve X0(11) has no complex
multiplication.
The Shimura-Taniyama-Weil conjecture has a number of interesting arith-
metical corollaries, in particular concerning Fermat's last theorem (cf. [Wi],
[Ta-Wi], [Ri], [CSS95], [Frey86], [Se87] and Chapter 7).
There is an analogue of the Shimura-Taniyama-Weil conjecture describing
all simple Abelian varieties with the property that the degree of the endomor-
phism algebra over Q coincides with the dimension of the variety. These vari-
eties are thought to correspond to simple factors of the Jacobians of modular
curves [Se87], [Wei71].
6.4.4 The Conjecture of Birch and Swinnerton-Dyer
(cf. [BSD63], [Ta65a], [Man71], [CW77], [Koly88], [Rub77], and [CR01] for
a recent progress). This deep conjecture gives a relation between the most
important arithmetical invariants of an elliptic curve E over a number ﬁeld
K, and the analytic behaviour of the L-function L(E, s) = L(E/K, s) at the
point s = 1. These arithmetical invariants are: rE = rk E(K) (the rank of
E over K), E(K)tors the torsion subgroup, RE the regulator of E, i.e. the
determinant of the Néron-Weil pairing hE on
E(K)/E(K)tors ⊂RrE,
and the Shafarevich-Tate group X(E, K) of E over K. By deﬁnition
L(E, s) =

v
Lv(E, s),
(6.4.8)
where
Lv(E, s)−1 = 1 −a(pv)Nv−s + Nv1−2s,
a(pv) = Nv + 1 −Card E(OK/pv)
for all places v where E has good reduction, and
Lv(E, s)−1 = 1 −a(pv)Nv−s,
a(pv) = ±1 or 0
for places v with bad reduction, according to the type of bad reduction of
E mod pv. Here it is assumed that E is deﬁned over OK, and that it coincides
with its Néron model (minimal model) (cf. §5.2).

322
6 Zeta Functions and Modular Forms
In view of the "Riemann conjecture over a ﬁnite ﬁeld" (see (W4) of §6.1.3)
the following estimate holds: |a(pv)|v ≤2
√
Nv, which implies the absolute con-
vergence of the series L(E, s) for Re(s) > 3/2. However, in order to formulate
the conjecture we need stronger analytic properties: we assume the hypothesis
of Hasse-Weil on the existence of an analytic continuation of L(E, s) to the
entire complex plane.
The conjecture of Birch and Swinnerton-Dyer (BSD) consists of two parts
(cf. [Bir63], [BSD63]):
a) the order of the zero nE = ords=1L(E, s) coincides with the rank rE
b) assume that the Shafarevich-Tate group of E over K is ﬁnite; then as
s →1 the following asymptotic formula holds:
L(E, s) ∼(s −1)rE RE|X(E, K)|
|E(K)tors|2 M,
(6.4.9)
where M = 
v∈SE mv is an explicitly written product of local Tamagawa
factors over the set SE of all Archimedean places and places where E has
bad reduction, mv =

E(Kv) |ω|v, ω being the Néron diﬀerential of E.
For example, if K = Q an elliptic curve E can be deﬁned by the equation
y2 + a1xy + a3y = x3 + a2x2 + a4x + a6
(ai ∈Z),
(6.4.10)
which is minimal in the sense that the absolute value of its discriminant is
minimal; in this case the Néron diﬀerential has the form dx/(2y + a1 + a3)
([Silv86]).
The BSD conjecture is closely related to the Shimura-Taniyama-Weil con-
jecture, because the analytic properties of the functions L(E, s) = ∞
n=1 a(n)n−s
and L(E, χ, s) = ∞
n=1 χ(n)a(n)n−s imply the modular properties of the cor-
responding functions f(z) = ∞
n=1 χ(n)a(n)e(nz) in view of the inverse the-
orem of Weil (see section 6.3). In all known cases the following functional
equation holds:
Λ(E, s) = (2π/
√
N)−sΓ(s)L(E, s) = ε(E)Λ(E, 2 −s),
(6.4.11)
where the number ε(E) = ±1 is called the sign (or the "root number") of E.
These are the Weil curves for which some partial results on the validity
of the BSD conjecture are known. Let ϕ : X0(N) →E deﬁne a Weil curve E
of conductor N, and let ω be the Néron diﬀerential of E. Then the pullback
ϕ∗ω coincides upto a sign with the diﬀerential
f(z)dq
q = 2πif(z) dz on X0(N),
where f ∈S2(Γ0(N)) is a primitive cusp form of level N. One has L(E, s) =
L(f, s) and the following equation holds

6.4 Modular Forms and Galois Representations
323
L(E, 1) = 2π
 ∞
0
f(iy) dy.
(6.4.12)
The integral is absolutely convergent in view of the exponential decay of f(z)
as y →∞or y →0; it coincides essentially with the Tamagawa factor m∞
from (6.4.9).
Theorem 6.16 (Coates J., Wiles A. (1977)).
Let E/K be an elliptic
curve with complex multiplication and let K be either Q or the complex mul-
tiplication ﬁeld. Then the condition rE ≥1 implies that nE ≥1, i.e. that
L(E, 1) = 0.
The proof of this theorem is based on an explicit calculation of the special
value (6.4.12), which is upto a rational multiplicative constant equal to the
Tamagawa factor m∞. From the existence of a point of inﬁnite order it follows
that this multiplicative constant is divisible by inﬁnitely many primes, and is
hence zero.
A generalization of this result in another direction was found by R. Green-
berg (cf. [Gr83]): let E/Q be an elliptic curve with complex multiplication. If
the number nE is odd then either the group X(E, Q) is inﬁnite and contains
a divisible group Qp/Zp for every good reduction prime p ̸= 2, 3 (i.e. for
which E mod p is an elliptic curve with a non-trivial point of order p over
Fp). Developing these ideas K. Rubin and V.Kolyvagin constructed examples
of curves E/Q with complex multiplication and with ﬁnite Shafarevich-Tate
groups X(E, Q). He also proved the following deep fact: if for such a curve
one has rE = rE(Q) > 1 and ε(E) = −1, then nE ≥3. For example, the
curve E : y2 = x3 −226x has rank 3 (generators modulo torsion are:(−1, 15),
(−8, 96), (121/4, 1155/8)), and ε(E) = −1; hence nE ≥3 (comp. with the
examples in §6.3.2). These results where extended by Kato to curves without
complex multiplication, using Euler systems, cf. [Kato2000], [MazRub04].
Although these results concern L-functions of a complex variable, they use
a lot of p-adic theory and properties of p-adic L-functions. Neither the do-
main of deﬁnition nor the set of values of these L-functions are complex; they
are p-adic. These L-functions make it possible to control the p-adic behav-
iour of special values of the type L(E, χ, 1) (where χ is a Dirichlet character)
which are algebraic numbers (upto a multiplicative factor of the form m∞)
and may thus be regarded as p-adic numbers. Also, the p-adic L-functions
describe the behaviour of the Selmer groups and the Shafarevich-Tate groups
under Abelian extensions of the ground ﬁeld K, which is either Q or the
complex multiplication ﬁeld of the given elliptic curve [Man71], [Man76],
[Man78], [Iwa72], [Coa89], [MW83], [MSD74], and for recent progress, [Coa01],
[Colm03], [CM98].
An important development of the BSD conjecture for modular curves (in-
cluding curves with complex multiplication) was obtained by Gross and Zagier
(cf. [GZ86], [GKZ87], [Coa84]). They proved for elliptic Weil curves E that
if nE = 1 then rE ≥1. They established furthermore the existence of el-
liptic curves E/Q for which nE ≥3. These results are based on the theory

324
6 Zeta Functions and Modular Forms
of special points on modular curves (Heegner points). It was already known
in the nineteenth century how to construct solutions to Pell's equation using
either special values of trigonometric functions (Dirichlet), or special values
of the Dedekind eta-function (Kronecker) (see Part I, §1.2). Heegner in his
work [Hee52] successfully used special values of elliptic modular functions to
ﬁnd rational points on elliptic curves, making it possible to ﬁnd eﬀectively
all imaginary quadratic ﬁelds with class number one. In the work of Birch,
[Bir75], extending and clarifying the ideas of [Hee52], the existence of ra-
tional points of inﬁnite order on certain elliptic curves was ﬁrst established
without explicit evaluation of the coordinates of these points, and without
veriﬁcation that these points indeed satisfy the equation of the given curve.
Let ϕ : X0(E) →E be a Weil parameterization of a given elliptic curve
E/Q. As was noted above (cf. §6.3.2) the set H/Γ0(N) ⊂X0(N)(C) parame-
trizes the isomorphism classes over C of isogenies Ez →Ez/⟨P⟩with cyclic
kernel ⟨P⟩where Ez(C) ∼= C/⟨1, z⟩is a varying elliptic curve associated to
the point z ∈H. Let K be an imaginary quadratic ﬁeld of discriminant
D < 0 with maximal order O. Suppose that there exists an ideal i ⊂O
such that O/i ∼= Z/NZ (this condition is satisﬁed for example, when D =
square (mod4N) and (D, 2N) = 1). Then one can associate to the isogeny
C/O →C/i−1 a point z on H/Γ0(N), and it is not diﬃcult to verify that
this point is rational over the Hilbert class ﬁeld HK (the maximal unramiﬁed
Abelian extension) of K. The point ϕ(z) = y ∈E(HK) is called the Heegner
point on E; therefore the point yK = 
σ∈Gal(HK/K) yσ ∈E(K) is deﬁned
over K. Birch and Stephens made extensive calculations of Heegner points
in order to ﬁnd out under which assumptions the point yK has inﬁnite or-
der. They suggested a conjecture, expressing for L(E, 1) = 0 the special value
L′(E, 1) in terms of the product of m∞and the Néron-Tate height h(yK) of
yK (cf. [BS83]). This conjecture was proved by Gross and Zagier ([GZ86]).
A further signiﬁcant extension of these results is contained in works of V.
A. Kolyvagin in [Koly88]. He proved that if L(E, 1) ̸= 0 and yK has ﬁnite
order then the groups E(Q) and X(E, Q) are ﬁnite, proving the ﬁrst part
of the BSD conjecture. The methods developed by V. A. Kolyvagin make it
possible to ﬁnd eﬀectively in terms of K, E and yK the smallest positive
integer annihilating the groups E(Q) and X(E, Q). Thus one also has an
approach to proving the second part of the BSD conjecture. The theory of
Euler systems due to V. A. Kolyvagin, cf. [Koly90], see also [MazRub04], also
allows one to consider from a uniﬁed point of view Gauss sums, elliptic units,
cyclotomic units and Heegner points, and it gives an approach to proving the
"main conjecture" of Iwasawa theory (see §5.4.5) which describes the Iwasawa
modules attached to these objects in terms of p-adic L-functions.
Heegner points, provide a lot of points on elliptic curves deﬁned over ring
class ﬁelds of imaginary quadratic ﬁelds.
Mazur formulated a number of conjectures concerning the variation of
Mordell-Weil groups in towers of ring class ﬁelds with restricted ramiﬁcation

6.4 Modular Forms and Galois Representations
325
(cf. [Maz83], [MazRub03]) that Heegner points should account, in a suitable
sense, for a majority of points rational over the ﬁelds in the tower (assuming
that the elliptic curve does not have complex multiplication by the imaginary
quadratic ﬁeld in question).
Vatsal [Vats03] and Cornut [Cor02] proved a version of this conjecture.
A remarkable fact is that it is sometimes quite easy to verify that the
special value L(E, 1) vanishes, but it is extremely diﬃcult to ﬁnd a point of
inﬁnite order on a curve E. In the example of Cassels-Bremner E : y2 =
x3 + 877x (cf. [Cas84], [Cas66]) the vanishing of the special value L(E, 1)
follows from the fact that E is odd; on the other hand the generator of the
group E(Q)/E(Q)tors ∼= Z looks very complicated (see Part I, §1.3.2).
The results of Gross and Zagier found an unexpected application to
Gauss's famous problem of ﬁnding all the imaginary quadratic ﬁelds Q(
√
−d)
with class number h(−d) equal to a given number h. Previously these ﬁelds
had been found explicitly in the cases h = 1 and h = 2 ([Hee52] , [Abr74],
[Ba71], [Deu68], [St67], [St69]).
In 1976 Goldfeld showed in [Gol76] that if there is a cusp form f ∈
Sk(Γ0(N)) whose Mellin transform has a zero at 1 of essentially high order (3
or 4, depending on k and N) then for any positive integer h ≥1 one can ﬁnd
an eﬀective upper bound for d such that h(−d) = h. The desired cusp form
has since been found: Mestre showed in [Me85] that the elliptic curve
y2 + y = x3 −7x + 6
(6.4.13)
of conductor 5077 and rank 3 (E(Q) ∼= Z3 with generators (1,0), (6,0), (0,2))
is a Weil curve, i.e. its L-function L(E, s) = ∞
n=1 a(n)n−s is the Mellin
transform of some cusp form f(z) = ∞
n=1 a(n)e(nz) ∈S2(Γ0(5077)). From
the results of Gross and Zagier and from the fact that E is odd (i.e. ε(E) = −1)
one deduces that nE ≥3, so f is a cusp form with the required properties.
The use of f in the theorem of Goldfeld makes it possible to prove that for a
positive integer T ≥1 there exists an eﬀective constant B(T) > 0 such that
if d possesses T diﬀerent prime divisors, then the following estimate holds:
h(−d) ≥B(T) log d. If d is a prime then d log d < 55h(−d). Using this result
all d with h(−d) = 3 were found, cf. [Oe83].
For recent developments concerning Gross-Zagier formulas, we refer to
[BeDa97] and [Borch99].
A fruitful use of L-functions of elliptic curves and modular forms was
demonstrated in the work J.Tunnell (cf. [Tun83], [Frey86]) on a classical
Diophantine problem concerning congruent numbers. A natural number N
is called a congruent number if it is the area of some right angle triangle, all
of whose sides have rational lengths. For example, the number 6 is congruent
as it is the area of the Egyptian triangle with the sides 3, 4, and 5. It turns
out that the smallest congruent number is 5 which is equal to the area of the
triangle with sides 3/2, 20/3, 41/6. The fact that N = 1 is not congruent

326
6 Zeta Functions and Modular Forms
provides an excellent example of use of Fermat's inﬁnite descent argument
and also proves Fermat's Last Theorem for the exponent 4.
Indeed, suppose that Z > Y > X > 0 are rational numbers satisfying
X2 + Y 2 = Z2,
1
2XY = N.
(6.4.14)
From these equalities we obtain
(X + Y )2 = Z2 + 4N,
(X −Y )2 = Z2 −4N.
(6.4.15)
Multiplying the equations (6.4.15) together shows that the positive integers
u = Z/2 and v = (Y 2 −X2)/4 satisfy the equation
v2 = u4 −N 2.
(6.4.16)
Put now N = 1 and write the numbers u, v > 0, u, v ∈Q in the form: u = a/b,
v = c/d, where a and b are coprime and c and d are coprime. As a result one
obtains from (6.4.16)
c2b4 = a4b2 −b4d2 = (a4 −b4) · d2.
Taking into account the fact that GCD(c, d) = 1 and GCD(a4 −b4, b4) = 1,
we see that b4 = d2, i.e.
a4 −b4 = c2.
(6.4.17)
We now rewrite (6.4.17) in the form (a2 −c)(a2 + c) = b4 and note that a
prime number dividing both numbers a2 −c and a2 + c divides also 2a2 and
2c. This implies that GCD(a2 −c, a2 + c) = 1 or 2 by the coprimality of a
and b. However, the product of these factors is a fourth power, so we have the
following two possibilities:
8
a2 −c = 2C4
a2 + c = 8D4,
or
8 a2 −c = 8D4
a2 + c = 2C4,
where C > 0, C odd, and GCD(C, D) = 1. In both cases one has a2 =
C4 + 4D4, i.e. D4 = (a −C2)(a + C2). Now considering the factors a −C2
and a + C2, we see that a + C2 = 2A4 and a −C2 = 2B4 This in turn implies
that the natural numbers A, B, C satisfy the relation A4 −B4 = C2, and
max{A, B, C} < max{a, b, c}. We have reached a contradiction.
On the other hand it is not diﬃcult to see that the curve (6.4.16) is bi-
rationally isomorphic to a plane cubic curve EN having Weierstrass form
y2 = x3 −N 2x. In order to show this one uses the substitution
X = (N 2 −x2)/y,
Y = 2Nx/y,
Z = (N 2 + x2)/y.
Reducing modulo primes shows that the points of ﬁnite order on EN(Q) are
precisely those for which y = 0, together with the point at inﬁnity. Thus

6.4 Modular Forms and Galois Representations
327
one obtains the remarkable fact that N is congruent if and only if the group
EN(Q) is inﬁnite.
J.B.Tunnell proved in 1983 that if an odd natural number N is a congruent
number then
Card{(x, y, z) ∈Z3 | 2x2 + y2 + 8z2 = N} =
2Card{(x, y, z) ∈Z3 | 2x2 + y2 + 32z2 = N},
Assuming the Birch-Swinnerton-Dyer conjecture for the curves EN he showed
that this condition is also suﬃcient.
In connection with the Shimura-Taniyama-Weil conjecture we point out
the result of G.V.Belyi, [Be79]: every algebraic curve deﬁned over a number
ﬁeld can cover the projective line with ramiﬁcation points only lying above
0, 1, and ∞, the cover being deﬁned over a number ﬁeld. From this result it
follows in particular that every elliptic curve over Q admits a parameterization
by modular forms with respect to a subgroup of ﬁnite index in SL2(Z) (which
is not necessarily a congruence subgroup). This result made it possible to
solve the embedding problem over certain cyclotomic extensions of Q, and to
construct Galois extensions of such ﬁelds whose Galois groups are given ﬁnite
simple groups with two generators. Previously the embedding problem over
Q was solved by I.R.Shafarevich for all ﬁnite solvable groups in [Sha54].
6.4.5 The Artin Conjecture and Cusp Forms
(cf. [DS75], [L71b], [L80], [Tun81] [Hen76], [Hir88], [Gel95]). The correspon-
dence between primitive cusp forms of weight 2 with respect to Γ0(N) and
elliptic curves given above by the Shimura-Taniyama-Weil conjecture (see
also Chapter 7), has a remakable analogue in the case of cusp forms of weight
1. Langlands has conjectured, and Deligne and Serre have precisely formu-
lated a link between primitive cusp forms f(z) = 
n=1 a(n)e(nz) ∈S1(N, ψ)
and irreducible two dimensional complex Galois representations
ρf : G(Q/Q) →GL2(C).
(6.4.18)
The condition that f is primitive includes the conditions
f|1T(p) = a(p)f,
a(1) = 1
((p, N) = 1).
(6.4.19)
Deligne and Serre proved the existence of irreducible representations ρf un-
ramiﬁed outside the divisors of N such that 1) detρf = ρψ is a one dimensional
Galois representation which corresponds via the Kronecker-Weber theorem to
an odd Dirichlet character ψ : (Z/NZ)× →C×, ψ(−1) = −1, and 2) the im-
age Tr Fρf ,p coincides with a(p) for all p, (p, N) = 1. For Eisenstein series
f ∈M1(N, ψ) with conditions (6.4.19) such Galois representations can be
easily constructed and turn out to be direct sums of Dirichlet characters.

328
6 Zeta Functions and Modular Forms
A remarkable consequence of the construction is the proof of the Ramanujan-
Petersson conjecture in the case of weight k = 1:
|a(p)| < 2p(k−1)/2 = 2.
(6.4.20)
Indeed the number Tr Fρf ,p = a(p) is the sum of two roots of unity, and
the estimate (6.4.20) therefore holds for Eisenstein series (however, for weight
k = 1 this is also true for the cusp forms).
The Ramanujan-Petersson conjecture is related to the Sato-Tate Con-
jecture on the uniform distribution of the arguments ϕp of Frobenius auto-
morphisms in the segment [0, π] with respect to the measure 2
π sin2 ϕ dϕ (cf.
Chapter I in [Se68a], [Mich01] and §6.5.1).
The construction of ρf uses the reduction mod l of the l-adic representa-
tions attached to modular forms of weight k ≥2. First one proves that a given
cusp form of weight 1 has the same Fourier coeﬃcients modulo a prime ideal,
as a cusp form g of a higher weight k ≥2. Then one veriﬁes that the l-adic
representation ρg mod l can be lifted to characteristic zero, and one gets as
a result the desired complex representation ρf, for which properties 1) and 2)
are valid since they are satisﬁed modulo inﬁnitely many prime numbers.
The conditions 1) and 2) on the representation ρf mean that the L-series
L(s, f) (the Mellin transform of f) coincides with the Artin L-series of the
representation ρf, i.e.
L(s, f) = L(ρf, s),
(6.4.21)
and the analytic properties of L(ρf, s) follow from those of L(s, f) described
in 6.3.3. For complex representations ρ : G(Q/Q) →GLn(C) the statement
that L(ρ, s) is holomorphic is known as the Artin conjecture. It follows that
this conjecture is true for representations of the type ρ = ρf. Conversely if
one knows for a two dimensional representation ρ with odd determinant detρ
that the functions L(ρ ⊗χ, s) for all Dirichlet characters χ are holomorphic,
then the existence of a cusp form f satisfying (6.4.17) can be deduced from
Weil's inverse theorem (see §6.3.3). It turns out that the image ρ(G(Q/Q)) of
a two dimensional irreducible representation ρ in PGL2(C) is always one of
the following groups:
1) a dihedral group in which case the representation ρ is monomial (i.e. in-
duced from a character of a cyclic subgroup);
2)A4 (tetrahedral case);
3) S4 (octahedral case);
4) A5 (icosahedral case).
Langlands and Tunnell proved the conjecture on the existence of a cusp
form f for which ρ = ρf in cases 2) and 3). The validity of the Artin conjecture
in case 4) remains unknown in general. However J. Buhler (see in [Hen76])

6.4 Modular Forms and Galois Representations
329
gave an example of a representation of type 4) for which the Artin conjecture is
valid, as well as the existence of the corresponding cusp form. In this example
Kerρ = G(Q/K) where K is the splitting ﬁeld of the polynomial
x5 + 10x3 −10x2 + 35x −18,
and N = 800. An interesting program was outlined by R.Taylor to solve
the Artin conjecture for icosahedral Galois representations (see [Tay02] for a
recent progress).
The Artin conductor
The number N in the construction of Serre and Deligne has an interpretation
as the Artin conductor of the representation ρf, which is deﬁned for every
ﬁnite dimensional Galois representation ρ : GQ →GL(V ) with ﬁnite image as
follows. Let p be a prime, p a prime ideal of the ring O ⊂Q of all algebraic
integers, p ∈p. Then the image of the decomposition group
G(p) = {σ ∈GQ | σp = p},
is isomorphic to the Galois group of some ﬁnite extension F/Qp, ρ(G(p)) =
G(F/Qp). Let vF be the normalized p-valuation of F, i.e. vF (F ×) = Z. Deﬁne
the ramiﬁcation groups
Gp,i = {σ ∈G(F/Q) | vF (x −σ(x)) > i for all x ∈OF }
and let Vp,i = V Gp,i. In particular Gp,0 is the inertia subgroup, and the fact
that ρ is unramiﬁed over p is equivalent to saying that V = Vp,0.
Then the Artin conductor is deﬁned (cf. [Ar30], [Ar65], [Se63]) by
N = N(ρ) =

p
pn(p,ρ),
(6.4.22)
where the exponent n(p, ρ) is deﬁned by
n(p, ρ) =
∞

i=0
1
(Gp,o : Gp,i) dim V/Vp,0.
(6.4.23)
This turns out to be an integer (at ﬁrst sight it only looks like a rational
number). One has n(p, ρ) = dim V/Vρp,0 + bp(V ), where the number bp(V )
is called the wild invariant of the representation ρ over p. One can show that
for one dimensional representations the Artin conductor coincides with the
conductor of the corresponding character of the idele class group, attached to
it by class ﬁeld theory (cf. [Se63]).

330
6 Zeta Functions and Modular Forms
6.4.6 Modular Representations over Finite Fields
(cf. [Se87]). Based on a deep analysis of previous constructions, Serre suggested
in 1987 a universal description of all two dimensional Galois representations
over ﬁnite ﬁelds in terms of cusp forms. Let p be a prime number, p a prime
ideal of the ring of all algebraic integers O ⊂Q dividing p (i.e. p ∈p). We call
a representation
ρ : GQ →GL(2, Fp)
(6.4.24)
a modular representation of type (N, k, ψ), if for some modular form
f(z) =
∞

n=1
a(n)e(nz) ∈Sk(N, ψ),
which is an eigenform of the Hecke operators normalized by a(1) = 1, the
following condition is satisﬁed
Tr(Fρ,l) ≡a(l) mod p
(6.4.25)
for all primes l ∤Np.
Serre conjectured that every irreducible representation (6.4.24) is modular
for some N not divisible by p. He also described explicitly the numbers N and
k and the character ψ, assuming that N and k are minimal under the condition
(N, p) = 1. According to this conjecture the number N is determined by the
ramiﬁcation of ρ outside p in the same way as the Artin conductor:
N = N(ρ) =

l̸=p
ln(l,ρ).
The weight k is deﬁned by ramiﬁcation properties of ρ at p, and the character
is determined by the following condition on the determinant of ρ:
detρ(Frobl) ≡ψ(l)lk−1 mod p
(l ̸ | Np).
Serre gave many concrete examples of representations ρ for which the corre-
sponding cusp form f with N, k and ψ as predicted by the conjecture, can be
explicitly constructed.
We point out some remarkable consequences of this conjecture. First of all
it implies the validity of the Shimura-Taniyama-Weil conjecture for elliptic
curves over Q and for simple Abelian varieties with real multiplication (see
§6.4.3 and Chapter 7). Also this conjecture would imply Fermat's last theorem.
This corollary can be shown using the elliptic curve of Frey E : y2 = x(x −
A)(x + B), where
A = ap, B = bp, C = cp a, b, c ∈Z,
p > 5

6.4 Modular Forms and Galois Representations
331
are integers satisfying the condition A + B + C = 0, ABC ̸= 0 (a non-trivial
solution of Fermat's equation), see Chapter 7.
According to this conjecture of Serre, the Galois representation
ρ : GQ →Aut Ep ∼= GL2(Fp)
on points of order p of the elliptic curve of Frey-Hellegouarch should corre-
spond to a cusp form f ∈S2(Γ0(2)). However,
dim S2(Γ0(2)) = g(X0(2)) = 0,
hence such cusp form cannot exist.
Another approach to proving the non-existence of the elliptic curves of
Frey-Hellegouarch consists of applying to the corresponding "arithmetic sur-
face" (a scheme over Spec Z of dimension 2) an analogy of a result on non-
singular projective surfaces of general type over an algebraically closed ﬁeld
of characteristic zero (the inequality of Bogomolov-Miyaoka-Yau,
[Miy77],
[Par87].

6.5 Automorphic Forms and The Langlands Program
6.5.1 A Relation Between Classical Modular Forms and
Representation Theory
(cf. [Bor79], [PSh79]). The domain of deﬁnition of the classical modular forms
(the upper half plane) is a homogeneous space H = {z ∈C | Im z > 0} of the
reductive group G(R) = GL2(R):
H = GL2(R)/O(2) · Z,
where Z = {
 x
0
0
x

|x ∈R×} is the center of G(R) and O(2) is the orthogonal
group, see (6.3.1). Therefore each modular form
f(z) =
∞

n=0
a(n)e(nz) ∈Mk(N, ψ) ⊂Mk(ΓN)
(6.5.1)
can be lifted to a function ˜f on the group GL2(R) with the invariance condition
˜f(γg) = ˜f(g) for all γ ∈ΓN ⊂GL2(R).
In order to do this let us consider the function
˜f(g) =

f(g(i))j(g, i)−k
if detg > 0,
f(g(−i))j(g, −i)−k
if detg < 0,
(6.5.2)
where g =

a
c
b
d

∈GL2(R) and j(g, i) = |detg|−1/2(cz + d) is the factor of
automorphy.
One has ˜f(xg) = exp(−ikθ) ˜f(g) if x =

cos θ
sin θ
−sin θ
cos θ

is the rotation
through the angle θ.
Consider the group GL2(A) of non-degenerate matrices with coeﬃcients
in the adele ring A and its subgroup
U(N)
(6.5.3)
=

g = 1 ×

p
gp ∈GL2(A) | gp ∈GL2(Zp), gp ≡
1
0
0
1

mod NZp

.
From the chinese remainder theorem (the approximation theorem) one obtains
the following coset decomposition:
ΓN\GL2(R) ∼= GL2(Q)\GL2(A)/U(N),
(6.5.4)
using which we may consider ˜f as a function on the homogeneous space (6.5.4),
or even on the adele group GL2(A).

6.5 Automorphic Forms and The Langlands Program
333
The action of GL2(A) on ˜f by group shifts deﬁnes a representation π = πf
of the group GL2(A) in the space of smooth complex valued functions on
GL2(A), for which

π(h) ˜f

(g) = ˜f(gh) (g, h ∈GL2(A)).
The condition that the representation πf be irreducible has a remarkable
arithmetical interpretation: it is equivalent to f being an eigenfunction of the
Hecke operators for almost all p. If this is the case then one has an inﬁnite
tensor product decomposition
π =
=
v
πv,
(6.5.5)
where the πv are representations of the local groups GL2(Qv) with v = p or
∞.
Jacquet and Langlands chose irreducible representations of groups such as
GL2(Qv) as a starting point for the construction of L-functions (cf. [JL70],
[Bor79]). These representations can be classiﬁed and explicitly described. Thus
for the representations πv in (6.5.5) one can verify for almost all v = vp
that the representation πv has the form of an induced representation πv =
Ind(µ1⊗µ2) from a one dimensional representation of the subgroup of diagonal
matrices
(µ1 ⊗µ2)
x
0
0
y

= µ2(x)µ1(y),
where µi : Q×
p
→C× are unramiﬁed quasicharacters (see §6.2.4). This
classiﬁcation makes it possible to deﬁne for almost all p an element hp =

µ1(p)
0
0
µ2(p)

∈GL2(C). From this one can construct the following Euler prod-
uct (the L-function of the automorphic representation π)
L(π, s) =

p̸∈S
L(πp, s) =

p̸∈S
det(12 −p−shp)−1
(6.5.6)
in which the product is extended over all but a ﬁnite number of primes.
It turns out that the function L(π, s) coincides essentially with the Mellin
transform of the modular form f:
L(s, f) = L(πf, s + (k −1)/2).
The notion of a primitive form f also takes on a new meaning: the correspond-
ing function ˜f from the representation space of an irreducible representation π
must have a maximal stabilizer. The theory of Atkin-Lehner can be reformu-
lated as saying that the representation πf occurs with multiplicity one in the
regular representation of the group GL2(A) (the space of all square integrable
functions).

334
6 Zeta Functions and Modular Forms
More generally, an automorphic representation is deﬁned as an irreducible
representation of an adele reductive group G(A) in the space of functions on
G(A) with some growth and smoothness conditions.
Jacquet and Langlands constructed for irreducible admissible automorphic
representations π of the group GL2(A) analytic continuations of the corre-
sponding L-functions L(π, s), and established functional equations relating
L(π, s) to L(˜π, 1 −s), where ˜π is the dual representation. For the functions
L(πf, s) this functional equation is exactly Hecke's functional equation (see
(6.3.44)).
Note that the notion of an automorphic representation includes as special
cases: 1) the classical elliptic modular forms, 2) the real analytic wave modular
forms of Maass, 3) Hilbert modular forms, 4) real analytic Eisenstein series
of type ′
ys
|cz + d|2s , 5) Hecke L-series with Grössen-characters (or rather
their inverse Melin transforms), 6) automorphic forms on quaternion algebras
etc.
Interesting classes of Euler products are related to ﬁnite dimensional com-
plex representations
r : GL2(C) →GLm(C).
Let us consider the Euler product
L(π, r, s) =

p
L(πp, r, s),
(6.5.7)
where
L(πp, r, s) = det(1m −p−sr(hp))−1.
These products converge absolutely for Re(s) ≫0, and, conjecturally, ad-
mit analytic continuations to the entire complex plane and satisfy functional
equations (cf. [Bor79], [BoCa79], [L71a], [Del79], [Se68a]).
This conjecture has been proved in some special cases, for example when
r = SymiSt is the ith symmetric power of the standard representation St :
GL2(C) →GL2(C) for i = 2, 3, 4, 5 (cf. [Sh88]).
The Ramanujan-Petersson conjecture, proved by Deligne, can be formu-
lated as saying that the absolute values of the eigenvalues of hp ∈GL2(C) for
a cusp form f are all equal to 1.
As a consequence of the conjectured analytic properties of the functions
(6.5.7) one could deduce the following conjecture of Sato and Tate about
the distribution of the arguments of the Frobenius elements: let α(p) = eiϕp
(0 ≤ϕp ≤π) be an eigenvalue of the matrix hp deﬁned above. Then for
cusp forms f without complex multiplication (i.e. the Mellin transform of f is
not the L-function of a Hecke Grössencharacter (see §6.2.4) of an imaginary
quadratic ﬁeld) the arguments ϕp are conjecturally uniformly distributed in
the segment [0, π] with respect to the measure 2
π sin2 ϕ dϕ (cf. [Se68a]).

6.5 Automorphic Forms and The Langlands Program
335
In the case of complex multiplication the analytic properties of the L-
functions are reduced to the corresponding properties of the L-functions of
Hecke Grössencharacters (see §6.2.4), which imply the uniform distribution of
the arguments ϕp with respect to the usual Lebesgue measure.
The arithmetical nature of the numbers eiϕp is close to that of the signs
of Gauss sums α(p) = g(χ)/√p where g(χ) = p−1
u=1 χ(u)e(u/p), χ being a
primitive Dirichlet character modulo p. Even if χ is a quadratic character, the
precise evaluation of the sign α(p) = ±1 is rather delicate (see [BS85]). If χ
is a cubic character, i.e. if χ3 = 1 then p = 6t + 1, and the sums lie inside
the 1st, the 3rd or the 5th sextant of the complex plane. Using methods from
the theory of automorphic forms S.J.Patterson and D.R.Heath-Brown solved
the problem of Kummer on the distribution of the arguments of cubic Gauss
sums by means of a cubic analogue of the theta series, which is a certain auto-
morphic form on the threefold covering of the group GL2 ([Del80a], [HBP79],
[Kub69]).
6.5.2 Automorphic L-Functions
The approach of Jacquet-Langlands made it possible to extend the whole
series of notions and results concerning L-functions to the general case of
automorphic representations of reductive groups over a global ﬁeld K. Let G
be a linear group over K, GA = G(A) its group of points with coeﬃcients in
the adele ring of the ﬁeld K. Automorphic representations are often deﬁned as
representations belonging to the regular smooth representation of the group
GA, and one denotes by the symbol A(G/K) the set of equivalence classes of
irreducible admissible automorphic representations of GA. A representation π
from this class admits a decomposition π = ⊗vπv where v ∈ΣK runs through
the places of K and the πv are representations of the groups Gv = G(Kv). In
order to construct L-functions, the L-group LG of G is introduced. Consider
the tuple of root data (cf. [Bor79], [Spr81])
ψ0(G) = (X∗(T), ∆, X∗(T), ∆∨)
(6.5.8)
of the group G; here T is a maximal torus of G (over a separable closure of the
ground ﬁeld K); X∗(T) is the group of characters of T; X∗(T) the group of
one parameter subgroups of T and ∆(resp. ∆∨) is a basis of the root system
(resp. the dual basis of the system of coroots). The connected component
of the Langlands L-group LG0 is deﬁned to be the complex reductive group
obtained by inversion ψ0 →ψ∨
0 , whose root data is isomorphic to the inverse
ψ0(G)∨= (X∗(T), ∆∨, X∗(T), ∆).
(6.5.9)
If G is a simple group, then the group LG(C) can be characterized upto a
central isogeny by one of the types An, Bn, . . . , G2 of the Cartan-Killing
classiﬁcation. It is known that the map ψ0 →ψ∨
0 interchanges the types
Bn and Cn, and leaves all other types ﬁxed. Thus if G = Spn (respectively

336
6 Zeta Functions and Modular Forms
GSpn), then LG0 = SO2n+1(C) (resp. LG0 = Spin2n+1(C)). The whole group
LG is then deﬁned as the semi-direct product of LG0 with the Galois group
Gal(Ks/K) of an extension Ks of the ground ﬁeld K over which G splits (i.e.
its maximal torus T becomes isomorphic to GLr
1). This semi-direct product
is determined by the action of the Galois group ΓK = Gal(Ks/K) on the set
of maximal tori deﬁned over Ks.
The most important classiﬁcation result of the Langlands theory states
that if
π =
=
v
πv ∈A(G/K)
then for almost all v the local component πv corresponds to a unique conjugacy
class of an element hv in the group LG.
Let us consider the Euler product
L(π, r, s) =

v̸∈S
L(πv, r, s),
(6.5.10)
where S is a ﬁnite set of places of K,
L(πv, r, s) = det(1m −Nv−sr(hv))−1.
Langlands has shown that if π ∈A(G/K) then the product in (6.5.10)
converges absolutely for all s with suﬃciently large real part Re(s) (cf. [L71a]).
The product (6.5.10) deﬁnes an automorphic L-function only up to a ﬁnite
number of Euler factors. Although this is suﬃcient for certain questions related
to analytic continuation of these functions, the precise form of these missing
factors is very important in the study of the functional equations. A list of
standard conjectures on the analytic properties of the L-functions (6.5.10) can
be found in A.Borel's paper [Bor79]
We refer to recent introductory texts to the theory of automorphic L-
functions and the Langlands program: [BCSGKK3], [Bum97], [Iw97],
For the group G = GLn and the standard representation r = rn = St :
LG0
∼
→GLn(C) the main analytic properties of the L-functions (6.5.10) are
proved in [JPShS], [GPShR87], [Sh88], [JSh] (see also [Bum97], [BCSGKK3],
[CoPSh94]).
Also in the case G = GLn the multiplicity one theorem (an analogue of
the theorem of Atkin-Lehner) (cf. [AL70], [Mi89], [Li75]) has been extended
(cf. [Gel75], [Gel76]). This is closely related to the non-vanishing theorem: for
a cuspidal representation π one has L(π, rn, 1) ̸= 0.
For GL3 an analogue of Weil's inverse theorem (see §6.3.8) has been proved:
if all the L-functions of type L(π⊗χ, r3, s) (where χ is a Hecke character and π
is an irreducible admissible representation) can be holomorphically continued
to the entire complex plane, then the representation π can be realized in the
space of cusp forms ([CoPSh94], [JPShS]). More recent results on the case of
GLn, cf. [CoPSh02].

6.5 Automorphic Forms and The Langlands Program
337
Interesting classes of L-functions attached to Siegel modular forms were
introduced and studied in [An74], [An79a], [AK78]. These modular forms and
their L-functions have deep arithmetical signiﬁcance and are closely related
to the classical problem on the number of representations of a positive deﬁ-
nite integral quadratic form by a given integral quadratic form (as generating
functions, or theta-series). These numbers arise in Siegel's general formula
considered above (5.3.71). From the point of view of the theory of automor-
phic representations, Siegel modular forms correspond to automorphic forms
on the symplectic group G = GSpn. In this case the dual Langlands group
coincides with the universal covering Spin2n+1(C) of the orthogonal group
SO2n+1(C). To construct L-functions one uses the following two kinds of rep-
resentation of the L-group LG = Spin2n+1 ⋊Gal(Ks/K): ρ2n+1 and rn, where
ρ2n+1 is the standard representation of the orthogonal group, and rn is the
spinor representation of dimension 2n. It is convenient to consider the follow-
ing matrix realization of the orthogonal group:
SO2n+1(C) =

g ∈SL2n+1(C) | tgGng = Gn

,
with a quadratic form deﬁned by the matrix
Gn =
⎛
⎜
⎜
⎝
0n 1n
0
· · · · · · · · ·
1n 0n
0
0 · · ·
1
⎞
⎟
⎟
⎠,
1n =
⎛
⎜
⎜
⎝
1
0 · · · 0
0
1 · · · 0
· · · · · · · · · 0
0
0 · · · 1
⎞
⎟
⎟
⎠.
If π = ⊗vπv ∈A(GSpn/K) then for almost all v the representation πv corre-
sponds to a conjugacy class hv in LG whose image in the standard represen-
tation is given by a diagonal matrix of the type
ρ2n+1(hv) =

α1,v, · · · , αn,v, α−1
1,v, , α−1
n,v, 1

,
and in the spinor representation it becomes
rn(hv) = {β0,v, β0,vα1,v, · · · , β0,vαi1,vαi2,v · · · αim,v, · · ·},
where for every m ≤n all possible products of the type
β0,vαi1,vαi2,v · · · αim,v,
1 ≤i1 < i2 < · · · < im ≤n
arise.
The element hv is uniquely deﬁned upto the action of the Weyl group Wn
generated by the substitutions
β0,v →β0,vαi,v,
αi,v →α−1
i,v ,
αj,v →αj,v (j ̸= i)
and by all possible substitutions of the coordinates
αi1,v, αi2,v, · · · αin,v.

338
6 Zeta Functions and Modular Forms
A.N.Andrianov has established meromorphic continuations and functional
equations for automorphic L-functions of the type L(πf, rn, s) where πf is
the automorphic representation of GSpn(A) over Q attached to a Siegel mod-
ular form f with respect to Γn = Spn(Z), n = 2 . He has also studied the
holomorphy properties of these spinor L-functions for various classes of Siegel
modular forms f, cf. [An74], [An79a] . Analytic properties of such functions
are related to versions of the theory of new forms in the Siegel modular case
for n = 2, cf. [AP2000]. A.N. Andrianov and V.L.Kalinin in [AK78] have stud-
ied the analytic properties of the standard L-functions L(πf, ρ2n+1, s), where
πf is the automorphic representation of GSpn(A) over Q attached to a Siegel
modular form f with respect to the congruence subgroup Γ n
0 (N) ⊂Spn(Z).
For n = 1 these L-functions coincide with the symmetric squares of Hecke
series, previously studied by Shimura.
A general doubling method giving explicit constructions of many automor-
phic L-functions, was developed in [Boe85] and [GPShR87].
Further analytic properties of automorphic L-functions
We refer to Sarnak's plenary lecture [Sar98] to ICI-1998, and to the related
papers [IwSa99], [KS99], [KS99a], [LRS99], [KiSha99].
In [IwSa99], four fundamental conjectures were discussed: (A) Grand
Riemann hypothesis; (B) Subconvexity problem; (C) Generalized Ramanu-
jan conjecture; (D) Birch and Swinnerton-Dyer conjecture. Another problem
which is related to (D) is a special value problem. Namely, the question as to
whether an L-function vanishes at a special point on the critical line.
From the classical point of view, analytic and arithmetic properties of new
classes of automorphic L-functions where studied in new Shimura's books
[Shi2000], [Shi04], using a developed theory of Eisenstein series on reductive
groups.
6.5.3 The Langlands Functoriality Principle
(cf. [Bor79], [BoCa79], [Gel75], [Pan84] , and for recent developments, [Lau02],
[Hen01], [Car2000], [Li2000], [BCSGKK3], [CKPShSh]). This important prin-
ciple establishes ties between automorphic representations of diﬀerent reduc-
tive groups H and G. A homomorphism of the L-groups u : LH →LG
attached to G and H is called an L-homomorphism if the restriction of u to
LH0(C) is a complex analytic homomorphism to LG0(C), and u induces the
identity map on the Galois group GK. The functoriality principle is formu-
lated in terms of the conjugacy classes of the matrices hv corresponding to
the local components πv of an irreducible admissible representation π = ⊗vπv
of the group H(AK). It includes the following statements:
1) locally: for almost all v there exists an irreducible admissible representation
u∗(πv) of the group Gv = G(Kv) which corresponds to the conjugacy class
of the element u(hv) in LG;

6.5 Automorphic Forms and The Langlands Program
339
2) globally: there exists an irreducible admissible representation u∗(π) = π′ =
⊗vπ′
v ∈A(G/K) such that π′
v = u∗(πv) for almost all v. In this situation
the representation π′ is also called the lifting of the representation π.
In particular, according to this principle every automorphic L-function of
the type L(π, r, s) where r : LG →GLm(C), must coincide with the L-function
L(r∗(π), rm, s) of the general linear group GLm with the standard representa-
tion rm of the L-group LG0 ∼
→GLm(C). These automorphic L-functions are
called standard L-functions, and as was noted above their analytic properties
have to a certain extent already been studied.
Liftings of automorphic forms can be studied using the Selberg trace for-
mula ([BoCa79], [Sel89, Sel89], [Arth83], [ArCl89]). This powerful tool es-
tablishes a connection between characters of irreducible representations and
conjugacy classes, generalizing the classical result for ﬁnite groups.
The functoriality principle for automorphic forms is closely related to the
problem of parametrizing the set of equivalence classes of irreducible admissi-
ble representations over global and local ﬁelds by means of representations of
the Galois group (or more precisely by means of homomorphisms from the Weil
group of the ground ﬁeld (6.2.6) to the L-group LG, regarded as a group over
C in the local case, or as a group over all completions Eλ of some number ﬁeld
E in the global case). It is conjectured that to an admissible homomorphism
of that type must correspond a non-empty set, referred to as an L-packet, of
classes of irreducible admissible representations of the group G(Kv) or G(AK)
(this is the Langlands conjecture). In this correspondence the L-function of
a representation of the Weil group (6.2.6) is identiﬁed with the L-function
of the associated automorphic (irreducible, admissible) representation of the
reductive group.
In the case G = GL1 this conjecture is the essential content of class ﬁeld
theory (both local and global) establishing a correspondence between char-
acters of the group Gal(K/K) and automorphic forms on GL1, which are
characters of the idele class group (in the global case) or characters of the
multiplicative group (in the local case).
The task of passing from GL1 to other reductive groups is a vast non-
commutative generalization of class ﬁeld theory. We have considered above
special cases of this correspondence attached to classical modular forms, the
group GL2 and two-dimensional Galois representations (both complex and
l-adic). These examples seem to be a promising start to a theory, which is in-
tended to tie together algebraic varieties (motives), Galois representations and
automorphic forms (automorphic representations). An excellent introduction
to the Langlands program is contained in [BCSGKK3] and [CKM04].
6.5.4 Automorphic Forms and Langlands Conjectures
For some recent developments in automorphic forms and applications we also
refer to [Laﬀ02], [Lau02], [Hen01], [Car2000], [Ha98], [Li2000]. A signiﬁcant

340
6 Zeta Functions and Modular Forms
progress in the area of automorphic forms and their applications has been
made in the last decade.
A fundamantal problem of number theory is to classify representations
of the Galois group Gal(F s/F) where F s is a separable closure of a global
ﬁeld F, and a fundamental problem of group theory is to give the spectral
decomposition of the space L2(G(F)\G(AF )) of automorphic forms over a
reductive group G over F.
We only mention the work on the local Langlands conjecture (for G =
GLn(K) over a local ﬁeld K), cf. [Hen01], [Car2000], [Ha98], and [LRS93],
where the general case in positive characteristic was treated.
Also, we only mention Laﬀorgue's work on the Langlands conjecture in
positive characteristic, cf. [Lau02], [Laﬀ02], [L02], where the Langlands cor-
respondence was established for G = GLr with arbitrary r over a function
global ﬁeld F = Fq(X) of characteristic p > 0 where X is a smooth projec-
tive curve over Fq. For a geometric version of the Langlands correspondence
we refer to [BCSGKK3], and to [Ngo2000], containing a proof of a Frenkel-
Gaitsgory-Kazhdan-Vilonen conjecture for general linear groups.

7
Fermat's Last Theorem and Families of
Modular Forms
7.1 The Shimura-Taniyama-Weil Conjecture and Higher
Reciprocity Laws
7.1.1 Problem of Pierre de Fermat (1601-1665)
This chapter is based on the courses of lectures given by the second author in
the Ecole Normale Supérieure de Lyon (February-May 2001), in the Moscow
State University (May 2001), and in the Institut Fourier (October-December
2001). Wiles' proof of Fermat's Last Theorem and of the Shimura-Taniyama-
Weil Conjecture provides a magniﬁcent example of a synthesis of diﬀerent
ideas and theories from previous Chapters, such as algebraic number theory,
ring theory, algebraic geometry, the theory of elliptic curves, representation
theory, Iwasawa theory, and deformation theory of Galois representations.
Pierre de Fermat (1601-1665) raised his most famous problem (c.1637) in
the margin of a translation of Diophantus' "Arithmetic" (see also [He97] and
[KKS2000]):
Cubum autem in duos cubos, aut quadratoquadratum in duos
quadratoquadratos, et generaliter nullam in inﬁnitum ultra quadra-
tum potestatem in duos ejusdem nominis fas est dividere: cujus rei
demonstrationem mirabilem sane detexi. Hanc marginis exiguitas non
caperet
(It is impossible to separate a cube into two cubes, or a fourth
power into two fourth powers, or in general, any other power higher
than the second, into two like powers. I have discovered a truly mar-
velous proof of this, which this margin is too narrow to contain).
In the modern language "Fermat's Last Theorem" says that
for n > 2

xn + yn = zn
x, y, z ∈Z
=⇒xyz = 0
(FLT(n))

342
7 Fermat's Last Theorem and Families of Modular Forms
According to Ram Murty in [Mur99], "FLT deserves a special place in the
history of civilization. Because of its simplicity, it has tantalized amateurs
and professionals alike . . . . It is as if some supermind planned it all and over
centuries had been developing diverse streams of thought only to have them
fuse in a spectacular synthesis to resolve FLT. No single brain can claim
expertise in all of the ideas that have gone into this "marvelous proof". In
the age of specialization, where each one of us knows "more and more things
about less and less", it is vital for us to have an overview of the masterpiece
such as the one provided by this book."
The following is a summary of early progress on FLT.
Case n = 4 (Fermat himself in a letter to Huygens);
Case n = 3 (Euler in 1753);
Case n = 5 (Dirichlet, Legendre, c.1825);
Case n = 7 (G.Lamé, 1839; n = 14 was already done by Dirichlet in 1832);
The "ﬁrst case", FLTI(p) for all primes p for which q = 2p + 1 is also prime
(Sophie Germain in a letter to Gauss in 1820):

xp + yp = zp
x, y, z ∈Z
=⇒
xyz ≡0(modp)
(FLTI(p)).
7.1.2 G.Lamé's Mistake
On March 1, 1847, a French mathematician G.Lamé informed the Academy
of Sciences in Paris that he had found a complete proof of FLT based on the
identity
xp + yp = (x + y)(x + ζy) · . . . · (x + ζp−1y),
ζ = ζp = exp(2πi/p), p ̸= 2,
assuming the uniqueness of factorization in the ring Z[ζp].
Immediately J.Liouville reacted by saying: "N'y a-t-il pas là une lacune à
remplir?" ("Isn't there a gap to be ﬁlled?"), and indeed few months later
A.Cauchy discovered non-unique factorizations in Z[ζ23].
E.Kummer's Work
E.Kummer in 1847 introduced the notion of a regular prime p, which in mod-
ern language is:
for every ideal I ⊂Z[ζp]

Ip principal =⇒I principal

.
He proved FLT(p) for all regular primes p (for which he was awarded the
Golden Medal of the Academy of Sciences in Paris in 1850). The smallest
irregular prime is p = 37, see [BS85], [He97].

7.1 Shimura-Taniyama-Weil Conjecture and Reciprocity Laws
343
7.1.3 A short overview of Wiles' Marvelous Proof
(see also [Ste95], [RubSil94], [Da95]). In lectures at the Newton Institute in
June 1993, Andrew Wiles announced a proof of a large part of the Shimura-
Taniyama-Weil conjecture (STW) and, as a consequence, Fermat's Last The-
orem (using an earlier result of K.Ribet [Ri]). A ﬁnal corrected version of this
proof, completed together with R. Taylor, has appeared in [Wi] and [Ta-Wi].
In this truly marvelous proof, a traditional argument of reductio ad absurdum
is presented in the following form: if ap +bp = cp, abc ̸= 0, for a prime p ≥5 (a
primitive solution (a, b, c)), then one shows the existence of a non-zero holo-
morphic function f = fa,b,c : H →C on the Poincaré upper half-plane H,
deﬁned by a certain Fourier series with the ﬁrst coeﬃcient equal to 1. It turns
out that this function has too many symmetries, forcing f ≡0, a contradiction
with its construction.
In the discussion below, the following group of symmetries plays an im-
portant role:
Γ0(N) =
8α
γ
β
δ

∈SL2(Z)
 γ ≡0 mod N
9
⊂SL2(Z).
This group is called the congruence subgroup of level N and the corresponding
compact Riemann surface
X0(N) = Γ0(N)\H,
where H := H ∪Q ∪i∞,
is called a modular curve of level N. A function f : H →C is called a modular
form of weight 2 and level N if the diﬀerential ωf = f(z)dz descends to a
holomorphic diﬀerential on X0(N), that is, ωf is holomorphic and invariant
under the action of Γ0(N):
∀σ =
α
γ
β
δ

∈Γ0(N),
f
αz + β
γz + δ

= (γz + δ)2f(z),
and f(x) = 0 for all x ∈Q ∪i∞. We write S2(N) ∼= Ω1(X0(N)) for the C-
vector subspace of such forms; it has dimension dim S2(N) = genus(X0(N)).
The main point is to show that f = fa,b,c is a (non-trivial) modular form
of weight 2 and level 2: f ∈S2(2). However, X0(2) ∼= S (the Riemann sphere)
has no non-trivial diﬀerentials, a contradiction.
To prove the existence of a non-zero function f with these properties one
starts with the Frey-Hellegouarch curve
E = Eap,bp,cp : y2 = P3(x),
where
P3(x) = x(x −ap)(x + bp),
(7.1.1)
(assuming without loss of generality that ap ≡−1 mod 4 and b is even). One
observes ﬁrst of all that the discriminant of the cubic polynomial P3 is equal

344
7 Fermat's Last Theorem and Families of Modular Forms
to (abc)2p ̸= 0. Hence the projectivization E of the aﬃne curve with the
equation (7.1.1) is smooth of genus 1, and has a rational point at inﬁnity. Let
us consider the generating series: for any prime l deﬁne
Nl(E) = #

(x, y) ∈F2
l | y2 ≡P3(x) mod l

,
(7.1.2)
bl = bl(E) = l −Nl(E),
g = gE,S =

n≥1
bne2πinz
(7.1.3)
with

n≥1
bnn−s =

l̸∈S
1
1 −bll−s + l1−2s ,
for a ﬁnite set S of primes containing all prime divisors of the discriminant of
P3. In particular, in the deﬁnition (7.1.3) one has b1=1.
One sees that the series g converges and hence deﬁnes a holomorphic func-
tion on the complex Poincaré upper half-plane H, and that
Nl(E) = l +

x mod l
P3(x)
l

,
x
l

being the Legendre symbol.
Now one proceeds to show that:
- Modularity: if E is a semistable elliptic curve then the generating series
g = gE is modular - this is the main ingredient of the proof;
- Controlling the level: there exists a modular form f of an appropriate mini-
mal level N0 = N(E, p) such that the Fourier coeﬃcients of f are congru-
ent to those of g modulo an appropriate prime ideal λp. It turns out that
for the Frey-Hellegouarch curve one has N0 = 2.
Remark 7.1. According to the theorem of Faltings, the modularity of the series
g = gE,S is equivalent to the existence of a modular parametrization
ϕN : X0(N) →E,
since E is isogenous to a factor of the Jacobian J0(N) coming from the choice
of a cusp eigenform given by the generating series (7.1.3) (see §6.4.3).
7.1.4 The STW Conjecture
Conjecture 7.2 (Shimura-Taniyama-Weil). For any elliptic curve E over Q
there exist a ﬁnite set S of primes and an N = N(E, S) ∈N such that the
generating series g = gE,S given by (7.1.3) is a modular form of weight 2 and
level N.
If the set S of exceptional primes is minimal, then N is the minimal con-
ductor of E.

7.1 Shimura-Taniyama-Weil Conjecture and Reciprocity Laws
345
Example 7.3. Let
E : y2 + y = x3 −x2 ⇐⇒y2 = x3 −x2 + 1
4,
S = {11}.
Then the generating series is given by
g = q

m≥1
(1−qm)2(1−q11m)2 = q−2q2−q3+2q4+q5+2q6−2q7+· · · ∈S2(11)
l
2
3 5 7
11 13 17 19 23 29 31 · · · 10007
Nl 4
4 4 9
-
9 19 19 24 29 24 · · · 9989
bl -2 -1 1 -2
-
4
-2 0 -1 0 7 · · ·
18
7.1.5 A connection with the Quadratic Reciprocity Law
(cf. [Da99]). Conjecture 7.2 may be viewed as a far reaching generalization
of the Quadratic Reciprocity Law of Gauss. Indeed, let us consider for any
d ∈Z,
Nl(d) =#

x ∈Fl | x2 ≡d mod l

hence Nl(d) =1 +
d
l

=
⎧
⎪
⎨
⎪
⎩
2,
d ∈(F×
l )2,
1,
d ≡0 mod l,
0,
d ̸∈(Fl)2.
By quadratic reciprocity, Nl(d) depends only on l mod 4|d|, and the generating
series
g =

n≥1
bne2πinz with

n≥1
bnn−s =

l

1 −
d
l

l−s
−1
(7.1.4)
belongs in fact to the ﬁnite dimensional complex vector space consisting of all
formal Fourier series with coeﬃcients dn periodic modulo 4|d| (as functions of
n). The generating series (7.1.4) is in fact attached to the Galois representation
ρ = ρχd : GQ →{±1} = GL1(Z),
(ρχd(n) =
 d
n

),
and therefore has the same nature as the series (7.1.3), also coming from a
Galois representation (attached to E).
7.1.6 A complete proof of the STW conjecture
The STW conjecture was proved in full generality in 1999 by Ch.Breuil,
B.Conrad, F.Diamond and R.Taylor (see [Da99]). In 1994 A.Wiles proved
this conjecture for the important subset of semistable elliptic curves. This was

346
7 Fermat's Last Theorem and Families of Modular Forms
suﬃcient to deduce FLT from STW, since if one assumes the existence of a
Frey-Hellegouarch curve, then such a curve would necessarily be semistable.
We shall explain the notion of semistability below. Following a theorem of
K.Ribet (1986) (cf. [Ri]), conjectured by G.Frey in autumn 1984, a Frey-
Hellegouarch curve can not be modular, since its generating series would have
too many symmetries. Therefore the semistable STW implies FLT by the
non-modularity of the Frey-Hellegouarch curves.
Note that the full STW is necessary, for example, in order to prove that
ap + bp = c3 =⇒abc = 0 for p ≥5.
One proves this result using a curve analogous to the Frey-Hellegouarch curve;
however, this analogous curve is no longer semistable.
Controlling the level: the existence of a modular form f of minimal level
N0 = N(p, E) attached to an E and p, is given as a consequence of the follow-
ing theorem of Mazur-Ribet (which is only brieﬂy discussed in this chapter,
but see a detailed exposition in [Ri], [Edx95]).
The theorem of Mazur-Ribet is formulated in terms of the Artin conductor
N(ρ0) of a Galois representation
ρ0 : Gal(Q/Q) →GL2(Fp),
and in terms of the formal power series
g = gρ0 =

n≥1
bnqn ∈Fp[[q]],
which may be attached to any such representation. Assuming that the series g
is the q-expansion (modulo a prime) of a modular form of weight 2 and some
level N, we say that ρ0 is modular of weight 2 and level N.
Assuming this (and some other conditions, including the irreducibility of
ρ0, see Theorem 7.4) the theorem of Mazur-Ribet states the existence of a
modular form of the minimal level N(ρ0) congruent to the series g ∈Fp[[q]].
In particular, this nice result is applicable to the Galois representation
ρ0 = ρp,E : Gal(Q/Q) →GL2(Fp),
given by the Galois action on the points of order p of E. The notation
N0 = N(p, E) = N(ρ0) is used for N(ρ0). Assuming the modularity of E,
one deduces the modularity of the Galois representation ρ0, and this implies
the existence of a modular form of minimal level N(ρ0) with this property. It
turns out that for the Frey-Hellegouarch curve we have N(p, E) = N(ρ0) = 2,
and this is suﬃcient to deduce FLT from STW.
We shall give here only some formulations and brief comments on results
about modular forms of minimal level:

7.1 Shimura-Taniyama-Weil Conjecture and Reciprocity Laws
347
Theorem 7.4 (Mazur-Ribet). Let p ≥3 be a prime. Let ρ0 : Gal(Q/Q) →
GL2(Fp) be an irreducible Galois representation, which is modular of weight
2 and of a square-free level N.
If ρ0 is ﬁnite at p, then it is modular of weight 2 and of level N(ρ0), where
N(ρ0) is the Artin conductor of ρ0 (see (6.4.22)). If ρ0 is not ﬁnite at p, then
it is modular of weight 2 and of level pN(ρ0).
Remark 7.5. 1) The condition "ρ0 is ﬁnite at p" is a local condition concerning
the restriction ρ0|Dp to the decomposition group at p. This condition
means that ρ0|Dp comes from a ﬁnite ﬂat group scheme over Zp (cf. Tate's
paper in [CSS95]);
2) By a general property of the Galois representation
ρ0 : Gal(Q/Q) →GL2(Fp),
attached to a cusp form of level N, it follows that N(ρ0) always divides
N (see §6.4.2 and [Edx95]).
The proof of Theorem 7.4 has two parts. The ﬁrst part, due to Mazur,
deals with primes l dividing N/N(ρ0) that are not congruent to 1 modulo p.
The second part, due to Ribet, deals with an arbitrary l ̸= p at the cost of
introducing a prime q in the level that could be then removed by the ﬁrst
part.
Theorem 7.6 (Mazur). Let p ≥3 be a prime. Let ρ0 : Gal(Q/Q) →
GL2(Fp) be an irreducible Galois representation, which is modular with weight
2 and some level N. Suppose that l is a prime not congruent to 1 mod p, that
l divides N but l2 does not, that ρ0 is unramiﬁed at l if l ̸= p and that ρ is
ﬁnite at p if l = p.
Then ρ0 is modular of weight 2 and level N/l.
Theorem 7.7 (Ribet). Let p ≥3 be a prime. Let ρ0 : Gal(Q/Q) →GL2(Fp)
be an irreducible Galois representation, which is modular of weight 2 and some
level N. Suppose that l ̸= p is a prime, that l divides N but l2 does not, that
ρ0 is unramiﬁed at l if l ̸= p.
Then there exists a prime number q not dividing N and congruent to
−1 mod p, such that ρ0 is modular of weight 2 and level qN/l.
Corollary 7.8. Let E be a semistable elliptic curve. Assume that the gener-
ating series
g = gE,S =

n≥1
bnqn ∈Z[[q]]
is modular (i.e. g ∈S2(N) for some N). Then the conditions of Theorem 7.4
are satisﬁed for the Galois representation
ρp,E : Gal(Q/Q) →GL2(Fp).

348
7 Fermat's Last Theorem and Families of Modular Forms
Hence there exists a modular form of weight 2 and minimal level N0,
f =

n≥1
anqn ∈OQ[[q]]
with coeﬃcients in the ring of algebraic integers OQ ⊂Q ⊂C such that
f ∈S2(N0) and ∀l ̸∈S, al ≡bl mod λp
for some maximal ideal λp ⊂OQ containing p (in particular, f ̸≡0).
Corollary 7.9. If p ≥5, then the Frey-Hellegouarch curve E = Eap,bp,cp :
y2 = x(x −ap)(x + bp) with ap ≡−1 mod 4 and b even, can not be modular.
In fact, using Tate's curve (see §6.3.3) one can easily calculate the Artin
conductor in this case: it turns out that N0 = 2. On the other hand S2(2) is
zero because S2(2) ∼= Ω1(X0(2)) = 0. Hence by theorem 7.4, f is identically
zero, which is absurd since its ﬁrst coeﬃcient is 1.
7.1.7 Modularity of semistable elliptic curves
The main purpose of this chapter is to explain Wiles' proof of the modularity
of all semistable elliptic curves over Q.
Deﬁnition 7.10. a) An elliptic curve E over Q is said to be semistable at a
prime l if one can choose its equation in the form Φ(x, y) = 0 in such a
way that
Φ(x, y) ∈Zl[x, y] and
(7.1.5)
the singular points of the reduction
Φ(x, y) ∈Fl[x, y] are simple
(7.1.6)
(that is, the quadratic part of Φ(x, y) at any singular point (x0, y0) is non-
degenerate; recall that a singular point (x0, y0) is a point such that:
Φ(x0, y0) = Φ
′
x(x0, y0) = Φ
′
y(x0, y0) = 0.
b) An elliptic curve E over Q is called semistable if it is semistable at all
primes l.
Remark 7.11. The deﬁnition 7.10 is entirely geometric. However one can give
a purely algebraic deﬁnition 7.18 of the notion of semistability using Tate's
uniformization, see §6.3.3: an elliptic curve E is semistable if and only if the
representations ρp,E on the Tate modules of E satisfy the condition:
∀p, ∀l ̸= p,
ρp,E(Il) is conjugate to a subgroup of
1
0
∗
1

,
where Il ⊂GQ = Gal(Q/Q) denotes the inertia subgroup.

7.1 Shimura-Taniyama-Weil Conjecture and Reciprocity Laws
349
Example 7.12. a) Consider the Frey-Hellegouarch curve E given by y2 =
x(x −ap)(x + bp), where p ≥5 is prime. We shall assume that b is even
and ap ≡−1 mod 4. After the substitution x = 4X, y = 8Y + 4X we
obtain the following equation
Y 2 + XY = X3 + γX2 + δX,
γ = bp −ap −1
4
,
δ = −apbp
16 .
The point (X, Y ) = (0, 0) is in fact the only singular point mod 2, and
here the quadratic part is given by

Y 2 + XY,
if 8 divides ap + 1
X2 + XY + Y 2,
if 8 does not divide ap + 1.
Thus in either case E is semistable at l = 2.
Now suppose l ̸= 2, ap +bp = cp and l|abc. The equation reduces to one of
the form y2 ≡x2(x −α) mod l with α ̸≡0. The only singular point here
is (x, y) = (0, 0), and the quadratic part y2 −αx2 is non-degenerate.
b) The modular elliptic curve X0(15) : y2 = x(x + 32)(x −42) is semistable,
whereas the curve E : y2 = x(x −32)(x + 42) is not semistable.
Now the main result of the chapter says:
Theorem 7.13 (semistable STW Conjecture, A.Wiles (1994)). Every
semistable elliptic curve is modular.
Corollary 7.14. There exist no Frey-Hellegouarch curves E = Eap,bp,cp, and
hence FLT(p) is true for any prime p ≥5.
7.1.8 Structure of the proof of theorem 7.13 (Semistable STW
Conjecture)
I. Modularity modulo p (with p = 3, 5)
Let E : y2 = P3(x) be a semistable elliptic curve. We may assume that
P3(x) ∈Z[x], and we let g = gE,S = 
n≥1 bnqn ∈Z[[q]] be its generating
series,
bl = l −Nl(E) = −

x mod l
P3(x)
l

,
x
l

is the Legendre symbol.
One constructs a modular form h =

n≥1
cnqn ∈OQ[[q]] with cl ≡bl mod λp for
all l ̸∈S, the ﬁnite set of exceptional primes S, where λp ⊂OQ is a prime ideal
containing p. This problem was solved only for p = 3 (the Tunnell-Langlands-
Serre Theorem) under the assumption of absolute irreducibility modulo 3 of
the representation

350
7 Fermat's Last Theorem and Families of Modular Forms
ρ3,E : Gal(Q/Q) →GL2(F3)
(on the points of order 3 of E). This condition is not always satisﬁed, and this
was considered by A.Wiles as a signiﬁcant diﬃculty in his proof. In May 1993
A.Wiles found a way to overcome this diﬃculty; he found a way of switching
the problem from p = 3 to p = 5. He used a family Et of elliptic curves with
the property that all the representations ρ5,Et are isomorphic, and such that
there exists a curve E′ = Et0 in this family with an irreducible representation
ρ3,E′. This made it possible to replace E by E′ in the above argument, see
§7.7.
II. Modular lifting
Any series ˜h = 
n≥1 ˜cnqn ∈O[[q]] with coeﬃcients in a ﬁnite extension
O of Zp (with maximal ideal λ), satisfying certain necessary conditions of
modularity, and having the property that:
∀l ̸∈S, ˜cl ≡cl mod λ
is automatically a modular form (which is called a lifting of h mod λ, or an
admissible deformation of h). One gives these necessary conditions in terms of
the absolute irreducibility of the Galois representations attached to modular
forms (these conditions are used also in Theorem 7.4 of Ribet). In other words,
one shows that under these conditions any admissible lifting of h mod λ is in
fact modular.
III. Absolute irreducibility
One shows that the absolute irreducibility conditions are satisﬁed for the
Galois representations
ρp,E : Gal(Q/Q) →GL2(Fp)
either for p = 3 or for p = 5.
IV. End of the proof: passage from p = 3 to p = 5
Let us consider the series ˜h = g (the generating series of our representation).
By I) this series is an admissible deformation of a modular form h mod 3
(under the conditions of absolute irreducibility for p = 3), and II) implies
that in this case g must be a modular form. In other cases, III) says that the
irreducibility condition is satisﬁed for p = 5. Moreover, II) implies that g′ =
gE′,S is a modular form. By the construction of E′, we know that g′ mod 5 =
g mod 5 ∈F5[[q]] again satisﬁes the conditions II) for modular lifting (with
p = 5). Hence g is also modular in this case.

7.1 Shimura-Taniyama-Weil Conjecture and Reciprocity Laws
351
Fig. 7.1.
The main stages of Wiles' Proof are presented in the Figure 7.1, which is reproduced
here from [RubSil94], p. 6, with a kind permission of K.Rubin, A.Silverberg and
AMS.
In the next section we describe the Langlands-Tunnell Theorem.

7.2 Theorem of Langlands-Tunnell and
Modularity Modulo 3
7.2.1 Galois representations: preparation
Recall that the Galois group Gal(Q/Q) of Q ⊂C contains for any prime l and
for any maximal ideal λ ⊂OQ over l the decomposition subgroup Dl and its
normal inertia subgroup Il = Iλ/l,
GQ = Gal(Q/Q)
(7.2.1)
∪
Dl = Dλ/l = {g ∈Gal(Q/Q) | g(λ) = λ} ∼= Gal(Ql/Ql)
▽
Il = Iλ/l = {g ∈Dl | ∀x ∈OQ, g(x) ≡x(modλ)} ∼= Gal(Ql/Qnr
l ),
Dl/Il ∼= Gal(Fl/Fl) = ⟨Frobl⟩,
Frobl(x) = xl,
Frobl ∈Gal(Fl/Fl)
where Qnr
l
denotes the maximal unramiﬁed extension of the l-adic ﬁeld Ql.
The subgroups Dl = Dλ/l are all conjugate due to the transitivity of the
action of Gal(Q/Q) on the maximal ideals λ above l. This means that for any
l, the Frobenius element Frobl lifts to a conjugacy class of cosets of Il in GQ.
Deﬁnition 7.15. a) Let A be a topological ring over Zp. We deﬁne a Galois
representation over A to be a continuous homomorphism
ρ : GQ →GLn(A).
b) ρ is said to be unramiﬁed at l if ρ(Il) = {1}; in this case the trace
tr(ρ(Frobl)) ∈A is well deﬁned.
c) ρ is said to be reducible if there exists a matrix C ∈GLn(A) such that
∀g ∈GQ, C−1ρ(g)C ∈
,∗
0
∗
∗
-
.
Arithmetical examples.
a) The Cyclotomic character. Let A = Zp, n = 1, ρ = χp : GQ →Z×
p the
character of the group GQ deﬁned by the action on the roots of unity of
degree pr: lim
←−
r
µpr ∼= Zp. One has χp(Frobl) = l ∈Z×
p for any l ̸= p.
b) For an elliptic curve E over Q one has E(C) ∼= C/⟨ω1, ω2⟩(Weierstrass'
theorem). Hence for any positive integer m the group of m-torsion points
E[m] := Ker(u →mu) ∼= (Z/mZ)2
of E is a GQ-module: ρm,E : GQ →GL2(Z/mZ). Putting m = pr and
passing to the limit

7.2 Theorem of Langlands-Tunnell and Modularity Modulo 3
353
lim
←−
r
E[pr] ∼= Z2
p,
one obtains a Galois representation
ρp,E : GQ →GL2(Zp)
with the properties:
det ρp,E = χp
(7.2.2)
ρp,E is unramiﬁed at all primes l ∤p∆E,
(7.2.3)
and for these primes trρp,E(Frobl) = l + 1 −# ˜E(Fl),
where ˜E denotes the reduction E mod l (which is good in this case due
to the Néron-Ogg-Shafarevich criterium, see §5.4.1 ).
Theorem 7.16 (Langlands-Tunnell-Serre). Let E be an elliptic curve
and let
ρp,E : Gal(Q/Q) →GL2(Fp)
be the representation on the points of order p of E. Assume that ρ3,E is ir-
reducible. Then there exists a cusp form h =

n≥1
cnqn, cn ∈OQ of weight 2
and a maximal ideal λ3 ⊂OQ above 3, such that for all l outside a ﬁnite set
S = S(E),
cl ≡l + 1 −# ˜E(Fl) (modλ3).
Proof is explained in §7.2. It makes use of the commutative diagram
Ψ : GL2(F3)
irreducible

id













GL2(Z[√−2])
mod (1+√−2)

⊂GL2(C)
GL2(F3)
where Ψ denotes the two-dimensional complex irreducible representation of
GL2(F3) given by
Ψ
−1
−1
1
0

=
−1
−1
1
0

, Ψ
1
1
−1
1

=

1
−√−2
−1
−1 + √−2

.
Remark 7.17. Note that the homomorphism Ψ is a section of the natural ho-
momorphism
GL2(Z([
√
−2]) →GL2(F3),
induced by the reduction modulo (1 + √−2):
Z[
√
−2] →Z[
√
−2]/(1 +
√
−2) ∼= F3.

354
7 Fermat's Last Theorem and Families of Modular Forms
7.2.2 Modularity modulo p
The modularity of an arbitrary irreducible Galois representation modulo 3,
given by the proof of Theorem 7.16, is a special case of a general conjecture
of Serre [Se87] (see §6.4.6):
Let p be a prime number, p a prime ideal of the ring of all algebraic integers
O ⊂Q dividing p (i.e. p ∈p). We call a representation
ρ : GQ →GL2(Fp)
(7.2.4)
a modular representation of type (N, k, χ), if there is a modular form (see
§6.3.5)
h(z) =
∞

n=1
cne(nz) ∈Sk(N, χ)(e(z) = exp(2πiz)),
which is an eigenform of all the Hecke operators, normalized by c1 = 1, such
that for all primes l ∤Np the representation ρ is unramiﬁed at l and we have
Tr ρ(Frobl) ≡cl mod p.
(7.2.5)
Serre conjectured that every irreducible representation (7.2.4) is modular
for some N not divisible by p. He also described explicitly the numbers N
and k and the character χ, assuming that N and k are minimal subject to
the condition (N, p) = 1. According to Serre's conjecture, the number N is
determined by the ramiﬁcation of ρ outside p in the same way as the Artin
conductor:
N = N(ρ) =

l̸=p
ln(l,ρ).
The weight k is given by ramiﬁcation properties of ρ at p, and the character
χ : (Z/N)× →Q
× can be obtained from the determinant of ρ as follows:
det ρ(Frobl) ≡χ(l)lk−1 mod p
(l ∤Np).
It was noticed by Serre [Se87] that one can easily deduce this conjecture for
all representations into GL2(F3) (p = 3), from a general result of Langlands-
Tunnell, cf. [L80], [Tun81], [Gel95], and §6.5. The Langlands-Tunnell The-
orem states that every two-dimensional odd complex Galois representation
ρ : GQ →GL2(C) with solvable image is modular. More precisely, let
gρ = ∞
n=1 bnqn be the generating series of ρ, i.e. the series whose coeﬃ-
cients are those of the Artin L-series of ρ (see §6.2.2, 6.4.5)
∞

n=1
bnn−s =

l
1
det(1 −l−sρ(Frobl)|V Il) = L(ρ, s),
where GL2(C) = GL(V ), V = C2 and Il is the inertia group at l. Then the
Langlands-Tunnell Theorem states that gρ is a weight one modular form, and
is a cusp form if ρ is irreducible (see §6.4.5).

7.2 Theorem of Langlands-Tunnell and Modularity Modulo 3
355
To explain how this result implies a proof of Theorem 7.16, we shall con-
sider the complex representation ρ = Ψ ◦ρ3,E. The image of ρ is certainly
solvable, as it is isomorphic to a subgroup of the solvable group GL2(F3).
7.2.3 Passage from cusp forms of weight one to cusp forms of
weight two
Next, we shall construct a cusp form h = ∞
n=1 cnqn of weight two starting
from a cusp form g of weight one given by the Langlands-Tunnell Theorem.
For this purpose one uses Eisenstein series of weight k and Dirichlet character
χ (generalizing the series of §6.3.1):
Fk,χ(z) = −Bk,χ
2k
+
∞

n=1

d|n
χ(d)dk−1e(nz) ∈Mk(N, χ),
(7.2.6)
Ek,χ(z) = 1 −
2k
Bk,χ
∞

n=1

d|n
χ(d)dk−1e(nz) ∈Mk(N, χ),
(7.2.7)
where k ≥1, and Bk,χ is the kth generalized Bernoulli number (or Bernoulli-
Leopoldt number), deﬁned by the equality

k≥0
Bk,χtk
k!
:=
N

a=1
χ(a)teat
eNt −1 .
For k = 1, 2, one requires for convergence that χ is non-trivial. The important
property of these numbers is that
L(1 −k, χ) = −Bk,χ
k
.
In particular, if N = 3, k = 1, χ(d) = χ3(d) =
d
3

is an odd Dirichlet
character and we have B1,χ3 = −1
3. Thus
E1,χ3(z) = 1 + 6
∞

n=1

d|n
d
3

e(nz) ∈Mk(N, χ).
In order to ﬁnish the proof of Theorem 7.16 we construct a cusp form h =

n≥1 cnqn, cn ∈OQ[[q]] as the following product:
h = gρE1,χ3 =
⎛
⎝
n≥1
bnqn
⎞
⎠
⎛
⎝1 + 6
∞

n=1

d|n
d
3

qn
⎞
⎠=:

n≥1
cnqn,
cn ∈OQ.
Then h is a cusp form of weight 2 with the desired properties: we take S to
be the set of all primes dividing 3N, where N is the level of g; then for any
l /∈S,
cl ≡bl ≡l + 1 −# ˜E(Fl) (mod p)
for any maximal ideal p ⊂OQ containing 1 + √−2.

356
7 Fermat's Last Theorem and Families of Modular Forms
7.2.4 Preliminary review of the stages of the proof of Theorem
7.13 on modularity
I) Any elliptic curve E over Q is "modular modulo 3", if its Galois represen-
taion ρ3,E is irreducible.
II) The result of I) gives only a necessary condition for modularity for p = 3
(together with properties (7.2.2) and (7.2.3)). One can use these condi-
tions as a starting point for proving modularity in the semistable case.
We shall reformulate the modularity statement as an assertion about an
isomorphism of certain "deformation rings".
More precisely, let O ⊃Zp be the ring of integers of a ﬁnite extension
K ⊃Qp. Then O is a discrete valuation ring (DVR), and we shall write λ for
its maximal ideal.
Consider a cusp form h = 
n≥1 cnqn ∈OQ[[q]] (for example, the one just
constructed), and choose a maximal ideal λp ⊂OQ such that
OQ/λp ∼= Fp ⊃O/λ ⊃Fp
Then the meaning of the stage II) is to show that if we take any formal power
series
˜h =

n≥1
˜cnqn,
˜cn ∈O
over the local ring O, satisfying certain necessary conditions for modularity
and irreducibility, as well as the congruences
cl ≡˜cl mod λp for all l outside a ﬁnite set S,
then the series ˜h must be modular, i.e. it represents the Fourier expansion of a
modular form. Recall that we have ﬁxed an embedding ip : Q →Qp ⊃O ⊃λ
with the property
i−1
p (λ) ⊂λp ⊂OQ ⊂Q,
so we may regard ˜h as the image under ip of a series in OQ[[q]].
Remark 7.18 (Algebraic meaning of the semistability of E). Using Tate's uni-
formization, see §6.3.3 one can show that an elliptic curve E is semistable
if and only if the representations ρp,E on the Tate modules of E satisfy the
condition:
∀p, ∀l ̸= p,
ρp,E(Il) is conjugate to a subgroup of
1
0
∗
1

,
where Il ⊂GQ = Gal(Q/Q) denotes the inertia subgroup.

7.3 Modularity of Galois representations and Universal
Deformation Rings
7.3.1 Galois Representations over local Noetherian algebras
The generating series ˜h to be constructed at stage II), may be interpreted
next as a generating series of a Galois representation. In this section we treat
the problem of modularity of certain Galois representations
ρ : GQ →GLm(A),
with coeﬃcients in a local O-algebra A with maximal ideal mA. As before in
section 7.2, O ⊃Zp denotes the ring of integers of a ﬁnite extension K ⊃Qp.
Thus O is a discrete valuation ring (DVR), and λ denotes the maximal ideal
of O. We always assume that:
A/mA ∼= O/λ = k ⊃Fp.
Deﬁnition 7.19. Let C = CO be the category of local noetherian O-algebras
equipped with an augmentation π : A →O: its objects are given by
C = CO = {(A, π) | π : A →O surjective},
and its morphisms given by commuting triangles:
A
ϕ

πA







A′
πA′

O
Example 7.20. a) A = O = Zp;
b) A = O[[X1, · · · , Xn]], mA = (λ, X1, · · · , Xn), πA(f) = f(a1, · · · , an) for
some ﬁxed ai;
c)
A = Zp[[X]]/(X(X −pn)) ∼=

(a, b) ∈Z2
p | a ≡b mod pn
,
mA =

(a, b) ∈pZ2
p | a ≡b mod pn
, πA(a, b) = a.
7.3.2 Deformations of Galois Representations
Deﬁnition 7.21. a) We ﬁx a representation ρ0 : GQ →GLm(k) over the
ﬁnite ﬁeld k as above. Then a lift ρ of ρ0 to A is a representation ρ : GQ →
GLm(A) such that ρ mod mA = ρ0.
b) Two lifts ρ : GQ →GLm(A) and ρ′ : GQ →GLm(A) are called strictly
equivalent if there exists a matrix C ∈GLm(A), such that C ≡Im mod mA,
and
for all g ∈GQ, ρ′(g) = C−1ρ(g)C.
c) A deformation of ρ0 in A is a strict equivalence class of lifts of ρ0 to A.

358
7 Fermat's Last Theorem and Families of Modular Forms
Let ρ : GQ →GL2(A) be (a representative in the class of) a deformation
of ρ0 : GQ →GL2(k):
GL2(A)

GQ
ρ
	








ρ0  GL2(k)
For a ﬁxed representation ρ0 : GQ →GLm(k) over the ﬁnite ﬁeld k let us
denote by
S = {l prime | ρ0(Il) ̸= Im}.
In order to deal with ﬁnite sets of deformations of ρ0, we shall also ﬁx the
type D = DΣ of our deformations, where Σ denotes a ﬁnite set of primes such
that Σ ∩S = ∅.
The main discovery in Wiles' marvelous proof is a method for counting
two diﬀerent types of objects:
1) Galois representations coming from elliptic curves over Q of a given type;
2) primitive cusp eigenforms of weight 2 and given level N, and with Fourier
coeﬃcients in Q.
Let us ﬁx a two-dimensional representation ρ0 : GQ →GL2(k) over the ﬁnite
ﬁeld k, and sets S and Σ as above.
Deﬁnition 7.22. a) A deformation ρ of ρ0 in A is said to be of type D = DΣ
if the following conditions i)-iv) are satisﬁed:
i) ρ is unramiﬁed outside of set S ∪Σ ∪{p};
ii) det ρ = χp : GQ →Z×
p →A×, the cyclotomic character;
iii) for all l ∈S with l ̸= p, ρ|Il ∼
 1
0
∗
1

(semistability at l);
iv) the restriction ρ|Dp satisﬁes a certain local condition (it is "good").
This means that ρ|Dp is either "ﬂat" or "ordinary".
"Flat" means that for any ideal α ⊂A of ﬁnite index, the reduced
representation ρ mod α : GQ →GLm(A/α) comes from a ﬁnite ﬂat
group scheme over Zp.
"Ordinary" means that
ρ|Dp ∼
∗
0
∗
χ

( with an unramiﬁed character χ).
b) A deformation ρ of ρ0 is said to be admissible, if it is of type DΣ for some
ﬁnite set Σ.
For ﬁnite ﬂat group schemes, we refer to [Ta95].
Our goal is to show that any admissible deformation ρ of a modular repre-
sentation ρ0 : GQ →GL2(k) is also modular (under some absolute irreducibil-
ity conditions on ρ0).

7.3 Modularity of Galois representations and Universal Deformation Rings
359
Remark 7.23. Deﬁnition 7.22 implies that any deformation ρ of type DΣ fac-
torizes through the projection GQ →GΣS = Gal(QΣS/Q), where QΣS is the
maximal algebraic extension of Q unramiﬁed outside ΣS = S ∪Σ ∪{p}.
7.3.3 Modular Galois representations
We have already encountered modular Galois representations over ﬁnite ﬁelds
and local ﬁelds in §6.1 and §7.2. We now describe a more general notion of a
modular Galois representation ρ : GQ →GL2(A) over a ring A. Rather than
ﬁxing a modular form of type (N, k, χ)
h(z) =
∞

n=1
cne(nz) ∈Sk(N, χ),
which is an eigenform of the Hecke operators, normalized by c1 = 1, such that
Tr ρ(Frobl) is expressed in terms of cl for all primes l ∤Np, we shall instead use
a homomorphism π : T′(N) →A from an appropriate Hecke Z-algebra such
that Tr ρ(Frobl) is expressed in terms of π(Tl) for all "good" Hecke operators
Tl (indexed by the primes l ∤Np, see §6.3.6).
Recall that there is an isomorphism (see §6.3.1)
Γ0(N)/Γ1(N) ∼= (Z/NZ)×,
σd =
a
c
b
d

mod Γ1(N) →d mod N.
Deﬁnition 7.24. (a) The "diamond" operator ⟨d⟩on
Mk(N) = Mk(Γ1(N)) =
0
ψ
mod
N
Mk(N, ψ)
is deﬁned by
⟨d⟩f = f|kσd = (cz + d)−kf
az + b
cz + d

.
In particular, for any f ∈Mk(Γ1(N)) we have:
f ∈Mk(N, ψ) ⇐⇒∀d ∈(Z/NZ)×, ⟨d⟩f = ψ(d)f.
b) The Hecke operators Tl (see (6.3.32)) are deﬁned for all
f(z) = ∞
n=0 ane(nz) in Mk(N) by
Tlf = Ulf + lk−1Vl⟨l⟩(f),
where

Ulf = ∞
n=0 alne(nz)
Vl⟨l⟩(f) = ∞
n=0 an(⟨l⟩(f))e(lnz)

360
7 Fermat's Last Theorem and Families of Modular Forms
c) The Hecke algebra T′(N) over Z is deﬁned by
T′(N) = Z[Tl, ⟨d⟩| l ∤N, d ∈(Z/NZ)×].
Deﬁnition 7.25. A Galois representation over a ring A is said modular of
level N, if there exists a ring homomorphism π : T′(N) →A such that for all
primes l ∤N

tr ρ(Frobl) = π(Tl)
det ρ(Frobl) = π(⟨l⟩)lk−1.
(see [Ste95] and §6.4.1). Following Hecke and Petersson (see §6.3.6), the action
of T′(N) on the complex vector space Sk(N) can be orthogonally diagonalized.
Suppose {f} is an orthogonal basis and each f(z) = ∞
n=0 ane(nz) ∈Sk(N)
is primitive. Then a1 = 1 and Tlf = alf with al ∈OQ. As before we ﬁx an
embedding ip : Q →Qp, and consider a ﬁnite extension K of Qp containing
all the ip(al) with l ∤Np. Let O ⊃Zp be the ring of integers of K, and let λ
denote its maximal ideal.
In the following theorem, we identify Q with its image ip(Q) ⊂Qp. Thus
we identify the elements al ∈i−1
p (O) ⊂Q with ip(al), omitting the symbol ip.
Theorem 7.26 (Eichler-Shimura-Deligne). For any prime p, and for
any primitive cusp eigenform f(z) = ∞
n=0 ane(nz) ∈Sk(N, χ) there ex-
ists a modular representation ρ = ρf,λ with coeﬃcients in A = O such that
π : Tl →al.
Idea of the construction. Assume for simplicity that k = 2, χ is trivial and
an ∈Z (n ≥1). Let us consider the holomorphic diﬀerential ωf = f(z)dz,
then O = Zp, and λ = pZp. We consider next the lattice of periods (see §5.3.5
and §6.3.2)
Λf =
>
γ
ωf | γ is a closed path on X0(N)
?
⊂C.
It turns out that E = Ef = C/Λf is then an elliptic curve deﬁned over Q. We
deﬁne the Galois representation
ρf,p = ρf,λ = ρp,E : GQ →GL2(Zp).
According to the congruence relation of Eichler-Shimura,
tr(ρp,E(Frobl)) = al = l + 1 −# ˜E(Fl),
det(ρp,E(Frobl)) = l for all l ∤pN,
where ˜E denotes the reduction E mod l (which is good in this case by the
criterion of Néron-Ogg-Shafarevich, [Se68a]). In fact E is isogenous to a factor
of Jacobian J0(N) coming from the cusp form f given by (7.1.3) (see §6.4.3).

7.3 Modularity of Galois representations and Universal Deformation Rings
361
When Q(⟨an⟩n≥1) ̸= Q, but k = 2 and χ is trivial, one obtains ρf,p via
an Abelian variety with real multiplication (cf. [Shi71]). When k > 2 or χ is
nontrivial, the construction is more complicated (cf. [Del68]), but these cases
are not used in Wiles' proof.
In order to deﬁne a homomorphism π : T′(N) →A, we put π(X) = λf(X)
for any X ∈T′(N), where f|X = λf(X)f, and λf(Tl) = al ∈O ⊂A. This
gives a homomorphism π : T′(N) →A.
7.3.4 Admissible Deformations and Modular Deformations
Consider again a local O-algebra A with maximal ideal mA, where O ⊃Zp
denotes (as in §7.2) the ring of integers of a ﬁnite extension K ⊃Qp. Thus
O is a discrete valuation ring (DVR), and λ denotes its maximal ideal. We
assume always that
A/mA ∼= O/λ = k ⊃Fp,
and let us ﬁx a two-dimensional representation ρ0 : GQ →GL2(k) over the
ﬁnite ﬁeld k, and sets S and Σ as above.
Let ρ : GQ →GL2(A) denote (a representative in the class of) a deforma-
tion of ρ0 : GQ →GL2(k) of type DΣ :
GL2(A)

GQ
ρ
	








ρ0  GL2(k)
Deﬁnition 7.27. Let DAΣ(A) denote the set of all admissible deformations
of ρ0 of type DΣ and DMΣ(A) the subset of DAΣ(A) consisting of all modular
deformations of ρ0 of type DΣ.
We shall see that the set DAΣ(A) is ﬁnite (in fact, A →DAΣ(A) is a
functor with values in ﬁnite sets, see [Da95]). The main theorem of Wiles'
proof says that under suitable conditions on ρ0, both sets coincide for any A
as above.
Consider the subgroup of index 2
G
Q
+
(−1)
p−1
2
p
 ⊂GQ
corresponding to the unique quadratic extension of Q unramiﬁed outside p.
Theorem 7.28 (Modularity of admissible deformations). Suppose that
ρ0 : GQ →GL2(k) is a modular representation over a ﬁnite ﬁeld k, and that
the restriction
ρ0|G
Q
⎛
⎝
 
(−1)
p−1
2
p
⎞
⎠

362
7 Fermat's Last Theorem and Families of Modular Forms
is absolutely irreducible.
Then
DAΣ(A) = DMΣ(A).
(7.3.1)
That is, every admissible deformation is modular.
Remark 7.29. i) Under the assumptions of Theorem 7.28 both representations
ρ0 and ρ are semistable at all places l ∈S.
ii) The strong condition of absolute irreducibility of the restriction of ρ0 im-
plies (trivially) that ρ0 itself is absolutely irreducible. This fact is important
in Theorem 7.4 of Mazur-Ribet, which we now restate in the following form:
Theorem 7.30 (of K.Ribet on the existence of minimal deforma-
tions). Suppose that ρ0 : GQ →GL2(k) is a modular and absolutely irre-
ducible representation over a ﬁnite ﬁeld k. Then the set DM∅(A) of minimal
deformations of ρ0 is non-empty (that is, there exists a modular deformation
ρ of ρ0 of minimal level N(ρ0), where N(ρ0) is the Artin conductor of ρ0).
Example 7.31 (The Frey-Hellegouarch curve). Consider again E = Eap,bp,cp
with ap ≡−1 mod 4, 2|b, p ≥5, and let ρ0 = ρp,E : GQ →GL2(Fp). Then
i) N(ρ0) = 2 (see [Se87], p. 201).
ii) For Frey-Hellegouarch curves, we have |E[2](Q)| = 4, since the points of
order 2 correspond to the roots the cubic polynomial x(x −ap)(x + bp).
Using this fact we may show that ρ0 is irreducible for p ≥5 by Mazur's
theorem [Maz77] and 1.3.7: the only possibilities for the torsion subgroup
of E(Q) are (up to isomorphism):
Z/nZ (1 ≤n ≤10, and n = 12),
Z/2Z × Z/2nZ (1 ≤n ≤4).
Suppose the GQ-module V = E[p] has a GQ-invariant line W over Fp.
If W is ﬁxed pointwise by the action of GQ, then E(Q) has a torsion
subgroup isomorphic to Z/2Z × Z/2pZ, which would directly contradict
Mazur's theorem. If on the other hand W is invariant under GQ only as
a line over Fp, then the quotient curve E′ = E/W, isogenuous to E, can
also be deﬁned over Q. One can show that E′ has a rational point of order
p and three points of order 2, again contradicting Mazur's Theorem (see
[He97]).
iii) Assuming the modularity of ρ0 (modulo p), one can simply apply Ribet's
Theorem 7.30 to deduce that E = Eap,bp,cp does not exist. However, it
seems that we can only prove the modularity of ρ0 by proving the mod-
ularity of ρp,E; this is why we require Theorem 7.28 (on modularity of
admissible deformations).

7.3 Modularity of Galois representations and Universal Deformation Rings
363
7.3.5 Universal Deformation Rings
We need to show that under the notations and assumptions of Theorem 7.28
one has
DAΣ(A) = DMΣ(A),
for any local Noetherian O-algebra A with maximal ideal mA, and for any
two-dimensional representation ρ0 : GQ →GL2(k) as above (A/mA ∼= O/λ =
k ⊃Fp).
Reformulation of the identity (7.3.1):
We shall use the representability of the two functors
DAΣ ⊃DMΣ : CO →Setsfin
(for any ﬁnite set Σ). This means that there exist "universal" objects (called
universal deformation rings) RΣ, TΣ ∈CO such that for any A ∈CO one has
DAΣ(A) = HomCO(RΣ, A) ⊃DMΣ(A) = HomCO(TΣ, A).
In particular, substituting A = TΣ we obtain a canonical morphism
ϕΣ : RΣ →TΣ,
(7.3.2)
and the canonical universal pairs
(RΣ, ρuniv
Σ
), and (TΣ, ρuniv.mod.
Σ
)
are related by the commutative diagram:
GL2(RΣ)
ϕΣ

GQ
ρuniv
Σ










ρuniv.mod.
Σ
	
	
	
	
	
	
	
	
	
GL2(TΣ)
(7.3.3)
In order to count the sets DAΣ(A) and DMΣ(A), a clever choice of the
augmentations is used for the local algebras RΣ and TΣ:
πRΣ : RΣ →O
πTΣ : TΣ →O
Remark 7.32. (J.-P. Serre) The universal deformation rings RΣ and TΣ are
topologically generated by the elements tr(ρuniv
Σ
(Frobl)) ∈RΣ for all primes
l ̸∈ΣS.

364
7 Fermat's Last Theorem and Families of Modular Forms
This fact means also that both universal representations
ρuniv
Σ
: GQ →GL2(RΣ),
ρuniv.mod.
Σ
: GQ →GL2(TΣ)
are determined by their traces (see [Da95]).
We may therefore deﬁne the augmentation maps by the following relations:
πRΣ : tr ρuniv
Σ
(Frobl) →al
(7.3.4)
πTΣ : tr ρuniv.mod.
Σ
(Frobl) →al
where al ∈O are the Fourier coeﬃcients of Ribet's cusp eigenform
f(z) =
∞

n=0
ane(nz) ∈Sk(N0),
of minimal level (whose Galois representation ρf,λ corresponds to a deforma-
tion ρ ∈DM∅(O)).
We shall denote by
˜ρ = ρf,λ : GQ →GL2(O)
the corresponding modular Galois representation of the minimal level N0.
Using the map (7.3.2), one can interpret Theorem 7.28 as an isomorphism
of the local Noetherian O-algebras RΣ and TΣ:
Theorem 7.33 (Main Theorem on isomorphism of universal defor-
mation rings). Under the assumptions of Theorem 7.28, the canonical mor-
phism (7.3.2)
ϕΣ : RΣ →TΣ
of universal deformation rings is an isomorphism in the category CO.

7.4 Wiles' Main Theorem and Isomorphism Criteria for
Local Rings
7.4.1 Strategy of the proof of the Main Theorem 7.33
Let us consider again a local O-algebra A with maximal ideal mA, where
O ⊃Zp denotes (as in section 7.2) the ring of integers of a ﬁnite extension
K ⊃Qp; O is a dicrete valuation ring (DVR), and λ denotes the maximal
ideal of O. We always assume that
A/mA ∼= O/λ = k ⊃Fp,
and we ﬁx a two-dimensional representation ρ0 : GQ →GL2(k) over the ﬁnite
ﬁeld k, together with sets S and Σ as described above.
Recall that Ribet's modular Galois representation
˜ρ = ρf,λ : GQ →GL2(O)
of minimal level N0 given by Theorem 7.30 belongs to the (non-empty) set
DM∅(O). This gives a distinguished element of each of the sets DMΣ(A) ⊂
DAΣ(A). This representation ˜ρ is used in an explicit construction of the mod-
ular universal deformation ring TΣ, see [CSS95].
Surjectivity of the map ϕΣ : RΣ →TΣ (7.3.2) can be easily deduced from the
fact (see 7.32) that the universal deformation rings RΣ and TΣ are topologi-
cally generated by the elements tr(ρuniv
Σ
(Frobl)) ∈RΣ for primes l ̸∈ΣS, see
below §7.4.2.
Injectivity of ϕΣ : RΣ →TΣ was proved by A.Wiles by an induction argument
on Σ. For a prime l not in ΣS, we let Σ′ = Σ ∪{l}. Wiles deduced the
bijectivity of ϕΣ′ from the bijectivity of ϕΣ using an isomorphism criterion
for local rings. This criterion was formulated in terms of certain invariants
(discovered by Wiles earlier, in spring 1991, see the introduction of his paper
[Wi]). However, in order to start the induction one needed the case Σ = ∅
(the base of induction). This was the point which caused a problem in 1993,
after the announcement of a complete proof of FLT, and which was repaired
in 1994 by A.Wiles and R.Taylor using a horizontal version of Iwasawa theory
together with a second isomorphism criterion for local rings. In this section
we describe these criteria and give explicit constructions (due to H.Lenstra
and B.Mazur) of the universal deformation ring RΣ.
7.4.2 Surjectivity of ϕΣ
In order to prove the surjectivity, we assume the existence of the universal
deformation rings RΣ, TΣ ∈CO. Thus for any A ∈CO we have
DAΣ(A) = HomCO(RΣ, A) ⊃DMΣ(A) = HomCO(TΣ, A),

366
7 Fermat's Last Theorem and Families of Modular Forms
implying the existence of a canonical morphism (7.3.2)
ϕΣ : RΣ →TΣ.
Lemma 7.34. Let A = RΣ (resp. A = TΣ), and denote by A0 subring
of A which is the topological closure of the O-subalgebra in A generated by
all elements tr(ρuniv
Σ
(Frobl)) ∈RΣ (resp. tr(ρuniv.mod.
Σ
(Frobl)) ∈TΣ). Then
A0 = A.
This lemma can be deduced from the following:
Proposition 7.35. Let A0 ⊂A be two local rings with maximal ideals satis-
fying
mA0 = mA ∩A0
and with the same ﬁnite residue ﬁeld k. Suppose
ρ : G →GLm(A)
is a representation of a group over A such that
1) ρ = ρ mod mA is absolutely irreducible;
2) trρ(σ) ∈A0 for all σ ∈G.
Then ρ is conjugate over A to a representation
ρ0 : G →GLm(A0)
Proof of Proposition 7.35.
Let B denote the A0-subalgebra in Mm(A) generated by ρ(G). The image
of B in Mm(k) is a central simple algebra over the ﬁnite ﬁeld k. It follows from
the triviality of the Brauer group (see §5.5.5) of the ﬁnite ﬁeldk that the image
of B in Mm(k) is the whole of Mm(k). Let e1, · · · , em2 be elements of B whose
reductions modulo mA form the standard basis of Mm(k) = B mod mA. We
shall show that e1, · · · , em2 is a basis for B over A0. By Nakayama's lemma
elements of B may be expressed in the form:
b =
m2

i=1
aiei, with ai ∈A.
Hence
tr(b · tej) =
m2

i=1
aitr(ei · tej), with j = 1, · · · , m2.
(7.4.1)
Let us deﬁne
cij = tr(ei
tej) ∈A ⇒(cij) ≡Im2 mod mA.
Hence the system (7.4.1) is solvable over the local ring A0. One deﬁnes V ⊂
Am to be the submodule generated by the columns of elements in B. Thus V ∼=
(A0)m is free, and we deduce that B
∼
→End(V ) ∼= Mm(A0) by Nakayama's
lemma.

7.4 Wiles' Main Theorem and Isomorphism Criteria for Local Rings
367
7.4.3 Constructions of the universal deformation ring RΣ
We assume that ρ0 is absolutely irreducible.
To prove the existence of RΣ one can either appeal to a general criterion
of Schlessinger (cf. Mazur's paper in [CSS95]), or instead use a more explicit
method of H.Lenstra (cf. the paper of Bart de Smit and H.W.Lenstra in
[CSS95]).
Consider ﬁrst a ﬁnite group G, and let us deﬁne an O-algebra O[G, m]
with generators:

Xg
ij | i, j = 1, · · · m; g ∈G

,
and the following relations:
Xe
ij = δij,
Xgh
ij =
m

l=1
Xg
ilXh
lj i, j = 1, · · · m; g, h ∈G
As these relations mimic the relations satisﬁed by matrix coeﬃcients of a
representation of G, it follows that for any A ∈CO there is a canonical iden-
tiﬁcation
HomO−alg(O[G, m], A) = Hom(G, GLm(A)).
(7.4.2)
Substituting A = O/λ = k in the above formula, we obtain a homomorphism
π0 of O-algebras corresponding to ρ0:
HomO−alg(O[G, m], k) = Hom(G, GLm(k))
l∪
l∪
π0
←−
ρ0.
Let m0 = Ker π0; we deﬁne the O-algebra RG to be the completion of O[G, m]
with respect to m0:
RG = lim
←−
n
O[G, m]/mn
0.
Now suppose we have a proﬁnite group:
GΣ = lim
←−
j
Gj.
Then we put
Rj = RGj,
RΣ = lim
←−
j
Rj.
It may be veriﬁed that
a)
Homρ0(G, GLm(A)) = HomO−alg(RΣ, A).
(7.4.3)
b) RΣ is a local Noetherian O-algebra (to show this, one uses a universal
bound for the dimension of the tangent space of Rj, and the absolute
irreducibility of ρ0).

368
7 Fermat's Last Theorem and Families of Modular Forms
7.4.4 A sketch of a construction of the universal modular
deformation ring TΣ
Let us again ﬁx a two-dimensional modular representation ρ0 : GQ →GL2(k)
over the ﬁnite ﬁeld k, together with sets S and Σ as above.
We shall consider a slightly diﬀerent Hecke algebra than in 7.3, Deﬁnition
7.24, namely,
T(Σ) = O[Tl, Uq, ⟨d⟩| l ∤NΣ, d ∈(Z/NZ)×, q ∈S ∪Σ].
We shall regard T(NΣ) as a subalgebra of EndOS2(NΣ, O). In the above we
have
NΣ = p

˜q∈S
˜q

˜l∈Σ
˜l2.
Furthermore S2(NΣ, O) denotes the O-submodule of O[[q]], generated by all
formal q-expansions of the form

n≥1
ip(an)qn ∈O[[q]],
such that
f =

n≥1
anqn ∈S2(NΣ; Q)
is a cusp form with coeﬃcients an ∈Q ∪i−1
p (O).
Let
˜f = f∅=

n≥1
˜anqn
denote Ribet's modular form of Theorem 7.30, attached to a two-dimensional
modular representation ρ0 : GQ →GL2(k) over the ﬁnite ﬁeld k.
Recall that Ribet's modular Galois representation
˜ρ = ρf,λ : GQ →GL2(O)
of minimal level N0 given by Theorem 7.30 belongs to the (non-empty) set
DM∅(O). For any Σ as above, we deﬁne
fΣ =

n≥1
˜an(fΣ)qn
by removing from the Mellin transform of ˜f the Euler factors at ˜l ∈Σ:
L(fΣ, s) =

n≥1
˜an(fΣ)n−s
(7.4.4)
=

˜q∈S
(1 −˜a˜q˜q−s)−1 
l∤NΣ
(1 −˜all−s + l1−2s)−1.

7.4 Wiles' Main Theorem and Isomorphism Criteria for Local Rings
369
Now consider the following ideal of the Hecke algebra:
MΣ = (λ, Tl −˜al, U˜q −˜a˜q, T˜l)l̸∈Σ∪S∪{p}, ˜q∈S,˜l∈Σ.
(7.4.5)
This ideal is actually prime, since
MΣ = Ker(T(Σ)
πfΣ
−→k[[q]]),
(7.4.6)
Tl →al mod λ,
U˜q →a˜q mod λ,
T˜l →0
(l ̸∈Σ ∪S ∪{p}, ˜q ∈S, ˜l ∈Σ),
and the ring k[[q]] is an integral domain.
We deﬁne TΣ to be the completion of T(Σ) with respect to the ideal MΣ:
TΣ = lim
←−
n
T(Σ)/Mn
Σ.
One can check that TΣ is a ﬁnite ﬂat local Noetherian O-algebra (i.e. it is a
free O-module of ﬁnite rank), and one deﬁnes an augmentation map TΣ →O
using ˜f.
Theorem 7.36. There exists, up to isomorphism, a unique admissible Galois
representation
ρuniv.mod.
Σ
: GQ →GL2(TΣ),
(7.4.7)
with the following properties:
tr(ρuniv.mod.
Σ
(Frobl)) = Tl,
(7.4.8)
det(ρuniv.mod.
Σ
(Frobl)) = l(l ̸∈Σ ∪S ∪{p}).
The construction by A.Wiles of the universal representation ρuniv.mod.
Σ
was
obtained from the Eichler-Shimura Theorem 7.26 by patching together all
the modular deformations of type DΣ. To achieve this he used of the the-
ory of pseudo-representations. The strong absolute irreducibility condition of
theorem 7.28, concerning the restriction
ρ0|G
Q
⎛
⎝
 
(−1)
p−1
2
p
⎞
⎠
,
was essential in this construction.
7.4.5 Universality and the Chebotarev density theorem
Let us recall Theorem 4.22 in the following form:

370
7 Fermat's Last Theorem and Families of Modular Forms
Theorem 7.37 (Chebotarev density theorem). Let L/K be a ﬁnite ex-
tension of number ﬁelds, and let X be a non-empty subset of G(L/K), invari-
ant under conjugation. Denote by PX the set of places v ∈Σ0
K, unramiﬁed
in L, such that the classes of Frobenius elements of these places belong to X:
FL/K(PX) ⊂X. Then the set PX is inﬁnite and has a density, which is equal
to Card X/Card G(L/K).
Corollary 7.38. The canonical morphism (7.3.2) is compatible with the aug-
mentation maps πRΣ and πTΣ
ϕΣ : RΣ →TΣ
(7.4.9)
In fact, the traces of representations πRΣ and πTΣ ◦ϕΣ coincide on the
subset of elements Frobl(l ̸∈ΣS) (which is dense in the group GΣS). It fol-
lows that the corresponding universal deformations are equivalent, hence they
coincide by their universal property.
7.4.6 Isomorphism Criteria for local rings
To prove that the canonical morphism (7.3.2)
ϕΣ : RΣ →TΣ
of universal deformation rings is an isomorphism (in the category CO), one
argues by induction on Σ. Let Σ′ = Σ ∪{l} for some prime l not in ΣS. Wiles
deduced the bijectivity of ϕΣ′ from the bijectivity of ϕΣ using an isomorphism
criterion for local rings. This criterion is formulated in terms of certain invari-
ants, which will be described next. In order to start the induction, one needs
to prove the case Σ = ∅; this is achieved by a second isomorphism criterion
for local rings.
Deﬁnition 7.39. A local Noetherian O-algebra A is called a complete inter-
section if:
a) A is a free O-module of ﬁnite rank;
b) A ∼= O[[X1, · · · , Xn]]/(f1, · · · , fn).
(cf. [Mats70]).
We shall use the following invariants of a local O-algebra A:
IA = KerπA,
ΦA = IA/I2
A,
ηA = πA(AnnIA) ⊂O
(7.4.10)
These are called respectively the kernel of augmentation, the tangent space
and the congruence module.
Example 7.40. a) A = O = Zp, ΦA = IA/I2
A = {0}

7.4 Wiles' Main Theorem and Isomorphism Criteria for Local Rings
371
b) A = Zp[[X, Y ]]/(X(X −p), Y (Y −p)), ΦA = Z/pZ × Z/pZ, ηA = (p2).
The augmentation map in this case is given by
πA(f) = f(0, 0) ∈Zp, A is a complete intersecton ring.
The ring A is a complete intersection.
c) A = Zp[[X, Y ]]/(X(X −p), Y (Y −p), XY ), ΦA = Z/pZ × Z/pZ, ηA = (p).
The augmentation is given by
πA(f) = f(0, 0) ∈Zp.
In this case A is not a complete intersection.
Theorem 7.41 (Criterion I). Let ϕ : A →B be a surjective morphism in
the category CO. Then the following are equivalent:
(i) ϕ is an isomorphism of two local complete intersection O-algebras;
(ii) #ΦA ≤#O/ηB < ∞;
(iii) #ΦA = #O/ηB < ∞.
Remark 7.42. In the ﬁrst version of his proof A.Wiles had made the assump-
tion that the ring B is Gorenstein (i.e. ˇB = Hom(B, O) is a free B-module
of rank 1). This restriction was later removed by H.Lenstra.
Corollary 7.43. An O-algebra A ∈CO is a complete intersection ring if and
only if
#ΦA = #O/ηA < ∞.
This is proved by applying Criterion I to the identity map idA : A →A.
7.4.7 J-structures and the second criterion of isomorphism of
local rings
Let us consider the distinguished ideals
Jm = (ωm(S1), · · · , ωm(Sn)) ⊂O[[S1, · · · , Sn]],
where
ωm(S1) = (1 + S1)pm −1,
ωm(Sn) = (1 + Sn)pm −1,
J0 = (S1, · · · , Sn).
Deﬁnition 7.44. Let ϕ : A →B be a surjective morphism in CO. One says
that ϕ admits a J-structure, if there is a family of commutative diagrams,
indexed by m ∈N:
O[[S1, · · · , Sn]]
σm

O[[T1, · · · , Tn]]
ξm
 Am
ϕm


Bm

A
ϕ
 B

372
7 Fermat's Last Theorem and Families of Modular Forms
with the following properties for each m:
i) ξm is surjective;
ii) ϕm is surjective;
iii) Am/J0Am ∼= A and Bm/J0Bm ∼= B.
iv) Bm/JmBm is a torsion free module of ﬁnite rank over the O-algebra
O[[S1, · · · , Sn]]/Jm.
Theorem 7.45 (Criterion II).
Let ϕ : A →B be a surjective morphism in the category CO.
If ϕ admits a J-structure then ϕ is an isomorphism of two local complete
intersection O-algebras.
Proof of both criteria belong to commutative algebra. We refer therefore
the reader to [CSS95], [Ta-Wi].

7.5 Wiles' Induction Step: Application of the Criteria
and Galois Cohomology
7.5.1 Wiles' induction step in the proof of
Main Theorem 7.33
In §7.4.3-7.4.4 we explained the existence of the universal deformation rings
RΣ, TΣ ∈CO. These universal rings represent the functors of admissible defor-
mations (respectively modular deformations). This means that for any A ∈CO
one has
DAΣ(A) = HomCO(RΣ, A) ⊃DMΣ(A) = HomCO(TΣ, A).
In particular, substituting of A = TΣ we obtain a canonical morphism (7.3.2):
ϕΣ : RΣ →TΣ,
and the canonical universal pairs
(RΣ, ρuniv
Σ
), and (TΣ, ρuniv.mod.
Σ
)
are related by the commutative diagrams :
RΣ
ϕΣ

πRΣ













TΣ
πTΣ

O
GL2(RΣ)
ϕΣ

GQ
ρuniv
Σ










ρuniv.mod.
Σ
	
	
	
	
	
	
	
	
	
GL2(TΣ)
(see §7.4.5).
Let us recall the Main Theorem 7.33 in the following form:
Theorem 7.46 (Main Theorem). Suppose that ρ0 : GQ →GL2(k) is a
modular representation over a ﬁnite ﬁeld k, such that the restriction
ρ0|G
Q
⎛
⎝
 
(−1)
p−1
2
p
⎞
⎠
is absolutely irreducible.
Then the canonical morphism (7.3.2)
ϕΣ : RΣ →TΣ
of universal deformation rings is an isomorphism of complete intersection
rings (in the category CO).

374
7 Fermat's Last Theorem and Families of Modular Forms
Remark 7.47. i) We have already seen in §7.4.3 that ϕΣ is surjective.
ii) Recall that the proof of injectivity of ϕΣ : RΣ →TΣ was given by A.Wiles
using induction on Σ. We shall denote Σ′ = Σ ∪{l} for a prime l not in
ΣS. Wiles deduced the bijectivity of ϕΣ′ from the bijectivity of ϕΣ using
Criterion I (see §7.4.6) for isomorphisms of local rings. This criterion is
formulated in terms of the invariants (7.4.10). To begin the induction one
needs the case Σ = ∅. This case is proved using Criterion II of §7.4.6 for
isomorphisms of local rings.
The Induction Step
Let us consider
Σ′ = Σ ∪{l},
D′ = DΣ′,
D = DΣ,
A = RΣ,
B = TΣ′.
We shall assume the induction hypothesis, i.e.
ϕΣ : RΣ
∼
→TΣ.
This implies the equality of the corresponding invariants:
#ΦRΣ = #O/ηTΣ < ∞.
(7.5.1)
According to Criterion I, it suﬃces to prove the inequality
#ΦRΣ′ ≤#O/ηTΣ′ < ∞,
(7.5.2)
given the equality (7.5.1). The left hand side of this inequality is controlled
by a Galois cohomology group. The right hand side will be computed using
a determinant representing a relative invariant ηΣ′,Σ, which relates #O/ηTΣ′
and #O/ηTΣ. A fundamental inequality relating these quantities will imply
the induction step.
Base of induction: the minimal case
We shall construct in the next section §7.6.3 a J-structure for the surjective
morphism ϕ∅. This will show by Criterion II (see §7.4.6) that both rings R∅
and T∅are isomorphic complete intersection rings.
7.5.2 A formula relating #ΦRΣ and #ΦRΣ′: preparation
We explain below in §7.5.5 a formula relating #ΦRΣ and #ΦRΣ′ using Galois
cohomology groups with coeﬃcients certain GQ-modules, which we shall now
describe. Let
˜f = f∅=

n≥1
˜anqn

7.5 Application of the Criteria and Galois Cohomology
375
denote Ribet's modular form of Theorem 7.30, attached to a two-dimensional
modular representation ρ0 : GQ →GL2(k) over the ﬁnite ﬁeld k.
Recall that Ribet's modular Galois representation
˜ρ = ρf,λ : GQ →GL2(O)
of minimal level N0 given by Theorem 7.30 belongs to the (non-empty) set
DM∅(O).
Consider the reduction
˜ρ mod λn : GQ →GL2(O/λn).
We shall use the following ﬁnite GQ-modules Xλn deﬁned by
Xλn = Ad0
˜ρ mod λn ⊂M2(O/λn) ⊂Ad0(˜ρ ⊗K/O) = X˜ρ.
The notation Ad will be explained below, cf. §7.5.4 (we identify the O-modules
O/λn and λ−n/O by choosing a uniformizer).
7.5.3 The Selmer group and ΦRΣ
In order to compute the invariant #ΦRΣ, A.Wiles established an isomorphism
of O-modules
HomO−mod(ΦRΣ, K/O) ∼= SelDΣ ⊂H1(GQ, X˜ρ)
where
SelDΣ = H1
DΣ(GQ, X˜ρ)
is a generalized Selmer group. This is a ﬁnite O-submodule of the (inﬁnite) O-
module H1(GQ, X˜ρ). The group SelDΣ is contained in the (usual) Σ-Selmer
group, which is a ﬁnite O-submodule SelΣ of H1(GQ, X˜ρ), consisting of all
cohomology classes unramiﬁed outside of Σ ∪S ∪{p}, compare with (5.3.40):
SelΣ(X˜ρ) := {x ∈H1(GQ, X˜ρ) | ∀l ̸∈Σ, ResGQ
Il x = 0},
(7.5.3)
where ResGQ
Il x denotes the restriction of x to the inertia subgroup Il.
7.5.4 Inﬁnitesimal deformations
Consider a representation ρ : G →GLn(A) of a group G. This determines an
A[G]-module structure on the free A-module M = An, with the action of G
given by ρ. We shall also consider the following A[G]-modules:
Ad(M) = EndAM,
g : x →ρ(g)xρ(g)−1
(7.5.4)
∪
Ad(M)tr=0 = Endtr=0
A
(M) (an A[G] −submodule).

376
7 Fermat's Last Theorem and Families of Modular Forms
Deﬁnition 7.48. 1) An extension of M by M is a short exact sequence of
A[G]-modules of the form
0 −→M
α
−→E
β
−→M −→0.
2) Consider the ring A[ε] generated over A by an element ε subject to the
relation ε2 = 0. There is a projection map πε=0 : A[ε] →A which takes ε
to 0. By an inﬁnitesimal deformation of a representation ρ : G →GLn(A),
we shall mean a representation ρ′ : G →GLn(A[ε]), such that ρ = πε=0◦ρ′:
GLn(A[ε])
πε=0

G
ρ′











ρ
	
	
	
	
	
	
	
	
	
	
GLn(A)
3) Two inﬁnitesimal deformations ρ′, ρ′′ : G →GLn(A[ε]) are said to be
strictly equivalent if there exists a matrix C ∈1n + εMn(A[ε]) such that
for all g ∈G, ρ′′(g) = C−1ρ′(g)C.
Remark 7.49. The construction of an inﬁnitesimal deformation may be viewed
as the ﬁrst step in the construction of any deformation.
Theorem 7.50. There are canonical bijections between the following three
sets a), b), c) :
a) H1(G, Adρ);
b) The set Ext1(M, M) of equivalence classes of extensions of M by M;
c) The set of strict equivalence classes of inﬁnitescimal deformations of ρ.
Proof of Theorem 7.50
Let us consider an extension
0 −→M
α
−→E
β
−→M −→0.
The module M is a free A-module. Hence we may choose a section φ : M →E
of β, which is morphism of A-modules but not of A[G]-modules.
This means that for all m ∈M and g ∈G we have
gφ(g−1m) −φ(m) ∈Ker(β) = Im(α),
since
β(gφ(g−1m) −φ(m)) = gβφ(g−1m) −βφ(m) = 0.

7.5 Application of the Criteria and Galois Cohomology
377
From this we obtain the following 1-cocycle (representing a cohomology class
in H1(G, Ad(ρ))):
Tg :=

m →α−1(gφ(g−1m) −φ(m))

∈EndA(M) = Adρ.
One rereads the cocycle condition as by saying that
ρ′(g) := (1n + εTg)ρ(g)
is an inﬁnitesimal deformation.
Conversely, any cocycle {Tg} ∈H1(G, Adρ), deﬁnes an extension M ⊗A
A[ε] ∼= M ⊕εM with the action given by ρ′.
Remark 7.51. If detρ′ = detρ, then there is the identity
det(1n + εTg)detρ(g) = detρ(g) ⇒trTg = 0
and it follows that H1(G, Ad0ρ) describes the deformations with ﬁxed deter-
minant.
7.5.5 Deformations of type DΣ
The deformations of type DΣ are deﬁned starting from the restriction maps
ResGQ
Dl : H1(GQ, X) −→H1(Dl, X)
which are used in the deﬁnition of the generalized Selmer groups.
Examples of computations of Selmer groups
(comp. with §5.3, §4.5). Given a short exact sequence 0 −→A −→B −→
C −→0 of three G-modules, there is a long exact sequence (4.5.23) of coho-
mology groups:
0 −→H0(A) −→H0(B) −→H0(C)
(7.5.5)
−→H1(A) −→H1(B) −→· · · , Hn(A) = Hn(G, A).
We shall use this sequence to deduce Kummer theory:
Example 7.52 (Kummer theory and Quadratic Characters). Let K be a ﬁeld
containing the group µm of all roots of unity of degree m in K. Assume further
that Char K does not divide m. For an arbitrary Galois extension L/K with
Galois group G = Gal(L/K) the map x →xm deﬁnes a homomorphism of
G-modules: ν : L× −→L×, and one has the following exact sequence
1 −→µm −→K
×
ν
−→K
× −→1.

378
7 Fermat's Last Theorem and Families of Modular Forms
Passing to cohomology groups (4.5.22) we obtain the following long exact
sequence
H0(GK, µm) −→H0(GK, K
×)
ν
−→H0(GK, K
×) −→
H1(GK, µm) −→H1(GK, K
×)
ν
−→H1(GK, K
×) −→· · · .
(7.5.6)
Since G acts trivially on µm, it follows that H1(G, µm) coincides with the
group Hom(G, µm). The group H0(G, L×) is the subgroup of all ﬁxed points
of the Galois action, i.e. H0(G, L×) = L×Gal(L/K) = K×. Also, H0(G, µm) =
µm, and H1(G, L×) = {1}, by Hilbert's theorem 90. We thus have the follow-
ing exact sequence
1 −→µm −→K×
ν
−→K× −→Hom(G, µm) −→1,
which is equivalent to the isomorphism of Kummer:
K×/K×m ∼= Hom(GK, µm).
In particular, letting m = 2 and K = Q, we have
H1(GQ, {±1}) = Q×/Q×2 ∼= Hom(GQ, µ2).
The right hand side here is the (inﬁnite) set of all quadratic characters of GQ.
Fixing a ﬁnite set Σ of primes, we have
SelΣ({±1}) ∼=
8
the ﬁnite set of all quadratic characters of GQ
unramiﬁed outside Σ
9
.
Example 7.53 (The inﬂation-restriction sequence and Local Tate duality). Let
H be an open normal subgroup in G and let A be a G-module. Then one has
the following "inﬂation - restriction" exact sequence (comp. with (4.5.24)):
0 −→H1(G/H, AH)
Inf
−→H1(G, A)
Res
−→
(7.5.7)
H1(H, A)G/H −→H2(G/H, AH).
Theorem 7.54 (Local Tate duality). Let X be a ﬁnite Dl module, where
Dl = Gal(Ql/Ql) ⊂GQ, and let n = |X|. We shall also consider the dual
module
X∗= Hom(X, µn)
((gx∗)(x) = gx∗(g−1x).
Then:
a) The groups Hi(Dl, X) are ﬁnite for all i ≥0, and are trivial for i ≥3;
b) There is a non-degenerate pairing
Hi(Dl, X) × H2−i(Dl, X∗) −→H2(Dl, Q
×
l ) ∼= Q/Z;

7.5 Application of the Criteria and Galois Cohomology
379
c) If l ∤|X| then the subgroups of unramiﬁed classes
H1(Dl/Il, XIl) and H1(Dl/Il, (X∗)Il)
are each other's annihilators with respect to the above pairing;
d) The Euler characteristic of X is given by the following explicit formula:
#H1(Dl, X)
#H0(Dl, X) · #H2(Dl, X) = lvl(#X) =
#H1(Dl, X∗)
#H0(Dl, X∗) · #H2(Dl, X∗).
Generalized Selmer groups
Deﬁnition 7.55. Let X be a ﬁnite GQ-module and suppose we have a family
L = {Ll} of subgroups Ll ⊂H1(Dl, X), which are ﬁnite by Theorem 7.54.
We shall assume that for l ̸∈Σ we have
Ll = Ker(H1(Dl, X) −→H1(Il, X)).
(7.5.8)
The Selmer group attached to a family L = {Ll} is deﬁned by
SelL(X) = {x ∈H1(GQ, X) | ∀l, ResGQ
Dl (x) ∈Ll}.
(7.5.9)
Remark 7.56. It follows from (7.5.8) and (7.5.3) that SelL(X) ⊂SelΣ(X).
Interpretation of ΦRΣ as a generalized Selmer group
Consider the ﬁnite GQ-module Xλn = Ad0˜ρ mod λn, where
˜ρ : GQ −→GL2(O)
denotes Ribet's modular Galois representation of minimal level (see Theorem
7.30). Let us ﬁx a (ramiﬁcation) type DΣ and consider the tangent space
ΦRΣ = IRΣ/I2
RΣ. This group was interpreted by Wiles using the generalized
Selmer group attached to the following family
Ll =
⎧
⎪
⎨
⎪
⎩
Ker(H1(Dl, Xλn) −→H1(Il, Xλn)),
if l ̸∈ΣS
H1(Dl, Xλn),
if l = p
Ker(H1(Dl, Xλn) −→H1(Il, Xλn/X0)), X0 =
 0
0
∗
0

,
if l ∈Σ ∪S
(7.5.10)
Deﬁnition 7.57. With the choice of X = Xλn as above, and LΣ = {Ll}
given by 7.5.10, we deﬁne
SelDΣ(X) =SelL(X) = H1
DΣ(GQ, X) =
(7.5.11)
{x ∈H1(GQ, X) | ∀l, ResGQ
Dl (x) ∈Ll}.

380
7 Fermat's Last Theorem and Families of Modular Forms
Theorem 7.58. There is an isomorphism of ﬁnite O-modules:
HomO−mod(IRΣ/I2
RΣ, O/λn) = H1
DΣ(GQ, Xλn).
Lemma 7.59. There is an isomorphism of ﬁnite O-modules:
Homk(mRΣ/(λ, m2
RΣ), k) = H1
DΣ(GQ, Ad0ρ0).
Proof of Lemma 7.59. By Theorem 7.50, the restriction map
HomO−alg(RΣ, k[ε]) ∋φ −→φ|mRΣ : mRΣ/(λ, m2
RΣ) →k
gives a canonical isomorphism
HomO−alg(RΣ, k[ε]) ∼= Homk(mRΣ/(λ, m2
RΣ), k).
Indeed, any such φ vanishes on (λ, m2
RΣ), and is determined by its restriction
to mRΣ by the formula
RΣ ∋x →ι(x) + εφ(x −ι(x)) ∈k + εk.
In the above,
ι : RΣ →RΣ/mRΣ
∼
→k →RΣ
is the canonical projection and φ is the identity on ι(RΣ). By the universal
property of RΣ, the map φ is may be identiﬁed with an inﬁnitesimal defor-
mation
ρ′ : GQ −→GL2(k[ε])
of ρ0 of type DΣ, i.e. with an element of H1
DΣ(GQ, Ad0ρ0). This implies the
lemma.
To deduce Theorem 7.58 from Lemma 7.59, one can replace mRΣ by
(IRΣ, λn), where IRΣ = Ker(πRΣ : RΣ →O), using a version of Nakayama's
lemma (we omit the details).
Now we explain a formula relating #ΦRΣ and #ΦRΣ′. An explicite formula
for #ΦRΣ can be obtained from the cohomological exact sequence of Poitou-
Tate.
However, a weaker result suﬃces for Wiles' induction, namely:
#ΦRΣ′ ≤#ΦRΣ · #H1(Il, X)Dl, where Σ′ = Σ ∪{l},
(7.5.12)
which follows from
0 −→SelDΣ −→SelDΣ′ −→H1(Il, X)Dl,
and may be deduced from the following form of the inﬂation-restriction se-
quence (7.5.7) (we use the fact that X is unramiﬁed at l, i.e. Il acts trivially
on X):
0 −→H1(Dl/Il, X)
Inf
−→H1(Dl, X)
Res
−→
(7.5.13)
H1(Il, X)Dl −→H2(Dl/Il, X) −→H2(Dl, X).

7.5 Application of the Criteria and Galois Cohomology
381
Induction step: reformulation
Let us use the induction hypothesis and assume that
ϕΣ : RΣ
∼
→TΣ,
which implies the equality of the corresponding invariants (7.5.1)
#ΦRΣ = #O/ηTΣ < ∞.
According to Criterion I, it suﬃces to prove the inequality (7.5.2)
#ΦRΣ′ ≤#O/ηTΣ′ < ∞.
The left hand side is controlled by a Galois cohomology group: we know by
(7.5.12) that
#ΦRΣ′ ≤#ΦRΣ · #H1(Il, X)Dl, where Σ′ = Σ ∪{l}.
The right hand side will be computed below using a relative invariant ηΣ′,Σ
which relates #O/ηTΣ′ and #O/ηTΣ:
#O/ηTΣ′ = #O/ηTΣ · #O/πTΣ(ηΣ′,Σ).
We explain next the main inequality between these quantities implying
the induction step.

7.6 The Relative Invariant, the Main Inequality and The
Minimal Case
7.6.1 The Relative invariant
Recall that we use the following invariants (7.4.10) of a local O-algebra A:
IA = KerπA,
ΦA = IA/I2
A,
ηA = πA(AnnIA) ⊂O
(the "kernel of augmentation", resp. the "tangent space", resp. the "congruence
module").
Under the induction hypothesis there is an isomorphism of complete in-
tersection O-algebras:
ϕΣ : RΣ
∼
→TΣ,
and this implies the following identity:
#ΦRΣ = #O/ηTΣ < ∞.
According to Criterion I, it suﬃces to prove the following inequality (7.5.2):
#ΦRΣ′ ≤#O/ηTΣ′ < ∞,
where Σ′ = Σ ∪{l}, given (7.5.1). The left hand side is controlled by a Galois
cohomology group: we know by (7.5.12) that
#ΦRΣ′ ≤#ΦRΣ · #H1(Il, X)Dl, where Σ′ = Σ ∪{l}.
The right hand side will be computed below using a certain relative invariant
ηΣ′,Σ which relates #O/ηTΣ′ and #O/ηTΣ:
#O/ηTΣ′ = #O/ηTΣ · #O/πΣ(ηΣ′,Σ).
We have by deﬁnition
ηTΣ = πTΣ(AnnITΣ) ⊂O, ηTΣ′ = πTΣ′(AnnITΣ′) ⊂O.
(7.6.1)
Notice that by the universal property of TΣ, we have a commutative diagram:
TΣ′
πΣ′,Σ

πTΣ′








TΣ
πTΣ

O
(7.6.2)
From this we obtain
O ⊃ηTΣ′ = ηTΣ · πTΣ(ηΣ′,Σ),
(7.6.3)
where

7.6 The Relative Invariant, the Main Inequality and The Minimal Case
383
ηΣ′,Σ = πΣ′,Σ(AnnITΣ′)
is called the relative invariant of the morphism πΣ′,Σ.
An explicit computation of the invariant using the construction of the
universal modular deformation ring TΣ in §7.4.4 leads to
ηΣ′,Σ = πΣ′,Σ(AnnITΣ′) = (l −1)(T 2
l −(l + 1)2) ∈TΣ.
(7.6.4)
This calculation involve computations with the reduction of modular curves
(see [Da95]). We omit the details.
Below we shall explain the main inequality between these quantities:
#H1(Il, X)Dl ≤#O/πTΣ(ηΣ′,Σ), where Σ′ = Σ ∪{l}.
(7.6.5)
This inequality impies the induction step. The use of the relative invariant in
(7.6.5)
#O/πTΣ(ηΣ′,Σ)
require the choice of augmentations πTΣ and πRΣ given above by (7.3.4):
πRΣ : trρuniv
Σ
(Frobl) →al
πTΣ : trρuniv.mod.
Σ
(Frobl) →al
where al ∈O are the Fourier coeﬃcients of Ribet's cusp eigenform
f(z) =
∞

n=0
ane(nz) ∈Sk(N0)
of minimal level (whose Galois representation ρf,λ corresponds to a deforma-
tion ρ ∈DM∅(O)).
7.6.2 The Main Inequality
Applying the augmentation πTΣ to ηΣ′,Σ given above by (7.3.4) to the relative
invariant ηΣ′,Σ introduced above, we obtain:
πTΣ(ηΣ′,Σ) = πTΣ((l −1)(T 2
l −(l + 1)2))
(7.6.6)
= (l −1)(a2
l −(l + 1)2) ∈O.
Notice that the quantity (7.6.6) does not vanish due to Deligne's bound: |al| <
2
√
l:
πTΣ(ηΣ′,Σ) = (l −1)(a2
l −(l + 1)2) ̸= 0.
We shall deduce the main inequality (7.6.5) in the following more explicit
form:

384
7 Fermat's Last Theorem and Families of Modular Forms
Theorem 7.60 (Main Inequality). Consider for any n ≥1 the ﬁnite GQ-
module X = Ad0˜ρ mod λn, where
˜ρ : GQ −→GL2(O)
denotes Ribet's modular Galois representation of minimal level (see Theorem
7.30). Then the following inequality holds:
#H1(Il, X)Dl ≤#O/(l −1)(a2
l −(l + 1)2), where Σ′ = Σ ∪{l}.
(7.6.7)
Proof follows from a computation of a determinant. Taking into account that
H1(Il, X)Dl = HomDl(Il, X).
(7.6.8)
Since the action of Il on X = Ad0˜ρ mod λn is trivial for l ∤N(˜ρ), it follows
that
H1(Il, X)Dl = HomDl(Il, X).
(7.6.9)
Notice that Il ∼= Gal(Ql/Qnr
l ), where Qnr
l
⊃µp∞is the maximal non-
ramiﬁed extension of Ql (which contains all p-power roots of unity because
p ̸= l).
This means that there exists a canonical surjection
Il −→Zp(1) = lim
←−
n
µpn
(the right hand side here is the Galois group of the maximal Kummer p-
extension of Qnr
l ).
Next, notice that the order of the ﬁnite module X = Ad0˜ρ mod λn is a
power of p. Hence any homomorphism in (7.6.9) factorizes through Zp(1). We
therefore have
HomDl(Il, X) = HomDl(Zp(1), X) = X(−1)Dl
(7.6.10)
where
X(−1) = X ⊗Zp(−1), Zp(−1) = Hom(Zp(1), Zp).
Since the action of Il on X = Ad0˜ρ mod λn is trivial, we now see that
X(−1)Dl = X(−1)Dl = X(−1)Frobl = Ker(Frobl −1)|X(−1).
(7.6.11)
We may calculate further:
#Ker(Frobl −1)|X(−1) = #Coker(Frobl −1)|X(−1)
(7.6.12)
= #O/det(Frobl −1)|X(−1)
and one only needs to verify that that

7.6 The Relative Invariant, the Main Inequality and The Minimal Case
385
#O/det(Frobl −1)|X(−1) = #O/(l −1)(a2
l −(l + 1)2).
To prove this we shall calculate explicitely the eigenvalues of Frobl −1 on
X(−1). Let α = αl and β = βl be the eigenvalues of of Frobl acting on the
O-module M = O2. Thus we have:
α + β = al,
αβ = l
We shall now determine the eigenvalues of Frobl acting on the following O-
modules:
- on ˇ
M = Hom(M, Q/Z) the eigenvalues of Frobl are {α−1, β−1};
- on EndM ∼= M ⊗ˇ
M the eigenvalues of Frobl are: {1, 1, αβ−1, βα−1}. To
see this, note that
α
0
0
β

⊗
α−1
0
0
β−1

=
⎛
⎜
⎜
⎝
1 0
0
0
0 1
0
0
0 0 αβ−1
0
0 0
0
βα−1
⎞
⎟
⎟
⎠
- on Ad0˜ρ ⊂EndM there are only three eigenvalues of Frobl:
8
1, αβ−1 = α2
αβ = α2
l , βα−1 = β2
αβ = β2
l
9
.
- on X(−1) there are the following eigenvalues of Frobl:
81
l , α2
l2 , β2
l2
9
.
This is because X(−1) = Zp(−1) ⊗X, and Frobl acts on Zp(−1) as 1
l ;
- ﬁnally the eigenvalues of Frobl −1 on X(−1) are the following:
81
l −1, α2
l2 −1, β2
l2 −1
9
.
It follows that:
det(Frobl −1)|X(−1) = (1
l −1)(α2
l2 −1)(β2
l2 −1) =
−(l −1)(l2 −α2)(l2 −β2)
l5
=
−(l −1)(l4 −l2(α2 + β2) + α2β2)
l5
=
−(l −1)(l2 + 1 −(α2 + β2))
l3
= −(l −1)(a2
l −(l + 1)2)
l3
.
This proves the Main inequality (7.6.7), because l ∈O× is a unit.
⊓⊔

386
7 Fermat's Last Theorem and Families of Modular Forms
7.6.3 The Minimal Case
We keep the notations and assumptions of Main theorem 7.33. To complete
the proof of Main theorem 7.33, we now treat the minimal case Σ = ∅, and
establish the following
Theorem 7.61. The surjective morphism
ϕ∅: R∅−→T∅
in the category CO is an isomorphism of complete intersection O-algebras.
Proof of Theorem 7.61. We notice ﬁrst that the O-algebra R∅admits n (topo-
logical) generators, where
n = dimk IR∅/I2
R∅= dimk SelD∅(X).
Here X = M2(k)tr=0 is a ﬁnite GQ-module with the action given by the
representation ρ0.
We shall construct a J-structure on the surjective morphism ϕ∅. By Cri-
terion II of §7.4.6, this will show that R∅and T∅are isomorphic complete
intersection rings.
The construction of the J-structure uses Nakayama's lemma and the
Chebotarev density theorem (see Theorem 4.22).
For any m ∈N, we choose a ﬁnite set of primes:
Qm = {qm1, · · · , qmn}
(7.6.13)
with the properties
- qmj ≡1 mod pm (⇐⇒pm divides #(Z/qmjZ)×);
- the eigenvalues of ρ0(Frobqmj) in k are distinct.
- Qm ∩S = ∅.
We begin deﬁning the J-structure using using these ﬁnite sets of primes Σ =
Qm as follows:
Am = RQm, Bm = TQm, A = R∅, B = T∅.
We have:
O[[S1, · · · , Sn]]/Jm = O[[S1, · · · , Sn]]/(ωm(S1), · · · , ωm(Sn))
(7.6.14)
= O[∆1 × · · · × ∆n],
where ∆j denotes the cyclic subgroup of order pm in (Z/qmjZ)×.
We shall consider deformations ρ of type Dm = DQm.

7.6 The Relative Invariant, the Main Inequality and The Minimal Case
387
Proposition 7.62. Under the notations and assumptions of the Main Theo-
rem 7.33, there is an isomorphism
Sel∅∼= SelDm;
the O-algebra Am = RQm admits n generators.
Proof of Proposition 7.62 uses an explicit formula for the order of the ﬁnite
group #SelDm obtained from the cohomological exact sequence of Poitou-
Tate. We omit the details here, but see §7.5.5.
In order to have a J-structure notice that for any q = qmj ∈Qm the action
of the inertia group Iq on X factorizes through the quotient ∆q of (Z/qZ)×
of order pm, by a result of Faltings:
Iq →Gal(Q(µq)/Q) ∼= (Z/qZ)× →∆q.
(see Appendix by G. Faltings to [Wi]). Next, notice that
Zp[∆q] ∼= Zp[[S]]/ωm(S), ωm(S) = (1 + S)pm −1,
and there is an isomorphism
O[∆qm1 × · · · × ∆qmn] := Cm ∼= O[[S1, · · · , Sn]]/Jm,
(7.6.15)
where Jm = (ωm(S1), · · · , ωm(Sn)) ⊂O[[S1, · · · , Sn]]. According to a result
of de Shalit on the structure of certain Hecke algebras, Bm/JmBm is a torsion
free module of ﬁnite rank over Cm (see in [CSS95]; the proof of this result
uses diamond operators in the Hecke algebras T(NΣ)).
Consider the surjective morphism ϕ : A →B of Theorem 7.61. Then
the isomorphism shows that ϕ admits a J-structure: there exists a family of
commutative diagrams, for all m ∈N:
O[[S1, · · · , Sn]]
σm

O[[X1, · · · , Xn]]
ξm
 Am
ϕm


Bm

A
ϕ
 B
with the following properties:
i) ξm is surjective;
ii) ϕm is surjective;
iii) Am/J0Am ∼= A,
Bm/J0Bm ∼= B.
iv) Bm/JmBm is a torsion free module of ﬁnite rank over the O-algebra
O[[S1, · · · , Sn]]/Jm.
In order to conclude the proof of Theorem 7.61, we apply directly Criterion
II of §7.4.7: let ϕ : A →B be a surjective morphisme in the category CO,
which admits a J-structure. Then ϕ is an isomorphism of two local complete
intersection O-algebras (see also [Ta-Wi]).

7.7 End of Wiles' Proof and Theorem on Absolute
Irreducibility
7.7.1 Theorem on Absolute Irreducibility
In this section we explain Wiles' deduction of the Shimura-Taniyama-Weil
conjecture (Theorem 7.13) from the theorem on modularity of admissible de-
formations 7.33.
In order to use Theorem 7.33 one needs to have an absolutely irreducible
Galois representation ρ0 over a ﬁnite ﬁeld k, starting from an elliptic curve.
Theorem 7.63 (Irreducibility). Let
E : y2 = 4x3 −g2x −g3
be the Weierstrass form of a semistable elliptic curve over Q. Suppose that the
Galois representations ρ3,E and ρ5,E are both reducible.
Then we have the only four possibilities for jE:
jE ∈
8
−25
2 , −52 · 2413
23
, −5 · 293
25
, 5 · 2113
215
9
,
and E is modular.
Proof of Theorem 7.63. The modularity of E in the exceptional cases above
is checked directly, using for example the Cremona tables [Cre97], (see also
[Rub95], Lemma 9).
We shall use modular parameterization of the set of equivalence classes of
elliptic curves, see §6.3.2, (6.3.13)):
Γ0(N)\H ←→
8
(E, CN)

an elliptic curve over C
together with a cyclic subgroup of order N
9@
∼
(isomorphism)
This set can be identiﬁed with the set of C-points of an aﬃne algebraic curve
Y0(N). The C-points of its Zariski closure X0(N) (called a modular curve) can
be identiﬁed with the compact quotient Γ0(N)\H. Both curves are deﬁned over
Q. The boundary
X0(N)(C)\Y0(N)(C) ←→Γ0(N)\(Q ∪∞)
is the set of cusps (Γ0(N)-equivalent classes of parabolic points, deﬁned over
Q by a theorem of Manin-Drinfeld). Under this identiﬁcation, rational points
Y0(N)(Q) correspond to the set
8
(E, CN)

an elliptic curve over Q together with a
GQ −invariant cyclic subgroup of order N
9@
∼
(isom),

7.7 End of Wiles' Proof and Theorem on Absolute Irreducibility
389
Therefore:
X0(N)(Q) ←→
{cusps}
. 8
(E, CN)

an elliptic curve E over Q with a
GQ-invariant cyclic subgroup of order N
9@
∼
(isom),
Example 7.64. The modular curve X0(15) has 4 cusps and it is in fact an
elliptic curve which can be deﬁned by the equation y2 = x(x + 32)(x −42),
with the following rational points:
X0(15)(Q) ←→
8
(0, 0), (−9, 0), (16, 0), ∞
(−4, ±20)), (−36, ±180)
9
.
Now let ρ3,E be a reducible representation, then there exists a GQ-invariant
cyclic subgroup C3 ⊂E(Q); and if ρ5,E is also a reducible representation, then
there exists a GQ-invariant cyclic subgroup C5 ⊂E(Q) of order 5.
We obtain therefore a GQ-invariant cyclic subgroup C15 = C3+C5 ⊂E(Q),
which gives one of the four points of type (E, C15) in the set
X0(15)(Q)\{cusps}
and an explicit evaluation of the invariants jE ﬁnishes the proof of Theorem
7.63.
Proposition 7.65 ([Se95], Proposition 1). Let E be a semistable elliptic
curve over Q. Then either
- ρ0 = ρ3,E is surjective or
- the image ρ0(GQ) is conjugate to a subgroup of
 ∗
0
∗
∗

, i.e. ρ0 is reducible.
Proof. Let G be the image of ρ0 under the projection to PGL2(F3) ∼= S4.
Each g ∈GQ maps to a permutation σg ∈S4 on the set of 4 lines in F2
3.
Suppose that neither i) nor ii) holds. Then G ̸= S4 and there are no ﬁxed
points. But ρ0 is odd and
det(ρ0(g)) = sgn(σg) ∈{±1} ∈F×
3 : GL2(F3) −→F×
3 .
Hence G is not contained in A4. It follows that either G ∼= D4 ∼= ⟨(1234),
(14)(23)⟩(the dihedral group), or G ⊂D4 is a subgroup of index 2 in D4. In
both cases, the group Gab = G/[G, G] has order 4. However ρ0 is semistable
so for all l ̸= 3, ρ0(I3) ∼
 1
0
∗
1

= 1. Since the order of G is not divisible
by 3, this implies that ρ0(Il) = 1. On the other hand, the Galois group of the
maximal abelian extension of Q unramiﬁed outside 3 is isomorphic to Z×
3 .
Since it has no factor groups of order 4, contradicting the fact that |Gab| = 4.
⊓⊔
Note that a similar result holds for all ρl,E, including l = 5.

390
7 Fermat's Last Theorem and Families of Modular Forms
Lemma 7.66 (J.-P. Serre, [Se95]). Let E be a semistable elliptic curve
over Q such that ρ3,E is irreducible, then the restriction
ρ0|GQ(√−3)
is absolutely irreducible.
Proof of Lemma 7.66: we use the fact that ρ3,E is odd, and one may assume
that Im(ρ3,E) ∋

1
0
0
−1

. Suppose that ρ0|GQ(√−3) is not absolutely irreducible,
and that there exists a subspace W ⊂E[3]⊗F3 invariant under GQ(√−3)◁GQ.
Then W τ is also GQ(√−3)-invariant, where τ is the image of the complex
conjugation, implying that
ρ0|GQ(√−3) ∼
8a
0
0
a
9
⊂GL2(F3) ⇒ρ0(GQ(√−3) is commutative.
But under the assumption of Lemma 7.66, ρ0 is surjective due to Proposition
7.65.
Therefore, Im(GQ(√−3)) in PGL2(F3) ∼= S4 is not commutative (since it is
a subgroup of S4 of index ≤2). This contradiction proves Lemma 7.66.
Theorem 7.63 becomes in this case the "Theorem on Absolute Irreducibil-
ity". In particular, the assumptions of Theorem 7.28 on modularity of admis-
sible deformations are satisﬁed for ρ3,E.
7.7.2 From p = 3 to p = 5
Let E be a semistable elliptic curve over Q. According to §7.7.1, only the
following three cases are possible:
(1) ρ0 = ρ3,E is irreducible;
(2) ρ0 = ρ5,E is irreducible;
(3) jE ∈
8
−25
2 , −52 · 2413
23
, −5 · 293
25
, 5 · 2113
215
9
.
It was noticed in Theorem 7.63 that in the exceptional case (3) E is modular.
As mentioned after Lemma 7.66, in Case (1) ρ3,E saﬁsﬁes the assumptions of
Theorem 7.28 on modularity of admissible deformations. Hence ρ3,E, being
an admissible deformation of ρ3,E, is modular. This implies the modularity of
E. Case (2) is covered by the following
Theorem 7.67 ([Se95]). Let E be a semistable elliptic curve over Q such
that ρ5,E is irreducible. Then there exists an elliptic curve E′ over Q such
that ρ5,E′ ∼ρ5,E and ρ3,E′ is absolutely irreducible.
Proof of the theorem is carried out in §7.7.3.

7.7 End of Wiles' Proof and Theorem on Absolute Irreducibility
391
Let us show how this implies Theorem 7.13: The same argument as in
Case (1) shows that the curve E′ is modular. Hence the representation ρ5,E′
is modular. However ρ5,E′ is equivalent to ρ5,E, hence ρ5,E is also modular.
Moreover, let us check that ρ5,E satisﬁes the assumptions of Theorem 7.28.
Knowing that ρ5,E is irreducible, we show that the restriction
ρ5,E|GQ(
√
5)
is absolutely irreducible.
Indeed, the complex conjugation τ ∈GQ(
√
5) satisﬁes
detρ5,E(τ) = −1 ⇒ρ5,E(τ) ∼
1
0
0
−1

.
Hence both eigenspaces of ρ5,E(τ) are deﬁned over F5, and the irreductibility
over F5 implies the absolute irreducibility (over F5).
It follows that the assumptions of Theorem 7.28 on modularity of admis-
sible deformations are satisﬁed for the representation ρ5,E.
This implies that the representation ρ5,E is modular because it is an ad-
missible deformation of ρ5,E. This means that the curve E is modular, proving
STW Conjecture also in this case (Theorem 7.13).
It remains to explain the proof of Theorem 7.67.
7.7.3 Families of elliptic curves with ﬁxed ρ5,E
We explain a construction of E′ ∈{Et} as a ﬁber of an elliptic ﬁbration
Et →P1
t over Q with ρ5,Et ∼ρ5,E for all t and such that E = Et0 for some
t0.
We again use a modular curve, but this time it is attached to the congru-
ence subgroup Γ(5) (see (6.3.15)). Let us use the modular parameterization
of the set of equivalence classes of elliptic curves, see §6.3.2, (6.3.13):
Γ(N)\H ←→
8
(E, φ)

an elliptic curve over C together with
an isomorphism φ : E[N]
∼
→(Z/NZ)2, φ∗det = eN,E′
9@
∼
(isom)
where
eN,E : E[N] ∧E[N] →µN
is the Weil pairing which is algebraically deﬁned by (6.3.31). Recall that over
C for E = C/⟨1, z⟩, one has
E[N] = ⟨1
N , z
N ⟩/⟨1, z⟩∼= (Z/NZ)2; eN,E = exp(±2πi(ad −bc)/N).
Moreover, the modular curve X(N) is an algebraic curve deﬁned over the
cyclotomic ﬁeld Q(ζN), ζN = exp(2πi/N) such that the Riemann surface
X(N)(C) is identiﬁed to the compact quotient Γ(N)\H in such a way that

392
7 Fermat's Last Theorem and Families of Modular Forms
X(N)(C) ←→Γ(N)\H, H = H ∪Q ∪∞;
Y (N)(C) ←→Γ(N)\H
for an aﬃne algebraic curve Y (N) deﬁned over Q(ζN) (see §6.4.2).
In order to work with curves deﬁned over Q let us ﬁx a curve E over Q
and consider the twisted curve XE over Q in such a way that it has an aﬃne
model YE over Q deﬁned via the following modular description:
YE(C) ←→
8
(E′, φ)

an elliptic curve over C together with
an isomorphism φ : E′[N]
∼
→E[N], φ∗eN,E = eN,E′
9@
∼
(isom).
This description gives the set of Q-rational points of YE:
YE(Q) ←→
8
(E′, φ)

an elliptic curve over Q with an isomorphism
of GQ-modules φ : E′[N]
∼
→E[N], φ∗eN,E = eN,E′
9@
∼
(isom).
Note that XE is isomorphic to X(N) over C (and even over Q(ζN)).
We are interested in the case N = 5. In this case we have the following
explicit description of the curve XE by K.Rubin and A. Silverberg (see in
[RubSil94] and in [CSS95]):
Proposition 7.68 ([Rub95], Proposition 11). Let E be an elliptic curve
over Q, and XE the curve over Q, obtained from X(5) by twist as above.
Then the genus of XE is equal to 0, and there is an explicit parameteriza-
tion:
ψ : P1 −→XE over Q with t →(Et, φt)
(7.7.1)
Et : y2 = x3 + fE(t)x + gE(t), fE, gE ∈Q[t],
(7.7.2)
and deg(fE) = 30, deg(gE) = 20.
Under this parameterization elements t ∈Q are in bijection with elements of
YE(Q).
Note that by this construction there is an isomorphism of GQ-modules φ :
E′[5]
∼
→E[5], in other words, for any t ∈Q, ρ5,Et ∼ρ5,Et.
In order to ﬁnish the proof of Theorem 7.67, we need to choose an element
E′ = Et in this family (t ∈Q) such that i) ρ3,Et is irreducible and ii) Et is
semistable.
7.7.4 The end of the proof
In order to obtain an irreducible ρ3,Et let us consider an auxiliary twisted
modular curve X′
E over Q, in such a way that it has an aﬃne model Y ′
E over
Q deﬁned via the following modular description:

7.7 End of Wiles' Proof and Theorem on Absolute Irreducibility
393
Y ′
E(C) ←→
8
(E′, φ, C3)

an elliptic curve over C together with
an isomorphism φ : E′[5]
∼
→E[5], φ∗e5,E = e5,E′, |C3| = 3
9
(isomorphism ∼)
This description gives the set of Q-rational points of Y ′
E:
Y ′
E(Q) ←→
8
(E′, φ, C3)
 E/Q, C3 ⊂E(Q)(GQ-submodule, |C3| = 3) with an isomorphism
of GQ-modules φ : E′[N]
∼
→E[N], φ∗eN,E = eN,E′
9
(isomorphism ∼)
Note that X′
E is isomorphic over C to the compact quotient
(Γ(5) ∩Γ0(3))\H.
The genus of X′
E can be computed with the classical techniques described in
Chapter I of Shimura's book [Shi71]; the answer is g(X′
E) = 9.
By the theorem of Faltings (see §5.5) Y ′
E(Q) is a ﬁnite set. Thus, for all
but ﬁnitely many t ∈Q the representation ρ3,Et is irreducible.
Concerning semistability, let us observe that:
- for any l ̸= 5 we have
ρ5,Et|Il ∼ρ5,E|Il ∼
81
0
∗
1
9
.
This directly implies the semistability for such l, using the algebraic deﬁ-
nition of semistability.
- for l = 5, the semistability at 5 follows from the explicit equation (7.7.1)
of the curves, via the geometric deﬁnition 7.10 of semistability: if t tends
to t0 in the 5-adic topology, then the coeﬃcients of the minimal (5-adic)
equations of Et converge in the 5-adic topology to the coeﬃcients of the
minimal (5-adic) equation of E = Et0. Thus Et becomes semistabe at 5
for all t ∈Q suﬃciently close to t0.
The most important insights.
Here is how they were described by Wiles himself in the introduction to his
paper [Wi]:
- the discovery in the spring 1991 of the invariants ηA (known at that time
as "congruence modules" of Hida in the case of p-adic Hecke algebras);
- the switch from p = 3 to p = 5 (found in May 1993);
- the use of the horizontal Iwasawa theory (J-structures) in September 1994.
An interesting account on the history of this subject is given in [Mozz].

Part III
Analogies and Visions

III-0
Introductory survey to part III: motivations and
description
III.1 Analogies and diﬀerences between numbers and
functions: ∞-point, Archimedean properties etc.
This part was conceived as an explanation of some basic intuitive ideas that
underlie modern number-theoretical thinking. One subject could have been
called Analogies between numbers and functions.
III.1.1 Cauchy residue formula and the product formula
Let us explain the analogy between a number ﬁeld, i.e., a ﬁnite extension of
Q, and the ﬁeld C(S) of meromorphic functions on a smooth complete curve
S, following [SABK94], p.3.
An example of this analogy is given by the Cauchy residue formula,

x∈S
vx(f) =

x∈S
Resx(df
f ) = 0,
(III.1.1)
where Resx denotes the residue at x of diﬀerential forms.
When f ∈Q∗is a rational number we have the product formula
|f| =

p
pvp(f)
(III.1.2)
where p runs over all integral primes and vp(f) ∈Z is the p-adic valuation of
f.
If we deﬁne
v∞(f) = −log |f| ∈R,
we may rewrite the equality (III.1.2) as

p
vp(f) log(p) + v∞(f) = 0,
(III.1.3)

398
III-0
Introductory survey to part III: motivations and description
an analog for Q of equation (III.1.1) for the ﬁeld C(S). One can see from this
example that, in this analogy, the complete curve in S is analogous to the
aﬃne scheme Spec(Z) to which is added a point at inﬁnity (at this point the
Archimedean norm is used instead of discrete valuations).
III.1.2 Arithmetic varieties
In general, let X be an arithmetic variety. By this we mean a regular scheme,
projective and ﬂat over Z.
In other words, we consider a system of polynomial equations
f1(T0, · · · , TN) = f2(T0, · · · , TN) = · · · = fm(T0, · · · , TN) = 0
(III.1.4)
where f1, · · · , fm ∈Z[T0, · · · , TN] are homogeneous polynomials with inte-
gral coeﬃcients. These deﬁne the projective scheme X = Proj(S), where S
is the quotient of Z[T0, · · · , TN] by the ideal, generated by f1, · · · , fm. The
points of X are those homogeneous prime ideal P in S which do not con-
tain the augmentation ideal. The structure morphism f : X →SpecZ maps
P to P ∩Z. The ﬁber of f over a prime integer (special ﬁber) is the variety
f −1(pZ) = X/p = Proj(S/pS) over the ﬁeld with p elements. The generic ﬁber
is f −1((0)) = XQ = Proj(S ⊗Z Q). We assume that X is regular and that f
is ﬂat, i.e. S is torsion free. It follows that X/p is smooth, except for ﬁnitely
many values of p, like q in Fig.III-0.1, where it may not even be reduced.
In the same way that we completed SpecZ by adding a point ∞to it, we
"complete" the family X of varieties over SpecZ by adding to it the complex
variety X∞= X(C), i.e. the set of complex solutions of (III.1.4), viewed as
the ﬁber at inﬁnity. We think of the whole familly as analogous to a complex
manifold Y ﬁbered over a smooth complete curve S via a ﬂat proper map
f : Y →S. If the ﬁbers of f have dimension one, X has Krull dimension two
(we call it an arithmetic surface). Notice that an integral solution of (III.1.4)
is a rational point on X(Z) = X(Q) ⊂X(C), i.e. a section of f.
III.1.3 Inﬁnitesimal neighborhoods of ﬁbers
One can also consider reductions of X (deﬁned over Z) modulo pn for some
prime p. The limit as n →∞deﬁnes a p-adic completion of XZ. This can be
thought as an "inﬁnitesimal neiborhood" of the ﬁber at p.
The picture is more complicated at arithmetic inﬁnity, since one does not
have a suitable notion of "reduction modulo ∞" available to deﬁne the closed
ﬁber. On the other hand, one does not have an analogue of the p-adic com-
pletion at hand. This is given by the Riemann surface (smooth projective
algebraic curve over C) determined by the equation of the algebraic curve
over Q, under the embedding Q ⊂C,
X(C) = X ⊗Q Spec(C),
with the absolute value |·| at the inﬁnite prime replacing the p-adic valuation.

III.2 Arakelov geometry, ﬁber over ∞, cycles, Green functions
399
III.2 Arakelov geometry, ﬁber over ∞, cycles, Green
functions (d'après Gillet-Soulé)
In order to control the size of the rational points P , S.Yu.Arakelov (cf.
[Ara74a]) had the brilliant idea of considering Hermitian metrizations of var-
ious linear objects related to algebraic varieties (invertible sheaves, tangent
bundles etc.). Let us take an algebraic vector bundle E on X, endowed with a
smooth Hermitian metric h on the corresponding holomorphic vector bundle
E∞on X∞). The pair E = (E, h) will be called a Hermitian vector bundle on
X. This gives a method to compactify arithmetic schemes over number ﬁelds
at the arithmetical inﬁnity.
According to Arakelov's program [Ara74a], [Ara74b], to an algebraic vari-
ety X over a number ﬁeld K one can attach a completed arithmetical variety
X of the dimension dim(X) + 1,
X →SpecOK = SpecOK ∪{∞1, · · · , ∞r},
where OK is the maximal order of K, {∞1, · · · , ∞r} the set of all places at
∞of K (see [GS92], [SABK94], [La88]).
For an algebraic number ﬁeld K of degree n = [K : Q] admitting n =
r1 + 2r2 embeddings
α : K →C,
(III.2.1)
there is r = r1 + r2 Archimedean primes, with r1 real embeddings and r2
paires of complex conjugate embeddings.
When
SpecOK
is
compactiﬁed
by
adding
Archimedean
primes
{∞1, · · · , ∞r}, one also obtains n complex varieties Xα(C), obtained from
the embeddings α : K →C. Of these complex varieties, r1 carry a real invo-
lution.
In particular, each curve has a well deﬁned minimal model over O which
is called an arithmetical surface (since we added an arithmetical dimension
to the geometric one). Adding metrics at inﬁnity to this, Arakelov developed
the intersection theory of arithmetical divisors. Heights in this picture become
the (exponentiated) intersection index, see [Ara74b], [La88]
This theory was vastly generalized by H.Gillet and C.Soulé [GS91], [GS92],
[SABK94], following some suggestions in [Man84]. The Figure III-0.1 which
is reproduced here from [SABK94] with a kind permission of Ch.Soulé, is a
visualization of an arithmetical surface.
Its ﬁbers over the closed points of Spec(O) can be non-singular ("non-
degenerate", or with "good reduction") or singular (having "bad reduction").
Rational points of the generic ﬁber correspond to the horizontal arithmetical
divisors; there are also vertical divisors (components of closed ﬁbers) and
"vertical divisors at inﬁnity" added formally, together with an ad hoc deﬁnition
of their intersection indices with other divisors deﬁned via Green's function,
see [SABK94].

400
III-0
Introductory survey to part III: motivations and description
Fig. III-0.1. An arithmetic surface.
Arakelov's picture played a prominent role in Faltings' proof and the sub-
sequent development of his work.
The Figure III-0.1 which is reproduced here from [SABK94] with a kind
permission of Ch.Soulé and Cambridge University Press, is a visualization of
an arithmetic surface.
III.2.1 Arithmetic Chow groups
Let X be an arithmetic variety and E a Hermitian vector bundle on X. One
can attach to E characteristic classes with values in arithmetic Chow groups.
More speciﬁcally, an arithmetic cycle is a pair (Z, g) consisting of an al-
gebraic cycle over X, i.e. a ﬁnite sum 
α nαZα, nα ∈Z, where Zα is a
closed irreducible subscheme of X, of ﬁxed codimension p, and a Green cur-
rent g for Z. By this we mean that g is a real current on X∞which satisﬁes
F ∗
∞(g) = (−1)p−1g and
d dcg + δZ = ω,
(III.2.2)
where ω is the current attached to a smooth form on X∞, and δZ is the current
given by integration on Z∞:
δZ(η) =

α
nα

Zα(C)
η,
(III.2.3)
for any smooth form η of appropriate degree (here F ∗
∞denotes the morphism,
induced by the complex conjugation F∞on X∞).

III.2 Arakelov geometry, ﬁber over ∞, cycles, Green functions
401
The arithmetic Chow group A
CH
p(X) is the Abelian group of arith-
metic cycles, modulo the subgroup, generated by pares (0, ∂u + ∂v) and
(divf, −log |f|2), where u and v are arbitrary currents of the appropriate
degree and divf is the divisor of a non-zero rational function f on some irre-
ducible closed subscheme of codimension p −1 in X.
III.2.2 Arithmetic intersection theory and arithmetic
Riemann-Roch theorem
The important fact that the arithmetic Chow groups A
CH
p(X) have fonctorial
properties, is studied in [SABK94].
Given two arithmetic cycles (Z, g) and (Z′, g′), we need a Green current
for their intersection. The formula
g′′ = ωg′ + gδZ′
where ω is deﬁned as in (III.2.2), involves a product of two currents gδZ′. To
make sense of it in general we need to show that one can take for g a smooth
form on X∞−Z∞of logarithmic type along Z∞.
Then one can deﬁne characteristic classes for Hermitian vector bundles E
on X, in particular, a Chern character class
B
ch(E) ∈
0
≥0
A
CH
p(X) ⊗Q.
(III.2.4)
This class satisﬁes the usual axiomatic properties of a Chern character, but it
depends on the choice of a metric on E. It is additive only on orthogonal direct
sums, but in general its failure to be additive on exact sequences is given by
the secondary characteristic class of Bott-Chern. Similar results hold for the
Todd class B
Td(E) (cf. Chapter IV of [SABK94]). The arithmetic Riemann-
Roch theorem is formulated in terms of these classes, for a proper ﬂat map
f : X →Y , as a formula for the ﬁrst arithmetic Chern class for the direct
image map on Hermitian vector bundles.
Main application of this result gives an asymptotic behaviour of the type
h0(X, E ⊗L
n) ≥rk(E)
(d + 1)!L
d+1nd+1 + O(nd log n)
(III.2.5)
for an ample L with a positive metric, where h0(X, E ⊗L
n) is the logarithm
of the number of global sections s ∈H0(X, E ⊗Ln) such that ∥x∥≤1 for
every x ∈X∞, and L
d+1 ∈R denotes the arithmetic self-intersection.
The arithmetic Riemann-Roch theorem was discussed in [Fal92]; it was ex-
plained that the Hirzebruch-Riemann-Roch theorem (HRR) gives a formula
for χ(E), E →X an algebraic vector bundle over an algebraic manifold X,
in terms of characteristic classes of X and E : χ(E) = [Td(X) · ch(E)]dim X.
The Grothendieck-Riemann-Roch (GRR) theorem, a relative version, states

402
III-0
Introductory survey to part III: motivations and description
that for an algebraic morphism f : X →Y and an algebraic vector bun-
dle E on X, one has an equality of mixed cohomology classes: ch(f∗E) =
f∗(Td(X|Y )·ch(E)), and contains HRR as a special case where Y = point.
The proof of HRR is by means of elliptic diﬀerential operators and analytic
methods or cobordism. The proof of GRR, on the other hand, is easier and
more algebraic.
This proof was carried in [Fal92] over to the arithmetic case.
The data for the arithmetic case are as follows: f : X →Y is a morphism
of arithmetic varieties, both of which are deﬁned over a common arithmetic
variety B (such as Spec(Ok)), *E an arithmetic vector bundle on X. One
needs the following objects: (1) *K(X), equivalence classes of *E's, (2) *A∗(X),
the arithmetic Chow ring, (3) *ch: *K(X) →*A∗(X), (4) f∗: *K(X) →*K(Y ),
the arithmetic push forward, (5) a class B
TdR(X|Y ) ∈*A∗(X), and (6) an
intersection product in *A∗(X). Then the arithmetic Riemann-Roch theorem
(ARR) states: *ch(f∗*E) = f∗(B
TdR(X|Y )· *ch( *E)) in *A(Y ) for *E ∈*K(X). The
HRR case of this is now Y = B = Spec(OK), and for surfaces (XK a curve),
the component in degree 2 yields the RR for arithmetic surfaces by G. Falt-
ings in [Fal84] the ﬁrst case for which ARR was proven. Here the method
was construction of volume forms on the cohomology. Following Faltings' in-
troduction, this led to new interest in this topic, and soon there was rapid
progress: Deligne generalised the volume form to more cases, and Gillet and
Soulé developed an arithmetic intersection theory for general varieties, as well
as Hermitian K-theory. Then they joined eﬀorts with Bismut and managed to
deﬁne the determinant of cohomology of an arithmetic variety, cf. [BiGS88].
One could then ask for a RR result on this determinant. It turned out that
even for the projective space the immediate generalisation of the classical RR
was false. To remedy this they introduced a secondary class R(x) so that a
modiﬁed version (using R) remains true. Bismut and Lebeau could prove a
RR result for closed immersions, from which the RR for determinant bundles
follows with some more work, see in [SABK94].
The theory of intersections and arithmetic Riemann-Roch theorem were
discussed also in a Bourbaki talk [Bo90] by J.-B. Bost (see also [BoCo95] ).
III.2.3 Geometric description of the closed ﬁbers at inﬁnity
A general picture of an arithmetic surface over Spec(OK) is as follows:
Xp →XSpec(OK) →XSpec(OK) ← ???
⏐5
⏐5
⏐5
⏐5
p →Spec(OK) →Spec(OK) ← α
where we do not have an explicit geometric description of the closed ﬁbers
over the Archimedean primes.

III.2 Arakelov geometry, ﬁber over ∞, cycles, Green functions
403
Formally one can enlarge the group of divisors on the arithmetic surface
by adding formal real linear combinations of irreducible "closed vertical ﬁbers
at inﬁnity" 
α λαFα. Here the ﬁbers Fα are only treated as formal symbols,
and no geometric model of such ﬁbers is provided. The remarkable fact is that
Hermitian geometry on the complex varieties Xα(C) is suﬃcient to specify the
contribution of such divisors to intersection theory on the arithmetical surface,
even without an explicit knowledge of the closed ﬁber.
The main idea of the Arakelov geometry is that it is suﬃcient to work
with the "inﬁnitesimal neighborhood" Xα(C) of the ﬁbers Fα, to have well
deﬁned intersection indices.
From the point of view of the classical geometry of generations of algebraic
curves over a disk ∆with a special ﬁbrer over 0, the analogous statement
would say that the geometry of the special ﬁber is completely determined by
the generic ﬁber (cf. [Mar04], §3 of Chapter 3). This would be a very strong
statement on the form of the degeneration: for instance blowing up points on
the special ﬁber is not seen by just looking at the generic ﬁber. Investigating
this analogy leads one to expect that the ﬁber at inﬁnity should behave like
in the totally degenerate case, cf. a discussion in §8.2.3. This is the case where
one has maximal degeneration, where all the components of the closed ﬁber
are P1's and the geometry of the degeneration is completely encoded by the
dual graph, which describes in a purely combinatorial way how these P1's are
joined. The dual graph has a vertex for each component of the closed ﬁber
and an edge for each double point.
For an arithmetic surface (dim X = 1), the local intersection multiplicities
of two ﬁnite, horizontal, irreducible divisors D1 and D2 on XOK is given by
[D1, D2] = [D1, D2]fin + [D1, D2]inf,
where the ﬁrst term counts the contribution from the ﬁnite places (i.e. what
happens over Spec(OK)), and the second term is the contribution of the
Archimedean primes, i.e. the part of the intersection that happens over arith-
metic inﬁnity.
While the ﬁrst term is computed in algebro geometric terms, from the
local equations for the divisors Di at P, the second term is deﬁned as a sum
of values of Green functions gα on the Riemann surfaces Xα(C),
[D1, D2]inf = −

α
εα
⎛
⎝
β,γ
gα(P α
1,β, P α
2,γ)
⎞
⎠,
at points
{P α
i,β | β = 1, . . . , [K(Di) : K]} ⊂Xα(C),
for a ﬁnite extension K(Di) of K, determined by Di. Here εα = 1 for real
embeddings and =2 for complex embeddings (see [CS86], [GS92], [SABK94],
[La88] for a detailed account of these notions of Arkelov geometry).

404
III-0
Introductory survey to part III: motivations and description
Further evidence for the similarity between the Archimedean and the to-
tally degenerate ﬁbers came from an explicite computation of the Green func-
tion at the Archmedean places derived in [Man91] in terms of a Schottky
uniformization of the Riemann surface Xα(C), which is discussed in more
detail in §8.1. Such uniformization has an analogue at a ﬁnite prime, in
terms of p-adic Schottky groups, only in the totally degenerate case. Another
sourse of evidence comes from a cohomological theory of the local factors at
Archimedean primes, developed by K.Consani in [Cons98], valid for any arith-
metic variety, see also §8.2 for more details. This general construction shows
that the resulting description of the local factor as regularized determinant at
the Archimedean primes resembles mostly the case of the totally degenerate
reduction at a ﬁnite prime.
One can present both results in the light of the noncommutative space
given by a spectral triple (OA, H, D) discussed in §8.3, where the data
(OA, H, D) consist of a C∗-algebra OA (or more generally of a smooth sub-
algebra of a C∗-algebra) with a representation as bounded operators on a
Hilbert space H and an operator D on H that veriﬁes the main properties
of a classical Dirac operator D (a square root of the Laplacian) on a smooth
spin manifold.
III.3 Theory of ζ-functions, local factors at ∞, Serre's
Γ -factors; and generally an interpretation of zeta
functions as determinants of the arithmetical Frobenius:
Deninger's program
(cf. [Se70a], [Den94], [Den01], [Lei03], and §7, Ch.3 of [Mar04]).
An important invariant of arithmetic varieties is the L-function. This
is written as a product of contributions from the ﬁnite primes and the
Archimedean primes,

p∈SpecOK
Lp(Hm(X), s),
(III.3.1)
see §6.2.7. The reason why one needs to include the contribution of the
Archimedean primes can be seen in the case of the "aﬃne line" Spec(Z), where
one has the Riemann zeta-function, which is written as the Euler product
ζ(s) =

p
(1 −p−s)−1.
(III.3.2)
However to have a nice functional equation, one needs to consider the product
ˆζ(s) = ζ(s)Γ(s/2)π−s/2,
(III.3.3)
which includes a contribution of the Archimedean prime, expressed in terms
of the Gamma function.

III.3 ζ-functions, local factors at ∞, Serre's Γ-factors
405
An analogy with algebraic geometry and Weil's conjectures (see §6.1.3)
suggest to think of the functional equation as a sort of "Poincaré duality"
which holds for a compact manifold, hence the need to "compactify" by adding
the Archimedean primes (and the Archimedean ﬁbers of arithmetic varieties).
When one looks at an arithmetic variety over a ﬁnite prime p ∈Spec(OK),
the fact that the reduction lives over a residue ﬁeld of positive characteristic
implies that there is a special operator, the geometric Frobenius Fr∗
p acting on
a suitable cohomology theory (étale cohomology), induced by the Frobenius
automorphism φp of Gal(Fp/Fp).
The local L-factors of (III.3.1) at ﬁnite primes encodes the action of the
geometric Frobenius in the form
Lp(Hm(X), s) = det

1 −Fr∗
pN(p)−s|Hm(X, Ql)Ip−1 .
(III.3.4)
Here we are considering the action of the geometric Frobenius Fr∗
p on the in-
ertia invariants Hm(X, Ql)Ip of the étale cohomology and a precise deﬁnition
of these arithmetic structures is beyond our purpose. We wish to describe
the contribution of the Archimedean primes to the product (III.3.1) by giving
some quick heuristic explanation of (III.3.4).
For X a smooth projective variety (in any dimension) deﬁned over Q, the
notation X := X ⊗Spec(Q) is used. One can write the local L factor (III.3.4)
equivalently as
Lp(Hm(X), s) =

λ∈Spec(Fr∗
p)

1 −λq−s−dim Hm(X,Ql)
Ip
λ ,
(III.3.5)
where Hm(X, Ql)Ip
λ
is the (generalized) eigenspace of the Frobenius with
eigenvalue λ.
An important conclusion is that the local L-factor in (III.3.5) depends
upon the data
(H∗(X, Ql)Ip, Fr∗
p)
(III.3.6)
of a vector space, which has a cohomological interpretation, together with a
linear operator acting upon it.
III.3.1 Archimedean L-factors
Since the étale cohomology satisﬁes the compatibility isomorphism with the
singular (Betti) cohomology:
Hi(X, Ql) ∼= Hi(X(C), Q) ⊗Ql,
(III.3.7)
this indicates that one can work with the smooth complex manifold X(C)
and gain information on the "closed ﬁber" at arithmetic inﬁnity, and expect
that the contribution of the Archimedean primes to the L-function may be

406
III-0
Introductory survey to part III: motivations and description
expressed in terms of the cohomology Hi(X(C), Q) (or in terms of the de
Rham cohomology with complex coeﬃcients).
Let us recall that the expected contribution of the Archimedean primes
(cf. [Se70a]) is determined by Γ-factors attached to the Hodge structure
Hm(X(C)) =
⊕
p+q=m Hp,q(X(C)).
Namely, one has the following product of Gamma functions
L(H, s) =
(III.3.8)
⎧
⎪
⎨
⎪
⎩

p,q ΓC(s −min(p, q))hp,q

p<q ΓC(s −p)hp,q 
p ΓR(s −p)hp,+ΓR(s −p + 1)hp,−
where H = Hm(X(C)), s ∈C, hp,q = dimC Hp,q and hp,± is the dimension
of the ±(−1)p-eigenspace of the C-linear involution F∞on H. Recall that by
deﬁnition 6.2.4,
ΓC(s) = (2π)−sΓ(s),
ΓR(s) = 2−1
2 π−s
2 Γ(s
2),
where
Γ(s) =
 ∞
0
e−tts dt
t .
Let us try to seek a uniﬁed picture of what happens at the ﬁnite and at the
inﬁnite primes. In particular, these should be a suitable reformulation of the
local factors (III.3.4) and (III.3.8) where both formulae can be expressed in
the same way.
III.3.2 Deninger's formulae
Deninger in [Den91], [Den92] and [Den94] expressed both local factors (III.3.4)
and (III.3.8) as certain inﬁnite determinants.
Recall that the Ray-Singer determinant of an operator T with pure point
spectrum with ﬁnite multiplicities {mλ}λ∈Spec(T ) is deﬁned as
det
∞(s −T) := exp

−d
dz ζT (s, z)|z=0

(III.3.9)
where the zeta function of T is deﬁned as
ζT (s, z) =

λ∈Spec(T )
mλ(s −λ)−z.
(III.3.10)
Suitable conditions for the convergence of this expressions in the case of the
local factors are described in [Man95]. Ch. Deninger showed that (III.3.4) can
be written equivalently in the form

III.4 A guess that the missing geometric objects are noncommutative spaces
407
Lp(Hm(X), s)−1 = det
∞(s −Θq) ,
(III.3.11)
for an operator with spectrum
Spec(s −Θq) =
(III.3.12)
8 2πi
log q
log q
2πi (s −αλ) + n

: n ∈Z, λ ∈Spec(T)
9
,
with multiplicities dλ and with qαλ = λ.
Moreover, the local factor (III.3.8) at inﬁnity can be written similarly in
the form
L(Hm(X), s)−1 = det
∞
 1
2π (s −Φ)|Hm

,
(III.3.13)
where Hm is an inﬁnite dimensional vector space and Φ is a linear operator
with spectrum Spec(Φ) = Z and ﬁnite multiplicities. This operator is regarded
as a "logarithm of Frobenius" at arithmetic inﬁnity.
Given Deninger's formulae (III.3.12) and (III.3.13), it is natural to ask for
a cohomological interpretation of the data
(Hm, Φ),
(III.3.14)
somewhat analogous to the non-Archimedean data (III.3.6).
III.4 A guess that the missing geometric objects are
noncommutative spaces
We shall see that cohomological interpretation of the above data (Hm, Φ) in
(III.3.14) leads to the notions of a spectral triple and a noncommutative space,
see §8.2.
III.4.1 Types and examples of noncommutative spaces, and how to
work with them. Noncommutative geometry and arithmetic
Let us follow Chapter 1 of [Mar04], and recall some basic notions of Noncom-
mutative geometry, developed by Connes, cf. [Co94], [Co2000], which extends
the tools of ordinary geometry to treat spaces that are quotients, for which
the usual "ring of functions" (i.e. functions invariant with respect to the equiv-
alence relation) is too small to capture the information on the "inner struc-
ture" of points in the quotient space. Typically, for such spaces functions on
the quotients are just constants, while a non-trivial ring of functions, which
remembers the structure of the equivalence relation, can be deﬁned using a
noncommutative algebra of coordinates, analogous to the noncommutative
variables of quantum mechanics.

408
III-0
Introductory survey to part III: motivations and description
Following A.Connes (cf. [Co94], p.85) let us give a simplest example of a
noncommutative quotient space, and consider the set Y = {a, b} consisting of
two elements a and b, so that the algebra C(Y ) of complex-valued functions
on Y is the commutative algebra C ⊕C of 2 × 2 diagonal matrices. There are
two ways of declaring that the two points a and b of Y are identical under an
equivalence relation a ∼b:
1) The ﬁrst method is to consider the subalgebra A ⊂C(Y ) of functions on
Y which take the same value at a and b: f(a) = f(b).
2) The second method is to consider a larger algebra B ⊃C(Y ) of all 2 × 2
matrices:
faa
fba
fab
fbb

(these are functions on the graph of the equivalence relation).
The relation between the two algebras is given by the notion of strong
Morita equivalence of C∗-algebras (cf. [Rief76]). This relation which resembles
the Brauer equivalence (see §4.5.5) preserves many invariants of C∗-algebras,
such as K-theory and the topology of the space of irreducible representations.
One can interpret then
ωa = faa, ωb = fbb
as pure states of B in the sense of quantum mechanics, which yield equivalent
irreducible representations of B = M2(C).
Note that if a and b are not equivalent, one obtains by the second method
only the algebra of diagonal matrices, because the graph of the equivalence
relation consists then just of (a, a) and (b, b).
Let us describe another simple example (cf. [Co94], p.87, and [Mar04], §2
of Ch.1), in which the above two algebraic operations of quotient 1) and 2)
yield obviously diﬀerent (even not strongly Morita equivalent) algebras.
Take the topological space Y = [0, 1]×{0, 1} with the equivalence relation
R : (x, 0) ∼(x, 1) for x ∈(0, 1), and let X = Y/R be the (non-Hausdorﬀ)
quotient space. That is, Y = I1 ∪I2 is the disjoint union of two copies I1 and
I2 of the interval [0, 1], and the quotient space X = Y/R is obtained by gluing
the two interiors of the intervals I1 and I2 but not the end points.
By the ﬁrst method take continuos functions f on Y , invariant with respect
to the equivalence relation, this is the algebra A = C([0, 1]), which is homo-
topic to C, and K0(A) = Z. By the second method let us consider functions
on the graph of the equivalence relation, then one obtains the algebra
B = {f ∈C([0, 1]) ⊗M2(C) | f(0) and f(1) are diagonal }
which is an interesting nontrivial algebra (we view a generic element x ∈
M2(C([0, 1])) as a continous map t →x(t) ∈M2(C)). Note that the space of
irreducible representations of B is X = Y/R, and the K theory of B is much
less trivial than that of A = C([0, 1]).
In general, such "quantum spaces" are deﬁned by extending the Gelfand-
Naimark correspondence

III.4 A guess that the missing geometric objects are noncommutative spaces
409
X loc. compact Haussdorf space ⇐⇒C0(X) Abelian C∗-algebra
by dropping the commutativity hypothesis in the right hand side. The cor-
respondence then becomes a deﬁnition of what's on the left hand side: a
noncommutative space.
The idea of preserving the information on the structure of the equivalence
relation in the description of quotient spaces has analogues in Grothendieck's
theory of stalks in algebraic geometry. Such quotients arise from foliations,
and, more recently, in number theory and in arithmetic geometry, starting
from [BoCo95], where a noncommutative space related to class ﬁeld theory is
constructed. This space, viewed as the space of 1-dimensional Q-lattices up
to commensurability, relates the phenomena of spontaneous symmetry break-
ing in quantum statistical mechanics to the mathematics of Galois theory. A
similar noncommutative space was used in [Co2000a] and [Co99] to obtain a
spectral realization of the zeroes of the Riemann zeta function. Some other
recent examples (cf. [CoMo04] , [CoMo04a]) interpret diﬀerential operators
on modular forms (Rankin-Cohen brackets) in terms of the Hopf algebra of
a noncommutative space of codimension one foliations. It turns out that the
modular Hecke algebra appears as the "holomorphic part" of the algebra of a
certain noncommutative space (cf. [CoMar04]).
Let us only mention the noncommutative elliptic curves, and noncommu-
tative modular curves cf. op.cit.
We add to this list other interesting examples coming from the construction
in [Man91], giving a description of the totally degenerate ﬁbers at "arithmetic
inﬁnity" of arithmetic varieties over number ﬁelds, cf. [CM]. We describe in
Chapter 8, how Connes theory gives a link of this construction with Deninger's
approach [Den91], who suggested to reinterpret Serre's gamma-factors of zeta-
functions as inﬁnite regularized determinants of certain ∞-adic Frobenius
maps acting upon new cohomological spaces. These spaces are described in
§8.2.
Isomorphism of noncommutative spaces and Morita equivalence
In noncommutative geometry, isomorphisms of C∗-algebras are too resrictive
to provide a good notion of isomorphism of noncommutative spaces, and the
correct notion is provided by Morita equivalence of C∗-algebras (cf. [Man02a],
§1.3):
Deﬁnition III-0.1 (Morita category). Let A, B be two associative rings. A
Morita morphism A →B by deﬁnition, is the isomorphism class of a bimodule
AMB, which is projective and ﬁnitely generated separately as module over A
and B.
The composition of morphisms is given by the tensor product AMB⊗BM ′
C,
or AM ⊗BM ′
C for short.
If we associate to AMB the functor

410
III-0
Introductory survey to part III: motivations and description
ModA →ModB : NA →N ⊗A MB,
the composition of functors will be given by the tensor product, and isomor-
phisms of functors will correspond to the isomorphisms of bimodules.
We imagine an object A of the (opposite) Morita category as a noncom-
mutative space, right A-modules as sheaves on this space, and the tensor
multiplication by AMB as the pull-back functor. We have chosen to work
with right modules, but passing to the opposite rings allows one to reverse
left and right in all our statements.
Two bimodules AMB and BNA supplied with two bimodule isomorphisms
AM ⊗B NA →AAA and BN ⊗A MB →BBB deﬁne mutually inverse Morita
isomorphisms (equivalences) between A and B. The basic example of this kind
is furnished by B = Mat (n, A), M = AAnB and N = BAnA.
We will now brieﬂy summarize Morita's theory.
(A) Characterization of functors S : ModA →ModB of the form NA →
N ⊗AMB. They are precisely functors satisfying any of the two equivalent
conditions:
(i) S is right exact and preserves direct sums.
(ii) S admits a right adjoint functor T : ModB →ModA (which is then
naturally isomorphic to HomB(MB, ∗)).
We will call such functors continuous.
(B) Characterization of continuous functors S such that T is also continuous
and ST ∼= 1. Let S be given by AMB and T by BNA. Then M ⊗B N ∼=
AAA. Moreover, in this case
(iii) MB and BN are projective.
(iv) AM and NA are generators.
In particular, equivalences ModA →ModB are automatically continuous.
Hence any pair of mutually quasi-inverse equivalences must be given by
a couple of biprojective bigenerators as above.
(C) Finite generation and balance. Any right module MB can be considered
as a bimodule AMB where A = B′ := EndB(MB). We can then similarly
produce the ring B′′ = A′ := EndA(AM). Module MB is called balanced if
B′′ = B. Similarly, one can start with a left module. With this notation,
we have:
(v) MB is a generator iﬀB′M is balanced and ﬁnitely generated projective.
Properties (i)-(v) can serve as a motivation for our deﬁnition of the Morita
category above.
The tools of noncommutative geometry
The following is a list of some techniques used in order to compute invariants
and extract essential information from the geometry.

III.4 A guess that the missing geometric objects are noncommutative spaces
411
- Topological invariants: K-theory
- Hochshild and cyclic cohomology
- Homotopy quotients, assembly map (Baum-Connes)
- Metric structure: Dirac operator, spectral triples
- Characteristic classes, zeta functions
We recall some of these notions in Part III, starting with Dirac operator
and spectral triples.
In noncommutative geometry, the notion of a spectral triple provides the
correct generalization of the classical structure of a Riemannian manifold. The
two notions agree on a commutative space. In the usual context of Riemannian
geometry, the deﬁnition of the inﬁnitesimal element ds on a smooth spin man-
ifold can be expressed in terms of the inverse of the classical Dirac operator
D. This is the key remark that motivates the theory of spectral triples. In
particular, the geodesic distance between two points on the manifold is de-
ﬁned in terms of D−1 (cf. [Co94] §VI). The spectral triple that describes a
classical Riemannian spin manifold is (A, H, D), where A is the algebra of
complex valued smooth functions on the manifold, H is the Hilbert space
of square integrable spinor sections, and D is the classical Dirac operator (a
square root of the Laplacian). These data determine completely and uniquely
the Riemannian geometry on the manifold.
The notion of spectral triple extends to more general noncommutative
spaces, where the data (A, H, D) consist of a C∗-algebra A (or more generally
of a smooth subalgebra of a C∗-algebra) with a representation as bounded
operators on a Hilbert space H, and an operator D on H that veriﬁes the
main properties of a Dirac operator.
III.4.2 Generalities on spectral triples
Let us recall the basic setting of Connes theory of spectral triples. For a more
complete treatment we refer to [Co95], [Co94], [CoMo95].
Deﬁnition III-0.2. A spectral triple (A, H, D) consists of an involutive alge-
bra A with a representation
ρ : A →B(H)
as bounded operators on a Hilbert space H, and an operator D (called the
Dirac operator) on H, which satisﬁes the following properties:
1. D is self-adjoint.
2. For all λ /∈R, the resolvent (D −λ)−1 is a compact operator on H.
3. For all a ∈A, the commutator [D, a] is a bounded operator on H.

412
III-0
Introductory survey to part III: motivations and description
Remark III-0.3. The property 2. of Deﬁnition III.1.1 generalizes ellipticity of
the standard Dirac operator on a compact manifold. Usually, the involutive
algebra A satisfying property 3. can be chosen to be a dense subalgebra of a
C∗-algebra. This is the case, for instance, when we consider smooth functions
on a manifold as a subalgebra of the commutative C∗-algebra of continuous
functions. In the classical case of Riemannian manifolds, property 3. is equiv-
alent the Lipschitz condition, hence it is satisﬁed by a larger class than that
of smooth functions.
III.4.3 Contents of Part III: description of parts of this program
We included under the heading of this part various recent topics related to
Arakelov's geometry, and Noncommutative geometry. All these topics use a
lot of algebraic tools such as cohomology groups and non-commutative rings.
We start Chapter 8 with §8.1 on Schottky uniformization and Arakelov
geometry, based on geometric constructions in [Man91]. We give an ana-
lytic construction of degenerating curves over complete local ﬁelds, following
[Mum72], in §8.1.2. Then in §8.1.5 we describe the result in [Man91] on the
relation between the Arakelov Green function on a Riemann surface X(C)
with Schottky uniformization and geodesics in the 3-dimensional hyperbolic
handlebody XΓ .
Following [CM], we describe in this chapter, how Connes theory gives a
link of theses constructions with Deninger's approach [Den91], who suggested
to reinterpret Serre's gamma-factors of zeta-functions as inﬁnite regularized
determinants of certain ∞-adic Frobenius maps acting upon two types of
cohomology spaces. Archimedean cohomology spaces are described in §8.2,
and dynamical cohomology spaces are described in §8.3.
In §8.2 we describe a cohomological theory for the Archimedean ﬁber of
an Arakelov surface. This results are based on the general theory, valid for
any arithmetic variety, developed in [Cons98] (we follow an interesting dis-
cussion of the Archimedean cohomology in [CM04b] and [Mar04], Chapter 3).
This construction provides a reﬁnement for the Archimedean cohomology H∗
ar
introduced by Deninger in [Den91].
Based on this construction and following [CM], we describe in §8.2.2 a
cohomological spectral data (A, H·(X∗), Φ), where the algebra (A is obtained
from the SL(2, R) action on certain cohomology groups.
In Theorem 8.3 we describe how to recover the alternating product of
the Archimedean factors from a zeta function of a spectral triple. In §8.3 a
diﬀerent construction is described, which is related to description in [Man91]
of the dual graph of the ﬁber at inﬁnity. A geometric model is given here for
the dual graph as the mapping torus of a dynamical system T on a Cantor
set.

III.4 A guess that the missing geometric objects are noncommutative spaces
413
We consider a noncommutative space which describes the action of the
Schottky group on its limit set and parameterizes the "components of the
closed ﬁber at inﬁnity". This space is represented by a Cuntz-Krieger algebra
OA, described in §8.3.5.
Next, we describe a spectral triple for this noncommutative space, via a
representation on the cochains of a "dynamical cohomology", deﬁned in terms
of the tangle of bounded geodesics in the handlebody. In both constructions
presented in Chapter 8, the Dirac operator agrees with the grading opera-
tor Φ, that represents the "logarithm of a Frobenius-type operator" on the
Archimedean cohomology. In fact, the Archimedean cohomology embeds in
the dynamical cohomology, compatibly with the action of a real Frobenius
¯F∞, so that the local factor can again be recovered from these data. More-
over, the "reduction mod inﬁnity" is presented in §8.4 in terms of the homo-
topy quotient associated to the noncommutative space OA and the µ-map of
Baum-Connes, cf. [BaCo].
Suggestions for further reading to Part III
Works of A.Connes on Trace formula in noncommutative geometry and the ze-
ros of the Riemann zeta function, [Co99], [Co2000a], work of J.-B. Bost [Bo01]
on algebraic leaves of algebraic foliations over number ﬁelds, and [BoCo95],
[CoMar04], [CoMo95], [CoMo04], [Ber86] sheading new light on relations of
physics with number theory using noncommutative geometry (see also nice
papers of P.Cartier [Car95], [Car01], [Car02] on related subjects).
We refer also to Number Theory and Physics archive at
http://www.maths.ex.ac.uk/˜mwatkins/zeta/physics.htm
where one can ﬁnd very useful material and bibliography on relations with
quantum mechanics, statistical mechanics, p-adic and adelic physics, Selberg
trace formula, string theory and quantum cosmology, scattering theory, dy-
namical and spectral zeta functions, trace formulae and explicit formulae, 1/f
noise and signal processing, supersymmetry, QCD, renormalisation, symme-
try breaking and phase transitions, quantum ﬁelds, integer partitions, time,
biologically-inspired and similarly unconventional methods for ﬁnding primes,
dynamical systems, entropy, speciﬁc zeta values, logic, languages, information,
etc., probability and statistics, noncommutative geometry, random matrices,
Fourier theory, fractal geometry, Bernoulli numbers, Farey sequences, Beurl-
ing g-primes, golden mean, zeta functions and L-functions.

8
Arakelov Geometry and Noncommutative
Geometry (d'après C. Consani and M. Marcolli,
[CM])
8.1 Schottky Uniformization and Arakelov Geometry
8.1.1 Motivations and the context of the work of Consani-Marcolli
Our primary motivation in this chapter is a desire to enrich the somewhat
formal picture of Arakelov's geometry at arithmetical inﬁnity (see [Ara74b],
[La88], [GS92], [Man84], and §5.2.6). We try to describe geometric and alge-
braic objets which play the roles, respectively, of the "∞-adic completion" of
a completed arithmetical Arakelov variety, of its "closed ﬁber at inﬁnity", and
the "reduction modulo ∞", in the spirit of the work of Mumford [Mum72]. We
follow the paper [Man91], and recent works [CM], [CM03], [CM04a], [Cons98],
which clariﬁed much at the arithmetical inﬁnity.
We try to explain then how to use Connes' theory of spectral triples (see
[Co95], [Co99], [Co94], and §8.3) in order to relate the hyperbolic geometry
to Deninger's Archimedean cohomology.
We recall the beginning of a dictionary which translates classical notions
into the laguage of operators in the Hilbert space H:
Complex variable
Operator in H
Real variable
Self-adjoint operator
Inﬁnitesimal
Compact operator
(8.1.1)
From the arithmetic point of view, algebraic numbers appear in commu-
tative geometry as values of algebraic functions, whereas in noncommutative
geometry they appear as values of traces of projections, or more generally
values of appropriate states on observables. In both cases, a control of the
action of the Galois group is gained, if this action commutes with an action of
certain "geometric" endomorphisms, or correspondences, whenever the latter
are deﬁned over the ground ﬁeld.

416
8 Arakelov Geometry and Noncommutative Geometry
Interesting examples of noncommutative spaces come from geometric con-
structions in [Man91].
The choice of structures used in this section is related to Mumford's idea
(see [Mum72], and §8.1.2) that p-adic curves with maximally degenerate re-
duction admit an (essentialy unique) p-adic Schottky uniformization. On can
use his geometric picture in an Archimedean setting.
In the paper [Man91] a ﬁlling X of X was constructed, which was an aux-
iliary three dimensional manifold endowed with a metric of constant negative
curvature, such that X is its boundary, and which can be deﬁned by a Schottky
uniformization, described in §8.1.3.
It was also proven in [Man91] that Green's function on X can be expressed
in terms of the geometry of geodesics on X.
An interesting analogy was suggested, in which the set of all closed geodes-
ics in X and the set of geodesics with one end at X play the roles, respectively,
of "∞-adic completion" of X, its "closed ﬁber at inﬁnity", and the "reduction
modulo ∞", in the spirit of the work of Mumford ([Mum72]).
Preliminary notions and notation
Throughout this section let us denote by K one among the following ﬁelds:
(a) the complex numbers C, (b) a ﬁnite extension of Qp. When (b) occurs, we
write OK for the ring of integers of K, m ⊂OK for the maximal ideal and
π ∈m for a uniformizer (i.e. m = (π)). We also denote by k the residue classes
ﬁeld k = O/m.
We denote by H′ (or simply by H3 = H′) the three-dimensional real hy-
perbolic space i.e. the quotient
H′ = SU(2)\PGL(2, C).
This space can also be described as the upper half space H′ ≃C×R+ endowed
with the hyperbolic metric. The group PSL(2, C) acts on H′ by isometries.
The complex projective line P1(C) is identiﬁed with the conformal boundary
at inﬁnity of H′ and the action of PSL(2, C) on H′ extends to an action on
H′ := H′ ∪P1(C). The group PSL(2, C) acts on P1(C) by fractional linear
transformations.
8.1.2 Analytic construction of degenerating curves over complete
local ﬁelds and Arakelov geometry (d'après Mumford [Mum72])
The idea of investigating the p-adic analogues of classical and abelian vari-
eties is due to John Tate [Ta74], who showed that if K is a complete non-
Archimedean local ﬁeld, and E is an elliptic curve over K whose j-invariant
is not an integer, then E can be analytically uniformized. This uniformization
is not a holomorphic map:

8.1 Schottky Uniformization and Arakelov Geometry
417
π : A1
K →E
generalizing the universal covering space
π : C →E(= closed points of an elliptic curve over C),
but instead is a holomorphic map:
π2 : A1
K\{0} →E
generalizing an inﬁnite cyclic covering π2 over C:
C×
π2








C
π

π1








E
π1(z) = e2πi(z/ω1),
ω1 is one of the two periods of E. Here one can take holomorphic map to mean
holomorphic in the sense of the non-Archimedean function theory of Grauert
and Remmert [GR71]. But the uniformization π2 is more simply expressed by
embedding E in P2
K and deﬁning the tree homogeneous coordinates of π(z)
by three everywere convergent Laurent series.
In order to explain what happens for curves of higher genus, let us present
a bit further the interesting analogies between the real, complex and p-adic
structures PGL(2) (as developped by Bruhat, Tits and Serre, see [Se71]):
(A) real case: PSL(2, R) acts isometrically and transitively on the upper half
plane H and the boundary can be identiﬁed with RP1 (the real line plus
∞):
Fig. 8.1.

418
8 Arakelov Geometry and Noncommutative Geometry
Fig. 8.2.
(B) complex case: PGL(2, C) acts isometrically and transitively on the upper
half space H′ and the boundary can be identiﬁed with CP1: The action of
PSL(2, C) on H′ is given by
(z, x) →

(cz + d)(az + b) + acx2
|cz + d|2 + |c|2x2
,
x
|cz + d|2 + |c|2x2

.
(C) p-adic case: PGL(2, K) acts isometrically and transitively on the Bruhat-
Tits tree ∆, (whose vertices correspond to the subgroups gPGL(2, OK)g−1,
and whose edges have length 1 and correspond to the subgroups
gPGL(2, OK)g−1,
,
a
c
b
d
 a, b, c, d ∈OK, c ∈m, ad ̸∈m
-
modulo O∗
K)
and the set of whose ends can be identiﬁed with KP1 (see [Se77], and
[Mum72], p. 131).
Fig. 8.3.
In ∆, for any vertex v the set of edges meeting v is naturaly isomorphic to
kP1, the isomorphism being canonical up to an element of PGL(2, k) (where
k = OK/m).

8.1 Schottky Uniformization and Arakelov Geometry
419
In the ﬁrst case, if Γ ⊂PSL(2, R) is a discrete subgroup with no ele-
ments of ﬁnite order such that PSL(2, R)/Γ is compact, we obtain Koebe's
uniformization
H →H/Γ = X
of an arbitrary compact Riemann surface X of genus g ≥2.
In the second, if Γ ⊂PSL(2, C) is a discrete subgroup which act discon-
tinuously at at least one point of CP1 (a Kleinian group) and which moreever
is free with n generators and has no unipotent elements in it, then according
to a theorem of Maskit (see in [Mum72]), Γ is a so-called Schottky group, i.e.
if we denote by ΩΓ the domain of discontinuity of Γ acting on P1(C) then ΩΓ
is connected and up to a homeomorphism we get a uniformization
(H′ ∪ΩΓ ) →(H′ ∪ΩΓ )/Γ
∼=
solid torus with n handles
∪
∪
homeo
∪
ΩΓ
π→
ΩΓ /Γ
∼=
{ boundary, a surface of genus n}.
homeo
The quotient
X/C = ΩΓ /Γ
(8.1.2)
is a Riemann surface of genus g and the covering ΩΓ →X/C is called a
Schottky uniformization of X/C. Every complex Riemann surface X/C admits
a Schottky uniformization. In particular, Γ/ΩΓ is a compact Riemann surface
of genus n and for a covering corresponding to the subgroup
N ⊂π1(ΩΓ )/Γ
(8.1.3)
N = least normal subgroup containing a1, · · · , an.
(8.1.4)
The Schottky uniformization π admits a p-adic analog.
In the third case, let Γ ⊂PGL(2, K) be any discrete subgroup consisting
entirely of hyperbolic elements. Then according to Ihara, the group Γ is free:
let Γ have n generators. Again, let ΩΓ be the set of closed points of P1
K where
Γ acts discontinuously (equivalently, ΩΓ is the set of points which are not
limits of ﬁxed points of elements of Γ).
Then it was proved in [Mum72] that there is a curve C of genus n and a
holomorphic isomorphism:
π : ΩΓ /Γ
≈
→C.
Moreover, ∆/Γ has a very nice interpretation as a graph of the specialization
of C over the ring OK. In fact
a) there will be a smallest subgraph
(∆)0/Γ ⊂∆/Γ
such that
π1((∆)0/Γ)
∼
→π1(∆/Γ) and (∆)0/Γ will be ﬁnite.

420
8 Arakelov Geometry and Noncommutative Geometry
Fig. 8.4.
Ends of ∆/Γ
(∆/Γ)0
b) C will have a canonical specialization C over OK where C is a singular
curve of arithmetic genus n made up from copies of P1
k with a ﬁnite number
of distinct pairs of k-rational points identiﬁed to form ordinary double
points points. Such a curve C will be called a k-split degenerate curve of
genus n.
c) C(K), the set of K-rational points of C, will be naturally isomorphic
to the set of ends of ∆/Γ; C(k), the set of k-rational points of C, will
be naturally isomorphic to the set of edges of ∆/Γ that meet vertices of
(∆/Γ)0 (so that the components of C correspond to the edges of ∆/Γ
meeting a ﬁxed vertex of (∆/Γ)0 and the double points of C correspoind
to the edges of (∆/Γ)0; and ﬁnally the specialization map
C(K) −→C(k)
is equal, under the above identiﬁcation, to the map
Ends of (∆/Γ)0 →

edges of ∆/Γ
meeting (∆/Γ)0

which takes an end to the last edge in the shortest path from that end to
(∆/Γ)0.
Example 8.1. The following ﬁgure 8.5 illustrates a case when the genus is 2,
C has 2 components, each with one double point and meeting each other
once: Because all the curves C which were constructed in this way have prop-
erty (b), they are refered to as degenerating curves. The main theorem in
[Mum72] implies that every such degenerating curve C has a unique analytic
uniformization π : Γ\ΩΓ
∼
→C.
8.1.3 Schottky groups and new perspectives in Arakelov geometry
A uniﬁed description of the Archimedean and the totally split degenerate
ﬁbers of an arithmetic surface was given in [CM], using operator algebras

8.1 Schottky Uniformization and Arakelov Geometry
421
Fig. 8.5.
and Connes' theory of spectral triples in noncommutative geometry, [Co94].
Some of more recent results were reported in [CM04a] on a non-commutative
interpretation of the totally split degenerate ﬁbers of an arithmetic surface.
Let X be an arithmetic surface deﬁned over Spec(Z) (or over Spec(OK),
for a number ﬁeld K), having the smooth algebraic curve X/Q as its generic
ﬁber. Then, as a Riemann surface, X/C admits always a uniformization by
means of a Schottky group Γ. In analogy to Mumford's p-adic uniformization
of algebraic curves (cf. [Mum72]), the Riemann surface X/C can be interpreted
as the boundary at inﬁnity of a 3-manifold XΓ deﬁned as the quotient of the
real hyperbolic 3-space H′ by the action of the Schottky group Γ. The space
XΓ contains in its interior an inﬁnite link of bounded geodesics.
In [Man91] an expression was given for the Arakelov Green function on X/C
in terms of conﬁgurations of geodesics in XΓ , thus interpreting this tangle as
the dual graph G of the "closed ﬁber at inﬁnity" of X.
Schottky uniformization and Schottky groups
Topologically a compact Riemann surface X of genus g is obtained by gluing
the sides of a 4g-gon. Correspondingly, the fundamental group has a presen-
tation
π1(X) = ⟨a1, · · · , ag, b1, · · · , bg |

i
[ai, bi] = 1⟩,
where the generators ai and bi label the sides of the polygon.
In the genus g = 1 case, the parallelogram is the fundamental domain of
the π1(X) = Z2 action on the plane C, so that X = C/(Z + Zτ) is an elliptic
curve.
For the genus at least g ≥2 the hyperbolic plane H admits a tesselation
by regular 4g-gons, and the action of the fundamental group by deck trans-
formation is realized by the action of a subgroup π1(X) ∼= G ⊂PSL(2, R) by

422
8 Arakelov Geometry and Noncommutative Geometry
isometries of H. This endows the compact Riemann surface X with a hyper-
bolic metric and a Fuchsian uniformization
X = G\H.
Another, less known, type of uniformization of compact Riemann surfaces is
Schottky uniformization.
Let us recall brieﬂy some general facts on Schottky groups.
A Schottky group of rank g ≥1 is a discrete subgroup Γ ⊂PSL(2, C),
which is purely loxodromic and isomorphic to a free group of rank g. The
group PSL(2, C) acts on P1(C) by fractional linear transformation
γ : z →az + b
cz + d.
Thus, Γ also acts on P1(C).
Let us denote by ΛΓ the limit set of the action of Γ. One sees that
ΛΓ is contained in P1(C). This set can also be described as the closure
of the set of the attractive and repelling ﬁxed points z±(g) of the loxo-
dromic elements g ∈Γ. In the case g = 1 the limit set consists of two
points, but for g ≥2 the limit set is usually a fractal of some Hausdorﬀ
dimension 0 ≤δ = dimH(ΛΓ ) < 2 (cf. e.g. Fig.8.6 reproduced here from
[MSW02]
and
http://klein.math.okstate.edu/IndrasPearls/gallery
/GeneralSchottky.gif with a kind permission of David J. Wright and Cam-
bridge UP).
Fig. 8.6. Limit set of a Schottky group
Recall that the notion of the Hausdorﬀdimension can be used for quite
general subsets of A ⊂Rd, and it gives for the curves and surfaces the usual

8.1 Schottky Uniformization and Arakelov Geometry
423
notion of dimension. The Hausdorﬀdimension (cf. e.g. [Arne04]∗)) could be
non integer for fractal subsets.
We denote by ΩΓ = ΩΓ (C) the domain of discontinuity of Γ, that is, the
complement of ΛΓ in P1(C).
The quotient space XΓ := H′/Γ is topologically a handlebody of genus g,
and the quotient
XC = ΩΓ /Γ
is a Riemann surface of genus g. The covering ΩΓ →X/C is called a Schottky
uniformization of XC. Every complex Riemann surface XC admits a Schot-
tky uniformization. The handlebody XΓ can be compactiﬁed by adding the
conformal boundary at inﬁnity XC to obtain XΓ := XΓ ∪XC = (H′ ∪ΩΓ )/Γ.
Let {γi}∞
i=1 be a set of generators of the Schottky group Γ. Let us use
the notation γi+g := γ−1
i
, for i = 1, . . . , g. There are 2g Jordan curves Ck on
the sphere P1(C), with pairwise disjoint interiors Dk, such that the elements
γk are given by fractional linear transformations that map the interior of Ck
to the exterior of Cj with |i −j| = g. The curves Ck give a marking of the
Schottky group. The markings are circles in the case of classical Schottky
groups. A fundamental domain for the action of a classical Schottky group Γ
on P1(C) is the region exterior to 2g-circles. (cf. Fig.8.7 reproduced here from
the lectures [Mar04]):
Fig. 8.7. Schottky uniformization for g = 2
∗A family of R = {Bi}i∈N of subsets Bi ⊂Rd is an ε-covering of A if A ⊂
∪Bi and ∀i, diam(Bi) ≤ε. First deﬁne M δ
ε =
inf
R={Bi}

(diamBi)δ, where the
inﬁmum is taken over all ε-coverings. The Hausdorﬀdimension is then deﬁned by
dimH(A) = sup{δ : limε→0 M δ
ε = +∞}. One verﬁes easily that the dimension of
a regular curve is 1, and the dimension of a regular surface is 2. An example of
a non-integer dimension is given by the three-adic Cantor set consisting of real
numbers of the form
∞

n=1
εn
3n , with εn ∈{0, 2}, whose Hausdorﬀdimension is equal
to log 2/ log 3.

424
8 Arakelov Geometry and Noncommutative Geometry
Fuchsian and Schottky uniformization.
Notice that, unlike Fuchsian uniformization, where the covering H is the uni-
versal cover, in the case of Schottky uniformization ΩΓ is very far from being
simply connected, in fact it is the complement of a Cantor set.
A relation between Schottky and Fuchsian uniformizations is given by pass-
ing to the covering that corresponds to the normal subgroup N⟨a1, · · · , ag⟩of
π1(X) generated by half the generators {a1, · · · , ag}:
Γ ∼= π1(X)/N⟨a1, · · · , ag⟩.
Surface with boundary: simultaneous uniformization
In order to see better the Schottky uniformization, one can relate it to a
simultaneous uniformization of the upper and lower half planes that yelds to
Riemann surfaces with boundary, joint at the boundary.
A Schottky group that is speciﬁed by real parameters so that it lies in
PSL(2, R), is called Fuchsian Schottky group (cf. Fig.8.8 reproduced from the
lectures [Mar04], Fig.3. Viewed as a group of isometries of the hyperbolic plane
Fig. 8.8. Classical and Fuchsian Schottky groups
H, or equivalently of the Poincaré disk, a Fuchsian Schottky group G produces
a quotient G\H which is topoligally a Riemann surface with a boundary.
A quasi-circle for Γ is a Jordan curve C in P1(C) which is invariant under
the action of Γ. In particular, such curve contains the limit set ΛΓ . The
existence of a quasi-circle for a Riemann surface X(C) of genus g ≥2 is
known due to Bowen, cf. [Bo], [Mar04].
We have that P1(C)\C = Ω1 ∪Ω2, and, for πΓ : ΩΓ →P1(C), the covering
map
ˆC = πΓ (C ∩ΩΓ ) ⊂P1(C)
is a set of curves on X(C) that disconnect the Riemann surface in the union
of two surfaces with boundary, uniformized respectively by Ω1 and Ω2.
There exist conformal maps
αi : Ωi
∼
=
→Ui, U1 ∪U2 = P1(C)\P1(R)
(8.1.5)

8.1 Schottky Uniformization and Arakelov Geometry
425
with Ui ∼= H=upper half planes in P1(C), and with
Gi =
,
αiγα−1
i
| γ ∈ˆΓ
-
∼= Γ
Fuchsian Schottky groups Gi ⊂PSL(2, R). Here ˜Γ is the Γ-stabilizer of each
of two connected components in P1(C)\C.
The compact Riemann surface is then obtained as
X(C) = X1 ∪∂X1= ˆ
C=∂X2 X2,
with Xi = Ui/Gi (Riemann surfaces with boundary ˆC (cf. Fig.8.9 reproduced
here from the lectures [Mar04], Fig.4).
Fig. 8.9. Fuchsian Schottky groups: Riemann surfaces with boundary
In the case where X(C) has a real structure ι : X →X, and the ﬁxed point
set Fix(ι) = X(R) of the involution is nonempty, we have in fact ˆC = X(R),
and the quasi-circle is given by P1(R).
8.1.4 Hyperbolic handlebodies
The action of a rank g Schottky group Γ ⊂PSL(2, C) on P1(C), by frac-
tional linear transformations, extends to an action by isometries on H3. For a
classical Schottky group, a fundamental domain in H3 is given by the region
external to 2g half spheres over the circles Ck ⊂P1(C) (cf. Fig.8.10 reproduced
here from the lectures [Mar04], Fig.5).
The quotient
XΓ
(8.1.6)
is topologically a handlebody of genus g ﬁlling the Riemann surface X(C) (cf.
Fig.8.11 reproduced here from the lectures [Mar04], Fig.6).
Metrically, XΓ is a real hyperbolic 3-manifold of inﬁnite volume, having
X(C) as its conformal boundary at inﬁnity X(C) = ∂XΓ .

426
8 Arakelov Geometry and Noncommutative Geometry
Fig. 8.10. Genus two: fundamental domain in H3
Fig. 8.11. Handlebody of genus two: fundamental domains in H3
We denote by XΓ the compactiﬁcation obtained by adding the conformal
boundary at inﬁnity,
XΓ = (H3 ∪ΩΓ )/Γ.
(8.1.7)
In the genus zero case, we just have the sphere P1(C) as the conformal
boundary at inﬁnity of H3, thought of as the unit ball in the Poincaré model.
In the genus one case we have a solid torus H3/qZ, for q ∈C∗acting as
q(z, y) = (qz, |q|y)
in the upper half space model, with conformal boundary at inﬁnity the Jacobi
uniformized elliptic curve C∗/qZ.
In this case, the limit set consists of the point {0, ∞}, the domain of
discontinuity is C∗and a fundamental domain is the annulus {|q| < |z| ≤1}
(exterior of two circles).
The relation of Schottky uniformization to the usual Euclidean uniformiza-
tion of complex tori X = C/(Z + τZ) is is given by q = exp(2πiτ).
In the case g ≥2, the limit set ΛΓ is a Cantor set with an interesting
dynamics of the action of Γ. It is the dynamics of the Schottky group on its
limit set that generates an interesting noncommutative space.

8.1 Schottky Uniformization and Arakelov Geometry
427
Geodesics in XΓ
The hyperbolic handlebody XΓ has inﬁnite volume, but it contains a region of
ﬁnite volume, which is a deformation retract of XΓ . This is called the "convex
core" of XΓ and is obtained by taking geodesic hull of the limit set ΛΓ in H3
and then the quotient by Γ.
We identify diﬀerent classes of inﬁnite geodesics in XΓ :
Closed geodesics: since Γ is purely loxodromic, for all γ ∈Γ there exist two
ﬁxed points {z±} ∈P1(C). The geodesics in H3 ∪P1(C) with ends in at
two such points {z±}, for some γ ∈Γ correspond to closed geodesics in
the quotient XΓ .
Bounded geodesics: the images in XΓ of geodesics in H3 ∪P1(C) having both
ends on the limit set ΛΓ are geodesics which remain conﬁned within the
convex core of XΓ .
Unbounded geodesics: these are the geodesics in XΓ that eventually wander
oﬀthe convex core towards the conformal boundary X(C) at inﬁnity. They
correspond to geodesics in H3 ∪P1(C) with at least one end at a point of
ΩΓ .
In the genus one case, there is a unique primitive closed geodesic, namely the
image in the quotient of the geodesic in H3 connecting 0 and ∞. The bounded
geodesics are corresponding to geodesics in H3 originating at 0 or ∞.
The most interesting case is that of genus g ≥2, where the bounded geo-
desics form a complicated tangle inside XΓ . Topologically, this is a generalized
solenoid, namely it is locally the product of a line and a Cantor set.
8.1.5 Arakelov geometry and hyperbolic geometry
In this section we describe the result in [Man91] on the relation between
the Arakelov Green function on a Riemann surface X(C) with Schottky uni-
formization and geodesics in the 3-dimensional hyperbolic handlebody XΓ .
Arakelov Green function
Given a divisor A = 
x mx(x) with support |A| on a compact smooth Rie-
mann surface X(C), and a choice of a positive real-analytic 2-form dµ on
X(C), the Green function gµ,A = gA is a real analytic function on X(C)\|A|,
uniquely determined by the following conditions
Laplace equation: gA satisﬁes ∂∂gA = πi(deg(A)dµ −δA), with δA the δ-
current ϕ →
x mxϕ(x).
Singularities: if z is a local coordinate in a neighbourhood of x, then gA −
mx log |z| is locally real analytic.
Normalization: gA satisﬁes

X gAdµ = 0.

428
8 Arakelov Geometry and Noncommutative Geometry
If B = 
y ny(y) is another divisor, such that |A|∩|B| = ∅, then the expression
gµ(A, B) := 
y nygµ,A = (y) is symmetric and biadditive in A, B. Generally,
such expressions gµ depends on µ, where the choice of µ is equivalent to
the choice of a real analytic Riemann metric on X(C), compatible with the
complex structure.
However, in the special case of degree zero divisors, deg A = deg B = 0,
the gµ(A, B) = g(A, B) are conformal invariants.
In the case of the Riemann sphere P1(C), if wA is a meromorphic function
with Div(wA) = A, we have
g(A, B) = log

y∈|B|
|wB(y)|ny = Re

γB
dwA
wA
(8.1.8)
where γB is a 1-chain with boundary B.
In the case of degree zero divisors A, B on a Riemann surface of higher
genus, the formula (8.1.8) can be generalized replacing the logarithmic diﬀer-
ential dwA
wA with a diﬀerential of the third kind (meromorphic diﬀerential with
nonvanishing residues) ωA with purely imagimary periods and residues mx at
x. This gives
g(A, B) = Re

γB
ωA.
(8.1.9)
Thus one can explicitely compute g(A, B) from a basis of diﬀerentials of the
third kind with purely imaginary periods.
Cross ratio and geodesics
The basic step in expressing the Arakelov Green function in terms of geodesics
in the hyperbolic handlebody XΓ , is a very simple classical fact of hyperbolic
geometry, namely the fact that the cross ratio of four points on P1(C) can be
expressed in terms of geodesics in the interior H3:
log |⟨a, b, c, d⟩| = −ordist(a ∗{c, d}, b ∗{c, d}).
(8.1.10)
Here, ordist denotes the oriented distance, and we use the notation a ∗{c, d}
to indicate the point on the geodesic {c, d} in H3 with endpoints c, d ∈P1(C),
obtained as the intersection of {c, d} with the unic geodesic from a that cuts
{c, d} at a right angle (cf. Fig.8.12 reproduced here from the lectures [Mar04],
Fig.8).
Diﬀerentials and Schottky uniformization
The next important step is an explicit construction of a basic of diﬀerentials of
the third kind with purely imaginary periods for a Riemann surface X(C) =
Γ\ΩΓ with a Schottky uniformization. This construction uses averages over
the group Γ of expressions involving the cross ratio

8.1 Schottky Uniformization and Arakelov Geometry
429
Fig. 8.12. Cross ratio and geodesic length
⟨a, b, c, d⟩:= (a −b)(c −d)
(a −d)(c −b).
(8.1.11)
Let us denote by C(|γ) a set of representatives for (ρZ)\Γ/(γZ), and by S(γ)
the conjugacy class of γ in Γ.
Let wA be a meromorphic function on P1(C) with divisor A = (a) −
(b), such that the support |A| is contained in the complement of an open
neighbourhood of ΛΓ .
For a ﬁxed choice of a base point z0 ∈ΩΓ , the series
ν(a)−(b) =

γ∈Γ
d log ⟨a, b, γz, γz0⟩
(8.1.12)
gives the lift to ΩΓ of a diﬀerential of the third kind on the Riemann surface
X(C), endowed with the choice of Schottky uniformization. These diﬀerentials
have residues ±1 at the images of a and b in X(C), and they have vanishing
ak periods, where {ak, bk}k=1,··· ,g are the generators of the homology X(C).
Similarly, we obtain lifts of diﬀerentials of the ﬁrst kind on X(C) by con-
sidering the series
ωγ =

h∈C(|γ)
d log
2
hz+(γ), hz−(γ), z, z0
3
,
(8.1.13)
where we denote by {z+(γ), z−(γ)} ⊂ΛΓ the pair of the attractive and re-
pelling ﬁxed points of γ ∈Γ.
The series (8.1.12) and (8.1.13) converge on compact sets K ⊂ΩΓ when-
ever dimH ΛΓ < 1. Moreover, they do not depend on the choice of the base
point z0 ∈ΩΓ .
In particular, given a choice {γk}g
k=1 of generators of the Schottky group
Γ, we obtain by the series (8.1.13) a basis of holomorphic diﬀerentials that
satisfy

ak
ωγl = 2π
√
−1δkl.
(8.1.14)

430
8 Arakelov Geometry and Noncommutative Geometry
One can then use a linear combination of the holomorphic diﬀerentials ωγk to
correct the meromorphic diﬀerentials ν(a)−(b) in such a way that the resulting
meromorphic diﬀerentials have purely imaginary bk-periods. Let Xl(a, b) be
coeﬃcients such that the diﬀerentials of the third kind
ω(a)−(b) := ν(a)−(b) −

l
Xl(a, b)ωγl
(8.1.15)
have purely imaginary periods. The coeﬃcients Xl(a, b) satisfy the system of
equations

l
Xl(a, b)ωγl = Re

bk
ν(a)−(b) =

h∈S(gk)
log |
2
a, b, z+(h), z−(h)
3
|. (8.1.16)
Thus one obtains that the Arakelov Green function for X(C) with Schottky
uniformization can be computed as
g((a) −(b), (c) −(d)) =

h∈Γ
log |⟨a, b, hc, hd⟩| −
g

l=1
Xl(a, b)

h∈S(gl)
log |
2
z+(h), z−(h), c, d
3
|.
(8.1.17)
Notice that this result seems to indicate that there is a choice of Schottky uni-
formization involved as additional data for Arakelov geometry at arithmetic
inﬁnity. However, it was already noticed that the Schottky uniformization is
determined by the real structure at least for real Archimedean primes.
Green function and geodesics
One can explicitely express the Green function in terms of geodesics using the
formula (8.1.10) together with the obtained expression (8.1.17):
g((a) −(b), (c) −(d)) =

h∈Γ
ordist(a ∗{hc, hd}, b ∗{hc, hd})
+
g

l=1
Xl(a, b)

h∈S(gl)
ordist(z+(h) ∗{c, d}, z−(h), ∗{c, d}).
(8.1.18)
The coeﬃcient Xl(a, b) can also be expressed in terms of geodesics, using the
equation (8.1.16).

8.2 Cohomological Constructions, Archimedean
Frobenius and Regularized Determinants
8.2.1 Archimedean cohomology
Given Deninger's formulae (III.3.12) and (III.3.13) as above, it is natural to
ask for a cohomological interpretation of the data (Hm, Φ) (see (III.3.14)). A
general answer was found by C.Consani in [Cons98], for general arithmetic
varieties (in any dimension), giving a cohomological interpretation of the pair
(Hm, Φ) on Deninger's calculation of the Archimedean L-factors as regularized
determinants.
Her construction was motivated by the analogy between geometry at arith-
metic inﬁnity and the classical geometry of a degeneration over a disk. She
introduced a double complex of diﬀerential forms with an endomorphism N
representong the "logarithm of the monodromy" around the special ﬁber at
arithmetic inﬁnity, which is modelled on (a resolution of) the complex of
nearby cycles in the geometric case. The deﬁnition of the complex of nearby
cycles and of its resolution, on which the following construction is modelled is
rather technical. What is easier to visualize geometrically is the related com-
plex of vanishing cycles of a geometric degeneration (see Fig.8.13 reproduced
here from the lectures [Mar04], Fig.15).
Fig. 8.13. Vanishing cycles
Let us describe here the construction of [Cons98] (see also [CM04b]). One
constructs the cohomology theory underlying the data (III.3.14) in several
steps.
Let X = X(C) be a complex Kähler manifold.

432
8 Arakelov Geometry and Noncommutative Geometry
Step 1: Consider ﬁrst a doubly inﬁnite graded complex
C· = Ω·(X) ⊗C[U, U −1] ⊗C[ℏ, ℏ−1],
(8.2.1)
where Ω· is the de Rham complex of diﬀerential forms on X, while U and
ℏare formal variables, with U of degree two and ℏof degree zero.
Let us consider on this complex diﬀerentials
d′
C := ℏd, d′′
C :=
√
−1(¯∂−∂),
(8.2.2)
with total diﬀerential δC = d′
C + d′′C.
We also have an inner product
2
α ⊗U r ⊗ℏk, β ⊗U s ⊗ℏt3
:= ⟨α, η⟩δr,sδk,t,
(8.2.3)
where ⟨α, η⟩is the usual Hodge inner product of forms,
⟨α, η⟩=

X
α ∧∗C(¯η),
(8.2.4)
with C(η) = (√−1)p−q, for η ∈Ωp,q.
Step 2: Let us use the Hodge ﬁltration
F pΩm := ⊕p′+q=m, p′≥pΩp′,q(X)
(8.2.5)
to deﬁne linear subspaces of the complex (8.2.1) of the form
Cm,2r =
0
p+q=m
k≥max{0,2r+m}
F m+r−kΩm(X) ⊗U r ⊗ℏk
(8.2.6)
and the Z-graded vector space
C· =
0
·=2r+m
Cm,2r.
(8.2.7)
Step 3: Let us pass to a real vector space by considering
T· = (C·)c=id
(8.2.8)
where c denotes complex conjugation.
In terms of the intersection of the Hodge ﬁltrations
γ· = F · ∩¯F ·
(8.2.9)
hence
T· =
0
·=2r+m
Tm,2r,
(8.2.10)
where

8.2 Cohomological Constructions
433
Tm,2r =
0
p+q=m
k≥max{0,2r+m}
γm+r−kΩm(X) ⊗U r ⊗ℏk.
(8.2.11)
The Z-graded complex vector space C· is a subcomplex of C· with respect
to the diﬀerential d′
C and for P ⊥the orthogonal projection onto C· in
the inner product (8.2.8), one obtains a second diﬀerential d′′ = P ⊥d′′C.
Similarly, d′ = d′
C and d′′ = P ⊥d′′C deﬁne diﬀerentials on the Z-graded
real vector space T· in terms of the corresponding cutoﬀs on the indices
of the complex C·. For
Λp,q = {(r, k) ∈Z2 | k ≥κ(p, q, r)}
(8.2.12)
with
κ(p, q, r) := max
8
0, 2r + m, |p −q| + 2r + m
2
9
(8.2.13)
(see Fig.8.14 reproduced here from the lectures [Mar04], Fig.16), we iden-
Fig. 8.14. Cutoﬀs deﬁning the complex at arithmetic inﬁnity
tify T· as a real vector space with the span
T· = R
2
α ⊗U r ⊗ℏk3
(8.2.14)
where (r, k) ∈Λp,q for α = ξ + ¯ξ with ξ ∈Ωp,q.
Operators
The complex (T·, δ) has interesting structures given by the action of certain
linear operators.

434
8 Arakelov Geometry and Noncommutative Geometry
We have the operators N and Φ that correspond to the "logarithm of the
monodromy" and the "logarithm of Frobenius". These are of the form
N = Uℏ, Φ = −U ∂
∂U
(8.2.15)
and they satisfy [N, d′] = [N, d′′] = 0 and [Φ, d′] = [Φ, d′′] = 0, hence they
induce operators in cohomology.
Moreover, there is another important operator, which corresponds to the
Lefschetz operator on forms,
L : η ⊗U r ⊗ℏk →η ∧ω ⊗U r−1 ⊗ℏk,
(8.2.16)
where ω is the Kähler form on the manifold X. This satisﬁes [L, d′] = [L, d′′] =
0, and also descends on the cohomology.
The pairs of operators N and Φ or L and Φ satisfy interesting commutation
relations
[Φ, N] = −N, [Φ, L] =, L
that can be viewed as an action of the ring of diﬀerential operators
C[P, Q]/(PQ −QP = Q).
SL(2, R) representations
Another important ingredient of the structure of the complex (T·, δ) are two
involutions
S : α ⊗U r ⊗ℏ2r+m+l →α ⊗U −(r+m) ⊗ℏl
(8.2.17)
˜S : α ⊗U r ⊗ℏk →C(∗α) ⊗U r−(n−m) ⊗ℏk
(8.2.18)
These maps, together with the nilpotent operators N and L deﬁne two repre-
sentations, σL and σR, of the group SL(2, R), given explicitely on the following
generators
ν(s) =
s
0
0
s−1

, s ∈R∗
u(t) =
1
0
t
1

, t ∈R
(8.2.19)
w =
0
1
−1
0

,
namely
σL(ν(s)) = s−n+m, σR(ν(s)) = s2r+m,
σL(u(t)) = exp(tL), σR(u(t)) = exp(tN),
(8.2.20)
σL(w) = (
√
−1)nC ˜S, σR(w) = CS.

8.2 Cohomological Constructions
435
Of these representations, σL extends to an action by bounded operators on
the Hilbert completion of T· in the inner product (8.2.4), while the action of
the subgroup ν(s), s ∈R∗of SL(2, R) via the representation σR on the Hilbert
space is by unbounded densly deﬁned operators.
8.2.2 Local factor and Archimedean cohomology
C.Consani showed in [Cons98] that the data (Hm, Φ) of (III.3.14) can be
identiﬁed with
(H(T·, δ)N=0, Φ),
where (H(T·, δ) is the hypercohomology (the cohomology with respect to the
total diﬀerential) of the complex T·, and H(T·, δ)N=0 is the kernel of the map
induced by N on cohomology. The operator Φ is the one induced on coho-
mology by that of (8.2.15). She called Hm ∼= H(T·, δ)N=0 the Archimedean
cohomology. It was also shown in [Cons98], that this cohomology groups can
be obtained as a piece of the cohomology of the cone of the monodromy N.
This is the complex
Cone(N) = T· ⊕T·[+1]
(8.2.21)
with diﬀerential
D =
δ
0
−N
δ

.
The complex (8.2.21 ) inherits a positive deﬁnite inner product from T·, which
descends to cohomology. The representation σL of SL(2, R) on T· induces a
representation on Cone(N)·. The corresponding inﬁnitesimal representation
dσL : g →End(T·) of the Lie algebra g = sl(2, R) extends to a representation
of the universal enveloping algebra U(g) on T· and to a representation on
Cone(N)·. This gives a representation in the algebra of bounded operators on
the Hilbert completion of Cone(N)· under the inner product.
Theorem 8.2. The triple
(A, H, D) = (U(g), H·(Cone(N)·), Φ)
has the properties that D = D∗,and that (1 + D2)−1/2 is a compact operator.
The commutators [D, a] are bounded operators for all a ∈U(g), and the triple
is 1+-summable.
Thus, (A, H, D) has most of the properties of a spectral triple conﬁrming
the fact that the logarithm of Frobenius Φ should be thought of as a Dirac
operator. However, we are not dealing here with an involutive subalgebra of
a C∗-algebra.
In any case, the structure is suﬃcient to consider zeta functions for this
"spectral triple". In particular, we can recover the alternating products of the
local L-factors at inﬁnity from a zeta function of the spectral triple.

436
8 Arakelov Geometry and Noncommutative Geometry
Theorem 8.3. Consider the zeta-function
ζa,Φ(z) = Tr(a|Φ|−s)
with a = σL(w). This gives
det
∞,σL(w),Φ(s) =
2n

m=0
L(Hm(X), s)(−1)m
8.2.3 Cohomological constructions
In the rest of the section we give, following [CM], some explanantions of a
cohomological theory for the Archimedean ﬁber of an Arakelov surface. How-
ever, there is no need to restrict to the case dim X = 1, because the general
theory, valid for any arithmetic variety, was developed in [Cons98] (see also
an interesting discussion of the Archimedean cohomology in [Mar04], Chapter
3). This construction provides an alternative deﬁnition and a reﬁnement for
the Archimedean cohomology H∗
ar introduced by Deninger in [Den91].
The cohomology spaces H·( ˜X∗) are inﬁnite dimensional real vector spaces
endowed with a monodromy operator N and an endomorphism Φ. The coho-
mology group H·( ˜X∗) is in fact the same as H(T·, δ)|U=(2πi)−1 in the pre-
vious sections. The groups H∗
ar can be identiﬁed with the subspace of the
N-invariants (i.e. Ker(N)) over which (the restriction of) Φ acts in the fol-
lowing way. The monodromy operator determines an integer, even graduation
on
H·( ˜X∗) = ⊕
p∈Z grω
2pH·( ˜X∗),
where each graded piece is still inﬁnite dimensional. We will refer to it as to
the weight graduation. This graduation induces a corresponding one on the
subspace
H·( ˜X∗)N=0 := ⊕
·≥2p grω
2pH·(X∗).
The summands grω
2pH·(X∗) are ﬁnite dimensional real vector spaces on which
Φ acts as a multiplication by the weight p.
When X/κ is a non-singular, projective curve deﬁned over κ = C or R,
the description of grω
2pH·(X∗) (· ≥2p) is particularly easy. For κ = C, this
space coincides with the de Rham cohomology H∗
DR(X/C, R) of the Riemann
surface X/C.
A motivation for the deﬁnition of these complexes comes from the clas-
sical theory of mixed Hodge structures for an algebraic degeneration over a
disk (and its arithmetical counterpart, the theory of Frobenius weights). The
notation: H·( ˜X∗), H·(X∗), H·(Y ) followed in this section is purely formal.
Namely, ˜X∗, X∗and Y are only symbols although this choice is motivated by
the analogy with Steenbrink's construction in [Stee76], in which ˜X∗, X∗and
Y describe resp. the geometric generic ﬁber and the complement of the special

8.2 Cohomological Constructions
437
ﬁber Y in the model. The space H·( ˜X∗) is the hypercohomology group of a
double complex K·,· of real, diﬀerential twisted forms on which one deﬁnes an
additional structure of polarized Lefschetz module.
The whole theory is inspired by the expectation that the ﬁbers at inﬁn-
ity of an arithmetic variety should be thought to be semi-stable and more
speciﬁcally to be "maximally degenerate or totally split", cf. a discussion in
§III.2.3. It would natural to think that the construction of the complex K·,· on
the Riemann surface X/κ, whose structure and behavior gives the arithmeti-
cal information related to the "mysterious" ﬁbers at inﬁnity of an arithmetic
surface, ﬁts in with Arakelov's intuition that Hermitian geometry on X/κ is
enough to recover the intersection geometry on the ﬁbers at inﬁnity.
8.2.4 Zeta function of the special ﬁber and Reidemeister torsion
In this paragraph we explain, following §3.5 of [CM] that in the case dim X =
1, the expression of Theorem 8.3 can be interpreted as a Reidemeister torsion,
and it is related to a zeta function for the ﬁber at arithmetic inﬁnity.
We begin by giving the deﬁnition of a zeta function of the special ﬁber
of a semistable ﬁbration, which motivates the analogous notion at arithmetic
inﬁnity.
Let X be a regular, proper and ﬂat scheme over Spec(Λ), for Λ a discrete
valuation ring with quotient ﬁeld K and ﬁnite residue ﬁeld k. Assume that
X has geometrically reduced, connected and one-dimensional ﬁbers. Let us
denote by η and v resp. the generic and the closed point of Spec(Λ) and by ¯η
and ¯v the corresponding geometric points. Assume that the special ﬁber Xv of
X is a connected, eﬀective Cartier divisor with reduced normal crossings de-
ﬁned over k = k(v). This degeneration is sometime referred to as a semistable
ﬁbration over Spec(Λ).
Let Nv denote the cardinality of k. Then, deﬁne the zeta-function of the
special ﬁber Xv as follows (u is an indeterminate)
ZXv(u) =
P1(u)
P0(u)P2(u),
Pi(u) = det(1 −f ∗u | Hi(X¯η, Qℓ)I¯v),
(8.2.22)
where f ∗is the geometric Frobenius i.e. the map induced by the Frobenius
morphism f : X¯v →X¯v on the cohomological inertia-invariants at ¯v.
The polynomials Pi(u) are closely related to the characteristic polynomials
of the Frobenius Fi(u) = det(u · 1 −f ∗| Hi(X¯η, Qℓ)I¯v) through the formula
Pi(u) = ubiFi(u−1),
bi = degree(Fi).
(8.2.23)
The zeta function ZXv(u) generalizes on a semistable ﬁber the description
of the Hasse-Weil zeta function
of a smooth, projective curve over a ﬁnite
ﬁeld.

438
8 Arakelov Geometry and Noncommutative Geometry
Based on this construction we make the following deﬁnition for the ﬁber
at an Archimedean prime of an arithmetic surface:
ZΦ(u) :=
P1(u)
P0(u)P2(u),
(8.2.24)
where we set
Pq(u) := det
∞
 1
2π −uΦq
2π

,
(8.2.25)
with Φq = Φ|Hq( ˜
X∗)N=0.
In order to see how this is related to the result of Theorem 8.3, we re-
call brieﬂy a simple observation of Milnor (cf. §3 [Mil68]). Suppose given a
ﬁnite complex L and an inﬁnite cyclic covering ˜L, with H∗(˜L, κ) ﬁnitely gen-
erated over the coeﬃcient ﬁeld κ. Let h : π1L →κ(s) be the composition
of the homomorphism π1L →Π associated to the cover with the inclusion
Π ⊂Units(κ(s)). The Reidemeister torsion for this covering is given (up to
multiplication by a unit of κΠ) by the alternating product of the characteristic
polynomials Fq(s) of the κ-linear map
s∗: Hq(˜L, κ) →Hq(˜L, κ),
τ(s) ≃F0(s)F1(s)−1F2(s) · · · Fn(s)±1.
(8.2.26)
Moreover, for a map T : L →L, let ζT (u) be the Weil zeta
ζT (u) = P0(u)−1P1(u)P2(u)−1 · · · Pn(u)∓1,
where the polynomials Pq(u) of the map T∗are related to the characteristic
polynomials Fq(s) by (8.2.23) and bq are the q-the Betti number of the complex
L. By analogy with (8.2.26), Milnor writes the Reidemeister torsion τT (s) (up
to multiplication by a unit) as
τT (s) := F0(s)F1(s)−1F2(s) · · · Fn(s)±1,
where Fq(s) are the characteristic polynomials of the map T∗. Then the rela-
tion between zeta function and Reidemeister torsion is given by:
ζT (s−1)τT (s) = sχ(L),
(8.2.27)
where χ(L) is the Euler characteristic of L.
Similarly, we can derive the relation between the zeta function of the ﬁber
at inﬁnity deﬁned as in (8.2.24) and the alternating product of Gamma factors.
Namely, we write
LC(H1(X/C, C), s)
LC(H0(X/C, C), s) · LC(H2(X/C, C), s) = F0(s) · F2(s)
F1(s)
,
(8.2.28)

8.2 Cohomological Constructions
439
where we set
Fq(s) := det∞
 s
2π −Φq
2π

,
(8.2.29)
with Φq = Φ|Hq( ˜
X∗)N=0. For this reason we may regard (8.2.28) as the Reide-
meister torsion of the ﬁber at arithmetic inﬁnity:
τΦ(s) := F0(s) · F2(s)
F1(s)
.
(8.2.30)
The relation between zeta function and Reidemeister torsion is then given
as follows.
Proposition 8.4. The zeta function ZΦ of (8.2.24) and the Reidemeister tor-
sion τΦ of (8.2.30) are related by
ZΦ(s−1)τΦ(s) = sg−2eχ s log s,
with g is the genus of the Riemann surface X/C and χ = 2 −2g its Euler
characteristic.
Indeed, the result follows by a simple direct calculation of the regularized
determinants. Namely, we compute (in the case q = 0, 1)
Pq(u) = det∞
 1
2π −uΦq
2π

= exp
⎛
⎝−bq
d
dz ((2π)z 
n≥0
(1 + un)−z)|z=0
⎞
⎠
= exp

bq

log Γ
 1
u

+ log 2π
u
+ log u
2
+ log u
u

= ubq/2e−bq
log u
u (2π)−1/uΓ(1/u),
where bq are the Betti numbers of X/C. The case q = 2 is analogous, but for
the presence of the +1 eigenvalue in the spectrum of Φ2, hence we obtain
P2(u) = exp

−b2
d
dz

(2π)zu−zζ(1/u, z) −
 1
u −1
−z
z=0

= ΓC
 1
u −1
−1
u−3/2e
log u
u .
Thus, we obtain
ZΦ(s−1) = LC(H0(X/C, C), s) · LC(H2(X/C, C), s)
LC(H1(X/C, C), s)
sg−2eχ s log s.

8.3 Spectral Triples, Dynamics and Zeta Functions
We have seen that in the Arakelov theory a completion of an arithmetic surface
is achieved by enlarging the group of divisors by formal linear combinations
of the "closed ﬁbers at inﬁnity". For an arithmetic surface these ﬁbers were
described in [Man91] as follows: the dual graph of any such closed ﬁber has
the form of an inﬁnite tangle of bounded geodesics in a hyperbolic handlebody
endowed with a Schottky uniformization.
This Section is based on Sections 4, 5 and 6 of [CM], and on [CM04a]. We
describe an alternative construction of cohomological spectral data (A, H, Φ),
which is related to description in [Man91] of the dual graph of the ﬁber at
inﬁnity. We use a geometric model for the dual graph as the mapping torus
of a dynamical system T on a Cantor set. We consider a noncommutative
space which describes the action of the Schottky group on its limit set and
parameterizes the "components of the closed ﬁber at inﬁnity". This can be
identiﬁed with a Cuntz-Krieger algebra OA. We describe a spectral triple for
this noncommutative space, via a representation on the cochains of a "dynam-
ical cohomology", deﬁned in terms of the tangle of bounded geodesics in the
handlebody. In the same way as for the Archimedean cohomology of the previ-
ous section (§8.2), the Dirac operator agrees with the grading operator Φ, that
represents the "logarithm of a Frobenius-type operator" on the Archimedean
cohomology. In fact, the Archimedean cohomology embeds in the dynamical
cohomology, compatibly with the action of a real Frobenius ¯F∞, so that the
local factor can again be recovered from these data. The duality isomorphism
on the cohomology of the cone of N corresponds to the pairing of dynamical
homology and cohomology. This suggests the existence of a duality between
the monodromy N and the dynamical map 1 −T.
In noncommutative geometry, the notion of a spectral triple provides the
correct generalization of the classical structure of a Riemannian manifold. The
two notions agree on a commutative space. In the usual context of Riemannian
geometry, the deﬁnition of the inﬁnitesimal element ds on a smooth spin man-
ifold can be expressed in terms of the inverse of the classical Dirac operator
D. This is the key remark that motivates the theory of spectral triples. In par-
ticular, the geodesic distance between two points on the manifold is deﬁned
in terms of D−1 (cf. [Co94] §VI). The spectral triple that describes a classical
Riemannian spin manifold is (A, H, D), where A is the algebra of complex
valued smooth functions on the manifold, H is the Hilbert space of square in-
tegrable spinor sections, and D is the classical Dirac operator (a square root
of the Laplacian). These data determine completely and uniquely the Rie-
mannian geometry on the manifold. It turns out that, when expressed in this
form, the notion of spectral triple extends to more general non-commutative
spaces, where the data (A, H, D) consist of a C∗-algebra A (or more generally
of a smooth subalgebra of a C∗-algebra) with a representation as bounded
operators on a Hilbert space H, and an operator D on H that veriﬁes the
main properties of a Dirac operator. The notion of smoothness is determined

8.3 Spectral Triples, Dynamics and Zeta Functions
441
by D: the smooth elements of A are deﬁned by the intersection of domains of
powers of the derivation given by commutator with |D|. The basic geometric
structure encoded by the theory of spectral triples is Riemannian geometry,
but in more reﬁned cases, such as Kähler geometry, the additional structure
can be easily encoded as additional symmetries.
In the constructions of this chapter, the Dirac operator D is obtained
from the grading operator associated to a ﬁltration on the cochains of the
complex that computes the dynamical cohomology. The induced operator on
the subspace identiﬁed with the Archimedean cohomology agrees with the
"logarithm of Frobenius" of [Cons98] and [Den91].
This structure further enriches the geometric interpretation of the Archime-
dean cohomology, giving it the meaning of spinors on a noncommutative man-
ifold, with the logarithm of Frobenius introduced in [Den91] in the role of the
Dirac operator.
An advantage of this construction is that a completely analogous formula-
tion exists in the case of Mumford curves. This provides a uniﬁed description
of the Archimedean and totally split degenerate ﬁbers of an arithmetic surface.
Let X be an arithmetic surface deﬁned over Spec(Z) (or over Spec(OK),
for a number ﬁeld K), having the smooth algebraic curve X/Q as its generic
ﬁber. Let p be a ﬁnite prime where X has totally split degenerate reduction.
Then, the completion ˆXp at p of the generic ﬁber of X is a split-degenerate
stable curve over Qp (also called a Mumford curve) uniformized by the action
of a p-adic Schottky group Γ. The dual graph of the reduction of ˆXp coincides
with a ﬁnite graph obtained as the quotient of a tree ∆Γ by the action of Γ.
The curve ˆXp is holomorphically isomorphic to a quotient of a subset of
the ends of the Bruhat-Tits tree ∆of Qp by the action of Γ. Thus, in this
setting, the Bruhat-Tits tree at p replaces the hyperbolic space H′ "at inﬁnity",
and the analog of the tangle of bounded geodesics in XΓ is played by doubly
inﬁnite walks in ∆Γ /Γ.
In analogy with the Archimedean construction, the dynamical system
(W(∆Γ /Γ), T) is described in Section 8.3.8, where T is an invertible shift
map on the set W(∆Γ /Γ) of doubly-inﬁnite walks on the graph ∆Γ /Γ. The
ﬁrst cohomology group H1(W(∆Γ /Γ)T , Z) of the mapping torus W(∆Γ /Γ)T
of T inherits a natural ﬁltration using which a dynamical cohomology group
was introduced. One has in then a Cuntz-Krieger graph algebra C∗(∆Γ /Γ)
and we can construct a spectral triple as in the case at inﬁnity. The Dirac
operator is related to the grading operator Φ that computes the local factor as
a regularized determinant, as in [Den01], [Den94]. In [CM03], a possible way
was suggested of extending such construction to places that are not of split
degenerate reduction, inspired by the "foam space" construction of [Man72b]
and [CM04a]. Notice however, unlike the local factor at inﬁnity, the factor at
the non-Archimedean places involves the full spectrum of D and not just its
positive or negative part. It is believed that this diﬀerence should correspond

442
8 Arakelov Geometry and Noncommutative Geometry
to the presence of an underlying geometric space based on loop geometry,
which manifests itself as loops at the non-Archimedean places and as "half
loops" (holomorphic disks) at arithmetic inﬁnity.
There is another important diﬀerence between the Archimedean and non-
Archimedean cases. At the Archimedean prime the local factor is described
in terms of zeta functions for a Dirac operator D (cf. [CM], [Den91]). On
the other hand, at the non-Archimedean places, in order to get the correct
normalization as in [Den94], we need to introduce a rotation of the Dirac
operator by the imaginary unit, D →iD. This rotation corresponds to the so
called Wick rotation that moves poles on the real line to poles on the imaginary
line (zeroes for the local factor) and appears to be a manifestation of a rotation
from Minkowskian to Euclidean signature it →t, as already remarked in
([Man95], p.135): "imaginary time motion" may be held responsible for the fact
that zeroes of Γ(s)−1 are purely real whereas the zeroes of all non-Archimedean
Euler factors are purely imaginary. It is expected, therefore, that a more
reﬁned construction would involve a version of spectral triples for Minkowskian
signature∗).
8.3.1 A dynamical theory at inﬁnity
Let us describe some dynamical theory tools used in constructions of Deninger-
style cohomology spaces at arithmetical inﬁnity. We explain that these spaces
can be used in order to describe Gamma-factors of an arithmetic surface as
certain zeta-reguarized determinants and a "reduction modulo ∞" by means
of Noncommutative geometry (the theory of spectral triples) in Section 8.4.
Since the uniformizing group Γ is a free group, there is a simple way of
obtaining a coding of the bounded geodesics in the handlebody XΓ (deﬁned
by (8.1.6)) The set of such geodesic can be identiﬁed with ΛΓ ×Γ ΛΓ , by
specifying the endpoints in H3 ∪P1(C) modulo the action of Γ.
Given a choice of a generators {γi}g
i=1 for Γ, there is a bijection between
the elements of Γ and the set of all admissible walks in the Cayley graph of Γ,
namely reduced words in the {γi}2g
i=1, where we use the notation γi+g := γ−1
i
,
for i = 1, . . . , g.
In the following we consider the sets S+ and S of resp. right-inﬁnite, doubly
inﬁnite admissible sequences in the {γi}2g
i=1:
S+ = {a0a1 . . . aℓ. . . |ai ∈{γi}2g
i=1, ai+1 ̸= a−1
i , ∀i ∈N},
(8.3.1)
S =
(8.3.2)
{. . . a−m . . . a−1a0a1 . . . aℓ. . . |ai ∈{γi}2g
i=1, ai+1 ̸= a−1
i , ∀i ∈Z}.
According to B.Mazur [Maz2000], "Archimedean and non-Archimedean phenom-
ena remain, at bottom, puzzingly diﬀerent. Perhaps the next century will see a
more profound understanding of the relation between these. . . "

8.3 Spectral Triples, Dynamics and Zeta Functions
443
The admissibility condition simply means that we only allow "reduced" words
in the generators, without cancellations.
On the space S we consider the topology generated by the sets W s(x, ℓ) =
{y ∈S|xk = yk, k ≥ℓ}, and W u(x, ℓ) = {y ∈S|xk = yk, k ≤ℓ} for x ∈S and
ℓ∈Z.
There is a two-sided shift operator T acting on S as the map
T( . . .
a−m
. . . a−1 a0 a1 . . .
aℓ
. . . ) =
. . . a−m+1 . . . a0 a1 a2 . . . aℓ+1 . . .
(8.3.3)
Then we can pass from the descrete dynamical system (S, T) to its sus-
pension ﬂow and obtain the mapping torus.
The following topological space is deﬁned in terms of the Smale space
(S, T) and will be considered as a geometric realization of the "dual graph"
associated to the ﬁber at arithmetic inﬁnity of the arithmetic surface X.
Deﬁnition 8.5. The mapping torus (suspension ﬂow) of the dynamical sys-
tem (S, T) is deﬁned as
ST := S × [0, 1]/(x, 0) ∼(Tx, 1)
(8.3.4)
Topologically, this space is a solenoid, that is, a bundle over S1 with ﬁber
a Cantor set.
8.3.2 Homotopy quotion
The space ST is a very natural space associated to the noncommutative space
ΛΓ ×Γ ΛΓ ≃S/Z,
(8.3.5)
where ΛΓ is the limit set of the action of Γ, and Z is acting in (8.3.5) via the
invertible shift T of (8.3.3). This space is given by given by the C∗-algebra
A = C(S) ⋊T Z
(8.3.6)
describing the action of the shift T on the totally disconnected space S. One
obtains the homotopy quotient (cf. [BaCo], [Co83]),
ST = S ×Z R.
(8.3.7)
This is a commutative space that provides, up to homotopy, a geometric model
for the noncommutative space (8.3.5), where the noncommutative space (8.3.5)
can be identiﬁed as in §8.4.1 with the quotient space of a foliation (8.4.3) whose
generic leaf is contractible (a copy of R).
In order to study such spaces, K-theory tools are used.
The C∗-algebra C(S) is a commutative AF-algebra (approximately ﬁnite
dimensional), obtained as the direct limit of the ﬁnite dimensional commuta-
tive C∗-algebras generated by characteristic functions of a covering of S.

444
8 Arakelov Geometry and Noncommutative Geometry
There is the Pimsner-Voiculescu exact sequence (cf. [PV80]) which has
the form
K1(A)
−→K0(C(S))
δ=1−T∗
−→
K0(C(S))
:⏐
⏐5
K1(C(S)) ←−K1(C(S))
←−
K0(A)
(8.3.8)
where A = C(S)⋊T Z. Here since the space is totally disconnected, K0(C(S)) ∼=
C(S, Z), being the direct limit of the K0-groups of the ﬁnite dimensional
commutative C∗-algebras, and K1(C(S)) = 0 for the same reason (locally
constant integer valued functions). Then the exact sequence becomes
0 →K1(C(S) ⋊T Z) →C(S, Z)
δ=1−T∗
→
C(S, Z)
→K0(C(S) ⋊T Z) →0,
(8.3.9)
with K0(C(S) ⋊T Z) ∼= C(S, Z)T . Since the shift T is topologically transitive,
i.e. it has a dense orbit, we also have K1(C(S) ⋊T Z) ∼= C(S, Z)T ∼= Z.
In dynamical system language, these are respectively the invariants and
coinvariants of the invertible shift T (cf. [BoHa], [PaTu82]).
In terms of the homotopy quotient, one can describe this exact sequence
more geometrically in terms of the Thom isomorphism and the µ-map
µ : K∗+1(ST ) ∼= H∗+1(ST , Z) →K∗(C(S) ⋊T Z).
(8.3.10)
Thus we obtain
K1(A) ∼= H0(ST ) = Z
K0(A) ∼= H1(ST )
The cohomology group H1(ST ) can be identiﬁed with the Čech cocomology
group given by the homototy classes [ST , U(1)]: there is the isomorphism
C(S, Z)T ∼= H1(ST , Z)
(8.3.11)
given explicitly by mapping
f →[exp(2πitf(x))],
(8.3.12)
for f ∈C(S, Z) and with [·] the homotopy class.
8.3.3 Filtration
Now let us consider the cohomology group H1(ST , Z) and recall the following
combinatorial explicit description of the cohomology of the mapping torus
H1(ST , Z).
There is an identiﬁcation of H1(ST , Z) with the K0-group of the crossed
product C∗-algebra for the action of T on S,
H1(ST , Z) ∼= K0(C(S) ⋊T Z).
(8.3.13)

8.3 Spectral Triples, Dynamics and Zeta Functions
445
Theorem 8.6. The cohomology H1(ST , Z) satisﬁes the following properties.
The identiﬁcation (8.3.13) endows H1(ST , Z) with a ﬁltration by free abelian
groups F0 →F1 →· · · →Fn →· · · , with rankF0 = 2g and rankFn =
2g(2g −1)n−1(2g −2) + 1, for n ≥1, so that
H1(ST , Z) = lim
−→
n
Fn.
In fact, by the Pimsner-Voiculescu six term exact sequence, the group
K0(C(S) ⋊T Z) can be identiﬁed with the kernel of he map 1 −T, acting as
f →f −f ◦T on the Z-module C(S, Z) ∼= K0(C(S):
C(S, Z)T = C(S, Z)/B(S, Z) ∼= P/δP,
(8.3.14)
where P ⊂C(S, Z) is the set of functions that depend only on "future coor-
dinates", and δ is the operator δ(f) = f −f ◦T.
This can be identiﬁed with functions on the limit set ΛΓ , since each point
in ΛΓ is described by an inﬁnite admissible sequence in the generators γi and
their inverses.
Then the set of functions P can be identiﬁed with
C(S+, Z) = C(ΛΓ , Z)
viewed as the submodule of the Z-module C(S, Z) of functions that only
depend on future coordinates. Thus, P has a ﬁltration P = ∪∞
n=0Pn, where
Pn is generated by the characteristic functions of S+(w) with w of length at
most n + 1. Taking into account the relations between these, we obtain that
Pn is a free abelian group generated by the characteristic functions of S+(w)
with w of length exactly n + 1. The number of such words is 2g(2g −1)n,
hence rankPn = 2g(2g −1)n. The map δ satisﬁes δ : Pn →Pn+1, with a
1-dimensional kernel given by the constant functions. The resulting quotients
Fn = Pn/δPn−1
are torsion free (cf. Theorem 19 §4 of [PaTu82]) and have ranks
rankFn = 2g(2g −1)n−1(2g −2) + 1
for n ≥1, while F0 ∼= P0 is of rank 2g. There is an injection Fn →Fn+1
induced by the inclusion Pn ⊂Pn+1, and P/δP is the direct limit of the Fn
under these inclusions. Thus we obtain the ﬁltration on H1(ST , Z):
H1(ST , Z) = lim
−→
n
Fn.

446
8 Arakelov Geometry and Noncommutative Geometry
8.3.4 Hilbert space and grading
It is convenient to consider the complex vecor space
PC = C(ΛΓ , Z) ⊗C
and the corresponding exact sequence computing the cohomology with com-
plex coeﬃcients:
0 →C →PC
δ→PC →H1(ST , C) →0.
(8.3.15)
The complex vector space PC sits in the Hilbert space
PC ⊂L = L2(ΛΓ , dµ),
where µ is the Patterson-Sullivan measure on the limit set, satisfying
γ∗δµ = |γ′|dimH(ΛΓ )dµ,
with dimH(ΛΓ ) the Hausdorﬀdimension.
This gives a Hilbert space L, together with a ﬁltration Pn by ﬁnite di-
mensional subspaces. In this setting, it is natural to consider a corresponding
grading operator,
D =

n
n ˆΠn,
(8.3.16)
where Πn denotes the orthogonal projection onto Pn and ˆΠn = Πn ⊖Πn−1
8.3.5 Cuntz-Krieger algebra
There is a noncommutative space, that encodes nicely the dynamics of the
Schottky group Γ on its limit set ΛΓ . This space is given by the Cuntz-Krieger
algebra, which carries a reﬁned information on the action of the Schottky group
on its limit set. In order to deﬁne this algebra, consider the 2g × 2g matrix A
that gives the admissibility condition for the sequences in S: this is the matrix
with {0, 1} entries satisfying Aij = 1 for |i −j| ̸= g and Aij = 0 otherwise.
Recall that a partial isometry is a linear operator S satisfying the relation
S = SS∗S.
The Cuntz-Krieger algebra OA (cf. [Cu], [CuKrie]) is deﬁned as the uni-
versal C∗-algebra generated by partial isometries S1, . . . , S2g, satisfying the
relations

j
SjS∗
j = I
(8.3.17)
S∗
i Si =

j
Aij SjS∗
j .
(8.3.18)
This algebra is related to the Schottky group by the following result.

8.3 Spectral Triples, Dynamics and Zeta Functions
447
Proposition 8.7. There is an isomorphism
OA ∼= C(ΛΓ ) ⋊Γ.
(8.3.19)
Up to stabilization (tensoring with compact operators), the algebra has
another crossed product description as
OA ∼= FA ⋊Γ.
(8.3.20)
with FA an AF-algebra (approximately ﬁnite dimensional) algebra, a direct
limit of ﬁnite dimensional C∗-algebras).
Let us consider the cochain complex of Hilbert spaces
0 →C →L
δ→L →H →0
Proposition 8.8. The C∗-algebra OA admits a faithful representation on the
Hilbert space L2(ΛΓ , dµ).
This is obtained as follows.
For dH = dimH(ΛΓ ) the Hausdorﬀdimension, consider the operators
(Tif)(x) := |(γ−1
i
)′|δH/2f(γ−1
i
x),
and
(Pif)(x) := χγi(x)f(x), (8.3.21)
where γi are the generators of Γ, and
(Tγ−1f)(x) := |γ′|δH/2f(γx),
(8.3.22)
for all γ ∈Γ. The
Proposition 8.9. The operators
Si :=

j
AijT ∗
i Pj
(8.3.23)
are partial isometries on L, satisfying the Cuntz-Krieger algebra relations for
the matrix A of the subshift of ﬁnite type (8.3.1). Thus, the Cuntz-Krieger
algebra OA can be identiﬁed with the subalgebra of bounded operators on the
Hilbert space L2(ΛΓ , µ) generated by the Si as in the equality (8.3.23).
Indeed, the operators Pi are orthogonal projectors, i.e. PiPj = δijPj. The
composite T ∗
i PjTi satisﬁes

j
Aij(T ∗
i PjTi f)(x) =

f(x), if Pi(x) = x
0,
otherwise.
In fact, for x = giy, we have

j Aij(T ∗
i PjTif)(x) = 
j AijT ∗
i Pjf(g−1
i
giy) =
T ∗
i (
j AijPj)f(y) = T ∗
i (I −Pi+g)f(y) = f(giy) = f(x).

448
8 Arakelov Geometry and Noncommutative Geometry
In the remaining cases with x ̸= giy, we have

j
Aij(T ∗
i PjTif)(x) =

j
AijT ∗
i Pjf(g−1
i
x) = T ∗
i

j
Ai i+gPi+gf(gi+gx) = 0,
where the last equality follows from the fact that the transition matrix A
satisﬁes Ai i+g = 0. This implies that the Si satisfy
SiS∗
i =

j
AijT ∗
i PjTi = Pi.
Since the projectors Pi satisfy 
i Pi = I, we obtain the relation (8.3.17).
Moreover, since TiT ∗
i = 1, and the entries Aij are all zeroes and ones, we also
obtain
S∗
i Si =

j,k
AijAikPkTiT ∗
i Pj =

j
(Aij)2 Pj =

j
AijPj.
Replacing Pj = SjS∗
j from (8.3.17) we then obtain (8.3.18).
The Cuntz-Krieger algebra OA can be described in terms of the action
of the free group Γ on its limit set ΛΓ (cf. [Rob01], [Spi91]), so that we can
regard OA as a noncommutative space replacing the classical quotient ΛΓ /Γ.
Spectral triples for Schottky groups
Let us consider the diagonal action of the algebra OA on the Hilbert space
H = L ⊕L, and deﬁne the Dirac operator as
D|L⊕0 =

n
(n + 1)( ˆΠn ⊕0)
(8.3.24)
D|0⊕L = −

n
n(0 ⊕ˆΠn).
Theorem 8.10. For a Schottky group Γ with dimH(ΛΓ ) < 1, the data
(O, H, D), for H = L ⊕L with the diagonal action of OA through the rep-
resentation (8.3.23) and the Dirac operator (8.3.24), deﬁne a non-ﬁnitely
summable, θ-summable spectral triple.
The key point of this result is the compatibility relation between the al-
gebra and the Dirac operator, namely the fact that the commutators [D, a]
are bounded operators, for all a ∈Oalg
A , the involutive algebra generated
algebraically by the Si, subject to Cuntz-Krieger relations.
This follows by an estimate on the norm of the commutators ∥[D, Si]∥
and ∥[D, S∗
i ]∥, in terms of the Poincaré series of the Schottky group (using
dH < 1):

8.3 Spectral Triples, Dynamics and Zeta Functions
449

γ∈Γ
|γ′|s, s = 1 > dH,
where the Hausdorﬀdimension dH is the exponent of convergence of the
Poincaré series.
The dimension of the n-th eigenspace of D is 2g(2g −2)n−1(2g −2) for
n ≥1, 2g for n = 0, and 2g(2g −2)−n−1(2g −2) for n ≤−1, so the spectral
triple is not ﬁnitely summable, since |D|z is not of trace class.
It is θ-summable, since the operator exp(−tD2) is of trace class, for all
t > 0.
Using the description (8.3.20) of the noncommutative space as crossed
product of an AF-algebra by the action of the shift, FA ⋊T Z, one may be
able to ﬁnd a 1-summable spectral triple. Here the dense subalgebra should
not contain any of the group elements.
8.3.6 Arithmetic surfaces: homology and cohomology
In particular case of arithmetic surfaces, there is an identiﬁcation (found in
[Cons98], [CM])
H·(Cone, Φ) ∼= H ⊕ˇH
(8.3.25)
where H is the Archimedean cohomology, and ˇH its dual under the involution
S of (8.2.17).
We can extend then the identiﬁcation
U : H1 ∼
=
→V ⊂L
by considering a subspace W of the homology H1(ST ) of a certain topolgical
Smale space, attached to the Schottky uniformization of X(C), in such a way
that W ∼= ˇH. This homology group H1(ST ) admit a very explicit combinato-
rial description, and can be computed as a direct limit
H1(ST , Z) = lim
−→
N
KN,
where the groups KN are free Abelian of rank (2g −1)N + 1 for N even, and
(2g −1)N + (2g −1) for N odd. The Z-module KN is generated by the closed
geodesics represented by periodic sequences in S of period N + 1. These need
not be primitive closed geodesics.
In terms of primitive closed geodesics one can write equivalently
H1(ST , Z) =
∞
0
N=0
RN
where RN are free Abelian groups with
rkRN = 1
N

d|N
µ(d)rkKN/d

450
8 Arakelov Geometry and Noncommutative Geometry
(µ(d) is the Möbius function).
There is a natural pairing of homology and cohomology given by
⟨·, ·⟩: Fn × KN →Z
⟨[f], x⟩= Nf(¯x)
(8.3.26)
This determines a graded subspace W ⊂H1(ST , Z) dual to V ⊂H1(ST ).
With the identiﬁcation
H1
U
−→V ⊂
H1(ST )
⏐5S
⏐5⟨,⟩
˜H1
U
−→W ⊂H1(ST , Z)
(8.3.27)
one can identify the Dirac operator of (8.3.24) with the logarithm of Frobenius
D|V⊕V = ΦH1⊕H1
(8.3.28)
8.3.7 Archimedean factors from dynamics
The dynamical spectral triple described in Theorem 8.10 is not ﬁnitely sum-
mable. However, it is still possible to recover from these data the local factor
at arithmetic inﬁnity.
As in the previous sections, we consider a ﬁxed Archimedean prime given
by a real embedding α : K →R, such that the corresponding Riemann surface
X/R is an orthosymmetric smooth real algebraic curve of genus g ≥2. The
dynamical spectral triple provides another interpretation of the Archimedean
factor LR(H1(X/R, R), s) = ΓC(s)g.
Proposition 8.11. Consider the zeta functions
ζπ(V),D(s, z) :=

λ∈Spec(D)
Tr (π(V)Π(λ, D)) (s −λ)−z,
(8.3.29)
for π(V) the orthogonal projection on the norm closure of 0 ⊕V in H.
The corresponding regularized determinants satisfy
exp

−d
dz ζπ(V),D/2π(s/2π, z)|z=0
−1
= LC(H1(X), s),
(8.3.30)
(cf. Proposition 6.8 of [CM]).
8.3.8 A Dynamical theory for Mumford curves
Let K denote a ﬁnite extension of Qp and ∆K the Bruhat-Tits tree asso-
ciated to G = PGL(2, K). Let us recall few results about the action of a
Schottky group on a Bruhat-Tits tree and on C∗-algebras of graphs. Detailed
explanations are contained in [Man76a], [Mum72], and [CM04a].

8.3 Spectral Triples, Dynamics and Zeta Functions
451
Recall that the Bruhat-Tits tree is constructed as follows. One considers
the set of free O-modules of rank 2: M ⊂V . Two such modules are equivalent
M1 ∼M2 if there exists an element λ ∈K∗, such that M1 = λM2. The group
GL(V) of linear automorphisms of V operates on the set of such modules on
the left: gM = {gm | m ∈M}, g ∈GL(V). Notice that the relation M1 ∼M2
is equivalent to the condition that M1 and M2 belong to the same orbit of the
center K∗⊂GL(V). Hence, the group G = GL(V )/K∗operates (on the left)
on the set of classes of equivalent modules.
We denote by ∆0
K the set of such classes and by {M} the class of the
module M. Because O is a principal ideals domain and every module M has
two generators, it follows that
{M1}, {M2} ∈∆0
K, M1 ⊃M2
⇒
M1/M2 ≃O/ml ⊕O/mk,
l, k ∈N.
The multiplication of M1 and M2 by elements of K preserves the inclusion
M1 ⊃M2, hence the natural number
d({M1}, {M2}) = |l −k|
(8.3.31)
is well deﬁned.
The graph ∆K of the group PGL(2, K) is the inﬁnite graph with set of ver-
tices ∆0
K, in which two vertices {M1}, {M2} are adjacent and hence connected
by an edge if and only if d({M1}, {M2}) = 1. (cf. [Man76a] and [Mum72].)
For a Schottky group Γ ⊂PGL(2, K) there is a smallest subtree ∆′
Γ ⊂∆K
containing the axes of all elements of Γ. The set of ends of ∆′
Γ in P1(K) is
ΛΓ , the limit set of Γ. The group Γ carries ∆′
Γ into itself so that the quotient
∆′
Γ /Γ is a ﬁnite graph that coincides with the dual graph of the closed ﬁbre
of the minimal smooth model of the algebraic curve C/K holomorphically
isomorphic to XΓ := ΩΓ /Γ (cf. [Mum72] p. 163). There is a smallest tree ∆Γ
on which Γ acts and such that ∆Γ /Γ is the (ﬁnite) graph of the specialization
of C. The curve C is a k-split degenerate, stable curve. When the genus of the
ﬁbers is at least 2 - i.e. when the Schottky group has at least g ≥2 generators
- the curve XΓ is called a Schottky-Mumford curve.
The possible graphs ∆Γ /Γ and the corresponding ﬁber for the case of
genus 2 are illustrated in Figure 8.15.
Let us now describe a dynamical system associated to the space W(∆/Γ) of
walks on the directed tree ∆on which Γ acts. In particular, we are interested
in the cases when ∆= ∆K, ∆Γ .
For ∆= ∆Γ , one obtains a subshift of ﬁnite type associated to the action
of the Schottky group Γ on the limit set ΛΓ , of the type that was considered
in [CM].
Let ¯V ⊂∆Γ be a ﬁnite subtree whose set of edges consists of one represen-
tative for each Γ-class. This is a fundamental domain for Γ in the weak sense
(following the notation of [Man76a]), since some vertices may be identiﬁed

452
8 Arakelov Geometry and Noncommutative Geometry
Fig. 8.15. The graphs ∆Γ /Γ for genus g = 2, and the corresponding ﬁbers.
under the action of Γ. Correspondingly, V ⊂P1(K) is the set of ends of all
inﬁnite paths starting at points in ¯V .
Consider the set W(∆Γ /Γ) of doubly inﬁnite walks on the ﬁnite graph
∆Γ /Γ. These are doubly inﬁnite admissible sequences in the ﬁnite alphabet
given by the edges of ¯V with both possible orientations. On W(∆Γ /Γ) we
consider the topology generated by the sets Ws(ω, ℓ) = {˜ω ∈W(∆Γ /Γ) :
˜ωk = ωk, k ≥ℓ} and Wu(ω, ℓ) = {˜ω ∈W(∆Γ /Γ) : ˜ωk = ωk, k ≤ℓ}, for
ω ∈W(∆Γ /Γ) and ℓ∈Z. With this topology, the space W(∆Γ /Γ) is a
totally disconnected compact Hausdorﬀspace.
The invertible shift map T, given by (Tω)k = ωk+1, is a homeomorphism
of W(∆Γ /Γ). One can describe again the dynamical system (W(∆Γ /Γ), T)
in terms of subshifts of ﬁnite type.
Lemma 8.12. The space W(∆Γ /Γ) with the action of the invertible shift T
is a subshift of ﬁnite type, where W(∆Γ /Γ) = SA with A the directed edge
matrix of the ﬁnite graph ∆Γ /Γ.
Genus two example
In the example of Mumford-Schottky curves of genus g = 2, the tree ∆Γ is
illustrated in Figure 8.16.
In the ﬁrst case in the Figure 8.16, the tree ∆Γ is just a copy of the Cayley
graph of the free group Γ on two generators, hence we can identify doubly
inﬁnite walks in ∆Γ with doubly inﬁnite reduced words in the generators of
Γ and their inverses. The directed edge matrix is given by

8.3 Spectral Triples, Dynamics and Zeta Functions
453
a
b
c
a
b
b
a
a
b
b
c
c
c
c
c
c
c
c
c
c
a b
b
b
b
a
a
a
b
b
b
b
a
a
a
a
a
a
a
a
a
a
c
c
c
c
a
b
c
b
a
c
a
c
b
c
b
a
b
a
b
c
a
b
a
a
a
a
b
b
b
b
b
b
b
b
a
a
a
a
Fig. 8.16. The graphs ∆Γ /Γ for genus g = 2, and the corresponding trees ∆Γ .
A =
⎛
⎜
⎜
⎝
1 1 0 1
1 1 1 0
0 1 1 1
1 0 1 1
⎞
⎟
⎟
⎠.
In the second case in Figure 8.16, we label by a = e1, b = e2 and c = e3
the oriented edges in the graph ∆Γ /Γ, so that we have a corresponding set
of labels E = {a, b, c, ¯a,¯b, ¯c} for the edges in the covering ∆Γ . A choice of
generators for the group Γ ≃Z ∗Z acting on ∆Γ is obtained by identifying
the generators g1 and g2 of Γ with the chains of edges a¯b and a¯c. Doubly
inﬁnite walks in the tree ∆Γ are admissible doubly inﬁnite sequences of such
labels, where admissibility is determined by the directed edge matrix
A =
⎛
⎜
⎜
⎜
⎜
⎜
⎜
⎝
0 1 0 0 0 1
1 0 1 0 0 0
0 1 0 1 0 0
0 0 1 0 1 0
0 0 0 1 0 1
1 0 0 0 1 0
⎞
⎟
⎟
⎟
⎟
⎟
⎟
⎠
.
The third case in Figure 8.16 is analogous. A choice of generators for
the group Γ ≃Z ∗Z acting on ∆Γ is given by ab¯a and c. Doubly inﬁnite
walks in the tree ∆Γ are admissible doubly inﬁnite sequences in the alphabet
E = {a, b, c, ¯a,¯b, ¯c}, with admissibility determined by the directed edge matrix

454
8 Arakelov Geometry and Noncommutative Geometry
A =
⎛
⎜
⎜
⎜
⎜
⎜
⎜
⎝
0 0 1 0 0 1
1 1 0 0 0 0
0 0 1 1 0 0
0 1 0 0 1 0
1 0 0 0 1 0
0 0 0 1 0 1
⎞
⎟
⎟
⎟
⎟
⎟
⎟
⎠
.
The construction is analogous for genus g > 2, for the various possible
ﬁnite graphs ∆Γ /Γ. The directed edge matrix can then be written in block
form as
A =
α11 α12
α21 α22

,
where each block αij is a #(∆Γ /Γ)1
+ × #(∆Γ /Γ)1
+-matrix with α12 = αt
12,
α21 = αt
21, and α11 = αt
22.
8.3.9 Cohomology of W(∆/Γ )T
Let ∆= ∆Γ . We identify the ﬁrst cohomology group H1(W(∆Γ /Γ)T , Z) with
the group of homotopy classes of continuous maps of W(∆Γ /Γ)T to the circle.
Let C(W(∆Γ /Γ), Z) be the Z-module of integer valued continuous functions
on W(∆Γ /Γ), and let
C(W(∆Γ /Γ), Z)T := Coker(δ),
for δ(f) = f −f ◦T. The analog of Theorem 8.6 holds:
Proposition 8.13. The map f →[exp(2πitf(x))], which associates to an
element f ∈C(W(∆Γ /Γ), Z) a homotopy class of maps from W(∆Γ /Γ)T
to the circle, gives an isomorphism C(W(∆Γ /Γ), Z)T ≃H1(W(∆Γ /Γ)T , Z).
Moreover, there is a ﬁltration of C(W(∆Γ /Γ), Z)T by free Z-modules
F0 ⊂F1 ⊂· · · ⊂Fn · · · ,
of rank θn −θn−1 + 1, where θn is the number of admissible words of length
n + 1 in the alphabet, so that we have
H1(W(∆Γ /Γ)T , Z) = lim
−→
n
Fn.
The quotients Fn+1/Fn are also torsion free.
(cf. [CM04a]).
The space W(∆Γ /Γ)T corresponds to a space of "bounded geodesics" on
the graph ∆K/Γ, where geodesics, in this setting, are just doubly inﬁnite walks
in ∆K/Γ. In particular, a closed geodesic is the image under the quotient map
πΓ : ∆K →∆K/Γ of a doubly inﬁnite walk in the Bruhat-Tits tree ∆K with
ends given by the pair z+(γ), z−(γ) of ﬁxed points of some element γ ∈Γ.

8.3 Spectral Triples, Dynamics and Zeta Functions
455
Similarly, a bounded geodesic is an element ω ∈W(∆K/Γ) which is the
image, under the quotient map, of a doubly inﬁnite walk in ∆K with both
ends on ΛΓ ⊂P1(K). This implies that a bounded geodesic is a walk of the
form ω = πΓ (˜ω), for some ˜ω ∈W(∆Γ /Γ). By construction, any such walk is
an axis of ∆Γ .
Orbits of W(∆Γ /Γ) under the action of the invertible shift T correspond
bijectively to orbits of the complement of the diagonal in ΛΓ × ΛΓ under the
action of Γ. Thus, we see that W(∆Γ /Γ)T gives a geometric realization of
the space of "bounded geodesics" on the graph ∆K/Γ, much as, in the case of
the geometry at arithmetic inﬁnity, we used the mapping torus of the shift T
as a model of the tangle of bounded geodesics in a hyperbolic handlebody.
As in the case at inﬁnity, we can consider the Pimsner-Voiculescu exact
sequence computing the K-theory groups of the crossed product C∗-algebra
C(W(∆Γ /Γ)) ⋊T Z,
0 →H0(W(∆Γ /Γ)T , Z) →C(W(∆Γ /Γ), Z)
δ=1−T
−→C(W(∆Γ /Γ), Z)
→H1(W(∆Γ /Γ)T , Z) →0.
(8.3.32)
In the corresponding sequence
0 →H0(W(∆Γ /Γ)T , κ) →P
δ
−→P →H1(W(∆Γ /Γ)T , κ) →0,
(8.3.33)
for the cohomology for H∗(W(∆Γ /Γ)T , κ), with κ = R or C, we can take the
vector space P obtained, as in the case at inﬁnity, by tensoring with κ the
Z-module P ⊂C(W(∆Γ /Γ), Z) of functions of future coordinates where P ≃
C(W+(∆Γ /Γ), Z). This has a ﬁltration P = ∪nPn, where Pn is identiﬁed with
the submodule of C(W+(∆Γ /Γ), Z) generated by characteristic functions of
W+(∆Γ /Γ, ρ) ⊂W+(∆Γ /Γ), where ρ ∈W∗(∆Γ /Γ) is a ﬁnite walk ρ =
w0 · · · wn of length n + 1, and W+(∆Γ /Γ, ρ) is the set of inﬁnite paths ω ∈
W+(∆Γ /Γ), with ωk = wk for 0 ≤k ≤n + 1. This ﬁltration deﬁnes the
terms Fn = Pn/δPn−1 in the ﬁltration of the dynamical cohomology of the
Mumford curve, as in Proposition 8.13. Again, we will use the same notation
in the following for the free Z-module Pn of functions of at most n + 1 future
coordinates and the vector space obtained by tensoring Pn by κ.
We obtain a Hilbert space completion of the space P of cochains in (8.3.33)
by considering L = L2(ΛΓ , µ) deﬁned with respect to the measure on ΛΓ =
∂∆Γ given by assigning its value on the clopen set V (v), given by the ends of
all paths in ∆Γ starting at a vertex v, to be
µ(V (v)) = q−d(v)−1,
with q = card(O/m).
In [CM] §4, it was shown how the mapping torus ST of the subshift of ﬁnite
type (S, T), associated to the limit set of the Schottky group, maps surjectively
to the tangle of bounded geodesics inside the hyperbolic handlebody, through

456
8 Arakelov Geometry and Noncommutative Geometry
a map that resolves all the points of intersection of diﬀerent geodesics. In the
case of the Mumford curve, where we replace the real hyperbolic 3-space by
the Bruhat-Tits building ∆K, the analog of the surjective map from ST to
the tangle of bounded geodesics is a map from W(∆Γ /Γ)T to the dual graph
∆Γ /Γ. Here is a description of this map.
As before, let us write elements of W(∆Γ /Γ) as admissible doubly inﬁnite
sequences
ω = . . . wi−m . . . wi−1wi0wi1 . . . win . . . ,
with the wik = {eik, ϵik} oriented edges on the graph ∆Γ /Γ. We consider each
oriented edge w of normalized length one, so that it can be parameterized as
w(t) = {e(t), ϵ}, for 0 ≤t ≤1, with ¯w(t) = {e(1 −t), −ϵ}. Since ω ∈SA is an
admissible sequence of oriented edges we have wik(1) = wik+1(0) ∈∆(0)
Γ .
We consider a map of the covering space W(∆Γ /Γ) × R of W(∆Γ /Γ)T to
|∆Γ | of the form
˜E(ω, τ) = wi[τ](τ −[τ]).
(8.3.34)
Here |∆Γ | denotes the geometric realization of the graph. By construction,
the map ˜E satisﬁes ˜E(Tω, τ) = ˜E(ω, τ + 1), hence it descends to a map E of
the quotient
E : W(∆Γ )T →|∆Γ |.
(8.3.35)
We then obtain a map to |∆Γ /Γ|, by composing with the quotient map of the
Γ action, πΓ : ∆Γ →∆Γ /Γ, that is,
¯E := πΓ ◦E : W(∆Γ )T →|∆Γ /Γ|.
(8.3.36)
Thus, we obtain the following.
Proposition 8.14. The map ¯E of (8.3.36) is a continuous surjection from
the mapping torus W(∆Γ )T to the geometric realization |∆Γ /Γ| of the ﬁnite
graph ∆Γ /Γ.
8.3.10 Spectral triples and Mumford curves
Let us consider the Hilbert space H = L ⊕L and the operator D deﬁned as
D|L⊕0 = −
2π
R log q

(n + 1) ˆΠn
D|0⊕L =
2π
R log q

n ˆΠn,
(8.3.37)
where ˆΠn = Πn −Πn−1 are the orthogonal projections associated to the
ﬁltration Pn, the integer R is the length of all the words representing the
generators of Γ (this can be taken to be the same for all generators, possibly
after blowing up a ﬁnite number of points on the special ﬁber, as explained
in [CM03]), and q = card(O/m).
Theorem 8.15. Consider the tree ∆Γ of the p-adic Schottky group acting on
∆K.

8.3 Spectral Triples, Dynamics and Zeta Functions
457
1. There is a representation of the algebra C∗(∆Γ /Γ) by bounded linear op-
erators on the Hilbert space L.
2. The data (C∗(∆Γ /Γ), H, D), with the algebra acting diagonally on H =
L ⊕L, and the Dirac operator D of (8.3.37) form a spectral triple.
Recall that, for a curve X over a global ﬁeld K, assuming semi-stability at
all places of bad reduction, the local Euler factor at a place v has the following
description ([Se70a]):
Lv(H1(X), s) = det

1 −Fr∗
vN(v)−s|H1( ¯X, Qℓ)Iv−1 .
(8.3.38)
Here Fr∗
v is the geometric Frobenius acting on ℓ-adic cohomology of ¯X =
X ⊗Spec(¯K), with ¯K the algebraic closure and ℓa prime with (ℓ, q) = 1,
where q is the cardinality of the residue ﬁeld k(v) at v. We denote by N the
norm map. The determinant is evaluated on the inertia invariants H1( ¯X, Qℓ)Iv
at v (all of H1( ¯X, Qℓ) when v is a place of good reduction).
Suppose v is a place of k(v)-split degenerate reduction. Then the comple-
tion of X at v is a Mumford curve XΓ . In this case, the Euler factor (8.3.38)
takes the following form:
Lv(H1(XΓ ), s) = (1 −q−s)−g.
(8.3.39)
This is computed by the zeta regularized determinant
det
∞,π(V),iD(s) = Lv(H1(XΓ ), s)−1,
(8.3.40)
where
det
∞,a,iD(s) := exp

−ζ′
a,iD,+(s, 0)

exp

−ζ′
a,iD,−(s, 0)

,
(8.3.41)
for
ζa,iD,+(s, z) := 
λ∈Spec(iD)∩i[0,∞) Tr(aΠλ)(s + λ)−z
ζa,iD,−(s, z) := 
λ∈Spec(iD)∩i(−∞,0) Tr(aΠλ)(s + λ)−z.
(8.3.42)
The element a = π(V) is the projection onto a linear subspace V of H, which
is obtained via embeddings of the cohomology of the dual graph ∆Γ /Γ into
the space of cochains of the dynamical cohomology.
The projection π(V) acts on the range of the spectral projections ˆΠn of D
as elements Qn in the AF algebra core of the C∗-algebra C∗(∆Γ /Γ).

8.4 Reduction mod ∞
In this section based on Section 7 and 8 in [CM], the "reduction mod inﬁnity"
is described in terms of the homotopy quotient associated to the noncom-
mutative space OA of the previous §8.3, and the µ-map of Baum-Connes.
The geometric model of the dual graph can also be described as a homotopy
quotient.
8.4.1 Homotopy quotients and "reduction mod inﬁnity"
In the previous sections we have described the (noncommutative) geometry
of the ﬁber at arithmetic inﬁnity of an arithmetic surface in terms of its dual
graph, which we obtained from two quotient spaces: the spaces
ΛΓ /Γ
and
ΛΓ ×Γ ΛΓ ≃S/Z,
(8.4.1)
with Z acting via the invertible shift T, which we can think of as the sets of
vertices and edges of the dual graph, cf. §4.2 of [CM]. Their noncommutative
geometry was analyzed in terms of Connes' theory of spectral triples.
Another fundamental construction in noncommutative geometry (cf. [Co83])
is that of homotopy quotients. These are commutative spaces, which provide,
up to homotopy, geometric models for the corresponding noncommutative
spaces. The noncommutative spaces themselves, as it can be shown in our
case, appear as quotient spaces of foliations on the homotopy quotients with
contractible leaves.
The crucial point in our setting is that the homotopy quotient for the
noncommutative space S/Z is precisely the mapping torus which gives the
geometric model of the dual graph,
ST = S ×Z R,
(8.4.2)
where the noncommutative space S/Z can be identiﬁed with the quotient
space of the natural foliation on (8.4.2) whose generic leaf is contractible (a
copy of R). On the other hand, the case of the noncommutative space ΛΓ /Γ is
also extremely interesting. In fact, in this case the homotopy quotient appears
very naturally and it describes what is refered as the "reduction mod ∞" in
[Man91].
Let us recall brieﬂy how the reduction map works in the non-Archimedean
setting of Mumford curves (cf. [Man91], [Mum72]).
Let K be a ﬁnite extension of Qp and let OK be its ring of integers. The
correct analog for the Archimedean case is obtained by "passing to a limit",
replacing K with its Tate closure in Cp (cf. [Man91] §3.1), however, for our
purposes here it is suﬃcient to illustrate the case of a ﬁnite extension.
The role of the hyperbolic space H3 in the non-Archimedean case is played
by the Bruhat-Tits tree TBT with vertices

8.4 Reduction mod ∞
459
T 0
BT = {OK −lattices of rank 2 in a 2-dim K-space}/K∗.
Vertices in TBT have valence |P1(OK/m)|, where m is the maximal ideal. Each
edge in TBT has length log |OK/m|. The set of ends of TBT is identiﬁed with
X(K) = P1(K). This is the analog of the conformal boundary P1(C) of H′.
Geodesics correspond to doubly inﬁnite paths in TBT without backtracking.
Fix a vertex v0 on TBT . This corresponds to the closed ﬁber Xa ⊗(a/m) for
the chosen a-structure Xa. Each x ∈P1(K) determines a unique choice of a
subgraph e(v0, x) in TBT with vertices (v0, v1, v2, . . .) along the half inﬁnite
path without backtracking which has end x. The subgraphs e(v0, x)k with
vertices (v0, v1, . . . vk) correspond to the reduction mod mk, namely
{e(v0, x)k : x ∈X(K)} ↭Xa(a/mk).
Thus the ﬁnite graphs e(v0, x)k represent a/mk points, and the inﬁnite graph
e(v0, x) represents the reduction of x.
A Schottky group Γ, in this non-Archimedean setting, is a purely loxo-
dromic free discrete subgroup of PSL(2, K) in g generators. The doubly inﬁ-
nite paths in TBT with ends at the pairs of ﬁxed points x±(γ) of the elements
γ ∈Γ produce a copy of the combinatorial tree T of the group Γ in TBT . This
is the analog of regarding H3 as the union of the translates of a fundamental
domain for the action of the Schottky group, which can be thought of as a
'tubular neighborhood' of a copy of the Cayley graph T of Γ embedded in
H3. The ends of the tree T ⊂TBT constitute the limit set ΛΓ ⊂P1(K). The
complement ΩΓ = P1(K)∖ΛΓ gives the uniformization of the Mumford curve
X(K) ≃ΩΓ /Γ. In turn, X(K) can be identiﬁed with the ends of the quotient
graph TBT /Γ, just as in the Archimedean case the Riemann surface is the
conformal boundary at inﬁnity of the handlebody XΓ .
The reduction map is then obtained by considering the half inﬁnite paths
e(v, x) in TBT /Γ that start at a vertex v of the ﬁnite graph T /Γ and whose
end x is a point of X(K), while the ﬁnite graphs e(v, x)k provide the a/mk
points.
This suggests that the correct analog of the reduction map in the Archi-
medean case is obtained by considering geodesics in H3 with an end on ΩΓ
and the other on ΛΓ , as described in [Man91] . Arguing as in Lemma 4.9 of
[CM], we see that the set of such geodesics can be identiﬁed with the quotient
ΩΓ ×Γ ΛΓ . The analog of the ﬁnite graphs e(v, x)k that deﬁne the reductions
modulo mk is then given by the quotient H3 ×Γ ΛΓ .
Notice then that the quotient space
ΛΓ ×Γ H3 = ΛΓ ×Γ EΓ,
(8.4.3)
is precisely the homotopy quotient of ΛΓ with respect to the action of Γ, with
EΓ = H3 and the classifying space BΓ = H3/Γ = XΓ , (cf. [Co83]). In this
case also we ﬁnd that the noncommutative space ΛΓ /Γ is the quotient space
of a foliation on the homotopy quotient (8.4.3) with contractible leaves H3.

460
8 Arakelov Geometry and Noncommutative Geometry
8.4.2 Baum-Connes map
The relation between the noncommutative spaces (8.4.1) and the homotopy
quotients (8.4.2) and (8.4.3) is an instance of a very general and powerful
construction, namely the µ-map (cf. [BaCo], [Co83]). In particular, in the
case of the noncommutative space C(S) ⋊T Z, the µ-map
µ : K∗+1(ST ) ∼= H∗+1(ST , Z) →K∗(C(S) ⋊T Z)
(8.4.4)
is the Thom isomorphism that gives the identiﬁcation of (8.3.11), (8.3.12)
and recovers the Pimsner-Voiculescu exact sequence (8.3.8) as in [Co81]. As
explained in [CM], the map µ of (8.4.4) assigns to a K-theory class E ∈
K∗+1(S×ZR) the index of the longitudinal Dirac operator ̸∂E with coeﬃcients
E. This index is an element of the K-theory of the crossed product algebra
C(S) ⋊T Z and the µ-map is an isomorphism. Similarly, in the case of the
noncommutative space C(ΛΓ ) ⋊Γ, where we have a foliation on the total
space with leaves H3, the µ-map
µ : K∗+1(ΛΓ ×Γ H3) →K∗(C(ΛΓ ) ⋊Γ)
(8.4.5)
is again given by the index of the longitudinal Dirac operator ̸∂E with co-
eﬃcients E ∈K∗+1(ΛΓ ×Γ H3). In this case the map is an isomorphism
because the Baum-Connes conjecture with coeﬃcients holds for the case of
G = SO0(3, 1), with H3 = G/K and Γ ⊂G the Schottky group, cf. [Kas].
In particular, analyzing the noncommutative space C(ΛΓ ) ⋊Γ from the
point of view of the theory of spectral triples provides cycles to pair with
K-theory classes constructed geometrically via the µ-map.
To complete the analogy with the reduction map in the case of Mumford
curves, one should also consider the half inﬁnite paths e(v, x) corresponding
to the geodesics in XΓ parameterized by ΛΓ ×Γ ΩΓ , in addition to the ﬁnite
graphs e(v, x)k that correspond to the homotopy quotient (8.4.2). This means
that the space that completely describes the "reduction modulo inﬁnity" is a
compactiﬁcation of the homotopy quotient
ΛΓ ×Γ (H3 ∪ΩΓ ),
(8.4.6)
where EΓ = H3 ∪ΩΓ corresponds to the compactiﬁcation of the classifying
space BΓ = H3/Γ = XΓ to BΓ = (H3 ∪ΩΓ )/Γ = XΓ ∪X/C, obtained by
adding the conformal boundary at inﬁnity of the hyperbolic handlebody.

References
[Ma-PaM] Manin Yu.I, Panchishkin A.A. (1989): Introduction to Number Theory,
1989, Edition VINITI (in Russian), 348 p.
[Ma-Pa]
Manin Yu.I, Panchishkin A.A. (1995): Number Theory I: Introduction
to Number Theory, Encyclopaedia of Mathematical Sciences, vol. 49,
Springer-Verlag, 1995, 303 p.
[Abb97]
Abbes, A.: Hauteurs et discrétude, d'après L. Szpiro, E. Ullmo et S.
Zhang. Séminaire Bourbaki. Exp. No.825 (Mars 1997)
[Abr74]
Abrashkin, V.A. (1974): Finding imaginary quadratic ﬁelds with an
even discriminant and class-number two by the Heegner method (in
Russian). Mat. Zametki, 15, No.2, 241-246 (1974). English Translation.:
Math.Notes 15, 137-139 (1974). Zbl.292.12002
[AdHB85]
Adleman, L.M., Heath-Brown, D.R. (1985): The ﬁrst case of Fermat's
last theorem. Inv. Math., 79, No.2, 409-416 (1985). Zbl.557.10034
[AdHu92]
Adleman, L. M., Huang, Ming-Deh A. Primality testing and abelian
varieties over ﬁnite ﬁelds. Lecture Notes in Mathematics, 1512. Springer-
Verlag, Berlin, 1992. viii+142 pp.
[APR83]
Adleman, L.C., Pomerance, C., Rumely, R.C. (1983): On distinguish-
ing prime numbers from composite numbers. Ann. Math., 117,173-206
(1983). Zbl. 526.10004
[ARS78]
Adleman, L.M., Rivest, R.L., Shamir, A. (1978): A method for obtaining
digital signatures and public-key cryptosystems. ACM, 21 (1978), 120-
126. Zbl.368.94005.
[AKS]
Agrawal, M., Kayal, N., Saxena, N.: Primes is in P, Department of Com-
puter Science & Engineering Indian Institute of Technology Kampur
internet : {manindra, Kayaln, nitinsa}@iitk.ac.in
[SSemB87] Selected lectures of Seminar Bourbaki (1987): Algebra and number the-
ory (with applications), (in Russian, talks translated from French and
English. Mir: Moscow, 1987. Zbl.686.00005.
[AGP94]
Alford W.-R., Granville, A., Pomerance, C. (1994): There are inﬁnitely
many Carmichael numbers. Ann. Math. 139, 703-722 (1994).
[All71]
Alling, N., Greenleaf, N., Foundations of the theory of Klein surfaces,
Lecture Notes in Mathematics Vol. 219, Springer Verlag 1971.

462
References
[Ande82]
Anderson, G.W.: Logarithmic derivatives of Dirichlet L-functions and
the periods of abelian varieties, Comp. Math. 45 (1982), 315-322
[And76]
Andrews, G.E. (1976): The theory of partitions. Reading, Addison-
Wesley (1976). Zbl.371.10001.
[An65]
Andrianov, A.N.: Representation of integers by certain quadratic forms
and its relation with the theory of elliptic curves (in Russian). Izv. Akad.
Nauk SSSR, Ser. mat., 29, No.1, 227-238 (1965). English translation:
Am.Math.Soc., Transl., II Ser. 66, 191-203 (1968). Zbl.179,73
[An74]
Andrianov, A.N. (1974): Siegel modular forms of genus 2. (in Russian).
Uspekhi Mat. Nauk, 29, No.3 (1974), 44-109. English translation:
Russ.Math.Surv. 29, No. 3, 45-116 (1974). Zbl.304.10020
[An79a]
Andrianov, A.N. (1979): The multiplicative arithmetics of the Siegel
modular forms.(in Russian). Uspekhi Mat. Nauk, 34, No.1 (1979), 67-
135. English translation: Russ.Math.Surv. 34, No. 1, 75-148 (1979). Zbl.
418.10027
[An79b]
Andrianov, A.N.: Modular descent and the Saito-Kurokawa conjecture.
Inv. Math., 53, No.3, 267-280 (1979). Zbl.414.10017.
[AK78]
Andrianov, A.N., Kalinin V.L. (1978): On the analytical properties of
the standard zeta-unctions of the Siegel modular forms. (in Russian).
Mat. Sbornik, 106, No.3, 323-339, (1978). English translation: Math.
USSR , Sb. 35, 1-17, (1979). Zbl. 389.10023.
[AP2000]
Andrianov A.N., Panchishkin A.A., Singular Frobenius operators on
Siegel modular forms with characters and zeta functions. Algebra i
Analiz, 12, no.2,1-34 (2000). (In Russian) English translation: St.-
Petersbourg Math.J., 12, No. 2, 233-257 (2001)
[AntChris] Antonescu, C., Christensen, E.: Spectral triples for AF C∗-algebras and
metrics on the Cantor set, preprint ArXiv math.OA/0309044.
[Apo97]
Apostol, T.M. (1997): Introduction to Analytic Number Theory.
Springer-Verlag, 1997
[Ara74a]
Arakelov, S.Yu. (1974a): The intersection theory of divisors on arithmeti-
cal surfaces. (in Russian). Izv. Akad. Nauk SSSR, Ser. mat., 38, No.6,
1179-1192 (1974). English translation: Math. USSR , Izv. 8, 1167-1180,
(1976). Zbl. 355.14002.
[Ara74b]
Arakelov, S.Yu. (1974b): Theory of intersections on the arithmetic sur-
face. Proc. Int. Congr. Math., Vancouver 1974, Vol. 1 405-408 (1975).
Zbl.351.14003.
[AKCh87]
Arkhipov, G.I., Karacuba, A.A., Chubarikov, V.M. (1987): The theory
of the multiple exponential sums. (in Russian). Nauka, Moscow (1987).
Zbl.638.10037
[Arne04]
Arneodo, A.: L'analyse multifractale des signaux, In: "Images des math-
ématiques 2004", CNRS, Ed. by Et.Ghys, J.Istas. Février 2004. pp. 7-14
[Art78]
Arthaud, N. (1978): On Birch and Swinnerton-Dyer's conjecture for
elliptic curves with complex multiplication. Comp. Math., 37, No.2, 209-
232 (1978). Zbl.396.12001
[Ar30]
Artin, E. (1930): Zur Theorie der L-Reihen mit allgemeinen Gruppen-
charakteren. Abh. Math. Sem. Univ. Hamburg, 8, 292-306 (1930). Jbuch
FdM.56,173
[Ar51]
Artin, E. (1951): Algebraic numbers and algebraic functions. Lecture
Notes J. Adamson. Princeton and New York Univ., 1951. Gordon &
Breach, 1967. Zbl. 194,353

References
463
[Ar65]
Artin, E. (1965): Collected Papers. Reading, Mass.: Addison-Wesley,
1967. Zbl.493.01038.
[AT51]
Artin, E., Tate, J. (1951): Class ﬁeld theory. Princeton Notes, 1951/1952.
New-York-Amsterdam, W.Benjamin (1968) Zbl. 176,335
[AW45]
Artin, E., Whaples, J. (1945): Axiomatic characterization of ﬁelds by
the product formula. Bull. AMS, 51, No.7, 469-492 (1945). Zbl.60, 83
[Arth83]
Arthur, J. : The trace formula for noncompact quotients, Proceedings
of International Congr of Math., Warsaw (1983), 849-859.
[ArCl89]
Arthur, J., Clozel, L.: Simple algebras, base change and the advanced
theory of the trace formula, in Annals of Math Studies, 120, Princeton
University Press (1989).
[AL70]
Atkin A. Lehner L. (1970): Hecke operators on Γ0(m). Math. Ann. 185,
134-160 (1970)
[AtMo93b] Atkin, A. O. L., Morain, F.: Elliptic curves and primality proving. Math.
Comp., 61(203):29-68, July 1993.
[AB67]
Atiyah, M.F., Bott, R.: A Lefchetz ﬁxed point formula for elliptic com-
plexes: I, Annals of Math, 86 (1967), 374-407.
[APS75]
Atiyah, M.F., Patodi, V.K., Singer I.M.: Spectral asymmetry and Rie-
mannian geometry. I, Math. Proc. Cambridge Philos. Soc. 77 (1975),
43-69.
[Ax64]
Ax, J. (1964): Zeroes of polynomials over ﬁnite ﬁelds. Amer. J. Math.
86, 255-261 (1964). Zbl.121,20.
[Ba71]
Baker, A. (1971): Imaginary quadratic ﬁelds with class number 2. Ann.
Math., 94, No.1, 139-152 (1971). Zbl.219.12008.
[Ba75]
Baker, A. (1975): Transcendental Number Theory. Cambridge. Univ.
Press, 1975. Reissue Cambridge 1990. Zbl.297.10013
[Bak86]
New advances in transcendence theory. Symp. Trans. Number The-
ory. Durham, July, 1986 (ed. Baker A.). Cambridge Univ. Press, 1988.
Zbl.57,281.
[BaHa96]
Baker, R.H., Harman G.: The Brun-Titchmarsh Theorem on average.
In "Proceedings of a conference in Honor of Heini Halberstam", Vol. 1,
39-103 (1996)
[BaRi01]
Ball, K. , Rivoal, T.: Irrationalité d'une inﬁnité de valeurs de la fonction
zêta aux entiers impairs, Invent. Math. 146, 193-207 (2001)
[BDGP96] Barré-Sirieix, K., Diaz, G., Gramain, F., Philibert, G.: Une preuve de la
conjecture de Mahler-Manin. Invent. Math. 124, no. 1-3, 1-9(1996)
[Barsky04] Barsky D.: Sur la nullité de µ-invariant d'Iwasawa des corps totalement
réels. Preprint, Univ. Paris 13, 1-97, 24 mai 2004.
[Bash72]
Bashmakov, M.I. (1972): Cohomology of Abelian varieties. (in Russian).
Uspekhi Mat. Nauk, 27, No.6 (1972), 25-66. English translation:
Russ.Math.Surv. 27, 25-70 (1973). Zbl.256.14016
[BBBCO]
Batut, C., Belabas, D., Bernardi, H., Cohen, H., Olivier, M.: The
PARI/GP number theory system. http://pari.math.u-bordeaux.fr
[BatMan]
Batyrev, V. V., Manin, Yu. I.: Sur le nombre des points rationnels de
hauteur borné des variétés algébriques. Math. Ann. 286, no. 1-3, 27-43
(1990).
[BaTsch96] Batyrev, V. V., Tschinkel, Y.: Rational points on some Fano cubic bun-
dles. C. R. Acad. Sci. Paris Sér. I Math. 323 (1996), no. 1, 41-46.
[BaTsch98a] Batyrev, V. V., Tschinkel, Y.: Manin's conjecture for toric varieties. J.
Algebraic Geom. 7 (1998), no. 1, 15-53.

464
References
[BaTsch98b] Batyrev, V. V., Tschinkel, Y.: Tamagawa numbers of polarized alge-
braic varieties. Nombre et répartition de points de hauteur bornée (Paris,
1996). Astérisque No. 251 (1998), 299-340.
[BKR]
Baum, P., Karoubi, M., Roe, J.: On the Baum-Connes conjecture in the
real case, preprint.
[BaCo]
Baum P., Connes A., Geometric K-theory for Lie groups and foliations.
Preprint IHES (M/82/), 1982; l'Enseignement Mathématique, 46, 1-35,
2000.
[BelBr03]
Belkale, P., Brosnan, P.: Periods and Igusa local zeta functions. Int.
Math. Res. Not. 2003, no. 49, 2655-2670.
[Bea83]
Beardon, A.F., The Geometry of discrete groups, Graduate Texts in
Mathematics, Vol. 91, Springer Verlag 1983.
[Be79]
Belyi, G.V. (1979): On the Galois extensions of the maximal cyclotomic
ﬁeld. (in Russian). Izv. Akad. Nauk SSSR, Ser. mat., 43, No.2, 267-
276 (1979). English translation: Math.USSR Izw. 14, 247-256 (1980).
Zbl.409.12012
[Ber03]
Bernstein D.J.: Proving primality after Agrawal, Kayal and Saxena,
http://cr.yp.to/papers.html#aks, 25/01/2003.
[Ber86]
Berry, M. V.: Riemann's zeta function: a model of quantum chaos?
Quantum chaos and statistical nuclear physics, Lecture Notes in Physics,
263, 1- 17 Springer (1986). Zbl 0664.10021
[BeK]
Berry, M. , Keating, J.: H = qp and the Riemann zeros, 'Supersymmetry
and Trace Formulae: Chaos and Disorder', edited by J.P. Keating, D.E.
Khmelnitskii and I.V. Lerner (Plenum Press).
[Ber61]
Bers, L.: Uniformization by Beltrami equations. Comm. Pure Appl.
Math. 14, 215-228 (1961).
[Bert92]
Bertrand, D.: Groupes algébriques et équations diﬀérentielles linéaires
Séminaire Bourbaki, [Exposé No 750] Février 1992
[BeDa97]
Bertolini, M., Darmon, H.: A rigid analytic Gross-Zagier formula and
arithmetic applications. Ann. of Math. (2) 146, 111-147 (1997)
[BeDa04]
Bertolini, M., Darmon, H.: A Birch and Swinnerton-Dyer conjecture for
the Mazur-Tate circle pairing. Duke Math. J. 122, no. 1, 181-204 (2004)
[Beu55]
Beurling, A.: A closure problem related to the zeta function, Proc. Nat.
Ac. Sci. 41, 312-314 (1955).
[Bha04]
Bhargava, M.: Higher composition laws. I. A new view on Gauss com-
position, and quadratic generalizations. Ann. of Math. (2) 159 (2004),
no. 1, 217-250.
[Bi02]
Bilu, Yu. F.: Catalan's conjecture, after Mihailescu. Séminaire Bourbaki.
[Exposé No.909] (Novembre 2002)
[Bir61]
Birch, B.J. (1961): Forms in many variables. Proc. Royal Soc. London,
Sec. A, 265, 245-263 (1961). Zbl.103,31.
[Bir63]
Birch, B.J.(1963): Conjectures concerning elliptic curves. in: Theory
of Numbers, Proc.Symp.Pure Math. AMS, Pasadena, 1963, 8, 106-112
(1965). Zbl.238.14011.
[Bir75]
Birch, B.J.: Heegner points of elliptic curves. in: Symp. Mat. Inst.
Naz. Alta Mat. Convegni 1973 London-New York, 15, 441-445 (1975).
Zbl.317.14015.
[BD58]
Birch, B.J., Davenport, H.: On a theorem of Davenport and Heilbronn.
Acta Math., 100 (1958), 259-279. Zbl.82,260.

References
465
[BS83]
Birch, B.J., Stephens, N.: Heegner's construction of points on
the curve y2 = x3 −1728, Progr. Math., 38 (1983), 119. Zbl.535.14012
[BSD63]
Birch, B.J., Swinnerton-Dyer, H.P. (1963): Notes on elliptic curves I,II.
J. reine u. angew. Math., 212 (1963), 7-25, Zbl.118,276; 218 (1965),
79-108, Zbl.147.25.
[BSD75]
Birch, B.J., Swinnerton-Dyer, H.P.: The Hasse problem for rational sur-
faces. J. reine u. angew. Math., 274/275 (1975), 164-174. Zbl.326.14007.
[BiGS88]
Bismut, J.-M. , Gillet, H., Soulé C.: Analytic torsion and holomorphic
determinant bundles. I, II, III. Comm. Math.Phys. 115, no. 1, 49-78 ;
no. 1, 79-126; no. 2, 301-351 (1988)
[BGS97]
Bloch, S., Gillet, H., Soulé,C.: Algebraic Cycles on Degenerate Fibers,
Arithmetic Geometry (Cortona 1994), 45-69, Sympos. Math. XXXVII,
Cambridge Univ. Press: Cambridge, 1997.
[BK90]
Bloch, S., Kato K.: L-functions and Tamagawa numbers of motives,
in: The Grothendieck Festschrift, vol. 1, Prog. in Math. 86, Birkhaüser,
Boston, 1990, pp. 333-400.
[Boe85]
Böcherer, S.: Über die Funktionalgleichung automorpher L-Funktionen
zur Siegelschen Modulgruppe. J. Reine Angew. Math. 362 (1985), 146-
168.
[Bog80]
Bogomolov, F.A. Torsion points on abelian varieties. (in Russian). Izv.
Akad. Nauk SSSR, Ser. mat., 44, no.4 (1980), 782-803. Zbl.453.14018.
[BoTs99]
Bogomolov, F. A.; Tschinkel, Yu.: On the density of rational points on
elliptic ﬁbrations. J. Reine Angew. Math. 511 (1999), 87-93.
[BoTs2000] Bogomolov, F. A.; Tschinkel, Yu.: Density of rational points on elliptic
K3 surfaces. Asian J. Math. 4 (2000), no. 2, 351-368.
[Bom72]
Bombieri, E.: Counting points on curves over ﬁnite ﬁelds (d'après
S.A.Stepanov). Sém. Bourbaki, exp. 430 (1972-73), Lect. Notes in Math.,
383 (1974), 234-241. Zbl.307.14011.
[BV83]
Bombieri, E., Vaaler J.: On Siegel's lemma. Inv. Math., 73 (1983), 11-32.
Zbl.533.10030.
[Bom90]
Bombieri, E.: The Mordell conjecture revisited. Ann. Scuola Norm. Sup.
Pisa Cl. Sci. (4) 17 (1990), no. 4, 615-640.
[Borch92]
Borcherds, R.E.: Monstrous moonshine and monstrous Lie superalge-
bras, Invent. Math. 109, 405-444 (1992).
[Borch99]
Borcherds, R.E.: The Gross-Kohnen-Zagier theorem in higher dimen-
sions, Duke Math. J. 97, No. 2, 219-233 (1999) Correction Duke math
journal 105 No. 1 p.183-184 (2000)
[Bor79]
Borel, A.(1979): Automorphic L-functions. Proc. Symp. Pure Math., 33
(1979), 27-61. Zbl.412.10017.
[BoCa79]
Borel A., Casselman W. eds. (1979): Automorphic forms, representa-
tions and L-functions. Proc. Symp. Pure Math. Corvallis, Oregon 1977.
Providence, Am. Math. Soc., Vol. 33, Parts 1-2 (1979). Zbl.121,20.
[BS85]
Borevich, Z.I., Shafarevich, I.R. (1985): Number Theory. (in Russian).
3rd ed. Nauka, Moscow (1985). English transl.: New York/London: Aca-
demic Press, 1966. Zbl.592.12001, Zbl.121,42.
[BZRKJ]
Borho W., Zagier D., Rohlfs J, Kraft H.-P., Jantzen J. C. (1981):
Lebendige
Zahlen.
Fünf
Exkursionen.
Boston:
Birkhäuser,
1981
Zbl.539,10001. Russian translation: Moscow, Mir (1985).
[Bor03]
Bornemann, F.: Primes is in P, une avancée accessible à "l'homme ordi-
naire", Gazette des Mathématiciens No 98, pp.14-30, Octobre 2003.

466
References
[Bo90]
Bost, J.-B.: Théorie de l'intersection et théorème de Riemann-Roch
arithmétiques. Séminaire Bourbaki. [Exposé 731], Novembre 1990
[Bo01]
Bost, J.-B.: Algebraic leaves of algebraic foliations over number ﬁelds.
Publ. Math. Inst. Hautes Études Sci. No. 93 (2001), 161-221.
[BGS94]
Bost, J.-B., Gillet, H., Soulé, C.: Heights of projective varieties and pos-
itive Green forms. J. Amer. Math. Soc. 7, 903-1027 (1994)
[Bo95]
Bost, J.-B.: Périodes et isogénies des variétés abéliennes sur les corps
de nombres, d'après D. Masser et G. Wüstholz. Séminaire Bourbaki.
[Exposé 795], Mars 1995
[BoCo95]
Bost, J.-B., Connes A.: Hecke Algebras, Type III factors and phase tran-
sitions with spontaneous symmetry breaking in number theory, Selecta
Mathematica, New Series 1, No.3 (1995), 411-457.
[Bou62]
Bourbaki, N. Algèbre commutative. Paris, Hermann (1962).
[Bo]
Bowen, R.: Hausdorﬀdimension of quasi-circles, Publ.Math. IHES 50
(1979) 11-25.
[BoHa]
Boyle, M., Handelman, D.: Orbit equivalence, ﬂow equivalence, and or-
dered cohomology, Israel J. Math. 95 (1996) 169-210.
[Bra50]
Brauer, R. (1950): On the zeta-function of algebraic number ﬁelds.II.
Amer. J. Math., 72, no. 4 (1950), 739-746. Zbl.38,176.
[Bre88]
Bremner, A., Guy, R.K.: Unsolved problems. A dozen diﬃcult Dio-
phantine dilemmas. Amer. Math. Monthly, 95, No.1 (1988), 31-36.
Zbl.647.10017.
[Bren80]
Brent, R.P. (1980): An improved Monte Carlo factorization algorithm.
BIT, 29 (1980), 176-184. Zbl.439.65001.
[Bren81]
Brent, R.P., Pollard, J.M. (1981): Factorization of the eighth Fermat
number. Math. Comp. 36, 627-630 (1981). Zbl.476.10007
[dlBre02]
de la Bretèche, R.: Nombre de points de hauteur bornée sur les surfaces
de del Pezzo de degré 5. Duke Math. J. 113, no. 3, 421-464 (2002).
[Breu99]
Breuil, Ch.: Intégration sur les variétés p-adiques, d'après Coleman,
Colmez. Séminaire Bourbaki. [Exposé No.860] (1999).
[Bril81]
Brillhart, J.: Fermat's factoring method and two variants. Congressus
Numerantium, 32, 29-48 (1981). Zbl.488.10006.
[BLTW83] Brillhart, J. Lehmer, D.H., Tuckerman, B., Wagstaﬀ, S.S.: Factorization
of bn ± 1, b = 2, 3, 5, 6, 7, 10, 11, 12 up to high powers. Amer. Math. Soc.,
1983. Zbl.527.10001
[BrGo02]
Brüdern, J., Godinho, H.: On Artin's conjecture. II. Pairs of additive
forms. Proc. London Math. Soc. (3) 84 (2002), no. 3, 513-538.
[Bru61]
Bruhat, F.: Distributions sur un groupe localement compact et appli-
cations á l'étude des représentations des groupes p-adiques. Bull. Soc.
Math. France. 89 (1961), 43-75.
[dBr51]
de Bruijn, N.G.: On the number of positive integers < x and free of
prime factors > y. Indag. Math., 12 (1951), 5¯0 −60. Zbl.42,42
[Bry86]
Brylinski,
J.-L.
(1986):
Transformations
canoniques,
dualité
pro-
jective, théorie de Lefshetz, transformation de Fourier et sommes
trigonométriques. Astérisque, 140/141, 3-134 (1986). Zbl.624.32009.
[BGZ85]
Buhler, J., Gross, B., Zagier., D. On the conjecture of Birch and Swin-
nerton Dyer for an elliptic curve of rank 3. Math.Comput., 44, 473-481
(1985). Zbl.606.14021.

References
467
[BCSGKK3] Bump, D., Cogdell, J. W., de Shalit, E., Gaitsgory, D., Kowalski, E.,
Kudla, S. S.: An introduction to the Langlands program. Lectures pre-
sented at the Hebrew University of Jerusalem, Jerusalem, March 12-
16, 2001. Edited by Joseph Bernstein and Stephen Gelbart. Birkhäuser
Boston, Inc., Boston, MA, 2003. x+281 pp.
[Bum97]
Bump, D.: Automorphic forms and representations. Cambridge Univer-
sity Press, Cambridge, UK, 1997
[CHM97]
Caporaso, L., Harris, J., Mazur, B.: Uniformity of rational points. J.
Amer. Math. Soc. 10, no. 1, 1-35 (1997).
[Car2000]
Carayol, H.: Preuve de la conjecture de Langlands locale pour GLn:
travaux de Harris-Taylor et Henniart. Séminaire Bourbaki, Vol. 1998/99.
Astérisque No. 266, (2000), Exp. No. 857, 4, 191-243.
[Car93]
Cartier, P.: Des nombres premiers à la géométrie algébrique (une brève
histoire de la fonction zéta). Analyse diophantienne et géométrie al-
gébrique, 51-77, Cahiers Sém. Hist. Math. Sér. 2, 3, Univ. Paris VI,
Paris, 1993.
[Car95]
Cartier, P.: An Introduction to zeta functions, in "From Number Theory
to Physics" (Waldschmidt & al., Eds.), pp. 1-63, Springer, 1995.
[Car01]
Cartier, P.: La folle journée; évolution des idées de point et de symétrie,
de Grothendieck à Connes et Kontsevich, numéro spécial des Publ. Math.
IHES (nov. 1998) (English translation in: Bull. Amer. Math. Soc. 38
(2001), 389-408).
[Car02]
Cartier, P.: Fonctions polylogarithmes, nombres polyzêtas et groupes
pro-unipotents. Séminaire Bourbaki, Vol. 2000/2001. Astérisque, No.
282, (2002), Exp. No. 885, viii, 137-173.
[CaVo90]
Cartier, P., Voros, A.: Une nouvelle interprétation de la formule des
traces de Selberg. The Grothendieck Festschrift, Vol. II, 1-67
[Cas59a]
Cassels, J.W.S. An introduction to the geometry of numbers. Berlin,
1959. Zbl.86,262.
[Cas59b]
Cassels, J.W.S. Arithmetic on curves of genus one.
J. reine u. angew. Math., 202 (1959), 52-99. Zbl.90,30.
[Cas66]
Cassels, J.W.S. (1966): Diophantine equations with special reference to
elliptic curves. J. Lond. Math. Soc., 41 (1966), 193-291. Zbl.138.270.
[Cas78]
Cassels, J.W.S. (1978): Rational quadratic forms. Acad. Press, 1978.
Zbl.395.10029.
[Cas84]
Cassels, J.W.S., Bremner, A., (1984): On the equation y2 = x(x2 + p).
Math. Comput., 42 (1984) 257-264. Zbl.531.10014.
[CF67]
Cassels, J.W.S., Fröhlich, A., eds. (1967): Algebraic Number Theory.
Proc. Int. Congr. Lond. Math. Soc. Washington DC, Thompson, 1967.
Zbl.153,74.
[Ch-LT02] Chambert-Loir, A., Tschinkel, Y.: On the distribution of points of
bounded height on equivariant compactiﬁcations of vector groups. In-
vent. Math. 148 (2002), no. 2, 421-452.
[Cha70]
Chandrasekharan, K. Arithmetical functions. Berlin-Heidelberg-New
York, Springer-Verlag (1970). Zbl.217,316.
[Ch-L01]
Chambert-Loir, A.: Théorèmes d'algébrisation en géométrie diophanti-
enne, d'après J.-B. Bost, Y. André et D & G. Chudnovsky. Séminaire
Bourbaki. [Exposé 886] Mars 2001

468
References
[Chebo25] Chebotarev, N.G. Die Bestimmung der Dichtigheit einer Menge von
Primzahlen, welcher zu einer gegebener Substitutions Klasse gehören.
Math. Annalen, 95 (1925), 151-228. Jbuch FdM 51,149.
[Chebo49] Chebotarev, N.G. Introduction to the theory of algebras (in Russian).
Moscow, OGIZ, 1949. Zbl.38,172.
[Cheby55]
Chebyshev, P.L. Collected Works (in Russian). Moscow: Izdatelstvo
Akad. Nauk SSSR, 1955. Zbl.64,1.
[Chev40]
Chevalley, C. (1940): La théorie du corps de classes. Annals of Math.,
41, 394-418 (1940). Zbl.25,18.
[Chev51]
Chevalley, C. (1951): Deux théorèmes d'arithmétiques. J. Math.Soc.
Japan, 3, 36-44 (1951). Zbl.44,30.
[Cho48]
Chowla, S. (1949): The last entry in Gauss' diary. Proc. Nat. Acad. Sci.
USA, 35, 244-246 (1949). Zbl.32,394.
[ChSe68]
Chowla, S., Selberg A.: On Epstein's zeta-function, Journ. für die reine
und angew. Math. 227, 86 - 110(1967)
[Chu47]
Chudakov, N.G. (1947): Introduction to the theory of the Dirichlet L-
series (in Russian). Moscow, Gostekhizdat (1947). Zbl.41,399.
[Clo86]
Clozel, L. Base change for GL(n). Proc. Int. Congr. Math. Berke-
ley, Calif., Aug. 3-11, 791-797 1986, Vol.1. Providence Rh. I., 1987.
Zbl.666.22004.
[Clo93]
Clozel, L.: Nombre de points des variétés de Shimura sur un corps ﬁni,
d'après R. Kottwitz. Séminaire Bourbaki, Exp. 766, (Mars 1993)
[Coa73]
Coates, J. (1983): On Iwasawa's analogue of the Jacobian for totally real
number ﬁelds. Anal. Number Theory, Missouri 1972. Proc. Symp. Pure
Math. (1973), 51-61. Zbl.279.12006.
[Coa84]
Coates, J. (1984): The work of Gross and Zagier on Heegner points
and the derivatives of L−series. Séminaire Bourbaki, Exp. 633, 1984.
Zbl.608.14020.
[Coa89]
Coates, J.: On p-adic L-functions. Sem. Bourbaki, 40eme annee, 1987-
88, no 701, Asterisque (1989) 177-178.
[Coa01]
Coates, J.: Iwasawa algebras and arithmetic. Séminaire Bourbaki. [Ex-
posé No.896] (Novembre 2001)
[CFKSV]
Coates, J., Fukaya, T., Kato, K., Sujata, R., Venjakob, O.: The GL2 main
conjecture for elliptic curves without complex multiplication. Preprint,
2004.
[CSS03]
Coates, J., Schneider, P ., Sujatha, R.: Links between cyclotomic and
GL2 Iwasawa theory. Kazuya Kato's ﬁftieth birthday. Doc. Math. 2003,
Extra Vol., 187-215 (electronic).
[CW77]
Coates, J., Wiles, A. On the conjecture of Birch and Swinnerton-Dyer.
Invent. Math., 39, no. 3 (1977), 223-251. Zbl.279.12006.
[CoYa97]
Coates, J., Yau, S.T. (Eds.): Elliptic curves, modular forms & Fermat's
last theorem. Proceedings of the Conference on Elliptic Curves and Mod-
ular Forms held at the Chinese University of Hong Kong, Hong Kong,
December 18-21, 1993. Second edition. International Press, Cambridge,
MA, 1997. iv+340 pp.
[CKPShSh] Cogdell, J.W., Kim, H.H., Piatetski-Shapiro, I.I., Shahidi, F.: Functo-
riality for the classical groups. Publ. Math. Inst. Hautes Études Sci. No.
99, (2004), 163-233.

References
469
[CKM04]
Cogdell, J.W., Kim, H.H., Murty, M.: Lectures on automorphic L-
functions. Fields Institute Monographs, 20. American Mathematical So-
ciety, Providence, RI, 2004. xii+283
[CoPSh94] Cogdell, J.W., Piatetski-Shapiro, I.I.: Converse theorems for GLn, Pub-
lications Mathématiques de l'I.H.E.S n 79, 157-214 (1994)
[CoPSh02] Cogdell, J.W., Piatetski-Shapiro, I.I.: Converse theorems, functoriality,
and applications to number theory. Proceedings of the International
Congress of Mathematicians, Vol. II (Beijing, 2002), 119-128, Higher
Ed. Press, Beijing, 2002.
[Coh96]
Cohen, H.: A course in computational algebraic number theory. Grad-
uate Texts in Mathematics, 138. Springer-Verlag, Berlin, 1996. xii+534
pp. Third printing
[Coh2000]
Cohen, H.: Advanced topics in computational number theory , Graduate
Text in Mathematics,193, Springer, January 2000
[CoLe83]
Cohen, H., Lenstra, H. W., Jr. : Heuristics on class groups of number
ﬁelds. Number theory, Noordwijkerhout 1983 (Noordwijkerhout, 1983),
33-62, Lecture Notes in Math., 1068, Springer, Berlin, 1984.
[CoLe84]
Cohen, H., Lenstra, H.W., Jr. (1984): Primality testing and Jacobi sums.
Math. Comput., 42, 297-330 (1984). Zbl.578.10004.
[CM98]
Coleman, R., Mazur, B.: The eigencurve. Galois representations in arith-
metic algebraic geometry (Durham, 1996), 1-113, London Math. Soc.
Lecture Note Ser., 254, Cambridge Univ. Press, Cambridge, 1998.
[CThS80]
Colliot-Thélène J.-L., Sansuc J.-J. (1980): La descente sur les variétés
rationelles. I. Journée de géometrie algébrique, Angers/France, 1979,
(1980), 223-237
[CThS87]
Colliot-Thélène J.-L., Sansuc J.-J. (1987): La descente sur les variétés
rationelles. II. Duke Math. J. 54 (1987), 375-422.
[Colm93]
Colmez P.: Périodes des variétés abeliennes à multiplication complexe,
Ann. of Math. 138 (1993) 625-683
[Colm2000] Colmez, P.: Fonctions L p-adiques. Séminaire Bourbaki. Volume
1998/99. Exposés 850-864. Paris: Société Mathématique de France,
Astérisque. 266, 21-58 [Exposé No.851] (2000). Zbl. 0964.11055
[Colm01]
Colmez, P.: Les conjectures de monodromie p-adiques. Séminaire Bour-
baki. [Exposé No.897] (Novembre 2001)
[Colm03]
Colmez, P.: La conjecture de Birch et Swinnerton-Dyer p-adique. Sémi-
naire Bourbaki. [Exposé No.919] (Juin 2003)
[Co81]
Connes, A.: An analogue of the Thom isomorphism for crossed products
of a C∗-algebra by an action of R, Adv. in Math. 39 (1981), no. 1, 31-55.
[Co83]
Connes, A.: Cyclic cohomology and the transverse fundamental class of
a foliation. In: Geometric methods in operator algebras (Kyoto, 1983).
Pitman Res. Notes in Math., 123, Longman, Harlow 1986, 52-144.
[Co89]
Connes, A.: Compact metric spaces, Fredholm modules, and hyperﬁnite-
ness, Ergodic Theory and Dynamical Systems 9 (1989) 207-220.
[Co94]
Connes A.: Noncommutative geometry, Academic Press, 1994.
[Co95]
Connes A.: Geometry from the spectral point of view. Lett. Math. Phys.
34 (1995), no. 3, 203-238.
[Co96]
Connes A., Formule de trace en Géométrie non commutative et hy-
pothèse de Riemann, C.R. Acad. Sci. Paris Ser. A-B, (1996)
[Co99]
Connes A.: Trace formula in noncommutative geometry and the zeros of
the Riemann zeta function. Selecta Math. (N.S.) 5 (1999), no. 1, 29-106.

470
References
[Co2000]
Connes A.: A short survey of noncommutative geometry, J. Math. Phys.
41 (2000), no. 6, 3832-3866.
[Co2000a]
Connes A.: Noncommutative geometry and the Riemann zeta function.
In: Mathematics: Frontiers and Perspectives, ed. by V. Arnold et al.,
AMS, 2000, 35-54.
[Co03]
Connes, A.: Nombres de Betti L2 et facteurs de type II1, d'après D.
Gaboriau et S. Popa. Séminaire Bourbaki. [Exposé No.920] (Juin 2003)
[CoKr01]
Connes, A., Kreimer, D.: Renormalization in quantum ﬁeld theory and
the Riemann-Hilbert problem. II. The β-function, diﬀeomorphisms and
the renormalization group. Comm. Math. Phys. 216 (2001), N.1, 215-
241.
[CoMar04] Connes, A., Marcolli, M.: From physics to number theory via noncom-
mutative geometry. ArXiv, math.AG/0404128, 2004
[CoMo95]
Connes, A., Moscovici, H.: The local index formula in noncommutative
geometry. Geom. Funct. Anal. 5 (1995), no. 2, 174-243.
[CoMo04]
Connes, A., Moscovici, H.: Modular Hecke algebras and their Hopf sym-
metry, Moscow Mathematical Journal, 4, 67-109 (2004)
[CoMo04a] Connes, A., Moscovici, H.: Rankin-Cohen brackets and the Hopf alge-
bra of transverse geometry. Moscow Mathematical Journal, 4, 111-130
(2004)
[CR01]
Conrad B., Rubin K. (eds.): Arithmetic algebraic geometry (Park City,
UT, 1999), 143-232, IAS/Park City Math. Ser., 9, Amer. Math. Soc.,
Providence, RI, 2001.
[Cons98]
Consani, C.: Double complexes and Euler L-factors, Compositio Math.
111 (1998) 323-358.
[CM]
Consani, C., Marcolli, M.: Noncommutative geometry, dynamics and ∞-
adic Arakelov geometry, preprint ArXiv:math.AG/0205306, to appear in
Selecta Mathematica.
[CM03]
Consani, C., Marcolli, M.: Spectral triples from Mumford curves, Inter-
national Math. Research Notices, 36 (2003) 1945-1972.
[CM04a]
Consani, C., Marcolli, M.: New perspectives in Arakelov geometry. CRM
Proceedings and Lecture Notes 36 AMS (2004), 79-100 CNTA VII Meet-
ing, Montreal May 2002.
[CM04b]
Consani, C., Marcolli, M.: Archimedean Cohomology Revisited. ArXiv,
math.AG/0407480, 2004
[CoNo79]
Conway, J. H., Norton, S.: Monstrous moonshine, Bull. London. Math.
Soc. 11, 308-339 (1979)
[CS86]
Cornell, G., Silvermann, J.H. (eds). Arithmetic Geometry. N.Y. etc;
Springer-Verlag, 1986. Zbl.596.00007.
[CSS95]
Cornell, G., Silverman, J. H., Stevens, G. (eds.) (1995): Modular forms
and Fermat's last theorem. Papers from a conference, Boston, MA, USA,
August 9-18, 1995
[Cor02]
Cornut, Ch.: Mazur's conjecture on higher Heegner points. Invent. Math.
148 (2002), no. 3, 495-523.
[Cre97]
Cremona, J.E. (1997): Algorithms for Modular Elliptic Curves. (2nd
ed.). Cambridge Univ. Press, Cambridge (1997)
[Cu]
Cuntz, J.: A class of C∗-algebras and topological Markov chains II:
reducible chains and the Ext-functor for C∗-algebras, Invent. Math. 63
(1981) 25-40.

References
471
[CuEch01] Cuntz, J., Echterhoﬀ, S.: (eds.) C∗-algebras, Springer Verlag 2001,
pp.182-202.
[CuKrie]
Cuntz, J., Krieger, W.: A class of C∗-algebras and topological Markov
chains, Invent. Math. 56 (1980) 251-268.
[Dalbo]
Dalbo, F.: Codage des géodésiques fermées des quotients de l'espace
hyperbolique
par
un
groupe
libre.
Inﬂuence
des
transformations
paraboliques, Séminaire Gaston Darboux de Géométrie et Topologie Dif-
férentielle, 1994-1995 (Montpellier) iii, 3-19 (1995).
[Da95]
Darmon, H., The Shimura-Taniyama conjecture (d'après Wiles). (In
Russian). Uspekhi Mat. Nauk 50, No. 3(303), 33-82 (1995). English
translation: Russian Math. Surveys 50, No. 3, 503-548 (1995)
[Da99]
Darmon H. (1999): A proof of the full Shimura-Taniyama-Weil conjec-
ture is announced. Notices of the AMS, December 1999, 1397-1401.
[DDT97]
Darmon, H., Diamond, F., Taylor, R. (1995): Fermat's Last Theorem.
In: [CoYa97], pp. 2-140.
[Dav52]
Davenport, H.: The higher arithmetic. London, Hutchinson (1952).
Zbl.49,309.
[Dav58]
Davenport, H. The work of K.E.Roth. Proc. Int. Congr. Math., Edin-
burg, 1958. Cambridge Univ. Press, 1960. Zbl.119,249.
[Dav80]
Davenport, H.: Multiplicative Number Theory. 2nd ed. Berlin - Heidel-
berg - New York, Springer-Verlag (1980). Zbl.453.10002, Zbl.159,63.
[DH34]
Davenport, H., Hasse, H.: Die Nullstellen der Kongruenz Zetafunktion
in gewissen zyklischen Fällen. J. reine u. angew. Math., 172, 151-182
(1934). Zbl.10,338.
[DMR74]
Davis, M., Matiyasevic, Ju., Robinson, J. (1974): Hilbert's tenth prob-
lem. Proc. Symp. Pure Math., Vol.23, 1974, 323-378. Zbl.346.02026.
[Ded69]
Dedekind, R. Mathematische Werke. Vols. I, II. New York: Chelsea,
1969.
[Del68]
Deligne, P. (1968): Formes modulaires et représentations l-adiques.
Séminaire Bourbaki, Exp. 355, 1968/69. Zbl.206,499.
[Del72]
Deligne, P. (1972): Théorie de Hodge II. Publ. Math. IHES, 40 (1972).
5-57. Zbl.219,91.
[Del73]
Deligne, P.: Les constantes des equations fonctionnelles des fonctions L.
Exp. 349, 1973/74. Zbl.271.14011.
[Del74]
Deligne, P.: La conjecture de Weil. I. Pub. Math. IHES, 43 (1974), 273-
307. Zbl.287.14001.
[Del79]
Deligne, P.: Valeurs de fonctions L et périodes d'intégrales. In: [BoCa79],
Part 2, 313-346. Zbl.449.10022.
[Del80a]
Deligne, P. (1980): Sommes de Gauss cubiques et revetements de SL(2),
d'après S. Patterson. In: Lecture Notes in Math., vol. 770, 244-277 (1980)
Zbl.433.10018.
[Del80b]
Deligne, P.: La conjecture de Weil.II. Publ. Math. IHES, vol. 52 (1980).
Zbl.456.14014.
[Del83]
Deligne, P. (1983): Preuve des conjectures de Tate et de Shafarevitch.
Sém. Bourbaki, Exp. 616, 1983/84.
[De-Hu]
Deligne, P., Husemöller, D.: Survey of Drinfel'd modules, Current Trends
in Arithmetical Algebraic Geometry, Contemporary Mathematics, 67
(1987), 25 - 91
[DMOS]
Deligne P., Milne J., Ogus A., Shih K. (1982): Hodge cycles, motives
and Shimura varieties. Lect. Notes Math. 900 (1982).

472
References
[DS75]
Deligne, P., Serre, J.-P.: Formes modulaires de poids 1. Ann. Sci. ENS,
IV ser., 7 (1975), 507-530. Zbl.321.10026.
[DF40]
Delone, B.N., Faddeev, D.K. (1940): Theory of cubic irrationalities. (in
Russian). Steklov Math. Inst. Trudy, 11 (1940). Zbl.61,90.
[DLPvG]
Denef, J., Lipshitz, L., Pheidas, T., van Geel, J. (eds.): Hilbert's tenth
problem: relations with arithmetic and algebraic geometry, American
Mathematical Society, Providence, RI, 2000, Papers from the workshop
held at Ghent University, Ghent, November 2-5, 1999.
[Den91]
Deninger C.: On the Γ-factors attached to motives, Invent. Math. 104
(1991) 245-261.
[Den94a]
Deninger C.: Evidence for a Cohomological Approach to Analytic Num-
ber Theory. First European Math Congress, Vol. 1, 491-510 (1992)
Birkhauser, (1994).
[Den92]
Deninger C.: Local L-factors of motives and regularized determinants.
Invent. Math. 107 (1992), no. 1, 135-150.
[Den94]
Deninger C.: Motivic L-functions and regularized determinants, in "Mo-
tives", Proceedings of Symposia in Pure Mathematics, Vol. 55 (1994)
Part I, 707-743.
[Den01]
Deninger, C.: Number theory and dynamical systems on foliated spaces,
preprint, 2001.
[Des90]
Deshouillers, J.-M.: L'étude des formes cubiques rationnelles via la méth-
ode du cercle, d'après D. R. Heath-Brown, C. Hooley et R. C. Vaughan.
Séminaire Bourbaki, [Exposé No 720], Mars 1990
[Deu68]
Deuring, M.: Imaginäre quadratische Zahlkörper mit der Klassenzahl
Eins. Inv. Math., 5, no.3 (1968), 169-179.
[Dic52]
Dickson, L.E. (1952): History of the Theory of Numbers. Vols. I-III.
Chelsea, 1952.
[DH76]
Diﬃe, W., Hellman, M.E.(1976): New directions in cryptography. IEEE
Trans. Inform. Theory, 22 (1976), 644-654. Zbl.435.94018.
[Dio84]
Diophantus: Arithmetics and Book on Polygonal Numbers.
(in Russian). Nauka, Moscow, 1984.
[Dir68]
Dirichlet, P.G.L., Dedekind, R. (1968): Vorlesungen über Zahlentheorie.
New York -Chelsea (1968). (Reprint 1893)
[Dix84]
Dixon, J.D. (1984): Factorization and primality tests. Amer. Math.
Monthly, 91 (1984), 333-352. Zbl.548.10003.
[DGM90]
Dolan, L., Goddard, P., Montague, P.: Conformal ﬁeld theory, triality
and the Monster group. Phys. Lett. B 236 (1990), no. 2, 165-172.
[DP68]
Dolgachev, I.V., Parshin, A.N.: The diﬀerent and the discriminant of reg-
ular maps. Mat. Zametki, 4 (1968), 519-523. English transl.: Math.Notes
4 (1969), 802-804. Zbl.177,242.
[Dr]
Drinfeld, V.G.: Elliptic modules, I, II. Math.USSR-Sbornik, 23,1976,
561-592; 31, 1977, 159-170
[Dr80]
Drinfeld, V.G. (1980): Langlands' conjecture for GL(2) over functional
ﬁelds. Proc. Int. Congr. Math. Helsinki, 15 −23 Aug., vol. 2 (1980),
565-574. Zbl.444.12004.
[DFI97]
Duke, W., Friedlander, J., Iwaniec, H.: Representations by the Determi-
nant and Mean Values of L-Functions. In Sieve Methods, Exponential
Sums and their Applications in Number Theory, Cambridge University
Press, 109-115, (1997).

References
473
[Dw59]
Dwork, B. (1959): On the rationality of the zeta-function.
Amer. J. of Math., 82 (1959), 631-648. Zbl.173,485.
[Edx95]
Edixhoven S. J., Serre's conjecture. In: [CSS95], pp. 209-241
[Edx2000]
Edixhoven, Bas: Rational elliptic curves are modular, after Breuil, Con-
rad, Diamond and Taylor. Séminaire Bourbaki. [Exposé No.871] Mars
2000
[Edw74]
Edwards, H.M. Riemann's zeta-function. New York, Academic Press,
1974. Zbl.315.10035.
[Edw77]
Edwards, H.M. (1977): Fermat's last theorem. A genetic introduction to
algebraic number theory. New York: Springer-Verlag, 1977. Zbl.355.120-
01.
[Eich54]
Eichler, M. (1954): Quaternäre quadratische Formen und die Rie-
mannsche Vermutung für die Kongruenzzetafunktion. Arch. Math. 5,
No. 4-6, 355-366 (1954). Zbl.59,38.
[Eich73]
Eichler, M. (1973): The basis problem for modular forms and the traces
of the Hecke operators. Lecture Notes in Math., vol. 320, 1973, 75-151.
Zbl.258.10013.
[Eis1847]
Eisenstein, G., Beiträge zur Theorie der elliptischen Funktionen. J. reine
u. angew. Math., 35, 135-274 (1847).
[Elk88]
Elkies, N.D.: On A4 + B4 + C4 = D4. Math. Comput., 51, No. 184,
825-835 (1988). Zbl.698.10010.
[ERS91]
Eskin, A., Rudnick, Z., Sarnak, P.: A proof of Siegel's weight formula.
Internat. Math. Res. Notices 1991, no. 5, 65-69.
[Fal83]
Faltings, G.: Endlichkeitssätze für abelschen Varietäten über Zahlkör-
pern. Inv. Math., 73, No.3 (1983), 349-366. Zbl.588.14026.
[Fal84]
Faltings, G.: Calculus on arithmetic surfaces. Ann. of Math. (2) 119,
no. 2, 387-424 (1984)
[Fal85]
Faltings, G.: Arithmetische Kompaktiﬁzierung des Modulraums der
abelscher Varietäten. In: Lecture Notes in Math., Vol. 1111 (1985), 326-
383. Zbl.597.14036.
[Fal86]
Faltings, G.: Recent progress in arithmetic algebraic geometry. Proc.
ICM, Berkeley, 1986. Zbl.664.14012.
[Fal91]
Faltings, G. (1991): Diophantine approximation on abelian varieties
Ann. Math., II.Ser. 133, No.3 (1991), 549-576. Zbl.734.14007.
[Fal92]
Faltings, G.: Lectures on the arithmetic Riemann-Roch theorem. Notes
taken by Shouwu Zhang. Annals of Mathematics Studies, 127. Princeton
University Press, Princeton, NJ, 1992. x+100 pp.
[Fal98]
Faltings,
G.:
Curves
and
their
fundamental
groups,
following
Grothendieck, Tamagawa and Mochizuki. Séminaire Bourbaki. [Exp.
No.840] Mars 1998
[Fal02]
Faltings, G.: A new application of Diophantine approximations. A
panorama of number theory or the view from Baker's garden (Zürich,
1999), 231-246, Cambridge Univ. Press, Cambridge, 2002.
[FW84]
Faltings, G., Wüstholz, G.: Rational points. Braunschweig, Vieweg,
1984. Zbl.588.14027.
[Fel82]
Feldman, N.I. (1982): The seventh Hilbert problem. (in Russian).
Moscow, MGU (1982). Zbl.515.10031.
[FelNes98] Feldman, N. I.; Nesterenko, Yu. V.: Transcendental numbers. Number
theory, IV, 1-345, Encyclopaedia Math. Sci., 44, Springer, Berlin, 1998.

474
References
[Fer88]
Ferrero, B. (1988): Iwasawa invariants of abelian number ﬁelds. Math.
Ann., 234, No.1, 9-24 (1988). Zbl.347.12004.
[FeWa79]
Ferrero, B., Washington, L.C. (1979): The Iwasawa invariant µ van-
ishes for Abelian number ﬁelds. Ann. Math., 109, No.2, 377-395 (1979)
Zbl.443.12001.
[Fom77]
Fomenko, O.M., (1977): Applications of modular forms to number
theory (in Russian). Moscow, VINITI, Itogi Nauki, 15, 5-91 (1977).
Zbl.434.10018.
[Fon81]
Fontaine, J.M. (1981): Il n'y a pas des variétés abéliénnes sur Z. Inv.
Math., 81, 515-538 (1981). Zbl.612.14043.
[Fon92]
Fontaine, J.M. (1992): Valeurs spéciales des fonctions L des motifs. Sémi-
naire Bourbaki. [Exposé No.751] Février 1992
[FP-R94]
Fontaine, J.M., Perrin-Riou B.(1994): Autour des conjectures de Bloch
et Kato: cohomologie galoisiennes et valeurs de fonctions L. In Motives
(Seattle, WA, 1991), 599-706, Proc. Sympos. Pure Math., 55, Part 1,
Amer. Math. Soc., Providence, RI, 1994]
[Fou85]
Fouvry, E.: Théorème de Brun-Tithchmarsh; application au théorème
de Fermat. Inv. Math., 79, no.2 (1985), 383-407. Zbl.557.10035.
[dFr13]
Franchis, M. de(1913): Un teorema sulle involuzioni irrazionali. Rend.
Circ. Mat. Palermo, 36 (1913), 368. Jbuch FdM 44,657.
[FMTsch]
Franke, J., Manin, Yu.I., Tschinkel, Yu. (1989): Rational points of
bounded height on Fano varieties. Inv. Math., 95 (1989). Zbl.674.14012.
[Fr86a]
Frey, G. (1986): Links between stable elliptic curves and certain dio-
phantine equations. Ann. Univ. Sarav., Ser. Math. 1, No.1, 40 p. (1986)
[Fr01]
Frey, G.: Applications of arithmetical geometry to cryptographic con-
structions. Finite ﬁelds and applications (Augsburg, 1999), 128-161,
Springer, Berlin, 2001.
[Frey86]
Frey, G., (1986): Some aspects of the theory of elliptic curves over num-
ber ﬁelds. Expos. Math., 4, no.1, 35-66 (1986). Zbl.596.14022.
[Fro75]
Fröhlich, A., (1975): Galois module structure and Artin L−functions.
Proc.
Int.
Congr.
Math.
Vancouver,
vol.1,
351-356,
(1975).
Zbl.346.12006.
[Gal01]
Galbraith, S.: Supersingular curves in cryptography. Advances in
cryptology—ASIACRYPT 2001 (Gold Coast), 495-513, Lecture Notes
in Comput. Sci., 2248, Springer, Berlin, 2001.
[GNSh84]
Galochkin, A.I., Nesterenko, Yu.V., Shidlovskii, A.B. (1984): Intro-
duction to Number Theory. (in Russian). Moscow, MGU (1984).
Zbl.537.10001.
[Gal]
Galois, E., (1984): Oeuvres Mathématiques. Paris, Gauthier-Villars.
1897. Jbuch FdM 28,11.
[Gan71]
Gandhi, J.M., (1984): Formulae for the n−th prime. Proc. Washing-
ton State Univ. Conf. on Number Theory. Washington State University,
Pullman, 96-106 (1971). Zbl.228.10004.
[GJ79]
Garey, M.R., Johnson, D.S. (1979): Computers and intractability: A
Guide to the theory of NP−completeness. San Francisco, Freeman,
(1979). Zbl.411.68039
[Gau]
Gauss, C.-F. (1966): Disquisitiones Arithmeticae. Yale University Press
(1966). Zbl.136,323.
[Gel75]
Gelbart, S.(1975): Automorphic forms on adèle groups. Ann. Math.
Stud., 83, (1975). Zbl.329.10018.

References
475
[Gel76]
Gelbart, S. (1976): Elliptic curves and automorphic representations.
Adv. Math., 21, No.3, 235-292 (1976). Zbl.336.14003.
[Gel77]
Gelbart, S. (1977): Automorphic forms and Artin's conjecture. Lecture
Notes in Math., vol. 627, 241-276 (1977). Zbl.368.10023.
[Gel95]
Gelbart, S. (1995): Three lectures on the modularity of ρE,3 and the
Langlands reciprocity conjecture. In: [CSS95], 153-207
[GPShR87] Gelbart, S., Piatetski-Shapiro, I., Rallis, S. (1987): Explicit construc-
tions of automorphic L−functions. Lecture Notes in Math., vol. 1254,
1-152 (1987). Zbl.612.10022.
[Ge73]
Gelfond, A.O. (1973): Collected Works (in Russian). Moscow, Nauka
(1973). Zbl.275.01022.
[Ge83]
Gelfond, A.O.: Integer solutions of equations. (in Russian). Moscow:
Nauka (1983). Zbl.557.10014, Zbl.48,28.
[Gil95]
Gilkey, P.B.: Invariance Theory, the Heat Equation, and the Atiyah-
Singer Index Theorem. Studies in Adv. Mathematics, Second Edition.
CRC Press, (1995).
[GS84]
Gillet, H., Soulé, C. (1984): Intersection sur les variétés d'Arakelov. C.R.
Ac. Sci. Paris, 299, Ser. 1, no. 12, (1984), 563-566. Zbl.607.14003.
[GS85]
Gillet H., Soulé C. (1985): Classes caractéristiques en théorie d'Arakelov.
C.R. Acad. Sci., Paris, Ser.I 301 (1985), 439-442.
[GS91]
Gillet, H., Soulé, C. (1991): Analytic torsion and arithmetic Todd genus,
with an Appendix by D. Zagier, Topology 30 , 21-54 (1991)
[GS92]
Gillet, H., Soulé, C. (1992): An arithmetic Riemann-Roch theorem. In-
vent. Math. 110 (1992), no. 3, 473-543.
[Gin85]
Gindikin, S.G. (1985): Essays about mathematicians and physicists.
(in Russian). Moscow: Nauka, 1985. English transl.: Boston/Basel:
Birkhäuser, 1988. Zbl.566.01011.
[Gö]
Gödel K. (1931): Über formal unentscheidbare Sätze der Principia math-
ematica und verwandter Systeme I. Monatshefte für Math. und Physik
38 (1931), 173-198.
[Gol76]
Goldfeld, D.M. (1976): The class number of quadratic ﬁelds and conjec-
tures of Birch and Swinnerton-Dyer. Ann. Scuola Norm. Sup. Pisa, 3,
no.4, 623-663 (1976). Zbl.345.12007.
[Gol85]
Goldfeld, D.M. (1985): Gauss class number problem for imaginary
quadratic ﬁelds. Bull. AMS, 13 (1985), 23. Zbl.572.12004.
[Gol94]
Goldfeld D., A spectral interpretation of Weil's explicit formula, Lecture
Notes in Math., 1593, Springer Verlag (1994), 135-152.
[G(ed.)86] Goldstein, C. (ed). (1986): Séminaire de la théorie de nombres. Paris,
1984-85. Boston etc., Birkhäuser (1986). Zbl.593.00007.
[GoYi03]
Goldston, D., Yildirim C.Y.: Higher correlations of divisor sums related
to primes, I: Triple correlations, Integers 3, A5, 66 pp. (2003)
[Go02]
Goldwasser, S.: Mathematical foundations of modern cryptography:
computational complexity perspective. In: [ICM02]
[GK86]
Goldwasser, S., Kilian, J. (1984): A probably correct and probably fast
primality test. Preprint MIT, 1985. Proc. 18th Ann. ACM Symp. on the
Theory of Comp. (STOC): Berkeley, May 28-30, 1986.
[GK99]
Goldwasser, S., Kilian, J. (1999): Primality testing using elliptic curves.
J. ACM 46 (1999), no. 4, 450-472.

476
References
[GF77]
Golubeva, E.P., Fomenko, O.M. (1977): On the zeta-function of a system
of forms. (in Russian). Zapiski Nauchn. Sem. LOMI, 67 (1977), 156-166.
English transl.: J.Sov.Math. 16 (1981), 866-870. Zbl.364.10013.
[Goo96]
Goode, J. B.: H. L. M. (Hrushovski-Lang-Mordell) Séminaire Bourbaki.
[Exp. No.811] Février 1996
[Gou94]
Gouvêa, F.: A marvelous proof, Amer. Math. Monthly 101, no. 3, 203-
222 (1994).
[Gow01]
Gowers, T.: A new proof of Szemerédi's theorem, GAFA 11, 465-588
(2001).
[GM]
Granville, A., Monagan M.B. (1988): The ﬁrst case of Fermat's last
theorem is true for all prime exponents up to 714 591 416 091 389.
Trans. AMS, 306, No. 1, 329-359. Zbl.645.10018.
[GR71]
Grauert, H. , Remmert, R. : Analytische Stellenalgebren. Unter Mitar-
beit von O. Riemenschneider. Grundlehren der mathematischen Wis-
senschaften 176. Springer: Berlin-Heidelberg-New York (1971).
[Gram98]
Gramain, F.: Quelques résultats d'indépendance algébrique. Proceedings
of the International Congress of Mathematicians, Vol. II (Berlin, 1998).
Doc. Math. 1998, Extra Vol. II, 173-182 (electronic).
[Gr83]
Greenberg, R. (1983): On the Birch-Swinnerton-Dyer conjecture. Inv.
Math., 72, No.2, 241-266 (1983). Zbl.546.14015.
[GrTa]
Green, B.J., Tao, T.: The primes contain arbitrary long arithmetic pro-
gressions, preprint. ArXiv math.OA/0404188, 8 Apr 2004
[GZ86]
Gross, B.H., Zagier, D.B. (1986): Heegner points and derivatives of
L−series. Inv. Math., 84, 225-320 (1986). Zbl.608.14019.
[GKZ87]
Gross, B.H., Kohnen, W., Zagier, D.B. (1987): Heegner points and
derivatives of L−series.II. Math. Ann., 278, No. 1-4, 497-562 (1987).
Zbl.641.14013.
[Gr84]
Grosswald, E. (1984): Topics from the theory of numbers. 2nd ed.
Birkhäuser, 1984. Zbl.532.10001.
[GrothF]
The Grothendieck Festschrift: Cartier P., Illusie L., Katz N.M., Laumon
G., Manin Yu., Ribet K.A. eds. (1990) The Grothendieck Festschrift.
Vols I-III (1990)
[Gui77]
Guillemin, V.: Lectures on spectral theory of elliptic operators, Duke
Math. J., 44, No.3 (1977), 485-517
[GuS77]
Guillemin, V., Sternberg, S.: Geometric asymptotics, Math. Surveys, 14,
Amer. Math. Soc., Providence, R.I. (1977)
[GNA]
Guillén, F., Navarro Aznar, V.: Sur le théorème local des cycles invari-
ants. Duke Math. J. 61 (1990), no. 1, 133-155.
[Gu81]
Guy, R.K. (1984): Unsolved problems in number theory (Problem books
in Mathematics). Berlin etc., Springer-Verlag (1981). Zbl.474.10001.
[Har90]
Haran S.: Riesz potentials and explicit sums in arithmetic, Invent. Math.,
101 (1990), 697-703.
[HaSk02]
Harari, D., Skorobogatov, A. N.: Non-abelian cohomology and rational
points. Compositio Math. 130, no. 3, 241-273 (2002).
[HaWr]
Hardy, G.H., Wright, E.M. (1979): An introduction to the theory of
numbers, 5th ed. Oxford Univ. Press, 1979. Zbl.58,33.
[Ha98]
Harris, M.: The local Langlands conjecture for GL(n) over a p- adic ﬁeld,
n < p, Invent. Math. 134 (1998), 177-210.
[HaTsch]
Harris, J., Tschinkel, Y.: Rational points on quartics. Duke Math. J.
104, no. 3, 477-500 (2000).

References
477
[Ha77]
Hartshorne, R. (1977): Algebraic geometry. New York, Springer Verlag
(1977). Zbl.367.14001.
[Ha50]
Hasse, H. (1950): Vorlesungen über Zahlentheorie. Berlin, Springer Ver-
lag (1950). Zbl.38,17. 2nd ed. 1964.
[Ha37]
Hasse, H. (1937): The Riemann hypothesis in function ﬁelds. C. R.
Congr. Int. Math. 1 (1937), 189-206 Philadelphia: Pennsylvania State
University Press (1989). Zbl.18,343.
[Haz78]
Hazewinkel, M. (1978): Formal groups and applications. Acad. Press,
1978. Zbl.454.14020.
[HB84]
Heath-Brown, D.R. (1984): Cubic forms in 10 variables. Lecture Notes
in Math., vol. 1068, 104-108 (1984). Zbl.538.10021.
[HB86]
Heath-Brown, D.R. (1986): Artin's conjecture for primitive roots. Quart.
Journ. of Math., 37, 27-38 (1986). Zbl.586.10025.
[HB88]
Heath-Brown, D.R. (1988): The number of primes in a short interval. J.
reine u. angew. Math., 389, 22-63 (1988). Zbl.646.10032.
[HBP79]
Heath-Brown, D.R., Patterson, S.J. (1979) The distribution of Kummer
sums at prime arguments. J. reine u. angew. Math., 130, 111-130 (1979).
Zbl.412.10028.
[He29]
Hecke, E. (1929) Algebraische Zahlentheorie. Leipzig. Reprint by Chelsea
Publ. Comp. Inc. New York, 1929. Jbuch FdM 49,106.
[He59]
Hecke,
E.
Mathematische
Werke.
Göttingen:
Vandenhoeck
und
Ruprecht, 1959. Zbl.92,1.
[Hee52]
Heegner, H. (1952): Diophantische Analysis und Modulfunktionen.
Math. Zeitschrift, 56, 227-253 (1952). Zbl.49,162.
[He97]
Hellegouarch, Y. (1997): Invitation aux mathématiques de Fermat-
Wiles. Enseignement des Mathématiques. Paris: Masson. vii, 397 p.
(1997)
[Hel79]
Hellman, M.E. The mathematics of public-key cryptography. Sci. Am.,
241, 146-157 (1979).
[Hen76]
Henniart, G.: Une forme icosaèdrale de poids 1. Sém. Délange-Pisot-
Poitou. Théor. de Nombres, Univ. Pierre et Marie Curie, 1976-77, 18,
No.2, 24/01-24/07. Zbl.367.10021.
[Hen86]
Henniart, G.: On the local Langlands conjecture for GL(n): the cycle
case, Annals of Mathematics 123, 145-203 (1986)
[Hen01]
Henniart, G.: Progrès récents en fonctorialité de Langlands. Séminaire
Bourbaki. [Exposé No.890] (Juin 2001)
[Hi93]
Hida H. (1993): Elementary theory of L-functions and Eisenstein series,
London Mathematical Society Student Texts. 26 Cambridge University
Press
[Hi02]
Hida H.: The Iwasawa µ-invariant of p-adic Hecke L-functions, preprint,
2002, http://www.math.ucla.edu/˜hida
[Hil1900]
Hilbert, D. (1900): Mathematical problems. ICM, Paris, 1900. In: Math.
Developments arising from Hilbert Problems. Proc. Symp. Pure Math.
AMS, 28, 1-34 (1976).
[Hil1897]
Hilbert, D. (1897): Die Theorie der algebraischer Zahlkörper. J.-ber.
Deutsch. Math. Verein. 4, 175-546 (1897) Gesammelte. Abh. New York:
Chelsea (1965) 63-363. (1932) Springer-Verlag. Zbl.4,98.
[Hild86]
Hildebrand, A. (1986): On the number of positive integers > x and free of
prime factors > y. J. Number Theory, 22, 289-307 (1986). Zbl.575.10038.

478
References
[Hild88]
Hildebrand, A. (1988): Gaps between prime numbers. Proc. AMS, 104,
No.1 (1988), 1-9. Zbl.663.10046.
[Hir88]
Hiramatsu Toyokazu, Theory of automorphic forms of weight 1. Adv.
Stud. Pure Math., Vol. 13 Invest. Number Theory. Tokyo, 1988, 32-98.
Zbl.658.10031.
[Hoo]
Hooley, Ch. Applications of the sieve methods in the theory of numbers.
Cambridge Tracts in Mathematics, No. 70. Cambridge University Press,
Cambridge-New York-Melbourne, 1976. Zbl.327.10044.
[H88]
Hooley, Ch. (1988): On nonary cubic forms. J. reine u. angew. Math.,
386, 32-98 (1988). Zbl.641.10019.
[Hri85]
Hriljac, P. (1985): Heights and Arakelov's intersection theory. Amer. J.
Math., 107, No. 1, 23-38 (1985). Zbl.593.14004.
[Hua59]
Hua Loo-Keng (1959): Abschätzungen von Exponentialsummen und
ihre Anwendungen in der Zahlentheorie. Leipzig, Teubner, 1959.
Zbl.83,36.
[HW81]
Hua Loo-Keng, Wang, L.: Application of number theory to numerical
analysis. Berlin etc., Springer (1981). Zbl.451.10001.
[Huls94]
Hulsbergen, W.W.J.: Conjectures in Arithmetic Algebraic Geometry. A
Survey. Second revised ed., AMS, 1994 Zbl.0793.14011
[Hur63]
Hurwitz, A. Mathematische Werke. Bd. II. Basel und Stuttgart,
Birkhäuser Verlag, 1963. Zbl.122,241.
[ICM94]
Proceedings of the International Congress of Mathematicians. Vol. 1, 2.
Held in Zürich, August 3-11, 1994. Edited by S. D. Chatterji. Birkhäuser
Verlag, Basel, 1995. Vol. 1: lxxii+717 pp.; Vol. 2: pp. i-xiii and 718-1605.
[ICM98]
Proceedings of the International Congress of Mathematicians. Vol. I.
Invited plenary lectures. Appendix. Held in Berlin, August 18-27, 1998.
Doc. Math. 1998, Extra Vol. I. Documenta Mathematica, Bielefeld, 1998.
front matter and pp. 1-662 (electronic).
[ICM02]
Proceedings of the International Congress of Mathematicians. Vol. I.
Plenary lectures and ceremonies. Held in Beijing, August 20-28, 2002.
Edited by Tatsien Li. With 1 CD-ROM [Windows]. Higher Education
Press, Beijing, 2002. x+657 pp.
[IRS(e)89] Ihara Y., K.Ribet, Serre J.-P. eds. (1989) Galois Groups over Q. Berlin-
Heidelberg-New York, Springer-Verlag (1989).
[Ing]
Ingham, A.E. (1932): Distribution of Prime Numbers. Cambrige
Univ.Press (1932) (Reprint (1990)) Zbl.6,397
[Ire82]
Ireland, K., Rosen, M. (982): A classical introduction to modern number
theory. Berlin etc.: Springer Verlag (1982). Zbl.482.10001.
[Isk70]
Iskovskih, V.A. (1970): A counterexample to the Hasse principle for
the system of two quadratic forms of ﬁve variables. (in Russian). Mat.
Zametki, 10, 253-257 (1970). English transl.: Math.Notes 10, 575-577
(1972). Zbl.232.10015.
[Isk77]
Iskovskih, V. A.: Fano threefolds. I. (Russian) Izv. Akad. Nauk SSSR
Ser. Mat. 41 (1977), no. 3, 516-562, 717. (Reviewer: Miles Reid)
[Isk78]
Iskovskih, V. A.: Fano threefolds. II. (Russian) Izv. Akad. Nauk SSSR
Ser. Mat. 42 (1978), no. 3, 506-549.
[Iw87]
Iwaniec, H. (1987): Spectral theory of automorphic functions and recent
developments in analytic number theory. Proc. ICM Berkeley, Vol. 1,
444-456 (1987). Zbl.663.10027.

References
479
[Iw97]
Iwaniec, H. (1997): Topics in classical automorphic forms. Graduate
Studies in Mathematics, 17. American Mathematical Society, Provi-
dence, RI, 1997. xii+259 pp.
[IwSa99]
Iwaniec, H., Sarnak, P.: Perspectives on the analytic theory of L-
functions. GAFA 2000 (Tel Aviv, 1999). Geom. Funct. Anal. 2000, Spe-
cial Volume, Part II, 705-741.
[Iwa72]
Iwasawa, K. (1972): Lectures on p-adic L-functions. Ann. Math. Stud.
74 (1972). Zbl.236.12001.
[Iwa75]
Iwasawa, K. (1975): A note on Jacobi sums. Symp. Math., 15 (1975),
447-459. Zbl.324.12007.
[Iw86]
Iwasawa K. (1986): Local Class Field Theory. Oxford University Press
(translation from Japanese), 1986. Russian translation: Moscow, Mir,
1984.
[Iw01]
Iwasawa K.: Collected papers. Vol. I, II. Edited and with a preface
by Ichiro Satake, Genjiro Fujisaki, Kazuya Kato, Masato Kurihara and
Shoichi Nakajima. With an appreciation of Iwasawa's work in algebraic
number theory by John Coates. Springer-Verlag, Tokyo, 2001. Vol. I:
xxii+464 pp.; Vol. II: pp. i-vi and 465-880.
[JL70]
Jacquet, H. Langlands, R.P. (1970): Automorphic forms on GL(2). Lec-
ture Notes in Math., 114 (1970). Zbl.236.12010.
[JPShS]
Jacquet, H., Piatetski-Shapiro I.I., Shalika, J.A. (1979): Automor-
phic forms on GL(3). I. Ann. of Math., 109, No.1, 169-212 (1979).
Zbl.401.10037.
[JSh]
Jacquet, H., Shalika, J.A. (1976): A non-vanishing theorem for zeta
functions of GLn . Inv. Math., 38, No.1, 1-16 (1976). Zbl.349.12006.
[Sh81]
Jacquet, H., Shalika, J.A. (1981): On Euler products and the classiﬁca-
tion of automorphic forms. Amer. J. Math., 103, No. 4, 777-815 (1981).
Zbl.491.10020.
[Ja90]
Jannsen U. (1990): Mixed Motives and Algebraic K-Theory, Lect. Notes
Math. 1400 (1990).
[JSWW76] Jones, J.P., Sato, D., Wada, H., Wiens, D. (1979): Diophantine repre-
sentation of the set of prime numbers. Amer. Math. Monthly, 83, No.6,
449-464 (1976). Zbl.336.02037.
[Jul90]
Julia B.: Statistical theory of numbers, Number Theory and Physics,
Springer Proceedings in Physics, 47 (1990).
[Kac59]
Kac, M.: Statistical Independence in Probability, Analysis and Number
Theory, Carus Math. Monographs 18 (1959)
[Kac78]
Kac, V.G. (1978): Inﬁnite-dimensional algebras, Dedekind η−function,
classical Möbius function and very strange formula. Adv. Math., 30,
85-136 (1978). Zbl.391.17010.
[Kah71]
Kahn, D. (1979): The Codebreakers, the story of secret writing. Macmil-
lan (1971).
[Kar75]
Karacuba, A.A. (1975): Introduction to the analytical number theory
(in Russian). Moscow, Nauka (1975). Zbl.428.10019. English transl. of
the 2nd edition: Basic Analytic Number Theory. Berlin-Heidelberg-New
York: Springer-Verlag, 1993. Zbl.767.11001.
[Kar85]
Karacuba, A.A. (1985): On the function G(n) in Waring's problem. (in
Russian). Izv. Akad. Nauk SSSR, Ser. mat., 49, No.5 (1985), 935-947.
English transl.: Math.USSR, Izv.27 (1986), 239-249. Zbl.594.10041.

480
References
[Kas]
Kasparov, G.G.: K-theory, group C∗-algebras, and higher signatures
(Conspectus). Novikov conjectures, index theorems and rigidity, Vol. 1
(Oberwolfach, 1993), 101-146, London Math. Soc. Lecture Note Ser.,
226, Cambridge Univ. Press, 1995.
[Kato99]
Kato, K.: Euler systems, Iwasawa theory, and Selmer groups. Kodai
Math. J. 22 (1999), no. 3, 313-372.
[Kato2000] Kato, K.: Tamagawa number conjecture for zeta values. Proceedings of
the International Congress of Mathematicians, Vol. II (Beijing, 2002),
163-171, Higher Ed. Press, Beijing, 2002.
[KKS2000] Kato, K., Kurokawa, N., Saito, T.: Number Theory I: Fermat's Dream.
Translations of Mathematical Monographs, Vol. 186, AMS, xv+154 pp.
[Kat76]
Katz, N.M. (1976): An overview of Deligne's proof of the Riemann hy-
pothesis for varieties over ﬁnite ﬁelds. Proc. Symp. Pure Math., 28,
275-305 (1976). Zbl.339.14013.
[Kat88]
Katz, N.M. (1988): Gauss sums, Kloostermann sums and monodromy
group. Princeton Univ. Press (1988). Zbl.675.14004.
[KL85]
Katz, N.M., Laumon G. (1985): Transformation de Fourier et majora-
tion de sommes exponentielles. Publ. Math. IHES, 62, 361-418 (1985).
Zbl.603.14015.
[KS99]
Katz, N., Sarnak, P.: Random matrices, Frobenius eigenvalues, and mon-
odromy. American Mathematical Society Colloquium Publications, 45.
American Mathematical Society, Providence, RI, 1999. xii+419 pp.
[KS99a]
Katz, N., Sarnak, P.: Zeroes of zeta functions and symmetry. Bull. Amer.
Math. Soc. (N.S.) 36, no. 1, 1-26 (1999).
[Khi78]
Khinchin, A.Ya. (1978): Continuous fractions. (in Russian). Moscow:
Nauka (1978). Zbl.117,286.
[Khi79]
Khinchin, A. Ya. (1979): Three gems of number theory. (in Russian).
Moscow: Nauka (1979). German transl. (Reprint): Frankfurt/Main 1984.
Zbl.42,40; Zbl.539.10002.
[KiSha99]
Kim, H., Shahidi, F.: Symmetric cube L-functions for GL2 are entire,
Annals of Math. 150 (1999), 645-662.
[Kli62]
Klingen H.: Uber die Werte Dedekindscher Zetafunktionen . Math. Ann.
145, 265-272 (1962)
[Knu81]
Knuth, D.E. (1981): The art of computer programming. Vol 2. Semi-
numerical algorithms. 2nd edition. Addison-Wesley, Reading (1981).
Zbl.477.65002.
[Kob77]
Koblitz, N. (1977): p−adic numbers, p−adic analysis and zeta-functions.
New York: Springer Verlag (1977). Zbl.364.12015.
[Kob80]
Koblitz, N. (1980): p−adic analysis: a short course on recent work.
London Math. Soc. Lecture Note Ser., London: Cambridge Univ. Press
(1980).
[Kob82]
Koblitz, N. (1982): Why study equations over ﬁnite ﬁelds? Math. Mag.,
55, 144-149 (1982). 1980. Zbl.439.12011
[Kob84]
Koblitz, N. (1984): Introduction to elliptic curves and modular forms.
New York: Springer Verlag, 1984. Zbl.553.10019.
[Kob87]
Koblitz, N. (1987): A course of number theory and cryptography. New
York: Springer Verlag, 1987. Zbl.648.10001.
[Kob94]
Koblitz, N.: A course in number theory and cryptography. Second edi-
tion. Graduate Texts in Mathematics, 114. Springer-Verlag, New York,
1994. x+235 pp.

References
481
[Kob2000] Koblitz, N.: A survey of number theory and cryptography. Number the-
ory, 217-239, Trends Math., Birkhäuser, Basel, 2000.
[Kob98]
Koblitz, N. (1998): Algebraic aspects of cryptography, Algorithms and
Computation in Math., 3, Springer-Verlag, Berlin, 1998.
[Kob01]
Koblitz, N.: Cryptography. Mathematics unlimited—2001 and beyond,
749-769, Springer, Berlin, 2001.
[Kob02]
Koblitz, N. (2002): Good and bad uses of elliptic curves in cryptography.
Mosc. Math. J. 2 (2002), no. 4, 693-715, 805-806.
[Koch70]
Koch, H.V. (1970): Galoische Theorie der p−Erweiterungen. Berlin
VEB, Deutscher Verlag d. Wiss, 1970. Zbl.216,47.
[Koch87]
Koch, H.V. (1986): Unimodular lattices and self−dual codes. Proc. ICM
Berkeley, 1986, vol. 1, 457-465, Berkeley (1987). Zbl.668.10039.
[Koch97]
Koch, H.: Algebraic number theory. Translated from the 1988 Russian
edition Number Theory II. Reprint of the 1992 translation. Springer-
Verlag, Berlin, 1997. iv+269 pp.
[Kog71]
Kogan, L.A. (1971): On the representation of integers by positively de-
ﬁned quadratic forms. (in Russian). Tashkent: Fan, 1971. Zbl.227.10015.
[Kol69]
Kolmogorov, A.N. (1969): On the logical foundations of the informa-
tion theory and probability theory. (in Russian). Probl. Teorii Peredachi
Informacii, 5, No.3 (1969), 3-7. Zbl.265.94010.
[Koly79]
Kolyvagin, V.A. (1979): Formal groups and the norm residue symbol. (in
Russian). Izv. Akad. Nauk SSSR, Ser. mat., 43, no.5, 1054-1120 (1979)
English transl.: Math.USSR, Izv. 15 (1980) 289-348. Zbl.429.12009.
[Koly88]
Kolyvagin, V.A. (1988): Finiteness of E(Q) and X(E, Q) for a class of
Weil's curves. (In Russian). Izv. Akad. Nauk SSSR, ser. mat. 52, No.
3 (1988), 522-540.English transl.: Math.USSR, Izv. 32 (1989) 523-541.
Zbl.662.14017.
[Koly90]
Kolyvagin V.A. (1990): Euler systems. In: The Grothendieck Festschrift
(1990), Vol. II, 435-484.
[dKL89]
de Koninck J.-M., Levesque Cl. (1989): Théorie de nombres. Number
Theory. de Gruyter (1989).
[Kon96]
Kontsevich, M. Product formulas for modular forms on O(2,n), after R.
Borcherds. Séminaire Bourbaki. Exp. No.821 (Novembre 1996)
[KoZa01]
Kontsevich M., Zagier, D.: Periods, Mathematics Unlimited-2001 and
Beyond, Springer, Berlin, 2001, pp. 771-808.
[Kor89]
Korobov, N.M. (1989): Exponential sums and their applications. (in
Russian). Moscow, Nauka (1989). English transl.: Dordrecht: Kluwer
1992. Zbl.665.10026.
[Kott88]
Kottwitz, R. (1988): Tamagawa numbers. Ann. of Math., 127, 629-646
(1988) Zbl.678.22012.
[KMP74]
Kozmidiadi V.A., Maslov A.N., Petri V.N. eds.(1974): Complexity of
computations and algorithms. (in Russian). Kozmidiadi V.A., Maslov
A.N., Petri V.N. eds. Moscow, Mir (1974). Zbl.286.00008.
[Kr26]
Kraitchik, M. (1926): Théorie des Nombres. Vol. 2. Paris, Gauthier-
Villars (1926). Jbuch FdM 52,137.
[Kr86]
Kranakis, E. (1986): Primality and Cryptography. John Wiley and Sons
(1986). Zbl.595.10001.
[Kr1863]
Kronecker L. (1863): Auﬂösung der Pellschen Gleichung mittels elliptis-
cher Funktionen. Monatberichte der Königlichen Preuss. Akademie der

482
References
Wissenschaften zu Berlin, (1863), 44-50 (= Kronecker L., Werke. Band
4, 219-225)
[Kub69]
Kubota, T. (1969): On automorphic functions and the reciprocity law in
a number ﬁeld. Lect. Mat. Dept. Math. Kyoto Univ., No. 2, Kinokuhiya
bookstore Co., Tokyo (1969). Zbl.231.10017.
[KuLe64]
Kubota, T., Leopoldt, H.-W. (1964): Eine p−adische Theorie der Zetaw-
erte. I. J. reine u. angew. Math., 214/215, 328-339 (1964). Zbl.186,91.
[Ku2000]
Kudla, St. S.: Derivatives of Eisenstein series and generating functions
for arithmetic cycles. Séminaire Bourbaki. [Exposé No.876] (Juin 2000)
[Kum75]
Kummer, E.E. (1975): Collected papers. Vol. 1. New York: Springer
Verlag (1975). Zbl.327.01019.
[Kur91]
Kurokawa, N.: Multiple sine functions and Selberg zeta functions, Proc.
Jap. Acad, Sci., Ser. A, 67, no. 3 (1991), 61-64
[Kuz84]
Kuzmin, L.V. (1984): Fields of algebraic numbers. (In Russian). ,
Moscow: VINITI, Itogi Nauki, 22, 117-204 (1984). English transl.:
J.Sov.Math. 38 (1987), 1930-1988. Zbl.621.12002.
[Lab86]
Labesse,
J.-P.
(1986):
La
formule
des
traces
d'Arthur-Selberg.
Astérisque, 133-134, 73-88 (1986). Zbl.592.22011.
[Laﬀ02]
Laﬀorgue, L.: Chtoucas de Drinfeld et correspondance de Langlands.
Invent. Math. 147 (2002), no. 1, 1-241.
[Lan97]
Landi, G.: An introduction to noncommutative spaces and their geome-
tries, Lecture Notes in Physics, Vol. m-51, Springer Verlag 1997.
[La58]
Lang S. (1958): Abelian Varieties. New York: Interscience, 1958.
Zbl.98,132.
[La60]
Lang S. (1960): Integral points on curves. Publ. Math. Inst. Hautes Etud.
Sci. 6 (1960), 27-43. Zbl.112,134.
[La62]
Lang, S. (1962): Diophantine Geometry. New York, Interscience (1962).
Zbl.115,387.
[La64a]
Lang, S.(1964a): Les formes bilinéaires de Néron et Tate. Sém. Bourbaki,
Exp. 274 (1964). Zbl.138,421.
[La64b]
Lang, S. (1964b): Algebraic numbers. Reading, Mass.: Addison- Wesley
(1964). Zbl.193,347.
[La65]
Lang, S. (1965): Algebra. Reading, Mass.: Addison-Wesley (1965).
Zbl.211, 385.
[La70]
Lang S. (1970): Algebraic Number Theory. Reading, Mass.: Addison-
Wesley, 1970. Zbl.211, 385.
[La72]
Lang, S. (1972): Introduction to algebraic and Abelian functions. New
York, Springer (1973). Zbl.255.14001. 2nd ed.: New York - Berlin - Hei-
delberg: Springer-Verlag, 1982.
[La73/87]
Lang, S. (1973): Elliptic functions. Reading, Mass.: Addison-Wesley
(1973). Zbl.316. 14001. Second Edition: New York - Berlin - Heidelberg:
Springer-Verlag, 1987.
[La76]
Lang S. (1976): Introduction to Modular Forms. New York - Berlin -
Heidelberg: Springer-Verlag, 1976. Zbl.316.10011.
[La78a]
Lang, S. (1978a): Elliptic curves. Diophantine Analysis. Berlin etc.:
Springer-Verlag, 1978. Zbl.388.10001.
[La78b]
Lang, S. (1978b): Cyclotomic ﬁelds. New York e.a., Springer-Verlag
(1978). Zbl.395.12005.
[La83]
Lang, S. Fundamentals of Diophantine Geometry. New York: Springer-
Verlag (1983). Zbl.528.14013.

References
483
[La88]
Lang, S. Introduction to Arakelov Theory. Springer-Verlag (1988).
Zbl.667.14001.
[La90]
Lang, S.: Cyclotomic ﬁelds I and II, Combined second edition, Springer,
New York, 1990;
[La90a]
Lang, S.: Old and new conjectured Diophantine inequalities. Bull. Amer.
Math. Soc. (N.S.) 23 (1990), no. 1, 37-75.
[La91]
Lang, S.: Number theory. III. Diophantine geometry. Encyclopaedia of
Mathematical Sciences, 60. Springer-Verlag, Berlin, 1991. xiv+296 pp.
[LaTa]
Lang, S., Tate, J. Principal homogeneous spaces over Abelian varieties.
Amer. J. Math., 80, 659-684 (1958). Zbl.97,362.
[LaTr76]
Lang, S., Trotter, H.: Frobenius distributions in GL2-extensions. Dis-
tribution of Frobenius automorphisms in GL2-extensions of the ratio-
nal numbers. Lecture Notes in Mathematics, Vol. 504. Springer-Verlag,
Berlin-New York, 1976. iii+274 pp.
[LaWe]
Lang, S. Weil, A.: Number of points of varieties in ﬁnite ﬁelds. Amer. J.
Math., 76 (1954), 819-827. Zbl.97,362.
[L71a]
Langlands R.P. (1971a): Euler Products. Whittemore Lectures in Math-
ematics, 1971. Yale University Press, 1971. Zbl.231.20016
[L71b]
Langlands R.P. (1971b): On Artin's L-functions. Rice Univ. Studies 56
(1971), 23-28. Zbl.245.12011.
[L76]
Langlands R.P. (1976): On the functional equations satisﬁed by Eisen-
stein series. Lect. Notes Math. 544 (1976). Zbl.332.10018.
[L79]
Langlands, R. P. : Automorphic representations, Shimura varieties,
and motives. Ein Märchen. Automorphic forms, representations and L-
functions (Proc. Sympos. Pure Math., Oregon State Univ., Corvallis,
Ore., 1977), Part 2, pp. 205-246, Proc. Sympos. Pure Math., XXXIII,
Amer. Math. Soc., Providence, R.I., 1979.
[L80]
Langlands R.P. (1980): Base change for GL(2). Ann.Math.Stud. 96,
Princeton University Press (1980). Zbl.444.22007.
[L02]
Langlands R.P.: Featured Review MR1875184 (2002m:11039) on [Laﬀ02]
[LRS93]
Laumon, G., Rapoport, M., Stuhler, U.: D-elliptic sheaves and the Lang-
lands correspondence, Invent. Math. 113, no. 2, 217-338 (1993)
[Lau02]
Laumon, G.: The work of Laurent Laﬀorgue. In: [ICM02], pp. 91-97
[LeV77]
Le Veque, W.J. (1977): Fundamentals of number theory. Reading, Mass.,
Addison-Wesley (1977). Zbl.368.10001.
[Lee02]
Lee, Y.: Cohen-Lenstra heuristics and the Spiegelungssatz: number
ﬁelds. J. Number Theory 92 (2002), no. 1, 37-66.
[Leh32]
Lehmer, D.H. (1932): Hunting big game in the theory of numbers. Scr.
math., 1, 229-235 (1932-33). Jbuch FdM 59,539.
[Leh56]
Lehmer, D.H. (1956): List of prime numbers from 1 to 10006721. New
york: Hafner Publishing Co., 1956. Zbl.78,31.
[Lei03]
Leichtnam, E.: An invitation to Deninger's work on arithmetic zeta func-
tions (Manuscript, November 27, 2003)
[LeA.88]
Lenstra, A.K. (1988): Fast and rigorous factorization under the general-
ized Riemann hypothesis. Proc. Kon. Ned. Akad. Wetenskab., 91, No.4,
443-454 (1988). Zbl.669.10012.
[LeH.80]
Lenstra, H.W., Jr. Primality testing algorithms (after Adleman, Rumely
and Williams). Sém. Bourbaki, Exp. 576, 1980-81. Zbl.476.10005.
[LeH.84]
Lenstra, H.W., Jr. (1984): Integer programming and cryptography.
Math. Intell., 6, No.3 (1984), 14-19. Zbl.548.90050.

484
References
[LeH.87]
Lenstra, H.W., Jr. (1987): Factoring integers with elliptic curves. Ann.
Math., 126, No. 3 (1987), 649-673. Zbl.629.10006.
[LeT82]
Lenstra, H.W., Jr., Tijdeman, R. (ed). Computational analysis in num-
ber theory. Math. Center Tracts 154/155, Math. Centrum, Amsterdam
(1982). Zbl.497.00005.
[Leo58]
Leopoldt, H. W.: Zur Strukture der 1-Klassengruppe galoischer Zahlko-
rper, J. Reine Angew Math. 199 (1958), 165-174.
[Li75]
Li, W. New forms and functional equations. Math. Ann., 212, 285-315
(1975). Zbl.278.10026.
[Li2000]
Li, W.: Recent developments in automorphic forms and applications.
Number theory for the millennium, II (Urbana, IL, 2000), 331-354, A K
Peters, Natick, MA, 2002.
[LN83]
Lidl, R., Niederreiter, H. (1983): Finite ﬁelds. Reading, Mass.: Addison-
Wesley (1983). Zbl.554.12010.
[Lin79]
Linnik, Yu.V. (1979): Collected Works.(in Russian). Leningrad: Nauka,
1979. Zbl.435.10001
[Lom78]
Lomadze, G.A.(1978): Formulas for the numbers of representation of
numbers by certain regular and semi−regular ternary quadratic forms
belonging to genera with two classes. (in Russian). Acta Arithm., 34,
no.2, 131-162 (1978). Zbl.329.10014.
[Loe96]
Loeser, F.: Exposants p-adiques et théorèmes d'indice pour les équations
diﬀérentielles p-adiques, d'après G. Christol et Z. Mebkhout. Séminaire
Bourbaki. Exp. No.822 (Novembre 1996)
[LRS99]
Luo, W., Rudnick, Z. , Sarnak, P.: On the generalized Ramanujan con-
jecture for GL(n), Proc. Symp. Pure Math. 66, part 2, AMS, (1999).
[LT65]
Lubin, J., Tate, J. (1965): Formal complex multiplication in local ﬁelds.
Ann. Math., 81 (1965), 330-387. Zbl.128.265.
[Lu37]
Lutz, E. (1937): Sur l'equation Y 2 = X3 −AX −B dans les corps
p−adiques. J. reine u. angew. Math., 177, 238-247 (1937). Zbl.17,53.
[Mac80]
Macdonald, I.G.(1980): Aﬃne Lie algebras and modular forms. Sém.
Bourbaki, Exp. 577, 1980/81. Zbl.472.17006.
[Mah34]
Mahler,
H.(1934):
Über
die
rationalen
Punkte
auf
Kurven
vom
Geschlecht Eins. J. reine u. angew. Math., 170, 168-178 (1934).
Zbl.8,200.
[Mal62]
Malyshev, A.V. (1962): On the representation of integers by positive
quadratic forms. (In Russian). Steklov Math. Inst. Trudy, 65, 1962.
Zbl.135,98.
[Man56]
Manin, Yu.I. (1956): On the congruences of the third degree modulo
a prime number. (In Russian). Izv. Akad. Nauk SSSR, Ser. mat., 20
(1956), 673-678. Zbl.72,32.
[Man58]
Manin, Yu.I. (1958): Algebraic curves over ﬁelds with derivation. (In
Russian). Izv. Akad Nauk SSSR, Ser. mat., 22, No.6, 737-756 (1958).
[Man61]
Manin, Yu.I. On the Hasse-Witt matrix of algebraic curves. (In
Russian). Izv. Akad. Nauk SSSR, Ser. mat., 25, 153-172 (1961). English
transl.: Transl.Am.Math.Soc., II.Ser. 45 (1965), 245-269. Zbl.102,278.
[Man63a]
Manin, Yu.I. (1963a): A proof of an analogue of Mordell's conjecture
over functional ﬁelds. (In Russian). Doklady Akad. Nauk SSSR, ser.
mat., 152, No. 5, 1061-1063 (1963).

References
485
[Man63b]
Manin, Yu.I. (1963b) Rational points of algebraic curves over functional
ﬁelds. (In Russian). Izv. Akad. Nauk SSSR, ser. mat., 27, No. 6, 1395-
1440 (1963). Zbl.166,169.
[Man68]
Manin, Yu.I. (1968): Correspondences, motives and monoidal transfor-
mations (in Russian). Mat. Sb., 77, no.4 (1968), 475-507. Zbl.199,248.
[Man70a]
Manin,
Yu.I.
(1970a):
Fine
structure
of
the
Néron-Tate
height.
(in Russian). Mat. Sb., 83, No.3 (1970), 331-348. English transl.:
Math.USSR, Sb.12 (1971), 325-342. Zbl.214,484.
[Man70b]
Manin, Yu.I. (1970b): Le groupe de Brauer-Grothendieck en géométrie
Diophantienne. Actes Congr. Int. Math. Nice, 1970. Paris: Gauthier-
Villars, Vol.1, 401-411 (1971). Zbl.239.14010.
[Man71]
Manin, Yu.I. (1971): Cyclotomic ﬁelds and modular curves. (in Russian).
Uspekhi, 26, no.6 (1971), 7-78. English transl.: Russ.Math.Surv. 26,
No.6 (1972), 7-78. Zbl.241. 14014.
[Man72a]
Manin Yu.I. (1972a): Cusp forms and zeta-functions of modular curves.
Izv. Akad. Nauk SSSR, Ser. Mat. 36, No.1 (1972), 19-66. English transl.:
Math.USSR, Izv.6 (1973), 19-64. Zbl.243.14008.
[Man72b]
Manin Yu.I. (1972b): Cubic Forms. Algebra, Geometry, Arithmetic.
Moscow: Nauka, 1972. Zbl.255.14002. English transl.: Amsterdam:
North-Holland, 1984. Zbl.582. 14010.
[Man76]
Manin, Yu.I. (1976): Non-archimedean integration and p-adic Jacquet-
Langlands functions. (In Russian). Uspekhi, 31, no.1 (1976), 5-54.
Zbl.336.12007.
[Man76a]
Manin, Yu.I.: p-adic automorphic functions. Journ. of Soviet Math., 5
(1976) 279-333.
[Man77]
Manin Yu.I. (1977): A course in mathematical logic. Graduate texts in
math. 53. Springer Verlag (1977), 286
[Man78]
Manin, Yu.I. (1978): Modular forms and number theory. Proc. Int.
Congr. Math. Helsinki, 1978, 177-186. Zbl.421.10016.
[Man80]
Manin Yu.I. (1980): Computable and non-computable. Moscow, Soviet
Radio (1980) (in Russian)
[Man84]
Manin, Yu.I. (1984): New dimensions in geometry. Lecture Notes n
Math., vol. 1111, Berlin e.a.: Springer, 1984. Zbl.579.14002.
[Man91]
Manin, Yu.I. (1991): Three-dimensional hyperbolic geometry as ∞-adic
Arakelov geometry. Invent.Math., vol. 104, No.2, 223-243 (1991)
[Man95]
Manin, Yu.I.: Lectures of zeta functions and motives (according to
Deninger and Kurokawa). Columbia University Number Theory Sem-
inar (New York, 1992). Astérisque No. 228, 4, 121-163 (1995).
[Ma99]
Manin, Yu. I.: Classical computing, quantum computing, and Shor's
factoring algorithm. Séminaire Bourbaki. [Exposé No.862] Juin 1999
[Man02]
Manin, Yu.I.: Von Zahlen und Figuren, preprint math. AG/0201005
(2002).
[Man02a]
Manin, Yu.I.: Real Multiplication and noncommutative geometry,
preprint math. AG/0202109 (2002).
[ManMar2] Manin, Yu.I., Marcolli, M.: Holography principle and arithmetic of al-
gebraic curves, Adv. Theor. Math. Phys. Vol.3 (2001) N.5.
[ManMar1] Manin, Yu.I., Marcolli, M.: Continued fractions, modular symbols, and
noncommutative geometry, Selecta Mathematica, New Ser. Vol.8 N.3
(2002) 475-520.

486
References
[MaPaM]
Manin Yu.I, Panchishkin A.A. (1989): Introduction to Number Theory,
1989, Edition VINITI (in Russian), 348 p.
[MaPa]
Manin Yu.I, Panchishkin A.A. (1995): Number Theory I: Introduction
to Number Theory, Encyclopaedia of Mathematical Sciences, vol. 49,
Springer-Verlag, 1995, 303 p.
[MTs86]
Manin, Yu.I., Tsfasman, M.A. (1986): Rational varieties. Algebra, Geom-
etry, Arithmetic. (In Russian). Uspekhi, 41, No.2, 43-94 (1986). English
transl.: Russ.Math.Surv. 41, No.5 (1986), 51-116. Zbl.621.14029.
[MZ72]
Manin Yu.I., Zarkhin Yu.G. (1972): Height on families of Abelian va-
rieties. Mat. Sb., Nov.Ser. 89, No.2, 171-181 (1972). English transl.:
Math.USSR, Sb. 18 (1973), 169-179. Zbl.256.14018.
[Mar]
Marcolli, M.: Limiting modular symbols and the Lyapunov spectrum,
Journal of Number Theory, 98 N.2, 348-376 (2003).
[Mar04]
Marcolli, M.: Lectures on Arithmetic Noncommutative Geometry, Van-
derbilt University, pp. 1-100 (2004)
[Mar54]
Markov A.A. (1954): The theory of algorithms. Tr.Mat.Inst.Steklova 42,
1954. English transl.: Am.Math.Soc., Transl., II.Ser. 15 (1960), 1-14.
Zbl.58,5.
[MM76]
Masley, J.M., Montgomery, H.L. (1976): Cyclotomic ﬁelds with unique
factorization. J. reine u. angew. Math., 286/287 (1976), 248-256.
Zbl.256.14018.
[Mat72]
Matiyasevich, Yu.V. (1972): Diophantine sets. (in Russian). Usp. Mat.
Nauk. 27, No.5 (1972), 185-222. English transl.: Russ.Math.Surv. 27,
No.5 (1973), 124-164. Zbl.621.14029.
[Mat04]
Matiyasevich, Yu.V. (2004): Hilbert's Tenth Problem, with a foreword
by Martin Davis, MIT Press, Cambridge, MA; London, England (2004),
264 pp.
[Mats70]
Matsumura, H.: Commutative Algebra. Benjamin, New York, 1970.
[MaTa98]
Matsuzaki, K., Taniguchi, M.: Hyperbolic manifolds and Kleinian
groups, Oxford Univ. Press, 1998.
[Maz77]
Mazur, B. (1977): Modular Curves and the Eisenstein Ideal. Publ. Math.
I.H.E.S., 47, 33-186, (1977).
[Maz77a]
Mazur, B. (1977): Rational points on modular curves. Lecture Notes in
Math., vol. 601, 1977, 107-148. Zbl.357.14005.
[Maz79]
Mazur, B. On the arithmetic of special values of L-functions. Inv. Math.,
55, no.3, 207-240 (1979). Zbl.426.14009
[Maz83]
Mazur, B. (1983): Modular curves and arithmetic. Proc. ICM, Warszawa,
1983. Amsterdam: North-Holland, Vol.1, 185-211 (1984) Zbl.597.14023.
[Maz86]
Mazur, B. (1986): Arithmetic on curves. Bull. AMS, 14, No.2, 207-259
(1986) Zbl.593.14021.
[Maz87]
Mazur B. (1987): On some of the mathematical contributions of Gerd
Faltings. Proc. Int. Congr. Math., Berkeley/Calif. 1986. (1987) 7-12.
Zbl.663.01002.
[Maz2000] Mazur B. (2000): The theme of p-adic variation. Mathematics: frontiers
and perspectives, 433-459, Amer. Math. Soc., Providence, RI, 2000.
[MazRub03] Mazur, B., Rubin, K.: Studying the Growth of Mordell-Weil. Docu-
menta Math. Extra Volume: Kazuya Kato's Fiftieth Birthday (2003)
585-607
[MazRub04] Mazur, B., Rubin, K.: Kolyvagin systems. AMS, 96 pp.

References
487
[MSD74]
Mazur, B., Swinnerton-Dyer, H.P.F. (1974): Arithmetic of Weil curves.
Inv. Math., 25, 1-61 (1974). Zbl.281,14016.
[MW83]
Mazur, B., Wiles, A. (1983): Analogies between function ﬁelds and num-
ber ﬁelds. Amer. J. Math., 105, 507-521 (1983). Zbl.531.12015.
[MW84]
Mazur, B., Wiles, A. (1984): Class ﬁelds of Abelian extensions of Q. Inv.
of Math., 76, no.2 (1984), 179-330. Zbl.545.12005.
[Meh91]
Mehta, M.L. : Random matrices, Academic Press,(1991).
[Men93]
Menezes, A.: Elliptic curve public key cryptosystems, Kluwer Academic
Publishers, Boston, MA, 1993. xiv+128 pp.
[Mer96]
Merel, L.: Bornes pour la torsion des courbes elliptiques sur les corps de
nombres. Invent. Math. 124 (1996), no. 1-3, 437-449.
[Me82]
Mestre J.-L. (1982): Construction d'une courbe elliptique de rang ≥12.
C. R. Acad. Sci. Paris, Ser.I 295 (1982), 643-644.
[Me84]
Mestre, J.-L. (1984): Courbes de Weil et courbes supersingulières. Sém.
Théorie des Nombres, Bordeaux, 23, 1984-85. Zbl.599.14031.
[Me85]
Mestre, J.-L. (1985): Courbes de Weil de conducteur 5077. CRAS Paris,
300, No. 15 (1985). Zbl.589.14026.
[Mich98]
Michel, P.: Progrès récents du crible et applications, d'après Duke, Fou-
vry, Friedlander, Iwaniec. Séminaire Bourbaki. Exp. No.842 (Mars 1998)
[Mich01]
Michel, P.: Répartition des zéros des fonctions L et matrices aléatoires
Séminaire Bourbaki. Exp. No.887 (Mars 2001)
[Mih03]
Mihˇailescu, P.: A class number free criterion for Catalan's conjecture. J.
Number Theory 99 (2003), no. 2, 225-231.
[Mil76]
Miller, G.L. (1976): Riemann's hypothesis and tests for primality. J.
Comput. and Syst. Sci., 13, 300-317 (1976). Zbl.349.68025.
[Mil80]
Milne, J.S. (1980): Etale cohomology. Princeton Univ. Press, 1980.
Zbl.433.14012.
[Mil68]
Milnor, J.M.: Inﬁnite cyclic coverings, Conference on the Topology of
Manifolds (Michigan State Univ., E. Lansing, Mich., 1967) pp. 115-133,
Prindle, Weber and Schmidt, Boston, Mass 1968.
[Miy77]
Miyaoka, Y. (1977): On the Chern numbers of surfaces of general type.
Inv. Math., 42, 225-237 (1977). Zbl.374.14007.
[Mi89]
Miyake, Toshitsune (1989): Modular forms. Transl. from the Japanese
by Yoshitaka Maeda., Berlin etc.: Springer-Verlag. viii, 335 p. (1989).
[MF73-77] Modular functions of one variable. I-VI. Lecture Notes in Math., 320
(1973), 349 (1973), 416 (1975), 601 (1977), 627 (1977). 320 (1973),
Zbl.255.00008; 349 (1973), Zbl.264.00002; 416 (1975), Zbl.315.14014; 601
(1977), Zbl.347.00004; 627 (1977). Zbl.355.00009.
[Mon80]
Monier, L. (1980): Algorithmes de factorization d'entiers. Paris: IRIA,
1980, 313-324.
[Mont71]
Montgomery, H.L. (1971): Multiplicative number theory. Berlin e.a.:
Springer (1971). Zbl.216,35.
[Mont73]
Montgomery H., The pair correlation of zeros of the zeta function, An-
alytic Number Theory, AMS (1973).
[Mor98a]
Morain, F.: Primality proving using elliptic curves: an update. In J. P.
Buhler, editor, Algorithmic Number Theory, volume 1423 of Lecture
Notes in Comput. Sci., pages 111-127. Springer-Verlag, 1998. Third In-
ternational Symposium, ANTS-III, Portland, Oregon, June 1998, Pro-
ceedings.

488
References
[Mor03]
Morain, F.: La primalité en temps polynomial, d'après Adleman, Huang;
Agrawal, Kayal, Saxena. Séminaire Bourbaki. [Exposé No.917] (Mars
2003).
[Mor03a]
Morain, F.: Primalité théorique et primalité pratique, AKS vs. ECPP:
www.lix.polytechnique.fr/Labo/François. Morain/aks-f.pdf
[MPTh]
Moran A., Pritchard, P., Thyssen, A.: Twenty-two primes in arithmetic
progression, Math. Comp. 64, no. 211, 1337-1339 (1995).
[Mor22]
Mordell, L.J. (1922): On the rational solutions of the indeterminate equa-
tions of the third and fourth degrees. Proc. Cambr. Phil. Soc., 21, 179-
192 (1922). Jbuch FdM 48,140.
[Mor69]
Mordell, L.J. (1969): Diophantine equations. New York: Acad. Press,
1969. Zbl.188, 345.
[Mor93]
Moree, P.: A note on Artin's conjecture. Simon Stevin 67, no. 3-4, 255-
257 (1993).
[More77]
Moreno, C.J. (1977): Explicit formulas in the theory of automorphic
forms. Lect. Notes in Math., vol. 626, 1977, 73-216. Zbl.367.10023
[MoMu84] Mori, Shigefumi, Mukai, Shigeru: Classiﬁcation of Fano 3-folds with
B2 ≥2. Manuscripta Math. 36, no. 2, 147-162 (1981/82).
[MoMu03] Mori, Shigefumi, Mukai, Shigeru: Erratum: "Classiﬁcation of Fano 3-
folds with B2 ≥2 [Manuscripta Math. 36, no. 2, 147-162 (1981/82)]."
Manuscripta Math. 110, no. 3, p. 407
[MB75]
Morrison, M.A., Brillhart, J. (1975): A method of factoring and the
factorization of F7 . Math. Comput., 29 (1975), 183-205. Zbl.302.10010.
[Mozz]
Mozzochi C.J. (2000): The Fermat diary. Providence, Am. Math. Soc.,
xi+196 (2000)
[Mum65]
Mumford, D. (1965): A remark on Mordell's conjecture. Amer. J. Math.,
87, No.4, 1007-1016 (1965). Zbl.151,273.
[Mum66]
Mumford, D. (1966): On the equations deﬁning Abelian varieties.I. Inv.
Math., 1, 287-354 (1966). Zbl.219.14024.
[MSW02]
Mumford, D., Series, C, Wright, D. (2002): Indra's Pearls. The visions
of Felix Klein. Cambgridge University Press, New-York, 2002
[Mum72]
Mumford, D. (1972): An analytic construction of degenerating curves
over complete local ﬁelds. Compos. Math., 24, 129-174 (1972).
[Mum74]
Mumford, D. (1974): Abelian varieties. Oxford Univ. Press (1974).
Zbl.326. 14012.
[Mum83]
Mumford, D. (1983): Tata lectures on theta. I-II. Boston e.a.: Birkhäuser
(1983), (1984). Zbl.549.14014.
[Mur99]
Murty, R.: Review (Math. Reviews, 99k:11004) on [CSS95]
[MM81]
Narasimhan, M.S., Nori, M.V. (1981): Polarizations on an Abelian
variety. Proc. Ind. Ac. Sci., Math. Sci., 90, No.2 (1981), 125-128.
Zbl.509.14047.
[Nar74]
Narkiewicz, W. (1974): Elementary and analytic theory of algebraic
numbers. Warsaw: Polish Sci. Pub. (1974). Zbl.276.12002.
[Ner64]
Néron, A. (1964): Modéles minimaux des variétés abéliennes sur les corps
locaux et globaux. Publ. Math. IHES, 21, (1964), 367-482. Zbl.132,414.
[Ner76]
Néron, A. (1976): Hauteurs et fonctions theta. Rend. Sem. Mat. e Fis.
Milano, 46, 111-135 (1976). Zbl.471.14024.
[Nes99]
Nesterenko, Yu. V.: Algebraic independence of π and eπ. Number theory
and its applications (Ankara, 1996), 121-149, Lecture Notes in Pure and
Appl. Math., 204, Dekker, New York, 1999.

References
489
[Nes02]
Nesterenko, Yu. V.: On the algebraic independence of numbers. A
panorama of number theory or the view from Baker's garden (Zürich,
1999), 148-167, Cambridge Univ. Press, Cambridge, 2002.
[Neuk99]
Neukirch, J.: Algebraic number theory. Translated from the 1992 Ger-
man original and with a note by Norbert Schappacher. With a foreword
by G. Harder. Grundlehren der Mathematischen Wissenschaften [Fun-
damental Principles of Mathematical Sciences], 322. Springer-Verlag,
Berlin, 1999. xviii+571 pp. Algebraische Zahlentheorie Berlin etc.:
Springer-Verlag. xiii, 595 S. (1992). Zbl. 0747.11001,
[NSW2000] Neukirch, J., Schmidt, A., Wingberg, K.: Cohomology of number ﬁelds.
Grundlehren der Mathematischen Wissenschaften [Fundamental Princi-
ples of Mathematical Sciences], 323. Grundlehren der Mathematischen
Wissenschaften, Springer-Verlag, Berlin, 2000. xvi+699 pp.
[Ngo2000]
Ngô, Bao Châu: Preuve d'une conjecture de Frenkel-Gaitsgory-Kazhdan-
Vilonen pour les groupes linéaires généraux. Israel J. Math. 120 (2000),
part A, 259-270.
[Nis54]
Nisnevich, L.B. (1954): On the number of points of algebraic varieties in
ﬁnite ﬁelds. (in Russian). Doklady Akad. Nauk SSSR, 99 (1954), 17-20.
Zbl.459.14002.
[Nog81]
Noguchi, J.(1981): A higher-dimensional analog of Mordell's conjecture
over functional ﬁelds. Math. Ann., 158, 207-221 (1981). Zbl.459.14002.
[Oe92]
Oesterlé, J.: Polylogarithmes. Séminaire Bourbaki. [Exposé No.762] (No-
vembre 1992)
[Oe95]
Oesterlé, J. (1995): Travaux de Wiles (et Taylor, . . .). II. Séminaire Bour-
baki, Vol. 1994/95. Astérisque No. 237, Exp. No. 804, 5, 333-355 (1996)
[Odl75]
Odlyzko, A.M. (1975): Some analytic estimates of class numbers and
discriminants. Inv. Math., 29, No. 3, 275-286 (1975). Zbl.299.12010.
[Odl84]
Odlyzko, A.M. (1984): Discrete logarithms in ﬁnite ﬁelds and their cryp-
tographic signiﬁcance. Adv. in Cryptology. Proc. of Eurocrypt 84, 224-
314. Springer-Verlag, 1985. Zbl.594.94016.
[Odl87]
Odlyzko, A.M. (1987): New analytic algorithms in number theory.
Proc. ICM Berkeley 1986, vol. I, , 446-475, Providence Rh.I. (1987).
Zbl.669.10003.
[Odl87a]
Odlyzko A.M.: On the distribution of spacings between zeros of zeta
functions, Math. Comp. 48 (1987), 273-308.
[OR85]
Odlyzko, A.M., Riele, H.J. (1985): Disproof of the Mertens conjecture.
J. reine u. angew. Math., 357, 138-160 (1985). Zbl.544.10047.
[Oe83]
Oesterlé, J. (1983): Nombres de classes des corps quadratiques imagi-
naire. Sém. Bourbaki, Exp. 631, 1983/84. Zbl.551. 12003.
[Oe95]
Oesterlé, J. (1995) Travaux de Wiles (et Taylor,. . . ). II. Séminaire Bour-
baki. Exp. No.804 (Juin 1995)
[Ogg65]
Ogg, A.P. (1965): Modular forms and Dirichlet series. Benjamin, 1965.
Zbl.191.381.
[Pan81]
Panchishkin, A.A.: Modular forms. (in Russian). Itogi Nauki, 19, 135-
180 (1981), Moscow, VINITI. Zbl.477.10025.
[Pan84]
Panchishkin, A.A. (1984): Automorphic forms and functorality prin-
ciple.(In Russian). In: Automorphic forms, representations and L-
functions. Moscow, Mir, 249-286 (1984).
[Pan88]
Panchishkin,
A.A.
(1988):
Non-Archimedean
automorphic
zeta-
functions. (In Russian). Moscow, MGU, 1988. Zbl.667.10017.

490
References
[Pan03]
Panchishkin, A.A. (2003): Two variable p-adic L functions attached
to eigenfamilies of positive slope, Inventiones Math., 154, pp. 551-615
(2003)
[PaTu82]
Parry W., Tuncel S., Classiﬁcation problems in ergodic theory, London
Math. Soc. Lecture Notes Series 67, 1982.
[Par71]
Parshin, A.N. Quelques conjectures de ﬁnitude en géométrie Dio-
phantienne. Actes Congr. Int. Math. Nice 1970, Vol. I, 467-471(1971).
Zbl.224.14009.
[Par71]
Parshin, A.N. Arithmetic of algebraic varieties, (In Russian). Itogi
Nauki, 2, 111-152 (1971). Moscow, VINITI. Zbl.284.14004.
[Par72]
Parshin, A.N. Minimal models of curves of genus two and homomor-
phisms of abelian varieties deﬁned over a ﬁeld of ﬁnite characteris-
tic. (in Russian). Izv. Akad. Nauk SSSR, 36, No. 1 (1972), 67-109.
Zbl.249.14003.
[Par73]
Parshin, A.N. Modular correspondences, heights, and isogenies of
Abelian varieties. (in Russian). Steklov Math. Inst., Trudy, 122 (1973),
211-236. Zbl.305.14015.
[PSh84]
Parshin, A.N., Shafarevich, I.R. Arithmetic of algebraic varieties. (in
Russian). Steklov Math. Inst., Trudy, 168 (1984), 72-97. Zbl.605.14001.
[Par87]
Parshin, A.N. (1987): The Bogomolov-Miyaoka-Yau inequality on the
arithmetical surfaces and its applications. Sém.Théorie des Nombres.
Paris, 1986/87. Boston e.a., Birkhäuser, 1987. Zbl.705.14022
[PZ88]
Parshin A.N., Zarkhin Yu.G. (1988): Finiteness problems in Diophan-
tine geometry. Appendix in Russ. ed. of: Lang S. Foundations of Dio-
phantine geometry. Moscow: Mir, 1988, 369-438. Transl. from English.
Zbl.644.14007.
[Pat88]
Patterson S., An introduction to the theory of the Riemann zeta func-
tion, Cambridge Studies in advanced mathematics, 14 Cambridge Uni-
versity Press (1988).
[Pet85]
Peterson I. (1985): Uncommon factoring. Sci. News 127, March 30,
No.13, 202-203 (1985).
[Pey95]
Peyre, E.: Hauteurs et mesures de Tamagawa sur les variétés de Fano,
Duke Math. J. 79 (1995), n 1, 101-218.
[Pey02]
Peyre, E.: Points de hauteur bornée et géométrie des variétés (d'après
Y. Manin et al.). Séminaire Bourbaki, Vol. 2000/2001. Astérisque No.
282, (2002), Exp. No. 891, ix, 323-344.
[Pey04]
Peyre, E.: Obstructions au principe de Hasse et à l'approximation faible.
Séminaire Bourbaki. [Exposé No.931] (Mars 2004)
[PeyTsch01] Peyre E., Tschinkel, Yu.: Rational points on algebraic varieties.
Progress in Math. vol. 199, Birkhäuser, Basel (2001)
[PSh79]
Piatetski-Shapiro I.I. (1979): Classical and adelic automorphic forms.
An introduction. In: Borel A., Casselman W. eds. (1979), Part 1, 185-
188. Zbl.423.10017.
[PV80]
Pimsner, M., Voiculescu, D.: Exact sequences for K-groups and Ext-
groups of certain cross-product C∗-algebras, J. Operator Theory 4
(1980), no. 1, 93-118.
[Pl82]
Platonov
V.P.
(1982):
Arithmetic
theory
of
algebraic
groups.
Usp.Mat.Nauk. 37, No. 3 (1982), 3-54. English transl.: Russ.Math.Surv.
37, No.3 (1982), 1-62. Zbl.502.20025.

References
491
[PlRa83]
Platonov V.P., Rapinchuk A.S. (1983): Algebraic groups. Itogi Nauki
Tekh., Ser. Algebra, Topol., Geom. 21 (1983), 80-134. English transl.:
J.Sov.Math.Surv. 31, No.3 (1985), 2939-2973. Zbl.564.20023.
[Pol74]
Pollard J.M. (1974): Theorems on factorization and primality testing.
Proc. Camb. Philos. Soc. 76 (1974), 521-528. Zbl.294.10005.
[P74]
Pólya, G.: Collected Papers, Cambridge, M.I.T. Press (1974).
[Po90]
Pollicott, M.: Kleinian groups, Laplacian on forms and currents at in-
ﬁnity, Proc. Amer. Math. Soc. 110 (1990) 269-279.
[Pom81]
Pomerance C. (1981): Recent developments in primality testing. Math.
Intell. 3 (1981), 97-106. Zbl.476.10004.
[Pom82]
Pomerance C. (1982): Analysis and comparison of some integer factoring
algorithms. Math. Cent. Tracts 154 (1982), 89-139. Zbl.508.10004.
[Pom87]
Pomerance C. (1987): Fast, rigorous factorization and discrete logarithm
algorithms. In: Discrete algorithms and complexity, Proc. Semin. Kyoto
1986, Perspect. Comput. 15 (1987), 119-143. Zbl.659.10003.
[PW83]
Pomerance C., WagstaﬀS.S. (1983): Implementation of the continued
fraction integer factoring algorithm. Proc. 12th Manitoba Conf., Win-
nipeg 1982, Congr. Numerantium 37 (1983) 88-118. Zbl.556.10003.
[PSW80]
Pomerance C., Selfridge J.L., WagstaﬀS.S. (1980): The pseudoprimes
to 25.10. Math. Comput. 35 (1980), 1003-1086. Zbl.444.10007.
[Po03]
Poonen, B.: Hilbert's tenth problem and Mazur's conjecture for large
subrings of Q. J. Amer. Math. Soc. 16 (2003), no. 4, 981-990
[PoTsch04] Poonen B., Tschinkel, Yu. (Eds.) Arithmetic of higher-dimensional al-
gebraic varieties. Proceedings of the Workshop on Rational and Integral
Points of Higher-Dimensional Varieties held in Palo Alto, CA, Decem-
ber 11-20, 2002. Progress in Mathematics, 226. Birkhäuser Boston, Inc.,
Boston, MA, 2004. xvi+287 pp.
[vdP79]
van der Poorten A.J. (1979): A proof that Euler missed . . . Apéry's proof
of the irrationality of ζ(3). An informal report. Math. Intell. 1, No. 4
(1979), 195-203. Zbl.409.10028.
[vdP96]
van der Poorten, A.: Notes on Fermat's last theorem. Canadian Mathe-
matical Society Series of Monographs and Advanced Texts. A Wiley-
Interscience Publication. John Wiley & Sons, Inc., New York, 1996.
xviii+222 pp.
[Pos71]
Postnikov A.G. (1971): Introduction to analytic number theory. Moscow:
Nauka, 1971. English transl.: Providence: Transl.Math.Monogr., Vol. 68
(1988). Zbl.231. 10001. Zbl.641.10001.
[Pos78]
Postnikov M.M. (1978): Fermat's Theorem. (in Russian). Moscow:
Nauka, 1978.
[Pra57]
Prachar K. (1957): Primzahlverteilung. Berlin-Heidelberg-New York:
Springer-Verlag, 1957. Zbl.80,259.
[Pu96]
Putnam, I.: C∗-algebras from Smale spaces, Can. J. Math. 48 (1996)
N.1 175-195.
[PuSp-99]
Putnam, I., Spielberg, J.: The structure of C∗-algebras associated with
hyperbolic dynamical systems, J. Funct. Anal. 163 (1999) 279-299.
[Ra80]
Rabin M.O. (1980): Probabilistic algorithms for testing primality. J.
Number Theory 12 (1980), 128-138. Zbl.426.10006.
[Ra77]
Rademacher H. (1977): Lectures on Elementary Number Theory. Krieger
Publ. Co., 1977. Zbl.363.10001.

492
References
[R99]
Ramakrishna, R. (1999): Lifting Galois representations. Invent. Math.
138, 537-595 (1999).
[Ram16]
Ramanujan S. (1916): On certain arithmetical functions. Trans. Camb.
Philos. Soc. 22 (1916), 159-184.
[Ran39]
Rankin R. (1939): Contribution to the theory of Ramanujan's function
τ(n) and similar arithmetical functions, I, II. Proc. Camb. Philos. Soc.
35, 351-372 (1939). Zbl.21,392.
[Ray75]
Raynaud M. (1975): Schémas en groupes de type (p, . . . , p). Bull. Soc.
Math. Fr. 102, 241-280 (1975). Zbl.325.14020.
[Ray83]
Raynaud M. (1983): Around the Mordell conjecture for function ﬁelds
and a conjecture of Serge Lang. Lect. Notes Math. 1016 (1983), 1-19.
Zbl.525.14014.
[RaSi73]
Ray, D.B., Singer, I.M.: Analytic torsion for complex manifolds. Ann. of
Math. (2) 98 (1973), 154-177.
[Ren80]
Renault, J.: A groupoid approach to C∗-algebras, Lecture Notes in
Mathematics, 793. Springer, 1980.
[Rib79]
Ribenboim P. (1979): 13 Lectures on Fermat's Last Theorem. Berlin-
Heidelberg-New York: Springer-Verlag, 1979. Zbl.456.10006
[Rib88]
Ribenboim P. (1988): The book of prime number records. Berlin-
Heidelberg-New York: Springer-Verlag, 1988. Zbl.642.10001
[Rib96]
Ribenboim P. (1996): The new book of prime number records. Berlin-
Heidelberg-New York: Springer-Verlag, 1996.
[Ri77]
Ribet K.A. (1977): Galois representations attached to eigenforms with
Nebentypus. Lect. Notes Math. 601 (1977), 17-52. Zbl.363.10015.
[Ri85]
Ribet K.A. (1985): On l-adic representations attached to modular
forms.II. Glasgow Math. J. 27 (1985), 185-194.
[Ri90a]
Ribet K.A. (1990a): Raising the level of modular representations. Sémin.
Theor. Nombres Paris, 1987-88 Progress in Math. 81 (1990), 259-271.
[Ri]
Ribet, K.A. (1990): On modular representations of Gal(Q/Q) arising
from modular forms. Invent. Math. 100, No.2, 431-476 (1990)
[RiSt01]
Ribet, K., Stein, W.: Lectures on Serre's conjectures. In: [CR01], pp.
143-232
[Rief76]
Rieﬀel, M.A.: Strong Morita equivalence of certain transformation group
C∗-algebras. Math. Annalen, 222, 7-23 (1976).
[Rie1858]
Riemann B. (1858): Über die Anzahl der Primzahlen unter Einer
Gegebenen Größe. Montasb. der Berliner Akad., 160, 671-680 (1858).
[Rie1892]
Riemann B. (1892): Gesammelte mathematische Werke. Leipzig, 1892.
Jbuch.FdM. 24,21.
[Ries85]
Riesel H. (1985): Prime numbers and computer methods for factoriza-
tion. Prog. Math. 57, Boston: Birkhäuser, 1985. Zbl.582.10001.
[RG70]
Riesel H., Göhl G. (1970): Some calculations related to Riemann's prime
number formula. Math. Comput. 24 (1970), 969-983. Zbl.217,32.
[Riv01]
Rivoal, T.: Propriétés diophantiennes de la fonction zêta de Riemann
aux entiers impairs http://theses-EN-ligne.in2p3.fr/documents
/archives0/00/00/12/67 /index_fr.html, PhD, T. Rivoal, Université
de Caen, 2001
[Rob73]
Robert G. (1973): Unités elliptiques et formules pour le nombre de
classes des extensions abéliennes d'un corps quadratique imaginaire.
Bull. Soc. Math. Fr. 36 (1973), 5-77. Zbl.314.12006.

References
493
[Rob01]
Robertson, G.: Boundary actions for aﬃne buildings and higher rank
Cuntz-Krieger algebras, in [CuEch01]
[Rog67]
Rogers H. (1967): The theory of recursive functions and eﬀective com-
putability. Mac-Graw Hill Publ.Co., 1967. Zbl.183,14.
[Ros84]
Rosen K.H. (1984): Elementary Number Theory and its Applications.
Reading, Mass.: Addison-Wesley, 1984. Zbl.546.10001.
[Roth55]
Roth K.F. (1955): Rational approximations to algebraic numbers. Math-
ematika 2 (1955), 1-20. Zbl.64,285.
[Rub77]
Rubin K. (1987): Tate-Shafarevich groups and L-functions of elliptic
curves with complex multiplication. Invent. Math. 89 (1987), 527-560.
Zbl.628.14018.
[Rub95]
Rubin K. (1995): Modularity of mod 5 representations. In: [CSS95], pp.
463-474
[Rub98]
Rubin, K.: Euler systems and modular elliptic curves. Galois representa-
tions in arithmetic algebraic geometry (Durham, 1996), 351-367, London
Math. Soc. Lecture Note Ser., 254, Cambridge Univ. Press, Cambridge,
1998.
[RubSil94] Rubin K., Silverberg A. (1994): A report on Wiles' Cambridge lectures.
Bull. AMS (New series) 31, 15-38 (1994)
[Rue88]
Ruelle, D.: Non-commutative algebras for hyperbolic diﬀeomorphisms,
Invent. Math. 93 (1988) 1-13.
[Sai88]
Saito, M.: Modules de Hodge Polarisable. Publ. Res. Inst. Math. Sci. 24
(1988) 849-995.
[SZ75]
Samuel P., Zariski O. (1975): Commutative Algebra. Vols 1-2, 2nd ed.
Berlin-Heidelberg-New York: Springer-Verlag, 1975/76. Zbl.313.13001,
Zbl.322.13001.
[Sar98]
Sarnak, P.: L-functions. Proceedings of the International Congress of
Mathematicians, Vol. I (Berlin, 1998). Doc. Math. 1998, Extra Vol. I,
453-465 (electronic).
[SarWa]
Sarnak, P., Wang, L.: Some hypersurfaces in P 4 and the Hasse-principle.
C. R. Acad. Sci. Paris Sér. I Math. 321, no. 3, 319-322 (1995).
[Scha79]
Schanuel S. (1979): Heights in number ﬁelds. Bull. Soc. Math. Fr. 107
(1979), 433-449. Zbl.428.12009.
[Schm79]
Schmidt W.M. (1979): Diophantine approximation. Lect. Notes Math.
785 (1976). Zbl.421.10019.
[Sch88]
Schneider, P.: Introduction to the Beilinson Conjectures. In Rapoport,
M. Schappacher, P. Schneider (eds) Beilinson's conjectures on special
values of L-functions, 1-35, (Perspectives in Math., Vol. 4) Boston, New
York: Academic Press 1988.
[Schn57]
Schneider, Th. (1957): Einführung in die transzendenten Zahlen. Berlin-
Heidelberg-New York: Springer-Verlag, 1957.
[Scho90]
Scholl A. (1990): Motives for modular forms. Invent. Math. 100 (1990),
419-430.
[Scho98]
Scholl A. (1990): An introduction to Kato's Euler systems. Galois rep-
resentations in arithmetic algebraic geometry (Durham, 1996), 379-460,
London Math. Soc. Lecture Note Ser., 254, Cambridge Univ. Press, Cam-
bridge, 1998.
[Sch85]
Schoof R.J. (1985): Elliptic curves over ﬁnite ﬁelds and the computation
of square roots mod p. Math. Comput. 44 (1985) 483-494. Zbl.579.14025.

494
References
[Schr84]
Schroeder M.R. (1984): Number theory in science and communication.
Inf. Sci. ser. 7 (1984), Berlin-Heidelberg-New York: Springer-Verlag.
Zbl.613.10001.
[Schr93]
Schröder, H.: K-theory for real C∗-algebras and applications. Pitman
Research Notes in Mathematics Series, 290. Longman Scientiﬁc Techni-
cal, Harlow 1993.
[Sei82]
Seiler, E.: Gauge Theories as a problem of constructive Quantum Field
Theory and Statistical Mechanics, Lecture Notes in Physics 159 Springer
(1982).
[Sel51]
Selberg A. (1951): An elementary proof of the prime number theorem.
Ann. Math. II.Ser. 50 (1949), 305-313. Zbl.36,306.
[Sel89]
Selberg, A.: Collected papers, Springer (1989).
[Selm51]
Selmer E.S. (1951): The Diophantine equation ax3 +by3 +cz3 = 0. Acta
Math. 85 (1951), 203-362. Zbl.42,269.
[Selm54]
Selmer E.S. (1954): Completion on the tables. Acta Math. 92 (1954),
191-197. Zbl.56,267.
[Sepp]
Seppälä, M., Computation of period matrices of real algebraic curves.
Discrete Comput. Geom. 11 (1994), no. 1, 65-81.
[Se56]
Serre, J.- P. (1956): Géométrie algébrique et géométrie analytique. Ann.
Inst. Fourier 6, 1-42 (1955/56). Zbl.0075.30401.
[Se58]
Serre, J.- P. (1958): Groupes algébriques et théorie du corps de classes.
Paris, Hermann, 1958. Zbl.97,356.
[Se63]
Serre, J.- P. (1963): Corps locaux. Paris, Hermann, 1963. Zbl.137,26.
[Se64]
Serre, J.- P. (1964): Cohomologie galoisienne. Berlin e.a.: Springer -
Verlag, 1964. Zbl.128,263.
[Se65]
Serre J.-P. (1965): Zeta and L-functions. In: Arithmetical Algebraic
Geometry, Proc. Conf. Purdue 1963 (1965), 82-92. Zbl.171,196.
[Se68]
Serre, J.- P. (1958): Zeta and L-functions, in: Arithmetical Algebraic
Geometry, New York, Harper and Row, 1965, 82-92 Zbl.171,196.
[Se68a]
Serre, J.-P. (1968a): Abelian l-adic representations and elliptic curves.
New York: Benjamin, 1968. Zbl.186,257.
[Se68b]
Serre, J.- P. (1968b): Une interpretation des congruences relatives à la
fonction τ de Ramanujan. Sém. théor. de nombres Delange-Pisot-Poitou
Fac. Sci. Paris, 1967-68, 9, No. 1, 14/01-14/17. Zbl.186,369.
[Se70]
Serre, J.- P. (1970): Cours d'arithmétique. Paris: Presses Univ. France,
1970. Zbl.225. 12002.
[Se70a]
Serre, J.-P.: Facteurs locaux des fonctions zêta des variétés algéb-
riques (déﬁnitions et conjectures). Sém. Delange-Pisot-Poitou, exp. 19,
1969/70.
[Se71]
Serre J.-P. (1971), Cohomologie des groupes discrets, Prospects in
Math., Ann. of Math. Studies 70, Princeton Univ. Press, (1971)
[Se72]
Serre, J.-P. (1972): Propriétés galoisiennes des points d'ordre ﬁni des
courbes elliptiques. Inv. Math., 15 (1972), 259-331. Zbl.235.14012.
[Se76]
Serre, J.- P. (1976): Représentations l-adiques. Alg. Numb. Theory,
Proc. Taniguchi Int. Symp. Div. Math., Kyoto, 1976; No.2, Kyoto, 117-
1931977. Zbl.406.14015.
[Se77]
Serre J.-P. (1977), Arbres, Amalgames, et SL2 Asterisque 46 (1977);
English trans. Trees, Springer-Verlag, 1980.

References
495
[Se83]
Serre, J.- P. (1983): Sur le nombre des points rationnels d'une courbe
algébrique sur un corps ﬁni. C R Ac. Sci., Ser. 1, 296, 397-402, 1983.
Zbl.538.14015.
[Se86]
Serre, J.- P. (1986): Oeuvres. Vols I-III. Berlin: Springer - Verlag, 1986.
[Se87]
Serre, J.- P. (1987): Sur les représentations modulaires de degré 2 de
Gal(Q/Q). Duke Math. Journ., 54, no.1 (1987), 179-230. Zbl.641.10026.
[Se94]
Serre, J.-P. (1994) Cohomologie galoisienne : progrès et problèmes. Exp.
No.783 (Mars 1994)
[Se95]
Serre, J.-P. (1995): Travaux de Wiles (et Taylor,. . . ). I. Séminaire Bour-
baki. Volume 1994/95. Exposés 790-804. Paris: Societe Mathématique
de France, Astérisque. 237, 319-332, Exp. No.803 (1996)
[Se97]
Serre, J.-P.: Lectures on the Mordell-Weil theorem, Third ed., Friedr.
Vieweg & Sohn, Braunschweig, 1997, Translated from the French and
edited by Martin Brown from notes by Michel Waldschmidt, With a
foreword by Brown and Serre.
[ST68]
Serre, J.- P., Tate, J. Good reduction of Abelian varieties and applica-
tions, Ann. Math., 88, No.3, 492-517 (1968). Zbl.172,461.
[Sev14]
Severi, F. (1914): Sugli integrali abeliani riducibili. Rend. Acad. Lincei,
Ser. V, 23, 581-587 (1914). Jbuch FdM 45,698.
[Sey87]
Seysen M.A. (1987): A probabilistic factorization algorithm with
quadratic forms of negative discriminant. Math. Comput. 48 (1987),
757-780. Zbl.619.10004.
[Sha50]
Shafarevich, I.R. The general reciprocity law. (in Russian).
Mat. Sb., 26, 113-146 (1950).
[Sha51]
Shafarevich, I.R. (1951): A new proof of the Kronecker-Weber theorem.
(In Russian). Steklov Math. Inst., Trudy, 38 (1951), 382-387. Zbl.53,355.
[Sha54]
Shafarevich, I.R. Construction of algebraic number ﬁelds with a given
solvable Galois group. (in Russian). Izv. Akad. Nauk SSSR, ser. Ser.
mat., 18, No.6 (1954), 525-578. Zbl.57,274.
[Sha57]
Shafarevich, I.R., Exponents of elliptic curves. (in Russian). Doklady
Akad. Nauk SSSR, 114, No.4 (1957), 714-716. Zbl.81,154.
[Sha59]
Shafarevich, I.R. (1959): The group of principal homogeneous spaces.
(in Russian). Doklady Akad. Nauk SSSR, 124, No.1 (1959), 42-43.
Zbl.115,389.
[Sha62]
Shafarevich, I.R. (1962): Fields of algebraic numbers. Proc. Int. Congr.
Math. Stockholm, 163-176 (1962). Zbl.126,69
[Sha65]
Shafarevich, I.R., ed. (1965): Algebraic surfaces. (in Russian). Steklov
Math. Inst., Trudy, 75, 1965. German transl.: Leipzig, 1968. Zbl.154,210.
[Sha66]
Shafarevich, I.R. (1966): Lectures on minimal models and birational
transformations of two-dimensional schemes. Bombay, Tata Inst., 1966.
Zbl.164,517.
[Sha69]
Shafarevich, I.R. (1969): Zeta-function. (in Russian). Moscow, MGU,
1969.
[Sha87]
Shafarevich, I.R. (1987): Fundamental notions of algebra. Itogi Nauki,
11, 1987. English transl.: Encycl. Math. Sci 11. Berlin-Heidelberg-New
York: Springer-Verlag, 1990. Zbl.711.16001.
[Sha88]
Shafarevich, I.R. Foundations of algebraic geometry. (In Russian). 2nd
ed. Vols. 1-2. Moscow: Nauka, 1988. English transl.: Berlin-Heidelberg-
New York: Springer-Verlag, 1977. Zbl.675.14001; Zbl.258.14001.

496
References
[Sh88]
Shahidi F. (1988): On the Ramanujan conjecture and ﬁniteness of
poles for certain L-functions. Ann. Math., II.Ser. 127 (1988), 547-584.
Zbl.654.10029.
[ShT-BT04a] Shalika, J. A., Takloo-Bighash, R., Tschinkel, Yu.: Rational points on
compactiﬁcations of semi-simple groups of rank 1. Arithmetic of higher-
dimensional algebraic varieties, (Palo Alto, CA, 2002), Prog.Math.,
vol.226, Birkhäuser, Boston, MA, 2004, p.205-233.
[ShT-BT04b] Shalika, J. A., Takloo-Bighash, R., Tschinkel, Yu.: Rational points
and automorphic forms. Contributions to automorphic forms, geometry,
and number theory, 733-742, Johns Hopkins Univ. Press, Baltimore,
MD, 2004.
[ShT04]
Shalika, J. A., Tschinkel, Yu.: Height zeta functions of equivariant com-
pactiﬁcations of the Heisenberg group. Contributions to automorphic
forms, geometry, and number theory, 743-771, Johns Hopkins Univ.
Press, Baltimore, MD, 2004.
[Shan71]
Shanks D. (1971): Class number, a theory of factorization, and genera.
Proc. Symp. Pure Math. 20 (1971), 415-440. Zbl.223.12006.
[Shan85]
Shanks D. (1985): Solved and Unsolved Problems in Number Theory.
3rd ed. Chelsea Publ. Co., 1985. Zbl.397.10001.
[Shid87]
Shidlovski A.B. (1987): Transcendental Numbers. Moscow: Nauka, 1987.
English transl.: Berlin etc.: W. de Gruyter, 1989. Zbl.629.10026.
[Shi66]
Shimura G. (1966): A reciprocity law in non-solvable extensions. J.
Reine Angew. Math. 221 (1966), 209-220. Zbl.144,42.
[Shi71]
Shimura G. (1971): Introduction to the arithmetic theory of automorphic
functions. Princeton University Press, 1971. Zbl.221.10029.
[Shi97]
Shimura G. (1997): Euler products and Eisenstein series. CBMS Re-
gional Conference Series in Mathematics, 93. Published for the Con-
ference Board of the Mathematical Sciences, Washington, DC; by the
American Mathematical Society, Providence, RI, 1997. xx+259 pp.
[Shi2000]
Shimura G. (2000): Arithmeticity in the theory of automorphic forms.
Mathematical Surveys and Monographs, 82. American Mathematical
Society, Providence, RI, 2000. x+302 pp.
[Shi02]
Shimura G. (2002): The representation of integers as sums of squares.
Amer. J. Math. 124 (2002), no. 5, 1059-1081.
[Shi04]
Shimura G. (2004): Arithmetic and analytic theories of quadratic forms
and Cliﬀord groups. Mathematical Surveys and Monographs, 109.
American Mathematical Society, Providence, RI, 2004. x+275 pp.
[Shin76]
Shintani, T.: On evaluation of zeta functions of totally real algebraic
number ﬁelds at non-negative integers. J. Fac. Sci. Univ. Tokyo, Sec.
IA, 23, No.2 (1976), 393-417
[Shl03]
Shlapentokh, A.: A ring version of Mazur's conjecture on topology of
rational points, Internat. Math. Res. Notices No. 7, 411-422 (2003)
[Sho80]
Shokurov V.V. (1980): Shimura integrals of cusp forms. Izv. Akad.Nauk
SSSR, Ser.Mat. 44, No.3 (1980), 670-718. Zbl.444.14030.
[ShT86]
Shorey T.N., Tijdeman R. (1986): Exponential Diophantine Equations.
Cambridge Univ. Press, 1986. Zbl.606.10011.
[Shou]
Shoup, V.: NTL: A Library for doing Number Theory, Web page:
http://shoup.net/ntl/, 2002

References
497
[Sie29]
Siegel, C.L. (1929): Über einige Anwendungen Diophantischer Approxi-
mationen. Abh. Preuss. Akad. Wiss. Phys. Math. Kl. 41-69(1929). Jbuch
FdM 56,180.
[Sie35]
Siegel, C.L. (1935): Über die analytische Theorie der quadratische For-
men. Ann. Math., 36, 527-606 (1935). Zbl.12,197.
[Sie39]
Siegel, C.L. (1939): Einführung in die Theorie der Modulfunktionen n-
ten Grades. Math. Ann, 116 (1939), 617-657. Zbl.21,203.
[Sie65]
Siegel, C.L. (1965): Lectures on advanced analytic number theory. Tata
Institute, Bombay, 1965. Zbl.278.10001.
[Sier64]
Sierpinski W. (1964): A Selection of Problems in the Theory of Numbers.
Oxford etc.: Pergamon Press, 1964. Zbl.122,44.
[Si01]
Silverberg, A.: Open questions in arithmetic algebraic geometry. In:
[CR01], pp.143-232.
[Silv86]
Silverman J.H. (1986): The Arithmetic of Elliptic Curves. Berlin-
Heidelberg-New York: Springer-Verlag, 1986. Zbl.585.14026.
[Silv88]
Silverman J.H. (1988): Wieferich's criterion and the abc-conjecture. J.
Number Theory 30, No.2 (1988), 226-237. Zbl.654.10019.
[Sim79]
Simmons G.J. (1979): Cryptology: the mathematics of secure communi-
cation. Math. Intell. 4, No.1 (1979), 233-246. Zbl.411.94009.
[Sko99]
Skorobogatov, A.: Beyond the Manin obstruction. Invent. Math. 135,
no. 2, 399-424 (1999).
[Sko01]
Skorobogatov, A.: Torsors and rational points. Cambridge Tracts
in Mathematics, 144. Cambridge University Press, Cambridge, 2001.
viii+187 pp.
[SSw-D]
Slater, J. B., Swinnerton-Dyer, P.: Counting points on cubic surfaces.
I. Nombre et répartition de points de hauteur bornée (Paris, 1996).
Astérisque No. 251, (1998), 1-12.
[Slo82]
Sloane N.J.A. (1982): Recent bounds for codes, sphere packings, and
related problems obtained by linear programming and other methods.
Contemp. Math. 9 (1982), 153-185. Zbl.491.94024.
[SolSt77]
Solovay R., Strassen V. (1977): A fast Monte-Carlo test for primality.
SIAM J. Comput. 6 (1977), 84-85; erratum 7(1978), 18. Zbl.345.10002.
[Sou84]
Soulé Ch. Regulateurs. Sémin. Bourb. 1984-85 Exp.No. 644, Astérisque
133/134 (1986), 237-253.
[SABK94]
Soulé Ch., Abramovich, D., Burnol, J.F., Kramer J.K.: Lectures on
Arakelov Geometry, CUP 1994
[Son04]
Sondow, J.: Criteria for irrationality of Euler's constant
http://home.earthlink.net/˜jsondow/
[Spi91]
Spielberg, J.: Free-product groups, Cuntz-Krieger algebras, and covari-
ant maps. Internat. J. Math. 2 (1991), no. 4, 457-476.
[Spr82]
Sprindzhuk V.G. (1982): Classical Diophantine Equations with two Vari-
ables. Moscow: Nauka, 1982. English transl.: Lect. Notes Math. 1559
(1993). Zbl.523.10008.
[Spr81]
Springer T.A. (1981): Linear Algebraic Groups. Boston: Birkhäuser,
1981. Zbl.453. 14022.
[St67]
Stark H.M. (1967): A complete determination of complex quadratic ﬁelds
of class number one. Mich. Math. J. 14, No.1 (1967), 1-27. Zbl.148,278.
[St69]
Stark H.M. (1969): On the "gap" in a theorem of Heegner. J. Number
Theory 1, No.1 (1969), 16-27. Zbl.198,377.

498
References
[St71-80]
Stark, H.: L-functions at s = 1, I, Adv.Math. 7 (1971), 301-343; II, 17
(1975), 60-92; III, 22 (1976), 64-84; IV, 35 (1980), 197-235
[St77a]
Stark
H.M.
(1977a):
Hilbert's
twelfth
problem
and
L-series.
Bull.Am.Math.Soc. 83, No.5 (1977), 1072-1074. Zbl.378.12007.
[St77b]
Stark H.M. (1977b): Class ﬁelds and modular forms of weight one. Lect.
Notes Math. 601 (1977), 277-287. Zbl.363.12010.
[Stee76]
Steenbrink, J.: Limits of Hodge structures. Invent. Math. 31 (1976),
229-257.
[StW.]
Stein W.: An Explicit Approach to Number Theory (a forthcoming book,
based on a Course Math 124 (Fall 2001), cf.
http://modular.fas.harvard.edu /edu/Fall2001/124/lectures/)
[Step74]
Stepanov S.A. (1974): Rational points of algebraic curves over ﬁnite
ﬁelds. (in Russian). In: Aktual'nye Probl. Analit Teor. Cisel, 1974, 224-
241. Zbl.347.14013.
[Step84]
Stepanov S.A. (1984): Diophantine equations. Tr. Mat. Inst. Steklova
168 (1984), 31-45.
[Step94]
Stepanov S.A.: Arithmetic of algebraic curves. Monographs in Contem-
porary Mathematics, New-York: Consultants Bureau, 1994
[Step99]
Stepanov S.A.: Codes on algebraic curves. Kluwer Academic Publishers.
vii, 350 p., 1999
[Ste95]
Stevens G. (1995): An overview the proof of Fermat's Last Theorem. In:
[CSS95], 1-16
[StTsch]
Strauch, M., Tschinkel, Yu.: Height zeta functions of toric bundles over
ﬂag varieties. Selecta Math. (N.S.) 5, no. 3, 325-396 (1999).
[Sull]
Sullivan D.: On the ergodic theory at inﬁnity of an arbitrary discrete
group of hyperbolic motions. Riemann surfaces and related topics: Pro-
ceedings of the 1978 Stony Brook Conference (State Univ. New York,
Stony Brook, N.Y., 1978), pp. 465-496, Ann. of Math. Stud., 97, Prince-
ton Univ. Press, 1981.
[SwD67]
Swinnerton-Dyer
H.P.F.
(1967):
The
conjecture
of
Birch
and
Swinnerton-Dyer and of Tate. Proc. Conf. Local ﬁelds. Driebergen 1966
(1967), 132-157. Zbl.197,471.
[SwD73]
Swinnerton-Dyer H.P.F. (1973): On l-adic representations and congru-
ences for coeﬃcients of modular forms. Lect. Notes Math. 350 (1973),
1-56. Zbl.267.10032.
[Szm75]
Szemerédi, E.: On sets of integers containing no k elements in arithmetic
progression, Acta Arith. 27, 299-345 (1975).
[Sz(e)81]
Szpiro L. (ed.) (1981): Séminaire sur les pinceaux de courbes de genre
au moins deux. Astérisque 86, 1981. Zbl.463.00009.
[Sz83]
Szpiro L. (1983): La conjecture de Mordell (d'après G. Faltings).
Sémin. Bourbaki 1983/84, Exp.No. 619, Astérisque 121/122 (1985).
Zbl.591.14027.
[Tan57]
Taniyama Y. (1957): L-functions of number ﬁelds and zeta-functions of
Abelian varieties. J. Math. Soc. Japan 9 (1957), 330-366. Zbl.213,228.
[Ta65]
Tate, J. (1950): Fourier analysis in number ﬁelds and Hecke's zeta-
function. Thesis. Princeton, 1950. (see also Algebraic Number Theory,
Brighton 1965, 305-347 (1967). Zbl.153,74; 2nd printing Zbl.645.12001.)
[Ta65a]
Tate, J. (1965a): On the conjectures of Birch and Swinnerton-Dyer
and a geometric analog. Sém. Bourbaki, Exp., 1965/66. Sémin. Bour-

References
499
baki 1965/66, Exp.No. 306; Adv.Stud.Pure Math. 3, 189-214 (1968).
Zbl.199,556.
[Ta65b]
Tate J. (1965b): Algebraic cycles and poles of zeta-functions. In: Arith-
metical Algebraic Geometry, Schilling ed., Harper and Row (1965), 93-
100.
[Ta66]
Tate, J. (1966): Endomorphisms of Abelian varieties over ﬁnite ﬁelds.
Inv. Math., 2, 133-144 (1966). Zbl.147,203.
[Ta73]
Tate, J. (1973): Algebraic formulas in arbitrary characteristic. Appendix
1 to [La73/87]
[Ta74]
Tate, J. (1966): The Arithmetic of Elliptic Curves. Inv. Math., 23, 179-
206 (1974).
[Ta79]
Tate J. (1979): Number-theoretic background. In: Borel A., Casselman
W. (1979), Part 2, 3-26. Zbl.422.12007.
[Ta84]
Tate J.: Les conjectures de Stark sur les fonctions L d'Artin en s = 0,
Progress in Mathematics Vol.47, Birkhäuser 1984.
[Ta95]
Tate J.: Finite ﬂat group schemes. In: [CSS95], pp. 121-154
[Tay02]
Taylor, R.: Galois representations. In: [ICM02], 449-474
[Ta-Wi]
Taylor, R., Wiles, A. (1995): Ring-theoretic properties of certain Hecke
algebras. Ann. Math., II. Ser. 141, No.3, 553-572 (1995)
[Tho79]
Thompson J.G. (1979): Finite groups and modular functions. Bull. Lond.
Math. Soc. 11, No. 3 (1979), 347-351. Zbl.424.20011.
[Tit51]
Titchmarsh E.K. (1951): Theory of Riemann Zeta-Function. Oxford:
Clarendon Press, 1951, 2nd ed., revised by D.R.Heath-Brown, 1986.
Zbl.42,79; Zbl.601.10026.
[TsVl91]
Tsfasman, M. A.; Vlăduţ, S. G.: Algebraic-geometric codes. Translated
from the Russian by the authors. Mathematics and its Applications (So-
viet Series), 58. Kluwer Academic Publishers Group, Dordrecht, 1991.
xxiv+667 pp.
[Tun81]
Tunnell J.B. (1983): Artin's Conjecture for representations of octahedral
type. Bull. AMS (New series) 5, 173-175 (1981).
[Tun83]
Tunnell J.B. (1983): A classical Diophantine problem and modular forms
of weight 3/2. Invent.Math. 72 (1983), 323-334. Zbl.515.10013.
[Vas88]
Vasilenko O.N. (1988): Modern primality tests. (in Russian). Kibern.
Sb., Nov.Ser. 25 (1988), 162-188. Zbl.669.10013.
[Vats03]
Vatsal, V.: Special values of anticyclotomic L-functions. Duke Math. J.
116, no. 2, 219-261 (2003).
[Vau81-97] Vaughan R.C. (1981): The Hardy-Littlewood Method. Cambridge Univ.
Press, 1981. Zbl.455.10034. 2nd Edn: Cambridge Tract 125, CUP 1997
[VaWo91]
Vaughan R.C., Wooley T.D. : On Waring's problem: some reﬁnements.
Proc. London Math. Soc. (3) 63, 35-68 (1991)
[VaWoIV]
Vaughan R.C., Wooley T.D. : Further improvements in Waring's prob-
lem, IV: higher powers. Acta Arith. 94, 203-285 (2000)
[VP]
Venkov A.B., Proskurin N.V. (1982): Automorphic functions and the
Kummer problem. Usp.Mat.Nauk. 37, No.3 (1982), 143-165. English
transl.: Russ.Math.Surv. 37, No.3 (1982), 165-190. Zbl.494.10024.
[V81]
Venkov B.A. (1981): Collected Works in Number Theory (in Russian).
Leningrad: Nauka, 1981. Zbl.513.10001.
[Vi83]
Viète F. (1983): The Analytic Art. Kent State University Press, 1983.
Zbl.558.01041.

500
References
[Vin52]
Vinogradov I.M. (1952): Collected Works. (in Russian). Moscow:
Akad.Nauk SSSR, 1952. Zbl.48,31.
[Vin71]
Vinogradov I.M. (1971): The Exponential Sum Method in Number The-
ory (in Russian). Moscow: Nauka, 1971. Zbl.229.10020.
[Vin81]
Vinogradov I.M. (1981): Basic Number Theory. 9th ed. Moscow: Nauka,
1981. English transl. 1954. Zbl.547.10001, Zbl.65,270.
[VK]
Vinogradov I.M., Karatsuba A.A. (1984): The trigonometric sum
method in number theory. Tr. Mat. Inst. Steklova 168 (1984), 4-30. Eng-
lish transl.: Proc.Steklov Inst.Math. 168 (1986), 3-30. Zbl.549.10027.
[Vla91]
Vlăduţ, S. G.: Kronecker's Jugendtraum and modular functions. Trans-
lated from the Russian by M. Tsfasman. Studies in the Development of
Modern Mathematics, 2. Gordon and Breach Science Publishers, New
York, 1991. x+411 pp.
[Voj87]
Vojta P. (1987): Diophantine approximations and value distribution the-
ory. Lect. Notes Math. 1239 (1987). Zbl.609.14011.
[Voj91]
Vojta P. (1991): Arithmetic and hyperbolic geometry. Proceedings of
the International Congress of Mathematicians, Vol. I, II (Kyoto, 1990),
757-765, Math. Soc. Japan, Tokyo, 1991.
[Vos77-98] Voskresenskij, V.E. (Kunyavskii, B.) (1998): Algebraic groups and their
birational invariants. Transl. from the original Russsian manuscript by
Boris Kunyavskii. Rev. version of "Algebraic tori", Nauka 1977. Transla-
tions of Mathematical Monographs. 179 (1998) Providence, RI: Ameri-
can Mathematical Society (AMS). xiii, 218 p. Zbl.499.14013, 0974.14034
[Wag86]
Wagon, S. (1986): Primality testing. Math. Intell. 8, No.3 (1986), 58-61.
Zbl.595. 10004.
[WaSm87] Wagstaﬀ, S.S. Jr., Smith J.W. (1987): Methods of factoring large inte-
gers. Lect. Notes Math. 1240 (1987), 261-303. Zbl.613.10004.
[Wald96]
Waldschmidt, M.: Sur la nature arithmétique des valeurs de fonctions
modulaires Séminaire Bourbaki. Exp. No.824 (Novembre 1996)
[Wald2000] Waldschmidt, M.: Diophantine Approximation on Linear Algebraic
Groups, Grundlehren Series 326, Springer Verlag 2000
[War36]
Warning, E. (1936): Bemerkung zur vorstehenden Arbeit von Herrn
Chevalley. Abh. Math. Semin. Univ. Hamburg 11 (1936), 76-83.
Zbl.11,146.
[Wash78]
Washington L.C. (1978): The non-p-part of the class number in a cyclo-
tomic Γ-extension. Invent.Math. 49, No.1 (1978), 87-97. Zbl.403.12007.
[Wash82]
Washington L.C. (1982): Introduction to Cyclotomic Fields. New York-
Berlin-Heidelberg: Springer-Verlag, 1982. Zbl.484.12001.
[Wel80]
R.O. Wells, Diﬀerential analysis on complex manifolds. Springer-Verlag,
1980.
[Wei40]
Weil A. (1940): L'intégration dans les groupes topologiques et ses appli-
cations. Paris: Hermann, 1940.
[Wei48]
Weil A. (1948): Variétés abéliennes et courbes algébriques. Paris: Her-
mann, 1948. Zbl.37,162.
[Wei49]
Weil A. (1949): Number of solutions of equations in a ﬁnite ﬁeld.
Bull.Am.Math.Soc. 55 (1949), 497-508. Zbl.32,394.
[Wei51]
Weil A. (1951): Arithmetic on algebraic varieties. Ann. Math., II.Ser.
53, No.3 (1951), 412-444. Zbl.43,270.
[Wei51]
Weil A., Sur la théorie du corps de classes, J. Math. Soc. Japan, 3,
(1951).

References
501
[Wei52a]
Weil A. (1952a): Jacobi sums as "Grössencharakteren". Trans. Am. Math.
Soc. 73 (1952), 487-495. Zbl.48,270.
[Wei52b]
Weil A. (1952b): Sur les "formules explicites" de la théorie des nombres
prémièrs. Commun. Sémin. Math. Univ. de Lund (dédiée à M. Riesz)
1952, 252-265. Zbl.49,32.
[Wei57]
Weil, A. (1957): Zum Beweis des Torellischen Satzes. Nachr. Akad.
Wiess. Göttingen, 1, 33-53 (1957).
[Wei64]
Weil A.: Sur certains groupes d'operateurs unitaires, Acta Math. , 111,
(1964).
[Wei66]
Weil A.: Fonctions zêta et distributions, Séminaire Bourbaki, 312,
(1966).
[Wei67]
Weil A. (1967): Über die Bestimmung Dirichletscher Reihen durch Funk-
tionalgleichungen. Math. Ann. 168 (1967), 149-156. Zbl.158,86.
[Wei71]
Weil A. (1971): Dirichlet series and automorphic forms. Lect. Notes
Math. 189 (1971). Zbl.218.10046.
[Wei72]
Weil A. (1972): Sur les formules explicites de la théorie des nom-
bres. Izv. Akad.Nauk SSSR, Ser. Mat. 36 (1972), 3-18. English transl.:
Math.USSR, Izv. 6 (1972), 1-17 (1973). Zbl.245.12010, see also Zbl.49,32.
[Wei74a]
Weil A. (1974a): Basic Number Theory. 3rd ed. Berlin-Heidelberg-New
York: Springer-Verlag, 1974. Zbl.267.12001; Zbl.176,336.
[Wei74b]
Weil A. (1974b): La cyclotomie jadis et naguère. Enseign. Math., II.Ser.
20 (1974), 247-263. Zbl.352.12006.
[Wei76]
Weil A. (1976): Elliptic functions according to Eisenstein and Kronecker.
Berlin-Heidelberg-New York: Springer-Verlag, 1976. Zbl.318.33004.
[Wei79]
Weil A. (1979): Oeuvres scientiﬁques. Vol.I-III. Berlin-Heidelberg-New
York: Springer-Verlag, 1979. Zbl.424.01027-29.
[Wey40]
Weyl H. (1940): Algebraic Theory of Numbers. Princeton Univ. Press,
1940.
[Wi]
Wiles, A. (1995): Modular elliptic curves and Fermat's Last Theorem.
Ann. Math., II. Ser. 141, No.3, 443-551 (1995)
[Wi2000]
Wiles, A. (2000): Twenty years of number theory. Mathematics: frontiers
and perspectives, 329-342, Amer. Math. Soc., Providence, RI, 2000.
[Wil78]
Williams H.C. (1978): Primality testing on a computer. Ars Comb. 5
(1978), 127-185. Zbl.406.10008.
[Wil82]
Williams H.C. (1982): A p + 1 method of factoring. Math. Comput. 39
(1982), 225-234. Zbl.492.10004.
[Wil84]
Williams H.C. (1984): Factoring on a computer. Math. Intell. 6, No.3
(1984), 29-36. Zbl.548.10004.
[WD86]
Williams H.C., Dubner H. (1986): The primality of R1031. Math. Com-
put. 47 (1986), 703-711. Zbl.602.10001.
[Will74]
Williams, R.F.: Classiﬁcation of subshifts of ﬁnite type. Ann. of Math.
(2) 98 (1973), 120-153; errata, ibid. (2) 99 (1974), 380-381.
[Wun85]
Wunderlich M.C. (1985): Implementing the continued fraction factor-
ing algorithm on parallel machines. Math. Comput. 44 (1985), 251-260.
Zbl.558.10001.
[Ya02]
Cryptography: an introduction. Written by V. Yaschenko, N. Varnovskii,
Yu. Nesterenko, G. Kabatyansky, P. Gyrdymov, A. Zubov, A. Zyazin
and V. Ovchinnikov. Edited by V.Yaschenko. Translated from the 1998
Russian edition by Sergei Lando. Student Mathematical Library, 18.
AMS, Providence, RI, 2002. x+229 pp.

502
References
[Yer77]
Yershov Yu.A. (1977): Numeration theory. Moscow: Nauka, 1977. Ger-
man transl.: Berlin: VEB dt. Verlag Wiss., Vol.I,1973; Zbl.281.02041;
Vol.II,1976; Zbl.344.02031; Vol.III,1978; Zbl.374.02027.
[Yos03]
Yoshida, H.: Absolute CM-Periods. Mathematical Surveys and mono-
graphs, vol. 106, AMS, Providence, RI, 2003. x + 282 pp.
[Zag77]
Zagier D. (1977): First ﬁfty million prime numbers. Math. Intell. 0
(1977), 7-19. Zbl.392.10001.
[Zag81]
Zagier D. (1981): Eisenstein series and the Riemann zeta-function. Au-
tomorphic forms, representation theory, and arithmetic. Colloq. Bombay
1979. (1981), 275-301. Zbl.484.10019.
[Zag94]
Zagier D. (1994): Values of zeta functions and their applications, in "First
European Congress of Mathematics", vol. II, pp. 497-512, Birkhäuser,
1994.
[Zar74]
Zarhin, Yu.G. (1974): A ﬁniteness theorem for Abelian varieties over
functional ﬁelds of ﬁnite characteristic. (in Russian). Funk. Analiz, 8,
no.4, 31-34 (1974). Zbl.324.14009.
[Zar85]
Zarhin, Yu. G. (1985): A ﬁniteness theorem for unpolarized Abelian
varieties over number ﬁelds with prescribed places of bad reduction.
Inv. Math., 79, 309-321 (1985). Zbl.557.14024.
[Zu]
Zudilin, W.: Zeta values on the Web http://wain.mi.ras.ru/index.
html
[Zu95]
Zudilin, W.: On the estimates of the measure of linear independence
for values of certain analytical functions, PhD Thesis, Moscow State
University 1995

Index
Abel's theorem, 228
Abelian extension, 129, 240
- of a function ﬁeld, 169
- of a global ﬁeld, 168
- of a real quadratic ﬁeld, see Real
multiplication
- of an imaginary quadratic ﬁeld, see
Complex multiplication
- of the rational numbers, see
Kronecker-Weber theorem
Maximal - of a local ﬁeld, 165
Abelian variety, 226
polarized -, 227
simple -, 230
Absolute invariant (of an elliptic curve),
215, 240, 299
Absolute value, 132
Discrete -, 133
Equivalence of -s, 145
Extension of -, 142, 145
generalized -, 144
Non-Archimedean -, 132
Normalized -, 143
Absolute value
p-adic -, 133
Addition theorem for elliptic functions,
217
Adele, 146
Adjoint matrix, 116
AF-algebra, 443, 447
Algebra
complete intersection O -
local Noetherian O-, 370
Algebraic closure of a ﬁeld, 117
Algebraic integer, 116
Algebraic variety, 192
Algebraically closed ﬁeld, 117
Algorithm, 10, 97
- to calculate the continued fraction
expansion of a quadratic irrational
number, 53
- to solve Pell's equation, 28
Euclidean, 12
Factorization
of Shanks, 85
Factorization -
CFRAC, 87
CLASNO, 85
SQUFOF, 89
Williams -, 90
Fermat factorization -, 84
Newton-Raphson -, 134, 138
Polynomial time -, 10
Primality test
- of Adleman-Pomerance-Rumely,
77
Miller-Rabin -, 67
of Adleman-Pomerance-Rumely, 69
Pollard's -, 69
Probabilistic -, 66
Solovay-Strassen -, 67
Primality testing, 10
of Silver - Pollig - Hellman, 15
Quadratic sieve, 91
Repeated squaring -, 11
Algorithmic undecidability, 113

504
Index
Analogy between numbers and
functions, 169, 195, 397
Analytic conductor of a modular elliptic
curve, 320
Apéry's method, 55
Approximation
Best -, 50, 52
Approximation theorem, 150
Arakelov geometry, 211, 399
Arakelov Green function, 421
arithmetic Chow group, 401
arithmetic Chow groups, 400
Arithmetical inﬁnity, 195, 211, 399
Artin conductor of a representation, 329
Artin conjecture
generalized, 290
Artin reciprocity law, 158, 161, 188
Artin reciprocity map, 158
Artin symbol, 161
Artin's conjecture
- - (on L series), 14, 276, 327
- - (on primitive roots), 14
Artin's factorization formula for
L-functions of representations, 275
Atkin-Lehner theory, 333, 336
Bernoulli number, 220, 298
Beta - function, 73
Betti realization of a motive, 293
Biquadratic reciprocity law, 178
Birch-Swinnerton-Dyer conjecture, 321
Bit, 9
Blichfeldt's lemma, 151
Bogomolov-Miyaoka-Yau inequality,
331
Brauer group
- of a scheme, 204
Brauer group of a ﬁeld, 184
Brauer's theorem, 276
Brauer-Siegel theorem, 154
Bruhat-Tits tree, 418, 450
canonical projective embedding, 257
Carmichael numbers, 11
Caroubien category, 292
Cathalan equation, 58
Cauchy sequence, 134
Cauchy's formula, 33
Cayley graph, 442, 452
Chain (of points in a topological space),
194
Character
- of an l-adic representation, 242
Hecke -, 279
characteristic classes, 400
Chatelet surface, 205
Chebotarev density theorem, 159, 369
Chevalley's Theorem, 199
Chinese Remainder Theorem, 14
Chinese remainder theorem, 119, 150
Chowla - Selberg formula, 170
Church thesis, 113
Class ﬁeld theory, 155
Class group, 37
class group, 128
Class number
- formula, 277
- formulae for quadratic ﬁelds, 278
Class number of a number ﬁeld, 128
class number of a number ﬁeld, 153
CM-ﬁelds, 169
Coates-Wiles theorem, 323
Coboundary, 179
Cocycle, 179
Cohen-Gödel theorem, 97
Cohen-Lenstra heuristics, 128
Cohomology group
Deﬁnition of -, 178
Long exact sequence of -s, 180
Properties of -, 180
Compactiﬁcation, 198
- of an arithmetic scheme, 211, 399
Completion of a ﬁeld, 134
Complex multiplication, 168, 240
Complex torus, 215, 227
Composition law
for quadratic forms, 36
Computable function, 97
computable function, 103
Conductor
- of a Dirichlet character, 131
- of a Hecke character, 279
- of an elliptic curve, 226
congruence relation of Eichler-Shimura,
304, 319, 320, 360
Congruence subgroup, 301
congruence subgroup, 343
Conjecture

Index
505
Fermat's -, 115, 128
ﬁniteness -s of Shafarevich, 196
Goldbach -, 35
linear growth -, 210
main - of Iwasawa theory, 246, 324
Mordell -, 196, 207, 247
Shafarevich, 247, 248
Silvermann's, 41
Tate, 248
Weil's -s for the zeta function of a
scheme over a ﬁnite ﬁeld, 202
Construction of skew products, 185
Continued fraction, 51, 87
Continued fraction
- expansion of ζ(3), 55
Periodic, 53
Convergent of a continued fraction, 52
Correspondence, 292
Criterion
- of Neron-Ogg-Shafarevich for good
reduction of an elliptic curve, 239
Euler's, 71
Lucas, 11
Criterium
Irrationality, 56
Cryptography, 24, 63-65, 84, 91
Cubic curve, 200
Weierstrass normal form of, 38
Cubic form, 38, 204
Cubic reciprocity law, 178
Cuntz-Krieger algebra, 446, 447
Cup product, 181
Curve
- over a number ﬁeld, 196
algebraic, 213
cubic, 214
Cubic -, 38
cubic -
reduction of - modulo a prime, 47
degenerating-, 416
elliptic, 238
Elliptic -, 39
- over a ﬁnite ﬁeld, 90
elliptic -, 213, 242, 298
- over a ﬁnite ﬁeld, 243
- with complex multiplication, 219,
230, 240
Frey's -, 330
modular -, 320
supersingular -, 244
modular -, 304
number of rational points on a -, 206
rational, 40
Weil, see modular elliptic curve
curve
-modular, 318
Schottky-Mumford -, 451
curve of Frey-Hellegouarch, 331
Cusp, 297
- form, 297
Cusp form, 30
Davenport-Hasse relations, 268
de Franchis Theorem, 249
Decomposition group, 158
Decomposition of a prime ideal in a
ﬁeld extension, 129
Decomposition theorem for maximal
ideals, 129
Dedekind domain, 127
Dedekind eta-function, 320
Dedekind ring, 127
Degree
- of a divisor, 213
- of an invertible sheaf, 213
Deligne's estimate for the coeﬃcients of
cusp forms, 304
Deligne's theorem, see Weil conjectures
Deligne-Serre theorem, 119, 327
Density
- of a set of places, 159
analytic - of a set of places, 159
Local -, 34
local -, 232
Real -, 34
Descent family, 206
Diagonal cubic surface, 205
Dickman's function, 86
Digit, 9
Digit
p-adic-, 136
Dimension
- of a scheme, 194, 197
Kronecker - of a ﬁeld, 197
Diophantine equation, 22, 57, 198
Linear -, 22
Quadratic -, 24
Diophantine set, 3, 98

506
Index
directed edge matrix, 452
Dirichlet character, 71, 118, 267
Primitive -, 72, 131
Dirichlet's class number formula, 85
Dirichlet's Theorem, 250
Dirichlet's theorem on primes in an
arithmetical progression, 156
Dirichlet's unit theorem, 122, 128, 152
Proof of -, 125
Discriminant
- of a cyclotomic ﬁeld, 130
- of a number ﬁeld, 116
- of a quadratic ﬁeld, 130
- of a quadratic form, 36
- of an algebraic number ﬁeld, 121,
125
- of an elliptic curve, 215
discriminant
of a polynomial, 343
of an elliptic curve, 343
Discriminant of a number ﬁeld, 151
Distribution
- of the arguments of the Frobenius
elements, 334
- of the arguments of the Gauss
sums, 335
- the of arguments of Gauss sums,
271
Divisibility theory, 133
Divisor
arithmetical -, 211, 399
canonical -, 213
Cartier -, 200
eﬀective -, 200
Poincaré -, 229
Divisor Map, 152
Divisor map, 133
domain of discontinuity, 423
dynamical system, 451
Eichler-Shimura
congruence relation of - -, 304
Eichler-Shimura's congruence relation,
319, 320, 360
Eichler-Shimura's construction, 319,
320, 360
Eigenfunction of all Hecke operators,
333
Eisenstein series, 30, 219, 297
elementary column operation, 23
Elementary divisors, 23
Elementary Operation on Partial
functions, 103
Elementary row operation, 23
Elliptic curve, 39
Elliptic function, 215
Elliptic module, 169
Embedding problem, 327
Enumerable set, 3, 98, 103, 108
Equivalence
- of fractional ideals in the narrow
sense, 37
Equivalence
SL2-of real numbers, 53
Étale cohomology group, 226, 267
Étale topology, 267
Euler characteristic, 438
Euler criterium
generalized -, 177
Euler product, 261
Euler system, 246, 324
Euler's function, 13
Euler's identity for the partition
function, 31
Eulerian pseudoprime, 66
Exceptional prime, 318
Explicit formula, 21, 287
Exponential sum, 34
estimating -s using the Weil
conjectures, 267
Factor set, 185
Factorization basis, 87
Farey series, 50
Fast Fourier Transform (FFT), 78
Fermat number, 89
Fermat numbers, 11
Fermat prime, 175
Fermat's equation, 115, 128
Fermat's last theorem, 321, 330
Fermat's little theorem, 10
ﬁber product, 248
Fibonacci number, 12, 102
Field
Field
- of p-adic numbers, 134
Complete -, 134
Completion of a -, 134

Index
507
Cyclotomic -, 118, 130
Finite -, 117
Global -, 146
Locally compact -, 143
Quadratic -, 36, 87, 121, 130
Residue -, 157
Tate -, 143
ﬁnite Galois representation, 347
Fourier analysis in a number ﬁeld, 282
Fourier coeﬃcient, 4
Fractional ideal, 37, 127
Fractional linear transformation, 53,
296
Frey-Hellegouarch curve, 331
Frobenius automorphism, 117, 157
Frobenius endomorphism
- at inﬁnity, 293
- of a scheme over a ﬁnite ﬁeld, 265
geometric -, 239
Functional equation
- for the L-function of a rational
representation, 273
- for the L-function of an elliptic
curve, 322
- for the zeta function of a scheme
over a ﬁnite ﬁeld, 265
- in Tate's theory, 283
- of a Dirichlet L-series, 274
- of the L-function of an automorphic
representation of GL(2), 334
- of the Dedekind zeta function, 284
- of the Riemann zeta function, 274
conjectural - for the L-function of a
motive, 294
Fundamental domain, 150
- for a number ﬁeld in its adele ring,
150
- for the idele classes, 153
Fundamental domains
- for a congruence subgroup in the
upper half plane, 301
fundamental parallelogram, 121
Fundamental unit, 122
Galois
- representation, 5
Galois action on the places of an
extension ﬁeld, 158
Galois cohomology, 178
Galois extension of ﬁelds, 117
Galois group, 117, 155
Galois representation
ﬁnite, 347
Gamma factor of the L-function of a
rational representation, 273
Gamma function, 71
Gauss sum, 35, 71, 268
distibution of arguments of -s, see
Distribution
Generating function, 31, 33
generating series, 344
Generic point, 194
Genus
- of a projective non-singular curve,
213
- of a quadratic form, 232
Geometric realization of algebraic
number ﬁeld, 120
Geometry of numbers, 23
Gödel's function, 111
Gödel's theorem, 96
Goldbach's conjecture, 35
Greatest common divisor, 12
Group
- of rational points on a non-singular
cubic curve, 38
Galois, 3
Ideal class, 37, 84
of classes of quadratic forms, 36
of fractional ideals, 37
Shafarevich - Tate, 38
Haar measure, 143
- on the adele ring, 149
Hadamard product, see Weierstrass
product expansion
handlebody of genus g, 423
Hasse's theorem (for the Galois action
on the invariant of an elliptic
curve), 241
Hasse's theorem on norms, 188
Hasse's theorem on the number of
points on a cubic curve modulo a
prime, 48
Hasse-Weil zeta function, 437
Hecke basis, 35
Heegner point, 246, 324
Height

508
Index
- in Arakelov geometry, 211, 399
- of a rational point, 200, 202
- on an elliptic curve, 224
deﬁnition of -, 209
Height
Néron-Tate -, 229
Néron-Tate -, 224
Hensel's Lemma, 138
Hensel's lemma, 134, 187
Hermite Theorem, 248, 249
Hermite's Theorem, 125, 195, 250
Hermitian metrization, 211, 399
Hermitian vector bundle, 399
Hilbert symbol, 139, 164
Hilbert's seventh problem, 61
Hilbert's tenth problem, 96, 113
Hilbert's Theorem 90, 180
Hilbert's twelfth problem, 169, 240
Hodge decomposition, 293
Hodge structure, 273
Hurwitz
formula , 248
Hurwitz genus formula, 196
Ideal, 13, 126
- class group, 128
Fractional -, 37, 127
Maximal -, 127
Prime -, 126
Principal -, 126
Principle, 13
Ideal class group, 37
Finiteness of -, 152
Idele
- class group, 154
Idele group, 149
Inertia group, 158
Inertial degree, 142, 157
Inﬂation-restriction sequence, 181, 378
Integer, 116
Integer
p-adic -, 136
Integral extension of a ring, 195
integral linear programming, 24
Integrally closed ring, 127
Intersection number, 211, 399
Intractable problem, 24
Invariant of local ring
kernel of augmentation, 370, 382
tangent space, 370, 382
Invariants of a local Noetherian
O-algebra, 370, 382
Isogeny of Abelian varieties, 226
Iwasawa module, see Tate module of a
number ﬁeld
Jacobi sum, 35, 73
Jacobi symbol, 16
Jacobi's formula, 29
Jacobian of a curve, 228
Kloosterman sum
distribution of -s, 271
Kloostermann sum, 35
Knapsack problem, 24
Kronecker's "Jugendtraum", 169
Kronecker-Weber Theorem, 119
Kronecker-Weber theorem, 155, 168,
240
Kummer extension, 175
Künneth formula, 293
l-adic realization of a motive, 293
L-function
- of a curve, 291
- of a modular form, 296
- of a motive, 294
- of a rational representation, 272
- of an automorphic representation,
333
Artin -, 276
automorphic -, 336
generalized Dirichlet -, 279
Hecke-Weil -, 290
l-adic -, 246
standard -, 339
L-group, 335
L-homomorphism, 338
L-packet, 339
Lagrange resolution, 180
Lamé's theorem, 12
Langlands functoriality principle, 338
Langlands program, 5, 160, 169, 276,
339
Langlands' conjecture, 339
Lattice
- in a real vector space, 120
Least common multiple, 12

Index
509
Lefschetz ﬁxed point formula, 266
Lefschetz module, 437
Legendre symbol, 15
Level
- of a quadratic form, 303
- structure, 231
level, 343
limit set of the action, 422, 443
Linear algebraic group, 231
Local Artin map, 163-168
Local Artin symbol
Cohomological deﬁnition of -, 182
Local degree, 146
Local invariant, 186
Localization, 133
Logarithm
Discrete, 14, 70
Integral -, 19
Logarithm
p-adic -, 137
Logarithmic map
- of a number ﬁeld, 122
Lubin-Tate formal group, 168
Möbius function, 19
mapping torus, 443
Mass of a quadratic form, 232
Matiyasevich's Theorem, 109
Matiyasevich's theorem, 96, 203
Maximal ideal, 127
Mazur module, 246
Mazur's theorem on the rational torsion
of an elliptic curve, 225
Measure
- of Fundamental domain for a
number ﬁeld in its adele ring, 151
- of fundamental domain for the idele
classes, 153
Haar -, 143
Multiplicative invariant, 71
of irrationality, 56
self-dual - on the additive group of a
local ﬁeld, 282
Tamagawa -, 234
Mellin transform, 286
Mersenne prime, 68
Mersenne primes, 11
Method
- of Baker, 58
Hardy-Littlewood -, 38
Hardy-Littlewood circle, 33
Hardy-Littlewood circle -, 38
of Apéry, 56, 58-60
Ruler-and-compass, 4
Secant-tangent -, 39
Vinogradov's - of exponential sums,
34
minimal conductor, 344
Minkowski Theorem, 248
Minkowski's lemma on a convex body.,
123
Minkowski's Theorem, 125, 195
Minkowski-Hasse principle, 23, 38, 187,
189, 204, 231
- for a quadratic form, 26
Minkowski-Hasse theorem, 134, 189
Minkowski-Siegel formula for the mass
of a quadratic form, 233
modular curve, 318, 343
Modular form, 4, 297
Siegel -, 337
modular form, 343
Modular function, 299
Modular group, 217
Module of an idele, 150
moduli spaces, 257
Mordell's conjecture, 247
Mordell's theorem, 41
Mordell-Weil theorem
- for an Abelian variety, 229
- for an elliptic curve, 221
Mori's theorem, 211
Morita category, 410
Morita equivalence, 410
Motive, 292
- of pure weight, 294
false -, 292
false eﬀective -, 292
true -, 293
Motivic Galois group, 293
Néron diﬀerential, 257
Néron diﬀerential, 322
Néron-Tate height, see Height
Newton-Raphson algorithm, 134, 138
Nilpotent element of a ring, 193
Noetherian ring, 127
Non-singular model (of a ﬁeld), 213

510
Index
Noncommutative space, 409, 443, 448
Norm
- of a closed point of an arithmetic
scheme, 261
- of an algebraic number, 116, 120
- of an element of the Weil group, 289
- of an ideal, 127
of an algebraic number, 28, 36
of an ideal, 37
Reduced -, 186
Relative - of a non-Archimedean
place, 160
Norm residue homomorphism, 163
Norm residue symbol, 139
Normal form
of a cubic curve modulo a prime, 47
Obstruction
Brauer-Manin -, 205
descent -, 205
One-way function, 64
Order, 132
Orthogonal group, 233
Ostrowski's theorem, 133, 145
p-adic
p-adic
- digit, 136
p-adic
- Logarithm, 137
p-adic number, 134
Parameterization
rational -, 40
Partition, 31
Partition function, 31
Application of circle method to -, 33
PEL-family, 231
Pell's equation, 28, 50, 54, 98, 121
Minimal solution to -, 28
Perfect number, 11
Period matrix of a polarized Abelian
variety, 230
Petersson inner product, 35, 302
Petersson-Ramanujan conjecture, see
Deligne's estimate
Picard group., 200
Pimsner-Voiculescu exact sequence, 444
Place of a ﬁeld, 145
Poincaré divisor, see divisor
Point
- of ﬁnite order on an elliptic curve,
218
geometric, 197
regular -, 200
ring-valued - of a scheme, 197
singular -, 200
Points of ﬁnite order
- of Tate's curve, 219, 299
Poisson summation formula, 283
Polarization
- of an Abelian variety, 227
algebraic - of an Abelian variety, 228
canonical principal - of a Jacobian,
229
principal - of an Abelian variety, 227
Polarized Abelian variety, see Abelian
variety
Pontryagin duality, 147
Power residue symbol, 177, 184
Prime
Commercial -, 67
Large gaps between -s, 66
prime element, 126
Prime ideal, 126, 193
Prime number theorem, 18, 66
Primitive element theorem, 117
Primitive form, 333
Primitive root, 14
Primitively enumerable set, 109
Principal ideal, 126
principal ideal
group of -s, 128
Principal polarization, see Polarization
Principle
ﬁniteness for the height, 258
Problem
Waring's -, 35
Product
Restricted topological -, 147
Product formula for absolute values,
141, 146
Product formula for Hilbert symbols,
140
Product formula for local symbols, 188
Projective space over a ring, 197
Pseudo-Abelian category, see Caroubien
category
Pseudoprime, 11

Index
511
Eulerian -, 16
Strict -, 67
Pythagorean triples, 24
Quadratic character, 130
Quadratic form, 231
Ambiguous binary -, 85
Equivalence of -s, 35
Primitive binary -, 36
Proper equivalence of -s, 36
Reduced binary -, 37
Quadratic reciprocity law, 140, 164
Quadric, 25
Quasicharacter, 71, 280
- of a topological group, 289
Quaternion algebra, 244
Ramanujan's congruence, 317
Ramanujan's function, 216, 242, 299,
304
Ramanujan-Petersson conjecture, 334
Ramiﬁcation group, 329
Ramiﬁcation index, 142, 157
Rank
Rank
- of a cubic curve over Q, 41
- of an Abelian variety, 229
- of an elliptic curve
upper bound on -, 223
Rational parameterization, 57
Rational parametrization
- of the circle, 24
Rational surface, 205
Real multiplication, 169
Real part of a quasicharacter, 280
Reciprocity Law
Quadratic, 71
Reciprocity law
Quadratic, 4, 15, 345
recursive function, 97, 104
Reduction
good and bad, 212, 399
Reduction of a scheme of arithmetic
type modulo a prime ideal, 197
Regular function, 193
Regular point, 200
regular prime, 342
Regulator
- of a number ﬁeld, 123
- of an elliptic curve, 225
Regulator of a number ﬁeld, 153
Reidemeister torsion, 437
Relative invariant, 381, 382
relative residue ﬁeld degree, 160
Representation
- by a quadratic form, 29
- of the Weil group, 289
- of zero by a quadratic form, 25
automorphic, 334
automorphic -, 296, 335
Binary -, 11
Cyclotomic -, 166
Galois -, 317-331
- in positive characteristic, 243
- of an Abelian variety, 226
- of an elliptic curve, 218
- on Etale cohomology, 226
- on the Tate module of an Abelian
variety, 239
- on the Tate module of an elliptic
curve, 238
Abelian l-adic -, 242
Abelian -, 275
cyclotomic -, 219
entire -, 272
irreducible two dimensional complex
-, 327
modular -, 330, 354, 359
rational -, 272
two-dimensional - over a ﬁnite ﬁeld,
330
unramiﬁed -, 272
Galois-type - of the Weil group, 290
number of -s by a quadratic form,
303, 337
spinor -, 337
standard -, 336
Restricted generality quantor, 113
Restricted topological product, 147
Riemann hypothesis, 21, 102
- for an algebraic variety over a ﬁnite
ﬁeld, 265
generalized, 290
Generalized -, 67
generalized -, 276
Riemann periodicity relations, 228
Riemann surface, 195, 421, 423
Riemann-Roch theorem for curves, 213

512
Index
Riemannian form, 227, see form
Ring
- of arithmetical type, 194
Ring
- of p-adic integers, 136
complete intersection -
local -, 370
Gorenstein -
local -, 371
Integrally closed -, 127
Krull -, 133
Noetherian -, 127
of integers in a number ﬁeld, 36
of residue classes, 13
Valuation -, 133
Ring of adeles, 146
Ring of integers of a number ﬁeld, 116,
127
Root data, 335
Rosatti involution, 230, 250
Ruler and compass method, 172
S-unit, 152
Sato-Tate Conjecture, 49, 271, 328, 334
Scew homomorphism, 179
Scheme, 196
- of arithmetic type, 196
- of geometric type, 196
- over Finite Field, 263
aﬃne -, 196
irreducible -, 196
Scheme
K- -, 196
projective -, 198
Schottky group, 419, 421, 422
Schottky uniformization, 416, 419, 423
Schur multiplier, 180
Selberg trace formula, 339
Selmer group
- of an Abelian variety, 229
Generalized - -of a Galois module,
375
of a Galois module, 375
of an elliptic curve, 224, 375
Semi-simpliﬁcation of a representation,
275
semistable, 345
Separable ﬁeld extension, 117
Serre's conjecture on Galois represen-
tations over ﬁnite ﬁelds, 330,
354
Shafarevich Conjecture
for elliptic curves, 249
Shafarevich conjecture, 247, 248
on bad reduction, 259
on ﬁniteness, 251
Shafarevich Theorem, 249
Shafarevich-Tate group, 205
of an elliptic curve, 224
Shafarevich-Tate group
- of an Abelian variety, 229
Sheaf
ample -, 201, 213
canonical -, 201
invertible -, 200
metrized invertible -, 209
very ample -, 201
shift operator, 443
Shimura variety, see Variety
Shimura-Taniyama-Weil Conjecture,
320, 330, 341
Siegel modular group, 231
Siegel Theorem, 249
Siegel upper half space, 230
Siegel's formula
- for representation numbers for
quadratic forms, 232
Siegel's Theorem, 247, 250
Sieve
Eratosthenes -, 10
Sign of an elliptic curve, 322
Simple central algebra, 184
Simple function, 103
Singular point, 200
Singular series, 34
Skolem-Noether theorem, 186
Smale space, 443
Smoothness of a natural number, 86, 90
Solution
Solution
L-valued, 191
Solvable set, 112
Sophie Germain prime, 68
Specialization, 194
spectral triples, 421
Spectrum of a ring, 193
Spiegelungssatz

Index
513
Leopoldt's Spiegelungssatz, 128
Split
a place -s completely, 160
Prime which -s completely in an
extension, 129
Stark's conjectures, 171
Stereographic projection, 25
Structural morphism, 196
Surface
arithmetical -, 211, 399
surface
- Del Pezzo, 203
suspension ﬂow, 443
Symplectic group, 226
Tamagawa number, 234
tangle of bounded geodesics, 421
Tannakian category, 293
Tate curve, 219, 299
Tate ﬁeld, 143
Tate module
- of a number ﬁeld, 244
- of an Abelian variety, 239
- of an elliptic curve, 238
- of the multiplicative group, 238
Tate's conjecture, 248
for Abelian varieties, 252
for elliptic curves, 249
on isogenies, 252
Teichmüller representative, 136, 142
Tensor product of ﬁelds
Theorem on -, 119
Theorem
- of Coates-Wiles, 323
- of Deligne-Serre, 119, 327
ﬁniteness for isogenies, 252
Franchis de, 249
on semisimplicity, 253
Dirichlet, 250
ﬁniteness for forms of an Abelian
variety, 251
Hermite, 248-250
Kronecker-Weber -, 119
Main - of Galois theory, 117
Minkowski, 248
Shafarevich, 249
Siegel, 247, 249, 250
Torelli, 250
Weil, 252
Theta function, 30
cubic analogue of the -, 335
Theta series, 303
Thom isomorphism, 444
Thue equation, 58
Thue-Siegel-Roth theorem, 57
Torelli's Theorem, 250
Torelli's theorem, 229
Torsion
Torsion
- of a cubic curve over Q, 41
Torsor, 206
totally ramiﬁed extension, 143
Trace, 36
- of Frobenius endomorphisms, 242
- of an algebraic number, 116, 120
Distribution of -s of Frobenius
elements, 271
Reduced -, 186
Transcendental number, 61
Transfer homomorphism, 162
Transform
Mellin -, 4
Trap-door function, 64
Unit in a number ﬁeld, 121
Unramiﬁed
- integral extension, 195
- place of a ﬁeld, 158
Unramiﬁed extension, 143
Upper half plane, 296
Valuation, 132
- ring, 133
Variety, 199
Abelian, see Abelian variety
absolutely (or geometrically)
irreducible -, 199
Kuga-Sato -, 318
Shimura -, 231
variety
- Fano, 203
- general type, 203
- intermediate type, 203
Verlagerung, see Transfer homomor-
phism
Waring's problem, 35
Washington's conjecture, 246

514
Index
Weber-Fueter theorem, 240
Weierstrass normal form, 38, 214
Weierstrass product expansion, 286
Weil conjectures on the zeta function of
a scheme over a ﬁnite ﬁeld, 265
Weil group, 288
Weil pairing
- on an Abelian variety, 226
- on an elliptic curve, 219
Weil's inverse theorem, 312
analogue of-for GL(3), 336
Weil's Theorem
for Abelian varieties over ﬁnite ﬁelds,
252
Wild invariant of a representation, 329
Zariski topology, 193
Zeta function
- of a hypersurface, 268
- of an arithmetic scheme, 261
Dedekind -, 276
Hasse-Weil - -, 437
Riemann -, 19, 20, 261
zeta function
- of a modular curve, 319

